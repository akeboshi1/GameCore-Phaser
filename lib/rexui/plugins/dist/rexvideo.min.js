!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rexvideo=t():e.rexvideo=t()}(this,function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1692)}({11:function(e,t,i){"use strict";t.a=function(){}},116:function(e,t,i){"use strict";var r=Phaser.Utils.Objects.GetValue,n={id:["id",void 0],width:["width",void 0],height:["height",void 0],autoPlay:["autoplay",!0],controls:["controls",!1],loop:["loop",!1],poster:["poster",void 0],preload:["preload",void 0],muted:["muted",!1],playsInline:["playsInline",!0],crossOrigin:["crossOrigin","anonymous"]},o={canplay:"canplay",canplaythrough:"canplaythrough",ended:"ended",error:"error",loadstart:"loadstart",playing:"playing",pause:"pause",stalled:"stalled"},a=function(e){var t,i,a=this,s=document.createElement("video");for(var u in n)t=n[u],void 0!==(i=r(e,u,t[1]))&&(s[t[0]]=i);var c=r(e,"eventEmitter",void 0);if(c){var h=function(e){s.addEventListener(o[e],function(){c.emit(e,this)}.bind(a))};for(var l in o)h(l)}return s},s=Phaser.Utils.Objects.IsPlainObject,u=["webm","ogg","mp4","h264","vp9","hls"],c=function(e,t,i){if(s(t))for(var r,n=0,o=u.length;n<o;n++)if(i[(r=u[n])+"Video"]&&t.hasOwnProperty(r)){t=t[r];break}e.src=t,e.load()};function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t,i){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=Phaser.Utils.Objects.GetValue,b=Phaser.Math.Clamp;t.a=function(e){return function(t){function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),f(this,p(i).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(i,e),r=i,(n=[{key:"createVideoElement",value:function(e){return this.video||(void 0===e&&(e={}),e.eventEmitter=this,this.video=a(e),this.playbackTimeChangeEventEnable=y(e,"playbackTimeChangeEventEnable",!0)),this.video}},{key:"preDestroy",value:function(){this.scene&&(this.video&&(this.video.pause(),this.video.removeAttribute("src"),this.video.load(),this.video=void 0),d(p(i.prototype),"preDestroy",this)&&d(p(i.prototype),"preDestroy",this).call(this))}},{key:"preUpdate",value:function(e,t){if(this.playbackTimeChangeEventEnable){var r=this.playbackTime;r!==this.prevT&&this.emit("playbacktimechange",this),this.prevT=r}d(p(i.prototype),"preUpdate",this)&&d(p(i.prototype),"preUpdate",this).call(this,e,t)}},{key:"load",value:function(e){return this.video&&c(this.video,e,this.availableVideoTypes),this}},{key:"play",value:function(){return this.video&&this.video.play(),this}},{key:"pause",value:function(){return this.video&&this.video.pause(),this}},{key:"setPlaybackTime",value:function(e){return this.playbackTime=e,this}},{key:"setT",value:function(e){return this.t=e,this}},{key:"setVolume",value:function(e){return this.volume=e,this}},{key:"setMute",value:function(e){return void 0===e&&(e=!0),this.muted=e,this}},{key:"setLoop",value:function(e){return void 0===e&&(e=!0),this.loop=e,this}},{key:"availableVideoTypes",get:function(){return this.scene.sys.game.device.video}},{key:"isPlaying",get:function(){if(this.video){var e=this.video;return!e.paused&&!e.ended&&e.currentTime>0}return!1}},{key:"isPaused",get:function(){return!!this.video&&this.video.paused}},{key:"playbackTime",get:function(){return this.video&&this.video.currentTime||0},set:function(e){if(this.video)try{this.video.currentTime=e}catch(e){}}},{key:"duration",get:function(){return this.video&&this.video.duration||0}},{key:"t",get:function(){if(this.video){var e=this.duration;return 0===e?0:this.playbackTime/e}return 0},set:function(e){this.video&&(this.playbackTime=this.duration*b(e,0,1))}},{key:"hasEnded",get:function(){return!!this.video&&this.video.ended}},{key:"volume",get:function(){return this.video&&this.video.volume||0},set:function(e){this.video&&(this.video.volume=e)}},{key:"muted",get:function(){return this.video&&this.video.muted||!1},set:function(e){this.video&&(this.video.muted=e)}},{key:"loop",get:function(){return!!this.video&&this.video.loop},set:function(e){this.video&&(this.video.loop=e)}},{key:"readyState",get:function(){return this.video?this.video.readyState:void 0}}])&&l(r.prototype,n),o&&l(r,o),i}()}},1692:function(e,t,i){"use strict";i.r(t);var r=i(333),n=i(334),o=i(335),a=i(336),s=i(94);i.d(t,"VideoDOM",function(){return s.a});var u=i(95);i.d(t,"VideoCanvas",function(){return u.a}),Phaser.GameObjects.GameObjectFactory.register("rexVideo",r.a),Phaser.GameObjects.GameObjectCreator.register("rexVideo",n.a),Phaser.GameObjects.GameObjectFactory.register("rexVideoCanvas",o.a),Phaser.GameObjects.GameObjectCreator.register("rexVideoCanvas",a.a)},333:function(e,t,i){"use strict";var r=i(94);t.a=function(e,t,i,n,o){var a=new r.a(this.scene,e,t,i,n,o);return this.scene.add.existing(a),a}},334:function(e,t,i){"use strict";var r=i(94),n=Phaser.Utils.Objects.GetAdvancedValue,o=Phaser.GameObjects.BuildGameObject;t.a=function(e,t){var i=n(e,"width",void 0),a=n(e,"height",void 0);void 0!==t&&(e.add=t);var s=new r.a(this.scene,0,0,i,a,e);return o(this.scene,s,e),s}},335:function(e,t,i){"use strict";var r=i(95);t.a=function(e,t,i,n,o){var a=new r.a(this.scene,e,t,i,n,o);return this.scene.add.existing(a),a}},336:function(e,t,i){"use strict";var r=i(95),n=Phaser.Utils.Objects.GetAdvancedValue,o=Phaser.GameObjects.BuildGameObject;t.a=function(e,t){var i=n(e,"width",void 0),a=n(e,"height",void 0);void 0!==t&&(e.add=t);var s=new r.a(this.scene,0,0,i,a,e);return o(this.scene,s,e),s}},41:function(e,t,i){"use strict";var r=Phaser.Renderer.WebGL.Utils,n=function(e,t,i,n,o){if(t.dirty&&(t.updateTexture(),t.dirty=!1),0!==t.width&&0!==t.height){var a=t.frame,s=a.width,u=a.height,c=r.getTintAppendFloatAlpha;this.pipeline.batchTexture(t,a.glTexture,s,u,t.x,t.y,s/t.resolution,u/t.resolution,t.scaleX,t.scaleY,t.rotation,t.flipX,t.flipY,t.scrollFactorX,t.scrollFactorY,t.displayOriginX,t.displayOriginY,0,0,s,u,c(t._tintTL,n.alpha*t._alphaTL),c(t._tintTR,n.alpha*t._alphaTR),c(t._tintBL,n.alpha*t._alphaBL),c(t._tintBR,n.alpha*t._alphaBR),t._isTinted&&t.tintFill,0,0,n,o)}},o=function(e,t,i,r,n){0!==t.width&&0!==t.height&&e.batchSprite(t,t.frame,r,n)},a=i(11),s=(a.a,a.a,{renderWebGL:n,renderCanvas:o}),u=Phaser.Display.Color,c={clear:function(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},fill:function(e){return this.context.fillStyle=e,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},getPixel:function(e,t,i){void 0===i&&(i=new u);var r=this.context.getImageData(e,t,1,1);return i.setTo(r.data[0],r.data[1],r.data[2],r.data[3]),i},setPixel:function(e,t,i,r,n,o){if("number"!=typeof i){var a=i;i=a.red,r=a.green,n=a.blue,o=a.alpha}void 0===o&&(o=0!==i||0!==r||0!==n?255:0);var s=this.context.createImageData(1,1);return s.data[0]=i,s.data[1]=r,s.data[2]=n,s.data[3]=o,this.context.putImageData(s,e,t),this.dirty=!0,this}},h={updateTexture:function(e,t){e&&(t?e.call(t,this.canvas,this.context):e(this.canvas,this.context)),this.canvas.width===this.frame.width&&this.canvas.height===this.frame.height||this.frame.setSize(this.canvas.width,this.canvas.height),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(this.canvas,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1;var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},generateTexture:function(e,t,i,r,n){var o,a=this.canvas,s=this.scene.sys,u=s.game.renderer;void 0===t&&(t=0),void 0===i&&(i=0),void 0===r?r=a.width:r*=this.resolution,void 0===n?n=a.height:n*=this.resolution;var c=(o=s.textures.exists(e)?s.textures.get(e):s.textures.createCanvas(e,r,n)).getSourceImage();c.width!==r&&(c.width=r),c.height!==n&&(c.height=n);var h=c.getContext("2d");return h.clearRect(0,0,r,n),h.drawImage(a,t,i,r,n),u.gl&&o&&u.canvasToTexture(c,o.source[0].glTexture,!0,0),this},loadTexture:function(e,t){var i=this.scene.textures.getFrame(e,t);return i?(this.width!==i.cutWidth||this.height!==i.cutHeight?this.resize(i.cutWidth,i.cutHeight):this.context.clearRect(0,0,i.cutWidth,i.cutHeight),this.context.drawImage(i.source.image,i.cutX,i.cutY,i.cutWidth,i.cutHeight,0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this):this}};function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=Phaser.Display.Canvas.CanvasPool,b=Phaser.GameObjects.GameObject,g=function(e){function t(e,i,r,n,o){var a,s,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=1),s=this,(a=!(u=d(t).call(this,e,"rexCanvas"))||"object"!==l(u)&&"function"!=typeof u?p(s):u).renderer=e.sys.game.renderer,a.resolution=e.sys.game.config.resolution,a.canvas=y.create(p(a),a.resolution*n,a.resolution*o),a.context=a.canvas.getContext("2d"),a.dirty=!1,a.setPosition(i,r),a.setSize(n,o),a.setOrigin(.5,.5),a.initPipeline(),a._crop=a.resetCropObject(),a.texture=e.sys.textures.addCanvas(null,a.canvas,!0),a.frame=a.texture.get(),a.frame.source.resolution=a.resolution,a.renderer&&a.renderer.gl&&(a.renderer.deleteTexture(a.frame.source.glTexture),a.frame.source.glTexture=null),e.sys.game.config.renderType===Phaser.WEBGL&&e.sys.game.renderer.onContextRestored(function(){this.dirty=!0},p(a)),a.dirty=!0,a}var i,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,b),i=t,(r=[{key:"getCanvas",value:function(e){return e||(this.dirty=!0),this.canvas}},{key:"needRedraw",value:function(){return this.dirty=!0,this}},{key:"preDestroy",value:function(){y.remove(this.canvas)}},{key:"resize",value:function(e,t){return this.width===e&&this.height===t?this:(this.setSize(e,t).updateDisplayOrigin(),e*=this.resolution,t*=this.resolution,e=Math.max(Math.ceil(e),1),t=Math.max(Math.ceil(t),1),this.canvas.width=e,this.canvas.height=t,this.dirty=!0,this)}}])&&f(i.prototype,r),n&&f(i,n),t}(),m=Phaser.GameObjects.Components;Phaser.Class.mixin(g,[m.Alpha,m.BlendMode,m.ComputedSize,m.Crop,m.Depth,m.Flip,m.GetBounds,m.Mask,m.Origin,m.Pipeline,m.ScrollFactor,m.Tint,m.Transform,m.Visible,s,c,h]);t.a=g},94:function(e,t,i){"use strict";var r=i(116);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=Phaser.GameObjects.DOMElement,h=Phaser.Utils.Objects.IsPlainObject,l=Phaser.Utils.Objects.GetValue,f=function(e){function t(e,i,r,n,o,u){var c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),h(i)?(i=l(u=i,"x",0),r=l(u,"y",0),n=l(u,"width",void 0),o=l(u,"height",void 0)):h(n)&&(n=l(u=n,"width",void 0),o=l(u,"height",void 0)),void 0===u&&(u={});var f=e.scale.autoRound;return void 0!==n&&(f&&(n=Math.floor(n)),u.width=n),void 0!==o&&(f&&(o=Math.floor(o)),u.height=o),(c=a(this,s(t).call(this,e,i,r))).type="rexVideo",c.setElement(c.createVideoElement(u)).load(l(u,"src","")),c}var i,n,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,Object(r["a"])(c)),i=t,(n=[{key:"resize",value:function(e,t){return this.width===e&&this.height===t?this:(this.node.width=e,this.node.height=t,this.updateSize(),this)}}])&&o(i.prototype,n),f&&o(i,f),t}();t.a=f},95:function(e,t,i){"use strict";var r=i(116),n=i(41);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t,i){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=Phaser.Utils.Objects.IsPlainObject,f=Phaser.Utils.Objects.GetValue,d=function(e){function t(e,i,r,n,o,a){var u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(i)?(i=f(a=i,"x",0),r=f(a,"y",0),n=f(a,"width",void 0),o=f(a,"height",void 0)):l(n)&&(n=f(a=n,"width",void 0),o=f(a,"height",void 0)),void 0===a&&(a={});var h=e.scale.autoRound;return void 0!==n&&(h&&(n=Math.floor(n)),a.width=n),void 0!==o&&(h&&(o=Math.floor(o)),a.height=o),(u=s(this,c(t).call(this,e,i,r,n,o))).type="rexVideoCanvas",u.createVideoElement(a),u.load(f(a,"src","")),u}var i,o,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,Object(r["a"])(n["a"])),i=t,(o=[{key:"renderWebGL",value:function(e,i,r,n,o){if(this.readyState>0)this.renderer.canvasToTexture(this.video,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture;else{var a=(e=this.renderer).gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),e.setFramebuffer(null,!0)}u(c(t.prototype),"renderWebGL",this).call(this,e,i,r,n,o)}},{key:"renderCanvas",value:function(e,i,r,n,o){this.readyState>0?this.context.drawImage(this.video,0,0,this.canvas.width,this.canvas.height):this.context.clearRect(0,0,this.canvas.width,this.canvas.height),u(c(t.prototype),"renderCanvas",this).call(this,e,i,r,n,o)}},{key:"resize",value:function(e,i){return this.width===e&&this.height===i?this:(this.video.width=e,this.video.height=i,u(c(t.prototype),"resize",this).call(this,e,i),this)}}])&&a(i.prototype,o),d&&a(i,d),t}();t.a=d}}).default});