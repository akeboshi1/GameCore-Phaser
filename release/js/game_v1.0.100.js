/*! For license information please see game_v1.0.100.js.LICENSE */
(this.webpackJsonpTooqingCore=this.webpackJsonpTooqingCore||[]).push([["game"],{"../game-capsule/dist/index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst capsule_1 = __webpack_require__(/*! ./lib/capsule */ "../game-capsule/dist/lib/capsule.js");\r\nexports.Capsule = capsule_1.default;\r\nconst constants_1 = __webpack_require__(/*! ./lib/constants */ "../game-capsule/dist/lib/constants.js");\r\nexports.Constants = constants_1.default;\r\nconst lite_1 = __webpack_require__(/*! ./lib/lite */ "../game-capsule/dist/lib/lite.js");\r\nexports.Lite = lite_1.default;\r\n__export(__webpack_require__(/*! ./lib/configobjects */ "../game-capsule/dist/lib/configobjects/index.js"));\r\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/index.js?')},"../game-capsule/dist/lib/capsule.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nconst config_object_factory_1 = __webpack_require__(/*! ./config_object_factory */ "../game-capsule/dist/lib/config_object_factory.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst children_index_1 = __webpack_require__(/*! ./children_index */ "../game-capsule/dist/lib/children_index.js");\r\nconst ConfigObjects = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst configobjects_1 = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst constants_1 = __webpack_require__(/*! ./constants */ "../game-capsule/dist/lib/constants.js");\r\nconst treeify = __webpack_require__(/*! treeify */ "../game-capsule/node_modules/treeify/treeify.js");\r\nvar Game = pixelpai_proto_1.op_gameconfig_01.Game;\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass Capsule extends children_index_1.default {\r\n    constructor() {\r\n        super();\r\n        // 缓存同族对象的源对象。\r\n        // 源对象指具有相同基因序列的第一个ConfigObject。\r\n        this._families = new Map();\r\n        this._ignore_serialize = new Map();\r\n        // initialize the factory.\r\n        this.add = new config_object_factory_1.default(this);\r\n        // initialize the only game node.\r\n        this._root = new configobjects_1.GameNode(this);\r\n    }\r\n    resetPreprocessedData() {\r\n        this._families = new Map();\r\n        this._ignore_serialize = new Map();\r\n    }\r\n    get families() {\r\n        return this._families;\r\n    }\r\n    get ignoreList() {\r\n        return this._ignore_serialize;\r\n    }\r\n    serialize() {\r\n        if (!this._root)\r\n            throw new Error(`Capsule::serialize() Error: Empty root node, aka GameNode.`);\r\n        const game = (this._bin_conf = Game.create());\r\n        // 1. serialize root node also known as GameNode first.\r\n        this._root.serialize(game);\r\n        // 2-1. pre-serialize\r\n        this.resetPreprocessedData();\r\n        this._objects.forEach((object) => {\r\n            object.preSerialize();\r\n        });\r\n        // 2-2. serialize all other objects.\r\n        this._objects.forEach((object) => {\r\n            if (!this._ignore_serialize.get(object.id))\r\n                object.serialize(game);\r\n        });\r\n        // 3. return binConfig buffer.\r\n        const buffer = Game.encode(this._bin_conf).finish();\r\n        return buffer;\r\n    }\r\n    deserialize(buffer) {\r\n        const message = Game.decode(buffer);\r\n        const obj = Game.toObject(message);\r\n        const delayDeserialize = [];\r\n        // 1. deserialize game\r\n        this._root.deserialize(message);\r\n        // 2-1. deserialize other objects.\r\n        for (const idx of Object.keys(obj)) {\r\n            const arr = obj[idx];\r\n            if (Array.isArray(arr)) {\r\n                for (let proto of arr) {\r\n                    const nodeType = proto.node.type;\r\n                    if (nodeType == NodeType.ForkType) {\r\n                        // Fork 节点放到最后反序列化，确保他的parent先被加到树中。\r\n                        delayDeserialize.push(proto);\r\n                    }\r\n                    else {\r\n                        this.doDeserialize(proto);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // 2-2. deserialize all Fork objects\r\n        for (const proto of delayDeserialize) {\r\n            this.doDeserialize(proto);\r\n        }\r\n        // 2-3. Link all ConfigObjects\r\n        this._objects.forEach((object) => {\r\n            object.link();\r\n        });\r\n    }\r\n    doDeserialize(protocolObj) {\r\n        if (protocolObj.hasOwnProperty("node")) {\r\n            const nodeType = protocolObj["node"].type;\r\n            const nodeConstructor = constants_1.default.NODE_T[nodeType] || "";\r\n            if (ConfigObjects.hasOwnProperty(nodeConstructor)) {\r\n                // @ts-ignore\r\n                const node = new ConfigObjects[nodeConstructor](this);\r\n                node.deserialize(protocolObj);\r\n            }\r\n        }\r\n    }\r\n    get root() {\r\n        return this._root;\r\n    }\r\n    getObjectBySN(sn) {\r\n        for (const object of this.objectsList) {\r\n            if (sn === object.sn) {\r\n                return object;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n    getAllChildrenIds(node) {\r\n        let ret = [];\r\n        const walkTree = (tree) => {\r\n            if (tree.children && tree.children.length > 0) {\r\n                for (let child of tree.children) {\r\n                    ret.push(child.id);\r\n                    walkTree(child);\r\n                }\r\n            }\r\n        };\r\n        walkTree(node);\r\n        return ret;\r\n    }\r\n    // 在保存到我的素材功能中，导入的是展开的节点，这时需要将存在父子关系的objects去重\r\n    deduplicateNodes(nodes) {\r\n        let nodesMap = {};\r\n        for (let node of nodes) {\r\n            node.ids = this.getAllChildrenIds(node);\r\n            nodesMap[node.id] = node;\r\n        }\r\n        for (let node of nodes) {\r\n            for (let id of node.ids) {\r\n                if (nodesMap[id]) {\r\n                    delete nodesMap[id];\r\n                }\r\n            }\r\n        }\r\n        return Object.values(nodesMap);\r\n    }\r\n    emptyObjectCap(objects) {\r\n        objects.forEach(obj => {\r\n            obj.cap.families.clear();\r\n            if (obj.children && obj.children.length > 0) {\r\n                this.emptyObjectCap(obj.children);\r\n            }\r\n        });\r\n    }\r\n    // 从当前的Capsule中导出Nodes\r\n    export(objects) {\r\n        objects = this.deduplicateNodes(objects);\r\n        this.emptyObjectCap(objects);\r\n        const newCap = new Capsule();\r\n        const travel = (node, parent) => {\r\n            const newNode = _.clone(node);\r\n            if (parent)\r\n                newNode.parent = parent;\r\n            newCap.addObject(newNode);\r\n            for (const child of node.children) {\r\n                travel(child);\r\n            }\r\n        };\r\n        for (const object of objects) {\r\n            travel(object, newCap.root.id);\r\n        }\r\n        return newCap;\r\n    }\r\n    // 从外部Capsule中导入Nodes\r\n    import(src, newId, disTarget, returnAll = false) {\r\n        const sourceCapsule = new Capsule();\r\n        sourceCapsule.deserialize(src.serialize());\r\n        for (const obj of sourceCapsule.objectsList) {\r\n            if (obj.parent === sourceCapsule.root.id) {\r\n                obj.parent = (disTarget || this.root).id;\r\n                obj.renewId(newId);\r\n            }\r\n            obj.cap = this;\r\n            this.addObject(obj);\r\n        }\r\n        // 给我一个父节点对象，如果不给我将挂载到GameNode上\r\n        // const parentObj: IConfigObject = disTarget || this.root;\r\n        // for (const obj of sourceCapsule.objectsList) {\r\n        //     // 如果obj的parent === src.root.id\r\n        //     // 把它改为新的parent\r\n        //     if (obj.parent === sourceCapsule.root.id) {\r\n        //         obj.parent = parentObj.id;\r\n        //     }\r\n        //     obj.cap = this;\r\n        //     this.addObject(obj);\r\n        // }\r\n        // 将顶级节点导出\r\n        const importList = this.walkTopLevelNode(sourceCapsule.root.children, returnAll);\r\n        return importList;\r\n    }\r\n    walkTopLevelNode(nodes, returnAll = false) {\r\n        let ret = [];\r\n        for (const node of nodes) {\r\n            ret.push(node.id);\r\n            if (node.children && node.children.length) {\r\n                if (returnAll) {\r\n                    this.walkTopLevelNode(node.children, returnAll);\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    // 用于在同一个Capsule中克隆ConfigObject\r\n    // 将会获得一个新的Node，如果此Node有子节点会同样克隆子节点\r\n    clone(src_id, parent, cloneFork = false) {\r\n        const origin = this.getObject(src_id);\r\n        if (!origin) {\r\n            console.error(`Origin object[${src_id}] does not exist.`);\r\n            return;\r\n        }\r\n        // @ts-ignore\r\n        const dolly = new ConfigObjects[origin.className](this);\r\n        dolly.parentObject = parent;\r\n        dolly.duplicate(origin);\r\n        this.addObject(dolly);\r\n        // 遍历克隆对象的子节点，克隆\r\n        for (const child of origin.children) {\r\n            if (child instanceof configobjects_1.ForkNode && !cloneFork)\r\n                continue;\r\n            const son = this.clone(child.id, dolly);\r\n            if (son)\r\n                son.link();\r\n        }\r\n        return dolly;\r\n    }\r\n    inspect() {\r\n        const self = this;\r\n        const printTree = function (id) {\r\n            const obj = self.getObject(id);\r\n            if (!obj) {\r\n                return;\r\n            }\r\n            let out = {};\r\n            for (const child of obj.children) {\r\n                out[`${child.className}[${child.id}]`] = printTree(child.id);\r\n            }\r\n            return out;\r\n        };\r\n        const cap = {};\r\n        cap[`${self.root.className}[${self.root.id}]`] = printTree(self.root.id);\r\n        console.log(`Capsule`);\r\n        console.log(treeify.asTree(cap, true, true));\r\n    }\r\n}\r\nexports.default = Capsule;\r\n//# sourceMappingURL=capsule.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/capsule.js?')},"../game-capsule/dist/lib/children_index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nclass ChildrenIndex {\r\n    constructor() {\r\n        this._objects = new Map();\r\n        this._branch_cache = new Map();\r\n    }\r\n    getChildrenList(parent) {\r\n        // const arr = Array.from<IConfigObject>(this._objects.values());\r\n        const branch = this._branch_cache.get(parent);\r\n        if (branch) {\r\n            return Array.from(branch.values());\r\n            // return Array.from(branch.values()).filter(\r\n            //     (o: IConfigObject) => parent === o.parent\r\n            // );\r\n        }\r\n        return [];\r\n    }\r\n    addObject(obj) {\r\n        if (!obj) {\r\n            throw new Error(`Empty Object.`);\r\n        }\r\n        // add to this._objects\r\n        this._objects.set(obj.id, obj);\r\n        // link to parent.\r\n        // 如果是fork则不需要link到parent node\r\n        if (!obj.isFork) {\r\n            obj.link();\r\n        }\r\n        // add to cache\r\n        if (!this._branch_cache.has(obj.parent)) {\r\n            this._branch_cache.set(obj.parent, new Map());\r\n        }\r\n        const branch = this._branch_cache.get(obj.parent);\r\n        if (branch)\r\n            branch.set(obj.id, obj);\r\n    }\r\n    removeObject(obj) {\r\n        if (!obj) {\r\n            throw new Error(`Empty Object.`);\r\n        }\r\n        // 1. remove object from parent as member property.\r\n        obj.unlink();\r\n        // 2. remove object from tree.\r\n        this._objects.delete(obj.id);\r\n        // 3. remove from cache\r\n        const branch = this._branch_cache.get(obj.parent);\r\n        if (branch) {\r\n            branch.delete(obj.id);\r\n        }\r\n    }\r\n    removeObjectById(id) {\r\n        this._objects.delete(id);\r\n    }\r\n    setObject(id, node) {\r\n        this._objects.set(id, node);\r\n    }\r\n    getObject(childOrParentId) {\r\n        return this._objects.get(childOrParentId);\r\n    }\r\n    get objectsList() {\r\n        return Array.from(this._objects.values());\r\n    }\r\n}\r\nexports.default = ChildrenIndex;\r\n//# sourceMappingURL=children_index.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/children_index.js?')},"../game-capsule/dist/lib/config_object_factory.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst configobjects_1 = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst scene_1 = __webpack_require__(/*! ./configobjects/scene */ "../game-capsule/dist/lib/configobjects/scene.js");\r\nconst character_1 = __webpack_require__(/*! ./configobjects/character */ "../game-capsule/dist/lib/configobjects/character.js");\r\nconst terrain_1 = __webpack_require__(/*! ./configobjects/terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nconst package_1 = __webpack_require__(/*! ./configobjects/package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nconst location_1 = __webpack_require__(/*! ./configobjects/location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nconst shop_1 = __webpack_require__(/*! ./configobjects/shop */ "../game-capsule/dist/lib/configobjects/shop.js");\r\nclass ConfigObjectFactory {\r\n    constructor(_cap) {\r\n        this._cap = _cap;\r\n    }\r\n    element(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const entity = new configobjects_1.ElementNode(this._cap, parentNode);\r\n        this._cap.addObject(entity);\r\n        return entity;\r\n    }\r\n    spawnpoint(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const spawnpoint = new configobjects_1.SpawnPointNode(this._cap, parentNode);\r\n        this._cap.addObject(spawnpoint);\r\n        return spawnpoint;\r\n    }\r\n    terrain(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const t = new terrain_1.TerrainNode(this._cap, parentNode);\r\n        this._cap.addObject(t);\r\n        return t;\r\n    }\r\n    attr(parent) {\r\n        const attr = new configobjects_1.AttributeNode(this._cap, parent);\r\n        this._cap.addObject(attr);\r\n        return attr;\r\n    }\r\n    func(parent) {\r\n        const func = new configobjects_1.FunctionNode(this._cap, parent);\r\n        this._cap.addObject(func);\r\n        return func;\r\n    }\r\n    event(parent) {\r\n        const event = new configobjects_1.EventNode(this._cap, parent);\r\n        this._cap.addObject(event);\r\n        return event;\r\n    }\r\n    ui(parent) {\r\n        const ui = new configobjects_1.UINode(this._cap, parent);\r\n        this._cap.addObject(ui);\r\n        return ui;\r\n    }\r\n    // now time we only link timer to the game object.\r\n    timer(parent) {\r\n        const timer = new configobjects_1.TimerNode(this._cap, parent);\r\n        this._cap.addObject(timer);\r\n        return timer;\r\n    }\r\n    scene(rows, cols, name) {\r\n        const scene = new scene_1.default(this._cap, this._cap.root);\r\n        if (name) {\r\n            scene.name = name;\r\n        }\r\n        this._cap.addObject(scene);\r\n        const size = new configobjects_1.MapSizeNode(this._cap, scene);\r\n        size.rows = rows;\r\n        size.cols = cols;\r\n        this._cap.addObject(size);\r\n        const tc = new scene_1.TerrainCollectionNode(this._cap, scene);\r\n        tc.initTerrainCollection(size);\r\n        this._cap.addObject(tc);\r\n        return scene;\r\n    }\r\n    character() {\r\n        const c = new character_1.default(this._cap, this._cap.root);\r\n        this._cap.addObject(c);\r\n        const camp = this.camp(1, c);\r\n        this._cap.addObject(camp);\r\n        const avatar = new configobjects_1.AvatarNode(this._cap, c);\r\n        this._cap.addObject(avatar);\r\n        return c;\r\n    }\r\n    camp(max_players, parent) {\r\n        const ca = new configobjects_1.CampNode(this._cap, parent);\r\n        ca.maxPlayers = max_players;\r\n        this._cap.addObject(ca);\r\n        return ca;\r\n    }\r\n    package(parent) {\r\n        const pkg = new package_1.default(this._cap, parent);\r\n        this._cap.addObject(pkg);\r\n        return pkg;\r\n    }\r\n    packageItem(parent) {\r\n        const pkgItem = new package_1.PackageItemNode(this._cap, parent);\r\n        this._cap.addObject(pkgItem);\r\n        return pkgItem;\r\n    }\r\n    animationdata(parent, name) {\r\n        if (!parent) {\r\n            return;\r\n        }\r\n        if (name && parent.checkSameName(name)) {\r\n            throw Error("重复的动画名称");\r\n        }\r\n        const ani = new configobjects_1.AnimationDataNode(this._cap, parent);\r\n        if (name)\r\n            ani.name = name;\r\n        this._cap.addObject(ani);\r\n        return ani;\r\n    }\r\n    animations(parent) {\r\n        const ani = new configobjects_1.AnimationsNode(this._cap, parent);\r\n        this._cap.addObject(ani);\r\n        return ani;\r\n    }\r\n    location(parent) {\r\n        const lo = new location_1.default(this._cap, parent);\r\n        this._cap.addObject(lo);\r\n        return lo;\r\n    }\r\n    display(parent) {\r\n        const display = new configobjects_1.DisplayNode(this._cap, parent);\r\n        this._cap.addObject(display);\r\n        return display;\r\n    }\r\n    shop(parent) {\r\n        const pkg = new shop_1.default(this._cap, parent);\r\n        this._cap.addObject(pkg);\r\n        return pkg;\r\n    }\r\n    shopItem(parent) {\r\n        const item = new shop_1.ShopItemNode(this._cap, parent);\r\n        this._cap.addObject(item);\r\n        return item;\r\n    }\r\n    commodity(parent) {\r\n        const com = new shop_1.CommodityNode(this._cap, parent);\r\n        this._cap.addObject(com);\r\n        return com;\r\n    }\r\n}\r\nexports.default = ConfigObjectFactory;\r\n//# sourceMappingURL=config_object_factory.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/config_object_factory.js?')},"../game-capsule/dist/lib/configobjects/access.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass AccessNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._access = 1;\r\n        this.name = "权限";\r\n    }\r\n    get properties() {\r\n        return {\r\n            access: this._access,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.access)) {\r\n            game.access = [];\r\n        }\r\n        return game.access;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Access.create();\r\n        obj.node = this.makeNode();\r\n        obj.access = this._access;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._access = obj.access;\r\n    }\r\n}\r\nexports.AccessNode = AccessNode;\r\n//# sourceMappingURL=access.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/access.js?')},"../game-capsule/dist/lib/configobjects/animations.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst display_1 = __webpack_require__(/*! ./display */ "../game-capsule/dist/lib/configobjects/display.js");\r\nclass AnimationsNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._defaultAnimation = "idle";\r\n        this._data_map = new Map();\r\n        this._images = new Map();\r\n        this._editorToolType = 0;\r\n        this.name = "动画";\r\n    }\r\n    get properties() {\r\n        return {\r\n            dir: this._dir,\r\n            defaultAnimation: this._defaultAnimation,\r\n        };\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.animations)) {\r\n            game.animations = [];\r\n        }\r\n        return game.animations;\r\n    }\r\n    createProtocolObject() {\r\n        const animations = pixelpai_proto_1.op_gameconfig_01.Animations.create();\r\n        animations.node = super.makeNode();\r\n        animations.dir = this._dir;\r\n        animations.defaultAnimation = this._defaultAnimation;\r\n        animations.scale = this._scale;\r\n        return animations;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._defaultAnimation = as.defaultAnimation;\r\n        this._scale = as.scale;\r\n        this._dir = this._scale ? 5 : as.dir || 3;\r\n    }\r\n    importSprite(sprite) {\r\n        const display = sprite.display;\r\n        if (display) {\r\n            this.setDisplayPath(display.texturePath || "", display.dataPath || "");\r\n        }\r\n        if (sprite.direction) {\r\n            this.dir = sprite.direction;\r\n        }\r\n        const animations = sprite.animations;\r\n        if (animations && animations.length > 0) {\r\n            for (const animation of animations) {\r\n                const aniData = this._cap.add.animationdata(this, animation.name);\r\n                if (aniData)\r\n                    aniData.importAnimation(animation);\r\n            }\r\n            this.defaultAnimationName = sprite.currentAnimationName || animations[0].name;\r\n        }\r\n    }\r\n    syncSprite(sprite) {\r\n        if (sprite.direction) {\r\n            this.dir = sprite.direction;\r\n        }\r\n    }\r\n    addAnimationData(ani) {\r\n        this._data_map.set(ani.id, ani);\r\n    }\r\n    removeAnimationData(ani) {\r\n        this._data_map.delete(ani.id);\r\n    }\r\n    setDisplayPath(texturePath, dataPath) {\r\n        const display = this.display;\r\n        display.texturePath = texturePath;\r\n        display.dataPath = dataPath;\r\n    }\r\n    get dir() {\r\n        return this._dir;\r\n    }\r\n    set dir(val) {\r\n        this._dir = val;\r\n    }\r\n    get display() {\r\n        return this._display || this.cap.add.display(this);\r\n    }\r\n    get animationData() {\r\n        return Array.from(this._data_map.values());\r\n    }\r\n    get defaultAnimationName() {\r\n        return this._defaultAnimation;\r\n    }\r\n    set defaultAnimationName(val) {\r\n        this._defaultAnimation = val;\r\n    }\r\n    get editorToolType() {\r\n        return this._editorToolType;\r\n    }\r\n    set editorToolType(value) {\r\n        this._editorToolType = value;\r\n    }\r\n    get thumbBuffer() {\r\n        return this._thumbBuffer;\r\n    }\r\n    set thumbBuffer(buffer) {\r\n        this._thumbBuffer = buffer;\r\n    }\r\n    setImages(images) {\r\n        this._images.clear();\r\n        for (const image of images) {\r\n            this.addImage(image);\r\n        }\r\n    }\r\n    addImage(image) {\r\n        if (image.name === "blank") {\r\n            image.isBlank = true;\r\n        }\r\n        this._images.set(image.name, image);\r\n    }\r\n    getImage(name) {\r\n        return this._images.get(name);\r\n    }\r\n    removeImage(image) {\r\n        this._images.delete(image.name);\r\n        const animationDatas = this.animationDataList;\r\n        for (const animationData of animationDatas) {\r\n            animationData.removeFrameByName(image.name);\r\n        }\r\n    }\r\n    updateFrameDataImage() {\r\n        const animations = this.animationDataList;\r\n        for (const animationData of animations) {\r\n            const frameData = animationData.frameData;\r\n            if (frameData) {\r\n                for (const frame of frameData) {\r\n                    frame.image = this.getImage(frame.name);\r\n                }\r\n            }\r\n        }\r\n        if (animations.length > 0)\r\n            this.setSelectedAnimation(animations[0].id);\r\n    }\r\n    horizontalFlip() {\r\n        if (this.dir === 3 || this.dir === 5) {\r\n            this.dir = this.dir === 3 ? 5 : 3;\r\n        }\r\n        // 旧数据支持\r\n        this._scale = this.dir === 3 ? false : true;\r\n    }\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n    get images() {\r\n        return Array.from(this._images.values());\r\n    }\r\n    setSelectedAnimation(id) {\r\n        this._selectedAnimationID = id;\r\n    }\r\n    get animationDataList() {\r\n        // TODO\r\n        return Array.from(this._data_map.values());\r\n    }\r\n    getSelectedAnimation() {\r\n        if (this._selectedAnimationID) {\r\n            return this._data_map.get(this._selectedAnimationID);\r\n        }\r\n        return;\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof AnimationDataNode) {\r\n            this.addAnimationData(object);\r\n        }\r\n        if (object instanceof display_1.default) {\r\n            this._display = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof AnimationDataNode) {\r\n            this.removeAnimationData(object);\r\n        }\r\n        if (object instanceof display_1.default) {\r\n            this._display = undefined;\r\n        }\r\n    }\r\n    // by 7 这是啥？？\r\n    geneSelfSequence() {\r\n        let gene = `${this.defaultAnimationName}`;\r\n        if (this._scale)\r\n            gene += this._scale.toString();\r\n        return gene;\r\n    }\r\n    geneSequence() {\r\n        let gene = `${this.defaultAnimationName}`;\r\n        if (this._display)\r\n            gene += this._display.geneSequence();\r\n        if (this._scale)\r\n            gene += this._scale.toString();\r\n        if (this._dir)\r\n            gene += this._dir.toString();\r\n        const animations = this.animationDataList.sort();\r\n        if (animations.length > 0) {\r\n            for (const animationData of animations) {\r\n                gene += animationData.geneSequence();\r\n            }\r\n        }\r\n        return gene;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AnimationsNode) {\r\n            this._defaultAnimation = src.defaultAnimationName;\r\n            this._dir = src.dir;\r\n            this._scale = src.scale;\r\n        }\r\n    }\r\n    checkSameName(name) {\r\n        const animationDatas = this.animationData;\r\n        for (const animation of animationDatas) {\r\n            if (animation.name === name) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexports.default = AnimationsNode;\r\nclass AnimationDataNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.areaRows = 15;\r\n        this.areaCols = 15;\r\n        this.centerPoint = {\r\n            x: this.areaRows >> 1,\r\n            y: this.areaCols >> 1,\r\n        };\r\n        this._frameRate = 5;\r\n        this._frameName = [];\r\n        this._loop = true;\r\n        this._baseLoc = { x: 0, y: 0 };\r\n        this._frameData = [];\r\n        this._playing = false;\r\n        this.name = "序列帧数据";\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    get properties() {\r\n        return {\r\n            frameRate: this._frameRate,\r\n            frameName: this._frameName,\r\n            loop: this._loop,\r\n            baseLoc: `${this._baseLoc.x},${this._baseLoc.y}`,\r\n            originPoint: this.collisionOriginPoint,\r\n            frameData: this._frameData,\r\n            selectedFrame: this._selectedFrame,\r\n            playing: this._playing,\r\n            basicWalkableArea: this._basicWalkableArea,\r\n            basicCollisionArea: this._basicCollisionArea,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.animationdatas)) {\r\n            game.animationdatas = [];\r\n        }\r\n        return game.animationdatas;\r\n    }\r\n    createProtocolObject() {\r\n        const anim = pixelpai_proto_1.op_gameconfig_01.AnimationData.create();\r\n        anim.node = super.makeNode();\r\n        anim.baseLoc = `${this._baseLoc.x},${this._baseLoc.y}`;\r\n        anim.frameName = this._frameName;\r\n        anim.loop = this._loop;\r\n        anim.frameRate = this._frameRate;\r\n        if (this._collisionArea) {\r\n            anim.collisionArea = helpers_1.default.arrayToString(this._collisionArea, ",", "&");\r\n        }\r\n        if (this._walkableArea) {\r\n            anim.walkableArea = helpers_1.default.arrayToString(this._walkableArea, ",", "&");\r\n        }\r\n        if (this._collisionOriginPoint) {\r\n            const p = this._collisionOriginPoint;\r\n            anim.originPoint = [p.y, p.x];\r\n        }\r\n        return anim;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._frameRate = obj.frameRate;\r\n        this._frameName = obj.frameName || [];\r\n        this._loop = obj.loop || false;\r\n        if (obj.originPoint) {\r\n            this._collisionOriginPoint = {\r\n                x: obj.originPoint[1],\r\n                y: obj.originPoint[0],\r\n            };\r\n            this._walkableOriginPoint = {\r\n                x: obj.originPoint[1],\r\n                y: obj.originPoint[0],\r\n            };\r\n        }\r\n        if (obj.baseLoc) {\r\n            const baseLocAry = obj.baseLoc.split(",");\r\n            this._baseLoc = {\r\n                x: parseInt(baseLocAry[0]),\r\n                y: parseInt(baseLocAry[1]),\r\n            };\r\n        }\r\n        if (obj.walkableArea) {\r\n            this._walkableArea = helpers_1.default.stringToArray(obj.walkableArea, ",", "&");\r\n            this._basicWalkableArea = this.initlizeBasicArea();\r\n            this.originalArea(this._basicWalkableArea, this._walkableArea, this._collisionOriginPoint);\r\n        }\r\n        if (obj.collisionArea) {\r\n            this._collisionArea = helpers_1.default.stringToArray(obj.collisionArea, ",", "&");\r\n            this._basicCollisionArea = this.initlizeBasicArea();\r\n            this.originalArea(this._basicCollisionArea, this._collisionArea, this._collisionOriginPoint);\r\n        }\r\n        for (let i = 0; i < this._frameName.length; i++) {\r\n            this.frameData[i] = { name: this._frameName[i], image: undefined };\r\n        }\r\n    }\r\n    cutBaseArea() {\r\n        if (this._basicCollisionArea) {\r\n            this._collisionArea = [];\r\n            this._collisionOriginPoint = Object.assign({}, this.centerPoint);\r\n            this._collisionArea = this.filterArea(this._basicCollisionArea, this._collisionOriginPoint);\r\n        }\r\n        if (this._basicWalkableArea) {\r\n            this._walkableArea = [];\r\n            this._walkableArea = this.filterArea(this.basicWalkableArea);\r\n        }\r\n    }\r\n    importAnimation(ani) {\r\n        this.name = ani.name;\r\n        this.frameName = ani.frameName || [];\r\n        this.frameRate = ani.frameRate;\r\n        this.loop = !!ani.loop;\r\n        const baseLoc = ani.baseLoc;\r\n        if (baseLoc) {\r\n            const tmpBaseLoc = baseLoc.split(",");\r\n            this.baseLoc = { x: parseInt(tmpBaseLoc[0], 10), y: parseInt(tmpBaseLoc[1], 10) };\r\n        }\r\n        const originPoint = ani.originPoint;\r\n        if (originPoint) {\r\n            this.originPoint = { x: originPoint[1], y: originPoint[0] };\r\n        }\r\n        if (ani.walkableArea) {\r\n            this._walkableArea = helpers_1.default.stringToArray(ani.walkableArea, ",", "&");\r\n            // this._basicWalkableArea = this.initlizeBasicArea();\r\n            // this.originalArea(\r\n            //     this._basicWalkableArea,\r\n            //     this._walkableArea,\r\n            //     this._collisionOriginPoint\r\n            // );\r\n        }\r\n        if (ani.collisionArea) {\r\n            this._collisionArea = helpers_1.default.stringToArray(ani.collisionArea, ",", "&");\r\n            // this._basicCollisionArea = this.initlizeBasicArea();\r\n            // this.originalArea(\r\n            //     this._basicCollisionArea,\r\n            //     this._collisionArea,\r\n            //     this._collisionOriginPoint\r\n            // );\r\n        }\r\n    }\r\n    get originPoint() {\r\n        if (!this._collisionOriginPoint) {\r\n            this._collisionOriginPoint = { x: 0, y: 0 };\r\n        }\r\n        return this._collisionOriginPoint;\r\n    }\r\n    set originPoint(value) {\r\n        this._collisionOriginPoint = value;\r\n    }\r\n    get frameRate() {\r\n        return this._frameRate;\r\n    }\r\n    set frameRate(value) {\r\n        this._frameRate = value;\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n    }\r\n    get baseLoc() {\r\n        return this._baseLoc;\r\n    }\r\n    set baseLoc(value) {\r\n        this._baseLoc = value;\r\n    }\r\n    get frameData() {\r\n        return this._frameData;\r\n    }\r\n    addFrame(frame) {\r\n        this._frameData.push(frame);\r\n    }\r\n    addFrameAt(frame, index) {\r\n        if (index < 0) {\r\n            index = 0;\r\n        }\r\n        if (index > this._frameData.length) {\r\n            index = this._frameData.length;\r\n        }\r\n        this._frameData.splice(index, 0, frame);\r\n    }\r\n    removeFrame(frame) {\r\n        let index = this._frameData.indexOf(frame);\r\n        if (index > -1) {\r\n            this._frameData.splice(index, 1);\r\n        }\r\n    }\r\n    removeFrameByName(name) {\r\n        this._frameData = this.frameData.filter(frame => frame.name !== name);\r\n    }\r\n    clearFrameData() {\r\n        this._frameData.length = 0;\r\n    }\r\n    set selectedFrame(val) {\r\n        this._selectedFrame = val;\r\n    }\r\n    get selectedFrame() {\r\n        return this._selectedFrame;\r\n    }\r\n    get playing() {\r\n        return this._playing;\r\n    }\r\n    set playing(val) {\r\n        this._playing = val;\r\n    }\r\n    get basicCollisionArea() {\r\n        if (!this._basicCollisionArea ||\r\n            this._basicCollisionArea.length === 0) {\r\n            this._basicCollisionArea = this.initlizeBasicArea();\r\n        }\r\n        return this._basicCollisionArea;\r\n    }\r\n    setBasicCollisionArea(row, col, value) {\r\n        if (row < 0 || row > this.areaRows || col < 0 || col > this.areaCols) {\r\n            return;\r\n        }\r\n        if (!this._basicCollisionArea) {\r\n            return;\r\n        }\r\n        this._basicCollisionArea[row][col] = value;\r\n    }\r\n    get basicWalkableArea() {\r\n        if (!this._basicWalkableArea || this._basicWalkableArea.length === 0) {\r\n            this._basicWalkableArea = this.initlizeBasicArea();\r\n        }\r\n        return this._basicWalkableArea;\r\n    }\r\n    get frameName() {\r\n        return this._frameName;\r\n    }\r\n    set frameName(value) {\r\n        this._frameName = value;\r\n    }\r\n    get collisionArea() {\r\n        return this._collisionArea;\r\n    }\r\n    set collisionArea(ary) {\r\n        this._collisionArea = ary;\r\n    }\r\n    get walkableArea() {\r\n        return this._walkableArea;\r\n    }\r\n    set walkableArea(ary) {\r\n        this._walkableArea = ary;\r\n    }\r\n    get collisionOriginPoint() {\r\n        return this._collisionOriginPoint;\r\n    }\r\n    get walkableOriginPoint() {\r\n        return this._walkableOriginPoint;\r\n    }\r\n    setBasicWalkableArea(row, col, value) {\r\n        if (row < 0 || row > this.areaRows || col < 0 || col > this.areaCols) {\r\n            return;\r\n        }\r\n        if (!this._basicWalkableArea) {\r\n            return;\r\n        }\r\n        this._basicWalkableArea[row][col] = value;\r\n    }\r\n    convertToClientObject(scale) {\r\n        const ani = pixelpai_proto_1.op_gameconfig.Animation.create();\r\n        ani.id = this.id;\r\n        ani.name = this.name;\r\n        ani.frameRate = this._frameRate;\r\n        ani.loop = this._loop || false;\r\n        ani.frameName = this._frameName || [];\r\n        ani.baseLoc = `${this.baseLoc.x},${this.baseLoc.y}`;\r\n        ani.walkOriginPoint = [this.originPoint.y, this.originPoint.x];\r\n        ani.originPoint = [this.originPoint.y, this.originPoint.x];\r\n        if (this._walkableArea) {\r\n            ani.walkableArea = helpers_1.default.arrayToString(this._walkableArea, ",", "&");\r\n        }\r\n        else {\r\n            ani.walkableArea = "";\r\n        }\r\n        if (this._collisionArea) {\r\n            ani.collisionArea = helpers_1.default.arrayToString(this._collisionArea, ",", "&");\r\n        }\r\n        else {\r\n            ani.collisionArea = "";\r\n        }\r\n        return ani;\r\n    }\r\n    geneSequence() {\r\n        let gene = `${this.name}${this._frameRate}${this._frameName.join("")}`;\r\n        gene += JSON.stringify(this.baseLoc);\r\n        gene += JSON.stringify(this.originPoint);\r\n        if (this._collisionArea) {\r\n            gene += JSON.stringify(this._collisionArea);\r\n        }\r\n        if (this._walkableArea) {\r\n            gene += JSON.stringify(this._walkableArea);\r\n        }\r\n        return gene;\r\n    }\r\n    filterArea(sourceArea, originPoint) {\r\n        const area = [...sourceArea];\r\n        this.removeHeadRows(area, originPoint);\r\n        this.removeHeadCols(area, originPoint);\r\n        this.removeTailRows(area);\r\n        this.removeTailCols(area);\r\n        return area;\r\n    }\r\n    originalArea(area, filterAry, originPoint) {\r\n        if (!area || !filterAry)\r\n            return;\r\n        originPoint = originPoint || { x: 0, y: 0 };\r\n        const startX = this.centerPoint.x - originPoint.x;\r\n        const startY = this.centerPoint.y - originPoint.y;\r\n        for (let i = 0; i < filterAry.length; i++) {\r\n            for (let j = 0; j < filterAry[0].length; j++) {\r\n                if (area.length > i + startX && area[i].length > j + startY)\r\n                    area[i + startX][j + startY] = filterAry[i][j];\r\n            }\r\n        }\r\n    }\r\n    removeHeadRows(ary, originPoint) {\r\n        // from begin to center row.\r\n        let startIndedx = 0;\r\n        if (this._collisionArea &&\r\n            this._collisionArea.length &&\r\n            this._collisionOriginPoint) {\r\n            startIndedx = this.centerPoint.x - this._collisionOriginPoint.x;\r\n            ary.splice(0, startIndedx);\r\n            return;\r\n        }\r\n        const tmpArr = ary.slice(startIndedx, this.centerPoint.x), len = tmpArr.length;\r\n        for (let i = 0; i < len; ++i) {\r\n            const row = tmpArr[i];\r\n            const idx = row.find(num => num > 0);\r\n            if (idx) {\r\n                return;\r\n            }\r\n            else {\r\n                ary.shift();\r\n                if (originPoint)\r\n                    originPoint.x -= 1;\r\n            }\r\n        }\r\n    }\r\n    removeTailRows(ary) {\r\n        // from center to end row\r\n        let endIndex = 0;\r\n        if (this._collisionArea && this._collisionArea.length > 0) {\r\n            endIndex = this._collisionArea.length - 1;\r\n        }\r\n        const tmpArr = ary.slice(1), len = tmpArr.length;\r\n        for (let i = len - 1; i >= endIndex; i--) {\r\n            const row = tmpArr[i];\r\n            const idx = row.find(num => num > 0);\r\n            if (idx && endIndex === 0) {\r\n                return;\r\n            }\r\n            else {\r\n                ary.pop();\r\n                // Note cut tail does not change the origin point\r\n            }\r\n        }\r\n    }\r\n    removeHeadCols(ary, originPoint) {\r\n        let edge = -1;\r\n        if (this._collisionArea &&\r\n            this._collisionArea.length &&\r\n            this._collisionOriginPoint) {\r\n            edge = this.centerPoint.y - this._collisionOriginPoint.y;\r\n        }\r\n        if (edge < 1) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                const rowArr = ary[row];\r\n                const idx = rowArr.findIndex(num => num > 0);\r\n                if (idx > -1 && idx < this.centerPoint.x) {\r\n                    if (edge < 0) {\r\n                        edge = idx;\r\n                    }\r\n                    edge = Math.min(edge, idx);\r\n                }\r\n            }\r\n        }\r\n        if (edge < 0 || edge === NaN) {\r\n            edge = this.centerPoint.x;\r\n        }\r\n        // do the cut\r\n        if (edge > -1) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                // 0 0 0 0 E * * * * * ...\r\n                //         ^ > > > > >\r\n                ary[row] = ary[row].slice(edge);\r\n            }\r\n            if (originPoint)\r\n                originPoint.y -= edge;\r\n        }\r\n    }\r\n    removeTailCols(ary) {\r\n        let edge = 0;\r\n        if (this._collisionArea && this._collisionArea.length > 0) {\r\n            edge = this._collisionArea[0].length;\r\n        }\r\n        else {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                const rowArr = ary[row];\r\n                let idx = rowArr\r\n                    .slice()\r\n                    .reverse()\r\n                    .findIndex(val => {\r\n                    return val > 0;\r\n                });\r\n                if (idx > -1) {\r\n                    idx = rowArr.length - idx;\r\n                    edge = Math.max(edge, idx);\r\n                }\r\n            }\r\n        }\r\n        if (edge < 1) {\r\n            edge = 1;\r\n        }\r\n        // do the cut\r\n        if (ary[0].length > edge) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                // ... * * * * * E 0 0 0\r\n                //     < < < < < ^\r\n                ary[row] = ary[row].slice(0, edge);\r\n            }\r\n            // Note cut tail does not change the origin point\r\n        }\r\n    }\r\n    initlizeBasicArea() {\r\n        const result = [];\r\n        for (let i = 0; i < this.areaRows; i++) {\r\n            result[i] = [];\r\n            for (let j = 0; j < this.areaCols; j++) {\r\n                result[i][j] = 0;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AnimationDataNode) {\r\n            this._loop = src.loop;\r\n            this._baseLoc = src.baseLoc;\r\n            this._frameName = src.frameName;\r\n            this._frameRate = src.frameRate;\r\n            this._collisionArea = src.collisionArea;\r\n            this._collisionOriginPoint = src.collisionOriginPoint;\r\n            this._walkableArea = src.walkableArea;\r\n            this._walkableOriginPoint = src.walkableOriginPoint;\r\n        }\r\n    }\r\n}\r\nexports.AnimationDataNode = AnimationDataNode;\r\n//# sourceMappingURL=animations.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/animations.js?')},"../game-capsule/dist/lib/configobjects/attribute.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nclass AttributeNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._key = "";\r\n        this.name = "自定义属性";\r\n    }\r\n    get key() {\r\n        return this._key;\r\n    }\r\n    set key(k) {\r\n        this._key = k;\r\n    }\r\n    set basicTypeVal(v) {\r\n        // if (_.isBoolean(v)) {\r\n        //     this._boolVal = v;\r\n        // }\r\n        // if (_.isNumber(v)) {\r\n        //     this._intVal = v;\r\n        // }\r\n        // if (_.isString(v)) {\r\n        //     this._strVal = v;\r\n        // }\r\n        if (typeof v === "boolean") {\r\n            this._boolVal = v;\r\n        }\r\n        if (typeof v === "number") {\r\n            this._intVal = v;\r\n        }\r\n        if (typeof v === "string") {\r\n            this._strVal = v;\r\n        }\r\n    }\r\n    get basicTypeVal() {\r\n        if (_.isUndefined(this._boolVal))\r\n            return this._boolVal;\r\n        if (_.isUndefined(this._intVal))\r\n            return this._intVal;\r\n        if (_.isUndefined(this._strVal))\r\n            return this._strVal;\r\n        return;\r\n    }\r\n    get intVal() {\r\n        return this._intVal;\r\n    }\r\n    set intVal(m) {\r\n        this._intVal = m;\r\n    }\r\n    get strVal() {\r\n        return this._strVal;\r\n    }\r\n    set strVal(m) {\r\n        this._strVal = m;\r\n    }\r\n    get boolVal() {\r\n        return this._boolVal;\r\n    }\r\n    set boolVal(m) {\r\n        this._boolVal = m;\r\n    }\r\n    get media() {\r\n        return this._media;\r\n    }\r\n    set media(m) {\r\n        this._media = m;\r\n    }\r\n    get title() {\r\n        return this._title;\r\n    }\r\n    set title(val) {\r\n        this._title = val;\r\n    }\r\n    get description() {\r\n        return this._description;\r\n    }\r\n    set description(val) {\r\n        this._description = val;\r\n    }\r\n    get properties() {\r\n        return {\r\n            key: this._key,\r\n            intVal: this._intVal,\r\n            strVal: this._strVal,\r\n            boolVal: this._boolVal,\r\n            media: this._media,\r\n            description: this._description,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.attr)) {\r\n            game.attr = [];\r\n        }\r\n        return game.attr;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Attribute.create();\r\n        obj.node = this.makeNode();\r\n        obj.key = this._key;\r\n        obj.intVal = this._intVal;\r\n        obj.strVal = this._strVal;\r\n        obj.boolVal = this._boolVal;\r\n        obj.media = this._media;\r\n        obj.description = this._description;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._key = obj.key;\r\n        if (typeof obj.intVal === "number") {\r\n            this._intVal = obj.intVal;\r\n        }\r\n        else {\r\n            this._intVal = undefined;\r\n        }\r\n        if (typeof obj.strVal === "string") {\r\n            this._strVal = obj.strVal;\r\n        }\r\n        else {\r\n            this._strVal = undefined;\r\n        }\r\n        if (typeof obj.boolVal === "boolean") {\r\n            this._boolVal = obj.boolVal;\r\n        }\r\n        else {\r\n            this._boolVal = undefined;\r\n        }\r\n        this._media = obj.media || undefined;\r\n        this._description = obj.description;\r\n    }\r\n    geneSequence() {\r\n        // edit by 7, 不要把值也纳入到基因算法中，attribute在序列化的时候不要ignore\r\n        // Only attribute key name is a genetic characteristics\r\n        return "" + this._key;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AttributeNode) {\r\n            this._key = src.key;\r\n            const basic = src.basicTypeVal;\r\n            // if (_.isNumber(basic)) this._intVal = basic;\r\n            // if (_.isString(basic)) this._strVal = basic;\r\n            // if (_.isBoolean(basic)) this._boolVal = basic;\r\n            this.basicTypeVal = basic;\r\n            const media = src.media;\r\n            if (media)\r\n                this._media = media;\r\n            if (src.description)\r\n                this._description = src.description;\r\n        }\r\n    }\r\n}\r\nexports.default = AttributeNode;\r\n//# sourceMappingURL=attribute.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/attribute.js?')},"../game-capsule/dist/lib/configobjects/avatar.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nclass AvatarNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        // 缓存\r\n        this._sets = [];\r\n        // {部件slot名：avatarSet}\r\n        this._parts = {};\r\n        this._dir = AvatarDirEnum.Front;\r\n        this._animations = ["idle", "walk", "sit", "run", "jump", "attack"];\r\n        this._curAnimationIndex = 0;\r\n        this._dbName = "bones_human01";\r\n        this._armatureName = "Armature";\r\n        this._dircy = false;\r\n        this.name = "变装";\r\n        this._backMap = {};\r\n        this._backMap["head_hair"] = ["head_hair", "head_back"];\r\n        this._backMap["body_cost"] = ["body_cost", "body_dres"];\r\n        this.defaultCostume();\r\n    }\r\n    // 将一组AvatatSet整合到一起形成一个完整的Avatar，并保存到self._parts里\r\n    merge(newSets) {\r\n        // 解决替换发型，后发分层存在的问题\r\n        for (let i = 0; i < newSets.length; i++) {\r\n            for (const key in this._backMap) {\r\n                if (this._backMap.hasOwnProperty(key)) {\r\n                    const parts = newSets[i].parts;\r\n                    for (const part of parts) {\r\n                        if (part === key) {\r\n                            _.remove(this._sets, n => {\r\n                                return part === key;\r\n                            });\r\n                            this._parts = _.omit(this._parts, this._backMap[key]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._sets = this._sets.concat(newSets);\r\n        for (const set of this._sets) {\r\n            for (const part of set.parts) {\r\n                this._parts[part] = set;\r\n            }\r\n        }\r\n        this._dircy = true;\r\n    }\r\n    // 获取整个avatar的部件标签对应的部件id\r\n    get parts() {\r\n        return this._parts;\r\n    }\r\n    // 获取整个avatar的部件标签对应的资源相对路径\r\n    resources(dir) {\r\n        const res = [];\r\n        const parts = this._parts;\r\n        for (const key in parts) {\r\n            if (parts.hasOwnProperty(key)) {\r\n                let set = parts[key];\r\n                if (!set.hasOwnProperty("localImages")) {\r\n                    // eyes mous 没有背面素材\r\n                    if (dir === 1 && key === "head_eyes") {\r\n                        // Do nothing\r\n                    }\r\n                    else if (dir === 1 && key === "head_mous") {\r\n                        // Do nothing\r\n                    }\r\n                    else if (key === "head_back") {\r\n                        res.push(this.relativeUri("head_hair", set.id, dir, "back"));\r\n                    }\r\n                    else if (key === "body_dres") {\r\n                        res.push(this.relativeUri("body_cost", set.id, dir, "dres"));\r\n                    }\r\n                    else {\r\n                        res.push(this.relativeUri(key, set.id, dir));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n    // 从部件ID转换为资源相对路径\r\n    relativeUri(part, id, dir, layer) {\r\n        if (layer) {\r\n            return `/avatar/part/${part}_${id}_${dir}_${layer}.png`;\r\n        }\r\n        return `/avatar/part/${part}_${id}_${dir}.png`;\r\n    }\r\n    // 返回自己应该去的容器数值，在Igame里的数值。如果没有初始化一个空数值。\r\n    // Used by super.serialize()\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.avatar)) {\r\n            game.avatar = [];\r\n        }\r\n        return game.avatar;\r\n    }\r\n    // 创建protobuf 对象用来序列化。\r\n    // Used by super.serialize()\r\n    createProtocolObject() {\r\n        const avatar = pixelpai_proto_1.op_gameconfig_01.Avatar.create();\r\n        avatar.node = this.makeNode();\r\n        avatar.defaultDir = this._dir;\r\n        // assign more properties to avatar\r\n        const reg = /[_]\\w/;\r\n        for (const partName in this.parts) {\r\n            const part = partName.replace(reg, s => {\r\n                return s.length > 1 ? s[1].toUpperCase() : s;\r\n            }) + "Id";\r\n            avatar[part] = this.parts[partName].id;\r\n        }\r\n        return avatar;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const avatar = data;\r\n        // deserialize other properties\r\n        this._dir = avatar.defaultDir;\r\n        if (avatar.backboneId)\r\n            this._parts["head_eyes"] = {\r\n                id: avatar.backboneId,\r\n                parts: ["head_eyes"],\r\n            };\r\n        if (avatar.barmBaseId)\r\n            this._parts["barm_base"] = {\r\n                id: avatar.barmBaseId,\r\n                parts: ["barm_base"],\r\n            };\r\n        if (avatar.barmCostId)\r\n            this._parts["barm_cost"] = {\r\n                id: avatar.barmCostId,\r\n                parts: ["barm_cost"],\r\n            };\r\n        if (avatar.barmShldId)\r\n            this._parts["barm_shld"] = {\r\n                id: avatar.barmShldId,\r\n                parts: ["barm_shld"],\r\n            };\r\n        if (avatar.barmSpecId)\r\n            this._parts["barm_spec"] = {\r\n                id: avatar.barmSpecId,\r\n                parts: ["barm_spec"],\r\n            };\r\n        if (avatar.barmWeapId)\r\n            this._parts["barm_weap"] = {\r\n                id: avatar.barmWeapId,\r\n                parts: ["barm_weap"],\r\n            };\r\n        if (avatar.blegBaseId)\r\n            this._parts["bleg_base"] = {\r\n                id: avatar.blegBaseId,\r\n                parts: ["bleg_base"],\r\n            };\r\n        if (avatar.blegCostId)\r\n            this._parts["bleg_cost"] = {\r\n                id: avatar.blegCostId,\r\n                parts: ["bleg_cost"],\r\n            };\r\n        if (avatar.blegSpecId)\r\n            this._parts["bleg_spec"] = {\r\n                id: avatar.blegSpecId,\r\n                parts: ["bleg_spec"],\r\n            };\r\n        if (avatar.bodyBaseId)\r\n            this._parts["body_base"] = {\r\n                id: avatar.bodyBaseId,\r\n                parts: ["body_base"],\r\n            };\r\n        if (avatar.bodyCostId)\r\n            this._parts["body_cost"] = {\r\n                id: avatar.bodyCostId,\r\n                parts: ["body_cost"],\r\n            };\r\n        if (avatar.bodyDresId)\r\n            this._parts["body_dres"] = {\r\n                id: avatar.bodyDresId,\r\n                parts: ["body_dres"],\r\n            };\r\n        if (avatar.bodySpecId)\r\n            this._parts["body_spec"] = {\r\n                id: avatar.bodySpecId,\r\n                parts: ["body_spec"],\r\n            };\r\n        if (avatar.bodyTailId)\r\n            this._parts["body_tail"] = {\r\n                id: avatar.bodyTailId,\r\n                parts: ["body_tail"],\r\n            };\r\n        if (avatar.bodyWingId)\r\n            this._parts["body_wing"] = {\r\n                id: avatar.bodyWingId,\r\n                parts: ["body_wing"],\r\n            };\r\n        if (avatar.farmBaseId)\r\n            this._parts["farm_base"] = {\r\n                id: avatar.farmBaseId,\r\n                parts: ["farm_base"],\r\n            };\r\n        if (avatar.farmCostId)\r\n            this._parts["farm_cost"] = {\r\n                id: avatar.farmCostId,\r\n                parts: ["farm_cost"],\r\n            };\r\n        if (avatar.farmShldId)\r\n            this._parts["farm_shld"] = {\r\n                id: avatar.farmShldId,\r\n                parts: ["farm_shld"],\r\n            };\r\n        if (avatar.farmWeapId)\r\n            this._parts["farm_weap"] = {\r\n                id: avatar.farmWeapId,\r\n                parts: ["farm_weap"],\r\n            };\r\n        if (avatar.flegBaseId)\r\n            this._parts["fleg_base"] = {\r\n                id: avatar.flegBaseId,\r\n                parts: ["fleg_base"],\r\n            };\r\n        if (avatar.flegCostId)\r\n            this._parts["fleg_cost"] = {\r\n                id: avatar.flegCostId,\r\n                parts: ["fleg_cost"],\r\n            };\r\n        if (avatar.flegSpecId)\r\n            this._parts["fleg_spec"] = {\r\n                id: avatar.flegSpecId,\r\n                parts: ["fleg_spec"],\r\n            };\r\n        if (avatar.headBackId)\r\n            this._parts["head_back"] = {\r\n                id: avatar.headBackId,\r\n                parts: ["head_back"],\r\n            };\r\n        if (avatar.headBaseId)\r\n            this._parts["head_base"] = {\r\n                id: avatar.headBaseId,\r\n                parts: ["head_base"],\r\n            };\r\n        if (avatar.headEyesId)\r\n            this._parts["head_eyes"] = {\r\n                id: avatar.headEyesId,\r\n                parts: ["head_eyes"],\r\n            };\r\n        if (avatar.headHairId)\r\n            this._parts["head_hair"] = {\r\n                id: avatar.headHairId,\r\n                parts: ["head_hair"],\r\n            };\r\n        if (avatar.headHatsId)\r\n            this._parts["head_hats"] = {\r\n                id: avatar.headHatsId,\r\n                parts: ["head_hats"],\r\n            };\r\n        if (avatar.headMaskId)\r\n            this._parts["head_mask"] = {\r\n                id: avatar.headMaskId,\r\n                parts: ["head_mask"],\r\n            };\r\n        if (avatar.headMousId)\r\n            this._parts["head_mous"] = {\r\n                id: avatar.headMousId,\r\n                parts: ["head_mous"],\r\n            };\r\n        if (avatar.headSpecId)\r\n            this._parts["head_spec"] = {\r\n                id: avatar.headSpecId,\r\n                parts: ["head_spec"],\r\n            };\r\n    }\r\n    clearParts() {\r\n        this._parts = {};\r\n        this._sets.length = 0;\r\n        this.defaultCostume();\r\n        this._dircy = true;\r\n    }\r\n    set dir(value) {\r\n        this._dir = value;\r\n        this._dircy = true;\r\n    }\r\n    get dir() {\r\n        return this._dir;\r\n    }\r\n    set dirty(value) {\r\n        this._dircy = value;\r\n    }\r\n    get dirty() {\r\n        return this._dircy;\r\n    }\r\n    set curAnimationIndex(val) {\r\n        if (val < 0 || val >= this._animations.length) {\r\n            val = 0;\r\n        }\r\n        this._curAnimationIndex = val;\r\n        this._dircy = true;\r\n    }\r\n    get curAnimationIndex() {\r\n        return this._curAnimationIndex;\r\n    }\r\n    set armatureName(val) {\r\n        this._armatureName = val;\r\n    }\r\n    get armatureName() {\r\n        return this._armatureName;\r\n    }\r\n    set dbName(val) {\r\n        this._dbName = val;\r\n    }\r\n    get dbName() {\r\n        return this._dbName;\r\n    }\r\n    getCurAnimation(dir) {\r\n        return `${this._animations[this._curAnimationIndex]}_${dir ? dir : this._dir}`;\r\n    }\r\n    defaultCostume() {\r\n        const defaulAvatar = [\r\n            { id: "0001", parts: ["head_base"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_hair"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_eyes"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_mous"] },\r\n            { id: "0001", parts: ["body_base"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["body_cost"] },\r\n            { id: "0001", parts: ["farm_base"] },\r\n            { id: "0001", parts: ["barm_base"] },\r\n            { id: "0001", parts: ["fleg_base"] },\r\n            { id: "0001", parts: ["bleg_base"] },\r\n            { id: "0001", parts: ["farm_base"] },\r\n        ];\r\n        this.merge(defaulAvatar);\r\n    }\r\n}\r\nexports.default = AvatarNode;\r\nvar AvatarDirEnum;\r\n(function (AvatarDirEnum) {\r\n    AvatarDirEnum[AvatarDirEnum["Back"] = 1] = "Back";\r\n    AvatarDirEnum[AvatarDirEnum["Front"] = 3] = "Front";\r\n})(AvatarDirEnum = exports.AvatarDirEnum || (exports.AvatarDirEnum = {}));\r\n//# sourceMappingURL=avatar.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/avatar.js?')},"../game-capsule/dist/lib/configobjects/character.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst avatar_1 = __webpack_require__(/*! ./avatar */ "../game-capsule/dist/lib/configobjects/avatar.js");\r\nclass CharacterNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "游戏角色";\r\n    }\r\n    get camp() {\r\n        return this._camp || this.cap.add.camp(1, this);\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof CampNode) {\r\n            this._camp = object;\r\n        }\r\n        if (object instanceof avatar_1.default) {\r\n            this._avatar = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof CampNode) {\r\n            this._camp = undefined;\r\n        }\r\n        if (object instanceof avatar_1.default) {\r\n            this._avatar = undefined;\r\n        }\r\n    }\r\n}\r\nexports.default = CharacterNode;\r\nclass CampNode extends config_object_1.BaseConfigObject {\r\n    get properties() {\r\n        return {\r\n            maxNumber: this._maxNumber,\r\n        };\r\n    }\r\n    get maxPlayers() {\r\n        return this._maxNumber || 0;\r\n    }\r\n    set maxPlayers(n) {\r\n        this._maxNumber = n;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.camp)) {\r\n            game.camp = [];\r\n        }\r\n        return game.camp;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Camp.create();\r\n        obj.node = this.makeNode();\r\n        obj.maxNumber = this._maxNumber || 0;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        if (obj.maxNumber)\r\n            this._maxNumber = obj.maxNumber;\r\n    }\r\n}\r\nexports.CampNode = CampNode;\r\n//# sourceMappingURL=character.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/character.js?')},"../game-capsule/dist/lib/configobjects/config_object.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst metadata_1 = __webpack_require__(/*! ./metadata */ "../game-capsule/dist/lib/configobjects/metadata.js");\r\nconst constants_1 = __webpack_require__(/*! ../constants */ "../game-capsule/dist/lib/constants.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass BaseConfigObject extends metadata_1.default {\r\n    constructor(cap, parent) {\r\n        super(cap);\r\n        this._fork = false;\r\n        this.parentObject = parent;\r\n        this.type = constants_1.default.NODE_T.indexOf(this.className);\r\n    }\r\n    renewId(theNewId) {\r\n        const oldId = this.id;\r\n        const newId = theNewId || helpers_1.default.genId();\r\n        const children_ids = [];\r\n        for (const child of this.children) {\r\n            children_ids.push(child.id);\r\n        }\r\n        this.unlink(); // 需要把老的数据删除\r\n        this.id = newId;\r\n        this.cap.removeObjectById(oldId);\r\n        if (!this.cap.getObject(this.id)) {\r\n            this.cap.addObject(this);\r\n        }\r\n        // I am new!!\r\n        for (const id of children_ids) {\r\n            const obj = this.cap.getObject(id);\r\n            if (obj) {\r\n                obj.parent = newId;\r\n                obj.renewId();\r\n            }\r\n        }\r\n    }\r\n    copyId(id) {\r\n        this.id = id;\r\n    }\r\n    // a candy\r\n    get children() {\r\n        return this.cap.getChildrenList(this.id);\r\n    }\r\n    get isFork() {\r\n        return this._fork;\r\n    }\r\n    set isFork(val) {\r\n        this._fork = val;\r\n    }\r\n    ignore() {\r\n        for (const child of this.children) {\r\n            child.ignore();\r\n        }\r\n    }\r\n    preSerialize() {\r\n        // Do nothing here.\r\n    }\r\n    serialize(container) {\r\n        //1-0. if ignore serialize return\r\n        if (this.cap.ignoreList.get(this.id))\r\n            return;\r\n        // 1-1. choose my box.\r\n        const arr = this.findMyContainer(container);\r\n        // 1-2. jump into the box.\r\n        arr.push(this.createProtocolObject());\r\n    }\r\n    deserialize(data) {\r\n        if (data && data.hasOwnProperty("node")) {\r\n            const node = data["node"];\r\n            // node is an Object\r\n            if (node) {\r\n                this.setNode(node);\r\n            }\r\n        }\r\n        this.cap.addObject(this);\r\n    }\r\n    findMyContainer(game) {\r\n        throw new Error(`Subclass must override this method! BaseConfigObject::findMyContainer`);\r\n    }\r\n    createProtocolObject() {\r\n        throw new Error(`Subclass must override this method! BaseConfigObject::createProtocolObject`);\r\n    }\r\n    appendNode(object) {\r\n        // do nothing. but check.\r\n        if (object.parent !== this.id) {\r\n            throw new Error(`${this.className}.appendNode(): I am not parent of Object[${object.className}.${object.id}].`);\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        // do nothing. but check.\r\n        if (object.parent !== this.id) {\r\n            throw new Error(`${this.className}.removeNode(): I am not parent of Object[${object.className}.${object.id}].`);\r\n        }\r\n    }\r\n    link() {\r\n        const p = this.parentObject;\r\n        if (p) {\r\n            p.appendNode(this);\r\n        }\r\n    }\r\n    unlink() {\r\n        const p = this.parentObject;\r\n        if (p) {\r\n            p.removeNode(this);\r\n        }\r\n    }\r\n    destroy() {\r\n        // remove my children\r\n        for (const child of this.children) {\r\n            if (child)\r\n                child.destroy();\r\n        }\r\n        //  remove myself from index\r\n        this.cap.removeObject(this);\r\n        //  destroy metadata\r\n        super.destroy();\r\n    }\r\n    // 获取基因序列，判断2个复合对象是否是同族。子类请扩展此方法\r\n    // 在克隆时判断是否要分叉。\r\n    // 在还原是判断是否要将一个Fork对象还原成本体。\r\n    geneSequence() {\r\n        return this.className;\r\n    }\r\n    // 从另一个ConfigObject对象上复制成员\r\n    // 此方法被Capsule.clone()方法调用，有成员属性的Node必须重写\r\n    duplicate(src) {\r\n        // 复制节点元数据\r\n        this.name = src.name;\r\n    }\r\n}\r\nexports.BaseConfigObject = BaseConfigObject;\r\nclass EntityNode extends BaseConfigObject {\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.entity)) {\r\n            game.entity = [];\r\n        }\r\n        return game.entity;\r\n    }\r\n    createProtocolObject() {\r\n        const ele = pixelpai_proto_1.op_gameconfig_01.Entity.create();\r\n        ele.node = this.makeNode();\r\n        return ele;\r\n    }\r\n}\r\nexports.EntityNode = EntityNode;\r\n//# sourceMappingURL=config_object.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/config_object.js?')},"../game-capsule/dist/lib/configobjects/display.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass DisplayNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._texturePath = "";\r\n        this._dataPath = "";\r\n        this.name = "显示元件";\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    get properties() {\r\n        return {\r\n            texturePath: this._texturePath,\r\n            dataPath: this._dataPath,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!game.display) {\r\n            game.display = [];\r\n        }\r\n        return game.display;\r\n    }\r\n    createProtocolObject() {\r\n        const display = pixelpai_proto_1.op_gameconfig_01.Display.create();\r\n        display.node = this.makeNode();\r\n        display.texturePath = this._texturePath;\r\n        display.dataPath = this._dataPath;\r\n        return display;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._dataPath = as.dataPath || "";\r\n        this._texturePath = as.texturePath || "";\r\n    }\r\n    get texturePath() {\r\n        return this._texturePath;\r\n    }\r\n    set texturePath(value) {\r\n        this._texturePath = value;\r\n    }\r\n    get dataPath() {\r\n        return this._dataPath;\r\n    }\r\n    set dataPath(value) {\r\n        this._dataPath = value;\r\n    }\r\n    set dataJSON(value) {\r\n        this._dataJSON = value;\r\n    }\r\n    get dataJSON() {\r\n        return this._dataJSON;\r\n    }\r\n    set textureBuffer(texture) {\r\n        this._textureBuffer = texture;\r\n    }\r\n    get textureBuffer() {\r\n        return this._textureBuffer;\r\n    }\r\n    geneSequence() {\r\n        return helpers_1.default.sha1(this._dataPath + "&" + this._texturePath);\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof DisplayNode) {\r\n            this._dataPath = src.dataPath;\r\n            this._texturePath = src.texturePath;\r\n        }\r\n    }\r\n}\r\nexports.default = DisplayNode;\r\n//# sourceMappingURL=display.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/display.js?')},"../game-capsule/dist/lib/configobjects/element.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst location_1 = __webpack_require__(/*! ./location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\n// Element is a simple Entity =)\r\nclass ElementNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "物件";\r\n    }\r\n    get animations() {\r\n        if (!this._animations) {\r\n            this._animations = this.cap.add.animations(this);\r\n        }\r\n        return this._animations;\r\n    }\r\n    get location() {\r\n        if (!this._location) {\r\n            this._location = this.cap.add.location(this);\r\n        }\r\n        return this._location;\r\n    }\r\n    set thumb(val) {\r\n        this._thumb = val;\r\n    }\r\n    get thumb() {\r\n        return this._thumb;\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof location_1.default) {\r\n            this._location = object;\r\n        }\r\n        if (object instanceof animations_1.default) {\r\n            this._animations = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof location_1.default) {\r\n            this._location = undefined;\r\n        }\r\n        if (object instanceof animations_1.default) {\r\n            this._animations = undefined;\r\n        }\r\n    }\r\n    importSprite(sprite) {\r\n        this.cap.removeObject(this);\r\n        this.id = sprite.id;\r\n        this.name = sprite.nickname || this.name;\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            if (this.location) {\r\n                this.location.destroy();\r\n            }\r\n            this._location = this._cap.add.location(this);\r\n            this._location.x = point.x;\r\n            this._location.y = point.y;\r\n            this._location.z = point.z || 0;\r\n        }\r\n        if (sprite.animations) {\r\n            if (this.animations) {\r\n                this.animations.destroy();\r\n            }\r\n            this._animations = this._cap.add.animations(this);\r\n            this._animations.importSprite(sprite);\r\n        }\r\n        this.cap.addObject(this);\r\n        return this;\r\n    }\r\n    syncSprite(sprite) {\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        this.animations.syncSprite(sprite);\r\n        return this;\r\n    }\r\n    convertToSprite() {\r\n        const spriet = pixelpai_proto_1.op_client.Sprite.create();\r\n        spriet.id = this.id;\r\n        spriet.nickname = this.name;\r\n        const point3 = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n        point3.x = this.location.x;\r\n        point3.y = this.location.y;\r\n        point3.z = this.location.z;\r\n        spriet.point3f = point3;\r\n        spriet.sn = this.sn;\r\n        if (this._animations) {\r\n            spriet.currentAnimationName = this._animations.defaultAnimationName;\r\n            spriet.direction = this._animations.dir || 3;\r\n            if (this._animations.animationData) {\r\n                if (this._animations.dir)\r\n                    spriet.direction = this._animations.dir;\r\n            }\r\n            const display = this._animations.display;\r\n            if (display) {\r\n                spriet.display = pixelpai_proto_1.op_gameconfig.Display.create();\r\n                spriet.display.dataPath = display.dataPath;\r\n                spriet.display.texturePath = display.texturePath;\r\n            }\r\n            const animations = this._animations.animationData;\r\n            spriet.animations = [];\r\n            for (const aniData of animations) {\r\n                spriet.animations.push(aniData.convertToClientObject(this._animations.scale));\r\n            }\r\n        }\r\n        return spriet;\r\n    }\r\n    convertToClientElement() {\r\n        const ele = pixelpai_proto_1.op_client.Element.create();\r\n        ele.id = this.id;\r\n        ele.type = pixelpai_proto_1.op_def.NodeType[this.type];\r\n        if (this.location) {\r\n            const { x, y, z } = this.location;\r\n            ele.x = x;\r\n            ele.y = y;\r\n            if (z) {\r\n                ele.z = z;\r\n            }\r\n        }\r\n        if (this._animations) {\r\n            ele.animationName = this._animations.defaultAnimationName;\r\n            ele.scale = this._animations.scale || false;\r\n            if (this._animations.animationData) {\r\n                if (this._animations.dir)\r\n                    ele.dir = this._animations.dir;\r\n            }\r\n            if (this._animations.display) {\r\n                ele.display = pixelpai_proto_1.op_gameconfig.Display.create();\r\n                ele.display.dataPath = this.animations.display.dataPath;\r\n                ele.display.texturePath = this.animations.display.texturePath;\r\n            }\r\n            const animations = this._animations.animationData;\r\n            ele.animations = [];\r\n            for (const aniData of animations) {\r\n                ele.animations.push(aniData.convertToClientObject(this._animations.scale));\r\n            }\r\n        }\r\n        return ele;\r\n    }\r\n    geneSequence() {\r\n        let gene = super.geneSequence();\r\n        gene += this.parent;\r\n        if (this._location)\r\n            gene += this._location.geneSequence();\r\n        if (this._animations)\r\n            gene += this._animations.geneSequence();\r\n        const children = this.cap.getChildrenList(this.id);\r\n        for (const child of children) {\r\n            if (child instanceof config_object_1.BaseConfigObject) {\r\n                gene += child.geneSequence();\r\n            }\r\n        }\r\n        return helpers_1.default.sha1(gene);\r\n    }\r\n    preSerialize() {\r\n        const gen = this.geneSequence();\r\n        const origin_id = this.cap.families.get(gen);\r\n        if (origin_id) {\r\n            // 已经有源对象存在于此Capsule容器中了, 将本节点和源对象相同的子节点忽略掉。\r\n            for (const child of this.children) {\r\n                child.ignore();\r\n            }\r\n            this._fork = true;\r\n        }\r\n        else {\r\n            this.cap.families.set(gen, this.id);\r\n            this._fork = false;\r\n        }\r\n        // if (!this.animations || this.animations.animationData.length < 1) {\r\n        //     console.warn(\r\n        //         `${this.name} data error, has been deleted. sn: ${this.sn}`\r\n        //     );\r\n        //     this.cap.removeObject(this);\r\n        // }\r\n    }\r\n    // 物件重构父类的序列化方法\r\n    // 和普通节点不同的是，同族的物件需要被分叉为ForkNode，存入IGame.\r\n    createProtocolObject() {\r\n        const ele = pixelpai_proto_1.op_gameconfig_01.Entity.create();\r\n        ele.node = this.makeNode();\r\n        const origin_id = this.cap.families.get(this.geneSequence());\r\n        if (this._fork) {\r\n            const origin_id = this.cap.families.get(this.geneSequence());\r\n            if (!origin_id)\r\n                return;\r\n            // 已经有源对象存在于此Capsule容器中了\r\n            // 现在本对象要存为ForkNode了\r\n            // 改type\r\n            ele.node.type = pixelpai_proto_1.op_def.NodeType.ForkType;\r\n            // 把Fork的parent设置为源对象id\r\n            ele.node.Parent = origin_id;\r\n        }\r\n        return ele;\r\n    }\r\n}\r\nexports.default = ElementNode;\r\n//# sourceMappingURL=element.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/element.js?')},"../game-capsule/dist/lib/configobjects/event.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar GameEvent = pixelpai_proto_1.op_def.GameEvent;\r\nclass EventNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._eventName = GameEvent.onElementActive;\r\n        this.name = "事件";\r\n    }\r\n    get properties() {\r\n        return {\r\n            eventName: this._eventName,\r\n        };\r\n    }\r\n    set eventName(val) {\r\n        if (typeof val === "string") {\r\n            this._eventName = parseInt(val);\r\n        }\r\n        else {\r\n            this._eventName = val;\r\n        }\r\n    }\r\n    get eventName() {\r\n        return this._eventName;\r\n    }\r\n    // geneSequence(): string {\r\n    //     return this.name + this._eventName;\r\n    // }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.event)) {\r\n            game.event = [];\r\n        }\r\n        return game.event;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Event.create();\r\n        obj.node = this.makeNode();\r\n        obj.eventName = this._eventName;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._eventName = obj.eventName;\r\n    }\r\n}\r\nexports.default = EventNode;\r\n//# sourceMappingURL=event.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/event.js?')},"../game-capsule/dist/lib/configobjects/fork.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nconst ConfigObjects = __webpack_require__(/*! ./index */ "../game-capsule/dist/lib/configobjects/index.js");\r\nclass ForkNode extends config_object_1.EntityNode {\r\n    deserialize(data) {\r\n        if (!data || !data.hasOwnProperty("node")) {\r\n            return;\r\n        }\r\n        const node = data["node"];\r\n        const parent = node.Parent;\r\n        let entity;\r\n        // 在反序列化时已经将Fork最后反序列化，确保了Fork的父节点已经在Tree上\r\n        // 这里先获取父节点的公有属性节点 AnimationsNode EventNode\r\n        const origin = this.cap.getObject(parent);\r\n        if (!origin) {\r\n            // 数据有误\r\n            console.error(`${this.className}: My parent[${this.parent}] does not exist.`);\r\n            return;\r\n        }\r\n        const nodeConstructor = origin.className || "";\r\n        if (ConfigObjects.hasOwnProperty(nodeConstructor)) {\r\n            // @ts-ignore\r\n            entity = new ConfigObjects[nodeConstructor](this.cap);\r\n            if (entity) {\r\n                entity.isFork = true;\r\n                entity.parent = origin.parent;\r\n                data.node.Parent = origin.parent;\r\n                entity.deserialize(data);\r\n                entity.link();\r\n            }\r\n        }\r\n        if (entity && origin) {\r\n            // 把fork原本的children 挂到新的对象上\r\n            for (const child of origin.children) {\r\n                // Fork 在反序列的时候其他类型的Node 都已经加到树里了，包括Fork自己的Children\r\n                // 克隆Fork上的子节点到新的对象上。\r\n                if (child instanceof animations_1.default) {\r\n                    this.cap.clone(child.id, entity);\r\n                }\r\n                // if (child instanceof EventNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n                // if (child instanceof AttributeNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n                // if (child instanceof TimerNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n            }\r\n            this.parent = origin.parent;\r\n        }\r\n    }\r\n}\r\nexports.default = ForkNode;\r\n//# sourceMappingURL=fork.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/fork.js?')},"../game-capsule/dist/lib/configobjects/func.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass FunctionNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._fileName = "";\r\n        this._funcName = "";\r\n        this._version = "";\r\n        this.name = "脚本";\r\n        this.newFileName();\r\n    }\r\n    newFileName() {\r\n        this.fileName = `${this.id}-t=${new Date().getTime()}.lua`;\r\n    }\r\n    get properties() {\r\n        return {\r\n            fileName: this._fileName,\r\n            funcName: this._funcName,\r\n            version: this._version,\r\n        };\r\n    }\r\n    idToFilenmae() {\r\n        return `${this.id}?t=${new Date().getTime()}.lua`;\r\n    }\r\n    filenameToId() {\r\n        const index = this.fileName.indexOf("-t=");\r\n        if (index > -1) {\r\n            return parseInt(this.fileName.substring(0, index), 10);\r\n        }\r\n        return 0;\r\n    }\r\n    get fileName() {\r\n        return this._fileName;\r\n    }\r\n    set fileName(val) {\r\n        this._fileName = val;\r\n    }\r\n    get funcName() {\r\n        return this._funcName;\r\n    }\r\n    set funcName(val) {\r\n        this._funcName = val;\r\n    }\r\n    get version() {\r\n        return this._version;\r\n    }\r\n    set version(val) {\r\n        this._version = val;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.func)) {\r\n            game.func = [];\r\n        }\r\n        return game.func;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Function.create();\r\n        obj.node = this.makeNode();\r\n        obj.fileName = this._fileName;\r\n        obj.funcName = this._funcName;\r\n        obj.version = this._version;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._fileName = obj.fileName;\r\n        this._funcName = obj.funcName;\r\n        this._version = obj.version;\r\n    }\r\n    duplicate(src) {\r\n        // by 7\r\n        // super.duplicate(src);\r\n        // if (src instanceof FunctionNode) {\r\n        //     this._fileName = src.fileName;\r\n        //     this._funcName = src.funcName;\r\n        //     this._version = src.version;\r\n        // }\r\n    }\r\n}\r\nexports.default = FunctionNode;\r\n//# sourceMappingURL=func.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/func.js?')},"../game-capsule/dist/lib/configobjects/game.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst terrain_1 = __webpack_require__(/*! ./terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nconst _1 = __webpack_require__(/*! . */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nclass GameNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap) {\r\n        super(cap);\r\n        this._sn_palette = new Map();\r\n        // Game node is the only TOP node in a Capsule.\r\n        this.parent = 0;\r\n        this._settings = new SettingsNode(cap, this);\r\n        this._palette = new PaletteNode(cap, this);\r\n    }\r\n    get properties() {\r\n        return {};\r\n    }\r\n    get settings() {\r\n        return this._settings;\r\n    }\r\n    get palette() {\r\n        return this._palette;\r\n    }\r\n    serialize(container) {\r\n        // DO NOT INVOKE super.serialize()\r\n        // serialize Metadata.\r\n        container.node = this.makeNode();\r\n        container.node.name = "Game";\r\n        // serialize Settings\r\n        this._settings.serialize(container);\r\n        this._palette.serialize(container);\r\n    }\r\n    deserialize(container) {\r\n        // DO NOT INVOKE super.deserialize()\r\n        // deserialize Metadata\r\n        this.setNode(container.node);\r\n        this._settings.deserialize(container);\r\n        this._palette.deserialize(container);\r\n    }\r\n    /****************************** 地块画笔信息和相关方法  ***********************/\r\n    addToPalette(terrain) {\r\n        const [sn, ver] = terrain.getSnAndVersion();\r\n        const snKey = `${sn}#${ver}`;\r\n        if (this._sn_palette.get(snKey)) {\r\n            return;\r\n        }\r\n        const keys = Array.from(this._palette.peersDict.keys());\r\n        let nextKey = 1;\r\n        if (keys.length > 0) {\r\n            const maxKey = Math.max(...keys);\r\n            nextKey = maxKey + 1;\r\n        }\r\n        this._palette.addPeer(nextKey, ver, terrain);\r\n        this.addSnPalette(snKey, nextKey);\r\n    }\r\n    removeFromPalette(key) {\r\n        this._palette.removePeer(key);\r\n    }\r\n    updateOfPalette(key, data) {\r\n        this._palette.updatePeer(key, data);\r\n    }\r\n    getFromPalette(key) {\r\n        return this._palette.getPeer(key);\r\n    }\r\n    getPeerThroughBindId(bindId) {\r\n        return this._palette.getPeerThroughBindId(bindId);\r\n    }\r\n    getPaletteKeyBySn(sn) {\r\n        return this._sn_palette.get(sn);\r\n    }\r\n    addSnPalette(sn, key) {\r\n        this._sn_palette.set(sn, key);\r\n    }\r\n    convertPaletteOfSnKey() {\r\n        for (let key of Array.from(this._palette.peersDict.keys())) {\r\n            const value = this._palette.peersDict.get(key);\r\n            if (value &&\r\n                value.entity.type === pixelpai_proto_1.op_def.NodeType.TerrainNodeType) {\r\n                if (value.entity.sn)\r\n                    this._sn_palette.set(value.entity.sn, key);\r\n            }\r\n        }\r\n    }\r\n    getTerrainPaletteKeyBySn(sn) {\r\n        return this._sn_palette.get(sn);\r\n    }\r\n}\r\nexports.default = GameNode;\r\nclass SettingsNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._spawn_point = 0;\r\n        this._max_number = 10;\r\n    }\r\n    get spawnpoint() {\r\n        return this._spawn_point;\r\n    }\r\n    set spawnpoint(id) {\r\n        this._spawn_point = id;\r\n    }\r\n    get maxNumber() {\r\n        return this._max_number;\r\n    }\r\n    set maxNumber(v) {\r\n        if (v) {\r\n            this._max_number = v;\r\n        }\r\n    }\r\n    get properties() {\r\n        return {\r\n            spawnpoint: this._spawn_point,\r\n            maxNumber: this._max_number,\r\n        };\r\n    }\r\n    serialize(container) {\r\n        const self = this;\r\n        container.settings = pixelpai_proto_1.op_gameconfig_01.Settings.create();\r\n        container.settings.node = self.makeNode();\r\n        if (self.maxNumber) {\r\n            container.settings.maxNumber = self.maxNumber;\r\n        }\r\n        else {\r\n            container.settings.maxNumber = null;\r\n        }\r\n        container.settings.spawnpointid = self.spawnpoint;\r\n    }\r\n    deserialize(container) {\r\n        const settings = container.settings;\r\n        if (settings) {\r\n            this.setNode(settings.node);\r\n            this._spawn_point = settings.spawnpointid;\r\n            if (settings.maxNumber) {\r\n                this._max_number = settings.maxNumber;\r\n            }\r\n            else {\r\n                this._max_number = null;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.SettingsNode = SettingsNode;\r\nclass PaletteNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._peers = [];\r\n        this._peersDict = new Map();\r\n    }\r\n    get peers() {\r\n        return this._peers;\r\n    }\r\n    get peersDict() {\r\n        return this._peersDict;\r\n    }\r\n    convertToPeerDict() {\r\n        this._peersDict = new Map();\r\n        for (const peer of this.peers) {\r\n            if (peer.entity) {\r\n                const [sn, ver,] = peer.entity.getSnAndVersion();\r\n                this._peersDict.set(peer.key, {\r\n                    ver,\r\n                    entity: peer.entity,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    convertToPeers() {\r\n        let ret = [];\r\n        for (const key of Array.from(this._peersDict.keys())) {\r\n            const value = this._peersDict.get(key);\r\n            if (value) {\r\n                const terrain = value.entity;\r\n                ret.push({\r\n                    key,\r\n                    entity: terrain.createProtocolObject(),\r\n                });\r\n                this.cap.addObject(terrain.animations);\r\n                this.cap.addObject(terrain.animations.display);\r\n                for (const ani of terrain.animations.animationData) {\r\n                    this.cap.addObject(ani);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    addPeer(key, ver, entity) {\r\n        this._peersDict.set(key, { ver, entity });\r\n    }\r\n    getPeer(key) {\r\n        const peerValue = this._peersDict.get(key);\r\n        if (peerValue) {\r\n            const { ver, entity } = peerValue;\r\n            return entity;\r\n        }\r\n    }\r\n    getPeerThroughBindId(bindId) {\r\n        const peer = Array.from(this._peersDict.values()).find(peerValue => {\r\n            const { ver, entity } = peerValue;\r\n            return entity.id === bindId;\r\n        });\r\n        return peer;\r\n    }\r\n    removePeer(key) {\r\n        this._peersDict.delete(key);\r\n    }\r\n    updatePeer(key, entity) {\r\n        this._peersDict.set(key, entity.createProtocolObject());\r\n    }\r\n    serialize(container) {\r\n        const self = this;\r\n        container.palette = pixelpai_proto_1.op_gameconfig_01.Palette.create();\r\n        container.palette.node = self.makeNode();\r\n        container.palette.node.Parent = this._cap.root.id;\r\n        container.palette.peers = this.convertToPeers();\r\n        // 特殊处理\r\n    }\r\n    deserialize(container) {\r\n        const palette = container.palette;\r\n        this._peers = [];\r\n        if (palette) {\r\n            this.setNode(palette.node);\r\n            if (palette.peers) {\r\n                for (const peer of palette.peers) {\r\n                    if (peer.entity &&\r\n                        peer.entity.node.type ===\r\n                            pixelpai_proto_1.op_def.NodeType.TerrainNodeType) {\r\n                        const terrainNode = new terrain_1.TerrainNode(this._cap);\r\n                        terrainNode.deserialize(peer.entity);\r\n                        // 需要将地块的animationData和display数据link\r\n                        for (const ani of container.animations) {\r\n                            if (ani.node.Parent === terrainNode.id) {\r\n                                const aniNode = new _1.AnimationsNode(this._cap, terrainNode);\r\n                                aniNode.deserialize(ani);\r\n                                aniNode.link();\r\n                                for (const dpl of container.display) {\r\n                                    if (dpl.node.Parent === ani.node.id) {\r\n                                        const dplNode = new _1.DisplayNode(this._cap, aniNode);\r\n                                        dplNode.deserialize(dpl);\r\n                                        dplNode.link();\r\n                                    }\r\n                                }\r\n                                for (const aniData of container.animationdatas) {\r\n                                    if (aniData.node.Parent === ani.node.id) {\r\n                                        const aniDataNode = new animations_1.AnimationDataNode(this._cap, aniNode);\r\n                                        aniDataNode.deserialize(aniData);\r\n                                        aniDataNode.link();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        // scene场景不需要地块节点\r\n                        this._cap.removeObject(terrainNode);\r\n                        this._peers.push({\r\n                            key: peer.key,\r\n                            entity: terrainNode,\r\n                        });\r\n                    }\r\n                }\r\n                this.convertToPeerDict();\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.PaletteNode = PaletteNode;\r\n//# sourceMappingURL=game.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/game.js?')},"../game-capsule/dist/lib/configobjects/index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst game_1 = __webpack_require__(/*! ./game */ "../game-capsule/dist/lib/configobjects/game.js");\r\nexports.GameNode = game_1.default;\r\nexports.SettingsNode = game_1.SettingsNode;\r\nexports.PaletteNode = game_1.PaletteNode;\r\nconst element_1 = __webpack_require__(/*! ./element */ "../game-capsule/dist/lib/configobjects/element.js");\r\nexports.ElementNode = element_1.default;\r\nconst location_1 = __webpack_require__(/*! ./location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nexports.LocationNode = location_1.default;\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nexports.AnimationsNode = animations_1.default;\r\nexports.AnimationDataNode = animations_1.AnimationDataNode;\r\nconst display_1 = __webpack_require__(/*! ./display */ "../game-capsule/dist/lib/configobjects/display.js");\r\nexports.DisplayNode = display_1.default;\r\nconst avatar_1 = __webpack_require__(/*! ./avatar */ "../game-capsule/dist/lib/configobjects/avatar.js");\r\nexports.AvatarNode = avatar_1.default;\r\nconst movable_1 = __webpack_require__(/*! ./movable */ "../game-capsule/dist/lib/configobjects/movable.js");\r\nexports.MovableNode = movable_1.default;\r\nconst attribute_1 = __webpack_require__(/*! ./attribute */ "../game-capsule/dist/lib/configobjects/attribute.js");\r\nexports.AttributeNode = attribute_1.default;\r\nconst func_1 = __webpack_require__(/*! ./func */ "../game-capsule/dist/lib/configobjects/func.js");\r\nexports.FunctionNode = func_1.default;\r\nconst event_1 = __webpack_require__(/*! ./event */ "../game-capsule/dist/lib/configobjects/event.js");\r\nexports.EventNode = event_1.default;\r\nconst ui_1 = __webpack_require__(/*! ./ui */ "../game-capsule/dist/lib/configobjects/ui.js");\r\nexports.UINode = ui_1.default;\r\nexports.ButtonNode = ui_1.ButtonNode;\r\nexports.TextNode = ui_1.TextNode;\r\nconst timer_1 = __webpack_require__(/*! ./timer */ "../game-capsule/dist/lib/configobjects/timer.js");\r\nexports.TimerNode = timer_1.default;\r\nconst spawnpoint_1 = __webpack_require__(/*! ./spawnpoint */ "../game-capsule/dist/lib/configobjects/spawnpoint.js");\r\nexports.SpawnPointNode = spawnpoint_1.default;\r\nconst access_1 = __webpack_require__(/*! ./access */ "../game-capsule/dist/lib/configobjects/access.js");\r\nexports.AccessNode = access_1.AccessNode;\r\nconst scene_1 = __webpack_require__(/*! ./scene */ "../game-capsule/dist/lib/configobjects/scene.js");\r\nexports.SceneNode = scene_1.default;\r\nexports.MapSizeNode = scene_1.MapSizeNode;\r\nexports.TerrainCollectionNode = scene_1.TerrainCollectionNode;\r\nconst fork_1 = __webpack_require__(/*! ./fork */ "../game-capsule/dist/lib/configobjects/fork.js");\r\nexports.ForkNode = fork_1.default;\r\nconst package_1 = __webpack_require__(/*! ./package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nexports.PackageNode = package_1.default;\r\nexports.PackageItemNode = package_1.PackageItemNode;\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nexports.BaseConfigObject = config_object_1.BaseConfigObject;\r\nconst metadata_1 = __webpack_require__(/*! ./metadata */ "../game-capsule/dist/lib/configobjects/metadata.js");\r\nexports.Metadata = metadata_1.default;\r\nconst character_1 = __webpack_require__(/*! ./character */ "../game-capsule/dist/lib/configobjects/character.js");\r\nexports.CharacterNode = character_1.default;\r\nexports.CampNode = character_1.CampNode;\r\nconst terrain_1 = __webpack_require__(/*! ./terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nexports.TerrainNode = terrain_1.TerrainNode;\r\nconst shop_1 = __webpack_require__(/*! ./shop */ "../game-capsule/dist/lib/configobjects/shop.js");\r\nexports.ShopNode = shop_1.default;\r\nexports.ShopItemNode = shop_1.ShopItemNode;\r\nexports.CommodityNode = shop_1.CommodityNode;\r\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/index.js?')},"../game-capsule/dist/lib/configobjects/location.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass LocationNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._z = 0;\r\n        this.name = "位置";\r\n    }\r\n    ignore() { }\r\n    get properties() {\r\n        return {\r\n            x: this._x,\r\n            y: this._y,\r\n            z: this._z,\r\n        };\r\n    }\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    set x(x) {\r\n        this._x = x;\r\n    }\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    set y(y) {\r\n        this._y = y;\r\n    }\r\n    get z() {\r\n        return this._z;\r\n    }\r\n    set z(z) {\r\n        this._z = z;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.loc)) {\r\n            game.loc = [];\r\n        }\r\n        return game.loc;\r\n    }\r\n    createProtocolObject() {\r\n        const location = pixelpai_proto_1.op_gameconfig_01.Location.create();\r\n        location.node = this.makeNode();\r\n        location.x = this._x;\r\n        location.y = this._y;\r\n        return location;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const location = data;\r\n        this._x = location.x;\r\n        this._y = location.y;\r\n    }\r\n    // NOTE!! That LocationNode is not a gene options, cause object\'s location is always different.\r\n    geneSequence() {\r\n        // ignore the genetic characteristics.\r\n        return "";\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof LocationNode) {\r\n            this._x = src.x;\r\n            this._y = src.y;\r\n            this._z = src.z;\r\n        }\r\n    }\r\n}\r\nexports.default = LocationNode;\r\n//# sourceMappingURL=location.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/location.js?')},"../game-capsule/dist/lib/configobjects/metadata.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst Chance = __webpack_require__(/*! chance */ "../game-capsule/node_modules/chance/chance.js");\r\nconst constants_1 = __webpack_require__(/*! ../constants */ "../game-capsule/dist/lib/constants.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nconst chance = new Chance();\r\nclass Metadata {\r\n    constructor(cap) {\r\n        this._id = helpers_1.default.genId();\r\n        this._parent = 0;\r\n        this._sn = "";\r\n        this._type = 0;\r\n        this._cap = cap;\r\n        this._name = `Object-${this.id}`;\r\n    }\r\n    get type() {\r\n        return this._type;\r\n    }\r\n    set type(t) {\r\n        this._type = t;\r\n    }\r\n    get cap() {\r\n        return this._cap;\r\n    }\r\n    set cap(cap) {\r\n        this._cap = cap;\r\n    }\r\n    get metaData() {\r\n        return {\r\n            id: this._id,\r\n            name: this._name,\r\n            Parent: this._parent,\r\n            sn: this._sn,\r\n            type: this.type,\r\n        };\r\n    }\r\n    get className() {\r\n        return helpers_1.default.getClassName(this);\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    set id(id) {\r\n        this._id = id;\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    set name(n) {\r\n        this._name = n;\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    set parent(p) {\r\n        this._parent = p;\r\n    }\r\n    get parentObject() {\r\n        if (this.parent) {\r\n            return this.cap.getObject(this.parent);\r\n        }\r\n        return;\r\n    }\r\n    set parentObject(p) {\r\n        if (p) {\r\n            this.parent = p.id;\r\n        }\r\n    }\r\n    get sn() {\r\n        return this._sn;\r\n    }\r\n    set sn(sn) {\r\n        this._sn = sn;\r\n    }\r\n    get nodeType() {\r\n        if (constants_1.default.NODETYPEMAP[this.type]) {\r\n            return this.type;\r\n        }\r\n        else {\r\n            throw new Error(`This Config object does not match any of type list in NodeType!`);\r\n        }\r\n    }\r\n    makeNode() {\r\n        const self = this;\r\n        return new (class {\r\n            constructor() {\r\n                this.LockParent = null;\r\n                this.Parent = self.parent;\r\n                this.id = self.id;\r\n                this.name = self.name;\r\n                this.sn = self.sn;\r\n                this.type = self.nodeType;\r\n            }\r\n        })();\r\n    }\r\n    setNode(n) {\r\n        if (n.hasOwnProperty("Parent"))\r\n            this._parent = n.Parent;\r\n        if (n.hasOwnProperty("id"))\r\n            this._id = n.id;\r\n        this._sn = n.sn || "";\r\n        if (n.hasOwnProperty("name"))\r\n            this._name = n.name;\r\n    }\r\n    destroy() {\r\n        // Do nothing.\r\n    }\r\n}\r\nexports.default = Metadata;\r\n//# sourceMappingURL=metadata.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/metadata.js?')},"../game-capsule/dist/lib/configobjects/movable.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass MovableNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._dir = 0;\r\n        this._angle = 0;\r\n        this._speed = 0;\r\n    }\r\n    get properties() {\r\n        return {\r\n            dir: this._dir,\r\n            angle: this._angle,\r\n            speed: this._speed,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.movable)) {\r\n            game.movable = [];\r\n        }\r\n        return game.movable;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Movable.create();\r\n        obj.node = this.makeNode();\r\n        if (this._dir)\r\n            obj.dir = this._dir;\r\n        if (this._angle)\r\n            obj.angle = this._angle;\r\n        if (this._speed)\r\n            obj.speed = this._speed;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        if (obj.dir)\r\n            this._dir = obj.dir;\r\n        if (obj.angle)\r\n            this._angle = obj.angle;\r\n        if (obj.speed)\r\n            this._speed = obj.speed;\r\n    }\r\n}\r\nexports.default = MovableNode;\r\n//# sourceMappingURL=movable.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/movable.js?')},"../game-capsule/dist/lib/configobjects/package.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst access_1 = __webpack_require__(/*! ./access */ "../game-capsule/dist/lib/configobjects/access.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass PackageNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._items = [];\r\n        this.name = "背包";\r\n    }\r\n    ignore() { }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) { }\r\n        if (obj instanceof access_1.AccessNode) {\r\n            this._access = obj;\r\n        }\r\n        if (obj.type === NodeType.PackageItemType) {\r\n            this._items.push(obj);\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        super.removeNode(object);\r\n        if (object instanceof access_1.AccessNode) {\r\n            this._access = undefined;\r\n        }\r\n        if (object instanceof access_1.AccessNode) {\r\n            // TODO delete\r\n        }\r\n    }\r\n}\r\nexports.default = PackageNode;\r\nclass PackageItemNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "道具";\r\n    }\r\n    ignore() { }\r\n}\r\nexports.PackageItemNode = PackageItemNode;\r\n//# sourceMappingURL=package.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/package.js?')},"../game-capsule/dist/lib/configobjects/scene.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass SceneNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._elements = new Map();\r\n        this._terrains = new Map();\r\n        this._characters = new Map();\r\n        this._spawnpoints = new Map();\r\n        this.name = "场景";\r\n    }\r\n    get properties() {\r\n        return {};\r\n    }\r\n    get size() {\r\n        return this._map_size;\r\n    }\r\n    get terrainCollection() {\r\n        return this._terrain_collection;\r\n    }\r\n    // 将旧的地块数据转化为新的二维数组结构\r\n    convertOldTerrainData() {\r\n        if (!this._terrain_collection) {\r\n            this._terrain_collection = new TerrainCollectionNode(this._cap, this);\r\n            if (this._map_size) {\r\n                this._terrain_collection.initTerrainCollection(this._map_size);\r\n            }\r\n        }\r\n        this._terrain_collection.convertTerrainNodes(Array.from(this._terrains.values()));\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        switch (object.type) {\r\n            case pixelpai_proto_1.op_def.NodeType.ElementNodeType:\r\n                this._elements.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainNodeType:\r\n                this._terrains.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.CharacterNodeType:\r\n                this._characters.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.SpawnPointType:\r\n                this._spawnpoints.set(object.id, object);\r\n                if (!!this._cap.root.settings.spawnpoint === false) {\r\n                    this._cap.root.settings.spawnpoint = object.id;\r\n                }\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainCollectionType:\r\n                this._terrain_collection = object;\r\n                break;\r\n        }\r\n        if (object instanceof MapSizeNode) {\r\n            this._map_size = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof MapSizeNode) {\r\n            this._map_size = undefined;\r\n        }\r\n        switch (object.type) {\r\n            case pixelpai_proto_1.op_def.NodeType.ElementNodeType:\r\n                this._elements.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainNodeType:\r\n                this._terrains.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.CharacterNodeType:\r\n                this._characters.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.SpawnPointType:\r\n                this._spawnpoints.delete(object.id);\r\n                if (this._cap.root.settings.spawnpoint === object.id) {\r\n                    this._cap.root.settings.spawnpoint = 0;\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    getElements() {\r\n        return Array.from(this._elements.values());\r\n    }\r\n    getTerrains() {\r\n        return Array.from(this._terrains.values());\r\n    }\r\n    getTerrainSprites() {\r\n        let sprites = [];\r\n        if (this._terrain_collection) {\r\n            for (let i = 0; i < this._terrain_collection.data.length; i++) {\r\n                const row = this._terrain_collection.data[i];\r\n                for (let j = 0; j < row.length; j++) {\r\n                    const key = row[j];\r\n                    if (!key) {\r\n                        continue;\r\n                    }\r\n                    const terrain = this._cap.root.palette.getPeer(key);\r\n                    if (terrain) {\r\n                        let sprite = terrain.convertToSprite();\r\n                        if (sprite.point3f) {\r\n                            sprite.point3f.x = i;\r\n                            sprite.point3f.y = j;\r\n                        }\r\n                        sprites.push(sprite);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return sprites;\r\n    }\r\n    getCharacterNode() {\r\n        return Array.from(this._characters.values());\r\n    }\r\n    getSpawnPointNode() {\r\n        return Array.from(this._spawnpoints.values());\r\n    }\r\n    convertToClientScene() {\r\n        const scene = pixelpai_proto_1.op_client.Scene.create();\r\n        scene.id = this.id;\r\n        if (this._map_size) {\r\n            scene.cols = this._map_size.cols;\r\n            scene.rows = this._map_size.rows;\r\n            scene.tileWidth = this._map_size.tileWidth;\r\n            scene.tileHeight = this._map_size.tileHeight;\r\n        }\r\n        if (this._elements) {\r\n            scene.elements = [];\r\n            this._elements.forEach(element => {\r\n                scene.elements.push(element.convertToClientElement());\r\n            });\r\n        }\r\n        if (this._terrains) {\r\n            scene.terrains = [];\r\n            this._terrains.forEach(terrain => {\r\n                scene.terrains.push(terrain.convertToClientTerrain());\r\n            });\r\n        }\r\n        if (this._spawnpoints) {\r\n            if (!scene.elements)\r\n                scene.elements = [];\r\n            this._spawnpoints.forEach(spawnPoint => {\r\n                // TODO 05242019 by 7\r\n                scene.elements.push(spawnPoint.convertToClientElement());\r\n            });\r\n        }\r\n        return scene;\r\n    }\r\n    serialize(container) {\r\n        super.serialize(container);\r\n        if (this._terrain_collection) {\r\n            this._terrain_collection.serialize(container);\r\n        }\r\n    }\r\n}\r\nexports.default = SceneNode;\r\nclass MapSizeNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._cols = 0;\r\n        this._rows = 0;\r\n        this._tileWidth = 60;\r\n        this._tileHeight = 30;\r\n    }\r\n    get properties() {\r\n        return {\r\n            cols: this._cols,\r\n            rows: this._rows,\r\n            tileWidth: this._tileWidth,\r\n            tileHeight: this._tileHeight,\r\n        };\r\n    }\r\n    get rows() {\r\n        return this._rows;\r\n    }\r\n    set rows(n) {\r\n        this._rows = n;\r\n    }\r\n    get cols() {\r\n        return this._cols;\r\n    }\r\n    set cols(n) {\r\n        this._cols = n;\r\n    }\r\n    get tileWidth() {\r\n        return this._tileWidth;\r\n    }\r\n    set tileWidth(val) {\r\n        this._tileWidth = val;\r\n    }\r\n    get tileHeight() {\r\n        return this._tileHeight;\r\n    }\r\n    set tileHeight(val) {\r\n        this._tileHeight = val;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.mapSize)) {\r\n            game.mapSize = [];\r\n        }\r\n        return game.mapSize;\r\n    }\r\n    createProtocolObject() {\r\n        const ms = pixelpai_proto_1.op_gameconfig_01.MapSize.create();\r\n        ms.node = this.makeNode();\r\n        ms.cols = this._cols;\r\n        ms.rows = this._rows;\r\n        ms.tileWidth = this._tileWidth;\r\n        ms.tileHeight = this._tileHeight;\r\n        return ms;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const ms = data;\r\n        // deserialize other properties\r\n        this._rows = ms.rows;\r\n        this._cols = ms.cols;\r\n        this._tileWidth = ms.tileWidth;\r\n        this._tileHeight = ms.tileHeight;\r\n    }\r\n}\r\nexports.MapSizeNode = MapSizeNode;\r\nclass TerrainCollectionNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._data = [];\r\n    }\r\n    // 场景返回二维数组\r\n    get data() {\r\n        return this._data;\r\n    }\r\n    initTerrainCollection(mapSize) {\r\n        this._data = [];\r\n        if (mapSize) {\r\n            const cols = mapSize.cols;\r\n            const rows = mapSize.rows;\r\n            for (let i = 0; i < cols; i++) {\r\n                let row = new Array(rows).fill(0);\r\n                this._data.push(row);\r\n            }\r\n        }\r\n    }\r\n    convertTerrainNodes(terrains) {\r\n        this.cap.root.convertPaletteOfSnKey();\r\n        let terrainAnimationsMap = new Map();\r\n        let terrainAnimationDataMap = new Map();\r\n        let terrainDisplayMap = new Map();\r\n        if (terrains.length > 0) {\r\n            for (const terrain of terrains) {\r\n                const snKey = terrain.getSnKey();\r\n                const key = this.cap.root.getPaletteKeyBySn(snKey);\r\n                if (!key) {\r\n                    this.cap.root.addToPalette(terrain);\r\n                    const tani = terrain.animations;\r\n                    const tdis = terrain.animations.display;\r\n                    const tanidata = terrain.animations.animationData;\r\n                    terrainAnimationsMap.set(terrain.id, tani);\r\n                    terrainDisplayMap.set(terrain.id, tdis);\r\n                    terrainAnimationDataMap.set(terrain.id, tanidata);\r\n                }\r\n                const loc = terrain.convertToSprite();\r\n                if (loc.point3f) {\r\n                    const { x, y, z } = loc.point3f;\r\n                    this._data[x][y] = this.cap.root.getPaletteKeyBySn(snKey);\r\n                }\r\n                terrain.destroy();\r\n            }\r\n            // 将terrain的children加入到_objects中，等待后续serialize\r\n            for (let value of Array.from(terrainAnimationsMap.values())) {\r\n                this.cap.addObject(value);\r\n            }\r\n            for (let value of Array.from(terrainDisplayMap.values())) {\r\n                this.cap.addObject(value);\r\n            }\r\n            for (let value of Array.from(terrainAnimationDataMap.values())) {\r\n                for (const data of value) {\r\n                    this.cap.addObject(data);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    drawTerrains(sprites, version) {\r\n        let oldSprites = [];\r\n        for (const sprite of sprites) {\r\n            if (sprite.point3f) {\r\n                const { x, y, z } = sprite.point3f;\r\n                const key = this.cap.root.getPaletteKeyBySn(sprite.sn + "#" + version);\r\n                if (key) {\r\n                    if (this._data[x][y]) {\r\n                        oldSprites.push(sprite);\r\n                    }\r\n                    this._data[x][y] = key;\r\n                }\r\n            }\r\n        }\r\n        return oldSprites;\r\n    }\r\n    eraseTerrains(sprites) {\r\n        for (const sprite of sprites) {\r\n            if (sprite.point3f) {\r\n                const { x, y, z } = sprite.point3f;\r\n                this._data[x][y] = 0;\r\n            }\r\n        }\r\n    }\r\n    createProtocolObject() {\r\n        const tc = pixelpai_proto_1.op_gameconfig_01.TerrainCollection.create();\r\n        tc.node = this.makeNode();\r\n        this._data;\r\n        tc.data = pixelpai_proto_1.op_def.IntArrays.create();\r\n        for (let i = 0; i < this._data.length; i++) {\r\n            const row = this._data[i];\r\n            let rowData = pixelpai_proto_1.op_def.IntArray.create();\r\n            for (let j = 0; j < row.length; j++) {\r\n                rowData.value.push(row[j]);\r\n            }\r\n            if (tc.data.value) {\r\n                tc.data.value.push(rowData);\r\n            }\r\n        }\r\n        return tc;\r\n    }\r\n    serialize(container) {\r\n        if (container.terrain) {\r\n            container.terrain.push(this.createProtocolObject());\r\n        }\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const tc = data;\r\n        if (tc.data.value) {\r\n            for (let i = 0; i < tc.data.value.length; i++) {\r\n                const row = tc.data.value[i];\r\n                if (row.value) {\r\n                    this._data.push(row.value);\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.TerrainCollectionNode = TerrainCollectionNode;\r\n//# sourceMappingURL=scene.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/scene.js?')},"../game-capsule/dist/lib/configobjects/shop.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nconst package_1 = __webpack_require__(/*! ./package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nclass ShopNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._items = [];\r\n        this.name = "内购商城";\r\n    }\r\n    ignore() { }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) { }\r\n        if (obj.type === NodeType.PackageItemType) {\r\n            this._items.push(obj);\r\n        }\r\n    }\r\n}\r\nexports.default = ShopNode;\r\nclass ShopItemNode extends package_1.PackageItemNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "内购道具";\r\n        this.type = pixelpai_proto_1.op_def.NodeType.PackageItemType;\r\n    }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) {\r\n            if (obj.type === NodeType.CommodityType) {\r\n                this._commodity = obj;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.ShopItemNode = ShopItemNode;\r\nclass CommodityNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._price = 100;\r\n        this._des = "";\r\n        this._coinType = pixelpai_proto_1.op_def.CoinType.TU_DING_COIN;\r\n        this.name = "售价";\r\n    }\r\n    get properties() {\r\n        return {\r\n            price: this.price,\r\n            description: this.description,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!game.commodities) {\r\n            game.commodities = [];\r\n        }\r\n        return game.commodities;\r\n    }\r\n    createProtocolObject() {\r\n        const commodity = pixelpai_proto_1.op_gameconfig_01.Commodity.create();\r\n        commodity.node = this.makeNode();\r\n        commodity.description = this._des;\r\n        commodity.coinType = this._coinType;\r\n        commodity.price = this._price;\r\n        return commodity;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._price = as.price || 100;\r\n        this._des = as.description || "";\r\n        this._coinType = as.coinType || pixelpai_proto_1.op_def.CoinType.TU_DING_COIN;\r\n    }\r\n    set price(val) {\r\n        if (this.coinType === pixelpai_proto_1.op_def.CoinType.TU_DING_COIN) {\r\n            if (val < 10 || val > 99999) {\r\n                throw new Error("图钉有效价格在10-99999");\r\n            }\r\n        }\r\n        this._price = val;\r\n    }\r\n    get price() {\r\n        return this._price;\r\n    }\r\n    set description(val) {\r\n        this._des = val;\r\n    }\r\n    get description() {\r\n        return this._des;\r\n    }\r\n    get coinType() {\r\n        return this._coinType;\r\n    }\r\n}\r\nexports.CommodityNode = CommodityNode;\r\n//# sourceMappingURL=shop.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/shop.js?')},"../game-capsule/dist/lib/configobjects/spawnpoint.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass SpawnPointNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "出生点";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.spawnpoint)) {\r\n            game.spawnpoint = [];\r\n        }\r\n        return game.spawnpoint;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.SpawnPoint.create();\r\n        obj.node = this.makeNode();\r\n        // 这个location是个错误，但是我们将错就错。\r\n        // 注意： 千万别把这个location当node加入到 capsule的objects map中。它是成员，不是节点。\r\n        if (this._loc)\r\n            obj.loc = this._loc;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this.location.node = obj.loc.node;\r\n        this.location.x = obj.loc.x;\r\n        this.location.y = obj.loc.y;\r\n        this.location.z = obj.loc.z;\r\n    }\r\n    convertToClientElement() {\r\n        const ele = pixelpai_proto_1.op_client.Element.create();\r\n        ele.id = this.id;\r\n        ele.type = "ElementNodeType";\r\n        ele.display = this.display;\r\n        ele.animations = [this.animation];\r\n        ele.animationName = this.animation.name;\r\n        if (this._loc) {\r\n            ele.x = this._loc.x;\r\n            ele.y = this._loc.y;\r\n        }\r\n        return ele;\r\n    }\r\n    importSprite(sprite) {\r\n        this.cap.removeObject(this);\r\n        this.id = sprite.id;\r\n        this.name = sprite.nickname || this.name;\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        this.cap.addObject(this);\r\n        return this;\r\n    }\r\n    syncSprite(sprite) {\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        // this.animations.syncSprite(sprite);\r\n        return this;\r\n    }\r\n    convertToSprite() {\r\n        const spriet = pixelpai_proto_1.op_client.Sprite.create();\r\n        spriet.id = this.id;\r\n        spriet.nickname = this.name;\r\n        const point3 = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n        point3.x = this.location.x;\r\n        point3.y = this.location.y;\r\n        point3.z = this.location.z;\r\n        spriet.point3f = point3;\r\n        spriet.display = this.display;\r\n        spriet.animations = [this.animation];\r\n        spriet.currentAnimationName = this.animation.name;\r\n        spriet.direction = 3;\r\n        return spriet;\r\n    }\r\n    get display() {\r\n        if (!this._display) {\r\n            this._display = pixelpai_proto_1.op_gameconfig.Display.create();\r\n            this._display.texturePath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.png";\r\n            this._display.dataPath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.json";\r\n        }\r\n        return this._display;\r\n    }\r\n    get animation() {\r\n        if (!this._animation) {\r\n            this._animation = pixelpai_proto_1.op_gameconfig.Animation.create();\r\n            this._animation.id = 10000;\r\n            this._animation.name = "idle";\r\n            this._animation.frameRate = 5;\r\n            this._animation.collisionArea = "1,1&1,1";\r\n            this._animation.loop = true;\r\n            this._animation.baseLoc = "-30,-30";\r\n            this._animation.originPoint = [0, 0];\r\n            this._animation.frameName = ["switch_0027_3_01.png"];\r\n        }\r\n        return this._animation;\r\n    }\r\n    get location() {\r\n        if (!this._loc) {\r\n            this._loc = pixelpai_proto_1.op_gameconfig_01.Location.create();\r\n            // this._loc.node = this.makeNode();\r\n            const nd = (this._loc.node = pixelpai_proto_1.op_gameconfig_01.Node.create());\r\n            nd.id = helpers_1.default.genId();\r\n            nd.name = "位置";\r\n            nd.Parent = this.id;\r\n            nd.type = NodeType.LocationType;\r\n        }\r\n        return this._loc;\r\n    }\r\n}\r\nexports.default = SpawnPointNode;\r\n//# sourceMappingURL=spawnpoint.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/spawnpoint.js?')},"../game-capsule/dist/lib/configobjects/terrain.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === "function")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n};\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst element_1 = __webpack_require__(/*! ./element */ "../game-capsule/dist/lib/configobjects/element.js");\r\nclass TerrainNode extends element_1.default {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "地形";\r\n    }\r\n    // TODO; 生成op_client协议对象\r\n    convertToClientTerrain() {\r\n        const ele = super.convertToClientElement();\r\n        const { dir } = ele, rest = __rest(ele, ["dir"]);\r\n        return rest;\r\n    }\r\n    getSnAndVersion() {\r\n        let sn = "";\r\n        let ver = "1";\r\n        if (this.sn) {\r\n            sn = this.sn;\r\n        }\r\n        else {\r\n            const reg1 = new RegExp(/.*\\/TerrainNode\\/([a-f\\d]{24})\\/(\\d+)\\/[a-f\\d]{24}\\.json/);\r\n            const ret = this.animations.display.dataPath.match(reg1);\r\n            if (ret) {\r\n                sn = ret[1];\r\n                ver = ret[2];\r\n            }\r\n        }\r\n        return [sn, ver];\r\n    }\r\n    getSnKey() {\r\n        const [sn, ver] = this.getSnAndVersion();\r\n        return `${sn}#${ver}`;\r\n    }\r\n}\r\nexports.TerrainNode = TerrainNode;\r\n//# sourceMappingURL=terrain.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/terrain.js?')},"../game-capsule/dist/lib/configobjects/timer.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass TimerNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._timeout = 0;\r\n        this._interval = 0;\r\n        this.name = "计时器";\r\n    }\r\n    get properties() {\r\n        return {\r\n            timeout: this._timeout,\r\n            interval: this._interval,\r\n        };\r\n    }\r\n    set timeout(val) {\r\n        this._timeout = val;\r\n    }\r\n    get timeout() {\r\n        return this._timeout;\r\n    }\r\n    set interval(val) {\r\n        this._interval = val;\r\n    }\r\n    get interval() {\r\n        return this._interval;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.timer)) {\r\n            game.timer = [];\r\n        }\r\n        return game.timer;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Timer.create();\r\n        obj.node = this.makeNode();\r\n        obj.timeout = this._timeout;\r\n        obj.interval = this._interval;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._timeout = obj.timeout;\r\n        this._interval = obj.interval;\r\n    }\r\n}\r\nexports.default = TimerNode;\r\n//# sourceMappingURL=timer.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/timer.js?')},"../game-capsule/dist/lib/configobjects/ui.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass UINode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "界面";\r\n    }\r\n    get properties() {\r\n        return {\r\n            text: this._text,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.ui)) {\r\n            game.ui = [];\r\n        }\r\n        return game.ui;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.UI.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n    }\r\n}\r\nexports.default = UINode;\r\nclass TextNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._text = "";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.text)) {\r\n            game.text = [];\r\n        }\r\n        return game.text;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Text.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n    }\r\n}\r\nexports.TextNode = TextNode;\r\nclass ButtonNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._text = "";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.button)) {\r\n            game.button = [];\r\n        }\r\n        return game.button;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Button.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        if (this._tips)\r\n            obj.tips = this._tips;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n        if (obj.tips)\r\n            this._tips = obj.tips;\r\n    }\r\n}\r\nexports.ButtonNode = ButtonNode;\r\n//# sourceMappingURL=ui.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/configobjects/ui.js?')},"../game-capsule/dist/lib/constants.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass Constants {\r\n}\r\nConstants.MAX_ID = Math.pow(2, 31);\r\nConstants.NODE_T = [\r\n    null,\r\n    `GameNode`,\r\n    `SceneNode`,\r\n    `ElementNode`,\r\n    `TerrainNode`,\r\n    `CharacterNode`,\r\n    `LocationNode`,\r\n    `MovableNode`,\r\n    `DisplayNode`,\r\n    `AttributeNode`,\r\n    `FunctionNode`,\r\n    `AnimationsNode`,\r\n    `EventNode`,\r\n    `MapSizeNode`,\r\n    `UINode`,\r\n    `TimerNode`,\r\n    `PackageNode`,\r\n    `PackageItemNode`,\r\n    `AvatarNode`,\r\n    `SettingsNode`,\r\n    `CampNode`,\r\n    `MutexNode`,\r\n    `AnimationDataNode`,\r\n    `ForkNode`,\r\n    `ButtonNode`,\r\n    `TextNode`,\r\n    `AccessNode`,\r\n    `SpawnPointNode`,\r\n    `CommodityNode`,\r\n    `ShopNode`,\r\n    `PaletteNode`,\r\n    `TerrainCollectionNode`,\r\n];\r\nConstants.NODE_T_CN_Map = {\r\n    GameNode: "游戏",\r\n    SceneNode: "场景",\r\n    ElementNode: "物件",\r\n    TerrainNode: "地块",\r\n    CharacterNode: "角色",\r\n    LocationNode: "位置",\r\n    MovableNode: "可移动",\r\n    DisplayNode: "显示",\r\n    AttributeNode: "属性",\r\n    FunctionNode: "方法",\r\n    AnimationsNode: "动画",\r\n    EventNode: "事件",\r\n    MapSizeNode: "场景尺寸",\r\n    UINode: "交互显示",\r\n    TimerNode: "计时器",\r\n    PackageNode: "背包",\r\n    PackageItemNode: "背包道具",\r\n    AvatarNode: "装扮",\r\n    SettingsNode: "游戏设置",\r\n    CampNode: "阵营",\r\n    MutexNode: "互斥",\r\n    AnimationDataNode: "动画数据",\r\n    ForkNode: "备份节点",\r\n    ButtonNode: "按钮",\r\n    TextNode: "文字",\r\n    AccessNode: "传送点",\r\n    SpawnPointNode: "出生点",\r\n    ShopNode: "内购商城",\r\n    CommodityNode: "商品",\r\n};\r\nConstants.NODETYPEMAP = {\r\n    [NodeType.GameNodeType]: "GameNode",\r\n    [NodeType.SceneNodeType]: "SceneNode",\r\n    [NodeType.ElementNodeType]: `ElementNode`,\r\n    [NodeType.TerrainNodeType]: `TerrainNode`,\r\n    [NodeType.CharacterNodeType]: `CharacterNode`,\r\n    [NodeType.LocationType]: `LocationNode`,\r\n    [NodeType.MovableType]: `MovableNode`,\r\n    [NodeType.DisplayType]: `DisplayNode`,\r\n    [NodeType.AttributeType]: `AttributeNode`,\r\n    [NodeType.FunctionType]: `FunctionNode`,\r\n    [NodeType.AnimationsType]: `AnimationsNode`,\r\n    [NodeType.EventType]: `EventNode`,\r\n    [NodeType.MapSizeType]: `MapSizeNode`,\r\n    [NodeType.UIType]: `UINode`,\r\n    [NodeType.TimerType]: `TimerNode`,\r\n    [NodeType.PackageType]: `PackageNode`,\r\n    [NodeType.PackageItemType]: `PackageItemNode`,\r\n    [NodeType.AvatarType]: `AvatarNode`,\r\n    [NodeType.SettingsType]: `SettingsNode`,\r\n    [NodeType.CampType]: `CampNode`,\r\n    [NodeType.MutexType]: `MutexNode`,\r\n    [NodeType.AnimationDataType]: `AnimationDataNode`,\r\n    [NodeType.ForkType]: `ForkNode`,\r\n    [NodeType.ButtonType]: `ButtonNode`,\r\n    [NodeType.TextType]: `TextNode`,\r\n    [NodeType.AccessType]: `AccessNode`,\r\n    [NodeType.SpawnPointType]: `SpawnPointNode`,\r\n    [NodeType.CommodityType]: `CommodityNode`,\r\n    [NodeType.ShopType]: "ShopNode",\r\n    [NodeType.PaletteType]: "PaletteNode",\r\n    [NodeType.TerrainCollectionType]: "TerrainCollectionNode",\r\n};\r\nexports.default = Constants;\r\n//# sourceMappingURL=constants.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/constants.js?')},"../game-capsule/dist/lib/helpers.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst CryptoJS = __webpack_require__(/*! crypto-js */ "../game-capsule/node_modules/crypto-js/index.js");\r\nconst Chance = __webpack_require__(/*! chance */ "../game-capsule/node_modules/chance/chance.js");\r\nconst constants_1 = __webpack_require__(/*! ./constants */ "../game-capsule/dist/lib/constants.js");\r\nclass Helpers {\r\n    static genId() {\r\n        return new Chance().natural({\r\n            min: 10000,\r\n            max: constants_1.default.MAX_ID\r\n        });\r\n    }\r\n    static getClassName(instanceObj) {\r\n        return instanceObj.constructor.name;\r\n    }\r\n    // return hex encode of string hashed by sha1.\r\n    static sha1(s) {\r\n        return CryptoJS.enc.Hex.stringify(CryptoJS.SHA1(s));\r\n    }\r\n    static pointToString(p) {\r\n        return `${p.x},${p.y}`;\r\n    }\r\n    static flipArray(source) {\r\n        const array = [...source];\r\n        const result = [];\r\n        if (array.length > 0) {\r\n            const len = array[0].length;\r\n            for (let i = 0; i < len; i++) {\r\n                result[i] = [];\r\n                for (let j = 0; j < array.length; j++) {\r\n                    result[i].push(array[j][i]);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    static arrayToString(array, fristJoin, lastJoin) {\r\n        const tmp = [];\r\n        for (const ary of array) {\r\n            tmp.push(ary.join(fristJoin));\r\n        }\r\n        return tmp.join(lastJoin);\r\n    }\r\n    static stringToArray(string, fristJoin, lastJoin) {\r\n        const tmp = string.split(lastJoin);\r\n        const result = [];\r\n        for (const ary of tmp) {\r\n            const tmpAry = ary.split(fristJoin);\r\n            result.push(tmpAry.map(value => parseInt(value)));\r\n        }\r\n        return result;\r\n    }\r\n}\r\nHelpers.ID_VOL = 900000;\r\nexports.default = Helpers;\r\n//# sourceMappingURL=helpers.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/helpers.js?')},"../game-capsule/dist/lib/lite.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst capsule_1 = __webpack_require__(/*! ./capsule */ "../game-capsule/dist/lib/capsule.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar Game = pixelpai_proto_1.op_gameconfig_01.Game;\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nconst WHITE_LIST = [\r\n    NodeType.SceneNodeType,\r\n    NodeType.ElementNodeType,\r\n    NodeType.TerrainNodeType,\r\n    NodeType.PackageItemType,\r\n    NodeType.ForkType,\r\n    NodeType.CharacterNodeType,\r\n    NodeType.AvatarType,\r\n    NodeType.AnimationsType,\r\n    NodeType.AnimationDataType,\r\n    NodeType.DisplayType,\r\n    NodeType.PaletteType,\r\n    NodeType.TerrainCollectionType,\r\n];\r\n// Lite is another entry of game-capsule,\r\n// its a readonly minimal Client-use controller.\r\nclass Lite extends capsule_1.default {\r\n    constructor() {\r\n        super();\r\n    }\r\n    deserialize(buffer) {\r\n        const message = Game.decode(buffer);\r\n        const delayDeserialize = [];\r\n        // 1. deserialize game\r\n        this._root.deserialize(message);\r\n        // 2-1. deserialize other objects.\r\n        let tmp = [];\r\n        const arr = tmp.concat(message.entity, message.animations, message.animationdatas, message.avatar, message.display, message.palette, message.terrain);\r\n        for (let proto of arr) {\r\n            const nodeType = proto.node.type;\r\n            if (nodeType && WHITE_LIST.indexOf(nodeType) !== -1)\r\n                if (nodeType == NodeType.ForkType) {\r\n                    // Fork 节点放到最后反序列化，确保他的parent先被加到树中。\r\n                    delayDeserialize.push(proto);\r\n                }\r\n                else {\r\n                    this.doDeserialize(proto);\r\n                }\r\n        }\r\n        // 2-2. deserialize all Fork objects\r\n        for (const proto of delayDeserialize) {\r\n            this.doDeserialize(proto);\r\n        }\r\n        // 2-3. Link all ConfigObjects\r\n        this._objects.forEach((object) => {\r\n            object.link();\r\n        });\r\n    }\r\n    serialize() {\r\n        throw new Error("don\'t serialize");\r\n    }\r\n}\r\nexports.default = Lite;\r\n//# sourceMappingURL=lite.js.map\n\n//# sourceURL=webpack://TooqingCore/F:/PixelPai/game-capsule/dist/lib/lite.js?')},"./lib/dragonBones/dragonBones.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var DragonBones = /** @class */ (function () {\r\n        function DragonBones(eventManager) {\r\n            this._clock = new dragonBones.WorldClock();\r\n            this._events = [];\r\n            this._objects = [];\r\n            this._eventManager = null;\r\n            this._eventManager = eventManager;\r\n            console.info("DragonBones: " + DragonBones.VERSION + "\\nWebsite: http://dragonbones.com/\\nSource and Demo: https://github.com/DragonBones/");\r\n        }\r\n        DragonBones.prototype.advanceTime = function (passedTime) {\r\n            if (this._objects.length > 0) {\r\n                for (var _i = 0, _a = this._objects; _i < _a.length; _i++) {\r\n                    var object = _a[_i];\r\n                    object.returnToPool();\r\n                }\r\n                this._objects.length = 0;\r\n            }\r\n            this._clock.advanceTime(passedTime);\r\n            if (this._events.length > 0) {\r\n                for (var i = 0; i < this._events.length; ++i) {\r\n                    var eventObject = this._events[i];\r\n                    var armature = eventObject.armature;\r\n                    if (armature._armatureData !== null) { // May be armature disposed before advanceTime.\r\n                        armature.eventDispatcher.dispatchDBEvent(eventObject.type, eventObject);\r\n                        if (eventObject.type === dragonBones.EventObject.SOUND_EVENT) {\r\n                            this._eventManager.dispatchDBEvent(eventObject.type, eventObject);\r\n                        }\r\n                    }\r\n                    this.bufferObject(eventObject);\r\n                }\r\n                this._events.length = 0;\r\n            }\r\n        };\r\n        DragonBones.prototype.bufferEvent = function (value) {\r\n            if (this._events.indexOf(value) < 0) {\r\n                this._events.push(value);\r\n            }\r\n        };\r\n        DragonBones.prototype.bufferObject = function (object) {\r\n            if (this._objects.indexOf(object) < 0) {\r\n                this._objects.push(object);\r\n            }\r\n        };\r\n        Object.defineProperty(DragonBones.prototype, "clock", {\r\n            get: function () {\r\n                return this._clock;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(DragonBones.prototype, "eventManager", {\r\n            get: function () {\r\n                return this._eventManager;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        DragonBones.VERSION = "5.7.000";\r\n        DragonBones.yDown = true;\r\n        DragonBones.debug = false;\r\n        DragonBones.debugDraw = false;\r\n        return DragonBones;\r\n    }());\r\n    dragonBones.DragonBones = DragonBones;\r\n})(dragonBones || (dragonBones = {}));\r\n//\r\nif (!console.warn) {\r\n    console.warn = function () { };\r\n}\r\nif (!console.assert) {\r\n    console.assert = function () { };\r\n}\r\n//\r\nif (!Date.now) {\r\n    Date.now = function now() {\r\n        return new Date().getTime();\r\n    };\r\n}\r\n// Weixin can not support typescript extends.\r\nvar __extends = function (t, e) {\r\n    function r() {\r\n        this.constructor = t;\r\n    }\r\n    for (var i in e) {\r\n        if (e.hasOwnProperty(i)) {\r\n            t[i] = e[i];\r\n        }\r\n    }\r\n    r.prototype = e.prototype, t.prototype = new r();\r\n};\r\n//\r\nif (typeof global === "undefined" && typeof window !== "undefined") {\r\n    var global = window;\r\n}\r\nif (true) {\r\n    module.exports = dragonBones;\r\n}\r\nelse {}\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The BaseObject is the base class for all objects in the DragonBones framework.\r\n     * All BaseObject instances are cached to the object pool to reduce the performance consumption of frequent requests for memory or memory recovery.\r\n     * @version DragonBones 4.5\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 基础对象，通常 DragonBones 的对象都继承自该类。\r\n     * 所有基础对象的实例都会缓存到对象池，以减少频繁申请内存或内存回收的性能消耗。\r\n     * @version DragonBones 4.5\r\n     * @language zh_CN\r\n     */\r\n    var BaseObject = /** @class */ (function () {\r\n        function BaseObject() {\r\n            /**\r\n             * - A unique identification number assigned to the object.\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 分配给此实例的唯一标识号。\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            this.hashCode = BaseObject._hashCode++;\r\n            this._isInPool = false;\r\n        }\r\n        BaseObject._returnObject = function (object) {\r\n            var classType = String(object.constructor);\r\n            var maxCount = classType in BaseObject._maxCountMap ? BaseObject._maxCountMap[classType] : BaseObject._defaultMaxCount;\r\n            var pool = BaseObject._poolsMap[classType] = BaseObject._poolsMap[classType] || [];\r\n            if (pool.length < maxCount) {\r\n                if (!object._isInPool) {\r\n                    object._isInPool = true;\r\n                    pool.push(object);\r\n                }\r\n                else {\r\n                    console.warn("The object is already in the pool.");\r\n                }\r\n            }\r\n            else {\r\n            }\r\n        };\r\n        BaseObject.toString = function () {\r\n            throw new Error();\r\n        };\r\n        /**\r\n         * - Set the maximum cache count of the specify object pool.\r\n         * @param objectConstructor - The specify class. (Set all object pools max cache count if not set)\r\n         * @param maxCount - Max count.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 设置特定对象池的最大缓存数量。\r\n         * @param objectConstructor - 特定的类。 (不设置则设置所有对象池的最大缓存数量)\r\n         * @param maxCount - 最大缓存数量。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseObject.setMaxCount = function (objectConstructor, maxCount) {\r\n            if (maxCount < 0 || maxCount !== maxCount) { // isNaN\r\n                maxCount = 0;\r\n            }\r\n            if (objectConstructor !== null) {\r\n                var classType = String(objectConstructor);\r\n                var pool = classType in BaseObject._poolsMap ? BaseObject._poolsMap[classType] : null;\r\n                if (pool !== null && pool.length > maxCount) {\r\n                    pool.length = maxCount;\r\n                }\r\n                BaseObject._maxCountMap[classType] = maxCount;\r\n            }\r\n            else {\r\n                BaseObject._defaultMaxCount = maxCount;\r\n                for (var classType in BaseObject._poolsMap) {\r\n                    var pool = BaseObject._poolsMap[classType];\r\n                    if (pool.length > maxCount) {\r\n                        pool.length = maxCount;\r\n                    }\r\n                    if (classType in BaseObject._maxCountMap) {\r\n                        BaseObject._maxCountMap[classType] = maxCount;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Clear the cached instances of a specify object pool.\r\n         * @param objectConstructor - Specify class. (Clear all cached instances if not set)\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 清除特定对象池的缓存实例。\r\n         * @param objectConstructor - 特定的类。 (不设置则清除所有缓存的实例)\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseObject.clearPool = function (objectConstructor) {\r\n            if (objectConstructor === void 0) { objectConstructor = null; }\r\n            if (objectConstructor !== null) {\r\n                var classType = String(objectConstructor);\r\n                var pool = classType in BaseObject._poolsMap ? BaseObject._poolsMap[classType] : null;\r\n                if (pool !== null && pool.length > 0) {\r\n                    pool.length = 0;\r\n                }\r\n            }\r\n            else {\r\n                for (var k in BaseObject._poolsMap) {\r\n                    var pool = BaseObject._poolsMap[k];\r\n                    pool.length = 0;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Get an instance of the specify class from object pool.\r\n         * @param objectConstructor - The specify class.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 从对象池中获取特定类的实例。\r\n         * @param objectConstructor - 特定的类。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseObject.borrowObject = function (objectConstructor) {\r\n            var classType = String(objectConstructor);\r\n            var pool = classType in BaseObject._poolsMap ? BaseObject._poolsMap[classType] : null;\r\n            if (pool !== null && pool.length > 0) {\r\n                var object_1 = pool.pop();\r\n                object_1._isInPool = false;\r\n                return object_1;\r\n            }\r\n            var object = new objectConstructor();\r\n            object._onClear();\r\n            return object;\r\n        };\r\n        /**\r\n         * - Clear the object and return it back to object pool。\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 清除该实例的所有数据并将其返还对象池。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseObject.prototype.returnToPool = function () {\r\n            this._onClear();\r\n            BaseObject._returnObject(this);\r\n        };\r\n        BaseObject._hashCode = 0;\r\n        BaseObject._defaultMaxCount = 3000;\r\n        BaseObject._maxCountMap = {};\r\n        BaseObject._poolsMap = {};\r\n        return BaseObject;\r\n    }());\r\n    dragonBones.BaseObject = BaseObject;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - 2D Transform matrix.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 2D 转换矩阵。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Matrix = /** @class */ (function () {\r\n        /**\r\n         * @private\r\n         */\r\n        function Matrix(a, b, c, d, tx, ty) {\r\n            if (a === void 0) { a = 1.0; }\r\n            if (b === void 0) { b = 0.0; }\r\n            if (c === void 0) { c = 0.0; }\r\n            if (d === void 0) { d = 1.0; }\r\n            if (tx === void 0) { tx = 0.0; }\r\n            if (ty === void 0) { ty = 0.0; }\r\n            this.a = a;\r\n            this.b = b;\r\n            this.c = c;\r\n            this.d = d;\r\n            this.tx = tx;\r\n            this.ty = ty;\r\n        }\r\n        Matrix.prototype.toString = function () {\r\n            return "[object dragonBones.Matrix] a:" + this.a + " b:" + this.b + " c:" + this.c + " d:" + this.d + " tx:" + this.tx + " ty:" + this.ty;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Matrix.prototype.copyFrom = function (value) {\r\n            this.a = value.a;\r\n            this.b = value.b;\r\n            this.c = value.c;\r\n            this.d = value.d;\r\n            this.tx = value.tx;\r\n            this.ty = value.ty;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Matrix.prototype.copyFromArray = function (value, offset) {\r\n            if (offset === void 0) { offset = 0; }\r\n            this.a = value[offset];\r\n            this.b = value[offset + 1];\r\n            this.c = value[offset + 2];\r\n            this.d = value[offset + 3];\r\n            this.tx = value[offset + 4];\r\n            this.ty = value[offset + 5];\r\n            return this;\r\n        };\r\n        /**\r\n         * - Convert to unit matrix.\r\n         * The resulting matrix has the following properties: a=1, b=0, c=0, d=1, tx=0, ty=0.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 转换为单位矩阵。\r\n         * 该矩阵具有以下属性：a=1、b=0、c=0、d=1、tx=0、ty=0。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Matrix.prototype.identity = function () {\r\n            this.a = this.d = 1.0;\r\n            this.b = this.c = 0.0;\r\n            this.tx = this.ty = 0.0;\r\n            return this;\r\n        };\r\n        /**\r\n         * - Multiplies the current matrix with another matrix.\r\n         * @param value - The matrix that needs to be multiplied.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将当前矩阵与另一个矩阵相乘。\r\n         * @param value - 需要相乘的矩阵。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Matrix.prototype.concat = function (value) {\r\n            var aA = this.a * value.a;\r\n            var bA = 0.0;\r\n            var cA = 0.0;\r\n            var dA = this.d * value.d;\r\n            var txA = this.tx * value.a + value.tx;\r\n            var tyA = this.ty * value.d + value.ty;\r\n            if (this.b !== 0.0 || this.c !== 0.0) {\r\n                aA += this.b * value.c;\r\n                bA += this.b * value.d;\r\n                cA += this.c * value.a;\r\n                dA += this.c * value.b;\r\n            }\r\n            if (value.b !== 0.0 || value.c !== 0.0) {\r\n                bA += this.a * value.b;\r\n                cA += this.d * value.c;\r\n                txA += this.ty * value.c;\r\n                tyA += this.tx * value.b;\r\n            }\r\n            this.a = aA;\r\n            this.b = bA;\r\n            this.c = cA;\r\n            this.d = dA;\r\n            this.tx = txA;\r\n            this.ty = tyA;\r\n            return this;\r\n        };\r\n        /**\r\n         * - Convert to inverse matrix.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 转换为逆矩阵。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Matrix.prototype.invert = function () {\r\n            var aA = this.a;\r\n            var bA = this.b;\r\n            var cA = this.c;\r\n            var dA = this.d;\r\n            var txA = this.tx;\r\n            var tyA = this.ty;\r\n            if (bA === 0.0 && cA === 0.0) {\r\n                this.b = this.c = 0.0;\r\n                if (aA === 0.0 || dA === 0.0) {\r\n                    this.a = this.b = this.tx = this.ty = 0.0;\r\n                }\r\n                else {\r\n                    aA = this.a = 1.0 / aA;\r\n                    dA = this.d = 1.0 / dA;\r\n                    this.tx = -aA * txA;\r\n                    this.ty = -dA * tyA;\r\n                }\r\n                return this;\r\n            }\r\n            var determinant = aA * dA - bA * cA;\r\n            if (determinant === 0.0) {\r\n                this.a = this.d = 1.0;\r\n                this.b = this.c = 0.0;\r\n                this.tx = this.ty = 0.0;\r\n                return this;\r\n            }\r\n            determinant = 1.0 / determinant;\r\n            var k = this.a = dA * determinant;\r\n            bA = this.b = -bA * determinant;\r\n            cA = this.c = -cA * determinant;\r\n            dA = this.d = aA * determinant;\r\n            this.tx = -(k * txA + cA * tyA);\r\n            this.ty = -(bA * txA + dA * tyA);\r\n            return this;\r\n        };\r\n        /**\r\n         * - Apply a matrix transformation to a specific point.\r\n         * @param x - X coordinate.\r\n         * @param y - Y coordinate.\r\n         * @param result - The point after the transformation is applied.\r\n         * @param delta - Whether to ignore tx, ty\'s conversion to point.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将矩阵转换应用于特定点。\r\n         * @param x - 横坐标。\r\n         * @param y - 纵坐标。\r\n         * @param result - 应用转换之后的点。\r\n         * @param delta - 是否忽略 tx，ty 对点的转换。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Matrix.prototype.transformPoint = function (x, y, result, delta) {\r\n            if (delta === void 0) { delta = false; }\r\n            result.x = this.a * x + this.c * y;\r\n            result.y = this.b * x + this.d * y;\r\n            if (!delta) {\r\n                result.x += this.tx;\r\n                result.y += this.ty;\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Matrix.prototype.transformRectangle = function (rectangle, delta) {\r\n            if (delta === void 0) { delta = false; }\r\n            var a = this.a;\r\n            var b = this.b;\r\n            var c = this.c;\r\n            var d = this.d;\r\n            var tx = delta ? 0.0 : this.tx;\r\n            var ty = delta ? 0.0 : this.ty;\r\n            var x = rectangle.x;\r\n            var y = rectangle.y;\r\n            var xMax = x + rectangle.width;\r\n            var yMax = y + rectangle.height;\r\n            var x0 = a * x + c * y + tx;\r\n            var y0 = b * x + d * y + ty;\r\n            var x1 = a * xMax + c * y + tx;\r\n            var y1 = b * xMax + d * y + ty;\r\n            var x2 = a * xMax + c * yMax + tx;\r\n            var y2 = b * xMax + d * yMax + ty;\r\n            var x3 = a * x + c * yMax + tx;\r\n            var y3 = b * x + d * yMax + ty;\r\n            var tmp = 0.0;\r\n            if (x0 > x1) {\r\n                tmp = x0;\r\n                x0 = x1;\r\n                x1 = tmp;\r\n            }\r\n            if (x2 > x3) {\r\n                tmp = x2;\r\n                x2 = x3;\r\n                x3 = tmp;\r\n            }\r\n            rectangle.x = Math.floor(x0 < x2 ? x0 : x2);\r\n            rectangle.width = Math.ceil((x1 > x3 ? x1 : x3) - rectangle.x);\r\n            if (y0 > y1) {\r\n                tmp = y0;\r\n                y0 = y1;\r\n                y1 = tmp;\r\n            }\r\n            if (y2 > y3) {\r\n                tmp = y2;\r\n                y2 = y3;\r\n                y3 = tmp;\r\n            }\r\n            rectangle.y = Math.floor(y0 < y2 ? y0 : y2);\r\n            rectangle.height = Math.ceil((y1 > y3 ? y1 : y3) - rectangle.y);\r\n        };\r\n        return Matrix;\r\n    }());\r\n    dragonBones.Matrix = Matrix;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - 2D Transform.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 2D 变换。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Transform = /** @class */ (function () {\r\n        /**\r\n         * @private\r\n         */\r\n        function Transform(x, y, skew, rotation, scaleX, scaleY) {\r\n            if (x === void 0) { x = 0.0; }\r\n            if (y === void 0) { y = 0.0; }\r\n            if (skew === void 0) { skew = 0.0; }\r\n            if (rotation === void 0) { rotation = 0.0; }\r\n            if (scaleX === void 0) { scaleX = 1.0; }\r\n            if (scaleY === void 0) { scaleY = 1.0; }\r\n            this.x = x;\r\n            this.y = y;\r\n            this.skew = skew;\r\n            this.rotation = rotation;\r\n            this.scaleX = scaleX;\r\n            this.scaleY = scaleY;\r\n        }\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.normalizeRadian = function (value) {\r\n            value = (value + Math.PI) % (Math.PI * 2.0);\r\n            value += value > 0.0 ? -Math.PI : Math.PI;\r\n            return value;\r\n        };\r\n        Transform.prototype.toString = function () {\r\n            return "[object dragonBones.Transform] x:" + this.x + " y:" + this.y + " skewX:" + this.skew * 180.0 / Math.PI + " skewY:" + this.rotation * 180.0 / Math.PI + " scaleX:" + this.scaleX + " scaleY:" + this.scaleY;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.copyFrom = function (value) {\r\n            this.x = value.x;\r\n            this.y = value.y;\r\n            this.skew = value.skew;\r\n            this.rotation = value.rotation;\r\n            this.scaleX = value.scaleX;\r\n            this.scaleY = value.scaleY;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.identity = function () {\r\n            this.x = this.y = 0.0;\r\n            this.skew = this.rotation = 0.0;\r\n            this.scaleX = this.scaleY = 1.0;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.add = function (value) {\r\n            this.x += value.x;\r\n            this.y += value.y;\r\n            this.skew += value.skew;\r\n            this.rotation += value.rotation;\r\n            this.scaleX *= value.scaleX;\r\n            this.scaleY *= value.scaleY;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.minus = function (value) {\r\n            this.x -= value.x;\r\n            this.y -= value.y;\r\n            this.skew -= value.skew;\r\n            this.rotation -= value.rotation;\r\n            this.scaleX /= value.scaleX;\r\n            this.scaleY /= value.scaleY;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.fromMatrix = function (matrix) {\r\n            var backupScaleX = this.scaleX, backupScaleY = this.scaleY;\r\n            var PI_Q = Transform.PI_Q;\r\n            this.x = matrix.tx;\r\n            this.y = matrix.ty;\r\n            this.rotation = Math.atan(matrix.b / matrix.a);\r\n            var skewX = Math.atan(-matrix.c / matrix.d);\r\n            this.scaleX = (this.rotation > -PI_Q && this.rotation < PI_Q) ? matrix.a / Math.cos(this.rotation) : matrix.b / Math.sin(this.rotation);\r\n            this.scaleY = (skewX > -PI_Q && skewX < PI_Q) ? matrix.d / Math.cos(skewX) : -matrix.c / Math.sin(skewX);\r\n            if (backupScaleX >= 0.0 && this.scaleX < 0.0) {\r\n                this.scaleX = -this.scaleX;\r\n                this.rotation = this.rotation - Math.PI;\r\n            }\r\n            if (backupScaleY >= 0.0 && this.scaleY < 0.0) {\r\n                this.scaleY = -this.scaleY;\r\n                skewX = skewX - Math.PI;\r\n            }\r\n            this.skew = skewX - this.rotation;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.prototype.toMatrix = function (matrix) {\r\n            if (this.rotation === 0.0) {\r\n                matrix.a = 1.0;\r\n                matrix.b = 0.0;\r\n            }\r\n            else {\r\n                matrix.a = Math.cos(this.rotation);\r\n                matrix.b = Math.sin(this.rotation);\r\n            }\r\n            if (this.skew === 0.0) {\r\n                matrix.c = -matrix.b;\r\n                matrix.d = matrix.a;\r\n            }\r\n            else {\r\n                matrix.c = -Math.sin(this.skew + this.rotation);\r\n                matrix.d = Math.cos(this.skew + this.rotation);\r\n            }\r\n            if (this.scaleX !== 1.0) {\r\n                matrix.a *= this.scaleX;\r\n                matrix.b *= this.scaleX;\r\n            }\r\n            if (this.scaleY !== 1.0) {\r\n                matrix.c *= this.scaleY;\r\n                matrix.d *= this.scaleY;\r\n            }\r\n            matrix.tx = this.x;\r\n            matrix.ty = this.y;\r\n            return this;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.PI = Math.PI;\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.PI_D = Math.PI * 2.0;\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.PI_H = Math.PI / 2.0;\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.PI_Q = Math.PI / 4.0;\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.RAD_DEG = 180.0 / Math.PI;\r\n        /**\r\n         * @private\r\n         */\r\n        Transform.DEG_RAD = Math.PI / 180.0;\r\n        return Transform;\r\n    }());\r\n    dragonBones.Transform = Transform;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var ColorTransform = /** @class */ (function () {\r\n        function ColorTransform(alphaMultiplier, redMultiplier, greenMultiplier, blueMultiplier, alphaOffset, redOffset, greenOffset, blueOffset) {\r\n            if (alphaMultiplier === void 0) { alphaMultiplier = 1.0; }\r\n            if (redMultiplier === void 0) { redMultiplier = 1.0; }\r\n            if (greenMultiplier === void 0) { greenMultiplier = 1.0; }\r\n            if (blueMultiplier === void 0) { blueMultiplier = 1.0; }\r\n            if (alphaOffset === void 0) { alphaOffset = 0; }\r\n            if (redOffset === void 0) { redOffset = 0; }\r\n            if (greenOffset === void 0) { greenOffset = 0; }\r\n            if (blueOffset === void 0) { blueOffset = 0; }\r\n            this.alphaMultiplier = alphaMultiplier;\r\n            this.redMultiplier = redMultiplier;\r\n            this.greenMultiplier = greenMultiplier;\r\n            this.blueMultiplier = blueMultiplier;\r\n            this.alphaOffset = alphaOffset;\r\n            this.redOffset = redOffset;\r\n            this.greenOffset = greenOffset;\r\n            this.blueOffset = blueOffset;\r\n        }\r\n        ColorTransform.prototype.copyFrom = function (value) {\r\n            this.alphaMultiplier = value.alphaMultiplier;\r\n            this.redMultiplier = value.redMultiplier;\r\n            this.greenMultiplier = value.greenMultiplier;\r\n            this.blueMultiplier = value.blueMultiplier;\r\n            this.alphaOffset = value.alphaOffset;\r\n            this.redOffset = value.redOffset;\r\n            this.greenOffset = value.greenOffset;\r\n            this.blueOffset = value.blueOffset;\r\n        };\r\n        ColorTransform.prototype.identity = function () {\r\n            this.alphaMultiplier = this.redMultiplier = this.greenMultiplier = this.blueMultiplier = 1.0;\r\n            this.alphaOffset = this.redOffset = this.greenOffset = this.blueOffset = 0;\r\n        };\r\n        return ColorTransform;\r\n    }());\r\n    dragonBones.ColorTransform = ColorTransform;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The Point object represents a location in a two-dimensional coordinate system.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - Point 对象表示二维坐标系统中的某个位置。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Point = /** @class */ (function () {\r\n        /**\r\n         * - Creates a new point. If you pass no parameters to this method, a point is created at (0,0).\r\n         * @param x - The horizontal coordinate.\r\n         * @param y - The vertical coordinate.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 创建一个 egret.Point 对象.若不传入任何参数，将会创建一个位于（0，0）位置的点。\r\n         * @param x - 该对象的x属性值，默认为 0.0。\r\n         * @param y - 该对象的y属性值，默认为 0.0。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        function Point(x, y) {\r\n            if (x === void 0) { x = 0.0; }\r\n            if (y === void 0) { y = 0.0; }\r\n            this.x = x;\r\n            this.y = y;\r\n        }\r\n        /**\r\n         * @private\r\n         */\r\n        Point.prototype.copyFrom = function (value) {\r\n            this.x = value.x;\r\n            this.y = value.y;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Point.prototype.clear = function () {\r\n            this.x = this.y = 0.0;\r\n        };\r\n        return Point;\r\n    }());\r\n    dragonBones.Point = Point;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - A Rectangle object is an area defined by its position, as indicated by its top-left corner point (x, y) and by its\r\n     * width and its height.<br/>\r\n     * The x, y, width, and height properties of the Rectangle class are independent of each other; changing the value of\r\n     * one property has no effect on the others. However, the right and bottom properties are integrally related to those\r\n     * four properties. For example, if you change the value of the right property, the value of the width property changes;\r\n     * if you change the bottom property, the value of the height property changes.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - Rectangle 对象是按其位置（由它左上角的点 (x, y) 确定）以及宽度和高度定义的区域。<br/>\r\n     * Rectangle 类的 x、y、width 和 height 属性相互独立；更改一个属性的值不会影响其他属性。\r\n     * 但是，right 和 bottom 属性与这四个属性是整体相关的。例如，如果更改 right 属性的值，则 width\r\n     * 属性的值将发生变化；如果更改 bottom 属性，则 height 属性的值将发生变化。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Rectangle = /** @class */ (function () {\r\n        /**\r\n         * @private\r\n         */\r\n        function Rectangle(x, y, width, height) {\r\n            if (x === void 0) { x = 0.0; }\r\n            if (y === void 0) { y = 0.0; }\r\n            if (width === void 0) { width = 0.0; }\r\n            if (height === void 0) { height = 0.0; }\r\n            this.x = x;\r\n            this.y = y;\r\n            this.width = width;\r\n            this.height = height;\r\n        }\r\n        /**\r\n         * @private\r\n         */\r\n        Rectangle.prototype.copyFrom = function (value) {\r\n            this.x = value.x;\r\n            this.y = value.y;\r\n            this.width = value.width;\r\n            this.height = value.height;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Rectangle.prototype.clear = function () {\r\n            this.x = this.y = 0.0;\r\n            this.width = this.height = 0.0;\r\n        };\r\n        return Rectangle;\r\n    }());\r\n    dragonBones.Rectangle = Rectangle;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The user custom data.\r\n     * @version DragonBones 5.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 用户自定义数据。\r\n     * @version DragonBones 5.0\r\n     * @language zh_CN\r\n     */\r\n    var UserData = /** @class */ (function (_super) {\r\n        __extends(UserData, _super);\r\n        function UserData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * - The custom int numbers.\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 自定义整数。\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            _this.ints = [];\r\n            /**\r\n             * - The custom float numbers.\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 自定义浮点数。\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            _this.floats = [];\r\n            /**\r\n             * - The custom strings.\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 自定义字符串。\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            _this.strings = [];\r\n            return _this;\r\n        }\r\n        UserData.toString = function () {\r\n            return "[class dragonBones.UserData]";\r\n        };\r\n        UserData.prototype._onClear = function () {\r\n            this.ints.length = 0;\r\n            this.floats.length = 0;\r\n            this.strings.length = 0;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        UserData.prototype.addInt = function (value) {\r\n            this.ints.push(value);\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        UserData.prototype.addFloat = function (value) {\r\n            this.floats.push(value);\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        UserData.prototype.addString = function (value) {\r\n            this.strings.push(value);\r\n        };\r\n        /**\r\n         * - Get the custom int number.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取自定义整数。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        UserData.prototype.getInt = function (index) {\r\n            if (index === void 0) { index = 0; }\r\n            return index >= 0 && index < this.ints.length ? this.ints[index] : 0;\r\n        };\r\n        /**\r\n         * - Get the custom float number.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取自定义浮点数。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        UserData.prototype.getFloat = function (index) {\r\n            if (index === void 0) { index = 0; }\r\n            return index >= 0 && index < this.floats.length ? this.floats[index] : 0.0;\r\n        };\r\n        /**\r\n         * - Get the custom string.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取自定义字符串。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        UserData.prototype.getString = function (index) {\r\n            if (index === void 0) { index = 0; }\r\n            return index >= 0 && index < this.strings.length ? this.strings[index] : "";\r\n        };\r\n        return UserData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.UserData = UserData;\r\n    /**\r\n     * @private\r\n     */\r\n    var ActionData = /** @class */ (function (_super) {\r\n        __extends(ActionData, _super);\r\n        function ActionData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.data = null; //\r\n            return _this;\r\n        }\r\n        ActionData.toString = function () {\r\n            return "[class dragonBones.ActionData]";\r\n        };\r\n        ActionData.prototype._onClear = function () {\r\n            if (this.data !== null) {\r\n                this.data.returnToPool();\r\n            }\r\n            this.type = 0 /* Play */;\r\n            this.name = "";\r\n            this.bone = null;\r\n            this.slot = null;\r\n            this.data = null;\r\n        };\r\n        return ActionData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.ActionData = ActionData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The DragonBones data.\r\n     * A DragonBones data contains multiple armature data.\r\n     * @see dragonBones.ArmatureData\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 龙骨数据。\r\n     * 一个龙骨数据包含多个骨架数据。\r\n     * @see dragonBones.ArmatureData\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var DragonBonesData = /** @class */ (function (_super) {\r\n        __extends(DragonBonesData, _super);\r\n        function DragonBonesData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @internal\r\n             */\r\n            _this.frameIndices = [];\r\n            /**\r\n             * @internal\r\n             */\r\n            _this.cachedFrames = [];\r\n            /**\r\n             * - All armature data names.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所有的骨架数据名称。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            _this.armatureNames = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.armatures = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.userData = null; // Initial value.\r\n            return _this;\r\n        }\r\n        DragonBonesData.toString = function () {\r\n            return "[class dragonBones.DragonBonesData]";\r\n        };\r\n        DragonBonesData.prototype._onClear = function () {\r\n            for (var k in this.armatures) {\r\n                this.armatures[k].returnToPool();\r\n                delete this.armatures[k];\r\n            }\r\n            if (this.userData !== null) {\r\n                this.userData.returnToPool();\r\n            }\r\n            this.autoSearch = false;\r\n            this.frameRate = 0;\r\n            this.version = "";\r\n            this.name = "";\r\n            this.stage = null;\r\n            this.frameIndices.length = 0;\r\n            this.cachedFrames.length = 0;\r\n            this.armatureNames.length = 0;\r\n            //this.armatures.clear();\r\n            this.binary = null; //\r\n            this.intArray = null; //\r\n            this.floatArray = null; //\r\n            this.frameIntArray = null; //\r\n            this.frameFloatArray = null; //\r\n            this.frameArray = null; //\r\n            this.timelineArray = null; //\r\n            this.colorArray = null; //\r\n            this.userData = null;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        DragonBonesData.prototype.addArmature = function (value) {\r\n            if (value.name in this.armatures) {\r\n                console.warn("Same armature: " + value.name);\r\n                return;\r\n            }\r\n            value.parent = this;\r\n            this.armatures[value.name] = value;\r\n            this.armatureNames.push(value.name);\r\n        };\r\n        /**\r\n         * - Get a specific armature data.\r\n         * @param armatureName - The armature data name.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的骨架数据。\r\n         * @param armatureName - 骨架数据名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        DragonBonesData.prototype.getArmature = function (armatureName) {\r\n            return armatureName in this.armatures ? this.armatures[armatureName] : null;\r\n        };\r\n        return DragonBonesData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.DragonBonesData = DragonBonesData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The armature data.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 骨架数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var ArmatureData = /** @class */ (function (_super) {\r\n        __extends(ArmatureData, _super);\r\n        function ArmatureData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.aabb = new dragonBones.Rectangle();\r\n            /**\r\n             * - The names of all the animation data.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所有的动画数据名称。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            _this.animationNames = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.sortedBones = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.sortedSlots = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.defaultActions = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.actions = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.bones = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.slots = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.constraints = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.skins = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.animations = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.canvas = null; // Initial value.\r\n            /**\r\n             * @private\r\n             */\r\n            _this.userData = null; // Initial value.\r\n            return _this;\r\n        }\r\n        ArmatureData.toString = function () {\r\n            return "[class dragonBones.ArmatureData]";\r\n        };\r\n        ArmatureData.prototype._onClear = function () {\r\n            for (var _i = 0, _a = this.defaultActions; _i < _a.length; _i++) {\r\n                var action = _a[_i];\r\n                action.returnToPool();\r\n            }\r\n            for (var _b = 0, _c = this.actions; _b < _c.length; _b++) {\r\n                var action = _c[_b];\r\n                action.returnToPool();\r\n            }\r\n            for (var k in this.bones) {\r\n                this.bones[k].returnToPool();\r\n                delete this.bones[k];\r\n            }\r\n            for (var k in this.slots) {\r\n                this.slots[k].returnToPool();\r\n                delete this.slots[k];\r\n            }\r\n            for (var k in this.constraints) {\r\n                this.constraints[k].returnToPool();\r\n                delete this.constraints[k];\r\n            }\r\n            for (var k in this.skins) {\r\n                this.skins[k].returnToPool();\r\n                delete this.skins[k];\r\n            }\r\n            for (var k in this.animations) {\r\n                this.animations[k].returnToPool();\r\n                delete this.animations[k];\r\n            }\r\n            if (this.canvas !== null) {\r\n                this.canvas.returnToPool();\r\n            }\r\n            if (this.userData !== null) {\r\n                this.userData.returnToPool();\r\n            }\r\n            this.type = 0 /* Armature */;\r\n            this.frameRate = 0;\r\n            this.cacheFrameRate = 0;\r\n            this.scale = 1.0;\r\n            this.name = "";\r\n            this.aabb.clear();\r\n            this.animationNames.length = 0;\r\n            this.sortedBones.length = 0;\r\n            this.sortedSlots.length = 0;\r\n            this.defaultActions.length = 0;\r\n            this.actions.length = 0;\r\n            // this.bones.clear();\r\n            // this.slots.clear();\r\n            // this.constraints.clear();\r\n            // this.skins.clear();\r\n            // this.animations.clear();\r\n            this.defaultSkin = null;\r\n            this.defaultAnimation = null;\r\n            this.canvas = null;\r\n            this.userData = null;\r\n            this.parent = null; //\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.sortBones = function () {\r\n            var total = this.sortedBones.length;\r\n            if (total <= 0) {\r\n                return;\r\n            }\r\n            var sortHelper = this.sortedBones.concat();\r\n            var index = 0;\r\n            var count = 0;\r\n            this.sortedBones.length = 0;\r\n            while (count < total) {\r\n                var bone = sortHelper[index++];\r\n                if (index >= total) {\r\n                    index = 0;\r\n                }\r\n                if (this.sortedBones.indexOf(bone) >= 0) {\r\n                    continue;\r\n                }\r\n                var flag = false;\r\n                for (var k in this.constraints) { // Wait constraint.\r\n                    var constraint = this.constraints[k];\r\n                    if (constraint.root === bone && this.sortedBones.indexOf(constraint.target) < 0) {\r\n                        flag = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (flag) {\r\n                    continue;\r\n                }\r\n                if (bone.parent !== null && this.sortedBones.indexOf(bone.parent) < 0) { // Wait parent.\r\n                    continue;\r\n                }\r\n                this.sortedBones.push(bone);\r\n                count++;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.cacheFrames = function (frameRate) {\r\n            if (this.cacheFrameRate > 0) { // TODO clear cache.\r\n                return;\r\n            }\r\n            this.cacheFrameRate = frameRate;\r\n            for (var k in this.animations) {\r\n                this.animations[k].cacheFrames(this.cacheFrameRate);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.setCacheFrame = function (globalTransformMatrix, transform) {\r\n            var dataArray = this.parent.cachedFrames;\r\n            var arrayOffset = dataArray.length;\r\n            dataArray.length += 10;\r\n            dataArray[arrayOffset] = globalTransformMatrix.a;\r\n            dataArray[arrayOffset + 1] = globalTransformMatrix.b;\r\n            dataArray[arrayOffset + 2] = globalTransformMatrix.c;\r\n            dataArray[arrayOffset + 3] = globalTransformMatrix.d;\r\n            dataArray[arrayOffset + 4] = globalTransformMatrix.tx;\r\n            dataArray[arrayOffset + 5] = globalTransformMatrix.ty;\r\n            dataArray[arrayOffset + 6] = transform.rotation;\r\n            dataArray[arrayOffset + 7] = transform.skew;\r\n            dataArray[arrayOffset + 8] = transform.scaleX;\r\n            dataArray[arrayOffset + 9] = transform.scaleY;\r\n            return arrayOffset;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.getCacheFrame = function (globalTransformMatrix, transform, arrayOffset) {\r\n            var dataArray = this.parent.cachedFrames;\r\n            globalTransformMatrix.a = dataArray[arrayOffset];\r\n            globalTransformMatrix.b = dataArray[arrayOffset + 1];\r\n            globalTransformMatrix.c = dataArray[arrayOffset + 2];\r\n            globalTransformMatrix.d = dataArray[arrayOffset + 3];\r\n            globalTransformMatrix.tx = dataArray[arrayOffset + 4];\r\n            globalTransformMatrix.ty = dataArray[arrayOffset + 5];\r\n            transform.rotation = dataArray[arrayOffset + 6];\r\n            transform.skew = dataArray[arrayOffset + 7];\r\n            transform.scaleX = dataArray[arrayOffset + 8];\r\n            transform.scaleY = dataArray[arrayOffset + 9];\r\n            transform.x = globalTransformMatrix.tx;\r\n            transform.y = globalTransformMatrix.ty;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addBone = function (value) {\r\n            if (value.name in this.bones) {\r\n                console.warn("Same bone: " + value.name);\r\n                return;\r\n            }\r\n            this.bones[value.name] = value;\r\n            this.sortedBones.push(value);\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addSlot = function (value) {\r\n            if (value.name in this.slots) {\r\n                console.warn("Same slot: " + value.name);\r\n                return;\r\n            }\r\n            this.slots[value.name] = value;\r\n            this.sortedSlots.push(value);\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addConstraint = function (value) {\r\n            if (value.name in this.constraints) {\r\n                console.warn("Same constraint: " + value.name);\r\n                return;\r\n            }\r\n            this.constraints[value.name] = value;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addSkin = function (value) {\r\n            if (value.name in this.skins) {\r\n                console.warn("Same skin: " + value.name);\r\n                return;\r\n            }\r\n            value.parent = this;\r\n            this.skins[value.name] = value;\r\n            if (this.defaultSkin === null) {\r\n                this.defaultSkin = value;\r\n            }\r\n            if (value.name === "default") {\r\n                this.defaultSkin = value;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addAnimation = function (value) {\r\n            if (value.name in this.animations) {\r\n                console.warn("Same animation: " + value.name);\r\n                return;\r\n            }\r\n            value.parent = this;\r\n            this.animations[value.name] = value;\r\n            this.animationNames.push(value.name);\r\n            if (this.defaultAnimation === null) {\r\n                this.defaultAnimation = value;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        ArmatureData.prototype.addAction = function (value, isDefault) {\r\n            if (isDefault) {\r\n                this.defaultActions.push(value);\r\n            }\r\n            else {\r\n                this.actions.push(value);\r\n            }\r\n        };\r\n        /**\r\n         * - Get a specific done data.\r\n         * @param boneName - The bone name.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的骨骼数据。\r\n         * @param boneName - 骨骼名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        ArmatureData.prototype.getBone = function (boneName) {\r\n            return boneName in this.bones ? this.bones[boneName] : null;\r\n        };\r\n        /**\r\n         * - Get a specific slot data.\r\n         * @param slotName - The slot name.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的插槽数据。\r\n         * @param slotName - 插槽名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        ArmatureData.prototype.getSlot = function (slotName) {\r\n            return slotName in this.slots ? this.slots[slotName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        ArmatureData.prototype.getConstraint = function (constraintName) {\r\n            return constraintName in this.constraints ? this.constraints[constraintName] : null;\r\n        };\r\n        /**\r\n         * - Get a specific skin data.\r\n         * @param skinName - The skin name.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定皮肤数据。\r\n         * @param skinName - 皮肤名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        ArmatureData.prototype.getSkin = function (skinName) {\r\n            return skinName in this.skins ? this.skins[skinName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        ArmatureData.prototype.getMesh = function (skinName, slotName, meshName) {\r\n            var skin = this.getSkin(skinName);\r\n            if (skin === null) {\r\n                return null;\r\n            }\r\n            return skin.getDisplay(slotName, meshName);\r\n        };\r\n        /**\r\n         * - Get a specific animation data.\r\n         * @param animationName - The animation animationName.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的动画数据。\r\n         * @param animationName - 动画名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        ArmatureData.prototype.getAnimation = function (animationName) {\r\n            return animationName in this.animations ? this.animations[animationName] : null;\r\n        };\r\n        return ArmatureData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.ArmatureData = ArmatureData;\r\n    /**\r\n     * - The bone data.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 骨骼数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var BoneData = /** @class */ (function (_super) {\r\n        __extends(BoneData, _super);\r\n        function BoneData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.transform = new dragonBones.Transform();\r\n            /**\r\n             * @private\r\n             */\r\n            _this.userData = null; // Initial value.\r\n            return _this;\r\n        }\r\n        BoneData.toString = function () {\r\n            return "[class dragonBones.BoneData]";\r\n        };\r\n        BoneData.prototype._onClear = function () {\r\n            if (this.userData !== null) {\r\n                this.userData.returnToPool();\r\n            }\r\n            this.inheritTranslation = false;\r\n            this.inheritRotation = false;\r\n            this.inheritScale = false;\r\n            this.inheritReflection = false;\r\n            this.type = 0 /* Bone */;\r\n            this.length = 0.0;\r\n            this.alpha = 1.0;\r\n            this.name = "";\r\n            this.transform.identity();\r\n            this.userData = null;\r\n            this.parent = null;\r\n        };\r\n        return BoneData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.BoneData = BoneData;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SurfaceData = /** @class */ (function (_super) {\r\n        __extends(SurfaceData, _super);\r\n        function SurfaceData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.geometry = new dragonBones.GeometryData();\r\n            return _this;\r\n        }\r\n        SurfaceData.toString = function () {\r\n            return "[class dragonBones.SurfaceData]";\r\n        };\r\n        SurfaceData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 1 /* Surface */;\r\n            this.segmentX = 0;\r\n            this.segmentY = 0;\r\n            this.geometry.clear();\r\n        };\r\n        return SurfaceData;\r\n    }(BoneData));\r\n    dragonBones.SurfaceData = SurfaceData;\r\n    /**\r\n     * - The slot data.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 插槽数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var SlotData = /** @class */ (function (_super) {\r\n        __extends(SlotData, _super);\r\n        function SlotData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.color = null; // Initial value.\r\n            /**\r\n             * @private\r\n             */\r\n            _this.userData = null; // Initial value.\r\n            return _this;\r\n        }\r\n        /**\r\n         * @internal\r\n         */\r\n        SlotData.createColor = function () {\r\n            return new dragonBones.ColorTransform();\r\n        };\r\n        SlotData.toString = function () {\r\n            return "[class dragonBones.SlotData]";\r\n        };\r\n        SlotData.prototype._onClear = function () {\r\n            if (this.userData !== null) {\r\n                this.userData.returnToPool();\r\n            }\r\n            this.blendMode = 0 /* Normal */;\r\n            this.displayIndex = 0;\r\n            this.zOrder = 0;\r\n            this.zIndex = 0;\r\n            this.alpha = 1.0;\r\n            this.name = "";\r\n            this.color = null; //\r\n            this.userData = null;\r\n            this.parent = null; //\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        SlotData.DEFAULT_COLOR = new dragonBones.ColorTransform();\r\n        return SlotData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.SlotData = SlotData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var ConstraintData = /** @class */ (function (_super) {\r\n        __extends(ConstraintData, _super);\r\n        function ConstraintData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ConstraintData.prototype._onClear = function () {\r\n            this.order = 0;\r\n            this.name = "";\r\n            this.type = 0 /* IK */;\r\n            this.target = null; //\r\n            this.root = null; //\r\n            this.bone = null;\r\n        };\r\n        return ConstraintData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.ConstraintData = ConstraintData;\r\n    /**\r\n     * @internal\r\n     */\r\n    var IKConstraintData = /** @class */ (function (_super) {\r\n        __extends(IKConstraintData, _super);\r\n        function IKConstraintData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        IKConstraintData.toString = function () {\r\n            return "[class dragonBones.IKConstraintData]";\r\n        };\r\n        IKConstraintData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.scaleEnabled = false;\r\n            this.bendPositive = false;\r\n            this.weight = 1.0;\r\n        };\r\n        return IKConstraintData;\r\n    }(ConstraintData));\r\n    dragonBones.IKConstraintData = IKConstraintData;\r\n    /**\r\n     * @internal\r\n     */\r\n    var PathConstraintData = /** @class */ (function (_super) {\r\n        __extends(PathConstraintData, _super);\r\n        function PathConstraintData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.bones = [];\r\n            return _this;\r\n        }\r\n        PathConstraintData.toString = function () {\r\n            return "[class dragonBones.PathConstraintData]";\r\n        };\r\n        PathConstraintData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.pathSlot = null;\r\n            this.pathDisplayData = null;\r\n            this.bones.length = 0;\r\n            this.positionMode = 0 /* Fixed */;\r\n            this.spacingMode = 1 /* Fixed */;\r\n            this.rotateMode = 1 /* Chain */;\r\n            this.position = 0.0;\r\n            this.spacing = 0.0;\r\n            this.rotateOffset = 0.0;\r\n            this.rotateMix = 0.0;\r\n            this.translateMix = 0.0;\r\n        };\r\n        PathConstraintData.prototype.AddBone = function (value) {\r\n            this.bones.push(value);\r\n        };\r\n        return PathConstraintData;\r\n    }(ConstraintData));\r\n    dragonBones.PathConstraintData = PathConstraintData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var CanvasData = /** @class */ (function (_super) {\r\n        __extends(CanvasData, _super);\r\n        function CanvasData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        CanvasData.toString = function () {\r\n            return "[class dragonBones.CanvasData]";\r\n        };\r\n        CanvasData.prototype._onClear = function () {\r\n            this.hasBackground = false;\r\n            this.color = 0x000000;\r\n            this.x = 0;\r\n            this.y = 0;\r\n            this.width = 0;\r\n            this.height = 0;\r\n        };\r\n        return CanvasData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.CanvasData = CanvasData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The skin data, typically a armature data instance contains at least one skinData.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 皮肤数据，通常一个骨架数据至少包含一个皮肤数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var SkinData = /** @class */ (function (_super) {\r\n        __extends(SkinData, _super);\r\n        function SkinData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.displays = {};\r\n            return _this;\r\n        }\r\n        SkinData.toString = function () {\r\n            return "[class dragonBones.SkinData]";\r\n        };\r\n        SkinData.prototype._onClear = function () {\r\n            for (var k in this.displays) {\r\n                var slotDisplays = this.displays[k];\r\n                for (var _i = 0, slotDisplays_1 = slotDisplays; _i < slotDisplays_1.length; _i++) {\r\n                    var display = slotDisplays_1[_i];\r\n                    if (display !== null) {\r\n                        display.returnToPool();\r\n                    }\r\n                }\r\n                delete this.displays[k];\r\n            }\r\n            this.name = "";\r\n            // this.displays.clear();\r\n            this.parent = null; //\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        SkinData.prototype.addDisplay = function (slotName, value) {\r\n            if (!(slotName in this.displays)) {\r\n                this.displays[slotName] = [];\r\n            }\r\n            if (value !== null) {\r\n                value.parent = this;\r\n            }\r\n            var slotDisplays = this.displays[slotName]; // TODO clear prev\r\n            slotDisplays.push(value);\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        SkinData.prototype.getDisplay = function (slotName, displayName) {\r\n            var slotDisplays = this.getDisplays(slotName);\r\n            if (slotDisplays !== null) {\r\n                for (var _i = 0, slotDisplays_2 = slotDisplays; _i < slotDisplays_2.length; _i++) {\r\n                    var display = slotDisplays_2[_i];\r\n                    if (display !== null && display.name === displayName) {\r\n                        return display;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        SkinData.prototype.getDisplays = function (slotName) {\r\n            if (!(slotName in this.displays)) {\r\n                return null;\r\n            }\r\n            return this.displays[slotName];\r\n        };\r\n        return SkinData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.SkinData = SkinData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var GeometryData = /** @class */ (function () {\r\n        function GeometryData() {\r\n            this.weight = null; // Initial value.\r\n        }\r\n        GeometryData.prototype.clear = function () {\r\n            if (!this.isShared && this.weight !== null) {\r\n                this.weight.returnToPool();\r\n            }\r\n            this.isShared = false;\r\n            this.inheritDeform = false;\r\n            this.offset = 0;\r\n            this.data = null;\r\n            this.weight = null;\r\n        };\r\n        GeometryData.prototype.shareFrom = function (value) {\r\n            this.isShared = true;\r\n            this.offset = value.offset;\r\n            this.weight = value.weight;\r\n        };\r\n        Object.defineProperty(GeometryData.prototype, "vertexCount", {\r\n            get: function () {\r\n                var intArray = this.data.intArray;\r\n                return intArray[this.offset + 0 /* GeometryVertexCount */];\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(GeometryData.prototype, "triangleCount", {\r\n            get: function () {\r\n                var intArray = this.data.intArray;\r\n                return intArray[this.offset + 1 /* GeometryTriangleCount */];\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return GeometryData;\r\n    }());\r\n    dragonBones.GeometryData = GeometryData;\r\n    /**\r\n     * @private\r\n     */\r\n    var DisplayData = /** @class */ (function (_super) {\r\n        __extends(DisplayData, _super);\r\n        function DisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.transform = new dragonBones.Transform();\r\n            return _this;\r\n        }\r\n        DisplayData.prototype._onClear = function () {\r\n            this.name = "";\r\n            this.path = "";\r\n            this.transform.identity();\r\n            this.parent = null; //\r\n        };\r\n        return DisplayData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.DisplayData = DisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var ImageDisplayData = /** @class */ (function (_super) {\r\n        __extends(ImageDisplayData, _super);\r\n        function ImageDisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.pivot = new dragonBones.Point();\r\n            return _this;\r\n        }\r\n        ImageDisplayData.toString = function () {\r\n            return "[class dragonBones.ImageDisplayData]";\r\n        };\r\n        ImageDisplayData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 0 /* Image */;\r\n            this.pivot.clear();\r\n            this.texture = null;\r\n        };\r\n        return ImageDisplayData;\r\n    }(DisplayData));\r\n    dragonBones.ImageDisplayData = ImageDisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var ArmatureDisplayData = /** @class */ (function (_super) {\r\n        __extends(ArmatureDisplayData, _super);\r\n        function ArmatureDisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.actions = [];\r\n            return _this;\r\n        }\r\n        ArmatureDisplayData.toString = function () {\r\n            return "[class dragonBones.ArmatureDisplayData]";\r\n        };\r\n        ArmatureDisplayData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            for (var _i = 0, _a = this.actions; _i < _a.length; _i++) {\r\n                var action = _a[_i];\r\n                action.returnToPool();\r\n            }\r\n            this.type = 1 /* Armature */;\r\n            this.inheritAnimation = false;\r\n            this.actions.length = 0;\r\n            this.armature = null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        ArmatureDisplayData.prototype.addAction = function (value) {\r\n            this.actions.push(value);\r\n        };\r\n        return ArmatureDisplayData;\r\n    }(DisplayData));\r\n    dragonBones.ArmatureDisplayData = ArmatureDisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var MeshDisplayData = /** @class */ (function (_super) {\r\n        __extends(MeshDisplayData, _super);\r\n        function MeshDisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.geometry = new GeometryData();\r\n            return _this;\r\n        }\r\n        MeshDisplayData.toString = function () {\r\n            return "[class dragonBones.MeshDisplayData]";\r\n        };\r\n        MeshDisplayData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 2 /* Mesh */;\r\n            this.geometry.clear();\r\n            this.texture = null;\r\n        };\r\n        return MeshDisplayData;\r\n    }(DisplayData));\r\n    dragonBones.MeshDisplayData = MeshDisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var BoundingBoxDisplayData = /** @class */ (function (_super) {\r\n        __extends(BoundingBoxDisplayData, _super);\r\n        function BoundingBoxDisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.boundingBox = null; // Initial value.\r\n            return _this;\r\n        }\r\n        BoundingBoxDisplayData.toString = function () {\r\n            return "[class dragonBones.BoundingBoxDisplayData]";\r\n        };\r\n        BoundingBoxDisplayData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            if (this.boundingBox !== null) {\r\n                this.boundingBox.returnToPool();\r\n            }\r\n            this.type = 3 /* BoundingBox */;\r\n            this.boundingBox = null;\r\n        };\r\n        return BoundingBoxDisplayData;\r\n    }(DisplayData));\r\n    dragonBones.BoundingBoxDisplayData = BoundingBoxDisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var PathDisplayData = /** @class */ (function (_super) {\r\n        __extends(PathDisplayData, _super);\r\n        function PathDisplayData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.geometry = new GeometryData();\r\n            _this.curveLengths = [];\r\n            return _this;\r\n        }\r\n        PathDisplayData.toString = function () {\r\n            return "[class dragonBones.PathDisplayData]";\r\n        };\r\n        PathDisplayData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 4 /* Path */;\r\n            this.closed = false;\r\n            this.constantSpeed = false;\r\n            this.geometry.clear();\r\n            this.curveLengths.length = 0;\r\n        };\r\n        return PathDisplayData;\r\n    }(DisplayData));\r\n    dragonBones.PathDisplayData = PathDisplayData;\r\n    /**\r\n     * @private\r\n     */\r\n    var WeightData = /** @class */ (function (_super) {\r\n        __extends(WeightData, _super);\r\n        function WeightData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.bones = [];\r\n            return _this;\r\n        }\r\n        WeightData.toString = function () {\r\n            return "[class dragonBones.WeightData]";\r\n        };\r\n        WeightData.prototype._onClear = function () {\r\n            this.count = 0;\r\n            this.offset = 0;\r\n            this.bones.length = 0;\r\n        };\r\n        WeightData.prototype.addBone = function (value) {\r\n            this.bones.push(value);\r\n        };\r\n        return WeightData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.WeightData = WeightData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The base class of bounding box data.\r\n     * @see dragonBones.RectangleData\r\n     * @see dragonBones.EllipseData\r\n     * @see dragonBones.PolygonData\r\n     * @version DragonBones 5.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 边界框数据基类。\r\n     * @see dragonBones.RectangleData\r\n     * @see dragonBones.EllipseData\r\n     * @see dragonBones.PolygonData\r\n     * @version DragonBones 5.0\r\n     * @language zh_CN\r\n     */\r\n    var BoundingBoxData = /** @class */ (function (_super) {\r\n        __extends(BoundingBoxData, _super);\r\n        function BoundingBoxData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BoundingBoxData.prototype._onClear = function () {\r\n            this.color = 0x000000;\r\n            this.width = 0.0;\r\n            this.height = 0.0;\r\n        };\r\n        return BoundingBoxData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.BoundingBoxData = BoundingBoxData;\r\n    /**\r\n     * - The rectangle bounding box data.\r\n     * @version DragonBones 5.1\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 矩形边界框数据。\r\n     * @version DragonBones 5.1\r\n     * @language zh_CN\r\n     */\r\n    var RectangleBoundingBoxData = /** @class */ (function (_super) {\r\n        __extends(RectangleBoundingBoxData, _super);\r\n        function RectangleBoundingBoxData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        RectangleBoundingBoxData.toString = function () {\r\n            return "[class dragonBones.RectangleBoundingBoxData]";\r\n        };\r\n        /**\r\n         * - Compute the bit code for a point (x, y) using the clip rectangle\r\n         */\r\n        RectangleBoundingBoxData._computeOutCode = function (x, y, xMin, yMin, xMax, yMax) {\r\n            var code = 0 /* InSide */; // initialised as being inside of [[clip window]]\r\n            if (x < xMin) { // to the left of clip window\r\n                code |= 1 /* Left */;\r\n            }\r\n            else if (x > xMax) { // to the right of clip window\r\n                code |= 2 /* Right */;\r\n            }\r\n            if (y < yMin) { // below the clip window\r\n                code |= 4 /* Top */;\r\n            }\r\n            else if (y > yMax) { // above the clip window\r\n                code |= 8 /* Bottom */;\r\n            }\r\n            return code;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        RectangleBoundingBoxData.rectangleIntersectsSegment = function (xA, yA, xB, yB, xMin, yMin, xMax, yMax, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var inSideA = xA > xMin && xA < xMax && yA > yMin && yA < yMax;\r\n            var inSideB = xB > xMin && xB < xMax && yB > yMin && yB < yMax;\r\n            if (inSideA && inSideB) {\r\n                return -1;\r\n            }\r\n            var intersectionCount = 0;\r\n            var outcode0 = RectangleBoundingBoxData._computeOutCode(xA, yA, xMin, yMin, xMax, yMax);\r\n            var outcode1 = RectangleBoundingBoxData._computeOutCode(xB, yB, xMin, yMin, xMax, yMax);\r\n            while (true) {\r\n                if ((outcode0 | outcode1) === 0) { // Bitwise OR is 0. Trivially accept and get out of loop\r\n                    intersectionCount = 2;\r\n                    break;\r\n                }\r\n                else if ((outcode0 & outcode1) !== 0) { // Bitwise AND is not 0. Trivially reject and get out of loop\r\n                    break;\r\n                }\r\n                // failed both tests, so calculate the line segment to clip\r\n                // from an outside point to an intersection with clip edge\r\n                var x = 0.0;\r\n                var y = 0.0;\r\n                var normalRadian = 0.0;\r\n                // At least one endpoint is outside the clip rectangle; pick it.\r\n                var outcodeOut = outcode0 !== 0 ? outcode0 : outcode1;\r\n                // Now find the intersection point;\r\n                if ((outcodeOut & 4 /* Top */) !== 0) { // point is above the clip rectangle\r\n                    x = xA + (xB - xA) * (yMin - yA) / (yB - yA);\r\n                    y = yMin;\r\n                    if (normalRadians !== null) {\r\n                        normalRadian = -Math.PI * 0.5;\r\n                    }\r\n                }\r\n                else if ((outcodeOut & 8 /* Bottom */) !== 0) { // point is below the clip rectangle\r\n                    x = xA + (xB - xA) * (yMax - yA) / (yB - yA);\r\n                    y = yMax;\r\n                    if (normalRadians !== null) {\r\n                        normalRadian = Math.PI * 0.5;\r\n                    }\r\n                }\r\n                else if ((outcodeOut & 2 /* Right */) !== 0) { // point is to the right of clip rectangle\r\n                    y = yA + (yB - yA) * (xMax - xA) / (xB - xA);\r\n                    x = xMax;\r\n                    if (normalRadians !== null) {\r\n                        normalRadian = 0;\r\n                    }\r\n                }\r\n                else if ((outcodeOut & 1 /* Left */) !== 0) { // point is to the left of clip rectangle\r\n                    y = yA + (yB - yA) * (xMin - xA) / (xB - xA);\r\n                    x = xMin;\r\n                    if (normalRadians !== null) {\r\n                        normalRadian = Math.PI;\r\n                    }\r\n                }\r\n                // Now we move outside point to intersection point to clip\r\n                // and get ready for next pass.\r\n                if (outcodeOut === outcode0) {\r\n                    xA = x;\r\n                    yA = y;\r\n                    outcode0 = RectangleBoundingBoxData._computeOutCode(xA, yA, xMin, yMin, xMax, yMax);\r\n                    if (normalRadians !== null) {\r\n                        normalRadians.x = normalRadian;\r\n                    }\r\n                }\r\n                else {\r\n                    xB = x;\r\n                    yB = y;\r\n                    outcode1 = RectangleBoundingBoxData._computeOutCode(xB, yB, xMin, yMin, xMax, yMax);\r\n                    if (normalRadians !== null) {\r\n                        normalRadians.y = normalRadian;\r\n                    }\r\n                }\r\n            }\r\n            if (intersectionCount) {\r\n                if (inSideA) {\r\n                    intersectionCount = 2; // 10\r\n                    if (intersectionPointA !== null) {\r\n                        intersectionPointA.x = xB;\r\n                        intersectionPointA.y = yB;\r\n                    }\r\n                    if (intersectionPointB !== null) {\r\n                        intersectionPointB.x = xB;\r\n                        intersectionPointB.y = xB;\r\n                    }\r\n                    if (normalRadians !== null) {\r\n                        normalRadians.x = normalRadians.y + Math.PI;\r\n                    }\r\n                }\r\n                else if (inSideB) {\r\n                    intersectionCount = 1; // 01\r\n                    if (intersectionPointA !== null) {\r\n                        intersectionPointA.x = xA;\r\n                        intersectionPointA.y = yA;\r\n                    }\r\n                    if (intersectionPointB !== null) {\r\n                        intersectionPointB.x = xA;\r\n                        intersectionPointB.y = yA;\r\n                    }\r\n                    if (normalRadians !== null) {\r\n                        normalRadians.y = normalRadians.x + Math.PI;\r\n                    }\r\n                }\r\n                else {\r\n                    intersectionCount = 3; // 11\r\n                    if (intersectionPointA !== null) {\r\n                        intersectionPointA.x = xA;\r\n                        intersectionPointA.y = yA;\r\n                    }\r\n                    if (intersectionPointB !== null) {\r\n                        intersectionPointB.x = xB;\r\n                        intersectionPointB.y = yB;\r\n                    }\r\n                }\r\n            }\r\n            return intersectionCount;\r\n        };\r\n        RectangleBoundingBoxData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 0 /* Rectangle */;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        RectangleBoundingBoxData.prototype.containsPoint = function (pX, pY) {\r\n            var widthH = this.width * 0.5;\r\n            if (pX >= -widthH && pX <= widthH) {\r\n                var heightH = this.height * 0.5;\r\n                if (pY >= -heightH && pY <= heightH) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        RectangleBoundingBoxData.prototype.intersectsSegment = function (xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var widthH = this.width * 0.5;\r\n            var heightH = this.height * 0.5;\r\n            var intersectionCount = RectangleBoundingBoxData.rectangleIntersectsSegment(xA, yA, xB, yB, -widthH, -heightH, widthH, heightH, intersectionPointA, intersectionPointB, normalRadians);\r\n            return intersectionCount;\r\n        };\r\n        return RectangleBoundingBoxData;\r\n    }(BoundingBoxData));\r\n    dragonBones.RectangleBoundingBoxData = RectangleBoundingBoxData;\r\n    /**\r\n     * - The ellipse bounding box data.\r\n     * @version DragonBones 5.1\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 椭圆边界框数据。\r\n     * @version DragonBones 5.1\r\n     * @language zh_CN\r\n     */\r\n    var EllipseBoundingBoxData = /** @class */ (function (_super) {\r\n        __extends(EllipseBoundingBoxData, _super);\r\n        function EllipseBoundingBoxData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        EllipseBoundingBoxData.toString = function () {\r\n            return "[class dragonBones.EllipseData]";\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        EllipseBoundingBoxData.ellipseIntersectsSegment = function (xA, yA, xB, yB, xC, yC, widthH, heightH, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var d = widthH / heightH;\r\n            var dd = d * d;\r\n            yA *= d;\r\n            yB *= d;\r\n            var dX = xB - xA;\r\n            var dY = yB - yA;\r\n            var lAB = Math.sqrt(dX * dX + dY * dY);\r\n            var xD = dX / lAB;\r\n            var yD = dY / lAB;\r\n            var a = (xC - xA) * xD + (yC - yA) * yD;\r\n            var aa = a * a;\r\n            var ee = xA * xA + yA * yA;\r\n            var rr = widthH * widthH;\r\n            var dR = rr - ee + aa;\r\n            var intersectionCount = 0;\r\n            if (dR >= 0.0) {\r\n                var dT = Math.sqrt(dR);\r\n                var sA = a - dT;\r\n                var sB = a + dT;\r\n                var inSideA = sA < 0.0 ? -1 : (sA <= lAB ? 0 : 1);\r\n                var inSideB = sB < 0.0 ? -1 : (sB <= lAB ? 0 : 1);\r\n                var sideAB = inSideA * inSideB;\r\n                if (sideAB < 0) {\r\n                    return -1;\r\n                }\r\n                else if (sideAB === 0) {\r\n                    if (inSideA === -1) {\r\n                        intersectionCount = 2; // 10\r\n                        xB = xA + sB * xD;\r\n                        yB = (yA + sB * yD) / d;\r\n                        if (intersectionPointA !== null) {\r\n                            intersectionPointA.x = xB;\r\n                            intersectionPointA.y = yB;\r\n                        }\r\n                        if (intersectionPointB !== null) {\r\n                            intersectionPointB.x = xB;\r\n                            intersectionPointB.y = yB;\r\n                        }\r\n                        if (normalRadians !== null) {\r\n                            normalRadians.x = Math.atan2(yB / rr * dd, xB / rr);\r\n                            normalRadians.y = normalRadians.x + Math.PI;\r\n                        }\r\n                    }\r\n                    else if (inSideB === 1) {\r\n                        intersectionCount = 1; // 01\r\n                        xA = xA + sA * xD;\r\n                        yA = (yA + sA * yD) / d;\r\n                        if (intersectionPointA !== null) {\r\n                            intersectionPointA.x = xA;\r\n                            intersectionPointA.y = yA;\r\n                        }\r\n                        if (intersectionPointB !== null) {\r\n                            intersectionPointB.x = xA;\r\n                            intersectionPointB.y = yA;\r\n                        }\r\n                        if (normalRadians !== null) {\r\n                            normalRadians.x = Math.atan2(yA / rr * dd, xA / rr);\r\n                            normalRadians.y = normalRadians.x + Math.PI;\r\n                        }\r\n                    }\r\n                    else {\r\n                        intersectionCount = 3; // 11\r\n                        if (intersectionPointA !== null) {\r\n                            intersectionPointA.x = xA + sA * xD;\r\n                            intersectionPointA.y = (yA + sA * yD) / d;\r\n                            if (normalRadians !== null) {\r\n                                normalRadians.x = Math.atan2(intersectionPointA.y / rr * dd, intersectionPointA.x / rr);\r\n                            }\r\n                        }\r\n                        if (intersectionPointB !== null) {\r\n                            intersectionPointB.x = xA + sB * xD;\r\n                            intersectionPointB.y = (yA + sB * yD) / d;\r\n                            if (normalRadians !== null) {\r\n                                normalRadians.y = Math.atan2(intersectionPointB.y / rr * dd, intersectionPointB.x / rr);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return intersectionCount;\r\n        };\r\n        EllipseBoundingBoxData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 1 /* Ellipse */;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        EllipseBoundingBoxData.prototype.containsPoint = function (pX, pY) {\r\n            var widthH = this.width * 0.5;\r\n            if (pX >= -widthH && pX <= widthH) {\r\n                var heightH = this.height * 0.5;\r\n                if (pY >= -heightH && pY <= heightH) {\r\n                    pY *= widthH / heightH;\r\n                    return Math.sqrt(pX * pX + pY * pY) <= widthH;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        EllipseBoundingBoxData.prototype.intersectsSegment = function (xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var intersectionCount = EllipseBoundingBoxData.ellipseIntersectsSegment(xA, yA, xB, yB, 0.0, 0.0, this.width * 0.5, this.height * 0.5, intersectionPointA, intersectionPointB, normalRadians);\r\n            return intersectionCount;\r\n        };\r\n        return EllipseBoundingBoxData;\r\n    }(BoundingBoxData));\r\n    dragonBones.EllipseBoundingBoxData = EllipseBoundingBoxData;\r\n    /**\r\n     * - The polygon bounding box data.\r\n     * @version DragonBones 5.1\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 多边形边界框数据。\r\n     * @version DragonBones 5.1\r\n     * @language zh_CN\r\n     */\r\n    var PolygonBoundingBoxData = /** @class */ (function (_super) {\r\n        __extends(PolygonBoundingBoxData, _super);\r\n        function PolygonBoundingBoxData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * - The polygon vertices.\r\n             * @version DragonBones 5.1\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 多边形顶点。\r\n             * @version DragonBones 5.1\r\n             * @language zh_CN\r\n             */\r\n            _this.vertices = [];\r\n            return _this;\r\n        }\r\n        PolygonBoundingBoxData.toString = function () {\r\n            return "[class dragonBones.PolygonBoundingBoxData]";\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        PolygonBoundingBoxData.polygonIntersectsSegment = function (xA, yA, xB, yB, vertices, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            if (xA === xB) {\r\n                xA = xB + 0.000001;\r\n            }\r\n            if (yA === yB) {\r\n                yA = yB + 0.000001;\r\n            }\r\n            var count = vertices.length;\r\n            var dXAB = xA - xB;\r\n            var dYAB = yA - yB;\r\n            var llAB = xA * yB - yA * xB;\r\n            var intersectionCount = 0;\r\n            var xC = vertices[count - 2];\r\n            var yC = vertices[count - 1];\r\n            var dMin = 0.0;\r\n            var dMax = 0.0;\r\n            var xMin = 0.0;\r\n            var yMin = 0.0;\r\n            var xMax = 0.0;\r\n            var yMax = 0.0;\r\n            for (var i = 0; i < count; i += 2) {\r\n                var xD = vertices[i];\r\n                var yD = vertices[i + 1];\r\n                if (xC === xD) {\r\n                    xC = xD + 0.0001;\r\n                }\r\n                if (yC === yD) {\r\n                    yC = yD + 0.0001;\r\n                }\r\n                var dXCD = xC - xD;\r\n                var dYCD = yC - yD;\r\n                var llCD = xC * yD - yC * xD;\r\n                var ll = dXAB * dYCD - dYAB * dXCD;\r\n                var x = (llAB * dXCD - dXAB * llCD) / ll;\r\n                if (((x >= xC && x <= xD) || (x >= xD && x <= xC)) && (dXAB === 0.0 || (x >= xA && x <= xB) || (x >= xB && x <= xA))) {\r\n                    var y = (llAB * dYCD - dYAB * llCD) / ll;\r\n                    if (((y >= yC && y <= yD) || (y >= yD && y <= yC)) && (dYAB === 0.0 || (y >= yA && y <= yB) || (y >= yB && y <= yA))) {\r\n                        if (intersectionPointB !== null) {\r\n                            var d = x - xA;\r\n                            if (d < 0.0) {\r\n                                d = -d;\r\n                            }\r\n                            if (intersectionCount === 0) {\r\n                                dMin = d;\r\n                                dMax = d;\r\n                                xMin = x;\r\n                                yMin = y;\r\n                                xMax = x;\r\n                                yMax = y;\r\n                                if (normalRadians !== null) {\r\n                                    normalRadians.x = Math.atan2(yD - yC, xD - xC) - Math.PI * 0.5;\r\n                                    normalRadians.y = normalRadians.x;\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (d < dMin) {\r\n                                    dMin = d;\r\n                                    xMin = x;\r\n                                    yMin = y;\r\n                                    if (normalRadians !== null) {\r\n                                        normalRadians.x = Math.atan2(yD - yC, xD - xC) - Math.PI * 0.5;\r\n                                    }\r\n                                }\r\n                                if (d > dMax) {\r\n                                    dMax = d;\r\n                                    xMax = x;\r\n                                    yMax = y;\r\n                                    if (normalRadians !== null) {\r\n                                        normalRadians.y = Math.atan2(yD - yC, xD - xC) - Math.PI * 0.5;\r\n                                    }\r\n                                }\r\n                            }\r\n                            intersectionCount++;\r\n                        }\r\n                        else {\r\n                            xMin = x;\r\n                            yMin = y;\r\n                            xMax = x;\r\n                            yMax = y;\r\n                            intersectionCount++;\r\n                            if (normalRadians !== null) {\r\n                                normalRadians.x = Math.atan2(yD - yC, xD - xC) - Math.PI * 0.5;\r\n                                normalRadians.y = normalRadians.x;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                xC = xD;\r\n                yC = yD;\r\n            }\r\n            if (intersectionCount === 1) {\r\n                if (intersectionPointA !== null) {\r\n                    intersectionPointA.x = xMin;\r\n                    intersectionPointA.y = yMin;\r\n                }\r\n                if (intersectionPointB !== null) {\r\n                    intersectionPointB.x = xMin;\r\n                    intersectionPointB.y = yMin;\r\n                }\r\n                if (normalRadians !== null) {\r\n                    normalRadians.y = normalRadians.x + Math.PI;\r\n                }\r\n            }\r\n            else if (intersectionCount > 1) {\r\n                intersectionCount++;\r\n                if (intersectionPointA !== null) {\r\n                    intersectionPointA.x = xMin;\r\n                    intersectionPointA.y = yMin;\r\n                }\r\n                if (intersectionPointB !== null) {\r\n                    intersectionPointB.x = xMax;\r\n                    intersectionPointB.y = yMax;\r\n                }\r\n            }\r\n            return intersectionCount;\r\n        };\r\n        PolygonBoundingBoxData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.type = 2 /* Polygon */;\r\n            this.x = 0.0;\r\n            this.y = 0.0;\r\n            this.vertices.length = 0;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        PolygonBoundingBoxData.prototype.containsPoint = function (pX, pY) {\r\n            var isInSide = false;\r\n            if (pX >= this.x && pX <= this.width && pY >= this.y && pY <= this.height) {\r\n                for (var i = 0, l = this.vertices.length, iP = l - 2; i < l; i += 2) {\r\n                    var yA = this.vertices[iP + 1];\r\n                    var yB = this.vertices[i + 1];\r\n                    if ((yB < pY && yA >= pY) || (yA < pY && yB >= pY)) {\r\n                        var xA = this.vertices[iP];\r\n                        var xB = this.vertices[i];\r\n                        if ((pY - yB) * (xA - xB) / (yA - yB) + xB < pX) {\r\n                            isInSide = !isInSide;\r\n                        }\r\n                    }\r\n                    iP = i;\r\n                }\r\n            }\r\n            return isInSide;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        PolygonBoundingBoxData.prototype.intersectsSegment = function (xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var intersectionCount = 0;\r\n            if (RectangleBoundingBoxData.rectangleIntersectsSegment(xA, yA, xB, yB, this.x, this.y, this.x + this.width, this.y + this.height, null, null, null) !== 0) {\r\n                intersectionCount = PolygonBoundingBoxData.polygonIntersectsSegment(xA, yA, xB, yB, this.vertices, intersectionPointA, intersectionPointB, normalRadians);\r\n            }\r\n            return intersectionCount;\r\n        };\r\n        return PolygonBoundingBoxData;\r\n    }(BoundingBoxData));\r\n    dragonBones.PolygonBoundingBoxData = PolygonBoundingBoxData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The animation data.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 动画数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var AnimationData = /** @class */ (function (_super) {\r\n        __extends(AnimationData, _super);\r\n        function AnimationData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.cachedFrames = [];\r\n            /**\r\n             * @private\r\n             */\r\n            _this.boneTimelines = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.slotTimelines = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.constraintTimelines = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.animationTimelines = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.boneCachedFrameIndices = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.slotCachedFrameIndices = {};\r\n            /**\r\n             * @private\r\n             */\r\n            _this.actionTimeline = null; // Initial value.\r\n            /**\r\n             * @private\r\n             */\r\n            _this.zOrderTimeline = null; // Initial value.\r\n            return _this;\r\n        }\r\n        AnimationData.toString = function () {\r\n            return "[class dragonBones.AnimationData]";\r\n        };\r\n        AnimationData.prototype._onClear = function () {\r\n            for (var k in this.boneTimelines) {\r\n                for (var _i = 0, _a = this.boneTimelines[k]; _i < _a.length; _i++) {\r\n                    var timeline = _a[_i];\r\n                    timeline.returnToPool();\r\n                }\r\n                delete this.boneTimelines[k];\r\n            }\r\n            for (var k in this.slotTimelines) {\r\n                for (var _b = 0, _c = this.slotTimelines[k]; _b < _c.length; _b++) {\r\n                    var timeline = _c[_b];\r\n                    timeline.returnToPool();\r\n                }\r\n                delete this.slotTimelines[k];\r\n            }\r\n            for (var k in this.constraintTimelines) {\r\n                for (var _d = 0, _e = this.constraintTimelines[k]; _d < _e.length; _d++) {\r\n                    var timeline = _e[_d];\r\n                    timeline.returnToPool();\r\n                }\r\n                delete this.constraintTimelines[k];\r\n            }\r\n            for (var k in this.animationTimelines) {\r\n                for (var _f = 0, _g = this.animationTimelines[k]; _f < _g.length; _f++) {\r\n                    var timeline = _g[_f];\r\n                    timeline.returnToPool();\r\n                }\r\n                delete this.animationTimelines[k];\r\n            }\r\n            for (var k in this.boneCachedFrameIndices) {\r\n                delete this.boneCachedFrameIndices[k];\r\n            }\r\n            for (var k in this.slotCachedFrameIndices) {\r\n                delete this.slotCachedFrameIndices[k];\r\n            }\r\n            if (this.actionTimeline !== null) {\r\n                this.actionTimeline.returnToPool();\r\n            }\r\n            if (this.zOrderTimeline !== null) {\r\n                this.zOrderTimeline.returnToPool();\r\n            }\r\n            this.frameIntOffset = 0;\r\n            this.frameFloatOffset = 0;\r\n            this.frameOffset = 0;\r\n            this.blendType = 0 /* None */;\r\n            this.frameCount = 0;\r\n            this.playTimes = 0;\r\n            this.duration = 0.0;\r\n            this.scale = 1.0;\r\n            this.fadeInTime = 0.0;\r\n            this.cacheFrameRate = 0.0;\r\n            this.name = "";\r\n            this.cachedFrames.length = 0;\r\n            // this.boneTimelines.clear();\r\n            // this.slotTimelines.clear();\r\n            // this.constraintTimelines.clear();\r\n            // this.animationTimelines.clear();\r\n            // this.boneCachedFrameIndices.clear();\r\n            // this.slotCachedFrameIndices.clear();\r\n            this.actionTimeline = null;\r\n            this.zOrderTimeline = null;\r\n            this.parent = null; //\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        AnimationData.prototype.cacheFrames = function (frameRate) {\r\n            if (this.cacheFrameRate > 0.0) { // TODO clear cache.\r\n                return;\r\n            }\r\n            this.cacheFrameRate = Math.max(Math.ceil(frameRate * this.scale), 1.0);\r\n            var cacheFrameCount = Math.ceil(this.cacheFrameRate * this.duration) + 1; // Cache one more frame.\r\n            this.cachedFrames.length = cacheFrameCount;\r\n            for (var i = 0, l = this.cacheFrames.length; i < l; ++i) {\r\n                this.cachedFrames[i] = false;\r\n            }\r\n            for (var _i = 0, _a = this.parent.sortedBones; _i < _a.length; _i++) {\r\n                var bone = _a[_i];\r\n                var indices = new Array(cacheFrameCount);\r\n                for (var i = 0, l = indices.length; i < l; ++i) {\r\n                    indices[i] = -1;\r\n                }\r\n                this.boneCachedFrameIndices[bone.name] = indices;\r\n            }\r\n            for (var _b = 0, _c = this.parent.sortedSlots; _b < _c.length; _b++) {\r\n                var slot = _c[_b];\r\n                var indices = new Array(cacheFrameCount);\r\n                for (var i = 0, l = indices.length; i < l; ++i) {\r\n                    indices[i] = -1;\r\n                }\r\n                this.slotCachedFrameIndices[slot.name] = indices;\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.addBoneTimeline = function (timelineName, timeline) {\r\n            var timelines = timelineName in this.boneTimelines ? this.boneTimelines[timelineName] : (this.boneTimelines[timelineName] = []);\r\n            if (timelines.indexOf(timeline) < 0) {\r\n                timelines.push(timeline);\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.addSlotTimeline = function (timelineName, timeline) {\r\n            var timelines = timelineName in this.slotTimelines ? this.slotTimelines[timelineName] : (this.slotTimelines[timelineName] = []);\r\n            if (timelines.indexOf(timeline) < 0) {\r\n                timelines.push(timeline);\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.addConstraintTimeline = function (timelineName, timeline) {\r\n            var timelines = timelineName in this.constraintTimelines ? this.constraintTimelines[timelineName] : (this.constraintTimelines[timelineName] = []);\r\n            if (timelines.indexOf(timeline) < 0) {\r\n                timelines.push(timeline);\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.addAnimationTimeline = function (timelineName, timeline) {\r\n            var timelines = timelineName in this.animationTimelines ? this.animationTimelines[timelineName] : (this.animationTimelines[timelineName] = []);\r\n            if (timelines.indexOf(timeline) < 0) {\r\n                timelines.push(timeline);\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getBoneTimelines = function (timelineName) {\r\n            return timelineName in this.boneTimelines ? this.boneTimelines[timelineName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getSlotTimelines = function (timelineName) {\r\n            return timelineName in this.slotTimelines ? this.slotTimelines[timelineName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getConstraintTimelines = function (timelineName) {\r\n            return timelineName in this.constraintTimelines ? this.constraintTimelines[timelineName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getAnimationTimelines = function (timelineName) {\r\n            return timelineName in this.animationTimelines ? this.animationTimelines[timelineName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getBoneCachedFrameIndices = function (boneName) {\r\n            return boneName in this.boneCachedFrameIndices ? this.boneCachedFrameIndices[boneName] : null;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationData.prototype.getSlotCachedFrameIndices = function (slotName) {\r\n            return slotName in this.slotCachedFrameIndices ? this.slotCachedFrameIndices[slotName] : null;\r\n        };\r\n        return AnimationData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.AnimationData = AnimationData;\r\n    /**\r\n     * @private\r\n     */\r\n    var TimelineData = /** @class */ (function (_super) {\r\n        __extends(TimelineData, _super);\r\n        function TimelineData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        TimelineData.toString = function () {\r\n            return "[class dragonBones.TimelineData]";\r\n        };\r\n        TimelineData.prototype._onClear = function () {\r\n            this.type = 10 /* BoneAll */;\r\n            this.offset = 0;\r\n            this.frameIndicesOffset = -1;\r\n        };\r\n        return TimelineData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.TimelineData = TimelineData;\r\n    /**\r\n     * @internal\r\n     */\r\n    var AnimationTimelineData = /** @class */ (function (_super) {\r\n        __extends(AnimationTimelineData, _super);\r\n        function AnimationTimelineData() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        AnimationTimelineData.toString = function () {\r\n            return "[class dragonBones.AnimationTimelineData]";\r\n        };\r\n        AnimationTimelineData.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.x = 0.0;\r\n            this.y = 0.0;\r\n        };\r\n        return AnimationTimelineData;\r\n    }(TimelineData));\r\n    dragonBones.AnimationTimelineData = AnimationTimelineData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The animation config is used to describe all the information needed to play an animation state.\r\n     * The API is still in the experimental phase and may encounter bugs or stability or compatibility issues when used.\r\n     * @see dragonBones.AnimationState\r\n     * @beta\r\n     * @version DragonBones 5.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 动画配置用来描述播放一个动画状态所需要的全部信息。\r\n     * 该 API 仍在实验阶段，使用时可能遭遇 bug 或稳定性或兼容性问题。\r\n     * @see dragonBones.AnimationState\r\n     * @beta\r\n     * @version DragonBones 5.0\r\n     * @language zh_CN\r\n     */\r\n    var AnimationConfig = /** @class */ (function (_super) {\r\n        __extends(AnimationConfig, _super);\r\n        function AnimationConfig() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.boneMask = [];\r\n            return _this;\r\n        }\r\n        AnimationConfig.toString = function () {\r\n            return "[class dragonBones.AnimationConfig]";\r\n        };\r\n        AnimationConfig.prototype._onClear = function () {\r\n            this.pauseFadeOut = true;\r\n            this.fadeOutMode = 4 /* All */;\r\n            this.fadeOutTweenType = 1 /* Line */;\r\n            this.fadeOutTime = -1.0;\r\n            this.actionEnabled = true;\r\n            this.additive = false;\r\n            this.displayControl = true;\r\n            this.pauseFadeIn = true;\r\n            this.resetToPose = true;\r\n            this.fadeInTweenType = 1 /* Line */;\r\n            this.playTimes = -1;\r\n            this.layer = 0;\r\n            this.position = 0.0;\r\n            this.duration = -1.0;\r\n            this.timeScale = -100.0;\r\n            this.weight = 1.0;\r\n            this.fadeInTime = -1.0;\r\n            this.autoFadeOutTime = -1.0;\r\n            this.name = "";\r\n            this.animation = "";\r\n            this.group = "";\r\n            this.boneMask.length = 0;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationConfig.prototype.clear = function () {\r\n            this._onClear();\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationConfig.prototype.copyFrom = function (value) {\r\n            this.pauseFadeOut = value.pauseFadeOut;\r\n            this.fadeOutMode = value.fadeOutMode;\r\n            this.autoFadeOutTime = value.autoFadeOutTime;\r\n            this.fadeOutTweenType = value.fadeOutTweenType;\r\n            this.actionEnabled = value.actionEnabled;\r\n            this.additive = value.additive;\r\n            this.displayControl = value.displayControl;\r\n            this.pauseFadeIn = value.pauseFadeIn;\r\n            this.resetToPose = value.resetToPose;\r\n            this.playTimes = value.playTimes;\r\n            this.layer = value.layer;\r\n            this.position = value.position;\r\n            this.duration = value.duration;\r\n            this.timeScale = value.timeScale;\r\n            this.fadeInTime = value.fadeInTime;\r\n            this.fadeOutTime = value.fadeOutTime;\r\n            this.fadeInTweenType = value.fadeInTweenType;\r\n            this.weight = value.weight;\r\n            this.name = value.name;\r\n            this.animation = value.animation;\r\n            this.group = value.group;\r\n            this.boneMask.length = value.boneMask.length;\r\n            for (var i = 0, l = this.boneMask.length; i < l; ++i) {\r\n                this.boneMask[i] = value.boneMask[i];\r\n            }\r\n        };\r\n        return AnimationConfig;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.AnimationConfig = AnimationConfig;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The texture atlas data.\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 贴图集数据。\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var TextureAtlasData = /** @class */ (function (_super) {\r\n        __extends(TextureAtlasData, _super);\r\n        function TextureAtlasData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @private\r\n             */\r\n            _this.textures = {};\r\n            return _this;\r\n        }\r\n        TextureAtlasData.prototype._onClear = function () {\r\n            for (var k in this.textures) {\r\n                this.textures[k].returnToPool();\r\n                delete this.textures[k];\r\n            }\r\n            this.autoSearch = false;\r\n            this.width = 0;\r\n            this.height = 0;\r\n            this.scale = 1.0;\r\n            // this.textures.clear();\r\n            this.name = "";\r\n            this.imagePath = "";\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        TextureAtlasData.prototype.copyFrom = function (value) {\r\n            this.autoSearch = value.autoSearch;\r\n            this.scale = value.scale;\r\n            this.width = value.width;\r\n            this.height = value.height;\r\n            this.name = value.name;\r\n            this.imagePath = value.imagePath;\r\n            for (var k in this.textures) {\r\n                this.textures[k].returnToPool();\r\n                delete this.textures[k];\r\n            }\r\n            // this.textures.clear();\r\n            for (var k in value.textures) {\r\n                var texture = this.createTexture();\r\n                texture.copyFrom(value.textures[k]);\r\n                this.textures[k] = texture;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        TextureAtlasData.prototype.addTexture = function (value) {\r\n            if (value.name in this.textures) {\r\n                console.warn("Same texture: " + value.name);\r\n                return;\r\n            }\r\n            value.parent = this;\r\n            this.textures[value.name] = value;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        TextureAtlasData.prototype.getTexture = function (textureName) {\r\n            return textureName in this.textures ? this.textures[textureName] : null;\r\n        };\r\n        return TextureAtlasData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.TextureAtlasData = TextureAtlasData;\r\n    /**\r\n     * @private\r\n     */\r\n    var TextureData = /** @class */ (function (_super) {\r\n        __extends(TextureData, _super);\r\n        function TextureData() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.region = new dragonBones.Rectangle();\r\n            _this.frame = null; // Initial value.\r\n            return _this;\r\n        }\r\n        TextureData.createRectangle = function () {\r\n            return new dragonBones.Rectangle();\r\n        };\r\n        TextureData.prototype._onClear = function () {\r\n            this.rotated = false;\r\n            this.name = "";\r\n            this.region.clear();\r\n            this.parent = null; //\r\n            this.frame = null;\r\n        };\r\n        TextureData.prototype.copyFrom = function (value) {\r\n            this.rotated = value.rotated;\r\n            this.name = value.name;\r\n            this.region.copyFrom(value.region);\r\n            this.parent = value.parent;\r\n            if (this.frame === null && value.frame !== null) {\r\n                this.frame = TextureData.createRectangle();\r\n            }\r\n            else if (this.frame !== null && value.frame === null) {\r\n                this.frame = null;\r\n            }\r\n            if (this.frame !== null && value.frame !== null) {\r\n                this.frame.copyFrom(value.frame);\r\n            }\r\n        };\r\n        return TextureData;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.TextureData = TextureData;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones_1) {\r\n    /**\r\n     * - Armature is the core of the skeleton animation system.\r\n     * @see dragonBones.ArmatureData\r\n     * @see dragonBones.Bone\r\n     * @see dragonBones.Slot\r\n     * @see dragonBones.Animation\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 骨架是骨骼动画系统的核心。\r\n     * @see dragonBones.ArmatureData\r\n     * @see dragonBones.Bone\r\n     * @see dragonBones.Slot\r\n     * @see dragonBones.Animation\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Armature = /** @class */ (function (_super) {\r\n        __extends(Armature, _super);\r\n        function Armature() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._bones = [];\r\n            _this._slots = [];\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._constraints = [];\r\n            _this._actions = [];\r\n            _this._animation = null; // Initial value.\r\n            _this._proxy = null; // Initial value.\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._replaceTextureAtlasData = null; // Initial value.\r\n            _this._clock = null; // Initial value.\r\n            return _this;\r\n        }\r\n        Armature.toString = function () {\r\n            return "[class dragonBones.Armature]";\r\n        };\r\n        Armature._onSortSlots = function (a, b) {\r\n            return a._zIndex * 1000 + a._zOrder > b._zIndex * 1000 + b._zOrder ? 1 : -1;\r\n        };\r\n        Armature.prototype._onClear = function () {\r\n            if (this._clock !== null) { // Remove clock first.\r\n                this._clock.remove(this);\r\n            }\r\n            for (var _i = 0, _a = this._bones; _i < _a.length; _i++) {\r\n                var bone = _a[_i];\r\n                bone.returnToPool();\r\n            }\r\n            for (var _b = 0, _c = this._slots; _b < _c.length; _b++) {\r\n                var slot = _c[_b];\r\n                slot.returnToPool();\r\n            }\r\n            for (var _d = 0, _e = this._constraints; _d < _e.length; _d++) {\r\n                var constraint = _e[_d];\r\n                constraint.returnToPool();\r\n            }\r\n            for (var _f = 0, _g = this._actions; _f < _g.length; _f++) {\r\n                var action = _g[_f];\r\n                action.returnToPool();\r\n            }\r\n            if (this._animation !== null) {\r\n                this._animation.returnToPool();\r\n            }\r\n            if (this._proxy !== null) {\r\n                this._proxy.dbClear();\r\n            }\r\n            if (this._replaceTextureAtlasData !== null) {\r\n                this._replaceTextureAtlasData.returnToPool();\r\n            }\r\n            this.inheritAnimation = true;\r\n            this.userData = null;\r\n            this._lockUpdate = false;\r\n            this._slotsDirty = true;\r\n            this._zOrderDirty = false;\r\n            this._zIndexDirty = false;\r\n            this._alphaDirty = true;\r\n            this._flipX = false;\r\n            this._flipY = false;\r\n            this._cacheFrameIndex = -1;\r\n            this._alpha = 1.0;\r\n            this._globalAlpha = 1.0;\r\n            this._bones.length = 0;\r\n            this._slots.length = 0;\r\n            this._constraints.length = 0;\r\n            this._actions.length = 0;\r\n            this._armatureData = null; //\r\n            this._animation = null; //\r\n            this._proxy = null; //\r\n            this._display = null;\r\n            this._replaceTextureAtlasData = null;\r\n            this._replacedTexture = null;\r\n            this._dragonBones = null; //\r\n            this._clock = null;\r\n            this._parent = null;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype._sortZOrder = function (slotIndices, offset) {\r\n            var slotDatas = this._armatureData.sortedSlots;\r\n            var isOriginal = slotIndices === null;\r\n            if (this._zOrderDirty || !isOriginal) {\r\n                for (var i = 0, l = slotDatas.length; i < l; ++i) {\r\n                    var slotIndex = isOriginal ? i : slotIndices[offset + i];\r\n                    if (slotIndex < 0 || slotIndex >= l) {\r\n                        continue;\r\n                    }\r\n                    var slotData = slotDatas[slotIndex];\r\n                    var slot = this.getSlot(slotData.name);\r\n                    if (slot !== null) {\r\n                        slot._setZOrder(i);\r\n                    }\r\n                }\r\n                this._slotsDirty = true;\r\n                this._zOrderDirty = !isOriginal;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype._addBone = function (value) {\r\n            if (this._bones.indexOf(value) < 0) {\r\n                this._bones.push(value);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype._addSlot = function (value) {\r\n            if (this._slots.indexOf(value) < 0) {\r\n                this._slots.push(value);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype._addConstraint = function (value) {\r\n            if (this._constraints.indexOf(value) < 0) {\r\n                this._constraints.push(value);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype._bufferAction = function (action, append) {\r\n            if (this._actions.indexOf(action) < 0) {\r\n                if (append) {\r\n                    this._actions.push(action);\r\n                }\r\n                else {\r\n                    this._actions.unshift(action);\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Dispose the armature. (Return to the object pool)\r\n         * @example\r\n         * <pre>\r\n         *     removeChild(armature.display);\r\n         *     armature.dispose();\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 释放骨架。 （回收到对象池）\r\n         * @example\r\n         * <pre>\r\n         *     removeChild(armature.display);\r\n         *     armature.dispose();\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.dispose = function () {\r\n            if (this._armatureData !== null) {\r\n                this._lockUpdate = true;\r\n                this._dragonBones.bufferObject(this);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Armature.prototype.init = function (armatureData, proxy, display, dragonBones) {\r\n            if (this._armatureData !== null) {\r\n                return;\r\n            }\r\n            this._armatureData = armatureData;\r\n            this._animation = dragonBones_1.BaseObject.borrowObject(dragonBones_1.Animation);\r\n            this._proxy = proxy;\r\n            this._display = display;\r\n            this._dragonBones = dragonBones;\r\n            this._proxy.dbInit(this);\r\n            this._animation.init(this);\r\n            this._animation.animations = this._armatureData.animations;\r\n        };\r\n        /**\r\n         * @inheritDoc\r\n         */\r\n        Armature.prototype.advanceTime = function (passedTime) {\r\n            if (this._lockUpdate) {\r\n                return;\r\n            }\r\n            this._lockUpdate = true;\r\n            if (this._armatureData === null) {\r\n                console.warn("The armature has been disposed.");\r\n                return;\r\n            }\r\n            else if (this._armatureData.parent === null) {\r\n                console.warn("The armature data has been disposed.\\nPlease make sure dispose armature before call factory.clear().");\r\n                return;\r\n            }\r\n            var prevCacheFrameIndex = this._cacheFrameIndex;\r\n            // Update animation.\r\n            this._animation.advanceTime(passedTime);\r\n            // Sort slots.\r\n            if (this._slotsDirty || this._zIndexDirty) {\r\n                this._slots.sort(Armature._onSortSlots);\r\n                if (this._zIndexDirty) {\r\n                    for (var i = 0, l = this._slots.length; i < l; ++i) {\r\n                        this._slots[i]._setZOrder(i); // \r\n                    }\r\n                }\r\n                this._slotsDirty = false;\r\n                this._zIndexDirty = false;\r\n            }\r\n            // Update alpha.\r\n            if (this._alphaDirty) {\r\n                this._alphaDirty = false;\r\n                this._globalAlpha = this._alpha * (this._parent !== null ? this._parent._globalAlpha : 1.0);\r\n                for (var _i = 0, _a = this._bones; _i < _a.length; _i++) {\r\n                    var bone = _a[_i];\r\n                    bone._updateAlpha();\r\n                }\r\n                for (var _b = 0, _c = this._slots; _b < _c.length; _b++) {\r\n                    var slot = _c[_b];\r\n                    slot._updateAlpha();\r\n                }\r\n            }\r\n            // Update bones and slots.\r\n            if (this._cacheFrameIndex < 0 || this._cacheFrameIndex !== prevCacheFrameIndex) {\r\n                var i = 0, l = 0;\r\n                for (i = 0, l = this._bones.length; i < l; ++i) {\r\n                    this._bones[i].update(this._cacheFrameIndex);\r\n                }\r\n                for (i = 0, l = this._slots.length; i < l; ++i) {\r\n                    this._slots[i].update(this._cacheFrameIndex);\r\n                }\r\n            }\r\n            // Do actions.\r\n            if (this._actions.length > 0) {\r\n                for (var _d = 0, _e = this._actions; _d < _e.length; _d++) {\r\n                    var action = _e[_d];\r\n                    var actionData = action.actionData;\r\n                    if (actionData !== null) {\r\n                        if (actionData.type === 0 /* Play */) {\r\n                            if (action.slot !== null) {\r\n                                var childArmature = action.slot.childArmature;\r\n                                if (childArmature !== null) {\r\n                                    childArmature.animation.fadeIn(actionData.name);\r\n                                }\r\n                            }\r\n                            else if (action.bone !== null) {\r\n                                for (var _f = 0, _g = this.getSlots(); _f < _g.length; _f++) {\r\n                                    var slot = _g[_f];\r\n                                    if (slot.parent === action.bone) {\r\n                                        var childArmature = slot.childArmature;\r\n                                        if (childArmature !== null) {\r\n                                            childArmature.animation.fadeIn(actionData.name);\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                this._animation.fadeIn(actionData.name);\r\n                            }\r\n                        }\r\n                    }\r\n                    action.returnToPool();\r\n                }\r\n                this._actions.length = 0;\r\n            }\r\n            this._lockUpdate = false;\r\n            this._proxy.dbUpdate();\r\n        };\r\n        /**\r\n         * - Forces a specific bone or its owning slot to update the transform or display property in the next frame.\r\n         * @param boneName - The bone name. (If not set, all bones will be update)\r\n         * @param updateSlot - Whether to update the bone\'s slots. (Default: false)\r\n         * @see dragonBones.Bone#invalidUpdate()\r\n         * @see dragonBones.Slot#invalidUpdate()\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 强制特定骨骼或其拥有的插槽在下一帧更新变换或显示属性。\r\n         * @param boneName - 骨骼名称。 （如果未设置，将更新所有骨骼）\r\n         * @param updateSlot - 是否更新骨骼的插槽。 （默认: false）\r\n         * @see dragonBones.Bone#invalidUpdate()\r\n         * @see dragonBones.Slot#invalidUpdate()\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.invalidUpdate = function (boneName, updateSlot) {\r\n            if (boneName === void 0) { boneName = null; }\r\n            if (updateSlot === void 0) { updateSlot = false; }\r\n            if (boneName !== null && boneName.length > 0) {\r\n                var bone = this.getBone(boneName);\r\n                if (bone !== null) {\r\n                    bone.invalidUpdate();\r\n                    if (updateSlot) {\r\n                        for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                            var slot = _a[_i];\r\n                            if (slot.parent === bone) {\r\n                                slot.invalidUpdate();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                for (var _b = 0, _c = this._bones; _b < _c.length; _b++) {\r\n                    var bone = _c[_b];\r\n                    bone.invalidUpdate();\r\n                }\r\n                if (updateSlot) {\r\n                    for (var _d = 0, _e = this._slots; _d < _e.length; _d++) {\r\n                        var slot = _e[_d];\r\n                        slot.invalidUpdate();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Check whether a specific point is inside a custom bounding box in a slot.\r\n         * The coordinate system of the point is the inner coordinate system of the armature.\r\n         * Custom bounding boxes need to be customized in Dragonbones Pro.\r\n         * @param x - The horizontal coordinate of the point.\r\n         * @param y - The vertical coordinate of the point.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查特定点是否在某个插槽的自定义边界框内。\r\n         * 点的坐标系为骨架内坐标系。\r\n         * 自定义边界框需要在 DragonBones Pro 中自定义。\r\n         * @param x - 点的水平坐标。\r\n         * @param y - 点的垂直坐标。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.containsPoint = function (x, y) {\r\n            for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                var slot = _a[_i];\r\n                if (slot.containsPoint(x, y)) {\r\n                    return slot;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * - Check whether a specific segment intersects a custom bounding box for a slot in the armature.\r\n         * The coordinate system of the segment and intersection is the inner coordinate system of the armature.\r\n         * Custom bounding boxes need to be customized in Dragonbones Pro.\r\n         * @param xA - The horizontal coordinate of the beginning of the segment.\r\n         * @param yA - The vertical coordinate of the beginning of the segment.\r\n         * @param xB - The horizontal coordinate of the end point of the segment.\r\n         * @param yB - The vertical coordinate of the end point of the segment.\r\n         * @param intersectionPointA - The first intersection at which a line segment intersects the bounding box from the beginning to the end. (If not set, the intersection point will not calculated)\r\n         * @param intersectionPointB - The first intersection at which a line segment intersects the bounding box from the end to the beginning. (If not set, the intersection point will not calculated)\r\n         * @param normalRadians - The normal radians of the tangent of the intersection boundary box. [x: Normal radian of the first intersection tangent, y: Normal radian of the second intersection tangent] (If not set, the normal will not calculated)\r\n         * @returns The slot of the first custom bounding box where the segment intersects from the start point to the end point.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查特定线段是否与骨架的某个插槽的自定义边界框相交。\r\n         * 线段和交点的坐标系均为骨架内坐标系。\r\n         * 自定义边界框需要在 DragonBones Pro 中自定义。\r\n         * @param xA - 线段起点的水平坐标。\r\n         * @param yA - 线段起点的垂直坐标。\r\n         * @param xB - 线段终点的水平坐标。\r\n         * @param yB - 线段终点的垂直坐标。\r\n         * @param intersectionPointA - 线段从起点到终点与边界框相交的第一个交点。 （如果未设置，则不计算交点）\r\n         * @param intersectionPointB - 线段从终点到起点与边界框相交的第一个交点。 （如果未设置，则不计算交点）\r\n         * @param normalRadians - 交点边界框切线的法线弧度。 [x: 第一个交点切线的法线弧度, y: 第二个交点切线的法线弧度] （如果未设置，则不计算法线）\r\n         * @returns 线段从起点到终点相交的第一个自定义边界框的插槽。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.intersectsSegment = function (xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            var isV = xA === xB;\r\n            var dMin = 0.0;\r\n            var dMax = 0.0;\r\n            var intXA = 0.0;\r\n            var intYA = 0.0;\r\n            var intXB = 0.0;\r\n            var intYB = 0.0;\r\n            var intAN = 0.0;\r\n            var intBN = 0.0;\r\n            var intSlotA = null;\r\n            var intSlotB = null;\r\n            for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                var slot = _a[_i];\r\n                var intersectionCount = slot.intersectsSegment(xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians);\r\n                if (intersectionCount > 0) {\r\n                    if (intersectionPointA !== null || intersectionPointB !== null) {\r\n                        if (intersectionPointA !== null) {\r\n                            var d = isV ? intersectionPointA.y - yA : intersectionPointA.x - xA;\r\n                            if (d < 0.0) {\r\n                                d = -d;\r\n                            }\r\n                            if (intSlotA === null || d < dMin) {\r\n                                dMin = d;\r\n                                intXA = intersectionPointA.x;\r\n                                intYA = intersectionPointA.y;\r\n                                intSlotA = slot;\r\n                                if (normalRadians) {\r\n                                    intAN = normalRadians.x;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (intersectionPointB !== null) {\r\n                            var d = intersectionPointB.x - xA;\r\n                            if (d < 0.0) {\r\n                                d = -d;\r\n                            }\r\n                            if (intSlotB === null || d > dMax) {\r\n                                dMax = d;\r\n                                intXB = intersectionPointB.x;\r\n                                intYB = intersectionPointB.y;\r\n                                intSlotB = slot;\r\n                                if (normalRadians !== null) {\r\n                                    intBN = normalRadians.y;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        intSlotA = slot;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (intSlotA !== null && intersectionPointA !== null) {\r\n                intersectionPointA.x = intXA;\r\n                intersectionPointA.y = intYA;\r\n                if (normalRadians !== null) {\r\n                    normalRadians.x = intAN;\r\n                }\r\n            }\r\n            if (intSlotB !== null && intersectionPointB !== null) {\r\n                intersectionPointB.x = intXB;\r\n                intersectionPointB.y = intYB;\r\n                if (normalRadians !== null) {\r\n                    normalRadians.y = intBN;\r\n                }\r\n            }\r\n            return intSlotA;\r\n        };\r\n        /**\r\n         * - Get a specific bone.\r\n         * @param name - The bone name.\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的骨骼。\r\n         * @param name - 骨骼名称。\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getBone = function (name) {\r\n            for (var _i = 0, _a = this._bones; _i < _a.length; _i++) {\r\n                var bone = _a[_i];\r\n                if (bone.name === name) {\r\n                    return bone;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * - Get a specific bone by the display.\r\n         * @param display - The display object.\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 通过显示对象获取特定的骨骼。\r\n         * @param display - 显示对象。\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getBoneByDisplay = function (display) {\r\n            var slot = this.getSlotByDisplay(display);\r\n            return slot !== null ? slot.parent : null;\r\n        };\r\n        /**\r\n         * - Get a specific slot.\r\n         * @param name - The slot name.\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的插槽。\r\n         * @param name - 插槽名称。\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getSlot = function (name) {\r\n            for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                var slot = _a[_i];\r\n                if (slot.name === name) {\r\n                    return slot;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * - Get a specific slot by the display.\r\n         * @param display - The display object.\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 通过显示对象获取特定的插槽。\r\n         * @param display - 显示对象。\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getSlotByDisplay = function (display) {\r\n            if (display !== null) {\r\n                for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                    var slot = _a[_i];\r\n                    if (slot.display === display) {\r\n                        return slot;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * - Get all bones.\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取所有的骨骼。\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getBones = function () {\r\n            return this._bones;\r\n        };\r\n        /**\r\n         * - Get all slots.\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取所有的插槽。\r\n         * @see dragonBones.Slot\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getSlots = function () {\r\n            return this._slots;\r\n        };\r\n        Object.defineProperty(Armature.prototype, "flipX", {\r\n            /**\r\n             * - Whether to flip the armature horizontally.\r\n             * @version DragonBones 5.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否将骨架水平翻转。\r\n             * @version DragonBones 5.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._flipX;\r\n            },\r\n            set: function (value) {\r\n                if (this._flipX === value) {\r\n                    return;\r\n                }\r\n                this._flipX = value;\r\n                this.invalidUpdate();\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "flipY", {\r\n            /**\r\n             * - Whether to flip the armature vertically.\r\n             * @version DragonBones 5.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否将骨架垂直翻转。\r\n             * @version DragonBones 5.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._flipY;\r\n            },\r\n            set: function (value) {\r\n                if (this._flipY === value) {\r\n                    return;\r\n                }\r\n                this._flipY = value;\r\n                this.invalidUpdate();\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "cacheFrameRate", {\r\n            /**\r\n             * - The animation cache frame rate, which turns on the animation cache when the set value is greater than 0.\r\n             * There is a certain amount of memory overhead to improve performance by caching animation data in memory.\r\n             * The frame rate should not be set too high, usually with the frame rate of the animation is similar and lower than the program running frame rate.\r\n             * When the animation cache is turned on, some features will fail, such as the offset property of bone.\r\n             * @example\r\n             * <pre>\r\n             *     armature.cacheFrameRate = 24;\r\n             * </pre>\r\n             * @see dragonBones.DragonBonesData#frameRate\r\n             * @see dragonBones.ArmatureData#frameRate\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 动画缓存帧率，当设置的值大于 0 的时，将会开启动画缓存。\r\n             * 通过将动画数据缓存在内存中来提高运行性能，会有一定的内存开销。\r\n             * 帧率不宜设置的过高，通常跟动画的帧率相当且低于程序运行的帧率。\r\n             * 开启动画缓存后，某些功能将会失效，比如骨骼的 offset 属性等。\r\n             * @example\r\n             * <pre>\r\n             *     armature.cacheFrameRate = 24;\r\n             * </pre>\r\n             * @see dragonBones.DragonBonesData#frameRate\r\n             * @see dragonBones.ArmatureData#frameRate\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._armatureData.cacheFrameRate;\r\n            },\r\n            set: function (value) {\r\n                if (this._armatureData.cacheFrameRate !== value) {\r\n                    this._armatureData.cacheFrames(value);\r\n                    // Set child armature frameRate.\r\n                    for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                        var slot = _a[_i];\r\n                        var childArmature = slot.childArmature;\r\n                        if (childArmature !== null) {\r\n                            childArmature.cacheFrameRate = value;\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "name", {\r\n            /**\r\n             * - The armature name.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 骨架名称。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._armatureData.name;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "armatureData", {\r\n            /**\r\n             * - The armature data.\r\n             * @see dragonBones.ArmatureData\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 骨架数据。\r\n             * @see dragonBones.ArmatureData\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._armatureData;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "animation", {\r\n            /**\r\n             * - The animation player.\r\n             * @see dragonBones.Animation\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 动画播放器。\r\n             * @see dragonBones.Animation\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._animation;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "proxy", {\r\n            /**\r\n             * @pivate\r\n             */\r\n            get: function () {\r\n                return this._proxy;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "eventDispatcher", {\r\n            /**\r\n             * - The EventDispatcher instance of the armature.\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 该骨架的 EventDispatcher 实例。\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._proxy;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "display", {\r\n            /**\r\n             * - The display container.\r\n             * The display of the slot is displayed as the parent.\r\n             * Depending on the rendering engine, the type will be different, usually the DisplayObjectContainer type.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 显示容器实例。\r\n             * 插槽的显示对象都会以此显示容器为父级。\r\n             * 根据渲染引擎的不同，类型会不同，通常是 DisplayObjectContainer 类型。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._display;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "replacedTexture", {\r\n            /**\r\n             * @private\r\n             */\r\n            get: function () {\r\n                return this._replacedTexture;\r\n            },\r\n            set: function (value) {\r\n                if (this._replacedTexture === value) {\r\n                    return;\r\n                }\r\n                if (this._replaceTextureAtlasData !== null) {\r\n                    this._replaceTextureAtlasData.returnToPool();\r\n                    this._replaceTextureAtlasData = null;\r\n                }\r\n                this._replacedTexture = value;\r\n                for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                    var slot = _a[_i];\r\n                    slot.invalidUpdate();\r\n                    slot.update(-1);\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "clock", {\r\n            /**\r\n             * @inheritDoc\r\n             */\r\n            get: function () {\r\n                return this._clock;\r\n            },\r\n            set: function (value) {\r\n                if (this._clock === value) {\r\n                    return;\r\n                }\r\n                if (this._clock !== null) {\r\n                    this._clock.remove(this);\r\n                }\r\n                this._clock = value;\r\n                if (this._clock) {\r\n                    this._clock.add(this);\r\n                }\r\n                // Update childArmature clock.\r\n                for (var _i = 0, _a = this._slots; _i < _a.length; _i++) {\r\n                    var slot = _a[_i];\r\n                    var childArmature = slot.childArmature;\r\n                    if (childArmature !== null) {\r\n                        childArmature.clock = this._clock;\r\n                    }\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Armature.prototype, "parent", {\r\n            /**\r\n             * - Get the parent slot which the armature belongs to.\r\n             * @see dragonBones.Slot\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 该骨架所属的父插槽。\r\n             * @see dragonBones.Slot\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._parent;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        /**\r\n         * - Deprecated, please refer to {@link #display}.\r\n         * @deprecated\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 已废弃，请参考 {@link #display}。\r\n         * @deprecated\r\n         * @language zh_CN\r\n         */\r\n        Armature.prototype.getDisplay = function () {\r\n            return this._display;\r\n        };\r\n        return Armature;\r\n    }(dragonBones_1.BaseObject));\r\n    dragonBones_1.Armature = Armature;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The base class of the transform object.\r\n     * @see dragonBones.Transform\r\n     * @version DragonBones 4.5\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 变换对象的基类。\r\n     * @see dragonBones.Transform\r\n     * @version DragonBones 4.5\r\n     * @language zh_CN\r\n     */\r\n    var TransformObject = /** @class */ (function (_super) {\r\n        __extends(TransformObject, _super);\r\n        function TransformObject() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * - A matrix relative to the armature coordinate system.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 相对于骨架坐标系的矩阵。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            _this.globalTransformMatrix = new dragonBones.Matrix();\r\n            /**\r\n             * - A transform relative to the armature coordinate system.\r\n             * @see #updateGlobalTransform()\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 相对于骨架坐标系的变换。\r\n             * @see #updateGlobalTransform()\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            _this.global = new dragonBones.Transform();\r\n            /**\r\n             * - The offset transform relative to the armature or the parent bone coordinate system.\r\n             * @see #dragonBones.Bone#invalidUpdate()\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 相对于骨架或父骨骼坐标系的偏移变换。\r\n             * @see #dragonBones.Bone#invalidUpdate()\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            _this.offset = new dragonBones.Transform();\r\n            return _this;\r\n        }\r\n        /**\r\n         */\r\n        TransformObject.prototype._onClear = function () {\r\n            this.globalTransformMatrix.identity();\r\n            this.global.identity();\r\n            this.offset.identity();\r\n            this.origin = null;\r\n            this.userData = null;\r\n            this._globalDirty = false;\r\n            this._alpha = 1.0;\r\n            this._globalAlpha = 1.0;\r\n            this._armature = null; //\r\n        };\r\n        /**\r\n         * - For performance considerations, rotation or scale in the {@link #global} attribute of the bone or slot is not always properly accessible,\r\n         * some engines do not rely on these attributes to update rendering, such as Egret.\r\n         * The use of this method ensures that the access to the {@link #global} property is correctly rotation or scale.\r\n         * @example\r\n         * <pre>\r\n         *     bone.updateGlobalTransform();\r\n         *     let rotation = bone.global.rotation;\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 出于性能的考虑，骨骼或插槽的 {@link #global} 属性中的旋转或缩放并不总是正确可访问的，有些引擎并不依赖这些属性更新渲染，比如 Egret。\r\n         * 使用此方法可以保证访问到 {@link #global} 属性中正确的旋转或缩放。\r\n         * @example\r\n         * <pre>\r\n         *     bone.updateGlobalTransform();\r\n         *     let rotation = bone.global.rotation;\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        TransformObject.prototype.updateGlobalTransform = function () {\r\n            if (this._globalDirty) {\r\n                this._globalDirty = false;\r\n                this.global.fromMatrix(this.globalTransformMatrix);\r\n            }\r\n        };\r\n        Object.defineProperty(TransformObject.prototype, "armature", {\r\n            /**\r\n             * - The armature to which it belongs.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所属的骨架。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._armature;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        TransformObject._helpMatrix = new dragonBones.Matrix();\r\n        TransformObject._helpTransform = new dragonBones.Transform();\r\n        TransformObject._helpPoint = new dragonBones.Point();\r\n        return TransformObject;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.TransformObject = TransformObject;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - Bone is one of the most important logical units in the armature animation system,\r\n     * and is responsible for the realization of translate, rotation, scaling in the animations.\r\n     * A armature can contain multiple bones.\r\n     * @see dragonBones.BoneData\r\n     * @see dragonBones.Armature\r\n     * @see dragonBones.Slot\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 骨骼在骨骼动画体系中是最重要的逻辑单元之一，负责动画中的平移、旋转、缩放的实现。\r\n     * 一个骨架中可以包含多个骨骼。\r\n     * @see dragonBones.BoneData\r\n     * @see dragonBones.Armature\r\n     * @see dragonBones.Slot\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Bone = /** @class */ (function (_super) {\r\n        __extends(Bone, _super);\r\n        function Bone() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            /**\r\n             * @internal\r\n             */\r\n            _this.animationPose = new dragonBones.Transform();\r\n            return _this;\r\n        }\r\n        Bone.toString = function () {\r\n            return "[class dragonBones.Bone]";\r\n        };\r\n        Bone.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.offsetMode = 1 /* Additive */;\r\n            this.animationPose.identity();\r\n            this._transformDirty = false;\r\n            this._childrenTransformDirty = false;\r\n            this._localDirty = true;\r\n            this._hasConstraint = false;\r\n            this._visible = true;\r\n            this._cachedFrameIndex = -1;\r\n            this._boneData = null; //\r\n            this._parent = null; //\r\n            this._cachedFrameIndices = null;\r\n        };\r\n        Bone.prototype._updateGlobalTransformMatrix = function (isCache) {\r\n            // For typescript.\r\n            var boneData = this._boneData;\r\n            var global = this.global;\r\n            var globalTransformMatrix = this.globalTransformMatrix;\r\n            var origin = this.origin;\r\n            var offset = this.offset;\r\n            var animationPose = this.animationPose;\r\n            var parent = this._parent; //\r\n            var flipX = this._armature.flipX;\r\n            var flipY = this._armature.flipY === dragonBones.DragonBones.yDown;\r\n            var inherit = parent !== null;\r\n            var rotation = 0.0;\r\n            if (this.offsetMode === 1 /* Additive */) {\r\n                if (origin !== null) {\r\n                    // global.copyFrom(this.origin).add(this.offset).add(this.animationPose);\r\n                    global.x = origin.x + offset.x + animationPose.x;\r\n                    global.scaleX = origin.scaleX * offset.scaleX * animationPose.scaleX;\r\n                    global.scaleY = origin.scaleY * offset.scaleY * animationPose.scaleY;\r\n                    if (dragonBones.DragonBones.yDown) {\r\n                        global.y = origin.y + offset.y + animationPose.y;\r\n                        global.skew = origin.skew + offset.skew + animationPose.skew;\r\n                        global.rotation = origin.rotation + offset.rotation + animationPose.rotation;\r\n                    }\r\n                    else {\r\n                        global.y = origin.y - offset.y + animationPose.y;\r\n                        global.skew = origin.skew - offset.skew + animationPose.skew;\r\n                        global.rotation = origin.rotation - offset.rotation + animationPose.rotation;\r\n                    }\r\n                }\r\n                else {\r\n                    global.copyFrom(offset);\r\n                    if (!dragonBones.DragonBones.yDown) {\r\n                        global.y = -global.y;\r\n                        global.skew = -global.skew;\r\n                        global.rotation = -global.rotation;\r\n                    }\r\n                    global.add(animationPose);\r\n                }\r\n            }\r\n            else if (this.offsetMode === 0 /* None */) {\r\n                if (origin !== null) {\r\n                    global.copyFrom(origin).add(animationPose);\r\n                }\r\n                else {\r\n                    global.copyFrom(animationPose);\r\n                }\r\n            }\r\n            else {\r\n                inherit = false;\r\n                global.copyFrom(offset);\r\n                if (!dragonBones.DragonBones.yDown) {\r\n                    global.y = -global.y;\r\n                    global.skew = -global.skew;\r\n                    global.rotation = -global.rotation;\r\n                }\r\n            }\r\n            if (inherit) {\r\n                var isSurface = parent._boneData.type === 1 /* Surface */;\r\n                var surfaceBone = isSurface ? parent._bone : null;\r\n                var parentMatrix = isSurface ? parent._getGlobalTransformMatrix(global.x, global.y) : parent.globalTransformMatrix;\r\n                if (boneData.inheritScale && (!isSurface || surfaceBone !== null)) {\r\n                    if (isSurface) {\r\n                        if (boneData.inheritRotation) {\r\n                            global.rotation += parent.global.rotation;\r\n                        }\r\n                        surfaceBone.updateGlobalTransform();\r\n                        global.scaleX *= surfaceBone.global.scaleX;\r\n                        global.scaleY *= surfaceBone.global.scaleY;\r\n                        parentMatrix.transformPoint(global.x, global.y, global);\r\n                        global.toMatrix(globalTransformMatrix);\r\n                        if (boneData.inheritTranslation) {\r\n                            global.x = globalTransformMatrix.tx;\r\n                            global.y = globalTransformMatrix.ty;\r\n                        }\r\n                        else {\r\n                            globalTransformMatrix.tx = global.x;\r\n                            globalTransformMatrix.ty = global.y;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (!boneData.inheritRotation) {\r\n                            parent.updateGlobalTransform();\r\n                            if (flipX && flipY) {\r\n                                rotation = global.rotation - (parent.global.rotation + Math.PI);\r\n                            }\r\n                            else if (flipX) {\r\n                                rotation = global.rotation + parent.global.rotation + Math.PI;\r\n                            }\r\n                            else if (flipY) {\r\n                                rotation = global.rotation + parent.global.rotation;\r\n                            }\r\n                            else {\r\n                                rotation = global.rotation - parent.global.rotation;\r\n                            }\r\n                            global.rotation = rotation;\r\n                        }\r\n                        global.toMatrix(globalTransformMatrix);\r\n                        globalTransformMatrix.concat(parentMatrix);\r\n                        if (boneData.inheritTranslation) {\r\n                            global.x = globalTransformMatrix.tx;\r\n                            global.y = globalTransformMatrix.ty;\r\n                        }\r\n                        else {\r\n                            globalTransformMatrix.tx = global.x;\r\n                            globalTransformMatrix.ty = global.y;\r\n                        }\r\n                        if (isCache) {\r\n                            global.fromMatrix(globalTransformMatrix);\r\n                        }\r\n                        else {\r\n                            this._globalDirty = true;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if (boneData.inheritTranslation) {\r\n                        var x = global.x;\r\n                        var y = global.y;\r\n                        global.x = parentMatrix.a * x + parentMatrix.c * y + parentMatrix.tx;\r\n                        global.y = parentMatrix.b * x + parentMatrix.d * y + parentMatrix.ty;\r\n                    }\r\n                    else {\r\n                        if (flipX) {\r\n                            global.x = -global.x;\r\n                        }\r\n                        if (flipY) {\r\n                            global.y = -global.y;\r\n                        }\r\n                    }\r\n                    if (boneData.inheritRotation) {\r\n                        parent.updateGlobalTransform();\r\n                        if (parent.global.scaleX < 0.0) {\r\n                            rotation = global.rotation + parent.global.rotation + Math.PI;\r\n                        }\r\n                        else {\r\n                            rotation = global.rotation + parent.global.rotation;\r\n                        }\r\n                        if (parentMatrix.a * parentMatrix.d - parentMatrix.b * parentMatrix.c < 0.0) {\r\n                            rotation -= global.rotation * 2.0;\r\n                            if (flipX !== flipY || boneData.inheritReflection) {\r\n                                global.skew += Math.PI;\r\n                            }\r\n                            if (!dragonBones.DragonBones.yDown) {\r\n                                global.skew = -global.skew;\r\n                            }\r\n                        }\r\n                        global.rotation = rotation;\r\n                    }\r\n                    else if (flipX || flipY) {\r\n                        if (flipX && flipY) {\r\n                            rotation = global.rotation + Math.PI;\r\n                        }\r\n                        else {\r\n                            if (flipX) {\r\n                                rotation = Math.PI - global.rotation;\r\n                            }\r\n                            else {\r\n                                rotation = -global.rotation;\r\n                            }\r\n                            global.skew += Math.PI;\r\n                        }\r\n                        global.rotation = rotation;\r\n                    }\r\n                    global.toMatrix(globalTransformMatrix);\r\n                }\r\n            }\r\n            else {\r\n                if (flipX || flipY) {\r\n                    if (flipX) {\r\n                        global.x = -global.x;\r\n                    }\r\n                    if (flipY) {\r\n                        global.y = -global.y;\r\n                    }\r\n                    if (flipX && flipY) {\r\n                        rotation = global.rotation + Math.PI;\r\n                    }\r\n                    else {\r\n                        if (flipX) {\r\n                            rotation = Math.PI - global.rotation;\r\n                        }\r\n                        else {\r\n                            rotation = -global.rotation;\r\n                        }\r\n                        global.skew += Math.PI;\r\n                    }\r\n                    global.rotation = rotation;\r\n                }\r\n                global.toMatrix(globalTransformMatrix);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Bone.prototype._updateAlpha = function () {\r\n            if (this._parent !== null) {\r\n                this._globalAlpha = this._alpha * this._parent._globalAlpha;\r\n            }\r\n            else {\r\n                this._globalAlpha = this._alpha * this._armature._globalAlpha;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Bone.prototype.init = function (boneData, armatureValue) {\r\n            if (this._boneData !== null) {\r\n                return;\r\n            }\r\n            this._boneData = boneData;\r\n            this._armature = armatureValue;\r\n            this._alpha = this._boneData.alpha;\r\n            if (this._boneData.parent !== null) {\r\n                this._parent = this._armature.getBone(this._boneData.parent.name);\r\n            }\r\n            this._armature._addBone(this);\r\n            //\r\n            this.origin = this._boneData.transform;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Bone.prototype.update = function (cacheFrameIndex) {\r\n            if (cacheFrameIndex >= 0 && this._cachedFrameIndices !== null) {\r\n                var cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex];\r\n                if (cachedFrameIndex >= 0 && this._cachedFrameIndex === cachedFrameIndex) { // Same cache.\r\n                    this._transformDirty = false;\r\n                }\r\n                else if (cachedFrameIndex >= 0) { // Has been Cached.\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = cachedFrameIndex;\r\n                }\r\n                else {\r\n                    if (this._hasConstraint) { // Update constraints.\r\n                        for (var _i = 0, _a = this._armature._constraints; _i < _a.length; _i++) {\r\n                            var constraint = _a[_i];\r\n                            if (constraint._root === this) {\r\n                                constraint.update();\r\n                            }\r\n                        }\r\n                    }\r\n                    if (this._transformDirty ||\r\n                        (this._parent !== null && this._parent._childrenTransformDirty)) { // Dirty.\r\n                        this._transformDirty = true;\r\n                        this._cachedFrameIndex = -1;\r\n                    }\r\n                    else if (this._cachedFrameIndex >= 0) { // Same cache, but not set index yet.\r\n                        this._transformDirty = false;\r\n                        this._cachedFrameIndices[cacheFrameIndex] = this._cachedFrameIndex;\r\n                    }\r\n                    else { // Dirty.\r\n                        this._transformDirty = true;\r\n                        this._cachedFrameIndex = -1;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (this._hasConstraint) { // Update constraints.\r\n                    for (var _b = 0, _c = this._armature._constraints; _b < _c.length; _b++) {\r\n                        var constraint = _c[_b];\r\n                        if (constraint._root === this) {\r\n                            constraint.update();\r\n                        }\r\n                    }\r\n                }\r\n                if (this._transformDirty || (this._parent !== null && this._parent._childrenTransformDirty)) { // Dirty.\r\n                    cacheFrameIndex = -1;\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = -1;\r\n                }\r\n            }\r\n            if (this._transformDirty) {\r\n                this._transformDirty = false;\r\n                this._childrenTransformDirty = true;\r\n                //\r\n                if (this._cachedFrameIndex < 0) {\r\n                    var isCache = cacheFrameIndex >= 0;\r\n                    if (this._localDirty) {\r\n                        this._updateGlobalTransformMatrix(isCache);\r\n                    }\r\n                    if (isCache && this._cachedFrameIndices !== null) {\r\n                        this._cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex] = this._armature._armatureData.setCacheFrame(this.globalTransformMatrix, this.global);\r\n                    }\r\n                }\r\n                else {\r\n                    this._armature._armatureData.getCacheFrame(this.globalTransformMatrix, this.global, this._cachedFrameIndex);\r\n                }\r\n                //\r\n            }\r\n            else if (this._childrenTransformDirty) {\r\n                this._childrenTransformDirty = false;\r\n            }\r\n            this._localDirty = true;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Bone.prototype.updateByConstraint = function () {\r\n            if (this._localDirty) {\r\n                this._localDirty = false;\r\n                if (this._transformDirty || (this._parent !== null && this._parent._childrenTransformDirty)) {\r\n                    this._updateGlobalTransformMatrix(true);\r\n                }\r\n                this._transformDirty = true;\r\n            }\r\n        };\r\n        /**\r\n         * - Forces the bone to update the transform in the next frame.\r\n         * When the bone is not animated or its animation state is finished, the bone will not continue to update,\r\n         * and when the skeleton must be updated for some reason, the method needs to be called explicitly.\r\n         * @example\r\n         * <pre>\r\n         *     let bone = armature.getBone("arm");\r\n         *     bone.offset.scaleX = 2.0;\r\n         *     bone.invalidUpdate();\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 强制骨骼在下一帧更新变换。\r\n         * 当该骨骼没有动画状态或其动画状态播放完成时，骨骼将不在继续更新，而此时由于某些原因必须更新骨骼时，则需要显式调用该方法。\r\n         * @example\r\n         * <pre>\r\n         *     let bone = armature.getBone("arm");\r\n         *     bone.offset.scaleX = 2.0;\r\n         *     bone.invalidUpdate();\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Bone.prototype.invalidUpdate = function () {\r\n            this._transformDirty = true;\r\n        };\r\n        /**\r\n         * - Check whether the bone contains a specific bone.\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查该骨骼是否包含特定的骨骼。\r\n         * @see dragonBones.Bone\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Bone.prototype.contains = function (value) {\r\n            if (value === this) {\r\n                return false;\r\n            }\r\n            var ancestor = value;\r\n            while (ancestor !== this && ancestor !== null) {\r\n                ancestor = ancestor.parent;\r\n            }\r\n            return ancestor === this;\r\n        };\r\n        Object.defineProperty(Bone.prototype, "boneData", {\r\n            /**\r\n             * - The bone data.\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 骨骼数据。\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._boneData;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Bone.prototype, "visible", {\r\n            /**\r\n             * - The visible of all slots in the bone.\r\n             * @default true\r\n             * @see dragonBones.Slot#visible\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 此骨骼所有插槽的可见。\r\n             * @default true\r\n             * @see dragonBones.Slot#visible\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._visible;\r\n            },\r\n            set: function (value) {\r\n                if (this._visible === value) {\r\n                    return;\r\n                }\r\n                this._visible = value;\r\n                for (var _i = 0, _a = this._armature.getSlots(); _i < _a.length; _i++) {\r\n                    var slot = _a[_i];\r\n                    if (slot.parent === this) {\r\n                        slot._updateVisible();\r\n                    }\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Bone.prototype, "name", {\r\n            /**\r\n             * - The bone name.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 骨骼名称。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._boneData.name;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Bone.prototype, "parent", {\r\n            /**\r\n             * - The parent bone to which it belongs.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所属的父骨骼。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._parent;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return Bone;\r\n    }(dragonBones.TransformObject));\r\n    dragonBones.Bone = Bone;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @internal\r\n     */\r\n    var Surface = /** @class */ (function (_super) {\r\n        __extends(Surface, _super);\r\n        function Surface() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._vertices = [];\r\n            _this._deformVertices = [];\r\n            /**\r\n             * - x1, y1, x2, y2, x3, y3, x4, y4, d1X, d1Y, d2X, d2Y\r\n             */\r\n            _this._hullCache = [];\r\n            /**\r\n             * - Inside [flag, a, b, c, d, tx, ty], Outside [flag, a, b, c, d, tx, ty]\r\n             */\r\n            _this._matrixCahce = [];\r\n            return _this;\r\n        }\r\n        Surface.toString = function () {\r\n            return "[class dragonBones.Surface]";\r\n        };\r\n        Surface.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._dX = 0.0;\r\n            this._dY = 0.0;\r\n            this._k = 0.0;\r\n            this._kX = 0.0;\r\n            this._kY = 0.0;\r\n            this._vertices.length = 0;\r\n            this._deformVertices.length = 0;\r\n            this._matrixCahce.length = 0;\r\n            this._hullCache.length = 0;\r\n            this._bone = null;\r\n        };\r\n        Surface.prototype._getAffineTransform = function (x, y, lX, lY, aX, aY, bX, bY, cX, cY, transform, matrix, isDown) {\r\n            var dabX = bX - aX;\r\n            var dabY = bY - aY;\r\n            var dacX = cX - aX;\r\n            var dacY = cY - aY;\r\n            transform.rotation = Math.atan2(dabY, dabX);\r\n            transform.skew = Math.atan2(dacY, dacX) - Math.PI * 0.5 - transform.rotation;\r\n            if (isDown) {\r\n                transform.rotation += Math.PI;\r\n            }\r\n            transform.scaleX = Math.sqrt(dabX * dabX + dabY * dabY) / lX;\r\n            transform.scaleY = Math.sqrt(dacX * dacX + dacY * dacY) / lY;\r\n            transform.toMatrix(matrix);\r\n            transform.x = matrix.tx = aX - (matrix.a * x + matrix.c * y);\r\n            transform.y = matrix.ty = aY - (matrix.b * x + matrix.d * y);\r\n        };\r\n        Surface.prototype._updateVertices = function () {\r\n            var data = this._armature.armatureData.parent;\r\n            var geometry = this._boneData.geometry;\r\n            var intArray = data.intArray;\r\n            var floatArray = data.floatArray;\r\n            var vertexCount = intArray[geometry.offset + 0 /* GeometryVertexCount */];\r\n            var verticesOffset = intArray[geometry.offset + 2 /* GeometryFloatOffset */];\r\n            var vertices = this._vertices;\r\n            var animationVertices = this._deformVertices;\r\n            if (this._parent !== null) {\r\n                if (this._parent._boneData.type === 1 /* Surface */) {\r\n                    for (var i = 0, l = vertexCount; i < l; ++i) {\r\n                        var iD = i * 2;\r\n                        var x = floatArray[verticesOffset + iD] + animationVertices[iD];\r\n                        var y = floatArray[verticesOffset + iD + 1] + animationVertices[iD + 1];\r\n                        var matrix = this._parent._getGlobalTransformMatrix(x, y);\r\n                        //\r\n                        vertices[iD] = matrix.a * x + matrix.c * y + matrix.tx;\r\n                        vertices[iD + 1] = matrix.b * x + matrix.d * y + matrix.ty;\r\n                    }\r\n                }\r\n                else {\r\n                    var parentMatrix = this._parent.globalTransformMatrix;\r\n                    for (var i = 0, l = vertexCount; i < l; ++i) {\r\n                        var iD = i * 2;\r\n                        var x = floatArray[verticesOffset + iD] + animationVertices[iD];\r\n                        var y = floatArray[verticesOffset + iD + 1] + animationVertices[iD + 1];\r\n                        //\r\n                        vertices[iD] = parentMatrix.a * x + parentMatrix.c * y + parentMatrix.tx;\r\n                        vertices[iD + 1] = parentMatrix.b * x + parentMatrix.d * y + parentMatrix.ty;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                for (var i = 0, l = vertexCount; i < l; ++i) {\r\n                    var iD = i * 2;\r\n                    vertices[iD] = floatArray[verticesOffset + iD] + animationVertices[iD];\r\n                    vertices[iD + 1] = floatArray[verticesOffset + iD + 1] + animationVertices[iD + 1];\r\n                }\r\n            }\r\n        };\r\n        Surface.prototype._updateGlobalTransformMatrix = function (isCache) {\r\n            // tslint:disable-next-line:no-unused-expression\r\n            isCache;\r\n            var segmentXD = this._boneData.segmentX * 2;\r\n            var lastIndex = this._vertices.length - 2;\r\n            var lA = 200.0;\r\n            //\r\n            var raX = this._vertices[0];\r\n            var raY = this._vertices[1];\r\n            var rbX = this._vertices[segmentXD];\r\n            var rbY = this._vertices[segmentXD + 1];\r\n            var rcX = this._vertices[lastIndex];\r\n            var rcY = this._vertices[lastIndex + 1];\r\n            var rdX = this._vertices[lastIndex - segmentXD];\r\n            var rdY = this._vertices[lastIndex - segmentXD + 1];\r\n            //\r\n            var dacX = raX + (rcX - raX) * 0.5;\r\n            var dacY = raY + (rcY - raY) * 0.5;\r\n            var dbdX = rbX + (rdX - rbX) * 0.5;\r\n            var dbdY = rbY + (rdY - rbY) * 0.5;\r\n            var aX = dacX + (dbdX - dacX) * 0.5;\r\n            var aY = dacY + (dbdY - dacY) * 0.5;\r\n            var bX = rbX + (rcX - rbX) * 0.5;\r\n            var bY = rbY + (rcY - rbY) * 0.5;\r\n            var cX = rdX + (rcX - rdX) * 0.5;\r\n            var cY = rdY + (rcY - rdY) * 0.5;\r\n            // TODO interpolation\r\n            this._getAffineTransform(0.0, 0.0, lA, lA, aX, aY, bX, bY, cX, cY, this.global, this.globalTransformMatrix, false);\r\n            this._globalDirty = false;\r\n        };\r\n        Surface.prototype._getGlobalTransformMatrix = function (x, y) {\r\n            var lA = 200.0;\r\n            var lB = 1000.0;\r\n            if (x < -lB || lB < x || y < -lB || lB < y) {\r\n                return this.globalTransformMatrix;\r\n            }\r\n            var isDown = false;\r\n            var surfaceData = this._boneData;\r\n            var segmentX = surfaceData.segmentX;\r\n            var segmentY = surfaceData.segmentY;\r\n            var segmentXD = surfaceData.segmentX * 2;\r\n            var dX = this._dX;\r\n            var dY = this._dY;\r\n            var indexX = Math.floor((x + lA) / dX); // -1 ~ segmentX - 1\r\n            var indexY = Math.floor((y + lA) / dY); // -1 ~ segmentY - 1\r\n            var matrixIndex = 0;\r\n            var pX = indexX * dX - lA;\r\n            var pY = indexY * dY - lA;\r\n            //\r\n            var matrices = this._matrixCahce;\r\n            var helpMatrix = Surface._helpMatrix;\r\n            if (x < -lA) {\r\n                if (y < -lA || y >= lA) { // Out.\r\n                    return this.globalTransformMatrix;\r\n                }\r\n                // Left.\r\n                isDown = y > this._kX * (x + lA) + pY;\r\n                matrixIndex = ((segmentX * segmentY + segmentX + segmentY + segmentY + indexY) * 2 + (isDown ? 1 : 0)) * 7;\r\n                if (matrices[matrixIndex] > 0.0) {\r\n                    helpMatrix.copyFromArray(matrices, matrixIndex + 1);\r\n                }\r\n                else {\r\n                    var vertexIndex = indexY * (segmentXD + 2);\r\n                    var ddX = this._hullCache[4];\r\n                    var ddY = this._hullCache[5];\r\n                    var sX = this._hullCache[2] - (segmentY - indexY) * ddX;\r\n                    var sY = this._hullCache[3] - (segmentY - indexY) * ddY;\r\n                    var vertices = this._vertices;\r\n                    if (isDown) {\r\n                        this._getAffineTransform(-lA, pY + dY, lB - lA, dY, vertices[vertexIndex + segmentXD + 2], vertices[vertexIndex + segmentXD + 3], sX + ddX, sY + ddY, vertices[vertexIndex], vertices[vertexIndex + 1], Surface._helpTransform, helpMatrix, true);\r\n                    }\r\n                    else {\r\n                        this._getAffineTransform(-lB, pY, lB - lA, dY, sX, sY, vertices[vertexIndex], vertices[vertexIndex + 1], sX + ddX, sY + ddY, Surface._helpTransform, helpMatrix, false);\r\n                    }\r\n                    matrices[matrixIndex] = 1.0;\r\n                    matrices[matrixIndex + 1] = helpMatrix.a;\r\n                    matrices[matrixIndex + 2] = helpMatrix.b;\r\n                    matrices[matrixIndex + 3] = helpMatrix.c;\r\n                    matrices[matrixIndex + 4] = helpMatrix.d;\r\n                    matrices[matrixIndex + 5] = helpMatrix.tx;\r\n                    matrices[matrixIndex + 6] = helpMatrix.ty;\r\n                }\r\n            }\r\n            else if (x >= lA) {\r\n                if (y < -lA || y >= lA) { // Out.\r\n                    return this.globalTransformMatrix;\r\n                }\r\n                // Right.\r\n                isDown = y > this._kX * (x - lB) + pY;\r\n                matrixIndex = ((segmentX * segmentY + segmentX + indexY) * 2 + (isDown ? 1 : 0)) * 7;\r\n                if (matrices[matrixIndex] > 0.0) {\r\n                    helpMatrix.copyFromArray(matrices, matrixIndex + 1);\r\n                }\r\n                else {\r\n                    var vertexIndex = (indexY + 1) * (segmentXD + 2) - 2;\r\n                    var ddX = this._hullCache[4];\r\n                    var ddY = this._hullCache[5];\r\n                    var sX = this._hullCache[0] + indexY * ddX;\r\n                    var sY = this._hullCache[1] + indexY * ddY;\r\n                    var vertices = this._vertices;\r\n                    if (isDown) {\r\n                        this._getAffineTransform(lB, pY + dY, lB - lA, dY, sX + ddX, sY + ddY, vertices[vertexIndex + segmentXD + 2], vertices[vertexIndex + segmentXD + 3], sX, sY, Surface._helpTransform, helpMatrix, true);\r\n                    }\r\n                    else {\r\n                        this._getAffineTransform(lA, pY, lB - lA, dY, vertices[vertexIndex], vertices[vertexIndex + 1], sX, sY, vertices[vertexIndex + segmentXD + 2], vertices[vertexIndex + segmentXD + 3], Surface._helpTransform, helpMatrix, false);\r\n                    }\r\n                    matrices[matrixIndex] = 1.0;\r\n                    matrices[matrixIndex + 1] = helpMatrix.a;\r\n                    matrices[matrixIndex + 2] = helpMatrix.b;\r\n                    matrices[matrixIndex + 3] = helpMatrix.c;\r\n                    matrices[matrixIndex + 4] = helpMatrix.d;\r\n                    matrices[matrixIndex + 5] = helpMatrix.tx;\r\n                    matrices[matrixIndex + 6] = helpMatrix.ty;\r\n                }\r\n            }\r\n            else if (y < -lA) {\r\n                if (x < -lA || x >= lA) { // Out.\r\n                    return this.globalTransformMatrix;\r\n                }\r\n                // Up.\r\n                isDown = y > this._kY * (x - pX - dX) - lB;\r\n                matrixIndex = ((segmentX * segmentY + indexX) * 2 + (isDown ? 1 : 0)) * 7;\r\n                if (matrices[matrixIndex] > 0.0) {\r\n                    helpMatrix.copyFromArray(matrices, matrixIndex + 1);\r\n                }\r\n                else {\r\n                    var vertexIndex = indexX * 2;\r\n                    var ddX = this._hullCache[10];\r\n                    var ddY = this._hullCache[11];\r\n                    var sX = this._hullCache[8] + indexX * ddX;\r\n                    var sY = this._hullCache[9] + indexX * ddY;\r\n                    var vertices = this._vertices;\r\n                    if (isDown) {\r\n                        this._getAffineTransform(pX + dX, -lA, dX, lB - lA, vertices[vertexIndex + 2], vertices[vertexIndex + 3], vertices[vertexIndex], vertices[vertexIndex + 1], sX + ddX, sY + ddY, Surface._helpTransform, helpMatrix, true);\r\n                    }\r\n                    else {\r\n                        this._getAffineTransform(pX, -lB, dX, lB - lA, sX, sY, sX + ddX, sY + ddY, vertices[vertexIndex], vertices[vertexIndex + 1], Surface._helpTransform, helpMatrix, false);\r\n                    }\r\n                    matrices[matrixIndex] = 1.0;\r\n                    matrices[matrixIndex + 1] = helpMatrix.a;\r\n                    matrices[matrixIndex + 2] = helpMatrix.b;\r\n                    matrices[matrixIndex + 3] = helpMatrix.c;\r\n                    matrices[matrixIndex + 4] = helpMatrix.d;\r\n                    matrices[matrixIndex + 5] = helpMatrix.tx;\r\n                    matrices[matrixIndex + 6] = helpMatrix.ty;\r\n                }\r\n            }\r\n            else if (y >= lA) {\r\n                if (x < -lA || x >= lA) { //  Out.\r\n                    return this.globalTransformMatrix;\r\n                }\r\n                // Down\r\n                isDown = y > this._kY * (x - pX - dX) + lA;\r\n                matrixIndex = ((segmentX * segmentY + segmentX + segmentY + indexX) * 2 + (isDown ? 1 : 0)) * 7;\r\n                if (matrices[matrixIndex] > 0.0) {\r\n                    helpMatrix.copyFromArray(matrices, matrixIndex + 1);\r\n                }\r\n                else {\r\n                    var vertexIndex = segmentY * (segmentXD + 2) + indexX * 2;\r\n                    var ddX = this._hullCache[10];\r\n                    var ddY = this._hullCache[11];\r\n                    var sX = this._hullCache[6] - (segmentX - indexX) * ddX;\r\n                    var sY = this._hullCache[7] - (segmentX - indexX) * ddY;\r\n                    var vertices = this._vertices;\r\n                    if (isDown) {\r\n                        this._getAffineTransform(pX + dX, lB, dX, lB - lA, sX + ddX, sY + ddY, sX, sY, vertices[vertexIndex + 2], vertices[vertexIndex + 3], Surface._helpTransform, helpMatrix, true);\r\n                    }\r\n                    else {\r\n                        this._getAffineTransform(pX, lA, dX, lB - lA, vertices[vertexIndex], vertices[vertexIndex + 1], vertices[vertexIndex + 2], vertices[vertexIndex + 3], sX, sY, Surface._helpTransform, helpMatrix, false);\r\n                    }\r\n                    matrices[matrixIndex] = 1.0;\r\n                    matrices[matrixIndex + 1] = helpMatrix.a;\r\n                    matrices[matrixIndex + 2] = helpMatrix.b;\r\n                    matrices[matrixIndex + 3] = helpMatrix.c;\r\n                    matrices[matrixIndex + 4] = helpMatrix.d;\r\n                    matrices[matrixIndex + 5] = helpMatrix.tx;\r\n                    matrices[matrixIndex + 6] = helpMatrix.ty;\r\n                }\r\n            }\r\n            else { // Center.\r\n                isDown = y > this._k * (x - pX - dX) + pY;\r\n                matrixIndex = ((segmentX * indexY + indexX) * 2 + (isDown ? 1 : 0)) * 7;\r\n                if (matrices[matrixIndex] > 0.0) {\r\n                    helpMatrix.copyFromArray(matrices, matrixIndex + 1);\r\n                }\r\n                else {\r\n                    var vertexIndex = indexX * 2 + indexY * (segmentXD + 2);\r\n                    var vertices = this._vertices;\r\n                    if (isDown) {\r\n                        this._getAffineTransform(pX + dX, pY + dY, dX, dY, vertices[vertexIndex + segmentXD + 4], vertices[vertexIndex + segmentXD + 5], vertices[vertexIndex + segmentXD + 2], vertices[vertexIndex + segmentXD + 3], vertices[vertexIndex + 2], vertices[vertexIndex + 3], Surface._helpTransform, helpMatrix, true);\r\n                    }\r\n                    else {\r\n                        this._getAffineTransform(pX, pY, dX, dY, vertices[vertexIndex], vertices[vertexIndex + 1], vertices[vertexIndex + 2], vertices[vertexIndex + 3], vertices[vertexIndex + segmentXD + 2], vertices[vertexIndex + segmentXD + 3], Surface._helpTransform, helpMatrix, false);\r\n                    }\r\n                    matrices[matrixIndex] = 1.0;\r\n                    matrices[matrixIndex + 1] = helpMatrix.a;\r\n                    matrices[matrixIndex + 2] = helpMatrix.b;\r\n                    matrices[matrixIndex + 3] = helpMatrix.c;\r\n                    matrices[matrixIndex + 4] = helpMatrix.d;\r\n                    matrices[matrixIndex + 5] = helpMatrix.tx;\r\n                    matrices[matrixIndex + 6] = helpMatrix.ty;\r\n                }\r\n            }\r\n            return helpMatrix;\r\n        };\r\n        /**\r\n         * @internal\r\n         * @private\r\n         */\r\n        Surface.prototype.init = function (surfaceData, armatureValue) {\r\n            if (this._boneData !== null) {\r\n                return;\r\n            }\r\n            _super.prototype.init.call(this, surfaceData, armatureValue);\r\n            var segmentX = surfaceData.segmentX;\r\n            var segmentY = surfaceData.segmentY;\r\n            var vertexCount = this._armature.armatureData.parent.intArray[surfaceData.geometry.offset + 0 /* GeometryVertexCount */];\r\n            var lB = 1000.0;\r\n            var lA = 200.0;\r\n            //\r\n            this._dX = lA * 2.0 / segmentX;\r\n            this._dY = lA * 2.0 / segmentY;\r\n            this._k = -this._dY / this._dX;\r\n            this._kX = -this._dY / (lB - lA);\r\n            this._kY = -(lB - lA) / this._dX;\r\n            this._vertices.length = vertexCount * 2;\r\n            this._deformVertices.length = vertexCount * 2;\r\n            this._matrixCahce.length = (segmentX * segmentY + segmentX * 2 + segmentY * 2) * 2 * 7;\r\n            this._hullCache.length = 10;\r\n            for (var i = 0; i < vertexCount * 2; ++i) {\r\n                this._deformVertices[i] = 0.0;\r\n            }\r\n            if (this._parent !== null) {\r\n                if (this._parent.boneData.type === 0 /* Bone */) {\r\n                    this._bone = this._parent;\r\n                }\r\n                else {\r\n                    this._bone = this._parent._bone;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Surface.prototype.update = function (cacheFrameIndex) {\r\n            if (cacheFrameIndex >= 0 && this._cachedFrameIndices !== null) {\r\n                var cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex];\r\n                if (cachedFrameIndex >= 0 && this._cachedFrameIndex === cachedFrameIndex) { // Same cache.\r\n                    this._transformDirty = false;\r\n                }\r\n                else if (cachedFrameIndex >= 0) { // Has been Cached.\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = cachedFrameIndex;\r\n                }\r\n                else {\r\n                    if (this._hasConstraint) { // Update constraints.\r\n                        for (var _i = 0, _a = this._armature._constraints; _i < _a.length; _i++) {\r\n                            var constraint = _a[_i];\r\n                            if (constraint._root === this) {\r\n                                constraint.update();\r\n                            }\r\n                        }\r\n                    }\r\n                    if (this._transformDirty ||\r\n                        (this._parent !== null && this._parent._childrenTransformDirty)) { // Dirty.\r\n                        this._transformDirty = true;\r\n                        this._cachedFrameIndex = -1;\r\n                    }\r\n                    else if (this._cachedFrameIndex >= 0) { // Same cache, but not set index yet.\r\n                        this._transformDirty = false;\r\n                        this._cachedFrameIndices[cacheFrameIndex] = this._cachedFrameIndex;\r\n                    }\r\n                    else { // Dirty.\r\n                        this._transformDirty = true;\r\n                        this._cachedFrameIndex = -1;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (this._hasConstraint) { // Update constraints.\r\n                    for (var _b = 0, _c = this._armature._constraints; _b < _c.length; _b++) {\r\n                        var constraint = _c[_b];\r\n                        if (constraint._root === this) {\r\n                            constraint.update();\r\n                        }\r\n                    }\r\n                }\r\n                if (this._transformDirty || (this._parent !== null && this._parent._childrenTransformDirty)) { // Dirty.\r\n                    cacheFrameIndex = -1;\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = -1;\r\n                }\r\n            }\r\n            if (this._transformDirty) {\r\n                this._transformDirty = false;\r\n                this._childrenTransformDirty = true;\r\n                //\r\n                for (var i = 0, l = this._matrixCahce.length; i < l; i += 7) {\r\n                    this._matrixCahce[i] = -1.0;\r\n                }\r\n                //\r\n                this._updateVertices();\r\n                //\r\n                if (this._cachedFrameIndex < 0) {\r\n                    var isCache = cacheFrameIndex >= 0;\r\n                    if (this._localDirty) {\r\n                        this._updateGlobalTransformMatrix(isCache);\r\n                    }\r\n                    if (isCache && this._cachedFrameIndices !== null) {\r\n                        this._cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex] = this._armature._armatureData.setCacheFrame(this.globalTransformMatrix, this.global);\r\n                    }\r\n                }\r\n                else {\r\n                    this._armature._armatureData.getCacheFrame(this.globalTransformMatrix, this.global, this._cachedFrameIndex);\r\n                }\r\n                // Update hull vertices.\r\n                var lB = 1000.0;\r\n                var lA = 200.0;\r\n                var ddX = 2 * this.global.x;\r\n                var ddY = 2 * this.global.y;\r\n                //\r\n                var helpPoint = Surface._helpPoint;\r\n                this.globalTransformMatrix.transformPoint(lB, -lA, helpPoint);\r\n                this._hullCache[0] = helpPoint.x;\r\n                this._hullCache[1] = helpPoint.y;\r\n                this._hullCache[2] = ddX - helpPoint.x;\r\n                this._hullCache[3] = ddY - helpPoint.y;\r\n                this.globalTransformMatrix.transformPoint(0.0, this._dY, helpPoint, true);\r\n                this._hullCache[4] = helpPoint.x;\r\n                this._hullCache[5] = helpPoint.y;\r\n                //\r\n                this.globalTransformMatrix.transformPoint(lA, lB, helpPoint);\r\n                this._hullCache[6] = helpPoint.x;\r\n                this._hullCache[7] = helpPoint.y;\r\n                this._hullCache[8] = ddX - helpPoint.x;\r\n                this._hullCache[9] = ddY - helpPoint.y;\r\n                this.globalTransformMatrix.transformPoint(this._dX, 0.0, helpPoint, true);\r\n                this._hullCache[10] = helpPoint.x;\r\n                this._hullCache[11] = helpPoint.y;\r\n            }\r\n            else if (this._childrenTransformDirty) {\r\n                this._childrenTransformDirty = false;\r\n            }\r\n            this._localDirty = true;\r\n        };\r\n        return Surface;\r\n    }(dragonBones.Bone));\r\n    dragonBones.Surface = Surface;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var DisplayFrame = /** @class */ (function (_super) {\r\n        __extends(DisplayFrame, _super);\r\n        function DisplayFrame() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.deformVertices = [];\r\n            return _this;\r\n        }\r\n        DisplayFrame.toString = function () {\r\n            return "[class dragonBones.DisplayFrame]";\r\n        };\r\n        DisplayFrame.prototype._onClear = function () {\r\n            this.rawDisplayData = null;\r\n            this.displayData = null;\r\n            this.textureData = null;\r\n            this.display = null;\r\n            this.deformVertices.length = 0;\r\n        };\r\n        DisplayFrame.prototype.updateDeformVertices = function () {\r\n            if (this.rawDisplayData === null || this.deformVertices.length !== 0) {\r\n                return;\r\n            }\r\n            var rawGeometryData;\r\n            if (this.rawDisplayData.type === 2 /* Mesh */) {\r\n                rawGeometryData = this.rawDisplayData.geometry;\r\n            }\r\n            else if (this.rawDisplayData.type === 4 /* Path */) {\r\n                rawGeometryData = this.rawDisplayData.geometry;\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n            var vertexCount = 0;\r\n            if (rawGeometryData.weight !== null) {\r\n                vertexCount = rawGeometryData.weight.count * 2;\r\n            }\r\n            else {\r\n                vertexCount = rawGeometryData.data.intArray[rawGeometryData.offset + 0 /* GeometryVertexCount */] * 2;\r\n            }\r\n            this.deformVertices.length = vertexCount;\r\n            for (var i = 0, l = this.deformVertices.length; i < l; ++i) {\r\n                this.deformVertices[i] = 0.0;\r\n            }\r\n        };\r\n        DisplayFrame.prototype.getGeometryData = function () {\r\n            if (this.displayData !== null) {\r\n                if (this.displayData.type === 2 /* Mesh */) {\r\n                    return this.displayData.geometry;\r\n                }\r\n                if (this.displayData.type === 4 /* Path */) {\r\n                    return this.displayData.geometry;\r\n                }\r\n            }\r\n            if (this.rawDisplayData !== null) {\r\n                if (this.rawDisplayData.type === 2 /* Mesh */) {\r\n                    return this.rawDisplayData.geometry;\r\n                }\r\n                if (this.rawDisplayData.type === 4 /* Path */) {\r\n                    return this.rawDisplayData.geometry;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        DisplayFrame.prototype.getBoundingBox = function () {\r\n            if (this.displayData !== null && this.displayData.type === 3 /* BoundingBox */) {\r\n                return this.displayData.boundingBox;\r\n            }\r\n            if (this.rawDisplayData !== null && this.rawDisplayData.type === 3 /* BoundingBox */) {\r\n                return this.rawDisplayData.boundingBox;\r\n            }\r\n            return null;\r\n        };\r\n        DisplayFrame.prototype.getTextureData = function () {\r\n            if (this.displayData !== null) {\r\n                if (this.displayData.type === 0 /* Image */) {\r\n                    return this.displayData.texture;\r\n                }\r\n                if (this.displayData.type === 2 /* Mesh */) {\r\n                    return this.displayData.texture;\r\n                }\r\n            }\r\n            if (this.textureData !== null) {\r\n                return this.textureData;\r\n            }\r\n            if (this.rawDisplayData !== null) {\r\n                if (this.rawDisplayData.type === 0 /* Image */) {\r\n                    return this.rawDisplayData.texture;\r\n                }\r\n                if (this.rawDisplayData.type === 2 /* Mesh */) {\r\n                    return this.rawDisplayData.texture;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        return DisplayFrame;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.DisplayFrame = DisplayFrame;\r\n    /**\r\n     * - The slot attached to the armature, controls the display status and properties of the display object.\r\n     * A bone can contain multiple slots.\r\n     * A slot can contain multiple display objects, displaying only one of the display objects at a time,\r\n     * but you can toggle the display object into frame animation while the animation is playing.\r\n     * The display object can be a normal texture, or it can be a display of a child armature, a grid display object,\r\n     * and a custom other display object.\r\n     * @see dragonBones.Armature\r\n     * @see dragonBones.Bone\r\n     * @see dragonBones.SlotData\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 插槽附着在骨骼上，控制显示对象的显示状态和属性。\r\n     * 一个骨骼上可以包含多个插槽。\r\n     * 一个插槽中可以包含多个显示对象，同一时间只能显示其中的一个显示对象，但可以在动画播放的过程中切换显示对象实现帧动画。\r\n     * 显示对象可以是普通的图片纹理，也可以是子骨架的显示容器，网格显示对象，还可以是自定义的其他显示对象。\r\n     * @see dragonBones.Armature\r\n     * @see dragonBones.Bone\r\n     * @see dragonBones.SlotData\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Slot = /** @class */ (function (_super) {\r\n        __extends(Slot, _super);\r\n        function Slot() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._localMatrix = new dragonBones.Matrix();\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._colorTransform = new dragonBones.ColorTransform();\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._displayFrames = [];\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._geometryBones = [];\r\n            _this._rawDisplay = null; // Initial value.\r\n            _this._meshDisplay = null; // Initial value.\r\n            _this._display = null;\r\n            return _this;\r\n        }\r\n        Slot.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            var disposeDisplayList = [];\r\n            for (var _i = 0, _a = this._displayFrames; _i < _a.length; _i++) {\r\n                var dispayFrame = _a[_i];\r\n                var display = dispayFrame.display;\r\n                if (display !== this._rawDisplay && display !== this._meshDisplay &&\r\n                    disposeDisplayList.indexOf(display) < 0) {\r\n                    disposeDisplayList.push(display);\r\n                }\r\n                dispayFrame.returnToPool();\r\n            }\r\n            for (var _b = 0, disposeDisplayList_1 = disposeDisplayList; _b < disposeDisplayList_1.length; _b++) {\r\n                var eachDisplay = disposeDisplayList_1[_b];\r\n                if (eachDisplay instanceof dragonBones.Armature) {\r\n                    eachDisplay.dispose();\r\n                }\r\n                else {\r\n                    this._disposeDisplay(eachDisplay, true);\r\n                }\r\n            }\r\n            if (this._meshDisplay !== null && this._meshDisplay !== this._rawDisplay) { // May be _meshDisplay and _rawDisplay is the same one.\r\n                this._disposeDisplay(this._meshDisplay, false);\r\n            }\r\n            if (this._rawDisplay !== null) {\r\n                this._disposeDisplay(this._rawDisplay, false);\r\n            }\r\n            this.displayController = null;\r\n            this._displayDataDirty = false;\r\n            this._displayDirty = false;\r\n            this._geometryDirty = false;\r\n            this._textureDirty = false;\r\n            this._visibleDirty = false;\r\n            this._blendModeDirty = false;\r\n            this._zOrderDirty = false;\r\n            this._colorDirty = false;\r\n            this._verticesDirty = false;\r\n            this._transformDirty = false;\r\n            this._visible = true;\r\n            this._blendMode = 0 /* Normal */;\r\n            this._displayIndex = -1;\r\n            this._animationDisplayIndex = -1;\r\n            this._zOrder = 0;\r\n            this._zIndex = 0;\r\n            this._cachedFrameIndex = -1;\r\n            this._pivotX = 0.0;\r\n            this._pivotY = 0.0;\r\n            this._localMatrix.identity();\r\n            this._colorTransform.identity();\r\n            this._displayFrames.length = 0;\r\n            this._geometryBones.length = 0;\r\n            this._slotData = null; //\r\n            this._displayFrame = null;\r\n            this._geometryData = null;\r\n            this._boundingBoxData = null;\r\n            this._textureData = null;\r\n            this._rawDisplay = null;\r\n            this._meshDisplay = null;\r\n            this._display = null;\r\n            this._childArmature = null;\r\n            this._parent = null; //\r\n            this._cachedFrameIndices = null;\r\n        };\r\n        Slot.prototype._hasDisplay = function (display) {\r\n            for (var _i = 0, _a = this._displayFrames; _i < _a.length; _i++) {\r\n                var displayFrame = _a[_i];\r\n                if (displayFrame.display === display) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype._isBonesUpdate = function () {\r\n            for (var _i = 0, _a = this._geometryBones; _i < _a.length; _i++) {\r\n                var bone = _a[_i];\r\n                if (bone !== null && bone._childrenTransformDirty) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype._updateAlpha = function () {\r\n            var globalAlpha = this._alpha * this._parent._globalAlpha;\r\n            if (this._globalAlpha !== globalAlpha) {\r\n                this._globalAlpha = globalAlpha;\r\n                this._colorDirty = true;\r\n            }\r\n        };\r\n        Slot.prototype._updateDisplayData = function () {\r\n            var prevDisplayFrame = this._displayFrame;\r\n            var prevGeometryData = this._geometryData;\r\n            var prevTextureData = this._textureData;\r\n            var rawDisplayData = null;\r\n            var displayData = null;\r\n            this._displayFrame = null;\r\n            this._geometryData = null;\r\n            this._boundingBoxData = null;\r\n            this._textureData = null;\r\n            if (this._displayIndex >= 0 && this._displayIndex < this._displayFrames.length) {\r\n                this._displayFrame = this._displayFrames[this._displayIndex];\r\n                rawDisplayData = this._displayFrame.rawDisplayData;\r\n                displayData = this._displayFrame.displayData;\r\n                this._geometryData = this._displayFrame.getGeometryData();\r\n                this._boundingBoxData = this._displayFrame.getBoundingBox();\r\n                this._textureData = this._displayFrame.getTextureData();\r\n            }\r\n            if (this._displayFrame !== prevDisplayFrame ||\r\n                this._geometryData !== prevGeometryData || this._textureData !== prevTextureData) {\r\n                // Update pivot offset.\r\n                if (this._geometryData === null && this._textureData !== null) {\r\n                    var imageDisplayData = ((displayData !== null && displayData.type === 0 /* Image */) ? displayData : rawDisplayData); //\r\n                    var scale = this._textureData.parent.scale * this._armature._armatureData.scale;\r\n                    var frame = this._textureData.frame;\r\n                    this._pivotX = imageDisplayData.pivot.x;\r\n                    this._pivotY = imageDisplayData.pivot.y;\r\n                    var rect = frame !== null ? frame : this._textureData.region;\r\n                    var width = rect.width;\r\n                    var height = rect.height;\r\n                    if (this._textureData.rotated && frame === null) {\r\n                        width = rect.height;\r\n                        height = rect.width;\r\n                    }\r\n                    this._pivotX *= width * scale;\r\n                    this._pivotY *= height * scale;\r\n                    if (frame !== null) {\r\n                        this._pivotX += frame.x * scale;\r\n                        this._pivotY += frame.y * scale;\r\n                    }\r\n                    // Update replace pivot. TODO\r\n                    if (rawDisplayData !== null && imageDisplayData !== rawDisplayData) {\r\n                        rawDisplayData.transform.toMatrix(Slot._helpMatrix);\r\n                        Slot._helpMatrix.invert();\r\n                        Slot._helpMatrix.transformPoint(0.0, 0.0, Slot._helpPoint);\r\n                        this._pivotX -= Slot._helpPoint.x;\r\n                        this._pivotY -= Slot._helpPoint.y;\r\n                        imageDisplayData.transform.toMatrix(Slot._helpMatrix);\r\n                        Slot._helpMatrix.invert();\r\n                        Slot._helpMatrix.transformPoint(0.0, 0.0, Slot._helpPoint);\r\n                        this._pivotX += Slot._helpPoint.x;\r\n                        this._pivotY += Slot._helpPoint.y;\r\n                    }\r\n                    if (!dragonBones.DragonBones.yDown) {\r\n                        this._pivotY = (this._textureData.rotated ? this._textureData.region.width : this._textureData.region.height) * scale - this._pivotY;\r\n                    }\r\n                }\r\n                else {\r\n                    this._pivotX = 0.0;\r\n                    this._pivotY = 0.0;\r\n                }\r\n                // Update original transform.\r\n                if (rawDisplayData !== null) { // Compatible.\r\n                    this.origin = rawDisplayData.transform;\r\n                }\r\n                else if (displayData !== null) { // Compatible.\r\n                    this.origin = displayData.transform;\r\n                }\r\n                else {\r\n                    this.origin = null;\r\n                }\r\n                // TODO remove slot offset.\r\n                if (this.origin !== null) {\r\n                    this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix);\r\n                }\r\n                else {\r\n                    this.global.copyFrom(this.offset).toMatrix(this._localMatrix);\r\n                }\r\n                // Update geometry.\r\n                if (this._geometryData !== prevGeometryData) {\r\n                    this._geometryDirty = true;\r\n                    this._verticesDirty = true;\r\n                    if (this._geometryData !== null) {\r\n                        this._geometryBones.length = 0;\r\n                        if (this._geometryData.weight !== null) {\r\n                            for (var i = 0, l = this._geometryData.weight.bones.length; i < l; ++i) {\r\n                                var bone = this._armature.getBone(this._geometryData.weight.bones[i].name);\r\n                                this._geometryBones.push(bone);\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        this._geometryBones.length = 0;\r\n                        this._geometryData = null;\r\n                    }\r\n                }\r\n                this._textureDirty = this._textureData !== prevTextureData;\r\n                this._transformDirty = true;\r\n            }\r\n        };\r\n        Slot.prototype._updateDisplay = function () {\r\n            var prevDisplay = this._display !== null ? this._display : this._rawDisplay;\r\n            var prevChildArmature = this._childArmature;\r\n            // Update display and child armature.\r\n            if (this._displayFrame !== null) {\r\n                this._display = this._displayFrame.display;\r\n                if (this._display !== null && this._display instanceof dragonBones.Armature) {\r\n                    this._childArmature = this._display;\r\n                    this._display = this._childArmature.display;\r\n                }\r\n                else {\r\n                    this._childArmature = null;\r\n                }\r\n            }\r\n            else {\r\n                this._display = null;\r\n                this._childArmature = null;\r\n            }\r\n            // Update display.\r\n            var currentDisplay = this._display !== null ? this._display : this._rawDisplay;\r\n            if (currentDisplay !== prevDisplay) {\r\n                this._textureDirty = true;\r\n                this._visibleDirty = true;\r\n                this._blendModeDirty = true;\r\n                // this._zOrderDirty = true;\r\n                this._colorDirty = true;\r\n                this._transformDirty = true;\r\n                this._onUpdateDisplay();\r\n                this._replaceDisplay(prevDisplay);\r\n            }\r\n            // Update child armature.\r\n            if (this._childArmature !== prevChildArmature) {\r\n                if (prevChildArmature !== null) {\r\n                    prevChildArmature._parent = null; // Update child armature parent.\r\n                    prevChildArmature.clock = null;\r\n                    if (prevChildArmature.inheritAnimation) {\r\n                        prevChildArmature.animation.reset();\r\n                    }\r\n                }\r\n                if (this._childArmature !== null) {\r\n                    this._childArmature._parent = this; // Update child armature parent.\r\n                    this._childArmature.clock = this._armature.clock;\r\n                    if (this._childArmature.inheritAnimation) { // Set child armature cache frameRate.\r\n                        if (this._childArmature.cacheFrameRate === 0) {\r\n                            var cacheFrameRate = this._armature.cacheFrameRate;\r\n                            if (cacheFrameRate !== 0) {\r\n                                this._childArmature.cacheFrameRate = cacheFrameRate;\r\n                            }\r\n                        }\r\n                        // Child armature action.\r\n                        if (this._displayFrame !== null) {\r\n                            var actions = null;\r\n                            var displayData = this._displayFrame.displayData !== null ? this._displayFrame.displayData : this._displayFrame.rawDisplayData;\r\n                            if (displayData !== null && displayData.type === 1 /* Armature */) {\r\n                                actions = displayData.actions;\r\n                            }\r\n                            if (actions !== null && actions.length > 0) {\r\n                                for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n                                    var action = actions_1[_i];\r\n                                    var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                                    dragonBones.EventObject.actionDataToInstance(action, eventObject, this._armature);\r\n                                    eventObject.slot = this;\r\n                                    this._armature._bufferAction(eventObject, false);\r\n                                }\r\n                            }\r\n                            else {\r\n                                this._childArmature.animation.play();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        Slot.prototype._updateGlobalTransformMatrix = function (isCache) {\r\n            var parentMatrix = this._parent._boneData.type === 0 /* Bone */ ? this._parent.globalTransformMatrix : this._parent._getGlobalTransformMatrix(this.global.x, this.global.y);\r\n            this.globalTransformMatrix.copyFrom(this._localMatrix);\r\n            this.globalTransformMatrix.concat(parentMatrix);\r\n            if (isCache) {\r\n                this.global.fromMatrix(this.globalTransformMatrix);\r\n            }\r\n            else {\r\n                this._globalDirty = true;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype._setDisplayIndex = function (value, isAnimation) {\r\n            if (isAnimation === void 0) { isAnimation = false; }\r\n            if (isAnimation) {\r\n                if (this._animationDisplayIndex === value) {\r\n                    return;\r\n                }\r\n                this._animationDisplayIndex = value;\r\n            }\r\n            if (this._displayIndex === value) {\r\n                return;\r\n            }\r\n            this._displayIndex = value < this._displayFrames.length ? value : this._displayFrames.length - 1;\r\n            this._displayDataDirty = true;\r\n            this._displayDirty = this._displayIndex < 0 || this._display !== this._displayFrames[this._displayIndex].display;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype._setZOrder = function (value) {\r\n            if (this._zOrder === value) {\r\n                // return false;\r\n            }\r\n            this._zOrder = value;\r\n            this._zOrderDirty = true;\r\n            return this._zOrderDirty;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype._setColor = function (value) {\r\n            this._colorTransform.copyFrom(value);\r\n            return this._colorDirty = true;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype.init = function (slotData, armatureValue, rawDisplay, meshDisplay) {\r\n            if (this._slotData !== null) {\r\n                return;\r\n            }\r\n            this._slotData = slotData;\r\n            this._colorDirty = true; //\r\n            this._blendModeDirty = true; //\r\n            this._blendMode = this._slotData.blendMode;\r\n            this._zOrder = this._slotData.zOrder;\r\n            this._zIndex = this._slotData.zIndex;\r\n            this._alpha = this._slotData.alpha;\r\n            this._colorTransform.copyFrom(this._slotData.color);\r\n            this._rawDisplay = rawDisplay;\r\n            this._meshDisplay = meshDisplay;\r\n            //\r\n            this._armature = armatureValue;\r\n            var slotParent = this._armature.getBone(this._slotData.parent.name);\r\n            if (slotParent !== null) {\r\n                this._parent = slotParent;\r\n            }\r\n            else {\r\n                // Never;\r\n            }\r\n            this._armature._addSlot(this);\r\n            //\r\n            this._initDisplay(this._rawDisplay, false);\r\n            if (this._rawDisplay !== this._meshDisplay) {\r\n                this._initDisplay(this._meshDisplay, false);\r\n            }\r\n            this._onUpdateDisplay();\r\n            this._addDisplay();\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Slot.prototype.update = function (cacheFrameIndex) {\r\n            if (this._displayDataDirty) {\r\n                this._updateDisplayData();\r\n                this._displayDataDirty = false;\r\n            }\r\n            if (this._displayDirty) {\r\n                this._updateDisplay();\r\n                this._displayDirty = false;\r\n            }\r\n            if (this._geometryDirty || this._textureDirty) {\r\n                if (this._display === null || this._display === this._rawDisplay || this._display === this._meshDisplay) {\r\n                    this._updateFrame();\r\n                }\r\n                this._geometryDirty = false;\r\n                this._textureDirty = false;\r\n            }\r\n            if (this._display === null) {\r\n                return;\r\n            }\r\n            if (this._visibleDirty) {\r\n                this._updateVisible();\r\n                this._visibleDirty = false;\r\n            }\r\n            if (this._blendModeDirty) {\r\n                this._updateBlendMode();\r\n                this._blendModeDirty = false;\r\n            }\r\n            if (this._colorDirty) {\r\n                this._updateColor();\r\n                this._colorDirty = false;\r\n            }\r\n            if (this._zOrderDirty) {\r\n                this._updateZOrder();\r\n                this._zOrderDirty = false;\r\n            }\r\n            if (this._geometryData !== null && this._display === this._meshDisplay) {\r\n                var isSkinned = this._geometryData.weight !== null;\r\n                var isSurface = this._parent._boneData.type !== 0 /* Bone */;\r\n                if (this._verticesDirty ||\r\n                    (isSkinned && this._isBonesUpdate()) ||\r\n                    (isSurface && this._parent._childrenTransformDirty)) {\r\n                    this._verticesDirty = false; // Allow update mesh to reset the dirty value.\r\n                    this._updateMesh();\r\n                }\r\n                if (isSkinned || isSurface) { // Compatible.\r\n                    return;\r\n                }\r\n            }\r\n            if (cacheFrameIndex >= 0 && this._cachedFrameIndices !== null) {\r\n                var cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex];\r\n                if (cachedFrameIndex >= 0 && this._cachedFrameIndex === cachedFrameIndex) { // Same cache.\r\n                    this._transformDirty = false;\r\n                }\r\n                else if (cachedFrameIndex >= 0) { // Has been Cached.\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = cachedFrameIndex;\r\n                }\r\n                else if (this._transformDirty || this._parent._childrenTransformDirty) { // Dirty.\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = -1;\r\n                }\r\n                else if (this._cachedFrameIndex >= 0) { // Same cache, but not set index yet.\r\n                    this._transformDirty = false;\r\n                    this._cachedFrameIndices[cacheFrameIndex] = this._cachedFrameIndex;\r\n                }\r\n                else { // Dirty.\r\n                    this._transformDirty = true;\r\n                    this._cachedFrameIndex = -1;\r\n                }\r\n            }\r\n            else if (this._transformDirty || this._parent._childrenTransformDirty) { // Dirty.\r\n                cacheFrameIndex = -1;\r\n                this._transformDirty = true;\r\n                this._cachedFrameIndex = -1;\r\n            }\r\n            if (this._transformDirty) {\r\n                if (this._cachedFrameIndex < 0) {\r\n                    var isCache = cacheFrameIndex >= 0;\r\n                    this._updateGlobalTransformMatrix(isCache);\r\n                    if (isCache && this._cachedFrameIndices !== null) {\r\n                        this._cachedFrameIndex = this._cachedFrameIndices[cacheFrameIndex] = this._armature._armatureData.setCacheFrame(this.globalTransformMatrix, this.global);\r\n                    }\r\n                }\r\n                else {\r\n                    this._armature._armatureData.getCacheFrame(this.globalTransformMatrix, this.global, this._cachedFrameIndex);\r\n                }\r\n                this._updateTransform();\r\n                this._transformDirty = false;\r\n            }\r\n        };\r\n        /**\r\n         * - Forces the slot to update the state of the display object in the next frame.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 强制插槽在下一帧更新显示对象的状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Slot.prototype.invalidUpdate = function () {\r\n            this._displayDataDirty = true;\r\n            this._displayDirty = true;\r\n            //\r\n            this._transformDirty = true;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.updateTransformAndMatrix = function () {\r\n            if (this._transformDirty) {\r\n                this._updateGlobalTransformMatrix(false);\r\n                this._transformDirty = false;\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.replaceRawDisplayData = function (displayData, index) {\r\n            if (index === void 0) { index = -1; }\r\n            if (index < 0) {\r\n                index = this._displayIndex < 0 ? 0 : this._displayIndex;\r\n            }\r\n            else if (index >= this._displayFrames.length) {\r\n                return;\r\n            }\r\n            var displayFrame = this._displayFrames[index];\r\n            if (displayFrame.rawDisplayData !== displayData) {\r\n                displayFrame.deformVertices.length = 0;\r\n                displayFrame.rawDisplayData = displayData;\r\n                if (displayFrame.rawDisplayData === null) {\r\n                    var defaultSkin = this._armature._armatureData.defaultSkin;\r\n                    if (defaultSkin !== null) {\r\n                        var defaultRawDisplayDatas = defaultSkin.getDisplays(this._slotData.name);\r\n                        if (defaultRawDisplayDatas !== null && index < defaultRawDisplayDatas.length) {\r\n                            displayFrame.rawDisplayData = defaultRawDisplayDatas[index];\r\n                        }\r\n                    }\r\n                }\r\n                if (index === this._displayIndex) {\r\n                    this._displayDataDirty = true;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.replaceDisplayData = function (displayData, index) {\r\n            if (index === void 0) { index = -1; }\r\n            if (index < 0) {\r\n                index = this._displayIndex < 0 ? 0 : this._displayIndex;\r\n            }\r\n            else if (index >= this._displayFrames.length) {\r\n                return;\r\n            }\r\n            var displayFrame = this._displayFrames[index];\r\n            if (displayFrame.displayData !== displayData && displayFrame.rawDisplayData !== displayData) {\r\n                displayFrame.displayData = displayData;\r\n                if (index === this._displayIndex) {\r\n                    this._displayDataDirty = true;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.replaceTextureData = function (textureData, index) {\r\n            if (index === void 0) { index = -1; }\r\n            if (index < 0) {\r\n                index = this._displayIndex < 0 ? 0 : this._displayIndex;\r\n            }\r\n            else if (index >= this._displayFrames.length) {\r\n                return;\r\n            }\r\n            var displayFrame = this._displayFrames[index];\r\n            if (displayFrame.textureData !== textureData) {\r\n                displayFrame.textureData = textureData;\r\n                if (index === this._displayIndex) {\r\n                    this._displayDataDirty = true;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.replaceDisplay = function (value, index) {\r\n            if (index === void 0) { index = -1; }\r\n            if (index < 0) {\r\n                index = this._displayIndex < 0 ? 0 : this._displayIndex;\r\n            }\r\n            else if (index >= this._displayFrames.length) {\r\n                return;\r\n            }\r\n            var displayFrame = this._displayFrames[index];\r\n            if (displayFrame.display !== value) {\r\n                var prevDisplay = displayFrame.display;\r\n                displayFrame.display = value;\r\n                if (prevDisplay !== null &&\r\n                    prevDisplay !== this._rawDisplay && prevDisplay !== this._meshDisplay &&\r\n                    !this._hasDisplay(prevDisplay)) {\r\n                    if (prevDisplay instanceof dragonBones.Armature) {\r\n                        // (eachDisplay as Armature).dispose();\r\n                    }\r\n                    else {\r\n                        this._disposeDisplay(prevDisplay, true);\r\n                    }\r\n                }\r\n                if (value !== null &&\r\n                    value !== this._rawDisplay && value !== this._meshDisplay &&\r\n                    !this._hasDisplay(prevDisplay) &&\r\n                    !(value instanceof dragonBones.Armature)) {\r\n                    this._initDisplay(value, true);\r\n                }\r\n                if (index === this._displayIndex) {\r\n                    this._displayDirty = true;\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Check whether a specific point is inside a custom bounding box in the slot.\r\n         * The coordinate system of the point is the inner coordinate system of the armature.\r\n         * Custom bounding boxes need to be customized in Dragonbones Pro.\r\n         * @param x - The horizontal coordinate of the point.\r\n         * @param y - The vertical coordinate of the point.\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查特定点是否在插槽的自定义边界框内。\r\n         * 点的坐标系为骨架内坐标系。\r\n         * 自定义边界框需要在 DragonBones Pro 中自定义。\r\n         * @param x - 点的水平坐标。\r\n         * @param y - 点的垂直坐标。\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        Slot.prototype.containsPoint = function (x, y) {\r\n            if (this._boundingBoxData === null) {\r\n                return false;\r\n            }\r\n            this.updateTransformAndMatrix();\r\n            Slot._helpMatrix.copyFrom(this.globalTransformMatrix);\r\n            Slot._helpMatrix.invert();\r\n            Slot._helpMatrix.transformPoint(x, y, Slot._helpPoint);\r\n            return this._boundingBoxData.containsPoint(Slot._helpPoint.x, Slot._helpPoint.y);\r\n        };\r\n        /**\r\n         * - Check whether a specific segment intersects a custom bounding box for the slot.\r\n         * The coordinate system of the segment and intersection is the inner coordinate system of the armature.\r\n         * Custom bounding boxes need to be customized in Dragonbones Pro.\r\n         * @param xA - The horizontal coordinate of the beginning of the segment.\r\n         * @param yA - The vertical coordinate of the beginning of the segment.\r\n         * @param xB - The horizontal coordinate of the end point of the segment.\r\n         * @param yB - The vertical coordinate of the end point of the segment.\r\n         * @param intersectionPointA - The first intersection at which a line segment intersects the bounding box from the beginning to the end. (If not set, the intersection point will not calculated)\r\n         * @param intersectionPointB - The first intersection at which a line segment intersects the bounding box from the end to the beginning. (If not set, the intersection point will not calculated)\r\n         * @param normalRadians - The normal radians of the tangent of the intersection boundary box. [x: Normal radian of the first intersection tangent, y: Normal radian of the second intersection tangent] (If not set, the normal will not calculated)\r\n         * @returns Intersection situation. [1: Disjoint and segments within the bounding box, 0: Disjoint, 1: Intersecting and having a nodal point and ending in the bounding box, 2: Intersecting and having a nodal point and starting at the bounding box, 3: Intersecting and having two intersections, N: Intersecting and having N intersections]\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查特定线段是否与插槽的自定义边界框相交。\r\n         * 线段和交点的坐标系均为骨架内坐标系。\r\n         * 自定义边界框需要在 DragonBones Pro 中自定义。\r\n         * @param xA - 线段起点的水平坐标。\r\n         * @param yA - 线段起点的垂直坐标。\r\n         * @param xB - 线段终点的水平坐标。\r\n         * @param yB - 线段终点的垂直坐标。\r\n         * @param intersectionPointA - 线段从起点到终点与边界框相交的第一个交点。 （如果未设置，则不计算交点）\r\n         * @param intersectionPointB - 线段从终点到起点与边界框相交的第一个交点。 （如果未设置，则不计算交点）\r\n         * @param normalRadians - 交点边界框切线的法线弧度。 [x: 第一个交点切线的法线弧度, y: 第二个交点切线的法线弧度] （如果未设置，则不计算法线）\r\n         * @returns 相交的情况。 [-1: 不相交且线段在包围盒内, 0: 不相交, 1: 相交且有一个交点且终点在包围盒内, 2: 相交且有一个交点且起点在包围盒内, 3: 相交且有两个交点, N: 相交且有 N 个交点]\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        Slot.prototype.intersectsSegment = function (xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians) {\r\n            if (intersectionPointA === void 0) { intersectionPointA = null; }\r\n            if (intersectionPointB === void 0) { intersectionPointB = null; }\r\n            if (normalRadians === void 0) { normalRadians = null; }\r\n            if (this._boundingBoxData === null) {\r\n                return 0;\r\n            }\r\n            this.updateTransformAndMatrix();\r\n            Slot._helpMatrix.copyFrom(this.globalTransformMatrix);\r\n            Slot._helpMatrix.invert();\r\n            Slot._helpMatrix.transformPoint(xA, yA, Slot._helpPoint);\r\n            xA = Slot._helpPoint.x;\r\n            yA = Slot._helpPoint.y;\r\n            Slot._helpMatrix.transformPoint(xB, yB, Slot._helpPoint);\r\n            xB = Slot._helpPoint.x;\r\n            yB = Slot._helpPoint.y;\r\n            var intersectionCount = this._boundingBoxData.intersectsSegment(xA, yA, xB, yB, intersectionPointA, intersectionPointB, normalRadians);\r\n            if (intersectionCount > 0) {\r\n                if (intersectionCount === 1 || intersectionCount === 2) {\r\n                    if (intersectionPointA !== null) {\r\n                        this.globalTransformMatrix.transformPoint(intersectionPointA.x, intersectionPointA.y, intersectionPointA);\r\n                        if (intersectionPointB !== null) {\r\n                            intersectionPointB.x = intersectionPointA.x;\r\n                            intersectionPointB.y = intersectionPointA.y;\r\n                        }\r\n                    }\r\n                    else if (intersectionPointB !== null) {\r\n                        this.globalTransformMatrix.transformPoint(intersectionPointB.x, intersectionPointB.y, intersectionPointB);\r\n                    }\r\n                }\r\n                else {\r\n                    if (intersectionPointA !== null) {\r\n                        this.globalTransformMatrix.transformPoint(intersectionPointA.x, intersectionPointA.y, intersectionPointA);\r\n                    }\r\n                    if (intersectionPointB !== null) {\r\n                        this.globalTransformMatrix.transformPoint(intersectionPointB.x, intersectionPointB.y, intersectionPointB);\r\n                    }\r\n                }\r\n                if (normalRadians !== null) {\r\n                    this.globalTransformMatrix.transformPoint(Math.cos(normalRadians.x), Math.sin(normalRadians.x), Slot._helpPoint, true);\r\n                    normalRadians.x = Math.atan2(Slot._helpPoint.y, Slot._helpPoint.x);\r\n                    this.globalTransformMatrix.transformPoint(Math.cos(normalRadians.y), Math.sin(normalRadians.y), Slot._helpPoint, true);\r\n                    normalRadians.y = Math.atan2(Slot._helpPoint.y, Slot._helpPoint.x);\r\n                }\r\n            }\r\n            return intersectionCount;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        Slot.prototype.getDisplayFrameAt = function (index) {\r\n            return this._displayFrames[index];\r\n        };\r\n        Object.defineProperty(Slot.prototype, "visible", {\r\n            /**\r\n             * - The visible of slot\'s display object.\r\n             * @default true\r\n             * @version DragonBones 5.6\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽的显示对象的可见。\r\n             * @default true\r\n             * @version DragonBones 5.6\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._visible;\r\n            },\r\n            set: function (value) {\r\n                if (this._visible === value) {\r\n                    return;\r\n                }\r\n                this._visible = value;\r\n                this._updateVisible();\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "displayFrameCount", {\r\n            /**\r\n             * @private\r\n             */\r\n            get: function () {\r\n                return this._displayFrames.length;\r\n            },\r\n            set: function (value) {\r\n                var prevCount = this._displayFrames.length;\r\n                if (prevCount < value) {\r\n                    this._displayFrames.length = value;\r\n                    for (var i = prevCount; i < value; ++i) {\r\n                        this._displayFrames[i] = dragonBones.BaseObject.borrowObject(DisplayFrame);\r\n                    }\r\n                }\r\n                else if (prevCount > value) {\r\n                    for (var i = prevCount - 1; i < value; --i) {\r\n                        this.replaceDisplay(null, i);\r\n                        this._displayFrames[i].returnToPool();\r\n                    }\r\n                    this._displayFrames.length = value;\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "displayIndex", {\r\n            /**\r\n             * - The index of the display object displayed in the display list.\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("weapon");\r\n             *     slot.displayIndex = 3;\r\n             *     slot.displayController = "none";\r\n             * </pre>\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 此时显示的显示对象在显示列表中的索引。\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("weapon");\r\n             *     slot.displayIndex = 3;\r\n             *     slot.displayController = "none";\r\n             * </pre>\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._displayIndex;\r\n            },\r\n            set: function (value) {\r\n                this._setDisplayIndex(value);\r\n                this.update(-1);\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "name", {\r\n            /**\r\n             * - The slot name.\r\n             * @see dragonBones.SlotData#name\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽名称。\r\n             * @see dragonBones.SlotData#name\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._slotData.name;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "displayList", {\r\n            /**\r\n             * - Contains a display list of display objects or child armatures.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 包含显示对象或子骨架的显示列表。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                var displays = new Array();\r\n                for (var _i = 0, _a = this._displayFrames; _i < _a.length; _i++) {\r\n                    var displayFrame = _a[_i];\r\n                    displays.push(displayFrame.display);\r\n                }\r\n                return displays;\r\n            },\r\n            set: function (value) {\r\n                this.displayFrameCount = value.length;\r\n                var index = 0;\r\n                for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\r\n                    var eachDisplay = value_1[_i];\r\n                    this.replaceDisplay(eachDisplay, index++);\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "slotData", {\r\n            /**\r\n             * - The slot data.\r\n             * @see dragonBones.SlotData\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽数据。\r\n             * @see dragonBones.SlotData\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._slotData;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "boundingBoxData", {\r\n            /**\r\n             * - The custom bounding box data for the slot at current time.\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽此时的自定义包围盒数据。\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._boundingBoxData;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "rawDisplay", {\r\n            /**\r\n             * @private\r\n             */\r\n            get: function () {\r\n                return this._rawDisplay;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "meshDisplay", {\r\n            /**\r\n             * @private\r\n             */\r\n            get: function () {\r\n                return this._meshDisplay;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "display", {\r\n            /**\r\n             * - The display object that the slot displays at this time.\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("text");\r\n             *     slot.display = new yourEngine.TextField();\r\n             * </pre>\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽此时显示的显示对象。\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("text");\r\n             *     slot.display = new yourEngine.TextField();\r\n             * </pre>\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._display;\r\n            },\r\n            set: function (value) {\r\n                if (this._display === value) {\r\n                    return;\r\n                }\r\n                if (this._displayFrames.length === 0) {\r\n                    this.displayFrameCount = 1;\r\n                    this._displayIndex = 0;\r\n                }\r\n                this.replaceDisplay(value, this._displayIndex);\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "childArmature", {\r\n            /**\r\n             * - The child armature that the slot displayed at current time.\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("weapon");\r\n             *     let prevChildArmature = slot.childArmature;\r\n             *     if (prevChildArmature) {\r\n             *         prevChildArmature.dispose();\r\n             *     }\r\n             *     slot.childArmature = factory.buildArmature("weapon_blabla", "weapon_blabla_project");\r\n             * </pre>\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 插槽此时显示的子骨架。\r\n             * 注意，被替换的对象或子骨架并不会被回收，根据语言和引擎的不同，需要额外处理。\r\n             * @example\r\n             * <pre>\r\n             *     let slot = armature.getSlot("weapon");\r\n             *     let prevChildArmature = slot.childArmature;\r\n             *     if (prevChildArmature) {\r\n             *         prevChildArmature.dispose();\r\n             *     }\r\n             *     slot.childArmature = factory.buildArmature("weapon_blabla", "weapon_blabla_project");\r\n             * </pre>\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._childArmature;\r\n            },\r\n            set: function (value) {\r\n                if (this._childArmature === value) {\r\n                    return;\r\n                }\r\n                this.display = value;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Slot.prototype, "parent", {\r\n            /**\r\n             * - The parent bone to which it belongs.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所属的父骨骼。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._parent;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        /**\r\n         * - Deprecated, please refer to {@link #display}.\r\n         * @deprecated\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 已废弃，请参考 {@link #display}。\r\n         * @deprecated\r\n         * @language zh_CN\r\n         */\r\n        Slot.prototype.getDisplay = function () {\r\n            return this._display;\r\n        };\r\n        /**\r\n         * - Deprecated, please refer to {@link #display}.\r\n         * @deprecated\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 已废弃，请参考 {@link #display}。\r\n         * @deprecated\r\n         * @language zh_CN\r\n         */\r\n        Slot.prototype.setDisplay = function (value) {\r\n            this.display = value;\r\n        };\r\n        return Slot;\r\n    }(dragonBones.TransformObject));\r\n    dragonBones.Slot = Slot;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @internal\r\n     */\r\n    var Constraint = /** @class */ (function (_super) {\r\n        __extends(Constraint, _super);\r\n        function Constraint() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        Constraint.prototype._onClear = function () {\r\n            this._armature = null; //\r\n            this._target = null; //\r\n            this._root = null; //\r\n            this._bone = null;\r\n        };\r\n        Object.defineProperty(Constraint.prototype, "name", {\r\n            get: function () {\r\n                return this._constraintData.name;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Constraint._helpMatrix = new dragonBones.Matrix();\r\n        Constraint._helpTransform = new dragonBones.Transform();\r\n        Constraint._helpPoint = new dragonBones.Point();\r\n        return Constraint;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.Constraint = Constraint;\r\n    /**\r\n     * @internal\r\n     */\r\n    var IKConstraint = /** @class */ (function (_super) {\r\n        __extends(IKConstraint, _super);\r\n        function IKConstraint() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        IKConstraint.toString = function () {\r\n            return "[class dragonBones.IKConstraint]";\r\n        };\r\n        IKConstraint.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._scaleEnabled = false;\r\n            this._bendPositive = false;\r\n            this._weight = 1.0;\r\n            this._constraintData = null;\r\n        };\r\n        IKConstraint.prototype._computeA = function () {\r\n            var ikGlobal = this._target.global;\r\n            var global = this._root.global;\r\n            var globalTransformMatrix = this._root.globalTransformMatrix;\r\n            var radian = Math.atan2(ikGlobal.y - global.y, ikGlobal.x - global.x);\r\n            if (global.scaleX < 0.0) {\r\n                radian += Math.PI;\r\n            }\r\n            global.rotation += dragonBones.Transform.normalizeRadian(radian - global.rotation) * this._weight;\r\n            global.toMatrix(globalTransformMatrix);\r\n        };\r\n        IKConstraint.prototype._computeB = function () {\r\n            var boneLength = this._bone._boneData.length;\r\n            var parent = this._root;\r\n            var ikGlobal = this._target.global;\r\n            var parentGlobal = parent.global;\r\n            var global = this._bone.global;\r\n            var globalTransformMatrix = this._bone.globalTransformMatrix;\r\n            var x = globalTransformMatrix.a * boneLength;\r\n            var y = globalTransformMatrix.b * boneLength;\r\n            var lLL = x * x + y * y;\r\n            var lL = Math.sqrt(lLL);\r\n            var dX = global.x - parentGlobal.x;\r\n            var dY = global.y - parentGlobal.y;\r\n            var lPP = dX * dX + dY * dY;\r\n            var lP = Math.sqrt(lPP);\r\n            var rawRadian = global.rotation;\r\n            var rawParentRadian = parentGlobal.rotation;\r\n            var rawRadianA = Math.atan2(dY, dX);\r\n            dX = ikGlobal.x - parentGlobal.x;\r\n            dY = ikGlobal.y - parentGlobal.y;\r\n            var lTT = dX * dX + dY * dY;\r\n            var lT = Math.sqrt(lTT);\r\n            var radianA = 0.0;\r\n            if (lL + lP <= lT || lT + lL <= lP || lT + lP <= lL) {\r\n                radianA = Math.atan2(ikGlobal.y - parentGlobal.y, ikGlobal.x - parentGlobal.x);\r\n                if (lL + lP <= lT) {\r\n                }\r\n                else if (lP < lL) {\r\n                    radianA += Math.PI;\r\n                }\r\n            }\r\n            else {\r\n                var h = (lPP - lLL + lTT) / (2.0 * lTT);\r\n                var r = Math.sqrt(lPP - h * h * lTT) / lT;\r\n                var hX = parentGlobal.x + (dX * h);\r\n                var hY = parentGlobal.y + (dY * h);\r\n                var rX = -dY * r;\r\n                var rY = dX * r;\r\n                var isPPR = false;\r\n                var parentParent = parent.parent;\r\n                if (parentParent !== null) {\r\n                    var parentParentMatrix = parentParent.globalTransformMatrix;\r\n                    isPPR = parentParentMatrix.a * parentParentMatrix.d - parentParentMatrix.b * parentParentMatrix.c < 0.0;\r\n                }\r\n                if (isPPR !== this._bendPositive) {\r\n                    global.x = hX - rX;\r\n                    global.y = hY - rY;\r\n                }\r\n                else {\r\n                    global.x = hX + rX;\r\n                    global.y = hY + rY;\r\n                }\r\n                radianA = Math.atan2(global.y - parentGlobal.y, global.x - parentGlobal.x);\r\n            }\r\n            var dR = dragonBones.Transform.normalizeRadian(radianA - rawRadianA);\r\n            parentGlobal.rotation = rawParentRadian + dR * this._weight;\r\n            parentGlobal.toMatrix(parent.globalTransformMatrix);\r\n            //\r\n            var currentRadianA = rawRadianA + dR * this._weight;\r\n            global.x = parentGlobal.x + Math.cos(currentRadianA) * lP;\r\n            global.y = parentGlobal.y + Math.sin(currentRadianA) * lP;\r\n            //\r\n            var radianB = Math.atan2(ikGlobal.y - global.y, ikGlobal.x - global.x);\r\n            if (global.scaleX < 0.0) {\r\n                radianB += Math.PI;\r\n            }\r\n            global.rotation = parentGlobal.rotation + rawRadian - rawParentRadian + dragonBones.Transform.normalizeRadian(radianB - dR - rawRadian) * this._weight;\r\n            global.toMatrix(globalTransformMatrix);\r\n        };\r\n        IKConstraint.prototype.init = function (constraintData, armature) {\r\n            if (this._constraintData !== null) {\r\n                return;\r\n            }\r\n            this._constraintData = constraintData;\r\n            this._armature = armature;\r\n            this._target = this._armature.getBone(this._constraintData.target.name);\r\n            this._root = this._armature.getBone(this._constraintData.root.name);\r\n            this._bone = this._constraintData.bone !== null ? this._armature.getBone(this._constraintData.bone.name) : null;\r\n            {\r\n                var ikConstraintData = this._constraintData;\r\n                this._scaleEnabled = ikConstraintData.scaleEnabled;\r\n                this._bendPositive = ikConstraintData.bendPositive;\r\n                this._weight = ikConstraintData.weight;\r\n            }\r\n            this._root._hasConstraint = true;\r\n        };\r\n        IKConstraint.prototype.update = function () {\r\n            this._root.updateByConstraint();\r\n            if (this._bone !== null) {\r\n                this._bone.updateByConstraint();\r\n                this._computeB();\r\n            }\r\n            else {\r\n                this._computeA();\r\n            }\r\n        };\r\n        IKConstraint.prototype.invalidUpdate = function () {\r\n            this._root.invalidUpdate();\r\n            if (this._bone !== null) {\r\n                this._bone.invalidUpdate();\r\n            }\r\n        };\r\n        return IKConstraint;\r\n    }(Constraint));\r\n    dragonBones.IKConstraint = IKConstraint;\r\n    /**\r\n     * @internal\r\n     */\r\n    var PathConstraint = /** @class */ (function (_super) {\r\n        __extends(PathConstraint, _super);\r\n        function PathConstraint() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._bones = [];\r\n            _this._spaces = [];\r\n            _this._positions = [];\r\n            _this._curves = [];\r\n            _this._boneLengths = [];\r\n            _this._pathGlobalVertices = [];\r\n            _this._segments = [10];\r\n            return _this;\r\n        }\r\n        PathConstraint.toString = function () {\r\n            return "[class dragonBones.PathConstraint]";\r\n        };\r\n        PathConstraint.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.dirty = false;\r\n            this.pathOffset = 0;\r\n            this.position = 0.0;\r\n            this.spacing = 0.0;\r\n            this.rotateOffset = 0.0;\r\n            this.rotateMix = 1.0;\r\n            this.translateMix = 1.0;\r\n            this._pathSlot = null;\r\n            this._bones.length = 0;\r\n            this._spaces.length = 0;\r\n            this._positions.length = 0;\r\n            this._curves.length = 0;\r\n            this._boneLengths.length = 0;\r\n            this._pathGlobalVertices.length = 0;\r\n        };\r\n        PathConstraint.prototype._updatePathVertices = function (verticesData) {\r\n            //计算曲线的节点数据\r\n            var armature = this._armature;\r\n            var dragonBonesData = armature.armatureData.parent;\r\n            var scale = armature.armatureData.scale;\r\n            var intArray = dragonBonesData.intArray;\r\n            var floatArray = dragonBonesData.floatArray;\r\n            var pathOffset = verticesData.offset;\r\n            var pathVertexCount = intArray[pathOffset + 0 /* GeometryVertexCount */];\r\n            var pathVertexOffset = intArray[pathOffset + 2 /* GeometryFloatOffset */];\r\n            this._pathGlobalVertices.length = pathVertexCount * 2;\r\n            var weightData = verticesData.weight;\r\n            //没有骨骼约束我,那节点只受自己的Bone控制\r\n            if (weightData === null) {\r\n                var parentBone = this._pathSlot.parent;\r\n                parentBone.updateByConstraint();\r\n                var matrix = parentBone.globalTransformMatrix;\r\n                for (var i = 0, iV_1 = pathVertexOffset; i < pathVertexCount; i += 2) {\r\n                    var vx = floatArray[iV_1++] * scale;\r\n                    var vy = floatArray[iV_1++] * scale;\r\n                    var x = matrix.a * vx + matrix.c * vy + matrix.tx;\r\n                    var y = matrix.b * vx + matrix.d * vy + matrix.ty;\r\n                    //\r\n                    this._pathGlobalVertices[i] = x;\r\n                    this._pathGlobalVertices[i + 1] = y;\r\n                }\r\n                return;\r\n            }\r\n            //有骨骼约束我,那我的节点受骨骼权重控制\r\n            var bones = this._pathSlot._geometryBones;\r\n            var weightBoneCount = weightData.bones.length;\r\n            var weightOffset = weightData.offset;\r\n            var floatOffset = intArray[weightOffset + 1 /* WeigthFloatOffset */];\r\n            var iV = floatOffset;\r\n            var iB = weightOffset + 2 /* WeigthBoneIndices */ + weightBoneCount;\r\n            for (var i = 0, iW = 0; i < pathVertexCount; i++) {\r\n                var vertexBoneCount = intArray[iB++]; //\r\n                var xG = 0.0, yG = 0.0;\r\n                for (var ii = 0, ll = vertexBoneCount; ii < ll; ii++) {\r\n                    var boneIndex = intArray[iB++];\r\n                    var bone = bones[boneIndex];\r\n                    if (bone === null) {\r\n                        continue;\r\n                    }\r\n                    bone.updateByConstraint();\r\n                    var matrix = bone.globalTransformMatrix;\r\n                    var weight = floatArray[iV++];\r\n                    var vx = floatArray[iV++] * scale;\r\n                    var vy = floatArray[iV++] * scale;\r\n                    xG += (matrix.a * vx + matrix.c * vy + matrix.tx) * weight;\r\n                    yG += (matrix.b * vx + matrix.d * vy + matrix.ty) * weight;\r\n                }\r\n                this._pathGlobalVertices[iW++] = xG;\r\n                this._pathGlobalVertices[iW++] = yG;\r\n            }\r\n        };\r\n        PathConstraint.prototype._computeVertices = function (start, count, offset, out) {\r\n            //TODO优化\r\n            for (var i = offset, iW = start; i < count; i += 2) {\r\n                out[i] = this._pathGlobalVertices[iW++];\r\n                out[i + 1] = this._pathGlobalVertices[iW++];\r\n            }\r\n        };\r\n        PathConstraint.prototype._computeBezierCurve = function (pathDisplayDta, spaceCount, tangents, percentPosition, percentSpacing) {\r\n            //计算当前的骨骼在曲线上的位置\r\n            var armature = this._armature;\r\n            var intArray = armature.armatureData.parent.intArray;\r\n            var vertexCount = intArray[pathDisplayDta.geometry.offset + 0 /* GeometryVertexCount */];\r\n            var positions = this._positions;\r\n            var spaces = this._spaces;\r\n            var isClosed = pathDisplayDta.closed;\r\n            var curveVertices = Array();\r\n            var verticesLength = vertexCount * 2;\r\n            var curveCount = verticesLength / 6;\r\n            var preCurve = -1;\r\n            var position = this.position;\r\n            positions.length = spaceCount * 3 + 2;\r\n            var pathLength = 0.0;\r\n            //不需要匀速运动，效率高些\r\n            if (!pathDisplayDta.constantSpeed) {\r\n                var lenghts = pathDisplayDta.curveLengths;\r\n                curveCount -= isClosed ? 1 : 2;\r\n                pathLength = lenghts[curveCount];\r\n                if (percentPosition) {\r\n                    position *= pathLength;\r\n                }\r\n                if (percentSpacing) {\r\n                    for (var i = 0; i < spaceCount; i++) {\r\n                        spaces[i] *= pathLength;\r\n                    }\r\n                }\r\n                curveVertices.length = 8;\r\n                for (var i = 0, o = 0, curve = 0; i < spaceCount; i++, o += 3) {\r\n                    var space = spaces[i];\r\n                    position += space;\r\n                    if (isClosed) {\r\n                        position %= pathLength;\r\n                        if (position < 0) {\r\n                            position += pathLength;\r\n                        }\r\n                        curve = 0;\r\n                    }\r\n                    else if (position < 0) {\r\n                        //TODO\r\n                        continue;\r\n                    }\r\n                    else if (position > pathLength) {\r\n                        //TODO\r\n                        continue;\r\n                    }\r\n                    var percent = 0.0;\r\n                    for (;; curve++) {\r\n                        var len = lenghts[curve];\r\n                        if (position > len) {\r\n                            continue;\r\n                        }\r\n                        if (curve === 0) {\r\n                            percent = position / len;\r\n                        }\r\n                        else {\r\n                            var preLen = lenghts[curve - 1];\r\n                            percent = (position - preLen) / (len - preLen);\r\n                        }\r\n                        break;\r\n                    }\r\n                    if (curve !== preCurve) {\r\n                        preCurve = curve;\r\n                        if (isClosed && curve === curveCount) {\r\n                            //计算曲线\r\n                            this._computeVertices(verticesLength - 4, 4, 0, curveVertices);\r\n                            this._computeVertices(0, 4, 4, curveVertices);\r\n                        }\r\n                        else {\r\n                            this._computeVertices(curve * 6 + 2, 8, 0, curveVertices);\r\n                        }\r\n                    }\r\n                    //\r\n                    this.addCurvePosition(percent, curveVertices[0], curveVertices[1], curveVertices[2], curveVertices[3], curveVertices[4], curveVertices[5], curveVertices[6], curveVertices[7], positions, o, tangents);\r\n                }\r\n                return;\r\n            }\r\n            //匀速的\r\n            if (isClosed) {\r\n                verticesLength += 2;\r\n                curveVertices.length = vertexCount;\r\n                this._computeVertices(2, verticesLength - 4, 0, curveVertices);\r\n                this._computeVertices(0, 2, verticesLength - 4, curveVertices);\r\n                curveVertices[verticesLength - 2] = curveVertices[0];\r\n                curveVertices[verticesLength - 1] = curveVertices[1];\r\n            }\r\n            else {\r\n                curveCount--;\r\n                verticesLength -= 4;\r\n                curveVertices.length = verticesLength;\r\n                this._computeVertices(2, verticesLength, 0, curveVertices);\r\n            }\r\n            //\r\n            var curves = new Array(curveCount);\r\n            pathLength = 0;\r\n            var x1 = curveVertices[0], y1 = curveVertices[1], cx1 = 0, cy1 = 0, cx2 = 0, cy2 = 0, x2 = 0, y2 = 0;\r\n            var tmpx, tmpy, dddfx, dddfy, ddfx, ddfy, dfx, dfy;\r\n            for (var i = 0, w = 2; i < curveCount; i++, w += 6) {\r\n                cx1 = curveVertices[w];\r\n                cy1 = curveVertices[w + 1];\r\n                cx2 = curveVertices[w + 2];\r\n                cy2 = curveVertices[w + 3];\r\n                x2 = curveVertices[w + 4];\r\n                y2 = curveVertices[w + 5];\r\n                tmpx = (x1 - cx1 * 2 + cx2) * 0.1875;\r\n                tmpy = (y1 - cy1 * 2 + cy2) * 0.1875;\r\n                dddfx = ((cx1 - cx2) * 3 - x1 + x2) * 0.09375;\r\n                dddfy = ((cy1 - cy2) * 3 - y1 + y2) * 0.09375;\r\n                ddfx = tmpx * 2 + dddfx;\r\n                ddfy = tmpy * 2 + dddfy;\r\n                dfx = (cx1 - x1) * 0.75 + tmpx + dddfx * 0.16666667;\r\n                dfy = (cy1 - y1) * 0.75 + tmpy + dddfy * 0.16666667;\r\n                pathLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                dfx += ddfx;\r\n                dfy += ddfy;\r\n                ddfx += dddfx;\r\n                ddfy += dddfy;\r\n                pathLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                dfx += ddfx;\r\n                dfy += ddfy;\r\n                pathLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                dfx += ddfx + dddfx;\r\n                dfy += ddfy + dddfy;\r\n                pathLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                curves[i] = pathLength;\r\n                x1 = x2;\r\n                y1 = y2;\r\n            }\r\n            if (percentPosition) {\r\n                position *= pathLength;\r\n            }\r\n            if (percentSpacing) {\r\n                for (var i = 0; i < spaceCount; i++) {\r\n                    spaces[i] *= pathLength;\r\n                }\r\n            }\r\n            var segments = this._segments;\r\n            var curveLength = 0;\r\n            for (var i = 0, o = 0, curve = 0, segment = 0; i < spaceCount; i++, o += 3) {\r\n                var space = spaces[i];\r\n                position += space;\r\n                var p = position;\r\n                if (isClosed) {\r\n                    p %= pathLength;\r\n                    if (p < 0)\r\n                        p += pathLength;\r\n                    curve = 0;\r\n                }\r\n                else if (p < 0) {\r\n                    continue;\r\n                }\r\n                else if (p > pathLength) {\r\n                    continue;\r\n                }\r\n                // Determine curve containing position.\r\n                for (;; curve++) {\r\n                    var length_1 = curves[curve];\r\n                    if (p > length_1)\r\n                        continue;\r\n                    if (curve === 0)\r\n                        p /= length_1;\r\n                    else {\r\n                        var prev = curves[curve - 1];\r\n                        p = (p - prev) / (length_1 - prev);\r\n                    }\r\n                    break;\r\n                }\r\n                if (curve !== preCurve) {\r\n                    preCurve = curve;\r\n                    var ii = curve * 6;\r\n                    x1 = curveVertices[ii];\r\n                    y1 = curveVertices[ii + 1];\r\n                    cx1 = curveVertices[ii + 2];\r\n                    cy1 = curveVertices[ii + 3];\r\n                    cx2 = curveVertices[ii + 4];\r\n                    cy2 = curveVertices[ii + 5];\r\n                    x2 = curveVertices[ii + 6];\r\n                    y2 = curveVertices[ii + 7];\r\n                    tmpx = (x1 - cx1 * 2 + cx2) * 0.03;\r\n                    tmpy = (y1 - cy1 * 2 + cy2) * 0.03;\r\n                    dddfx = ((cx1 - cx2) * 3 - x1 + x2) * 0.006;\r\n                    dddfy = ((cy1 - cy2) * 3 - y1 + y2) * 0.006;\r\n                    ddfx = tmpx * 2 + dddfx;\r\n                    ddfy = tmpy * 2 + dddfy;\r\n                    dfx = (cx1 - x1) * 0.3 + tmpx + dddfx * 0.16666667;\r\n                    dfy = (cy1 - y1) * 0.3 + tmpy + dddfy * 0.16666667;\r\n                    curveLength = Math.sqrt(dfx * dfx + dfy * dfy);\r\n                    segments[0] = curveLength;\r\n                    for (ii = 1; ii < 8; ii++) {\r\n                        dfx += ddfx;\r\n                        dfy += ddfy;\r\n                        ddfx += dddfx;\r\n                        ddfy += dddfy;\r\n                        curveLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                        segments[ii] = curveLength;\r\n                    }\r\n                    dfx += ddfx;\r\n                    dfy += ddfy;\r\n                    curveLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                    segments[8] = curveLength;\r\n                    dfx += ddfx + dddfx;\r\n                    dfy += ddfy + dddfy;\r\n                    curveLength += Math.sqrt(dfx * dfx + dfy * dfy);\r\n                    segments[9] = curveLength;\r\n                    segment = 0;\r\n                }\r\n                // Weight by segment length.\r\n                p *= curveLength;\r\n                for (;; segment++) {\r\n                    var length_2 = segments[segment];\r\n                    if (p > length_2)\r\n                        continue;\r\n                    if (segment === 0)\r\n                        p /= length_2;\r\n                    else {\r\n                        var prev = segments[segment - 1];\r\n                        p = segment + (p - prev) / (length_2 - prev);\r\n                    }\r\n                    break;\r\n                }\r\n                this.addCurvePosition(p * 0.1, x1, y1, cx1, cy1, cx2, cy2, x2, y2, positions, o, tangents);\r\n            }\r\n        };\r\n        //Calculates a point on the curve, for a given t value between 0 and 1.\r\n        PathConstraint.prototype.addCurvePosition = function (t, x1, y1, cx1, cy1, cx2, cy2, x2, y2, out, offset, tangents) {\r\n            if (t === 0) {\r\n                out[offset] = x1;\r\n                out[offset + 1] = y1;\r\n                out[offset + 2] = 0;\r\n                return;\r\n            }\r\n            if (t === 1) {\r\n                out[offset] = x2;\r\n                out[offset + 1] = y2;\r\n                out[offset + 2] = 0;\r\n                return;\r\n            }\r\n            var mt = 1 - t;\r\n            var mt2 = mt * mt;\r\n            var t2 = t * t;\r\n            var a = mt2 * mt;\r\n            var b = mt2 * t * 3;\r\n            var c = mt * t2 * 3;\r\n            var d = t * t2;\r\n            var x = a * x1 + b * cx1 + c * cx2 + d * x2;\r\n            var y = a * y1 + b * cy1 + c * cy2 + d * y2;\r\n            out[offset] = x;\r\n            out[offset + 1] = y;\r\n            if (tangents) {\r\n                //Calculates the curve tangent at the specified t value\r\n                out[offset + 2] = Math.atan2(y - (a * y1 + b * cy1 + c * cy2), x - (a * x1 + b * cx1 + c * cx2));\r\n            }\r\n            else {\r\n                out[offset + 2] = 0;\r\n            }\r\n        };\r\n        PathConstraint.prototype.init = function (constraintData, armature) {\r\n            this._constraintData = constraintData;\r\n            this._armature = armature;\r\n            var data = constraintData;\r\n            this.pathOffset = data.pathDisplayData.geometry.offset;\r\n            //\r\n            this.position = data.position;\r\n            this.spacing = data.spacing;\r\n            this.rotateOffset = data.rotateOffset;\r\n            this.rotateMix = data.rotateMix;\r\n            this.translateMix = data.translateMix;\r\n            //\r\n            this._root = this._armature.getBone(data.root.name);\r\n            this._target = this._armature.getBone(data.target.name);\r\n            this._pathSlot = this._armature.getSlot(data.pathSlot.name);\r\n            for (var i = 0, l = data.bones.length; i < l; i++) {\r\n                var bone = this._armature.getBone(data.bones[i].name);\r\n                if (bone !== null) {\r\n                    this._bones.push(bone);\r\n                }\r\n            }\r\n            if (data.rotateMode === 2 /* ChainScale */) {\r\n                this._boneLengths.length = this._bones.length;\r\n            }\r\n            this._root._hasConstraint = true;\r\n        };\r\n        PathConstraint.prototype.update = function () {\r\n            var pathSlot = this._pathSlot;\r\n            if (pathSlot._geometryData === null ||\r\n                pathSlot._geometryData.offset !== this.pathOffset) {\r\n                return;\r\n            }\r\n            var constraintData = this._constraintData;\r\n            //\r\n            //曲线节点数据改变:父亲bone改变，权重bones改变，变形顶点改变\r\n            var isPathVerticeDirty = false;\r\n            if (this._root._childrenTransformDirty) {\r\n                this._updatePathVertices(pathSlot._geometryData);\r\n                isPathVerticeDirty = true;\r\n            }\r\n            else if (pathSlot._verticesDirty || pathSlot._isBonesUpdate()) {\r\n                this._updatePathVertices(pathSlot._geometryData);\r\n                pathSlot._verticesDirty = false;\r\n                isPathVerticeDirty = true;\r\n            }\r\n            if (!isPathVerticeDirty && !this.dirty) {\r\n                return;\r\n            }\r\n            //\r\n            var positionMode = constraintData.positionMode;\r\n            var spacingMode = constraintData.spacingMode;\r\n            var rotateMode = constraintData.rotateMode;\r\n            var bones = this._bones;\r\n            var isLengthMode = spacingMode === 0 /* Length */;\r\n            var isChainScaleMode = rotateMode === 2 /* ChainScale */;\r\n            var isTangentMode = rotateMode === 0 /* Tangent */;\r\n            var boneCount = bones.length;\r\n            var spacesCount = isTangentMode ? boneCount : boneCount + 1;\r\n            var spacing = this.spacing;\r\n            var spaces = this._spaces;\r\n            spaces.length = spacesCount;\r\n            //计曲线间隔和长度\r\n            if (isChainScaleMode || isLengthMode) {\r\n                //Bone改变和spacing改变触发\r\n                spaces[0] = 0;\r\n                for (var i = 0, l = spacesCount - 1; i < l; i++) {\r\n                    var bone = bones[i];\r\n                    bone.updateByConstraint();\r\n                    var boneLength = bone._boneData.length;\r\n                    var matrix = bone.globalTransformMatrix;\r\n                    var x = boneLength * matrix.a;\r\n                    var y = boneLength * matrix.b;\r\n                    var len = Math.sqrt(x * x + y * y);\r\n                    if (isChainScaleMode) {\r\n                        this._boneLengths[i] = len;\r\n                    }\r\n                    spaces[i + 1] = (boneLength + spacing) * len / boneLength;\r\n                }\r\n            }\r\n            else {\r\n                for (var i = 0; i < spacesCount; i++) {\r\n                    spaces[i] = spacing;\r\n                }\r\n            }\r\n            //\r\n            this._computeBezierCurve(pathSlot._displayFrame.rawDisplayData, spacesCount, isTangentMode, positionMode === 1 /* Percent */, spacingMode === 2 /* Percent */);\r\n            //根据新的节点数据重新采样\r\n            var positions = this._positions;\r\n            var rotateOffset = this.rotateOffset;\r\n            var boneX = positions[0], boneY = positions[1];\r\n            var tip;\r\n            if (rotateOffset === 0) {\r\n                tip = rotateMode === 1 /* Chain */;\r\n            }\r\n            else {\r\n                tip = false;\r\n                var bone = pathSlot.parent;\r\n                if (bone !== null) {\r\n                    var matrix = bone.globalTransformMatrix;\r\n                    rotateOffset *= matrix.a * matrix.d - matrix.b * matrix.c > 0 ? dragonBones.Transform.DEG_RAD : -dragonBones.Transform.DEG_RAD;\r\n                }\r\n            }\r\n            //\r\n            var rotateMix = this.rotateMix;\r\n            var translateMix = this.translateMix;\r\n            for (var i = 0, p = 3; i < boneCount; i++, p += 3) {\r\n                var bone = bones[i];\r\n                bone.updateByConstraint();\r\n                var matrix = bone.globalTransformMatrix;\r\n                matrix.tx += (boneX - matrix.tx) * translateMix;\r\n                matrix.ty += (boneY - matrix.ty) * translateMix;\r\n                var x = positions[p], y = positions[p + 1];\r\n                var dx = x - boneX, dy = y - boneY;\r\n                if (isChainScaleMode) {\r\n                    var lenght = this._boneLengths[i];\r\n                    var s = (Math.sqrt(dx * dx + dy * dy) / lenght - 1) * rotateMix + 1;\r\n                    matrix.a *= s;\r\n                    matrix.b *= s;\r\n                }\r\n                boneX = x;\r\n                boneY = y;\r\n                if (rotateMix > 0) {\r\n                    var a = matrix.a, b = matrix.b, c = matrix.c, d = matrix.d, r = void 0, cos = void 0, sin = void 0;\r\n                    if (isTangentMode) {\r\n                        r = positions[p - 1];\r\n                    }\r\n                    else {\r\n                        r = Math.atan2(dy, dx);\r\n                    }\r\n                    r -= Math.atan2(b, a);\r\n                    if (tip) {\r\n                        cos = Math.cos(r);\r\n                        sin = Math.sin(r);\r\n                        var length_3 = bone._boneData.length;\r\n                        boneX += (length_3 * (cos * a - sin * b) - dx) * rotateMix;\r\n                        boneY += (length_3 * (sin * a + cos * b) - dy) * rotateMix;\r\n                    }\r\n                    else {\r\n                        r += rotateOffset;\r\n                    }\r\n                    if (r > dragonBones.Transform.PI) {\r\n                        r -= dragonBones.Transform.PI_D;\r\n                    }\r\n                    else if (r < -dragonBones.Transform.PI) {\r\n                        r += dragonBones.Transform.PI_D;\r\n                    }\r\n                    r *= rotateMix;\r\n                    cos = Math.cos(r);\r\n                    sin = Math.sin(r);\r\n                    matrix.a = cos * a - sin * b;\r\n                    matrix.b = sin * a + cos * b;\r\n                    matrix.c = cos * c - sin * d;\r\n                    matrix.d = sin * c + cos * d;\r\n                }\r\n                bone.global.fromMatrix(matrix);\r\n            }\r\n            this.dirty = false;\r\n        };\r\n        PathConstraint.prototype.invalidUpdate = function () {\r\n        };\r\n        return PathConstraint;\r\n    }(Constraint));\r\n    dragonBones.PathConstraint = PathConstraint;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - Worldclock provides clock support for animations, advance time for each IAnimatable object added to the instance.\r\n     * @see dragonBones.IAnimateble\r\n     * @see dragonBones.Armature\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - WorldClock 对动画提供时钟支持，为每个加入到该实例的 IAnimatable 对象更新时间。\r\n     * @see dragonBones.IAnimateble\r\n     * @see dragonBones.Armature\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var WorldClock = /** @class */ (function () {\r\n        /**\r\n         * - Creating a Worldclock instance. Typically, you do not need to create Worldclock instance.\r\n         * When multiple Worldclock instances are running at different speeds, can achieving some specific animation effects, such as bullet time.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 创建一个 WorldClock 实例。通常并不需要创建 WorldClock 实例。\r\n         * 当多个 WorldClock 实例使用不同的速度运行时，可以实现一些特殊的动画效果，比如子弹时间等。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        function WorldClock(time) {\r\n            if (time === void 0) { time = 0.0; }\r\n            /**\r\n             * - Current time. (In seconds)\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 当前的时间。 (以秒为单位)\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            this.time = 0.0;\r\n            /**\r\n             * - The play speed, used to control animation speed-shift play.\r\n             * [0: Stop play, (0~1): Slow play, 1: Normal play, (1~N): Fast play]\r\n             * @default 1.0\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 播放速度，用于控制动画变速播放。\r\n             * [0: 停止播放, (0~1): 慢速播放, 1: 正常播放, (1~N): 快速播放]\r\n             * @default 1.0\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            this.timeScale = 1.0;\r\n            this._systemTime = 0.0;\r\n            this._animatebles = [];\r\n            this._clock = null;\r\n            this.time = time;\r\n            this._systemTime = new Date().getTime() * 0.001;\r\n        }\r\n        /**\r\n         * - Advance time for all IAnimatable instances.\r\n         * @param passedTime - Passed time. [-1: Automatically calculates the time difference between the current frame and the previous frame, [0~N): Passed time] (In seconds)\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 为所有的 IAnimatable 实例更新时间。\r\n         * @param passedTime - 前进的时间。 [-1: 自动计算当前帧与上一帧的时间差, [0~N): 前进的时间] (以秒为单位)\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        WorldClock.prototype.advanceTime = function (passedTime) {\r\n            if (passedTime !== passedTime) {\r\n                passedTime = 0.0;\r\n            }\r\n            var currentTime = Date.now() * 0.001;\r\n            if (passedTime < 0.0) {\r\n                passedTime = currentTime - this._systemTime;\r\n            }\r\n            this._systemTime = currentTime;\r\n            if (this.timeScale !== 1.0) {\r\n                passedTime *= this.timeScale;\r\n            }\r\n            if (passedTime === 0.0) {\r\n                return;\r\n            }\r\n            if (passedTime < 0.0) {\r\n                this.time -= passedTime;\r\n            }\r\n            else {\r\n                this.time += passedTime;\r\n            }\r\n            var i = 0, r = 0, l = this._animatebles.length;\r\n            for (; i < l; ++i) {\r\n                var animatable = this._animatebles[i];\r\n                if (animatable !== null) {\r\n                    if (r > 0) {\r\n                        this._animatebles[i - r] = animatable;\r\n                        this._animatebles[i] = null;\r\n                    }\r\n                    animatable.advanceTime(passedTime);\r\n                }\r\n                else {\r\n                    r++;\r\n                }\r\n            }\r\n            if (r > 0) {\r\n                l = this._animatebles.length;\r\n                for (; i < l; ++i) {\r\n                    var animateble = this._animatebles[i];\r\n                    if (animateble !== null) {\r\n                        this._animatebles[i - r] = animateble;\r\n                    }\r\n                    else {\r\n                        r++;\r\n                    }\r\n                }\r\n                this._animatebles.length -= r;\r\n            }\r\n        };\r\n        /**\r\n         * - Check whether contains a specific instance of IAnimatable.\r\n         * @param value - The IAnimatable instance.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查是否包含特定的 IAnimatable 实例。\r\n         * @param value - IAnimatable 实例。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        WorldClock.prototype.contains = function (value) {\r\n            if (value === this) {\r\n                return false;\r\n            }\r\n            var ancestor = value;\r\n            while (ancestor !== this && ancestor !== null) {\r\n                ancestor = ancestor.clock;\r\n            }\r\n            return ancestor === this;\r\n        };\r\n        /**\r\n         * - Add IAnimatable instance.\r\n         * @param value - The IAnimatable instance.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 添加 IAnimatable 实例。\r\n         * @param value - IAnimatable 实例。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        WorldClock.prototype.add = function (value) {\r\n            if (this._animatebles.indexOf(value) < 0) {\r\n                this._animatebles.push(value);\r\n                value.clock = this;\r\n            }\r\n        };\r\n        /**\r\n         * - Removes a specified IAnimatable instance.\r\n         * @param value - The IAnimatable instance.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 移除特定的 IAnimatable 实例。\r\n         * @param value - IAnimatable 实例。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        WorldClock.prototype.remove = function (value) {\r\n            var index = this._animatebles.indexOf(value);\r\n            if (index >= 0) {\r\n                this._animatebles[index] = null;\r\n                value.clock = null;\r\n            }\r\n        };\r\n        /**\r\n         * - Clear all IAnimatable instances.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 清除所有的 IAnimatable 实例。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        WorldClock.prototype.clear = function () {\r\n            for (var _i = 0, _a = this._animatebles; _i < _a.length; _i++) {\r\n                var animatable = _a[_i];\r\n                if (animatable !== null) {\r\n                    animatable.clock = null;\r\n                }\r\n            }\r\n        };\r\n        Object.defineProperty(WorldClock.prototype, "clock", {\r\n            /**\r\n             * @inheritDoc\r\n             */\r\n            get: function () {\r\n                return this._clock;\r\n            },\r\n            set: function (value) {\r\n                if (this._clock === value) {\r\n                    return;\r\n                }\r\n                if (this._clock !== null) {\r\n                    this._clock.remove(this);\r\n                }\r\n                this._clock = value;\r\n                if (this._clock !== null) {\r\n                    this._clock.add(this);\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return WorldClock;\r\n    }());\r\n    dragonBones.WorldClock = WorldClock;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The animation player is used to play the animation data and manage the animation states.\r\n     * @see dragonBones.AnimationData\r\n     * @see dragonBones.AnimationState\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 动画播放器用来播放动画数据和管理动画状态。\r\n     * @see dragonBones.AnimationData\r\n     * @see dragonBones.AnimationState\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var Animation = /** @class */ (function (_super) {\r\n        __extends(Animation, _super);\r\n        function Animation() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._animationNames = [];\r\n            _this._animationStates = [];\r\n            _this._animations = {};\r\n            _this._blendStates = {};\r\n            _this._animationConfig = null; // Initial value.\r\n            return _this;\r\n        }\r\n        Animation.toString = function () {\r\n            return "[class dragonBones.Animation]";\r\n        };\r\n        Animation.prototype._onClear = function () {\r\n            for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                var animationState = _a[_i];\r\n                animationState.returnToPool();\r\n            }\r\n            for (var k in this._animations) {\r\n                delete this._animations[k];\r\n            }\r\n            for (var k in this._blendStates) {\r\n                var blendStates = this._blendStates[k];\r\n                for (var kB in blendStates) {\r\n                    blendStates[kB].returnToPool();\r\n                }\r\n                delete this._blendStates[k];\r\n            }\r\n            if (this._animationConfig !== null) {\r\n                this._animationConfig.returnToPool();\r\n            }\r\n            this.timeScale = 1.0;\r\n            this._animationDirty = false;\r\n            this._inheritTimeScale = 1.0;\r\n            this._animationNames.length = 0;\r\n            this._animationStates.length = 0;\r\n            //this._animations.clear();\r\n            this._armature = null; //\r\n            this._animationConfig = null; //\r\n            this._lastAnimationState = null;\r\n        };\r\n        Animation.prototype._fadeOut = function (animationConfig) {\r\n            switch (animationConfig.fadeOutMode) {\r\n                case 1 /* SameLayer */:\r\n                    for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                        var animationState = _a[_i];\r\n                        if (animationState._parent !== null) {\r\n                            continue;\r\n                        }\r\n                        if (animationState.layer === animationConfig.layer) {\r\n                            animationState.fadeOut(animationConfig.fadeOutTime, animationConfig.pauseFadeOut);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 2 /* SameGroup */:\r\n                    for (var _b = 0, _c = this._animationStates; _b < _c.length; _b++) {\r\n                        var animationState = _c[_b];\r\n                        if (animationState._parent !== null) {\r\n                            continue;\r\n                        }\r\n                        if (animationState.group === animationConfig.group) {\r\n                            animationState.fadeOut(animationConfig.fadeOutTime, animationConfig.pauseFadeOut);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 3 /* SameLayerAndGroup */:\r\n                    for (var _d = 0, _e = this._animationStates; _d < _e.length; _d++) {\r\n                        var animationState = _e[_d];\r\n                        if (animationState._parent !== null) {\r\n                            continue;\r\n                        }\r\n                        if (animationState.layer === animationConfig.layer &&\r\n                            animationState.group === animationConfig.group) {\r\n                            animationState.fadeOut(animationConfig.fadeOutTime, animationConfig.pauseFadeOut);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 4 /* All */:\r\n                    for (var _f = 0, _g = this._animationStates; _f < _g.length; _f++) {\r\n                        var animationState = _g[_f];\r\n                        if (animationState._parent !== null) {\r\n                            continue;\r\n                        }\r\n                        animationState.fadeOut(animationConfig.fadeOutTime, animationConfig.pauseFadeOut);\r\n                    }\r\n                    break;\r\n                case 5 /* Single */: // TODO\r\n                default:\r\n                    break;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Animation.prototype.init = function (armature) {\r\n            if (this._armature !== null) {\r\n                return;\r\n            }\r\n            this._armature = armature;\r\n            this._animationConfig = dragonBones.BaseObject.borrowObject(dragonBones.AnimationConfig);\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Animation.prototype.advanceTime = function (passedTime) {\r\n            if (passedTime < 0.0) { // Only animationState can reverse play.\r\n                passedTime = -passedTime;\r\n            }\r\n            if (this._armature.inheritAnimation && this._armature._parent !== null) { // Inherit parent animation timeScale.\r\n                this._inheritTimeScale = this._armature._parent._armature.animation._inheritTimeScale * this.timeScale;\r\n            }\r\n            else {\r\n                this._inheritTimeScale = this.timeScale;\r\n            }\r\n            if (this._inheritTimeScale !== 1.0) {\r\n                passedTime *= this._inheritTimeScale;\r\n            }\r\n            for (var k in this._blendStates) {\r\n                var blendStates = this._blendStates[k];\r\n                for (var kB in blendStates) {\r\n                    blendStates[kB].reset();\r\n                }\r\n            }\r\n            var animationStateCount = this._animationStates.length;\r\n            if (animationStateCount === 1) {\r\n                var animationState = this._animationStates[0];\r\n                if (animationState._fadeState > 0 && animationState._subFadeState > 0) {\r\n                    this._armature._dragonBones.bufferObject(animationState);\r\n                    this._animationStates.length = 0;\r\n                    this._lastAnimationState = null;\r\n                }\r\n                else {\r\n                    var animationData = animationState.animationData;\r\n                    var cacheFrameRate = animationData.cacheFrameRate;\r\n                    if (this._animationDirty && cacheFrameRate > 0.0) { // Update cachedFrameIndices.\r\n                        this._animationDirty = false;\r\n                        for (var _i = 0, _a = this._armature.getBones(); _i < _a.length; _i++) {\r\n                            var bone = _a[_i];\r\n                            bone._cachedFrameIndices = animationData.getBoneCachedFrameIndices(bone.name);\r\n                        }\r\n                        for (var _b = 0, _c = this._armature.getSlots(); _b < _c.length; _b++) {\r\n                            var slot = _c[_b];\r\n                            if (slot.displayFrameCount > 0) {\r\n                                var rawDisplayData = slot.getDisplayFrameAt(0).rawDisplayData;\r\n                                if (rawDisplayData !== null &&\r\n                                    rawDisplayData.parent === this._armature.armatureData.defaultSkin) {\r\n                                    slot._cachedFrameIndices = animationData.getSlotCachedFrameIndices(slot.name);\r\n                                    continue;\r\n                                }\r\n                            }\r\n                            slot._cachedFrameIndices = null;\r\n                        }\r\n                    }\r\n                    animationState.advanceTime(passedTime, cacheFrameRate);\r\n                }\r\n            }\r\n            else if (animationStateCount > 1) {\r\n                for (var i = 0, r = 0; i < animationStateCount; ++i) {\r\n                    var animationState = this._animationStates[i];\r\n                    if (animationState._fadeState > 0 && animationState._subFadeState > 0) {\r\n                        r++;\r\n                        this._armature._dragonBones.bufferObject(animationState);\r\n                        this._animationDirty = true;\r\n                        if (this._lastAnimationState === animationState) { // Update last animation state.\r\n                            this._lastAnimationState = null;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (r > 0) {\r\n                            this._animationStates[i - r] = animationState;\r\n                        }\r\n                        animationState.advanceTime(passedTime, 0.0);\r\n                    }\r\n                    if (i === animationStateCount - 1 && r > 0) { // Modify animation states size.\r\n                        this._animationStates.length -= r;\r\n                        if (this._lastAnimationState === null && this._animationStates.length > 0) {\r\n                            this._lastAnimationState = this._animationStates[this._animationStates.length - 1];\r\n                        }\r\n                    }\r\n                }\r\n                this._armature._cacheFrameIndex = -1;\r\n            }\r\n            else {\r\n                this._armature._cacheFrameIndex = -1;\r\n            }\r\n        };\r\n        /**\r\n         * - Clear all animations states.\r\n         * @see dragonBones.AnimationState\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 清除所有的动画状态。\r\n         * @see dragonBones.AnimationState\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.reset = function () {\r\n            for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                var animationState = _a[_i];\r\n                animationState.returnToPool();\r\n            }\r\n            this._animationDirty = false;\r\n            this._animationConfig.clear();\r\n            this._animationStates.length = 0;\r\n            this._lastAnimationState = null;\r\n        };\r\n        /**\r\n         * - Pause a specific animation state.\r\n         * @param animationName - The name of animation state. (If not set, it will pause all animations)\r\n         * @see dragonBones.AnimationState\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 暂停指定动画状态的播放。\r\n         * @param animationName - 动画状态名称。 （如果未设置，则暂停所有动画）\r\n         * @see dragonBones.AnimationState\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.stop = function (animationName) {\r\n            if (animationName === void 0) { animationName = null; }\r\n            if (animationName !== null) {\r\n                var animationState = this.getState(animationName);\r\n                if (animationState !== null) {\r\n                    animationState.stop();\r\n                }\r\n            }\r\n            else {\r\n                for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                    var animationState = _a[_i];\r\n                    animationState.stop();\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Play animation with a specific animation config.\r\n         * The API is still in the experimental phase and may encounter bugs or stability or compatibility issues when used.\r\n         * @param animationConfig - The animation config.\r\n         * @returns The playing animation state.\r\n         * @see dragonBones.AnimationConfig\r\n         * @beta\r\n         * @version DragonBones 5.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 通过指定的动画配置来播放动画。\r\n         * 该 API 仍在实验阶段，使用时可能遭遇 bug 或稳定性或兼容性问题。\r\n         * @param animationConfig - 动画配置。\r\n         * @returns 播放的动画状态。\r\n         * @see dragonBones.AnimationConfig\r\n         * @beta\r\n         * @version DragonBones 5.0\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.playConfig = function (animationConfig) {\r\n            var animationName = animationConfig.animation;\r\n            if (!(animationName in this._animations)) {\r\n                console.warn("Non-existent animation.\\n", "DragonBones name: " + this._armature.armatureData.parent.name, "Armature name: " + this._armature.name, "Animation name: " + animationName);\r\n                return null;\r\n            }\r\n            var animationData = this._animations[animationName];\r\n            if (animationConfig.fadeOutMode === 5 /* Single */) {\r\n                for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                    var animationState_1 = _a[_i];\r\n                    if (animationState_1._fadeState < 1 &&\r\n                        animationState_1.layer === animationConfig.layer &&\r\n                        animationState_1.animationData === animationData) {\r\n                        return animationState_1;\r\n                    }\r\n                }\r\n            }\r\n            if (this._animationStates.length === 0) {\r\n                animationConfig.fadeInTime = 0.0;\r\n            }\r\n            else if (animationConfig.fadeInTime < 0.0) {\r\n                animationConfig.fadeInTime = animationData.fadeInTime;\r\n            }\r\n            if (animationConfig.fadeOutTime < 0.0) {\r\n                animationConfig.fadeOutTime = animationConfig.fadeInTime;\r\n            }\r\n            if (animationConfig.timeScale <= -100.0) {\r\n                animationConfig.timeScale = 1.0 / animationData.scale;\r\n            }\r\n            if (animationData.frameCount > 0) {\r\n                if (animationConfig.position < 0.0) {\r\n                    animationConfig.position %= animationData.duration;\r\n                    animationConfig.position = animationData.duration - animationConfig.position;\r\n                }\r\n                else if (animationConfig.position === animationData.duration) {\r\n                    animationConfig.position -= 0.000001; // Play a little time before end.\r\n                }\r\n                else if (animationConfig.position > animationData.duration) {\r\n                    animationConfig.position %= animationData.duration;\r\n                }\r\n                if (animationConfig.duration > 0.0 && animationConfig.position + animationConfig.duration > animationData.duration) {\r\n                    animationConfig.duration = animationData.duration - animationConfig.position;\r\n                }\r\n                if (animationConfig.playTimes < 0) {\r\n                    animationConfig.playTimes = animationData.playTimes;\r\n                }\r\n            }\r\n            else {\r\n                animationConfig.playTimes = 1;\r\n                animationConfig.position = 0.0;\r\n                if (animationConfig.duration > 0.0) {\r\n                    animationConfig.duration = 0.0;\r\n                }\r\n            }\r\n            if (animationConfig.duration === 0.0) {\r\n                animationConfig.duration = -1.0;\r\n            }\r\n            this._fadeOut(animationConfig);\r\n            //\r\n            var animationState = dragonBones.BaseObject.borrowObject(dragonBones.AnimationState);\r\n            animationState.init(this._armature, animationData, animationConfig);\r\n            this._animationDirty = true;\r\n            this._armature._cacheFrameIndex = -1;\r\n            if (this._animationStates.length > 0) { // Sort animation state.\r\n                var added = false;\r\n                for (var i = 0, l = this._animationStates.length; i < l; ++i) {\r\n                    if (animationState.layer > this._animationStates[i].layer) {\r\n                        added = true;\r\n                        this._animationStates.splice(i, 0, animationState);\r\n                        break;\r\n                    }\r\n                    else if (i !== l - 1 && animationState.layer > this._animationStates[i + 1].layer) {\r\n                        added = true;\r\n                        this._animationStates.splice(i + 1, 0, animationState);\r\n                        break;\r\n                    }\r\n                }\r\n                if (!added) {\r\n                    this._animationStates.push(animationState);\r\n                }\r\n            }\r\n            else {\r\n                this._animationStates.push(animationState);\r\n            }\r\n            for (var _b = 0, _c = this._armature.getSlots(); _b < _c.length; _b++) { // Child armature play same name animation.\r\n                var slot = _c[_b];\r\n                var childArmature = slot.childArmature;\r\n                if (childArmature !== null && childArmature.inheritAnimation &&\r\n                    childArmature.animation.hasAnimation(animationName) &&\r\n                    childArmature.animation.getState(animationName) === null) {\r\n                    childArmature.animation.fadeIn(animationName); //\r\n                }\r\n            }\r\n            for (var k in animationData.animationTimelines) { // Blend animation node.\r\n                var childAnimationState = this.fadeIn(k, 0.0, 1, animationState.layer, "", 5 /* Single */);\r\n                if (childAnimationState === null) {\r\n                    continue;\r\n                }\r\n                var timelines = animationData.animationTimelines[k];\r\n                childAnimationState.actionEnabled = false;\r\n                childAnimationState.resetToPose = false;\r\n                childAnimationState.stop();\r\n                animationState.addState(childAnimationState, timelines);\r\n                //\r\n                var index = this._animationStates.indexOf(animationState);\r\n                var childIndex = this._animationStates.indexOf(childAnimationState);\r\n                if (childIndex < index) {\r\n                    this._animationStates.splice(index, 1);\r\n                    this._animationStates.splice(childIndex, 0, animationState);\r\n                }\r\n            }\r\n            // if (!this._armature._lockUpdate && animationConfig.fadeInTime <= 0.0) { // Blend animation state, update armature.\r\n            //     this._armature.advanceTime(0.0);\r\n            // }\r\n            this._lastAnimationState = animationState;\r\n            return animationState;\r\n        };\r\n        /**\r\n         * - Play a specific animation.\r\n         * @param animationName - The name of animation data. (If not set, The default animation will be played, or resume the animation playing from pause status, or replay the last playing animation)\r\n         * @param playTimes - Playing repeat times. [-1: Use default value of the animation data, 0: No end loop playing, [1~N]: Repeat N times] (default: -1)\r\n         * @returns The playing animation state.\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.play("walk");\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 播放指定动画。\r\n         * @param animationName - 动画数据名称。 （如果未设置，则播放默认动画，或将暂停状态切换为播放状态，或重新播放之前播放的动画）\r\n         * @param playTimes - 循环播放次数。 [-1: 使用动画数据默认值, 0: 无限循环播放, [1~N]: 循环播放 N 次] （默认: -1）\r\n         * @returns 播放的动画状态。\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.play("walk");\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.play = function (animationName, playTimes) {\r\n            if (animationName === void 0) { animationName = null; }\r\n            if (playTimes === void 0) { playTimes = -1; }\r\n            this._animationConfig.clear();\r\n            this._animationConfig.resetToPose = true;\r\n            this._animationConfig.playTimes = playTimes;\r\n            this._animationConfig.fadeInTime = 0.0;\r\n            this._animationConfig.animation = animationName !== null ? animationName : "";\r\n            if (animationName !== null && animationName.length > 0) {\r\n                this.playConfig(this._animationConfig);\r\n            }\r\n            else if (this._lastAnimationState === null) {\r\n                var defaultAnimation = this._armature.armatureData.defaultAnimation;\r\n                if (defaultAnimation !== null) {\r\n                    this._animationConfig.animation = defaultAnimation.name;\r\n                    this.playConfig(this._animationConfig);\r\n                }\r\n            }\r\n            else if (!this._lastAnimationState.isPlaying && !this._lastAnimationState.isCompleted) {\r\n                this._lastAnimationState.play();\r\n            }\r\n            else {\r\n                this._animationConfig.animation = this._lastAnimationState.name;\r\n                this.playConfig(this._animationConfig);\r\n            }\r\n            return this._lastAnimationState;\r\n        };\r\n        /**\r\n         * - Fade in a specific animation.\r\n         * @param animationName - The name of animation data.\r\n         * @param fadeInTime - The fade in time. [-1: Use the default value of animation data, [0~N]: The fade in time (In seconds)] (Default: -1)\r\n         * @param playTimes - playing repeat times. [-1: Use the default value of animation data, 0: No end loop playing, [1~N]: Repeat N times] (Default: -1)\r\n         * @param layer - The blending layer, the animation states in high level layer will get the blending weights with high priority, when the total blending weights are more than 1.0, there will be no more weights can be allocated to the other animation states. (Default: 0)\r\n         * @param group - The blending group name, it is typically used to specify the substitution of multiple animation states blending. (Default: null)\r\n         * @param fadeOutMode - The fade out mode, which is typically used to specify alternate mode of multiple animation states blending. (Default: AnimationFadeOutMode.SameLayerAndGroup)\r\n         * @returns The playing animation state.\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.fadeIn("walk", 0.3, 0, 0, "normalGroup").resetToPose = false;\r\n         *     armature.animation.fadeIn("attack", 0.3, 1, 0, "attackGroup").resetToPose = false;\r\n         * </pre>\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 淡入播放指定的动画。\r\n         * @param animationName - 动画数据名称。\r\n         * @param fadeInTime - 淡入时间。 [-1: 使用动画数据默认值, [0~N]: 淡入时间 (以秒为单位)] （默认: -1）\r\n         * @param playTimes - 播放次数。 [-1: 使用动画数据默认值, 0: 无限循环播放, [1~N]: 循环播放 N 次] （默认: -1）\r\n         * @param layer - 混合图层，图层高的动画状态会优先获取混合权重，当混合权重分配总和超过 1.0 时，剩余的动画状态将不能再获得权重分配。 （默认: 0）\r\n         * @param group - 混合组名称，该属性通常用来指定多个动画状态混合时的相互替换关系。 （默认: null）\r\n         * @param fadeOutMode - 淡出模式，该属性通常用来指定多个动画状态混合时的相互替换模式。 （默认: AnimationFadeOutMode.SameLayerAndGroup）\r\n         * @returns 播放的动画状态。\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.fadeIn("walk", 0.3, 0, 0, "normalGroup").resetToPose = false;\r\n         *     armature.animation.fadeIn("attack", 0.3, 1, 0, "attackGroup").resetToPose = false;\r\n         * </pre>\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.fadeIn = function (animationName, fadeInTime, playTimes, layer, group, fadeOutMode) {\r\n            if (fadeInTime === void 0) { fadeInTime = -1.0; }\r\n            if (playTimes === void 0) { playTimes = -1; }\r\n            if (layer === void 0) { layer = 0; }\r\n            if (group === void 0) { group = null; }\r\n            if (fadeOutMode === void 0) { fadeOutMode = 3 /* SameLayerAndGroup */; }\r\n            this._animationConfig.clear();\r\n            this._animationConfig.fadeOutMode = fadeOutMode;\r\n            this._animationConfig.playTimes = playTimes;\r\n            this._animationConfig.layer = layer;\r\n            this._animationConfig.fadeInTime = fadeInTime;\r\n            this._animationConfig.animation = animationName;\r\n            this._animationConfig.group = group !== null ? group : "";\r\n            return this.playConfig(this._animationConfig);\r\n        };\r\n        /**\r\n         * - Play a specific animation from the specific time.\r\n         * @param animationName - The name of animation data.\r\n         * @param time - The start time point of playing. (In seconds)\r\n         * @param playTimes - Playing repeat times. [-1: Use the default value of animation data, 0: No end loop playing, [1~N]: Repeat N times] (Default: -1)\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 从指定时间开始播放指定的动画。\r\n         * @param animationName - 动画数据名称。\r\n         * @param time - 播放开始的时间。 (以秒为单位)\r\n         * @param playTimes - 循环播放次数。 [-1: 使用动画数据默认值, 0: 无限循环播放, [1~N]: 循环播放 N 次] （默认: -1）\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndPlayByTime = function (animationName, time, playTimes) {\r\n            if (time === void 0) { time = 0.0; }\r\n            if (playTimes === void 0) { playTimes = -1; }\r\n            this._animationConfig.clear();\r\n            this._animationConfig.resetToPose = true;\r\n            this._animationConfig.playTimes = playTimes;\r\n            this._animationConfig.position = time;\r\n            this._animationConfig.fadeInTime = 0.0;\r\n            this._animationConfig.animation = animationName;\r\n            return this.playConfig(this._animationConfig);\r\n        };\r\n        /**\r\n         * - Play a specific animation from the specific frame.\r\n         * @param animationName - The name of animation data.\r\n         * @param frame - The start frame of playing.\r\n         * @param playTimes - Playing repeat times. [-1: Use the default value of animation data, 0: No end loop playing, [1~N]: Repeat N times] (Default: -1)\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 从指定帧开始播放指定的动画。\r\n         * @param animationName - 动画数据名称。\r\n         * @param frame - 播放开始的帧数。\r\n         * @param playTimes - 播放次数。 [-1: 使用动画数据默认值, 0: 无限循环播放, [1~N]: 循环播放 N 次] （默认: -1）\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndPlayByFrame = function (animationName, frame, playTimes) {\r\n            if (frame === void 0) { frame = 0; }\r\n            if (playTimes === void 0) { playTimes = -1; }\r\n            this._animationConfig.clear();\r\n            this._animationConfig.resetToPose = true;\r\n            this._animationConfig.playTimes = playTimes;\r\n            this._animationConfig.fadeInTime = 0.0;\r\n            this._animationConfig.animation = animationName;\r\n            var animationData = animationName in this._animations ? this._animations[animationName] : null;\r\n            if (animationData !== null) {\r\n                this._animationConfig.position = animationData.frameCount > 0 ? animationData.duration * frame / animationData.frameCount : 0.0;\r\n            }\r\n            return this.playConfig(this._animationConfig);\r\n        };\r\n        /**\r\n         * - Play a specific animation from the specific progress.\r\n         * @param animationName - The name of animation data.\r\n         * @param progress - The start progress value of playing.\r\n         * @param playTimes - Playing repeat times. [-1: Use the default value of animation data, 0: No end loop playing, [1~N]: Repeat N times] (Default: -1)\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 从指定进度开始播放指定的动画。\r\n         * @param animationName - 动画数据名称。\r\n         * @param progress - 开始播放的进度。\r\n         * @param playTimes - 播放次数。 [-1: 使用动画数据默认值, 0: 无限循环播放, [1~N]: 循环播放 N 次] （默认: -1）\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndPlayByProgress = function (animationName, progress, playTimes) {\r\n            if (progress === void 0) { progress = 0.0; }\r\n            if (playTimes === void 0) { playTimes = -1; }\r\n            this._animationConfig.clear();\r\n            this._animationConfig.resetToPose = true;\r\n            this._animationConfig.playTimes = playTimes;\r\n            this._animationConfig.fadeInTime = 0.0;\r\n            this._animationConfig.animation = animationName;\r\n            var animationData = animationName in this._animations ? this._animations[animationName] : null;\r\n            if (animationData !== null) {\r\n                this._animationConfig.position = animationData.duration * (progress > 0.0 ? progress : 0.0);\r\n            }\r\n            return this.playConfig(this._animationConfig);\r\n        };\r\n        /**\r\n         * - Stop a specific animation at the specific time.\r\n         * @param animationName - The name of animation data.\r\n         * @param time - The stop time. (In seconds)\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 在指定时间停止指定动画播放\r\n         * @param animationName - 动画数据名称。\r\n         * @param time - 停止的时间。 (以秒为单位)\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndStopByTime = function (animationName, time) {\r\n            if (time === void 0) { time = 0.0; }\r\n            var animationState = this.gotoAndPlayByTime(animationName, time, 1);\r\n            if (animationState !== null) {\r\n                animationState.stop();\r\n            }\r\n            return animationState;\r\n        };\r\n        /**\r\n         * - Stop a specific animation at the specific frame.\r\n         * @param animationName - The name of animation data.\r\n         * @param frame - The stop frame.\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 在指定帧停止指定动画的播放\r\n         * @param animationName - 动画数据名称。\r\n         * @param frame - 停止的帧数。\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndStopByFrame = function (animationName, frame) {\r\n            if (frame === void 0) { frame = 0; }\r\n            var animationState = this.gotoAndPlayByFrame(animationName, frame, 1);\r\n            if (animationState !== null) {\r\n                animationState.stop();\r\n            }\r\n            return animationState;\r\n        };\r\n        /**\r\n         * - Stop a specific animation at the specific progress.\r\n         * @param animationName - The name of animation data.\r\n         * @param progress - The stop progress value.\r\n         * @returns The played animation state.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 在指定的进度停止指定的动画播放。\r\n         * @param animationName - 动画数据名称。\r\n         * @param progress - 停止进度。\r\n         * @returns 播放的动画状态。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.gotoAndStopByProgress = function (animationName, progress) {\r\n            if (progress === void 0) { progress = 0.0; }\r\n            var animationState = this.gotoAndPlayByProgress(animationName, progress, 1);\r\n            if (animationState !== null) {\r\n                animationState.stop();\r\n            }\r\n            return animationState;\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        Animation.prototype.getBlendState = function (type, name, target) {\r\n            if (!(type in this._blendStates)) {\r\n                this._blendStates[type] = {};\r\n            }\r\n            var blendStates = this._blendStates[type];\r\n            if (!(name in blendStates)) {\r\n                var blendState = blendStates[name] = dragonBones.BaseObject.borrowObject(dragonBones.BlendState);\r\n                blendState.target = target;\r\n            }\r\n            return blendStates[name];\r\n        };\r\n        /**\r\n         * - Get a specific animation state.\r\n         * @param animationName - The name of animation state.\r\n         * @param layer - The layer of find animation states. [-1: Find all layers, [0~N]: Specified layer] (default: -1)\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.play("walk");\r\n         *     let walkState = armature.animation.getState("walk");\r\n         *     walkState.timeScale = 0.5;\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取指定的动画状态。\r\n         * @param animationName - 动画状态名称。\r\n         * @param layer - 查找动画状态的层级。 [-1: 查找所有层级, [0~N]: 指定层级] （默认: -1）\r\n         * @example\r\n         * <pre>\r\n         *     armature.animation.play("walk");\r\n         *     let walkState = armature.animation.getState("walk");\r\n         *     walkState.timeScale = 0.5;\r\n         * </pre>\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.getState = function (animationName, layer) {\r\n            if (layer === void 0) { layer = -1; }\r\n            var i = this._animationStates.length;\r\n            while (i--) {\r\n                var animationState = this._animationStates[i];\r\n                if (animationState.name === animationName && (layer < 0 || animationState.layer === layer)) {\r\n                    return animationState;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        /**\r\n         * - Check whether a specific animation data is included.\r\n         * @param animationName - The name of animation data.\r\n         * @see dragonBones.AnimationData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查是否包含指定的动画数据\r\n         * @param animationName - 动画数据名称。\r\n         * @see dragonBones.AnimationData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.hasAnimation = function (animationName) {\r\n            return animationName in this._animations;\r\n        };\r\n        /**\r\n         * - Get all the animation states.\r\n         * @version DragonBones 5.1\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取所有的动画状态\r\n         * @version DragonBones 5.1\r\n         * @language zh_CN\r\n         */\r\n        Animation.prototype.getStates = function () {\r\n            return this._animationStates;\r\n        };\r\n        Object.defineProperty(Animation.prototype, "isPlaying", {\r\n            /**\r\n             * - Check whether there is an animation state is playing\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 检查是否有动画状态正在播放\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                    var animationState = _a[_i];\r\n                    if (animationState.isPlaying) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "isCompleted", {\r\n            /**\r\n             * - Check whether all the animation states\' playing were finished.\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 检查是否所有的动画状态均已播放完毕。\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                for (var _i = 0, _a = this._animationStates; _i < _a.length; _i++) {\r\n                    var animationState = _a[_i];\r\n                    if (!animationState.isCompleted) {\r\n                        return false;\r\n                    }\r\n                }\r\n                return this._animationStates.length > 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "lastAnimationName", {\r\n            /**\r\n             * - The name of the last playing animation state.\r\n             * @see #lastAnimationState\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 上一个播放的动画状态名称\r\n             * @see #lastAnimationState\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._lastAnimationState !== null ? this._lastAnimationState.name : "";\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "animationNames", {\r\n            /**\r\n             * - The name of all animation data\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所有动画数据的名称\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._animationNames;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "animations", {\r\n            /**\r\n             * - All animation data.\r\n             * @version DragonBones 4.5\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 所有的动画数据。\r\n             * @version DragonBones 4.5\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._animations;\r\n            },\r\n            set: function (value) {\r\n                if (this._animations === value) {\r\n                    return;\r\n                }\r\n                this._animationNames.length = 0;\r\n                for (var k in this._animations) {\r\n                    delete this._animations[k];\r\n                }\r\n                for (var k in value) {\r\n                    this._animationNames.push(k);\r\n                    this._animations[k] = value[k];\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "animationConfig", {\r\n            /**\r\n             * - An AnimationConfig instance that can be used quickly.\r\n             * @see dragonBones.AnimationConfig\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 一个可以快速使用的动画配置实例。\r\n             * @see dragonBones.AnimationConfig\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                this._animationConfig.clear();\r\n                return this._animationConfig;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(Animation.prototype, "lastAnimationState", {\r\n            /**\r\n             * - The last playing animation state\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 上一个播放的动画状态\r\n             * @see dragonBones.AnimationState\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._lastAnimationState;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return Animation;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.Animation = Animation;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The animation state is generated when the animation data is played.\r\n     * @see dragonBones.Animation\r\n     * @see dragonBones.AnimationData\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 动画状态由播放动画数据时产生。\r\n     * @see dragonBones.Animation\r\n     * @see dragonBones.AnimationData\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var AnimationState = /** @class */ (function (_super) {\r\n        __extends(AnimationState, _super);\r\n        function AnimationState() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._boneMask = [];\r\n            _this._boneTimelines = [];\r\n            _this._boneBlendTimelines = [];\r\n            _this._slotTimelines = [];\r\n            _this._slotBlendTimelines = [];\r\n            _this._constraintTimelines = [];\r\n            _this._animationTimelines = [];\r\n            _this._poseTimelines = [];\r\n            /**\r\n             * @internal\r\n             */\r\n            _this._actionTimeline = null; // Initial value.\r\n            _this._zOrderTimeline = null; // Initial value.\r\n            return _this;\r\n        }\r\n        AnimationState.toString = function () {\r\n            return "[class dragonBones.AnimationState]";\r\n        };\r\n        AnimationState.prototype._onClear = function () {\r\n            for (var _i = 0, _a = this._boneTimelines; _i < _a.length; _i++) {\r\n                var timeline = _a[_i];\r\n                timeline.returnToPool();\r\n            }\r\n            for (var _b = 0, _c = this._boneBlendTimelines; _b < _c.length; _b++) {\r\n                var timeline = _c[_b];\r\n                timeline.returnToPool();\r\n            }\r\n            for (var _d = 0, _e = this._slotTimelines; _d < _e.length; _d++) {\r\n                var timeline = _e[_d];\r\n                timeline.returnToPool();\r\n            }\r\n            for (var _f = 0, _g = this._slotBlendTimelines; _f < _g.length; _f++) {\r\n                var timeline = _g[_f];\r\n                timeline.returnToPool();\r\n            }\r\n            for (var _h = 0, _j = this._constraintTimelines; _h < _j.length; _h++) {\r\n                var timeline = _j[_h];\r\n                timeline.returnToPool();\r\n            }\r\n            for (var _k = 0, _l = this._animationTimelines; _k < _l.length; _k++) {\r\n                var timeline = _l[_k];\r\n                var animationState = timeline.target;\r\n                if (animationState._parent === this) {\r\n                    animationState._fadeState = 1;\r\n                    animationState._subFadeState = 1;\r\n                    animationState._parent = null;\r\n                }\r\n                timeline.returnToPool();\r\n            }\r\n            if (this._actionTimeline !== null) {\r\n                this._actionTimeline.returnToPool();\r\n            }\r\n            if (this._zOrderTimeline !== null) {\r\n                this._zOrderTimeline.returnToPool();\r\n            }\r\n            this.actionEnabled = false;\r\n            this.additive = false;\r\n            this.displayControl = false;\r\n            this.resetToPose = false;\r\n            this.blendType = 0 /* None */;\r\n            this.playTimes = 1;\r\n            this.layer = 0;\r\n            this.timeScale = 1.0;\r\n            this._weight = 1.0;\r\n            this.parameterX = 0.0;\r\n            this.parameterY = 0.0;\r\n            this.positionX = 0.0;\r\n            this.positionY = 0.0;\r\n            this.autoFadeOutTime = 0.0;\r\n            this.fadeTotalTime = 0.0;\r\n            this.name = "";\r\n            this.group = "";\r\n            this._timelineDirty = 2;\r\n            this._playheadState = 0;\r\n            this._fadeState = -1;\r\n            this._subFadeState = -1;\r\n            this._position = 0.0;\r\n            this._duration = 0.0;\r\n            this._fadeTime = 0.0;\r\n            this._time = 0.0;\r\n            this._fadeProgress = 0.0;\r\n            this._weightResult = 0.0;\r\n            this._boneMask.length = 0;\r\n            this._boneTimelines.length = 0;\r\n            this._boneBlendTimelines.length = 0;\r\n            this._slotTimelines.length = 0;\r\n            this._slotBlendTimelines.length = 0;\r\n            this._constraintTimelines.length = 0;\r\n            this._animationTimelines.length = 0;\r\n            this._poseTimelines.length = 0;\r\n            // this._bonePoses.clear();\r\n            this._animationData = null; //\r\n            this._armature = null; //\r\n            this._actionTimeline = null; //\r\n            this._zOrderTimeline = null;\r\n            this._activeChildA = null;\r\n            this._activeChildB = null;\r\n            this._parent = null;\r\n        };\r\n        AnimationState.prototype._updateTimelines = function () {\r\n            { // Update constraint timelines.\r\n                for (var _i = 0, _a = this._armature._constraints; _i < _a.length; _i++) {\r\n                    var constraint = _a[_i];\r\n                    var timelineDatas = this._animationData.getConstraintTimelines(constraint.name);\r\n                    if (timelineDatas !== null) {\r\n                        for (var _b = 0, timelineDatas_1 = timelineDatas; _b < timelineDatas_1.length; _b++) {\r\n                            var timelineData = timelineDatas_1[_b];\r\n                            switch (timelineData.type) {\r\n                                case 30 /* IKConstraint */: {\r\n                                    var timeline = dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintTimelineState);\r\n                                    timeline.target = constraint;\r\n                                    timeline.init(this._armature, this, timelineData);\r\n                                    this._constraintTimelines.push(timeline);\r\n                                    break;\r\n                                }\r\n                                default:\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (this.resetToPose) { // Pose timeline.\r\n                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintTimelineState);\r\n                        timeline.target = constraint;\r\n                        timeline.init(this._armature, this, null);\r\n                        this._constraintTimelines.push(timeline);\r\n                        this._poseTimelines.push(timeline);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        AnimationState.prototype._updateBoneAndSlotTimelines = function () {\r\n            { // Update bone and surface timelines.\r\n                var boneTimelines = {};\r\n                // Create bone timelines map.\r\n                for (var _i = 0, _a = this._boneTimelines; _i < _a.length; _i++) {\r\n                    var timeline = _a[_i];\r\n                    var timelineName = timeline.target.target.name;\r\n                    if (!(timelineName in boneTimelines)) {\r\n                        boneTimelines[timelineName] = [];\r\n                    }\r\n                    boneTimelines[timelineName].push(timeline);\r\n                }\r\n                for (var _b = 0, _c = this._boneBlendTimelines; _b < _c.length; _b++) {\r\n                    var timeline = _c[_b];\r\n                    var timelineName = timeline.target.target.name;\r\n                    if (!(timelineName in boneTimelines)) {\r\n                        boneTimelines[timelineName] = [];\r\n                    }\r\n                    boneTimelines[timelineName].push(timeline);\r\n                }\r\n                //\r\n                for (var _d = 0, _e = this._armature.getBones(); _d < _e.length; _d++) {\r\n                    var bone = _e[_d];\r\n                    var timelineName = bone.name;\r\n                    if (!this.containsBoneMask(timelineName)) {\r\n                        continue;\r\n                    }\r\n                    if (timelineName in boneTimelines) { // Remove bone timeline from map.\r\n                        delete boneTimelines[timelineName];\r\n                    }\r\n                    else { // Create new bone timeline.\r\n                        var timelineDatas = this._animationData.getBoneTimelines(timelineName);\r\n                        var blendState = this._armature.animation.getBlendState(BlendState.BONE_TRANSFORM, bone.name, bone);\r\n                        if (timelineDatas !== null) {\r\n                            for (var _f = 0, timelineDatas_2 = timelineDatas; _f < timelineDatas_2.length; _f++) {\r\n                                var timelineData = timelineDatas_2[_f];\r\n                                switch (timelineData.type) {\r\n                                    case 10 /* BoneAll */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.BoneAllTimelineState);\r\n                                        timeline.target = blendState;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 11 /* BoneTranslate */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.BoneTranslateTimelineState);\r\n                                        timeline.target = blendState;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 12 /* BoneRotate */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.BoneRotateTimelineState);\r\n                                        timeline.target = blendState;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 13 /* BoneScale */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.BoneScaleTimelineState);\r\n                                        timeline.target = blendState;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 60 /* BoneAlpha */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.AlphaTimelineState);\r\n                                        timeline.target = this._armature.animation.getBlendState(BlendState.BONE_ALPHA, bone.name, bone);\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneBlendTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 50 /* Surface */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SurfaceTimelineState);\r\n                                        timeline.target = this._armature.animation.getBlendState(BlendState.SURFACE, bone.name, bone);\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._boneBlendTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    default:\r\n                                        break;\r\n                                }\r\n                            }\r\n                        }\r\n                        else if (this.resetToPose) { // Pose timeline.\r\n                            if (bone._boneData.type === 0 /* Bone */) {\r\n                                var timeline = dragonBones.BaseObject.borrowObject(dragonBones.BoneAllTimelineState);\r\n                                timeline.target = blendState;\r\n                                timeline.init(this._armature, this, null);\r\n                                this._boneTimelines.push(timeline);\r\n                                this._poseTimelines.push(timeline);\r\n                            }\r\n                            else {\r\n                                var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SurfaceTimelineState);\r\n                                timeline.target = this._armature.animation.getBlendState(BlendState.SURFACE, bone.name, bone);\r\n                                timeline.init(this._armature, this, null);\r\n                                this._boneBlendTimelines.push(timeline);\r\n                                this._poseTimelines.push(timeline);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                for (var k in boneTimelines) { // Remove bone timelines.\r\n                    for (var _g = 0, _h = boneTimelines[k]; _g < _h.length; _g++) {\r\n                        var timeline = _h[_g];\r\n                        var index = this._boneTimelines.indexOf(timeline);\r\n                        if (index >= 0) {\r\n                            this._boneTimelines.splice(index, 1);\r\n                            timeline.returnToPool();\r\n                        }\r\n                        index = this._boneBlendTimelines.indexOf(timeline);\r\n                        if (index >= 0) {\r\n                            this._boneBlendTimelines.splice(index, 1);\r\n                            timeline.returnToPool();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            { // Update slot timelines.\r\n                var slotTimelines = {};\r\n                var ffdFlags = [];\r\n                // Create slot timelines map.\r\n                for (var _j = 0, _k = this._slotTimelines; _j < _k.length; _j++) {\r\n                    var timeline = _k[_j];\r\n                    var timelineName = timeline.target.name;\r\n                    if (!(timelineName in slotTimelines)) {\r\n                        slotTimelines[timelineName] = [];\r\n                    }\r\n                    slotTimelines[timelineName].push(timeline);\r\n                }\r\n                for (var _l = 0, _m = this._slotBlendTimelines; _l < _m.length; _l++) {\r\n                    var timeline = _m[_l];\r\n                    var timelineName = timeline.target.target.name;\r\n                    if (!(timelineName in slotTimelines)) {\r\n                        slotTimelines[timelineName] = [];\r\n                    }\r\n                    slotTimelines[timelineName].push(timeline);\r\n                }\r\n                //\r\n                for (var _o = 0, _p = this._armature.getSlots(); _o < _p.length; _o++) {\r\n                    var slot = _p[_o];\r\n                    var boneName = slot.parent.name;\r\n                    if (!this.containsBoneMask(boneName)) {\r\n                        continue;\r\n                    }\r\n                    var timelineName = slot.name;\r\n                    if (timelineName in slotTimelines) { // Remove slot timeline from map.\r\n                        delete slotTimelines[timelineName];\r\n                    }\r\n                    else { // Create new slot timeline.\r\n                        var displayIndexFlag = false;\r\n                        var colorFlag = false;\r\n                        ffdFlags.length = 0;\r\n                        var timelineDatas = this._animationData.getSlotTimelines(timelineName);\r\n                        if (timelineDatas !== null) {\r\n                            for (var _q = 0, timelineDatas_3 = timelineDatas; _q < timelineDatas_3.length; _q++) {\r\n                                var timelineData = timelineDatas_3[_q];\r\n                                switch (timelineData.type) {\r\n                                    case 20 /* SlotDisplay */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SlotDisplayTimelineState);\r\n                                        timeline.target = slot;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._slotTimelines.push(timeline);\r\n                                        displayIndexFlag = true;\r\n                                        break;\r\n                                    }\r\n                                    case 23 /* SlotZIndex */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SlotZIndexTimelineState);\r\n                                        timeline.target = this._armature.animation.getBlendState(BlendState.SLOT_Z_INDEX, slot.name, slot);\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._slotBlendTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    case 21 /* SlotColor */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SlotColorTimelineState);\r\n                                        timeline.target = slot;\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._slotTimelines.push(timeline);\r\n                                        colorFlag = true;\r\n                                        break;\r\n                                    }\r\n                                    case 22 /* SlotDeform */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.DeformTimelineState);\r\n                                        timeline.target = this._armature.animation.getBlendState(BlendState.SLOT_DEFORM, slot.name, slot);\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        if (timeline.target !== null) {\r\n                                            this._slotBlendTimelines.push(timeline);\r\n                                            ffdFlags.push(timeline.geometryOffset);\r\n                                        }\r\n                                        else {\r\n                                            timeline.returnToPool();\r\n                                        }\r\n                                        break;\r\n                                    }\r\n                                    case 24 /* SlotAlpha */: {\r\n                                        var timeline = dragonBones.BaseObject.borrowObject(dragonBones.AlphaTimelineState);\r\n                                        timeline.target = this._armature.animation.getBlendState(BlendState.SLOT_ALPHA, slot.name, slot);\r\n                                        timeline.init(this._armature, this, timelineData);\r\n                                        this._slotBlendTimelines.push(timeline);\r\n                                        break;\r\n                                    }\r\n                                    default:\r\n                                        break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (this.resetToPose) { // Pose timeline.\r\n                            if (!displayIndexFlag) {\r\n                                var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SlotDisplayTimelineState);\r\n                                timeline.target = slot;\r\n                                timeline.init(this._armature, this, null);\r\n                                this._slotTimelines.push(timeline);\r\n                                this._poseTimelines.push(timeline);\r\n                            }\r\n                            if (!colorFlag) {\r\n                                var timeline = dragonBones.BaseObject.borrowObject(dragonBones.SlotColorTimelineState);\r\n                                timeline.target = slot;\r\n                                timeline.init(this._armature, this, null);\r\n                                this._slotTimelines.push(timeline);\r\n                                this._poseTimelines.push(timeline);\r\n                            }\r\n                            for (var i = 0, l = slot.displayFrameCount; i < l; ++i) {\r\n                                var displayFrame = slot.getDisplayFrameAt(i);\r\n                                if (displayFrame.deformVertices.length === 0) {\r\n                                    continue;\r\n                                }\r\n                                var geometryData = displayFrame.getGeometryData();\r\n                                if (geometryData !== null && ffdFlags.indexOf(geometryData.offset) < 0) {\r\n                                    var timeline = dragonBones.BaseObject.borrowObject(dragonBones.DeformTimelineState);\r\n                                    timeline.geometryOffset = geometryData.offset; //\r\n                                    timeline.displayFrame = displayFrame; //\r\n                                    timeline.target = this._armature.animation.getBlendState(BlendState.SLOT_DEFORM, slot.name, slot);\r\n                                    timeline.init(this._armature, this, null);\r\n                                    this._slotBlendTimelines.push(timeline);\r\n                                    this._poseTimelines.push(timeline);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                for (var k in slotTimelines) { // Remove slot timelines.\r\n                    for (var _r = 0, _s = slotTimelines[k]; _r < _s.length; _r++) {\r\n                        var timeline = _s[_r];\r\n                        var index = this._slotTimelines.indexOf(timeline);\r\n                        if (index >= 0) {\r\n                            this._slotTimelines.splice(index, 1);\r\n                            timeline.returnToPool();\r\n                        }\r\n                        index = this._slotBlendTimelines.indexOf(timeline);\r\n                        if (index >= 0) {\r\n                            this._slotBlendTimelines.splice(index, 1);\r\n                            timeline.returnToPool();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        AnimationState.prototype._advanceFadeTime = function (passedTime) {\r\n            var isFadeOut = this._fadeState > 0;\r\n            if (this._subFadeState < 0) { // Fade start event.\r\n                this._subFadeState = 0;\r\n                var eventActive = this._parent === null && this.actionEnabled;\r\n                if (eventActive) {\r\n                    var eventType = isFadeOut ? dragonBones.EventObject.FADE_OUT : dragonBones.EventObject.FADE_IN;\r\n                    if (this._armature.eventDispatcher.hasDBEventListener(eventType)) {\r\n                        var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                        eventObject.type = eventType;\r\n                        eventObject.armature = this._armature;\r\n                        eventObject.animationState = this;\r\n                        this._armature._dragonBones.bufferEvent(eventObject);\r\n                    }\r\n                }\r\n            }\r\n            if (passedTime < 0.0) {\r\n                passedTime = -passedTime;\r\n            }\r\n            this._fadeTime += passedTime;\r\n            if (this._fadeTime >= this.fadeTotalTime) { // Fade complete.\r\n                this._subFadeState = 1;\r\n                this._fadeProgress = isFadeOut ? 0.0 : 1.0;\r\n            }\r\n            else if (this._fadeTime > 0.0) { // Fading.\r\n                this._fadeProgress = isFadeOut ? (1.0 - this._fadeTime / this.fadeTotalTime) : (this._fadeTime / this.fadeTotalTime);\r\n            }\r\n            else { // Before fade.\r\n                this._fadeProgress = isFadeOut ? 1.0 : 0.0;\r\n            }\r\n            if (this._subFadeState > 0) { // Fade complete event.\r\n                if (!isFadeOut) {\r\n                    this._playheadState |= 1; // x1\r\n                    this._fadeState = 0;\r\n                }\r\n                var eventActive = this._parent === null && this.actionEnabled;\r\n                if (eventActive) {\r\n                    var eventType = isFadeOut ? dragonBones.EventObject.FADE_OUT_COMPLETE : dragonBones.EventObject.FADE_IN_COMPLETE;\r\n                    if (this._armature.eventDispatcher.hasDBEventListener(eventType)) {\r\n                        var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                        eventObject.type = eventType;\r\n                        eventObject.armature = this._armature;\r\n                        eventObject.animationState = this;\r\n                        this._armature._dragonBones.bufferEvent(eventObject);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        AnimationState.prototype.init = function (armature, animationData, animationConfig) {\r\n            if (this._armature !== null) {\r\n                return;\r\n            }\r\n            this._armature = armature;\r\n            this._animationData = animationData;\r\n            //\r\n            this.resetToPose = animationConfig.resetToPose;\r\n            this.additive = animationConfig.additive;\r\n            this.displayControl = animationConfig.displayControl;\r\n            this.actionEnabled = animationConfig.actionEnabled;\r\n            this.blendType = animationData.blendType;\r\n            this.layer = animationConfig.layer;\r\n            this.playTimes = animationConfig.playTimes;\r\n            this.timeScale = animationConfig.timeScale;\r\n            this.fadeTotalTime = animationConfig.fadeInTime;\r\n            this.autoFadeOutTime = animationConfig.autoFadeOutTime;\r\n            this.name = animationConfig.name.length > 0 ? animationConfig.name : animationConfig.animation;\r\n            this.group = animationConfig.group;\r\n            //\r\n            this._weight = animationConfig.weight;\r\n            if (animationConfig.pauseFadeIn) {\r\n                this._playheadState = 2; // 10\r\n            }\r\n            else {\r\n                this._playheadState = 3; // 11\r\n            }\r\n            if (animationConfig.duration < 0.0) {\r\n                this._position = 0.0;\r\n                this._duration = this._animationData.duration;\r\n                if (animationConfig.position !== 0.0) {\r\n                    if (this.timeScale >= 0.0) {\r\n                        this._time = animationConfig.position;\r\n                    }\r\n                    else {\r\n                        this._time = animationConfig.position - this._duration;\r\n                    }\r\n                }\r\n                else {\r\n                    this._time = 0.0;\r\n                }\r\n            }\r\n            else {\r\n                this._position = animationConfig.position;\r\n                this._duration = animationConfig.duration;\r\n                this._time = 0.0;\r\n            }\r\n            if (this.timeScale < 0.0 && this._time === 0.0) {\r\n                this._time = -0.000001; // Turn to end.\r\n            }\r\n            if (this.fadeTotalTime <= 0.0) {\r\n                this._fadeProgress = 0.999999; // Make different.\r\n            }\r\n            if (animationConfig.boneMask.length > 0) {\r\n                this._boneMask.length = animationConfig.boneMask.length;\r\n                for (var i = 0, l = this._boneMask.length; i < l; ++i) {\r\n                    this._boneMask[i] = animationConfig.boneMask[i];\r\n                }\r\n            }\r\n            this._actionTimeline = dragonBones.BaseObject.borrowObject(dragonBones.ActionTimelineState);\r\n            this._actionTimeline.init(this._armature, this, this._animationData.actionTimeline);\r\n            this._actionTimeline.currentTime = this._time;\r\n            if (this._actionTimeline.currentTime < 0.0) {\r\n                this._actionTimeline.currentTime = this._duration - this._actionTimeline.currentTime;\r\n            }\r\n            if (this._animationData.zOrderTimeline !== null) {\r\n                this._zOrderTimeline = dragonBones.BaseObject.borrowObject(dragonBones.ZOrderTimelineState);\r\n                this._zOrderTimeline.init(this._armature, this, this._animationData.zOrderTimeline);\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        AnimationState.prototype.advanceTime = function (passedTime, cacheFrameRate) {\r\n            // Update fade time.\r\n            if (this._fadeState !== 0 || this._subFadeState !== 0) {\r\n                this._advanceFadeTime(passedTime);\r\n            }\r\n            // Update time.\r\n            if (this._playheadState === 3) { // 11\r\n                if (this.timeScale !== 1.0) {\r\n                    passedTime *= this.timeScale;\r\n                }\r\n                this._time += passedTime;\r\n            }\r\n            // Update timeline.\r\n            if (this._timelineDirty !== 0) {\r\n                if (this._timelineDirty === 2) {\r\n                    this._updateTimelines();\r\n                }\r\n                this._timelineDirty = 0;\r\n                this._updateBoneAndSlotTimelines();\r\n            }\r\n            var isBlendDirty = this._fadeState !== 0 || this._subFadeState === 0;\r\n            var isCacheEnabled = this._fadeState === 0 && cacheFrameRate > 0.0;\r\n            var isUpdateTimeline = true;\r\n            var isUpdateBoneTimeline = true;\r\n            var time = this._time;\r\n            this._weightResult = this._weight * this._fadeProgress;\r\n            if (this._parent !== null) {\r\n                this._weightResult *= this._parent._weightResult;\r\n            }\r\n            if (this._actionTimeline.playState <= 0) { // Update main timeline.\r\n                this._actionTimeline.update(time);\r\n            }\r\n            if (this._weight === 0.0) {\r\n                return;\r\n            }\r\n            if (isCacheEnabled) { // Cache time internval.\r\n                var internval = cacheFrameRate * 2.0;\r\n                this._actionTimeline.currentTime = Math.floor(this._actionTimeline.currentTime * internval) / internval;\r\n            }\r\n            if (this._zOrderTimeline !== null && this._zOrderTimeline.playState <= 0) { // Update zOrder timeline.\r\n                this._zOrderTimeline.update(time);\r\n            }\r\n            if (isCacheEnabled) { // Update cache.\r\n                var cacheFrameIndex = Math.floor(this._actionTimeline.currentTime * cacheFrameRate); // uint\r\n                if (this._armature._cacheFrameIndex === cacheFrameIndex) { // Same cache.\r\n                    isUpdateTimeline = false;\r\n                    isUpdateBoneTimeline = false;\r\n                }\r\n                else {\r\n                    this._armature._cacheFrameIndex = cacheFrameIndex;\r\n                    if (this._animationData.cachedFrames[cacheFrameIndex]) { // Cached.\r\n                        isUpdateBoneTimeline = false;\r\n                    }\r\n                    else { // Cache.\r\n                        this._animationData.cachedFrames[cacheFrameIndex] = true;\r\n                    }\r\n                }\r\n            }\r\n            if (isUpdateTimeline) {\r\n                var isBlend = false;\r\n                var prevTarget = null; //\r\n                if (isUpdateBoneTimeline) {\r\n                    for (var i = 0, l = this._boneTimelines.length; i < l; ++i) {\r\n                        var timeline = this._boneTimelines[i];\r\n                        if (timeline.playState <= 0) {\r\n                            timeline.update(time);\r\n                        }\r\n                        if (timeline.target !== prevTarget) {\r\n                            var blendState = timeline.target;\r\n                            isBlend = blendState.update(this);\r\n                            prevTarget = blendState;\r\n                            if (blendState.dirty === 1) {\r\n                                var pose = blendState.target.animationPose;\r\n                                pose.x = 0.0;\r\n                                pose.y = 0.0;\r\n                                pose.rotation = 0.0;\r\n                                pose.skew = 0.0;\r\n                                pose.scaleX = 1.0;\r\n                                pose.scaleY = 1.0;\r\n                            }\r\n                        }\r\n                        if (isBlend) {\r\n                            timeline.blend(isBlendDirty);\r\n                        }\r\n                    }\r\n                }\r\n                for (var i = 0, l = this._boneBlendTimelines.length; i < l; ++i) {\r\n                    var timeline = this._boneBlendTimelines[i];\r\n                    if (timeline.playState <= 0) {\r\n                        timeline.update(time);\r\n                    }\r\n                    if (timeline.target.update(this)) {\r\n                        timeline.blend(isBlendDirty);\r\n                    }\r\n                }\r\n                if (this.displayControl) {\r\n                    for (var i = 0, l = this._slotTimelines.length; i < l; ++i) {\r\n                        var timeline = this._slotTimelines[i];\r\n                        if (timeline.playState <= 0) {\r\n                            var slot = timeline.target;\r\n                            var displayController = slot.displayController;\r\n                            if (displayController === null ||\r\n                                displayController === this.name ||\r\n                                displayController === this.group) {\r\n                                timeline.update(time);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                for (var i = 0, l = this._slotBlendTimelines.length; i < l; ++i) {\r\n                    var timeline = this._slotBlendTimelines[i];\r\n                    if (timeline.playState <= 0) {\r\n                        var blendState = timeline.target;\r\n                        timeline.update(time);\r\n                        if (blendState.update(this)) {\r\n                            timeline.blend(isBlendDirty);\r\n                        }\r\n                    }\r\n                }\r\n                for (var i = 0, l = this._constraintTimelines.length; i < l; ++i) {\r\n                    var timeline = this._constraintTimelines[i];\r\n                    if (timeline.playState <= 0) {\r\n                        timeline.update(time);\r\n                    }\r\n                }\r\n                if (this._animationTimelines.length > 0) {\r\n                    var dL = 100.0;\r\n                    var dR = 100.0;\r\n                    var leftState = null;\r\n                    var rightState = null;\r\n                    for (var i = 0, l = this._animationTimelines.length; i < l; ++i) {\r\n                        var timeline = this._animationTimelines[i];\r\n                        if (timeline.playState <= 0) {\r\n                            timeline.update(time);\r\n                        }\r\n                        if (this.blendType === 1 /* E1D */) { // TODO\r\n                            var animationState = timeline.target;\r\n                            var d = this.parameterX - animationState.positionX;\r\n                            if (d >= 0.0) {\r\n                                if (d < dL) {\r\n                                    dL = d;\r\n                                    leftState = animationState;\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (-d < dR) {\r\n                                    dR = -d;\r\n                                    rightState = animationState;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    if (leftState !== null) {\r\n                        if (this._activeChildA !== leftState) {\r\n                            if (this._activeChildA !== null) {\r\n                                this._activeChildA.weight = 0.0;\r\n                            }\r\n                            this._activeChildA = leftState;\r\n                            this._activeChildA.activeTimeline();\r\n                        }\r\n                        if (this._activeChildB !== rightState) {\r\n                            if (this._activeChildB !== null) {\r\n                                this._activeChildB.weight = 0.0;\r\n                            }\r\n                            this._activeChildB = rightState;\r\n                        }\r\n                        leftState.weight = dR / (dL + dR);\r\n                        if (rightState) {\r\n                            rightState.weight = 1.0 - leftState.weight;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (this._fadeState === 0) {\r\n                if (this._subFadeState > 0) {\r\n                    this._subFadeState = 0;\r\n                    if (this._poseTimelines.length > 0) { // Remove pose timelines.\r\n                        for (var _i = 0, _a = this._poseTimelines; _i < _a.length; _i++) {\r\n                            var timeline = _a[_i];\r\n                            var index = this._boneTimelines.indexOf(timeline);\r\n                            if (index >= 0) {\r\n                                this._boneTimelines.splice(index, 1);\r\n                                timeline.returnToPool();\r\n                                continue;\r\n                            }\r\n                            index = this._boneBlendTimelines.indexOf(timeline);\r\n                            if (index >= 0) {\r\n                                this._boneBlendTimelines.splice(index, 1);\r\n                                timeline.returnToPool();\r\n                                continue;\r\n                            }\r\n                            index = this._slotTimelines.indexOf(timeline);\r\n                            if (index >= 0) {\r\n                                this._slotTimelines.splice(index, 1);\r\n                                timeline.returnToPool();\r\n                                continue;\r\n                            }\r\n                            index = this._slotBlendTimelines.indexOf(timeline);\r\n                            if (index >= 0) {\r\n                                this._slotBlendTimelines.splice(index, 1);\r\n                                timeline.returnToPool();\r\n                                continue;\r\n                            }\r\n                            index = this._constraintTimelines.indexOf(timeline);\r\n                            if (index >= 0) {\r\n                                this._constraintTimelines.splice(index, 1);\r\n                                timeline.returnToPool();\r\n                                continue;\r\n                            }\r\n                        }\r\n                        this._poseTimelines.length = 0;\r\n                    }\r\n                }\r\n                if (this._actionTimeline.playState > 0) {\r\n                    if (this.autoFadeOutTime >= 0.0) { // Auto fade out.\r\n                        this.fadeOut(this.autoFadeOutTime);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Continue play.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 继续播放。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.play = function () {\r\n            this._playheadState = 3; // 11\r\n        };\r\n        /**\r\n         * - Stop play.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 暂停播放。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.stop = function () {\r\n            this._playheadState &= 1; // 0x\r\n        };\r\n        /**\r\n         * - Fade out the animation state.\r\n         * @param fadeOutTime - The fade out time. (In seconds)\r\n         * @param pausePlayhead - Whether to pause the animation playing when fade out.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 淡出动画状态。\r\n         * @param fadeOutTime - 淡出时间。 （以秒为单位）\r\n         * @param pausePlayhead - 淡出时是否暂停播放。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.fadeOut = function (fadeOutTime, pausePlayhead) {\r\n            if (pausePlayhead === void 0) { pausePlayhead = true; }\r\n            if (fadeOutTime < 0.0) {\r\n                fadeOutTime = 0.0;\r\n            }\r\n            if (pausePlayhead) {\r\n                this._playheadState &= 2; // x0\r\n            }\r\n            if (this._fadeState > 0) {\r\n                if (fadeOutTime > this.fadeTotalTime - this._fadeTime) { // If the animation is already in fade out, the new fade out will be ignored.\r\n                    return;\r\n                }\r\n            }\r\n            else {\r\n                this._fadeState = 1;\r\n                this._subFadeState = -1;\r\n                if (fadeOutTime <= 0.0 || this._fadeProgress <= 0.0) {\r\n                    this._fadeProgress = 0.000001; // Modify fade progress to different value.\r\n                }\r\n                for (var _i = 0, _a = this._boneTimelines; _i < _a.length; _i++) {\r\n                    var timeline = _a[_i];\r\n                    timeline.fadeOut();\r\n                }\r\n                for (var _b = 0, _c = this._boneBlendTimelines; _b < _c.length; _b++) {\r\n                    var timeline = _c[_b];\r\n                    timeline.fadeOut();\r\n                }\r\n                for (var _d = 0, _e = this._slotTimelines; _d < _e.length; _d++) {\r\n                    var timeline = _e[_d];\r\n                    timeline.fadeOut();\r\n                }\r\n                for (var _f = 0, _g = this._slotBlendTimelines; _f < _g.length; _f++) {\r\n                    var timeline = _g[_f];\r\n                    timeline.fadeOut();\r\n                }\r\n                for (var _h = 0, _j = this._constraintTimelines; _h < _j.length; _h++) {\r\n                    var timeline = _j[_h];\r\n                    timeline.fadeOut();\r\n                }\r\n                for (var _k = 0, _l = this._animationTimelines; _k < _l.length; _k++) {\r\n                    var timeline = _l[_k];\r\n                    timeline.fadeOut();\r\n                    //\r\n                    var animaitonState = timeline.target;\r\n                    animaitonState.fadeOut(999999.0, true);\r\n                }\r\n            }\r\n            this.displayControl = false; //\r\n            this.fadeTotalTime = this._fadeProgress > 0.000001 ? fadeOutTime / this._fadeProgress : 0.0;\r\n            this._fadeTime = this.fadeTotalTime * (1.0 - this._fadeProgress);\r\n        };\r\n        /**\r\n         * - Check if a specific bone mask is included.\r\n         * @param boneName - The bone name.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 检查是否包含特定骨骼遮罩。\r\n         * @param boneName - 骨骼名称。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.containsBoneMask = function (boneName) {\r\n            return this._boneMask.length === 0 || this._boneMask.indexOf(boneName) >= 0;\r\n        };\r\n        /**\r\n         * - Add a specific bone mask.\r\n         * @param boneName - The bone name.\r\n         * @param recursive - Whether or not to add a mask to the bone\'s sub-bone.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 添加特定的骨骼遮罩。\r\n         * @param boneName - 骨骼名称。\r\n         * @param recursive - 是否为该骨骼的子骨骼添加遮罩。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.addBoneMask = function (boneName, recursive) {\r\n            if (recursive === void 0) { recursive = true; }\r\n            var currentBone = this._armature.getBone(boneName);\r\n            if (currentBone === null) {\r\n                return;\r\n            }\r\n            if (this._boneMask.indexOf(boneName) < 0) { // Add mixing\r\n                this._boneMask.push(boneName);\r\n            }\r\n            if (recursive) { // Add recursive mixing.\r\n                for (var _i = 0, _a = this._armature.getBones(); _i < _a.length; _i++) {\r\n                    var bone = _a[_i];\r\n                    if (this._boneMask.indexOf(bone.name) < 0 && currentBone.contains(bone)) {\r\n                        this._boneMask.push(bone.name);\r\n                    }\r\n                }\r\n            }\r\n            this._timelineDirty = 1;\r\n        };\r\n        /**\r\n         * - Remove the mask of a specific bone.\r\n         * @param boneName - The bone name.\r\n         * @param recursive - Whether to remove the bone\'s sub-bone mask.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 删除特定骨骼的遮罩。\r\n         * @param boneName - 骨骼名称。\r\n         * @param recursive - 是否删除该骨骼的子骨骼遮罩。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.removeBoneMask = function (boneName, recursive) {\r\n            if (recursive === void 0) { recursive = true; }\r\n            var index = this._boneMask.indexOf(boneName);\r\n            if (index >= 0) { // Remove mixing.\r\n                this._boneMask.splice(index, 1);\r\n            }\r\n            if (recursive) {\r\n                var currentBone = this._armature.getBone(boneName);\r\n                if (currentBone !== null) {\r\n                    var bones = this._armature.getBones();\r\n                    if (this._boneMask.length > 0) { // Remove recursive mixing.\r\n                        for (var _i = 0, bones_1 = bones; _i < bones_1.length; _i++) {\r\n                            var bone = bones_1[_i];\r\n                            var index_1 = this._boneMask.indexOf(bone.name);\r\n                            if (index_1 >= 0 && currentBone.contains(bone)) {\r\n                                this._boneMask.splice(index_1, 1);\r\n                            }\r\n                        }\r\n                    }\r\n                    else { // Add unrecursive mixing.\r\n                        for (var _a = 0, bones_2 = bones; _a < bones_2.length; _a++) {\r\n                            var bone = bones_2[_a];\r\n                            if (bone === currentBone) {\r\n                                continue;\r\n                            }\r\n                            if (!currentBone.contains(bone)) {\r\n                                this._boneMask.push(bone.name);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._timelineDirty = 1;\r\n        };\r\n        /**\r\n         * - Remove all bone masks.\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 删除所有骨骼遮罩。\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        AnimationState.prototype.removeAllBoneMask = function () {\r\n            this._boneMask.length = 0;\r\n            this._timelineDirty = 1;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        AnimationState.prototype.addState = function (animationState, timelineDatas) {\r\n            if (timelineDatas === void 0) { timelineDatas = null; }\r\n            if (timelineDatas !== null) {\r\n                for (var _i = 0, timelineDatas_4 = timelineDatas; _i < timelineDatas_4.length; _i++) {\r\n                    var timelineData = timelineDatas_4[_i];\r\n                    switch (timelineData.type) {\r\n                        case 40 /* AnimationProgress */: {\r\n                            var timeline = dragonBones.BaseObject.borrowObject(dragonBones.AnimationProgressTimelineState);\r\n                            timeline.target = animationState;\r\n                            timeline.init(this._armature, this, timelineData);\r\n                            this._animationTimelines.push(timeline);\r\n                            if (this.blendType !== 0 /* None */) {\r\n                                var animaitonTimelineData = timelineData;\r\n                                animationState.positionX = animaitonTimelineData.x;\r\n                                animationState.positionY = animaitonTimelineData.y;\r\n                                animationState.weight = 0.0;\r\n                            }\r\n                            animationState._parent = this;\r\n                            this.resetToPose = false;\r\n                            break;\r\n                        }\r\n                        case 41 /* AnimationWeight */: {\r\n                            var timeline = dragonBones.BaseObject.borrowObject(dragonBones.AnimationWeightTimelineState);\r\n                            timeline.target = animationState;\r\n                            timeline.init(this._armature, this, timelineData);\r\n                            this._animationTimelines.push(timeline);\r\n                            break;\r\n                        }\r\n                        case 42 /* AnimationParameter */: {\r\n                            var timeline = dragonBones.BaseObject.borrowObject(dragonBones.AnimationParametersTimelineState);\r\n                            timeline.target = animationState;\r\n                            timeline.init(this._armature, this, timelineData);\r\n                            this._animationTimelines.push(timeline);\r\n                            break;\r\n                        }\r\n                        default:\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            if (animationState._parent === null) {\r\n                animationState._parent = this;\r\n            }\r\n        };\r\n        /**\r\n         * @internal\r\n         */\r\n        AnimationState.prototype.activeTimeline = function () {\r\n            for (var _i = 0, _a = this._slotTimelines; _i < _a.length; _i++) {\r\n                var timeline = _a[_i];\r\n                timeline.dirty = true;\r\n                timeline.currentTime = -1.0;\r\n            }\r\n        };\r\n        Object.defineProperty(AnimationState.prototype, "isFadeIn", {\r\n            /**\r\n             * - Whether the animation state is fading in.\r\n             * @version DragonBones 5.1\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否正在淡入。\r\n             * @version DragonBones 5.1\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._fadeState < 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "isFadeOut", {\r\n            /**\r\n             * - Whether the animation state is fading out.\r\n             * @version DragonBones 5.1\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否正在淡出。\r\n             * @version DragonBones 5.1\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._fadeState > 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "isFadeComplete", {\r\n            /**\r\n             * - Whether the animation state is fade completed.\r\n             * @version DragonBones 5.1\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否淡入或淡出完毕。\r\n             * @version DragonBones 5.1\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._fadeState === 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "isPlaying", {\r\n            /**\r\n             * - Whether the animation state is playing.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否正在播放。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return (this._playheadState & 2) !== 0 && this._actionTimeline.playState <= 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "isCompleted", {\r\n            /**\r\n             * - Whether the animation state is play completed.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 是否播放完毕。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._actionTimeline.playState > 0;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "currentPlayTimes", {\r\n            /**\r\n             * - The times has been played.\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 已经循环播放的次数。\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._actionTimeline.currentPlayTimes;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "totalTime", {\r\n            /**\r\n             * - The total time. (In seconds)\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 总播放时间。 （以秒为单位）\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._duration;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "currentTime", {\r\n            /**\r\n             * - The time is currently playing. (In seconds)\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 当前播放的时间。 （以秒为单位）\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._actionTimeline.currentTime;\r\n            },\r\n            set: function (value) {\r\n                var currentPlayTimes = this._actionTimeline.currentPlayTimes - (this._actionTimeline.playState > 0 ? 1 : 0);\r\n                if (value < 0 || this._duration < value) {\r\n                    value = (value % this._duration) + currentPlayTimes * this._duration;\r\n                    if (value < 0) {\r\n                        value += this._duration;\r\n                    }\r\n                }\r\n                if (this.playTimes > 0 && currentPlayTimes === this.playTimes - 1 &&\r\n                    value === this._duration && this._parent === null) {\r\n                    value = this._duration - 0.000001; // \r\n                }\r\n                if (this._time === value) {\r\n                    return;\r\n                }\r\n                this._time = value;\r\n                this._actionTimeline.setCurrentTime(this._time);\r\n                if (this._zOrderTimeline !== null) {\r\n                    this._zOrderTimeline.playState = -1;\r\n                }\r\n                for (var _i = 0, _a = this._boneTimelines; _i < _a.length; _i++) {\r\n                    var timeline = _a[_i];\r\n                    timeline.playState = -1;\r\n                }\r\n                for (var _b = 0, _c = this._slotTimelines; _b < _c.length; _b++) {\r\n                    var timeline = _c[_b];\r\n                    timeline.playState = -1;\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "weight", {\r\n            /**\r\n             * - The blend weight.\r\n             * @default 1.0\r\n             * @version DragonBones 5.0\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 混合权重。\r\n             * @default 1.0\r\n             * @version DragonBones 5.0\r\n             * @language zh_CN\r\n             */\r\n            /**\r\n             * - The animation data.\r\n             * @see dragonBones.AnimationData\r\n             * @version DragonBones 3.0\r\n             * @language en_US\r\n             */\r\n            get: function () {\r\n                return this._weight;\r\n            },\r\n            set: function (value) {\r\n                if (this._weight === value) {\r\n                    return;\r\n                }\r\n                this._weight = value;\r\n                for (var _i = 0, _a = this._boneTimelines; _i < _a.length; _i++) {\r\n                    var timeline = _a[_i];\r\n                    timeline.dirty = true;\r\n                }\r\n                for (var _b = 0, _c = this._boneBlendTimelines; _b < _c.length; _b++) {\r\n                    var timeline = _c[_b];\r\n                    timeline.dirty = true;\r\n                }\r\n                for (var _d = 0, _e = this._slotBlendTimelines; _d < _e.length; _d++) {\r\n                    var timeline = _e[_d];\r\n                    timeline.dirty = true;\r\n                }\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(AnimationState.prototype, "animationData", {\r\n            /**\r\n             * - 动画数据。\r\n             * @see dragonBones.AnimationData\r\n             * @version DragonBones 3.0\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._animationData;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        return AnimationState;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.AnimationState = AnimationState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var BlendState = /** @class */ (function (_super) {\r\n        __extends(BlendState, _super);\r\n        function BlendState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BlendState.toString = function () {\r\n            return "[class dragonBones.BlendState]";\r\n        };\r\n        BlendState.prototype._onClear = function () {\r\n            this.reset();\r\n            this.target = null;\r\n        };\r\n        BlendState.prototype.update = function (animationState) {\r\n            var animationLayer = animationState.layer;\r\n            var animationWeight = animationState._weightResult;\r\n            if (this.dirty > 0) {\r\n                if (this.leftWeight > 0.0) {\r\n                    if (this.layer !== animationLayer) {\r\n                        if (this.layerWeight >= this.leftWeight) {\r\n                            this.dirty++;\r\n                            this.layer = animationLayer;\r\n                            this.leftWeight = 0.0;\r\n                            this.blendWeight = 0.0;\r\n                            return false;\r\n                        }\r\n                        this.layer = animationLayer;\r\n                        this.leftWeight -= this.layerWeight;\r\n                        this.layerWeight = 0.0;\r\n                    }\r\n                    animationWeight *= this.leftWeight;\r\n                    this.dirty++;\r\n                    this.blendWeight = animationWeight;\r\n                    this.layerWeight += this.blendWeight;\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            this.dirty++;\r\n            this.layer = animationLayer;\r\n            this.leftWeight = 1.0;\r\n            this.blendWeight = animationWeight;\r\n            this.layerWeight = animationWeight;\r\n            return true;\r\n        };\r\n        BlendState.prototype.reset = function () {\r\n            this.dirty = 0;\r\n            this.layer = 0;\r\n            this.leftWeight = 0.0;\r\n            this.layerWeight = 0.0;\r\n            this.blendWeight = 0.0;\r\n        };\r\n        BlendState.BONE_TRANSFORM = "boneTransform";\r\n        BlendState.BONE_ALPHA = "boneAlpha";\r\n        BlendState.SURFACE = "surface";\r\n        BlendState.SLOT_DEFORM = "slotDeform";\r\n        BlendState.SLOT_ALPHA = "slotAlpha";\r\n        BlendState.SLOT_Z_INDEX = "slotZIndex";\r\n        return BlendState;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.BlendState = BlendState;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @internal\r\n     */\r\n    var TimelineState = /** @class */ (function (_super) {\r\n        __extends(TimelineState, _super);\r\n        function TimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        TimelineState.prototype._onClear = function () {\r\n            this.dirty = false;\r\n            this.playState = -1;\r\n            this.currentPlayTimes = 0;\r\n            this.currentTime = -1.0;\r\n            this.target = null;\r\n            this._isTween = false;\r\n            this._valueOffset = 0;\r\n            this._frameValueOffset = 0;\r\n            this._frameOffset = 0;\r\n            this._frameRate = 0;\r\n            this._frameCount = 0;\r\n            this._frameIndex = -1;\r\n            this._frameRateR = 0.0;\r\n            this._position = 0.0;\r\n            this._duration = 0.0;\r\n            this._timeScale = 1.0;\r\n            this._timeOffset = 0.0;\r\n            this._animationData = null; //\r\n            this._timelineData = null; //\r\n            this._armature = null; //\r\n            this._animationState = null; //\r\n            this._actionTimeline = null; //\r\n            this._frameArray = null; //\r\n            this._valueArray = null; //\r\n            this._timelineArray = null; //\r\n            this._frameIndices = null; //\r\n        };\r\n        TimelineState.prototype._setCurrentTime = function (passedTime) {\r\n            var prevState = this.playState;\r\n            var prevPlayTimes = this.currentPlayTimes;\r\n            var prevTime = this.currentTime;\r\n            if (this._actionTimeline !== null && this._frameCount <= 1) { // No frame or only one frame.\r\n                this.playState = this._actionTimeline.playState >= 0 ? 1 : -1;\r\n                this.currentPlayTimes = 1;\r\n                this.currentTime = this._actionTimeline.currentTime;\r\n            }\r\n            else if (this._actionTimeline === null || this._timeScale !== 1.0 || this._timeOffset !== 0.0) { // Action timeline or has scale and offset.\r\n                var playTimes = this._animationState.playTimes;\r\n                var totalTime = playTimes * this._duration;\r\n                passedTime *= this._timeScale;\r\n                if (this._timeOffset !== 0.0) {\r\n                    passedTime += this._timeOffset * this._animationData.duration;\r\n                }\r\n                if (playTimes > 0 && (passedTime >= totalTime || passedTime <= -totalTime)) {\r\n                    if (this.playState <= 0 && this._animationState._playheadState === 3) {\r\n                        this.playState = 1;\r\n                    }\r\n                    this.currentPlayTimes = playTimes;\r\n                    if (passedTime < 0.0) {\r\n                        this.currentTime = 0.0;\r\n                    }\r\n                    else {\r\n                        this.currentTime = this.playState === 1 ? this._duration + 0.000001 : this._duration; // Precision problem\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.playState !== 0 && this._animationState._playheadState === 3) {\r\n                        this.playState = 0;\r\n                    }\r\n                    if (passedTime < 0.0) {\r\n                        passedTime = -passedTime;\r\n                        this.currentPlayTimes = Math.floor(passedTime / this._duration);\r\n                        this.currentTime = this._duration - (passedTime % this._duration);\r\n                    }\r\n                    else {\r\n                        this.currentPlayTimes = Math.floor(passedTime / this._duration);\r\n                        this.currentTime = passedTime % this._duration;\r\n                    }\r\n                }\r\n                this.currentTime += this._position;\r\n            }\r\n            else { // Multi frames.\r\n                this.playState = this._actionTimeline.playState;\r\n                this.currentPlayTimes = this._actionTimeline.currentPlayTimes;\r\n                this.currentTime = this._actionTimeline.currentTime;\r\n            }\r\n            if (this.currentPlayTimes === prevPlayTimes && this.currentTime === prevTime) {\r\n                return false;\r\n            }\r\n            // Clear frame flag when timeline start or loopComplete.\r\n            if ((prevState < 0 && this.playState !== prevState) ||\r\n                (this.playState <= 0 && this.currentPlayTimes !== prevPlayTimes)) {\r\n                this._frameIndex = -1;\r\n            }\r\n            return true;\r\n        };\r\n        TimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            this._armature = armature;\r\n            this._animationState = animationState;\r\n            this._timelineData = timelineData;\r\n            this._actionTimeline = this._animationState._actionTimeline;\r\n            if (this === this._actionTimeline) {\r\n                this._actionTimeline = null; //\r\n            }\r\n            this._animationData = this._animationState.animationData;\r\n            //\r\n            this._frameRate = this._animationData.parent.frameRate;\r\n            this._frameRateR = 1.0 / this._frameRate;\r\n            this._position = this._animationState._position;\r\n            this._duration = this._animationState._duration;\r\n            if (this._timelineData !== null) {\r\n                var dragonBonesData = this._animationData.parent.parent; // May by the animation data is not belone to this armature data.\r\n                this._frameArray = dragonBonesData.frameArray;\r\n                this._timelineArray = dragonBonesData.timelineArray;\r\n                this._frameIndices = dragonBonesData.frameIndices;\r\n                //\r\n                this._frameCount = this._timelineArray[this._timelineData.offset + 2 /* TimelineKeyFrameCount */];\r\n                this._frameValueOffset = this._timelineArray[this._timelineData.offset + 4 /* TimelineFrameValueOffset */];\r\n                this._timeScale = 100.0 / this._timelineArray[this._timelineData.offset + 0 /* TimelineScale */];\r\n                this._timeOffset = this._timelineArray[this._timelineData.offset + 1 /* TimelineOffset */] * 0.01;\r\n            }\r\n        };\r\n        TimelineState.prototype.fadeOut = function () {\r\n            this.dirty = false;\r\n        };\r\n        TimelineState.prototype.update = function (passedTime) {\r\n            if (this._setCurrentTime(passedTime)) {\r\n                if (this._frameCount > 1) {\r\n                    var timelineFrameIndex = Math.floor(this.currentTime * this._frameRate); // uint\r\n                    var frameIndex = this._frameIndices[this._timelineData.frameIndicesOffset + timelineFrameIndex];\r\n                    if (this._frameIndex !== frameIndex) {\r\n                        this._frameIndex = frameIndex;\r\n                        this._frameOffset = this._animationData.frameOffset + this._timelineArray[this._timelineData.offset + 5 /* TimelineFrameOffset */ + this._frameIndex];\r\n                        this._onArriveAtFrame();\r\n                    }\r\n                }\r\n                else if (this._frameIndex < 0) {\r\n                    this._frameIndex = 0;\r\n                    if (this._timelineData !== null) { // May be pose timeline.\r\n                        this._frameOffset = this._animationData.frameOffset + this._timelineArray[this._timelineData.offset + 5 /* TimelineFrameOffset */];\r\n                    }\r\n                    this._onArriveAtFrame();\r\n                }\r\n                if (this._isTween || this.dirty) {\r\n                    this._onUpdateFrame();\r\n                }\r\n            }\r\n        };\r\n        TimelineState.prototype.blend = function (_isDirty) {\r\n        };\r\n        return TimelineState;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.TimelineState = TimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var TweenTimelineState = /** @class */ (function (_super) {\r\n        __extends(TweenTimelineState, _super);\r\n        function TweenTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        TweenTimelineState._getEasingValue = function (tweenType, progress, easing) {\r\n            var value = progress;\r\n            switch (tweenType) {\r\n                case 3 /* QuadIn */:\r\n                    value = Math.pow(progress, 2.0);\r\n                    break;\r\n                case 4 /* QuadOut */:\r\n                    value = 1.0 - Math.pow(1.0 - progress, 2.0);\r\n                    break;\r\n                case 5 /* QuadInOut */:\r\n                    value = 0.5 * (1.0 - Math.cos(progress * Math.PI));\r\n                    break;\r\n            }\r\n            return (value - progress) * easing + progress;\r\n        };\r\n        TweenTimelineState._getEasingCurveValue = function (progress, samples, count, offset) {\r\n            if (progress <= 0.0) {\r\n                return 0.0;\r\n            }\r\n            else if (progress >= 1.0) {\r\n                return 1.0;\r\n            }\r\n            var isOmited = count > 0;\r\n            var segmentCount = count + 1; // + 2 - 1\r\n            var valueIndex = Math.floor(progress * segmentCount);\r\n            var fromValue = 0.0;\r\n            var toValue = 0.0;\r\n            if (isOmited) {\r\n                fromValue = valueIndex === 0 ? 0.0 : samples[offset + valueIndex - 1];\r\n                toValue = (valueIndex === segmentCount - 1) ? 10000.0 : samples[offset + valueIndex];\r\n            }\r\n            else {\r\n                fromValue = samples[offset + valueIndex - 1];\r\n                toValue = samples[offset + valueIndex];\r\n            }\r\n            return (fromValue + (toValue - fromValue) * (progress * segmentCount - valueIndex)) * 0.0001;\r\n        };\r\n        TweenTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._tweenType = 0 /* None */;\r\n            this._curveCount = 0;\r\n            this._framePosition = 0.0;\r\n            this._frameDurationR = 0.0;\r\n            this._tweenEasing = 0.0;\r\n            this._tweenProgress = 0.0;\r\n            this._valueScale = 1.0;\r\n        };\r\n        TweenTimelineState.prototype._onArriveAtFrame = function () {\r\n            if (this._frameCount > 1 &&\r\n                (this._frameIndex !== this._frameCount - 1 ||\r\n                    this._animationState.playTimes === 0 ||\r\n                    this._animationState.currentPlayTimes < this._animationState.playTimes - 1)) {\r\n                this._tweenType = this._frameArray[this._frameOffset + 1 /* FrameTweenType */];\r\n                this._isTween = this._tweenType !== 0 /* None */;\r\n                if (this._isTween) {\r\n                    if (this._tweenType === 2 /* Curve */) {\r\n                        this._curveCount = this._frameArray[this._frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */];\r\n                    }\r\n                    else if (this._tweenType !== 0 /* None */ && this._tweenType !== 1 /* Line */) {\r\n                        this._tweenEasing = this._frameArray[this._frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */] * 0.01;\r\n                    }\r\n                }\r\n                else {\r\n                    this.dirty = true;\r\n                }\r\n                this._framePosition = this._frameArray[this._frameOffset] * this._frameRateR;\r\n                if (this._frameIndex === this._frameCount - 1) {\r\n                    this._frameDurationR = 1.0 / (this._animationData.duration - this._framePosition);\r\n                }\r\n                else {\r\n                    var nextFrameOffset = this._animationData.frameOffset + this._timelineArray[this._timelineData.offset + 5 /* TimelineFrameOffset */ + this._frameIndex + 1];\r\n                    var frameDuration = this._frameArray[nextFrameOffset] * this._frameRateR - this._framePosition;\r\n                    if (frameDuration > 0) {\r\n                        this._frameDurationR = 1.0 / frameDuration;\r\n                    }\r\n                    else {\r\n                        this._frameDurationR = 0.0;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                this.dirty = true;\r\n                this._isTween = false;\r\n            }\r\n        };\r\n        TweenTimelineState.prototype._onUpdateFrame = function () {\r\n            if (this._isTween) {\r\n                this.dirty = true;\r\n                this._tweenProgress = (this.currentTime - this._framePosition) * this._frameDurationR;\r\n                if (this._tweenType === 2 /* Curve */) {\r\n                    this._tweenProgress = TweenTimelineState._getEasingCurveValue(this._tweenProgress, this._frameArray, this._curveCount, this._frameOffset + 3 /* FrameCurveSamples */);\r\n                }\r\n                else if (this._tweenType !== 1 /* Line */) {\r\n                    this._tweenProgress = TweenTimelineState._getEasingValue(this._tweenType, this._tweenProgress, this._tweenEasing);\r\n                }\r\n            }\r\n        };\r\n        return TweenTimelineState;\r\n    }(TimelineState));\r\n    dragonBones.TweenTimelineState = TweenTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SingleValueTimelineState = /** @class */ (function (_super) {\r\n        __extends(SingleValueTimelineState, _super);\r\n        function SingleValueTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        SingleValueTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._current = 0.0;\r\n            this._difference = 0.0;\r\n            this._result = 0.0;\r\n        };\r\n        SingleValueTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData !== null) {\r\n                var valueScale = this._valueScale;\r\n                var valueArray = this._valueArray;\r\n                //\r\n                var valueOffset = this._valueOffset + this._frameValueOffset + this._frameIndex;\r\n                if (this._isTween) {\r\n                    var nextValueOffset = this._frameIndex === this._frameCount - 1 ?\r\n                        this._valueOffset + this._frameValueOffset :\r\n                        valueOffset + 1;\r\n                    if (valueScale === 1.0) {\r\n                        this._current = valueArray[valueOffset];\r\n                        this._difference = valueArray[nextValueOffset] - this._current;\r\n                    }\r\n                    else {\r\n                        this._current = valueArray[valueOffset] * valueScale;\r\n                        this._difference = valueArray[nextValueOffset] * valueScale - this._current;\r\n                    }\r\n                }\r\n                else {\r\n                    this._result = valueArray[valueOffset] * valueScale;\r\n                }\r\n            }\r\n            else {\r\n                this._result = 0.0;\r\n            }\r\n        };\r\n        SingleValueTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            if (this._isTween) {\r\n                this._result = this._current + this._difference * this._tweenProgress;\r\n            }\r\n        };\r\n        return SingleValueTimelineState;\r\n    }(TweenTimelineState));\r\n    dragonBones.SingleValueTimelineState = SingleValueTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var DoubleValueTimelineState = /** @class */ (function (_super) {\r\n        __extends(DoubleValueTimelineState, _super);\r\n        function DoubleValueTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        DoubleValueTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._currentA = 0.0;\r\n            this._currentB = 0.0;\r\n            this._differenceA = 0.0;\r\n            this._differenceB = 0.0;\r\n            this._resultA = 0.0;\r\n            this._resultB = 0.0;\r\n        };\r\n        DoubleValueTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData !== null) {\r\n                var valueScale = this._valueScale;\r\n                var valueArray = this._valueArray;\r\n                //\r\n                var valueOffset = this._valueOffset + this._frameValueOffset + this._frameIndex * 2;\r\n                if (this._isTween) {\r\n                    var nextValueOffset = this._frameIndex === this._frameCount - 1 ?\r\n                        this._valueOffset + this._frameValueOffset :\r\n                        valueOffset + 2;\r\n                    if (valueScale === 1.0) {\r\n                        this._currentA = valueArray[valueOffset];\r\n                        this._currentB = valueArray[valueOffset + 1];\r\n                        this._differenceA = valueArray[nextValueOffset] - this._currentA;\r\n                        this._differenceB = valueArray[nextValueOffset + 1] - this._currentB;\r\n                    }\r\n                    else {\r\n                        this._currentA = valueArray[valueOffset] * valueScale;\r\n                        this._currentB = valueArray[valueOffset + 1] * valueScale;\r\n                        this._differenceA = valueArray[nextValueOffset] * valueScale - this._currentA;\r\n                        this._differenceB = valueArray[nextValueOffset + 1] * valueScale - this._currentB;\r\n                    }\r\n                }\r\n                else {\r\n                    this._resultA = valueArray[valueOffset] * valueScale;\r\n                    this._resultB = valueArray[valueOffset + 1] * valueScale;\r\n                }\r\n            }\r\n            else {\r\n                this._resultA = 0.0;\r\n                this._resultB = 0.0;\r\n            }\r\n        };\r\n        DoubleValueTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            if (this._isTween) {\r\n                this._resultA = this._currentA + this._differenceA * this._tweenProgress;\r\n                this._resultB = this._currentB + this._differenceB * this._tweenProgress;\r\n            }\r\n        };\r\n        return DoubleValueTimelineState;\r\n    }(TweenTimelineState));\r\n    dragonBones.DoubleValueTimelineState = DoubleValueTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var MutilpleValueTimelineState = /** @class */ (function (_super) {\r\n        __extends(MutilpleValueTimelineState, _super);\r\n        function MutilpleValueTimelineState() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._rd = [];\r\n            return _this;\r\n        }\r\n        MutilpleValueTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._valueCount = 0;\r\n            this._rd.length = 0;\r\n        };\r\n        MutilpleValueTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            var valueCount = this._valueCount;\r\n            var rd = this._rd;\r\n            if (this._timelineData !== null) {\r\n                var valueScale = this._valueScale;\r\n                var valueArray = this._valueArray;\r\n                //\r\n                var valueOffset = this._valueOffset + this._frameValueOffset + this._frameIndex * valueCount;\r\n                if (this._isTween) {\r\n                    var nextValueOffset = this._frameIndex === this._frameCount - 1 ?\r\n                        this._valueOffset + this._frameValueOffset :\r\n                        valueOffset + valueCount;\r\n                    if (valueScale === 1.0) {\r\n                        for (var i = 0; i < valueCount; ++i) {\r\n                            rd[valueCount + i] = valueArray[nextValueOffset + i] - valueArray[valueOffset + i];\r\n                        }\r\n                    }\r\n                    else {\r\n                        for (var i = 0; i < valueCount; ++i) {\r\n                            rd[valueCount + i] = (valueArray[nextValueOffset + i] - valueArray[valueOffset + i]) * valueScale;\r\n                        }\r\n                    }\r\n                }\r\n                else if (valueScale === 1.0) {\r\n                    for (var i = 0; i < valueCount; ++i) {\r\n                        rd[i] = valueArray[valueOffset + i];\r\n                    }\r\n                }\r\n                else {\r\n                    for (var i = 0; i < valueCount; ++i) {\r\n                        rd[i] = valueArray[valueOffset + i] * valueScale;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                for (var i = 0; i < valueCount; ++i) {\r\n                    rd[i] = 0.0;\r\n                }\r\n            }\r\n        };\r\n        MutilpleValueTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            if (this._isTween) {\r\n                var valueCount = this._valueCount;\r\n                var valueScale = this._valueScale;\r\n                var tweenProgress = this._tweenProgress;\r\n                var valueArray = this._valueArray;\r\n                var rd = this._rd;\r\n                //\r\n                var valueOffset = this._valueOffset + this._frameValueOffset + this._frameIndex * valueCount;\r\n                if (valueScale === 1.0) {\r\n                    for (var i = 0; i < valueCount; ++i) {\r\n                        rd[i] = valueArray[valueOffset + i] + rd[valueCount + i] * tweenProgress;\r\n                    }\r\n                }\r\n                else {\r\n                    for (var i = 0; i < valueCount; ++i) {\r\n                        rd[i] = valueArray[valueOffset + i] * valueScale + rd[valueCount + i] * tweenProgress;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        return MutilpleValueTimelineState;\r\n    }(TweenTimelineState));\r\n    dragonBones.MutilpleValueTimelineState = MutilpleValueTimelineState;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @internal\r\n     */\r\n    var ActionTimelineState = /** @class */ (function (_super) {\r\n        __extends(ActionTimelineState, _super);\r\n        function ActionTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ActionTimelineState.toString = function () {\r\n            return "[class dragonBones.ActionTimelineState]";\r\n        };\r\n        ActionTimelineState.prototype._onCrossFrame = function (frameIndex) {\r\n            var eventDispatcher = this._armature.eventDispatcher;\r\n            if (this._animationState.actionEnabled) {\r\n                var frameOffset = this._animationData.frameOffset + this._timelineArray[this._timelineData.offset + 5 /* TimelineFrameOffset */ + frameIndex];\r\n                var actionCount = this._frameArray[frameOffset + 1];\r\n                var actions = this._animationData.parent.actions; // May be the animaton data not belong to this armature data.\r\n                for (var i = 0; i < actionCount; ++i) {\r\n                    var actionIndex = this._frameArray[frameOffset + 2 + i];\r\n                    var action = actions[actionIndex];\r\n                    if (action.type === 0 /* Play */) {\r\n                        var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                        // eventObject.time = this._frameArray[frameOffset] * this._frameRateR; // Precision problem\r\n                        eventObject.time = this._frameArray[frameOffset] / this._frameRate;\r\n                        eventObject.animationState = this._animationState;\r\n                        dragonBones.EventObject.actionDataToInstance(action, eventObject, this._armature);\r\n                        this._armature._bufferAction(eventObject, true);\r\n                    }\r\n                    else {\r\n                        var eventType = action.type === 10 /* Frame */ ? dragonBones.EventObject.FRAME_EVENT : dragonBones.EventObject.SOUND_EVENT;\r\n                        if (action.type === 11 /* Sound */ || eventDispatcher.hasDBEventListener(eventType)) {\r\n                            var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                            // eventObject.time = this._frameArray[frameOffset] * this._frameRateR; // Precision problem\r\n                            eventObject.time = this._frameArray[frameOffset] / this._frameRate;\r\n                            eventObject.animationState = this._animationState;\r\n                            dragonBones.EventObject.actionDataToInstance(action, eventObject, this._armature);\r\n                            this._armature._dragonBones.bufferEvent(eventObject);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        ActionTimelineState.prototype._onArriveAtFrame = function () { };\r\n        ActionTimelineState.prototype._onUpdateFrame = function () { };\r\n        ActionTimelineState.prototype.update = function (passedTime) {\r\n            var prevState = this.playState;\r\n            var prevPlayTimes = this.currentPlayTimes;\r\n            var prevTime = this.currentTime;\r\n            if (this._setCurrentTime(passedTime)) {\r\n                var eventActive = this._animationState._parent === null && this._animationState.actionEnabled;\r\n                var eventDispatcher = this._armature.eventDispatcher;\r\n                if (prevState < 0) {\r\n                    if (this.playState !== prevState) {\r\n                        if (this._animationState.displayControl && this._animationState.resetToPose) { // Reset zorder to pose.\r\n                            this._armature._sortZOrder(null, 0);\r\n                        }\r\n                        // prevPlayTimes = this.currentPlayTimes; // TODO\r\n                        if (eventActive && eventDispatcher.hasDBEventListener(dragonBones.EventObject.START)) {\r\n                            var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                            eventObject.type = dragonBones.EventObject.START;\r\n                            eventObject.armature = this._armature;\r\n                            eventObject.animationState = this._animationState;\r\n                            this._armature._dragonBones.bufferEvent(eventObject);\r\n                        }\r\n                    }\r\n                    else {\r\n                        return;\r\n                    }\r\n                }\r\n                var isReverse = this._animationState.timeScale < 0.0;\r\n                var loopCompleteEvent = null;\r\n                var completeEvent = null;\r\n                if (eventActive && this.currentPlayTimes !== prevPlayTimes) {\r\n                    if (eventDispatcher.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)) {\r\n                        loopCompleteEvent = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                        loopCompleteEvent.type = dragonBones.EventObject.LOOP_COMPLETE;\r\n                        loopCompleteEvent.armature = this._armature;\r\n                        loopCompleteEvent.animationState = this._animationState;\r\n                    }\r\n                    if (this.playState > 0) {\r\n                        if (eventDispatcher.hasDBEventListener(dragonBones.EventObject.COMPLETE)) {\r\n                            completeEvent = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                            completeEvent.type = dragonBones.EventObject.COMPLETE;\r\n                            completeEvent.armature = this._armature;\r\n                            completeEvent.animationState = this._animationState;\r\n                        }\r\n                    }\r\n                }\r\n                if (this._frameCount > 1) {\r\n                    var timelineData = this._timelineData;\r\n                    var timelineFrameIndex = Math.floor(this.currentTime * this._frameRate); // uint\r\n                    var frameIndex = this._frameIndices[timelineData.frameIndicesOffset + timelineFrameIndex];\r\n                    if (this._frameIndex !== frameIndex) { // Arrive at frame.                   \r\n                        var crossedFrameIndex = this._frameIndex;\r\n                        this._frameIndex = frameIndex;\r\n                        if (this._timelineArray !== null) {\r\n                            this._frameOffset = this._animationData.frameOffset + this._timelineArray[timelineData.offset + 5 /* TimelineFrameOffset */ + this._frameIndex];\r\n                            if (isReverse) {\r\n                                if (crossedFrameIndex < 0) {\r\n                                    var prevFrameIndex = Math.floor(prevTime * this._frameRate);\r\n                                    crossedFrameIndex = this._frameIndices[timelineData.frameIndicesOffset + prevFrameIndex];\r\n                                    if (this.currentPlayTimes === prevPlayTimes) { // Start.\r\n                                        if (crossedFrameIndex === frameIndex) { // Uncrossed.\r\n                                            crossedFrameIndex = -1;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                while (crossedFrameIndex >= 0) {\r\n                                    var frameOffset = this._animationData.frameOffset + this._timelineArray[timelineData.offset + 5 /* TimelineFrameOffset */ + crossedFrameIndex];\r\n                                    // const framePosition = this._frameArray[frameOffset] * this._frameRateR; // Precision problem\r\n                                    var framePosition = this._frameArray[frameOffset] / this._frameRate;\r\n                                    if (this._position <= framePosition &&\r\n                                        framePosition <= this._position + this._duration) { // Support interval play.\r\n                                        this._onCrossFrame(crossedFrameIndex);\r\n                                    }\r\n                                    if (loopCompleteEvent !== null && crossedFrameIndex === 0) { // Add loop complete event after first frame.\r\n                                        this._armature._dragonBones.bufferEvent(loopCompleteEvent);\r\n                                        loopCompleteEvent = null;\r\n                                    }\r\n                                    if (crossedFrameIndex > 0) {\r\n                                        crossedFrameIndex--;\r\n                                    }\r\n                                    else {\r\n                                        crossedFrameIndex = this._frameCount - 1;\r\n                                    }\r\n                                    if (crossedFrameIndex === frameIndex) {\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (crossedFrameIndex < 0) {\r\n                                    var prevFrameIndex = Math.floor(prevTime * this._frameRate);\r\n                                    crossedFrameIndex = this._frameIndices[timelineData.frameIndicesOffset + prevFrameIndex];\r\n                                    var frameOffset = this._animationData.frameOffset + this._timelineArray[timelineData.offset + 5 /* TimelineFrameOffset */ + crossedFrameIndex];\r\n                                    // const framePosition = this._frameArray[frameOffset] * this._frameRateR; // Precision problem\r\n                                    var framePosition = this._frameArray[frameOffset] / this._frameRate;\r\n                                    if (this.currentPlayTimes === prevPlayTimes) { // Start.\r\n                                        if (prevTime <= framePosition) { // Crossed.\r\n                                            if (crossedFrameIndex > 0) {\r\n                                                crossedFrameIndex--;\r\n                                            }\r\n                                            else {\r\n                                                crossedFrameIndex = this._frameCount - 1;\r\n                                            }\r\n                                        }\r\n                                        else if (crossedFrameIndex === frameIndex) { // Uncrossed.\r\n                                            crossedFrameIndex = -1;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                while (crossedFrameIndex >= 0) {\r\n                                    if (crossedFrameIndex < this._frameCount - 1) {\r\n                                        crossedFrameIndex++;\r\n                                    }\r\n                                    else {\r\n                                        crossedFrameIndex = 0;\r\n                                    }\r\n                                    var frameOffset = this._animationData.frameOffset + this._timelineArray[timelineData.offset + 5 /* TimelineFrameOffset */ + crossedFrameIndex];\r\n                                    // const framePosition = this._frameArray[frameOffset] * this._frameRateR; // Precision problem\r\n                                    var framePosition = this._frameArray[frameOffset] / this._frameRate;\r\n                                    if (this._position <= framePosition &&\r\n                                        framePosition <= this._position + this._duration //\r\n                                    ) { // Support interval play.\r\n                                        this._onCrossFrame(crossedFrameIndex);\r\n                                    }\r\n                                    if (loopCompleteEvent !== null && crossedFrameIndex === 0) { // Add loop complete event before first frame.\r\n                                        this._armature._dragonBones.bufferEvent(loopCompleteEvent);\r\n                                        loopCompleteEvent = null;\r\n                                    }\r\n                                    if (crossedFrameIndex === frameIndex) {\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else if (this._frameIndex < 0) {\r\n                    this._frameIndex = 0;\r\n                    if (this._timelineData !== null) {\r\n                        this._frameOffset = this._animationData.frameOffset + this._timelineArray[this._timelineData.offset + 5 /* TimelineFrameOffset */];\r\n                        // Arrive at frame.\r\n                        var framePosition = this._frameArray[this._frameOffset] / this._frameRate;\r\n                        if (this.currentPlayTimes === prevPlayTimes) { // Start.\r\n                            if (prevTime <= framePosition) {\r\n                                this._onCrossFrame(this._frameIndex);\r\n                            }\r\n                        }\r\n                        else if (this._position <= framePosition) { // Loop complete.\r\n                            if (!isReverse && loopCompleteEvent !== null) { // Add loop complete event before first frame.\r\n                                this._armature._dragonBones.bufferEvent(loopCompleteEvent);\r\n                                loopCompleteEvent = null;\r\n                            }\r\n                            this._onCrossFrame(this._frameIndex);\r\n                        }\r\n                    }\r\n                }\r\n                if (loopCompleteEvent !== null) {\r\n                    this._armature._dragonBones.bufferEvent(loopCompleteEvent);\r\n                }\r\n                if (completeEvent !== null) {\r\n                    this._armature._dragonBones.bufferEvent(completeEvent);\r\n                }\r\n            }\r\n        };\r\n        ActionTimelineState.prototype.setCurrentTime = function (value) {\r\n            this._setCurrentTime(value);\r\n            this._frameIndex = -1;\r\n        };\r\n        return ActionTimelineState;\r\n    }(dragonBones.TimelineState));\r\n    dragonBones.ActionTimelineState = ActionTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var ZOrderTimelineState = /** @class */ (function (_super) {\r\n        __extends(ZOrderTimelineState, _super);\r\n        function ZOrderTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ZOrderTimelineState.toString = function () {\r\n            return "[class dragonBones.ZOrderTimelineState]";\r\n        };\r\n        ZOrderTimelineState.prototype._onArriveAtFrame = function () {\r\n            if (this.playState >= 0) {\r\n                var count = this._frameArray[this._frameOffset + 1];\r\n                if (count > 0) {\r\n                    this._armature._sortZOrder(this._frameArray, this._frameOffset + 2);\r\n                }\r\n                else {\r\n                    this._armature._sortZOrder(null, 0);\r\n                }\r\n            }\r\n        };\r\n        ZOrderTimelineState.prototype._onUpdateFrame = function () { };\r\n        return ZOrderTimelineState;\r\n    }(dragonBones.TimelineState));\r\n    dragonBones.ZOrderTimelineState = ZOrderTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var BoneAllTimelineState = /** @class */ (function (_super) {\r\n        __extends(BoneAllTimelineState, _super);\r\n        function BoneAllTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BoneAllTimelineState.toString = function () {\r\n            return "[class dragonBones.BoneAllTimelineState]";\r\n        };\r\n        BoneAllTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._isTween && this._frameIndex === this._frameCount - 1) {\r\n                this._rd[2] = dragonBones.Transform.normalizeRadian(this._rd[2]);\r\n                this._rd[3] = dragonBones.Transform.normalizeRadian(this._rd[3]);\r\n            }\r\n            if (this._timelineData === null) { // Pose.\r\n                this._rd[4] = 1.0;\r\n                this._rd[5] = 1.0;\r\n            }\r\n        };\r\n        BoneAllTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameFloatOffset;\r\n            this._valueCount = 6;\r\n            this._valueArray = this._animationData.parent.parent.frameFloatArray;\r\n        };\r\n        BoneAllTimelineState.prototype.fadeOut = function () {\r\n            this.dirty = false;\r\n            this._rd[2] = dragonBones.Transform.normalizeRadian(this._rd[2]);\r\n            this._rd[3] = dragonBones.Transform.normalizeRadian(this._rd[3]);\r\n        };\r\n        BoneAllTimelineState.prototype.blend = function (isDirty) {\r\n            var valueScale = this._armature.armatureData.scale;\r\n            var rd = this._rd;\r\n            //\r\n            var blendState = this.target;\r\n            var bone = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = bone.animationPose;\r\n            if (blendState.dirty > 1) {\r\n                result.x += rd[0] * blendWeight * valueScale;\r\n                result.y += rd[1] * blendWeight * valueScale;\r\n                result.rotation += rd[2] * blendWeight;\r\n                result.skew += rd[3] * blendWeight;\r\n                result.scaleX += (rd[4] - 1.0) * blendWeight;\r\n                result.scaleY += (rd[5] - 1.0) * blendWeight;\r\n            }\r\n            else {\r\n                result.x = rd[0] * blendWeight * valueScale;\r\n                result.y = rd[1] * blendWeight * valueScale;\r\n                result.rotation = rd[2] * blendWeight;\r\n                result.skew = rd[3] * blendWeight;\r\n                result.scaleX = (rd[4] - 1.0) * blendWeight + 1.0; // \r\n                result.scaleY = (rd[5] - 1.0) * blendWeight + 1.0; //\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                bone._transformDirty = true;\r\n            }\r\n        };\r\n        return BoneAllTimelineState;\r\n    }(dragonBones.MutilpleValueTimelineState));\r\n    dragonBones.BoneAllTimelineState = BoneAllTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var BoneTranslateTimelineState = /** @class */ (function (_super) {\r\n        __extends(BoneTranslateTimelineState, _super);\r\n        function BoneTranslateTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BoneTranslateTimelineState.toString = function () {\r\n            return "[class dragonBones.BoneTranslateTimelineState]";\r\n        };\r\n        BoneTranslateTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameFloatOffset;\r\n            this._valueScale = this._armature.armatureData.scale;\r\n            this._valueArray = this._animationData.parent.parent.frameFloatArray;\r\n        };\r\n        BoneTranslateTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var bone = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = bone.animationPose;\r\n            if (blendState.dirty > 1) {\r\n                result.x += this._resultA * blendWeight;\r\n                result.y += this._resultB * blendWeight;\r\n            }\r\n            else if (blendWeight !== 1.0) {\r\n                result.x = this._resultA * blendWeight;\r\n                result.y = this._resultB * blendWeight;\r\n            }\r\n            else {\r\n                result.x = this._resultA;\r\n                result.y = this._resultB;\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                bone._transformDirty = true;\r\n            }\r\n        };\r\n        return BoneTranslateTimelineState;\r\n    }(dragonBones.DoubleValueTimelineState));\r\n    dragonBones.BoneTranslateTimelineState = BoneTranslateTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var BoneRotateTimelineState = /** @class */ (function (_super) {\r\n        __extends(BoneRotateTimelineState, _super);\r\n        function BoneRotateTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BoneRotateTimelineState.toString = function () {\r\n            return "[class dragonBones.BoneRotateTimelineState]";\r\n        };\r\n        BoneRotateTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._isTween && this._frameIndex === this._frameCount - 1) {\r\n                this._differenceA = dragonBones.Transform.normalizeRadian(this._differenceA);\r\n                this._differenceB = dragonBones.Transform.normalizeRadian(this._differenceB);\r\n            }\r\n        };\r\n        BoneRotateTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameFloatOffset;\r\n            this._valueArray = this._animationData.parent.parent.frameFloatArray;\r\n        };\r\n        BoneRotateTimelineState.prototype.fadeOut = function () {\r\n            this.dirty = false;\r\n            this._resultA = dragonBones.Transform.normalizeRadian(this._resultA);\r\n            this._resultB = dragonBones.Transform.normalizeRadian(this._resultB);\r\n        };\r\n        BoneRotateTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var bone = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = bone.animationPose;\r\n            if (blendState.dirty > 1) {\r\n                result.rotation += this._resultA * blendWeight;\r\n                result.skew += this._resultB * blendWeight;\r\n            }\r\n            else if (blendWeight !== 1.0) {\r\n                result.rotation = this._resultA * blendWeight;\r\n                result.skew = this._resultB * blendWeight;\r\n            }\r\n            else {\r\n                result.rotation = this._resultA;\r\n                result.skew = this._resultB;\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                bone._transformDirty = true;\r\n            }\r\n        };\r\n        return BoneRotateTimelineState;\r\n    }(dragonBones.DoubleValueTimelineState));\r\n    dragonBones.BoneRotateTimelineState = BoneRotateTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var BoneScaleTimelineState = /** @class */ (function (_super) {\r\n        __extends(BoneScaleTimelineState, _super);\r\n        function BoneScaleTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BoneScaleTimelineState.toString = function () {\r\n            return "[class dragonBones.BoneScaleTimelineState]";\r\n        };\r\n        BoneScaleTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData === null) { // Pose.\r\n                this._resultA = 1.0;\r\n                this._resultB = 1.0;\r\n            }\r\n        };\r\n        BoneScaleTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameFloatOffset;\r\n            this._valueArray = this._animationData.parent.parent.frameFloatArray;\r\n        };\r\n        BoneScaleTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var bone = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = bone.animationPose;\r\n            if (blendState.dirty > 1) {\r\n                result.scaleX += (this._resultA - 1.0) * blendWeight;\r\n                result.scaleY += (this._resultB - 1.0) * blendWeight;\r\n            }\r\n            else if (blendWeight !== 1.0) {\r\n                result.scaleX = (this._resultA - 1.0) * blendWeight + 1.0;\r\n                result.scaleY = (this._resultB - 1.0) * blendWeight + 1.0;\r\n            }\r\n            else {\r\n                result.scaleX = this._resultA;\r\n                result.scaleY = this._resultB;\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                bone._transformDirty = true;\r\n            }\r\n        };\r\n        return BoneScaleTimelineState;\r\n    }(dragonBones.DoubleValueTimelineState));\r\n    dragonBones.BoneScaleTimelineState = BoneScaleTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SurfaceTimelineState = /** @class */ (function (_super) {\r\n        __extends(SurfaceTimelineState, _super);\r\n        function SurfaceTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        SurfaceTimelineState.toString = function () {\r\n            return "[class dragonBones.SurfaceTimelineState]";\r\n        };\r\n        SurfaceTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this._deformCount = 0;\r\n            this._deformOffset = 0;\r\n            this._sameValueOffset = 0;\r\n        };\r\n        SurfaceTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            if (this._timelineData !== null) {\r\n                var dragonBonesData = this._animationData.parent.parent;\r\n                var frameIntArray = dragonBonesData.frameIntArray;\r\n                var frameIntOffset = this._animationData.frameIntOffset + this._timelineArray[this._timelineData.offset + 3 /* TimelineFrameValueCount */];\r\n                this._valueOffset = this._animationData.frameFloatOffset;\r\n                this._valueCount = frameIntArray[frameIntOffset + 2 /* DeformValueCount */];\r\n                this._deformCount = frameIntArray[frameIntOffset + 1 /* DeformCount */];\r\n                this._deformOffset = frameIntArray[frameIntOffset + 3 /* DeformValueOffset */];\r\n                this._sameValueOffset = frameIntArray[frameIntOffset + 4 /* DeformFloatOffset */] + this._animationData.frameFloatOffset;\r\n                this._valueScale = this._armature.armatureData.scale;\r\n                this._valueArray = dragonBonesData.frameFloatArray;\r\n                this._rd.length = this._valueCount * 2;\r\n            }\r\n            else {\r\n                this._deformCount = this.target.target._deformVertices.length;\r\n            }\r\n        };\r\n        SurfaceTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var surface = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = surface._deformVertices;\r\n            var valueArray = this._valueArray;\r\n            if (valueArray !== null) {\r\n                var valueCount = this._valueCount;\r\n                var deformOffset = this._deformOffset;\r\n                var sameValueOffset = this._sameValueOffset;\r\n                var rd = this._rd;\r\n                for (var i = 0; i < this._deformCount; ++i) {\r\n                    var value = 0.0;\r\n                    if (i < deformOffset) {\r\n                        value = valueArray[sameValueOffset + i];\r\n                    }\r\n                    else if (i < deformOffset + valueCount) {\r\n                        value = rd[i - deformOffset];\r\n                    }\r\n                    else {\r\n                        value = valueArray[sameValueOffset + i - valueCount];\r\n                    }\r\n                    if (blendState.dirty > 1) {\r\n                        result[i] += value * blendWeight;\r\n                    }\r\n                    else {\r\n                        result[i] = value * blendWeight;\r\n                    }\r\n                }\r\n            }\r\n            else if (blendState.dirty === 1) {\r\n                for (var i = 0; i < this._deformCount; ++i) {\r\n                    result[i] = 0.0;\r\n                }\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                surface._transformDirty = true;\r\n            }\r\n        };\r\n        return SurfaceTimelineState;\r\n    }(dragonBones.MutilpleValueTimelineState));\r\n    dragonBones.SurfaceTimelineState = SurfaceTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var AlphaTimelineState = /** @class */ (function (_super) {\r\n        __extends(AlphaTimelineState, _super);\r\n        function AlphaTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        AlphaTimelineState.toString = function () {\r\n            return "[class dragonBones.AlphaTimelineState]";\r\n        };\r\n        AlphaTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData === null) { // Pose.\r\n                this._result = 1.0;\r\n            }\r\n        };\r\n        AlphaTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueScale = 0.01;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        AlphaTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var alphaTarget = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            if (blendState.dirty > 1) {\r\n                alphaTarget._alpha += this._result * blendWeight;\r\n                if (alphaTarget._alpha > 1.0) {\r\n                    alphaTarget._alpha = 1.0;\r\n                }\r\n            }\r\n            else {\r\n                alphaTarget._alpha = this._result * blendWeight;\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                this._armature._alphaDirty = true;\r\n            }\r\n        };\r\n        return AlphaTimelineState;\r\n    }(dragonBones.SingleValueTimelineState));\r\n    dragonBones.AlphaTimelineState = AlphaTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SlotDisplayTimelineState = /** @class */ (function (_super) {\r\n        __extends(SlotDisplayTimelineState, _super);\r\n        function SlotDisplayTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        SlotDisplayTimelineState.toString = function () {\r\n            return "[class dragonBones.SlotDisplayTimelineState]";\r\n        };\r\n        SlotDisplayTimelineState.prototype._onArriveAtFrame = function () {\r\n            if (this.playState >= 0) {\r\n                var slot = this.target;\r\n                var displayIndex = this._timelineData !== null ? this._frameArray[this._frameOffset + 1] : slot._slotData.displayIndex;\r\n                if (slot.displayIndex !== displayIndex) {\r\n                    slot._setDisplayIndex(displayIndex, true);\r\n                }\r\n            }\r\n        };\r\n        SlotDisplayTimelineState.prototype._onUpdateFrame = function () {\r\n        };\r\n        return SlotDisplayTimelineState;\r\n    }(dragonBones.TimelineState));\r\n    dragonBones.SlotDisplayTimelineState = SlotDisplayTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SlotColorTimelineState = /** @class */ (function (_super) {\r\n        __extends(SlotColorTimelineState, _super);\r\n        function SlotColorTimelineState() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._current = [0, 0, 0, 0, 0, 0, 0, 0];\r\n            _this._difference = [0, 0, 0, 0, 0, 0, 0, 0];\r\n            _this._result = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0];\r\n            return _this;\r\n        }\r\n        SlotColorTimelineState.toString = function () {\r\n            return "[class dragonBones.SlotColorTimelineState]";\r\n        };\r\n        SlotColorTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData !== null) {\r\n                var dragonBonesData = this._animationData.parent.parent;\r\n                var colorArray = dragonBonesData.colorArray;\r\n                var frameIntArray = dragonBonesData.frameIntArray;\r\n                var valueOffset = this._animationData.frameIntOffset + this._frameValueOffset + this._frameIndex;\r\n                var colorOffset = frameIntArray[valueOffset];\r\n                if (colorOffset < 0) {\r\n                    colorOffset += 65536; // Fixed out of bounds bug. \r\n                }\r\n                if (this._isTween) {\r\n                    this._current[0] = colorArray[colorOffset++];\r\n                    this._current[1] = colorArray[colorOffset++];\r\n                    this._current[2] = colorArray[colorOffset++];\r\n                    this._current[3] = colorArray[colorOffset++];\r\n                    this._current[4] = colorArray[colorOffset++];\r\n                    this._current[5] = colorArray[colorOffset++];\r\n                    this._current[6] = colorArray[colorOffset++];\r\n                    this._current[7] = colorArray[colorOffset++];\r\n                    if (this._frameIndex === this._frameCount - 1) {\r\n                        colorOffset = frameIntArray[this._animationData.frameIntOffset + this._frameValueOffset];\r\n                    }\r\n                    else {\r\n                        colorOffset = frameIntArray[valueOffset + 1];\r\n                    }\r\n                    if (colorOffset < 0) {\r\n                        colorOffset += 65536; // Fixed out of bounds bug. \r\n                    }\r\n                    this._difference[0] = colorArray[colorOffset++] - this._current[0];\r\n                    this._difference[1] = colorArray[colorOffset++] - this._current[1];\r\n                    this._difference[2] = colorArray[colorOffset++] - this._current[2];\r\n                    this._difference[3] = colorArray[colorOffset++] - this._current[3];\r\n                    this._difference[4] = colorArray[colorOffset++] - this._current[4];\r\n                    this._difference[5] = colorArray[colorOffset++] - this._current[5];\r\n                    this._difference[6] = colorArray[colorOffset++] - this._current[6];\r\n                    this._difference[7] = colorArray[colorOffset++] - this._current[7];\r\n                }\r\n                else {\r\n                    this._result[0] = colorArray[colorOffset++] * 0.01;\r\n                    this._result[1] = colorArray[colorOffset++] * 0.01;\r\n                    this._result[2] = colorArray[colorOffset++] * 0.01;\r\n                    this._result[3] = colorArray[colorOffset++] * 0.01;\r\n                    this._result[4] = colorArray[colorOffset++];\r\n                    this._result[5] = colorArray[colorOffset++];\r\n                    this._result[6] = colorArray[colorOffset++];\r\n                    this._result[7] = colorArray[colorOffset++];\r\n                }\r\n            }\r\n            else { // Pose.\r\n                var slot = this.target;\r\n                var color = slot.slotData.color;\r\n                this._result[0] = color.alphaMultiplier;\r\n                this._result[1] = color.redMultiplier;\r\n                this._result[2] = color.greenMultiplier;\r\n                this._result[3] = color.blueMultiplier;\r\n                this._result[4] = color.alphaOffset;\r\n                this._result[5] = color.redOffset;\r\n                this._result[6] = color.greenOffset;\r\n                this._result[7] = color.blueOffset;\r\n            }\r\n        };\r\n        SlotColorTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            if (this._isTween) {\r\n                this._result[0] = (this._current[0] + this._difference[0] * this._tweenProgress) * 0.01;\r\n                this._result[1] = (this._current[1] + this._difference[1] * this._tweenProgress) * 0.01;\r\n                this._result[2] = (this._current[2] + this._difference[2] * this._tweenProgress) * 0.01;\r\n                this._result[3] = (this._current[3] + this._difference[3] * this._tweenProgress) * 0.01;\r\n                this._result[4] = this._current[4] + this._difference[4] * this._tweenProgress;\r\n                this._result[5] = this._current[5] + this._difference[5] * this._tweenProgress;\r\n                this._result[6] = this._current[6] + this._difference[6] * this._tweenProgress;\r\n                this._result[7] = this._current[7] + this._difference[7] * this._tweenProgress;\r\n            }\r\n        };\r\n        SlotColorTimelineState.prototype.fadeOut = function () {\r\n            this._isTween = false;\r\n        };\r\n        SlotColorTimelineState.prototype.update = function (passedTime) {\r\n            _super.prototype.update.call(this, passedTime);\r\n            // Fade animation.\r\n            if (this._isTween || this.dirty) {\r\n                var slot = this.target;\r\n                var result = slot._colorTransform;\r\n                if (this._animationState._fadeState !== 0 || this._animationState._subFadeState !== 0) {\r\n                    if (result.alphaMultiplier !== this._result[0] ||\r\n                        result.redMultiplier !== this._result[1] ||\r\n                        result.greenMultiplier !== this._result[2] ||\r\n                        result.blueMultiplier !== this._result[3] ||\r\n                        result.alphaOffset !== this._result[4] ||\r\n                        result.redOffset !== this._result[5] ||\r\n                        result.greenOffset !== this._result[6] ||\r\n                        result.blueOffset !== this._result[7]) {\r\n                        var fadeProgress = Math.pow(this._animationState._fadeProgress, 4);\r\n                        result.alphaMultiplier += (this._result[0] - result.alphaMultiplier) * fadeProgress;\r\n                        result.redMultiplier += (this._result[1] - result.redMultiplier) * fadeProgress;\r\n                        result.greenMultiplier += (this._result[2] - result.greenMultiplier) * fadeProgress;\r\n                        result.blueMultiplier += (this._result[3] - result.blueMultiplier) * fadeProgress;\r\n                        result.alphaOffset += (this._result[4] - result.alphaOffset) * fadeProgress;\r\n                        result.redOffset += (this._result[5] - result.redOffset) * fadeProgress;\r\n                        result.greenOffset += (this._result[6] - result.greenOffset) * fadeProgress;\r\n                        result.blueOffset += (this._result[7] - result.blueOffset) * fadeProgress;\r\n                        slot._colorDirty = true;\r\n                    }\r\n                }\r\n                else if (this.dirty) {\r\n                    this.dirty = false;\r\n                    if (result.alphaMultiplier !== this._result[0] ||\r\n                        result.redMultiplier !== this._result[1] ||\r\n                        result.greenMultiplier !== this._result[2] ||\r\n                        result.blueMultiplier !== this._result[3] ||\r\n                        result.alphaOffset !== this._result[4] ||\r\n                        result.redOffset !== this._result[5] ||\r\n                        result.greenOffset !== this._result[6] ||\r\n                        result.blueOffset !== this._result[7]) {\r\n                        result.alphaMultiplier = this._result[0];\r\n                        result.redMultiplier = this._result[1];\r\n                        result.greenMultiplier = this._result[2];\r\n                        result.blueMultiplier = this._result[3];\r\n                        result.alphaOffset = this._result[4];\r\n                        result.redOffset = this._result[5];\r\n                        result.greenOffset = this._result[6];\r\n                        result.blueOffset = this._result[7];\r\n                        slot._colorDirty = true;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        return SlotColorTimelineState;\r\n    }(dragonBones.TweenTimelineState));\r\n    dragonBones.SlotColorTimelineState = SlotColorTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var SlotZIndexTimelineState = /** @class */ (function (_super) {\r\n        __extends(SlotZIndexTimelineState, _super);\r\n        function SlotZIndexTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        SlotZIndexTimelineState.toString = function () {\r\n            return "[class dragonBones.SlotZIndexTimelineState]";\r\n        };\r\n        SlotZIndexTimelineState.prototype._onArriveAtFrame = function () {\r\n            _super.prototype._onArriveAtFrame.call(this);\r\n            if (this._timelineData === null) { // Pose.\r\n                var blendState = this.target;\r\n                var slot = blendState.target;\r\n                this._result = slot.slotData.zIndex;\r\n            }\r\n        };\r\n        SlotZIndexTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        SlotZIndexTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var slot = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            if (blendState.dirty > 1) {\r\n                slot._zIndex += this._result * blendWeight;\r\n            }\r\n            else {\r\n                slot._zIndex = this._result * blendWeight;\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                this._armature._zIndexDirty = true;\r\n            }\r\n        };\r\n        return SlotZIndexTimelineState;\r\n    }(dragonBones.SingleValueTimelineState));\r\n    dragonBones.SlotZIndexTimelineState = SlotZIndexTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var DeformTimelineState = /** @class */ (function (_super) {\r\n        __extends(DeformTimelineState, _super);\r\n        function DeformTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        DeformTimelineState.toString = function () {\r\n            return "[class dragonBones.DeformTimelineState]";\r\n        };\r\n        DeformTimelineState.prototype._onClear = function () {\r\n            _super.prototype._onClear.call(this);\r\n            this.geometryOffset = 0;\r\n            this.displayFrame = null;\r\n            this._deformCount = 0;\r\n            this._deformOffset = 0;\r\n            this._sameValueOffset = 0;\r\n        };\r\n        DeformTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            if (this._timelineData !== null) {\r\n                var frameIntOffset = this._animationData.frameIntOffset + this._timelineArray[this._timelineData.offset + 3 /* TimelineFrameValueCount */];\r\n                var dragonBonesData = this._animationData.parent.parent;\r\n                var frameIntArray = dragonBonesData.frameIntArray;\r\n                var slot = this.target.target;\r\n                this.geometryOffset = frameIntArray[frameIntOffset + 0 /* DeformVertexOffset */];\r\n                if (this.geometryOffset < 0) {\r\n                    this.geometryOffset += 65536; // Fixed out of bounds bug. \r\n                }\r\n                for (var i = 0, l = slot.displayFrameCount; i < l; ++i) {\r\n                    var displayFrame = slot.getDisplayFrameAt(i);\r\n                    var geometryData = displayFrame.getGeometryData();\r\n                    if (geometryData === null) {\r\n                        continue;\r\n                    }\r\n                    if (geometryData.offset === this.geometryOffset) {\r\n                        this.displayFrame = displayFrame;\r\n                        this.displayFrame.updateDeformVertices();\r\n                        break;\r\n                    }\r\n                }\r\n                if (this.displayFrame === null) {\r\n                    this.returnToPool(); //\r\n                    return;\r\n                }\r\n                this._valueOffset = this._animationData.frameFloatOffset;\r\n                this._valueCount = frameIntArray[frameIntOffset + 2 /* DeformValueCount */];\r\n                this._deformCount = frameIntArray[frameIntOffset + 1 /* DeformCount */];\r\n                this._deformOffset = frameIntArray[frameIntOffset + 3 /* DeformValueOffset */];\r\n                this._sameValueOffset = frameIntArray[frameIntOffset + 4 /* DeformFloatOffset */] + this._animationData.frameFloatOffset;\r\n                this._valueScale = this._armature.armatureData.scale;\r\n                this._valueArray = dragonBonesData.frameFloatArray;\r\n                this._rd.length = this._valueCount * 2;\r\n            }\r\n            else {\r\n                this._deformCount = this.displayFrame.deformVertices.length;\r\n            }\r\n        };\r\n        DeformTimelineState.prototype.blend = function (isDirty) {\r\n            var blendState = this.target;\r\n            var slot = blendState.target;\r\n            var blendWeight = blendState.blendWeight;\r\n            var result = this.displayFrame.deformVertices;\r\n            var valueArray = this._valueArray;\r\n            if (valueArray !== null) {\r\n                var valueCount = this._valueCount;\r\n                var deformOffset = this._deformOffset;\r\n                var sameValueOffset = this._sameValueOffset;\r\n                var rd = this._rd;\r\n                for (var i = 0; i < this._deformCount; ++i) {\r\n                    var value = 0.0;\r\n                    if (i < deformOffset) {\r\n                        value = valueArray[sameValueOffset + i];\r\n                    }\r\n                    else if (i < deformOffset + valueCount) {\r\n                        value = rd[i - deformOffset];\r\n                    }\r\n                    else {\r\n                        value = valueArray[sameValueOffset + i - valueCount];\r\n                    }\r\n                    if (blendState.dirty > 1) {\r\n                        result[i] += value * blendWeight;\r\n                    }\r\n                    else {\r\n                        result[i] = value * blendWeight;\r\n                    }\r\n                }\r\n            }\r\n            else if (blendState.dirty === 1) {\r\n                for (var i = 0; i < this._deformCount; ++i) {\r\n                    result[i] = 0.0;\r\n                }\r\n            }\r\n            if (isDirty || this.dirty) {\r\n                this.dirty = false;\r\n                if (slot._geometryData === this.displayFrame.getGeometryData()) {\r\n                    slot._verticesDirty = true;\r\n                }\r\n            }\r\n        };\r\n        return DeformTimelineState;\r\n    }(dragonBones.MutilpleValueTimelineState));\r\n    dragonBones.DeformTimelineState = DeformTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var IKConstraintTimelineState = /** @class */ (function (_super) {\r\n        __extends(IKConstraintTimelineState, _super);\r\n        function IKConstraintTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        IKConstraintTimelineState.toString = function () {\r\n            return "[class dragonBones.IKConstraintTimelineState]";\r\n        };\r\n        IKConstraintTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            var ikConstraint = this.target;\r\n            if (this._timelineData !== null) {\r\n                ikConstraint._bendPositive = this._currentA > 0.0;\r\n                ikConstraint._weight = this._currentB;\r\n            }\r\n            else {\r\n                var ikConstraintData = ikConstraint._constraintData;\r\n                ikConstraint._bendPositive = ikConstraintData.bendPositive;\r\n                ikConstraint._weight = ikConstraintData.weight;\r\n            }\r\n            ikConstraint.invalidUpdate();\r\n            this.dirty = false;\r\n        };\r\n        IKConstraintTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueScale = 0.01;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        return IKConstraintTimelineState;\r\n    }(dragonBones.DoubleValueTimelineState));\r\n    dragonBones.IKConstraintTimelineState = IKConstraintTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var AnimationProgressTimelineState = /** @class */ (function (_super) {\r\n        __extends(AnimationProgressTimelineState, _super);\r\n        function AnimationProgressTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        AnimationProgressTimelineState.toString = function () {\r\n            return "[class dragonBones.AnimationProgressTimelineState]";\r\n        };\r\n        AnimationProgressTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            var animationState = this.target;\r\n            if (animationState._parent !== null) {\r\n                animationState.currentTime = this._result * animationState.totalTime;\r\n            }\r\n            this.dirty = false;\r\n        };\r\n        AnimationProgressTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueScale = 0.0001;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        return AnimationProgressTimelineState;\r\n    }(dragonBones.SingleValueTimelineState));\r\n    dragonBones.AnimationProgressTimelineState = AnimationProgressTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var AnimationWeightTimelineState = /** @class */ (function (_super) {\r\n        __extends(AnimationWeightTimelineState, _super);\r\n        function AnimationWeightTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        AnimationWeightTimelineState.toString = function () {\r\n            return "[class dragonBones.AnimationWeightTimelineState]";\r\n        };\r\n        AnimationWeightTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            var animationState = this.target;\r\n            if (animationState._parent !== null) {\r\n                animationState.weight = this._result;\r\n            }\r\n            this.dirty = false;\r\n        };\r\n        AnimationWeightTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueScale = 0.0001;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        return AnimationWeightTimelineState;\r\n    }(dragonBones.SingleValueTimelineState));\r\n    dragonBones.AnimationWeightTimelineState = AnimationWeightTimelineState;\r\n    /**\r\n     * @internal\r\n     */\r\n    var AnimationParametersTimelineState = /** @class */ (function (_super) {\r\n        __extends(AnimationParametersTimelineState, _super);\r\n        function AnimationParametersTimelineState() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        AnimationParametersTimelineState.toString = function () {\r\n            return "[class dragonBones.AnimationParametersTimelineState]";\r\n        };\r\n        AnimationParametersTimelineState.prototype._onUpdateFrame = function () {\r\n            _super.prototype._onUpdateFrame.call(this);\r\n            var animationState = this.target;\r\n            if (animationState._parent !== null) {\r\n                animationState.parameterX = this._resultA;\r\n                animationState.parameterY = this._resultB;\r\n            }\r\n            this.dirty = false;\r\n        };\r\n        AnimationParametersTimelineState.prototype.init = function (armature, animationState, timelineData) {\r\n            _super.prototype.init.call(this, armature, animationState, timelineData);\r\n            this._valueOffset = this._animationData.frameIntOffset;\r\n            this._valueScale = 0.0001;\r\n            this._valueArray = this._animationData.parent.parent.frameIntArray;\r\n        };\r\n        return AnimationParametersTimelineState;\r\n    }(dragonBones.DoubleValueTimelineState));\r\n    dragonBones.AnimationParametersTimelineState = AnimationParametersTimelineState;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - The properties of the object carry basic information about an event,\r\n     * which are passed as parameter or parameter\'s parameter to event listeners when an event occurs.\r\n     * @version DragonBones 4.5\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 事件对象，包含有关事件的基本信息，当发生事件时，该实例将作为参数或参数的参数传递给事件侦听器。\r\n     * @version DragonBones 4.5\r\n     * @language zh_CN\r\n     */\r\n    var EventObject = /** @class */ (function (_super) {\r\n        __extends(EventObject, _super);\r\n        function EventObject() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        /**\r\n         * @internal\r\n         * @private\r\n         */\r\n        EventObject.actionDataToInstance = function (data, instance, armature) {\r\n            if (data.type === 0 /* Play */) {\r\n                instance.type = EventObject.FRAME_EVENT;\r\n            }\r\n            else {\r\n                instance.type = data.type === 10 /* Frame */ ? EventObject.FRAME_EVENT : EventObject.SOUND_EVENT;\r\n            }\r\n            instance.name = data.name;\r\n            instance.armature = armature;\r\n            instance.actionData = data;\r\n            instance.data = data.data;\r\n            if (data.bone !== null) {\r\n                instance.bone = armature.getBone(data.bone.name);\r\n            }\r\n            if (data.slot !== null) {\r\n                instance.slot = armature.getSlot(data.slot.name);\r\n            }\r\n        };\r\n        EventObject.toString = function () {\r\n            return "[class dragonBones.EventObject]";\r\n        };\r\n        EventObject.prototype._onClear = function () {\r\n            this.time = 0.0;\r\n            this.type = "";\r\n            this.name = "";\r\n            this.armature = null;\r\n            this.bone = null;\r\n            this.slot = null;\r\n            this.animationState = null;\r\n            this.actionData = null;\r\n            this.data = null;\r\n        };\r\n        /**\r\n         * - Animation start play.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画开始播放。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.START = "start";\r\n        /**\r\n         * - Animation loop play complete once.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画循环播放完成一次。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.LOOP_COMPLETE = "loopComplete";\r\n        /**\r\n         * - Animation play complete.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画播放完成。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.COMPLETE = "complete";\r\n        /**\r\n         * - Animation fade in start.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画淡入开始。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.FADE_IN = "fadeIn";\r\n        /**\r\n         * - Animation fade in complete.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画淡入完成。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.FADE_IN_COMPLETE = "fadeInComplete";\r\n        /**\r\n         * - Animation fade out start.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画淡出开始。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.FADE_OUT = "fadeOut";\r\n        /**\r\n         * - Animation fade out complete.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画淡出完成。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.FADE_OUT_COMPLETE = "fadeOutComplete";\r\n        /**\r\n         * - Animation frame event.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画帧事件。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.FRAME_EVENT = "frameEvent";\r\n        /**\r\n         * - Animation frame sound event.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 动画帧声音事件。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        EventObject.SOUND_EVENT = "soundEvent";\r\n        return EventObject;\r\n    }(dragonBones.BaseObject));\r\n    dragonBones.EventObject = EventObject;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var DataParser = /** @class */ (function () {\r\n        function DataParser() {\r\n        }\r\n        DataParser._getArmatureType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "stage":\r\n                    return 2 /* Stage */;\r\n                case "armature":\r\n                    return 0 /* Armature */;\r\n                case "movieclip":\r\n                    return 1 /* MovieClip */;\r\n                default:\r\n                    return 0 /* Armature */;\r\n            }\r\n        };\r\n        DataParser._getBoneType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "bone":\r\n                    return 0 /* Bone */;\r\n                case "surface":\r\n                    return 1 /* Surface */;\r\n                default:\r\n                    return 0 /* Bone */;\r\n            }\r\n        };\r\n        DataParser._getPositionMode = function (value) {\r\n            switch (value.toLocaleLowerCase()) {\r\n                case "percent":\r\n                    return 1 /* Percent */;\r\n                case "fixed":\r\n                    return 0 /* Fixed */;\r\n                default:\r\n                    return 1 /* Percent */;\r\n            }\r\n        };\r\n        DataParser._getSpacingMode = function (value) {\r\n            switch (value.toLocaleLowerCase()) {\r\n                case "length":\r\n                    return 0 /* Length */;\r\n                case "percent":\r\n                    return 2 /* Percent */;\r\n                case "fixed":\r\n                    return 1 /* Fixed */;\r\n                default:\r\n                    return 0 /* Length */;\r\n            }\r\n        };\r\n        DataParser._getRotateMode = function (value) {\r\n            switch (value.toLocaleLowerCase()) {\r\n                case "tangent":\r\n                    return 0 /* Tangent */;\r\n                case "chain":\r\n                    return 1 /* Chain */;\r\n                case "chainscale":\r\n                    return 2 /* ChainScale */;\r\n                default:\r\n                    return 0 /* Tangent */;\r\n            }\r\n        };\r\n        DataParser._getDisplayType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "image":\r\n                    return 0 /* Image */;\r\n                case "mesh":\r\n                    return 2 /* Mesh */;\r\n                case "armature":\r\n                    return 1 /* Armature */;\r\n                case "boundingbox":\r\n                    return 3 /* BoundingBox */;\r\n                case "path":\r\n                    return 4 /* Path */;\r\n                default:\r\n                    return 0 /* Image */;\r\n            }\r\n        };\r\n        DataParser._getBoundingBoxType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "rectangle":\r\n                    return 0 /* Rectangle */;\r\n                case "ellipse":\r\n                    return 1 /* Ellipse */;\r\n                case "polygon":\r\n                    return 2 /* Polygon */;\r\n                default:\r\n                    return 0 /* Rectangle */;\r\n            }\r\n        };\r\n        DataParser._getBlendMode = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "normal":\r\n                    return 0 /* Normal */;\r\n                case "add":\r\n                    return 1 /* Add */;\r\n                case "alpha":\r\n                    return 2 /* Alpha */;\r\n                case "darken":\r\n                    return 3 /* Darken */;\r\n                case "difference":\r\n                    return 4 /* Difference */;\r\n                case "erase":\r\n                    return 5 /* Erase */;\r\n                case "hardlight":\r\n                    return 6 /* HardLight */;\r\n                case "invert":\r\n                    return 7 /* Invert */;\r\n                case "layer":\r\n                    return 8 /* Layer */;\r\n                case "lighten":\r\n                    return 9 /* Lighten */;\r\n                case "multiply":\r\n                    return 10 /* Multiply */;\r\n                case "overlay":\r\n                    return 11 /* Overlay */;\r\n                case "screen":\r\n                    return 12 /* Screen */;\r\n                case "subtract":\r\n                    return 13 /* Subtract */;\r\n                default:\r\n                    return 0 /* Normal */;\r\n            }\r\n        };\r\n        DataParser._getAnimationBlendType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "none":\r\n                    return 0 /* None */;\r\n                case "1d":\r\n                    return 1 /* E1D */;\r\n                default:\r\n                    return 0 /* None */;\r\n            }\r\n        };\r\n        DataParser._getActionType = function (value) {\r\n            switch (value.toLowerCase()) {\r\n                case "play":\r\n                    return 0 /* Play */;\r\n                case "frame":\r\n                    return 10 /* Frame */;\r\n                case "sound":\r\n                    return 11 /* Sound */;\r\n                default:\r\n                    return 0 /* Play */;\r\n            }\r\n        };\r\n        DataParser.DATA_VERSION_2_3 = "2.3";\r\n        DataParser.DATA_VERSION_3_0 = "3.0";\r\n        DataParser.DATA_VERSION_4_0 = "4.0";\r\n        DataParser.DATA_VERSION_4_5 = "4.5";\r\n        DataParser.DATA_VERSION_5_0 = "5.0";\r\n        DataParser.DATA_VERSION_5_5 = "5.5";\r\n        DataParser.DATA_VERSION_5_6 = "5.6";\r\n        DataParser.DATA_VERSION = DataParser.DATA_VERSION_5_6;\r\n        DataParser.DATA_VERSIONS = [\r\n            DataParser.DATA_VERSION_4_0,\r\n            DataParser.DATA_VERSION_4_5,\r\n            DataParser.DATA_VERSION_5_0,\r\n            DataParser.DATA_VERSION_5_5,\r\n            DataParser.DATA_VERSION_5_6\r\n        ];\r\n        DataParser.TEXTURE_ATLAS = "textureAtlas";\r\n        DataParser.SUB_TEXTURE = "SubTexture";\r\n        DataParser.FORMAT = "format";\r\n        DataParser.IMAGE_PATH = "imagePath";\r\n        DataParser.WIDTH = "width";\r\n        DataParser.HEIGHT = "height";\r\n        DataParser.ROTATED = "rotated";\r\n        DataParser.FRAME_X = "frameX";\r\n        DataParser.FRAME_Y = "frameY";\r\n        DataParser.FRAME_WIDTH = "frameWidth";\r\n        DataParser.FRAME_HEIGHT = "frameHeight";\r\n        DataParser.DRADON_BONES = "dragonBones";\r\n        DataParser.USER_DATA = "userData";\r\n        DataParser.ARMATURE = "armature";\r\n        DataParser.CANVAS = "canvas";\r\n        DataParser.BONE = "bone";\r\n        DataParser.SURFACE = "surface";\r\n        DataParser.SLOT = "slot";\r\n        DataParser.CONSTRAINT = "constraint";\r\n        DataParser.SKIN = "skin";\r\n        DataParser.DISPLAY = "display";\r\n        DataParser.FRAME = "frame";\r\n        DataParser.IK = "ik";\r\n        DataParser.PATH_CONSTRAINT = "path";\r\n        DataParser.ANIMATION = "animation";\r\n        DataParser.TIMELINE = "timeline";\r\n        DataParser.FFD = "ffd";\r\n        DataParser.TRANSLATE_FRAME = "translateFrame";\r\n        DataParser.ROTATE_FRAME = "rotateFrame";\r\n        DataParser.SCALE_FRAME = "scaleFrame";\r\n        DataParser.DISPLAY_FRAME = "displayFrame";\r\n        DataParser.COLOR_FRAME = "colorFrame";\r\n        DataParser.DEFAULT_ACTIONS = "defaultActions";\r\n        DataParser.ACTIONS = "actions";\r\n        DataParser.EVENTS = "events";\r\n        DataParser.INTS = "ints";\r\n        DataParser.FLOATS = "floats";\r\n        DataParser.STRINGS = "strings";\r\n        DataParser.TRANSFORM = "transform";\r\n        DataParser.PIVOT = "pivot";\r\n        DataParser.AABB = "aabb";\r\n        DataParser.COLOR = "color";\r\n        DataParser.VERSION = "version";\r\n        DataParser.COMPATIBLE_VERSION = "compatibleVersion";\r\n        DataParser.FRAME_RATE = "frameRate";\r\n        DataParser.TYPE = "type";\r\n        DataParser.SUB_TYPE = "subType";\r\n        DataParser.NAME = "name";\r\n        DataParser.PARENT = "parent";\r\n        DataParser.TARGET = "target";\r\n        DataParser.STAGE = "stage";\r\n        DataParser.SHARE = "share";\r\n        DataParser.PATH = "path";\r\n        DataParser.LENGTH = "length";\r\n        DataParser.DISPLAY_INDEX = "displayIndex";\r\n        DataParser.Z_ORDER = "zOrder";\r\n        DataParser.Z_INDEX = "zIndex";\r\n        DataParser.BLEND_MODE = "blendMode";\r\n        DataParser.INHERIT_TRANSLATION = "inheritTranslation";\r\n        DataParser.INHERIT_ROTATION = "inheritRotation";\r\n        DataParser.INHERIT_SCALE = "inheritScale";\r\n        DataParser.INHERIT_REFLECTION = "inheritReflection";\r\n        DataParser.INHERIT_ANIMATION = "inheritAnimation";\r\n        DataParser.INHERIT_DEFORM = "inheritDeform";\r\n        DataParser.SEGMENT_X = "segmentX";\r\n        DataParser.SEGMENT_Y = "segmentY";\r\n        DataParser.BEND_POSITIVE = "bendPositive";\r\n        DataParser.CHAIN = "chain";\r\n        DataParser.WEIGHT = "weight";\r\n        DataParser.BLEND_TYPE = "blendType";\r\n        DataParser.FADE_IN_TIME = "fadeInTime";\r\n        DataParser.PLAY_TIMES = "playTimes";\r\n        DataParser.SCALE = "scale";\r\n        DataParser.OFFSET = "offset";\r\n        DataParser.POSITION = "position";\r\n        DataParser.DURATION = "duration";\r\n        DataParser.TWEEN_EASING = "tweenEasing";\r\n        DataParser.TWEEN_ROTATE = "tweenRotate";\r\n        DataParser.TWEEN_SCALE = "tweenScale";\r\n        DataParser.CLOCK_WISE = "clockwise";\r\n        DataParser.CURVE = "curve";\r\n        DataParser.SOUND = "sound";\r\n        DataParser.EVENT = "event";\r\n        DataParser.ACTION = "action";\r\n        DataParser.X = "x";\r\n        DataParser.Y = "y";\r\n        DataParser.SKEW_X = "skX";\r\n        DataParser.SKEW_Y = "skY";\r\n        DataParser.SCALE_X = "scX";\r\n        DataParser.SCALE_Y = "scY";\r\n        DataParser.VALUE = "value";\r\n        DataParser.ROTATE = "rotate";\r\n        DataParser.SKEW = "skew";\r\n        DataParser.ALPHA = "alpha";\r\n        DataParser.ALPHA_OFFSET = "aO";\r\n        DataParser.RED_OFFSET = "rO";\r\n        DataParser.GREEN_OFFSET = "gO";\r\n        DataParser.BLUE_OFFSET = "bO";\r\n        DataParser.ALPHA_MULTIPLIER = "aM";\r\n        DataParser.RED_MULTIPLIER = "rM";\r\n        DataParser.GREEN_MULTIPLIER = "gM";\r\n        DataParser.BLUE_MULTIPLIER = "bM";\r\n        DataParser.UVS = "uvs";\r\n        DataParser.VERTICES = "vertices";\r\n        DataParser.TRIANGLES = "triangles";\r\n        DataParser.WEIGHTS = "weights";\r\n        DataParser.SLOT_POSE = "slotPose";\r\n        DataParser.BONE_POSE = "bonePose";\r\n        DataParser.BONES = "bones";\r\n        DataParser.POSITION_MODE = "positionMode";\r\n        DataParser.SPACING_MODE = "spacingMode";\r\n        DataParser.ROTATE_MODE = "rotateMode";\r\n        DataParser.SPACING = "spacing";\r\n        DataParser.ROTATE_OFFSET = "rotateOffset";\r\n        DataParser.ROTATE_MIX = "rotateMix";\r\n        DataParser.TRANSLATE_MIX = "translateMix";\r\n        DataParser.TARGET_DISPLAY = "targetDisplay";\r\n        DataParser.CLOSED = "closed";\r\n        DataParser.CONSTANT_SPEED = "constantSpeed";\r\n        DataParser.VERTEX_COUNT = "vertexCount";\r\n        DataParser.LENGTHS = "lengths";\r\n        DataParser.GOTO_AND_PLAY = "gotoAndPlay";\r\n        DataParser.DEFAULT_NAME = "default";\r\n        return DataParser;\r\n    }());\r\n    dragonBones.DataParser = DataParser;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var ObjectDataParser = /** @class */ (function (_super) {\r\n        __extends(ObjectDataParser, _super);\r\n        function ObjectDataParser() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this._rawTextureAtlasIndex = 0;\r\n            _this._rawBones = [];\r\n            _this._data = null; //\r\n            _this._armature = null; //\r\n            _this._bone = null; //\r\n            _this._geometry = null; //\r\n            _this._slot = null; //\r\n            _this._skin = null; //\r\n            _this._mesh = null; //\r\n            _this._animation = null; //\r\n            _this._timeline = null; //\r\n            _this._rawTextureAtlases = null;\r\n            _this._frameValueType = 0 /* Step */;\r\n            _this._defaultColorOffset = -1;\r\n            _this._prevClockwise = 0;\r\n            _this._prevRotation = 0.0;\r\n            _this._frameDefaultValue = 0.0;\r\n            _this._frameValueScale = 1.0;\r\n            _this._helpMatrixA = new dragonBones.Matrix();\r\n            _this._helpMatrixB = new dragonBones.Matrix();\r\n            _this._helpTransform = new dragonBones.Transform();\r\n            _this._helpColorTransform = new dragonBones.ColorTransform();\r\n            _this._helpPoint = new dragonBones.Point();\r\n            _this._helpArray = [];\r\n            _this._intArray = [];\r\n            _this._floatArray = [];\r\n            _this._frameIntArray = [];\r\n            _this._frameFloatArray = [];\r\n            _this._frameArray = [];\r\n            _this._timelineArray = [];\r\n            _this._colorArray = [];\r\n            _this._cacheRawMeshes = [];\r\n            _this._cacheMeshes = [];\r\n            _this._actionFrames = [];\r\n            _this._weightSlotPose = {};\r\n            _this._weightBonePoses = {};\r\n            _this._cacheBones = {};\r\n            _this._slotChildActions = {};\r\n            return _this;\r\n        }\r\n        ObjectDataParser._getBoolean = function (rawData, key, defaultValue) {\r\n            if (key in rawData) {\r\n                var value = rawData[key];\r\n                var type = typeof value;\r\n                if (type === "boolean") {\r\n                    return value;\r\n                }\r\n                else if (type === "string") {\r\n                    switch (value) {\r\n                        case "0":\r\n                        case "NaN":\r\n                        case "":\r\n                        case "false":\r\n                        case "null":\r\n                        case "undefined":\r\n                            return false;\r\n                        default:\r\n                            return true;\r\n                    }\r\n                }\r\n                else {\r\n                    return !!value;\r\n                }\r\n            }\r\n            return defaultValue;\r\n        };\r\n        ObjectDataParser._getNumber = function (rawData, key, defaultValue) {\r\n            if (key in rawData) {\r\n                var value = rawData[key];\r\n                if (value === null || value === "NaN") {\r\n                    return defaultValue;\r\n                }\r\n                return +value || 0;\r\n            }\r\n            return defaultValue;\r\n        };\r\n        ObjectDataParser._getString = function (rawData, key, defaultValue) {\r\n            if (key in rawData) {\r\n                var value = rawData[key];\r\n                var type = typeof value;\r\n                if (type === "string") {\r\n                    return value;\r\n                }\r\n                return String(value);\r\n            }\r\n            return defaultValue;\r\n        };\r\n        ObjectDataParser.prototype._getCurvePoint = function (x1, y1, x2, y2, x3, y3, x4, y4, t, result) {\r\n            var l_t = 1.0 - t;\r\n            var powA = l_t * l_t;\r\n            var powB = t * t;\r\n            var kA = l_t * powA;\r\n            var kB = 3.0 * t * powA;\r\n            var kC = 3.0 * l_t * powB;\r\n            var kD = t * powB;\r\n            result.x = kA * x1 + kB * x2 + kC * x3 + kD * x4;\r\n            result.y = kA * y1 + kB * y2 + kC * y3 + kD * y4;\r\n        };\r\n        ObjectDataParser.prototype._samplingEasingCurve = function (curve, samples) {\r\n            var curveCount = curve.length;\r\n            if (curveCount % 3 === 1) {\r\n                var stepIndex = -2;\r\n                for (var i = 0, l = samples.length; i < l; ++i) {\r\n                    var t = (i + 1) / (l + 1); // float\r\n                    while ((stepIndex + 6 < curveCount ? curve[stepIndex + 6] : 1) < t) { // stepIndex + 3 * 2\r\n                        stepIndex += 6;\r\n                    }\r\n                    var isInCurve = stepIndex >= 0 && stepIndex + 6 < curveCount;\r\n                    var x1 = isInCurve ? curve[stepIndex] : 0.0;\r\n                    var y1 = isInCurve ? curve[stepIndex + 1] : 0.0;\r\n                    var x2 = curve[stepIndex + 2];\r\n                    var y2 = curve[stepIndex + 3];\r\n                    var x3 = curve[stepIndex + 4];\r\n                    var y3 = curve[stepIndex + 5];\r\n                    var x4 = isInCurve ? curve[stepIndex + 6] : 1.0;\r\n                    var y4 = isInCurve ? curve[stepIndex + 7] : 1.0;\r\n                    var lower = 0.0;\r\n                    var higher = 1.0;\r\n                    while (higher - lower > 0.0001) {\r\n                        var percentage = (higher + lower) * 0.5;\r\n                        this._getCurvePoint(x1, y1, x2, y2, x3, y3, x4, y4, percentage, this._helpPoint);\r\n                        if (t - this._helpPoint.x > 0.0) {\r\n                            lower = percentage;\r\n                        }\r\n                        else {\r\n                            higher = percentage;\r\n                        }\r\n                    }\r\n                    samples[i] = this._helpPoint.y;\r\n                }\r\n                return true;\r\n            }\r\n            else {\r\n                var stepIndex = 0;\r\n                for (var i = 0, l = samples.length; i < l; ++i) {\r\n                    var t = (i + 1) / (l + 1); // float\r\n                    while (curve[stepIndex + 6] < t) { // stepIndex + 3 * 2\r\n                        stepIndex += 6;\r\n                    }\r\n                    var x1 = curve[stepIndex];\r\n                    var y1 = curve[stepIndex + 1];\r\n                    var x2 = curve[stepIndex + 2];\r\n                    var y2 = curve[stepIndex + 3];\r\n                    var x3 = curve[stepIndex + 4];\r\n                    var y3 = curve[stepIndex + 5];\r\n                    var x4 = curve[stepIndex + 6];\r\n                    var y4 = curve[stepIndex + 7];\r\n                    var lower = 0.0;\r\n                    var higher = 1.0;\r\n                    while (higher - lower > 0.0001) {\r\n                        var percentage = (higher + lower) * 0.5;\r\n                        this._getCurvePoint(x1, y1, x2, y2, x3, y3, x4, y4, percentage, this._helpPoint);\r\n                        if (t - this._helpPoint.x > 0.0) {\r\n                            lower = percentage;\r\n                        }\r\n                        else {\r\n                            higher = percentage;\r\n                        }\r\n                    }\r\n                    samples[i] = this._helpPoint.y;\r\n                }\r\n                return false;\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._parseActionDataInFrame = function (rawData, frameStart, bone, slot) {\r\n            if (dragonBones.DataParser.EVENT in rawData) {\r\n                this._mergeActionFrame(rawData[dragonBones.DataParser.EVENT], frameStart, 10 /* Frame */, bone, slot);\r\n            }\r\n            if (dragonBones.DataParser.SOUND in rawData) {\r\n                this._mergeActionFrame(rawData[dragonBones.DataParser.SOUND], frameStart, 11 /* Sound */, bone, slot);\r\n            }\r\n            if (dragonBones.DataParser.ACTION in rawData) {\r\n                this._mergeActionFrame(rawData[dragonBones.DataParser.ACTION], frameStart, 0 /* Play */, bone, slot);\r\n            }\r\n            if (dragonBones.DataParser.EVENTS in rawData) {\r\n                this._mergeActionFrame(rawData[dragonBones.DataParser.EVENTS], frameStart, 10 /* Frame */, bone, slot);\r\n            }\r\n            if (dragonBones.DataParser.ACTIONS in rawData) {\r\n                this._mergeActionFrame(rawData[dragonBones.DataParser.ACTIONS], frameStart, 0 /* Play */, bone, slot);\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._mergeActionFrame = function (rawData, frameStart, type, bone, slot) {\r\n            var actionOffset = this._armature.actions.length;\r\n            var actions = this._parseActionData(rawData, type, bone, slot);\r\n            var frameIndex = 0;\r\n            var frame = null;\r\n            for (var _i = 0, actions_2 = actions; _i < actions_2.length; _i++) {\r\n                var action = actions_2[_i];\r\n                this._armature.addAction(action, false);\r\n            }\r\n            if (this._actionFrames.length === 0) { // First frame.\r\n                frame = new ActionFrame();\r\n                frame.frameStart = 0;\r\n                this._actionFrames.push(frame);\r\n                frame = null;\r\n            }\r\n            for (var _a = 0, _b = this._actionFrames; _a < _b.length; _a++) { // Get same frame.\r\n                var eachFrame = _b[_a];\r\n                if (eachFrame.frameStart === frameStart) {\r\n                    frame = eachFrame;\r\n                    break;\r\n                }\r\n                else if (eachFrame.frameStart > frameStart) {\r\n                    break;\r\n                }\r\n                frameIndex++;\r\n            }\r\n            if (frame === null) { // Create and cache frame.\r\n                frame = new ActionFrame();\r\n                frame.frameStart = frameStart;\r\n                this._actionFrames.splice(frameIndex, 0, frame);\r\n            }\r\n            for (var i = 0; i < actions.length; ++i) { // Cache action offsets.\r\n                frame.actions.push(actionOffset + i);\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._parseArmature = function (rawData, scale) {\r\n            var armature = dragonBones.BaseObject.borrowObject(dragonBones.ArmatureData);\r\n            armature.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            armature.frameRate = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.FRAME_RATE, this._data.frameRate);\r\n            armature.scale = scale;\r\n            if (dragonBones.DataParser.TYPE in rawData && typeof rawData[dragonBones.DataParser.TYPE] === "string") {\r\n                armature.type = dragonBones.DataParser._getArmatureType(rawData[dragonBones.DataParser.TYPE]);\r\n            }\r\n            else {\r\n                armature.type = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TYPE, 0 /* Armature */);\r\n            }\r\n            if (armature.frameRate === 0) { // Data error.\r\n                armature.frameRate = 24;\r\n            }\r\n            this._armature = armature;\r\n            if (dragonBones.DataParser.CANVAS in rawData) {\r\n                var rawCanvas = rawData[dragonBones.DataParser.CANVAS];\r\n                var canvas = dragonBones.BaseObject.borrowObject(dragonBones.CanvasData);\r\n                if (dragonBones.DataParser.COLOR in rawCanvas) {\r\n                    canvas.hasBackground = true;\r\n                }\r\n                else {\r\n                    canvas.hasBackground = false;\r\n                }\r\n                canvas.color = ObjectDataParser._getNumber(rawCanvas, dragonBones.DataParser.COLOR, 0);\r\n                canvas.x = ObjectDataParser._getNumber(rawCanvas, dragonBones.DataParser.X, 0) * armature.scale;\r\n                canvas.y = ObjectDataParser._getNumber(rawCanvas, dragonBones.DataParser.Y, 0) * armature.scale;\r\n                canvas.width = ObjectDataParser._getNumber(rawCanvas, dragonBones.DataParser.WIDTH, 0) * armature.scale;\r\n                canvas.height = ObjectDataParser._getNumber(rawCanvas, dragonBones.DataParser.HEIGHT, 0) * armature.scale;\r\n                armature.canvas = canvas;\r\n            }\r\n            if (dragonBones.DataParser.AABB in rawData) {\r\n                var rawAABB = rawData[dragonBones.DataParser.AABB];\r\n                armature.aabb.x = ObjectDataParser._getNumber(rawAABB, dragonBones.DataParser.X, 0.0) * armature.scale;\r\n                armature.aabb.y = ObjectDataParser._getNumber(rawAABB, dragonBones.DataParser.Y, 0.0) * armature.scale;\r\n                armature.aabb.width = ObjectDataParser._getNumber(rawAABB, dragonBones.DataParser.WIDTH, 0.0) * armature.scale;\r\n                armature.aabb.height = ObjectDataParser._getNumber(rawAABB, dragonBones.DataParser.HEIGHT, 0.0) * armature.scale;\r\n            }\r\n            if (dragonBones.DataParser.BONE in rawData) {\r\n                var rawBones = rawData[dragonBones.DataParser.BONE];\r\n                for (var _i = 0, rawBones_1 = rawBones; _i < rawBones_1.length; _i++) {\r\n                    var rawBone = rawBones_1[_i];\r\n                    var parentName = ObjectDataParser._getString(rawBone, dragonBones.DataParser.PARENT, "");\r\n                    var bone = this._parseBone(rawBone);\r\n                    if (parentName.length > 0) { // Get bone parent.\r\n                        var parent_1 = armature.getBone(parentName);\r\n                        if (parent_1 !== null) {\r\n                            bone.parent = parent_1;\r\n                        }\r\n                        else { // Cache.\r\n                            if (!(parentName in this._cacheBones)) {\r\n                                this._cacheBones[parentName] = [];\r\n                            }\r\n                            this._cacheBones[parentName].push(bone);\r\n                        }\r\n                    }\r\n                    if (bone.name in this._cacheBones) {\r\n                        for (var _a = 0, _b = this._cacheBones[bone.name]; _a < _b.length; _a++) {\r\n                            var child = _b[_a];\r\n                            child.parent = bone;\r\n                        }\r\n                        delete this._cacheBones[bone.name];\r\n                    }\r\n                    armature.addBone(bone);\r\n                    this._rawBones.push(bone); // Cache raw bones sort.\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.IK in rawData) {\r\n                var rawIKS = rawData[dragonBones.DataParser.IK];\r\n                for (var _c = 0, rawIKS_1 = rawIKS; _c < rawIKS_1.length; _c++) {\r\n                    var rawIK = rawIKS_1[_c];\r\n                    var constraint = this._parseIKConstraint(rawIK);\r\n                    if (constraint) {\r\n                        armature.addConstraint(constraint);\r\n                    }\r\n                }\r\n            }\r\n            armature.sortBones();\r\n            if (dragonBones.DataParser.SLOT in rawData) {\r\n                var zOrder = 0;\r\n                var rawSlots = rawData[dragonBones.DataParser.SLOT];\r\n                for (var _d = 0, rawSlots_1 = rawSlots; _d < rawSlots_1.length; _d++) {\r\n                    var rawSlot = rawSlots_1[_d];\r\n                    armature.addSlot(this._parseSlot(rawSlot, zOrder++));\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.SKIN in rawData) {\r\n                var rawSkins = rawData[dragonBones.DataParser.SKIN];\r\n                for (var _e = 0, rawSkins_1 = rawSkins; _e < rawSkins_1.length; _e++) {\r\n                    var rawSkin = rawSkins_1[_e];\r\n                    armature.addSkin(this._parseSkin(rawSkin));\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.PATH_CONSTRAINT in rawData) {\r\n                var rawPaths = rawData[dragonBones.DataParser.PATH_CONSTRAINT];\r\n                for (var _f = 0, rawPaths_1 = rawPaths; _f < rawPaths_1.length; _f++) {\r\n                    var rawPath = rawPaths_1[_f];\r\n                    var constraint = this._parsePathConstraint(rawPath);\r\n                    if (constraint) {\r\n                        armature.addConstraint(constraint);\r\n                    }\r\n                }\r\n            }\r\n            for (var i = 0, l = this._cacheRawMeshes.length; i < l; ++i) { // Link mesh.\r\n                var rawData_1 = this._cacheRawMeshes[i];\r\n                var shareName = ObjectDataParser._getString(rawData_1, dragonBones.DataParser.SHARE, "");\r\n                if (shareName.length === 0) {\r\n                    continue;\r\n                }\r\n                var skinName = ObjectDataParser._getString(rawData_1, dragonBones.DataParser.SKIN, dragonBones.DataParser.DEFAULT_NAME);\r\n                if (skinName.length === 0) { // \r\n                    skinName = dragonBones.DataParser.DEFAULT_NAME;\r\n                }\r\n                var shareMesh = armature.getMesh(skinName, "", shareName); // TODO slot;\r\n                if (shareMesh === null) {\r\n                    continue; // Error.\r\n                }\r\n                var mesh = this._cacheMeshes[i];\r\n                mesh.geometry.shareFrom(shareMesh.geometry);\r\n            }\r\n            if (dragonBones.DataParser.ANIMATION in rawData) {\r\n                var rawAnimations = rawData[dragonBones.DataParser.ANIMATION];\r\n                for (var _g = 0, rawAnimations_1 = rawAnimations; _g < rawAnimations_1.length; _g++) {\r\n                    var rawAnimation = rawAnimations_1[_g];\r\n                    var animation = this._parseAnimation(rawAnimation);\r\n                    armature.addAnimation(animation);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.DEFAULT_ACTIONS in rawData) {\r\n                var actions = this._parseActionData(rawData[dragonBones.DataParser.DEFAULT_ACTIONS], 0 /* Play */, null, null);\r\n                for (var _h = 0, actions_3 = actions; _h < actions_3.length; _h++) {\r\n                    var action = actions_3[_h];\r\n                    armature.addAction(action, true);\r\n                    if (action.type === 0 /* Play */) { // Set default animation from default action.\r\n                        var animation = armature.getAnimation(action.name);\r\n                        if (animation !== null) {\r\n                            armature.defaultAnimation = animation;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.ACTIONS in rawData) {\r\n                var actions = this._parseActionData(rawData[dragonBones.DataParser.ACTIONS], 0 /* Play */, null, null);\r\n                for (var _j = 0, actions_4 = actions; _j < actions_4.length; _j++) {\r\n                    var action = actions_4[_j];\r\n                    armature.addAction(action, false);\r\n                }\r\n            }\r\n            // Clear helper.\r\n            this._rawBones.length = 0;\r\n            this._cacheRawMeshes.length = 0;\r\n            this._cacheMeshes.length = 0;\r\n            this._armature = null;\r\n            for (var k in this._weightSlotPose) {\r\n                delete this._weightSlotPose[k];\r\n            }\r\n            for (var k in this._weightBonePoses) {\r\n                delete this._weightBonePoses[k];\r\n            }\r\n            for (var k in this._cacheBones) {\r\n                delete this._cacheBones[k];\r\n            }\r\n            for (var k in this._slotChildActions) {\r\n                delete this._slotChildActions[k];\r\n            }\r\n            return armature;\r\n        };\r\n        ObjectDataParser.prototype._parseBone = function (rawData) {\r\n            var type = 0 /* Bone */;\r\n            if (dragonBones.DataParser.TYPE in rawData && typeof rawData[dragonBones.DataParser.TYPE] === "string") {\r\n                type = dragonBones.DataParser._getBoneType(rawData[dragonBones.DataParser.TYPE]);\r\n            }\r\n            else {\r\n                type = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TYPE, 0 /* Bone */);\r\n            }\r\n            if (type === 0 /* Bone */) {\r\n                var scale = this._armature.scale;\r\n                var bone = dragonBones.BaseObject.borrowObject(dragonBones.BoneData);\r\n                bone.inheritTranslation = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.INHERIT_TRANSLATION, true);\r\n                bone.inheritRotation = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.INHERIT_ROTATION, true);\r\n                bone.inheritScale = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.INHERIT_SCALE, true);\r\n                bone.inheritReflection = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.INHERIT_REFLECTION, true);\r\n                bone.length = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.LENGTH, 0) * scale;\r\n                bone.alpha = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ALPHA, 1.0);\r\n                bone.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n                if (dragonBones.DataParser.TRANSFORM in rawData) {\r\n                    this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM], bone.transform, scale);\r\n                }\r\n                return bone;\r\n            }\r\n            var surface = dragonBones.BaseObject.borrowObject(dragonBones.SurfaceData);\r\n            surface.alpha = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ALPHA, 1.0);\r\n            surface.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            surface.segmentX = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SEGMENT_X, 0);\r\n            surface.segmentY = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SEGMENT_Y, 0);\r\n            this._parseGeometry(rawData, surface.geometry);\r\n            return surface;\r\n        };\r\n        ObjectDataParser.prototype._parseIKConstraint = function (rawData) {\r\n            var bone = this._armature.getBone(ObjectDataParser._getString(rawData, dragonBones.DataParser.BONE, ""));\r\n            if (bone === null) {\r\n                return null;\r\n            }\r\n            var target = this._armature.getBone(ObjectDataParser._getString(rawData, dragonBones.DataParser.TARGET, ""));\r\n            if (target === null) {\r\n                return null;\r\n            }\r\n            var chain = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.CHAIN, 0);\r\n            var constraint = dragonBones.BaseObject.borrowObject(dragonBones.IKConstraintData);\r\n            constraint.scaleEnabled = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.SCALE, false);\r\n            constraint.bendPositive = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.BEND_POSITIVE, true);\r\n            constraint.weight = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.WEIGHT, 1.0);\r\n            constraint.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            constraint.type = 0 /* IK */;\r\n            constraint.target = target;\r\n            if (chain > 0 && bone.parent !== null) {\r\n                constraint.root = bone.parent;\r\n                constraint.bone = bone;\r\n            }\r\n            else {\r\n                constraint.root = bone;\r\n                constraint.bone = null;\r\n            }\r\n            return constraint;\r\n        };\r\n        ObjectDataParser.prototype._parsePathConstraint = function (rawData) {\r\n            var target = this._armature.getSlot(ObjectDataParser._getString(rawData, dragonBones.DataParser.TARGET, ""));\r\n            if (target === null) {\r\n                return null;\r\n            }\r\n            var defaultSkin = this._armature.defaultSkin;\r\n            if (defaultSkin === null) {\r\n                return null;\r\n            }\r\n            //TODO\r\n            var targetDisplay = defaultSkin.getDisplay(target.name, ObjectDataParser._getString(rawData, dragonBones.DataParser.TARGET_DISPLAY, target.name));\r\n            if (targetDisplay === null || !(targetDisplay instanceof dragonBones.PathDisplayData)) {\r\n                return null;\r\n            }\r\n            var bones = rawData[dragonBones.DataParser.BONES];\r\n            if (bones === null || bones.length === 0) {\r\n                return null;\r\n            }\r\n            var constraint = dragonBones.BaseObject.borrowObject(dragonBones.PathConstraintData);\r\n            constraint.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            constraint.type = 1 /* Path */;\r\n            constraint.pathSlot = target;\r\n            constraint.pathDisplayData = targetDisplay;\r\n            constraint.target = target.parent;\r\n            constraint.positionMode = dragonBones.DataParser._getPositionMode(ObjectDataParser._getString(rawData, dragonBones.DataParser.POSITION_MODE, ""));\r\n            constraint.spacingMode = dragonBones.DataParser._getSpacingMode(ObjectDataParser._getString(rawData, dragonBones.DataParser.SPACING_MODE, ""));\r\n            constraint.rotateMode = dragonBones.DataParser._getRotateMode(ObjectDataParser._getString(rawData, dragonBones.DataParser.ROTATE_MODE, ""));\r\n            constraint.position = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.POSITION, 0);\r\n            constraint.spacing = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SPACING, 0);\r\n            constraint.rotateOffset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ROTATE_OFFSET, 0);\r\n            constraint.rotateMix = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ROTATE_MIX, 1);\r\n            constraint.translateMix = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TRANSLATE_MIX, 1);\r\n            //\r\n            for (var _i = 0, bones_3 = bones; _i < bones_3.length; _i++) {\r\n                var boneName = bones_3[_i];\r\n                var bone = this._armature.getBone(boneName);\r\n                if (bone !== null) {\r\n                    constraint.AddBone(bone);\r\n                    if (constraint.root === null) {\r\n                        constraint.root = bone;\r\n                    }\r\n                }\r\n            }\r\n            return constraint;\r\n        };\r\n        ObjectDataParser.prototype._parseSlot = function (rawData, zOrder) {\r\n            var slot = dragonBones.BaseObject.borrowObject(dragonBones.SlotData);\r\n            slot.displayIndex = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.DISPLAY_INDEX, 0);\r\n            slot.zOrder = zOrder;\r\n            slot.zIndex = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Z_INDEX, 0);\r\n            slot.alpha = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ALPHA, 1.0);\r\n            slot.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            slot.parent = this._armature.getBone(ObjectDataParser._getString(rawData, dragonBones.DataParser.PARENT, "")); //\r\n            if (dragonBones.DataParser.BLEND_MODE in rawData && typeof rawData[dragonBones.DataParser.BLEND_MODE] === "string") {\r\n                slot.blendMode = dragonBones.DataParser._getBlendMode(rawData[dragonBones.DataParser.BLEND_MODE]);\r\n            }\r\n            else {\r\n                slot.blendMode = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.BLEND_MODE, 0 /* Normal */);\r\n            }\r\n            if (dragonBones.DataParser.COLOR in rawData) {\r\n                slot.color = dragonBones.SlotData.createColor();\r\n                this._parseColorTransform(rawData[dragonBones.DataParser.COLOR], slot.color);\r\n            }\r\n            else {\r\n                slot.color = dragonBones.SlotData.DEFAULT_COLOR;\r\n            }\r\n            if (dragonBones.DataParser.ACTIONS in rawData) {\r\n                this._slotChildActions[slot.name] = this._parseActionData(rawData[dragonBones.DataParser.ACTIONS], 0 /* Play */, null, null);\r\n            }\r\n            return slot;\r\n        };\r\n        ObjectDataParser.prototype._parseSkin = function (rawData) {\r\n            var skin = dragonBones.BaseObject.borrowObject(dragonBones.SkinData);\r\n            skin.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, dragonBones.DataParser.DEFAULT_NAME);\r\n            if (skin.name.length === 0) {\r\n                skin.name = dragonBones.DataParser.DEFAULT_NAME;\r\n            }\r\n            if (dragonBones.DataParser.SLOT in rawData) {\r\n                var rawSlots = rawData[dragonBones.DataParser.SLOT];\r\n                this._skin = skin;\r\n                for (var _i = 0, rawSlots_2 = rawSlots; _i < rawSlots_2.length; _i++) {\r\n                    var rawSlot = rawSlots_2[_i];\r\n                    var slotName = ObjectDataParser._getString(rawSlot, dragonBones.DataParser.NAME, "");\r\n                    var slot = this._armature.getSlot(slotName);\r\n                    if (slot !== null) {\r\n                        this._slot = slot;\r\n                        if (dragonBones.DataParser.DISPLAY in rawSlot) {\r\n                            var rawDisplays = rawSlot[dragonBones.DataParser.DISPLAY];\r\n                            for (var _a = 0, rawDisplays_1 = rawDisplays; _a < rawDisplays_1.length; _a++) {\r\n                                var rawDisplay = rawDisplays_1[_a];\r\n                                if (rawDisplay) {\r\n                                    skin.addDisplay(slotName, this._parseDisplay(rawDisplay));\r\n                                }\r\n                                else {\r\n                                    skin.addDisplay(slotName, null);\r\n                                }\r\n                            }\r\n                        }\r\n                        this._slot = null; //\r\n                    }\r\n                }\r\n                this._skin = null; //\r\n            }\r\n            return skin;\r\n        };\r\n        ObjectDataParser.prototype._parseDisplay = function (rawData) {\r\n            var name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            var path = ObjectDataParser._getString(rawData, dragonBones.DataParser.PATH, "");\r\n            var type = 0 /* Image */;\r\n            var display = null;\r\n            if (dragonBones.DataParser.TYPE in rawData && typeof rawData[dragonBones.DataParser.TYPE] === "string") {\r\n                type = dragonBones.DataParser._getDisplayType(rawData[dragonBones.DataParser.TYPE]);\r\n            }\r\n            else {\r\n                type = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TYPE, type);\r\n            }\r\n            switch (type) {\r\n                case 0 /* Image */: {\r\n                    var imageDisplay = display = dragonBones.BaseObject.borrowObject(dragonBones.ImageDisplayData);\r\n                    imageDisplay.name = name;\r\n                    imageDisplay.path = path.length > 0 ? path : name;\r\n                    this._parsePivot(rawData, imageDisplay);\r\n                    break;\r\n                }\r\n                case 1 /* Armature */: {\r\n                    var armatureDisplay = display = dragonBones.BaseObject.borrowObject(dragonBones.ArmatureDisplayData);\r\n                    armatureDisplay.name = name;\r\n                    armatureDisplay.path = path.length > 0 ? path : name;\r\n                    armatureDisplay.inheritAnimation = true;\r\n                    if (dragonBones.DataParser.ACTIONS in rawData) {\r\n                        var actions = this._parseActionData(rawData[dragonBones.DataParser.ACTIONS], 0 /* Play */, null, null);\r\n                        for (var _i = 0, actions_5 = actions; _i < actions_5.length; _i++) {\r\n                            var action = actions_5[_i];\r\n                            armatureDisplay.addAction(action);\r\n                        }\r\n                    }\r\n                    else if (this._slot.name in this._slotChildActions) {\r\n                        var displays = this._skin.getDisplays(this._slot.name);\r\n                        if (displays === null ? this._slot.displayIndex === 0 : this._slot.displayIndex === displays.length) {\r\n                            for (var _a = 0, _b = this._slotChildActions[this._slot.name]; _a < _b.length; _a++) {\r\n                                var action = _b[_a];\r\n                                armatureDisplay.addAction(action);\r\n                            }\r\n                            delete this._slotChildActions[this._slot.name];\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n                case 2 /* Mesh */: {\r\n                    var meshDisplay = display = dragonBones.BaseObject.borrowObject(dragonBones.MeshDisplayData);\r\n                    meshDisplay.geometry.inheritDeform = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.INHERIT_DEFORM, true);\r\n                    meshDisplay.name = name;\r\n                    meshDisplay.path = path.length > 0 ? path : name;\r\n                    if (dragonBones.DataParser.SHARE in rawData) {\r\n                        meshDisplay.geometry.data = this._data;\r\n                        this._cacheRawMeshes.push(rawData);\r\n                        this._cacheMeshes.push(meshDisplay);\r\n                    }\r\n                    else {\r\n                        this._parseMesh(rawData, meshDisplay);\r\n                    }\r\n                    break;\r\n                }\r\n                case 3 /* BoundingBox */: {\r\n                    var boundingBox = this._parseBoundingBox(rawData);\r\n                    if (boundingBox !== null) {\r\n                        var boundingBoxDisplay = display = dragonBones.BaseObject.borrowObject(dragonBones.BoundingBoxDisplayData);\r\n                        boundingBoxDisplay.name = name;\r\n                        boundingBoxDisplay.path = path.length > 0 ? path : name;\r\n                        boundingBoxDisplay.boundingBox = boundingBox;\r\n                    }\r\n                    break;\r\n                }\r\n                case 4 /* Path */: {\r\n                    var rawCurveLengths = rawData[dragonBones.DataParser.LENGTHS];\r\n                    var pathDisplay = display = dragonBones.BaseObject.borrowObject(dragonBones.PathDisplayData);\r\n                    pathDisplay.closed = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.CLOSED, false);\r\n                    pathDisplay.constantSpeed = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.CONSTANT_SPEED, false);\r\n                    pathDisplay.name = name;\r\n                    pathDisplay.path = path.length > 0 ? path : name;\r\n                    pathDisplay.curveLengths.length = rawCurveLengths.length;\r\n                    for (var i = 0, l = rawCurveLengths.length; i < l; ++i) {\r\n                        pathDisplay.curveLengths[i] = rawCurveLengths[i];\r\n                    }\r\n                    this._parsePath(rawData, pathDisplay);\r\n                    break;\r\n                }\r\n            }\r\n            if (display !== null && dragonBones.DataParser.TRANSFORM in rawData) {\r\n                this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM], display.transform, this._armature.scale);\r\n            }\r\n            return display;\r\n        };\r\n        ObjectDataParser.prototype._parsePath = function (rawData, display) {\r\n            this._parseGeometry(rawData, display.geometry);\r\n        };\r\n        ObjectDataParser.prototype._parsePivot = function (rawData, display) {\r\n            if (dragonBones.DataParser.PIVOT in rawData) {\r\n                var rawPivot = rawData[dragonBones.DataParser.PIVOT];\r\n                display.pivot.x = ObjectDataParser._getNumber(rawPivot, dragonBones.DataParser.X, 0.0);\r\n                display.pivot.y = ObjectDataParser._getNumber(rawPivot, dragonBones.DataParser.Y, 0.0);\r\n            }\r\n            else {\r\n                display.pivot.x = 0.5;\r\n                display.pivot.y = 0.5;\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._parseMesh = function (rawData, mesh) {\r\n            this._parseGeometry(rawData, mesh.geometry);\r\n            if (dragonBones.DataParser.WEIGHTS in rawData) { // Cache pose data.\r\n                var rawSlotPose = rawData[dragonBones.DataParser.SLOT_POSE];\r\n                var rawBonePoses = rawData[dragonBones.DataParser.BONE_POSE];\r\n                var meshName = this._skin.name + "_" + this._slot.name + "_" + mesh.name;\r\n                this._weightSlotPose[meshName] = rawSlotPose;\r\n                this._weightBonePoses[meshName] = rawBonePoses;\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._parseBoundingBox = function (rawData) {\r\n            var boundingBox = null;\r\n            var type = 0 /* Rectangle */;\r\n            if (dragonBones.DataParser.SUB_TYPE in rawData && typeof rawData[dragonBones.DataParser.SUB_TYPE] === "string") {\r\n                type = dragonBones.DataParser._getBoundingBoxType(rawData[dragonBones.DataParser.SUB_TYPE]);\r\n            }\r\n            else {\r\n                type = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SUB_TYPE, type);\r\n            }\r\n            switch (type) {\r\n                case 0 /* Rectangle */:\r\n                    boundingBox = dragonBones.BaseObject.borrowObject(dragonBones.RectangleBoundingBoxData);\r\n                    break;\r\n                case 1 /* Ellipse */:\r\n                    boundingBox = dragonBones.BaseObject.borrowObject(dragonBones.EllipseBoundingBoxData);\r\n                    break;\r\n                case 2 /* Polygon */:\r\n                    boundingBox = this._parsePolygonBoundingBox(rawData);\r\n                    break;\r\n            }\r\n            if (boundingBox !== null) {\r\n                boundingBox.color = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.COLOR, 0x000000);\r\n                if (boundingBox.type === 0 /* Rectangle */ || boundingBox.type === 1 /* Ellipse */) {\r\n                    boundingBox.width = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.WIDTH, 0.0);\r\n                    boundingBox.height = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.HEIGHT, 0.0);\r\n                }\r\n            }\r\n            return boundingBox;\r\n        };\r\n        ObjectDataParser.prototype._parsePolygonBoundingBox = function (rawData) {\r\n            var polygonBoundingBox = dragonBones.BaseObject.borrowObject(dragonBones.PolygonBoundingBoxData);\r\n            if (dragonBones.DataParser.VERTICES in rawData) {\r\n                var scale = this._armature.scale;\r\n                var rawVertices = rawData[dragonBones.DataParser.VERTICES];\r\n                var vertices = polygonBoundingBox.vertices;\r\n                vertices.length = rawVertices.length;\r\n                for (var i = 0, l = rawVertices.length; i < l; i += 2) {\r\n                    var x = rawVertices[i] * scale;\r\n                    var y = rawVertices[i + 1] * scale;\r\n                    vertices[i] = x;\r\n                    vertices[i + 1] = y;\r\n                    // AABB.\r\n                    if (i === 0) {\r\n                        polygonBoundingBox.x = x;\r\n                        polygonBoundingBox.y = y;\r\n                        polygonBoundingBox.width = x;\r\n                        polygonBoundingBox.height = y;\r\n                    }\r\n                    else {\r\n                        if (x < polygonBoundingBox.x) {\r\n                            polygonBoundingBox.x = x;\r\n                        }\r\n                        else if (x > polygonBoundingBox.width) {\r\n                            polygonBoundingBox.width = x;\r\n                        }\r\n                        if (y < polygonBoundingBox.y) {\r\n                            polygonBoundingBox.y = y;\r\n                        }\r\n                        else if (y > polygonBoundingBox.height) {\r\n                            polygonBoundingBox.height = y;\r\n                        }\r\n                    }\r\n                }\r\n                polygonBoundingBox.width -= polygonBoundingBox.x;\r\n                polygonBoundingBox.height -= polygonBoundingBox.y;\r\n            }\r\n            else {\r\n                console.warn("Data error.\\n Please reexport DragonBones Data to fixed the bug.");\r\n            }\r\n            return polygonBoundingBox;\r\n        };\r\n        ObjectDataParser.prototype._parseAnimation = function (rawData) {\r\n            var animation = dragonBones.BaseObject.borrowObject(dragonBones.AnimationData);\r\n            animation.blendType = dragonBones.DataParser._getAnimationBlendType(ObjectDataParser._getString(rawData, dragonBones.DataParser.BLEND_TYPE, ""));\r\n            animation.frameCount = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.DURATION, 0);\r\n            animation.playTimes = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.PLAY_TIMES, 1);\r\n            animation.duration = animation.frameCount / this._armature.frameRate; // float\r\n            animation.fadeInTime = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.FADE_IN_TIME, 0.0);\r\n            animation.scale = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE, 1.0);\r\n            animation.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, dragonBones.DataParser.DEFAULT_NAME);\r\n            if (animation.name.length === 0) {\r\n                animation.name = dragonBones.DataParser.DEFAULT_NAME;\r\n            }\r\n            animation.frameIntOffset = this._frameIntArray.length;\r\n            animation.frameFloatOffset = this._frameFloatArray.length;\r\n            animation.frameOffset = this._frameArray.length;\r\n            this._animation = animation;\r\n            if (dragonBones.DataParser.FRAME in rawData) {\r\n                var rawFrames = rawData[dragonBones.DataParser.FRAME];\r\n                var keyFrameCount = rawFrames.length;\r\n                if (keyFrameCount > 0) {\r\n                    for (var i = 0, frameStart = 0; i < keyFrameCount; ++i) {\r\n                        var rawFrame = rawFrames[i];\r\n                        this._parseActionDataInFrame(rawFrame, frameStart, null, null);\r\n                        frameStart += ObjectDataParser._getNumber(rawFrame, dragonBones.DataParser.DURATION, 1);\r\n                    }\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.Z_ORDER in rawData) {\r\n                this._animation.zOrderTimeline = this._parseTimeline(rawData[dragonBones.DataParser.Z_ORDER], null, dragonBones.DataParser.FRAME, 1 /* ZOrder */, 0 /* Step */, 0, this._parseZOrderFrame);\r\n            }\r\n            if (dragonBones.DataParser.BONE in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.BONE];\r\n                for (var _i = 0, rawTimelines_1 = rawTimelines; _i < rawTimelines_1.length; _i++) {\r\n                    var rawTimeline = rawTimelines_1[_i];\r\n                    this._parseBoneTimeline(rawTimeline);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.SLOT in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.SLOT];\r\n                for (var _a = 0, rawTimelines_2 = rawTimelines; _a < rawTimelines_2.length; _a++) {\r\n                    var rawTimeline = rawTimelines_2[_a];\r\n                    this._parseSlotTimeline(rawTimeline);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.FFD in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.FFD];\r\n                for (var _b = 0, rawTimelines_3 = rawTimelines; _b < rawTimelines_3.length; _b++) {\r\n                    var rawTimeline = rawTimelines_3[_b];\r\n                    var skinName = ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.SKIN, dragonBones.DataParser.DEFAULT_NAME);\r\n                    var slotName = ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.SLOT, "");\r\n                    var displayName = ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.NAME, "");\r\n                    if (skinName.length === 0) { //\r\n                        skinName = dragonBones.DataParser.DEFAULT_NAME;\r\n                    }\r\n                    this._slot = this._armature.getSlot(slotName);\r\n                    this._mesh = this._armature.getMesh(skinName, slotName, displayName);\r\n                    if (this._slot === null || this._mesh === null) {\r\n                        continue;\r\n                    }\r\n                    var timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, 22 /* SlotDeform */, 2 /* Float */, 0, this._parseSlotDeformFrame);\r\n                    if (timeline !== null) {\r\n                        this._animation.addSlotTimeline(slotName, timeline);\r\n                    }\r\n                    this._slot = null; //\r\n                    this._mesh = null; //\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.IK in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.IK];\r\n                for (var _c = 0, rawTimelines_4 = rawTimelines; _c < rawTimelines_4.length; _c++) {\r\n                    var rawTimeline = rawTimelines_4[_c];\r\n                    var constraintName = ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.NAME, "");\r\n                    var constraint = this._armature.getConstraint(constraintName);\r\n                    if (constraint === null) {\r\n                        continue;\r\n                    }\r\n                    var timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, 30 /* IKConstraint */, 1 /* Int */, 2, this._parseIKConstraintFrame);\r\n                    if (timeline !== null) {\r\n                        this._animation.addConstraintTimeline(constraintName, timeline);\r\n                    }\r\n                }\r\n            }\r\n            if (this._actionFrames.length > 0) {\r\n                this._animation.actionTimeline = this._parseTimeline(null, this._actionFrames, "", 0 /* Action */, 0 /* Step */, 0, this._parseActionFrame);\r\n                this._actionFrames.length = 0;\r\n            }\r\n            if (dragonBones.DataParser.TIMELINE in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.TIMELINE];\r\n                for (var _d = 0, rawTimelines_5 = rawTimelines; _d < rawTimelines_5.length; _d++) {\r\n                    var rawTimeline = rawTimelines_5[_d];\r\n                    var timelineType = ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.TYPE, 0 /* Action */);\r\n                    var timelineName = ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.NAME, "");\r\n                    var timeline = null;\r\n                    switch (timelineType) {\r\n                        case 0 /* Action */:\r\n                            // TODO\r\n                            break;\r\n                        case 20 /* SlotDisplay */: // TODO\r\n                        case 23 /* SlotZIndex */:\r\n                        case 60 /* BoneAlpha */:\r\n                        case 24 /* SlotAlpha */:\r\n                        case 40 /* AnimationProgress */:\r\n                        case 41 /* AnimationWeight */:\r\n                            if (timelineType === 20 /* SlotDisplay */) {\r\n                                this._frameValueType = 0 /* Step */;\r\n                                this._frameValueScale = 1.0;\r\n                            }\r\n                            else {\r\n                                this._frameValueType = 1 /* Int */;\r\n                                if (timelineType === 23 /* SlotZIndex */) {\r\n                                    this._frameValueScale = 1.0;\r\n                                }\r\n                                else if (timelineType === 40 /* AnimationProgress */ ||\r\n                                    timelineType === 41 /* AnimationWeight */) {\r\n                                    this._frameValueScale = 10000.0;\r\n                                }\r\n                                else {\r\n                                    this._frameValueScale = 100.0;\r\n                                }\r\n                            }\r\n                            if (timelineType === 60 /* BoneAlpha */ ||\r\n                                timelineType === 24 /* SlotAlpha */ ||\r\n                                timelineType === 41 /* AnimationWeight */) {\r\n                                this._frameDefaultValue = 1.0;\r\n                            }\r\n                            else {\r\n                                this._frameDefaultValue = 0.0;\r\n                            }\r\n                            if (timelineType === 40 /* AnimationProgress */ && animation.blendType !== 0 /* None */) {\r\n                                timeline = dragonBones.BaseObject.borrowObject(dragonBones.AnimationTimelineData);\r\n                                var animaitonTimeline = timeline;\r\n                                animaitonTimeline.x = ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.X, 0.0);\r\n                                animaitonTimeline.y = ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.Y, 0.0);\r\n                            }\r\n                            timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, timelineType, this._frameValueType, 1, this._parseSingleValueFrame, timeline);\r\n                            break;\r\n                        case 11 /* BoneTranslate */:\r\n                        case 12 /* BoneRotate */:\r\n                        case 13 /* BoneScale */:\r\n                        case 30 /* IKConstraint */:\r\n                        case 42 /* AnimationParameter */:\r\n                            if (timelineType === 30 /* IKConstraint */ ||\r\n                                timelineType === 42 /* AnimationParameter */) {\r\n                                this._frameValueType = 1 /* Int */;\r\n                                if (timelineType === 42 /* AnimationParameter */) {\r\n                                    this._frameValueScale = 10000.0;\r\n                                }\r\n                                else {\r\n                                    this._frameValueScale = 100.0;\r\n                                }\r\n                            }\r\n                            else {\r\n                                if (timelineType === 12 /* BoneRotate */) {\r\n                                    this._frameValueScale = dragonBones.Transform.DEG_RAD;\r\n                                }\r\n                                else {\r\n                                    this._frameValueScale = 1.0;\r\n                                }\r\n                                this._frameValueType = 2 /* Float */;\r\n                            }\r\n                            if (timelineType === 13 /* BoneScale */ ||\r\n                                timelineType === 30 /* IKConstraint */) {\r\n                                this._frameDefaultValue = 1.0;\r\n                            }\r\n                            else {\r\n                                this._frameDefaultValue = 0.0;\r\n                            }\r\n                            timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, timelineType, this._frameValueType, 2, this._parseDoubleValueFrame);\r\n                            break;\r\n                        case 1 /* ZOrder */:\r\n                            // TODO\r\n                            break;\r\n                        case 50 /* Surface */: {\r\n                            var surface = this._armature.getBone(timelineName);\r\n                            if (surface === null) {\r\n                                continue;\r\n                            }\r\n                            this._geometry = surface.geometry;\r\n                            timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, timelineType, 2 /* Float */, 0, this._parseDeformFrame);\r\n                            this._geometry = null; //\r\n                            break;\r\n                        }\r\n                        case 22 /* SlotDeform */: {\r\n                            this._geometry = null; //\r\n                            for (var skinName in this._armature.skins) {\r\n                                var skin = this._armature.skins[skinName];\r\n                                for (var slontName in skin.displays) {\r\n                                    var displays = skin.displays[slontName];\r\n                                    for (var _e = 0, displays_1 = displays; _e < displays_1.length; _e++) {\r\n                                        var display = displays_1[_e];\r\n                                        if (display !== null && display.name === timelineName) {\r\n                                            this._geometry = display.geometry;\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (this._geometry === null) {\r\n                                continue;\r\n                            }\r\n                            timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, timelineType, 2 /* Float */, 0, this._parseDeformFrame);\r\n                            this._geometry = null; //\r\n                            break;\r\n                        }\r\n                        case 21 /* SlotColor */:\r\n                            timeline = this._parseTimeline(rawTimeline, null, dragonBones.DataParser.FRAME, timelineType, 1 /* Int */, 1, this._parseSlotColorFrame);\r\n                            break;\r\n                    }\r\n                    if (timeline !== null) {\r\n                        switch (timelineType) {\r\n                            case 0 /* Action */:\r\n                                // TODO\r\n                                break;\r\n                            case 1 /* ZOrder */:\r\n                                // TODO\r\n                                break;\r\n                            case 11 /* BoneTranslate */:\r\n                            case 12 /* BoneRotate */:\r\n                            case 13 /* BoneScale */:\r\n                            case 50 /* Surface */:\r\n                            case 60 /* BoneAlpha */:\r\n                                this._animation.addBoneTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 20 /* SlotDisplay */:\r\n                            case 21 /* SlotColor */:\r\n                            case 22 /* SlotDeform */:\r\n                            case 23 /* SlotZIndex */:\r\n                            case 24 /* SlotAlpha */:\r\n                                this._animation.addSlotTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 30 /* IKConstraint */:\r\n                                this._animation.addConstraintTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 40 /* AnimationProgress */:\r\n                            case 41 /* AnimationWeight */:\r\n                            case 42 /* AnimationParameter */:\r\n                                this._animation.addAnimationTimeline(timelineName, timeline);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._animation = null; //\r\n            return animation;\r\n        };\r\n        ObjectDataParser.prototype._parseTimeline = function (rawData, rawFrames, framesKey, timelineType, frameValueType, frameValueCount, frameParser, timeline) {\r\n            if (timeline === void 0) { timeline = null; }\r\n            if (rawData !== null && framesKey.length > 0 && framesKey in rawData) {\r\n                rawFrames = rawData[framesKey];\r\n            }\r\n            if (rawFrames === null) {\r\n                return null;\r\n            }\r\n            var keyFrameCount = rawFrames.length;\r\n            if (keyFrameCount === 0) {\r\n                return null;\r\n            }\r\n            var frameIntArrayLength = this._frameIntArray.length;\r\n            var frameFloatArrayLength = this._frameFloatArray.length;\r\n            var timelineOffset = this._timelineArray.length;\r\n            if (timeline === null) {\r\n                timeline = dragonBones.BaseObject.borrowObject(dragonBones.TimelineData);\r\n            }\r\n            timeline.type = timelineType;\r\n            timeline.offset = timelineOffset;\r\n            this._frameValueType = frameValueType;\r\n            this._timeline = timeline;\r\n            this._timelineArray.length += 1 + 1 + 1 + 1 + 1 + keyFrameCount;\r\n            if (rawData !== null) {\r\n                this._timelineArray[timelineOffset + 0 /* TimelineScale */] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE, 1.0) * 100);\r\n                this._timelineArray[timelineOffset + 1 /* TimelineOffset */] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.OFFSET, 0.0) * 100);\r\n            }\r\n            else {\r\n                this._timelineArray[timelineOffset + 0 /* TimelineScale */] = 100;\r\n                this._timelineArray[timelineOffset + 1 /* TimelineOffset */] = 0;\r\n            }\r\n            this._timelineArray[timelineOffset + 2 /* TimelineKeyFrameCount */] = keyFrameCount;\r\n            this._timelineArray[timelineOffset + 3 /* TimelineFrameValueCount */] = frameValueCount;\r\n            switch (this._frameValueType) {\r\n                case 0 /* Step */:\r\n                    this._timelineArray[timelineOffset + 4 /* TimelineFrameValueOffset */] = 0;\r\n                    break;\r\n                case 1 /* Int */:\r\n                    this._timelineArray[timelineOffset + 4 /* TimelineFrameValueOffset */] = frameIntArrayLength - this._animation.frameIntOffset;\r\n                    break;\r\n                case 2 /* Float */:\r\n                    this._timelineArray[timelineOffset + 4 /* TimelineFrameValueOffset */] = frameFloatArrayLength - this._animation.frameFloatOffset;\r\n                    break;\r\n            }\r\n            if (keyFrameCount === 1) { // Only one frame.\r\n                timeline.frameIndicesOffset = -1;\r\n                this._timelineArray[timelineOffset + 5 /* TimelineFrameOffset */ + 0] = frameParser.call(this, rawFrames[0], 0, 0) - this._animation.frameOffset;\r\n            }\r\n            else {\r\n                var totalFrameCount = this._animation.frameCount + 1; // One more frame than animation.\r\n                var frameIndices = this._data.frameIndices;\r\n                var frameIndicesOffset = frameIndices.length;\r\n                frameIndices.length += totalFrameCount;\r\n                timeline.frameIndicesOffset = frameIndicesOffset;\r\n                for (var i = 0, iK = 0, frameStart = 0, frameCount = 0; i < totalFrameCount; ++i) {\r\n                    if (frameStart + frameCount <= i && iK < keyFrameCount) {\r\n                        var rawFrame = rawFrames[iK];\r\n                        frameStart = i; // frame.frameStart;\r\n                        if (iK === keyFrameCount - 1) {\r\n                            frameCount = this._animation.frameCount - frameStart;\r\n                        }\r\n                        else {\r\n                            if (rawFrame instanceof ActionFrame) {\r\n                                frameCount = this._actionFrames[iK + 1].frameStart - frameStart;\r\n                            }\r\n                            else {\r\n                                frameCount = ObjectDataParser._getNumber(rawFrame, dragonBones.DataParser.DURATION, 1);\r\n                            }\r\n                        }\r\n                        this._timelineArray[timelineOffset + 5 /* TimelineFrameOffset */ + iK] = frameParser.call(this, rawFrame, frameStart, frameCount) - this._animation.frameOffset;\r\n                        iK++;\r\n                    }\r\n                    frameIndices[frameIndicesOffset + i] = iK - 1;\r\n                }\r\n            }\r\n            this._timeline = null; //\r\n            return timeline;\r\n        };\r\n        ObjectDataParser.prototype._parseBoneTimeline = function (rawData) {\r\n            var bone = this._armature.getBone(ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, ""));\r\n            if (bone === null) {\r\n                return;\r\n            }\r\n            this._bone = bone;\r\n            this._slot = this._armature.getSlot(this._bone.name);\r\n            if (dragonBones.DataParser.TRANSLATE_FRAME in rawData) {\r\n                this._frameDefaultValue = 0.0;\r\n                this._frameValueScale = 1.0;\r\n                var timeline = this._parseTimeline(rawData, null, dragonBones.DataParser.TRANSLATE_FRAME, 11 /* BoneTranslate */, 2 /* Float */, 2, this._parseDoubleValueFrame);\r\n                if (timeline !== null) {\r\n                    this._animation.addBoneTimeline(bone.name, timeline);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.ROTATE_FRAME in rawData) {\r\n                this._frameDefaultValue = 0.0;\r\n                this._frameValueScale = 1.0;\r\n                var timeline = this._parseTimeline(rawData, null, dragonBones.DataParser.ROTATE_FRAME, 12 /* BoneRotate */, 2 /* Float */, 2, this._parseBoneRotateFrame);\r\n                if (timeline !== null) {\r\n                    this._animation.addBoneTimeline(bone.name, timeline);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.SCALE_FRAME in rawData) {\r\n                this._frameDefaultValue = 1.0;\r\n                this._frameValueScale = 1.0;\r\n                var timeline = this._parseTimeline(rawData, null, dragonBones.DataParser.SCALE_FRAME, 13 /* BoneScale */, 2 /* Float */, 2, this._parseBoneScaleFrame);\r\n                if (timeline !== null) {\r\n                    this._animation.addBoneTimeline(bone.name, timeline);\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.FRAME in rawData) {\r\n                var timeline = this._parseTimeline(rawData, null, dragonBones.DataParser.FRAME, 10 /* BoneAll */, 2 /* Float */, 6, this._parseBoneAllFrame);\r\n                if (timeline !== null) {\r\n                    this._animation.addBoneTimeline(bone.name, timeline);\r\n                }\r\n            }\r\n            this._bone = null; //\r\n            this._slot = null; //\r\n        };\r\n        ObjectDataParser.prototype._parseSlotTimeline = function (rawData) {\r\n            var slot = this._armature.getSlot(ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, ""));\r\n            if (slot === null) {\r\n                return;\r\n            }\r\n            var displayTimeline = null;\r\n            var colorTimeline = null;\r\n            this._slot = slot;\r\n            if (dragonBones.DataParser.DISPLAY_FRAME in rawData) {\r\n                displayTimeline = this._parseTimeline(rawData, null, dragonBones.DataParser.DISPLAY_FRAME, 20 /* SlotDisplay */, 0 /* Step */, 0, this._parseSlotDisplayFrame);\r\n            }\r\n            else {\r\n                displayTimeline = this._parseTimeline(rawData, null, dragonBones.DataParser.FRAME, 20 /* SlotDisplay */, 0 /* Step */, 0, this._parseSlotDisplayFrame);\r\n            }\r\n            if (dragonBones.DataParser.COLOR_FRAME in rawData) {\r\n                colorTimeline = this._parseTimeline(rawData, null, dragonBones.DataParser.COLOR_FRAME, 21 /* SlotColor */, 1 /* Int */, 1, this._parseSlotColorFrame);\r\n            }\r\n            else {\r\n                colorTimeline = this._parseTimeline(rawData, null, dragonBones.DataParser.FRAME, 21 /* SlotColor */, 1 /* Int */, 1, this._parseSlotColorFrame);\r\n            }\r\n            if (displayTimeline !== null) {\r\n                this._animation.addSlotTimeline(slot.name, displayTimeline);\r\n            }\r\n            if (colorTimeline !== null) {\r\n                this._animation.addSlotTimeline(slot.name, colorTimeline);\r\n            }\r\n            this._slot = null; //\r\n        };\r\n        ObjectDataParser.prototype._parseFrame = function (rawData, frameStart, frameCount) {\r\n            // tslint:disable-next-line:no-unused-expression\r\n            rawData;\r\n            // tslint:disable-next-line:no-unused-expression\r\n            frameCount;\r\n            var frameOffset = this._frameArray.length;\r\n            this._frameArray.length += 1;\r\n            this._frameArray[frameOffset + 0 /* FramePosition */] = frameStart;\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseTweenFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseFrame(rawData, frameStart, frameCount);\r\n            if (frameCount > 0) {\r\n                if (dragonBones.DataParser.CURVE in rawData) {\r\n                    var sampleCount = frameCount + 1;\r\n                    this._helpArray.length = sampleCount;\r\n                    var isOmited = this._samplingEasingCurve(rawData[dragonBones.DataParser.CURVE], this._helpArray);\r\n                    this._frameArray.length += 1 + 1 + this._helpArray.length;\r\n                    this._frameArray[frameOffset + 1 /* FrameTweenType */] = 2 /* Curve */;\r\n                    this._frameArray[frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */] = isOmited ? sampleCount : -sampleCount;\r\n                    for (var i = 0; i < sampleCount; ++i) {\r\n                        this._frameArray[frameOffset + 3 /* FrameCurveSamples */ + i] = Math.round(this._helpArray[i] * 10000.0);\r\n                    }\r\n                }\r\n                else {\r\n                    var noTween = -2.0;\r\n                    var tweenEasing = noTween;\r\n                    if (dragonBones.DataParser.TWEEN_EASING in rawData) {\r\n                        tweenEasing = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TWEEN_EASING, noTween);\r\n                    }\r\n                    if (tweenEasing === noTween) {\r\n                        this._frameArray.length += 1;\r\n                        this._frameArray[frameOffset + 1 /* FrameTweenType */] = 0 /* None */;\r\n                    }\r\n                    else if (tweenEasing === 0.0) {\r\n                        this._frameArray.length += 1;\r\n                        this._frameArray[frameOffset + 1 /* FrameTweenType */] = 1 /* Line */;\r\n                    }\r\n                    else if (tweenEasing < 0.0) {\r\n                        this._frameArray.length += 1 + 1;\r\n                        this._frameArray[frameOffset + 1 /* FrameTweenType */] = 3 /* QuadIn */;\r\n                        this._frameArray[frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */] = Math.round(-tweenEasing * 100.0);\r\n                    }\r\n                    else if (tweenEasing <= 1.0) {\r\n                        this._frameArray.length += 1 + 1;\r\n                        this._frameArray[frameOffset + 1 /* FrameTweenType */] = 4 /* QuadOut */;\r\n                        this._frameArray[frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */] = Math.round(tweenEasing * 100.0);\r\n                    }\r\n                    else {\r\n                        this._frameArray.length += 1 + 1;\r\n                        this._frameArray[frameOffset + 1 /* FrameTweenType */] = 5 /* QuadInOut */;\r\n                        this._frameArray[frameOffset + 2 /* FrameTweenEasingOrCurveSampleCount */] = Math.round(tweenEasing * 100.0 - 100.0);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                this._frameArray.length += 1;\r\n                this._frameArray[frameOffset + 1 /* FrameTweenType */] = 0 /* None */;\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseSingleValueFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = 0;\r\n            switch (this._frameValueType) {\r\n                case 0: {\r\n                    frameOffset = this._parseFrame(rawData, frameStart, frameCount);\r\n                    this._frameArray.length += 1;\r\n                    this._frameArray[frameOffset + 1] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.VALUE, this._frameDefaultValue);\r\n                    break;\r\n                }\r\n                case 1: {\r\n                    frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n                    var frameValueOffset = this._frameIntArray.length;\r\n                    this._frameIntArray.length += 1;\r\n                    this._frameIntArray[frameValueOffset] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.VALUE, this._frameDefaultValue) * this._frameValueScale);\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n                    var frameValueOffset = this._frameFloatArray.length;\r\n                    this._frameFloatArray.length += 1;\r\n                    this._frameFloatArray[frameValueOffset] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.VALUE, this._frameDefaultValue) * this._frameValueScale;\r\n                    break;\r\n                }\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseDoubleValueFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = 0;\r\n            switch (this._frameValueType) {\r\n                case 0: {\r\n                    frameOffset = this._parseFrame(rawData, frameStart, frameCount);\r\n                    this._frameArray.length += 2;\r\n                    this._frameArray[frameOffset + 1] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, this._frameDefaultValue);\r\n                    this._frameArray[frameOffset + 2] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, this._frameDefaultValue);\r\n                    break;\r\n                }\r\n                case 1: {\r\n                    frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n                    var frameValueOffset = this._frameIntArray.length;\r\n                    this._frameIntArray.length += 2;\r\n                    this._frameIntArray[frameValueOffset] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, this._frameDefaultValue) * this._frameValueScale);\r\n                    this._frameIntArray[frameValueOffset + 1] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, this._frameDefaultValue) * this._frameValueScale);\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n                    var frameValueOffset = this._frameFloatArray.length;\r\n                    this._frameFloatArray.length += 2;\r\n                    this._frameFloatArray[frameValueOffset] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, this._frameDefaultValue) * this._frameValueScale;\r\n                    this._frameFloatArray[frameValueOffset + 1] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, this._frameDefaultValue) * this._frameValueScale;\r\n                    break;\r\n                }\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseActionFrame = function (frame, frameStart, frameCount) {\r\n            // tslint:disable-next-line:no-unused-expression\r\n            frameCount;\r\n            var frameOffset = this._frameArray.length;\r\n            var actionCount = frame.actions.length;\r\n            this._frameArray.length += 1 + 1 + actionCount;\r\n            this._frameArray[frameOffset + 0 /* FramePosition */] = frameStart;\r\n            this._frameArray[frameOffset + 0 /* FramePosition */ + 1] = actionCount; // Action count.\r\n            for (var i = 0; i < actionCount; ++i) { // Action offsets.\r\n                this._frameArray[frameOffset + 0 /* FramePosition */ + 2 + i] = frame.actions[i];\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseZOrderFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseFrame(rawData, frameStart, frameCount);\r\n            if (dragonBones.DataParser.Z_ORDER in rawData) {\r\n                var rawZOrder = rawData[dragonBones.DataParser.Z_ORDER];\r\n                if (rawZOrder.length > 0) {\r\n                    var slotCount = this._armature.sortedSlots.length;\r\n                    var unchanged = new Array(slotCount - rawZOrder.length / 2);\r\n                    var zOrders = new Array(slotCount);\r\n                    for (var i_1 = 0; i_1 < unchanged.length; ++i_1) {\r\n                        unchanged[i_1] = 0;\r\n                    }\r\n                    for (var i_2 = 0; i_2 < slotCount; ++i_2) {\r\n                        zOrders[i_2] = -1;\r\n                    }\r\n                    var originalIndex = 0;\r\n                    var unchangedIndex = 0;\r\n                    for (var i_3 = 0, l = rawZOrder.length; i_3 < l; i_3 += 2) {\r\n                        var slotIndex = rawZOrder[i_3];\r\n                        var zOrderOffset = rawZOrder[i_3 + 1];\r\n                        while (originalIndex !== slotIndex) {\r\n                            unchanged[unchangedIndex++] = originalIndex++;\r\n                        }\r\n                        var index = originalIndex + zOrderOffset;\r\n                        zOrders[index] = originalIndex++;\r\n                    }\r\n                    while (originalIndex < slotCount) {\r\n                        unchanged[unchangedIndex++] = originalIndex++;\r\n                    }\r\n                    this._frameArray.length += 1 + slotCount;\r\n                    this._frameArray[frameOffset + 1] = slotCount;\r\n                    var i = slotCount;\r\n                    while (i--) {\r\n                        if (zOrders[i] === -1) {\r\n                            this._frameArray[frameOffset + 2 + i] = unchanged[--unchangedIndex] || 0;\r\n                        }\r\n                        else {\r\n                            this._frameArray[frameOffset + 2 + i] = zOrders[i] || 0;\r\n                        }\r\n                    }\r\n                    return frameOffset;\r\n                }\r\n            }\r\n            this._frameArray.length += 1;\r\n            this._frameArray[frameOffset + 1] = 0;\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseBoneAllFrame = function (rawData, frameStart, frameCount) {\r\n            this._helpTransform.identity();\r\n            if (dragonBones.DataParser.TRANSFORM in rawData) {\r\n                this._parseTransform(rawData[dragonBones.DataParser.TRANSFORM], this._helpTransform, 1.0);\r\n            }\r\n            // Modify rotation.\r\n            var rotation = this._helpTransform.rotation;\r\n            if (frameStart !== 0) {\r\n                if (this._prevClockwise === 0) {\r\n                    rotation = this._prevRotation + dragonBones.Transform.normalizeRadian(rotation - this._prevRotation);\r\n                }\r\n                else {\r\n                    if (this._prevClockwise > 0 ? rotation >= this._prevRotation : rotation <= this._prevRotation) {\r\n                        this._prevClockwise = this._prevClockwise > 0 ? this._prevClockwise - 1 : this._prevClockwise + 1;\r\n                    }\r\n                    rotation = this._prevRotation + rotation - this._prevRotation + dragonBones.Transform.PI_D * this._prevClockwise;\r\n                }\r\n            }\r\n            this._prevClockwise = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.TWEEN_ROTATE, 0.0);\r\n            this._prevRotation = rotation;\r\n            //\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            this._frameFloatArray.length += 6;\r\n            this._frameFloatArray[frameFloatOffset++] = this._helpTransform.x;\r\n            this._frameFloatArray[frameFloatOffset++] = this._helpTransform.y;\r\n            this._frameFloatArray[frameFloatOffset++] = rotation;\r\n            this._frameFloatArray[frameFloatOffset++] = this._helpTransform.skew;\r\n            this._frameFloatArray[frameFloatOffset++] = this._helpTransform.scaleX;\r\n            this._frameFloatArray[frameFloatOffset++] = this._helpTransform.scaleY;\r\n            this._parseActionDataInFrame(rawData, frameStart, this._bone, this._slot);\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseBoneTranslateFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            this._frameFloatArray.length += 2;\r\n            this._frameFloatArray[frameFloatOffset++] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, 0.0);\r\n            this._frameFloatArray[frameFloatOffset++] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, 0.0);\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseBoneRotateFrame = function (rawData, frameStart, frameCount) {\r\n            // Modify rotation.\r\n            var rotation = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ROTATE, 0.0) * dragonBones.Transform.DEG_RAD;\r\n            if (frameStart !== 0) {\r\n                if (this._prevClockwise === 0) {\r\n                    rotation = this._prevRotation + dragonBones.Transform.normalizeRadian(rotation - this._prevRotation);\r\n                }\r\n                else {\r\n                    if (this._prevClockwise > 0 ? rotation >= this._prevRotation : rotation <= this._prevRotation) {\r\n                        this._prevClockwise = this._prevClockwise > 0 ? this._prevClockwise - 1 : this._prevClockwise + 1;\r\n                    }\r\n                    rotation = this._prevRotation + rotation - this._prevRotation + dragonBones.Transform.PI_D * this._prevClockwise;\r\n                }\r\n            }\r\n            this._prevClockwise = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.CLOCK_WISE, 0);\r\n            this._prevRotation = rotation;\r\n            //\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            this._frameFloatArray.length += 2;\r\n            this._frameFloatArray[frameFloatOffset++] = rotation;\r\n            this._frameFloatArray[frameFloatOffset++] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SKEW, 0.0) * dragonBones.Transform.DEG_RAD;\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseBoneScaleFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            this._frameFloatArray.length += 2;\r\n            this._frameFloatArray[frameFloatOffset++] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, 1.0);\r\n            this._frameFloatArray[frameFloatOffset++] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, 1.0);\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseSlotDisplayFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseFrame(rawData, frameStart, frameCount);\r\n            this._frameArray.length += 1;\r\n            if (dragonBones.DataParser.VALUE in rawData) {\r\n                this._frameArray[frameOffset + 1] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.VALUE, 0);\r\n            }\r\n            else {\r\n                this._frameArray[frameOffset + 1] = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.DISPLAY_INDEX, 0);\r\n            }\r\n            this._parseActionDataInFrame(rawData, frameStart, this._slot.parent, this._slot);\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseSlotColorFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var colorOffset = -1;\r\n            if (dragonBones.DataParser.VALUE in rawData || dragonBones.DataParser.COLOR in rawData) {\r\n                var rawColor = dragonBones.DataParser.VALUE in rawData ? rawData[dragonBones.DataParser.VALUE] : rawData[dragonBones.DataParser.COLOR];\r\n                for (var k in rawColor) { // Detects the presence of color.\r\n                    // tslint:disable-next-line:no-unused-expression\r\n                    k;\r\n                    this._parseColorTransform(rawColor, this._helpColorTransform);\r\n                    colorOffset = this._colorArray.length;\r\n                    this._colorArray.length += 8;\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.alphaMultiplier * 100);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.redMultiplier * 100);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.greenMultiplier * 100);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.blueMultiplier * 100);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.alphaOffset);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.redOffset);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.greenOffset);\r\n                    this._colorArray[colorOffset++] = Math.round(this._helpColorTransform.blueOffset);\r\n                    colorOffset -= 8;\r\n                    break;\r\n                }\r\n            }\r\n            if (colorOffset < 0) {\r\n                if (this._defaultColorOffset < 0) {\r\n                    this._defaultColorOffset = colorOffset = this._colorArray.length;\r\n                    this._colorArray.length += 8;\r\n                    this._colorArray[colorOffset++] = 100;\r\n                    this._colorArray[colorOffset++] = 100;\r\n                    this._colorArray[colorOffset++] = 100;\r\n                    this._colorArray[colorOffset++] = 100;\r\n                    this._colorArray[colorOffset++] = 0;\r\n                    this._colorArray[colorOffset++] = 0;\r\n                    this._colorArray[colorOffset++] = 0;\r\n                    this._colorArray[colorOffset++] = 0;\r\n                }\r\n                colorOffset = this._defaultColorOffset;\r\n            }\r\n            var frameIntOffset = this._frameIntArray.length;\r\n            this._frameIntArray.length += 1;\r\n            this._frameIntArray[frameIntOffset] = colorOffset;\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseSlotDeformFrame = function (rawData, frameStart, frameCount) {\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var rawVertices = dragonBones.DataParser.VERTICES in rawData ? rawData[dragonBones.DataParser.VERTICES] : null;\r\n            var offset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.OFFSET, 0); // uint\r\n            var vertexCount = this._intArray[this._mesh.geometry.offset + 0 /* GeometryVertexCount */];\r\n            var meshName = this._mesh.parent.name + "_" + this._slot.name + "_" + this._mesh.name;\r\n            var weight = this._mesh.geometry.weight;\r\n            var x = 0.0;\r\n            var y = 0.0;\r\n            var iB = 0;\r\n            var iV = 0;\r\n            if (weight !== null) {\r\n                var rawSlotPose = this._weightSlotPose[meshName];\r\n                this._helpMatrixA.copyFromArray(rawSlotPose, 0);\r\n                this._frameFloatArray.length += weight.count * 2;\r\n                iB = weight.offset + 2 /* WeigthBoneIndices */ + weight.bones.length;\r\n            }\r\n            else {\r\n                this._frameFloatArray.length += vertexCount * 2;\r\n            }\r\n            for (var i = 0; i < vertexCount * 2; i += 2) {\r\n                if (rawVertices === null) { // Fill 0.\r\n                    x = 0.0;\r\n                    y = 0.0;\r\n                }\r\n                else {\r\n                    if (i < offset || i - offset >= rawVertices.length) {\r\n                        x = 0.0;\r\n                    }\r\n                    else {\r\n                        x = rawVertices[i - offset];\r\n                    }\r\n                    if (i + 1 < offset || i + 1 - offset >= rawVertices.length) {\r\n                        y = 0.0;\r\n                    }\r\n                    else {\r\n                        y = rawVertices[i + 1 - offset];\r\n                    }\r\n                }\r\n                if (weight !== null) { // If mesh is skinned, transform point by bone bind pose.\r\n                    var rawBonePoses = this._weightBonePoses[meshName];\r\n                    var vertexBoneCount = this._intArray[iB++];\r\n                    this._helpMatrixA.transformPoint(x, y, this._helpPoint, true);\r\n                    x = this._helpPoint.x;\r\n                    y = this._helpPoint.y;\r\n                    for (var j = 0; j < vertexBoneCount; ++j) {\r\n                        var boneIndex = this._intArray[iB++];\r\n                        this._helpMatrixB.copyFromArray(rawBonePoses, boneIndex * 7 + 1);\r\n                        this._helpMatrixB.invert();\r\n                        this._helpMatrixB.transformPoint(x, y, this._helpPoint, true);\r\n                        this._frameFloatArray[frameFloatOffset + iV++] = this._helpPoint.x;\r\n                        this._frameFloatArray[frameFloatOffset + iV++] = this._helpPoint.y;\r\n                    }\r\n                }\r\n                else {\r\n                    this._frameFloatArray[frameFloatOffset + i] = x;\r\n                    this._frameFloatArray[frameFloatOffset + i + 1] = y;\r\n                }\r\n            }\r\n            if (frameStart === 0) {\r\n                var frameIntOffset = this._frameIntArray.length;\r\n                this._frameIntArray.length += 1 + 1 + 1 + 1 + 1;\r\n                this._frameIntArray[frameIntOffset + 0 /* DeformVertexOffset */] = this._mesh.geometry.offset;\r\n                this._frameIntArray[frameIntOffset + 1 /* DeformCount */] = this._frameFloatArray.length - frameFloatOffset;\r\n                this._frameIntArray[frameIntOffset + 2 /* DeformValueCount */] = this._frameFloatArray.length - frameFloatOffset;\r\n                this._frameIntArray[frameIntOffset + 3 /* DeformValueOffset */] = 0;\r\n                this._frameIntArray[frameIntOffset + 4 /* DeformFloatOffset */] = frameFloatOffset - this._animation.frameFloatOffset;\r\n                this._timelineArray[this._timeline.offset + 3 /* TimelineFrameValueCount */] = frameIntOffset - this._animation.frameIntOffset;\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseIKConstraintFrame = function (rawData, frameStart, frameCount) {\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var frameIntOffset = this._frameIntArray.length;\r\n            this._frameIntArray.length += 2;\r\n            this._frameIntArray[frameIntOffset++] = ObjectDataParser._getBoolean(rawData, dragonBones.DataParser.BEND_POSITIVE, true) ? 1 : 0;\r\n            this._frameIntArray[frameIntOffset++] = Math.round(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.WEIGHT, 1.0) * 100.0);\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseActionData = function (rawData, type, bone, slot) {\r\n            var actions = new Array();\r\n            if (typeof rawData === "string") {\r\n                var action = dragonBones.BaseObject.borrowObject(dragonBones.ActionData);\r\n                action.type = type;\r\n                action.name = rawData;\r\n                action.bone = bone;\r\n                action.slot = slot;\r\n                actions.push(action);\r\n            }\r\n            else if (rawData instanceof Array) {\r\n                for (var _i = 0, rawData_2 = rawData; _i < rawData_2.length; _i++) {\r\n                    var rawAction = rawData_2[_i];\r\n                    var action = dragonBones.BaseObject.borrowObject(dragonBones.ActionData);\r\n                    if (dragonBones.DataParser.GOTO_AND_PLAY in rawAction) {\r\n                        action.type = 0 /* Play */;\r\n                        action.name = ObjectDataParser._getString(rawAction, dragonBones.DataParser.GOTO_AND_PLAY, "");\r\n                    }\r\n                    else {\r\n                        if (dragonBones.DataParser.TYPE in rawAction && typeof rawAction[dragonBones.DataParser.TYPE] === "string") {\r\n                            action.type = dragonBones.DataParser._getActionType(rawAction[dragonBones.DataParser.TYPE]);\r\n                        }\r\n                        else {\r\n                            action.type = ObjectDataParser._getNumber(rawAction, dragonBones.DataParser.TYPE, type);\r\n                        }\r\n                        action.name = ObjectDataParser._getString(rawAction, dragonBones.DataParser.NAME, "");\r\n                    }\r\n                    if (dragonBones.DataParser.BONE in rawAction) {\r\n                        var boneName = ObjectDataParser._getString(rawAction, dragonBones.DataParser.BONE, "");\r\n                        action.bone = this._armature.getBone(boneName);\r\n                    }\r\n                    else {\r\n                        action.bone = bone;\r\n                    }\r\n                    if (dragonBones.DataParser.SLOT in rawAction) {\r\n                        var slotName = ObjectDataParser._getString(rawAction, dragonBones.DataParser.SLOT, "");\r\n                        action.slot = this._armature.getSlot(slotName);\r\n                    }\r\n                    else {\r\n                        action.slot = slot;\r\n                    }\r\n                    var userData = null;\r\n                    if (dragonBones.DataParser.INTS in rawAction) {\r\n                        if (userData === null) {\r\n                            userData = dragonBones.BaseObject.borrowObject(dragonBones.UserData);\r\n                        }\r\n                        var rawInts = rawAction[dragonBones.DataParser.INTS];\r\n                        for (var _a = 0, rawInts_1 = rawInts; _a < rawInts_1.length; _a++) {\r\n                            var rawValue = rawInts_1[_a];\r\n                            userData.addInt(rawValue);\r\n                        }\r\n                    }\r\n                    if (dragonBones.DataParser.FLOATS in rawAction) {\r\n                        if (userData === null) {\r\n                            userData = dragonBones.BaseObject.borrowObject(dragonBones.UserData);\r\n                        }\r\n                        var rawFloats = rawAction[dragonBones.DataParser.FLOATS];\r\n                        for (var _b = 0, rawFloats_1 = rawFloats; _b < rawFloats_1.length; _b++) {\r\n                            var rawValue = rawFloats_1[_b];\r\n                            userData.addFloat(rawValue);\r\n                        }\r\n                    }\r\n                    if (dragonBones.DataParser.STRINGS in rawAction) {\r\n                        if (userData === null) {\r\n                            userData = dragonBones.BaseObject.borrowObject(dragonBones.UserData);\r\n                        }\r\n                        var rawStrings = rawAction[dragonBones.DataParser.STRINGS];\r\n                        for (var _c = 0, rawStrings_1 = rawStrings; _c < rawStrings_1.length; _c++) {\r\n                            var rawValue = rawStrings_1[_c];\r\n                            userData.addString(rawValue);\r\n                        }\r\n                    }\r\n                    action.data = userData;\r\n                    actions.push(action);\r\n                }\r\n            }\r\n            return actions;\r\n        };\r\n        ObjectDataParser.prototype._parseDeformFrame = function (rawData, frameStart, frameCount) {\r\n            var frameFloatOffset = this._frameFloatArray.length;\r\n            var frameOffset = this._parseTweenFrame(rawData, frameStart, frameCount);\r\n            var rawVertices = dragonBones.DataParser.VERTICES in rawData ?\r\n                rawData[dragonBones.DataParser.VERTICES] :\r\n                (dragonBones.DataParser.VALUE in rawData ? rawData[dragonBones.DataParser.VALUE] : null);\r\n            var offset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.OFFSET, 0); // uint\r\n            var vertexCount = this._intArray[this._geometry.offset + 0 /* GeometryVertexCount */];\r\n            var weight = this._geometry.weight;\r\n            var x = 0.0;\r\n            var y = 0.0;\r\n            if (weight !== null) {\r\n                // TODO\r\n            }\r\n            else {\r\n                this._frameFloatArray.length += vertexCount * 2;\r\n                for (var i = 0; i < vertexCount * 2; i += 2) {\r\n                    if (rawVertices !== null) {\r\n                        if (i < offset || i - offset >= rawVertices.length) {\r\n                            x = 0.0;\r\n                        }\r\n                        else {\r\n                            x = rawVertices[i - offset];\r\n                        }\r\n                        if (i + 1 < offset || i + 1 - offset >= rawVertices.length) {\r\n                            y = 0.0;\r\n                        }\r\n                        else {\r\n                            y = rawVertices[i + 1 - offset];\r\n                        }\r\n                    }\r\n                    else {\r\n                        x = 0.0;\r\n                        y = 0.0;\r\n                    }\r\n                    this._frameFloatArray[frameFloatOffset + i] = x;\r\n                    this._frameFloatArray[frameFloatOffset + i + 1] = y;\r\n                }\r\n            }\r\n            if (frameStart === 0) {\r\n                var frameIntOffset = this._frameIntArray.length;\r\n                this._frameIntArray.length += 1 + 1 + 1 + 1 + 1;\r\n                this._frameIntArray[frameIntOffset + 0 /* DeformVertexOffset */] = this._geometry.offset;\r\n                this._frameIntArray[frameIntOffset + 1 /* DeformCount */] = this._frameFloatArray.length - frameFloatOffset;\r\n                this._frameIntArray[frameIntOffset + 2 /* DeformValueCount */] = this._frameFloatArray.length - frameFloatOffset;\r\n                this._frameIntArray[frameIntOffset + 3 /* DeformValueOffset */] = 0;\r\n                this._frameIntArray[frameIntOffset + 4 /* DeformFloatOffset */] = frameFloatOffset - this._animation.frameFloatOffset;\r\n                this._timelineArray[this._timeline.offset + 3 /* TimelineFrameValueCount */] = frameIntOffset - this._animation.frameIntOffset;\r\n            }\r\n            return frameOffset;\r\n        };\r\n        ObjectDataParser.prototype._parseTransform = function (rawData, transform, scale) {\r\n            transform.x = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.X, 0.0) * scale;\r\n            transform.y = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.Y, 0.0) * scale;\r\n            if (dragonBones.DataParser.ROTATE in rawData || dragonBones.DataParser.SKEW in rawData) {\r\n                transform.rotation = dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ROTATE, 0.0) * dragonBones.Transform.DEG_RAD);\r\n                transform.skew = dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SKEW, 0.0) * dragonBones.Transform.DEG_RAD);\r\n            }\r\n            else if (dragonBones.DataParser.SKEW_X in rawData || dragonBones.DataParser.SKEW_Y in rawData) {\r\n                transform.rotation = dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SKEW_Y, 0.0) * dragonBones.Transform.DEG_RAD);\r\n                transform.skew = dragonBones.Transform.normalizeRadian(ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SKEW_X, 0.0) * dragonBones.Transform.DEG_RAD) - transform.rotation;\r\n            }\r\n            transform.scaleX = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE_X, 1.0);\r\n            transform.scaleY = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE_Y, 1.0);\r\n        };\r\n        ObjectDataParser.prototype._parseColorTransform = function (rawData, color) {\r\n            color.alphaMultiplier = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ALPHA_MULTIPLIER, 100) * 0.01;\r\n            color.redMultiplier = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.RED_MULTIPLIER, 100) * 0.01;\r\n            color.greenMultiplier = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.GREEN_MULTIPLIER, 100) * 0.01;\r\n            color.blueMultiplier = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.BLUE_MULTIPLIER, 100) * 0.01;\r\n            color.alphaOffset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.ALPHA_OFFSET, 0);\r\n            color.redOffset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.RED_OFFSET, 0);\r\n            color.greenOffset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.GREEN_OFFSET, 0);\r\n            color.blueOffset = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.BLUE_OFFSET, 0);\r\n        };\r\n        ObjectDataParser.prototype._parseGeometry = function (rawData, geometry) {\r\n            var rawVertices = rawData[dragonBones.DataParser.VERTICES];\r\n            var vertexCount = Math.floor(rawVertices.length / 2); // uint\r\n            var triangleCount = 0;\r\n            var geometryOffset = this._intArray.length;\r\n            var verticesOffset = this._floatArray.length;\r\n            //\r\n            geometry.offset = geometryOffset;\r\n            geometry.data = this._data;\r\n            //\r\n            this._intArray.length += 1 + 1 + 1 + 1;\r\n            this._intArray[geometryOffset + 0 /* GeometryVertexCount */] = vertexCount;\r\n            this._intArray[geometryOffset + 2 /* GeometryFloatOffset */] = verticesOffset;\r\n            this._intArray[geometryOffset + 3 /* GeometryWeightOffset */] = -1; //\r\n            // \r\n            this._floatArray.length += vertexCount * 2;\r\n            for (var i = 0, l = vertexCount * 2; i < l; ++i) {\r\n                this._floatArray[verticesOffset + i] = rawVertices[i];\r\n            }\r\n            if (dragonBones.DataParser.TRIANGLES in rawData) {\r\n                var rawTriangles = rawData[dragonBones.DataParser.TRIANGLES];\r\n                triangleCount = Math.floor(rawTriangles.length / 3); // uint\r\n                //\r\n                this._intArray.length += triangleCount * 3;\r\n                for (var i = 0, l = triangleCount * 3; i < l; ++i) {\r\n                    this._intArray[geometryOffset + 4 /* GeometryVertexIndices */ + i] = rawTriangles[i];\r\n                }\r\n            }\r\n            // Fill triangle count.\r\n            this._intArray[geometryOffset + 1 /* GeometryTriangleCount */] = triangleCount;\r\n            if (dragonBones.DataParser.UVS in rawData) {\r\n                var rawUVs = rawData[dragonBones.DataParser.UVS];\r\n                var uvOffset = verticesOffset + vertexCount * 2;\r\n                this._floatArray.length += vertexCount * 2;\r\n                for (var i = 0, l = vertexCount * 2; i < l; ++i) {\r\n                    this._floatArray[uvOffset + i] = rawUVs[i];\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.WEIGHTS in rawData) {\r\n                var rawWeights = rawData[dragonBones.DataParser.WEIGHTS];\r\n                var weightCount = Math.floor(rawWeights.length - vertexCount) / 2; // uint\r\n                var weightOffset = this._intArray.length;\r\n                var floatOffset = this._floatArray.length;\r\n                var weightBoneCount = 0;\r\n                var sortedBones = this._armature.sortedBones;\r\n                var weight = dragonBones.BaseObject.borrowObject(dragonBones.WeightData);\r\n                weight.count = weightCount;\r\n                weight.offset = weightOffset;\r\n                this._intArray.length += 1 + 1 + weightBoneCount + vertexCount + weightCount;\r\n                this._intArray[weightOffset + 1 /* WeigthFloatOffset */] = floatOffset;\r\n                if (dragonBones.DataParser.BONE_POSE in rawData) {\r\n                    var rawSlotPose = rawData[dragonBones.DataParser.SLOT_POSE];\r\n                    var rawBonePoses = rawData[dragonBones.DataParser.BONE_POSE];\r\n                    var weightBoneIndices = new Array();\r\n                    weightBoneCount = Math.floor(rawBonePoses.length / 7); // uint\r\n                    weightBoneIndices.length = weightBoneCount;\r\n                    for (var i = 0; i < weightBoneCount; ++i) {\r\n                        var rawBoneIndex = rawBonePoses[i * 7]; // uint\r\n                        var bone = this._rawBones[rawBoneIndex];\r\n                        weight.addBone(bone);\r\n                        weightBoneIndices[i] = rawBoneIndex;\r\n                        this._intArray[weightOffset + 2 /* WeigthBoneIndices */ + i] = sortedBones.indexOf(bone);\r\n                    }\r\n                    this._floatArray.length += weightCount * 3;\r\n                    this._helpMatrixA.copyFromArray(rawSlotPose, 0);\r\n                    for (var i = 0, iW = 0, iB = weightOffset + 2 /* WeigthBoneIndices */ + weightBoneCount, iV = floatOffset; i < vertexCount; ++i) {\r\n                        var iD = i * 2;\r\n                        var vertexBoneCount = this._intArray[iB++] = rawWeights[iW++]; // uint\r\n                        var x = this._floatArray[verticesOffset + iD];\r\n                        var y = this._floatArray[verticesOffset + iD + 1];\r\n                        this._helpMatrixA.transformPoint(x, y, this._helpPoint);\r\n                        x = this._helpPoint.x;\r\n                        y = this._helpPoint.y;\r\n                        for (var j = 0; j < vertexBoneCount; ++j) {\r\n                            var rawBoneIndex = rawWeights[iW++]; // uint\r\n                            var boneIndex = weightBoneIndices.indexOf(rawBoneIndex);\r\n                            this._helpMatrixB.copyFromArray(rawBonePoses, boneIndex * 7 + 1);\r\n                            this._helpMatrixB.invert();\r\n                            this._helpMatrixB.transformPoint(x, y, this._helpPoint);\r\n                            this._intArray[iB++] = boneIndex;\r\n                            this._floatArray[iV++] = rawWeights[iW++];\r\n                            this._floatArray[iV++] = this._helpPoint.x;\r\n                            this._floatArray[iV++] = this._helpPoint.y;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    var rawBones = rawData[dragonBones.DataParser.BONES];\r\n                    weightBoneCount = rawBones.length;\r\n                    for (var i = 0; i < weightBoneCount; i++) {\r\n                        var rawBoneIndex = rawBones[i];\r\n                        var bone = this._rawBones[rawBoneIndex];\r\n                        weight.addBone(bone);\r\n                        this._intArray[weightOffset + 2 /* WeigthBoneIndices */ + i] = sortedBones.indexOf(bone);\r\n                    }\r\n                    this._floatArray.length += weightCount * 3;\r\n                    for (var i = 0, iW = 0, iV = 0, iB = weightOffset + 2 /* WeigthBoneIndices */ + weightBoneCount, iF = floatOffset; i < weightCount; i++) {\r\n                        var vertexBoneCount = rawWeights[iW++];\r\n                        this._intArray[iB++] = vertexBoneCount;\r\n                        for (var j = 0; j < vertexBoneCount; j++) {\r\n                            var boneIndex = rawWeights[iW++];\r\n                            var boneWeight = rawWeights[iW++];\r\n                            var x = rawVertices[iV++];\r\n                            var y = rawVertices[iV++];\r\n                            this._intArray[iB++] = rawBones.indexOf(boneIndex);\r\n                            this._floatArray[iF++] = boneWeight;\r\n                            this._floatArray[iF++] = x;\r\n                            this._floatArray[iF++] = y;\r\n                        }\r\n                    }\r\n                }\r\n                geometry.weight = weight;\r\n            }\r\n        };\r\n        ObjectDataParser.prototype._parseArray = function (rawData) {\r\n            // tslint:disable-next-line:no-unused-expression\r\n            rawData;\r\n            this._intArray.length = 0;\r\n            this._floatArray.length = 0;\r\n            this._frameIntArray.length = 0;\r\n            this._frameFloatArray.length = 0;\r\n            this._frameArray.length = 0;\r\n            this._timelineArray.length = 0;\r\n            this._colorArray.length = 0;\r\n        };\r\n        ObjectDataParser.prototype._modifyArray = function () {\r\n            // Align.\r\n            if ((this._intArray.length % Int16Array.BYTES_PER_ELEMENT) !== 0) {\r\n                this._intArray.push(0);\r\n            }\r\n            if ((this._frameIntArray.length % Int16Array.BYTES_PER_ELEMENT) !== 0) {\r\n                this._frameIntArray.push(0);\r\n            }\r\n            if ((this._frameArray.length % Int16Array.BYTES_PER_ELEMENT) !== 0) {\r\n                this._frameArray.push(0);\r\n            }\r\n            if ((this._timelineArray.length % Uint16Array.BYTES_PER_ELEMENT) !== 0) {\r\n                this._timelineArray.push(0);\r\n            }\r\n            if ((this._timelineArray.length % Int16Array.BYTES_PER_ELEMENT) !== 0) {\r\n                this._colorArray.push(0);\r\n            }\r\n            var l1 = this._intArray.length * Int16Array.BYTES_PER_ELEMENT;\r\n            var l2 = this._floatArray.length * Float32Array.BYTES_PER_ELEMENT;\r\n            var l3 = this._frameIntArray.length * Int16Array.BYTES_PER_ELEMENT;\r\n            var l4 = this._frameFloatArray.length * Float32Array.BYTES_PER_ELEMENT;\r\n            var l5 = this._frameArray.length * Int16Array.BYTES_PER_ELEMENT;\r\n            var l6 = this._timelineArray.length * Uint16Array.BYTES_PER_ELEMENT;\r\n            var l7 = this._colorArray.length * Int16Array.BYTES_PER_ELEMENT;\r\n            var lTotal = l1 + l2 + l3 + l4 + l5 + l6 + l7;\r\n            //\r\n            var binary = new ArrayBuffer(lTotal);\r\n            var intArray = new Int16Array(binary, 0, this._intArray.length);\r\n            var floatArray = new Float32Array(binary, l1, this._floatArray.length);\r\n            var frameIntArray = new Int16Array(binary, l1 + l2, this._frameIntArray.length);\r\n            var frameFloatArray = new Float32Array(binary, l1 + l2 + l3, this._frameFloatArray.length);\r\n            var frameArray = new Int16Array(binary, l1 + l2 + l3 + l4, this._frameArray.length);\r\n            var timelineArray = new Uint16Array(binary, l1 + l2 + l3 + l4 + l5, this._timelineArray.length);\r\n            var colorArray = new Int16Array(binary, l1 + l2 + l3 + l4 + l5 + l6, this._colorArray.length);\r\n            for (var i = 0, l = this._intArray.length; i < l; ++i) {\r\n                intArray[i] = this._intArray[i];\r\n            }\r\n            for (var i = 0, l = this._floatArray.length; i < l; ++i) {\r\n                floatArray[i] = this._floatArray[i];\r\n            }\r\n            for (var i = 0, l = this._frameIntArray.length; i < l; ++i) {\r\n                frameIntArray[i] = this._frameIntArray[i];\r\n            }\r\n            for (var i = 0, l = this._frameFloatArray.length; i < l; ++i) {\r\n                frameFloatArray[i] = this._frameFloatArray[i];\r\n            }\r\n            for (var i = 0, l = this._frameArray.length; i < l; ++i) {\r\n                frameArray[i] = this._frameArray[i];\r\n            }\r\n            for (var i = 0, l = this._timelineArray.length; i < l; ++i) {\r\n                timelineArray[i] = this._timelineArray[i];\r\n            }\r\n            for (var i = 0, l = this._colorArray.length; i < l; ++i) {\r\n                colorArray[i] = this._colorArray[i];\r\n            }\r\n            this._data.binary = binary;\r\n            this._data.intArray = intArray;\r\n            this._data.floatArray = floatArray;\r\n            this._data.frameIntArray = frameIntArray;\r\n            this._data.frameFloatArray = frameFloatArray;\r\n            this._data.frameArray = frameArray;\r\n            this._data.timelineArray = timelineArray;\r\n            this._data.colorArray = colorArray;\r\n            this._defaultColorOffset = -1;\r\n        };\r\n        ObjectDataParser.prototype.parseDragonBonesData = function (rawData, scale) {\r\n            if (scale === void 0) { scale = 1; }\r\n            console.assert(rawData !== null && rawData !== undefined, "Data error.");\r\n            var version = ObjectDataParser._getString(rawData, dragonBones.DataParser.VERSION, "");\r\n            var compatibleVersion = ObjectDataParser._getString(rawData, dragonBones.DataParser.COMPATIBLE_VERSION, "");\r\n            if (dragonBones.DataParser.DATA_VERSIONS.indexOf(version) >= 0 ||\r\n                dragonBones.DataParser.DATA_VERSIONS.indexOf(compatibleVersion) >= 0) {\r\n                var data = dragonBones.BaseObject.borrowObject(dragonBones.DragonBonesData);\r\n                data.version = version;\r\n                data.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n                data.frameRate = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.FRAME_RATE, 24);\r\n                if (data.frameRate === 0) { // Data error.\r\n                    data.frameRate = 24;\r\n                }\r\n                if (dragonBones.DataParser.ARMATURE in rawData) {\r\n                    this._data = data;\r\n                    this._parseArray(rawData);\r\n                    var rawArmatures = rawData[dragonBones.DataParser.ARMATURE];\r\n                    for (var _i = 0, rawArmatures_1 = rawArmatures; _i < rawArmatures_1.length; _i++) {\r\n                        var rawArmature = rawArmatures_1[_i];\r\n                        data.addArmature(this._parseArmature(rawArmature, scale));\r\n                    }\r\n                    if (!this._data.binary) { // DragonBones.webAssembly ? 0 : null;\r\n                        this._modifyArray();\r\n                    }\r\n                    if (dragonBones.DataParser.STAGE in rawData) {\r\n                        data.stage = data.getArmature(ObjectDataParser._getString(rawData, dragonBones.DataParser.STAGE, ""));\r\n                    }\r\n                    else if (data.armatureNames.length > 0) {\r\n                        data.stage = data.getArmature(data.armatureNames[0]);\r\n                    }\r\n                    this._data = null;\r\n                }\r\n                if (dragonBones.DataParser.TEXTURE_ATLAS in rawData) {\r\n                    this._rawTextureAtlases = rawData[dragonBones.DataParser.TEXTURE_ATLAS];\r\n                }\r\n                return data;\r\n            }\r\n            else {\r\n                console.assert(false, "Nonsupport data version: " + version + "\\n" +\r\n                    "Please convert DragonBones data to support version.\\n" +\r\n                    "Read more: https://github.com/DragonBones/Tools/");\r\n            }\r\n            return null;\r\n        };\r\n        ObjectDataParser.prototype.parseTextureAtlasData = function (rawData, textureAtlasData, scale) {\r\n            if (scale === void 0) { scale = 1.0; }\r\n            console.assert(rawData !== undefined);\r\n            if (rawData === null) {\r\n                if (this._rawTextureAtlases === null || this._rawTextureAtlases.length === 0) {\r\n                    return false;\r\n                }\r\n                var rawTextureAtlas = this._rawTextureAtlases[this._rawTextureAtlasIndex++];\r\n                this.parseTextureAtlasData(rawTextureAtlas, textureAtlasData, scale);\r\n                if (this._rawTextureAtlasIndex >= this._rawTextureAtlases.length) {\r\n                    this._rawTextureAtlasIndex = 0;\r\n                    this._rawTextureAtlases = null;\r\n                }\r\n                return true;\r\n            }\r\n            // Texture format.\r\n            textureAtlasData.width = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.WIDTH, 0);\r\n            textureAtlasData.height = ObjectDataParser._getNumber(rawData, dragonBones.DataParser.HEIGHT, 0);\r\n            textureAtlasData.scale = scale === 1.0 ? (1.0 / ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE, 1.0)) : scale;\r\n            textureAtlasData.name = ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, "");\r\n            textureAtlasData.imagePath = ObjectDataParser._getString(rawData, dragonBones.DataParser.IMAGE_PATH, "");\r\n            if (dragonBones.DataParser.SUB_TEXTURE in rawData) {\r\n                var rawTextures = rawData[dragonBones.DataParser.SUB_TEXTURE];\r\n                for (var i = 0, l = rawTextures.length; i < l; ++i) {\r\n                    var rawTexture = rawTextures[i];\r\n                    var frameWidth = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.FRAME_WIDTH, -1.0);\r\n                    var frameHeight = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.FRAME_HEIGHT, -1.0);\r\n                    var textureData = textureAtlasData.createTexture();\r\n                    textureData.rotated = ObjectDataParser._getBoolean(rawTexture, dragonBones.DataParser.ROTATED, false);\r\n                    textureData.name = ObjectDataParser._getString(rawTexture, dragonBones.DataParser.NAME, "");\r\n                    textureData.region.x = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.X, 0.0);\r\n                    textureData.region.y = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.Y, 0.0);\r\n                    textureData.region.width = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.WIDTH, 0.0);\r\n                    textureData.region.height = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.HEIGHT, 0.0);\r\n                    if (frameWidth > 0.0 && frameHeight > 0.0) {\r\n                        textureData.frame = dragonBones.TextureData.createRectangle();\r\n                        textureData.frame.x = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.FRAME_X, 0.0);\r\n                        textureData.frame.y = ObjectDataParser._getNumber(rawTexture, dragonBones.DataParser.FRAME_Y, 0.0);\r\n                        textureData.frame.width = frameWidth;\r\n                        textureData.frame.height = frameHeight;\r\n                    }\r\n                    textureAtlasData.addTexture(textureData);\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /**\r\n         * - Deprecated, please refer to {@link dragonBones.BaseFactory#parseDragonBonesData()}.\r\n         * @deprecated\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 已废弃，请参考 {@link dragonBones.BaseFactory#parseDragonBonesData()}。\r\n         * @deprecated\r\n         * @language zh_CN\r\n         */\r\n        ObjectDataParser.getInstance = function () {\r\n            if (ObjectDataParser._objectDataParserInstance === null) {\r\n                ObjectDataParser._objectDataParserInstance = new ObjectDataParser();\r\n            }\r\n            return ObjectDataParser._objectDataParserInstance;\r\n        };\r\n        ObjectDataParser._objectDataParserInstance = null;\r\n        return ObjectDataParser;\r\n    }(dragonBones.DataParser));\r\n    dragonBones.ObjectDataParser = ObjectDataParser;\r\n    /**\r\n     * @private\r\n     */\r\n    var ActionFrame = /** @class */ (function () {\r\n        function ActionFrame() {\r\n            this.frameStart = 0;\r\n            this.actions = [];\r\n        }\r\n        return ActionFrame;\r\n    }());\r\n    dragonBones.ActionFrame = ActionFrame;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * @private\r\n     */\r\n    var BinaryDataParser = /** @class */ (function (_super) {\r\n        __extends(BinaryDataParser, _super);\r\n        function BinaryDataParser() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        BinaryDataParser.prototype._inRange = function (a, min, max) {\r\n            return min <= a && a <= max;\r\n        };\r\n        BinaryDataParser.prototype._decodeUTF8 = function (data) {\r\n            var EOF_byte = -1;\r\n            var EOF_code_point = -1;\r\n            var FATAL_POINT = 0xFFFD;\r\n            var pos = 0;\r\n            var result = "";\r\n            var code_point;\r\n            var utf8_code_point = 0;\r\n            var utf8_bytes_needed = 0;\r\n            var utf8_bytes_seen = 0;\r\n            var utf8_lower_boundary = 0;\r\n            while (data.length > pos) {\r\n                var _byte = data[pos++];\r\n                if (_byte === EOF_byte) {\r\n                    if (utf8_bytes_needed !== 0) {\r\n                        code_point = FATAL_POINT;\r\n                    }\r\n                    else {\r\n                        code_point = EOF_code_point;\r\n                    }\r\n                }\r\n                else {\r\n                    if (utf8_bytes_needed === 0) {\r\n                        if (this._inRange(_byte, 0x00, 0x7F)) {\r\n                            code_point = _byte;\r\n                        }\r\n                        else {\r\n                            if (this._inRange(_byte, 0xC2, 0xDF)) {\r\n                                utf8_bytes_needed = 1;\r\n                                utf8_lower_boundary = 0x80;\r\n                                utf8_code_point = _byte - 0xC0;\r\n                            }\r\n                            else if (this._inRange(_byte, 0xE0, 0xEF)) {\r\n                                utf8_bytes_needed = 2;\r\n                                utf8_lower_boundary = 0x800;\r\n                                utf8_code_point = _byte - 0xE0;\r\n                            }\r\n                            else if (this._inRange(_byte, 0xF0, 0xF4)) {\r\n                                utf8_bytes_needed = 3;\r\n                                utf8_lower_boundary = 0x10000;\r\n                                utf8_code_point = _byte - 0xF0;\r\n                            }\r\n                            else {\r\n                            }\r\n                            utf8_code_point = utf8_code_point * Math.pow(64, utf8_bytes_needed);\r\n                            code_point = null;\r\n                        }\r\n                    }\r\n                    else if (!this._inRange(_byte, 0x80, 0xBF)) {\r\n                        utf8_code_point = 0;\r\n                        utf8_bytes_needed = 0;\r\n                        utf8_bytes_seen = 0;\r\n                        utf8_lower_boundary = 0;\r\n                        pos--;\r\n                        code_point = _byte;\r\n                    }\r\n                    else {\r\n                        utf8_bytes_seen += 1;\r\n                        utf8_code_point = utf8_code_point + (_byte - 0x80) * Math.pow(64, utf8_bytes_needed - utf8_bytes_seen);\r\n                        if (utf8_bytes_seen !== utf8_bytes_needed) {\r\n                            code_point = null;\r\n                        }\r\n                        else {\r\n                            var cp = utf8_code_point;\r\n                            var lower_boundary = utf8_lower_boundary;\r\n                            utf8_code_point = 0;\r\n                            utf8_bytes_needed = 0;\r\n                            utf8_bytes_seen = 0;\r\n                            utf8_lower_boundary = 0;\r\n                            if (this._inRange(cp, lower_boundary, 0x10FFFF) && !this._inRange(cp, 0xD800, 0xDFFF)) {\r\n                                code_point = cp;\r\n                            }\r\n                            else {\r\n                                code_point = _byte;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                //Decode string\r\n                if (code_point !== null && code_point !== EOF_code_point) {\r\n                    if (code_point <= 0xFFFF) {\r\n                        if (code_point > 0)\r\n                            result += String.fromCharCode(code_point);\r\n                    }\r\n                    else {\r\n                        code_point -= 0x10000;\r\n                        result += String.fromCharCode(0xD800 + ((code_point >> 10) & 0x3ff));\r\n                        result += String.fromCharCode(0xDC00 + (code_point & 0x3ff));\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n        BinaryDataParser.prototype._parseBinaryTimeline = function (type, offset, timelineData) {\r\n            if (timelineData === void 0) { timelineData = null; }\r\n            var timeline = timelineData !== null ? timelineData : dragonBones.BaseObject.borrowObject(dragonBones.TimelineData);\r\n            timeline.type = type;\r\n            timeline.offset = offset;\r\n            this._timeline = timeline;\r\n            var keyFrameCount = this._timelineArrayBuffer[timeline.offset + 2 /* TimelineKeyFrameCount */];\r\n            if (keyFrameCount === 1) {\r\n                timeline.frameIndicesOffset = -1;\r\n            }\r\n            else {\r\n                var frameIndicesOffset = 0;\r\n                var totalFrameCount = this._animation.frameCount + 1; // One more frame than animation.\r\n                var frameIndices = this._data.frameIndices;\r\n                frameIndicesOffset = frameIndices.length;\r\n                frameIndices.length += totalFrameCount;\r\n                timeline.frameIndicesOffset = frameIndicesOffset;\r\n                for (var i = 0, iK = 0, frameStart = 0, frameCount = 0; i < totalFrameCount; ++i) {\r\n                    if (frameStart + frameCount <= i && iK < keyFrameCount) {\r\n                        frameStart = this._frameArrayBuffer[this._animation.frameOffset + this._timelineArrayBuffer[timeline.offset + 5 /* TimelineFrameOffset */ + iK]];\r\n                        if (iK === keyFrameCount - 1) {\r\n                            frameCount = this._animation.frameCount - frameStart;\r\n                        }\r\n                        else {\r\n                            frameCount = this._frameArrayBuffer[this._animation.frameOffset + this._timelineArrayBuffer[timeline.offset + 5 /* TimelineFrameOffset */ + iK + 1]] - frameStart;\r\n                        }\r\n                        iK++;\r\n                    }\r\n                    frameIndices[frameIndicesOffset + i] = iK - 1;\r\n                }\r\n            }\r\n            this._timeline = null; //\r\n            return timeline;\r\n        };\r\n        BinaryDataParser.prototype._parseAnimation = function (rawData) {\r\n            var animation = dragonBones.BaseObject.borrowObject(dragonBones.AnimationData);\r\n            animation.blendType = dragonBones.DataParser._getAnimationBlendType(dragonBones.ObjectDataParser._getString(rawData, dragonBones.DataParser.BLEND_TYPE, ""));\r\n            animation.frameCount = dragonBones.ObjectDataParser._getNumber(rawData, dragonBones.DataParser.DURATION, 0);\r\n            animation.playTimes = dragonBones.ObjectDataParser._getNumber(rawData, dragonBones.DataParser.PLAY_TIMES, 1);\r\n            animation.duration = animation.frameCount / this._armature.frameRate; // float\r\n            animation.fadeInTime = dragonBones.ObjectDataParser._getNumber(rawData, dragonBones.DataParser.FADE_IN_TIME, 0.0);\r\n            animation.scale = dragonBones.ObjectDataParser._getNumber(rawData, dragonBones.DataParser.SCALE, 1.0);\r\n            animation.name = dragonBones.ObjectDataParser._getString(rawData, dragonBones.DataParser.NAME, dragonBones.DataParser.DEFAULT_NAME);\r\n            if (animation.name.length === 0) {\r\n                animation.name = dragonBones.DataParser.DEFAULT_NAME;\r\n            }\r\n            // Offsets.\r\n            var offsets = rawData[dragonBones.DataParser.OFFSET];\r\n            animation.frameIntOffset = offsets[0];\r\n            animation.frameFloatOffset = offsets[1];\r\n            animation.frameOffset = offsets[2];\r\n            this._animation = animation;\r\n            if (dragonBones.DataParser.ACTION in rawData) {\r\n                animation.actionTimeline = this._parseBinaryTimeline(0 /* Action */, rawData[dragonBones.DataParser.ACTION]);\r\n            }\r\n            if (dragonBones.DataParser.Z_ORDER in rawData) {\r\n                animation.zOrderTimeline = this._parseBinaryTimeline(1 /* ZOrder */, rawData[dragonBones.DataParser.Z_ORDER]);\r\n            }\r\n            if (dragonBones.DataParser.BONE in rawData) {\r\n                var rawTimeliness = rawData[dragonBones.DataParser.BONE];\r\n                for (var k in rawTimeliness) {\r\n                    var rawTimelines = rawTimeliness[k];\r\n                    var bone = this._armature.getBone(k);\r\n                    if (bone === null) {\r\n                        continue;\r\n                    }\r\n                    for (var i = 0, l = rawTimelines.length; i < l; i += 2) {\r\n                        var timelineType = rawTimelines[i];\r\n                        var timelineOffset = rawTimelines[i + 1];\r\n                        var timeline = this._parseBinaryTimeline(timelineType, timelineOffset);\r\n                        this._animation.addBoneTimeline(bone.name, timeline);\r\n                    }\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.SLOT in rawData) {\r\n                var rawTimeliness = rawData[dragonBones.DataParser.SLOT];\r\n                for (var k in rawTimeliness) {\r\n                    var rawTimelines = rawTimeliness[k];\r\n                    var slot = this._armature.getSlot(k);\r\n                    if (slot === null) {\r\n                        continue;\r\n                    }\r\n                    for (var i = 0, l = rawTimelines.length; i < l; i += 2) {\r\n                        var timelineType = rawTimelines[i];\r\n                        var timelineOffset = rawTimelines[i + 1];\r\n                        var timeline = this._parseBinaryTimeline(timelineType, timelineOffset);\r\n                        this._animation.addSlotTimeline(slot.name, timeline);\r\n                    }\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.CONSTRAINT in rawData) {\r\n                var rawTimeliness = rawData[dragonBones.DataParser.CONSTRAINT];\r\n                for (var k in rawTimeliness) {\r\n                    var rawTimelines = rawTimeliness[k];\r\n                    var constraint = this._armature.getConstraint(k);\r\n                    if (constraint === null) {\r\n                        continue;\r\n                    }\r\n                    for (var i = 0, l = rawTimelines.length; i < l; i += 2) {\r\n                        var timelineType = rawTimelines[i];\r\n                        var timelineOffset = rawTimelines[i + 1];\r\n                        var timeline = this._parseBinaryTimeline(timelineType, timelineOffset);\r\n                        this._animation.addConstraintTimeline(constraint.name, timeline);\r\n                    }\r\n                }\r\n            }\r\n            if (dragonBones.DataParser.TIMELINE in rawData) {\r\n                var rawTimelines = rawData[dragonBones.DataParser.TIMELINE];\r\n                for (var _i = 0, rawTimelines_6 = rawTimelines; _i < rawTimelines_6.length; _i++) {\r\n                    var rawTimeline = rawTimelines_6[_i];\r\n                    var timelineOffset = dragonBones.ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.OFFSET, 0);\r\n                    if (timelineOffset >= 0) {\r\n                        var timelineType = dragonBones.ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.TYPE, 0 /* Action */);\r\n                        var timelineName = dragonBones.ObjectDataParser._getString(rawTimeline, dragonBones.DataParser.NAME, "");\r\n                        var timeline = null;\r\n                        if (timelineType === 40 /* AnimationProgress */ && animation.blendType !== 0 /* None */) {\r\n                            timeline = dragonBones.BaseObject.borrowObject(dragonBones.AnimationTimelineData);\r\n                            var animaitonTimeline = timeline;\r\n                            animaitonTimeline.x = dragonBones.ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.X, 0.0);\r\n                            animaitonTimeline.y = dragonBones.ObjectDataParser._getNumber(rawTimeline, dragonBones.DataParser.Y, 0.0);\r\n                        }\r\n                        timeline = this._parseBinaryTimeline(timelineType, timelineOffset, timeline);\r\n                        switch (timelineType) {\r\n                            case 0 /* Action */:\r\n                                // TODO\r\n                                break;\r\n                            case 1 /* ZOrder */:\r\n                                // TODO\r\n                                break;\r\n                            case 11 /* BoneTranslate */:\r\n                            case 12 /* BoneRotate */:\r\n                            case 13 /* BoneScale */:\r\n                            case 50 /* Surface */:\r\n                            case 60 /* BoneAlpha */:\r\n                                this._animation.addBoneTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 20 /* SlotDisplay */:\r\n                            case 21 /* SlotColor */:\r\n                            case 22 /* SlotDeform */:\r\n                            case 23 /* SlotZIndex */:\r\n                            case 24 /* SlotAlpha */:\r\n                                this._animation.addSlotTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 30 /* IKConstraint */:\r\n                                this._animation.addConstraintTimeline(timelineName, timeline);\r\n                                break;\r\n                            case 40 /* AnimationProgress */:\r\n                            case 41 /* AnimationWeight */:\r\n                            case 42 /* AnimationParameter */:\r\n                                this._animation.addAnimationTimeline(timelineName, timeline);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._animation = null;\r\n            return animation;\r\n        };\r\n        BinaryDataParser.prototype._parseGeometry = function (rawData, geometry) {\r\n            geometry.offset = rawData[dragonBones.DataParser.OFFSET];\r\n            geometry.data = this._data;\r\n            var weightOffset = this._intArrayBuffer[geometry.offset + 3 /* GeometryWeightOffset */];\r\n            if (weightOffset >= 0) {\r\n                var weight = dragonBones.BaseObject.borrowObject(dragonBones.WeightData);\r\n                var vertexCount = this._intArrayBuffer[geometry.offset + 0 /* GeometryVertexCount */];\r\n                var boneCount = this._intArrayBuffer[weightOffset + 0 /* WeigthBoneCount */];\r\n                weight.offset = weightOffset;\r\n                for (var i = 0; i < boneCount; ++i) {\r\n                    var boneIndex = this._intArrayBuffer[weightOffset + 2 /* WeigthBoneIndices */ + i];\r\n                    weight.addBone(this._rawBones[boneIndex]);\r\n                }\r\n                var boneIndicesOffset = weightOffset + 2 /* WeigthBoneIndices */ + boneCount;\r\n                var weightCount = 0;\r\n                for (var i = 0, l = vertexCount; i < l; ++i) {\r\n                    var vertexBoneCount = this._intArrayBuffer[boneIndicesOffset++];\r\n                    weightCount += vertexBoneCount;\r\n                    boneIndicesOffset += vertexBoneCount;\r\n                }\r\n                weight.count = weightCount;\r\n                geometry.weight = weight;\r\n            }\r\n        };\r\n        BinaryDataParser.prototype._parseArray = function (rawData) {\r\n            var offsets = rawData[dragonBones.DataParser.OFFSET];\r\n            var l1 = offsets[1];\r\n            var l2 = offsets[3];\r\n            var l3 = offsets[5];\r\n            var l4 = offsets[7];\r\n            var l5 = offsets[9];\r\n            var l6 = offsets[11];\r\n            var l7 = offsets.length > 12 ? offsets[13] : 0; // Color.\r\n            var intArray = new Int16Array(this._binary, this._binaryOffset + offsets[0], l1 / Int16Array.BYTES_PER_ELEMENT);\r\n            var floatArray = new Float32Array(this._binary, this._binaryOffset + offsets[2], l2 / Float32Array.BYTES_PER_ELEMENT);\r\n            var frameIntArray = new Int16Array(this._binary, this._binaryOffset + offsets[4], l3 / Int16Array.BYTES_PER_ELEMENT);\r\n            var frameFloatArray = new Float32Array(this._binary, this._binaryOffset + offsets[6], l4 / Float32Array.BYTES_PER_ELEMENT);\r\n            var frameArray = new Int16Array(this._binary, this._binaryOffset + offsets[8], l5 / Int16Array.BYTES_PER_ELEMENT);\r\n            var timelineArray = new Uint16Array(this._binary, this._binaryOffset + offsets[10], l6 / Uint16Array.BYTES_PER_ELEMENT);\r\n            var colorArray = l7 > 0 ? new Int16Array(this._binary, this._binaryOffset + offsets[12], l7 / Int16Array.BYTES_PER_ELEMENT) : intArray; // Color.\r\n            this._data.binary = this._binary;\r\n            this._data.intArray = this._intArrayBuffer = intArray;\r\n            this._data.floatArray = floatArray;\r\n            this._data.frameIntArray = frameIntArray;\r\n            this._data.frameFloatArray = frameFloatArray;\r\n            this._data.frameArray = this._frameArrayBuffer = frameArray;\r\n            this._data.timelineArray = this._timelineArrayBuffer = timelineArray;\r\n            this._data.colorArray = colorArray;\r\n        };\r\n        BinaryDataParser.prototype.parseDragonBonesData = function (rawData, scale) {\r\n            if (scale === void 0) { scale = 1; }\r\n            console.assert(rawData !== null && rawData !== undefined && rawData instanceof ArrayBuffer, "Data error.");\r\n            var tag = new Uint8Array(rawData, 0, 8);\r\n            if (tag[0] !== "D".charCodeAt(0) ||\r\n                tag[1] !== "B".charCodeAt(0) ||\r\n                tag[2] !== "D".charCodeAt(0) ||\r\n                tag[3] !== "T".charCodeAt(0)) {\r\n                console.assert(false, "Nonsupport data.");\r\n                return null;\r\n            }\r\n            var headerLength = new Uint32Array(rawData, 8, 1)[0];\r\n            var headerBytes = new Uint8Array(rawData, 8 + 4, headerLength);\r\n            var headerString = this._decodeUTF8(headerBytes);\r\n            var header = JSON.parse(headerString);\r\n            //\r\n            this._binaryOffset = 8 + 4 + headerLength;\r\n            this._binary = rawData;\r\n            return _super.prototype.parseDragonBonesData.call(this, header, scale);\r\n        };\r\n        /**\r\n         * - Deprecated, please refer to {@link dragonBones.BaseFactory#parseDragonBonesData()}.\r\n         * @deprecated\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 已废弃，请参考 {@link dragonBones.BaseFactory#parseDragonBonesData()}。\r\n         * @deprecated\r\n         * @language zh_CN\r\n         */\r\n        BinaryDataParser.getInstance = function () {\r\n            if (BinaryDataParser._binaryDataParserInstance === null) {\r\n                BinaryDataParser._binaryDataParserInstance = new BinaryDataParser();\r\n            }\r\n            return BinaryDataParser._binaryDataParserInstance;\r\n        };\r\n        BinaryDataParser._binaryDataParserInstance = null;\r\n        return BinaryDataParser;\r\n    }(dragonBones.ObjectDataParser));\r\n    dragonBones.BinaryDataParser = BinaryDataParser;\r\n})(dragonBones || (dragonBones = {}));\r\n/**\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2012-2018 DragonBones team and other contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\r\n * this software and associated documentation files (the "Software"), to deal in\r\n * the Software without restriction, including without limitation the rights to\r\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\n * the Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    /**\r\n     * - Base class for the factory that create the armatures. (Typically only one global factory instance is required)\r\n     * The factory instance create armatures by parsed and added DragonBonesData instances and TextureAtlasData instances.\r\n     * Once the data has been parsed, it has been cached in the factory instance and does not need to be parsed again until it is cleared by the factory instance.\r\n     * @see dragonBones.DragonBonesData\r\n     * @see dragonBones.TextureAtlasData\r\n     * @see dragonBones.ArmatureData\r\n     * @see dragonBones.Armature\r\n     * @version DragonBones 3.0\r\n     * @language en_US\r\n     */\r\n    /**\r\n     * - 创建骨架的工厂基类。 （通常只需要一个全局工厂实例）\r\n     * 工厂通过解析并添加的 DragonBonesData 实例和 TextureAtlasData 实例来创建骨架。\r\n     * 当数据被解析过之后，已经添加到工厂中，在没有被工厂清理之前，不需要再次解析。\r\n     * @see dragonBones.DragonBonesData\r\n     * @see dragonBones.TextureAtlasData\r\n     * @see dragonBones.ArmatureData\r\n     * @see dragonBones.Armature\r\n     * @version DragonBones 3.0\r\n     * @language zh_CN\r\n     */\r\n    var BaseFactory = /** @class */ (function () {\r\n        /**\r\n         * - Create a factory instance. (typically only one global factory instance is required)\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 创建一个工厂实例。 （通常只需要一个全局工厂实例）\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        function BaseFactory(dataParser) {\r\n            if (dataParser === void 0) { dataParser = null; }\r\n            /**\r\n             * @private\r\n             */\r\n            this.autoSearch = false;\r\n            this._dragonBonesDataMap = {};\r\n            this._textureAtlasDataMap = {};\r\n            this._dragonBones = null;\r\n            this._dataParser = null;\r\n            if (BaseFactory._objectParser === null) {\r\n                BaseFactory._objectParser = new dragonBones.ObjectDataParser();\r\n            }\r\n            if (BaseFactory._binaryParser === null) {\r\n                BaseFactory._binaryParser = new dragonBones.BinaryDataParser();\r\n            }\r\n            this._dataParser = dataParser !== null ? dataParser : BaseFactory._objectParser;\r\n        }\r\n        BaseFactory.prototype._isSupportMesh = function () {\r\n            return true;\r\n        };\r\n        BaseFactory.prototype._getTextureData = function (textureAtlasName, textureName) {\r\n            if (textureAtlasName in this._textureAtlasDataMap) {\r\n                for (var _i = 0, _a = this._textureAtlasDataMap[textureAtlasName]; _i < _a.length; _i++) {\r\n                    var textureAtlasData = _a[_i];\r\n                    var textureData = textureAtlasData.getTexture(textureName);\r\n                    if (textureData !== null) {\r\n                        return textureData;\r\n                    }\r\n                }\r\n            }\r\n            if (this.autoSearch) { // Will be search all data, if the autoSearch is true.\r\n                for (var k in this._textureAtlasDataMap) {\r\n                    for (var _b = 0, _c = this._textureAtlasDataMap[k]; _b < _c.length; _b++) {\r\n                        var textureAtlasData = _c[_b];\r\n                        if (textureAtlasData.autoSearch) {\r\n                            var textureData = textureAtlasData.getTexture(textureName);\r\n                            if (textureData !== null) {\r\n                                return textureData;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        BaseFactory.prototype._fillBuildArmaturePackage = function (dataPackage, dragonBonesName, armatureName, skinName, textureAtlasName) {\r\n            var dragonBonesData = null;\r\n            var armatureData = null;\r\n            if (dragonBonesName.length > 0) {\r\n                if (dragonBonesName in this._dragonBonesDataMap) {\r\n                    dragonBonesData = this._dragonBonesDataMap[dragonBonesName];\r\n                    armatureData = dragonBonesData.getArmature(armatureName);\r\n                }\r\n            }\r\n            if (armatureData === null && (dragonBonesName.length === 0 || this.autoSearch)) { // Will be search all data, if do not give a data name or the autoSearch is true.\r\n                for (var k in this._dragonBonesDataMap) {\r\n                    dragonBonesData = this._dragonBonesDataMap[k];\r\n                    if (dragonBonesName.length === 0 || dragonBonesData.autoSearch) {\r\n                        armatureData = dragonBonesData.getArmature(armatureName);\r\n                        if (armatureData !== null) {\r\n                            dragonBonesName = k;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (armatureData !== null) {\r\n                dataPackage.dataName = dragonBonesName;\r\n                dataPackage.textureAtlasName = textureAtlasName;\r\n                dataPackage.data = dragonBonesData;\r\n                dataPackage.armature = armatureData;\r\n                dataPackage.skin = null;\r\n                if (skinName.length > 0) {\r\n                    dataPackage.skin = armatureData.getSkin(skinName);\r\n                    if (dataPackage.skin === null && this.autoSearch) {\r\n                        for (var k in this._dragonBonesDataMap) {\r\n                            var skinDragonBonesData = this._dragonBonesDataMap[k];\r\n                            var skinArmatureData = skinDragonBonesData.getArmature(skinName);\r\n                            if (skinArmatureData !== null) {\r\n                                dataPackage.skin = skinArmatureData.defaultSkin;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (dataPackage.skin === null) {\r\n                    dataPackage.skin = armatureData.defaultSkin;\r\n                }\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        BaseFactory.prototype._buildBones = function (dataPackage, armature) {\r\n            for (var _i = 0, _a = dataPackage.armature.sortedBones; _i < _a.length; _i++) {\r\n                var boneData = _a[_i];\r\n                var bone = dragonBones.BaseObject.borrowObject(boneData.type === 0 /* Bone */ ? dragonBones.Bone : dragonBones.Surface);\r\n                bone.init(boneData, armature);\r\n            }\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        BaseFactory.prototype._buildSlots = function (dataPackage, armature) {\r\n            var currentSkin = dataPackage.skin;\r\n            var defaultSkin = dataPackage.armature.defaultSkin;\r\n            if (currentSkin === null || defaultSkin === null) {\r\n                return;\r\n            }\r\n            var skinSlots = {};\r\n            for (var k in defaultSkin.displays) {\r\n                var displays = defaultSkin.getDisplays(k);\r\n                skinSlots[k] = displays;\r\n            }\r\n            if (currentSkin !== defaultSkin) {\r\n                for (var k in currentSkin.displays) {\r\n                    var displays = currentSkin.getDisplays(k);\r\n                    skinSlots[k] = displays;\r\n                }\r\n            }\r\n            for (var _i = 0, _a = dataPackage.armature.sortedSlots; _i < _a.length; _i++) {\r\n                var slotData = _a[_i];\r\n                var displayDatas = slotData.name in skinSlots ? skinSlots[slotData.name] : null;\r\n                var slot = this._buildSlot(dataPackage, slotData, armature);\r\n                if (displayDatas !== null) {\r\n                    slot.displayFrameCount = displayDatas.length;\r\n                    for (var i = 0, l = slot.displayFrameCount; i < l; ++i) {\r\n                        var displayData = displayDatas[i];\r\n                        slot.replaceRawDisplayData(displayData, i);\r\n                        if (displayData !== null) {\r\n                            if (dataPackage.textureAtlasName.length > 0) {\r\n                                var textureData = this._getTextureData(dataPackage.textureAtlasName, displayData.path);\r\n                                slot.replaceTextureData(textureData, i);\r\n                            }\r\n                            var display = this._getSlotDisplay(dataPackage, displayData, slot);\r\n                            slot.replaceDisplay(display, i);\r\n                        }\r\n                        else {\r\n                            slot.replaceDisplay(null);\r\n                        }\r\n                    }\r\n                }\r\n                slot._setDisplayIndex(slotData.displayIndex, true);\r\n            }\r\n        };\r\n        BaseFactory.prototype._buildConstraints = function (dataPackage, armature) {\r\n            var constraints = dataPackage.armature.constraints;\r\n            for (var k in constraints) {\r\n                var constraintData = constraints[k];\r\n                // TODO more constraint type.\r\n                switch (constraintData.type) {\r\n                    case 0 /* IK */:\r\n                        var ikConstraint = dragonBones.BaseObject.borrowObject(dragonBones.IKConstraint);\r\n                        ikConstraint.init(constraintData, armature);\r\n                        armature._addConstraint(ikConstraint);\r\n                        break;\r\n                    case 1 /* Path */:\r\n                        var pathConstraint = dragonBones.BaseObject.borrowObject(dragonBones.PathConstraint);\r\n                        pathConstraint.init(constraintData, armature);\r\n                        armature._addConstraint(pathConstraint);\r\n                        break;\r\n                    default:\r\n                        var constraint = dragonBones.BaseObject.borrowObject(dragonBones.IKConstraint);\r\n                        constraint.init(constraintData, armature);\r\n                        armature._addConstraint(constraint);\r\n                        break;\r\n                }\r\n            }\r\n        };\r\n        BaseFactory.prototype._buildChildArmature = function (dataPackage, _slot, displayData) {\r\n            return this.buildArmature(displayData.path, dataPackage !== null ? dataPackage.dataName : "", "", dataPackage !== null ? dataPackage.textureAtlasName : "");\r\n        };\r\n        BaseFactory.prototype._getSlotDisplay = function (dataPackage, displayData, slot) {\r\n            var dataName = dataPackage !== null ? dataPackage.dataName : displayData.parent.parent.parent.name;\r\n            var display = null;\r\n            switch (displayData.type) {\r\n                case 0 /* Image */: {\r\n                    var imageDisplayData = displayData;\r\n                    if (imageDisplayData.texture === null) {\r\n                        imageDisplayData.texture = this._getTextureData(dataName, displayData.path);\r\n                    }\r\n                    display = slot.rawDisplay;\r\n                    break;\r\n                }\r\n                case 2 /* Mesh */: {\r\n                    var meshDisplayData = displayData;\r\n                    if (meshDisplayData.texture === null) {\r\n                        meshDisplayData.texture = this._getTextureData(dataName, meshDisplayData.path);\r\n                    }\r\n                    if (this._isSupportMesh()) {\r\n                        display = slot.meshDisplay;\r\n                    }\r\n                    else {\r\n                        display = slot.rawDisplay;\r\n                    }\r\n                    break;\r\n                }\r\n                case 1 /* Armature */: {\r\n                    var armatureDisplayData = displayData;\r\n                    var childArmature = this._buildChildArmature(dataPackage, slot, armatureDisplayData);\r\n                    if (childArmature !== null) {\r\n                        childArmature.inheritAnimation = armatureDisplayData.inheritAnimation;\r\n                        if (!childArmature.inheritAnimation) {\r\n                            var actions = armatureDisplayData.actions.length > 0 ? armatureDisplayData.actions : childArmature.armatureData.defaultActions;\r\n                            if (actions.length > 0) {\r\n                                for (var _i = 0, actions_6 = actions; _i < actions_6.length; _i++) {\r\n                                    var action = actions_6[_i];\r\n                                    var eventObject = dragonBones.BaseObject.borrowObject(dragonBones.EventObject);\r\n                                    dragonBones.EventObject.actionDataToInstance(action, eventObject, slot.armature);\r\n                                    eventObject.slot = slot;\r\n                                    slot.armature._bufferAction(eventObject, false);\r\n                                }\r\n                            }\r\n                            else {\r\n                                childArmature.animation.play();\r\n                            }\r\n                        }\r\n                        armatureDisplayData.armature = childArmature.armatureData; // \r\n                    }\r\n                    display = childArmature;\r\n                    break;\r\n                }\r\n                case 3 /* BoundingBox */:\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            return display;\r\n        };\r\n        /**\r\n         * - Parse the raw data to a DragonBonesData instance and cache it to the factory.\r\n         * @param rawData - The raw data.\r\n         * @param name - Specify a cache name for the instance so that the instance can be obtained through this name. (If not set, use the instance name instead)\r\n         * @param scale - Specify a scaling value for all armatures. (Default: 1.0)\r\n         * @returns DragonBonesData instance\r\n         * @see #getDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将原始数据解析为 DragonBonesData 实例，并缓存到工厂中。\r\n         * @param rawData - 原始数据。\r\n         * @param name - 为该实例指定一个缓存名称，以便可以通过此名称获取该实例。 （如果未设置，则使用该实例中的名称）\r\n         * @param scale - 为所有的骨架指定一个缩放值。 （默认: 1.0）\r\n         * @returns DragonBonesData 实例\r\n         * @see #getDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.parseDragonBonesData = function (rawData, name, scale) {\r\n            if (name === void 0) { name = null; }\r\n            if (scale === void 0) { scale = 1.0; }\r\n            var dataParser = rawData instanceof ArrayBuffer ? BaseFactory._binaryParser : this._dataParser;\r\n            var dragonBonesData = dataParser.parseDragonBonesData(rawData, scale);\r\n            while (true) {\r\n                var textureAtlasData = this._buildTextureAtlasData(null, null);\r\n                if (dataParser.parseTextureAtlasData(null, textureAtlasData, scale)) {\r\n                    this.addTextureAtlasData(textureAtlasData, name);\r\n                }\r\n                else {\r\n                    textureAtlasData.returnToPool();\r\n                    break;\r\n                }\r\n            }\r\n            if (dragonBonesData !== null) {\r\n                this.addDragonBonesData(dragonBonesData, name);\r\n            }\r\n            return dragonBonesData;\r\n        };\r\n        /**\r\n         * - Parse the raw texture atlas data and the texture atlas object to a TextureAtlasData instance and cache it to the factory.\r\n         * @param rawData - The raw texture atlas data.\r\n         * @param textureAtlas - The texture atlas object.\r\n         * @param name - Specify a cache name for the instance so that the instance can be obtained through this name. (If not set, use the instance name instead)\r\n         * @param scale - Specify a scaling value for the map set. (Default: 1.0)\r\n         * @returns TextureAtlasData instance\r\n         * @see #getTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将原始贴图集数据和贴图集对象解析为 TextureAtlasData 实例，并缓存到工厂中。\r\n         * @param rawData - 原始贴图集数据。\r\n         * @param textureAtlas - 贴图集对象。\r\n         * @param name - 为该实例指定一个缓存名称，以便可以通过此名称获取该实例。 （如果未设置，则使用该实例中的名称）\r\n         * @param scale - 为贴图集指定一个缩放值。 （默认: 1.0）\r\n         * @returns TextureAtlasData 实例\r\n         * @see #getTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.parseTextureAtlasData = function (rawData, textureAtlas, name, scale) {\r\n            if (name === void 0) { name = null; }\r\n            if (scale === void 0) { scale = 1.0; }\r\n            var textureAtlasData = this._buildTextureAtlasData(null, null);\r\n            this._dataParser.parseTextureAtlasData(rawData, textureAtlasData, scale);\r\n            this._buildTextureAtlasData(textureAtlasData, textureAtlas || null);\r\n            this.addTextureAtlasData(textureAtlasData, name);\r\n            return textureAtlasData;\r\n        };\r\n        /**\r\n         * - Update texture atlases.\r\n         * @param textureAtlases - The texture atlas objects.\r\n         * @param name - The texture atlas name.\r\n         * @version DragonBones 5.7\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 更新贴图集对象。\r\n         * @param textureAtlases - 多个贴图集对象。\r\n         * @param name - 贴图集名称。\r\n         * @version DragonBones 5.7\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.updateTextureAtlases = function (textureAtlases, name) {\r\n            var textureAtlasDatas = this.getTextureAtlasData(name);\r\n            if (textureAtlasDatas !== null) {\r\n                for (var i = 0, l = textureAtlasDatas.length; i < l; ++i) {\r\n                    if (i < textureAtlases.length) {\r\n                        this._buildTextureAtlasData(textureAtlasDatas[i], textureAtlases[i]);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        /**\r\n         * - Get a specific DragonBonesData instance.\r\n         * @param name - The DragonBonesData instance cache name.\r\n         * @returns DragonBonesData instance\r\n         * @see #parseDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的 DragonBonesData 实例。\r\n         * @param name - DragonBonesData 实例的缓存名称。\r\n         * @returns DragonBonesData 实例\r\n         * @see #parseDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.getDragonBonesData = function (name) {\r\n            return (name in this._dragonBonesDataMap) ? this._dragonBonesDataMap[name] : null;\r\n        };\r\n        /**\r\n         * - Cache a DragonBonesData instance to the factory.\r\n         * @param data - The DragonBonesData instance.\r\n         * @param name - Specify a cache name for the instance so that the instance can be obtained through this name. (if not set, use the instance name instead)\r\n         * @see #parseDragonBonesData()\r\n         * @see #getDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将 DragonBonesData 实例缓存到工厂中。\r\n         * @param data - DragonBonesData 实例。\r\n         * @param name - 为该实例指定一个缓存名称，以便可以通过此名称获取该实例。 （如果未设置，则使用该实例中的名称）\r\n         * @see #parseDragonBonesData()\r\n         * @see #getDragonBonesData()\r\n         * @see #removeDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.addDragonBonesData = function (data, name) {\r\n            if (name === void 0) { name = null; }\r\n            name = name !== null ? name : data.name;\r\n            if (name in this._dragonBonesDataMap) {\r\n                if (this._dragonBonesDataMap[name] === data) {\r\n                    return;\r\n                }\r\n                console.warn("Can not add same name data: " + name);\r\n                return;\r\n            }\r\n            this._dragonBonesDataMap[name] = data;\r\n        };\r\n        /**\r\n         * - Remove a DragonBonesData instance.\r\n         * @param name - The DragonBonesData instance cache name.\r\n         * @param disposeData - Whether to dispose data. (Default: true)\r\n         * @see #parseDragonBonesData()\r\n         * @see #getDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 移除 DragonBonesData 实例。\r\n         * @param name - DragonBonesData 实例缓存名称。\r\n         * @param disposeData - 是否释放数据。 （默认: true）\r\n         * @see #parseDragonBonesData()\r\n         * @see #getDragonBonesData()\r\n         * @see #addDragonBonesData()\r\n         * @see dragonBones.DragonBonesData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.removeDragonBonesData = function (name, disposeData) {\r\n            if (disposeData === void 0) { disposeData = true; }\r\n            if (name in this._dragonBonesDataMap) {\r\n                if (disposeData) {\r\n                    this._dragonBones.bufferObject(this._dragonBonesDataMap[name]);\r\n                }\r\n                delete this._dragonBonesDataMap[name];\r\n            }\r\n        };\r\n        /**\r\n         * - Get a list of specific TextureAtlasData instances.\r\n         * @param name - The TextureAtlasData cahce name.\r\n         * @see #parseTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的 TextureAtlasData 实例列表。\r\n         * @param name - TextureAtlasData 实例缓存名称。\r\n         * @see #parseTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.getTextureAtlasData = function (name) {\r\n            return (name in this._textureAtlasDataMap) ? this._textureAtlasDataMap[name] : null;\r\n        };\r\n        /**\r\n         * - Cache a TextureAtlasData instance to the factory.\r\n         * @param data - The TextureAtlasData instance.\r\n         * @param name - Specify a cache name for the instance so that the instance can be obtained through this name. (if not set, use the instance name instead)\r\n         * @see #parseTextureAtlasData()\r\n         * @see #getTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将 TextureAtlasData 实例缓存到工厂中。\r\n         * @param data - TextureAtlasData 实例。\r\n         * @param name - 为该实例指定一个缓存名称，以便可以通过此名称获取该实例。 （如果未设置，则使用该实例中的名称）\r\n         * @see #parseTextureAtlasData()\r\n         * @see #getTextureAtlasData()\r\n         * @see #removeTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.addTextureAtlasData = function (data, name) {\r\n            if (name === void 0) { name = null; }\r\n            name = name !== null ? name : data.name;\r\n            var textureAtlasList = (name in this._textureAtlasDataMap) ? this._textureAtlasDataMap[name] : (this._textureAtlasDataMap[name] = []);\r\n            if (textureAtlasList.indexOf(data) < 0) {\r\n                textureAtlasList.push(data);\r\n            }\r\n        };\r\n        /**\r\n         * - Remove a TextureAtlasData instance.\r\n         * @param name - The TextureAtlasData instance cache name.\r\n         * @param disposeData - Whether to dispose data.\r\n         * @see #parseTextureAtlasData()\r\n         * @see #getTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 移除 TextureAtlasData 实例。\r\n         * @param name - TextureAtlasData 实例的缓存名称。\r\n         * @param disposeData - 是否释放数据。\r\n         * @see #parseTextureAtlasData()\r\n         * @see #getTextureAtlasData()\r\n         * @see #addTextureAtlasData()\r\n         * @see dragonBones.TextureAtlasData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.removeTextureAtlasData = function (name, disposeData) {\r\n            if (disposeData === void 0) { disposeData = true; }\r\n            if (name in this._textureAtlasDataMap) {\r\n                var textureAtlasDataList = this._textureAtlasDataMap[name];\r\n                if (disposeData) {\r\n                    for (var _i = 0, textureAtlasDataList_1 = textureAtlasDataList; _i < textureAtlasDataList_1.length; _i++) {\r\n                        var textureAtlasData = textureAtlasDataList_1[_i];\r\n                        this._dragonBones.bufferObject(textureAtlasData);\r\n                    }\r\n                }\r\n                delete this._textureAtlasDataMap[name];\r\n            }\r\n        };\r\n        /**\r\n         * - Get a specific armature data.\r\n         * @param name - The armature data name.\r\n         * @param dragonBonesName - The cached name for DragonbonesData instance.\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 5.1\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 获取特定的骨架数据。\r\n         * @param name - 骨架数据名称。\r\n         * @param dragonBonesName - DragonBonesData 实例的缓存名称。\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 5.1\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.getArmatureData = function (name, dragonBonesName) {\r\n            if (dragonBonesName === void 0) { dragonBonesName = ""; }\r\n            var dataPackage = new BuildArmaturePackage();\r\n            if (!this._fillBuildArmaturePackage(dataPackage, dragonBonesName, name, "", "")) {\r\n                return null;\r\n            }\r\n            return dataPackage.armature;\r\n        };\r\n        /**\r\n         * - Clear all cached DragonBonesData instances and TextureAtlasData instances.\r\n         * @param disposeData - Whether to dispose data.\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 清除缓存的所有 DragonBonesData 实例和 TextureAtlasData 实例。\r\n         * @param disposeData - 是否释放数据。\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.clear = function (disposeData) {\r\n            if (disposeData === void 0) { disposeData = true; }\r\n            for (var k in this._dragonBonesDataMap) {\r\n                if (disposeData) {\r\n                    this._dragonBones.bufferObject(this._dragonBonesDataMap[k]);\r\n                }\r\n                delete this._dragonBonesDataMap[k];\r\n            }\r\n            for (var k in this._textureAtlasDataMap) {\r\n                if (disposeData) {\r\n                    var textureAtlasDataList = this._textureAtlasDataMap[k];\r\n                    for (var _i = 0, textureAtlasDataList_2 = textureAtlasDataList; _i < textureAtlasDataList_2.length; _i++) {\r\n                        var textureAtlasData = textureAtlasDataList_2[_i];\r\n                        this._dragonBones.bufferObject(textureAtlasData);\r\n                    }\r\n                }\r\n                delete this._textureAtlasDataMap[k];\r\n            }\r\n        };\r\n        /**\r\n         * - Create a armature from cached DragonBonesData instances and TextureAtlasData instances.\r\n         * Note that when the created armature that is no longer in use, you need to explicitly dispose {@link #dragonBones.Armature#dispose()}.\r\n         * @param armatureName - The armature data name.\r\n         * @param dragonBonesName - The cached name of the DragonBonesData instance. (If not set, all DragonBonesData instances are retrieved, and when multiple DragonBonesData instances contain a the same name armature data, it may not be possible to accurately create a specific armature)\r\n         * @param skinName - The skin name, you can set a different ArmatureData name to share it\'s skin data. (If not set, use the default skin data)\r\n         * @returns The armature.\r\n         * @example\r\n         * <pre>\r\n         *     let armature = factory.buildArmature("armatureName", "dragonBonesName");\r\n         *     armature.clock = factory.clock;\r\n         * </pre>\r\n         * @see dragonBones.DragonBonesData\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 3.0\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 通过缓存的 DragonBonesData 实例和 TextureAtlasData 实例创建一个骨架。\r\n         * 注意，创建的骨架不再使用时，需要显式释放 {@link #dragonBones.Armature#dispose()}。\r\n         * @param armatureName - 骨架数据名称。\r\n         * @param dragonBonesName - DragonBonesData 实例的缓存名称。 （如果未设置，将检索所有的 DragonBonesData 实例，当多个 DragonBonesData 实例中包含同名的骨架数据时，可能无法准确的创建出特定的骨架）\r\n         * @param skinName - 皮肤名称，可以设置一个其他骨架数据名称来共享其皮肤数据。（如果未设置，则使用默认的皮肤数据）\r\n         * @returns 骨架。\r\n         * @example\r\n         * <pre>\r\n         *     let armature = factory.buildArmature("armatureName", "dragonBonesName");\r\n         *     armature.clock = factory.clock;\r\n         * </pre>\r\n         * @see dragonBones.DragonBonesData\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 3.0\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.buildArmature = function (armatureName, dragonBonesName, skinName, textureAtlasName) {\r\n            if (dragonBonesName === void 0) { dragonBonesName = ""; }\r\n            if (skinName === void 0) { skinName = ""; }\r\n            if (textureAtlasName === void 0) { textureAtlasName = ""; }\r\n            var dataPackage = new BuildArmaturePackage();\r\n            if (!this._fillBuildArmaturePackage(dataPackage, dragonBonesName || "", armatureName, skinName || "", textureAtlasName || "")) {\r\n                console.warn("No armature data: " + armatureName + ", " + (dragonBonesName !== null ? dragonBonesName : ""));\r\n                return null;\r\n            }\r\n            var armature = this._buildArmature(dataPackage);\r\n            this._buildBones(dataPackage, armature);\r\n            this._buildSlots(dataPackage, armature);\r\n            this._buildConstraints(dataPackage, armature);\r\n            armature.invalidUpdate(null, true);\r\n            armature.advanceTime(0.0); // Update armature pose.\r\n            return armature;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        BaseFactory.prototype.replaceDisplay = function (slot, displayData, displayIndex) {\r\n            if (displayIndex === void 0) { displayIndex = -1; }\r\n            if (displayIndex < 0) {\r\n                displayIndex = slot.displayIndex;\r\n            }\r\n            if (displayIndex < 0) {\r\n                displayIndex = 0;\r\n            }\r\n            slot.replaceDisplayData(displayData, displayIndex);\r\n            if (displayData !== null) {\r\n                var display = this._getSlotDisplay(null, displayData, slot);\r\n                if (displayData.type === 0 /* Image */) {\r\n                    var rawDisplayData = slot.getDisplayFrameAt(displayIndex).rawDisplayData;\r\n                    if (rawDisplayData !== null &&\r\n                        rawDisplayData.type === 2 /* Mesh */) {\r\n                        display = slot.meshDisplay;\r\n                    }\r\n                }\r\n                slot.replaceDisplay(display, displayIndex);\r\n            }\r\n            else {\r\n                slot.replaceDisplay(null, displayIndex);\r\n            }\r\n        };\r\n        /**\r\n         * - Replaces the current display data for a particular slot with a specific display data.\r\n         * Specify display data with "dragonBonesName/armatureName/slotName/displayName".\r\n         * @param dragonBonesName - The DragonBonesData instance cache name.\r\n         * @param armatureName - The armature data name.\r\n         * @param slotName - The slot data name.\r\n         * @param displayName - The display data name.\r\n         * @param slot - The slot.\r\n         * @param displayIndex - The index of the display data that is replaced. (If it is not set, replaces the current display data)\r\n         * @example\r\n         * <pre>\r\n         *     let slot = armature.getSlot("weapon");\r\n         *     factory.replaceSlotDisplay("dragonBonesName", "armatureName", "slotName", "displayName", slot);\r\n         * </pre>\r\n         * @version DragonBones 4.5\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 用特定的显示对象数据替换特定插槽当前的显示对象数据。\r\n         * 用 "dragonBonesName/armatureName/slotName/displayName" 指定显示对象数据。\r\n         * @param dragonBonesName - DragonBonesData 实例的缓存名称。\r\n         * @param armatureName - 骨架数据名称。\r\n         * @param slotName - 插槽数据名称。\r\n         * @param displayName - 显示对象数据名称。\r\n         * @param slot - 插槽。\r\n         * @param displayIndex - 被替换的显示对象数据的索引。 （如果未设置，则替换当前的显示对象数据）\r\n         * @example\r\n         * <pre>\r\n         *     let slot = armature.getSlot("weapon");\r\n         *     factory.replaceSlotDisplay("dragonBonesName", "armatureName", "slotName", "displayName", slot);\r\n         * </pre>\r\n         * @version DragonBones 4.5\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.replaceSlotDisplay = function (dragonBonesName, armatureName, slotName, displayName, slot, displayIndex) {\r\n            if (displayIndex === void 0) { displayIndex = -1; }\r\n            var armatureData = this.getArmatureData(armatureName, dragonBonesName || "");\r\n            if (armatureData === null || armatureData.defaultSkin === null) {\r\n                return false;\r\n            }\r\n            var displayData = armatureData.defaultSkin.getDisplay(slotName, displayName);\r\n            this.replaceDisplay(slot, displayData, displayIndex);\r\n            return true;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        BaseFactory.prototype.replaceSlotDisplayList = function (dragonBonesName, armatureName, slotName, slot) {\r\n            var armatureData = this.getArmatureData(armatureName, dragonBonesName || "");\r\n            if (!armatureData || !armatureData.defaultSkin) {\r\n                return false;\r\n            }\r\n            var displayDatas = armatureData.defaultSkin.getDisplays(slotName);\r\n            if (!displayDatas) {\r\n                return false;\r\n            }\r\n            slot.displayFrameCount = displayDatas.length;\r\n            for (var i = 0, l = slot.displayFrameCount; i < l; ++i) {\r\n                var displayData = displayDatas[i];\r\n                this.replaceDisplay(slot, displayData, i);\r\n            }\r\n            return true;\r\n        };\r\n        /**\r\n         * - Share specific skin data with specific armature.\r\n         * @param armature - The armature.\r\n         * @param skin - The skin data.\r\n         * @param isOverride - Whether it completely override the original skin. (Default: false)\r\n         * @param exclude - A list of slot names that do not need to be replace.\r\n         * @example\r\n         * <pre>\r\n         *     let armatureA = factory.buildArmature("armatureA", "dragonBonesA");\r\n         *     let armatureDataB = factory.getArmatureData("armatureB", "dragonBonesB");\r\n         *     if (armatureDataB && armatureDataB.defaultSkin) {\r\n         *     factory.replaceSkin(armatureA, armatureDataB.defaultSkin, false, ["arm_l", "weapon_l"]);\r\n         *     }\r\n         * </pre>\r\n         * @see dragonBones.Armature\r\n         * @see dragonBones.SkinData\r\n         * @version DragonBones 5.6\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 将特定的皮肤数据共享给特定的骨架使用。\r\n         * @param armature - 骨架。\r\n         * @param skin - 皮肤数据。\r\n         * @param isOverride - 是否完全覆盖原来的皮肤。 （默认: false）\r\n         * @param exclude - 不需要被替换的插槽名称列表。\r\n         * @example\r\n         * <pre>\r\n         *     let armatureA = factory.buildArmature("armatureA", "dragonBonesA");\r\n         *     let armatureDataB = factory.getArmatureData("armatureB", "dragonBonesB");\r\n         *     if (armatureDataB && armatureDataB.defaultSkin) {\r\n         *     factory.replaceSkin(armatureA, armatureDataB.defaultSkin, false, ["arm_l", "weapon_l"]);\r\n         *     }\r\n         * </pre>\r\n         * @see dragonBones.Armature\r\n         * @see dragonBones.SkinData\r\n         * @version DragonBones 5.6\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.replaceSkin = function (armature, skin, isOverride, exclude) {\r\n            if (isOverride === void 0) { isOverride = false; }\r\n            if (exclude === void 0) { exclude = null; }\r\n            var success = false;\r\n            var defaultSkin = skin.parent.defaultSkin;\r\n            for (var _i = 0, _a = armature.getSlots(); _i < _a.length; _i++) {\r\n                var slot = _a[_i];\r\n                if (exclude !== null && exclude.indexOf(slot.name) >= 0) {\r\n                    continue;\r\n                }\r\n                var displayDatas = skin.getDisplays(slot.name);\r\n                if (displayDatas === null) {\r\n                    if (defaultSkin !== null && skin !== defaultSkin) {\r\n                        displayDatas = defaultSkin.getDisplays(slot.name);\r\n                    }\r\n                    if (displayDatas === null) {\r\n                        if (isOverride) {\r\n                            slot.displayFrameCount = 0;\r\n                        }\r\n                        continue;\r\n                    }\r\n                }\r\n                slot.displayFrameCount = displayDatas.length;\r\n                for (var i = 0, l = slot.displayFrameCount; i < l; ++i) {\r\n                    var displayData = displayDatas[i];\r\n                    slot.replaceRawDisplayData(displayData, i);\r\n                    if (displayData !== null) {\r\n                        slot.replaceDisplay(this._getSlotDisplay(null, displayData, slot), i);\r\n                    }\r\n                    else {\r\n                        slot.replaceDisplay(null, i);\r\n                    }\r\n                }\r\n                success = true;\r\n            }\r\n            return success;\r\n        };\r\n        /**\r\n         * - Replaces the existing animation data for a specific armature with the animation data for the specific armature data.\r\n         * This enables you to make a armature template so that other armature without animations can share it\'s animations.\r\n         * @param armature - The armtaure.\r\n         * @param armatureData - The armature data.\r\n         * @param isOverride - Whether to completely overwrite the original animation. (Default: false)\r\n         * @example\r\n         * <pre>\r\n         *     let armatureA = factory.buildArmature("armatureA", "dragonBonesA");\r\n         *     let armatureDataB = factory.getArmatureData("armatureB", "dragonBonesB");\r\n         *     if (armatureDataB) {\r\n         *     factory.replaceAnimation(armatureA, armatureDataB);\r\n         *     }\r\n         * </pre>\r\n         * @see dragonBones.Armature\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 5.6\r\n         * @language en_US\r\n         */\r\n        /**\r\n         * - 用特定骨架数据的动画数据替换特定骨架现有的动画数据。\r\n         * 这样就能实现制作一个骨架动画模板，让其他没有制作动画的骨架共享该动画。\r\n         * @param armature - 骨架。\r\n         * @param armatureData - 骨架数据。\r\n         * @param isOverride - 是否完全覆盖原来的动画。（默认: false）\r\n         * @example\r\n         * <pre>\r\n         *     let armatureA = factory.buildArmature("armatureA", "dragonBonesA");\r\n         *     let armatureDataB = factory.getArmatureData("armatureB", "dragonBonesB");\r\n         *     if (armatureDataB) {\r\n         *     factory.replaceAnimation(armatureA, armatureDataB);\r\n         *     }\r\n         * </pre>\r\n         * @see dragonBones.Armature\r\n         * @see dragonBones.ArmatureData\r\n         * @version DragonBones 5.6\r\n         * @language zh_CN\r\n         */\r\n        BaseFactory.prototype.replaceAnimation = function (armature, armatureData, isOverride) {\r\n            if (isOverride === void 0) { isOverride = true; }\r\n            var skinData = armatureData.defaultSkin;\r\n            if (skinData === null) {\r\n                return false;\r\n            }\r\n            if (isOverride) {\r\n                armature.animation.animations = armatureData.animations;\r\n            }\r\n            else {\r\n                var rawAnimations = armature.animation.animations;\r\n                var animations = {};\r\n                for (var k in rawAnimations) {\r\n                    animations[k] = rawAnimations[k];\r\n                }\r\n                for (var k in armatureData.animations) {\r\n                    animations[k] = armatureData.animations[k];\r\n                }\r\n                armature.animation.animations = animations;\r\n            }\r\n            for (var _i = 0, _a = armature.getSlots(); _i < _a.length; _i++) {\r\n                var slot = _a[_i];\r\n                var index = 0;\r\n                for (var _b = 0, _c = slot.displayList; _b < _c.length; _b++) {\r\n                    var display = _c[_b];\r\n                    if (display instanceof dragonBones.Armature) {\r\n                        var displayDatas = skinData.getDisplays(slot.name);\r\n                        if (displayDatas !== null && index < displayDatas.length) {\r\n                            var displayData = displayDatas[index];\r\n                            if (displayData !== null && displayData.type === 1 /* Armature */) {\r\n                                var childArmatureData = this.getArmatureData(displayData.path, displayData.parent.parent.parent.name);\r\n                                if (childArmatureData) {\r\n                                    this.replaceAnimation(display, childArmatureData, isOverride);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    index++;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        BaseFactory.prototype.getAllDragonBonesData = function () {\r\n            return this._dragonBonesDataMap;\r\n        };\r\n        /**\r\n         * @private\r\n         */\r\n        BaseFactory.prototype.getAllTextureAtlasData = function () {\r\n            return this._textureAtlasDataMap;\r\n        };\r\n        Object.defineProperty(BaseFactory.prototype, "clock", {\r\n            /**\r\n             * - An Worldclock instance updated by engine.\r\n             * @version DragonBones 5.7\r\n             * @language en_US\r\n             */\r\n            /**\r\n             * - 由引擎驱动的 WorldClock 实例。\r\n             * @version DragonBones 5.7\r\n             * @language zh_CN\r\n             */\r\n            get: function () {\r\n                return this._dragonBones.clock;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        Object.defineProperty(BaseFactory.prototype, "dragonBones", {\r\n            /**\r\n             * @private\r\n             */\r\n            get: function () {\r\n                return this._dragonBones;\r\n            },\r\n            enumerable: true,\r\n            configurable: true\r\n        });\r\n        BaseFactory._objectParser = null;\r\n        BaseFactory._binaryParser = null;\r\n        return BaseFactory;\r\n    }());\r\n    dragonBones.BaseFactory = BaseFactory;\r\n    /**\r\n     * @private\r\n     */\r\n    var BuildArmaturePackage = /** @class */ (function () {\r\n        function BuildArmaturePackage() {\r\n            this.dataName = "";\r\n            this.textureAtlasName = "";\r\n            this.skin = null;\r\n        }\r\n        return BuildArmaturePackage;\r\n    }());\r\n    dragonBones.BuildArmaturePackage = BuildArmaturePackage;\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var util;\r\n        (function (util) {\r\n            var EventDispatcher = /** @class */ (function (_super) {\r\n                __extends(EventDispatcher, _super);\r\n                function EventDispatcher() {\r\n                    return _super !== null && _super.apply(this, arguments) || this;\r\n                }\r\n                EventDispatcher.prototype.hasDBEventListener = function (type) {\r\n                    return this.listenerCount(type) > 0;\r\n                };\r\n                EventDispatcher.prototype.dispatchDBEvent = function (type, eventObject) {\r\n                    this.emit(type, eventObject);\r\n                };\r\n                EventDispatcher.prototype.addDBEventListener = function (type, listener, thisObject) {\r\n                    this.on(type, listener, thisObject);\r\n                };\r\n                EventDispatcher.prototype.removeDBEventListener = function (type, listener, thisObject) {\r\n                    this.off(type, listener, thisObject);\r\n                };\r\n                return EventDispatcher;\r\n            }(Phaser.Events.EventEmitter));\r\n            util.EventDispatcher = EventDispatcher;\r\n        })(util = phaser.util || (phaser.util = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var util;\r\n        (function (util) {\r\n            util.Skew = {\r\n                getSkewX: function () {\r\n                    return this._skewX || 0;\r\n                },\r\n                setSkewX: function (v) {\r\n                    this._skewX = v;\r\n                },\r\n                getSkewY: function () {\r\n                    return this._skewY || 0;\r\n                },\r\n                setSkewY: function (v) {\r\n                    this._skewY = v;\r\n                },\r\n                setSkew: function (sx, sy) {\r\n                    sy = sy === void 0 ? sx : sy;\r\n                    this._skewX = sx;\r\n                    this._skewY = sy;\r\n                }\r\n            };\r\n            util.extendSkew = function (clazz) {\r\n                Object.defineProperty(clazz.prototype, "skewX", {\r\n                    get: util.Skew.getSkewX,\r\n                    set: util.Skew.setSkewX,\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                Object.defineProperty(clazz.prototype, "skewY", {\r\n                    get: util.Skew.getSkewY,\r\n                    set: util.Skew.setSkewY,\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                clazz.prototype.setSkew = util.Skew.setSkew;\r\n            };\r\n        })(util = phaser.util || (phaser.util = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var util;\r\n        (function (util) {\r\n            var TransformMatrix = /** @class */ (function (_super) {\r\n                __extends(TransformMatrix, _super);\r\n                function TransformMatrix(a, b, c, d, tx, ty) {\r\n                    var _this = _super.call(this, a, b, c, d, tx, ty) || this;\r\n                    _this.decomposedMatrix.skewX = 0;\r\n                    _this.decomposedMatrix.skewY = 0;\r\n                    return _this;\r\n                }\r\n                TransformMatrix.prototype.decomposeMatrix = function () {\r\n                    // sort out rotation / skew..\r\n                    var a = this.a;\r\n                    var b = this.b;\r\n                    var c = this.c;\r\n                    var d = this.d;\r\n                    var skewX = -Math.atan2(-c, d);\r\n                    var skewY = Math.atan2(b, a);\r\n                    var delta = Math.abs(skewX + skewY);\r\n                    if (delta < 0.00001 || Math.abs(Phaser.Math.PI2 - delta) < 0.00001) {\r\n                        this.decomposedMatrix.rotation = skewY;\r\n                        if (a < 0 && d >= 0)\r\n                            this.decomposedMatrix.rotation += (this.decomposedMatrix.rotation <= 0) ? Math.PI : -Math.PI;\r\n                        this.decomposedMatrix.skewX = this.decomposedMatrix.skewY = 0;\r\n                    }\r\n                    else {\r\n                        this.decomposedMatrix.rotation = 0;\r\n                        this.decomposedMatrix.skewX = skewX;\r\n                        this.decomposedMatrix.skewY = skewY;\r\n                    }\r\n                    // next set scale\r\n                    this.decomposedMatrix.scaleX = Math.sqrt((a * a) + (b * b));\r\n                    this.decomposedMatrix.scaleY = Math.sqrt((c * c) + (d * d));\r\n                    // next set position\r\n                    this.decomposedMatrix.translateX = this.tx;\r\n                    this.decomposedMatrix.translateY = this.ty;\r\n                    return this.decomposedMatrix;\r\n                };\r\n                TransformMatrix.prototype.applyITRSC = function (x, y, rotation, scaleX, scaleY, skewX, skewY) {\r\n                    this.a = Math.cos(rotation - skewY) * scaleX;\r\n                    this.b = Math.sin(rotation - skewY) * scaleX;\r\n                    this.c = -Math.sin(rotation + skewX) * scaleY;\r\n                    this.d = Math.cos(rotation + skewX) * scaleY;\r\n                    this.tx = x;\r\n                    this.ty = y;\r\n                    return this;\r\n                };\r\n                Object.defineProperty(TransformMatrix.prototype, "skewX", {\r\n                    get: function () {\r\n                        return -Math.atan2(-this.c, this.d);\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                Object.defineProperty(TransformMatrix.prototype, "skewY", {\r\n                    get: function () {\r\n                        return Math.atan2(this.b, this.a);\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                return TransformMatrix;\r\n            }(Phaser.GameObjects.Components.TransformMatrix));\r\n            util.TransformMatrix = TransformMatrix;\r\n        })(util = phaser.util || (phaser.util = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            // this class will be refactored due to official Container will be removed soon.\r\n            var DisplayContainer = /** @class */ (function (_super) {\r\n                __extends(DisplayContainer, _super);\r\n                function DisplayContainer(scene, x, y, children) {\r\n                    var _this = _super.call(this, scene, x, y, children) || this;\r\n                    _this._skewX = 0;\r\n                    _this._skewY = 0;\r\n                    _this.tempTransformMatrix = new phaser.util.TransformMatrix();\r\n                    return _this;\r\n                }\r\n                DisplayContainer.prototype.pointToContainer = function (source, output) {\r\n                    if (output === undefined)\r\n                        output = new Phaser.Math.Vector2();\r\n                    if (this.parentContainer)\r\n                        return this.parentContainer.pointToContainer(source, output);\r\n                    var tempMatrix = this.tempTransformMatrix;\r\n                    //  No need to loadIdentity because applyITRSC overwrites every value anyway\r\n                    tempMatrix.applyITRSC(this.x, this.y, this.rotation, this.scaleX, this.scaleY, this._skewX, this._skewY);\r\n                    tempMatrix.invert();\r\n                    tempMatrix.transformPoint(source.x, source.y, output);\r\n                    return output;\r\n                };\r\n                Object.defineProperty(DisplayContainer.prototype, "skewX", {\r\n                    get: function () {\r\n                        return this._skewX;\r\n                    },\r\n                    set: function (v) {\r\n                        this._skewX = v;\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                Object.defineProperty(DisplayContainer.prototype, "skewY", {\r\n                    get: function () {\r\n                        return this._skewY;\r\n                    },\r\n                    set: function (v) {\r\n                        this._skewY = v;\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                DisplayContainer.prototype.setSkew = function (sx, sy) {\r\n                    sy = sy === void 0 ? sx : sy;\r\n                    this.skewX = sx;\r\n                    this.skewY = sy;\r\n                    return this;\r\n                };\r\n                return DisplayContainer;\r\n            }(Phaser.GameObjects.Container));\r\n            display.DisplayContainer = DisplayContainer;\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            var ArmatureDisplay = /** @class */ (function (_super) {\r\n                __extends(ArmatureDisplay, _super);\r\n                function ArmatureDisplay(scene) {\r\n                    var _this = _super.call(this, scene) || this;\r\n                    _this.debugDraw = false;\r\n                    return _this;\r\n                }\r\n                ArmatureDisplay.prototype.dbInit = function (armature) {\r\n                    this._armature = armature;\r\n                };\r\n                ArmatureDisplay.prototype.dbClear = function () {\r\n                    this.removeAllListeners();\r\n                    if (this._armature)\r\n                        this._armature.dispose();\r\n                    this._armature = null;\r\n                };\r\n                ArmatureDisplay.prototype.dbUpdate = function () {\r\n                    // TODO: draw debug graphics\r\n                    if (this.debugDraw) {\r\n                    }\r\n                };\r\n                ArmatureDisplay.prototype.dispose = function (disposeProxy) {\r\n                    this.dbClear();\r\n                    if (disposeProxy === true)\r\n                        _super.prototype.destroy.call(this);\r\n                };\r\n                ArmatureDisplay.prototype.destroy = function () {\r\n                    this.dispose(true);\r\n                };\r\n                ArmatureDisplay.prototype.dispatchDBEvent = function (type, eventObject) {\r\n                    this.emit(type, eventObject);\r\n                };\r\n                ArmatureDisplay.prototype.hasDBEventListener = function (type) {\r\n                    return this.listenerCount(type) > 0;\r\n                };\r\n                ArmatureDisplay.prototype.addDBEventListener = function (type, listener, scope) {\r\n                    this.on(type, listener, scope);\r\n                };\r\n                ArmatureDisplay.prototype.removeDBEventListener = function (type, listener, scope) {\r\n                    this.off(type, listener, scope);\r\n                };\r\n                Object.defineProperty(ArmatureDisplay.prototype, "armature", {\r\n                    get: function () {\r\n                        return this._armature;\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                Object.defineProperty(ArmatureDisplay.prototype, "animation", {\r\n                    get: function () {\r\n                        return this._armature.animation;\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                return ArmatureDisplay;\r\n            }(display.DisplayContainer));\r\n            display.ArmatureDisplay = ArmatureDisplay;\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            var SlotImage = /** @class */ (function (_super) {\r\n                __extends(SlotImage, _super);\r\n                function SlotImage(scene, x, y, texture, frame) {\r\n                    var _this = _super.call(this, scene, x, y, texture, frame) || this;\r\n                    _this.setPipeline("PhaserTextureTintPipeline"); // use customized pipeline\r\n                    return _this;\r\n                }\r\n                return SlotImage;\r\n            }(Phaser.GameObjects.Image));\r\n            display.SlotImage = SlotImage;\r\n            phaser.util.extendSkew(SlotImage); // skew mixin\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            var SlotSprite = /** @class */ (function (_super) {\r\n                __extends(SlotSprite, _super);\r\n                function SlotSprite(scene, x, y, texture, frame) {\r\n                    var _this = _super.call(this, scene, x, y, texture, frame) || this;\r\n                    _this.setPipeline("PhaserTextureTintPipeline"); // use customized pipeline\r\n                    return _this;\r\n                }\r\n                return SlotSprite;\r\n            }(Phaser.GameObjects.Sprite));\r\n            display.SlotSprite = SlotSprite;\r\n            phaser.util.extendSkew(SlotSprite); // skew mixin\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            var Slot = /** @class */ (function (_super) {\r\n                __extends(Slot, _super);\r\n                function Slot() {\r\n                    return _super !== null && _super.apply(this, arguments) || this;\r\n                }\r\n                Slot.toString = function () {\r\n                    return "[class dragonBones.PhaserSlot]";\r\n                };\r\n                Slot.prototype._onClear = function () {\r\n                    _super.prototype._onClear.call(this);\r\n                    this._textureScale = 1.0;\r\n                    if (this._renderDisplay) {\r\n                        this._renderDisplay.destroy();\r\n                        this._renderDisplay = null;\r\n                    }\r\n                };\r\n                Slot.prototype._initDisplay = function (rawDisplay, isRetain) {\r\n                };\r\n                Slot.prototype._disposeDisplay = function (prevDisplay, isRelease) {\r\n                    // do nothing here, prevDisplay normally is an user customized GameObject set for this slot, so user need to destroy it manually.\r\n                };\r\n                Slot.prototype._onUpdateDisplay = function () {\r\n                    this._renderDisplay = this._display || this._rawDisplay;\r\n                };\r\n                // Phaser will soone remove the functionality of nested container, so here we need to look for an alternative solution for display.add(childArmatureDisplay)\r\n                Slot.prototype._addDisplay = function () {\r\n                    this.armature.display.add(this._renderDisplay);\r\n                };\r\n                Slot.prototype._replaceDisplay = function (prevDisplay) {\r\n                    if (!this._renderDisplay["setSkew"]) {\r\n                        console.warn("please call dragonBones.phaser.util.extendSkew to mix skew component into your display object,\\n                                and set its pipeline to \'PhaserTextureTintPipeline\' by calling \'setPiepline\' method, more detail please refer to the \'ReplaceSlotDisplay.ts\' example");\r\n                        return;\r\n                    }\r\n                    this.armature.display.replace(prevDisplay, this._renderDisplay);\r\n                    this._renderDisplay.parentContainer = this.armature.display;\r\n                };\r\n                Slot.prototype._removeDisplay = function () {\r\n                    // can\'t use this._armature.display.remove here, perphaps this._renderDisplay is a child of armature.\r\n                    this._renderDisplay.parentContainer.remove(this._renderDisplay);\r\n                };\r\n                Slot.prototype._updateZOrder = function () {\r\n                    if (this._renderDisplay.depth === this._zOrder)\r\n                        return;\r\n                    this._renderDisplay.setDepth(this._zOrder);\r\n                };\r\n                Slot.prototype._updateVisible = function () {\r\n                    this._renderDisplay.setVisible(this._parent.visible && this._visible);\r\n                };\r\n                Slot.prototype._updateBlendMode = function () {\r\n                    var mode = Phaser.BlendModes.NORMAL;\r\n                    switch (this._blendMode) {\r\n                        case 0 /* Normal */:\r\n                            mode = Phaser.BlendModes.NORMAL;\r\n                            break;\r\n                        case 1 /* Add */:\r\n                            mode = Phaser.BlendModes.ADD;\r\n                            break;\r\n                        case 3 /* Darken */:\r\n                            mode = Phaser.BlendModes.DARKEN;\r\n                            break;\r\n                        case 4 /* Difference */:\r\n                            mode = Phaser.BlendModes.DIFFERENCE;\r\n                            break;\r\n                        case 6 /* HardLight */:\r\n                            mode = Phaser.BlendModes.HARD_LIGHT;\r\n                            break;\r\n                        case 9 /* Lighten */:\r\n                            mode = Phaser.BlendModes.LIGHTEN;\r\n                            break;\r\n                        case 10 /* Multiply */:\r\n                            mode = Phaser.BlendModes.MULTIPLY;\r\n                            break;\r\n                        case 11 /* Overlay */:\r\n                            mode = Phaser.BlendModes.OVERLAY;\r\n                            break;\r\n                        case 12 /* Screen */:\r\n                            mode = Phaser.BlendModes.SCREEN;\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                    this._renderDisplay.setBlendMode(mode);\r\n                };\r\n                Slot.prototype._updateColor = function () {\r\n                    var c = this._colorTransform;\r\n                    var a = this._globalAlpha * c.alphaMultiplier + c.alphaOffset;\r\n                    this._renderDisplay.setAlpha(a);\r\n                    if (this._renderDisplay instanceof display.DisplayContainer)\r\n                        return;\r\n                    var r = 0xff * c.redMultiplier + c.redOffset;\r\n                    var g = 0xff * c.greenMultiplier + c.greenOffset;\r\n                    var b = 0xff * c.blueMultiplier + c.blueOffset;\r\n                    var rgb = (r << 16) | (g << 8) | b;\r\n                    this._renderDisplay.setTint(rgb);\r\n                };\r\n                Slot.prototype._updateFrame = function () {\r\n                    if (this._renderDisplay instanceof display.DisplayContainer)\r\n                        return;\r\n                    var currentTextureData = this._textureData;\r\n                    if (this._displayIndex >= 0 && this._display !== null && currentTextureData !== null) {\r\n                        var currentTextureAtlasData = currentTextureData.parent;\r\n                        if (this.armature.replacedTexture !== null) { // Update replaced texture atlas.\r\n                            if (this.armature._replaceTextureAtlasData === null) {\r\n                                currentTextureAtlasData = dragonBones.BaseObject.borrowObject(display.TextureAtlasData);\r\n                                currentTextureAtlasData.copyFrom(currentTextureData.parent);\r\n                                currentTextureAtlasData.renderTexture = this.armature.replacedTexture;\r\n                                this.armature._replaceTextureAtlasData = currentTextureAtlasData;\r\n                            }\r\n                            else\r\n                                currentTextureAtlasData = this.armature._replaceTextureAtlasData;\r\n                            currentTextureData = currentTextureAtlasData.getTexture(currentTextureData.name);\r\n                        }\r\n                        var frame = currentTextureData.renderTexture;\r\n                        if (frame !== null) {\r\n                            if (this._geometryData !== null) { // Mesh.\r\n                                // ignored, Phaser currently does not support mesh.indices\r\n                            }\r\n                            else { // normal texture.\r\n                                this._renderDisplay.texture = frame.texture;\r\n                                this._renderDisplay.frame = frame;\r\n                                this._renderDisplay.setDisplayOrigin(this._pivotX, this._pivotY);\r\n                                this._textureScale = currentTextureData.parent.scale * this.armature.armatureData.scale;\r\n                                this._renderDisplay.setScale(this._textureScale);\r\n                            }\r\n                            this._visibleDirty = true;\r\n                            return;\r\n                        }\r\n                    }\r\n                    else {\r\n                        this._renderDisplay.x = 0.0;\r\n                        this._renderDisplay.y = 0.0;\r\n                        this._renderDisplay.setTexture(undefined);\r\n                    }\r\n                };\r\n                Slot.prototype._updateMesh = function () {\r\n                    // ignored, Phaser currently does not support mesh.indices\r\n                };\r\n                Slot.prototype._updateTransform = function () {\r\n                    this.updateGlobalTransform();\r\n                    var transform = this.global;\r\n                    this._renderDisplay.x = transform.x; // No need to calcuate pivot offset manually here as Phaser.GameObjects.GameObject takes that into account already.\r\n                    this._renderDisplay.y = transform.y;\r\n                    this._renderDisplay.rotation = transform.rotation;\r\n                    this._renderDisplay["setSkew"](transform.skew, 0);\r\n                    this._renderDisplay.setScale(transform.scaleX * this._textureScale, transform.scaleY * this._textureScale);\r\n                };\r\n                Slot.prototype._identityTransform = function () {\r\n                    this._renderDisplay.setPosition();\r\n                    this._renderDisplay.setRotation();\r\n                    this._textureScale = 1.0;\r\n                    this._renderDisplay.setScale(this._textureScale);\r\n                    this._renderDisplay["setSkew"](0);\r\n                };\r\n                return Slot;\r\n            }(dragonBones.Slot));\r\n            display.Slot = Slot;\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var display;\r\n        (function (display) {\r\n            var TextureAtlasData = /** @class */ (function (_super) {\r\n                __extends(TextureAtlasData, _super);\r\n                function TextureAtlasData() {\r\n                    var _this = _super !== null && _super.apply(this, arguments) || this;\r\n                    _this._renderTexture = null;\r\n                    return _this;\r\n                }\r\n                TextureAtlasData.toString = function () {\r\n                    return "[class dragonBones.PhaserTextureAtlasData]";\r\n                };\r\n                TextureAtlasData.prototype._onClear = function () {\r\n                    _super.prototype._onClear.call(this);\r\n                    if (this._renderTexture !== null)\r\n                        this._renderTexture.destroy();\r\n                    this._renderTexture = null;\r\n                };\r\n                TextureAtlasData.prototype.createTexture = function () {\r\n                    return dragonBones.BaseObject.borrowObject(TextureData);\r\n                };\r\n                Object.defineProperty(TextureAtlasData.prototype, "renderTexture", {\r\n                    get: function () {\r\n                        return this._renderTexture;\r\n                    },\r\n                    // TODO: test set value runtime\r\n                    set: function (value) {\r\n                        if (!value || this._renderTexture === value)\r\n                            return;\r\n                        if (this._renderTexture)\r\n                            this._renderTexture.destroy();\r\n                        this._renderTexture = value;\r\n                        for (var k in this.textures) {\r\n                            var data = this.textures[k];\r\n                            var frame = this._renderTexture.add(k, 0, // all textures were added through `textures.addImage`, so their sourceIndex are all 0\r\n                            data.region.x, data.region.y, data.region.width, data.region.height);\r\n                            if (data.rotated) {\r\n                                frame.rotated = true;\r\n                                frame.updateUVsInverted();\r\n                            }\r\n                            data.renderTexture = frame;\r\n                        }\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                return TextureAtlasData;\r\n            }(dragonBones.TextureAtlasData));\r\n            display.TextureAtlasData = TextureAtlasData;\r\n            var TextureData = /** @class */ (function (_super) {\r\n                __extends(TextureData, _super);\r\n                function TextureData() {\r\n                    var _this = _super !== null && _super.apply(this, arguments) || this;\r\n                    _this.renderTexture = null; // Initial value.\r\n                    return _this;\r\n                }\r\n                TextureData.toString = function () {\r\n                    return "[class dragonBones.PhaserTextureData]";\r\n                };\r\n                TextureData.prototype._onClear = function () {\r\n                    _super.prototype._onClear.call(this);\r\n                    if (this.renderTexture !== null)\r\n                        this.renderTexture.destroy();\r\n                    this.renderTexture = null;\r\n                };\r\n                return TextureData;\r\n            }(dragonBones.TextureData));\r\n            display.TextureData = TextureData;\r\n        })(display = phaser.display || (phaser.display = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var pipeline;\r\n        (function (pipeline) {\r\n            var TextureTintPipeline = /** @class */ (function (_super) {\r\n                __extends(TextureTintPipeline, _super);\r\n                function TextureTintPipeline(config) {\r\n                    var _this = _super.call(this, config) || this;\r\n                    _this._tempMatrix1 = new phaser.util.TransformMatrix();\r\n                    _this._tempMatrix2 = new phaser.util.TransformMatrix();\r\n                    _this._tempMatrix3 = new phaser.util.TransformMatrix();\r\n                    return _this;\r\n                }\r\n                TextureTintPipeline.prototype.batchSprite = function (sprite, camera, parentTransformMatrix) {\r\n                    this.renderer.setPipeline(this);\r\n                    var camMatrix = this._tempMatrix1;\r\n                    var spriteMatrix = this._tempMatrix2;\r\n                    var calcMatrix = this._tempMatrix3;\r\n                    var frame = sprite.frame;\r\n                    var texture = frame.glTexture;\r\n                    var u0 = frame.u0;\r\n                    var v0 = frame.v0;\r\n                    var u1 = frame.u1;\r\n                    var v1 = frame.v1;\r\n                    var frameX = frame.x;\r\n                    var frameY = frame.y;\r\n                    var frameWidth = frame.width;\r\n                    var frameHeight = frame.height;\r\n                    var x = -sprite.displayOriginX + frameX;\r\n                    var y = -sprite.displayOriginY + frameY;\r\n                    if (sprite.isCropped) {\r\n                        var crop = sprite["_crop"];\r\n                        if (crop.flipX !== sprite.flipX || crop.flipY !== sprite.flipY)\r\n                            frame.updateCropUVs(crop, sprite.flipX, sprite.flipY);\r\n                        u0 = crop.u0;\r\n                        v0 = crop.v0;\r\n                        u1 = crop.u1;\r\n                        v1 = crop.v1;\r\n                        frameWidth = crop.width;\r\n                        frameHeight = crop.height;\r\n                        frameX = crop.x;\r\n                        frameY = crop.y;\r\n                        x = -sprite.displayOriginX + frameX;\r\n                        y = -sprite.displayOriginY + frameY;\r\n                    }\r\n                    if (sprite.flipX) {\r\n                        x += frameWidth;\r\n                        frameWidth *= -1;\r\n                    }\r\n                    if (sprite.flipY) {\r\n                        y += frameHeight;\r\n                        frameHeight *= -1;\r\n                    }\r\n                    var xw = x + frameWidth;\r\n                    var yh = y + frameHeight;\r\n                    spriteMatrix.applyITRSC(sprite.x, sprite.y, sprite.rotation, sprite.scaleX, sprite.scaleY, sprite["skewX"] || 0, sprite["skewY"] || 0);\r\n                    camMatrix.copyFrom(camera["matrix"]);\r\n                    if (parentTransformMatrix) {\r\n                        //  Multiply the camera by the parent matrix\r\n                        camMatrix.multiplyWithOffset(parentTransformMatrix, -camera.scrollX * sprite.scrollFactorX, -camera.scrollY * sprite.scrollFactorY);\r\n                        //  Undo the camera scroll\r\n                        spriteMatrix.e = sprite.x;\r\n                        spriteMatrix.f = sprite.y;\r\n                        //  Multiply by the Sprite matrix, store result in calcMatrix\r\n                        camMatrix.multiply(spriteMatrix, calcMatrix);\r\n                    }\r\n                    else {\r\n                        spriteMatrix.e -= camera.scrollX * sprite.scrollFactorX;\r\n                        spriteMatrix.f -= camera.scrollY * sprite.scrollFactorY;\r\n                        //  Multiply by the Sprite matrix, store result in calcMatrix\r\n                        camMatrix.multiply(spriteMatrix, calcMatrix);\r\n                    }\r\n                    var tx0 = calcMatrix.getX(x, y);\r\n                    var ty0 = calcMatrix.getY(x, y);\r\n                    var tx1 = calcMatrix.getX(x, yh);\r\n                    var ty1 = calcMatrix.getY(x, yh);\r\n                    var tx2 = calcMatrix.getX(xw, yh);\r\n                    var ty2 = calcMatrix.getY(xw, yh);\r\n                    var tx3 = calcMatrix.getX(xw, y);\r\n                    var ty3 = calcMatrix.getY(xw, y);\r\n                    var tintTL = Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(sprite["_tintTL"], camera.alpha * sprite["_alphaTL"]);\r\n                    var tintTR = Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(sprite["_tintTR"], camera.alpha * sprite["_alphaTR"]);\r\n                    var tintBL = Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(sprite["_tintBL"], camera.alpha * sprite["_alphaBL"]);\r\n                    var tintBR = Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(sprite["_tintBR"], camera.alpha * sprite["_alphaBR"]);\r\n                    if (camera.roundPixels) {\r\n                        tx0 |= 0;\r\n                        ty0 |= 0;\r\n                        tx1 |= 0;\r\n                        ty1 |= 0;\r\n                        tx2 |= 0;\r\n                        ty2 |= 0;\r\n                        tx3 |= 0;\r\n                        ty3 |= 0;\r\n                    }\r\n                    this.setTexture2D(texture, 0);\r\n                    var tintEffect = (sprite["_isTinted"] && sprite.tintFill);\r\n                    this.batchQuad(tx0, ty0, tx1, ty1, tx2, ty2, tx3, ty3, u0, v0, u1, v1, tintTL, tintTR, tintBL, tintBR, tintEffect);\r\n                };\r\n                return TextureTintPipeline;\r\n            }(Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline));\r\n            pipeline.TextureTintPipeline = TextureTintPipeline;\r\n        })(pipeline = phaser.pipeline || (phaser.pipeline = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var plugin;\r\n        (function (plugin) {\r\n            plugin.FileTypes = {\r\n                IMAGE: "imageFile",\r\n                JSON: "jsonFile",\r\n                BINARY: "binaryFile",\r\n                map: {\r\n                    imageFile: Phaser.Loader.FileTypes.ImageFile,\r\n                    jsonFile: Phaser.Loader.FileTypes.JSONFile,\r\n                    binaryFile: Phaser.Loader.FileTypes.BinaryFile\r\n                },\r\n                setType: function (type, clazz) {\r\n                    plugin.FileTypes.map[type] = clazz;\r\n                },\r\n                getType: function (type) {\r\n                    return plugin.FileTypes.map[type];\r\n                }\r\n            };\r\n        })(plugin = phaser.plugin || (phaser.plugin = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var plugin;\r\n        (function (plugin) {\r\n            var DragonBonesFile = /** @class */ (function (_super) {\r\n                __extends(DragonBonesFile, _super);\r\n                function DragonBonesFile(loader, key, textureURL, atlasURL, boneURL, textureXhrSettings, atlasXhrSettings, boneXhrSettings) {\r\n                    var _this = this;\r\n                    var image;\r\n                    var data;\r\n                    var boneData;\r\n                    var keyName;\r\n                    var binFileType = plugin.FileTypes.getType(plugin.FileTypes.BINARY);\r\n                    var jsonFileType = plugin.FileTypes.getType(plugin.FileTypes.JSON);\r\n                    var imageFileType = plugin.FileTypes.getType(plugin.FileTypes.IMAGE);\r\n                    var createBoneFileByType = function (loader, key, boneURL, boneXhrSettings) {\r\n                        var type = "json";\r\n                        if (boneXhrSettings && boneXhrSettings.responseType) {\r\n                            switch (boneXhrSettings.responseType) {\r\n                                case "arraybuffer":\r\n                                case "blob":\r\n                                    type = "bin";\r\n                                    break;\r\n                                case "json":\r\n                                case "text":\r\n                                    type = "json";\r\n                                    break;\r\n                            }\r\n                        }\r\n                        return type === "bin" ?\r\n                            new binFileType(loader, key, boneURL, boneXhrSettings) :\r\n                            new jsonFileType(loader, key, boneURL, boneXhrSettings);\r\n                    };\r\n                    if (Phaser.Utils.Objects.IsPlainObject(key)) {\r\n                        // key is actually a config object\r\n                        var config = key;\r\n                        keyName = Phaser.Utils.Objects.GetFastValue(config, \'key\');\r\n                        image = new imageFileType(loader, {\r\n                            key: keyName,\r\n                            url: Phaser.Utils.Objects.GetFastValue(config, \'textureURL\'),\r\n                            extension: Phaser.Utils.Objects.GetFastValue(config, \'textureExtension\', \'png\'),\r\n                            xhrSettings: Phaser.Utils.Objects.GetFastValue(config, \'textureXhrSettings\')\r\n                        });\r\n                        data = new jsonFileType(loader, {\r\n                            key: keyName + "_atlasjson",\r\n                            url: Phaser.Utils.Objects.GetFastValue(config, \'atlasURL\'),\r\n                            extension: Phaser.Utils.Objects.GetFastValue(config, \'atlasExtension\', \'json\'),\r\n                            xhrSettings: Phaser.Utils.Objects.GetFastValue(config, \'atlasXhrSettings\')\r\n                        });\r\n                        boneData = createBoneFileByType(loader, keyName, Phaser.Utils.Objects.GetFastValue(config, \'boneURL\'), Phaser.Utils.Objects.GetFastValue(config, \'boneXhrSettings\'));\r\n                    }\r\n                    else {\r\n                        keyName = key;\r\n                        image = new imageFileType(loader, keyName, textureURL, textureXhrSettings);\r\n                        data = new jsonFileType(loader, keyName + "_atlasjson", atlasURL, atlasXhrSettings);\r\n                        boneData = createBoneFileByType(loader, keyName, boneURL, boneXhrSettings);\r\n                    }\r\n                    boneData.cache = loader["cacheManager"].custom.dragonbone;\r\n                    _this = _super.call(this, loader, \'dragonbone\', keyName, [image, data, boneData]) || this;\r\n                    return _this;\r\n                }\r\n                DragonBonesFile.prototype.addToCache = function () {\r\n                    if (this.isReadyToProcess()) {\r\n                        var image = this.files[0];\r\n                        var json = this.files[1];\r\n                        var bone = this.files[2];\r\n                        json.addToCache();\r\n                        bone.addToCache();\r\n                        this.loader.textureManager.addImage(image.key, image.data);\r\n                        this.complete = true;\r\n                    }\r\n                };\r\n                return DragonBonesFile;\r\n            }(Phaser.Loader.MultiFile));\r\n            plugin.DragonBonesFile = DragonBonesFile;\r\n        })(plugin = phaser.plugin || (phaser.plugin = {}));\r\n    })(phaser = dragonBones.phaser || (dragonBones.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones_2) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var plugin;\r\n        (function (plugin) {\r\n            var DragonBonesScenePlugin = /** @class */ (function (_super) {\r\n                __extends(DragonBonesScenePlugin, _super);\r\n                function DragonBonesScenePlugin(scene, pluginManager) {\r\n                    var _this = _super.call(this, scene, pluginManager) || this;\r\n                    var game = _this.game;\r\n                    // bone data store\r\n                    game.cache.addCustom("dragonbone");\r\n                    if (_this.game.config.renderType === Phaser.WEBGL) {\r\n                        var renderer = _this.game.renderer;\r\n                        if (!renderer.hasPipeline(\'PhaserTextureTintPipeline\'))\r\n                            renderer.addPipeline(\'PhaserTextureTintPipeline\', new phaser.pipeline.TextureTintPipeline({ game: game, renderer: renderer }));\r\n                    }\r\n                    // Add dragonBones only\r\n                    pluginManager.registerGameObject("dragonBones", CreateDragonBonesRegisterHandler);\r\n                    // Add armature, this will add dragonBones when not exist\r\n                    pluginManager.registerGameObject("armature", CreateArmatureRegisterHandler);\r\n                    pluginManager.registerFileType("dragonbone", DragonBoneFileRegisterHandler, scene);\r\n                    return _this;\r\n                }\r\n                DragonBonesScenePlugin.prototype.createArmature = function (armature, dragonBones, skinName, atlasTextureName, textureScale) {\r\n                    if (textureScale === void 0) { textureScale = 1.0; }\r\n                    var display = this.factory.buildArmatureDisplay(armature, dragonBones, skinName, atlasTextureName, textureScale);\r\n                    this.systems.displayList.add(display);\r\n                    // use db.clock instead, if here we just use this.systems.updateList.add(display), that will cause the db event is dispatched with 1 or more frames delay\r\n                    this._dbInst.clock.add(display.armature);\r\n                    return display;\r\n                };\r\n                DragonBonesScenePlugin.prototype.createDragonBones = function (dragonBonesName, textureScale) {\r\n                    if (textureScale === void 0) { textureScale = 1.0; }\r\n                    return this.factory.buildDragonBonesData(dragonBonesName, textureScale);\r\n                };\r\n                Object.defineProperty(DragonBonesScenePlugin.prototype, "factory", {\r\n                    get: function () {\r\n                        if (!this._factory) {\r\n                            this._dbInst = new dragonBones.DragonBones(new phaser.util.EventDispatcher());\r\n                            this._factory = new phaser.Factory(this._dbInst, this.scene);\r\n                        }\r\n                        return this._factory;\r\n                    },\r\n                    enumerable: true,\r\n                    configurable: true\r\n                });\r\n                /*\r\n                * Slot has a default display, usually it is a transparent image, here you could create a display whatever you want as the default one which -\r\n                * has both skewX / skewY attributes and use "PhaserTextureTintPipeline" to render itself, or simply just use SlotImage or SlotSprite.\r\n                */\r\n                DragonBonesScenePlugin.prototype.createSlotDisplayPlaceholder = function () {\r\n                    return new phaser.display.SlotImage(this.scene, 0, 0);\r\n                };\r\n                DragonBonesScenePlugin.prototype.boot = function () {\r\n                    this.systems.events.once(\'destroy\', this.destroy, this);\r\n                    this.start();\r\n                };\r\n                DragonBonesScenePlugin.prototype.start = function () {\r\n                    var ee = this.systems.events;\r\n                    ee.on(\'update\', this.update, this);\r\n                    ee.once(\'shutdown\', this.shutdown, this);\r\n                };\r\n                DragonBonesScenePlugin.prototype.update = function (time, delta) {\r\n                    this._dbInst && this._dbInst.advanceTime(delta * 0.001);\r\n                };\r\n                DragonBonesScenePlugin.prototype.shutdown = function () {\r\n                    var ee = this.systems.events;\r\n                    ee.off(\'update\', this.update, this);\r\n                    ee.off(\'shutdown\', this.shutdown, this);\r\n                };\r\n                DragonBonesScenePlugin.prototype.destroy = function () {\r\n                    this.shutdown();\r\n                    this._factory =\r\n                        this._dbInst = null;\r\n                    this.pluginManager =\r\n                        this.game =\r\n                            this.scene =\r\n                                this.systems = null;\r\n                };\r\n                return DragonBonesScenePlugin;\r\n            }(Phaser.Plugins.ScenePlugin));\r\n            plugin.DragonBonesScenePlugin = DragonBonesScenePlugin;\r\n            var CreateDragonBonesRegisterHandler = function (dragonBonesName, textureScale) {\r\n                if (textureScale === void 0) { textureScale = 1.0; }\r\n                return this.scene.dragonbone.createDragonBones(dragonBonesName, textureScale);\r\n            };\r\n            var CreateArmatureRegisterHandler = function (armature, dragonBones, skinName, atlasTextureName) {\r\n                return this.scene.dragonbone.createArmature(armature, dragonBones, skinName, atlasTextureName);\r\n            };\r\n            var DragonBoneFileRegisterHandler = function (dragonbonesName, textureURL, atlasURL, boneURL, textureXhrSettings, atlasXhrSettings, boneXhrSettings) {\r\n                var multifile = new plugin.DragonBonesFile(this, dragonbonesName, textureURL, atlasURL, boneURL, textureXhrSettings, atlasXhrSettings, boneXhrSettings);\r\n                this.addFile(multifile.files);\r\n                return this;\r\n            };\r\n        })(plugin = phaser.plugin || (phaser.plugin = {}));\r\n    })(phaser = dragonBones_2.phaser || (dragonBones_2.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\nvar dragonBones;\r\n(function (dragonBones_3) {\r\n    var phaser;\r\n    (function (phaser) {\r\n        var Factory = /** @class */ (function (_super) {\r\n            __extends(Factory, _super);\r\n            function Factory(dragonBones, scene, dataParser) {\r\n                var _this = _super.call(this, dataParser) || this;\r\n                _this._scene = scene;\r\n                _this._dragonBones = dragonBones;\r\n                return _this;\r\n            }\r\n            Factory.prototype._isSupportMesh = function () {\r\n                console.warn("Mesh is not supported yet");\r\n                return false;\r\n            };\r\n            Factory.prototype._buildTextureAtlasData = function (textureAtlasData, textureAtlas) {\r\n                if (textureAtlasData) {\r\n                    textureAtlasData.renderTexture = textureAtlas;\r\n                }\r\n                else\r\n                    textureAtlasData = dragonBones_3.BaseObject.borrowObject(phaser.display.TextureAtlasData);\r\n                return textureAtlasData;\r\n            };\r\n            Factory.prototype._buildArmature = function (dataPackage) {\r\n                var armature = dragonBones_3.BaseObject.borrowObject(dragonBones_3.Armature);\r\n                var armatureDisplay = new phaser.display.ArmatureDisplay(this._scene);\r\n                armature.init(dataPackage.armature, armatureDisplay, armatureDisplay, this._dragonBones);\r\n                return armature;\r\n            };\r\n            Factory.prototype._buildSlot = function (dataPackage, slotData, armature) {\r\n                var slot = dragonBones_3.BaseObject.borrowObject(phaser.display.Slot);\r\n                var rawDisplay = this._scene.dragonbone.createSlotDisplayPlaceholder();\r\n                var meshDisplay = rawDisplay; // TODO: meshDisplay is not supported yet\r\n                slot.init(slotData, armature, rawDisplay, meshDisplay);\r\n                return slot;\r\n            };\r\n            // dragonBonesName must be assigned, or can\'t find in cache inside\r\n            Factory.prototype.buildArmatureDisplay = function (armatureName, dragonBonesName, skinName, textureAtlasName, textureScale) {\r\n                if (skinName === void 0) { skinName = ""; }\r\n                if (textureAtlasName === void 0) { textureAtlasName = ""; }\r\n                if (textureScale === void 0) { textureScale = 1.0; }\r\n                var armature;\r\n                if (this.buildDragonBonesData(dragonBonesName, textureScale)) {\r\n                    armature = this.buildArmature(armatureName, dragonBonesName, skinName, textureAtlasName);\r\n                }\r\n                return armature.display;\r\n            };\r\n            Factory.prototype.buildDragonBonesData = function (dragonBonesName, textureScale) {\r\n                if (textureScale === void 0) { textureScale = 1.0; }\r\n                var data = this._dragonBonesDataMap[dragonBonesName];\r\n                if (!data) {\r\n                    var cache = this._scene.cache;\r\n                    var boneRawData = cache.custom.dragonbone.get(dragonBonesName);\r\n                    if (boneRawData) {\r\n                        // parse raw data and add to cache map\r\n                        data = this.parseDragonBonesData(boneRawData, dragonBonesName, textureScale);\r\n                        var texture = this._scene.textures.get(dragonBonesName);\r\n                        var json = cache.json.get(dragonBonesName + "_atlasjson");\r\n                        this.parseTextureAtlasData(json, texture, texture.key, textureScale);\r\n                    }\r\n                }\r\n                return data;\r\n            };\r\n            return Factory;\r\n        }(dragonBones_3.BaseFactory));\r\n        phaser.Factory = Factory;\r\n    })(phaser = dragonBones_3.phaser || (dragonBones_3.phaser = {}));\r\n})(dragonBones || (dragonBones = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/dragonBones/dragonBones.js?')},"./lib/dragonBones/dragonBones.js-exposed":function(module,exports,__webpack_require__){eval('/* WEBPACK VAR INJECTION */(function(global) {module.exports = global["dragonBones"] = __webpack_require__(/*! -!./dragonBones.js */ "./lib/dragonBones/dragonBones.js");\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js?c8ba")))\n\n//# sourceURL=webpack://TooqingCore/./lib/dragonBones/dragonBones.js-exposed?')},"./lib/rexui/plugins/bbcodetext-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_text_bbocdetext_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/text/bbocdetext/Factory.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/Factory.js");\n/* harmony import */ var _gameobjects_text_bbocdetext_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/text/bbocdetext/Creator.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/Creator.js");\n/* harmony import */ var _gameobjects_text_bbocdetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/text/bbocdetext/BBCodeText.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n/* harmony import */ var _utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass BBCodeTextPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexBBCodeText\', _gameobjects_text_bbocdetext_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_text_bbocdetext_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.once(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.BBCodeText\', _gameobjects_text_bbocdetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BBCodeTextPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/bbcodetext-plugin.js?')},"./lib/rexui/plugins/behaviors/anchor/Anchor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetViewport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetViewport.js */ \"./lib/rexui/plugins/behaviors/anchor/GetViewport.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nclass Anchor {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.viewport = new Rectangle();\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        var configX, configY;\r\n        if (typeof (o) === 'string') {\r\n            var configXY = o.split(',');\r\n            configX = configXY[0];\r\n            configY = configXY[1];\r\n        } else {\r\n            configX = GetValue(o, 'x', '0%+0');\r\n            configY = GetValue(o, 'y', '0%+0');\r\n        }\r\n\r\n        configX = configX.replace('left', '0%').replace('right', '100%').replace('center', '50%').split('%');\r\n        var percentageX = parseFloat(configX[0]) / 100;\r\n        var offsetX = (configX[1] === '') ? 0 : parseFloat(configX[1]);\r\n\r\n        configY = configY.replace('top', '0%').replace('bottom', '100%').replace('center', '50%').split('%');\r\n        var percentageY = parseFloat(configY[0]) / 100;\r\n        var offsetY = (configY[1] === '') ? 0 : parseFloat(configY[1]);\r\n\r\n        this.setPercentage(percentageX, percentageY);\r\n        this.setOffset(offsetX, offsetY);\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scaleManamger.on('resize', this.onResize, this);\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n\r\n        this.onResize();\r\n    }\r\n\r\n    shutdown() {\r\n        this.scaleManamger.off('resize', this.onResize, this);\r\n        this.gameObject = undefined;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setOffset(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n        this.offsetX = x;\r\n        this.offsetY = y;\r\n        return this;\r\n    }\r\n\r\n    setPercentage(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n        this.percentageX = x;\r\n        this.percentageY = y;\r\n        return this;\r\n    }\r\n\r\n    onResize() {\r\n        Object(_GetViewport_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.scaleManamger, this.viewport);\r\n        this.updatePosition();\r\n    }\r\n\r\n    updatePosition() {\r\n        this.gameObject.setPosition(this.x, this.y);\r\n        return this;\r\n    }\r\n\r\n    get scaleManamger() {\r\n        return this.gameObject.scene.scale;\r\n    }\r\n\r\n    get x() {\r\n        return this.viewport.x + (this.viewport.width * this.percentageX) + this.offsetX;\r\n    }\r\n\r\n    get y() {\r\n        return this.viewport.y + (this.viewport.height * this.percentageY) + this.offsetY;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Anchor);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/anchor/Anchor.js?")},"./lib/rexui/plugins/behaviors/anchor/GetViewport.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nvar GetViewport = function (scaleManager, out) {\r\n    if (out === undefined) {\r\n        out = new Rectangle();\r\n    }\r\n    var bounds = scaleManager.canvasBounds;\r\n    var scale = scaleManager.displayScale;\r\n    var autoCenter = scaleManager.autoCenter;\r\n    out.x = (bounds.x >= 0) ? 0 : -(bounds.x * scale.x);\r\n    out.y = (bounds.y >= 0) ? 0 : -(bounds.y * scale.y);\r\n    out.width = (bounds.width * scale.x) - out.x;\r\n    out.height = (bounds.height * scale.y) - out.y;\r\n    if ((autoCenter === 1) || (autoCenter === 2)) {\r\n        out.width -= out.x;\r\n    }\r\n    if ((autoCenter === 1) || (autoCenter === 3)) {\r\n        out.height -= out.y;\r\n    }\r\n    return out;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetViewport);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/anchor/GetViewport.js?')},"./lib/rexui/plugins/behaviors/fade/Fade.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Fade {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n\r\n        this.alphaStart = undefined;\r\n        this.alphaEnd = undefined;\r\n        this.tween = undefined;\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setMode(GetValue(o, 'mode', 0));\r\n        this.setAlphaRange(\r\n            GetAdvancedValue(o, 'start', this.gameObject.alpha),\r\n            GetAdvancedValue(o, 'end', 0)\r\n        );\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 1000));\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            mode: this.mode,\r\n            start: this.alphaStart,\r\n            end: this.alphaEnd,\r\n            delay: this.delay,\r\n            duration: this.duration\r\n        };\r\n    }\r\n\r\n    boot() {\r\n        if (this.gameObject.once) { // oops, bob object does not have event emitter\r\n            this.gameObject.once('destroy', this.destroy, this);\r\n        }\r\n    }\r\n\r\n    shutdown() {\r\n        this.stop();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = MODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n    setAlphaRange(start, end) {\r\n        this.alphaStart = start;\r\n        this.alphaEnd = end;\r\n        return this;\r\n    }\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.tween) {\r\n            return this;\r\n        }\r\n\r\n        if (this.duration === 0) {\r\n            this.gameObject.setAlpha(this.alphaEnd);\r\n            this.complete();\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setAlpha(this.alphaStart);\r\n        this.tween = this.scene.tweens.add({\r\n            targets: this.gameObject,\r\n            alpha: this.alphaEnd,\r\n\r\n            delay: this.delay,\r\n            duration: this.duration,\r\n            ease: 'Linear',\r\n            yoyo: (this.mode == 2),\r\n            repeat: ((this.mode == 2) ? -1 : 0),\r\n            onComplete: this.complete,\r\n            onCompleteScope: this\r\n        });\r\n        return this;\r\n    }\r\n\r\n    restart() {\r\n        this.stop().start();\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        if (!this.tween) {\r\n            return this;\r\n        }\r\n\r\n        this.tween.remove();\r\n        this.tween = undefined;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.stop();\r\n        if (this.mode === 1) {\r\n            this.gameObject.destroy();\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nconst MODE = {\r\n    stop: 0,\r\n    destroy: 1,\r\n    yoyo: 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Fade);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/fade/Fade.js?")},"./lib/rexui/plugins/behaviors/flip/Flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetFaceUpdatingCallback.js */ \"./lib/rexui/plugins/behaviors/flip/GetFaceUpdatingCallback.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Flip {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        this.scaleStart = {};\r\n        this.scaleEnd = {};\r\n        this.tween = undefined;\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setOrientation(GetValue(o, 'orientation', 0));\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 500));\r\n        this.setEase(GetValue(o, 'ease', 'Sine'));\r\n\r\n        this.setFrontFace(GetValue(o, 'front', undefined));\r\n        this.setBackFace(GetValue(o, 'back', undefined));\r\n        this.setFace(GetValue(o, 'face', 0));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        if (this.gameObject.once) { // oops, bob object does not have event emitter\r\n            this.gameObject.once('destroy', this.destroy, this);\r\n        }\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.stop();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if (typeof (orientation) === 'string') {\r\n            orientation = ORIENTATIONMODE[orientation];\r\n        }\r\n        this.orientation = orientation;\r\n        return this;\r\n    }\r\n\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    setEase(ease) {\r\n        if (ease === undefined) {\r\n            ease = 'Linear';\r\n        }\r\n        this.ease = ease;\r\n        return this;\r\n    }\r\n\r\n    get isRunning() {\r\n        return (!!this.tween);\r\n    }\r\n\r\n    get face() {\r\n        return this._face;\r\n    }\r\n\r\n    set face(face) {\r\n        if (typeof (face) === 'string') {\r\n            face = FACEMODE[face];\r\n        }\r\n        this._face = face;\r\n        if ((face === 0) && this.frontFaceCallback) {\r\n            this.frontFaceCallback(this.gameObject);\r\n        } else if ((face === 1) && this.backFaceCallback) {\r\n            this.backFaceCallback(this.gameObject);\r\n        }\r\n    }\r\n\r\n    setFace(face) {\r\n        this.face = face;\r\n        return this;\r\n    }\r\n\r\n    toggleFace() {\r\n        var newFace = (this.face === 0) ? 1 : 0;\r\n        this.setFace(newFace);\r\n        return this;\r\n    }\r\n\r\n    setFrontFace(key, frame) {\r\n        this.frontFaceCallback = Object(_GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(key, frame, this.gameObject);\r\n        return this;\r\n    }\r\n\r\n    setBackFace(key, frame) {\r\n        this.backFaceCallback = Object(_GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(key, frame, this.gameObject);\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        if (this.duration === 0) {\r\n            this\r\n                .toggleFace()\r\n                .complete();\r\n            return this;\r\n        }\r\n\r\n        var config = {\r\n            targets: this.gameObject,\r\n            duration: this.duration / 2,\r\n            ease: this.ease,\r\n            yoyo: true,\r\n            repeat: 0,\r\n\r\n            onYoyo: this.toggleFace,\r\n            onYoyoScope: this,\r\n            onComplete: this.complete,\r\n            onCompleteScope: this\r\n        }\r\n\r\n        var propKey = (this.orientation === 0) ? 'scaleX' : 'scaleY';\r\n        config[propKey] = { from: 1, to: 0 };\r\n\r\n        this.tween = this.scene.tweens.add(config);\r\n        return this;\r\n    }\r\n\r\n    restart() {\r\n        this.stop().start();\r\n        return this;\r\n    }\r\n\r\n    flip(duration) {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n        if (duration !== undefined) {\r\n            this.setDuration(duration);\r\n        }\r\n        this.start();\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        if (!this.tween) {\r\n            return this;\r\n        }\r\n\r\n        this.tween.remove();\r\n        this.tween = undefined;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.stop();\r\n        this.emit('complete', this, this.gameObject);\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nObject.assign(\r\n    Flip.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nconst ORIENTATIONMODE = {\r\n    x: 0,\r\n    horizontal: 0,\r\n    y: 1,\r\n    vertical: 1,\r\n}\r\n\r\nconst FACEMODE = {\r\n    front: 0,\r\n    back: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Flip);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/flip/Flip.js?")},"./lib/rexui/plugins/behaviors/flip/GetFaceUpdatingCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar GetFaceUpdatingCallback = function (key, frame, gameObject) {\r\n    var callback;\r\n    if (key === undefined) {\r\n        key = gameObject.texture.key;\r\n        frame = gameObject.frame.name;\r\n    } else if (IsPlainObject(key)) {\r\n        var config = key;\r\n        key = GetValue(config, 'key', gameObject.texture.key);\r\n        frame = GetValue(config, 'frame', gameObject.frame.name);\r\n    } else if (typeof (key) === 'string') {\r\n    } else {\r\n        callback = key;\r\n    }\r\n\r\n    if (callback === undefined) {\r\n        callback = function (gameObject) {\r\n            gameObject.setTexture(key, frame);\r\n        }\r\n    }\r\n    return callback;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetFaceUpdatingCallback);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/flip/GetFaceUpdatingCallback.js?")},"./lib/rexui/plugins/behaviors/scale/Scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Scale {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n\r\n        this.scaleStart = {};\r\n        this.scaleEnd = {};\r\n        this.tween = undefined;\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setMode(GetValue(o, 'mode', 0));\r\n        this.setScaleRange(\r\n            GetAdvancedValue(o, 'start', undefined),\r\n            GetAdvancedValue(o, 'end', 0)\r\n        );\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 1000));\r\n        this.setEase(GetValue(o, 'ease', undefined));\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            mode: this.mode,\r\n            start: this.scaleStart,\r\n            end: this.scaleEnd,\r\n            delay: this.delay,\r\n            duration: this.duration\r\n        };\r\n    }\r\n\r\n    boot() {\r\n        if (this.gameObject.once) { // oops, bob object does not have event emitter\r\n            this.gameObject.once('destroy', this.destroy, this);\r\n        }\r\n    }\r\n\r\n    shutdown() {\r\n        this.stop();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = MODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setScaleRange(start, end) {\r\n        if (typeof (start) === 'number') {\r\n            this.scaleStart.x = start;\r\n            this.scaleStart.y = start;\r\n        } else {\r\n            this.scaleStart.x = GetValue(start, 'x', this.gameObject.scaleX);\r\n            this.scaleStart.y = GetValue(start, 'y', this.gameObject.scaleY);\r\n        }\r\n        if (typeof (end) === 'number') {\r\n            this.scaleEnd.x = end;\r\n            this.scaleEnd.y = end;\r\n        } else {\r\n            this.scaleEnd.x = GetValue(end, 'x', this.scaleStart.x);\r\n            this.scaleEnd.y = GetValue(end, 'y', this.scaleStart.y);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    setEase(ease) {\r\n        if (ease === undefined) {\r\n            ease = 'Linear';\r\n        }\r\n        this.ease = ease;\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.tween) {\r\n            return this;\r\n        }\r\n\r\n        if (this.duration === 0) {\r\n            this.sound.setScale(this.scaleEnd.x, this.scaleEnd.y);\r\n            this.complete();\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setScale(this.scaleStart.x, this.scaleStart.y);\r\n        this.tween = this.scene.tweens.add({\r\n            targets: this.gameObject,\r\n            scaleX: this.scaleEnd.x,\r\n            scaleY: this.scaleEnd.y,\r\n\r\n            duration: this.duration,\r\n            ease: this.ease,\r\n            yoyo: (this.mode == 2),\r\n            repeat: ((this.mode == 2) ? -1 : 0),\r\n            onComplete: this.complete,\r\n            onCompleteScope: this\r\n        });\r\n        return this;\r\n    }\r\n\r\n    restart() {\r\n        this.stop().start();\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        if (!this.tween) {\r\n            return this;\r\n        }\r\n\r\n        this.tween.remove();\r\n        this.tween = undefined;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.stop();\r\n        if (this.mode === 1) {\r\n            this.gameObject.destroy();\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nconst MODE = {\r\n    stop: 0,\r\n    destroy: 1,\r\n    yoyo: 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scale);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/scale/Scale.js?")},"./lib/rexui/plugins/behaviors/textedit/CreateInputText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../gameobjects/inputtext/InputText.js */ \"./lib/rexui/plugins/gameobjects/inputtext/InputText.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar CreateInputText = function (text, config) {\r\n    if (config === undefined) {\r\n        config = {};\r\n    }\r\n\r\n    var scene = text.scene;\r\n    var style = text.style;\r\n    var backgroundColor = GetValue(config, 'backgroundColor', style.backgroundColor);\r\n    if (backgroundColor === null) {\r\n        backgroundColor = 'transparent';\r\n    }\r\n\r\n    config.text = GetValue(config, 'text', text.text);\r\n    config.fontFamily = GetValue(config, 'fontFamily', style.fontFamily);\r\n    config.fontSize = GetValue(config, 'fontSize', style.fontSize);\r\n    config.color = GetValue(config, 'color', style.color);\r\n    config.backgroundColor = backgroundColor;\r\n\r\n    var inputText = new _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](scene,\r\n        text.x, text.y,\r\n        GetValue(config, 'width', text.width),\r\n        GetValue(config, 'height', text.height),\r\n        config\r\n    );\r\n    inputText.setOrigin(text.originX, text.originY);\r\n    scene.add.existing(inputText);\r\n    return inputText;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CreateInputText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/textedit/CreateInputText.js?")},"./lib/rexui/plugins/behaviors/textedit/Edit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextEdit_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextEdit.js */ "./lib/rexui/plugins/behaviors/textedit/TextEdit.js");\n\r\n\r\nvar Edit = function (gameObject, config, onCloseCallback) {\r\n    if (!gameObject._edit) {\r\n        gameObject._edit = new _TextEdit_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject);\r\n    }\r\n    gameObject._edit.open(config, onCloseCallback);\r\n    return gameObject._edit;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Edit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/textedit/Edit.js?')},"./lib/rexui/plugins/behaviors/textedit/TextEdit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _CreateInputText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CreateInputText.js */ \"./lib/rexui/plugins/behaviors/textedit/CreateInputText.js\");\n/* harmony import */ var _utils_object_IsFunction_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/object/IsFunction.js */ \"./lib/rexui/plugins/utils/object/IsFunction.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextEdit {\r\n    constructor(gameObject) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n\r\n        this.inputText = undefined;\r\n        this.onClose = undefined;\r\n        this.delayCall = undefined;\r\n        this.boot();\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n\r\n        return this;\r\n    }\r\n\r\n    shutdown() {\r\n        this.close();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        if (globLastOpenedEditor === this) {\r\n            globLastOpenedEditor = undefined;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    open(config, onCloseCallback) {\r\n        if (globLastOpenedEditor !== undefined) {\r\n            globLastOpenedEditor.close();\r\n        }\r\n\r\n        globLastOpenedEditor = this;\r\n        if (Object(_utils_object_IsFunction_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(config)) {\r\n            onCloseCallback = config;\r\n            config = undefined;\r\n        }\r\n        if (onCloseCallback === undefined) {\r\n            onCloseCallback = GetValue(config, 'onClose', undefined);\r\n        }\r\n\r\n        var customOnTextChanged = GetValue(config, 'onTextChanged', undefined);\r\n\r\n        this.inputText = Object(_CreateInputText_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.gameObject, config)\r\n            .on('textchange', function (inputText) {\r\n                var text = inputText.text;\r\n                if (customOnTextChanged) { // Custom on-text-changed callback\r\n                    customOnTextChanged(this.gameObject, text);\r\n                } else { // Default on-text-changed callback\r\n                    this.gameObject.text = text;\r\n                }\r\n            }, this)\r\n            .setFocus();\r\n        this.gameObject.setVisible(false); // Set parent text invisible\r\n\r\n        // Attach close event\r\n        this.onClose = onCloseCallback;\r\n        this.scene.input.keyboard.once('keydown-ENTER', this.close, this);\r\n        // Attach pointerdown (outside of input-text) event, at next tick\r\n        this.delayCall = this.scene.time.delayedCall(0, function () {\r\n            this.scene.input.once('pointerdown', this.close, this);\r\n        }, [], this);\r\n        return this;\r\n    }\r\n\r\n    close() {\r\n        globLastOpenedEditor = undefined;\r\n        if (!this.inputText) {\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setVisible(true); // Set parent text visible\r\n\r\n        this.inputText.destroy();\r\n        this.inputText = undefined;\r\n        if (this.delayCall) {\r\n            this.delayCall.remove();\r\n            this.delayCall = undefined;\r\n        }\r\n\r\n        // Remove close event\r\n        this.scene.input.keyboard.off('keydown-ENTER', this.close, this);\r\n        this.scene.input.off('pointerdown', this.close, this);\r\n\r\n        if (this.onClose) {\r\n            this.onClose(this.gameObject);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isOpened() {\r\n        return (this.inputText !== undefined);\r\n    }\r\n\r\n    get text() {\r\n        return (this.isOpened) ? this.inputText.text : this.gameObject.text;\r\n    }\r\n}\r\n\r\nvar globLastOpenedEditor = undefined;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextEdit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/textedit/TextEdit.js?")},"./lib/rexui/plugins/behaviors/textpage/TextPage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/text/IsTextGameObject.js */ \"./lib/rexui/plugins/utils/text/IsTextGameObject.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\n\r\nclass TextPagePlugin {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        this.setTextObjectType();\r\n\r\n        this.lines = undefined; // Array (default text object), or pens-manager (tag text object)\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setText(GetValue(o, 'text', ''));\r\n        this.setStartIdx(GetValue(o, 'start', 0));\r\n        this.setPageIdx(GetValue(o, 'page', -1));\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            text: this.text,\r\n            start: this.startLineIdx,\r\n            page: this.pageIndex,\r\n\r\n            pageCount: this.pageCount\r\n\r\n        };\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        if (this.lines === undefined) {\r\n            // Do nothing\r\n        } else if (this.textObjectType === 0) {\r\n            this.lines.length = 0;\r\n        } else {\r\n            this.lines.destroy();\r\n        }\r\n\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setTextObjectType() {\r\n        this.textObjectType = Object(_utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.gameObject) ? 0 : 1;\r\n        return this;\r\n    }\r\n\r\n    get isFirstPage() {\r\n        return (this.pageIndex <= 0);\r\n    }\r\n\r\n    get isLastPage() {\r\n        return (this.pageIndex >= (this.pageCount - 1));\r\n    }\r\n\r\n    setText(text, resetPageIdx) {\r\n        if (resetPageIdx === undefined) {\r\n            resetPageIdx = true;\r\n        }\r\n        this.text = transferText(text);\r\n\r\n        // Wrap content in lines\r\n        if (this.textObjectType === 0) {\r\n            this.lines = this.gameObject.getWrappedText(this.text); // lines in array\r\n        } else {\r\n            this.lines = this.gameObject.getPenManager(this.text, this.lines); // pen manager\r\n        }\r\n\r\n        this.pageCount = Math.ceil(this.totalLinesCount / this.pageLinesCount);\r\n        if (resetPageIdx) {\r\n            this.resetPageIdx();\r\n        }\r\n        return this;\r\n    }\r\n\r\n    appendText(text) {\r\n        this.setText(this.text.concat(transferText(text)));\r\n        return this;\r\n    }\r\n\r\n    getPage(idx) {\r\n        if (idx === undefined) {\r\n            idx = this.pageIndex;\r\n        }\r\n        return this.setPageIdx(idx).getLines();\r\n    }\r\n\r\n    getNextPage() {\r\n        return this.getPage(this.pageIndex + 1);\r\n    }\r\n\r\n    getPreviousPage() {\r\n        return this.getPage(this.pageIndex - 1);\r\n    }\r\n\r\n    showPage(idx) {\r\n        this.displayText(this.getPage());\r\n        return this;\r\n    }\r\n\r\n    showNextPage() {\r\n        this.displayText(this.getNextPage());\r\n        return this;\r\n    }\r\n\r\n    showPreviousPage() {\r\n        this.displayText(this.getPreviousPage());\r\n        return this;\r\n    }\r\n\r\n    show() {\r\n        this.displayText(this.getLines());\r\n        return this;\r\n    }\r\n\r\n    showNextLine() {\r\n        this.displayText(this.setStartIdx(this.startLineIdx + 1).getLines());\r\n        return this;\r\n    }\r\n\r\n    showPreviousLine() {\r\n        this.displayText(this.setStartIdx(this.startLineIdx - 1).getLines());\r\n        return this;\r\n    }\r\n\r\n    setStartIdx(idx) {\r\n        idx = Clamp(idx, 0, this.totalLinesCount - 1);\r\n        this.startLineIdx = idx;\r\n        return this;\r\n    }\r\n\r\n    resetPageIdx() {\r\n        this.pageIndex = -1;\r\n    }\r\n\r\n    setPageIdx(idx) {\r\n        idx = Clamp(idx, 0, this.pageCount - 1);\r\n        this.pageIndex = idx;\r\n        this.setStartIdx(this.pageIndex * this.pageLinesCount);\r\n        return this;\r\n    }\r\n\r\n    get totalLinesCount() {\r\n        var count;\r\n        if (this.textObjectType === 0) {\r\n            count = this.lines.length;\r\n        } else {\r\n            count = this.lines.linesCount;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    get pageLinesCount() {\r\n        var count;\r\n        var maxLines = this.gameObject.style.maxLines;\r\n        if (maxLines > 0) {\r\n            count = maxLines;\r\n        } else {\r\n            count = this.totalLinesCount;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    getLines(startLineIdx) {\r\n        if (startLineIdx === undefined) {\r\n            startLineIdx = this.startLineIdx;\r\n        }\r\n        var endLineIdx = startLineIdx + this.pageLinesCount;\r\n        var text;\r\n        if (this.textObjectType === 0) {\r\n            text = this.lines.slice(startLineIdx, endLineIdx).join('\\n');\r\n        } else {\r\n            var startIdx = this.lines.getLineStartIndex(startLineIdx);\r\n            var endIdx = this.lines.getLineEndIndex(endLineIdx - 1);\r\n            text = this.lines.getSliceTagText(startIdx, endIdx, true);\r\n        }\r\n        return text;\r\n    }\r\n\r\n    displayText(text) {\r\n        this.gameObject.setText(text);\r\n    }\r\n}\r\n\r\nvar transferText = function (text) {\r\n    if (Array.isArray(text)) {\r\n        text = text.join('\\n');\r\n    } else if (typeof (text) === 'number') {\r\n        text = text.toString();\r\n    }\r\n    return text;\r\n}\r\n\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextPagePlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/textpage/TextPage.js?")},"./lib/rexui/plugins/behaviors/texttyping/TextTyping.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\nconst EE = Phaser.Events.EventEmitter;\r\nconst GetFastValue = Phaser.Utils.Objects.GetFastValue;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextTyping extends EE {\r\n    constructor(gameObject, config) {\r\n        super();\r\n\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        \r\n        this.timer = null;\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    /**\r\n     * Reset status by JSON object\r\n     * @param {object} o JSON object\r\n     * @returns {object} this object\r\n     */\r\n    resetFromJSON(o) {\r\n        this.setTypeMode(GetValue(o, 'typeMode', 0));\r\n        this.setTypeSpeed(GetValue(o, 'speed', 333));\r\n        this.setTextCallback = GetFastValue(o, 'setTextCallback', null);\r\n        this.setTextCallbackScope = GetFastValue(o, 'setTextCallbackScope', null);\r\n\r\n        this.typingIdx = GetFastValue(o, 'typingIdx', 0);\r\n        this.text = transferText(GetFastValue(o, 'text', ''));\r\n        this.textLen = GetFastValue(o, 'textLen', 0);\r\n        this.insertIdx = GetFastValue(o, 'insertIdx', null);\r\n\r\n        var elapsed = GetFastValue(o, 'elapsed', null);\r\n        if (elapsed !== null) {\r\n            this.start(undefined, undefined, this.typingIdx, elapsed);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Return status in JSON object\r\n     * @returns JSON object\r\n     */\r\n    toJSON() {\r\n        var elapsed;\r\n        var timer = this.getTimer();\r\n        if (timer) {\r\n            elapsed = timer.elapsed;\r\n        } else {\r\n            elapsed = null;\r\n        }\r\n\r\n        return {\r\n            typeMode: this.typeMode,\r\n            speed: this.speed,\r\n            setTextCallback: this.setTextCallback,\r\n            setTextCallbackScope: this.setTextCallbackScope,\r\n\r\n            typingIdx: this.typingIdx,\r\n            text: this.text,\r\n            textLen: this.textLen,\r\n            insertIdx: this.insertIdx,\r\n            elapsed: elapsed\r\n        };\r\n    }\r\n\r\n    boot() {\r\n        if (this.gameObject.once) { // oops, bob object does not have event emitter\r\n            this.gameObject.once('destroy', this.destroy, this);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    shutdown() {\r\n        super.shutdown();\r\n        this.freeTimer();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    setTypeMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = TYPEMODE[m];\r\n        }\r\n        this.typeMode = m;\r\n        return this;\r\n    }\r\n\r\n    setTypeSpeed(speed) {\r\n        this.speed = speed;\r\n        return this;\r\n    }\r\n\r\n    get isTyping() {\r\n        return (this.getTimer() !== null);\r\n    }\r\n\r\n    get isLastChar() {\r\n        return (this.typingIdx === this.textLen);\r\n    }\r\n\r\n    start(text, speed, startIdx, timerStartAt) {\r\n        if (text !== undefined) {\r\n            this.setTypingContent(text);\r\n        }\r\n        if (speed !== undefined) {\r\n            this.speed = speed;\r\n        }\r\n        if (startIdx === undefined) {\r\n            startIdx = 0;\r\n        }\r\n\r\n        this.typingIdx = startIdx + 1;\r\n        if (this.speed === 0) {\r\n            this.stop(true);\r\n        } else {\r\n            this.startTimer(timerStartAt);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    appendText(text) {\r\n        var newText = this.text.concat(transferText(text));\r\n        if (this.isTyping) {\r\n            this.setTypingContent(newText);\r\n        } else {\r\n            this.start(newText, undefined, this.textLen);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    stop(showAllText) {\r\n        var timer = this.getTimer();\r\n        if (timer) {\r\n            this.freeTimer();\r\n        }\r\n        if (showAllText) {\r\n            this.typingIdx = this.textLen;\r\n            this.setText(this.text);\r\n            this.emit('type');\r\n            this.emit('complete', this, this.gameObject);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        var timer = this.getTimer();\r\n        if (timer) {\r\n            timer.paused = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        var timer = this.getTimer();\r\n        if (timer) {\r\n            timer.paused = false;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setTypingContent(text) {\r\n        this.text = transferText(text);\r\n        this.textLen = this.getTextLength(this.text);\r\n        return this;\r\n    }\r\n\r\n    onTyping() {\r\n        var newText = this.getTypingString(this.text, this.typingIdx, this.textLen, this.typeMode);\r\n        this.setText(newText);\r\n        this.emit('type');\r\n\r\n        if (this.isLastChar) {\r\n            this.freeTimer();\r\n            this.emit('complete', this, this.gameObject);\r\n        } else {\r\n            this.timer.delay = this.speed; // delay of next typing            \r\n            this.typingIdx++;\r\n        }\r\n    }\r\n\r\n    getTypingString(text, typeIdx, textLen, typeMode) {\r\n        var result;\r\n        if (typeMode === 0) { //left-to-right\r\n            var startIdx = 0;\r\n            var endIdx = typeIdx;\r\n            this.insertIdx = endIdx;\r\n            result = this.getSubString(text, startIdx, endIdx);\r\n\r\n        } else if (typeMode === 1) { //right-to-left\r\n            var endIdx = textLen;\r\n            var startIdx = endIdx - typeIdx;\r\n            this.insertIdx = 0;\r\n            result = this.getSubString(text, startIdx, endIdx);\r\n\r\n        } else if (typeMode === 2) { //middle-to-sides\r\n            var midIdx = textLen / 2;\r\n            var startIdx = Math.floor(midIdx - (typeIdx / 2));\r\n            var endIdx = startIdx + typeIdx;\r\n            this.insertIdx = (typeIdx % 2) ? typeIdx : 0;\r\n            result = this.getSubString(text, startIdx, endIdx);\r\n\r\n        } else if (typeMode === 3) { //sides-to-middle\r\n            var lowerLen = Math.floor(typeIdx / 2);\r\n            var lowerResult;\r\n            if (lowerLen > 0) {\r\n                var endIdx = textLen;\r\n                var startIdx = endIdx - lowerLen;\r\n                lowerResult = this.getSubString(text, startIdx, endIdx);\r\n            } else {\r\n                lowerResult = \"\";\r\n            }\r\n\r\n            var upperLen = typeIdx - lowerLen;\r\n            var upperResult;\r\n            if (upperLen > 0) {\r\n                var startIdx = 0;\r\n                var endIdx = startIdx + upperLen;\r\n                this.insertIdx = endIdx;\r\n                upperResult = this.getSubString(text, startIdx, endIdx);\r\n            } else {\r\n                upperResult = \"\";\r\n                this.insertIdx = 0;\r\n            }\r\n            result = upperResult + lowerResult;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    startTimer(timerStartAt) {\r\n        if (this.timer) {\r\n            this.freeTimer();\r\n        }\r\n        var delay, startAt;\r\n        if (timerStartAt === undefined) {\r\n            delay = 0;\r\n            startAt = 0;\r\n        } else {\r\n            delay = this.speed;\r\n            startAt = timerStartAt;\r\n        }\r\n\r\n        this.timer = this.scene.time.addEvent({\r\n            delay: 0,\r\n            startAt: startAt,\r\n            loop: true,\r\n            callback: this.onTyping,\r\n            callbackScope: this\r\n        });\r\n        return this;\r\n    }\r\n\r\n    getTimer() {\r\n        return this.timer;\r\n    }\r\n\r\n    freeTimer() {\r\n        if (this.timer) {\r\n            this.timer.remove();\r\n            this.timer = null;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setText(text) {\r\n        if (this.setTextCallback) {\r\n            if (this.setTextCallbackScope) {\r\n                text = this.setTextCallback.call(this.setTextCallbackScope, text, this.isLastChar, this.insertIdx);\r\n            } else {\r\n                text = this.setTextCallback(text, this.isLastChar, this.insertIdx);\r\n            }\r\n        }\r\n        this.gameObject.setText(text);\r\n    }\r\n\r\n    getTextLength(text) {\r\n        var gameObject = this.gameObject;\r\n        var len;\r\n        if (gameObject.getPlainText) {\r\n            len = gameObject.getPlainText(text).length;\r\n        } else {\r\n            len = text.length;\r\n        }\r\n\r\n        return len;\r\n    }\r\n\r\n    getSubString(text, startIdx, endIdx) {\r\n        var gameObject = this.gameObject;\r\n        var result;\r\n        if (gameObject.getSubString) {\r\n            result = gameObject.getSubString(text, startIdx, endIdx);\r\n        } else {\r\n            result = text.slice(startIdx, endIdx);\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nvar transferText = function (text) {\r\n    if (Array.isArray(text)) {\r\n        text = text.join('\\n');\r\n    } else if (typeof (text) === 'number') {\r\n        text = text.toString();\r\n    }\r\n    return text;\r\n}\r\n\r\n/** @private */\r\nconst TYPEMODE = {\r\n    'left-to-right': 0,\r\n    'right-to-left': 1,\r\n    'middle-to-sides': 2,\r\n    'sides-to-middle': 3\r\n};\r\n\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextTyping);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/behaviors/texttyping/TextTyping.js?")},"./lib/rexui/plugins/button-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./button.js */ "./lib/rexui/plugins/button.js");\n\r\n\r\nclass ButtonPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.once(\'destroy\', this.destroy, this);\r\n    }\r\n\r\n    add(gameObject, config) {\r\n        return new _button_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n    }\r\n\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ButtonPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/button-plugin.js?')},"./lib/rexui/plugins/button.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/button/Button.js */ "./lib/rexui/plugins/input/button/Button.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/button.js?')},"./lib/rexui/plugins/dragspeed.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_dragspeed_DragSpeed_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/dragspeed/DragSpeed.js */ "./lib/rexui/plugins/input/dragspeed/DragSpeed.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_dragspeed_DragSpeed_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/dragspeed.js?')},"./lib/rexui/plugins/fade-in.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fade.js */ "./lib/rexui/plugins/fade.js");\n\r\n\r\nvar FadeIn = function (gameObject, duration, endAlpha, fade) {\r\n    if (endAlpha === undefined) {\r\n        endAlpha = gameObject.alpha;\r\n    }\r\n    defaultConfig.mode = 0;\r\n    defaultConfig.start = 0;\r\n    defaultConfig.end = endAlpha;\r\n    defaultConfig.duration = duration;\r\n\r\n    if (fade === undefined) {\r\n        fade = new _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        fade.resetFromJSON(defaultConfig);\r\n    }\r\n    fade.restart();\r\n\r\n    return fade;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (FadeIn);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/fade-in.js?')},"./lib/rexui/plugins/fade-out-destroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fade.js */ "./lib/rexui/plugins/fade.js");\n\r\n\r\nvar FadeOutDestroy = function (gameObject, duration, destroyMode, fade) {\r\n    if (destroyMode instanceof _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"]) {\r\n        fade = destroyMode;\r\n        destroyMode = undefined;\r\n    }\r\n\r\n    if (destroyMode === undefined) {\r\n        destroyMode = true;\r\n    }\r\n\r\n    defaultConfig.mode = (destroyMode) ? 1 : 0;\r\n    defaultConfig.end = 0;\r\n    defaultConfig.duration = duration;\r\n\r\n    if (fade === undefined) {\r\n        fade = new _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        fade.resetFromJSON(defaultConfig);\r\n    }\r\n    fade.restart();\r\n\r\n    return fade;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (FadeOutDestroy);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/fade-out-destroy.js?')},"./lib/rexui/plugins/fade.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_fade_Fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/fade/Fade.js */ "./lib/rexui/plugins/behaviors/fade/Fade.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_fade_Fade_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/fade.js?')},"./lib/rexui/plugins/flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_flip_Flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/flip/Flip.js */ "./lib/rexui/plugins/behaviors/flip/Flip.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_flip_Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/flip.js?')},"./lib/rexui/plugins/fsm.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _logic_fsm_FSM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logic/fsm/FSM.js */ "./lib/rexui/plugins/logic/fsm/FSM.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_logic_fsm_FSM_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/fsm.js?')},"./lib/rexui/plugins/gameobjects/canvas/Canvas.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./render/Render.js */ "./lib/rexui/plugins/gameobjects/canvas/render/Render.js");\n/* harmony import */ var _CanvasMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasMethods.js */ "./lib/rexui/plugins/gameobjects/canvas/CanvasMethods.js");\n/* harmony import */ var _TextureMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TextureMethods.js */ "./lib/rexui/plugins/gameobjects/canvas/TextureMethods.js");\n\r\n\r\n\r\n\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\nconst GameObject = Phaser.GameObjects.GameObject;\r\n\r\nclass Canvas extends GameObject {\r\n    constructor(scene, x, y, width, height) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n        if (width === undefined) {\r\n            width = 1;\r\n        }\r\n        if (height === undefined) {\r\n            height = 1;\r\n        }\r\n\r\n        super(scene, \'rexCanvas\');\r\n\r\n        this.renderer = scene.sys.game.renderer;\r\n\r\n        this.resolution = scene.sys.game.config.resolution;\r\n        this.canvas = CanvasPool.create(this, this.resolution * width, this.resolution * height);\r\n        this.context = this.canvas.getContext(\'2d\');\r\n        this.dirty = false;\r\n\r\n        this.setPosition(x, y);\r\n        this.setSize(width, height);\r\n        this.setOrigin(0.5, 0.5);\r\n        this.initPipeline();\r\n\r\n        this._crop = this.resetCropObject();\r\n\r\n        //  Create a Texture for this Text object\r\n        this.texture = scene.sys.textures.addCanvas(null, this.canvas, true);\r\n\r\n        //  Get the frame\r\n        this.frame = this.texture.get();\r\n\r\n        //  Set the resolution\r\n        this.frame.source.resolution = this.resolution;\r\n\r\n        if (this.renderer && this.renderer.gl) {\r\n            //  Clear the default 1x1 glTexture, as we override it later\r\n            this.renderer.deleteTexture(this.frame.source.glTexture);\r\n            this.frame.source.glTexture = null;\r\n        }\r\n\r\n        this.dirty = true;\r\n\r\n        scene.sys.game.events.on(\'contextrestored\', function () {\r\n            this.dirty = true;\r\n        }, this);\r\n    }\r\n\r\n    getCanvas(readOnly) {\r\n        if (!readOnly) {\r\n            this.dirty = true;\r\n        }\r\n        return this.canvas;\r\n    }\r\n\r\n    needRedraw() {\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n\r\n    preDestroy() {\r\n        CanvasPool.remove(this.canvas);\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        this\r\n            .setSize(width, height)\r\n            .updateDisplayOrigin();\r\n\r\n        width *= this.resolution;\r\n        height *= this.resolution;\r\n        width = Math.max(Math.ceil(width), 1);\r\n        height = Math.max(Math.ceil(height), 1);\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst Components = Phaser.GameObjects.Components;\r\nPhaser.Class.mixin(Canvas,\r\n    [\r\n        Components.Alpha,\r\n        Components.BlendMode,\r\n        Components.ComputedSize,\r\n        Components.Crop,\r\n        Components.Depth,\r\n        Components.Flip,\r\n        Components.GetBounds,\r\n        Components.Mask,\r\n        Components.Origin,\r\n        Components.Pipeline,\r\n        Components.ScrollFactor,\r\n        Components.Tint,\r\n        Components.Transform,\r\n        Components.Visible,\r\n        _render_Render_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n        _CanvasMethods_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n        _TextureMethods_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    ]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Canvas);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/Canvas.js?')},"./lib/rexui/plugins/gameobjects/canvas/CanvasMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst Color = Phaser.Display.Color;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n    fill(color) {\r\n        this.context.fillStyle = color;\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n    getPixel(x, y, out) {\r\n        if (out === undefined) {\r\n            out = new Color();\r\n        }\r\n        var rgb = this.context.getImageData(x, y, 1, 1);\r\n        out.setTo(rgb.data[0], rgb.data[1], rgb.data[2], rgb.data[3])\r\n        return out;\r\n    },\r\n\r\n    setPixel(x, y, r, g, b, a) {\r\n        if (typeof (r) !== 'number') {\r\n            var color = r;\r\n            r = color.red;\r\n            g = color.green;\r\n            b = color.blue;\r\n            a = color.alpha;\r\n        }\r\n\r\n        if (a === undefined) {\r\n            a = ((r !== 0) || (g !== 0) || (b !== 0)) ? 255 : 0;\r\n        }\r\n\r\n        var imgData = this.context.createImageData(1, 1);\r\n        imgData.data[0] = r;\r\n        imgData.data[1] = g;\r\n        imgData.data[2] = b;\r\n        imgData.data[3] = a;\r\n        this.context.putImageData(imgData, x, y);\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/CanvasMethods.js?")},"./lib/rexui/plugins/gameobjects/canvas/TextureMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    updateTexture(callback, scope) {\r\n        if (callback) {\r\n            if (scope) {\r\n                callback.call(scope, this.canvas, this.context);\r\n            } else {\r\n                callback(this.canvas, this.context);\r\n            }\r\n        }\r\n\r\n        if ((this.canvas.width !== this.frame.width) || (this.canvas.height !== this.frame.height)) {\r\n            this.frame.setSize(this.canvas.width, this.canvas.height);\r\n        }\r\n        if (this.renderer.gl) {\r\n            this.frame.source.glTexture = this.renderer.canvasToTexture(this.canvas, this.frame.source.glTexture, true);\r\n            this.frame.glTexture = this.frame.source.glTexture;\r\n        }\r\n        this.dirty = false;\r\n\r\n        var input = this.input;\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = this.width;\r\n            input.hitArea.height = this.height;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    generateTexture(key, x, y, width, height) {\r\n        var srcCanvas = this.canvas;\r\n        var sys = this.scene.sys;\r\n        var renderer = sys.game.renderer;\r\n        var texture;\r\n\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        if (width === undefined) {\r\n            width = srcCanvas.width;\r\n        } else {\r\n            width *= this.resolution;\r\n        }\r\n\r\n        if (height === undefined) {\r\n            height = srcCanvas.height;\r\n        } else {\r\n            height *= this.resolution;\r\n        }\r\n\r\n\r\n        if (sys.textures.exists(key)) {\r\n            texture = sys.textures.get(key);\r\n        } else {\r\n            texture = sys.textures.createCanvas(key, width, height);\r\n        }\r\n\r\n        var destCanvas = texture.getSourceImage();\r\n        if (destCanvas.width !== width) {\r\n            destCanvas.width = width;\r\n        }\r\n        if (destCanvas.height !== height) {\r\n            destCanvas.height = height;\r\n        }\r\n\r\n        var destCtx = destCanvas.getContext('2d');\r\n        destCtx.clearRect(0, 0, width, height);\r\n        destCtx.drawImage(srcCanvas, x, y, width, height);\r\n        if (renderer.gl && texture) {\r\n            renderer.canvasToTexture(destCanvas, texture.source[0].glTexture, true, 0);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    loadTexture(key, frame) {\r\n        var textureFrame = this.scene.textures.getFrame(key, frame);\r\n        if (!textureFrame) {\r\n            return this;\r\n        }\r\n\r\n        if ((this.width !== textureFrame.cutWidth) || (this.height !== textureFrame.cutHeight)) {\r\n            this.resize(textureFrame.cutWidth, textureFrame.cutHeight);\r\n        } else {\r\n            this.context.clearRect(0, 0, textureFrame.cutWidth, textureFrame.cutHeight);\r\n        }\r\n        this.context.drawImage(textureFrame.source.image,\r\n            textureFrame.cutX, textureFrame.cutY, textureFrame.cutWidth, textureFrame.cutHeight,\r\n            0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/TextureMethods.js?")},"./lib/rexui/plugins/gameobjects/canvas/render/CanvasRenderer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// copy from Phaser.GameObjects.Text\r\n\r\nvar CanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n    renderer.batchSprite(src, src.frame, camera, parentMatrix);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CanvasRenderer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/render/CanvasRenderer.js?')},"./lib/rexui/plugins/gameobjects/canvas/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/plugins/gameobjects/canvas/render/WebGLRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/plugins/gameobjects/canvas/render/CanvasRenderer.js");\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__["default"];\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__["default"];\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/render/Render.js?')},"./lib/rexui/plugins/gameobjects/canvas/render/WebGLRenderer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// copy from Phaser.GameObjects.Text\r\n\r\nconst Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\nvar WebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if (src.dirty) {\r\n        src.updateTexture();\r\n        src.dirty = false;\r\n    }\r\n\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    var frame = src.frame;\r\n    var width = frame.width;\r\n    var height = frame.height;\r\n    var getTint = Utils.getTintAppendFloatAlpha;\r\n\r\n    this.pipeline.batchTexture(\r\n        src,\r\n        frame.glTexture,\r\n        width, height,\r\n        src.x, src.y,\r\n        width / src.resolution, height / src.resolution,\r\n        src.scaleX, src.scaleY,\r\n        src.rotation,\r\n        src.flipX, src.flipY,\r\n        src.scrollFactorX, src.scrollFactorY,\r\n        src.displayOriginX, src.displayOriginY,\r\n        0, 0, width, height,\r\n        getTint(src._tintTL, camera.alpha * src._alphaTL),\r\n        getTint(src._tintTR, camera.alpha * src._alphaTR),\r\n        getTint(src._tintBL, camera.alpha * src._alphaBL),\r\n        getTint(src._tintBR, camera.alpha * src._alphaBR),\r\n        (src._isTinted && src.tintFill),\r\n        0, 0,\r\n        camera,\r\n        parentMatrix\r\n    );\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (WebGLRenderer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/canvas/render/WebGLRenderer.js?')},"./lib/rexui/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar CircleMask = function (canvas, maskType) {\r\n    if (canvas.width === canvas.height) {\r\n        maskType = 0;\r\n    }\r\n\r\n    var x = Math.floor(canvas.width / 2);\r\n    var y = Math.floor(canvas.height / 2);\r\n\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.save();\r\n    ctx.globalCompositeOperation = 'destination-in';\r\n    ctx.beginPath();\r\n    if (maskType === 0) {\r\n        ctx.arc(x, y, Math.min(x, y), 0, 2 * Math.PI);\r\n    } else {\r\n        ctx.ellipse(x, y, x, y, 0, 0, 2 * Math.PI);\r\n    }\r\n    ctx.fill();\r\n    ctx.restore();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CircleMask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js?")},"./lib/rexui/plugins/gameobjects/circlemaskimage/CircleMaskImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../canvas/Canvas.js */ "./lib/rexui/plugins/gameobjects/canvas/Canvas.js");\n/* harmony import */ var _ApplyCircleMask_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ApplyCircleMask.js */ "./lib/rexui/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass CircleMaskImage extends _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, key, frame, config) {\r\n        super(scene, x, y);\r\n\r\n        this.type = \'rexCircleMaskImage\';\r\n        var maskType = GetValue(config, \'maskType\', 0);\r\n        this.setTexture(key, frame, maskType);\r\n    }\r\n\r\n    setTexture(key, frame, maskType) {\r\n        if (maskType === undefined) {\r\n            maskType = 0;\r\n        } else if (typeof (maskType) === \'string\') {\r\n            maskType = MASKTYPE[maskType];\r\n        }\r\n\r\n        this._textureKey = key;\r\n        this._frameName = frame;\r\n        this.loadTexture(key, frame);\r\n\r\n        if (maskType !== null) {\r\n            Object(_ApplyCircleMask_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.canvas, maskType);\r\n        }\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst MASKTYPE = {\r\n    circle: 0,\r\n    ellipse: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CircleMaskImage);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/circlemaskimage/CircleMaskImage.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Active.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildActive(child) {\r\n        child.active = this.active && this.getLocalState(child).active;\r\n        return this;\r\n    },\r\n\r\n    syncActive() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildActive, this);\r\n        }\r\n        return this;\r\n    },\r\n    \r\n    resetChildActiveState(gameObject) {\r\n        this.getLocalState(gameObject).active = gameObject.active;\r\n        return this;\r\n    },\r\n\r\n    setChildActive(gameObject, active) {\r\n        gameObject.active = active;\r\n        this.resetChildActiveState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    setChildLocalActive(gameObject, active) {\r\n        if (active === undefined) {\r\n            active = true;\r\n        }\r\n        this.getLocalState(gameObject).active = active;\r\n        this.updateChildActive(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Active.js?')},"./lib/rexui/plugins/gameobjects/containerlite/AddChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    add(gameObject) {\r\n        if (Array.isArray(gameObject)) {\r\n            this.addMultiple(gameObject);\r\n        } else {\r\n            this._add(gameObject);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addMultiple(gameObjects) {\r\n        gameObjects.forEach(this._add, this);\r\n        return this;\r\n    },\r\n\r\n    _add(gameObject) {\r\n        this.children.add(gameObject);\r\n\r\n        this\r\n            .resetChildState(gameObject)           // Reset local state of child\r\n            .updateChildVisible(gameObject)        // Apply parent's visible to child\r\n            .updateChildActive(gameObject)         // Apply parent's active to child\r\n            .updateChildScrollFactor(gameObject)   // Apply parent's scroll factor to child\r\n            .updateChildMask(gameObject);          // Apply parent's mask to child\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/AddChild.js?")},"./lib/rexui/plugins/gameobjects/containerlite/Alpha.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Scale.js */ "./lib/rexui/plugins/gameobjects/containerlite/Scale.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildAlpha(child) {\r\n        child.alpha = this.alpha * this.getLocalState(child).alpha;\r\n        return this;\r\n    },\r\n\r\n    syncAlpha() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildAlpha, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildAlphaState(gameObject) {\r\n        this.getLocalState(gameObject).alpha = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.alpha, this.alpha);\r\n        return this;\r\n    },\r\n    \r\n    setChildAlpha(gameObject, alpha) {\r\n        gameObject.alpha = alpha;\r\n        this.resetChildAlphaState(gameObject);\r\n        return this._add;\r\n    },\r\n    \r\n    setChildLocalAlpha(gameObject, alpha) {\r\n        this.getLocalState(gameObject).alpha = alpha;\r\n        this.updateChildAlpha(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Alpha.js?')},"./lib/rexui/plugins/gameobjects/containerlite/ChildState.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    getLocalState(gameObject) {\r\n        if (!gameObject.hasOwnProperty('rexContainer')) {\r\n            gameObject.rexContainer = {};\r\n        }\r\n        return gameObject.rexContainer;\r\n    },\r\n\r\n    resetChildState(gameObject) {\r\n        this\r\n            .resetChildPositionState(gameObject)\r\n            .resetChildVisibleState(gameObject)\r\n            .resetChildAlphaState(gameObject)\r\n            .resetChildActiveState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    resetChildrenState(gameObjects) {\r\n        for (var i = 0, cnt = gameObjects.length; i < cnt; i++) {\r\n            this.resetChildState(gameObjects[i]);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncProperties() {\r\n        this\r\n            .syncPosition()\r\n            .syncVisible()\r\n            .syncAlpha()\r\n            .syncActive()\r\n            .syncScrollFactor()\r\n            .syncMask();\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/ChildState.js?")},"./lib/rexui/plugins/gameobjects/containerlite/Children.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst ArrayUtils = Phaser.Utils.Array;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    getChildren() {\r\n        return this.children.getChildren();\r\n    },\r\n\r\n    getAllChildren(out) {\r\n        if (out === undefined) {\r\n            out = [];\r\n        }\r\n        var myCildren = this.children.getChildren(),\r\n            myChild;\r\n        for (var i = 0, cnt = myCildren.length; i < cnt; i++) {\r\n            myChild = myCildren[i];\r\n            out.push(myChild);\r\n\r\n            if (myChild.hasOwnProperty('isRexContainerLite')) {\r\n                out.push(...myChild.getAllChildren());\r\n            }\r\n        }\r\n\r\n        return out;\r\n    },\r\n\r\n    contains(gameObject) {\r\n        if (this.children.contains(gameObject)) {\r\n            return true;\r\n        }\r\n\r\n        var myCildren = this.children.getChildren(),\r\n            myChild;\r\n        for (var i = 0, cnt = myCildren.length; i < cnt; i++) {\r\n            myChild = myCildren[i];\r\n\r\n            if (myChild.isRexContainerLite) {\r\n                if (myChild.contains(gameObject)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    getByName(name) {\r\n        return ArrayUtils.GetFirst(this.list, 'name', name);\r\n    },\r\n\r\n    getRandom(startIndex, length) {\r\n        return ArrayUtils.GetRandom(this.list, startIndex, length);\r\n    },\r\n\r\n    getFirst(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.GetFirstElement(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    getAll(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.GetAll(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    count(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.CountAllMatching(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    swap(child1, child2) {\r\n        ArrayUtils.Swap(this.list, child1, child2);\r\n        return this;\r\n    },\r\n\r\n    moveTo(child, index) {\r\n        ArrayUtils.MoveTo(this.list, child, index);\r\n        return this;\r\n    },\r\n\r\n    setAll(property, value, startIndex, endIndex) {\r\n        ArrayUtils.SetAll(this.list, property, value, startIndex, endIndex);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Children.js?")},"./lib/rexui/plugins/gameobjects/containerlite/ContainerLite.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AddChild_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AddChild.js */ "./lib/rexui/plugins/gameobjects/containerlite/AddChild.js");\n/* harmony import */ var _RemoveChild_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RemoveChild.js */ "./lib/rexui/plugins/gameobjects/containerlite/RemoveChild.js");\n/* harmony import */ var _ChildState_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ChildState.js */ "./lib/rexui/plugins/gameobjects/containerlite/ChildState.js");\n/* harmony import */ var _Transform_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Transform.js */ "./lib/rexui/plugins/gameobjects/containerlite/Transform.js");\n/* harmony import */ var _Position_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Position.js */ "./lib/rexui/plugins/gameobjects/containerlite/Position.js");\n/* harmony import */ var _Visible_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Visible.js */ "./lib/rexui/plugins/gameobjects/containerlite/Visible.js");\n/* harmony import */ var _Alpha_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Alpha.js */ "./lib/rexui/plugins/gameobjects/containerlite/Alpha.js");\n/* harmony import */ var _Active_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Active.js */ "./lib/rexui/plugins/gameobjects/containerlite/Active.js");\n/* harmony import */ var _ScrollFactor_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ScrollFactor.js */ "./lib/rexui/plugins/gameobjects/containerlite/ScrollFactor.js");\n/* harmony import */ var _Mask_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Mask.js */ "./lib/rexui/plugins/gameobjects/containerlite/Mask.js");\n/* harmony import */ var _Depth_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Depth.js */ "./lib/rexui/plugins/gameobjects/containerlite/Depth.js");\n/* harmony import */ var _Children_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Children.js */ "./lib/rexui/plugins/gameobjects/containerlite/Children.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst Zone = Phaser.GameObjects.Zone;\r\nconst Components = Phaser.GameObjects.Components;\r\n\r\nclass ContainerLite extends Zone {\r\n    constructor(scene, x, y, width, height, children) {\r\n        if (Array.isArray(width)) {\r\n            children = width;\r\n            width = undefined;\r\n        }\r\n        if (width === undefined) {\r\n            width = 1;\r\n        }\r\n        if (height === undefined) {\r\n            height = 1;\r\n        }\r\n        super(scene, x, y, width, height);\r\n        this.children = scene.add.group();\r\n        this.type = \'rexContainerLite\';\r\n        this.isRexContainerLite = true;\r\n        this.syncChildrenEnable = true;\r\n\r\n        this._flipX = false;\r\n        this._flipY = false;\r\n        this._alpha = 1;\r\n        this._active = true;\r\n        this._mask = null;\r\n        this._scrollFactorX = 1;\r\n        this._scrollFactorY = 1;\r\n\r\n        if (children) {\r\n            this.add(children);\r\n        }\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        this.children.destroy(!fromScene);\r\n        this.children = undefined;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    resize(width, height) {\r\n        this.setSize(width, height);\r\n        return this;\r\n    }\r\n\r\n    get x() {\r\n        return this._x;\r\n    }\r\n\r\n    set x(value) {\r\n        if (this._x === value) {\r\n            return;\r\n        }\r\n        this._x = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    get y() {\r\n        return this._y;\r\n    }\r\n\r\n    set y(value) {\r\n        if (this._y === value) {\r\n            return;\r\n        }\r\n        this._y = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get rotation() {\r\n        return super.rotation;\r\n    }\r\n\r\n    set rotation(value) {\r\n        if (this.rotation === value) {\r\n            return;\r\n        }\r\n        super.rotation = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get scaleX() {\r\n        return super.scaleX;\r\n    }\r\n\r\n    set scaleX(value) {\r\n        if (this.scaleX === value) {\r\n            return;\r\n        }\r\n        super.scaleX = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get scaleY() {\r\n        return super.scaleY;\r\n    }\r\n\r\n    set scaleY(value) {\r\n        if (this.scaleY === value) {\r\n            return;\r\n        }\r\n        super.scaleY = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get flipX() {\r\n        return this._flipX;\r\n    }\r\n\r\n    set flipX(value) {\r\n        if (this._flipX === value) {\r\n            return;\r\n        }\r\n        this._flipX = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get flipY() {\r\n        return this._flipY;\r\n    }\r\n\r\n    set flipY(value) {\r\n        if (this._flipY === value) {\r\n            return;\r\n        }\r\n        this._flipY = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get visible() {\r\n        return super.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        if (this.visible === value) {\r\n            return;\r\n        }\r\n        super.visible = value;\r\n\r\n        this.syncVisible();\r\n    }\r\n\r\n    // Override\r\n    get alpha() {\r\n        return this._alpha;\r\n    }\r\n\r\n    set alpha(value) {\r\n        if (this._alpha === value) {\r\n            return;\r\n        }\r\n        this._alpha = value;\r\n\r\n        this.syncAlpha();\r\n    }\r\n\r\n    // Override\r\n    get active() {\r\n        return this._active;\r\n    }\r\n\r\n    set active(value) {\r\n        if (this._active === value) {\r\n            return;\r\n        }\r\n        this._active = value;\r\n\r\n        this.syncActive();\r\n    }\r\n\r\n    // Override\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    set mask(mask) {\r\n        if (this._mask === mask) {\r\n            return;\r\n        }\r\n        this._mask = mask;\r\n\r\n        this.syncMask();\r\n    }\r\n\r\n    // Override\r\n    get scrollFactorX() {\r\n        return this._scrollFactorX;\r\n    }\r\n\r\n    set scrollFactorX(value) {\r\n        if (this._scrollFactorX === value) {\r\n            return;\r\n        }\r\n\r\n        this._scrollFactorX = value;\r\n        this.syncScrollFactor();\r\n    }\r\n    get scrollFactorY() {\r\n        return this._scrollFactorY;\r\n    }\r\n\r\n    set scrollFactorY(value) {\r\n        if (this._scrollFactorY === value) {\r\n            return;\r\n        }\r\n\r\n        this._scrollFactorY = value;\r\n        this.syncScrollFactor();\r\n    }\r\n\r\n    // Compatiable with container plugin\r\n    get list() {\r\n        return this.children.getChildren();\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    ContainerLite.prototype,\r\n    _AddChild_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    _RemoveChild_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    _ChildState_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    _Transform_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    _Position_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    _Visible_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n    _Alpha_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    _ScrollFactor_js__WEBPACK_IMPORTED_MODULE_8__["default"],\r\n    _Active_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n    _Mask_js__WEBPACK_IMPORTED_MODULE_9__["default"],\r\n    _Depth_js__WEBPACK_IMPORTED_MODULE_10__["default"],\r\n    _Children_js__WEBPACK_IMPORTED_MODULE_11__["default"],\r\n\r\n    Components.Alpha,\r\n    Components.Flip,\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ContainerLite);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/ContainerLite.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Depth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setDepth(value) {\r\n        this.depth = value;\r\n        if (this.children) {\r\n            var children = this.getAllChildren();\r\n            for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n                children[i].depth = value;\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    swapDepth(containerB) {\r\n        var depthA = this.depth;\r\n        var depthB = containerB.depth;\r\n        this.setDepth(depthB);\r\n        containerB.setDepth(depthA);\r\n        return this;\r\n    },\r\n\r\n    incDepth(inc) {\r\n        this.depth += inc;\r\n        if (this.children) {\r\n            var children = this.getAllChildren();\r\n            for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n                children[i].depth += inc;\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Depth.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Mask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    updateChildMask(child) {\r\n        // Don't propagate null mask to clear children's mask\r\n        if (this.mask == null) {\r\n            return this;\r\n        }\r\n\r\n        var maskGameObject = (this.mask.hasOwnProperty('geometryMask')) ? this.mask.geometryMask : this.mask.bitmapMask;\r\n        if (maskGameObject !== child) {\r\n            child.mask = this.mask;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncMask() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildMask, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    setMask(mask) {\r\n        this.mask = mask;\r\n        return this;\r\n    },\r\n\r\n    clearMask(destroyMask) {\r\n        if (destroyMask === undefined) {\r\n            destroyMask = false;\r\n        }\r\n\r\n        if (destroyMask && this.mask) {\r\n            this.mask.destroy();\r\n        }\r\n        this.mask = null;\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Mask.js?")},"./lib/rexui/plugins/gameobjects/containerlite/MaskChildren.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/mask/MaskToGameObject.js */ "./lib/rexui/plugins/utils/mask/MaskToGameObject.js");\n\r\n\r\nconst Intersects = Phaser.Geom.Intersects.RectangleToRectangle;\r\nconst Overlaps = Phaser.Geom.Rectangle.Overlaps;\r\n\r\nvar MaskChildren = function (parent, mask, children) {\r\n    if (!mask) {\r\n        return;\r\n    }\r\n\r\n    if (children === undefined) {\r\n        children = parent.getAllChildren();\r\n    }\r\n\r\n    var parentBounds = parent.getBounds();\r\n    var maskGameObject = Object(_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(mask);\r\n\r\n    var child, childBounds, visiblePointsNumber;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.hasOwnProperty(\'isRexContainerLite\')) {\r\n            continue;\r\n        }\r\n        if (child === maskGameObject) {\r\n            continue;\r\n        }\r\n\r\n        if (child.getBounds) {\r\n            childBounds = child.getBounds(childBounds);\r\n            visiblePointsNumber = containsPoints(parentBounds, childBounds);\r\n            switch (visiblePointsNumber) {\r\n                case 4: // 4 points are all inside visible window, set visible\r\n                    showAll(child, mask);\r\n                    break;\r\n                case 0: // No point is inside visible window\r\n                    // Parent intersects with child, or parent is inside child, set visible, and apply mask\r\n                    if (Intersects(parentBounds, childBounds) || Overlaps(parentBounds, childBounds)) {\r\n                        showSome(child, mask);\r\n                    } else { // Set invisible\r\n                        showNone(child, mask);\r\n                    }\r\n                    break;\r\n                default: // Part of points are inside visible window, set visible, and apply mask\r\n                    showSome(child, mask);\r\n                    break;\r\n            }\r\n        } else {\r\n            showSome(child, mask);\r\n        }\r\n\r\n        parent\r\n            .resetChildVisibleState(child) // Reset local visible via child\'s visible\r\n            .updateChildVisible(child);  // Set child\'s visible via parent and local visible\r\n    }\r\n}\r\n\r\nvar containsPoints = function (rectA, rectB) {\r\n    var result = 0;\r\n    var top = rectB.top,\r\n        bottom = rectB.bottom,\r\n        left = rectB.left,\r\n        right = rectB.right;\r\n    result += rectA.contains(left, top) ? 1 : 0;\r\n    result += rectA.contains(left, bottom) ? 1 : 0;\r\n    result += rectA.contains(right, top) ? 1 : 0;\r\n    result += rectA.contains(right, bottom) ? 1 : 0;\r\n    return result;\r\n};\r\n\r\nvar showAll = function (child, mask) {\r\n    child.setVisible(true).clearMask();\r\n}\r\n\r\nvar showSome = function (child, mask) {\r\n    child.setVisible(true).setMask(mask);\r\n}\r\n\r\nvar showNone = function (child, mask) {\r\n    child.setVisible(false).clearMask();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (MaskChildren);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/MaskChildren.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Position.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Scale.js */ "./lib/rexui/plugins/gameobjects/containerlite/Scale.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildPosition(child) {\r\n        if (child.isRexContainerLite) {\r\n            child.syncChildrenEnable = false;\r\n        }\r\n        var state = this.getLocalState(child);\r\n        child.x = state.x;\r\n        child.y = state.y;\r\n        this.localToWorld(child);\r\n\r\n        child.scaleX = state.scaleX * this.scaleX;\r\n        child.scaleY = state.scaleY * this.scaleY;\r\n\r\n        if (child.flipX !== undefined) {\r\n            child.flipX = (!this.flipX) ? state.flipX : !state.flipX;\r\n            child.flipY = (!this.flipY) ? state.flipY : !state.flipY;\r\n        }\r\n\r\n        child.rotation = state.rotation + this.rotation;\r\n\r\n        if (child.isRexContainerLite) {\r\n            child.syncChildrenEnable = true;\r\n            child.syncPosition();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncPosition() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildPosition, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildPositionState(gameObject) {\r\n        var state = this.getLocalState(gameObject);\r\n        state.x = gameObject.x;\r\n        state.y = gameObject.y;\r\n        this.worldToLocal(state);\r\n\r\n        state.scaleX = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.scaleX, this.scaleX);\r\n        state.scaleY = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.scaleY, this.scaleY);\r\n\r\n        if (gameObject.flipX !== undefined) {\r\n            state.flipX = gameObject.flipX;\r\n            state.flipY = gameObject.flipY;\r\n        }\r\n\r\n        state.rotation = gameObject.rotation - this.rotation;\r\n        return this;\r\n    },\r\n    \r\n    setChildPosition(gameObject, x, y) {\r\n        gameObject.x = x;\r\n        gameObject.y = y;\r\n        this.resetChildPositionState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    setChildLocalPosition(gameObject, x, y) {\r\n        var state = this.getLocalState(gameObject);\r\n        state.x = x;\r\n        state.y = y;\r\n        this.updateChildPosition(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Position.js?')},"./lib/rexui/plugins/gameobjects/containerlite/RemoveChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    remove(gameObject, destroyChild) {\r\n        this.children.remove(gameObject, false, destroyChild);\r\n        return this;\r\n    },\r\n\r\n    clear(destroyChild) {\r\n        this.children.clear(false, destroyChild);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/RemoveChild.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Scale = function (a, b) {\r\n    if (a === b) {\r\n        return 1;\r\n    } else {\r\n        return a / b;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Scale);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Scale.js?')},"./lib/rexui/plugins/gameobjects/containerlite/ScrollFactor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildScrollFactor(child) {\r\n        child.setScrollFactor(this.scrollFactorX, this.scrollFactorY);\r\n        return this;\r\n    },\r\n\r\n    syncScrollFactor() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildScrollFactor, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/ScrollFactor.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Transform.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst RotateAround = Phaser.Math.RotateAround;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    worldToLocal(point) {\r\n        // Transform\r\n        point.x -= this.x;\r\n        point.y -= this.y;\r\n        // Rotate\r\n        RotateAround(point, 0, 0, -this.rotation);\r\n        // Scale\r\n        point.x /= this.scaleX;\r\n        point.y /= this.scaleY;\r\n        // Flip\r\n        point.x *= ((!this.flipX) ? 1 : -1);\r\n        point.y *= ((!this.flipY) ? 1 : -1);\r\n        return point;\r\n    },\r\n\r\n    localToWorld(point) {\r\n        // Flip\r\n        point.x *= ((!this.flipX) ? 1 : -1);\r\n        point.y *= ((!this.flipY) ? 1 : -1);\r\n        // Scale\r\n        point.x *= this.scaleX;\r\n        point.y *= this.scaleY;\r\n        // Rotate\r\n        RotateAround(point, 0, 0, this.rotation);\r\n        // Transform\r\n        point.x += this.x;\r\n        point.y += this.y;\r\n        return point;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Transform.js?')},"./lib/rexui/plugins/gameobjects/containerlite/Visible.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildVisible(child) {\r\n        child.visible = this.visible && this.getLocalState(child).visible;\r\n        return this;\r\n    },\r\n\r\n    syncVisible() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildVisible, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildVisibleState(gameObject) {\r\n        this.getLocalState(gameObject).visible = gameObject.visible;\r\n        return this;\r\n    },\r\n\r\n    setChildVisible(gameObject, visible) {\r\n        gameObject.visible = visible;\r\n        this.resetChildVisibleState(gameObject);\r\n        return this;\r\n    },\r\n    \r\n    setChildLocalVisible(gameObject, visible) {\r\n        if (visible === undefined) {\r\n            visible = true;\r\n        }\r\n        this.getLocalState(gameObject).visible = visible;\r\n        this.updateChildVisible(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/containerlite/Visible.js?')},"./lib/rexui/plugins/gameobjects/gridtable/Cell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_data_DataMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/data/DataMethods.js */ "./lib/rexui/plugins/utils/data/DataMethods.js");\n\r\n\r\nclass Cell {\r\n    constructor(parent, config) {\r\n        this.container = null;\r\n        this.setParent(parent);\r\n        this._deltaHeight = 0;\r\n        //this.resetFromJSON(config);\r\n    }\r\n\r\n    setParent(parent) {\r\n        this.parent = parent; // parent: table\r\n        this.parentContainer = parent.getParentContainer();\r\n    }\r\n\r\n    //resetFromJSON(o) {\r\n    //    return this;\r\n    //}\r\n\r\n    destroy(fromScene) {\r\n        if (fromScene === undefined) {\r\n            fromScene = false;\r\n        }\r\n\r\n        if (!fromScene) {\r\n            var table = this.parent;\r\n            if (this.deltaHeight !== 0) {\r\n                table.nonZeroDeltaHeightCount--;\r\n            }\r\n            this.destroyContainer();\r\n        }\r\n\r\n        this.data = undefined;\r\n        this.container = null;\r\n        this.parent = undefined;\r\n        this.parentContainer = undefined;\r\n    }\r\n\r\n    get table() {\r\n        return this.parent;\r\n    }\r\n\r\n    get scrollMode() {\r\n        return this.parentContainer.scrollMode;\r\n    }\r\n\r\n    get colIndx() {\r\n        return this.parent.cellIndxeToColIndex(this.index);\r\n    }\r\n\r\n    get rowIndx() {\r\n        return this.parent.cellIndxeToRowIndex(this.index);\r\n    }\r\n\r\n    getContainer() {\r\n        return this.container;\r\n    }\r\n\r\n    setContainer(container) {\r\n        if (this.container) {\r\n            this.container.destroy();\r\n        }\r\n        this.container = container;\r\n        this.parentContainer.add(container);\r\n        return this;\r\n    }\r\n\r\n    destroyContainer() {\r\n        if (this.container) {\r\n            this.container.destroy();\r\n            this.container = null;\r\n        }\r\n        return this;        \r\n    }\r\n\r\n    popContainer() {\r\n        if (this.container) {\r\n            var container = this.container;\r\n            this.container = null;\r\n            this.parentContainer.remove(container);\r\n            return container;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    setXY(x, y) {\r\n        if (this.container) {\r\n            this.parentContainer.setChildLocalPosition(this.container, x, y);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get deltaHeight() {\r\n        return this._deltaHeight;\r\n    }\r\n\r\n    set deltaHeight(deltaHeight) {\r\n        if (deltaHeight == null) {\r\n            deltaHeight = 0;\r\n        }\r\n        var table = this.parent;\r\n        if ((this._deltaHeight === 0) && (deltaHeight !== 0)) {\r\n            table.nonZeroDeltaHeightCount++;\r\n        } else if ((this._deltaHeight !== 0) && (deltaHeight === 0)) {\r\n            table.nonZeroDeltaHeightCount--;\r\n        }\r\n\r\n        this._deltaHeight = deltaHeight;\r\n    }\r\n\r\n    setDeltaHeight(deltaHeight) {\r\n        this.deltaHeight = deltaHeight;\r\n        return this;\r\n    }\r\n\r\n    get height() {\r\n        if (this.scrollMode === 0) {\r\n            return this.deltaHeight + this.parent.defaultCellHeight;\r\n        } else {\r\n            return this.parent.defaultCellWidth;\r\n        }\r\n    }\r\n\r\n    set height(height) {\r\n        // Only worked when scrollMode is 0\r\n        if (this.scrollMode === 1) {\r\n            return;\r\n        }\r\n        this.setDeltaHeight(height - this.parent.defaultCellHeight);\r\n    }\r\n\r\n    setHeight(height) {\r\n        // Only worked when scrollMode is 0\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    get width() {\r\n        if (this.scrollMode === 0) {\r\n            return this.parent.defaultCellWidth;\r\n        } else {\r\n            return this.deltaHeight + this.parent.defaultCellHeight;\r\n        }\r\n    }\r\n\r\n    set width(width) {\r\n        // Only worked when scrollMode is 1\r\n        if (this.scrollMode === 0) {\r\n            return;\r\n        }\r\n        this.setDeltaHeight(width - this.parent.defaultCellHeight);\r\n    }\r\n\r\n    setWidth(width) {\r\n        this.width = width;\r\n        return this;\r\n    }\r\n\r\n    get scene() {\r\n        return this.parentContainer.scene;\r\n    }\r\n};\r\n\r\n\r\nObject.assign(\r\n    Cell.prototype,\r\n    _utils_data_DataMethods_js__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n);\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Cell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/gridtable/Cell.js?')},"./lib/rexui/plugins/gameobjects/gridtable/GridTable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../containerlite/ContainerLite.js */ \"./lib/rexui/plugins/gameobjects/containerlite/ContainerLite.js\");\n/* harmony import */ var _Table_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Table.js */ \"./lib/rexui/plugins/gameobjects/gridtable/Table.js\");\n/* harmony import */ var _utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/mask/DefaultMask.js */ \"./lib/rexui/plugins/utils/mask/DefaultMask.js\");\n/* harmony import */ var _utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/size/ResizeGameObject.js */ \"./lib/rexui/plugins/utils/size/ResizeGameObject.js\");\n/* harmony import */ var _utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/mask/MaskToGameObject.js */ \"./lib/rexui/plugins/utils/mask/MaskToGameObject.js\");\n/* harmony import */ var _containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../containerlite/MaskChildren.js */ \"./lib/rexui/plugins/gameobjects/containerlite/MaskChildren.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst Container = _containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\r\nconst Components = Phaser.GameObjects.Components;\r\nconst Set = Phaser.Structs.Set;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\n\r\nclass GridTable extends Container {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        super(scene, x, y, width, height);\r\n        this.type = 'rexGridTable';\r\n        this._tableOX = 0;\r\n        this._tableOY = 0;\r\n        this.visibleCells = new Set();\r\n        this.preVisibleCells = new Set();\r\n        this.visibleStartX = null;\r\n        this.visibleEndX = null;\r\n        this.visibleStartY = null;\r\n        this.visibleEndY = null;\r\n        this.lastVisibleCellIdx = null;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n        this.execeedLeftState = false;\r\n        this.execeedRightState = false;\r\n\r\n        var reuseCellContainer = GetValue(config, 'reuseCellContainer', false);\r\n        this.cellContainersPool = (reuseCellContainer) ? scene.add.group() : undefined;\r\n\r\n        var callback = GetValue(config, 'cellVisibleCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'cellVisibleCallbackScope', undefined);\r\n            this.on('cellvisible', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'cellInvisibleCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'cellInvisibleCallbackScope', undefined);\r\n            this.on('cellinvisible', callback, scope);\r\n        }\r\n\r\n        this.cellsMask = undefined;\r\n        this.setCellsMask(GetValue(config, 'mask', true));\r\n\r\n        this.setScrollMode(GetValue(config, 'scrollMode', 0));\r\n        this.setClampMode(GetValue(config, 'clamplTableOXY', true));\r\n\r\n        // Pre-process cell size\r\n        if (this.scrollMode === 0) { // scroll y\r\n            var cellWidth = GetValue(config, 'cellWidth', undefined);\r\n            this.expandCellSize = (cellWidth === undefined);\r\n            if (cellWidth === undefined) {\r\n                var columns = GetValue(config, 'columns', 1);\r\n                config.cellWidth = this.width / columns;\r\n            }\r\n        } else { // scroll x\r\n            // Swap cell width and cell height\r\n            var cellWidth = GetValue(config, 'cellHeight', undefined);\r\n            var cellHeight = GetValue(config, 'cellWidth', undefined);\r\n            this.expandCellSize = (cellWidth === undefined);\r\n            config.cellWidth = cellWidth;\r\n            config.cellHeight = cellHeight;\r\n        }\r\n        this.table = new _Table_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, config);\r\n\r\n        this.updateTable();\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        if (!fromScene) {\r\n            // Recycle cell containers\r\n            this.setCellsCount(0);\r\n        }\r\n\r\n        this.table.destroy(fromScene);\r\n        this.table = undefined;\r\n        if (this.cellContainersPool) {\r\n            this.cellContainersPool.destroy(true);\r\n            this.cellContainersPool = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setScrollMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = SCROLLMODE[mode.toLowerCase()];\r\n        }\r\n        this.scrollMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampTableOXYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setCellsCount(count) {\r\n        var cellsCount = this.cellsCount;\r\n        if (cellsCount === count) {\r\n            return this;\r\n        }\r\n\r\n        if (cellsCount > count) {\r\n            this.removeCell(count, cellsCount - count);\r\n        } else { // cellsCount < count\r\n            this.insertNewCell(cellsCount, count - cellsCount);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setColumnCount(count) {\r\n        if (this.table.colCount === count) {\r\n            return this;\r\n        }\r\n        this.table.setColumnCount(count);\r\n        return this;\r\n    }\r\n\r\n    setGridSize(colCount, rowCount) {\r\n        this.setCellsCount(colCount * rowCount);\r\n        this.table.setColumnCount(colCount);\r\n        return this;\r\n    }\r\n\r\n    insertNewCell(cellIdx, count) {\r\n        if (typeof (cellIdx) === 'object') {\r\n            cellIdx = cellIdx.index;\r\n        }\r\n        if (count === undefined) {\r\n            count = 1;\r\n        }\r\n        if (count <= 0) {\r\n            return this;\r\n        }\r\n        cellIdx = Clamp(cellIdx, 0, this.cellsCount);\r\n        this.table.insertNewCell(cellIdx, count);\r\n        return this;\r\n    }\r\n\r\n    removeCell(cellIdx, count) {\r\n        if (typeof (cellIdx) === 'object') {\r\n            cellIdx = cellIdx.index;\r\n        }\r\n        if (count === undefined) {\r\n            count = 1;\r\n        }\r\n        if (cellIdx < 0) {\r\n            count += cellIdx;\r\n            cellIdx = 0;\r\n        }\r\n        if (count <= 0) {\r\n            return this;\r\n        }\r\n        // out-of-range\r\n        if (cellIdx > this.cellsCount) {\r\n            return this;\r\n        }\r\n\r\n        if (cellIdx <= this.lastVisibleCellIdx) {\r\n            var preList = this.preVisibleCells;\r\n            var curList = this.visibleCells;\r\n            var cell;\r\n            for (var i = cellIdx, endIdx = cellIdx + count; i < endIdx; i++) {\r\n                cell = this.getCell(i, false);\r\n                if (cell) {\r\n                    if (curList.contains(cell)) {\r\n                        this.hideCell(cell);\r\n                        curList.delete(cell);\r\n                    }\r\n                    preList.delete(cell);\r\n                }\r\n            }\r\n        }\r\n\r\n        this.table.removeCell(cellIdx, count);\r\n        return this;\r\n    }\r\n\r\n    get tableOY() {\r\n        return this._tableOY;\r\n    }\r\n\r\n    get tableOX() {\r\n        return this._tableOX;\r\n    }\r\n\r\n    set tableOY(oy) {\r\n        this.setTableOY(oy).updateTable();\r\n    }\r\n\r\n    set tableOX(ox) {\r\n        this.setTableOX(ox).updateTable();\r\n    }\r\n\r\n    setTableOY(oy) {\r\n        var table = this.table;\r\n        var topTableOY = this.topTableOY;\r\n        var bottomTableOY = this.bottomTableOY;\r\n        var tableOYExceedTop = this.tableOYExceedTop(oy);\r\n        var tableOYExeceedBottom = this.tableOYExeceedBottom(oy);\r\n        if (this.clampTableOXYMode) {\r\n            var rowCount = table.rowCount;\r\n            var visibleRowCount = table.heightToRowIndex(this.instHeight, true);\r\n\r\n            // less then 1 page            \r\n            if (rowCount < visibleRowCount) {\r\n                oy = 0;\r\n            } else if (tableOYExceedTop) {\r\n                oy = topTableOY\r\n            } else if (tableOYExeceedBottom) {\r\n                oy = bottomTableOY;\r\n            }\r\n        }\r\n\r\n        if (this._tableOY !== oy) {\r\n            this._tableOY = oy;\r\n        }\r\n\r\n\r\n        if (tableOYExceedTop) {\r\n            if (!this.execeedTopState) {\r\n                this.emit('execeedtop', this, oy, topTableOY);\r\n            }\r\n        }\r\n        this.execeedTopState = tableOYExceedTop;\r\n\r\n        if (tableOYExeceedBottom) {\r\n            if (!this.execeedBottomState) {\r\n                this.emit('execeedbottom', this, oy, bottomTableOY);\r\n            }\r\n        }\r\n        this.execeedBottomState = tableOYExeceedBottom;\r\n        return this;\r\n    }\r\n\r\n    setTableOX(ox) {\r\n        var table = this.table;\r\n        var leftTableOX = this.leftTableOX;\r\n        var rightTableOX = this.rightTableOX;\r\n        var tableOXExeceedLeft = this.tableOXExeceedLeft(ox);\r\n        var tableOXExeceedRight = this.tableOXExeceedRight(ox);\r\n        if (this.clampTableOXYMode) {\r\n            var colCount = table.colCount;\r\n            var visibleColCount = table.widthToColIndex(this.instWidth, true);\r\n\r\n            // less then 1 page            \r\n            if (colCount < visibleColCount) {\r\n                ox = 0;\r\n            } else if (tableOXExeceedLeft) {\r\n                ox = leftTableOX\r\n            } else {\r\n                // var tableVisibleWidth = this.tableVisibleWidth;\r\n                if (tableOXExeceedRight)\r\n                    ox = rightTableOX;\r\n            }\r\n        }\r\n\r\n        if (this._tableOX !== ox) {\r\n            this._tableOX = ox;\r\n        }\r\n\r\n\r\n        if (tableOXExeceedLeft) {\r\n            if (!this.execeedLeftState) {\r\n                this.emit('execeedleft', this, ox, leftTableOX);\r\n            }\r\n        }\r\n        this.execeedLeftState = tableOXExeceedLeft;\r\n\r\n        if (tableOXExeceedRight) {\r\n            if (!this.execeedRightState) {\r\n                this.emit('execeedright', this, ox, rightTableOX);\r\n            }\r\n        }\r\n        this.execeedRightState = tableOXExeceedRight;\r\n        return this;\r\n    }\r\n\r\n    setTableOXY(ox, oy) {\r\n        this.setTableOY(oy).setTableOX(ox);\r\n        return this;\r\n    }\r\n\r\n    addTableOY(dy) {\r\n        this.setTableOY(this.tableOY + dy);\r\n        return this;\r\n    }\r\n\r\n    addTableOX(dx) {\r\n        this.setTableOX(this.tableOX + dx);\r\n        return this;\r\n    }\r\n\r\n\r\n    addTableOXY(dx, dy) {\r\n        this.addTableOY(dy).addTableOX(dx);\r\n        return this;\r\n    }\r\n\r\n    setTableOYByPercentage(percentage) {\r\n        this.setTableOY(-this.tableVisibleHeight * percentage);\r\n        return this;\r\n    }\r\n\r\n    getTableOYPercentage() {\r\n        var tableVisibleHeight = this.tableVisibleHeight;\r\n        if (tableVisibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.tableOY / -tableVisibleHeight);\r\n    }\r\n\r\n    set t(value) {\r\n        this.setTableOYByPercentage(value).updateTable();\r\n    }\r\n\r\n    get t() {\r\n        return this.getTableOYPercentage();\r\n    }\r\n\r\n    updateTable(refresh) {\r\n        if (refresh === undefined) {\r\n            refresh = false;\r\n        }\r\n        if (refresh) {\r\n            this.clearVisibleCellIndexes();\r\n            this.hideCells();\r\n        }\r\n        this.clearVisibleCellIndexes();\r\n        this.showCells();\r\n        this.hideCells();\r\n        this.maskCells();\r\n        return this;\r\n    }\r\n\r\n    getCell(cellIdx) {\r\n        return this.table.getCell(cellIdx, true);\r\n    }\r\n\r\n    getCellContainer(cellIdx) {\r\n        var cell = this.table.getCell(cellIdx, false);\r\n        var container;\r\n        if (cell) {\r\n            container = cell.getContainer();\r\n        }\r\n        return container;\r\n    }\r\n\r\n    get cellsCount() {\r\n        return this.table.cellsCount;\r\n    }\r\n\r\n    get columnCount() {\r\n        return this.table.colCount;\r\n    }\r\n\r\n    setCellHeight(cellIdx, height) {\r\n        var cell;\r\n        if (typeof (cellIdx) === 'number') {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.height = height; // Only worked when scrollMode is 0\r\n        return this;\r\n    }\r\n\r\n    setCellWidth(cellIdx, width) {\r\n        var cell;\r\n        if (typeof (cellIdx) === 'number') {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.width = width; // Only worked when scrollMode is 1\r\n        return this;\r\n    }\r\n\r\n    pointerToCellIndex(x, y) {\r\n        y -= (this.y + this.topLeftY);\r\n        x -= (this.x + this.topLeftX);\r\n        var offsetTableOY = this.tableOY - ((this.scrollMode === 0) ? y : x);\r\n        var offsetTableOX = this.tableOX - ((this.scrollMode === 0) ? x : y);\r\n\r\n        var table = this.table;\r\n        var rowIdx = table.heightToRowIndex(-offsetTableOY);\r\n        var colIdx = table.widthToColIndex(-offsetTableOX);\r\n        var cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n        if (cellIdx === null) {\r\n            return null;\r\n        }\r\n        if (!this.cellIsVisible(cellIdx)) {\r\n            return null;\r\n        }\r\n        return cellIdx;\r\n    }\r\n\r\n    pointerToCellContainer(x, y) {\r\n        var cellIdx = this.pointerToCellIndex(x, y);\r\n        if (cellIdx === null) {\r\n            return undefined;\r\n        }\r\n        return this.getCellContainer(cellIdx);\r\n    }\r\n\r\n    cellIsVisible(cellIdx) {\r\n        var cell = this.table.getCell(cellIdx, false);\r\n        return cell && this.visibleCells.contains(cell);\r\n    }\r\n\r\n    // For when you know this Set will be modified during the iteration\r\n    eachVisibleCell(callback, scope) {\r\n        this.visibleCells.each(callback, scope);\r\n        return this;\r\n    }\r\n\r\n    // For when you absolutely know this Set won't be modified during the iteration\r\n    iterateVisibleCell(callback, scope) {\r\n        this.visibleCells.iterate(callback, scope);\r\n        return this;\r\n    }\r\n\r\n    // Internal\r\n    setCellsMask(maskConfig) {\r\n        var maskEnable, maskPadding;\r\n        if (maskConfig === true) {\r\n            maskEnable = true;\r\n            maskPadding = 0;\r\n        } else if (maskConfig === false) {\r\n            maskEnable = false;\r\n        } else {\r\n            maskEnable = GetValue(maskConfig, 'mask', true);\r\n            maskPadding = GetValue(maskConfig, 'padding', 0);\r\n        }\r\n        if (maskEnable) {\r\n            var maskGameObject = new _utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this, 0, maskPadding);\r\n            this.cellsMask = maskGameObject.createGeometryMask();\r\n            this.add(maskGameObject);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    maskCells() {\r\n        var children = [];\r\n        var cells = this.visibleCells.entries, container;\r\n        for (var i = 0, cnt = cells.length; i < cnt; i++) {\r\n            container = cells[i].getContainer();\r\n            if (container) {\r\n                if (container.isRexContainerLite) { // ContainerLite\r\n                    container.getAllChildren(children);\r\n                } else { // Others\r\n                    children.push(container);\r\n                }\r\n            }\r\n        }\r\n        Object(_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this, this.cellsMask, children);\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        super.resize(width, height);\r\n        if (this.cellsMask) {\r\n            Object(_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(Object(_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(this.cellsMask), width, height);\r\n        }\r\n\r\n        if (this.expandCellSize) {\r\n            this.table.setDefaultCellWidth(this.instWidth / this.table.colCount);\r\n        }\r\n        this.updateTable(true);\r\n        return this;\r\n    }\r\n\r\n    clearVisibleCellIndexes() {\r\n        var tmp = this.preVisibleCells;\r\n        this.preVisibleCells = this.visibleCells;\r\n        this.visibleCells = tmp;\r\n        this.visibleCells.clear();\r\n    }\r\n\r\n    showCells() {\r\n        if (this.cellsCount === 0) {\r\n            return;\r\n        }\r\n        var table = this.table;\r\n        var rowIdx = table.heightToRowIndex(-this.tableOY);\r\n        if (rowIdx < 0) {\r\n            rowIdx = 0;\r\n        }\r\n\r\n        var colIdx = table.widthToColIndex(-this.tableOX);\r\n        if (colIdx < 0) {\r\n            colIdx = 0;\r\n        }\r\n\r\n        var cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n        var bottomBound = this.bottomBound;\r\n        var rightBound = this.rightBound;\r\n        var lastIdx = table.cellsCount - 1;\r\n        var lastColIdx = table.colCount - 1;\r\n\r\n        var cellTLX0 = this.getTLX(colIdx),\r\n            cellTLX = cellTLX0;\r\n        var cellTLY = this.getTLY(rowIdx);\r\n        this.visibleStartY = null;\r\n        this.visibleEndY = null;\r\n        this.visibleStartX = null;\r\n        this.visibleEndX = null;\r\n        this.lastVisibleCellIdx = null;\r\n        while ((cellTLY < bottomBound) && (cellIdx <= lastIdx)) {\r\n            if (this.table.isValidCellIdx(cellIdx)) {\r\n                if (this.visibleStartY === null) {\r\n                    this.visibleStartY = rowIdx;\r\n                    this.visibleEndY = rowIdx;\r\n                }\r\n                if (this.visibleStartX === null) {\r\n                    this.visibleStartX = colIdx;\r\n                    this.visibleEndX = colIdx;\r\n                }\r\n\r\n                if (this.lastVisibleCellIdx === null) {\r\n                    this.lastVisibleCellIdx = cellIdx;\r\n                }\r\n\r\n                if (this.visibleEndY < rowIdx) {\r\n                    this.visibleEndY = rowIdx;\r\n                }\r\n\r\n                if (this.visibleEndX < colIdx) {\r\n                    this.visibleEndX = colIdx;\r\n                }\r\n\r\n                if (this.lastVisibleCellIdx < cellIdx) {\r\n                    this.lastVisibleCellIdx = cellIdx;\r\n                }\r\n\r\n                var cell = table.getCell(cellIdx, true);\r\n                this.visibleCells.set(cell);\r\n                if (!this.preVisibleCells.contains(cell)) {\r\n                    this.showCell(cell);\r\n                }\r\n                if (this.scrollMode === 0) {\r\n                    cell.setXY(cellTLX, cellTLY);\r\n                } else {\r\n                    cell.setXY(cellTLY, cellTLX);\r\n                }\r\n            }\r\n\r\n            if ((cellTLX < rightBound) && (colIdx < lastColIdx)) {\r\n                cellTLX += table.getColWidth(colIdx);\r\n                colIdx += 1;\r\n            } else {\r\n                cellTLX = cellTLX0;\r\n                cellTLY += table.getRowHeight(rowIdx);\r\n\r\n                colIdx = this.visibleStartX;\r\n                rowIdx += 1;\r\n            }\r\n\r\n            cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n        }\r\n    }\r\n\r\n    showCell(cell) {\r\n        // Attach container to cell by cell.setContainer(container) under this event\r\n        var reusedCellContainer = null;\r\n        if (this.cellContainersPool) {\r\n            reusedCellContainer = this.cellContainersPool.getFirstDead();\r\n            if (reusedCellContainer !== null) { // Reuse this game object\r\n                reusedCellContainer.setActive(true).setVisible(true);\r\n            }\r\n        }\r\n\r\n        this.emit('cellvisible', cell, reusedCellContainer);\r\n\r\n        if (this.cellContainersPool) {\r\n            var cellContainer = cell.getContainer();\r\n            if (cellContainer) {\r\n                if (reusedCellContainer === null) {\r\n                    this.cellContainersPool.add(cellContainer); // New cell container, add to pool\r\n                } else if (reusedCellContainer !== cellContainer) {\r\n                    // Why reusedCellContainer is not equal to cellContainer?\r\n                    this.cellContainersPool.add(cellContainer); // New cell container, add to pool\r\n                    this.cellContainersPool.killAndHide(reusedCellContainer); // Unused cell container, put back to pool\r\n                }\r\n            } else { // No cell container added\r\n                if (reusedCellContainer !== null) {\r\n                    this.cellContainersPool.killAndHide(reusedCellContainer); // Unused cell container, put back to pool\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    hideCells() {\r\n        var preList = this.preVisibleCells;\r\n        var curList = this.visibleCells;\r\n        preList.iterate(function (cell) {\r\n            if (!curList.contains(cell)) {\r\n                this.hideCell(cell);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    hideCell(cell) {\r\n        // Option: pop container of cell by cell.popContainer() under this event \r\n        this.emit('cellinvisible', cell);\r\n\r\n        if (this.cellContainersPool) {\r\n            var cellContainer = cell.popContainer(); // null if already been removed\r\n            if (cellContainer) {\r\n                this.cellContainersPool.killAndHide(cellContainer);\r\n            }\r\n        }\r\n\r\n        cell.destroyContainer(); // Destroy container of cell\r\n    }\r\n\r\n    get instHeight() {\r\n        return (this.scrollMode === 0) ? this.height : this.width;\r\n    }\r\n\r\n    get instWidth() {\r\n        return (this.scrollMode === 0) ? this.width : this.height;\r\n    }\r\n\r\n    get tableHeight() {\r\n        return this.table.totalRowsHeight;\r\n    }\r\n\r\n    get tableWidth() {\r\n        return this.table.totalColumnWidth;\r\n    }\r\n\r\n    get topTableOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomTableOY() {\r\n        return -this.tableVisibleHeight;\r\n    }\r\n\r\n    get leftTableOX() {\r\n        return 0;\r\n    }\r\n\r\n    get rightTableOX() {\r\n        return -this.tableVisibleWidth;\r\n    }\r\n\r\n    tableOYExceedTop(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.tableOY;\r\n        }\r\n        return (oy > this.topTableOY);\r\n    }\r\n\r\n    tableOYExeceedBottom(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.tableOY;\r\n        }\r\n        return (oy < this.bottomTableOY);\r\n    }\r\n\r\n    tableOXExeceedLeft(ox) {\r\n        if (ox === undefined) {\r\n            ox = this.tableOX;\r\n        }\r\n        return (ox > this.leftTableOX);\r\n    }\r\n\r\n    tableOXExeceedRight(ox) {\r\n        if (ox === undefined) {\r\n            ox = this.tableOX;\r\n        }\r\n        return (ox < this.rightTableOX);\r\n    }\r\n\r\n    get tableVisibleHeight() {\r\n        var h;\r\n        var tableHeight = this.tableHeight;\r\n        var instHeight = this.instHeight;\r\n        if (tableHeight > instHeight) {\r\n            h = tableHeight - instHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    get tableVisibleWidth() {\r\n        var w;\r\n        var tableWidth = this.tableWidth;\r\n        var instWidth = this.instWidth;\r\n        if (tableWidth > instWidth) {\r\n            w = tableWidth - instWidth;\r\n        } else {\r\n            w = 0;\r\n        }\r\n        return w;\r\n    };\r\n\r\n    get bottomLeftY() {\r\n        return -(this.displayHeight * this.originY) + this.displayHeight;\r\n    }\r\n\r\n    get topRightX() {\r\n        return -(this.displayWidth * this.originX) + this.displayWidth;\r\n    }\r\n\r\n    get topLeftX() {\r\n        return -(this.displayWidth * this.originX);\r\n    }\r\n\r\n    get topLeftY() {\r\n        return -(this.displayHeight * this.originY)\r\n    }\r\n\r\n    get bottomBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.bottomLeftY;\r\n        } else {\r\n            return this.topRightX;\r\n        }\r\n    }\r\n\r\n    get rightBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.topRightX;\r\n        } else {\r\n            return this.bottomLeftY;\r\n        }\r\n    }\r\n\r\n    getTLX(colIdx) {\r\n        var ox = (this.scrollMode === 0) ? this.topLeftX : this.topLeftY;\r\n        var x = this.tableOX + this.table.colIndexToWidth(0, colIdx - 1) + ox;\r\n        return x;\r\n    }\r\n\r\n    getTLY(rowIdx) {\r\n        var oy = (this.scrollMode === 0) ? this.topLeftY : this.topLeftX;\r\n        var y = this.tableOY + this.table.rowIndexToHeight(0, rowIdx - 1) + oy;\r\n        return y;\r\n    }\r\n};\r\n\r\n// mixin\r\nObject.assign(\r\n    GridTable.prototype,\r\n    Components.GetBounds\r\n);\r\n\r\nconst SCROLLMODE = {\r\n    v: 0,\r\n    vertical: 0,\r\n    h: 1,\r\n    horizontal: 1\r\n};\r\n\r\nvar P0 = {}; // reuse point object\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GridTable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/gridtable/GridTable.js?")},"./lib/rexui/plugins/gameobjects/gridtable/Table.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Cell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Cell.js */ \"./lib/rexui/plugins/gameobjects/gridtable/Cell.js\");\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pool.js */ \"./lib/rexui/plugins/pool.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst SpliceOne = Phaser.Utils.Array.SpliceOne;\r\n\r\nvar CellPool = new _pool_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\r\nclass Table {\r\n    constructor(parent, config) {\r\n        this.parent = parent; // parent: GridTable game object (Container)\r\n        this.cells = [];\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.colCount = undefined;\r\n        this._nonZeroDeltaHeightCount = 0;\r\n        this.resetTotalRowsHeight();\r\n        this.setDefaultCellHeight(GetValue(o, 'cellHeight', 30));\r\n        this.setDefaultCellWidth(GetValue(o, 'cellWidth', 30));\r\n        this.initCells(GetValue(o, 'cellsCount', 0));\r\n        this.setColumnCount(GetValue(o, 'columns', 1));\r\n        return this;\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        for (var i = 0, cnt = this.cells.length; i < cnt; i++) {\r\n            this.freeCell(this.cells[i], fromScene);\r\n        }\r\n        this.cells = undefined;\r\n        this.parent = undefined;\r\n    }\r\n\r\n    get nonZeroDeltaHeightCount() {\r\n        return this._nonZeroDeltaHeightCount;\r\n    }\r\n\r\n    set nonZeroDeltaHeightCount(count) {\r\n        if (this._nonZeroDeltaHeightCount === count) {\r\n            return;\r\n        }\r\n        this._nonZeroDeltaHeightCount = count;\r\n        this.resetTotalRowsHeight();\r\n    }\r\n\r\n    get defaultCellHeightMode() {\r\n        return (this.nonZeroDeltaHeightCount === 0);\r\n    }\r\n\r\n    setDefaultCellHeight(height) {\r\n        this.defaultCellHeight = height;\r\n        return this;\r\n    }\r\n\r\n    setDefaultCellWidth(width) {\r\n        this.defaultCellWidth = width;\r\n        return this;\r\n    }\r\n\r\n    initCells(size) {\r\n        var cells = this.cells;\r\n        cells.length = size;\r\n        for (var i = 0; i < size; i++) {\r\n            cells[i] = null;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    insertNewCell(cellIdx, count) {\r\n        var cells = this.cells;\r\n        if (cellIdx === cells.length) {\r\n            // append at end of array\r\n            var endIdx = cellIdx + count;\r\n            cells.legth = endIdx;\r\n            for (var i = cellIdx; i < endIdx; i++) {\r\n                cells[i] = null;\r\n            }\r\n        } else {\r\n            var newCells = [];\r\n            newCells.length = count;\r\n            for (var i = 0; i < count; i++) {\r\n                newCells[i] = null;\r\n            }\r\n            this.cells.splice(cellIdx, 0, ...newCells);\r\n        }\r\n\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    removeCell(cellIdx, count) {\r\n        var endIdx = cellIdx + count;\r\n        for (var i = cellIdx; i < endIdx; i++) {\r\n            this.freeCell(i);\r\n        }\r\n\r\n        if (endIdx === this.cells.length) {\r\n            // remove until end of array\r\n            this.cells.length = cellIdx;\r\n        } else {\r\n            if (count === 1) {\r\n                SpliceOne(this.cells, cellIdx);\r\n            } else {\r\n                this.cells.splice(cellIdx, count);\r\n            }\r\n            this.buildCellIndex(cellIdx);\r\n        }\r\n\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    setColumnCount(cnt) {\r\n        this.colCount = cnt;\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    get rowCount() {\r\n        return Math.ceil(this.cells.length / this.colCount);\r\n    }\r\n\r\n    get cellsCount() {\r\n        return this.cells.length;\r\n    }\r\n\r\n    isValidCellIdx(idx) {\r\n        return ((idx >= 0) && (idx < this.cells.length));\r\n    }\r\n\r\n    heightToRowIndex(height, isCeil) {\r\n        // defaultCellHeightMode\r\n        if (this.defaultCellHeightMode) {\r\n            var rowIdx = height / this.defaultCellHeight;\r\n            if (isCeil) {\r\n                rowIdx = Math.ceil(rowIdx);\r\n            } else {\r\n                rowIdx = Math.floor(rowIdx);\r\n            }\r\n\r\n            return rowIdx;\r\n        }\r\n\r\n        // count cell height one by one\r\n        var rowCount = this.rowCount;\r\n        var remainder = height,\r\n            isValidIdx;\r\n        var cell, rowHeight, rowIdx = 0;\r\n\r\n        while (1) {\r\n            rowHeight = this.getRowHeight(rowIdx);\r\n            remainder -= rowHeight;\r\n\r\n            isValidIdx = (rowIdx >= 0) && (rowIdx < rowCount);\r\n            if ((remainder > 0) && isValidIdx) {\r\n                rowIdx += 1;\r\n            } else if (remainder === 0) {\r\n                return rowIdx;\r\n            } else {\r\n                if (isCeil) {\r\n                    var preRowIdx = rowIdx;\r\n                    rowIdx += 1;\r\n                    isValidIdx = (rowIdx >= 0) && (rowIdx < rowCount);\r\n\r\n                    if (!isValidIdx)\r\n                        rowIdx = preRowIdx;\r\n                }\r\n\r\n                return rowIdx;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    widthToColIndex(width, isCeil) {\r\n        var colIdx = width / this.defaultCellWidth;\r\n        if (isCeil) {\r\n            colIdx = Math.ceil(colIdx);\r\n        } else {\r\n            colIdx = Math.floor(colIdx);\r\n        }\r\n\r\n        return colIdx;\r\n    }\r\n\r\n    colRowToCellIndex(colIdx, rowIdx) {\r\n        if (colIdx >= this.colCount) {\r\n            return null;\r\n        }\r\n        return (rowIdx * this.colCount) + colIdx;\r\n    }\r\n\r\n    rowIndexToHeight(start, end) {\r\n        // defaultCellHeightMode\r\n        if (this.defaultCellHeightMode) {\r\n            return (end - start + 1) * this.defaultCellHeight;\r\n        }\r\n\r\n        var h, sum = 0;\r\n        for (var i = start; i <= end; i++) {\r\n            h = this.getRowHeight(i);\r\n            sum += h;\r\n        }\r\n\r\n        return sum;\r\n    }\r\n\r\n    colIndexToWidth(start, end) {\r\n        return (end - start + 1) * this.defaultCellWidth;\r\n    };\r\n\r\n    getRowHeight(rowIdx) {\r\n        var cnt = this.colCount;\r\n        // single column\r\n        if (cnt <= 1) {\r\n            return this.getCellHeight(this.colRowToCellIndex(0, rowIdx));\r\n        }\r\n\r\n        // multiple columns, get the maximum height\r\n        var maxHeight = 0,\r\n            cellHeight;\r\n        for (var i = 0; i < cnt; i++) {\r\n            cellHeight = this.getCellHeight(this.colRowToCellIndex(i, rowIdx));\r\n            if (maxHeight < cellHeight)\r\n                maxHeight = cellHeight;\r\n        }\r\n        return maxHeight;\r\n    }\r\n\r\n    getColWidth(idx) {\r\n        return this.defaultCellWidth;\r\n    }\r\n\r\n    getCellHeight(cellIdx) {\r\n        if (!this.isValidCellIdx(cellIdx)) {\r\n            return 0;\r\n        }\r\n\r\n        var cellHeight;\r\n        if (this.defaultCellHeightMode)\r\n            cellHeight = this.defaultCellHeight;\r\n        else {\r\n            var cell = this.getCell(cellIdx, false);\r\n            var deltaHeight = (cell) ? cell.deltaHeight : 0;\r\n            cellHeight = this.defaultCellHeight + deltaHeight;\r\n        }\r\n\r\n        return cellHeight;\r\n    }\r\n\r\n    resetTotalRowsHeight() {\r\n        this._totalRowsHeight = null;\r\n    }\r\n\r\n    get totalRowsHeight() {\r\n        if (this._totalRowsHeight === null) {\r\n            this._totalRowsHeight = this.rowIndexToHeight(0, this.rowCount - 1);\r\n        }\r\n\r\n        return this._totalRowsHeight;\r\n    }\r\n\r\n    get totalColumnWidth() {\r\n        return this.colCount * this.defaultCellWidth;\r\n    }\r\n\r\n    cellIndxeToColIndex(cellIdx) {\r\n        return cellIdx % this.colCount;\r\n    }\r\n\r\n    cellIndxeToRowIndex(cellIdx) {\r\n        return Math.floor(cellIdx / this.colCount);\r\n    }\r\n\r\n    getCell(cellIdx, createNewCell) {\r\n        if (!this.isValidCellIdx(cellIdx)) {\r\n            return null;\r\n        }\r\n\r\n        if (createNewCell === undefined) {\r\n            createNewCell = true;\r\n        }\r\n        if ((this.cells[cellIdx] === null) && createNewCell) {\r\n            var cell = this.newCell(cellIdx);\r\n            this.cells[cellIdx] = cell;\r\n        }\r\n\r\n        return this.cells[cellIdx];\r\n    }\r\n\r\n    newCell(cellIdx) {\r\n        var cell = CellPool.pop();\r\n        if (cell === null) {\r\n            cell = new _Cell_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this);\r\n        } else {\r\n            cell.setParent(this);\r\n        }\r\n        cell.index = cellIdx;\r\n\r\n        return cell;\r\n    }\r\n\r\n    buildCellIndex(startIdx) {\r\n        if (startIdx === undefined) {\r\n            startIdx = 0;\r\n        }\r\n        var cells = this.cells,\r\n            cell;\r\n        for (var i = startIdx, len = cells.length; i < len; i++) {\r\n            cell = cells[i];\r\n            if (cell) {\r\n                cell.index = i;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    getParentContainer() {\r\n        return this.parent;\r\n    }\r\n\r\n    freeCell(cell, fromScene) {\r\n        if (typeof (cell) === 'number') {\r\n            cell = this.cells[cell];\r\n        }\r\n\r\n        if (!cell) {\r\n            return this;\r\n        }\r\n\r\n        cell.destroy(fromScene);\r\n        CellPool.push(cell);\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Table);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/gridtable/Table.js?")},"./lib/rexui/plugins/gameobjects/inputtext/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InputText.js */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (config, addToScene) {\r\n    var width = GetAdvancedValue(config, \'width\', undefined);\r\n    var height = GetAdvancedValue(config, \'height\', undefined);\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n    var gameObject = new _InputText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, 0, 0, width, height, config);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/inputtext/Creator.js?')},"./lib/rexui/plugins/gameobjects/inputtext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InputText.js */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, width, height, config) {\r\n    var gameObject = new _InputText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/inputtext/Factory.js?')},"./lib/rexui/plugins/gameobjects/inputtext/InputText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_input_StopPropagationTouchEvents_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/input/StopPropagationTouchEvents.js */ \"./lib/rexui/plugins/utils/input/StopPropagationTouchEvents.js\");\n\r\n\r\nconst DOMElement = Phaser.GameObjects.DOMElement;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass InputText extends DOMElement {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        var autoRound = scene.scale.autoRound;\r\n        if (width !== undefined) {\r\n            if (autoRound) {\r\n                width = Math.floor(width);\r\n            }\r\n            config.width = width + 'px';\r\n        }\r\n        if (height !== undefined) {\r\n            if (autoRound) {\r\n                height = Math.floor(height);\r\n            }\r\n            config.height = height + 'px';\r\n        }\r\n\r\n        var element;\r\n        var textType = GetValue(config, 'type', 'text');\r\n        if (textType === 'textarea') {\r\n            element = document.createElement(\"textarea\");\r\n            element.style.resize = 'none';\r\n        } else {\r\n            element = document.createElement(\"input\");\r\n            element.type = textType;\r\n        }\r\n\r\n        // Apply registed style properties\r\n        var elemProp, elemPropValue;\r\n        for (var key in ElementProperties) {\r\n            elemProp = ElementProperties[key];\r\n            elemPropValue = GetValue(config, key, elemProp[1]);\r\n            if (elemPropValue !== undefined) {\r\n                element[elemProp[0]] = elemPropValue;\r\n            }\r\n        }\r\n\r\n        var style = GetValue(config, 'style', undefined);\r\n        if (style === undefined) {\r\n            style = {};\r\n        }\r\n        // Apply registed style properties\r\n        var styleProp, stylePropValue;\r\n        for (var key in StyleProperties) {\r\n            styleProp = StyleProperties[key];\r\n            stylePropValue = GetValue(config, key, styleProp[1]);\r\n            if (stylePropValue !== undefined) {\r\n                style[styleProp[0]] = stylePropValue;\r\n            }\r\n        }\r\n        // Apply other style properties\r\n        var elementStyle = element.style;\r\n        for (var key in config) {\r\n            if ((key in ElementProperties) || (key in StyleProperties)) {\r\n                continue;\r\n            } else if (key in elementStyle) {\r\n                style[key] = config[key];\r\n            }\r\n        }\r\n        style['box-sizing'] = 'border-box';\r\n        super(scene, x, y, element, style);\r\n        this.type = 'rexInputText';\r\n\r\n        // Apply events\r\n        for (let eventName in ElementEvents) { // Note: Don't use `var` here\r\n            this.node[ElementEvents[eventName]] = (function () {\r\n                this.emit(eventName, this);\r\n            }).bind(this);\r\n        }\r\n\r\n        // Don't propagate touch/mouse events to parent(game canvas)\r\n        Object(_utils_input_StopPropagationTouchEvents_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.node);\r\n    }\r\n\r\n    resize(width, height) {\r\n        var style = this.node.style;\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        this.updateSize();\r\n        return this;\r\n    }\r\n\r\n    get text() {\r\n        return this.node.value;\r\n    }\r\n\r\n    set text(value) {\r\n        this.node.value = value;\r\n    }\r\n\r\n    setText(value) { // Override\r\n        this.text = value;\r\n        return this;\r\n    }\r\n\r\n    selectText() {\r\n        this.node.select();\r\n        return this;\r\n    }\r\n\r\n    get placeholder() {\r\n        return this.node.placeholder;\r\n    }\r\n\r\n    set placeholder(value) {\r\n        this.node.placeholder = value;\r\n    }\r\n\r\n    setPlaceholder(value) {\r\n        this.placeholder = value;\r\n        return this;\r\n    }\r\n\r\n    get tooltip() {\r\n        return this.node.title;\r\n    }\r\n\r\n    set tooltip(value) {\r\n        this.node.title = value;\r\n    }\r\n\r\n    setTooltip(value) {\r\n        this.tooltip = value;\r\n        return this;\r\n    }\r\n\r\n    setTextChangedCallback(callback) {\r\n        this.onTextChanged = callback;\r\n        return this;\r\n    }\r\n\r\n    get readOnly() {\r\n        return this.node.readOnly;\r\n    }\r\n\r\n    set readOnly(value) {\r\n        this.node.readOnly = value;\r\n    }\r\n\r\n    setReadOnly(value) {\r\n        if (value === undefined) {\r\n            value = true;\r\n        }\r\n        this.readOnly = value;\r\n        return this;\r\n    }\r\n\r\n    get spellCheck() {\r\n        return this.node.spellcheck;\r\n    }\r\n\r\n    set spellCheck(value) {\r\n        this.node.spellcheck = value;\r\n    }\r\n\r\n    setSpellCheck(value) {\r\n        this.spellCheck = value;\r\n        return this;\r\n    }\r\n\r\n    setStyle(key, value) {\r\n        this.node.style[key] = value;\r\n        return this;\r\n    }\r\n\r\n    getStyle(key) {\r\n        return this.node.style[key];\r\n    }\r\n\r\n    scrollToBottom() {\r\n        this.node.scrollTop = this.node.scrollHeight;\r\n        return this;\r\n    }\r\n\r\n    setEnabled(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.node.disabled = !enabled;\r\n        return this;\r\n    }\r\n\r\n    setBlur() {\r\n        this.node.blur();\r\n        return this;\r\n    }\r\n\r\n    setFocus() {\r\n        this.node.focus();\r\n        return this;\r\n    }\r\n}\r\n\r\nconst ElementProperties = {\r\n    id: ['id', undefined],\r\n    text: ['value', undefined],\r\n    placeholder: ['placeholder', undefined],\r\n    tooltip: ['title', undefined],\r\n    readOnly: ['readonly', false],\r\n    spellCheck: ['spellcheck', false],\r\n    autoComplete: ['autocomplete', 'off'],\r\n};\r\n\r\nconst StyleProperties = {\r\n    align: ['text-align', undefined],\r\n    width: ['width', undefined],\r\n    height: ['height', undefined],\r\n    fontFamily: ['font-family', undefined],\r\n    fontSize: ['font-size', undefined],\r\n    color: ['color', '#ffffff'],\r\n    backgroundColor: ['backgroundColor', 'transparent'],\r\n    borderColor: ['borderColor', 'transparent'],\r\n    outline: ['outline', 'none'],\r\n};\r\n\r\nconst ElementEvents = {\r\n    textchange: 'oninput',\r\n    click: 'onclick',\r\n    dblclick: 'ondblclick',\r\n    focus: 'onfocus',\r\n    blur: 'onblur',\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InputText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/inputtext/InputText.js?")},"./lib/rexui/plugins/gameobjects/ninepatch/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (config, addToScene) {\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/Creator.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, width, height, key, columns, rows, config) {\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, key, columns, rows, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/Factory.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _texture_TextureMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./texture/TextureMethods.js */ \"./lib/rexui/plugins/gameobjects/ninepatch/texture/TextureMethods.js\");\n/* harmony import */ var _utils_DefaultGetFrameNameCallback_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/DefaultGetFrameNameCallback.js */ \"./lib/rexui/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js\");\n\r\n\r\n\r\nconst RenderTexture = Phaser.GameObjects.RenderTexture;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass NinePatch extends RenderTexture {\r\n    constructor(scene, x, y, width, height, key, columns, rows, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', 1);\r\n            height = GetValue(config, 'height', 1);\r\n            key = GetValue(config, 'key', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', 1);\r\n            height = GetValue(config, 'height', 1);\r\n            key = GetValue(config, 'key', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (IsPlainObject(key)) {\r\n            config = key;\r\n            key = GetValue(config, 'key', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        }\r\n\r\n        super(scene, x, y, width, height);\r\n        this.columns = {};\r\n        this.rows = {};\r\n        this.stretchMode = {};\r\n        this.redraw = false;\r\n        this._image = undefined;\r\n        this._tileSprite = undefined;\r\n\r\n        this.setOrigin(0.5, 0.5);\r\n        this.setGetFrameNameCallback(GetValue(config, 'getFrameNameCallback', undefined));\r\n        this.setTexture(key, columns, rows);\r\n        this.setStretchMode(GetValue(config, 'stretchMode', 0));\r\n    }\r\n\r\n    preDestroy() {\r\n        if (this._image) {\r\n            this._image.destroy();\r\n            this._image = undefined;\r\n        }\r\n        if (this._tileSprite) {\r\n            this._tileSprite.destroy();\r\n            this._tileSprite = undefined;\r\n        }\r\n        super.preDestroy();\r\n    }\r\n\r\n    setGetFrameNameCallback(callback) {\r\n        if (callback === undefined) {\r\n            callback = _utils_DefaultGetFrameNameCallback_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n        }\r\n        this.getFrameNameCallback = callback;\r\n        return this;\r\n    }\r\n\r\n    get minWidth() {\r\n        return this.columns.minWidth;\r\n    }\r\n\r\n    get minHeight() {\r\n        return this.rows.minHeight;\r\n    }\r\n\r\n    resize(width, height) {\r\n        this.redraw = true;\r\n        super.resize(width, height);\r\n        this.updateDisplayOrigin(); // Add this code into RenderTexture\r\n        return this;\r\n    }\r\n\r\n    renderWebGL(renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n        this.updateTexture();\r\n        super.renderWebGL(renderer, src, interpolationPercentage, camera, parentMatrix);\r\n    }\r\n\r\n    renderCanvas(renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n        this.updateTexture();\r\n        super.renderCanvas(renderer, src, interpolationPercentage, camera, parentMatrix);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    NinePatch.prototype,\r\n    _texture_TextureMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (NinePatch);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js?")},"./lib/rexui/plugins/gameobjects/ninepatch/texture/GetStretchMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_IsEdge_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/IsEdge.js */ "./lib/rexui/plugins/gameobjects/ninepatch/utils/IsEdge.js");\n\r\n\r\nvar GetStretchMode = function(colIndex, rowIndex) {\r\n    return (_utils_IsEdge_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, colIndex, rowIndex)) ? this.stretchMode.edge : this.stretchMode.internal;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetStretchMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/texture/GetStretchMode.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/texture/SetStretchMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar SetStretchMode = function(mode) {\r\n    if (IsPlainObject(mode)) {\r\n        this.stretchMode.edge = parseMode(GetValue(mode, 'edge', 0));\r\n        this.stretchMode.internal = parseMode(GetValue(mode, 'internal', 0));\r\n    } else {\r\n        mode = parseMode(mode);\r\n        this.stretchMode.edge = mode;\r\n        this.stretchMode.internal = mode;\r\n    }\r\n    return this;\r\n};\r\n\r\nvar parseMode = function (mode) {\r\n    if (typeof (mode) === 'string') {\r\n        mode = EXTENDMODE[mode];\r\n    }\r\n    return mode;\r\n}\r\n\r\nconst EXTENDMODE = {\r\n    scale: 0,\r\n    repeat: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetStretchMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/texture/SetStretchMode.js?")},"./lib/rexui/plugins/gameobjects/ninepatch/texture/SetTexture.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetTexture = function (key, columns, rows) {\r\n    this.textureKey = key;\r\n    this.columns.data = columns;\r\n    this.columns.count = (columns) ? columns.length : 0;\r\n    this.columns.stretch = 0;\r\n    this.columns.minWidth = 0;\r\n    this.rows.data = rows;\r\n    this.rows.count = (rows) ? rows.length : 0;\r\n    this.rows.stretch = 0;\r\n    this.rows.minHeight = 0;\r\n\r\n    var texture = this.scene.textures.get(key);\r\n    if (!texture) {\r\n        this.redraw = true;\r\n        return this;\r\n    }\r\n    if (!columns || !rows) {\r\n        this.redraw = true;\r\n        return this;\r\n    }\r\n\r\n    var row, col, rowHeight, colWidth, frameName;\r\n    var offsetX = 0, offsetY = 0;\r\n    for (var j = 0, jcnt = rows.length; j < jcnt; j++) {\r\n        if (typeof (rows[j]) === 'number') {\r\n            rows[j] = {\r\n                height: rows[j],\r\n                stretch: (j % 2),\r\n            }\r\n        }\r\n\r\n        row = rows[j];\r\n        rowHeight = row.height;\r\n\r\n        this.rows.stretch += (row.stretch | 0);\r\n        this.rows.minHeight += (row.stretch > 0) ? 0 : rowHeight;\r\n\r\n        offsetX = 0;\r\n        for (var i = 0, icnt = columns.length; i < icnt; i++) {\r\n            if (typeof (columns[i]) === 'number') {\r\n                columns[i] = {\r\n                    width: columns[i],\r\n                    stretch: (i % 2),\r\n                }\r\n            }\r\n\r\n            col = columns[i];\r\n            colWidth = col.width;\r\n\r\n            if (j === 0) {\r\n                this.columns.stretch += (col.stretch | 0);\r\n                this.columns.minWidth += (col.stretch > 0) ? 0 : colWidth;\r\n            }\r\n\r\n            if ((colWidth >= 1) && (rowHeight >= 1)) {\r\n                frameName = this.getFrameNameCallback(i, j);\r\n                if (frameName) {\r\n                    texture.add(\r\n                        this.getFrameNameCallback(i, j), 0,\r\n                        offsetX, offsetY,\r\n                        colWidth, rowHeight\r\n                    );\r\n                    // Do nothing if frameName is existed\r\n                }\r\n            }\r\n            offsetX += colWidth;\r\n        }\r\n        offsetY += rowHeight;\r\n    }\r\n\r\n    this.redraw = true;\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetTexture);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/texture/SetTexture.js?")},"./lib/rexui/plugins/gameobjects/ninepatch/texture/TextureMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetTexture_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetTexture.js */ "./lib/rexui/plugins/gameobjects/ninepatch/texture/SetTexture.js");\n/* harmony import */ var _UpdateTexture_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UpdateTexture.js */ "./lib/rexui/plugins/gameobjects/ninepatch/texture/UpdateTexture.js");\n/* harmony import */ var _SetStretchMode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SetStretchMode.js */ "./lib/rexui/plugins/gameobjects/ninepatch/texture/SetStretchMode.js");\n/* harmony import */ var _GetStretchMode_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetStretchMode.js */ "./lib/rexui/plugins/gameobjects/ninepatch/texture/GetStretchMode.js");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setTexture: _SetTexture_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    updateTexture: _UpdateTexture_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    setStretchMode: _SetStretchMode_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getStretchMode: _GetStretchMode_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/texture/TextureMethods.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/texture/UpdateTexture.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar UpdateTexture = function () {\r\n    if (!this.redraw) {\r\n        return this;\r\n    }\r\n    this.redraw = false;\r\n    this.clear();\r\n\r\n    var remainderWidth = this.width - this.columns.minWidth;\r\n    var remainderHeight = this.height - this.rows.minHeight;\r\n    var proportionWidth = (this.columns.stretch > 0) ? (remainderWidth / this.columns.stretch) : 0;\r\n    var proportionHeight = (this.rows.stretch > 0) ? (remainderHeight / this.rows.stretch) : 0;\r\n\r\n    var frameName, col, row, colWidth, rowHeight;\r\n    var offsetX = 0, offsetY = 0;\r\n    for (var j = 0, jcnt = this.rows.count; j < jcnt; j++) {\r\n        row = this.rows.data[j];\r\n        rowHeight = (row.stretch === 0) ? row.height : (proportionHeight * row.stretch);\r\n\r\n        offsetX = 0;\r\n        for (var i = 0, icnt = this.columns.count; i < icnt; i++) {\r\n            col = this.columns.data[i];\r\n            colWidth = (col.stretch === 0) ? col.width : (proportionWidth * col.stretch);\r\n\r\n            frameName = this.getFrameNameCallback(i, j);\r\n            if (frameName) {\r\n                if ((row.stretch === 0) && (col.stretch === 0)) { // Draw frame\r\n                    this.drawFrame(this.textureKey, frameName, offsetX, offsetY);\r\n                } else {\r\n                    var gameObject;\r\n                    if (this.getStretchMode(i, j) === 0) { // Scaled image\r\n                        // Draw scaled image\r\n                        if (this._image === undefined) {\r\n                            this._image = this.scene.make.image({\r\n                                add: false,\r\n                                origin: { x: 0, y: 0 },\r\n                            });\r\n                        }\r\n                        gameObject = this._image;\r\n                        gameObject\r\n                            .setTexture(this.textureKey, frameName)\r\n                            .setDisplaySize(colWidth, rowHeight);\r\n                    } else { // Repeat tile-sprite\r\n                        if (this._tileSprite === undefined) {\r\n                            this._tileSprite = this.scene.make.tileSprite({\r\n                                add: false,\r\n                                origin: { x: 0, y: 0 },\r\n                            });\r\n                        }\r\n                        gameObject = this._tileSprite;\r\n                        gameObject\r\n                            .setTexture(this.textureKey, frameName)\r\n                            .setSize(colWidth, rowHeight);\r\n                    }\r\n                    this.draw(gameObject, offsetX, offsetY);\r\n                }\r\n            }\r\n            offsetX += colWidth;\r\n        }\r\n\r\n        offsetY += rowHeight;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateTexture);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/texture/UpdateTexture.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = (function (colIndex, rowIndex) {\r\n    return `${colIndex},${rowIndex}`;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js?')},"./lib/rexui/plugins/gameobjects/ninepatch/utils/IsEdge.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar IsEdge = function (colIndex, rowIndex) {\r\n    return (colIndex === 0) || (colIndex === (this.columns.count - 1)) ||\r\n        (rowIndex === 0) || (rowIndex === (this.rows.count - 1));\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsEdge);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/ninepatch/utils/IsEdge.js?')},"./lib/rexui/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _geom_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./geom/RoundRectangle.js */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js");\n/* harmony import */ var _utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/LineTo.js */ "./lib/rexui/plugins/gameobjects/shape/utils/LineTo.js");\n/* harmony import */ var _utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/ArcTo.js */ "./lib/rexui/plugins/gameobjects/shape/utils/ArcTo.js");\n/* harmony import */ var _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/geom/polygon/Earcut.js */ "./lib/rexui/plugins/utils/geom/polygon/Earcut.js");\n/* harmony import */ var _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./render/Render.js */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/Render.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass RoundRectangle extends Phaser.GameObjects.Shape {\r\n    constructor(scene, x, y, width, height, radiusConfig, fillColor, fillAlpha) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        var iteration = GetValue(radiusConfig, \'iteration\', undefined);\r\n        radiusConfig = GetValue(radiusConfig, \'radius\', radiusConfig);\r\n        var geom = new _geom_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"](0, 0, width, height, radiusConfig);\r\n        super(scene, \'RoundRectangle\', geom);\r\n\r\n        this.setIteration(iteration);\r\n        this.setPosition(x, y);\r\n        // this.setSize(this.geom.width, this.geom.height);\r\n\r\n        if (fillColor !== undefined) {\r\n            this.setFillStyle(fillColor, fillAlpha);\r\n        }\r\n\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    updateData() {\r\n        var geom = this.geom;\r\n        var pathData = this.pathData;\r\n\r\n        pathData.length = 0;\r\n\r\n        var cornerRadius = geom.cornerRadius,\r\n            radius,\r\n            iteration = this.iteration + 1;\r\n        // bottom-right\r\n        radius = cornerRadius.br;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = geom.width - radius.x;\r\n            var centerY = geom.height - radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius, 0, 90, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(geom.width, geom.height, pathData);\r\n        }\r\n\r\n        // bottom-left\r\n        radius = cornerRadius.bl;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = radius.x;\r\n            var centerY = geom.height - radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius, 90, 180, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(0, geom.height, pathData);\r\n        }\r\n\r\n        // top-left\r\n        radius = cornerRadius.tl;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = radius.x;\r\n            var centerY = radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius, 180, 270, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(0, 0, pathData);\r\n        }\r\n\r\n        // top-right\r\n        radius = cornerRadius.tr;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = geom.width - radius.x;\r\n            var centerY = radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius, 270, 360, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(geom.width, 0, pathData);\r\n        }\r\n\r\n        pathData.push(pathData[0], pathData[1]); // Repeat first point to close curve\r\n        this.pathIndexes = _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3___default()(pathData);\r\n        return this;\r\n    }\r\n\r\n    get width() {\r\n        return this.geom.width;\r\n    }\r\n    set width(value) {\r\n        // Change width value\r\n        if (this.width === value) {\r\n            return;\r\n        }\r\n        this.geom.width = value;\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    get height() {\r\n        return this.geom.height;\r\n    }\r\n    set height(value) {\r\n        // Change height value\r\n        if (this.height === value) {\r\n            return;\r\n        }\r\n        this.geom.height = value;\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    resize(width, height) {\r\n        if (height === undefined) {\r\n            height = width;\r\n        }\r\n        if ((this.geom.width === width) && (this.geom.height === height)) {\r\n            return this;\r\n        }\r\n        this.geom.height = height;\r\n        this.geom.width = width\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n        return this;\r\n    }\r\n\r\n    get iteration() {\r\n        return this._iteration;\r\n    }\r\n\r\n    set iteration(value) {\r\n        // Set iteration first time\r\n        if (this._iteration === undefined) {\r\n            this._iteration = value;\r\n            return;\r\n        }\r\n\r\n        // Change iteration value\r\n        if (this._iteration === value) {\r\n            return;\r\n        }\r\n\r\n        this._iteration = value;\r\n        this.updateData();\r\n    }\r\n\r\n    setIteration(iteration) {\r\n        if (iteration === undefined) {\r\n            iteration = 6;\r\n        }\r\n        this.iteration = iteration;\r\n        return this;\r\n    }\r\n\r\n    get radius() {\r\n        return this.geom.radius;\r\n    }\r\n\r\n    set radius(value) {\r\n        this.geom.setRadius(value);\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    setRadius(value) {\r\n        if (value === undefined) {\r\n            value = 0;\r\n        }\r\n        this.radius = value;\r\n        return this;\r\n    }\r\n\r\n    get cornerRadius() {\r\n        return this.geom.cornerRadius;\r\n    }\r\n\r\n    set cornerRadius(value) {\r\n        this.radius = value;\r\n    }\r\n\r\n    setCornerRadius(value) {\r\n        return this.setRadius(value);\r\n    }\r\n}\r\n\r\nvar isArcCorner = function (radius) {\r\n    return ((radius.x !== 0) && (radius.y !== 0));\r\n}\r\n\r\n\r\nObject.assign(\r\n    RoundRectangle.prototype,\r\n    _render_Render_js__WEBPACK_IMPORTED_MODULE_4__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RoundRectangle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js?')},"./lib/rexui/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass RoundRectangle {\r\n    constructor(x, y, width, height, radiusConfig) {\r\n        this.cornerRadius = {};\r\n        this._width = 0;\r\n        this._height = 0;\r\n        this.setTo(x, y, width, height, radiusConfig);\r\n    }\r\n\r\n    setTo(x, y, width, height, radiusConfig) {\r\n        this.setPosition(x, y);\r\n        this.setRadius(radiusConfig);\r\n        this.setSize(width, height);\r\n        return this;\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    setRadius(config) {\r\n        if (config === undefined) {\r\n            config = 0;\r\n        }\r\n        var defaultRadiusX, defaultRadiusY;\r\n        if (typeof (config) === 'number') {\r\n            defaultRadiusX = config;\r\n            defaultRadiusY = config;\r\n        } else {\r\n            defaultRadiusX = GetValue(config, 'x', 0);\r\n            defaultRadiusY = GetValue(config, 'y', 0);\r\n        }\r\n\r\n        var radius = this.cornerRadius;\r\n        radius.tl = GetRadius(GetValue(config, 'tl', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.tr = GetRadius(GetValue(config, 'tr', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.bl = GetRadius(GetValue(config, 'bl', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.br = GetRadius(GetValue(config, 'br', undefined), defaultRadiusX, defaultRadiusY);\r\n        return this;\r\n    }\r\n\r\n    setSize(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    get minWidth() {\r\n        var radius = this.cornerRadius;\r\n        return Math.max(radius.tl.x + radius.tr.x, radius.bl.x + radius.br.x);\r\n    }\r\n\r\n    get minHeight() {\r\n        var radius = this.cornerRadius;\r\n        return Math.max(radius.tl.y + radius.bl.y, radius.tr.y + radius.br.y);\r\n    }\r\n\r\n    get width() {\r\n        return this._width;\r\n    }\r\n\r\n    set width(value) {\r\n        if (value == null) {\r\n            value = 0;\r\n        }\r\n        this._width = Math.max(value, this.minWidth);\r\n    }\r\n\r\n    get height() {\r\n        return this._height;\r\n    }\r\n\r\n    set height(value) {\r\n        if (value == null) {\r\n            value = 0;\r\n        }\r\n        this._height = Math.max(value, this.minHeight);\r\n    }\r\n\r\n    get radius() {\r\n        var radius = this.cornerRadius;\r\n        var max = Math.max(\r\n            radius.tl.x,\r\n            radius.tl.y,\r\n            radius.tr.x,\r\n            radius.tr.y,\r\n            radius.bl.x,\r\n            radius.bl.y,\r\n            radius.br.x,\r\n            radius.br.y\r\n        );\r\n        return max;\r\n    }\r\n}\r\n\r\nvar GetRadius = function (radius, defaultRadiusX, defaultRadiusY) {\r\n    if (radius === undefined) {\r\n        return {\r\n            x: defaultRadiusX,\r\n            y: defaultRadiusY\r\n        };\r\n    } else if (typeof (radius) === 'number') {\r\n        return {\r\n            x: radius,\r\n            y: radius\r\n        };\r\n    } else {\r\n        return radius;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (RoundRectangle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js?")},"./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js":function(module,exports,__webpack_require__){eval('/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar FillStyleCanvas = __webpack_require__(/*! ../../utils/FillStyleCanvas */ "./lib/rexui/plugins/gameobjects/shape/utils/FillStyleCanvas.js");\r\nvar LineStyleCanvas = __webpack_require__(/*! ../../utils/LineStyleCanvas */ "./lib/rexui/plugins/gameobjects/shape/utils/LineStyleCanvas.js");\r\nvar SetTransform = Phaser.Renderer.Canvas.SetTransform;\r\n\r\n/**\r\n * Renders this Game Object with the Canvas Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Polygon#renderCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.Canvas.CanvasRenderer} renderer - A reference to the current active Canvas renderer.\r\n * @param {Phaser.GameObjects.Polygon} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar PolygonCanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    var ctx = renderer.currentContext;\r\n\r\n    if (SetTransform(renderer, ctx, src, camera, parentMatrix)) {\r\n        var dx = src._displayOriginX;\r\n        var dy = src._displayOriginY;\r\n\r\n        var path = src.pathData;\r\n        var pathLength = path.length - 1;\r\n\r\n        var px1 = path[0] - dx;\r\n        var py1 = path[1] - dy;\r\n\r\n        ctx.beginPath();\r\n\r\n        ctx.moveTo(px1, py1);\r\n\r\n        if (!src.closePath) {\r\n            pathLength -= 2;\r\n        }\r\n\r\n        for (var i = 2; i < pathLength; i += 2) {\r\n            var px2 = path[i] - dx;\r\n            var py2 = path[i + 1] - dy;\r\n\r\n            ctx.lineTo(px2, py2);\r\n        }\r\n\r\n        ctx.closePath();\r\n\r\n        if (src.isFilled) {\r\n            FillStyleCanvas(ctx, src);\r\n\r\n            ctx.fill();\r\n        }\r\n\r\n        if (src.isStroked) {\r\n            LineStyleCanvas(ctx, src);\r\n\r\n            ctx.stroke();\r\n        }\r\n\r\n        //  Restore the context saved in SetTransform\r\n        ctx.restore();\r\n    }\r\n};\r\n\r\nmodule.exports = PolygonCanvasRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js?')},"./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js");\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default.a;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/Render.js?')},"./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js":function(module,exports,__webpack_require__){eval('/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar FillPathWebGL = __webpack_require__(/*! ../../utils/FillPathWebGL */ "./lib/rexui/plugins/gameobjects/shape/utils/FillPathWebGL.js");\r\nvar StrokePathWebGL = __webpack_require__(/*! ../../utils/StrokePathWebGL */ "./lib/rexui/plugins/gameobjects/shape/utils/StrokePathWebGL.js");\r\n\r\n/**\r\n * Renders this Game Object with the WebGL Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Polygon#renderWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLRenderer} renderer - A reference to the current active WebGL renderer.\r\n * @param {Phaser.GameObjects.Polygon} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar PolygonWebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix)\r\n{\r\n    var pipeline = this.pipeline;\r\n\r\n    var camMatrix = pipeline._tempMatrix1;\r\n    var shapeMatrix = pipeline._tempMatrix2;\r\n    var calcMatrix = pipeline._tempMatrix3;\r\n\r\n    renderer.setPipeline(pipeline);\r\n\r\n    shapeMatrix.applyITRS(src.x, src.y, src.rotation, src.scaleX, src.scaleY);\r\n\r\n    camMatrix.copyFrom(camera.matrix);\r\n\r\n    if (parentMatrix)\r\n    {\r\n        //  Multiply the camera by the parent matrix\r\n        camMatrix.multiplyWithOffset(parentMatrix, -camera.scrollX * src.scrollFactorX, -camera.scrollY * src.scrollFactorY);\r\n\r\n        //  Undo the camera scroll\r\n        shapeMatrix.e = src.x;\r\n        shapeMatrix.f = src.y;\r\n    }\r\n    else\r\n    {\r\n        shapeMatrix.e -= camera.scrollX * src.scrollFactorX;\r\n        shapeMatrix.f -= camera.scrollY * src.scrollFactorY;\r\n    }\r\n\r\n    camMatrix.multiply(shapeMatrix, calcMatrix);\r\n\r\n    var dx = src._displayOriginX;\r\n    var dy = src._displayOriginY;\r\n\r\n    var alpha = camera.alpha * src.alpha;\r\n\r\n    if (src.isFilled)\r\n    {\r\n        FillPathWebGL(pipeline, calcMatrix, src, alpha, dx, dy);\r\n    }\r\n\r\n    if (src.isStroked)\r\n    {\r\n        StrokePathWebGL(pipeline, src, alpha, dx, dy);\r\n    }\r\n};\r\n\r\nmodule.exports = PolygonWebGLRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js?')},"./lib/rexui/plugins/gameobjects/shape/utils/ArcTo.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _LineTo_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LineTo.js */ "./lib/rexui/plugins/gameobjects/shape/utils/LineTo.js");\n/* harmony import */ var _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/math/DegToRad.js */ "./lib/rexui/plugins/utils/math/DegToRad.js");\n/* harmony import */ var _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar ArcTo = function (centerX, centerY, radius, startAngle, endAngle, antiClockWise, iteration, out) {\r\n    var radiusX = GetValue(radius, \'x\', radius);\r\n    var radiusY = GetValue(radius, \'y\', radius);\r\n\r\n    // startAngle, endAngle: 0 ~ 360\r\n    if (antiClockWise) {\r\n        endAngle += 360;\r\n    }\r\n\r\n    startAngle = _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default()(startAngle);\r\n    endAngle = _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default()(endAngle);\r\n    var x, y, angle;\r\n    var step = (endAngle - startAngle) / iteration;\r\n    for (var i = 0; i <= iteration; i++) {\r\n        angle = startAngle + (step * i);\r\n        x = centerX + (radiusX * Math.cos(angle));\r\n        y = centerY + (radiusY * Math.sin(angle));\r\n        Object(_LineTo_js__WEBPACK_IMPORTED_MODULE_0__["default"])(x, y, out);\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (ArcTo);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/ArcTo.js?')},"./lib/rexui/plugins/gameobjects/shape/utils/FillPathWebGL.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders a filled path for the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#FillPathWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLPipeline} pipeline - The WebGL Pipeline used to render this Shape.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} calcMatrix - The transform matrix used to get the position values.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object shape being rendered in this call.\r\n * @param {number} alpha - The base alpha value.\r\n * @param {number} dx - The source displayOriginX.\r\n * @param {number} dy - The source displayOriginY.\r\n */\r\nvar FillPathWebGL = function (pipeline, calcMatrix, src, alpha, dx, dy)\r\n{\r\n    var fillTintColor = Utils.getTintAppendFloatAlphaAndSwap(src.fillColor, src.fillAlpha * alpha);\r\n\r\n    var path = src.pathData;\r\n    var pathIndexes = src.pathIndexes;\r\n\r\n    for (var i = 0; i < pathIndexes.length; i += 3)\r\n    {\r\n        var p0 = pathIndexes[i] * 2;\r\n        var p1 = pathIndexes[i + 1] * 2;\r\n        var p2 = pathIndexes[i + 2] * 2;\r\n\r\n        var x0 = path[p0 + 0] - dx;\r\n        var y0 = path[p0 + 1] - dy;\r\n        var x1 = path[p1 + 0] - dx;\r\n        var y1 = path[p1 + 1] - dy;\r\n        var x2 = path[p2 + 0] - dx;\r\n        var y2 = path[p2 + 1] - dy;\r\n\r\n        var tx0 = calcMatrix.getX(x0, y0);\r\n        var ty0 = calcMatrix.getY(x0, y0);\r\n\r\n        var tx1 = calcMatrix.getX(x1, y1);\r\n        var ty1 = calcMatrix.getY(x1, y1);\r\n\r\n        var tx2 = calcMatrix.getX(x2, y2);\r\n        var ty2 = calcMatrix.getY(x2, y2);\r\n    \r\n        pipeline.setTexture2D();\r\n\r\n        pipeline.batchTri(tx0, ty0, tx1, ty1, tx2, ty2, 0, 0, 1, 1, fillTintColor, fillTintColor, fillTintColor, pipeline.tintEffect);\r\n    }\r\n};\r\n\r\nmodule.exports = FillPathWebGL;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/FillPathWebGL.js?")},"./lib/rexui/plugins/gameobjects/shape/utils/FillStyleCanvas.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * Sets the fillStyle on the target context based on the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#FillStyleCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {CanvasRenderingContext2D} ctx - The context to set the fill style on.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object to set the fill style from.\r\n * @param {number} [altColor] - An alternative color to render with.\r\n * @param {number} [altAlpha] - An alternative alpha to render with.\r\n */\r\nvar FillStyleCanvas = function (ctx, src, altColor, altAlpha)\r\n{\r\n    var fillColor = (altColor) ? altColor : src.fillColor;\r\n    var fillAlpha = (altAlpha) ? altAlpha : src.fillAlpha;\r\n\r\n    var red = ((fillColor & 0xFF0000) >>> 16);\r\n    var green = ((fillColor & 0xFF00) >>> 8);\r\n    var blue = (fillColor & 0xFF);\r\n\r\n    ctx.fillStyle = 'rgba(' + red + ',' + green + ',' + blue + ',' + fillAlpha + ')';\r\n};\r\n\r\nmodule.exports = FillStyleCanvas;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/FillStyleCanvas.js?")},"./lib/rexui/plugins/gameobjects/shape/utils/LineStyleCanvas.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * Sets the strokeStyle and lineWidth on the target context based on the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#LineStyleCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {CanvasRenderingContext2D} ctx - The context to set the stroke style on.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object to set the stroke style from.\r\n * @param {number} [altColor] - An alternative color to render with.\r\n * @param {number} [altAlpha] - An alternative alpha to render with.\r\n */\r\nvar LineStyleCanvas = function (ctx, src, altColor, altAlpha)\r\n{\r\n    var strokeColor = (altColor) ? altColor : src.strokeColor;\r\n    var strokeAlpha = (altAlpha) ? altAlpha : src.strokeAlpha;\r\n\r\n    var red = ((strokeColor & 0xFF0000) >>> 16);\r\n    var green = ((strokeColor & 0xFF00) >>> 8);\r\n    var blue = (strokeColor & 0xFF);\r\n\r\n    ctx.strokeStyle = 'rgba(' + red + ',' + green + ',' + blue + ',' + strokeAlpha + ')';\r\n    ctx.lineWidth = src.lineWidth;\r\n};\r\n\r\nmodule.exports = LineStyleCanvas;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/LineStyleCanvas.js?")},"./lib/rexui/plugins/gameobjects/shape/utils/LineTo.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LineTo = function (x, y, out) {\r\n    var cnt = out.length;\r\n    if (cnt >= 2) {\r\n        var lastX = out[cnt - 2];\r\n        var lastY = out[cnt - 1];\r\n        if ((x === lastX) && (y === lastY)) {\r\n            return out;\r\n        }\r\n    }\r\n\r\n    out.push(x, y);\r\n    return out;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LineTo);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/LineTo.js?')},"./lib/rexui/plugins/gameobjects/shape/utils/StrokePathWebGL.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders a stroke outline around the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#StrokePathWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLPipeline} pipeline - The WebGL Pipeline used to render this Shape.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object shape being rendered in this call.\r\n * @param {number} alpha - The base alpha value.\r\n * @param {number} dx - The source displayOriginX.\r\n * @param {number} dy - The source displayOriginY.\r\n */\r\nvar StrokePathWebGL = function (pipeline, src, alpha, dx, dy)\r\n{\r\n    var strokeTint = pipeline.strokeTint;\r\n    var strokeTintColor = Utils.getTintAppendFloatAlphaAndSwap(src.strokeColor, src.strokeAlpha * alpha);\r\n\r\n    strokeTint.TL = strokeTintColor;\r\n    strokeTint.TR = strokeTintColor;\r\n    strokeTint.BL = strokeTintColor;\r\n    strokeTint.BR = strokeTintColor;\r\n\r\n    var path = src.pathData;\r\n    var pathLength = path.length - 1;\r\n    var lineWidth = src.lineWidth;\r\n    var halfLineWidth = lineWidth / 2;\r\n\r\n    var px1 = path[0] - dx;\r\n    var py1 = path[1] - dy;\r\n\r\n    if (!src.closePath)\r\n    {\r\n        pathLength -= 2;\r\n    }\r\n\r\n    for (var i = 2; i < pathLength; i += 2)\r\n    {\r\n        var px2 = path[i] - dx;\r\n        var py2 = path[i + 1] - dy;\r\n\r\n        pipeline.setTexture2D();\r\n\r\n        pipeline.batchLine(\r\n            px1,\r\n            py1,\r\n            px2,\r\n            py2,\r\n            halfLineWidth,\r\n            halfLineWidth,\r\n            lineWidth,\r\n            i - 2,\r\n            (src.closePath) ? (i === pathLength - 1) : false\r\n        );\r\n\r\n        px1 = px2;\r\n        py1 = py2;\r\n    }\r\n};\r\n\r\nmodule.exports = StrokePathWebGL;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/shape/utils/StrokePathWebGL.js?")},"./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/Text.js */ "./lib/rexui/plugins/gameobjects/text/textbase/Text.js");\n/* harmony import */ var _Parser_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Parser.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/Parser.js");\n\r\n\r\n\r\nclass BBCodeText extends _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, text, style) {\r\n        super(scene, x, y, text, style, \'rexBBCodeText\', _Parser_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BBCodeText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js?')},"./lib/rexui/plugins/gameobjects/text/bbocdetext/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ \"./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js\");\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (function (config, addToScene) {\r\n    // style Object = {\r\n    //     font: [ 'font', '16px Courier' ],\r\n    //     backgroundColor: [ 'backgroundColor', null ],\r\n    //     fill: [ 'fill', '#fff' ],\r\n    //     stroke: [ 'stroke', '#fff' ],\r\n    //     strokeThickness: [ 'strokeThickness', 0 ],\r\n    //     shadowOffsetX: [ 'shadow.offsetX', 0 ],\r\n    //     shadowOffsetY: [ 'shadow.offsetY', 0 ],\r\n    //     shadowColor: [ 'shadow.color', '#000' ],\r\n    //     shadowBlur: [ 'shadow.blur', 0 ],\r\n    //     shadowStroke: [ 'shadow.stroke', false ],\r\n    //     shadowFill: [ 'shadow.fill', false ],\r\n    //     align: [ 'align', 'left' ],\r\n    //     maxLines: [ 'maxLines', 0 ],\r\n    //     fixedWidth: [ 'fixedWidth', false ],\r\n    //     fixedHeight: [ 'fixedHeight', false ]\r\n    // }\r\n\r\n    var content = GetAdvancedValue(config, 'text', '');\r\n    var style = GetAdvancedValue(config, 'style', null);\r\n\r\n    //  Padding\r\n    //      { padding: 2 }\r\n    //      { padding: { x: , y: }}\r\n    //      { padding: { left: , top: }}\r\n    //      { padding: { left: , right: , top: , bottom: }}  \r\n\r\n    var padding = GetAdvancedValue(config, 'padding', null);\r\n\r\n    if (padding !== null) {\r\n        style.padding = padding;\r\n    }\r\n\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.scene, 0, 0, content, style);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n\r\n    //  Text specific config options:\r\n\r\n    gameObject.autoRound = GetAdvancedValue(config, 'autoRound', true);\r\n    gameObject.resolution = GetAdvancedValue(config, 'resolution', 1);\r\n\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/bbocdetext/Creator.js?")},"./lib/rexui/plugins/gameobjects/text/bbocdetext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, text, style) {\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/bbocdetext/Factory.js?')},"./lib/rexui/plugins/gameobjects/text/bbocdetext/Parser.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/textstyle/TextStyle.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n\r\n\r\nvar GETPROP_RESULT = {\r\n    plainText: null,\r\n    prevProp: null\r\n};\r\n\r\nvar STYLE_RESULT = new _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\nvar EMPTYPROP = {};\r\n\r\nvar parser = {\r\n    splitText: function (text, mode) {\r\n        var result = [];\r\n        var arr, m, charIdx = 0,\r\n            totalLen = text.length,\r\n            matchStart = totalLen;\r\n\r\n        while (true) {\r\n            arr = RE_SPLITTEXT.exec(text);\r\n            if (!arr) {\r\n                break;\r\n            }\r\n\r\n            m = arr[0];\r\n            matchStart = RE_SPLITTEXT.lastIndex - m.length;\r\n\r\n            if (charIdx < matchStart) {\r\n                result.push(text.substring(charIdx, matchStart));\r\n            }\r\n\r\n            if (mode === undefined) {\r\n                result.push(m);\r\n            }\r\n\r\n            charIdx = RE_SPLITTEXT.lastIndex;\r\n        }\r\n\r\n        if (charIdx < totalLen) {\r\n            result.push(text.substring(charIdx, totalLen));\r\n        }\r\n        return result; // [text,...]\r\n    },\r\n\r\n    tagTextToProp: function (text, prevProp) {\r\n        var plainText, innerMatch;\r\n\r\n        if (prevProp == null) {\r\n            prevProp = {};\r\n        }\r\n\r\n        // close image tag\r\n        if (prevProp.img) {\r\n            updateProp(prevProp, PROP_REMOVE, 'img');\r\n        }\r\n        // Check if current fragment is a class tag\r\n        if (RE_BLOD_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'b', true);\r\n            plainText = '';\r\n        } else if (RE_BLOD_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'b');\r\n            plainText = '';\r\n        } else if (RE_ITALICS_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'i', true);\r\n            plainText = '';\r\n        } else if (RE_ITALICS_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'i');\r\n            plainText = '';\r\n        } else if (RE_SIZE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_SIZE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'size', innerMatch[1] + 'px');\r\n            plainText = '';\r\n        } else if (RE_SIZE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'size');\r\n            plainText = '';\r\n        } else if (RE_COLOR_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_COLOR_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'color', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_COLOR_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'color');\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_UNDERLINE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'u', true);\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_OPENC.test(text)) {\r\n            innerMatch = text.match(RE_UNDERLINE_OPENC);\r\n            updateProp(prevProp, PROP_ADD, 'u', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'u');\r\n            plainText = '';\r\n        } else if (RE_SHADOW_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'shadow', true);\r\n            plainText = '';\r\n        } else if (RE_SHADOW_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'shadow');\r\n            plainText = '';\r\n        } else if (RE_STROKE_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'stroke', true);\r\n            plainText = '';\r\n        } else if (RE_STROKE_OPENC.test(text)) {\r\n            innerMatch = text.match(RE_STROKE_OPENC);\r\n            updateProp(prevProp, PROP_ADD, 'stroke', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_STROKE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'stroke');\r\n            plainText = '';\r\n        } else if (RE_IMAGE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_IMAGE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'img', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_IMAGE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'img');\r\n            plainText = '';\r\n        } else if (RE_AREA_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_AREA_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'area', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_AREA_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'area');\r\n            plainText = '';            \r\n        } else {\r\n            plainText = text\r\n        }\r\n\r\n        var result = GETPROP_RESULT;\r\n        result.plainText = plainText;\r\n        result.prop = prevProp;\r\n        return result;\r\n    },\r\n\r\n    propToContextStyle: function (defaultStyle, prop) {\r\n        var result = STYLE_RESULT;\r\n        if (!prop.hasOwnProperty('img')) {\r\n            result.image = null;\r\n\r\n            if (prop.hasOwnProperty('family')) {\r\n                result.fontFamily = prop.family;\r\n            } else {\r\n                result.fontFamily = defaultStyle.fontFamily;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('size')) {\r\n                var size = prop.size;\r\n                if (typeof (size) === 'number') {\r\n                    size = size.toString() + 'px';\r\n                }\r\n                result.fontSize = size;\r\n            } else {\r\n                result.fontSize = defaultStyle.fontSize;\r\n            }\r\n            result.fontStyle = getFontStyle(prop.b, prop.i);\r\n\r\n            if (prop.hasOwnProperty('color')) {\r\n                result.color = prop.color;\r\n            } else {\r\n                result.color = defaultStyle.color;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('stroke')) {\r\n                if (prop.stroke === true) {\r\n                    result.stroke = defaultStyle.stroke;\r\n                    result.strokeThickness = defaultStyle.strokeThickness;\r\n                } else {\r\n                    result.stroke = prop.stroke;\r\n                    result.strokeThickness = defaultStyle.strokeThickness;\r\n                }\r\n            } else {\r\n                result.stroke = defaultStyle.stroke;\r\n                result.strokeThickness = 0;\r\n            }\r\n        } else {\r\n            result.image = prop.img;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('shadow')) {\r\n            if (prop.shadow === true) {\r\n                result.shadowColor = defaultStyle.shadowColor;\r\n                result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n                result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n                result.shadowBlur = defaultStyle.shadowBlur;\r\n                result.shadowStroke = true;\r\n                result.shadowFill = true;\r\n            } else {\r\n                result.shadowColor = prop.shadow;\r\n                result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n                result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n                result.shadowBlur = defaultStyle.shadowBlur;\r\n                result.shadowStroke = true;\r\n                result.shadowFill = true;\r\n            }\r\n        } else {\r\n            result.shadowColor = '#000';\r\n            result.shadowOffsetX = 0;\r\n            result.shadowOffsetY = 0;\r\n            result.shadowBlur = 0;\r\n            result.shadowStroke = false;\r\n            result.shadowFill = false;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('u')) {\r\n            if (prop.u === true) {\r\n                result.underlineColor = defaultStyle.underlineColor;\r\n                result.underlineThickness = defaultStyle.underlineThickness;\r\n                result.underlineOffset = defaultStyle.underlineOffset;\r\n            } else {\r\n                result.underlineColor = prop.u;\r\n                result.underlineThickness = defaultStyle.underlineThickness;\r\n                result.underlineOffset = defaultStyle.underlineOffset;\r\n            }\r\n        } else {\r\n            result.underlineColor = '#000';\r\n            result.underlineThickness = 0;\r\n            result.underlineOffset = 0;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    propToTagText: function (text, prop, prevProp) {\r\n        if (prevProp == null) {\r\n            prevProp = EMPTYPROP;\r\n        }\r\n\r\n        for (var k in prevProp) {\r\n            if (prop.hasOwnProperty(k)) {\r\n                continue;\r\n            }\r\n\r\n            text = '[/' + k + ']' + text;\r\n        }\r\n\r\n        var header = '';\r\n        for (var k in prop) {\r\n            if (prevProp[k] === prop[k]) {\r\n                continue;\r\n            }\r\n\r\n            if (k === 'size') {\r\n                header += ('[size=' + prop[k].replace('px', '') + ']');\r\n            } else if ((k === 'color') || (k === 'stroke') || (k === 'img')) {\r\n                header += ('[' + k + '=' + prop[k] + ']');\r\n            } else if (k === 'u') {\r\n                if (prop[k] === true) {\r\n                    header += '[u]';\r\n                } else {\r\n                    header += ('[u=' + prop[k] + ']');\r\n                }\r\n            } else {\r\n                header += ('[' + k + ']');\r\n            }\r\n        }\r\n        text = header + text;\r\n\r\n        return text;\r\n    }\r\n};\r\n\r\nvar updateProp = function (prop, op, key, value) {\r\n    if (op === PROP_ADD) {\r\n        // PROP_ADD     \r\n        prop[key] = value;\r\n    } else {\r\n        // PROP_REMOVE        \r\n        if (prop.hasOwnProperty(key)) {\r\n            delete prop[key];\r\n        }\r\n    }\r\n\r\n    return prop;\r\n};\r\n\r\nvar getFontStyle = function (isBold, isItalic) {\r\n    if (isBold && isItalic) {\r\n        return 'bold italic';\r\n    } else if (isBold) {\r\n        return 'bold';\r\n    } else if (isItalic) {\r\n        return 'italic';\r\n    } else {\r\n        return '';\r\n    }\r\n};\r\n\r\nvar RE_SPLITTEXT = /\\[b\\]|\\[\\/b\\]|\\[i\\]|\\[\\/i\\]|\\[size=(\\d+)\\]|\\[\\/size\\]|\\[color=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/color\\]|\\[u\\]|\\[u=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/u\\]|\\[shadow\\]|\\[\\/shadow\\]|\\[stroke\\]|\\[stroke=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/stroke\\]|\\[img=([^\\]]+)\\]|\\[\\/img\\]|\\[area=([^\\]]+)\\]|\\[\\/area\\]/ig;\r\n\r\nvar RE_BLOD_OPEN = /\\[b\\]/i;\r\nvar RE_BLOD_CLOSE = /\\[\\/b\\]/i;\r\nvar RE_ITALICS_OPEN = /\\[i\\]/i;\r\nvar RE_ITALICS_CLOSE = /\\[\\/i\\]/i;\r\nvar RE_SIZE_OPEN = /\\[size=(\\d+)\\]/i;\r\nvar RE_SIZE_CLOSE = /\\[\\/size\\]/i;\r\nvar RE_COLOR_OPEN = /\\[color=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_COLOR_CLOSE = /\\[\\/color\\]/i;\r\nvar RE_UNDERLINE_OPEN = /\\[u\\]/i;\r\nvar RE_UNDERLINE_OPENC = /\\[u=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_UNDERLINE_CLOSE = /\\[\\/u\\]/i;\r\nvar RE_SHADOW_OPEN = /\\[shadow\\]/i;\r\nvar RE_SHADOW_CLOSE = /\\[\\/shadow\\]/i;\r\nvar RE_STROKE_OPEN = /\\[stroke\\]/i;\r\nvar RE_STROKE_OPENC = /\\[stroke=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_STROKE_CLOSE = /\\[\\/stroke\\]/i;\r\nvar RE_IMAGE_OPEN = /\\[img=([^\\]]+)\\]/i;\r\nvar RE_IMAGE_CLOSE = /\\[\\/img\\]/i;\r\nvar RE_AREA_OPEN = /\\[area=([^\\]]+)\\]/i;\r\nvar RE_AREA_CLOSE = /\\[\\/area\\]/i;\r\nconst PROP_REMOVE = false;\r\nconst PROP_ADD = true;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (parser);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/bbocdetext/Parser.js?")},"./lib/rexui/plugins/gameobjects/text/tagtext/Parser.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/textstyle/TextStyle.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n\r\n\r\nvar GETPROP_RESULT = {\r\n    plainText: null,\r\n    prevProp: null\r\n};\r\n\r\nvar STYLE_RESULT = new _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\nvar PROPLIST = [];\r\n\r\nclass parser {\r\n    constructor(tags) {\r\n        if (tags === undefined) {\r\n            tags = {};\r\n        }\r\n        this.tags = tags;\r\n    }\r\n\r\n    addTag(name, prop) {\r\n        this.tags[name] = prop;\r\n    }\r\n\r\n    splitText(text, mode) {\r\n        var result = [];\r\n        var arr, m, charIdx = 0,\r\n            totalLen = text.length,\r\n            matchStart = totalLen;\r\n        var innerMatch;\r\n        while (true) {\r\n            arr = RE_SPLITTEXT.exec(text);\r\n            if (!arr) {\r\n                break;\r\n            }\r\n\r\n            m = arr[0];\r\n            matchStart = RE_SPLITTEXT.lastIndex - m.length;\r\n\r\n            if (charIdx < matchStart) {\r\n                result.push(text.substring(charIdx, matchStart));\r\n            }\r\n            if (mode === undefined) {\r\n                result.push(m);\r\n            } else if (mode === 1) { // RAWTEXTONLY_MODE\r\n                if (RE_CLASS_HEADER.test(m)) {\r\n                    innerMatch = m.match(RE_CLASS);\r\n                    result.push(innerMatch[2]);\r\n                } else if (RE_STYLE_HEADER.test(m)) {\r\n                    innerMatch = m.match(RE_STYLE);\r\n                    result.push(innerMatch[2]);\r\n                }\r\n            }\r\n\r\n            charIdx = RE_SPLITTEXT.lastIndex;\r\n        }\r\n\r\n\r\n        if (charIdx < totalLen) {\r\n            result.push(text.substring(charIdx, totalLen));\r\n        }\r\n        return result; // [text,...]\r\n    }\r\n\r\n    tagTextToProp(text, prevProp) {\r\n        var plainText, propOut;\r\n        if (RE_CLASS_HEADER.test(text)) {\r\n            var innerMatch = text.match(RE_CLASS);\r\n            if (innerMatch != null) {\r\n                var name = innerMatch[1];\r\n                var tags = this.tags;\r\n                if (tags.hasOwnProperty(name)) {\r\n                    propOut = tags[name];\r\n                } else {\r\n                    propOut = {};\r\n                }\r\n                propOut._class = name;\r\n                plainText = innerMatch[2];\r\n            }\r\n        } else if (RE_STYLE_HEADER.test(text)) {\r\n            var innerMatch = text.match(RE_STYLE);\r\n            if (innerMatch != null) {\r\n                var style = innerMatch[1];\r\n                propOut = styleToProp(style);\r\n                propOut._style = style;\r\n                plainText = innerMatch[2];\r\n            }\r\n        }\r\n\r\n        if (plainText == null) {\r\n            plainText = text;\r\n        }\r\n\r\n        if (propOut == null) {\r\n            propOut = {};\r\n        }\r\n\r\n        var result = GETPROP_RESULT;\r\n        result.plainText = plainText;\r\n        result.prop = propOut;\r\n        return result;\r\n    }\r\n\r\n    propToContextStyle(defaultStyle, prop) {\r\n        var result = STYLE_RESULT;\r\n        if (!prop.hasOwnProperty('img')) {\r\n            result.image = null;\r\n\r\n            if (prop.hasOwnProperty('family') || prop.hasOwnProperty('fontFamily') || prop.hasOwnProperty('font-family')) {\r\n                var family = (prop.hasOwnProperty('family')) ? prop.family :\r\n                    (prop.hasOwnProperty('fontFamily')) ? prop.fontFamily :\r\n                    prop['font-family'];\r\n                result.fontFamily = family;\r\n            } else {\r\n                result.fontFamily = defaultStyle.fontFamily;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('size') || prop.hasOwnProperty('fontSize') || prop.hasOwnProperty('font-size')) {\r\n                var size = (prop.hasOwnProperty('size')) ? prop.size :\r\n                    (prop.hasOwnProperty('fontSize')) ? prop.fontSize :\r\n                    prop['font-size'];\r\n                if (typeof (size) === 'number') {\r\n                    size = size.toString() + 'px';\r\n                }\r\n                result.fontSize = size;\r\n            } else {\r\n                result.fontSize = defaultStyle.fontSize;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('style') || prop.hasOwnProperty('fontStyle') || prop.hasOwnProperty('font-style')) {\r\n                var fontStyle = (prop.hasOwnProperty('style')) ? prop.style :\r\n                    (prop.hasOwnProperty('fontStyle')) ? prop.fontStyle :\r\n                    prop['font-style'];\r\n                result.fontStyle = fontStyle;\r\n            } else {\r\n                result.fontStyle = defaultStyle.fontStyle;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('color') || prop.hasOwnProperty('font-color')) {\r\n                var color = (prop.hasOwnProperty('color')) ? prop.color : prop['font-color'];\r\n                result.color = prop.color;\r\n            } else {\r\n                result.color = defaultStyle.color;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('stroke')) {\r\n                var stroke = prop.stroke; // {color, thinkness}\r\n                result.stroke = (stroke.hasOwnProperty('color')) ? stroke.color : defaultStyle.stroke;\r\n                result.strokeThickness = (stroke.hasOwnProperty('thinkness')) ? stroke.thinkness : defaultStyle.strokeThickness;\r\n            } else {\r\n                result.stroke = defaultStyle.stroke;\r\n                result.strokeThickness = defaultStyle.strokeThickness;\r\n            }\r\n        } else {\r\n            result.image = prop.img;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('shadow')) {\r\n            var shadow = prop.shadow; // {color, offsetX, offsetY, blur}\r\n            result.shadowColor = (shadow.hasOwnProperty('color')) ? shadow.color : defaultStyle.shadowColor;\r\n            result.shadowOffsetX = (shadow.hasOwnProperty('offsetX')) ? shadow.offsetX : defaultStyle.shadowOffsetX;\r\n            result.shadowOffsetY = (shadow.hasOwnProperty('offsetY')) ? shadow.offsetY : defaultStyle.shadowOffsetY;\r\n            result.shadowBlur = (shadow.hasOwnProperty('blur')) ? shadow.blur : defaultStyle.shadowBlur;\r\n            result.shadowStroke = true;\r\n            result.shadowFill = true;\r\n        } else {\r\n            result.shadowColor = defaultStyle.shadowColor;\r\n            result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n            result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n            result.shadowBlur = defaultStyle.shadowBlur;\r\n            result.shadowStroke = defaultStyle.shadowStroke;\r\n            result.shadowFill = defaultStyle.shadowFill;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('u') || prop.hasOwnProperty('underline')) {\r\n            var u = (prop.hasOwnProperty('u')) ? prop.u : prop.underline; // {color, thinkness, offset}\r\n            result.underlineColor = (u.hasOwnProperty('color')) ? u.color : defaultStyle.underlineColor;\r\n            result.underlineThickness = (u.hasOwnProperty('thinkness')) ? u.thinkness : defaultStyle.underlineThickness;\r\n            result.underlineOffset = (u.hasOwnProperty('offset')) ? u.offset : defaultStyle.underlineOffset;\r\n        } else {\r\n            result.underlineColor = defaultStyle.underlineColor;\r\n            result.underlineThickness = defaultStyle.underlineThickness;\r\n            result.underlineOffset = defaultStyle.underlineOffset;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    propToTagText(text, prop, prevProp) {\r\n        if (prop.hasOwnProperty('_class')) { // class mode\r\n            if (text === '') {\r\n                if (this.isTextTag(prop._class)) {\r\n                    return '';\r\n                }\r\n            }\r\n            return \"<class='\" + prop._class + \"'>\" + text + \"</class>\";\r\n        } else if (prop.hasOwnProperty('_style')) { // class mode\r\n            return \"<style='\" + prop._style + \"'>\" + text + \"</style>\";\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.tags = undefined;\r\n    }\r\n\r\n    isTextTag(tagName) {\r\n        var tag = this.tags[tagName];\r\n        if (tag) {\r\n            return (tag.img == null);\r\n        } else { // tag not found\r\n            return false;\r\n        }\r\n    }\r\n};\r\n\r\nvar styleToProp = function (s) {\r\n    s = s.split(\";\");\r\n\r\n    var result = {},\r\n        prop, k, v;\r\n    for (var i = 0, slen = s.length; i < slen; i++) {\r\n        prop = s[i].split(\":\");\r\n        k = prop[0], v = prop[1];\r\n        if (isEmpty(k) || isEmpty(v)) {\r\n            continue;\r\n        }\r\n\r\n        switch (k) {\r\n            case 'stroke':\r\n                var stroke = v.split(' '); // stroke:blue 1px\r\n                var len = stroke.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = stroke[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.thinkness = parseInt(stroke[1].replace('px', ''));\r\n                }\r\n                break;\r\n            case 'shadow':\r\n                var shadow = v.split(' '); // shadow:blue 2px 2px 2px\r\n                var len = shadow.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = shadow[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.offsetX = parseInt(shadow[1].replace('px', ''));\r\n                }\r\n                if (len >= 3) {\r\n                    v.offsetY = parseInt(shadow[2].replace('px', ''));\r\n                }\r\n                if (len >= 4) {\r\n                    v.blur = parseInt(shadow[3].replace('px', ''));\r\n                }\r\n                break;\r\n            case 'u':\r\n            case 'underline': // underline:blue 3px -1px\r\n                var u = v.split(' ');\r\n                var len = u.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = u[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.thinkness = parseInt(u[1].replace('px', ''));\r\n                }\r\n                if (len >= 3) {\r\n                    v.offset = parseInt(u[2].replace('px', ''));\r\n                }\r\n                break;\r\n        }\r\n        result[k] = v;\r\n    }\r\n    return result;\r\n};\r\n\r\nvar isEmpty = function (s) {\r\n    // Remove white spaces.\r\n    s = s.replace(RE_SPACE, '');\r\n    return (s.length === 0);\r\n};\r\n\r\nvar RE_SPLITTEXT = /<\\s*class=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/class\\s*\\>|<\\s*style=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/style\\s*\\>/g;\r\nvar RE_CLASS_HEADER = /<\\s*class=/i;\r\nvar RE_CLASS = /<\\s*class=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/class\\s*\\>/;\r\nvar RE_STYLE_HEADER = /<\\s*style=/i;\r\nvar RE_STYLE = /<\\s*style=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/style\\s*\\>/;\r\nvar RE_SPACE = /^\\s+|\\s+$/;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (parser);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/tagtext/Parser.js?")},"./lib/rexui/plugins/gameobjects/text/tagtext/TagText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/Text.js */ "./lib/rexui/plugins/gameobjects/text/textbase/Text.js");\n/* harmony import */ var _Parser_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Parser.js */ "./lib/rexui/plugins/gameobjects/text/tagtext/Parser.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TagText extends _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, text, style) {\r\n        var tags = GetValue(style, \'tags\', undefined);\r\n        var parser = new _Parser_js__WEBPACK_IMPORTED_MODULE_1__["default"](tags);\r\n        super(scene, x, y, text, style, \'rexTagText\', parser);\r\n        this.parser = parser;\r\n    }\r\n\r\n    addTag(name, prop) {\r\n        this.parser.addTag(name, prop);\r\n        return this.updateText(true);\r\n    }\r\n\r\n    addTags(tags) {\r\n        for(var name in tags){\r\n            this.parser.addTag(name, tags[name]);\r\n        }\r\n        return this.updateText(true);\r\n    }\r\n\r\n    preDestroy() {\r\n        super.preDestroy();\r\n        this.parser.destroy();\r\n        this.parser = undefined;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TagText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/tagtext/TagText.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/Text.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./render/Render.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/render/Render.js\");\n/* harmony import */ var _textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./textstyle/TextStyle.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n/* harmony import */ var _canvastext_CanvasText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./canvastext/CanvasText.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/canvastext/CanvasText.js\");\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../pool.js */ \"./lib/rexui/plugins/pool.js\");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./const.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/const.js\");\n/* harmony import */ var _imagemanager_GetGlobImageManager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./imagemanager/GetGlobImageManager.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js\");\n\r\n // extended\r\n\r\n\r\n\r\n\r\n\r\nconst AddToDOM = Phaser.DOM.AddToDOM;\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\nconst GameObject = Phaser.GameObjects.GameObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveFromDOM = Phaser.DOM.RemoveFromDOM;\r\nconst SPLITREGEXP = _const_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].SPLITREGEXP;\r\n\r\nvar PensPools = {};\r\n\r\nclass Text extends GameObject {\r\n    constructor(scene, x, y, text, style, type, parser) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        super(scene, type);\r\n\r\n        this.renderer = scene.sys.game.renderer;\r\n\r\n        this.setPosition(x, y);\r\n        this.setOrigin(0, 0);\r\n        this.initPipeline();\r\n\r\n        this.canvas = CanvasPool.create(this);\r\n\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        if (style) {\r\n            // Override align\r\n            if (style.hasOwnProperty('align')) {\r\n                var halign = style.align;\r\n                delete style.align;\r\n                style.halign = halign;\r\n            }\r\n        }\r\n        this.style = new _textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, style);\r\n\r\n        this.autoRound = true;\r\n\r\n        this._text = undefined;\r\n\r\n        this.padding = {\r\n            left: 0,\r\n            right: 0,\r\n            top: 0,\r\n            bottom: 0\r\n        };\r\n\r\n        this.width = 1;\r\n\r\n        this.height = 1;\r\n\r\n        this.dirty = false;\r\n\r\n        //  If resolution wasn't set, then we get it from the game config\r\n        if (this.style.resolution === 0) {\r\n            this.style.resolution = scene.sys.game.config.resolution;\r\n        }\r\n\r\n        this._crop = this.resetCropObject();\r\n\r\n        //  Create a Texture for this Text object\r\n        this.texture = scene.sys.textures.addCanvas(null, this.canvas, true);\r\n\r\n        //  Get the frame\r\n        this.frame = this.texture.get();\r\n\r\n        //  Set the resolution\r\n        this.frame.source.resolution = this.style.resolution;\r\n\r\n        if (this.renderer && this.renderer.gl) {\r\n            //  Clear the default 1x1 glTexture, as we override it later\r\n\r\n            this.renderer.deleteTexture(this.frame.source.glTexture);\r\n\r\n            this.frame.source.glTexture = null;\r\n        }\r\n\r\n        if (!PensPools.hasOwnProperty(type)) {\r\n            PensPools[type] = new _pool_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\r\n        }\r\n        this.canvasText = new _canvastext_CanvasText_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n            parent: this,\r\n            context: this.context,\r\n            parser: parser,\r\n            style: this.style,\r\n            pensPool: PensPools[type]\r\n        });\r\n\r\n        //this.initRTL();\r\n\r\n        if (style && style.padding) {\r\n            this.setPadding(style.padding);\r\n        }\r\n\r\n        this.setText(text);\r\n\r\n        scene.sys.game.events.on('contextrestored', function () {\r\n            this.dirty = true;\r\n        }, this);\r\n    }\r\n\r\n    set text(value) {\r\n        this.setText(value);\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    initRTL() {\r\n        if (!this.style.rtl) {\r\n            return;\r\n        }\r\n\r\n        //  Here is where the crazy starts.\r\n        //\r\n        //  Due to browser implementation issues, you cannot fillText BiDi text to a canvas\r\n        //  that is not part of the DOM. It just completely ignores the direction property.\r\n\r\n        this.canvas.dir = 'rtl';\r\n\r\n        //  Experimental atm, but one day ...\r\n        this.context.direction = 'rtl';\r\n\r\n        //  Add it to the DOM, but hidden within the parent canvas.\r\n        this.canvas.style.display = 'none';\r\n\r\n        AddToDOM(this.canvas, this.scene.sys.canvas);\r\n\r\n        //  And finally we set the x origin\r\n        this.originX = 1;\r\n    }\r\n\r\n    setText(value) {\r\n        if (!value && value !== 0) {\r\n            value = '';\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n            value = value.join('\\n');\r\n        }\r\n\r\n        if (value !== this._text) {\r\n            this._text = value.toString();\r\n\r\n            this.updateText();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setStyle(style) {\r\n        return this.style.setStyle(style);\r\n    }\r\n\r\n    setFont(font) {\r\n        return this.style.setFont(font);\r\n    }\r\n\r\n    setFontFamily(family) {\r\n        return this.style.setFontFamily(family);\r\n    }\r\n\r\n    setFontSize(size) {\r\n        return this.style.setFontSize(size);\r\n    }\r\n\r\n    setFontStyle(style) {\r\n        return this.style.setFontStyle(style);\r\n    }\r\n\r\n    setFixedSize(width, height) {\r\n        return this.style.setFixedSize(width, height);\r\n    }\r\n\r\n    setBackgroundColor(color) {\r\n        return this.style.setBackgroundColor(color);\r\n    }\r\n\r\n    setFill(color) {\r\n        return this.style.setFill(color);\r\n    }\r\n\r\n    setColor(color) {\r\n        return this.style.setColor(color);\r\n    }\r\n\r\n    setStroke(color, thickness) {\r\n        return this.style.setStroke(color, thickness);\r\n    }\r\n\r\n    setShadow(x, y, color, blur, shadowStroke, shadowFill) {\r\n        return this.style.setShadow(x, y, color, blur, shadowStroke, shadowFill);\r\n    }\r\n\r\n    setShadowOffset(x, y) {\r\n        return this.style.setShadowOffset(x, y);\r\n    }\r\n\r\n    setShadowColor(color) {\r\n        return this.style.setShadowColor(color);\r\n    }\r\n\r\n    setShadowBlur(blur) {\r\n        return this.style.setShadowBlur(blur);\r\n    }\r\n\r\n    setShadowStroke(enabled) {\r\n        return this.style.setShadowStroke(enabled);\r\n    }\r\n\r\n    setShadowFill(enabled) {\r\n        return this.style.setShadowFill(enabled);\r\n    }\r\n\r\n    setWrapMode(mode) {\r\n        return this.style.setWrapMode(mode);\r\n    }\r\n\r\n    setWrapWidth(width) {\r\n        return this.style.setWrapWidth(width);\r\n    }\r\n\r\n    setAlign(align) {\r\n        return this.style.setHAlign(align);\r\n    }\r\n\r\n    setLineSpacing(value) {\r\n        return this.style.setLineSpacing(value);\r\n    }\r\n\r\n    setPadding(left, top, right, bottom) {\r\n        if (typeof left === 'object') {\r\n            var config = left;\r\n\r\n            //  If they specify x and/or y this applies to all\r\n            var x = GetValue(config, 'x', null);\r\n\r\n            if (x !== null) {\r\n                left = x;\r\n                right = x;\r\n            } else {\r\n                left = GetValue(config, 'left', 0);\r\n                right = GetValue(config, 'right', left);\r\n            }\r\n\r\n            var y = GetValue(config, 'y', null);\r\n\r\n            if (y !== null) {\r\n                top = y;\r\n                bottom = y;\r\n            } else {\r\n                top = GetValue(config, 'top', 0);\r\n                bottom = GetValue(config, 'bottom', top);\r\n            }\r\n        } else {\r\n            if (left === undefined) {\r\n                left = 0;\r\n            }\r\n            if (top === undefined) {\r\n                top = left;\r\n            }\r\n            if (right === undefined) {\r\n                right = left;\r\n            }\r\n            if (bottom === undefined) {\r\n                bottom = top;\r\n            }\r\n        }\r\n\r\n        this.padding.left = left;\r\n        this.padding.top = top;\r\n        this.padding.right = right;\r\n        this.padding.bottom = bottom;\r\n\r\n        return this.updateText(false);\r\n    }\r\n\r\n    setResolution(value) {\r\n        return this.style.setResolution(value);\r\n    }\r\n\r\n    setMaxLines(max) {\r\n        return this.style.setMaxLines(max);\r\n    }\r\n\r\n    updateText(runWrap) {\r\n        if (runWrap === undefined) {\r\n            runWrap = true;\r\n        }\r\n        var canvasText = this.canvasText;\r\n\r\n        // wrap text to pens\r\n        var style = this.style;\r\n        if (runWrap) {\r\n            canvasText.updatePenManager(\r\n                this._text,\r\n                style.wrapMode,\r\n                style.wrapWidth,\r\n                style.lineHeight\r\n            );\r\n        }\r\n\r\n        // resize\r\n        var padding = this.padding;\r\n        var textWidth, textHeight;\r\n        if (style.fixedWidth === 0) {\r\n            this.width = canvasText.linesWidth + padding.left + padding.right;\r\n            textWidth = canvasText.linesWidth;\r\n        }\r\n        else {\r\n            this.width = style.fixedWidth;\r\n            textWidth = this.width - padding.left - padding.right;\r\n            if (textWidth < canvasText.linesWidth) {\r\n                textWidth = canvasText.linesWidth;\r\n            }\r\n        }\r\n        if (style.fixedHeight === 0) {\r\n            this.height = canvasText.linesHeight + padding.top + padding.bottom;\r\n            textHeight = canvasText.linesHeight;\r\n        }\r\n        else {\r\n            this.height = style.fixedHeight;\r\n            textHeight = this.height - padding.top - padding.bottom;\r\n            if (textHeight < canvasText.linesHeight) {\r\n                textHeight = canvasText.linesHeight;\r\n            }\r\n        }\r\n\r\n        var w = this.width;\r\n        var h = this.height;\r\n\r\n        this.updateDisplayOrigin();\r\n\r\n        var resolution = style.resolution;\r\n        w *= resolution;\r\n        h *= resolution;\r\n\r\n        w = Math.max(Math.ceil(w), 1);\r\n        h = Math.max(Math.ceil(h), 1);\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n        if (canvas.width !== w || canvas.height !== h) {\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n            this.frame.setSize(w, h);\r\n        } else {\r\n            context.clearRect(0, 0, w, h);\r\n        }\r\n\r\n        context.save();\r\n        context.scale(resolution, resolution);\r\n\r\n        // draw\r\n        canvasText.draw(\r\n            padding.left,\r\n            padding.top,\r\n            textWidth,\r\n            textHeight\r\n        );\r\n\r\n        context.restore();\r\n\r\n        if (this.renderer.gl) {\r\n            this.frame.source.glTexture = this.renderer.canvasToTexture(canvas, this.frame.source.glTexture, true);\r\n            this.frame.glTexture = this.frame.source.glTexture;\r\n        }\r\n\r\n        this.dirty = true;\r\n\r\n        var input = this.input;\r\n\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = this.width;\r\n            input.hitArea.height = this.height;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    getTextMetrics() {\r\n        return this.style.getTextMetrics();\r\n    }\r\n\r\n    toJSON() {\r\n        var out = Components.ToJSON(this);\r\n\r\n        //  Extra Text data is added here\r\n\r\n        var data = {\r\n            autoRound: this.autoRound,\r\n            text: this._text,\r\n            style: this.style.toJSON(),\r\n            resolution: this.resolution,\r\n            padding: {\r\n                left: this.padding.left,\r\n                right: this.padding.right,\r\n                top: this.padding.top,\r\n                bottom: this.padding.bottom\r\n            }\r\n        };\r\n\r\n        out.data = data;\r\n\r\n        return out;\r\n    }\r\n\r\n    preDestroy() {\r\n        if (this.style.rtl) {\r\n            RemoveFromDOM(this.canvas);\r\n        }\r\n\r\n        CanvasPool.remove(this.canvas);\r\n        this.canvasText.destroy();\r\n    }\r\n\r\n    setInteractive(shape, callback, dropZone) {\r\n        GameObject.prototype.setInteractive.call(this, shape, callback, dropZone);\r\n        this.canvasText.setInteractive();\r\n        return this;\r\n    }\r\n\r\n    getWrappedText(text, start, end) {\r\n        text = this.canvasText.getText(text, start, end, true);\r\n        return text.split(SPLITREGEXP);\r\n    }\r\n\r\n    getPlainText(text, start, end) {\r\n        return this.canvasText.getPlainText(text, start, end);\r\n    }\r\n\r\n    getText(text, start, end) {\r\n        return this.canvasText.getText(text, start, end, false);\r\n    }\r\n\r\n    getSubString(text, start, end) {\r\n        return this.getText(text, start, end);\r\n    }\r\n\r\n    copyPenManager(penManager) {\r\n        return this.canvasText.copyPenManager(penManager);\r\n    }\r\n\r\n    getPenManager(text, penManager) {\r\n        return this.canvasText.getPenManager(text, penManager);\r\n    }\r\n\r\n    setSize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    resize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    set lineSpacing(value) {\r\n        this.setLineSpacing(value);\r\n    }\r\n    get lineSpacing() {\r\n        return this.style.lineSpacing;\r\n    }\r\n\r\n    get imageManager() {\r\n        return Object(_imagemanager_GetGlobImageManager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this.scene.textures);\r\n    }\r\n\r\n    addImage(key, config) {\r\n        this.imageManager.add(key, config);\r\n        return this;\r\n    }\r\n\r\n    drawAreaBounds(graphics, color) {\r\n        this.canvasText.hitAreaManager.drawBounds(graphics, color, this);\r\n        return this;\r\n    }\r\n}\r\n\r\nconst Components = Phaser.GameObjects.Components;\r\nPhaser.Class.mixin(Text,\r\n    [\r\n        Components.Alpha,\r\n        Components.BlendMode,\r\n        Components.ComputedSize,\r\n        Components.Crop,\r\n        Components.Depth,\r\n        Components.Flip,\r\n        Components.GetBounds,\r\n        Components.Mask,\r\n        Components.Origin,\r\n        Components.Pipeline,\r\n        Components.ScrollFactor,\r\n        Components.Tint,\r\n        Components.Transform,\r\n        Components.Visible,\r\n        _render_Render_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n    ]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Text);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/Text.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/canvastext/CanvasText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _DrawMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DrawMethods.js */ "./lib/rexui/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js");\n/* harmony import */ var _penmanger_PenManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../penmanger/PenManager.js */ "./lib/rexui/plugins/gameobjects/text/textbase/penmanger/PenManager.js");\n/* harmony import */ var _hitareamanager_HitAreaManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../hitareamanager/HitAreaManager.js */ "./lib/rexui/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js");\n/* harmony import */ var _SetInteractive_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SetInteractive.js */ "./lib/rexui/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/plugins/gameobjects/text/textbase/const.js");\n/* harmony import */ var _WrapText_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./WrapText.js */ "./lib/rexui/plugins/gameobjects/text/textbase/canvastext/WrapText.js");\n/* harmony import */ var _utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../utils/object/Clone.js */ "./lib/rexui/plugins/utils/object/Clone.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst NO_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_4__["default"].NO_WRAP;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_4__["default"].NO_NEWLINE;\r\n\r\nclass CanvasText {\r\n    constructor(config) {\r\n        this.parent = config.parent;\r\n        this.context = GetValue(config, \'context\', null);\r\n        this.canvas = this.context.canvas;\r\n        this.parser = GetValue(config, \'parser\', null);\r\n        this.defatultStyle = GetValue(config, \'style\', null);\r\n        this.autoRound = true;\r\n\r\n        this.pensPool = GetValue(config, \'pensPool\', null);\r\n        this.penManager = this.newPenManager();\r\n        this._tmpPenManager = null;\r\n\r\n        this.hitAreaManager = new _hitareamanager_HitAreaManager_js__WEBPACK_IMPORTED_MODULE_2__["default"]();\r\n\r\n        var context = this.context;\r\n        this.getTextWidth = function (text) {\r\n            return context.measureText(text).width;\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.context = undefined;\r\n        this.canvas = undefined;\r\n        this.parser = undefined;\r\n        this.defatultStyle = undefined;\r\n\r\n        if (this.penManager) {\r\n            this.penManager.destroy();\r\n            this.penManager = undefined;\r\n        }\r\n        if (this._tmpPenManager) {\r\n            this._tmpPenManager.destroy();\r\n            this._tmpPenManager = undefined;\r\n        }\r\n        if (this.hitAreaManager) {\r\n            this.hitAreaManager.destroy();\r\n            this.hitAreaManager = undefined;\r\n        }\r\n    }\r\n\r\n    updatePenManager(text, wrapMode, wrapWidth, lineHeight, penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n        penManager.freePens();\r\n        if (text === "") {\r\n            return penManager;\r\n        }\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n\r\n        var cursorX = 0,\r\n            cursorY = 0;\r\n\r\n        var plainText, curProp, curStyle;\r\n        var match = this.parser.splitText(text),\r\n            result, wrapLines;\r\n        for (var i = 0, len = match.length; i < len; i++) {\r\n            result = this.parser.tagTextToProp(match[i], curProp);\r\n            plainText = result.plainText;\r\n            curProp = result.prop;\r\n\r\n            if (curProp.img) { // Image tag                \r\n                var imgWidth = this.imageManager.getOuterWidth(curProp.img);\r\n                if ((wrapWidth > 0) && (wrapMode !== NO_WRAP)) {  // Wrap mode\r\n                    if (wrapWidth < (cursorX + imgWidth)) {\r\n                        penManager.addNewLinePen();\r\n                        cursorY += lineHeight;\r\n                        cursorX = 0;\r\n                    }\r\n                }\r\n                penManager.addImagePen(cursorX, cursorY, imgWidth, Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__["default"])(curProp));\r\n                cursorX += imgWidth;\r\n\r\n            } else if (plainText !== \'\') {\r\n                // wrap text to lines\r\n                // Save the current context.\r\n                this.context.save();\r\n                curStyle = this.parser.propToContextStyle(\r\n                    this.defatultStyle,\r\n                    curProp\r\n                );\r\n                curStyle.buildFont();\r\n                curStyle.syncFont(canvas, context);\r\n                curStyle.syncStyle(canvas, context);\r\n                wrapLines = Object(_WrapText_js__WEBPACK_IMPORTED_MODULE_5__["default"])(plainText, this.getTextWidth, wrapMode, wrapWidth, cursorX);\r\n\r\n                // add pens\r\n                var n;\r\n                for (var j = 0, jLen = wrapLines.length; j < jLen; j++) {\r\n                    n = wrapLines[j];\r\n                    penManager.addTextPen(n.text, cursorX, cursorY, n.width, Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__["default"])(curProp), n.newLineMode);\r\n\r\n                    if (n.newLineMode !== NO_NEWLINE) {\r\n                        cursorX = 0;\r\n                        cursorY += lineHeight;\r\n                    } else {\r\n                        cursorX += n.width;\r\n                    }\r\n\r\n                }\r\n                this.context.restore();\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return penManager;\r\n    }\r\n\r\n    get startXOffset() {\r\n        var defatultStyle = this.defatultStyle;\r\n        return (defatultStyle.strokeThickness / 2);\r\n    }\r\n\r\n    get startYOffset() {\r\n        var defatultStyle = this.defatultStyle;\r\n        return (defatultStyle.strokeThickness / 2) + defatultStyle.metrics.ascent;\r\n    }\r\n\r\n    get lines() {\r\n        return this.penManager.lines;\r\n    }\r\n\r\n    get desplayLinesCount() {\r\n        var linesCount = this.penManager.linesCount,\r\n            maxLines = this.defatultStyle.maxLines;\r\n        if ((maxLines > 0) && (linesCount > maxLines)) {\r\n            linesCount = maxLines;\r\n        }\r\n        return linesCount;\r\n    }\r\n\r\n    get linesWidth() {\r\n        return this.penManager.getMaxLineWidth();\r\n    }\r\n\r\n    get linesHeight() {\r\n        var linesCount = this.desplayLinesCount;\r\n        var linesHeight = (this.defatultStyle.lineHeight * linesCount);\r\n        if (linesCount > 0) {\r\n            linesHeight -= this.defatultStyle.lineSpacing;\r\n        }\r\n        return linesHeight;\r\n    }\r\n\r\n    get imageManager() {\r\n        return this.parent.imageManager;\r\n    }\r\n\r\n    newPenManager() {\r\n        return new _penmanger_PenManager_js__WEBPACK_IMPORTED_MODULE_1__["default"]({\r\n            pensPool: this.pensPool,\r\n            tagToText: this.parser.propToTagText,\r\n            tagToTextScope: this.parser\r\n        });\r\n    }\r\n\r\n    get tmpPenManager() {\r\n        if (this._tmpPenManager === null) {\r\n            this._tmpPenManager = this.newPenManager();\r\n        }\r\n        return this._tmpPenManager;\r\n    }\r\n\r\n    getPlainText(text, start, end) {\r\n        var plainText;\r\n        if (text == null) {\r\n            plainText = this.penManager.plainText;\r\n        } else {\r\n            var m, match = this.parser.splitText(text, 1); // PLAINTEXTONLY_MODE\r\n            plainText = "";\r\n            for (var i = 0, len = match.length; i < len; i++) {\r\n                plainText += match[i];\r\n            }\r\n        }\r\n\r\n        if ((start != null) || (end != null)) {\r\n            if (start == null) {\r\n                start = 0;\r\n            }\r\n            if (end == null) {\r\n                end = plainText.length;\r\n            }\r\n            plainText = plainText.substring(start, end);\r\n        }\r\n\r\n        return plainText;\r\n    }\r\n\r\n    getPenManager(text, retPenManager) {\r\n        if (text === undefined) {\r\n            return this.copyPenManager(retPenManager, this.penManager);\r\n        }\r\n\r\n        if (retPenManager === undefined) {\r\n            retPenManager = this.newPenManager();\r\n        }\r\n\r\n        var defatultStyle = this.defatultStyle;\r\n        this.updatePenManager(\r\n            text,\r\n            defatultStyle.wrapMode,\r\n            defatultStyle.wrapWidth,\r\n            defatultStyle.lineHeight,\r\n            retPenManager\r\n        );\r\n        return retPenManager;\r\n    }\r\n\r\n    getText(text, start, end, wrap) {\r\n        if (text == null) {\r\n            return this.penManager.getSliceTagText(start, end, wrap);\r\n        }\r\n\r\n        var penManager = this.tmpPenManager;\r\n        var defatultStyle = this.defatultStyle;\r\n        this.updatePenManager(\r\n            text,\r\n            defatultStyle.wrapMode,\r\n            defatultStyle.wrapWidth,\r\n            defatultStyle.lineHeight,\r\n            penManager\r\n        );\r\n\r\n        return penManager.getSliceTagText(start, end, wrap);\r\n    }\r\n\r\n    copyPenManager(ret, src) {\r\n        if (src === undefined) {\r\n            src = this.penManager;\r\n        }\r\n        return src.copy(ret);\r\n    }\r\n\r\n    getTextWidth(penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n\r\n        return penManager.getMaxLineWidth();\r\n    }\r\n\r\n    getLastPen(penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n\r\n        return penManager.lastPen;\r\n    }\r\n};\r\n\r\nvar methods = {\r\n    setInteractive: _SetInteractive_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n}\r\n\r\nObject.assign(\r\n    CanvasText.prototype,\r\n    _DrawMethods_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CanvasText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/canvastext/CanvasText.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/plugins/gameobjects/text/textbase/const.js");\n\r\n\r\nconst HALIGN_LEFT = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].hleft;\r\nconst HALIGN_CENTER = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].hcenter;\r\nconst HALIGN_RIGHT = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].hright;\r\nconst VALIGN_TOP = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].vtop;\r\nconst VALIGN_CENTER = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].vcenter;\r\nconst VALIGN_BOTTOM = _const_js__WEBPACK_IMPORTED_MODULE_0__["default"].vbottom;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    draw(startX, startY, boxWidth, boxHeight) {\r\n        var penManager = this.penManager;\r\n        this.hitAreaManager.clear();\r\n\r\n        var context = this.context;\r\n        context.save();\r\n\r\n        // this.clear();\r\n        this.drawBackground(this.defatultStyle.backgroundColor);\r\n\r\n        // draw lines\r\n        var defatultStyle = this.defatultStyle;\r\n        startX += this.startXOffset;\r\n        startY += this.startYOffset;\r\n        var halign = defatultStyle.halign,\r\n            valign = defatultStyle.valign;\r\n\r\n        var lineWidth, lineHeight = defatultStyle.lineHeight;\r\n        var lines = penManager.lines;\r\n        var totalLinesNum = lines.length,\r\n            maxLines = defatultStyle.maxLines;\r\n        var drawLinesNum, drawLineStartIdx, drawLineEndIdx;\r\n        if ((maxLines > 0) && (totalLinesNum > maxLines)) {\r\n            drawLinesNum = maxLines;\r\n            if (valign === VALIGN_CENTER) { // center\r\n                drawLineStartIdx = Math.floor((totalLinesNum - drawLinesNum) / 2);\r\n            } else if (valign === VALIGN_BOTTOM) { // bottom\r\n                drawLineStartIdx = totalLinesNum - drawLinesNum;\r\n            } else {\r\n                drawLineStartIdx = 0;\r\n            }\r\n        } else {\r\n            drawLinesNum = totalLinesNum;\r\n            drawLineStartIdx = 0;\r\n        }\r\n        drawLineEndIdx = drawLineStartIdx + drawLinesNum;\r\n\r\n        var offsetX, offsetY;\r\n        if (valign === VALIGN_CENTER) { // center\r\n            offsetY = Math.max((boxHeight - (drawLinesNum * lineHeight)) / 2, 0);\r\n        } else if (valign === VALIGN_BOTTOM) { // bottom\r\n            offsetY = Math.max(boxHeight - (drawLinesNum * lineHeight) - 2, 0);\r\n        } else {\r\n            offsetY = 0;\r\n        }\r\n        offsetY += startY;\r\n        for (var lineIdx = drawLineStartIdx; lineIdx < drawLineEndIdx; lineIdx++) {\r\n            lineWidth = penManager.getLineWidth(lineIdx);\r\n            if (lineWidth === 0) {\r\n                continue;\r\n            }\r\n\r\n            if (halign === HALIGN_CENTER) { // center\r\n                offsetX = (boxWidth - lineWidth) / 2;\r\n            } else if (halign === HALIGN_RIGHT) { // right\r\n                offsetX = boxWidth - lineWidth;\r\n            } else {\r\n                offsetX = 0;\r\n            }\r\n            offsetX += startX;\r\n\r\n            var pens = lines[lineIdx];\r\n            for (var penIdx = 0, pensLen = pens.length; penIdx < pensLen; penIdx++) {\r\n                this.drawPen(pens[penIdx], offsetX, offsetY);\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    },\r\n\r\n    drawPen(pen, offsetX, offsetY) {\r\n        offsetX += pen.x;\r\n        offsetY += pen.y;\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n        context.save();\r\n\r\n        var curStyle = this.parser.propToContextStyle(\r\n            this.defatultStyle,\r\n            pen.prop\r\n        );\r\n        curStyle.buildFont();\r\n        curStyle.syncFont(canvas, context);\r\n        curStyle.syncStyle(canvas, context);\r\n\r\n        // Underline\r\n        if ((curStyle.underlineThickness > 0) && (pen.width > 0)) {\r\n            this.drawUnderline(offsetX, offsetY, pen.width, curStyle);\r\n        }\r\n\r\n        // Text\r\n        if (pen.isTextPen) {\r\n            this.drawText(offsetX, offsetY, pen.text, curStyle);\r\n        }\r\n\r\n        // Image\r\n        if (pen.isImagePen) {\r\n            this.drawImage(offsetX, offsetY, pen.prop.img, curStyle);\r\n        }\r\n\r\n        context.restore();\r\n\r\n        if (pen.hasAreaMarker && (pen.width > 0)) {\r\n            this.hitAreaManager.add(\r\n                pen.prop.area,\r\n                offsetX, (offsetY - this.startYOffset),\r\n                pen.width, this.defatultStyle.lineHeight);\r\n        }\r\n    },\r\n\r\n    clear() {\r\n        var canvas = this.canvas;\r\n        this.context.clearRect(0, 0, canvas.width, canvas.height);\r\n    },\r\n\r\n    drawBackground(color) {\r\n        if (color === null) {\r\n            return;\r\n        }\r\n        this.context.fillStyle = color;\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n    },\r\n\r\n    drawUnderline(x, y, width, style) {\r\n        y += style.underlineOffset - (style.underlineThickness / 2);\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        var savedLineCap = context.lineCap;\r\n        context.lineCap = \'butt\';\r\n        context.beginPath();\r\n        context.strokeStyle = style.underlineColor;\r\n        context.lineWidth = style.underlineThickness;\r\n        context.moveTo(x, y);\r\n        context.lineTo((x + width), y);\r\n        context.stroke();\r\n        context.lineCap = savedLineCap;\r\n    },\r\n\r\n    drawText(x, y, text, style) {\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        if (style.strokeThickness) {\r\n            style.syncShadow(context, style.shadowStroke);\r\n            context.strokeText(text, x, y);\r\n        }\r\n\r\n        if (style.color && (style.color !== \'none\')) {\r\n            style.syncShadow(context, style.shadowFill);\r\n            context.fillText(text, x, y);\r\n        }\r\n    },\r\n\r\n    drawImage(x, y, imgKey, style) {\r\n        var imageManager = this.parent.imageManager;\r\n        var imgData = imageManager.get(imgKey);\r\n        var frame = imageManager.getFrame(imgKey);\r\n\r\n        x += imgData.left;\r\n        y += - this.startYOffset + imgData.y;\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        context.drawImage(\r\n            frame.source.image,\r\n            frame.cutX, frame.cutY, frame.cutWidth, frame.cutHeight,\r\n            x, y, imgData.width, imgData.height\r\n        );\r\n    }\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetInteractive = function () {\r\n    this.parent\r\n        .on('pointerdown', function (pointer, localX, localY, event) {\r\n            FireEvent.call(this, 'areadown', pointer, localX, localY);\r\n        }, this)\r\n        .on('pointerup', function (pointer, localX, localY, event) {\r\n            FireEvent.call(this, 'areaup', pointer, localX, localY);\r\n        }, this)\r\n}\r\n\r\nvar FireEvent = function (eventName, pointer, localX, localY) {\r\n    var key = this.hitAreaManager.contains(localX, localY);\r\n    if (key === false) {\r\n        return;\r\n    }\r\n    this.parent.emit(`${eventName}-${key}`, pointer, localX, localY)\r\n    this.parent.emit(eventName, key, pointer, localX, localY)\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/canvastext/WrapText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/plugins/pool.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/plugins/gameobjects/text/textbase/const.js");\n\r\n\r\n\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].NO_NEWLINE;\r\nconst RAW_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].RAW_NEWLINE;\r\nconst WRAPPED_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].WRAPPED_NEWLINE;\r\nconst NO_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].NO_WRAP;\r\nconst WORD_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].WORD_WRAP;\r\nconst CHAR_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].CHAR_WRAP;\r\nconst splitRegExp = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].SPLITREGEXP;\r\n\r\nvar WRAP_RESULT = [];\r\nvar WrapText = function (text, getTextWidth, wrapMode, wrapWidth, offset) {\r\n    if (wrapWidth <= 0) {\r\n        wrapMode = NO_WRAP;\r\n    }\r\n\r\n    var retLines = WRAP_RESULT;\r\n    LinesPool.pushMultiple(retLines);\r\n\r\n    if (!text || !text.length) {\r\n        return retLines;\r\n    }\r\n\r\n    var lines = text.split(splitRegExp),\r\n        line, remainWidth, isLaseLine, newLineMode;\r\n    for (var i = 0, linesLen = lines.length; i < linesLen; i++) {\r\n        line = lines[i];\r\n        newLineMode = (i === (linesLen - 1)) ? NO_NEWLINE : RAW_NEWLINE;\r\n\r\n        if (wrapMode === NO_WRAP) {\r\n            var textWidth = getTextWidth(line);\r\n            retLines.push(LinesPool.newline(line, textWidth, newLineMode));\r\n            continue;\r\n        } else {\r\n            if (i === 0) {\r\n                remainWidth = wrapWidth - offset;\r\n            } else {\r\n                remainWidth = wrapWidth;\r\n            }\r\n        }\r\n\r\n        // short string testing\r\n        if (line.length <= 100) {\r\n            var textWidth = getTextWidth(line);\r\n            if (textWidth <= remainWidth) {\r\n                retLines.push(LinesPool.newline(line, textWidth, newLineMode));\r\n                continue;\r\n            }\r\n        }\r\n\r\n        // character mode\r\n        var tokenArray;\r\n        if (wrapMode === WORD_WRAP) {\r\n            // word mode\r\n            tokenArray = line.split(\' \');\r\n        } else {\r\n            tokenArray = line;\r\n        }\r\n        var token;\r\n        var curLineText = \'\',\r\n            lineText = \'\',\r\n            currLineWidth, lineWidth = 0;\r\n        for (var j = 0, tokenLen = tokenArray.length; j < tokenLen; j++) {\r\n            token = tokenArray[j];\r\n\r\n            if (wrapMode === WORD_WRAP) {\r\n                curLineText += token;\r\n\r\n                if (j < (tokenLen - 1)) {\r\n                    curLineText += \' \';\r\n                }\r\n            } else {\r\n                curLineText += token;\r\n            }\r\n\r\n            currLineWidth = getTextWidth(curLineText);\r\n            if (currLineWidth > remainWidth) {\r\n                // new line\r\n                if (j === 0) {\r\n                    retLines.push(LinesPool.newline(\'\', 0, WRAPPED_NEWLINE));\r\n                } else {\r\n                    retLines.push(LinesPool.newline(lineText, lineWidth, WRAPPED_NEWLINE));\r\n                    curLineText = token;\r\n                    if (wrapMode === WORD_WRAP) {\r\n                        if (j < (tokenLen - 1)) {\r\n                            curLineText += \' \';\r\n                        }\r\n                    }\r\n                    currLineWidth = getTextWidth(curLineText);\r\n                }\r\n\r\n                remainWidth = wrapWidth;\r\n            }\r\n\r\n            lineText = curLineText;\r\n            lineWidth = currLineWidth;\r\n        } // for token in tokenArray\r\n\r\n        // flush remain text\r\n        retLines.push(LinesPool.newline(lineText, lineWidth, newLineMode));\r\n\r\n    } // for each line in lines\r\n\r\n    return retLines;\r\n};\r\n\r\nvar LinesPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\nLinesPool.newline = function (text, width, newLineMode) {\r\n    var l = this.pop();\r\n    if (l === null) {\r\n        l = {};\r\n    }\r\n    l.text = text;\r\n    l.width = width;\r\n    l.newLineMode = newLineMode;\r\n    return l;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (WrapText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/canvastext/WrapText.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CONST = {\r\n    // halign\r\n    hleft: 0,\r\n    hcenter: 1,\r\n    hright: 2,\r\n\r\n    // valign\r\n    vtop: 0,\r\n    vcenter: 1,\r\n    vbottom: 2,\r\n\r\n    // new line mode\r\n    NO_NEWLINE: 0,\r\n    RAW_NEWLINE: 1,\r\n    WRAPPED_NEWLINE: 2,\r\n\r\n    // wrap mode\r\n    NO_WRAP: 0,\r\n    WORD_WRAP: 1,\r\n    CHAR_WRAP: 2,\r\n\r\n    // split lines\r\n    SPLITREGEXP: /(?:\\r\\n|\\r|\\n)/\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CONST);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/const.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/plugins/pool.js");\n\r\n\r\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nvar RectanglePool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\nclass HitAreaManager {\r\n    constructor() {\r\n        this.hitAreas = [];\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n    }\r\n\r\n    clear() {\r\n        RectanglePool.pushMultiple(this.hitAreas);\r\n        return this;\r\n    }\r\n\r\n    add(key, x, y, width, height) {\r\n        var rectangle = RectanglePool.pop();\r\n        if (rectangle === null) {\r\n            rectangle = new Rectangle(x, y, width, height);\r\n        } else {\r\n            rectangle.setTo(x, y, width, height);\r\n        }\r\n        rectangle.key = key;\r\n        this.hitAreas.push(rectangle);\r\n        return this;\r\n    }\r\n\r\n    contains(x, y) {\r\n        var hitAreas = this.hitAreas, hitArea;\r\n        for (var i = 0, cnt = hitAreas.length; i < cnt; i++) {\r\n            hitArea = hitAreas[i];\r\n            if (hitArea.contains(x, y)) {\r\n                return hitArea.key;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    drawBounds(graphics, color, parent) {\r\n        if (color === undefined) {\r\n            color = 0xffffff;\r\n        }\r\n\r\n        if (parent) {\r\n            graphics\r\n                .save()\r\n                .scaleCanvas(parent.scaleX, parent.scaleY)\r\n                .rotateCanvas(parent.rotation)\r\n                .translateCanvas(parent.x, parent.y)\r\n        }\r\n\r\n        var hitAreas = this.hitAreas, hitArea;\r\n        for (var i = 0, cnt = hitAreas.length; i < cnt; i++) {\r\n            hitArea = hitAreas[i];\r\n            graphics.lineStyle(1, color).strokeRect(hitArea.x, hitArea.y, hitArea.width, hitArea.height);\r\n        }\r\n\r\n        if (parent) {\r\n            graphics\r\n                .restore()\r\n        }\r\n        return this;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (HitAreaManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ImageManager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ImageManager.js */ "./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js");\n\r\n\r\nvar globImageManager;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function(textureManager) {\r\n    if (globImageManager === undefined) {\r\n        globImageManager = new _ImageManager_js__WEBPACK_IMPORTED_MODULE_0__["default"](textureManager);\r\n    }\r\n    return globImageManager;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ImageManager {\r\n    constructor(textureManager) {\r\n        this.textureManager = textureManager;\r\n        this.images = {};\r\n    }\r\n\r\n    add(key, config) {\r\n        if (typeof (key) === 'string') {\r\n            this._add(key, config);\r\n        } else if (Array.isArray(key)) {\r\n            var data = key;\r\n            for (var i = 0, cnt = data.length; i < cnt; i++) {\r\n                this._add(data[i]);\r\n            }\r\n        } else {\r\n            var data = key;\r\n            for (var key in data) {\r\n                this._add(key, data[key]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    _add(key, config) {\r\n        if (config === undefined) {\r\n            config = {\r\n                key: key\r\n            }\r\n        }\r\n\r\n        var textureKey = config.key, frameKey = config.frame;\r\n        var width = config.width, height = config.height;\r\n\r\n        if ((width === undefined) || (height === undefined)) {\r\n            var frame = this.textureManager.getFrame(textureKey, frameKey);\r\n            var frameWidth = (frame) ? frame.cutWidth : 0;\r\n            var frameHeight = (frame) ? frame.cutHeight : 0;\r\n            if ((width === undefined) && (height === undefined)) {\r\n                width = frameWidth;\r\n                height = frameHeight;\r\n            } else if (width === undefined) {\r\n                width = frameWidth * (height / frameHeight);\r\n            } else if (height === undefined) {\r\n                height = frameHeight * (width / frameWidth);\r\n            }\r\n        }\r\n\r\n        this.images[key] = {\r\n            key: textureKey,\r\n            frame: frameKey,\r\n            width: width,\r\n            height: height,\r\n            y: GetValue(config, 'y', 0),\r\n            left: GetValue(config, 'left', 0),\r\n            right: GetValue(config, 'right', 0)\r\n        }\r\n    }\r\n\r\n    remove(key) {\r\n        if (this.images.hasOwnProperty(key)) {\r\n            delete this.images[key];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get(key) {\r\n        if (!this.images.hasOwnProperty(key)) {\r\n            if (this.textureManager.exists(key)) {\r\n                this.add(key);\r\n            }\r\n        }\r\n        return this.images[key];\r\n    }\r\n\r\n    getOuterWidth(key) {\r\n        var data = this.get(key);\r\n        return (data) ? (data.width + data.left + data.right) : 0;\r\n    }\r\n\r\n    getFrame(key) {\r\n        var data = this.get(key);\r\n        return (data) ? this.textureManager.getFrame(data.key, data.frame) : undefined;\r\n    }\r\n\r\n    hasTexture(key) {\r\n        return !!this.getFrame(key);\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ImageManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/penmanger/Pen.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/const.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].NO_NEWLINE;\r\nconst RAW_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].RAW_NEWLINE;\r\n\r\nclass Pen {\r\n    constructor(config) {\r\n        this.prop = {};\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) { // (txt, x, y, width, prop, newLineMode, startIndex)\r\n        this.text = GetValue(o, 'text', '');\r\n        this.x = GetValue(o, 'x', 0);\r\n        this.y = GetValue(o, 'y', 0);\r\n        this.width = GetValue(o, 'width', 0);\r\n\r\n        var prop = GetValue(o, 'prop', null);\r\n        if (prop === null) {\r\n            prop = {};\r\n        }\r\n        this.prop = prop;\r\n        this.newLineMode = GetValue(o, 'newLineMode', 0);\r\n        this.startIndex = GetValue(o, 'startIndex', 0);\r\n    }\r\n\r\n    get plainText() {\r\n        var txt = this.text\r\n        if (this.newLineMode === RAW_NEWLINE) {\r\n            txt += \"\\n\";\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get wrapText() {\r\n        var txt = this.text;\r\n        if (this.newLineMode !== NO_NEWLINE) {\r\n            txt += \"\\n\";\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get rawTextLength() {\r\n        var len = this.text.length;\r\n        if (this.newLineMode === RAW_NEWLINE) {\r\n            len += 1;\r\n        }\r\n        return len;\r\n    }\r\n\r\n    get endIndex() {\r\n        return this.startIndex + this.rawTextLength;\r\n    }\r\n\r\n    get lastX() {\r\n        return this.x + this.width;\r\n    }\r\n\r\n    get isTextPen() {\r\n        return (this.text !== '');\r\n    }\r\n\r\n    get isImagePen() {\r\n        return !!this.prop.img;\r\n    }\r\n\r\n    get hasAreaMarker() {\r\n        return !!this.prop.area;\r\n    }\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pen);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/penmanger/Pen.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/penmanger/PenManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/plugins/pool.js");\n/* harmony import */ var _Pen_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Pen.js */ "./lib/rexui/plugins/gameobjects/text/textbase/penmanger/Pen.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/plugins/gameobjects/text/textbase/const.js");\n/* harmony import */ var _utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../utils/object/Clone.js */ "./lib/rexui/plugins/utils/object/Clone.js");\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../utils/object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetFastValue = Phaser.Utils.Objects.GetFastValue;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_2__["default"].NO_NEWLINE;\r\nconst WRAPPED_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_2__["default"].WRAPPED_NEWLINE;\r\n\r\nvar PensPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"](); // default pens pool\r\nvar LinesPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"](); // default lines pool\r\nclass PenManager {\r\n    constructor(config) {\r\n        this.pens = []; // all pens\r\n        this.lines = []; // pens in lines [ [],[],[],.. ]\r\n        this.maxLinesWidth = undefined;\r\n\r\n        this.PensPool = GetFastValue(config, \'pensPool\', PensPool);\r\n        this.LinesPool = GetFastValue(config, \'linesPool\', LinesPool);\r\n        this.tagToText = GetFastValue(config, \'tagToText\', _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__["default"]);\r\n        this.tagToTextScope = GetFastValue(config, \'tagToTextScope\', undefined);\r\n    }\r\n\r\n    destroy() {\r\n        this.freePens();\r\n        this.tagToText = undefined;\r\n        this.tagToTextScope = undefined;\r\n    }\r\n\r\n    freePens() {\r\n        for (var i = 0, len = this.lines.length; i < len; i++)\r\n            this.lines[i].length = 0;\r\n\r\n        this.PensPool.pushMultiple(this.pens);\r\n        this.LinesPool.pushMultiple(this.lines);\r\n        this.maxLinesWidth = undefined;\r\n    }\r\n\r\n    addTextPen(text, x, y, width, prop, newLineMode) {\r\n        var pen = this.PensPool.pop();\r\n        if (pen == null) {\r\n            pen = new _Pen_js__WEBPACK_IMPORTED_MODULE_1__["default"]();\r\n        }\r\n        PEN_CONFIG.text = text;\r\n        PEN_CONFIG.x = x;\r\n        PEN_CONFIG.y = y;\r\n        PEN_CONFIG.width = width;\r\n        PEN_CONFIG.prop = prop;\r\n        PEN_CONFIG.newLineMode = newLineMode;\r\n        pen.resetFromJSON(PEN_CONFIG);\r\n        this.addPen(pen);\r\n        return this;\r\n    }\r\n\r\n    addImagePen(x, y, width, prop) {\r\n        this.addTextPen(\'\', x, y, width, prop, NO_NEWLINE);\r\n        return this;\r\n    }\r\n\r\n    addNewLinePen() {\r\n        var previousPen = this.lastPen;\r\n        var x = (previousPen) ? previousPen.lastX : 0;\r\n        var y = (previousPen) ? previousPen.y : 0;\r\n        var prop = (previousPen) ? Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__["default"])(previousPen.prop) : null;\r\n        this.addTextPen(\'\', x, y, 0, prop, WRAPPED_NEWLINE);\r\n        return this;\r\n    }\r\n\r\n    addPen(pen) {\r\n        var previousPen = this.lastPen;\r\n        if (previousPen == null) {\r\n            pen.startIndex = 0;\r\n        } else {\r\n            pen.startIndex = previousPen.endIndex;\r\n        }\r\n        this.pens.push(pen);\r\n\r\n        // maintan lines\r\n        var line = this.lastLine;\r\n        if (line == null) {\r\n            line = this.LinesPool.pop() || [];\r\n            this.lines.push(line);\r\n        }\r\n        line.push(pen);\r\n\r\n        // new line, add an empty line\r\n        if (pen.newLineMode !== NO_NEWLINE) {\r\n            line = this.LinesPool.pop() || [];\r\n            this.lines.push(line);\r\n        }\r\n        this.maxLinesWidth = undefined;\r\n    }\r\n\r\n    clone(targetPenManager) {\r\n        if (targetPenManager == null)\r\n            targetPenManager = new PenManager();\r\n\r\n        targetPenManager.freePens();\r\n\r\n        for (var li = 0, llen = this.lines.length; li < llen; li++) {\r\n            var pens = this.lines[li];\r\n            for (var pi = 0, plen = pens.length; pi < plen; pi++) {\r\n                var pen = pens[pi];\r\n                targetPenManager.addPen(\r\n                    pen.text,\r\n                    pen.x,\r\n                    pen.y,\r\n                    pen.width,\r\n                    Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__["default"])(pen.prop),\r\n                    pen.newLineMode\r\n                );\r\n            }\r\n        }\r\n\r\n        return targetPenManager;\r\n    }\r\n\r\n    get lastPen() {\r\n        return this.pens[this.pens.length - 1];\r\n    }\r\n\r\n    get lastLine() {\r\n        return this.lines[this.lines.length - 1];\r\n    }\r\n\r\n    getLineStartIndex(i) {\r\n        if (i >= this.lines.length) {\r\n            return this.getLineEndIndex(i);\r\n        } else {\r\n            var line = this.lines[i];\r\n            return (line && line[0]) ? line[0].startIndex : 0;\r\n        }\r\n    }\r\n\r\n    getLineEndIndex(i) {\r\n        if (i >= this.lines.length) {\r\n            i = this.lines.length - 1;\r\n        }\r\n        var li, hasLastPen = false,\r\n            line;\r\n        for (li = i; li >= 0; li--) {\r\n            line = this.lines[li];\r\n            hasLastPen = (line != null) && (line.length > 0);\r\n            if (hasLastPen) {\r\n                break;\r\n            }\r\n        }\r\n        if (!hasLastPen) {\r\n            return 0;\r\n        }\r\n\r\n        var lastPen = line[line.length - 1];\r\n        return lastPen.endIndex;\r\n    }\r\n\r\n    getLineWidth(i) {\r\n        var line = this.lines[i];\r\n        if (!line) {\r\n            return 0;\r\n        }\r\n\r\n        var lastPen = line[line.length - 1];\r\n        if (lastPen == null) {\r\n            return 0;\r\n        }\r\n\r\n        var lineWidth = lastPen.lastX; // start from 0\r\n        return lineWidth;\r\n    }\r\n\r\n    getMaxLineWidth() {\r\n        if (this.maxLinesWidth !== undefined) {\r\n            return this.maxLinesWidth;\r\n        }\r\n        var w, maxW = 0;\r\n        for (var i = 0, len = this.lines.length; i < len; i++) {\r\n            w = this.getLineWidth(i);\r\n            if (w > maxW) {\r\n                maxW = w;\r\n            }\r\n        }\r\n        this.maxLinesWidth = maxW;\r\n        return maxW;\r\n    }\r\n\r\n    getLineWidths() {\r\n        var result = [];\r\n        for (var i = 0, len = this.lines.length; i < len; i++) {\r\n            result.push(this.getLineWidth(i));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    get linesCount() {\r\n        return this.lines.length;\r\n    }\r\n\r\n    get plainText() {\r\n        var txt = "",\r\n            pens = this.pens;\r\n        for (var i = 0, len = pens.length; i < len; i++) {\r\n            txt += pens[i].plainText;\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get rawTextLength() {\r\n        var l = 0,\r\n            pens = this.pens;\r\n        for (var i = 0, len = this.pens.length; i < len; i++) {\r\n            l += pens[i].rawTextLength;\r\n        }\r\n\r\n        return l;\r\n    }\r\n\r\n    getSliceTagText(start, end, wrap) {\r\n        if (start === undefined) {\r\n            start = 0;\r\n        }\r\n        if (end === undefined) {\r\n            var lastPen = this.lastPen;\r\n            if (lastPen == null) {\r\n                return "";\r\n            }\r\n\r\n            end = lastPen.endIndex;\r\n        }\r\n        if (wrap === undefined) {\r\n            wrap = false;\r\n        }\r\n\r\n        var txt = "",\r\n            formatTxt,\r\n            pen, penTxt, penStartIdx, penEndIdx, isInRange;\r\n        var currentProp, previousProp;\r\n        for (var i = 0, len = this.pens.length; i < len; i++) {\r\n            pen = this.pens[i];\r\n            penEndIdx = pen.endIndex;\r\n            if (penEndIdx <= start) {\r\n                continue;\r\n            }\r\n            pen = this.pens[i];\r\n            penTxt = (!wrap) ? pen.plainText : pen.wrapText;\r\n            currentProp = pen.prop;\r\n            penStartIdx = pen.startIndex;\r\n\r\n            isInRange = (penStartIdx >= start) && (penEndIdx <= end);\r\n            if (!isInRange) {\r\n                penTxt = penTxt.substring(start - penStartIdx, end - penStartIdx);\r\n            }\r\n\r\n            if (this.tagToTextScope) {\r\n                txt += this.tagToText.call(this.tagToTextScope, penTxt, currentProp, previousProp);\r\n            } else {\r\n                txt += this.tagToText(penTxt, currentProp, previousProp);\r\n            }\r\n\r\n            previousProp = currentProp;\r\n            if (penEndIdx >= end) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return txt;\r\n    }\r\n};\r\n\r\nvar PEN_CONFIG = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PenManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/penmanger/PenManager.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/render/CanvasRenderer.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * Renders this Game Object with the Canvas Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Text#renderCanvas\r\n * @since 3.0.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.Canvas.CanvasRenderer} renderer - A reference to the current active Canvas renderer.\r\n * @param {Phaser.GameObjects.Text} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar TextCanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    renderer.batchSprite(src, src.frame, camera, parentMatrix);\r\n};\r\n\r\nmodule.exports = TextCanvasRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/render/CanvasRenderer.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/plugins/gameobjects/text/textbase/render/WebGLRenderer.js");\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/plugins/gameobjects/text/textbase/render/CanvasRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/object/NOOP */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default.a;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/render/Render.js?')},"./lib/rexui/plugins/gameobjects/text/textbase/render/WebGLRenderer.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders this Game Object with the WebGL Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Text#renderWebGL\r\n * @since 3.0.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLRenderer} renderer - A reference to the current active WebGL renderer.\r\n * @param {Phaser.GameObjects.Text} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar TextWebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    var frame = src.frame;\r\n    var width = frame.width;\r\n    var height = frame.height;\r\n    var getTint = Utils.getTintAppendFloatAlpha;\r\n\r\n    this.pipeline.batchTexture(\r\n        src,\r\n        frame.glTexture,\r\n        width, height,\r\n        src.x, src.y,\r\n        width / src.style.resolution, height / src.style.resolution,\r\n        src.scaleX, src.scaleY,\r\n        src.rotation,\r\n        src.flipX, src.flipY,\r\n        src.scrollFactorX, src.scrollFactorY,\r\n        src.displayOriginX, src.displayOriginY,\r\n        0, 0, width, height,\r\n        getTint(src._tintTL, camera.alpha * src._alphaTL),\r\n        getTint(src._tintTR, camera.alpha * src._alphaTR),\r\n        getTint(src._tintBL, camera.alpha * src._alphaBL),\r\n        getTint(src._tintBR, camera.alpha * src._alphaBR),\r\n        (src._isTinted && src.tintFill),\r\n        0, 0,\r\n        camera,\r\n        parentMatrix\r\n    );\r\n};\r\n\r\nmodule.exports = TextWebGLRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/render/WebGLRenderer.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/MeasureText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\n\r\n/**\r\n * Calculates the ascent, descent and fontSize of a given font style.\r\n *\r\n * @function Phaser.GameObjects.Text.MeasureText\r\n * @since 3.0.0\r\n *\r\n * @param {Phaser.GameObjects.Text.TextStyle} textStyle - The TextStyle object to measure.\r\n *\r\n * @return {object} An object containing the ascent, descent and fontSize of the TextStyle.\r\n */\r\nvar MeasureText = function (textStyle) {\r\n    // @property {HTMLCanvasElement} canvas - The canvas element that the text is rendered.\r\n    var canvas = CanvasPool.create(this);\r\n\r\n    // @property {HTMLCanvasElement} context - The context of the canvas element that the text is rendered to.\r\n    var context = canvas.getContext('2d');\r\n\r\n    textStyle.syncFont(canvas, context);\r\n\r\n    var width = Math.ceil(context.measureText(textStyle.testString).width * textStyle.baselineX);\r\n    var baseline = width;\r\n    var height = 2 * baseline;\r\n\r\n    baseline = baseline * textStyle.baselineY | 0;\r\n\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    context.fillStyle = '#f00';\r\n    context.fillRect(0, 0, width, height);\r\n\r\n    context.font = textStyle._font;\r\n\r\n    context.textBaseline = 'alphabetic';\r\n    context.fillStyle = '#000';\r\n    context.fillText(textStyle.testString, 0, baseline);\r\n\r\n    var output = MEASURETEXT_RESULT;\r\n\r\n    if (!context.getImageData(0, 0, width, height)) {\r\n        output.ascent = baseline;\r\n        output.descent = baseline + 6;\r\n        output.fontSize = output.ascent + output.descent;\r\n\r\n        CanvasPool.remove(canvas);\r\n\r\n        return output;\r\n    }\r\n\r\n    var imagedata = context.getImageData(0, 0, width, height).data;\r\n    var pixels = imagedata.length;\r\n    var line = width * 4;\r\n    var i;\r\n    var j;\r\n    var idx = 0;\r\n    var stop = false;\r\n\r\n    // ascent. scan from top to bottom until we find a non red pixel\r\n    for (i = 0; i < baseline; i++) {\r\n        for (j = 0; j < line; j += 4) {\r\n            if (imagedata[idx + j] !== 255) {\r\n                stop = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!stop) {\r\n            idx += line;\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    output.ascent = baseline - i;\r\n\r\n    idx = pixels - line;\r\n    stop = false;\r\n\r\n    // descent. scan from bottom to top until we find a non red pixel\r\n    for (i = height; i > baseline; i--) {\r\n        for (j = 0; j < line; j += 4) {\r\n            if (imagedata[idx + j] !== 255) {\r\n                stop = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!stop) {\r\n            idx -= line;\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    output.descent = (i - baseline);\r\n    output.fontSize = output.ascent + output.descent;\r\n\r\n    CanvasPool.remove(canvas);\r\n\r\n    return output;\r\n};\r\n\r\nvar MEASURETEXT_RESULT = {};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MeasureText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/textstyle/MeasureText.js?")},"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/TextStyle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _MeasureText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MeasureText.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/textstyle/MeasureText.js\");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../const.js */ \"./lib/rexui/plugins/gameobjects/text/textbase/const.js\");\n/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n\r\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n//  Key: [ Object Key, Default Value ]\r\n\r\n/**\r\n * A custom function that will be responsible for wrapping the text.\r\n * @callback TextStyleWordWrapCallback\r\n *\r\n * @param {string} text - The string to wrap.\r\n * @param {Phaser.GameObjects.Text} textObject - The Text instance.\r\n *\r\n * @return {(string|string[])} Should return the wrapped lines either as an array of lines or as a string with\r\n * newline characters in place to indicate where breaks should happen.\r\n */\r\n\r\nvar propertyMap = {\r\n    // background\r\n    backgroundColor: ['backgroundColor', null],\r\n\r\n    // font\r\n    fontFamily: ['fontFamily', 'Courier'],\r\n    fontSize: ['fontSize', '16px'],\r\n    fontStyle: ['fontStyle', ''],\r\n    color: ['color', '#fff'],\r\n    stroke: ['stroke', '#fff'],\r\n    strokeThickness: ['strokeThickness', 0],\r\n    shadowOffsetX: ['shadow.offsetX', 0],\r\n    shadowOffsetY: ['shadow.offsetY', 0],\r\n    shadowColor: ['shadow.color', '#000'],\r\n    shadowBlur: ['shadow.blur', 0],\r\n    shadowStroke: ['shadow.stroke', false],\r\n    shadowFill: ['shadow.fill', false],\r\n\r\n    // underline\r\n    underlineColor: ['underline.color', '#000'],\r\n    underlineThickness: ['underline.thickness', 0],\r\n    underlineOffset: ['underline.offset', 0],\r\n\r\n    // align\r\n    halign: ['halign', 0],\r\n    valign: ['valign', 0],\r\n\r\n    // size\r\n    maxLines: ['maxLines', 0],\r\n    fixedWidth: ['fixedWidth', 0],\r\n    fixedHeight: ['fixedHeight', 0],\r\n    resolution: ['resolution', 0],\r\n    lineSpacing: ['lineSpacing', 0],\r\n\r\n    rtl: ['rtl', false],\r\n    testString: ['testString', '|MÃ‰qgy'],\r\n    baselineX: ['baselineX', 1.2],\r\n    baselineY: ['baselineY', 1.4],\r\n\r\n    // wrap\r\n    wrapMode: ['wrap.mode', 1],\r\n    wrapWidth: ['wrap.width', 0]\r\n    //wrapCallback: ['wrap.callback', null],\r\n    //wrapCallbackScope: ['wrap.callbackScope', null]\r\n};\r\n\r\nclass TextStyle {\r\n    constructor(text, style) {\r\n        this.parent = text;\r\n\r\n        this.backgroundColor;\r\n\r\n        this.fontFamily;\r\n        this.fontSize;\r\n        this.fontStyle;\r\n        this.color;\r\n        this.stroke;\r\n        this.strokeThickness;\r\n        this.shadowOffsetX;\r\n        this.shadowOffsetY;\r\n        this.shadowColor;\r\n        this.shadowBlur;\r\n        this.shadowStroke;\r\n        this.shadowFill;\r\n\r\n        this.underlineColor;\r\n        this.underlineThickness;\r\n        this.underlineOffset;\r\n\r\n        this.halign;\r\n        this.valign;\r\n\r\n        this.maxLines;\r\n        this.fixedWidth;\r\n        this.fixedHeight;\r\n        this.resolution;\r\n        this.lineSpacing;\r\n\r\n        this.rtl;\r\n        this.testString;\r\n\r\n\r\n        this.baselineX;\r\n        this.baselineY;\r\n\r\n        this._font;\r\n\r\n        //  Set to defaults + user style\r\n        this.setStyle(style, false);\r\n\r\n        var metrics = GetValue(style, 'metrics', false);\r\n\r\n        //  Provide optional TextMetrics in the style object to avoid the canvas look-up / scanning\r\n        //  Doing this is reset if you then change the font of this TextStyle after creation\r\n        if (metrics) {\r\n            this.metrics = {\r\n                ascent: GetValue(metrics, 'ascent', 0),\r\n                descent: GetValue(metrics, 'descent', 0),\r\n                fontSize: GetValue(metrics, 'fontSize', 0)\r\n            };\r\n        } else {\r\n            this.metrics = Object(_MeasureText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this);\r\n        }\r\n    }\r\n\r\n    setStyle(style, updateText) {\r\n        if (updateText === undefined) {\r\n            updateText = true;\r\n        }\r\n\r\n        if (style && style.hasOwnProperty('halign') && typeof style.halign === 'string') {\r\n            style.halign = HALIGNMODE[style.halign.toLowerCase()] || 0;\r\n        }\r\n        if (style && style.hasOwnProperty('valign') && typeof style.valign === 'string') {\r\n            style.valign = VALIGNMODE[style.valign.toLowerCase()] || 0;\r\n        }\r\n        if (style && style.hasOwnProperty('wrap')) {\r\n            var wrap = style.wrap;\r\n            if (wrap.hasOwnProperty('mode')) {\r\n                var mode = wrap.mode;\r\n                if (typeof mode === 'string') {\r\n                    wrap.mode = WRAPMODE[mode];\r\n                }\r\n            } else {\r\n                if (wrap.hasOwnProperty('width')) {\r\n                    wrap.mode = 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        //  Avoid type mutation\r\n        if (style && style.hasOwnProperty('fontSize') && typeof style.fontSize === 'number') {\r\n            style.fontSize = style.fontSize.toString() + 'px';\r\n        }\r\n\r\n        for (var key in propertyMap) {\r\n            if (key === 'wrapCallback' || key === 'wrapCallbackScope') {\r\n                // Callback & scope should be set without processing the values\r\n                this[key] = GetValue(style, propertyMap[key][0], propertyMap[key][1]);\r\n            } else {\r\n                this[key] = GetAdvancedValue(style, propertyMap[key][0], propertyMap[key][1]);\r\n            }\r\n        }\r\n\r\n        //  Allow for 'font' override\r\n        var font = GetValue(style, 'font', null);\r\n\r\n        if (font === null) {\r\n            this._font = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n        } else {\r\n            this._font = font;\r\n        }\r\n\r\n        //  Allow for 'fill' to be used in place of 'color'\r\n        var fill = GetValue(style, 'fill', null);\r\n\r\n        if (fill !== null) {\r\n            this.color = fill;\r\n        }\r\n\r\n        if (updateText) {\r\n            return this.update(true);\r\n        } else {\r\n            return this.parent;\r\n        }\r\n    }\r\n\r\n    syncFont(canvas, context) {\r\n        context.font = this._font;\r\n    }\r\n\r\n    syncStyle(canvas, context) {\r\n        context.textBaseline = 'alphabetic';\r\n\r\n        context.fillStyle = this.color;\r\n        context.strokeStyle = this.stroke;\r\n\r\n        context.lineWidth = this.strokeThickness;\r\n        context.lineCap = 'round';\r\n        context.lineJoin = 'round';\r\n    }\r\n\r\n    syncShadow(context, enabled) {\r\n        if (enabled) {\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n        } else {\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n            context.shadowColor = 0;\r\n            context.shadowBlur = 0;\r\n        }\r\n    }\r\n\r\n    update(recalculateMetrics) {\r\n        if (recalculateMetrics) {\r\n            this._font = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n\r\n            this.metrics = Object(_MeasureText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this);\r\n        }\r\n\r\n        return this.parent.updateText(recalculateMetrics);\r\n    }\r\n\r\n    buildFont() {\r\n        var newFont = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n        if (newFont !== this._font) {\r\n            this._font = newFont;\r\n            //this.metrics = MeasureText(this);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setFont(font) {\r\n        if (typeof font === 'string') {\r\n            this.fontFamily = font;\r\n            this.fontSize = '';\r\n            this.fontStyle = '';\r\n        } else {\r\n            this.fontFamily = GetValue(font, 'fontFamily', 'Courier');\r\n            this.fontSize = GetValue(font, 'fontSize', '16px');\r\n            this.fontStyle = GetValue(font, 'fontStyle', '');\r\n        }\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontFamily(family) {\r\n        this.fontFamily = family;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontStyle(style) {\r\n        this.fontStyle = style;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontSize(size) {\r\n        if (typeof size === 'number') {\r\n            size = size.toString() + 'px';\r\n        }\r\n\r\n        this.fontSize = size;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setTestString(string) {\r\n        this.testString = string;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFixedSize(width, height) {\r\n        this.fixedWidth = width;\r\n        this.fixedHeight = height;\r\n\r\n        if (width) {\r\n            this.parent.width = width;\r\n        }\r\n\r\n        if (height) {\r\n            this.parent.height = height;\r\n        }\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setResolution(value) {\r\n        this.resolution = value;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setLineSpacing(value) {\r\n        this.lineSpacing = value;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setBackgroundColor(color) {\r\n        this.backgroundColor = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setFill(color) {\r\n        this.color = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setStroke(color, thickness) {\r\n        if (color === undefined) {\r\n            //  Reset the stroke to zero (disabling it)\r\n            this.strokeThickness = 0;\r\n        } else {\r\n            if (thickness === undefined) {\r\n                thickness = this.strokeThickness;\r\n            }\r\n\r\n            this.stroke = color;\r\n            this.strokeThickness = thickness;\r\n        }\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setShadow(x, y, color, blur, shadowStroke, shadowFill) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n        if (blur === undefined) {\r\n            blur = 0;\r\n        }\r\n        if (shadowStroke === undefined) {\r\n            shadowStroke = false;\r\n        }\r\n        if (shadowFill === undefined) {\r\n            shadowFill = true;\r\n        }\r\n\r\n        this.shadowOffsetX = x;\r\n        this.shadowOffsetY = y;\r\n        this.shadowColor = color;\r\n        this.shadowBlur = blur;\r\n        this.shadowStroke = shadowStroke;\r\n        this.shadowFill = shadowFill;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowOffset(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n\r\n        this.shadowOffsetX = x;\r\n        this.shadowOffsetY = y;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowColor(color) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n\r\n        this.shadowColor = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowBlur(blur) {\r\n        if (blur === undefined) {\r\n            blur = 0;\r\n        }\r\n\r\n        this.shadowBlur = blur;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowStroke(enabled) {\r\n        this.shadowStroke = enabled;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowFill(enabled) {\r\n        this.shadowFill = enabled;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderline(color, thickness, offset) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n        if (thickness === undefined) {\r\n            thickness = 0;\r\n        }\r\n        if (offset === undefined) {\r\n            offset = 0;\r\n        }\r\n\r\n        this.underlineColor = color;\r\n        this.underlineThickness = thickness;\r\n        this.underlineOffset = offset;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineColor(color) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n\r\n        this.underlineColor = color;\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineThickness(thickness) {\r\n        if (thickness === undefined) {\r\n            thickness = 0;\r\n        }\r\n\r\n        this.underlineThickness = thickness;\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineOffset(offset) {\r\n        if (offset === undefined) {\r\n            offset = 0;\r\n        }\r\n\r\n        this.underlineOffset = offset;\r\n        return this.update(false);\r\n    }\r\n\r\n    setWrapMode(mode) {\r\n        if (typeof mode === 'string') {\r\n            mode = WRAPMODE[mode.toLowerCase()] || 0;\r\n        }\r\n        this.wrapMode = mode;\r\n        return this.update(true);\r\n    }\r\n\r\n    setWrapWidth(width) {\r\n        this.wrapWidth = width;\r\n        return this.update(false);\r\n    }\r\n\r\n    setAlign(halign, valign) {\r\n        if (halign === undefined) {\r\n            halign = 0;\r\n        }\r\n        if (valign === undefined) {\r\n            valign = 0;\r\n        }\r\n\r\n        if (typeof halign === 'string') {\r\n            halign = HALIGNMODE[halign.toLowerCase()] || 0;\r\n        }\r\n        if (typeof valign === 'string') {\r\n            valign = HALIGNMODE[valign.toLowerCase()] || 0;\r\n        }\r\n        this.halign = halign;\r\n        this.valign = valign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setHAlign(halign) {\r\n        if (halign === undefined) {\r\n            halign = 0;\r\n        }\r\n        if (typeof halign === 'string') {\r\n            halign = HALIGNMODE[halign.toLowerCase()] || 0;\r\n        }\r\n        this.halign = halign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setVAlign(valign) {\r\n        if (valign === undefined) {\r\n            valign = 0;\r\n        }\r\n        if (typeof valign === 'string') {\r\n            valign = HALIGNMODE[valign.toLowerCase()] || 0;\r\n        }\r\n        this.valign = valign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setMaxLines(max) {\r\n        if (max === undefined) {\r\n            max = 0;\r\n        }\r\n\r\n        this.maxLines = max;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    getTextMetrics() {\r\n        var metrics = this.metrics;\r\n\r\n        return {\r\n            ascent: metrics.ascent,\r\n            descent: metrics.descent,\r\n            fontSize: metrics.fontSize\r\n        };\r\n    }\r\n\r\n    get lineHeight() {\r\n        return this.metrics.fontSize + this.strokeThickness + this.lineSpacing;\r\n    }\r\n\r\n    toJSON() {\r\n        var output = {};\r\n\r\n        for (var key in propertyMap) {\r\n            output[key] = this[key];\r\n        }\r\n\r\n        output.metrics = this.getTextMetrics();\r\n\r\n        return output;\r\n    }\r\n\r\n    destroy() {\r\n        this.parent = undefined;\r\n    }\r\n\r\n}\r\n\r\nconst HALIGNMODE = {\r\n    left: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hleft,\r\n    center: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hcenter,\r\n    right: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hright,\r\n};\r\nconst VALIGNMODE = {\r\n    top: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vtop,\r\n    center: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vcenter,\r\n    bottom: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vbottom,\r\n};\r\nconst WRAPMODE = {\r\n    none: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].NO_WRAP,\r\n    word: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].WORD_WRAP,\r\n    char: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].CHAR_WRAP,\r\n    character: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].CHAR_WRAP\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextStyle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/text/textbase/textstyle/TextStyle.js?")},"./lib/rexui/plugins/gameobjects/video/videobase/CreateVideoElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar CreateVideoElement = function (config) {\r\n    var element = document.createElement('video');\r\n\r\n    // Apply registed properties\r\n    var elemProp, elemPropValue;\r\n    for (var key in ElementProperties) {\r\n        elemProp = ElementProperties[key];\r\n        elemPropValue = GetValue(config, key, elemProp[1]);\r\n        if (elemPropValue !== undefined) {\r\n            element[elemProp[0]] = elemPropValue;\r\n        }\r\n    }\r\n\r\n    // Apply events\r\n    var eventEmitter = GetValue(config, 'eventEmitter', undefined);\r\n    if (eventEmitter) {\r\n        for (let eventName in ElementEvents) { // Note: Don't use `var` here\r\n            element.addEventListener(ElementEvents[eventName], (function () {\r\n                eventEmitter.emit(eventName, this);\r\n            }).bind(this));\r\n        }\r\n    }\r\n\r\n    return element;\r\n}\r\n\r\nconst ElementProperties = {\r\n    id: ['id', undefined],\r\n    width: ['width', undefined],\r\n    height: ['height', undefined],\r\n    autoPlay: ['autoplay', true],\r\n    controls: ['controls', false],\r\n    loop: ['loop', false],\r\n    poster: ['poster', undefined],\r\n    preload: ['preload', undefined],\r\n    muted: ['muted', false],\r\n    playsInline: ['playsInline', true],\r\n    crossOrigin: ['crossOrigin', 'anonymous'],\r\n};\r\n\r\nconst ElementEvents = {\r\n    canplay: 'canplay',\r\n    canplaythrough: 'canplaythrough',\r\n    ended: 'ended',\r\n    error: 'error',\r\n    loadstart: 'loadstart',\r\n    playing: 'playing',\r\n    pause: 'pause',\r\n    stalled: 'stalled',\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CreateVideoElement);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/video/videobase/CreateVideoElement.js?")},"./lib/rexui/plugins/gameobjects/video/videobase/Load.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\n\r\nvar Load = function (video, src, availableVideoTypes) {\r\n    if (IsPlainObject(src)) {\r\n        var videoType;\r\n        for (var i = 0, cnt = VideoTypes.length; i < cnt; i++) {\r\n            videoType = VideoTypes[i];\r\n            if (availableVideoTypes[videoType + 'Video'] && src.hasOwnProperty(videoType)) {\r\n                src = src[videoType];\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    video.src = src;\r\n    video.load();\r\n}\r\n\r\nconst VideoTypes = ['webm', 'ogg', 'mp4', 'h264', 'vp9', 'hls'];\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Load);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/video/videobase/Load.js?")},"./lib/rexui/plugins/gameobjects/video/videobase/VideoBase.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _CreateVideoElement_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CreateVideoElement.js */ "./lib/rexui/plugins/gameobjects/video/videobase/CreateVideoElement.js");\n/* harmony import */ var _Load_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Load.js */ "./lib/rexui/plugins/gameobjects/video/videobase/Load.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\n\r\nvar VideoBase = function (GOClass) {\r\n    return class Base extends GOClass {\r\n        createVideoElement(config) {\r\n            if (!this.video) {\r\n                if (config === undefined) {\r\n                    config = {};\r\n                }\r\n                config.eventEmitter = this;\r\n                this.video = Object(_CreateVideoElement_js__WEBPACK_IMPORTED_MODULE_0__["default"])(config);\r\n                this.playbackTimeChangeEventEnable = GetValue(config, \'playbackTimeChangeEventEnable\', true);\r\n            }\r\n            return this.video;\r\n        }\r\n\r\n        preDestroy() {\r\n            //  This Game Object has already been destroyed\r\n            if (!this.scene) {\r\n                return;\r\n            }\r\n            if (this.video) {\r\n                this.video.pause();\r\n                this.video.removeAttribute(\'src\'); // empty source\r\n                this.video.load();\r\n                this.video = undefined;\r\n            }\r\n            if (super.preDestroy) {\r\n                super.preDestroy();\r\n            }\r\n        }\r\n\r\n        preUpdate(time, delta) {\r\n            if (this.playbackTimeChangeEventEnable) {\r\n                var curT = this.playbackTime;\r\n                if (curT !== this.prevT) {\r\n                    this.emit(\'playbacktimechange\', this);\r\n                }\r\n                this.prevT = curT;\r\n            }\r\n            if (super.preUpdate) {\r\n                super.preUpdate(time, delta);\r\n            }\r\n        }\r\n\r\n        get availableVideoTypes() {\r\n            return this.scene.sys.game.device.video;\r\n        }\r\n\r\n        load(src) {\r\n            if (this.video) {\r\n                Object(_Load_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.video, src, this.availableVideoTypes);\r\n            }\r\n            return this;\r\n        }\r\n\r\n        play() {\r\n            if (this.video) {\r\n                this.video.play();\r\n            }\r\n            return this;\r\n        }\r\n\r\n        get isPlaying() {\r\n            if (this.video) {\r\n                var video = this.video;\r\n                return (!video.paused) && (!video.ended) && (video.currentTime > 0);\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        pause() {\r\n            if (this.video) {\r\n                this.video.pause();\r\n            }\r\n            return this;\r\n        }\r\n\r\n        get isPaused() {\r\n            if (this.video) {\r\n                return this.video.paused;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        get playbackTime() {\r\n            if (this.video) {\r\n                return this.video.currentTime || 0;\r\n            } else {\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        set playbackTime(value) {\r\n            if (this.video) {\r\n                try {\r\n                    this.video.currentTime = value;\r\n                } catch (e) {\r\n                }\r\n            }\r\n        }\r\n\r\n        setPlaybackTime(time) {\r\n            this.playbackTime = time;\r\n            return this;\r\n        }\r\n\r\n        get duration() {\r\n            if (this.video) {\r\n                return this.video.duration || 0;\r\n            } else {\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        get t() {\r\n            if (this.video) {\r\n                var duration = this.duration;\r\n                return (duration === 0) ? 0 : this.playbackTime / duration;\r\n            } else {\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        set t(value) {\r\n            if (this.video) {\r\n                this.playbackTime = this.duration * Clamp(value, 0, 1);\r\n            }\r\n        }\r\n\r\n        setT(value) {\r\n            this.t = value;\r\n            return this;\r\n        }\r\n\r\n        get hasEnded() {\r\n            if (this.video) {\r\n                return this.video.ended;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        get volume() {\r\n            if (this.video) {\r\n                return this.video.volume || 0;\r\n            } else {\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        set volume(value) {\r\n            if (this.video) {\r\n                this.video.volume = value;\r\n            }\r\n        }\r\n\r\n        setVolume(value) {\r\n            this.volume = value;\r\n            return this;\r\n        }\r\n\r\n        get muted() {\r\n            if (this.video) {\r\n                return this.video.muted || false;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        set muted(value) {\r\n            if (this.video) {\r\n                this.video.muted = value;\r\n            }\r\n        }\r\n\r\n        setMute(value) {\r\n            if (value === undefined) {\r\n                value = true;\r\n            }\r\n            this.muted = value;\r\n            return this;\r\n        }\r\n\r\n        get loop() {\r\n            if (this.video) {\r\n                return this.video.loop;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        set loop(value) {\r\n            if (this.video) {\r\n                this.video.loop = value;\r\n            }\r\n        }\r\n\r\n        setLoop(value) {\r\n            if (value === undefined) {\r\n                value = true;\r\n            }\r\n            this.loop = value;\r\n            return this;\r\n        }\r\n\r\n        get readyState() {\r\n            if (this.video) {\r\n                return this.video.readyState;\r\n            } else {\r\n                return undefined;\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (VideoBase);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/video/videobase/VideoBase.js?')},"./lib/rexui/plugins/gameobjects/video/videodom/VideoDOM.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _videobase_VideoBase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../videobase/VideoBase.js */ \"./lib/rexui/plugins/gameobjects/video/videobase/VideoBase.js\");\n\r\n\r\nconst DOMElement = Phaser.GameObjects.DOMElement;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass VideoDOM extends Object(_videobase_VideoBase_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(DOMElement) {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        var autoRound = scene.scale.autoRound;\r\n        if (width !== undefined) {\r\n            if (autoRound) {\r\n                width = Math.floor(width);\r\n            }\r\n            config.width = width;\r\n        }\r\n        if (height !== undefined) {\r\n            if (autoRound) {\r\n                height = Math.floor(height);\r\n            }\r\n            config.height = height;\r\n        }\r\n\r\n        super(scene, x, y);\r\n        this.type = 'rexVideo';\r\n\r\n        this\r\n            .setElement(this.createVideoElement(config))\r\n            .load(GetValue(config, 'src', ''));\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        this.node.width = width;\r\n        this.node.height = height;\r\n        this.updateSize();\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (VideoDOM);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/video/videodom/VideoDOM.js?")},"./lib/rexui/plugins/gameobjects/youtubeplayer/LoadAPI.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_loader_LoadScript_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/loader/LoadScript.js */ "./lib/rexui/plugins/utils/loader/LoadScript.js");\n\r\n\r\nvar IsAPIReady = false;\r\nvar LoadAPI = function (onLoaded) {\r\n    if (IsAPIReady) {\r\n        onLoaded();\r\n    } else {\r\n        if (!window.onYouTubeIframeAPIReady) {\r\n            window.onYouTubeIframeAPIReady = function () {\r\n                IsAPIReady = true;\r\n                for(var i=0, cnt = CallbackQueue.length; i<cnt; i++) {\r\n                    CallbackQueue[i]();\r\n                }\r\n                CallbackQueue = undefined;\r\n            };\r\n            Object(_utils_loader_LoadScript_js__WEBPACK_IMPORTED_MODULE_0__["default"])(\'https://www.youtube.com/iframe_api\');\r\n            // Function onYouTubeIframeAPIReady() should be defined before loading \r\n        }\r\n        CallbackQueue.push(onLoaded);\r\n    }\r\n}\r\nvar CallbackQueue = [];\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LoadAPI);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/youtubeplayer/LoadAPI.js?')},"./lib/rexui/plugins/gameobjects/youtubeplayer/YoutubePlayer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _LoadAPI_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LoadAPI.js */ \"./lib/rexui/plugins/gameobjects/youtubeplayer/LoadAPI.js\");\n\r\n\r\nconst DOMElement = Phaser.GameObjects.DOMElement;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\n\r\nclass YoutubePlayer extends DOMElement {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        var autoRound = scene.scale.autoRound;\r\n        if (width !== undefined) {\r\n            if (autoRound) {\r\n                width = Math.floor(width);\r\n            }\r\n            config.width = width + 'px';\r\n        }\r\n        if (height !== undefined) {\r\n            if (autoRound) {\r\n                height = Math.floor(height);\r\n            }\r\n            config.height = height + 'px';\r\n        }\r\n\r\n        super(scene, x, y);\r\n        this.type = 'rexYoutubePlayer';\r\n        this.youtubePlayer = undefined;\r\n        this.videoState = undefined;\r\n        this.videoId = GetValue(config, 'videoId', '');\r\n        this.loop = GetValue(config, 'loop', false);\r\n        this.paddingCallbacks = [];\r\n\r\n        // Create DIV element and add it\r\n        var elementId = 'YT' + Date.now();\r\n        var element = document.createElement('div');\r\n        element.id = elementId;\r\n        element.style.width = config.width;\r\n        element.style.height = config.height;\r\n        this.setElement(element);\r\n\r\n        // Create youtube player iframe when API ready\r\n        var playerVars = {\r\n            autoplay: GetValue(config, 'autoPlay', true) ? 1 : 0,\r\n            controls: GetValue(config, 'controls', true) ? 1 : 0,\r\n            disablekb: !GetValue(config, 'keyboardControl', true) ? 1 : 0,\r\n            modestbranding: GetValue(config, 'modestBranding', false) ? 1 : 0,\r\n        };\r\n        var onLoad = (function () {\r\n            var youtubePlayer = new YT.Player(\r\n                elementId,\r\n                {\r\n                    'videoId': this.videoId,\r\n                    'playerVars': playerVars,\r\n                    'events': {\r\n                        'onStateChange': (function (event) {\r\n                            this.videoState = event.data;\r\n\r\n                            this.emit('statechange', this);\r\n                            this.emit(this.videoStateString, this);\r\n\r\n                            if ((this.videoState === YT.PlayerState.ENDED) && this.loop) {\r\n                                this.youtubePlayer.playVideo();\r\n                            }\r\n                        }).bind(this),\r\n                        'onReady': (function (event) {\r\n                            this.youtubePlayer = youtubePlayer;\r\n                            for (var i = 0, cnt = this.paddingCallbacks.length; i < cnt; i++) {\r\n                                this.paddingCallbacks[i]();\r\n                            }\r\n                            this.paddingCallbacks = undefined;\r\n                            this.emit('ready', this);\r\n                        }).bind(this),\r\n                        'onError': (function (event) {\r\n                            this.lastError = event.data;\r\n                            this.emit('error', this, this.lastError);\r\n                        }).bind(this),\r\n                    }\r\n                }\r\n            );\r\n            this.setElement(document.getElementById(elementId)); // Also remove previous DIV element\r\n        }).bind(this);\r\n        Object(_LoadAPI_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(onLoad);\r\n    }\r\n\r\n    _runCallback(callback) {\r\n        if (this.youtubePlayer === undefined) {\r\n            this.paddingCallbacks.push(callback);\r\n        } else {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    get videoStateString() {\r\n        if ((this.videoState === undefined) || (!YT)) {\r\n            return '';\r\n        } else {\r\n            switch (this.videoState) {\r\n                case -1: return \"unstarted\";\r\n                case YT.PlayerState.ENDED: return \"ended\";\r\n                case YT.PlayerState.PLAYING: return \"playing\";\r\n                case YT.PlayerState.PAUSED: return \"pause\";\r\n                case YT.PlayerState.BUFFERING: return \"buffering\";\r\n                case YT.PlayerState.CUED: return \"cued\";\r\n            }\r\n        }\r\n    }\r\n\r\n    load(videoId, autoPlay) {\r\n        if (autoPlay === undefined) {\r\n            autoPlay = true;\r\n        }\r\n\r\n        var callback = (function () {\r\n            this.youtubePlayer.loadVideoById(videoId);\r\n            if (autoPlay) {\r\n                this.youtubePlayer.playVideo();\r\n            } else {\r\n                this.youtubePlayer.pauseVideo();\r\n            }\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n        return this;\r\n    }\r\n\r\n    play() {\r\n        var callback = (function () {\r\n            this.youtubePlayer.playVideo();\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n        return this;\r\n    }\r\n\r\n    get isPlaying() {\r\n        return (this.videoState === 1); // YT.PlayerState.PLAYING\r\n    }\r\n\r\n    pause() {\r\n        var callback = (function () {\r\n            this.youtubePlayer.pauseVideo();\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n        return this;\r\n    }\r\n\r\n    get isPaused() {\r\n        return (this.videoState === 2); // YT.PlayerState.PAUSED\r\n    }\r\n\r\n    get playbackTime() {\r\n        return (this.youtubePlayer) ? this.youtubePlayer.getCurrentTime() : 0;\r\n    }\r\n\r\n    set playbackTime(value) {\r\n        var callback = (function () {\r\n            this.youtubePlayer.seekTo(value);\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n    }\r\n\r\n    setPlaybackTime(time) {\r\n        this.playbackTime = time;\r\n        return this;\r\n    }\r\n\r\n    get duration() {\r\n        return (this.youtubePlayer) ? this.youtubePlayer.getDuration() : 0;\r\n    }\r\n\r\n    get t() {\r\n        var duration = this.duration;\r\n        return (duration === 0) ? 0 : this.playbackTime / duration;\r\n    }\r\n\r\n    set t(value) {\r\n        var callback = (function () {\r\n            value = Clamp(value, 0, 1);\r\n            this.playbackTime = this.duration * Clamp(value, 0, 1);\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n    }\r\n\r\n    setT(value) {\r\n        this.t = value;\r\n        return this;\r\n    }\r\n\r\n    get hasEnded() {\r\n        return (this.videoState === 0); // YT.PlayerState.ENDED\r\n    }\r\n\r\n    get volume() {\r\n        return (this.youtubePlayer) ? (this.youtubePlayer.getVolume() / 100) : 0;\r\n    }\r\n\r\n    set volume(value) {\r\n        var callback = (function () {\r\n            this.youtubePlayer.setVolume(Clamp(value * 100, 0, 100));\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n    }\r\n\r\n    setVolume(value) {\r\n        this.volume = value;\r\n        return this;\r\n    }\r\n\r\n    get muted() {\r\n        return (this.youtubePlayer) ? this.youtubePlayer.isMuted() : false;\r\n    }\r\n\r\n    set muted(value) {\r\n        var callback = (function () {\r\n            if (value) {\r\n                this.youtubePlayer.mute();\r\n            } else {\r\n                this.youtubePlayer.unMute();\r\n            }\r\n        }).bind(this);\r\n\r\n        this._runCallback(callback);\r\n    }\r\n\r\n    setMute(value) {\r\n        if (value === undefined) {\r\n            value = true;\r\n        }\r\n        this.muted = value;\r\n        return this;\r\n    }\r\n\r\n    setLoop(value) {\r\n        if (value === undefined) {\r\n            value = true;\r\n        }\r\n        this.loop = value;\r\n        return this;\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        var style = this.node.style;\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        this.updateSize();\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (YoutubePlayer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/gameobjects/youtubeplayer/YoutubePlayer.js?")},"./lib/rexui/plugins/input/button/Button.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Button {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.pointer = undefined;\r\n        this.lastClickTime = undefined;\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.setMode(GetValue(o, \"mode\", 1));\r\n        this.setClickInterval(GetValue(o, \"clickInterval\", 100));\r\n        this.setDragThreshold(GetValue(o, 'threshold', undefined));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('pointerdown', this.onPress, this);\r\n        this.gameObject.on('pointerup', this.onRelease, this);\r\n        this.gameObject.on('pointerout', this.onPointOut, this);\r\n        this.gameObject.on('pointermove', this.onMove, this);\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.pointer = undefined;\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        // gameObject events will be removed when this gameObject destroyed \r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.cancel();\r\n        }\r\n        this.enable = e;\r\n        this.gameObject.input.enabled = e;\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = CLICKMODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setClickInterval(interval) {\r\n        this.clickInterval = interval; // ms\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    // internal\r\n    onPress(pointer) {\r\n        if (this.pointer !== undefined) {\r\n            return;\r\n        }\r\n        this.pointer = pointer;\r\n        if (this.mode === 0) {\r\n            this.click(pointer.downTime, pointer);\r\n        }\r\n    }\r\n\r\n    onRelease(pointer) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        if (this.mode === 1) {\r\n            this.click(pointer.upTime, pointer);\r\n        }\r\n        this.pointer = undefined;\r\n    }\r\n\r\n    onPointOut(pointer) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        this.cancel();\r\n    }\r\n\r\n    onMove(pointer) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n\r\n        if (this.dragThreshold === undefined) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.getDistance() >= this.dragThreshold) {\r\n            this.cancel();\r\n        }\r\n    }\r\n\r\n    click(nowTime, pointer) {\r\n        if (nowTime === undefined) {\r\n            // fires 'click' event manually\r\n            this.emit('click', this, this.gameObject, pointer);\r\n            return this;\r\n        }\r\n\r\n        this.pointer = undefined;\r\n        var lastClickTime = this.lastClickTime;\r\n        if ((lastClickTime !== undefined) &&\r\n            ((nowTime - lastClickTime) <= this.clickInterval)) {\r\n            return this;\r\n        }\r\n        this.lastClickTime = nowTime;\r\n        this.emit('click', this, this.gameObject, pointer);\r\n        return this;\r\n    }\r\n\r\n    cancel() {\r\n        this.pointer = undefined;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Button.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nconst CLICKMODE = {\r\n    'press': 0,\r\n    'pointerdown': 0,\r\n    'release': 1,\r\n    'pointerup': 1,\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Button);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/button/Button.js?")},"./lib/rexui/plugins/input/dragspeed/DragSpeed.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\n\r\nclass DragSpeed {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.pointer = undefined;\r\n        this.isInTouched = false;\r\n        this.holdStartTime = undefined;\r\n        this.x = undefined;\r\n        this.y = undefined;\r\n        this.preX = undefined;\r\n        this.preY = undefined;\r\n        this.localX = undefined;\r\n        this.localY = undefined;\r\n        this.justMoved = false;\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.holdThreshold = GetValue(o, \"holdThreshold\", 50); // ms\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('pointerdown', this.onPointIn, this);\r\n        this.gameObject.on('pointerover', this.onPointIn, this);\r\n        this.gameObject.on('pointerup', this.onPointOut, this);\r\n        this.gameObject.on('pointerout', this.onPointOut, this);\r\n        this.gameObject.on('pointermove', this.onPointerMove, this);\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n        this.scene.events.on('preupdate', this.preupdate, this);\r\n    }\r\n\r\n    shutdown() {\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('preupdate', this.preupdate, this);\r\n        }\r\n        this.pointer = undefined;\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        // GameObject events will be removed when this gameObject destroyed \r\n        this.destroyEventEmitter();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.isInTouched = false;\r\n            this.pointer = undefined;\r\n        }\r\n        this.enable = e;\r\n        this.gameObject.input.enabled = e;\r\n        return this;\r\n    }\r\n\r\n    get isDown() {\r\n        return this.pointer && this.pointer.isDown;\r\n    }\r\n\r\n    get isUp() {\r\n        return !this.isDown;\r\n    }\r\n\r\n    get dx() {\r\n        return this.x - this.preX;\r\n    }\r\n\r\n    get dy() {\r\n        return this.y - this.preY;\r\n    }\r\n\r\n    get dt() {\r\n        var game = this.scene.sys.game;\r\n        var delta = game.loop.delta;\r\n        return delta;\r\n    }\r\n\r\n    get speed() {\r\n        if ((this.x === this.preX) && (this.y === this.preY)) {\r\n            return 0;\r\n        }\r\n        var d = DistanceBetween(this.preX, this.preY, this.x, this.y);\r\n        var speed = d / (this.dt * 0.001);\r\n        return speed;\r\n    }\r\n\r\n    get speedX() {\r\n        return this.dx / (this.dt * 0.001);\r\n    }\r\n\r\n    get speedY() {\r\n        return this.dy / (this.dt * 0.001);\r\n    }\r\n\r\n    // internal\r\n    onPointIn(pointer, localX, localY) {\r\n        if (!pointer.isDown ||\r\n            (this.pointer !== undefined)) {\r\n            return;\r\n        }\r\n        this.pointer = pointer;\r\n        this.localX = localX;\r\n        this.localY = localY;\r\n    }\r\n\r\n    onPointOut(pointer) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        this.pointer = undefined;\r\n    }\r\n\r\n    onPointerMove(pointer, localX, localY) {\r\n        if (!pointer.isDown ||\r\n            (this.pointer !== pointer)) {\r\n            return;\r\n        }\r\n        this.localX = localX;\r\n        this.localY = localY;\r\n    }\r\n\r\n    preupdate(time, delta) {\r\n        var pointer = this.pointer;\r\n        this.justMoved = false;\r\n        if (pointer && (!this.isInTouched)) {\r\n            // Touch start\r\n            this.x = pointer.x;\r\n            this.y = pointer.y;\r\n            this.preX = pointer.x;\r\n            this.preY = pointer.y;\r\n            this.isInTouched = true;\r\n            this.holdStartTime = undefined;\r\n            this.emit('touchstart', pointer, this.localX, this.localY);\r\n\r\n        } else if (pointer && this.isInTouched) {\r\n            // In touch\r\n            if ((this.x === pointer.x) && (this.y === pointer.y)) {\r\n                // Hold\r\n                if (this.holdStartTime === undefined) {\r\n                    this.holdStartTime = time;\r\n                } else if (time - this.holdStartTime > this.holdThreshold) {\r\n                    this.preX = this.x;\r\n                    this.preY = this.y;\r\n                }\r\n            } else {\r\n                // Move\r\n                this.preX = this.x;\r\n                this.preY = this.y;\r\n                this.x = pointer.x;\r\n                this.y = pointer.y;\r\n                this.holdStartTime = undefined;\r\n                this.justMoved = true;\r\n                this.emit('touchmove', pointer, this.localX, this.localY);\r\n            }\r\n\r\n        } else if ((!pointer) && this.isInTouched) {\r\n            // Touch end\r\n            this.isInTouched = false;\r\n            this.holdStartTime = undefined;\r\n            this.emit('touchend', pointer);\r\n\r\n        }\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    DragSpeed.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (DragSpeed);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/dragspeed/DragSpeed.js?")},"./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/ticktask/TickTask.js */ \"./lib/rexui/plugins/utils/ticktask/TickTask.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass OnePointerTracer extends _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        var scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(gameObject);\r\n        if (scene === gameObject) {\r\n            gameObject = undefined;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.scene = scene;\r\n        this.gameObject = gameObject;\r\n        if (gameObject) {\r\n            gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        }\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n\r\n        if (this.gameObject === undefined) {\r\n            this.bounds = GetValue(o, 'bounds', undefined);\r\n        } else {\r\n            this.bounds = undefined;\r\n        }\r\n\r\n        this.tracerState = TOUCH0;\r\n        // this.recongizedState = new stateClass(this);\r\n        this.pointer = undefined;\r\n        this.lastPointer = undefined; // Last catched pointer\r\n        this.movedState = false;\r\n        this.isTouchingAnyObject = false;\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        super.boot();\r\n        if (this.gameObject) {\r\n            this.gameObject.on('pointerdown', this.onPointerDown, this);\r\n        } else {\r\n            this.scene.input.on('pointerdown', this.onPointerDown, this);\r\n        }\r\n        this.scene.input.on('pointerup', this.onPointerUp, this);\r\n        this.scene.input.on('pointermove', this.onPointerMove, this);\r\n        this.scene.events.once('shutdown', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        if (this.gameObject) {\r\n            this.gameObject.off('pointerdown', this.onPointerDown, this);\r\n        } else if (this.scene) {\r\n            this.scene.input.off('pointerdown', this.onPointerDown, this);\r\n        }\r\n        if (this.scene) {\r\n            this.scene.input.off('pointerup', this.onPointerUp, this);\r\n            this.scene.input.off('pointermove', this.onPointerMove, this);\r\n            this.scene.events.off('destroy', this.destroy, this);\r\n            this.scene = undefined;\r\n        }\r\n\r\n        this.scene = undefined;\r\n        this.gameObject = undefined;\r\n        this.bounds = undefined;\r\n        this.pointer = undefined;\r\n        this.lastPointer = undefined; // Last catched pointer\r\n        this.movedState = false;\r\n        super.shutdown();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.dragCancel();\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    onPointerDown(pointer, gameObjects) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer !== undefined) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer === pointer) {\r\n            return;\r\n        }\r\n\r\n        this.pointer = pointer;\r\n        this.lastPointer = pointer;\r\n        this.movedState = false;\r\n        this.tracerState = TOUCH1;\r\n\r\n        if (this.gameObject === undefined) {\r\n            this.isTouchingAnyObject = (gameObjects.length > 0);\r\n        }\r\n        this.onDragStart();\r\n    }\r\n\r\n    onPointerUp(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n\r\n        this.pointer = undefined;\r\n        this.movedState = false;\r\n        this.tracerState = TOUCH0;\r\n        this.onDragEnd();\r\n    }\r\n\r\n    onPointerMove(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.isDown) {\r\n            var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            var isCatchedPointer = (this.pointer === pointer);\r\n            if (!isCatchedPointer && isInsideBounds) { // Pointer moves into bounds\r\n                // this.onPointerDown(pointer);\r\n            } else if (isCatchedPointer && !isInsideBounds) { // Pointer moves out of bounds\r\n                this.onPointerUp(pointer);\r\n            } else { // Pointer drags in bounds\r\n                if (!this.movedState) {\r\n                    this.movedState = (pointer.x !== pointer.downX) || (pointer.y !== pointer.downY);\r\n                }\r\n                if (this.movedState) {\r\n                    this.onDrag();\r\n                }\r\n            }\r\n        } else {\r\n            // var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            // var isLastCatchedPointer = (this.lastPointer === pointer);\r\n            // if (isLastCatchedPointer && isInsideBounds) {\r\n            //     this.onLastPointerMove();\r\n            // }\r\n        }\r\n    }\r\n\r\n    dragCancel() {\r\n        if (this.tracerState === TOUCH1) {\r\n            this.onDragEnd();\r\n        }\r\n        this.pointer = undefined;\r\n        this.tracerState = TOUCH0;\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.emit('dragstart', this);\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.emit('dragend', this);\r\n    }\r\n\r\n    onDrag() {\r\n        this.emit('drag', this);\r\n    }\r\n\r\n    // onLastPointerMove() { }\r\n\r\n    preUpdate(time, delta) { }\r\n\r\n    postUpdate(time, delta) { }\r\n\r\n    startTicking() {\r\n        super.startTicking();\r\n        this.scene.events.on('preupdate', this.preUpdate, this);\r\n        this.scene.events.on('postupdate', this.postUpdate, this);\r\n    }\r\n\r\n    stopTicking() {\r\n        super.stopTicking();\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('preupdate', this.preUpdate, this);\r\n            this.scene.events.off('postupdate', this.postUpdate, this);\r\n        }\r\n    }\r\n\r\n    setRecongizedStateObject(stateObject) {\r\n        this.recongizedState = stateObject;\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this.recongizedState.state;\r\n    }\r\n\r\n    set state(newState) {\r\n        this.recongizedState.state = newState;\r\n    }\r\n\r\n    cancel() {\r\n        this.state = IDLE;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst TOUCH0 = 0;\r\nconst TOUCH1 = 1;\r\n\r\nconst IDLE = 'IDLE';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (OnePointerTracer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js?")},"./lib/rexui/plugins/input/gestures/pan/Pan.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Pan extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        var pointer = self.pointer;\r\n                        self.startX = pointer.x;\r\n                        self.startY = pointer.y;\r\n                        self.startWorldX = pointer.worldX;\r\n                        self.startWorldY = pointer.worldY;\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('panstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.endX = pointer.x;\r\n                        self.endY = pointer.y;\r\n                        self.endWorldX = pointer.worldX;\r\n                        self.endWorldY = pointer.worldY;\r\n                        self.emit('panend', self, self.gameObject, self.lastPointer);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 10));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = (this.dragThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if (this.pointer.getDistance() >= this.dragThreshold) {\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n\r\n            case RECOGNIZED:\r\n                var p1 = this.pointer.position;\r\n                var p0 = this.pointer.prevPosition;\r\n                this.dx = p1.x - p0.x;\r\n                this.dy = p1.y - p0.y;\r\n                var pointer = this.pointer;\r\n                self.x = pointer.x;\r\n                self.y = pointer.y;\r\n                self.worldX = pointer.worldX;\r\n                self.worldY = pointer.worldY;\r\n                this.emit('pan', this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isPan() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pan);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/pan/Pan.js?")},"./lib/rexui/plugins/input/gestures/pinch/Pinch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../twopointerstracer/TwoPointersTracer.js */ \"./lib/rexui/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Pinch extends _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        super(scene, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.prevDistance = undefined;\r\n                        self.scaleFactor = 1;\r\n                    },\r\n                },\r\n                BEGIN: {\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('pinchstart', self);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('pinchend', self);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 0));\r\n        return this;\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.scaleFactor = 1;\r\n        this.prevDistance = this.distanceBetween;\r\n        this.state = (this.dragThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag2() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if ((this.pointers[0].getDistance() >= this.dragThreshold) &&\r\n                    (this.pointers[1].getDistance() >= this.dragThreshold)) {\r\n                    var curDistance = this.distanceBetween;\r\n                    this.scaleFactor = curDistance / this.prevDistance;\r\n                    this.prevDistance = curDistance;\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n            case RECOGNIZED:\r\n                var curDistance = this.distanceBetween;\r\n                this.scaleFactor = curDistance / this.prevDistance;\r\n                this.emit('pinch', this);\r\n                this.prevDistance = curDistance;\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isPinch() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pinch);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/pinch/Pinch.js?")},"./lib/rexui/plugins/input/gestures/press/Press.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Press extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.x = 0;\r\n                        self.y = 0;\r\n                        self.worldX = 0;\r\n                        self.worldY = 0;\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.x = pointer.x;\r\n                        self.y = pointer.y;\r\n                        self.worldX = pointer.worldX;\r\n                        self.worldY = pointer.worldY;\r\n                    }\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.start();\r\n                    },\r\n                    exit: function () {\r\n                        self.stop();\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('pressstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('pressend', self, self.gameObject, self.lastPointer);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 9));\r\n        this.setMinHoldTime(GetValue(o, 'time', 251));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = (this.holdTime === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === IDLE) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer.getDistance() > this.dragThreshold) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    preUpdate(time, delta) {\r\n        if (this.state === BEGIN) {\r\n            var holdTime = time - this.pointer.downTime;\r\n            if (holdTime >= this.holdTime) {\r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    get isPressed() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setMinHoldTime(time) {\r\n        this.holdTime = time; // ms\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Press);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/press/Press.js?")},"./lib/rexui/plugins/input/gestures/rotate/Rotate.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../twopointerstracer/TwoPointersTracer.js */ \"./lib/rexui/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n/* harmony import */ var _SpinObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SpinObject.js */ \"./lib/rexui/plugins/input/gestures/rotate/SpinObject.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst WrapDegrees = Phaser.Math.Angle.WrapDegrees; // Wrap degrees: -180 to 180 \r\nconst ShortestBetween = Phaser.Math.Angle.ShortestBetween;\r\nconst RadToDeg = Phaser.Math.RadToDeg;\r\nconst DegToRad = Phaser.Math.DegToRad;\r\n\r\nclass Rotate extends _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        super(scene, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.prevAngle = undefined;\r\n                        self.angle = 0;\r\n                    },\r\n                },\r\n                BEGIN: {\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('rotatestart', self);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('rotateend', self);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 0));\r\n        return this;\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.prevAngle = WrapDegrees(RadToDeg(this.angleBetween)); // Degrees\r\n        this.state = (this.rotationThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag2() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if ((this.pointers[0].getDistance() >= this.dragThreshold) &&\r\n                    (this.pointers[1].getDistance() >= this.dragThreshold)) {\r\n                    var curAngle = WrapDegrees(RadToDeg(this.angleBetween));\r\n                    this.angle = ShortestBetween(this.prevAngle, curAngle);\r\n                    this.prevAngle = curAngle;\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n            case RECOGNIZED:\r\n                var curAngle = WrapDegrees(RadToDeg(this.angleBetween));\r\n                this.angle = ShortestBetween(this.prevAngle, curAngle);\r\n                this.prevAngle = curAngle;\r\n                this.emit('rotate', this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isRotation() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    get rotation() {\r\n        return DegToRad(this.angle);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nvar methods = {\r\n    spinObject: _SpinObject_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n};\r\nObject.assign(\r\n    Rotate.prototype,\r\n    methods\r\n);\r\n\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Rotate);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/rotate/Rotate.js?")},"./lib/rexui/plugins/input/gestures/rotate/SpinObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/actions/RotateObjectAround.js */ "./lib/rexui/plugins/utils/actions/RotateObjectAround.js");\n\r\n\r\nvar SpinObject = function (gameObject, camera) {\r\n    if (!this.isRotation) {\r\n        return this;\r\n    }\r\n\r\n    if (camera === undefined) {\r\n        camera = this.pointers[0].camera;\r\n    }\r\n\r\n    var movementX = this.movementCenterX,\r\n        movementY = this.movementCenterY;\r\n\r\n    camera.getWorldPoint(this.centerX, this.centerY, tmpPos);\r\n    var centerWorldX = tmpPos.x;\r\n    var centerWorldY = tmpPos.y;\r\n\r\n    var angle = this.rotation;\r\n    if (Array.isArray(gameObject)) {\r\n        var gameObjects = gameObject;\r\n        for (var i = 0, cnt = gameObjects.length; i < cnt; i++) {\r\n            gameObject = gameObjects[i];\r\n            gameObject.x += movementX;\r\n            gameObject.y += movementY;\r\n            Object(_utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, centerWorldX, centerWorldY, angle);\r\n        }\r\n    } else {\r\n        gameObject.x += movementX;\r\n        gameObject.y += movementY;\r\n        Object(_utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, x, y, angle);\r\n    }\r\n    return this;\r\n}\r\n\r\nvar tmpPos = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SpinObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/rotate/SpinObject.js?')},"./lib/rexui/plugins/input/gestures/swipe/Swipe.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ "./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ "./lib/rexui/plugins/fsm.js");\n/* harmony import */ var _VelocityMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VelocityMethods.js */ "./lib/rexui/plugins/input/gestures/swipe/VelocityMethods.js");\n/* harmony import */ var _utils_math_angle_angletodirections_Const_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/math/angle/angletodirections/Const.js */ "./lib/rexui/plugins/utils/math/angle/angletodirections/Const.js");\n/* harmony import */ var _utils_math_angle_angletodirections_AngleToDirections_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/math/angle/angletodirections/AngleToDirections.js */ "./lib/rexui/plugins/utils/math/angle/angletodirections/AngleToDirections.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RadToDeg = Phaser.Math.RadToDeg;\r\n\r\nclass Swipe extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.validDrag = false;\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.updateDirectionStates();\r\n                        self.emit(\'swipe\', self, self.gameObject, self.lastPointer);\r\n                    },\r\n\r\n                    exit: function () {\r\n                        self.stop();\r\n                        self.clearDirectionStates();\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__["default"](stateConfig));\r\n        this.clearDirectionStates();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, \'threshold\', 10));\r\n        this.setMinDragVelocity(GetValue(o, \'velocityThreshold\', 1000));\r\n        this.setDirectionMode(GetValue(o, \'dir\', \'8dir\'));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === BEGIN) {\r\n            if (!this.vaildDrag) {\r\n                this.vaildDrag = (this.dragThreshold === 0) || (this.pointer.getDistance() >= this.dragThreshold);\r\n            }\r\n            if (this.vaildDrag && (this.dragVelocity > this.minDragVelocity)) {\r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    postUpdate(time, delta) {\r\n        // Clear RECOGNIZED after update()\r\n        if (this.state === RECOGNIZED) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    get isSwiped() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    get dragVelocity() {\r\n        var velocity;\r\n        switch (this.dirMode) {\r\n            case 0: velocity = this.getVelocityX(); break; // up & down\r\n            case 1: velocity = this.getVelocityY(); break; // left & right\r\n            default: velocity = this.getVelocity(); break; // 4 dir, 8 dir\r\n        }\r\n        return velocity;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setMinDragVelocity(velocity) {\r\n        this.minDragVelocity = velocity;\r\n        return this;\r\n    }\r\n\r\n    setDirectionMode(m) {\r\n        if (typeof (m) === \'string\') {\r\n            m = _utils_math_angle_angletodirections_Const_js__WEBPACK_IMPORTED_MODULE_3__["default"][m];\r\n        }\r\n        this.dirMode = m;\r\n        return this;\r\n    }\r\n\r\n    updateDirectionStates() {\r\n        var angle = RadToDeg(this.getVelocityAngle());\r\n        Object(_utils_math_angle_angletodirections_AngleToDirections_js__WEBPACK_IMPORTED_MODULE_4__["default"])(angle, this.dirMode, this);\r\n        return this;\r\n    }\r\n\r\n    clearDirectionStates() {\r\n        this.left = false;\r\n        this.right = false;\r\n        this.up = false;\r\n        this.down = false;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Swipe.prototype,\r\n    _VelocityMethods_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n);\r\n\r\nconst IDLE = \'IDLE\';\r\nconst BEGIN = \'BEGIN\';\r\nconst RECOGNIZED = \'RECOGNIZED\';\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Swipe);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/swipe/Swipe.js?')},"./lib/rexui/plugins/input/gestures/swipe/VelocityMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\nconst AngleBetween = Phaser.Math.Angle.Between;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getDt: function () {\r\n        var game = this.scene.sys.game;\r\n        var dt = game.loop.delta;\r\n        return dt;\r\n    },\r\n\r\n    getVelocity: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = DistanceBetween(p0.x, p0.y, p1.x, p1.y);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityX: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = Math.abs(p1.x - p0.x);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityY: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = Math.abs(p1.y - p0.y);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityAngle: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var angle = AngleBetween(p0.x, p0.y, p1.x, p1.y);\r\n        return angle;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/swipe/VelocityMethods.js?')},"./lib/rexui/plugins/input/gestures/tap/Tap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\n\r\nclass Tap extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.stop();\r\n                        self.tapsCount = 0;\r\n                        self.x = 0;\r\n                        self.y = 0;\r\n                        self.worldX = 0;\r\n                        self.worldY = 0;\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.x = pointer.x;\r\n                        self.y = pointer.y;\r\n                        self.worldX = pointer.worldX;\r\n                        self.worldY = pointer.worldY;\r\n                    }\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.tapsCount = 0;\r\n                        self.emit('tappingstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.emit('tap', self, self.gameObject, self.lastPointer);\r\n                        self.emit(`${self.tapsCount}tap`, self, self.gameObject, self.lastPointer);\r\n                    },\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setMaxHoldTime(GetValue(o, 'time', 250)); // min-hold-time of Press is 251\r\n        this.setTapInterval(GetValue(o, 'tapInterval', 200));\r\n        this.setDragThreshold(GetValue(o, 'threshold', 9));\r\n        this.setTapOffset(GetValue(o, 'tapOffset', 10));\r\n\r\n        var taps = GetValue(o, 'taps', undefined);\r\n        if (taps !== undefined) {\r\n            this.setTaps(taps);\r\n        } else {\r\n            this.setMaxTaps(GetValue(o, 'maxTaps', undefined));\r\n            this.setMinTaps(GetValue(o, 'minTaps', undefined));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        switch (this.state) {\r\n            case IDLE:\r\n                this.state = BEGIN;\r\n                break;\r\n\r\n            case BEGIN:\r\n                var pointer = this.lastPointer;\r\n                var tapsOffset = DistanceBetween(\r\n                    pointer.upX,\r\n                    pointer.upY,\r\n                    pointer.x,\r\n                    pointer.y);\r\n                if (tapsOffset > this.tapOffset) { // Can't recognize next level, restart here\r\n                    this.state = RECOGNIZED;\r\n                    this.state = BEGIN;\r\n                }\r\n                break;\r\n\r\n            case RECOGNIZED:\r\n                this.state = BEGIN;\r\n                break;\r\n        }\r\n    }\r\n\r\n    onDragEnd() {\r\n        if (this.state === BEGIN) {\r\n            this.tapsCount++; // Try recognize next level\r\n            this.emit('tapping', this, this.gameObject, this.lastPointer);\r\n\r\n            if ((this.maxTaps !== undefined) && (this.tapsCount === this.maxTaps)) { // Reach to maxTaps, stop here                \r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === IDLE) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer.getDistance() > this.dragThreshold) { // Cancel\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    preUpdate(time, delta) {\r\n        if (this.state === BEGIN) {\r\n            var pointer = this.lastPointer;\r\n            if (pointer.isDown) {\r\n                var holdTime = time - pointer.downTime;\r\n                if (holdTime > this.holdTime) {\r\n                    this.state = IDLE;\r\n                }\r\n            } else { // isUp\r\n                var releasedTime = time - pointer.upTime;\r\n                if (releasedTime > this.tapInterval) {\r\n                    if ((this.minTaps === undefined) || (this.tapsCount >= this.minTaps)) {\r\n                        this.state = RECOGNIZED;\r\n                    } else {\r\n                        this.state = IDLE;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    postUpdate(time, delta) {\r\n        // Clear RECOGNIZED after update()\r\n        if (this.state === RECOGNIZED) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    get isTapped() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setMaxHoldTime(time) {\r\n        this.holdTime = time; // ms\r\n        return this;\r\n    }\r\n\r\n    setTapInterval(time) {\r\n        this.tapInterval = time; // ms\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setTapOffset(distance) {\r\n        this.tapOffset = distance;\r\n        return this;\r\n    }\r\n\r\n    setMaxTaps(taps) {\r\n        this.maxTaps = taps;\r\n        return this;\r\n    }\r\n\r\n    setMinTaps(taps) {\r\n        this.minTaps = taps;\r\n        return this;\r\n    }\r\n\r\n    setTaps(minTaps, maxTaps) {\r\n        if (maxTaps === undefined) {\r\n            maxTaps = minTaps;\r\n        }\r\n        this.setMinTaps(minTaps).setMaxTaps(maxTaps);\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Tap);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/tap/Tap.js?")},"./lib/rexui/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/object/Clear.js */ \"./lib/rexui/plugins/utils/object/Clear.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst SpliceOne = Phaser.Utils.Array.SpliceOne;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\nconst AngleBetween = Phaser.Math.Angle.Between;\r\n\r\nclass TwoPointersTracer {\r\n    constructor(scene, config) {\r\n        var amount = scene.input.manager.pointersTotal - 1;\r\n        if (amount < 2) {\r\n            scene.input.addPointer(2 - amount);\r\n        }\r\n\r\n        this.scene = scene;\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n        this.pointers = [];\r\n        this.movedState = {};\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.bounds = GetValue(o, 'bounds', undefined);\r\n\r\n        this.tracerState = TOUCH0;\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scene.input.on('pointerdown', this.onPointerDown, this);\r\n        this.scene.input.on('pointerup', this.onPointerUp, this);\r\n        this.scene.input.on('pointermove', this.onPointerMove, this);\r\n        this.scene.events.once('shutdown', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        if (this.scene) {\r\n            this.scene.input.off('pointerdown', this.onPointerDown, this);\r\n            this.scene.input.off('pointerup', this.onPointerUp, this);\r\n            this.scene.input.off('pointermove', this.onPointerMove, this);\r\n            this.scene.events.off('destroy', this.destroy, this);\r\n            this.scene = undefined;\r\n        }\r\n        this.scene = undefined;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.dragCancel();\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    onPointerDown(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointers.length === 2) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        var index = this.pointers.indexOf(pointer);\r\n        if (index !== -1) { // Already in catched pointers\r\n            return;\r\n        }\r\n\r\n        this.movedState[pointer.id] = false;\r\n        this.pointers.push(pointer);\r\n\r\n        switch (this.tracerState) {\r\n            case TOUCH0:\r\n                this.tracerState = TOUCH1;\r\n                this.onDrag1Start();\r\n                break;\r\n            case TOUCH1:\r\n                this.tracerState = TOUCH2;\r\n                this.onDrag2Start();\r\n                break;\r\n        }\r\n    }\r\n\r\n    onPointerUp(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        var index = this.pointers.indexOf(pointer);\r\n        if (index === -1) { // Not in catched pointers\r\n            return;\r\n        } else {\r\n            delete this.movedState[pointer.id];\r\n            SpliceOne(this.pointers, index);\r\n        }\r\n\r\n        switch (this.tracerState) {\r\n            case TOUCH1:\r\n                this.tracerState = TOUCH0;\r\n                this.onDrag1End();\r\n                break;\r\n            case TOUCH2:\r\n                this.tracerState = TOUCH1;\r\n                this.onDrag2End();\r\n                this.onDrag1Start();\r\n                break;\r\n        }\r\n    }\r\n\r\n    onPointerMove(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.isDown) {\r\n            var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            var isCatchedPointer = (this.pointers.indexOf(pointer) !== -1);\r\n            if (!isCatchedPointer && isInsideBounds) { // Pointer moves into bounds\r\n                // this.onPointerDown(pointer);\r\n            } else if (isCatchedPointer && !isInsideBounds) { // Pointer moves out of bounds, lose pointer\r\n                this.onPointerUp(pointer);\r\n            } else {  // Pointer drags in bounds\r\n                if (!this.movedState[pointer.id]) {\r\n                    this.movedState[pointer.id] = (pointer.x !== pointer.downX) || (pointer.y !== pointer.downY);\r\n                }\r\n                if (this.movedState[pointer.id]) {\r\n                    switch (this.tracerState) {\r\n                        case TOUCH1:\r\n                            this.onDrag1();\r\n                            break;\r\n                        case TOUCH2:\r\n                            this.onDrag2();\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    dragCancel() {\r\n        if (this.tracerState === TOUCH2) {\r\n            this.onDrag2End();\r\n        }\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        this.tracerState = TOUCH0;\r\n        return this;\r\n    }\r\n\r\n    onDrag1Start() {\r\n        this.emit('drag1start', this);\r\n    }\r\n\r\n    onDrag1End() {\r\n        this.emit('drag1end', this);\r\n    }\r\n\r\n    onDrag1() {\r\n        this.emit('drag1', this);\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.emit('drag2start', this);\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.emit('drag2end', this);\r\n    }\r\n\r\n    onDrag2() {\r\n        this.emit('drag2', this);\r\n    }\r\n\r\n    get distanceBetween() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0],\r\n            p1 = this.pointers[1];\r\n        return DistanceBetween(p0.x, p0.y, p1.x, p1.y);\r\n    }\r\n\r\n    get angleBetween() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0],\r\n            p1 = this.pointers[1];\r\n        return AngleBetween(p0.x, p0.y, p1.x, p1.y);\r\n    }\r\n\r\n    get drag1Vector() {\r\n        var pointer = this.pointers[0];\r\n        if (pointer && this.movedState[pointer.id]) {\r\n            var p1 = pointer.position;\r\n            var p0 = pointer.prevPosition;\r\n            tmpDragVector.x = p1.x - p0.x;\r\n            tmpDragVector.y = p1.y - p0.y;\r\n        } else {\r\n            tmpDragVector.x = 0;\r\n            tmpDragVector.y = 0;\r\n        }\r\n        return tmpDragVector;\r\n    }\r\n\r\n    get centerX() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0].position;\r\n        var p1 = this.pointers[1].position;\r\n        return (p0.x + p1.x) / 2;\r\n    }\r\n\r\n    get centerY() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0].position;\r\n        var p1 = this.pointers[1].position;\r\n        return (p0.y + p1.y) / 2;\r\n    }\r\n\r\n    get prevCenterX() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var preP0 = (this.movedState[this.pointers[0].id]) ? this.pointers[0].prevPosition : this.pointers[0].position;\r\n        var preP1 = (this.movedState[this.pointers[1].id]) ? this.pointers[1].prevPosition : this.pointers[1].position;\r\n        return (preP0.x + preP1.x) / 2;\r\n    }\r\n\r\n    get prevCenterY() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var preP0 = (this.movedState[this.pointers[0].id]) ? this.pointers[0].prevPosition : this.pointers[0].position;\r\n        var preP1 = (this.movedState[this.pointers[1].id]) ? this.pointers[1].prevPosition : this.pointers[1].position;\r\n        return (preP0.y + preP1.y) / 2;\r\n    }\r\n\r\n    get movementCenterX() {\r\n        return this.centerX - this.prevCenterX;\r\n    }\r\n\r\n    get movementCenterY() {\r\n        return this.centerY - this.prevCenterY;\r\n    }\r\n\r\n    setRecongizedStateObject(stateObject) {\r\n        this.recongizedState = stateObject;\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this.recongizedState.state;\r\n    }\r\n\r\n    set state(newState) {\r\n        this.recongizedState.state = newState;\r\n    }\r\n\r\n    cancel() {\r\n        this.state = IDLE;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    TwoPointersTracer.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nvar tmpDragVector = {};\r\n\r\nconst TOUCH0 = 0;\r\nconst TOUCH1 = 1;\r\nconst TOUCH2 = 2;\r\n\r\nconst IDLE = 'IDLE';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TwoPointersTracer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js?")},"./lib/rexui/plugins/input/scroller/Scroller.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _State_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./State.js */ \"./lib/rexui/plugins/input/scroller/State.js\");\n/* harmony import */ var _dragspeed_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../dragspeed.js */ \"./lib/rexui/plugins/dragspeed.js\");\n/* harmony import */ var _utils_movement_SlowDown_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/movement/SlowDown.js */ \"./lib/rexui/plugins/utils/movement/SlowDown.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Scroller {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        var enable = GetValue(config, 'enable', true);\r\n        var stateConfig = {\r\n            enable: enable,\r\n            eventEmitter: false,\r\n        }\r\n        this._state = new _State_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this, stateConfig);\r\n\r\n        var drapSpeedConfig = {\r\n            inputConfig: GetValue(config, 'inputConfig', undefined),\r\n            enable: enable,\r\n            eventEmitter: false,\r\n        };\r\n        this.dragState = new _dragspeed_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](gameObject, drapSpeedConfig);\r\n\r\n        this._value = undefined;\r\n        this._slowDown = new _utils_movement_SlowDown_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\r\n\r\n        var callback = GetValue(config, 'valuechangeCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'valuechangeCallbackScope', undefined);\r\n            this.on('valuechange', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'overmaxCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'overmaxCallbackScope', undefined);\r\n            this.on('overmax', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'overminCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'overminCallbackScope', undefined);\r\n            this.on('overmin', callback, scope);\r\n        }\r\n\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setOrientationMode(GetValue(o, 'orientation', 0));\r\n        this.setDragThreshold(GetValue(o, 'threshold', 10));\r\n        this.setSlidingDeceleration(GetValue(o, 'slidingDeceleration', 5000));\r\n        this.setBackDeceleration(GetValue(o, 'backDeceleration', 2000));\r\n\r\n        var bounds = GetValue(o, 'bounds', undefined);\r\n        if (bounds) {\r\n            this.setBounds(bounds);\r\n        } else {\r\n            this.setBounds(GetValue(o, 'max', 0), GetValue(o, 'min', 0));\r\n        }\r\n        this.setValue(GetValue(o, 'value', this.maxValue || 0));\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scene.events.on('update', this._state.update, this._state);\r\n        this.gameObject.once('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('update', this._state.update, this._state);\r\n        }\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        this._state.destroy();\r\n        this.dragState.destroy();\r\n        // gameObject events will be removed when this gameObject destroyed \r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setOrientationMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = ORIENTATIONMODE[m];\r\n        }\r\n        this.orientationMode = m;\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setSlidingDeceleration(dec) {\r\n        this.slidingDeceleration = dec;\r\n        return this;\r\n    }\r\n\r\n    setBackDeceleration(dec) {\r\n        this.backDeceleration = dec;\r\n        return this;\r\n    }\r\n\r\n    setBounds(value0, value1) {\r\n        if (Array.isArray(value0)) {\r\n            var bounds = value0;\r\n            value0 = bounds[0];\r\n            value1 = bounds[1];\r\n        }\r\n        if (value0 < value1) {\r\n            this.minValue = value0;\r\n            this.maxValue = value1;\r\n        } else {\r\n            this.minValue = value1;\r\n            this.maxValue = value0;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get value() {\r\n        return this._value;\r\n    }\r\n\r\n    set value(value) {\r\n        if (value === this._value) {\r\n            return;\r\n        }\r\n\r\n        var oldValue = this._value;\r\n        var isOverMax = this.overMax(value);\r\n        var isOverMin = this.overMin(value);\r\n        if (isOverMax) {\r\n            this.emit('overmax', value, oldValue);\r\n        }\r\n        if (isOverMin) {\r\n            this.emit('overmin', value, oldValue);\r\n        }\r\n        if (!this.backEnable) {\r\n            if (isOverMax) {\r\n                value = this.maxValue;\r\n            }\r\n            if (isOverMin) {\r\n                value = this.minValue;\r\n            }\r\n        }\r\n\r\n        this._value = value;\r\n        this.emit('valuechange', value, oldValue);\r\n    }\r\n\r\n    setValue(value) {\r\n        this.value = value;\r\n    }\r\n\r\n    setEnable(e) {\r\n        this._state.setEnable(e);\r\n        this.dragState.setEnable(e);\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this._state.state;\r\n    }\r\n\r\n    get isDragging() {\r\n        return this.dragState.isInTouched;\r\n    }\r\n\r\n    get outOfMaxBound() {\r\n        return this.overMax(this.value);\r\n    }\r\n\r\n    get outOfMinBound() {\r\n        return this.overMin(this.value);\r\n    }\r\n\r\n    get outOfBounds() {\r\n        return this.outOfMinBound || this.outOfMaxBound;\r\n    }\r\n\r\n    // internal\r\n    overMax(value) {\r\n        return (this.maxValue != null) && (value > this.maxValue);\r\n    }\r\n\r\n    overMin(value) {\r\n        return (this.minValue != null) && (value < this.minValue);\r\n    }\r\n\r\n    get backEnable() {\r\n        return (typeof (this.backDeceleration) === 'number');\r\n    }\r\n\r\n    get isPullBack() {\r\n        return this._slowDown.isMoving;\r\n    }\r\n\r\n    get slidingEnable() {\r\n        return (typeof (this.slidingDeceleration) === 'number');\r\n    }\r\n\r\n    get isSliding() {\r\n        return this._slowDown.isMoving;\r\n    }\r\n\r\n    get dragDelta() {\r\n        if (this.orientationMode === 0) { // y\r\n            return this.dragState.dy;\r\n        } else if (this.orientationMode === 1) { // x\r\n            return this.dragState.dx;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    get dragSpeed() {\r\n        if (this.orientationMode === 0) { // y\r\n            return this.dragState.speedY;\r\n        } else if (this.orientationMode === 1) { // x\r\n            return this.dragState.speedX;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    // everyTick_DRAG\r\n    dragging() {\r\n        this.value += this.dragDelta;\r\n    }\r\n\r\n    // enter_SLIDE \r\n    onSliding() {\r\n        var start = this.value;\r\n        var speed = this.dragSpeed;\r\n        if (speed === 0) {\r\n            this._slowDown.stop();\r\n            this._state.next();\r\n            return;\r\n        }\r\n        var dec = this.slidingDeceleration;\r\n        this._slowDown.init(start, (speed > 0), Math.abs(speed), dec)\r\n    }\r\n\r\n    // everyTick_SLIDE\r\n    sliding(time, delta) {\r\n        delta *= 0.001;\r\n        var newValue = this._slowDown.update(delta).value;\r\n        if (this.overMax(newValue)) {\r\n            this.value = this.maxValue;\r\n            this._slowDown.stop();\r\n        } else if (this.overMin(newValue)) {\r\n            this.value = this.minValue;\r\n            this._slowDown.stop();\r\n        } else {\r\n            this.value = newValue;\r\n        }\r\n    }\r\n\r\n    // enter_BACK\r\n    onPullBack() {\r\n        var start = this.value;\r\n        var end = (this.outOfMinBound) ? this.minValue : this.maxValue;\r\n        var dist = Math.abs(end - start);\r\n        var dec = this.backDeceleration;\r\n        var speed = Math.sqrt(2 * dec * dist);\r\n        this._slowDown.init(start, undefined, speed, dec, end);\r\n    }\r\n\r\n    // everyTick_BACK\r\n    pullBack(time, delta) {\r\n        delta *= 0.001;\r\n        this.value = this._slowDown.update(delta).value;\r\n\r\n        if (!this._slowDown.isMoving) {\r\n            this._state.next();\r\n        }\r\n    }\r\n\r\n    // exit_SLIDE, exit_BACK\r\n    stop() {\r\n        this._slowDown.stop();\r\n    }\r\n\r\n}\r\n\r\nObject.assign(\r\n    Scroller.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/** @private */\r\nconst ORIENTATIONMODE = {\r\n    y: 0,\r\n    v: 0,\r\n    vertical: 0,\r\n    x: 1,\r\n    h: 1,\r\n    horizontal: 1,\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scroller);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/scroller/Scroller.js?")},"./lib/rexui/plugins/input/scroller/State.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../fsm.js */ \"./lib/rexui/plugins/fsm.js\");\n\r\n\r\nclass State extends _fsm_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(parent, config) {\r\n        super(config);\r\n        this.parent = parent;\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.start('IDLE');\r\n    }\r\n\r\n    // IDLE -> DRAGBEGIN|DRAG\r\n    next_IDLE() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = (parent.dragThreshold === 0) ? 'DRAG' : 'DRAGBEGIN';\r\n        }\r\n        return nextState;\r\n    }\r\n    update_IDLE(time, delta) {\r\n        this.next();\r\n    }\r\n    // IDLE\r\n\r\n    // DRAGBEGIN -> DRAG|IDLE\r\n    next_DRAGBEGIN() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = (dragState.pointer.getDistance() >= parent.dragThreshold) ? 'DRAG' : 'DRAGBEGIN';\r\n        } else { // dragState.isUp\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    update_DRAGBEGIN(time, delta) {\r\n        this.next();\r\n    }\r\n    // DRAGBEGIN\r\n\r\n    // DRAG -> BACK|SLIDE|IDLE\r\n    next_DRAG() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isUp) {\r\n            if (parent.outOfBounds) {\r\n                nextState = 'BACK';\r\n            } else if (parent.slidingEnable) {\r\n                nextState = 'SLIDE';\r\n            } else {\r\n                nextState = 'IDLE';\r\n            }\r\n        }\r\n        return nextState;\r\n    }\r\n    update_DRAG(time, delta) {\r\n        var parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.justMoved) {\r\n            parent.dragging();\r\n        }\r\n        this.next();\r\n    }\r\n    // DRAG    \r\n\r\n    // SLIDE -> DRAG|IDLE\r\n    next_SLIDE() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = 'DRAG';\r\n        } else if (!parent.isSliding) {\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    enter_SLIDE() {\r\n        this.parent.onSliding();\r\n    }\r\n    exit_SLIDE() {\r\n        this.parent.stop();\r\n    }\r\n    update_SLIDE(time, delta) {\r\n        this.parent.sliding(time, delta);\r\n        this.next();\r\n    }\r\n    // SLIDE    \r\n\r\n    // BACK -> DRAG|IDLE\r\n    next_BACK() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = 'DRAG';\r\n        } else if (!parent.isPullBack) {\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    enter_BACK() {\r\n        this.parent.onPullBack();\r\n    }\r\n    exit_BACK() {\r\n        this.parent.stop();\r\n    }\r\n    update_BACK(time, delta) {\r\n        this.parent.pullBack(time, delta);\r\n        this.next();\r\n    }\r\n    // BACK\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (State);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/input/scroller/State.js?")},"./lib/rexui/plugins/inputtext-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_inputtext_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/inputtext/Factory.js */ "./lib/rexui/plugins/gameobjects/inputtext/Factory.js");\n/* harmony import */ var _gameobjects_inputtext_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/inputtext/Creator.js */ "./lib/rexui/plugins/gameobjects/inputtext/Creator.js");\n/* harmony import */ var _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/inputtext/InputText.js */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass InputTextPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexInputText\', _gameobjects_inputtext_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_inputtext_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.once(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.InputText\', _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (InputTextPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/inputtext-plugin.js?')},"./lib/rexui/plugins/logic/fsm/FSM.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/object/GetValue.js */ \"./lib/rexui/plugins/utils/object/GetValue.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\n\r\nclass FSM {\r\n    /*\r\n    var config = {\r\n        start: 'A',   // default: undefined\r\n        states: {\r\n            A: {\r\n                next: 'B',  // function() { return 'B'; }\r\n                enter: function() {},\r\n                exit: function() {}\r\n            },\r\n            // ...\r\n        },        \r\n        extend: {\r\n            i: 0,\r\n            name: 'abc'\r\n            // ...\r\n        },\r\n        init: function() {},\r\n        enable: true,\r\n        eventEmitter: true,\r\n    };\r\n    */\r\n    constructor(config) {\r\n        // Attach get-next-state function\r\n        var states = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'states', undefined);\r\n        if (states) {\r\n            this.addStates(states);\r\n        }\r\n\r\n        // Attach extend members\r\n        var extend = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'extend', undefined);\r\n        if (extend) {\r\n            for (var name in extend) {\r\n                if (!this.hasOwnProperty(name) || this[name] === undefined) {\r\n                    this[name] = extend[name];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Event emitter\r\n        var eventEmitter = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'eventEmitter', undefined);\r\n        var EventEmitterClass = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'EventEmitterClass', undefined);\r\n        this.setEventEmitter(eventEmitter, EventEmitterClass);\r\n\r\n        this._stateLock = false;\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'enable', true));\r\n        this.start(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'start', undefined));\r\n        var init = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'init', undefined);\r\n        if (init) {\r\n            init.call(this);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            curState: this.state,\r\n            prevState: this.prevState,\r\n\r\n            enable: this.enable,\r\n            start: this._start\r\n        };\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    set state(newState) {\r\n        if (!this.enable || this._stateLock) {\r\n            return;\r\n        }\r\n        if (this._state === newState) {\r\n            return;\r\n        }\r\n        this._prevState = this._state;\r\n        this._state = newState;\r\n\r\n        this._stateLock = true; // lock state\r\n\r\n        this.emit('statechange', this);\r\n\r\n        if (this._prevState != null) {\r\n            var exitEventName = 'exit_' + this._prevState;\r\n            var exitCallback = this[exitEventName];\r\n            if (exitCallback) {\r\n                exitCallback.call(this);\r\n            }\r\n            this.emit(exitEventName, this);\r\n        }\r\n\r\n        this._stateLock = false;\r\n\r\n        if (this._state != null) {\r\n            var enterEventName = 'enter_' + this._state;\r\n            var enterCallback = this[enterEventName];\r\n            if (enterCallback) {\r\n                enterCallback.call(this);\r\n            }\r\n            this.emit(enterEventName, this);\r\n        }\r\n    }\r\n\r\n    get state() {\r\n        return this._state;\r\n    }\r\n\r\n    get prevState() {\r\n        return this._prevState;\r\n    }\r\n\r\n    start(state) {\r\n        this._start = state;\r\n        this._prevState = undefined;\r\n        this._state = state; // Won't fire statechange events\r\n        return this;\r\n    }\r\n\r\n    goto(nextState) {\r\n        if (nextState != null) {\r\n            this.state = nextState;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    next() {\r\n        var nextState;\r\n        var getNextState = this['next_' + this.state];\r\n        if (getNextState) {\r\n            if (typeof (getNextState) === 'string') {\r\n                nextState = getNextState;\r\n            } else {\r\n                nextState = getNextState.call(this);\r\n            }\r\n        }\r\n\r\n        this.goto(nextState);\r\n        return this;\r\n    }\r\n\r\n    addState(name, config) {\r\n        var getNextStateCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'next', undefined);\r\n        if (getNextStateCallback) {\r\n            this['next_' + name] = getNextStateCallback;\r\n        }\r\n\r\n        var exitCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'exit', undefined);\r\n        if (exitCallback) {\r\n            this['exit_' + name] = exitCallback;\r\n        }\r\n\r\n        var enterCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'enter', undefined);\r\n        if (enterCallback) {\r\n            this['enter_' + name] = enterCallback;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addStates(states) {\r\n        for (var name in states) {\r\n            this.addState(name, states[name]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    update(time, delta, key) {\r\n        if (key === undefined) {\r\n            key = 'update';\r\n        }\r\n        var fn = this[key + '_' + this.state];\r\n        if (fn) {\r\n            fn.call(this, time, delta);\r\n        }\r\n    }\r\n\r\n    preupdate(time, delta) {\r\n        this.update(time, delta, 'preupdate');\r\n    }\r\n\r\n    postupdate(time, delta) {\r\n        this.update(time, delta, 'postupdate');\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    FSM.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (FSM);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/logic/fsm/FSM.js?")},"./lib/rexui/plugins/logic/runcommands/RunCommands.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_array_Copy_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/array/Copy.js */ "./lib/rexui/plugins/utils/array/Copy.js");\n/* harmony import */ var _utils_string_TypeConvert_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/string/TypeConvert.js */ "./lib/rexui/plugins/utils/string/TypeConvert.js");\n/* harmony import */ var _utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/object/IsArray.js */ "./lib/rexui/plugins/utils/object/IsArray.js");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar runCommands = function (queue, scope, config) {\r\n    var reverse = GetValue(config, \'reverse\', false);\r\n\r\n    var retVal;\r\n    if (Object(_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_2__["default"])(queue[0])) {\r\n        if (!reverse) {\r\n            for (var i = 0, len = queue.length; i < len; i++) {\r\n                retVal = runCommands(queue[i], scope, config);\r\n            }\r\n        } else {\r\n            for (var len = queue.length, i = len - 1; i >= 0; i--) {\r\n                retVal = runCommands(queue[i], scope, config);\r\n            }\r\n        }\r\n    } else {\r\n        retVal = runCommand(queue, scope, config);\r\n    }\r\n\r\n    return retVal;\r\n}\r\n\r\nvar runCommand = function (cmd, scope, config) {\r\n    var argsConvert = GetValue(config, \'argsConvert\', undefined);\r\n    var argsConvertScope = GetValue(config, \'argsConvertScope\', undefined);\r\n\r\n    var fnName = cmd[0];\r\n\r\n    ARGS = Object(_utils_array_Copy_js__WEBPACK_IMPORTED_MODULE_0__["default"])(ARGS, cmd, 1);\r\n    if (argsConvert) {\r\n        // convert string to floating number, boolean, null, or string        \r\n        if (argsConvert === true) {\r\n            argsConvert = _utils_string_TypeConvert_js__WEBPACK_IMPORTED_MODULE_1__["default"];\r\n            argsConvertScope = undefined;\r\n        }\r\n        for (var i = 0, len = ARGS.length; i < len; i++) {\r\n            if (argsConvertScope) {\r\n                ARGS[i] = argsConvert.call(argsConvertScope, ARGS[i], cmd);\r\n            } else {\r\n                ARGS[i] = argsConvert(ARGS[i], cmd);\r\n            }\r\n        }\r\n    }\r\n\r\n    var fn;\r\n    if (typeof (fnName) === \'string\') {\r\n        fn = scope[fnName];\r\n        if (fn == null) {\r\n            fn = GetValue(scope, fnName, null);\r\n        }\r\n    } else {\r\n        fn = fnName;\r\n    }\r\n\r\n    var retValue = fn.apply(scope, ARGS);\r\n    return retValue;\r\n}\r\nvar ARGS = []; // reuse this array\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (runCommands);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/logic/runcommands/RunCommands.js?')},"./lib/rexui/plugins/logic/runcommands/tcrp/Player.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/ticktask/TickTask.js */ \"./lib/rexui/plugins/utils/ticktask/TickTask.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/system/GetSceneObject.js */ \"./lib/rexui/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/object/GetValue.js */ \"./lib/rexui/plugins/utils/object/GetValue.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_array_Copy_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/array/Copy.js */ \"./lib/rexui/plugins/utils/array/Copy.js\");\n/* harmony import */ var _runcommands_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../runcommands.js */ \"./lib/rexui/plugins/runcommands.js\");\n/* harmony import */ var _utils_system_GetEventEmitter_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/system/GetEventEmitter.js */ \"./lib/rexui/plugins/utils/system/GetEventEmitter.js\");\n/* harmony import */ var _utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/object/IsArray.js */ \"./lib/rexui/plugins/utils/object/IsArray.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Player extends _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(parent, config) {\r\n        super(parent, config);\r\n\r\n        this.parent = parent;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(parent);\r\n        this.resetFromJSON(config); // this function had been called in super(config)\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.isRunning = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'isRunning', false);\r\n        this.state = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'state', 0); // 0=idle, 1=run, 2=completed\r\n        this.commands = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'commands', []); // [[dt, cmds], [dt, cmds], ...]\r\n        this.scope = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'scope', undefined);\r\n        this.setTimeUnit(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'timeUnit', 0));\r\n        this.setDtMode(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'dtMode', 0));\r\n        this.setTimeScale(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'timeScale', 1));\r\n        this.index = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'index', 0);\r\n        this.nextDt = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'nextDt', 0);\r\n        this.seek(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'now', 0));\r\n        this.timeScale = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(o, 'timeScale', 1);\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            isRunning: this.isRunning,\r\n            state: this.state,\r\n            commands: this.commands,\r\n            scope: this.scope,\r\n            timeUnit: this.timeUnit,\r\n            dtMode: this.dtMode,\r\n            index: this.index,\r\n            nextDt: this.nextDt,\r\n            now: this.now,\r\n            timeScale: this.timeScale,\r\n            tickingMode: this.tickingMode\r\n        };\r\n    }\r\n\r\n    boot() {\r\n        super.boot();\r\n\r\n        var parentEE = Object(_utils_system_GetEventEmitter_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this.parent);\r\n        if (parentEE) {\r\n            parentEE.once('destroy', this.destroy, this);\r\n        }\r\n    }\r\n\r\n    shutdown() {\r\n        super.shutdown();\r\n\r\n        this.parent = undefined;\r\n        this.scene = undefined;\r\n        this.commands = undefined;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    startTicking() {\r\n        super.startTicking();\r\n        this.scene.events.on('update', this.update, this);\r\n    }\r\n\r\n    stopTicking() {\r\n        super.stopTicking();\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('update', this.update, this);\r\n        }\r\n    }\r\n\r\n    load(commands, scope, config) {\r\n        this.stop();\r\n        var timeUnit = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(config, 'timeUnit', undefined);\r\n        if (timeUnit !== undefined) {\r\n            this.setTimeUnit(timeUnit)\r\n        }\r\n        var dtMode = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_2___default()(config, 'dtMode', undefined);\r\n        if (dtMode !== undefined) {\r\n            this.setDtMode(dtMode);\r\n        }\r\n        commands = commands\r\n            .filter(function (item) {\r\n                var dt = item[0];\r\n                return !isNaN(dt);\r\n            })\r\n            .map(function (item) {\r\n                var dt = item[0];\r\n                if (typeof (dt) === 'string') {\r\n                    item[0] = parseFloat(item[0]);\r\n                }\r\n                return item;\r\n            });\r\n\r\n        if (this.dtMode === 0) {\r\n            commands.sort(function (itemA, itemB) {\r\n                var dtA = itemA[0],\r\n                    dtB = itemB[0];\r\n                return (dtA > dtB) ? 1 :\r\n                    (dtA < dtB) ? -1 : 0;\r\n            });\r\n        }\r\n\r\n        this.commands = commands;\r\n        this.scope = scope;\r\n        return this;\r\n    }\r\n\r\n    start(startAt) {\r\n        if (startAt === undefined) {\r\n            startAt = 0;\r\n        }\r\n\r\n        this.stop();\r\n        this.index = 0;\r\n        this.isRunning = true;\r\n        this.state = 1;\r\n        this.nextDt = this.getNextDt(0);\r\n        this.seek(startAt);\r\n        this.update();\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        this.isRunning = false;\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        this.isRunning = true;\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.isRunning = false;\r\n        this.state = 0;\r\n        return this;\r\n    }\r\n\r\n    seek(time) {\r\n        this.now = time;\r\n        return this;\r\n    }\r\n\r\n    get isPlaying() {\r\n        return this.isRunning;\r\n    }\r\n\r\n    get completed() {\r\n        return (this.state === 2);\r\n    }\r\n\r\n    setTimeScale(value) {\r\n        this.timeScale = value;\r\n    }\r\n\r\n    update(time, delta) {\r\n        if (!this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        if (time !== undefined) {\r\n            if ((this.timeScale === 0) || (delta === 0)) {\r\n                return this;\r\n            }\r\n\r\n            this.now += (delta * this.timeScale);\r\n        }\r\n\r\n        if (this.nextDt > this.now) {\r\n            return this;\r\n        }\r\n        while (1) {\r\n            // run a row\r\n            var item = this.commands[this.index];\r\n            var command = item[1];\r\n            if (!Object(_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(command)) { // [dt, fnName, param0, param1, ...]\r\n                command = Object(_utils_array_Copy_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(CMD, item, 1);\r\n            }\r\n            Object(_runcommands_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(command, this.scope);\r\n            this.emit('runcommand', command, this.scope);\r\n            // run a row\r\n\r\n            if (this.index === (this.commands.length - 1)) {\r\n                this.complete();\r\n                return this;\r\n            } else {\r\n                // next dt\r\n                this.index++; // point to next item\r\n                this.nextDt = this.getNextDt(this.nextDt);\r\n                if (this.nextDt > this.now) {\r\n                    return this;\r\n                }\r\n                // next dt\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    complete() {\r\n        super.complete();\r\n        this.state = 2;\r\n    }\r\n\r\n    getNextDt(currentDt) {\r\n        var dt = this.commands[this.index][0];\r\n        if (this.timeUnit === 1) { // sec mode\r\n            dt = dt * 1000;\r\n        }\r\n\r\n        if (this.dtMode === 1) {\r\n            dt += currentDt;\r\n        }\r\n\r\n        return dt;\r\n    }\r\n\r\n    setDtMode(dtMode) {\r\n        if (typeof (dtMode) === 'string') {\r\n            dtMode = DTMODE[dtMode];\r\n        }\r\n        this.dtMode = dtMode;\r\n        return this;\r\n    }\r\n\r\n    setTimeUnit(timeUnit) {\r\n        if (typeof (timeUnit) === 'string') {\r\n            timeUnit = TIMEUNITMODE[timeUnit];\r\n        }\r\n        this.timeUnit = timeUnit;\r\n        return this;\r\n    }\r\n}\r\n\r\nvar CMD = []; // reuse this array\r\n\r\nconst TIMEUNITMODE = {\r\n    ms: 0,\r\n    s: 1,\r\n    sec: 1\r\n};\r\n\r\nconst DTMODE = {\r\n    abs: 0,\r\n    absolute: 0,\r\n    inc: 1,\r\n    increment: 1\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Player);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/logic/runcommands/tcrp/Player.js?")},"./lib/rexui/plugins/ninepatch-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/ninepatch/Factory.js */ "./lib/rexui/plugins/gameobjects/ninepatch/Factory.js");\n/* harmony import */ var _gameobjects_ninepatch_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/ninepatch/Creator.js */ "./lib/rexui/plugins/gameobjects/ninepatch/Creator.js");\n/* harmony import */ var _gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/ninepatch/NinePatch.js */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n/* harmony import */ var _utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass NinePatchPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexNinePatch\', _gameobjects_ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_ninepatch_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.once(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.NinePatch\', _gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (NinePatchPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/ninepatch-plugin.js?')},"./lib/rexui/plugins/pool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_object_Stack_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/object/Stack.js */ "./lib/rexui/plugins/utils/object/Stack.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_utils_object_Stack_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/pool.js?')},"./lib/rexui/plugins/popup.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scale.js */ \"./lib/rexui/plugins/scale.js\");\n\r\n\r\nvar PopUp = function (gameObject, duration, orientation, ease, scale) {\r\n    defaultConfig.mode = 0;\r\n    switch (orientation) {\r\n        case 'x':\r\n            defaultConfig.start = {\r\n                x: 0\r\n            };\r\n            break;\r\n        case 'y':\r\n            defaultConfig.start = {\r\n                y: 0\r\n            };\r\n            break;\r\n        default:\r\n            defaultConfig.start = 0;\r\n            break;\r\n    }\r\n    defaultConfig.end = 1;\r\n    defaultConfig.duration = duration;\r\n    defaultConfig.ease = (ease === undefined) ? 'Cubic' : ease;\r\n\r\n    if (scale === undefined) {\r\n        scale = new _scale_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](gameObject, defaultConfig);\r\n    } else {\r\n        scale.resetFromJSON(defaultConfig);\r\n    }\r\n    scale.restart();\r\n\r\n    return scale;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (PopUp);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/popup.js?")},"./lib/rexui/plugins/runcommands.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _logic_runcommands_RunCommands_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logic/runcommands/RunCommands.js */ "./lib/rexui/plugins/logic/runcommands/RunCommands.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_logic_runcommands_RunCommands_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/runcommands.js?')},"./lib/rexui/plugins/scale-down-destroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scale.js */ "./lib/rexui/plugins/scale.js");\n\r\n\r\nvar ScaleDownDestroy = function (gameObject, duration, orientation, ease, destroyMode, scale) {\r\n    if (destroyMode instanceof _scale_js__WEBPACK_IMPORTED_MODULE_0__["default"]) {\r\n        scale = destroyMode;\r\n        destroyMode = undefined;\r\n    }\r\n\r\n    if (destroyMode === undefined) {\r\n        destroyMode = true;\r\n    }\r\n\r\n    defaultConfig.mode = (destroyMode) ? 1 : 0;\r\n    switch (orientation) {\r\n        case \'x\':\r\n            defaultConfig.end = {\r\n                x: 0\r\n            };\r\n            break;\r\n        case \'y\':\r\n            defaultConfig.end = {\r\n                y: 0\r\n            };\r\n            break;\r\n        default:\r\n            defaultConfig.end = 0;\r\n            break;\r\n    }\r\n    defaultConfig.duration = duration;\r\n    defaultConfig.ease = (ease === undefined) ? \'Linear\' : ease;\r\n\r\n    if (scale === undefined) {\r\n        scale = new _scale_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        scale.resetFromJSON(defaultConfig);\r\n    }\r\n    scale.restart();\r\n\r\n    return scale;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ScaleDownDestroy);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/scale-down-destroy.js?')},"./lib/rexui/plugins/scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_scale_Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/scale/Scale.js */ "./lib/rexui/plugins/behaviors/scale/Scale.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_scale_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/scale.js?')},"./lib/rexui/plugins/scroller.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/scroller/Scroller.js */ "./lib/rexui/plugins/input/scroller/Scroller.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/scroller.js?')},"./lib/rexui/plugins/textpage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_textpage_TextPage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/textpage/TextPage.js */ "./lib/rexui/plugins/behaviors/textpage/TextPage.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_textpage_TextPage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/textpage.js?')},"./lib/rexui/plugins/texttyping.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_texttyping_TextTyping_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/texttyping/TextTyping.js */ "./lib/rexui/plugins/behaviors/texttyping/TextTyping.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_texttyping_TextTyping_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/texttyping.js?')},"./lib/rexui/plugins/utils/actions/GlobZone.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\nvar globZone = new Phaser.GameObjects.Zone({\r\n    sys: {\r\n        queueDepthSort: _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n        events: {\r\n            once: _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n        }\r\n    }\r\n}, 0, 0, 1, 1);\r\nglobZone.setOrigin(0);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (globZone);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/actions/GlobZone.js?')},"./lib/rexui/plugins/utils/actions/RotateObjectAround.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst RotateAround = Phaser.Math.RotateAround;\r\n\r\nvar RotateObjectAround = function (gameObject, x, y, angle) {\r\n    RotateAround(gameObject, x, y, angle);\r\n    gameObject.rotation += angle;\r\n    return gameObject;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RotateObjectAround);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/actions/RotateObjectAround.js?')},"./lib/rexui/plugins/utils/array/Copy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Copy = function (dest, src, startIdx, endIdx) {\r\n    if (startIdx === undefined) {\r\n        startIdx = 0\r\n    };\r\n    if (endIdx === undefined) {\r\n        endIdx = src.length;\r\n    }\r\n    dest.length = endIdx - startIdx;\r\n    for (var i = 0, len = dest.length; i < len; i++) {\r\n        dest[i] = src[i + startIdx];\r\n    }\r\n    return dest;\r\n};\r\n/* harmony default export */ __webpack_exports__["default"] = (Copy);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/array/Copy.js?')},"./lib/rexui/plugins/utils/data/DataMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../object/GetValue.js */ "./lib/rexui/plugins/utils/object/GetValue.js");\n/* harmony import */ var _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_object_GetValue_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _object_Clear_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../object/Clear.js */ "./lib/rexui/plugins/utils/object/Clear.js");\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    enableData() {\r\n        if (this.data === undefined) {\r\n            this.data = {};\r\n        }\r\n        return this;\r\n    },\r\n\r\n    getData(key, defaultValue) {\r\n        this.enableData();\r\n        return (key === undefined) ? this.data : _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0___default()(this.data, key, defaultValue);\r\n    },\r\n\r\n    setData(key, value) {\r\n        this.enableData();\r\n        this.data[key] = value;\r\n        return this;\r\n    },\r\n\r\n    incData(key, inc, defaultValue) {\r\n        if (defaultValue === undefined) {\r\n            defaultValue = 0;\r\n        }\r\n        this.enableData();\r\n        this.setData(key, this.getData(key, defaultValue) + inc);\r\n        return this;\r\n    },\r\n\r\n    mulData(key, mul, defaultValue) {\r\n        if (defaultValue === undefined) {\r\n            defaultValue = 0;\r\n        }\r\n        this.enableData();\r\n        this.setData(key, this.getData(key, defaultValue) * mul);\r\n        return this;\r\n    },\r\n\r\n    clearData() {\r\n        if (this.data) {\r\n            Object(_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.data);\r\n        }\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/data/DataMethods.js?')},"./lib/rexui/plugins/utils/defaultbounds/GetDefaultBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetDefaultBounds = function (scene, out) {\r\n    if (out === undefined) {\r\n        if (GlobRectangle === undefined) {\r\n            GlobRectangle = new Phaser.Geom.Rectangle();\r\n        }\r\n        out = GlobRectangle;\r\n    }\r\n    var gameConfig = scene.game.config;\r\n    out.setTo(0, 0, gameConfig.width, gameConfig.height);\r\n    return out;\r\n}\r\n\r\nvar GlobRectangle;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetDefaultBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/defaultbounds/GetDefaultBounds.js?')},"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setEventEmitter(eventEmitter, EventEmitterClass) {\r\n        if (EventEmitterClass === undefined) {\r\n            EventEmitterClass = Phaser.Events.EventEmitter; // Use built-in EventEmitter class by default\r\n        }\r\n        this._privateEE = (eventEmitter === undefined);\r\n        this._eventEmitter = (this._privateEE) ? (new EventEmitterClass()) : eventEmitter;\r\n        return this;\r\n    },\r\n\r\n    destroyEventEmitter() {\r\n        if (this._eventEmitter && this._privateEE) {\r\n            this._eventEmitter.shutdown();\r\n        }\r\n    },\r\n\r\n    getEventEmitter() {\r\n        return this._eventEmitter;\r\n    },\r\n\r\n    on: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.on.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    once: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.once.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    off: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.off.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    emit: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.emit.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addListener: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.addListener.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    removeListener: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.removeListener.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    removeAllListeners: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.removeAllListeners.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    listenerCount: function () {\r\n        if (this._eventEmitter) {\r\n            return this._eventEmitter.listenerCount.apply(this._eventEmitter, arguments);\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    listeners: function () {\r\n        if (this._eventEmitter) {\r\n            return this._eventEmitter.listeners.apply(this._eventEmitter, arguments);\r\n        }\r\n        return [];\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js?')},"./lib/rexui/plugins/utils/geom/polygon/Earcut.js":function(module,exports,__webpack_require__){"use strict";eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n//  Earcut 2.1.4 (December 4th 2018)\r\n\r\n/*\r\n * ISC License\r\n * \r\n * Copyright (c) 2016, Mapbox\r\n * \r\n * Permission to use, copy, modify, and/or distribute this software for any purpose\r\n * with or without fee is hereby granted, provided that the above copyright notice\r\n * and this permission notice appear in all copies.\r\n * \r\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n * FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\r\n * OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER\r\n * TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF\r\n * THIS SOFTWARE.\r\n */\r\n\r\n\r\n\r\nmodule.exports = earcut;\r\n\r\nfunction earcut(data, holeIndices, dim) {\r\n\r\n    dim = dim || 2;\r\n\r\n    var hasHoles = holeIndices && holeIndices.length,\r\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\r\n        outerNode = linkedList(data, 0, outerLen, dim, true),\r\n        triangles = [];\r\n\r\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\r\n\r\n    var minX, minY, maxX, maxY, x, y, invSize;\r\n\r\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\r\n\r\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\r\n    if (data.length > 80 * dim) {\r\n        minX = maxX = data[0];\r\n        minY = maxY = data[1];\r\n\r\n        for (var i = dim; i < outerLen; i += dim) {\r\n            x = data[i];\r\n            y = data[i + 1];\r\n            if (x < minX) minX = x;\r\n            if (y < minY) minY = y;\r\n            if (x > maxX) maxX = x;\r\n            if (y > maxY) maxY = y;\r\n        }\r\n\r\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\r\n        invSize = Math.max(maxX - minX, maxY - minY);\r\n        invSize = invSize !== 0 ? 1 / invSize : 0;\r\n    }\r\n\r\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\r\n\r\n    return triangles;\r\n}\r\n\r\n// create a circular doubly linked list from polygon points in the specified winding order\r\nfunction linkedList(data, start, end, dim, clockwise) {\r\n    var i, last;\r\n\r\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\r\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\r\n    } else {\r\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\r\n    }\r\n\r\n    if (last && equals(last, last.next)) {\r\n        removeNode(last);\r\n        last = last.next;\r\n    }\r\n\r\n    return last;\r\n}\r\n\r\n// eliminate colinear or duplicate points\r\nfunction filterPoints(start, end) {\r\n    if (!start) return start;\r\n    if (!end) end = start;\r\n\r\n    var p = start,\r\n        again;\r\n    do {\r\n        again = false;\r\n\r\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\r\n            removeNode(p);\r\n            p = end = p.prev;\r\n            if (p === p.next) break;\r\n            again = true;\r\n\r\n        } else {\r\n            p = p.next;\r\n        }\r\n    } while (again || p !== end);\r\n\r\n    return end;\r\n}\r\n\r\n// main ear slicing loop which triangulates a polygon (given as a linked list)\r\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\r\n    if (!ear) return;\r\n\r\n    // interlink polygon nodes in z-order\r\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\r\n\r\n    var stop = ear,\r\n        prev, next;\r\n\r\n    // iterate through ears, slicing them one by one\r\n    while (ear.prev !== ear.next) {\r\n        prev = ear.prev;\r\n        next = ear.next;\r\n\r\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\r\n            // cut off the triangle\r\n            triangles.push(prev.i / dim);\r\n            triangles.push(ear.i / dim);\r\n            triangles.push(next.i / dim);\r\n\r\n            removeNode(ear);\r\n\r\n            // skipping the next vertex leads to less sliver triangles\r\n            ear = next.next;\r\n            stop = next.next;\r\n\r\n            continue;\r\n        }\r\n\r\n        ear = next;\r\n\r\n        // if we looped through the whole remaining polygon and can't find any more ears\r\n        if (ear === stop) {\r\n            // try filtering points and slicing again\r\n            if (!pass) {\r\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\r\n\r\n            // if this didn't work, try curing all small self-intersections locally\r\n            } else if (pass === 1) {\r\n                ear = cureLocalIntersections(ear, triangles, dim);\r\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\r\n\r\n            // as a last resort, try splitting the remaining polygon into two\r\n            } else if (pass === 2) {\r\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\r\n            }\r\n\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\n// check whether a polygon node forms a valid ear with adjacent nodes\r\nfunction isEar(ear) {\r\n    var a = ear.prev,\r\n        b = ear,\r\n        c = ear.next;\r\n\r\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n    // now make sure we don't have other points inside the potential ear\r\n    var p = ear.next.next;\r\n\r\n    while (p !== ear.prev) {\r\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.next;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction isEarHashed(ear, minX, minY, invSize) {\r\n    var a = ear.prev,\r\n        b = ear,\r\n        c = ear.next;\r\n\r\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n    // triangle bbox; min & max are calculated like this for speed\r\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\r\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\r\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\r\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\r\n\r\n    // z-order range for the current triangle bbox;\r\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\r\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\r\n\r\n    var p = ear.prevZ,\r\n        n = ear.nextZ;\r\n\r\n    // look for points inside the triangle in both directions\r\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\r\n        if (p !== ear.prev && p !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.prevZ;\r\n\r\n        if (n !== ear.prev && n !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\r\n            area(n.prev, n, n.next) >= 0) return false;\r\n        n = n.nextZ;\r\n    }\r\n\r\n    // look for remaining points in decreasing z-order\r\n    while (p && p.z >= minZ) {\r\n        if (p !== ear.prev && p !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.prevZ;\r\n    }\r\n\r\n    // look for remaining points in increasing z-order\r\n    while (n && n.z <= maxZ) {\r\n        if (n !== ear.prev && n !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\r\n            area(n.prev, n, n.next) >= 0) return false;\r\n        n = n.nextZ;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n// go through all polygon nodes and cure small local self-intersections\r\nfunction cureLocalIntersections(start, triangles, dim) {\r\n    var p = start;\r\n    do {\r\n        var a = p.prev,\r\n            b = p.next.next;\r\n\r\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\r\n\r\n            triangles.push(a.i / dim);\r\n            triangles.push(p.i / dim);\r\n            triangles.push(b.i / dim);\r\n\r\n            // remove two nodes involved\r\n            removeNode(p);\r\n            removeNode(p.next);\r\n\r\n            p = start = b;\r\n        }\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    return p;\r\n}\r\n\r\n// try splitting polygon into two and triangulate them independently\r\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\r\n    // look for a valid diagonal that divides the polygon into two\r\n    var a = start;\r\n    do {\r\n        var b = a.next.next;\r\n        while (b !== a.prev) {\r\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\r\n                // split the polygon in two by the diagonal\r\n                var c = splitPolygon(a, b);\r\n\r\n                // filter colinear points around the cuts\r\n                a = filterPoints(a, a.next);\r\n                c = filterPoints(c, c.next);\r\n\r\n                // run earcut on each half\r\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\r\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\r\n                return;\r\n            }\r\n            b = b.next;\r\n        }\r\n        a = a.next;\r\n    } while (a !== start);\r\n}\r\n\r\n// link every hole into the outer loop, producing a single-ring polygon without holes\r\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\r\n    var queue = [],\r\n        i, len, start, end, list;\r\n\r\n    for (i = 0, len = holeIndices.length; i < len; i++) {\r\n        start = holeIndices[i] * dim;\r\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n        list = linkedList(data, start, end, dim, false);\r\n        if (list === list.next) list.steiner = true;\r\n        queue.push(getLeftmost(list));\r\n    }\r\n\r\n    queue.sort(compareX);\r\n\r\n    // process holes from left to right\r\n    for (i = 0; i < queue.length; i++) {\r\n        eliminateHole(queue[i], outerNode);\r\n        outerNode = filterPoints(outerNode, outerNode.next);\r\n    }\r\n\r\n    return outerNode;\r\n}\r\n\r\nfunction compareX(a, b) {\r\n    return a.x - b.x;\r\n}\r\n\r\n// find a bridge between vertices that connects hole with an outer ring and and link it\r\nfunction eliminateHole(hole, outerNode) {\r\n    outerNode = findHoleBridge(hole, outerNode);\r\n    if (outerNode) {\r\n        var b = splitPolygon(outerNode, hole);\r\n        filterPoints(b, b.next);\r\n    }\r\n}\r\n\r\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\r\nfunction findHoleBridge(hole, outerNode) {\r\n    var p = outerNode,\r\n        hx = hole.x,\r\n        hy = hole.y,\r\n        qx = -Infinity,\r\n        m;\r\n\r\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\r\n    // segment's endpoint with lesser x will be potential connection point\r\n    do {\r\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\r\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\r\n            if (x <= hx && x > qx) {\r\n                qx = x;\r\n                if (x === hx) {\r\n                    if (hy === p.y) return p;\r\n                    if (hy === p.next.y) return p.next;\r\n                }\r\n                m = p.x < p.next.x ? p : p.next;\r\n            }\r\n        }\r\n        p = p.next;\r\n    } while (p !== outerNode);\r\n\r\n    if (!m) return null;\r\n\r\n    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\r\n\r\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\r\n    // if there are no points found, we have a valid connection;\r\n    // otherwise choose the point of the minimum angle with the ray as connection point\r\n\r\n    var stop = m,\r\n        mx = m.x,\r\n        my = m.y,\r\n        tanMin = Infinity,\r\n        tan;\r\n\r\n    p = m.next;\r\n\r\n    while (p !== stop) {\r\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\r\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\r\n\r\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\r\n\r\n            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {\r\n                m = p;\r\n                tanMin = tan;\r\n            }\r\n        }\r\n\r\n        p = p.next;\r\n    }\r\n\r\n    return m;\r\n}\r\n\r\n// interlink polygon nodes in z-order\r\nfunction indexCurve(start, minX, minY, invSize) {\r\n    var p = start;\r\n    do {\r\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\r\n        p.prevZ = p.prev;\r\n        p.nextZ = p.next;\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    p.prevZ.nextZ = null;\r\n    p.prevZ = null;\r\n\r\n    sortLinked(p);\r\n}\r\n\r\n// Simon Tatham's linked list merge sort algorithm\r\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\r\nfunction sortLinked(list) {\r\n    var i, p, q, e, tail, numMerges, pSize, qSize,\r\n        inSize = 1;\r\n\r\n    do {\r\n        p = list;\r\n        list = null;\r\n        tail = null;\r\n        numMerges = 0;\r\n\r\n        while (p) {\r\n            numMerges++;\r\n            q = p;\r\n            pSize = 0;\r\n            for (i = 0; i < inSize; i++) {\r\n                pSize++;\r\n                q = q.nextZ;\r\n                if (!q) break;\r\n            }\r\n            qSize = inSize;\r\n\r\n            while (pSize > 0 || (qSize > 0 && q)) {\r\n\r\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\r\n                    e = p;\r\n                    p = p.nextZ;\r\n                    pSize--;\r\n                } else {\r\n                    e = q;\r\n                    q = q.nextZ;\r\n                    qSize--;\r\n                }\r\n\r\n                if (tail) tail.nextZ = e;\r\n                else list = e;\r\n\r\n                e.prevZ = tail;\r\n                tail = e;\r\n            }\r\n\r\n            p = q;\r\n        }\r\n\r\n        tail.nextZ = null;\r\n        inSize *= 2;\r\n\r\n    } while (numMerges > 1);\r\n\r\n    return list;\r\n}\r\n\r\n// z-order of a point given coords and inverse of the longer side of data bbox\r\nfunction zOrder(x, y, minX, minY, invSize) {\r\n    // coords are transformed into non-negative 15-bit integer range\r\n    x = 32767 * (x - minX) * invSize;\r\n    y = 32767 * (y - minY) * invSize;\r\n\r\n    x = (x | (x << 8)) & 0x00FF00FF;\r\n    x = (x | (x << 4)) & 0x0F0F0F0F;\r\n    x = (x | (x << 2)) & 0x33333333;\r\n    x = (x | (x << 1)) & 0x55555555;\r\n\r\n    y = (y | (y << 8)) & 0x00FF00FF;\r\n    y = (y | (y << 4)) & 0x0F0F0F0F;\r\n    y = (y | (y << 2)) & 0x33333333;\r\n    y = (y | (y << 1)) & 0x55555555;\r\n\r\n    return x | (y << 1);\r\n}\r\n\r\n// find the leftmost node of a polygon ring\r\nfunction getLeftmost(start) {\r\n    var p = start,\r\n        leftmost = start;\r\n    do {\r\n        if (p.x < leftmost.x) leftmost = p;\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    return leftmost;\r\n}\r\n\r\n// check if a point lies within a convex triangle\r\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\r\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\r\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\r\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\r\n}\r\n\r\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\r\nfunction isValidDiagonal(a, b) {\r\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&\r\n           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);\r\n}\r\n\r\n// signed area of a triangle\r\nfunction area(p, q, r) {\r\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\r\n}\r\n\r\n// check if two points are equal\r\nfunction equals(p1, p2) {\r\n    return p1.x === p2.x && p1.y === p2.y;\r\n}\r\n\r\n// check if two segments intersect\r\nfunction intersects(p1, q1, p2, q2) {\r\n    if ((equals(p1, q1) && equals(p2, q2)) ||\r\n        (equals(p1, q2) && equals(p2, q1))) return true;\r\n    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&\r\n           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;\r\n}\r\n\r\n// check if a polygon diagonal intersects any polygon segments\r\nfunction intersectsPolygon(a, b) {\r\n    var p = a;\r\n    do {\r\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\r\n                intersects(p, p.next, a, b)) return true;\r\n        p = p.next;\r\n    } while (p !== a);\r\n\r\n    return false;\r\n}\r\n\r\n// check if a polygon diagonal is locally inside the polygon\r\nfunction locallyInside(a, b) {\r\n    return area(a.prev, a, a.next) < 0 ?\r\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\r\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\r\n}\r\n\r\n// check if the middle point of a polygon diagonal is inside the polygon\r\nfunction middleInside(a, b) {\r\n    var p = a,\r\n        inside = false,\r\n        px = (a.x + b.x) / 2,\r\n        py = (a.y + b.y) / 2;\r\n    do {\r\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\r\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\r\n            inside = !inside;\r\n        p = p.next;\r\n    } while (p !== a);\r\n\r\n    return inside;\r\n}\r\n\r\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\r\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\r\nfunction splitPolygon(a, b) {\r\n    var a2 = new Node(a.i, a.x, a.y),\r\n        b2 = new Node(b.i, b.x, b.y),\r\n        an = a.next,\r\n        bp = b.prev;\r\n\r\n    a.next = b;\r\n    b.prev = a;\r\n\r\n    a2.next = an;\r\n    an.prev = a2;\r\n\r\n    b2.next = a2;\r\n    a2.prev = b2;\r\n\r\n    bp.next = b2;\r\n    b2.prev = bp;\r\n\r\n    return b2;\r\n}\r\n\r\n// create a node and optionally link it with previous one (in a circular doubly linked list)\r\nfunction insertNode(i, x, y, last) {\r\n    var p = new Node(i, x, y);\r\n\r\n    if (!last) {\r\n        p.prev = p;\r\n        p.next = p;\r\n\r\n    } else {\r\n        p.next = last.next;\r\n        p.prev = last;\r\n        last.next.prev = p;\r\n        last.next = p;\r\n    }\r\n    return p;\r\n}\r\n\r\nfunction removeNode(p) {\r\n    p.next.prev = p.prev;\r\n    p.prev.next = p.next;\r\n\r\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\r\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\r\n}\r\n\r\nfunction Node(i, x, y) {\r\n    // vertex index in coordinates array\r\n    this.i = i;\r\n\r\n    // vertex coordinates\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    // previous and next vertex nodes in a polygon ring\r\n    this.prev = null;\r\n    this.next = null;\r\n\r\n    // z-order curve value\r\n    this.z = null;\r\n\r\n    // previous and next nodes in z-order\r\n    this.prevZ = null;\r\n    this.nextZ = null;\r\n\r\n    // indicates whether this is a steiner point\r\n    this.steiner = false;\r\n}\r\n\r\n// return a percentage difference between the polygon area and its triangulation area;\r\n// used to verify correctness of triangulation\r\nearcut.deviation = function (data, holeIndices, dim, triangles) {\r\n    var hasHoles = holeIndices && holeIndices.length;\r\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\r\n\r\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\r\n    if (hasHoles) {\r\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\r\n            var start = holeIndices[i] * dim;\r\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\r\n        }\r\n    }\r\n\r\n    var trianglesArea = 0;\r\n    for (i = 0; i < triangles.length; i += 3) {\r\n        var a = triangles[i] * dim;\r\n        var b = triangles[i + 1] * dim;\r\n        var c = triangles[i + 2] * dim;\r\n        trianglesArea += Math.abs(\r\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\r\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\r\n    }\r\n\r\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\r\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\r\n};\r\n\r\nfunction signedArea(data, start, end, dim) {\r\n    var sum = 0;\r\n    for (var i = start, j = end - dim; i < end; i += dim) {\r\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\r\n        j = i;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\r\nearcut.flatten = function (data) {\r\n    var dim = data[0][0].length,\r\n        result = {vertices: [], holes: [], dimensions: dim},\r\n        holeIndex = 0;\r\n\r\n    for (var i = 0; i < data.length; i++) {\r\n        for (var j = 0; j < data[i].length; j++) {\r\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\r\n        }\r\n        if (i > 0) {\r\n            holeIndex += data[i - 1].length;\r\n            result.holes.push(holeIndex);\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/geom/polygon/Earcut.js?")},"./lib/rexui/plugins/utils/input/StopPropagationTouchEvents.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar StopPropagationTouchEvents = function (element) {\r\n    // Don\'t propagate touch/mouse events to parent(game canvas)\r\n    element.addEventListener("touchstart", callback, false);\r\n    element.addEventListener("touchmove", callback, false);\r\n    element.addEventListener("touchend", callback, false);\r\n    element.addEventListener("mousedown", callback, false);\r\n    element.addEventListener("mouseup", callback, false);\r\n    element.addEventListener("mousemove", callback, false);\r\n}\r\n\r\nvar callback = function (e) {\r\n    e.stopPropagation();\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (StopPropagationTouchEvents);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/input/StopPropagationTouchEvents.js?')},"./lib/rexui/plugins/utils/loader/LoadScript.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LoadScript = function (url, onload) {\r\n    var scripts = document.getElementsByTagName("script");\r\n    var exist = false;\r\n    for (var i = 0, cnt = scripts.length; i < cnt; i++) {\r\n        if (scripts[i].src.indexOf(url) != -1) {\r\n            exist = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!exist) {\r\n        var newScriptTag = document.createElement("script");\r\n        newScriptTag.type = "text/javascript";\r\n        newScriptTag.src = url;\r\n\r\n        if (onload) {\r\n            newScriptTag.onload = onload;\r\n        }\r\n\r\n        document.getElementsByTagName("head")[0].appendChild(newScriptTag);\r\n    }\r\n};\r\n/* harmony default export */ __webpack_exports__["default"] = (LoadScript);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/loader/LoadScript.js?')},"./lib/rexui/plugins/utils/mask/DefaultMask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst Graphics = Phaser.GameObjects.Graphics;\r\n\r\nclass DefaultMask extends Graphics {\r\n    constructor(parent, shape, padding) {\r\n        if (shape === undefined) {\r\n            shape = 0;\r\n        }\r\n        if (typeof (shape) === 'string') {\r\n            shaep = SHAPEMODE[shape];\r\n        }\r\n        if (padding === undefined) {\r\n            padding = 0;\r\n        }\r\n\r\n        super(parent.scene);\r\n        this.parent = parent;\r\n        this.shape = shape;\r\n        this.padding = padding;\r\n        this.setPosition().resize();\r\n        // Don't add it to display list\r\n        // Graphics does not have origin, bounds\r\n    }\r\n\r\n    destroy() {\r\n        this.parent = undefined;\r\n        super.destroy();\r\n        return this;\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        var parent = this.parent;\r\n        if (x === undefined) {\r\n            x = parent.x;\r\n        }\r\n        if (y === undefined) {\r\n            y = parent.y;\r\n        }\r\n        super.setPosition(x, y);\r\n        return this;\r\n    }\r\n\r\n    resize(width, height, padding) {\r\n        var parent = this.parent;\r\n        if (width === undefined) {\r\n            width = parent.width;\r\n        }\r\n        if (height === undefined) {\r\n            height = parent.height;\r\n        }\r\n        if (padding === undefined) {\r\n            padding = this.padding;\r\n        }\r\n        if ((this.widthSave === width) && (this.heightSave === height) && (this.paddingSave === padding)) {\r\n            return this;\r\n        }\r\n\r\n        this.clear().fillStyle(0xffffff);\r\n        switch (this.shape) {\r\n            case 1: // circle\r\n                var radius = Math.min(width, height) / 2;\r\n                this.fillCircle(\r\n                    0,\r\n                    0,\r\n                    radius + padding\r\n                );\r\n                break;\r\n            default: // 0|'rectangle'\r\n                this.fillRect(\r\n                    -(width * parent.originX) - padding,\r\n                    -(height * parent.originY) - padding,\r\n                    width + (2 * padding),\r\n                    height + (2 * padding)\r\n                );\r\n                break;\r\n        }\r\n        this.widthSave = width;\r\n        this.heightSave = height;\r\n        this.paddingSave = padding;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst SHAPEMODE = {\r\n    rectangle: 0,\r\n    circle: 1,\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (DefaultMask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/mask/DefaultMask.js?")},"./lib/rexui/plugins/utils/mask/MaskToGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar MaskToGameObject = function (mask) {\r\n    return (mask.hasOwnProperty('geometryMask')) ? mask.geometryMask : mask.bitmapMask;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MaskToGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/mask/MaskToGameObject.js?")},"./lib/rexui/plugins/utils/math/DegToRad.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nconst DEG_TO_RAD = Math.PI / 180;\r\n\r\n/**\r\n * Convert the given angle from degrees, to the equivalent angle in radians.\r\n *\r\n * @function Phaser.Math.DegToRad\r\n * @since 3.0.0\r\n *\r\n * @param {integer} degrees - The angle (in degrees) to convert to radians.\r\n *\r\n * @return {number} The given angle converted to radians.\r\n */\r\nvar DegToRad = function (degrees)\r\n{\r\n    return degrees * DEG_TO_RAD;\r\n};\r\n\r\nmodule.exports = DegToRad;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/math/DegToRad.js?")},"./lib/rexui/plugins/utils/math/angle/angletodirections/AngleToDirections.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar AngleToDirections = function (angle, dirMode, out) {\r\n    if (out === undefined) {\r\n        out = {}\r\n    } else if (out === true) {\r\n        out = tmpOut;\r\n    }\r\n\r\n    out.left = false;\r\n    out.right = false;\r\n    out.up = false;\r\n    out.down = false;\r\n\r\n    angle = (angle + 360) % 360;\r\n    switch (dirMode) {\r\n        case 0: // up & down\r\n            if (angle < 180) {\r\n                out.down = true;\r\n            } else {\r\n                out.up = true;\r\n            }\r\n            break;\r\n\r\n        case 1: // left & right\r\n            if ((angle > 90) && (angle <= 270)) {\r\n                out.left = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n\r\n        case 2: // 4 dir\r\n            if ((angle > 45) && (angle <= 135)) {\r\n                out.down = true;\r\n            } else if ((angle > 135) && (angle <= 225)) {\r\n                out.left = true;\r\n            } else if ((angle > 225) && (angle <= 315)) {\r\n                out.up = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n\r\n        case 3: // 8 dir\r\n            if ((angle > 22.5) && (angle <= 67.5)) {\r\n                out.down = true;\r\n                out.right = true;\r\n            } else if ((angle > 67.5) && (angle <= 112.5)) {\r\n                out.down = true;\r\n            } else if ((angle > 112.5) && (angle <= 157.5)) {\r\n                out.down = true;\r\n                out.left = true;\r\n            } else if ((angle > 157.5) && (angle <= 202.5)) {\r\n                out.left = true;\r\n            } else if ((angle > 202.5) && (angle <= 247.5)) {\r\n                out.left = true;\r\n                out.up = true;\r\n            } else if ((angle > 247.5) && (angle <= 292.5)) {\r\n                out.up = true;\r\n            } else if ((angle > 292.5) && (angle <= 337.5)) {\r\n                out.up = true;\r\n                out.right = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\nvar tmpOut = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (AngleToDirections);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/math/angle/angletodirections/AngleToDirections.js?')},"./lib/rexui/plugins/utils/math/angle/angletodirections/Const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    'up&down': 0,\r\n    'left&right': 1,\r\n    '4dir': 2,\r\n    '8dir': 3\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/math/angle/angletodirections/Const.js?")},"./lib/rexui/plugins/utils/movement/Movement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Movement {\r\n    constructor(config) {\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setValue(GetValue(o, 'value', 0));\r\n        this.setSpeed(GetValue(o, 'speed', 0));\r\n        this.setAcceleration(GetValue(o, 'acceleration', 0));\r\n        return this;\r\n    }\r\n\r\n    reset() {\r\n        this.setValue(0);\r\n        this.setSpeed(0);\r\n        this.setAcceleration(0);\r\n    }\r\n\r\n    setValue(value) {\r\n        this.value = value;\r\n        return this;\r\n    }\r\n\r\n    setSpeed(speed) {\r\n        // speed == 0 : stop\r\n        // speed  > 0 : move\r\n        this.speed = speed;\r\n        return this;        \r\n    }\r\n\r\n    setAcceleration(acc) {\r\n        // acc == 0 : constant speed\r\n        // acc  > 0 : acceleration\r\n        // acc  < 0 : deceleration\r\n        this.acceleration = acc;\r\n        return this;\r\n    }\r\n\r\n    updateSpeed(delta) {\r\n        // delta in sec\r\n        if (this.acceleration !== 0) {\r\n            this.speed += (this.acceleration * delta);\r\n            if (this.speed < 0) {\r\n                this.speed = 0;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    getDeltaValue(delta) {\r\n        // delta in sec\r\n        this.updateSpeed(delta);\r\n        if (this.speed <= 0) {\r\n            return 0;\r\n        }\r\n        return (this.speed * delta);\r\n    }\r\n\r\n    update(delta) {\r\n        // delta in sec\r\n        this.updateSpeed(delta);\r\n        if (this.speed > 0) {\r\n            this.value += this.getDeltaValue(delta);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isMoving() {\r\n        return (this.speed > 0);\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Movement);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/movement/Movement.js?")},"./lib/rexui/plugins/utils/movement/SlowDown.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Movement_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Movement.js */ "./lib/rexui/plugins/utils/movement/Movement.js");\n\r\n\r\nclass SlowDown {\r\n    constructor() {\r\n        this.value;\r\n        this.dir; // true:+, false:-\r\n        this.movement = new _Movement_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\n    }\r\n\r\n    init(start, dir, speed, dec, end) {\r\n        this.value = start;\r\n        this.end = end;\r\n        if (end !== undefined) {\r\n            this.dir = (start < end);\r\n        } else {\r\n            this.dir = dir;\r\n        }\r\n\r\n        this.movement\r\n            .setSpeed(speed)\r\n            .setAcceleration(-dec);\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.movement.reset();\r\n    }\r\n\r\n    update(delta) {\r\n        // delta in sec\r\n        var d = this.movement.getDeltaValue(delta);\r\n        if (!this.dir) {\r\n            d = -d;\r\n        }\r\n\r\n        if (this.end === undefined) {\r\n            this.value += d;\r\n        } else {\r\n            if (d === 0) {\r\n                this.value = this.end;\r\n            } else {\r\n                this.value += d;\r\n                if (this.dir) { // +\r\n                    if (this.value > this.end) {\r\n                        this.value = this.end;\r\n                    }\r\n                } else { // -\r\n                    if (this.value < this.end) {\r\n                        this.value = this.end;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isMoving() {\r\n        return this.movement.isMoving;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SlowDown);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/movement/SlowDown.js?')},"./lib/rexui/plugins/utils/object/Clear.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Clear = function (obj) {\r\n    if (Array.isArray(obj)) {\r\n        obj.length = 0;\r\n    } else {\r\n        for (var key in obj) {\r\n            delete obj[key];\r\n        }\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Clear);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/Clear.js?')},"./lib/rexui/plugins/utils/object/Clone.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Clear_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Clear.js */ "./lib/rexui/plugins/utils/object/Clear.js");\n\r\n\r\n/**\r\n * Shallow Object Clone. Will not out nested objects.\r\n * @param {object} obj JSON object\r\n * @param {object} ret JSON object to return, set null to return a new object\r\n * @returns {object} this object\r\n */\r\nvar Clone = function (obj, out) {\r\n    var objIsArray = Array.isArray(obj);\r\n\r\n    if (out === undefined) {\r\n        out = (objIsArray) ? [] : {};\r\n    } else {\r\n        Object(_Clear_js__WEBPACK_IMPORTED_MODULE_0__["default"])(out);\r\n    }\r\n\r\n    if (objIsArray) {\r\n        out.length = obj.length;\r\n    }\r\n    for (var key in obj) {\r\n        out[key] = obj[key];\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Clone);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/Clone.js?')},"./lib/rexui/plugins/utils/object/GetValue.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n//  Source object\r\n//  The key as a string, or an array of keys, i.e. 'banner', or 'banner.hideBanner'\r\n//  The default value to use if the key doesn't exist\r\n\r\n/**\r\n * Retrieves a value from an object.\r\n *\r\n * @function Phaser.Utils.Objects.GetValue\r\n * @since 3.0.0\r\n *\r\n * @param {object} source - The object to retrieve the value from.\r\n * @param {string} key - The name of the property to retrieve from the object. If a property is nested, the names of its preceding properties should be separated by a dot (`.`) - `banner.hideBanner` would return the value of the `hideBanner` property from the object stored in the `banner` property of the `source` object.\r\n * @param {*} defaultValue - The value to return if the `key` isn't found in the `source` object.\r\n *\r\n * @return {*} The value of the requested key.\r\n */\r\nvar GetValue = function (source, key, defaultValue)\r\n{\r\n    if (!source || typeof source === 'number')\r\n    {\r\n        return defaultValue;\r\n    }\r\n    else if (source.hasOwnProperty(key))\r\n    {\r\n        return source[key];\r\n    }\r\n    else if (key.indexOf('.') !== -1)\r\n    {\r\n        var keys = key.split('.');\r\n        var parent = source;\r\n        var value = defaultValue;\r\n\r\n        //  Use for loop here so we can break early\r\n        for (var i = 0; i < keys.length; i++)\r\n        {\r\n            if (parent.hasOwnProperty(keys[i]))\r\n            {\r\n                //  Yes it has a key property, let's carry on down\r\n                value = parent[keys[i]];\r\n\r\n                parent = parent[keys[i]];\r\n            }\r\n            else\r\n            {\r\n                //  Can't go any further, so reset to default\r\n                value = defaultValue;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return value;\r\n    }\r\n    else\r\n    {\r\n        return defaultValue;\r\n    }\r\n};\r\n\r\nmodule.exports = GetValue;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/GetValue.js?")},"./lib/rexui/plugins/utils/object/IsArray.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar IsArray = function(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Array]';\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (IsArray);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/IsArray.js?")},"./lib/rexui/plugins/utils/object/IsFunction.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar IsFunction = function (obj) {    \r\n    return obj && (typeof(obj) === 'function');\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (IsFunction);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/IsFunction.js?")},"./lib/rexui/plugins/utils/object/NOOP.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar NOOP = function () {\r\n    //  NOOP\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (NOOP);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/NOOP.js?')},"./lib/rexui/plugins/utils/object/SetValue.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar isInValidKey = function (keys) {\r\n    return (keys == null) || (keys === "") || (keys.length === 0);\r\n};\r\n\r\nvar getEntry = function (target, keys, defaultEntry) {\r\n    if (defaultEntry === undefined) {\r\n        defaultEntry = {};\r\n    }\r\n    var entry = target;\r\n    if (isInValidKey(keys)) {\r\n        //entry = root;\r\n    } else {\r\n        if (typeof (keys) === "string") {\r\n            keys = keys.split(".");\r\n        }\r\n\r\n        var key;\r\n        for (var i = 0, cnt = keys.length; i < cnt; i++) {\r\n            key = keys[i];\r\n            if ((entry[key] == null) || (typeof (entry[key]) !== "object")) {\r\n                var newEntry;\r\n                if (i === cnt - 1) {\r\n                    newEntry = defaultEntry;\r\n                } else {\r\n                    newEntry = {};\r\n                }\r\n\r\n                entry[key] = newEntry;\r\n            }\r\n\r\n            entry = entry[key];\r\n        }\r\n    }\r\n\r\n    return entry;\r\n};\r\nvar SetValue = function (target, keys, value) {\r\n    // no object\r\n    if (typeof (target) !== "object") {\r\n        return;\r\n    }\r\n\r\n    // invalid key\r\n    else if (isInValidKey(keys)) {\r\n        // don\'t erase target\r\n        if (value == null) {\r\n            return;\r\n        }\r\n        // set target to another object\r\n        else if (typeof (value) === "object") {\r\n            target = value;\r\n        }\r\n    } else {\r\n        if (typeof (keys) === "string") {\r\n            keys = keys.split(".");\r\n        }\r\n\r\n        var lastKey = keys.pop();\r\n        var entry = getEntry(target, keys);\r\n        entry[lastKey] = value;\r\n    }\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetValue);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/SetValue.js?')},"./lib/rexui/plugins/utils/object/Stack.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nclass Stack {\r\n    constructor() {\r\n        this.items = [];\r\n    }\r\n\r\n    destroy() {\r\n        this.items.length = 0;\r\n        this.items = undefined;\r\n    }\r\n\r\n    pop() {\r\n        return (this.items.length > 0) ? this.items.pop() : null;\r\n    }\r\n\r\n    push(l) {\r\n        this.items.push(l);\r\n        return this;\r\n    }\r\n\r\n    pushMultiple(arr) {\r\n        this.items.push.apply(this.items, arr);\r\n        arr.length = 0;\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Stack);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/object/Stack.js?')},"./lib/rexui/plugins/utils/size/ResizeGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ResizeGameObject = function (gameObject, newWidth, newHeight) {\r\n    if (!gameObject || ((newWidth === undefined) && (newHeight === undefined))) {\r\n        return;\r\n    }\r\n    if (gameObject.resize) { // Has `resize` method\r\n        if (newWidth === undefined) {\r\n            newWidth = gameObject.width;\r\n        }\r\n        if (newHeight === undefined) {\r\n            newHeight = gameObject.height;\r\n        }\r\n        gameObject.resize(newWidth, newHeight);\r\n    } else { // Set display width/height\r\n        if (newWidth !== undefined) {\r\n            gameObject.displayWidth = newWidth;\r\n        }\r\n        if (newHeight !== undefined) {\r\n            gameObject.displayHeight = newHeight;\r\n        }\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResizeGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/size/ResizeGameObject.js?')},"./lib/rexui/plugins/utils/string/TypeConvert.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar FLOAT = /^\\s*-?(\\d*\\.?\\d+|\\d+\\.?\\d*)(e[-+]?\\d+)?\\s*$/i;\r\nvar convert = function (s) {\r\n    if (typeof (s) !== 'string') {\r\n        return s;\r\n    }\r\n\r\n    if (s === '') {\r\n        s = null;\r\n    } else if (FLOAT.test(s)) {\r\n        s = parseFloat(s);\r\n    } else {        \r\n        if (screen === 'false') {\r\n            s = false;\r\n        } else if (s === 'true') {\r\n            s = true;\r\n        }\r\n    }\r\n\r\n    return s;\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (convert);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/string/TypeConvert.js?")},"./lib/rexui/plugins/utils/system/GetEventEmitter.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./IsSceneObject.js */ "./lib/rexui/plugins/utils/system/IsSceneObject.js");\n\r\n\r\nvar GetEventEmitter = function (object) {\r\n    if (Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object)) {\r\n        return object.events;\r\n    } else if (object.on) {\r\n        return object;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetEventEmitter);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/system/GetEventEmitter.js?')},"./lib/rexui/plugins/utils/system/GetSceneObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./IsSceneObject.js */ "./lib/rexui/plugins/utils/system/IsSceneObject.js");\n\r\n\r\nvar GetSceneObject = function (object) {\r\n    if (Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object)) { // object = scene\r\n        return object;\r\n    } else if (object.scene && Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object.scene)) { // object = game object\r\n        return object.scene;\r\n    } else if (object.parent && object.parent.scene && Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object.parent.scene)) { // parent = bob object\r\n        return object.parent.scene;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetSceneObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/system/GetSceneObject.js?')},"./lib/rexui/plugins/utils/system/IsGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst GameObjectClass = Phaser.GameObjects.GameObject;\r\nvar IsGameObject = function (object) {\r\n    return (object instanceof GameObjectClass);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (IsGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/system/IsGameObject.js?')},"./lib/rexui/plugins/utils/system/IsSceneObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst SceneClass = Phaser.Scene;\r\nvar IsSceneObject = function (object) {\r\n    return (object instanceof SceneClass);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (IsSceneObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/system/IsSceneObject.js?')},"./lib/rexui/plugins/utils/text/IsTextGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst TextKlass = Phaser.GameObjects.Text;\r\n\r\nvar IsTextGameObject = function (gameObject) {\r\n    return (gameObject instanceof TextKlass);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsTextGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/text/IsTextGameObject.js?')},"./lib/rexui/plugins/utils/ticktask/TickTask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../eventemitter/EventEmitterMethods.js */ \"./lib/rexui/plugins/utils/eventemitter/EventEmitterMethods.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TickTask {\r\n    constructor(parent, config) {\r\n        this.parent = parent;\r\n        this._isRunning = false;\r\n        this.tickingState = false;\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n        this.setTickingMode(GetValue(config, 'tickingMode', 1));\r\n    }\r\n\r\n    // override\r\n    boot() {\r\n        if ((this.tickingMode === 2) && (!this.tickingState)) {\r\n            this.startTicking();\r\n        }\r\n    }\r\n\r\n    // override\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        if (this.tickingState) {\r\n            this.stopTicking();\r\n        }        \r\n    }\r\n\r\n    setTickingMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = TICKINGMODE[mode];\r\n        }\r\n        this.tickingMode = mode;\r\n    }\r\n\r\n    // override\r\n    startTicking() {\r\n        this.tickingState = true;\r\n    }\r\n\r\n    // override\r\n    stopTicking() {\r\n        this.tickingState = false;\r\n    }\r\n\r\n    get isRunning() {\r\n        return this._isRunning;\r\n    }\r\n\r\n    set isRunning(value) {\r\n        if (this._isRunning === value) {\r\n            return;\r\n        }\r\n\r\n        this._isRunning = value;\r\n        if ((this.tickingMode === 1) && (value != this.tickingState)) {\r\n            if (value) {\r\n                this.startTicking();\r\n            } else {\r\n                this.stopTicking();\r\n            }\r\n        }\r\n    }\r\n\r\n    start() {\r\n        this.isRunning = true;\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        this.isRunning = false;\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        this.isRunning = true;\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.isRunning = false;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.isRunning = false;\r\n        this.emit('complete', this.parent, this);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    TickTask.prototype,\r\n    _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nconst TICKINGMODE = {\r\n    'no': 0,\r\n    'lazy': 1,\r\n    'always': 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TickTask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/plugins/utils/ticktask/TickTask.js?")},"./lib/rexui/templates/ui/ObjectFactory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nclass ObjectFactory {\r\n    constructor(scene) {\r\n        this.scene = scene;\r\n    }\r\n\r\n    static register(type, callback) {\r\n        ObjectFactory.prototype[type] = callback;\r\n    }\r\n};\r\n/* harmony default export */ __webpack_exports__["default"] = (ObjectFactory);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/ObjectFactory.js?')},"./lib/rexui/templates/ui/basesizer/AddChildrenMap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar AddChildrenMap = function (key, gameObject) {\r\n    if (this.childrenMap === undefined) {\r\n        this.childrenMap = {};\r\n    }\r\n    this.childrenMap[key] = gameObject;\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (AddChildrenMap);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/AddChildrenMap.js?')},"./lib/rexui/templates/ui/basesizer/BaseSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _container_Container_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../container/Container.js */ "./lib/rexui/templates/ui/container/Container.js");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ "./lib/rexui/templates/ui/basesizer/Methods.js");\n/* harmony import */ var _plugins_behaviors_anchor_Anchor_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/behaviors/anchor/Anchor.js */ "./lib/rexui/plugins/behaviors/anchor/Anchor.js");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Base extends _container_Container_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        var anchorX, anchorY;\r\n        if (typeof (x) === \'string\') {\r\n            anchorX = x;\r\n            anchorY = y;\r\n            x = 0;\r\n            y = 0;\r\n        }\r\n\r\n        super(scene, x, y, 2, 2);\r\n\r\n        this.isRexSizer = true;\r\n        this.setMinSize(minWidth, minHeight);\r\n        this.setName(GetValue(config, \'name\', \'\'));\r\n        this.rexSizer = {};\r\n        this.backgroundChildren = undefined;\r\n\r\n        if (anchorX !== undefined) {\r\n            this._anchor = new _plugins_behaviors_anchor_Anchor_js__WEBPACK_IMPORTED_MODULE_2__["default"](this, {\r\n                x: anchorX,\r\n                y: anchorY,\r\n            });;\r\n        }\r\n\r\n        this.setDraggable(GetValue(config, \'draggable\', false));\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.backgroundChildren !== undefined) {\r\n            this.backgroundChildren.length = 0;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setMinSize(minWidth, minHeight) {\r\n        this.setMinWidth(minWidth).setMinHeight(minHeight);\r\n        return this;\r\n    }\r\n\r\n    setMinWidth(minWidth) {\r\n        if (minWidth == null) {\r\n            minWidth = 0;\r\n        }\r\n        this.minWidth = minWidth;\r\n        return this;\r\n    }\r\n\r\n    setMinHeight(minHeight) {\r\n        if (minHeight == null) {\r\n            minHeight = 0;\r\n        }\r\n        this.minHeight = minHeight;\r\n        return this;\r\n    }\r\n\r\n    get childrenWidth() {\r\n        if (this._childrenWidth === undefined) {\r\n            this._childrenWidth = this.getChildrenWidth();\r\n        }\r\n        return this._childrenWidth;\r\n    }\r\n\r\n    get childrenHeight() {\r\n        if (this._childrenHeight === undefined) {\r\n            this._childrenHeight = this.getChildrenHeight();\r\n        }\r\n        return this._childrenHeight;\r\n    }\r\n\r\n    get left() {\r\n        return this.x - (this.displayWidth * this.originX);\r\n    }\r\n\r\n    set left(value) {\r\n        this.x += (value - this.left);\r\n    }\r\n\r\n    alignLeft(value) {\r\n        this.left = value;\r\n        return this;\r\n    }\r\n\r\n    get right() {\r\n        return (this.x - (this.displayWidth * this.originX)) + this.displayWidth;\r\n    }\r\n\r\n    set right(value) {\r\n        this.x += (value - this.right);\r\n    }\r\n\r\n    alignRight(value) {\r\n        this.right = value;\r\n        return this;\r\n    }\r\n\r\n    get centerX() {\r\n        return (this.left + this.right) / 2;\r\n    }\r\n\r\n    set centerX(value) {\r\n        this.x += (value - this.centerX);\r\n    }\r\n\r\n    alignCenterX(value) {\r\n        this.centerX = value;\r\n        return this;\r\n    }\r\n\r\n    get top() {\r\n        return this.y - (this.displayHeight * this.originY);\r\n    }\r\n\r\n    set top(value) {\r\n        this.y += (value - this.top);\r\n    }\r\n\r\n    alignTop(value) {\r\n        this.top = value;\r\n        return this;\r\n    }\r\n\r\n    get bottom() {\r\n        return (this.y - (this.displayHeight * this.originY)) + this.displayHeight;\r\n    }\r\n\r\n    set bottom(value) {\r\n        this.y += (value - this.bottom);\r\n    }\r\n\r\n    alignBottom(value) {\r\n        this.bottom = value;\r\n        return this;\r\n    }\r\n\r\n    get centerY() {\r\n        return (this.top + this.bottom) / 2;\r\n    }\r\n\r\n    set centerY(value) {\r\n        this.y += (value - this.centerY);\r\n    }\r\n\r\n    alignCenterY(value) {\r\n        this.centerY = value;\r\n        return this;\r\n    }\r\n\r\n    pin(gameObject) {\r\n        super.add(gameObject);\r\n        return this;\r\n    }\r\n\r\n    addBackground(gameObject) {\r\n        if (this.backgroundChildren === undefined) {\r\n            this.backgroundChildren = [];\r\n        }\r\n\r\n        super.add(gameObject);\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        this.backgroundChildren.push(gameObject);\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Base.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Base);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/BaseSizer.js?')},"./lib/rexui/templates/ui/basesizer/DrawBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar DrawBounds = function (graphics, color) {\r\n    if (color === undefined) {\r\n        color = 0xffffff;\r\n    }\r\n    var children = this.getAllChildren([this]),\r\n        child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (!child.getBounds) {\r\n            continue;\r\n        }\r\n        graphics.lineStyle(1, color).strokeRectShape(child.getBounds(globRect));\r\n    }\r\n    return this;\r\n}\r\n\r\nvar globRect = new Phaser.Geom.Rectangle();\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (DrawBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/DrawBounds.js?')},"./lib/rexui/templates/ui/basesizer/FadeIn.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_fade_in_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/fade-in.js */ "./lib/rexui/plugins/fade-in.js");\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (duration) {\r\n    if (IsPlainObject(duration)) {\r\n        var config = duration;\r\n        duration = GetValue(config, \'duration\', undefined);\r\n    }\r\n\r\n    this._fade = Object(_plugins_fade_in_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, duration, this._fade);\r\n    return this;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/FadeIn.js?')},"./lib/rexui/templates/ui/basesizer/FadeOutDestroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_fade_out_destroy_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/fade-out-destroy.js */ "./lib/rexui/plugins/fade-out-destroy.js");\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (duration, destroyMode) {\r\n    if (IsPlainObject(duration)) {\r\n        var config = duration;\r\n        duration = GetValue(config, \'duration\', undefined);\r\n        destroyMode = GetValue(config, \'destroy\', undefined);\r\n    }\r\n    this._fade = Object(_plugins_fade_out_destroy_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, duration, destroyMode, this._fade);\r\n    return this;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/FadeOutDestroy.js?')},"./lib/rexui/templates/ui/basesizer/GetAllChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetAllChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var startIdx = out.length;\r\n    var children = this.getChildrenSizers(out);\r\n    var endIdx = out.length;\r\n    for (var i = startIdx; i < endIdx; i++) {\r\n        children[i].getAllChildrenSizers(out);\r\n    }\r\n\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetAllChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetAllChildrenSizers.js?')},"./lib/rexui/templates/ui/basesizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar GetChildrenHeight = function () {\r\n    return 0;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetChildrenHeight.js?')},"./lib/rexui/templates/ui/basesizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar GetChildrenSizers = function(out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetChildrenSizers.js?')},"./lib/rexui/templates/ui/basesizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar GetChildrenWidth = function () {\r\n    return 0;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetChildrenWidth.js?')},"./lib/rexui/templates/ui/basesizer/GetElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetElement = function (mapNameList) {\r\n    if (this.childrenMap === undefined) {\r\n        return undefined;\r\n    }\r\n\r\n    if (typeof (mapNameList) === 'string') {\r\n        mapNameList = mapNameList.split('.');\r\n    }\r\n    if (mapNameList.length === 0) {\r\n        return undefined;\r\n    }\r\n\r\n    var name = mapNameList.shift(),\r\n        element;\r\n    if (name.charAt(0) === '#') {\r\n        name = name.substring(1);\r\n        var elements = GetAllElements(this.childrenMap, tmpArray);\r\n        for (var i = 0, cnt = elements.length; i < cnt; i++) {\r\n            if (elements[i].name === name) {\r\n                element = elements[i];\r\n                break;\r\n            }\r\n        }\r\n        tmpArray.length = 0;\r\n    } else if (name.indexOf('[') === (-1)) {\r\n        element = this.childrenMap[name];\r\n    } else { // name[]\r\n        var innerMatch = name.match(RE_OBJ);\r\n        if (innerMatch != null) {\r\n            var elements = this.childrenMap[innerMatch[1]];\r\n            if (elements) {\r\n                element = elements[innerMatch[2]];\r\n            }\r\n        }\r\n    }\r\n\r\n    if (mapNameList.length === 0) {\r\n        return element;\r\n    } else if (element && element.childrenMap) {\r\n        return element.getElement(mapNameList);\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\nvar GetAllElements = function (children, out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var child;\r\n    for (var key in children) {\r\n        child = children[key];\r\n        if (child.name !== undefined) {\r\n            out.push(child);\r\n        } else {\r\n            GetAllElements(child, out);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nconst RE_OBJ = /(\\S+)\\[(\\d+)\\]/i;\r\nvar tmpArray = [];\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetElement);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetElement.js?")},"./lib/rexui/templates/ui/basesizer/GetTopmostSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetSizerConfig.js */ "./lib/rexui/templates/ui/utils/GetSizerConfig.js");\n\r\n\r\nvar GetTopmostSizer = function (gameObject) {\r\n    if (gameObject === undefined) {\r\n        gameObject = this;\r\n    }\r\n    var parent = Object(_utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject).parent;\r\n    while (parent) {\r\n        gameObject = parent;\r\n        parent = Object(_utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject).parent;\r\n    }\r\n    return gameObject;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetTopmostSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/GetTopmostSizer.js?')},"./lib/rexui/templates/ui/basesizer/IsInTouching.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar IsInTouching = function (pointer) {\r\n    if (globRect === undefined) {\r\n        globRect = new Phaser.Geom.Rectangle();\r\n    }\r\n    this.getBounds(globRect);\r\n\r\n    if (pointer !== undefined) {\r\n        return globRect.contains(pointer.x, pointer.y);\r\n\r\n    } else {\r\n        var inputManager = this.scene.input.manager;\r\n        var pointersTotal = inputManager.pointersTotal;\r\n        var pointers = inputManager.pointers;\r\n        for (var i = 0; i < pointersTotal; i++) {\r\n            pointer = pointers[i];\r\n            if (globRect.contains(pointer.x, pointer.y)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n\r\n    }\r\n\r\n}\r\n\r\nvar globRect = undefined;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsInTouching);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/IsInTouching.js?')},"./lib/rexui/templates/ui/basesizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar Layout = function (parent, newWidth, newHeight) {}\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/Layout.js?')},"./lib/rexui/templates/ui/basesizer/LayoutBackgrounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nvar LayoutBackgrounds = function () {\r\n    if (this.backgroundChildren === undefined) {\r\n        return;\r\n    }\r\n    var backgrounds = this.backgroundChildren;\r\n\r\n    var child;\r\n    var x = this.left,\r\n        y = this.top,\r\n        width = this.width,\r\n        height = this.height;\r\n\r\n    for (var i = 0, cnt = backgrounds.length; i < cnt; i++) {\r\n        child = backgrounds[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n        Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, width, height);\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"].setPosition(x, y).setSize(width, height);\r\n        AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"], ALIGN_CENTER);\r\n        this.resetChildPositionState(child);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutBackgrounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/LayoutBackgrounds.js?')},"./lib/rexui/templates/ui/basesizer/LayoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInit = function (parent) {\r\n    if (parent) {\r\n        return;\r\n    }\r\n\r\n    var children = this.getAllChildrenSizers([this]);\r\n    var child, parent;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (!child.rexSizer) {\r\n            continue;\r\n        }\r\n        child._layoutInit();\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/LayoutInit.js?')},"./lib/rexui/templates/ui/basesizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetSizerConfig.js */ "./lib/rexui/templates/ui/utils/GetSizerConfig.js");\n/* harmony import */ var _PushIntoBounds_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PushIntoBounds.js */ "./lib/rexui/templates/ui/basesizer/PushIntoBounds.js");\n/* harmony import */ var _DrawBounds_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DrawBounds.js */ "./lib/rexui/templates/ui/basesizer/DrawBounds.js");\n/* harmony import */ var _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AddChildrenMap.js */ "./lib/rexui/templates/ui/basesizer/AddChildrenMap.js");\n/* harmony import */ var _GetElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetElement.js */ "./lib/rexui/templates/ui/basesizer/GetElement.js");\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/basesizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/basesizer/GetChildrenHeight.js");\n/* harmony import */ var _GetAllChildrenSizers_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./GetAllChildrenSizers.js */ "./lib/rexui/templates/ui/basesizer/GetAllChildrenSizers.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/templates/ui/basesizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/basesizer/Layout.js");\n/* harmony import */ var _LayoutInit_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./LayoutInit.js */ "./lib/rexui/templates/ui/basesizer/LayoutInit.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/templates/ui/basesizer/_layoutInit.js");\n/* harmony import */ var _PopUp_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./PopUp.js */ "./lib/rexui/templates/ui/basesizer/PopUp.js");\n/* harmony import */ var _ScaleDownDestroy_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./ScaleDownDestroy.js */ "./lib/rexui/templates/ui/basesizer/ScaleDownDestroy.js");\n/* harmony import */ var _FadeIn_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./FadeIn.js */ "./lib/rexui/templates/ui/basesizer/FadeIn.js");\n/* harmony import */ var _FadeOutDestroy_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./FadeOutDestroy.js */ "./lib/rexui/templates/ui/basesizer/FadeOutDestroy.js");\n/* harmony import */ var _IsInTouching_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./IsInTouching.js */ "./lib/rexui/templates/ui/basesizer/IsInTouching.js");\n/* harmony import */ var _GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./GetTopmostSizer.js */ "./lib/rexui/templates/ui/basesizer/GetTopmostSizer.js");\n/* harmony import */ var _LayoutBackgrounds_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./LayoutBackgrounds.js */ "./lib/rexui/templates/ui/basesizer/LayoutBackgrounds.js");\n/* harmony import */ var _SetDraggable_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./SetDraggable.js */ "./lib/rexui/templates/ui/basesizer/SetDraggable.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getSizerConfig: _utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    pushIntoBounds: _PushIntoBounds_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    drawBounds: _DrawBounds_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    addChildrenMap: _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    addElement: _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    getElement: _GetElement_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    getAllChildrenSizers: _GetAllChildrenSizers_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_8__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_9__["default"],\r\n    layoutBackgrounds: _LayoutBackgrounds_js__WEBPACK_IMPORTED_MODULE_18__["default"],\r\n    layoutInit: _LayoutInit_js__WEBPACK_IMPORTED_MODULE_10__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_11__["default"],\r\n\r\n    popUp: _PopUp_js__WEBPACK_IMPORTED_MODULE_12__["default"],\r\n    scaleDownDestroy: _ScaleDownDestroy_js__WEBPACK_IMPORTED_MODULE_13__["default"],\r\n    fadeIn: _FadeIn_js__WEBPACK_IMPORTED_MODULE_14__["default"],\r\n    fadeOutDestroy: _FadeOutDestroy_js__WEBPACK_IMPORTED_MODULE_15__["default"],\r\n    isInTouching: _IsInTouching_js__WEBPACK_IMPORTED_MODULE_16__["default"],\r\n    getTopmostSizer: _GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_17__["default"],\r\n    setDraggable: _SetDraggable_js__WEBPACK_IMPORTED_MODULE_19__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/Methods.js?')},"./lib/rexui/templates/ui/basesizer/PopUp.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_popup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/popup.js */ \"./lib/rexui/plugins/popup.js\");\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (function (duration, orientation, ease) {\r\n    if (IsPlainObject(duration)) {\r\n        var config = duration;\r\n        duration = GetValue(config, 'duration', undefined);\r\n        orientation = GetValue(config, 'orientation', undefined);\r\n        ease = GetValue(config, 'ease', undefined);\r\n    }\r\n\r\n    this._scale = Object(_plugins_popup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, duration, orientation, ease, this._scale);\r\n    return this;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/PopUp.js?")},"./lib/rexui/templates/ui/basesizer/PushIntoBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/utils/defaultbounds/GetDefaultBounds.js */ "./lib/rexui/plugins/utils/defaultbounds/GetDefaultBounds.js");\n\r\n\r\nvar PushIntoBounds = function (bounds) {\r\n    if (bounds === undefined) {\r\n        bounds = Object(_plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.scene);\r\n    }\r\n\r\n    this.left = Math.max(this.left, bounds.left);\r\n    this.right = Math.min(this.right, bounds.right);\r\n    this.top = Math.max(this.top, bounds.top);\r\n    this.bottom = Math.min(this.bottom, bounds.bottom);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PushIntoBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/PushIntoBounds.js?')},"./lib/rexui/templates/ui/basesizer/ScaleDownDestroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_scale_down_destroy_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/scale-down-destroy.js */ \"./lib/rexui/plugins/scale-down-destroy.js\");\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (function (duration, orientation, ease, destroyMode) {\r\n    if (IsPlainObject(duration)) {\r\n        var config = duration;\r\n        duration = GetValue(config, 'duration', undefined);\r\n        orientation = GetValue(config, 'orientation', undefined);\r\n        ease = GetValue(config, 'ease', undefined);\r\n        destroyMode = GetValue(config, 'destroy', undefined);\r\n    }\r\n\r\n    this._scale = Object(_plugins_scale_down_destroy_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, duration, orientation, ease, destroyMode, this._scale);\r\n    return this;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/ScaleDownDestroy.js?")},"./lib/rexui/templates/ui/basesizer/SetDraggable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetDraggable = function (draggable) {\r\n    if (draggable === undefined) {\r\n        draggable = true;\r\n    }\r\n\r\n    if (this.input && this.input.hasOwnProperty('draggable')) {\r\n        // Draggable is already registered\r\n        this.input.draggable = draggable;\r\n    } else if (draggable) {\r\n        // Register draggable\r\n        this.setInteractive();\r\n        this.scene.input.setDraggable(this);\r\n        this.on('drag', onDrag, this);\r\n    } else {\r\n        // Not draggable and draggable is not registered yet, do nothing\r\n    }\r\n    return this;\r\n}\r\n\r\nvar onDrag = function (pointer, dragX, dragY) {\r\n    var topmostParent = this.getTopmostSizer();\r\n    topmostParent.x += (dragX - this.x);\r\n    topmostParent.y += (dragY - this.y);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetDraggable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/SetDraggable.js?")},"./lib/rexui/templates/ui/basesizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar _layoutInit = function () {}\r\n/* harmony default export */ __webpack_exports__["default"] = (_layoutInit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/basesizer/_layoutInit.js?')},"./lib/rexui/templates/ui/bbcodetext/BBCodeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_text_bbocdetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/text/bbocdetext/BBCodeText.js */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_text_bbocdetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/bbcodetext/BBCodeText.js?')},"./lib/rexui/templates/ui/bbcodetext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ "./lib/rexui/templates/ui/bbcodetext/BBCodeText.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'BBCodeText\', function (x, y, text, style) {\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.BBCodeText\', _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/bbcodetext/Factory.js?')},"./lib/rexui/templates/ui/buttons/ButtonMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ButtonSetInteractive.js */ "./lib/rexui/templates/ui/buttons/ButtonSetInteractive.js");\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Hide.js */ "./lib/rexui/templates/ui/utils/Hide.js");\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getButton(index) {\r\n        var button;\r\n        if (typeof (index) === \'number\') {\r\n            button = this.childrenMap.buttons[index];\r\n        } else {\r\n            button = index;\r\n            if (this.childrenMap.buttons.indexOf(button) === -1) {\r\n                button = undefined;\r\n            }\r\n        }\r\n        return button;\r\n    },\r\n\r\n    emitButtonClick(index) {\r\n        // index or button game object\r\n        _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_0__["FireEvent"].call(this, \'button.click\', index);\r\n        return this;\r\n    },\r\n\r\n    showButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["Show"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["Hide"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    isButtonShown(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["IsShown"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    forEachButtton(callback, scope) {\r\n        var buttons = this.childrenMap.buttons;\r\n        for (var i = 0, cnt = buttons.length; i < cnt; i++) {\r\n            if (scope) {\r\n                callback.call(scope, buttons[i], i, buttons);\r\n            } else {\r\n                callback(buttons[i], i, buttons);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/buttons/ButtonMethods.js?')},"./lib/rexui/templates/ui/buttons/ButtonSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ButtonSetInteractive\", function() { return ButtonSetInteractive; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FireEvent\", function() { return FireEvent; });\n/* harmony import */ var _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/button/Button.js */ \"./lib/rexui/plugins/input/button/Button.js\");\n\r\n\r\nvar ButtonSetInteractive = function (button, clickConfig) {\r\n    //Default: Fire 'click' event when touch released after pressed.\r\n    button._buttonBehavior = new _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](button, clickConfig);\r\n\r\n    button._buttonBehavior.on('click', function (buttonBehavior, gameObject, pointer) {\r\n        FireEvent.call(this, 'button.click', button, pointer);\r\n    }, this);\r\n\r\n    button\r\n        .on('pointerover', function (pointer) {\r\n            FireEvent.call(this, 'button.over', button, pointer);\r\n        }, this)\r\n        .on('pointerout', function (pointer) {\r\n            FireEvent.call(this, 'button.out', button, pointer);\r\n        }, this)\r\n}\r\n\r\nvar FireEvent = function (eventName, button, pointer) {\r\n    var index;\r\n    if (typeof (button) === 'number') {\r\n        index = button;\r\n        button = this.childrenMap.buttons[index];\r\n        if (!button) {\r\n            return;\r\n        }\r\n    } else {\r\n        index = this.childrenMap.buttons.indexOf(button);\r\n        if (index === -1) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    if (this.groupName !== undefined) {\r\n        this.eventEmitter.emit(eventName, button, this.groupName, index, pointer);\r\n    } else {\r\n        this.eventEmitter.emit(eventName, button, index, pointer);\r\n    }\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/buttons/ButtonSetInteractive.js?")},"./lib/rexui/templates/ui/buttons/Buttons.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _utils_Space_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Space.js */ \"./lib/rexui/templates/ui/utils/Space.js\");\n/* harmony import */ var _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ButtonSetInteractive.js */ \"./lib/rexui/templates/ui/buttons/ButtonSetInteractive.js\");\n/* harmony import */ var _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ButtonMethods.js */ \"./lib/rexui/templates/ui/buttons/ButtonMethods.js\");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Buttons extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        // Create \r\n        super(scene, config);\r\n        this.type = 'rexButtons';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n        this.groupName = GetValue(config, 'groupName', undefined);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var buttons = GetValue(config, 'buttons', undefined);\r\n        if (buttons && buttons.length === 0) {\r\n            buttons = undefined;\r\n        }\r\n\r\n        // Space\r\n        var buttonSpace = GetValue(config, 'space', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (buttons) {\r\n            var buttonsAlign = GetValue(config, 'align', undefined); // undefined/left/top: no space\r\n            var clickConfig = GetValue(config, 'click', undefined);\r\n\r\n            // Add space\r\n            if (\r\n                (buttonsAlign === 'right') ||\r\n                (buttonsAlign === 'bottom') ||\r\n                (buttonsAlign === 'center')\r\n            ) {\r\n                this.add(Object(_utils_Space_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(scene), 1, 'center', 0, false);\r\n            }\r\n\r\n            var button, padding;\r\n            for (var i = 0, cnt = buttons.length; i < cnt; i++) {\r\n                button = buttons[i];\r\n                // Add to sizer\r\n                if (this.orientation === 0) {\r\n                    padding = {\r\n                        left: (i >= 1) ? buttonSpace : 0,\r\n                        right: 0,\r\n                        top: 0,\r\n                        bottom: 0\r\n                    }\r\n                } else {\r\n                    padding = {\r\n                        left: 0,\r\n                        right: 0,\r\n                        top: (i >= 1) ? buttonSpace : 0,\r\n                        bottom: 0\r\n                    }\r\n                }\r\n                this.add(button, 0, 'center', padding, true);\r\n                _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_2__[\"ButtonSetInteractive\"].call(this, button, clickConfig);\r\n            }\r\n\r\n            // Add space\r\n            if (buttonsAlign === 'center') {\r\n                this.add(Object(_utils_Space_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(scene), 1, 'center', 0, false);\r\n            }\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('buttons', (buttons) ? buttons : []);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Buttons.prototype,\r\n    _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Buttons);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/buttons/Buttons.js?")},"./lib/rexui/templates/ui/buttons/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Buttons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Buttons.js */ "./lib/rexui/templates/ui/buttons/Buttons.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'buttons\', function (config) {\r\n    var gameObject = new _Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Buttons\', _Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/buttons/Factory.js?')},"./lib/rexui/templates/ui/chart/Chart.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/canvas/Canvas.js */ "./lib/rexui/plugins/gameobjects/canvas/Canvas.js");\n/* harmony import */ var _SetChart_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetChart.js */ "./lib/rexui/templates/ui/chart/SetChart.js");\n/* harmony import */ var _GetChartDataset_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChartDataset.js */ "./lib/rexui/templates/ui/chart/GetChartDataset.js");\n/* harmony import */ var _GetChartData_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetChartData.js */ "./lib/rexui/templates/ui/chart/GetChartData.js");\n/* harmony import */ var _SetChartData_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SetChartData.js */ "./lib/rexui/templates/ui/chart/SetChartData.js");\n/* harmony import */ var _UpdateChart_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./UpdateChart.js */ "./lib/rexui/templates/ui/chart/UpdateChart.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// This plugin does not contain chart.js\r\n// Load chart.js in preload stage -\r\n// scene.load.script(\'chartjs\', \'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js\');\r\n\r\nclass Chart extends _plugins_gameobjects_canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, width, height, config) {\r\n        super(scene, x, y, width, height);\r\n        this.type = \'rexChart\';\r\n        this.chart = undefined;\r\n\r\n        if (config !== undefined) {\r\n            this.setChart(config);\r\n        }\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.chart) {\r\n            this.chart.destroy();\r\n            this.chart = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((width === this.width) && (height === this.height)) {\r\n            return this;\r\n        }\r\n\r\n        super.resize(width, height);\r\n\r\n        if (this.chart) {\r\n            var chart = this.chart;\r\n            chart.height = this.canvas.height;\r\n            chart.width = this.canvas.width;\r\n            chart.aspectRatio = (chart.height) ? chart.width / chart.height : null;\r\n            chart.update();\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    setChart: _SetChart_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChartDataset: _GetChartDataset_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChartData: _GetChartData_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    setChartData: _SetChartData_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    updateChart: _UpdateChart_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n}\r\nObject.assign(\r\n    Chart.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Chart);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/Chart.js?')},"./lib/rexui/templates/ui/chart/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Chart_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Chart.js */ "./lib/rexui/templates/ui/chart/Chart.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'chart\', function (x, y, width, height, config) {\r\n    var gameObject = new _Chart_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Chart\', _Chart_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Chart_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/Factory.js?')},"./lib/rexui/templates/ui/chart/GetChartData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetChartData = function (datasetIndex, dataIndex) {\r\n    var dataset = this.getChartDataset(datasetIndex);\r\n    if (dataset === undefined) {\r\n        return undefined;\r\n    }\r\n    if (typeof (dataIndex) === 'string') {\r\n        var labels = this.chart.data.labels;\r\n        dataIndex = labels.indexOf(dataIndex);\r\n        if (dataIndex === -1) {\r\n            return undefined;\r\n        }\r\n    }\r\n    return dataset.data[dataIndex];\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetChartData);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/GetChartData.js?")},"./lib/rexui/templates/ui/chart/GetChartDataset.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetChartDataset = function (datasetIndex) {\r\n    if (this.chart === undefined) {\r\n        return undefined;\r\n    }\r\n\r\n    if (typeof (datasetIndex) === 'string') {\r\n        var datasets = this.chart.data.datasets, dataset;\r\n        for (var i = 0, cnt = datasets.length; i < cnt; i++) {\r\n            dataset = datasets[i];\r\n            if (dataset.label === datasetIndex) {\r\n                return dataset;\r\n            }\r\n        }\r\n    } else {\r\n        return this.chart.data.datasets[datasetIndex];\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetChartDataset);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/GetChartDataset.js?")},"./lib/rexui/templates/ui/chart/SetChart.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetChart = function (config) {\r\n    if (!window.Chart) {\r\n        var msg = `Can not find chartjs! Load chartjs in preload stage.\r\nscene.load.script('chartjs', 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js');`\r\n        console.error(msg);\r\n        return this;\r\n    }\r\n\r\n    if (this.chart) {\r\n        this.chart.destroy();        \r\n    }\r\n    this.chart = new Chart(this.context, FillConfig(this, config));\r\n    return this;\r\n}\r\n\r\nvar FillConfig = function (canvas, config) {\r\n    // Get options\r\n    if (config === undefined) {\r\n        config = {};\r\n    }\r\n    if (config.options === undefined) {\r\n        config.options = {};\r\n    }\r\n    var options = config.options;\r\n\r\n    // Fill options\r\n    options.responsive = false;\r\n    options.maintainAspectRatio = false;\r\n    if (!options.hasOwnProperty('devicePixelRatio')) {\r\n        options.devicePixelRatio = 1;\r\n    }\r\n\r\n    // Get animation config\r\n    var noAnimation = false;\r\n    if (options.animation === undefined) {\r\n        options.animation = {};\r\n    } else if (options.animation === false) {\r\n        noAnimation = true;\r\n        options.animation = {};\r\n    }\r\n    var animationConfig = options.animation;\r\n\r\n    // Fill animation config\r\n    if (noAnimation) {\r\n        animationConfig.duration = 0;\r\n    }\r\n\r\n    var onProgress = animationConfig.onProgress;\r\n    animationConfig.onProgress = function (animation) {\r\n        if (onProgress) {\r\n            onProgress(animation);\r\n        }\r\n        canvas.needRedraw();\r\n    }\r\n\r\n    var onComplete = animationConfig.onComplete;\r\n    animationConfig.onComplete = function (animation) {\r\n        if (onComplete) {\r\n            onComplete(animation);\r\n        }\r\n        canvas.needRedraw();\r\n    }\r\n    return config;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetChart);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/SetChart.js?")},"./lib/rexui/templates/ui/chart/SetChartData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetChartData = function (datasetIndex, dataIndex, value) {\r\n    if (this.chart === undefined) {\r\n        return this;\r\n    }\r\n\r\n    var dataset = this.getChartDataset(datasetIndex);\r\n    if (typeof (dataIndex) === 'string') {\r\n        var labels = this.chart.data.labels;\r\n        dataIndex = labels.indexOf(dataIndex);\r\n        if (dataIndex === -1) {\r\n            return this;\r\n        }\r\n    }\r\n    dataset.data[dataIndex] = value;\r\n    return this;\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetChartData);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/SetChartData.js?")},"./lib/rexui/templates/ui/chart/UpdateChart.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar UpdateChart = function () {\r\n    if (this.chart === undefined) {\r\n        return this;\r\n    }\r\n    this.chart.update();\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateChart);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/chart/UpdateChart.js?')},"./lib/rexui/templates/ui/circlemaskimage/CircleMaskImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_circlemaskimage_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/circlemaskimage/CircleMaskImage.js */ "./lib/rexui/plugins/gameobjects/circlemaskimage/CircleMaskImage.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_circlemaskimage_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/circlemaskimage/CircleMaskImage.js?')},"./lib/rexui/templates/ui/circlemaskimage/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CircleMaskImage.js */ "./lib/rexui/templates/ui/circlemaskimage/CircleMaskImage.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'circleMaskImage\', function (x, y, key, frame, config) {\r\n    var gameObject = new _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, key, frame, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.CircleMaskImage\', _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/circlemaskimage/Factory.js?')},"./lib/rexui/templates/ui/container/Container.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/containerlite/ContainerLite.js */ "./lib/rexui/plugins/gameobjects/containerlite/ContainerLite.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/container/Container.js?')},"./lib/rexui/templates/ui/container/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Container.js */ "./lib/rexui/templates/ui/container/Container.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'container\', function (x, y, width, height, children) {\r\n    var gameObject = new _Container_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, children);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Container\', _Container_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Container_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/container/Factory.js?')},"./lib/rexui/templates/ui/dialog/ButtonMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChoice(index) {\r\n        return this.childrenMap.choicesSizer.getButton(index);\r\n    },\r\n\r\n    getAction(index) {\r\n        return this.childrenMap.actionsSizer.getButton(index);\r\n    },\r\n\r\n    emitChoiceClick(index) {\r\n        this.childrenMap.choicesSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    emitActionClick(index) {\r\n        this.childrenMap.actionsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    showChoice(index) {\r\n        this.childrenMap.choicesSizer.showButton(index);\r\n        return this;\r\n    },\r\n\r\n    showAction(index) {\r\n        this.childrenMap.actionsSizer.showButton(index);\r\n        return this;\r\n    },\r\n\r\n    hideChoice(index) {\r\n        this.childrenMap.choicesSizer.hideButton(index);\r\n        return this;\r\n    },\r\n\r\n    hideAction(index) {\r\n        this.childrenMap.actionsSizer.hideButton(index);\r\n        return this;\r\n    },\r\n\r\n    forEachChoice(callback, scope) {\r\n        this.childrenMap.choicesSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n\r\n    forEachChoice(callback, scope) {\r\n        this.childrenMap.choicesSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n\r\n    forEachAction(callback, scope) {\r\n        this.childrenMap.actionsSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/dialog/ButtonMethods.js?')},"./lib/rexui/templates/ui/dialog/Dialog.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../buttons/Buttons.js */ \"./lib/rexui/templates/ui/buttons/Buttons.js\");\n/* harmony import */ var _utils_Space_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Space.js */ \"./lib/rexui/templates/ui/utils/Space.js\");\n/* harmony import */ var _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ButtonMethods.js */ \"./lib/rexui/templates/ui/dialog/ButtonMethods.js\");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Dialog extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        // Create sizer        \r\n        config.orientation = 1; // Top to bottom\r\n        super(scene, config);\r\n        this.type = 'rexDialog';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var title = GetValue(config, 'title', undefined);\r\n        var toolbar = GetValue(config, 'toolbar', undefined);\r\n        if (toolbar && toolbar.length === 0) {\r\n            toolbar = undefined;\r\n        }\r\n        var content = GetValue(config, 'content', undefined);\r\n        var description = GetValue(config, 'description', undefined);\r\n        var choicesSizer;\r\n        var choices = GetValue(config, 'choices', undefined);\r\n        if (choices && choices.length === 0) {\r\n            choices = undefined;\r\n        }\r\n        var actionsSizer;\r\n        var actions = GetValue(config, 'actions', undefined);\r\n        if (actions && actions.length === 0) {\r\n            actions = undefined;\r\n        }\r\n        var clickConfig = GetValue(config, 'click', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        // title only\r\n        if (title && !toolbar) {\r\n            var align = GetValue(config, 'align.title', 'center');\r\n            var titleSpace = GetValue(config, 'space.title', 0);\r\n            var padding = {\r\n                left: paddingLeft,\r\n                right: paddingRight,\r\n                top: paddingTop,\r\n                bottom: (content || description || choices || actions) ? titleSpace : paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.title', true);\r\n            this.add(title, 0, align, padding, expand);\r\n        }\r\n\r\n        var toolbarSizer;\r\n        if (toolbar) {\r\n            toolbarSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'toolbar',\r\n                buttons: toolbar,\r\n                orientation: 0, // Left-right\r\n                space: GetValue(config, 'space.toolbarItem', 0),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n        }\r\n\r\n        // toolbar only\r\n        if (toolbar && !title) {\r\n            var titleSpace = GetValue(config, 'space.title', 0);\r\n            var padding = {\r\n                left: paddingLeft,\r\n                right: paddingRight,\r\n                top: paddingTop,\r\n                bottom: (content || description || choices || actions) ? titleSpace : paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.toolbar', true);\r\n            this.add(toolbarSizer, 0, 'center', padding, expand);\r\n        }\r\n\r\n        // tilte and toolbar\r\n        if (title && toolbar) {\r\n            var titleSizer = new _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](scene, {\r\n                orientation: 0\r\n            });\r\n            // Add title\r\n            var align = GetValue(config, 'align.title', 'left');\r\n            var expand = GetValue(config, 'expand.title', true);\r\n            // Add space if not expand\r\n            if (\r\n                !expand &&\r\n                ((align === 'right') || (align === 'center'))\r\n            ) {\r\n                titleSizer.add(Object(_utils_Space_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(scene), 1, 'center', 0, false);\r\n            }\r\n            var padding = {\r\n                left: GetValue(config, 'space.titleLeft', 0),\r\n                right: GetValue(config, 'space.titleRight', 0),\r\n                top: 0,\r\n                bottom: 0\r\n            }\r\n            titleSizer.add(title, (expand) ? 1 : 0, 'center', padding, expand);\r\n            // Add space if not expand\r\n            if (\r\n                !expand &&\r\n                ((align === 'left') || (align === 'center'))\r\n            ) {\r\n                titleSizer.add(Object(_utils_Space_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(scene), 1, 'center', 0, false);\r\n            }\r\n            // Add toolbar\r\n            titleSizer.add(toolbarSizer, 0, 'right', 0, false);\r\n            // Add sizer to dialog\r\n            var titleSpace = GetValue(config, 'space.title', 0);\r\n            var padding = {\r\n                left: paddingLeft,\r\n                right: paddingRight,\r\n                top: paddingTop,\r\n                bottom: (content || description || choices || actions) ? titleSpace : paddingBottom\r\n            };\r\n            this.add(titleSizer, 0, 'center', padding, true);\r\n        }\r\n\r\n        if (content) {\r\n            var align = GetValue(config, 'align.content', 'center');\r\n            var contentSpace = GetValue(config, 'space.content', 0);\r\n            var padding = {\r\n                left: paddingLeft + GetValue(config, 'space.contentLeft', 0),\r\n                right: paddingRight + GetValue(config, 'space.contentRight', 0),\r\n                top: (title || toolbar) ? 0 : paddingTop,\r\n                bottom: (description || choices || actions) ? contentSpace : paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.content', true);\r\n            this.add(content, 0, align, padding, expand);\r\n        }\r\n\r\n        if (description) {\r\n            var align = GetValue(config, 'align.description', 'center');\r\n            var descriptionSpace = GetValue(config, 'space.description', 0);\r\n            var padding = {\r\n                left: paddingLeft + GetValue(config, 'space.descriptionLeft', 0),\r\n                right: paddingRight + GetValue(config, 'space.descriptionRight', 0),\r\n                top: (title || toolbar || content) ? 0 : paddingTop,\r\n                bottom: (choices || actions) ? descriptionSpace : paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.description', true);\r\n            this.add(description, 0, align, padding, expand);\r\n        }\r\n\r\n        if (choices) {\r\n            var align = GetValue(config, 'align.choices', 'center');\r\n            choicesSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'choices',\r\n                buttons: choices,\r\n                orientation: 1, // Top-Bottom\r\n                space: GetValue(config, 'space.choice', 0),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n            var choicesSpace = GetValue(config, 'space.choices', 0);\r\n            var padding = {\r\n                left: paddingLeft + GetValue(config, 'space.choicesLeft', 0),\r\n                right: paddingRight + GetValue(config, 'space.choicesRight', 0),\r\n                top: (title || toolbar || content || description) ? 0 : paddingTop,\r\n                bottom: (actions) ? choicesSpace : paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.choices', true);\r\n            this.add(choicesSizer, 0, align, padding, expand);\r\n        }\r\n\r\n        if (actions) {\r\n            actionsSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'actions',\r\n                buttons: actions,\r\n                orientation: 0, // Left-right\r\n                space: GetValue(config, 'space.action', 0),\r\n                align: GetValue(config, 'align.actions', 'center'),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            })\r\n            var padding = {\r\n                left: paddingLeft + GetValue(config, 'space.actionsLeft', 0),\r\n                right: paddingRight + GetValue(config, 'space.actionsRight', 0),\r\n                top: (title || toolbar || content || description || choices) ? 0 : paddingTop,\r\n                bottom: paddingBottom\r\n            }\r\n            var expand = GetValue(config, 'expand.actions', true);\r\n            this.add(actionsSizer, 0, 'center', padding, expand);\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('title', title);\r\n        this.addChildrenMap('toolbar', toolbar);\r\n        this.addChildrenMap('content', content);\r\n        this.addChildrenMap('choices', choices);\r\n        this.addChildrenMap('actions', actions);\r\n        this.addChildrenMap('choicesSizer', choicesSizer);\r\n        this.addChildrenMap('actionsSizer', actionsSizer);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Dialog.prototype,\r\n    _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Dialog);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/dialog/Dialog.js?")},"./lib/rexui/templates/ui/dialog/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Dialog_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dialog.js */ "./lib/rexui/templates/ui/dialog/Dialog.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'dialog\', function (config) {\r\n    var gameObject = new _Dialog_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Dialog\', _Dialog_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Dialog_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/dialog/Factory.js?')},"./lib/rexui/templates/ui/fixwidthsizer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _FixWidthSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FixWidthSizer.js */ "./lib/rexui/templates/ui/fixwidthsizer/FixWidthSizer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'fixWidthSizer\', function (x, y, minWidth, minHeight, orientation, space) {\r\n    var gameObject = new _FixWidthSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, orientation, space);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.FixWidthSizer\', _FixWidthSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_FixWidthSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/Factory.js?')},"./lib/rexui/templates/ui/fixwidthsizer/FixWidthSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/fixwidthsizer/Methods.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/templates/ui/utils/GetBoundsConfig.js\");\n/* harmony import */ var _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/OrientationConst.js */ \"./lib/rexui/templates/ui/utils/OrientationConst.js\");\n/* harmony import */ var _GetMaxChildWidth_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetMaxChildWidth.js */ \"./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildWidth.js\");\n/* harmony import */ var _GetMaxChildHeight_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./GetMaxChildHeight.js */ \"./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildHeight.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveItem = Phaser.Utils.Array.Remove;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nclass FixWidthSizer extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, orientation, space) {\r\n        var config;\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(orientation)) {\r\n            config = orientation;\r\n        } else if (IsPlainObject(space)) {\r\n            config = space;\r\n        }\r\n\r\n        if (config !== undefined) {\r\n            orientation = GetValue(config, 'orientation', 0);\r\n            space = GetValue(config, 'space', config);\r\n        }\r\n        if (orientation === undefined) {\r\n            orientation = 0;\r\n        }\r\n        if (space === undefined) {\r\n            space = 0;\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexFixWidthSizer';\r\n        this.sizerChildren = [];\r\n        this.setOrientation(orientation);\r\n        this.setPadding(space);\r\n        this.setItemSpacing(GetValue(space, 'item', 0));\r\n        this.setLineSpacing(GetValue(space, 'line', 0));\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.sizerChildren.length = 0;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if (typeof (orientation) === 'string') {\r\n            orientation = _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"][orientation];\r\n        }\r\n        this.orientation = orientation;\r\n        return this;\r\n    }\r\n\r\n    setPadding(paddingConfig) {\r\n        this.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig, this.padding);\r\n        return this;\r\n    }\r\n\r\n    setItemSpacing(space) {\r\n        this.itemSpacing = space;\r\n        return this;\r\n    }\r\n\r\n    setLineSpacing(space) {\r\n        this.lineSpacing = space;\r\n        return this;\r\n    }\r\n\r\n    add(gameObject, paddingConfig) {\r\n        if (gameObject === '\\n') {\r\n            this.addNewLine();\r\n            return this;\r\n        }\r\n\r\n        super.add(gameObject);\r\n        if (paddingConfig === undefined) {\r\n            paddingConfig = 0;\r\n        }\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        config.align = ALIGN_CENTER;\r\n        config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig);\r\n        this.sizerChildren.push(gameObject);\r\n        return this;\r\n    }\r\n\r\n    addNewLine() {\r\n        this.sizerChildren.push('\\n');\r\n        return this;\r\n    }\r\n\r\n    insert(index, gameObject, paddingConfig, expand) {\r\n        this.add(gameObject, paddingConfig, expand);\r\n        this.moveTo(gameObject, index);\r\n        return this;\r\n    }\r\n\r\n    remove(gameObject) {\r\n        var config = this.getSizerConfig(gameObject);\r\n        if (config.parent !== this) {\r\n            return this;\r\n        }\r\n        config.parent = undefined;\r\n        RemoveItem(this.sizerChildren, gameObject);\r\n        super.remove(gameObject);\r\n        return this;\r\n    }\r\n\r\n    clear(destroyChild) {\r\n        var children = this.sizerChildren, child;\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (child === '\\n') {\r\n                continue;\r\n            }\r\n            this.getSizerConfig(child).parent = undefined;\r\n        }\r\n        children.length = 0;\r\n        super.clear(destroyChild);\r\n        return this;\r\n    }\r\n\r\n    get maxChildWidth() {\r\n        if (this._maxChildWidth === undefined) {\r\n            this._maxChildWidth = _GetMaxChildWidth_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].call(this);\r\n        }\r\n        return this._maxChildWidth;\r\n    }\r\n\r\n    get maxChildHeight() {\r\n        if (this._maxChildHeight === undefined) {\r\n            this._maxChildHeight = _GetMaxChildHeight_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].call(this);\r\n        }\r\n        return this._maxChildHeight;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    FixWidthSizer.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (FixWidthSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/FixWidthSizer.js?")},"./lib/rexui/templates/ui/fixwidthsizer/GetChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildHeight = function (child) {\r\n    var padding = child.rexSizer.padding;\r\n    return child.height + padding.top + padding.bottom;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetChildHeight.js?')},"./lib/rexui/templates/ui/fixwidthsizer/GetChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildWidth = function (child) {\r\n    var padding = child.rexSizer.padding;\r\n    return child.width + padding.left + padding.right;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetChildWidth.js?')},"./lib/rexui/templates/ui/fixwidthsizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    if (this.orientation === 0) { // x\r\n        result = 0;\r\n    } else { // y\r\n        result = this.maxChildHeight;\r\n    }\r\n    result = Math.max(result, this.minHeight);\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetChildrenHeight.js?')},"./lib/rexui/templates/ui/fixwidthsizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.sizerChildren, child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child === '\\n') {\r\n            continue;\r\n        }\r\n        if (child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetChildrenSizers.js?")},"./lib/rexui/templates/ui/fixwidthsizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    if (this.orientation === 0) { // x\r\n        result = this.maxChildWidth;\r\n    } else { // y\r\n        result = 0;\r\n    }\r\n    result = Math.max(result, this.minWidth);\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetChildrenWidth.js?')},"./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildHeight_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildHeight.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildHeight.js");\n\r\n\r\nvar GetMaxChildHeight = function (children) {\r\n    if (children === undefined) {\r\n        children = this.sizerChildren;\r\n    }\r\n    var result = 0;\r\n    var child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child === \'\\n\') {\r\n            continue;\r\n        }\r\n        result = Math.max(result, Object(_GetChildHeight_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child));\r\n    }\r\n    return result;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetMaxChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildHeight.js?')},"./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildWidth.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildWidth.js");\n\r\n\r\nvar GetMaxChildWidth = function (children) {\r\n    if (children === undefined) {\r\n        children = this.sizerChildren;\r\n    }\r\n    var result = 0;\r\n    var child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child === \'\\n\') {\r\n            continue;\r\n        }\r\n        result = Math.max(result, Object(_GetChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child));\r\n    }\r\n    return result;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetMaxChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/GetMaxChildWidth.js?')},"./lib/rexui/templates/ui/fixwidthsizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _RunChildrenWrap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RunChildrenWrap.js */ "./lib/rexui/templates/ui/fixwidthsizer/RunChildrenWrap.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        var padding = this.padding;\r\n        newWidth = Math.max(this.maxChildWidth + padding.left + padding.right, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        var padding = this.padding;\r\n        newHeight = Math.max(this.maxChildHeight + padding.top + padding.bottom, this.minHeight);\r\n    }\r\n\r\n    var lineInnerWidth, padding = this.padding;\r\n    if (this.orientation === 0) { // x\r\n        lineInnerWidth = newWidth - padding.left - padding.right;\r\n    } else { // y\r\n        lineInnerWidth = newHeight - padding.top - padding.bottom;\r\n    }\r\n    var wrapResult = _RunChildrenWrap_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, lineInnerWidth);\r\n    // Expanded height is less then min-lines-height\r\n    if (this.orientation === 0) { // x\r\n        newHeight = Math.max(newHeight, wrapResult.height + padding.top + padding.bottom);\r\n    } else { // y\r\n        newWidth = Math.max(newWidth, wrapResult.height + left + padding.right);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout children    \r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var itemX, itemY;\r\n    var x, y, width, height; // Align zone\r\n\r\n    // Layout each line\r\n    var lines = wrapResult.lines;\r\n    var line, lineChlidren;\r\n    if (this.orientation === 0) { // x\r\n        itemX = startX\r\n        itemY = startY + this.padding.top;\r\n    } else {\r\n        itemX = startX + this.padding.left;\r\n        itemY = startY\r\n    }\r\n    for (var i = 0, icnt = lines.length; i < icnt; i++) {\r\n        line = lines[i];\r\n        lineChlidren = line.children;\r\n\r\n        for (var j = 0, jcnt = lineChlidren.length; j < jcnt; j++) {\r\n            child = lineChlidren[j];\r\n            childConfig = child.rexSizer;\r\n            padding = childConfig.padding;\r\n            if (this.orientation === 0) { // x\r\n                x = (itemX + padding.left);\r\n                if (j === 0) {\r\n                    x += this.padding.left;\r\n                } else {\r\n                    x += this.itemSpacing;\r\n                }\r\n\r\n                y = (itemY + padding.top);\r\n                width = child.width;\r\n                height = child.height;\r\n                itemX = x + child.width + padding.right;\r\n            } else { // y\r\n                x = (itemX + padding.left);\r\n\r\n                y = (itemY + padding.top);\r\n                if (j === 0) {\r\n                    y += this.padding.top;\r\n                } else {\r\n                    y += this.itemSpacing;\r\n                }\r\n\r\n                width = child.width;\r\n                height = child.height;\r\n                itemY = y + child.height + padding.bottom;\r\n            }\r\n\r\n            _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"].setPosition(x, y).setSize(width, height);\r\n            AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"], childConfig.align);\r\n            this.resetChildPositionState(child);\r\n        }\r\n\r\n        if (this.orientation === 0) { // x\r\n            itemX = startX;\r\n            itemY += line.height + this.lineSpacing;\r\n        } else { // y\r\n            itemX += line.height + this.lineSpacing;\r\n            itemY = startY;\r\n        }\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/Layout.js?')},"./lib/rexui/templates/ui/fixwidthsizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/fixwidthsizer/Layout.js");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/Methods.js?')},"./lib/rexui/templates/ui/fixwidthsizer/RunChildrenWrap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildWidth.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildWidth.js");\n/* harmony import */ var _GetChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildHeight.js */ "./lib/rexui/templates/ui/fixwidthsizer/GetChildHeight.js");\n\r\n\r\n\r\nvar RunChildrenWrap = function (lineWidth) {\r\n    var result = {\r\n        lines: [],\r\n        width: 0,\r\n        height: 0\r\n    };\r\n    var children = this.sizerChildren;\r\n    var child, childWidth, remainder = 0;\r\n    var lastLine, lines = result.lines, newLine;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child === \'\\n\') {\r\n            child = undefined;\r\n            childWidth = 0;\r\n            newLine = true;\r\n        } else {\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            if (child.isRexSizer) {\r\n                child.layout(); // Use original size\r\n            }\r\n\r\n            childWidth = GetChildWidth(child, this.orientation);\r\n            newLine = (remainder < childWidth);\r\n        }\r\n        // New line\r\n        if (newLine) {\r\n            if (lastLine) {\r\n                var curLineWidth = lineWidth - (remainder + this.itemSpacing);\r\n                result.width = Math.max(result.width, curLineWidth);\r\n                result.height += lastLine.height + this.lineSpacing;\r\n            }\r\n\r\n            lastLine = {\r\n                children: [],\r\n                remainder: 0,\r\n                height: 0\r\n            };\r\n            lines.push(lastLine);\r\n            remainder = lineWidth;\r\n        }\r\n\r\n        remainder -= childWidth + this.itemSpacing;\r\n        lastLine.remainder = remainder;\r\n        if (child) {\r\n            lastLine.children.push(child);\r\n            lastLine.height = Math.max(lastLine.height, GeChildHeight(child, this.orientation));\r\n        }\r\n    }\r\n\r\n    if (lastLine) {\r\n        result.height += lastLine.height;\r\n    }\r\n    return result;\r\n}\r\n\r\nvar GetChildWidth = function (child, orientation) {\r\n    return (orientation === 0) ? Object(_GetChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child) : Object(_GetChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(child);\r\n}\r\n\r\nvar GeChildHeight = function (child, orientation) {\r\n    return (orientation === 0) ? Object(_GetChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(child) : Object(_GetChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RunChildrenWrap);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/fixwidthsizer/RunChildrenWrap.js?')},"./lib/rexui/templates/ui/flip/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Flip.js */ "./lib/rexui/templates/ui/flip/Flip.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'flip\', function (gameObject, config) {\r\n    return new _Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Flip\', _Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/flip/Factory.js?')},"./lib/rexui/templates/ui/flip/Flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/flip.js */ "./lib/rexui/plugins/flip.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/flip/Flip.js?')},"./lib/rexui/templates/ui/gridsizer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GridSizer.js */ "./lib/rexui/templates/ui/gridsizer/GridSizer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'gridSizer\', function (x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportion) {\r\n    var gameObject = new _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportion);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.GridSizer\', _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/Factory.js?')},"./lib/rexui/templates/ui/gridsizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0,\r\n        rowHeight;\r\n    var children = this.gridChildren;\r\n    var child, padding, childHeight, proportion;\r\n\r\n    for (var i = 0; i < this.rowCount; i++) {\r\n        proportion = this.rowProportions[i];\r\n        rowHeight = 0;\r\n        if ((proportion === undefined) || (proportion === 0)) {\r\n            for (var j = 0; j < this.columnCount; j++) {\r\n                child = children[(i * this.columnCount) + j];\r\n                if (!child) {\r\n                    continue;\r\n                }\r\n                if (child.rexSizer.hidden) {\r\n                    continue;\r\n                }\r\n\r\n                childHeight = (child.isRexSizer) ?\r\n                    Math.max(child.minHeight, child.childrenHeight) :\r\n                    child.height;\r\n                padding = child.rexSizer.padding;\r\n                childHeight += (padding.top + padding.bottom);\r\n                rowHeight = Math.max(rowHeight, childHeight);\r\n            }\r\n            result += rowHeight;\r\n        }\r\n        this.rowHeight[i] = rowHeight;\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GetChildrenHeight.js?')},"./lib/rexui/templates/ui/gridsizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.gridChildren,\r\n        child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child && child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GetChildrenSizers.js?')},"./lib/rexui/templates/ui/gridsizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0,\r\n        columnWidth;\r\n    var children = this.gridChildren;\r\n    var child, padding, childWidth, proportion;\r\n\r\n    for (var i = 0; i < this.columnCount; i++) {\r\n        proportion = this.columnProportions[i];\r\n        columnWidth = 0;\r\n        if ((proportion === undefined) || (proportion === 0)) {\r\n            for (var j = 0; j < this.rowCount; j++) {\r\n                child = children[(j * this.columnCount) + i];\r\n                if (!child) {\r\n                    continue;\r\n                }\r\n                if (child.rexSizer.hidden) {\r\n                    continue;\r\n                }\r\n\r\n                childWidth = (child.isRexSizer) ?\r\n                    Math.max(child.minWidth, child.childrenWidth) :\r\n                    child.width;\r\n                padding = child.rexSizer.padding;\r\n                childWidth += (padding.left + padding.right);\r\n                columnWidth = Math.max(columnWidth, childWidth);\r\n            }\r\n            result += columnWidth;\r\n        }\r\n        this.columnWidth[i] = columnWidth;\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GetChildrenWidth.js?')},"./lib/rexui/templates/ui/gridsizer/GetExpandedChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildHeight = function (child, rowHeight) {\r\n    var newHeight;\r\n    var childConfig = child.rexSizer;    \r\n    if (childConfig.expand) {\r\n        var padding = childConfig.padding;\r\n        newHeight = rowHeight - padding.top - padding.bottom;\r\n    }\r\n    return newHeight;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GetExpandedChildHeight.js?')},"./lib/rexui/templates/ui/gridsizer/GetExpandedChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildWidth = function (child, colWidth) {\r\n    var newWidth;\r\n    var childConfig = child.rexSizer;    \r\n    if (childConfig.expand) {\r\n        var padding = childConfig.padding;\r\n        newWidth = colWidth - padding.left - padding.right;\r\n    }\r\n    return newWidth;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GetExpandedChildWidth.js?')},"./lib/rexui/templates/ui/gridsizer/GridSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/gridsizer/Methods.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/templates/ui/utils/GetBoundsConfig.js\");\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/templates/ui/utils/AlignConst.js\");\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveItem = Phaser.Utils.Array.Remove;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nclass GridSizer extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportions) {\r\n        var config;\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(columnCount)) {\r\n            config = columnCount;\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(columnProportions)) {\r\n            config = columnProportions;\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexGridSizer';\r\n        this.initialGrid(columnCount, rowCount, columnProportions, rowProportions);\r\n\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.gridChildren.length = 0;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setColumnProportion(columnIndex, proportion) {\r\n        if (columnIndex >= this.columnProportions.length) {\r\n            return this;\r\n        }\r\n        this.columnProportions[columnIndex] = proportion;\r\n        return this;\r\n    }\r\n\r\n    setRowProportion(rowIndex, proportion) {\r\n        if (rowIndex >= this.rowProportions.length) {\r\n            return this;\r\n        }\r\n        this.rowProportions[rowIndex] = proportion;\r\n        return this;\r\n    }\r\n\r\n    add(gameObject, columnIndex, rowIndex, align, paddingConfig, expand) {\r\n        super.add(gameObject);\r\n        if (IsPlainObject(columnIndex)) {\r\n            var config = columnIndex;\r\n            columnIndex = GetValue(config, 'column', 0);\r\n            rowIndex = GetValue(config, 'row', 0);\r\n            align = GetValue(config, 'align', ALIGN_CENTER);\r\n            paddingConfig = GetValue(config, 'padding', 0);\r\n            expand = GetValue(config, 'expand', false);\r\n        }\r\n        if (typeof (align) === 'string') {\r\n            align = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"][align];\r\n        }\r\n        if (align === undefined) {\r\n            align = ALIGN_CENTER;\r\n        }\r\n        if (paddingConfig === undefined) {\r\n            paddingConfig = 0;\r\n        }\r\n        if (expand === undefined) {\r\n            expand = true;\r\n        }\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        config.align = align;\r\n        config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig);\r\n        config.expand = expand;\r\n        this.gridChildren[(rowIndex * this.columnCount) + columnIndex] = gameObject;\r\n        return this;\r\n    }\r\n\r\n    remove(gameObject) {\r\n        var config = this.getSizerConfig(gameObject);\r\n        if (config.parent !== this) {\r\n            return this;\r\n        }\r\n        config.parent = undefined;\r\n        RemoveItem(this.gridChildren, gameObject);\r\n\r\n        if (this.backgroundChildren !== undefined) {\r\n            RemoveItem(this.backgroundChildren, gameObject);\r\n        }\r\n        super.remove(gameObject);\r\n        return this;\r\n    }\r\n\r\n    get totalColumnProportions() {\r\n        var result = 0,\r\n            proportion;\r\n        for (var i = 0; i < this.columnCount; i++) {\r\n            proportion = this.columnProportions[i];\r\n            if (proportion > 0) {\r\n                result += proportion;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    get totalRowProportions() {\r\n        var result = 0,\r\n            proportion;\r\n        for (var i = 0; i < this.rowCount; i++) {\r\n            proportion = this.rowProportions[i];\r\n            if (proportion > 0) {\r\n                result += proportion;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    initialGrid(columnCount, rowCount, columnProportions, rowProportions) {\r\n        this.columnCount = columnCount;\r\n        this.rowCount = rowCount;\r\n        this.gridChildren = [];\r\n        this.gridChildren.length = columnCount * rowCount;\r\n        this.columnProportions = [];\r\n        this.columnProportions.length = columnCount;\r\n        this.columnWidth = [];\r\n        this.columnWidth.length = columnCount;\r\n        this.rowProportions = [];\r\n        this.rowProportions.length = rowCount;\r\n        this.rowHeight = [];\r\n        this.rowHeight.length = rowCount;\r\n\r\n        if (columnProportions) {\r\n            var columnProportionsIsNumber = (typeof (columnProportions) === 'number');\r\n            for (var i = 0; i < columnCount; i++) {\r\n                if (columnProportionsIsNumber) {\r\n                    this.setColumnProportion(i, columnProportions);\r\n                } else {\r\n                    var columnProportion = columnProportions[i];\r\n                    if (columnProportion > 0) {\r\n                        this.setColumnProportion(i, columnProportion);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (rowProportions) {\r\n            var rowProportionsIsNumber = (typeof (rowProportions) === 'number');\r\n            for (var i = 0; i < rowCount; i++) {\r\n                if (rowProportionsIsNumber) {\r\n                    this.setRowProportion(i, rowProportions);\r\n                } else {\r\n                    var rowProportion = rowProportions[i];\r\n                    if (rowProportion > 0) {\r\n                        this.setRowProportion(i, rowProportion);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    GridSizer.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GridSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/GridSizer.js?")},"./lib/rexui/templates/ui/gridsizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetExpandedChildWidth.js */ "./lib/rexui/templates/ui/gridsizer/GetExpandedChildWidth.js");\n/* harmony import */ var _GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetExpandedChildHeight.js */ "./lib/rexui/templates/ui/gridsizer/GetExpandedChildHeight.js");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    var totalColumnProportions = this.totalColumnProportions;\r\n    var totalRowProportions = this.totalRowProportions;\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        if (parent && (totalColumnProportions > 0)) { // Expand to parent width\r\n            var padding = this.rexSizer.padding;\r\n            newWidth = parent.width - padding.left - padding.right;\r\n        } else {\r\n            newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n        }\r\n    }\r\n    if (newHeight === undefined) {\r\n        if (parent && (totalRowProportions > 0)) { // Expand to parent height\r\n            var padding = this.rexSizer.padding;\r\n            newHeight = parent.height - padding.top - padding.bottom;\r\n        } else {\r\n            newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n        }\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    var proportionWidthLength;\r\n    if (totalColumnProportions > 0) {\r\n        proportionWidthLength = (this.width - this.childrenWidth) / totalColumnProportions;\r\n    } else {\r\n        proportionWidthLength = 0;\r\n    }\r\n    var proportionHeightLength;\r\n    if (totalRowProportions > 0) {\r\n        proportionHeightLength = (this.height - this.childrenHeight) / totalRowProportions;\r\n    } else {\r\n        proportionHeightLength = 0;\r\n    }\r\n\r\n    // Layout children\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var itemX = startX,\r\n        itemY = startY;\r\n    var x, y, width, height; // Align zone\r\n    var childWidth, childHeight;\r\n    // Layout grid children\r\n    var colProportion, rowProportion,\r\n        colWidth, rowHeight;\r\n    for (var rowIndex = 0; rowIndex < this.rowCount; rowIndex++) {\r\n        rowProportion = this.rowProportions[rowIndex] || 0;\r\n        rowHeight = (rowProportion === 0) ? this.rowHeight[rowIndex] : (rowProportion * proportionHeightLength);\r\n\r\n        itemX = startX;\r\n        for (var columnIndex = 0; columnIndex < this.columnCount; columnIndex++) {\r\n            colProportion = this.columnProportions[columnIndex] || 0;\r\n            colWidth = (colProportion === 0) ? this.columnWidth[columnIndex] : (colProportion * proportionWidthLength);\r\n\r\n            child = this.gridChildren[(rowIndex * this.columnCount) + columnIndex];\r\n            if ((!child) || (child.rexSizer.hidden)) {\r\n                itemX += colWidth;\r\n                continue;\r\n            }\r\n\r\n            childWidth = Object(_GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, colWidth);\r\n            childHeight = Object(_GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(child, rowHeight);\r\n            if (child.isRexSizer) {\r\n                child.layout(this, childWidth, childHeight);\r\n            } else {\r\n                Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, childWidth, childHeight);\r\n            }\r\n\r\n            childConfig = child.rexSizer;\r\n            padding = childConfig.padding;\r\n            x = (itemX + padding.left);\r\n            width = colWidth - padding.left - padding.right;\r\n            y = (itemY + padding.top);\r\n            height = rowHeight - padding.top - padding.bottom;\r\n\r\n            _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"].setPosition(x, y).setSize(width, height);\r\n            AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"], childConfig.align);\r\n            this.resetChildPositionState(child);\r\n\r\n            itemX += colWidth;\r\n        }\r\n\r\n        itemY += rowHeight;\r\n    }\r\n\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/Layout.js?')},"./lib/rexui/templates/ui/gridsizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/gridsizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/gridsizer/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/templates/ui/gridsizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/gridsizer/Layout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/templates/ui/gridsizer/_layoutInit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/Methods.js?')},"./lib/rexui/templates/ui/gridsizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInitChild = function () {\r\n    this._childrenWidth = undefined;\r\n    this._childrenHeight = undefined;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInitChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridsizer/_layoutInit.js?')},"./lib/rexui/templates/ui/gridtable/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GridTable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GridTable.js */ "./lib/rexui/templates/ui/gridtable/GridTable.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'gridTable\', function (config) {\r\n    var gameObject = new _GridTable_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.GridTable\', _GridTable_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_GridTable_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/Factory.js?')},"./lib/rexui/templates/ui/gridtable/GridTable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ "./lib/rexui/templates/ui/utils/scrollable/Scrollable.js");\n/* harmony import */ var _utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/GetScrollMode.js */ "./lib/rexui/templates/ui/utils/GetScrollMode.js");\n/* harmony import */ var _plugins_gameobjects_gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/gameobjects/gridtable/GridTable.js */ "./lib/rexui/plugins/gameobjects/gridtable/GridTable.js");\n/* harmony import */ var _InjectProperties_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./InjectProperties.js */ "./lib/rexui/templates/ui/gridtable/InjectProperties.js");\n/* harmony import */ var _TableOnCellVisible_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableOnCellVisible.js */ "./lib/rexui/templates/ui/gridtable/TableOnCellVisible.js");\n/* harmony import */ var _input_TableSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./input/TableSetInteractive.js */ "./lib/rexui/templates/ui/gridtable/input/TableSetInteractive.js");\n/* harmony import */ var _plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../plugins/utils/object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n/* harmony import */ var _SetItems_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SetItems.js */ "./lib/rexui/templates/ui/gridtable/SetItems.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass GridTable extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create grid table core\r\n        var scrollMode = Object(_utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__["default"])(config);\r\n        var tableConfig = GetValue(config, \'table\', undefined)\r\n        if (tableConfig === undefined) {\r\n            tableConfig = {};\r\n        }\r\n        tableConfig.scrollMode = scrollMode;\r\n        tableConfig.clamplTableOXY = GetValue(config, \'clamplChildOY\', false);\r\n        var tableWidth = GetValue(tableConfig, \'width\', undefined);\r\n        var tableHeight = GetValue(tableConfig, \'height\', undefined);\r\n        var table = new _plugins_gameobjects_gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_2__["default"](scene, 0, 0, tableWidth, tableHeight, tableConfig);\r\n        var proportion, expand;\r\n        if (scrollMode === 0) {\r\n            proportion = (tableWidth === undefined) ? 1 : 0;\r\n            expand = (tableHeight === undefined);\r\n        } else {\r\n            proportion = (tableHeight === undefined) ? 1 : 0;\r\n            expand = (tableWidth === undefined);\r\n        }\r\n        // Inject properties for scrollable interface\r\n        Object(_InjectProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"])(table);\r\n\r\n        // Fill config of scrollable\r\n        config.type = \'rexGridTable\';\r\n        config.child = {\r\n            gameObject: table,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, \'space\', undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.table;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap(\'table\', table);\r\n\r\n        this.eventEmitter = GetValue(config, \'eventEmitter\', this);\r\n        var callback = GetValue(config, \'createCellContainerCallback\', _plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_6__["default"]);\r\n        var scope = GetValue(config, \'createCellContainerCallbackScope\', undefined);\r\n        this.setCreateCellContainerCallback(callback, scope);\r\n\r\n        _TableOnCellVisible_js__WEBPACK_IMPORTED_MODULE_4__["default"].call(this, table);\r\n\r\n        if (GetValue(tableConfig, \'interactive\', true)) {\r\n            _input_TableSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__["default"].call(this, table);\r\n        }\r\n        this.setItems(GetValue(config, \'items\', []));\r\n    }\r\n\r\n    setCreateCellContainerCallback(callback, scope) {\r\n        this.createCellContainerCallback = callback;\r\n        this.createCellContainerCallbackScope = scope;\r\n        return this;\r\n    }\r\n\r\n    refresh() {\r\n        var table = this.childrenMap.child;\r\n        table.updateTable(true);\r\n        return this;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    setItems: _SetItems_js__WEBPACK_IMPORTED_MODULE_7__["default"]\r\n}\r\nObject.assign(\r\n    GridTable.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GridTable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/GridTable.js?')},"./lib/rexui/templates/ui/gridtable/InjectProperties.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar InjectProperties = function (table) {\r\n    Object.defineProperty(table, 'childOY', {\r\n        configurable: true,\r\n        get: function () {\r\n            return table.tableOY;\r\n        },\r\n        set: function (value) {\r\n            table.tableOY = value;\r\n        }\r\n    });\r\n    Object.defineProperty(table, 'topChildOY', {\r\n        get: function () {\r\n            return table.topTableOY;\r\n        }\r\n    });\r\n    Object.defineProperty(table, 'bottomChildOY', {\r\n        get: function () {\r\n            return table.bottomTableOY;\r\n        }\r\n    });\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InjectProperties);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/InjectProperties.js?")},"./lib/rexui/templates/ui/gridtable/SetItems.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetItems = function (items) {\r\n    if (items === undefined) {\r\n        this.items.length = 0;\r\n    } else {\r\n        this.items = items;\r\n    }\r\n\r\n    var table = this.childrenMap.child;\r\n    table.setCellsCount(this.items.length);\r\n    table.updateTable(true);\r\n\r\n    this.resizeController();\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetItems);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/SetItems.js?')},"./lib/rexui/templates/ui/gridtable/TableOnCellVisible.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar TableOnCellVisible = function (table) {\r\n    table.on('cellvisible', function (cell, cellContainer) {\r\n        var callback = this.createCellContainerCallback;\r\n        var scope = this.createCellContainerCallbackScope;\r\n        cell.item = this.items[cell.index];\r\n        var container;\r\n        if (scope) {\r\n            container = callback.call(scope, cell, cellContainer);\r\n        } else {\r\n            container = callback(cell, cellContainer);\r\n        }\r\n        if (container.setOrigin) {\r\n            container.setOrigin(0);\r\n        }\r\n        if (container.isRexSizer) {\r\n            container.layout(); // Use original size\r\n        }\r\n\r\n        cell.item = undefined;\r\n        cell.setContainer(container);\r\n    }, this);\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TableOnCellVisible);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/TableOnCellVisible.js?")},"./lib/rexui/templates/ui/gridtable/input/ClickCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../plugins/input/button/Button.js */ "./lib/rexui/plugins/input/button/Button.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nvar ClickCell = function (table) {\r\n    table._click = new _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__["default"](table, {\r\n        threshold: 10\r\n    });\r\n    table._click.on(\'click\', function (button, gameObject, pointer) {\r\n        Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.click\', gameObject, pointer.x, pointer.y);\r\n    }, this);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ClickCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/ClickCell.js?')},"./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar EmitCellEvent = function (eventEmitter, eventName, table, x, y) {\r\n    var cellIndex;\r\n    if (y === undefined) {\r\n        cellIndex = x;\r\n    } else {\r\n        cellIndex = table.pointerToCellIndex(x, y);\r\n    }\r\n    if ((cellIndex === null) || (cellIndex === undefined)) {\r\n        return;\r\n    }\r\n    var cellContainer = table.getCellContainer(cellIndex);\r\n    eventEmitter.emit(eventName, cellContainer, cellIndex);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (EmitCellEvent);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js?')},"./lib/rexui/templates/ui/gridtable/input/OverCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EmitCellEvent.js */ \"./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js\");\n\r\n\r\nvar OverCell = function (table) {\r\n    table\r\n        .on('pointermove', OnMove, this)\r\n        .on('pointerover', OnMove, this)\r\n        .on('pointerup', OnOut, this)\r\n        .on('pointerout', OnOut, this);\r\n}\r\n\r\nvar OnMove = function (pointer) {\r\n    if (pointer.isDown) {\r\n        return;\r\n    }\r\n    var table = this.childrenMap.child;\r\n    var cellIndex = table.pointerToCellIndex(pointer.x, pointer.y);\r\n    if (cellIndex === this._lastOverCellIndex) {\r\n        return;\r\n    }\r\n\r\n    var preCellIndex = this._lastOverCellIndex;\r\n    this._lastOverCellIndex = cellIndex;\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.out', table, preCellIndex);\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.over', table, cellIndex);\r\n}\r\n\r\nvar OnOut = function () {\r\n    var table = this.childrenMap.child;\r\n    var cellIndxe = this._lastOverCellIndex;\r\n    this._lastOverCellIndex = undefined;\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.out', table, cellIndxe);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (OverCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/OverCell.js?")},"./lib/rexui/templates/ui/gridtable/input/PressCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _press_Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../press/Press.js */ "./lib/rexui/templates/ui/press/Press.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nvar PressCell = function (table) {\r\n    table._press = new _press_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"](table);\r\n    table._press\r\n        .on(\'pressstart\', function (press) {\r\n            var table = press.gameObject;\r\n            var cellIndex = table.pointerToCellIndex(press.x, press.y);\r\n            press._cellIndex = cellIndex;\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.pressstart\', table, cellIndex);\r\n        }, this)\r\n        .on(\'pressend\', function (press) {\r\n            var table = press.gameObject;\r\n            var cellIndex = press._cellIndex;\r\n            press._cellIndex = undefined;\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.pressend\', table, cellIndex);\r\n        }, this)\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PressCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/PressCell.js?')},"./lib/rexui/templates/ui/gridtable/input/TableSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ClickCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ClickCell.js */ "./lib/rexui/templates/ui/gridtable/input/ClickCell.js");\n/* harmony import */ var _OverCell_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OverCell.js */ "./lib/rexui/templates/ui/gridtable/input/OverCell.js");\n/* harmony import */ var _TapCell_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TapCell.js */ "./lib/rexui/templates/ui/gridtable/input/TapCell.js");\n/* harmony import */ var _PressCell_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PressCell.js */ "./lib/rexui/templates/ui/gridtable/input/PressCell.js");\n\r\n\r\n\r\n\r\n\r\nvar TableSetInteractive = function (table) {\r\n    table.setInteractive();\r\n\r\n    _ClickCell_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, table);\r\n    _OverCell_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this, table);\r\n    _TapCell_js__WEBPACK_IMPORTED_MODULE_2__["default"].call(this, table);\r\n    _PressCell_js__WEBPACK_IMPORTED_MODULE_3__["default"].call(this, table);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TableSetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/TableSetInteractive.js?')},"./lib/rexui/templates/ui/gridtable/input/TapCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../tap/Tap.js */ "./lib/rexui/templates/ui/tap/Tap.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/templates/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nvar TapCell = function (table) {\r\n    table._tap = new _tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"](table);\r\n    table._tap\r\n        .on(\'tap\', function (tap) {\r\n            var eventName = `cell.${tap.tapsCount}tap`\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, eventName, tap.gameObject, tap.x, tap.y);\r\n        }, this)\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TapCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/gridtable/input/TapCell.js?')},"./lib/rexui/templates/ui/label/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Label_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Label.js */ "./lib/rexui/templates/ui/label/Label.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'label\', function (config) {\r\n    var gameObject = new _Label_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Label\', _Label_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Label_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/label/Factory.js?')},"./lib/rexui/templates/ui/label/Label.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/utils/mask/DefaultMask.js */ \"./lib/rexui/plugins/utils/mask/DefaultMask.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Label extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        // Create sizer\r\n        super(scene, config);\r\n        this.type = 'rexLabel';\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var icon = GetValue(config, 'icon', undefined);\r\n        var iconMask = GetValue(config, 'iconMask', undefined);\r\n        var text = GetValue(config, 'text', undefined);\r\n        var action = GetValue(config, 'action', undefined);\r\n        var actionMask = GetValue(config, 'actionMask', undefined);\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n        var iconSpace = GetValue(config, 'space.icon', 0);\r\n        var textSpace = GetValue(config, 'space.text', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (icon) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: (text || action) ? iconSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: (text || action) ? iconSpace : paddingBottom\r\n                }\r\n            }\r\n\r\n            this.add(icon, 0, 'center', padding);\r\n\r\n            if (iconMask) {\r\n                iconMask = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](icon, 1); // Circle mask\r\n                icon.setMask(iconMask.createGeometryMask());\r\n                this.add(iconMask, null);\r\n            }\r\n        }\r\n\r\n        if (text) {\r\n            var expandTextWidth = GetValue(config, 'expandTextWidth', false);\r\n            var expandTextHeight = GetValue(config, 'expandTextHeight', false);\r\n            var proportion, padding, expand;\r\n            if (this.orientation === 0) {\r\n                proportion = (expandTextWidth) ? 1 : 0;\r\n                padding = {\r\n                    left: (icon) ? 0 : paddingLeft,\r\n                    right: (action) ? textSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                };\r\n                expand = expandTextHeight;\r\n            } else {\r\n                proportion = (expandTextHeight) ? 1 : 0;\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon) ? 0 : paddingTop,\r\n                    bottom: (action) ? textSpace : paddingBottom\r\n                }\r\n                expand = expandTextWidth;\r\n            }\r\n            this.add(text, proportion, 'center', padding, expand);\r\n        }\r\n\r\n        if (action) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: (icon || text) ? 0 : paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon || text) ? 0 : paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            }\r\n            this.add(action, 0, 'center', padding);\r\n\r\n            if (actionMask) {\r\n                actionMask = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](action, 1); // Circle mask\r\n                icon.setMask(actionMask.createGeometryMask());\r\n                this.add(actionMask, null);\r\n            }\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('icon', icon);\r\n        this.addChildrenMap('iconMask', iconMask);\r\n        this.addChildrenMap('text', text);\r\n        this.addChildrenMap('action', action);\r\n        this.addChildrenMap('actionMask', actionMask);\r\n    }\r\n\r\n    get text() {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return '';\r\n        }\r\n        var value;\r\n        if (textObject.text) {\r\n            value = textObject.text;\r\n        } else {\r\n            value = textObject.getData('text');\r\n        }\r\n        return value;\r\n    }\r\n\r\n    set text(value) {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return;\r\n        }\r\n        if (textObject.setText) {\r\n            textObject.setText(value);\r\n        } else {\r\n            textObject.setData('text', value);\r\n        }\r\n    }\r\n\r\n    setText(value) {\r\n        this.text = value;\r\n        return this;\r\n    }\r\n\r\n    appendText(value) {\r\n        this.text += value;\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        // Pin icon-mask to icon game object\r\n        var iconMask = this.childrenMap.iconMask;\r\n        if (iconMask) {\r\n            iconMask.setPosition();\r\n            this.resetChildPositionState(iconMask);\r\n        }\r\n        // Pin action-mask to action game object\r\n        var actionMask = this.childrenMap.actionMask;\r\n        if (actionMask) {\r\n            actionMask.setPosition();\r\n            this.resetChildPositionState(actionMask);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    resize(width, height) {\r\n        super.resize(width, height);\r\n        // Resize icon-mask to icon game object\r\n        var iconMask = this.childrenMap.iconMask;\r\n        if (iconMask) {\r\n            iconMask.resize();\r\n        }\r\n        // Resize action-mask to icon game object\r\n        var actionMask = this.childrenMap.actionMask;\r\n        if (actionMask) {\r\n            actionMask.resize();\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Label);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/label/Label.js?")},"./lib/rexui/templates/ui/menu/Collapse.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Collapse = function () {\r\n    if (this.root.easeOut) {\r\n        this.scaleDownDestroy(this.root.easeOut);\r\n    } else {\r\n        this.destroy();\r\n    }\r\n    this.collapseSubMenu();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Collapse);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/Collapse.js?')},"./lib/rexui/templates/ui/menu/CollapseSubMenu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CollapseSubMenu = function () {\r\n    if (this.childrenMap.subMenu === undefined) {\r\n        return this;\r\n    }\r\n\r\n    var subMenu = this.childrenMap.subMenu;\r\n    this.childrenMap.subMenu = undefined;\r\n    this.remove(subMenu);\r\n    subMenu.collapse();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (CollapseSubMenu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/CollapseSubMenu.js?')},"./lib/rexui/templates/ui/menu/CreateButtons.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CreateButtons = function (scene, items, callback, scope) {\r\n    var item;\r\n    var buttons = [],\r\n        button;\r\n    if (items && callback) {\r\n        for (var i = 0, cnt = items.length; i < cnt; i++) {\r\n            item = items[i];\r\n            item.scene = scene;\r\n            if (scope) {\r\n                button = callback.call(scope, item, i);\r\n            } else {\r\n                button = callback(item, i);\r\n            }\r\n            item.scene = undefined;\r\n            buttons.push(button);\r\n        }\r\n    }\r\n\r\n    return buttons;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CreateButtons);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/CreateButtons.js?')},"./lib/rexui/templates/ui/menu/ExpandSubMenu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ExpandSubMenu = function (parentButton, items) {\r\n    this.collapseSubMenu();\r\n    var subMenu = new this.constructor(this.scene, {\r\n        items: items,\r\n        orientation: this.orientation,\r\n        createButtonCallback: this.root.createButtonCallback,\r\n        createButtonCallbackScope: this.root.createButtonCallbackScope,\r\n        easeIn: this.root.easeIn,\r\n        easeOut: this.root.easeOut,\r\n\r\n        root: this.root,\r\n        parent: parentButton\r\n    });\r\n    this.add(subMenu, null);\r\n    this.childrenMap.subMenu = subMenu;    \r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ExpandSubMenu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/ExpandSubMenu.js?')},"./lib/rexui/templates/ui/menu/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Menu_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Menu.js */ "./lib/rexui/templates/ui/menu/Menu.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'menu\', function (config) {\r\n    var gameObject = new _Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Menu\', _Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/Factory.js?')},"./lib/rexui/templates/ui/menu/Menu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../buttons/Buttons.js */ \"./lib/rexui/templates/ui/buttons/Buttons.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/menu/Methods.js\");\n/* harmony import */ var _CreateButtons_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CreateButtons.js */ \"./lib/rexui/templates/ui/menu/CreateButtons.js\");\n/* harmony import */ var _plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/defaultbounds/GetDefaultBounds.js */ \"./lib/rexui/plugins/utils/defaultbounds/GetDefaultBounds.js\");\n/* harmony import */ var _MenuSetInteractive_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./MenuSetInteractive.js */ \"./lib/rexui/templates/ui/menu/MenuSetInteractive.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Menu extends _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // orientation\r\n        if (!config.hasOwnProperty('orientation')) {\r\n            config.orientation = 1;\r\n        }\r\n        // buttons\r\n        var items = GetValue(config, 'items', undefined);\r\n        var callback = GetValue(config, 'createButtonCallback', undefined);\r\n        var scope = GetValue(config, 'createButtonCallbackScope', undefined);\r\n        config.buttons = Object(_CreateButtons_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(scene, items, callback, scope);\r\n        super(scene, config);\r\n        this.type = 'rexMenu';\r\n        this.items = items;\r\n        this.root = GetValue(config, 'root', this);\r\n        if (this.root === this) {\r\n            this.expandEventName = GetValue(config, 'expandEvent', 'button.click');\r\n            this.easeIn = GetValue(config, 'easeIn', undefined);\r\n            this.easeOut = GetValue(config, 'easeOut', undefined);\r\n            this.bounds = GetValue(config, 'bounds', undefined);\r\n            this.expandOrientation = GetValue(config, 'expandOrientation', undefined);\r\n            if (this.expandOrientation === undefined) {\r\n                var bounds = this.bounds;\r\n                if (bounds === undefined) {\r\n                    bounds = Object(_plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(scene);\r\n                }\r\n                if (this.orientation === 0) { // x\r\n                    // Expand down(1)/up(3)\r\n                    this.expandOrientation = (this.y < bounds.centerY) ? 1 : 3;\r\n                } else {\r\n                    // Expand right(0)/left(2)\r\n                    this.expandOrientation = (this.x < bounds.centerX) ? 0 : 2;\r\n                }\r\n            }\r\n            this.createButtonCallback = callback;\r\n            this.createButtonCallbackScope = scope;\r\n            this.isPassedEvent = false;\r\n        }\r\n        this\r\n            .setOrigin(0)\r\n            .layout();\r\n\r\n        // Set position to align parent\r\n        var parent = GetValue(config, 'parent', undefined);\r\n        if (parent) {\r\n            switch (this.root.expandOrientation) {\r\n                case 0: //Expand right\r\n                    this.alignTop(parent.top).alignLeft(parent.right);\r\n                    break;\r\n                case 1: //Expand down\r\n                    this.alignLeft(parent.left).alignTop(parent.bottom);\r\n                    break;\r\n                case 2: //Expand left\r\n                    this.alignTop(parent.top).alignRight(parent.left);\r\n                    break;\r\n                case 3: //Expand up\r\n                    this.alignLeft(parent.left).alignBottom(parent.top);\r\n                    break;\r\n            }\r\n        }\r\n        this.pushIntoBounds(this.root.bounds);\r\n\r\n        Object(_MenuSetInteractive_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(this);\r\n\r\n        // Ease in menu\r\n        if (this.root.easeIn) {\r\n            this.popUp(this.root.easeIn);\r\n        }\r\n    }\r\n\r\n    isInTouching(pointer) {\r\n        if (super.isInTouching(pointer)) {\r\n            return true;\r\n        } else if (this.childrenMap.subMenu) {\r\n            return this.childrenMap.subMenu.isInTouching(pointer);\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Menu.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Menu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/Menu.js?")},"./lib/rexui/templates/ui/menu/MenuSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar MenuSetInteractive = function (menu) {\r\n    menu\r\n        // Expand sub event\r\n        .on(menu.root.expandEventName, function (button, index) {\r\n            if (this.isPassedEvent) {\r\n                return;\r\n            }\r\n            var subItems = this.items[index].children;\r\n            if (subItems) {\r\n                this.expandSubMenu(button, subItems);\r\n            } else {\r\n                // this.root.on('button.click', button); // TODO\r\n            }\r\n        }, menu)\r\n        // Click any button\r\n        .on('button.click', function (button, index) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root.isPassedEvent = true;\r\n                this.root.emit('button.click', button, index);\r\n                this.root.isPassedEvent = false;\r\n            }\r\n        }, menu)\r\n        //Pointer over any button\r\n        .on('button.over', function (button, index) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root.isPassedEvent = true;\r\n                this.root.emit('button.over', button, index);\r\n                this.root.isPassedEvent = false;\r\n            }\r\n        }, menu)\r\n        //Pointer out any button\r\n        .on('button.out', function (button, index) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root.isPassedEvent = true;\r\n                this.root.emit('button.out', button, index);\r\n                this.root.isPassedEvent = false;\r\n            }\r\n        }, menu);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MenuSetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/MenuSetInteractive.js?")},"./lib/rexui/templates/ui/menu/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ExpandSubMenu_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ExpandSubMenu.js */ "./lib/rexui/templates/ui/menu/ExpandSubMenu.js");\n/* harmony import */ var _Collapse_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Collapse.js */ "./lib/rexui/templates/ui/menu/Collapse.js");\n/* harmony import */ var _CollapseSubMenu_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CollapseSubMenu.js */ "./lib/rexui/templates/ui/menu/CollapseSubMenu.js");\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    expandSubMenu: _ExpandSubMenu_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    collapse: _Collapse_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    collapseSubMenu: _CollapseSubMenu_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/menu/Methods.js?')},"./lib/rexui/templates/ui/ninepatch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/templates/ui/ninepatch/NinePatch.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'ninePatch\', function (x, y, width, height, key, columns, rows, config) {\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, key, columns, rows, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.NinePatch\', _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/ninepatch/Factory.js?')},"./lib/rexui/templates/ui/ninepatch/NinePatch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/ninepatch/NinePatch.js */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/ninepatch/NinePatch.js?')},"./lib/rexui/templates/ui/numberbar/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NumberBar_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NumberBar.js */ "./lib/rexui/templates/ui/numberbar/NumberBar.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'numberBar\', function (config) {\r\n    var gameObject = new _NumberBar_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.NumberBar\', _NumberBar_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_NumberBar_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/numberbar/Factory.js?')},"./lib/rexui/templates/ui/numberbar/NumberBar.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _slider_Slider_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../slider/Slider.js */ \"./lib/rexui/templates/ui/slider/Slider.js\");\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/mask/DefaultMask.js */ \"./lib/rexui/plugins/utils/mask/DefaultMask.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Percent = Phaser.Math.Percent;\r\nconst Linear = Phaser.Math.Linear;\r\n\r\nclass NumberBar extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        // Create sizer\r\n        super(scene, config);\r\n        this.type = 'rexNumberBar';\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var icon = GetValue(config, 'icon', undefined);\r\n        var iconMask = GetValue(config, 'iconMask', undefined);\r\n        var sliderConfig = GetValue(config, 'slider', undefined);\r\n        var text = GetValue(config, 'text', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n        var iconSpace = GetValue(config, 'space.icon', 0);\r\n        var sliderSpace = GetValue(config, 'space.slider', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (icon) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: (sliderConfig || text) ? iconSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: (sliderConfig || text) ? iconSpace : paddingBottom\r\n                }\r\n            }\r\n\r\n            this.add(icon, 0, 'center', padding);\r\n\r\n            if (iconMask) {\r\n                iconMask = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](icon, 1); // Circle mask\r\n                icon.setMask(iconMask.createGeometryMask());\r\n                this.add(iconMask, null);\r\n            }\r\n        }\r\n\r\n        var slider;\r\n        if (sliderConfig) {\r\n            sliderConfig.orientation = (this.orientation == 0) ? 1 : 0;\r\n            sliderConfig.eventEmitter = this;\r\n            sliderConfig.value = null;\r\n            if (!sliderConfig.hasOwnProperty('input')) {\r\n                sliderConfig.input = -1;\r\n            }\r\n            slider = new _slider_Slider_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, sliderConfig);\r\n\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: (icon) ? 0 : paddingLeft,\r\n                    right: (text) ? sliderSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon) ? 0 : paddingTop,\r\n                    bottom: (text) ? sliderSpace : paddingBottom\r\n                }\r\n            }\r\n\r\n            var proportion;\r\n            if (this.orientation === 0) {\r\n                var sliderWidth = GetValue(sliderConfig, 'width', undefined);\r\n                proportion = (sliderWidth === undefined) ? 1 : 0;\r\n            } else {\r\n                var sliderHeight = GetValue(sliderConfig, 'height', undefined);\r\n                proportion = (sliderHeight === undefined) ? 1 : 0;\r\n            }\r\n            this.add(slider, proportion, 'center', padding);\r\n        }\r\n\r\n\r\n        if (text) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: (icon || sliderConfig) ? 0 : paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon || sliderConfig) ? 0 : paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            }\r\n            this.add(text, 0, 'center', padding);\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('icon', icon);\r\n        this.addChildrenMap('slider', slider);\r\n        this.addChildrenMap('text', text);\r\n\r\n        var callback = GetValue(config, 'valuechangeCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'valuechangeCallbackScope', undefined);\r\n            this.on('valuechange', callback, scope);\r\n        }\r\n        this.setEnable(GetValue(config, 'enable', undefined));\r\n        this.setValue(GetValue(config, 'value', 0));\r\n    }\r\n\r\n    setEnable(enable) {\r\n        if (this.childrenMap.slider) {\r\n            return this;\r\n        }\r\n        if (enable === undefined) {\r\n            enable = true;\r\n        }\r\n        this.childrenMap.slider.enable = enable;\r\n        return this;\r\n    }\r\n\r\n    get value() {\r\n        if (this.childrenMap.slider) {\r\n            return this.childrenMap.slider.value;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    set value(value) {\r\n        if (!this.childrenMap.slider) {\r\n            return;\r\n        }\r\n        this.childrenMap.slider.value = value;\r\n    }\r\n\r\n    setValue(value, min, max) {\r\n        if (min !== undefined) {\r\n            value = Percent(value, min, max);\r\n        }\r\n        this.value = value;\r\n        return this;\r\n    }\r\n\r\n    addValue(inc, min, max) {\r\n        if (min !== undefined) {\r\n            inc = Percent(inc, min, max);\r\n        }\r\n        this.value += inc;\r\n        return this;\r\n    }\r\n\r\n    getValue(min, max) {\r\n        var value = this.value;\r\n        if (min !== undefined) {\r\n            value = Linear(min, max, value);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    get text() {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return '';\r\n        }\r\n        var value;\r\n        if (textObject.text) {\r\n            value = textObject.text;\r\n        } else {\r\n            value = textObject.getData('text');\r\n        }\r\n        return value;\r\n    }\r\n\r\n    set text(value) {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return;\r\n        }\r\n        if (textObject.setText) {\r\n            textObject.setText(value);\r\n        } else {\r\n            textObject.setData('text', value);\r\n        }\r\n    }\r\n\r\n    setText(value) {\r\n        this.text = value;\r\n        return this;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (NumberBar);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/numberbar/NumberBar.js?")},"./lib/rexui/templates/ui/pages/AddPage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/templates/ui/utils/AlignConst.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/templates/ui/utils/GetBoundsConfig.js\");\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst ALIGN_LEFTTOP = Phaser.Display.Align.TOP_LEFT;\r\n\r\nvar AddPage = function (gameObject, key, align, paddingConfig, expand) {\r\n    if (IsPlainObject(key)) {\r\n        var config = key;\r\n        key = GetValue(config, 'key', 0);\r\n        align = GetValue(config, 'align', ALIGN_LEFTTOP);\r\n        paddingConfig = GetValue(config, 'padding', 0);\r\n        expand = GetValue(config, 'expand', false);\r\n    }\r\n\r\n    if (typeof (align) === 'string') {\r\n        align = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"][align];\r\n    }\r\n\r\n    if (align === undefined) {\r\n        align = ALIGN_CENTER;\r\n    }\r\n    if (paddingConfig === undefined) {\r\n        paddingConfig = 0;\r\n    }\r\n    if (expand === undefined) {\r\n        expand = true;\r\n    }\r\n\r\n    var config = this.getSizerConfig(gameObject);\r\n    config.parent = this;\r\n    config.align = align;\r\n    config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(paddingConfig);\r\n    config.expand = expand;\r\n    if (this.sizerChildren.has(key)) {\r\n        this.sizerChildren.get(key).destroy();\r\n    }\r\n    this.sizerChildren.set(key, gameObject);\r\n    gameObject.setVisible(false); // Default is invisible\r\n    this.add(gameObject);\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (AddPage);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/AddPage.js?")},"./lib/rexui/templates/ui/pages/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Pages_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pages.js */ "./lib/rexui/templates/ui/pages/Pages.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'pages\', function (x, y, minWidth, minHeight, orientation) {\r\n    var gameObject = new _Pages_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, orientation);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Pages\', _Pages_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Pages_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/Factory.js?')},"./lib/rexui/templates/ui/pages/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren.entries;\r\n    var child, padding, childHeight;\r\n    for (var key in children) {\r\n        child = children[key];\r\n        childHeight = (child.isRexSizer) ?\r\n            Math.max(child.minHeight, child.childrenHeight) :\r\n            child.height;\r\n\r\n        padding = child.rexSizer.padding;\r\n        childHeight += (padding.top + padding.bottom);\r\n        result = Math.max(childHeight, result);\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetChildrenHeight.js?')},"./lib/rexui/templates/ui/pages/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.sizerChildren.entries,\r\n        child;\r\n    for (var key in children) {\r\n        child = children[key];\r\n        if (child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetChildrenSizers.js?')},"./lib/rexui/templates/ui/pages/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren.entries;\r\n    var child, padding, childWidth;\r\n    for (var key in children) {\r\n        child = children[key];\r\n        childWidth = (child.isRexSizer) ?\r\n            Math.max(child.minWidth, child.childrenWidth) :\r\n            child.width;\r\n\r\n        padding = child.rexSizer.padding;\r\n        childWidth += (padding.left + padding.right);\r\n        result = Math.max(childWidth, result);\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetChildrenWidth.js?')},"./lib/rexui/templates/ui/pages/GetExpandedChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildHeight = function (parent, child) {\r\n    var newHeight;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (childConfig.expand) {\r\n        newHeight = parent.height - padding.top - padding.bottom;\r\n    }\r\n    return newHeight;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetExpandedChildHeight.js?')},"./lib/rexui/templates/ui/pages/GetExpandedChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildWidth = function (parent, child) {\r\n    var newWidth;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (childConfig.expand) {\r\n        newWidth = parent.width - padding.left - padding.right;\r\n    }\r\n    return newWidth;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetExpandedChildWidth.js?')},"./lib/rexui/templates/ui/pages/GetPage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetPage = function (key) {\r\n    if (key === undefined) {\r\n        return null;\r\n    } else if (!this.sizerChildren.has(key)) {\r\n        return null;\r\n    } else {\r\n        return this.sizerChildren.get(key);\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetPage);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/GetPage.js?')},"./lib/rexui/templates/ui/pages/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetExpandedChildWidth.js */ "./lib/rexui/templates/ui/pages/GetExpandedChildWidth.js");\n/* harmony import */ var _GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetExpandedChildHeight.js */ "./lib/rexui/templates/ui/pages/GetExpandedChildHeight.js");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout children\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var x, y, width, height; // Align zone\r\n    var childWidth, childHeight;\r\n\r\n    // Layout current page\r\n    var pages = this.pages;\r\n    for (var key in pages) {\r\n        child = pages[key];\r\n        childConfig = child.rexSizer;\r\n        padding = childConfig.padding;\r\n\r\n        // Set size\r\n        if (child.isRexSizer) {\r\n            child.layout(\r\n                this,\r\n                Object(_GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, child),\r\n                Object(_GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this, child));\r\n        } else {\r\n            childWidth = undefined;\r\n            childHeight = undefined;\r\n            if (childConfig.expand) { // Expand height\r\n                childHeight = this.height - padding.top - padding.bottom;\r\n                childWidth = this.width - padding.left - padding.right;\r\n            }\r\n            Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, childWidth, childHeight);\r\n        }\r\n\r\n        // Set position\r\n        x = (startX + padding.left);\r\n        width = this.width - padding.left - padding.right;\r\n        y = (startY + padding.top);\r\n        height = this.height - padding.top - padding.bottom;\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"].setPosition(x, y).setSize(width, height);\r\n        AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"], childConfig.align);\r\n        this.resetChildPositionState(child);\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/Layout.js?')},"./lib/rexui/templates/ui/pages/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AddPage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AddPage.js */ "./lib/rexui/templates/ui/pages/AddPage.js");\n/* harmony import */ var _GetPage_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetPage.js */ "./lib/rexui/templates/ui/pages/GetPage.js");\n/* harmony import */ var _SwapPage_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SwapPage.js */ "./lib/rexui/templates/ui/pages/SwapPage.js");\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/pages/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/pages/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/templates/ui/pages/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/pages/Layout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/templates/ui/pages/_layoutInit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    addPage: _AddPage_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getPage: _GetPage_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    swapPage: _SwapPage_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/Methods.js?')},"./lib/rexui/templates/ui/pages/Pages.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/pages/Methods.js\");\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Map = Phaser.Structs.Map;\r\n\r\nclass Pages extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexPages';\r\n        this._previousKey = undefined;\r\n        this._currentKey = undefined;\r\n        this.sizerChildren = new Map();\r\n        this.setSwapMode(GetValue(config, 'swapMode', 0));\r\n\r\n        this.addChildrenMap('pages', this.pages);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.sizerChildren.clear();\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setSwapMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = SWAPMODE[mode];\r\n        }\r\n        this.swapMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get previousKey() {\r\n        return this._previousKey;\r\n    }\r\n\r\n    get currentKey() {\r\n        return this._currentKey;\r\n    }\r\n\r\n    set currentKey(key) {\r\n        this.swapPage(key);\r\n    }\r\n\r\n    get currentPage() {\r\n        return this.getPage(this.currentKey);\r\n    }\r\n\r\n    get previousPage() {\r\n        return this.getPage(this.previousKey);\r\n    }\r\n\r\n    get keys() {\r\n        return this.sizerChildren.keys();\r\n    }\r\n\r\n    get pages() {\r\n        return this.sizerChildren.entries;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Pages.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\nconst SWAPMODE = {\r\n    invisible: 0,\r\n    destroy: 1\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pages);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/Pages.js?")},"./lib/rexui/templates/ui/pages/SwapPage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SwapPage = function (key) {\r\n    this._previousKey = this._currentKey;\r\n    var prevoiusPage = this.previousPage;\r\n    if (prevoiusPage) {\r\n        if (this.swapMode === 0) { // Invisible\r\n            prevoiusPage.setVisible(false);\r\n            this.resetChildVisibleState(prevoiusPage);\r\n            this.emit('pageinvisible', prevoiusPage, this._previousKey, this);\r\n        } else { // Destroy\r\n            prevoiusPage.destroy();\r\n        }\r\n    }\r\n\r\n    if (key && !this.sizerChildren.has(key)) {\r\n        this.emit('createpage', key, this);\r\n    }\r\n\r\n    this._currentKey = key;\r\n    var currentPage = this.currentPage;\r\n    if (currentPage) {\r\n        currentPage.setVisible(true);\r\n        this.resetChildVisibleState(currentPage);\r\n        this.emit('pagevisible', currentPage, this._currentKey, this);\r\n    }\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SwapPage);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/SwapPage.js?")},"./lib/rexui/templates/ui/pages/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInitChild = function () {\r\n    this._childrenWidth = undefined;\r\n    this._childrenHeight = undefined;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInitChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pages/_layoutInit.js?')},"./lib/rexui/templates/ui/pan/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Pan_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pan.js */ "./lib/rexui/templates/ui/pan/Pan.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'pan\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Pan\', _Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pan/Factory.js?')},"./lib/rexui/templates/ui/pan/Pan.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_pan_Pan_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/pan/Pan.js */ "./lib/rexui/plugins/input/gestures/pan/Pan.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_pan_Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pan/Pan.js?')},"./lib/rexui/templates/ui/pinch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Pinch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pinch.js */ "./lib/rexui/templates/ui/pinch/Pinch.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'pinch\', function (config) {\r\n    return new _Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Pinch\', _Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pinch/Factory.js?')},"./lib/rexui/templates/ui/pinch/Pinch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_pinch_Pinch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/pinch/Pinch.js */ "./lib/rexui/plugins/input/gestures/pinch/Pinch.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_pinch_Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/pinch/Pinch.js?')},"./lib/rexui/templates/ui/press/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Press.js */ "./lib/rexui/templates/ui/press/Press.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'press\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Press_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Press\', _Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/press/Factory.js?')},"./lib/rexui/templates/ui/press/Press.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_press_Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/press/Press.js */ "./lib/rexui/plugins/input/gestures/press/Press.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_press_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/press/Press.js?')},"./lib/rexui/templates/ui/rotate/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Rotate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Rotate.js */ "./lib/rexui/templates/ui/rotate/Rotate.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'rotate\', function (config) {\r\n    return new _Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Rotate\', _Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/rotate/Factory.js?')},"./lib/rexui/templates/ui/rotate/Rotate.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/rotate/Rotate.js */ "./lib/rexui/plugins/input/gestures/rotate/Rotate.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/rotate/Rotate.js?')},"./lib/rexui/templates/ui/roundrectangle/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RoundRectangle.js */ "./lib/rexui/templates/ui/roundrectangle/RoundRectangle.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'roundRectangle\', function (x, y, width, height, radiusConfig, fillColor, fillAlpha) {\r\n    var gameObject = new _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, radiusConfig, fillColor, fillAlpha);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.RoundRectangle\', _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/roundrectangle/Factory.js?')},"./lib/rexui/templates/ui/roundrectangle/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_shape_roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/shape/roundrectangle/RoundRectangle.js */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_shape_roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/roundrectangle/RoundRectangle.js?')},"./lib/rexui/templates/ui/scrollableblock/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollableBlock.js */ "./lib/rexui/templates/ui/scrollableblock/ScrollableBlock.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'scrollableBlock\', function (config) {\r\n    var gameObject = new _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.ScrollableBlock\', _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/Factory.js?')},"./lib/rexui/templates/ui/scrollableblock/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    var child = this.child,\r\n        childConfig = child.rexSizer;\r\n    if (childConfig.hidden) {\r\n        result = 0;\r\n    } else if (this.scrollMode === 0) { // scroll y   \r\n        result = 0;\r\n    } else { // scroll x\r\n        result = (child.isRexSizer) ?\r\n            Math.max(child.minHeight, child.childrenHeight) :\r\n            child.height;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/GetChildrenHeight.js?')},"./lib/rexui/templates/ui/scrollableblock/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    var child = this.child,\r\n        childConfig = child.rexSizer;\r\n    if (childConfig.hidden) {\r\n        result = 0;\r\n    } else if (this.scrollMode === 0) { // scroll y\r\n        result = (child.isRexSizer) ?\r\n            Math.max(child.minWidth, child.childrenWidth) :\r\n            child.width;\r\n    } else { // scroll x\r\n        result = 0;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/GetChildrenWidth.js?')},"./lib/rexui/templates/ui/scrollableblock/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/utils/mask/MaskToGameObject.js */ "./lib/rexui/plugins/utils/mask/MaskToGameObject.js");\n\r\n\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout child\r\n    var child = this.child;\r\n    var childWidth, childHeight;\r\n    if (!child.rexSizer.hidden) {\r\n        // Set size\r\n        if (this.scrollMode === 0) {\r\n            childWidth = this.width;\r\n        } else {\r\n            childHeight = this.height;\r\n        }\r\n        if (child.isRexSizer) {\r\n            child.layout(this, childWidth, childHeight);\r\n        } else {\r\n            Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, childWidth, childHeight);\r\n        }\r\n\r\n        this.resetChildPosition();\r\n\r\n        // Layout child mask\r\n        if (this.childMask) {\r\n            var maskGameObject = Object(_plugins_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.childMask);\r\n            maskGameObject.setPosition().resize();\r\n            this.resetChildPositionState(maskGameObject);\r\n        }\r\n    }\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/Layout.js?')},"./lib/rexui/templates/ui/scrollableblock/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetChild_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetChild.js */ "./lib/rexui/templates/ui/scrollableblock/SetChild.js");\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/scrollableblock/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/scrollableblock/GetChildrenHeight.js");\n/* harmony import */ var _ResetChildPosition_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ResetChildPosition.js */ "./lib/rexui/templates/ui/scrollableblock/ResetChildPosition.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/scrollableblock/Layout.js");\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setChild: _SetChild_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    resetChildPosition: _ResetChildPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/Methods.js?')},"./lib/rexui/templates/ui/scrollableblock/ResetChildPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/containerlite/MaskChildren.js */ "./lib/rexui/plugins/gameobjects/containerlite/MaskChildren.js");\n\r\n\r\nvar ResetChildPosition = function () {\r\n    var x = this.left;\r\n    var y = this.top;\r\n    if (this.scrollMode === 0) {\r\n        y += this.childOY;\r\n    } else {\r\n        x += this.childOY;\r\n    }\r\n    this.child.setPosition(x, y);\r\n    Object(_plugins_gameobjects_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, this.childMask, this.child.getAllChildren());\r\n    this.resetChildPositionState(this.child);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResetChildPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/ResetChildPosition.js?')},"./lib/rexui/templates/ui/scrollableblock/ScrollableBlock.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/scrollableblock/Methods.js\");\n/* harmony import */ var _utils_ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/ScrollModeConst.js */ \"./lib/rexui/templates/ui/utils/ScrollModeConst.js\");\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ScrollableBlock extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexScrollableBlock';\r\n        this.child = undefined;\r\n        this.childMask = undefined;\r\n        this._childOY = 0;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n\r\n        this.setScrollMode(GetValue(config, 'scrollMode', true))\r\n        this.setClampMode(GetValue(config, 'clamplChildOY', true));\r\n\r\n        // Add elements\r\n        // No background object, and child does not have padding\r\n        var child = GetValue(config, 'child', undefined);\r\n        var expand = GetValue(config, 'expand', true);\r\n        var childMask = GetValue(config, 'mask', undefined);\r\n\r\n        this.setChild(child, expand, childMask);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.child = undefined;\r\n        if (this.childMask) {\r\n            this.childMask.destroy();\r\n            this.childMask = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setScrollMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = _utils_ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"][mode.toLowerCase()];\r\n        }\r\n        this.scrollMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampChildOYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get instHeight() {\r\n        return (this.scrollMode === 0) ? this.height : this.width;\r\n    }\r\n\r\n    get instWidth() {\r\n        return (this.scrollMode === 0) ? this.width : this.height;\r\n    }\r\n\r\n    get childHeight() {\r\n        return (this.scrollMode === 0) ? this.child.height : this.child.width;\r\n    }\r\n\r\n    get childWidth() {\r\n        return (this.scrollMode === 0) ? this.child.width : this.child.height;\r\n    }\r\n\r\n    get topChildOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomChildOY() {\r\n        return -this.visibleHeight;\r\n    }\r\n\r\n    get visibleHeight() {\r\n        var h;\r\n        var childHeight = this.childHeight;\r\n        var instHeight = this.instHeight;\r\n        if (childHeight > instHeight) {\r\n            h = childHeight - instHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    childOYExceedTop(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.childOY;\r\n        }\r\n        return (oy > this.topChildOY);\r\n    }\r\n\r\n    childOYExeceedBottom(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.childOY;\r\n        }\r\n        return (oy < this.bottomChildOY);\r\n    }\r\n\r\n    get childOY() {\r\n        return this._childOY;\r\n    }\r\n\r\n    set childOY(oy) {\r\n        var topChildOY = this.topChildOY;\r\n        var bottomChildOY = this.bottomChildOY;\r\n        var childOYExceedTop = this.childOYExceedTop(oy);\r\n        var childOYExeceedBottom = this.childOYExeceedBottom(oy);\r\n\r\n        if (this.clampChildOYMode) {\r\n            if (this.instHeight > this.childHeight) {\r\n                oy = 0;\r\n            } else if (childOYExceedTop) {\r\n                oy = topChildOY\r\n            } else if (childOYExeceedBottom) {\r\n                oy = bottomChildOY;\r\n            }\r\n        }\r\n\r\n        if (this._childOY !== oy) {\r\n            this._childOY = oy;\r\n            this.resetChildPosition();\r\n        }\r\n\r\n        if (childOYExceedTop) {\r\n            if (!this.execeedTopState) {\r\n                this.emit('execeedtop', this, oy, topChildOY);\r\n            }\r\n        }\r\n        this.execeedTopState = childOYExceedTop;\r\n\r\n        if (childOYExeceedBottom) {\r\n            if (!this.execeedBottomState) {\r\n                this.emit('execeedbottom', this, oy, bottomChildOY);\r\n            }\r\n        }\r\n        this.execeedBottomState = childOYExeceedBottom;\r\n    }\r\n\r\n    setChildOY(oy) {\r\n        this.childOY = oy;\r\n        return this;\r\n    }\r\n\r\n    set t(value) {\r\n        this.childOY = -this.visibleHeight * value;\r\n    }\r\n\r\n    get t() {\r\n        var visibleHeight = this.visibleHeight;\r\n        if (visibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.childOY / -visibleHeight);\r\n    }\r\n\r\n    setChildOYByPercentage(percentage) {\r\n        this.t = percentage;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    ScrollableBlock.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ScrollableBlock);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/ScrollableBlock.js?")},"./lib/rexui/templates/ui/scrollableblock/SetChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/utils/mask/DefaultMask.js */ "./lib/rexui/plugins/utils/mask/DefaultMask.js");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst ALIGN_LEFTTOP = Phaser.Display.Align.TOP_LEFT;\r\n\r\nvar SetChild = function (gameObject, expand, maskConfig) {\r\n    if (gameObject.setOrigin) {\r\n        gameObject.setOrigin(0);\r\n    }\r\n\r\n    this.add(gameObject);\r\n\r\n    var config = this.getSizerConfig(gameObject);\r\n    config.parent = this;\r\n    config.align = ALIGN_LEFTTOP;\r\n    config.expand = expand;\r\n    this.child = gameObject;\r\n\r\n    // Create mask of child object\r\n    var maskEnable, maskPadding;\r\n    if (maskConfig === true) {\r\n        maskEnable = true;\r\n        maskPadding = 0;\r\n    } else if (maskConfig === false) {\r\n        maskEnable = false;\r\n    } else {\r\n        maskEnable = GetValue(maskConfig, \'mask\', true);\r\n        maskPadding = GetValue(maskConfig, \'padding\', 0);\r\n    }\r\n\r\n    if (maskEnable) {\r\n        var maskGameObject = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, maskPadding);\r\n        this.childMask = maskGameObject.createGeometryMask();\r\n        this.add(maskGameObject);\r\n    }\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollableblock/SetChild.js?')},"./lib/rexui/templates/ui/scrollablepanel/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollablePanel.js */ "./lib/rexui/templates/ui/scrollablepanel/ScrollablePanel.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'scrollablePanel\', function (config) {\r\n    var gameObject = new _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.ScrollablePanel\', _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollablepanel/Factory.js?')},"./lib/rexui/templates/ui/scrollablepanel/ScrollablePanel.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ \"./lib/rexui/templates/ui/utils/scrollable/Scrollable.js\");\n/* harmony import */ var _utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/GetScrollMode.js */ \"./lib/rexui/templates/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../scrollableblock/ScrollableBlock.js */ \"./lib/rexui/templates/ui/scrollableblock/ScrollableBlock.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ScrollablePanel extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create scrollable-block\r\n        var scrollMode = Object(_utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config);\r\n        var panelConfig = GetValue(config, 'panel', undefined);\r\n        if (panelConfig === undefined) {\r\n            panelConfig = {};\r\n        }\r\n        panelConfig.scrollMode = scrollMode;\r\n        panelConfig.clamplChildOY = GetValue(config, 'clamplChildOY', false);\r\n        var scrollableBlock = new _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](scene, panelConfig);\r\n        var panelWidth = GetValue(panelConfig, 'width', undefined);\r\n        var panelHeight = GetValue(panelConfig, 'height', undefined);\r\n        var proportion, expand;\r\n        if (scrollMode === 0) {\r\n            proportion = (panelWidth === undefined) ? 1 : 0;\r\n            expand = (panelHeight === undefined);\r\n        } else {\r\n            proportion = (panelHeight === undefined) ? 1 : 0;\r\n            expand = (panelWidth === undefined);\r\n        }\r\n\r\n        // Fill config of scrollable\r\n        config.type = 'rexScrollablePanel';\r\n        config.child = {\r\n            gameObject: scrollableBlock,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, 'space', undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.panel;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap('panel', this.childrenMap.child.child);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ScrollablePanel);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/scrollablepanel/ScrollablePanel.js?")},"./lib/rexui/templates/ui/sizer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Sizer.js */ "./lib/rexui/templates/ui/sizer/Sizer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'sizer\', function (x, y, minWidth, minHeight, orientation) {\r\n    var gameObject = new _Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, orientation);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Sizer\', _Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/Factory.js?')},"./lib/rexui/templates/ui/sizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetChildrenHeight = function (minimumMode) {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    if (minimumMode === undefined) {\r\n        minimumMode = true;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, padding, childHeight;\r\n    if (this.orientation === 0) { // x\r\n        // Get maximun height\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            childHeight = (child.isRexSizer) ?\r\n                Math.max(child.minHeight, child.childrenHeight) :\r\n                child.height;\r\n\r\n            padding = child.rexSizer.padding;\r\n            childHeight += (padding.top + padding.bottom);\r\n            result = Math.max(childHeight, result);\r\n        }\r\n    } else {\r\n        // Get summation of minimum height\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (!child.hasOwnProperty('rexSizer')) {\r\n                continue;\r\n            }\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            if (\r\n                (child.rexSizer.proportion === 0) ||\r\n                (minimumMode && (child.rexSizer.proportion > 0))\r\n            ) {\r\n                childHeight = (child.isRexSizer) ?\r\n                    Math.max(child.minHeight, child.childrenHeight) :\r\n                    child.height;\r\n            } else {\r\n                childHeight = 0;\r\n            }\r\n            padding = child.rexSizer.padding;\r\n            childHeight += (padding.top + padding.bottom);\r\n            result += childHeight;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetChildrenHeight.js?")},"./lib/rexui/templates/ui/sizer/GetChildrenProportion.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenProportion = function () {\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, proportion;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n        proportion = child.rexSizer.proportion;\r\n        if (proportion > 0) {\r\n            result += proportion;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenProportion);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetChildrenProportion.js?')},"./lib/rexui/templates/ui/sizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function(out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.sizerChildren,\r\n        child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetChildrenSizers.js?')},"./lib/rexui/templates/ui/sizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetChildrenWidth = function (minimumMode) {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    if (minimumMode === undefined) {\r\n        minimumMode = true;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, padding, childWidth;\r\n    if (this.orientation === 0) { // x\r\n        // Get summation of minimum width\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            if (\r\n                (child.rexSizer.proportion === 0) ||\r\n                (minimumMode && (child.rexSizer.proportion > 0))\r\n            ) {\r\n                childWidth = (child.isRexSizer) ?\r\n                    Math.max(child.minWidth, child.childrenWidth) :\r\n                    child.width;\r\n            } else {\r\n                childWidth = 0;\r\n            }\r\n            padding = child.rexSizer.padding;\r\n            childWidth += (padding.left + padding.right);\r\n            result += childWidth;\r\n        }\r\n    } else {\r\n        // Get maximun width\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (!child.hasOwnProperty('rexSizer')) {\r\n                continue;\r\n            }\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            childWidth = (child.isRexSizer) ?\r\n                Math.max(child.minWidth, child.childrenWidth) :\r\n                child.width;\r\n\r\n            padding = child.rexSizer.padding;\r\n            childWidth += (padding.left + padding.right);\r\n            result = Math.max(childWidth, result);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetChildrenWidth.js?")},"./lib/rexui/templates/ui/sizer/GetExpandedChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildHeight = function (parent, child) {\r\n    var newHeight;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (parent.orientation === 0) { // x\r\n        if (childConfig.expand) {\r\n            newHeight = parent.height - padding.top - padding.bottom;\r\n        }\r\n    } else { // y\r\n        if ((childConfig.proportion > 0) && (parent.proportionLength > 0)) {\r\n            newHeight = (childConfig.proportion * parent.proportionLength);\r\n        }\r\n    }\r\n    return newHeight;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetExpandedChildHeight.js?')},"./lib/rexui/templates/ui/sizer/GetExpandedChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildWidth = function (parent, child) {\r\n    var newWidth;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (parent.orientation === 0) { // x\r\n        if ((childConfig.proportion > 0) && (parent.proportionLength > 0)) {\r\n            newWidth = (childConfig.proportion * parent.proportionLength);\r\n        }\r\n    } else { // y\r\n        if (childConfig.expand) {\r\n            newWidth = parent.width - padding.left - padding.right;\r\n        }\r\n    }\r\n    return newWidth;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/GetExpandedChildWidth.js?')},"./lib/rexui/templates/ui/sizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetExpandedChildWidth.js */ "./lib/rexui/templates/ui/sizer/GetExpandedChildWidth.js");\n/* harmony import */ var _GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetExpandedChildHeight.js */ "./lib/rexui/templates/ui/sizer/GetExpandedChildHeight.js");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    var proportionLength;\r\n    if (this.childrenProportion > 0) {\r\n        var remainder = (this.orientation === 0) ?\r\n            (this.width - this.childrenWidth) :\r\n            (this.height - this.childrenHeight);\r\n\r\n        if (remainder > 0) {\r\n            remainder = (this.orientation === 0) ?\r\n                (this.width - this.getChildrenWidth(false)) :\r\n                (this.height - this.getChildrenHeight(false));\r\n            proportionLength = remainder / this.childrenProportion;\r\n        } else {\r\n            proportionLength = 0;\r\n        }\r\n    } else {\r\n        proportionLength = 0;\r\n    }\r\n    this.proportionLength = proportionLength;\r\n\r\n    // Layout children    \r\n    var children = this.sizerChildren;\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var itemX = startX,\r\n        itemY = startY;\r\n    var x, y, width, height; // Align zone\r\n    var childWidth, childHeight;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n\r\n        childConfig = child.rexSizer;\r\n        padding = childConfig.padding;\r\n\r\n        // Set size\r\n        childWidth = Object(_GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, child);\r\n        childHeight = Object(_GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this, child);\r\n        if (child.isRexSizer) {\r\n            child.layout(this, childWidth, childHeight);\r\n        } else {\r\n            Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, childWidth, childHeight);\r\n        }\r\n\r\n        if (childWidth === undefined) {\r\n            childWidth = child.width;\r\n        }\r\n        if (childHeight === undefined) {\r\n            childHeight = child.height;\r\n        }\r\n\r\n        // Set position\r\n        if (this.orientation === 0) { // x\r\n            x = (itemX + padding.left);\r\n            if ((childConfig.proportion === 0) || (proportionLength === 0)) {\r\n                width = childWidth;\r\n            } else {\r\n                width = (childConfig.proportion * proportionLength);\r\n            }\r\n\r\n            y = (itemY + padding.top);\r\n            height = (this.height - padding.top - padding.bottom);\r\n        } else { // y\r\n            x = (itemX + padding.left);\r\n            width = (this.width - padding.left - padding.right);\r\n\r\n            y = (itemY + padding.top);\r\n            if ((childConfig.proportion === 0) || (proportionLength === 0)) {\r\n                height = childHeight;\r\n            } else {\r\n                height = (childConfig.proportion * proportionLength);\r\n            }\r\n        }\r\n\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"].setPosition(x, y).setSize(width, height);\r\n        AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"], childConfig.align);\r\n        this.resetChildPositionState(child);\r\n\r\n        if (this.orientation === 0) { // x\r\n            itemX += (width + padding.left + padding.right);\r\n        } else { // y\r\n            itemY += (height + padding.top + padding.bottom);\r\n        }\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/Layout.js?')},"./lib/rexui/templates/ui/sizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/templates/ui/sizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/templates/ui/sizer/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenProportion_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenProportion.js */ "./lib/rexui/templates/ui/sizer/GetChildrenProportion.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/templates/ui/sizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/sizer/Layout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/templates/ui/sizer/_layoutInit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenProportion: _GetChildrenProportion_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/Methods.js?')},"./lib/rexui/templates/ui/sizer/Sizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/sizer/Methods.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/templates/ui/utils/GetBoundsConfig.js\");\n/* harmony import */ var _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/OrientationConst.js */ \"./lib/rexui/templates/ui/utils/OrientationConst.js\");\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/templates/ui/utils/AlignConst.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveItem = Phaser.Utils.Array.Remove;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nclass Sizer extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, orientation) {\r\n        var config;\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(orientation)) {\r\n            config = orientation;\r\n        }\r\n\r\n        if (config !== undefined) {\r\n            orientation = GetValue(config, 'orientation', 0);\r\n        }\r\n        if (orientation === undefined) {\r\n            orientation = 0;\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexSizer';\r\n        this.sizerChildren = [];\r\n        this.setOrientation(orientation);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.sizerChildren.length = 0;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if (typeof (orientation) === 'string') {\r\n            orientation = _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"][orientation];\r\n        }\r\n        this.orientation = orientation;\r\n        return this;\r\n    }\r\n\r\n    add(gameObject, proportion, align, paddingConfig, expand) {\r\n        super.add(gameObject);\r\n\r\n        var proportionType = typeof (proportion);\r\n        if (proportion === null) {\r\n            return this;\r\n        } else if (proportionType === 'number') {\r\n\r\n        } else if (proportionType === 'string') {\r\n            proportion = PROPORTIONMODE[proportion];\r\n        } else if (IsPlainObject(proportion)) {\r\n            var config = proportion;\r\n            proportion = GetValue(config, 'proportion', 0);\r\n            align = GetValue(config, 'align', ALIGN_CENTER);\r\n            paddingConfig = GetValue(config, 'padding', 0);\r\n            expand = GetValue(config, 'expand', false);\r\n        }\r\n\r\n        if (typeof (align) === 'string') {\r\n            align = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"][align];\r\n        }\r\n\r\n        if (proportion === undefined) {\r\n            proportion = 0;\r\n        }\r\n        if (align === undefined) {\r\n            align = ALIGN_CENTER;\r\n        }\r\n        if (paddingConfig === undefined) {\r\n            paddingConfig = 0;\r\n        }\r\n        if (expand === undefined) {\r\n            expand = false;\r\n        }\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        config.proportion = proportion;\r\n        config.align = align;\r\n        config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig);\r\n        config.expand = expand;\r\n        this.sizerChildren.push(gameObject);\r\n        return this;\r\n    }\r\n\r\n    insert(index, gameObject, proportion, align, paddingConfig, expand) {\r\n        this.add(gameObject, proportion, align, paddingConfig, expand);\r\n        this.moveTo(gameObject, index);\r\n        return this;\r\n    }\r\n\r\n    remove(gameObject) {\r\n        var config = this.getSizerConfig(gameObject);\r\n        if (config.parent !== this) {\r\n            return this;\r\n        }\r\n        config.parent = undefined;\r\n        RemoveItem(this.sizerChildren, gameObject);\r\n        super.remove(gameObject);\r\n        return this;\r\n    }\r\n\r\n    clear(destroyChild) {\r\n        for (var i = 0, cnt = this.sizerChildren.length; i < cnt; i++) {\r\n            this.getSizerConfig(this.sizerChildren[i]).parent = undefined;\r\n        }\r\n        this.sizerChildren.length = 0;\r\n        super.clear(destroyChild);\r\n        return this;\r\n    }\r\n\r\n    get childrenProportion() {\r\n        if (this._childrenProportion === undefined) {\r\n            this._childrenProportion = this.getChildrenProportion();\r\n        }\r\n        return this._childrenProportion;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Sizer.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\nconst PROPORTIONMODE = {\r\n    min: 0,\r\n    full: -1,\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Sizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/Sizer.js?")},"./lib/rexui/templates/ui/sizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInitChild = function () {\r\n    this._childrenWidth = undefined;\r\n    this._childrenHeight = undefined;\r\n    this._childrenProportion = undefined;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInitChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/sizer/_layoutInit.js?')},"./lib/rexui/templates/ui/slider/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Slider_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Slider.js */ "./lib/rexui/templates/ui/slider/Slider.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'slider\', function (config) {\r\n    var gameObject = new _Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Slider\', _Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/Factory.js?')},"./lib/rexui/templates/ui/slider/GetEndPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetThumbAlignPoint.js */ "./lib/rexui/templates/ui/slider/GetThumbAlignPoint.js");\n\r\n\r\nconst AlignRight = Phaser.Display.Align.RIGHT_CENTER;\r\nconst AlignBottom = Phaser.Display.Align.BOTTOM_CENTER;\r\n\r\nvar GetEndoint = function (out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    if (this.childrenMap.thumb) {\r\n        var align = (this.orientation === 1) ? AlignRight : AlignBottom;\r\n        _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, align, out);\r\n    } else {\r\n        if (this.orientation === 0) {\r\n            out.x = this.centerX;\r\n            out.y = this.bottom - 1; // Add 1 pixel margin\r\n        } else {\r\n            out.x = this.right - 1; // Add 1 pixel margin\r\n            out.y = this.centerY;\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetEndoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/GetEndPoint.js?')},"./lib/rexui/templates/ui/slider/GetStartPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetThumbAlignPoint.js */ "./lib/rexui/templates/ui/slider/GetThumbAlignPoint.js");\n\r\n\r\nconst AlignLeft = Phaser.Display.Align.LEFT_CENTER;\r\nconst AlignTop = Phaser.Display.Align.TOP_CENTER;\r\n\r\nvar GetStartPoint = function (out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    if (this.childrenMap.thumb) {\r\n        var align = (this.orientation === 0) ? AlignTop : AlignLeft;\r\n        _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, align, out);\r\n    } else {\r\n        if (this.orientation === 0) {\r\n            out.x = this.centerX;\r\n            out.y = this.top + 1; // Add 1 pixel margin\r\n        } else {\r\n            out.x = this.left + 1; // Add 1 pixel margin\r\n            out.y = this.centerY;\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetStartPoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/GetStartPoint.js?')},"./lib/rexui/templates/ui/slider/GetThumbAlignPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar GetThumbAlignPoint = function (align, out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    var thumb = this.childrenMap.thumb;\r\n    var currentX = thumb.x;\r\n    var currentY = thumb.y;\r\n\r\n    AlignIn(thumb, this, align);\r\n    out.x = thumb.x;\r\n    out.y = thumb.y;\r\n\r\n    thumb.x = currentX;\r\n    thumb.y = currentY;\r\n\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetThumbAlignPoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/GetThumbAlignPoint.js?')},"./lib/rexui/templates/ui/slider/OnDragThumb.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PositionToPercent.js */ "./lib/rexui/templates/ui/slider/PositionToPercent.js");\n\r\n\r\nvar OnDragThumb = function (pointer, dragX, dragY) {\r\n    if (!this.enable) {\r\n        return;\r\n    }\r\n    tmpPoint.x = dragX;\r\n    tmpPoint.y = dragY;\r\n    this.value = Object(_PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.getStartPoint(), this.getEndPoint(), tmpPoint);\r\n}\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (OnDragThumb);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/OnDragThumb.js?')},"./lib/rexui/templates/ui/slider/OnTouchTrack.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PositionToPercent.js */ "./lib/rexui/templates/ui/slider/PositionToPercent.js");\n\r\n\r\nvar OnTouchTrack = function (pointer, localX, localY) {\r\n    if (!this.enable) {\r\n        return;\r\n    }\r\n    if (!pointer.isDown) {\r\n        return;\r\n    }\r\n    tmpPoint.x = pointer.worldX;\r\n    tmpPoint.y = pointer.worldY;\r\n    this.value = Object(_PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.getStartPoint(), this.getEndPoint(), tmpPoint);\r\n}\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (OnTouchTrack);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/OnTouchTrack.js?')},"./lib/rexui/templates/ui/slider/PercentToPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Linear = Phaser.Math.Linear;\r\n\r\nvar PercentToPosition = function (t, startPoint, endPoint, out) {\r\n    if (out === undefined) {\r\n        out = tmpOut;\r\n    }\r\n    out.x = Linear(startPoint.x, endPoint.x, t);\r\n    out.y = Linear(startPoint.y, endPoint.y, t);\r\n    return out;\r\n}\r\nvar tmpOut = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PercentToPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/PercentToPosition.js?')},"./lib/rexui/templates/ui/slider/PositionToPercent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Percent = Phaser.Math.Percent;\r\n\r\nvar PositionToPercent = function (startPoint, endPoint, currentPoint) {\r\n    var min, max, value;\r\n    if (startPoint.y === endPoint.y) {\r\n        min = Math.min(startPoint.x, endPoint.x);\r\n        max = Math.max(startPoint.x, endPoint.x);\r\n        value = Percent(currentPoint.x, min, max);\r\n    } else if (startPoint.x === endPoint.x) {\r\n        min = Math.min(startPoint.y, endPoint.y);\r\n        max = Math.max(startPoint.y, endPoint.y);\r\n        value = Percent(currentPoint.y, min, max);\r\n    }\r\n    return value\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PositionToPercent);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/PositionToPercent.js?')},"./lib/rexui/templates/ui/slider/Slider.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _OnDragThumb_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OnDragThumb.js */ \"./lib/rexui/templates/ui/slider/OnDragThumb.js\");\n/* harmony import */ var _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OnTouchTrack.js */ \"./lib/rexui/templates/ui/slider/OnTouchTrack.js\");\n/* harmony import */ var _GetStartPoint_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetStartPoint.js */ \"./lib/rexui/templates/ui/slider/GetStartPoint.js\");\n/* harmony import */ var _GetEndPoint_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetEndPoint.js */ \"./lib/rexui/templates/ui/slider/GetEndPoint.js\");\n/* harmony import */ var _UpdateThumb_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./UpdateThumb.js */ \"./lib/rexui/templates/ui/slider/UpdateThumb.js\");\n/* harmony import */ var _UpdateIndicator_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./UpdateIndicator.js */ \"./lib/rexui/templates/ui/slider/UpdateIndicator.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\nconst Linear = Phaser.Math.Linear;\r\nconst Percent = Phaser.Math.Percent;\r\nconst SnapTo = Phaser.Math.Snap.To;\r\n\r\nclass Slider extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        // Create sizer\r\n        super(scene, config);\r\n        this.type = 'rexSlider';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var track = GetValue(config, 'track', undefined);\r\n        var indicator = GetValue(config, 'indicator', undefined);\r\n        var thumb = GetValue(config, 'thumb', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (track) {\r\n            var padding = {\r\n                left: paddingLeft,\r\n                right: paddingRight,\r\n                top: paddingTop,\r\n                bottom: paddingBottom\r\n            }\r\n            this.add(track, 0, undefined, padding, true);\r\n        }\r\n\r\n        if (indicator) {\r\n            this.add(indicator, null); // Put into container but not layout it\r\n        }\r\n\r\n        if (thumb) {\r\n            this.add(thumb, null); // Put into container but not layout it\r\n\r\n        }\r\n\r\n        // Input\r\n        var inputMode = GetValue(config, 'input', 0);\r\n        if (typeof (inputMode) === 'string') {\r\n            inputMode = INPUTMODE[inputMode];\r\n        }\r\n        switch (inputMode) {\r\n            case 0: // 'drag'\r\n                if (thumb) {\r\n                    thumb.setInteractive();\r\n                    this.scene.input.setDraggable(thumb);\r\n                    thumb.on('drag', _OnDragThumb_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"], this);\r\n                }\r\n                break;\r\n            case 1: // 'click'\r\n                this.setInteractive()\r\n                    .on('pointerdown', _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"], this)\r\n                    .on('pointermove', _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"], this);\r\n                break;\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('track', track);\r\n        this.addChildrenMap('indicator', indicator);\r\n        this.addChildrenMap('thumb', thumb);\r\n\r\n        var callback = GetValue(config, 'valuechangeCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'valuechangeCallbackScope', undefined);\r\n            this.eventEmitter.on('valuechange', callback, scope);\r\n        }\r\n        this.setEnable(GetValue(config, 'enable', undefined));\r\n        this.setGap(GetValue(config, 'gap', undefined));\r\n        this.setValue(GetValue(config, 'value', 0));\r\n    }\r\n\r\n    setEnable(enable) {\r\n        if (enable === undefined) {\r\n            enable = true;\r\n        }\r\n        this.enable = enable;\r\n        return this;\r\n    }\r\n\r\n    setGap(gap) {\r\n        this.gap = gap;\r\n        return this;\r\n    }\r\n\r\n    get value() {\r\n        return this._value;\r\n    }\r\n\r\n    set value(value) {\r\n        if (this.gap !== undefined) {\r\n            value = SnapTo(value, this.gap);\r\n        }\r\n        var oldValue = this._value;\r\n        this._value = Clamp(value, 0, 1);\r\n\r\n        if (oldValue !== this._value) {\r\n            this.updateThumb(this._value);\r\n            this.updateIndicator(this._value);\r\n            this.eventEmitter.emit('valuechange', this._value, oldValue, this.eventEmitter);\r\n        }\r\n    }\r\n\r\n    setValue(value, min, max) {\r\n        if ((value === undefined) || (value === null)) {\r\n            return this;\r\n        }\r\n\r\n        if (min !== undefined) {\r\n            value = Percent(value, min, max);\r\n        }\r\n        this.value = value;\r\n        return this;\r\n    }\r\n\r\n    addValue(inc, min, max) {\r\n        if (min !== undefined) {\r\n            inc = Percent(inc, min, max);\r\n        }\r\n        this.value += inc;\r\n        return this;\r\n    }\r\n\r\n    getValue(min, max) {\r\n        var value = this.value;\r\n        if (min !== undefined) {\r\n            value = Linear(min, max, value);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        this.updateThumb();\r\n        this.updateIndicator();\r\n        return this;\r\n    }\r\n}\r\n\r\nconst INPUTMODE = {\r\n    drag: 0,\r\n    click: 1,\r\n    none: -1,\r\n}\r\n\r\nvar methods = {\r\n    getStartPoint: _GetStartPoint_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n    getEndPoint: _GetEndPoint_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\r\n    updateThumb: _UpdateThumb_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\r\n    updateIndicator: _UpdateIndicator_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"],\r\n}\r\nObject.assign(\r\n    Slider.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Slider);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/Slider.js?")},"./lib/rexui/templates/ui/slider/UpdateIndicator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/plugins/utils/size/ResizeGameObject.js");\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\nconst AlignLeft = Phaser.Display.Align.LEFT_CENTER;\r\nconst AlignTop = Phaser.Display.Align.TOP_CENTER;\r\n\r\nvar UpdateIndicator = function (t) {\r\n    var indicator = this.childrenMap.indicator;\r\n    if (indicator === undefined) {\r\n        return this;\r\n    }\r\n\r\n    if (t === undefined) {\r\n        t = this.value;\r\n    }\r\n\r\n    var newWidth, newHeight;\r\n    var thumb = this.childrenMap.thumb;\r\n    if (thumb) {\r\n        if (this.orientation === 0) { // x, extend height\r\n            var thumbBottom = (thumb.y - (thumb.displayHeight * thumb.originY)) + thumb.displayHeight;\r\n            newHeight = thumbBottom - this.top;\r\n        } else { // y, extend width\r\n            var thumbRight = (thumb.x - (thumb.displayWidth * thumb.originX)) + thumb.displayWidth;\r\n            newWidth = thumbRight - this.left;\r\n        }\r\n    } else {\r\n        if (this.orientation === 0) { // x, extend height\r\n            newHeight = this.height * t;\r\n        } else { // y, extend width\r\n            newWidth = this.width * t;\r\n        }\r\n    }\r\n    Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(indicator, newWidth, newHeight);\r\n    var align = (this.orientation === 1) ? AlignLeft : AlignTop;\r\n    AlignIn(indicator, this, align);\r\n    this.resetChildPositionState(indicator);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateIndicator);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/UpdateIndicator.js?')},"./lib/rexui/templates/ui/slider/UpdateThumb.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PercentToPosition_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PercentToPosition.js */ "./lib/rexui/templates/ui/slider/PercentToPosition.js");\n\r\n\r\nvar UpdateThumb = function (t) {\r\n    var thumb = this.childrenMap.thumb;\r\n    if (thumb === undefined) {\r\n        return this;\r\n    }\r\n\r\n    if (t === undefined) {\r\n        t = this.value;\r\n    }\r\n    Object(_PercentToPosition_js__WEBPACK_IMPORTED_MODULE_0__["default"])(t, this.getStartPoint(), this.getEndPoint(), thumb);\r\n    this.resetChildPositionState(thumb);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateThumb);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/slider/UpdateThumb.js?')},"./lib/rexui/templates/ui/swipe/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Swipe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Swipe.js */ "./lib/rexui/templates/ui/swipe/Swipe.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'swipe\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Swipe\', _Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/swipe/Factory.js?')},"./lib/rexui/templates/ui/swipe/Swipe.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/swipe/Swipe.js */ "./lib/rexui/plugins/input/gestures/swipe/Swipe.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/swipe/Swipe.js?')},"./lib/rexui/templates/ui/tabs/ButtonMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/Hide.js */ "./lib/rexui/templates/ui/utils/Hide.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getButtonsSizer(groupName) {\r\n        return this.childrenMap[groupName + \'ButtonsSizer\'];\r\n    },\r\n\r\n    getButton(groupName, index) {\r\n        var buttonsSizer = this.getButtonsSizer(groupName);\r\n        return (buttonsSizer) ? buttonsSizer.getButton(index) : undefined;\r\n    },\r\n\r\n    emitButtonClick(groupName, index) {\r\n        var buttonsSizer = this.getButtonsSizer(groupName);\r\n        if (!buttonsSizer) {\r\n            return this;\r\n        }\r\n        buttonsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    emitLeftButtonClick(index) {\r\n        this.childrenMap.leftButtonsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    emitRightButtonClick(index) {\r\n        this.childrenMap.rightButtonsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    emitTopButtonClick(index) {\r\n        this.childrenMap.topButtonsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    emitBottomButtonClick(index) {\r\n        this.childrenMap.bottomButtonsSizer.emitButtonClick(index);\r\n        return this;\r\n    },\r\n\r\n    getLeftButton(index) {\r\n        return this.childrenMap.leftButtonsSizer.getButton(index);\r\n    },\r\n\r\n    getRightButton(index) {\r\n        return this.childrenMap.rightButtonsSizer.getButton(index);\r\n    },\r\n\r\n    getTopButton(index) {\r\n        return this.childrenMap.topButtonsSizer.getButton(index);\r\n    },\r\n\r\n    getBottomButton(index) {\r\n        return this.childrenMap.bottomButtonsSizer.getButton(index);\r\n    },\r\n\r\n    showButton(groupName, index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Show"])(this.getButton(groupName, index));\r\n        return this;\r\n    },\r\n\r\n    showLeftButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Show"])(this.getLeftButton(index));\r\n        return this;\r\n    },\r\n\r\n    showRightButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Show"])(this.getRightButton(index));\r\n        return this;\r\n    },\r\n\r\n    showTopButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Show"])(this.getTopButton(index));\r\n        return this;\r\n    },\r\n\r\n    showBottomButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Show"])(this.getBottomButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideButton(groupName, index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Hide"])(this.getButton(groupName, index));\r\n        return this;\r\n    },\r\n\r\n    hideLeftButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Hide"])(this.getLeftButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideRightButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Hide"])(this.getRightButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideTopButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Hide"])(this.getTopButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideBottomButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_0__["Hide"])(this.getBottomButton(index));\r\n        return this;\r\n    },\r\n\r\n    forEachLeftButton(callback, scope) {\r\n        this.childrenMap.leftButtonsSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n\r\n    forEachRightButton(callback, scope) {\r\n        this.childrenMap.rightButtonsSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n\r\n    forEachTopButton(callback, scope) {\r\n        this.childrenMap.topButtonsSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n\r\n    forEachBottomButton(callback, scope) {\r\n        this.childrenMap.bottomButtonsSizer.forEachButtton(callback, scope);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tabs/ButtonMethods.js?')},"./lib/rexui/templates/ui/tabs/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Tabs_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tabs.js */ "./lib/rexui/templates/ui/tabs/Tabs.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'tabs\', function (config) {\r\n    var gameObject = new _Tabs_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Tabs\', _Tabs_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Tabs_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tabs/Factory.js?')},"./lib/rexui/templates/ui/tabs/Tabs.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gridsizer_GridSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../gridsizer/GridSizer.js */ \"./lib/rexui/templates/ui/gridsizer/GridSizer.js\");\n/* harmony import */ var _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../buttons/Buttons.js */ \"./lib/rexui/templates/ui/buttons/Buttons.js\");\n/* harmony import */ var _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ButtonMethods.js */ \"./lib/rexui/templates/ui/tabs/ButtonMethods.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Tabs extends _gridsizer_GridSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        // Create sizer\r\n        config.column = 3;\r\n        config.row = 3;\r\n        super(scene, config);\r\n        this.type = 'rexTabs';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var panel = GetValue(config, 'panel', undefined);\r\n        var leftButtons = GetValue(config, 'leftButtons', undefined);\r\n        if (leftButtons && leftButtons.length === 0) {\r\n            leftButtons = undefined;\r\n        }\r\n        var leftButtonsSizer;\r\n        var rightButtons = GetValue(config, 'rightButtons', undefined);\r\n        if (rightButtons && rightButtons.length === 0) {\r\n            rightButtons = undefined;\r\n        }\r\n        var rightButtonsSizer;\r\n        var topButtons = GetValue(config, 'topButtons', undefined);\r\n        if (topButtons && topButtons.length === 0) {\r\n            topButtons = undefined;\r\n        }\r\n        var topButtonsSizer;\r\n        var bottomButtons = GetValue(config, 'bottomButtons', undefined);\r\n        if (bottomButtons && bottomButtons.length === 0) {\r\n            bottomButtons = undefined;\r\n        }\r\n        var bottomButtonsSizer;\r\n        var clickConfig = GetValue(config, 'click', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n        var leftButtonsOffset = GetValue(config, 'space.leftButtonsOffset', 0);\r\n        var rightButtonsOffset = GetValue(config, 'space.rightButtonsOffset', 0);\r\n        var toptButtonsOffset = GetValue(config, 'space.topButtonsOffset', 0);\r\n        var bottomButtonsOffset = GetValue(config, 'space.bottomButtonsOffset', 0);\r\n        var leftButtonSpace = GetValue(config, 'space.leftButton', 0);\r\n        var rightButtonSpace = GetValue(config, 'space.rightButton', 0);\r\n        var topButtonSpace = GetValue(config, 'space.topButton', 0);\r\n        var bottomButtonSpace = GetValue(config, 'space.bottomButton', 0);\r\n\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (panel) {\r\n            var padding = {\r\n                left: (leftButtons) ? 0 : paddingLeft,\r\n                right: (rightButtons) ? 0 : paddingRight,\r\n                top: (topButtons) ? 0 : paddingTop,\r\n                bottom: (bottomButtons) ? 0 : paddingBottom\r\n            };\r\n            this.add(panel, 1, 1, 'center', padding, true);\r\n        }\r\n\r\n        if (leftButtons) {\r\n            leftButtonsSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'left',\r\n                buttons: leftButtons,\r\n                orientation: 1, // Top-Bottom\r\n                space: leftButtonSpace,\r\n                align: GetValue(config, 'align.leftButtons', undefined),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n            var padding = {\r\n                left: paddingLeft,\r\n                top: leftButtonsOffset,\r\n            };\r\n            this.add(leftButtonsSizer, 0, 1, 'top', padding, false);\r\n        }\r\n\r\n        if (rightButtons) {\r\n            rightButtonsSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'right',\r\n                buttons: rightButtons,\r\n                orientation: 1, // Top-Bottom\r\n                space: rightButtonSpace,\r\n                align: GetValue(config, 'align.rightButtons', undefined),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n            var padding = {\r\n                right: paddingRight,\r\n                top: rightButtonsOffset,\r\n            };\r\n            this.add(rightButtonsSizer, 2, 1, 'top', padding, false);\r\n        }\r\n\r\n        if (topButtons) {\r\n            topButtonsSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'top',\r\n                buttons: topButtons,\r\n                orientation: 0, // Left-Right\r\n                space: topButtonSpace,\r\n                align: GetValue(config, 'align.topButtons', undefined),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n            var padding = {\r\n                top: paddingTop,\r\n                left: toptButtonsOffset,\r\n            };\r\n            this.add(topButtonsSizer, 1, 0, 'left', padding, false);\r\n        }\r\n\r\n        if (bottomButtons) {\r\n            bottomButtonsSizer = new _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](scene, {\r\n                groupName: 'bottom',\r\n                buttons: bottomButtons,\r\n                orientation: 0, // Left-Right\r\n                space: bottomButtonSpace,\r\n                align: GetValue(config, 'align.bottomButtons', undefined),\r\n                click: clickConfig,\r\n                eventEmitter: this.eventEmitter,\r\n            });\r\n            var padding = {\r\n                bottom: paddingBottom,\r\n                left: bottomButtonsOffset,\r\n            };\r\n            this.add(bottomButtonsSizer, 1, 2, 'left', padding, false);\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('panel', panel);\r\n        this.addChildrenMap('leftButtons', leftButtons);\r\n        this.addChildrenMap('rightButtons', rightButtons);\r\n        this.addChildrenMap('topButtons', topButtons);\r\n        this.addChildrenMap('bottomButtons', bottomButtons);\r\n        this.addChildrenMap('leftButtonsSizer', leftButtonsSizer);\r\n        this.addChildrenMap('rightButtonsSizer', rightButtonsSizer);\r\n        this.addChildrenMap('topButtonsSizer', topButtonsSizer);\r\n        this.addChildrenMap('bottomButtonsSizer', bottomButtonsSizer);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Tabs.prototype,\r\n    _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Tabs);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tabs/Tabs.js?")},"./lib/rexui/templates/ui/tagtext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TagText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TagText.js */ "./lib/rexui/templates/ui/tagtext/TagText.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'tagText\', function (x, y, text, style) {\r\n    var gameObject = new _TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TagText\', _TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tagtext/Factory.js?')},"./lib/rexui/templates/ui/tagtext/TagText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_text_tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/text/tagtext/TagText.js */ "./lib/rexui/plugins/gameobjects/text/tagtext/TagText.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_text_tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tagtext/TagText.js?')},"./lib/rexui/templates/ui/tap/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tap.js */ "./lib/rexui/templates/ui/tap/Tap.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'tap\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Tap\', _Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tap/Factory.js?')},"./lib/rexui/templates/ui/tap/Tap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/gestures/tap/Tap.js */ "./lib/rexui/plugins/input/gestures/tap/Tap.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/tap/Tap.js?')},"./lib/rexui/templates/ui/textarea/AppendText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar AppendText = function (text) {\r\n    this.setText(this.text + text);\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (AppendText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textarea/AppendText.js?')},"./lib/rexui/templates/ui/textarea/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextArea_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextArea.js */ "./lib/rexui/templates/ui/textarea/TextArea.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'textArea\', function (config) {\r\n    var gameObject = new _TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TextArea\', _TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textarea/Factory.js?')},"./lib/rexui/templates/ui/textarea/InjectProperties.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar InjectProperties = function(textBlock) {\r\n    Object.defineProperty(textBlock, 'childOY', {\r\n        configurable: true,\r\n        get: function () {\r\n            return textBlock.textOY;\r\n        },\r\n        set: function (value) {\r\n            textBlock.textOY = value;\r\n        }\r\n    });\r\n    Object.defineProperty(textBlock, 'topChildOY', {\r\n        get: function () {\r\n            return textBlock.topTextOY;\r\n        }\r\n    });\r\n    Object.defineProperty(textBlock, 'bottomChildOY', {\r\n        get: function () {\r\n            return textBlock.bottomTextOY;\r\n        }\r\n    });\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InjectProperties);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textarea/InjectProperties.js?")},"./lib/rexui/templates/ui/textarea/SetText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetText = function (text) {\r\n    var textBlock = this.childrenMap.child;\r\n    textBlock.setText(text);\r\n\r\n    this.resizeController();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SetText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textarea/SetText.js?')},"./lib/rexui/templates/ui/textarea/TextArea.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ "./lib/rexui/templates/ui/utils/scrollable/Scrollable.js");\n/* harmony import */ var _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../textblock/TextBlock.js */ "./lib/rexui/templates/ui/textblock/TextBlock.js");\n/* harmony import */ var _InjectProperties_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InjectProperties.js */ "./lib/rexui/templates/ui/textarea/InjectProperties.js");\n/* harmony import */ var _SetText_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SetText.js */ "./lib/rexui/templates/ui/textarea/SetText.js");\n/* harmony import */ var _AppendText_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AppendText.js */ "./lib/rexui/templates/ui/textarea/AppendText.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextArea extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create text-block\r\n        var textObject = GetValue(config, \'text\', undefined);\r\n        var textWidth = GetValue(config, \'textWidth\', undefined);\r\n        var textHeight = GetValue(config, \'textHeight\', undefined);\r\n        var textMask = GetValue(config, \'textMask\', true);\r\n        var content = GetValue(config, \'content\', \'\');\r\n        var textBlock = new _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_1__["default"](scene, {\r\n            width: textWidth,\r\n            height: textHeight,\r\n            text: textObject,\r\n            textMask: textMask,\r\n            content: content,\r\n            clamplTextOY: GetValue(config, \'clamplChildOY\', false),\r\n        });\r\n        var proportion = (textWidth === undefined) ? 1 : 0;\r\n        var expand = (textHeight === undefined);\r\n        // Inject properties for scrollable interface\r\n        Object(_InjectProperties_js__WEBPACK_IMPORTED_MODULE_2__["default"])(textBlock);\r\n\r\n        // Fill config of scrollable\r\n        config.scrollMode = 0; // Vertical\r\n        config.type = \'rexTextArea\';\r\n        config.child = {\r\n            gameObject: textBlock,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, \'space\', undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.text;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap(\'text\', textObject);\r\n    }\r\n\r\n    get text() {\r\n        return this.childrenMap.child.text;\r\n    }\r\n\r\n    get linesCount() {\r\n        return this.childrenMap.child.linesCount;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    setText: _SetText_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    appendText: _AppendText_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n}\r\nObject.assign(\r\n    TextArea.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TextArea);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textarea/TextArea.js?')},"./lib/rexui/templates/ui/textblock/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextBlock.js */ "./lib/rexui/templates/ui/textblock/TextBlock.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'textBlock\', function (x, y, minWidth, minHeight, textGameObject, config) {\r\n    var gameObject = new _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, textGameObject, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TextBlock\', _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/Factory.js?')},"./lib/rexui/templates/ui/textblock/GetLines.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetLines = function (startLineIdx) {\r\n    var endLineIdx = startLineIdx + this.textObject.style.maxLines;\r\n    var text;\r\n    if (this.textObjectType === 0) {\r\n        text = this.lines.slice(startLineIdx, endLineIdx).join('\\n');\r\n    } else {\r\n        var startIdx = this.lines.getLineStartIndex(startLineIdx);\r\n        var endIdx = this.lines.getLineEndIndex(endLineIdx - 1);\r\n        text = this.lines.getSliceTagText(startIdx, endIdx, true);\r\n    }\r\n    return text;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetLines);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/GetLines.js?")},"./lib/rexui/templates/ui/textblock/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ResizeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ResizeText.js */ "./lib/rexui/templates/ui/textblock/ResizeText.js");\n/* harmony import */ var _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ResetTextObjectPosition.js */ "./lib/rexui/templates/ui/textblock/ResetTextObjectPosition.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/plugins/utils/actions/GlobZone.js");\n\r\n\r\n\r\n\r\nconst AlignIn = Phaser.Display.Align.In.QuickSet;\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.layoutInit(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = this.minWidth;\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = this.minHeight;\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout children\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var x, y, width, height; // Align zone\r\n\r\n    // Layout text child\r\n    // Skip invisible child\r\n    child = this.textObject;\r\n    if (!child.rexSizer.hidden) {\r\n        childConfig = child.rexSizer;\r\n        padding = childConfig.padding;\r\n        x = (startX + padding.left);\r\n        y = (startY + padding.top);\r\n        width = this.width - padding.left - padding.right;\r\n        height = this.height - padding.top - padding.bottom;\r\n        _ResizeText_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, child, width, height);\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__["default"].setPosition(x, y).setSize(width, height);\r\n        AlignIn(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__["default"], childConfig.align);\r\n\r\n        // Layout text mask before reset text position\r\n        if (this.textMask) {\r\n            this.textMask.setPosition().resize();\r\n            this.resetChildPositionState(this.textMask);\r\n        }\r\n\r\n        childConfig.preOffsetY = 0; // Clear preOffsetY\r\n        _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this);\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/Layout.js?')},"./lib/rexui/templates/ui/textblock/LinesCountToTextHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LinesCountToTextHeight = function (linesCount) {\r\n    // height = (maxLines * (lineHeight + lineSpacing)) - lineSpacing\r\n    return (linesCount * (this.textLineHeight + this.textLineSpacing)) - this.textLineSpacing;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LinesCountToTextHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/LinesCountToTextHeight.js?')},"./lib/rexui/templates/ui/textblock/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetTextObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetTextObject.js */ "./lib/rexui/templates/ui/textblock/SetTextObject.js");\n/* harmony import */ var _SetText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetText.js */ "./lib/rexui/templates/ui/textblock/SetText.js");\n/* harmony import */ var _UpdateTextObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./UpdateTextObject.js */ "./lib/rexui/templates/ui/textblock/UpdateTextObject.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/templates/ui/textblock/Layout.js");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setTextObject: _SetTextObject_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    setText: _SetText_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    updateTextObject: _UpdateTextObject_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/Methods.js?')},"./lib/rexui/templates/ui/textblock/ResetTextObjectPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ResetTextObjectPosition = function () {\r\n    var config = this.textObject.rexSizer;\r\n    this.textObject.y += (config.offsetY - config.preOffsetY);\r\n    config.preOffsetY = config.offsetY;\r\n    this.resetChildPositionState(this.textObject);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (ResetTextObjectPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/ResetTextObjectPosition.js?')},"./lib/rexui/templates/ui/textblock/ResizeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ "./lib/rexui/templates/ui/textblock/TextHeightToLinesCount.js");\n\r\n\r\nvar ResizeText = function (textObject, width, height) {\r\n    if ((textObject.width === width) && (textObject.height === height)) {\r\n        return;\r\n    }\r\n\r\n    textObject.setFixedSize(width, height);\r\n\r\n    var style = textObject.style;\r\n    var wrapWidth = Math.max(width, 0);\r\n\r\n    var maxLines = Math.ceil(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, height)) + 1;\r\n\r\n    if (this.textObjectType === 0) {\r\n        style.wordWrapWidth = wrapWidth;\r\n        style.maxLines = maxLines;\r\n    } else {\r\n        style.wrapWidth = wrapWidth;\r\n        style.maxLines = maxLines;\r\n    }\r\n\r\n    // Render content again\r\n    this.setText();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResizeText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/ResizeText.js?')},"./lib/rexui/templates/ui/textblock/SetText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetText = function (text) {\r\n    if (text !== undefined) {\r\n        this.text = text;\r\n    }\r\n\r\n    // Wrap content in lines\r\n    if (this.textObjectType === 0) {\r\n        this.lines = this.textObject.getWrappedText(this.text); // lines in array\r\n    } else {\r\n        this.lines = this.textObject.getPenManager(this.text, this.lines); // pen manager\r\n    }\r\n\r\n    this.updateTextObject();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SetText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/SetText.js?')},"./lib/rexui/templates/ui/textblock/SetTextObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ "./lib/rexui/templates/ui/utils/GetBoundsConfig.js");\n/* harmony import */ var _plugins_utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/utils/text/IsTextGameObject.js */ "./lib/rexui/plugins/utils/text/IsTextGameObject.js");\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/mask/DefaultMask.js */ "./lib/rexui/plugins/utils/mask/DefaultMask.js");\n\r\n\r\n\r\n\r\nconst ALIGN_LEFTTOP = Phaser.Display.Align.TOP_LEFT;\r\n\r\nvar SetTextObject = function (gameObject, paddingConfig, maskEnable) {\r\n    if (maskEnable === undefined) {\r\n        maskEnable = true;\r\n    }\r\n\r\n    this.add(gameObject);\r\n    if (paddingConfig === undefined) {\r\n        paddingConfig = 0;\r\n    }\r\n\r\n    var config = this.getSizerConfig(gameObject);\r\n    config.parent = this;\r\n    config.align = ALIGN_LEFTTOP;\r\n    config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(paddingConfig);\r\n    config.expand = true;\r\n    this.textObject = gameObject;\r\n    this.textObjectType = (Object(_plugins_utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(gameObject)) ? 0 : 1;\r\n    // Add more variables\r\n    config.preOffsetY = 0;\r\n    config.offsetY = 0;\r\n\r\n    // Create mask of text object\r\n    if (maskEnable) {\r\n        this.textMask = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__["default"](this.textObject);\r\n        this.textObject.setMask(this.textMask.createGeometryMask());\r\n        this.add(this.textMask);\r\n    }\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetTextObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/SetTextObject.js?')},"./lib/rexui/templates/ui/textblock/TextBlock.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/templates/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/templates/ui/textblock/Methods.js\");\n/* harmony import */ var _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LinesCountToTextHeight.js */ \"./lib/rexui/templates/ui/textblock/LinesCountToTextHeight.js\");\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ \"./lib/rexui/templates/ui/textblock/TextHeightToLinesCount.js\");\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextBlock extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexTextBlock';\r\n        this.textObject = undefined;\r\n        this.textMask = undefined;\r\n        this.textObjectType = undefined;\r\n        this.lines = undefined; // array (default text object), or pens-manager (tag text object)\r\n        this.text = GetValue(config, 'content', '');\r\n        this._textOY = 0;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n\r\n        this.setClampMode(GetValue(config, 'clamplTextOY', true));\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var textObject = GetValue(config, 'text', undefined);\r\n        if (textObject === undefined) {\r\n            textObject = createDefaultTextObject(scene);\r\n        }\r\n        var textMaskEnable = GetValue(config, 'textMask', true);\r\n\r\n        // Space\r\n        var paddingConfig = GetValue(config, 'space', undefined);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        this.setTextObject(textObject, paddingConfig, textMaskEnable);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.textObject = undefined;\r\n        this.textMask = undefined;\r\n        if (this.lines === undefined) {\r\n            // Do nothing\r\n        } else if (this.textObjectType === 0) {\r\n            this.lines.length = 0;\r\n        } else {\r\n            this.lines.destroy();\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampTextOYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get textLineHeight() {\r\n        var style = this.textObject.style;\r\n        return style.metrics.fontSize + style.strokeThickness;\r\n    }\r\n\r\n    get textLineSpacing() {\r\n        return this.textObject.lineSpacing;\r\n    }\r\n\r\n    get linesCount() {\r\n        var count;\r\n        if (this.lines === undefined) {\r\n            count = 0;\r\n        } else if (this.textObjectType === 0) {\r\n            count = this.lines.length;\r\n        } else {\r\n            count = this.lines.linesCount;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    get visibleLinesCount() {\r\n        return Math.floor(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].call(this, this.textObject.height));\r\n    }\r\n\r\n    get topTextOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomTextOY() {\r\n        return -this.textVisibleHeight;\r\n    }\r\n\r\n    get textHeight() {\r\n        return _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].call(this, this.linesCount);\r\n    }\r\n\r\n    get textObjectHeight() {\r\n        return this.textObject.height;\r\n    }\r\n\r\n    get textVisibleHeight() {\r\n        var h;\r\n        var textHeight = this.textHeight;\r\n        var textObjectHeight = this.textObjectHeight;\r\n        if (textHeight > textObjectHeight) {\r\n            h = textHeight - textObjectHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    textOYExceedTop(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.textOY;\r\n        }\r\n        return (oy > this.topTextOY);\r\n    }\r\n\r\n    textOYExeceedBottom(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.textOY;\r\n        }\r\n        return (oy < this.bottomTextOY);\r\n    }\r\n\r\n    get textOY() {\r\n        return this._textOY;\r\n    }\r\n\r\n    set textOY(oy) {\r\n        var topTextOY = this.topTextOY;\r\n        var bottomTextOY = this.bottomTextOY;\r\n        var textOYExceedTop = this.textOYExceedTop(oy);\r\n        var textOYExeceedBottom = this.textOYExeceedBottom(oy);\r\n\r\n        if (this.clampTextOYMode) {\r\n            if (this.visibleLinesCount > this.linesCount) {\r\n                oy = 0;\r\n            } else if (textOYExceedTop) {\r\n                oy = topTextOY\r\n            } else if (textOYExeceedBottom) {\r\n                oy = bottomTextOY;\r\n            }\r\n        }\r\n\r\n        if (this._textOY !== oy) {\r\n            this._textOY = oy;\r\n            this.updateTextObject();\r\n        }\r\n\r\n        if (textOYExceedTop) {\r\n            if (!this.execeedTopState) {\r\n                this.emit('execeedtop', this, oy, topTextOY);\r\n            }\r\n        }\r\n        this.execeedTopState = textOYExceedTop;\r\n\r\n        if (textOYExeceedBottom) {\r\n            if (!this.execeedBottomState) {\r\n                this.emit('execeedbottom', this, oy, bottomTextOY);\r\n            }\r\n        }\r\n        this.execeedBottomState = textOYExeceedBottom;\r\n    }\r\n\r\n    setTextOY(oy) {\r\n        this.textOY = oy;\r\n        return this;\r\n    }\r\n\r\n    set t(value) {\r\n        this.textOY = -this.textVisibleHeight * value;\r\n    }\r\n\r\n    get t() {\r\n        var textVisibleHeight = this.textVisibleHeight;\r\n        if (textVisibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.textOY / -textVisibleHeight);\r\n    }\r\n\r\n    setTextOYByPercentage(percentage) {\r\n        this.t = percentage;\r\n        return this;\r\n    }\r\n}\r\n\r\nvar createDefaultTextObject = function (scene) {\r\n    return scene.add.text(0, 0, '');\r\n};\r\n\r\nObject.assign(\r\n    TextBlock.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextBlock);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/TextBlock.js?")},"./lib/rexui/templates/ui/textblock/TextHeightToLinesCount.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar TextHeightToLinesCount = function (height) {\r\n    // height = (maxLines * (lineHeight + lineSpacing)) - lineSpacing\r\n    return (height - this.textLineSpacing) / (this.textLineHeight + this.textLineSpacing);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (TextHeightToLinesCount);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/TextHeightToLinesCount.js?')},"./lib/rexui/templates/ui/textblock/UpdateTextObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ "./lib/rexui/templates/ui/textblock/TextHeightToLinesCount.js");\n/* harmony import */ var _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LinesCountToTextHeight.js */ "./lib/rexui/templates/ui/textblock/LinesCountToTextHeight.js");\n/* harmony import */ var _GetLines_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetLines.js */ "./lib/rexui/templates/ui/textblock/GetLines.js");\n/* harmony import */ var _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ResetTextObjectPosition.js */ "./lib/rexui/templates/ui/textblock/ResetTextObjectPosition.js");\n\r\n\r\n\r\n\r\n\r\nvar UpdateTextObject = function () {\r\n    var startLineIndex = Math.max(Math.floor(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, -this.textOY)), 0);\r\n    var textOffset = _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this, startLineIndex) + this.textOY;\r\n\r\n    this.textObject.setText(_GetLines_js__WEBPACK_IMPORTED_MODULE_2__["default"].call(this, startLineIndex));\r\n    this.textObject.rexSizer.offsetY = textOffset;\r\n    _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"].call(this);\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateTextObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textblock/UpdateTextObject.js?')},"./lib/rexui/templates/ui/textbox/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextBox_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextBox.js */ "./lib/rexui/templates/ui/textbox/TextBox.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'textBox\', function (config) {\r\n    var gameObject = new _TextBox_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TextBox\', _TextBox_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TextBox_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textbox/Factory.js?')},"./lib/rexui/templates/ui/textbox/TextBox.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _label_Label_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../label/Label.js */ \"./lib/rexui/templates/ui/label/Label.js\");\n/* harmony import */ var _plugins_textpage_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugins/textpage.js */ \"./lib/rexui/plugins/textpage.js\");\n/* harmony import */ var _plugins_texttyping_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/texttyping.js */ \"./lib/rexui/plugins/texttyping.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextBox extends _label_Label_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {\r\n                text: createDefaultTextObject(scene)\r\n            }\r\n        }\r\n\r\n        super(scene, config);\r\n        this.type = 'rexTextBox';\r\n\r\n        var text = this.childrenMap.text;\r\n        this.page = new _plugins_textpage_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](text, GetValue(config, 'page', undefined));\r\n        this.typing = new _plugins_texttyping_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](text, GetValue(config, 'type', undefined));\r\n        this.typing\r\n            .on('complete', this.onPageEnd, this)\r\n            .on('type', this.onType, this);\r\n\r\n        this.textWidth = text.width;\r\n        this.textHeight = text.height;\r\n    }\r\n\r\n    start(text, speed) {\r\n        this.page.setText(text);\r\n        if (speed !== undefined) {\r\n            this.typing.setTypeSpeed(speed);\r\n        }\r\n        this.typeNextPage();\r\n        return this;\r\n    }\r\n\r\n    typeNextPage() {\r\n        if (!this.page.isLastPage) {\r\n            var txt = this.page.getNextPage();\r\n            this.typing.start(txt);\r\n        } else {\r\n            this.emit('complete');\r\n        }\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        this.typing.pause();\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        this.typing.resume();\r\n        return this;\r\n    }\r\n\r\n    stop(showAllText) {\r\n        this.typing.stop(showAllText);\r\n        return this;\r\n    }\r\n\r\n    get isTyping() {\r\n        return this.typing.isTyping;\r\n    }\r\n\r\n    get isLastPage() {\r\n        return this.page.isLastPage;\r\n    }\r\n\r\n    get isFirstPage() {\r\n        return this.page.isFirstPage;\r\n    }\r\n\r\n    get pageCount() {\r\n        return this.page.pageCount;\r\n    }\r\n\r\n    get pageIndex() {\r\n        return this.page.pageIndex;\r\n    }\r\n\r\n    onType() {\r\n        var text = this.childrenMap.text;\r\n        if ((this.textWidth !== text.width) || (this.textHeight !== text.height)) {\r\n            this.textWidth = text.width;\r\n            this.textHeight = text.height;\r\n            this.getTopmostSizer().layout();\r\n        }\r\n        this.emit('type');\r\n    }\r\n\r\n    onPageEnd() {\r\n        this.emit('pageend');\r\n    }\r\n\r\n}\r\n\r\nvar createDefaultTextObject = function (scene) {\r\n    return scene.add.text(0, 0, '', {\r\n        wordWrap: {\r\n            width: 200,\r\n        },\r\n        maxLines: 5\r\n    });\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextBox);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/textbox/TextBox.js?")},"./lib/rexui/templates/ui/toast/Const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    popUp: 0,\r\n    fadeIn: 1,\r\n    scaleDown: 0,\r\n    fadeOut: 1,\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/toast/Const.js?')},"./lib/rexui/templates/ui/toast/DefaultTransitCallbacks.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    popUp: function (gameObject, duration) {\r\n        gameObject.popUp(duration);\r\n    },\r\n\r\n    scaleDown: function (gameObject, duration) {\r\n        gameObject.scaleDownDestroy(duration, undefined, undefined, false);\r\n    },\r\n\r\n    fadeIn: function (gameObject, duration) {\r\n        gameObject.fadeIn(duration);\r\n    },\r\n\r\n    fadeOut: function (gameObject, duration) {\r\n        gameObject.fadeOut(duration, false);\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/toast/DefaultTransitCallbacks.js?')},"./lib/rexui/templates/ui/toast/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Toast_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Toast.js */ "./lib/rexui/templates/ui/toast/Toast.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'toast\', function (config) {\r\n    var gameObject = new _Toast_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Toast\', _Toast_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Toast_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/toast/Factory.js?')},"./lib/rexui/templates/ui/toast/Toast.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _label_Label_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../label/Label.js */ "./lib/rexui/templates/ui/label/Label.js");\n/* harmony import */ var _Const_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Const.js */ "./lib/rexui/templates/ui/toast/Const.js");\n/* harmony import */ var _DefaultTransitCallbacks_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DefaultTransitCallbacks.js */ "./lib/rexui/templates/ui/toast/DefaultTransitCallbacks.js");\n/* harmony import */ var _plugins_logic_runcommands_tcrp_Player_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/logic/runcommands/tcrp/Player.js */ "./lib/rexui/plugins/logic/runcommands/tcrp/Player.js");\n/* harmony import */ var _plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../plugins/utils/object/NOOP.js */ "./lib/rexui/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Toast extends _label_Label_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {\r\n                text: createDefaultTextObject(scene)\r\n            }\r\n        }\r\n\r\n        super(scene, config);\r\n        this.type = \'rexToast\';\r\n\r\n        this.setTransitInTime(GetValue(config, \'duration.in\', 200));\r\n        this.setDisplayTime(GetValue(config, \'duration.hold\', 1200));\r\n        this.setTransitOutTime(GetValue(config, \'duration.out\', 200));\r\n        this.setTransitInCallback(GetValue(config, \'transitIn\', _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].popUp));\r\n        this.setTransitOutCallback(GetValue(config, \'transitOut\', _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].scaleDown));\r\n\r\n        this.player = new _plugins_logic_runcommands_tcrp_Player_js__WEBPACK_IMPORTED_MODULE_3__["default"](this, { dtMode: 1 });\r\n        this.messages = [];\r\n\r\n        this.setVisible(false);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        this.player.destroy();\r\n        this.player = undefined;\r\n        this.messages = undefined;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setDisplayTime(time) {\r\n        this.displayTime = time;\r\n        return this;\r\n    }\r\n\r\n    setTransitOutTime(time) {\r\n        this.transitOutTime = time;\r\n        return this;\r\n    }\r\n\r\n    setTransitInTime(time) {\r\n        this.transitInTime = time;\r\n        return this;\r\n    }\r\n\r\n    setTransitInCallback(callback) {\r\n        if (typeof (callback) === \'string\') {\r\n            callback = _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"][callback];\r\n        }\r\n\r\n        switch (callback) {\r\n            case _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].popUp:\r\n                callback = _DefaultTransitCallbacks_js__WEBPACK_IMPORTED_MODULE_2__["default"].popUp;\r\n                break;\r\n            case _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].fadeIn:\r\n                callback = _DefaultTransitCallbacks_js__WEBPACK_IMPORTED_MODULE_2__["default"].fadeIn;\r\n                break;\r\n        }\r\n\r\n        this.transitInCallback = callback;\r\n        // callback = function(gameObject, duration) {}\r\n        return this;\r\n    }\r\n\r\n    setTransitOutCallback(callback) {\r\n        if (typeof (callback) === \'string\') {\r\n            callback = _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"][callback];\r\n        }\r\n\r\n        switch (callback) {\r\n            case _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].scaleDown:\r\n                callback = _DefaultTransitCallbacks_js__WEBPACK_IMPORTED_MODULE_2__["default"].scaleDown;\r\n                break;\r\n            case _Const_js__WEBPACK_IMPORTED_MODULE_1__["default"].fadeOut:\r\n                callback = _DefaultTransitCallbacks_js__WEBPACK_IMPORTED_MODULE_2__["default"].fadeOut;\r\n                break;\r\n        }\r\n\r\n        this.transitOutCallback = callback;\r\n        // callback = function(gameObject, duration) {}\r\n        return this;\r\n    }\r\n\r\n    show(callback) {\r\n        if (callback === undefined) {\r\n            // Try pop up a pendding message\r\n            if (this.messages.length === 0) {\r\n                return this;\r\n            }\r\n            callback = this.messages.shift();\r\n        }\r\n\r\n        if (this.player.isPlaying) {\r\n            // Pend message\r\n            this.messages.push(callback);\r\n            return this;\r\n        }\r\n\r\n        // Recover to initial state\r\n        this\r\n            .setScale(1, 1)\r\n            .setVisible(true);\r\n        if (typeof (callback) === \'string\') {\r\n            this.setText(callback);\r\n        } else {\r\n            callback(this);\r\n        }\r\n        this.layout();\r\n\r\n        var commands = [\r\n            [ // Transit-in\r\n                0, // time\r\n                [this.transitInCallback, this, this.transitInTime] // [callback, param, ...]\r\n            ],\r\n            [ // Hold\r\n                this.transitInTime,\r\n                [_plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__["default"]]\r\n            ],\r\n            [ // Transit-out\r\n                this.displayTime,\r\n                [this.transitOutCallback, this, this.transitOutTime]\r\n            ],\r\n            [ // End\r\n                this.transitOutTime,\r\n                [this.setVisible, false]\r\n            ],\r\n            [ // Complete - show next message\r\n                30, // Add a small delay before complete\r\n                [_plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__["default"]]\r\n            ]\r\n        ]\r\n        this.player\r\n            .load(commands, this)\r\n            .once(\'complete\', function () {\r\n                this.show();\r\n            }, this)\r\n            .start();\r\n\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Toast);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/toast/Toast.js?')},"./lib/rexui/templates/ui/ui-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _roundrectangle_Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./roundrectangle/Factory.js */ "./lib/rexui/templates/ui/roundrectangle/Factory.js");\n/* harmony import */ var _bbcodetext_Factory_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bbcodetext/Factory.js */ "./lib/rexui/templates/ui/bbcodetext/Factory.js");\n/* harmony import */ var _tagtext_Factory_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tagtext/Factory.js */ "./lib/rexui/templates/ui/tagtext/Factory.js");\n/* harmony import */ var _container_Factory_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./container/Factory.js */ "./lib/rexui/templates/ui/container/Factory.js");\n/* harmony import */ var _chart_Factory_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./chart/Factory.js */ "./lib/rexui/templates/ui/chart/Factory.js");\n/* harmony import */ var _circlemaskimage_Factory_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./circlemaskimage/Factory.js */ "./lib/rexui/templates/ui/circlemaskimage/Factory.js");\n/* harmony import */ var _ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ninepatch/Factory.js */ "./lib/rexui/templates/ui/ninepatch/Factory.js");\n/* harmony import */ var _video_Factory_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./video/Factory.js */ "./lib/rexui/templates/ui/video/Factory.js");\n/* harmony import */ var _youtubeplayer_Factory_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./youtubeplayer/Factory.js */ "./lib/rexui/templates/ui/youtubeplayer/Factory.js");\n/* harmony import */ var _sizer_Factory_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./sizer/Factory.js */ "./lib/rexui/templates/ui/sizer/Factory.js");\n/* harmony import */ var _gridsizer_Factory_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./gridsizer/Factory.js */ "./lib/rexui/templates/ui/gridsizer/Factory.js");\n/* harmony import */ var _fixwidthsizer_Factory_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./fixwidthsizer/Factory.js */ "./lib/rexui/templates/ui/fixwidthsizer/Factory.js");\n/* harmony import */ var _label_Factory_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./label/Factory.js */ "./lib/rexui/templates/ui/label/Factory.js");\n/* harmony import */ var _buttons_Factory_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./buttons/Factory.js */ "./lib/rexui/templates/ui/buttons/Factory.js");\n/* harmony import */ var _dialog_Factory_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./dialog/Factory.js */ "./lib/rexui/templates/ui/dialog/Factory.js");\n/* harmony import */ var _tabs_Factory_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./tabs/Factory.js */ "./lib/rexui/templates/ui/tabs/Factory.js");\n/* harmony import */ var _slider_Factory_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./slider/Factory.js */ "./lib/rexui/templates/ui/slider/Factory.js");\n/* harmony import */ var _gridtable_Factory_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./gridtable/Factory.js */ "./lib/rexui/templates/ui/gridtable/Factory.js");\n/* harmony import */ var _menu_Factory_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./menu/Factory.js */ "./lib/rexui/templates/ui/menu/Factory.js");\n/* harmony import */ var _textbox_Factory_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./textbox/Factory.js */ "./lib/rexui/templates/ui/textbox/Factory.js");\n/* harmony import */ var _numberbar_Factory_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./numberbar/Factory.js */ "./lib/rexui/templates/ui/numberbar/Factory.js");\n/* harmony import */ var _pages_Factory_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./pages/Factory.js */ "./lib/rexui/templates/ui/pages/Factory.js");\n/* harmony import */ var _textblock_Factory_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./textblock/Factory.js */ "./lib/rexui/templates/ui/textblock/Factory.js");\n/* harmony import */ var _textarea_Factory_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./textarea/Factory.js */ "./lib/rexui/templates/ui/textarea/Factory.js");\n/* harmony import */ var _scrollableblock_Factory_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./scrollableblock/Factory.js */ "./lib/rexui/templates/ui/scrollableblock/Factory.js");\n/* harmony import */ var _scrollablepanel_Factory_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./scrollablepanel/Factory.js */ "./lib/rexui/templates/ui/scrollablepanel/Factory.js");\n/* harmony import */ var _toast_Factory_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./toast/Factory.js */ "./lib/rexui/templates/ui/toast/Factory.js");\n/* harmony import */ var _tap_Factory_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./tap/Factory.js */ "./lib/rexui/templates/ui/tap/Factory.js");\n/* harmony import */ var _press_Factory_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./press/Factory.js */ "./lib/rexui/templates/ui/press/Factory.js");\n/* harmony import */ var _swipe_Factory_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./swipe/Factory.js */ "./lib/rexui/templates/ui/swipe/Factory.js");\n/* harmony import */ var _pan_Factory_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./pan/Factory.js */ "./lib/rexui/templates/ui/pan/Factory.js");\n/* harmony import */ var _pinch_Factory_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./pinch/Factory.js */ "./lib/rexui/templates/ui/pinch/Factory.js");\n/* harmony import */ var _rotate_Factory_js__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./rotate/Factory.js */ "./lib/rexui/templates/ui/rotate/Factory.js");\n/* harmony import */ var _flip_Factory_js__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./flip/Factory.js */ "./lib/rexui/templates/ui/flip/Factory.js");\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./utils/Hide.js */ "./lib/rexui/templates/ui/utils/Hide.js");\n/* harmony import */ var _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../../plugins/behaviors/textedit/Edit.js */ "./lib/rexui/plugins/behaviors/textedit/Edit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass UIPlugin extends Phaser.Plugins.ScenePlugin {\r\n    constructor(scene, pluginManager) {\r\n        super(scene, pluginManager);\r\n\r\n        this.add = new _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_0__["default"](scene);\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    hide: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_35__["Hide"],\r\n    show: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_35__["Show"],\r\n    isShown: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_35__["IsShown"],\r\n    edit: _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_36__["default"],\r\n}\r\n\r\nObject.assign(\r\n    UIPlugin.prototype,\r\n    methods\r\n);\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UIPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/ui-plugin.js?')},"./lib/rexui/templates/ui/utils/AlignConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst ALIGN = Phaser.Display.Align;\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    center: ALIGN.CENTER,\r\n    left: ALIGN.LEFT_CENTER,\r\n    right: ALIGN.RIGHT_CENTER,\r\n    top: ALIGN.TOP_CENTER,\r\n    bottom: ALIGN.BOTTOM_CENTER,\r\n\r\n    'left-top': ALIGN.TOP_LEFT,\r\n    'left-center': ALIGN.LEFT_CENTER,\r\n    'left-bottom': ALIGN.LEFT_BOTTOM,\r\n    'center-top': ALIGN.TOP_CENTER,\r\n    'center-center': ALIGN.CENTER,\r\n    'center-bottom': ALIGN.BOTTOM_CENTER,\r\n    'right-top': ALIGN.TOP_RIGHT,\r\n    'right-center': ALIGN.RIGHT_CENTER,\r\n    'right-bottom': ALIGN.RIGHT_BOTTOM\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/AlignConst.js?")},"./lib/rexui/templates/ui/utils/GetBoundsConfig.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nvar GetBoundsConfig = function (config, out) {\r\n    if (out === undefined) {\r\n        out = {};\r\n    }\r\n    if (typeof (config) === 'number') {\r\n        out.left = config;\r\n        out.right = config;\r\n        out.top = config;\r\n        out.bottom = config;\r\n    } else {\r\n        out.left = GetValue(config, 'left', 0);\r\n        out.right = GetValue(config, 'right', 0);\r\n        out.top = GetValue(config, 'top', 0);\r\n        out.bottom = GetValue(config, 'bottom', 0);\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetBoundsConfig);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/GetBoundsConfig.js?")},"./lib/rexui/templates/ui/utils/GetScrollMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollModeConst.js */ \"./lib/rexui/templates/ui/utils/ScrollModeConst.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar GetScrollMode = function (config, key) {\r\n    if (key === undefined) {\r\n        key = 'scrollMode';\r\n    }\r\n    var scrollMode = GetValue(config, 'scrollMode', 0); // Vertical\r\n    if (typeof (scrollMode) === 'string') {\r\n        scrollMode = _ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"][scrollMode];\r\n    }\r\n    return scrollMode;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetScrollMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/GetScrollMode.js?")},"./lib/rexui/templates/ui/utils/GetSizerConfig.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetSizerConfig = function (gameObject) {\r\n    if (!gameObject.hasOwnProperty('rexSizer')) {\r\n        gameObject.rexSizer = {};\r\n    }\r\n    return gameObject.rexSizer;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetSizerConfig);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/GetSizerConfig.js?")},"./lib/rexui/templates/ui/utils/Hide.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Show", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Hide", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IsShown", function() { return IsShown; });\n/* harmony import */ var _GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetSizerConfig.js */ "./lib/rexui/templates/ui/utils/GetSizerConfig.js");\n\r\n\r\nvar Show = function (gameObject) {\r\n    _hide(gameObject, false);\r\n};\r\n\r\nvar Hide = function (gameObject) {\r\n    _hide(gameObject, true);\r\n};\r\n\r\nvar IsShown = function(gameObject) {\r\n    if (!gameObject) {\r\n        return false;\r\n    }\r\n    var config = Object(_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject);\r\n    return !config.hidden;\r\n}\r\n\r\nvar _hide = function (gameObject, hidden) {\r\n    if (!gameObject) {\r\n        return;\r\n    }\r\n    var config = Object(_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject);\r\n    config.hidden = hidden;\r\n    gameObject.setVisible(!hidden);\r\n};\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/Hide.js?')},"./lib/rexui/templates/ui/utils/OrientationConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    x: 0,\r\n    h: 0,\r\n    horizontal: 0,\r\n    'left-to-right': 0,\r\n    y: 1,\r\n    v: 1,\r\n    vertical: 1,\r\n    'top-to-bottom': 1\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/OrientationConst.js?")},"./lib/rexui/templates/ui/utils/ScrollModeConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    v: 0,\r\n    vertical: 0,\r\n    h: 1,\r\n    horizontal: 1\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/ScrollModeConst.js?')},"./lib/rexui/templates/ui/utils/Space.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Space = function (scene, width, height) {\r\n    if (width === undefined) {\r\n        width = 0;\r\n    }\r\n    if (height === undefined) {\r\n        height = 0;\r\n    }\r\n    return scene.add.zone(0, 0, width, height);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Space);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/Space.js?')},"./lib/rexui/templates/ui/utils/scrollable/CreateScrollableSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GetScrollMode.js */ \"./lib/rexui/templates/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _slider_Slider_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../slider/Slider.js */ \"./lib/rexui/templates/ui/slider/Slider.js\");\n/* harmony import */ var _plugins_scroller_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../plugins/scroller.js */ \"./lib/rexui/plugins/scroller.js\");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar CreateScrollableSizer = function (config) {\r\n    var scene = this.scene;\r\n    var scrollMode = Object(_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config);\r\n    var scrollableSizer = new _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](scene, { orientation: scrollMode });\r\n\r\n    var child = GetValue(config, 'child.gameObject', undefined);\r\n    var sliderConfig = GetValue(config, 'slider', undefined), slider;\r\n    var scrollerConfig = GetValue(config, 'scroller', true), scroller;\r\n\r\n    // Child, slider, scroller\r\n    if (child) {\r\n        var childSpace = GetValue(config, 'space.child', 0);\r\n        this.childPadding = {};\r\n        if (typeof (childSpace) !== 'number') {\r\n            var childPadding = childSpace;\r\n            if (scrollMode === 0) {\r\n                childSpace = GetValue(childPadding, 'right', 0);\r\n                this.childPadding.top = GetValue(childPadding, 'top', 0);\r\n                this.childPadding.bottom = GetValue(childPadding, 'bottom', 0);\r\n            } else {\r\n                childSpace = GetValue(childPadding, 'bottom', 0);\r\n                this.childPadding.top = GetValue(childPadding, 'left', 0);\r\n                this.childPadding.bottom = GetValue(childPadding, 'right', 0);\r\n            }\r\n        } else {\r\n            this.childPadding.top = 0;\r\n            this.childPadding.bottom = 0;\r\n        }\r\n\r\n        var proportion = GetValue(config, 'child.proportion', 1);\r\n        var expand = GetValue(config, 'child.expand', true);\r\n        var padding;\r\n        if (scrollMode === 0) {\r\n            padding = {\r\n                right: (sliderConfig) ? childSpace : 0,\r\n            };\r\n        } else {\r\n            padding = {\r\n                bottom: (sliderConfig) ? childSpace : 0\r\n            };\r\n        }\r\n        scrollableSizer.add(child, proportion, 'center', padding, expand);\r\n\r\n        if (sliderConfig) {\r\n            if (sliderConfig === true) {\r\n                sliderConfig = {};\r\n            }\r\n            sliderConfig.orientation = scrollableSizer.orientation;\r\n            slider = new _slider_Slider_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](scene, sliderConfig);\r\n            scrollableSizer.add(slider, 0, 'center', 0, true);\r\n        }\r\n\r\n\r\n        if (scrollerConfig) {\r\n            if (scrollerConfig === true) {\r\n                scrollerConfig = {};\r\n            }\r\n            scrollerConfig.orientation = scrollMode;\r\n            scroller = new _plugins_scroller_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](child, scrollerConfig);\r\n        }\r\n    }\r\n\r\n    // Control\r\n    if (slider) {\r\n        slider.on('valuechange', function (newValue) {\r\n            this.t = newValue;\r\n        }, this);\r\n    }\r\n    if (scroller) {\r\n        scroller.on('valuechange', function (newValue) {\r\n            this.childOY = newValue;\r\n        }, this);\r\n    }\r\n\r\n    this.addChildrenMap('child', child);\r\n    this.addChildrenMap('slider', slider);\r\n    this.addChildrenMap('scroller', scroller);\r\n\r\n    return scrollableSizer;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CreateScrollableSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/scrollable/CreateScrollableSizer.js?")},"./lib/rexui/templates/ui/utils/scrollable/Scrollable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sizer/Sizer.js */ \"./lib/rexui/templates/ui/sizer/Sizer.js\");\n/* harmony import */ var _GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GetScrollMode.js */ \"./lib/rexui/templates/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _CreateScrollableSizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CreateScrollableSizer.js */ \"./lib/rexui/templates/ui/utils/scrollable/CreateScrollableSizer.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Scrollable extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        var scrollMode = Object(_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config); // Left-to-right, or top-to-bottom\r\n        // Create sizer\r\n        config.orientation = (scrollMode === 0) ? 1 : 0;\r\n        super(scene, config);\r\n        this.type = GetValue(config, 'type', 'rexScrollable');\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var scrollableSizer = _CreateScrollableSizer_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].call(this, config);\r\n        var header = GetValue(config, 'header', undefined);\r\n        var footer = GetValue(config, 'footer', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n\r\n        // Background\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (header) {\r\n            var align = GetValue(config, 'align.header', 'center');\r\n            var headerSpace = GetValue(config, 'space.header', 0);\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: headerSpace,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: headerSpace,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            var expand = GetValue(config, 'expand.header', true);\r\n            this.add(header, 0, align, padding, expand);\r\n        }\r\n\r\n        if (scrollableSizer) {\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (header) ? 0 : paddingTop,\r\n                    bottom: (footer) ? 0 : paddingBottom,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: (header) ? 0 : paddingLeft,\r\n                    right: (footer) ? 0 : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            this.add(scrollableSizer, 1, 'center', padding, true);\r\n        }\r\n\r\n        if (footer) {\r\n            var align = GetValue(config, 'align.footer', 'center');\r\n            var footerSpace = GetValue(config, 'space.footer', 0);\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: footerSpace,\r\n                    bottom: paddingBottom,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: footerSpace,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            var expand = GetValue(config, 'expand.footer', true);\r\n            this.add(footer, 0, align, padding, expand);\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('header', header);\r\n        this.addChildrenMap('footer', footer);\r\n\r\n        // Necessary properties of child object\r\n        // child.t (RW), child.childOY (RW), child.topChildOY (R), child.bottomChildOY (R)\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        this.resizeController();\r\n        return this;\r\n    }\r\n\r\n    resizeController() {\r\n        var topChildOY = this.topChildOY;\r\n        var bottomChildOY = this.bottomChildOY;\r\n        var scroller = this.childrenMap.scroller;\r\n        var slider = this.childrenMap.slider;\r\n        if (scroller) {\r\n            scroller.setBounds(bottomChildOY, topChildOY);\r\n        }\r\n        if (slider) {\r\n            slider.setEnable(bottomChildOY !== topChildOY);\r\n        }\r\n        this.updateController();\r\n        return this;\r\n    }\r\n\r\n    updateController() {\r\n        var scroller = this.childrenMap.scroller;\r\n        var slider = this.childrenMap.slider;\r\n        if (scroller) {\r\n            scroller.setValue(this.childOY);\r\n        }\r\n        if (slider) {\r\n            slider.setValue(this.t);\r\n        }\r\n    }\r\n\r\n    set t(t) {\r\n        // Get inner childT\r\n        var childPadding = this.childPadding;\r\n        if ((childPadding.top !== 0) || (childPadding.bottom !== 0)) {\r\n            var child = this.childrenMap.child\r\n            var innerHeight = (child.topChildOY - child.bottomChildOY);\r\n            var outterHeight = innerHeight + childPadding.top + childPadding.bottom;\r\n            var innerChildOY = (outterHeight * t) - childPadding.top;\r\n            t = innerChildOY / innerHeight;\r\n        }\r\n\r\n        this.childrenMap.child.t = t;\r\n        this.updateController();\r\n    }\r\n\r\n    get t() {\r\n        var t = this.childrenMap.child.t;\r\n\r\n        // Get outter childT\r\n        var childPadding = this.childPadding;\r\n        if ((childPadding.top !== 0) || (childPadding.bottom !== 0)) {\r\n            var child = this.childrenMap.child\r\n            var innerHeight = (child.topChildOY - child.bottomChildOY);\r\n            var outterHeight = innerHeight + childPadding.top + childPadding.bottom;\r\n            var outterChildOY = (innerHeight * t) + childPadding.top;\r\n            t = outterChildOY / outterHeight;\r\n        }\r\n        return t;\r\n    }\r\n\r\n    set childOY(value) {\r\n        this.childrenMap.child.childOY = value;\r\n        this.updateController();\r\n    }\r\n\r\n    get childOY() {\r\n        return this.childrenMap.child.childOY;\r\n    }\r\n\r\n    get topChildOY() {\r\n        return this.childrenMap.child.topChildOY + this.childPadding.top;\r\n    }\r\n\r\n    get bottomChildOY() {\r\n        return this.childrenMap.child.bottomChildOY - this.childPadding.bottom;\r\n    }\r\n\r\n    setChildOY(value) {\r\n        this.childOY = value;\r\n        return this;\r\n    }\r\n\r\n    setT(value) {\r\n        this.t = value;\r\n        return this;\r\n    }\r\n\r\n    scrollToTop() {\r\n        this.t = 0;\r\n        return this;\r\n    }\r\n\r\n    scrollToBottom() {\r\n        this.t = 1;\r\n        return this;\r\n    }\r\n\r\n    get sliderEnable() {\r\n        var slider = this.childrenMap.slider;\r\n        if (!slider) {\r\n            return undefined;\r\n        }\r\n\r\n        return slider.enable;\r\n    }\r\n\r\n    set sliderEnable(value) {\r\n        var slider = this.childrenMap.slider;\r\n        if (!slider) {\r\n            return;\r\n        }\r\n        slider.setEnable(value);\r\n    }\r\n\r\n    setSliderEnable(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.sliderEnable = enabled;\r\n        return this;\r\n    }\r\n\r\n    get scrollerEnable() {\r\n        var scroller = this.childrenMap.scroller;\r\n        if (!scroller) {\r\n            return undefined;\r\n        }\r\n\r\n        return scroller.enable;\r\n    }\r\n\r\n    set scrollerEnable(value) {\r\n        var scroller = this.childrenMap.scroller;\r\n        if (!scroller) {\r\n            return;\r\n        }\r\n        scroller.setEnable(value);\r\n    }\r\n\r\n    setScrollerEnable(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.scrollerEnable = enabled;\r\n        return this;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scrollable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/utils/scrollable/Scrollable.js?")},"./lib/rexui/templates/ui/video/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Video_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Video.js */ "./lib/rexui/templates/ui/video/Video.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'video\', function (x, y, width, height, config) {\r\n    var gameObject = new _Video_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Video\', _Video_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Video_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/video/Factory.js?')},"./lib/rexui/templates/ui/video/Video.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_video_videodom_VideoDOM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/video/videodom/VideoDOM.js */ "./lib/rexui/plugins/gameobjects/video/videodom/VideoDOM.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_video_videodom_VideoDOM_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/video/Video.js?')},"./lib/rexui/templates/ui/youtubeplayer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./YoutubePlayer.js */ "./lib/rexui/templates/ui/youtubeplayer/YoutubePlayer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/templates/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugins/utils/object/SetValue.js */ "./lib/rexui/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'youtubePlayer\', function (x, y, width, height, config) {\r\n    var gameObject = new _YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.YoutubePlayer\', _YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/youtubeplayer/Factory.js?')},"./lib/rexui/templates/ui/youtubeplayer/YoutubePlayer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_youtubeplayer_YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/gameobjects/youtubeplayer/YoutubePlayer.js */ "./lib/rexui/plugins/gameobjects/youtubeplayer/YoutubePlayer.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_youtubeplayer_YoutubePlayer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/templates/ui/youtubeplayer/YoutubePlayer.js?')},"./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/heartbeatworker.ts":function(module,exports,__webpack_require__){eval('module.exports = function() {\n  return new Worker(__webpack_require__.p + "js/586f6a45204c9b6e4aad.heartbeatworker.js");\n};\n\n//# sourceURL=webpack://TooqingCore/./src/net/heartbeatworker.ts?./node_modules/worker-loader/dist/cjs.js?name=js/0aa3.%5Bname%5D.js')},"./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/networker.ts":function(module,exports,__webpack_require__){eval('module.exports = function() {\n  return new Worker(__webpack_require__.p + "js/df879395c2cc560fabc1.networker.js");\n};\n\n//# sourceURL=webpack://TooqingCore/./src/net/networker.ts?./node_modules/worker-loader/dist/cjs.js?name=js/bba7.%5Bname%5D.js')},"./src/const/MessageType.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageType", function() { return MessageType; });\n/**\r\n * 系统消息定义\r\n * author aaron\r\n */\r\nvar MessageType = /** @class */ (function () {\r\n    function MessageType() {\r\n    }\r\n    MessageType.CREATE_ROLE = "create_role";\r\n    MessageType.APP_START = "app_start";\r\n    MessageType.EDITOR_CHANGE_MODE = "editor_change_mode";\r\n    MessageType.CLIENT_RESIZE = "app_client_resize";\r\n    MessageType.SCENE_INITIALIZED = "SCENE_INITIALIZED";\r\n    MessageType.SCENE_CLEARED = "SCENE_CLEARED";\r\n    MessageType.SCENE_CHANGE_TO = "SCENE_CHANGE_TO";\r\n    MessageType.SCENE_MOVE_TO = "scene_move_to";\r\n    MessageType.SCENE_MOVE_STOP = "scene_move_stop";\r\n    MessageType.CHANGE_ELEMENT_ANIMATION = "change_element_animation";\r\n    MessageType.CHANGE_CHARACTER_ANIMATION = "change_character_animation";\r\n    MessageType.CHAT_TO = "chat_to";\r\n    MessageType.SHOW_CHAT_BUBBLE = "show_chat_bubble";\r\n    MessageType.REMOVE_CHAT_BUBBLE = "remove_chat_bubble";\r\n    MessageType.PROMPT_ALERT = "prompt_alert";\r\n    MessageType.CHARACTER_TALING = "characterTaling";\r\n    MessageType.CHARACTER_SHUT_UP = "characterShutUp";\r\n    /// never start\r\n    MessageType.QCLOUD_AUTH = "qcloud_auth";\r\n    MessageType.ENTER_SCENE = "enter_scene";\r\n    /// never end\r\n    MessageType.SCENE_ADD_PLAYER = "scene_add_player";\r\n    MessageType.SCENE_REMOVE_PLAYER = "scene_remove_player";\r\n    MessageType.SCENE_UPDATE_PLAYER = "scene_update_player";\r\n    MessageType.SCENE_ADD_ELEMENT = "scene_add_element";\r\n    MessageType.SCENE_ADD_TERRAIN = "scene_add_terrain";\r\n    MessageType.SCENE_ADD_TERRAIN_END = "scene_add_terrain_end";\r\n    MessageType.SCENE_ADD_ALL_TERRAIN = "scene_add_all_terrain";\r\n    MessageType.SCENE_REMOVE_ELEMENT = "scene_remove_element";\r\n    MessageType.SCENE_REMOVE_TERRAIN = "scene_remove_terrain";\r\n    MessageType.SCENE_REMOVE_ALL_TERRAIN = "scene_remove_all_terrain";\r\n    MessageType.SCENE_MOUSE_FOLLOW = "scene_mouse_follow";\r\n    MessageType.SCENE_SELECT_ELEMENT = "scene_select_element";\r\n    MessageType.SCENE_FIXED_TO_ELEMENT = "scene_fixed_to_element";\r\n    MessageType.SCENE_UPDATE_ELEMENT = "sceneUpdateElement";\r\n    MessageType.SCENE_SYNCHRO_PACKAGE = "sceneSynchroPackage";\r\n    MessageType.SCENE_VISIBLE_GRID = "sceneVisibleGrid";\r\n    MessageType.PLAYER_SELECT_CHARACTER = "player_select_character";\r\n    MessageType.PLAYER_DATA_INITIALIZE = "player_data_initialize";\r\n    MessageType.SCENE_DATA_INITIALIZE = "scene_data_initialize";\r\n    MessageType.PACKAGE_ITEM_ADD = "package_item_add";\r\n    MessageType.PACKAGE_ITEM_REMOVE = "package_item_remove";\r\n    MessageType.PACKAGE_EXCHANGE_ITEM_POS = "package_exchange_item_pos";\r\n    MessageType.SCENE_BACKGROUND_CLICK = "SCENE_BACKGROUND_CLICK";\r\n    MessageType.CHANGE_SELF_AVATAR = "CHANGE_SELF_AVATAR";\r\n    MessageType.DRAG_TO_DROP = "DRAG_TO_DROP";\r\n    MessageType.DRAG_OVER_DROP = "DRAG_OVER_DROP";\r\n    MessageType.QUERY_PACKAGE = "query_package";\r\n    MessageType.SYNC_USER_BALANCE = "syncUserBalance";\r\n    MessageType.UPDATED_CHARACTER_PACKAGE = "updatedCharacterPackage";\r\n    MessageType.SHOW_EFFECT = "showEffect";\r\n    MessageType.EDIT_MODE_QUERY_PACKAGE = "editModeQueryPackage";\r\n    MessageType.PRESS_ELEMENT = "PRESS_ELEMENT";\r\n    // 旋转物件\r\n    MessageType.TURN_ELEMENT = "turnElement";\r\n    // 回收\r\n    MessageType.RECYCLE_ELEMENT = "recycleElement";\r\n    // 放置\r\n    MessageType.PUT_ELEMENT = "putElement";\r\n    // 展开物件容器\r\n    MessageType.EDIT_PACKAGE_EXPANED = "editPackageExpaned";\r\n    // 收起物件容器\r\n    MessageType.EDIT_PACKAGE_COLLAPSE = "editPackageCollapse";\r\n    MessageType.ADD_ICON_TO_TOP = "addIconToTop";\r\n    MessageType.REMOVE_ICON_FROM_TOP = "removeIconFromTop";\r\n    return MessageType;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/MessageType.ts?')},"./src/const/brush.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BrushEnum", function() { return BrushEnum; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Brush", function() { return Brush; });\nvar BrushEnum;\r\n(function (BrushEnum) {\r\n    BrushEnum["MOVE"] = "move";\r\n    BrushEnum["BRUSH"] = "brush";\r\n    BrushEnum["SELECT"] = "select";\r\n    BrushEnum["ERASER"] = "eraser";\r\n    BrushEnum["FILL"] = "FILL";\r\n})(BrushEnum || (BrushEnum = {}));\r\nvar Brush = /** @class */ (function () {\r\n    function Brush(mEditorRoom) {\r\n        this.mEditorRoom = mEditorRoom;\r\n        this.mMode = BrushEnum.SELECT;\r\n    }\r\n    Object.defineProperty(Brush.prototype, "mode", {\r\n        get: function () {\r\n            return this.mMode;\r\n        },\r\n        set: function (mode) {\r\n            this.mMode = mode;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Brush;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/brush.ts?')},"./src/const/constants.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PI_EXTENSION_REGEX", function() { return PI_EXTENSION_REGEX; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTP_REGEX", function() { return HTTP_REGEX; });\nvar PI_EXTENSION_REGEX = /\\.pi$/i;\r\nvar HTTP_REGEX = /^(http|https):/i;\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/constants.ts?')},"./src/const/res.const.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UI", function() { return UI; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n\r\nvar UI;\r\n(function (UI) {\r\n    var TuDing18 = /** @class */ (function () {\r\n        function TuDing18() {\r\n        }\r\n        TuDing18.getName = function () {\r\n            return "ui_moneyIcon_tuding_18_png";\r\n        };\r\n        TuDing18.getPNG = function () {\r\n            return _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("ui/moneyIcon/tuding_18.png");\r\n        };\r\n        return TuDing18;\r\n    }());\r\n    UI.TuDing18 = TuDing18;\r\n})(UI || (UI = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/res.const.ts?')},"./src/game/account.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });\nvar Account = /** @class */ (function () {\r\n    function Account() {\r\n        // TODO\r\n        // 1. 登陆注册的逻辑在这里做\r\n        // 2. 缓存用户登陆后的帐号咨讯\r\n    }\r\n    Account.prototype.setAccount = function (val) {\r\n        this.mCurAccountData = {\r\n            token: "",\r\n            expire: 0,\r\n            fingerprint: "",\r\n        };\r\n        Object.assign(this.mCurAccountData, val);\r\n    };\r\n    Object.defineProperty(Account.prototype, "accountData", {\r\n        get: function () {\r\n            return this.mCurAccountData;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Account;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/account.ts?')},"./src/game/element.storage.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorage", function() { return ElementStorage; });\n/* harmony import */ var _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../rooms/display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _rooms_display_animation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../rooms/display/animation */ "./src/rooms/display/animation.ts");\n\r\n\r\n\r\nvar ElementStorage = /** @class */ (function () {\r\n    function ElementStorage() {\r\n        this.mModels = new Map();\r\n        this.mElementRef = new Map();\r\n        this.mPaletteModels = new Map();\r\n        this._terrainCollection = new Map();\r\n        // public loadGameConfig(paths: string[]): Promise<Lite> {\r\n        //     const promises = [];\r\n        //     for (const path of paths) {\r\n        //         promises.push(load(ResUtils.getGameConfig(path), "arraybuffer"));\r\n        //     }\r\n        //     // TODO Promise.all如果其中有一个下载失败，会返回error\r\n        //     return Promise.all(promises)\r\n        //         .then((reqs: any[]) => {\r\n        //             return this.decodeConfigs(reqs);\r\n        //         });\r\n        // }\r\n        // private decodeConfigs(reqs: any[]): Promise<Lite> {\r\n        //     return new Promise((resolve, reject) => {\r\n        //         for (const req of reqs) {\r\n        //             const arraybuffer = req.response;\r\n        //             if (arraybuffer) {\r\n        //                 try {\r\n        //                     const gameConfig = new Lite();\r\n        //                     gameConfig.deserialize(new Uint8Array(arraybuffer));\r\n        //                     resolve(gameConfig);\r\n        //                 } catch (error) {\r\n        //                     reject(error);\r\n        //                 }\r\n        //             } else {\r\n        //                 reject("error");\r\n        //             }\r\n        //         }\r\n        //     });\r\n        // }\r\n    }\r\n    ElementStorage.prototype.setGameConfig = function (config) {\r\n        console.log("TCL: ElementStorage -> config", config);\r\n        if (!config) {\r\n            return;\r\n        }\r\n        var objs = config.objectsList;\r\n        var displayModel = null;\r\n        // TODO Lite deserialize可能会有个别Display link失败\r\n        for (var _i = 0, objs_1 = objs; _i < objs_1.length; _i++) {\r\n            var obj = objs_1[_i];\r\n            if (obj.type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.ElementNodeType) {\r\n                displayModel = this.mModels.get(obj.id);\r\n                if (!displayModel) {\r\n                    var anis = [];\r\n                    var eleAnis = obj.animations;\r\n                    var objAnis = eleAnis.animationData;\r\n                    for (var _a = 0, objAnis_1 = objAnis; _a < objAnis_1.length; _a++) {\r\n                        var ani = objAnis_1[_a];\r\n                        anis.push(new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_2__["Animation"](ani));\r\n                    }\r\n                    displayModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                        id: obj.id,\r\n                        sn: obj.sn,\r\n                        animations: {\r\n                            defaultAnimationName: eleAnis.defaultAnimationName,\r\n                            display: eleAnis.display,\r\n                            animationData: anis\r\n                        }\r\n                    });\r\n                    this.mModels.set(obj.id, displayModel);\r\n                }\r\n                var ele = {\r\n                    id: obj.id,\r\n                    displayModel: displayModel\r\n                };\r\n                this.mElementRef.set(obj.id, ele);\r\n            }\r\n        }\r\n        for (var _b = 0, _c = config.root.palette.peers; _b < _c.length; _b++) {\r\n            var peer = _c[_b];\r\n            var key = peer.key, entity = peer.entity;\r\n            var terrain = entity;\r\n            var terrainModel = this.mModels.get(entity.id);\r\n            if (!terrainModel) {\r\n                var frameModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                    id: entity.id,\r\n                    sn: entity.sn,\r\n                    animations: {\r\n                        defaultAnimationName: terrain.animations.defaultAnimationName,\r\n                        display: terrain.animations.display,\r\n                        animationData: terrain.animations.animationData.map(function (ani) { return new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_2__["Animation"](ani); })\r\n                    }\r\n                });\r\n                this.mPaletteModels.set(entity.id, frameModel);\r\n            }\r\n        }\r\n        for (var _d = 0, _e = config.root.children; _d < _e.length; _d++) {\r\n            var scene = _e[_d];\r\n            this._terrainCollection.set(scene.id, scene.terrainCollection);\r\n        }\r\n    };\r\n    ElementStorage.prototype.add = function (obj) {\r\n        this.mModels.set(obj.id, obj);\r\n    };\r\n    ElementStorage.prototype.getObject = function (id) {\r\n        var ele = this.mElementRef.get(id);\r\n        if (ele) {\r\n            return ele.displayModel;\r\n        }\r\n        // Logger.getInstance().error(`can\'t find element ${id}`);\r\n        return;\r\n    };\r\n    ElementStorage.prototype.getTerrainCollection = function () {\r\n        return this._terrainCollection;\r\n    };\r\n    ElementStorage.prototype.getPalette = function (id) {\r\n        return this.mPaletteModels.get(id);\r\n    };\r\n    return ElementStorage;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/element.storage.ts?')},"./src/game/joystick.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JoyStickManager", function() { return JoyStickManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JoyStick", function() { return JoyStick; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rooms/element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rooms/decorate.room */ "./src/rooms/decorate.room.ts");\n\r\n\r\n\r\n\r\nvar TEMP_CONST = {\r\n    MOUSE_DOWN: 0,\r\n    MOUSE_MOVE: 1,\r\n    MOUSE_UP: 2,\r\n    TOUCH_START: 3,\r\n    TOUCH_MOVE: 4,\r\n    TOUCH_END: 5,\r\n    POINTER_LOCK_CHANGE: 6,\r\n    TOUCH_CANCEL: 7,\r\n    MOUSE_WHEEL: 8\r\n};\r\nvar JoyStickManager = /** @class */ (function () {\r\n    function JoyStickManager(worldService, keyEvents) {\r\n        this.worldService = worldService;\r\n        this.mEnabled = false;\r\n        // 用于记录room类型，初始化完成后让joystick处理\r\n        this.mOnListener = false;\r\n        this.mJoyListeners = [];\r\n        this.mScale = worldService.uiScale;\r\n        this.mKeyEvents = keyEvents;\r\n        this.mKeyEventMap = new Map();\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().debug("JoyStickManager " + worldService.uiScale);\r\n    }\r\n    JoyStickManager.prototype.onRoomChanged = function (currentRoom, previousRoom) {\r\n        if (!this.mJoyStick) {\r\n            this.mOnListener = currentRoom instanceof _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__["DecorateRoom"] ? false : true;\r\n            return;\r\n        }\r\n        if (currentRoom instanceof _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__["DecorateRoom"]) {\r\n            this.mJoyStick.offListener();\r\n        }\r\n        else {\r\n            this.mJoyStick.onListener();\r\n        }\r\n    };\r\n    JoyStickManager.prototype.setScene = function (scene) {\r\n        this.mScene = scene;\r\n        if (!this.mScene || !this.mKeyEvents)\r\n            return;\r\n        var len = this.mKeyEvents.length;\r\n        var keyEvent;\r\n        var codes;\r\n        var eventName;\r\n        for (var i = 0; i < len; i++) {\r\n            keyEvent = this.mKeyEvents[i];\r\n            codes = keyEvent.keyCodes;\r\n            eventName = keyEvent.tqEvent;\r\n            if (!this.mKeyEventMap.get(eventName)) {\r\n                this.mKeyEventMap.set(eventName, keyEvent);\r\n            }\r\n        }\r\n        this.mKeyEvents.length = 0;\r\n        this.mKeyEvents = null;\r\n        this.mParentcon = this.mScene.add.container(0, 0); // (150, size.height - 150);\r\n        var scale = !this.mScale ? 1 : this.mScale;\r\n        this.mJoyStick = new JoyStick(this.mScene, this.worldService, this.mParentcon, this.mJoyListeners, scale);\r\n        if (this.mOnListener) {\r\n            this.mJoyStick.onListener();\r\n        }\r\n        else {\r\n            this.mJoyStick.offListener();\r\n        }\r\n    };\r\n    JoyStickManager.prototype.resize = function () {\r\n        if (!this.mParentcon)\r\n            return;\r\n        this.mParentcon.scaleX = this.mParentcon.scaleY = this.worldService.uiScale;\r\n        // const size: Size = this.worldService.getSize();\r\n        // const mainUIMed = this.worldService.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // const padHei: number = !mainUIMed ? this.mParentcon.height : (mainUIMed.getView() as MainUIMobile).getBottomView().height;\r\n        // if (this.mParentcon) {\r\n        //     if (this.worldService.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n        //         this.mParentcon.x = this.mParentcon.width * this.worldService.uiScale;\r\n        //         this.mParentcon.y = size.height - this.mParentcon.height * this.worldService.uiScale;\r\n        //     } else {\r\n        //         this.mParentcon.x = this.mParentcon.width * this.worldService.uiScale;\r\n        //         this.mParentcon.y = size.height - (padHei + this.mParentcon.height) * this.worldService.uiScale;\r\n        //     }\r\n        //     this.mParentcon.scaleX = this.mParentcon.scaleY = this.worldService.uiScale;\r\n        // }\r\n    };\r\n    JoyStickManager.prototype.tweenView = function (show) {\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mParentcon.visible = show;\r\n        // const size: Size = this.worldService.getSize();\r\n        // let baseX: number;\r\n        // let baseY: number;\r\n        // const mainUIMed = this.worldService.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // const padHei: number = !mainUIMed ? this.mParentcon.height : (mainUIMed.getView() as MainUIMobile).getBottomView().height;\r\n        // if (this.worldService.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n        //     baseX = this.mParentcon.width * this.worldService.uiScale;\r\n        //     baseY = size.height - this.mParentcon.height * this.worldService.uiScale;\r\n        // } else {\r\n        //     baseX = this.mParentcon.width * this.worldService.uiScale;\r\n        //     baseY = size.height - (padHei + this.mParentcon.height) * this.worldService.uiScale;\r\n        // }\r\n        // const toX: number = show === true ? baseX : baseX - this.mParentcon.width;\r\n        // const toY: number = baseY;\r\n        // this.mScene.tweens.add({\r\n        //     targets: this.mParentcon,\r\n        //     duration: 200,\r\n        //     ease: "Linear",\r\n        //     props: {\r\n        //         x: { value: toX },\r\n        //         y: { value: toY },\r\n        //         alpha: { value: toAlpha },\r\n        //     },\r\n        // });\r\n    };\r\n    JoyStickManager.prototype.addListener = function (l) {\r\n        this.mJoyListeners.push(l);\r\n        if (this.mJoyStick) {\r\n            this.mJoyStick.changeListeners(this.mJoyListeners);\r\n        }\r\n    };\r\n    JoyStickManager.prototype.getKeyCodes = function (eventName) {\r\n        if (!this.mKeyEventMap.has(eventName))\r\n            return undefined;\r\n        var len = this.mKeyEventMap.get(eventName).keyCodes.length;\r\n        var keyCodes = [];\r\n        for (var i = 0; i < len; i++) {\r\n            var keyCode = this.mKeyEventMap.get(eventName).keyCodes[i];\r\n            keyCodes.push(keyCode);\r\n        }\r\n        return keyCodes;\r\n    };\r\n    JoyStickManager.prototype.removeListener = function (l) {\r\n        // this.mJoyStick.removeListener(l);\r\n        var idx = this.mJoyListeners.indexOf(l);\r\n        if (idx >= 0) {\r\n            this.mJoyListeners.splice(idx, 1);\r\n        }\r\n        if (this.mJoyStick) {\r\n            this.mJoyStick.changeListeners(this.mJoyListeners);\r\n        }\r\n    };\r\n    JoyStickManager.prototype.getKeyDowns = function () {\r\n        return [];\r\n    };\r\n    JoyStickManager.prototype.getKeyUps = function () {\r\n        return [];\r\n    };\r\n    JoyStickManager.prototype.downHandler = function () {\r\n    };\r\n    JoyStickManager.prototype.upHandler = function () {\r\n    };\r\n    Object.defineProperty(JoyStickManager.prototype, "enable", {\r\n        get: function () {\r\n            return this.mEnabled;\r\n        },\r\n        set: function (val) {\r\n            this.mEnabled = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return JoyStickManager;\r\n}());\r\n\r\nvar JoyStick = /** @class */ (function () {\r\n    function JoyStick(scene, world, parentCon, joyListeners, scale) {\r\n        this.mDown = false;\r\n        this.mScene = scene;\r\n        this.mWorld = world;\r\n        this.parentCon = parentCon;\r\n        this.mJoyListeners = joyListeners;\r\n        this.mScale = scale;\r\n        this.mKeyCodes = [];\r\n        this.load();\r\n    }\r\n    JoyStick.prototype.load = function () {\r\n        this.mScene.load.atlas("joystick", "./resources/ui/joystick/joystick.png", "./resources/ui/joystick/joystick.json");\r\n        this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        this.mScene.load.start();\r\n    };\r\n    JoyStick.prototype.onListener = function () {\r\n        this.mScene.input.on("pointerdown", this.downHandler, this);\r\n        this.mScene.input.on("pointerup", this.upHandler, this);\r\n    };\r\n    JoyStick.prototype.offListener = function () {\r\n        this.parentCon.visible = false;\r\n        this.mScene.input.off("pointermove", this.pointerMove, this);\r\n        this.mScene.input.off("pointerdown", this.downHandler, this);\r\n        this.mScene.input.off("pointerup", this.upHandler, this);\r\n    };\r\n    JoyStick.prototype.changeListeners = function (list) {\r\n        this.mJoyListeners = list;\r\n    };\r\n    JoyStick.prototype.onLoadCompleteHandler = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.bg = this.mScene.make.sprite(undefined, false);\r\n        this.bg.setTexture("joystick", "joystick_bg.png");\r\n        this.bgRadius = this.bg.width + 100 >> 1;\r\n        this.btn = this.mScene.make.sprite(undefined, false);\r\n        this.btn.name = "joystick_btn";\r\n        this.btn.setTexture("joystick", "joystick_tab.png");\r\n        this.btn.x = this.bg.x;\r\n        this.btn.y = this.bg.y;\r\n        this.parentCon.alpha = .5;\r\n        this.parentCon.addAt(this.bg, 0);\r\n        this.parentCon.addAt(this.btn, 1);\r\n        this.btn.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.btn.width, this.btn.height), Phaser.Geom.Rectangle.Contains);\r\n        // this.mScene.input.setDraggable(this.btn);\r\n        // this.mScene.input.on("pointerdown", this.downHandler, this);\r\n        // this.mScene.input.on("pointerup", this.upHandler, this);\r\n        this.parentCon.setSize(this.bg.width, this.bg.height);\r\n        this.parentCon.visible = false;\r\n    };\r\n    // private dragStart(pointer) {\r\n    //     Logger.getInstance().log("dragstart");\r\n    //     this.btn.on("drag", this.dragUpdate, this);\r\n    //     this.btn.off("dragstart", this.dragStart, this);\r\n    //     this.btn.on("dragend", this.dragStop, this);\r\n    //     this.btn.on("dragcancel", this.dragStop, this);\r\n    // }\r\n    JoyStick.prototype.downHandler = function (pointer, gameojectList) {\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        if (this.mDown)\r\n            return;\r\n        if (gameojectList) {\r\n            if (gameojectList.length > 1) {\r\n                return;\r\n            }\r\n            else if (gameojectList.length === 1) {\r\n                if (gameojectList[0].name) {\r\n                    if (gameojectList[0].name !== "joystick_btn") {\r\n                        return;\r\n                    }\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this.mDown = true;\r\n        this.mScene.input.on("pointermove", this.pointerMove, this);\r\n        // 由于app环境下，游戏在浏览器中是全屏模式，所以需要在点击事件上除以当前UIscale调整位置\r\n        this.parentCon.x = pointer.worldX;\r\n        this.parentCon.y = pointer.worldY;\r\n        this.parentCon.visible = true;\r\n        // this.mScene.input.off("pointerdown", this.downHandler, this);\r\n        // this.mScene.input.manager.updateInputPlugins(TEMP_CONST.TOUCH_END, [pointer]);\r\n        // this.btn.on("dragstart", this.dragStart, this);\r\n        // this.mScene.input.manager.updateInputPlugins(TEMP_CONST.TOUCH_START, [pointer]);\r\n        // // phaser 的冒泡事件比较奇葩，没有停止冒泡的参数选项，只会把第一个有返回交互事件的scene返回过来，如果是多层scene，后续scene的交互就会return\r\n        // // 实际是为了防止多个事件派发，其实很蠢，应该给参数让用户自己选择是否派发\r\n        // const play: PlayScene = this.mWorld.game.scene.getScene(PlayScene.name) as PlayScene;\r\n        // if (play) (play.input as any).update(TEMP_CONST.MOUSE_DOWN, [pointer]);\r\n    };\r\n    JoyStick.prototype.pointerMove = function (pointer) {\r\n        var _this = this;\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        var dragX = pointer.worldX - this.parentCon.x;\r\n        var dragY = pointer.worldY - this.parentCon.y;\r\n        var d = Math.sqrt(dragX * dragX + dragY * dragY);\r\n        if (d > this.bgRadius) {\r\n            d = this.bgRadius;\r\n        }\r\n        var r = Math.atan2(dragY, dragX);\r\n        this.btn.x = Math.cos(r) * d;\r\n        this.btn.y = Math.sin(r) * d;\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        this.mJoyListeners.forEach(function (l) {\r\n            _this.checkdragDown(l, r);\r\n        });\r\n    };\r\n    // private dragUpdate(pointer, dragX, dragY) {\r\n    //     Logger.getInstance().log("draging");\r\n    //     let d = Math.sqrt(dragX * dragX + dragY * dragY);\r\n    //     if (d > this.bgRadius) {\r\n    //         d = this.bgRadius;\r\n    //     }\r\n    //     const r = Math.atan2(dragY, dragX);\r\n    //     this.btn.x = Math.cos(r) * d + this.bg.x;\r\n    //     this.btn.y = Math.sin(r) * d + this.bg.y;\r\n    //     if (!(this.mWorld.inputManager as JoyStickManager).enable) {\r\n    //         return;\r\n    //     }\r\n    //     this.mJoyListeners.forEach((l: InputListener) => {\r\n    //         this.checkdragDown(l, r);\r\n    //     });\r\n    // }\r\n    JoyStick.prototype.upHandler = function (pointer) {\r\n        var _this = this;\r\n        this.btn.x = this.bg.x;\r\n        this.btn.y = this.bg.y;\r\n        this.mDown = false;\r\n        this.parentCon.visible = false;\r\n        this.mScene.input.off("pointermove", this.pointerMove, this);\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        this.mJoyListeners.forEach(function (l) {\r\n            if (_this.checkdragUp()) {\r\n                l.upHandler();\r\n            }\r\n        });\r\n    };\r\n    JoyStick.prototype.checkdragDown = function (l, r) {\r\n        var dir;\r\n        var keyArr = [];\r\n        if (r <= 0 && r > (-Math.PI / 2)) {\r\n            dir = r !== 0 ? _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].right_up : _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].right;\r\n        }\r\n        else if (r <= (-Math.PI / 2) && r > (-Math.PI)) {\r\n            dir = r !== (-Math.PI / 2) ? _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].up_left : _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].up;\r\n        }\r\n        else if (r > (Math.PI / 2) && r <= Math.PI) {\r\n            dir = r !== Math.PI ? _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].left_down : _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].left;\r\n        }\r\n        else if (r > 0 && r <= (Math.PI / 2)) {\r\n            dir = r !== Math.PI / 2 ? _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].down_right : _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].down;\r\n        }\r\n        keyArr = this.getKeys(dir);\r\n        if (this.mdownStr === keyArr.toString())\r\n            return false;\r\n        this.mdownStr = keyArr.toString();\r\n        l.downHandler(dir, keyArr);\r\n        // if (!(this.mWorld.inputManager as JoyStickManager).enable) {\r\n        //     return false;\r\n        // }\r\n        this.mWorld.roomManager.currentRoom.playerManager.actor.setDirection(dir);\r\n        return true;\r\n    };\r\n    JoyStick.prototype.getKeys = function (dir) {\r\n        var keyArr = this.mKeyCodes[dir];\r\n        if (keyArr) {\r\n            return keyArr;\r\n        }\r\n        switch (dir) {\r\n            case 0:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP);\r\n                break;\r\n            case 1:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP).concat, this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT));\r\n                break;\r\n            case 2:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT);\r\n                break;\r\n            case 3:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT));\r\n                break;\r\n            case 4:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN);\r\n                break;\r\n            case 5:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT));\r\n                break;\r\n            case 6:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT);\r\n                break;\r\n            case 7:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT));\r\n                break;\r\n        }\r\n        this.mKeyCodes[dir] = keyArr;\r\n        return keyArr;\r\n    };\r\n    JoyStick.prototype.checkdragUp = function () {\r\n        this.mdownStr = "";\r\n        return true;\r\n    };\r\n    return JoyStick;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/joystick.manager.ts?')},"./src/game/keyboard.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KeyBoardManager", function() { return KeyBoardManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar KeyBoardManager = /** @class */ (function (_super) {\r\n    __extends(KeyBoardManager, _super);\r\n    function KeyBoardManager(worldService, keyEvents) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        // 是否初始化获取到了需要监听的key值列表\r\n        _this.mInitilized = true;\r\n        // 所有需要监听key的监听事件\r\n        _this.mKeyboardListeners = [];\r\n        // this.mCodeList = [37, 38, 39, 40, 65, 87, 68, 83];\r\n        _this.mKeyList = [];\r\n        _this.mKeyDownList = [];\r\n        _this.mKeyEvents = keyEvents;\r\n        _this.mTmpUpKeysStr = "";\r\n        _this.mTmpDownKeyStr = "";\r\n        _this.mKeyEventMap = new Map();\r\n        _this.mConnect = _this.worldService.connection;\r\n        return _this;\r\n    }\r\n    /**\r\n     * world中当scene发生变化时，传入当前激活的scene\r\n     * room由world去休眠/激活\r\n     */\r\n    KeyBoardManager.prototype.onRoomChanged = function (currentRoom, previousRoom) {\r\n        var _this = this;\r\n        this.mRoom = currentRoom;\r\n        this.mScene = currentRoom.scene;\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mKeyEvents) {\r\n            var len = this.mKeyEvents.length;\r\n            var keyEvent = void 0;\r\n            var codes = void 0;\r\n            var eventName = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                keyEvent = this.mKeyEvents[i];\r\n                codes = keyEvent.keyCodes;\r\n                eventName = keyEvent.tqEvent;\r\n                if (!this.mKeyEventMap.get(eventName)) {\r\n                    this.mKeyEventMap.set(eventName, keyEvent);\r\n                }\r\n            }\r\n            this.mKeyEvents.length = 0;\r\n            this.mKeyEvents = null;\r\n        }\r\n        // 暂时屏蔽\r\n        // this.removeKeyEvents();\r\n        this.mKeyEventMap.forEach(function (keyCodeEvent) {\r\n            if (keyCodeEvent) {\r\n                var keyCodes = keyCodeEvent.keyCodes;\r\n                var codesLen = keyCodes.length;\r\n                var keyCode = void 0;\r\n                for (var i = 0; i < codesLen; i++) {\r\n                    keyCode = keyCodes[i];\r\n                    var key = _this.mScene.input.keyboard.addKey(keyCode, false);\r\n                    _this.addKeyEvent(key, keyCodeEvent.tqEvent);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.getKeyCodes = function (eventName) {\r\n        if (!this.mKeyEventMap.has(eventName))\r\n            return undefined;\r\n        return this.mKeyEventMap.get(eventName).keyCodes;\r\n    };\r\n    KeyBoardManager.prototype.resize = function (width, height) {\r\n    };\r\n    KeyBoardManager.prototype.addListener = function (l) {\r\n        this.mKeyboardListeners.push(l);\r\n    };\r\n    KeyBoardManager.prototype.removeListener = function (l) {\r\n        var idx = this.mKeyboardListeners.indexOf(l);\r\n        if (idx >= 0) {\r\n            this.mKeyboardListeners.splice(idx, 1);\r\n        }\r\n    };\r\n    Object.defineProperty(KeyBoardManager.prototype, "enable", {\r\n        get: function () {\r\n            return this.mScene !== undefined ? this.mScene.input.keyboard.enabled : false;\r\n        },\r\n        /**\r\n         * 设置键盘开关\r\n         */\r\n        set: function (value) {\r\n            if (!this.mScene)\r\n                return;\r\n            this.mScene.input.keyboard.enabled = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(KeyBoardManager.prototype, "keyList", {\r\n        get: function () {\r\n            return this.mKeyList;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    KeyBoardManager.prototype.getKeyDowns = function () {\r\n        // let keyCodes: number[] = [];\r\n        if (!this.mInitilized) {\r\n            return [];\r\n        }\r\n        if (!this.mKeyList) {\r\n            return [];\r\n        }\r\n        this.mKeyDownList = this.mKeyList.filter(function (keyDown) { return keyDown.isDown; });\r\n        return this.mKeyDownList.map(function (key) { return key.keyCode; });\r\n    };\r\n    KeyBoardManager.prototype.getKeyUps = function () {\r\n        // 在keyDown列表里面查找是否有键抬起，其余没按的键不必监听\r\n        var keyCodes = [];\r\n        if (!this.mInitilized) {\r\n            return keyCodes;\r\n        }\r\n        if (!this.mKeyDownList) {\r\n            return [];\r\n        }\r\n        var key;\r\n        for (var i = 0; i < this.mKeyDownList.length; i++) {\r\n            key = this.mKeyDownList[i];\r\n            if (key && key.isUp) {\r\n                this.mKeyDownList.splice(i, 1);\r\n                keyCodes.push(key.keyCode);\r\n                i--;\r\n            }\r\n        }\r\n        // this.mKeyDownList = this.mKeyDownList.filter((keyDown) => keyDown.isDown);\r\n        return keyCodes;\r\n    };\r\n    KeyBoardManager.prototype.destroy = function () {\r\n        this.removeKeyEvents();\r\n        if (this.mKeyDownList) {\r\n            this.mKeyDownList.length = 0;\r\n            this.mKeyDownList = null;\r\n        }\r\n        // if (this.mCodeList) {\r\n        //     this.mCodeList.length = 0;\r\n        //     this.mCodeList = null;\r\n        // }\r\n        this.mTmpDownKeyStr = null;\r\n        this.mTmpUpKeysStr = null;\r\n        this.mScene = null;\r\n        this.mConnect = null;\r\n        this.mInitilized = false;\r\n    };\r\n    KeyBoardManager.prototype.concatArr = function (arr1, arr2) {\r\n        var i;\r\n        var len = arr1.length > arr2.length ? arr2.length : arr1.length;\r\n        var parentList = arr1.length > arr2.length ? arr1 : arr2;\r\n        var sonList = arr1.length > arr2.length ? arr2 : arr1;\r\n        for (i = 0; i < len; i++) {\r\n            parentList.push(sonList[i]);\r\n        }\r\n        return parentList;\r\n    };\r\n    KeyBoardManager.prototype.checkMoveKeyDown = function (l) {\r\n        var key;\r\n        var keyList = this.mKeyList;\r\n        var len = keyList.length;\r\n        var keyCodeList = [];\r\n        var keyCode;\r\n        var outPut = 0;\r\n        var keyLeftArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_LEFT);\r\n        var keyDownArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_DOWN);\r\n        var keyRightArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT);\r\n        var keyUpArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_UP);\r\n        for (var i = 0; i < len; i++) {\r\n            key = keyList[i];\r\n            keyCode = key.keyCode;\r\n            if (key && key.isDown) {\r\n                keyCodeList.push(key.keyCode);\r\n                var left = keyLeftArr.indexOf(keyCode);\r\n                if (left > -1) {\r\n                    outPut += -1;\r\n                    continue;\r\n                }\r\n                var right = keyRightArr.indexOf(keyCode);\r\n                if (right > -1) {\r\n                    outPut += 1;\r\n                    continue;\r\n                }\r\n                var down = keyDownArr.indexOf(keyCode);\r\n                if (down > -1) {\r\n                    outPut += 3;\r\n                    continue;\r\n                }\r\n                var up = keyUpArr.indexOf(keyCode);\r\n                if (up > -1) {\r\n                    outPut += -3;\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        if (outPut === 0) {\r\n            return false;\r\n        }\r\n        var curDir = l.getDirection();\r\n        var newDir;\r\n        switch (outPut) {\r\n            case -1:\r\n                newDir = curDir <= 1 ? 1 : 3;\r\n                break;\r\n            case -2:\r\n                newDir = 7;\r\n                break;\r\n            case -3:\r\n                newDir = curDir <= 3 ? 1 : 7;\r\n                break;\r\n            case -4:\r\n                newDir = 1;\r\n                break;\r\n            case 1:\r\n                newDir = curDir <= 5 ? 5 : 7;\r\n                break;\r\n            case 2:\r\n                newDir = 3;\r\n                break;\r\n            case 3:\r\n                newDir = curDir <= 3 ? 3 : 5;\r\n                break;\r\n            case 4:\r\n                newDir = 5;\r\n                break;\r\n        }\r\n        if (this.enable) {\r\n            l.setDirection(newDir);\r\n            l.downHandler(newDir, keyCodeList);\r\n            if (this.mRoom && this.mRoom.playerManager.actor)\r\n                this.mRoom.playerManager.actor.setDirection(newDir);\r\n        }\r\n        return true;\r\n    };\r\n    KeyBoardManager.prototype.checkMoveKeyAllUp = function () {\r\n        var key;\r\n        var keyList = this.mKeyList;\r\n        var len = keyList.length;\r\n        for (var i = 0; i < len; i++) {\r\n            key = keyList[i];\r\n            if (key && key.isDown) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    KeyBoardManager.prototype.addKeyEvent = function (key, eventName) {\r\n        key.on("down", this.keyDownHandle, this);\r\n        key.on("up", this.keyUpHandle, this);\r\n        this.mKeyList.push(key);\r\n    };\r\n    KeyBoardManager.prototype.keyDownHandle = function (e) {\r\n        var _this = this;\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n        var content = pkt.content;\r\n        var keyArr = this.getKeyDowns();\r\n        if (this.mTmpDownKeyStr === keyArr.toString())\r\n            return;\r\n        this.mTmpUpKeysStr = "";\r\n        this.mTmpDownKeyStr = keyArr.toString();\r\n        content.keyCodes = keyArr;\r\n        this.mConnect.send(pkt);\r\n        // then trigger listener\r\n        this.mKeyboardListeners.forEach(function (l) {\r\n            _this.checkMoveKeyDown(l);\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.keyUpHandle = function (e) {\r\n        var _this = this;\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_UP);\r\n        var content = pkt.content;\r\n        var keyArr = this.getKeyUps();\r\n        if (this.mTmpUpKeysStr === keyArr.toString() || keyArr.length < 1)\r\n            return;\r\n        this.mTmpDownKeyStr = "";\r\n        this.mTmpUpKeysStr = keyArr.toString();\r\n        content.keyCodes = keyArr;\r\n        this.mConnect.send(pkt);\r\n        // then trigger listener\r\n        this.mKeyboardListeners.forEach(function (l) {\r\n            if (_this.checkMoveKeyAllUp()) {\r\n                l.upHandler();\r\n                return;\r\n            }\r\n            _this.checkMoveKeyDown(l);\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.removeKeyEvents = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        var key;\r\n        var len = this.mKeyList.length;\r\n        for (var i = 0; i < len; i++) {\r\n            key = this.mKeyList[i];\r\n            if (!key) {\r\n                continue;\r\n            }\r\n            key.off("down", this.keyDownHandle);\r\n            key.off("up", this.keyUpHandle);\r\n            this.mScene.input.keyboard.removeKey(key.keyCode);\r\n        }\r\n        this.mKeyList.length = 0;\r\n        // this.mKeyList = null;\r\n    };\r\n    return KeyBoardManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/keyboard.manager.ts?')},"./src/game/mouse.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseEvent", function() { return MouseEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseManager", function() { return MouseManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _rooms_display_terrain_display__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rooms/display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _rooms_display_display_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../rooms/display/display.object */ "./src/rooms/display/display.object.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar MouseEvent;\r\n(function (MouseEvent) {\r\n    MouseEvent[MouseEvent["RightMouseDown"] = 1] = "RightMouseDown";\r\n    MouseEvent[MouseEvent["RightMouseUp"] = 2] = "RightMouseUp";\r\n    MouseEvent[MouseEvent["LeftMouseDown"] = 3] = "LeftMouseDown";\r\n    MouseEvent[MouseEvent["LeftMouseUp"] = 4] = "LeftMouseUp";\r\n    MouseEvent[MouseEvent["WheelDown"] = 5] = "WheelDown";\r\n    MouseEvent[MouseEvent["WheelUp"] = 6] = "WheelUp";\r\n    MouseEvent[MouseEvent["RightMouseHolding"] = 7] = "RightMouseHolding";\r\n    MouseEvent[MouseEvent["LeftMouseHolding"] = 8] = "LeftMouseHolding";\r\n})(MouseEvent || (MouseEvent = {}));\r\nvar MouseManager = /** @class */ (function (_super) {\r\n    __extends(MouseManager, _super);\r\n    function MouseManager(worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        _this.running = false;\r\n        _this.mDownDelay = 2000;\r\n        _this.mGame = worldService.game;\r\n        _this.mConnect = _this.worldService.connection;\r\n        return _this;\r\n    }\r\n    MouseManager.prototype.changeRoom = function (room) {\r\n        this.pause();\r\n        this.mScene = room.scene;\r\n        if (!this.mScene)\r\n            return;\r\n        this.mActivePointer = this.mScene.input.activePointer;\r\n        try {\r\n            room.addMouseListen();\r\n        }\r\n        catch (e) {\r\n        }\r\n        room.scene.input.on("gameobjectdown", this.groundDown, this);\r\n        room.scene.input.on("gameobjectup", this.groundUp, this);\r\n        room.scene.input.on("pointerdown", this.pointerDownHandler, this);\r\n        room.scene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.resume();\r\n    };\r\n    MouseManager.prototype.resize = function (width, height) {\r\n    };\r\n    MouseManager.prototype.pause = function () {\r\n        this.running = false;\r\n    };\r\n    MouseManager.prototype.resume = function () {\r\n        this.running = true;\r\n    };\r\n    MouseManager.prototype.onUpdate = function (pointer, gameobject) {\r\n        if (this.running === false || this.mActivePointer === undefined) {\r\n            return;\r\n        }\r\n        var events = [];\r\n        if (this.mActivePointer.leftButtonDown()) {\r\n            events.push(MouseEvent.LeftMouseDown);\r\n        }\r\n        else if (this.mActivePointer.leftButtonReleased()) {\r\n            events.push(MouseEvent.LeftMouseUp);\r\n        }\r\n        if (this.mActivePointer.middleButtonDown()) {\r\n            events.push(MouseEvent.WheelDown);\r\n        }\r\n        else if (this.mActivePointer.middleButtonReleased()) {\r\n            events.push(MouseEvent.WheelUp);\r\n        }\r\n        if (this.mActivePointer.rightButtonDown()) {\r\n            events.push(MouseEvent.RightMouseDown);\r\n        }\r\n        else if (this.mActivePointer.rightButtonReleased()) {\r\n            events.push(MouseEvent.RightMouseUp);\r\n        }\r\n        if (events.length === 0) {\r\n            return;\r\n        }\r\n        var id = 0;\r\n        if (gameobject.parentContainer) {\r\n            id = gameobject.parentContainer.getData("id");\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOUSE_EVENT);\r\n        var content = pkt.content;\r\n        content.id = id;\r\n        content.mouseEvent = events;\r\n        content.point3f = { x: pointer.worldX / this.worldService.uiScale, y: pointer.worldY / this.worldService.uiScale };\r\n        this.mConnect.send(pkt);\r\n    };\r\n    Object.defineProperty(MouseManager.prototype, "enable", {\r\n        get: function () {\r\n            if (this.mScene) {\r\n                return this.mScene.input.mouse.enabled;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 设置鼠标事件开关\r\n         */\r\n        set: function (value) {\r\n            if (this.mScene) {\r\n                this.mScene.input.mouse.enabled = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MouseManager.prototype.destroy = function () {\r\n        this.mActivePointer = null;\r\n        this.mScene = null;\r\n        this.mConnect = null;\r\n        this.mGroundLayer = null;\r\n        this.running = false;\r\n    };\r\n    MouseManager.prototype.groundDown = function (pointer, gameObject) {\r\n        var _this = this;\r\n        this.mActivePointer = pointer;\r\n        this.onUpdate(pointer, gameObject);\r\n        this.mDownTime = setTimeout(function () {\r\n            _this.worldService.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PRESS_ELEMENT, pointer, gameObject);\r\n        }, this.mDownDelay);\r\n    };\r\n    MouseManager.prototype.groundUp = function (pointer, gameObject) {\r\n        this.mActivePointer = pointer;\r\n        this.onUpdate(pointer, gameObject);\r\n    };\r\n    MouseManager.prototype.pointerDownHandler = function () {\r\n        if (this.worldService) {\r\n            if (this.worldService.emitter) {\r\n                this.worldService.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SCENE_BACKGROUND_CLICK);\r\n            }\r\n        }\r\n    };\r\n    MouseManager.prototype.onPointerUpHandler = function () {\r\n        clearTimeout(this.mDownTime);\r\n    };\r\n    MouseManager.prototype.selectedElement = function (pointer, gameobject) {\r\n        var com = gameobject.parentContainer;\r\n        if (!com) {\r\n            return;\r\n        }\r\n        if (!(com instanceof _rooms_display_display_object__WEBPACK_IMPORTED_MODULE_4__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        if (com instanceof _rooms_display_terrain_display__WEBPACK_IMPORTED_MODULE_3__["TerrainDisplay"]) {\r\n            return;\r\n        }\r\n        // TODO Enter decorate mode\r\n    };\r\n    return MouseManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/mouse.manager.ts?')},"./src/game/world.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(__dirname) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "World", function() { return World; });\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! phaser */ "./node_modules/phaser/dist/phaser.js-exposed");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var dragonBones__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dragonBones */ "./lib/dragonBones/dragonBones.js-exposed");\n/* harmony import */ var dragonBones__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(dragonBones__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _net_connection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../net/connection */ "./src/net/connection.ts");\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _rooms_room_manager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../rooms/room.manager */ "./src/rooms/room.manager.ts");\n/* harmony import */ var _keyboard_manager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./keyboard.manager */ "./src/game/keyboard.manager.ts");\n/* harmony import */ var _mouse_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mouse.manager */ "./src/game/mouse.manager.ts");\n/* harmony import */ var _scenes_main_ui__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../scenes/main.ui */ "./src/scenes/main.ui.ts");\n/* harmony import */ var _joystick_manager__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./joystick.manager */ "./src/game/joystick.manager.ts");\n/* harmony import */ var _element_storage__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./element.storage */ "./src/game/element.storage.ts");\n/* harmony import */ var _utils_http__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utils/http */ "./src/utils/http.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var game_capsule__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! game-capsule */ "../game-capsule/dist/index.js");\n/* harmony import */ var game_capsule__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(game_capsule__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _ui_ui_manager__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../ui/ui.manager */ "./src/ui/ui.manager.ts");\n/* harmony import */ var _lib_rexui_plugins_ninepatch_plugin_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../lib/rexui/plugins/ninepatch-plugin.js */ "./lib/rexui/plugins/ninepatch-plugin.js");\n/* harmony import */ var _lib_rexui_plugins_inputtext_plugin_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../lib/rexui/plugins/inputtext-plugin.js */ "./lib/rexui/plugins/inputtext-plugin.js");\n/* harmony import */ var _lib_rexui_plugins_bbcodetext_plugin_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../lib/rexui/plugins/bbcodetext-plugin.js */ "./lib/rexui/plugins/bbcodetext-plugin.js");\n/* harmony import */ var _lib_rexui_plugins_button_plugin_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../lib/rexui/plugins/button-plugin.js */ "./lib/rexui/plugins/button-plugin.js");\n/* harmony import */ var _lib_rexui_templates_ui_ui_plugin_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../lib/rexui/templates/ui/ui-plugin.js */ "./lib/rexui/templates/ui/ui-plugin.js");\n/* harmony import */ var _scenes_login__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../scenes/login */ "./src/scenes/login.ts");\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./account */ "./src/game/account.ts");\n/* harmony import */ var _net_http_service__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../net/http.service */ "./src/net/http.service.ts");\n/* harmony import */ var _scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../scenes/gamepause */ "./src/scenes/gamepause.ts");\n/* harmony import */ var _scenes_edit__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../scenes/edit */ "./src/scenes/edit.ts");\n/* harmony import */ var _rooms_clock__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../rooms/clock */ "./src/rooms/clock.ts");\n/* harmony import */ var _role_role_manager__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../role/role.manager */ "./src/role/role.manager.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../i18n */ "./src/i18n.ts");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! path */ "./node_modules/path-browserify/index.js");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_30___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_30__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError("Generator is already executing.");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// The World act as the global Phaser.World instance;\r\nvar World = /** @class */ (function (_super) {\r\n    __extends(World, _super);\r\n    function World(config, callBack) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mCallBack = callBack;\r\n        _this.mConfig = config;\r\n        // TODO 检测config内的必要参数如确实抛异常.\r\n        if (!config.game_id) {\r\n            throw new Error("Config.game_id is required.");\r\n        }\r\n        _utils_resUtil__WEBPACK_IMPORTED_MODULE_14__["Url"].OSD_PATH = _this.mConfig.osd || "https://osd.tooqing.com/";\r\n        _this._newGame();\r\n        _this.mConnection = config.connection || new _net_connection__WEBPACK_IMPORTED_MODULE_4__["default"](_this);\r\n        _this.mConnection.addPacketListener(_this);\r\n        _this.mClock = new _rooms_clock__WEBPACK_IMPORTED_MODULE_27__["Clock"](_this.mConnection, _this);\r\n        // add Packet listener.\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_VIRTUAL_WORLD_INIT, _this.onInitVirtualWorldPlayerInit);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_ERROR, _this.onClientErrorHandler);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SELECT_CHARACTER, _this.onSelectCharacter);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_GOTO_ANOTHER_GAME, _this.onGotoAnotherGame);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_PONG, _this.heartBeatCallBack);\r\n        _this.mGameEmitter = new Phaser.Events.EventEmitter();\r\n        _this.mRoomMamager = new _rooms_room_manager__WEBPACK_IMPORTED_MODULE_7__["RoomManager"](_this);\r\n        _this.mUiManager = new _ui_ui_manager__WEBPACK_IMPORTED_MODULE_16__["UiManager"](_this);\r\n        _this.mMouseManager = new _mouse_manager__WEBPACK_IMPORTED_MODULE_9__["MouseManager"](_this);\r\n        _this.mElementStorage = new _element_storage__WEBPACK_IMPORTED_MODULE_12__["ElementStorage"]();\r\n        _this.mHttpService = new _net_http_service__WEBPACK_IMPORTED_MODULE_24__["HttpService"](_this);\r\n        _this.mRoleManager = new _role_role_manager__WEBPACK_IMPORTED_MODULE_28__["RoleManager"](_this);\r\n        _this.mRoleManager.register();\r\n        // this.mCharacterManager = new CharacterManager(this);\r\n        // this.mCharacterManager.register();\r\n        _this.mRoomMamager.addPackListener();\r\n        _this.mUiManager.addPackListener();\r\n        var gateway = _this.mConfig.server_addr || Object({"host":"172.18.0.100","port":12100,"secure":false});\r\n        if (gateway) {\r\n            // connect to game server.\r\n            _this.mConnection.startConnect(gateway);\r\n        }\r\n        if (config.isEditor) {\r\n            _this.createGame();\r\n        }\r\n        return _this;\r\n    }\r\n    World.prototype.getConfig = function () {\r\n        return this.mConfig;\r\n    };\r\n    World.prototype.destroy = function () {\r\n        this.mConnection.closeConnect();\r\n        this.clearGame();\r\n    };\r\n    World.prototype.onConnected = function (connection) {\r\n        // Logger.getInstance().info(`enterVirtualWorld`);\r\n        this.enterVirtualWorld();\r\n        // this.login();\r\n    };\r\n    World.prototype.onDisConnected = function (connection) { };\r\n    World.prototype.onError = function (reason) { };\r\n    World.prototype.onClientErrorHandler = function (packet) {\r\n        var content = packet.content;\r\n        // Logger.getInstance().error(`Remote Error[${content.responseStatus}]: ${content.msg}`);\r\n    };\r\n    /**\r\n     * 当scene发生改变时，调用该方法并传入各个需要调整监听的manager中去\r\n     */\r\n    World.prototype.changeRoom = function (room) {\r\n        this.mInputManager.onRoomChanged(room);\r\n        this.mMouseManager.changeRoom(room);\r\n    };\r\n    World.prototype.getSize = function () {\r\n        if (!this.mGame)\r\n            return;\r\n        return this.mGame.scale.gameSize;\r\n    };\r\n    World.prototype.scaleChange = function (scale) {\r\n        this.emitter.emit(World.SCALE_CHANGE);\r\n    };\r\n    World.prototype.closeGame = function () {\r\n        if (this.mConfig.closeGame) {\r\n            this.destroy();\r\n            this.mConfig.closeGame();\r\n        }\r\n    };\r\n    World.prototype.resize = function (width, height) {\r\n        if (this.mGame) {\r\n            if (!this.mGame.device.os.desktop) {\r\n                if (width < height) {\r\n                    this.mConfig.ui_scale = (width / this.mConfig.baseHeight) * 2;\r\n                    this.mGame.scale.resize(this.mConfig.screenHeight, this.mConfig.screenWidth);\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("竖变横版");\r\n                }\r\n                else if (width > height) {\r\n                    this.mConfig.ui_scale = (width / this.mConfig.baseWidth) * 2;\r\n                    this.mGame.scale.resize(this.mConfig.screenWidth, this.mConfig.screenHeight);\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("横变竖版");\r\n                }\r\n            }\r\n            else {\r\n                this.mGame.scale.resize(width, height);\r\n            }\r\n            // this.game.canvas.style.width = this.mConfig.screenWidth + "";\r\n            // this.game.canvas.style.height = this.mConfig.screenHeight + "";\r\n            if (this.mGame.device.os.iOS) {\r\n                // Logger.getInstance().log("物理像素:" + this.mConfig.screenWidth * this.mGame.device.os.pixelRatio + "|" + "wid:" + this.mConfig.screenWidth + "|" + "pixelratio:" + this.mGame.device.os.pixelRatio);\r\n            }\r\n            else if (this.mGame.device.os.android || this.mGame.device.os.windowsPhone) {\r\n                // Logger.getInstance().log("独立像素:" + this.mConfig.screenWidth / this.mGame.device.os.pixelRatio + "|" + "wid:" + this.mConfig.screenWidth + "|" + "pixelratio:" + this.mGame.device.os.pixelRatio);\r\n            }\r\n        }\r\n        if (this.mRoomMamager) {\r\n            this.mRoomMamager.resize(width, height);\r\n        }\r\n        if (this.mUiManager) {\r\n            this.mUiManager.resize(width, height);\r\n        }\r\n        if (this.mInputManager) {\r\n            this.mInputManager.resize(width, height);\r\n        }\r\n    };\r\n    World.prototype.startFullscreen = function () {\r\n        if (!this.mGame) {\r\n            return;\r\n        }\r\n        this.mGame.scale.startFullscreen();\r\n    };\r\n    World.prototype.stopFullscreen = function () {\r\n        if (!this.mGame) {\r\n            return;\r\n        }\r\n        this.mGame.scale.stopFullscreen();\r\n    };\r\n    World.prototype.onGotoAnotherGame = function (packet) {\r\n        var content = packet.content;\r\n        this._createAnotherGame(content.gameId, content.virtualWorldId);\r\n    };\r\n    World.prototype.changeScene = function () {\r\n        var gameID = this.mConfig.game_id;\r\n        var worldID = this.mConfig.virtual_world_id;\r\n        this.clearGame();\r\n        this.mConfig.game_id = gameID;\r\n        this.mConfig.virtual_world_id = worldID;\r\n        this._newGame();\r\n        this.loginEnterWorld();\r\n    };\r\n    World.prototype.reconnect = function () {\r\n        var gameID = this.mConfig.game_id;\r\n        var worldID = this.mConfig.virtual_world_id;\r\n        this._createAnotherGame(gameID, worldID);\r\n    };\r\n    World.prototype.startHeartBeat = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_gateway"].OPCODE._OP_CLIENT_REQ_GATEWAY_PING);\r\n        this.mConnection.send(pkt);\r\n        this.mClock.sync(-1);\r\n    };\r\n    Object.defineProperty(World.prototype, "uiScale", {\r\n        get: function () {\r\n            if (this.mConfig)\r\n                return this.mConfig.ui_scale;\r\n            return 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "game", {\r\n        get: function () {\r\n            return this.mGame;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "roomManager", {\r\n        get: function () {\r\n            return this.mRoomMamager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "elementStorage", {\r\n        get: function () {\r\n            return this.mElementStorage;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "uiManager", {\r\n        get: function () {\r\n            return this.mUiManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "mouseManager", {\r\n        get: function () {\r\n            return this.mMouseManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "inputManager", {\r\n        get: function () {\r\n            return this.mInputManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "connection", {\r\n        get: function () {\r\n            return this.mConnection;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "clock", {\r\n        get: function () {\r\n            return this.mClock;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "emitter", {\r\n        get: function () {\r\n            return this.mGameEmitter;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "httpService", {\r\n        get: function () {\r\n            return this.mHttpService;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "account", {\r\n        get: function () {\r\n            return this.mAccount;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    World.prototype.enableClick = function () {\r\n        if (this.game &&\r\n            this.mRoomMamager &&\r\n            this.mRoomMamager.currentRoom &&\r\n            this.mRoomMamager.currentRoom.scene &&\r\n            this.mRoomMamager.currentRoom.scene.input) {\r\n            this.mRoomMamager.currentRoom.scene.input.enabled = true;\r\n        }\r\n    };\r\n    World.prototype.disableClick = function () {\r\n        if (this.game &&\r\n            this.mRoomMamager &&\r\n            this.mRoomMamager.currentRoom &&\r\n            this.mRoomMamager.currentRoom.scene &&\r\n            this.mRoomMamager.currentRoom.scene.input) {\r\n            this.mRoomMamager.currentRoom.scene.input.enabled = false;\r\n        }\r\n    };\r\n    World.prototype.getGameConfig = function () {\r\n        return this.gameConfig;\r\n    };\r\n    World.prototype.onClockReady = function () {\r\n        if (this.mInputManager) {\r\n            this.mInputManager.enable = true;\r\n        }\r\n    };\r\n    World.prototype._createAnotherGame = function (gameId, worldId) {\r\n        this.clearGame();\r\n        if (this.mConnection) {\r\n            this.mConnection.closeConnect();\r\n        }\r\n        if (this.mClock) {\r\n            this.mClock.destroy();\r\n            this.mClock = null;\r\n        }\r\n        this.mConfig.game_id = gameId;\r\n        this.mConfig.virtual_world_id = worldId;\r\n        this.mConnection.addPacketListener(this);\r\n        var gateway = this.mConfig.server_addr || Object({"host":"172.18.0.100","port":12100,"secure":false});\r\n        if (gateway) {\r\n            // connect to game server.\r\n            this.mConnection.startConnect(gateway);\r\n        }\r\n        this.mClock = new _rooms_clock__WEBPACK_IMPORTED_MODULE_27__["Clock"](this.mConnection, this);\r\n        this._newGame();\r\n        var loginScene = this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"].name);\r\n        if (loginScene)\r\n            loginScene.remove();\r\n        this.mGame.scene.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"].name, { world: this });\r\n    };\r\n    World.prototype.onFullScreenChange = function () {\r\n        this.resize(this.mGame.scale.gameSize.width, this.mGame.scale.gameSize.height);\r\n    };\r\n    /**！！！\r\n     * 翻转后cavas必须重新设置且必须设置为设备的独立像素(当前设备用于逻辑处理的像素)，否则phaser里面的canvas的尺寸会被撑开，导致适配出问题\r\n     * @param orientation 翻转\r\n     */\r\n    World.prototype.onOrientationChange = function (orientation) {\r\n        if (this.mConfig.platform === "app")\r\n            return;\r\n        this.resize(this.mConfig.screenWidth, this.mConfig.screenHeight);\r\n        if (orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.resize(this.mConfig.screenWidth, this.mConfig.screenHeight);\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("landscape:" + this.mConfig.screenWidth + ":" + this.mConfig.screenHeight);\r\n        }\r\n        else {\r\n            this.resize(this.mConfig.screenHeight, this.mConfig.screenWidth);\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("portrait:" + this.mConfig.screenWidth + ":" + this.mConfig.screenHeight);\r\n        }\r\n    };\r\n    World.prototype.onSelectCharacter = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_CHARACTER_CREATED);\r\n        this.connection.send(pkt);\r\n    };\r\n    World.prototype.clearGame = function () {\r\n        if (this.mGame) {\r\n            this.mGame.scale.off("enterfullscreen", this.onFullScreenChange, this);\r\n            this.mGame.scale.off("leavefullscreen", this.onFullScreenChange, this);\r\n            // this.mGame.scale.off("orientationchange", this.onOrientationChange, this);\r\n            this.mGame.plugins.removeGlobalPlugin("rexButton");\r\n            this.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin");\r\n            this.mGame.plugins.removeGlobalPlugin("rexInputText");\r\n            this.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin");\r\n            this.mGame.plugins.removeGlobalPlugin("rexMoveTo");\r\n            this.mGame.plugins.removeScenePlugin("DragonBones");\r\n            this.mGame.plugins.removeScenePlugin("rexUI");\r\n            this.mGameEmitter.destroy();\r\n            this.roomManager.destroy();\r\n            this.uiManager.destroy();\r\n            this.mGame.destroy(true);\r\n            this.mGame = null;\r\n        }\r\n    };\r\n    World.prototype.heartBeatCallBack = function () {\r\n        this.mConnection.clearHeartBeat();\r\n    };\r\n    World.prototype.initUiScale = function () {\r\n        var width = this.mConfig.width;\r\n        var height = this.mConfig.height;\r\n        var baseWidth = this.mConfig.baseWidth;\r\n        var baseHeight = this.mConfig.baseHeight;\r\n        if (!this.mGame.device.os.desktop) {\r\n            if (width < height) {\r\n                this.mConfig.ui_scale = width / baseHeight;\r\n                this.mGame.scale.orientation = Phaser.Scale.Orientation.PORTRAIT;\r\n            }\r\n            else if (width > height) {\r\n                this.mConfig.ui_scale = width / baseWidth;\r\n                this.mGame.scale.orientation = Phaser.Scale.Orientation.LANDSCAPE;\r\n            }\r\n        }\r\n    };\r\n    World.prototype.login = function () {\r\n        var _this = this;\r\n        if (!this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"].name)) {\r\n            this.mGame.scene.add(_scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"].name, _scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"]);\r\n        }\r\n        this.mGame.scene.start(_scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"].name, {\r\n            connect: this.mConnection,\r\n            world: this,\r\n            callBack: function () {\r\n                _this.loginEnterWorld();\r\n                var loginScene = _this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_22__["LoginScene"].name);\r\n                loginScene.remove();\r\n                _this.mGame.scene.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"].name, { world: _this });\r\n            }\r\n        });\r\n    };\r\n    World.prototype.enterVirtualWorld = function () {\r\n        if (!this.mGame) {\r\n            this.reconnect();\r\n            return;\r\n        }\r\n        if (this.mConfig && this.mConnection) {\r\n            this.mAccount = new _account__WEBPACK_IMPORTED_MODULE_23__["Account"]();\r\n            var loadingScene = this.mGame.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"].name);\r\n            if (!loadingScene) {\r\n                this.mGame.scene.add(_scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"].name, _scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"]);\r\n            }\r\n            if (!this.mConfig.auth_token) {\r\n                this.login();\r\n                return;\r\n            }\r\n            else {\r\n                this.mGame.scene.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_5__["LoadingScene"].name, { world: this });\r\n                this.mAccount.setAccount({\r\n                    token: this.mConfig.auth_token,\r\n                    expire: this.mConfig.token_expire,\r\n                    fingerprint: this.mConfig.token_fingerprint\r\n                });\r\n            }\r\n            this.loginEnterWorld();\r\n        }\r\n    };\r\n    World.prototype.loginEnterWorld = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var pkt, content;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, Object(_i18n__WEBPACK_IMPORTED_MODULE_29__["initLocales"])(path__WEBPACK_IMPORTED_MODULE_30__["relative"](__dirname, "../resources/locales/{{lng}}.json"))];\r\n                    case 1:\r\n                        _a.sent();\r\n                        pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_gateway"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PLAYER_INIT);\r\n                        content = pkt.content;\r\n                        // Logger.getInstance().log(`VW_id: ${this.mConfig.virtual_world_id}`);\r\n                        content.virtualWorldUuid = "" + this.mConfig.virtual_world_id;\r\n                        if (!this.mConfig.game_id ||\r\n                            !this.mAccount ||\r\n                            !this.mAccount.accountData ||\r\n                            !this.mAccount.accountData.token ||\r\n                            !this.mAccount.accountData.expire ||\r\n                            !this.mAccount.accountData.fingerprint) {\r\n                            // Logger.getInstance().debug("缺少必要参数，无法登录游戏");\r\n                            if (this.mGame)\r\n                                this.mGame.destroy(true);\r\n                            return [2 /*return*/];\r\n                        }\r\n                        content.gameId = this.mConfig.game_id;\r\n                        // const accountObj = JSON.parse();\r\n                        content.userToken = this.mConfig.auth_token = this.mAccount.accountData.token; // auth_token;\r\n                        content.expire = this.mConfig.token_expire = this.mAccount.accountData.expire + "";\r\n                        content.fingerprint = this.mConfig.token_fingerprint = this.mAccount.accountData.fingerprint;\r\n                        this.mConnection.send(pkt);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    World.prototype.onInitVirtualWorldPlayerInit = function (packet) {\r\n        var _this = this;\r\n        // if (this.mClock) this.mClock.sync(); // Manual sync remote time.\r\n        // TODO 进游戏前预加载资源\r\n        var content = packet.content;\r\n        var configUrls = content.configUrls;\r\n        if (!configUrls || configUrls.length <= 0) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().error("configUrls error: , " + configUrls + ", gameId: " + this.mConfig.game_id);\r\n            this.createGame(content.keyEvents);\r\n            return;\r\n        }\r\n        // Logger.log("start download gameConfig");\r\n        this.loadGameConfig(content.configUrls)\r\n            .then(function (gameConfig) {\r\n            _this.mElementStorage.setGameConfig(gameConfig);\r\n            _this.createGame(content.keyEvents);\r\n            // Logger.getInstance().debug("created game suc");\r\n        })\r\n            .catch(function (err) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log(err);\r\n        });\r\n    };\r\n    World.prototype._newGame = function () {\r\n        if (this.mGame) {\r\n            return this.mGame;\r\n        }\r\n        this.gameConfig = {\r\n            type: Phaser.AUTO,\r\n            zoom: 1,\r\n            parent: this.mConfig.parent || "game",\r\n            scene: null,\r\n            disableContextMenu: true,\r\n            transparent: false,\r\n            backgroundColor: 0x0,\r\n            resolution: 1,\r\n            fps: {\r\n                target: 30\r\n            },\r\n            dom: {\r\n                createContainer: true\r\n            },\r\n            plugins: {\r\n                global: [\r\n                    {\r\n                        key: "rexButton",\r\n                        plugin: _lib_rexui_plugins_button_plugin_js__WEBPACK_IMPORTED_MODULE_20__["default"],\r\n                        start: true\r\n                    },\r\n                    {\r\n                        key: "rexNinePatchPlugin",\r\n                        plugin: _lib_rexui_plugins_ninepatch_plugin_js__WEBPACK_IMPORTED_MODULE_17__["default"],\r\n                        start: true\r\n                    },\r\n                    {\r\n                        key: "rexInputText",\r\n                        plugin: _lib_rexui_plugins_inputtext_plugin_js__WEBPACK_IMPORTED_MODULE_18__["default"],\r\n                        start: true\r\n                    },\r\n                    {\r\n                        key: "rexBBCodeTextPlugin",\r\n                        plugin: _lib_rexui_plugins_bbcodetext_plugin_js__WEBPACK_IMPORTED_MODULE_19__["default"],\r\n                        start: true\r\n                    }\r\n                ],\r\n                scene: [\r\n                    {\r\n                        key: "DragonBones",\r\n                        plugin: dragonBones.phaser.plugin.DragonBonesScenePlugin,\r\n                        mapping: "dragonbone"\r\n                    },\r\n                    { key: "rexUI", plugin: _lib_rexui_templates_ui_ui_plugin_js__WEBPACK_IMPORTED_MODULE_21__["default"], mapping: "rexUI" }\r\n                ]\r\n            },\r\n            render: {\r\n                pixelArt: true,\r\n                roundPixels: true\r\n            }\r\n        };\r\n        Object.assign(this.gameConfig, this.mConfig);\r\n        this.mGame = new phaser__WEBPACK_IMPORTED_MODULE_0__["Game"](this.gameConfig);\r\n        this.initUiScale();\r\n        if (this.mRoomMamager)\r\n            this.mRoomMamager.addPackListener();\r\n        if (this.mUiManager)\r\n            this.mUiManager.addPackListener();\r\n        if (this.mRoleManager)\r\n            this.mRoleManager.register();\r\n        // if (this.mCharacterManager) this.mCharacterManager.register();\r\n        return this.mGame;\r\n    };\r\n    World.prototype.createGame = function (keyEvents) {\r\n        // start the game. TODO 此方法会多次调用，所以先要卸载已经实例化的游戏再new！\r\n        this._newGame();\r\n        // this.mGame.scene.add(PlayScene.name, PlayScene);\r\n        this.mGame.scene.add(_scenes_main_ui__WEBPACK_IMPORTED_MODULE_10__["MainUIScene"].name, _scenes_main_ui__WEBPACK_IMPORTED_MODULE_10__["MainUIScene"]);\r\n        this.mGame.scene.add(_scenes_edit__WEBPACK_IMPORTED_MODULE_26__["EditScene"].name, _scenes_edit__WEBPACK_IMPORTED_MODULE_26__["EditScene"]);\r\n        this.mGame.events.on(Phaser.Core.Events.FOCUS, this.onFocus, this);\r\n        this.mGame.events.on(Phaser.Core.Events.BLUR, this.onBlur, this);\r\n        if (this.mGame.device.os.desktop) {\r\n            this.mInputManager = new _keyboard_manager__WEBPACK_IMPORTED_MODULE_8__["KeyBoardManager"](this, keyEvents);\r\n        }\r\n        else {\r\n            this.mInputManager = new _joystick_manager__WEBPACK_IMPORTED_MODULE_11__["JoyStickManager"](this, keyEvents);\r\n        }\r\n        this.mInputManager.enable = false;\r\n        this.gameCreated();\r\n    };\r\n    World.prototype.gameCreated = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_GAME_CREATED);\r\n            this.connection.send(pkt);\r\n            if (this.mCallBack) {\r\n                this.mCallBack();\r\n            }\r\n            if (this.mConfig.game_created) {\r\n                this.mConfig.game_created();\r\n            }\r\n        }\r\n        else {\r\n            // Logger.getInstance().error("connection is undefined");\r\n        }\r\n        this.mGame.scale.on("enterfullscreen", this.onFullScreenChange, this);\r\n        this.mGame.scale.on("leavefullscreen", this.onFullScreenChange, this);\r\n        // this.mGame.scale.on("orientationchange", this.onOrientationChange, this);\r\n    };\r\n    World.prototype.loadGameConfig = function (paths) {\r\n        var _this = this;\r\n        var promises = [];\r\n        // let configPath = "";\r\n        // for (const remotePath of paths) {\r\n        //     if (PI_EXTENSION_REGEX.test(remotePath)) {\r\n        //         configPath = ResUtils.getGameConfig(remotePath);\r\n        //         // Logger.getInstance().log(`start download config: ${configPath}`);\r\n        //         promises.push(load(configPath, "arraybuffer"));\r\n        //     }\r\n        // }\r\n        promises.push(Object(_utils_http__WEBPACK_IMPORTED_MODULE_13__["load"])("http://172.17.19.48:8080/5e1d81163bcc774a3c172e94.pi", "arraybuffer"));\r\n        // TODO Promise.all如果其中有一个下载失败，会返回error\r\n        return Promise.all(promises).then(function (reqs) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("start decodeConfig");\r\n            return _this.decodeConfigs(reqs);\r\n        });\r\n    };\r\n    World.prototype.decodeConfigs = function (reqs) {\r\n        return new Promise(function (resolve, reject) {\r\n            for (var _i = 0, reqs_1 = reqs; _i < reqs_1.length; _i++) {\r\n                var req = reqs_1[_i];\r\n                var arraybuffer = req.response;\r\n                if (arraybuffer) {\r\n                    try {\r\n                        var gameConfig = new game_capsule__WEBPACK_IMPORTED_MODULE_15__["Lite"]();\r\n                        gameConfig.deserialize(new Uint8Array(arraybuffer));\r\n                        console.log("TCL: World -> gameConfig", gameConfig);\r\n                        resolve(gameConfig);\r\n                    }\r\n                    catch (error) {\r\n                        reject(error);\r\n                    }\r\n                }\r\n                else {\r\n                    reject("error");\r\n                }\r\n            }\r\n        });\r\n    };\r\n    World.prototype.onFocus = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);\r\n            var context = pkt.content;\r\n            context.gameStatus = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].GameStatus.Focus;\r\n            this.connection.send(pkt);\r\n            // 同步心跳\r\n            this.mClock.sync(-1);\r\n        }\r\n        else {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().error("connection is undefined");\r\n        }\r\n        this.resumeScene();\r\n    };\r\n    World.prototype.onBlur = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);\r\n            var context = pkt.content;\r\n            context.gameStatus = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].GameStatus.Blur;\r\n            this.connection.send(pkt);\r\n        }\r\n        else {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().error("connection is undefined");\r\n        }\r\n        this.pauseScene();\r\n    };\r\n    World.prototype.resumeScene = function () {\r\n        if (this.mConfig.isEditor) {\r\n            return;\r\n        }\r\n        this.mRoomMamager.onFocus();\r\n        var pauseScene = this.mGame.scene.getScene(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"].name);\r\n        if (pauseScene) {\r\n            pauseScene.sleep();\r\n            this.mGame.scene.stop(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"].name);\r\n        }\r\n    };\r\n    World.prototype.pauseScene = function () {\r\n        if (this.mConfig.isEditor) {\r\n            return;\r\n        }\r\n        this.mRoomMamager.onBlur();\r\n        if (!this.mGame.scene.getScene(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"].name)) {\r\n            this.mGame.scene.add(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"].name, _scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"]);\r\n        }\r\n        this.mGame.scene.start(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_25__["GamePauseScene"].name, { world: this });\r\n    };\r\n    World.SCALE_CHANGE = "scale_change";\r\n    return World;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n/* WEBPACK VAR INJECTION */}.call(this, "/"))\n\n//# sourceURL=webpack://TooqingCore/./src/game/world.ts?')},"./src/i18n.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initLocales", function() { return initLocales; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i18n", function() { return i18n; });\n/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! i18next */ "./node_modules/i18next/dist/esm/i18next.js");\n/* harmony import */ var i18next_xhr_backend__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next-xhr-backend */ "./node_modules/i18next-xhr-backend/dist/esm/i18nextXHRBackend.js");\n/* harmony import */ var i18next_browser_languagedetector__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18next-browser-languagedetector */ "./node_modules/i18next-browser-languagedetector/dist/esm/i18nextBrowserLanguageDetector.js");\n\r\n\r\n\r\nfunction initLocales(path) {\r\n    return i18next__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n        .use(i18next_xhr_backend__WEBPACK_IMPORTED_MODULE_1__["default"])\r\n        .use(i18next_browser_languagedetector__WEBPACK_IMPORTED_MODULE_2__["default"])\r\n        .init({\r\n        fallbackLng: "en",\r\n        backend: {\r\n            loadPath: path,\r\n            crossDomain: true\r\n        }\r\n    });\r\n}\r\nvar i18n = i18next__WEBPACK_IMPORTED_MODULE_0__["default"];\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/i18n.ts?')},"./src/net/connection.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! buffer/ */ "./node_modules/node-libs-browser/node_modules/buffer/index.js?7901");\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(buffer___WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! worker-loader?name=js/[hash].[name].js!./networker */ "./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/networker.ts");\n/* harmony import */ var worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! worker-loader?name=js/[hash].[name].js!./heartbeatworker */ "./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/heartbeatworker.ts");\n/* harmony import */ var worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n\r\n\r\n// import {op_client, op_gameconfig, op_gameconfig_01, op_gateway, op_virtual_world} from "pixelpai_proto";\r\n// PBpacket.addProtocol(op_client);\r\n// PBpacket.addProtocol(op_gateway);\r\n// PBpacket.addProtocol(op_gameconfig);\r\n// PBpacket.addProtocol(op_virtual_world);\r\n// PBpacket.addProtocol(op_gameconfig_01);\r\n\r\n\r\n\r\nfor (var key in pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__) {\r\n    net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"].addProtocol(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__[key]);\r\n}\r\n// 网络连接器\r\n// 使用webworker启动socket，无webworker时直接启动socket\r\nvar Connection = /** @class */ (function () {\r\n    function Connection(listener) {\r\n        this.mPacketHandlers = [];\r\n        this.mReConnectCount = 0;\r\n        this.mListener = listener;\r\n    }\r\n    Connection.prototype.startConnect = function (addr, keepalive) {\r\n        this.mCachedServerAddress = addr;\r\n        try {\r\n            this.mHeartBeatWorker = new worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_3___default.a();\r\n            this.mWorker = new worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_2___default.a();\r\n            this._doConnect();\r\n        }\r\n        catch (e) {\r\n            throw new Error("startConnect Error: " + e);\r\n        }\r\n    };\r\n    Connection.prototype.closeConnect = function () {\r\n        this.mWorker.terminate();\r\n        this.mHeartBeatWorker.terminate();\r\n        this.mCachedServerAddress = undefined;\r\n        this.mReConnectCount = 0;\r\n        this.mTimeout = null;\r\n        this.clearPacketListeners();\r\n    };\r\n    Connection.prototype.clearHeartBeat = function () {\r\n        if (this.mHeartBeatWorker) {\r\n            this.mHeartBeatWorker.postMessage({ method: "clearBeat" });\r\n        }\r\n    };\r\n    Connection.prototype.addPacketListener = function (listener) {\r\n        this.mPacketHandlers.push(listener);\r\n    };\r\n    Connection.prototype.send = function (packet) {\r\n        if (!this.mWorker) {\r\n            throw new Error("NetWorker is undefined.");\r\n        }\r\n        this.mWorker.postMessage({\r\n            "method": "send",\r\n            "buffer": packet.Serialization(),\r\n        });\r\n    };\r\n    Connection.prototype.clearReconnectCount = function () {\r\n        this.mHeartBeatWorker.postMessage("clearBeat");\r\n    };\r\n    Connection.prototype.removePacketListener = function (listener) {\r\n        var idx = this.mPacketHandlers.indexOf(listener);\r\n        if (idx !== -1) {\r\n            this.mPacketHandlers.splice(idx, 1);\r\n        }\r\n    };\r\n    Connection.prototype.clearPacketListeners = function () {\r\n        if (!this.mPacketHandlers || this.mPacketHandlers.length < 1) {\r\n            return;\r\n        }\r\n        var len = this.mPacketHandlers.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var listener = this.mPacketHandlers[i];\r\n            if (!listener)\r\n                continue;\r\n            this.removePacketListener(listener);\r\n            i--;\r\n        }\r\n    };\r\n    Connection.prototype._doConnect = function () {\r\n        // Logger.getInstance().info(`_doConnect `, this.mCachedServerAddress);\r\n        var self = this;\r\n        if (this.mWorker) {\r\n            this.mWorker.onmessage = function (event) {\r\n                self.onWorkerMessage(event.data);\r\n            };\r\n            if (this.mHeartBeatWorker) {\r\n                this.mHeartBeatWorker.onmessage = function (event) {\r\n                    self.onWorkerMessage(event.data);\r\n                };\r\n            }\r\n            this.mWorker.postMessage({\r\n                "method": "connect",\r\n                "address": self.mCachedServerAddress,\r\n            });\r\n        }\r\n    };\r\n    Connection.prototype.onWorkerMessage = function (data) {\r\n        var self = this;\r\n        var method = data.method;\r\n        switch (method) {\r\n            case "onConnected":\r\n                this.mReConnectCount = 0;\r\n                this.mListener.onConnected();\r\n                if (this.mHeartBeatWorker) {\r\n                    this.mHeartBeatWorker.postMessage({ method: "startBeat" });\r\n                }\r\n                break;\r\n            case "onDisConnected":\r\n                if (!this.mTimeout) {\r\n                    if (this.mReConnectCount < 10)\r\n                        this.mReConnectCount++;\r\n                    var delay = Math.pow(this.mReConnectCount, 2);\r\n                    // Logger.getInstance().info(`ReConnect: delay = ${delay * 1000}[c/${this.mReConnectCount}]`);\r\n                    this.mTimeout = setTimeout(function () {\r\n                        self.mTimeout = undefined;\r\n                        self._doConnect();\r\n                    }, delay * 1000);\r\n                }\r\n                break;\r\n            case "onConnectError":\r\n                // Logger.getInstance().error("error" + data.error);\r\n                // TODO\r\n                this.reConnect();\r\n                break;\r\n            case "heartBeat":\r\n                this.worldStartHeartBeat();\r\n                break;\r\n            case "endBeat":\r\n                this.endHeartBeat();\r\n                break;\r\n            case "reConnect":\r\n                this.reConnect();\r\n                break;\r\n            case "onData":\r\n                var buf = data.buffer;\r\n                if (buf) {\r\n                    this._onData(buf);\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n    Connection.prototype._onData = function (data) {\r\n        var protobufPacket = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"]();\r\n        protobufPacket.Deserialization(new buffer___WEBPACK_IMPORTED_MODULE_1__["Buffer"](data));\r\n        var handlers = this.mPacketHandlers;\r\n        handlers.forEach(function (handler) {\r\n            handler.onPacketArrived(protobufPacket);\r\n        });\r\n    };\r\n    Connection.prototype.reConnect = function () {\r\n        this.mHeartBeatWorker.postMessage({ method: "endHeartBeat" });\r\n        var world = this.mPacketHandlers[0];\r\n        world.reconnect();\r\n    };\r\n    Connection.prototype.worldStartHeartBeat = function () {\r\n        var world = this.mPacketHandlers[0];\r\n        world.startHeartBeat();\r\n    };\r\n    Connection.prototype.endHeartBeat = function () {\r\n        if (this.mHeartBeatWorker) {\r\n            this.mHeartBeatWorker.terminate();\r\n        }\r\n    };\r\n    return Connection;\r\n}());\r\n/* harmony default export */ __webpack_exports__["default"] = (Connection);\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/net/connection.ts?')},"./src/net/http.service.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpService", function() { return HttpService; });\nvar HttpService = /** @class */ (function () {\r\n    function HttpService(mWorld) {\r\n        this.mWorld = mWorld;\r\n    }\r\n    /**\r\n     * 用户关注其他用户\r\n     * @param uids\r\n     */\r\n    HttpService.prototype.follow = function (fuid) {\r\n        return this.post("user/follow", { fuid: fuid });\r\n    };\r\n    /**\r\n     * 用户取消关注其他用户\r\n     * @param fuid\r\n     */\r\n    HttpService.prototype.unfollow = function (fuid) {\r\n        return this.post("user/unfollow", { fuid: fuid });\r\n    };\r\n    /**\r\n     * 检查用户列表是否有关注的用户\r\n     * @param uids\r\n     */\r\n    HttpService.prototype.checkFollowed = function (uids) {\r\n        return this.post("user/check_followed", { "uids": uids });\r\n    };\r\n    /**\r\n     * 登录\r\n     * @param name\r\n     * @param password\r\n     */\r\n    HttpService.prototype.login = function (account, password) {\r\n        return fetch("" + "http://172.18.0.100:17170/" + "account/signin", {\r\n            body: JSON.stringify({ account: account, password: password }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    /**\r\n     * 请求手机验证码\r\n     * @param name\r\n     */\r\n    HttpService.prototype.requestPhoneCode = function (phone) {\r\n        return fetch("" + "http://172.18.0.100:17170/" + "account/sms_code", {\r\n            body: JSON.stringify({ phone: phone }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.loginByPhoneCode = function (phone, code) {\r\n        return fetch("" + "http://172.18.0.100:17170/" + "account/phone_signin", {\r\n            body: JSON.stringify({ phone: phone, code: code }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.quickLogin = function () {\r\n        return fetch("" + "http://172.18.0.100:17170/" + "account/quick_signin", {\r\n            method: "POST",\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    /**\r\n     *\r\n     * 获取用户好友列表\r\n     */\r\n    HttpService.prototype.firend = function () {\r\n        return this.get("user/friends");\r\n    };\r\n    /**\r\n     * 获取用户信息\r\n     * @param uid\r\n     */\r\n    HttpService.prototype.userDetail = function (uid) {\r\n        return this.get("account/" + uid + "/detail");\r\n    };\r\n    /**\r\n     * 用户徽章\r\n     * @param uid\r\n     */\r\n    HttpService.prototype.badgecards = function (uid) {\r\n        return this.get("userpackage/" + uid + "/badgecards");\r\n    };\r\n    HttpService.prototype.post = function (uri, body) {\r\n        var account = this.mWorld.account;\r\n        if (!account) {\r\n            return Promise.reject("account does not exist");\r\n        }\r\n        if (!account.accountData) {\r\n            return Promise.reject("token does not exist");\r\n        }\r\n        var data = {\r\n            body: JSON.stringify(body),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json",\r\n                "X-Pixelpai-TK": account.accountData.token\r\n            }\r\n        };\r\n        return fetch("" + "http://172.18.0.100:17170/" + uri, data).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.get = function (uri) {\r\n        var account = this.mWorld.account;\r\n        if (!account) {\r\n            return Promise.reject("account does not exist");\r\n        }\r\n        if (!account.accountData) {\r\n            return Promise.reject("token does not exist");\r\n        }\r\n        var data = {\r\n            method: "GET",\r\n            headers: {\r\n                "X-Pixelpai-TK": account.accountData.token\r\n            }\r\n        };\r\n        return fetch("" + "http://172.18.0.100:17170/" + uri, data).then(function (response) { return response.json(); });\r\n    };\r\n    return HttpService;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/net/http.service.ts?')},"./src/role/create.role.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRolePanel", function() { return CreateRolePanel; });\n/* harmony import */ var _ui_components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ui/components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _ui_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ui/components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _ui_components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui/components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../rooms/display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../rooms/display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import InputText from "../../../../lib/rexui/plugins/gameobjects/inputtext/InputText";\r\nvar CreateRolePanel = /** @class */ (function (_super) {\r\n    __extends(CreateRolePanel, _super);\r\n    function CreateRolePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "createCharacter";\r\n        _this.mCurPageNum = 0;\r\n        _this.setTween(false);\r\n        var container = _this.scene.add.container(0, 0);\r\n        container.add(_this);\r\n        scene.scale.on("resize", _this.onResize, _this);\r\n        return _this;\r\n        // container.scale = 1 / this.mWorld.uiScale;\r\n    }\r\n    CreateRolePanel.prototype.show = function (param) {\r\n        if (param) {\r\n            this.avatars = param.avatars;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    CreateRolePanel.prototype.preload = function () {\r\n        this.scene.load.atlas(this.key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/create_role/create_role.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/create_role/create_role.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    CreateRolePanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.setSize(size.width, size.height);\r\n        if (!this.mBackground) {\r\n            return;\r\n        }\r\n        // this.scale = 1 / this.mWorld.uiScale;\r\n        // this.mBackground.x = this.width >> 1;\r\n        // this.mBackground.y = 60 + (this.mBackground.height >> 1);\r\n        var scale = this.scene.cameras.main.height / 1920;\r\n        var width = this.scene.cameras.main.width / scale;\r\n        var height = this.scene.cameras.main.height / scale;\r\n        var centerX = this.scene.cameras.main.centerX / scale;\r\n        this.setScale(scale);\r\n        // this.mBackground.setScale(scale);\r\n        this.mBackground.x = centerX;\r\n        // this.mBackground.y = 700;\r\n        this.mFoot.x = centerX;\r\n        this.mFoot.y = height - (this.mFoot.height >> 1);\r\n        this.mBackgroundColor.clear();\r\n        this.mBackgroundColor.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        this.mBackgroundColor.fillRect(0, 0, width, height);\r\n        this.mSubmit.x = centerX;\r\n        this.inputText.x = centerX;\r\n        this.mInputTextBg.x = centerX;\r\n        this.dragonbones.x = centerX;\r\n        this.mNextPageBtn.x = width - 150;\r\n        this.mRandomBtn.x = (this.mInputTextBg.width >> 1) + centerX - this.mRandomBtn.width;\r\n    };\r\n    CreateRolePanel.prototype.init = function () {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        this.mBackground = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg.png",\r\n            x: size.width >> 1,\r\n            y: 700\r\n        });\r\n        this.add(this.mBackground);\r\n        this.mFoot = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg_foot.png"\r\n        }, false);\r\n        this.add(this.mFoot);\r\n        this.mBackgroundColor = this.scene.make.graphics(undefined, false);\r\n        this.mBackgroundColor.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        this.mBackgroundColor.fillRect(0, 0, size.width, size.height);\r\n        this.addAt(this.mBackgroundColor, 0);\r\n        this.mInputTextBg = new _ui_components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, size.width >> 1, 1000, 730, 120, this.key, "input_bg.png", {\r\n            left: 49,\r\n            top: 49,\r\n            right: 49,\r\n            bottom: 48\r\n        });\r\n        this.add(this.mInputTextBg);\r\n        this.inputText = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, size.width >> 1, 1000, 520, 80, {\r\n            type: "input",\r\n            fontSize: "52px",\r\n            color: "#717171",\r\n            style: {\r\n                align: "center"\r\n            },\r\n            placeholder: "输入关键词进行搜索"\r\n        });\r\n        this.add(this.inputText);\r\n        var text = "提 交";\r\n        if (this.mData && this.mData.button) {\r\n            text = this.mData.button.text;\r\n        }\r\n        this.mSubmit = new _ui_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__["NinePatchButton"](this.scene, size.width >> 1, 1274, 584, 164, this.key, "submit_button", text, {\r\n            left: 39,\r\n            top: 36,\r\n            right: 32,\r\n            bottom: 26\r\n        });\r\n        this.mSubmit.setTextStyle({\r\n            color: "#976400",\r\n            font: "bold 48px YaHei"\r\n        });\r\n        this.mSubmit.on("pointerup", this.onSubmitHandler, this);\r\n        this.add(this.mSubmit);\r\n        this.mPrePageBtn = this.scene.make.image({\r\n            x: 150,\r\n            y: 615,\r\n            key: this.key,\r\n            frame: "arrow_left.png"\r\n        }).setInteractive();\r\n        this.mPrePageBtn.on("pointerup", this.onPrePageHandler, this);\r\n        this.mNextPageBtn = this.scene.make.image({\r\n            x: size.width - 150,\r\n            y: 615,\r\n            key: this.key,\r\n            frame: "arrow.png"\r\n        }).setFlipX(true).setInteractive();\r\n        this.mNextPageBtn.on("pointerup", this.onNextPageHandler, this);\r\n        this.mRandomBtn = this.scene.make.image({\r\n            x: 790,\r\n            y: 1000,\r\n            key: this.key,\r\n            frame: "random.png"\r\n        }).setScale(1.4).setInteractive();\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn, this.mRandomBtn]);\r\n        this.mRandomBtn.on("pointerup", this.onRandomNameHandler, this);\r\n        // const role = this.scene.make.image({\r\n        //   x: size.width >> 1,\r\n        //   y: 560,\r\n        //   key: "role",\r\n        // }, false);\r\n        // this.add(role);\r\n        this.mErrorBg = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "tips_bg.png",\r\n            x: 620,\r\n            y: 232\r\n        }).setVisible(false);\r\n        this.mError = this.scene.make.text({\r\n            x: 420,\r\n            y: 180,\r\n            style: {\r\n                color: "#26265d",\r\n                font: "bold 34px YaHei",\r\n                wordWrap: {\r\n                    width: 420,\r\n                    useAdvancedWrap: true\r\n                },\r\n            },\r\n        }, false).setVisible(false);\r\n        this.add([this.mErrorBg, this.mError]);\r\n        this.dragonbones = new _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_5__["DragonbonesDisplay"](this.scene, undefined);\r\n        this.dragonbones.scale = 6;\r\n        this.dragonbones.x = size.width >> 1;\r\n        this.dragonbones.y = 740;\r\n        // this.dragonbones.play("idle");\r\n        this.dragonbones.once("initialized", function () {\r\n            _this.dragonbones.play("idle");\r\n        });\r\n        this.add(this.dragonbones);\r\n        this.setPageNum(0);\r\n        _super.prototype.init.call(this);\r\n        this.resize(0, 0);\r\n    };\r\n    CreateRolePanel.prototype.setAvatars = function (avatars) {\r\n        this.avatars = avatars;\r\n        // this.dragonbones.load(new DragonbonesModel({\r\n        //   id: 0,\r\n        //   avatar: avatars[0]\r\n        // }));\r\n    };\r\n    CreateRolePanel.prototype.showError = function (msg) {\r\n        if (this.mError) {\r\n            this.mError.text = msg;\r\n            this.mError.setVisible(true);\r\n            this.mErrorBg.setVisible(true);\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.setNickName = function (val) {\r\n        if (this.inputText) {\r\n            this.inputText.text = val;\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.onRandomNameHandler = function () {\r\n        this.emit("randomName");\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.onSubmitHandler = function () {\r\n        this.emit("submit", this.inputText.text, this.avatars[this.mCurPageNum]);\r\n        this.inputText.setBlur();\r\n        if (this.mError) {\r\n            this.mError.setVisible(false);\r\n            this.mErrorBg.setVisible(false);\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.onPrePageHandler = function () {\r\n        this.setPageNum(this.mCurPageNum - 1);\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.onNextPageHandler = function () {\r\n        this.setPageNum(this.mCurPageNum + 1);\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.setPageNum = function (val) {\r\n        this.mCurPageNum = val;\r\n        if (this.mCurPageNum < 0) {\r\n            this.mCurPageNum = this.avatars.length - 1;\r\n        }\r\n        else if (this.mCurPageNum >= this.avatars.length) {\r\n            this.mCurPageNum = 0;\r\n        }\r\n        this.dragonbones.load(new _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_6__["DragonbonesModel"]({\r\n            id: 0,\r\n            avatar: this.avatars[this.mCurPageNum]\r\n        }));\r\n    };\r\n    CreateRolePanel.prototype.onResize = function (gameSize) {\r\n        this.resize(gameSize.width, gameSize.height);\r\n    };\r\n    return CreateRolePanel;\r\n}(_ui_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/create.role.panel.ts?')},"./src/role/create.role.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRole", function() { return CreateRole; });\n/* harmony import */ var _scenes_create_character__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scenes/create.character */ "./src/scenes/create.character.ts");\n/* harmony import */ var _create_role_panel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./create.role.panel */ "./src/role/create.role.panel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar CreateRole = /** @class */ (function (_super) {\r\n    __extends(CreateRole, _super);\r\n    function CreateRole($roleManager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.roleManager = $roleManager;\r\n        _this.world = _this.roleManager.world;\r\n        return _this;\r\n    }\r\n    CreateRole.prototype.enter = function (content) {\r\n        this.mAvatars = content.avatars;\r\n        this.mParam = content;\r\n        if (!this.world.game.scene.getScene(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name))\r\n            this.world.game.scene.add(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name, _scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"]);\r\n        this.world.game.scene.start(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name, {\r\n            world: this.world,\r\n            role: this\r\n        });\r\n    };\r\n    CreateRole.prototype.start = function (scene) {\r\n        this.createPanel = new _create_role_panel__WEBPACK_IMPORTED_MODULE_1__["CreateRolePanel"](scene, this.world);\r\n        this.createPanel.show(this.mParam);\r\n        this.createPanel.on("randomName", this.onRandomNameHandler, this);\r\n        this.createPanel.on("submit", this.onSubmitHandler, this);\r\n        if (this.world.connection) {\r\n            this.world.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_ERROR_MESSAGE, this.onCreateErrorHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_GENERATE_NEW_NAME, this.onGenerateNameHandler);\r\n        }\r\n    };\r\n    CreateRole.prototype.destroy = function () {\r\n        if (this.world.connection) {\r\n            this.world.connection.removePacketListener(this);\r\n        }\r\n        this.world.game.scene.remove(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name);\r\n        if (this.createPanel)\r\n            this.createPanel.destroy();\r\n    };\r\n    CreateRole.prototype.onRandomNameHandler = function () {\r\n        var connection = this.world.connection;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE_GENERATE_NEW_NAME);\r\n        connection.send(packet);\r\n    };\r\n    CreateRole.prototype.onSubmitHandler = function (name, avatar) {\r\n        var connection = this.world.connection;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE);\r\n        var content = packet.content;\r\n        content.name = name;\r\n        content.avatar = avatar;\r\n        connection.send(packet);\r\n    };\r\n    CreateRole.prototype.onCreateErrorHandler = function (packet) {\r\n        if (!this.createPanel) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        this.createPanel.showError(content.errorMsg);\r\n    };\r\n    CreateRole.prototype.onGenerateNameHandler = function (packet) {\r\n        if (!this.createPanel) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        this.createPanel.setNickName(content.name);\r\n    };\r\n    return CreateRole;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/create.role.ts?')},"./src/role/role.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoleManager", function() { return RoleManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _create_role__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./create.role */ "./src/role/create.role.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * 角色创建，选择管理\r\n */\r\nvar RoleManager = /** @class */ (function (_super) {\r\n    __extends(RoleManager, _super);\r\n    function RoleManager($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        return _this;\r\n    }\r\n    RoleManager.prototype.register = function () {\r\n        if (this.world) {\r\n            var connection = this.world.connection;\r\n            if (connection) {\r\n                connection.addPacketListener(this);\r\n                this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_CREATE_ROLE_UI, this.onOpenCreateCharacter);\r\n                this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CLOSE_CREATE_ROLE_UI, this.onCloseCreateCharacterHandler);\r\n            }\r\n        }\r\n    };\r\n    RoleManager.prototype.unregister = function () {\r\n        if (this.world) {\r\n            var connection = this.world.connection;\r\n            if (connection) {\r\n                connection.removePacketListener(this);\r\n            }\r\n        }\r\n    };\r\n    RoleManager.prototype.onOpenCreateCharacter = function (packet) {\r\n        this.mCreateCharacter = new _create_role__WEBPACK_IMPORTED_MODULE_1__["CreateRole"](this);\r\n        this.mCreateCharacter.enter(packet.content);\r\n    };\r\n    RoleManager.prototype.onCloseCreateCharacterHandler = function () {\r\n        if (this.mCreateCharacter) {\r\n            this.mCreateCharacter.destroy();\r\n            this.mCreateCharacter = undefined;\r\n        }\r\n    };\r\n    return RoleManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/role.manager.ts?')},"./src/rooms/bubble/bubble.container.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BubbleContainer", function() { return BubbleContainer; });\n/* harmony import */ var _bubble__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bubble */ "./src/rooms/bubble/bubble.ts");\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar BubbleContainer = /** @class */ (function (_super) {\r\n    __extends(BubbleContainer, _super);\r\n    function BubbleContainer(scene) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mBubbles = [];\r\n        _this.mArrow = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.mArrow.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/chat/bubble_arrow.png"));\r\n        _this.add(_this.mArrow);\r\n        return _this;\r\n    }\r\n    BubbleContainer.prototype.addBubble = function (text, bubbleSetting) {\r\n        var bubble = this.createBubble(bubbleSetting);\r\n        var len = this.mBubbles.length;\r\n        var bul = null;\r\n        var h = 0;\r\n        for (var i = len - 1; i >= 0; i--) {\r\n            bul = this.mBubbles[i];\r\n            h += bul.minHeight + 5;\r\n            bul.tweenTo(-h);\r\n        }\r\n        bubble.show(text, bubbleSetting);\r\n        this.add(bubble);\r\n        this.mArrow.y = bubble.minHeight + 4;\r\n    };\r\n    BubbleContainer.prototype.destroy = function (fromScene) {\r\n        var len = this.mBubbles.length;\r\n        var bul = null;\r\n        for (var i = len - 1; i >= 0; i--) {\r\n            bul = this.mBubbles[i];\r\n            if (!bul)\r\n                continue;\r\n            bul.destroy();\r\n        }\r\n        this.mBubbles = null;\r\n        this.removeFormParent();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    BubbleContainer.prototype.removeFormParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    BubbleContainer.prototype.createBubble = function (bubbleSetting) {\r\n        if (!bubbleSetting)\r\n            return;\r\n        var bubble = new _bubble__WEBPACK_IMPORTED_MODULE_0__["Bubble"](this.scene);\r\n        this.mBubbles.push(bubble);\r\n        var duration = bubbleSetting.duration ? bubbleSetting.duration : 5000;\r\n        bubble.durationRemove(duration, this.onRemoveBubble, this);\r\n        return bubble;\r\n    };\r\n    BubbleContainer.prototype.onRemoveBubble = function (bubble) {\r\n        if (!bubble) {\r\n            return;\r\n        }\r\n        this.mBubbles = this.mBubbles.filter(function (val) { return bubble !== val; });\r\n        this.remove(bubble);\r\n        bubble.destroy();\r\n        if (this.mBubbles.length === 0) {\r\n            this.removeFormParent();\r\n        }\r\n    };\r\n    return BubbleContainer;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/bubble/bubble.container.ts?')},"./src/rooms/bubble/bubble.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bubble", function() { return Bubble; });\n/* harmony import */ var _ui_components_dynamic_ninepatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/components/dynamic.ninepatch */ "./src/ui/components/dynamic.ninepatch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Bubble = /** @class */ (function (_super) {\r\n    __extends(Bubble, _super);\r\n    function Bubble(scene) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mMinWidth = 0;\r\n        _this.mMinHeight = 0;\r\n        _this.x = -60;\r\n        return _this;\r\n    }\r\n    Bubble.prototype.show = function (text, bubble) {\r\n        this.mChatContent = this.scene.make.text({\r\n            text: text,\r\n            style: {\r\n                x: 0,\r\n                y: 4,\r\n                fontFamily: "YaHei",\r\n                fontSize: 14,\r\n                color: "#000000",\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 300, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.add(this.mChatContent);\r\n        this.mMinHeight = this.mChatContent.height + 26;\r\n        this.mMinHeight = this.mMinHeight < 54 ? 54 : this.mMinHeight;\r\n        this.mMinWidth = this.mChatContent.width + 40;\r\n        this.mMinWidth = this.mMinWidth < 69 ? 69 : this.mMinWidth;\r\n        this.mBubbleBg = new _ui_components_dynamic_ninepatch__WEBPACK_IMPORTED_MODULE_0__["DynamicNinepatch"](this.scene, this);\r\n        var res = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(bubble.bubbleResource || "platformitem/thumbnail/bubble_01.png");\r\n        this.mBubbleBg.load(res, {\r\n            width: this.mMinWidth,\r\n            height: this.mMinHeight,\r\n            key: res,\r\n            columns: [34, 2, 32],\r\n            rows: [42, 2, 9]\r\n        }, this.onComplete, this);\r\n    };\r\n    Bubble.prototype.tweenTo = function (toY) {\r\n        this.mToY = toY;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            y: toY,\r\n            alpha: 1,\r\n            duration: 200\r\n        });\r\n    };\r\n    Bubble.prototype.durationRemove = function (duration, callback, callbackContext) {\r\n        var _this = this;\r\n        this.mTweenCompleteCallback = callback;\r\n        this.mTweenCallContext = callbackContext;\r\n        this.mRemoveDelay = setTimeout(function () {\r\n            _this.removeTween();\r\n        }, duration);\r\n    };\r\n    Bubble.prototype.removeTween = function () {\r\n        var _this = this;\r\n        var endY = this.mToY - 30;\r\n        var tween = this.scene.tweens.add({\r\n            targets: this,\r\n            y: endY,\r\n            alpha: 0,\r\n            duration: 200,\r\n            onComplete: function () {\r\n                if (_this.mTweenCompleteCallback) {\r\n                    _this.mTweenCompleteCallback.call(_this.mTweenCallContext, _this);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    Bubble.prototype.destroy = function () {\r\n        if (this.mChatContent) {\r\n            this.mChatContent.destroy(true);\r\n        }\r\n        this.mChatContent = null;\r\n        this.mMinWidth = 0;\r\n        this.mMinHeight = 0;\r\n        this.mToY = 0;\r\n        this.mTweenCompleteCallback = null;\r\n        this.mTweenCallContext = null;\r\n        if (this.mRemoveDelay) {\r\n            clearTimeout(this.mRemoveDelay);\r\n        }\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Bubble.prototype.onComplete = function (img) {\r\n        if (img) {\r\n            img.setOrigin(0, 0);\r\n            this.addAt(img, 0);\r\n            var bound = this.getBounds();\r\n            this.mChatContent.x = this.mMinWidth - this.mChatContent.width >> 1;\r\n            this.mChatContent.y = (this.mMinHeight - this.mChatContent.height >> 1) + 6;\r\n        }\r\n    };\r\n    Object.defineProperty(Bubble.prototype, "minWidth", {\r\n        get: function () {\r\n            return this.mMinWidth;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Bubble.prototype, "minHeight", {\r\n        get: function () {\r\n            return this.mMinHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Bubble;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/bubble/bubble.ts?')},"./src/rooms/cameras/block.object.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockObject", function() { return BlockObject; });\nvar BlockObject = /** @class */ (function () {\r\n    function BlockObject() {\r\n        this.mRenderable = false;\r\n    }\r\n    BlockObject.prototype.setRenderable = function (isRenderable, delay) {\r\n        var _this = this;\r\n        if (this.mRenderable !== isRenderable) {\r\n            delay = delay ? delay : 0;\r\n            this.mRenderable = isRenderable;\r\n            if (isRenderable) {\r\n                this.addDisplay();\r\n                if (delay > 0) {\r\n                    this.fadeIn();\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                if (delay > 0) {\r\n                    this.fadeOut(function () {\r\n                        _this.removeDisplay();\r\n                    });\r\n                }\r\n                else {\r\n                    this.removeDisplay();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    BlockObject.prototype.getRenderable = function () {\r\n        return this.mRenderable;\r\n    };\r\n    BlockObject.prototype.fadeIn = function (callback) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        this.mDisplay.fadeIn(callback);\r\n    };\r\n    BlockObject.prototype.fadeOut = function (callback) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        this.mDisplay.fadeOut(callback);\r\n    };\r\n    BlockObject.prototype.fadeAlpha = function (alpha) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        // this.mDisplay.alpha = alpha;\r\n    };\r\n    BlockObject.prototype.destroy = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n    };\r\n    BlockObject.prototype.addDisplay = function () {\r\n    };\r\n    BlockObject.prototype.removeDisplay = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.removeFromParent();\r\n    };\r\n    BlockObject.prototype.addToBlock = function () {\r\n    };\r\n    BlockObject.prototype.updateBlock = function () {\r\n    };\r\n    return BlockObject;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/block.object.ts?')},"./src/rooms/cameras/cameras.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CamerasManager", function() { return CamerasManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_rectangle45__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/rectangle45 */ "./src/utils/rectangle45.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar CamerasManager = /** @class */ (function (_super) {\r\n    __extends(CamerasManager, _super);\r\n    function CamerasManager(mRoomService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.MINI_VIEW_SIZE = 28;\r\n        _this.VIEW_PORT_SIZE = 30;\r\n        _this.viewPort = new Phaser.Geom.Rectangle();\r\n        _this.miniViewPort = new Phaser.Geom.Rectangle();\r\n        return _this;\r\n    }\r\n    CamerasManager.prototype.getViewPort = function () {\r\n        if (!this.mCamera)\r\n            return;\r\n        var worldView = this.mCamera.worldView;\r\n        // const out = new Phaser.Geom.Rectangle(worldView.x, worldView.y, worldView.width, worldView.height);\r\n        // out.x -= out.width >> 1;\r\n        // out.y -= out.height >> 1;\r\n        // out.width *= 2;\r\n        // out.height *= 2;\r\n        // out.x -= 200;\r\n        // out.y -= 200;\r\n        // out.width += 400;\r\n        // out.height += 400;\r\n        // this.viewPort.setPosition(worldView.x - worldView.width / 2, worldView.y - worldView.height / 2);\r\n        this.viewPort.x = worldView.x + (worldView.width - this.viewPort.width >> 1);\r\n        this.viewPort.y = worldView.y + (worldView.height - this.viewPort.height >> 1);\r\n        return this.viewPort;\r\n    };\r\n    CamerasManager.prototype.getMiniViewPort = function () {\r\n        if (!this.mCamera)\r\n            return;\r\n        var worldView = this.mCamera.worldView;\r\n        this.miniViewPort.x = worldView.x + (worldView.width - this.miniViewPort.width >> 1);\r\n        this.miniViewPort.y = worldView.y + (worldView.height - this.miniViewPort.height >> 1);\r\n        var pos = this.mRoomService.transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](this.miniViewPort.x + (this.miniViewPort.width >> 1), this.miniViewPort.y));\r\n        return new _utils_rectangle45__WEBPACK_IMPORTED_MODULE_3__["Rectangle45"](pos.x, pos.y, this.MINI_VIEW_SIZE, this.MINI_VIEW_SIZE);\r\n    };\r\n    Object.defineProperty(CamerasManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mCamera;\r\n        },\r\n        set: function (camera) {\r\n            this.mCamera = camera;\r\n            this.setViewPortSize();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CamerasManager.prototype.resize = function (width, height) {\r\n        this.resetCameraSize(width, height);\r\n    };\r\n    CamerasManager.prototype.offsetScroll = function (x, y) {\r\n        if (!this.mCamera) {\r\n            return;\r\n        }\r\n        this.mCamera.scrollX += x;\r\n        this.mCamera.scrollY += y;\r\n        // this.mCamera.setScroll(x, y);\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = this.mCamera.scrollX;\r\n        content.y = this.mCamera.scrollY;\r\n        content.width = 0;\r\n        content.height = 0;\r\n        this.connection.send(pkt);\r\n    };\r\n    CamerasManager.prototype.startFollow = function (target) {\r\n        if (this.mCamera) {\r\n            this.mCamera.startFollow(target);\r\n        }\r\n    };\r\n    CamerasManager.prototype.setBounds = function (x, y, width, height, centerOn) {\r\n        if (!this.mCamera) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("camera does not exist");\r\n            return;\r\n        }\r\n        this.mCamera.setBounds(x, y, width, height, centerOn);\r\n    };\r\n    CamerasManager.prototype.syncToEditor = function () {\r\n        if (!this.mCamera) {\r\n            return;\r\n        }\r\n        var cameraView = this.mCamera.worldView;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = cameraView.x;\r\n        content.y = cameraView.y;\r\n        content.width = cameraView.width;\r\n        content.height = cameraView.height;\r\n        this.connection.send(pkt);\r\n    };\r\n    CamerasManager.prototype.centerCameas = function () {\r\n        if (!this.mCamera || !this.mRoomService) {\r\n            return;\r\n        }\r\n        var roomSize = this.mRoomService.roomSize;\r\n        this.mCamera.setScroll((roomSize.sceneWidth - this.mCamera.width >> 1), (roomSize.sceneHeight - this.mCamera.height >> 1));\r\n        var cameraView = this.mCamera.worldView;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = this.mCamera.scrollX;\r\n        content.y = this.mCamera.scrollY;\r\n        content.width = this.mCamera.width;\r\n        content.height = this.mCamera.height;\r\n        this.connection.send(pkt);\r\n    };\r\n    CamerasManager.prototype.resetCameraSize = function (width, height) {\r\n        if (!this.connection) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("connection is undefined");\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_RESET_CAMERA_SIZE);\r\n        var size = packet.content;\r\n        size.width = width;\r\n        size.height = height;\r\n        this.connection.send(packet);\r\n    };\r\n    CamerasManager.prototype.setViewPortSize = function () {\r\n        if (!this.mCamera) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("camera does not exist");\r\n            return;\r\n        }\r\n        var size = this.mRoomService.roomSize;\r\n        if (!size) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room size does not exist");\r\n            return;\r\n        }\r\n        var viewW = (this.VIEW_PORT_SIZE + this.VIEW_PORT_SIZE) * (size.tileWidth / 2);\r\n        var viewH = (this.VIEW_PORT_SIZE + this.VIEW_PORT_SIZE) * (size.tileHeight / 2);\r\n        this.viewPort.setSize(viewW, viewH);\r\n        var miniViewW = (this.MINI_VIEW_SIZE + this.MINI_VIEW_SIZE) * (size.tileWidth / 2);\r\n        var miniviewH = (this.MINI_VIEW_SIZE + this.MINI_VIEW_SIZE) * (size.tileHeight / 2);\r\n        this.miniViewPort.setSize(miniViewW, miniviewH);\r\n    };\r\n    Object.defineProperty(CamerasManager.prototype, "connection", {\r\n        get: function () {\r\n            if (!this.mRoomService) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room service is undefined");\r\n                return;\r\n            }\r\n            return this.mRoomService.connection;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return CamerasManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/cameras.manager.ts?')},"./src/rooms/cameras/viewblock.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ViewblockManager", function() { return ViewblockManager; });\n/* harmony import */ var _viewblock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./viewblock */ "./src/rooms/cameras/viewblock.ts");\n\r\nvar ViewblockManager = /** @class */ (function () {\r\n    function ViewblockManager(cameras) {\r\n        this.mBlocks = [];\r\n        this.mDelay = 0;\r\n        this.mCameras = cameras;\r\n    }\r\n    ViewblockManager.prototype.add = function (e) {\r\n        var miniView = this.mCameras.getMiniViewPort();\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            var rect = block.rectangle;\r\n            var ePos = e.getPosition();\r\n            if (!ePos)\r\n                return;\r\n            if (rect.contains(ePos.x, ePos.y)) {\r\n                block.add(e, miniView);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.remove = function (e) {\r\n        if (!e)\r\n            return;\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            if (block.remove(e)) {\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.check = function (e) {\r\n        if (!e)\r\n            return;\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            if (block.inCamera) {\r\n                var rect = block.rectangle;\r\n                var pos = e.getPosition();\r\n                if (rect.contains(pos.x, pos.y)) {\r\n                    if (!block.getElement(e.id)) {\r\n                        this.remove(e);\r\n                        block.add(e);\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.int = function (size) {\r\n        if (!size) {\r\n            return;\r\n        }\r\n        this.mBlocks = [];\r\n        var colSize = 10;\r\n        var viewW = (colSize + colSize) * (size.tileWidth / 2);\r\n        var viewH = (colSize + colSize) * (size.tileHeight / 2);\r\n        var blockW = size.sceneWidth / viewW;\r\n        var blockH = size.sceneHeight / viewH;\r\n        var index = 0;\r\n        for (var i = 0; i < blockW; i++) {\r\n            for (var j = 0; j < blockH; j++) {\r\n                var block = new _viewblock__WEBPACK_IMPORTED_MODULE_0__["Viewblock"](new Phaser.Geom.Rectangle(i * viewW, j * viewH, viewW, viewH), index++);\r\n                this.mBlocks.push(block);\r\n                // this.layerManager.addToAtmosphere(block.drawBoard(this.scene));\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.update = function (time, delta) {\r\n        if (!this.mCameras)\r\n            return;\r\n        // if (time - this.mDelay < 3000) {\r\n        //     return;\r\n        // }\r\n        this.mDelay = time;\r\n        var bound = this.mCameras.getViewPort();\r\n        var miniViewPort = this.mCameras.getMiniViewPort();\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            block.check(bound, miniViewPort);\r\n        }\r\n    };\r\n    ViewblockManager.prototype.destroy = function () {\r\n        this.mDelay = 0;\r\n    };\r\n    return ViewblockManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/viewblock.manager.ts?')},"./src/rooms/cameras/viewblock.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Viewblock", function() { return Viewblock; });\n/**\r\n * 显示区域\r\n */\r\nvar Viewblock = /** @class */ (function () {\r\n    function Viewblock(mRect, index) {\r\n        this.mRect = mRect;\r\n        // private mElements: IElement[] = [];\r\n        this.mElements = new Map();\r\n        this.mIndex = index;\r\n    }\r\n    Viewblock.prototype.add = function (element, miniViewPort) {\r\n        // this.mElements.push(element);\r\n        this.mElements.set(element.id, element);\r\n        if (!miniViewPort) {\r\n            return;\r\n        }\r\n        var pos = element.getPosition45();\r\n        element.setRenderable(miniViewPort.contains(pos.x, pos.y) && this.mInCamera);\r\n    };\r\n    Viewblock.prototype.remove = function (ele) {\r\n        // const index = this.mElements.indexOf(ele);\r\n        // if (index !== -1) {\r\n        //     this.mElements.splice(index, 1);\r\n        //     return true;\r\n        // }\r\n        return this.mElements.delete(ele.id);\r\n    };\r\n    // tick running... powered by manager.\r\n    Viewblock.prototype.check = function (bound, miniViewPort) {\r\n        if (!bound)\r\n            return;\r\n        var newStat = Phaser.Geom.Intersects.RectangleToRectangle(bound, this.rectangle);\r\n        // if (this.mInCamera !== newStat) {\r\n        //     for (const e of this.mElements) {\r\n        //         根据情况看是否需要提前加载\r\n        //         e.setRenderable(newStat);\r\n        //     }\r\n        // }\r\n        if (!miniViewPort)\r\n            return;\r\n        if (this.mInCamera) {\r\n            // for (const ele of this.mElements) {\r\n            //     const pos = ele.getPosition45();\r\n            //     ele.setRenderable(miniViewPort.contains(pos.x, pos.y), 1000);\r\n            // }\r\n            this.mElements.forEach(function (ele) {\r\n                var pos = ele.getPosition45();\r\n                ele.setRenderable(miniViewPort.contains(pos.x, pos.y), 1000);\r\n            });\r\n        }\r\n        this.mInCamera = newStat;\r\n    };\r\n    Viewblock.prototype.getElement = function (id) {\r\n        return this.mElements.get(id);\r\n    };\r\n    Object.defineProperty(Viewblock.prototype, "rectangle", {\r\n        get: function () {\r\n            return this.mRect || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Viewblock.prototype, "inCamera", {\r\n        get: function () {\r\n            return this.mInCamera;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Viewblock;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/viewblock.ts?')},"./src/rooms/clock.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Clock", function() { return Clock; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_algorithm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/algorithm */ "./src/utils/algorithm.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar LATENCY_SAMPLES = 7; // Latency Array length\r\nvar MIN_READY_SAMPLES = 2;\r\nvar CHECK_INTERVAL = 8000; // (ms)\r\nvar MAX_DELAY = 500; // (ms)\r\nvar Clock = /** @class */ (function (_super) {\r\n    __extends(Clock, _super);\r\n    function Clock(conn, listener) {\r\n        var _this = _super.call(this) || this;\r\n        // clock是否同步完成\r\n        _this.mClockSync = false;\r\n        _this.mAutoSync = false;\r\n        _this.mLatency = [];\r\n        _this.mConn = conn;\r\n        _this.mConn.addPacketListener(_this);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SYNC_TIME, _this.proof);\r\n        _this.mListener = listener;\r\n        _this._check();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Clock.prototype, "sysUnixTime", {\r\n        get: function () {\r\n            return new Date().getTime();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Clock.prototype, "unixTime", {\r\n        get: function () {\r\n            return this.mTimestamp;\r\n        },\r\n        set: function (t) {\r\n            this.mTimestamp = t;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Clock.prototype.sync = function (times) {\r\n        if (times === void 0) { times = 1; }\r\n        if (!this.mConn)\r\n            return;\r\n        if (times < 0) {\r\n            times = 1;\r\n        }\r\n        for (var i = 0; i < times; ++i) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_TIME);\r\n            var ct = pkt.content;\r\n            ct.clientStartTs = this.sysUnixTime;\r\n            this.mConn.send(pkt);\r\n        }\r\n    };\r\n    Clock.prototype.update = function (time, delta) {\r\n        if (!this.mTimestamp)\r\n            this.mTimestamp = time;\r\n        else\r\n            this.mTimestamp += delta;\r\n    };\r\n    Clock.prototype.clearTime = function () {\r\n        this.mClockSync = false;\r\n        if (this.mIntervalId) {\r\n            clearInterval(this.mIntervalId);\r\n        }\r\n        this.mTimestamp = 0;\r\n        this._check();\r\n    };\r\n    Clock.prototype.destroy = function () {\r\n        if (this.mConn) {\r\n            this.mConn.removePacketListener(this);\r\n            this.mConn = undefined;\r\n        }\r\n        if (this.mIntervalId) {\r\n            clearInterval(this.mIntervalId);\r\n        }\r\n        this.mLatency = undefined;\r\n    };\r\n    Object.defineProperty(Clock.prototype, "clockSync", {\r\n        get: function () {\r\n            return this.mClockSync;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Clock.prototype._check = function () {\r\n        var self = this;\r\n        this.mIntervalId = setInterval(function () {\r\n            self.sync();\r\n        }, CHECK_INTERVAL);\r\n    };\r\n    Clock.prototype.proof = function (packet) {\r\n        var ct = packet.content;\r\n        var local_receive = this.sysUnixTime, local_send = ct.clientStartTs, remote_receive = ct.serverReceiveTs, remote_send = ct.serverSendTs, server_run = remote_send - remote_receive, total_delay = (local_receive - local_send) - server_run, latency = Math.round(total_delay / 2);\r\n        var timeSychronDelta = 0;\r\n        if (latency < 0)\r\n            return;\r\n        this.mLatency.push(latency);\r\n        if (this.mLatency.length > LATENCY_SAMPLES) {\r\n            this.mLatency.shift();\r\n        }\r\n        var median_latency = _utils_algorithm__WEBPACK_IMPORTED_MODULE_2__["Algorithm"].median(this.mLatency);\r\n        timeSychronDelta = median_latency + server_run;\r\n        var remote_time = remote_send - timeSychronDelta; // the real remote-time.\r\n        var mistake = Math.abs(remote_time - this.mTimestamp);\r\n        // update timesychron\r\n        if (mistake > MAX_DELAY) {\r\n            this.mTimestamp = remote_time;\r\n            this.mAutoSync = true;\r\n            // Logger.getInstance().debug("正在同步clock");\r\n            // if (this.mAutoSync) {\r\n            this.sync(-1);\r\n            return;\r\n            //  }\r\n        }\r\n        this.mAutoSync = false;\r\n        if (this.mListener && this.mLatency.length >= MIN_READY_SAMPLES && !this.mAutoSync) {\r\n            this.mClockSync = true;\r\n            // Logger.getInstance().debug("clock同步完成");\r\n            this.mListener.onClockReady();\r\n        }\r\n        // Logger.getInstance().debug(`total_delay: ${total_delay} / latency: ${latency} | timeSychronDelta: ${timeSychronDelta} / remote_time: ${remote_time} / mistake: ${mistake}`);\r\n    };\r\n    return Clock;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/clock.ts?')},"./src/rooms/decorate.room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateRoom", function() { return DecorateRoom; });\n/* harmony import */ var _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cameras/cameras.manager */ "./src/rooms/cameras/cameras.manager.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _decorate_selected_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./decorate/selected.element */ "./src/rooms/decorate/selected.element.ts");\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _scenes_play__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../scenes/play */ "./src/scenes/play.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _element_decorate_element_manager__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./element/decorate.element.manager */ "./src/rooms/element/decorate.element.manager.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _terrain_decorate_terrain_manager__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./terrain/decorate.terrain.manager */ "./src/rooms/terrain/decorate.terrain.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DecorateRoom = /** @class */ (function (_super) {\r\n    __extends(DecorateRoom, _super);\r\n    function DecorateRoom(manager) {\r\n        var _this = _super.call(this) || this;\r\n        // TODO clock sync\r\n        _this.clockSyncComplete = true;\r\n        _this.world = manager.world;\r\n        _this.mCameraService = new _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_0__["CamerasManager"](_this);\r\n        if (_this.world) {\r\n            var size = _this.world.getSize();\r\n            if (size) {\r\n                _this.mCameraService.resize(size.width, size.height);\r\n            }\r\n            else {\r\n                throw new Error("World::getSize undefined!");\r\n            }\r\n        }\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_SELECTED_SPRITE, _this.onSelectSpriteHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateRoom.prototype.enter = function (room) {\r\n        // this.mID = room.id;\r\n        this.mID = room.id;\r\n        var rows = room.rows, cols = room.cols, tileWidth = room.tileWidth, tileHeight = room.tileHeight;\r\n        this.mSize = {\r\n            cols: room.cols,\r\n            rows: room.rows,\r\n            tileHeight: room.tileHeight,\r\n            tileWidth: room.tileWidth,\r\n            sceneWidth: (room.rows + room.cols) * (room.tileWidth / 2),\r\n            sceneHeight: (room.rows + room.cols) * (room.tileHeight / 2)\r\n        };\r\n        rows *= 2;\r\n        cols *= 2;\r\n        tileWidth /= 2;\r\n        tileHeight /= 2;\r\n        this.mMiniSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        this.mMap = new Array(rows);\r\n        for (var i = 0; i < rows; i++) {\r\n            this.mMap[i] = new Array(cols).fill(0);\r\n        }\r\n        if (!this.world.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"].name))\r\n            this.world.game.scene.add(_scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"].name, _scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"], false);\r\n        this.world.game.scene.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"].name, {\r\n            world: this.world,\r\n            room: this\r\n        });\r\n    };\r\n    DecorateRoom.prototype.addBlockObject = function (object) {\r\n    };\r\n    DecorateRoom.prototype.addMouseListen = function () {\r\n    };\r\n    DecorateRoom.prototype.addToGround = function (element) {\r\n        this.mLayerManager.addToGround(element);\r\n    };\r\n    DecorateRoom.prototype.addToSceneUI = function (element) {\r\n        this.mLayerManager.addToSceneToUI(element);\r\n    };\r\n    DecorateRoom.prototype.addToSurface = function (element) {\r\n        this.mLayerManager.addToSurface(element);\r\n    };\r\n    DecorateRoom.prototype.addToUI = function (element) {\r\n    };\r\n    DecorateRoom.prototype.completeLoad = function () {\r\n        this.world.game.scene.add(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, _scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"], true, {\r\n            room: this\r\n        });\r\n    };\r\n    DecorateRoom.prototype.destroy = function () {\r\n        if (this.mTerrainManager)\r\n            this.mTerrainManager.destroy();\r\n        if (this.mElementManager)\r\n            this.mElementManager.destroy();\r\n        if (this.mLayerManager)\r\n            this.mLayerManager.destroy();\r\n        this.removePointerMoveHandler();\r\n        this.world.game.scene.remove(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].TURN_ELEMENT, this.onTurnElementHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].RECYCLE_ELEMENT, this.onRecycleHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PUT_ELEMENT, this.onPutElement, this);\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.off("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.off("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.off("gameobjectdown", this.onGameobjectUpHandler, this);\r\n    };\r\n    DecorateRoom.prototype.now = function () {\r\n        return 0;\r\n    };\r\n    DecorateRoom.prototype.pause = function () {\r\n        if (this.mScene) {\r\n            this.mScene.scene.pause();\r\n        }\r\n    };\r\n    DecorateRoom.prototype.removeBlockObject = function (object) {\r\n    };\r\n    DecorateRoom.prototype.requestActorMove = function (d, key) {\r\n    };\r\n    DecorateRoom.prototype.resume = function (name) {\r\n        if (this.mScene) {\r\n            this.mScene.scene.resume(name);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.startLoad = function () {\r\n    };\r\n    DecorateRoom.prototype.startPlay = function () {\r\n        if (this.mLayerManager) {\r\n            this.mLayerManager.destroy();\r\n        }\r\n        this.mScene = this.world.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.mLayerManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_1__["LayerManager"](this);\r\n        this.mLayerManager.drawGrid(this);\r\n        this.mTerrainManager = new _terrain_decorate_terrain_manager__WEBPACK_IMPORTED_MODULE_15__["DecorateTerrainManager"](this);\r\n        this.mElementManager = new _element_decorate_element_manager__WEBPACK_IMPORTED_MODULE_12__["DecorateElementManager"](this);\r\n        this.mScene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.on("gameobjectdown", this.onGameobjectUpHandler, this);\r\n        this.mCameraService.camera = this.scene.cameras.main;\r\n        // const mainCameras = this.mScene.cameras.main;\r\n        this.mCameraService.setBounds(-200, -200, this.mSize.sceneWidth + 400, this.mSize.sceneHeight + 400);\r\n        this.world.changeRoom(this);\r\n        var loadingScene = this.world.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"].name);\r\n        if (loadingScene)\r\n            loadingScene.sleep();\r\n        this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        // this.mCameraService.centerCameas();\r\n        if (this.world.uiManager) {\r\n            this.world.uiManager.showDecorateUI();\r\n        }\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].TURN_ELEMENT, this.onTurnElementHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].RECYCLE_ELEMENT, this.onRecycleHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PUT_ELEMENT, this.onPutElement, this);\r\n    };\r\n    DecorateRoom.prototype.transformTo45 = function (p) {\r\n        if (!this.mSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_2__["Position45"].transformTo45(p, this.mSize);\r\n    };\r\n    DecorateRoom.prototype.transformTo90 = function (p) {\r\n        if (!this.mSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_2__["Position45"].transformTo90(p, this.mSize);\r\n    };\r\n    DecorateRoom.prototype.transformToMini90 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_2__["Position45"].transformTo90(p, this.mMiniSize);\r\n    };\r\n    DecorateRoom.prototype.transformToMini45 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_2__["Position45"].transformTo45(p, this.mMiniSize);\r\n    };\r\n    DecorateRoom.prototype.update = function (time, delta) {\r\n        if (this.mLayerManager) {\r\n            this.mLayerManager.update(time, delta);\r\n        }\r\n        if (this.mSelectedElement) {\r\n            this.mSelectedElement.update(time, delta);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.updateBlockObject = function () {\r\n    };\r\n    DecorateRoom.prototype.resize = function (width, height) {\r\n        this.layerManager.resize(width, height);\r\n        this.mCameraService.resize(width, height);\r\n    };\r\n    DecorateRoom.prototype.transitionGrid = function (x, y) {\r\n        var source = new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](x, y);\r\n        var pos = this.transformToMini45(source);\r\n        return this.checkBound(pos);\r\n    };\r\n    DecorateRoom.prototype.addElements = function (sprites, nodeType) {\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType) {\r\n            this.mElementManager.add(sprites);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.TerrainNodeType) {\r\n            this.mTerrainManager.add(sprites);\r\n        }\r\n    };\r\n    /**\r\n     * 边界检查\r\n     * @param pos 45度坐标，\r\n     * @param source 没有超出边界并不贴边就返回原始坐标\r\n     */\r\n    DecorateRoom.prototype.checkBound = function (pos, source) {\r\n        var bound = new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](pos.x, pos.y);\r\n        var size = this.mMiniSize;\r\n        if (pos.x < 0) {\r\n            bound.x = 0;\r\n        }\r\n        else if (pos.x > size.cols) {\r\n            bound.x = size.cols;\r\n        }\r\n        if (pos.y < 0) {\r\n            bound.y = 0;\r\n        }\r\n        else if (pos.y > size.rows) {\r\n            bound.y = size.rows;\r\n        }\r\n        if (bound.equal(pos) && source) {\r\n            return source;\r\n        }\r\n        return this.transformToMini90(bound);\r\n    };\r\n    DecorateRoom.prototype.canPut = function (sprite) {\r\n        var pos = this.transformToMini45(sprite.pos);\r\n        if (pos.x < 0 || pos.y < 0 || pos.x > this.miniSize.rows || pos.y > this.miniSize.cols) {\r\n            return false;\r\n        }\r\n        var map = this.mElementManager.map;\r\n        var displayInfo = sprite.displayInfo;\r\n        var aniName = sprite.currentAnimationName || displayInfo.animationName;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName);\r\n        var origin = displayInfo.getOriginPoint(aniName);\r\n        for (var i = 0; i < collisionArea.length; i++) {\r\n            for (var j = 0; j < collisionArea[i].length; j++) {\r\n                if (map[i + pos.y - origin.y][j + pos.x - origin.x] === 0) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DecorateRoom.prototype.setMap = function (cols, rows, type) {\r\n        if (rows < 0 || cols < 0 || this.mMap.length < rows || this.mMap[0].length < cols) {\r\n            return;\r\n        }\r\n        this.mMap[cols][rows] = type;\r\n    };\r\n    DecorateRoom.prototype.addPointerMoveHandler = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("gameout", this.onGameOutHandler, this);\r\n    };\r\n    DecorateRoom.prototype.removePointerMoveHandler = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.off("gameout", this.onGameOutHandler, this);\r\n    };\r\n    DecorateRoom.prototype.onPointerUpHandler = function (pointer) {\r\n        this.removePointerMoveHandler();\r\n        if (this.mSelectedElement) {\r\n            // TODO 移动判断\r\n            if (this.mSelectedElement.selecting) {\r\n                this.mSelectedElement.selecting = false;\r\n                if (pointer.downX !== pointer.upX && pointer.downY !== pointer.upY) {\r\n                    this.sendPosition(this.mSelectedElement.sprite);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateRoom.prototype.onPointerDownHandler = function () {\r\n        this.addPointerMoveHandler();\r\n    };\r\n    DecorateRoom.prototype.onGameobjectUpHandler = function (pointer, gameobject) {\r\n        this.addPointerMoveHandler();\r\n        var com = gameobject.parentContainer;\r\n        if (!com) {\r\n            return;\r\n        }\r\n        this.selectedElement(com);\r\n    };\r\n    DecorateRoom.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (!this.mSelectedElement || this.mSelectedElement.selecting === false) {\r\n            this.moveCamera(pointer);\r\n            return;\r\n        }\r\n        if (pointer.downX === pointer.x && pointer.downY === pointer.y) {\r\n            return;\r\n        }\r\n        // if (pointer.downX !== pointer.upX && pointer.downY !== pointer.upY) {\r\n        this.moveElement(pointer);\r\n    };\r\n    DecorateRoom.prototype.onGameOutHandler = function () {\r\n        this.removePointerMoveHandler();\r\n    };\r\n    DecorateRoom.prototype.moveCamera = function (pointer) {\r\n        this.cameraService.offsetScroll(pointer.prevPosition.x - pointer.position.x, pointer.prevPosition.y - pointer.position.y);\r\n    };\r\n    DecorateRoom.prototype.moveElement = function (pointer) {\r\n        var pos = this.transitionGrid(pointer.worldX, pointer.worldY);\r\n        this.mSelectedElement.setDisplayPos(pos.x, pos.y);\r\n        // }\r\n        if (pointer.x < 300) {\r\n            if (pointer.prevPosition.x > pointer.x)\r\n                this.mCameraService.camera.scrollX -= pointer.prevPosition.x - pointer.x;\r\n        }\r\n        else if (pointer.x > this.world.getSize().width - 300) {\r\n            if (pointer.x > pointer.prevPosition.x)\r\n                this.mCameraService.camera.scrollX += pointer.x - pointer.prevPosition.x;\r\n        }\r\n        if (pointer.y < 300) {\r\n            if (pointer.prevPosition.y > pointer.y)\r\n                this.mCameraService.camera.scrollY -= pointer.prevPosition.y - pointer.y;\r\n        }\r\n        else if (pointer.y > this.world.getSize().height - 300) {\r\n            if (pointer.y > pointer.prevPosition.y)\r\n                this.mCameraService.camera.scrollY += pointer.y - pointer.prevPosition.y;\r\n        }\r\n    };\r\n    DecorateRoom.prototype.removeElement = function (id, nodeType) {\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType) {\r\n            this.elementManager.remove(id);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.TerrainNodeType) {\r\n            this.elementManager.remove(id);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.addElement = function (sprite) {\r\n        var nodeType = sprite.nodeType;\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType) {\r\n            this.mElementManager.add([sprite]);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.TerrainNodeType) {\r\n            this.mTerrainManager.add([sprite]);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.selectedElement = function (display) {\r\n        if (!(display instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_10__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedElement) {\r\n            this.mSelectedElement = new _decorate_selected_element__WEBPACK_IMPORTED_MODULE_6__["SelectedElement"](this.mScene, this);\r\n        }\r\n        if (display instanceof _display_terrain_display__WEBPACK_IMPORTED_MODULE_11__["TerrainDisplay"]) {\r\n            return;\r\n        }\r\n        this.mSelectedElement.selecting = true;\r\n        if (this.mSelectedElement.display === display) {\r\n            return;\r\n        }\r\n        var element = display.element;\r\n        if (element) {\r\n            var sprite = element.model;\r\n            if (sprite) {\r\n                this.removeElement(element.id, sprite.nodeType);\r\n            }\r\n        }\r\n        if (this.mSelectedElement.display) {\r\n            this.onPutElement(this.mSelectedElement.display);\r\n        }\r\n        var ele = display.element;\r\n        if (ele)\r\n            this.mSelectedElement.setSprite(ele.model, ele.model);\r\n        // this.mSelectedElement.setElement(display);\r\n    };\r\n    DecorateRoom.prototype.onTurnElementHandler = function (display) {\r\n        if (!this.mSelectedElement) {\r\n            return;\r\n        }\r\n        var sprite = this.mSelectedElement.sprite;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        this.mSelectedElement.turnElement();\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_FLIP_SPRITE);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.world.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.onRecycleHandler = function (display) {\r\n        if (!this.mSelectedElement) {\r\n            return;\r\n        }\r\n        var sprite = this.mSelectedElement.sprite;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_SPRITE);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.world.connection.send(packet);\r\n        this.mSelectedElement.remove();\r\n    };\r\n    DecorateRoom.prototype.onPutElement = function (display) {\r\n        if (!this.mSelectedElement) {\r\n            return;\r\n        }\r\n        var sprite = this.mSelectedElement.sprite;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        // TODO 还要考虑翻转\r\n        var aniName = sprite.currentAnimationName || sprite.displayInfo.animationName;\r\n        if (this.canPut(sprite)) {\r\n            this.addElement(sprite);\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SPRITE);\r\n            var content = packet.content;\r\n            content.sprites = [sprite.toSprite()];\r\n            content.nodeType = sprite.nodeType;\r\n            this.world.connection.send(packet);\r\n            this.mSelectedElement.remove();\r\n        }\r\n        else {\r\n            // TODO 不可放置，回到之前的位置\r\n            // this.addElement()\r\n            if (this.mSelectedElement.root) {\r\n                this.addElement(this.mSelectedElement.root);\r\n                this.sendPosition(this.mSelectedElement.root);\r\n            }\r\n        }\r\n        this.mSelectedElement.remove();\r\n    };\r\n    DecorateRoom.prototype.sendPosition = function (sprite) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_CHANGE_SPRITE_POSITION);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.world.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.onSelectSpriteHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (!this.mSelectedElement) {\r\n            this.mSelectedElement = new _decorate_selected_element__WEBPACK_IMPORTED_MODULE_6__["SelectedElement"](this.scene, this);\r\n        }\r\n        this.mSelectedElement.selecting = true;\r\n        var sprite = new _element_sprite__WEBPACK_IMPORTED_MODULE_14__["Sprite"](content.sprite, content.nodeType);\r\n        var pointer = this.scene.input.activePointer;\r\n        sprite.setPosition(pointer.worldX, pointer.worldY);\r\n        this.mSelectedElement.setSprite(sprite);\r\n    };\r\n    Object.defineProperty(DecorateRoom.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "roomSize", {\r\n        get: function () {\r\n            return this.mSize;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "terrainManager", {\r\n        get: function () {\r\n            return this.mTerrainManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "layerManager", {\r\n        get: function () {\r\n            return this.mLayerManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "cameraService", {\r\n        get: function () {\r\n            return this.mCameraService;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "scene", {\r\n        get: function () {\r\n            return this.mScene;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "connection", {\r\n        get: function () {\r\n            return this.world.connection;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "miniSize", {\r\n        get: function () {\r\n            return this.mMiniSize;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DecorateRoom;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/decorate.room.ts?')},"./src/rooms/decorate/selected.element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectedElement", function() { return SelectedElement; });\n/* harmony import */ var _display_frames_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var _ui_decorate_decorate_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ui/decorate/decorate.manager */ "./src/ui/decorate/decorate.manager.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n\r\n\r\n\r\n\r\nvar SelectedElement = /** @class */ (function () {\r\n    function SelectedElement(scene, roomService) {\r\n        this.scene = scene;\r\n        this.roomService = roomService;\r\n        this.mDecorateManager = new _ui_decorate_decorate_manager__WEBPACK_IMPORTED_MODULE_1__["DecorateManager"](scene, roomService);\r\n        this.mDecorateManager.on("moveElement", this.onMoveElementHandler, this);\r\n    }\r\n    SelectedElement.prototype.setElement = function (display) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.hideRefernceArea();\r\n            this.mDecorateManager.remove();\r\n        }\r\n        this.mDisplay = display;\r\n        display.showRefernceArea();\r\n        this.mDecorateManager.setElement(display);\r\n        this.mDisplay = display;\r\n        this.roomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_COLLAPSE);\r\n    };\r\n    SelectedElement.prototype.setSprite = function (sprite, root) {\r\n        var _this = this;\r\n        // this.mDisplay = new FramesDisplay(this.scene, this.roomService);\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        if (root) {\r\n            this.mRootSprite = new _element_sprite__WEBPACK_IMPORTED_MODULE_2__["Sprite"](sprite.toSprite(), sprite.nodeType);\r\n        }\r\n        else {\r\n            this.mRootSprite = null;\r\n        }\r\n        this.mSprite = sprite;\r\n        this.mDisplay = new _display_frames_display__WEBPACK_IMPORTED_MODULE_0__["FramesDisplay"](this.scene, this.roomService);\r\n        var pos = sprite.pos;\r\n        this.mDisplay.x = pos.x;\r\n        this.mDisplay.y = pos.y;\r\n        this.mDisplay.once("initialized", function () {\r\n            _this.mDisplay.showRefernceArea();\r\n            _this.mDisplay.setDirection(sprite.direction);\r\n            _this.mDecorateManager.setElement(_this.mDisplay);\r\n            _this.roomService.addToSurface(_this.mDisplay);\r\n        });\r\n        this.mDisplay.load(sprite.displayInfo);\r\n        this.mSelecting = true;\r\n        this.roomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_COLLAPSE);\r\n    };\r\n    SelectedElement.prototype.turnElement = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var sprite = this.sprite;\r\n        sprite.turn();\r\n        this.mDisplay.setDirection(sprite.direction);\r\n    };\r\n    SelectedElement.prototype.remove = function () {\r\n        this.mDecorateManager.remove();\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        if (this.mRootSprite) {\r\n            this.mRootSprite = null;\r\n        }\r\n        this.roomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_EXPANED);\r\n    };\r\n    SelectedElement.prototype.update = function (time, delta) {\r\n        if (this.mDisplay) {\r\n            this.mDecorateManager.updatePos(this.mDisplay.x, this.mDisplay.y);\r\n        }\r\n    };\r\n    SelectedElement.prototype.setDisplayPos = function (x, y) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.x = x;\r\n        this.mDisplay.y = y;\r\n        this.mDecorateManager.updatePos(x, y);\r\n        this.mSprite.setPosition(x, y);\r\n        if (this.roomService.canPut(this.mSprite)) {\r\n            this.mDisplay.alpha = 1;\r\n        }\r\n        else {\r\n            this.mDisplay.alpha = 0.6;\r\n        }\r\n        // this.mLayerManager.depthSurfaceDirty = true;\r\n    };\r\n    SelectedElement.prototype.onMoveElementHandler = function (pos) {\r\n        if (!pos) {\r\n            return;\r\n        }\r\n        this.setDisplayPos(pos.x, pos.y);\r\n    };\r\n    Object.defineProperty(SelectedElement.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "sprite", {\r\n        get: function () {\r\n            return this.mSprite;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "root", {\r\n        get: function () {\r\n            return this.mRootSprite;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "selecting", {\r\n        get: function () {\r\n            return this.mSelecting;\r\n        },\r\n        set: function (val) {\r\n            this.mSelecting = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return SelectedElement;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/decorate/selected.element.ts?')},"./src/rooms/display/animation.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Animation", function() { return Animation; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n\r\nvar Animation = /** @class */ (function () {\r\n    function Animation(ani) {\r\n        var tmpBaseLoc = null;\r\n        if (typeof ani.baseLoc === "string") {\r\n            tmpBaseLoc = ani.baseLoc.split(",");\r\n        }\r\n        else {\r\n            tmpBaseLoc = [ani.baseLoc.x, ani.baseLoc.y];\r\n        }\r\n        this.mID = ani.id;\r\n        this.mBaseLoc = tmpBaseLoc;\r\n        this.mName = ani.name;\r\n        this.mFrameName = ani.frameName;\r\n        this.mLoop = ani.loop;\r\n        this.mFrameRate = ani.frameRate;\r\n        this.mBaseLoc = new Phaser.Geom.Point(parseInt(tmpBaseLoc[0], 10), parseInt(tmpBaseLoc[1], 10));\r\n        var origin = ani.originPoint;\r\n        if (Array.isArray(origin)) {\r\n            this.mOriginPoint = new Phaser.Geom.Point(origin[0], origin[1]);\r\n        }\r\n        else {\r\n            this.mOriginPoint = new Phaser.Geom.Point(origin.x, origin.y);\r\n        }\r\n        if (typeof ani.collisionArea === "string") {\r\n            this.mCollisionArea = this.stringToArray(ani.collisionArea, ",", "&");\r\n        }\r\n        else {\r\n            this.mCollisionArea = ani.collisionArea;\r\n        }\r\n        if (typeof ani.walkableArea === "string") {\r\n            this.mWalkableArea = this.stringToArray(ani.walkableArea, ",", "&");\r\n        }\r\n        else {\r\n            this.mWalkableArea = ani.walkableArea;\r\n        }\r\n    }\r\n    Animation.prototype.toClient = function () {\r\n        var ani = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_gameconfig"].Animation.create();\r\n        ani.id = this.id;\r\n        ani.baseLoc = this.baseLoc.x + "," + this.baseLoc.y;\r\n        ani.name = this.name;\r\n        ani.loop = this.loop;\r\n        ani.frameRate = this.frameRate;\r\n        ani.frameName = this.frameName;\r\n        ani.originPoint = [this.originPoint.x, this.originPoint.y];\r\n        ani.walkOriginPoint = [this.originPoint.x, this.originPoint.y];\r\n        ani.walkableArea = this.arrayToString(this.mWalkableArea, ",", "&");\r\n        ani.collisionArea = this.arrayToString(this.mCollisionArea, ",", "&");\r\n        return ani;\r\n    };\r\n    Animation.prototype.stringToArray = function (string, fristJoin, lastJoin) {\r\n        if (!string) {\r\n            return;\r\n        }\r\n        var tmp = string.split(lastJoin);\r\n        var result = [];\r\n        for (var _i = 0, tmp_1 = tmp; _i < tmp_1.length; _i++) {\r\n            var ary = tmp_1[_i];\r\n            var tmpAry = ary.split(fristJoin);\r\n            result.push(tmpAry.map(function (value) { return parseInt(value, 10); }));\r\n        }\r\n        return result;\r\n    };\r\n    Animation.prototype.arrayToString = function (array, fristJoin, lastJoin) {\r\n        if (!array)\r\n            return "";\r\n        var tmp = [];\r\n        for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\r\n            var ary = array_1[_i];\r\n            tmp.push(ary.join(fristJoin));\r\n        }\r\n        return tmp.join(lastJoin);\r\n    };\r\n    Object.defineProperty(Animation.prototype, "baseLoc", {\r\n        get: function () {\r\n            return this.mBaseLoc;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "frameName", {\r\n        get: function () {\r\n            return this.mFrameName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "frameRate", {\r\n        get: function () {\r\n            return this.mFrameRate;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "loop", {\r\n        get: function () {\r\n            return this.mLoop;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "name", {\r\n        get: function () {\r\n            return this.mName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "collisionArea", {\r\n        get: function () {\r\n            return this.mCollisionArea;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "originPoint", {\r\n        get: function () {\r\n            return this.mOriginPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Animation;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/animation.ts?')},"./src/rooms/display/display.object.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayField", function() { return DisplayField; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayObject", function() { return DisplayObject; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _ui_components_dynamic_sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ui/components/dynamic.sprite */ "./src/ui/components/dynamic.sprite.ts");\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _editor_reference_area__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../editor/reference.area */ "./src/rooms/editor/reference.area.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar DisplayField;\r\n(function (DisplayField) {\r\n    DisplayField[DisplayField["BACKEND"] = 1] = "BACKEND";\r\n    DisplayField[DisplayField["STAGE"] = 2] = "STAGE";\r\n    DisplayField[DisplayField["FRONTEND"] = 3] = "FRONTEND";\r\n    DisplayField[DisplayField["FLAG"] = 4] = "FLAG";\r\n})(DisplayField || (DisplayField = {}));\r\nvar DisplayObject = /** @class */ (function (_super) {\r\n    __extends(DisplayObject, _super);\r\n    function DisplayObject(scene, roomService, element) {\r\n        var _this = _super.call(this, scene) || this;\r\n        /**\r\n         * 实际透明度，避免和tween混淆\r\n         */\r\n        _this.mAlpha = 1;\r\n        _this.mDirection = 3;\r\n        _this.mElement = element;\r\n        _this.mRoomService = roomService;\r\n        _this.mChildMap = new Map();\r\n        return _this;\r\n    }\r\n    DisplayObject.prototype.changeAlpha = function (val) {\r\n        if (this.mAlpha === val) {\r\n            return;\r\n        }\r\n        this.alpha = val;\r\n        this.mAlpha = val;\r\n    };\r\n    DisplayObject.prototype.removeFromParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    DisplayObject.prototype.fadeIn = function (callback) {\r\n    };\r\n    DisplayObject.prototype.fadeOut = function (callback) {\r\n    };\r\n    DisplayObject.prototype.load = function (data, field) {\r\n    };\r\n    DisplayObject.prototype.play = function (animationName, field) {\r\n    };\r\n    DisplayObject.prototype.setDirection = function (val) {\r\n        if (this.mDirection !== val) {\r\n            this.mDirection = val;\r\n            if (val === 5 || val === 7) {\r\n                this.scaleX = -1;\r\n            }\r\n            else {\r\n                this.scaleX = 1;\r\n            }\r\n        }\r\n    };\r\n    DisplayObject.prototype.destroy = function (fromScene) {\r\n        if (this.mFlagContainer) {\r\n            if (this.mNickname) {\r\n                this.mNickname.destroy();\r\n                this.mNickname = undefined;\r\n            }\r\n            if (this.mBackEffect) {\r\n                this.mBackEffect.destroy();\r\n                this.mBackEffect = undefined;\r\n            }\r\n            if (this.mFrontEffect) {\r\n                this.mFrontEffect.destroy();\r\n                this.mFrontEffect = undefined;\r\n            }\r\n            this.clearBadges();\r\n            this.mFlagContainer.destroy();\r\n            this.mFlagContainer = undefined;\r\n        }\r\n        if (this.mReferenceArea) {\r\n            this.mReferenceArea.destroy();\r\n            this.mReferenceArea = undefined;\r\n        }\r\n        if (this.mChildMap) {\r\n            this.mChildMap.clear();\r\n            this.mChildMap = null;\r\n        }\r\n        // this.removeAll(true);\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    DisplayObject.prototype.showNickname = function (val) {\r\n        if (!this.mNickname) {\r\n            this.mNickname = this.scene.make.text({ style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].YAHEI_14_BOLD } }, false).setOrigin(0.5, 0.5);\r\n            this.flagContainer.add(this.mNickname);\r\n        }\r\n        this.mNickname.setText(val);\r\n        this.layouFlag();\r\n    };\r\n    DisplayObject.prototype.setDisplayBadges = function (cards) {\r\n        if (!this.mBadges)\r\n            this.mBadges = [];\r\n        else\r\n            this.clearBadges();\r\n        for (var _i = 0, cards_1 = cards; _i < cards_1.length; _i++) {\r\n            var card = cards_1[_i];\r\n            var badge = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__["DynamicImage"](this.scene, 0, 0);\r\n            badge.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(card.thumbnail), this, this.layouFlag);\r\n            this.flagContainer.add(badge);\r\n            this.mBadges.push(badge);\r\n        }\r\n    };\r\n    DisplayObject.prototype.showRefernceArea = function () {\r\n        if (!this.mReferenceArea) {\r\n            this.mReferenceArea = new _editor_reference_area__WEBPACK_IMPORTED_MODULE_4__["ReferenceArea"](this.scene, this.mRoomService);\r\n            this.addChildMap("reference", this.mReferenceArea);\r\n        }\r\n        if (!this.mCollisionArea || this.mCollisionArea.length <= 0)\r\n            return;\r\n        this.mReferenceArea.draw(this.mCollisionArea, this.mOriginPoint);\r\n        this.addAt(this.mReferenceArea, 0);\r\n    };\r\n    DisplayObject.prototype.hideRefernceArea = function () {\r\n        if (this.mReferenceArea) {\r\n            this.mReferenceArea.destroy();\r\n            this.mReferenceArea = undefined;\r\n        }\r\n    };\r\n    DisplayObject.prototype.showEffect = function () {\r\n        this.addEffect(this.mBackEffect, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_back.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_back.json"), true, 15, false, true);\r\n        this.addEffect(this.mFrontEffect, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_front.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_front.json"), true, 15, false, true);\r\n    };\r\n    DisplayObject.prototype.getElement = function (key) {\r\n        if (!this.mChildMap) {\r\n            return;\r\n        }\r\n        return this.mChildMap.get(key);\r\n    };\r\n    DisplayObject.prototype.addEffect = function (target, textureURL, atlasURL, isBack, framerate, loop, killComplete) {\r\n        if (!target) {\r\n            target = new _ui_components_dynamic_sprite__WEBPACK_IMPORTED_MODULE_1__["DynamicSprite"](this.scene, 0, 0);\r\n        }\r\n        target.load(textureURL, atlasURL);\r\n        target.y = -20;\r\n        if (isBack) {\r\n            this.addAt(target, DisplayField.BACKEND);\r\n        }\r\n        else {\r\n            this.addAt(target, DisplayField.FRONTEND);\r\n        }\r\n        // target.play(textureURL + atlasURL);\r\n        target.once(Phaser.Animations.Events.SPRITE_ANIMATION_COMPLETE, function () {\r\n            target.destroy();\r\n        });\r\n    };\r\n    DisplayObject.prototype.layouFlag = function (offset) {\r\n        if (offset === void 0) { offset = 4; }\r\n        if (!this.mFlagContainer)\r\n            return;\r\n        this.mFlagContainer.y = -96;\r\n        this.bringToTop(this.mNickname);\r\n        var children = this.mFlagContainer.list;\r\n        var _x = 0;\r\n        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\r\n            var child = children_1[_i];\r\n            child["x"] = _x;\r\n            if (child["width"])\r\n                _x = child["width"];\r\n        }\r\n    };\r\n    DisplayObject.prototype.clearBadges = function () {\r\n        if (!this.mBadges)\r\n            return;\r\n        for (var _i = 0, _a = this.mBadges; _i < _a.length; _i++) {\r\n            var badge = _a[_i];\r\n            badge.destroy();\r\n        }\r\n        this.mBadges.length = 0;\r\n    };\r\n    Object.defineProperty(DisplayObject.prototype, "flagContainer", {\r\n        get: function () {\r\n            if (this.mFlagContainer)\r\n                return this.mFlagContainer;\r\n            this.mFlagContainer = this.scene.make.container(undefined, false);\r\n            this.addAt(this.mFlagContainer, DisplayField.FLAG);\r\n            return this.mFlagContainer;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DisplayObject.prototype.addChildMap = function (key, display) {\r\n        if (!this.mChildMap) {\r\n            this.mChildMap = new Map();\r\n        }\r\n        this.mChildMap.set(key, display);\r\n    };\r\n    DisplayObject.prototype.removeChildMap = function (key) {\r\n        if (!this.mChildMap) {\r\n            return;\r\n        }\r\n        this.mChildMap.delete(key);\r\n    };\r\n    Object.defineProperty(DisplayObject.prototype, "baseLoc", {\r\n        get: function () {\r\n            return this.mBaseLoc || new Phaser.Geom.Point();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "sortX", {\r\n        get: function () {\r\n            return this.x;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "sortY", {\r\n        get: function () {\r\n            return this.y;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "element", {\r\n        get: function () {\r\n            return this.mElement;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "collisionArea", {\r\n        get: function () {\r\n            return this.mCollisionArea;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "originPoint", {\r\n        get: function () {\r\n            return this.mOriginPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DisplayObject;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/display.object.ts?')},"./src/rooms/display/dragonbones.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarSlotType", function() { return AvatarSlotType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarPartType", function() { return AvatarPartType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragonbonesDisplay", function() { return DragonbonesDisplay; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _display_object__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./display.object */ "./src/rooms/display/display.object.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar AvatarSlotType;\r\n(function (AvatarSlotType) {\r\n    AvatarSlotType["BodyCostDres"] = "body_cost_$_dres";\r\n    AvatarSlotType["BodyCost"] = "body_cost_$";\r\n    AvatarSlotType["BodyTail"] = "body_tail_$";\r\n    AvatarSlotType["BodyWing"] = "body_wing_$";\r\n    AvatarSlotType["BodyBase"] = "body_base_$";\r\n    AvatarSlotType["BodySpec"] = "body_spec_$";\r\n    AvatarSlotType["FlegSpec"] = "fleg_spec_$";\r\n    AvatarSlotType["FlegBase"] = "fleg_base_$";\r\n    AvatarSlotType["FlegCost"] = "fleg_cost_$";\r\n    AvatarSlotType["BarmSpec"] = "barm_spec_$";\r\n    AvatarSlotType["BarmBase"] = "barm_base_$";\r\n    AvatarSlotType["BarmCost"] = "barm_cost_$";\r\n    AvatarSlotType["WeapBarm"] = "weap_barm_$";\r\n    AvatarSlotType["ShldBarm"] = "shld_barm_$";\r\n    AvatarSlotType["BlegSpec"] = "bleg_spec_$";\r\n    AvatarSlotType["BlegBase"] = "bleg_base_$";\r\n    AvatarSlotType["BlegCost"] = "bleg_cost_$";\r\n    AvatarSlotType["FarmSpec"] = "farm_spec_$";\r\n    AvatarSlotType["FarmBase"] = "farm_base_$";\r\n    AvatarSlotType["FarmCost"] = "farm_cost_$";\r\n    AvatarSlotType["ShldFarm"] = "shld_farm_$";\r\n    AvatarSlotType["WeapFarm"] = "weap_farm_$";\r\n    AvatarSlotType["HeadSpec"] = "head_spec_$";\r\n    AvatarSlotType["HeadMask"] = "head_mask_$";\r\n    AvatarSlotType["HeadEyes"] = "head_eyes_$";\r\n    AvatarSlotType["HeadBase"] = "head_base_$";\r\n    AvatarSlotType["HeadHairBack"] = "head_hair_$_back";\r\n    AvatarSlotType["HeadMous"] = "head_mous_$";\r\n    AvatarSlotType["HeadHair"] = "head_hair_$";\r\n    AvatarSlotType["HeadHats"] = "head_hats_$";\r\n})(AvatarSlotType || (AvatarSlotType = {}));\r\nvar AvatarPartType;\r\n(function (AvatarPartType) {\r\n    AvatarPartType["BarmBase"] = "barm_base_#_$";\r\n    AvatarPartType["BarmCost"] = "barm_cost_#_$";\r\n    AvatarPartType["BarmSpec"] = "barm_spec_#_$";\r\n    AvatarPartType["BlegBase"] = "bleg_base_#_$";\r\n    AvatarPartType["BlegCost"] = "bleg_cost_#_$";\r\n    AvatarPartType["BlegSpec"] = "bleg_spec_#_$";\r\n    AvatarPartType["BodyBase"] = "body_base_#_$";\r\n    AvatarPartType["BodyCost"] = "body_cost_#_$";\r\n    AvatarPartType["BodyCostDres"] = "body_cost_#_$_dres";\r\n    AvatarPartType["BodySpec"] = "body_spec_#_$";\r\n    AvatarPartType["BodyTail"] = "body_tail_#_$";\r\n    AvatarPartType["BodyWing"] = "body_wing_#_$";\r\n    AvatarPartType["FarmBase"] = "farm_base_#_$";\r\n    AvatarPartType["FarmCost"] = "farm_cost_#_$";\r\n    AvatarPartType["FarmSpec"] = "farm_spec_#_$";\r\n    AvatarPartType["FlegBase"] = "fleg_base_#_$";\r\n    AvatarPartType["FlegCost"] = "fleg_cost_#_$";\r\n    AvatarPartType["FlegSpec"] = "fleg_spec_#_$";\r\n    AvatarPartType["HeadBase"] = "head_base_#_$";\r\n    AvatarPartType["HeadEyes"] = "head_eyes_#_$";\r\n    AvatarPartType["HeadHair"] = "head_hair_#_$";\r\n    AvatarPartType["HeadHairBack"] = "head_hair_#_$_back";\r\n    AvatarPartType["HeadHats"] = "head_hats_#_$";\r\n    AvatarPartType["HeadMask"] = "head_mask_#_$";\r\n    AvatarPartType["HeadMous"] = "head_mous_#_$";\r\n    AvatarPartType["HeadSpec"] = "head_spec_#_$";\r\n    AvatarPartType["ShldFarm"] = "shld_farm_#_$";\r\n    AvatarPartType["WeapFarm"] = "weap_farm_#_$";\r\n    AvatarPartType["ShldBarm"] = "shld_barm_#_$";\r\n    AvatarPartType["WeapBarm"] = "weap_barm_#_$";\r\n})(AvatarPartType || (AvatarPartType = {}));\r\n/**\r\n * 龙骨显示对象\r\n */\r\nvar DragonbonesDisplay = /** @class */ (function (_super) {\r\n    __extends(DragonbonesDisplay, _super);\r\n    // private mDragonBonesRenderTexture;\r\n    function DragonbonesDisplay(scene, roomService, element) {\r\n        var _this = _super.call(this, scene, roomService, element) || this;\r\n        _this.mAnimationName = "Armature";\r\n        _this.mDragonbonesName = "";\r\n        _this.mActionName = "";\r\n        _this.replaceArr = [];\r\n        _this.mLoadMap = new Map();\r\n        _this.mErrorLoadMap = new Map();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "spriteWidth", {\r\n        get: function () {\r\n            if (this.mArmatureDisplay) {\r\n                return this.mArmatureDisplay.width;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "spriteHeight", {\r\n        get: function () {\r\n            if (this.mArmatureDisplay) {\r\n                return this.mArmatureDisplay.height;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "GameObject", {\r\n        get: function () {\r\n            return this;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DragonbonesDisplay.prototype.changeAlpha = function (val) {\r\n        // this.alpha = val;\r\n    };\r\n    DragonbonesDisplay.prototype.load = function (display) {\r\n        this.mDisplayInfo = display;\r\n        this.mCollisionArea = [[1, 1], [1, 1]];\r\n        this.mOriginPoint = new Phaser.Geom.Point(1, 1);\r\n        if (!this.mDisplayInfo)\r\n            return;\r\n        this.dragonBonesName = this.dragonBonesName = "bones_human01"; // this.mDisplayInfo.avatar.id;\r\n        if (this.scene.cache.obj.has(this.dragonBonesName)) { }\r\n    };\r\n    DragonbonesDisplay.prototype.getDisplay = function () {\r\n        return this.mArmatureDisplay;\r\n    };\r\n    DragonbonesDisplay.prototype.play = function (val) {\r\n        var dir = this.mDisplayInfo !== undefined && this.mDisplayInfo.avatarDir ? this.mDisplayInfo.avatarDir : 3;\r\n        switch (dir) {\r\n            case 0:\r\n                dir = Math.random() * 1 > .5 ? 1 : 7;\r\n                break;\r\n            case 2:\r\n                dir = Math.random() * 1 > .5 ? 1 : 3;\r\n                break;\r\n            case 4:\r\n                dir = Math.random() * 1 > .5 ? 3 : 5;\r\n                break;\r\n            case 6:\r\n                dir = Math.random() * 1 > .5 ? 5 : 7;\r\n                break;\r\n        }\r\n        if (this.mActionName !== val || this.mPreDirection !== dir) {\r\n            var trunDir = "";\r\n            if (dir === 3 || dir === 5) {\r\n                this.setScaleStageX(-dir + 4);\r\n                trunDir = "_3";\r\n            }\r\n            else if (dir === 1 || dir === 7) {\r\n                this.setScaleStageX(-(1 / 3) * dir + (4 / 3));\r\n                trunDir = "_1";\r\n            }\r\n            this.mActionName = val + trunDir;\r\n            if (this.mArmatureDisplay) {\r\n                this.mArmatureDisplay.animation.play(this.mActionName);\r\n            }\r\n            this.mPreDirection = dir;\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.fadeIn = function (callback) {\r\n        this.clearFadeTween();\r\n        this.alpha = 0;\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 1,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.fadeOut = function (callback) {\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.destroy = function () {\r\n        this.mDisplayInfo = null;\r\n        if (this.mArmatureDisplay) {\r\n            this.mArmatureDisplay.dispose(true);\r\n            this.mArmatureDisplay = null;\r\n        }\r\n        if (this.mClickCon) {\r\n            this.mClickCon.destroy(true);\r\n            this.mClickCon = null;\r\n        }\r\n        if (this.mFadeTween) {\r\n            this.clearFadeTween();\r\n            this.mFadeTween = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DragonbonesDisplay.prototype.buildDragbones = function () {\r\n        if (this.scene.cache.custom.dragonbone.get(this.mDragonbonesName)) {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n        else {\r\n            var res = "./resources/dragonbones";\r\n            var pngUrl = res + "/" + this.mDragonbonesName + "_tex.png";\r\n            var jsonUrl = res + "/" + this.mDragonbonesName + "_tex.json";\r\n            var dbbinUrl = res + "/" + this.mDragonbonesName + "_ske.dbbin";\r\n            this.loadDragonBones(res, pngUrl, jsonUrl, dbbinUrl);\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.onLoadCompleteHandler = function (loader, totalComplete, totalFailed) {\r\n        if (!this.scene)\r\n            return;\r\n        if (this.mArmatureDisplay) {\r\n            this.mArmatureDisplay.dbClear();\r\n        }\r\n        this.mArmatureDisplay = this.scene.add.armature(this.mAnimationName, this.dragonBonesName);\r\n        this.mArmatureDisplay.visible = false;\r\n        this.add(this.mArmatureDisplay);\r\n        // ==========只有在创建龙骨时才会调用全部清除，显示通过后续通信做处理\r\n        this.clearArmatureSlot();\r\n        // ==========替换相应格位的display，服务端通信后可调用\r\n        this.getReplaceArr();\r\n        this.showReplaceArmatrue();\r\n        // this.play("idle");\r\n        this.mArmatureDisplay.x = this.baseLoc.x;\r\n        this.mArmatureDisplay.y = this.baseLoc.y;\r\n        var rect = new Phaser.Geom.Rectangle(0, 0, 50, 70);\r\n        if (!this.mClickCon) {\r\n            this.mClickCon = this.scene.make.container(undefined, false);\r\n            this.mClickCon.setInteractive(rect, Phaser.Geom.Rectangle.Contains);\r\n            this.mClickCon.x = -rect.width >> 1;\r\n            this.mClickCon.y = -rect.height;\r\n        }\r\n        this.setData("id", this.mDisplayInfo.id);\r\n        this.add(this.mClickCon);\r\n        this.emit("initialized");\r\n    };\r\n    DragonbonesDisplay.prototype.setScaleStage = function (val) {\r\n        if (this.mArmatureDisplay) {\r\n            this.mArmatureDisplay.scale = val;\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.setScaleStageX = function (val) {\r\n        if (this.mArmatureDisplay)\r\n            this.mArmatureDisplay.scaleX = val;\r\n    };\r\n    DragonbonesDisplay.prototype.loadDragonBones = function (resUrl, pngUrl, jsonUrl, dbbinUrl) {\r\n        this.scene.load.dragonbone(this.mDragonbonesName, pngUrl, jsonUrl, dbbinUrl, null, null, { responseType: "arraybuffer" });\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        this.scene.load.start();\r\n    };\r\n    DragonbonesDisplay.prototype.clearArmatureSlot = function () {\r\n        var slotList = this.mArmatureDisplay.armature.getSlots();\r\n        slotList.forEach(function (slot) {\r\n            if (slot)\r\n                slot.display.visible = false;\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.clearReplaceArmature = function () {\r\n        this.mArmatureDisplay.armature.animation.stop();\r\n        if (!this.replaceArr || this.replaceArr.length === 0) {\r\n            return;\r\n        }\r\n        var len = this.replaceArr.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var part = this.replaceArr[i].slot.replace("$", this.replaceArr[i].dir.toString());\r\n            var slot = this.mArmatureDisplay.armature.getSlot(part);\r\n            slot.replaceDisplay(null);\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.showReplaceArmatrue = function () {\r\n        for (var _i = 0, _a = this.replaceArr; _i < _a.length; _i++) {\r\n            var obj = _a[_i];\r\n            this.replacePartDisplay(obj.slot, obj.part, obj.dir, obj.skin);\r\n            // const part: string = obj.slot.replace("$", obj.dir.toString());\r\n            // Logger.log(part);\r\n        }\r\n        if (this.mLoadMap && this.mLoadMap.size > 0) {\r\n            this.startLoad();\r\n        }\r\n        else {\r\n            this.mArmatureDisplay.visible = true;\r\n        }\r\n        this.replaceArr.splice(0);\r\n    };\r\n    DragonbonesDisplay.prototype.getReplaceArr = function () {\r\n        this.replaceArr.length = 0;\r\n        var avater = this.mDisplayInfo.avatar;\r\n        if (avater.bodyBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyBase,\r\n                part: AvatarPartType.BodyBase,\r\n                dir: 3,\r\n                skin: avater.bodyBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyBase,\r\n                part: AvatarPartType.BodyBase,\r\n                dir: 1,\r\n                skin: avater.bodyBaseId,\r\n            });\r\n        }\r\n        if (avater.bodySpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodySpec,\r\n                part: AvatarPartType.BodySpec,\r\n                dir: 3,\r\n                skin: avater.bodySpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodySpec,\r\n                part: AvatarPartType.BodySpec,\r\n                dir: 1,\r\n                skin: avater.bodySpecId,\r\n            });\r\n        }\r\n        if (avater.bodyWingId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyWing,\r\n                part: AvatarPartType.BodyWing,\r\n                dir: 3,\r\n                skin: avater.bodyWingId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyWing,\r\n                part: AvatarPartType.BodyWing,\r\n                dir: 1,\r\n                skin: avater.bodyWingId,\r\n            });\r\n        }\r\n        if (avater.bodyTailId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyTail,\r\n                part: AvatarPartType.BodyTail,\r\n                dir: 3,\r\n                skin: avater.bodyTailId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyTail,\r\n                part: AvatarPartType.BodyTail,\r\n                dir: 1,\r\n                skin: avater.bodyTailId,\r\n            });\r\n        }\r\n        if (avater.bodyCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCost,\r\n                part: AvatarPartType.BodyCost,\r\n                dir: 3,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCost,\r\n                part: AvatarPartType.BodyCost,\r\n                dir: 1,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCostDres,\r\n                part: AvatarPartType.BodyCostDres,\r\n                dir: 3,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCostDres,\r\n                part: AvatarPartType.BodyCostDres,\r\n                dir: 1,\r\n                skin: avater.bodyCostId,\r\n            });\r\n        }\r\n        if (avater.farmBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmBase,\r\n                part: AvatarPartType.FarmBase,\r\n                dir: 3,\r\n                skin: avater.farmBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmBase,\r\n                part: AvatarPartType.FarmBase,\r\n                dir: 1,\r\n                skin: avater.farmBaseId,\r\n            });\r\n        }\r\n        if (avater.farmSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmSpec,\r\n                part: AvatarPartType.FarmSpec,\r\n                dir: 3,\r\n                skin: avater.farmSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmSpec,\r\n                part: AvatarPartType.FarmSpec,\r\n                dir: 1,\r\n                skin: avater.farmSpecId,\r\n            });\r\n        }\r\n        if (avater.farmCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmCost,\r\n                part: AvatarPartType.FarmCost,\r\n                dir: 3,\r\n                skin: avater.farmCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmCost,\r\n                part: AvatarPartType.FarmCost,\r\n                dir: 1,\r\n                skin: avater.farmCostId,\r\n            });\r\n        }\r\n        if (avater.barmBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmBase,\r\n                part: AvatarPartType.BarmBase,\r\n                dir: 3,\r\n                skin: avater.barmBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmBase,\r\n                part: AvatarPartType.BarmBase,\r\n                dir: 1,\r\n                skin: avater.barmBaseId,\r\n            });\r\n        }\r\n        if (avater.barmSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmSpec,\r\n                part: AvatarPartType.BarmSpec,\r\n                dir: 3,\r\n                skin: avater.barmSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmSpec,\r\n                part: AvatarPartType.BarmSpec,\r\n                dir: 1,\r\n                skin: avater.barmSpecId,\r\n            });\r\n        }\r\n        if (avater.barmCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmCost,\r\n                part: AvatarPartType.BarmCost,\r\n                dir: 3,\r\n                skin: avater.barmCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmCost,\r\n                part: AvatarPartType.BarmCost,\r\n                dir: 1,\r\n                skin: avater.barmCostId,\r\n            });\r\n        }\r\n        if (avater.blegBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegBase,\r\n                part: AvatarPartType.BlegBase,\r\n                dir: 3,\r\n                skin: avater.blegBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegBase,\r\n                part: AvatarPartType.BlegBase,\r\n                dir: 1,\r\n                skin: avater.blegBaseId,\r\n            });\r\n        }\r\n        if (avater.blegSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegSpec,\r\n                part: AvatarPartType.BlegSpec,\r\n                dir: 3,\r\n                skin: avater.blegSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegSpec,\r\n                part: AvatarPartType.BlegSpec,\r\n                dir: 1,\r\n                skin: avater.blegSpecId,\r\n            });\r\n        }\r\n        if (avater.blegCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegCost,\r\n                part: AvatarPartType.BlegCost,\r\n                dir: 3,\r\n                skin: avater.blegCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegCost,\r\n                part: AvatarPartType.BlegCost,\r\n                dir: 1,\r\n                skin: avater.blegCostId,\r\n            });\r\n        }\r\n        if (avater.flegBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegBase,\r\n                part: AvatarPartType.FlegBase,\r\n                dir: 3,\r\n                skin: avater.flegBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegBase,\r\n                part: AvatarPartType.FlegBase,\r\n                dir: 1,\r\n                skin: avater.flegBaseId,\r\n            });\r\n        }\r\n        if (avater.flegSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegSpec,\r\n                part: AvatarPartType.FlegSpec,\r\n                dir: 3,\r\n                skin: avater.flegSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegSpec,\r\n                part: AvatarPartType.FlegSpec,\r\n                dir: 1,\r\n                skin: avater.flegSpecId,\r\n            });\r\n        }\r\n        if (avater.flegCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegCost,\r\n                part: AvatarPartType.FlegCost,\r\n                dir: 3,\r\n                skin: avater.flegCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegCost,\r\n                part: AvatarPartType.FlegCost,\r\n                dir: 1,\r\n                skin: avater.flegCostId,\r\n            });\r\n        }\r\n        if (avater.headBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadBase,\r\n                part: AvatarPartType.HeadBase,\r\n                dir: 3,\r\n                skin: avater.headBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadBase,\r\n                part: AvatarPartType.HeadBase,\r\n                dir: 1,\r\n                skin: avater.headBaseId,\r\n            });\r\n        }\r\n        if (avater.barmWeapId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 3,\r\n                skin: avater.barmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 1,\r\n                skin: avater.barmWeapId,\r\n            });\r\n        }\r\n        if (avater.headHairId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHair,\r\n                part: AvatarPartType.HeadHair,\r\n                dir: 3,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHair,\r\n                part: AvatarPartType.HeadHair,\r\n                dir: 1,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHairBack,\r\n                part: AvatarPartType.HeadHairBack,\r\n                dir: 3,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHairBack,\r\n                part: AvatarPartType.HeadHairBack,\r\n                dir: 1,\r\n                skin: avater.headHairId,\r\n            });\r\n        }\r\n        if (avater.headHatsId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHats,\r\n                part: AvatarPartType.HeadHats,\r\n                dir: 3,\r\n                skin: avater.headHatsId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHats,\r\n                part: AvatarPartType.HeadHats,\r\n                dir: 1,\r\n                skin: avater.headHatsId,\r\n            });\r\n        }\r\n        if (avater.headSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadSpec,\r\n                part: AvatarPartType.HeadSpec,\r\n                dir: 3,\r\n                skin: avater.headSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadSpec,\r\n                part: AvatarPartType.HeadSpec,\r\n                dir: 1,\r\n                skin: avater.headSpecId,\r\n            });\r\n        }\r\n        if (avater.headEyesId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadEyes,\r\n                part: AvatarPartType.HeadEyes,\r\n                dir: 3,\r\n                skin: avater.headEyesId,\r\n            });\r\n        }\r\n        if (avater.headMousId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadMous,\r\n                part: AvatarPartType.HeadMous,\r\n                dir: 3,\r\n                skin: avater.headMousId,\r\n            });\r\n        }\r\n        if (avater.headMaskId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadMask,\r\n                part: AvatarPartType.HeadMask,\r\n                dir: 3,\r\n                skin: avater.headMaskId,\r\n            });\r\n        }\r\n        if (avater.farmShldId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldFarm,\r\n                part: AvatarPartType.ShldFarm,\r\n                dir: 3,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldFarm,\r\n                part: AvatarPartType.ShldFarm,\r\n                dir: 1,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldBarm,\r\n                part: AvatarPartType.ShldBarm,\r\n                dir: 3,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldBarm,\r\n                part: AvatarPartType.ShldBarm,\r\n                dir: 1,\r\n                skin: avater.farmShldId,\r\n            });\r\n        }\r\n        if (avater.farmWeapId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapFarm,\r\n                part: AvatarPartType.WeapFarm,\r\n                dir: 3,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapFarm,\r\n                part: AvatarPartType.WeapFarm,\r\n                dir: 1,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 3,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 1,\r\n                skin: avater.farmWeapId,\r\n            });\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.replacePartDisplay = function (soltName, soltPart, soltDir, skin) {\r\n        var part = soltName.replace("$", soltDir.toString());\r\n        var slot = this.mArmatureDisplay.armature.getSlot(part);\r\n        var key = soltPart.replace("#", skin.toString()).replace("$", soltDir.toString());\r\n        var dragonBonesTexture = this.scene.game.textures.get(this.mDragonbonesName);\r\n        if (this.scene.cache.custom.dragonbone.get(this.dragonBonesName)) {\r\n            var partName = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(key);\r\n            var frameName = "test resources/" + key;\r\n            if (this.mErrorLoadMap.get(partName))\r\n                return;\r\n            if (!this.scene.textures.exists(partName) && !dragonBonesTexture.frames[frameName]) {\r\n                // ==============新资源需从外部加载，之后要重新打图集\r\n                this.mLoadMap.set(slot.name, [slot.name, key]);\r\n            }\r\n            else {\r\n                //     // ==============贴图集上的资源 / 单个替换资源\r\n                var img = void 0;\r\n                if (dragonBonesTexture.frames[frameName]) { // && this.scene.game.textures.exists(this.mDisplayInfo.id + "")) {\r\n                    if (!this.scene.textures.exists(partName)) {\r\n                        this.mLoadMap.set(slot.name, [slot.name, key]);\r\n                        return;\r\n                    }\r\n                    img = new dragonBones.phaser.display.SlotImage(this.scene, slot.display.x, slot.display.y, partName);\r\n                }\r\n                else {\r\n                    img = new dragonBones.phaser.display.SlotImage(this.scene, slot.display.x, slot.display.y, partName);\r\n                }\r\n                slot.replaceDisplay(img);\r\n            }\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.startLoad = function () {\r\n        var _this = this;\r\n        var configList = [];\r\n        // ============只有check到新资源时才会重新load，否则直接从当前龙骨的贴图资源上，获取对应贴图\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, function (data, totalComplete, totalFailed) {\r\n            if (!configList || !_this.scene)\r\n                return;\r\n            var dragonBonesTexture = _this.scene.game.textures.get(_this.mDragonbonesName);\r\n            // if (!this.mDragonBonesRenderTexture) this.mDragonBonesRenderTexture = this.scene.add.renderTexture(0, 0, dragonBonesTexture.source[0].width, dragonBonesTexture.source[0].height);\r\n            var frames = dragonBonesTexture.getFrameNames();\r\n            // ==============有队列加载说明此处有新资源加载，在队列加载完成后，重新画一张龙骨的贴图并存入缓存中，下次渲染从缓存中获取贴图\r\n            _this.mLoadMap.forEach(function (load) {\r\n                // ==========load[0]slot名  load[1]part名\r\n                var slot = _this.mArmatureDisplay.armature.getSlot(load[0]);\r\n                // slot.display.visible = true;\r\n                var name = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(load[1]);\r\n                if (_this.scene.textures.exists(name) && !_this.mErrorLoadMap.get(name)) {\r\n                    var baseX = slot.display ? slot.display.x : 0;\r\n                    var baseY = slot.display ? slot.display.y : 0;\r\n                    var img = new dragonBones.phaser.display.SlotImage(_this.scene, baseX, baseY, name);\r\n                    if (img.texture.key === name) {\r\n                        slot.replaceDisplay(img);\r\n                    }\r\n                }\r\n            });\r\n            // for (let i: number = 0, len = frames.length; i < len; i++) {\r\n            //     // =============龙骨贴图资源frames里面的key "test resources/xxxxx"\r\n            //     const name = frames[i];\r\n            //     // =============龙骨part资源key 带图片资源名及方向\r\n            //     const key = name.split("/")[1].split("_");\r\n            //     const slotKey = key[0] + "_" + key[1] + "_" + key[3];\r\n            //     const slot: dragonBones.Slot = this.mArmatureDisplay.armature.getSlot(slotKey);\r\n            //     const dat = dragonBonesTexture.get(name);\r\n            //     const loadArr = this.mLoadMap.get(slotKey);\r\n            //     if (!this.mDragonBonesRenderTexture.frames) this.mDragonBonesRenderTexture.frames = {};\r\n            //     if (!loadArr) {\r\n            //         this.mDragonBonesRenderTexture.drawFrame(this.mDragonbonesName, name, dat.cutX, dat.cutY);\r\n            //         this.mDragonBonesRenderTexture.frames[dat.name] = dragonBonesTexture.frames[dat.name];\r\n            //     } else {\r\n            //         const drawTexture = this.scene.game.textures.get(loadArr[1] + "_png");\r\n            //         const drawFrame = drawTexture.frames[drawTexture.firstFrame];\r\n            //         drawFrame.centerX = dat.centerX;\r\n            //         drawFrame.centerY = dat.centerY;\r\n            //         drawFrame.cutWidth = dat.cutWidth;\r\n            //         drawFrame.cutHeight = dat.cutHeight;\r\n            //         drawFrame.cutX = dat.cutX;\r\n            //         drawFrame.cutY = dat.cutY;\r\n            //         drawFrame.data = (dat as any).data;\r\n            //         this.mDragonBonesRenderTexture.draw(loadArr[1] + "_png", dat.cutX, dat.cutY);\r\n            //         this.mDragonBonesRenderTexture.frames["test resources/" + loadArr[1]] = dragonBonesTexture.frames[dat.name];\r\n            //         if (!this.mDragonBonesRenderTexture.frames["test resources/" + loadArr[1]].name || this.mDragonBonesRenderTexture.frames["test resources/" + loadArr[1]].name !== name) {\r\n            //             this.mDragonBonesRenderTexture.frames["test resources/" + loadArr[1]].name = "test resources/" + loadArr[1];\r\n            //         }\r\n            //     }\r\n            // }\r\n            // this.mDragonBonesRenderTexture.saveTexture("bones_human01");\r\n            // const img = this.scene.make.image(undefined, false);\r\n            // img.setTexture("bones_human01");\r\n            // this.add(img);\r\n            // this.mDragonBonesRenderTexture.snapshotArea(0, 0, this.mDragonBonesRenderTexture.width, this.mDragonBonesRenderTexture.height, (image: Phaser.GameObjects.Image) => {\r\n            //     // this.mArmatureDisplay.armature.replacedTexture = this.mDragonBonesRenderTexture;\r\n            //     const sp = this.scene.make.container(undefined, false);\r\n            //     sp.add(image);\r\n            //     this.add(sp);\r\n            // });\r\n            // this.mArmatureDisplay.armature.replacedTexture = this.mDragonBonesRenderTexture;\r\n            // this.mArmatureDisplay.armature.invalidUpdate(null, true);\r\n            _this.mArmatureDisplay.visible = true;\r\n            _this.mLoadMap.clear();\r\n        }, this);\r\n        this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, function (e) {\r\n            // ==============为了防止404资源重复请求加载，在加载失败后直接将其索引放置加载失败列表中，并从加载map中删除\r\n            _this.mLoadMap.delete(e.key);\r\n            _this.mErrorLoadMap.set(e.key, e);\r\n        }, this);\r\n        this.mLoadMap.forEach(function (data) {\r\n            var nextLoad = data;\r\n            var partUrl = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartUrl(nextLoad[1]);\r\n            var partName = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(nextLoad[1]);\r\n            configList.push({ key: partName, url: partUrl });\r\n        });\r\n        this.scene.load.image(configList);\r\n        this.scene.load.start();\r\n    };\r\n    DragonbonesDisplay.prototype.clearFadeTween = function () {\r\n        if (this.mFadeTween) {\r\n            this.mFadeTween.stop();\r\n            this.mFadeTween.remove();\r\n        }\r\n    };\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "dragonBonesName", {\r\n        get: function () {\r\n            return this.mDragonbonesName;\r\n        },\r\n        set: function (val) {\r\n            // if (this.mDragonbonesName !== val) {\r\n            this.mDragonbonesName = val;\r\n            this.buildDragbones();\r\n            // }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DragonbonesDisplay;\r\n}(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/dragonbones.display.ts?')},"./src/rooms/display/dragonbones.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragonbonesModel", function() { return DragonbonesModel; });\nvar DragonbonesModel = /** @class */ (function () {\r\n    function DragonbonesModel(data) {\r\n        this.discriminator = "DragonbonesModel";\r\n        // this.id = id;\r\n        // this.avatar = avatar;\r\n        if (data) {\r\n            this.id = data.id;\r\n            this.avatar = data.avatar;\r\n        }\r\n    }\r\n    DragonbonesModel.prototype.setInfo = function (val) {\r\n        for (var key in val) {\r\n            if (val.hasOwnProperty(key)) {\r\n                this[key] = val[key];\r\n            }\r\n        }\r\n    };\r\n    DragonbonesModel.prototype.destroy = function () {\r\n    };\r\n    DragonbonesModel.prototype.getCollisionArea = function (aniName) {\r\n        return [[1, 1], [1, 1]];\r\n    };\r\n    DragonbonesModel.prototype.getWalkableArea = function () {\r\n        return [[1, 1], [1, 1]];\r\n    };\r\n    DragonbonesModel.prototype.getOriginPoint = function (aniName) {\r\n        return new Phaser.Geom.Point(1, 1);\r\n    };\r\n    return DragonbonesModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/dragonbones.model.ts?')},"./src/rooms/display/frames.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayField", function() { return DisplayField; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramesDisplay", function() { return FramesDisplay; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _display_object__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DisplayField;\r\n(function (DisplayField) {\r\n    DisplayField[DisplayField["BACKEND"] = 1] = "BACKEND";\r\n    DisplayField[DisplayField["STAGE"] = 2] = "STAGE";\r\n    DisplayField[DisplayField["FRONTEND"] = 3] = "FRONTEND";\r\n})(DisplayField || (DisplayField = {}));\r\n/**\r\n * 序列帧显示对象\r\n */\r\nvar FramesDisplay = /** @class */ (function (_super) {\r\n    __extends(FramesDisplay, _super);\r\n    function FramesDisplay() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.mDisplayDatas = new Map();\r\n        _this.mSprites = new Map();\r\n        _this.mHasAnimation = false;\r\n        return _this;\r\n    }\r\n    // private mAnimations: Map<DisplayField, Map<string, Phaser.Types.Animations.Animation>> = new Map<DisplayField, Map<string, Phaser.Types.Animations.Animation>>();\r\n    FramesDisplay.prototype.setPosition = function (x, y, z) {\r\n        _super.prototype.setPosition.call(this, x, y, z);\r\n        this.setDepth(this.x + this.baseLoc.x + this.y + this.baseLoc.y);\r\n        return this;\r\n    };\r\n    FramesDisplay.prototype.load = function (displayInfo, field) {\r\n        var _this = this;\r\n        field = !field ? DisplayField.STAGE : field;\r\n        var data = displayInfo;\r\n        if (!data || !data.gene)\r\n            return;\r\n        if (this.mSprites.get(field))\r\n            return;\r\n        this.mDisplayDatas.set(field, data);\r\n        if (this.scene.cache.obj.exists(data.gene)) {\r\n            this.onLoadCompleted(field);\r\n        }\r\n        else {\r\n            var display = data.display;\r\n            if (!display) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("display is undefined");\r\n            }\r\n            this.scene.load.atlas(data.gene, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].OSD_PATH + display.texturePath, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].OSD_PATH + display.dataPath);\r\n            // this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, (imageFile: ImageFile) => {\r\n            //     Logger.error(`Loading Error: key = ${imageFile} >> ${imageFile.url}`);\r\n            // }, this);\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, function () {\r\n                _this.onLoadCompleted(field);\r\n            }, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    FramesDisplay.prototype.play = function (animationName, field) {\r\n        if (!animationName)\r\n            return;\r\n        field = !field ? DisplayField.STAGE : field;\r\n        var data = this.mDisplayDatas.get(field);\r\n        var sprite = this.mSprites.get(field);\r\n        var ani = data.getAnimations(animationName);\r\n        if (!ani) {\r\n            return;\r\n        }\r\n        if (sprite && sprite instanceof Phaser.GameObjects.Sprite) {\r\n            if (ani.frameName.length > 1) {\r\n                sprite.play(data.gene + "_" + animationName);\r\n            }\r\n            else {\r\n                sprite.setTexture(data.gene, ani.frameName[0]);\r\n            }\r\n        }\r\n        else {\r\n            sprite.setTexture(data.gene, ani.frameName[0]);\r\n        }\r\n        this.initBaseLoc(field, animationName);\r\n    };\r\n    FramesDisplay.prototype.fadeIn = function (callback) {\r\n        if (this.mAlpha === 0) {\r\n            return;\r\n        }\r\n        this.alpha = 0;\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: this.mAlpha,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    FramesDisplay.prototype.fadeOut = function (callback) {\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    FramesDisplay.prototype.setInteractive = function (shape, callback, dropZone) {\r\n        _super.prototype.setInteractive.call(this, shape, callback, dropZone);\r\n        this.mSprites.forEach(function (sprite) {\r\n            sprite.setInteractive();\r\n        });\r\n        return this;\r\n    };\r\n    FramesDisplay.prototype.disableInteractive = function () {\r\n        _super.prototype.disableInteractive.call(this);\r\n        this.mSprites.forEach(function (sprite) {\r\n            sprite.disableInteractive();\r\n        });\r\n        return this;\r\n    };\r\n    FramesDisplay.prototype.destroy = function () {\r\n        this.mSprites.forEach(function (sprite) { return sprite.destroy(); });\r\n        this.mSprites.clear();\r\n        if (this.mFadeTween) {\r\n            this.clearFadeTween();\r\n            this.mFadeTween = undefined;\r\n        }\r\n        this.mDisplayDatas.clear();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FramesDisplay.prototype.clearFadeTween = function () {\r\n        if (this.mFadeTween) {\r\n            this.mFadeTween.stop();\r\n            this.mFadeTween.remove();\r\n        }\r\n    };\r\n    FramesDisplay.prototype.onLoadCompleted = function (field) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (!data) {\r\n            return;\r\n        }\r\n        if (this.scene.textures.exists(data.gene)) {\r\n            this.makeAnimations(field);\r\n            this.createDisplay(field);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.makeAnimations = function (field) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (!data)\r\n            return;\r\n        var animations = Array.from(data.animations.values());\r\n        for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {\r\n            var ani = animations_1[_i];\r\n            this.makeAnimation(field, ani);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.makeAnimation = function (field, animation) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (!animation || !data || !data.gene)\r\n            return;\r\n        if (animation.frameName.length <= 1)\r\n            return;\r\n        // Didn\'t find a good way to create an animation with frame names without a pattern.\r\n        var frames = [];\r\n        animation.frameName.forEach(function (frame) {\r\n            frames.push({ key: data.gene, frame: frame });\r\n        });\r\n        var key = data.gene + "_" + animation.name;\r\n        var config = {\r\n            key: key,\r\n            frames: frames,\r\n            frameRate: animation.frameRate,\r\n            repeat: animation.loop ? -1 : 0,\r\n        };\r\n        this.mHasAnimation = true;\r\n        this.scene.anims.create(config);\r\n    };\r\n    FramesDisplay.prototype.initBaseLoc = function (field, aniName) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        var sprite = this.mSprites.get(field);\r\n        if (!sprite || !data || !data.animations)\r\n            return;\r\n        var animations = data.getAnimations(aniName);\r\n        if (!animations)\r\n            return;\r\n        this.mBaseLoc = animations.baseLoc;\r\n        this.mCollisionArea = animations.collisionArea;\r\n        this.mOriginPoint = animations.originPoint;\r\n        sprite.x = this.baseLoc.x;\r\n        sprite.y = this.baseLoc.y;\r\n    };\r\n    FramesDisplay.prototype.createDisplay = function (field) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (!data || !data.gene)\r\n            return;\r\n        var sprite = this.mSprites.get(field);\r\n        // Create Sprite\r\n        if (!sprite) {\r\n            if (this.mHasAnimation) {\r\n                sprite = this.scene.make.sprite(undefined, false).setOrigin(0, 0);\r\n            }\r\n            else {\r\n                sprite = this.scene.make.image(undefined, false).setOrigin(0, 0);\r\n                sprite.setTexture(data.gene);\r\n            }\r\n            this.mSprites.set(field, sprite);\r\n            this.play(data.animationName, field);\r\n            sprite.x = this.baseLoc.x;\r\n            sprite.y = this.baseLoc.y;\r\n            this.addAt(sprite, field);\r\n        }\r\n        sprite.setInteractive({ pixelPerfect: true });\r\n        this.setData("id", data.id);\r\n        this.mSprites.set(field, sprite);\r\n        this.emit("initialized", this);\r\n    };\r\n    Object.defineProperty(FramesDisplay.prototype, "spriteWidth", {\r\n        get: function () {\r\n            var sprite = this.mSprites.get(DisplayField.STAGE);\r\n            if (sprite) {\r\n                return sprite.width;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FramesDisplay.prototype, "spriteHeight", {\r\n        get: function () {\r\n            var sprite = this.mSprites.get(DisplayField.STAGE);\r\n            if (sprite) {\r\n                return sprite.height;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FramesDisplay;\r\n}(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/frames.display.ts?')},"./src/rooms/display/frames.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramesModel", function() { return FramesModel; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var simple_sha1__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! simple-sha1 */ "./node_modules/simple-sha1/browser.js");\n/* harmony import */ var simple_sha1__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(simple_sha1__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\nvar FramesModel = /** @class */ (function () {\r\n    function FramesModel(data) {\r\n        this.discriminator = "FramesModel";\r\n        // TODO 定义IElement接口\r\n        this.id = data.id || 0;\r\n        this.type = data.sn || "";\r\n        var anis = data.animations;\r\n        if (anis) {\r\n            this.animationName = anis.defaultAnimationName;\r\n            this.setDisplay(anis.display);\r\n            this.setAnimationData(anis.animationData);\r\n        }\r\n    }\r\n    FramesModel.prototype.setInfo = function (val) {\r\n        for (var key in val) {\r\n            if (val.hasOwnProperty(key)) {\r\n                this[key] = val[key];\r\n            }\r\n        }\r\n    };\r\n    FramesModel.prototype.getAnimationData = function () {\r\n        return this.animations;\r\n    };\r\n    FramesModel.prototype.getAnimations = function (name) {\r\n        if (!this.animations)\r\n            return;\r\n        return this.animations.get(name);\r\n    };\r\n    FramesModel.prototype.destroy = function () {\r\n        if (this.animations)\r\n            this.animations.clear();\r\n    };\r\n    Object.defineProperty(FramesModel.prototype, "gene", {\r\n        get: function () {\r\n            return this.mGen;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FramesModel.prototype.toClient = function () {\r\n        var anis = [];\r\n        this.animations.forEach(function (ani) {\r\n            anis.push(ani.toClient());\r\n        }, this);\r\n        return anis;\r\n    };\r\n    FramesModel.prototype.getCollisionArea = function (aniName) {\r\n        var ani = this.getAnimations(aniName);\r\n        if (ani) {\r\n            return ani.collisionArea;\r\n        }\r\n    };\r\n    FramesModel.prototype.getWalkableArea = function (aniName) {\r\n        var ani = this.getAnimations(aniName);\r\n        if (ani) {\r\n            return ani.walkableArea;\r\n        }\r\n    };\r\n    FramesModel.prototype.getOriginPoint = function (aniName) {\r\n        var ani = this.getAnimations(aniName);\r\n        if (ani) {\r\n            return ani.originPoint;\r\n        }\r\n    };\r\n    FramesModel.prototype.getDirable = function () {\r\n    };\r\n    FramesModel.prototype.setDisplay = function (display) {\r\n        if (!display) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(this.type + " display does not exist");\r\n            return;\r\n        }\r\n        this.display = {\r\n            dataPath: display.dataPath,\r\n            texturePath: display.texturePath\r\n        };\r\n        this.mGen = simple_sha1__WEBPACK_IMPORTED_MODULE_1__["sync"](display.dataPath + display.texturePath);\r\n    };\r\n    FramesModel.prototype.setAnimationData = function (aniDatas) {\r\n        if (!aniDatas) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(this.id + " animationData does not exist");\r\n            return;\r\n        }\r\n        this.animations = new Map();\r\n        // let ani: IAnimationData;\r\n        for (var _i = 0, aniDatas_1 = aniDatas; _i < aniDatas_1.length; _i++) {\r\n            var aniData = aniDatas_1[_i];\r\n            // const baseLoc = aniData.baseLoc;\r\n            // ani = {\r\n            //     name: aniData.name,\r\n            //     frameName: aniData.frameName,\r\n            //     frameRate: aniData.frameRate,\r\n            //     loop: aniData.loop,\r\n            //     baseLoc: new Phaser.Geom.Point(baseLoc.x, baseLoc.y),\r\n            //     // walkableArea: aniData.walkableArea || [],\r\n            //     collisionArea: aniData.collisionArea || [],\r\n            //     originPoint: aniData.originPoint\r\n            // };\r\n            this.animations.set(aniData.name, aniData);\r\n        }\r\n    };\r\n    return FramesModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/frames.model.ts?')},"./src/rooms/display/terrain.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainDisplay", function() { return TerrainDisplay; });\n/* harmony import */ var _frames_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./frames.display */ "./src/rooms/display/frames.display.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar TerrainDisplay = /** @class */ (function (_super) {\r\n    __extends(TerrainDisplay, _super);\r\n    function TerrainDisplay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    // public fadeIn(callback?: () => void) {\r\n    //     // this.y += 50;\r\n    //     this.alpha = 0;\r\n    //     if (this.mFadeTween) {\r\n    //         this.mFadeTween.stop();\r\n    //         this.mFadeTween.remove();\r\n    //     }\r\n    //     this.mFadeTween = this.scene.tweens.add({\r\n    //         targets: this,\r\n    //         alpha: 1,\r\n    //         // y: this.y + 50,\r\n    //         duration: 1200,\r\n    //         onComplete: () => {\r\n    //             if (callback) callback();\r\n    //         }\r\n    //     });\r\n    // }\r\n    //\r\n    // public fadeOut(callback?: () => void) {\r\n    //     if (this.mFadeTween) {\r\n    //         this.mFadeTween.stop();\r\n    //         this.mFadeTween.remove();\r\n    //     }\r\n    //     this.mFadeTween = this.scene.tweens.add({\r\n    //         targets: this,\r\n    //         alpha: 0,\r\n    //         // y: this.y + 50,\r\n    //         duration: 1200,\r\n    //         onComplete: () => {\r\n    //             if (callback) callback();\r\n    //         }\r\n    //     });\r\n    // }\r\n    TerrainDisplay.prototype.showRefernceArea = function () {\r\n    };\r\n    return TerrainDisplay;\r\n}(_frames_display__WEBPACK_IMPORTED_MODULE_0__["FramesDisplay"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/terrain.display.ts?')},"./src/rooms/editor.room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorRoom", function() { return EditorRoom; });\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _const_brush__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../const/brush */ "./src/const/brush.ts");\n/* harmony import */ var _room__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./room */ "./src/rooms/room.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cameras/viewblock.manager */ "./src/rooms/cameras/viewblock.manager.ts");\n/* harmony import */ var _scenes_edit__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../scenes/edit */ "./src/scenes/edit.ts");\n/* harmony import */ var _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./editor/mouse.follow */ "./src/rooms/editor/mouse.follow.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _editor_selected_element__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./editor/selected.element */ "./src/rooms/editor/selected.element.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _element_editor_element_manager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./element/editor.element.manager */ "./src/rooms/element/editor.element.manager.ts");\n/* harmony import */ var _terrain_editor_terrain_manager__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./terrain/editor.terrain.manager */ "./src/rooms/terrain/editor.terrain.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditorRoom = /** @class */ (function (_super) {\r\n    __extends(EditorRoom, _super);\r\n    function EditorRoom(manager) {\r\n        var _this = _super.call(this, manager) || this;\r\n        _this.mBrush = new _const_brush__WEBPACK_IMPORTED_MODULE_4__["Brush"](_this);\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SET_EDITOR_MODE, _this.onSetEditorModeHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_ALIGN_GRID, _this.onAlignGridHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_VISIBLE_GRID, _this.onVisibleGridHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_FOLLOW, _this.onMouseFollowHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_SELECTED_SPRITE, _this.onMouseFollowHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_FETCH_SPRITE, _this.onFetchSpriteHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorRoom.prototype.enter = function (data) {\r\n        if (!data) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("wrong room");\r\n            return;\r\n        }\r\n        this.mID = data.id;\r\n        var rows = data.rows, cols = data.cols, tileWidth = data.tileWidth, tileHeight = data.tileHeight;\r\n        this.mSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        rows *= 2;\r\n        cols *= 2;\r\n        tileWidth /= 2;\r\n        tileHeight /= 2;\r\n        this.mNimiSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        this.mTerainManager = new _terrain_editor_terrain_manager__WEBPACK_IMPORTED_MODULE_15__["EditorTerrainManager"](this);\r\n        this.mElementManager = new _element_editor_element_manager__WEBPACK_IMPORTED_MODULE_14__["EditorElementManager"](this);\r\n        this.mBlocks = new _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_7__["ViewblockManager"](this.mCameraService);\r\n        this.mWorld.game.scene.start(_scenes_edit__WEBPACK_IMPORTED_MODULE_8__["EditScene"].name, { room: this });\r\n    };\r\n    EditorRoom.prototype.startPlay = function () {\r\n        this.mScene = this.mWorld.game.scene.getScene(_scenes_edit__WEBPACK_IMPORTED_MODULE_8__["EditScene"].name);\r\n        this.mLayManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_6__["LayerManager"](this);\r\n        this.mLayManager.drawGrid(this);\r\n        this.mScene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.on("gameobjectdown", this.onGameobjectUpHandler, this);\r\n        this.mCameraService.camera = this.scene.cameras.main;\r\n        var mainCameras = this.mScene.cameras.main;\r\n        mainCameras.setBounds(-200, -200, this.mSize.sceneWidth + 400, this.mSize.sceneHeight + 400);\r\n        this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        this.mCameraService.centerCameas();\r\n        // setTimeout(() => {\r\n        //     this.mCameraService.syncToEditor();\r\n        // }, 10);\r\n        this.mScene.input.keyboard.on("keydown", this.onKeyDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.destroy = function () {\r\n        if (this.mWorld && this.mWorld.connection) {\r\n            this.mWorld.connection.removePacketListener(this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    EditorRoom.prototype.update = function (time, delta) {\r\n        if (this.layerManager)\r\n            this.layerManager.update(time, delta);\r\n        if (this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect.update();\r\n        }\r\n    };\r\n    EditorRoom.prototype.transformToMini90 = function (p) {\r\n        if (!this.mNimiSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_0__["Position45"].transformTo90(p, this.mNimiSize);\r\n    };\r\n    EditorRoom.prototype.transformToMini45 = function (p) {\r\n        if (!this.mNimiSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_0__["Position45"].transformTo45(p, this.mNimiSize);\r\n    };\r\n    EditorRoom.prototype.removeSelected = function () {\r\n        if (this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect.remove();\r\n        }\r\n    };\r\n    EditorRoom.prototype.moveCameras = function (pointer) {\r\n        this.cameraService.offsetScroll(pointer.prevPosition.x - pointer.position.x, pointer.prevPosition.y - pointer.position.y);\r\n    };\r\n    EditorRoom.prototype.createElement = function () {\r\n        if (!this.mMouseFollow.sprite) {\r\n            return;\r\n        }\r\n        var elementManager = this.mMouseFollow.elementManager;\r\n        if (elementManager) {\r\n            var sprites = this.mMouseFollow.createSprites();\r\n            if (sprites) {\r\n                elementManager.add(sprites);\r\n            }\r\n        }\r\n    };\r\n    EditorRoom.prototype.eraserElement = function () {\r\n        var terrainManager = this.mTerainManager;\r\n        if (terrainManager) {\r\n            var positions = this.mMouseFollow.getEaserPosition();\r\n            terrainManager.removeFormPositions(positions);\r\n        }\r\n    };\r\n    EditorRoom.prototype.onSetEditorModeHandler = function (packet) {\r\n        var mode = packet.content;\r\n        this.mBrush.mode = mode.mode;\r\n        if (this.mMouseFollow)\r\n            this.mMouseFollow.destroy();\r\n        if (this.mBrush.mode !== _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT) {\r\n            if (this.mSelectedElementEffect) {\r\n                this.mSelectedElementEffect.destroy();\r\n                this.mSelectedElementEffect = null;\r\n            }\r\n        }\r\n        if (this.mBrush.mode === _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER) {\r\n            if (!this.mMouseFollow) {\r\n                this.mMouseFollow = new _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_9__["MouseFollow"](this.mScene, this);\r\n            }\r\n            this.mMouseFollow.showEraserArea();\r\n        }\r\n        this.layerManager.setSurfaceInteractive(this.mBrush.mode !== _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER);\r\n    };\r\n    EditorRoom.prototype.onAlignGridHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.mouseFollow.alignGrid = content.align;\r\n    };\r\n    EditorRoom.prototype.onVisibleGridHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.layerManager.setGridVisible(content.visible);\r\n    };\r\n    EditorRoom.prototype.onMouseFollowHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (this.mScene) {\r\n            this.mouseFollow.setDisplay(content);\r\n        }\r\n    };\r\n    EditorRoom.prototype.onFetchSpriteHandler = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.ids;\r\n        if (ids.length > 0) {\r\n            var ele = this.elementManager.get(ids[0]);\r\n            if (ele) {\r\n                this.selectedElement(ele.getDisplay());\r\n            }\r\n        }\r\n    };\r\n    EditorRoom.prototype.addPointerMoveHandler = function () {\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("gameout", this.onGameOutHandler, this);\r\n    };\r\n    EditorRoom.prototype.removePointerMoveHandler = function () {\r\n        this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.off("gameout", this.onGameOutHandler, this);\r\n    };\r\n    EditorRoom.prototype.onPointerDownHandler = function () {\r\n        this.addPointerMoveHandler();\r\n    };\r\n    EditorRoom.prototype.onPointerUpHandler = function (pointer) {\r\n        this.removePointerMoveHandler();\r\n        switch (this.brush.mode) {\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].BRUSH:\r\n                this.createElement();\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT:\r\n                if (this.mSelectedElementEffect && this.mSelectedElementEffect.selecting) {\r\n                    if (pointer.downX !== pointer.upX && pointer.downY !== pointer.upY) {\r\n                        this.syncSprite(this.mSelectedElementEffect.display);\r\n                    }\r\n                    this.mSelectedElementEffect.selecting = false;\r\n                }\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER:\r\n                this.eraserElement();\r\n                break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.sendFetch = function (ids, nodetype) {\r\n        if (!this.mSelectedElementEffect || !this.mSelectedElementEffect.display) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_FETCH_SPRITE);\r\n        var content = pkt.content;\r\n        content.ids = ids;\r\n        content.nodeType = nodetype;\r\n        this.connection.send(pkt);\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("fetch sprite", content);\r\n    };\r\n    EditorRoom.prototype.onGameobjectUpHandler = function (pointer, gameobject) {\r\n        this.removePointerMoveHandler();\r\n        var com = gameobject.parentContainer;\r\n        if (!com) {\r\n            return;\r\n        }\r\n        switch (this.mBrush.mode) {\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT:\r\n                var selected = this.selectedElement(com);\r\n                if (selected) {\r\n                    this.sendFetch([selected.element.id], pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.onGameOutHandler = function () {\r\n        this.removePointerMoveHandler();\r\n    };\r\n    EditorRoom.prototype.selectedElement = function (com) {\r\n        if (!(com instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_12__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        if (com instanceof _display_terrain_display__WEBPACK_IMPORTED_MODULE_10__["TerrainDisplay"]) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect = new _editor_selected_element__WEBPACK_IMPORTED_MODULE_11__["SelectedElement"](this.mScene, this.layerManager);\r\n        }\r\n        this.mSelectedElementEffect.setElement(com);\r\n        return com;\r\n    };\r\n    EditorRoom.prototype.syncSprite = function (object) {\r\n        if (!object)\r\n            return;\r\n        var ele = object.element;\r\n        if (!ele || !ele.model)\r\n            return;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_SPRITE);\r\n        var content = pkt.content;\r\n        content.sprites = [ele.model.toSprite()];\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorRoom.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (!this.mScene.cameras) {\r\n            return;\r\n        }\r\n        switch (this.mBrush.mode) {\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].BRUSH:\r\n                if (this.mMouseFollow.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n                    this.createElement();\r\n                }\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].MOVE:\r\n                this.moveCameras(pointer);\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT:\r\n                if (!this.mSelectedElementEffect) {\r\n                    return;\r\n                }\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("selecting: ", this.mSelectedElementEffect.selecting);\r\n                if (!this.mSelectedElementEffect.selecting) {\r\n                    return;\r\n                }\r\n                if (!this.mouseFollow) {\r\n                    return;\r\n                }\r\n                var pos = this.mMouseFollow.transitionGrid(pointer.worldX, pointer.worldY);\r\n                if (pos) {\r\n                    this.mSelectedElementEffect.setDisplayPos(pos.x, pos.y);\r\n                    this.mLayManager.depthSurfaceDirty = true;\r\n                }\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER:\r\n                this.eraserElement();\r\n                break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.onKeyDownHandler = function (event) {\r\n        if (!this.mSelectedElementEffect) {\r\n            return;\r\n        }\r\n        switch (event.keyCode) {\r\n            case 37:\r\n            case 38:\r\n            case 39:\r\n            case 40:\r\n                this.moveElement(event.keyCode);\r\n                break;\r\n            // case 46:\r\n            // this.removeDisplay(this.mSelectedElementEffect.display);\r\n            // break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.moveElement = function (keyCode) {\r\n        var display = this.mSelectedElementEffect.display;\r\n        if (!display) {\r\n            return;\r\n        }\r\n        var pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_13__["Pos"](display.x, display.y, display.z);\r\n        switch (keyCode) {\r\n            case 37:\r\n                pos.x--;\r\n                break;\r\n            case 38:\r\n                pos.y--;\r\n                break;\r\n            case 39:\r\n                pos.x++;\r\n                break;\r\n            case 40:\r\n                pos.y++;\r\n                break;\r\n        }\r\n        display.setPosition(pos.x, pos.y, pos.z);\r\n        // TOOD 通过统一接口设置depth\r\n        this.layerManager.depthSurfaceDirty = true;\r\n    };\r\n    Object.defineProperty(EditorRoom.prototype, "brush", {\r\n        get: function () {\r\n            return this.mBrush;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EditorRoom.prototype, "miniSize", {\r\n        get: function () {\r\n            return this.mNimiSize;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EditorRoom.prototype, "mouseFollow", {\r\n        get: function () {\r\n            if (!this.mMouseFollow) {\r\n                this.mMouseFollow = new _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_9__["MouseFollow"](this.mScene, this);\r\n            }\r\n            return this.mMouseFollow;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    EditorRoom.prototype.removeDisplay = function (display) {\r\n        if (!display) {\r\n            return;\r\n        }\r\n        if (!display.element) {\r\n            return;\r\n        }\r\n        var ele = this.mElementManager.removeEditor(display.element.id);\r\n        if (ele) {\r\n            this.removeSelected();\r\n        }\r\n    };\r\n    return EditorRoom;\r\n}(_room__WEBPACK_IMPORTED_MODULE_5__["Room"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor.room.ts?')},"./src/rooms/editor/mouse.follow.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseFollow", function() { return MouseFollow; });\n/* harmony import */ var _display_frames_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\n\r\n\r\n\r\nvar MouseFollow = /** @class */ (function () {\r\n    function MouseFollow(mScene, mRoomService) {\r\n        this.mScene = mScene;\r\n        this.mRoomService = mRoomService;\r\n        /**\r\n         * 笔触大小\r\n         */\r\n        this.mSize = 1;\r\n        this.mLayerManager = this.mRoomService.layerManager;\r\n    }\r\n    MouseFollow.prototype.setDisplay = function (content) {\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        this.mNodeType = content.nodeType;\r\n        this.mSprite = new _element_sprite__WEBPACK_IMPORTED_MODULE_2__["Sprite"](content.sprite, content.nodeType);\r\n        this.mDisplay = new MouseDisplayContainer(this.mScene, this.mRoomService);\r\n        var size = this.mNodeType === NodeType.TerrainNodeType ? this.mSize : 1;\r\n        this.mDisplay.setDisplay(this.mSprite, size);\r\n        this.mLayerManager.addToSceneToUI(this.mDisplay);\r\n        if (this.mNodeType === NodeType.TerrainNodeType) {\r\n            this.mElementManager = this.mRoomService.terrainManager;\r\n        }\r\n        else if (this.mNodeType === NodeType.ElementNodeType || this.mNodeType === NodeType.SpawnPointType) {\r\n            this.mElementManager = this.mRoomService.elementManager;\r\n        }\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("wheel", this.onWheelHandler, this);\r\n    };\r\n    MouseFollow.prototype.showEraserArea = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n        }\r\n        this.mDisplay = new EraserArea(this.mScene, this.mRoomService);\r\n        this.mDisplay.setDisplay(null, this.mSize);\r\n        this.mNodeType = NodeType.TerrainNodeType;\r\n        this.mLayerManager.addToSceneToUI(this.mDisplay);\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("wheel", this.onWheelHandler, this);\r\n    };\r\n    MouseFollow.prototype.createSprites = function () {\r\n        if (!this.mSprite) {\r\n            return;\r\n        }\r\n        var result = [];\r\n        var sprite = null;\r\n        var displays = this.mDisplay.displays;\r\n        for (var _i = 0, displays_1 = displays; _i < displays_1.length; _i++) {\r\n            var display = displays_1[_i];\r\n            // deep clone\r\n            sprite = Object.assign(Object.create(Object.getPrototypeOf(this.mSprite)), this.mSprite);\r\n            sprite.newID();\r\n            sprite.pos = this.getPosition(display.x, display.y);\r\n            sprite.bindID = this.mSprite.id;\r\n            sprite.sn = this.mSprite.sn;\r\n            // sprite.nodeType = this.mSprite.node\r\n            result.push(sprite);\r\n        }\r\n        return result;\r\n    };\r\n    MouseFollow.prototype.getEaserPosition = function () {\r\n        var result = [];\r\n        if (!this.display) {\r\n            return;\r\n        }\r\n        var pos = null;\r\n        for (var i = 0; i < this.mSize; i++) {\r\n            for (var j = 0; j < this.mSize; j++) {\r\n                pos = this.display.transformTo90(i, j);\r\n                result.push(this.getPosition(pos.x, pos.y));\r\n                // result.push(this.mRoomService.transformTo45(new Pos(i, j)));\r\n            }\r\n        }\r\n        // result.push(this.getPosition());\r\n        return result;\r\n    };\r\n    MouseFollow.prototype.transitionGrid = function (x, y) {\r\n        var source = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y);\r\n        var pos = this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType\r\n            ? this.mRoomService.transformTo45(source)\r\n            : this.mRoomService.transformToMini45(source);\r\n        if (this.mAlignGrid === false) {\r\n            return this.checkBound(pos, source);\r\n        }\r\n        return this.checkBound(pos);\r\n    };\r\n    /**\r\n     * 边界检查\r\n     * @param pos 45度坐标，\r\n     * @param source 没有超出边界并不贴边就返回原始坐标\r\n     */\r\n    MouseFollow.prototype.checkBound = function (pos, source) {\r\n        var bound = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](pos.x, pos.y);\r\n        var size = this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType\r\n            ? this.mRoomService.roomSize\r\n            : this.mRoomService.miniSize;\r\n        if (pos.x < 0) {\r\n            bound.x = 0;\r\n        }\r\n        else if (pos.x > size.cols) {\r\n            bound.x = size.cols;\r\n        }\r\n        if (pos.y < 0) {\r\n            bound.y = 0;\r\n        }\r\n        else if (pos.y > size.rows) {\r\n            bound.y = size.rows;\r\n        }\r\n        if (bound.equal(pos) && source) {\r\n            return source;\r\n        }\r\n        if (this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return this.mRoomService.transformTo90(bound);\r\n        }\r\n        return this.mRoomService.transformToMini90(bound);\r\n    };\r\n    MouseFollow.prototype.destroy = function () {\r\n        if (this.mScene) {\r\n            this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n            this.mScene.input.off("wheel", this.onWheelHandler, this);\r\n        }\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        this.mNodeType = NodeType.UnknownNodeType;\r\n    };\r\n    MouseFollow.prototype.onPointerMoveHandler = function (pointer) {\r\n        this.updatePos(pointer.worldX, pointer.worldY);\r\n    };\r\n    MouseFollow.prototype.getPosition = function (rows, cols) {\r\n        if (rows === void 0) { rows = 0; }\r\n        if (cols === void 0) { cols = 0; }\r\n        if (this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            var pos45 = this.mRoomService.transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x + rows, this.mDisplay.y + cols));\r\n            return pos45;\r\n        }\r\n        // TODO 多个物件仅支持地块\r\n        var pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x + rows, this.mDisplay.y + cols, this.mDisplay.z);\r\n        return pos;\r\n    };\r\n    MouseFollow.prototype.onWheelHandler = function (pointer) {\r\n        if (this.mNodeType !== NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        if (pointer.deltaY < 0) {\r\n            this.size--;\r\n        }\r\n        else {\r\n            this.size++;\r\n        }\r\n        this.updatePos(pointer.worldX, pointer.worldY);\r\n    };\r\n    MouseFollow.prototype.updatePos = function (worldX, worldY) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var pos = this.transitionGrid(worldX, worldY);\r\n        if (!pos) {\r\n            return;\r\n        }\r\n        this.mDisplay.setLocation(pos.x, pos.y);\r\n    };\r\n    Object.defineProperty(MouseFollow.prototype, "alignGrid", {\r\n        set: function (val) {\r\n            this.mAlignGrid = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "sprite", {\r\n        get: function () {\r\n            return this.mSprite;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "nodeType", {\r\n        get: function () {\r\n            return this.mNodeType;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "size", {\r\n        get: function () {\r\n            return this.mSize;\r\n        },\r\n        set: function (val) {\r\n            if (val < 1) {\r\n                val = 1;\r\n            }\r\n            if (val > 10) {\r\n                val = 10;\r\n            }\r\n            this.mSize = val;\r\n            this.mDisplay.setDisplay(this.mSprite, this.mSize);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MouseFollow;\r\n}());\r\n\r\nvar MouseDisplayContainer = /** @class */ (function (_super) {\r\n    __extends(MouseDisplayContainer, _super);\r\n    function MouseDisplayContainer(scene, mRoomService) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.mOffset = new Phaser.Geom.Point();\r\n        return _this;\r\n    }\r\n    MouseDisplayContainer.prototype.setDisplay = function (sprite, size) {\r\n        this.clear();\r\n        this.mDisplay = [];\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        var frame = sprite.displayInfo;\r\n        this.mNodeType = sprite.nodeType;\r\n        var frameDisplay;\r\n        var _a = this.mRoomService.roomSize, tileWidth = _a.tileWidth, tileHeight = _a.tileHeight;\r\n        this.mTileSize = {\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            rows: size,\r\n            cols: size,\r\n            sceneWidth: (size + size) * (tileWidth / 2),\r\n            sceneHeight: (size + size) * (tileHeight / 2)\r\n        };\r\n        this.mOffset.x = -(this.mTileSize.sceneWidth / 2);\r\n        this.mOffset.y = -((this.mTileSize.sceneHeight - (size % 2 === 0 ? 0 : tileHeight)) / 2);\r\n        for (var i = 0; i < size; i++) {\r\n            for (var j = 0; j < size; j++) {\r\n                frameDisplay = new _display_frames_display__WEBPACK_IMPORTED_MODULE_0__["FramesDisplay"](this.scene, this.mRoomService);\r\n                frameDisplay.setAlpha(0.8);\r\n                frameDisplay.once("initialized", this.onInitializedHandler, this);\r\n                frameDisplay.load(frame);\r\n                var pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](i, j), this.mTileSize);\r\n                frameDisplay.x = pos.x;\r\n                frameDisplay.y = pos.y;\r\n                this.add(frameDisplay);\r\n                this.mDisplay.push(frameDisplay);\r\n            }\r\n        }\r\n    };\r\n    MouseDisplayContainer.prototype.transformTo90 = function (row, col) {\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](row, col), this.mTileSize);\r\n    };\r\n    MouseDisplayContainer.prototype.transformTo45 = function (x, y) {\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y), this.mTileSize);\r\n    };\r\n    MouseDisplayContainer.prototype.setLocation = function (x, y) {\r\n        // return super.setPosition(x + this.mOffset.x, y + this.mOffset.y);\r\n        this.x = x + this.mOffset.x;\r\n        this.y = y + this.mOffset.y;\r\n        return this;\r\n    };\r\n    MouseDisplayContainer.prototype.clear = function () {\r\n        this.removeAll(true);\r\n        this.mDisplay = undefined;\r\n    };\r\n    MouseDisplayContainer.prototype.destroy = function (fromScene) {\r\n        this.clear();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "displays", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "tileWidth", {\r\n        get: function () {\r\n            var tmp = this.mTileSize.tileHeight;\r\n            if (this.mTileSize.rows % 2 === 0) {\r\n                tmp = 0;\r\n            }\r\n            return this.mTileSize.sceneWidth - tmp;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "tileHeight", {\r\n        get: function () {\r\n            return this.mTileSize.sceneHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MouseDisplayContainer.prototype.onInitializedHandler = function (obj) {\r\n        if (obj) {\r\n            if (this.mNodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n                obj.showRefernceArea();\r\n            }\r\n        }\r\n    };\r\n    return MouseDisplayContainer;\r\n}(Phaser.GameObjects.Container));\r\nvar EraserArea = /** @class */ (function (_super) {\r\n    __extends(EraserArea, _super);\r\n    function EraserArea(scene, roomService) {\r\n        return _super.call(this, scene, roomService) || this;\r\n    }\r\n    EraserArea.prototype.setDisplay = function (frame, size) {\r\n        if (this.area) {\r\n            this.area.clear();\r\n        }\r\n        var _a = this.mRoomService.roomSize, tileWidth = _a.tileWidth, tileHeight = _a.tileHeight;\r\n        this.mTileSize = {\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            rows: size,\r\n            cols: size,\r\n            sceneWidth: (size + size) * (tileWidth / 2),\r\n            sceneHeight: (size + size) * (tileHeight / 2)\r\n        };\r\n        this.mOffset.x = -(this.mTileSize.sceneWidth / 2);\r\n        this.mOffset.y = -((this.mTileSize.sceneHeight - (size % 2 === 0 ? 0 : tileHeight)) / 2);\r\n        var p1;\r\n        var p2;\r\n        var p3;\r\n        var p4;\r\n        this.area = this.scene.make.graphics(undefined, false);\r\n        for (var y = 0; y < size; y++) {\r\n            for (var x = 0; x < size; x++) {\r\n                this.area.lineStyle(2, 0);\r\n                p1 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y), this.mTileSize);\r\n                p2 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x + 1, y), this.mTileSize);\r\n                p3 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x + 1, y + 1), this.mTileSize);\r\n                p4 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y + 1), this.mTileSize);\r\n                this.area.beginPath();\r\n                this.area.fillStyle(0, 0.5);\r\n                this.area.strokePoints([p1.toPoint(), p2.toPoint(), p3.toPoint(), p4.toPoint()], true, true);\r\n                this.area.fillPath();\r\n            }\r\n        }\r\n        this.add(this.area);\r\n    };\r\n    return EraserArea;\r\n}(MouseDisplayContainer));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/mouse.follow.ts?')},"./src/rooms/editor/reference.area.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReferenceArea", function() { return ReferenceArea; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ReferenceArea = /** @class */ (function (_super) {\r\n    __extends(ReferenceArea, _super);\r\n    function ReferenceArea(scene, mRoomService) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mRoomService = mRoomService;\r\n        return _this;\r\n    }\r\n    ReferenceArea.prototype.draw = function (area, origin) {\r\n        this.clear();\r\n        if (area.length === 0 || area[0].length === 0) {\r\n            return;\r\n        }\r\n        var p1;\r\n        var p2;\r\n        var p3;\r\n        var p4;\r\n        var rows = area.length;\r\n        var cols = area[0].length;\r\n        var roomSize = this.mRoomService.roomSize;\r\n        var tileWidth = roomSize.tileWidth / 2;\r\n        var tileHeight = roomSize.tileHeight / 2;\r\n        this.mOrigin = origin;\r\n        this.mSize = {\r\n            rows: rows,\r\n            cols: cols,\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2)\r\n        };\r\n        this.beginPath();\r\n        for (var y = 0; y < rows; y++) {\r\n            for (var x = 0; x < cols; x++) {\r\n                this.lineStyle(2, 0);\r\n                p1 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x, y), this.mSize);\r\n                p2 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x + 1, y), this.mSize);\r\n                p3 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x + 1, y + 1), this.mSize);\r\n                p4 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x, y + 1), this.mSize);\r\n                this.beginPath();\r\n                this.fillStyle(area[y][x] === 1 ? 0x00FF00 : 0xFF0000);\r\n                this.strokePoints([p1.toPoint(), p2.toPoint(), p3.toPoint(), p4.toPoint()], true, true);\r\n                this.fillPath();\r\n            }\r\n        }\r\n        this.setPosition(0, 0);\r\n    };\r\n    ReferenceArea.prototype.setPosition = function (x, y, z, w) {\r\n        if (!this.mSize)\r\n            return;\r\n        var _x = x - this.mSize.rows * (this.mSize.tileWidth >> 1) - (this.mOrigin.x - this.mOrigin.y) * (this.mSize.tileWidth >> 1);\r\n        var _y = y - (this.mOrigin.x + this.mOrigin.y) * (this.mSize.tileHeight >> 1);\r\n        return _super.prototype.setPosition.call(this, _x, _y, z, w);\r\n    };\r\n    return ReferenceArea;\r\n}(Phaser.GameObjects.Graphics));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/reference.area.ts?')},"./src/rooms/editor/selected.element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectedElement", function() { return SelectedElement; });\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n\r\n\r\nvar SelectedElement = /** @class */ (function () {\r\n    function SelectedElement(mScene, mLayerManager) {\r\n        this.mScene = mScene;\r\n        this.mLayerManager = mLayerManager;\r\n        this.mEffecte = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"](this.mScene, 0, 0);\r\n        this.mEffecte.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/editor/selectFlag.png"));\r\n    }\r\n    SelectedElement.prototype.setElement = function (display) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.hideRefernceArea();\r\n            this.mDisplay.showNickname("");\r\n            this.mSprite = undefined;\r\n        }\r\n        this.mDisplay = display;\r\n        display.showRefernceArea();\r\n        var ele = display.element;\r\n        if (ele) {\r\n            ele.showNickname();\r\n            this.mSprite = ele.model;\r\n        }\r\n        this.mLayerManager.addToSceneToUI(this.mEffecte);\r\n        this.mSelecting = true;\r\n        this.update();\r\n    };\r\n    SelectedElement.prototype.remove = function () {\r\n        this.mSelecting = false;\r\n        if (!this.mEffecte) {\r\n            return;\r\n        }\r\n        if (this.mEffecte.parentContainer) {\r\n            this.mEffecte.parentContainer.remove(this.mEffecte);\r\n        }\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        if (this.mDisplay.parentContainer) {\r\n            this.mDisplay.hideRefernceArea();\r\n            this.mDisplay.showNickname("");\r\n        }\r\n        this.mDisplay = null;\r\n        this.mSprite = undefined;\r\n    };\r\n    SelectedElement.prototype.update = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var baseLoc = this.mDisplay.baseLoc;\r\n        this.mEffecte.x = this.mDisplay.x + baseLoc.x + (this.mDisplay.spriteWidth >> 1);\r\n        this.mEffecte.y = this.mDisplay.y + baseLoc.y;\r\n    };\r\n    SelectedElement.prototype.setDisplayPos = function (x, y) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.x = x;\r\n        this.mDisplay.y = y;\r\n        if (this.mSprite) {\r\n            var pos = this.mSprite.pos;\r\n            if (pos) {\r\n                pos.x = x;\r\n                pos.y = y;\r\n            }\r\n        }\r\n    };\r\n    SelectedElement.prototype.destroy = function () {\r\n        if (!this.mEffecte) {\r\n            return;\r\n        }\r\n        this.remove();\r\n        this.mEffecte.destroy();\r\n        this.mEffecte = null;\r\n    };\r\n    Object.defineProperty(SelectedElement.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "selecting", {\r\n        /**\r\n         * 鼠标按下选中物件, 松开取消选择\r\n         */\r\n        get: function () {\r\n            return this.mSelecting;\r\n        },\r\n        set: function (val) {\r\n            this.mSelecting = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return SelectedElement;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/selected.element.ts?')},"./src/rooms/element/decorate.element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateElementManager", function() { return DecorateElementManager; });\n/* harmony import */ var _element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType;\r\nvar DecorateElementManager = /** @class */ (function (_super) {\r\n    __extends(DecorateElementManager, _super);\r\n    function DecorateElementManager(room) {\r\n        var _this = _super.call(this, room) || this;\r\n        var size = room.miniSize;\r\n        _this.mMap = new Array(size.cols);\r\n        for (var i = 0; i < _this.mMap.length; i++) {\r\n            _this.mMap[i] = new Array(size.rows).fill(-1);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateElementManager.prototype.remove = function (id) {\r\n        var ele = _super.prototype.remove.call(this, id);\r\n        if (ele) {\r\n            this.removeMap(ele.model);\r\n        }\r\n        return ele;\r\n    };\r\n    DecorateElementManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var element = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            element = this.get(sprite.id);\r\n            if (element) {\r\n                var sp = new _sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite, content.nodeType);\r\n                element.model = sp;\r\n                this.addMap(sp);\r\n            }\r\n        }\r\n    };\r\n    DecorateElementManager.prototype._add = function (sprite) {\r\n        var ele = _super.prototype._add.call(this, sprite);\r\n        this.addMap(sprite);\r\n        return ele;\r\n    };\r\n    DecorateElementManager.prototype.addMap = function (sprite) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var aniName = sprite.currentAnimationName || displayInfo.animationName;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName);\r\n        var walkArea = displayInfo.getWalkableArea(aniName);\r\n        var origin = displayInfo.getOriginPoint(aniName);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var pos = this.mRoom.transformToMini45(sprite.pos);\r\n        if (!walkArea) {\r\n            walkArea = new Array(rows);\r\n            for (var i = 0; i < rows; i++) {\r\n                walkArea[i] = new Array(cols).fill(0);\r\n            }\r\n        }\r\n        for (var i = 0; i < rows; i++) {\r\n            for (var j = 0; j < cols; j++) {\r\n                if (collisionArea[i][j] === 1 && walkArea[i][j] === 0) {\r\n                    this.mMap[pos.y + i - origin.x][pos.x + j - origin.y] = 0;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateElementManager.prototype.removeMap = function (sprite) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var aniName = sprite.currentAnimationName || displayInfo.animationName;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName);\r\n        var walkArea = displayInfo.getWalkableArea(aniName);\r\n        var origin = displayInfo.getOriginPoint(aniName);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var pos = this.mRoom.transformToMini45(sprite.pos);\r\n        if (!walkArea) {\r\n            walkArea = new Array(rows);\r\n            for (var i = 0; i < cols; i++) {\r\n                walkArea[i] = new Array(cols).fill(0);\r\n            }\r\n        }\r\n        for (var i = 0; i < rows; i++) {\r\n            for (var j = 0; j < cols; j++) {\r\n                if (collisionArea[i][j] === 1) {\r\n                    this.mMap[pos.y + i - origin.x][pos.x + j - origin.y] = -1;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateElementManager.prototype.setMap = function (sprite, type) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var aniName = sprite.currentAnimationName || displayInfo.animationName;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName);\r\n        var walkArea = displayInfo.getWalkableArea(aniName);\r\n        var origin = displayInfo.getOriginPoint(aniName);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var pos = sprite.pos;\r\n        if (!walkArea) {\r\n            walkArea = new Array(rows);\r\n            for (var i = 0; i < cols; i++) {\r\n                walkArea[i] = new Array(cols).fill(0);\r\n            }\r\n        }\r\n        for (var i = 0; i < rows; i++) {\r\n            for (var j = 0; j < cols; j++) {\r\n                if (walkArea[i][j] === 0) {\r\n                    this.mMap[pos.y + i - origin.x][pos.x + j - origin.y] = type;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(DecorateElementManager.prototype, "map", {\r\n        get: function () {\r\n            return this.mMap;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DecorateElementManager;\r\n}(_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/decorate.element.manager.ts?')},"./src/rooms/element/editor.element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorElementManager", function() { return EditorElementManager; });\n/* harmony import */ var _element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./element */ "./src/rooms/element/element.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType;\r\nvar EditorElementManager = /** @class */ (function (_super) {\r\n    __extends(EditorElementManager, _super);\r\n    function EditorElementManager(mRoom) {\r\n        var _this = _super.call(this, mRoom) || this;\r\n        _this.mRoom = mRoom;\r\n        if (_this.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_CREATE_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorElementManager.prototype.add = function (sprites) {\r\n        if (!sprites && sprites.length === 0) {\r\n            return;\r\n        }\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this._add(sprite);\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_SPRITE);\r\n        var content = pkt.content;\r\n        content.nodeType = sprites[0].nodeType;\r\n        content.sprites = sprites.map(function (sprite) { return sprite.toSprite(); });\r\n        this.connection.send(pkt);\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_4__["Logger"].getInstance().log("add sprites: ", content);\r\n    };\r\n    EditorElementManager.prototype.removeEditor = function (id) {\r\n        var ele = this.tryRemove(id);\r\n        if (ele) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_SPRITE);\r\n            var content = pkt.content;\r\n            content.ids = [id];\r\n            this.connection.send(pkt);\r\n        }\r\n        return ele;\r\n    };\r\n    EditorElementManager.prototype.onAdd = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_4__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var objs = content.sprites;\r\n        if (!objs)\r\n            return;\r\n        var type = content.nodeType;\r\n        if (type !== NodeType.ElementNodeType && type !== NodeType.SpawnPointType) {\r\n            return;\r\n        }\r\n        var point;\r\n        for (var _i = 0, objs_1 = objs; _i < objs_1.length; _i++) {\r\n            var obj = objs_1[_i];\r\n            point = obj.point3f;\r\n            if (point) {\r\n                this._add(new _sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](obj));\r\n            }\r\n        }\r\n    };\r\n    EditorElementManager.prototype._add = function (sprite) {\r\n        var ele = this.mElements.get(sprite.id);\r\n        if (!ele)\r\n            ele = new _element__WEBPACK_IMPORTED_MODULE_6__["Element"](sprite, this);\r\n        ele.setBlockable(false);\r\n        ele.setRenderable(true);\r\n        // TODO udpate element\r\n        this.mElements.set(ele.id || 0, ele);\r\n        return ele;\r\n    };\r\n    EditorElementManager.prototype.tryRemove = function (id) {\r\n        var element = this.mElements.get(id);\r\n        if (element) {\r\n            this.mElements.delete(id);\r\n            element.destroy();\r\n            if (this.roomService) {\r\n                this.roomService.blocks.remove(element);\r\n            }\r\n            return element;\r\n        }\r\n    };\r\n    EditorElementManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== NodeType.ElementNodeType && type !== NodeType.SpawnPointType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.tryRemove(id);\r\n        }\r\n        this.roomService.removeSelected();\r\n    };\r\n    EditorElementManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            this.trySync(sprite);\r\n        }\r\n    };\r\n    EditorElementManager.prototype.trySync = function (sprite) {\r\n        var element = this.mElements.get(sprite.id);\r\n        if (!element) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_4__["Logger"].getInstance().log("can\'t find element", sprite);\r\n            return;\r\n        }\r\n        var point = sprite.point3f;\r\n        if (point) {\r\n            element.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_5__["Pos"](point.x, point.y, point.z));\r\n        }\r\n        if (sprite.direction) {\r\n            element.setDirection(sprite.direction);\r\n        }\r\n    };\r\n    Object.defineProperty(EditorElementManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return EditorElementManager;\r\n}(_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/editor.element.manager.ts?')},"./src/rooms/element/element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementManager", function() { return ElementManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\nvar ElementManager = /** @class */ (function (_super) {\r\n    __extends(ElementManager, _super);\r\n    function ElementManager(mRoom) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mElements = new Map();\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE, _this.onMove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION, _this.onAdjust);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE, _this.onShowBubble);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN, _this.onClearBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION, _this.onSetPosition);\r\n        }\r\n        if (_this.mRoom && _this.mRoom.world) {\r\n            _this.mGameConfig = _this.mRoom.world.elementStorage;\r\n        }\r\n        return _this;\r\n    }\r\n    ElementManager.prototype.init = function () {\r\n        // this.destroy();\r\n    };\r\n    ElementManager.prototype.get = function (id) {\r\n        var element = this.mElements.get(id);\r\n        if (!element) {\r\n            return;\r\n        }\r\n        return element;\r\n    };\r\n    ElementManager.prototype.remove = function (id) {\r\n        var element = this.mElements.get(id);\r\n        if (element) {\r\n            this.mElements.delete(id);\r\n            element.destroy();\r\n        }\r\n        return element;\r\n    };\r\n    ElementManager.prototype.getElements = function () {\r\n        return Array.from(this.mElements.values());\r\n    };\r\n    ElementManager.prototype.add = function (sprites) {\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this._add(sprite);\r\n        }\r\n    };\r\n    ElementManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mElements)\r\n            return;\r\n        this.mElements.forEach(function (element) { return _this.remove(element.id); });\r\n        this.mElements.clear();\r\n    };\r\n    Object.defineProperty(ElementManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mRoom.cameraService.camera;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ElementManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("roomManager is undefined");\r\n            return;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ElementManager.prototype.onAdjust = function (packet) {\r\n        var content = packet.content;\r\n        var sprites = content.spritePositions;\r\n        var type = content.nodeType;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var ele;\r\n        var point;\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            ele = this.mElements.get(sprite.id);\r\n            if (!ele) {\r\n                continue;\r\n            }\r\n            point = sprite.point3f;\r\n            ele.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](point.x || 0, point.y || 0, point.z || 0));\r\n        }\r\n    };\r\n    ElementManager.prototype.onAdd = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        if (!this.mGameConfig) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("gameConfig does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var objs = content.sprites;\r\n        if (!objs)\r\n            return;\r\n        var type = content.nodeType;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var point;\r\n        var sprite = null;\r\n        var ids = [];\r\n        for (var _i = 0, objs_1 = objs; _i < objs_1.length; _i++) {\r\n            var obj = objs_1[_i];\r\n            point = obj.point3f;\r\n            if (point) {\r\n                sprite = new _sprite__WEBPACK_IMPORTED_MODULE_5__["Sprite"](obj, content.nodeType);\r\n                if (!sprite.displayInfo) {\r\n                    this.checkDisplay(sprite);\r\n                }\r\n                if (!sprite.displayInfo) {\r\n                    ids.push(sprite.id);\r\n                }\r\n                this._add(sprite);\r\n            }\r\n        }\r\n        this.fetchDisplay(ids);\r\n    };\r\n    ElementManager.prototype._add = function (sprite) {\r\n        var ele = this.mElements.get(sprite.id);\r\n        if (!ele)\r\n            ele = new _element__WEBPACK_IMPORTED_MODULE_2__["Element"](sprite, this);\r\n        // TODO udpate element\r\n        this.mElements.set(ele.id || 0, ele);\r\n        return ele;\r\n    };\r\n    ElementManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    ElementManager.prototype.checkDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var displayInfo = this.roomService.world.elementStorage.getObject(sprite.bindID || sprite.id);\r\n            if (displayInfo) {\r\n                sprite.displayInfo = displayInfo;\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.fetchDisplay = function (ids) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(ElementManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ElementManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ElementManager.prototype.onSetPosition = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var id = content.id;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var ele = this.get(id);\r\n        ele.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](content.position.x, content.position.y, content.position.z));\r\n    };\r\n    ElementManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.remove(id);\r\n        }\r\n    };\r\n    ElementManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var element = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_3 = sprites; _i < sprites_3.length; _i++) {\r\n            var sprite = sprites_3[_i];\r\n            element = this.get(sprite.id);\r\n            if (element) {\r\n                element.model = new _sprite__WEBPACK_IMPORTED_MODULE_5__["Sprite"](sprite, content.nodeType);\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.onMove = function (packet) {\r\n        var content = packet.content;\r\n        if (content.moveData) {\r\n            var moveDataList = content.moveData;\r\n            var len = moveDataList.length;\r\n            var type = content.nodeType || null;\r\n            var moveData = void 0;\r\n            var elementID = void 0;\r\n            var element = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                moveData = moveDataList[i];\r\n                elementID = moveData.moveObjectId;\r\n                element = this.get(elementID);\r\n                // Console.log(player.x + "," + player.y + ":" + moveData.destinationPoint3f.x + "," + moveData.destinationPoint3f.y + ":" + moveData.timeSpan);\r\n                if (!element) {\r\n                    continue;\r\n                }\r\n                element.move(moveData);\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.onShowBubble = function (packet) {\r\n        var content = packet.content;\r\n        var element = this.get(content.receiverid);\r\n        if (element) {\r\n            element.showBubble(content.context, content.chatsetting);\r\n        }\r\n    };\r\n    ElementManager.prototype.onClearBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var element = this.get(content.receiverid);\r\n        if (element) {\r\n            element.clearBubble();\r\n        }\r\n    };\r\n    ElementManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var anis = content.changeAnimation;\r\n        var ele = null;\r\n        for (var _i = 0, anis_1 = anis; _i < anis_1.length; _i++) {\r\n            var ani = anis_1[_i];\r\n            ele = this.get((ani.id));\r\n            if (ele) {\r\n                ele.play(ani.animationName);\r\n            }\r\n        }\r\n    };\r\n    return ElementManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/element.manager.ts?')},"./src/rooms/element/element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerState", function() { return PlayerState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Direction", function() { return Direction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Element", function() { return Element; });\n/* harmony import */ var _display_dragonbones_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _display_frames_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _cameras_block_object__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../cameras/block.object */ "./src/rooms/cameras/block.object.ts");\n/* harmony import */ var _bubble_bubble_container__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../bubble/bubble.container */ "./src/rooms/bubble/bubble.container.ts");\n/* harmony import */ var _shop_shop_entity__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./shop/shop.entity */ "./src/rooms/element/shop/shop.entity.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PlayerState;\r\n(function (PlayerState) {\r\n    PlayerState["IDLE"] = "idle";\r\n    PlayerState["WALK"] = "walk";\r\n    PlayerState["RUN"] = "run";\r\n    PlayerState["ATTACK"] = "attack";\r\n    PlayerState["JUMP"] = "jump";\r\n    PlayerState["INJURED"] = "injured";\r\n    PlayerState["FAILED"] = "failed";\r\n    PlayerState["DANCE01"] = "dance01";\r\n    PlayerState["DANCE02"] = "dance02";\r\n    PlayerState["FISHING"] = "fishing";\r\n    PlayerState["GREET01"] = "greet01";\r\n    PlayerState["SIT"] = "sit";\r\n    PlayerState["LIE"] = "lit";\r\n    PlayerState["EMOTION01"] = "emotion01";\r\n})(PlayerState || (PlayerState = {}));\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[Direction["up"] = 0] = "up";\r\n    Direction[Direction["up_left"] = 1] = "up_left";\r\n    Direction[Direction["left"] = 2] = "left";\r\n    Direction[Direction["left_down"] = 3] = "left_down";\r\n    Direction[Direction["down"] = 4] = "down";\r\n    Direction[Direction["down_right"] = 5] = "down_right";\r\n    Direction[Direction["right"] = 6] = "right";\r\n    Direction[Direction["right_up"] = 7] = "right_up";\r\n})(Direction || (Direction = {}));\r\nvar Element = /** @class */ (function (_super) {\r\n    __extends(Element, _super);\r\n    function Element(sprite, mElementManager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mAnimationName = "";\r\n        _this.mMoveData = {};\r\n        _this.mCurState = PlayerState.IDLE;\r\n        _this.mBlockable = false;\r\n        _this.mId = sprite.id;\r\n        _this.model = sprite;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Element.prototype, "dir", {\r\n        get: function () {\r\n            return this.mDisplayInfo.avatarDir !== undefined ? this.mDisplayInfo.avatarDir : 3;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "roomService", {\r\n        get: function () {\r\n            if (!this.mElementManager) {\r\n                // Logger.getInstance().error("element manager is undefined");\r\n                return;\r\n            }\r\n            return this.mElementManager.roomService;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "id", {\r\n        get: function () {\r\n            return this.mId; // this.mDisplayInfo.id || 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.setModel(val);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Element.prototype.load = function (displayInfo) {\r\n        this.mDisplayInfo = displayInfo;\r\n        this.loadDisplayInfo();\r\n    };\r\n    Element.prototype.setModel = function (model) {\r\n        this.mModel = model;\r\n        if (!model) {\r\n            return;\r\n        }\r\n        // this.mDisplayInfo = this.mModel.displayInfo;\r\n        this.load(this.mModel.displayInfo);\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        if (this.mModel.pos) {\r\n            this.setPosition(this.mModel.pos);\r\n        }\r\n        this.mDisplay.changeAlpha(this.mModel.alpha);\r\n        // todo 暂时不显示，后续添加显示名字的协议\r\n        // this.mDisplay.showNickname(this.mModel.nickname);\r\n        this.setDirection(this.mModel.direction);\r\n        // this.setRenderable(true);\r\n        var frameModel = this.mDisplayInfo;\r\n        if (frameModel.shops) {\r\n            this.mShopEntity = new _shop_shop_entity__WEBPACK_IMPORTED_MODULE_6__["ShopEntity"](this.mElementManager.roomService.world);\r\n            this.mShopEntity.register();\r\n        }\r\n    };\r\n    Element.prototype.play = function (animationName) {\r\n        if (this.mAnimationName !== animationName) {\r\n            this.mAnimationName = animationName;\r\n            if (this.mDisplay) {\r\n                this.mDisplay.play(this.mAnimationName);\r\n            }\r\n        }\r\n    };\r\n    Element.prototype.setDirection = function (val) {\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.avatarDir = val;\r\n        }\r\n        if (this.model) {\r\n            this.model.direction = val;\r\n        }\r\n        if (this.mDisplay) {\r\n            if (val === 3) {\r\n                this.mDisplay.scaleX = 1;\r\n            }\r\n            else {\r\n                this.mDisplay.scaleX = -1;\r\n            }\r\n        }\r\n    };\r\n    Element.prototype.getDirection = function () {\r\n        return this.mDisplayInfo && this.mDisplayInfo.avatarDir ? this.mDisplayInfo.avatarDir : 3;\r\n    };\r\n    Element.prototype.changeState = function (val) {\r\n        this.mCurState = val;\r\n    };\r\n    Element.prototype.getState = function () {\r\n        return this.mCurState;\r\n    };\r\n    Element.prototype.getRenderable = function () {\r\n        return this.mRenderable;\r\n    };\r\n    Element.prototype.getDisplay = function () {\r\n        return this.mDisplay;\r\n    };\r\n    Element.prototype.move = function (moveData) {\r\n        if (!this.mElementManager) {\r\n            return; // Logger.getInstance().error(`Element::move - Empty element-manager.`);\r\n        }\r\n        if (!this.mDisplay) {\r\n            return; // Logger.getInstance().error("display is undefined");\r\n        }\r\n        this.mMoveData.arrivalTime = moveData.timestemp;\r\n        this.mMoveData.destPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](Math.floor(moveData.destinationPoint3f.x), Math.floor(moveData.destinationPoint3f.y));\r\n        // Logger.debug(`move,x:${this.mDisplay.x},y:${this.mDisplay.y},tox:${this.mMoveData.destPos.x},toy:${this.mMoveData.destPos.y}`);\r\n        // Logger.getInstance().debug("walk has movedata");\r\n        this._doMove();\r\n    };\r\n    Element.prototype.startMove = function () {\r\n        this.changeState(PlayerState.WALK);\r\n    };\r\n    Element.prototype.stopMove = function () {\r\n        if (!this.mDisplay) {\r\n            // Logger.getInstance().error(`can\'t stopMove, display does not exist`);\r\n            return;\r\n        }\r\n        this.changeState(PlayerState.IDLE);\r\n        // Logger.debug(`stop,x:${this.mDisplay.x},y:${this.mDisplay.y},tox:${this.mMoveData.destPos.x},toy:${this.mMoveData.destPos.y}`);\r\n    };\r\n    Element.prototype.setPosition = function (p) {\r\n        if (this.mDisplay && p) {\r\n            this.mDisplay.setPosition(p.x, p.y, p.z);\r\n        }\r\n        this.setDepth();\r\n        this.updateBlock();\r\n    };\r\n    Element.prototype.getPosition = function () {\r\n        var pos;\r\n        if (this.mDisplay) {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x, this.mDisplay.y, this.mDisplay.z);\r\n        }\r\n        return pos;\r\n    };\r\n    Element.prototype.getPosition45 = function () {\r\n        var pos = this.getPosition();\r\n        if (!pos)\r\n            return new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"]();\r\n        return this.roomService.transformTo45(pos);\r\n    };\r\n    Element.prototype.getRootPosition = function () {\r\n        return new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x, this.mDisplay.y, 0);\r\n    };\r\n    Element.prototype.showBubble = function (text, setting) {\r\n        var scene = this.mElementManager.scene;\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        if (!this.mBubble) {\r\n            this.mBubble = new _bubble_bubble_container__WEBPACK_IMPORTED_MODULE_5__["BubbleContainer"](scene);\r\n        }\r\n        this.mBubble.addBubble(text, setting);\r\n        this.updateBubble();\r\n        this.roomService.addToSceneUI(this.mBubble);\r\n    };\r\n    Element.prototype.clearBubble = function () {\r\n        if (!this.mBubble) {\r\n            return;\r\n        }\r\n        this.mBubble.destroy();\r\n        this.mBubble = null;\r\n    };\r\n    Element.prototype.showNickName = function () {\r\n        if (this.mDisplay && this.model) {\r\n            this.mDisplay.showNickname(this.model.nickname);\r\n        }\r\n    };\r\n    Element.prototype.showEffected = function () {\r\n        if (this.mDisplay)\r\n            this.mDisplay.showEffect();\r\n    };\r\n    Element.prototype.showNickname = function () {\r\n        if (this.model && this.mDisplay) {\r\n            this.mDisplay.showNickname(this.model.nickname);\r\n        }\r\n    };\r\n    Element.prototype.removeMe = function () {\r\n        if (!this.mElementManager)\r\n            return;\r\n        this.mElementManager.remove(this.id);\r\n    };\r\n    Element.prototype.toSprite = function () {\r\n        var sprite = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].Sprite.create();\r\n        sprite.id = this.id;\r\n        if (this.mDisplay) {\r\n            sprite.point3f = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].PBPoint3f.create();\r\n            sprite.point3f.x = this.mDisplay.x;\r\n            sprite.point3f.y = this.mDisplay.y;\r\n            sprite.point3f.z = this.mDisplay.z;\r\n        }\r\n        return sprite;\r\n    };\r\n    Element.prototype.setBlockable = function (val) {\r\n        if (this.mBlockable !== val) {\r\n            this.mBlockable = val;\r\n            if (this.mDisplay && this.roomService) {\r\n                if (val) {\r\n                    this.roomService.addBlockObject(this);\r\n                }\r\n                else {\r\n                    this.roomService.removeBlockObject(this);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.destroy = function () {\r\n        if (this.mMoveData && this.mMoveData.tweenAnim) {\r\n            this.mMoveData.tweenAnim.stop();\r\n            this.mMoveData.tweenAnim.remove();\r\n            this.mMoveData.tweenAnim = null;\r\n            this.mMoveData = null;\r\n        }\r\n        if (this.mDisplay) {\r\n            if (this.mBlockable) {\r\n                this.roomService.removeBlockObject(this);\r\n            }\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        if (this.mBubble) {\r\n            this.mBubble.destroy();\r\n            this.mBubble = undefined;\r\n        }\r\n        if (this.mShopEntity) {\r\n            this.mShopEntity.destroy();\r\n            this.mShopEntity = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Element.prototype._doMove = function () {\r\n        var _this = this;\r\n        if (!this.mMoveData.destPos) {\r\n            // Logger.getInstance().log("stopDoMove");\r\n            return;\r\n        }\r\n        var tw = this.mMoveData.tweenAnim;\r\n        if (tw) {\r\n            tw.stop();\r\n            tw.remove();\r\n        }\r\n        var time = this.mMoveData.arrivalTime - this.roomService.now();\r\n        // Logger.getInstance().debug(`time:${time},posX:${this.mMoveData.destPos.x},posY:${this.mMoveData.destPos.y}`); // ,arrivalTime:${this.mMoveData.arrivalTime},now:${this.roomService.now()}`);\r\n        this.mMoveData.tweenAnim = this.mElementManager.scene.tweens.add({\r\n            targets: this.mDisplay,\r\n            duration: time,\r\n            ease: "Linear",\r\n            props: {\r\n                x: { value: this.mMoveData.destPos.x },\r\n                y: { value: this.mMoveData.destPos.y }\r\n            },\r\n            onStart: function () {\r\n                _this.onMoveStart();\r\n            },\r\n            onComplete: function (tween, targets, element) {\r\n                // Logger.getInstance().debug("complete move:" + this.mDisplay.x + "-" + this.mDisplay.y);\r\n                _this.onMoveComplete();\r\n            },\r\n            onUpdate: function (tween, targets, element) {\r\n                // Logger.getInstance().debug("moveing:" + this.mDisplay.x + "-" + this.mDisplay.y);\r\n                _this.onMoving();\r\n            },\r\n            onCompleteParams: [this]\r\n        });\r\n    };\r\n    Element.prototype.createDisplay = function () {\r\n        console.log("create terrain display====>");\r\n        if (!this.mDisplayInfo) {\r\n            // Logger.getInstance().error("displayinfo does not exist, Create display failed");\r\n            return;\r\n        }\r\n        if (this.mDisplay) {\r\n            return this.mDisplay;\r\n        }\r\n        var scene = this.mElementManager.scene;\r\n        if (scene) {\r\n            if (this.mDisplayInfo.discriminator === "DragonbonesModel") {\r\n                this.mDisplay = new _display_dragonbones_display__WEBPACK_IMPORTED_MODULE_0__["DragonbonesDisplay"](scene, this.mElementManager.roomService, this);\r\n            }\r\n            else {\r\n                this.mDisplay = new _display_frames_display__WEBPACK_IMPORTED_MODULE_1__["FramesDisplay"](scene, this.mElementManager.roomService, this);\r\n            }\r\n            var pos = this.mModel.pos;\r\n            if (pos)\r\n                this.mDisplay.setPosition(pos.x, pos.y, pos.z);\r\n            this.addToBlock();\r\n        }\r\n        return this.mDisplay;\r\n    };\r\n    Element.prototype.loadDisplayInfo = function () {\r\n        if (!this.mDisplayInfo) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            this.createDisplay();\r\n        }\r\n        this.mDisplay.once("initialized", this.onDisplayReady, this);\r\n        this.mDisplay.load(this.mDisplayInfo);\r\n    };\r\n    Element.prototype.addDisplay = function () {\r\n        this.createDisplay();\r\n        var room = this.roomService;\r\n        if (!room) {\r\n            // Logger.getInstance().error("roomService is undefined");\r\n            return;\r\n        }\r\n        room.addToSurface(this.mDisplay);\r\n        this.setDepth();\r\n    };\r\n    Element.prototype.addToBlock = function () {\r\n        if (this.mBlockable) {\r\n            this.roomService.addBlockObject(this);\r\n        }\r\n        else {\r\n            this.addDisplay();\r\n        }\r\n    };\r\n    Element.prototype.updateBlock = function () {\r\n        if (this.mBlockable) {\r\n            this.roomService.updateBlockObject(this);\r\n        }\r\n    };\r\n    Element.prototype.setDepth = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setDepth(this.mDisplay.x + this.mDisplay.y);\r\n            if (!this.roomService) {\r\n                throw new Error("roomService is undefined");\r\n            }\r\n            var layerManager = this.roomService.layerManager;\r\n            if (!layerManager) {\r\n                throw new Error("layerManager is undefined");\r\n            }\r\n            layerManager.depthSurfaceDirty = true;\r\n        }\r\n    };\r\n    Element.prototype.onDisplayReady = function () {\r\n        if (this.mDisplay) {\r\n            if (this.model.currentAnimationName)\r\n                this.mDisplay.play(this.model.currentAnimationName);\r\n            this.setDepth();\r\n        }\r\n    };\r\n    Element.prototype.updateBubble = function () {\r\n        if (!this.mBubble) {\r\n            return;\r\n        }\r\n        var position = this.getPosition();\r\n        if (!position) {\r\n            return;\r\n        }\r\n        this.mBubble.x = position.x;\r\n        this.mBubble.y = position.y - 130;\r\n    };\r\n    Element.prototype.onMoveStart = function () { };\r\n    Element.prototype.onMoveComplete = function () {\r\n        this.mMoveData.tweenAnim.stop();\r\n    };\r\n    Element.prototype.onMoving = function () {\r\n        var now = this.roomService.now();\r\n        if (now - (this.mMoveData.tweenLastUpdate || 0) >= 50) {\r\n            this.setDepth();\r\n            this.mMoveData.tweenLastUpdate = now;\r\n            this.updateBubble();\r\n            if (this.mBlockable) {\r\n                this.roomService.updateBlockObject(this);\r\n                // this.roomService.addBlockObject()\r\n            }\r\n        }\r\n    };\r\n    return Element;\r\n}(_cameras_block_object__WEBPACK_IMPORTED_MODULE_4__["BlockObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/element.ts?')},"./src/rooms/element/shop/shop.entity.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopEntity", function() { return ShopEntity; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _shop_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shop.model */ "./src/rooms/element/shop/shop.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ShopEntity = /** @class */ (function (_super) {\r\n    __extends(ShopEntity, _super);\r\n    function ShopEntity(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        _this.mInitialize = false;\r\n        _this.mConnect = _this.mWorld.connection;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QUERY_PACKAGE, _this.handlerQueryPackage);\r\n        _this.mShopModel = new _shop_model__WEBPACK_IMPORTED_MODULE_1__["ShopModel"]();\r\n        return _this;\r\n    }\r\n    ShopEntity.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    ShopEntity.prototype.register = function () {\r\n        this.mConnect.addPacketListener(this);\r\n    };\r\n    ShopEntity.prototype.unRegister = function () {\r\n        this.mConnect.removePacketListener(this);\r\n    };\r\n    ShopEntity.prototype.destroy = function () {\r\n        this.unRegister();\r\n        this.mShopModel = null;\r\n        this.mInitialize = false;\r\n        this.mConnect = null;\r\n    };\r\n    ShopEntity.prototype.handlerQueryPackage = function (packet) {\r\n        var notice = packet.content;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].QUERY_PACKAGE, notice);\r\n    };\r\n    ShopEntity.NAME = "ShopModel";\r\n    return ShopEntity;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/shop/shop.entity.ts?')},"./src/rooms/element/shop/shop.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopModel", function() { return ShopModel; });\nvar ShopModel = /** @class */ (function () {\r\n    function ShopModel() {\r\n    }\r\n    return ShopModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/shop/shop.model.ts?')},"./src/rooms/element/sprite.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Sprite", function() { return Sprite; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _display_dragonbones_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _player_slot_info__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../player/slot.info */ "./src/rooms/player/slot.info.ts");\n/* harmony import */ var _display_frames_model__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var _display_animation__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../display/animation */ "./src/rooms/display/animation.ts");\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/helpers */ "./src/utils/helpers.ts");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Sprite = /** @class */ (function () {\r\n    function Sprite(obj, nodeType) {\r\n        this.mID = obj.id;\r\n        if (obj.point3f) {\r\n            var point = obj.point3f;\r\n            this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](point.x, point.y, point.z);\r\n        }\r\n        if (obj.avatar) {\r\n            this.mAvatar = { id: obj.avatar.id };\r\n            this.mAvatar = Object.assign(this.mAvatar, obj.avatar);\r\n            this.mDisplayInfo = new _display_dragonbones_model__WEBPACK_IMPORTED_MODULE_1__["DragonbonesModel"](this);\r\n        }\r\n        if (obj.display) {\r\n            var anis = [];\r\n            var objAnis = obj.animations;\r\n            for (var _i = 0, objAnis_1 = objAnis; _i < objAnis_1.length; _i++) {\r\n                var ani = objAnis_1[_i];\r\n                anis.push(new _display_animation__WEBPACK_IMPORTED_MODULE_5__["Animation"](ani));\r\n            }\r\n            this.mDisplayInfo = new _display_frames_model__WEBPACK_IMPORTED_MODULE_4__["FramesModel"]({\r\n                id: obj.id,\r\n                animations: {\r\n                    defaultAnimationName: obj.currentAnimationName,\r\n                    display: obj.display,\r\n                    animationData: anis\r\n                }\r\n            });\r\n        }\r\n        if (obj.sn) {\r\n            this.mSn = obj.sn;\r\n        }\r\n        this.mCurrentAnimationName = obj.currentAnimationName;\r\n        this.mDirection = obj.direction || 3;\r\n        this.mNickname = obj.nickname;\r\n        this.mBindID = obj.bindId;\r\n        this.mAlpha = obj.opacity === undefined ? 1 : obj.opacity / 100;\r\n        this.mDisplayBadgeCards = obj.displayBadgeCards;\r\n        this.mNodeType = nodeType;\r\n    }\r\n    Sprite.prototype.toSprite = function () {\r\n        var sprite = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].Sprite.create();\r\n        sprite.id = this.id;\r\n        sprite.nickname = this.mNickname;\r\n        if (this.mDisplayInfo instanceof _display_frames_model__WEBPACK_IMPORTED_MODULE_4__["FramesModel"]) {\r\n            sprite.display = this.mDisplayInfo.display;\r\n            sprite.currentAnimationName = this.currentAnimationName;\r\n            var point3f = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].PBPoint3f.create();\r\n            point3f.x = this.pos.x;\r\n            point3f.y = this.pos.y;\r\n            point3f.z = this.pos.z;\r\n            sprite.point3f = point3f;\r\n            sprite.animations = this.displayInfo.toClient();\r\n        }\r\n        sprite.direction = this.direction;\r\n        sprite.bindId = this.bindID;\r\n        sprite.sn = this.sn;\r\n        return sprite;\r\n    };\r\n    Sprite.prototype.newID = function () {\r\n        this.mID = _utils_helpers__WEBPACK_IMPORTED_MODULE_6__["default"].genId();\r\n    };\r\n    Sprite.prototype.setPosition = function (x, y) {\r\n        if (!this.mPos) {\r\n            this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mPos.x = x;\r\n        this.mPos.y = y;\r\n    };\r\n    Sprite.prototype.turn = function () {\r\n        this.mDirection += 2;\r\n        this.mDirection = this.mDirection > 5 ? 3 : this.mDirection;\r\n        return this;\r\n    };\r\n    Object.defineProperty(Sprite.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "pos", {\r\n        get: function () {\r\n            return this.mPos;\r\n        },\r\n        set: function (pos) {\r\n            this.mPos = pos;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "avatar", {\r\n        get: function () {\r\n            return this.mAvatar;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentAnimationName", {\r\n        get: function () {\r\n            return this.mCurrentAnimationName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "direction", {\r\n        get: function () {\r\n            return this.mDirection;\r\n        },\r\n        set: function (val) {\r\n            this.mDirection = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "nickname", {\r\n        get: function () {\r\n            return this.mNickname;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "bindID", {\r\n        get: function () {\r\n            return this.mBindID;\r\n        },\r\n        set: function (id) {\r\n            this.mBindID = id;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "sn", {\r\n        get: function () {\r\n            return this.mSn;\r\n        },\r\n        set: function (value) {\r\n            this.mSn = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "alpha", {\r\n        get: function () {\r\n            return this.mAlpha;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "walkableArea", {\r\n        get: function () {\r\n            return this.mWalkableArea;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "collisionArea", {\r\n        get: function () {\r\n            return this.mCollisionArea;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "originPoint", {\r\n        get: function () {\r\n            return this.mOriginPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "walkOriginPoint", {\r\n        get: function () {\r\n            return this.mWalkOriginPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "slot", {\r\n        get: function () {\r\n            return this.getSlots();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "maxNum", {\r\n        get: function () {\r\n            return this.mMaxNum;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "camp", {\r\n        get: function () {\r\n            return this.mCamp;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "attributes", {\r\n        get: function () {\r\n            return this.mAttributes;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "package", {\r\n        get: function () {\r\n            return this.mPackage;\r\n        },\r\n        set: function (value) {\r\n            this.mPackage = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "sceneId", {\r\n        get: function () {\r\n            return this.mSceneId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "uuid", {\r\n        get: function () {\r\n            return this.mUuid;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "displayBadgeCards", {\r\n        get: function () {\r\n            return this.mDisplayBadgeCards;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "platformId", {\r\n        get: function () {\r\n            return this.mPlatformId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "displayInfo", {\r\n        get: function () {\r\n            return this.mDisplayInfo;\r\n        },\r\n        set: function (displayInfo) {\r\n            this.mDisplayInfo = displayInfo;\r\n            if (this.currentAnimationName)\r\n                this.mDisplayInfo.animationName = this.currentAnimationName;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "nodeType", {\r\n        get: function () {\r\n            return this.mNodeType;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Sprite.prototype.getSlots = function () {\r\n        if (this.mSlot === undefined)\r\n            return null;\r\n        var len = this.slot.length;\r\n        var info;\r\n        var attri;\r\n        var slots = [];\r\n        for (var i = 0; i < len; i++) {\r\n            info = new _player_slot_info__WEBPACK_IMPORTED_MODULE_3__["SlotInfo"]();\r\n            attri = this.getAttriByKey(this.mSlot[i].bondAttrCurkey);\r\n            info.bondAttrCur = attri.intVal;\r\n            attri = this.getAttriByKey(this.mSlot[i].bondAttrMaxkey);\r\n            info.bondAttrMax = attri.intVal;\r\n            info.bondName = this.slot[i].bondName;\r\n            info.color = this.slot[i].color;\r\n            slots.push(info);\r\n        }\r\n        return slots;\r\n    };\r\n    Sprite.prototype.getSlotByName = function (name) {\r\n        if (this.mSlot === undefined)\r\n            return null;\r\n        var len = this.slot.length;\r\n        var info;\r\n        var attri;\r\n        for (var i = 0; i < len; i++) {\r\n            if (this.slot[i].bondName === name) {\r\n                info = new _player_slot_info__WEBPACK_IMPORTED_MODULE_3__["SlotInfo"]();\r\n                attri = this.getAttriByKey(this.mSlot[i].bondAttrCurkey);\r\n                info.bondAttrCur = attri.intVal;\r\n                attri = this.getAttriByKey(this.mSlot[i].bondAttrMaxkey);\r\n                info.bondAttrMax = attri.intVal;\r\n                info.bondName = this.slot[i].bondName;\r\n                info.color = this.slot[i].color;\r\n                return info;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Sprite.prototype.getAttriByKey = function (key) {\r\n        if (this.attributes === undefined)\r\n            return null;\r\n        var len = this.attributes.length;\r\n        for (var i = 0; i < len; i++) {\r\n            if (this.attributes[i].name === key) {\r\n                return this.attributes[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Object.defineProperty(Sprite.prototype, "originCollisionPoint", {\r\n        get: function () {\r\n            return this._originCollisionPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "originWalkPoint", {\r\n        get: function () {\r\n            return this._originWalkPoint;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Sprite.prototype.setOriginCollisionPoint = function (value) {\r\n        if (this._originCollisionPoint === undefined) {\r\n            this._originCollisionPoint = new Phaser.Geom.Point();\r\n        }\r\n        if (value && value.length > 1) {\r\n            this._originCollisionPoint.x = value[0];\r\n            this._originCollisionPoint.y = value[1];\r\n        }\r\n    };\r\n    Sprite.prototype.setOriginWalkPoint = function (value) {\r\n        if (this._originWalkPoint === undefined) {\r\n            this._originWalkPoint = new Phaser.Geom.Point();\r\n        }\r\n        if (value && value.length > 1) {\r\n            this._originWalkPoint.x = value[0];\r\n            this._originWalkPoint.y = value[1];\r\n        }\r\n    };\r\n    return Sprite;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/sprite.ts?')},"./src/rooms/layer/grid.layer.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GridLayer", function() { return GridLayer; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar GridLayer = /** @class */ (function (_super) {\r\n    __extends(GridLayer, _super);\r\n    function GridLayer(scene) {\r\n        return _super.call(this, scene) || this;\r\n    }\r\n    GridLayer.prototype.draw = function (room) {\r\n        this.clear();\r\n        if (!room || !room.roomSize)\r\n            return;\r\n        this.lineStyle(1, 0xFFFFFF);\r\n        var rows = room.roomSize.rows;\r\n        var cols = room.roomSize.cols;\r\n        for (var i = 0; i <= rows; i++) {\r\n            this.drawLine(room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](0, i)), room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](cols, i)));\r\n        }\r\n        for (var i = 0; i <= cols; i++) {\r\n            this.drawLine(room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](i, 0)), room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](i, rows)));\r\n        }\r\n    };\r\n    GridLayer.prototype.drawLine = function (startPos, endPos) {\r\n        // this.moveTo(startPos.x, startPos.y);\r\n        // this.lineTo(endPos.x, endPos.y);\r\n        this.lineBetween(startPos.x, startPos.y, endPos.x, endPos.y);\r\n    };\r\n    return GridLayer;\r\n}(Phaser.GameObjects.Graphics));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/layer/grid.layer.ts?')},"./src/rooms/layer/layer.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayerManager", function() { return LayerManager; });\n/* harmony import */ var _grid_layer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./grid.layer */ "./src/rooms/layer/grid.layer.ts");\n\r\nvar LayerManager = /** @class */ (function () {\r\n    function LayerManager(room) {\r\n        this.room = room;\r\n        this.mSurfaceInteractived = true;\r\n        this.mDelta = 0;\r\n        this.mScene = room.scene;\r\n        // ==========背景层\r\n        this.mGroundClickLayer = this.mScene.add.container(0, 0);\r\n        // this.totalLayerList.push(this.mGroundClickLayer);\r\n        this.mUGroundLayer2 = this.mScene.add.container(0, 0);\r\n        // ==========舞台层\r\n        this.mGroundLayer = this.mScene.add.container(0, 0);\r\n        this.mTileLayer = new _grid_layer__WEBPACK_IMPORTED_MODULE_0__["GridLayer"](this.mScene);\r\n        this.mScene.sys.displayList.add(this.mTileLayer);\r\n        this.mSurfaceLayer = this.mScene.add.container(0, 0);\r\n        this.mAtmosphere = this.mScene.add.container(0, 0);\r\n        // ==========UI层\r\n        this.mSceneUILayer = this.mScene.add.container(0, 0);\r\n        this.mUILayer = this.mScene.add.container(0, 0).setScrollFactor(0);\r\n        // this.mUILayer.setInteractive(new Geom.Rectangle(0, 0, window.innerWidth, window.innerHeight), Phaser.Geom.Rectangle.Contains);\r\n    }\r\n    LayerManager.prototype.addToGround = function (ele) {\r\n        var tmp = [].concat(ele);\r\n        this.mGroundLayer.add(tmp);\r\n        // this.mGroundLayer.add(Array.from(tmp, (display: ElementDisplay) => display.GameObject));\r\n        // Logger.log("terrain num: ", this.mGroundLayer.list.length);\r\n    };\r\n    LayerManager.prototype.addToSurface = function (ele) {\r\n        var tmp = [].concat(ele);\r\n        this.mSurfaceLayer.add(tmp);\r\n        // Logger.log("surface num: ", this.mSurfaceLayer.list.length);\r\n        // this.mSurfaceLayer.add(Array.from(tmp, (display: ElementDisplay) => display.GameObject));\r\n    };\r\n    LayerManager.prototype.addToSceneToUI = function (child) {\r\n        this.mSceneUILayer.add(child);\r\n    };\r\n    LayerManager.prototype.addToUI = function (child) {\r\n        this.mUILayer.add(child);\r\n    };\r\n    LayerManager.prototype.addToAtmosphere = function (child) {\r\n        this.mAtmosphere.add(child);\r\n    };\r\n    LayerManager.prototype.resize = function (width, height) {\r\n        // todo\r\n    };\r\n    LayerManager.prototype.addMouseListen = function () {\r\n        // this.mGroundClickLayer.setInteractive(new Geom.Rectangle(0, 0, window.innerWidth, window.innerHeight), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    LayerManager.prototype.sortSurface = function () {\r\n        this.mSurfaceLayer.sort("depth");\r\n    };\r\n    LayerManager.prototype.changeScene = function () {\r\n        this._clearLayer();\r\n    };\r\n    LayerManager.prototype.drawGrid = function (room) {\r\n        if (this.mTileLayer) {\r\n            this.mTileLayer.draw(room);\r\n        }\r\n    };\r\n    LayerManager.prototype.setGridVisible = function (visible) {\r\n        if (this.mTileLayer) {\r\n            this.mTileLayer.setVisible(visible);\r\n        }\r\n    };\r\n    LayerManager.prototype.update = function (time, delta) {\r\n        // if (time - this.mDelta < 3000) {\r\n        //     return;\r\n        // }\r\n        this.mDelta = time;\r\n        if (this.mDepthGround) {\r\n            this.mGroundLayer.sort("depth");\r\n            this.mDepthGround = false;\r\n        }\r\n        if (this.mDepthSurface) {\r\n            this.mDepthSurface = false;\r\n            // this.mSurfaceLayer.sort("depth");\r\n            this.mSurfaceLayer.sort("depth", function (displayA, displayB) {\r\n                // Logger.debug(displayA, displayB);\r\n                // const sortA = displayA.sortRectangle;\r\n                // const sortB = displayB.sortRectangle;\r\n                // Logger.log("sort x: ", displayA, displayA.sortX, displayA.sortY);\r\n                // Logger.log("sortB: ", displayB, displayB.sortX, displayB.sortY);\r\n                var angle = Math.atan2((displayA.sortY - displayB.sortY), (displayA.sortX - displayB.sortX));\r\n                if (angle * (180 * Math.PI) >= 70) {\r\n                    return 1;\r\n                }\r\n                // if (displayA.sortY > displayB.sortY) {\r\n                //     return 1;\r\n                // }\r\n                // if (displayB.y + sortB.top.y > displayA.y + sortA.left.y) {\r\n                //     return 1;\r\n                // }\r\n                return -1;\r\n            });\r\n        }\r\n    };\r\n    LayerManager.prototype.setSurfaceInteractive = function (val) {\r\n        if (this.mSurfaceInteractived === val) {\r\n            return;\r\n        }\r\n        this.mSurfaceInteractived = val;\r\n        var list = this.mSurfaceLayer.list;\r\n        if (val) {\r\n            // this.mSurfaceLayer.setInteractive();\r\n            list.forEach(function (obj) {\r\n                obj.setInteractive();\r\n            });\r\n        }\r\n        else {\r\n            list.forEach(function (obj) {\r\n                obj.disableInteractive();\r\n            });\r\n            // this.mSurfaceLayer.disableInteractive();\r\n        }\r\n    };\r\n    LayerManager.prototype.destroy = function () {\r\n        this.mDelta = 0;\r\n        this._clearLayer();\r\n    };\r\n    LayerManager.prototype._clearLayer = function () {\r\n        this.clearLayer(this.mGroundClickLayer);\r\n        this.clearLayer(this.mGroundLayer);\r\n        this.clearLayer(this.mSurfaceLayer);\r\n        this.clearLayer(this.mUGroundLayer2);\r\n        this.clearLayer(this.mUILayer);\r\n        this.clearLayer(this.mAtmosphere);\r\n        this.mTileLayer.destroy(true);\r\n    };\r\n    LayerManager.prototype.clearLayer = function (container, destroy) {\r\n        if (destroy === void 0) { destroy = false; }\r\n        var list = container.list;\r\n        if (list) {\r\n            var len = list.length;\r\n            var child = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                child = list[i];\r\n                if (child) {\r\n                    child.destroy(destroy);\r\n                    child = null;\r\n                }\r\n            }\r\n        }\r\n        container.destroy(destroy);\r\n    };\r\n    Object.defineProperty(LayerManager.prototype, "depthSurfaceDirty", {\r\n        set: function (val) {\r\n            this.mDepthSurface = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerManager.prototype, "depthGroundDirty", {\r\n        set: function (val) {\r\n            this.mDepthGround = val;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerManager.prototype, "layer", {\r\n        get: function () {\r\n            return this.mGroundLayer;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return LayerManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/layer/layer.manager.ts?')},"./src/rooms/map/map.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MapModel", function() { return MapModel; });\n/* harmony import */ var _display_frames_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\nvar MapModel = /** @class */ (function () {\r\n    function MapModel() {\r\n        this.mapId = 1;\r\n        this.zStart = 0; // TODO:\r\n        this.zEnd = 0; // TODO:\r\n        this._mapTotalWidth = 0;\r\n        this._bgSound = 1;\r\n        this._voiceChatRoomId = 0;\r\n        this._mapTotalHeight = 0;\r\n    }\r\n    Object.defineProperty(MapModel.prototype, "bgSound", {\r\n        get: function () {\r\n            return this._bgSound;\r\n        },\r\n        set: function (value) {\r\n            this._bgSound = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "mapTotalWidth", {\r\n        get: function () {\r\n            return this._mapTotalWidth;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "mapTotalHeight", {\r\n        get: function () {\r\n            return this._mapTotalHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "tileWidth", {\r\n        /**\r\n         * 获取格子宽（单位：像素）\r\n         */\r\n        get: function () {\r\n            return this._tileWidth;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "tileHeight", {\r\n        /**\r\n         * 获取格子高（单位：像素）\r\n         */\r\n        get: function () {\r\n            return this._tileHeight;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "terrainConfig", {\r\n        get: function () {\r\n            return this._terrainConfig;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "elementConfig", {\r\n        get: function () {\r\n            return this._elementConfig;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "cols", {\r\n        get: function () {\r\n            return this._cols;\r\n        },\r\n        set: function (value) {\r\n            this._cols = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "rows", {\r\n        get: function () {\r\n            return this._rows;\r\n        },\r\n        set: function (value) {\r\n            this._rows = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MapModel.prototype, "voiceChatRoomId", {\r\n        get: function () {\r\n            return this._voiceChatRoomId;\r\n        },\r\n        set: function (value) {\r\n            this._voiceChatRoomId = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MapModel.prototype.setConfig = function (cols, rows, zStart, zEnd, tileWidth, tileHeight) {\r\n        this._cols = cols; // 水平方向格子数量\r\n        this._rows = rows; // 垂直方向格子数量\r\n        this.zStart = zStart;\r\n        this.zEnd = zEnd;\r\n        this._tileWidth = tileWidth;\r\n        this._tileHeight = tileHeight;\r\n        this._mapTotalWidth = (this._rows + this._cols) * (this._tileWidth / 2);\r\n        this._mapTotalHeight = (this._rows + this._cols) * (this._tileHeight / 2);\r\n    };\r\n    MapModel.prototype.setTerrainInfo = function (value) {\r\n        this._terrainConfig = [];\r\n        var len = value.length;\r\n        var terrain;\r\n        for (var i = 0; i < len; i++) {\r\n            terrain = new _display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"](value[i]);\r\n            this._terrainConfig.push(terrain);\r\n        }\r\n    };\r\n    MapModel.prototype.addTerrainInfo = function (value) {\r\n        var len = value.length;\r\n        var terrain;\r\n        for (var i = 0; i < len; i++) {\r\n            terrain = new _display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"](value[i]);\r\n            this._terrainConfig.push(terrain);\r\n        }\r\n    };\r\n    MapModel.prototype.setElementInfo = function (value) {\r\n        this._elementConfig = [];\r\n        var len = value.length;\r\n        var element;\r\n        for (var i = 0; i < len; i++) {\r\n            element = new _display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"](value[i]);\r\n            this._elementConfig.push(element);\r\n        }\r\n    };\r\n    MapModel.prototype.addElementInfo = function (value) {\r\n        var len = value.length;\r\n        var element;\r\n        for (var i = 0; i < len; i++) {\r\n            element = new _display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"](value[i]);\r\n            this._elementConfig.push(element);\r\n        }\r\n    };\r\n    MapModel.prototype.addPackItems = function (elementId, items) {\r\n        var element = this.getElementInfo(elementId);\r\n        if (element) {\r\n            if (!element.package) {\r\n                element.package = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_gameconfig"].Package.create();\r\n            }\r\n            element.package.items = element.package.items.concat(items);\r\n        }\r\n    };\r\n    MapModel.prototype.removePackItems = function (elementId, itemId) {\r\n        var element = this.getElementInfo(elementId);\r\n        if (element) {\r\n            var len = element.package.items.length;\r\n            for (var i = 0; i < len; i++) {\r\n                if (itemId === element.package.items[i].id) {\r\n                    element.package.items.splice(i, 1);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    MapModel.prototype.getElementInfo = function (value) {\r\n        var len = this._elementConfig.length;\r\n        for (var i = 0; i < len; i++) {\r\n            if (this._elementConfig[i].id === value) {\r\n                return this._elementConfig[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return MapModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/map/map.model.ts?')},"./src/rooms/map/map.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Map", function() { return Map; });\n/* harmony import */ var _map_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./map.model */ "./src/rooms/map/map.model.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Map = /** @class */ (function (_super) {\r\n    __extends(Map, _super);\r\n    function Map(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        _this.emitter = _this.mWorld.emitter;\r\n        _this.mMapModel = new _map_model__WEBPACK_IMPORTED_MODULE_0__["MapModel"]();\r\n        return _this;\r\n    }\r\n    Map.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    Map.prototype.getMapModel = function () {\r\n        return this.mMapModel;\r\n    };\r\n    Map.prototype.register = function () {\r\n    };\r\n    Map.prototype.unRegister = function () {\r\n    };\r\n    Map.prototype.destroy = function () {\r\n        this.mInitialize = false;\r\n        this.mMapModel = null;\r\n        this.emitter = null;\r\n    };\r\n    Map.prototype.setMapInfo = function (value) {\r\n        this.mMapModel.mapId = value.id;\r\n        this.mMapModel.voiceChatRoomId = value.voiceChatRoomId;\r\n        this.mMapModel.setConfig(value.cols, value.rows, value.zStart, value.zEnd, value.tileWidth, value.tileHeight);\r\n        this.mMapModel.setTerrainInfo(value.terrains);\r\n        this.mMapModel.setElementInfo(value.elements);\r\n        if (this.mInitialize === false) {\r\n            this.mInitialize = true;\r\n            this.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SCENE_DATA_INITIALIZE);\r\n        }\r\n    };\r\n    Map.prototype.addPackItems = function (elementId, items) {\r\n        this.mMapModel.addPackItems(elementId, items);\r\n    };\r\n    Map.prototype.removePackItems = function (elementId, itemId) {\r\n        this.mMapModel.removePackItems(elementId, itemId);\r\n    };\r\n    Map.NAME = "Map";\r\n    return Map;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/map/map.ts?')},"./src/rooms/player/Actor.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Actor", function() { return Actor; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _player__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./player */ "./src/rooms/player/player.ts");\n/* harmony import */ var _bag_bag__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bag/bag */ "./src/rooms/player/bag/bag.ts");\n/* harmony import */ var _interactive_interactive__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./interactive/interactive */ "./src/rooms/player/interactive/interactive.ts");\n/* harmony import */ var _friend_friend__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./friend/friend */ "./src/rooms/player/friend/friend.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _ui_ControlF_ControlFMediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/ControlF/ControlFMediator */ "./src/ui/ControlF/ControlFMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Actor = /** @class */ (function (_super) {\r\n    __extends(Actor, _super);\r\n    function Actor(sprite, mElementManager) {\r\n        var _this = _super.call(this, sprite, mElementManager) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mBlockable = false;\r\n        // this.mRenderable = true; // Actor is always renderable!!!\r\n        // this.addDisplay();\r\n        _this.mRoom = _this.mElementManager.roomService;\r\n        _this.mRoom.world.inputManager.addListener(_this);\r\n        // if (this.mElementManager) {\r\n        //     const roomService = this.mElementManager.roomService;\r\n        //     if (roomService && roomService.cameraService) {\r\n        //         roomService.cameraService.startFollow(this.mDisplay);\r\n        //     }\r\n        // }\r\n        _this.mFriend = new _friend_friend__WEBPACK_IMPORTED_MODULE_5__["Friend"](_this.mRoom.world);\r\n        _this.mRoom.playerManager.set(_this.id, _this);\r\n        _this.mInteractive = new _interactive_interactive__WEBPACK_IMPORTED_MODULE_4__["Interactive"](mElementManager.roomService.world);\r\n        _this.mInteractive.register();\r\n        return _this;\r\n    }\r\n    Actor.prototype.getBag = function () {\r\n        return this.mBag;\r\n    };\r\n    Actor.prototype.getFriend = function () {\r\n        return this.mFriend;\r\n    };\r\n    Actor.prototype.getInteractive = function () {\r\n        return this.mInteractive;\r\n    };\r\n    // override super\'s method.\r\n    Actor.prototype.setRenderable = function (isRenderable) {\r\n        // do nothing!\r\n        // Actor is always renderable!!!\r\n    };\r\n    Actor.prototype.destroy = function () {\r\n        if (this.mBag) {\r\n            this.mBag.destroy();\r\n            this.mBag = null;\r\n        }\r\n        this.mRoom.world.inputManager.removeListener(this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Actor.prototype.downHandler = function (d, keyList) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mRoom.playerManager.requestActorMove(d, keyList); // startActorMove();\r\n    };\r\n    Actor.prototype.upHandler = function () {\r\n        // this.mRoom.playerManager.stopActorMove();\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.stopMove();\r\n    };\r\n    Actor.prototype.startMove = function () {\r\n        _super.prototype.startMove.call(this);\r\n        var med = this.mRoom.world.uiManager.getMediator(_ui_ControlF_ControlFMediator__WEBPACK_IMPORTED_MODULE_7__["ControlFMediator"].NAME);\r\n        if (med)\r\n            med.hide();\r\n    };\r\n    Actor.prototype.stopMove = function () {\r\n        _super.prototype.stopMove.call(this);\r\n        if (this.mMoveData && this.mMoveData.destPos) {\r\n            if (this.mMoveData.destPos) {\r\n                // Logger.getInstance().debug("moveData:" + this.mMoveData.destPos.x + "," + this.mMoveData.destPos.y);\r\n            }\r\n            else {\r\n                // Logger.getInstance().error("no destPos");\r\n            }\r\n            delete this.mMoveData.destPos;\r\n            if (this.mMoveData.arrivalTime)\r\n                this.mMoveData.arrivalTime = 0;\r\n            if (this.mMoveData.tweenAnim) {\r\n                this.mMoveData.tweenAnim.stop();\r\n                this.mMoveData.tweenAnim.remove();\r\n            }\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_STOP_SPRITE);\r\n        var ct = pkt.content;\r\n        ct.nodeType = this.nodeType;\r\n        var pos = this.getPosition();\r\n        ct.spritePositions = {\r\n            id: this.id,\r\n            point3f: {\r\n                x: pos.x,\r\n                y: pos.y - this.offsetY,\r\n                z: pos.z,\r\n            },\r\n            direction: this.dir\r\n        };\r\n        // Logger.getInstance().debug("nowPox:" + pos.x + "," + pos.y);\r\n        this.mElementManager.connection.send(pkt);\r\n    };\r\n    Actor.prototype.move = function (moveData) {\r\n        // TODO 不能仅判断walk, 移动状态可能还有run\r\n        if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n            return;\r\n        }\r\n        _super.prototype.move.call(this, moveData);\r\n    };\r\n    Actor.prototype.onMoveStart = function () {\r\n    };\r\n    Actor.prototype.onMoveComplete = function () {\r\n        if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n            this.mMoveData.tweenAnim.stop();\r\n            return;\r\n        }\r\n        this._doMove();\r\n    };\r\n    Actor.prototype.onMoving = function () {\r\n        if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n            this.mMoveData.tweenAnim.stop();\r\n            return;\r\n        }\r\n        _super.prototype.onMoving.call(this);\r\n    };\r\n    Actor.prototype.addToBlock = function () {\r\n        this.addDisplay();\r\n    };\r\n    Object.defineProperty(Actor.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.mModel = val;\r\n            if (!val) {\r\n                return;\r\n            }\r\n            if (val.package) {\r\n                this.mPackage = val.package;\r\n                this.mBag = new _bag_bag__WEBPACK_IMPORTED_MODULE_3__["Bag"](this.mElementManager.roomService.world);\r\n                this.mBag.register();\r\n            }\r\n            this.load(this.mModel.displayInfo);\r\n            if (this.mModel.pos)\r\n                this.setPosition(this.mModel.pos);\r\n            this.mDisplay.changeAlpha(this.mModel.alpha);\r\n            if (this.mModel.nickname)\r\n                this.mDisplay.showNickname(this.mModel.nickname);\r\n            this.setDirection(this.mModel.direction);\r\n            if (this.mElementManager) {\r\n                var roomService = this.mElementManager.roomService;\r\n                if (roomService && roomService.cameraService) {\r\n                    roomService.cameraService.startFollow(this.mDisplay);\r\n                }\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, "package", {\r\n        get: function () {\r\n            return this.mPackage;\r\n        },\r\n        set: function (value) {\r\n            this.mPackage = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Actor;\r\n}(_player__WEBPACK_IMPORTED_MODULE_2__["Player"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/Actor.ts?')},"./src/rooms/player/bag/bag.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bag", function() { return Bag; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Bag = /** @class */ (function (_super) {\r\n    __extends(Bag, _super);\r\n    function Bag(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ADD_ITEM, _this.handleAddItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_REMOVE_ITEM, _this.handleRemoveItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EXCHANGE_ITEM_POS, _this.handleExchangeItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QUERY_PACKAGE, _this.handleQueryPackage);\r\n        return _this;\r\n    }\r\n    Bag.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    Bag.prototype.register = function () {\r\n        this.mWorld.connection.addPacketListener(this);\r\n    };\r\n    Bag.prototype.unRegister = function () {\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Bag.prototype.destroy = function () {\r\n        this.mInitialize = false;\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Bag.prototype.requestVirtualWorldQueryPackage = function (bagId, page, perPage) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = bagId;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    Bag.prototype.handleQueryPackage = function (packet) {\r\n        var notice = packet.content;\r\n        this.mInitialize = true;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].QUERY_PACKAGE, notice);\r\n    };\r\n    Bag.prototype.handleAddItem = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodetype === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.ElementNodeType) {\r\n            this.mWorld.roomManager.currentRoom.map.addPackItems(content.id, content.item);\r\n        }\r\n        else if (content.nodetype === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            this.mWorld.roomManager.currentRoom.playerManager.addPackItems(content.id, content.item);\r\n        }\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, content);\r\n    };\r\n    Bag.prototype.handleRemoveItem = function (packet) {\r\n        var content = packet.content;\r\n        var len = content.itemId.length;\r\n        for (var i = 0; i < len; i++) {\r\n            this.mWorld.roomManager.currentRoom.playerManager.removePackItems(content.id, content.itemId[i]);\r\n        }\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE);\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_REMOVE, content);\r\n    };\r\n    Bag.prototype.handleExchangeItem = function (packet) {\r\n        var content = packet.content;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_EXCHANGE_ITEM_POS, content);\r\n    };\r\n    return Bag;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/bag/bag.ts?')},"./src/rooms/player/friend/friend.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Friend", function() { return Friend; });\nvar Friend = /** @class */ (function () {\r\n    function Friend(world) {\r\n        this.world = world;\r\n        this.mFriendList = [];\r\n    }\r\n    Friend.prototype.requestFriend = function (callBack) {\r\n        var func = callBack;\r\n        this.world.httpService.firend().then(function (response) {\r\n            if (response.code === 200) {\r\n                if (func)\r\n                    func(response.data);\r\n            }\r\n        });\r\n    };\r\n    Friend.prototype.friendList = function () {\r\n        return this.mFriendList || [];\r\n    };\r\n    return Friend;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/friend/friend.ts?')},"./src/rooms/player/interactive/interactive.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Interactive", function() { return Interactive; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Interactive = /** @class */ (function (_super) {\r\n    __extends(Interactive, _super);\r\n    function Interactive(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        return _this;\r\n    }\r\n    Interactive.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    Interactive.prototype.register = function () {\r\n        this.mWorld.connection.addPacketListener(this);\r\n    };\r\n    Interactive.prototype.unRegister = function () {\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Interactive.prototype.destroy = function () {\r\n        this.mInitialize = false;\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Interactive.prototype.requestTargetUI = function (uiId, id) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = uiId;\r\n        content.componentId = id;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    return Interactive;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/interactive/interactive.ts?')},"./src/rooms/player/player.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerManager", function() { return PlayerManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _player__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./player */ "./src/rooms/player/player.ts");\n/* harmony import */ var _Actor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Actor */ "./src/rooms/player/Actor.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\nvar PlayerManager = /** @class */ (function (_super) {\r\n    __extends(PlayerManager, _super);\r\n    function PlayerManager(mRoom) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mPlayerMap = new Map();\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION, _this.onAdjust);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE, _this.onMove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_EFFECT, _this.onShowEffect);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE, _this.onOnlyBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, _this.onShowBubble);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN, _this.onClearBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION, _this.onSetPosition);\r\n        }\r\n        return _this;\r\n    }\r\n    PlayerManager.prototype.createActor = function (playModel) {\r\n        this.mActor = new _Actor__WEBPACK_IMPORTED_MODULE_7__["Actor"](playModel, this);\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "actor", {\r\n        get: function () {\r\n            return this.mActor;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    PlayerManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mPlayerMap)\r\n            return;\r\n        this.mPlayerMap.forEach(function (player) { return _this.removeFromMap(player.id); });\r\n        this.mPlayerMap.clear();\r\n    };\r\n    PlayerManager.prototype.removeFromMap = function (id) {\r\n        var player = this.mPlayerMap.get(id);\r\n        if (player) {\r\n            this.mPlayerMap.delete(id);\r\n            player.destroy();\r\n        }\r\n    };\r\n    PlayerManager.prototype.requestActorMove = function (dir, keyArr) {\r\n        this.startActorMove();\r\n        if (!this.roomService.world.game.device.os.desktop) {\r\n            // 按下键盘的时候已经发了一次了，如果再发一次后端会有问题\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n            var content = pkt.content;\r\n            content.keyCodes = keyArr;\r\n            this.connection.send(pkt);\r\n        }\r\n    };\r\n    PlayerManager.prototype.startActorMove = function () {\r\n        if (!this.mActor) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("MainHero miss");\r\n            return;\r\n        }\r\n        this.mActor.startMove();\r\n    };\r\n    PlayerManager.prototype.stopActorMove = function () {\r\n        if (!this.mActor) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("MainHero miss");\r\n            return;\r\n        }\r\n        this.mActor.stopMove();\r\n    };\r\n    PlayerManager.prototype.get = function (id) {\r\n        if (!this.mPlayerMap) {\r\n            return;\r\n        }\r\n        var player = this.mPlayerMap.get(id);\r\n        if (!player) {\r\n            var actor = this.mActor;\r\n            if (actor && actor.id === id) {\r\n                player = actor;\r\n            }\r\n        }\r\n        return player;\r\n    };\r\n    PlayerManager.prototype.add = function (sprite) {\r\n    };\r\n    PlayerManager.prototype.remove = function (id) {\r\n        var element = this.mPlayerMap.get(id);\r\n        if (element) {\r\n            this.mPlayerMap.delete(id);\r\n            element.destroy();\r\n        }\r\n        if (this.mActor) {\r\n            this.mActor.destroy();\r\n            this.mActor = null;\r\n        }\r\n        return element;\r\n    };\r\n    PlayerManager.prototype.getElements = function () {\r\n        return Array.from(this.mPlayerMap.values());\r\n    };\r\n    PlayerManager.prototype.set = function (id, player) {\r\n        if (!this.mPlayerMap) {\r\n            this.mPlayerMap = new Map();\r\n        }\r\n        this.mPlayerMap.set(id, player);\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mRoom.cameraService.camera;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // public addPlayer(obj: op_client.IActor): void {\r\n    //     const playerInfo: PlayerInfo = new PlayerInfo();\r\n    //     playerInfo.setInfo(obj);\r\n    //     if (obj.walkOriginPoint) {\r\n    //         playerInfo.setOriginWalkPoint(obj.walkOriginPoint);\r\n    //     }\r\n    //     if (obj.originPoint) {\r\n    //         playerInfo.setOriginCollisionPoint(obj.originPoint);\r\n    //     }\r\n    //     this.mPlayerInfoList.push(playerInfo);\r\n    //     this.mModelDispatch.emit(MessageType.SCENE_ADD_PLAYER, playerInfo);\r\n    // }\r\n    PlayerManager.prototype.addPackItems = function (elementId, items) {\r\n        var character = this.mPlayerMap.get(elementId);\r\n        if (character && character.id === this.mActor.id) {\r\n            if (!character.package) {\r\n                character.package = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_gameconfig"].Package.create();\r\n            }\r\n            character.package.items = character.package.items.concat(items);\r\n            this.mRoom.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_5__["MessageType"].UPDATED_CHARACTER_PACKAGE);\r\n        }\r\n    };\r\n    PlayerManager.prototype.removePackItems = function (elementId, itemId) {\r\n        var character = this.mPlayerMap.get(elementId);\r\n        if (character && this.mActor.id) {\r\n            var itemList = character.package.items;\r\n            var len = itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                if (itemId === itemList[i].id) {\r\n                    itemList.splice(i, 1);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    PlayerManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var player = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            player = this.get(sprite.id);\r\n            if (player) {\r\n                player.model = new _element_sprite__WEBPACK_IMPORTED_MODULE_4__["Sprite"](sprite);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onAdjust = function (packet) {\r\n        var content = packet.content;\r\n        var positions = content.spritePositions;\r\n        var type = content.nodeType;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        if (this.mActor) {\r\n            var player = void 0;\r\n            var point = void 0;\r\n            for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n                var position = positions_1[_i];\r\n                player = this.mPlayerMap.get(position.id);\r\n                if (!player) {\r\n                    if (position.id === this.mActor.id) {\r\n                        player = this.mActor;\r\n                    }\r\n                    else {\r\n                        continue;\r\n                    }\r\n                }\r\n                point = position.point3f;\r\n                player.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](point.x || 0, point.y || 0, point.z || 0));\r\n                // Logger.getInstance().debug(`adjust,x:${point.x},y:${point.y}`);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onAdd = function (packet) {\r\n        if (!this.mPlayerMap) {\r\n            this.mPlayerMap = new Map();\r\n        }\r\n        var content = packet.content;\r\n        var sprites = content.sprites;\r\n        var type = content.nodeType;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            this._add(new _element_sprite__WEBPACK_IMPORTED_MODULE_4__["Sprite"](sprite));\r\n        }\r\n    };\r\n    PlayerManager.prototype._add = function (sprite) {\r\n        if (!this.mPlayerMap)\r\n            this.mPlayerMap = new Map();\r\n        if (!this.mPlayerMap.has(sprite.id)) {\r\n            var player = new _player__WEBPACK_IMPORTED_MODULE_6__["Player"](sprite, this);\r\n            this.mPlayerMap.set(player.id || 0, player);\r\n        }\r\n    };\r\n    PlayerManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    PlayerManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.removeFromMap(id);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onMove = function (packet) {\r\n        var content = packet.content;\r\n        if (content.moveData) {\r\n            var moveDataList = content.moveData;\r\n            var len = moveDataList.length;\r\n            var type = content.nodeType || null;\r\n            var moveData = void 0;\r\n            var playID = void 0;\r\n            var player = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                moveData = moveDataList[i];\r\n                playID = moveData.moveObjectId;\r\n                player = this.get(playID);\r\n                // Console.log(player.x + "," + player.y + ":" + moveData.destinationPoint3f.x + "," + moveData.destinationPoint3f.y + ":" + moveData.timeSpan);\r\n                if (!player) {\r\n                    continue;\r\n                }\r\n                player.move(moveData);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onSetPosition = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var id = content.id;\r\n        if (type !== NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var role = this.get(id);\r\n        if (!role) {\r\n            role = this.mActor;\r\n        }\r\n        role.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](content.position.x, content.position.y, content.position.z));\r\n    };\r\n    PlayerManager.prototype.onShowBubble = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.chatSenderid);\r\n        if (player) {\r\n            player.showBubble(content.chatContext, content.chatSetting);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onOnlyBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.receiverid);\r\n        if (player) {\r\n            player.showBubble(content.context, content.chatsetting);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onClearBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.receiverid);\r\n        if (player) {\r\n            player.clearBubble();\r\n        }\r\n    };\r\n    PlayerManager.prototype.onShowEffect = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.id;\r\n        var player;\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            player = this.get(id);\r\n            if (player) {\r\n                player.showEffected();\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var anis = content.changeAnimation;\r\n        var player = null;\r\n        for (var _i = 0, anis_1 = anis; _i < anis_1.length; _i++) {\r\n            var ani = anis_1[_i];\r\n            player = this.get((ani.id));\r\n            if (player) {\r\n                player.play(ani.animationName);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PlayerManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PlayerManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room is undefined");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return PlayerManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.manager.ts?')},"./src/rooms/player/player.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerModel", function() { return PlayerModel; });\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PlayerModel = /** @class */ (function (_super) {\r\n    __extends(PlayerModel, _super);\r\n    function PlayerModel(data) {\r\n        var _this = _super.call(this, data) || this;\r\n        _this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](data.x, data.y, data.z);\r\n        _this.mAlpha = 1;\r\n        _this.mWalkableArea = data.walkableArea;\r\n        _this.mCollisionArea = data.collisionArea;\r\n        _this.mOriginPoint = data.originPoint;\r\n        _this.mWalkOriginPoint = data.walkOriginPoint;\r\n        _this.mSlot = data.slot;\r\n        _this.mMaxNum = data.maxNum;\r\n        _this.mCamp = data.camp;\r\n        _this.mAttributes = data.attributes;\r\n        _this.mPackage = data.package;\r\n        _this.mSceneId = data.sceneId;\r\n        _this.mUuid = data.uuid;\r\n        _this.mPlatformId = data.platformId;\r\n        return _this;\r\n    }\r\n    return PlayerModel;\r\n}(_element_sprite__WEBPACK_IMPORTED_MODULE_0__["Sprite"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.model.ts?')},"./src/rooms/player/player.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Player", function() { return Player; });\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Player = /** @class */ (function (_super) {\r\n    __extends(Player, _super);\r\n    function Player(sprite, mElementManager) {\r\n        var _this = _super.call(this, sprite, mElementManager) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType;\r\n        _this.mOffsetY = undefined;\r\n        if (_this.mDisplay) {\r\n            if (sprite.displayBadgeCards && sprite.displayBadgeCards.length > 0)\r\n                _this.mDisplay.setDisplayBadges(sprite.displayBadgeCards);\r\n        }\r\n        return _this;\r\n    }\r\n    Player.prototype.setModel = function (val) {\r\n        _super.prototype.setModel.call(this, val);\r\n        this.showNickName();\r\n    };\r\n    Player.prototype.move = function (moveData) {\r\n        if (this.getDirection() !== moveData.direction && this.mId !== this.roomService.playerManager.actor.id) {\r\n            this.setDirection(moveData.direction);\r\n        }\r\n        moveData.destinationPoint3f.y += this.offsetY;\r\n        _super.prototype.move.call(this, moveData);\r\n    };\r\n    Player.prototype.setDirection = function (dir) {\r\n        if (dir !== this.mDisplayInfo.avatarDir) {\r\n            this.mDisplayInfo.avatarDir = dir;\r\n            if (this.mDisplay)\r\n                this.mDisplay.play(this.mCurState);\r\n        }\r\n    };\r\n    Player.prototype.changeState = function (val) {\r\n        if (this.mCurState === val)\r\n            return;\r\n        if (!val)\r\n            val = _element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].IDLE;\r\n        if (this.mCheckStateHandle(val)) {\r\n            this.mCurState = val;\r\n            this.mDisplay.play(val);\r\n        }\r\n    };\r\n    Player.prototype.setPosition = function (pos) {\r\n        pos.y += this.offsetY;\r\n        _super.prototype.setPosition.call(this, pos);\r\n    };\r\n    Player.prototype.onMoveStart = function () {\r\n        this.changeState(_element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].WALK);\r\n    };\r\n    Player.prototype.onMoveComplete = function () {\r\n        _super.prototype.onMoveComplete.call(this);\r\n        this.changeState(_element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].IDLE);\r\n    };\r\n    Object.defineProperty(Player.prototype, "offsetY", {\r\n        get: function () {\r\n            if (this.mOffsetY === undefined) {\r\n                if (!this.mElementManager || !this.mElementManager.roomService || !this.mElementManager.roomService.roomSize) {\r\n                    return 0;\r\n                }\r\n                this.mOffsetY = this.mElementManager.roomService.roomSize.tileHeight >> 2;\r\n            }\r\n            return this.mOffsetY;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Player.prototype.mCheckStateHandle = function (val) {\r\n        // if (this.mCurState === val) return false;\r\n        return true;\r\n    };\r\n    return Player;\r\n}(_element_element__WEBPACK_IMPORTED_MODULE_0__["Element"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.ts?')},"./src/rooms/player/slot.info.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SlotInfo", function() { return SlotInfo; });\nvar SlotInfo = /** @class */ (function () {\r\n    function SlotInfo() {\r\n    }\r\n    return SlotInfo;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/slot.info.ts?')},"./src/rooms/room.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomManager", function() { return RoomManager; });\n/* harmony import */ var _room__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./room */ "./src/rooms/room.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _editor_room__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editor.room */ "./src/rooms/editor.room.ts");\n/* harmony import */ var _decorate_room__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./decorate.room */ "./src/rooms/decorate.room.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar RoomManager = /** @class */ (function (_super) {\r\n    __extends(RoomManager, _super);\r\n    function RoomManager(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRooms = [];\r\n        _this.mWorld = world;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ENTER_SCENE, _this.onEnterSceneHandler);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_CHANGE_TO_EDITOR_MODE, _this.onEnterEditor);\r\n        return _this;\r\n        // this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_READY, this.onEnterDecorate);\r\n    }\r\n    RoomManager.prototype.addPackListener = function () {\r\n        if (this.connection) {\r\n            this.connection.addPacketListener(this);\r\n        }\r\n    };\r\n    RoomManager.prototype.removePackListener = function () {\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    RoomManager.prototype.getRoom = function (id) {\r\n        // const idx = this.mRooms.findIndex((room: Room, index: number) => id === room.id);\r\n        // if (idx >= 0) {\r\n        //     return this.mRooms[idx];\r\n        // }\r\n        return this.mRooms.find(function (room) {\r\n            return room.id === id;\r\n        });\r\n    };\r\n    RoomManager.prototype.onFocus = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.resume(room.scene.scene.key);\r\n        });\r\n    };\r\n    RoomManager.prototype.onBlur = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.pause();\r\n        });\r\n    };\r\n    RoomManager.prototype.pasuseRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        if (idx >= 0) {\r\n            var room = this.mRooms[idx];\r\n            room.pause();\r\n        }\r\n    };\r\n    RoomManager.prototype.resumeRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        if (idx >= 0) {\r\n            var room = this.mRooms[idx];\r\n            if (room && room.scene)\r\n                room.resume(room.scene.scene.key);\r\n        }\r\n    };\r\n    RoomManager.prototype.stop = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.destroy();\r\n        });\r\n    };\r\n    RoomManager.prototype.resize = function (width, height) {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room)\r\n                room.resize(width, height);\r\n        });\r\n    };\r\n    RoomManager.prototype.destroy = function () {\r\n        this.removePackListener();\r\n        for (var _i = 0, _a = this.mRooms; _i < _a.length; _i++) {\r\n            var room = _a[_i];\r\n            room.destroy();\r\n            room = null;\r\n        }\r\n        this.mRooms.length = 0;\r\n    };\r\n    RoomManager.prototype.hasRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        return idx >= 0;\r\n    };\r\n    RoomManager.prototype.onEnterScene = function (scene) {\r\n        // this.destroy();\r\n        var vw = scene;\r\n        var room;\r\n        if (this.hasRoom(vw.scene.id)) {\r\n            room = this.getRoom(vw.scene.id);\r\n        }\r\n        else {\r\n            if (this.mCurRoom) {\r\n                this.leaveScene(this.mCurRoom);\r\n            }\r\n            room = new _room__WEBPACK_IMPORTED_MODULE_0__["Room"](this);\r\n            this.mRooms.push(room);\r\n        }\r\n        room.addActor(vw.actor);\r\n        room.enter(vw.scene);\r\n        // this.mWorld.changeRoom(room);\r\n        this.mCurRoom = room;\r\n    };\r\n    RoomManager.prototype.onEnterDecorate = function (scene) {\r\n        // const { rows, cols, tileWidth, tileHeight } = this.mCurRoom.roomSize;\r\n        // const elements = this.mCurRoom.elementManager.getElements().map((ele: IElement) => ele.model);\r\n        // const terrains = this.mCurRoom.terrainManager.getElements().map((ele: IElement) => ele.model);\r\n        // const scene = {\r\n        //     id: this.mCurRoom.id,\r\n        //     rows,\r\n        //     cols,\r\n        //     tileWidth,\r\n        //     tileHeight\r\n        // };\r\n        if (this.mCurRoom) {\r\n            this.leaveScene(this.mCurRoom);\r\n        }\r\n        var room = new _decorate_room__WEBPACK_IMPORTED_MODULE_5__["DecorateRoom"](this);\r\n        room.enter(scene.scene);\r\n        // setTimeout(() => {\r\n        //     room.addElements(elements, op_def.NodeType.ElementNodeType);\r\n        //     room.addElements(terrains, op_def.NodeType.TerrainNodeType);\r\n        // }, 1000);\r\n        this.mRooms.push(room);\r\n        this.mCurRoom = room;\r\n    };\r\n    RoomManager.prototype.onEditRoom = function (packet) {\r\n        var content = packet.content;\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("edit: ", content);\r\n    };\r\n    RoomManager.prototype.onEnterEditor = function (packet) {\r\n        var content = packet.content;\r\n        var room = new _editor_room__WEBPACK_IMPORTED_MODULE_4__["EditorRoom"](this);\r\n        room.enter(content.scene);\r\n        this.mCurRoom = room;\r\n        this.mRooms.push(room);\r\n    };\r\n    RoomManager.prototype.leaveScene = function (room) {\r\n        if (!room)\r\n            return;\r\n        this.mRooms = this.mRooms.filter(function (r) { return r.id !== room.id; });\r\n        room.destroy();\r\n    };\r\n    RoomManager.prototype.onEnterSceneHandler = function (packet) {\r\n        var content = packet.content;\r\n        var scene = content.scene;\r\n        switch (scene.sceneType) {\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.NORMAL_SCENE_TYPE:\r\n                this.onEnterScene(content);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE:\r\n                this.onEnterDecorate(content);\r\n                break;\r\n        }\r\n    };\r\n    Object.defineProperty(RoomManager.prototype, "world", {\r\n        get: function () {\r\n            return this.mWorld;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomManager.prototype, "currentRoom", {\r\n        get: function () {\r\n            return this.mCurRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mWorld) {\r\n                return this.mWorld.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("world manager is undefined");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return RoomManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/room.manager.ts?')},"./src/rooms/room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Room", function() { return Room; });\n/* harmony import */ var _element_element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element/element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _player_player_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./player/player.manager */ "./src/rooms/player/player.manager.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _terrain_terrain_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./terrain/terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./cameras/cameras.manager */ "./src/rooms/cameras/cameras.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _scenes_play__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../scenes/play */ "./src/scenes/play.ts");\n/* harmony import */ var _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./cameras/viewblock.manager */ "./src/rooms/cameras/viewblock.manager.ts");\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _map_map__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./map/map */ "./src/rooms/map/map.ts");\n/* harmony import */ var _player_player_model__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./player/player.model */ "./src/rooms/player/player.model.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// 这一层管理数据和Phaser之间的逻辑衔接\r\n// 消息处理让上层[RoomManager]处理\r\nvar Room = /** @class */ (function (_super) {\r\n    __extends(Room, _super);\r\n    function Room(manager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.manager = manager;\r\n        _this.mEnableEdit = false;\r\n        _this.mWorld = _this.manager.world;\r\n        _this.mCameraService = new _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_6__["CamerasManager"](_this);\r\n        if (_this.mWorld) {\r\n            var size = _this.mWorld.getSize();\r\n            if (size) {\r\n                _this.mCameraService.resize(size.width, size.height);\r\n            }\r\n            else {\r\n                throw new Error("World::getSize undefined!");\r\n            }\r\n            if (_this.connection) {\r\n                _this.connection.addPacketListener(_this);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_EDIT_MODE, _this.onEnableEditModeHandler);\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    Room.prototype.enter = function (data) {\r\n        var size = this.mWorld.getSize();\r\n        if (!data) {\r\n            // Logger.getInstance().error("wrong room");\r\n            return;\r\n        }\r\n        this.mID = data.id;\r\n        this.mSize = {\r\n            cols: data.cols,\r\n            rows: data.rows,\r\n            tileHeight: data.tileHeight,\r\n            tileWidth: data.tileWidth,\r\n            sceneWidth: (data.rows + data.cols) * (data.tileWidth / 2),\r\n            sceneHeight: (data.rows + data.cols) * (data.tileHeight / 2)\r\n        };\r\n        this.mMap = new _map_map__WEBPACK_IMPORTED_MODULE_11__["Map"](this.mWorld);\r\n        this.mMap.setMapInfo(data);\r\n        if (!this.mWorld.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_10__["LoadingScene"].name))\r\n            this.mWorld.game.scene.add(_scenes_loading__WEBPACK_IMPORTED_MODULE_10__["LoadingScene"].name, _scenes_loading__WEBPACK_IMPORTED_MODULE_10__["LoadingScene"]);\r\n        this.mWorld.game.scene.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_10__["LoadingScene"].name, {\r\n            world: this.world,\r\n            room: this\r\n        });\r\n    };\r\n    Room.prototype.onFullPacketReceived = function (sprite_t) {\r\n        if (sprite_t !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n    };\r\n    Room.prototype.onClockReady = function () {\r\n        // TODO: Unload loading-scene\r\n    };\r\n    Room.prototype.startLoad = function () { };\r\n    Room.prototype.completeLoad = function () {\r\n        this.mWorld.game.scene.add(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, _scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"], true, {\r\n            room: this\r\n        });\r\n    };\r\n    Room.prototype.startPlay = function () {\r\n        if (this.mLayManager) {\r\n            this.layerManager.destroy();\r\n        }\r\n        this.mScene = this.world.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.mTerainManager = new _terrain_terrain_manager__WEBPACK_IMPORTED_MODULE_3__["TerrainManager"](this, this);\r\n        this.mElementManager = new _element_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"](this);\r\n        this.mPlayerManager = new _player_player_manager__WEBPACK_IMPORTED_MODULE_1__["PlayerManager"](this);\r\n        this.mBlocks = new _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_9__["ViewblockManager"](this.mCameraService);\r\n        this.mLayManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__["LayerManager"](this);\r\n        if (this.scene) {\r\n            this.mCameraService.camera = this.scene.cameras.main;\r\n            // init block\r\n            this.mBlocks.int(this.mSize);\r\n        }\r\n        this.mPlayerManager.createActor(new _player_player_model__WEBPACK_IMPORTED_MODULE_12__["PlayerModel"](this.mActorData));\r\n        // this.mActor = new Actor(, this.mPlayerManager);\r\n        var loadingScene = this.mWorld.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_10__["LoadingScene"].name);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_14__["MessageType"].PRESS_ELEMENT, this.onPressElementHandler, this);\r\n        if (loadingScene)\r\n            loadingScene.sleep();\r\n        this.world.changeRoom(this);\r\n        if (this.world.uiManager)\r\n            this.world.uiManager.showMainUI();\r\n        if (this.connection) {\r\n            this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        }\r\n        // this.mWorld.inputManager.enable = true;\r\n    };\r\n    Room.prototype.pause = function () {\r\n        if (this.mScene)\r\n            this.mScene.scene.pause();\r\n        this.mWorld.inputManager.enable = false;\r\n        // this.clockSyncComplete = false;\r\n        // todo launch\r\n    };\r\n    Room.prototype.resume = function (name) {\r\n        if (this.mScene)\r\n            this.mScene.scene.resume(name);\r\n        this.mWorld.inputManager.enable = true;\r\n        // this.mClock.sync(-1);\r\n    };\r\n    Room.prototype.addActor = function (data) {\r\n        this.mActorData = data;\r\n        // const playerDataModel = this.mWorld.modelManager.getModel(PlayerDataModel.NAME) as PlayerDataModel;\r\n        // playerDataModel.setmainPlayerInfo(data);\r\n    };\r\n    Room.prototype.addBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.add(object);\r\n        }\r\n    };\r\n    Room.prototype.removeBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.remove(object);\r\n        }\r\n    };\r\n    Room.prototype.updateBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.check(object);\r\n        }\r\n    };\r\n    Room.prototype.addToGround = function (element) {\r\n        this.layerManager.addToGround(element);\r\n    };\r\n    Room.prototype.addToSurface = function (element) {\r\n        this.layerManager.addToSurface(element);\r\n    };\r\n    Room.prototype.addToSceneUI = function (element) {\r\n        this.layerManager.addToSceneToUI(element);\r\n    };\r\n    Room.prototype.addToUI = function (element) {\r\n        this.layerManager.addToUI(element);\r\n    };\r\n    Room.prototype.resize = function (width, height) {\r\n        if (this.layerManager)\r\n            this.layerManager.resize(width, height);\r\n        if (this.mCameraService)\r\n            this.mCameraService.resize(width, height);\r\n    };\r\n    Room.prototype.transformTo90 = function (p) {\r\n        if (!this.mSize) {\r\n            // Logger.getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo90(p, this.mSize);\r\n    };\r\n    Room.prototype.transformTo45 = function (p) {\r\n        if (!this.mSize) {\r\n            // Logger.getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo45(p, this.mSize);\r\n    };\r\n    Room.prototype.addMouseListen = function () {\r\n        this.layerManager.addMouseListen();\r\n    };\r\n    Room.prototype.update = function (time, delta) {\r\n        // 角色管理器和地块，物件管理器中在登陆时，add_sprite完成后，把交互管理器的交互开放\r\n        // if (this.mPlayerManager.hasAddComplete && this.mTerainManager.hasAddComplete && this.mElementManager.hasAddComplete) {\r\n        //   if (this.mWorld.inputManager.enable === false && this.world.game.loop.actualFps >= 20) {\r\n        //     this.mWorld.inputManager.enable = true;\r\n        //   }\r\n        // }\r\n        this.updateClock(time, delta);\r\n        this.mBlocks.update(time, delta);\r\n        // this.startCheckBlock();\r\n        if (this.layerManager)\r\n            this.layerManager.update(time, delta);\r\n    };\r\n    Room.prototype.updateClock = function (time, delta) {\r\n        // 客户端自己通过delta来更新游戏时间戳\r\n        if (this.mWorld.clock)\r\n            this.mWorld.clock.update(time, delta);\r\n    };\r\n    Room.prototype.now = function () {\r\n        return this.mWorld.clock.unixTime;\r\n    };\r\n    Object.defineProperty(Room.prototype, "scene", {\r\n        get: function () {\r\n            return this.mScene || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "terrainManager", {\r\n        get: function () {\r\n            return this.mTerainManager || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "playerManager", {\r\n        get: function () {\r\n            return this.mPlayerManager || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "map", {\r\n        get: function () {\r\n            return this.mMap;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "layerManager", {\r\n        get: function () {\r\n            return this.mLayManager || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "cameraService", {\r\n        get: function () {\r\n            return this.mCameraService || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "roomSize", {\r\n        get: function () {\r\n            return this.mSize || undefined;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "blocks", {\r\n        get: function () {\r\n            return this.mBlocks;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "world", {\r\n        get: function () {\r\n            return this.mWorld;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "connection", {\r\n        get: function () {\r\n            if (this.manager) {\r\n                return this.manager.connection;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Room.prototype.clear = function () {\r\n        if (this.mLayManager)\r\n            this.mLayManager.destroy();\r\n        if (this.mTerainManager)\r\n            this.mTerainManager.destroy();\r\n        if (this.mElementManager)\r\n            this.mElementManager.destroy();\r\n        if (this.mPlayerManager)\r\n            this.mPlayerManager.destroy();\r\n        if (this.mBlocks)\r\n            this.mBlocks.destroy();\r\n        if (this.mActorData) {\r\n            this.mActorData = null;\r\n        }\r\n    };\r\n    Room.prototype.destroy = function () {\r\n        this.clear();\r\n        if (this.connection)\r\n            this.connection.removePacketListener(this);\r\n        this.mWorld.game.scene.remove(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_14__["MessageType"].PRESS_ELEMENT, this.onPressElementHandler, this);\r\n        // if (this.mScene) {\r\n        //   this.mScene = null;\r\n        // }\r\n    };\r\n    Room.prototype.onPressElementHandler = function (pointer, gameObject) {\r\n        if (!gameObject || !gameObject.parentContainer) {\r\n            return;\r\n        }\r\n        var com = gameObject.parentContainer;\r\n        if (!(com instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_15__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        var ele = com.element;\r\n        if (!(ele instanceof _element_element__WEBPACK_IMPORTED_MODULE_13__["Element"])) {\r\n            return;\r\n        }\r\n        if (this.mEnableEdit) {\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n            this.connection.send(packet);\r\n        }\r\n    };\r\n    Room.prototype.onEnableEditModeHandler = function (packet) {\r\n        this.mEnableEdit = true;\r\n        if (this.world) {\r\n            this.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_14__["MessageType"].ADD_ICON_TO_TOP, {\r\n                key: "Turn_Btn_Top",\r\n                name: "EnterDecorate",\r\n                bgResKey: "baseView",\r\n                bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n                iconResKey: "",\r\n                iconTexture: "btnGroup_top_expand.png",\r\n                scale: 1\r\n            });\r\n        }\r\n    };\r\n    Room.prototype.enterRoom = function () {\r\n        this.mWorld.game.scene.run(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, {\r\n            room: this\r\n        });\r\n    };\r\n    return Room;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/room.ts?')},"./src/rooms/terrain/decorate.terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateTerrainManager", function() { return DecorateTerrainManager; });\n/* harmony import */ var _terrain_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DecorateTerrainManager = /** @class */ (function (_super) {\r\n    __extends(DecorateTerrainManager, _super);\r\n    function DecorateTerrainManager(roomService) {\r\n        var _this = _super.call(this, roomService) || this;\r\n        var miniSize = roomService.miniSize;\r\n        _this.map = new Array(miniSize.cols);\r\n        for (var i = 0; i < miniSize.rows; i++) {\r\n            _this.map[i] = new Array(miniSize.rows).fill(0);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateTerrainManager.prototype.remove = function (id) {\r\n        var terrain = _super.prototype.remove.call(this, id);\r\n        if (terrain) {\r\n            this.removeMap(terrain.model);\r\n        }\r\n        return terrain;\r\n    };\r\n    DecorateTerrainManager.prototype._add = function (sprite) {\r\n        var terrain = _super.prototype._add.call(this, sprite);\r\n        var displayInfo = sprite.displayInfo;\r\n        if (displayInfo) {\r\n            this.addMap(sprite);\r\n        }\r\n        return terrain;\r\n    };\r\n    DecorateTerrainManager.prototype.onSyncSprite = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var terrain = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            terrain = this.get(sprite.id);\r\n            if (terrain) {\r\n                var sp = new _element_sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite, content.nodeType);\r\n                terrain.model = sp;\r\n                if (sp.displayInfo) {\r\n                    this.addMap(sp);\r\n                }\r\n                // terrain.setRenderable(true);\r\n            }\r\n        }\r\n    };\r\n    DecorateTerrainManager.prototype.addMap = function (sprite) {\r\n        this.setMap(sprite, 1);\r\n    };\r\n    DecorateTerrainManager.prototype.removeMap = function (sprite) {\r\n        this.setMap(sprite, 0);\r\n    };\r\n    DecorateTerrainManager.prototype.setMap = function (sprite, type) {\r\n        var displayInfo = sprite.displayInfo;\r\n        var aniName = sprite.currentAnimationName || displayInfo.animationName;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName);\r\n        var walkArea = displayInfo.getWalkableArea(aniName);\r\n        var origin = displayInfo.getOriginPoint(aniName);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var hasCollisionArea = true;\r\n        if (rows === 1 && cols === 1) {\r\n            rows = 2;\r\n            cols = 2;\r\n            hasCollisionArea = false;\r\n        }\r\n        var pos = sprite.pos;\r\n        for (var i = 0; i < rows; i++) {\r\n            for (var j = 0; j < cols; j++) {\r\n                if ((!hasCollisionArea) || collisionArea[i][j] === 1 && walkArea[i][j] === 1) {\r\n                    this.map[pos.x + i - origin.x][pos.y + j - origin.y] = type;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return DecorateTerrainManager;\r\n}(_terrain_manager__WEBPACK_IMPORTED_MODULE_0__["TerrainManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/decorate.terrain.manager.ts?')},"./src/rooms/terrain/editor.terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorTerrainManager", function() { return EditorTerrainManager; });\n/* harmony import */ var _terrain_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./terrain */ "./src/rooms/terrain/terrain.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditorTerrainManager = /** @class */ (function (_super) {\r\n    __extends(EditorTerrainManager, _super);\r\n    function EditorTerrainManager(room, listener) {\r\n        var _this = _super.call(this, room, listener) || this;\r\n        if (_this.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_CREATE_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorTerrainManager.prototype.add = function (sprites) {\r\n        var clientSprites = [];\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            if (!this.canPut(sprite)) {\r\n                continue;\r\n            }\r\n            this._add(sprite);\r\n            clientSprites.push(sprite.toSprite());\r\n        }\r\n        if (clientSprites.length === 0)\r\n            return;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_SPRITE);\r\n        var content = pkt.content;\r\n        content.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType;\r\n        content.sprites = clientSprites;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorTerrainManager.prototype.removeEditor = function (ids) {\r\n        var _this = this;\r\n        if (!this.mTerrains)\r\n            return;\r\n        ids.forEach(function (id) { return _this.tryRemove(id); });\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_SPRITE);\r\n        var content = pkt.content;\r\n        content.ids = ids;\r\n        content.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorTerrainManager.prototype.removeFormPositions = function (locations) {\r\n        var terrains = Array.from(this.mTerrains.values());\r\n        var ids = [];\r\n        var _loop_1 = function (pos) {\r\n            var terrain = terrains.find(function (ter) {\r\n                return pos.equal(ter.getPosition45());\r\n            });\r\n            if (terrain) {\r\n                ids.push(terrain.id);\r\n            }\r\n        };\r\n        for (var _i = 0, locations_1 = locations; _i < locations_1.length; _i++) {\r\n            var pos = locations_1[_i];\r\n            _loop_1(pos);\r\n        }\r\n        this.removeEditor(ids);\r\n    };\r\n    EditorTerrainManager.prototype._add = function (sprite) {\r\n        var terrain = this.mTerrains.get(sprite.id);\r\n        if (!terrain) {\r\n            terrain = new _terrain__WEBPACK_IMPORTED_MODULE_3__["Terrain"](sprite, this);\r\n            terrain.setBlockable(false);\r\n            terrain.setRenderable(true);\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        // TODO update terrain\r\n        // 根据x, y, z去重\r\n        var repeatTerrain = Array.from(this.mTerrains.values()).find(function (terrain) {\r\n            var pos = terrain.getPosition();\r\n            return pos.x === sprite.pos.x && pos.y === sprite.pos.y && pos.z === sprite.pos.z;\r\n        });\r\n        if (repeatTerrain) {\r\n            this.mTerrains.delete(repeatTerrain.id);\r\n        }\r\n        this.mTerrains.set(terrain.id || 0, terrain);\r\n        // this.roomService.blocks.add(terrain);\r\n        return terrain;\r\n    };\r\n    EditorTerrainManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.tryRemove(id);\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            this.trySync(sprite);\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.trySync = function (sprite) {\r\n        var terrain = this.mTerrains.get(sprite.id);\r\n        if (!terrain) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("can\'t find terrain", sprite);\r\n            return;\r\n        }\r\n        var point = sprite.point3f;\r\n        if (point) {\r\n            terrain.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](point.x, point.y, point.z));\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.tryRemove = function (id) {\r\n        var terrain = this.mTerrains.get(id);\r\n        if (terrain) {\r\n            this.mTerrains.delete(id);\r\n            terrain.destroy();\r\n            if (this.roomService) {\r\n                this.roomService.blocks.remove(terrain);\r\n            }\r\n            return terrain;\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.canPut = function (sprite) {\r\n        var pos = sprite.pos;\r\n        var roomSize = this.roomService.roomSize;\r\n        if (!roomSize)\r\n            return false;\r\n        if (pos.x < 0 || pos.y < 0 || pos.x >= roomSize.cols || pos.y >= roomSize.rows) {\r\n            return false;\r\n        }\r\n        var terrains = Array.from(this.mTerrains.values());\r\n        for (var _i = 0, terrains_1 = terrains; _i < terrains_1.length; _i++) {\r\n            var ter = terrains_1[_i];\r\n            var pos45 = ter.getPosition45();\r\n            if (sprite.pos.equal(pos45)) {\r\n                if (sprite.bindID !== ter.model.bindID) {\r\n                    // 编辑器判断重叠地块\r\n                    // this.removeEditor(ter.id);\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return EditorTerrainManager;\r\n}(_terrain_manager__WEBPACK_IMPORTED_MODULE_0__["TerrainManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/editor.terrain.manager.ts?')},"./src/rooms/terrain/terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainManager", function() { return TerrainManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./terrain */ "./src/rooms/terrain/terrain.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\nvar TerrainManager = /** @class */ (function (_super) {\r\n    __extends(TerrainManager, _super);\r\n    // ---- by 7\r\n    function TerrainManager(mRoom, listener) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mTerrains = new Map();\r\n        // add by 7 ----\r\n        _this.mPacketFrameCount = 0;\r\n        _this.mListener = listener;\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSyncSprite);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n        }\r\n        if (_this.mRoom && _this.mRoom.world) {\r\n            _this.mGameConfig = _this.mRoom.world.elementStorage;\r\n        }\r\n        return _this;\r\n    }\r\n    TerrainManager.prototype.init = function () {\r\n        // this.destroy();\r\n    };\r\n    TerrainManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mTerrains)\r\n            return;\r\n        this.mTerrains.forEach(function (terrain) { return _this.remove(terrain.id); });\r\n        this.mTerrains.clear();\r\n    };\r\n    TerrainManager.prototype.get = function (id) {\r\n        var terrain = this.mTerrains.get(id);\r\n        if (!terrain) {\r\n            return;\r\n        }\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.add = function (sprites) {\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this._add(sprite);\r\n        }\r\n    };\r\n    TerrainManager.prototype.remove = function (id) {\r\n        if (!this.mTerrains)\r\n            return;\r\n        var terrain = this.mTerrains.get(id);\r\n        if (terrain) {\r\n            this.mTerrains.delete(id);\r\n            terrain.destroy();\r\n        }\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.getElements = function () {\r\n        return Array.from(this.mTerrains.values());\r\n    };\r\n    TerrainManager.prototype.onAdd = function (packet) {\r\n        this.mPacketFrameCount++;\r\n        if (!this.mGameConfig) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        console.log("TCL: TerrainManager -> onAdd-----content", content);\r\n        var sprites = content.sprites;\r\n        var type = content.nodeType;\r\n        var pf = content.packet;\r\n        // this.mRoom.mCurRoom\r\n        console.log("TCL: TerrainManager -> this.mRoom.mCurRoom", this.mRoom.world.roomManager.currentRoom);\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        // const currentRoomId = this.mRoom.world.roomManager.currentRoom.id;\r\n        // const terrainCollection = this.mRoom.world.elementStorage.getTerrainCollection();\r\n        // const curRoomTerrainCol = terrainCollection.get(currentRoomId);\r\n        var point;\r\n        var ids = [];\r\n        // sprites 服务端\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            point = sprite.point3f;\r\n            if (point) {\r\n                var s = new _element_sprite__WEBPACK_IMPORTED_MODULE_3__["Sprite"](sprite, type);\r\n                if (!s.displayInfo) {\r\n                    this.checkTerrainDisplay(s);\r\n                }\r\n                if (!s.displayInfo) {\r\n                    ids.push(s.id);\r\n                }\r\n                this._add(s);\r\n            }\r\n        }\r\n        this.fetchDisplay(ids);\r\n        console.log("sprites =====>", sprites);\r\n        if (this.mListener && this.mPacketFrameCount === pf.totalFrame) {\r\n            this.mListener.onFullPacketReceived(type);\r\n        }\r\n    };\r\n    TerrainManager.prototype.onAdd1 = function (packet) {\r\n        this.mPacketFrameCount++;\r\n        if (!this.mGameConfig) {\r\n            // Logger.getInstance().error("gameconfig is undefined");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var sprites = content.sprites;\r\n        var type = content.nodeType;\r\n        var pf = content.packet;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var point;\r\n        var ids = [];\r\n        for (var _i = 0, sprites_3 = sprites; _i < sprites_3.length; _i++) {\r\n            var sprite = sprites_3[_i];\r\n            point = sprite.point3f;\r\n            if (point) {\r\n                var s = new _element_sprite__WEBPACK_IMPORTED_MODULE_3__["Sprite"](sprite, type);\r\n                if (!s.displayInfo) {\r\n                    this.checkDisplay(s);\r\n                }\r\n                if (!s.displayInfo) {\r\n                    ids.push(s.id);\r\n                }\r\n                this._add(s);\r\n            }\r\n        }\r\n        this.fetchDisplay(ids);\r\n        if (this.mListener && this.mPacketFrameCount === pf.totalFrame) {\r\n            this.mListener.onFullPacketReceived(type);\r\n        }\r\n    };\r\n    TerrainManager.prototype._add = function (sprite) {\r\n        var terrain = this.mTerrains.get(sprite.id);\r\n        if (!terrain) {\r\n            terrain = new _terrain__WEBPACK_IMPORTED_MODULE_2__["Terrain"](sprite, this);\r\n            // terrain.setRenderable(true);\r\n        }\r\n        else {\r\n            return;\r\n        }\r\n        // TODO update terrain\r\n        this.mTerrains.set(terrain.id || 0, terrain);\r\n        // this.roomService.blocks.add(terrain);\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    TerrainManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.remove(id);\r\n        }\r\n        // Logger.getInstance().log("remove terrain length: ", ids.length);\r\n    };\r\n    TerrainManager.prototype.onSyncSprite = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var terrain = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_4 = sprites; _i < sprites_4.length; _i++) {\r\n            var sprite = sprites_4[_i];\r\n            terrain = this.get(sprite.id);\r\n            if (terrain) {\r\n                terrain.model = new _element_sprite__WEBPACK_IMPORTED_MODULE_3__["Sprite"](sprite, content.nodeType);\r\n                // terrain.setRenderable(true);\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.checkDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var displayInfo = this.roomService.world.elementStorage.getObject(sprite.bindID || sprite.id);\r\n            if (displayInfo) {\r\n                sprite.displayInfo = displayInfo;\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.checkTerrainDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var palette = this.roomService.world.elementStorage.getPalette(sprite.bindID || sprite.id);\r\n            if (palette) {\r\n                sprite.displayInfo = palette;\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.fetchDisplay = function (ids) {\r\n        if (ids.length === 0) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    TerrainManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var anis = content.changeAnimation;\r\n        var terrain = null;\r\n        for (var _i = 0, anis_1 = anis; _i < anis_1.length; _i++) {\r\n            var ani = anis_1[_i];\r\n            terrain = this.get(ani.id);\r\n            if (terrain) {\r\n                terrain.play(ani.animationName);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(TerrainManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            // Logger.getInstance().error("room manager is undefined");\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.camera;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return TerrainManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/terrain.manager.ts?')},"./src/rooms/terrain/terrain.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Terrain", function() { return Terrain; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _cameras_block_object__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../cameras/block.object */ "./src/rooms/cameras/block.object.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar Terrain = /** @class */ (function (_super) {\r\n    __extends(Terrain, _super);\r\n    function Terrain(sprite, mElementManager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mBlockable = false;\r\n        _this.mId = sprite.id;\r\n        _this.model = sprite;\r\n        return _this;\r\n    }\r\n    Terrain.prototype.setModel = function (val) {\r\n        this.mModel = val;\r\n        if (!val) {\r\n            return;\r\n        }\r\n        this.load(this.mModel.displayInfo);\r\n        // this.mDisplayInfo = <IFramesModel> this.mModel.displayInfo;\r\n        // this.createDisplay();\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.setPosition45(this.mModel.pos);\r\n        // this.addDisplay();\r\n    };\r\n    Terrain.prototype.load = function (displayInfo) {\r\n        this.mDisplayInfo = displayInfo;\r\n        if (!this.mDisplayInfo) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            this.createDisplay();\r\n        }\r\n        this.mDisplayInfo = displayInfo;\r\n        this.mDisplay.load(this.mDisplayInfo);\r\n    };\r\n    Terrain.prototype.play = function (animationName) {\r\n        if (this.mAnimationName !== animationName) {\r\n            this.mAnimationName = animationName;\r\n            if (this.mDisplay) {\r\n                this.mDisplay.play(this.mAnimationName);\r\n            }\r\n        }\r\n    };\r\n    Terrain.prototype.setDirection = function (val) {\r\n        if (this.mDisplayInfo && this.mDisplayInfo.avatarDir)\r\n            this.mDisplayInfo.avatarDir = val;\r\n    };\r\n    Terrain.prototype.getDirection = function () {\r\n        return (this.mDisplayInfo && this.mDisplayInfo.avatarDir) ? this.mDisplayInfo.avatarDir : 3;\r\n    };\r\n    Terrain.prototype.setPosition = function (p) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setPosition(p.x, p.y, p.z);\r\n        }\r\n        this.setDepth();\r\n    };\r\n    Terrain.prototype.getPosition = function () {\r\n        var pos;\r\n        if (this.mDisplay) {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](this.mDisplay.x, this.mDisplay.y, this.mDisplay.z);\r\n        }\r\n        else {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](0, 0, 0);\r\n        }\r\n        return pos;\r\n    };\r\n    Terrain.prototype.getPosition45 = function () {\r\n        var pos = this.getPosition();\r\n        if (!pos)\r\n            return;\r\n        return this.roomService.transformTo45(pos);\r\n    };\r\n    Terrain.prototype.showNickname = function () {\r\n    };\r\n    Terrain.prototype.showEffected = function () {\r\n    };\r\n    Terrain.prototype.removeMe = function () {\r\n        if (!this.mElementManager)\r\n            return;\r\n        this.mElementManager.remove(this.id);\r\n    };\r\n    Terrain.prototype.toSprite = function () {\r\n        var sprite = pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].Sprite.create();\r\n        sprite.id = this.id;\r\n        if (this.mDisplay) {\r\n            var pos45 = this.getPosition45();\r\n            this.mDisplay.x = pos45.x;\r\n            this.mDisplay.y = pos45.y;\r\n        }\r\n        return sprite;\r\n    };\r\n    Terrain.prototype.setBlockable = function (val) {\r\n        if (this.mBlockable !== val) {\r\n            this.mBlockable = val;\r\n            if (this.mDisplay && this.roomService) {\r\n                if (val) {\r\n                    this.roomService.addBlockObject(this);\r\n                }\r\n                else {\r\n                    this.roomService.removeBlockObject(this);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    Terrain.prototype.destroy = function () {\r\n        if (this.mBlockable && this.mDisplay) {\r\n            this.roomService.removeBlockObject(this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Terrain.prototype.createDisplay = function () {\r\n        if (!this.mDisplayInfo) {\r\n            // Logger.getInstance().error("displayinfo does not exist, Create display failed");\r\n            return;\r\n        }\r\n        if (this.mDisplay) {\r\n            return this.mDisplay;\r\n        }\r\n        var scene = this.mElementManager.scene;\r\n        if (scene) {\r\n            this.mDisplay = new _display_terrain_display__WEBPACK_IMPORTED_MODULE_2__["TerrainDisplay"](scene, this.mElementManager.roomService, this);\r\n            this.setPosition45(this.model.pos);\r\n            this.addToBlock();\r\n            // this.mDisplay.load(this.mDisplayInfo);\r\n        }\r\n        return this.mDisplay;\r\n    };\r\n    Terrain.prototype.addDisplay = function () {\r\n        this.createDisplay();\r\n        if (!this.mDisplay) {\r\n            // Logger.getInstance().error("display does not exist");\r\n            return;\r\n        }\r\n        if (!this.mElementManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("element manager does not exist");\r\n            return;\r\n        }\r\n        var room = this.mElementManager.roomService;\r\n        if (!room) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("roomService does not exist");\r\n            return;\r\n        }\r\n        room.addToGround(this.mDisplay);\r\n        this.setDepth();\r\n    };\r\n    Terrain.prototype.addToBlock = function () {\r\n        if (this.mBlockable) {\r\n            this.roomService.addBlockObject(this);\r\n        }\r\n        else {\r\n            this.addDisplay();\r\n        }\r\n    };\r\n    Terrain.prototype.setDepth = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setDepth(this.mDisplay.y);\r\n            if (!this.roomService) {\r\n                throw new Error("roomService is undefined");\r\n            }\r\n            var layerManager = this.roomService.layerManager;\r\n            if (!layerManager) {\r\n                throw new Error("layerManager is undefined");\r\n            }\r\n            layerManager.depthGroundDirty = true;\r\n        }\r\n    };\r\n    Terrain.prototype.setPosition45 = function (pos) {\r\n        if (!this.roomService) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("roomService does not exist");\r\n            return;\r\n        }\r\n        var point = this.roomService.transformTo90(pos);\r\n        this.setPosition(point);\r\n    };\r\n    Object.defineProperty(Terrain.prototype, "id", {\r\n        get: function () {\r\n            return this.mId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "dir", {\r\n        get: function () {\r\n            return this.mDisplayInfo.avatarDir !== undefined ? this.mDisplayInfo.avatarDir : 3;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "roomService", {\r\n        get: function () {\r\n            if (!this.mElementManager) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("element manager is undefined");\r\n                return;\r\n            }\r\n            return this.mElementManager.roomService;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.setModel(val);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Terrain;\r\n}(_cameras_block_object__WEBPACK_IMPORTED_MODULE_3__["BlockObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/terrain.ts?')},"./src/scenes/create.character.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRoleScene", function() { return CreateRoleScene; });\n/* harmony import */ var _loading__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loading */ "./src/scenes/loading.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar CreateRoleScene = /** @class */ (function (_super) {\r\n    __extends(CreateRoleScene, _super);\r\n    function CreateRoleScene() {\r\n        return _super.call(this, { key: CreateRoleScene.name }) || this;\r\n    }\r\n    CreateRoleScene.prototype.init = function (data) {\r\n        if (data.role) {\r\n            this.role = data.role;\r\n        }\r\n    };\r\n    CreateRoleScene.prototype.create = function () {\r\n        if (this.role) {\r\n            this.game.scene.stop(_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"].name);\r\n            this.role.start(this);\r\n        }\r\n    };\r\n    return CreateRoleScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/create.character.ts?')},"./src/scenes/edit.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditScene", function() { return EditScene; });\n/* harmony import */ var _play__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./play */ "./src/scenes/play.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n// 编辑器用 Phaser.Scene\r\nvar EditScene = /** @class */ (function (_super) {\r\n    __extends(EditScene, _super);\r\n    function EditScene() {\r\n        return _super.call(this, { key: EditScene.name }) || this;\r\n    }\r\n    EditScene.prototype.create = function () {\r\n        this.mRoom.startPlay();\r\n        this.scene.sendToBack();\r\n    };\r\n    return EditScene;\r\n}(_play__WEBPACK_IMPORTED_MODULE_0__["PlayScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/edit.ts?')},"./src/scenes/gamepause.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GamePauseScene", function() { return GamePauseScene; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_size__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/size */ "./src/utils/size.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar GamePauseScene = /** @class */ (function (_super) {\r\n    __extends(GamePauseScene, _super);\r\n    function GamePauseScene() {\r\n        return _super.call(this, { key: GamePauseScene.name }) || this;\r\n    }\r\n    GamePauseScene.prototype.preload = function () {\r\n        this.load.image("gamepause.png", _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("gamepause.png"));\r\n    };\r\n    GamePauseScene.prototype.init = function (data) {\r\n        this.mWorld = data.world;\r\n    };\r\n    GamePauseScene.prototype.create = function () {\r\n        var width = this.scale.gameSize.width;\r\n        var height = this.scale.gameSize.height;\r\n        this.bg = this.add.graphics();\r\n        this.bg.fillStyle(0, .8);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        this.pauseImg = this.add.image(width >> 1, height >> 1, "gamepause.png");\r\n        this.tipTF = this.add.text(width - 240 >> 1, height - 50, "点击任意位置开始游戏", { font: "30px Tahoma" });\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.checkSize(new _utils_size__WEBPACK_IMPORTED_MODULE_1__["Size"](width, height));\r\n    };\r\n    GamePauseScene.prototype.awake = function () {\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scene.wake();\r\n    };\r\n    GamePauseScene.prototype.sleep = function () {\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scene.sleep();\r\n    };\r\n    GamePauseScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    GamePauseScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n        this.bg.clear();\r\n        this.bg.fillStyle(0, .8);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        this.pauseImg.scaleX = this.pauseImg.scaleY = this.mWorld.uiScale * .7;\r\n        this.pauseImg.x = width >> 1;\r\n        this.pauseImg.y = height >> 1;\r\n        this.tipTF.scaleX = this.tipTF.scaleY = this.mWorld.uiScale;\r\n        this.tipTF.x = width - 280 * this.mWorld.uiScale >> 1;\r\n        this.tipTF.y = height - 50 * this.mWorld.uiScale;\r\n    };\r\n    return GamePauseScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/gamepause.ts?')},"./src/scenes/loading.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingScene", function() { return LoadingScene; });\n/* harmony import */ var _utils_size__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/size */ "./src/utils/size.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar LOGO_MARGIN = 25;\r\nvar LoadingScene = /** @class */ (function (_super) {\r\n    __extends(LoadingScene, _super);\r\n    function LoadingScene() {\r\n        var _this = _super.call(this, { key: LoadingScene.name }) || this;\r\n        _this.mRequestCom = false;\r\n        return _this;\r\n    }\r\n    LoadingScene.prototype.preload = function () {\r\n        // atlas可以用于webgl渲染，和canvas渲染，spritesheet只能用于canvas\r\n        this.load.atlas("loading", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("loading.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("loading.json"));\r\n        // this.load.spritesheet("rabbit00.png", "./resources/rabbit00.png", { frameWidth: 150, frameHeight: 150 });\r\n    };\r\n    LoadingScene.prototype.init = function (data) {\r\n        this.mWorld = data.world;\r\n        this.mRoom = data.room;\r\n        this.mRequestCom = false;\r\n    };\r\n    LoadingScene.prototype.create = function () {\r\n        if (this.mRoom)\r\n            this.mRoom.startLoad();\r\n        var width = this.scale.gameSize.width;\r\n        var height = this.scale.gameSize.height;\r\n        this.bg = this.add.graphics();\r\n        this.bg.fillStyle(0x616161);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        var framesObj = this.textures.get("loading").frames;\r\n        var tmpFrames = [];\r\n        for (var key in framesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = framesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.anims.create({\r\n            key: "loading_anmis",\r\n            frames: this.anims.generateFrameNumbers("loading", { start: 0, end: 59, frames: tmpFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        this.lo = this.add.sprite(0, 0, "loading");\r\n        this.lo.setScale(.8);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.lo.play("loading_anmis");\r\n        this.checkSize(new _utils_size__WEBPACK_IMPORTED_MODULE_0__["Size"](width, height));\r\n    };\r\n    LoadingScene.prototype.update = function (time, delta) {\r\n        // if (this.cameras.main) {\r\n        //   this.cameras.main.emit("renderer", this.cameras.main);\r\n        // }\r\n        if (this.mRoom) {\r\n            if (this.mRoom.world.clock.clockSync && !this.mRequestCom) {\r\n                this.mRequestCom = true;\r\n                this.mRoom.completeLoad();\r\n            }\r\n            // this.mRoom.updateClock(time, delta);\r\n        }\r\n    };\r\n    LoadingScene.prototype.awake = function () {\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scene.wake();\r\n    };\r\n    LoadingScene.prototype.sleep = function () {\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scene.sleep();\r\n    };\r\n    LoadingScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    LoadingScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n        this.bg.clear();\r\n        this.bg.fillStyle(0x616161);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.lo.x = width - (150 + LOGO_MARGIN) * this.mWorld.uiScale;\r\n            this.lo.y = height - (150 + LOGO_MARGIN) * this.mWorld.uiScale;\r\n        }\r\n        else {\r\n            this.lo.x = (width - this.lo.width >> 1) + 100;\r\n            this.lo.y = (height - this.lo.height >> 1) + 100;\r\n        }\r\n        // this.lo.scaleX = this.lo.scaleY = this.mWorld.uiScale;\r\n    };\r\n    return LoadingScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/loading.ts?')},"./src/scenes/login.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoginScene", function() { return LoginScene; });\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _ui_alert_alert__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ui/alert/alert */ "./src/ui/alert/alert.ts");\n/* harmony import */ var _ui_components_comboBox__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ui/components/comboBox */ "./src/ui/components/comboBox.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n// 编辑器用 Phaser.Scene\r\nvar LoginScene = /** @class */ (function (_super) {\r\n    __extends(LoginScene, _super);\r\n    function LoginScene() {\r\n        var _this = _super.call(this, { key: LoginScene.name }) || this;\r\n        _this.mCurTabIndex = 0;\r\n        _this.mHei = 0;\r\n        return _this;\r\n    }\r\n    LoginScene.prototype.preload = function () {\r\n        this.load.atlas("login", "./resources/ui/login/login.png", "./resources/ui/login/login.json");\r\n    };\r\n    LoginScene.prototype.create = function () {\r\n        var loginRes = "login";\r\n        var width = this.mWorld.getConfig().screenWidth;\r\n        var height = this.mWorld.getConfig().screenHeight;\r\n        this.rect = this.add.graphics();\r\n        this.rect.fillStyle(0);\r\n        this.rect.fillRect(0, 0, width, height);\r\n        var accountData = localStorage.getItem("account");\r\n        var logo = this.make.image(undefined, false);\r\n        logo.setTexture(loginRes, "login_logo");\r\n        this.mHei += logo.height;\r\n        this.mParentCon = this.add.container(width >> 1, (height >> 1) + 100);\r\n        this.mBg = this.make.image(undefined, false);\r\n        this.mHei += this.mBg.height + 10;\r\n        this.mEnterBtn = this.make.image(undefined, false);\r\n        this.mEnterBtn.setTexture(loginRes, "login_loginBtn");\r\n        this.mEnterBtn.x = 123;\r\n        this.mQuickBtn = this.make.image(undefined, false);\r\n        this.mQuickBtn.setTexture(loginRes, "login_quickBtn");\r\n        this.mQuickBtn.x = 123;\r\n        this.mQuickBtn.y = -38;\r\n        this.mSendCodeBtn = this.make.image(undefined, false);\r\n        this.mSendCodeBtn.setTexture(loginRes, "login_sendBtn");\r\n        this.mSendCodeBtn.x = 10;\r\n        this.mSendCodeBtn.y = 67;\r\n        this.mTab0 = this.make.image(undefined, false);\r\n        this.mTab0.setTexture(loginRes, "login_tabSelect");\r\n        this.mTab0.x = -105;\r\n        this.mTab0.y = -38;\r\n        this.mTab1 = this.make.image(undefined, false);\r\n        this.mTab1.setTexture(loginRes, "login_tabUnSelect");\r\n        this.mTab1.x = 7;\r\n        this.mTab1.y = -38;\r\n        this.mInputBg_long0 = this.make.image(undefined, false);\r\n        this.mInputBg_long0.setTexture(loginRes, "login_inputLong");\r\n        this.mInputBg_long0.x = -50;\r\n        this.mInputBg_long0.y = 15;\r\n        this.mInputBg_long1 = this.make.image(undefined, false);\r\n        this.mInputBg_long1.setTexture(loginRes, "login_inputLong");\r\n        this.mInputBg_long1.x = -50;\r\n        this.mInputBg_long1.y = 67;\r\n        this.mInputBg_small = this.make.image(undefined, false);\r\n        this.mInputBg_small.setTexture(loginRes, "login_inputBg");\r\n        this.mInputBg_small.x = -105;\r\n        this.mInputBg_small.y = 67;\r\n        this.mSizeTF = this.add.text(10, 50, "", { style: { color: "#000000" }, wordWrap: { width: 800, useAdvancedWrap: true } });\r\n        this.mSizeTF.setFontSize(20);\r\n        this.mTabDic = new Map();\r\n        this.mNameInputTxt = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 190, 15, {\r\n            type: "input",\r\n            placeholder: "用戶名",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(200, 20)\r\n            .setOrigin(0, 0);\r\n        this.mPassWordInputTxt = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 190, 15, {\r\n            type: "password",\r\n            placeholder: "密码",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(200, 20)\r\n            .setOrigin(0, 0);\r\n        this.mVerificationCodeTxt = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 100, 15, {\r\n            type: "input",\r\n            placeholder: "验证码",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(100, 20)\r\n            .setOrigin(0, 0);\r\n        this.mNameInputTxt.x = -140;\r\n        this.mNameInputTxt.y = 4;\r\n        this.mPassWordInputTxt.x = -140;\r\n        this.mPassWordInputTxt.y = 55;\r\n        this.mVerificationCodeTxt.x = -140;\r\n        this.mVerificationCodeTxt.y = 55;\r\n        // this.mtxt0 = this.add.text(-145, -46, "手机号登录", { fontFamily: "YaHei" });\r\n        // this.mtxt1 = this.add.text(-35, -46, "用户号登录", { fontFamily: "YaHei" });\r\n        // this.mtxt2 = this.add.text(90, -46, "快速游戏", { fontFamily: "YaHei" });\r\n        // this.mtxt3 = this.add.text(108, 33, "登录", { fontFamily: "YaHei" });\r\n        // this.mtxt4 = this.add.text(-97, 37, "登录其他账号", { fontFamily: "YaHei" });\r\n        // this.mtxt5 = this.add.text(-6, 57, "发送", { fontFamily: "YaHei" });\r\n        this.mtxt0 = this.make.text(undefined, false);\r\n        this.mtxt1 = this.make.text(undefined, false);\r\n        this.mtxt2 = this.make.text(undefined, false);\r\n        this.mtxt3 = this.make.text(undefined, false);\r\n        this.mtxt4 = this.make.text(undefined, false);\r\n        this.mtxt5 = this.make.text(undefined, false);\r\n        this.mtxt0.x = -145;\r\n        this.mtxt0.y = -46;\r\n        this.mtxt1.x = -35;\r\n        this.mtxt1.y = -46;\r\n        this.mtxt2.x = 90;\r\n        this.mtxt2.y = -46;\r\n        this.mtxt3.x = 108;\r\n        this.mtxt3.y = 33;\r\n        this.mtxt4.x = -97;\r\n        this.mtxt4.y = 37;\r\n        this.mtxt5.x = -6;\r\n        this.mtxt5.y = 57;\r\n        this.mtxt0.setFontFamily("YaHei");\r\n        this.mtxt0.setText("手机号登录");\r\n        this.mtxt1.setFontFamily("YaHei");\r\n        this.mtxt1.setText("用户号登录");\r\n        this.mtxt2.setFontFamily("YaHei");\r\n        this.mtxt2.setText("快速游戏");\r\n        this.mtxt3.setFontFamily("YaHei");\r\n        this.mtxt3.setText("登录");\r\n        this.mtxt4.setFontFamily("YaHei");\r\n        this.mtxt4.setText("登录其他账号");\r\n        this.mtxt5.setFontFamily("YaHei");\r\n        this.mtxt5.setText("发送");\r\n        var config = {\r\n            wid: 220,\r\n            hei: 36,\r\n            resKey: "login",\r\n            resPng: "./resources/ui/login/login.png",\r\n            resJson: "./resources/ui/login/login.json",\r\n            resBg: "login_inputLong",\r\n            resArrow: "login_downArrow",\r\n            fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n            up: true,\r\n            clickCallBack: this.changeID,\r\n        };\r\n        this.combobox = new _ui_components_comboBox__WEBPACK_IMPORTED_MODULE_2__["ComboBox"](this, config);\r\n        this.combobox.x = -158;\r\n        this.combobox.y = -28;\r\n        logo.x = -25;\r\n        logo.y = -logo.height / 2;\r\n        this.changePanelState(accountData);\r\n        this.mParentCon.add(logo);\r\n        this.mParentCon.add(this.mBg);\r\n        this.mParentCon.add(this.mTab0);\r\n        this.mParentCon.add(this.mTab1);\r\n        this.mParentCon.add(this.mQuickBtn);\r\n        this.mParentCon.add(this.mEnterBtn);\r\n        this.mParentCon.add(this.mSendCodeBtn);\r\n        this.mParentCon.add(this.mInputBg_long0);\r\n        this.mParentCon.add(this.mInputBg_long1);\r\n        this.mParentCon.add(this.mInputBg_small);\r\n        this.mParentCon.add(this.mNameInputTxt);\r\n        this.mParentCon.add(this.mPassWordInputTxt);\r\n        this.mParentCon.add(this.mVerificationCodeTxt);\r\n        this.mParentCon.add(this.mtxt0);\r\n        this.mParentCon.add(this.mtxt1);\r\n        this.mParentCon.add(this.mtxt2);\r\n        this.mParentCon.add(this.mtxt3);\r\n        this.mParentCon.add(this.mtxt4);\r\n        this.mParentCon.add(this.mtxt5);\r\n        this.mParentCon.add(this.combobox);\r\n        this.mTab0.setInteractive();\r\n        this.mTab1.setInteractive();\r\n        this.mQuickBtn.setInteractive();\r\n        this.mEnterBtn.setInteractive();\r\n        this.mSendCodeBtn.setInteractive();\r\n        this.mtxt4.setInteractive();\r\n        this.mTab0.tabIndex = 0;\r\n        this.mTab1.tabIndex = 1;\r\n        this.mTabDic.set(this.mTab0.tabIndex, this.mTab0);\r\n        this.mTabDic.set(this.mTab1.tabIndex, this.mTab1);\r\n        this.mCurTabIndex = 0;\r\n        this.mTab0.on("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.on("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.on("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.on("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.on("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.on("pointerdown", this.changeAccount, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scale.on("orientationchange", this.onOrientationChange, this);\r\n        this.checkSize();\r\n    };\r\n    LoginScene.prototype.init = function (data) {\r\n        this.mConnect = data.connect;\r\n        this.mCallBack = data.callBack;\r\n        this.mWorld = data.world;\r\n    };\r\n    LoginScene.prototype.update = function () {\r\n        var orientation = this.mWorld.getSize().width > this.mWorld.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        this.mSizeTF.text = "width:" + this.mWorld.getSize().width + "\\n" + "height:" + this.mWorld.getSize().height + "\\n" + "orientation:" + orientation\r\n            + "\\n" + "devicePixelRatio:" + window.devicePixelRatio;\r\n    };\r\n    LoginScene.prototype.awake = function () {\r\n        this.mTab0.on("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.on("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.on("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.on("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.on("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.on("pointerdown", this.changeAccount, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scale.on("orientationchange", this.onOrientationChange, this);\r\n        this.scene.wake();\r\n    };\r\n    LoginScene.prototype.sleep = function () {\r\n        this.mTab0.off("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.off("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.off("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.off("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.off("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.off("pointerdown", this.changeAccount, this);\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scale.off("orientationchange", this.onOrientationChange, this);\r\n        this.scene.sleep();\r\n    };\r\n    LoginScene.prototype.remove = function () {\r\n        this.mTab0.off("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.off("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.off("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.off("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.off("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.off("pointerdown", this.changeAccount, this);\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scale.off("orientationchange", this.onOrientationChange, this);\r\n        this.scene.remove();\r\n    };\r\n    LoginScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    LoginScene.prototype.onOrientationChange = function () {\r\n        var width = window.screen.width;\r\n        var height = window.screen.height;\r\n        this.game.scale.resize(width, height);\r\n        this.game.canvas.style.width = window.screen.width + "";\r\n        this.game.canvas.style.height = window.screen.height + "";\r\n        this.checkSize();\r\n    };\r\n    LoginScene.prototype.checkSize = function () {\r\n        var width = this.cameras.main.width;\r\n        var height = this.cameras.main.height;\r\n        this.mParentCon.x = width >> 1;\r\n        if (!this.game.device.os.desktop) {\r\n            var scale = void 0;\r\n            if (this.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                scale = this.mParentCon.width / this.cameras.main.width;\r\n            }\r\n            else {\r\n                scale = this.mParentCon.height / this.cameras.main.height;\r\n            }\r\n            this.mParentCon.setScale(scale);\r\n        }\r\n        // this.mParentCon.scaleX = this.mParentCon.scaleY = this.mWorld.uiScale;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mParentCon.y = (height >> 1) + 50;\r\n            }\r\n            else {\r\n                this.mParentCon.y = (height >> 1) + 50;\r\n            }\r\n        }\r\n        else {\r\n            this.mParentCon.y = (height >> 1) + 50;\r\n        }\r\n    };\r\n    LoginScene.prototype.changeID = function (data) {\r\n        // Logger.debug("============combobox 123" + data.text);\r\n    };\r\n    LoginScene.prototype.changeAccount = function () {\r\n        this.changePanelState(undefined);\r\n    };\r\n    LoginScene.prototype.changePanelState = function (accountData) {\r\n        var boo = !accountData;\r\n        this.verificaHandler(boo);\r\n        var bgRes = !accountData ? "login_loginBgBig" : "login_quickLoginBg";\r\n        this.mBg.setTexture("login", bgRes);\r\n        this.mEnterBtn.y = !accountData ? 40 : 15;\r\n        this.mInputBg_long0.visible = !accountData ? true : false;\r\n        // this.mInputBg_long0.y = accountData === undefined ? 15 : -10;\r\n        this.mtxt3.y = !accountData ? 35 : 8;\r\n        this.mNameInputTxt.visible = !accountData ? true : false;\r\n        this.combobox.visible = !accountData ? false : true;\r\n        // this.mNameInputTxt.y = accountData === undefined ? 5 : -20;\r\n        this.mQuickBtn.visible = !accountData ? true : false;\r\n        this.mTab0.visible = !accountData ? true : false;\r\n        this.mTab1.visible = !accountData ? true : false;\r\n        this.mInputBg_long1.visible = !accountData && this.mCurTabIndex !== 0 ? true : false;\r\n        this.mPassWordInputTxt.visible = !accountData && this.mCurTabIndex !== 0 ? true : false;\r\n        this.mtxt0.visible = !accountData ? true : false;\r\n        this.mtxt1.visible = !accountData ? true : false;\r\n        this.mtxt2.visible = !accountData ? true : false;\r\n        this.mtxt4.visible = !accountData ? false : true;\r\n        var accountObj = accountData !== undefined ? JSON.parse(accountData) : undefined;\r\n        this.mNameInputTxt.text = !accountObj ? "" : accountObj.account;\r\n        this.combobox.text = !accountObj ? [""] : [accountObj.account + ""];\r\n        this.mPassWordInputTxt.text = !accountObj ? "" : accountObj.password;\r\n        this.mParentCon.setSize(this.mBg.width, this.mHei);\r\n        // const scale = this.mParentCon.width / this.cameras.main.width;\r\n        // this.mParentCon.setScale(scale);\r\n    };\r\n    LoginScene.prototype.verificaHandler = function (show) {\r\n        this.mVerificationCodeTxt.visible = show;\r\n        this.mtxt5.visible = show;\r\n        this.mInputBg_small.visible = show;\r\n        this.mSendCodeBtn.visible = show;\r\n        this.mInputBg_long1.visible = !show;\r\n        this.mPassWordInputTxt.visible = !show;\r\n    };\r\n    LoginScene.prototype.quickHandler = function () {\r\n        this.addTween(this.mQuickBtn);\r\n        this.requestQuickLogin();\r\n    };\r\n    LoginScene.prototype.sendCodeHandler = function () {\r\n        this.addTween(this.mSendCodeBtn);\r\n        this.requestGetPhoneCode();\r\n    };\r\n    LoginScene.prototype.enterHandler = function () {\r\n        this.addTween(this.mEnterBtn);\r\n        if (!this.mSendCodeBtn.visible) {\r\n            this.requestLogin();\r\n        }\r\n        else {\r\n            this.loginByPhoneCode();\r\n        }\r\n    };\r\n    LoginScene.prototype.addTween = function (img) {\r\n        this.tweens.add({\r\n            targets: img,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        img.scaleX = img.scaleY = 1;\r\n    };\r\n    LoginScene.prototype.tab0Handler = function (pointer) {\r\n        this.mCurTabIndex = 0;\r\n        this.tabHandler();\r\n    };\r\n    LoginScene.prototype.tab1Handler = function (pointer) {\r\n        this.mCurTabIndex = 1;\r\n        this.tabHandler();\r\n    };\r\n    LoginScene.prototype.tabHandler = function () {\r\n        var _this = this;\r\n        this.mTabDic.forEach(function (image) {\r\n            var tabRes = "";\r\n            tabRes = image.tabIndex === _this.mCurTabIndex ? "login_tabSelect" : "login_tabUnSelect";\r\n            image.setTexture("login", tabRes);\r\n        });\r\n        this.verificaHandler(!this.mCurTabIndex);\r\n    };\r\n    LoginScene.prototype.requestLogin = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.login(login.mNameInputTxt.text, login.mPassWordInputTxt.text).then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                if (login.mNameInputTxt.text && login.mPassWordInputTxt.text)\r\n                    localStorage.setItem("account", JSON.stringify({ "account": login.mNameInputTxt.text, "password": login.mPassWordInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_1 = new _ui_alert_alert__WEBPACK_IMPORTED_MODULE_1__["Alert"](login.mWorld, login);\r\n                alert_1.show("账号密码错误");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.requestGetPhoneCode = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.requestPhoneCode(login.mNameInputTxt.text).then(function (response) {\r\n            if (response.code === 200) {\r\n                login.mVerificationCodeTxt.setText(response.data);\r\n            }\r\n            else {\r\n                var alert_2 = new _ui_alert_alert__WEBPACK_IMPORTED_MODULE_1__["Alert"](login.mWorld, login);\r\n                alert_2.show("验证码获取失败");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.loginByPhoneCode = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.loginByPhoneCode(login.mNameInputTxt.text, login.mVerificationCodeTxt.text).then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                localStorage.setItem("accountphone", JSON.stringify({ "account": login.mNameInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_3 = new _ui_alert_alert__WEBPACK_IMPORTED_MODULE_1__["Alert"](login.mWorld, login);\r\n                alert_3.show("登录失败");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.requestQuickLogin = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.quickLogin().then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                localStorage.setItem("accountphone", JSON.stringify({ "account": login.mNameInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_4 = new _ui_alert_alert__WEBPACK_IMPORTED_MODULE_1__["Alert"](login.mWorld, login);\r\n                alert_4.show("登录失败");\r\n            }\r\n        });\r\n    };\r\n    return LoginScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/login.ts?')},"./src/scenes/main.ui.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MainUIScene", function() { return MainUIScene; });\n/* harmony import */ var _ui_debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ui/debuglog/debug.logger.mediator */ "./src/ui/debuglog/debug.logger.mediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar MainUIScene = /** @class */ (function (_super) {\r\n    __extends(MainUIScene, _super);\r\n    function MainUIScene() {\r\n        return _super.call(this, { key: MainUIScene.name }) || this;\r\n    }\r\n    MainUIScene.prototype.preload = function () {\r\n    };\r\n    MainUIScene.prototype.init = function (data) {\r\n        this.mRoom = data.room;\r\n    };\r\n    MainUIScene.prototype.create = function () {\r\n        this.fps = this.add.text(10, 10, "", { style: { color: "#64DD17" } });\r\n        // this.sizeTF = this.add.text(10, 50, "", { style: { color: "#64DD17" }, wordWrap: { width: 800, useAdvancedWrap: true } });\r\n        // this.sizeTF.setFontSize(20);\r\n        var world = this.mRoom.world;\r\n        if (world.game.device.os.desktop) {\r\n        }\r\n        else {\r\n            world.inputManager.setScene(this);\r\n        }\r\n        world.uiManager.setScene(this);\r\n        // this.mRoom.world.game.scale.on("orientationchange", this.checkOriention, this);\r\n        this.mRoom.world.game.scale.on("resize", this.checkSize, this);\r\n    };\r\n    MainUIScene.prototype.update = function () {\r\n        if (!this.mDebugLoger) {\r\n            this.mDebugLoger = this.mRoom.world.uiManager.getMediator(_ui_debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_0__["DebugLoggerMediator"].NAME);\r\n        }\r\n        if (this.mDebugLoger && this.mDebugLoger.isShow()) {\r\n            this.mDebugLoger.update(this.game.loop.actualFps.toFixed());\r\n        }\r\n        this.fps.setText(this.game.loop.actualFps.toFixed());\r\n        // const orientation: string = this.mRoom.world.getSize().width > this.mRoom.world.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        // this.sizeTF.text = "width:" + this.mRoom.world.getSize().width + "\\n" + "height:" + this.mRoom.world.getSize().height + "\\n" + "orientation:" + orientation + "\\n" + "devicePixelRatio:" + window.devicePixelRatio;\r\n    };\r\n    MainUIScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    // private checkOriention(orientation) {\r\n    //   this.sizeTF.text = "width:" + this.mRoom.world.getSize().width + "\\n" + "height:" + this.mRoom.world.getSize().height + "\\n" + "orientation:" + orientation + "\\n" + "orientationChange:" + orientation;\r\n    // }\r\n    MainUIScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n        //  this.sizeTF.text = "width:" + size.width + ";height:" + size.height;\r\n    };\r\n    return MainUIScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/main.ui.ts?')},"./src/scenes/play.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayScene", function() { return PlayScene; });\n/* harmony import */ var _main_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./main.ui */ "./src/scenes/main.ui.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n// 游戏正式运行用 Phaser.Scene\r\nvar PlayScene = /** @class */ (function (_super) {\r\n    __extends(PlayScene, _super);\r\n    function PlayScene(config) {\r\n        return _super.call(this, config || { key: PlayScene.name }) || this;\r\n    }\r\n    PlayScene.prototype.preload = function () {\r\n    };\r\n    PlayScene.prototype.init = function (data) {\r\n        if (data) {\r\n            this.mRoom = data.room;\r\n        }\r\n    };\r\n    PlayScene.prototype.create = function () {\r\n        var scene = this.game.scene.getScene(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name);\r\n        if (!scene.scene.isActive()) {\r\n            this.scene.launch(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name, {\r\n                room: this.mRoom\r\n            });\r\n        }\r\n        this.scene.sendToBack();\r\n        this.scale.on("orientationchange", this.checkOriention, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        if (this.mRoom)\r\n            this.mRoom.startPlay();\r\n    };\r\n    PlayScene.prototype.update = function (time, delta) {\r\n        // if (this.cameras.main) {\r\n        //   this.cameras.main.emit("renderer", this.cameras.main);\r\n        // }\r\n        if (this.mRoom) {\r\n            this.mRoom.update(time, delta);\r\n        }\r\n    };\r\n    PlayScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    PlayScene.prototype.checkOriention = function (orientation) {\r\n        if (orientation === Phaser.Scale.PORTRAIT) {\r\n        }\r\n        else if (orientation === Phaser.Scale.LANDSCAPE) {\r\n        }\r\n    };\r\n    PlayScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n    };\r\n    return PlayScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/play.ts?')},"./src/ui sync recursive ^\\.\\/.*$":function(module,exports,__webpack_require__){eval('var map = {\n\t"./ComponentRank/ComponentRankMediator": "./src/ui/ComponentRank/ComponentRankMediator.ts",\n\t"./ComponentRank/ComponentRankMediator.ts": "./src/ui/ComponentRank/ComponentRankMediator.ts",\n\t"./ComponentRank/ComponentRankPanel": "./src/ui/ComponentRank/ComponentRankPanel.ts",\n\t"./ComponentRank/ComponentRankPanel.ts": "./src/ui/ComponentRank/ComponentRankPanel.ts",\n\t"./ControlF/ControlFMediator": "./src/ui/ControlF/ControlFMediator.ts",\n\t"./ControlF/ControlFMediator.ts": "./src/ui/ControlF/ControlFMediator.ts",\n\t"./ControlF/ControlFPanel": "./src/ui/ControlF/ControlFPanel.ts",\n\t"./ControlF/ControlFPanel.ts": "./src/ui/ControlF/ControlFPanel.ts",\n\t"./ElementStorage/DragManager": "./src/ui/ElementStorage/DragManager.ts",\n\t"./ElementStorage/DragManager.ts": "./src/ui/ElementStorage/DragManager.ts",\n\t"./ElementStorage/ElementStorageMediator": "./src/ui/ElementStorage/ElementStorageMediator.ts",\n\t"./ElementStorage/ElementStorageMediator.ts": "./src/ui/ElementStorage/ElementStorageMediator.ts",\n\t"./ElementStorage/ElementStoragePanel": "./src/ui/ElementStorage/ElementStoragePanel.ts",\n\t"./ElementStorage/ElementStoragePanel.ts": "./src/ui/ElementStorage/ElementStoragePanel.ts",\n\t"./ElementStorage/ElementStorate": "./src/ui/ElementStorage/ElementStorate.ts",\n\t"./ElementStorage/ElementStorate.ts": "./src/ui/ElementStorage/ElementStorate.ts",\n\t"./ElementStorage/item/Item": "./src/ui/ElementStorage/item/Item.ts",\n\t"./ElementStorage/item/Item.ts": "./src/ui/ElementStorage/item/Item.ts",\n\t"./InteractivePanel/InteractivePanel": "./src/ui/InteractivePanel/InteractivePanel.ts",\n\t"./InteractivePanel/InteractivePanel.ts": "./src/ui/InteractivePanel/InteractivePanel.ts",\n\t"./InteractivePanel/InteractivePanelMediator": "./src/ui/InteractivePanel/InteractivePanelMediator.ts",\n\t"./InteractivePanel/InteractivePanelMediator.ts": "./src/ui/InteractivePanel/InteractivePanelMediator.ts",\n\t"./ItemDetail/ItemDetail": "./src/ui/ItemDetail/ItemDetail.ts",\n\t"./ItemDetail/ItemDetail.ts": "./src/ui/ItemDetail/ItemDetail.ts",\n\t"./ItemDetail/ItemDetailMediator": "./src/ui/ItemDetail/ItemDetailMediator.ts",\n\t"./ItemDetail/ItemDetailMediator.ts": "./src/ui/ItemDetail/ItemDetailMediator.ts",\n\t"./MessageBox/MessageBoxMediator": "./src/ui/MessageBox/MessageBoxMediator.ts",\n\t"./MessageBox/MessageBoxMediator.ts": "./src/ui/MessageBox/MessageBoxMediator.ts",\n\t"./MessageBox/MessageBoxView": "./src/ui/MessageBox/MessageBoxView.ts",\n\t"./MessageBox/MessageBoxView.ts": "./src/ui/MessageBox/MessageBoxView.ts",\n\t"./Notice/NoticeMediator": "./src/ui/Notice/NoticeMediator.ts",\n\t"./Notice/NoticeMediator.ts": "./src/ui/Notice/NoticeMediator.ts",\n\t"./Notice/NoticePanel": "./src/ui/Notice/NoticePanel.ts",\n\t"./Notice/NoticePanel.ts": "./src/ui/Notice/NoticePanel.ts",\n\t"./Rank/BasicRankPanel": "./src/ui/Rank/BasicRankPanel.ts",\n\t"./Rank/BasicRankPanel.ts": "./src/ui/Rank/BasicRankPanel.ts",\n\t"./Rank/RankMediator": "./src/ui/Rank/RankMediator.ts",\n\t"./Rank/RankMediator.ts": "./src/ui/Rank/RankMediator.ts",\n\t"./Rank/RankPanel": "./src/ui/Rank/RankPanel.ts",\n\t"./Rank/RankPanel.ts": "./src/ui/Rank/RankPanel.ts",\n\t"./Shop/ShopMediator": "./src/ui/Shop/ShopMediator.ts",\n\t"./Shop/ShopMediator.ts": "./src/ui/Shop/ShopMediator.ts",\n\t"./Shop/ShopPanel": "./src/ui/Shop/ShopPanel.ts",\n\t"./Shop/ShopPanel.ts": "./src/ui/Shop/ShopPanel.ts",\n\t"./Shop/shop.itemSlot": "./src/ui/Shop/shop.itemSlot.ts",\n\t"./Shop/shop.itemSlot.ts": "./src/ui/Shop/shop.itemSlot.ts",\n\t"./UserInfo/UserInfoMediator": "./src/ui/UserInfo/UserInfoMediator.ts",\n\t"./UserInfo/UserInfoMediator.ts": "./src/ui/UserInfo/UserInfoMediator.ts",\n\t"./UserInfo/UserInfoPanel": "./src/ui/UserInfo/UserInfoPanel.ts",\n\t"./UserInfo/UserInfoPanel.ts": "./src/ui/UserInfo/UserInfoPanel.ts",\n\t"./UserMenu/MenuItem": "./src/ui/UserMenu/MenuItem.ts",\n\t"./UserMenu/MenuItem.ts": "./src/ui/UserMenu/MenuItem.ts",\n\t"./UserMenu/UserMenuMediator": "./src/ui/UserMenu/UserMenuMediator.ts",\n\t"./UserMenu/UserMenuMediator.ts": "./src/ui/UserMenu/UserMenuMediator.ts",\n\t"./UserMenu/UserMenuPanel": "./src/ui/UserMenu/UserMenuPanel.ts",\n\t"./UserMenu/UserMenuPanel.ts": "./src/ui/UserMenu/UserMenuPanel.ts",\n\t"./abstractPanel": "./src/ui/abstractPanel.ts",\n\t"./abstractPanel.ts": "./src/ui/abstractPanel.ts",\n\t"./alert/alert": "./src/ui/alert/alert.ts",\n\t"./alert/alert.ts": "./src/ui/alert/alert.ts",\n\t"./bag/IListItemRender": "./src/ui/bag/IListItemRender.ts",\n\t"./bag/IListItemRender.ts": "./src/ui/bag/IListItemRender.ts",\n\t"./bag/bagView/bagMediator": "./src/ui/bag/bagView/bagMediator.ts",\n\t"./bag/bagView/bagMediator.ts": "./src/ui/bag/bagView/bagMediator.ts",\n\t"./bag/bagView/bagPanel": "./src/ui/bag/bagView/bagPanel.ts",\n\t"./bag/bagView/bagPanel.ts": "./src/ui/bag/bagView/bagPanel.ts",\n\t"./bag/basebag": "./src/ui/bag/basebag.ts",\n\t"./bag/basebag.ts": "./src/ui/bag/basebag.ts",\n\t"./bag/baseitem": "./src/ui/bag/baseitem.ts",\n\t"./bag/baseitem.ts": "./src/ui/bag/baseitem.ts",\n\t"./bag/dragDropIcon": "./src/ui/bag/dragDropIcon.ts",\n\t"./bag/dragDropIcon.ts": "./src/ui/bag/dragDropIcon.ts",\n\t"./bag/idragable": "./src/ui/bag/idragable.ts",\n\t"./bag/idragable.ts": "./src/ui/bag/idragable.ts",\n\t"./bag/idropable": "./src/ui/bag/idropable.ts",\n\t"./bag/idropable.ts": "./src/ui/bag/idropable.ts",\n\t"./bag/item.slot": "./src/ui/bag/item.slot.ts",\n\t"./bag/item.slot.ts": "./src/ui/bag/item.slot.ts",\n\t"./bag/storage/storageMediator": "./src/ui/bag/storage/storageMediator.ts",\n\t"./bag/storage/storageMediator.ts": "./src/ui/bag/storage/storageMediator.ts",\n\t"./bag/storage/storagePanel": "./src/ui/bag/storage/storagePanel.ts",\n\t"./bag/storage/storagePanel.ts": "./src/ui/bag/storage/storagePanel.ts",\n\t"./baseMediator": "./src/ui/baseMediator.ts",\n\t"./baseMediator.ts": "./src/ui/baseMediator.ts",\n\t"./baseView/bagGroup/bag.group": "./src/ui/baseView/bagGroup/bag.group.ts",\n\t"./baseView/bagGroup/bag.group.mediator": "./src/ui/baseView/bagGroup/bag.group.mediator.ts",\n\t"./baseView/bagGroup/bag.group.mediator.ts": "./src/ui/baseView/bagGroup/bag.group.mediator.ts",\n\t"./baseView/bagGroup/bag.group.ts": "./src/ui/baseView/bagGroup/bag.group.ts",\n\t"./baseView/baseFace.mediator": "./src/ui/baseView/baseFace.mediator.ts",\n\t"./baseView/baseFace.mediator.ts": "./src/ui/baseView/baseFace.mediator.ts",\n\t"./baseView/bottomGroup/bottom.btn.group": "./src/ui/baseView/bottomGroup/bottom.btn.group.ts",\n\t"./baseView/bottomGroup/bottom.btn.group.ts": "./src/ui/baseView/bottomGroup/bottom.btn.group.ts",\n\t"./baseView/bottomGroup/bottom.mediator": "./src/ui/baseView/bottomGroup/bottom.mediator.ts",\n\t"./baseView/bottomGroup/bottom.mediator.ts": "./src/ui/baseView/bottomGroup/bottom.mediator.ts",\n\t"./baseView/icon.btn": "./src/ui/baseView/icon.btn.ts",\n\t"./baseView/icon.btn.ts": "./src/ui/baseView/icon.btn.ts",\n\t"./baseView/icon.select.btn": "./src/ui/baseView/icon.select.btn.ts",\n\t"./baseView/icon.select.btn.ts": "./src/ui/baseView/icon.select.btn.ts",\n\t"./baseView/leftGroup/left.btn.group": "./src/ui/baseView/leftGroup/left.btn.group.ts",\n\t"./baseView/leftGroup/left.btn.group.ts": "./src/ui/baseView/leftGroup/left.btn.group.ts",\n\t"./baseView/leftGroup/left.mediator": "./src/ui/baseView/leftGroup/left.mediator.ts",\n\t"./baseView/leftGroup/left.mediator.ts": "./src/ui/baseView/leftGroup/left.mediator.ts",\n\t"./baseView/rightGroup/right.btn.group": "./src/ui/baseView/rightGroup/right.btn.group.ts",\n\t"./baseView/rightGroup/right.btn.group.ts": "./src/ui/baseView/rightGroup/right.btn.group.ts",\n\t"./baseView/rightGroup/right.mediator": "./src/ui/baseView/rightGroup/right.mediator.ts",\n\t"./baseView/rightGroup/right.mediator.ts": "./src/ui/baseView/rightGroup/right.mediator.ts",\n\t"./baseView/top.menu/top.menu.container": "./src/ui/baseView/top.menu/top.menu.container.ts",\n\t"./baseView/top.menu/top.menu.container.ts": "./src/ui/baseView/top.menu/top.menu.container.ts",\n\t"./baseView/top.menu/top.menu.mediator": "./src/ui/baseView/top.menu/top.menu.mediator.ts",\n\t"./baseView/top.menu/top.menu.mediator.ts": "./src/ui/baseView/top.menu/top.menu.mediator.ts",\n\t"./baseView/topGroup/top.btn.group": "./src/ui/baseView/topGroup/top.btn.group.ts",\n\t"./baseView/topGroup/top.btn.group.ts": "./src/ui/baseView/topGroup/top.btn.group.ts",\n\t"./baseView/topGroup/top.mediator": "./src/ui/baseView/topGroup/top.mediator.ts",\n\t"./baseView/topGroup/top.mediator.ts": "./src/ui/baseView/topGroup/top.mediator.ts",\n\t"./chat/base.chat.panel": "./src/ui/chat/base.chat.panel.ts",\n\t"./chat/base.chat.panel.ts": "./src/ui/chat/base.chat.panel.ts",\n\t"./chat/chat.mediator": "./src/ui/chat/chat.mediator.ts",\n\t"./chat/chat.mediator.ts": "./src/ui/chat/chat.mediator.ts",\n\t"./chat/message": "./src/ui/chat/message.ts",\n\t"./chat/message.ts": "./src/ui/chat/message.ts",\n\t"./chat/mobile/chatPanel.mobile": "./src/ui/chat/mobile/chatPanel.mobile.ts",\n\t"./chat/mobile/chatPanel.mobile.ts": "./src/ui/chat/mobile/chatPanel.mobile.ts",\n\t"./chat/pc/chatPanel.pc": "./src/ui/chat/pc/chatPanel.pc.ts",\n\t"./chat/pc/chatPanel.pc.ts": "./src/ui/chat/pc/chatPanel.pc.ts",\n\t"./components/check.button": "./src/ui/components/check.button.ts",\n\t"./components/check.button.ts": "./src/ui/components/check.button.ts",\n\t"./components/checkbox.group": "./src/ui/components/checkbox.group.ts",\n\t"./components/checkbox.group.ts": "./src/ui/components/checkbox.group.ts",\n\t"./components/comboBox": "./src/ui/components/comboBox.ts",\n\t"./components/comboBox.ts": "./src/ui/components/comboBox.ts",\n\t"./components/dynamic.image": "./src/ui/components/dynamic.image.ts",\n\t"./components/dynamic.image.ts": "./src/ui/components/dynamic.image.ts",\n\t"./components/dynamic.ninepatch": "./src/ui/components/dynamic.ninepatch.ts",\n\t"./components/dynamic.ninepatch.ts": "./src/ui/components/dynamic.ninepatch.ts",\n\t"./components/dynamic.sprite": "./src/ui/components/dynamic.sprite.ts",\n\t"./components/dynamic.sprite.ts": "./src/ui/components/dynamic.sprite.ts",\n\t"./components/message.box": "./src/ui/components/message.box.ts",\n\t"./components/message.box.ts": "./src/ui/components/message.box.ts",\n\t"./components/nine.patch": "./src/ui/components/nine.patch.ts",\n\t"./components/nine.patch.ts": "./src/ui/components/nine.patch.ts",\n\t"./components/ninepatch.button": "./src/ui/components/ninepatch.button.ts",\n\t"./components/ninepatch.button.ts": "./src/ui/components/ninepatch.button.ts",\n\t"./components/panel": "./src/ui/components/panel.ts",\n\t"./components/panel.ts": "./src/ui/components/panel.ts",\n\t"./components/patches.config": "./src/ui/components/patches.config.ts",\n\t"./components/patches.config.ts": "./src/ui/components/patches.config.ts",\n\t"./components/radio": "./src/ui/components/radio.ts",\n\t"./components/radio.ts": "./src/ui/components/radio.ts",\n\t"./components/scroller": "./src/ui/components/scroller.ts",\n\t"./components/scroller.ts": "./src/ui/components/scroller.ts",\n\t"./components/scroller.view": "./src/ui/components/scroller.view.ts",\n\t"./components/scroller.view.ts": "./src/ui/components/scroller.view.ts",\n\t"./debuglog/debug.logger": "./src/ui/debuglog/debug.logger.ts",\n\t"./debuglog/debug.logger.mediator": "./src/ui/debuglog/debug.logger.mediator.ts",\n\t"./debuglog/debug.logger.mediator.ts": "./src/ui/debuglog/debug.logger.mediator.ts",\n\t"./debuglog/debug.logger.ts": "./src/ui/debuglog/debug.logger.ts",\n\t"./decorate/decorate.manager": "./src/ui/decorate/decorate.manager.ts",\n\t"./decorate/decorate.manager.ts": "./src/ui/decorate/decorate.manager.ts",\n\t"./decorate/decorate.panel": "./src/ui/decorate/decorate.panel.ts",\n\t"./decorate/decorate.panel.ts": "./src/ui/decorate/decorate.panel.ts",\n\t"./friend/friend.mediator": "./src/ui/friend/friend.mediator.ts",\n\t"./friend/friend.mediator.ts": "./src/ui/friend/friend.mediator.ts",\n\t"./friend/friend.panel": "./src/ui/friend/friend.panel.ts",\n\t"./friend/friend.panel.ts": "./src/ui/friend/friend.panel.ts",\n\t"./layer.manager": "./src/ui/layer.manager.ts",\n\t"./layer.manager.ts": "./src/ui/layer.manager.ts",\n\t"./loadview": "./src/ui/loadview.ts",\n\t"./loadview.ts": "./src/ui/loadview.ts",\n\t"./tips/itoolTip": "./src/ui/tips/itoolTip.ts",\n\t"./tips/itoolTip.ts": "./src/ui/tips/itoolTip.ts",\n\t"./tips/toolTip": "./src/ui/tips/toolTip.ts",\n\t"./tips/toolTip.ts": "./src/ui/tips/toolTip.ts",\n\t"./ui.manager": "./src/ui/ui.manager.ts",\n\t"./ui.manager.ts": "./src/ui/ui.manager.ts",\n\t"./ui.mediatorType": "./src/ui/ui.mediatorType.ts",\n\t"./ui.mediatorType.ts": "./src/ui/ui.mediatorType.ts"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\te.code = \'MODULE_NOT_FOUND\';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = "./src/ui sync recursive ^\\\\.\\\\/.*$";\n\n//# sourceURL=webpack://TooqingCore/./src/ui_sync_^\\.\\/.*$?')},"./src/ui/ComponentRank/ComponentRankMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentRankMediator", function() { return ComponentRankMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentRankPanel */ "./src/ui/ComponentRank/ComponentRankPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ComponentRankMediator = /** @class */ (function (_super) {\r\n    __extends(ComponentRankMediator, _super);\r\n    function ComponentRankMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this, worldService) || this;\r\n        _this.mUIType = 2 /* NormalUIType */;\r\n        _this.mView = new _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_1__["ComponentRankPanel"](scene, worldService);\r\n        layerManager.addToUILayer(_this.mView);\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        return _this;\r\n    }\r\n    ComponentRankMediator.prototype.setViewAdd = function (wid, hei) {\r\n        this.mAddWid = wid;\r\n        this.mAddHei = hei;\r\n    };\r\n    ComponentRankMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    ComponentRankMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    ComponentRankMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    ComponentRankMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ComponentRankMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    ComponentRankMediator.prototype.resize = function () {\r\n        this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    ComponentRankMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_1__["ComponentRankPanel"](this.mScene, this.world);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.show();\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ComponentRankMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            if (this.mView.parentContainer) {\r\n                this.mView.parentContainer.remove(this.mView);\r\n            }\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    ComponentRankMediator.prototype.update = function (param) {\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n    };\r\n    ComponentRankMediator.NAME = "ComponentRankMediator";\r\n    return ComponentRankMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ComponentRank/ComponentRankMediator.ts?')},"./src/ui/ComponentRank/ComponentRankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentRankPanel", function() { return ComponentRankPanel; });\n/* harmony import */ var _Rank_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Rank/BasicRankPanel */ "./src/ui/Rank/BasicRankPanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ComponentRankMediator */ "./src/ui/ComponentRank/ComponentRankMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ComponentRankPanel = /** @class */ (function (_super) {\r\n    __extends(ComponentRankPanel, _super);\r\n    function ComponentRankPanel(scene, worldService) {\r\n        return _super.call(this, scene, worldService) || this;\r\n    }\r\n    ComponentRankPanel.prototype.resize = function (wid, hei) {\r\n        if (!this.scene)\r\n            return;\r\n        var view = this.scene.cameras.main.worldView;\r\n        this.x = view.width - this.width - wid >> 1;\r\n        this.y = view.height - this.height - hei >> 1;\r\n    };\r\n    ComponentRankPanel.prototype.destroy = function () {\r\n        if (this.mCloseBtn) {\r\n            this.mCloseBtn.destroy(true);\r\n            this.mCloseBtn = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComponentRankPanel.prototype.preload = function () {\r\n        this.scene.load.spritesheet(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getFrameConfig());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ComponentRankPanel.prototype.init = function () {\r\n        this.mCloseBtn = this.mScene.make.image({\r\n            x: 0,\r\n            y: 0,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(),\r\n            frame: "btn_normal"\r\n        }, false);\r\n        this.mCloseBtn.setTexture(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(), "btn_normal");\r\n        this.mCloseBtn.x = (this.mWidth >> 1) - 65;\r\n        this.mCloseBtn.y = (-this.mHeight >> 1);\r\n        _super.prototype.init.call(this);\r\n        this.add(this.mCloseBtn);\r\n        this.mCloseBtn.setInteractive();\r\n        this.mCloseBtn.once("pointerup", this.onCloseHandler, this);\r\n        this.mWorld.uiManager.getMediator(_ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__["ComponentRankMediator"].NAME).resize();\r\n        this.mCloseBtn.x = this.width - 18;\r\n    };\r\n    ComponentRankPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__["ComponentRankMediator"].NAME).resize();\r\n    };\r\n    ComponentRankPanel.prototype.onCloseHandler = function () {\r\n        this.hide();\r\n    };\r\n    return ComponentRankPanel;\r\n}(_Rank_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__["BasicRankPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ComponentRank/ComponentRankPanel.ts?')},"./src/ui/ControlF/ControlFMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ControlFMediator", function() { return ControlFMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _ControlFPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ControlFPanel */ "./src/ui/ControlF/ControlFPanel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../rooms/element/element */ "./src/rooms/element/element.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar ControlFMediator = /** @class */ (function (_super) {\r\n    __extends(ControlFMediator, _super);\r\n    function ControlFMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mUIType = 3 /* TipsUIType */;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    ControlFMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    ControlFMediator.prototype.getView = function () {\r\n        return undefined;\r\n    };\r\n    ControlFMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView && this.mView.isShow()) {\r\n            if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager.actor ||\r\n                this.world.roomManager.currentRoom.playerManager.actor.getState() === _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["PlayerState"].WALK) {\r\n                this.mView.off("control", this.handControlF, this);\r\n                this.mView.destroy();\r\n                this.mView = null;\r\n            }\r\n        }\r\n    };\r\n    ControlFMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ControlFMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    ControlFMediator.prototype.resize = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    ControlFMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.isShowing) {\r\n            return;\r\n        }\r\n        this.mView = new _ControlFPanel__WEBPACK_IMPORTED_MODULE_1__["ControlFPanel"](this.mScene, this.world);\r\n        this.mView.on("control", this.handControlF, this);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ControlFMediator.prototype.update = function (param) {\r\n    };\r\n    ControlFMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.off("control", this.handControlF, this);\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n        this.mLayerManager = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ControlFMediator.prototype.handControlF = function () {\r\n        if (!this.world || !this.world.connection) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n        var content = pkt.content;\r\n        var keyArr = this.world.inputManager.getKeyDowns();\r\n        keyArr = keyArr.concat(Phaser.Input.Keyboard.KeyCodes.F);\r\n        content.keyCodes = keyArr;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ControlFMediator.NAME = "ControlFMediator";\r\n    return ControlFMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ControlF/ControlFMediator.ts?')},"./src/ui/ControlF/ControlFPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ControlFPanel", function() { return ControlFPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ControlFPanel = /** @class */ (function (_super) {\r\n    __extends(ControlFPanel, _super);\r\n    function ControlFPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ControlFPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.on("pointerdown", this.onMouseDownHandler, this);\r\n        this.on("pointerup", this.onMouseUpHandler, this);\r\n    };\r\n    ControlFPanel.prototype.hide = function () {\r\n        this.off("pointerdown", this.onMouseDownHandler, this);\r\n        this.off("pointerup", this.onMouseUpHandler, this);\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ControlFPanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        if (!this.mScene)\r\n            return;\r\n        var worldView = this.mScene.cameras.main.worldView;\r\n        this.x = worldView.x + (worldView.width >> 1);\r\n        this.y = worldView.y + (worldView.height >> 1);\r\n    };\r\n    ControlFPanel.prototype.destroy = function () {\r\n        if (this.mControlText)\r\n            this.mControlText.destroy(true);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ControlFPanel.prototype.preload = function () {\r\n        this.mScene.load.image("controlF_background", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/controlf/background.png"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ControlFPanel.prototype.init = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        var image = this.mScene.make.image({\r\n            key: "controlF_background"\r\n        }, false);\r\n        this.add(image);\r\n        // TODO 不一定是F\r\n        this.mControlText = this.mScene.make.text({\r\n            align: "center",\r\n            text: "F",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_20_BOLD }\r\n        }, false);\r\n        this.mControlText.x = -(this.mControlText.width >> 1);\r\n        this.mControlText.y = -(this.mControlText.height >> 1);\r\n        this.add(this.mControlText);\r\n        this.setSize(image.width, image.height);\r\n        this.setInteractive();\r\n        _super.prototype.init.call(this);\r\n        this.resize();\r\n    };\r\n    ControlFPanel.prototype.onMouseDownHandler = function () {\r\n        this.scale = 0.8;\r\n    };\r\n    ControlFPanel.prototype.onMouseUpHandler = function () {\r\n        this.scale = 1;\r\n        this.emit("control");\r\n    };\r\n    return ControlFPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ControlF/ControlFPanel.ts?')},"./src/ui/ElementStorage/DragManager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragManager", function() { return DragManager; });\nvar DragManager = /** @class */ (function () {\r\n    function DragManager(scene) {\r\n        // this.mImage = scene.make.image()\r\n    }\r\n    DragManager.prototype.setDragProp = function (prop) {\r\n    };\r\n    return DragManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/DragManager.ts?')},"./src/ui/ElementStorage/ElementStorageMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorageMediator", function() { return ElementStorageMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _ElementStoragePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ElementStoragePanel */ "./src/ui/ElementStorage/ElementStoragePanel.ts");\n/* harmony import */ var _ElementStorate__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ElementStorate */ "./src/ui/ElementStorage/ElementStorate.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ElementStorageMediator = /** @class */ (function (_super) {\r\n    __extends(ElementStorageMediator, _super);\r\n    function ElementStorageMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mStorage = new _ElementStorate__WEBPACK_IMPORTED_MODULE_2__["ElementStorage"](world);\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.register();\r\n        return _this;\r\n    }\r\n    ElementStorageMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.isShowing) {\r\n            return;\r\n        }\r\n        this.mView = new _ElementStoragePanel__WEBPACK_IMPORTED_MODULE_1__["ElementStoragePanel"](this.mScene, this.world);\r\n        this.mStorage.register();\r\n        this.mStorage.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_MODE_QUERY_PACKAGE, this.onEditModeQueryPackageHandler, this);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.on("queryElement", this.onQueryElementHandler, this);\r\n        this.mView.on("selectedElement", this.onSelectedElement, this);\r\n        this.mView.show(param);\r\n    };\r\n    ElementStorageMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    /**\r\n     * 展开\r\n     */\r\n    ElementStorageMediator.prototype.expand = function () {\r\n        var view = this.getView();\r\n        if (view) {\r\n            view.expand();\r\n        }\r\n    };\r\n    /**\r\n     * 收起\r\n     */\r\n    ElementStorageMediator.prototype.collapse = function () {\r\n        var view = this.getView();\r\n        if (view) {\r\n            view.collapse();\r\n        }\r\n    };\r\n    ElementStorageMediator.prototype.destroy = function () {\r\n        this.unregister();\r\n        if (this.mStorage) {\r\n            this.mStorage.unregister();\r\n            this.mStorage = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ElementStorageMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    ElementStorageMediator.prototype.onQueryElementHandler = function (page, perPage) {\r\n        this.mStorage.queryPackage(page, perPage);\r\n    };\r\n    ElementStorageMediator.prototype.register = function () {\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_EXPANED, this.onExpanedHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_COLLAPSE, this.onCollapseHandler, this);\r\n    };\r\n    ElementStorageMediator.prototype.unregister = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_EXPANED, this.onExpanedHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].EDIT_PACKAGE_COLLAPSE, this.onCollapseHandler, this);\r\n    };\r\n    ElementStorageMediator.prototype.onEditModeQueryPackageHandler = function (items) {\r\n        if (!items) {\r\n            return;\r\n        }\r\n        this.getView().setProps(items);\r\n    };\r\n    ElementStorageMediator.prototype.onSelectedElement = function (prop) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_4__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SELECTED_SPRITE);\r\n        var content = packet.content;\r\n        content.id = prop.id;\r\n        this.world.connection.send(packet);\r\n    };\r\n    ElementStorageMediator.prototype.onExpanedHandler = function () {\r\n        this.expand();\r\n    };\r\n    ElementStorageMediator.prototype.onCollapseHandler = function () {\r\n        this.collapse();\r\n    };\r\n    ElementStorageMediator.NAME = "ElementStorageMediator";\r\n    return ElementStorageMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStorageMediator.ts?')},"./src/ui/ElementStorage/ElementStoragePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStoragePanel", function() { return ElementStoragePanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _item_Item__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./item/Item */ "./src/ui/ElementStorage/item/Item.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ElementStoragePanel = /** @class */ (function (_super) {\r\n    __extends(ElementStoragePanel, _super);\r\n    function ElementStoragePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mExpaned = true;\r\n        _this.mItemNum = 32;\r\n        return _this;\r\n    }\r\n    ElementStoragePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized) {\r\n            this.setPackageNum(1);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.resize = function (oriention) {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.setSize(683 >> 1, 901 >> 1);\r\n            this.x = size.width - (this.width * this.mWorld.uiScale) - 10;\r\n            this.y = size.height - this.height * this.mWorld.uiScale >> 1;\r\n            this.mBackground.resize(this.width, this.height);\r\n            this.mBackground.x = this.mBackground.width >> 1;\r\n            this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBorder.resize(655 >> 1, 847 >> 1);\r\n            this.mBorder.x = 7 + (this.mBorder.width >> 1);\r\n            this.mBorder.y = 19 + (this.mBorder.height >> 1);\r\n            this.mSearchInput.x = 40 + 105;\r\n            this.mSearchInput.y = 40;\r\n            this.mDragBtn.x = -this.mDragBtn.height;\r\n            this.mDragBtn.y = this.height >> 1;\r\n            // for (let i = 0; i < this.mTabs.length; i++) {\r\n            //     this.mTabs[i].x = 280;\r\n            //     this.mTabs[i].y = 60 + i * this.mTabs[i].height + 10;\r\n            // }\r\n            var len = this.mProps.length;\r\n            for (var i = 0; i < len; i++) {\r\n                // this.mProps[i].setPosition((i % 8) * 60 + 20, Math.ceil(i / 8) * 60 + 80);\r\n                this.mProps[i].x = (i % 4) * 60 + 20;\r\n                this.mProps[i].y = Math.floor(i / 4) * 60 + 80;\r\n            }\r\n        }\r\n        else {\r\n            this.setSize(510, 329);\r\n            // this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width, this.height));\r\n            // this.scale = this.mWorld.uiScale;\r\n            this.mBackground.resize(this.width, this.height);\r\n            this.mBackground.x = this.mBackground.width >> 1;\r\n            this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBorder.resize(496, 303);\r\n            this.mBorder.x = 7 + (this.mBorder.width >> 1);\r\n            this.mBorder.y = 19 + (this.mBorder.height >> 1);\r\n            this.mSearchInput.x = 270;\r\n            this.mSearchInput.y = 33;\r\n            this.x = (size.width - this.width * this.mWorld.uiScale >> 1);\r\n            this.y = size.height - this.height * this.mWorld.uiScale - 10;\r\n            this.mDragBtn.x = this.width >> 1;\r\n            this.mDragBtn.y = -this.mDragBtn.height >> 1;\r\n            // for (let i = 0; i < this.mTabs.length; i++) {\r\n            //     this.mTabs[i].x = 24 + i * this.mTabs[i].width + 10;\r\n            //     this.mTabs[i].y = 33;\r\n            // }\r\n            var len = this.mProps.length;\r\n            for (var i = 0; i < len; i++) {\r\n                // this.mProps[i].setPosition((i % 8) * 60 + 20, Math.ceil(i / 8) * 60 + 80);\r\n                this.mProps[i].x = (i % 8) * 60 + 20;\r\n                this.mProps[i].y = Math.floor(i / 8) * 60 + 80;\r\n            }\r\n        }\r\n        this.mPrePageBtn.y = this.height >> 1;\r\n        this.mNextPageBtn.x = this.width;\r\n        this.mNextPageBtn.y = this.height >> 1;\r\n        this.scale = this.mWorld.uiScale;\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width, this.height), Phaser.Geom.Rectangle.Contains);\r\n        // this.setScale(this.mWorld.uiScale, this.mWorld.uiScale);\r\n        // this.scaleX = this.scaleY = 5;\r\n    };\r\n    ElementStoragePanel.prototype.setProps = function (data) {\r\n        var items = data.items;\r\n        this.clearItem();\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (i >= this.mProps.length) {\r\n                return;\r\n            }\r\n            this.mProps[i].setProp(items[i]);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.expand = function () {\r\n        if (this.mExpaned) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        var props = null;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            props = { x: size.width - (this.width * this.mWorld.uiScale) - 10 };\r\n        }\r\n        else {\r\n            props = { y: size.height - this.height * this.mWorld.uiScale - 10 };\r\n        }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: props\r\n        });\r\n        this.remove(this.mDragBtn);\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn]);\r\n        this.mExpaned = true;\r\n    };\r\n    ElementStoragePanel.prototype.collapse = function () {\r\n        if (!this.mExpaned) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        var props = null;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            props = { x: size.width };\r\n        }\r\n        else {\r\n            props = { y: size.height };\r\n        }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: props\r\n        });\r\n        this.addAt(this.mDragBtn, 0);\r\n        this.remove([this.mPrePageBtn, this.mNextPageBtn]);\r\n        this.mExpaned = false;\r\n    };\r\n    ElementStoragePanel.prototype.destroy = function () {\r\n        this.scene.input.off("dragstart", this.onDragStartHandler, this);\r\n        this.scene.input.off("dragend", this.onDragEndHandler, this);\r\n        this.scene.input.off("drag", this.onDragHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ElementStoragePanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.scene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/button.png"));\r\n        this.scene.load.image("prop_background", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/prop_background.png"));\r\n        this.scene.load.atlas("slip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.json"));\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ElementStoragePanel.prototype.init = function () {\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 0, 0, this.width, this.height, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getConfig());\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 7, 19, 655 >> 1, 847 >> 1, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        // this.mBackground.setInteractive();\r\n        this.mBackground.on("pointerout", this.onPointerOutHandler, this);\r\n        // TODO 多语言配置\r\n        this.mSearchInput = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, 40 + 105, 40, 210, 26, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080",\r\n            placeholder: "输入关键词进行搜索"\r\n        });\r\n        var config = {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n        this.mDragBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__["NinePatchButton"](this.scene, 0, -20, 80, 40, "button", "", "物件容器", config);\r\n        this.mDragBtn.on("pointerup", this.switchExpand, this);\r\n        // this.mTabs = [];\r\n        // const button = new NinePatchButton(this.scene, 280, 40, 60, 30, "button", "地块",  config);\r\n        // const button2 = new NinePatchButton(this.scene, 280, 80, 60, 30, "button", "物件",  config);\r\n        // const checkbox = new CheckboxGroup().appendItemAll([button, button2]);\r\n        // checkbox.on("selected", this.onSelectedHandler, this);\r\n        // this.mTabs.push(button);\r\n        // this.mTabs.push(button2);\r\n        this.mPrePageBtn = this.scene.make.sprite({\r\n            key: "slip"\r\n        }, false);\r\n        this.mPrePageBtn.setInteractive();\r\n        this.mPrePageBtn.on("pointerup", this.onPrePageHandler, this);\r\n        this.mNextPageBtn = this.scene.make.sprite({\r\n            key: "slip"\r\n        }, false).setFlipX(true);\r\n        this.mNextPageBtn.setInteractive();\r\n        this.mNextPageBtn.on("pointerup", this.onNextPageHandler, this);\r\n        this.mProps = [];\r\n        this.add([this.mBackground, this.mBorder, this.mSearchInput]);\r\n        for (var i = 0; i < this.mItemNum; i++) {\r\n            var item = new _item_Item__WEBPACK_IMPORTED_MODULE_5__["Item"](this.scene);\r\n            // this.add(item);\r\n            // this.scene.input.setDraggable(item);\r\n            // item.on("click", this.onClick, this);\r\n            this.mProps[i] = item;\r\n        }\r\n        this.add(this.mProps);\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn]);\r\n        _super.prototype.init.call(this);\r\n        this.resize();\r\n        this.scene.input.on("dragstart", this.onDragStartHandler, this);\r\n        this.scene.input.on("dragend", this.onDragEndHandler, this);\r\n        this.scene.input.on("drag", this.onDragHandler, this);\r\n        this.expand();\r\n    };\r\n    ElementStoragePanel.prototype.onPrePageHandler = function () {\r\n        this.setPackageNum(this.mPacgeNum - 1);\r\n    };\r\n    ElementStoragePanel.prototype.onNextPageHandler = function () {\r\n        this.setPackageNum(this.mPacgeNum + 1);\r\n    };\r\n    ElementStoragePanel.prototype.setPackageNum = function (val) {\r\n        this.mPacgeNum = val < 1 ? 1 : val;\r\n        this.emit("queryElement", this.mPacgeNum, 32);\r\n    };\r\n    ElementStoragePanel.prototype.switchExpand = function () {\r\n        this.mExpaned ? this.collapse() : this.expand();\r\n    };\r\n    ElementStoragePanel.prototype.onSelectedHandler = function () {\r\n    };\r\n    ElementStoragePanel.prototype.onClick = function (data) {\r\n        // this.emit("selectedElement", data);\r\n    };\r\n    ElementStoragePanel.prototype.onDragStartHandler = function (pointer, gameobject, dragX, dragY) {\r\n        var item = gameobject.parentContainer;\r\n        if (item instanceof _item_Item__WEBPACK_IMPORTED_MODULE_5__["Item"]) {\r\n            // this.emit("selectedElement", item.prop);\r\n            // gameobject.x = dragX;\r\n            // gameobject.y = dragX;\r\n            this.mDragData = item.prop;\r\n        }\r\n        if (!this.mDragImage) {\r\n            this.mDragImage = this.scene.make.image(undefined, false);\r\n            this.add(this.mDragImage);\r\n        }\r\n        this.mDragImage.x = item.x;\r\n        this.mDragImage.y = item.y;\r\n        this.mDragImage.setTexture(gameobject.texture.key);\r\n        this.mDragging = true;\r\n        // this.mDragImage.texture = gameobject.texture;\r\n        // Logger.getInstance().log("======", pointer, gameobject);\r\n    };\r\n    ElementStoragePanel.prototype.onDragEndHandler = function () {\r\n        if (!this.mDragImage) {\r\n            return;\r\n        }\r\n        this.mDragImage.setTexture(undefined);\r\n        this.mDragging = false;\r\n    };\r\n    ElementStoragePanel.prototype.onDragHandler = function (pointer, gameobject, dragX, dragY) {\r\n        if (!this.mDragImage) {\r\n            return;\r\n        }\r\n        this.mDragImage.x += pointer.x - pointer.prevPosition.x;\r\n        this.mDragImage.y += pointer.y - pointer.prevPosition.y;\r\n    };\r\n    ElementStoragePanel.prototype.onPointerOutHandler = function () {\r\n        if (this.mDragImage && this.mDragging) {\r\n            this.emit("selectedElement", this.mDragData);\r\n            this.mDragImage.setTexture(undefined);\r\n            this.mDragging = false;\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.clearItem = function () {\r\n        if (!this.mProps)\r\n            return;\r\n        this.mProps.map(function (item) { return item.clear(); });\r\n    };\r\n    return ElementStoragePanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStoragePanel.ts?')},"./src/ui/ElementStorage/ElementStorate.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorage", function() { return ElementStorage; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ElementStorage = /** @class */ (function (_super) {\r\n    __extends(ElementStorage, _super);\r\n    function ElementStorage($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.event = new Phaser.Events.EventEmitter();\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_QUERY_EDIT_PACKAGE, _this.onQueryEditPackageResuleHandler);\r\n        return _this;\r\n    }\r\n    ElementStorage.prototype.register = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        this.world.connection.addPacketListener(this);\r\n    };\r\n    ElementStorage.prototype.unregister = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        this.world.connection.removePacketListener(this);\r\n        this.event.removeAllListeners();\r\n    };\r\n    ElementStorage.prototype.on = function (event, fn, context) {\r\n        this.event.on(event, fn, context);\r\n    };\r\n    ElementStorage.prototype.off = function (event, fn, context) {\r\n        this.event.off(event, fn, context);\r\n    };\r\n    /**\r\n     * 请求编辑背包\r\n     */\r\n    ElementStorage.prototype.queryPackage = function (page, perPage, nodeType, queryString) {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_QUERY_EDIT_PACKAGE);\r\n        var content = packet.content;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        content.nodeType = nodeType;\r\n        content.queryString = queryString;\r\n        this.world.connection.send(packet);\r\n    };\r\n    ElementStorage.prototype.destroy = function () {\r\n        this.unregister();\r\n    };\r\n    ElementStorage.prototype.onQueryEditPackageResuleHandler = function (packet) {\r\n        this.event.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_MODE_QUERY_PACKAGE, packet.content);\r\n    };\r\n    return ElementStorage;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStorate.ts?')},"./src/ui/ElementStorage/item/Item.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Item", function() { return Item; });\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Item = /** @class */ (function (_super) {\r\n    __extends(Item, _super);\r\n    function Item(scene) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var background = scene.make.image({\r\n            key: "prop_background"\r\n        }).setOrigin(0, 0);\r\n        _this.setSize(background.width, background.height);\r\n        _this.add(background);\r\n        _this.mImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"](_this.scene, 0, 0).setOrigin(0, 0);\r\n        _this.add(_this.mImage);\r\n        _this.mCount = scene.make.text(undefined, false);\r\n        _this.mCount.setAlign("right");\r\n        _this.mCount.y = _this.height - 20;\r\n        _this.add(_this.mCount);\r\n        return _this;\r\n    }\r\n    Item.prototype.setProp = function (prop) {\r\n        var _this = this;\r\n        this.mProp = prop;\r\n        if (!this.mCount) {\r\n            return;\r\n        }\r\n        if (prop) {\r\n            this.mImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(prop.display.texturePath), this, function () {\r\n                // this.mImage.on("dragstart", this.onPointerUpHandler, this);\r\n                _this.mImage.setInteractive();\r\n                _this.scene.input.setDraggable(_this.mImage);\r\n                var imageScale = 1;\r\n                if (_this.mImage.width > _this.width) {\r\n                    imageScale = _this.width / _this.mImage.width;\r\n                }\r\n                if (_this.mImage.height > _this.height) {\r\n                    imageScale = _this.height / _this.mImage.height;\r\n                }\r\n                _this.mImage.scale = imageScale;\r\n            });\r\n            this.mCount.setText(prop.count > 1 ? prop.count.toString() : "");\r\n            this.mCount.x = this.width - this.mCount.width;\r\n        }\r\n    };\r\n    Item.prototype.clear = function () {\r\n        if (!this.count) {\r\n            return;\r\n        }\r\n        if (!this.mProp) {\r\n            return;\r\n        }\r\n        this.mCount.setText("");\r\n        this.mImage.setTexture(undefined);\r\n        this.mImage.off("pointerup", this.onPointerUpHandler, this);\r\n        this.mProp = undefined;\r\n    };\r\n    Item.prototype.destroy = function () {\r\n        this.clear();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(Item.prototype, "prop", {\r\n        get: function () {\r\n            return this.mProp;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Item.prototype.onPointerUpHandler = function () {\r\n        this.emit("click", this.mProp);\r\n    };\r\n    return Item;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/item/Item.ts?')},"./src/ui/InteractivePanel/InteractivePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractivePanel", function() { return InteractivePanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _components_radio__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/radio */ "./src/ui/components/radio.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n/* harmony import */ var _InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./InteractivePanelMediator */ "./src/ui/InteractivePanel/InteractivePanelMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar InteractivePanel = /** @class */ (function (_super) {\r\n    __extends(InteractivePanel, _super);\r\n    function InteractivePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mRadioCom = false;\r\n        _this.mLeftBaseScaleX = 1;\r\n        _this.mLeftBaseScaleY = 1;\r\n        _this.mMidBaseScaleX = 1;\r\n        _this.mMidBaseScaleY = 1;\r\n        _this.mRightBaseScaleX = 1;\r\n        _this.mRightBaseScaleY = 1;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 通過參數進行ui佈局\r\n     * @param param\r\n     * @param radioClick\r\n     */\r\n    InteractivePanel.prototype.show = function (param) {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        this.mData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShowing = true;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        var data = this.mData[0];\r\n        if (this.mLeftFaceIcon)\r\n            this.mLeftFaceIcon.visible = false;\r\n        if (this.mRightFaceIcon)\r\n            this.mRightFaceIcon.visible = false;\r\n        if (this.mMidFaceIcon)\r\n            this.mMidFaceIcon.visible = false;\r\n        if (data.display && data.display.length > 0) {\r\n            var uiDisplay = data.display[0];\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(uiDisplay.texturePath);\r\n            if (this.scene.cache.obj.get(url)) {\r\n                this.onLoadComplete();\r\n            }\r\n            else {\r\n                this.scene.load.image(url, url);\r\n                this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n                this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n                this.scene.load.start();\r\n            }\r\n        }\r\n        this.mDescTF.text = "";\r\n        this.mNameTF.text = "";\r\n        if (data.text) {\r\n            if (data.text.length > 0) {\r\n                var descData = data.text[0];\r\n                this.mDescCon.setData("nodeID", descData.node.id);\r\n                this.mDescTF.text = descData.text;\r\n                this.mDescCon.off("pointerdown", this.descConClick, this);\r\n                this.mDescCon.on("pointerdown", this.descConClick, this);\r\n                if (data.text[1]) {\r\n                    var nameData = data.text[1];\r\n                    this.mNameCon.setData("nodeID", nameData.node.id);\r\n                    this.mNameTF.text = nameData.text;\r\n                    this.mNameTF.x = -this.mNameTF.width >> 1;\r\n                    this.mNameCon.off("pointerdown", this.nameConClick, this);\r\n                    this.mNameCon.on("pointerdown", this.nameConClick, this);\r\n                }\r\n            }\r\n        }\r\n        if (this.mRadio)\r\n            this.mRadio.visible = false;\r\n        if (data.button && data.button.length > 0) {\r\n            var tmpHei = (data.button.length - 1) * 33 + 46;\r\n            if (!this.mRadio) {\r\n                this.mRadio = new _components_radio__WEBPACK_IMPORTED_MODULE_3__["Radio"](this.mScene, {\r\n                    wid: 350,\r\n                    hei: tmpHei,\r\n                    resKey: "juqing",\r\n                    resPng: "./resources/ui/juqing/juqing.png",\r\n                    resJson: "./resources/ui/juqing/juqing.json",\r\n                    resBg: "radio_bg.png",\r\n                    resArrow: "radio_arrow.png",\r\n                    fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n                    completeBack: function () {\r\n                        _this.radioComplete();\r\n                    },\r\n                    clickCallBack: function (itemData) {\r\n                        if (!itemData || !med)\r\n                            return;\r\n                        med.componentClick(itemData.data);\r\n                    }\r\n                });\r\n                this.radioComplete();\r\n            }\r\n            this.setRadioData(data.button);\r\n            this.mRadio.visible = true;\r\n        }\r\n        this.resize();\r\n        if (this.mShowing) {\r\n            return;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    InteractivePanel.prototype.update = function (param) {\r\n        this.show(param);\r\n    };\r\n    InteractivePanel.prototype.getRadio = function () {\r\n        return this.mRadio;\r\n    };\r\n    InteractivePanel.prototype.setRadioData = function (data) {\r\n        this.mRadio.setRadioData(data);\r\n    };\r\n    InteractivePanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        var size = this.mWorld.getSize();\r\n        this.mNameCon.add(this.mNameBg);\r\n        this.mNameCon.add(this.mNameTF);\r\n        this.mDescCon.add(this.mBg);\r\n        this.mDescCon.add(this.mBorder);\r\n        this.mDescCon.add(this.mDescTF);\r\n        this.add(this.mNameCon);\r\n        this.add(this.mDescCon);\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.y = size.height / 2 - 250;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mBg.resize((size.width - 10) / this.mWorld.uiScale, size.height * .5 / this.mWorld.uiScale);\r\n                this.mBorder.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n            }\r\n            else {\r\n                this.mBg.resize((size.width - 10) / this.mWorld.uiScale, size.height * .5 / this.mWorld.uiScale);\r\n                this.mBorder.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n            }\r\n            this.y = this.mBg.height * 1.5 * this.mWorld.uiScale;\r\n        }\r\n        this.x = size.width >> 1;\r\n        this.refreshUIPos();\r\n        if (this.mRadio) {\r\n            this.add(this.mRadio);\r\n        }\r\n    };\r\n    InteractivePanel.prototype.destroy = function () {\r\n        this.mInitialized = false;\r\n        if (this.mNameCon) {\r\n            this.mNameCon.off("pointerdown", this.nameConClick, this);\r\n            this.mNameCon.destroy(true);\r\n        }\r\n        if (this.mDescCon) {\r\n            this.mDescCon.off("pointerdown", this.descConClick, this);\r\n            this.mDescCon.destroy(true);\r\n        }\r\n        if (this.mLeftFaceIcon) {\r\n            this.mLeftFaceIcon.off("pointerdown", this.leftFaceClick, this);\r\n            this.mLeftFaceIcon.destroy(true);\r\n        }\r\n        if (this.mMidFaceIcon) {\r\n            this.mMidFaceIcon.off("pointerdown", this.midFaceClick, this);\r\n            this.mMidFaceIcon.destroy(true);\r\n        }\r\n        if (this.mRightFaceIcon) {\r\n            this.mRightFaceIcon.off("pointerdown", this.midFaceClick, this);\r\n            this.mRightFaceIcon.destroy(true);\r\n        }\r\n        if (this.mNameTF) {\r\n            this.mNameTF.destroy(true);\r\n        }\r\n        if (this.mDescTF) {\r\n            this.mDescTF.destroy(true);\r\n        }\r\n        if (this.mRadio) {\r\n            this.mRadio.destroy();\r\n        }\r\n        this.mNameCon = null;\r\n        this.mDescCon = null;\r\n        this.mLeftFaceIcon = null;\r\n        this.mMidFaceIcon = null;\r\n        this.mRightFaceIcon = null;\r\n        this.mNameTF = null;\r\n        this.mDescTF = null;\r\n        this.mRadio = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractivePanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.atlas("juqing", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/juqing/juqing.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/juqing/juqing.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    InteractivePanel.prototype.init = function () {\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        this.mNameCon = this.mScene.make.container(undefined, false);\r\n        this.mDescCon = this.mScene.make.container(undefined, false);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 1080, 320, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 1040, 280, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mLeftFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mMidFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mRightFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mNameTF = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.mBorder.width\r\n            },\r\n        });\r\n        this.mNameBg = this.mScene.make.image(undefined, false);\r\n        this.mNameBg.setTexture("juqing", "juqing_name.png");\r\n        this.mDescTF = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.mBorder.width\r\n            },\r\n        });\r\n        this.mDescCon.setSize(this.mBg.width, this.mBg.height);\r\n        this.mNameCon.setSize(this.mNameBg.width, this.mNameBg.height);\r\n        this.mDescCon.setInteractive();\r\n        this.mNameCon.setInteractive();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    InteractivePanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.resize();\r\n    };\r\n    InteractivePanel.prototype.refreshUIPos = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mDescCon.setSize(this.mBg.width, this.mBg.height);\r\n        this.mNameCon.setSize(this.mNameBg.width, this.mNameBg.height);\r\n        this.mNameTF.y = -8 * this.mWorld.uiScale;\r\n        this.mDescTF.x = -this.mBorder.width / 2;\r\n        this.mDescTF.y = -this.mBorder.height / 2;\r\n        this.mDescCon.y = this.mWorld.game.device.os.desktop ? size.height / 2 + 80 : 0;\r\n        this.mNameCon.x = 150 - this.mDescCon.width / 2;\r\n        this.mNameCon.y = this.mDescCon.y - this.mDescCon.height / 2 - this.mNameCon.height / 2 - 10;\r\n        this.mNameTF.setWrapWidth(this.mBorder.width);\r\n        this.mDescTF.setWrapWidth(this.mBorder.width);\r\n        this.mNameTF.x = -this.mNameTF.width >> 1;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            var leftIconWid = this.mLeftFaceIcon.width * this.mWorld.uiScale;\r\n            var leftIconHei = this.mLeftFaceIcon.height * this.mWorld.uiScale;\r\n            var leftScale = 1;\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                leftScale = leftIconWid > size.width * .5 ? size.width * .5 / leftIconWid : leftIconWid / size.width * .5;\r\n            }\r\n            else {\r\n                leftScale = leftIconHei > size.height * .5 ? size.height * .5 / leftIconHei : leftIconHei / size.height * .5;\r\n            }\r\n            this.mLeftFaceIcon.scaleX = this.mLeftBaseScaleX * leftScale * .7;\r\n            this.mLeftFaceIcon.scaleY = this.mLeftBaseScaleY * leftScale * .7;\r\n            this.mLeftFaceIcon.x = this.mNameCon.x;\r\n            this.mLeftFaceIcon.y = this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mLeftFaceIcon.height * leftScale * .7 / 2;\r\n            var midScale = 1;\r\n            var midIconWid = this.mMidFaceIcon.width * this.mWorld.uiScale;\r\n            var midIconHei = this.mMidFaceIcon.height * this.mWorld.uiScale;\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                midScale = midIconWid > size.width * .5 ? size.width * .5 / midIconWid : midIconWid / size.width * .5;\r\n            }\r\n            else {\r\n                midScale = midIconHei > size.height * .5 ? size.height * .5 / midIconHei : midIconHei / size.height * .5;\r\n            }\r\n            this.mMidFaceIcon.scaleX = this.mMidBaseScaleX * midScale * .7;\r\n            this.mMidFaceIcon.scaleY = this.mMidBaseScaleY * midScale * .7;\r\n            this.mMidFaceIcon.x = 0;\r\n            this.mMidFaceIcon.y = this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mMidFaceIcon.height * midScale * .7 / 2;\r\n            var rightScale = 1;\r\n            var rightIconWid = this.mRightFaceIcon.width * this.mWorld.uiScale;\r\n            var rightIconHei = this.mRightFaceIcon.height * this.mWorld.uiScale;\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                rightScale = rightIconWid > size.width * .5 ? size.width * .5 / rightIconWid : rightIconWid / size.width * .5;\r\n            }\r\n            else {\r\n                rightScale = rightIconHei > size.height * .5 ? size.height * .5 / rightIconHei : rightIconHei / size.height * .5;\r\n            }\r\n            this.mRightFaceIcon.scaleX = this.mRightBaseScaleX * rightScale * .7;\r\n            this.mRightFaceIcon.scaleY = this.mRightBaseScaleY * rightScale * .7;\r\n            this.mRightFaceIcon.x = -this.mNameCon.x;\r\n            this.mRightFaceIcon.y = this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mRightFaceIcon.height * rightScale * .7 / 2;\r\n        }\r\n        if (this.mRadioCom) {\r\n            if (this.mWorld.game.device.os.desktop) {\r\n                this.mRadio.x = this.mBg.x + this.mBg.width / 2 - this.mRadio.width;\r\n                this.mRadio.y = this.mDescCon.y + this.mDescCon.height / 2 - this.mRadio.height;\r\n            }\r\n            else {\r\n                this.mRadio.x = this.mBg.width / 2 - this.mRadio.width;\r\n                this.mRadio.y = this.mBg.height / 2 - this.mRadio.height;\r\n            }\r\n        }\r\n    };\r\n    InteractivePanel.prototype.onLoadComplete = function () {\r\n        var size = this.mWorld.getSize();\r\n        var data = this.mData[0];\r\n        var uiDisplay = data.display[0];\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(uiDisplay.texturePath);\r\n        var imgX = -this.mBorder.width / 2;\r\n        var imgY = -this.mBorder.height / 2;\r\n        var scaleX = uiDisplay.scaleX;\r\n        var scaleY = uiDisplay.scaleY;\r\n        var scale = 1;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        switch (uiDisplay.horizontal) {\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_LEFT:\r\n                this.mLeftFaceIcon.setTexture(url);\r\n                this.mLeftFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mLeftBaseScaleX = scaleX;\r\n                this.mLeftBaseScaleY = scaleY;\r\n                if (!this.mWorld.game.device.os.desktop) {\r\n                    if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                        scale = this.mLeftFaceIcon.width > size.width * .5 ? size.width * .5 / this.mLeftFaceIcon.width : this.mLeftFaceIcon.width / size.width * .5;\r\n                    }\r\n                    else {\r\n                        scale = this.mLeftFaceIcon.height > size.height * .5 ? size.height * .5 / this.mLeftFaceIcon.height : this.mLeftFaceIcon.height / size.height * .5;\r\n                    }\r\n                }\r\n                this.mLeftFaceIcon.scaleX = scaleX * scale;\r\n                this.mLeftFaceIcon.scaleY = scaleY * scale;\r\n                this.mLeftFaceIcon.x = imgX + 200;\r\n                this.mLeftFaceIcon.y = imgY + this.mLeftFaceIcon.height / 4;\r\n                this.mLeftFaceIcon.setInteractive();\r\n                this.addAt(this.mLeftFaceIcon, 0);\r\n                this.mLeftFaceIcon.visible = true;\r\n                this.mLeftFaceIcon.off("pointerdown", this.leftFaceClick, this);\r\n                this.mLeftFaceIcon.on("pointerdown", this.leftFaceClick, this);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_CENTER:\r\n                this.mMidFaceIcon.setTexture(url);\r\n                this.mMidFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mMidBaseScaleX = scaleX;\r\n                this.mMidBaseScaleY = scaleY;\r\n                if (!this.mWorld.game.device.os.desktop) {\r\n                    if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                        scale = this.mMidFaceIcon.width > size.width * .5 ? size.width * .5 / this.mMidFaceIcon.width : this.mMidFaceIcon.width / size.width * .5;\r\n                    }\r\n                    else {\r\n                        scale = this.mMidFaceIcon.height > size.height * .5 ? size.height * .5 / this.mMidFaceIcon.height : this.mMidFaceIcon.height / size.height * .5;\r\n                    }\r\n                }\r\n                this.mMidFaceIcon.scaleX = scaleX * scale;\r\n                this.mMidFaceIcon.scaleY = scaleY * scale;\r\n                this.mMidFaceIcon.x = 0;\r\n                this.mMidFaceIcon.y = imgY + this.mMidFaceIcon.height / 4;\r\n                this.addAt(this.mMidFaceIcon, 0);\r\n                this.mMidFaceIcon.visible = true;\r\n                this.mLeftFaceIcon.off("pointerdown", this.midFaceClick, this);\r\n                this.mMidFaceIcon.on("pointerdown", this.midFaceClick, this);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_RIGHT:\r\n                this.mRightFaceIcon.setTexture(url);\r\n                this.mRightFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mRightBaseScaleX = scaleX;\r\n                this.mRightBaseScaleY = scaleY;\r\n                if (!this.mWorld.game.device.os.desktop) {\r\n                    if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                        scale = this.mRightFaceIcon.width > size.width * .5 ? size.width * .5 / this.mRightFaceIcon.width : this.mRightFaceIcon.width / size.width * .5;\r\n                    }\r\n                    else {\r\n                        scale = this.mRightFaceIcon.height > size.height * .5 ? size.height * .5 / this.mRightFaceIcon.height : this.mRightFaceIcon.height / size.height * .5;\r\n                    }\r\n                }\r\n                this.mRightFaceIcon.scaleX = scaleX * scale;\r\n                this.mRightFaceIcon.scaleY = scaleY * scale;\r\n                this.mRightFaceIcon.x = 200;\r\n                this.mRightFaceIcon.y = imgY + this.mRightFaceIcon.height / 4;\r\n                this.addAt(this.mRightFaceIcon, 0);\r\n                this.mRightFaceIcon.visible = true;\r\n                this.mRightFaceIcon.off("pointerdown", this.rightFaceClick, this);\r\n                this.mRightFaceIcon.on("pointerdown", this.rightFaceClick, this);\r\n                break;\r\n        }\r\n        this.resize();\r\n    };\r\n    InteractivePanel.prototype.rightFaceClick = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mRightFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.midFaceClick = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mMidFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.leftFaceClick = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mLeftFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.descConClick = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!this.mDescCon.getData("nodeID") || !med)\r\n            return;\r\n        med.componentClick(this.mDescCon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.nameConClick = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!this.mNameCon.getData("nodeID") || !med)\r\n            return;\r\n        med.componentClick(this.mNameCon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.onLoadError = function (file) {\r\n    };\r\n    InteractivePanel.prototype.radioComplete = function () {\r\n        this.mRadioCom = true;\r\n        var size = this.mWorld.getSize();\r\n        if (!this.mRadio)\r\n            return;\r\n        // this.mRadio.x = 220;\r\n        // this.mRadio.y = this.mDescCon.height + 200;\r\n        this.resize();\r\n    };\r\n    return InteractivePanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InteractivePanel/InteractivePanel.ts?')},"./src/ui/InteractivePanel/InteractivePanelMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractivePanelMediator", function() { return InteractivePanelMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _InteractivePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InteractivePanel */ "./src/ui/InteractivePanel/InteractivePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar InteractivePanelMediator = /** @class */ (function (_super) {\r\n    __extends(InteractivePanelMediator, _super);\r\n    function InteractivePanelMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mUIType = 4 /* MonopolyUIType */;\r\n        _this.mScene = scene;\r\n        return _this;\r\n    }\r\n    InteractivePanelMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    InteractivePanelMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    InteractivePanelMediator.prototype.resize = function () {\r\n        if (this.mView && this.mView.isShow)\r\n            return this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    InteractivePanelMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    InteractivePanelMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _InteractivePanel__WEBPACK_IMPORTED_MODULE_1__["InteractivePanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    InteractivePanelMediator.prototype.update = function (param) {\r\n        if (!this.mView || !this.mView.isShow) {\r\n            return;\r\n        }\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    InteractivePanelMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    InteractivePanelMediator.prototype.destroy = function () {\r\n        this.world = null;\r\n        this.mScene = null;\r\n        this.mParam = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractivePanelMediator.prototype.componentClick = function (componentID) {\r\n        if (this.mParam) {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getInteractive().requestTargetUI(this.mParam[0].id, componentID);\r\n        }\r\n    };\r\n    InteractivePanelMediator.NAME = "InteractivePanelMediator";\r\n    return InteractivePanelMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InteractivePanel/InteractivePanelMediator.ts?')},"./src/ui/ItemDetail/ItemDetail.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemDetail", function() { return ItemDetail; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../bag/dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ItemDetail = /** @class */ (function (_super) {\r\n    __extends(ItemDetail, _super);\r\n    function ItemDetail(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mBtnWid = 100;\r\n        _this.mBtnHei = 40;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        return _this;\r\n    }\r\n    ItemDetail.prototype.getBtnList = function () {\r\n        return this.mBtnList;\r\n    };\r\n    ItemDetail.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width - (this.width + this.mBtnWid) / 2 * this.mWorld.uiScale >> 1;\r\n            this.y = size.height - this.height * this.mWorld.uiScale >> 1;\r\n        }\r\n        else {\r\n            this.x = size.width - (this.width + this.mBtnWid) / 2 * this.mWorld.uiScale >> 1;\r\n            this.y = size.height - this.height * this.mWorld.uiScale >> 1;\r\n        }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    ItemDetail.prototype.show = function (param) {\r\n        this.mData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShowing = true;\r\n        var data = this.mData[0];\r\n        if (data.display.length > 0) {\r\n            this.loadIcon(data.display[0]);\r\n        }\r\n        if (data.text.length > 0) {\r\n            this.setText(data.text[0].text);\r\n        }\r\n        if (data.button.length > 0) {\r\n            this.mBtnList = [];\r\n            var btn = void 0;\r\n            var len = data.button.length;\r\n            var preY = 20;\r\n            var preX = this.mWid + 50;\r\n            for (var i = 0; i < len; i++) {\r\n                var btnData = data.button[i];\r\n                btn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, this.mBtnWid, this.mBtnHei, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getName(), "", btnData.text, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getConfig(), btnData);\r\n                this.mBtnList.push(btn);\r\n                btn.x = preX;\r\n                btn.y = preY;\r\n                preY += btn.height + 40;\r\n                this.add(btn);\r\n            }\r\n        }\r\n        var bg = this.mScene.add.graphics();\r\n        bg.fillStyle(0, .6);\r\n        bg.fillRoundedRect(0, 0, this.mWid, this.mHei, 6);\r\n        this.addAt(bg, 0);\r\n        this.setSize(this.mWid + 120, this.mHei);\r\n        this.resize();\r\n        this.setInteractive();\r\n    };\r\n    ItemDetail.prototype.setText = function (value) {\r\n        this.mDescTF.setText(value);\r\n        this.mHei += this.mDescTF.y + this.mDescTF.height + 10;\r\n    };\r\n    ItemDetail.prototype.loadIcon = function (value) {\r\n        var _this = this;\r\n        if (this.mIcon) {\r\n            this.mIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(value), function () {\r\n                _this.mHei += _this.mIcon.y + _this.mIcon.height;\r\n                // if (this.mCallBack) this.mCallBack();\r\n            });\r\n        }\r\n    };\r\n    ItemDetail.prototype.hide = function () {\r\n        this.removeInteractive();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ItemDetail.prototype.destroy = function () {\r\n        if (this.mBtnList) {\r\n            this.mBtnList.forEach(function (btn) {\r\n                btn.destroy(true);\r\n                btn = null;\r\n            });\r\n            this.mBtnList = null;\r\n        }\r\n        this.mResStr = "";\r\n        this.mResPng = "";\r\n        this.mResJson = "";\r\n        if (this.mNameTF)\r\n            this.mNameTF.destroy(true);\r\n        if (this.mDescTF)\r\n            this.mDescTF.destroy(true);\r\n        if (this.mIcon)\r\n            this.mIcon.destroy();\r\n        this.mNameTF = null;\r\n        this.mDescTF = null;\r\n        this.mIcon = null;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ItemDetail.prototype.preload = function () {\r\n        this.mResStr = "itemDetail";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getJSON());\r\n        this.mScene.load.atlas("itemDetail", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ItemDetail.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mWid = 290;\r\n        this.mHei = 0;\r\n        this.mIcon = new _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_2__["DragDropIcon"](this.mScene, 30, 25);\r\n        this.add(this.mIcon);\r\n        this.mNameTF = this.scene.make.text({\r\n            style: {\r\n                fontFamily: "YaHei",\r\n                fontSize: 20,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 250, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mNameTF.setFontStyle("bold");\r\n        this.mNameTF.setAlign("left");\r\n        this.mNameTF.x = this.mIcon.x + this.mIcon.width;\r\n        this.mNameTF.y = this.mIcon.y;\r\n        this.add(this.mNameTF);\r\n        this.mDescTF = this.scene.make.text({\r\n            style: {\r\n                fontFamily: "YaHei",\r\n                fontSize: 25,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 250, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mDescTF.setFontStyle("bold");\r\n        this.mDescTF.setAlign("left");\r\n        this.mDescTF.x = this.mIcon.x - this.mIcon.width / 2;\r\n        this.mDescTF.y = this.mIcon.y + this.mIcon.height + 20;\r\n        this.add(this.mDescTF);\r\n        this.mInitialized = true;\r\n        this.show(this.mData);\r\n    };\r\n    return ItemDetail;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemDetail/ItemDetail.ts?')},"./src/ui/ItemDetail/ItemDetailMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemDetailMediator", function() { return ItemDetailMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _ItemDetail__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ItemDetail */ "./src/ui/ItemDetail/ItemDetail.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar ItemDetailMediator = /** @class */ (function (_super) {\r\n    __extends(ItemDetailMediator, _super);\r\n    function ItemDetailMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 3 /* TipsUIType */;\r\n        _this.mLayerManager = layerManager;\r\n        return _this;\r\n    }\r\n    ItemDetailMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ItemDetailMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    ItemDetailMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _ItemDetail__WEBPACK_IMPORTED_MODULE_1__["ItemDetail"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToToolTipsLayer(this.mView);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        this.isShowing = true;\r\n    };\r\n    ItemDetailMediator.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    ItemDetailMediator.prototype.hide = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ItemDetailMediator.prototype.destroy = function () {\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ItemDetailMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (!gameobject)\r\n            return;\r\n        if (gameobject instanceof _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__["NinePatchButton"]) {\r\n            var param = this.mParam[0];\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n            var content = pkt.content;\r\n            content.uiId = param.id;\r\n            content.componentId = gameobject.getBtnData().node.id;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    return ItemDetailMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemDetail/ItemDetailMediator.ts?')},"./src/ui/MessageBox/MessageBoxMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxMediator", function() { return MessageBoxMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _MessageBoxView__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MessageBoxView */ "./src/ui/MessageBox/MessageBoxView.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_4__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar MessageBoxMediator = /** @class */ (function (_super) {\r\n    __extends(MessageBoxMediator, _super);\r\n    function MessageBoxMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mUIType = 3 /* TipsUIType */;\r\n        return _this;\r\n    }\r\n    MessageBoxMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    MessageBoxMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    MessageBoxMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _MessageBoxView__WEBPACK_IMPORTED_MODULE_1__["MessageBoxView"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToToolTipsLayer(this.mView);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    MessageBoxMediator.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    MessageBoxMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        this.mView.hide();\r\n        this.mView = null;\r\n    };\r\n    MessageBoxMediator.prototype.destroy = function () {\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MessageBoxMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (!gameobject)\r\n            return;\r\n        if (gameobject instanceof _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__["NinePatchButton"]) {\r\n            var param = this.mParam[0];\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_4__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n            var content = pkt.content;\r\n            content.uiId = param.id;\r\n            content.componentId = gameobject.getBtnData().node.id;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    return MessageBoxMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MessageBox/MessageBoxMediator.ts?')},"./src/ui/MessageBox/MessageBoxView.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxView", function() { return MessageBoxView; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar MessageBoxView = /** @class */ (function (_super) {\r\n    __extends(MessageBoxView, _super);\r\n    function MessageBoxView(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    MessageBoxView.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n        else {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n    };\r\n    MessageBoxView.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.mButtons = [];\r\n        if (param[0] && param[0].text && param[0].text[0]) {\r\n            this.mTxt.setText(param[0].text[0].text);\r\n        }\r\n        var buttons = param[0].button;\r\n        // buttons.push({text:"测试",});\r\n        if (buttons) {\r\n            var btnWid = 46;\r\n            var btnHei = 24;\r\n            var w = (this.mWidth) / buttons.length;\r\n            var btnSp = this.mScene.make.container(undefined, false);\r\n            btnSp.y = this.mHeight - btnHei - 100;\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                var txt = buttons[i] ? buttons[i].text : "";\r\n                var btn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__["NinePatchButton"](this.mScene, 0, 0, btnWid, btnHei, "button_blue", "", buttons[i].text, {\r\n                    top: 7,\r\n                    bottom: 7,\r\n                    left: 7,\r\n                    right: 7\r\n                }, buttons[i]);\r\n                btn.x = i * w + btnWid / 2;\r\n                this.mButtons.push(btn);\r\n                btnSp.add(btn);\r\n            }\r\n            btnSp.setSize((buttons.length - 1) * w + btnWid, btnHei);\r\n            btnSp.x = this.width - btnSp.width >> 1;\r\n            this.add(btnSp);\r\n        }\r\n        this.resize();\r\n    };\r\n    MessageBoxView.prototype.destroy = function () {\r\n        if (this.mTxt) {\r\n            this.mTxt.destroy(true);\r\n        }\r\n        if (this.mButtons && this.mButtons.length > 0) {\r\n            this.mButtons.forEach(function (btn) {\r\n                if (!btn)\r\n                    return;\r\n                btn.destroy(true);\r\n            });\r\n            this.mButtons.length = 0;\r\n            this.mButtons = [];\r\n        }\r\n        this.mTxt = null;\r\n        this.mButtons = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(MessageBoxView.prototype, "buttons", {\r\n        get: function () {\r\n            return this.mButtons;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MessageBoxView.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getJSON());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    MessageBoxView.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mWidth = 300;\r\n        this.mHeight = 200;\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, this.mWidth, this.mHeight, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        border.x = 0;\r\n        border.y = 0;\r\n        this.add(border);\r\n        this.mTxt = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_4__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "16px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: border.width\r\n            },\r\n            halign: "center"\r\n        });\r\n        this.mTxt.x = -this.mWidth / 2 + 10;\r\n        this.mTxt.y = -this.mHeight / 2 + 10;\r\n        this.add(this.mTxt);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    return MessageBoxView;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MessageBox/MessageBoxView.ts?')},"./src/ui/Notice/NoticeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NoticeMediator", function() { return NoticeMediator; });\n/* harmony import */ var _NoticePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NoticePanel */ "./src/ui/Notice/NoticePanel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _game_world__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../game/world */ "./src/game/world.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar NoticeMediator = /** @class */ (function (_super) {\r\n    __extends(NoticeMediator, _super);\r\n    function NoticeMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mAddWid = 0;\r\n        _this.mAddHei = 0;\r\n        _this.world = worldService;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 3 /* TipsUIType */;\r\n        var connect = worldService.connection;\r\n        if (connect) {\r\n            connect.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_NOTICE, _this.noticeHandler);\r\n        }\r\n        _this.world.emitter.on(_game_world__WEBPACK_IMPORTED_MODULE_3__["World"].SCALE_CHANGE, _this.scaleChange, _this);\r\n        return _this;\r\n    }\r\n    NoticeMediator.prototype.setViewAdd = function (wid, hei) {\r\n        this.mAddWid = wid;\r\n        this.mAddHei = hei;\r\n    };\r\n    NoticeMediator.prototype.setUiScale = function (value) {\r\n        this.mNoticePanel.scaleX = this.mNoticePanel.scaleY = value;\r\n    };\r\n    NoticeMediator.prototype.getView = function () {\r\n        return this.mNoticePanel;\r\n    };\r\n    NoticeMediator.prototype.getUIType = function () {\r\n        return this.mUIType;\r\n    };\r\n    NoticeMediator.prototype.hide = function () {\r\n        if (!this.mNoticePanel)\r\n            return;\r\n        this.mNoticePanel.hide();\r\n        this.mNoticePanel = null;\r\n    };\r\n    NoticeMediator.prototype.destroy = function () {\r\n        this.world.emitter.off(_game_world__WEBPACK_IMPORTED_MODULE_3__["World"].SCALE_CHANGE, this.scaleChange, this);\r\n        if (this.mNoticePanel) {\r\n            this.mNoticePanel.destroy();\r\n            this.mNoticePanel = null;\r\n        }\r\n        var connect = this.world.connection;\r\n        if (connect) {\r\n            connect.addPacketListener(this);\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    NoticeMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    NoticeMediator.prototype.isShow = function () {\r\n        return this.mNoticePanel.isShow();\r\n    };\r\n    NoticeMediator.prototype.showing = function () {\r\n        return false;\r\n    };\r\n    NoticeMediator.prototype.tweenView = function (show) {\r\n    };\r\n    NoticeMediator.prototype.resize = function () {\r\n        if (!this.mNoticePanel)\r\n            return;\r\n        this.mNoticePanel.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    NoticeMediator.prototype.show = function (param) {\r\n        if (this.mNoticePanel && this.mNoticePanel.isShow()) {\r\n            return;\r\n        }\r\n        this.mNoticePanel = new _NoticePanel__WEBPACK_IMPORTED_MODULE_0__["NoticePanel"](this.mScene, this.world);\r\n        this.mNoticePanel.show(param);\r\n        this.mNoticePanel.showNotice(param);\r\n        this.mLayerManager.addToDialogLayer(this.mNoticePanel);\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    NoticeMediator.prototype.update = function (param) {\r\n        this.mParam = param;\r\n        if (!this.mNoticePanel)\r\n            return;\r\n    };\r\n    NoticeMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    NoticeMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    NoticeMediator.prototype.scaleChange = function () {\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    NoticeMediator.prototype.noticeHandler = function (packet) {\r\n        this.show(packet.content);\r\n    };\r\n    NoticeMediator.NAME = "NoticeMediator";\r\n    return NoticeMediator;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Notice/NoticeMediator.ts?')},"./src/ui/Notice/NoticePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NoticePanel", function() { return NoticePanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar NoticePanel = /** @class */ (function (_super) {\r\n    __extends(NoticePanel, _super);\r\n    function NoticePanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    NoticePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.setData("data", param);\r\n        this.resize();\r\n    };\r\n    NoticePanel.prototype.destroy = function () {\r\n        if (this.mContentText) {\r\n            this.mContentText.destroy();\r\n            this.mContentText = null;\r\n        }\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            this.mTween = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    NoticePanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        var view = this.scene.cameras.main.worldView;\r\n        this.x = view.x + view.width + wid >> 1;\r\n        this.y = 180 + hei;\r\n    };\r\n    NoticePanel.prototype.showNotice = function (data) {\r\n        var _this = this;\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!data)\r\n            return;\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n        }\r\n        var setting = data.chatsetting;\r\n        this.mContentText.setText(data.noticeContext);\r\n        this.mContentText.setFill(setting.textColor ? setting.textColor : "#FFFFFF");\r\n        this.mContentText.x = -(this.mContentText.width >> 1);\r\n        this.mContentText.y = -(this.mContentText.height >> 1);\r\n        this.mTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 1,\r\n            duration: 200\r\n        });\r\n        var delay = setting.duration ? setting.duration : 5000;\r\n        this.mTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 200,\r\n            delay: delay,\r\n            onComplete: function () {\r\n                _this.removeFromParent();\r\n            }\r\n        });\r\n    };\r\n    NoticePanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    NoticePanel.prototype.init = function () {\r\n        // const background = new NinePatch(this.scene, {\r\n        //     width: 1200,\r\n        //     height: 120,\r\n        //     key: Border.getName(),\r\n        //     columns: Border.getColumns(),\r\n        //     rows: Border.getRows()\r\n        // });\r\n        var background = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 1200, 120, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.add(background);\r\n        this.mContentText = this.scene.make.text({\r\n            align: "center",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_20_BOLD, wordWrap: { width: 1180, useAdvancedWrap: true } }\r\n        }, false)\r\n            .setStroke("#000000", 1);\r\n        this.add(this.mContentText);\r\n        _super.prototype.init.call(this);\r\n        var data = this.getData("data");\r\n        if (data) {\r\n            this.showNotice(data);\r\n        }\r\n    };\r\n    NoticePanel.prototype.removeFromParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            this.mTween = null;\r\n        }\r\n    };\r\n    return NoticePanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Notice/NoticePanel.ts?')},"./src/ui/Rank/BasicRankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicRankPanel", function() { return BasicRankPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar BasicRankPanel = /** @class */ (function (_super) {\r\n    __extends(BasicRankPanel, _super);\r\n    function BasicRankPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mTexts = [];\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    BasicRankPanel.prototype.addItem = function (items) {\r\n        this.setData("data", items);\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.clearText();\r\n        var texts = items.text;\r\n        if (!texts || texts.length < 1)\r\n            return;\r\n        if (this.mTitleLabel) {\r\n            this.mTitleLabel.setText(texts[0].text);\r\n            this.mTitleLabel.setData("node", texts[0].node);\r\n        }\r\n        var locX = [-this.mWidth / 2 + 15, -this.mWidth / 2 + 63, -this.mWidth / 2 + 241];\r\n        var tmpY = 0;\r\n        for (var i = 1; i < 4; i++) {\r\n            var text = this.scene.make.text({\r\n                x: locX[i - 1],\r\n                y: -this.mHeight / 2 + 22,\r\n                text: texts ? texts[i].text : "123",\r\n                style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_16_BOLD }\r\n            }, false);\r\n            tmpY = text.y;\r\n            text.setData("node", texts[i].node);\r\n            text.setStroke("#000000", 2);\r\n            this.mContentContainer.add(text);\r\n            this.mTexts.push(text);\r\n        }\r\n        tmpY += 20;\r\n        for (var i = 4; i < texts.length; i++) {\r\n            var t = texts[i];\r\n            var x = (i - 4) % 3;\r\n            var y = Math.floor((i - 4) / 3) * 22; // Math.floor((i - 4) / 3) * (-this.mHeight / 2 + 42);\r\n            var text = this.scene.make.text({\r\n                x: locX[x],\r\n                y: tmpY + y,\r\n                text: t ? t.text : "123",\r\n                style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_14_BOLD }\r\n            }, false);\r\n            if (x === 0) {\r\n                // todo center\r\n            }\r\n            text.setData("node", t.node);\r\n            text.setStroke("#000000", 2);\r\n            this.mContentContainer.add(text);\r\n            this.mTexts.push(text);\r\n        }\r\n    };\r\n    BasicRankPanel.prototype.tweenView = function (show) {\r\n    };\r\n    BasicRankPanel.prototype.update = function (param) {\r\n        this.addItem(param);\r\n    };\r\n    BasicRankPanel.prototype.destroy = function () {\r\n        if (this.mBackground)\r\n            this.mBackground.destroy();\r\n        var len = this.mTexts.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var text = this.mTexts[i];\r\n            if (!text)\r\n                continue;\r\n            text.destroy(true);\r\n            text = null;\r\n        }\r\n        if (this.mTitleLabel)\r\n            this.mTitleLabel.destroy(true);\r\n        if (this.mContentContainer)\r\n            this.mContentContainer.destroy(true);\r\n        this.mContentContainer = null;\r\n        this.mTexts = [];\r\n        this.mData = null;\r\n        this.mBackground = null;\r\n        this.mTitleLabel = null;\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BasicRankPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.atlas("rank_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/rank/rank_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/rank/rank_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BasicRankPanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        this.mWidth = 328;\r\n        this.mHeight = 361;\r\n        this.setSize(this.mWidth, this.mHeight);\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 328, 361, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.add(this.mBackground);\r\n        this.mContentContainer = this.scene.make.container({}, false);\r\n        this.add(this.mContentContainer);\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 315, 318, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mContentContainer.add(border);\r\n        var titleIcon = this.scene.make.image({\r\n            x: -this.mWidth / 2 + 20,\r\n            y: -this.mHeight / 2 - 12,\r\n            key: "rank_atlas",\r\n            frame: "icon.png",\r\n        }, false).setOrigin(0, 0);\r\n        this.add(titleIcon);\r\n        this.mTitleLabel = this.scene.make.text({\r\n            x: -this.mWidth / 2 + 54,\r\n            y: -this.mHeight / 2 - 10,\r\n            text: "排行榜",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_20_BOLD }\r\n        })\r\n            .setOrigin(0, 0)\r\n            .setStroke("#000000", 2);\r\n        this.add(this.mTitleLabel);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BasicRankPanel.prototype.clearText = function () {\r\n        for (var _i = 0, _a = this.mTexts; _i < _a.length; _i++) {\r\n            var text = _a[_i];\r\n            text.destroy();\r\n        }\r\n        this.mTexts.length = 0;\r\n    };\r\n    return BasicRankPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/BasicRankPanel.ts?')},"./src/ui/Rank/RankMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RankMediator", function() { return RankMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _RankPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RankPanel */ "./src/ui/Rank/RankPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar RankMediator = /** @class */ (function (_super) {\r\n    __extends(RankMediator, _super);\r\n    function RankMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mlayerManager = layerManager;\r\n        _this.mUIType = _this.world.game.device.os.desktop ? 1 /* BaseUIType */ : 2 /* NormalUIType */;\r\n        return _this;\r\n    }\r\n    RankMediator.prototype.tweenView = function (show) {\r\n        if (!this.mView || !this.world.game.device.os.desktop)\r\n            return;\r\n        this.mView.tweenView(show);\r\n    };\r\n    RankMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    RankMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    RankMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n            if (!this.world.game.device.os.desktop) {\r\n                this.world.uiManager.checkUIState(RankMediator.NAME, true);\r\n            }\r\n        }\r\n    };\r\n    RankMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    RankMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    RankMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    RankMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _RankPanel__WEBPACK_IMPORTED_MODULE_1__["RankPanel"](this.mScene, this.world);\r\n        this.mlayerManager.addToUILayer(this.mView);\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n        this.mView.show();\r\n        if (!this.world.game.device.os.desktop) {\r\n            this.world.uiManager.checkUIState(RankMediator.NAME, false);\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RankMediator.prototype.update = function (param) {\r\n        if (!this.mView)\r\n            return;\r\n        if (param && param.length > 0) {\r\n            this.mView.update(param[0]);\r\n        }\r\n    };\r\n    RankMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            if (this.mView.parentContainer) {\r\n                this.mView.parentContainer.remove(this.mView);\r\n            }\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    RankMediator.NAME = "RankMediator";\r\n    return RankMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/RankMediator.ts?')},"./src/ui/Rank/RankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RankPanel", function() { return RankPanel; });\n/* harmony import */ var _BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BasicRankPanel */ "./src/ui/Rank/BasicRankPanel.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _RankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar RankPanel = /** @class */ (function (_super) {\r\n    __extends(RankPanel, _super);\r\n    function RankPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mCurrentIndex = 0;\r\n        return _this;\r\n    }\r\n    RankPanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        if (!this.mWorld) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width - this.mWidth / 2;\r\n            this.y = this.mHeight / 2 + 10;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n        }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    RankPanel.prototype.tweenView = function (show) {\r\n        if (!this.mScene)\r\n            return;\r\n        var baseY = this.mHeight / 2 + 10;\r\n        var toY = show === true ? baseY : baseY - 300;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    RankPanel.prototype.destroy = function () {\r\n        if (this.mZoonInBtn)\r\n            this.mZoonInBtn.destroy(true);\r\n        this.mZoonInBtn = null;\r\n        this.mCurrentIndex = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RankPanel.prototype.init = function () {\r\n        _super.prototype.init.call(this);\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_1__["IconBtn"](this.mScene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n                iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n            });\r\n            this.mClsBtn.x = this.mWidth / 2 - 35;\r\n            this.mClsBtn.y = -this.mHeight / 2;\r\n            this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n            this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n            this.add(this.mClsBtn);\r\n        }\r\n        else {\r\n            this.mZoonInBtn = this.scene.make.image({\r\n                x: 0,\r\n                y: this.mHeight / 2 - 10,\r\n                key: "rank_atlas",\r\n                frame: "arrow.png"\r\n            }, false);\r\n            this.add(this.mZoonInBtn);\r\n            this.mZoonInBtn.setInteractive();\r\n            this.mZoonInBtn.on("pointerup", this.onZoomHandler, this);\r\n        }\r\n        this.resize();\r\n    };\r\n    RankPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show) {\r\n            var items = this.getData("data");\r\n            if (items)\r\n                this.addItem(items);\r\n        }\r\n    };\r\n    RankPanel.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_RankMediator__WEBPACK_IMPORTED_MODULE_2__["RankMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    RankPanel.prototype.onZoomHandler = function () {\r\n        this.currentSizeIndex = this.mCurrentIndex === 0 ? 1 : 0;\r\n    };\r\n    Object.defineProperty(RankPanel.prototype, "currentSizeIndex", {\r\n        set: function (value) {\r\n            if (this.mCurrentIndex === value) {\r\n                return;\r\n            }\r\n            this.mCurrentIndex = value;\r\n            var h = this.mCurrentIndex === 1 ? 30 : this.mHeight;\r\n            var zoonBtnY = this.mCurrentIndex === 1 ? -this.mHeight / 2 + 20 : this.mHeight / 2 - 10;\r\n            var bgY = this.mCurrentIndex === 1 ? -this.mHeight / 2 + 15 : 0;\r\n            this.mBackground.resize(328, h);\r\n            this.mZoonInBtn.angle = this.mCurrentIndex === 1 ? 180 : 0;\r\n            if (h > 300) {\r\n                this.add(this.mContentContainer);\r\n            }\r\n            else {\r\n                this.remove(this.mContentContainer);\r\n            }\r\n            // this.mBackground.x = this.mBackground.width >> 1;\r\n            // this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBackground.y = bgY;\r\n            this.mZoonInBtn.y = zoonBtnY;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return RankPanel;\r\n}(_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__["BasicRankPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/RankPanel.ts?')},"./src/ui/Shop/ShopMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopMediator", function() { return ShopMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _ShopPanel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ShopPanel */ "./src/ui/Shop/ShopPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar ShopMediator = /** @class */ (function (_super) {\r\n    __extends(ShopMediator, _super);\r\n    function ShopMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this._perPage = 50;\r\n        _this.isEnd = false;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mUIType = 2 /* NormalUIType */;\r\n        return _this;\r\n    }\r\n    ShopMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ShopMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    ShopMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    ShopMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.isShowing) {\r\n            return;\r\n        }\r\n        this.mView = new _ShopPanel__WEBPACK_IMPORTED_MODULE_4__["ShopPanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.requestVirtualWorldQueryPackage(param[0].id, 1, _ShopPanel__WEBPACK_IMPORTED_MODULE_4__["ShopPanel"].ShopSlotCount);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.uiManager.checkUIState(ShopMediator.NAME, false);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ShopMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    ShopMediator.prototype.hide = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.isShowing = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        this.world.uiManager.checkUIState(ShopMediator.NAME, true);\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ShopMediator.prototype.destroy = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.world = null;\r\n        this.mScene = null;\r\n        this._curPage = 0;\r\n        this.fetching = false;\r\n        this.isEnd = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    ShopMediator.prototype.requestVirtualWorldQueryPackage = function (bagId, page, perPage) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = bagId;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ShopMediator.prototype.queryShopProps = function (page, perPage) {\r\n        if (page === void 0) { page = 1; }\r\n        if (perPage === void 0) { perPage = 50; }\r\n        if (!!this.mParam === false)\r\n            return;\r\n        this.fetching = true;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = this.mParam[0].id;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ShopMediator.prototype.queryPackageHandler = function (data) {\r\n        if (data.items.length > 0 && data.id === this.mParam[0].id) {\r\n            this.mView.setDataList(data);\r\n            //  this.mView.addItems(data.items);\r\n        }\r\n        else {\r\n            this.isEnd = true;\r\n        }\r\n        this.fetching = false;\r\n    };\r\n    ShopMediator.prototype.onShowItemHandler = function (item) {\r\n        var prices = item.price;\r\n        for (var _i = 0, prices_1 = prices; _i < prices_1.length; _i++) {\r\n            var price = prices_1[_i];\r\n            if (price.coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].CoinType.TU_DING_COIN) {\r\n                // if (price.price > this.mView.price) {\r\n                // todo alert\r\n                // Globals.PromptManager.showAlert("图钉不足，是否前往充值？", this.onPayTuDingHandler, this, AlertmView.OK | AlertmView.CANCEL);\r\n                // return;\r\n                // }\r\n            }\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = this.mParam[0].id;\r\n        content.componentId = item.id;\r\n        this.world.connection.send(pkt);\r\n        // Globals.SocketManager.send(pkt);\r\n    };\r\n    ShopMediator.prototype.syncUserBalance = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_USER_BALANCE);\r\n        this.world.connection.send(pkt);\r\n        // Globals.SocketManager.send(pkt);\r\n    };\r\n    ShopMediator.prototype.onChangeIndex = function (rate) {\r\n        if (rate >= 0.9 && this.fetching === false && this.isEnd === false) {\r\n            this._curPage++;\r\n            this.queryShopProps(this._curPage);\r\n        }\r\n    };\r\n    ShopMediator.prototype.onSyncUserBalanceHandler = function (balance) {\r\n        if (!!this.mView === false) {\r\n            return;\r\n        }\r\n        // this.mView.setUserBalance(balance);\r\n    };\r\n    ShopMediator.prototype.onPayTuDingHandler = function () {\r\n        // shell.openExternal("https://www.tooqing.com/recharge");\r\n    };\r\n    ShopMediator.NAME = "ShopMediator";\r\n    return ShopMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/ShopMediator.ts?')},"./src/ui/Shop/ShopPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopPanel", function() { return ShopPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _shop_itemSlot__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shop.itemSlot */ "./src/ui/Shop/shop.itemSlot.ts");\n/* harmony import */ var _ShopMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ShopMediator */ "./src/ui/Shop/ShopMediator.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ShopPanel = /** @class */ (function (_super) {\r\n    __extends(ShopPanel, _super);\r\n    function ShopPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    ShopPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width + wid >> 1;\r\n            this.y = size.height + hei >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n        }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    ShopPanel.prototype.setDataList = function (value) {\r\n        this.mShopData = value;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.refreshDataList();\r\n    };\r\n    ShopPanel.prototype.destroy = function () {\r\n        if (this.mShopItemSlotList) {\r\n            this.mShopItemSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.mShopItemSlotList.length = 0;\r\n            this.mShopItemSlotList = null;\r\n        }\r\n        this.mShopData = null;\r\n        this.mInitialized = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopPanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.mScene.load.atlas("itemChose", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/itemChose.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/itemChose.json"));\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.mScene.load.atlas("shopView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/shop/shopView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/shop/shopView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ShopPanel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        var selectFramesObj = this.mScene.textures.get("itemChose").frames;\r\n        var tmpSelectFrames = [];\r\n        for (var key in selectFramesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = selectFramesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpSelectFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.mScene.anims.create({\r\n            key: "itemSelectFrame",\r\n            frames: this.mScene.anims.generateFrameNumbers("itemChose", { start: 0, end: 8, frames: tmpSelectFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        _super.prototype.loadComplete.call(this, loader, totalComplete, totalFailed);\r\n    };\r\n    ShopPanel.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.mBg.x = 0;\r\n        this.mBg.y = 0;\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.addAt(this.mBg, 0);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height - 300;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n        }\r\n        var titleCon = this.mScene.make.sprite(undefined, false);\r\n        titleCon.setTexture("shopView", "shopView_titleIcon");\r\n        titleCon.x = (-this.mBg.width >> 1) + 35;\r\n        titleCon.y = -this.mBg.height >> 1;\r\n        this.add(titleCon);\r\n        var titleTF = this.mScene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("内购商城");\r\n        titleTF.x = titleCon.x + titleCon.width - 10;\r\n        titleTF.y = titleCon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        this.mShopItemSlotList = [];\r\n        var itemSlot;\r\n        var tmpX;\r\n        var tmpY;\r\n        for (var i = 0; i < 20; i++) {\r\n            tmpX = (i % 5) * 88 - this.mBg.width / 2 + 75;\r\n            tmpY = Math.floor(i / 5) * 82 - this.mBg.height / 2 + 72;\r\n            itemSlot = new _shop_itemSlot__WEBPACK_IMPORTED_MODULE_2__["ShopItemSlot"](this.mScene, this.mWorld, this, tmpX, tmpY, "shopView", "ui/shop/shopView.png", "ui/shop/shopView.json", "shopView_bagSlot", "itemSelectFrame");\r\n            itemSlot.createUI();\r\n            this.mShopItemSlotList.push(itemSlot);\r\n        }\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/shop/shopView.png", jsonUrl: "ui/shop/shopView.json"\r\n        });\r\n        this.mClsBtn.x = (this.width >> 1) - 65;\r\n        this.mClsBtn.y = -this.height >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.mClsBtn.on("pointerup", this.shopMedClose, this);\r\n        this.add(this.mClsBtn);\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        // 异步加载过程中会导致数据过来，面板仍然没有加载完毕，所以缓存数据等ui加载完毕再做显示\r\n        if (this.mShopData) {\r\n            this.refreshDataList();\r\n        }\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ShopPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_ShopMediator__WEBPACK_IMPORTED_MODULE_3__["ShopMediator"].NAME).resize();\r\n    };\r\n    ShopPanel.prototype.refreshDataList = function () {\r\n        if (!this.mShopData) {\r\n            // Logger.getInstance().error("this.mDataList is undefiend");\r\n            return;\r\n        }\r\n        var len = ShopPanel.ShopSlotCount;\r\n        var item;\r\n        for (var i = 0; i < len; i++) {\r\n            item = this.mShopItemSlotList[i];\r\n            if (!item)\r\n                continue;\r\n            item.shopDataChange(this.mShopData.items[i], this.mShopData.id);\r\n        }\r\n    };\r\n    ShopPanel.prototype.shopMedClose = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_ShopMediator__WEBPACK_IMPORTED_MODULE_3__["ShopMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    ShopPanel.ShopSlotCount = 20;\r\n    return ShopPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/ShopPanel.ts?')},"./src/ui/Shop/shop.itemSlot.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopItemSlot", function() { return ShopItemSlot; });\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../bag/dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _const_res_const__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/res.const */ "./src/const/res.const.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _tips_toolTip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tips/toolTip */ "./src/ui/tips/toolTip.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ShopItemSlot = /** @class */ (function (_super) {\r\n    __extends(ShopItemSlot, _super);\r\n    function ShopItemSlot(scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes, subscriptRes) {\r\n        return _super.call(this, scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes) || this;\r\n    }\r\n    ShopItemSlot.prototype.shopDataChange = function (val, packID) {\r\n        if (!val)\r\n            return;\r\n        this.mPackageID = packID;\r\n        _super.prototype.dataChange.call(this, val);\r\n        var prices = val.price;\r\n        var priceLen = prices.length;\r\n        for (var i = 0; i < priceLen; i++) {\r\n            var png = void 0;\r\n            var key = void 0;\r\n            if (prices[i].coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].CoinType.TU_DING_COIN) {\r\n                key = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getName();\r\n                png = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getPNG();\r\n            }\r\n            this.makeCoin(prices[i], i * 20 + 30);\r\n        }\r\n    };\r\n    ShopItemSlot.prototype.destroy = function () {\r\n        if (this.moneyIcon) {\r\n            this.moneyIcon.destroy(true);\r\n            this.moneyIcon = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopItemSlot.prototype.makeCoin = function (price, y) {\r\n        var png;\r\n        var key;\r\n        if (price.coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].CoinType.TU_DING_COIN) {\r\n            key = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getName();\r\n            png = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getPNG();\r\n        }\r\n        // const moneyIcon = this.mScene.make.image(undefined, false);\r\n        this.moneyIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](this.mScene, 0, 0);\r\n        this.moneyIcon.x = (-this.mWid >> 1) + 15;\r\n        this.moneyIcon.y = y;\r\n        this.toolTipCon.add(this.moneyIcon);\r\n        this.moneyIcon.load(png);\r\n        var priceText = this.mScene.make.text(undefined, false);\r\n        priceText.setFontFamily("Tahoma");\r\n        // priceText.setFontStyle("bold");\r\n        priceText.setFontSize(15);\r\n        priceText.x = -this.mWid / 2 + this.moneyIcon.width + 20;\r\n        priceText.y = y - 9;\r\n        this.toolTipCon.add(priceText);\r\n        priceText.setText(price.price.toString());\r\n    };\r\n    ShopItemSlot.prototype.onLoadCompleteHandler = function () {\r\n        this.mWid = 80;\r\n        this.mHei = 88;\r\n        this.itemBG = this.mScene.make.sprite(undefined, false);\r\n        this.itemBG.setTexture(this.mResStr, this.mResSlot);\r\n        this.itemBG.y = -10;\r\n        this.toolTipCon.setSize(this.mWid, this.mHei);\r\n        this.toolTipCon.addAt(this.itemBG, 0);\r\n        this.mIcon = new _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_1__["DragDropIcon"](this.mScene, 0, -10);\r\n        this.toolTipCon.addAt(this.mIcon, 1);\r\n        if (this.mSubScriptRes) {\r\n            this.mSubScriptSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSubScriptSprite.setTexture(this.mResStr, this.mSubScriptRes);\r\n            this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.itemBG.width >> 1;\r\n            this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.itemBG.height >> 1;\r\n            // this.con.addAt(this.mSubScriptSprite, 2);\r\n        }\r\n        if (this.isTipBoo) {\r\n            this.toolTip = new _tips_toolTip__WEBPACK_IMPORTED_MODULE_6__["ToolTip"](this.mScene, "itemSlotTip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/toolTip/toolTip.json"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/toolTip/toolTip.png"), this.mWorld.uiScale);\r\n        }\r\n        this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.itemBG.width, 56), Phaser.Geom.Rectangle.Contains);\r\n        this.toolTipCon.on("pointerover", this.overHandler, this);\r\n        this.toolTipCon.on("pointerout", this.outHandler, this);\r\n        this.toolTipCon.on("pointerdown", this.downHandler, this);\r\n        this.toolTipCon.on("pointerup", this.outHandler, this);\r\n        this.minitialize = true;\r\n        if (this.mData) {\r\n            this.dataChange(this.mData);\r\n        }\r\n        this.mSelectSprite = this.mScene.make.sprite(undefined, false);\r\n        this.createTexture(this.mWid, this.mHei);\r\n    };\r\n    ShopItemSlot.prototype.overHandler = function (pointer) {\r\n        _super.prototype.overHandler.call(this, pointer);\r\n        this.mSelectSprite.y -= 10;\r\n    };\r\n    ShopItemSlot.prototype.downHandler = function (pointer) {\r\n        if (!this.mData)\r\n            return;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = this.mPackageID;\r\n        content.componentId = this.mData.id;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    ShopItemSlot.prototype.outHandler = function (pointer) {\r\n        _super.prototype.outHandler.call(this, pointer);\r\n    };\r\n    ShopItemSlot.prototype.createTexture = function (wid, hei) {\r\n        var COLOR_BG = 0xAAA9A9;\r\n        var COLOR_LINE = 0xAAA9A9;\r\n        var bgGraphics = this.mScene.add.graphics();\r\n        bgGraphics.fillStyle(COLOR_BG, .3);\r\n        bgGraphics.fillRoundedRect(0, 0, wid, hei, 5);\r\n        bgGraphics.generateTexture("selectBg", wid, hei);\r\n        bgGraphics.clear();\r\n    };\r\n    return ShopItemSlot;\r\n}(_bag_item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/shop.itemSlot.ts?')},"./src/ui/UserInfo/UserInfoMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserInfoMediator", function() { return UserInfoMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _UserInfoPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UserInfoPanel */ "./src/ui/UserInfo/UserInfoPanel.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar UserInfoMediator = /** @class */ (function (_super) {\r\n    __extends(UserInfoMediator, _super);\r\n    function UserInfoMediator(mLayerManager, mScene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mLayerManager = mLayerManager;\r\n        _this.mScene = mScene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    UserInfoMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    UserInfoMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    UserInfoMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    UserInfoMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    UserInfoMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    UserInfoMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!param || param.length === 0) {\r\n            return;\r\n        }\r\n        this.mView = new _UserInfoPanel__WEBPACK_IMPORTED_MODULE_1__["UserInfoPanel"](this.mScene, this.world);\r\n        this.mView.show(param[0]);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    UserInfoMediator.prototype.destroy = function () {\r\n        if (this.mView)\r\n            this.mView.destroy();\r\n    };\r\n    UserInfoMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    UserInfoMediator.prototype.onClosePanel = function () {\r\n        this.hide();\r\n    };\r\n    UserInfoMediator.NAME = "UserInfoMediator";\r\n    return UserInfoMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserInfo/UserInfoMediator.ts?')},"./src/ui/UserInfo/UserInfoPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserInfoPanel", function() { return UserInfoPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/ninepatch/NinePatch */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _UserInfoMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./UserInfoMediator */ "./src/ui/UserInfo/UserInfoMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar UserInfoPanel = /** @class */ (function (_super) {\r\n    __extends(UserInfoPanel, _super);\r\n    function UserInfoPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.mBadgeImages = [];\r\n        _this.mWorld = worldService;\r\n        return _this;\r\n    }\r\n    UserInfoPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.setData("data", param);\r\n        this.setInfo(param);\r\n    };\r\n    UserInfoPanel.prototype.hide = function () {\r\n        this.clearBadge();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    UserInfoPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - this.width - 8;\r\n        this.y = size.height - 100 - (this.height);\r\n    };\r\n    UserInfoPanel.prototype.setInfo = function (data) {\r\n        var _this = this;\r\n        if (!this.mInitialized || !data)\r\n            return;\r\n        if (data.actors.length === 0) {\r\n            return;\r\n        }\r\n        var actor = data.actors[0];\r\n        this.mWorld.httpService.userDetail(actor.platformId).then(function (response) {\r\n            if (response.code === 200) {\r\n                var resData = response.data;\r\n                if (resData) {\r\n                    _this.mActor.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes("show/" + resData.username + ".png"), _this, undefined, _this.loadDefaultAvatar);\r\n                    _this.mNickName.setText(resData.nickname);\r\n                    _this.mLv.setText(resData.level);\r\n                }\r\n            }\r\n        });\r\n        this.mWorld.httpService.badgecards(actor.platformId).then(function (response) {\r\n            if (response.code === 200) {\r\n                _this.createBadge(response.data);\r\n            }\r\n        });\r\n        this.updateFollwer(actor.platformId);\r\n    };\r\n    UserInfoPanel.prototype.destroy = function () {\r\n        if (this.mActor) {\r\n            this.mActor.destroy(true);\r\n            this.mActor = null;\r\n        }\r\n        if (this.mBadgeImages) {\r\n            this.mBadgeImages.forEach(function (image) {\r\n                image.destroy(true);\r\n                image = null;\r\n            });\r\n            this.mBadgeImages = [];\r\n        }\r\n        if (this.mNickName) {\r\n            this.mNickName.destroy(true);\r\n            this.mNickName = null;\r\n        }\r\n        if (this.mLv) {\r\n            this.mLv.destroy(true);\r\n            this.mLv = null;\r\n        }\r\n        if (this.mFollwerBtn) {\r\n            this.mFollwerBtn.destroy(true);\r\n            this.mFollwerBtn = null;\r\n        }\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    UserInfoPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getJSON());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    UserInfoPanel.prototype.init = function () {\r\n        this.setSize(359, 199);\r\n        var background = new _lib_rexui_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, {\r\n            width: 359,\r\n            height: 199,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getRows()\r\n        }).setOrigin(0, 0);\r\n        this.add(background);\r\n        var border = new _lib_rexui_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, {\r\n            x: 7,\r\n            y: 19,\r\n            width: 345,\r\n            height: 173,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getRows()\r\n        }).setOrigin(0, 0);\r\n        this.add(border);\r\n        var nickNameLabel = this.scene.make.text({\r\n            x: 20,\r\n            y: -5,\r\n            text: "昵称：",\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            style: { color: "#b4b4b4", font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(nickNameLabel);\r\n        var lvLabel = this.scene.make.text({\r\n            x: 20,\r\n            y: 30,\r\n            text: "等级：",\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#b4b4b4",\r\n            style: { color: "#b4b4b4", font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(lvLabel);\r\n        this.mNickName = this.scene.make.text({\r\n            x: nickNameLabel.x + 50,\r\n            y: nickNameLabel.y,\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#FFFFFF",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(this.mNickName);\r\n        this.mLv = this.scene.make.text({\r\n            x: lvLabel.x + 50,\r\n            y: lvLabel.y,\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#FFFFFF",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        });\r\n        this.add(this.mLv);\r\n        this.mFollwerBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_5__["NinePatchButton"](this.scene, 258, 145, 80, 34, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), "", "关注", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getConfig());\r\n        this.mFollwerBtn.x = 258 + (this.mFollwerBtn.width >> 1);\r\n        this.mFollwerBtn.y = 145 + (this.mFollwerBtn.height >> 1);\r\n        this.mFollwerBtn.setTextStyle({ font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_16_BOLD });\r\n        this.add(this.mFollwerBtn);\r\n        this.mActor = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, 300, 125).setOrigin(0.5, 1);\r\n        this.mActor.scale = 2;\r\n        this.add(this.mActor);\r\n        this.mWorld.uiManager.getMediator(_UserInfoMediator__WEBPACK_IMPORTED_MODULE_6__["UserInfoMediator"].NAME).resize();\r\n        _super.prototype.init.call(this);\r\n        this.setInfo(this.getData("data"));\r\n    };\r\n    UserInfoPanel.prototype.updateFollwer = function (platformId) {\r\n        var _this = this;\r\n        var mainPlayer = this.mWorld.roomManager.currentRoom.playerManager.actor.model;\r\n        if (!mainPlayer)\r\n            return;\r\n        if (platformId === mainPlayer.platformId) {\r\n            // this.mFollwerBtn.visible = false;\r\n            return;\r\n        }\r\n        // this.mFollwerBtn.visible = true;\r\n        this.mWorld.httpService.checkFollowed([platformId])\r\n            .then(function (response) {\r\n            if (response.code === 200) {\r\n                var resData = response.data;\r\n                if (resData.length > 0) {\r\n                    _this.mFollwerBtn.setText("取消关注");\r\n                }\r\n                else {\r\n                    _this.mFollwerBtn.setText("关注");\r\n                }\r\n                _this.mFollwerBtn.setData("node", { text: _this.mFollwerBtn.getText(), platformId: platformId });\r\n            }\r\n        });\r\n    };\r\n    UserInfoPanel.prototype.createBadge = function (badges) {\r\n        if (!badges)\r\n            return;\r\n        for (var i = 0; i < badges.length; i++) {\r\n            var badge = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, i * 70 + 60, 100);\r\n            badge.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes(badges[i].target_entity.thumbnail));\r\n            this.add(badge);\r\n            this.mBadgeImages.push(badge);\r\n        }\r\n    };\r\n    UserInfoPanel.prototype.loadDefaultAvatar = function () {\r\n        this.mActor.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes("show/avatar_default.png"));\r\n    };\r\n    UserInfoPanel.prototype.clearBadge = function () {\r\n        for (var _i = 0, _a = this.mBadgeImages; _i < _a.length; _i++) {\r\n            var badge = _a[_i];\r\n            badge.destroy();\r\n            this.remove(badge);\r\n        }\r\n        this.mBadgeImages.length = 0;\r\n    };\r\n    return UserInfoPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserInfo/UserInfoPanel.ts?')},"./src/ui/UserMenu/MenuItem.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MenuItem", function() { return MenuItem; });\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar MenuItem = /** @class */ (function (_super) {\r\n    __extends(MenuItem, _super);\r\n    function MenuItem(scene, x, y, width, height, key, text, config) {\r\n        return _super.call(this, scene, x, y, width, height, key, "", text, config) || this;\r\n    }\r\n    MenuItem.prototype.appendItem = function (menu) {\r\n        if (!this.mChild) {\r\n            this.mMenus = [];\r\n            this.mChild = this.scene.make.container(undefined, false);\r\n            // this.mChild.x = 42;\r\n            this.mArrow = this.scene.make.image({\r\n                x: this.width * this.originX - 3,\r\n                key: "usermenu_arrow"\r\n            });\r\n            this.add(this.mArrow);\r\n            this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 0, 0, 0, 0, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n            this.mChild.add(this.mBackground);\r\n        }\r\n        this.mChild.add(menu);\r\n        this.mMenus.push(menu);\r\n        this.mBackground.resize(74, this.mMenus.length * 32);\r\n        this.mBackground.x = this.mBackground.width;\r\n        this.mBackground.y = this.mBackground.height / 2 - 32 / 2;\r\n    };\r\n    MenuItem.prototype.show = function () {\r\n        this.add(this.mChild);\r\n    };\r\n    MenuItem.prototype.destroy = function (fromScene) {\r\n        if (this.mMenus) {\r\n            var len = this.mMenus.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mMenus[i];\r\n                if (item)\r\n                    continue;\r\n                item.destroy(true);\r\n                item = null;\r\n            }\r\n            this.mMenus = [];\r\n        }\r\n        if (this.mBackground) {\r\n            this.mBackground.destroy();\r\n            this.mBackground = null;\r\n        }\r\n        if (this.mChild) {\r\n            this.mChild.destroy(true);\r\n            this.mChild = null;\r\n        }\r\n        if (this.mArrow) {\r\n            this.mArrow.destroy(true);\r\n            this.mArrow = null;\r\n        }\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    Object.defineProperty(MenuItem.prototype, "menus", {\r\n        get: function () {\r\n            return this.mMenus || [];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return MenuItem;\r\n}(_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_0__["NinePatchButton"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/MenuItem.ts?')},"./src/ui/UserMenu/UserMenuMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserMenuMediator", function() { return UserMenuMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _UserMenuPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UserMenuPanel */ "./src/ui/UserMenu/UserMenuPanel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar UserMenuMediator = /** @class */ (function (_super) {\r\n    __extends(UserMenuMediator, _super);\r\n    function UserMenuMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this, worldService) || this;\r\n        _this.world = worldService;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 3 /* TipsUIType */;\r\n        return _this;\r\n    }\r\n    UserMenuMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    UserMenuMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_4__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        if (this.mView) {\r\n            this.mView.off("menuClick", this.onClickMenuHandler, this);\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    UserMenuMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    UserMenuMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    UserMenuMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    UserMenuMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _UserMenuPanel__WEBPACK_IMPORTED_MODULE_1__["UserMenuPanel"](this.mScene, this.world);\r\n        this.mView.show(param[0]);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_4__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        this.mView.on("menuClick", this.onClickMenuHandler, this);\r\n        _super.prototype.show.call(this, param);\r\n        // this.mScene.input.on("pointerdown", this.onClosePanel, this);\r\n    };\r\n    UserMenuMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param[0]);\r\n    };\r\n    UserMenuMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    UserMenuMediator.prototype.onClickMenuHandler = function (targetNode) {\r\n        if (!this.mView)\r\n            return;\r\n        var uiNode = this.mView.getData("data");\r\n        if (!targetNode || !uiNode || !this.world || !this.world.connection)\r\n            return;\r\n        this.hide();\r\n        if (targetNode.platformid) {\r\n            if (targetNode.text === "关注") {\r\n                this.world.httpService.follow(targetNode.platformid);\r\n            }\r\n            else if (targetNode.text === "取消关注") {\r\n                this.world.httpService.unfollow(targetNode.platformid);\r\n            }\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = uiNode.id;\r\n        content.componentId = targetNode.id;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    UserMenuMediator.prototype.onClosePanel = function (pointer, gameObject) {\r\n        this.hide();\r\n    };\r\n    return UserMenuMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/UserMenuMediator.ts?')},"./src/ui/UserMenu/UserMenuPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserMenuPanel", function() { return UserMenuPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _MenuItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MenuItem */ "./src/ui/UserMenu/MenuItem.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar UserMenuPanel = /** @class */ (function (_super) {\r\n    __extends(UserMenuPanel, _super);\r\n    function UserMenuPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mMenus = [];\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    UserMenuPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.setData("data", param);\r\n        this.addItem(param);\r\n        this.x = this.scene.input.activePointer.x + 32;\r\n        this.y = this.scene.input.activePointer.y + 32;\r\n        this.scene.input.on("gameobjectdown", this.onClickMenu, this);\r\n    };\r\n    UserMenuPanel.prototype.hide = function () {\r\n        this.scene.input.off("gameobjectdown", this.onClickMenu, this);\r\n        this.removeInteractive();\r\n        this.clear();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    UserMenuPanel.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.setInteractive();\r\n        if (this.mBackground) {\r\n            this.mBackground.resize(width, height);\r\n            // this.mBackground.x = this.mBackground.width * this.originX;\r\n            // this.mBackground.y = this.mBackground.height * this.originY;\r\n        }\r\n        return this;\r\n    };\r\n    UserMenuPanel.prototype.destroy = function () {\r\n        if (this.mBackground) {\r\n            this.mBackground.destroy();\r\n        }\r\n        if (this.mMenus) {\r\n            var len = this.mMenus.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mMenus[i];\r\n                if (item)\r\n                    continue;\r\n                item.destroy(true);\r\n                item = null;\r\n            }\r\n            this.mMenus = [];\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    UserMenuPanel.prototype.addItem = function (params) {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.clear();\r\n        var menu = params.menuItem;\r\n        for (var i = 0; i < menu.length; i++) {\r\n            var btn = this.appendItem(menu[i], 0, i * 32);\r\n            this.add(btn);\r\n            this.mMenus.push(btn);\r\n        }\r\n        // this.resizeBackground(60, this.mMenus.length * 30);\r\n        // this.resizeBackground(60, this.mMenus.length * 32);\r\n        this.setSize(70, this.mMenus.length * 30);\r\n        var mainPlayer = this.mWorld.roomManager.currentRoom.playerManager.actor.model;\r\n        if (!mainPlayer)\r\n            return;\r\n        var actor = params.actors[0];\r\n        if (!actor)\r\n            return;\r\n        if (mainPlayer.platformId !== actor.platformId) {\r\n            var fn_1 = { text: "关注", platformid: actor.platformId };\r\n            var follow_1 = this.appendItem({ text: "关注", node: undefined }, 0, this.mMenus.length * 31);\r\n            follow_1.setData("node", fn_1);\r\n            this.add(follow_1);\r\n            this.mMenus.push(follow_1);\r\n            this.mWorld.httpService.checkFollowed([actor.platformId])\r\n                .then(function (response) {\r\n                if (response.code === 200) {\r\n                    var data = response.data;\r\n                    if (data.length > 0) {\r\n                        follow_1.setText("取消关注");\r\n                    }\r\n                    fn_1.text = follow_1.getText();\r\n                    follow_1.setData("node", fn_1);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlackButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlackButton"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.scene.load.image("usermenu_arrow", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/usermenu/arrow.png"));\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getJSON());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    UserMenuPanel.prototype.init = function () {\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 70, 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.add(this.mBackground);\r\n        // this.mBackground.x = this.mBackground.width * this.mBackground.originX;\r\n        // this.mBackground.y = this.mBackground.height * this.mBackground.originY;\r\n        _super.prototype.init.call(this);\r\n        this.addItem(this.getData("data"));\r\n    };\r\n    UserMenuPanel.prototype.appendItem = function (menu, x, y) {\r\n        var item = new _MenuItem__WEBPACK_IMPORTED_MODULE_2__["MenuItem"](this.scene, 0, 0, 59, 29, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getName(), menu.text, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getConfig());\r\n        item.x = x;\r\n        item.y = y - (item.height >> 1);\r\n        item.setData("node", menu.node);\r\n        if (menu.child && menu.child.length > 0) {\r\n            var menuChild = menu.child;\r\n            for (var i = 0, len = menuChild.length; i < len; i++) {\r\n                var child = menuChild[i];\r\n                // parent的宽，高需要加入\r\n                var btn = this.appendItem(child, 31 + 42, i * 31 - 31 / 2 + this.mMenus.length * 31);\r\n                item.appendItem(btn);\r\n            }\r\n        }\r\n        return item;\r\n    };\r\n    UserMenuPanel.prototype.onClickMenu = function (pointer, gameobject) {\r\n        if (gameobject instanceof _MenuItem__WEBPACK_IMPORTED_MODULE_2__["MenuItem"]) {\r\n            if (gameobject.menus.length > 0) {\r\n                gameobject.show();\r\n            }\r\n            else {\r\n                this.emit("menuClick", gameobject.getData("node"));\r\n            }\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.resizeBackground = function (width, height) {\r\n        if (this.mBackground) {\r\n            this.mBackground.resize(width, height);\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.mMenus; _i < _a.length; _i++) {\r\n            var menu = _a[_i];\r\n            this.remove(menu);\r\n            menu.off("pointerup", this.onClickMenu);\r\n            menu.destroy();\r\n        }\r\n        this.mMenus.length = 0;\r\n    };\r\n    return UserMenuPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/UserMenuPanel.ts?')},"./src/ui/abstractPanel.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/abstractPanel.ts?")},"./src/ui/alert/alert.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Alert", function() { return Alert; });\nvar Alert = /** @class */ (function () {\r\n    function Alert(world, scene) {\r\n        this.mWorld = world;\r\n        this.mScene = scene;\r\n    }\r\n    Alert.prototype.isShow = function () {\r\n        return this.mShowing;\r\n    };\r\n    Alert.prototype.show = function (param) {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        this.mParentCon = this.mScene.add.container(size.width >> 1, size.height >> 1);\r\n        var text = this.mScene.make.text({\r\n            x: 0,\r\n            y: 0,\r\n            text: param,\r\n            style: { fill: "#FF0000", fontSize: 20 }\r\n        });\r\n        this.mShowing = true;\r\n        this.mParentCon.add(text);\r\n        this.mParentCon.setSize(text.width, text.height);\r\n        this.mParentCon.x = size.width - this.mParentCon.width >> 1;\r\n        this.mScene.tweens.add({\r\n            targets: this.mParentCon,\r\n            duration: 1000,\r\n            ease: "Linear",\r\n            props: {\r\n                y: { value: (size.height >> 1) - 80 },\r\n                alhpa: { value: 0 },\r\n            },\r\n            onComplete: function (tween, targets, element) {\r\n                _this.destroy();\r\n            },\r\n            onCompleteParams: [this],\r\n        });\r\n    };\r\n    Alert.prototype.hide = function () {\r\n        this.mShowing = false;\r\n    };\r\n    Alert.prototype.resize = function () {\r\n        if (this.mParentCon) {\r\n            var size = this.mWorld.getSize();\r\n            this.mParentCon.x = size.width - this.mParentCon.width >> 1;\r\n        }\r\n    };\r\n    Alert.prototype.destroy = function () {\r\n        if (this.mParentCon) {\r\n            this.mParentCon.destroy(true);\r\n            this.mParentCon = null;\r\n        }\r\n        this.mShowing = false;\r\n        this.mScene = null;\r\n        this.mWorld = null;\r\n    };\r\n    Alert.prototype.update = function () {\r\n    };\r\n    Alert.prototype.tweenView = function (show) {\r\n    };\r\n    return Alert;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/alert/alert.ts?')},"./src/ui/bag/IListItemRender.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/IListItemRender.ts?")},"./src/ui/bag/bagView/bagMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragType", function() { return DragType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DropType", function() { return DropType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagMediator", function() { return BagMediator; });\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _bagPanel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bagPanel */ "./src/ui/bag/bagView/bagPanel.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar DragType;\r\n(function (DragType) {\r\n    DragType[DragType["DRAG_TYPE_SHORTCUT"] = 1] = "DRAG_TYPE_SHORTCUT";\r\n    DragType[DragType["DRAG_TYPE_BAG"] = 2] = "DRAG_TYPE_BAG";\r\n})(DragType || (DragType = {}));\r\nvar DropType;\r\n(function (DropType) {\r\n    DropType[DropType["DROP_TYPE_SHORTCUT"] = 1] = "DROP_TYPE_SHORTCUT";\r\n    DropType[DropType["DROP_TYPE_BAG"] = 2] = "DROP_TYPE_BAG";\r\n})(DropType || (DropType = {}));\r\nvar BagMediator = /** @class */ (function (_super) {\r\n    __extends(BagMediator, _super);\r\n    function BagMediator(layerManager, mworld, scene) {\r\n        var _this = _super.call(this, mworld) || this;\r\n        _this.mPageNum = 0;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = mworld;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 2 /* NormalUIType */;\r\n        return _this;\r\n    }\r\n    BagMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    BagMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    BagMediator.prototype.isShow = function () {\r\n        if (this.mView)\r\n            return this.mView.isShow();\r\n    };\r\n    BagMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    BagMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _bagPanel__WEBPACK_IMPORTED_MODULE_3__["BagPanel"](this.mScene, this.world);\r\n        }\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        if (param) {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(param[0].id, 1, _bagPanel__WEBPACK_IMPORTED_MODULE_3__["BagPanel"].PageMaxCount);\r\n        }\r\n        else {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(this.world.roomManager.currentRoom.playerManager.actor.package.id, 1, _bagPanel__WEBPACK_IMPORTED_MODULE_3__["BagPanel"].PageMaxCount);\r\n        }\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.uiManager.checkUIState(BagMediator.NAME, false);\r\n        this.refrehView();\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagMediator.prototype.update = function (param) {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.update(param);\r\n    };\r\n    BagMediator.prototype.hide = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].DRAG_TO_DROP, this.handleDrop, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        this.world.uiManager.checkUIState(BagMediator.NAME, true);\r\n    };\r\n    BagMediator.prototype.destroy = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].DRAG_TO_DROP, this.handleDrop, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mPageNum = 0;\r\n        this.mScene = null;\r\n        this.world = null;\r\n    };\r\n    BagMediator.prototype.handleDrop = function (value) {\r\n        var drag = value[0];\r\n        var drop = value[1];\r\n        if (drop.getDropType() === DropType.DROP_TYPE_BAG && drag.getDragType() === DragType.DRAG_TYPE_SHORTCUT) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().debug("背包拖到快捷栏了！！！");\r\n        }\r\n    };\r\n    BagMediator.prototype.refrehView = function (mItems) {\r\n        var items;\r\n        if (!mItems) {\r\n            var packs = this.world.roomManager.currentRoom.playerManager.actor.package;\r\n            if (packs == null) {\r\n                return;\r\n            }\r\n            items = packs.items;\r\n        }\r\n        else {\r\n            items = mItems;\r\n        }\r\n        this.setListData(items);\r\n    };\r\n    BagMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (gameobject instanceof _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_4__["default"])\r\n            return;\r\n        if (this.mView)\r\n            this.mView.setBlur();\r\n    };\r\n    BagMediator.prototype.setListData = function (value) {\r\n        this.mView.setDataList();\r\n    };\r\n    BagMediator.prototype.handleSynchroPackage = function () {\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.refrehView(itemList);\r\n    };\r\n    BagMediator.prototype.onUpdatePackageHandler = function () {\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.refrehView(itemList);\r\n    };\r\n    BagMediator.NAME = "BagMediator";\r\n    return BagMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/bagView/bagMediator.ts?')},"./src/ui/bag/bagView/bagPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagPanel", function() { return BagPanel; });\n/* harmony import */ var _item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _bagMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utils/tool */ "./src/utils/tool.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar BagPanel = /** @class */ (function (_super) {\r\n    __extends(BagPanel, _super);\r\n    // private mInitalize: boolean = false;\r\n    function BagPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mPageNum = 0;\r\n        _this.mPageIndex = 1;\r\n        _this.mBaseStr = "输入关键字进行搜索";\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.bagSlotList = [];\r\n        _this.mCheckList = [];\r\n        return _this;\r\n    }\r\n    BagPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width + wid >> 1;\r\n            this.y = size.height + hei >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei - (this.height / 2) * this.mWorld.uiScale >> 1;\r\n            }\r\n        }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    BagPanel.prototype.setDataList = function () {\r\n        var itemList = this.mWorld.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.mPageNum = Math.ceil(itemList.length / BagPanel.PageMaxCount);\r\n        this.mDataList = itemList;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.checkChinese();\r\n        // this.refreshDataList();\r\n    };\r\n    BagPanel.prototype.getPageNum = function () {\r\n        return this.mPageNum;\r\n    };\r\n    BagPanel.prototype.destroy = function () {\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.bagSlotList.length = 0;\r\n            this.bagSlotList = null;\r\n        }\r\n        if (this.mClsBtn) {\r\n            this.mClsBtn.destroy();\r\n            this.mClsBtn = null;\r\n        }\r\n        if (this.mPreBtn) {\r\n            this.mPreBtn.destroy(true);\r\n            this.mPreBtn = null;\r\n        }\r\n        if (this.mNextBtn) {\r\n            this.mNextBtn.destroy(true);\r\n            this.mNextBtn = null;\r\n        }\r\n        if (this.mBorder) {\r\n            this.mBorder.destroy(true);\r\n            this.mBorder = null;\r\n        }\r\n        if (this.mBg) {\r\n            this.mBg.destroy(true);\r\n            this.mBg = null;\r\n        }\r\n        // if (this.mCheckList) {\r\n        //     this.mCheckList.length = 0;\r\n        //     this.mCheckList = null;\r\n        // }\r\n        // if (this.mDataList) {\r\n        //     this.mDataList.length = 0;\r\n        //     this.mDataList = null;\r\n        // }\r\n        this.mWorld = null;\r\n        this.mPageNum = 0;\r\n        this.mPageIndex = 1;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BagPanel.prototype.getCurPageIndex = function () {\r\n        return this.mPageIndex;\r\n    };\r\n    BagPanel.prototype.show = function (param) {\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagPanel.prototype.setBlur = function () {\r\n        if (this.mInputText)\r\n            this.mInputText.setBlur();\r\n    };\r\n    BagPanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height - (this.height / 2) * this.mWorld.uiScale >> 1;\r\n            }\r\n        }\r\n        // ============背包格位\r\n        var itemSlot;\r\n        var tmpX = 0;\r\n        var tmpY = 0;\r\n        // ================背包界面背景底\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_5__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Background"].getConfig());\r\n        // this.mBg.x = size.width - this.width >> 1;\r\n        // this.mBg.y = size.height - this.mBg.height >> 1;\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_5__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        var txtBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_5__["NinePatch"](this.scene, this.mBorder.width / 4 + 5, -this.mBg.height / 2 + 65, this.mBorder.width / 2 - 40, 35, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.add(txtBg);\r\n        this.mInputText = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_6__["default"](this.mScene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080"\r\n        })\r\n            .resize(txtBg.width, txtBg.height)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 16px YaHei" })\r\n            .on("focus", this.onFocusHandler, this)\r\n            .on("blur", this.onBlurHandler, this);\r\n        this.mInputText.x = txtBg.x - txtBg.width / 2;\r\n        this.mInputText.y = txtBg.y - txtBg.height / 2;\r\n        this.mInputText.setText(this.mBaseStr);\r\n        this.add(this.mInputText);\r\n        // 多排背包格位\r\n        this.bagSlotList = [];\r\n        for (var i = 0; i < BagPanel.PageMaxCount; i++) {\r\n            tmpX = i % 8 * 60 - 210;\r\n            tmpY = Math.floor(i / 8) * 60 - this.mBorder.height / 2 + this.mBorder.y + this.mBorder.height / 2 - 55;\r\n            itemSlot = new _item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"](this.mScene, this.mWorld, this, tmpX, tmpY, this.mResStr, this.mResPng, this.mResJson, "bagView_slot.png", "itemSelectFrame");\r\n            itemSlot.createUI();\r\n            this.bagSlotList.push(itemSlot);\r\n        }\r\n        this.mPreBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mPreBtn.play("slipBtn");\r\n        this.mPreBtn.x = -this.mBg.width >> 1;\r\n        this.add(this.mPreBtn);\r\n        // // ===============背包界面右翻按钮\r\n        this.mNextBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mNextBtn.play("slipBtn");\r\n        this.mNextBtn.scaleX = -1;\r\n        this.mNextBtn.x = this.mBg.width >> 1;\r\n        var titleCon = this.mScene.make.sprite(undefined, false);\r\n        titleCon.setTexture(this.mResStr, "bagView_titleBtn.png");\r\n        titleCon.x = (-this.mBg.width >> 1) + 50;\r\n        titleCon.y = (-this.mBg.height >> 1);\r\n        this.add(titleCon);\r\n        var titleTF = this.mScene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("背包");\r\n        titleTF.x = titleCon.x + titleCon.width - 10;\r\n        titleTF.y = titleCon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        this.add(this.mNextBtn);\r\n        this.mNextBtn.setInteractive();\r\n        this.mPreBtn.setInteractive();\r\n        this.mNextBtn.on("pointerup", this.nextHandler, this);\r\n        this.mPreBtn.on("pointerup", this.preHandler, this);\r\n        this.mWidth = this.mBg.width;\r\n        this.mHeight = this.mBg.height;\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_8__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_9__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: this.mResPng, jsonUrl: this.mResJson\r\n        });\r\n        this.mClsBtn.x = (this.mWidth >> 1) - 65;\r\n        this.mClsBtn.y = -this.mHeight >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n        this.add(this.mClsBtn);\r\n        this.mInitialized = true;\r\n        if (this.mDataList) {\r\n            this.refreshDataList(this.mDataList);\r\n        }\r\n        this.setInteractive();\r\n        this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_4__["BagMediator"].NAME).resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BagPanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bagView";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        this.mScene.load.atlas("itemChose", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/bag/itemChose.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/bag/itemChose.json"));\r\n        this.mScene.load.atlas("slip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/bag/slip.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/bag/slip.json"));\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Background"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.mScene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BagPanel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        var selectFramesObj = this.mScene.textures.get("itemChose").frames;\r\n        var tmpSelectFrames = [];\r\n        for (var key in selectFramesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = selectFramesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpSelectFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.mScene.anims.create({\r\n            key: "itemSelectFrame",\r\n            frames: this.mScene.anims.generateFrameNumbers("itemChose", { start: 0, end: 8, frames: tmpSelectFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        var framesObj = this.mScene.textures.get("slip").frames;\r\n        var tmpFrames = [];\r\n        for (var key in framesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = framesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.mScene.anims.create({\r\n            key: "slipBtn",\r\n            frames: this.mScene.anims.generateFrameNumbers("slip", { start: 0, end: 14, frames: tmpFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        _super.prototype.loadComplete.call(this, loader, totalComplete, totalFailed);\r\n    };\r\n    BagPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_4__["BagMediator"].NAME).resize();\r\n    };\r\n    BagPanel.prototype.nextHandler = function (pointer, gameObject) {\r\n        this.preNextBtnScaleHandler(this.mNextBtn, -1);\r\n        if (this.mPageIndex >= this.mPageNum) {\r\n            return;\r\n        }\r\n        this.mPageIndex++;\r\n        var list = this.mCheckList.length > 0 ? this.mCheckList : this.mDataList;\r\n        this.refreshDataList(list);\r\n    };\r\n    BagPanel.prototype.preHandler = function (pointer, gameObject) {\r\n        this.preNextBtnScaleHandler(this.mPreBtn);\r\n        if (this.mPageIndex <= 1) {\r\n            return;\r\n        }\r\n        this.mPageIndex--;\r\n        var list = this.mCheckList.length > 0 ? this.mCheckList : this.mDataList;\r\n        this.refreshDataList(list);\r\n    };\r\n    BagPanel.prototype.preNextBtnScaleHandler = function (gameObject, scaleX) {\r\n        if (scaleX === void 0) { scaleX = 1; }\r\n        this.mScene.tweens.add({\r\n            targets: gameObject,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 * scaleX },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        gameObject.scaleX = scaleX;\r\n        gameObject.scaleY = 1;\r\n    };\r\n    BagPanel.prototype.refreshDataList = function (checkItemList) {\r\n        if (!checkItemList) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error("checkItemList is undefiend");\r\n            return;\r\n        }\r\n        var items = checkItemList.slice((this.mPageIndex - 1) * BagPanel.PageMaxCount, this.mPageIndex * BagPanel.PageMaxCount);\r\n        var len = BagPanel.PageMaxCount;\r\n        var item;\r\n        for (var i = 0; i < len; i++) {\r\n            item = this.bagSlotList[i];\r\n            if (!item)\r\n                continue;\r\n            item.dataChange(items[i]);\r\n        }\r\n    };\r\n    BagPanel.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_4__["BagMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    BagPanel.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n        if (!this.mInputText)\r\n            return;\r\n        this.mInputText.on("textchange", this.checkChinese, this);\r\n        this.mInputText.setText("");\r\n    };\r\n    BagPanel.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager || !this.mInputText) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n        this.mInputText.on("textchange", this.checkChinese, this);\r\n        this.mInputText.setText(this.mBaseStr);\r\n    };\r\n    BagPanel.prototype.checkChinese = function () {\r\n        var _this = this;\r\n        var str = this.mInputText.text;\r\n        if (str.length < 1 || !_utils_tool__WEBPACK_IMPORTED_MODULE_7__["Tool"].checkChinese(str) || str === this.mBaseStr) {\r\n            this.refreshDataList(this.mDataList);\r\n            return;\r\n        }\r\n        var itemList = this.mWorld.roomManager.currentRoom.playerManager.actor.package.items;\r\n        itemList.forEach(function (item) {\r\n            if (item) {\r\n                if (_utils_tool__WEBPACK_IMPORTED_MODULE_7__["Tool"].checkItemName(item.name, _this.mInputText.text)) {\r\n                    _this.mCheckList.push(item);\r\n                }\r\n            }\r\n        });\r\n        this.refreshDataList(this.mCheckList);\r\n    };\r\n    BagPanel.PageMaxCount = 32;\r\n    return BagPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_2__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/bagView/bagPanel.ts?')},"./src/ui/bag/basebag.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/basebag.ts?")},"./src/ui/bag/baseitem.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/baseitem.ts?")},"./src/ui/bag/dragDropIcon.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragDropIcon", function() { return DragDropIcon; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar DragDropIcon = /** @class */ (function (_super) {\r\n    __extends(DragDropIcon, _super);\r\n    function DragDropIcon(mScene, x, y, texture) {\r\n        var _this = _super.call(this, mScene, x, y) || this;\r\n        _this.mScene = mScene;\r\n        _this.mIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.mScene, 0, 0); // this.mScene.make.image(undefined, false);\r\n        _this.add(_this.mIcon);\r\n        return _this;\r\n    }\r\n    DragDropIcon.prototype.load = function (value, thisArg, onLoadComplete) {\r\n        var _this = this;\r\n        this.mUrl = value;\r\n        var key = this.resKey;\r\n        this.mIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(this.mUrl), function () {\r\n            if (_this.mCallBack)\r\n                _this.mCallBack();\r\n        });\r\n        // if (!this.mScene.cache.obj.has(key)) {\r\n        //     this.mScene.load.image(key, Url.getOsdRes(this.mUrl));\r\n        //     this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        //     this.mScene.load.start();\r\n        // } else {\r\n        //     this.onLoadCompleteHandler();\r\n        // }\r\n        this.mCallBack = onLoadComplete;\r\n    };\r\n    DragDropIcon.prototype.dragStart = function () {\r\n    };\r\n    DragDropIcon.prototype.dragStop = function (acceptDrag) {\r\n    };\r\n    DragDropIcon.prototype.dragDrop = function (dragable) {\r\n    };\r\n    DragDropIcon.prototype.dragOver = function (dragable) {\r\n    };\r\n    DragDropIcon.prototype.getDragData = function () {\r\n    };\r\n    DragDropIcon.prototype.getDropData = function () {\r\n    };\r\n    DragDropIcon.prototype.getDragImage = function () {\r\n        return this.mIcon;\r\n    };\r\n    DragDropIcon.prototype.getVisualDisplay = function () {\r\n        return undefined;\r\n    };\r\n    DragDropIcon.prototype.getBound = function () {\r\n        var bound = this.getBounds();\r\n        return new Phaser.Geom.Rectangle(bound.x, bound.y, bound.width, bound.height);\r\n    };\r\n    Object.defineProperty(DragDropIcon.prototype, "resKey", {\r\n        get: function () {\r\n            if (this.mUrl === undefined)\r\n                return "";\r\n            var key = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes((this.mUrl)); // Load.Image.getKey(this.mUrl);\r\n            return key;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DragDropIcon.prototype.destroy = function () {\r\n        this.mCallBack = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Object.defineProperty(DragDropIcon.prototype, "icon", {\r\n        get: function () {\r\n            return this.mIcon;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    DragDropIcon.prototype.setDragType = function (value) {\r\n        this.mDragType = value;\r\n    };\r\n    DragDropIcon.prototype.setDropType = function (value) {\r\n        this.mDropType = value;\r\n    };\r\n    DragDropIcon.prototype.getDropType = function () {\r\n        return this.mDropType;\r\n    };\r\n    DragDropIcon.prototype.getDragType = function () {\r\n        return this.mDragType;\r\n    };\r\n    return DragDropIcon;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/dragDropIcon.ts?')},"./src/ui/bag/idragable.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/idragable.ts?")},"./src/ui/bag/idropable.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/idropable.ts?")},"./src/ui/bag/item.slot.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemSlot", function() { return ItemSlot; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dragDropIcon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _tips_toolTip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tips/toolTip */ "./src/ui/tips/toolTip.ts");\n\r\n\r\n\r\n\r\n\r\nvar ItemSlot = /** @class */ (function () {\r\n    function ItemSlot(scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes, subscriptRes) {\r\n        this.minitialize = false;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        this.isTipBoo = true;\r\n        this.mScene = scene;\r\n        this.mWorld = world;\r\n        this.toolTipCon = scene.make.container(undefined, false); // new ToolTipContainer(this.mScene, world);\r\n        this.toolTipCon.x = x;\r\n        this.toolTipCon.y = y;\r\n        parentCon.add(this.toolTipCon);\r\n        this.mResStr = resStr;\r\n        this.mResPng = respng;\r\n        this.mResJson = resjson;\r\n        this.mResSlot = resSlot;\r\n        this.mSubScriptRes = subscriptRes;\r\n        this.mSelectRes = selectRes;\r\n    }\r\n    Object.defineProperty(ItemSlot.prototype, "hasTip", {\r\n        get: function () {\r\n            return this.isTipBoo;\r\n        },\r\n        set: function (value) {\r\n            this.isTipBoo = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ItemSlot.prototype.createUI = function () {\r\n        this.onLoadCompleteHandler();\r\n    };\r\n    ItemSlot.prototype.getView = function () {\r\n        return this.toolTipCon;\r\n    };\r\n    ItemSlot.prototype.getBg = function () {\r\n        return this.itemBG;\r\n    };\r\n    ItemSlot.prototype.getIcon = function () {\r\n        return this.mIcon;\r\n    };\r\n    ItemSlot.prototype.dataChange = function (val) {\r\n        var _this = this;\r\n        if (!this.minitialize)\r\n            return;\r\n        this.mData = val;\r\n        if (this.mIcon) {\r\n            var url = void 0;\r\n            if (this.mData && this.mData.display) {\r\n                url = this.mData.display.texturePath;\r\n                var des = this.mData.des ? "\\n" + this.mData.des : "";\r\n                this.setToolTipData(this.mData.name + this.mData.des);\r\n            }\r\n            else {\r\n                this.mIcon.icon.visible = false;\r\n            }\r\n            if (!url)\r\n                return;\r\n            if (this.mScene.textures.exists(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(url))) {\r\n                if (this.mData) {\r\n                    this.mIcon.icon.setTexture(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(url));\r\n                    this.mIcon.icon.visible = true;\r\n                }\r\n            }\r\n            else {\r\n                this.mIcon.load(url, this, function () {\r\n                    if (_this.mData) {\r\n                        _this.mIcon.icon.visible = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.mIcon.icon.visible = false;\r\n        }\r\n    };\r\n    ItemSlot.prototype.destroy = function () {\r\n        if (this.mSubScriptSprite) {\r\n            this.mSubScriptSprite.destroy(true);\r\n            this.mSubScriptSprite = null;\r\n        }\r\n        if (this.mSelectSprite) {\r\n            this.mSelectSprite.destroy(true);\r\n            this.mSelectSprite = null;\r\n        }\r\n        if (this.mIcon) {\r\n            this.mIcon.destroy();\r\n        }\r\n        if (this.toolTipCon) {\r\n            this.toolTipCon.destroy();\r\n            this.toolTipCon = null;\r\n        }\r\n        if (this.toolTip) {\r\n            this.toolTip.destroy();\r\n            this.toolTip = null;\r\n        }\r\n        if (this.mAnimationCon) {\r\n            this.mAnimationCon.destroy(true);\r\n            this.mAnimationCon = null;\r\n        }\r\n        if (this.itemBG) {\r\n            this.itemBG.destroy(true);\r\n            this.itemBG = null;\r\n        }\r\n        this.index = 0;\r\n        this.mData = null;\r\n        this.mScene = null;\r\n        this.mWorld = null;\r\n        this.mResStr = null;\r\n        this.mResPng = null;\r\n        this.mResSlot = null;\r\n        this.mResJson = null;\r\n        this.mSubScriptRes = null;\r\n        this.mSelectRes = null;\r\n        this.mWorld = null;\r\n        this.minitialize = false;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        this.mData = null;\r\n        this.isTipBoo = true;\r\n    };\r\n    ItemSlot.prototype.setToolTipData = function (text) {\r\n        if (this.toolTip) {\r\n            this.toolTip.setToolTipData(text);\r\n        }\r\n    };\r\n    ItemSlot.prototype.onLoadCompleteHandler = function () {\r\n        this.itemBG = this.mScene.make.sprite(undefined, false);\r\n        this.itemBG.setTexture(this.mResStr, this.mResSlot);\r\n        this.toolTipCon.addAt(this.itemBG, 0);\r\n        this.toolTipCon.setSize(this.itemBG.width, this.itemBG.height);\r\n        this.mIcon = new _dragDropIcon__WEBPACK_IMPORTED_MODULE_1__["DragDropIcon"](this.mScene, 0, 0);\r\n        this.toolTipCon.addAt(this.mIcon, 1);\r\n        if (this.mSubScriptRes) {\r\n            this.mSubScriptSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSubScriptSprite.setTexture(this.mResStr, this.mSubScriptRes);\r\n            this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.itemBG.width >> 1;\r\n            this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.itemBG.height >> 1;\r\n            // this.con.addAt(this.mSubScriptSprite, 2);\r\n        }\r\n        if (this.isTipBoo) {\r\n            this.toolTip = new _tips_toolTip__WEBPACK_IMPORTED_MODULE_4__["ToolTip"](this.mScene, "itemSlotTip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/toolTip/toolTip.json"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/toolTip/toolTip.png"), this.mWorld.uiScale);\r\n        }\r\n        this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.itemBG.width, 56), Phaser.Geom.Rectangle.Contains);\r\n        this.toolTipCon.on("pointerover", this.overHandler, this);\r\n        this.toolTipCon.on("pointerout", this.outHandler, this);\r\n        this.toolTipCon.on("pointerdown", this.downHandler, this);\r\n        this.toolTipCon.on("pointerup", this.outHandler, this);\r\n        this.minitialize = true;\r\n        if (this.mData) {\r\n            this.dataChange(this.mData);\r\n        }\r\n        this.mWid += this.itemBG.width;\r\n        this.mHei += this.itemBG.height;\r\n        // this.toolTipCon.setToolTip("itemSlotTip", Url.getRes("ui/toolTip/toolTip.json"), Url.getRes("ui/toolTip/toolTip.png"));\r\n    };\r\n    ItemSlot.prototype.downHandler = function (pointer) {\r\n        if (!this.mData || !this.mWorld.roomManager.currentRoom.playerManager.actor || !this.mWorld.roomManager.currentRoom || !this.mWorld.roomManager.currentRoom.playerManager)\r\n            return;\r\n        // if (this.mWorld.game.device.os.desktop) {\r\n        var pack = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = pack.id;\r\n        content.componentId = this.mData.id;\r\n        this.mWorld.connection.send(pkt);\r\n        // } else {\r\n        //     // this.overHandler(pointer);\r\n        // }\r\n    };\r\n    ItemSlot.prototype.overHandler = function (pointer) {\r\n        if (this.toolTip && this.mData) {\r\n            this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this.toolTip);\r\n            this.toolTip.setToolTipData(this.mData.name + this.mData.des);\r\n            this.toolTip.x = pointer.x;\r\n            this.toolTip.y = pointer.y;\r\n        }\r\n        if (this.mSelectRes && this.mSelectRes.length > 0) {\r\n            this.mSelectSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSelectSprite.play(this.mSelectRes);\r\n            this.toolTipCon.add(this.mSelectSprite);\r\n        }\r\n    };\r\n    ItemSlot.prototype.outHandler = function (pointer) {\r\n        if (this.toolTip) {\r\n            if (this.toolTip.parentContainer) {\r\n                this.toolTip.parentContainer.remove(this.toolTip);\r\n            }\r\n        }\r\n        if (this.mSelectSprite && this.mSelectSprite.parentContainer) {\r\n            this.mSelectSprite.parentContainer.remove(this.mSelectSprite);\r\n            this.mSelectSprite.destroy(true);\r\n            this.mSelectSprite = null;\r\n        }\r\n    };\r\n    return ItemSlot;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/item.slot.ts?')},"./src/ui/bag/storage/storageMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StorageMediator", function() { return StorageMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _storagePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./storagePanel */ "./src/ui/bag/storage/storagePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar StorageMediator = /** @class */ (function (_super) {\r\n    __extends(StorageMediator, _super);\r\n    function StorageMediator(layerManager, mworld, scene) {\r\n        var _this = _super.call(this, mworld) || this;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = mworld;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 2 /* NormalUIType */;\r\n        return _this;\r\n    }\r\n    StorageMediator.prototype.isShow = function () {\r\n        return this.mView.isShow();\r\n    };\r\n    StorageMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    StorageMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    StorageMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _storagePanel__WEBPACK_IMPORTED_MODULE_1__["StoragePanel"](this.mScene, this.world);\r\n        }\r\n        this.mView.show(param);\r\n        this.world.uiManager.checkUIState(StorageMediator.NAME, false);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    StorageMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    StorageMediator.prototype.hide = function () {\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.world.uiManager.checkUIState(StorageMediator.NAME, true);\r\n        }\r\n    };\r\n    StorageMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    StorageMediator.NAME = "StorageMediator";\r\n    return StorageMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/storage/storageMediator.ts?')},"./src/ui/bag/storage/storagePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StoragePanel", function() { return StoragePanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _item_slot__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _storageMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./storageMediator */ "./src/ui/bag/storage/storageMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar StoragePanel = /** @class */ (function (_super) {\r\n    __extends(StoragePanel, _super);\r\n    function StoragePanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    StoragePanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width + wid >> 1;\r\n        this.y = size.height + hei - 200;\r\n    };\r\n    StoragePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    StoragePanel.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    StoragePanel.prototype.destroy = function () {\r\n        if (this.mBg) {\r\n            this.mBg.destroy(true);\r\n            this.mBg = null;\r\n        }\r\n        if (this.mBorder) {\r\n            this.mBorder.destroy(true);\r\n            this.mBorder = null;\r\n        }\r\n        if (this.mClsBtn) {\r\n            this.mClsBtn.destroy();\r\n            this.mClsBtn = null;\r\n        }\r\n        if (this.mBagItemSlotList) {\r\n            var len = this.mBagItemSlotList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mBagItemSlotList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n                item = null;\r\n            }\r\n            this.mBagItemSlotList = null;\r\n        }\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    StoragePanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        _super.prototype.init.call(this);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getConfig());\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        this.mWidth = this.mBg.width;\r\n        this.mHeight = this.mBg.height;\r\n        var titleIcon = this.mScene.make.image(undefined, false);\r\n        titleIcon.setTexture(this.mResStr, "itemBagView_title.png");\r\n        titleIcon.x = (-this.mBg.width >> 1) + 80;\r\n        titleIcon.y = -this.mBg.height >> 1;\r\n        this.add(titleIcon);\r\n        var titleTF = this.mScene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("书柜");\r\n        titleTF.x = titleIcon.x + titleIcon.width - 10;\r\n        titleTF.y = titleIcon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        var itemSlot;\r\n        var tmpX = 0;\r\n        var tmpY = 0;\r\n        // 多排背包格位\r\n        this.mBagItemSlotList = [];\r\n        for (var i = 0; i < 9; i++) {\r\n            tmpX = i % 9 * 60 + 32 - 724 / 2;\r\n            tmpY = Math.floor(i / 9) * 60 - 55;\r\n            itemSlot = new _item_slot__WEBPACK_IMPORTED_MODULE_1__["ItemSlot"](this.mScene, this.mWorld, this, tmpX, tmpY, this.mResStr, this.mResPng, this.mResJson, "bagView_slot.png", "bagView_itemSelect.png");\r\n            itemSlot.createUI();\r\n            this.mBagItemSlotList.push(itemSlot);\r\n        }\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_3__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n        });\r\n        this.mClsBtn.x = (this.mWidth >> 1) - 65;\r\n        this.mClsBtn.y = -this.mHeight >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.mClsBtn.on("pointerup", this.hide, this);\r\n        this.add(this.mClsBtn);\r\n    };\r\n    StoragePanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bagView";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.mScene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    StoragePanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_storageMediator__WEBPACK_IMPORTED_MODULE_5__["StorageMediator"].NAME).resize();\r\n    };\r\n    return StoragePanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/storage/storagePanel.ts?')},"./src/ui/baseMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseMediator", function() { return BaseMediator; });\n/* harmony import */ var _game_world__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../game/world */ "./src/game/world.ts");\n\r\nvar BaseMediator = /** @class */ (function () {\r\n    function BaseMediator(world) {\r\n        this.isShowing = false;\r\n        this.mAddWid = 0;\r\n        this.mAddHei = 0;\r\n        this.world = world;\r\n        this.mUIType = 0 /* NoneUIType */;\r\n        this.world.emitter.on(_game_world__WEBPACK_IMPORTED_MODULE_0__["World"].SCALE_CHANGE, this.scaleChange, this);\r\n    }\r\n    BaseMediator.prototype.tweenView = function (show) {\r\n    };\r\n    BaseMediator.prototype.setUiScale = function (value) {\r\n        if (this.mView)\r\n            this.mView.scaleX = this.mView.scaleY = value;\r\n    };\r\n    BaseMediator.prototype.setViewAdd = function (wid, hei) {\r\n        this.mAddWid = wid;\r\n        this.mAddHei = hei;\r\n        this.resize();\r\n    };\r\n    BaseMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    BaseMediator.prototype.getUIType = function () {\r\n        return this.mUIType;\r\n    };\r\n    BaseMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        var view = this.getView();\r\n        if (view)\r\n            view.hide();\r\n    };\r\n    BaseMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    BaseMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    BaseMediator.prototype.showing = function () {\r\n        return this.isShowing;\r\n    };\r\n    BaseMediator.prototype.resize = function () {\r\n        var view = this.getView();\r\n        if (view && view.isShow())\r\n            view.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    BaseMediator.prototype.show = function (param) {\r\n        this.isShowing = true;\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    BaseMediator.prototype.update = function (param) {\r\n        var view = this.getView();\r\n        if (view)\r\n            view.update(param);\r\n    };\r\n    BaseMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    BaseMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    BaseMediator.prototype.destroy = function () {\r\n        this.isShowing = false;\r\n        this.mParam = null;\r\n        if (this.world && this.world.emitter)\r\n            this.world.emitter.off(_game_world__WEBPACK_IMPORTED_MODULE_0__["World"].SCALE_CHANGE, this.scaleChange, this);\r\n        var view = this.getView();\r\n        if (view) {\r\n            view.destroy();\r\n            view = null;\r\n        }\r\n    };\r\n    BaseMediator.prototype.scaleChange = function () {\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    return BaseMediator;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseMediator.ts?')},"./src/ui/baseView/bagGroup/bag.group.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagGroupMediator", function() { return BagGroupMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _bag_group__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bag.group */ "./src/ui/baseView/bagGroup/bag.group.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * 背包场景UI，带背包slot，pc端用\r\n */\r\nvar BagGroupMediator = /** @class */ (function (_super) {\r\n    __extends(BagGroupMediator, _super);\r\n    function BagGroupMediator(mWorld, scene) {\r\n        var _this = _super.call(this, mWorld, scene) || this;\r\n        _this.mUIType = 1 /* BaseUIType */;\r\n        return _this;\r\n    }\r\n    BagGroupMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    BagGroupMediator.prototype.isShow = function () {\r\n        if (this.mView) {\r\n            return this.mView.isShow();\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        var size = this.world.getSize();\r\n        this.mView = new _bag_group__WEBPACK_IMPORTED_MODULE_2__["BagGroup"](this.mScene, this.world, (size.width >> 1) - 29, size.height - 50);\r\n        this.mView.show(param);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackAge, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagGroupMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    BagGroupMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackAge, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.heroItemChange = function () {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        if (this.mView) {\r\n            this.mView.setDataList(itemList);\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.queryPackAge = function (data) {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        if (data.id !== this.world.roomManager.currentRoom.playerManager.actor.package.id)\r\n            return;\r\n        if (this.mView) {\r\n            this.mView.setDataList(data.items);\r\n        }\r\n    };\r\n    BagGroupMediator.NAME = "BagGroupMediator";\r\n    return BagGroupMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bagGroup/bag.group.mediator.ts?')},"./src/ui/baseView/bagGroup/bag.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagGroup", function() { return BagGroup; });\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _components_radio__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/radio */ "./src/ui/components/radio.ts");\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 主界面ui pc版本\r\n */\r\nvar BagGroup = /** @class */ (function (_super) {\r\n    __extends(BagGroup, _super);\r\n    function BagGroup(scene, world, x, y) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        _this.mScene = scene;\r\n        _this.x = x;\r\n        _this.y = y;\r\n        world.uiManager.getUILayerManager().addToToolTipsLayer(_this);\r\n        _this.bagSlotList = [];\r\n        return _this;\r\n    }\r\n    BagGroup.prototype.isShow = function () {\r\n        return this.mShowing;\r\n    };\r\n    BagGroup.prototype.show = function (param) {\r\n        if (this.mShowing) {\r\n            // this.hide();\r\n            return;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagGroup.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        var chatMed = this.mWorld.uiManager.getMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"].NAME);\r\n        this.x = (size.width - this.mWid) / 2 < chatMed.getView().width ? chatMed.getView().width + this.width / 2 : (size.width - this.mWid) / 2;\r\n        this.y = size.height - 50;\r\n    };\r\n    BagGroup.prototype.tweenView = function (show) {\r\n        if (!this.mScene)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        var baseY = size.height - 50;\r\n        var toY = show === true ? baseY : baseY + 100;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    BagGroup.prototype.destroy = function () {\r\n        if (this.bagBtn) {\r\n            this.bagBtn.destroy(true);\r\n            this.bagBtn = null;\r\n        }\r\n        if (this.mBagBg) {\r\n            this.mBagBg.destroy(true);\r\n            this.mBagBg = null;\r\n        }\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.bagSlotList.length = 0;\r\n            this.bagSlotList = null;\r\n        }\r\n        if (this.mSubScriptSprite) {\r\n            this.mSubScriptSprite.destroy(true);\r\n            this.mSubScriptSprite = null;\r\n        }\r\n        if (this.mBagSelect) {\r\n            this.mBagSelect.destroy(true);\r\n            this.mBagSelect = null;\r\n        }\r\n        if (this.mBagBtnCon) {\r\n            this.mBagBtnCon.destroy(true);\r\n            this.mBagBtnCon = null;\r\n        }\r\n        this.mShowing = false;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        this.baseBagBgWid = 0;\r\n        this.mResStr = null;\r\n        this.mResPng = null;\r\n        this.mResJson = null;\r\n        this.mScene = null;\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BagGroup.prototype.setDataList = function (items) {\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (itemslot) {\r\n                if (itemslot)\r\n                    itemslot.getView().visible = false;\r\n            });\r\n        }\r\n        var childList = [];\r\n        var len = items.length > BagGroup.SlotMaxCount ? BagGroup.SlotMaxCount : items.length;\r\n        var tempWid = this.baseBagBgWid + 5;\r\n        for (var i = 0; i < len; i++) {\r\n            var itemSlot = this.bagSlotList[i];\r\n            itemSlot.getView().visible = true;\r\n            childList.push(itemSlot.toolTipCon);\r\n            itemSlot.dataChange(items[i]);\r\n            tempWid += 56 + 5;\r\n        }\r\n        if (this.mWid !== tempWid) {\r\n            this.mWid = tempWid;\r\n            if (this.buttons) {\r\n                this.buttons.destroy(true);\r\n                this.buttons = null;\r\n            }\r\n            this.buttons = this.mScene.rexUI.add.buttons({\r\n                x: (tempWid + this.mBagBg.width) / 2,\r\n                y: 0,\r\n                width: 56,\r\n                height: 56,\r\n                orientation: 0,\r\n                buttons: childList,\r\n                groupName: "bagBtn",\r\n                align: "right",\r\n                click: {\r\n                    mode: "pointerup",\r\n                    clickInterval: 100\r\n                },\r\n                space: 5,\r\n                name: "bag",\r\n            });\r\n            this.buttons.layout();\r\n            // this.buttons.on("button.click", function (button, groupName, index, pointer) {\r\n            //     if (index === 0) {\r\n            //     }\r\n            // }, this);\r\n            this.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.mWid, this.mHei), Phaser.Geom.Rectangle.Contains);\r\n            this.mWorld.uiManager.baseFaceResize();\r\n        }\r\n    };\r\n    BagGroup.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bag";\r\n        this.mResPng = "ui/bag/bag.png";\r\n        this.mResJson = "ui/bag/bag.json";\r\n        this.mScene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BagGroup.prototype.init = function () {\r\n        this.mWid = 0;\r\n        this.mHei = 65;\r\n        this.mBagBtnCon = this.mScene.add.container(0, 0);\r\n        this.mBagBg = this.mScene.add.sprite(0, 0, this.mResStr, "bag_BtnBg");\r\n        this.baseBagBgWid = this.mBagBg.width;\r\n        this.mWid += this.mBagBg.width + 5;\r\n        this.bagBtn = this.mScene.add.sprite(this.mBagBg.x, this.mBagBg.y, this.mResStr, "bag_Btn");\r\n        this.mSubScriptSprite = this.mScene.make.sprite(undefined, false);\r\n        this.mSubScriptSprite.setTexture(this.mResStr, "bag_SubScripta");\r\n        this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.mBagBg.width >> 1;\r\n        this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.mBagBg.height >> 1;\r\n        this.mBagBtnCon.addAt(this.mBagBg, 0);\r\n        this.mBagBtnCon.addAt(this.bagBtn, 1);\r\n        // this.mBagBtnCon.addAt(this.mSubScriptSprite, 2);\r\n        this.mBagBtnCon.setSize(56, 56);\r\n        this.mBagBtnCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.mBagBg.width, this.mBagBg.height), Phaser.Geom.Rectangle.Contains);\r\n        this.add(this.mBagBtnCon);\r\n        this.bagBtn.setInteractive();\r\n        this.bagBtn.on("pointerdown", this.bagHandler, this);\r\n        this.bagBtn.on("pointerover", this.bagBtnOver, this);\r\n        this.bagBtn.on("pointerout", this.bagBtnOut, this);\r\n        this.initBagSlot();\r\n        if (this.mWorld.roomManager.currentRoom && this.mWorld.roomManager.currentRoom.playerManager && this.mWorld.roomManager.currentRoom.playerManager.actor) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items)\r\n                this.setDataList(mPackage.items);\r\n        }\r\n        // childList.push(this.mBagBtnCon);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BagGroup.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.baseFaceResize();\r\n    };\r\n    BagGroup.prototype.initBagSlot = function () {\r\n        var subScriptList = ["0", "b", "c"];\r\n        var subScriptRes;\r\n        for (var i = 0; i < BagGroup.SlotMaxCount; i++) {\r\n            if (i >= 9) {\r\n                subScriptRes = "bag_SubScript" + subScriptList[i % 9];\r\n            }\r\n            else {\r\n                subScriptRes = "bag_SubScript" + (i + 1);\r\n            }\r\n            var itemSlot = new _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"](this.mScene, this.mWorld, this, 0, 0, this.mResStr, this.mResPng, this.mResJson, "bag_Slot", "", subScriptRes);\r\n            itemSlot.createUI();\r\n            itemSlot.getView().visible = false;\r\n            this.bagSlotList.push(itemSlot);\r\n        }\r\n    };\r\n    BagGroup.prototype.bagHandler = function () {\r\n        // this.mWorld.uiManager.getMediator(FriendMediator.NAME).show();\r\n        var med = this.mWorld.uiManager.getMediator(_bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_5__["BagMediator"].NAME);\r\n        if (med.isShow()) {\r\n            med.hide();\r\n            return;\r\n        }\r\n        med.show();\r\n    };\r\n    BagGroup.prototype.tmpLoad = function () {\r\n        var _this = this;\r\n        if (!this.radio) {\r\n            this.radio = new _components_radio__WEBPACK_IMPORTED_MODULE_3__["Radio"](this.mScene, {\r\n                wid: 328,\r\n                hei: 142,\r\n                resKey: "juqingRadio",\r\n                resPng: "./resources/ui/juqing/juqing.png",\r\n                resJson: "./resources/ui/juqing/juqing.json",\r\n                resBg: "radio_bg.png",\r\n                resArrow: "radio_arrow.png",\r\n                fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n                completeBack: function () {\r\n                    _this.radioComplete();\r\n                },\r\n                clickCallBack: function () {\r\n                    if (_this.radio && _this.radio.parentContainer) {\r\n                        _this.radio.clearRadioData();\r\n                        _this.radio.parentContainer.remove(_this.radio);\r\n                    }\r\n                }\r\n            });\r\n            return;\r\n        }\r\n        if (this.radio.isShow) {\r\n            return;\r\n        }\r\n        this.radioComplete();\r\n    };\r\n    BagGroup.prototype.radioComplete = function () {\r\n        this.radio.setRadioData(["1111111111", "2222222222", "333333333333", "444444444444"]);\r\n        this.radio.x = this.bagBtn.x;\r\n        this.radio.y = this.bagBtn.y - 142;\r\n        this.add(this.radio);\r\n    };\r\n    BagGroup.prototype.bagBtnOver = function (pointer) {\r\n        this.mBagSelect = this.mScene.make.sprite(undefined, false);\r\n        this.mBagSelect.setTexture(this.mResStr, "bag_BtnSelect");\r\n        this.mBagBtnCon.add(this.mBagSelect);\r\n        // this.tmpLoad();\r\n    };\r\n    BagGroup.prototype.bagBtnOut = function (pointer) {\r\n        if (this.mBagSelect && this.mBagSelect.parentContainer) {\r\n            this.mBagSelect.parentContainer.remove(this.mBagSelect);\r\n        }\r\n    };\r\n    BagGroup.SlotMaxCount = 12;\r\n    return BagGroup;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_2__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bagGroup/bag.group.ts?')},"./src/ui/baseView/baseFace.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseFaceMediator", function() { return BaseFaceMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n/**\r\n * 场景UImediator\r\n */\r\nvar BaseFaceMediator = /** @class */ (function (_super) {\r\n    __extends(BaseFaceMediator, _super);\r\n    function BaseFaceMediator(mWorld, scene) {\r\n        var _this = _super.call(this, mWorld) || this;\r\n        _this.mScene = scene;\r\n        _this.mUIType = 1 /* BaseUIType */;\r\n        return _this;\r\n    }\r\n    BaseFaceMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    BaseFaceMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    BaseFaceMediator.prototype.tweenView = function (show) {\r\n    };\r\n    BaseFaceMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    BaseFaceMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    BaseFaceMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView)\r\n            this.mView = null;\r\n    };\r\n    BaseFaceMediator.prototype.destroy = function () {\r\n        if (this.mView)\r\n            this.mView.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return BaseFaceMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/baseFace.mediator.ts?')},"./src/ui/baseView/bottomGroup/bottom.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottomBtnGroup", function() { return BottomBtnGroup; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _components_check_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/check.button */ "./src/ui/components/check.button.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../rightGroup/right.mediator */ "./src/ui/baseView/rightGroup/right.mediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar BottomBtnGroup = /** @class */ (function (_super) {\r\n    __extends(BottomBtnGroup, _super);\r\n    // private mOrientation: Phaser.Scale.Orientation;\r\n    function BottomBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mExpandBoo = false;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    BottomBtnGroup.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BottomBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.x = size.width >> 1;\r\n            this.mVoiceBtn.x = this.mVoiceBtn.width * this.mMicBtn.scaleX - this.mChatContainer.width / 2;\r\n            this.mVoiceBtn.y = -this.mVoiceBtn.height / 2 * this.mVoiceBtn.scaleY - this.mChatContainer.height / 2;\r\n            this.mMicBtn.x = this.mVoiceBtn.x + this.mVoiceBtn.width * this.mMicBtn.scaleX + 20;\r\n            this.mMicBtn.y = this.mVoiceBtn.y;\r\n        }\r\n        else if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.PORTRAIT) {\r\n            this.x = size.width - (this.width / 2 + 40) * this.mWorld.uiScale;\r\n            this.mVoiceBtn.x = this.mVoiceBtn.width - this.mChatContainer.width / 2;\r\n            this.mVoiceBtn.y = this.mChatContainer.y - this.mChatContainer.height / 2 - this.mVoiceBtn.height / 2 * this.mMicBtn.scaleX;\r\n            this.mMicBtn.x = this.mVoiceBtn.x + this.mMicBtn.width * this.mMicBtn.scaleX + 20;\r\n            this.mMicBtn.y = this.mVoiceBtn.y;\r\n        }\r\n        this.y = size.height - 120 * this.mWorld.uiScale;\r\n        var rightMediator = this.mWorld.uiManager.getMediator(_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__["RightMediator"].NAME);\r\n        var joyStick = this.mWorld.inputManager;\r\n        var rightBtnGroup;\r\n        if (rightMediator) {\r\n            rightBtnGroup = rightMediator.getView();\r\n        }\r\n        if (rightMediator) {\r\n            joyStick.resize();\r\n            if (rightBtnGroup)\r\n                rightBtnGroup.resize();\r\n        }\r\n        this.mChatText.setStyle({ "fontSize": Math.floor(30 * this.mWorld.uiScale) });\r\n    };\r\n    BottomBtnGroup.prototype.tweenView = function (show) {\r\n        var size = this.mWorld.getSize();\r\n        var baseY = size.height - 120 * this.mWorld.uiScale;\r\n        var toY = show === true ? baseY : baseY + 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    BottomBtnGroup.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.mScene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        this.mScene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BottomBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        this.mBtnList = [];\r\n        var size = this.mWorld.getSize();\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var chatBgWidth = 430;\r\n        var chatBgHeight = 230;\r\n        this.mChatContainer = this.mScene.make.container(undefined, false);\r\n        this.mChatBg = this.mScene.make.image(undefined, false);\r\n        this.mChatBg.setTexture(this.mResKey, "btnGroup_chatBg.png");\r\n        this.mChatContainer.addAt(this.mChatBg, 0);\r\n        this.mChatText = this.mScene.make.text({\r\n            width: chatBgWidth,\r\n            height: chatBgHeight,\r\n            style: { font: "bold YaHei", color: "#666666", fontSize: Math.floor(30 * this.mWorld.uiScale), wordWrap: { width: 430, useAdvancedWrap: true } }\r\n        }, false);\r\n        this.mChatText.setText("点击窗口进入聊天界面");\r\n        this.mChatContainer.addAt(this.mChatText, 1);\r\n        this.mChatContainer.setSize(chatBgWidth, chatBgHeight);\r\n        this.mChatText.x = -this.mChatContainer.width >> 1;\r\n        this.mChatText.y = -this.mChatContainer.height >> 1;\r\n        this.mChatContainer.setInteractive(new Phaser.Geom.Rectangle(0, 0, chatBgWidth, chatBgHeight), Phaser.Geom.Rectangle.Contains);\r\n        this.add(this.mChatContainer);\r\n        this.mWid += this.mChatContainer.width;\r\n        this.mHei += this.mChatContainer.height;\r\n        this.mTurnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].Turn_Btn_Bottom, bgResKey: this.mResKey, bgTextures: ["btnGroup_white_normal.png", "btnGroup_white_light.png", "btnGroup_white_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_bottom_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mTurnBtn.x = (this.mWid >> 1) + 30;\r\n        this.mTurnBtn.y = this.mHei - this.mTurnBtn.height >> 1;\r\n        this.mTurnBtn.setPos(this.mTurnBtn.x, this.mTurnBtn.y);\r\n        this.add(this.mTurnBtn);\r\n        this.mBagBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_bag_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mBagBtn.x = this.mTurnBtn.x;\r\n        this.mBagBtn.y = this.mTurnBtn.y - this.mTurnBtn.height / 2 - this.mBagBtn.height / 2 - 10;\r\n        this.mBagBtn.setPos(this.mBagBtn.x, this.mBagBtn.y);\r\n        this.mWid += this.mBagBtn.width + 30;\r\n        this.add(this.mBagBtn);\r\n        this.setSize(this.mWid, this.mHei);\r\n        this.mBtnList.push(this.mBagBtn);\r\n        this.mTurnBtn.setClick(function () {\r\n            _this.turnHandler();\r\n        });\r\n        this.mBagBtn.setClick(function () {\r\n            _this.bagHandler();\r\n        });\r\n        this.mChatContainer.on("pointerdown", this.chatHandler, this);\r\n        this.mVoiceBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.mScene, 0, 0, "chat_atlas", "voice_normal.png", "voice_selected.png");\r\n        this.mVoiceBtn.x = this.width - 60 * this.mWorld.uiScale;\r\n        this.mVoiceBtn.y = size.height - this.height;\r\n        this.add(this.mVoiceBtn);\r\n        this.mMicBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.mScene, 0, 0, "chat_atlas", "mic_normal.png", "mic_selected.png");\r\n        this.mMicBtn.x = this.width - 20 * this.mWorld.uiScale;\r\n        this.mMicBtn.y = size.height - this.height;\r\n        this.add(this.mMicBtn);\r\n        this.mVoiceBtn.scaleX = this.mVoiceBtn.scaleY = 1.5;\r\n        this.mMicBtn.scaleX = this.mMicBtn.scaleY = 1.5;\r\n        this.mVoiceBtn.on("selected", this.onSelectedVoiceHandler, this);\r\n        this.mMicBtn.on("selected", this.onSelectedMicHandler, this);\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BottomBtnGroup.prototype.tweenComplete = function (show) {\r\n        this.resize();\r\n        _super.prototype.tweenComplete.call(this, show);\r\n    };\r\n    BottomBtnGroup.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val === false) {\r\n            this.mMicBtn.selected = false;\r\n        }\r\n        this.emit("selectedVoice", val);\r\n    };\r\n    BottomBtnGroup.prototype.onSelectedMicHandler = function (val) {\r\n        if (this.mVoiceBtn.selected === false) {\r\n            this.mMicBtn.selected = false;\r\n            return;\r\n        }\r\n        this.mMicBtn.selected = val;\r\n        this.emit("selectedMic", val);\r\n    };\r\n    BottomBtnGroup.prototype.turnHandler = function () {\r\n        var _this = this;\r\n        // const med: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // (med.getView() as MainUIMobile).getTopView().removeBtn({ medKey: "RankMediator" });\r\n        // return;\r\n        this.mVoiceBtn.visible = this.mExpandBoo;\r\n        this.mMicBtn.visible = this.mExpandBoo;\r\n        var easeType = this.mExpandBoo ? "Sine.easeIn" : "Sine.easeOut";\r\n        if (this.mChatContainer && this.mChatContainer.parentContainer) {\r\n            var toScaleX = this.mExpandBoo ? 1 : 0;\r\n            var toScaleY = this.mExpandBoo ? 1 : 0;\r\n            this.mScene.tweens.add({\r\n                targets: this.mChatContainer,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    scaleX: { value: toScaleX },\r\n                    scaleY: { value: toScaleY }\r\n                }\r\n            });\r\n        }\r\n        if (!this.mBtnList || this.mBtnList.length < 1) {\r\n            this.mExpandBoo = !this.mExpandBoo;\r\n            return;\r\n        }\r\n        var len = this.mBtnList.length;\r\n        var size = this.mWorld.getSize();\r\n        var rightMediator = this.mWorld.uiManager.getMediator(_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__["RightMediator"].NAME);\r\n        var joyStick = this.mWorld.inputManager;\r\n        var rightBtnGroup;\r\n        if (rightMediator) {\r\n            rightBtnGroup = rightMediator.getView();\r\n        }\r\n        var _loop_1 = function (i) {\r\n            var btn = this_1.mBtnList[i];\r\n            var angle = (90 * (i + 2) / -180) * Math.PI;\r\n            var toX = this_1.mExpandBoo ? btn.getPos().x : this_1.mChatContainer.width / 2 - Math.abs(btn.getPos().y) - 20;\r\n            var toY = this_1.mExpandBoo ? btn.getPos().y : this_1.mTurnBtn.y;\r\n            this_1.mScene.tweens.add({\r\n                targets: btn,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    x: { value: toX },\r\n                    y: { value: toY }\r\n                },\r\n                onComplete: function (tween, targets, ship) {\r\n                    if (i === len - 1) {\r\n                        _this.mExpandBoo = !_this.mExpandBoo;\r\n                        if (!_this.mExpandBoo) {\r\n                            _this.setSize(_this.mWid, _this.mHei);\r\n                        }\r\n                        else {\r\n                            _this.setSize(_this.mWid, btn.height * 2);\r\n                        }\r\n                        if (rightMediator) {\r\n                            joyStick.resize();\r\n                            if (rightBtnGroup)\r\n                                rightBtnGroup.resize();\r\n                        }\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1]\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    BottomBtnGroup.prototype.chatHandler = function () {\r\n        // ======================show chatView\r\n        var chatMed = this.mWorld.uiManager.getMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"].NAME);\r\n        if (chatMed === undefined) {\r\n            chatMed = new _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"](this.mWorld, this.mScene);\r\n            this.mWorld.uiManager.setMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"].NAME, chatMed);\r\n        }\r\n        var showBoo = chatMed.isShow();\r\n        if (showBoo) {\r\n            // chatMed.hide();\r\n        }\r\n        else {\r\n            chatMed.show();\r\n        }\r\n        // =====================tween out/in baseView\r\n        this.mWorld.uiManager.baseFaceTween(false);\r\n    };\r\n    BottomBtnGroup.prototype.bagHandler = function () {\r\n        this.mWorld.uiManager.getMediator(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].BagMediator).show();\r\n        // =============index = 0 为背包按钮\r\n    };\r\n    return BottomBtnGroup;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bottomGroup/bottom.btn.group.ts?')},"./src/ui/baseView/bottomGroup/bottom.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottomMediator", function() { return BottomMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _bottom_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./bottom.btn.group */ "./src/ui/baseView/bottomGroup/bottom.btn.group.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar BottomMediator = /** @class */ (function (_super) {\r\n    __extends(BottomMediator, _super);\r\n    function BottomMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    BottomMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    BottomMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _bottom_btn_group__WEBPACK_IMPORTED_MODULE_1__["BottomBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BottomMediator.NAME = "BottomMediator";\r\n    return BottomMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bottomGroup/bottom.mediator.ts?')},"./src/ui/baseView/icon.btn.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IconBtn", function() { return IconBtn; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * 多帧资源按钮\r\n */\r\nvar IconBtn = /** @class */ (function (_super) {\r\n    __extends(IconBtn, _super);\r\n    // // 按钮打开模块的name，用于打开和关闭此模块及模块更新时，主界面按钮的更新（显示和隐藏）\r\n    // private medName: string;\r\n    function IconBtn(scene, world, data) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mBtnBg = scene.make.image(undefined, false);\r\n        _this.mBgResKey = data.bgResKey;\r\n        _this.mBgTexture = data.bgTextures;\r\n        _this.mData = data;\r\n        if (!_this.mScene.textures.exists(_this.mBgResKey)) {\r\n            _this.mScene.load.atlas(data.key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(data.pngUrl), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(data.jsonUrl));\r\n            _this.mScene.load.once(Phaser.Loader.Events.COMPLETE, _this.loadComplete, _this);\r\n            _this.mScene.load.start();\r\n            return _this;\r\n        }\r\n        _this.loadComplete();\r\n        return _this;\r\n    }\r\n    // public setMedName(name: string) {\r\n    //     this.medName = name;\r\n    // }\r\n    IconBtn.prototype.getKey = function () {\r\n        return this.mData.key;\r\n    };\r\n    IconBtn.prototype.setPos = function (x, y) {\r\n        if (!this.mBasePos) {\r\n            this.mBasePos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mBasePos.x = x;\r\n        this.mBasePos.y = y;\r\n    };\r\n    /**\r\n     * 获取按钮的初始化时的位置，用于tween时，按钮来回切换位置用\r\n     */\r\n    IconBtn.prototype.getPos = function () {\r\n        return this.mBasePos;\r\n    };\r\n    IconBtn.prototype.setBtnData = function (value) {\r\n        this.mBtnData = value;\r\n    };\r\n    IconBtn.prototype.getBtnData = function () {\r\n        return this.mBtnData;\r\n    };\r\n    IconBtn.prototype.setClick = function (func) {\r\n        this.monClick = func;\r\n    };\r\n    IconBtn.prototype.destroy = function () {\r\n        if (this.mBtnBg) {\r\n            this.mBtnBg.destroy(true);\r\n        }\r\n        if (this.mBtnIcon) {\r\n            this.mBtnIcon.destroy(true);\r\n        }\r\n        this.monClick = null;\r\n        this.mBtnBg = null;\r\n        this.mBtnIcon = null;\r\n        this.mBtnData = null;\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    IconBtn.prototype.loadComplete = function () {\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[0]);\r\n        this.mBtnBg.scaleX = this.mBtnBg.scaleY = this.mData.scale;\r\n        this.addAt(this.mBtnBg, 0);\r\n        if (this.mData.iconResKey && this.mData.iconTexture && this.mData.iconTexture.length > 0) {\r\n            this.mBtnIcon = this.mScene.make.image(undefined, false);\r\n            this.mBtnIcon.setTexture(this.mData.iconResKey, this.mData.iconTexture);\r\n            this.add(this.mBtnIcon);\r\n        }\r\n        this.setSize(this.mBtnBg.width, this.mBtnBg.height);\r\n        this.setInteractive();\r\n        this.on("pointerup", this.upHandler, this);\r\n        this.on("pointerdown", this.downHandler, this);\r\n        this.on("pointerover", this.overHandler, this);\r\n        this.on("pointerout", this.outHandler, this);\r\n    };\r\n    IconBtn.prototype.overHandler = function (pointer) {\r\n        if (this.mBgTexture.length < 2) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[1]);\r\n    };\r\n    IconBtn.prototype.outHandler = function (pointer) {\r\n        if (this.mBgTexture.length < 2) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[0]);\r\n    };\r\n    IconBtn.prototype.upHandler = function () {\r\n        if (this.monClick) {\r\n            this.monClick();\r\n        }\r\n        if (this.mData && this.mData.callBack) {\r\n            this.mData.callBack.apply(this);\r\n        }\r\n        this.emit("click", this);\r\n        if (this.mBgTexture.length < 3) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[2]);\r\n    };\r\n    IconBtn.prototype.downHandler = function () {\r\n        // this.scaleHandler();\r\n        if (this.mBgTexture.length < 4) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[3]);\r\n    };\r\n    IconBtn.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    return IconBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/icon.btn.ts?')},"./src/ui/baseView/icon.select.btn.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IconSelectBtn", function() { return IconSelectBtn; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n/**\r\n * 切换状态按钮(点击后状态改变的按钮，需要多帧资源)\r\n */\r\nvar IconSelectBtn = /** @class */ (function (_super) {\r\n    __extends(IconSelectBtn, _super);\r\n    function IconSelectBtn(scene, world, bgResKey, bgTexture, scale) {\r\n        if (scale === void 0) { scale = 28 / 43; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mBtnBg = scene.make.image(undefined, false);\r\n        _this.mBgTexture = bgTexture;\r\n        _this.mBgResKey = bgResKey;\r\n        _this.mBtnBg.setTexture(bgResKey, bgTexture[0]);\r\n        _this.mBtnBg.scaleX = _this.mBtnBg.scaleY = scale;\r\n        _this.addAt(_this.mBtnBg, 0);\r\n        _this.setSize(_this.mBtnBg.width, _this.mBtnBg.height);\r\n        _this.setInteractive();\r\n        _this.on("pointerup", _this.upHandler, _this);\r\n        _this.on("pointerdown", _this.downHandler, _this);\r\n        _this.on("pointerover", _this.overHandler, _this);\r\n        _this.on("pointerout", _this.outHandler, _this);\r\n        return _this;\r\n    }\r\n    IconSelectBtn.prototype.setPos = function (x, y) {\r\n        if (!this.mBasePos) {\r\n            this.mBasePos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mBasePos.x = x;\r\n        this.mBasePos.y = y;\r\n    };\r\n    /**\r\n     * 获取按钮的初始化时的位置，用于tween时，按钮来回切换位置用\r\n     */\r\n    IconSelectBtn.prototype.getPos = function () {\r\n        return this.mBasePos;\r\n    };\r\n    IconSelectBtn.prototype.setBtnData = function (value) {\r\n        this.mBtnData = value;\r\n    };\r\n    IconSelectBtn.prototype.getBtnData = function () {\r\n        return this.mBtnData;\r\n    };\r\n    IconSelectBtn.prototype.setClick = function (func) {\r\n        this.monClick = func;\r\n    };\r\n    IconSelectBtn.prototype.setBgRes = function (index) {\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[index] || 0);\r\n    };\r\n    IconSelectBtn.prototype.destroy = function () {\r\n        if (this.mBtnBg) {\r\n            this.mBtnBg.destroy(true);\r\n        }\r\n        if (this.mBtnIcon) {\r\n            this.mBtnIcon.destroy(true);\r\n        }\r\n        this.monClick = null;\r\n        this.mBtnBg = null;\r\n        this.mBtnIcon = null;\r\n        this.mBtnData = null;\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    IconSelectBtn.prototype.overHandler = function (pointer) {\r\n    };\r\n    IconSelectBtn.prototype.outHandler = function (pointer) {\r\n    };\r\n    IconSelectBtn.prototype.upHandler = function () {\r\n        if (this.monClick) {\r\n            this.monClick();\r\n        }\r\n    };\r\n    IconSelectBtn.prototype.downHandler = function () {\r\n        this.scaleHandler();\r\n    };\r\n    IconSelectBtn.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    return IconSelectBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/icon.select.btn.ts?')},"./src/ui/baseView/leftGroup/left.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LeftBtnGroup", function() { return LeftBtnGroup; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_select_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.select.btn */ "./src/ui/baseView/icon.select.btn.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar LeftBtnGroup = /** @class */ (function (_super) {\r\n    __extends(LeftBtnGroup, _super);\r\n    function LeftBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mCollapse = false;\r\n        return _this;\r\n    }\r\n    LeftBtnGroup.prototype.show = function (param) {\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    LeftBtnGroup.prototype.resize = function () {\r\n        this.x = this.width + 5 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    LeftBtnGroup.prototype.destroy = function () {\r\n        if (this.mExpandBtn) {\r\n            this.mExpandBtn.destroy();\r\n        }\r\n        this.mResKey = "";\r\n        this.mExpandBtn = null;\r\n        this.mCollapse = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    LeftBtnGroup.prototype.tweenView = function (show) {\r\n        var baseX = this.width + 5 * this.mWorld.uiScale;\r\n        var toX = show === true ? baseX : baseX - 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    LeftBtnGroup.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.mScene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    LeftBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var hei = 0;\r\n        // const btnResList: string[] = this.mCollapse === false ? ["btnGroup_expand.png", "btnGroup_expand.png", "btnGroup_collapse.png", "btnGroup_collapse.png"] : ["btnGroup_collapse.png", "btnGroup_collapse.png", "btnGroup_expand.png", "btnGroup_expand.png"];\r\n        if (this.mWorld.getConfig().platform !== "app") {\r\n            this.mExpandBtn = new _icon_select_btn__WEBPACK_IMPORTED_MODULE_2__["IconSelectBtn"](this.mScene, this.mWorld, this.mResKey, ["btnGroup_expand.png", "btnGroup_collapse.png"], 1);\r\n            this.add(this.mExpandBtn);\r\n            this.mExpandBtn.setClick(function () {\r\n                if (!_this.mCollapse) {\r\n                    _this.mWorld.startFullscreen();\r\n                }\r\n                else {\r\n                    _this.mWorld.stopFullscreen();\r\n                }\r\n                _this.mExpandBtn.setBgRes(Number(!_this.mCollapse));\r\n                _this.mCollapse = !_this.mCollapse;\r\n            });\r\n            hei += this.mExpandBtn.height / 2 + 20;\r\n            this.setSize(this.mExpandBtn.width, hei);\r\n        }\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    return LeftBtnGroup;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/leftGroup/left.btn.group.ts?')},"./src/ui/baseView/leftGroup/left.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LeftMediator", function() { return LeftMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _left_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./left.btn.group */ "./src/ui/baseView/leftGroup/left.btn.group.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar LeftMediator = /** @class */ (function (_super) {\r\n    __extends(LeftMediator, _super);\r\n    function LeftMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    LeftMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    LeftMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _left_btn_group__WEBPACK_IMPORTED_MODULE_1__["LeftBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    LeftMediator.NAME = "LeftMediator";\r\n    return LeftMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/leftGroup/left.mediator.ts?')},"./src/ui/baseView/rightGroup/right.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RightBtnGroup", function() { return RightBtnGroup; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../bottomGroup/bottom.mediator */ "./src/ui/baseView/bottomGroup/bottom.mediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar RightBtnGroup = /** @class */ (function (_super) {\r\n    __extends(RightBtnGroup, _super);\r\n    function RightBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mBtnY = 0;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    RightBtnGroup.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RightBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.refreshSlot();\r\n        var bottomMed = this.mWorld.uiManager.getMediator(_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_7__["BottomMediator"].NAME);\r\n        var padHei = !bottomMed ? this.height / 2 : bottomMed.getView().height;\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            this.y = size.height - (this.height) * this.mWorld.uiScale;\r\n            this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            if (mPackage && mPackage.items && mPackage.items.length > 0) {\r\n                this.y = size.height - (this.height / 2) * this.mWorld.uiScale;\r\n                this.x = size.width - (this.width / 4) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                this.y = size.height - (this.height) * this.mWorld.uiScale;\r\n                this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            }\r\n        }\r\n        else if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.PORTRAIT) {\r\n            this.y = size.height - (padHei + this.height / 2) * this.mWorld.uiScale;\r\n            this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n        }\r\n    };\r\n    RightBtnGroup.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.destroy();\r\n    };\r\n    RightBtnGroup.prototype.destroy = function () {\r\n        this.mBtnY = 0;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        if (this.mBagSlotList) {\r\n            this.mBagSlotList.forEach(function (itemslot) {\r\n                if (itemslot) {\r\n                    itemslot.destroy();\r\n                    itemslot = null;\r\n                }\r\n            });\r\n        }\r\n        this.mResKey = "";\r\n        this.mBagSlotList = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RightBtnGroup.prototype.tweenView = function (show) {\r\n        var size = this.mWorld.getSize();\r\n        var baseX;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items && mPackage.items.length > 0) {\r\n                baseX = size.width - (this.width / 4) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                baseX = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            }\r\n        }\r\n        else {\r\n            baseX = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n        }\r\n        var toX = show === true ? baseX : baseX + this.width;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    RightBtnGroup.prototype.refreshSlot = function () {\r\n        if (!this.handBtn)\r\n            return;\r\n        this.mHei = this.handBtn.height;\r\n        if (this.mBagSlotList) {\r\n            this.mBagSlotList.forEach(function (itemslot) {\r\n                if (itemslot) {\r\n                    itemslot.getView().visible = false;\r\n                }\r\n            });\r\n            // =============获取角色背包前几位物品\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items) {\r\n                var items = mPackage.items;\r\n                var len = items.length > RightBtnGroup.SlotMaxCount ? RightBtnGroup.SlotMaxCount : items.length;\r\n                var posX = 0;\r\n                var posY = 0;\r\n                var radio = 110;\r\n                var slotSize = 56;\r\n                var baseAngle = 38;\r\n                for (var i = 0; i < len; i++) {\r\n                    if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                        var angle = (baseAngle * (i + 2) / -180) * Math.PI;\r\n                        posX = radio * Math.cos(angle);\r\n                        posY = this.handBtn.y + radio * Math.sin(angle);\r\n                        if (i === len - 1) {\r\n                            this.mWid = radio + this.handBtn.width + 30 + slotSize / 2;\r\n                            this.mHei = radio + this.handBtn.height + 30 + slotSize / 2;\r\n                        }\r\n                    }\r\n                    else {\r\n                        posX = 0;\r\n                        posY = -slotSize * (i + 1) - 20 * i;\r\n                        if (i === len - 1) {\r\n                            this.mWid = this.handBtn.width;\r\n                            this.mHei = slotSize * (len - 1) + 5 * (len - 2) + this.handBtn.height + 5;\r\n                        }\r\n                    }\r\n                    var itemSlot = this.mBagSlotList[i];\r\n                    itemSlot.getView().visible = true;\r\n                    itemSlot.toolTipCon.x = posX;\r\n                    itemSlot.toolTipCon.y = posY;\r\n                    itemSlot.dataChange(items[i]);\r\n                }\r\n            }\r\n        }\r\n        this.setSize(this.mWid, this.mHei);\r\n    };\r\n    RightBtnGroup.prototype.tweenComplete = function (show) {\r\n        this.resize();\r\n        _super.prototype.tweenComplete.call(this, show);\r\n    };\r\n    RightBtnGroup.prototype.preload = function () {\r\n        this.mResKey = "baseView";\r\n        this.mScene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    RightBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        this.mBtnY = 0;\r\n        this.handBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_1__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_bg.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_hand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.handBtn.x = 0;\r\n        this.handBtn.y = this.mBtnY + this.handBtn.height / 2;\r\n        this.handBtn.setClick(function () {\r\n            // f键值为70，点击该按钮交互\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n            var content = pkt.content;\r\n            content.keyCodes = [70];\r\n            _this.mWorld.connection.send(pkt);\r\n            // ========临时调试用\r\n            // const mainUIMed: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n            // mainUIMed.tweenView(false);\r\n            // this.mWorld.uiManager.getMediator(BagMediator.NAME).show();\r\n        });\r\n        this.add(this.handBtn);\r\n        this.mWid = this.handBtn.width;\r\n        this.mHei = this.handBtn.height;\r\n        this.initBagSlotData();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    RightBtnGroup.prototype.initBagSlotData = function () {\r\n        this.mBagSlotList = [];\r\n        var size = this.mWorld.getSize();\r\n        var len = RightBtnGroup.SlotMaxCount;\r\n        var posX = 0;\r\n        var posY = 0;\r\n        for (var i = 0; i < len; i++) {\r\n            var itemSlot = new _bag_item_slot__WEBPACK_IMPORTED_MODULE_2__["ItemSlot"](this.mScene, this.mWorld, this, posX, posY, this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.json"), "btnGroup_bg.png");\r\n            itemSlot.createUI();\r\n            itemSlot.getBg().scaleX = itemSlot.getBg().scaleY = 0.8;\r\n            itemSlot.getIcon().scaleX = itemSlot.getIcon().scaleY = 1.2;\r\n            this.mBagSlotList.push(itemSlot);\r\n            this.add(itemSlot.toolTipCon);\r\n            itemSlot.getView().visible = false;\r\n        }\r\n        this.resize();\r\n    };\r\n    RightBtnGroup.SlotMaxCount = 4;\r\n    return RightBtnGroup;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/rightGroup/right.btn.group.ts?')},"./src/ui/baseView/rightGroup/right.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RightMediator", function() { return RightMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _right_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./right.btn.group */ "./src/ui/baseView/rightGroup/right.btn.group.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar RightMediator = /** @class */ (function (_super) {\r\n    __extends(RightMediator, _super);\r\n    function RightMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    RightMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    RightMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _right_btn_group__WEBPACK_IMPORTED_MODULE_1__["RightBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RightMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    RightMediator.prototype.heroItemChange = function () {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        if (this.mView) {\r\n            if (this.mView)\r\n                this.mView.refreshSlot();\r\n        }\r\n    };\r\n    RightMediator.NAME = "RightMediator";\r\n    return RightMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/rightGroup/right.mediator.ts?')},"./src/ui/baseView/top.menu/top.menu.container.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMenuContainer", function() { return TopMenuContainer; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar TopMenuContainer = /** @class */ (function (_super) {\r\n    __extends(TopMenuContainer, _super);\r\n    function TopMenuContainer(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.maxNum = 3;\r\n        _this.mButtons = [];\r\n        return _this;\r\n    }\r\n    TopMenuContainer.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - 50 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    TopMenuContainer.prototype.show = function () {\r\n        if (this.mWorld) {\r\n            this.mWorld.uiManager.getUILayerManager().addToUILayer(this);\r\n        }\r\n        _super.prototype.show.call(this);\r\n    };\r\n    TopMenuContainer.prototype.hide = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    TopMenuContainer.prototype.addItem = function (data) {\r\n        if (!this.mShowing) {\r\n            this.show();\r\n        }\r\n        // TODO dynamic load texture\r\n        var iconBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_1__["IconBtn"](this.scene, this.mWorld, data);\r\n        iconBtn.setName(data.name);\r\n        iconBtn.y = iconBtn.height >> 1;\r\n        this.add(iconBtn);\r\n        iconBtn.on("click", this.onGameObjectUpHandler, this);\r\n        this.mButtons.push(iconBtn);\r\n        if (this.mButtons.length > 3) {\r\n            // TODO add turn button\r\n        }\r\n    };\r\n    TopMenuContainer.prototype.removeItem = function (name) {\r\n        var index = this.mButtons.findIndex(function (icon) { return icon.name === name; });\r\n        if (index >= 0) {\r\n            this.mButtons[index].destroy();\r\n            this.mButtons.splice(index, 1);\r\n        }\r\n        if (this.mButtons.length < this.maxNum) {\r\n            // TODO remove turn button\r\n        }\r\n        if (this.mButtons.length === 0) {\r\n            // TODO remove\r\n            this.hide();\r\n        }\r\n    };\r\n    TopMenuContainer.prototype.preload = function () {\r\n        this.mScene.load.atlas("baseView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    TopMenuContainer.prototype.init = function () {\r\n        if (this.mInitialized) {\r\n            return;\r\n        }\r\n        _super.prototype.init.call(this);\r\n        // this.addItem({ key: "Turn_Btn_Top", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"], iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1 });\r\n        this.resize();\r\n    };\r\n    TopMenuContainer.prototype.refresh = function () {\r\n    };\r\n    TopMenuContainer.prototype.expand = function () {\r\n    };\r\n    TopMenuContainer.prototype.collapse = function () {\r\n    };\r\n    TopMenuContainer.prototype.destroy = function () {\r\n        this.mButtons.map(function (btn) { return btn.destroy(); });\r\n        this.mButtons.length = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopMenuContainer.prototype.onGameObjectUpHandler = function (btn) {\r\n        switch (btn.name) {\r\n            case "SaveDecorate":\r\n                this.emit("saveDecorate");\r\n                break;\r\n            case "EnterDecorate":\r\n                this.emit("enterDecorate");\r\n                break;\r\n        }\r\n    };\r\n    return TopMenuContainer;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/top.menu/top.menu.container.ts?')},"./src/ui/baseView/top.menu/top.menu.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMenuMediator", function() { return TopMenuMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _top_menu_container__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./top.menu.container */ "./src/ui/baseView/top.menu/top.menu.container.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopMenuMediator = /** @class */ (function (_super) {\r\n    __extends(TopMenuMediator, _super);\r\n    function TopMenuMediator(scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.scene = scene;\r\n        return _this;\r\n        // this.mMenuPanel = new TopMenuContainer(scene, world);\r\n        // this.onAddIconHandler({ key: "Turn_Btn_Top", name: "SaveDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"], iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1 });\r\n    }\r\n    TopMenuMediator.prototype.show = function () {\r\n        this.register();\r\n    };\r\n    TopMenuMediator.prototype.hide = function () {\r\n        this.unregister();\r\n    };\r\n    TopMenuMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    TopMenuMediator.prototype.register = function () {\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].ADD_ICON_TO_TOP, this.onAddIconHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].REMOVE_ICON_FROM_TOP, this.onAddIconHandler, this);\r\n    };\r\n    TopMenuMediator.prototype.unregister = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].ADD_ICON_TO_TOP, this.onAddIconHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].REMOVE_ICON_FROM_TOP, this.onRemoveIcon, this);\r\n    };\r\n    TopMenuMediator.prototype.destroy = function () {\r\n        this.hide();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopMenuMediator.prototype.addItem = function (data) {\r\n        if (!this.mView) {\r\n            this.mView = new _top_menu_container__WEBPACK_IMPORTED_MODULE_2__["TopMenuContainer"](this.scene, this.world);\r\n            this.mView.on("saveDecorate", this.onSaveDecorateHandler, this);\r\n            this.mView.on("enterDecorate", this.onEnterDecorateHandler, this);\r\n        }\r\n        this.mView.addItem(data);\r\n    };\r\n    TopMenuMediator.prototype.removeItem = function (name) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.removeItem(name);\r\n    };\r\n    TopMenuMediator.prototype.onAddIconHandler = function (data) {\r\n        this.addItem(data);\r\n    };\r\n    TopMenuMediator.prototype.onRemoveIcon = function (name) {\r\n        this.removeItem(name);\r\n    };\r\n    TopMenuMediator.prototype.onSaveDecorateHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);\r\n        var content = packet.content;\r\n        content.needSaveEditScene = true;\r\n        this.world.connection.send(packet);\r\n    };\r\n    TopMenuMediator.prototype.onEnterDecorateHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n        this.world.connection.send(packet);\r\n    };\r\n    return TopMenuMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/top.menu/top.menu.mediator.ts?')},"./src/ui/baseView/topGroup/top.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopBtnGroup", function() { return TopBtnGroup; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../debuglog/debug.logger.mediator */ "./src/ui/debuglog/debug.logger.mediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopBtnGroup = /** @class */ (function (_super) {\r\n    __extends(TopBtnGroup, _super);\r\n    function TopBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        // private mWid: number = 0;\r\n        _this.mBtnPad = 10;\r\n        _this.mBtnX = 0;\r\n        _this.mExpandBoo = false;\r\n        _this.mOrientation = Phaser.Scale.Orientation.LANDSCAPE;\r\n        return _this;\r\n    }\r\n    TopBtnGroup.prototype.show = function (param) {\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    TopBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - 50 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    TopBtnGroup.prototype.destroy = function () {\r\n        this.mBtnX = 0;\r\n        if (this.mTurnBtn) {\r\n            this.mTurnBtn.destroy();\r\n        }\r\n        if (this.mReturnBtn) {\r\n            this.mReturnBtn.destroy();\r\n        }\r\n        if (this.mDebugBtn) {\r\n            this.mDebugBtn.destroy();\r\n        }\r\n        if (this.mBtnList) {\r\n            this.mBtnList.forEach(function (btn) {\r\n                if (btn) {\r\n                    btn.destroy();\r\n                    btn = null;\r\n                }\r\n            });\r\n        }\r\n        this.mResKey = "";\r\n        this.mBtnList = null;\r\n        this.mTurnBtn = null;\r\n        this.mReturnBtn = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopBtnGroup.prototype.tweenView = function (show) {\r\n        if (!this.mScene)\r\n            return;\r\n        var baseY = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        var toY = show === true ? baseY : baseY - 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    TopBtnGroup.prototype.addBtn = function (data) {\r\n        if (!this.mAddBtnDataList)\r\n            this.mAddBtnDataList = [];\r\n        if (!this.mInitialized) {\r\n            this.mAddBtnDataList.push(data);\r\n            return;\r\n        }\r\n        var btn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, data);\r\n        this.mBtnList.push(btn);\r\n        this.btnRefreshPos();\r\n    };\r\n    TopBtnGroup.prototype.removeBtn = function (key) {\r\n        if (this.mRemoveBtnKeyList)\r\n            this.mRemoveBtnKeyList = [];\r\n        if (!this.mInitialized) {\r\n            this.mRemoveBtnKeyList.push(key);\r\n            return;\r\n        }\r\n        for (var i = 0, len = this.mBtnList.length; i < len; i++) {\r\n            var btn = this.mBtnList[i];\r\n            if (!btn)\r\n                continue;\r\n            var btnKey = btn.getKey();\r\n            if (btnKey && btnKey === key) {\r\n                btn.destroy();\r\n                btn = null;\r\n                this.mBtnList.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n        this.btnRefreshPos();\r\n    };\r\n    TopBtnGroup.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.mScene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    TopBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        var hei = 0;\r\n        var wid = 0;\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        this.mBtnList = [];\r\n        this.mBtnX = 0;\r\n        this.mTurnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__["UIMediatorType"].Turn_Btn_Top, bgResKey: this.mResKey, bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mTurnBtn.x = this.mBtnX;\r\n        this.mTurnBtn.setPos(this.mBtnX, 0);\r\n        wid += this.mTurnBtn.width + this.mBtnPad;\r\n        this.add(this.mTurnBtn);\r\n        this.mBtnX += -this.mTurnBtn.width - this.mBtnPad;\r\n        hei += this.mTurnBtn.height / 2 + 20;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mReturnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__["UIMediatorType"].App_Back, bgResKey: this.mResKey, bgTextures: ["btnGroup_white_normal.png", "btnGroup_white_light.png", "btnGroup_white_select.png"],\r\n                iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n            });\r\n            this.mReturnBtn.x = this.mBtnX;\r\n            this.mReturnBtn.setPos(this.mBtnX, 0);\r\n            this.mBtnList.push(this.mReturnBtn);\r\n            wid += this.mReturnBtn.width + this.mBtnPad;\r\n            this.add(this.mReturnBtn);\r\n            this.mBtnX += -this.mReturnBtn.width - this.mBtnPad;\r\n            this.mDebugBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.mScene, this.mWorld, {\r\n                key: _debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_blue_normal.png", "btnGroup_blue_light.png", "btnGroup_blue_select.png"],\r\n                iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n            });\r\n            this.mDebugBtn.x = this.mBtnX;\r\n            this.mDebugBtn.setPos(this.mBtnX, 0);\r\n            this.mBtnList.push(this.mDebugBtn);\r\n            wid += this.mDebugBtn.width + this.mBtnPad;\r\n            this.add(this.mDebugBtn);\r\n            this.mReturnBtn.setClick(function () {\r\n                _this.mWorld.closeGame();\r\n            });\r\n            this.mDebugBtn.setClick(function () {\r\n                var debugLogMed = _this.mWorld.uiManager.getMediator(_debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME);\r\n                if (!debugLogMed) {\r\n                    _this.mWorld.uiManager.setMediator(_debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME, new _debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"](_this.mScene, _this.mWorld));\r\n                    debugLogMed = _this.mWorld.uiManager.getMediator(_debuglog_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME);\r\n                }\r\n                if (debugLogMed.isShow()) {\r\n                    debugLogMed.hide();\r\n                    return;\r\n                }\r\n                debugLogMed.show();\r\n            });\r\n        }\r\n        this.setSize(wid, hei);\r\n        this.mTurnBtn.setClick(function () {\r\n            _this.turnHandler();\r\n        });\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    TopBtnGroup.prototype.tweenComplete = function (show) {\r\n        var _this = this;\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show) {\r\n            if (this.mAddBtnDataList) {\r\n                this.mAddBtnDataList.forEach(function (btnData) {\r\n                    _this.addBtn(btnData);\r\n                });\r\n            }\r\n            if (this.mRemoveBtnKeyList) {\r\n                this.mRemoveBtnKeyList.forEach(function (key) {\r\n                    _this.removeBtn(key);\r\n                });\r\n            }\r\n        }\r\n    };\r\n    TopBtnGroup.prototype.turnHandler = function () {\r\n        var _this = this;\r\n        if (!this.mBtnList && this.mBtnList.length < 1) {\r\n            return;\r\n        }\r\n        var len = this.mBtnList.length;\r\n        var _loop_1 = function (i) {\r\n            var btn = this_1.mBtnList[i];\r\n            var toX = this_1.mExpandBoo ? btn.getPos().x : this_1.mTurnBtn.width >> 1;\r\n            var toAlpha = this_1.mExpandBoo ? 1 : 0;\r\n            var easeType = this_1.mExpandBoo ? "Sine.easeIn" : "Sine.easeOut";\r\n            this_1.mScene.tweens.add({\r\n                targets: btn,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    x: { value: toX },\r\n                    alpha: { value: toAlpha }\r\n                },\r\n                onComplete: function (tween, targets, ship) {\r\n                    if (i === len - 1) {\r\n                        _this.mExpandBoo = !_this.mExpandBoo;\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1]\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    TopBtnGroup.prototype.btnRefreshPos = function () {\r\n        var _this = this;\r\n        if (this.mBtnList && this.mBtnList.length > 1) {\r\n            this.mBtnX = -this.mTurnBtn.width - this.mBtnPad;\r\n            var hei = this.mTurnBtn.height / 2 + 20;\r\n            var wid_1 = 0;\r\n            this.mBtnList.forEach(function (btn) {\r\n                if (!btn)\r\n                    return;\r\n                btn.x = _this.mBtnX;\r\n                // btn.setBtnData({});\r\n                btn.setPos(_this.mBtnX, 0);\r\n                _this.mBtnX += -btn.width - _this.mBtnPad;\r\n                wid_1 += btn.width + _this.mBtnPad;\r\n                // btn.setClick(() => {\r\n                //     // todo connect\r\n                // });\r\n                _this.add(btn);\r\n            });\r\n            this.setSize(wid_1, hei);\r\n        }\r\n        this.resize();\r\n    };\r\n    return TopBtnGroup;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/topGroup/top.btn.group.ts?')},"./src/ui/baseView/topGroup/top.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMediator", function() { return TopMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _top_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./top.btn.group */ "./src/ui/baseView/topGroup/top.btn.group.ts");\n/* harmony import */ var _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../Rank/RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopMediator = /** @class */ (function (_super) {\r\n    __extends(TopMediator, _super);\r\n    function TopMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    TopMediator.prototype.preRefreshBtn = function (medName) {\r\n        if (!this.refreshMedList)\r\n            this.refreshMedList = [];\r\n        this.refreshMedList.push(medName);\r\n    };\r\n    TopMediator.prototype.refreshBtn = function (medName, addBoo) {\r\n        var _this = this;\r\n        var topBtnGroup = this.mView;\r\n        switch (medName) {\r\n            case _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_2__["RankMediator"].NAME:\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json", callBack: function () {\r\n                            var med = _this.world.uiManager.getMediator(medName);\r\n                            if (med) {\r\n                                // 该判断条件用于某些常驻界面ui在移动端需要手动打开，客户端将此逻辑修改为通过后端发送的showui数据将入口按钮变成是否常驻\r\n                                // 好处在于移动端客户端界面让玩家自行选择是否打开，减少ui布局混乱的情况\r\n                                var param = med.getParam();\r\n                                med.show(param);\r\n                            }\r\n                            else {\r\n                                // todo 该判断条件用于热发布活动，后端需要在pi中加一条活动按钮数据，不包含med具体代码，只有name，btnres等数据即可，等需要打开界面时在请求具体数据\r\n                                // 客户端只需要发送medname给后端，后端发送showui给客户端，好处在于每次打开都是请求后端打开界面，活动数据是实时的\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n            case "EnterDecorate":\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json", callBack: function () {\r\n                            _this.onEnterDecorate();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n            case "SaveDecorate":\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json", callBack: function () {\r\n                            _this.onEnterDecorate();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n    TopMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    TopMediator.prototype.show = function (param) {\r\n        var _this = this;\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _top_btn_group__WEBPACK_IMPORTED_MODULE_1__["TopBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n        if (this.refreshMedList) {\r\n            this.refreshMedList.forEach(function (medName) {\r\n                _this.refreshBtn(medName, true);\r\n            });\r\n        }\r\n    };\r\n    TopMediator.prototype.hide = function () {\r\n        var _this = this;\r\n        this.isShowing = false;\r\n        if (this.refreshMedList) {\r\n            this.refreshMedList.forEach(function (medName) {\r\n                _this.refreshBtn(medName, false);\r\n            });\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    TopMediator.prototype.addBtn = function (data) {\r\n        if (this.mView)\r\n            this.mView.addBtn(data);\r\n    };\r\n    TopMediator.prototype.onEnterDecorate = function () {\r\n        if (this.world && this.world.connection) {\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n            this.world.connection.send(packet);\r\n        }\r\n    };\r\n    TopMediator.prototype.onSaveDecorate = function () {\r\n        if (this.world && this.world.connection) {\r\n            // Alert.\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SAVE);\r\n            this.world.connection.send(packet);\r\n        }\r\n    };\r\n    TopMediator.NAME = "TopMediator";\r\n    return TopMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/topGroup/top.mediator.ts?')},"./src/ui/chat/base.chat.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseChatPanel", function() { return BaseChatPanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar BaseChatPanel = /** @class */ (function (_super) {\r\n    __extends(BaseChatPanel, _super);\r\n    function BaseChatPanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    BaseChatPanel.prototype.appendChat = function (val) {\r\n    };\r\n    BaseChatPanel.prototype.setLocation = function (x, y) {\r\n    };\r\n    BaseChatPanel.prototype.tweenView = function (show) {\r\n    };\r\n    Object.defineProperty(BaseChatPanel.prototype, "outChannel", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return BaseChatPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/base.chat.panel.ts?')},"./src/ui/chat/chat.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatMediator", function() { return ChatMediator; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _game_world__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../game/world */ "./src/game/world.ts");\n/* harmony import */ var _pc_chatPanel_pc__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pc/chatPanel.pc */ "./src/ui/chat/pc/chatPanel.pc.ts");\n/* harmony import */ var _mobile_chatPanel_mobile__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mobile/chatPanel.mobile */ "./src/ui/chat/mobile/chatPanel.mobile.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatMediator = /** @class */ (function (_super) {\r\n    __extends(ChatMediator, _super);\r\n    function ChatMediator(world, scene) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mInRoom = false;\r\n        _this.mAllMessage = [];\r\n        _this.mMaxMessageNum = 50;\r\n        _this.mAddWid = 0;\r\n        _this.mAddHei = 0;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mUIType = _this.world.game.device.os.desktop ? 1 /* BaseUIType */ : 2 /* NormalUIType */;\r\n        if (_this.world.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, _this.handleCharacterChat);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QCLOUD_GME_AUTHBUFFER, _this.handleQCLoudGME);\r\n        }\r\n        _this.world.emitter.on(_game_world__WEBPACK_IMPORTED_MODULE_3__["World"].SCALE_CHANGE, _this.scaleChange, _this);\r\n        return _this;\r\n    }\r\n    ChatMediator.prototype.setViewAdd = function (wid, hei) {\r\n        this.mAddWid = wid;\r\n        this.mAddHei = hei;\r\n    };\r\n    ChatMediator.prototype.getUIType = function () {\r\n        return this.mUIType;\r\n    };\r\n    ChatMediator.prototype.setUiScale = function (value) {\r\n        this.mChatPanel.scaleX = this.mChatPanel.scaleY = value;\r\n    };\r\n    ChatMediator.prototype.enterRoom = function () {\r\n        if (!this.room)\r\n            return;\r\n        if (!this.room.playerManager.actor)\r\n            return;\r\n        if (!this.mGMEApi)\r\n            return;\r\n        var playerID = this.room.playerManager.actor.id;\r\n        var roomID = this.room.id;\r\n        this.mGMEApi.EnterRoom(roomID.toString(), 1, this.mQCLoudAuth);\r\n        this.mInRoom = true;\r\n        this.sendVoiceRoomStatus(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.CurrentScene, roomID, pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].VoiceRoomStatus.InVoiceRoom);\r\n    };\r\n    ChatMediator.prototype.exitRoom = function () {\r\n        if (!this.mGMEApi)\r\n            return;\r\n        this.mGMEApi.EnableMic(false);\r\n        this.mGMEApi.ExitRoom();\r\n        this.mInRoom = false;\r\n        if (!this.room) {\r\n            return;\r\n        }\r\n        this.sendVoiceRoomStatus(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.CurrentScene, this.room.id, pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].VoiceRoomStatus.OutsideVoiceRoom);\r\n    };\r\n    ChatMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    ChatMediator.prototype.getView = function () {\r\n        return this.mChatPanel;\r\n    };\r\n    ChatMediator.prototype.isShow = function () {\r\n        if (!this.mChatPanel) {\r\n            return false;\r\n        }\r\n        return this.mChatPanel.isShow();\r\n    };\r\n    ChatMediator.prototype.tweenView = function (show) {\r\n        if (!this.mChatPanel)\r\n            return;\r\n        this.mChatPanel.tweenView(show);\r\n    };\r\n    ChatMediator.prototype.showing = function () {\r\n        return true;\r\n    };\r\n    ChatMediator.prototype.resize = function () {\r\n        if (this.mChatPanel) {\r\n            this.mChatPanel.setLocation();\r\n        }\r\n    };\r\n    ChatMediator.prototype.show = function (param) {\r\n        if (this.mChatPanel && this.mChatPanel.isShow()) {\r\n            return;\r\n        }\r\n        this.world.connection.removePacketListener(this);\r\n        this.world.connection.addPacketListener(this);\r\n        if (this.world.game.device.os.desktop) {\r\n            this.mChatPanel = new _pc_chatPanel_pc__WEBPACK_IMPORTED_MODULE_4__["ChatPanelPC"](this.mScene, this.world);\r\n        }\r\n        else {\r\n            this.mChatPanel = new _mobile_chatPanel_mobile__WEBPACK_IMPORTED_MODULE_5__["ChatPanelMobile"](this.mScene, this.world);\r\n            this.world.uiManager.checkUIState(ChatMediator.NAME, false);\r\n        }\r\n        this.world.uiManager.getUILayerManager().addToUILayer(this.mChatPanel);\r\n        this.mChatPanel.on("sendChat", this.onSendChatHandler, this);\r\n        this.mChatPanel.on("selectedVoice", this.onSelectedVoiceHandler, this);\r\n        this.mChatPanel.on("selectedMic", this.onSelectedMicHandler, this);\r\n        this.mChatPanel.show();\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    ChatMediator.prototype.update = function (param) {\r\n        this.mChatPanel.update(param);\r\n        this.mParam = param;\r\n    };\r\n    ChatMediator.prototype.hide = function () {\r\n        this.world.connection.removePacketListener(this);\r\n        this.mChatPanel.off("sendChat", this.onSendChatHandler, this);\r\n        this.mChatPanel.off("selectedVoice", this.onSelectedVoiceHandler, this);\r\n        this.mChatPanel.off("selectedMic", this.onSelectedMicHandler, this);\r\n        this.mChatPanel.hide();\r\n        this.mChatPanel = null;\r\n        if (!this.world.game.device.os.desktop)\r\n            this.world.uiManager.checkUIState(ChatMediator.NAME, true);\r\n    };\r\n    ChatMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    ChatMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    ChatMediator.prototype.destroy = function () {\r\n        if (this.mChatPanel) {\r\n            this.mChatPanel.destroy();\r\n            this.mChatPanel = null;\r\n        }\r\n        if (this.mGMEApi) {\r\n            this.mGMEApi = null;\r\n        }\r\n        this.world.emitter.off(_game_world__WEBPACK_IMPORTED_MODULE_3__["World"].SCALE_CHANGE, this.scaleChange, this);\r\n        this.mScene = null;\r\n        this.world = null;\r\n        this.mInRoom = false;\r\n        this.mQCLoudAuth = null;\r\n        this.mAllMessage.forEach(function (message) {\r\n            if (message)\r\n                message = null;\r\n        });\r\n        this.mAllMessage = null;\r\n    };\r\n    ChatMediator.prototype.scaleChange = function () {\r\n        this.setUiScale(this.world.uiScale);\r\n    };\r\n    ChatMediator.prototype.initGME = function () {\r\n        var _this = this;\r\n        // TODO just for test, need get sdkAppId from settings\r\n        var sdkAppId = "1400209172";\r\n        if (!this.room.playerManager.actor)\r\n            return;\r\n        var playerID = this.room.playerManager.actor.id;\r\n        this.mGMEApi = new WebGMEAPI();\r\n        this.mGMEApi.Init(document, sdkAppId, playerID.toString());\r\n        this.mGMEApi.SetTMGDelegate(function (event, result) {\r\n            switch (event) {\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ENTER_ROOM:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: EnterRoom: " + result);\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVNET_TYPE_USER_UPDATE:\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_EXIT_ROOM:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: ExitRoom");\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ROOM_DISCONNECT:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: Room Disconnect!!!");\r\n                    break;\r\n                default:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: Sth wrong...");\r\n                    break;\r\n            }\r\n        });\r\n    };\r\n    ChatMediator.prototype.appendMessage = function (messages, message) {\r\n        messages.push(message);\r\n        if (messages.length > this.mMaxMessageNum) {\r\n            messages.shift();\r\n        }\r\n    };\r\n    ChatMediator.prototype.changeMessageChannel = function () {\r\n        var _this = this;\r\n        if (!this.mChatPanel)\r\n            return;\r\n        var showMessages = this.mAllMessage.filter(function (msg) { return msg.channel === _this.mChatPanel.outChannel || msg.channel === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.System || _this.mChatPanel.outChannel === null; });\r\n        var len = showMessages.length;\r\n        var message = null;\r\n        var wrapStr = "\\n";\r\n        for (var i = 0; i < len; i++) {\r\n            message = showMessages[i];\r\n            if (i === len - 1)\r\n                wrapStr = "";\r\n            this.mChatPanel.appendChat(message.chat + wrapStr);\r\n        }\r\n    };\r\n    ChatMediator.prototype.handleCharacterChat = function (packet) {\r\n        var content = packet.content;\r\n        if (!this.world || !this.world.emitter || !this.room || !this.mChatPanel) {\r\n            return;\r\n        }\r\n        var playerManager = this.world.roomManager.currentRoom.playerManager;\r\n        if (!playerManager) {\r\n            return;\r\n        }\r\n        var player = playerManager.get(content.chatSenderid);\r\n        // const chatSendName = player ? player.name : "";\r\n        // this.mChatPanel.appendChat(content.chatContext);\r\n        var nickname = player ? player.model.nickname + ":" : "";\r\n        var color = content.chatSetting && content.chatSetting.textColor ? content.chatSetting.textColor : "#FFFFFF";\r\n        this.appendMessage(this.mAllMessage, { chat: "[color=" + color + "]" + nickname + ":" + content.chatContext + "[/color]", channel: content.chatChannel });\r\n        this.mChatPanel.appendChat("[b][color=" + color + "]" + nickname + content.chatContext + "[/color][/b]\\n");\r\n    };\r\n    ChatMediator.prototype.onSendChatHandler = function (text) {\r\n        if (this.world.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_GATEWAY_REQ_VIRTUAL_WORLD_CHAT);\r\n            var content = pkt.content;\r\n            content.chatChannel = 0;\r\n            content.chatContext = text;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    ChatMediator.prototype.sendVoiceRoomStatus = function (voiceChannel, voiceRoomId, voiceRoomStatus) {\r\n        if (!this.room.connection) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS);\r\n        var context = pkt.content;\r\n        context.voiceChannel = voiceChannel;\r\n        context.voiceRoomId = voiceRoomId;\r\n        context.voiceRoomStatus = voiceRoomStatus;\r\n        this.room.connection.send(pkt);\r\n    };\r\n    ChatMediator.prototype.handleQCLoudGME = function (packet) {\r\n        var authBuffer = packet.content;\r\n        this.mQCLoudAuth = authBuffer.signature;\r\n        this.initGME();\r\n    };\r\n    ChatMediator.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val) {\r\n            this.enterRoom();\r\n        }\r\n        else {\r\n            this.exitRoom();\r\n        }\r\n    };\r\n    ChatMediator.prototype.onSelectedMicHandler = function (val) {\r\n        if (!this.mGMEApi) {\r\n            return;\r\n        }\r\n        if (this.mInRoom) {\r\n            this.mGMEApi.EnableMic(val);\r\n        }\r\n        if (this.world.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"]((pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS));\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    Object.defineProperty(ChatMediator.prototype, "room", {\r\n        get: function () {\r\n            if (!this.world) {\r\n                return;\r\n            }\r\n            if (!this.world.roomManager) {\r\n                return;\r\n            }\r\n            return this.world.roomManager.currentRoom;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ChatMediator.NAME = "ChatMediator";\r\n    return ChatMediator;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/chat.mediator.ts?')},"./src/ui/chat/message.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/message.ts?")},"./src/ui/chat/mobile/chatPanel.mobile.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPanelMobile", function() { return ChatPanelMobile; });\n/* harmony import */ var _base_chat_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base.chat.panel */ "./src/ui/chat/base.chat.panel.ts");\n/* harmony import */ var _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/rexui/templates/ui/textarea/TextArea */ "./lib/rexui/templates/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatPanelMobile = /** @class */ (function (_super) {\r\n    __extends(ChatPanelMobile, _super);\r\n    function ChatPanelMobile(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ChatPanelMobile.prototype.appendChat = function (val) {\r\n        if (this.mTextArea) {\r\n            this.mTextArea.appendText(val);\r\n            this.mTextArea.scrollToBottom();\r\n        }\r\n    };\r\n    ChatPanelMobile.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.tweenView(true);\r\n    };\r\n    ChatPanelMobile.prototype.setLocation = function (x, y) {\r\n        if (!this.mShowing)\r\n            return;\r\n        // DefaultMask在TextBlock中，TextBlock是一个非渲染矩形游戏对象\r\n        var size = this.mWorld.getSize();\r\n        var track;\r\n        var thumb;\r\n        var text;\r\n        if (this.mTextArea) {\r\n            this.mTextArea.destroy();\r\n            this.mTextArea = null;\r\n            text = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n                fontSize: "20px",\r\n                wrap: {\r\n                    mode: "char",\r\n                    width: this.mWidth >> 1\r\n                },\r\n            });\r\n            track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.mScene, 0, 0, 4, 7, "track", "", "", {\r\n                left: 0,\r\n                top: 2,\r\n                right: 0,\r\n                bottom: 2\r\n            });\r\n            // track.x = this.mWidth / 2;\r\n            // track.y = 8 * this.mWorld.uiScale;\r\n            thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.mScene, 0, 0, 20, 35, "button", "", "", {\r\n                left: 4,\r\n                top: 4,\r\n                right: 4,\r\n                bottom: 4\r\n            });\r\n            this.add(text);\r\n            this.add(track);\r\n            this.add(thumb);\r\n        }\r\n        if (this.mInputText) {\r\n            this.mInputText.destroy();\r\n            this.mInputText = null;\r\n            this.mInputText = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__["default"](this.mScene, 0, 0, 10, 10, {\r\n                type: "input",\r\n                fontSize: "20px",\r\n                color: "#808080"\r\n            })\r\n                .resize(328, 26)\r\n                .setOrigin(0, 0)\r\n                .setStyle({ font: "bold 20px YaHei" })\r\n                .on("focus", this.onFocusHandler, this)\r\n                .on("blur", this.onBlurHandler, this);\r\n        }\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.mWidth = size.width >> 1;\r\n            this.mHeight = size.height;\r\n            this.mBorder.resize(this.mWidth / this.mWorld.uiScale, this.mHeight / this.mWorld.uiScale);\r\n            this.x = 0;\r\n            this.y = 0;\r\n            this.clickContainer.x = this.mWidth / this.mWorld.uiScale + this.clickContainer.width / 2;\r\n            this.clickContainer.y = this.mHeight / (this.mWorld.uiScale * 2);\r\n            this.clickContainer.rotation = Math.PI * .5;\r\n            this.arrow.rotation = Math.PI * .5;\r\n            this.mInputBg.y = this.mBorder.height - this.mInputBg.height / 2;\r\n            this.mTextArea = new _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, {\r\n                x: this.mWidth * .5 / this.mWorld.uiScale,\r\n                y: this.mHeight / 2,\r\n                textWidth: this.mBorder.width - 20 * this.mWorld.uiScale,\r\n                textHeight: this.mHeight,\r\n                text: text,\r\n                slider: {\r\n                    track: track,\r\n                    thumb: thumb,\r\n                },\r\n                clamplChildOY: true,\r\n            });\r\n            this.mInputText.setPosition(2, this.mInputBg.y - 12 * this.mWorld.uiScale);\r\n        }\r\n        else {\r\n            this.mWidth = size.width;\r\n            this.mHeight = size.height / 2;\r\n            this.mBorder.resize(this.mWidth / this.mWorld.uiScale, this.mHeight / this.mWorld.uiScale);\r\n            this.x = 0;\r\n            this.y = this.mHeight + 20 * this.mWorld.uiScale;\r\n            this.mInputBg.y = this.mBorder.height - this.mInputBg.height;\r\n            this.mTextArea = new _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, {\r\n                x: (this.mWidth - 15) / this.mWorld.uiScale >> 1,\r\n                y: (size.height / 2 - this.mSendBtn.height - 20) / this.mWorld.uiScale >> 1,\r\n                textWidth: this.mBorder.width - 20 * this.mWorld.uiScale,\r\n                textHeight: (size.height / 2 - this.mSendBtn.height - 20) / this.mWorld.uiScale,\r\n                text: text,\r\n                slider: {\r\n                    track: track,\r\n                    thumb: thumb,\r\n                },\r\n                scroller: {\r\n                    bounds: [0, this.mHeight >> 1],\r\n                },\r\n                clamplChildOY: true,\r\n                backDeceleration: true,\r\n            });\r\n            // this.mTextArea.x = this.mTextArea.childrenMap.child.minWidth >> 1;\r\n            // this.mTextArea.y = this.mTextArea.childrenMap.child.minHeight >> 1;\r\n            this.clickContainer.x = size.width / (this.mWorld.uiScale * 2);\r\n            this.clickContainer.y = -this.clickContainer.height >> 1;\r\n            var silder = this.mTextArea.getElement("slider");\r\n            silder.y = this.mHeight >> 1;\r\n            this.clickContainer.rotation = Math.PI;\r\n            this.arrow.rotation = Math.PI * 1.5;\r\n            this.mInputText.setPosition(2, this.mInputBg.y - 6 * this.mWorld.uiScale);\r\n        }\r\n        this.mTextArea.layout();\r\n        this.add(this.mTextArea);\r\n        this.mTextArea.childrenMap.child.textMask.setPosition(-5, size.height - this.height).resize(this.width + 18, this.height - this.mSendBtn.height);\r\n        // this.mBorder = new NinePatch(this.scene, 0, 0, this.mWidth / this.mWorld.uiScale, this.mHeight / this.mWorld.uiScale, Border.getName(), null, Border.getConfig());\r\n        this.mBorder.x = this.mBorder.width / 2;\r\n        this.mBorder.y = this.mBorder.height / 2;\r\n        this.setSize(this.mWidth, this.mHeight);\r\n        // this.mTextArea.x = this.mBorder.width + 100 * this.mWorld.uiScale >> 1;\r\n        this.mInputBg.x = this.mInputBg.width >> 1;\r\n        this.mSendBtn.x = this.mBorder.width - this.mSendBtn.width;\r\n        this.mSendBtn.y = this.mInputBg.y;\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        this.add(this.mInputText);\r\n    };\r\n    ChatPanelMobile.prototype.destroy = function () {\r\n        if (this.mSendBtn)\r\n            this.mSendBtn.destroy(true);\r\n        if (this.mInputBg)\r\n            this.mInputBg.destroy(true);\r\n        if (this.clickContainer)\r\n            this.clickContainer.destroy(true);\r\n        if (this.arrow)\r\n            this.arrow.destroy(true);\r\n        if (this.mBorder)\r\n            this.mBorder.destroy(true);\r\n        if (this.mTextArea)\r\n            this.mTextArea.destroy();\r\n        if (this.mInputText)\r\n            this.mInputText.destroy();\r\n        this.mTextArea = null;\r\n        this.mInputText = null;\r\n        this.mSendBtn = null;\r\n        this.clickContainer = null;\r\n        this.arrow = null;\r\n        this.mBorder = null;\r\n        this.mInputBg = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.tweenView = function (show) {\r\n        var _this = this;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                alpha: { value: toAlpha },\r\n            },\r\n            onComplete: function (tween, targets, ship) {\r\n                if (!show)\r\n                    _this.hide();\r\n            },\r\n        });\r\n        if (show)\r\n            this.setLocation();\r\n    };\r\n    ChatPanelMobile.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/button.png"));\r\n        this.mScene.load.image("thumbTexture", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_thumb_texture.png"));\r\n        this.mScene.load.image("track", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_track.png"));\r\n        this.mScene.load.image("channelSelect", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_channelSelect.png"));\r\n        this.mScene.load.image("channelUnSelect", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_channelUnSelect.png"));\r\n        this.mScene.load.image("arrow", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_arrow.png"));\r\n        this.mScene.load.image("chat_input_bg", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/input_bg.png"));\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getPNG());\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getJSON());\r\n        this.mScene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.mWidth = size.width >> 1;\r\n            this.mHeight = size.height;\r\n        }\r\n        else {\r\n            this.mWidth = size.width;\r\n            this.mHeight = size.height >> 1;\r\n        }\r\n        this.setSize(this.mWidth, this.mHeight);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.mWidth / this.mWorld.uiScale, this.mHeight / this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.mBorder.x = this.mBorder.width / 2;\r\n        this.mBorder.y = this.mBorder.height / 2;\r\n        this.addAt(this.mBorder, 0);\r\n        var text = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.mWidth >> 1\r\n            },\r\n        });\r\n        var track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.mScene, 0, 0, 4, 7, "track", "", "", {\r\n            left: 0,\r\n            top: 2,\r\n            right: 0,\r\n            bottom: 2\r\n        });\r\n        track.x = this.mWidth / 2;\r\n        track.y = 8 * this.mWorld.uiScale;\r\n        var thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.mScene, 0, 0, 20, 35, "button", "", "", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        this.add(text);\r\n        this.add(track);\r\n        this.add(thumb);\r\n        this.mTextArea = new _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, {\r\n            x: this.mWidth >> 1,\r\n            y: this.mHeight + 178 * this.mWorld.uiScale >> 1,\r\n            textWidth: this.mWidth,\r\n            textHeight: this.mHeight + 150 * this.mWorld.uiScale,\r\n            text: text,\r\n            slider: {\r\n                track: track,\r\n                thumb: thumb,\r\n            },\r\n        })\r\n            .layout();\r\n        this.add(this.mTextArea);\r\n        this.mInputBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 340, 30, "chat_input_bg", null, { left: 4, top: 4, right: 4, bottom: 4 });\r\n        this.add(this.mInputBg);\r\n        this.mInputText = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__["default"](this.mScene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "20px",\r\n            color: "#808080"\r\n        })\r\n            .resize(328, 26)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 20px YaHei" })\r\n            .on("focus", this.onFocusHandler, this)\r\n            .on("blur", this.onBlurHandler, this);\r\n        this.mSendBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.mScene, 0, 0, 60, 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getName(), "", "发送", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getConfig());\r\n        this.mSendBtn.on("pointerdown", this.onSendMsgHandler, this);\r\n        this.add(this.mSendBtn);\r\n        this.clickContainer = this.mScene.make.container(undefined, false);\r\n        var btnBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 53 / this.mWorld.uiScale, 30 / this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.arrow = this.mScene.make.image(undefined, false);\r\n        this.arrow.setTexture("arrow");\r\n        this.clickContainer.setSize(btnBg.width + 4, btnBg.height + 10);\r\n        this.clickContainer.add(btnBg);\r\n        this.clickContainer.add(this.arrow);\r\n        this.clickContainer.setInteractive();\r\n        this.clickContainer.on("pointerdown", this.clickHandler, this);\r\n        this.add(this.clickContainer);\r\n        this.add(this.mInputText);\r\n        this.setLocation();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.clickHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this.clickContainer,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.clickContainer.scaleX = this.clickContainer.scaleY = 1;\r\n        this.tweenView(false);\r\n        this.mWorld.uiManager.baseFaceTween(true);\r\n    };\r\n    ChatPanelMobile.prototype.onSendMsgHandler = function () {\r\n        var text = this.mInputText.text;\r\n        if (text.length > 0) {\r\n            this.emit("sendChat", text);\r\n            this.mInputText.setText("");\r\n            this.mInputText.setBlur();\r\n        }\r\n        // // =====================tween out/in baseView\r\n        // const baseViewMed: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // if (baseViewMed) {\r\n        //     baseViewMed.tweenView(true);\r\n        // }\r\n    };\r\n    ChatPanelMobile.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n    };\r\n    ChatPanelMobile.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = true;\r\n    };\r\n    return ChatPanelMobile;\r\n}(_base_chat_panel__WEBPACK_IMPORTED_MODULE_0__["BaseChatPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/mobile/chatPanel.mobile.ts?')},"./src/ui/chat/pc/chatPanel.pc.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPanelPC", function() { return ChatPanelPC; });\n/* harmony import */ var _lib_rexui_plugins_gameobjects_shape_roundrectangle_RoundRectangle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/shape/roundrectangle/RoundRectangle */ "./lib/rexui/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js");\n/* harmony import */ var _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/rexui/templates/ui/textarea/TextArea */ "./lib/rexui/templates/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_check_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/check.button */ "./src/ui/components/check.button.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _base_chat_panel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../base.chat.panel */ "./src/ui/chat/base.chat.panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatPanelPC = /** @class */ (function (_super) {\r\n    __extends(ChatPanelPC, _super);\r\n    function ChatPanelPC(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mPreHei = 0;\r\n        _this.mPreWid = 0;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ChatPanelPC.prototype.appendChat = function (val) {\r\n        if (this.mTextArea) {\r\n            this.mTextArea.appendText(val);\r\n            this.mTextArea.scrollToBottom();\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.tweenView = function (show) {\r\n        if (!this.mScene)\r\n            return;\r\n        var baseX = 0;\r\n        var toX = show === true ? baseX : baseX - 200;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    ChatPanelPC.prototype.setLocation = function (x, y) {\r\n        // DefaultMask在TextBlock中，TextBlock是一个非渲染矩形游戏对象\r\n        var size = this.mWorld.getSize();\r\n        this.x = 0;\r\n        this.y = size.height - this.mPreHei;\r\n        if (this.mTextArea) {\r\n            // 每次resize更新textBlock中的textMask的位置\r\n            this.mTextArea.childrenMap.child.textMask.setPosition(undefined, size.height - this.height + 30).resize();\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.destroy = function () {\r\n        if (this.mTextArea)\r\n            this.mTextArea.destroy();\r\n        if (this.mInputText)\r\n            this.mInputText.destroy();\r\n        if (this.mVoiceBtn)\r\n            this.mVoiceBtn.destroy();\r\n        if (this.mMicBtn)\r\n            this.mMicBtn.destroy();\r\n        this.mTextArea = null;\r\n        this.mInputText = null;\r\n        this.mVoiceBtn = null;\r\n        this.mMicBtn = null;\r\n        this.mSendKey = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ChatPanelPC.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/button.png"));\r\n        this.mScene.load.image("thumbTexture", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/common_thumb_texture.png"));\r\n        this.mScene.load.image("track", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/common_track.png"));\r\n        this.mScene.load.image("chat_input_bg", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/input_bg.png"));\r\n        // this.mScene.load.image("chat_border_bg", Url.getRes("ui/chat/bg.png"));\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getPNG());\r\n        this.mScene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ChatPanelPC.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        _super.prototype.init.call(this);\r\n        var size = this.mWorld.getSize();\r\n        this.mWidth = 464;\r\n        this.mHeight = 281;\r\n        this.mPreHei = size.height;\r\n        this.mPreWid = size.width;\r\n        this.setSize(this.mWidth, this.mHeight);\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__["NinePatch"](this.scene, 0, 0, this.width, this.height, _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getConfig());\r\n        border.x = 4 * this.mWorld.uiScale + border.width * border.originX;\r\n        border.y = size.height - 260 * this.mWorld.uiScale + border.height * border.originY;\r\n        this.add(border);\r\n        this.outPut = this.mScene.make.container(undefined, false);\r\n        this.add(this.outPut);\r\n        var background = new _lib_rexui_plugins_gameobjects_shape_roundrectangle_RoundRectangle__WEBPACK_IMPORTED_MODULE_0__["default"](this.mScene, 0, 0, 2, 2, 3, 0x808080, 0.5);\r\n        this.outPut.add(background);\r\n        var track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, 4, 7, "track", "", "", {\r\n            left: 0,\r\n            top: 2,\r\n            right: 0,\r\n            bottom: 2\r\n        });\r\n        track.x = 100 * this.mWorld.uiScale;\r\n        track.y = 10 * this.mWorld.uiScale;\r\n        this.outPut.add(track);\r\n        var text = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_6__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "14px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: 400 * this.mWorld.uiScale\r\n            },\r\n        });\r\n        this.outPut.add(text);\r\n        var thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, 20, 35, "button", "", "", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        // const indicator = new NinePatchButton(this.mScene, 0, 0, 8, 10, "thumbTexture", "", {\r\n        //     left: 0,\r\n        //     top: 0,\r\n        //     right: 0,\r\n        //     bottom: 0\r\n        // });\r\n        this.outPut.add(thumb);\r\n        // this.outPut.add(indicator);\r\n        this.mTextArea = new _lib_rexui_templates_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, {\r\n            x: 230 * this.mWorld.uiScale,\r\n            y: size.height - 150 * this.mWorld.uiScale,\r\n            textWidth: 430,\r\n            textHeight: 200,\r\n            text: text,\r\n            slider: {\r\n                track: track,\r\n                // indicator,\r\n                thumb: thumb,\r\n            },\r\n        })\r\n            .layout();\r\n        this.outPut.add(this.mTextArea);\r\n        var tracks = this.mTextArea.getElement("child");\r\n        if (tracks) {\r\n            // tracks.x += 150;\r\n        }\r\n        var inputContainer = this.mScene.make.container(undefined, false);\r\n        this.add(inputContainer);\r\n        var inputBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__["NinePatch"](this.scene, 0, 0, 370, 32, "chat_input_bg", null, { left: 4, top: 4, right: 4, bottom: 4 });\r\n        inputBg.x = 8 * this.mWorld.uiScale + inputBg.width * inputBg.originX;\r\n        inputBg.y = size.height - 46 * this.mWorld.uiScale + inputBg.height * inputBg.originY;\r\n        inputContainer.add(inputBg);\r\n        this.mInputText = new _lib_rexui_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__["default"](this.mScene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080"\r\n        })\r\n            .resize(360, 20)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 16px YaHei" })\r\n            .on("focus", this.onFocusHandler, this)\r\n            .on("blur", this.onBlurHandler, this);\r\n        this.mInputText.x = 12 * this.mWorld.uiScale;\r\n        this.mInputText.y = size.height - 40 * this.mWorld.uiScale;\r\n        inputContainer.add(this.mInputText);\r\n        var sendMsgBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, 60, 30, "button", "", "发送", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        sendMsgBtn.x = this.width - sendMsgBtn.width + 10 * this.mWorld.uiScale;\r\n        sendMsgBtn.y = size.height - sendMsgBtn.height;\r\n        sendMsgBtn.on("pointerdown", this.onSendMsgHandler, this);\r\n        this.add(sendMsgBtn);\r\n        this.mSendKey = this.mScene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER);\r\n        this.mVoiceBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.mScene, 0, 0, "chat_atlas", "voice_normal.png", "voice_selected.png");\r\n        this.mVoiceBtn.x = this.width - 60 * this.mWorld.uiScale;\r\n        this.mVoiceBtn.y = size.height - this.height;\r\n        this.add(this.mVoiceBtn);\r\n        this.mMicBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.mScene, 0, 0, "chat_atlas", "mic_normal.png", "mic_selected.png");\r\n        this.mMicBtn.x = this.width - 20 * this.mWorld.uiScale;\r\n        this.mMicBtn.y = size.height - this.height;\r\n        this.add(this.mMicBtn);\r\n        this.mVoiceBtn.on("selected", this.onSelectedVoiceHandler, this);\r\n        this.mMicBtn.on("selected", this.onSelectedMicHandler, this);\r\n        this.setLocation();\r\n    };\r\n    ChatPanelPC.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val === false) {\r\n            this.mMicBtn.selected = false;\r\n        }\r\n        this.emit("selectedVoice", val);\r\n    };\r\n    ChatPanelPC.prototype.onSelectedMicHandler = function (val) {\r\n        if (this.mVoiceBtn.selected === false) {\r\n            this.mMicBtn.selected = false;\r\n            return;\r\n        }\r\n        this.mMicBtn.selected = val;\r\n        this.emit("selectedMic", val);\r\n    };\r\n    ChatPanelPC.prototype.onSendMsgHandler = function () {\r\n        var text = this.mInputText.text;\r\n        if (text.length > 0) {\r\n            this.emit("sendChat", text);\r\n            this.mInputText.setText("");\r\n            this.mInputText.setBlur();\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n        if (this.mSendKey) {\r\n            this.mSendKey.on("down", this.onDownEnter, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = true;\r\n        if (this.mSendKey) {\r\n            this.mSendKey.off("down", this.onDownEnter, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onDownEnter = function () {\r\n        this.onSendMsgHandler();\r\n    };\r\n    Object.defineProperty(ChatPanelPC.prototype, "outChannel", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return ChatPanelPC;\r\n}(_base_chat_panel__WEBPACK_IMPORTED_MODULE_8__["BaseChatPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/pc/chatPanel.pc.ts?')},"./src/ui/components/check.button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CheckButton", function() { return CheckButton; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar CheckButton = /** @class */ (function (_super) {\r\n    __extends(CheckButton, _super);\r\n    function CheckButton(scene, x, y, key, normalFrames, selectFrame) {\r\n        var _this = _super.call(this, scene, x, y, key, normalFrames) || this;\r\n        _this.mSelected = false;\r\n        _this.mNormalFrame = normalFrames;\r\n        _this.mSelectFrame = selectFrame;\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, _this.width, _this.height), Phaser.Geom.Rectangle.Contains);\r\n        _this.on("pointerup", _this.onSelected, _this);\r\n        return _this;\r\n    }\r\n    CheckButton.prototype.onSelected = function () {\r\n        this.selected = !this.mSelected;\r\n        this.emit("selected", this.mSelected);\r\n    };\r\n    Object.defineProperty(CheckButton.prototype, "selected", {\r\n        get: function () {\r\n            return this.mSelected;\r\n        },\r\n        set: function (val) {\r\n            if (this.mSelected !== val) {\r\n                this.mSelected = val;\r\n                var frame = val ? this.mSelectFrame : this.mNormalFrame;\r\n                this.setFrame(frame);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return CheckButton;\r\n}(Phaser.GameObjects.Image));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/check.button.ts?')},"./src/ui/components/checkbox.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CheckboxGroup", function() { return CheckboxGroup; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar CheckboxGroup = /** @class */ (function (_super) {\r\n    __extends(CheckboxGroup, _super);\r\n    function CheckboxGroup() {\r\n        var _this = _super.call(this) || this;\r\n        _this.mList = [];\r\n        return _this;\r\n    }\r\n    CheckboxGroup.prototype.appendItem = function (item) {\r\n        this.mList.push(item);\r\n        item.on("click", this.onGameObjectUpHandler, this);\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.appendItemAll = function (items) {\r\n        this.mList = this.mList.concat(items);\r\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n            var item = items_1[_i];\r\n            item.on("click", this.onGameObjectUpHandler, this);\r\n        }\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.removeItem = function (item) {\r\n        this.mList = this.mList.filter(function (button) { return button !== item; });\r\n        item.off("click", this.onGameObjectUpHandler, this);\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.selectIndex = function (index) {\r\n        if (index < 0) {\r\n            index = 0;\r\n        }\r\n        if (index >= this.mList.length) {\r\n            index = this.mList.length - 1;\r\n        }\r\n        this.select(this.mList[index]);\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.select = function (item) {\r\n        if (this.mPrevButton) {\r\n            // this.mPrevButton\r\n        }\r\n        this.emit("selected", item);\r\n    };\r\n    CheckboxGroup.prototype.onGameObjectUpHandler = function (pointer, gameobject) {\r\n        if (this.mPrevButton) {\r\n            // this.mPrevButton.setFrame("")\r\n        }\r\n        this.select(gameobject);\r\n    };\r\n    return CheckboxGroup;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/checkbox.group.ts?')},"./src/ui/components/comboBox.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComboBox", function() { return ComboBox; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectCallItem", function() { return SelectCallItem; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar ComboBox = /** @class */ (function (_super) {\r\n    __extends(ComboBox, _super);\r\n    function ComboBox(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mIsopen = false;\r\n        _this.mInitialize = false;\r\n        _this.mScene = scene;\r\n        _this.mConfig = config;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    ComboBox.prototype.selectCall = function (itemData) {\r\n        this.mtxt.text = itemData.text;\r\n        this.mtxt.x = this.mConfig.wid - this.mtxt.width >> 1;\r\n        this.mtxt.y = this.mConfig.hei - this.mtxt.height >> 1;\r\n        this.showTween(false);\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    Object.defineProperty(ComboBox.prototype, "text", {\r\n        set: function (value) {\r\n            if (!this.mInitialize) {\r\n                this.mData = this.itemList[0].itemData;\r\n                return;\r\n            }\r\n            if (this.itemList) {\r\n                var itemLen = this.itemList.length;\r\n                for (var i = 0; i < itemLen; i++) {\r\n                    var item = this.itemList[i];\r\n                    if (!item)\r\n                        continue;\r\n                    item.destroy();\r\n                    item = null;\r\n                }\r\n                this.itemList.length = 0;\r\n            }\r\n            this.itemList = [];\r\n            var len = value.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = new SelectCallItem(this.mScene, this, this.mConfig.wid, this.mConfig.hei);\r\n                var str = value[i];\r\n                item.itemData = {\r\n                    index: i,\r\n                    text: str,\r\n                    data: {},\r\n                };\r\n                this.itemList.push(item);\r\n            }\r\n            // 默認顯示第0個\r\n            this.selectCall(this.itemList[0].itemData);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ComboBox.prototype.destroy = function () {\r\n        if (this.itemList) {\r\n            var len = this.itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n            }\r\n            this.itemList.length = 0;\r\n            this.itemList = null;\r\n        }\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    ComboBox.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        this.mInitialize = false;\r\n        if (!this.mScene.textures.exists(resKey)) {\r\n            this.mScene.load.atlas(resKey, resPng, resJson);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    ComboBox.prototype.onLoadCompleteHandler = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        this.mBg = this.mScene.make.image(undefined, false);\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.mBg.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        this.mArrow = this.mScene.make.image(undefined, false);\r\n        this.mArrow.setTexture(resKey, this.mConfig.resArrow);\r\n        this.mArrow.scaleY = this.mConfig.up ? -1 : 1;\r\n        this.mArrow.x = this.mConfig.wid - this.mArrow.width;\r\n        this.mArrow.y = (this.mConfig.hei - this.mArrow.height >> 1) + 4;\r\n        this.mtxt = this.mScene.make.text({\r\n            x: 0, y: 0,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        this.add(this.mBg);\r\n        this.add(this.mArrow);\r\n        this.add(this.mtxt);\r\n        this.mBg.setInteractive();\r\n        this.mBg.on("pointerdown", this.openHandler, this);\r\n        this.mInitialize = true;\r\n        if (this.mData) {\r\n            this.selectCall(this.mData);\r\n        }\r\n    };\r\n    ComboBox.prototype.openHandler = function () {\r\n        if (!this.itemList || this.itemList.length < 1)\r\n            return;\r\n        this.showTween(this.mIsopen);\r\n    };\r\n    ComboBox.prototype.showTween = function (open) {\r\n        if (open) {\r\n            this.mItemBG = this.createTexture();\r\n            this.addAt(this.mItemBG, 0);\r\n        }\r\n        else {\r\n            if (this.mItemBG) {\r\n                if (this.mItemBG.parentContainer) {\r\n                    this.mItemBG.parentContainer.remove(this.mItemBG);\r\n                }\r\n                this.mItemBG.destroy();\r\n            }\r\n        }\r\n        this.mArrow.scaleY = open ? 1 : -1;\r\n        this.showTweenItem(open);\r\n        this.mIsopen = !this.mIsopen;\r\n    };\r\n    ComboBox.prototype.showTweenItem = function (open) {\r\n        var _this = this;\r\n        var len = this.itemList.length;\r\n        var _loop_1 = function (i) {\r\n            var item = this_1.itemList[i];\r\n            if (!item) {\r\n                return "continue";\r\n            }\r\n            item.x = this_1.mConfig.wid >> 1;\r\n            this_1.add(item);\r\n            this_1.mScene.tweens.add({\r\n                targets: item,\r\n                duration: 50 * i,\r\n                props: {\r\n                    y: { value: open ? -this_1.mConfig.hei * i - this_1.mConfig.hei / 2 : -this_1.mConfig.hei >> 1 },\r\n                    alpha: { value: open ? 1 : 0 }\r\n                },\r\n                onComplete: function (tween, targets, element) {\r\n                    if (!open) {\r\n                        _this.remove(item);\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1],\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    ComboBox.prototype.createTexture = function () {\r\n        var COLOR = 0x3D3838;\r\n        var height = this.mConfig.hei * this.itemList.length;\r\n        var bgGraphics = this.mScene.make.graphics(undefined, false);\r\n        bgGraphics.fillStyle(COLOR, .8);\r\n        bgGraphics.fillRect(0, -height, this.mConfig.wid, height);\r\n        return bgGraphics;\r\n    };\r\n    return ComboBox;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar SelectCallItem = /** @class */ (function (_super) {\r\n    __extends(SelectCallItem, _super);\r\n    function SelectCallItem(scene, selectCallUI, wid, hei) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mSelectCallUI = selectCallUI;\r\n        _this.mText = _this.scene.make.text({\r\n            x: -wid >> 1, y: -hei >> 1,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        var COLOR = 0xffcc00;\r\n        _this.mSelectBG = scene.make.graphics(undefined, false);\r\n        _this.mSelectBG.fillStyle(COLOR, .8);\r\n        _this.mSelectBG.fillRect(-wid >> 1, -hei >> 1, wid, hei);\r\n        _this.mSelectBG.visible = false;\r\n        _this.addAt(_this.mSelectBG, 0);\r\n        _this.add(_this.mText);\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive();\r\n        _this.on("pointerover", _this.overHandler, _this);\r\n        _this.on("pointerout", _this.outHandler, _this);\r\n        _this.on("pointerdown", _this.selectHandler, _this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SelectCallItem.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mData;\r\n        },\r\n        set: function (val) {\r\n            this.mData = val;\r\n            this.mText.text = this.mData.text;\r\n            this.mText.x = -this.width / 2 + (this.width - this.mText.width >> 1);\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    SelectCallItem.prototype.destroy = function () {\r\n        this.mText.destroy(true);\r\n        this.mSelectBG.destroy(true);\r\n        this.mData = null;\r\n        this.mText = null;\r\n        this.mSelectBG = null;\r\n        this.mSelectCallUI = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    SelectCallItem.prototype.setSelected = function (val) {\r\n        this.mSelectBG.visible = val;\r\n    };\r\n    SelectCallItem.prototype.overHandler = function () {\r\n        this.mSelectBG.visible = true;\r\n    };\r\n    SelectCallItem.prototype.selectHandler = function () {\r\n        this.overHandler();\r\n        this.mSelectCallUI.selectCall(this.itemData);\r\n    };\r\n    SelectCallItem.prototype.outHandler = function () {\r\n        this.mSelectBG.visible = false;\r\n    };\r\n    return SelectCallItem;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/comboBox.ts?')},"./src/ui/components/dynamic.image.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicImage", function() { return DynamicImage; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar DynamicImage = /** @class */ (function (_super) {\r\n    __extends(DynamicImage, _super);\r\n    function DynamicImage(scene, x, y) {\r\n        return _super.call(this, scene, x, y, undefined) || this;\r\n    }\r\n    DynamicImage.prototype.load = function (value, loadContext, completeCallBack, errorCallBack) {\r\n        this.mLoadCompleteCallbak = completeCallBack;\r\n        this.mLoadErrorCallback = errorCallBack;\r\n        this.mLoadContext = loadContext;\r\n        this.mUrl = value;\r\n        if (this.scene.cache.obj.exists(value)) {\r\n            this.onLoadComplete();\r\n        }\r\n        else {\r\n            this.scene.load.image(value, value);\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    DynamicImage.prototype.onLoadComplete = function () {\r\n        this.setTexture(this.mUrl);\r\n        if (this.mLoadCompleteCallbak) {\r\n            var cb = this.mLoadCompleteCallbak;\r\n            this.mLoadCompleteCallbak = null;\r\n            cb.call(this.mLoadContext);\r\n            this.mLoadContext = null;\r\n        }\r\n    };\r\n    DynamicImage.prototype.onLoadError = function (file) {\r\n        if (this.mUrl === file.url) {\r\n            if (this.mLoadErrorCallback) {\r\n                var cb = this.mLoadErrorCallback;\r\n                this.mLoadErrorCallback = null;\r\n                cb.call(this.mLoadContext);\r\n                this.mLoadContext = null;\r\n            }\r\n        }\r\n    };\r\n    return DynamicImage;\r\n}(Phaser.GameObjects.Image));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.image.ts?')},"./src/ui/components/dynamic.ninepatch.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicNinepatch", function() { return DynamicNinepatch; });\n/* harmony import */ var _lib_rexui_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/ninepatch/NinePatch */ "./lib/rexui/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\nvar DynamicNinepatch = /** @class */ (function () {\r\n    function DynamicNinepatch(mScene, mParent) {\r\n        this.mScene = mScene;\r\n        this.mParent = mParent;\r\n    }\r\n    DynamicNinepatch.prototype.load = function (value, config, completeCallBack, loadContext) {\r\n        this.mLoadCompleteCallBack = completeCallBack;\r\n        this.mLoadContext = loadContext;\r\n        this.mConfig = config;\r\n        this.mUrl = value;\r\n        if (this.mScene.cache.obj.get(value)) {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n        else {\r\n            this.mScene.load.image(this.mUrl, this.mUrl);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n    };\r\n    DynamicNinepatch.prototype.onLoadCompleteHandler = function () {\r\n        this.mImage = new _lib_rexui_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_0__["default"](this.mScene, this.mConfig);\r\n        if (this.mLoadCompleteCallBack) {\r\n            this.mLoadCompleteCallBack.call(this.mLoadContext, this.mImage);\r\n            this.mLoadCompleteCallBack = null;\r\n            this.mLoadContext = null;\r\n        }\r\n    };\r\n    Object.defineProperty(DynamicNinepatch.prototype, "image", {\r\n        get: function () {\r\n            return this.mImage;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DynamicNinepatch;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.ninepatch.ts?')},"./src/ui/components/dynamic.sprite.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicSprite", function() { return DynamicSprite; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar DynamicSprite = /** @class */ (function (_super) {\r\n    __extends(DynamicSprite, _super);\r\n    function DynamicSprite(scene, x, y) {\r\n        var _this = _super.call(this, scene, x, y, undefined) || this;\r\n        // TODO updateList.add在3.20的ts def中被移除\r\n        scene.sys.updateList.add(_this);\r\n        return _this;\r\n    }\r\n    DynamicSprite.prototype.load = function (textureURL, atlasURL, loadContext, completeCallBack, errorCallBack) {\r\n        this.mLoadCompleteCallbak = completeCallBack;\r\n        this.mLoadErrorCallback = errorCallBack;\r\n        this.mLoadContext = loadContext;\r\n        this.mUrl = textureURL + atlasURL;\r\n        if (this.scene.cache.obj.get(this.mUrl)) {\r\n            this.onLoadComplete();\r\n        }\r\n        else {\r\n            this.scene.load.atlas(this.mUrl, textureURL, atlasURL);\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    DynamicSprite.prototype.destroy = function (fromScene) {\r\n        this.scene.sys.updateList.remove(this);\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    DynamicSprite.prototype.onLoadComplete = function () {\r\n        if (this.mLoadCompleteCallbak) {\r\n            var cb = this.mLoadCompleteCallbak;\r\n            this.mLoadCompleteCallbak = null;\r\n            cb.call(this.mLoadContext);\r\n            this.mLoadContext = null;\r\n        }\r\n        this.scene.anims.create({\r\n            key: this.mUrl,\r\n            frames: this.scene.anims.generateFrameNames(this.mUrl),\r\n            repeat: 1\r\n        });\r\n        this.play(this.mUrl);\r\n        // this.setTexture(this.mUrl);\r\n    };\r\n    DynamicSprite.prototype.onLoadError = function (file) {\r\n        if (this.mUrl === file.url) {\r\n            if (this.mLoadErrorCallback) {\r\n                var cb = this.mLoadErrorCallback;\r\n                this.mLoadErrorCallback = null;\r\n                cb.call(this.mLoadContext);\r\n                this.mLoadContext = null;\r\n            }\r\n        }\r\n    };\r\n    return DynamicSprite;\r\n}(Phaser.GameObjects.Sprite));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.sprite.ts?')},"./src/ui/components/message.box.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxUI", function() { return MessageBoxUI; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBtn", function() { return MessageBtn; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar MessageBoxUI = /** @class */ (function (_super) {\r\n    __extends(MessageBoxUI, _super);\r\n    function MessageBoxUI(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mConfig = config;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    MessageBoxUI.prototype.selectCall = function (itemData) {\r\n        this.mtxt.text = itemData.text;\r\n        this.mtxt.x = this.mConfig.wid - this.mtxt.width >> 1;\r\n        this.mtxt.y = this.mConfig.hei - this.mtxt.height >> 1;\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    MessageBoxUI.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        if (!this.mScene.cache.obj.has(resKey)) {\r\n            this.mScene.load.atlas(resKey, resPng, resJson);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    MessageBoxUI.prototype.onLoadCompleteHandler = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resBtn = this.mConfig.resBtn;\r\n        this.mBg = this.mScene.make.image(undefined, false);\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.mBg.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        this.mBtnList = [];\r\n        if (this.mConfig.btnData) {\r\n            var len = this.mConfig.btnData.length;\r\n            var btn = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                btn = new MessageBtn(this.mScene, this, resKey, resBtn, this.mConfig.btnWid, this.mConfig.btnHei);\r\n                this.mBtnList.push(btn);\r\n            }\r\n        }\r\n        this.mtxt = this.mScene.make.text({\r\n            x: 0, y: 0,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        this.add(this.mBg);\r\n        this.add(this.mtxt);\r\n    };\r\n    return MessageBoxUI;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar MessageBtn = /** @class */ (function (_super) {\r\n    __extends(MessageBtn, _super);\r\n    function MessageBtn(scene, messageBoxUI, resKey, resBtn, wid, hei) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.messageBoxUI = messageBoxUI;\r\n        _this.mBtn = scene.make.image(undefined, false);\r\n        _this.mBtn.setTexture(resKey, resBtn);\r\n        _this.mText = _this.scene.make.text({\r\n            x: -wid >> 1, y: -hei >> 1,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        _this.add(_this.mBtn);\r\n        _this.add(_this.mText);\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive();\r\n        _this.on("pointerdown", _this.selectHandler, _this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(MessageBtn.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mData;\r\n        },\r\n        set: function (val) {\r\n            this.mData = val;\r\n            this.mText.text = this.mData.text;\r\n            this.mText.x = -this.width / 2 + (this.width - this.mText.width >> 1);\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MessageBtn.prototype.destroy = function () {\r\n        this.mText.destroy(true);\r\n        this.mBtn.destroy(true);\r\n        this.mData = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    MessageBtn.prototype.selectHandler = function () {\r\n        this.addTween(this.mBtn);\r\n        this.messageBoxUI.selectCall(this.itemData);\r\n    };\r\n    MessageBtn.prototype.addTween = function (img) {\r\n        this.scene.tweens.add({\r\n            targets: img,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        img.scaleX = img.scaleY = 1;\r\n    };\r\n    return MessageBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/message.box.ts?')},"./src/ui/components/nine.patch.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NinePatch", function() { return NinePatch; });\n/* harmony import */ var _patches_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./patches.config */ "./src/ui/components/patches.config.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar NinePatch = /** @class */ (function (_super) {\r\n    __extends(NinePatch, _super);\r\n    function NinePatch(scene, x, y, width, height, key, frame, config) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.config = config || _this.scene.cache.custom.ninePatch.get(frame ? "" + frame : key);\r\n        Object(_patches_config__WEBPACK_IMPORTED_MODULE_0__["normalizePatchesConfig"])(_this.config);\r\n        _this.setSize(width, height);\r\n        _this.setTexture(key, frame);\r\n        return _this;\r\n    }\r\n    NinePatch.prototype.resize = function (width, height) {\r\n        width = Math.round(width);\r\n        height = Math.round(height);\r\n        if (!this.config) {\r\n            return this;\r\n        }\r\n        if (this.width === width && this.height === height) {\r\n            return this;\r\n        }\r\n        width = Math.max(width, this.config.left + this.config.right);\r\n        height = Math.max(height, this.config.top + this.config.bottom);\r\n        this.setSize(width, height);\r\n        this.drawPatches();\r\n        return;\r\n    };\r\n    NinePatch.prototype.setTexture = function (key, frame) {\r\n        this.originTexture = this.scene.textures.get(key);\r\n        this.setFrame(frame);\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setFrame = function (frame) {\r\n        this.originFrame = this.originTexture.frames[frame] || this.originTexture.frames[NinePatch.__BASE];\r\n        this.createPatches();\r\n        this.drawPatches();\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.finalXs = [0, this.config.left, this.width - this.config.right, this.width];\r\n        this.finalYs = [0, this.config.top, this.height - this.config.bottom, this.height];\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setTint = function (tint) {\r\n        this.tint = tint;\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setTintFill = function (tint) {\r\n        this.tint = tint;\r\n        this.tintFill = true;\r\n        return this;\r\n    };\r\n    Object.defineProperty(NinePatch.prototype, "tintFill", {\r\n        get: function () {\r\n            return this.first && this.first.tintFill;\r\n        },\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.tintFill = value; });\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NinePatch.prototype, "tint", {\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.setTint(value); });\r\n            this.internalTint = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NinePatch.prototype, "isTinted", {\r\n        get: function () {\r\n            return this.first && this.first.isTinted;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    NinePatch.prototype.createPatches = function () {\r\n        // The positions we want from the base texture\r\n        var textureXs = [0, this.config.left, this.originFrame.width - this.config.right, this.originFrame.width];\r\n        var textureYs = [0, this.config.top, this.originFrame.height - this.config.bottom, this.originFrame.height];\r\n        var patchIndex = 0;\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                this.createPatchFrame(this.getPatchNameByIndex(patchIndex), textureXs[xi], // x\r\n                textureYs[yi], // y\r\n                textureXs[xi + 1] - textureXs[xi], // width\r\n                textureYs[yi + 1] - textureYs[yi] // height\r\n                );\r\n                ++patchIndex;\r\n            }\r\n        }\r\n    };\r\n    // private drawPatches(): void {\r\n    //     const tintFill = this.tintFill;\r\n    //     this.removeAll(true);\r\n    //     let patchIndex = 0;\r\n    //     for (let yi = 0; yi < 3; yi++) {\r\n    //         for (let xi = 0; xi < 3; xi++) {\r\n    //             const patch: Phaser.Textures.Frame = this.originTexture.frames[this.getPatchNameByIndex(patchIndex)];\r\n    //             const patchImg = new Phaser.GameObjects.Image(this.scene, 0, 0, patch.texture.key, patch.name);\r\n    //             patchImg.setOrigin(0);\r\n    //             patchImg.setPosition(this.finalXs[xi] - this.width * this.originX, this.finalYs[yi] - this.height * this.originY);\r\n    //             patchImg.setScale(\r\n    //                 (this.finalXs[xi + 1] - this.finalXs[xi]) / patch.width,\r\n    //                 (this.finalYs[yi + 1] - this.finalYs[yi]) / patch.height\r\n    //             );\r\n    //             this.add(patchImg);\r\n    //             patchImg.setTint(this.internalTint);\r\n    //             patchImg.tintFill = tintFill;\r\n    //             ++patchIndex;\r\n    //         }\r\n    //     }\r\n    // }\r\n    NinePatch.prototype.drawPatches = function () {\r\n        var tintFill = this.tintFill;\r\n        this.removeAll(true);\r\n        var patchIndex = 0;\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                var patch = this.originTexture.frames[this.getPatchNameByIndex(patchIndex)];\r\n                var patchImg = new Phaser.GameObjects.Image(this.scene, 0, 0, patch.texture.key, patch.name);\r\n                patchImg.setOrigin(0);\r\n                patchImg.setPosition(this.finalXs[xi] - this.width * this.originX, this.finalYs[yi] - this.height * this.originY);\r\n                patchImg.setScale((this.finalXs[xi + 1] - this.finalXs[xi]) / patch.width, (this.finalYs[yi + 1] - this.finalYs[yi]) / patch.height);\r\n                this.add(patchImg);\r\n                patchImg.setTint(this.internalTint);\r\n                patchImg.tintFill = tintFill;\r\n                ++patchIndex;\r\n            }\r\n        }\r\n    };\r\n    NinePatch.prototype.createPatchFrame = function (patch, x, y, width, height) {\r\n        if (this.originTexture.frames.hasOwnProperty(patch)) {\r\n            return;\r\n        }\r\n        this.originTexture.add(patch, this.originFrame.sourceIndex, this.originFrame.cutX + x, this.originFrame.cutY + y, width, height);\r\n    };\r\n    NinePatch.prototype.getPatchNameByIndex = function (index) {\r\n        return this.originFrame.name + "|" + NinePatch.patches[index];\r\n    };\r\n    NinePatch.__BASE = "__BASE";\r\n    NinePatch.patches = ["[0][0]", "[1][0]", "[2][0]", "[0][1]", "[1][1]", "[2][1]", "[0][2]", "[1][2]", "[2][2]"];\r\n    return NinePatch;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/nine.patch.ts?')},"./src/ui/components/ninepatch.button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NinePatchButton", function() { return NinePatchButton; });\n/* harmony import */ var _nine_patch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar NinePatchButton = /** @class */ (function (_super) {\r\n    __extends(NinePatchButton, _super);\r\n    function NinePatchButton(scene, x, y, width, height, key, frame, text, config, data) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.mScene = scene;\r\n        _this.mKey = key;\r\n        _this.mFrame = frame ? frame : "__BASE";\r\n        _this.setSize(width, height);\r\n        _this.mNingBg = new _nine_patch__WEBPACK_IMPORTED_MODULE_0__["NinePatch"](_this.scene, 0, 0, width, height, key, _this.mFrame + "_normal", config);\r\n        _this.add(_this.mNingBg);\r\n        if (data) {\r\n            _this.btnData = data;\r\n        }\r\n        _this.mLabel = _this.scene.make.text(undefined, false)\r\n            .setOrigin(0.5, 0.5)\r\n            .setSize(_this.width, _this.height)\r\n            .setAlign("center")\r\n            .setText(text);\r\n        _this.add(_this.mLabel);\r\n        // this.setSize(this.mNingBg.width, this.mNingBg.height);\r\n        _this.setInteractive();\r\n        _this.on("pointerdown", _this.changeDown, _this);\r\n        _this.on("pointerup", _this.changeNormal, _this);\r\n        _this.on("pointerout", _this.changeNormal, _this);\r\n        _this.on("pointerover", _this.changeOver, _this);\r\n        return _this;\r\n    }\r\n    NinePatchButton.prototype.getBtnData = function () {\r\n        return this.btnData;\r\n    };\r\n    NinePatchButton.prototype.setText = function (text) {\r\n        this.mLabel.setText(text);\r\n    };\r\n    NinePatchButton.prototype.getText = function () {\r\n        return this.mLabel.text;\r\n    };\r\n    NinePatchButton.prototype.setTextStyle = function (style) {\r\n        this.mLabel.setStyle(style);\r\n    };\r\n    NinePatchButton.prototype.setTextOffset = function (x, y) {\r\n        this.mLabel.setPosition(x, y);\r\n    };\r\n    NinePatchButton.prototype.setFrame = function (frame) {\r\n        this.mNingBg.setFrame(frame);\r\n        return this;\r\n    };\r\n    NinePatchButton.prototype.destroy = function (fromScene) {\r\n        if (this.mLabel)\r\n            this.mLabel.destroy();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    NinePatchButton.prototype.changeNormal = function () {\r\n        var frame = this.mFrame ? this.mFrame : this.mKey;\r\n        this.setFrame(frame + "_normal");\r\n    };\r\n    NinePatchButton.prototype.changeOver = function () {\r\n        // this.setTexture()\r\n        var frame = this.mFrame ? this.mFrame : this.mKey;\r\n        this.setFrame(frame + "_over");\r\n    };\r\n    NinePatchButton.prototype.changeDown = function (pointer) {\r\n        // this.scale = 0.9;\r\n        var frame = this.mFrame ? this.mFrame : this.mKey;\r\n        this.setFrame(frame + "_down");\r\n        this.emit("click", pointer, this);\r\n        // this.scaleHandler();\r\n    };\r\n    Object.defineProperty(NinePatchButton.prototype, "label", {\r\n        get: function () {\r\n            return this.mLabel;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    NinePatchButton.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    return NinePatchButton;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/ninepatch.button.ts?')},"./src/ui/components/panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Panel", function() { return Panel; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Panel = /** @class */ (function (_super) {\r\n    __extends(Panel, _super);\r\n    function Panel(scene, world) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mShowing = false;\r\n        _this.mTweening = false;\r\n        _this.mWidth = 0;\r\n        _this.mHeight = 0;\r\n        _this.mTweenBoo = true;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mInitialized = false;\r\n        return _this;\r\n    }\r\n    Panel.prototype.isShow = function () {\r\n        return this.mShowing;\r\n    };\r\n    Panel.prototype.hide = function () {\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(false);\r\n        }\r\n        else {\r\n            this.destroy();\r\n        }\r\n    };\r\n    Panel.prototype.destroy = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n        if (this.mPanelTween) {\r\n            this.mPanelTween.stop();\r\n            this.mPanelTween.remove();\r\n        }\r\n        this.mInitialized = false;\r\n        this.mShowing = false;\r\n        this.mWidth = 0;\r\n        this.mHeight = 0;\r\n        this.mPanelTween = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Panel.prototype.resize = function (wid, hei) {\r\n    };\r\n    Panel.prototype.show = function (param) {\r\n        this.mData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShowing = true;\r\n        }\r\n    };\r\n    Panel.prototype.tweenView = function (show) {\r\n    };\r\n    Panel.prototype.setTween = function (boo) {\r\n        this.mTweenBoo = boo;\r\n    };\r\n    Panel.prototype.update = function (param) {\r\n    };\r\n    Panel.prototype.showTween = function (show) {\r\n        var _this = this;\r\n        this.mTweening = true;\r\n        this.scaleX = show ? 0 : this.mWorld.uiScale;\r\n        this.scaleY = show ? 0 : this.mWorld.uiScale;\r\n        var scale = show ? this.mWorld.uiScale : 0;\r\n        if (this.mPanelTween) {\r\n            this.mPanelTween.stop();\r\n        }\r\n        this.mPanelTween = this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: scale },\r\n                scaleY: { value: scale },\r\n            },\r\n            onComplete: function () {\r\n                _this.tweenComplete(show);\r\n            },\r\n            onCompleteParams: [this]\r\n        });\r\n    };\r\n    Panel.prototype.tweenComplete = function (show) {\r\n        this.mTweening = false;\r\n        this.mPanelTween.stop();\r\n        if (!show) {\r\n            this.mShowing = false;\r\n            this.destroy();\r\n        }\r\n        else {\r\n            this.mShowing = true;\r\n        }\r\n    };\r\n    Panel.prototype.init = function () {\r\n        this.mInitialized = true;\r\n        this.show(this.mData);\r\n    };\r\n    Panel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            // Logger.getInstance().error("scene does not exist");\r\n            return;\r\n        }\r\n        this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.loadComplete, this);\r\n        this.mScene.load.start();\r\n    };\r\n    Panel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        if (this.mInitialized) {\r\n            return;\r\n        }\r\n        this.init();\r\n    };\r\n    return Panel;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/panel.ts?')},"./src/ui/components/patches.config.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizePatchesConfig", function() { return normalizePatchesConfig; });\nvar normalizePatchesConfig = function (config) {\r\n    config.bottom = config.bottom || config.top;\r\n    config.left = config.left || config.top;\r\n    config.right = config.right || config.left;\r\n    return config;\r\n};\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/patches.config.ts?')},"./src/ui/components/radio.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Radio", function() { return Radio; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RadioItemRender", function() { return RadioItemRender; });\n/* harmony import */ var _nine_patch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText */ "./lib/rexui/plugins/gameobjects/text/bbocdetext/BBCodeText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Radio = /** @class */ (function (_super) {\r\n    __extends(Radio, _super);\r\n    // private mArrow: Phaser.GameObjects.Image;\r\n    function Radio(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mIsShow = false;\r\n        _this.mInit = false;\r\n        _this.mScene = scene;\r\n        _this.mConfig = config;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    Radio.prototype.setRadioData = function (value) {\r\n        this.clearRadioData();\r\n        this.itemList = [];\r\n        var len = value.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var item = new RadioItemRender(this.mScene, this, this.mConfig.wid + 10, 20, this.mConfig.resKey, this.mConfig.resArrow);\r\n            var itemData = value[i];\r\n            item.itemData = {\r\n                index: i,\r\n                text: itemData.text,\r\n                data: itemData.node.id\r\n            };\r\n            item.x = this.mConfig.wid / 2 + 25;\r\n            item.y = i * 33 + 23;\r\n            this.add(item);\r\n            this.itemList.push(item);\r\n        }\r\n        // 默認选择第0個\r\n        //  this.selectCall(this.itemList[0].itemData);\r\n    };\r\n    Radio.prototype.clearRadioData = function () {\r\n        if (this.itemList) {\r\n            var itemLen = this.itemList.length;\r\n            for (var i = 0; i < itemLen; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n                item = null;\r\n            }\r\n            this.itemList.length = 0;\r\n        }\r\n    };\r\n    Object.defineProperty(Radio.prototype, "isShow", {\r\n        get: function () {\r\n            return this.mIsShow;\r\n        },\r\n        set: function (value) {\r\n            this.mIsShow = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Radio.prototype.selectCall = function (itemData) {\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    Radio.prototype.destroy = function () {\r\n        if (this.itemList) {\r\n            var len = this.itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n            }\r\n            this.itemList.length = 0;\r\n            this.itemList = null;\r\n        }\r\n        this.removeAll();\r\n        this.removeAllListeners();\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Radio.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        if (!this.mScene.cache.obj.has(resKey)) {\r\n            this.mScene.load.atlas(resKey, resPng, resJson);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    Radio.prototype.onLoadCompleteHandler = function () {\r\n        this.mInit = true;\r\n        var resKey = this.mConfig.resKey;\r\n        this.mBg = new _nine_patch__WEBPACK_IMPORTED_MODULE_0__["NinePatch"](this.scene, 0, 0, this.mConfig.wid + 20, this.mConfig.hei, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2 - 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        if (this.mConfig.completeBack) {\r\n            this.mConfig.completeBack();\r\n        }\r\n    };\r\n    return Radio;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar RadioItemRender = /** @class */ (function (_super) {\r\n    __extends(RadioItemRender, _super);\r\n    function RadioItemRender(scene, selectCallUI, wid, hei, resKey, arrowRes) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mSelectCallUI = selectCallUI;\r\n        _this.mText = new _lib_rexui_plugins_gameobjects_text_bbocdetext_BBCodeText__WEBPACK_IMPORTED_MODULE_2__["default"](scene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: wid\r\n            },\r\n        });\r\n        // this.mText = this.scene.make.text({\r\n        //     x: -wid >> 1, y: -hei >> 1,\r\n        //     style: { font: "bold 20px YaHei", fill: "#F7EDED" }\r\n        // }, false);\r\n        // this.mText.style.align = "left";\r\n        var COLOR = 0xffcc00;\r\n        _this.mSelectBG = scene.make.graphics(undefined, false);\r\n        _this.mSelectBG.fillStyle(COLOR, .8);\r\n        _this.mSelectBG.fillRect(-wid >> 1, -hei >> 1, wid - 36, hei);\r\n        _this.mSelectBG.visible = false;\r\n        _this.addAt(_this.mSelectBG, 0);\r\n        _this.add(_this.mText);\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive();\r\n        _this.on("pointerover", _this.overHandler, _this);\r\n        _this.on("pointerout", _this.outHandler, _this);\r\n        _this.on("pointerdown", _this.selectHandler, _this);\r\n        _this.mArrow = scene.make.image(undefined, false);\r\n        _this.mArrow.setTexture(resKey, arrowRes);\r\n        _this.mArrow.x = -wid / 2 - 10;\r\n        _this.mArrow.y = 0;\r\n        _this.mArrow.visible = false;\r\n        _this.add(_this.mArrow);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(RadioItemRender.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mData;\r\n        },\r\n        set: function (val) {\r\n            this.mData = val;\r\n            this.mText.text = this.mData.text;\r\n            this.mText.x = -this.width >> 1;\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    RadioItemRender.prototype.destroy = function () {\r\n        this.mText.destroy(true);\r\n        this.mSelectBG.destroy(true);\r\n        this.mArrow.destroy(true);\r\n        this.mText = null;\r\n        this.mData = null;\r\n        this.mSelectCallUI = null;\r\n        this.mArrow = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    RadioItemRender.prototype.setSelected = function (val) {\r\n        this.mSelectBG.visible = val;\r\n        this.mArrow.visible = val;\r\n        if (this.mSelectCallUI)\r\n            this.mSelectCallUI.selectCall(this.itemData);\r\n    };\r\n    RadioItemRender.prototype.overHandler = function () {\r\n        this.mSelectBG.visible = true;\r\n        this.mArrow.visible = true;\r\n    };\r\n    RadioItemRender.prototype.outHandler = function () {\r\n        this.mSelectBG.visible = false;\r\n        this.mArrow.visible = false;\r\n    };\r\n    RadioItemRender.prototype.selectHandler = function () {\r\n        this.overHandler();\r\n        this.mSelectCallUI.selectCall(this.itemData);\r\n    };\r\n    return RadioItemRender;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/radio.ts?')},"./src/ui/components/scroller.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScrollerContainer", function() { return ScrollerContainer; });\n/* harmony import */ var _lib_rexui_plugins_input_scroller_Scroller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/plugins/input/scroller/Scroller */ "./lib/rexui/plugins/input/scroller/Scroller.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar GameObjects = Phaser.GameObjects;\r\n\r\nvar ScrollerContainer = /** @class */ (function (_super) {\r\n    __extends(ScrollerContainer, _super);\r\n    function ScrollerContainer(scene, rect, target) {\r\n        var _this = _super.call(this, scene) || this;\r\n        if (!target) {\r\n            return _this;\r\n        }\r\n        // this.mMask = this.scene.make.graphics(undefined, false)\r\n        //     .fillStyle(0x000033, 1)\r\n        //     .fillRect(rect.x, rect.y, rect.width, rect.height)\r\n        //     .setInteractive(rect, Phaser.Geom.Rectangle.Contains);\r\n        // this.add(this.mMask);\r\n        var graphics = new GameObjects.Graphics(scene)\r\n            .fillStyle(0x000033, 1)\r\n            .fillRect(rect.x, rect.y, rect.width, rect.height)\r\n            .setInteractive(rect, Phaser.Geom.Rectangle.Contains);\r\n        target.setMask(_this.mMask.createGeometryMask());\r\n        // this.add(target);\r\n        _this.mScroller = new _lib_rexui_plugins_input_scroller_Scroller__WEBPACK_IMPORTED_MODULE_0__["default"](_this.mMask, {\r\n            valuechangeCallback: function (newValue) {\r\n                target.y = newValue;\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    return ScrollerContainer;\r\n}(_lib_rexui_plugins_input_scroller_Scroller__WEBPACK_IMPORTED_MODULE_0__["default"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/scroller.ts?')},"./src/ui/components/scroller.view.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DirectionType", function() { return DirectionType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SrollerView", function() { return SrollerView; });\nvar DirectionType;\r\n(function (DirectionType) {\r\n    DirectionType[DirectionType["Vertical"] = 0] = "Vertical";\r\n    DirectionType[DirectionType["Horizontal"] = 1] = "Horizontal";\r\n})(DirectionType || (DirectionType = {}));\r\n/**\r\n * 自定义视图 scrollerView，图片视图scrollerView可以用tileSprite\r\n */\r\nvar SrollerView = /** @class */ (function () {\r\n    function SrollerView(scene, world, posX, posY, wid, hei, mode, item, itemsSize, space) {\r\n        if (space === void 0) { space = 0; }\r\n        this.mScene = scene;\r\n        this.mWorld = world;\r\n        this.mConfig = {\r\n            x: posX,\r\n            y: posY,\r\n            width: wid,\r\n            height: hei,\r\n            scrollMode: mode,\r\n            space: {\r\n                left: space,\r\n                right: space,\r\n                top: space,\r\n                bottom: space,\r\n                panel: space,\r\n                header: space,\r\n                footer: space,\r\n            },\r\n            itemClass: item,\r\n            itemSize: itemsSize\r\n        };\r\n        this.mShowLen = mode === 0 ? Math.ceil(wid / itemsSize) : Math.ceil(hei / itemsSize);\r\n        this.init(scene, posX, posY, wid, hei, mode, item, space);\r\n    }\r\n    SrollerView.prototype.createItem = function (scene, colIdx, rowIdx) {\r\n    };\r\n    SrollerView.prototype.setChild = function (data) {\r\n        if (this.mScrollablePanel) {\r\n            var scrollMode = this.mConfig.scrollMode;\r\n            var wid = this.mConfig.width;\r\n            var hei = this.mConfig.height;\r\n            var itemClass = this.mConfig.item;\r\n            var itemSize = this.mConfig.itemSize;\r\n            var expand = scrollMode === 0 ? (wid === undefined) : (hei === undefined);\r\n            var len = data.length > this.mShowLen ? this.mShowLen : data.length;\r\n            this.mItemList = [];\r\n            for (var i = 0; i < len; i++) {\r\n                var item = new itemClass();\r\n                this.mItemList.push(item);\r\n            }\r\n            this.mScrollablePanel.childrenMap.child.setChild(this.mItemList, expand);\r\n        }\r\n    };\r\n    SrollerView.prototype.init = function (scene, posX, posY, wid, hei, mode, item, space) {\r\n        this.mScrollablePanel = scene.rexUI.add.scrollablePanel(scene, {\r\n            x: posX,\r\n            y: posY,\r\n            width: wid,\r\n            height: hei,\r\n            scrollMode: mode,\r\n            panel: {\r\n                child: this.mItemList,\r\n                mask: {\r\n                    mask: true,\r\n                    padding: 1,\r\n                }\r\n            },\r\n            slider: {\r\n            // track: this.rexUI.add.roundRectangle(0, 0, 20, 10, 10, COLOR_DARK),\r\n            // thumb: this.rexUI.add.roundRectangle(0, 0, 0, 0, 13, COLOR_LIGHT),\r\n            },\r\n            // header: this.rexUI.add.label({\r\n            //     height: 30,\r\n            //     orientation: mode,\r\n            //     background: this.rexUI.add.roundRectangle(0, 0, 20, 20, 0, COLOR_DARK),\r\n            //     text: this.add.text(0, 0, "Header"),\r\n            // }),\r\n            // footer: this.rexUI.add.label({\r\n            //     height: 30,\r\n            //     orientation: mode,\r\n            //     background: this.rexUI.add.roundRectangle(0, 0, 20, 20, 0, COLOR_DARK),\r\n            //     text: this.add.text(0, 0, "Footer"),\r\n            // }),\r\n            space: {\r\n                left: 10,\r\n                right: 10,\r\n                top: 10,\r\n                bottom: 10,\r\n                panel: 10,\r\n                header: 10,\r\n                footer: 10,\r\n            }\r\n        })\r\n            .layout();\r\n    };\r\n    return SrollerView;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/scroller.view.ts?')},"./src/ui/debuglog/debug.logger.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebugLoggerMediator", function() { return DebugLoggerMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _debug_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./debug.logger */ "./src/ui/debuglog/debug.logger.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar DebugLoggerMediator = /** @class */ (function (_super) {\r\n    __extends(DebugLoggerMediator, _super);\r\n    function DebugLoggerMediator(scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mUIType = 1 /* BaseUIType */;\r\n        _this.mScene = scene;\r\n        return _this;\r\n    }\r\n    DebugLoggerMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    DebugLoggerMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    DebugLoggerMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    DebugLoggerMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    DebugLoggerMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _debug_logger__WEBPACK_IMPORTED_MODULE_1__["DebugLogger"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    DebugLoggerMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    DebugLoggerMediator.prototype.destroy = function () {\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DebugLoggerMediator.NAME = "DebugLoggerMediator";\r\n    return DebugLoggerMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/debuglog/debug.logger.mediator.ts?')},"./src/ui/debuglog/debug.logger.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebugLogger", function() { return DebugLogger; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _debug_logger_mediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./debug.logger.mediator */ "./src/ui/debuglog/debug.logger.mediator.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DebugLogger = /** @class */ (function (_super) {\r\n    __extends(DebugLogger, _super);\r\n    function DebugLogger(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mDelay = 0;\r\n        return _this;\r\n    }\r\n    DebugLogger.prototype.show = function (param) {\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShowing = true;\r\n        this.resize();\r\n    };\r\n    DebugLogger.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.showDescTxT();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = ((this.width >> 1) + 60) * this.mWorld.uiScale;\r\n            this.y = (this.height >> 1) * this.mWorld.uiScale;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n        }\r\n        this.mBgWidth = 400;\r\n        this.mBgHeight = size.height >> 1;\r\n        this.setSize(this.mBgWidth, this.mBgHeight);\r\n    };\r\n    DebugLogger.prototype.update = function (param) {\r\n        var now = this.mWorld.roomManager.currentRoom.now();\r\n        if (this.mDelay - now < 3000) {\r\n            this.showDescTxT();\r\n            this.mTimeTF.setText("FPS:" + param);\r\n            this.mDescTF.setText(this.mDescTxt);\r\n            this.mDelay = now;\r\n        }\r\n    };\r\n    DebugLogger.prototype.destroy = function () {\r\n        if (this.mBackground) {\r\n            this.mBackground.destroy();\r\n        }\r\n        if (this.mDescTF) {\r\n            this.mDescTF.destroy();\r\n        }\r\n        this.mDescTxt = "";\r\n        this.mBackground = null;\r\n        this.mDescTF = null;\r\n        this.mBgWidth = 0;\r\n        this.mBgHeight = 0;\r\n        this.mDelay = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DebugLogger.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.scene.load.image("logger", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DebugLogger.prototype.init = function () {\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var size = this.mWorld.getSize();\r\n        this.mBgWidth = 400;\r\n        this.mBgHeight = size.height >> 1;\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.mScene, 0, 0, this.mBgWidth, this.mBgHeight, "logger", null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.add(this.mBackground);\r\n        this.mTimeTF = this.mScene.make.text({\r\n            style: {\r\n                x: 0,\r\n                y: 0,\r\n                fontFamily: "YaHei",\r\n                fontSize: 20,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: size.width - 10, height: 20, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mDescTF = this.mScene.make.text({\r\n            style: {\r\n                x: 0,\r\n                y: 0,\r\n                fontFamily: "YaHei",\r\n                fontSize: 20,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: size.width - 10, height: size.height - 30, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mTimeTF.x = -this.mBgWidth / 2 + 5;\r\n        this.mDescTF.x = -this.mBgWidth / 2 + 5;\r\n        this.mTimeTF.y = -this.mBgHeight / 2 + 5;\r\n        this.mDescTF.y = -this.mBgHeight / 2 + 23;\r\n        this.add(this.mTimeTF);\r\n        this.add(this.mDescTF);\r\n        this.setSize(this.mBgWidth, this.mBgHeight);\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__["IconBtn"](this.mScene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n                iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n            });\r\n            this.mClsBtn.x = this.width / 2 - 35;\r\n            this.mClsBtn.y = -this.height / 2;\r\n            this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n            this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n            this.add(this.mClsBtn);\r\n        }\r\n        _super.prototype.init.call(this);\r\n    };\r\n    DebugLogger.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_4__["DebugLoggerMediator"].NAME).resize();\r\n    };\r\n    DebugLogger.prototype.showDescTxT = function () {\r\n        var orientation = this.mWorld.getSize().width > this.mWorld.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        var renderType = "WEBGL";\r\n        if (this.mWorld.game.config.renderType === Phaser.CANVAS) {\r\n            renderType = "CANVAS";\r\n        }\r\n        else if (this.mWorld.game.config.renderType === Phaser.HEADLESS) {\r\n            renderType = "HEADLESS";\r\n        }\r\n        this.mDescTxt = "rendertype:" + renderType + "\\n" + " width: " + this.mWorld.getSize().width + "\\n" + "height: " + this.mWorld.getSize().height + "\\n" + "orientation: " + orientation + "\\n" + "devicePixelRatio: " + window.devicePixelRatio;\r\n        this.showErrTxt();\r\n    };\r\n    DebugLogger.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_debug_logger_mediator__WEBPACK_IMPORTED_MODULE_4__["DebugLoggerMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    DebugLogger.prototype.showErrTxt = function () {\r\n        var errList = _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().getErrorList();\r\n        if (!errList) {\r\n            return;\r\n        }\r\n        var errStr = "";\r\n        errList.forEach(function (str) {\r\n            errStr += "\\n" + str;\r\n        });\r\n        this.mDescTxt += errStr;\r\n    };\r\n    return DebugLogger;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/debuglog/debug.logger.ts?')},"./src/ui/decorate/decorate.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateManager", function() { return DecorateManager; });\n/* harmony import */ var _decorate_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./decorate.panel */ "./src/ui/decorate/decorate.panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar DecorateManager = /** @class */ (function (_super) {\r\n    __extends(DecorateManager, _super);\r\n    function DecorateManager(scene, roomService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mPanel = new _decorate_panel__WEBPACK_IMPORTED_MODULE_0__["DecoratePanel"](scene, roomService);\r\n        _this.mPanel.on("moveElement", _this.onMoveElementHandler, _this);\r\n        _this.mLayerManager = roomService.layerManager;\r\n        return _this;\r\n    }\r\n    DecorateManager.prototype.setElement = function (ele) {\r\n        this.mPanel.setElement(ele);\r\n        this.mLayerManager.addToSceneToUI(this.mPanel);\r\n        this.mPanel.show();\r\n    };\r\n    DecorateManager.prototype.remove = function () {\r\n        // TODO panel只有destroy。需要封装个仅移除的方法\r\n        if (this.mPanel.parentContainer) {\r\n            this.mPanel.parentContainer.remove(this.mPanel);\r\n        }\r\n        this.mPanel.close();\r\n    };\r\n    DecorateManager.prototype.updatePos = function (x, y) {\r\n        if (!this.mPanel) {\r\n            return;\r\n        }\r\n        this.mPanel.setPosition(x, y);\r\n    };\r\n    DecorateManager.prototype.onMoveElementHandler = function (pos) {\r\n        this.emit("moveElement", pos);\r\n    };\r\n    return DecorateManager;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/decorate/decorate.manager.ts?')},"./src/ui/decorate/decorate.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecoratePanel", function() { return DecoratePanel; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DecoratePanel = /** @class */ (function (_super) {\r\n    __extends(DecoratePanel, _super);\r\n    function DecoratePanel(scene, mRoomService) {\r\n        var _this = _super.call(this, scene, mRoomService.world) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.resKey = "decorate";\r\n        _this.minGrid = 2;\r\n        _this.maxGrid = 10;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    DecoratePanel.prototype.setElement = function (ele) {\r\n        this.mDisplayObject = ele;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.x = ele.x;\r\n        this.y = ele.y;\r\n        this.updateArrowPos(ele);\r\n        this.register();\r\n    };\r\n    DecoratePanel.prototype.close = function () {\r\n        this.unregister();\r\n    };\r\n    DecoratePanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.scene.load.image("arrow", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_arrow.png"));\r\n        this.scene.load.atlas(this.resKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/decorate/decorate_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/decorate/decorate_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DecoratePanel.prototype.init = function () {\r\n        this.mControllContainer = this.scene.make.container({ y: -100 }, false);\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 196, 70, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mTurnBtn = this.createImage(this.resKey, "turn_btn.png", -60, 0);\r\n        this.mRecycleBtn = this.createImage(this.resKey, "recycle_btn.png", 0, 0);\r\n        this.mConfirmBtn = this.createImage(this.resKey, "confirm_btn.png", 60, 0);\r\n        var arrow = this.scene.make.image({\r\n            key: "arrow",\r\n            y: 46\r\n        }).setAngle(90);\r\n        this.mControllContainer.add(arrow);\r\n        this.mArrow1 = this.createImage(this.resKey, "arrow_1.png", 0, 0).setOrigin(0, 0);\r\n        this.mArrow1.on("pointerup", this.onLeftUpHandler, this);\r\n        this.mArrow3 = this.createImage(this.resKey, "arrow_3.png", 0, 300).setOrigin(0, 0);\r\n        this.mArrow3.on("pointerup", this.onLeftDownHandler, this);\r\n        this.mArrow5 = this.createImage(this.resKey, "arrow_5.png", 300, 300).setOrigin(0, 0);\r\n        this.mArrow5.on("pointerup", this.onRightDownHandler, this);\r\n        this.mArrow7 = this.createImage(this.resKey, "arrow_7.png", 300, 100).setOrigin(0, 0);\r\n        this.mArrow7.on("pointerup", this.onRightUpHandler, this);\r\n        this.add([this.mControllContainer, this.mArrow1, this.mArrow7, this.mArrow3, this.mArrow5]);\r\n        this.mControllContainer.add([border, this.mTurnBtn, this.mRecycleBtn, this.mConfirmBtn]);\r\n        _super.prototype.init.call(this);\r\n        this.setElement(this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.register = function () {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.mTurnBtn.on("pointerup", this.onTurnHandler, this);\r\n        this.mRecycleBtn.on("pointerup", this.onRecycleHandler, this);\r\n        this.mConfirmBtn.on("pointerup", this.onPutHandler, this);\r\n    };\r\n    DecoratePanel.prototype.unregister = function () {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.mTurnBtn.off("pointerup", this.onTurnHandler, this);\r\n        this.mRecycleBtn.off("pointerup", this.onRecycleHandler, this);\r\n        this.mConfirmBtn.off("pointerup", this.onPutHandler, this);\r\n    };\r\n    DecoratePanel.prototype.onLeftUpHandler = function () {\r\n        if (!this.mDisplayObject) {\r\n            return;\r\n        }\r\n        var pos45 = this.mRoomService.transformToMini45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplayObject.x, this.mDisplayObject.y));\r\n        pos45.x -= 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onLeftDownHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplayObject.x, this.mDisplayObject.y));\r\n        pos45.y += 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onRightUpHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplayObject.x, this.mDisplayObject.y));\r\n        pos45.y -= 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onRightDownHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplayObject.x, this.mDisplayObject.y));\r\n        pos45.x = pos45.x + 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onMoveElement = function (pos45) {\r\n        if (!this.mDisplayObject) {\r\n            return;\r\n        }\r\n        var position = this.mRoomService.transformToMini90(pos45);\r\n        this.emit("moveElement", position);\r\n    };\r\n    DecoratePanel.prototype.createImage = function (key, frame, x, y) {\r\n        return this.scene.make.image({ key: key, frame: frame, x: x, y: y }, false).setInteractive();\r\n    };\r\n    DecoratePanel.prototype.validateGrid = function (val) {\r\n        if (val > this.maxGrid) {\r\n            val = this.maxGrid;\r\n        }\r\n        if (val < this.minGrid) {\r\n            val = this.minGrid;\r\n        }\r\n        return val;\r\n    };\r\n    DecoratePanel.prototype.updateArrowPos = function (ele) {\r\n        var _a;\r\n        if (!ele || !ele.collisionArea) {\r\n            return;\r\n        }\r\n        var rows = ele.collisionArea.length;\r\n        var cols = ele.collisionArea[0].length;\r\n        rows = this.validateGrid(rows);\r\n        cols = this.validateGrid(cols);\r\n        if (ele.scaleX === -1) {\r\n            _a = [cols, rows], rows = _a[0], cols = _a[1];\r\n        }\r\n        var miniSize = this.mRoomService.roomSize;\r\n        var position = {\r\n            rows: rows,\r\n            cols: cols,\r\n            tileWidth: miniSize.tileWidth / 2,\r\n            tileHeight: miniSize.tileHeight / 2,\r\n        };\r\n        var reference = ele.getElement("reference");\r\n        if (!reference) {\r\n            return;\r\n        }\r\n        var pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](cols, (rows / 2)), position);\r\n        if (this.mArrow5) {\r\n            this.mArrow5.x = pos.x + reference.x;\r\n            this.mArrow5.y = pos.y + reference.y;\r\n        }\r\n        pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"]((cols / 2), rows), position);\r\n        if (this.mArrow3) {\r\n            this.mArrow3.x = pos.x - this.mArrow3.width + reference.x;\r\n            this.mArrow3.y = pos.y + reference.y;\r\n        }\r\n        pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](0, (rows / 2)), position);\r\n        if (this.mArrow1) {\r\n            this.mArrow1.x = pos.x - this.mArrow1.width + reference.x;\r\n            this.mArrow1.y = pos.y - this.mArrow1.height + reference.y;\r\n        }\r\n        pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"]((cols / 2), 0), position);\r\n        if (this.mArrow7) {\r\n            this.mArrow7.x = pos.x + reference.x;\r\n            this.mArrow7.y = pos.y - this.mArrow7.height + reference.y;\r\n        }\r\n    };\r\n    DecoratePanel.prototype.onTurnHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_5__["MessageType"].TURN_ELEMENT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onRecycleHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_5__["MessageType"].RECYCLE_ELEMENT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onPutHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_5__["MessageType"].PUT_ELEMENT, this.mDisplayObject);\r\n    };\r\n    return DecoratePanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/decorate/decorate.panel.ts?')},"./src/ui/friend/friend.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendMediator", function() { return FriendMediator; });\n/* harmony import */ var _baseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseMediator */ "./src/ui/baseMediator.ts");\n/* harmony import */ var _friend_panel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./friend.panel */ "./src/ui/friend/friend.panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar FriendMediator = /** @class */ (function (_super) {\r\n    __extends(FriendMediator, _super);\r\n    function FriendMediator(scene, world) {\r\n        var _this = _super.call(this, world) || this;\r\n        _this.mUIType = 2 /* NormalUIType */;\r\n        _this.mScene = scene;\r\n        return _this;\r\n    }\r\n    FriendMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    FriendMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    FriendMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize(this.mAddWid, this.mAddHei);\r\n    };\r\n    FriendMediator.prototype.show = function (param) {\r\n        var friendMed = this;\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _friend_panel__WEBPACK_IMPORTED_MODULE_1__["FriendPanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    FriendMediator.prototype.hide = function () {\r\n        this.isShowing = false;\r\n        if (this.mView)\r\n            this.mView = null;\r\n    };\r\n    FriendMediator.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FriendMediator.NAME = "FriendMediator";\r\n    return FriendMediator;\r\n}(_baseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/friend/friend.mediator.ts?')},"./src/ui/friend/friend.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendPanel", function() { return FriendPanel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendItem", function() { return FriendItem; });\n/* harmony import */ var _components_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/panel */ "./src/ui/components/panel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! phaser */ "./node_modules/phaser/dist/phaser.js-exposed");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _friend_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./friend.mediator */ "./src/ui/friend/friend.mediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar FriendPanel = /** @class */ (function (_super) {\r\n    __extends(FriendPanel, _super);\r\n    function FriendPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mIndex = 0;\r\n        return _this;\r\n    }\r\n    FriendPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (!this.mShowing)\r\n            return;\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width + wid >> 1;\r\n            this.y = size.height + hei >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mBg.resize((size.width * .5 - 20) / this.mWorld.uiScale, (size.height - 20) / this.mWorld.uiScale);\r\n                // new NinePatch(this.scene, 0, 0, size.width * .6 / this.mWorld.uiScale - 30, size.height / this.mWorld.uiScale - 30, Border.getName(), null, Border.getConfig());\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n                this.x = (this.width / 2 + 10) * this.mWorld.uiScale;\r\n                this.y = (this.height / 2 + 10) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                this.mBg.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n                // = new NinePatch(this.scene, 0, 0, size.width / this.mWorld.uiScale - 30, size.height / this.mWorld.uiScale - 30, Border.getName(), null, Border.getConfig());\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n                this.x = (this.width / 2 + 15) * this.mWorld.uiScale;\r\n                this.y = size.height - this.mBg.height * .5 * this.mWorld.uiScale - 10;\r\n            }\r\n        }\r\n        this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n        this.mUpBtn.y = (this.mUpBtn.height / 2 - this.mBg.height) / 2;\r\n        this.mDownBtn.y = (this.mBg.height - this.mDownBtn.height / 2) / 2;\r\n        this.mTitleTxt.x = (-this.mBg.width / 2 + 15);\r\n        this.mTitleTxt.y = (-this.mBg.height / 2 + 8);\r\n        if (this.mClsBtn) {\r\n            this.mClsBtn.x = (this.mBg.width >> 1) - 65;\r\n            this.mClsBtn.y = (-this.mBg.height >> 1);\r\n        }\r\n        this.initFriendItem();\r\n        this.addAt(this.mBg, 0);\r\n        this.add(this.mTitleTxt);\r\n    };\r\n    FriendPanel.prototype.show = function (param) {\r\n        var size = this.mWorld.getSize();\r\n        this.mData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    FriendPanel.prototype.destroy = function () {\r\n        if (this.mBg)\r\n            this.mBg.destroy(true);\r\n        if (this.mTitleTxt)\r\n            this.mTitleTxt.destroy(true);\r\n        if (this.mUpBtn)\r\n            this.mUpBtn.destroy(true);\r\n        if (this.mDownBtn)\r\n            this.mDownBtn.destroy(true);\r\n        if (this.mFriendList) {\r\n            this.mFriendList.forEach(function (item) {\r\n                if (item) {\r\n                    item.destory();\r\n                    item = null;\r\n                }\r\n            });\r\n        }\r\n        this.mIndex = 0;\r\n        this.mBg = null;\r\n        this.mTitleTxt = null;\r\n        this.mUpBtn = null;\r\n        this.mDownBtn = null;\r\n        this.mFriendList = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FriendPanel.prototype.friendChat = function (id) {\r\n    };\r\n    FriendPanel.prototype.friendGo = function (gameId) {\r\n    };\r\n    FriendPanel.prototype.btnScaleHandler = function (gameObject, scaleX) {\r\n        if (scaleX === void 0) { scaleX = 1; }\r\n        this.mScene.tweens.add({\r\n            targets: gameObject,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 * scaleX },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        gameObject.scaleX = scaleX;\r\n        gameObject.scaleY = 1;\r\n    };\r\n    FriendPanel.prototype.hide = function () {\r\n        this.mWorld.uiManager.baseFaceTween(true);\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    FriendPanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.image("friendChat", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/friend/friend_chat.png"));\r\n        this.scene.load.image("friendGo", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/friend/friend_go.png"));\r\n        this.mScene.load.atlas("bagView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    FriendPanel.prototype.init = function () {\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var size = this.mWorld.getSize();\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 600 / this.mWorld.uiScale, size.height * .5 * this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        // this.addAt(this.mBg, 0);\r\n        this.mTitleTxt = this.mScene.make.text(undefined, false);\r\n        this.mTitleTxt.setFontFamily("YaHei");\r\n        this.mTitleTxt.setFontStyle("bold");\r\n        this.mTitleTxt.setFontSize(14);\r\n        this.mTitleTxt.style.align = "left";\r\n        this.mTitleTxt.setText("好友列表");\r\n        // this.add(this.mTitleTxt);\r\n        this.mUpBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mUpBtn.setTexture("bagView", "bagView_tab.png");\r\n        this.mUpBtn.rotation = Math.PI / 2;\r\n        this.mDownBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mDownBtn.setTexture("bagView", "bagView_tab.png");\r\n        this.mDownBtn.rotation = -Math.PI / 2;\r\n        this.mDownBtn.setInteractive();\r\n        this.mUpBtn.setInteractive();\r\n        this.mDownBtn.on("pointerup", this.downHandler, this);\r\n        this.mUpBtn.on("pointerup", this.upHandler, this);\r\n        var image = this.scene.make.image(undefined, false);\r\n        image.setTexture(this.mWorld.roomManager.currentRoom.playerManager.actor.getDisplay().mDisplayInfo.id + "");\r\n        this.add(image);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.initFriendItem();\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_6__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n        });\r\n        this.mClsBtn.x = (this.mWidth >> 1) - 65;\r\n        this.mClsBtn.y = -this.mHeight >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.mClsBtn.on("pointerup", this.hide, this);\r\n        this.add(this.mClsBtn);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    FriendPanel.prototype.tweenComplete = function (show) {\r\n        var _this = this;\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        this.mWorld.roomManager.currentRoom.playerManager.actor.getFriend().requestFriend(function (data) {\r\n            _this.setDataList(data);\r\n        });\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_friend_mediator__WEBPACK_IMPORTED_MODULE_7__["FriendMediator"].NAME).resize();\r\n    };\r\n    FriendPanel.prototype.downHandler = function () {\r\n        this.btnScaleHandler(this.mDownBtn);\r\n        var len = this.mFriendDataList ? this.mFriendDataList.length : 0;\r\n        var pageNum = Math.floor(len / FriendPanel.count);\r\n        this.mIndex = this.mIndex + 1 > pageNum ? pageNum : this.mIndex + 1;\r\n        this.refreshDataList();\r\n    };\r\n    FriendPanel.prototype.upHandler = function () {\r\n        this.btnScaleHandler(this.mUpBtn);\r\n        this.mIndex = this.mIndex - 1 > 0 ? this.mIndex - 1 : 0;\r\n        this.refreshDataList();\r\n    };\r\n    FriendPanel.prototype.setDataList = function (data) {\r\n        if (!this.mFriendList)\r\n            return;\r\n        this.mFriendDataList = data;\r\n        var len = data.length > FriendPanel.count ? FriendPanel.count : data.length;\r\n        for (var i = 0; i < 4; i++) {\r\n            var item = this.mFriendList[i];\r\n            var dat = data[this.mIndex * FriendPanel.count + i];\r\n            if (!dat) {\r\n                item.visible = false;\r\n                // this.add(item);\r\n                continue;\r\n            }\r\n            item.visible = true;\r\n            dat.index = i;\r\n            // item.dataChange(dat);\r\n            // this.add(item);\r\n        }\r\n        this.add(this.mUpBtn);\r\n        this.add(this.mDownBtn);\r\n    };\r\n    FriendPanel.prototype.refreshDataList = function () {\r\n        // if (!this.mFriendDataList || !this.mFriendList) return;\r\n        // const len: number = this.mFriendDataList.length > FriendPanel.count ? FriendPanel.count : this.mFriendDataList.length;\r\n        // for (let i: number = 0; i < len; i++) {\r\n        //     const item: FriendItem = this.mFriendList[i];\r\n        //     let dat = this.mFriendDataList[this.mIndex * FriendPanel.count + i];\r\n        //     if (!dat) dat = {};\r\n        //     dat.index = i;\r\n        //     item.dataChange(dat);\r\n        // }\r\n    };\r\n    FriendPanel.prototype.initFriendItem = function () {\r\n        var len = this.mFriendList ? this.mFriendList.length : FriendPanel.count;\r\n        if (this.mFriendList && this.mFriendList.length > 0) {\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mFriendList[i];\r\n                item.resize();\r\n                item.y = this.mWorld.game.device.os.desktop ? (-this.mBg.height / 2 + this.mTitleTxt.height + i * (item.height + 10) + (item.height / 2 + 10)) * this.mWorld.uiScale :\r\n                    (i - 1.5) * (item.height + 10);\r\n            }\r\n        }\r\n        else {\r\n            this.mFriendList = [];\r\n            var resList = [{\r\n                    res: "friendChat",\r\n                    name: "聊天"\r\n                }, {\r\n                    res: "friendGo",\r\n                    name: "跟随"\r\n                }];\r\n            for (var i = 0; i < len; i++) {\r\n                var item = new FriendItem(this.mWorld, this.mScene, this, resList);\r\n                item.y = this.mWorld.game.device.os.desktop ? (-this.mBg.height / 2 + this.mTitleTxt.height + i * (item.height + 10) + (item.height / 2 + 10)) * this.mWorld.uiScale :\r\n                    (i - 1.5) * (item.height + 10);\r\n                this.mFriendList.push(item);\r\n            }\r\n        }\r\n    };\r\n    FriendPanel.count = 4;\r\n    return FriendPanel;\r\n}(_components_panel__WEBPACK_IMPORTED_MODULE_0__["Panel"]));\r\n\r\nvar FriendItem = /** @class */ (function (_super) {\r\n    __extends(FriendItem, _super);\r\n    function FriendItem(world, scene, panel, iconResList) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.iconResList = [];\r\n        _this.mPanel = panel;\r\n        _this.mWorld = world;\r\n        _this.mScene = scene;\r\n        var size = _this.mWorld.getSize();\r\n        _this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](_this.mScene, 0, 0, _this.mPanel.width, 90, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        _this.addAt(_this.mBg, 0);\r\n        _this.setSize(_this.mBg.width, _this.mBg.height);\r\n        _this.mRoleIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_4__["DynamicImage"](_this.mScene, -_this.mBg.width / 2, 0);\r\n        _this.nameTF = _this.mScene.make.text({\r\n            align: "left",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].YAHEI_20_BOLD, fill: "#FFCC00" }\r\n        }, false);\r\n        _this.statusTF = _this.mScene.make.text({\r\n            align: "left",\r\n            style: { font: "14px YaHei" }\r\n        }, false);\r\n        if (iconResList) {\r\n            var len = iconResList.length;\r\n            var _loop_1 = function (i) {\r\n                var icon = this_1.mScene.make.image(undefined, false);\r\n                var iconCon = this_1.mScene.make.container(undefined, false);\r\n                var bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this_1.mScene, 0, 0, 60, 60, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n                var txt = this_1.mScene.make.text(undefined, false);\r\n                var friendIconData = iconResList[i];\r\n                txt.setText(friendIconData.name);\r\n                icon.setTexture(friendIconData.res);\r\n                icon.scaleX = icon.scaleY = .8;\r\n                iconCon.add(icon);\r\n                iconCon.add(txt);\r\n                iconCon.addAt(bg, 0);\r\n                iconCon.setSize(60, 60);\r\n                iconCon.setInteractive(new phaser__WEBPACK_IMPORTED_MODULE_5__["Geom"].Rectangle(0, 0, 60, 60), Phaser.Geom.Rectangle.Contains);\r\n                iconCon.on("pointerdown", function () {\r\n                    _this.mPanel.btnScaleHandler(iconCon);\r\n                }, this_1);\r\n                icon.y = -bg.height / 2 + icon.height / 2;\r\n                txt.x = -txt.width >> 1;\r\n                txt.y = iconCon.height / 2 - txt.height - 4;\r\n                // iconCon.x = this.width / 2 - (i + 1) * 70 - 20;\r\n                this_1.add(iconCon);\r\n                this_1.iconResList.push(iconCon);\r\n            };\r\n            var this_1 = this;\r\n            for (var i = 0; i < len; i++) {\r\n                _loop_1(i);\r\n            }\r\n        }\r\n        _this.add(_this.mRoleIcon);\r\n        _this.add(_this.nameTF);\r\n        _this.add(_this.statusTF);\r\n        _this.refreshUIPos();\r\n        return _this;\r\n    }\r\n    FriendItem.prototype.resize = function () {\r\n        if (this.mWorld.game.device.os.desktop)\r\n            return;\r\n        this.mBg.resize(this.mPanel.width * .95, 90);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.addAt(this.mBg, 0);\r\n        this.refreshUIPos();\r\n    };\r\n    FriendItem.prototype.getView = function () {\r\n        return this;\r\n    };\r\n    FriendItem.prototype.dataChange = function (data) {\r\n        var _this = this;\r\n        var lv = data.level || 0;\r\n        var id = data.id || "1";\r\n        var name = data.nickname || "test";\r\n        this.nameTF.setText(name);\r\n        this.mRoleIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(data.avatar || "1"), this, function () {\r\n            _this.mRoleIcon.scaleX = _this.height / _this.mRoleIcon.width;\r\n            _this.mRoleIcon.scaleY = _this.height / _this.mRoleIcon.height;\r\n        }, function () {\r\n            _this.mRoleIcon.scaleX = _this.mRoleIcon.scaleY = 1;\r\n        });\r\n        this.mRoleIcon.x = -this.width / 2 + 64;\r\n        this.nameTF.x = this.mRoleIcon.x + 54;\r\n        this.index = data.index;\r\n    };\r\n    FriendItem.prototype.destory = function () {\r\n        this.index = 0;\r\n        if (this.nameTF) {\r\n            this.nameTF.destroy(true);\r\n        }\r\n        if (this.statusTF) {\r\n            this.statusTF.destroy(true);\r\n        }\r\n        if (this.mRoleIcon) {\r\n            this.mRoleIcon.destroy(true);\r\n        }\r\n        this.nameTF = null;\r\n        this.statusTF = null;\r\n        this.mPanel = null;\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    FriendItem.prototype.refreshUIPos = function () {\r\n        this.mRoleIcon.x = -this.width / 2 + 64;\r\n        this.nameTF.x = this.mRoleIcon.x + 54;\r\n        this.mRoleIcon.y = 0;\r\n        this.nameTF.y = 10 - this.mBg.height / 2;\r\n        this.statusTF.x = this.nameTF.x;\r\n        if (this.iconResList) {\r\n            var len = this.iconResList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var iconCon = this.iconResList[i];\r\n                iconCon.x = this.width / 2 - (i + 1) * 70 + 20;\r\n            }\r\n        }\r\n    };\r\n    return FriendItem;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/friend/friend.panel.ts?')},"./src/ui/layer.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayerManager", function() { return LayerManager; });\nvar LayerManager = /** @class */ (function () {\r\n    function LayerManager() {\r\n    }\r\n    LayerManager.prototype.setScene = function (scene) {\r\n        if (!scene)\r\n            return;\r\n        this.destroy();\r\n        this.mScene = scene;\r\n        // const view = scene.cameras.main;\r\n        // this.mInteractive = scene.add.container(view.width >> 1, view.height >> 1);\r\n        // this.mInteractive.setSize(view.width, view.height);\r\n        // const rect = scene.add.graphics();\r\n        // rect.lineStyle(1, 0, 1);\r\n        // rect.fillRect(0, 0, view.width, view.height);\r\n        // this.mInteractive.setInteractive();\r\n        this.mUILayer = scene.add.container(0, 0);\r\n        this.mDialogLayer = scene.add.container(0, 0);\r\n        this.mToolTipsLyaer = scene.add.container(0, 0);\r\n    };\r\n    LayerManager.prototype.addToUILayer = function (obj) {\r\n        if (!this.mUILayer) {\r\n            return;\r\n        }\r\n        this.mUILayer.add(obj);\r\n    };\r\n    LayerManager.prototype.addToDialogLayer = function (obj) {\r\n        if (!this.mDialogLayer) {\r\n            return;\r\n        }\r\n        this.mDialogLayer.add(obj);\r\n    };\r\n    LayerManager.prototype.addToToolTipsLayer = function (obj) {\r\n        if (!this.mToolTipsLyaer) {\r\n            return;\r\n        }\r\n        this.mToolTipsLyaer.add(obj);\r\n    };\r\n    LayerManager.prototype.removeToUILayer = function (obj) {\r\n        this.mUILayer.remove(obj);\r\n    };\r\n    LayerManager.prototype.removeToDialogLayer = function (obj) {\r\n        this.mDialogLayer.remove(obj);\r\n    };\r\n    LayerManager.prototype.removeToToolTipsLayer = function (obj) {\r\n        this.mToolTipsLyaer.remove(obj);\r\n    };\r\n    LayerManager.prototype.destroy = function () {\r\n        if (this.mUILayer) {\r\n            this.mUILayer.destroy();\r\n            this.mUILayer = null;\r\n        }\r\n        if (this.mDialogLayer) {\r\n            this.mDialogLayer.destroy();\r\n            this.mDialogLayer = null;\r\n        }\r\n        if (this.mToolTipsLyaer) {\r\n            this.mToolTipsLyaer.destroy();\r\n            this.mToolTipsLyaer = null;\r\n        }\r\n    };\r\n    Object.defineProperty(LayerManager.prototype, "interactive", {\r\n        get: function () {\r\n            return this.mInteractive;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return LayerManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/layer.manager.ts?')},"./src/ui/loadview.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingView", function() { return LoadingView; });\nvar LoadingView = /** @class */ (function () {\r\n    function LoadingView(mScene) {\r\n        this.mScene = mScene;\r\n        this.mShowing = false;\r\n        this.createPanel();\r\n    }\r\n    LoadingView.prototype.isShow = function () {\r\n        return this.mShowing;\r\n    };\r\n    LoadingView.prototype.show = function (param) {\r\n        this.mTween = this.mScene.tweens.add({\r\n            targets: this.mBg,\r\n            duration: 2000000,\r\n            ease: "Linear",\r\n            props: {\r\n                rotation: 360,\r\n            }\r\n        });\r\n    };\r\n    LoadingView.prototype.update = function (param) {\r\n    };\r\n    LoadingView.prototype.hide = function () {\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            // this.mTween = null;\r\n        }\r\n    };\r\n    LoadingView.prototype.tweenView = function (show) {\r\n    };\r\n    LoadingView.prototype.resize = function () {\r\n    };\r\n    LoadingView.prototype.destroy = function () {\r\n        if (this.mBg) {\r\n            this.mBg.destroy();\r\n        }\r\n    };\r\n    LoadingView.prototype.createPanel = function () {\r\n        var size = this.mScene.game.scale.gameSize;\r\n        this.mBg = this.mScene.add.sprite(size.width >> 1, size.height >> 1, "stars");\r\n        this.mBg.scaleX = this.mBg.scaleY = 1.3;\r\n    };\r\n    return LoadingView;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/loadview.ts?')},"./src/ui/tips/itoolTip.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/tips/itoolTip.ts?")},"./src/ui/tips/toolTip.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolTip", function() { return ToolTip; });\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/tool */ "./src/utils/tool.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar ToolTip = /** @class */ (function (_super) {\r\n    __extends(ToolTip, _super);\r\n    function ToolTip(mScene, resStr, resJson, resUrl, uiScale) {\r\n        var _this = _super.call(this, mScene) || this;\r\n        _this.mScene = mScene;\r\n        _this.resStr = resStr;\r\n        _this.resJson = resJson;\r\n        _this.resUrl = resUrl;\r\n        _this.uiScale = uiScale;\r\n        _this.mWidth = 0;\r\n        _this.mHeight = 0;\r\n        _this.mBaseMidHeight = 0;\r\n        _this.preLoad();\r\n        return _this;\r\n    }\r\n    ToolTip.prototype.setToolTipData = function (value) {\r\n        if (!this.mText)\r\n            return;\r\n        var str = _utils_tool__WEBPACK_IMPORTED_MODULE_0__["Tool"].formatChineseString(value, this.mText.style.fontSize, this.mWidth - 20);\r\n        this.mText.setText(str);\r\n        this.refreshTip();\r\n    };\r\n    ToolTip.prototype.destroy = function () {\r\n        if (this.topImage)\r\n            this.topImage.destroy(true);\r\n        if (this.midImage)\r\n            this.midImage.destroy(true);\r\n        if (this.botImage)\r\n            this.botImage.destroy(true);\r\n        if (this.mText)\r\n            this.mText.destroy(true);\r\n        this.mWidth = 0;\r\n        this.mHeight = 0;\r\n        this.removeAllListeners();\r\n        this.removeAll();\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    ToolTip.prototype.preLoad = function () {\r\n        this.scene.load.atlas(this.resStr, this.resUrl, this.resJson);\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n        this.scene.load.start();\r\n    };\r\n    ToolTip.prototype.init = function () {\r\n        this.topImage = this.scene.make.image(undefined, false);\r\n        this.topImage.setOrigin(0, 0);\r\n        this.topImage.setTexture(this.resStr, ToolTip.TOP);\r\n        this.midImage = this.scene.make.image(undefined, false);\r\n        this.midImage.setOrigin(0, 0);\r\n        this.midImage.setTexture(this.resStr, ToolTip.MID);\r\n        this.botImage = this.scene.make.image(undefined, false);\r\n        this.botImage.setOrigin(0, 0);\r\n        this.botImage.setTexture(this.resStr, ToolTip.BOT);\r\n        this.mText = this.scene.make.text(undefined, false);\r\n        this.mText.setFontFamily("YaHei");\r\n        this.mText.setFontStyle("bold");\r\n        this.mText.setFontSize(14);\r\n        this.mText.style.align = "center";\r\n        this.mText.lineSpacing = 15;\r\n        this.mWidth = this.topImage.width;\r\n        this.mBaseMidHeight = this.midImage.height;\r\n        this.mText.style.fixedWidth = this.mWidth - 20;\r\n        this.mText.style.setWordWrapWidth(this.mWidth - 20, true);\r\n        // this.mText.style.setMaxLines(10);\r\n        this.add(this.topImage);\r\n        this.add(this.midImage);\r\n        this.add(this.botImage);\r\n        this.add(this.mText);\r\n    };\r\n    ToolTip.prototype.refreshTip = function () {\r\n        this.midImage.scaleY = (this.mText.height + 20) / this.mBaseMidHeight;\r\n        this.mHeight = this.topImage.height + this.midImage.height * this.midImage.scaleY + this.botImage.height;\r\n        this.topImage.y = -this.topImage.height >> 1;\r\n        this.midImage.y = this.topImage.y + this.topImage.height;\r\n        this.botImage.y = this.midImage.y + this.midImage.height * this.midImage.scaleY;\r\n        this.mText.x = this.mWidth - this.mText.style.fixedWidth >> 1;\r\n        this.mText.y = this.mHeight - this.mText.height - 10 >> 1;\r\n        this.setSize(this.mWidth, this.mHeight);\r\n    };\r\n    ToolTip.prototype.onLoadComplete = function () {\r\n        this.init();\r\n    };\r\n    ToolTip.TOP = "tip_top.png";\r\n    ToolTip.MID = "tip_mid.png";\r\n    ToolTip.BOT = "tip_bot.png";\r\n    return ToolTip;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/tips/toolTip.ts?')},"./src/ui/ui.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UiManager", function() { return UiManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _layer_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./layer.manager */ "./src/ui/layer.manager.ts");\n/* harmony import */ var _Notice_NoticeMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Notice/NoticeMediator */ "./src/ui/Notice/NoticeMediator.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _friend_friend_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./friend/friend.mediator */ "./src/ui/friend/friend.mediator.ts");\n/* harmony import */ var _ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ElementStorage/ElementStorageMediator */ "./src/ui/ElementStorage/ElementStorageMediator.ts");\n/* harmony import */ var _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Rank/RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var _baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./baseView/rightGroup/right.mediator */ "./src/ui/baseView/rightGroup/right.mediator.ts");\n/* harmony import */ var _baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./baseView/leftGroup/left.mediator */ "./src/ui/baseView/leftGroup/left.mediator.ts");\n/* harmony import */ var _baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./baseView/bottomGroup/bottom.mediator */ "./src/ui/baseView/bottomGroup/bottom.mediator.ts");\n/* harmony import */ var _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./baseView/bagGroup/bag.group.mediator */ "./src/ui/baseView/bagGroup/bag.group.mediator.ts");\n/* harmony import */ var _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./baseView/top.menu/top.menu.mediator */ "./src/ui/baseView/top.menu/top.menu.mediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar UiManager = /** @class */ (function (_super) {\r\n    __extends(UiManager, _super);\r\n    function UiManager(worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        _this.mCache = [];\r\n        _this.mNoneUIMap = new Map();\r\n        _this.mBaseUIMap = new Map();\r\n        _this.mNormalUIMap = new Map();\r\n        _this.mTipUIMap = new Map();\r\n        _this.mMonopolyUIMap = new Map();\r\n        // 用于记录功能ui打开的顺序,最多2个\r\n        _this.mShowuiList = [];\r\n        _this.mConnect = worldService.connection;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI, _this.handleShowUI);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_UPDATE_UI, _this.handleUpdateUI);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CLOSE_UI, _this.handleCloseUI);\r\n        // this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_EDIT_MODE, this.onEnableEditMode);\r\n        _this.mUILayerManager = new _layer_manager__WEBPACK_IMPORTED_MODULE_4__["LayerManager"]();\r\n        return _this;\r\n    }\r\n    UiManager.prototype.addPackListener = function () {\r\n        if (this.mConnect) {\r\n            this.mConnect.addPacketListener(this);\r\n        }\r\n    };\r\n    UiManager.prototype.removePackListener = function () {\r\n        if (this.mConnect) {\r\n            this.mConnect.removePacketListener(this);\r\n        }\r\n    };\r\n    UiManager.prototype.getUILayerManager = function () {\r\n        return this.mUILayerManager;\r\n    };\r\n    UiManager.prototype.setScene = function (scene) {\r\n        this.mScene = scene;\r\n        this.mUILayerManager.setScene(scene);\r\n        if (this.mCacheUI) {\r\n            this.mCacheUI();\r\n            this.mCacheUI = undefined;\r\n        }\r\n    };\r\n    UiManager.prototype.showMainUI = function () {\r\n        var _this = this;\r\n        if (!this.mScene) {\r\n            this.mCacheUI = this.showMainUI;\r\n            return;\r\n        }\r\n        var scene = this.mScene;\r\n        this.clearMediator();\r\n        if (!this.mMedMap) {\r\n            this.mMedMap = new Map();\r\n            // ============场景中固定显示ui\r\n            if (this.worldService.game.device.os.desktop) {\r\n                this.mMedMap.set(_baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_13__["BagGroupMediator"].NAME, new _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_13__["BagGroupMediator"](this.worldService, scene));\r\n            }\r\n            else {\r\n                // this.mMedMap.set(TopMediator.NAME, new TopMediator(this.worldService, scene));\r\n                this.mMedMap.set(_baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__["LeftMediator"].NAME, new _baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__["LeftMediator"](this.worldService, scene));\r\n                this.mMedMap.set(_baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__["RightMediator"].NAME, new _baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__["RightMediator"](this.worldService, scene));\r\n                this.mMedMap.set(_baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__["BottomMediator"].NAME, new _baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__["BottomMediator"](this.worldService, scene));\r\n            }\r\n            // this.mMedMap.set(UIMediatorType.MainUIMediator, new MainUIMediator(this.worldService, scene));\r\n            this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_2__["UIMediatorType"].BagMediator, new _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"](this.mUILayerManager, this.worldService, scene));\r\n            if (this.worldService.game.device.os.desktop)\r\n                this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_2__["UIMediatorType"].ChatMediator, new _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_3__["ChatMediator"](this.worldService, scene));\r\n            this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_2__["UIMediatorType"].NOTICE, new _Notice_NoticeMediator__WEBPACK_IMPORTED_MODULE_5__["NoticeMediator"](this.mUILayerManager, scene, this.worldService));\r\n            this.mMedMap.set(_friend_friend_mediator__WEBPACK_IMPORTED_MODULE_7__["FriendMediator"].NAME, new _friend_friend_mediator__WEBPACK_IMPORTED_MODULE_7__["FriendMediator"](scene, this.worldService));\r\n            this.mMedMap.set(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"].name, new _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"](scene, this.worldService));\r\n            // this.mMedMap.set(DebugLoggerMediator.NAME, new DebugLoggerMediator(scene, this.worldService));\r\n            // this.mMedMap.set(ElementStorageMediator.NAME, new ElementStorageMediator(this.mUILayerManager, scene, this.worldService));\r\n            for (var _i = 0, _a = this.mCache; _i < _a.length; _i++) {\r\n                var tmp = _a[_i];\r\n                var ui = tmp[0];\r\n                this.showMed(ui.name, ui);\r\n            }\r\n            this.mCache.length = 0;\r\n        }\r\n        // TOOD 通过统一的方法创建打开\r\n        this.mMedMap.forEach(function (mediator, key) {\r\n            var map;\r\n            var deskBoo = _this.worldService.game.device.os.desktop ? true : false;\r\n            switch (key) {\r\n                case _baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__["LeftMediator"].NAME:\r\n                case _baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__["RightMediator"].NAME:\r\n                case _baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__["BottomMediator"].NAME:\r\n                    map = _this.mBaseUIMap;\r\n                    break;\r\n                // case TopMediator.NAME:\r\n                //     if (deskBoo) {\r\n                //         map = this.mBaseUIMap;\r\n                //     }\r\n                //     break;\r\n                case _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_13__["BagGroupMediator"].NAME:\r\n                    if (deskBoo) {\r\n                        map = _this.mBaseUIMap;\r\n                    }\r\n                    break;\r\n                case _ui_mediatorType__WEBPACK_IMPORTED_MODULE_2__["UIMediatorType"].ChatMediator:\r\n                    if (deskBoo) {\r\n                        map = _this.mBaseUIMap;\r\n                    }\r\n                    break;\r\n                case _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_9__["RankMediator"].NAME:\r\n                    if (deskBoo) {\r\n                        map = _this.mBaseUIMap;\r\n                    }\r\n                    break;\r\n            }\r\n            if (map)\r\n                map.set(key, mediator);\r\n            if (mediator.isSceneUI()) {\r\n                mediator.show();\r\n            }\r\n        });\r\n    };\r\n    UiManager.prototype.showDecorateUI = function () {\r\n        if (!this.mScene) {\r\n            this.mCacheUI = this.showDecorateUI;\r\n            return;\r\n        }\r\n        this.clearMediator();\r\n        if (!this.mMedMap) {\r\n            this.mMedMap = new Map();\r\n        }\r\n        var topMenu = new _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"](this.mScene, this.worldService);\r\n        this.mMedMap.set(_ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__["ElementStorageMediator"].NAME, new _ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__["ElementStorageMediator"](this.mUILayerManager, this.mScene, this.worldService));\r\n        this.mMedMap.set(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"].name, topMenu);\r\n        topMenu.addItem({\r\n            key: "Turn_Btn_Top", name: "SaveDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.showAll();\r\n    };\r\n    UiManager.prototype.resize = function (width, height) {\r\n        if (this.mMedMap) {\r\n            this.mMedMap.forEach(function (mediator) {\r\n                if (mediator.isShow)\r\n                    mediator.resize();\r\n            });\r\n        }\r\n    };\r\n    UiManager.prototype.setMediator = function (value, mediator) {\r\n        this.mMedMap.set(value, mediator);\r\n    };\r\n    UiManager.prototype.getMediator = function (type) {\r\n        if (!this.mMedMap)\r\n            return;\r\n        return this.mMedMap.get(type);\r\n    };\r\n    UiManager.prototype.clearMediator = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) { return med.destroy(); });\r\n        this.mMedMap.clear();\r\n    };\r\n    UiManager.prototype.destroy = function () {\r\n        this.removePackListener();\r\n        this.clearMediator();\r\n        this.mMedMap = undefined;\r\n        this.mScene = undefined;\r\n    };\r\n    UiManager.prototype.baseFaceResize = function () {\r\n        var bottomMed = this.getMediator(_baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__["BottomMediator"].NAME);\r\n        var rightMed = this.getMediator(_baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__["RightMediator"].NAME);\r\n        var leftMed = this.getMediator(_baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__["LeftMediator"].NAME);\r\n        // const topMed = this.getMediator(TopMediator.NAME);\r\n        if (rightMed && rightMed.getView())\r\n            rightMed.getView().resize(0, 0);\r\n        if (leftMed && leftMed.getView())\r\n            leftMed.getView().resize(0, 0);\r\n        if (bottomMed && bottomMed.getView())\r\n            bottomMed.getView().resize(0, 0);\r\n        // if (topMed && topMed.getView()) topMed.getView().resize(0, 0);\r\n    };\r\n    UiManager.prototype.baseFaceTween = function (show) {\r\n        // if (!this.worldService.game.device.os.desktop) {\r\n        //     (this.worldService.inputManager as JoyStickManager).tweenView(show);\r\n        // }\r\n        var rightMed = this.getMediator(_baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_10__["RightMediator"].NAME);\r\n        var leftMed = this.getMediator(_baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_11__["LeftMediator"].NAME);\r\n        var bottomMed = this.getMediator(_baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_12__["BottomMediator"].NAME);\r\n        // const topMed = this.getMediator(TopMediator.NAME);\r\n        if (rightMed && rightMed.getView())\r\n            rightMed.getView().tweenView(show);\r\n        if (leftMed && leftMed.getView())\r\n            leftMed.getView().tweenView(show);\r\n        if (bottomMed && bottomMed.getView())\r\n            bottomMed.getView().tweenView(show);\r\n        // if (topMed && topMed.getView()) topMed.getView().tweenView(show);\r\n    };\r\n    UiManager.prototype.checkUIState = function (medName, show) {\r\n        var mediator = this.mMedMap.get(medName);\r\n        if (!mediator)\r\n            return;\r\n        var uiType = mediator.getUIType();\r\n        var deskBoo = this.worldService.game.device.os.desktop;\r\n        var map;\r\n        switch (uiType) {\r\n            case 0 /* NoneUIType */:\r\n                map = this.mNoneUIMap;\r\n                break;\r\n            case 1 /* BaseUIType */:\r\n                map = this.mBaseUIMap;\r\n                break;\r\n            case 2 /* NormalUIType */:\r\n                map = this.mNormalUIMap;\r\n                // pc端场景ui无需收进，但是功能ui可以共存，需要调整位置\r\n                if (deskBoo) {\r\n                    this.checkNormalUITween(show, medName);\r\n                }\r\n                else {\r\n                    this.checkBaseUImap(show);\r\n                }\r\n                break;\r\n            case 4 /* MonopolyUIType */:\r\n                map = this.mMonopolyUIMap;\r\n                this.checkBaseUImap(show);\r\n                this.checkNormalUImap(show);\r\n                this.chekcTipUImap(show);\r\n                break;\r\n            case 3 /* TipsUIType */:\r\n                map = this.mTipUIMap;\r\n                break;\r\n        }\r\n        map.set(medName, mediator);\r\n    };\r\n    UiManager.prototype.handleShowUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.showMed(ui.name, ui);\r\n    };\r\n    UiManager.prototype.handleUpdateUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.updateMed(ui.name, ui);\r\n    };\r\n    UiManager.prototype.handleCloseUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.hideMed(ui.name);\r\n    };\r\n    UiManager.prototype.onEnableEditMode = function (packet) {\r\n        var topMenu = this.mMedMap.get(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"].name);\r\n        if (!topMenu) {\r\n            topMenu = new _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"](this.mScene, this.worldService);\r\n            this.mMedMap.set(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_14__["TopMenuMediator"].name, topMenu);\r\n        }\r\n        topMenu.addItem({\r\n            key: "Turn_Btn_Top", name: "EnterDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n    };\r\n    UiManager.prototype.showMed = function (type) {\r\n        var param = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            param[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this.mMedMap) {\r\n            this.mCache.push(param);\r\n            return;\r\n        }\r\n        var className = type + "Mediator";\r\n        var mediator = this.mMedMap.get(className);\r\n        if (!mediator) {\r\n            var path = "./" + type + "/" + type + "Mediator";\r\n            var ns = __webpack_require__("./src/ui sync recursive ^\\\\.\\\\/.*$")("./" + type + "/" + className);\r\n            mediator = new ns[className](this.mUILayerManager, this.mScene, this.worldService);\r\n            if (!mediator) {\r\n                // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n                return;\r\n            }\r\n            this.mMedMap.set(type + "Mediator", mediator);\r\n            // mediator.setName(type);\r\n        }\r\n        // if (mediator.showing) return;\r\n        if (param)\r\n            mediator.setParam(param);\r\n        // if (className === "RankMediator") {\r\n        //     if (!this.worldService.game.device.os.desktop) {\r\n        //         const med: TopMediator = this.getMediator(TopMediator.NAME) as TopMediator;\r\n        //         if (med) {\r\n        //             if (!med.isShow()) {\r\n        //                 med.preRefreshBtn(className);\r\n        //             } else {\r\n        //                 med.refreshBtn(className, true);\r\n        //             }\r\n        //         }\r\n        //         return;\r\n        //     }\r\n        // }\r\n        this.checkUIState(className, false);\r\n        mediator.show(param);\r\n    };\r\n    UiManager.prototype.checkBaseUImap = function (show) {\r\n        this.mBaseUIMap.forEach(function (med) {\r\n            if (med)\r\n                med.tweenView(show);\r\n        });\r\n    };\r\n    UiManager.prototype.checkNormalUITween = function (show, medName) {\r\n        var size = this.worldService.getSize();\r\n        var len = this.mShowuiList.length;\r\n        var tmpName;\r\n        var med;\r\n        if (!show) {\r\n            if (this.mShowuiList.indexOf(medName) === -1)\r\n                this.mShowuiList.push(medName);\r\n            len = this.mShowuiList.length;\r\n            var mPad = len > 1 ? size.width / 3 : 0;\r\n            for (var i = 0; i < len; i++) {\r\n                tmpName = this.mShowuiList[i];\r\n                med = this.mMedMap.get(tmpName);\r\n                if (len > 2 && i === 0) {\r\n                    med.hide();\r\n                }\r\n                else {\r\n                    med.setViewAdd((i * 2 - 1) * mPad, 0);\r\n                }\r\n            }\r\n            if (len > 2)\r\n                this.mShowuiList.shift();\r\n        }\r\n        else {\r\n            var index = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                tmpName = this.mShowuiList[i];\r\n                med = this.mMedMap.get(tmpName);\r\n                if (tmpName === medName) {\r\n                    index = i;\r\n                    continue;\r\n                }\r\n                med.setViewAdd(0, 0);\r\n            }\r\n            this.mShowuiList.splice(index, 1);\r\n        }\r\n    };\r\n    UiManager.prototype.checkNormalUImap = function (show) {\r\n        this.mNormalUIMap.forEach(function (med) {\r\n            if (med) {\r\n                if (show) {\r\n                    // med.show();\r\n                }\r\n                else {\r\n                    med.hide();\r\n                }\r\n            }\r\n        });\r\n        if (!show)\r\n            this.mNormalUIMap.clear();\r\n    };\r\n    UiManager.prototype.chekcTipUImap = function (show) {\r\n        this.mTipUIMap.forEach(function (med) {\r\n            if (med) {\r\n                if (show) {\r\n                    // med.show();\r\n                }\r\n                else {\r\n                    med.hide();\r\n                }\r\n            }\r\n        });\r\n        if (!show)\r\n            this.mNormalUIMap.clear();\r\n    };\r\n    UiManager.prototype.updateMed = function (type) {\r\n        var param = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            param[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        var name = type + "Mediator";\r\n        var mediator = this.mMedMap.get(name);\r\n        if (!mediator) {\r\n            // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n            return;\r\n        }\r\n        if (param)\r\n            mediator.setParam(param);\r\n        mediator.update(param);\r\n    };\r\n    UiManager.prototype.hideMed = function (type) {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        var medName = type + "Mediator";\r\n        var mediator = this.mMedMap.get(medName);\r\n        if (!mediator) {\r\n            // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n            return;\r\n        }\r\n        // if (!this.worldService.game.device.os.desktop && medName === "RankMediator") {\r\n        //     const med: TopMediator = this.getMediator(TopMediator.NAME) as TopMediator;\r\n        //     if (med) {\r\n        //         if (!med.isShow()) {\r\n        //             med.preRefreshBtn(medName);\r\n        //         } else {\r\n        //             med.refreshBtn(medName, true);\r\n        //         }\r\n        //     }\r\n        // }\r\n        // if (!mediator.isShow()) return;\r\n        this.checkUIState(medName, true);\r\n        mediator.hide();\r\n    };\r\n    UiManager.prototype.showAll = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) { return med.show(); });\r\n    };\r\n    UiManager.prototype.closeAll = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) { return med.hide(); });\r\n    };\r\n    return UiManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ui.manager.ts?')},"./src/ui/ui.mediatorType.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIMediatorType", function() { return UIMediatorType; });\nvar UIMediatorType = /** @class */ (function () {\r\n    function UIMediatorType() {\r\n    }\r\n    UIMediatorType.BagMediator = "BagMediator"; // 角色背包\r\n    UIMediatorType.ChatMediator = "ChatMediator"; // 场景聊天框\r\n    UIMediatorType.NOTICE = "Notice";\r\n    UIMediatorType.DIALOGO = "DIALOGO";\r\n    UIMediatorType.Turn_Btn_Top = "Turn_Btn_Top";\r\n    UIMediatorType.Turn_Btn_Bottom = "Turn_Btn_Bottom";\r\n    UIMediatorType.App_Back = "App_Back";\r\n    UIMediatorType.Editor_Save = "Editor_Save";\r\n    UIMediatorType.Editor_Cancel = "Editor_Cancel";\r\n    UIMediatorType.Close_Btn = "Close_Btn";\r\n    UIMediatorType.ControlF = "ControlF"; // 展示框\r\n    UIMediatorType.Storage = "Storage"; // 物件背包\r\n    UIMediatorType.UserInfo = "UserInfo"; // 人物信息\r\n    UIMediatorType.UserMenu = "UserMenu"; // 人物菜单\r\n    UIMediatorType.MessageBox = "MessageBox"; // 消息框\r\n    UIMediatorType.ComponentRank = "ComponentRank"; // 常驻固定排行榜\r\n    UIMediatorType.Rank = "Rank"; // 排行榜\r\n    UIMediatorType.VoteResult = "VoteResult"; // 投票界面\r\n    UIMediatorType.Shop = "Shop"; // 内购商城\r\n    return UIMediatorType;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ui.mediatorType.ts?')},"./src/utils/algorithm.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Algorithm", function() { return Algorithm; });\nvar Algorithm = /** @class */ (function () {\r\n    function Algorithm() {\r\n    }\r\n    Algorithm.median = function (arr) {\r\n        var op_arr = arr.sort(function (x, y) {\r\n            return y - x;\r\n        });\r\n        var med = Math.floor(op_arr.length / 2);\r\n        if (op_arr.length % 2 === 0) {\r\n            var h = op_arr[med - 1], l = op_arr[med];\r\n            return (h + l) / 2;\r\n        }\r\n        return op_arr[med];\r\n    };\r\n    return Algorithm;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/algorithm.ts?')},"./src/utils/font.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Font", function() { return Font; });\nvar Font = /** @class */ (function () {\r\n    function Font() {\r\n    }\r\n    Font.YAHEI_14_BOLD = "bold 14px YaHei";\r\n    Font.YAHEI_16_BOLD = "bold 16px YaHei";\r\n    Font.YAHEI_18_BOLD = "bold 18px YaHei";\r\n    Font.YAHEI_20_BOLD = "bold 20px YaHei";\r\n    return Font;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/font.ts?')},"./src/utils/helpers.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var chance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! chance */ "./node_modules/chance/chance.js");\n/* harmony import */ var chance__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(chance__WEBPACK_IMPORTED_MODULE_0__);\n\r\nvar Helpers = /** @class */ (function () {\r\n    function Helpers() {\r\n    }\r\n    Helpers.genId = function () {\r\n        return new chance__WEBPACK_IMPORTED_MODULE_0__().natural({\r\n            min: 10000,\r\n            max: Helpers.MAX_ID\r\n        });\r\n    };\r\n    Helpers.MAX_ID = Math.pow(2, 31);\r\n    return Helpers;\r\n}());\r\n/* harmony default export */ __webpack_exports__["default"] = (Helpers);\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/helpers.ts?')},"./src/utils/http.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "load", function() { return load; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "checkIsFriend", function() { return checkIsFriend; });\nfunction load(path, responseType) {\r\n    return new Promise(function (resolve, reject) {\r\n        var http = new XMLHttpRequest();\r\n        http.onload = function (response) {\r\n            resolve(response.currentTarget);\r\n        };\r\n        http.onerror = function () {\r\n            // Logger.getInstance().warn(`${path} load error`);\r\n            reject(path + " load error");\r\n        };\r\n        http.open("GET", path);\r\n        http.responseType = responseType || "";\r\n        http.send();\r\n    });\r\n}\r\nfunction checkIsFriend(uids) {\r\n    var data = {\r\n        body: JSON.stringify({ uids: uids }),\r\n        method: "POST",\r\n        headers: {\r\n            "X-Pixelpai-TK": ""\r\n        }\r\n    };\r\n    return fetch("http://172.18.0.100:17170/" + "/user/check_followed", data);\r\n}\r\nfunction get(input, init) {\r\n    return fetch(input, init);\r\n}\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/http.ts?')},"./src/utils/log.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return Logger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "log", function() { return log; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "error", function() { return error; });\n/* tslint:disable */\r\nvar Logger = /** @class */ (function () {\r\n    function Logger() {\r\n        this.mErrorList = [];\r\n        this.mWarnList = [];\r\n    }\r\n    Logger.getInstance = function () {\r\n        if (!Logger._instance)\r\n            Logger._instance = new Logger();\r\n        return Logger._instance;\r\n    };\r\n    Logger.prototype.log = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        console.log.apply(console, [message].concat(optionalParams));\r\n    };\r\n    Logger.prototype.error = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        console.error.apply(console, [message].concat(optionalParams));\r\n        this.mErrorList.push(message);\r\n    };\r\n    Logger.prototype.warn = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        console.warn.apply(console, [message].concat(optionalParams));\r\n        this.mWarnList.push(message);\r\n    };\r\n    Logger.prototype.debug = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        console.log.apply(console, [message].concat(optionalParams));\r\n    };\r\n    Logger.prototype.info = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        console.info.apply(console, [message].concat(optionalParams));\r\n    };\r\n    Logger.prototype.getErrorList = function () {\r\n        return this.mErrorList;\r\n    };\r\n    Logger.prototype.getWarnList = function () {\r\n        return this.mWarnList;\r\n    };\r\n    return Logger;\r\n}());\r\n\r\nfunction log(message) {\r\n    var optionalParams = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        optionalParams[_i - 1] = arguments[_i];\r\n    }\r\n    console.log.apply(console, [message].concat(optionalParams));\r\n}\r\nfunction error(message) {\r\n    var optionalParams = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        optionalParams[_i - 1] = arguments[_i];\r\n    }\r\n    console.error.apply(console, [message].concat(optionalParams));\r\n}\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/log.ts?')},"./src/utils/pos.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Pos", function() { return Pos; });\nvar Pos = /** @class */ (function () {\r\n    function Pos(x, y, z, depth) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        this.z = z || 0;\r\n        this.depth = depth | 0;\r\n    }\r\n    Pos.prototype.add = function (x, y, z) {\r\n        this.x += x;\r\n        this.x += y;\r\n        this.z += z ? z : 0;\r\n        return this;\r\n    };\r\n    Pos.prototype.equal = function (p) {\r\n        return p.x === this.x && p.y === this.y && p.z === this.z && p.depth === this.depth;\r\n    };\r\n    Pos.prototype.toString = function () {\r\n        return "Pos >> x: " + this.x + ", y: " + this.y + ", z: " + this.z + ", depth: " + this.depth;\r\n    };\r\n    Pos.prototype.toPoint = function () {\r\n        return new Phaser.Geom.Point(this.x, this.y);\r\n    };\r\n    return Pos;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/pos.ts?')},"./src/utils/position45.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Position45", function() { return Position45; });\n/* harmony import */ var _pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pos */ "./src/utils/pos.ts");\n\r\nvar Position45 = /** @class */ (function () {\r\n    function Position45() {\r\n    }\r\n    Position45.transformTo90 = function (point, position) {\r\n        var offsetX = position.rows * (position.tileWidth / 2); // + position.tileWidth / 2;\r\n        return new _pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]((point.x - point.y) * (position.tileWidth / 2) + offsetX, ((point.x + point.y)) * (position.tileHeight / 2));\r\n    };\r\n    Position45.transformTo45 = function (point3, position) {\r\n        var offsetX = position.rows * (position.tileWidth / 2);\r\n        // const offsetX = position.sceneWidth / 2; // - position.tileWidth / 2;\r\n        return new _pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](Math.floor((point3.y + point3.z) / position.tileHeight + (point3.x - offsetX) / position.tileWidth), Math.floor((point3.y + point3.z) / position.tileHeight - (point3.x - offsetX) / position.tileWidth));\r\n    };\r\n    return Position45;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/position45.ts?')},"./src/utils/rectangle45.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Rectangle45", function() { return Rectangle45; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Rectangle = Phaser.Geom.Rectangle;\r\nvar Rectangle45 = /** @class */ (function (_super) {\r\n    __extends(Rectangle45, _super);\r\n    function Rectangle45(row, col, endRow, endCol) {\r\n        var _this = _super.call(this, row, col, endRow, endCol) || this;\r\n        _this.row = row;\r\n        _this.col = col;\r\n        _this.endRow = endRow;\r\n        _this.endCol = endCol;\r\n        return _this;\r\n    }\r\n    return Rectangle45;\r\n}(Rectangle));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/rectangle45.ts?')},"./src/utils/resUtil.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Url", function() { return Url; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResUtils", function() { return ResUtils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlackButton", function() { return BlackButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlueButton", function() { return BlueButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WhiteButton", function() { return WhiteButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CloseButton", function() { return CloseButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Background", function() { return Background; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Border", function() { return Border; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TransparentButton", function() { return TransparentButton; });\n/* harmony import */ var _const_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const/constants */ "./src/const/constants.ts");\n\r\nvar Url = /** @class */ (function () {\r\n    function Url() {\r\n    }\r\n    Url.getRes = function (value) {\r\n        // 资源地址根路径 CONFIG.BUNDLE_RESOURCES_ROOT\r\n        if (Object({"api_root":"http://172.18.0.100:17170/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"172.18.0.100","port":12100,"secure":false}),"game_id":"5e1d81163bcc774a3c172e94","virtual_world_id":"65533"}).BUNDLE_RESOURCES_ROOT) {\r\n            return Object({"api_root":"http://172.18.0.100:17170/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"172.18.0.100","port":12100,"secure":false}),"game_id":"5e1d81163bcc774a3c172e94","virtual_world_id":"65533"}).BUNDLE_RESOURCES_ROOT\r\n                + value;\r\n        }\r\n        return "./resources/" + value;\r\n    };\r\n    Url.getOsdRes = function (value) {\r\n        if (Url.OSD_PATH) {\r\n            if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(Url.OSD_PATH)) {\r\n                return Url.OSD_PATH + value;\r\n            }\r\n            return "https://osd.tooqing.com/" + value;\r\n        }\r\n        return value;\r\n    };\r\n    Url.OSD_PATH = "";\r\n    return Url;\r\n}());\r\n\r\nvar ResUtils = /** @class */ (function () {\r\n    function ResUtils() {\r\n    }\r\n    ResUtils.getPartName = function (value) {\r\n        return value + "_png";\r\n    };\r\n    ResUtils.getPartUrl = function (value) {\r\n        // TOOD 编辑器或调式会传入本地资源。Avatar资源只存在cdn\r\n        if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(Url.OSD_PATH)) {\r\n            return Url.OSD_PATH + "avatar/part/" + value + ".png";\r\n        }\r\n        return "https://osd.tooqing.com/" + "avatar/part/" + value + ".png";\r\n    };\r\n    ResUtils.getGameConfig = function (value) {\r\n        if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(value)) {\r\n            return value;\r\n        }\r\n        return Url.OSD_PATH + value;\r\n    };\r\n    return ResUtils;\r\n}());\r\n\r\nvar BlackButton = /** @class */ (function () {\r\n    function BlackButton() {\r\n    }\r\n    BlackButton.getName = function () {\r\n        return "black_button";\r\n    };\r\n    BlackButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button.png");\r\n    };\r\n    BlackButton.getColumns = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    BlackButton.getRows = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    BlackButton.getConfig = function () {\r\n        return {\r\n            top: 4,\r\n            left: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return BlackButton;\r\n}());\r\n\r\nvar BlueButton = /** @class */ (function () {\r\n    function BlueButton() {\r\n    }\r\n    BlueButton.getName = function () {\r\n        return "button_blue";\r\n    };\r\n    BlueButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_blue.png");\r\n    };\r\n    BlueButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_blue.json");\r\n    };\r\n    BlueButton.getColumns = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    BlueButton.getRows = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    BlueButton.getConfig = function () {\r\n        return {\r\n            left: 7,\r\n            top: 7,\r\n            right: 7,\r\n            bottom: 7\r\n        };\r\n    };\r\n    return BlueButton;\r\n}());\r\n\r\nvar WhiteButton = /** @class */ (function () {\r\n    function WhiteButton() {\r\n    }\r\n    WhiteButton.getName = function () {\r\n        return "button_white";\r\n    };\r\n    WhiteButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_white.png");\r\n    };\r\n    WhiteButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_white.json");\r\n    };\r\n    WhiteButton.getColumns = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    WhiteButton.getRows = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    WhiteButton.getConfig = function () {\r\n        return {\r\n            left: 7,\r\n            top: 7,\r\n            right: 7,\r\n            bottom: 7\r\n        };\r\n    };\r\n    return WhiteButton;\r\n}());\r\n\r\nvar CloseButton = /** @class */ (function () {\r\n    function CloseButton() {\r\n    }\r\n    CloseButton.getName = function () {\r\n        return "common_clsBtn";\r\n    };\r\n    CloseButton.getPNG = function () {\r\n        return Url.getRes("ui/common/common_clsBtn.png");\r\n    };\r\n    CloseButton.getJSON = function () {\r\n        return Url.getRes("ui/common/common_clsBtn.json");\r\n    };\r\n    CloseButton.getFrameConfig = function () {\r\n        return { frameWidth: 16, frameHeight: 16, startFrame: 1, endFrame: 3 };\r\n    };\r\n    return CloseButton;\r\n}());\r\n\r\nvar Background = /** @class */ (function () {\r\n    function Background() {\r\n    }\r\n    Background.getName = function () {\r\n        return "common_background";\r\n    };\r\n    Background.getPNG = function () {\r\n        return Url.getRes("ui/common/common_panelBg.png");\r\n    };\r\n    Background.getColumns = function () {\r\n        return [11, 9, 11];\r\n    };\r\n    Background.getRows = function () {\r\n        return [14, 13, 14];\r\n    };\r\n    Background.getConfig = function () {\r\n        return {\r\n            left: 10,\r\n            top: 15,\r\n            right: 10,\r\n            bottom: 15,\r\n        };\r\n    };\r\n    return Background;\r\n}());\r\n\r\nvar Border = /** @class */ (function () {\r\n    function Border() {\r\n    }\r\n    Border.getName = function () {\r\n        return "common_border";\r\n    };\r\n    Border.getPNG = function () {\r\n        return Url.getRes("ui/common/common_border.png");\r\n    };\r\n    Border.getColumns = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    Border.getRows = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    Border.getConfig = function () {\r\n        return {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return Border;\r\n}());\r\n\r\nvar TransparentButton = /** @class */ (function () {\r\n    function TransparentButton() {\r\n    }\r\n    TransparentButton.getName = function () {\r\n        return "button_transparent";\r\n    };\r\n    TransparentButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_transparent.png");\r\n    };\r\n    TransparentButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_transparent.json");\r\n    };\r\n    TransparentButton.getConfig = function () {\r\n        return {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return TransparentButton;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/resUtil.ts?')},"./src/utils/size.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Size", function() { return Size; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Size = /** @class */ (function (_super) {\r\n    __extends(Size, _super);\r\n    function Size(width, height) {\r\n        return _super.call(this, width, height) || this;\r\n    }\r\n    return Size;\r\n}(Phaser.Structs.Size));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/size.ts?')},"./src/utils/tool.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Tool", function() { return Tool; });\nvar Tool = /** @class */ (function () {\r\n    function Tool() {\r\n    }\r\n    /*\r\n    * 两点之间距离公式\r\n    */\r\n    Tool.twoPointDistance = function (p1, p2) {\r\n        var dis = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.y - p2.y), 2));\r\n        return dis;\r\n    };\r\n    Tool.formatChineseString = function (context, fontSize, lineWidth) {\r\n        if (typeof fontSize === "string")\r\n            fontSize = parseInt(fontSize, 10);\r\n        var wrapWidth = Math.floor(lineWidth / fontSize);\r\n        return this.chunk(context, wrapWidth).join(" ");\r\n    };\r\n    Tool.checkChinese = function (name) {\r\n        var pattern = /[\\u4e00-\\u9fa5]+/;\r\n        var arr = name.split("");\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            if (pattern.test(arr[i])) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Tool.checkItemName = function (name, checkStr) {\r\n        var checkStrList = checkStr.split("") || [];\r\n        var checkBoo = false;\r\n        checkStrList.forEach(function (str) {\r\n            if (str) {\r\n                var pattern = new RegExp(str);\r\n                var arr = name.split("");\r\n                for (var i = 0, len = arr.length; i < len; i++) {\r\n                    if (pattern.test(arr[i])) {\r\n                        checkBoo = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return checkBoo;\r\n    };\r\n    Tool.chunk = function (str, n) {\r\n        var result = [];\r\n        for (var i = 0; i < str.length; i += n) {\r\n            result.push(str.substr(i, n));\r\n        }\r\n        return result;\r\n    };\r\n    return Tool;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/tool.ts?')}}]);