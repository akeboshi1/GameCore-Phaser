(this.webpackJsonp_name_=this.webpackJsonp_name_||[]).push([[1],[function(t,e,i){"use strict";var n=i(63);i.d(e,"HTTP_REGEX",(function(){return n.a}));var a=i(86);i.d(e,"DisplayField",(function(){return a.a})),i.d(e,"TitleMask",(function(){return a.b}));var s=i(45);i.d(e,"MessageType",(function(){return s.a}));var o=i(87);i.d(e,"SceneName",(function(){return o.a}));var h=i(88);i.d(e,"Fit",(function(){return h.a}));var l=i(30);i.d(e,"RENDER_PEER",(function(){return l.e})),i.d(e,"MAIN_WORKER",(function(){return l.a})),i.d(e,"MAIN_WORKER_URL",(function(){return l.b})),i.d(e,"PHYSICAL_WORKER",(function(){return l.c})),i.d(e,"PHYSICAL_WORKER_URL",(function(){return l.d}));var c=i(89);i.d(e,"EventType",(function(){return c.a}));var p=i(90);i.d(e,"ModuleName",(function(){return p.a}));var d=i(64);i.d(e,"FriendRelationEnum",(function(){return d.b})),i.d(e,"FriendChannel",(function(){return d.a}));var u=i(91);i.d(e,"ChineseUnit",(function(){return u.a}));var m=i(92);i.d(e,"TimerCountDown",(function(){return m.a}));var f=i(46);i.d(e,"AvatarSuitType",(function(){return f.a})),i.d(e,"SuitAlternativeType",(function(){return f.b}));var y=i(95);i.d(e,"ElementStateType",(function(){return y.a}));var g=i(96);i.d(e,"LoadState",(function(){return g.a})),i.d(e,"PlaySceneLoadState",(function(){return g.b}));var P=i(39);i.d(e,"GameState",(function(){return P.a})),i.d(e,"PlayerState",(function(){return P.b}));var _=i(97);i.o(_,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return _.AnimationModel})),i.o(_,"Animator")&&i.d(e,"Animator",(function(){return _.Animator})),i.o(_,"RoomType")&&i.d(e,"RoomType",(function(){return _.RoomType}));var v=i(98);i.o(v,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return v.AnimationModel})),i.o(v,"Animator")&&i.d(e,"Animator",(function(){return v.Animator})),i.o(v,"RoomType")&&i.d(e,"RoomType",(function(){return v.RoomType}));var b=i(34);i.d(e,"AnimationModel",(function(){return b.a}));var T=i(99);i.o(T,"Animator")&&i.d(e,"Animator",(function(){return T.Animator})),i.o(T,"RoomType")&&i.d(e,"RoomType",(function(){return T.RoomType}));var S=i(100);i.d(e,"Animator",(function(){return S.a}));var x=i(101);i.o(x,"RoomType")&&i.d(e,"RoomType",(function(){return x.RoomType}));var w=i(102);i.d(e,"RoomType",(function(){return w.a}))},,function(t,e,i){"use strict";var n=i(17);i.d(e,"i18n",(function(){return n.a}));var a=i(14);i.d(e,"Font",(function(){return a.a}));var s=i(44);i.d(e,"Background",(function(){return s.a})),i.d(e,"Border",(function(){return s.b})),i.d(e,"Coin",(function(){return s.c})),i.d(e,"ResUtils",(function(){return s.d})),i.d(e,"UIHelper",(function(){return s.e})),i.d(e,"Url",(function(){return s.f}));var o=i(50);i.d(e,"Handler",(function(){return o.a}));var h=i(26);i.d(e,"Logger",(function(){return h.a}));var l=i(103);i.d(e,"Direction",(function(){return l.a}));var c=i(104);i.d(e,"LogicPoint",(function(){return c.a}));var p=i(27);i.d(e,"LogicPos",(function(){return p.a}));var d=i(105);i.d(e,"Tool",(function(){return d.a}));var u=i(65);i.d(e,"load",(function(){return u.a})),i.d(e,"loadArr",(function(){return u.b}));i(106);var m=i(52);i.d(e,"LogicRectangle",(function(){return m.a}));var f=i(107);i.d(e,"LogicRectangle45",(function(){return f.a}));var y=i(33);i.d(e,"Position45",(function(){return y.a}));i(108);var g=i(109);i.d(e,"Intersects",(function(){return g.a})),i.d(e,"initLocales",(function(){return n.b}));var P=i(51);i.d(e,"Pos",(function(){return P.a}));var _=i(110);i.d(e,"Size",(function(){return _.a}));var v=i(111);i.d(e,"Helpers",(function(){return v.a}));var b=i(112);i.d(e,"EventDispatcher",(function(){return b.a}));var T=i(113);i.d(e,"Color",(function(){return T.a}));var S=i(114);i.d(e,"CopyProtoType",(function(){return S.a}));var x=i(115);i.d(e,"ValueResolver",(function(){return x.a}));var w=i(116);i.o(w,"AStar")&&i.d(e,"AStar",(function(){return w.AStar})),i.o(w,"ObjectAssign")&&i.d(e,"ObjectAssign",(function(){return w.ObjectAssign})),i.o(w,"StringUtils")&&i.d(e,"StringUtils",(function(){return w.StringUtils})),i.o(w,"TimeUtils")&&i.d(e,"TimeUtils",(function(){return w.TimeUtils}));var D=i(117);i.d(e,"AStar",(function(){return D.a}));var C=i(119);i.d(e,"TimeUtils",(function(){return C.a}));var I=i(120);i.d(e,"StringUtils",(function(){return I.a}));var k=i(121);i.d(e,"ObjectAssign",(function(){return k.a}))},,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Font(){}return Font.isChineseChar=function(t){return!!new RegExp("[一-龥]+").test(t)},Font.isEnglishChar=function(t){return!!new RegExp("[A-Za-z]+").test(t)},Font.isNumberChar=function(t){return!!new RegExp("[0-9]+").test(t)},Font.YAHEI_14_BOLD="bold 14px YaHei",Font.YAHEI_16_BOLD="bold 16px YaHei",Font.YAHEI_18_BOLD="bold 18px YaHei",Font.YAHEI_20_BOLD="bold 20px YaHei",Font.DEFULT_FONT="Helvetica, 'Source Han Sans', -apple-system, 'Noto Sans', 'Helvetica Neue', 'Nimbus Sans L', Arial, 'Liberation Sans', 'PingFang SC', 'Hiragino Sans GB', 'Noto Sans CJK SC', 'Source Han Sans SC', 'Source Han Sans CN', 'Microsoft YaHei'",Font.ZH_MAIN="Source Han Sans",Font.EN_MAINT="tt0503m_",Font.EN_BOLD="tt0173m_",Font.NUMBER="t04B25",Font.HELVETICA="Helvetica",Font}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"m",(function(){return c})),i.d(e,"f",(function(){return a})),i.d(e,"g",(function(){return p})),i.d(e,"j",(function(){return f})),i.d(e,"b",(function(){return g})),i.d(e,"c",(function(){return v})),i.d(e,"d",(function(){return T})),i.d(e,"h",(function(){return x})),i.d(e,"l",(function(){return I})),i.d(e,"i",(function(){return k})),i.d(e,"k",(function(){return B})),i.d(e,"e",(function(){return E.a}));var n,a,s=i(2),o=function(){function BaseCamerasManager(){this.zoom=1,this.mCameras=[]}return BaseCamerasManager.prototype.checkContains=function(t){var e=this.mMain.worldView;return!e&&e.contains(t.x,t.y)},BaseCamerasManager.prototype.startRoomPlay=function(t){this.mMain=t.cameras.main},BaseCamerasManager.prototype.pan=function(t,e,i){var n=this;t*=this.zoom,e*=this.zoom;for(var a=0,s=this.mCameras;a<s.length;a++){s[a].pan(t,e,i)}return new Promise((function(t,e){n.mMain.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){t()}))}))},BaseCamerasManager.prototype.resize=function(t,e){},BaseCamerasManager.prototype.setScroll=function(t,e){if(this.mMain){t-=.5*this.mMain.width,e-=.5*this.mMain.height;for(var i=0,n=this.mCameras;i<n.length;i++){n[i].setScroll(t,e)}}},BaseCamerasManager.prototype.offsetScroll=function(t,e){if(this.mMain){for(var i=0,n=this.mCameras;i<n.length;i++){var a=n[i];a.scrollX+=t,a.scrollY+=e}this.moving=!0}},BaseCamerasManager.prototype.startFollow=function(t){if(this.mTarget=t,this.mMain&&t)for(var e=0,i=this.mCameras;e<i.length;e++){i[e].startFollow(t)}},BaseCamerasManager.prototype.stopFollow=function(){if(this.mTarget=null,this.mMain)for(var t=0,e=this.mCameras;t<e.length;t++){e[t].stopFollow()}},BaseCamerasManager.prototype.addCamera=function(t){-1===this.mCameras.indexOf(t)&&this.mCameras.push(t),this.mTarget&&t.startFollow(this.mTarget)},BaseCamerasManager.prototype.removeCamera=function(t){var e=this.mCameras.indexOf(t);e>-1&&this.mCameras.splice(e,1)},BaseCamerasManager.prototype.setBounds=function(t,e,i,n,a){if(this.mMain)for(var o=0,h=this.mCameras;o<h.length;o++){h[o].setBounds(t,e,i,n,a)}else s.Logger.getInstance().error("camera does not exist")},BaseCamerasManager.prototype.setPosition=function(t,e){if(this.mMain)for(var i=0,n=this.mCameras;i<n.length;i++){n[i].setPosition(t,e)}},BaseCamerasManager.prototype.scrollTargetPoint=function(t,e,i){this.mMain&&(this.stopFollow(),i?this.pan(t,e,1e3):this.setScroll(t,e))},BaseCamerasManager.prototype.destroy=function(){s.Logger.getInstance().log("camerasmanager destroy"),this.mMain=void 0,this.mTarget=void 0,this.mCameras=[]},Object.defineProperty(BaseCamerasManager.prototype,"moving",{get:function(){return this.mMoving},set:function(t){this.mMoving=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseCamerasManager.prototype,"targetFollow",{get:function(){return this.mTarget},enumerable:!1,configurable:!0}),Object.defineProperty(BaseCamerasManager.prototype,"camera",{get:function(){return this.mMain},set:function(t){this.mMain=t,this.addCamera(t)},enumerable:!1,configurable:!0}),BaseCamerasManager}(),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function BaseDisplay(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAlpha=1,e.mDirection=3,e.mCreated=!1,e.mSprites=new Map,e.mLoadDisplayPromise=null,e.mSortX=0,e.mSortY=0,e}return h(BaseDisplay,t),BaseDisplay.prototype.destroy=function(e){this.mSprites.forEach((function(t){return t.destroy()})),this.mSprites.clear(),this.parentContainer&&this.parentContainer.remove(this),t.prototype.destroy.call(this,e)},BaseDisplay.prototype.load=function(t){var e=this;return this.displayInfo=t,this.displayInfo?(this.mLoadDisplayPromise=new s.ValueResolver,this.mLoadDisplayPromise.promise((function(){e.scene.load.start()}))):Promise.reject("displayInfo error")},BaseDisplay.prototype.created=function(){this.mCreated=!0,this.createdHandler&&this.createdHandler.runWith(this.displayInfo)},Object.defineProperty(BaseDisplay.prototype,"direction",{get:function(){return this.mDirection},set:function(t){this.mDirection=t,this.mDisplayInfo&&(this.mDisplayInfo.avatarDir=t,this.play(this.mAnimation))},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDisplay.prototype,"displayInfo",{get:function(){return this.mDisplayInfo},set:function(t){this.mDisplayInfo=t},enumerable:!1,configurable:!0}),BaseDisplay.prototype.play=function(t){this.mAnimation=t},BaseDisplay.prototype.changeAlpha=function(t){this.mAlpha!==t&&(this.alpha=t,this.mAlpha=t)},BaseDisplay.prototype.setDirection=function(t){t!==this.direction&&(this.direction=t,this.play(this.mAnimation))},BaseDisplay.prototype.setPosition=function(e,i,n,a){return t.prototype.setPosition.call(this,e,i,n,a),this.updateSort(),this},BaseDisplay.prototype.getPosition=function(){var t=new s.LogicPos(this.x,this.y);return this.mRootMount&&(t.x+=this.mRootMount.x,t.y+=this.mRootMount.y),t},BaseDisplay.prototype.setRootMount=function(t){this.mRootMount=t},BaseDisplay.prototype.fadeIn=function(t){},BaseDisplay.prototype.fadeOut=function(t){},BaseDisplay.prototype.getSprite=function(t){return this.mSprites.get(t)},BaseDisplay.prototype.updateSort=function(){var t=this.x-this.projectionSize.offset.x,e=this.y-this.projectionSize.offset.y;this.mSortX=(t+2*e)/30,this.mSortY=(2*e-t)/30},Object.defineProperty(BaseDisplay.prototype,"projectionSize",{get:function(){return this.mProjectionSize||(this.mProjectionSize={offset:{x:0,y:0},width:0,height:0}),this.mProjectionSize},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDisplay.prototype,"sortX",{get:function(){return this.mSortX},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDisplay.prototype,"sortY",{get:function(){return this.mSortY},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDisplay.prototype,"sortZ",{get:function(){return this.z||0},enumerable:!1,configurable:!0}),BaseDisplay}(Phaser.GameObjects.Container),c=function(){function TopDisplay(t,e,i){this.scene=t,this.mFollows=new Map,this.mOwner=e,this.mDpr=i}return TopDisplay.prototype.showNickname=function(t){if(this.mOwner){var e=this.mFollows.get(a.Nickname),i=null;e?i=e.object:(i=this.scene.make.text({style:{fontSize:12*this.mDpr,fontFamily:s.Font.DEFULT_FONT}}).setOrigin(.5).setStroke("#000000",2*this.mDpr),e=new p(i,this.mOwner,this.mDpr),this.mFollows.set(a.Nickname,e)),i.text=t,this.mOwner.topPoint&&(this.addToSceneUI(i),e.setOffset(0,this.mOwner.topPoint.y),e.update())}},TopDisplay.prototype.hideNickname=function(){this.removeFollowObject(a.Nickname)},TopDisplay.prototype.update=function(){this.mFollows&&this.mFollows.forEach((function(t){return t.update()}))},TopDisplay.prototype.addToSceneUI=function(t){throw new Error("")},TopDisplay.prototype.removeFollowObject=function(t){if(this.mFollows&&this.mFollows.has(t)){var e=this.mFollows.get(t);e&&(e.destroy(),this.mFollows.delete(t))}},TopDisplay}(),p=function(){function FollowObject(t,e,i){void 0===i&&(i=1),this.mDpr=i,this.mOffset=new Phaser.Geom.Point,this.mObject=t,this.mTarget=e}return FollowObject.prototype.setOffset=function(t,e){this.mOffset.setTo(t,e),this.update()},FollowObject.prototype.update=function(){if(this.mTarget&&this.mObject){var t=this.mTarget.getPosition();this.mObject.x=Math.round((t.x+this.mOffset.x)*this.mDpr),this.mObject.y=Math.round((t.y+this.mOffset.y)*this.mDpr)}},FollowObject.prototype.remove=function(){if(this.mObject){var t=this.mObject;t.parentContainer&&t.parentContainer.remove(t)}},FollowObject.prototype.destroy=function(){this.mObject&&this.mObject.destroy(),this.mObject=void 0},Object.defineProperty(FollowObject.prototype,"object",{get:function(){return this.mObject},enumerable:!1,configurable:!0}),FollowObject}();!function(t){t[t.Nickname=1e3]="Nickname",t[t.Image=1001]="Image",t[t.Sprite=1002]="Sprite"}(a||(a={}));var d,u,m=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),f=function(t){function ReferenceArea(e){return t.call(this,e)||this}return m(ReferenceArea,t),ReferenceArea.prototype.draw=function(t,e,i,n){if(this.clear(),0!==t.length&&0!==t[0].length){var a,o,h,l,c=t.length,p=t[0].length;this.mOrigin=e,this.mSize={rows:c,cols:p,tileWidth:i,tileHeight:n,sceneWidth:(c+p)*(i/2),sceneHeight:(c+p)*(n/2)},this.beginPath();for(var d=0;d<c;d++)for(var u=0;u<p;u++)this.lineStyle(2,0),a=s.Position45.transformTo90(new s.Pos(u,d),this.mSize),o=s.Position45.transformTo90(new s.Pos(u+1,d),this.mSize),h=s.Position45.transformTo90(new s.Pos(u+1,d+1),this.mSize),l=s.Position45.transformTo90(new s.Pos(u,d+1),this.mSize),this.beginPath(),this.fillStyle(1===t[d][u]?65280:16711680),this.strokePoints([a.toPoint(),o.toPoint(),h.toPoint(),l.toPoint()],!0,!0),this.fillPath();this.setPosition(0,0)}},ReferenceArea.prototype.setPosition=function(e,i,n,a){if(this.mSize){var s=e-(this.mOrigin.x-this.mOrigin.y)*(this.mSize.tileWidth>>1),o=i-(this.mOrigin.x+this.mOrigin.y+.5)*(this.mSize.tileHeight>>1);return t.prototype.setPosition.call(this,s,o,n,a)}},Object.defineProperty(ReferenceArea.prototype,"size",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),ReferenceArea}(Phaser.GameObjects.Graphics),y=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}();!function(t){t.BodyCostDres="body_cost_dres_$",t.BodyCost="body_cost_$",t.BodyTail="body_tail_$",t.BodyWing="body_wing_$",t.BodyBase="body_base_$",t.BodySpec="body_spec_$",t.FlegSpec="fleg_spec_$",t.FlegBase="fleg_base_$",t.FlegCost="fleg_cost_$",t.BarmSpec="barm_spec_$",t.BarmBase="barm_base_$",t.BarmCost="barm_cost_$",t.BarmWeap="barm_weap_$",t.ShldBarm="barm_shld_$",t.BlegSpec="bleg_spec_$",t.BlegBase="bleg_base_$",t.BlegCost="bleg_cost_$",t.FarmSpec="farm_spec_$",t.FarmBase="farm_base_$",t.FarmCost="farm_cost_$",t.ShldFarm="farm_shld_$",t.FarmWeap="farm_weap_$",t.HeadSpec="head_spec_$",t.HeadMask="head_mask_$",t.HeadEyes="head_eyes_$",t.HeadBase="head_base_$",t.HeadHairBack="head_hair_back_$",t.HeadMous="head_mous_$",t.HeadHair="head_hair_$",t.HeadHats="head_hats_$",t.HeadFace="head_face_$"}(d||(d={})),function(t){t.BarmBase="barm_base_#_$",t.BarmCost="barm_cost_#_$",t.BarmSpec="barm_spec_#_$",t.BlegBase="bleg_base_#_$",t.BlegCost="bleg_cost_#_$",t.BlegSpec="bleg_spec_#_$",t.BodyBase="body_base_#_$",t.BodyCost="body_cost_#_$",t.BodyCostDres="body_cost_dres_#_$",t.BodySpec="body_spec_#_$",t.BodyTail="body_tail_#_$",t.BodyWing="body_wing_#_$",t.FarmBase="farm_base_#_$",t.FarmCost="farm_cost_#_$",t.FarmSpec="farm_spec_#_$",t.FlegBase="fleg_base_#_$",t.FlegCost="fleg_cost_#_$",t.FlegSpec="fleg_spec_#_$",t.HeadBase="head_base_#_$",t.HeadEyes="head_eyes_#_$",t.HeadHair="head_hair_#_$",t.HeadHairBack="head_hair_back_#_$",t.HeadHats="head_hats_#_$",t.HeadFace="head_face_#_$",t.HeadMask="head_mask_#_$",t.HeadMous="head_mous_#_$",t.HeadSpec="head_spec_#_$",t.ShldFarm="farm_shld_#_$",t.WeapFarm="farm_weap_#_$",t.ShldBarm="barm_shld_#_$",t.WeapBarm="barm_weap_#_$"}(u||(u={}));var g=function(t){function BaseDragonbonesDisplay(e){var i=t.call(this,e)||this;return i.mArmatureName="Armature",i.mResourceName="bones_human01",i.mInteractive=!0,i.isRenderTexture=!1,i.replaceArr=[],i.mHasLoadMap=new Map,i.mLoadMap=new Map,i.mErrorLoadMap=new Map,i.mNeedReplaceTexture=!1,i.UNPACKSLOTS=[d.FarmWeap,d.BarmWeap],i.UNCHECKAVATARPROPERTY=["id","dirable","farmWeapId","barmWeapId"],i.mReplaceTexTimeOutID=null,i.mPreReplaceTextureKey="",i.mReplaceTextureKey="",i.mTmpIndex=0,i.scene.textures.on("onload",i.onLoadFunc,i),i}return y(BaseDragonbonesDisplay,t),Object.defineProperty(BaseDragonbonesDisplay.prototype,"displayInfo",{get:function(){return this.mDisplayInfo},set:function(t){!1===this.mNeedReplaceTexture&&(this.mNeedReplaceTexture=this.checkNeedReplaceTexture(this.mDisplayInfo,t)),this.mDisplayInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDragonbonesDisplay.prototype,"spriteWidth",{get:function(){return this.mArmatureDisplay?this.mArmatureDisplay.width:0},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDragonbonesDisplay.prototype,"spriteHeight",{get:function(){return this.mArmatureDisplay?this.mArmatureDisplay.height:0},enumerable:!1,configurable:!0}),Object.defineProperty(BaseDragonbonesDisplay.prototype,"topPoint",{get:function(){return this.mBoardPoint},enumerable:!1,configurable:!0}),BaseDragonbonesDisplay.prototype.load=function(t){var e=this;return this.displayInfo=t,this.displayInfo?(this.mLoadDisplayPromise=new s.ValueResolver,this.mLoadDisplayPromise.promise((function(){e.buildDragbones()}))):Promise.reject("displayInfo error")},BaseDragonbonesDisplay.prototype.getDisplay=function(){return this.mArmatureDisplay},BaseDragonbonesDisplay.prototype.play=function(e){this.mAnimation=e,s.Logger.getInstance().debug("dragonbones play ====>",e),this.mArmatureDisplay&&(this.mArmatureDisplay.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)&&this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),e.playingQueue&&e.playingQueue.playTimes&&e.playingQueue.playTimes>0&&this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),this.mArmatureDisplay.animation.play(e.name,e.times),this.mArmatureDisplay.scaleX=e.flip?-1:1),t.prototype.play.call(this,e)},BaseDragonbonesDisplay.prototype.fadeIn=function(t){this.clearFadeTween(),this.alpha=0,this.mFadeTween=this.scene.tweens.add({targets:this,alpha:1,duration:1200,onComplete:function(){t&&t()}})},BaseDragonbonesDisplay.prototype.fadeOut=function(t){this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:0,duration:1200,onComplete:function(){t&&t()}})},BaseDragonbonesDisplay.prototype.destroy=function(){this.scene&&this.scene.textures.off("onload",this.onLoadFunc,this,!1),this.mDisplayInfo=null,this.mNeedReplaceTexture=!1,this.mArmatureDisplay&&(this.mArmatureDisplay.dispose(!0),this.mArmatureDisplay=null),this.mFadeTween&&(this.clearFadeTween(),this.mFadeTween=null),this.mReplaceTexTimeOutID&&(clearTimeout(this.mReplaceTexTimeOutID),this.mReplaceTexTimeOutID=null),t.prototype.destroy.call(this)},BaseDragonbonesDisplay.prototype.setClickInteractive=function(t){if(this.mInteractive=t,t){var e=new Phaser.Geom.Rectangle(0,0,50,70);e.x=-e.width>>1,e.y=-e.height,this.setInteractive(e,Phaser.Geom.Rectangle.Contains)}else this.disableInteractive()},Object.defineProperty(BaseDragonbonesDisplay.prototype,"resourceName",{get:function(){return this.mResourceName},set:function(t){this.mResourceName=t},enumerable:!1,configurable:!0}),BaseDragonbonesDisplay.prototype.buildDragbones=function(){if(this.scene.cache.custom.dragonbone)if(this.scene.cache.custom.dragonbone.get(this.resourceName))this.createArmatureDisplay();else{var t=this.localResourceRoot+"dragonbones",e=t+"/"+this.resourceName+"_tex.png",i=t+"/"+this.resourceName+"_tex.json",n=t+"/"+this.resourceName+"_ske.dbbin";this.loadDragonBones(e,i,n)}},Object.defineProperty(BaseDragonbonesDisplay.prototype,"localResourceRoot",{get:function(){return s.Url.RES_PATH},enumerable:!1,configurable:!0}),BaseDragonbonesDisplay.prototype.getPartLoadUrl=function(t){return s.ResUtils.getPartUrl(t)},BaseDragonbonesDisplay.prototype.getPartLoadKey=function(t){return s.ResUtils.getPartName(t)},BaseDragonbonesDisplay.prototype.generateReplaceTextureKey=function(){return"bones_"+this.displayInfo.id+this.mTmpIndex},BaseDragonbonesDisplay.prototype.createArmatureDisplay=function(t,e,i){if(this.scene){if(this.showPlaceholder(),this.mArmatureDisplay)this.mArmatureDisplay.visible=!1;else{this.mArmatureDisplay=this.scene.add.armature(this.mArmatureName,this.resourceName),this.mArmatureDisplay.visible=!1,this.addAt(this.mArmatureDisplay,0);var n=this.mArmatureDisplay.armature.getBone("board");this.mBoardPoint=n?new Phaser.Geom.Point(n.global.x,n.global.y):new Phaser.Geom.Point(35,40)}this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.SOUND_EVENT,this.onSoundEventHandler,this),this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.SOUND_EVENT,this.onSoundEventHandler,this),this.isRenderTexture||this.clearArmatureSlot(),this.getReplaceArr(),this.showReplaceArmatrue(),this.setClickInteractive(this.mInteractive),this.setData("id",this.displayInfo.id),this.created()}},BaseDragonbonesDisplay.prototype.onArmatureLoopComplete=function(t){if(this.mArmatureDisplay&&this.mAnimation){var e=this.mAnimation.playingQueue;void 0===e.playedTimes?e.playedTimes=1:e.playedTimes++;var i=void 0===e.playTimes?-1:e.playTimes;e.playedTimes>=i&&i>0&&this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this)}},BaseDragonbonesDisplay.prototype.clearArmatureSlot=function(){this.mArmatureDisplay.armature.getSlots().forEach((function(t){t&&(t.display.visible=!1)}))},BaseDragonbonesDisplay.prototype.loadCompleteHander=function(){this.closePlaceholder()},BaseDragonbonesDisplay.prototype.showPlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=this.scene.make.image({key:"avatar_placeholder",x:-22,y:-68}).setOrigin(0),this.add(this.mPlaceholder)},BaseDragonbonesDisplay.prototype.closePlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=void 0},BaseDragonbonesDisplay.prototype.loadDragonBones=function(t,e,i){this.scene.load.dragonbone(this.resourceName,t,e,i,null,null,{responseType:"arraybuffer"}),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.createArmatureDisplay,this),this.scene.load.start()},BaseDragonbonesDisplay.prototype.refreshAvatar=function(){this.clearArmatureSlot();for(var t=this.scene.game.textures.get(this.resourceName),e=0,i=this.replaceArr;e<i.length;e++){var n=i[e],a=n.slot.replace("$",n.dir.toString());if(y=this.mArmatureDisplay.armature.getSlot(a)){var o=this.formattingSkin(n.skin),h=n.part.replace("#",o.sn.toString()).replace("$",n.dir.toString())+o.version,l=this.getPartLoadKey(h),c="test resources/"+h;if(this.UNPACKSLOTS.indexOf(n.slot)<0)y.display.visible=this.scene.textures.exists(l)||t.frames[c];else if(this.scene.textures.exists(l)){var p=new dragonBones.phaser.display.SlotImage(this.scene,y.display.x,y.display.y,l);y.display=p}}}if(this.isRenderTexture)if(this.mNeedReplaceTexture){this.mNeedReplaceTexture=!1;var d=t.getFrameNames();this.mTmpIndex++,this.mPreReplaceTextureKey=this.mReplaceTextureKey,this.mReplaceTextureKey=this.generateReplaceTextureKey();for(var u=this.scene.textures.createCanvas(this.mReplaceTextureKey+"_canvas",t.source[0].width,t.source[0].height),m=0,f=d.length;m<f;m++){var y,g=d[m],P=(h=g.split("/")[1].split("_"))[4]?h[0]+"_"+h[1]+"_"+h[2]+"_"+h[4]:h[0]+"_"+h[1]+"_"+h[3];(y=this.mArmatureDisplay.armature.getSlot(P))||s.Logger.getInstance().warn("dragonbonesDisplay, get slot error: ",P,y);var _=t.get(g),v=this.mLoadMap.get(P);if(v){var b=v[1]+"_png",T=this.scene.game.textures.get(b);u.drawFrame(b,T.firstFrame,_.cutX,_.cutY)}else for(var S=0,x=this.replaceArr;S<x.length;S++){var w=x[S],D=(o=this.formattingSkin(w.skin),w.part.replace("#",o.sn.toString()).replace("$",w.dir.toString())+o.version);l=this.getPartLoadKey(D),c="test resources/"+D;if((a=w.slot.replace("$",w.dir.toString()))===P){var C=this.scene.textures.get(l);if(t.frames[c]){u.drawFrame(this.resourceName,c,_.cutX,_.cutY);break}u.drawFrame(l,C.firstFrame,_.cutX,_.cutY);break}}}var I=u.canvas.toDataURL("image/png",1);this.scene.textures.addBase64(this.mReplaceTextureKey,I),u.destroy()}else this.mLoadDisplayPromise&&this.mLoadDisplayPromise.resolve(null);else;this.mArmatureDisplay.visible=!0,this.emit("replacefinished")},BaseDragonbonesDisplay.prototype.clearReplaceArmature=function(){if(this.mArmatureDisplay.armature.animation.stop(),this.replaceArr&&0!==this.replaceArr.length)for(var t=this.replaceArr.length,e=0;e<t;e++){var i=this.replaceArr[e].slot.replace("$",this.replaceArr[e].dir.toString());this.mArmatureDisplay.armature.getSlot(i).replaceDisplay(null)}},BaseDragonbonesDisplay.prototype.showReplaceArmatrue=function(){for(var t=0,e=this.replaceArr;t<e.length;t++){var i=e[t];this.replacePartDisplay(i.slot,i.part,i.dir,i.skin)}this.mLoadMap&&this.mLoadMap.size>0?this.startLoadPartRes():(this.isRenderTexture?this.refreshAvatar():(this.mArmatureDisplay.visible=!0,this.replaceArr.splice(0)),this.loadCompleteHander())},BaseDragonbonesDisplay.prototype.getReplaceArr=function(){this.replaceArr.length=0;var t=this.displayInfo.avatar;t.bodyBaseId&&(this.replaceArr.push({slot:d.BodyBase,part:u.BodyBase,dir:3,skin:t.bodyBaseId}),this.replaceArr.push({slot:d.BodyBase,part:u.BodyBase,dir:1,skin:t.bodyBaseId})),t.bodySpecId&&(this.replaceArr.push({slot:d.BodySpec,part:u.BodySpec,dir:3,skin:t.bodySpecId}),this.replaceArr.push({slot:d.BodySpec,part:u.BodySpec,dir:1,skin:t.bodySpecId})),t.bodyWingId&&(this.replaceArr.push({slot:d.BodyWing,part:u.BodyWing,dir:3,skin:t.bodyWingId}),this.replaceArr.push({slot:d.BodyWing,part:u.BodyWing,dir:1,skin:t.bodyWingId})),t.bodyTailId&&(this.replaceArr.push({slot:d.BodyTail,part:u.BodyTail,dir:3,skin:t.bodyTailId}),this.replaceArr.push({slot:d.BodyTail,part:u.BodyTail,dir:1,skin:t.bodyTailId})),t.bodyCostId&&(this.replaceArr.push({slot:d.BodyCost,part:u.BodyCost,dir:3,skin:t.bodyCostId}),this.replaceArr.push({slot:d.BodyCost,part:u.BodyCost,dir:1,skin:t.bodyCostId})),t.bodyCostDresId&&(this.replaceArr.push({slot:d.BodyCostDres,part:u.BodyCostDres,dir:3,skin:t.bodyCostDresId}),this.replaceArr.push({slot:d.BodyCostDres,part:u.BodyCostDres,dir:1,skin:t.bodyCostDresId})),t.farmBaseId&&(this.replaceArr.push({slot:d.FarmBase,part:u.FarmBase,dir:3,skin:t.farmBaseId}),this.replaceArr.push({slot:d.FarmBase,part:u.FarmBase,dir:1,skin:t.farmBaseId})),t.farmSpecId&&(this.replaceArr.push({slot:d.FarmSpec,part:u.FarmSpec,dir:3,skin:t.farmSpecId}),this.replaceArr.push({slot:d.FarmSpec,part:u.FarmSpec,dir:1,skin:t.farmSpecId})),t.farmCostId&&(this.replaceArr.push({slot:d.FarmCost,part:u.FarmCost,dir:3,skin:t.farmCostId}),this.replaceArr.push({slot:d.FarmCost,part:u.FarmCost,dir:1,skin:t.farmCostId})),t.barmBaseId&&(this.replaceArr.push({slot:d.BarmBase,part:u.BarmBase,dir:3,skin:t.barmBaseId}),this.replaceArr.push({slot:d.BarmBase,part:u.BarmBase,dir:1,skin:t.barmBaseId})),t.barmSpecId&&(this.replaceArr.push({slot:d.BarmSpec,part:u.BarmSpec,dir:3,skin:t.barmSpecId}),this.replaceArr.push({slot:d.BarmSpec,part:u.BarmSpec,dir:1,skin:t.barmSpecId})),t.barmCostId&&(this.replaceArr.push({slot:d.BarmCost,part:u.BarmCost,dir:3,skin:t.barmCostId}),this.replaceArr.push({slot:d.BarmCost,part:u.BarmCost,dir:1,skin:t.barmCostId})),t.blegBaseId&&(this.replaceArr.push({slot:d.BlegBase,part:u.BlegBase,dir:3,skin:t.blegBaseId}),this.replaceArr.push({slot:d.BlegBase,part:u.BlegBase,dir:1,skin:t.blegBaseId})),t.blegSpecId&&(this.replaceArr.push({slot:d.BlegSpec,part:u.BlegSpec,dir:3,skin:t.blegSpecId}),this.replaceArr.push({slot:d.BlegSpec,part:u.BlegSpec,dir:1,skin:t.blegSpecId})),t.blegCostId&&(this.replaceArr.push({slot:d.BlegCost,part:u.BlegCost,dir:3,skin:t.blegCostId}),this.replaceArr.push({slot:d.BlegCost,part:u.BlegCost,dir:1,skin:t.blegCostId})),t.flegBaseId&&(this.replaceArr.push({slot:d.FlegBase,part:u.FlegBase,dir:3,skin:t.flegBaseId}),this.replaceArr.push({slot:d.FlegBase,part:u.FlegBase,dir:1,skin:t.flegBaseId})),t.flegSpecId&&(this.replaceArr.push({slot:d.FlegSpec,part:u.FlegSpec,dir:3,skin:t.flegSpecId}),this.replaceArr.push({slot:d.FlegSpec,part:u.FlegSpec,dir:1,skin:t.flegSpecId})),t.flegCostId&&(this.replaceArr.push({slot:d.FlegCost,part:u.FlegCost,dir:3,skin:t.flegCostId}),this.replaceArr.push({slot:d.FlegCost,part:u.FlegCost,dir:1,skin:t.flegCostId})),t.headBaseId&&(this.replaceArr.push({slot:d.HeadBase,part:u.HeadBase,dir:3,skin:t.headBaseId}),this.replaceArr.push({slot:d.HeadBase,part:u.HeadBase,dir:1,skin:t.headBaseId})),t.barmWeapId&&(this.replaceArr.push({slot:d.BarmWeap,part:u.WeapBarm,dir:3,skin:t.barmWeapId}),this.replaceArr.push({slot:d.BarmWeap,part:u.WeapBarm,dir:1,skin:t.barmWeapId})),t.headHairId&&(this.replaceArr.push({slot:d.HeadHair,part:u.HeadHair,dir:3,skin:t.headHairId}),this.replaceArr.push({slot:d.HeadHair,part:u.HeadHair,dir:1,skin:t.headHairId})),t.headHairBackId&&(this.replaceArr.push({slot:d.HeadHairBack,part:u.HeadHairBack,dir:3,skin:t.headHairBackId}),this.replaceArr.push({slot:d.HeadHairBack,part:u.HeadHairBack,dir:1,skin:t.headHairBackId})),t.headHatsId&&(this.replaceArr.push({slot:d.HeadHats,part:u.HeadHats,dir:3,skin:t.headHatsId}),this.replaceArr.push({slot:d.HeadHats,part:u.HeadHats,dir:1,skin:t.headHatsId})),t.headSpecId&&(this.replaceArr.push({slot:d.HeadSpec,part:u.HeadSpec,dir:3,skin:t.headSpecId}),this.replaceArr.push({slot:d.HeadSpec,part:u.HeadSpec,dir:1,skin:t.headSpecId})),t.headEyesId&&this.replaceArr.push({slot:d.HeadEyes,part:u.HeadEyes,dir:3,skin:t.headEyesId}),t.headMousId&&this.replaceArr.push({slot:d.HeadMous,part:u.HeadMous,dir:3,skin:t.headMousId}),t.headMaskId&&this.replaceArr.push({slot:d.HeadMask,part:u.HeadMask,dir:3,skin:t.headMaskId}),t.headFaceId&&(this.replaceArr.push({slot:d.HeadFace,part:u.HeadFace,dir:3,skin:t.headFaceId}),this.replaceArr.push({slot:d.HeadFace,part:u.HeadFace,dir:1,skin:t.headFaceId})),t.farmShldId&&(this.replaceArr.push({slot:d.ShldFarm,part:u.ShldFarm,dir:3,skin:t.farmShldId}),this.replaceArr.push({slot:d.ShldFarm,part:u.ShldFarm,dir:1,skin:t.farmShldId})),t.barmShldId&&(this.replaceArr.push({slot:d.ShldBarm,part:u.ShldBarm,dir:3,skin:t.barmShldId}),this.replaceArr.push({slot:d.ShldBarm,part:u.ShldBarm,dir:1,skin:t.barmShldId})),t.farmWeapId&&(this.replaceArr.push({slot:d.FarmWeap,part:u.WeapFarm,dir:3,skin:t.farmWeapId}),this.replaceArr.push({slot:d.FarmWeap,part:u.WeapFarm,dir:1,skin:t.farmWeapId})),t.farmBaseId&&(this.replaceArr.push({slot:d.FarmBase,part:u.FarmBase,dir:3,skin:t.farmBaseId}),this.replaceArr.push({slot:d.FarmBase,part:u.FarmBase,dir:1,skin:t.farmBaseId}))},BaseDragonbonesDisplay.prototype.hideUnreplacedParts=function(){for(var t=[],e=0,i=this.replaceArr;e<i.length;e++){var n=i[e],a=n.slot.replace("$",n.dir.toString()),s=this.mArmatureDisplay.armature.getSlot(a);t.push(s)}for(var o=0,h=this.mArmatureDisplay.armature.getSlots();o<h.length;o++){(s=h[o])&&(s.display.visible=t.indexOf(s)>=0)}},BaseDragonbonesDisplay.prototype.replacePartDisplay=function(t,e,i,n){var a=t.replace("$",i.toString()),s=this.mArmatureDisplay.armature.getSlot(a);if(s){var o=this.formattingSkin(n);if(o.sn){var h=e.replace("#",o.sn).replace("$",i.toString())+o.version,l=this.scene.game.textures.get(this.resourceName);if(this.scene.cache.custom.dragonbone.get(this.resourceName)){var c=this.getPartLoadKey(h),p="test resources/"+h;if(this.mErrorLoadMap.get(c))return;if(this.isRenderTexture)this.scene.textures.exists(c)||(l.frames[p]?this.mHasLoadMap.set(h,this.scene.textures.get(c)):this.mLoadMap.set(s.name,[s.name,h]));else if(this.scene.textures.exists(c)||l.frames[p]){var d=void 0;if(l.frames[p]){if(!this.scene.textures.exists(c))return void this.mLoadMap.set(s.name,[s.name,h]);d=new dragonBones.phaser.display.SlotImage(this.scene,s.display.x,s.display.y,c)}else d=new dragonBones.phaser.display.SlotImage(this.scene,s.display.x,s.display.y,c);s.replaceDisplay(d)}else this.mLoadMap.set(s.name,[s.name,h])}}}},BaseDragonbonesDisplay.prototype.startLoadPartRes=function(){var t=this,e=[];this.isRenderTexture?this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(){e&&t.scene&&(t.loadCompleteHander(),t.refreshAvatar(),t.mLoadMap.clear())}),this):(this.showPlaceholder(),this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(i,n,a){if(e&&t.scene){t.scene.game.textures.get(t.mResourceName).getFrameNames();t.mLoadMap.forEach((function(e){var i=t.mArmatureDisplay.armature.getSlot(e[0]),n=t.getPartLoadKey(e[1]);if(t.scene.textures.exists(n)&&!t.mErrorLoadMap.get(n)){var a=i.display?i.display.x:0,s=i.display?i.display.y:0,o=new dragonBones.phaser.display.SlotImage(t.scene,a,s,n);o.texture.key===n&&i.replaceDisplay(o)}})),t.loadCompleteHander(),t.mArmatureDisplay.visible=!0,t.mLoadMap.clear()}}),this)),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(e){t.mLoadMap.delete(e.key),t.mErrorLoadMap.set(e.key,e)}),this),this.mLoadMap.forEach((function(i){var n=i,a=t.getPartLoadUrl(n[1]),s=t.getPartLoadKey(n[1]);e.push({key:s,url:a})})),this.scene.load.image(e),this.scene.load.start()},BaseDragonbonesDisplay.prototype.onLoadFunc=function(t,e){var i=this;t===this.mReplaceTextureKey&&(this.mArmatureDisplay.armature.replacedTexture=e,this.mReplaceTexTimeOutID&&(clearTimeout(this.mReplaceTexTimeOutID),this.mReplaceTexTimeOutID=null),this.mReplaceTexTimeOutID=setTimeout((function(){null!==i.mPreReplaceTextureKey&&i.mPreReplaceTextureKey.length>0&&i.scene&&i.scene.textures.exists(i.mPreReplaceTextureKey)&&(i.scene.textures.remove(i.mPreReplaceTextureKey),i.scene.textures.removeKey(i.mPreReplaceTextureKey)),i.mLoadDisplayPromise&&(i.mLoadDisplayPromise.resolve(null),i.mLoadDisplayPromise=null)}),100))},BaseDragonbonesDisplay.prototype.formattingSkin=function(t){var e="",i="";return"string"==typeof t||"number"==typeof t?i=t.toString():(e=void 0===t.version||""===t.version?"":"_"+t.version,i=t.sn),{sn:i,version:e}},BaseDragonbonesDisplay.prototype.clearFadeTween=function(){this.mFadeTween&&(this.mFadeTween.stop(),this.mFadeTween.remove())},BaseDragonbonesDisplay.prototype.onSoundEventHandler=function(t){t.name},BaseDragonbonesDisplay.prototype.checkNeedReplaceTexture=function(t,e){if(!e)return!1;if(!t)return!0;var i=t.avatar,n=e.avatar;for(var a in n)if(n.hasOwnProperty(a)&&!(this.UNCHECKAVATARPROPERTY.indexOf(a)>=0)){if(!i.hasOwnProperty(a))return!0;if(i[a]!==n[a])return!0}return!1},BaseDragonbonesDisplay}(l),P=i(0),_=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),v=function(t){function BaseFramesDisplay(e,i,n){var a=t.call(this,e)||this;return a.mDisplayDatas=new Map,a.mDisplays=new Map,a.mIsSetInteractive=!1,a.mIsInteracitve=!1,a.mID=0,a.mNodeType=n,a.mID=i,a}return _(BaseFramesDisplay,t),BaseFramesDisplay.prototype.load=function(t,e){var i=this;if(e=e||P.DisplayField.STAGE,this.mField=e,this.displayInfo=t,!this.framesInfo||!this.framesInfo.gene)return Promise.reject("framesInfo error");var n=this.mDisplayDatas.get(e);if(n&&n.gene===t.gene||this.mDisplayDatas.set(e,this.framesInfo),this.scene.textures.exists(this.framesInfo.gene))this.onLoadCompleted(e);else{var a=this.framesInfo.display;if(!a)return s.Logger.getInstance().debug("update frame loadError","display is undefined"),void this.created();if(""===a.texturePath||""===a.dataPath)s.Logger.getInstance().debug("update frame loadError","动画资源报错：",this.displayInfo),this.created();else{this.scene.load.atlas(this.framesInfo.gene,s.Url.getOsdRes(a.texturePath),s.Url.getOsdRes(a.dataPath));var onAdd_1=function(t){t===i.framesInfo.gene&&(i.onAddTextureHandler(t,e,onAdd_1),i.scene&&i.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,onLoadError_1,i))},onLoadError_1=function(t){s.Logger.getInstance().debug("update frame loadError"),i.created()};this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,onLoadError_1,this),this.scene.textures.on(Phaser.Textures.Events.ADD,onAdd_1,this),this.scene.load.start()}}return Promise.resolve(null)},BaseFramesDisplay.prototype.play=function(e,i){if(t.prototype.play.call(this,e),e){var n=e.times;i=i||P.DisplayField.STAGE;var a=this.mDisplayDatas.get(i);if(!1!==this.scene.textures.exists(a.gene)){var o=a.animations;if(this.mCurAnimation=o.get(e.name),this.mCurAnimation){var h=this.mCurAnimation.layer;this.mPreAnimation&&this.mPreAnimation.name===e.name||this.createDisplays(a.gene,this.mCurAnimation);for(var l=null,c=0;c<h.length;c++){var p=h[c],d=p.frameName,u=p.offsetLoc;if(l=this.mDisplays.get(h[c].id||c)){if(d.length>1){var m=a.gene+"_"+e.name+"_"+c;this.makeAnimation(a.gene,m,h[c].frameName,h[c].frameVisible,this.mCurAnimation.frameRate,this.mCurAnimation.loop,this.mCurAnimation.frameDuration);var f=l.anims;f.play(m),"number"==typeof n&&f.setRepeat(n)}l.scaleX=e.flip?-1:1,this.updateBaseLoc(l,e.flip,u)}else s.Logger.getInstance().error("display "+this.mID+" play fail, display does not exist!")}if(this.emit("updateAnimation"),this.mMainSprite&&this.mMainSprite.on(Phaser.Animations.Events.ANIMATION_REPEAT,this.onAnimationRepeatHander,this),this.mMountContainer&&this.mCurAnimation.mountLayer)this.mSprites.get(P.DisplayField.STAGE).moveTo(this.mMountContainer,this.mCurAnimation.mountLayer.index);this.mPreAnimation=e}}}},BaseFramesDisplay.prototype.playEffect=function(){var t=this.mDisplayDatas.get(P.DisplayField.Effect);if(t){var e=t.animations,i=t.animationName;if(e){var n=e.get(i);if(n){for(var a=n.layer,s=[],o=0;o<a.length;o++){var h=void 0,l=a[o],c=l.frameName,p=l.offsetLoc;if(c.length>1){var d=t.gene+"_"+i+"_"+o;this.makeAnimation(t.gene,d,a[o].frameName,a[o].frameVisible,n.frameRate,n.loop,n.frameDuration),h=this.scene.make.sprite(void 0,!1).play(d)}else h=this.scene.make.image(void 0,!1).setTexture(t.gene,c[0]);h.x=p.x+.5*h.width,h.y=p.y+.5*h.height,s.push(h)}s.length>1&&(this.addAt(s[1],P.DisplayField.BACKEND),this.mSprites.set(P.DisplayField.BACKEND,s[1])),this.addAt(s[0],P.DisplayField.FRONTEND),this.mSprites.set(P.DisplayField.FRONTEND,s[0])}}}},BaseFramesDisplay.prototype.fadeIn=function(t){0!==this.mAlpha&&(this.alpha=0,this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:this.mAlpha,duration:1200,onComplete:function(){t&&t()}}))},BaseFramesDisplay.prototype.fadeOut=function(t){this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:0,duration:1200,onComplete:function(){t&&t()}})},BaseFramesDisplay.prototype.setInteractive=function(t,e,i){return this.mIsInteracitve=!0,this.mDisplays.forEach((function(t){t.setInteractive({pixelPerfect:!0})})),this},BaseFramesDisplay.prototype.disableInteractive=function(){return this.mIsInteracitve=!1,this.mDisplays.forEach((function(t){t.disableInteractive()})),this},BaseFramesDisplay.prototype.removeDisplay=function(t){var e=this.mSprites.get(t);e&&(this.mDisplayDatas.delete(t),e.destroy())},BaseFramesDisplay.prototype.mount=function(t,e){if(t&&this.mCurAnimation)if(this.mCurAnimation.mountLayer){var i=this.mCurAnimation.mountLayer,n=i.index,a=i.mountPoint;if(void 0===e&&(e=0),e>=a.length)s.Logger.getInstance().error("mount index does not exist");else{var o=a[e].x;if(this.mAnimation.flip&&(o=0-o),t.x=o,t.y=a[e].y,this.mMountContainer||(this.mMountContainer=this.scene.make.container(void 0,!1)),!this.mMountContainer.parentContainer){var h=this.mSprites.get(P.DisplayField.STAGE);h&&h.addAt(this.mMountContainer,n)}this.mMountContainer.addAt(t,e),t.setRootMount(this),this.mMountList[e]=t,this.mMainSprite}}else s.Logger.getInstance().error("mountLyaer does not exist "+this.mAnimation)},BaseFramesDisplay.prototype.unmount=function(t){if(this.mMountContainer){t.setRootMount(void 0);var e=this.mMountList.indexOf(t);t.visible=!0,e>-1&&this.mMountList.splice(e,1),this.mMountContainer.list.length<=0&&this.mDisplays.size}},BaseFramesDisplay.prototype.destroy=function(){this.clearDisplay(),this.mFadeTween&&(this.clearFadeTween(),this.mFadeTween=void 0),this.mScaleTween&&(this.mScaleTween.stop(),this.mScaleTween=void 0),this.mDisplayDatas.clear(),t.prototype.destroy.call(this)},BaseFramesDisplay.prototype.createDisplays=function(t,e){this.clearDisplay();var i=this.mSprites.get(P.DisplayField.STAGE);i||((i=this.scene.make.container(void 0,!1)).setData("id",this.mID),this.addAt(i,P.DisplayField.STAGE),this.mSprites.set(P.DisplayField.STAGE,i));for(var n,a=e.layer,s=0;s<a.length;s++)n=this.createDisplay(t,a[s]),this.mDisplays.set(a[s].id||s,n),i.add(n);this.mIsInteracitve?this.setInteractive():this.disableInteractive(),this.mIsSetInteractive=!0},BaseFramesDisplay.prototype.createDisplay=function(t,e){var i,n=e.frameName;return n.length>1?(i=this.scene.make.sprite(void 0,!1),this.mMainSprite||(this.mMainSprite=i)):i=this.scene.make.image({key:t,frame:n[0]}),i.setData("id",this.mID),i},BaseFramesDisplay.prototype.clearFadeTween=function(){this.mFadeTween&&(this.mFadeTween.stop(),this.mFadeTween.remove())},BaseFramesDisplay.prototype.completeFrameAnimationQueue=function(){},BaseFramesDisplay.prototype.clearDisplay=function(){this.mDisplays.forEach((function(t){return t.destroy()})),this.mMountList=[],this.mDisplays.clear(),this.mMainSprite=null,this.mPreAnimation=null},BaseFramesDisplay.prototype.onAddTextureHandler=function(t,e,i){void 0===e&&(e=P.DisplayField.STAGE);var n=this.mDisplayDatas.get(e);n&&n.gene===t?(this.scene.textures.off(Phaser.Textures.Events.ADD,i,this),this.onLoadCompleted(e)):s.Logger.getInstance().debug("no addtexture",this,n,e)},BaseFramesDisplay.prototype.mAllLoadCompleted=function(){this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.mAllLoadCompleted,this),this.onLoadCompleted(this.mField)},BaseFramesDisplay.prototype.onLoadCompleted=function(t){var e=this.mDisplayDatas.get(t);e&&(this.scene.textures.exists(e.gene)&&(t===P.DisplayField.STAGE?this.mAnimation&&this.play(this.mAnimation):this.playEffect()),this.created())},BaseFramesDisplay.prototype.makeAnimation=function(t,e,i,n,a,o,h){if(n&&i.length!==n.length)s.Logger.getInstance().error("wrong data: frameName.length: "+i.length+"; frameVisible.length: "+n.length);else if(h&&i.length!==h.length)s.Logger.getInstance().error("wrong data: frameName.length: "+i.length+"; frameDuration.length: "+h.length);else if(!this.scene.anims.exists(e)){for(var l=[],c=0;c<i.length;c++){var p=i[c],d=!n||n[c];h?l.push({key:t,frame:p,duration:1e3*h[c],visible:d}):l.push({key:t,frame:p,visible:d})}var u={key:e,frames:l,frameRate:a,repeat:o?-1:1};this.scene.anims.create(u)}},BaseFramesDisplay.prototype.updateBaseLoc=function(t,e,i){i||(i={x:0,y:0});var n=i.x,a=i.y;e&&(n=0-(t.width+n)),t.x=n+.5*t.width,t.y=a+.5*t.height},BaseFramesDisplay.prototype.onAnimationRepeatHander=function(){var t=this.mAnimation.playingQueue;void 0===t.playedTimes?t.playedTimes=1:t.playedTimes++,t.playedTimes>=t.playTimes&&(this.mMainSprite&&this.mMainSprite.off(Phaser.Animations.Events.ANIMATION_REPEAT,this.onAnimationRepeatHander,this),this.completeFrameAnimationQueue())},Object.defineProperty(BaseFramesDisplay.prototype,"framesInfo",{get:function(){return this.mDisplayInfo},enumerable:!1,configurable:!0}),Object.defineProperty(BaseFramesDisplay.prototype,"spriteWidth",{get:function(){var t=0;return this.mDisplays&&this.mDisplays.forEach((function(e){e.width>t&&(t=e.width)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseFramesDisplay.prototype,"spriteHeight",{get:function(){var t=0;return this.mDisplays&&this.mDisplays.forEach((function(e){e.width>t&&(t=e.height)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseFramesDisplay.prototype,"topPoint",{get:function(){return new Phaser.Geom.Point(0,-this.spriteHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(BaseFramesDisplay.prototype,"nodeType",{get:function(){return this.mNodeType},enumerable:!1,configurable:!0}),Object.defineProperty(BaseFramesDisplay.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),BaseFramesDisplay}(l),b=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),T=function(t){function BaseLayer(e,i,n){var a=t.call(this,e)||this;return a.name=i,a.setDepth(n),a}return b(BaseLayer,t),BaseLayer.prototype.sortLayer=function(){},BaseLayer}(Phaser.GameObjects.Container),S=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),x=function(t){function GroundLayer(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSortDirty=!1,e}return S(GroundLayer,t),GroundLayer.prototype.add=function(e){return t.prototype.add.call(this,e),this.mSortDirty=!0,this},GroundLayer.prototype.sortLayer=function(){this.mSortDirty&&(this.mSortDirty=!1,this.sort("depth",(function(t,e){return t.y+t.z>e.y+e.z})))},GroundLayer}(T),w=i(213),D=i.n(w),C=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),I=function(t){function SurfaceLayer(){return null!==t&&t.apply(this,arguments)||this}return C(SurfaceLayer,t),SurfaceLayer.prototype.add=function(e){return t.prototype.add.call(this,e),this},SurfaceLayer.prototype.sortLayer=function(){D.a.reset(),D.a.setTolerance(.8);for(var t=0,e=this.list;t<e.length;t++){var i=e[t],n=i.projectionSize;5===i.nodeType?D.a.addDynamicDisplayObject(i.id,i.sortX,i.sortY,n.width,n.height,!0,i.nickname,i):D.a.addFixedDisplayObject(i.id,i.sortX,i.sortY,n.width,n.height,!1,i.nickname,i)}try{this.list=D.a.sort()}catch(t){s.Logger.getInstance().error("Cyclic dependency")}},SurfaceLayer}(T),k=function(){function LayerManager(){this.delta=0,this.layers=new Map}return LayerManager.prototype.setScale=function(t){this.layers.forEach((function(e){e.setScale(t)}))},LayerManager.prototype.addLayer=function(t,e,i,n){if(!this.layers.get(i)){var a=new e(t,i,n);return this.layers.set(i,a),t.sys.displayList.add(a),a}s.Logger.getInstance().warn("repeated layer name: ",i)},LayerManager.prototype.addToLayer=function(t,e,i){void 0===i&&(i=-1);var n=this.layers.get(t);n&&(-1===i||void 0===i?n.add(e):n.addAt(e,i))},LayerManager.prototype.destroy=function(){this.layers.forEach((function(t){t.destroy()})),this.layers=null},LayerManager.prototype.getLayer=function(t){return this.layers.get(t)?this.layers.get(t):null},LayerManager.prototype.update=function(t,e){t-this.delta<200||(this.delta=t,this.layers.forEach((function(t){t.sortLayer()})))},Object.defineProperty(LayerManager.prototype,"depthSurfaceDirty",{set:function(t){this.mDepthSurface=t},enumerable:!1,configurable:!0}),LayerManager}(),B=function(){function Scenery(t){this.mID=t.id,this.mDepth=t.depth,this.mUris=[];var e=null;(e=Array.isArray(t.uris)?t.uris:t.uris.value).length<1&&s.Logger.getInstance().error(Scenery.name+": scenery uris is empty");for(var i=0;i<e.length;i++){var n=e[i].value||e;this.mUris[i]=new Array(n[i].length);for(var a=0;a<n[i].length;a++)this.mUris[i][a]=n[i][a]}this.mSpeed=t.speed||1,t.width||s.Logger.getInstance().error(Scenery.name+": scenery width is "+t.width),t.height||s.Logger.getInstance().error(Scenery.name+": scenery height is "+t.height),this.mWidth=t.width,this.mHeight=t.height,this.mFit=t.fit,this.mOffset=t.offset||{x:0,y:0}}return Object.defineProperty(Scenery.prototype,"offset",{get:function(){return this.mOffset},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"width",{get:function(){return this.mWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"height",{get:function(){return this.mHeight},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"depth",{get:function(){return this.mDepth},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"speed",{get:function(){return this.mSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"uris",{get:function(){return this.mUris},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"fit",{get:function(){return this.mFit},enumerable:!1,configurable:!0}),Scenery}(),E=i(433)},,function(t,e,i){"use strict";i.d(e,"b",(function(){return initLocales})),i.d(e,"a",(function(){return o}));var n=i(78),a=i(134),s=i(135);function initLocales(t){return n.a.use(a.a).use(s.a).init({fallbackLng:"en",backend:{loadPath:t,crossDomain:!0}})}var o=n.a},,,,function(t,e,i){"use strict";i.d(e,"d",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return l})),i.d(e,"e",(function(){return a})),i.d(e,"b",(function(){return n}));var n,a,s=function(){function UIAtlasName(){}return UIAtlasName.jsonUrl=function(t){return t+".json"},UIAtlasName.textureUrl=function(t){return t+".png"},UIAtlasName.commonUrl="ui_base/ui_base",UIAtlasName.common2Url="ui_base2/ui_base2",UIAtlasName.common3Url="ui_base3/ui_base3",UIAtlasName.uicommonurl="ui_common/ui_common",UIAtlasName.uibase="ui_base",UIAtlasName.uibase2="ui_base2",UIAtlasName.uibase3="ui_base3",UIAtlasName.uicommon="ui_common",UIAtlasName.uicommon1="ui_common1",UIAtlasName.roam="roam",UIAtlasName.iconcommon="icon_common",UIAtlasName.effectcommon="effect_common",UIAtlasName.stareffect="stareffect",UIAtlasName.circleeffect="circleeffect",UIAtlasName.explorelog="explorelog",UIAtlasName.treasure="treasure",UIAtlasName}(),o=function(){function UIAtlasKey(){}return UIAtlasKey.commonKey="common_key",UIAtlasKey.common2Key="common2_key",UIAtlasKey.common3Key="common3_key",UIAtlasKey.uicommonKey="uicommon_key",UIAtlasKey}();!function(t){t[t.DPR=1]="DPR",t[t.NORMAL=2]="NORMAL",t[t.OSD=3]="OSD"}(n||(n={})),function(t){t[t.none=1]="none",t[t.atlas=2]="atlas",t[t.font=3]="font",t[t.texture=4]="texture",t[t.video=5]="video",t[t.json=6]="json"}(a||(a={}));var h=function h(t,e,i,s){void 0===s&&(s=a.none),this.uiType=a.none,this.foldType=n.DPR,this.atlasName=t,this.atlasUrl=e,this.jsonUrl=i,this.uiType=s},l=function(){function AtlasManager(){this.atlasMap=new Map}return AtlasManager.prototype.init=function(t){this.render=t,this.add(s.uicommon,a.atlas),this.add(s.iconcommon,a.atlas),this.add(s.effectcommon,a.atlas)},AtlasManager.prototype.add=function(t,e,i,s){var o;if(void 0===e&&(e=a.none),i=i||t,s=s||n.DPR,e===a.atlas)o=new h(t,(l=i+"/"+t)+".png",l+".json",a.atlas);else if(e===a.font){o=new h(t,(l=i+"/"+t)+".ttf",void 0,a.font)}else if(e===a.texture){o=new h(t,(l=i+"/"+t)+".png",void 0,a.texture)}else if(e===a.video){var l;o=new h(t,(l=i+"/"+t)+".mp4",void 0,a.video)}return o.foldType=s,this.atlasMap.set(t,o),o},AtlasManager.prototype.getUrlDatas=function(t,e){void 0===e&&(e=a.atlas);for(var i=[],n=0,s=t;n<s.length;n++){var o=s[n],h=void 0,l=void 0,c=void 0;if("object"==typeof o?(h=o.atlasName,l=o.folder,e=o.uiType||e,c=o.foldType):h=o,this.atlasMap.has(h)){var p=this.atlasMap.get(h);i.push(p)}else{var d=this.add(h,e,l,c);i.push(d)}}return i},AtlasManager.prototype.loadAtlas=function(t,e,i,n){},AtlasManager.prototype.isAtlasLoaded=function(t){return!1},AtlasManager.prototype.loadTexture=function(t,e){void 0===e&&(e=".png")},AtlasManager.prototype.unloadAtlas=function(t){},AtlasManager.prototype.loadFont=function(t,e){},AtlasManager}()},,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var __spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,h=s.length;o<h;o++,a++)n[a]=s[o];return n},n=function(){function Logger(){this.isDebug=!1}return Logger.getInstance=function(){return Logger._instance||(Logger._instance=new Logger),Logger._instance},Logger.prototype.fatal=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];throw t},Logger.prototype.log=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.log.apply(console,__spreadArrays([t],e))},Logger.prototype.debug=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.isDebug&&console.log.apply(console,__spreadArrays([t],e))},Logger.prototype.error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.error.apply(console,__spreadArrays([t],e))},Logger.prototype.debugError=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.isDebug&&console.error.apply(console,__spreadArrays([t],e))},Logger.prototype.warn=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.isDebug&&console.warn.apply(console,__spreadArrays([t],e))},Logger.prototype.info=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.isDebug&&console.info.apply(console,__spreadArrays([t],e))},Logger.prototype.v=function(){this.isDebug=!0},Logger.prototype.q=function(){this.isDebug=!1},Logger}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function LogicPos(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.depth=0|n}return LogicPos.prototype.add=function(t,e,i){return this.x+=t,this.x+=e,this.z+=i||0,this},LogicPos.prototype.equal=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.depth===this.depth},LogicPos.prototype.toString=function(){return"Pos { x: "+this.x+", y: "+this.y+", z: "+this.z+", depth: "+this.depth+" }"},LogicPos.prototype.toPoint=function(){return new LogicPos(this.x,this.y,this.z)},LogicPos}()},function(t,e,i){"use strict";i.r(e);var n=i(59);i.d(e,"DynamicImage",(function(){return n.DynamicImage}));var a=i(295);i.d(e,"DynamicNinepatch",(function(){return a.DynamicNinepatch}));var s=i(296);i.d(e,"DynamicSprite",(function(){return s.DynamicSprite}));var o=i(297);i.d(e,"InputPanel",(function(){return o.InputPanel}));var h=i(298);i.d(e,"CheckboxGroup",(function(){return h.CheckboxGroup}));var l=i(299);i.d(e,"TextButton",(function(){return l.TextButton}));var c=i(300);i.d(e,"LabelInput",(function(){return c.LabelInput}));var p=i(60);i.d(e,"BasePanel",(function(){return p.BasePanel}));var d=i(301);i.d(e,"NinePatchButton",(function(){return d.NinePatchButton}));var u=i(302);i.d(e,"AlertView",(function(){return u.AlertView})),i.d(e,"Buttons",(function(){return u.Buttons}));var m=i(148);i.d(e,"ItemInfoTips",(function(){return m.ItemInfoTips}));var f=i(303);i.d(e,"TextToolTips",(function(){return f.TextToolTips}));var y=i(304);for(var g in y)["default","DynamicImage","DynamicNinepatch","DynamicSprite","InputPanel","CheckboxGroup","TextButton","LabelInput","BasePanel","NinePatchButton","AlertView","Buttons","ItemInfoTips","TextToolTips"].indexOf(g)<0&&function(t){i.d(e,t,(function(){return y[t]}))}(g);var P=i(149);i.d(e,"ToolTip",(function(){return P.ToolTip}));var _=i(305);i.d(e,"ImageValue",(function(){return _.ImageValue})),i.d(e,"ImageBBCodeValue",(function(){return _.ImageBBCodeValue})),i.d(e,"DynamicImageValue",(function(){return _.DynamicImageValue}));var v=i(306);i.d(e,"InputView",(function(){return v.InputView}));var b=i(307);i.d(e,"ButtonState",(function(){return b.ButtonState})),i.d(e,"ThreeSliceButton",(function(){return b.ThreeSliceButton}));var T=i(83);i.d(e,"ThreeSlicePath",(function(){return T.ThreeSlicePath}));var S=i(308);i.d(e,"TweenCompent",(function(){return S.TweenCompent}));var x=i(309);i.d(e,"ValueContainer",(function(){return x.ValueContainer}));var w=i(310);i.d(e,"GridLayoutGroup",(function(){return w.GridLayoutGroup})),i.d(e,"AlignmentType",(function(){return w.AlignmentType})),i.d(e,"CornerType",(function(){return w.CornerType})),i.d(e,"AxisType",(function(){return w.AxisType})),i.d(e,"ConstraintType",(function(){return w.ConstraintType}));var D=i(150);i.d(e,"SoundButton",(function(){return D.SoundButton}));var C=i(151);i.d(e,"PropItem",(function(){return C.PropItem}));var I=i(311);i.d(e,"ItemsConsumeFunPanel",(function(){return I.ItemsConsumeFunPanel}));var k=i(53);i.d(e,"NinePatch",(function(){return k.NinePatch}));var B=i(85);i.d(e,"ItemSlot",(function(){return B.ItemSlot}));var E=i(312);for(var g in E)["default","DynamicImage","DynamicNinepatch","DynamicSprite","InputPanel","CheckboxGroup","TextButton","LabelInput","BasePanel","NinePatchButton","AlertView","Buttons","ItemInfoTips","TextToolTips","ToolTip","ImageValue","ImageBBCodeValue","DynamicImageValue","InputView","ButtonState","ThreeSliceButton","ThreeSlicePath","TweenCompent","ValueContainer","GridLayoutGroup","AlignmentType","CornerType","AxisType","ConstraintType","SoundButton","PropItem","ItemsConsumeFunPanel","NinePatch","ItemSlot"].indexOf(g)<0&&function(t){i.d(e,t,(function(){return E[t]}))}(g);var A=i(313);for(var g in A)["default","DynamicImage","DynamicNinepatch","DynamicSprite","InputPanel","CheckboxGroup","TextButton","LabelInput","BasePanel","NinePatchButton","AlertView","Buttons","ItemInfoTips","TextToolTips","ToolTip","ImageValue","ImageBBCodeValue","DynamicImageValue","InputView","ButtonState","ThreeSliceButton","ThreeSlicePath","TweenCompent","ValueContainer","GridLayoutGroup","AlignmentType","CornerType","AxisType","ConstraintType","SoundButton","PropItem","ItemsConsumeFunPanel","NinePatch","ItemSlot"].indexOf(g)<0&&function(t){i.d(e,t,(function(){return A[t]}))}(g);var O=i(152);i.d(e,"DragDropIcon",(function(){return O.DragDropIcon}));var M=i(153);i.d(e,"IconBtn",(function(){return M.IconBtn}));var R=i(314);i.d(e,"IconSelectBtn",(function(){return R.IconSelectBtn}));var F=i(315);i.d(e,"MaterialItem",(function(){return F.MaterialItem}));var N=i(154);i.d(e,"ProgressMaskBar",(function(){return N.ProgressMaskBar}));var L=i(61);i.d(e,"ButtonEventDispatcher",(function(){return L.ButtonEventDispatcher}));var H=i(316);i.d(e,"CommonBackground",(function(){return H.CommonBackground}));var G=i(317);i.d(e,"BackgroundScaleButton",(function(){return G.BackgroundScaleButton}));var U=i(318);i.d(e,"ProgressThreeMaskBar",(function(){return U.ProgressThreeMaskBar}));var z=i(319);i.d(e,"ProgressThreeBar",(function(){return z.ProgressThreeBar}));var j=i(320);i.d(e,"ToggleColorButton",(function(){return j.ToggleColorButton}));var V=i(321);i.d(e,"ToggleButton",(function(){return V.ToggleButton}));var W=i(322);i.d(e,"MoreButtonPanel",(function(){return W.MoreButtonPanel}));var Y=i(323);i.d(e,"TextureSprite",(function(){return Y.TextureSprite}));var K=i(324);i.d(e,"InputField",(function(){return K.InputField}))},,function(t,e,i){"use strict";i.d(e,"e",(function(){return n})),i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return o})),i.d(e,"d",(function(){return h}));var n="render",a="mainWorker",s="physicalPeer",o="js/mainWorker.js",h="js/physicalWorker.js"},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(27),a=function(){function Position45(){}return Position45.transformTo90=function(t,e){e.rows,e.tileWidth;return new n.a((t.x-t.y)*(e.tileWidth/2),(t.x+t.y)*(e.tileHeight/2))},Position45.transformTo45=function(t,e){e.rows,e.tileWidth;return new n.a(Math.floor((t.y+t.z)/e.tileHeight+t.x/e.tileWidth),Math.floor((t.y+t.z)/e.tileHeight-t.x/e.tileWidth))},Position45}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(1),a=i(2),s=function(){function AnimationModel(t){var e=t.baseLoc.split(",");this.mNode=t.node,this.id=t.node.id,this.name=t.node.name,this.frameName=t.frameName,!t.frameName||this.frameName.length,this.loop=t.loop,t.loop,t.frameRate,t.originPoint,t.baseLoc,this.frameRate=t.frameRate,this.baseLoc=new a.LogicPoint(parseInt(e[0],10),parseInt(e[1],10));var i=t.originPoint;this.originPoint=new a.LogicPoint(i[0],i[1]),"string"==typeof t.collisionArea?this.collisionArea=this.stringToArray(t.collisionArea,",","&")||[[0]]:this.collisionArea=t.collisionArea||[[0]],"string"==typeof t.walkableArea?this.walkableArea=this.stringToArray(t.walkableArea,",","&")||[[0]]:this.walkableArea=t.walkableArea||[[0]],this.interactiveArea=t.interactiveArea,this.changeLayer(t.layer),this.mountLayer=t.mountLayer}return AnimationModel.prototype.changeLayer=function(t){this.layer=t,this.layer.length<1&&(this.layer=[{frameName:this.frameName,offsetLoc:this.baseLoc}])},AnimationModel.prototype.createProtocolObject=function(){var t=n.op_gameconfig_01.AnimationData.create();t.node=this.mNode,t.baseLoc=this.baseLoc.x+","+this.baseLoc.y,t.node.name=this.name,t.loop=this.loop,t.frameRate=this.frameRate,t.frameName=this.frameName,t.originPoint=[this.originPoint.x,this.originPoint.y],t.walkOriginPoint=[this.originPoint.x,this.originPoint.y],t.walkableArea=this.arrayToString(this.walkableArea,",","&"),t.collisionArea=this.arrayToString(this.collisionArea,",","&"),t.interactiveArea=this.interactiveArea;for(var e=[],i=0,a=this.layer;i<a.length;i++){var s=a[i];e.push(n.op_gameconfig_01.AnimationLayer.create(s))}return t.layer=e,this.changeLayer(t.layer),t.mountLayer=this.mountLayer,t},AnimationModel.prototype.stringToArray=function(t,e,i){if(t){for(var n=[],a=0,s=t.split(i);a<s.length;a++){var o=s[a].split(e);n.push(o.map((function(t){return parseInt(t,10)})))}return n}},AnimationModel.prototype.arrayToString=function(t,e,i){if(!t)return"";for(var n=[],a=0,s=t;a<s.length;a++){var o=s[a];n.push(o.join(e))}return n.join(i)},AnimationModel}()},,,,,function(t,e,i){"use strict";var n,a,s,o,h;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o})),function(t){t.LinkWorker="LinkWorker",t.CreateManager="CreateManager",t.CreateAccount="CreateAccount",t.InitWorld="InitWorld",t.StartConnect="StartConnect",t.RequestToken="RequestToken",t.GetToken="GetToken",t.EnterWorld="EnterWorld",t.PlayerInit="PlayerInit",t.LoadGameConfig="LoadGameConfig",t.CompleteDecodeConfig="CompleteDecodeConfig",t.GameCreate="GameCreate",t.EnterScene="EnterScene",t.SceneCreate="SceneCreate",t.RoomCreate="RoomCreate",t.RoomInfo="RoomInfo"}(n||(n={})),function(t){t[t.StartConnect=0]="StartConnect",t[t.Connect=1]="Connect",t[t.ReConnect=2]="ReConnect",t[t.CloseConnect=3]="CloseConnect",t[t.DisConnect=4]="DisConnect"}(a||(a={})),function(t){t[t.ScenePreLoad=0]="ScenePreLoad",t[t.SceneCreate=1]="SceneCreate",t[t.SceneChange=2]="SceneChange"}(s||(s={})),function(t){t.IDLE="idle",t.WALK="walk",t.RUN="run",t.ATTACK="attack",t.JUMP="jump",t.INJURED="injured",t.FAILED="failed",t.DANCE01="dance01",t.DANCE02="dance02",t.FISHING="fishing",t.GREET01="greet01",t.SIT="sit",t.LIE="lit",t.EMOTION01="emotion01"}(o||(o={})),function(t){t[t.CREATEWORLD=0]="CREATEWORLD",t[t.DESTROYWORLD=1]="DESTROYWORLD"}(h||(h={}))},,,,,function(t,e,i){"use strict";i.d(e,"f",(function(){return h})),i.d(e,"d",(function(){return l})),i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return p})),i.d(e,"c",(function(){return d})),i.d(e,"e",(function(){return u}));var n,a=i(0),s=i(14),o=i(17);!function(t){t[t.TU_DING_COIN=0]="TU_DING_COIN",t[t.QING_SONG_TANG=1]="QING_SONG_TANG",t[t.GOLD_COIN=2]="GOLD_COIN",t[t.COIN=3]="COIN",t[t.DIAMOND=4]="DIAMOND"}(n||(n={}));var h=function(){function Url(){}return Url.getRes=function(t){return Url.RES_PATH+t},Url.getUIRes=function(t,e){return Url.RESUI_PATH+(t+"x/")+e},Url.getNormalUIRes=function(t){return Url.RESUI_PATH+t},Url.getOsdRes=function(t){return Url.OSD_PATH?(a.HTTP_REGEX.test(Url.OSD_PATH),Url.OSD_PATH+t):t},Url.OSD_PATH="",Url.RES_PATH="",Url.RESUI_PATH="",Url}(),l=function(){function ResUtils(){}return ResUtils.getPartName=function(t){return t+"_png"},ResUtils.getPartUrl=function(t){return a.HTTP_REGEX.test(h.OSD_PATH),h.OSD_PATH+"avatar/part/"+t+".png"},ResUtils.getGameConfig=function(t){return a.HTTP_REGEX.test(t)?t:h.OSD_PATH+t},ResUtils}(),c=(function(){function BlackButton(){}BlackButton.getName=function(){return"black_button"},BlackButton.getPNG=function(){return h.getRes("ui/common/button.png")},BlackButton.getColumns=function(){return[4,2,4]},BlackButton.getRows=function(){return[4,2,4]},BlackButton.getConfig=function(){return{top:4,left:4,right:4,bottom:4}}}(),function(){function BlueButton(){}BlueButton.getName=function(){return"button_blue"},BlueButton.getPNG=function(){return h.getRes("ui/common/button_blue.png")},BlueButton.getJSON=function(){return h.getRes("ui/common/button_blue.json")},BlueButton.getColumns=function(){return[7,1,7]},BlueButton.getRows=function(){return[7,1,7]},BlueButton.getConfig=function(){return{left:7,top:7,right:7,bottom:7}}}(),function(){function WhiteButton(){}WhiteButton.getName=function(){return"button_white"},WhiteButton.getPNG=function(){return h.getRes("ui/common/button_white.png")},WhiteButton.getJSON=function(){return h.getRes("ui/common/button_white.json")},WhiteButton.getColumns=function(){return[7,1,7]},WhiteButton.getRows=function(){return[7,1,7]},WhiteButton.getConfig=function(){return{left:7,top:7,right:7,bottom:7}}}(),function(){function CloseButton(){}CloseButton.getName=function(){return"common_clsBtn"},CloseButton.getPNG=function(){return h.getRes("ui/common/common_clsBtn.png")},CloseButton.getJSON=function(){return h.getRes("ui/common/common_clsBtn.json")},CloseButton.getFrameConfig=function(){return{frameWidth:16,frameHeight:16,startFrame:1,endFrame:3}}}(),function(){function Background(){}return Background.getName=function(){return"common_background"},Background.getPNG=function(){return h.getRes("ui/common/common_panelBg.png")},Background.getColumns=function(){return[11,9,11]},Background.getRows=function(){return[14,13,14]},Background.getConfig=function(){return{left:10,top:15,right:10,bottom:15}},Background}()),p=function(){function Border(){}return Border.getName=function(){return"common_border"},Border.getPNG=function(){return h.getRes("ui/common/common_border.png")},Border.getColumns=function(){return[4,2,4]},Border.getRows=function(){return[4,2,4]},Border.getConfig=function(){return{left:4,top:4,right:4,bottom:4}},Border}(),d=(function(){function TransparentButton(){}TransparentButton.getName=function(){return"button_transparent"},TransparentButton.getPNG=function(){return h.getRes("ui/common/button_transparent.png")},TransparentButton.getJSON=function(){return h.getRes("ui/common/button_transparent.json")},TransparentButton.getConfig=function(){return{left:4,top:4,right:4,bottom:4}}}(),function(){function Coin(){}return Coin.getIcon=function(t){var e="tuding_icon",i=t;return i===n.COIN?e="iv_coin":i===n.DIAMOND?e="iv_diamond":i===n.GOLD_COIN||i===n.QING_SONG_TANG||n.TU_DING_COIN,e},Coin.getName=function(t){var e="银币",i=t;return i===n.COIN?e=o.a.t("coin.coin"):i===n.DIAMOND?e=o.a.t("coin.diamond"):i===n.GOLD_COIN?e=o.a.t("coin.gold_coin"):i===n.QING_SONG_TANG||n.TU_DING_COIN,e},Coin}()),u=function(){function UIHelper(){}return Object.defineProperty(UIHelper,"threeGreenNormal",{get:function(){return["butt_green_left","butt_green_middle","butt_green_right"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeRedNormal",{get:function(){return["butt_red_left","butt_red_middle","butt_red_right"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeYellowNormal",{get:function(){return["butt_yellow_left","butt_yellow_middle","butt_yellow_right"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeGreenSmall",{get:function(){return["butt_green_left_s","butt_green_middle_s","butt_green_right_s"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeRedSmall",{get:function(){return["butt_red_left_s","butt_red_middle_s","butt_red_right_s"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeYellowSmall",{get:function(){return["butt_yellow_left_s","butt_yellow_middle_s","butt_yellow_right_s"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeGreenBig",{get:function(){return["butt_green_left_b","butt_green_middle_b","butt_green_right_b"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeRedBig",{get:function(){return["butt_red_left_b","butt_red_middle_b","butt_red_right_b"]},enumerable:!1,configurable:!0}),Object.defineProperty(UIHelper,"threeYellowBig",{get:function(){return["butt_yellow_left_b","butt_yellow_middle_b","butt_yellow_right_b"]},enumerable:!1,configurable:!0}),UIHelper.colorStyle=function(t,e){return{fontSize:e,fontFamily:s.a.DEFULT_FONT,color:t}},UIHelper.colorNumberStyle=function(t,e){return{fontSize:e,fontFamily:s.a.NUMBER,color:t}},UIHelper.titleYellowStyle_m=function(t,e){return void 0===e&&(e=20),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#905B06"}},UIHelper.blackStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#000000"}},UIHelper.whiteStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#ffffff"}},UIHelper.brownishStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#996600"}},UIHelper.yellowStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#ffd136"}},UIHelper.redStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#E33922"}},UIHelper.blueStyle=function(t,e){return void 0===e&&(e=12),{fontSize:e*t,fontFamily:s.a.DEFULT_FONT,color:"#2B4BB5"}},UIHelper.background_w=function(t){return{left:50*t,top:30*t,right:30*t,bottom:95*t}},UIHelper.background_w_s=function(t){return{left:50*t,top:30*t,right:30*t,bottom:70*t}},UIHelper.background_n=function(t){return{left:30*t,top:40*t,right:30*t,bottom:40*t}},UIHelper.button=function(t){return{left:14*t,top:14*t,right:14*t,bottom:14*t}},UIHelper.spliceText=function(t,e,i,n){for(var a=this.Text(n),s=0;s<e.length;s++){var o=e.slice(0,s);if(a.setText(e).width>t)return o}return e},UIHelper.Text=function(t){return this.mText||(this.mText=t.make.text(this.whiteStyle,!1)),this.mText},UIHelper.createSprite=function(t,e,i,n,a,s,o,h){void 0===s&&(s=30),void 0===o&&(o=0);var l=t.make.sprite({key:e,frame:n+"1"});l.visible=!1;var c=t.anims.create({key:i,frames:t.anims.generateFrameNames(e,{prefix:n+"",start:a[0],end:a[1]}),frameRate:s,repeat:o});return c.removeAllListeners(),c.on(Phaser.Animations.Events.ANIMATION_COMPLETE,(function(){l.visible=!1,h&&h.run()}),this),c.on(Phaser.Animations.Events.ANIMATION_START,(function(){l.visible=!0}),this),l},UIHelper.createMessageBoxConfig=function(t,e,i,n,a){return{text:[{text:t}],title:[{text:e}],button:[{text:o.a.t("common.cancel"),local:!0,param:0},{text:o.a.t("common.confirm"),local:!0,clickhandler:{key:i,clickfun:n},param:1,data:a}]}},UIHelper.createMessageBox=function(t,e,i,n,s,o,h){var l=UIHelper.createMessageBoxConfig(s,n,i,"messageboxcallback",h);e.messageboxcallback=o,t.mainPeer.showMediator(a.ModuleName.PICAMESSAGEBOX_NAME,!0,l)},UIHelper.playtPosYTween=function(t,e,i,n,a,s,o,h,l){void 0===a&&(a=500),void 0===s&&(s="Bounce.easeOut");var c=l?function(t,e){l&&l.runWith(e.value)}:void 0,p=t.tweens.add({targets:e,y:{from:i,to:n},ease:s,duration:a,delay:o,onComplete:function(){p.stop(),p.remove(),h&&h.run()},onUpdate:c});return p},UIHelper.playtPosXTween=function(t,e,i,n,a,s,o,h,l){void 0===a&&(a=500),void 0===s&&(s="Bounce.easeOut");var c=l?function(t,e){l&&l.runWith(e.value)}:void 0,p=t.tweens.add({targets:e,x:{from:i,to:n},ease:s,duration:a,delay:o,onComplete:function(){p.stop(),p.remove(),h&&h.run()},onUpdate:c});return p},UIHelper.playAlphaTween=function(t,e,i,n,a,s,o,h,l){void 0===a&&(a=500),void 0===s&&(s="Linear");var c=l?function(t,e){l&&l.runWith(e.value)}:void 0,p=t.tweens.add({targets:e,alpha:{from:i,to:n},ease:s,duration:a,delay:o,onComplete:function(){p.stop(),p.remove(),h&&h.runWith(n)},onUpdate:c});return p},UIHelper.playScaleTween=function(t,e,i,n,a,s,o,h,l){void 0===a&&(a=500),void 0===s&&(s="Linear");var c=l?function(t,e){l&&l.runWith(e.value)}:void 0,p=t.tweens.add({targets:e,scaleX:{from:i,to:n},scaleY:{from:i,to:n},ease:s,duration:a,delay:o,onComplete:function(){p.stop(),p.remove(),h&&h.runWith(n)},onUpdate:c});return p},UIHelper}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function MessageType(){}return MessageType.CREATE_ROLE="create_role",MessageType.APP_START="app_start",MessageType.EDITOR_CHANGE_MODE="editor_change_mode",MessageType.CLIENT_RESIZE="app_client_resize",MessageType.SCENE_INITIALIZED="SCENE_INITIALIZED",MessageType.SCENE_CLEARED="SCENE_CLEARED",MessageType.SCENE_CHANGE_TO="SCENE_CHANGE_TO",MessageType.SCENE_MOVE_TO="scene_move_to",MessageType.SCENE_MOVE_STOP="scene_move_stop",MessageType.CHANGE_ELEMENT_ANIMATION="change_element_animation",MessageType.CHANGE_CHARACTER_ANIMATION="change_character_animation",MessageType.CHAT_TO="chat_to",MessageType.SHOW_CHAT_BUBBLE="show_chat_bubble",MessageType.REMOVE_CHAT_BUBBLE="remove_chat_bubble",MessageType.PROMPT_ALERT="prompt_alert",MessageType.CHARACTER_TALING="characterTaling",MessageType.CHARACTER_SHUT_UP="characterShutUp",MessageType.QCLOUD_AUTH="qcloud_auth",MessageType.ENTER_SCENE="enter_scene",MessageType.SCENE_ADD_PLAYER="scene_add_player",MessageType.SCENE_REMOVE_PLAYER="scene_remove_player",MessageType.SCENE_UPDATE_PLAYER="scene_update_player",MessageType.SCENE_ADD_ELEMENT="scene_add_element",MessageType.SCENE_ADD_TERRAIN="scene_add_terrain",MessageType.SCENE_ADD_TERRAIN_END="scene_add_terrain_end",MessageType.SCENE_ADD_ALL_TERRAIN="scene_add_all_terrain",MessageType.SCENE_REMOVE_ELEMENT="scene_remove_element",MessageType.SCENE_REMOVE_TERRAIN="scene_remove_terrain",MessageType.SCENE_REMOVE_ALL_TERRAIN="scene_remove_all_terrain",MessageType.SCENE_MOUSE_FOLLOW="scene_mouse_follow",MessageType.SCENE_SELECT_ELEMENT="scene_select_element",MessageType.SCENE_FIXED_TO_ELEMENT="scene_fixed_to_element",MessageType.SCENE_UPDATE_ELEMENT="sceneUpdateElement",MessageType.SCENE_SYNCHRO_PACKAGE="sceneSynchroPackage",MessageType.SCENE_VISIBLE_GRID="sceneVisibleGrid",MessageType.PLAYER_SELECT_CHARACTER="player_select_character",MessageType.PLAYER_DATA_INITIALIZE="player_data_initialize",MessageType.SCENE_DATA_INITIALIZE="scene_data_initialize",MessageType.PACKAGE_ITEM_ADD="package_item_add",MessageType.PACKAGE_ITEM_REMOVE="package_item_remove",MessageType.PACKAGE_EXCHANGE_ITEM_POS="package_exchange_item_pos",MessageType.SCENE_BACKGROUND_CLICK="SCENE_BACKGROUND_CLICK",MessageType.CHANGE_SELF_AVATAR="CHANGE_SELF_AVATAR",MessageType.DRAG_TO_DROP="DRAG_TO_DROP",MessageType.DRAG_OVER_DROP="DRAG_OVER_DROP",MessageType.QUERY_PACKAGE="query_package",MessageType.SYNC_USER_BALANCE="syncUserBalance",MessageType.UPDATED_CHARACTER_PACKAGE="updatedCharacterPackage",MessageType.SHOW_EFFECT="showEffect",MessageType.EDIT_MODE_QUERY_PACKAGE="editModeQueryPackage",MessageType.PRESS_ELEMENT="PRESS_ELEMENT",MessageType.TURN_ELEMENT="turnElement",MessageType.RECYCLE_ELEMENT="recycleElement",MessageType.PUT_ELEMENT="putElement",MessageType.CANCEL_PUT="cancelPut",MessageType.EDIT_PACKAGE_EXPANED="editPackageExpaned",MessageType.EDIT_PACKAGE_COLLAPSE="editPackageCollapse",MessageType.SELECTED_DECORATE_ELEMENT="selectedDecorateElement",MessageType.CANCEL_DECORATE_ELEMENT="cancelDecorateElement",MessageType.ADD_ICON_TO_TOP="addIconToTop",MessageType.REMOVE_ICON_FROM_TOP="removeIconFromTop",MessageType.SHOW_UI="showUI",MessageType.SHOW_NOTICE="showNotice",MessageType}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var n=i(1),a=function(){function AvatarSuitType(){this.costume=["bodyCostId","bodyCostDresId","farmCostId","barmCostId","flegCostId","blegCostId"],this.hair=["headHairId","headHairBackId"],this.eye=["headEyesId"],this.mouse=["headMousId"],this.hat=["headHatsId"],this.mask=["headMaskId"],this.face=["headFaceId"],this.weapon=["farmWeapId","barmWeapId"],this.shield=["farmShldId","barmShldId"],this.tail=["bodyTailId"],this.wing=["bodyWingId"],this.helmet=["headSpecId"],this.shell=["bodySpecId","farmSpecId","barmSpecId","flegSpecId","blegSpecId"],this.baseSuitType='[{"count":1,"id":"10001","sn":"5cd28238fb073710972a73c2","suit_type":"costume"},{"count":1,"id":"10002","sn":"5cd28238fb073710972a73c2","suit_type":"eye"},{"count":1,"id":"1003","sn":"5cd28238fb073710972a73c2","suit_type":"hair"},{"count":1,"id":"10004","sn":"5cd28238fb073710972a73c2","suit_type":"mouse"}]',this.base=["headBaseId","bodyBaseId","farmBaseId","barmBaseId","flegBaseId","blegBaseId"]}return AvatarSuitType.createAvatar=function(t,e){this.avatarSuit=this.avatarSuit||new AvatarSuitType,e=e||{};for(var i=0,n=t;i<n.length;i++)for(var a=n[i],s=this.avatarSuit[a.suit_type],o=this.checkSlotValue(a.suit_type,a.slot),h=0,l=s;h<l.length;h++){var c=l[h];-1!==o.indexOf(c)?e[c]={sn:a.sn,suit_type:a.suit_type,slot:a.slot,tag:a.tag,version:a.version}:e[c]={sn:"",suit_type:a.suit_type,slot:a.slot,tag:a.tag,version:a.version}}return e},AvatarSuitType.createAvatarBySn=function(t,e,i,n,a,s){this.avatarSuit=this.avatarSuit||new AvatarSuitType,s=s||{};for(var o=this.avatarSuit[t],h=this.checkSlotValue(t,i),l=0,c=o;l<c.length;l++){var p=c[l];-1!==h.indexOf(p)?s[p]={sn:e,suit_type:t,slot:i,tag:n,version:a}:s[p]={sn:"",suit_type:t,slot:i,tag:n,version:a}}return s},AvatarSuitType.createHasBaseAvatar=function(t){this.avatarSuit=this.avatarSuit||new AvatarSuitType;for(var e=this.createBaseAvatar(),i=0,n=t;i<n.length;i++){var a=n[i],s=this.avatarSuit[a.suit_type];if(s)for(var o=this.checkSlotValue(a.suit_type,a.slot),h=0,l=s;h<l.length;h++){var c=l[h];-1!==o.indexOf(c)?e[c]={sn:a.sn,suit_type:a.suit_type,slot:a.slot,tag:a.tag,version:a.version}:e[c]={sn:"",suit_type:a.suit_type,slot:a.slot,tag:a.tag,version:a.version}}}return e},AvatarSuitType.createHasBaseAvatarBySn=function(t,e,i,n,a){this.avatarSuit=this.avatarSuit||new AvatarSuitType;for(var s=this.createBaseAvatar(),o=this.avatarSuit[t],h=this.checkSlotValue(t,i),l=0,c=o;l<c.length;l++){var p=c[l];-1!==h.indexOf(p)?s[p]={sn:e,suit_type:t,slot:i,tag:n,version:a}:s[p]={sn:"",suit_type:t,slot:i,tag:n,version:a}}return s},AvatarSuitType.createBaseAvatar=function(){return this.avatarSuit=this.avatarSuit||new AvatarSuitType,new o},AvatarSuitType.hasAvatarSuit=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];if("PKT_AVATAR_SUITS"===n.key&&n.value&&n.value.length>0&&JSON.parse(n.value).length>0)return!0}return!1},AvatarSuitType.checkSlotValue=function(t,e){if(!this.slotBitMap){this.slotBitMap=new Map;var i=n.op_def.AvatarSlot;for(var a in i)if("string"==typeof a){var s=this.toHumpName(a)+"Id";this.slotBitMap.set(s,i[a])}}var o=[],h=this.avatarSuit[t];if(h){for(var l=void 0===e||""===e?[]:e.split("#"),c=0;c<h.length;c++){var p=h[c],d=this.slotBitMap.get(p),u=1<<d%32,m=Math.floor(d/32);if(l.length>m){var f=l[m];(u&parseInt(atob(f),10))===u&&o.push(p)}else o.push(p)}return o}},AvatarSuitType.toHumpName=function(t){return t.replace(/([^_])(?:_+([^_]))/g,(function(t,e,i){return e+i.toUpperCase()}))},AvatarSuitType.getSuitsFromItem=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var a=n[i],s={id:a.id,suit_type:a.suitType,slot:a.slot,tag:a.tag,sn:a.sn,version:a.version};e.push(s)}return{avatar:AvatarSuitType.createHasBaseAvatar(e),suits:e}},AvatarSuitType.suitPart={costume:["body_cost","body_cost_dres","farm_cost","barm_cost","fleg_cost","bleg_cost"],hair:["head_hair","head_hair_back"],eye:["head_eyes"],mouse:["head_mous"],hat:["head_hats"],mask:["head_mask"],face:["head_face"],weapon:["weap_farm","weap_barm"],shield:["shld_farm","shld_barm"],tail:["body_tail"],wing:["body_wing"],helmet:["head_spec"],shell:["body_spec","farm_spec","barm_spec","fleg_spec","bleg_spec"],base:["head_base","body_base","farm_base","barm_base","fleg_base","bleg_base"]},AvatarSuitType}(),s=function(){function SuitAlternativeType(){this.costume=1,this.hair=2,this.eye=4,this.mouse=8,this.hat=16,this.mask=32,this.face=64,this.weapon=128,this.shield=256,this.tail=512,this.wing=1024,this.helmet=126,this.shell=1537}return SuitAlternativeType.checkAlternative=function(t,e){this.suitAlternative=this.suitAlternative||new SuitAlternativeType;var i=this.suitAlternative[t],n=this.suitAlternative[e],a=i&n;return a===i||a===n},SuitAlternativeType}(),o=function o(){this.id="10000",this.barmBaseId={sn:"0001"},this.blegBaseId={sn:"0001"},this.bodyBaseId={sn:"0001"},this.farmBaseId={sn:"0001"},this.flegBaseId={sn:"0001"},this.headBaseId={sn:"0001"},this.headHairId={sn:"5cd28238fb073710972a73c2"},this.headEyesId={sn:"5cd28238fb073710972a73c2"},this.headMousId={sn:"5cd28238fb073710972a73c2"},this.bodyCostId={sn:"5cd28238fb073710972a73c2"}}},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Handler(t,e,i,n){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),this.once=!1,this._id=0,this.setTo(t,e,i,n)}return Handler.create=function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=!0),Handler._pool.length?Handler._pool.pop().setTo(t,e,i,n):new Handler(t,e,i,n)},Handler.prototype.setTo=function(t,e,i,n){return this._id=Handler._gid++,this.caller=t,this.method=e,this.args=i,this.once=n,this},Handler.prototype.run=function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e},Handler.prototype.runWith=function(t){if(null==this.method)return null;var e=this._id;if(null==t)var i=this.method.apply(this.caller,this.args);else i=this.args||t instanceof Array?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===e&&this.once&&this.recover(),i},Handler.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Handler.prototype.recover=function(){this._id>0&&(this._id=0,Handler._pool.push(this.clear()))},Handler._pool=[],Handler._gid=1,Handler}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Pos(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.depth=0|n}return Pos.prototype.add=function(t,e,i){return this.x+=t,this.x+=e,this.z+=i||0,this},Pos.prototype.equal=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.depth===this.depth},Pos.prototype.toString=function(){return"Pos >> x: "+this.x+", y: "+this.y+", z: "+this.z+", depth: "+this.depth},Pos.prototype.toPoint=function(){return new Pos(this.x,this.y)},Pos}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function LogicRectangle(t,e,i,n){this.x=0,this.y=0,this.width=0,this.height=0,void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}return Object.defineProperty(LogicRectangle.prototype,"left",{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(LogicRectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x},enumerable:!1,configurable:!0}),Object.defineProperty(LogicRectangle.prototype,"top",{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(LogicRectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y},enumerable:!1,configurable:!0}),LogicRectangle.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e)},LogicRectangle}()},function(t,e,i){"use strict";i.r(e),i.d(e,"NinePatch",(function(){return o}));var n,a=i(332),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function NinePatch(e,i,n,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.config=c||p.scene.cache.custom.ninePatch.get(l?""+l:h),p.patchKey=1e3*Math.random()+"",p.config.top=Math.round(p.config.top),p.config.right&&(p.config.right=Math.round(p.config.right)),p.config.bottom&&(p.config.bottom=Math.round(p.config.bottom)),p.config.left&&(p.config.left=Math.round(p.config.left)),Object(a.normalizePatchesConfig)(p.config),p.setSize(s,o),p.setTexture(h,l),p}return s(NinePatch,t),NinePatch.prototype.resize=function(t,e){return t=Math.round(t),e=Math.round(e),this.config?this.width===t&&this.height===e?this:(t=Math.max(t,this.config.left+this.config.right+1),e=Math.max(e,this.config.top+this.config.bottom+1),this.setSize(t,e),void this.drawPatches()):this},NinePatch.prototype.setTexture=function(t,e){return this.originTexture=this.scene.textures.get(t),this.setFrame(e),this.originTexture.setFilter(Phaser.Textures.FilterMode.LINEAR),this},NinePatch.prototype.setFrame=function(t){return this.originFrame=this.originTexture.frames[t]||this.originTexture.frames[NinePatch.__BASE],this.createPatches(),this.drawPatches(),this},NinePatch.prototype.setSize=function(e,i){return t.prototype.setSize.call(this,e,i),this.finalXs=[0,this.config.left,this.width-this.config.right,this.width],this.finalYs=[0,this.config.top,this.height-this.config.bottom,this.height],this},NinePatch.prototype.setTint=function(t){return this.tint=t,this},NinePatch.prototype.setTintFill=function(t){return this.tint=t,this.tintFill=!0,this},Object.defineProperty(NinePatch.prototype,"tintFill",{get:function(){return this.first&&this.first.tintFill},set:function(t){this.each((function(e){return e.tintFill=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(NinePatch.prototype,"tint",{set:function(t){this.each((function(e){return e.setTintFill(t)})),this.internalTint=t},enumerable:!1,configurable:!0}),Object.defineProperty(NinePatch.prototype,"isTinted",{get:function(){return this.first&&this.first.isTinted},enumerable:!1,configurable:!0}),NinePatch.prototype.clearTint=function(){this.each((function(t){return t.clearTint()})),this.internalTint=void 0,this.tintFill=!1},NinePatch.prototype.destroy=function(){if(this.originTexture)for(var e=0,i=0;i<3;i++)for(var n=0;n<3;n++){var a=this.getPatchNameByIndex(e);this.originTexture.frames.hasOwnProperty(a)&&this.originTexture.remove(a),++e}t.prototype.destroy.call(this)},NinePatch.prototype.getPatchNameByIndex=function(t){return this.originFrame.name+NinePatch.patches[t]+this.patchKey},NinePatch.prototype.createPatches=function(){for(var t=[0,this.config.left,this.originFrame.width-this.config.right,this.originFrame.width],e=[0,this.config.top,this.originFrame.height-this.config.bottom,this.originFrame.height],i=0,n=0;n<3;n++)for(var a=0;a<3;a++)this.createPatchFrame(this.getPatchNameByIndex(i),t[a],e[n],t[a+1]-t[a],e[n+1]-e[n]),++i},NinePatch.prototype.drawPatches=function(){var t=this.tintFill;this.removeAll(!0);for(var e=0,i=0;i<3;i++)for(var n=0;n<3;n++){var a=this.originTexture.frames[this.getPatchNameByIndex(e)],s=new Phaser.GameObjects.Image(this.scene,0,0,a.texture.key,a.name);s.setOrigin(0),s.setPosition((1e3*this.finalXs[n]-this.width*this.originX*1e3)/1e3,(1e3*this.finalYs[i]-this.height*this.originY*1e3)/1e3),s.displayWidth=this.finalXs[n+1]-this.finalXs[n],s.displayHeight=this.finalYs[i+1]-this.finalYs[i],this.add(s),this.internalTint&&s.setTint(this.internalTint),s.tintFill=t,s.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),++e}},NinePatch.prototype.createPatchFrame=function(t,e,i,n,a){this.originTexture.frames.hasOwnProperty(t)||this.originTexture.add(t,this.originFrame.sourceIndex,this.originFrame.cutX+e,this.originFrame.cutY+i,n,a)},NinePatch.__BASE="__BASE",NinePatch.patches=["[0][0]","[1][0]","[2][0]","[0][1]","[1][1]","[2][1]","[0][2]","[1][2]","[2][2]"],NinePatch}(Phaser.GameObjects.Container)},,,,,,function(t,e,i){"use strict";i.r(e),i.d(e,"DynamicImage",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function DynamicImage(e,i,n,a,s){return t.call(this,e,i,n,a,s)||this}return s(DynamicImage,t),DynamicImage.prototype.load=function(t,e,i,n){this.mLoadCompleteCallbak=i,this.mLoadErrorCallback=n,this.mLoadContext=e,this.scene?(this.mUrl=t,this.scene.textures.exists(t)?this.onLoadComplete(t):(this.scene.load.image(t,t),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start())):a.Logger.getInstance().fatal(DynamicImage.name+" Create failed does not exist")},DynamicImage.prototype.destroy=function(e){void 0===e&&(e=!1),this.mLoadCompleteCallbak=null,this.mLoadContext=null,this.mLoadErrorCallback=null,this.mUrl="",this.scene&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this)),t.prototype.destroy.call(this,e)},DynamicImage.prototype.onLoadComplete=function(t){if(t===this.mUrl&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.setTexture(this.mUrl),this.mLoadCompleteCallbak)){var e=this.mLoadCompleteCallbak;this.mLoadCompleteCallbak=null,e.call(this.mLoadContext),this.mLoadContext=null}},DynamicImage.prototype.onLoadError=function(t){if(this.mUrl===t.url&&this.mLoadErrorCallback){var e=this.mLoadErrorCallback;this.mLoadErrorCallback=null,e.call(this.mLoadContext),this.mLoadContext=null}},DynamicImage}(Phaser.GameObjects.Image)},function(t,e,i){"use strict";i.r(e),i.d(e,"BasePanel",(function(){return l}));var n,a=i(6),s=i(147),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function BasePanel(e,i){var n=t.call(this,e,i)||this;return n.mTweening=!1,n.mWidth=0,n.mHeight=0,n.mReloadTimes=0,n.key="",n.uiLayer=s.a.LAYER_UI,n.exported=!1,n.exportListeners=[],n.mSynchronize=!1,e.sys||o.Logger.getInstance().error("no scene system"),n.mScene=e,n.mWorld=i,n.mInitialized=!1,n.render=i,i&&(n.dpr=Math.round(i.uiRatio||1),n.scale=n.mWorld.uiScale),n}return h(BasePanel,t),Object.defineProperty(BasePanel.prototype,"initialized",{get:function(){return this.mInitialized},enumerable:!1,configurable:!0}),BasePanel.prototype.startLoad=function(){this.scene&&(this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onFileKeyComplete,this),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.loadComplete,this),this.scene.load.start())},BasePanel.prototype.show=function(e){this.mSynchronize=!1,t.prototype.show.call(this,e),this.mInitialized&&(this.mSynchronize||this.onShow())},BasePanel.prototype.hide=function(){t.prototype.hide.call(this),this.onHide()},BasePanel.prototype.destroy=function(){this.render&&this.render.hasOwnProperty(this.key)&&delete this.render[this.key],this.exportListeners.length=0,t.prototype.destroy.call(this)},BasePanel.prototype.addExportListener=function(t){this.exported?t():this.exportListeners.push(t)},BasePanel.prototype.preload=function(){var t=this;if(this.mPreLoad=!0,this.scene){var e=0;this.mResources&&this.mResources.forEach((function(i,n){t.scene.textures.exists(n)||(e++,t.addResources(n,i))}),this),e>0?this.startLoad():(this.mResources&&this.mResources.clear(),this.mPreLoad=!1,this.init(),this.mSynchronize=!0)}},BasePanel.prototype.init=function(){this.mScene.layerManager.addToLayer(this.uiLayer,this),t.prototype.init.call(this),this.setLinear(this.key),o.Logger.getInstance().debug("init========",this.key),this.__exportProperty(),this.onInitialized()},BasePanel.prototype.setLinear=function(t){if(t){var e=this.scene.textures.getFrame(t,"__BASE");e&&e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR)}},BasePanel.prototype.addResources=function(e,i){i.type&&this.scene.load[i.type]&&this.scene.load[i.type](e,o.Url.getUIRes(i.dpr,i.texture),o.Url.getUIRes(i.dpr,i.data)),t.prototype.addResources.call(this,e,i)},Object.defineProperty(BasePanel.prototype,"scaleWidth",{get:function(){return this.scene.cameras.main.width/this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"scaleHeight",{get:function(){return this.scene.cameras.main.height/this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"cameraWidth",{get:function(){return this.scene.cameras.main.width},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"cameraHeight",{get:function(){return this.scene.cameras.main.height},enumerable:!1,configurable:!0}),BasePanel.prototype.__exportProperty=function(){if(this.render)return this.render.exportProperty(this,this.render,this.key).onceReady(this.exportComplete.bind(this))},BasePanel.prototype.exportComplete=function(){this.exported=!0;for(var t=0,e=this.exportListeners;t<e.length;t++){(0,e[t])()}this.exportListeners.length=0},BasePanel.prototype.onShow=function(){},BasePanel.prototype.onHide=function(){},BasePanel.prototype.onInitialized=function(){},BasePanel}(a.Panel)},function(t,e,i){"use strict";i.r(e),i.d(e,"ButtonEventDispatcher",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function ButtonEventDispatcher(e,i,n,a,s){var o=t.call(this,e,i,n)||this;return o.mDownTime=0,o.mPressDelay=1e3,o.mIsMove=!1,o.mTweening=!1,o.tweenScale=.9,o.mTweenBoo=!0,o.mDuration=45,o.soundGroup={up:{key:"click"}},void 0===a&&(a=!0),o.mTweenBoo=a,Object.assign(o.soundGroup,s),o}return s(ButtonEventDispatcher,t),ButtonEventDispatcher.prototype.addListen=function(){this.removeListen(),this.on("pointerdown",this.onPointerDownHandler,this),this.on("pointerup",this.onPointerUpHandler,this),this.on("pointerout",this.onPointerOutHandler,this),this.on("pointermove",this.onPointerMoveHandler,this)},ButtonEventDispatcher.prototype.removeListen=function(){this.off("pointerdown",this.onPointerDownHandler,this),this.off("pointerup",this.onPointerUpHandler,this),this.off("pointerout",this.onPointerOutHandler,this),this.off("pointermove",this.onPointerMoveHandler,this)},Object.defineProperty(ButtonEventDispatcher.prototype,"enable",{set:function(t){t?(this.addListen(),this.setInteractive()):(this.removeListen(),this.removeInteractive())},enumerable:!1,configurable:!0}),ButtonEventDispatcher.prototype.onPointerMoveHandler=function(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move),this.interactiveBoo&&(this.mIsMove=!0,this.EventStateChange(a.ClickEvent.Move),this.emit(a.ClickEvent.Move))},ButtonEventDispatcher.prototype.onPointerUpHandler=function(t){this.interactiveBoo?this.mTweenBoo?this.tween(!1,this.pointerUp.bind(this,t)):this.pointerUp(t):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)},ButtonEventDispatcher.prototype.pointerUp=function(t){var e=this.checkPointerInBounds(this,t.worldX,t.worldY);this.EventStateChange(a.ClickEvent.Up),this.emit(a.ClickEvent.Up,this),e&&this.mIsDown&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.EventStateChange(a.ClickEvent.Tap),this.emit(a.ClickEvent.Tap,t,this)),clearTimeout(this.mPressTime),this.mIsMove=!1,this.mIsDown=!1,this.mDownTime=0},ButtonEventDispatcher.prototype.onPointerOutHandler=function(t){this.mTweenBoo&&t.isDown&&this.tween(!1),this.checkPointerInBounds(this,t.worldX,t.worldY)||this.EventStateChange(a.ClickEvent.Out)},ButtonEventDispatcher.prototype.onPointerDownHandler=function(t){var e=this;this.mTweening||(this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){e.EventStateChange(a.ClickEvent.Hold),e.emit(a.ClickEvent.Hold,e)}),this.mPressDelay),this.mTweenBoo&&this.tween(!0),this.EventStateChange(a.ClickEvent.Down),this.emit(a.ClickEvent.Down,this),this.mIsDown=!0):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled))},ButtonEventDispatcher.prototype.checkPointerInBounds=function(t,e,i){this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var n=t.getWorldTransformMatrix(),a=n.scaleX;this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2;var s=(e-n.tx)/a,o=(i-n.ty)/a;return this.mRectangle.left<=s&&this.mRectangle.right>=s&&this.mRectangle.top<=o&&this.mRectangle.bottom>=o},ButtonEventDispatcher.prototype.EventStateChange=function(t){},ButtonEventDispatcher.prototype.tween=function(t,e){var i=this;this.mTweening=!0;var n=t?this.tweenScale:1;this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTween=this.scene.tweens.add({targets:this,duration:this.mDuration,ease:"Linear",props:{scaleX:{value:n},scaleY:{value:n}},onComplete:function(){i.tweenComplete(t),e&&e()},onCompleteParams:[this]})},ButtonEventDispatcher.prototype.tweenComplete=function(t){this.mTweening=!1,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0)},ButtonEventDispatcher}(a.BaseUI)},,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=/^(http|https):/i},function(t,e,i){"use strict";var n,a;i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return a})),function(t){t.Null="null",t.Friend="friend",t.Fans="fans",t.Followed="followed",t.Blacklist="blacklist"}(n||(n={})),function(t){t[t.Friends=0]="Friends",t[t.Fans=1]="Fans",t[t.Followes=2]="Followes",t[t.Blacklist=3]="Blacklist",t[t.Search=4]="Search",t[t.Menu=5]="Menu",t[t.Notice=6]="Notice",t[t.Null=7]="Null"}(a||(a={}))},function(t,e,i){"use strict";function load(t,e){return new Promise((function(i,n){var a=new XMLHttpRequest;a.onload=function(e){var a=e.currentTarget;a&&200===a.status?i(e.currentTarget):n(t+" load error "+a.status)},a.onerror=function(){n(t+" load error!!!!!")},a.ontimeout=function(e){n(t+" load ontimeout!!!!!")},a.open("GET",t),a.timeout=8e3,a.responseType=e||"",a.send()}))}function loadArr(t){return new Promise((function(e,i){var n=0,a=[],s=new Map,compl=function(){if(t.length===n)0===a.length?e(s):i(a);else{var o=t[n];load(o.path,o.type).then((function(t){s.set(o.resName,t),compl()}),(function(t){a.push(t),compl()}))}n++};compl()}))}i.d(e,"a",(function(){return load})),i.d(e,"b",(function(){return loadArr}))},,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e),i.d(e,"ThreeSlicePath",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function ThreeSlicePath(e,i,n,a,s,o,h,l,c,p){var d=t.call(this,e,l,c)||this;return d.mCorrection=4,d.dpr=l||1,d.scale=c||1,d.mCorrection=void 0===p?4:p,d.imgs=[],d.setTexture(o,h),d.setSize(a,s),d.setPosition(i,n),d}return s(ThreeSlicePath,t),ThreeSlicePath.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),this.width===t&&this.height===e)return this;this.setSize(t,e)},Object.defineProperty(ThreeSlicePath.prototype,"correctValue",{set:function(t){this.mCorrection=t},enumerable:!1,configurable:!0}),ThreeSlicePath.prototype.setTexture=function(t,e){return this.imgs[0]?this.imgs[0].setTexture(t,e[0]):(this.imgs[0]=this.scene.make.image({key:t,frame:e[0]}),this.add(this.imgs[0])),this.imgs[2]?this.imgs[2].setTexture(t,e[2]):(this.imgs[2]=this.scene.make.image({key:t,frame:e[2]}),this.add(this.imgs[2])),this.imgs[1]?this.imgs[1].setTexture(t,e[1]):(this.imgs[1]=this.scene.make.image({key:t,frame:e[1]}),this.add(this.imgs[1])),this},ThreeSlicePath.prototype.setFrame=function(t){return this.imgs[0].setFrame(t[0]),this.imgs[1].setFrame(t[1]),this.imgs[2].setFrame(t[2]),this},ThreeSlicePath.prototype.setSize=function(e,i){t.prototype.setSize.call(this,e,i),this.imgs[0].scale=1,this.imgs[2].scale=1;var n=e-(this.imgs[0].displayWidth+this.imgs[2].displayWidth)+this.mCorrection;return n<0&&(n=0,this.imgs[0].displayWidth=.5*e,this.imgs[2].displayWidth=.5*e),this.imgs[0].x=.5*-e+.5*this.imgs[0].displayWidth,this.imgs[2].x=.5*e-.5*this.imgs[2].displayWidth,this.imgs[1].displayWidth=n,this},ThreeSlicePath.prototype.setTint=function(t){return this.tint=t,this},ThreeSlicePath.prototype.setTintFill=function(t){return this.tint=t,this.tintFill=!0,this},Object.defineProperty(ThreeSlicePath.prototype,"tintFill",{get:function(){return this.first&&this.first.tintFill},set:function(t){this.imgs.forEach((function(e){return e.tintFill=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(ThreeSlicePath.prototype,"tint",{set:function(t){this.imgs.forEach((function(e){return e.setTint(t)})),this.internalTint=t},enumerable:!1,configurable:!0}),Object.defineProperty(ThreeSlicePath.prototype,"isTinted",{get:function(){return this.first&&this.first.isTinted},enumerable:!1,configurable:!0}),ThreeSlicePath.prototype.clearTint=function(){this.each((function(t){return t.clearTint()})),this.internalTint=void 0,this.tintFill=!1},ThreeSlicePath.prototype.destroy=function(){t.prototype.destroy.call(this),this.imgs&&(this.imgs.length=0),this.imgs=void 0},ThreeSlicePath}(a.BaseUI)},,function(t,e,i){"use strict";i.r(e),i.d(e,"ItemSlot",(function(){return l}));var n=i(152),a=i(2),s=i(149),o=i(0),h=i(147),l=function(){function ItemSlot(t,e,i,n,a,s,o,h,l,c,p){this.minitialize=!1,this.mWid=0,this.mHei=0,this.isTipBoo=!0,this.mScene=t,this.mRender=e,this.toolTipCon=t.make.container(void 0,!1),this.toolTipCon.x=n,this.toolTipCon.y=a,i.add(this.toolTipCon),this.mResStr=s,this.mResPng=o,this.mResJson=h,this.mResSlot=l,this.mSubScriptRes=p,this.mSelectRes=c}return Object.defineProperty(ItemSlot.prototype,"hasTip",{get:function(){return this.isTipBoo},set:function(t){this.isTipBoo=t},enumerable:!1,configurable:!0}),ItemSlot.prototype.createUI=function(){this.onLoadCompleteHandler()},ItemSlot.prototype.getView=function(){return this.toolTipCon},ItemSlot.prototype.getBg=function(){return this.itemBG},ItemSlot.prototype.getIcon=function(){return this.mIcon},ItemSlot.prototype.dataChange=function(t){var e=this;if(this.minitialize)if(this.mData=t,this.mIcon){var i=void 0;if(this.mData&&this.mData.display){i=this.mData.display.texturePath;this.mData.des&&this.mData.des;this.setToolTipData(this.mData.name+this.mData.des)}else this.mIcon.icon.visible=!1;if(!i)return;this.mScene.textures.exists(a.Url.getOsdRes(i))?this.mData&&(this.mIcon.icon.setTexture(a.Url.getOsdRes(i)),this.mIcon.icon.visible=!0):this.mIcon.load(i,this,(function(){e.mData&&(e.mIcon.icon.visible=!0)}))}else this.mIcon.icon.visible=!1},ItemSlot.prototype.destroy=function(){this.mSubScriptSprite&&(this.mSubScriptSprite.destroy(!0),this.mSubScriptSprite=null),this.mSelectSprite&&(this.mSelectSprite.destroy(!0),this.mSelectSprite=null),this.mIcon&&this.mIcon.destroy(),this.toolTipCon&&(this.toolTipCon.destroy(),this.toolTipCon=null),this.toolTip&&(this.toolTip.destroy(),this.toolTip=null),this.mAnimationCon&&(this.mAnimationCon.destroy(!0),this.mAnimationCon=null),this.itemBG&&(this.itemBG.destroy(!0),this.itemBG=null),this.index=0,this.mData=null,this.mScene=null,this.mRender=null,this.mResStr=null,this.mResPng=null,this.mResSlot=null,this.mResJson=null,this.mSubScriptRes=null,this.mSelectRes=null,this.minitialize=!1,this.mWid=0,this.mHei=0,this.mData=null,this.isTipBoo=!0},ItemSlot.prototype.setToolTipData=function(t){this.toolTip&&this.toolTip.setToolTipData(t)},ItemSlot.prototype.onLoadCompleteHandler=function(){this.itemBG=this.mScene.make.sprite(void 0,!1),this.itemBG.setTexture(this.mResStr,this.mResSlot),this.toolTipCon.addAt(this.itemBG,0),this.toolTipCon.setSize(this.itemBG.width,this.itemBG.height),this.mIcon=new n.DragDropIcon(this.mScene,0,0),this.toolTipCon.addAt(this.mIcon,1),this.mSubScriptRes&&(this.mSubScriptSprite=this.mScene.make.sprite(void 0,!1),this.mSubScriptSprite.setTexture(this.mResStr,this.mSubScriptRes),this.mSubScriptSprite.x=this.mSubScriptSprite.width-this.itemBG.width>>1,this.mSubScriptSprite.y=this.mSubScriptSprite.height-this.itemBG.height>>1),this.isTipBoo&&(this.toolTip=new s.ToolTip(this.mScene,"itemSlotTip",a.Url.getRes("ui/toolTip/toolTip.json"),a.Url.getRes("ui/toolTip/toolTip.png"),this.mRender.uiScale)),this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0,0,this.itemBG.width,56),Phaser.Geom.Rectangle.Contains),this.toolTipCon.on("pointerover",this.overHandler,this),this.toolTipCon.on("pointerout",this.outHandler,this),this.toolTipCon.on("pointerdown",this.downHandler,this),this.toolTipCon.on("pointerup",this.outHandler,this),this.minitialize=!0,this.mData&&this.dataChange(this.mData),this.mWid+=this.itemBG.width,this.mHei+=this.itemBG.height},ItemSlot.prototype.downHandler=function(t){this.mData&&this.mRender.renderEmitter(o.EventType.REQUEST_TARGET_UI,this.mData.id)},ItemSlot.prototype.overHandler=function(t){this.toolTip&&this.mData&&(this.mRender.sceneManager.currentScene.layerManager.addToLayer(h.a.LAYER_TOOLTIPS,this.toolTip),this.toolTip.setToolTipData(this.mData.name+this.mData.des),this.toolTip.x=t.x,this.toolTip.y=t.y),this.mSelectRes&&this.mSelectRes.length>0&&(this.mSelectSprite=this.mScene.make.sprite(void 0,!1),this.mSelectSprite.play(this.mSelectRes),this.toolTipCon.add(this.mSelectSprite))},ItemSlot.prototype.outHandler=function(t){this.toolTip&&this.toolTip.parentContainer&&this.toolTip.parentContainer.remove(this.toolTip),this.mSelectSprite&&this.mSelectSprite.parentContainer&&(this.mSelectSprite.parentContainer.remove(this.mSelectSprite),this.mSelectSprite.destroy(!0),this.mSelectSprite=null)},ItemSlot}()},function(t,e,i){"use strict";var n,a;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),function(t){t[t.BACKEND=0]="BACKEND",t[t.STAGE=1]="STAGE",t[t.FRONTEND=2]="FRONTEND",t[t.FLAG=3]="FLAG",t[t.Effect=4]="Effect"}(n||(n={})),function(t){t[t.TQ_NickName=65536]="TQ_NickName",t[t.TQ_Badge=131072]="TQ_Badge"}(a||(a={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function SceneName(){}return SceneName.PLAY_SCENE="PlayScene",SceneName.CREATE_ROLE_SCENE="CreateRoleScene",SceneName.LOADING_SCENE="LoadingScene",SceneName.SKYBOX_SCENE="SkyboxScene",SceneName.LOGIN_SCENE="LoginScene",SceneName.MAINUI_SCENE="MainUIScene",SceneName.DECORATE_SCENE="DecorateScene",SceneName}()},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.Center=1]="Center",t[t.Fill=2]="Fill",t[t.Stretch=3]="Stretch",t[t.Repeat=4]="Repeat"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function EventType(){}return EventType.PACKAGE_SYNC_FINISH="PACKAGE_SYNC_FINISH",EventType.PACKAGE_UPDATE="PACKAGE_UPDATE",EventType.UPDATE_PLAYER_INFO="UPDATE_PLAYER_INFO",EventType.UPDATE_ROOM_INFO="UPDATE_ROOM_INFO",EventType.UPDATE_PARTY_STATE="UPDATE_PARTY_STATE",EventType.SEND_FURNITURE_REQUIREMENTS="SEND_FURNITURE_REQUIREMENTS",EventType.SCENE_ELEMENT_DATA_UPDATE="SCENE_ELEMENT_DATA_UPDATE",EventType.QUERY_MARKET="QUERY_MARKET",EventType.CHAT="CHAT",EventType.SCENE_POINT_ELEMENT="SCENE_ELEMENT",EventType.SCENE_SHOW_UI="SCENE_SHOW_UI",EventType.ELEMENT_ITEM_CONFIG="ELEMENT_ITEM_CONFIG",EventType.SEND_GIFT_DATA_UPDATE="SEND_GIFT_DATA_UPDATE",EventType.SCENE_ELEMENT_FIND="SCENE_ELEMENT_FIND",EventType.SCENE_RETURN_FIND_ELEMENT="SCENE_RETURN_FIND_ELEMENT",EventType.SCENE_PLAYER_FIND="SCENE_PLAYER_FIND",EventType.SCENE_RETURN_FIND_PLAYER="SCENE_RETURN_FIND_PLAYER",EventType.SCENE_INTERACTION_ELEMENT="SCENE_INTERACTION_ELEMENT",EventType.SCENE_PLAYER_ACTION="SCENE_PLAYER_ACTION",EventType.SCENE_SHOW_MAIN_UI="SCENE_SHOW_MAIN_UI",EventType.CHAT_PANEL_EXTPAND="CHAT_PANEL_EXTPAND",EventType.SCENE_CHANGE="SCENE_CHANGE",EventType.FETCH_FRIEND="fetchFriend",EventType.FOLLOW="follow",EventType.UNFOLLOW="unfollow",EventType.REMOVE_BAN_USER="removeBanUser",EventType.REQ_BLACKLIST="ReqBlacklist",EventType.REQ_FRIEND_ATTRIBUTES="reqFriendAttributes",EventType.REQ_FRIEND_GAME_DATA="reqFriendGameData",EventType.REMOVE_FROM_BLACKLIST="removeFromBlacklist",EventType.RENDERER_EVENT="rendererEvent",EventType.REQ_PLAYER_LIST="reqPlayerList",EventType.PLAYER_LIST="playerList",EventType.SEARCH_FRIEND="searchFriend",EventType.SEARCH_RESULT="searchResult",EventType.REQ_FRIEND_RELATION="reqFriendRelation",EventType.REQ_RELATION="reqRelation",EventType.REQ_NEW_FANS="reqNewFans",EventType.SHOW_MED="SHOW_MED",EventType.QUERY_PRAISE="QUERY_PRAISE",EventType.QUERY_MARKET_REQUEST="QUERY_MARKET_REQUEST",EventType.REQUEST_TARGET_UI="REQUEST_TARGET_UI",EventType.NAVIGATE_RESIZE="navigateResize",EventType}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function ModuleName(){}return ModuleName.DIALOG_NAME="Dialog",ModuleName.PICAHANDHELD_NAME="PicaHandheld",ModuleName.PICAMAINUI_NAME="PicaMainUI",ModuleName.PICACHAT_NAME="PicaChat",ModuleName.CHAT_NAME="Chat",ModuleName.BOTTOM="Bottom",ModuleName.LOGIN_NAME="Login",ModuleName.CUTIN_NAME="CutIn",ModuleName.ACTIVITY_NAME="Activity",ModuleName.CREATEROLE_NAME="CreateRole",ModuleName.VERIFIED_NAME="Verfied",ModuleName.PICANAVIGATE_NAME="PicaNavigate",ModuleName.CHARACTERINFO_NAME="CharacterInfo",ModuleName.PICAFRIEND_NAME="PicaFriend",ModuleName.ACCOUNT_NAME="Account",ModuleName.SCENEMANAGER_NAME="SceneManager",ModuleName.BUBBLE_NAME="Bubble",ModuleName.PICABAG_NAME="PicaBag",ModuleName.PICAAVATAR_NAME="PicaAvatar",ModuleName.PICAMARKET_NAME="PicaMarket",ModuleName.PICAORDER_NAME="PicaOrder",ModuleName.PICAPROPFUN_NAME="PicaPropFun",ModuleName.PICAPARTYLIST_NAME="PicaPartyList",ModuleName.PICANOTICE_NAME="PicaNotice",ModuleName.ALERTVIEW_NAME="AlertView",ModuleName.PICAOPENPARTY_NAME="PicaOpenParty",ModuleName.PICAMANORLIST_NAME="PicaManorList",ModuleName.PICATASK_NAME="PicaTask",ModuleName.PICAMANORINFO_NAME="PicManorInfo",ModuleName.PICABUSINESSSTREET_NAME="PicaBusinessStreet",ModuleName.PICABUSINESSMARKETINGPLAN_NAME="PicaBusinessMarketingPlan",ModuleName.PICARECHARGE_NAME="PicaRecharge",ModuleName.PICADECORATECONTROL_NAME="PicaDecorateControl",ModuleName.PICADECORATE_NAME="PicaDecorate",ModuleName.PICAROOMUPGRADE_NAME="PicRoomUpgrade",ModuleName.PICAEQUIPUPGRADE_NAME="PicaEquipUpgrade",ModuleName.PICAROOMLIST_NAME="PicaRoomList",ModuleName.PICAWORK_NAME="PicaWork",ModuleName.PICAMINECAR_NAME="PicaMineCar",ModuleName.PICAHOUSE_NAME="PicaHouse",ModuleName.PICAMINESETTLE_NAME="PicaMineSettle",ModuleName.PICAREWARDTIP_NAME="PicaRewardTip",ModuleName.STORAGE_NAME="Storage",ModuleName.BAG_NAME="Bag",ModuleName.PICACOMPOSE_NAME="PicaCompose",ModuleName.PICAITEMPOPCARD_NAME="PicaItemPopCard",ModuleName.PICAMESSAGEBOX_NAME="PicaMessageBox",ModuleName.PICAELEMENTSTORAGE_NAME="PicaElementStorage",ModuleName.RANK_NAME="rank",ModuleName.CUTINMENU_NAME="CutInMenu",ModuleName.USERMENU_NAME="UserMenu",ModuleName.GM_TOOLS_NAME="GMTools",ModuleName.PICATREASURE_NAME="PicaTreasure",ModuleName.PICAGIFTEFFECT_NAME="PicaGiftEffect",ModuleName.PICAFURNIFUN_NAME="PicaFurniFun",ModuleName.PICANEWROLE_NAME="PicaNewRole",ModuleName.PICANEWMAIN_NAME="PicaNewMain",ModuleName.PICAONLINE_NAME="PicaOnline",ModuleName.PICAEFFECTMGR_NAME="PicaEffectMgr",ModuleName.PICAELEVATOR_NAME="PicaElevator",ModuleName.PICACREATEROLE_NAME="PicaCreateRole",ModuleName.PICAITEMTIPSPANEL_NAME="PicaItemTipsPanel",ModuleName.PICAFURNITURECOMPOSE_NAME="PicaFurnitureCompose",ModuleName.PICARECASTE_NAME="PicaRecaste",ModuleName.PICAROAM_NAME="PicaRoam",ModuleName.PICAEXPLORELOG_NAME="PicaExploreLog",ModuleName.PICAEXPLORELIST_NAME="PicaExploreList",ModuleName}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function ChineseUnit(){}return ChineseUnit.numberToChinese=function(t,e){void 0===e&&(e=!1);var i="个十百千万@#%亿^&~",n="零一二三四五六七八九",a=(t+"").split(""),s=[],o=a.length-1;if(a.length>12)throw new Error("too big");for(var h=0;h<=o;h++){var l=Number(a[h]);(1===o||5===o||9===o)&&0===h?"1"!==a[h]&&s.push(n.charAt(l)):s.push(n.charAt(l)),e&&h!==o&&s.push(i.charAt(o-h))}return e?s.join("").replace(/零([十百千万亿@#%^&~])/g,(function(t,e,n){if(-1!==(n=i.indexOf(e))){if("亿"===e)return e;if("万"===e)return e;if("0"===a[o-n])return"零"}return""})).replace(/零+/g,"零").replace(/零([万亿])/g,(function(t,e){return e})).replace(/亿[万千百]/g,"亿").replace(/[零]$/,"").replace(/[@#%^&~]/g,(function(t){return{"@":"十","#":"百","%":"千","^":"十","&":"百","~":"千"}[t]})).replace(/([亿万])([一-九])/g,(function(t,e,n,s){return-1!==(s=i.indexOf(e))&&"0"===a[o-s]?e+"零"+n:t})):s.join("")},ChineseUnit.getChineseUnit=function(t,e){e=null==e?2:e;var i=Math.floor(t),n=this.getDigit(i),a=[];if(n>3){var s=Math.floor(n/8);if(s>=1){var o=Math.round(i/Math.pow(10,8*s));a.push(this.addWan(o,t,8*s,e));for(var h=0;h<s;h++)a.push("亿");return a.join("")}return this.addWan(i,t,0,e)}return t},ChineseUnit.addWan=function(t,e,i,n){var a=this.getDigit(t);if(a>3){var s=a%8;return s>=5&&(s=4),Math.round(e/Math.pow(10,s+i-n))/Math.pow(10,n)+"万"}return Math.round(e/Math.pow(10,i-n))/Math.pow(10,n)},ChineseUnit.getDigit=function(t){for(var e=-1;t>=1;)e++,t/=10;return e},ChineseUnit}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(2),a=function(){function TimerCountDown(t){this.callback=t}return TimerCountDown.prototype.execute=function(t){var e=this;this.clear(),this.interval=t;var timeout=function(){var t=e.getDataFormat(1e3*e.interval);e.callback&&e.callback.runWith([e.interval,t]),e.interval>0?e.timerid=setTimeout((function(){e.interval-=1,timeout()}),1e3):e.timerid=void 0};timeout()},TimerCountDown.prototype.clear=function(){this.timerid&&clearTimeout(this.timerid),this.timerid=void 0},TimerCountDown.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,a=Math.floor(t/6e4)%60,s=Math.floor(t/1e3)%60,o="";return e>0?o=e+" "+n.i18n.t("timeuint.day")+" "+this.stringFormat(i)+":"+this.stringFormat(a)+":"+this.stringFormat(s):(i>0||a>0||s>0)&&(o=this.stringFormat(i)+":"+this.stringFormat(a)+":"+this.stringFormat(s)),o},TimerCountDown.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},TimerCountDown}()},,,function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.NONE="none",t.UNFROZEN="unfrozen",t.REPAIR="repair"}(n||(n={}))},function(t,e,i){"use strict";var n,a;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),function(t){t[t.ENTERWORLD=0]="ENTERWORLD",t[t.DOWNLOADGAMECONFIG=1]="DOWNLOADGAMECONFIG",t[t.DOWNLOADSCENECONFIG=2]="DOWNLOADSCENECONFIG",t[t.PARSECONFIG=3]="PARSECONFIG",t[t.WAITENTERROOM=4]="WAITENTERROOM",t[t.LOADINGRESOURCES=5]="LOADINGRESOURCES",t[t.LOGINGAME=6]="LOGINGAME",t[t.CREATESCENE=7]="CREATESCENE"}(n||(n={})),function(t){t[t.CREATING_SCENE=0]="CREATING_SCENE",t[t.CREATING_ROOM=1]="CREATING_ROOM",t[t.LOAD_COMPOLETE=2]="LOAD_COMPOLETE"}(a||(a={}))},function(t,e){},function(t,e){},function(t,e){},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(39),a=function(){function Animator(t){t&&this.setSuits(t)}return Animator.prototype.setSuits=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];"weapon"===n.suit_type&&n.tag&&(this.AniAction=JSON.parse(n.tag).action)}},Animator.prototype.getAnimationName=function(t){if(this.AniAction){if(t===n.b.IDLE)return this.AniAction[0];if(t===n.b.WALK)return this.AniAction[1]}return t},Animator}()},function(t,e){},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function RoomType(){}return RoomType.EPISODE="episode",RoomType}()},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.north=0]="north",t[t.north_west=1]="north_west",t[t.west=2]="west",t[t.west_south=3]="west_south",t[t.south=4]="south",t[t.south_east=5]="south_east",t[t.east=6]="east",t[t.east_north=7]="east_north"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function LogicPoint(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e}return LogicPoint.prototype.setTo=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},LogicPoint}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(51),a=function(){function Tool(){}return Tool.getPosByScenes=function(t,e){var i=t.cameras.main,a=e.x-i.scrollX,s=e.y-i.scrollY;return new n.a(a,s)},Tool.twoPointDistance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},Tool.twoPointRadin=function(t,e){var i=t.x-e.x,n=t.y-e.y,a=Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),s=Math.acos(i/a);return e.y<t.y&&(s=-s),s},Tool.formatChineseString=function(t,e,i){"string"==typeof e&&(e=parseInt(e,10));var n=Math.floor(i/e);return this.chunk(t,n).join(" ")},Tool.checkChinese=function(t){for(var e=/[\u4e00-\u9fa5]+/,i=t.split(""),n=0,a=i.length;n<a;n++)if(e.test(i[n]))return!0;return!1},Tool.checkItemName=function(t,e){var i=e.split("")||[],n=!1;return i.forEach((function(e){if(e)for(var i=new RegExp(e),a=t.split(""),s=0,o=a.length;s<o;s++)if(i.test(a[s])){n=!0;break}})),n},Tool.calcAngle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)*(180/Math.PI)},Tool.calculateDirectionByRadin=function(t){var e=t*(180/Math.PI);return e>90?3:e>=0?5:e>=-90?7:1},Tool.angleToDirections=function(t,e,i){switch(void 0===i&&(i={}),i.left=!1,i.right=!1,i.up=!1,i.down=!1,t=(t+360)%360,e){case 0:t<180?i.down=!0:i.up=!0;break;case 1:t>90&&t<=270?i.left=!0:i.right=!0;break;case 2:t>45&&t<=135?i.down=!0:t>135&&t<=225?i.left=!0:t>225&&t<=315?i.up=!0:i.right=!0;break;case 3:t>22.5&&t<=67.5?(i.down=!0,i.right=!0):t>67.5&&t<=112.5?i.down=!0:t>112.5&&t<=157.5?(i.down=!0,i.left=!0):t>157.5&&t<=202.5?i.left=!0:t>202.5&&t<=247.5?(i.left=!0,i.up=!0):t>247.5&&t<=292.5?i.up=!0:t>292.5&&t<=337.5?(i.up=!0,i.right=!0):i.right=!0}return i},Tool.checkPointerContains=function(t,e){if(!t)return!1;var i=-t.width/2,n=t.width/2,a=-t.height/2,s=t.height/2;if(e){var o=t.getWorldTransformMatrix(),h=o.scaleX,l=(e.x-o.tx)/h,c=(e.y-o.ty)/h;return i<=l&&n>=l&&a<=c&&s>=c}return!1},Tool.baseName=function(t){var e=new String(t).substring(t.lastIndexOf("/")+1);return-1!==e.lastIndexOf(".")&&(e=e.substring(0,e.lastIndexOf("."))),e},Tool.getRectangle=function(t,e){for(var i=new Phaser.Geom.Rectangle(0,0,0,0),n=t.parentContainer,a=t.scale;n&&n!==e;)a*=n.scale,n=n.parentContainer;var s=t.width*a,o=t.height*a,h=t.getWorldTransformMatrix();return i.left=h.tx-s*t.originX,i.right=h.tx+s*(1-t.originX),i.top=h.ty-o*t.originY,i.bottom=h.ty+o*(1-t.originY),i},Tool.chunk=function(t,e){for(var i=[],n=0;n<t.length;n+=e)i.push(t.substr(n,e));return i},Tool}()},function(t,e,i){"use strict";!function(){function Algorithm(){}Algorithm.median=function(t){var e=t.sort((function(t,e){return e-t})),i=Math.floor(e.length/2);return e.length%2==0?(e[i-1]+e[i])/2:e[i]}}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(52),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function LogicRectangle45(e,i,n,a){var s=t.call(this,e,i,n,a)||this;return s.row=0,s.col=0,s.endRow=0,s.endCol=0,s.row=e,s.col=i,s.endRow=n,s.endCol=a,s}return s(LogicRectangle45,t),LogicRectangle45}(a.a)},function(t,e,i){"use strict";Math.cos(45*Math.PI/180),Math.sin(45*Math.PI/180)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Intersects(){}return Intersects.RectangleToRectangle=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)},Intersects}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function n(t,e){this.width=t,this.height=e}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(76),__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,h=s.length;o<h;o++,a++)n[a]=s[o];return n},a=function(){function Helpers(){}return Helpers.genId=function(){return(new n).natural({min:1e4,max:Helpers.MAX_ID})},Helpers.flipArray=function(t){if(t){var e=__spreadArrays(t),i=[];if(e.length>0)for(var n=e[0].length,a=0;a<n;a++){i[a]=[];for(var s=0,o=e;s<o.length;s++){var h=o[s];i[a].push(h[a])}}return i}},Helpers.openUrl=function(t){var e=window.open("","_blank");e&&(e.location.href=t)},Helpers.MAX_ID=Math.pow(2,31),Helpers}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(50),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(){function EventDispatcher(){}return EventDispatcher.prototype.hasListener=function(t){return!!(this._events&&this._events[t])},EventDispatcher.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this._events||!this._events[t])return!1;var n=this._events[t];if(n.run)n.once&&delete this._events[t],null!=e?n.runWith(e):n.run();else{for(var a=0,s=n.length;a<s;a++){var o=n[a];o&&(null!=e?o.runWith(e):o.run()),o&&!o.once||(n.splice(a,1),a--,s--)}0===n.length&&this._events&&delete this._events[t]}return!0},EventDispatcher.prototype.on=function(t,e,i,n){return void 0===n&&(n=null),this._createListener(t,i,e,n,!1)},EventDispatcher.prototype.once=function(t,e,i,n){return void 0===n&&(n=null),this._createListener(t,i,e,n,!0)},EventDispatcher.prototype.off=function(t,e,i,n){if(void 0===n&&(n=!1),!this._events||!this._events[t])return this;var a=this._events[t];if(null!=e)if(a.run)i&&a.caller!==i||a.method!==e||n&&!a.once||(delete this._events[t],a.recover());else{for(var s=0,o=a.length,h=0,l=a.length;h<l;h++){var c=a[h];c?!c||i&&c.caller!==i||null!=e&&c.method!==e||n&&!c.once||(s++,a[h]=null,c.recover()):s++}s===o&&delete this._events[t]}return this},EventDispatcher.prototype.offAll=function(t){void 0===t&&(t=null);var e=this._events;if(!e)return this;if(t)this._recoverHandlers(e[t]),delete e[t];else{for(var i in e)this._recoverHandlers(e[i]);this._events=null}return this},EventDispatcher.prototype.offAllCaller=function(t){if(t&&this._events)for(var e in this._events)this.off(e,t,null);return this},EventDispatcher.prototype.destroy=function(){this.offAll()},EventDispatcher.prototype._createListener=function(t,e,i,n,a,s){void 0===s&&(s=!0),s&&this.off(t,e,i,a);var o=h.create(e||this,i,n,a);this._events||(this._events={});var l=this._events;return l[t]?l[t].run?l[t]=[l[t],o]:l[t].push(o):l[t]=o,this},EventDispatcher.prototype._recoverHandlers=function(t){if(t)if(t.run)t.recover();else for(var e=t.length-1;e>-1;e--)t[e]&&(t[e].recover(),t[e]=null)},EventDispatcher}(),h=function(t){function EventHandler(e,i,n,a){return t.call(this,e,i,n,a)||this}return s(EventHandler,t),EventHandler.create=function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=!0),EventHandler._mpool.length?EventHandler._mpool.pop().setTo(t,e,i,n):new EventHandler(t,e,i,n)},EventHandler.prototype.recover=function(){this._id>0&&(this._id=0,EventHandler._mpool.push(this.clear()))},EventHandler._mpool=[],EventHandler}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Color(){}return Color.brownish="#996600",Color.white="#ffffff",Color.yellow="#FFD248",Color.black="#000000",Color.red="#E33922",Color.title="#905B06",Color}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function CopyProtoType(){}return CopyProtoType.copyProtoParam=function(t){return t.forEach((function(t){for(var e in t)"function"!=typeof t.constructor.prototype[e]&&(t.hasOwnProperty(e)||(t[e]=t.constructor.prototype[e]))})),t},CopyProtoType}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function ValueResolver(){var t=this;this.resolver=null,this.rejecter=null,this.set=function(e,i){if(void 0===i&&(i=null),t.resolver){var n=new Error("Resolver already exists");if(i)return i(n);throw n}t.resolver=e,t.rejecter=i},this.promise=function(e){return new Promise((function(i,n){if(t.set(i,n),e)try{e()}catch(e){t.reject(e)}}))},this.resolve=function(e){if(!t.resolver){return t.rejecter?t.rejecter("No Resolver"):void 0}t.resolver(e),t.resolver=null,t.rejecter=null},this.reject=function(e){if(!t.rejecter)throw e;t.rejecter(e),t.resolver=null,t.rejecter=null}}return ValueResolver.create=function(){return new ValueResolver},ValueResolver}()},function(t,e){},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n=i(55),a=i(26),s=i(27),o=i(33),h=function(){function AStar(t){this.sizeChart=t}return AStar.prototype.init=function(t){this.finder?this.reset(t):(this.grid=new n.Grid(t),this.finder=new n.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}))},AStar.prototype.reset=function(t){this.grid=new n.Grid(t)},AStar.prototype.setWalkableAt=function(t,e,i){this.grid&&this.grid.setWalkableAt(t,e,i)},AStar.prototype.isWalkableAt=function(t,e){return!!this.grid&&this.grid.isWalkableAt(t,e)},AStar.prototype.find=function(t,e,i){var n=this;if(this.finder){if(this.grid){var h=[],l=this.sizeChart.miniSize,c=l.rows,p=l.cols,d=o.a.transformTo45(t,l);if(this._invalidPoint(d,p,c))return h;var u=[];if(e.forEach((function(t){t=o.a.transformTo45(t,l),n._invalidPoint(t,p,c)||u.push(t)})),0===u.length)return h;this.gridBackup=this.grid.clone();for(var m=0,f=this.finder.findPathToMultipleEnds(d.x,d.y,u,this.gridBackup,i);m<f.length;m++){var y=f[m],g=o.a.transformTo90(new s.a(y[0],y[1]),l);g.y+=l.tileHeight/2,h.push(g)}return!1===i&&h.shift(),h}a.a.getInstance().error("can't find path. grid not exist")}else a.a.getInstance().error("finder not exist")},AStar.prototype._invalidPoint=function(t,e,i){return t.x<0||t.x>=e||t.y<0||t.y>=i||!this.isWalkableAt(t.x,t.y)},AStar}()},,function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(2),a=function(){function TimeUtils(){}return TimeUtils.getDataFormat=function(t,e,i){var a=e?Math.floor(t/864e5):0,s=e?Math.floor(t/36e5)%24:Math.floor(t/36e5),o=Math.floor(t/6e4)%60,h=Math.floor(t/1e3)%60,l="",c="";return c=a>0?a+"-"+this.stringFormat(s)+":"+this.stringFormat(o)+":"+this.stringFormat(h):s>0||o>0||h>0?this.stringFormat(s)+":"+this.stringFormat(o)+":"+this.stringFormat(h):""+n.i18n.t("furni_bag.expires"),l+=i?"[color=#FF0000]"+c+"[/color]":c},TimeUtils.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},TimeUtils}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function StringUtils(){}return StringUtils.format=function(t,e){if(0===arguments.length)return this;if("object"==typeof e){for(var i in e)t=t.replace(new RegExp("\\{"+i+"\\}","g"),e[i]);return t}for(var n=0;n<e.length;n++)t=t.replace(new RegExp("\\{"+n+"\\}","g"),e[n]);return t},StringUtils}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(26),a=function(){function ObjectAssign(){}return ObjectAssign.excludeTagAssign=function(t,e,i){if(void 0===i&&(i="exclude"),t&&e){var a=t[i]||e[i];for(var s in e)if(s!==i&&e.hasOwnProperty(s)){var o=e[s];"object"==typeof o?(t.hasOwnProperty(s)||(Array.isArray(o)?t[s]=[]:t[s]={}),this.excludeTagAssign(t[s],o,i)):a?-1===a.indexOf(s)&&(t[s]=e[s]):t[s]=e[s]}}else n.a.getInstance().error("source",t,"target",e)},ObjectAssign.excludeAssign=function(t,e,i){for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];"object"==typeof a?(t.hasOwnProperty(n)||(Array.isArray(a)?t[n]=[]:t[n]={}),this.excludeAssign(t[n],a)):i?-1===i.indexOf(n)&&(t[n]=e[n]):t[n]=e[n]}},ObjectAssign.excludeAllAssign=function(t,e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];"object"==typeof n?(t.hasOwnProperty(i)||(Array.isArray(n)?t[i]=[]:t[i]={}),this.excludeAllAssign(t[i],n)):t.hasOwnProperty(i)||(t[i]=n)}},ObjectAssign}()},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e);var n=i(326);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);var s=i(327);for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);var o=i(328);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var h=i(329);i.d(e,"BagPanel",(function(){return h.BagPanel}));var l=i(330);i.d(e,"StoragePanel",(function(){return l.StoragePanel}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n,a=i(294),s=i(2),o=i(0),h=i(15),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function MainUIScene(){var e=t.call(this,{key:o.SceneName.MAINUI_SCENE})||this;return e.timeOutID=0,e.timeOutCancelMap={},e.timeOutCallerList=[],e.timeOutTimeMap={},e}return l(MainUIScene,t),MainUIScene.prototype.preload=function(){},MainUIScene.prototype.init=function(e){t.prototype.init.call(this,e),this.render&&this.render.uiManager.setScene(null)},MainUIScene.prototype.create=function(){var e=this.cameras.main.width;this.fps=this.add.text(.5*e,10,"",{style:{color:"#64DD17"}}),this.fps.setStroke("0x0",1),this.fps.setFontFamily(s.Font.DEFULT_FONT),this.fps.setFontSize(20*window.devicePixelRatio),this.fps.setDepth(1e3),this.sizeTF=this.add.text(10,50,"",{style:{color:"#64DD17"},wordWrap:{width:800,useAdvancedWrap:!0}}),this.sizeTF.setFontSize(20*window.devicePixelRatio),this.sizeTF.setFontFamily(s.Font.DEFULT_FONT),this.sizeTF.setStroke("#0",3),this.render.uiManager.setScene(this),this.render.initUI(),this.layerManager.addLayer(this,h.d,MainUIScene.LAYER_UI,1),this.layerManager.addLayer(this,h.d,MainUIScene.LAYER_DIALOG,2),this.layerManager.addLayer(this,h.d,MainUIScene.LAYER_TOOLTIPS,3),t.prototype.create.call(this)},MainUIScene.prototype.setTimeout=function(t,e){var i=Date.now();return this.timeOutCallerList[++this.timeOutID]=t,this.timeOutTimeMap[this.timeOutID]={now:i,delay:e},this.timeOutID},MainUIScene.prototype.clearTimeout=function(t){this.timeOutCancelMap[t]=!0},MainUIScene.prototype.updateFPS=function(){this.fps&&this.fps.setText(this.game.loop.actualFps.toFixed())},MainUIScene.prototype.getKey=function(){return this.sys.config.key},MainUIScene.prototype.checkSize=function(t){t.width,t.height,this.render},MainUIScene.LAYER_UI="uiLayer",MainUIScene.LAYER_DIALOG="dialogLayer",MainUIScene.LAYER_TOOLTIPS="toolTipsLyaer",MainUIScene}(a.a)},function(t,e,i){"use strict";i.r(e),i.d(e,"ItemInfoTips",(function(){return h}));var n,a=i(6),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function ItemInfoTips(e,i,n,a,s,o,h){var l=t.call(this,e)||this;return l.fullHide=!0,l.setSize(i,n),l.key=a,l.dpr=o,l.config=h||{left:15*l.dpr,top:15*l.dpr,right:15*l.dpr,bottom:15*l.dpr},l.create(s),l}return o(ItemInfoTips,t),ItemInfoTips.prototype.setInvalidArea=function(t){this.fullHide=!0,this.invalidArea=t},ItemInfoTips.prototype.setHandler=function(t){this.callback=t},Object.defineProperty(ItemInfoTips.prototype,"enableFullHide",{set:function(t){this.fullHide=t,this.invalidArea=void 0},enumerable:!1,configurable:!0}),ItemInfoTips.prototype.setVisible=function(e){return e?this.show():this.hide(),t.prototype.setVisible.call(this,e),this},ItemInfoTips.prototype.hide=function(){this.fullHide&&this.visible&&this.scene.input.off("pointerdown",this.onHideHandler,this),this.visible=!1,this.callback&&this.callback.run()},ItemInfoTips.prototype.show=function(){this.fullHide&&!this.visible&&this.scene.input.on("pointerdown",this.onHideHandler,this),this.visible=!0},ItemInfoTips.prototype.resize=function(t,e){this.tipsText.setWrapWidth(t);var i=this.tipsText.height+20*this.dpr;i<e&&(i=e),this.setSize(t,i),this.tipsbg.resize(t,i),this.tipsbg.y=.5*-i,this.tipsText.y=-i+10*this.dpr},ItemInfoTips.prototype.setText=function(t,e){void 0===e&&(e=.9),this.tipsText.text=t;var i=this.tipsText.height+20*this.dpr,n=this.tipsbg.width;this.setSize(n,i),this.tipsbg.resize(n,i),this.tipsbg.y=.5*-i,this.tipsText.y=-i+10*this.dpr},ItemInfoTips.prototype.setItemData=function(t){var e=this.getDesText(t);this.setText(e)},ItemInfoTips.prototype.setTipsPosition=function(t,e,i){void 0===i&&(i=0);for(var n=t.x,a=t.y,s=t;s.parentContainer!==e;)n+=s.parentContainer.x,a+=s.parentContainer.y,s=s.parentContainer;n-.5*this.width<.5*-e.width?this.x=.5*this.width-.5*e.width+20*this.dpr:n+.5*this.width>.5*e.width?this.x=.5*e.width-.5*this.width-20*this.dpr:this.x=n,this.y=a-.5*this.height+10*this.dpr+i},ItemInfoTips.prototype.create=function(t){var e=this.width,i=this.height,n=new a.NineSlicePatch(this.scene,0,0,e,i,this.key,t,this.config);n.setPosition(0,.5*-i),this.tipsbg=n;var o=new a.BBCodeText(this.scene,.5*-this.width+10*this.dpr,-i+60*this.dpr,"",{color:"#333333",fontSize:13*this.dpr,fontFamily:s.Font.DEFULT_FONT,wrap:{width:this.width-15*this.dpr,mode:"string"}}).setOrigin(0);o.setLineSpacing(2*this.dpr),this.tipsText=o,this.add([n,o])},ItemInfoTips.prototype.getDesText=function(t){var e,i;t||(t={sellingPrice:!0,tradable:!1});var n="[stroke=#2640CA][color=#2640CA][b]"+t.name+"[/b][/color][/stroke]\n";return n+=(null!==(e=t.source)&&void 0!==e?e:"")+"\n",n+=null!==(i=t.des)&&void 0!==i?i:""},ItemInfoTips.prototype.onHideHandler=function(t){this.checkPointerInBounds(t)||this.hide()},ItemInfoTips.prototype.checkPointerInBounds=function(t){return!!(t&&this.invalidArea&&t.x>this.invalidArea.left&&t.x<this.invalidArea.right&&t.y>this.invalidArea.top&&t.y<this.invalidArea.bottom)},ItemInfoTips}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ToolTip",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function ToolTip(e,i,n,a,s){var o=t.call(this,e)||this;return o.mScene=e,o.resStr=i,o.resJson=n,o.resUrl=a,o.uiScale=s,o.mWidth=0,o.mHeight=0,o.mBaseMidHeight=0,o.preLoad(),o}return s(ToolTip,t),ToolTip.prototype.setToolTipData=function(t){if(this.mText){var e=a.Tool.formatChineseString(t,this.mText.style.fontSize,this.mWidth-20);this.mText.setText(e),this.refreshTip()}},ToolTip.prototype.destroy=function(){this.topImage&&this.topImage.destroy(!0),this.midImage&&this.midImage.destroy(!0),this.botImage&&this.botImage.destroy(!0),this.mText&&this.mText.destroy(!0),this.mWidth=0,this.mHeight=0,this.removeAllListeners(),this.removeAll(),t.prototype.destroy.call(this,!0)},ToolTip.prototype.preLoad=function(){this.scene.load.atlas(this.resStr,this.resUrl,this.resJson),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},ToolTip.prototype.init=function(){this.topImage=this.scene.make.image(void 0,!1),this.topImage.setOrigin(0,0),this.topImage.setTexture(this.resStr,ToolTip.TOP),this.midImage=this.scene.make.image(void 0,!1),this.midImage.setOrigin(0,0),this.midImage.setTexture(this.resStr,ToolTip.MID),this.botImage=this.scene.make.image(void 0,!1),this.botImage.setOrigin(0,0),this.botImage.setTexture(this.resStr,ToolTip.BOT),this.mText=this.scene.make.text(void 0,!1),this.mText.setFontFamily("YaHei"),this.mText.setFontStyle("bold"),this.mText.setFontSize(14),this.mText.style.align="center",this.mText.lineSpacing=15,this.mWidth=this.topImage.width,this.mBaseMidHeight=this.midImage.height,this.mText.style.fixedWidth=this.mWidth-20,this.mText.style.setWordWrapWidth(this.mWidth-20,!0),this.add(this.topImage),this.add(this.midImage),this.add(this.botImage),this.add(this.mText)},ToolTip.prototype.refreshTip=function(){this.midImage.scaleY=(this.mText.height+20)/this.mBaseMidHeight,this.mHeight=this.topImage.height+this.midImage.height*this.midImage.scaleY+this.botImage.height,this.topImage.y=-this.topImage.height>>1,this.midImage.y=this.topImage.y+this.topImage.height,this.botImage.y=this.midImage.y+this.midImage.height*this.midImage.scaleY,this.mText.x=this.mWidth-this.mText.style.fixedWidth>>1,this.mText.y=this.mHeight-this.mText.height-10>>1,this.setSize(this.mWidth,this.mHeight)},ToolTip.prototype.onLoadComplete=function(){this.init()},ToolTip.TOP="tip_top.png",ToolTip.MID="tip_mid.png",ToolTip.BOT="tip_bot.png",ToolTip}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"SoundButton",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function SoundButton(e,i,n,a,s){var o=t.call(this,e,i,n)||this;return o.mDownTime=0,o.mPressDelay=1e3,o.mIsMove=!1,o.mTweening=!1,o.tweenScale=.9,o.mTweenBoo=!0,o.soundGroup={up:{key:"click"}},void 0===a&&(a=!0),o.mTweenBoo=a,Object.assign(o.soundGroup,s),o}return s(SoundButton,t),SoundButton.prototype.addListen=function(){this.removeListen(),this.on("pointerdown",this.onPointerDownHandler,this),this.on("pointerup",this.onPointerUpHandler,this),this.on("pointerout",this.onPointerOutHandler,this),this.on("pointermove",this.onPointerMoveHandler,this)},SoundButton.prototype.removeListen=function(){this.off("pointerdown",this.onPointerDownHandler,this),this.off("pointerup",this.onPointerUpHandler,this),this.off("pointerout",this.onPointerOutHandler,this),this.off("pointermove",this.onPointerMoveHandler,this)},Object.defineProperty(SoundButton.prototype,"enable",{set:function(t){t?(this.addListen(),this.setInteractive()):(this.removeListen(),this.removeInteractive())},enumerable:!1,configurable:!0}),SoundButton.prototype.onPointerMoveHandler=function(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move),this.interactiveBoo&&(this.mIsMove=!0,this.emit(a.ClickEvent.Move))},SoundButton.prototype.onPointerUpHandler=function(t){this.interactiveBoo?this.mTweenBoo?this.tween(!1,this.pointerUp.bind(this,t)):this.pointerUp(t):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)},SoundButton.prototype.pointerUp=function(t){var e=this.checkPointerInBounds(this,t.worldX,t.worldY);this.emit(a.ClickEvent.Up,this),e&&this.mIsDown&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.emit(a.ClickEvent.Tap,t,this)),clearTimeout(this.mPressTime),this.mIsMove=!1,this.mIsDown=!1,this.mDownTime=0},SoundButton.prototype.onPointerOutHandler=function(t){this.mTweenBoo&&t.isDown&&this.tween(!1)},SoundButton.prototype.onPointerDownHandler=function(t){var e=this;this.mTweening||(this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){e.emit(a.ClickEvent.Hold,e)}),this.mPressDelay),this.mTweenBoo&&this.tween(!0),this.emit(a.ClickEvent.Down,this),this.mIsDown=!0):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled))},SoundButton.prototype.checkPointerInBounds=function(t,e,i){this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var n=t.getWorldTransformMatrix(),a=n.scaleX;this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2;var s=(e-n.tx)/a,o=(i-n.ty)/a;return this.mRectangle.left<=s&&this.mRectangle.right>=s&&this.mRectangle.top<=o&&this.mRectangle.bottom>=o},SoundButton.prototype.tween=function(t,e){var i=this;this.mTweening=!0;var n=t?this.tweenScale:1;this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTween=this.scene.tweens.add({targets:this.list,duration:45,ease:"Linear",props:{scaleX:{value:n},scaleY:{value:n}},onComplete:function(){i.tweenComplete(t),e&&e()},onCompleteParams:[this]})},SoundButton.prototype.tweenComplete=function(t){this.mTweening=!1,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0)},SoundButton}(a.BaseUI)},function(t,e,i){"use strict";i.r(e),i.d(e,"PropItem",(function(){return c}));var n,a=i(59),s=i(6),o=i(150),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PropItem(e,i,n,o,l){var c=t.call(this,e,0,0)||this;return c.dpr=o,c.key=i,c.bgframe=n,c.bg=c.scene.make.image({key:i,frame:n}),c.itemIcon=new a.DynamicImage(e,0,0),c.itemIcon.setTexture(i,n),l=l||{color:"#000000",fontSize:12*o,fontFamily:h.Font.DEFULT_FONT},c.itemCount=new s.BBCodeText(c.scene,0,15*o,"",l).setOrigin(.5),c.add([c.bg,c.itemIcon,c.itemCount]),c.setSize(c.bg.width,c.bg.height),c.itemCount.y=.5*c.height+8*o,c}return l(PropItem,t),PropItem.prototype.setHandler=function(t){this.send=t},PropItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.text=t.count+"";var i=h.Url.getOsdRes(t.texturePath),n=this.getWorldTransformMatrix().scaleX;this.itemIcon.scale=this.dpr/n,this.itemIcon.load(i,this,(function(){e.itemIcon.setPosition(0,0)}))},PropItem.prototype.setTextPosition=function(t,e){this.itemCount.x=t,this.itemCount.y=e},PropItem}(o.SoundButton)},function(t,e,i){"use strict";i.r(e),i.d(e,"DragDropIcon",(function(){return h}));var n,a=i(59),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function DragDropIcon(e,i,n,s){var o=t.call(this,e,i,n)||this;return o.mScene=e,o.mIcon=new a.DynamicImage(o.mScene,0,0),o.add(o.mIcon),o}return o(DragDropIcon,t),DragDropIcon.prototype.load=function(t,e,i){var n=this;this.mUrl=t;this.resKey;this.mIcon.load(s.Url.getOsdRes(this.mUrl),(function(){n.mCallBack&&n.mCallBack()})),this.mCallBack=i},DragDropIcon.prototype.dragStart=function(){},DragDropIcon.prototype.dragStop=function(t){},DragDropIcon.prototype.dragDrop=function(t){},DragDropIcon.prototype.dragOver=function(t){},DragDropIcon.prototype.getDragData=function(){},DragDropIcon.prototype.getDropData=function(){},DragDropIcon.prototype.getDragImage=function(){return this.mIcon},DragDropIcon.prototype.getVisualDisplay=function(){},DragDropIcon.prototype.getBound=function(){var t=this.getBounds();return new Phaser.Geom.Rectangle(t.x,t.y,t.width,t.height)},Object.defineProperty(DragDropIcon.prototype,"resKey",{get:function(){return void 0===this.mUrl?"":s.Url.getOsdRes(this.mUrl)},enumerable:!1,configurable:!0}),DragDropIcon.prototype.destroy=function(){this.mCallBack=null,t.prototype.destroy.call(this,!0)},Object.defineProperty(DragDropIcon.prototype,"icon",{get:function(){return this.mIcon},enumerable:!1,configurable:!0}),DragDropIcon.prototype.setDragType=function(t){this.mDragType=t},DragDropIcon.prototype.setDropType=function(t){this.mDropType=t},DragDropIcon.prototype.getDropType=function(){return this.mDropType},DragDropIcon.prototype.getDragType=function(){return this.mDragType},DragDropIcon}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"IconBtn",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function IconBtn(e,i,n){var s=t.call(this,e)||this;return s.mScene=e,s.mRender=i,s.mBtnBg=e.make.image(void 0,!1),s.mBgResKey=n.bgResKey,s.mBgTexture=n.bgTextures,s.mData=n,!s.mScene.textures.exists(s.mBgResKey)&&n.pngUrl&&n.jsonUrl?(s.mScene.load.atlas(n.key,a.Url.getRes(n.pngUrl),a.Url.getRes(n.jsonUrl)),s.mScene.load.once(Phaser.Loader.Events.COMPLETE,s.loadComplete,s),s.mScene.load.start(),s):(s.loadComplete(),s)}return s(IconBtn,t),IconBtn.prototype.getKey=function(){return this.mData.key},IconBtn.prototype.setPos=function(t,e){this.mBasePos||(this.mBasePos=new a.Pos),this.mBasePos.x=t,this.mBasePos.y=e},IconBtn.prototype.getPos=function(){return this.mBasePos},IconBtn.prototype.setBtnData=function(t){this.mBtnData=t},IconBtn.prototype.getBtnData=function(){return this.mBtnData},IconBtn.prototype.setClick=function(t){this.monClick=t},IconBtn.prototype.destroy=function(){this.mBtnBg&&this.mBtnBg.destroy(!0),this.mBtnIcon&&this.mBtnIcon.destroy(!0),this.monClick=null,this.mBtnBg=null,this.mBtnIcon=null,this.mBtnData=null,this.mScene=null,t.prototype.destroy.call(this)},IconBtn.prototype.loadComplete=function(){this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[0]),this.mBtnBg.scaleX=this.mBtnBg.scaleY=this.mData.scale,this.addAt(this.mBtnBg,0),this.mData.iconResKey&&this.mData.iconTexture&&this.mData.iconTexture.length>0&&(this.mBtnIcon=this.mScene.make.image(void 0,!1),this.mBtnIcon.setTexture(this.mData.iconResKey,this.mData.iconTexture),this.add(this.mBtnIcon)),this.setSize(this.mBtnBg.width,this.mBtnBg.height),this.setInteractive(),this.on("pointerup",this.upHandler,this),this.on("pointerdown",this.downHandler,this),this.on("pointerover",this.overHandler,this),this.on("pointerout",this.outHandler,this)},IconBtn.prototype.overHandler=function(t){this.mBgTexture.length<2||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[1])},IconBtn.prototype.outHandler=function(t){this.mBgTexture.length<2||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[0])},IconBtn.prototype.upHandler=function(){this.monClick&&this.monClick(),this.mData&&this.mData.callBack&&this.mData.callBack.apply(this),this.emit("click",this),this.mBgTexture.length<3||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[2])},IconBtn.prototype.downHandler=function(){this.mBgTexture.length<4||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[3])},IconBtn.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},IconBtn}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ProgressMaskBar",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function ProgressMaskBar(e,i,n,a,s,o,h){var l=t.call(this,e)||this;return l.value=0,l.max=1,l.zoom=1,l.createBackgroundBar(i,n,a,s,o,h),l.maskGraphics=l.scene.make.graphics(void 0,!1),l.maskGraphics.fillStyle(0,1),l.maskGraphics.fillRect(0,0,l.width,l.height),l.mBar.setMask(l.maskGraphics.createGeometryMask()),l.add([l.mBackground,l.mBar]),l.mText&&l.add(l.mText),l.disInteractive(),l}return s(ProgressMaskBar,t),ProgressMaskBar.prototype.setProgress=function(t,e){var i=t/e;i>1?i=1:i<0&&(i=0),this.value=i,this.max=e,this.refreshMask()},ProgressMaskBar.prototype.setText=function(t){this.mText&&(this.mText.text=t,this.mText.parentContainer||this.add(this.mText))},ProgressMaskBar.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.zoom!==t.scaleX&&(this.zoom=t.scaleX,this.maskGraphics.clear(),this.maskGraphics.fillRect(0,0,this.width*this.zoom,this.height*this.zoom));var e=t.tx-this.width*this.zoom*1.5+this.width*this.zoom*this.value,i=t.ty-this.height*this.zoom*.5;this.maskGraphics.setPosition(e,i)},ProgressMaskBar.prototype.destroy=function(){t.prototype.destroy.call(this),this.maskGraphics.destroy()},Object.defineProperty(ProgressMaskBar.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),Object.defineProperty(ProgressMaskBar.prototype,"bar",{get:function(){return this.mBar},enumerable:!1,configurable:!0}),ProgressMaskBar.prototype.createBackgroundBar=function(t,e,i,n,s,o){if(o){var h=o.width||this.width,l=o.height||this.height;this.mBackground=new a.NineSlicePatch(this.scene,0,-2*this.dpr,h,l,t,i,o),this.setSize(h,l)}else this.mBackground=this.scene.make.image({key:t,frame:e}),this.setSize(this.mBackground.width,this.mBackground.height);if(s){var c=s.width||this.width,p=s.height||this.height;this.mBar=new a.NineSlicePatch(this.scene,0,-2*this.dpr,c,p,t,i,s)}else this.mBar=this.scene.make.image({key:t,frame:i});n&&(this.mText=this.scene.make.text({style:n},!1))},ProgressMaskBar}(a.BaseUI)},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function EditorCanvas(t){this.mConfig=t,this.mGame=new Phaser.Game({parent:t.parent,type:Phaser.AUTO,backgroundColor:"#464646",render:{pixelArt:!0,roundPixels:!0,premultipliedAlpha:!1},plugins:{scene:[{key:"DragonBones",plugin:dragonBones.phaser.plugin.DragonBonesScenePlugin,mapping:"dragonbone"}]},scale:{mode:Phaser.Scale.NONE,width:t.width,height:t.height,autoCenter:Phaser.Scale.CENTER_BOTH}}),this.mEmitter=new Phaser.Events.EventEmitter}return EditorCanvas.prototype.resize=function(t,e){this.mGame&&this.mGame.scale.setGameSize(t,e)},EditorCanvas.prototype.destroy=function(){this.mGame&&(this.mGame.plugins.removeScenePlugin("DragonBones"),this.mGame.destroy(!0),this.mGame=null),this.mEmitter&&this.mEmitter.removeAllListeners()},EditorCanvas}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e);var n=i(28);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);var s=i(325);i.d(e,"UiManager",(function(){return s.UiManager}));var o=i(146);for(var a in o)["default","UiManager"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var h=i(331);i.d(e,"RankPanel",(function(){return h.RankPanel}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(15),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function BasicScene(e){var i=t.call(this,e)||this;return i.initialize=!1,i.layerManager=new a.i,i}return o(BasicScene,t),BasicScene.prototype.init=function(t){t&&(this.render=t.render)},BasicScene.prototype.preload=function(){var t=s.StringUtils.format("正在加载资源 {0}",["0%"]);this.render&&this.render.showLoading({text:t})},BasicScene.prototype.setScale=function(t){this.layerManager&&this.layerManager.setScale(t)},BasicScene.prototype.updateProgress=function(t){},BasicScene.prototype.create=function(){this.initialize=!0,this.render.emitter.emit("sceneCreated")},BasicScene.prototype.sceneInitialize=function(){return this.initialize},BasicScene.prototype.setViewPort=function(t,e,i,n){this.cameras.main.setViewport(t,e,i,n)},BasicScene.prototype.wake=function(t){this.scene.wake(void 0,t)},BasicScene.prototype.sleep=function(){this.scene.sleep()},BasicScene.prototype.stop=function(){this.scene.stop()},BasicScene}(Phaser.Scene)},function(t,e,i){"use strict";i.r(e),i.d(e,"DynamicNinepatch",(function(){return a}));var n=i(6),a=function(){function DynamicNinepatch(t,e){this.mScene=t,this.mParent=e}return DynamicNinepatch.prototype.load=function(t,e,i,n){this.mLoadCompleteCallBack=i,this.mLoadContext=n,this.mConfig=e,this.mUrl=t,this.mScene.cache.obj.get(t)?this.onLoadCompleteHandler():(this.mScene.load.image(this.mUrl,this.mUrl),this.mScene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.mScene.load.start())},DynamicNinepatch.prototype.onLoadCompleteHandler=function(){this.mImage=new n.NinePatch(this.mScene,this.mConfig),this.mLoadCompleteCallBack&&(this.mLoadCompleteCallBack.call(this.mLoadContext,this.mImage),this.mLoadCompleteCallBack=null,this.mLoadContext=null)},Object.defineProperty(DynamicNinepatch.prototype,"image",{get:function(){return this.mImage},enumerable:!1,configurable:!0}),DynamicNinepatch}()},function(t,e,i){"use strict";i.r(e),i.d(e,"DynamicSprite",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function DynamicSprite(e,i,n){var a=t.call(this,e,i,n,void 0)||this;return e.sys.updateList.add(a),a}return a(DynamicSprite,t),DynamicSprite.prototype.load=function(t,e,i,n,a){this.mLoadCompleteCallbak=n,this.mLoadErrorCallback=a,this.mLoadContext=i,this.mUrl=t+e,this.scene.cache.obj.get(this.mUrl)?this.onLoadComplete():(this.scene.load.atlas(this.mUrl,t,e),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start())},DynamicSprite.prototype.destroy=function(e){this.scene.sys.updateList.remove(this),t.prototype.destroy.call(this,e)},DynamicSprite.prototype.onLoadComplete=function(){if(this.mLoadCompleteCallbak){var t=this.mLoadCompleteCallbak;this.mLoadCompleteCallbak=null,t.call(this.mLoadContext),this.mLoadContext=null}this.scene.anims.create({key:this.mUrl,frames:this.scene.anims.generateFrameNames(this.mUrl),repeat:1}),this.play(this.mUrl)},DynamicSprite.prototype.onLoadError=function(t){if(this.mUrl===t.url&&this.mLoadErrorCallback){var e=this.mLoadErrorCallback;this.mLoadErrorCallback=null,e.call(this.mLoadContext),this.mLoadContext=null}},DynamicSprite}(Phaser.GameObjects.Sprite)},function(t,e,i){"use strict";i.r(e),i.d(e,"InputPanel",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function InputPanel(e,i,n){var s=t.call(this)||this;s.render=i,s.scene=e;var o=e.cameras.main.width,h=e.cameras.main.height;return s.mBackground=e.add.graphics(),s.mBackground.fillStyle(0,.6),s.mBackground.fillRect(0,0,o,h).setInteractive(new Phaser.Geom.Rectangle(0,0,o,h),Phaser.Geom.Rectangle.Contains),s.mInput=new a.InputText(e,6*i.uiRatio,6*i.uiRatio,o-12*i.uiRatio,40*i.uiRatio,{fontSize:20*i.uiRatio+"px",color:"#0",text:n,backgroundColor:"#FFFFFF",borderColor:"#FF9900"}).setOrigin(0,0),s.mInput.node.addEventListener("keypress",(function(t){13===(t.keyCode||t.which)&&s.onCloseHandler()})),s.mInput.x=6*i.uiRatio,s.scene.input.on("pointerdown",s.onFoucesHandler,s),s.render.game.device.os.iOS?s.mInput.on("click",s.onFoucesHandler,s):s.mInput.on("focus",s.onFoucesHandler,s),s.mInput.setFocus(),s}return s(InputPanel,t),InputPanel.prototype.onCloseHandler=function(){this.emit("close",this.mInput.text),this.mBackground.destroy(),this.mInput.destroy(),this.destroy(),this.scene.input.off("pointerdown",this.onFoucesHandler,this),this.scene=void 0},InputPanel.prototype.onFoucesHandler=function(){this.mInput.node.focus()},InputPanel}(Phaser.Events.EventEmitter)},function(t,e,i){"use strict";i.r(e),i.d(e,"CheckboxGroup",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function CheckboxGroup(){var e=t.call(this)||this;return e.mList=[],e}return s(CheckboxGroup,t),CheckboxGroup.prototype.appendItem=function(t){return this.mList.push(t),t.on(a.ClickEvent.Tap,this.onGameObjectUpHandler,this),this},CheckboxGroup.prototype.appendItemAll=function(t){this.mList=this.mList.concat(t);for(var e=0,i=t;e<i.length;e++){i[e].on(a.ClickEvent.Tap,this.onGameObjectUpHandler,this)}return this},CheckboxGroup.prototype.removeItem=function(t){return this.mList=this.mList.filter((function(e){return e!==t})),t.removeAllListeners(),this},CheckboxGroup.prototype.selectIndex=function(t){return t<0&&(t=0),t>=this.mList.length&&(t=this.mList.length-1),this.mList.length>0&&this.select(this.mList[t]),this},CheckboxGroup.prototype.select=function(t){this.mSelectedButton!==t&&(this.mSelectedButton&&(this.mSelectedButton.selected=!1),t.changeDown(),this.mSelectedButton=t,this.emit(a.ClickEvent.Selected,t))},CheckboxGroup.prototype.reset=function(){var t=this;this.mList&&this.mList.forEach((function(e){t.removeItem(e)}))},CheckboxGroup.prototype.destroy=function(){var e=this;this.mList&&this.mList.forEach((function(t){e.removeItem(t),t.destroy()})),t.prototype.destroy.call(this)},CheckboxGroup.prototype.onGameObjectUpHandler=function(t,e){this.select(e)},Object.defineProperty(CheckboxGroup.prototype,"selectedIndex",{get:function(){return this.mList.indexOf(this.mSelectedButton)},enumerable:!1,configurable:!0}),CheckboxGroup}(Phaser.Events.EventEmitter)},function(t,e,i){"use strict";i.r(e),i.d(e,"TextButton",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function TextButton(e,i,n,s,o,h){void 0===n&&(n=1);var l=t.call(this,e,o,h)||this;return l.normalColor="#FFFFFF",l.changeColor="#0099cc",l.mText=l.scene.make.text({text:s,style:{fontSize:15*window.devicePixelRatio,fontFamily:a.Font.DEFULT_FONT}},!1).setOrigin(.5,.5),l.add(l.mText),l}return s(TextButton,t),TextButton.prototype.setText=function(t){this.mText.text=t},TextButton.prototype.setFontSize=function(t){this.mText.setFontSize(t)},TextButton.prototype.setFontStyle=function(t){this.mText.setFontStyle(t)},TextButton.prototype.setStyle=function(t){this.mText.setStyle(t)},TextButton.prototype.setNormalColor=function(t){this.normalColor=t},TextButton.prototype.setChangeColor=function(t){this.changeColor=t},TextButton.prototype.changeDown=function(){this.mText.setFill(this.changeColor)},TextButton.prototype.changeNormal=function(){this.mText.setFill(this.normalColor)},TextButton.prototype.onPointerUpHandler=function(t){this.emit("click",t,this)},Object.defineProperty(TextButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),TextButton}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"LabelInput",(function(){return h}));var n,a=i(6),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function LabelInput(e,i){var n=t.call(this,e)||this;n.mAutoBlur=!0;var a={fontFamily:s.Font.DEFULT_FONT},o=i.width||100,h=i.height||100;return n.mPlaceholder=i.placeholder,n.mLabel=n.scene.make.text({text:n.mPlaceholder,style:Object.assign(a,i)},!1).setInteractive(new Phaser.Geom.Rectangle(.5*-o,.5*-h,o,h),Phaser.Geom.Rectangle.Contains),n.mOriginX=n.mLabel.originX,n.mOriginY=n.mLabel.originY,n.mLabel.on("pointerdown",n.onPointerDownHandler,n),n.mLabel.on("pointerup",n.onShowInputHandler,n),n.add(n.mLabel),n.setSize(o,h),n.mInputConfig=i,n}return o(LabelInput,t),LabelInput.prototype.setText=function(t){return this.mLabel.setText(this.mPlaceholder?t||this.mPlaceholder:t),this.mInputText&&(this.mInputText.text=t),this},LabelInput.prototype.setOrigin=function(t,e){return void 0===e&&(e=t),this.mLabel.setOrigin(t,e),this.mOriginX=t,this.mOriginY=e,this.mInputText&&this.mInputText.setOrigin(t,e),this.mLabel.input.hitArea=new Phaser.Geom.Rectangle(-this.width*t,-this.height*e,this.width,this.height),this},LabelInput.prototype.createBackground=function(t,e){this.mBackground||(this.mBackground=this.scene.make.graphics(void 0,!1)),this.mBackground.clear(),this.mBackground.fillStyle(16777215),this.mBackground.fillRoundedRect(-t+this.width*this.mLabel.originX,-t+this.height*this.mLabel.originY,this.width+2*t,this.height+2*t,e),this.addAt(this.mBackground,0)},LabelInput.prototype.setSize=function(e,i){return t.prototype.setSize.call(this,e,i),this.mLabel.input.hitArea=new Phaser.Geom.Rectangle(-this.width*this.mLabel.originX,-this.height*this.mLabel.originX,this.width,this.height),this},LabelInput.prototype.setAutoBlur=function(t){return this.mAutoBlur=t,this},LabelInput.prototype.setBlur=function(){this.onShowLabel()},LabelInput.prototype.destroy=function(){this.mLabel.destroy(),this.destroyInput(),t.prototype.destroy.call(this)},LabelInput.prototype.createInputText=function(){var t=this;this.mInputText||(this.mInputText=new a.InputText(this.scene,Object.assign({},this.mInputConfig)).setOrigin(this.mOriginX,this.mOriginY),this.mInputText.on("textchange",this.onTextChangeHandler,this),this.mInputText.on("blur",this.onTextBlurHandler,this),this.mInputText.on("focus",this.onTextFocusHandler,this),this.mInputText.x=this.mLabel.x,this.mInputText.y=this.mLabel.y,this.mInputText.node.addEventListener("keypress",(function(e){13===(e.keyCode||e.which)&&(t.emit("enter",t.mInputText.text),t.mAutoBlur&&t.onShowLabel())})))},LabelInput.prototype.onShowInputHandler=function(){this.createInputText(),this.remove(this.mLabel),this.add(this.mInputText),this.mInputConfig.placeholder!==this.mLabel.text&&this.mInputText.setText(this.mLabel.text),this.mInputText.setFocus()},LabelInput.prototype.onPointerDownHandler=function(){},LabelInput.prototype.onShowLabel=function(){this.mInputText&&(!this.mInputText.text&&this.mInputConfig.placeholder?this.mLabel.setText(this.mInputConfig.placeholder):this.mLabel.setText(this.mInputText.text),this.destroyInput()),this.add(this.mLabel)},LabelInput.prototype.destroyInput=function(){this.mInputText&&(this.mInputText.off("textchange",this.onTextChangeHandler,this),this.mInputText.off("blur",this.onTextBlurHandler,this),this.mInputText.off("focus",this.onTextFocusHandler,this),this.mInputText.destroy(),this.mInputText=void 0)},LabelInput.prototype.onTextChangeHandler=function(t,e){this.emit("textchange")},LabelInput.prototype.onTextBlurHandler=function(){this.emit("blur")},LabelInput.prototype.onTextFocusHandler=function(t){this.emit("focus")},Object.defineProperty(LabelInput.prototype,"object",{get:function(){return this.mInputText||this.mLabel},enumerable:!1,configurable:!0}),Object.defineProperty(LabelInput.prototype,"text",{get:function(){return this.mInputText?this.mInputText.text:this.mLabel.text},enumerable:!1,configurable:!0}),LabelInput}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"NinePatchButton",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function NinePatchButton(e,i,n,s,o,h,l,c,p,d){var u=t.call(this,e,i,n)||this;return u.mScene=e,u.mKey=h,u.mFrame=l||"__BASE",u.initFrame(),u.setSize(s,o),u.mNingBg=new a.NineSlicePatch(u.scene,0,0,s,o,h,u.mFrame_nrmal,p),u.add(u.mNingBg),d&&(u.btnData=d),u.mLabel=u.scene.make.text(void 0,!1).setOrigin(.5,.5).setSize(u.width,u.height).setAlign("center").setText(c),u.add(u.mLabel),u.setInteractive(new Phaser.Geom.Rectangle(0,0,s,o),Phaser.Geom.Rectangle.Contains),u.on("pointerdown",u.onPointerDown,u),u.on("pointerup",u.onPointerUp,u),u}return s(NinePatchButton,t),Object.defineProperty(NinePatchButton.prototype,"enable",{set:function(t){t?(this.mNingBg.clearTint(),this.mLabel.clearTint(),this.setInteractive()):(this.mNingBg.setTintFill(6710886),this.mLabel.setTintFill(7829367),this.removeInteractive())},enumerable:!1,configurable:!0}),NinePatchButton.prototype.getBtnData=function(){return this.btnData},NinePatchButton.prototype.setText=function(t){this.mLabel.setText(t)},NinePatchButton.prototype.getText=function(){return this.mLabel.text},NinePatchButton.prototype.setTextStyle=function(t){this.mLabel.setStyle(t)},NinePatchButton.prototype.setFontStyle=function(t){this.mLabel.setFontStyle(t)},NinePatchButton.prototype.setTextOffset=function(t,e){this.mLabel.setPosition(t,e)},NinePatchButton.prototype.setFrame=function(t){return this.mNingBg.setFrame(String(t)),this},NinePatchButton.prototype.destroy=function(e){this.mLabel&&this.mLabel.destroy(),t.prototype.destroy.call(this,e)},NinePatchButton.prototype.setFrameNormal=function(t,e,i){return this.mFrame_nrmal=t,this.mFrame_down=e||t,this.mFrame_over=i||t,this.changeNormal(),this},NinePatchButton.prototype.changeNormal=function(){this.setFrame(this.mFrame_nrmal)},NinePatchButton.prototype.changeDown=function(){this.setFrame(this.mFrame_down)},NinePatchButton.prototype.changeOver=function(){this.setFrame(this.mFrame_over)},NinePatchButton.prototype.isExists=function(t){var e=this.scene.textures.get(this.mKey);return!(!e||!e.has(t))},NinePatchButton.prototype.onPointerDown=function(t){this.changeDown()},NinePatchButton.prototype.onPointerUp=function(t){this.changeNormal(),this.emit("click",t,this)},Object.defineProperty(NinePatchButton.prototype,"label",{get:function(){return this.mLabel},enumerable:!1,configurable:!0}),NinePatchButton.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},NinePatchButton.prototype.initFrame=function(){var t=this.mFrame?this.mFrame:this.mKey;this.mFrame_nrmal=t+"_normal";var e=t+"_down";this.isExists(e)||(e=t+"_normal"),this.mFrame_down=e;var i=t+"_over";this.isExists(i)||(i=t+"_normal"),this.mFrame_over=i},NinePatchButton}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"AlertView",(function(){return d})),i.d(e,"Buttons",(function(){return a}));var n,a,s=i(6),o=i(0),h=i(2),l=i(60),c=i(147),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function AlertView(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=o.ModuleName.ALERTVIEW_NAME,i.disInteractive(),i}return p(AlertView,t),AlertView.prototype.show=function(e){if(this.mShowData=e,t.prototype.show.call(this,e),this.mInitialized){this.mScene.layerManager.addToLayer(c.a.LAYER_DIALOG,this);var i=e.ox,n=e.oy;this.x=i||this.scene.cameras.main.width/2,this.y=n||this.scene.cameras.main.height/2,this.mBackGround.clear(),this.mBackGround.fillStyle(16777215,0),this.mBackGround.fillRect(-this.x,-this.y,this.cameraWidth,this.cameraHeight),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(-this.x,-this.y,this.cameraWidth,this.cameraHeight),Phaser.Geom.Rectangle.Contains),this.mContent.setText(e.text),e.title&&this.mTitleLabel.setText(e.title);var s=e.btns;s===a.Cancel?(this.remove(this.mOkBtn),this.mCancelBtn.x=0):s===a.Ok&&(this.remove(this.mCancelBtn),this.mOkBtn.x=0)}},AlertView.prototype.preload=function(){this.addAtlas(this.key,"pica_alert/pica_alert.png","pica_alert/pica_alert.json"),t.prototype.preload.call(this)},AlertView.prototype.setOKText=function(t){return this.mOkText=t,this.mOkBtn&&this.mOkBtn.setText(t),this},AlertView.prototype.init=function(){var e=this.mWorld.uiScale||1;this.mBackGround=this.scene.make.graphics(void 0,!1),this.add(this.mBackGround);var i=this.scene.make.image({key:this.key,frame:"bg.png"},!1);i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var n=this.scene.make.image({key:this.key,frame:"title.png"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),n.y=-i.height/2,this.mTitleLabel=this.scene.make.text({text:h.i18n.t("common.tips"),style:{fontFamily:h.Font.DEFULT_FONT,fontSize:12*this.dpr*e,color:"#905B06"}},!1).setOrigin(.5),this.mTitleLabel.y=n.y,this.mContent=new s.BBCodeText(this.scene,0,-11*this.dpr,"",{fontSize:12*this.dpr*e+"px",fontFamily:h.Font.DEFULT_FONT,color:"#0",wrap:{mode:"char",width:218*this.dpr}}),this.mContent.setOrigin(.5,.5),this.mOkBtn=new s.Button(this.scene,this.key,"yellow_btn.png",void 0,this.mOkText||h.i18n.t("common.confirm")),this.mOkBtn.setTextStyle({color:"#905B06",fontFamily:h.Font.DEFULT_FONT,fontSize:13*this.dpr*e}),this.mOkBtn.x=(i.width-this.mOkBtn.displayWidth)/2-38*this.dpr,this.mOkBtn.y=(i.height-this.mOkBtn.displayHeight)/2-16*this.dpr,this.mOkBtn.on(s.ClickEvent.Tap,this.onOkHandler,this),this.mCancelBtn=new s.Button(this.scene,this.key,"red_btn.png",void 0,h.i18n.t("common.cancel")),this.mCancelBtn.setTextStyle({fontFamily:h.Font.DEFULT_FONT,fontSize:13*this.dpr*e}),this.mCancelBtn.x=-(i.width-this.mCancelBtn.displayWidth)/2+38*this.dpr,this.mCancelBtn.y=this.mOkBtn.y,this.mCancelBtn.on(s.ClickEvent.Tap,this.onCancelHandler,this),this.add([i,n,this.mTitleLabel,this.mTitleLabel,this.mContent,this.mOkBtn,this.mCancelBtn]),t.prototype.init.call(this)},AlertView.prototype.onOkHandler=function(){if(this.mShowData){var t=this.mShowData.callback;t&&t.call(this.mShowData.content),this.closePanel()}},AlertView.prototype.onCancelHandler=function(){var t=this.mShowData.cancelback;t&&t.call(this.mShowData.content),this.closePanel()},AlertView.prototype.closePanel=function(){this.parentContainer&&this.parentContainer.remove(this),this.mShowData&&!1===this.mShowData.once||(this.destroy(),this.mShowData=void 0)},AlertView}(l.BasePanel);!function(t){t[t.Ok=0]="Ok",t[t.Cancel=1]="Cancel",t[t.OKAndCancel=2]="OKAndCancel"}(a||(a={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"TextToolTips",(function(){return h}));var n,a=i(6),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function TextToolTips(e,i,n,o,h){var l=t.call(this,e)||this,c=e.textures.getFrame(i,n),p=c.width,d=c.height;return l.dpr=o,l.bg=new a.NineSlicePatch(l.scene,0,0,p,d,i,n,{left:20*o,top:20*o,right:20*o,bottom:20*o}),l.text=new a.BBCodeText(l.scene,0,0,"蓝矿石",{color:"#333333",fontSize:13*l.dpr,fontFamily:s.Font.DEFULT_FONT,wrap:{width:90*l.dpr,mode:"string"}}).setOrigin(0),l.add([l.bg,l.text]),l.setSize(p+20*o,d+20*o),l}return o(TextToolTips,t),TextToolTips.prototype.setSize=function(e,i){t.prototype.setSize.call(this,e,i),this.bg.resize(e,i),this.bg.setPosition(0,0);var n=e-16*this.dpr,a=i-16*this.dpr;return this.text.setSize(n,a),this.text.setWrapWidth(n),this.text.setPosition(.5*-n,.5*-a),this},TextToolTips.prototype.setText=function(t){this.text.text=t,this.text.height>this.height&&this.setSize(this.width,this.text.height+16*this.dpr)},TextToolTips.prototype.setDelayText=function(t,e,i){var n=this;this.visible=!0,this.setText(t),this.timeID&&clearTimeout(this.timeID),this.timeID=setTimeout((function(){n.visible=!1,i&&i.run()}),e)},TextToolTips}(Phaser.GameObjects.Container)},function(t,e){},function(t,e,i){"use strict";i.r(e),i.d(e,"ImageValue",(function(){return l})),i.d(e,"ImageBBCodeValue",(function(){return c})),i.d(e,"DynamicImageValue",(function(){return p}));var n,a=i(6),s=i(2),o=i(59),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function ImageValue(e,i,n,a,s,o,h){var l=t.call(this,e)||this;return l.layoutType=1,l.dpr=o,l.setSize(i,n),l.offset=new Phaser.Geom.Point(0,0),l.create(a,s,h),l.add([l.icon,l.value]),l.resetSize(),l}return h(ImageValue,t),ImageValue.prototype.setFrameValue=function(t,e,i){this.icon.setTexture(e,i),this.value.text=t,this.resetSize()},ImageValue.prototype.setText=function(t){this.value.text=t,this.resetSize()},ImageValue.prototype.setFontStyle=function(t){this.value.setFontStyle(t)},ImageValue.prototype.setTextStyle=function(t){this.value.setStyle(t)},ImageValue.prototype.setTextFilter=function(t){this.value.texture.setFilter(t)},ImageValue.prototype.setShadow=function(t,e,i,n,a,s){this.value.setShadow(t,e,i,n,a,s)},ImageValue.prototype.setStroke=function(t,e){this.value.setStroke(t,e)},ImageValue.prototype.setOffset=function(t,e){this.offset.x=t,this.offset.y=e,this.resetSize()},ImageValue.prototype.resetSize=function(){var t=this.icon.displayWidth+this.value.width,e=this.width-t;1===this.layoutType?this.x-=.5*e:3===this.layoutType&&(this.x+=.5*e),this.setSize(t,this.height),this.resetPosition()},ImageValue.prototype.setLayout=function(t){this.layoutType=t,this.resetSize()},ImageValue.prototype.create=function(t,e,i){this.icon=this.scene.make.image({key:t,frame:e}),this.icon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i||(i={fontFamily:s.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#ffffff"}),this.value=this.scene.make.text({x:0,y:0,text:"0",style:i}),this.value.setOrigin(0,.5);var n=this.icon.displayWidth+this.value.width;this.setSize(n,this.height)},ImageValue.prototype.resetPosition=function(){this.icon.x=.5*-this.width+.5*this.icon.displayWidth,this.value.x=this.icon.x+.5*this.icon.displayWidth+4*this.dpr+this.offset.x,this.value.y=this.offset.y},ImageValue}(Phaser.GameObjects.Container),c=function(t){function ImageBBCodeValue(e,i,n,a,s,o,h){return t.call(this,e,i,n,a,s,o,h)||this}return h(ImageBBCodeValue,t),ImageBBCodeValue.prototype.create=function(t,e,i){this.icon=this.scene.make.image({key:t,frame:e}),this.icon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i||(i={fontFamily:s.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#ffffff"}),this.value=new a.BBCodeText(this.scene,0,0,"10",i),this.value.setOrigin(0,.5);var n=this.icon.displayWidth+this.value.width;this.setSize(n,this.height)},ImageBBCodeValue}(l),p=function(t){function DynamicImageValue(e,i,n,a,s,o,h){return t.call(this,e,i,n,a,s,o,h)||this}return h(DynamicImageValue,t),DynamicImageValue.prototype.load=function(t){var e=this;this.icon.load(t,this,(function(){e.icon.scale=1,e.icon.displayHeight=e.height-4*e.dpr,e.icon.scaleX=e.icon.scaleY,e.icon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),e.resetSize()}))},DynamicImageValue.prototype.create=function(t,e,i){this.icon=new o.DynamicImage(this.scene,0,0),this.icon.scale=this.dpr,i||(i=s.UIHelper.whiteStyle(this.dpr)),this.value=this.scene.make.text({x:0,y:0,text:"10",style:i}),this.value.setOrigin(0,.5);var n=this.icon.displayWidth+this.value.width;this.setSize(n,this.height)},DynamicImageValue}(l)},function(t,e,i){"use strict";i.r(e),i.d(e,"InputView",(function(){return c}));var n,a=i(6),s=i(21),o=i(2),h=i(60),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function InputView(e,i){return t.call(this,e,i)||this}return l(InputView,t),InputView.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mWorld.uiManager.getUILayerManager().addToDialogLayer(this):this.preload())},InputView.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;this.content.x=n/2,this.content.y=a/2,t.prototype.resize.call(this,e,i),this.border.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains)},InputView.prototype.preload=function(){this.addAtlas(s.c.common3Key,s.d.textureUrl(s.d.common3Url),s.d.jsonUrl(s.d.common3Url)),this.addAtlas(s.c.commonKey,s.d.textureUrl(s.d.commonUrl),s.d.jsonUrl(s.d.commonUrl)),t.prototype.preload.call(this)},InputView.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height,h=this.scene.make.graphics(void 0,!1);h.fillStyle(0,.6),h.fillRect(0,0,i,n),this.add(h),this.border=h,this.content=this.scene.make.container(void 0,!1),this.add(this.content);var l=this.scene.make.image({key:s.c.common3Key,frame:"bg_universal_box"});this.content.add(l),this.content.setSize(l.width,l.height),this.closeBtn=new a.Button(this.scene,this.key,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.content.width-5*this.dpr,.5*-this.content.height+4*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn);var c=this.scene.make.image({y:-l.height/2,key:s.c.common3Key,frame:"title"});c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add(c),this.mTitleLabel=this.scene.make.text({y:c.y-6*this.dpr,style:{fontFamily:o.Font.DEFULT_FONT,fontSize:19*this.dpr,color:"#905B06"}},!1).setOrigin(.5),this.content.add(this.mTitleLabel);var p=new a.NineSliceButton(this.mScene,0,0,181*this.dpr,45*this.dpr,s.c.commonKey,"yellow_btn_normal",o.i18n.t("common.editnow"),this.dpr,this.scale,o.UIHelper.button(this.dpr));p.setTextStyle(o.UIHelper.brownishStyle(this.dpr,21)),p.setFontStyle("bold"),p.y=.5*this.content.height-.5*p.height-20*this.dpr,p.on(a.ClickEvent.Tap,this.onClickHandler,this),this.content.add(p),this.mInput=this.createInput(0,-30*this.dpr,279*this.dpr,52*this.dpr,17*this.dpr),this.mInput.on("textchange",this.onTextChangeHandler,this),t.prototype.init.call(this),this.resize(i,n),this.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains)},InputView.prototype.createInput=function(t,e,i,n,s,o){void 0===o&&(o="text");var h=this.scene.make.graphics(void 0,!1);h.fillStyle(10809331,.66),h.fillRoundedRect(.5*-i,.5*-n,i,n,6*this.dpr),h.setPosition(t,e),this.content.add(h);var l=new a.InputText(this.scene,t,e,i-20*this.dpr,n-10*this.dpr,{type:o,placeholder:this.showData.placeholder,color:"#055C62",fontSize:s+"px"});return this.content.add(l),l},InputView.prototype.onClickHandler=function(){var t=this.mInput.text,e=this.showData.handler;e&&e.runWith(t),this.onCloseHandler()},InputView.prototype.onCloseHandler=function(){this.parentContainer&&(this.parentContainer.remove(this),this.destroy()),this.mShowData&&!1===this.mShowData.once||(this.destroy(),this.mShowData=void 0)},InputView.prototype.onTextChangeHandler=function(){var t=this.showData.maxWidth;t&&(this.mInput.text=o.UIHelper.spliceText(t,this.mInput.text,17*this.dpr,this.scene))},InputView}(h.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"ButtonState",(function(){return a})),i.d(e,"ThreeSliceButton",(function(){return l}));var n,a,s=i(6),o=i(83),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t.Normal="normal",t.Over="over",t.Select="select",t.Disable="disable"}(a||(a={}));var l=function(t){function ThreeSliceButton(e,i,n,a,s,o,h,l,c,p,d){var u=t.call(this,e)||this;return u.mDownTime=0,u.mPressDelay=1e3,u.mIsMove=!1,u.mTweening=!1,u.tweenScale=.9,u.mTweenBoo=!0,u.dpr=l||1,u.zoom=c||1,u.soundGroup={up:{key:"click"}},void 0===p&&(p=!0),u.mTweenBoo=p,Object.assign(u.soundGroup,d),u.mKey=a,u.mFrame=s,u.mDownFrame=o,u.setSize(i,n),u.createBackground(),h&&(u.mText=u.scene.make.text({color:"#ffffff",fontSize:16*l},!1).setOrigin(.5,.5).setText(h),u.mBackground&&u.mText.setSize(u.mBackground.width,u.mBackground.height),u.add(u.mText)),u.setInteractive(),u.addListen(),u}return h(ThreeSliceButton,t),Object.defineProperty(ThreeSliceButton.prototype,"background",{get:function(){return this.mBackground},enumerable:!1,configurable:!0}),Object.defineProperty(ThreeSliceButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),ThreeSliceButton.prototype.addListen=function(){this.removeListen(),this.on("pointerdown",this.onPointerDownHandler,this),this.on("pointerup",this.onPointerUpHandler,this),this.on("pointerout",this.onPointerOutHandler,this),this.on("pointermove",this.onPointerMoveHandler,this)},ThreeSliceButton.prototype.removeListen=function(){this.off("pointerdown",this.onPointerDownHandler,this),this.off("pointerup",this.onPointerUpHandler,this),this.off("pointerout",this.onPointerOutHandler,this),this.off("pointermove",this.onPointerMoveHandler,this)},ThreeSliceButton.prototype.setEnable=function(t,e){void 0===e&&(e=!0),t?(this.mBackground&&(this.mBackground.clearTint(),this.mText&&this.mText.clearTint()),this.setInteractive()):(this.mBackground&&e&&(this.mBackground.setTintFill(6710886),this.mText&&this.mText.setTintFill(7829367)),this.removeInteractive())},Object.defineProperty(ThreeSliceButton.prototype,"tweenEnable",{set:function(t){this.mTweenBoo=t},enumerable:!1,configurable:!0}),ThreeSliceButton.prototype.mute=function(t){this.silent=t},ThreeSliceButton.prototype.changeNormal=function(){this.setBgFrame(this.mFrame)},ThreeSliceButton.prototype.changeDown=function(){this.mDownFrame&&this.setBgFrame(this.mDownFrame)},ThreeSliceButton.prototype.setFrame=function(t){this.setBgFrame(t)},ThreeSliceButton.prototype.setText=function(t){this.mText&&this.mText.setText(t)},ThreeSliceButton.prototype.setTextStyle=function(t){this.mText&&this.mText.setStyle(t)},ThreeSliceButton.prototype.setFontStyle=function(t){this.mText&&this.mText.setFontStyle(t)},ThreeSliceButton.prototype.setTextOffset=function(t,e){this.mText&&this.mText.setPosition(t,e)},ThreeSliceButton.prototype.setTextColor=function(t){this.mText&&this.mText.setColor(t)},ThreeSliceButton.prototype.setFrameNormal=function(t,e){return this.mFrame=t,this.mDownFrame=e||t,this.changeNormal(),this},ThreeSliceButton.prototype.createBackground=function(){this.mFrame&&(this.mBackground=new o.ThreeSlicePath(this.scene,0,0,this.width,this.height,this.mKey,this.mFrame,this.dpr,this.zoom,4),this.add(this.mBackground))},ThreeSliceButton.prototype.setBgFrame=function(t){this.mBackground&&this.mBackground.setFrame(t)},ThreeSliceButton.prototype.buttonStateChange=function(t){switch(t){case a.Normal:this.changeNormal();break;case a.Over:break;case a.Select:this.changeDown();break;case a.Disable:}},ThreeSliceButton.prototype.onPointerMoveHandler=function(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move),this.interactiveBoo&&(this.mIsMove=!0,this.emit(s.ClickEvent.Move))},ThreeSliceButton.prototype.onPointerUpHandler=function(t){this.interactiveBoo?this.mTweenBoo?this.tween(!1,this.pointerUp.bind(this,t)):this.pointerUp(t):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)},ThreeSliceButton.prototype.pointerUp=function(t){this.buttonStateChange(a.Normal);var e=this.checkPointerInBounds(this,t.worldX,t.worldY);this.emit(s.ClickEvent.Up,this),e&&this.mIsDown&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.emit(s.ClickEvent.Tap,t,this)),clearTimeout(this.mPressTime),this.mIsMove=!1,this.mIsDown=!1,this.mDownTime=0},ThreeSliceButton.prototype.onPointerOutHandler=function(t){this.mTweenBoo&&t.isDown&&this.tween(!1)},ThreeSliceButton.prototype.onPointerDownHandler=function(t){var e=this;this.mTweening||(this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.buttonStateChange(a.Select),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){e.emit(s.ClickEvent.Hold,e)}),this.mPressDelay),this.mTweenBoo&&this.tween(!0),this.emit(s.ClickEvent.Down,this),this.mIsDown=!0):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled))},ThreeSliceButton.prototype.checkPointerInBounds=function(t,e,i){this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var n=this.zoom?this.zoom:1;this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2;var a=t.getWorldTransformMatrix(),s=(e-a.tx)/n,o=(i-a.ty)/n;return this.mRectangle.left<=s&&this.mRectangle.right>=s&&this.mRectangle.top<=o&&this.mRectangle.bottom>=o},ThreeSliceButton.prototype.tween=function(t,e){var i=this;this.mTweening=!0;var n=t?this.tweenScale:1;this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTween=this.scene.tweens.add({targets:this.list,duration:45,ease:"Linear",props:{scaleX:{value:n},scaleY:{value:n}},onComplete:function(){i.tweenComplete(t),e&&e()},onCompleteParams:[this]})},ThreeSliceButton.prototype.tweenComplete=function(t){this.mTweening=!1,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0)},ThreeSliceButton}(s.BaseUI)},function(t,e,i){"use strict";i.r(e),i.d(e,"TweenCompent",(function(){return n}));var n=function(){function TweenCompent(t,e,i){this.mTweening=!1,this.mScale=1,this.mPingpang=!1,this.mTempPing=!1,this.mScene=t,this.mTarget=e,this.mScale=i.scale||e.scale,this.mX=void 0===i.x?e.x:i.x,this.mY=void 0===i.y?e.y:i.y,this.mPingpang=i.pingpang||!1,this.mPingpang&&(this.tempData={scale:e.scale,x:e.x,y:e.y})}return TweenCompent.prototype.tween=function(){var t=this;this.mTweening=!0,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0);var e=this.mTempPing?this.tempData.scale:this.mScale,i=this.mTempPing?this.tempData.x:this.mX,n=this.mTempPing?this.tempData.y:this.mY;this.mTween=this.mScene.tweens.add({targets:this.mTarget,x:{value:i,duration:45,ease:"Bounce.easeOut"},y:{value:n,duration:45,ease:"Bounce.easeOut"},scaleX:{value:e,duration:45,ease:"Bounce.easeOut"},scaleY:{value:e,duration:45,ease:"Bounce.easeOut"},onComplete:function(){t.tweenComplete()},onCompleteParams:[this.mTarget]})},TweenCompent.prototype.tweenComplete=function(){this.mTweening=!1,this.mPingpang&&!this.mTempPing?(this.mTempPing=!0,this.tween()):(this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTempPing=!1)},TweenCompent}()},function(t,e,i){"use strict";i.r(e),i.d(e,"ValueContainer",(function(){return h}));var n,a=i(6),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function ValueContainer(e,i,n,a){void 0===a&&(a=1);var s=t.call(this,e)||this;return s.init(i,n,a),s}return o(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.setHandler=function(t){this.sendHandler=t},ValueContainer.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:14*i,fontFamily:s.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new a.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=.5*-n.width+5*i,this.mLeft.y=n.y+.5*n.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*i,this.mText.x=4*i,this.add([n,this.mLeft,this.mText,this.mAddBtn]),this.mAddBtn.on(a.ClickEvent.Tap,this.onAddHandler,this)},ValueContainer.prototype.onAddHandler=function(){this.sendHandler&&this.sendHandler.run()},ValueContainer}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"GridLayoutGroup",(function(){return c})),i.d(e,"AlignmentType",(function(){return a})),i.d(e,"CornerType",(function(){return s})),i.d(e,"AxisType",(function(){return o})),i.d(e,"ConstraintType",(function(){return h}));var n,a,s,o,h,l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function GridLayoutGroup(e,i,n,l){var c=t.call(this,e,i,n)||this;return c.layoutElements=[],c._padding=l.padding||new Phaser.Math.Vector4(0,0,0,0),c._cellSize=l.cellSize||new Phaser.Math.Vector2(100,100),c._spacing=l.space||new Phaser.Math.Vector2(0,0),c._alignmentType=l.alignmentType||a.UpperLeft,c._startCorner=l.startCorner||s.UpperLeft,c._startAxis=l.startAxis||o.Horizontal,c._constraint=l.constraint||h.Flexible,c._constraintCount=l.constraintCount||4,c}return l(GridLayoutGroup,t),GridLayoutGroup.prototype.onPlay=function(){},GridLayoutGroup.prototype.start=function(){},Object.defineProperty(GridLayoutGroup.prototype,"padding",{get:function(){return this._padding},set:function(t){void 0!==t&&(this._padding=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"cellSize",{get:function(){return this._cellSize},set:function(t){void 0!==t&&(t.x<0&&(t.x=0),t.y<0&&(t.y=0),this._cellSize=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"spacing",{get:function(){return this._spacing},set:function(t){void 0!==t&&(this._spacing=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"alignmentType",{get:function(){return this._alignmentType},set:function(t){t!==this._alignmentType&&(this._alignmentType=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"startCorner",{get:function(){return this._startCorner},set:function(t){t!==this._startCorner&&(this._startCorner=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"startAxis",{get:function(){return this._startAxis},set:function(t){t!==this._startAxis&&(this._startAxis=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"constraint",{get:function(){return this._constraint},set:function(t){t!==this._constraint&&(this._constraint=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"constraintCount",{get:function(){return this._constraintCount},set:function(t){void 0===t||isNaN(t)||(this._constraintCount=t)},enumerable:!1,configurable:!0}),GridLayoutGroup.prototype.Layout=function(){this.layoutElements.length=0;for(var t=0,e=this.list;t<e.length;t++){var i=e[t];i.visible&&this.layoutElements.push(i)}if(0!==this.layoutElements.length){var n=this._startCorner%2,a=Math.floor(this._startCorner/2),s=0,h=0,l=0,c=this.getCellCount();this._startAxis===o.Horizontal?(s=c.x,h=Phaser.Math.Clamp(c.x,1,this.layoutElements.length),l=Phaser.Math.Clamp(c.y,1,Math.ceil(this.layoutElements.length/s))):(s=c.y,l=Phaser.Math.Clamp(c.y,1,this.layoutElements.length),h=Phaser.Math.Clamp(c.x,1,Math.ceil(this.layoutElements.length/s)));for(var p=new Phaser.Math.Vector2(h*this._cellSize.x+(h-1)*this._spacing.x,l*this._cellSize.y+(l-1)*this._spacing.y),d=new Phaser.Math.Vector2(this.getStartOffset(0,p.x),this.getStartOffset(1,p.y)),u=0,m=0,f=0;f<this.layoutElements.length;f++)this._startAxis===o.Horizontal?(u=f%s,m=Math.floor(f/s)):(u=Math.floor(f/s),m=f%s),1===n&&(u=h-1-u),1===a&&(m=l-1-m),this.setChildAlongAxis(this.layoutElements[f],0,d.x+(this._cellSize.x+this._spacing.x)*u,this._cellSize.x),this.setChildAlongAxis(this.layoutElements[f],1,d.y+(this._cellSize.y+this._spacing.y)*m,this._cellSize.y);var y=d.x+(this._cellSize.x+this._spacing.x)*(u+1),g=d.y+(this._cellSize.y+this._spacing.y)*(m+1);this.width<y&&(this.width=y),this.height<g&&(this.height=g),this.setAllChildPositionOffset(0),this.setAllChildPositionOffset(1)}},GridLayoutGroup.prototype.setChildAlongAxis=function(t,e,i,n){0===e?t.width=n:t.height=n;var a=i;0===e?t.x=a+n*t.originX:t.y=a+n*t.originY},GridLayoutGroup.prototype.setAllChildPositionOffset=function(t){for(var e=0,i=this.layoutElements;e<i.length;e++){var n=i[e];if(0===t){var a=.5*this.width;n.x-=a}else{a=.5*this.height;n.y-=a}}},GridLayoutGroup.prototype.getStartOffset=function(t,e){var i=e+(0===t?this.paddingHorizontal():this.paddingVertical()),n=(0===t?this.width:this.height)-i,a=this.getAlignmentOnAxis(t);return(0===t?this._padding.x:this._padding.z)+n*a},GridLayoutGroup.prototype.getAlignmentOnAxis=function(t){return 0===t?this._alignmentType%3*.5:.5*Math.floor(this._alignmentType/3)},GridLayoutGroup.prototype.getCellCount=function(){var t=new Phaser.Math.Vector2;return this._constraint===h.FixedColumnCount?(t.x=this._constraintCount,this.layoutElements.length>=t.x&&(t.y=Math.floor(this.layoutElements.length/t.x)+(this.layoutElements.length%t.x>0?1:0))):this._constraint===h.FixedRowCount?(t.y=this._constraintCount,this.layoutElements.length>=t.y&&(t.x=Math.floor(this.layoutElements.length/t.y)+(this.layoutElements.length%t.y>0?1:0))):(t.x=Math.max(1,Math.floor((this.width-this.paddingHorizontal()+this._spacing.x+.001)/(this._cellSize.x+this._spacing.x))),t.y=Math.max(1,Math.floor((this.height-this.paddingVertical()+this._spacing.y+.001)/(this._cellSize.y+this._spacing.y)))),t},GridLayoutGroup.prototype.paddingHorizontal=function(){return this._padding.x+this._padding.y},GridLayoutGroup.prototype.paddingVertical=function(){return this._padding.z+this._padding.w},GridLayoutGroup.ClassName="gridLayoutGroup",GridLayoutGroup}(Phaser.GameObjects.Container);!function(t){t[t.UpperLeft=0]="UpperLeft",t[t.UpperCenter=1]="UpperCenter",t[t.UpperRight=2]="UpperRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.LowerLeft=6]="LowerLeft",t[t.LowerCenter=7]="LowerCenter",t[t.LowerRight=8]="LowerRight"}(a||(a={})),function(t){t[t.UpperLeft=0]="UpperLeft",t[t.UpperRight=1]="UpperRight",t[t.LowerLeft=2]="LowerLeft",t[t.LowerRight=3]="LowerRight"}(s||(s={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(o||(o={})),function(t){t[t.Flexible=0]="Flexible",t[t.FixedColumnCount=1]="FixedColumnCount",t[t.FixedRowCount=2]="FixedRowCount"}(h||(h={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"ItemsConsumeFunPanel",(function(){return p}));var n,a=i(59),s=i(6),o=i(148),h=i(2),l=i(21),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function ItemsConsumeFunPanel(e,i,n,a,s,o){void 0===o&&(o=!0);var h=t.call(this,e)||this;return h.materialItems=[],h.havebutton=!0,h.isEnough=!1,h.dpr=a,h.zoom=s,h.havebutton=o,h.setSize(i,n),h.create(),h}return c(ItemsConsumeFunPanel,t),ItemsConsumeFunPanel.prototype.createBackGrphaic=function(t,e){this.mblackGraphic=this.scene.make.graphics(void 0,!1),this.mblackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,t,e),Phaser.Geom.Rectangle.Contains),this.mblackGraphic.fillStyle(0,.66),this.mblackGraphic.fillRect(.5*-t,.5*-e+this.y,t,e),this.addAt(this.mblackGraphic,0)},ItemsConsumeFunPanel.prototype.resetMask=function(){this.gameScroll.refreshMask()},ItemsConsumeFunPanel.prototype.setHandler=function(t){this.confirmHandler=t},ItemsConsumeFunPanel.prototype.setTextInfo=function(t,e,i){this.title.text="[b]"+t+"[/b]",this.materialTitle.text=e,this.materialLine.x=this.materialTitle.x-.5*this.materialTitle.width-6*this.dpr-.5*this.materialLine.width,this.materialLine2.x=this.materialTitle.x+.5*this.materialTitle.width+6*this.dpr+.5*this.materialLine2.width,this.havebutton&&void 0!==i&&this.confirmBtn.setText(i)},ItemsConsumeFunPanel.prototype.setItemDatas=function(t){this.gameScroll.visible=!0,this.gameScroll.clearItems(!1);for(var e=0,i=this.materialItems;e<i.length;e++){(a=i[e]).visible=!1}this.isEnough=!0;for(var n=0;n<t.length;n++){var a=void 0,s=t[n];n<this.materialItems.length?a=this.materialItems[n]:(a=new d(this.scene,this.dpr),this.materialItems.push(a)),a.visible=!0,a.setItemData(s),this.gameScroll.addItem(a),s.neededCount>s.count&&(this.isEnough=!1)}this.gameScroll.Sort()},ItemsConsumeFunPanel.prototype.setContent=function(t){this.contentTitle.visible=!0,this.contentTitle.text=t,this.gameScroll.visible=!1},ItemsConsumeFunPanel.prototype.create=function(){var t=this,e=this.scene.make.image({key:l.c.common2Key,frame:"bg_universal_box"});e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add(e),this.setSize(e.width,e.height),this.title=new s.BBCodeText(this.scene,0,.5*-this.height+22*this.dpr,"",{color:"#996600",fontSize:14*this.dpr,fontFamily:h.Font.DEFULT_FONT,stroke:"#996600",strokeThickness:3*this.dpr}).setOrigin(.5),this.add(this.title),this.closeBtn=new s.Button(this.scene,l.c.commonKey,"close","close"),this.closeBtn.setPosition(.5*this.width-5*this.dpr,.5*-this.height+5*this.dpr).setScale(1.3),this.closeBtn.on(String(s.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn);var i=this.havebutton?0:20*this.dpr;this.materialTitle=this.scene.make.text({x:0,y:.5*-this.height+50*this.dpr+i,text:"",bold:!0,style:{color:"#263FCB",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(.5),this.materialLine=this.scene.make.image({x:-10*this.dpr,y:this.materialTitle.y,key:l.c.common2Key,frame:"line_left"}),this.materialLine.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.materialLine2=this.scene.make.image({x:10*this.dpr,y:this.materialTitle.y,key:l.c.common2Key,frame:"line_right"}),this.materialLine2.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add([this.materialTitle,this.materialLine,this.materialLine2]),this.gameScroll=new s.GameScroller(this.scene,{x:0,y:-7*this.dpr+i,width:this.width-40*this.dpr,height:90*this.dpr,zoom:this.zoom,align:2,orientation:1,dpr:this.dpr,space:12*this.dpr,cellupCallBack:function(e){t.onMaterialItemHandler(e)}}),this.add(this.gameScroll),this.contentTitle=this.scene.make.text({x:0,y:-10*this.dpr+i,text:"",style:{color:"#FFC51A",fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5),this.add(this.contentTitle),this.contentTitle.visible=!1,this.havebutton&&(this.confirmBtn=new s.NineSliceButton(this.scene,0,0,106*this.dpr,40*this.dpr,l.c.commonKey,"yellow_btn",h.i18n.t("common.confirm"),this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.confirmBtn.y=.5*this.height-.5*this.confirmBtn.height-13*this.dpr,this.confirmBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.confirmBtn.on(String(s.ClickEvent.Tap),this.onConfirmHandler,this),this.add(this.confirmBtn));var n=145*this.dpr,a=55*this.dpr;this.itemtips=new o.ItemInfoTips(this.scene,n,a,l.c.common2Key,"tips_bg",this.dpr,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.itemtips.x=.5*-this.width+.5*n+10*this.dpr,this.itemtips.y=.5*-this.height+70*this.dpr,this.itemtips.setVisible(!1),this.add(this.itemtips)},ItemsConsumeFunPanel.prototype.onConfirmHandler=function(){this.onCloseHandler(),this.confirmHandler&&this.isEnough&&this.confirmHandler.run()},ItemsConsumeFunPanel.prototype.onCloseHandler=function(){this.visible=!1,this.gameScroll.clearItems(!1),this.gameScroll.visible=!1,this.contentTitle.visible=!1,this.itemtips.setVisible(!1),this.curSelectItem&&(this.curSelectItem.select=!1,this.curSelectItem=void 0),this.parentContainer&&this.parentContainer.remove(this)},ItemsConsumeFunPanel.prototype.onMaterialItemHandler=function(t){this.itemtips.setVisible(!1),this.curSelectItem&&this.curSelectItem!==t&&(this.curSelectItem.select=!1),t.select=!t.select,t.select&&(this.itemtips.setItemData(t.itemData),this.itemtips.setVisible(!0)),this.curSelectItem=t,this.setTipsPosition(t)},ItemsConsumeFunPanel.prototype.setTipsPosition=function(t){for(var e=t.x,i=t.y,n=t;n.parentContainer!==this;)e+=n.parentContainer.x,i+=n.parentContainer.y,n=n.parentContainer;e-.5*this.itemtips.width<.5*-this.width?this.itemtips.x=.5*this.itemtips.width-.5*this.width:e+.5*this.itemtips.width>.5*this.width?this.itemtips.x=.5*this.width-.5*this.itemtips.width:this.itemtips.x=e,this.itemtips.y=i-.5*this.itemtips.height+5*this.dpr},ItemsConsumeFunPanel}(Phaser.GameObjects.Container),d=function(t){function MaterialItem(e,i){var n=t.call(this,e)||this;return n.mselect=!1,n.dpr=i,n.bg=n.scene.make.image({key:l.c.common2Key,frame:"material_unchecked"}),n.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),n.itemIcon=new a.DynamicImage(e,0,0),n.itemCount=new s.BBCodeText(n.scene,0,15*i,"10/20",{color:"#000000"}).setOrigin(.5).setFontSize(11*i).setFontFamily(h.Font.DEFULT_FONT),n.add([n.bg,n.itemIcon,n.itemCount]),n.setSize(n.bg.width,n.bg.height),n.itemCount.y=.5*n.height+8*i,n}return c(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var i=h.Url.getOsdRes(t.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.scale=e.dpr,e.itemIcon.setPosition(0,0)}))},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.mselect=t,this.bg.setFrame(t?"material_checked":"material_unchecked")},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#000000":"#ff0000";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]/"+e},MaterialItem}(Phaser.GameObjects.Container)},function(t,e){},function(t,e){},function(t,e,i){"use strict";i.r(e),i.d(e,"IconSelectBtn",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function IconSelectBtn(e,i,n,a,s){void 0===s&&(s=28/43);var o=t.call(this,e)||this;return o.mScene=e,o.mRender=i,o.mBtnBg=e.make.image(void 0,!1),o.mBgTexture=a,o.mBgResKey=n,o.mBtnBg.setTexture(n,a[0]),o.mBtnBg.scaleX=o.mBtnBg.scaleY=s,o.addAt(o.mBtnBg,0),o.setSize(o.mBtnBg.width,o.mBtnBg.height),o.setInteractive(),o.on("pointerup",o.upHandler,o),o.on("pointerdown",o.downHandler,o),o.on("pointerover",o.overHandler,o),o.on("pointerout",o.outHandler,o),o}return s(IconSelectBtn,t),IconSelectBtn.prototype.setPos=function(t,e){this.mBasePos||(this.mBasePos=new a.Pos),this.mBasePos.x=t,this.mBasePos.y=e},IconSelectBtn.prototype.getPos=function(){return this.mBasePos},IconSelectBtn.prototype.setBtnData=function(t){this.mBtnData=t},IconSelectBtn.prototype.getBtnData=function(){return this.mBtnData},IconSelectBtn.prototype.setClick=function(t){this.monClick=t},IconSelectBtn.prototype.setBgRes=function(t){this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[t]||0)},IconSelectBtn.prototype.destroy=function(){this.mBtnBg&&this.mBtnBg.destroy(!0),this.mBtnIcon&&this.mBtnIcon.destroy(!0),this.monClick=null,this.mBtnBg=null,this.mBtnIcon=null,this.mBtnData=null,this.mScene=null,t.prototype.destroy.call(this)},IconSelectBtn.prototype.overHandler=function(t){},IconSelectBtn.prototype.outHandler=function(t){},IconSelectBtn.prototype.upHandler=function(){this.monClick&&this.monClick()},IconSelectBtn.prototype.downHandler=function(){this.scaleHandler()},IconSelectBtn.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},IconSelectBtn}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"MaterialItem",(function(){return o}));var n,a=i(151),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function MaterialItem(e,i,n,a,s,o){var h=t.call(this,e,i,n,s,o)||this;return h.mselect=!1,h.selectframe=a,h}return s(MaterialItem,t),MaterialItem.prototype.setItemData=function(e,i){void 0===i&&(i=!0),t.prototype.setItemData.call(this,e),this.itemCount.text=i?this.getCountText(e.count,e.neededCount):e.count},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.bg.setFrame(t?this.selectframe:this.bgframe),this.mselect=t},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#000000":"#ff0000";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]/"+e},MaterialItem}(a.PropItem)},function(t,e,i){"use strict";i.r(e),i.d(e,"CommonBackground",(function(){return h}));var n,a=i(21),s=i(61),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CommonBackground(e,i,n,s,o,h,l,c){var p=t.call(this,e,i,n,!1)||this;return p.setSize(s,o),p.key=h||a.d.uicommon,p.bgFrame=l||"online_bg",p.bottomColor=void 0===c?118271:c,p.init(),p.enable=!0,p}return o(CommonBackground,t),CommonBackground.prototype.resize=function(t,e){this.setSize(t,e),this.background.y=.5*-e+.5*this.background.height,this.graphic.clear(),this.graphic.fillStyle(this.bottomColor,1),this.graphic.fillRect(0,0,t,e),this.graphic.x=.5*-t,this.graphic.y=.5*-e},CommonBackground.prototype.init=function(){this.background=this.scene.make.image({key:this.key,frame:this.bgFrame}),this.background.displayWidth=1.2*this.width,this.graphic=this.scene.make.graphics(void 0,!1),this.add([this.graphic,this.background]),this.resize(this.width,this.height)},CommonBackground}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"BackgroundScaleButton",(function(){return h}));var n,a=i(6),s=i(61),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function BackgroundScaleButton(e,i,n,a,s,o,h,l,c,p,d){var u=t.call(this,e,0,0)||this;return u.mDownTime=0,u.dpr=l||1,u.zoom=c||1,u.soundGroup={up:{key:"click"}},void 0===p&&(p=!0),u.mTweenBoo=p,Object.assign(u.soundGroup,d),u.mKey=a,u.mFrame=s,u.mDownFrame=o,u.setSize(i,n),u.createBackground(),h&&(u.mText=u.scene.make.text({color:"#ffffff",fontSize:16*l},!1).setOrigin(.5,.5).setText(h),u.mBackground&&u.mText.setSize(u.mBackground.width,u.mBackground.height),u.add(u.mText)),u.setInteractive(),u.addListen(),u}return o(BackgroundScaleButton,t),Object.defineProperty(BackgroundScaleButton.prototype,"background",{get:function(){return this.mBackground},enumerable:!1,configurable:!0}),Object.defineProperty(BackgroundScaleButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),BackgroundScaleButton.prototype.setEnable=function(t,e){void 0===e&&(e=!0),t?(this.mBackground&&(this.mBackground.clearTint(),this.mText&&this.mText.clearTint()),this.setInteractive()):(this.mBackground&&e&&(this.mBackground.setTintFill(6710886),this.mText&&this.mText.setTintFill(7829367)),this.removeInteractive())},Object.defineProperty(BackgroundScaleButton.prototype,"tweenEnable",{set:function(t){this.mTweenBoo=t},enumerable:!1,configurable:!0}),BackgroundScaleButton.prototype.mute=function(t){this.silent=t},BackgroundScaleButton.prototype.changeNormal=function(){this.setBgFrame(this.mFrame)},BackgroundScaleButton.prototype.changeDown=function(){this.mDownFrame&&this.setBgFrame(this.mDownFrame)},BackgroundScaleButton.prototype.setFrame=function(t){this.setBgFrame(t)},BackgroundScaleButton.prototype.setText=function(t){this.mText&&this.mText.setText(t)},BackgroundScaleButton.prototype.setTextStyle=function(t){this.mText&&this.mText.setStyle(t)},BackgroundScaleButton.prototype.setFontStyle=function(t){this.mText&&this.mText.setFontStyle(t)},BackgroundScaleButton.prototype.setTextOffset=function(t,e){this.mText&&this.mText.setPosition(t,e)},BackgroundScaleButton.prototype.setTextColor=function(t){this.mText&&this.mText.setColor(t)},BackgroundScaleButton.prototype.setFrameNormal=function(t,e){return this.mFrame=t,this.mDownFrame=e||t,this.changeNormal(),this},BackgroundScaleButton.prototype.createBackground=function(){this.mFrame&&(this.mBackground=this.scene.make.image({key:this.mKey,frame:this.mFrame}),this.mBackground.displayWidth=this.width,this.mBackground.displayHeight=this.height,this.add(this.mBackground))},BackgroundScaleButton.prototype.setBgFrame=function(t){this.mBackground&&(this.mBackground.setFrame(t),this.mBackground.displayWidth=this.width,this.mBackground.displayHeight=this.height)},BackgroundScaleButton.prototype.EventStateChange=function(t){switch(t){case a.ClickEvent.Up:this.changeNormal();break;case a.ClickEvent.Down:this.changeDown();break;case a.ClickEvent.Tap:case a.ClickEvent.Out:this.changeNormal()}},BackgroundScaleButton}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"ProgressThreeMaskBar",(function(){return h}));var n,a=i(154),s=i(83),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function ProgressThreeMaskBar(e,i,n,a,s,o,h){var l=t.call(this,e,i,n,a,s,o,h)||this;return l.zoom=1,l}return o(ProgressThreeMaskBar,t),ProgressThreeMaskBar.prototype.createBackgroundBar=function(t,e,i,n,a,o){if(o){var h=o.width||this.width,l=o.height||this.height,c=a.correct;this.mBackground=new s.ThreeSlicePath(this.scene,0,-2*this.dpr,h,l,t,e,1,1,c),this.setSize(h,l)}else this.mBackground=this.scene.make.image({key:t,frame:e}),this.setSize(this.mBackground.width,this.mBackground.height);if(a){var p=a.width||this.width,d=a.height||this.height;c=a.correct;this.mBar=new s.ThreeSlicePath(this.scene,0,-2*this.dpr,p,d,t,i,1,1,c)}else this.mBar=this.scene.make.image({key:t,frame:i});n&&(this.mText=this.scene.make.text({style:n},!1))},ProgressThreeMaskBar}(a.ProgressMaskBar)},function(t,e,i){"use strict";i.r(e),i.d(e,"ProgressThreeBar",(function(){return h}));var n,a=i(6),s=i(28),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function ProgressThreeBar(e,i,n,a,s,o,h){var l=t.call(this,e)||this;return l.value=0,l.max=1,l.zoom=1,l.createBackgroundBar(i,n,a,s,o,h),l.add([l.mBackground,l.mBar]),l.mText&&l.add(l.mText),l.disInteractive(),l}return o(ProgressThreeBar,t),ProgressThreeBar.prototype.setProgress=function(t,e){var i=t/e;i>1?i=1:i<0&&(i=0),this.value=i,this.max=e;var n=this.width*this.zoom*this.value;this.bar.resize(n,this.height),this.bar.x=.5*-this.width+.5*n},ProgressThreeBar.prototype.setText=function(t){this.mText&&(this.mText.text=t,this.mText.parentContainer||this.add(this.mText))},Object.defineProperty(ProgressThreeBar.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),Object.defineProperty(ProgressThreeBar.prototype,"bar",{get:function(){return this.mBar},enumerable:!1,configurable:!0}),ProgressThreeBar.prototype.createBackgroundBar=function(t,e,i,n,a,o){if(o){var h=o.width||this.width,l=o.height||this.height,c=a.correct;this.mBackground=new s.ThreeSlicePath(this.scene,0,-2*this.dpr,h,l,t,e,1,1,c),this.setSize(h,l)}else this.mBackground=this.scene.make.image({key:t,frame:e}),this.setSize(this.mBackground.width,this.mBackground.height);if(a){var p=a.width||this.width,d=a.height||this.height;c=a.correct;this.mBar=new s.ThreeSlicePath(this.scene,0,-2*this.dpr,p,d,t,i,1,1,c)}else this.mBar=this.scene.make.image({key:t,frame:i});n&&(this.mText=this.scene.make.text({style:n},!1))},ProgressThreeBar}(a.BaseUI)},function(t,e,i){"use strict";i.r(e),i.d(e,"ToggleColorButton",(function(){return l}));var n,a=i(6),s=i(2),o=i(61),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function ToggleColorButton(e,i,n,a,o){var h=t.call(this,e,0,0)||this;return h.normalColor="#FFFFFF",h.changeColor="#0099cc",h.mIsOn=!1,h.setSize(i,n),h.mText=h.scene.make.text({text:o,style:s.UIHelper.whiteStyle(a,15)},!1).setOrigin(.5,.5),h.add(h.mText),h.enable=!0,h}return h(ToggleColorButton,t),ToggleColorButton.prototype.setText=function(t){this.mText.text=t},ToggleColorButton.prototype.setFontSize=function(t){this.mText.setFontSize(t)},ToggleColorButton.prototype.setFontStyle=function(t){this.mText.setFontStyle(t)},ToggleColorButton.prototype.setStyle=function(t){this.mText.setStyle(t)},ToggleColorButton.prototype.setNormalColor=function(t){this.normalColor=t},ToggleColorButton.prototype.setChangeColor=function(t){this.changeColor=t},Object.defineProperty(ToggleColorButton.prototype,"isOn",{get:function(){return this.mIsOn},set:function(t){this.mIsOn=t,this.mIsOn?this.changeDown():this.changeNormal()},enumerable:!1,configurable:!0}),ToggleColorButton.prototype.changeDown=function(){this.mText.setFill(this.changeColor)},ToggleColorButton.prototype.changeNormal=function(){this.mText.setFill(this.normalColor)},Object.defineProperty(ToggleColorButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),ToggleColorButton.prototype.EventStateChange=function(t){switch(t){case a.ClickEvent.Up:this.changeNormal();break;case a.ClickEvent.Down:this.changeDown();break;case a.ClickEvent.Tap:this.isOn=!0,this.changeDown();break;case a.ClickEvent.Out:this.isOn?this.changeDown():this.changeNormal()}},ToggleColorButton}(o.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"ToggleButton",(function(){return l}));var n,a=i(6),s=i(2),o=i(61),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function ToggleButton(e,i,n,a,o,h,l,c){var p=t.call(this,e,0,0)||this;return p.normalColor="#FFFFFF",p.changeColor="#0099cc",p.mIsOn=!1,p.mBackground=p.scene.make.image({key:a,frame:o}),p.mText=p.scene.make.text({text:c,style:s.UIHelper.whiteStyle(l,15)},!1).setOrigin(.5,.5),p.add([p.mBackground,p.mText]),p.mNormal=o,p.mDown=h,p.width=i>p.mBackground.width?i:p.mBackground.width,p.height=n>p.mBackground.height?n:p.mBackground.height,p.enable=!0,p}return h(ToggleButton,t),ToggleButton.prototype.setText=function(t){this.mText.text=t},ToggleButton.prototype.setFontSize=function(t){this.mText.setFontSize(t)},ToggleButton.prototype.setFontStyle=function(t){this.mText.setFontStyle(t)},ToggleButton.prototype.setStyle=function(t){this.mText.setStyle(t)},ToggleButton.prototype.setNormalColor=function(t){this.normalColor=t,this.isOn=this.mIsOn},ToggleButton.prototype.setChangeColor=function(t){this.changeColor=t,this.isOn=this.mIsOn},ToggleButton.prototype.setNormalFrame=function(t,e){t&&(this.mNormal=t),e&&(this.mDown=e),this.isOn=this.mIsOn},Object.defineProperty(ToggleButton.prototype,"isOn",{get:function(){return this.mIsOn},set:function(t){this.mIsOn=t,this.mIsOn?this.changeDown():this.changeNormal()},enumerable:!1,configurable:!0}),ToggleButton.prototype.changeDown=function(){this.mText.setFill(this.changeColor),this.mBackground.setFrame(this.mDown)},ToggleButton.prototype.changeNormal=function(){this.mText.setFill(this.normalColor),this.mBackground.setFrame(this.mNormal)},Object.defineProperty(ToggleButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),ToggleButton.prototype.EventStateChange=function(t){switch(t){case a.ClickEvent.Up:this.changeNormal();break;case a.ClickEvent.Down:this.changeDown();break;case a.ClickEvent.Tap:this.isOn=!0;break;case a.ClickEvent.Out:this.isOn?this.changeDown():this.changeNormal()}},ToggleButton}(o.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"MoreButtonPanel",(function(){return c}));var n,a=i(6),s=i(21),o=i(2),h=i(28),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function MoreButtonPanel(e,i,n,a){var s=t.call(this,e)||this;return s.dpr=a,s.setSize(i,n),s.init(),s}return l(MoreButtonPanel,t),MoreButtonPanel.prototype.setItemData=function(t,e){this.itemdata=t,this.setLayoutType(e)},MoreButtonPanel.prototype.setLayoutType=function(t){this.place.visible=!1,this.sell.visible=!1,this.removeListen(),1===t||5===t?(this.place.visible=!0,this.place.y=.5*this.height-.5*this.place.height,this.topbg.y=this.place.y-.5*this.place.height-.5*this.topbg.height,this.place.on(a.ClickEvent.Tap,this.onPlaceHandler,this)):3===t&&(this.sell.visible=!0,this.sell.y=.5*this.height-.5*this.sell.height,this.topbg.y=this.sell.y-.5*this.sell.height-.5*this.topbg.height,this.sell.on(a.ClickEvent.Tap,this.onSellHandler,this)),this.on("pointerdown",this.hide,this)},MoreButtonPanel.prototype.setHandler=function(t){this.send=t},MoreButtonPanel.prototype.show=function(){this.addListen(),this.visible=!0},MoreButtonPanel.prototype.hide=function(){this.removeListen(),this.visible=!1},MoreButtonPanel.prototype.addListen=function(){},MoreButtonPanel.prototype.removeListen=function(){this.place.off(a.ClickEvent.Tap,this.onPlaceHandler,this),this.sell.off(a.ClickEvent.Tap,this.onSellHandler,this),this.off("pointerdown",this.hide,this)},MoreButtonPanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,this.width,this.height),this.blackGraphic.x=.5*-this.width,this.blackGraphic.y=.5*-this.height,this.topbg=new h.ThreeSlicePath(this.scene,0,0,327*this.dpr,10*this.dpr,s.d.uicommon,["bag_more_left","bag_more_middle","bag_more_right"]),this.place=new h.BackgroundScaleButton(this.scene,327*this.dpr,53*this.dpr,s.d.uicommon,"bag_more_uncheck","bag_more_select",o.i18n.t("furni_bag.add"),this.dpr,1,!1),this.place.setTextStyle(o.UIHelper.blackStyle(this.dpr,20)),this.sell=new h.BackgroundScaleButton(this.scene,327*this.dpr,53*this.dpr,s.d.uicommon,"bag_more_uncheck","bag_more_select",o.i18n.t("common.sold"),this.dpr,1,!1),this.sell.setTextStyle(o.UIHelper.blackStyle(this.dpr,20)),this.add([this.blackGraphic,this.topbg,this.place,this.sell]),this.setInteractive()},MoreButtonPanel.prototype.onPlaceHandler=function(){this.send&&this.send.runWith(["place",this.itemdata]),this.hide()},MoreButtonPanel.prototype.onSellHandler=function(){this.send&&this.send.runWith(["sell",this.itemdata]),this.hide()},MoreButtonPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"TextureSprite",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function TextureSprite(e,i,n,a,s){var o=t.call(this,e)||this;return o.isPlaying=!1,o.indexed=0,o.dpr=i,o.auto=n||!1,o.setAniData(s,a),o}return s(TextureSprite,t),TextureSprite.prototype.load=function(t,e,i){if(this.scene){this.compl=e,this.error=i,this.mUrls=t,this.loadUrls=[],this.errorUrls=[];for(var n=0,s=this.mUrls;n<s.length;n++){var o=s[n];this.scene.textures.exists(o)||(this.scene.load.image(o),this.loadUrls.push(o))}this.loadUrls.length>0?(this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start()):this.onLoadComplete()}else a.Logger.getInstance().fatal("Create failed does not exist")},TextureSprite.prototype.setAniData=function(t,e){this.times=t||-1,this.timeFrame=e||30,this.tempTimes=this.times},TextureSprite.prototype.play=function(t){var e=this;if(t)this.timerID&&clearTimeout(this.timerID),this.indexed=0,this.tempTimes=this.times;else if(this.isPlaying)return;var excute=function(){e.frameImg.setTexture(e.mUrls[e.indexed]),e.indexed++,e.indexed===e.mUrls.length&&(e.indexed=0,e.times>0&&(e.tempTimes--,0===e.tempTimes))?e.playEnd():e.timerID=setTimeout((function(){excute()}),e.timeFrame)};excute()},TextureSprite.prototype.stop=function(){this.isPlaying&&(clearTimeout(this.timerID),this.playEnd())},TextureSprite.prototype.destroy=function(e){void 0===e&&(e=!1),this.compl=void 0,this.error=void 0,this.mUrls=void 0,this.loadUrls=void 0,this.errorUrls=void 0,this.scene&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this)),t.prototype.destroy.call(this,e)},Object.defineProperty(TextureSprite.prototype,"playing",{get:function(){return this.isPlaying},enumerable:!1,configurable:!0}),TextureSprite.prototype.playEnd=function(){this.isPlaying=!1,this.tempTimes=this.times,this.timerID=void 0,this.indexed=0,this.frameImg.setTexture(this.mUrls[this.indexed])},TextureSprite.prototype.onLoadComplete=function(t){var e=this.loadUrls.indexOf(t);-1!==e&&(this.loadUrls.splice(e,1),0===this.loadUrls.length&&(this.auto&&this.play(),this.compl&&(this.compl.run(),this.compl=void 0),this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this)))},TextureSprite.prototype.onLoadError=function(t){var e=this.loadUrls.indexOf(t.url);-1!==e&&(this.loadUrls.splice(e,1),this.errorUrls.push(t.url),0===this.loadUrls.length&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.error&&(this.error.runWith(this.errorUrls),this.error=void 0)))},TextureSprite}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"InputField",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function InputField(e,i,n,a,s,o){var h=t.call(this,e,i,n,a,s,o)||this;return h.node.addEventListener("keypress",h.onKeypressHandler.bind(h)),h}return s(InputField,t),InputField.prototype.destroy=function(){this.node&&this.node.removeEventListener("keypress",this.onKeypressHandler.bind(this)),t.prototype.destroy.call(this)},InputField.prototype.onKeypressHandler=function(t){13===(t.keyCode||t.which)&&this.emit("enter",this.text)},InputField}(a.InputText)},function(t,e,i){"use strict";i.r(e),i.d(e,"UiManager",(function(){return h}));var n=i(2),a=i(60),s=i(0),o=i(28),h=function(){function UiManager(t){this.mRender=t,this.mCache=[],this.mRemoteCache=new Map,this.mPanelClass={BaseMediator:a.BasePanel}}return UiManager.prototype.setScene=function(t){var e=this;if(this.mScene=t,t){if(this.mCache){for(var i=0,n=this.mCache;i<n.length;i++){var a=n[i];this.showPanel(a.name,a.param)}this.mCache.length=0}this.mRemoteCache.size>0&&this.mRemoteCache.forEach((function(t,i){t.resolver.resolve(e._showPanel(i,t.param))})),this.mRemoteCache.clear()}},UiManager.prototype.resize=function(t,e){this.mPanelMap&&this.mPanelMap.forEach((function(t){t.isShow()&&t.resize()}))},UiManager.prototype.createPanel=function(t){if(this.mPanelClass.hasOwnProperty(t)){var e=new this.mPanelClass[t](this.mScene,this.mRender);return this.setPanel(t,e),e}n.Logger.getInstance().error("mediatorName error: ",t)},UiManager.prototype.setPanel=function(t,e){this.mPanelMap.set(t,e)},UiManager.prototype.getPanel=function(t){if(this.mPanelMap)return this.mPanelMap.get(t)},UiManager.prototype.clearPanel=function(){this.mPanelMap&&(this.mPanelMap.forEach((function(t){t.destroy(),t=null})),this.mPanelMap.clear(),this.mPanelMap=null)},UiManager.prototype.showAlertView=function(t,e,i,n){if(void 0===i&&(i=!1),this.mScene)new o.AlertView(this).show({text:t,callback:function(){n&&n()},btns:o.Buttons.Ok})},UiManager.prototype.destroy=function(){this.clearPanel(),this.clearCache(),this.mScene=void 0},UiManager.prototype.showPanel=function(t,e){var i=this;this.render.sceneManager.currentScene;if(this.mScene)return new Promise((function(n,a){n(i._showPanel(t,e))}));if(this.mScene=this.render.game.scene.getScene(s.SceneName.MAINUI_SCENE),this.mScene)return new Promise((function(n,a){n(i._showPanel(t,e))}));var a=new n.ValueResolver;return this.mRemoteCache.set(t,{resolver:a,param:e}),a.promise((function(){}))},UiManager.prototype.hidePanel=function(t){if(this.mPanelMap){var e=t+"Panel",i=this.mPanelMap.get(e);i?i.hide():n.Logger.getInstance().error("error "+t+" no panel can show!!!")}},UiManager.prototype.updateUIState=function(t,e){if(this.mPanelMap){var i=this.mPanelMap.get(t);i&&i.updateUIState(e)}},UiManager.prototype.getPanelClass=function(t){var e=t+"Panel";return i(436)("./"+t+"/"+e)},Object.defineProperty(UiManager.prototype,"scene",{get:function(){return this.mScene},enumerable:!1,configurable:!0}),Object.defineProperty(UiManager.prototype,"render",{get:function(){return this.mRender},enumerable:!1,configurable:!0}),UiManager.prototype.clearCache=function(){this.mCache=[]},UiManager.prototype._showPanel=function(t,e){this.mPanelMap||(this.mPanelMap=new Map);var a=t+"Panel",s=new(i(436)("./"+t+"/"+a)[a])(this);if(s)return this.mPanelMap.set(t,s),s.show(e),s;n.Logger.getInstance().error("error "+t+" no panel can show!!!")},UiManager}()},function(t,e){},function(t,e){},function(t,e){},function(t,e,i){"use strict";i.r(e),i.d(e,"BagPanel",(function(){return d}));var n,a=i(85),s=i(53),o=i(6),h=i(28),l=i(2),c=i(0),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function BagPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mPageNum=0,i.mPageIndex=1,i.mBaseStr="输入关键字进行搜索",i.bagSlotList=[],i.mCheckList=[],i}return p(BagPanel,t),BagPanel.prototype.resize=function(t,e){var i=this.mWorld.getSize();this.mWorld.game.device.os.desktop||this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.x=i.width>>1,this.y=i.height>>1):(this.x=i.width>>1,this.y=i.height-this.height/2*this.mWorld.uiScale>>1)},BagPanel.prototype.setDataList=function(t){var e=t;this.mPageNum=Math.ceil(e.length/BagPanel.PageMaxCount),this.mDataList=e,this.mInitialized&&this.checkChinese()},BagPanel.prototype.getPageNum=function(){return this.mPageNum},BagPanel.prototype.destroy=function(){this.bagSlotList&&(this.bagSlotList.forEach((function(t){t&&t.destroy()})),this.bagSlotList.length=0,this.bagSlotList=null),this.mWorld=null,this.mPageNum=0,this.mPageIndex=1,t.prototype.destroy.call(this)},BagPanel.prototype.getCurPageIndex=function(){return this.mPageIndex},BagPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&(this.mPreBtn.play("slipBtn"),this.mNextBtn.play("slipBtn"))},BagPanel.prototype.setBlur=function(){this.mInputText&&this.mInputText.setBlur()},BagPanel.prototype.addListen=function(){this.mInitialized&&(this.mInputText.on("focus",this.onFocusHandler,this),this.mInputText.on("blur",this.onBlurHandler,this),this.mNextBtn.on("pointerup",this.nextHandler,this),this.mPreBtn.on("pointerup",this.preHandler,this),this.mClsBtn.on("pointerup",this.closeHandler,this))},BagPanel.prototype.removeListen=function(){this.mInitialized&&(this.mInputText.off("focus",this.onFocusHandler,this),this.mInputText.off("blur",this.onBlurHandler,this),this.mNextBtn.off("pointerup",this.nextHandler,this),this.mPreBtn.off("pointerup",this.preHandler,this),this.mClsBtn.off("pointerup",this.closeHandler,this))},BagPanel.prototype.init=function(){if(!this.mInitialized){var e,i=this.mWorld.getSize();this.mWorld.game.device.os.desktop||this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.x=i.width>>1,this.y=i.height>>1):(this.x=i.width>>1,this.y=i.height-this.height/2*this.mWorld.uiScale>>1);var n=0,c=0;this.mBg=new s.NinePatch(this.scene,0,0,500,350,l.Background.getName(),null,l.Background.getConfig()),this.addAt(this.mBg,0),this.setSize(this.mBg.width,this.mBg.height),this.mBorder=new s.NinePatch(this.scene,0,0,this.mBg.width-10,this.mBg.height-30,l.Border.getName(),null,l.Border.getConfig()),this.mBorder.x=this.mBg.x,this.mBorder.y=this.mBg.y+10,this.addAt(this.mBorder,1);var p=new s.NinePatch(this.scene,this.mBorder.width/4+5,-this.mBg.height/2+65,this.mBorder.width/2-40,35,l.Border.getName(),null,l.Border.getConfig());this.add(p),this.mInputText=new o.InputText(this.scene,0,0,10,10,{type:"input",fontSize:"14px",color:"#808080"}).resize(p.width,p.height).setOrigin(0,0).setStyle({font:"bold 16px YaHei"}),this.mInputText.x=p.x-p.width/2,this.mInputText.y=p.y-p.height/2,this.mInputText.setText(this.mBaseStr),this.add(this.mInputText),this.bagSlotList=[];for(var d=0;d<BagPanel.PageMaxCount;d++)n=d%8*60-210,c=60*Math.floor(d/8)-this.mBorder.height/2+this.mBorder.y+this.mBorder.height/2-55,(e=new a.ItemSlot(this.scene,this.mWorld,this,n,c,this.mResStr,this.mResPng,this.mResJson,"bagView_slot.png","itemSelectFrame")).createUI(),this.bagSlotList.push(e);this.mPreBtn=this.scene.make.sprite(void 0,!1),this.mPreBtn.x=-this.mBg.width>>1,this.mNextBtn=this.scene.make.sprite(void 0,!1),this.mNextBtn.scaleX=-1,this.mNextBtn.x=this.mBg.width>>1;var u=this.scene.make.sprite(void 0,!1);u.setTexture(this.mResStr,"bagView_titleBtn.png"),u.x=50+(-this.mBg.width>>1),u.y=-this.mBg.height>>1,this.add(u);var m=this.scene.make.text(void 0,!1);m.setFontFamily("Tahoma"),m.setFontStyle("bold"),m.setFontSize(20),m.setText("背包"),m.x=u.x+u.width-10,m.y=u.y-(m.height>>1),this.add(m),this.add(this.mPreBtn),this.add(this.mNextBtn),this.mNextBtn.setInteractive(),this.mPreBtn.setInteractive(),this.width=this.mBg.width,this.height=this.mBg.height,this.mClsBtn=new h.IconBtn(this.scene,this.mWorld,{key:"Close_Btn",bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:this.mResPng,jsonUrl:this.mResJson}),this.mClsBtn.x=(this.width>>1)-65,this.mClsBtn.y=-this.height>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn),this.mInitialized=!0,this.mDataList&&this.refreshDataList(this.mDataList),this.setInteractive(),t.prototype.init.call(this)}},BagPanel.prototype.preload=function(){this.scene&&(this.mResStr="bagView",this.mResPng="ui/bag/bagView.png",this.mResJson="ui/bag/bagView.json",this.scene.load.atlas("itemChose",l.Url.getRes("ui/bag/itemChose.png"),l.Url.getRes("ui/bag/itemChose.json")),this.scene.load.atlas("slip",l.Url.getRes("ui/bag/slip.png"),l.Url.getRes("ui/bag/slip.json")),this.scene.load.image(l.Border.getName(),l.Border.getPNG()),this.scene.load.image(l.Background.getName(),l.Background.getPNG()),this.scene.load.atlas("clsBtn",l.Url.getRes("ui/common/common_clsBtn.png"),l.Url.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas(this.mResStr,l.Url.getRes(this.mResPng),l.Url.getRes(this.mResJson)),t.prototype.preload.call(this))},BagPanel.prototype.loadComplete=function(e,i,n){var a=this.scene.textures.get("itemChose").frames,s=[];for(var o in a){if("__BASE"!==o)a[o]&&s.push(o)}this.scene.anims.create({key:"itemSelectFrame",frames:this.scene.anims.generateFrameNumbers("itemChose",{start:0,end:8,frames:s}),frameRate:33,yoyo:!0,repeat:-1});var h=this.scene.textures.get("slip").frames,l=[];for(var o in h){if("__BASE"!==o)h[o]&&l.push(o)}this.scene.anims.create({key:"slipBtn",frames:this.scene.anims.generateFrameNumbers("slip",{start:0,end:14,frames:l}),frameRate:33,yoyo:!0,repeat:-1}),t.prototype.loadComplete.call(this,e,i,n)},BagPanel.prototype.tweenComplete=function(e){t.prototype.tweenComplete.call(this,e)},BagPanel.prototype.nextHandler=function(t,e){if(this.preNextBtnScaleHandler(this.mNextBtn,-1),!(this.mPageIndex>=this.mPageNum)){this.mPageIndex++;var i=this.mCheckList.length>0?this.mCheckList:this.mDataList;this.refreshDataList(i)}},BagPanel.prototype.preHandler=function(t,e){if(this.preNextBtnScaleHandler(this.mPreBtn),!(this.mPageIndex<=1)){this.mPageIndex--;var i=this.mCheckList.length>0?this.mCheckList:this.mDataList;this.refreshDataList(i)}},BagPanel.prototype.preNextBtnScaleHandler=function(t,e){void 0===e&&(e=1),this.scene.tweens.add({targets:t,duration:50,ease:"Linear",props:{scaleX:{value:.5*e},scaleY:{value:.5}},yoyo:!0,repeat:0}),t.scaleX=e,t.scaleY=1},BagPanel.prototype.refreshDataList=function(t){if(t)for(var e,i=t.slice((this.mPageIndex-1)*BagPanel.PageMaxCount,this.mPageIndex*BagPanel.PageMaxCount),n=BagPanel.PageMaxCount,a=0;a<n;a++)(e=this.bagSlotList[a])&&e.dataChange(i[a]);else l.Logger.getInstance().error("checkItemList is undefiend")},BagPanel.prototype.closeHandler=function(){this.render.renderEmitter(c.ModuleName.BAG_NAME+"_close")},BagPanel.prototype.onFocusHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mInputText&&(this.mInputText.on("textchange",this.checkChinese,this),this.mInputText.setText(""))},BagPanel.prototype.onBlurHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mInputText&&(this.mInputText.on("textchange",this.checkChinese,this),this.mInputText.setText(this.mBaseStr))},BagPanel.prototype.checkChinese=function(){var t=this,e=this.mInputText.text;e.length<1||!l.Tool.checkChinese(e)||e===this.mBaseStr?this.refreshDataList(this.mDataList):(this.mDataList.forEach((function(e){e&&l.Tool.checkItemName(e.name,t.mInputText.text)&&t.mCheckList.push(e)})),this.refreshDataList(this.mCheckList))},BagPanel.PageMaxCount=32,BagPanel}(h.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"StoragePanel",(function(){return p}));var n,a=i(0),s=i(2),o=i(28),h=i(85),l=i(53),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function StoragePanel(e){return t.call(this,e.scene,e.render)||this}return c(StoragePanel,t),StoragePanel.prototype.resize=function(t,e){var i=this.mWorld.getSize();this.x=i.width+t>>1,this.y=i.height+e-200},StoragePanel.prototype.destroy=function(){if(this.mBagItemSlotList){for(var e=this.mBagItemSlotList.length,i=0;i<e;i++){var n=this.mBagItemSlotList[i];n&&(n.destroy(),n=null)}this.mBagItemSlotList=null}this.mWorld=null,t.prototype.destroy.call(this)},StoragePanel.prototype.addListen=function(){this.mClsBtn.on("pointerup",this.hide,this)},StoragePanel.prototype.removeListen=function(){this.mClsBtn.off("pointerup",this.hide,this)},StoragePanel.prototype.init=function(){if(!this.mInitialized){t.prototype.init.call(this),this.mBg=new l.NinePatch(this.scene,0,0,500,350,s.Background.getName(),null,s.Background.getConfig()),this.addAt(this.mBg,0),this.setSize(this.mBg.width,this.mBg.height),this.mBorder=new l.NinePatch(this.scene,0,0,this.mBg.width-10,this.mBg.height-30,s.Border.getName(),null,s.Border.getConfig()),this.mBorder.x=this.mBg.x,this.mBorder.y=this.mBg.y+10,this.addAt(this.mBorder,1),this.setSize(this.mBg.width,this.mBg.height);var e=this.scene.make.image(void 0,!1);e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),e.setTexture(this.mResStr,"itemBagView_title.png"),e.x=80+(-this.mBg.width>>1),e.y=-this.mBg.height>>1,this.add(e);var i,n=this.scene.make.text(void 0,!1);n.setFontFamily("Tahoma"),n.setFontStyle("bold"),n.setFontSize(20),n.setText("书柜"),n.x=e.x+e.width-10,n.y=e.y-(n.height>>1),this.add(n);var a=0,c=0;this.mBagItemSlotList=[];for(var p=0;p<9;p++)a=p%9*60+32-362,c=60*Math.floor(p/9)-55,(i=new h.ItemSlot(this.scene,this.mWorld,this,a,c,this.mResStr,this.mResPng,this.mResJson,"bagView_slot.png","bagView_itemSelect.png")).createUI(),this.mBagItemSlotList.push(i);this.mClsBtn=new o.IconBtn(this.scene,this.mWorld,{key:"Close_Btn",bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=(this.width>>1)-65,this.mClsBtn.y=-this.height>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn)}},StoragePanel.prototype.preload=function(){this.scene&&(this.mResStr="bagView",this.mResPng="ui/bag/bagView.png",this.mResJson="ui/bag/bagView.json",this.scene.load.image(s.Border.getName(),s.Border.getPNG()),this.scene.load.image(s.Background.getName(),s.Background.getPNG()),this.scene.load.atlas("clsBtn",s.Url.getRes("ui/common/common_clsBtn.png"),s.Url.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas(this.mResStr,s.Url.getRes(this.mResPng),s.Url.getRes(this.mResJson)),t.prototype.preload.call(this))},StoragePanel.prototype.tweenComplete=function(e){t.prototype.tweenComplete.call(this,e),e&&this.mWorld.uiManager.getMediator(a.ModuleName.STORAGE_NAME).resize()},StoragePanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"RankPanel",(function(){return l}));var n,a=i(0),s=i(153),o=i(333),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function RankPanel(e){var i=t.call(this,e)||this;return i.mCurrentIndex=0,i.key=a.ModuleName.RANK_NAME,i}return h(RankPanel,t),RankPanel.prototype.addListen=function(){this.mInitialized&&(this.render.game.device.os.desktop?this.mZoonInBtn.on("pointerup",this.onZoomHandler,this):this.mClsBtn.on("pointerup",this.closeHandler,this))},RankPanel.prototype.removeListen=function(){this.mInitialized&&(this.render.game.device.os.desktop?this.mZoonInBtn.off("pointerup",this.onZoomHandler,this):this.mClsBtn.off("pointerup",this.closeHandler,this))},RankPanel.prototype.resize=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),this.render){var i=this.render.getSize();this.render.game.device.os.desktop?(this.x=i.width-this.width/2,this.y=this.height/2+10):(this.render.game.scale.orientation,Phaser.Scale.Orientation.LANDSCAPE,this.x=i.width+t>>1,this.y=i.height+e>>1),this.scale=this.render.uiScale}},RankPanel.prototype.tweenView=function(t){if(this.scene){var e=this.height/2+10,i=!0===t?e:e-300,n=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Cubic.Out",props:{y:{value:i},alpha:{value:n}}})}},RankPanel.prototype.destroy=function(){this.mZoonInBtn&&this.mZoonInBtn.destroy(!0),this.mZoonInBtn=null,this.mCurrentIndex=0,t.prototype.destroy.call(this)},RankPanel.prototype.init=function(){t.prototype.init.call(this),this.render.game.device.os.desktop?(this.mZoonInBtn=this.scene.make.image({x:0,y:this.height/2-10,key:"rank_atlas",frame:"arrow.png"},!1),this.add(this.mZoonInBtn),this.mZoonInBtn.setInteractive()):(this.mClsBtn=new s.IconBtn(this.scene,this.render,{key:"Close_Btn",bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=this.width/2-35,this.mClsBtn.y=-this.height/2,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn)),this.resize()},RankPanel.prototype.tweenComplete=function(e){if(t.prototype.tweenComplete.call(this,e),e){var i=this.getData("data");i&&this.addItem(i)}},RankPanel.prototype.closeHandler=function(){this.render.renderEmitter(a.RENDER_PEER+"_"+this.key+"_hide")},RankPanel.prototype.onZoomHandler=function(){this.currentSizeIndex=0===this.mCurrentIndex?1:0},Object.defineProperty(RankPanel.prototype,"currentSizeIndex",{set:function(t){if(this.mCurrentIndex!==t){this.mCurrentIndex=t;var e=1===this.mCurrentIndex?30:this.height,i=1===this.mCurrentIndex?-this.height/2+20:this.height/2-10,n=1===this.mCurrentIndex?-this.height/2+15:0;this.mBackground.resize(328,e),this.mZoonInBtn.angle=1===this.mCurrentIndex?180:0,e>300?this.parentContainer&&this.add(this.mChildContainer):this.remove(this.mChildContainer),this.mBackground.y=n,this.mZoonInBtn.y=i}},enumerable:!1,configurable:!0}),RankPanel}(o.BasicRankPanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"normalizePatchesConfig",(function(){return normalizePatchesConfig}));var normalizePatchesConfig=function(t){return t.bottom=void 0!==t.bottom?t.bottom:t.top,t.left=void 0!==t.left?t.left:t.top,t.right=void 0!==t.right?t.right:t.left,t}},function(t,e,i){"use strict";i.r(e),i.d(e,"BasicRankPanel",(function(){return l}));var n,a=i(2),s=i(60),o=i(53),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function BasicRankPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mTexts=[],i.disInteractive(),i}return h(BasicRankPanel,t),BasicRankPanel.prototype.addItem=function(t){if(this.setData("data",t),this.mInitialized){this.clearText();var e=t.text;if(e&&!(e.length<1)){this.mTitleLabel&&(this.mTitleLabel.setText(e[0].text),this.mTitleLabel.setData("node",e[0].node));for(var i=[-this.width/2+15,-this.width/2+63,-this.width/2+241],n=0,s=1;s<4;s++){n=(o=this.scene.make.text({x:i[s-1],y:-this.height/2+22,text:e?e[s].text:"123",style:{font:a.Font.YAHEI_16_BOLD}},!1)).y,o.setData("node",e[s].node),o.setStroke("#000000",2),this.mChildContainer.add(o),this.mTexts.push(o)}n+=20;for(s=4;s<e.length;s++){var o,h=e[s],l=(s-4)%3,c=22*Math.floor((s-4)/3);(o=this.scene.make.text({x:i[l],y:n+c,text:h?h.text:"123",style:{font:a.Font.YAHEI_14_BOLD}},!1)).setData("node",h.node),o.setStroke("#000000",2),this.mChildContainer.add(o),this.mTexts.push(o)}}}},BasicRankPanel.prototype.tweenView=function(t){},BasicRankPanel.prototype.update=function(t){this.addItem(t)},BasicRankPanel.prototype.destroy=function(){this.mBackground&&this.mBackground.destroy();for(var e=this.mTexts.length,i=0;i<e;i++){var n=this.mTexts[i];n&&(n.destroy(!0),n=null)}this.mTitleLabel&&this.mTitleLabel.destroy(!0),this.mTexts=[],this.mBackground=null,this.mTitleLabel=null,t.prototype.destroy.call(this)},BasicRankPanel.prototype.preload=function(){this.scene.load.image(a.Background.getName(),a.Background.getPNG()),this.scene.load.image(a.Border.getName(),a.Border.getPNG()),this.scene.load.atlas("clsBtn",a.Url.getRes("ui/common/common_clsBtn.png"),a.Url.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas("rank_atlas",a.Url.getRes("ui/rank/rank_atlas.png"),a.Url.getRes("ui/rank/rank_atlas.json")),t.prototype.preload.call(this)},BasicRankPanel.prototype.init=function(){if(!this.mInitialized){this.setSize(328,361),this.mBackground=new o.NinePatch(this.scene,0,0,328,361,a.Background.getName(),null,a.Background.getConfig()),this.add(this.mBackground),this.mChildContainer=this.scene.make.container({},!1),this.add(this.mChildContainer);var e=new o.NinePatch(this.scene,0,0,315,318,a.Border.getName(),null,a.Border.getConfig());this.mChildContainer.add(e);var i=this.scene.make.image({x:-this.width/2+20,y:-this.height/2-12,key:"rank_atlas",frame:"icon.png"},!1).setOrigin(0,0);this.add(i),this.mTitleLabel=this.scene.make.text({x:-this.width/2+54,y:-this.height/2-10,text:"排行榜",style:{font:a.Font.YAHEI_20_BOLD}}).setOrigin(0,0).setStroke("#000000",2),this.add(this.mTitleLabel),t.prototype.init.call(this)}},BasicRankPanel.prototype.clearText=function(){for(var t=0,e=this.mTexts;t<e.length;t++){e[t].destroy()}this.mTexts.length=0},BasicRankPanel}(s.BasePanel)},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n,a,s,o=i(2),h=i(58),l=i.n(h),c=i(15),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function AvatarEditorDragonbone(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.mAutoScale=!0,h.mCurAnimationName="idle",h.mCurDir=3,h.mBaseSets=[],h.mSets=[],h.mParts={},h.mArmatureBottomArea=0,h.mArmatureBottomArea_head=0,h.mWebHomePath=i,h.mEmitter=n,h.mAutoScale=a,e.add.container(0,0).add(h),s&&(h.mSets=s),o&&(h.mOnReadyForSnapshot=o),h.setBaseSets(AvatarEditorDragonbone.DEFAULT_SETS),h.createDisplays(),h}return p(AvatarEditorDragonbone,t),AvatarEditorDragonbone.prototype.destroy=function(){this.removeAll(!0),this.mDisplay_default&&(this.remove(this.mDisplay_default),this.mDisplay_default.destroy(),this.mDisplay_default=null),this.mDisplay_head&&(this.remove(this.mDisplay_head),this.mDisplay_head.destroy(),this.mDisplay_head=null),this.mCurAnimationName=null,this.mCurDir=null,this.mBaseSets&&(this.mBaseSets=[]),this.mBaseSets=null,this.mSets&&(this.mSets=[]),this.mSets=null,this.mParts={},this.mParts=null,t.prototype.destroy.call(this)},AvatarEditorDragonbone.prototype.loadLocalResources=function(t,e,i){var n=this.partTextureSaveKey(e,t.key,i);this.scene.textures.exists(n)&&(this.scene.textures.remove(n),this.scene.textures.removeKey(n)),this.scene.textures.addBase64(n,t.url),this.scene.textures.on("onload",this.onResourcesLoaded,this)},AvatarEditorDragonbone.prototype.setDir=function(t){var e=this.mCurAnimationName.split("_");this.mCurAnimationName=3===t?e[0]:e[0]+"_back",this.mCurDir=t,this.reloadDisplay()},AvatarEditorDragonbone.prototype.play=function(t){this.mCurAnimationName=t,this.mDisplay_default&&this.mDisplay_default.play({name:this.mCurAnimationName,flip:!1})},AvatarEditorDragonbone.prototype.clearParts=function(){this.mSets&&(this.mSets=[]),this.setBaseSets(AvatarEditorDragonbone.DEFAULT_SETS),this.reloadDisplay()},AvatarEditorDragonbone.prototype.mergeParts=function(t){this.addSets(t),this.reloadDisplay()},AvatarEditorDragonbone.prototype.cancelParts=function(t){this.removeSets(t),this.reloadDisplay()},AvatarEditorDragonbone.prototype.generateShopIcon=function(t,e){var i=this;return new Promise((function(n,a){if(0!==t&&0!==e){var s=i.getSnapshotModelData();s.armature?i.snapshot({x:0,y:0,width:t,height:e},s).then((function(t){o.Logger.getInstance().log("shop icon: ",t),n(t)})).catch((function(t){a(t)})):a("no armature")}else a("width and height must not be 0")}))},AvatarEditorDragonbone.prototype.generateHeadIcon=function(){var t=this;return new Promise((function(e,i){if(t.mDisplay_default)if(AvatarEditorDragonbone.HEAD_ICON_DEFAULT_SNAPSHOT_TOTAL_HEIGHT>t.scene.scale.height)i("game size is not enough, must larger than "+AvatarEditorDragonbone.HEAD_ICON_DEFAULT_SNAPSHOT_TOTAL_HEIGHT);else{var n={armature:t.mDisplay_default,x:AvatarEditorDragonbone.HEAD_ICON_WIDTH/2,y:AvatarEditorDragonbone.HEAD_ICON_DEFAULT_BOTTOM_PIX,baseSets:AvatarEditorDragonbone.DEFAULT_SETS};t.snapshot({x:0,y:AvatarEditorDragonbone.HEAD_ICON_DEFAULT_SNAPSHOT_TOTAL_HEIGHT-AvatarEditorDragonbone.HEAD_ICON_HEIGHT,width:AvatarEditorDragonbone.HEAD_ICON_WIDTH,height:AvatarEditorDragonbone.HEAD_ICON_HEIGHT},n).then((function(t){e(t)})).catch((function(t){i(t)}))}else i("no armature")}))},AvatarEditorDragonbone.prototype.onResourcesLoaded=function(){this.scene.textures.off("onload",this.onResourcesLoaded,this,!1),this.reloadDisplay()},Object.defineProperty(AvatarEditorDragonbone.prototype,"curSets",{get:function(){return this.mSets},enumerable:!1,configurable:!0}),AvatarEditorDragonbone.prototype.createDisplays=function(){this.mDisplay_default&&this.mDisplay_default.destroy(),this.mDisplay_head&&this.mDisplay_head.destroy();var t=this.scene.scale.height;this.mArmatureBottomArea=AvatarEditorDragonbone.DEFAULT_SCALE_BOTTOM_PIX*t/AvatarEditorDragonbone.DEFAULT_SCALE_GAME_HEIGHT,this.mDisplay_default=new u(this.scene,AvatarEditorDragonbone.DRAGONBONE_NAME_DEFAULT,this.mWebHomePath),this.mDisplay_default.play({name:this.mCurAnimationName,flip:!1}),this.mAutoScale&&(this.mDisplay_default.scale=t/AvatarEditorDragonbone.DEFAULT_SCALE_GAME_HEIGHT),this.mDisplay_default.x=this.scene.scale.width>>1,this.mDisplay_default.y=this.scene.scale.height-this.mArmatureBottomArea,this.add(this.mDisplay_default),this.mArmatureBottomArea_head=this.mArmatureBottomArea-AvatarEditorDragonbone.ARMATURE_LEG_PERCENT*AvatarEditorDragonbone.ARMATURE_HEIGHT*t/AvatarEditorDragonbone.DEFAULT_SCALE_GAME_HEIGHT,this.mDisplay_head=new u(this.scene,AvatarEditorDragonbone.DRAGONBONE_NAME_HEAD,this.mWebHomePath),this.mAutoScale&&(this.mDisplay_head.scale=t/AvatarEditorDragonbone.DEFAULT_SCALE_GAME_HEIGHT),this.mDisplay_head.x=this.scene.scale.width>>1,this.mDisplay_head.y=this.scene.scale.height-this.mArmatureBottomArea_head+1e3,this.add(this.mDisplay_head),this.reloadDisplay()},AvatarEditorDragonbone.prototype.setBaseSets=function(t){this.mBaseSets&&(this.mBaseSets=[]),this.mBaseSets=t,this.applySets(!0)},AvatarEditorDragonbone.prototype.addSets=function(t){for(var e=[],_loop_1=function(t){if(i.mSets.findIndex((function(e){return e.id===t.id&&JSON.stringify(e.parts)===JSON.stringify(t.parts)}))>=0)return"continue";e.push(Object.assign({},t))},i=this,n=0,a=t;n<a.length;n++){_loop_1(h=a[n])}for(var s=0,o=t=e;s<o.length;s++){var h=o[s];for(var l in AvatarEditorDragonbone.HAIR_BACK)if(AvatarEditorDragonbone.HAIR_BACK.hasOwnProperty(l))for(var c=0,p=h.parts;c<p.length;c++){var d=p[c];d===l&&(this.removePartsInSets(AvatarEditorDragonbone.HAIR_BACK[d],this.mSets),this.removePartsInCurParts(AvatarEditorDragonbone.HAIR_BACK[d]))}}this.mSets=this.mSets.concat(t),this.applySets()},AvatarEditorDragonbone.prototype.applySets=function(t){if(void 0===t&&(t=!1),t){this.mParts={};for(var e=0,i=AvatarEditorDragonbone.ADD_PARTS;e<i.length;e++){var n=i[e];this.mParts[n]=null}for(var a=0,s=this.mBaseSets;a<s.length;a++)for(var o=0,h=(m=s[a]).parts;o<h.length;o++){n=h[o];this.mParts[n]=m}}for(var l=0,c=this.mSets;l<c.length;l++)for(var p=0,d=(m=c[l]).parts;p<d.length;p++){n=d[p];this.mParts[n]=m}for(var u in this.mParts){var m;if((m=this.mParts[u])&&AvatarEditorDragonbone.SPECIAL_SETS.hasOwnProperty(u))for(var f=0,y=AvatarEditorDragonbone.SPECIAL_SETS[u];f<y.length;f++){var g=y[f];this.mParts[g]=null}}},AvatarEditorDragonbone.prototype.removeSets=function(t){for(var _loop_2=function(t){var i=e.mSets.findIndex((function(e){return e.id===t.id}));i>=0&&e.mSets.splice(i,1);for(var n=0,a=["1","3"];n<a.length;n++)for(var s=a[n],o=0,h=t.parts;o<h.length;o++){var l=h[o],c=e.partTextureSaveKey(l,t.id,s,t.version);e.scene.textures.exists(c)&&(e.scene.textures.remove(c),e.scene.textures.removeKey(c))}},e=this,i=0,n=t;i<n.length;i++){_loop_2(n[i])}this.applySets(!0)},AvatarEditorDragonbone.prototype.reloadDisplay=function(){var t=this;return new Promise((function(e,i){var n=t.convertPartsToIDragonbonesModel(t.mParts);t.mDisplay_default.load(n).then((function(){return t.mDisplay_head.load(n)})).then((function(){e(null),t.mOnReadyForSnapshot&&(t.mOnReadyForSnapshot(t),t.mOnReadyForSnapshot=null)})).catch((function(t){t&&o.Logger.getInstance().error("reload display error: ",t)})),t.mDisplay_default.play({name:t.mCurAnimationName,flip:!1})}))},AvatarEditorDragonbone.prototype.partTextureSaveKey=function(t,e,i,n){var a=t+"_"+e+"_"+i;return void 0!==n&&n.length>0&&(a=a+"_"+n),a=o.ResUtils.getPartName(a)},AvatarEditorDragonbone.prototype.removePartsInSets=function(t,e){for(var i=0,n=e;i<n.length;i++)for(var a=n[i],s=0,o=t;s<o.length;s++){var h=o[s],l=a.parts.indexOf(h);l>=0&&a.parts.splice(l,1)}return e},AvatarEditorDragonbone.prototype.removePartsInCurParts=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.mParts.hasOwnProperty(n)&&delete this.mParts[n]}},AvatarEditorDragonbone.prototype.getSnapshotModelData=function(){for(var t=0,e=this.mSets;t<e.length;t++)for(var i=0,n=e[t].parts;i<n.length;i++){var a=n[i];if(AvatarEditorDragonbone.BOTTOM_BODY_PARTS.indexOf(a)>=0)return{armature:this.mDisplay_default,x:this.mDisplay_default.x,y:this.mArmatureBottomArea,baseSets:AvatarEditorDragonbone.MODEL_SETS}}return{armature:this.mDisplay_head,x:this.mDisplay_default.x,y:this.mArmatureBottomArea_head,baseSets:AvatarEditorDragonbone.MODEL_SETS}},AvatarEditorDragonbone.prototype.snapshot=function(t,e){var i=this;return new Promise((function(n,a){i.setBaseSets(e.baseSets),i.reloadDisplay().then((function(){var a=i.scene.scale.width,s=i.scene.scale.height;o.Logger.getInstance().debug("ZW-- start snapshot, gameSize: "+a+"*"+s+", setSize: "+t.width+"*"+t.height);var h=i.scene.make.renderTexture({x:0,y:0,width:a,height:s},!1);e.armature.scaleY*=-1,h.draw(e.armature,e.x,e.y),h.snapshotArea(t.x,t.y,t.width,t.height,(function(t){e.armature.scaleY*=-1,i.setBaseSets(AvatarEditorDragonbone.DEFAULT_SETS),i.reloadDisplay().then((function(){n(t.src),o.Logger.getInstance().debug("ZW-- snapshot result: ",t.src)}))}))})).catch((function(){a("replaceDisplay error")}))}))},AvatarEditorDragonbone.prototype.convertPartsToIDragonbonesModel=function(t){for(var e={id:"0"},i=0,n=[].concat(AvatarEditorDragonbone.BASE_PARTS,AvatarEditorDragonbone.ADD_PARTS);i<n.length;i++){var a=n[i];if(t.hasOwnProperty(a)){var s=t[a];if(s)e[this.convertPartNameToIAvatarKey(a)]={sn:s.id,version:s.version}}}return{id:0,avatar:e}},AvatarEditorDragonbone.prototype.convertPartNameToIAvatarKey=function(t){for(var e=t.split("_"),i=e[0],n=1;n<e.length;n++){var a=e[n];i+=a.charAt(0).toUpperCase()+a.slice(1)}return i+="Id"},AvatarEditorDragonbone.DRAGONBONE_NAME_DEFAULT="bones_human01",AvatarEditorDragonbone.DRAGONBONE_NAME_HEAD="bones_model_head",AvatarEditorDragonbone.DRAGONBONE_ARMATURE_NAME="Armature",AvatarEditorDragonbone.BASE_PARTS=["body_base","barm_base","farm_base","bleg_base","fleg_base","head_base"],AvatarEditorDragonbone.ADD_PARTS=["barm_cost","barm_spec","bleg_cost","bleg_spec","body_cost","body_cost_dres","body_spec","body_tail","body_wing","farm_cost","farm_spec","fleg_cost","fleg_spec","head_eyes","head_hair","head_mous","head_hair_back","head_hats","head_mask","head_spec","head_face","barm_shld","farm_shld","barm_weap","farm_weap"],AvatarEditorDragonbone.BOTTOM_BODY_PARTS=["body_cost","body_cost_dres","farm_cost","barm_cost","fleg_cost","bleg_cost","barm_weap","farm_weap","barm_shld","farm_shld","body_tail","body_wing","body_spec","farm_spec","barm_spec","fleg_spec","bleg_spec"],AvatarEditorDragonbone.HAIR_BACK=((a={}).head_hair=["head_hair","head_hair_back"],a.body_cost=["body_cost","body_cost_dres"],a),AvatarEditorDragonbone.DEFAULT_SETS=[{id:"0001",parts:AvatarEditorDragonbone.BASE_PARTS},{id:"5cd28238fb073710972a73c2",parts:["head_hair","head_eyes","head_mous","body_cost"]}],AvatarEditorDragonbone.SPECIAL_SETS=((s={}).head_spec=["head_eyes","head_hair","head_mous","head_hair_back","head_hats","head_mask","head_face","head_base"],s.body_spec=["body_cost","body_cost_dres","body_tail","body_wing","body_base"],s.farm_spec=["farm_cost","farm_shld","farm_weap","farm_base"],s.barm_spec=["barm_cost","barm_shld","barm_weap","barm_base"],s.fleg_spec=["fleg_cost","fleg_base"],s.bleg_spec=["bleg_cost","bleg_base"],s),AvatarEditorDragonbone.MODEL_SETS=[{id:"5fbf562e72c7db2dbdcdb4ea",parts:AvatarEditorDragonbone.BASE_PARTS}],AvatarEditorDragonbone.DEFAULT_SCALE_GAME_HEIGHT=72,AvatarEditorDragonbone.DEFAULT_SCALE_BOTTOM_PIX=4,AvatarEditorDragonbone.ARMATURE_HEIGHT=61,AvatarEditorDragonbone.ARMATURE_LEG_PERCENT=.15,AvatarEditorDragonbone.HEAD_ICON_HIDE_PIX=22,AvatarEditorDragonbone.HEAD_ICON_WIDTH=71,AvatarEditorDragonbone.HEAD_ICON_HEIGHT=57,AvatarEditorDragonbone.HEAD_ICON_DEFAULT_SNAPSHOT_TOTAL_HEIGHT=79,AvatarEditorDragonbone.HEAD_ICON_DEFAULT_BOTTOM_PIX=0,AvatarEditorDragonbone}(Phaser.GameObjects.Container),u=function(t){function EditorDragonbonesDisplay(e,i,n){var a=t.call(this,e)||this;return a.mWebHomePath=n,a.resourceName=i,a.isRenderTexture=!0,a}return p(EditorDragonbonesDisplay,t),EditorDragonbonesDisplay.prototype.generateReplaceTextureKey=function(){return t.prototype.generateReplaceTextureKey.call(this)+"_editor_"+this.resourceName},Object.defineProperty(EditorDragonbonesDisplay.prototype,"localResourceRoot",{get:function(){return"./resources_v"+l.a+"/"},enumerable:!1,configurable:!0}),EditorDragonbonesDisplay.prototype.getPartLoadUrl=function(t){return this.mWebHomePath+"/avatar/part/"+t+".png"},EditorDragonbonesDisplay}(c.b)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n,a=i(2),s=i(0),o=i(214),h=i(434),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},c=function(){function BlockManager(t,e){this.render=e,this.mRows=1,this.mCols=1,this.mSceneName="",this.mGrids=[],this.mScenery=t,this.mUris=t.uris,this.mCameras=e.camerasManager,this.mMainCamera=this.mCameras.camera,this._bound=this.mMainCamera.getBounds(),this.mScaleRatio=this.render.scaleRatio,this.setSize(t.width,t.height);var i=e.getMainScene();if(i){this.mSceneName="SkyBoxScene_"+t.id;this.render.game.scene.add(this.mSceneName,h.a,!1);i.scene.launch(this.mSceneName,this),this.updateDepth()}else a.Logger.getInstance().fatal(BlockManager.name+" scene does not exist")}return BlockManager.prototype.startPlay=function(t){var e=this;this.scene=t,this.initBlock(),this.mStateMap&&this.mStateMap.forEach((function(t){return e.handlerState(t)}))},BlockManager.prototype.check=function(t,e){for(var i=this.mMainCamera.worldView,n=new Phaser.Geom.Rectangle(i.x-i.width/2,i.y-i.height/2,2*i.width,2*i.height),a=0,s=this.mGrids;a<s.length;a++){var o=s[a];o.checkCamera(Phaser.Geom.Intersects.RectangleToRectangle(n,o.rectangle))}},BlockManager.prototype.update=function(t){this.mScenery=t,this.mUris=t.uris,this.setSize(t.width,t.height),this.initBlock(),this.updateDepth()},BlockManager.prototype.setSize=function(t,e,i,n){if(0!==this.mUris.length){var a=1,s=1;(this.mUris.length>1||this.mUris[0].length>1)&&(a=t/1024,s=e/1024),this.mCols=Math.round(a),this.mRows=Math.round(s),this.mGridWidth=t/this.mCols,this.mGridHeight=e/this.mRows}},BlockManager.prototype.resize=function(t,e){if(this.scene&&this.mMainCamera){var i=this.scene.cameras.main;if(i){this.mScaleRatio=this.render.scaleRatio,this.updatePosition(),this._bound=this.mMainCamera.getBounds(),i.setBounds(this._bound.x,this._bound.y,this._bound.width,this._bound.height);for(var n=0,a=this.mGrids;n<a.length;n++){var s=a[n];s.setScaleRatio(this.mScaleRatio),s.resize(t,e)}}}},BlockManager.prototype.updatePosition=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n,a;return __generator(this,(function(s){switch(s.label){case 0:return t=this.scene.cameras.main,e=this.mScenery.offset,[4,this.fixPosition({x:e.x,y:e.y})];case 1:for(i=s.sent(),t.setPosition(i.x,i.y),n=0,a=this.mGrids;n<a.length;n++)a[n].updatePosition();return[2]}}))}))},BlockManager.prototype.destroy=function(){this.render&&this.render.game&&this.render.game.scene.remove(this.mSceneName),this.mGrids.length=0},BlockManager.prototype.setState=function(t){this.handlerState(t)},BlockManager.prototype.playSkyBoxAnimation=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n,a,s,o,h,l;return __generator(this,(function(c){switch(c.label){case 0:return e=t.id,i=t.targets,n=t.duration,a=t.reset,s=t.resetDuration,void 0===e||void 0===i||void 0===n?[2]:this.scene?e!==this.mScenery.id?[2]:(o=this.scene.cameras.main,[4,this.fixPosition(i)]):[2];case 1:return h=c.sent(),[4,this.fixPosition(a)];case 2:return l=c.sent(),this.move(o,h,n,l,s),[2]}}))}))},BlockManager.prototype.handlerState=function(t){for(var e=0,i=t.packet;e<i.length;e++){var n=i[e];this.mScenery.id===n.id&&this.playSkyBoxAnimation(n)}},BlockManager.prototype.updateDepth=function(){if(this.render){var t=this.render.getMainScene();if(this.mScenery&&t){var e=this.render.game.scene.getScene(this.mSceneName);e&&(this.mScenery.depth<0?e.scene.sendToBack(this.mSceneName):e.scene.moveAbove(t.sys.settings.key,this.mSceneName))}else a.Logger.getInstance().fatal("scene does not exist")}},BlockManager.prototype.initBlock=function(){this.clear(),this.mContainer=this.scene.add.container(0,0),this.mContainer.setScale(this.render.scaleRatio);var t=this.mUris.length;if(this.mScenery.fit===s.Fit.Repeat);else for(var e=0;e<t;e++)for(var i=this.mUris[e].length,n=0;n<i;n++){var a=new p(this.scene,this.mUris[e][n],this.mScaleRatio);a.setRectangle(n*this.mGridWidth,e*this.mGridHeight,this.mGridWidth,this.mGridHeight),this.mGrids.push(a)}this.mContainer.add(this.mGrids),this.initCamera()},BlockManager.prototype.move=function(t,e,i,n,s){var o=this;this.tween&&(this.tween.stop(),this.tween.removeAllListeners()),a.Logger.getInstance().debug("scenery: ",e,i),this.tween=this.scene.tweens.add({targets:t,props:e,duration:i,loop:-1,onUpdate:function(){for(var t=0,e=o.mGrids;t<e.length;t++){e[t].updatePosition()}}}),n&&this.tween.once("loop",(function(){n&&(t.x=n.x,t.y=n.y),o.tween.stop(),o.move(t,e,s)}))},BlockManager.prototype.initCamera=function(){var t=this.scene.cameras.main;this.mCameras&&(t.setBounds(this._bound.x,this._bound.y,this._bound.width,this._bound.height),this.updatePosition(),t.setScroll(this.mMainCamera.scrollX,this.mMainCamera.scrollY),this.mCameras.addCamera(t))},BlockManager.prototype.clear=function(){for(var t=0,e=this.mGrids;t<e.length;t++){e[t].destroy()}this.mGrids.length=0,this.mContainer&&this.mContainer.destroy(!0)},Object.defineProperty(BlockManager.prototype,"scenery",{get:function(){return this.mScenery},enumerable:!1,configurable:!0}),Object.defineProperty(BlockManager.prototype,"scaleRatio",{get:function(){return this.mScaleRatio},enumerable:!1,configurable:!0}),BlockManager.prototype.fixPosition=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:return t?[4,this.getOffset()]:[2];case 1:return e=i.sent(),void 0!==t.x&&(t.x=(e.x+t.x)*this.render.scaleRatio),void 0!==t.y&&(t.y=(e.y+t.y)*this.render.scaleRatio),[2,t]}}))}))},BlockManager.prototype.getOffset=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n,a,o;return __generator(this,(function(h){switch(h.label){case 0:return{x:0,y:0},t=0,e=0,this.mScenery?this.mScenery.fit!==s.Fit.Center?[3,2]:[4,this.render.getCurrentRoomSize()]:[3,2];case 1:i=h.sent(),n=this.mScenery,a=n.width,o=n.height,t=-a>>1,e=i.sceneHeight-o>>1,h.label=2;case 2:return[2,Promise.resolve({x:t,y:e})]}}))}))},BlockManager}(),p=function(t){function Block(e,i,n){var a=t.call(this,e,0,0)||this;return a.mLoaded=!1,a.mInCamera=!1,a.mKey=i,a.mScale=n,a.setOrigin(0),a}return l(Block,t),Block.prototype.checkCamera=function(t){this.mInCamera!==t&&(this.mInCamera=t,this.visible=t,this.mLoaded||this.load(a.Url.getOsdRes(this.mKey)))},Block.prototype.setRectangle=function(t,e,i,n){this.x=t,this.y=e,this.setSize(i,n);var a=this.scene.cameras.main;this.mRectangle=new Phaser.Geom.Rectangle(t*this.mScale+a.x,e*this.mScale+a.y,i*this.mScale,n*this.mScale)},Block.prototype.updatePosition=function(){if(this.mRectangle){var t=this.scene.cameras.main;this.mRectangle.x=this.x*this.mScale+t.x,this.mRectangle.y=this.y*this.mScale+t.y}},Block.prototype.resize=function(t,e){var i=this.scene.cameras.main;this.mRectangle=new Phaser.Geom.Rectangle(this.x*this.mScale+i.x,this.y*this.mScale+i.y,this.width*this.mScale,this.height*this.mScale)},Block.prototype.setScaleRatio=function(t){this.mScale=t},Object.defineProperty(Block.prototype,"rectangle",{get:function(){return this.mRectangle},enumerable:!1,configurable:!0}),Object.defineProperty(Block.prototype,"key",{get:function(){return this.mKey},enumerable:!1,configurable:!0}),Block.prototype.onLoadComplete=function(e){t.prototype.onLoadComplete.call(this,e),this.texture&&(this.mLoaded=!0,this.texture.setFilter(Phaser.Textures.FilterMode.NEAREST))},Block}(o.DynamicImage)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(435),s=i(294),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function SkyBoxScene(){return t.call(this,{})||this}return o(SkyBoxScene,t),SkyBoxScene.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this.skyBoxManager=e)},SkyBoxScene.prototype.preload=function(){},SkyBoxScene.prototype.create=function(){var t=this.cameras.main;this.cameras.addExisting(new a.a(0,0,this.sys.scale.width,this.sys.scale.height,this.skyBoxManager.scaleRatio),!0),this.cameras.remove(t),this.skyBoxManager.startPlay(this)},SkyBoxScene.prototype.update=function(t,e){this.skyBoxManager.check(t,e)},SkyBoxScene}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function PlayCamera(e,i,n,a,s,o){var h=t.call(this,e,i,n,a)||this;return h.pixelRatio=s,h.moveRatio=o||1,h}return a(PlayCamera,t),PlayCamera.prototype.setPixelRatio=function(t){this.pixelRatio=t},PlayCamera.prototype.startFollow=function(t,e,i,n,a,s){void 0===e&&(e=!1),void 0===i&&(i=1),void 0===n&&(n=i),void 0===a&&(a=0),void 0===s&&(s=a),this._follow=t,this.roundPixels=e,this.lerp.set(i,n),this.followOffset.set(a,s);var o=this.width/2,h=this.height/2,l=this._follow.getPosition(),c=l.x*this.pixelRatio*this.moveRatio-a,p=l.y*this.pixelRatio*this.moveRatio-s;return this.midPoint.set(c,p),this.scrollX=c-o,this.scrollY=p-h,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},PlayCamera.prototype.preRender=function(t){var e=this.width,i=this.height,n=.5*e,a=.5*i,s=this.zoom*t,o=this.matrix,h=e*this.originX,l=i*this.originY,c=this._follow,p=this.deadzone,d=this.scrollX,u=this.scrollY;if(c&&!this.panEffect.isRunning){var m=c.getPosition(),f=m.x*this.pixelRatio*this.moveRatio-this.followOffset.x,y=m.y*this.pixelRatio*this.moveRatio-this.followOffset.y;p?(f<p.x?d=this.linear(d,d-(p.x-f),this.lerp.x):f>p.right&&(d=this.linear(d,d+(f-p.right),this.lerp.x)),y<p.y?u=this.linear(u,u-(p.y-y),this.lerp.y):y>p.bottom&&(u=this.linear(u,u+(y-p.bottom),this.lerp.y))):(d=this.linear(d,f-h,this.lerp.x),u=this.linear(u,y-l,this.lerp.y))}this.useBounds&&(d=this.clampX(d),u=this.clampY(u)),this.roundPixels&&(h=Math.round(h),l=Math.round(l)),this.scrollX=d,this.scrollY=u;var g=d+n,P=u+a;this.midPoint.set(g,P);var _=e/s,v=i/s;this.worldView.setTo(g-_/2,P-v/2,_,v),o.applyITRS(this.x+h,this.y+l,this.rotation,s,s),o.translate(-h,-l),this.shakeEffect.preRender()},PlayCamera.prototype.linear=function(t,e,i){return(e-t)*i+t},PlayCamera}(Phaser.Cameras.Scene2D.Camera)},function(t,e,i){var n={"./":214,"./bag":146,"./bag/":146,"./bag/IListItemRender":328,"./bag/IListItemRender.ts":328,"./bag/bagView/bagPanel":329,"./bag/bagView/bagPanel.ts":329,"./bag/basebag":326,"./bag/basebag.ts":326,"./bag/baseitem":327,"./bag/baseitem.ts":327,"./bag/index":146,"./bag/index.ts":146,"./bag/storage/storagePanel":330,"./bag/storage/storagePanel.ts":330,"./components":28,"./components/":28,"./components/MoreButtonPanel":322,"./components/MoreButtonPanel.ts":322,"./components/TextButton":299,"./components/TextButton.ts":299,"./components/alert.view":302,"./components/alert.view.ts":302,"./components/background.scale.button":317,"./components/background.scale.button.ts":317,"./components/base.panel":60,"./components/base.panel.ts":60,"./components/button.event.dispatch":61,"./components/button.event.dispatch.ts":61,"./components/checkbox.group":298,"./components/checkbox.group.ts":298,"./components/common.background":316,"./components/common.background.ts":316,"./components/dragDropIcon":152,"./components/dragDropIcon.ts":152,"./components/dynamic.image":59,"./components/dynamic.image.ts":59,"./components/dynamic.ninepatch":295,"./components/dynamic.ninepatch.ts":295,"./components/dynamic.sprite":296,"./components/dynamic.sprite.ts":296,"./components/grid.layout.group":310,"./components/grid.layout.group.ts":310,"./components/icon.btn":153,"./components/icon.btn.ts":153,"./components/icon.select.btn":314,"./components/icon.select.btn.ts":314,"./components/idragable":312,"./components/idragable.ts":312,"./components/idropable":313,"./components/idropable.ts":313,"./components/image.value":305,"./components/image.value.ts":305,"./components/index":28,"./components/index.ts":28,"./components/input.field":324,"./components/input.field.ts":324,"./components/input.panel":297,"./components/input.panel.ts":297,"./components/input.view":306,"./components/input.view.ts":306,"./components/item.slot":85,"./components/item.slot.ts":85,"./components/items.consume.funpanel":311,"./components/items.consume.funpanel.ts":311,"./components/label.input":300,"./components/label.input.ts":300,"./components/material.item":315,"./components/material.item.ts":315,"./components/nine.patch":53,"./components/nine.patch.ts":53,"./components/ninepatch.button":301,"./components/ninepatch.button.ts":301,"./components/patches.config":332,"./components/patches.config.ts":332,"./components/progress.mask.bar":154,"./components/progress.mask.bar.ts":154,"./components/progress.three.bar":319,"./components/progress.three.bar.ts":319,"./components/progress.three.mask.bar":318,"./components/progress.three.mask.bar.ts":318,"./components/prop.item":151,"./components/prop.item.ts":151,"./components/soundButton":150,"./components/soundButton.ts":150,"./components/texture.sprite":323,"./components/texture.sprite.ts":323,"./components/three.button":307,"./components/three.button.ts":307,"./components/three.slice.path":83,"./components/three.slice.path.ts":83,"./components/tips/ItemInfoTips":148,"./components/tips/ItemInfoTips.ts":148,"./components/tips/TextToolTip":303,"./components/tips/TextToolTip.ts":303,"./components/tips/itoolTip":304,"./components/tips/itoolTip.ts":304,"./components/tips/toolTip":149,"./components/tips/toolTip.ts":149,"./components/toggle.button":321,"./components/toggle.button.ts":321,"./components/toggle.color.button":320,"./components/toggle.color.button.ts":320,"./components/tween.compent":308,"./components/tween.compent.ts":308,"./components/value.container":309,"./components/value.container.ts":309,"./index":214,"./index.ts":214,"./rank/basicRankPanel":333,"./rank/basicRankPanel.ts":333,"./rank/rankPanel":331,"./rank/rankPanel.ts":331,"./ui.manager":325,"./ui.manager.ts":325};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=436},function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return p}));var n,a,s=i(158),o=i(334),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function AvatarEditorCanvas(e){var i=t.call(this,e)||this;return i.SCENEKEY="AvatarEditorScene",i.SCENEKEY_SNAPSHOT="AvatarEditorSnapshotScene",h.Logger.getInstance().debug("AvatarEditorCanvas.constructor()"),i.mGame.scene.add(i.SCENEKEY,p),i.mData=e.node,i.mGame.scene.start(i.SCENEKEY,{onCreated:i.onSceneCreated.bind(i),onUpdate:i.update.bind(i),onDestroy:i.onSceneDestroy.bind(i)}),i}return l(AvatarEditorCanvas,t),AvatarEditorCanvas.prototype.destroy=function(){h.Logger.getInstance().debug("AvatarEditorCanvas.destroy()"),this.mData&&(this.mData=null),this.mDragonbone&&this.mDragonbone.destroy(),t.prototype.destroy.call(this)},AvatarEditorCanvas.prototype.getScene=function(){return this.mGame?this.mGame.scene.getScene(this.SCENEKEY):null},AvatarEditorCanvas.prototype.onSceneCreated=function(t){this.mDragonbone=new o.a(t,this.mData.WEB_AVATAR_PATH,this.mEmitter,!0)},AvatarEditorCanvas.prototype.update=function(){},AvatarEditorCanvas.prototype.onSceneDestroy=function(){this.mData=null,this.mDragonbone&&this.mDragonbone.destroy()},AvatarEditorCanvas.prototype.loadLocalResources=function(t,e,i,n){this.mDragonbone&&this.mDragonbone.loadLocalResources(t,e,i)},AvatarEditorCanvas.prototype.toggleFacing=function(t){this.mDragonbone&&this.mDragonbone.setDir(t)},AvatarEditorCanvas.prototype.play=function(t){this.mDragonbone&&this.mDragonbone.play(t)},AvatarEditorCanvas.prototype.clearParts=function(){this.mDragonbone&&this.mDragonbone.clearParts()},AvatarEditorCanvas.prototype.mergeParts=function(t){this.mDragonbone&&this.mDragonbone.mergeParts(t)},AvatarEditorCanvas.prototype.cancelParts=function(t){this.mDragonbone&&this.mDragonbone.cancelParts(t)},AvatarEditorCanvas.prototype.generateShopIcon=function(t,e){var i=this;return new Promise((function(n,a){var s=i.getScene(),l=i.mDragonbone.curSets;if(i.mGame.scene.getScene(i.SCENEKEY_SNAPSHOT))return h.Logger.getInstance().error("generating!"),void a("generating!");i.mGame.scale.resize(t,e),i.mGame.scene.add(i.SCENEKEY_SNAPSHOT,p,!1),s.scene.launch(i.SCENEKEY_SNAPSHOT,{onCreated:function(a){new o.a(a,i.mData.WEB_AVATAR_PATH,i.mEmitter,!0,l,(function(a){a.generateShopIcon(t,e).then((function(t){n(t),i.mGame.scale.resize(i.mConfig.width,i.mConfig.height),i.mGame.scene.stop(i.SCENEKEY_SNAPSHOT),i.mGame.scene.remove(i.SCENEKEY_SNAPSHOT)}))}))}})}))},AvatarEditorCanvas.prototype.generateHeadIcon=function(t,e){var i=this;return new Promise((function(t,e){var n=i.getScene(),a=i.mDragonbone.curSets;if(i.mGame.scene.getScene(i.SCENEKEY_SNAPSHOT))return h.Logger.getInstance().error("generating!"),void e("generating!");i.mGame.scene.add(i.SCENEKEY_SNAPSHOT,p,!1),n.scene.launch(i.SCENEKEY_SNAPSHOT,{onCreated:function(e){i.mGame.scene.sendToBack(i.SCENEKEY_SNAPSHOT);new o.a(e,i.mData.WEB_AVATAR_PATH,i.mEmitter,!1,a,(function(e){e.generateHeadIcon().then((function(e){t(e),i.mGame.scene.stop(i.SCENEKEY_SNAPSHOT),i.mGame.scene.remove(i.SCENEKEY_SNAPSHOT)}))}))}})}))},AvatarEditorCanvas.prototype.on=function(t,e,i){this.mEmitter.on(t,e,i)},AvatarEditorCanvas.prototype.off=function(t,e,i,n){this.mEmitter.off(t,e,i,n)},AvatarEditorCanvas}(s.a),p=function(t){function AvatarEditorScene(){return null!==t&&t.apply(this,arguments)||this}return l(AvatarEditorScene,t),AvatarEditorScene.prototype.preload=function(){h.Logger.getInstance().debug("AvatarEditorScene preload"),this.game.plugins.installScenePlugin("DragonBones",dragonBones.phaser.plugin.DragonBonesScenePlugin,"dragonbone",this,!0)},AvatarEditorScene.prototype.init=function(t){this.onSceneCreated=t.onCreated,this.onSceneUpdate=t.onUpdate,this.onSceneDestroy=t.onDestroy},AvatarEditorScene.prototype.create=function(){this.onSceneCreated&&this.onSceneCreated(this)},AvatarEditorScene.prototype.update=function(){this.onSceneUpdate&&this.onSceneUpdate()},AvatarEditorScene.prototype.destroy=function(){this.onSceneDestroy&&this.onSceneDestroy()},AvatarEditorScene}(Phaser.Scene);!function(t){t.ERROR="error"}(a||(a={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){(function(e){t.exports=e.dragonBones=i(466)}).call(this,i(42))},function(t,e,i){"use strict";var n,a=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])});!function(t){var e=function(){function DragonBones(e){this._clock=new t.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=e,console.info("DragonBones: "+DragonBones.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}return DragonBones.prototype.advanceTime=function(e){if(this._objects.length>0){for(var i=0,n=this._objects;i<n.length;i++){n[i].returnToPool()}this._objects.length=0}if(this._clock.advanceTime(e),this._events.length>0){for(var a=0;a<this._events.length;++a){var s=this._events[a],o=s.armature;null!==o._armatureData&&(o.eventDispatcher.dispatchDBEvent(s.type,s),s.type===t.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(s.type,s)),this.bufferObject(s)}this._events.length=0}},DragonBones.prototype.bufferEvent=function(t){this._events.indexOf(t)<0&&this._events.push(t)},DragonBones.prototype.bufferObject=function(t){this._objects.indexOf(t)<0&&this._objects.push(t)},Object.defineProperty(DragonBones.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(DragonBones.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),DragonBones.VERSION="5.7.000",DragonBones.yDown=!0,DragonBones.debug=!1,DragonBones.debugDraw=!1,DragonBones}();t.DragonBones=e}(c||(c={})),console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function now(){return(new Date).getTime()});var s,o,h,l,c,p;a=function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r};if(void 0===d&&"undefined"!=typeof window)var d=window;t.exports=c,function(t){var e=function(){function BaseObject(){this.hashCode=BaseObject._hashCode++,this._isInPool=!1}return BaseObject._returnObject=function(t){var e=String(t.constructor),i=e in BaseObject._maxCountMap?BaseObject._maxCountMap[e]:BaseObject._defaultMaxCount,n=BaseObject._poolsMap[e]=BaseObject._poolsMap[e]||[];n.length<i&&(t._isInPool?console.warn("The object is already in the pool."):(t._isInPool=!0,n.push(t)))},BaseObject.toString=function(){throw new Error},BaseObject.setMaxCount=function(t,e){if((e<0||e!=e)&&(e=0),null!==t)null!==(n=(i=String(t))in BaseObject._poolsMap?BaseObject._poolsMap[i]:null)&&n.length>e&&(n.length=e),BaseObject._maxCountMap[i]=e;else for(var i in BaseObject._defaultMaxCount=e,BaseObject._poolsMap){var n;(n=BaseObject._poolsMap[i]).length>e&&(n.length=e),i in BaseObject._maxCountMap&&(BaseObject._maxCountMap[i]=e)}},BaseObject.clearPool=function(t){if(void 0===t&&(t=null),null!==t){var e=String(t);null!==(n=e in BaseObject._poolsMap?BaseObject._poolsMap[e]:null)&&n.length>0&&(n.length=0)}else for(var i in BaseObject._poolsMap){var n;(n=BaseObject._poolsMap[i]).length=0}},BaseObject.borrowObject=function(t){var e=String(t),i=e in BaseObject._poolsMap?BaseObject._poolsMap[e]:null;if(null!==i&&i.length>0){var n=i.pop();return n._isInPool=!1,n}var a=new t;return a._onClear(),a},BaseObject.prototype.returnToPool=function(){this._onClear(),BaseObject._returnObject(this)},BaseObject._hashCode=0,BaseObject._defaultMaxCount=3e3,BaseObject._maxCountMap={},BaseObject._poolsMap={},BaseObject}();t.BaseObject=e}(c||(c={})),function(t){var e=function(){function Matrix(t,e,i,n,a,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===a&&(a=0),void 0===s&&(s=0),this.a=t,this.b=e,this.c=i,this.d=n,this.tx=a,this.ty=s}return Matrix.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},Matrix.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Matrix.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},Matrix.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},Matrix.prototype.concat=function(t){var e=this.a*t.a,i=0,n=0,a=this.d*t.d,s=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,n+=this.c*t.a,a+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,n+=this.d*t.c,s+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=i,this.c=n,this.d=a,this.tx=s,this.ty=o,this},Matrix.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,a=this.tx,s=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===n?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,n=this.d=1/n,this.tx=-t*a,this.ty=-n*s),this;var o=t*n-e*i;if(0===o)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;o=1/o;var h=this.a=n*o;return e=this.b=-e*o,i=this.c=-i*o,n=this.d=t*o,this.tx=-(h*a+i*s),this.ty=-(e*a+n*s),this},Matrix.prototype.transformPoint=function(t,e,i,n){void 0===n&&(n=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,n||(i.x+=this.tx,i.y+=this.ty)},Matrix.prototype.transformRectangle=function(t,e){void 0===e&&(e=!1);var i=this.a,n=this.b,a=this.c,s=this.d,o=e?0:this.tx,h=e?0:this.ty,l=t.x,c=t.y,p=l+t.width,d=c+t.height,u=i*l+a*c+o,m=n*l+s*c+h,f=i*p+a*c+o,y=n*p+s*c+h,g=i*p+a*d+o,P=n*p+s*d+h,_=i*l+a*d+o,v=n*l+s*d+h,b=0;u>f&&(b=u,u=f,f=b),g>_&&(b=g,g=_,_=b),t.x=Math.floor(u<g?u:g),t.width=Math.ceil((f>_?f:_)-t.x),m>y&&(b=m,m=y,y=b),P>v&&(b=P,P=v,v=b),t.y=Math.floor(m<P?m:P),t.height=Math.ceil((y>v?y:v)-t.y)},Matrix}();t.Matrix=e}(c||(c={})),function(t){var e=function(){function Transform(t,e,i,n,a,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=1),void 0===s&&(s=1),this.x=t,this.y=e,this.skew=i,this.rotation=n,this.scaleX=a,this.scaleY=s}return Transform.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},Transform.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},Transform.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},Transform.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},Transform.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},Transform.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},Transform.prototype.fromMatrix=function(t){var e=this.scaleX,i=this.scaleY,n=Transform.PI_Q;this.x=t.tx,this.y=t.ty,this.rotation=Math.atan(t.b/t.a);var a=Math.atan(-t.c/t.d);return this.scaleX=this.rotation>-n&&this.rotation<n?t.a/Math.cos(this.rotation):t.b/Math.sin(this.rotation),this.scaleY=a>-n&&a<n?t.d/Math.cos(a):-t.c/Math.sin(a),e>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),i>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,a-=Math.PI),this.skew=a-this.rotation,this},Transform.prototype.toMatrix=function(t){return 0===this.rotation?(t.a=1,t.b=0):(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation)),0===this.skew?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY),t.tx=this.x,t.ty=this.y,this},Transform.PI=Math.PI,Transform.PI_D=2*Math.PI,Transform.PI_H=Math.PI/2,Transform.PI_Q=Math.PI/4,Transform.RAD_DEG=180/Math.PI,Transform.DEG_RAD=Math.PI/180,Transform}();t.Transform=e}(c||(c={})),function(t){var e=function(){function ColorTransform(t,e,i,n,a,s,o,h){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),void 0===a&&(a=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===h&&(h=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=n,this.alphaOffset=a,this.redOffset=s,this.greenOffset=o,this.blueOffset=h}return ColorTransform.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset},ColorTransform.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},ColorTransform}();t.ColorTransform=e}(c||(c={})),function(t){var e=function(){function Point(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return Point.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},Point.prototype.clear=function(){this.x=this.y=0},Point}();t.Point=e}(c||(c={})),function(t){var e=function(){function Rectangle(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}return Rectangle.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},Rectangle.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},Rectangle}();t.Rectangle=e}(c||(c={})),function(t){var e=function(t){function UserData(){var e=null!==t&&t.apply(this,arguments)||this;return e.ints=[],e.floats=[],e.strings=[],e}return a(UserData,t),UserData.toString=function(){return"[class dragonBones.UserData]"},UserData.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},UserData.prototype.addInt=function(t){this.ints.push(t)},UserData.prototype.addFloat=function(t){this.floats.push(t)},UserData.prototype.addString=function(t){this.strings.push(t)},UserData.prototype.getInt=function(t){return void 0===t&&(t=0),t>=0&&t<this.ints.length?this.ints[t]:0},UserData.prototype.getFloat=function(t){return void 0===t&&(t=0),t>=0&&t<this.floats.length?this.floats[t]:0},UserData.prototype.getString=function(t){return void 0===t&&(t=0),t>=0&&t<this.strings.length?this.strings[t]:""},UserData}(t.BaseObject);t.UserData=e;var i=function(t){function ActionData(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return a(ActionData,t),ActionData.toString=function(){return"[class dragonBones.ActionData]"},ActionData.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},ActionData}(t.BaseObject);t.ActionData=i}(c||(c={})),function(t){var e=function(t){function DragonBonesData(){var e=null!==t&&t.apply(this,arguments)||this;return e.frameIndices=[],e.cachedFrames=[],e.armatureNames=[],e.armatures={},e.userData=null,e}return a(DragonBonesData,t),DragonBonesData.toString=function(){return"[class dragonBones.DragonBonesData]"},DragonBonesData.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.colorArray=null,this.userData=null},DragonBonesData.prototype.addArmature=function(t){t.name in this.armatures?console.warn("Same armature: "+t.name):(t.parent=this,this.armatures[t.name]=t,this.armatureNames.push(t.name))},DragonBonesData.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null},DragonBonesData}(t.BaseObject);t.DragonBonesData=e}(c||(c={})),function(t){var e=function(e){function ArmatureData(){var i=null!==e&&e.apply(this,arguments)||this;return i.aabb=new t.Rectangle,i.animationNames=[],i.sortedBones=[],i.sortedSlots=[],i.defaultActions=[],i.actions=[],i.bones={},i.slots={},i.constraints={},i.skins={},i.animations={},i.canvas=null,i.userData=null,i}return a(ArmatureData,e),ArmatureData.toString=function(){return"[class dragonBones.ArmatureData]"},ArmatureData.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++){e[t].returnToPool()}for(var i=0,n=this.actions;i<n.length;i++){n[i].returnToPool()}for(var a in this.bones)this.bones[a].returnToPool(),delete this.bones[a];for(var a in this.slots)this.slots[a].returnToPool(),delete this.slots[a];for(var a in this.constraints)this.constraints[a].returnToPool(),delete this.constraints[a];for(var a in this.skins)this.skins[a].returnToPool(),delete this.skins[a];for(var a in this.animations)this.animations[a].returnToPool(),delete this.animations[a];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},ArmatureData.prototype.sortBones=function(){var t=this.sortedBones.length;if(!(t<=0)){var e=this.sortedBones.concat(),i=0,n=0;for(this.sortedBones.length=0;n<t;){var a=e[i++];if(i>=t&&(i=0),!(this.sortedBones.indexOf(a)>=0)){var s=!1;for(var o in this.constraints){var h=this.constraints[o];if(h.root===a&&this.sortedBones.indexOf(h.target)<0){s=!0;break}}s||null!==a.parent&&this.sortedBones.indexOf(a.parent)<0||(this.sortedBones.push(a),n++)}}}},ArmatureData.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0))for(var e in this.cacheFrameRate=t,this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)},ArmatureData.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames,n=i.length;return i.length+=10,i[n]=t.a,i[n+1]=t.b,i[n+2]=t.c,i[n+3]=t.d,i[n+4]=t.tx,i[n+5]=t.ty,i[n+6]=e.rotation,i[n+7]=e.skew,i[n+8]=e.scaleX,i[n+9]=e.scaleY,n},ArmatureData.prototype.getCacheFrame=function(t,e,i){var n=this.parent.cachedFrames;t.a=n[i],t.b=n[i+1],t.c=n[i+2],t.d=n[i+3],t.tx=n[i+4],t.ty=n[i+5],e.rotation=n[i+6],e.skew=n[i+7],e.scaleX=n[i+8],e.scaleY=n[i+9],e.x=t.tx,e.y=t.ty},ArmatureData.prototype.addBone=function(t){t.name in this.bones?console.warn("Same bone: "+t.name):(this.bones[t.name]=t,this.sortedBones.push(t))},ArmatureData.prototype.addSlot=function(t){t.name in this.slots?console.warn("Same slot: "+t.name):(this.slots[t.name]=t,this.sortedSlots.push(t))},ArmatureData.prototype.addConstraint=function(t){t.name in this.constraints?console.warn("Same constraint: "+t.name):this.constraints[t.name]=t},ArmatureData.prototype.addSkin=function(t){t.name in this.skins?console.warn("Same skin: "+t.name):(t.parent=this,this.skins[t.name]=t,null===this.defaultSkin&&(this.defaultSkin=t),"default"===t.name&&(this.defaultSkin=t))},ArmatureData.prototype.addAnimation=function(t){t.name in this.animations?console.warn("Same animation: "+t.name):(t.parent=this,this.animations[t.name]=t,this.animationNames.push(t.name),null===this.defaultAnimation&&(this.defaultAnimation=t))},ArmatureData.prototype.addAction=function(t,e){e?this.defaultActions.push(t):this.actions.push(t)},ArmatureData.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null},ArmatureData.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null},ArmatureData.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null},ArmatureData.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null},ArmatureData.prototype.getMesh=function(t,e,i){var n=this.getSkin(t);return null===n?null:n.getDisplay(e,i)},ArmatureData.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null},ArmatureData}(t.BaseObject);t.ArmatureData=e;var i=function(e){function BoneData(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i.userData=null,i}return a(BoneData,e),BoneData.toString=function(){return"[class dragonBones.BoneData]"},BoneData.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.alpha=1,this.name="",this.transform.identity(),this.userData=null,this.parent=null},BoneData}(t.BaseObject);t.BoneData=i;var n=function(e){function SurfaceData(){var i=null!==e&&e.apply(this,arguments)||this;return i.geometry=new t.GeometryData,i}return a(SurfaceData,e),SurfaceData.toString=function(){return"[class dragonBones.SurfaceData]"},SurfaceData.prototype._onClear=function(){e.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.geometry.clear()},SurfaceData}(i);t.SurfaceData=n;var s=function(e){function SlotData(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=null,t.userData=null,t}return a(SlotData,e),SlotData.createColor=function(){return new t.ColorTransform},SlotData.toString=function(){return"[class dragonBones.SlotData]"},SlotData.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.zIndex=0,this.alpha=1,this.name="",this.color=null,this.userData=null,this.parent=null},SlotData.DEFAULT_COLOR=new t.ColorTransform,SlotData}(t.BaseObject);t.SlotData=s}(c||(c={})),function(t){var e=function(t){function ConstraintData(){return null!==t&&t.apply(this,arguments)||this}return a(ConstraintData,t),ConstraintData.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},ConstraintData}(t.BaseObject);t.ConstraintData=e;var i=function(t){function IKConstraintData(){return null!==t&&t.apply(this,arguments)||this}return a(IKConstraintData,t),IKConstraintData.toString=function(){return"[class dragonBones.IKConstraintData]"},IKConstraintData.prototype._onClear=function(){t.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},IKConstraintData}(e);t.IKConstraintData=i;var n=function(t){function PathConstraintData(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return a(PathConstraintData,t),PathConstraintData.toString=function(){return"[class dragonBones.PathConstraintData]"},PathConstraintData.prototype._onClear=function(){t.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},PathConstraintData.prototype.AddBone=function(t){this.bones.push(t)},PathConstraintData}(e);t.PathConstraintData=n}(c||(c={})),function(t){var e=function(t){function CanvasData(){return null!==t&&t.apply(this,arguments)||this}return a(CanvasData,t),CanvasData.toString=function(){return"[class dragonBones.CanvasData]"},CanvasData.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},CanvasData}(t.BaseObject);t.CanvasData=e}(c||(c={})),function(t){var e=function(t){function SkinData(){var e=null!==t&&t.apply(this,arguments)||this;return e.displays={},e}return a(SkinData,t),SkinData.toString=function(){return"[class dragonBones.SkinData]"},SkinData.prototype._onClear=function(){for(var t in this.displays){for(var e=0,i=this.displays[t];e<i.length;e++){var n=i[e];null!==n&&n.returnToPool()}delete this.displays[t]}this.name="",this.parent=null},SkinData.prototype.addDisplay=function(t,e){t in this.displays||(this.displays[t]=[]),null!==e&&(e.parent=this),this.displays[t].push(e)},SkinData.prototype.getDisplay=function(t,e){var i=this.getDisplays(t);if(null!==i)for(var n=0,a=i;n<a.length;n++){var s=a[n];if(null!==s&&s.name===e)return s}return null},SkinData.prototype.getDisplays=function(t){return t in this.displays?this.displays[t]:null},SkinData}(t.BaseObject);t.SkinData=e}(c||(c={})),function(t){var e=function(){function GeometryData(){this.weight=null}return GeometryData.prototype.clear=function(){this.isShared||null===this.weight||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},GeometryData.prototype.shareFrom=function(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight},Object.defineProperty(GeometryData.prototype,"vertexCount",{get:function(){return this.data.intArray[this.offset+0]},enumerable:!0,configurable:!0}),Object.defineProperty(GeometryData.prototype,"triangleCount",{get:function(){return this.data.intArray[this.offset+1]},enumerable:!0,configurable:!0}),GeometryData}();t.GeometryData=e;var i=function(e){function DisplayData(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i}return a(DisplayData,e),DisplayData.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},DisplayData}(t.BaseObject);t.DisplayData=i;var n=function(e){function ImageDisplayData(){var i=null!==e&&e.apply(this,arguments)||this;return i.pivot=new t.Point,i}return a(ImageDisplayData,e),ImageDisplayData.toString=function(){return"[class dragonBones.ImageDisplayData]"},ImageDisplayData.prototype._onClear=function(){e.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},ImageDisplayData}(i);t.ImageDisplayData=n;var s=function(t){function ArmatureDisplayData(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions=[],e}return a(ArmatureDisplayData,t),ArmatureDisplayData.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},ArmatureDisplayData.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions;e<i.length;e++){i[e].returnToPool()}this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},ArmatureDisplayData.prototype.addAction=function(t){this.actions.push(t)},ArmatureDisplayData}(i);t.ArmatureDisplayData=s;var o=function(t){function MeshDisplayData(){var i=null!==t&&t.apply(this,arguments)||this;return i.geometry=new e,i}return a(MeshDisplayData,t),MeshDisplayData.toString=function(){return"[class dragonBones.MeshDisplayData]"},MeshDisplayData.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.geometry.clear(),this.texture=null},MeshDisplayData}(i);t.MeshDisplayData=o;var h=function(t){function BoundingBoxDisplayData(){var e=null!==t&&t.apply(this,arguments)||this;return e.boundingBox=null,e}return a(BoundingBoxDisplayData,t),BoundingBoxDisplayData.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},BoundingBoxDisplayData.prototype._onClear=function(){t.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},BoundingBoxDisplayData}(i);t.BoundingBoxDisplayData=h;var l=function(t){function PathDisplayData(){var i=null!==t&&t.apply(this,arguments)||this;return i.geometry=new e,i.curveLengths=[],i}return a(PathDisplayData,t),PathDisplayData.toString=function(){return"[class dragonBones.PathDisplayData]"},PathDisplayData.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.geometry.clear(),this.curveLengths.length=0},PathDisplayData}(i);t.PathDisplayData=l;var c=function(t){function WeightData(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return a(WeightData,t),WeightData.toString=function(){return"[class dragonBones.WeightData]"},WeightData.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},WeightData.prototype.addBone=function(t){this.bones.push(t)},WeightData}(t.BaseObject);t.WeightData=c}(c||(c={})),function(t){var e=function(t){function BoundingBoxData(){return null!==t&&t.apply(this,arguments)||this}return a(BoundingBoxData,t),BoundingBoxData.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},BoundingBoxData}(t.BaseObject);t.BoundingBoxData=e;var i=function(t){function RectangleBoundingBoxData(){return null!==t&&t.apply(this,arguments)||this}return a(RectangleBoundingBoxData,t),RectangleBoundingBoxData.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},RectangleBoundingBoxData._computeOutCode=function(t,e,i,n,a,s){var o=0;return t<i?o|=1:t>a&&(o|=2),e<n?o|=4:e>s&&(o|=8),o},RectangleBoundingBoxData.rectangleIntersectsSegment=function(t,e,i,n,a,s,o,h,l,c,p){void 0===l&&(l=null),void 0===c&&(c=null),void 0===p&&(p=null);var d=t>a&&t<o&&e>s&&e<h,u=i>a&&i<o&&n>s&&n<h;if(d&&u)return-1;for(var m=0,f=RectangleBoundingBoxData._computeOutCode(t,e,a,s,o,h),y=RectangleBoundingBoxData._computeOutCode(i,n,a,s,o,h);;){if(0==(f|y)){m=2;break}if(0!=(f&y))break;var g=0,P=0,_=0,v=0!==f?f:y;0!=(4&v)?(g=t+(i-t)*(s-e)/(n-e),P=s,null!==p&&(_=.5*-Math.PI)):0!=(8&v)?(g=t+(i-t)*(h-e)/(n-e),P=h,null!==p&&(_=.5*Math.PI)):0!=(2&v)?(P=e+(n-e)*(o-t)/(i-t),g=o,null!==p&&(_=0)):0!=(1&v)&&(P=e+(n-e)*(a-t)/(i-t),g=a,null!==p&&(_=Math.PI)),v===f?(t=g,e=P,f=RectangleBoundingBoxData._computeOutCode(t,e,a,s,o,h),null!==p&&(p.x=_)):(i=g,n=P,y=RectangleBoundingBoxData._computeOutCode(i,n,a,s,o,h),null!==p&&(p.y=_))}return m&&(d?(m=2,null!==l&&(l.x=i,l.y=n),null!==c&&(c.x=i,c.y=i),null!==p&&(p.x=p.y+Math.PI)):u?(m=1,null!==l&&(l.x=t,l.y=e),null!==c&&(c.x=t,c.y=e),null!==p&&(p.y=p.x+Math.PI)):(m=3,null!==l&&(l.x=t,l.y=e),null!==c&&(c.x=i,c.y=n))),m},RectangleBoundingBoxData.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=0},RectangleBoundingBoxData.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&t<=i){var n=.5*this.height;if(e>=-n&&e<=n)return!0}return!1},RectangleBoundingBoxData.prototype.intersectsSegment=function(t,e,i,n,a,s,o){void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null);var h=.5*this.width,l=.5*this.height;return RectangleBoundingBoxData.rectangleIntersectsSegment(t,e,i,n,-h,-l,h,l,a,s,o)},RectangleBoundingBoxData}(e);t.RectangleBoundingBoxData=i;var n=function(t){function EllipseBoundingBoxData(){return null!==t&&t.apply(this,arguments)||this}return a(EllipseBoundingBoxData,t),EllipseBoundingBoxData.toString=function(){return"[class dragonBones.EllipseData]"},EllipseBoundingBoxData.ellipseIntersectsSegment=function(t,e,i,n,a,s,o,h,l,c,p){void 0===l&&(l=null),void 0===c&&(c=null),void 0===p&&(p=null);var d=o/h,u=d*d,m=i-t,f=(n*=d)-(e*=d),y=Math.sqrt(m*m+f*f),g=m/y,P=f/y,_=(a-t)*g+(s-e)*P,v=o*o,b=v-(t*t+e*e)+_*_,T=0;if(b>=0){var S=Math.sqrt(b),x=_-S,w=_+S,D=x<0?-1:x<=y?0:1,C=w<0?-1:w<=y?0:1,I=D*C;if(I<0)return-1;0===I&&(-1===D?(T=2,i=t+w*g,n=(e+w*P)/d,null!==l&&(l.x=i,l.y=n),null!==c&&(c.x=i,c.y=n),null!==p&&(p.x=Math.atan2(n/v*u,i/v),p.y=p.x+Math.PI)):1===C?(T=1,t+=x*g,e=(e+x*P)/d,null!==l&&(l.x=t,l.y=e),null!==c&&(c.x=t,c.y=e),null!==p&&(p.x=Math.atan2(e/v*u,t/v),p.y=p.x+Math.PI)):(T=3,null!==l&&(l.x=t+x*g,l.y=(e+x*P)/d,null!==p&&(p.x=Math.atan2(l.y/v*u,l.x/v))),null!==c&&(c.x=t+w*g,c.y=(e+w*P)/d,null!==p&&(p.y=Math.atan2(c.y/v*u,c.x/v)))))}return T},EllipseBoundingBoxData.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1},EllipseBoundingBoxData.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&t<=i){var n=.5*this.height;if(e>=-n&&e<=n)return e*=i/n,Math.sqrt(t*t+e*e)<=i}return!1},EllipseBoundingBoxData.prototype.intersectsSegment=function(t,e,i,n,a,s,o){return void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null),EllipseBoundingBoxData.ellipseIntersectsSegment(t,e,i,n,0,0,.5*this.width,.5*this.height,a,s,o)},EllipseBoundingBoxData}(e);t.EllipseBoundingBoxData=n;var s=function(t){function PolygonBoundingBoxData(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e}return a(PolygonBoundingBoxData,t),PolygonBoundingBoxData.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},PolygonBoundingBoxData.polygonIntersectsSegment=function(t,e,i,n,a,s,o,h){void 0===s&&(s=null),void 0===o&&(o=null),void 0===h&&(h=null),t===i&&(t=i+1e-6),e===n&&(e=n+1e-6);for(var l=a.length,c=t-i,p=e-n,d=t*n-e*i,u=0,m=a[l-2],f=a[l-1],y=0,g=0,P=0,_=0,v=0,b=0,T=0;T<l;T+=2){var S=a[T],x=a[T+1];m===S&&(m=S+1e-4),f===x&&(f=x+1e-4);var w=m-S,D=f-x,C=m*x-f*S,I=c*D-p*w,k=(d*w-c*C)/I;if((k>=m&&k<=S||k>=S&&k<=m)&&(0===c||k>=t&&k<=i||k>=i&&k<=t)){var B=(d*D-p*C)/I;if((B>=f&&B<=x||B>=x&&B<=f)&&(0===p||B>=e&&B<=n||B>=n&&B<=e)){if(null===o){P=k,_=B,v=k,b=B,u++,null!==h&&(h.x=Math.atan2(x-f,S-m)-.5*Math.PI,h.y=h.x);break}var E=k-t;E<0&&(E=-E),0===u?(y=E,g=E,P=k,_=B,v=k,b=B,null!==h&&(h.x=Math.atan2(x-f,S-m)-.5*Math.PI,h.y=h.x)):(E<y&&(y=E,P=k,_=B,null!==h&&(h.x=Math.atan2(x-f,S-m)-.5*Math.PI)),E>g&&(g=E,v=k,b=B,null!==h&&(h.y=Math.atan2(x-f,S-m)-.5*Math.PI))),u++}}m=S,f=x}return 1===u?(null!==s&&(s.x=P,s.y=_),null!==o&&(o.x=P,o.y=_),null!==h&&(h.y=h.x+Math.PI)):u>1&&(u++,null!==s&&(s.x=P,s.y=_),null!==o&&(o.x=v,o.y=b)),u},PolygonBoundingBoxData.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},PolygonBoundingBoxData.prototype.containsPoint=function(t,e){var i=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var n=0,a=this.vertices.length,s=a-2;n<a;n+=2){var o=this.vertices[s+1],h=this.vertices[n+1];if(h<e&&o>=e||o<e&&h>=e){var l=this.vertices[s],c=this.vertices[n];(e-h)*(l-c)/(o-h)+c<t&&(i=!i)}s=n}return i},PolygonBoundingBoxData.prototype.intersectsSegment=function(t,e,n,a,s,o,h){void 0===s&&(s=null),void 0===o&&(o=null),void 0===h&&(h=null);var l=0;return 0!==i.rectangleIntersectsSegment(t,e,n,a,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)&&(l=PolygonBoundingBoxData.polygonIntersectsSegment(t,e,n,a,this.vertices,s,o,h)),l},PolygonBoundingBoxData}(e);t.PolygonBoundingBoxData=s}(c||(c={})),function(t){var e=function(t){function AnimationData(){var e=null!==t&&t.apply(this,arguments)||this;return e.cachedFrames=[],e.boneTimelines={},e.slotTimelines={},e.constraintTimelines={},e.animationTimelines={},e.boneCachedFrameIndices={},e.slotCachedFrameIndices={},e.actionTimeline=null,e.zOrderTimeline=null,e}return a(AnimationData,t),AnimationData.toString=function(){return"[class dragonBones.AnimationData]"},AnimationData.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++){i[e].returnToPool()}delete this.boneTimelines[t]}for(var t in this.slotTimelines){for(var n=0,a=this.slotTimelines[t];n<a.length;n++){a[n].returnToPool()}delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var s=0,o=this.constraintTimelines[t];s<o.length;s++){o[s].returnToPool()}delete this.constraintTimelines[t]}for(var t in this.animationTimelines){for(var h=0,l=this.animationTimelines[t];h<l.length;h++){l[h].returnToPool()}delete this.animationTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.blendType=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},AnimationData.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,n=this.cacheFrames.length;i<n;++i)this.cachedFrames[i]=!1;for(var a=0,s=this.parent.sortedBones;a<s.length;a++){var o=s[a];for(i=0,n=(c=new Array(e)).length;i<n;++i)c[i]=-1;this.boneCachedFrameIndices[o.name]=c}for(var h=0,l=this.parent.sortedSlots;h<l.length;h++){var c,p=l[h];for(i=0,n=(c=new Array(e)).length;i<n;++i)c[i]=-1;this.slotCachedFrameIndices[p.name]=c}}},AnimationData.prototype.addBoneTimeline=function(t,e){var i=t in this.boneTimelines?this.boneTimelines[t]:this.boneTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},AnimationData.prototype.addSlotTimeline=function(t,e){var i=t in this.slotTimelines?this.slotTimelines[t]:this.slotTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},AnimationData.prototype.addConstraintTimeline=function(t,e){var i=t in this.constraintTimelines?this.constraintTimelines[t]:this.constraintTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},AnimationData.prototype.addAnimationTimeline=function(t,e){var i=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},AnimationData.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null},AnimationData.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null},AnimationData.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null},AnimationData.prototype.getAnimationTimelines=function(t){return t in this.animationTimelines?this.animationTimelines[t]:null},AnimationData.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null},AnimationData.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null},AnimationData}(t.BaseObject);t.AnimationData=e;var i=function(t){function TimelineData(){return null!==t&&t.apply(this,arguments)||this}return a(TimelineData,t),TimelineData.toString=function(){return"[class dragonBones.TimelineData]"},TimelineData.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},TimelineData}(t.BaseObject);t.TimelineData=i;var n=function(t){function AnimationTimelineData(){return null!==t&&t.apply(this,arguments)||this}return a(AnimationTimelineData,t),AnimationTimelineData.toString=function(){return"[class dragonBones.AnimationTimelineData]"},AnimationTimelineData.prototype._onClear=function(){t.prototype._onClear.call(this),this.x=0,this.y=0},AnimationTimelineData}(i);t.AnimationTimelineData=n}(c||(c={})),function(t){var e=function(t){function AnimationConfig(){var e=null!==t&&t.apply(this,arguments)||this;return e.boneMask=[],e}return a(AnimationConfig,t),AnimationConfig.toString=function(){return"[class dragonBones.AnimationConfig]"},AnimationConfig.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additive=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},AnimationConfig.prototype.clear=function(){this._onClear()},AnimationConfig.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additive=t.additive,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e]},AnimationConfig}(t.BaseObject);t.AnimationConfig=e}(c||(c={})),function(t){var e=function(t){function TextureAtlasData(){var e=null!==t&&t.apply(this,arguments)||this;return e.textures={},e}return a(TextureAtlasData,t),TextureAtlasData.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},TextureAtlasData.prototype.copyFrom=function(t){for(var e in this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath,this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},TextureAtlasData.prototype.addTexture=function(t){t.name in this.textures?console.warn("Same texture: "+t.name):(t.parent=this,this.textures[t.name]=t)},TextureAtlasData.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null},TextureAtlasData}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function TextureData(){var i=null!==e&&e.apply(this,arguments)||this;return i.region=new t.Rectangle,i.frame=null,i}return a(TextureData,e),TextureData.createRectangle=function(){return new t.Rectangle},TextureData.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},TextureData.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,null===this.frame&&null!==t.frame?this.frame=TextureData.createRectangle():null!==this.frame&&null===t.frame&&(this.frame=null),null!==this.frame&&null!==t.frame&&this.frame.copyFrom(t.frame)},TextureData}(t.BaseObject);t.TextureData=i}(c||(c={})),s=c||(c={}),o=function(t){function Armature(){var e=null!==t&&t.apply(this,arguments)||this;return e._bones=[],e._slots=[],e._constraints=[],e._actions=[],e._animation=null,e._proxy=null,e._replaceTextureAtlasData=null,e._clock=null,e}return a(Armature,t),Armature.toString=function(){return"[class dragonBones.Armature]"},Armature._onSortSlots=function(t,e){return 1e3*t._zIndex+t._zOrder>1e3*e._zIndex+e._zOrder?1:-1},Armature.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var t=0,e=this._bones;t<e.length;t++)e[t].returnToPool();for(var i=0,n=this._slots;i<n.length;i++)n[i].returnToPool();for(var a=0,s=this._constraints;a<s.length;a++)s[a].returnToPool();for(var o=0,h=this._actions;o<h.length;o++)h[o].returnToPool();null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._zIndexDirty=!1,this._alphaDirty=!0,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._alpha=1,this._globalAlpha=1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},Armature.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots,n=null===t;if(this._zOrderDirty||!n){for(var a=0,s=i.length;a<s;++a){var o=n?a:t[e+a];if(!(o<0||o>=s)){var h=i[o],l=this.getSlot(h.name);null!==l&&l._setZOrder(a)}}this._slotsDirty=!0,this._zOrderDirty=!n}},Armature.prototype._addBone=function(t){this._bones.indexOf(t)<0&&this._bones.push(t)},Armature.prototype._addSlot=function(t){this._slots.indexOf(t)<0&&this._slots.push(t)},Armature.prototype._addConstraint=function(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)},Armature.prototype._bufferAction=function(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))},Armature.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},Armature.prototype.init=function(t,e,i,n){null===this._armatureData&&(this._armatureData=t,this._animation=s.BaseObject.borrowObject(s.Animation),this._proxy=e,this._display=i,this._dragonBones=n,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},Armature.prototype.advanceTime=function(t){if(!this._lockUpdate)if(this._lockUpdate=!0,null!==this._armatureData)if(null!==this._armatureData.parent){var e=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty||this._zIndexDirty){if(this._slots.sort(Armature._onSortSlots),this._zIndexDirty)for(var i=0,n=this._slots.length;i<n;++i)this._slots[i]._setZOrder(i);this._slotsDirty=!1,this._zIndexDirty=!1}if(this._alphaDirty){this._alphaDirty=!1,this._globalAlpha=this._alpha*(null!==this._parent?this._parent._globalAlpha:1);for(var a=0,s=this._bones;a<s.length;a++)s[a]._updateAlpha();for(var o=0,h=this._slots;o<h.length;o++)(f=h[o])._updateAlpha()}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==e){for(i=0,n=0,i=0,n=this._bones.length;i<n;++i)this._bones[i].update(this._cacheFrameIndex);for(i=0,n=this._slots.length;i<n;++i)this._slots[i].update(this._cacheFrameIndex)}if(this._actions.length>0){for(var l=0,c=this._actions;l<c.length;l++){var p=c[l],d=p.actionData;if(null!==d&&0===d.type)if(null!==p.slot)null!==(y=p.slot.childArmature)&&y.animation.fadeIn(d.name);else if(null!==p.bone)for(var u=0,m=this.getSlots();u<m.length;u++){var f,y;(f=m[u]).parent===p.bone&&null!==(y=f.childArmature)&&y.animation.fadeIn(d.name)}else this._animation.fadeIn(d.name);p.returnToPool()}this._actions.length=0}this._lockUpdate=!1,this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},Armature.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),null!==t&&t.length>0){if(null!==(o=this.getBone(t))&&(o.invalidUpdate(),e))for(var i=0,n=this._slots;i<n.length;i++)(c=n[i]).parent===o&&c.invalidUpdate()}else{for(var a=0,s=this._bones;a<s.length;a++){var o;(o=s[a]).invalidUpdate()}if(e)for(var h=0,l=this._slots;h<l.length;h++){var c;(c=l[h]).invalidUpdate()}}},Armature.prototype.containsPoint=function(t,e){for(var i=0,n=this._slots;i<n.length;i++){var a=n[i];if(a.containsPoint(t,e))return a}return null},Armature.prototype.intersectsSegment=function(t,e,i,n,a,s,o){void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null);for(var h=t===i,l=0,c=0,p=0,d=0,u=0,m=0,f=0,y=0,g=null,P=null,_=0,v=this._slots;_<v.length;_++){var b=v[_];if(b.intersectsSegment(t,e,i,n,a,s,o)>0){if(null===a&&null===s){g=b;break}var T;null!==a&&((T=h?a.y-e:a.x-t)<0&&(T=-T),(null===g||T<l)&&(l=T,p=a.x,d=a.y,g=b,o&&(f=o.x))),null!==s&&((T=s.x-t)<0&&(T=-T),(null===P||T>c)&&(c=T,u=s.x,m=s.y,P=b,null!==o&&(y=o.y)))}}return null!==g&&null!==a&&(a.x=p,a.y=d,null!==o&&(o.x=f)),null!==P&&null!==s&&(s.x=u,s.y=m,null!==o&&(o.y=y)),g},Armature.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var n=i[e];if(n.name===t)return n}return null},Armature.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return null!==e?e.parent:null},Armature.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var n=i[e];if(n.name===t)return n}return null},Armature.prototype.getSlotByDisplay=function(t){if(null!==t)for(var e=0,i=this._slots;e<i.length;e++){var n=i[e];if(n.display===t)return n}return null},Armature.prototype.getBones=function(){return this._bones},Armature.prototype.getSlots=function(){return this._slots},Object.defineProperty(Armature.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var n=i[e].childArmature;null!==n&&(n.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var n=i[e];n.invalidUpdate(),n.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){null!==this._clock&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var e=0,i=this._slots;e<i.length;e++){var n=i[e].childArmature;null!==n&&(n.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(Armature.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Armature.prototype.getDisplay=function(){return this._display},Armature}(s.BaseObject),s.Armature=o,function(t){var e=function(e){function TransformObject(){var i=null!==e&&e.apply(this,arguments)||this;return i.globalTransformMatrix=new t.Matrix,i.global=new t.Transform,i.offset=new t.Transform,i}return a(TransformObject,e),TransformObject.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._alpha=1,this._globalAlpha=1,this._armature=null},TransformObject.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(TransformObject.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),TransformObject._helpMatrix=new t.Matrix,TransformObject._helpTransform=new t.Transform,TransformObject._helpPoint=new t.Point,TransformObject}(t.BaseObject);t.TransformObject=e}(c||(c={})),function(t){var e=function(e){function Bone(){var i=null!==e&&e.apply(this,arguments)||this;return i.animationPose=new t.Transform,i}return a(Bone,e),Bone.toString=function(){return"[class dragonBones.Bone]"},Bone.prototype._onClear=function(){e.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._boneData=null,this._parent=null,this._cachedFrameIndices=null},Bone.prototype._updateGlobalTransformMatrix=function(e){var i=this._boneData,n=this.global,a=this.globalTransformMatrix,s=this.origin,o=this.offset,h=this.animationPose,l=this._parent,c=this._armature.flipX,p=this._armature.flipY===t.DragonBones.yDown,d=null!==l,u=0;if(1===this.offsetMode?null!==s?(n.x=s.x+o.x+h.x,n.scaleX=s.scaleX*o.scaleX*h.scaleX,n.scaleY=s.scaleY*o.scaleY*h.scaleY,t.DragonBones.yDown?(n.y=s.y+o.y+h.y,n.skew=s.skew+o.skew+h.skew,n.rotation=s.rotation+o.rotation+h.rotation):(n.y=s.y-o.y+h.y,n.skew=s.skew-o.skew+h.skew,n.rotation=s.rotation-o.rotation+h.rotation)):(n.copyFrom(o),t.DragonBones.yDown||(n.y=-n.y,n.skew=-n.skew,n.rotation=-n.rotation),n.add(h)):0===this.offsetMode?null!==s?n.copyFrom(s).add(h):n.copyFrom(h):(d=!1,n.copyFrom(o),t.DragonBones.yDown||(n.y=-n.y,n.skew=-n.skew,n.rotation=-n.rotation)),d){var m=1===l._boneData.type,f=m?l._bone:null,y=m?l._getGlobalTransformMatrix(n.x,n.y):l.globalTransformMatrix;if(!i.inheritScale||m&&null===f){if(i.inheritTranslation){var g=n.x,P=n.y;n.x=y.a*g+y.c*P+y.tx,n.y=y.b*g+y.d*P+y.ty}else c&&(n.x=-n.x),p&&(n.y=-n.y);i.inheritRotation?(l.updateGlobalTransform(),u=l.global.scaleX<0?n.rotation+l.global.rotation+Math.PI:n.rotation+l.global.rotation,y.a*y.d-y.b*y.c<0&&(u-=2*n.rotation,(c!==p||i.inheritReflection)&&(n.skew+=Math.PI),t.DragonBones.yDown||(n.skew=-n.skew)),n.rotation=u):(c||p)&&(c&&p?u=n.rotation+Math.PI:(u=c?Math.PI-n.rotation:-n.rotation,n.skew+=Math.PI),n.rotation=u),n.toMatrix(a)}else m?(i.inheritRotation&&(n.rotation+=l.global.rotation),f.updateGlobalTransform(),n.scaleX*=f.global.scaleX,n.scaleY*=f.global.scaleY,y.transformPoint(n.x,n.y,n),n.toMatrix(a),i.inheritTranslation?(n.x=a.tx,n.y=a.ty):(a.tx=n.x,a.ty=n.y)):(i.inheritRotation||(l.updateGlobalTransform(),u=c&&p?n.rotation-(l.global.rotation+Math.PI):c?n.rotation+l.global.rotation+Math.PI:p?n.rotation+l.global.rotation:n.rotation-l.global.rotation,n.rotation=u),n.toMatrix(a),a.concat(y),i.inheritTranslation?(n.x=a.tx,n.y=a.ty):(a.tx=n.x,a.ty=n.y),e?n.fromMatrix(a):this._globalDirty=!0)}else(c||p)&&(c&&(n.x=-n.x),p&&(n.y=-n.y),c&&p?u=n.rotation+Math.PI:(u=c?Math.PI-n.rotation:-n.rotation,n.skew+=Math.PI),n.rotation=u),n.toMatrix(a)},Bone.prototype._updateAlpha=function(){null!==this._parent?this._globalAlpha=this._alpha*this._parent._globalAlpha:this._globalAlpha=this._alpha*this._armature._globalAlpha},Bone.prototype.init=function(t,e){null===this._boneData&&(this._boneData=t,this._armature=e,this._alpha=this._boneData.alpha,null!==this._boneData.parent&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},Bone.prototype.update=function(t){if(t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,n=this._armature._constraints;i<n.length;i++){(o=n[i])._root===this&&o.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var a=0,s=this._armature._constraints;a<s.length;a++){var o;(o=s[a])._root===this&&o.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var h=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(h),h&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},Bone.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},Bone.prototype.invalidUpdate=function(){this._transformDirty=!0},Bone.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.parent;return e===this},Object.defineProperty(Bone.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var n=i[e];n.parent===this&&n._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Bone.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Bone}(t.TransformObject);t.Bone=e}(c||(c={})),function(t){var e=function(t){function Surface(){var e=null!==t&&t.apply(this,arguments)||this;return e._vertices=[],e._deformVertices=[],e._hullCache=[],e._matrixCahce=[],e}return a(Surface,t),Surface.toString=function(){return"[class dragonBones.Surface]"},Surface.prototype._onClear=function(){t.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0,this._bone=null},Surface.prototype._getAffineTransform=function(t,e,i,n,a,s,o,h,l,c,p,d,u){var m=o-a,f=h-s,y=l-a,g=c-s;p.rotation=Math.atan2(f,m),p.skew=Math.atan2(g,y)-.5*Math.PI-p.rotation,u&&(p.rotation+=Math.PI),p.scaleX=Math.sqrt(m*m+f*f)/i,p.scaleY=Math.sqrt(y*y+g*g)/n,p.toMatrix(d),p.x=d.tx=a-(d.a*t+d.c*e),p.y=d.ty=s-(d.b*t+d.d*e)},Surface.prototype._updateVertices=function(){var t=this._armature.armatureData.parent,e=this._boneData.geometry,i=t.intArray,n=t.floatArray,a=i[e.offset+0],s=i[e.offset+2],o=this._vertices,h=this._deformVertices;if(null!==this._parent)if(1===this._parent._boneData.type)for(var l=0,c=a;l<c;++l){var p=n[s+(f=2*l)]+h[f],d=n[s+f+1]+h[f+1],u=this._parent._getGlobalTransformMatrix(p,d);o[f]=u.a*p+u.c*d+u.tx,o[f+1]=u.b*p+u.d*d+u.ty}else{var m=this._parent.globalTransformMatrix;for(l=0,c=a;l<c;++l){p=n[s+(f=2*l)]+h[f],d=n[s+f+1]+h[f+1];o[f]=m.a*p+m.c*d+m.tx,o[f+1]=m.b*p+m.d*d+m.ty}}else for(l=0,c=a;l<c;++l){var f;o[f=2*l]=n[s+f]+h[f],o[f+1]=n[s+f+1]+h[f+1]}},Surface.prototype._updateGlobalTransformMatrix=function(t){var e=2*this._boneData.segmentX,i=this._vertices.length-2,n=this._vertices[0],a=this._vertices[1],s=this._vertices[e],o=this._vertices[e+1],h=this._vertices[i],l=this._vertices[i+1],c=this._vertices[i-e],p=this._vertices[i-e+1],d=n+.5*(h-n),u=a+.5*(l-a),m=d+.5*(s+.5*(c-s)-d),f=u+.5*(o+.5*(p-o)-u),y=s+.5*(h-s),g=o+.5*(l-o),P=c+.5*(h-c),_=p+.5*(l-p);this._getAffineTransform(0,0,200,200,m,f,y,g,P,_,this.global,this.globalTransformMatrix,!1),this._globalDirty=!1},Surface.prototype._getGlobalTransformMatrix=function(t,e){var i=200,n=1e3;if(t<-n||n<t||e<-n||n<e)return this.globalTransformMatrix;var a=!1,s=this._boneData,o=s.segmentX,h=s.segmentY,l=2*s.segmentX,c=this._dX,p=this._dY,d=Math.floor((t+i)/c),u=Math.floor((e+i)/p),m=0,f=d*c-i,y=u*p-i,g=this._matrixCahce,P=Surface._helpMatrix;if(t<-i){if(e<-i||e>=i)return this.globalTransformMatrix;if(g[m=7*(2*(o*h+o+h+h+u)+((a=e>this._kX*(t+i)+y)?1:0))]>0)P.copyFromArray(g,m+1);else{var _=u*(l+2),v=this._hullCache[4],b=this._hullCache[5],T=this._hullCache[2]-(h-u)*v,S=this._hullCache[3]-(h-u)*b,x=this._vertices;a?this._getAffineTransform(-i,y+p,800,p,x[_+l+2],x[_+l+3],T+v,S+b,x[_],x[_+1],Surface._helpTransform,P,!0):this._getAffineTransform(-n,y,800,p,T,S,x[_],x[_+1],T+v,S+b,Surface._helpTransform,P,!1),g[m]=1,g[m+1]=P.a,g[m+2]=P.b,g[m+3]=P.c,g[m+4]=P.d,g[m+5]=P.tx,g[m+6]=P.ty}}else if(t>=i){if(e<-i||e>=i)return this.globalTransformMatrix;if(g[m=7*(2*(o*h+o+u)+((a=e>this._kX*(t-n)+y)?1:0))]>0)P.copyFromArray(g,m+1);else{_=(u+1)*(l+2)-2,v=this._hullCache[4],b=this._hullCache[5],T=this._hullCache[0]+u*v,S=this._hullCache[1]+u*b,x=this._vertices;a?this._getAffineTransform(n,y+p,800,p,T+v,S+b,x[_+l+2],x[_+l+3],T,S,Surface._helpTransform,P,!0):this._getAffineTransform(i,y,800,p,x[_],x[_+1],T,S,x[_+l+2],x[_+l+3],Surface._helpTransform,P,!1),g[m]=1,g[m+1]=P.a,g[m+2]=P.b,g[m+3]=P.c,g[m+4]=P.d,g[m+5]=P.tx,g[m+6]=P.ty}}else if(e<-i){if(t<-i||t>=i)return this.globalTransformMatrix;if(g[m=7*(2*(o*h+d)+((a=e>this._kY*(t-f-c)-n)?1:0))]>0)P.copyFromArray(g,m+1);else{_=2*d,v=this._hullCache[10],b=this._hullCache[11],T=this._hullCache[8]+d*v,S=this._hullCache[9]+d*b,x=this._vertices;a?this._getAffineTransform(f+c,-i,c,800,x[_+2],x[_+3],x[_],x[_+1],T+v,S+b,Surface._helpTransform,P,!0):this._getAffineTransform(f,-n,c,800,T,S,T+v,S+b,x[_],x[_+1],Surface._helpTransform,P,!1),g[m]=1,g[m+1]=P.a,g[m+2]=P.b,g[m+3]=P.c,g[m+4]=P.d,g[m+5]=P.tx,g[m+6]=P.ty}}else if(e>=i){if(t<-i||t>=i)return this.globalTransformMatrix;if(g[m=7*(2*(o*h+o+h+d)+((a=e>this._kY*(t-f-c)+i)?1:0))]>0)P.copyFromArray(g,m+1);else{_=h*(l+2)+2*d,v=this._hullCache[10],b=this._hullCache[11],T=this._hullCache[6]-(o-d)*v,S=this._hullCache[7]-(o-d)*b,x=this._vertices;a?this._getAffineTransform(f+c,n,c,800,T+v,S+b,T,S,x[_+2],x[_+3],Surface._helpTransform,P,!0):this._getAffineTransform(f,i,c,800,x[_],x[_+1],x[_+2],x[_+3],T,S,Surface._helpTransform,P,!1),g[m]=1,g[m+1]=P.a,g[m+2]=P.b,g[m+3]=P.c,g[m+4]=P.d,g[m+5]=P.tx,g[m+6]=P.ty}}else if(g[m=7*(2*(o*u+d)+((a=e>this._k*(t-f-c)+y)?1:0))]>0)P.copyFromArray(g,m+1);else{_=2*d+u*(l+2),x=this._vertices;a?this._getAffineTransform(f+c,y+p,c,p,x[_+l+4],x[_+l+5],x[_+l+2],x[_+l+3],x[_+2],x[_+3],Surface._helpTransform,P,!0):this._getAffineTransform(f,y,c,p,x[_],x[_+1],x[_+2],x[_+3],x[_+l+2],x[_+l+3],Surface._helpTransform,P,!1),g[m]=1,g[m+1]=P.a,g[m+2]=P.b,g[m+3]=P.c,g[m+4]=P.d,g[m+5]=P.tx,g[m+6]=P.ty}return P},Surface.prototype.init=function(e,i){if(null===this._boneData){t.prototype.init.call(this,e,i);var n=e.segmentX,a=e.segmentY,s=this._armature.armatureData.parent.intArray[e.geometry.offset+0];this._dX=400/n,this._dY=400/a,this._k=-this._dY/this._dX,this._kX=-this._dY/800,this._kY=-800/this._dX,this._vertices.length=2*s,this._deformVertices.length=2*s,this._matrixCahce.length=2*(n*a+2*n+2*a)*7,this._hullCache.length=10;for(var o=0;o<2*s;++o)this._deformVertices[o]=0;null!==this._parent&&(0===this._parent.boneData.type?this._bone=this._parent:this._bone=this._parent._bone)}},Surface.prototype.update=function(t){if(t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,n=this._armature._constraints;i<n.length;i++){(o=n[i])._root===this&&o.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var a=0,s=this._armature._constraints;a<s.length;a++){var o;(o=s[a])._root===this&&o.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var h=0,l=this._matrixCahce.length;h<l;h+=7)this._matrixCahce[h]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){var c=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(c),c&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var p=2*this.global.x,d=2*this.global.y,u=Surface._helpPoint;this.globalTransformMatrix.transformPoint(1e3,-200,u),this._hullCache[0]=u.x,this._hullCache[1]=u.y,this._hullCache[2]=p-u.x,this._hullCache[3]=d-u.y,this.globalTransformMatrix.transformPoint(0,this._dY,u,!0),this._hullCache[4]=u.x,this._hullCache[5]=u.y,this.globalTransformMatrix.transformPoint(200,1e3,u),this._hullCache[6]=u.x,this._hullCache[7]=u.y,this._hullCache[8]=p-u.x,this._hullCache[9]=d-u.y,this.globalTransformMatrix.transformPoint(this._dX,0,u,!0),this._hullCache[10]=u.x,this._hullCache[11]=u.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},Surface}(t.Bone);t.Surface=e}(c||(c={})),function(t){var e=function(t){function DisplayFrame(){var e=null!==t&&t.apply(this,arguments)||this;return e.deformVertices=[],e}return a(DisplayFrame,t),DisplayFrame.toString=function(){return"[class dragonBones.DisplayFrame]"},DisplayFrame.prototype._onClear=function(){this.rawDisplayData=null,this.displayData=null,this.textureData=null,this.display=null,this.deformVertices.length=0},DisplayFrame.prototype.updateDeformVertices=function(){if(null!==this.rawDisplayData&&0===this.deformVertices.length){var t;if(2===this.rawDisplayData.type)t=this.rawDisplayData.geometry;else{if(4!==this.rawDisplayData.type)return;t=this.rawDisplayData.geometry}var e=0;e=null!==t.weight?2*t.weight.count:2*t.data.intArray[t.offset+0],this.deformVertices.length=e;for(var i=0,n=this.deformVertices.length;i<n;++i)this.deformVertices[i]=0}},DisplayFrame.prototype.getGeometryData=function(){if(null!==this.displayData){if(2===this.displayData.type)return this.displayData.geometry;if(4===this.displayData.type)return this.displayData.geometry}if(null!==this.rawDisplayData){if(2===this.rawDisplayData.type)return this.rawDisplayData.geometry;if(4===this.rawDisplayData.type)return this.rawDisplayData.geometry}return null},DisplayFrame.prototype.getBoundingBox=function(){return null!==this.displayData&&3===this.displayData.type?this.displayData.boundingBox:null!==this.rawDisplayData&&3===this.rawDisplayData.type?this.rawDisplayData.boundingBox:null},DisplayFrame.prototype.getTextureData=function(){if(null!==this.displayData){if(0===this.displayData.type)return this.displayData.texture;if(2===this.displayData.type)return this.displayData.texture}if(null!==this.textureData)return this.textureData;if(null!==this.rawDisplayData){if(0===this.rawDisplayData.type)return this.rawDisplayData.texture;if(2===this.rawDisplayData.type)return this.rawDisplayData.texture}return null},DisplayFrame}(t.BaseObject);t.DisplayFrame=e;var i=function(i){function Slot(){var e=null!==i&&i.apply(this,arguments)||this;return e._localMatrix=new t.Matrix,e._colorTransform=new t.ColorTransform,e._displayFrames=[],e._geometryBones=[],e._rawDisplay=null,e._meshDisplay=null,e._display=null,e}return a(Slot,i),Slot.prototype._onClear=function(){i.prototype._onClear.call(this);for(var e=[],n=0,a=this._displayFrames;n<a.length;n++){var s=a[n],o=s.display;o!==this._rawDisplay&&o!==this._meshDisplay&&e.indexOf(o)<0&&e.push(o),s.returnToPool()}for(var h=0,l=e;h<l.length;h++){var c=l[h];c instanceof t.Armature?c.dispose():this._disposeDisplay(c,!0)}null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDataDirty=!1,this._displayDirty=!1,this._geometryDirty=!1,this._textureDirty=!1,this._visibleDirty=!1,this._blendModeDirty=!1,this._zOrderDirty=!1,this._colorDirty=!1,this._verticesDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._zIndex=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayFrames.length=0,this._geometryBones.length=0,this._slotData=null,this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},Slot.prototype._hasDisplay=function(t){for(var e=0,i=this._displayFrames;e<i.length;e++){if(i[e].display===t)return!0}return!1},Slot.prototype._isBonesUpdate=function(){for(var t=0,e=this._geometryBones;t<e.length;t++){var i=e[t];if(null!==i&&i._childrenTransformDirty)return!0}return!1},Slot.prototype._updateAlpha=function(){var t=this._alpha*this._parent._globalAlpha;this._globalAlpha!==t&&(this._globalAlpha=t,this._colorDirty=!0)},Slot.prototype._updateDisplayData=function(){var e=this._displayFrame,i=this._geometryData,n=this._textureData,a=null,s=null;if(this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&this._displayIndex<this._displayFrames.length&&(this._displayFrame=this._displayFrames[this._displayIndex],a=this._displayFrame.rawDisplayData,s=this._displayFrame.displayData,this._geometryData=this._displayFrame.getGeometryData(),this._boundingBoxData=this._displayFrame.getBoundingBox(),this._textureData=this._displayFrame.getTextureData()),this._displayFrame!==e||this._geometryData!==i||this._textureData!==n){if(null===this._geometryData&&null!==this._textureData){var o=null!==s&&0===s.type?s:a,h=this._textureData.parent.scale*this._armature._armatureData.scale,l=this._textureData.frame;this._pivotX=o.pivot.x,this._pivotY=o.pivot.y;var c=null!==l?l:this._textureData.region,p=c.width,d=c.height;this._textureData.rotated&&null===l&&(p=c.height,d=c.width),this._pivotX*=p*h,this._pivotY*=d*h,null!==l&&(this._pivotX+=l.x*h,this._pivotY+=l.y*h),null!==a&&o!==a&&(a.transform.toMatrix(Slot._helpMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(0,0,Slot._helpPoint),this._pivotX-=Slot._helpPoint.x,this._pivotY-=Slot._helpPoint.y,o.transform.toMatrix(Slot._helpMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(0,0,Slot._helpPoint),this._pivotX+=Slot._helpPoint.x,this._pivotY+=Slot._helpPoint.y),t.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*h-this._pivotY)}else this._pivotX=0,this._pivotY=0;if(this.origin=null!==a?a.transform:null!==s?s.transform:null,null!==this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix),this._geometryData!==i)if(this._geometryDirty=!0,this._verticesDirty=!0,null!==this._geometryData){if(this._geometryBones.length=0,null!==this._geometryData.weight)for(var u=0,m=this._geometryData.weight.bones.length;u<m;++u){var f=this._armature.getBone(this._geometryData.weight.bones[u].name);this._geometryBones.push(f)}}else this._geometryBones.length=0,this._geometryData=null;this._textureDirty=this._textureData!==n,this._transformDirty=!0}},Slot.prototype._updateDisplay=function(){var e=null!==this._display?this._display:this._rawDisplay,i=this._childArmature;if(null!==this._displayFrame?(this._display=this._displayFrame.display,null!==this._display&&this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null),(null!==this._display?this._display:this._rawDisplay)!==e&&(this._textureDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._transformDirty=!0,this._onUpdateDisplay(),this._replaceDisplay(e)),this._childArmature!==i&&(null!==i&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),null!==this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var n=this._armature.cacheFrameRate;0!==n&&(this._childArmature.cacheFrameRate=n)}if(null!==this._displayFrame){var a=null,s=null!==this._displayFrame.displayData?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(null!==s&&1===s.type&&(a=s.actions),null!==a&&a.length>0)for(var o=0,h=a;o<h.length;o++){var l=h[o],c=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(l,c,this._armature),c.slot=this,this._armature._bufferAction(c,!1)}else this._childArmature.animation.play()}}},Slot.prototype._updateGlobalTransformMatrix=function(t){var e=0===this._parent._boneData.type?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(e),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},Slot.prototype._setDisplayIndex=function(t,e){if(void 0===e&&(e=!1),e){if(this._animationDisplayIndex===t)return;this._animationDisplayIndex=t}this._displayIndex!==t&&(this._displayIndex=t<this._displayFrames.length?t:this._displayFrames.length-1,this._displayDataDirty=!0,this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display)},Slot.prototype._setZOrder=function(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},Slot.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0},Slot.prototype.init=function(t,e,i,n){if(null===this._slotData){this._slotData=t,this._colorDirty=!0,this._blendModeDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._zIndex=this._slotData.zIndex,this._alpha=this._slotData.alpha,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=i,this._meshDisplay=n,this._armature=e;var a=this._armature.getBone(this._slotData.parent.name);null!==a&&(this._parent=a),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}},Slot.prototype.update=function(t){if(this._displayDataDirty&&(this._updateDisplayData(),this._displayDataDirty=!1),this._displayDirty&&(this._updateDisplay(),this._displayDirty=!1),(this._geometryDirty||this._textureDirty)&&(null!==this._display&&this._display!==this._rawDisplay&&this._display!==this._meshDisplay||this._updateFrame(),this._geometryDirty=!1,this._textureDirty=!1),null!==this._display){if(this._visibleDirty&&(this._updateVisible(),this._visibleDirty=!1),this._blendModeDirty&&(this._updateBlendMode(),this._blendModeDirty=!1),this._colorDirty&&(this._updateColor(),this._colorDirty=!1),this._zOrderDirty&&(this._updateZOrder(),this._zOrderDirty=!1),null!==this._geometryData&&this._display===this._meshDisplay){var e=null!==this._geometryData.weight,i=0!==this._parent._boneData.type;if((this._verticesDirty||e&&this._isBonesUpdate()||i&&this._parent._childrenTransformDirty)&&(this._verticesDirty=!1,this._updateMesh()),e||i)return}if(t>=0&&null!==this._cachedFrameIndices){var n=this._cachedFrameIndices[t];n>=0&&this._cachedFrameIndex===n?this._transformDirty=!1:n>=0?(this._transformDirty=!0,this._cachedFrameIndex=n):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._transformDirty){if(this._cachedFrameIndex<0){var a=t>=0;this._updateGlobalTransformMatrix(a),a&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(),this._transformDirty=!1}}},Slot.prototype.invalidUpdate=function(){this._displayDataDirty=!0,this._displayDirty=!0,this._transformDirty=!0},Slot.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._updateGlobalTransformMatrix(!1),this._transformDirty=!1)},Slot.prototype.replaceRawDisplayData=function(t,e){if(void 0===e&&(e=-1),e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];if(i.rawDisplayData!==t){if(i.deformVertices.length=0,i.rawDisplayData=t,null===i.rawDisplayData){var n=this._armature._armatureData.defaultSkin;if(null!==n){var a=n.getDisplays(this._slotData.name);null!==a&&e<a.length&&(i.rawDisplayData=a[e])}}e===this._displayIndex&&(this._displayDataDirty=!0)}},Slot.prototype.replaceDisplayData=function(t,e){if(void 0===e&&(e=-1),e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];i.displayData!==t&&i.rawDisplayData!==t&&(i.displayData=t,e===this._displayIndex&&(this._displayDataDirty=!0))},Slot.prototype.replaceTextureData=function(t,e){if(void 0===e&&(e=-1),e<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];i.textureData!==t&&(i.textureData=t,e===this._displayIndex&&(this._displayDataDirty=!0))},Slot.prototype.replaceDisplay=function(e,i){if(void 0===i&&(i=-1),i<0)i=this._displayIndex<0?0:this._displayIndex;else if(i>=this._displayFrames.length)return;var n=this._displayFrames[i];if(n.display!==e){var a=n.display;n.display=e,null===a||a===this._rawDisplay||a===this._meshDisplay||this._hasDisplay(a)||a instanceof t.Armature||this._disposeDisplay(a,!0),null===e||e===this._rawDisplay||e===this._meshDisplay||this._hasDisplay(a)||e instanceof t.Armature||this._initDisplay(e,!0),i===this._displayIndex&&(this._displayDirty=!0)}},Slot.prototype.containsPoint=function(t,e){return null!==this._boundingBoxData&&(this.updateTransformAndMatrix(),Slot._helpMatrix.copyFrom(this.globalTransformMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(t,e,Slot._helpPoint),this._boundingBoxData.containsPoint(Slot._helpPoint.x,Slot._helpPoint.y))},Slot.prototype.intersectsSegment=function(t,e,i,n,a,s,o){if(void 0===a&&(a=null),void 0===s&&(s=null),void 0===o&&(o=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),Slot._helpMatrix.copyFrom(this.globalTransformMatrix),Slot._helpMatrix.invert(),Slot._helpMatrix.transformPoint(t,e,Slot._helpPoint),t=Slot._helpPoint.x,e=Slot._helpPoint.y,Slot._helpMatrix.transformPoint(i,n,Slot._helpPoint),i=Slot._helpPoint.x,n=Slot._helpPoint.y;var h=this._boundingBoxData.intersectsSegment(t,e,i,n,a,s,o);return h>0&&(1===h||2===h?null!==a?(this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==s&&(s.x=a.x,s.y=a.y)):null!==s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s):(null!==a&&this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s)),null!==o&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),Slot._helpPoint,!0),o.x=Math.atan2(Slot._helpPoint.y,Slot._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),Slot._helpPoint,!0),o.y=Math.atan2(Slot._helpPoint.y,Slot._helpPoint.x))),h},Slot.prototype.getDisplayFrameAt=function(t){return this._displayFrames[t]},Object.defineProperty(Slot.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!==t&&(this._visible=t,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayFrameCount",{get:function(){return this._displayFrames.length},set:function(i){var n=this._displayFrames.length;if(n<i){this._displayFrames.length=i;for(var a=n;a<i;++a)this._displayFrames[a]=t.BaseObject.borrowObject(e)}else if(n>i){for(a=n-1;a<i;--a)this.replaceDisplay(null,a),this._displayFrames[a].returnToPool();this._displayFrames.length=i}},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t),this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"displayList",{get:function(){for(var t=new Array,e=0,i=this._displayFrames;e<i.length;e++){var n=i[e];t.push(n.display)}return t},set:function(t){this.displayFrameCount=t.length;for(var e=0,i=0,n=t;i<n.length;i++){var a=n[i];this.replaceDisplay(a,e++)}},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"display",{get:function(){return this._display},set:function(t){this._display!==t&&(0===this._displayFrames.length&&(this.displayFrameCount=1,this._displayIndex=0),this.replaceDisplay(t,this._displayIndex))},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),Object.defineProperty(Slot.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Slot.prototype.getDisplay=function(){return this._display},Slot.prototype.setDisplay=function(t){this.display=t},Slot}(t.TransformObject);t.Slot=i}(c||(c={})),function(t){var e=function(e){function Constraint(){return null!==e&&e.apply(this,arguments)||this}return a(Constraint,e),Constraint.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(Constraint.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),Constraint._helpMatrix=new t.Matrix,Constraint._helpTransform=new t.Transform,Constraint._helpPoint=new t.Point,Constraint}(t.BaseObject);t.Constraint=e;var i=function(e){function IKConstraint(){return null!==e&&e.apply(this,arguments)||this}return a(IKConstraint,e),IKConstraint.toString=function(){return"[class dragonBones.IKConstraint]"},IKConstraint.prototype._onClear=function(){e.prototype._onClear.call(this),this._bendPositive=!1,this._weight=1,this._constraintData=null},IKConstraint.prototype._computeA=function(){var e=this._target.global,i=this._root.global,n=this._root.globalTransformMatrix,a=Math.atan2(e.y-i.y,e.x-i.x);i.scaleX<0&&(a+=Math.PI),i.rotation+=t.Transform.normalizeRadian(a-i.rotation)*this._weight,i.toMatrix(n)},IKConstraint.prototype._computeB=function(){var e=this._bone._boneData.length,i=this._root,n=this._target.global,a=i.global,s=this._bone.global,o=this._bone.globalTransformMatrix,h=o.a*e,l=o.b*e,c=h*h+l*l,p=Math.sqrt(c),d=s.x-a.x,u=s.y-a.y,m=d*d+u*u,f=Math.sqrt(m),y=s.rotation,g=a.rotation,P=Math.atan2(u,d),_=(d=n.x-a.x)*d+(u=n.y-a.y)*u,v=Math.sqrt(_),b=0;if(p+f<=v||v+p<=f||v+f<=p)b=Math.atan2(n.y-a.y,n.x-a.x),p+f<=v||f<p&&(b+=Math.PI);else{var T=(m-c+_)/(2*_),S=Math.sqrt(m-T*T*_)/v,x=a.x+d*T,w=a.y+u*T,D=-u*S,C=d*S,I=!1,k=i.parent;if(null!==k){var B=k.globalTransformMatrix;I=B.a*B.d-B.b*B.c<0}I!==this._bendPositive?(s.x=x-D,s.y=w-C):(s.x=x+D,s.y=w+C),b=Math.atan2(s.y-a.y,s.x-a.x)}var E=t.Transform.normalizeRadian(b-P);a.rotation=g+E*this._weight,a.toMatrix(i.globalTransformMatrix);var A=P+E*this._weight;s.x=a.x+Math.cos(A)*f,s.y=a.y+Math.sin(A)*f;var O=Math.atan2(n.y-s.y,n.x-s.x);s.scaleX<0&&(O+=Math.PI),s.rotation=a.rotation+y-g+t.Transform.normalizeRadian(O-E-y)*this._weight,s.toMatrix(o)},IKConstraint.prototype.init=function(t,e){if(null===this._constraintData){this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=null!==this._constraintData.bone?this._armature.getBone(this._constraintData.bone.name):null;var i=this._constraintData;this._bendPositive=i.bendPositive,this._weight=i.weight,this._root._hasConstraint=!0}},IKConstraint.prototype.update=function(){this._root.updateByConstraint(),null!==this._bone?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},IKConstraint.prototype.invalidUpdate=function(){this._root.invalidUpdate(),null!==this._bone&&this._bone.invalidUpdate()},IKConstraint}(e);t.IKConstraint=i;var n=function(e){function PathConstraint(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._spaces=[],t._positions=[],t._curves=[],t._boneLengths=[],t._pathGlobalVertices=[],t._segments=[10],t}return a(PathConstraint,e),PathConstraint.toString=function(){return"[class dragonBones.PathConstraint]"},PathConstraint.prototype._onClear=function(){e.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},PathConstraint.prototype._updatePathVertices=function(t){var e=this._armature,i=e.armatureData.parent,n=e.armatureData.scale,a=i.intArray,s=i.floatArray,o=t.offset,h=a[o+0],l=a[o+2];this._pathGlobalVertices.length=2*h;var c=t.weight;if(null!==c)for(var p=this._pathSlot._geometryBones,d=c.bones.length,u=c.offset,m=a[u+1],f=u+2+d,y=(w=0,0);w<h;w++){for(var g=0,P=0,_=0,v=a[f++];_<v;_++){var b=p[a[f++]];if(null!==b){b.updateByConstraint();x=b.globalTransformMatrix;var T=s[m++];C=s[m++]*n,I=s[m++]*n;g+=(x.a*C+x.c*I+x.tx)*T,P+=(x.b*C+x.d*I+x.ty)*T}}this._pathGlobalVertices[y++]=g,this._pathGlobalVertices[y++]=P}else{var S=this._pathSlot.parent;S.updateByConstraint();for(var x=S.globalTransformMatrix,w=0,D=l;w<h;w+=2){var C=s[D++]*n,I=s[D++]*n,k=x.a*C+x.c*I+x.tx,B=x.b*C+x.d*I+x.ty;this._pathGlobalVertices[w]=k,this._pathGlobalVertices[w+1]=B}}},PathConstraint.prototype._computeVertices=function(t,e,i,n){for(var a=i,s=t;a<e;a+=2)n[a]=this._pathGlobalVertices[s++],n[a+1]=this._pathGlobalVertices[s++]},PathConstraint.prototype._computeBezierCurve=function(t,e,i,n,a){var s=this._armature.armatureData.parent.intArray[t.geometry.offset+0],o=this._positions,h=this._spaces,l=t.closed,c=Array(),p=2*s,d=p/6,u=-1,m=this.position;o.length=3*e+2;var f=0;if(t.constantSpeed){l?(p+=2,c.length=s,this._computeVertices(2,p-4,0,c),this._computeVertices(0,2,p-4,c),c[p-2]=c[0],c[p-1]=c[1]):(d--,p-=4,c.length=p,this._computeVertices(2,p,0,c));var y=new Array(d);f=0;for(var g,P,_,v,b,T,S,x,w=c[0],D=c[1],C=0,I=0,k=0,B=0,E=0,A=0,O=(j=0,2);j<d;j++,O+=6)C=c[O],I=c[O+1],k=c[O+2],B=c[O+3],b=2*(g=.1875*(w-2*C+k))+(_=.09375*(3*(C-k)-w+(E=c[O+4]))),T=2*(P=.1875*(D-2*I+B))+(v=.09375*(3*(I-B)-D+(A=c[O+5]))),S=.75*(C-w)+g+.16666667*_,x=.75*(I-D)+P+.16666667*v,f+=Math.sqrt(S*S+x*x),S+=b,x+=T,b+=_,T+=v,f+=Math.sqrt(S*S+x*x),S+=b,x+=T,f+=Math.sqrt(S*S+x*x),S+=b+_,x+=T+v,f+=Math.sqrt(S*S+x*x),y[j]=f,w=E,D=A;if(n&&(m*=f),a)for(j=0;j<e;j++)h[j]*=f;for(var M=this._segments,R=0,F=(j=0,V=0,W=0,0);j<e;j++,V+=3){var N=m+=h[j];if(l)(N%=f)<0&&(N+=f),W=0;else{if(N<0)continue;if(N>f)continue}for(;;W++){var L=y[W];if(!(N>L)){if(0===W)N/=L;else N=(N-(U=y[W-1]))/(L-U);break}}if(W!==u){u=W;var H=6*W;for(w=c[H],D=c[H+1],C=c[H+2],I=c[H+3],k=c[H+4],B=c[H+5],b=2*(g=.03*(w-2*C+k))+(_=.006*(3*(C-k)-w+(E=c[H+6]))),T=2*(P=.03*(D-2*I+B))+(v=.006*(3*(I-B)-D+(A=c[H+7]))),S=.3*(C-w)+g+.16666667*_,x=.3*(I-D)+P+.16666667*v,R=Math.sqrt(S*S+x*x),M[0]=R,H=1;H<8;H++)S+=b,x+=T,b+=_,T+=v,R+=Math.sqrt(S*S+x*x),M[H]=R;S+=b,x+=T,R+=Math.sqrt(S*S+x*x),M[8]=R,S+=b+_,x+=T+v,R+=Math.sqrt(S*S+x*x),M[9]=R,F=0}for(N*=R;;F++){var G=M[F];if(!(N>G)){var U;if(0===F)N/=G;else N=F+(N-(U=M[F-1]))/(G-U);break}}this.addCurvePosition(.1*N,w,D,C,I,k,B,E,A,o,V,i)}}else{var z=t.curveLengths;if(f=z[d-=l?1:2],n&&(m*=f),a)for(var j=0;j<e;j++)h[j]*=f;c.length=8;for(var j=0,V=0,W=0;j<e;j++,V+=3){if(m+=h[j],l)(m%=f)<0&&(m+=f),W=0;else{if(m<0)continue;if(m>f)continue}for(var Y=0;;W++){var K=z[W];if(!(m>K)){if(0===W)Y=m/K;else{var q=z[W-1];Y=(m-q)/(K-q)}break}}W!==u&&(u=W,l&&W===d?(this._computeVertices(p-4,4,0,c),this._computeVertices(0,4,4,c)):this._computeVertices(6*W+2,8,0,c)),this.addCurvePosition(Y,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],o,V,i)}}},PathConstraint.prototype.addCurvePosition=function(t,e,i,n,a,s,o,h,l,c,p,d){if(0===t)return c[p]=e,c[p+1]=i,void(c[p+2]=0);if(1===t)return c[p]=h,c[p+1]=l,void(c[p+2]=0);var u=1-t,m=u*u,f=t*t,y=m*u,g=m*t*3,P=u*f*3,_=t*f,v=y*e+g*n+P*s+_*h,b=y*i+g*a+P*o+_*l;c[p]=v,c[p+1]=b,c[p+2]=d?Math.atan2(b-(y*i+g*a+P*o),v-(y*e+g*n+P*s)):0},PathConstraint.prototype.init=function(t,e){this._constraintData=t,this._armature=e;var i=t;this.pathOffset=i.pathDisplayData.geometry.offset,this.position=i.position,this.spacing=i.spacing,this.rotateOffset=i.rotateOffset,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this._root=this._armature.getBone(i.root.name),this._target=this._armature.getBone(i.target.name),this._pathSlot=this._armature.getSlot(i.pathSlot.name);for(var n=0,a=i.bones.length;n<a;n++){var s=this._armature.getBone(i.bones[n].name);null!==s&&this._bones.push(s)}2===i.rotateMode&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},PathConstraint.prototype.update=function(){var e=this._pathSlot;if(null!==e._geometryData&&e._geometryData.offset===this.pathOffset){var i=this._constraintData,n=!1;if(this._root._childrenTransformDirty?(this._updatePathVertices(e._geometryData),n=!0):(e._verticesDirty||e._isBonesUpdate())&&(this._updatePathVertices(e._geometryData),e._verticesDirty=!1,n=!0),n||this.dirty){var a=i.positionMode,s=i.spacingMode,o=i.rotateMode,h=this._bones,l=0===s,c=2===o,p=0===o,d=h.length,u=p?d:d+1,m=this.spacing,f=this._spaces;if(f.length=u,c||l){f[0]=0;for(var y=0,g=u-1;y<g;y++){(B=h[y]).updateByConstraint();var P=B._boneData.length,_=P*(E=B.globalTransformMatrix).a,v=P*E.b,b=Math.sqrt(_*_+v*v);c&&(this._boneLengths[y]=b),f[y+1]=(P+m)*b/P}}else for(y=0;y<u;y++)f[y]=m;this._computeBezierCurve(e._displayFrame.rawDisplayData,u,p,1===a,2===s);var T,S=this._positions,x=this.rotateOffset,w=S[0],D=S[1];if(0===x)T=1===o;else if(T=!1,null!==(B=e.parent))x*=(E=B.globalTransformMatrix).a*E.d-E.b*E.c>0?t.Transform.DEG_RAD:-t.Transform.DEG_RAD;for(var C=this.rotateMix,I=this.translateMix,k=(y=0,3);y<d;y++,k+=3){var B,E;(B=h[y]).updateByConstraint(),(E=B.globalTransformMatrix).tx+=(w-E.tx)*I,E.ty+=(D-E.ty)*I;var A=(_=S[k])-w,O=(v=S[k+1])-D;if(c){var M=this._boneLengths[y],R=(Math.sqrt(A*A+O*O)/M-1)*C+1;E.a*=R,E.b*=R}if(w=_,D=v,C>0){var F=E.a,N=E.b,L=E.c,H=E.d,G=void 0,U=void 0,z=void 0;if(G=p?S[k-1]:Math.atan2(O,A),G-=Math.atan2(N,F),T){U=Math.cos(G),z=Math.sin(G);var j=B._boneData.length;w+=(j*(U*F-z*N)-A)*C,D+=(j*(z*F+U*N)-O)*C}else G+=x;G>t.Transform.PI?G-=t.Transform.PI_D:G<-t.Transform.PI&&(G+=t.Transform.PI_D),G*=C,U=Math.cos(G),z=Math.sin(G),E.a=U*F-z*N,E.b=z*F+U*N,E.c=U*L-z*H,E.d=z*L+U*H}B.global.fromMatrix(E)}this.dirty=!1}}},PathConstraint.prototype.invalidUpdate=function(){},PathConstraint}(e);t.PathConstraint=n}(c||(c={})),function(t){var e=function(){function WorldClock(t){void 0===t&&(t=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=t,this._systemTime=.001*(new Date).getTime()}return WorldClock.prototype.advanceTime=function(t){t!=t&&(t=0);var e=.001*Date.now();if(t<0&&(t=e-this._systemTime),this._systemTime=e,1!==this.timeScale&&(t*=this.timeScale),0!==t){t<0?this.time-=t:this.time+=t;for(var i=0,n=0,a=this._animatebles.length;i<a;++i){var s=this._animatebles[i];null!==s?(n>0&&(this._animatebles[i-n]=s,this._animatebles[i]=null),s.advanceTime(t)):n++}if(n>0){for(a=this._animatebles.length;i<a;++i){var o=this._animatebles[i];null!==o?this._animatebles[i-n]=o:n++}this._animatebles.length-=n}}},WorldClock.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.clock;return e===this},WorldClock.prototype.add=function(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},WorldClock.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},WorldClock.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},Object.defineProperty(WorldClock.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock!==t&&(null!==this._clock&&this._clock.remove(this),this._clock=t,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),WorldClock}();t.WorldClock=e}(c||(c={})),function(t){var e=function(e){function Animation(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationNames=[],t._animationStates=[],t._animations={},t._blendStates={},t._animationConfig=null,t}return a(Animation,e),Animation.toString=function(){return"[class dragonBones.Animation]"},Animation.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++){e[t].returnToPool()}for(var i in this._animations)delete this._animations[i];for(var i in this._blendStates){var n=this._blendStates[i];for(var a in n)n[a].returnToPool();delete this._blendStates[i]}null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},Animation.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++){null===(c=i[e])._parent&&(c.layer===t.layer&&c.fadeOut(t.fadeOutTime,t.pauseFadeOut))}break;case 2:for(var n=0,a=this._animationStates;n<a.length;n++){null===(c=a[n])._parent&&(c.group===t.group&&c.fadeOut(t.fadeOutTime,t.pauseFadeOut))}break;case 3:for(var s=0,o=this._animationStates;s<o.length;s++){null===(c=o[s])._parent&&(c.layer===t.layer&&c.group===t.group&&c.fadeOut(t.fadeOutTime,t.pauseFadeOut))}break;case 4:for(var h=0,l=this._animationStates;h<l.length;h++){var c;null===(c=l[h])._parent&&c.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}},Animation.prototype.init=function(e){null===this._armature&&(this._armature=e,this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig))},Animation.prototype.advanceTime=function(t){for(var e in t<0&&(t=-t),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(t*=this._inheritTimeScale),this._blendStates){var i=this._blendStates[e];for(var n in i)i[n].reset()}var a=this._animationStates.length;if(1===a)if((g=this._animationStates[0])._fadeState>0&&g._subFadeState>0)this._armature._dragonBones.bufferObject(g),this._animationStates.length=0,this._lastAnimationState=null;else{var s=g.animationData,o=s.cacheFrameRate;if(this._animationDirty&&o>0){this._animationDirty=!1;for(var h=0,l=this._armature.getBones();h<l.length;h++){var c=l[h];c._cachedFrameIndices=s.getBoneCachedFrameIndices(c.name)}for(var p=0,d=this._armature.getSlots();p<d.length;p++){var u=d[p];if(u.displayFrameCount>0){var m=u.getDisplayFrameAt(0).rawDisplayData;if(null!==m&&m.parent===this._armature.armatureData.defaultSkin){u._cachedFrameIndices=s.getSlotCachedFrameIndices(u.name);continue}}u._cachedFrameIndices=null}}g.advanceTime(t,o)}else if(a>1){for(var f=0,y=0;f<a;++f){var g;(g=this._animationStates[f])._fadeState>0&&g._subFadeState>0?(y++,this._armature._dragonBones.bufferObject(g),this._animationDirty=!0,this._lastAnimationState===g&&(this._lastAnimationState=null)):(y>0&&(this._animationStates[f-y]=g),g.advanceTime(t,0)),f===a-1&&y>0&&(this._animationStates.length-=y,null===this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},Animation.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++){e[t].returnToPool()}this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},Animation.prototype.stop=function(t){if(void 0===t&&(t=null),null!==t)null!==(n=this.getState(t))&&n.stop();else for(var e=0,i=this._animationStates;e<i.length;e++){var n;(n=i[e]).stop()}},Animation.prototype.playConfig=function(e){var i=e.animation;if(!(i in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+i),null;var n=this._animations[i];if(5===e.fadeOutMode)for(var a=0,s=this._animationStates;a<s.length;a++){var o=s[a];if(o._fadeState<1&&o.layer===e.layer&&o.animationData===n)return o}0===this._animationStates.length?e.fadeInTime=0:e.fadeInTime<0&&(e.fadeInTime=n.fadeInTime),e.fadeOutTime<0&&(e.fadeOutTime=e.fadeInTime),e.timeScale<=-100&&(e.timeScale=1/n.scale),n.frameCount>0?(e.position<0?(e.position%=n.duration,e.position=n.duration-e.position):e.position===n.duration?e.position-=1e-6:e.position>n.duration&&(e.position%=n.duration),e.duration>0&&e.position+e.duration>n.duration&&(e.duration=n.duration-e.position),e.playTimes<0&&(e.playTimes=n.playTimes)):(e.playTimes=1,e.position=0,e.duration>0&&(e.duration=0)),0===e.duration&&(e.duration=-1),this._fadeOut(e);var h=t.BaseObject.borrowObject(t.AnimationState);if(h.init(this._armature,n,e),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){for(var l=!1,c=0,p=this._animationStates.length;c<p;++c){if(h.layer>this._animationStates[c].layer){l=!0,this._animationStates.splice(c,0,h);break}if(c!==p-1&&h.layer>this._animationStates[c+1].layer){l=!0,this._animationStates.splice(c+1,0,h);break}}l||this._animationStates.push(h)}else this._animationStates.push(h);for(var d=0,u=this._armature.getSlots();d<u.length;d++){var m=u[d].childArmature;null!==m&&m.inheritAnimation&&m.animation.hasAnimation(i)&&null===m.animation.getState(i)&&m.animation.fadeIn(i)}for(var f in n.animationTimelines){var y=this.fadeIn(f,0,1,h.layer,"",5);if(null!==y){var g=n.animationTimelines[f];y.actionEnabled=!1,y.resetToPose=!1,y.stop(),h.addState(y,g);var P=this._animationStates.indexOf(h),_=this._animationStates.indexOf(y);_<P&&(this._animationStates.splice(P,1),this._animationStates.splice(_,0,h))}}return this._lastAnimationState=h,h},Animation.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==t?t:"",null!==t&&t.length>0)this.playConfig(this._animationConfig);else if(null===this._lastAnimationState){var i=this._armature.armatureData.defaultAnimation;null!==i&&(this._animationConfig.animation=i.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},Animation.prototype.fadeIn=function(t,e,i,n,a,s){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===n&&(n=0),void 0===a&&(a=null),void 0===s&&(s=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=i,this._animationConfig.layer=n,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==a?a:"",this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var n=t in this._animations?this._animations[t]:null;return null!==n&&(this._animationConfig.position=n.frameCount>0?n.duration*e/n.frameCount:0),this.playConfig(this._animationConfig)},Animation.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var n=t in this._animations?this._animations[t]:null;return null!==n&&(this._animationConfig.position=n.duration*(e>0?e:0)),this.playConfig(this._animationConfig)},Animation.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return null!==i&&i.stop(),i},Animation.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return null!==i&&i.stop(),i},Animation.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return null!==i&&i.stop(),i},Animation.prototype.getBlendState=function(e,i,n){e in this._blendStates||(this._blendStates[e]={});var a=this._blendStates[e];i in a||((a[i]=t.BaseObject.borrowObject(t.BlendState)).target=n);return a[i]},Animation.prototype.getState=function(t,e){void 0===e&&(e=-1);for(var i=this._animationStates.length;i--;){var n=this._animationStates[i];if(n.name===t&&(e<0||n.layer===e))return n}return null},Animation.prototype.hasAnimation=function(t){return t in this._animations},Animation.prototype.getStates=function(){return this._animationStates},Object.defineProperty(Animation.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){if(e[t].isPlaying)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){if(!e[t].isCompleted)return!1}return this._animationStates.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){for(var e in this._animationNames.length=0,this._animations)delete this._animations[e];for(var e in t)this._animationNames.push(e),this._animations[e]=t[e]}},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(Animation.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),Animation}(t.BaseObject);t.Animation=e}(c||(c={})),function(t){var e=function(e){function AnimationState(){var t=null!==e&&e.apply(this,arguments)||this;return t._boneMask=[],t._boneTimelines=[],t._boneBlendTimelines=[],t._slotTimelines=[],t._slotBlendTimelines=[],t._constraintTimelines=[],t._animationTimelines=[],t._poseTimelines=[],t._actionTimeline=null,t._zOrderTimeline=null,t}return a(AnimationState,e),AnimationState.toString=function(){return"[class dragonBones.AnimationState]"},AnimationState.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++){(u=e[t]).returnToPool()}for(var i=0,n=this._boneBlendTimelines;i<n.length;i++){(u=n[i]).returnToPool()}for(var a=0,s=this._slotTimelines;a<s.length;a++){(u=s[a]).returnToPool()}for(var o=0,h=this._slotBlendTimelines;o<h.length;o++){(u=h[o]).returnToPool()}for(var l=0,c=this._constraintTimelines;l<c.length;l++){(u=c[l]).returnToPool()}for(var p=0,d=this._animationTimelines;p<d.length;p++){var u,m=(u=d[p]).target;m._parent===this&&(m._fadeState=1,m._subFadeState=1,m._parent=null),u.returnToPool()}null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additive=!1,this.displayControl=!1,this.resetToPose=!1,this.blendType=0,this.playTimes=1,this.layer=0,this.timeScale=1,this._weight=1,this.parameterX=0,this.parameterY=0,this.positionX=0,this.positionY=0,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._boneBlendTimelines.length=0,this._slotTimelines.length=0,this._slotBlendTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._activeChildA=null,this._activeChildB=null,this._parent=null},AnimationState.prototype._updateTimelines=function(){for(var e=0,i=this._armature._constraints;e<i.length;e++){var n=i[e],a=this._animationData.getConstraintTimelines(n.name);if(null!==a)for(var s=0,o=a;s<o.length;s++){var h=o[s];switch(h.type){case 30:(l=t.BaseObject.borrowObject(t.IKConstraintTimelineState)).target=n,l.init(this._armature,this,h),this._constraintTimelines.push(l)}}else if(this.resetToPose){var l;(l=t.BaseObject.borrowObject(t.IKConstraintTimelineState)).target=n,l.init(this._armature,this,null),this._constraintTimelines.push(l),this._poseTimelines.push(l)}}},AnimationState.prototype._updateBoneAndSlotTimelines=function(){for(var e={},n=0,a=this._boneTimelines;n<a.length;n++){(p=(_=a[n]).target.target.name)in e||(e[p]=[]),e[p].push(_)}for(var s=0,o=this._boneBlendTimelines;s<o.length;s++){(p=(_=o[s]).target.target.name)in e||(e[p]=[]),e[p].push(_)}for(var h=0,l=this._armature.getBones();h<l.length;h++){var c=l[h],p=c.name;if(this.containsBoneMask(p))if(p in e)delete e[p];else{var d=this._animationData.getBoneTimelines(p),u=this._armature.animation.getBlendState(i.BONE_TRANSFORM,c.name,c);if(null!==d)for(var m=0,f=d;m<f.length;m++){switch((M=f[m]).type){case 10:(_=t.BaseObject.borrowObject(t.BoneAllTimelineState)).target=u,_.init(this._armature,this,M),this._boneTimelines.push(_);break;case 11:(_=t.BaseObject.borrowObject(t.BoneTranslateTimelineState)).target=u,_.init(this._armature,this,M),this._boneTimelines.push(_);break;case 12:(_=t.BaseObject.borrowObject(t.BoneRotateTimelineState)).target=u,_.init(this._armature,this,M),this._boneTimelines.push(_);break;case 13:(_=t.BaseObject.borrowObject(t.BoneScaleTimelineState)).target=u,_.init(this._armature,this,M),this._boneTimelines.push(_);break;case 60:(_=t.BaseObject.borrowObject(t.AlphaTimelineState)).target=this._armature.animation.getBlendState(i.BONE_ALPHA,c.name,c),_.init(this._armature,this,M),this._boneBlendTimelines.push(_);break;case 50:(_=t.BaseObject.borrowObject(t.SurfaceTimelineState)).target=this._armature.animation.getBlendState(i.SURFACE,c.name,c),_.init(this._armature,this,M),this._boneBlendTimelines.push(_)}}else if(this.resetToPose){if(0===c._boneData.type)(_=t.BaseObject.borrowObject(t.BoneAllTimelineState)).target=u,_.init(this._armature,this,null),this._boneTimelines.push(_),this._poseTimelines.push(_);else(_=t.BaseObject.borrowObject(t.SurfaceTimelineState)).target=this._armature.animation.getBlendState(i.SURFACE,c.name,c),_.init(this._armature,this,null),this._boneBlendTimelines.push(_),this._poseTimelines.push(_)}}}for(var y in e)for(var g=0,P=e[y];g<P.length;g++){var _=P[g];(W=this._boneTimelines.indexOf(_))>=0&&(this._boneTimelines.splice(W,1),_.returnToPool()),(W=this._boneBlendTimelines.indexOf(_))>=0&&(this._boneBlendTimelines.splice(W,1),_.returnToPool())}for(var v={},b=[],T=0,S=this._slotTimelines;T<S.length;T++){(p=(_=S[T]).target.name)in v||(v[p]=[]),v[p].push(_)}for(var x=0,w=this._slotBlendTimelines;x<w.length;x++){(p=(_=w[x]).target.target.name)in v||(v[p]=[]),v[p].push(_)}for(var D=0,C=this._armature.getSlots();D<C.length;D++){var I=C[D],k=I.parent.name;if(this.containsBoneMask(k))if((p=I.name)in v)delete v[p];else{var B=!1,E=!1;if(b.length=0,null!==(d=this._animationData.getSlotTimelines(p)))for(var A=0,O=d;A<O.length;A++){var M;switch((M=O[A]).type){case 20:(_=t.BaseObject.borrowObject(t.SlotDisplayTimelineState)).target=I,_.init(this._armature,this,M),this._slotTimelines.push(_),B=!0;break;case 23:(_=t.BaseObject.borrowObject(t.SlotZIndexTimelineState)).target=this._armature.animation.getBlendState(i.SLOT_Z_INDEX,I.name,I),_.init(this._armature,this,M),this._slotBlendTimelines.push(_);break;case 21:(_=t.BaseObject.borrowObject(t.SlotColorTimelineState)).target=I,_.init(this._armature,this,M),this._slotTimelines.push(_),E=!0;break;case 22:var R=this._animationData.parent.parent,F=R.timelineArray,N=this._animationData.frameIntOffset+F[M.offset+3],L=R.frameIntArray[N+0];L<0&&(L+=65536);for(var H=0,G=I.displayFrameCount;H<G;++H){if(null!==(z=(U=I.getDisplayFrameAt(H)).getGeometryData())&&z.offset===L){(_=t.BaseObject.borrowObject(t.DeformTimelineState)).target=this._armature.animation.getBlendState(i.SLOT_DEFORM,U.rawDisplayData.name,I),_.displayFrame=U,_.init(this._armature,this,M),this._slotBlendTimelines.push(_),U.updateDeformVertices(),b.push(L);break}}break;case 24:(_=t.BaseObject.borrowObject(t.AlphaTimelineState)).target=this._armature.animation.getBlendState(i.SLOT_ALPHA,I.name,I),_.init(this._armature,this,M),this._slotBlendTimelines.push(_)}}if(this.resetToPose){if(!B)(_=t.BaseObject.borrowObject(t.SlotDisplayTimelineState)).target=I,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_);if(!E)(_=t.BaseObject.borrowObject(t.SlotColorTimelineState)).target=I,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_);for(H=0,G=I.displayFrameCount;H<G;++H){var U,z;if(0!==(U=I.getDisplayFrameAt(H)).deformVertices.length)if(null!==(z=U.getGeometryData())&&b.indexOf(z.offset)<0)(_=t.BaseObject.borrowObject(t.DeformTimelineState)).displayFrame=U,_.target=this._armature.animation.getBlendState(i.SLOT_DEFORM,I.name,I),_.init(this._armature,this,null),this._slotBlendTimelines.push(_),this._poseTimelines.push(_)}}}}for(var y in v)for(var j=0,V=v[y];j<V.length;j++){var W;_=V[j];(W=this._slotTimelines.indexOf(_))>=0&&(this._slotTimelines.splice(W,1),_.returnToPool()),(W=this._slotBlendTimelines.indexOf(_))>=0&&(this._slotBlendTimelines.splice(W,1),_.returnToPool())}},AnimationState.prototype._advanceFadeTime=function(e){var i=this._fadeState>0;if(this._subFadeState<0&&(this._subFadeState=0,null===this._parent&&this.actionEnabled)){var n=i?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(n))(a=t.BaseObject.borrowObject(t.EventObject)).type=n,a.armature=this._armature,a.animationState=this,this._armature._dragonBones.bufferEvent(a)}if((e<0&&(e=-e),this._fadeTime+=e,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=i?0:1):this._fadeTime>0?this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=i?1:0,this._subFadeState>0)&&(i||(this._playheadState|=1,this._fadeState=0),null===this._parent&&this.actionEnabled)){var a;n=i?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(n))(a=t.BaseObject.borrowObject(t.EventObject)).type=n,a.armature=this._armature,a.animationState=this,this._armature._dragonBones.bufferEvent(a)}},AnimationState.prototype.init=function(e,i,n){if(null===this._armature){if(this._armature=e,this._animationData=i,this.resetToPose=n.resetToPose,this.additive=n.additive,this.displayControl=n.displayControl,this.actionEnabled=n.actionEnabled,this.blendType=i.blendType,this.layer=n.layer,this.playTimes=n.playTimes,this.timeScale=n.timeScale,this.fadeTotalTime=n.fadeInTime,this.autoFadeOutTime=n.autoFadeOutTime,this.name=n.name.length>0?n.name:n.animation,this.group=n.group,this._weight=n.weight,n.pauseFadeIn?this._playheadState=2:this._playheadState=3,n.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==n.position?this.timeScale>=0?this._time=n.position:this._time=n.position-this._duration:this._time=0):(this._position=n.position,this._duration=n.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),n.boneMask.length>0){this._boneMask.length=n.boneMask.length;for(var a=0,s=this._boneMask.length;a<s;++a)this._boneMask[a]=n.boneMask[a]}this._actionTimeline=t.BaseObject.borrowObject(t.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},AnimationState.prototype.advanceTime=function(t,e){0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(t),3===this._playheadState&&(1!==this.timeScale&&(t*=this.timeScale),this._time+=t),0!==this._timelineDirty&&(2===this._timelineDirty&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines());var i=0!==this._fadeState||0===this._subFadeState,n=0===this._fadeState&&e>0,a=!0,s=!0,o=this._time;if(this._weightResult=this._weight*this._fadeProgress,null!==this._parent&&(this._weightResult*=this._parent._weightResult),this._actionTimeline.playState<=0&&this._actionTimeline.update(o),0!==this._weight){if(n){var h=2*e;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*h)/h}if(null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(o),n){var l=Math.floor(this._actionTimeline.currentTime*e);this._armature._cacheFrameIndex===l?(a=!1,s=!1):(this._armature._cacheFrameIndex=l,this._animationData.cachedFrames[l]?s=!1:this._animationData.cachedFrames[l]=!0)}if(a){var c=!1,p=null;if(s)for(var d=0,u=this._boneTimelines.length;d<u;++d){if((w=this._boneTimelines[d]).playState<=0&&w.update(o),w.target!==p)if(c=(y=w.target).update(this),p=y,1===y.dirty){var m=y.target.animationPose;m.x=0,m.y=0,m.rotation=0,m.skew=0,m.scaleX=1,m.scaleY=1}c&&w.blend(i)}for(d=0,u=this._boneBlendTimelines.length;d<u;++d){(w=this._boneBlendTimelines[d]).playState<=0&&w.update(o),w.target.update(this)&&w.blend(i)}if(this.displayControl)for(d=0,u=this._slotTimelines.length;d<u;++d){if((w=this._slotTimelines[d]).playState<=0){var f=w.target.displayController;null!==f&&f!==this.name&&f!==this.group||w.update(o)}}for(d=0,u=this._slotBlendTimelines.length;d<u;++d){if((w=this._slotBlendTimelines[d]).playState<=0){var y=w.target;w.update(o),y.update(this)&&w.blend(i)}}for(d=0,u=this._constraintTimelines.length;d<u;++d){(w=this._constraintTimelines[d]).playState<=0&&w.update(o)}if(this._animationTimelines.length>0){var g=100,P=100,_=null,v=null;for(d=0,u=this._animationTimelines.length;d<u;++d){if((w=this._animationTimelines[d]).playState<=0&&w.update(o),1===this.blendType){var b=w.target,T=this.parameterX-b.positionX;T>=0?T<g&&(g=T,_=b):-T<P&&(P=-T,v=b)}}null!==_&&(this._activeChildA!==_&&(null!==this._activeChildA&&(this._activeChildA.weight=0),this._activeChildA=_,this._activeChildA.activeTimeline()),this._activeChildB!==v&&(null!==this._activeChildB&&(this._activeChildB.weight=0),this._activeChildB=v),_.weight=P/(g+P),v&&(v.weight=1-_.weight))}}if(0===this._fadeState){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(var S=0,x=this._poseTimelines;S<x.length;S++){var w=x[S],D=this._boneTimelines.indexOf(w);D>=0?(this._boneTimelines.splice(D,1),w.returnToPool()):(D=this._boneBlendTimelines.indexOf(w))>=0?(this._boneBlendTimelines.splice(D,1),w.returnToPool()):(D=this._slotTimelines.indexOf(w))>=0?(this._slotTimelines.splice(D,1),w.returnToPool()):(D=this._slotBlendTimelines.indexOf(w))>=0?(this._slotBlendTimelines.splice(D,1),w.returnToPool()):(D=this._constraintTimelines.indexOf(w))>=0&&(this._constraintTimelines.splice(D,1),w.returnToPool())}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}},AnimationState.prototype.play=function(){this._playheadState=3},AnimationState.prototype.stop=function(){this._playheadState&=1},AnimationState.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),t<0&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,n=this._boneTimelines;i<n.length;i++){(f=n[i]).fadeOut()}for(var a=0,s=this._boneBlendTimelines;a<s.length;a++){(f=s[a]).fadeOut()}for(var o=0,h=this._slotTimelines;o<h.length;o++){(f=h[o]).fadeOut()}for(var l=0,c=this._slotBlendTimelines;l<c.length;l++){(f=c[l]).fadeOut()}for(var p=0,d=this._constraintTimelines;p<d.length;p++){(f=d[p]).fadeOut()}for(var u=0,m=this._animationTimelines;u<m.length;u++){var f;(f=m[u]).fadeOut(),f.target.fadeOut(999999,!0)}}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},AnimationState.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||this._boneMask.indexOf(t)>=0},AnimationState.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(null!==i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var n=0,a=this._armature.getBones();n<a.length;n++){var s=a[n];this._boneMask.indexOf(s.name)<0&&i.contains(s)&&this._boneMask.push(s.name)}this._timelineDirty=1}},AnimationState.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var n=this._armature.getBone(t);if(null!==n){var a=this._armature.getBones();if(this._boneMask.length>0)for(var s=0,o=a;s<o.length;s++){var h=o[s],l=this._boneMask.indexOf(h.name);l>=0&&n.contains(h)&&this._boneMask.splice(l,1)}else for(var c=0,p=a;c<p.length;c++){(h=p[c])!==n&&(n.contains(h)||this._boneMask.push(h.name))}}}this._timelineDirty=1},AnimationState.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},AnimationState.prototype.addState=function(e,i){if(void 0===i&&(i=null),null!==i)for(var n=0,a=i;n<a.length;n++){var s=a[n];switch(s.type){case 40:if((h=t.BaseObject.borrowObject(t.AnimationProgressTimelineState)).target=e,h.init(this._armature,this,s),this._animationTimelines.push(h),0!==this.blendType){var o=s;e.positionX=o.x,e.positionY=o.y,e.weight=0}e._parent=this,this.resetToPose=!1;break;case 41:(h=t.BaseObject.borrowObject(t.AnimationWeightTimelineState)).target=e,h.init(this._armature,this,s),this._animationTimelines.push(h);break;case 42:var h;(h=t.BaseObject.borrowObject(t.AnimationParametersTimelineState)).target=e,h.init(this._armature,this,s),this._animationTimelines.push(h)}}null===e._parent&&(e._parent=this)},AnimationState.prototype.activeTimeline=function(){for(var t=0,e=this._slotTimelines;t<e.length;t++){var i=e[t];i.dirty=!0,i.currentTime=-1}},Object.defineProperty(AnimationState.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isPlaying",{get:function(){return 0!=(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+e*this._duration)<0&&(t+=this._duration),this.playTimes>0&&e===this.playTimes-1&&t===this._duration&&null===this._parent&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var i=0,n=this._boneTimelines;i<n.length;i++){n[i].playState=-1}for(var a=0,s=this._slotTimelines;a<s.length;a++){s[a].playState=-1}}},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"weight",{get:function(){return this._weight},set:function(t){if(this._weight!==t){this._weight=t;for(var e=0,i=this._boneTimelines;e<i.length;e++){i[e].dirty=!0}for(var n=0,a=this._boneBlendTimelines;n<a.length;n++){a[n].dirty=!0}for(var s=0,o=this._slotBlendTimelines;s<o.length;s++){o[s].dirty=!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(AnimationState.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),AnimationState}(t.BaseObject);t.AnimationState=e;var i=function(t){function BlendState(){return null!==t&&t.apply(this,arguments)||this}return a(BlendState,t),BlendState.toString=function(){return"[class dragonBones.BlendState]"},BlendState.prototype._onClear=function(){this.reset(),this.target=null},BlendState.prototype.update=function(t){var e=t.layer,i=t._weightResult;if(this.dirty>0){if(this.leftWeight>0){if(this.layer!==e){if(this.layerWeight>=this.leftWeight)return this.dirty++,this.layer=e,this.leftWeight=0,this.blendWeight=0,!1;this.layer=e,this.leftWeight-=this.layerWeight,this.layerWeight=0}return i*=this.leftWeight,this.dirty++,this.blendWeight=i,this.layerWeight+=this.blendWeight,!0}return!1}return this.dirty++,this.layer=e,this.leftWeight=1,this.blendWeight=i,this.layerWeight=i,!0},BlendState.prototype.reset=function(){this.dirty=0,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},BlendState.BONE_TRANSFORM="boneTransform",BlendState.BONE_ALPHA="boneAlpha",BlendState.SURFACE="surface",BlendState.SLOT_DEFORM="slotDeform",BlendState.SLOT_ALPHA="slotAlpha",BlendState.SLOT_Z_INDEX="slotZIndex",BlendState}(t.BaseObject);t.BlendState=i}(c||(c={})),function(t){var e=function(t){function TimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(TimelineState,t),TimelineState.prototype._onClear=function(){this.dirty=!1,this.playState=-1,this.currentPlayTimes=0,this.currentTime=-1,this.target=null,this._isTween=!1,this._valueOffset=0,this._frameValueOffset=0,this._frameOffset=0,this._frameRate=0,this._frameCount=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._valueArray=null,this._timelineArray=null,this._frameIndices=null},TimelineState.prototype._setCurrentTime=function(t){var e=this.playState,i=this.currentPlayTimes,n=this.currentTime;if(null!==this._actionTimeline&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset){var a=this._animationState.playTimes,s=a*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationData.duration),a>0&&(t>=s||t<=-s)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=a,this.currentTime=t<0?0:1===this.playState?this._duration+1e-6:this._duration):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return(this.currentPlayTimes!==i||this.currentTime!==n)&&((e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==i)&&(this._frameIndex=-1),!0)},TimelineState.prototype.init=function(t,e,i){if(this._armature=t,this._animationState=e,this._timelineData=i,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState.animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,null!==this._timelineData){var n=this._animationData.parent.parent;this._frameArray=n.frameArray,this._timelineArray=n.timelineArray,this._frameIndices=n.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1]}},TimelineState.prototype.fadeOut=function(){this.dirty=!1},TimelineState.prototype.update=function(t){if(this._setCurrentTime(t)){if(this._frameCount>1){var e=Math.floor(this.currentTime*this._frameRate),i=this._frameIndices[this._timelineData.frameIndicesOffset+e];this._frameIndex!==i&&(this._frameIndex=i,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());(this._isTween||this.dirty)&&this._onUpdateFrame()}},TimelineState.prototype.blend=function(t){},TimelineState}(t.BaseObject);t.TimelineState=e;var i=function(t){function TweenTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(TweenTimelineState,t),TweenTimelineState._getEasingValue=function(t,e,i){var n=e;switch(t){case 3:n=Math.pow(e,2);break;case 4:n=1-Math.pow(1-e,2);break;case 5:n=.5*(1-Math.cos(e*Math.PI))}return(n-e)*i+e},TweenTimelineState._getEasingCurveValue=function(t,e,i,n){if(t<=0)return 0;if(t>=1)return 1;var a=i>0,s=i+1,o=Math.floor(t*s),h=0,l=0;return a?(h=0===o?0:e[n+o-1],l=o===s-1?1e4:e[n+o]):(h=e[n+o-1],l=e[n+o]),1e-4*(h+(l-h)*(t*s-o))},TweenTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenEasing=0,this._tweenProgress=0,this._valueScale=1},TweenTimelineState.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._isTween=0!==this._tweenType,this._isTween?2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]):this.dirty=!0,this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],e=this._frameArray[t]*this._frameRateR-this._framePosition;this._frameDurationR=e>0?1/e:0}else this.dirty=!0,this._isTween=!1},TweenTimelineState.prototype._onUpdateFrame=function(){this._isTween&&(this.dirty=!0,this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=TweenTimelineState._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=TweenTimelineState._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)))},TweenTimelineState}(e);t.TweenTimelineState=i;var n=function(t){function SingleValueTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(SingleValueTimelineState,t),SingleValueTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this._current=0,this._difference=0,this._result=0},SingleValueTimelineState.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._valueScale,i=this._valueArray,n=this._valueOffset+this._frameValueOffset+this._frameIndex;if(this._isTween){var a=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:n+1;1===e?(this._current=i[n],this._difference=i[a]-this._current):(this._current=i[n]*e,this._difference=i[a]*e-this._current)}else this._result=i[n]*e}else this._result=0},SingleValueTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._isTween&&(this._result=this._current+this._difference*this._tweenProgress)},SingleValueTimelineState}(i);t.SingleValueTimelineState=n;var s=function(t){function DoubleValueTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(DoubleValueTimelineState,t),DoubleValueTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this._currentA=0,this._currentB=0,this._differenceA=0,this._differenceB=0,this._resultA=0,this._resultB=0},DoubleValueTimelineState.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._valueScale,i=this._valueArray,n=this._valueOffset+this._frameValueOffset+2*this._frameIndex;if(this._isTween){var a=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:n+2;1===e?(this._currentA=i[n],this._currentB=i[n+1],this._differenceA=i[a]-this._currentA,this._differenceB=i[a+1]-this._currentB):(this._currentA=i[n]*e,this._currentB=i[n+1]*e,this._differenceA=i[a]*e-this._currentA,this._differenceB=i[a+1]*e-this._currentB)}else this._resultA=i[n]*e,this._resultB=i[n+1]*e}else this._resultA=0,this._resultB=0},DoubleValueTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._isTween&&(this._resultA=this._currentA+this._differenceA*this._tweenProgress,this._resultB=this._currentB+this._differenceB*this._tweenProgress)},DoubleValueTimelineState}(i);t.DoubleValueTimelineState=s;var o=function(t){function MutilpleValueTimelineState(){var e=null!==t&&t.apply(this,arguments)||this;return e._rd=[],e}return a(MutilpleValueTimelineState,t),MutilpleValueTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this._valueCount=0,this._rd.length=0},MutilpleValueTimelineState.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);var e=this._valueCount,i=this._rd;if(null!==this._timelineData){var n=this._valueScale,a=this._valueArray,s=this._valueOffset+this._frameValueOffset+this._frameIndex*e;if(this._isTween){var o=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:s+e;if(1===n)for(var h=0;h<e;++h)i[e+h]=a[o+h]-a[s+h];else for(h=0;h<e;++h)i[e+h]=(a[o+h]-a[s+h])*n}else if(1===n)for(h=0;h<e;++h)i[h]=a[s+h];else for(h=0;h<e;++h)i[h]=a[s+h]*n}else for(h=0;h<e;++h)i[h]=0},MutilpleValueTimelineState.prototype._onUpdateFrame=function(){if(t.prototype._onUpdateFrame.call(this),this._isTween){var e=this._valueCount,i=this._valueScale,n=this._tweenProgress,a=this._valueArray,s=this._rd,o=this._valueOffset+this._frameValueOffset+this._frameIndex*e;if(1===i)for(var h=0;h<e;++h)s[h]=a[o+h]+s[e+h]*n;else for(h=0;h<e;++h)s[h]=a[o+h]*i+s[e+h]*n}},MutilpleValueTimelineState}(i);t.MutilpleValueTimelineState=o}(c||(c={})),function(t){var e=function(e){function ActionTimelineState(){return null!==e&&e.apply(this,arguments)||this}return a(ActionTimelineState,e),ActionTimelineState.toString=function(){return"[class dragonBones.ActionTimelineState]"},ActionTimelineState.prototype._onCrossFrame=function(e){var i=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var n=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+e],a=this._frameArray[n+1],s=this._animationData.parent.actions,o=0;o<a;++o){var h=s[this._frameArray[n+2+o]];if(0===h.type){(l=t.BaseObject.borrowObject(t.EventObject)).time=this._frameArray[n]/this._frameRate,l.animationState=this._animationState,t.EventObject.actionDataToInstance(h,l,this._armature),this._armature._bufferAction(l,!0)}else{var l,c=10===h.type?t.EventObject.FRAME_EVENT:t.EventObject.SOUND_EVENT;if(11===h.type||i.hasDBEventListener(c))(l=t.BaseObject.borrowObject(t.EventObject)).time=this._frameArray[n]/this._frameRate,l.animationState=this._animationState,t.EventObject.actionDataToInstance(h,l,this._armature),this._armature._dragonBones.bufferEvent(l)}}},ActionTimelineState.prototype._onArriveAtFrame=function(){},ActionTimelineState.prototype._onUpdateFrame=function(){},ActionTimelineState.prototype.update=function(e){var i=this.playState,n=this.currentPlayTimes,a=this.currentTime;if(this._setCurrentTime(e)){var s=null===this._animationState._parent&&this._animationState.actionEnabled,o=this._armature.eventDispatcher;if(i<0){if(this.playState===i)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),s&&o.hasDBEventListener(t.EventObject.START)){var h=t.BaseObject.borrowObject(t.EventObject);h.type=t.EventObject.START,h.armature=this._armature,h.animationState=this._animationState,this._armature._dragonBones.bufferEvent(h)}}var l=this._animationState.timeScale<0,c=null,p=null;if(s&&this.currentPlayTimes!==n&&(o.hasDBEventListener(t.EventObject.LOOP_COMPLETE)&&((c=t.BaseObject.borrowObject(t.EventObject)).type=t.EventObject.LOOP_COMPLETE,c.armature=this._armature,c.animationState=this._animationState),this.playState>0&&o.hasDBEventListener(t.EventObject.COMPLETE)&&((p=t.BaseObject.borrowObject(t.EventObject)).type=t.EventObject.COMPLETE,p.armature=this._armature,p.animationState=this._animationState)),this._frameCount>1){var d=this._timelineData,u=Math.floor(this.currentTime*this._frameRate),m=this._frameIndices[d.frameIndicesOffset+u];if(this._frameIndex!==m){var f=this._frameIndex;if(this._frameIndex=m,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[d.offset+5+this._frameIndex],l){if(f<0){var y=Math.floor(a*this._frameRate);f=this._frameIndices[d.frameIndicesOffset+y],this.currentPlayTimes===n&&f===m&&(f=-1)}for(;f>=0;){var g=this._animationData.frameOffset+this._timelineArray[d.offset+5+f],P=this._frameArray[g]/this._frameRate;if(this._position<=P&&P<=this._position+this._duration&&this._onCrossFrame(f),null!==c&&0===f&&(this._armature._dragonBones.bufferEvent(c),c=null),f>0?f--:f=this._frameCount-1,f===m)break}}else{if(f<0){y=Math.floor(a*this._frameRate);f=this._frameIndices[d.frameIndicesOffset+y];g=this._animationData.frameOffset+this._timelineArray[d.offset+5+f],P=this._frameArray[g]/this._frameRate;this.currentPlayTimes===n&&(a<=P?f>0?f--:f=this._frameCount-1:f===m&&(f=-1))}for(;f>=0;){f<this._frameCount-1?f++:f=0;g=this._animationData.frameOffset+this._timelineArray[d.offset+5+f],P=this._frameArray[g]/this._frameRate;if(this._position<=P&&P<=this._position+this._duration&&this._onCrossFrame(f),null!==c&&0===f&&(this._armature._dragonBones.bufferEvent(c),c=null),f===m)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData)){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];P=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===n?a<=P&&this._onCrossFrame(this._frameIndex):this._position<=P&&(l||null===c||(this._armature._dragonBones.bufferEvent(c),c=null),this._onCrossFrame(this._frameIndex))}null!==c&&this._armature._dragonBones.bufferEvent(c),null!==p&&this._armature._dragonBones.bufferEvent(p)}},ActionTimelineState.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._frameIndex=-1},ActionTimelineState}(t.TimelineState);t.ActionTimelineState=e;var i=function(t){function ZOrderTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(ZOrderTimelineState,t),ZOrderTimelineState.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},ZOrderTimelineState.prototype._onArriveAtFrame=function(){this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},ZOrderTimelineState.prototype._onUpdateFrame=function(){},ZOrderTimelineState}(t.TimelineState);t.ZOrderTimelineState=i;var n=function(e){function BoneAllTimelineState(){return null!==e&&e.apply(this,arguments)||this}return a(BoneAllTimelineState,e),BoneAllTimelineState.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},BoneAllTimelineState.prototype._onArriveAtFrame=function(){e.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._rd[2]=t.Transform.normalizeRadian(this._rd[2]),this._rd[3]=t.Transform.normalizeRadian(this._rd[3])),null===this._timelineData&&(this._rd[4]=1,this._rd[5]=1)},BoneAllTimelineState.prototype.init=function(t,i,n){e.prototype.init.call(this,t,i,n),this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=6,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneAllTimelineState.prototype.fadeOut=function(){this.dirty=!1,this._rd[2]=t.Transform.normalizeRadian(this._rd[2]),this._rd[3]=t.Transform.normalizeRadian(this._rd[3])},BoneAllTimelineState.prototype.blend=function(t){var e=this._armature.armatureData.scale,i=this._rd,n=this.target,a=n.target,s=n.blendWeight,o=a.animationPose;n.dirty>1?(o.x+=i[0]*s*e,o.y+=i[1]*s*e,o.rotation+=i[2]*s,o.skew+=i[3]*s,o.scaleX+=(i[4]-1)*s,o.scaleY+=(i[5]-1)*s):(o.x=i[0]*s*e,o.y=i[1]*s*e,o.rotation=i[2]*s,o.skew=i[3]*s,o.scaleX=(i[4]-1)*s+1,o.scaleY=(i[5]-1)*s+1),(t||this.dirty)&&(this.dirty=!1,a._transformDirty=!0)},BoneAllTimelineState}(t.MutilpleValueTimelineState);t.BoneAllTimelineState=n;var s=function(t){function BoneTranslateTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(BoneTranslateTimelineState,t),BoneTranslateTimelineState.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},BoneTranslateTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneTranslateTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight,a=i.animationPose;e.dirty>1?(a.x+=this._resultA*n,a.y+=this._resultB*n):1!==n?(a.x=this._resultA*n,a.y=this._resultB*n):(a.x=this._resultA,a.y=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},BoneTranslateTimelineState}(t.DoubleValueTimelineState);t.BoneTranslateTimelineState=s;var o=function(e){function BoneRotateTimelineState(){return null!==e&&e.apply(this,arguments)||this}return a(BoneRotateTimelineState,e),BoneRotateTimelineState.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},BoneRotateTimelineState.prototype._onArriveAtFrame=function(){e.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._differenceA=t.Transform.normalizeRadian(this._differenceA),this._differenceB=t.Transform.normalizeRadian(this._differenceB))},BoneRotateTimelineState.prototype.init=function(t,i,n){e.prototype.init.call(this,t,i,n),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneRotateTimelineState.prototype.fadeOut=function(){this.dirty=!1,this._resultA=t.Transform.normalizeRadian(this._resultA),this._resultB=t.Transform.normalizeRadian(this._resultB)},BoneRotateTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight,a=i.animationPose;e.dirty>1?(a.rotation+=this._resultA*n,a.skew+=this._resultB*n):1!==n?(a.rotation=this._resultA*n,a.skew=this._resultB*n):(a.rotation=this._resultA,a.skew=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},BoneRotateTimelineState}(t.DoubleValueTimelineState);t.BoneRotateTimelineState=o;var h=function(t){function BoneScaleTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(BoneScaleTimelineState,t),BoneScaleTimelineState.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},BoneScaleTimelineState.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._resultA=1,this._resultB=1)},BoneScaleTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},BoneScaleTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight,a=i.animationPose;e.dirty>1?(a.scaleX+=(this._resultA-1)*n,a.scaleY+=(this._resultB-1)*n):1!==n?(a.scaleX=(this._resultA-1)*n+1,a.scaleY=(this._resultB-1)*n+1):(a.scaleX=this._resultA,a.scaleY=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},BoneScaleTimelineState}(t.DoubleValueTimelineState);t.BoneScaleTimelineState=h;var l=function(t){function SurfaceTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(SurfaceTimelineState,t),SurfaceTimelineState.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},SurfaceTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},SurfaceTimelineState.prototype.init=function(e,i,n){if(t.prototype.init.call(this,e,i,n),null!==this._timelineData){var a=this._animationData.parent.parent,s=a.frameIntArray,o=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=s[o+2],this._deformCount=s[o+1],this._deformOffset=s[o+3],this._sameValueOffset=s[o+4]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=a.frameFloatArray,this._rd.length=2*this._valueCount}else this._deformCount=this.target.target._deformVertices.length},SurfaceTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight,a=i._deformVertices,s=this._valueArray;if(null!==s)for(var o=this._valueCount,h=this._deformOffset,l=this._sameValueOffset,c=this._rd,p=0;p<this._deformCount;++p){var d=0;d=p<h?s[l+p]:p<h+o?c[p-h]:s[l+p-o],e.dirty>1?a[p]+=d*n:a[p]=d*n}else if(1===e.dirty)for(p=0;p<this._deformCount;++p)a[p]=0;(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},SurfaceTimelineState}(t.MutilpleValueTimelineState);t.SurfaceTimelineState=l;var c=function(t){function AlphaTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(AlphaTimelineState,t),AlphaTimelineState.toString=function(){return"[class dragonBones.AlphaTimelineState]"},AlphaTimelineState.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._result=1)},AlphaTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},AlphaTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight;e.dirty>1?(i._alpha+=this._result*n,i._alpha>1&&(i._alpha=1)):i._alpha=this._result*n,(t||this.dirty)&&(this.dirty=!1,this._armature._alphaDirty=!0)},AlphaTimelineState}(t.SingleValueTimelineState);t.AlphaTimelineState=c;var p=function(t){function SlotDisplayTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(SlotDisplayTimelineState,t),SlotDisplayTimelineState.toString=function(){return"[class dragonBones.SlotDisplayTimelineState]"},SlotDisplayTimelineState.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this.target,e=null!==this._timelineData?this._frameArray[this._frameOffset+1]:t._slotData.displayIndex;t.displayIndex!==e&&t._setDisplayIndex(e,!0)}},SlotDisplayTimelineState.prototype._onUpdateFrame=function(){},SlotDisplayTimelineState}(t.TimelineState);t.SlotDisplayTimelineState=p;var d=function(t){function SlotColorTimelineState(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[0,0,0,0,0,0,0,0],e._difference=[0,0,0,0,0,0,0,0],e._result=[0,0,0,0,0,0,0,0],e}return a(SlotColorTimelineState,t),SlotColorTimelineState.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},SlotColorTimelineState.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.parent.parent,i=e.colorArray,n=e.frameIntArray,a=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex,s=n[a];s<0&&(s+=65536),this._isTween?(this._current[0]=i[s++],this._current[1]=i[s++],this._current[2]=i[s++],this._current[3]=i[s++],this._current[4]=i[s++],this._current[5]=i[s++],this._current[6]=i[s++],this._current[7]=i[s++],(s=this._frameIndex===this._frameCount-1?n[this._animationData.frameIntOffset+this._frameValueOffset]:n[a+1])<0&&(s+=65536),this._difference[0]=i[s++]-this._current[0],this._difference[1]=i[s++]-this._current[1],this._difference[2]=i[s++]-this._current[2],this._difference[3]=i[s++]-this._current[3],this._difference[4]=i[s++]-this._current[4],this._difference[5]=i[s++]-this._current[5],this._difference[6]=i[s++]-this._current[6],this._difference[7]=i[s++]-this._current[7]):(this._result[0]=.01*i[s++],this._result[1]=.01*i[s++],this._result[2]=.01*i[s++],this._result[3]=.01*i[s++],this._result[4]=i[s++],this._result[5]=i[s++],this._result[6]=i[s++],this._result[7]=i[s++])}else{var o=this.target.slotData.color;this._result[0]=o.alphaMultiplier,this._result[1]=o.redMultiplier,this._result[2]=o.greenMultiplier,this._result[3]=o.blueMultiplier,this._result[4]=o.alphaOffset,this._result[5]=o.redOffset,this._result[6]=o.greenOffset,this._result[7]=o.blueOffset}},SlotColorTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._isTween&&(this._result[0]=.01*(this._current[0]+this._difference[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._difference[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._difference[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._difference[3]*this._tweenProgress),this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress,this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress,this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress,this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress)},SlotColorTimelineState.prototype.fadeOut=function(){this._isTween=!1},SlotColorTimelineState.prototype.update=function(e){if(t.prototype.update.call(this,e),this._isTween||this.dirty){var i=this.target,n=i._colorTransform;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){if(n.alphaMultiplier!==this._result[0]||n.redMultiplier!==this._result[1]||n.greenMultiplier!==this._result[2]||n.blueMultiplier!==this._result[3]||n.alphaOffset!==this._result[4]||n.redOffset!==this._result[5]||n.greenOffset!==this._result[6]||n.blueOffset!==this._result[7]){var a=Math.pow(this._animationState._fadeProgress,4);n.alphaMultiplier+=(this._result[0]-n.alphaMultiplier)*a,n.redMultiplier+=(this._result[1]-n.redMultiplier)*a,n.greenMultiplier+=(this._result[2]-n.greenMultiplier)*a,n.blueMultiplier+=(this._result[3]-n.blueMultiplier)*a,n.alphaOffset+=(this._result[4]-n.alphaOffset)*a,n.redOffset+=(this._result[5]-n.redOffset)*a,n.greenOffset+=(this._result[6]-n.greenOffset)*a,n.blueOffset+=(this._result[7]-n.blueOffset)*a,i._colorDirty=!0}}else this.dirty&&(this.dirty=!1,n.alphaMultiplier===this._result[0]&&n.redMultiplier===this._result[1]&&n.greenMultiplier===this._result[2]&&n.blueMultiplier===this._result[3]&&n.alphaOffset===this._result[4]&&n.redOffset===this._result[5]&&n.greenOffset===this._result[6]&&n.blueOffset===this._result[7]||(n.alphaMultiplier=this._result[0],n.redMultiplier=this._result[1],n.greenMultiplier=this._result[2],n.blueMultiplier=this._result[3],n.alphaOffset=this._result[4],n.redOffset=this._result[5],n.greenOffset=this._result[6],n.blueOffset=this._result[7],i._colorDirty=!0))}},SlotColorTimelineState}(t.TweenTimelineState);t.SlotColorTimelineState=d;var u=function(t){function SlotZIndexTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(SlotZIndexTimelineState,t),SlotZIndexTimelineState.toString=function(){return"[class dragonBones.SlotZIndexTimelineState]"},SlotZIndexTimelineState.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null===this._timelineData){var e=this.target.target;this._result=e.slotData.zIndex}},SlotZIndexTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueArray=this._animationData.parent.parent.frameIntArray},SlotZIndexTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight;e.dirty>1?i._zIndex+=this._result*n:i._zIndex=this._result*n,(t||this.dirty)&&(this.dirty=!1,this._armature._zIndexDirty=!0)},SlotZIndexTimelineState}(t.SingleValueTimelineState);t.SlotZIndexTimelineState=u;var m=function(t){function DeformTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(DeformTimelineState,t),DeformTimelineState.toString=function(){return"[class dragonBones.DeformTimelineState]"},DeformTimelineState.prototype._onClear=function(){t.prototype._onClear.call(this),this.displayFrame=null,this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},DeformTimelineState.prototype.init=function(e,i,n){if(t.prototype.init.call(this,e,i,n),null!==this._timelineData){var a=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3],s=this._animationData.parent.parent,o=s.frameIntArray;this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=o[a+2],this._deformCount=o[a+1],this._deformOffset=o[a+3],this._sameValueOffset=o[a+4],this._sameValueOffset<0&&(this._sameValueOffset+=65536),this._sameValueOffset+=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=s.frameFloatArray,this._rd.length=2*this._valueCount}else this._deformCount=this.displayFrame.deformVertices.length},DeformTimelineState.prototype.blend=function(t){var e=this.target,i=e.target,n=e.blendWeight,a=this.displayFrame.deformVertices,s=this._valueArray;if(null!==s)for(var o=this._valueCount,h=this._deformOffset,l=this._sameValueOffset,c=this._rd,p=0;p<this._deformCount;++p){var d=0;d=p<h?s[l+p]:p<h+o?c[p-h]:s[l+p-o],e.dirty>1?a[p]+=d*n:a[p]=d*n}else if(1===e.dirty)for(p=0;p<this._deformCount;++p)a[p]=0;(t||this.dirty)&&(this.dirty=!1,i._geometryData===this.displayFrame.getGeometryData()&&(i._verticesDirty=!0))},DeformTimelineState}(t.MutilpleValueTimelineState);t.DeformTimelineState=m;var f=function(t){function IKConstraintTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(IKConstraintTimelineState,t),IKConstraintTimelineState.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},IKConstraintTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.target;if(null!==this._timelineData)e._bendPositive=this._currentA>0,e._weight=this._currentB;else{var i=e._constraintData;e._bendPositive=i.bendPositive,e._weight=i.weight}e.invalidUpdate(),this.dirty=!1},IKConstraintTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},IKConstraintTimelineState}(t.DoubleValueTimelineState);t.IKConstraintTimelineState=f;var y=function(t){function AnimationProgressTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(AnimationProgressTimelineState,t),AnimationProgressTimelineState.toString=function(){return"[class dragonBones.AnimationProgressTimelineState]"},AnimationProgressTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.target;null!==e._parent&&(e.currentTime=this._result*e.totalTime),this.dirty=!1},AnimationProgressTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationProgressTimelineState}(t.SingleValueTimelineState);t.AnimationProgressTimelineState=y;var g=function(t){function AnimationWeightTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(AnimationWeightTimelineState,t),AnimationWeightTimelineState.toString=function(){return"[class dragonBones.AnimationWeightTimelineState]"},AnimationWeightTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.target;null!==e._parent&&(e.weight=this._result),this.dirty=!1},AnimationWeightTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationWeightTimelineState}(t.SingleValueTimelineState);t.AnimationWeightTimelineState=g;var P=function(t){function AnimationParametersTimelineState(){return null!==t&&t.apply(this,arguments)||this}return a(AnimationParametersTimelineState,t),AnimationParametersTimelineState.toString=function(){return"[class dragonBones.AnimationParametersTimelineState]"},AnimationParametersTimelineState.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.target;null!==e._parent&&(e.parameterX=this._resultA,e.parameterY=this._resultB),this.dirty=!1},AnimationParametersTimelineState.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},AnimationParametersTimelineState}(t.DoubleValueTimelineState);t.AnimationParametersTimelineState=P}(c||(c={})),function(t){var e=function(t){function EventObject(){return null!==t&&t.apply(this,arguments)||this}return a(EventObject,t),EventObject.actionDataToInstance=function(t,e,i){0===t.type?e.type=EventObject.FRAME_EVENT:e.type=10===t.type?EventObject.FRAME_EVENT:EventObject.SOUND_EVENT,e.name=t.name,e.armature=i,e.actionData=t,e.data=t.data,null!==t.bone&&(e.bone=i.getBone(t.bone.name)),null!==t.slot&&(e.slot=i.getSlot(t.slot.name))},EventObject.toString=function(){return"[class dragonBones.EventObject]"},EventObject.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},EventObject.START="start",EventObject.LOOP_COMPLETE="loopComplete",EventObject.COMPLETE="complete",EventObject.FADE_IN="fadeIn",EventObject.FADE_IN_COMPLETE="fadeInComplete",EventObject.FADE_OUT="fadeOut",EventObject.FADE_OUT_COMPLETE="fadeOutComplete",EventObject.FRAME_EVENT="frameEvent",EventObject.SOUND_EVENT="soundEvent",EventObject}(t.BaseObject);t.EventObject=e}(c||(c={})),function(t){var e=function(){function DataParser(){}return DataParser._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},DataParser._getBoneType=function(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},DataParser._getPositionMode=function(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},DataParser._getSpacingMode=function(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},DataParser._getRotateMode=function(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},DataParser._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},DataParser._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},DataParser._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},DataParser._getAnimationBlendType=function(t){switch(t.toLowerCase()){case"none":return 0;case"1d":return 1;default:return 0}},DataParser._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},DataParser.DATA_VERSION_2_3="2.3",DataParser.DATA_VERSION_3_0="3.0",DataParser.DATA_VERSION_4_0="4.0",DataParser.DATA_VERSION_4_5="4.5",DataParser.DATA_VERSION_5_0="5.0",DataParser.DATA_VERSION_5_5="5.5",DataParser.DATA_VERSION_5_6="5.6",DataParser.DATA_VERSION=DataParser.DATA_VERSION_5_6,DataParser.DATA_VERSIONS=[DataParser.DATA_VERSION_4_0,DataParser.DATA_VERSION_4_5,DataParser.DATA_VERSION_5_0,DataParser.DATA_VERSION_5_5,DataParser.DATA_VERSION_5_6],DataParser.TEXTURE_ATLAS="textureAtlas",DataParser.SUB_TEXTURE="SubTexture",DataParser.FORMAT="format",DataParser.IMAGE_PATH="imagePath",DataParser.WIDTH="width",DataParser.HEIGHT="height",DataParser.ROTATED="rotated",DataParser.FRAME_X="frameX",DataParser.FRAME_Y="frameY",DataParser.FRAME_WIDTH="frameWidth",DataParser.FRAME_HEIGHT="frameHeight",DataParser.DRADON_BONES="dragonBones",DataParser.USER_DATA="userData",DataParser.ARMATURE="armature",DataParser.CANVAS="canvas",DataParser.BONE="bone",DataParser.SURFACE="surface",DataParser.SLOT="slot",DataParser.CONSTRAINT="constraint",DataParser.SKIN="skin",DataParser.DISPLAY="display",DataParser.FRAME="frame",DataParser.IK="ik",DataParser.PATH_CONSTRAINT="path",DataParser.ANIMATION="animation",DataParser.TIMELINE="timeline",DataParser.FFD="ffd",DataParser.TRANSLATE_FRAME="translateFrame",DataParser.ROTATE_FRAME="rotateFrame",DataParser.SCALE_FRAME="scaleFrame",DataParser.DISPLAY_FRAME="displayFrame",DataParser.COLOR_FRAME="colorFrame",DataParser.DEFAULT_ACTIONS="defaultActions",DataParser.ACTIONS="actions",DataParser.EVENTS="events",DataParser.INTS="ints",DataParser.FLOATS="floats",DataParser.STRINGS="strings",DataParser.TRANSFORM="transform",DataParser.PIVOT="pivot",DataParser.AABB="aabb",DataParser.COLOR="color",DataParser.VERSION="version",DataParser.COMPATIBLE_VERSION="compatibleVersion",DataParser.FRAME_RATE="frameRate",DataParser.TYPE="type",DataParser.SUB_TYPE="subType",DataParser.NAME="name",DataParser.PARENT="parent",DataParser.TARGET="target",DataParser.STAGE="stage",DataParser.SHARE="share",DataParser.PATH="path",DataParser.LENGTH="length",DataParser.DISPLAY_INDEX="displayIndex",DataParser.Z_ORDER="zOrder",DataParser.Z_INDEX="zIndex",DataParser.BLEND_MODE="blendMode",DataParser.INHERIT_TRANSLATION="inheritTranslation",DataParser.INHERIT_ROTATION="inheritRotation",DataParser.INHERIT_SCALE="inheritScale",DataParser.INHERIT_REFLECTION="inheritReflection",DataParser.INHERIT_ANIMATION="inheritAnimation",DataParser.INHERIT_DEFORM="inheritDeform",DataParser.SEGMENT_X="segmentX",DataParser.SEGMENT_Y="segmentY",DataParser.BEND_POSITIVE="bendPositive",DataParser.CHAIN="chain",DataParser.WEIGHT="weight",DataParser.BLEND_TYPE="blendType",DataParser.FADE_IN_TIME="fadeInTime",DataParser.PLAY_TIMES="playTimes",DataParser.SCALE="scale",DataParser.OFFSET="offset",DataParser.POSITION="position",DataParser.DURATION="duration",DataParser.TWEEN_EASING="tweenEasing",DataParser.TWEEN_ROTATE="tweenRotate",DataParser.TWEEN_SCALE="tweenScale",DataParser.CLOCK_WISE="clockwise",DataParser.CURVE="curve",DataParser.SOUND="sound",DataParser.EVENT="event",DataParser.ACTION="action",DataParser.X="x",DataParser.Y="y",DataParser.SKEW_X="skX",DataParser.SKEW_Y="skY",DataParser.SCALE_X="scX",DataParser.SCALE_Y="scY",DataParser.VALUE="value",DataParser.ROTATE="rotate",DataParser.SKEW="skew",DataParser.ALPHA="alpha",DataParser.ALPHA_OFFSET="aO",DataParser.RED_OFFSET="rO",DataParser.GREEN_OFFSET="gO",DataParser.BLUE_OFFSET="bO",DataParser.ALPHA_MULTIPLIER="aM",DataParser.RED_MULTIPLIER="rM",DataParser.GREEN_MULTIPLIER="gM",DataParser.BLUE_MULTIPLIER="bM",DataParser.UVS="uvs",DataParser.VERTICES="vertices",DataParser.TRIANGLES="triangles",DataParser.WEIGHTS="weights",DataParser.SLOT_POSE="slotPose",DataParser.BONE_POSE="bonePose",DataParser.BONES="bones",DataParser.POSITION_MODE="positionMode",DataParser.SPACING_MODE="spacingMode",DataParser.ROTATE_MODE="rotateMode",DataParser.SPACING="spacing",DataParser.ROTATE_OFFSET="rotateOffset",DataParser.ROTATE_MIX="rotateMix",DataParser.TRANSLATE_MIX="translateMix",DataParser.TARGET_DISPLAY="targetDisplay",DataParser.CLOSED="closed",DataParser.CONSTANT_SPEED="constantSpeed",DataParser.VERTEX_COUNT="vertexCount",DataParser.LENGTHS="lengths",DataParser.GOTO_AND_PLAY="gotoAndPlay",DataParser.DEFAULT_NAME="default",DataParser}();t.DataParser=e}(c||(c={})),function(t){var e=function(e){function ObjectDataParser(){var i=null!==e&&e.apply(this,arguments)||this;return i._rawTextureAtlasIndex=0,i._rawBones=[],i._data=null,i._armature=null,i._bone=null,i._geometry=null,i._slot=null,i._skin=null,i._mesh=null,i._animation=null,i._timeline=null,i._rawTextureAtlases=null,i._frameValueType=0,i._defaultColorOffset=-1,i._prevClockwise=0,i._prevRotation=0,i._frameDefaultValue=0,i._frameValueScale=1,i._helpMatrixA=new t.Matrix,i._helpMatrixB=new t.Matrix,i._helpTransform=new t.Transform,i._helpColorTransform=new t.ColorTransform,i._helpPoint=new t.Point,i._helpArray=[],i._intArray=[],i._floatArray=[],i._frameIntArray=[],i._frameFloatArray=[],i._frameArray=[],i._timelineArray=[],i._colorArray=[],i._cacheRawMeshes=[],i._cacheMeshes=[],i._actionFrames=[],i._weightSlotPose={},i._weightBonePoses={},i._cacheBones={},i._slotChildActions={},i}return a(ObjectDataParser,e),ObjectDataParser._getBoolean=function(t,e,i){if(e in t){var n=t[e],a=typeof n;if("boolean"===a)return n;if("string"!==a)return!!n;switch(n){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},ObjectDataParser._getNumber=function(t,e,i){if(e in t){var n=t[e];return null===n||"NaN"===n?i:+n||0}return i},ObjectDataParser._getString=function(t,e,i){if(e in t){var n=t[e];return"string"===typeof n?n:String(n)}return i},ObjectDataParser.prototype._getCurvePoint=function(t,e,i,n,a,s,o,h,l,c){var p=1-l,d=p*p,u=l*l,m=p*d,f=3*l*d,y=3*p*u,g=l*u;c.x=m*t+f*i+y*a+g*o,c.y=m*e+f*n+y*s+g*h},ObjectDataParser.prototype._samplingEasingCurve=function(t,e){var i=t.length;if(i%3==1){for(var n=-2,a=0,s=e.length;a<s;++a){for(var o=(a+1)/(s+1);(n+6<i?t[n+6]:1)<o;)n+=6;for(var h=n>=0&&n+6<i,l=h?t[n]:0,c=h?t[n+1]:0,p=t[n+2],d=t[n+3],u=t[n+4],m=t[n+5],f=h?t[n+6]:1,y=h?t[n+7]:1,g=0,P=1;P-g>1e-4;){var _=.5*(P+g);this._getCurvePoint(l,c,p,d,u,m,f,y,_,this._helpPoint),o-this._helpPoint.x>0?g=_:P=_}e[a]=this._helpPoint.y}return!0}for(n=0,a=0,s=e.length;a<s;++a){for(o=(a+1)/(s+1);t[n+6]<o;)n+=6;for(l=t[n],c=t[n+1],p=t[n+2],d=t[n+3],u=t[n+4],m=t[n+5],f=t[n+6],y=t[n+7],g=0,P=1;P-g>1e-4;){_=.5*(P+g);this._getCurvePoint(l,c,p,d,u,m,f,y,_,this._helpPoint),o-this._helpPoint.x>0?g=_:P=_}e[a]=this._helpPoint.y}return!1},ObjectDataParser.prototype._parseActionDataInFrame=function(e,i,n,a){t.DataParser.EVENT in e&&this._mergeActionFrame(e[t.DataParser.EVENT],i,10,n,a),t.DataParser.SOUND in e&&this._mergeActionFrame(e[t.DataParser.SOUND],i,11,n,a),t.DataParser.ACTION in e&&this._mergeActionFrame(e[t.DataParser.ACTION],i,0,n,a),t.DataParser.EVENTS in e&&this._mergeActionFrame(e[t.DataParser.EVENTS],i,10,n,a),t.DataParser.ACTIONS in e&&this._mergeActionFrame(e[t.DataParser.ACTIONS],i,0,n,a)},ObjectDataParser.prototype._mergeActionFrame=function(t,e,n,a,s){for(var o=this._armature.actions.length,h=this._parseActionData(t,n,a,s),l=0,c=null,p=0,d=h;p<d.length;p++){var u=d[p];this._armature.addAction(u,!1)}0===this._actionFrames.length&&((c=new i).frameStart=0,this._actionFrames.push(c),c=null);for(var m=0,f=this._actionFrames;m<f.length;m++){var y=f[m];if(y.frameStart===e){c=y;break}if(y.frameStart>e)break;l++}null===c&&((c=new i).frameStart=e,this._actionFrames.splice(l,0,c));for(var g=0;g<h.length;++g)c.actions.push(o+g)},ObjectDataParser.prototype._parseArmature=function(e,i){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),n.frameRate=ObjectDataParser._getNumber(e,t.DataParser.FRAME_RATE,this._data.frameRate),n.scale=i,t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?n.type=t.DataParser._getArmatureType(e[t.DataParser.TYPE]):n.type=ObjectDataParser._getNumber(e,t.DataParser.TYPE,0),0===n.frameRate&&(n.frameRate=24),this._armature=n,t.DataParser.CANVAS in e){var a=e[t.DataParser.CANVAS],s=t.BaseObject.borrowObject(t.CanvasData);t.DataParser.COLOR in a?s.hasBackground=!0:s.hasBackground=!1,s.color=ObjectDataParser._getNumber(a,t.DataParser.COLOR,0),s.x=ObjectDataParser._getNumber(a,t.DataParser.X,0)*n.scale,s.y=ObjectDataParser._getNumber(a,t.DataParser.Y,0)*n.scale,s.width=ObjectDataParser._getNumber(a,t.DataParser.WIDTH,0)*n.scale,s.height=ObjectDataParser._getNumber(a,t.DataParser.HEIGHT,0)*n.scale,n.canvas=s}if(t.DataParser.AABB in e){var o=e[t.DataParser.AABB];n.aabb.x=ObjectDataParser._getNumber(o,t.DataParser.X,0)*n.scale,n.aabb.y=ObjectDataParser._getNumber(o,t.DataParser.Y,0)*n.scale,n.aabb.width=ObjectDataParser._getNumber(o,t.DataParser.WIDTH,0)*n.scale,n.aabb.height=ObjectDataParser._getNumber(o,t.DataParser.HEIGHT,0)*n.scale}if(t.DataParser.BONE in e)for(var h=0,l=e[t.DataParser.BONE];h<l.length;h++){var c=l[h],p=ObjectDataParser._getString(c,t.DataParser.PARENT,""),d=this._parseBone(c);if(p.length>0){var u=n.getBone(p);null!==u?d.parent=u:(p in this._cacheBones||(this._cacheBones[p]=[]),this._cacheBones[p].push(d))}if(d.name in this._cacheBones){for(var m=0,f=this._cacheBones[d.name];m<f.length;m++){f[m].parent=d}delete this._cacheBones[d.name]}n.addBone(d),this._rawBones.push(d)}if(t.DataParser.IK in e)for(var y=0,g=e[t.DataParser.IK];y<g.length;y++){var P=g[y];(I=this._parseIKConstraint(P))&&n.addConstraint(I)}if(n.sortBones(),t.DataParser.SLOT in e)for(var _=0,v=0,b=e[t.DataParser.SLOT];v<b.length;v++){var T=b[v];n.addSlot(this._parseSlot(T,_++))}if(t.DataParser.SKIN in e)for(var S=0,x=e[t.DataParser.SKIN];S<x.length;S++){var w=x[S];n.addSkin(this._parseSkin(w))}if(t.DataParser.PATH_CONSTRAINT in e)for(var D=0,C=e[t.DataParser.PATH_CONSTRAINT];D<C.length;D++){var I,k=C[D];(I=this._parsePathConstraint(k))&&n.addConstraint(I)}for(var B=0,E=this._cacheRawMeshes.length;B<E;++B){var A=this._cacheRawMeshes[B],O=ObjectDataParser._getString(A,t.DataParser.SHARE,"");if(0!==O.length){var M=ObjectDataParser._getString(A,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME);0===M.length&&(M=t.DataParser.DEFAULT_NAME);var R=n.getMesh(M,"",O);if(null!==R)this._cacheMeshes[B].geometry.shareFrom(R.geometry)}}if(t.DataParser.ANIMATION in e)for(var F=0,N=e[t.DataParser.ANIMATION];F<N.length;F++){var L=N[F],H=this._parseAnimation(L);n.addAnimation(H)}if(t.DataParser.DEFAULT_ACTIONS in e)for(var G=0,U=this._parseActionData(e[t.DataParser.DEFAULT_ACTIONS],0,null,null);G<U.length;G++){var z=U[G];if(n.addAction(z,!0),0===z.type)null!==(H=n.getAnimation(z.name))&&(n.defaultAnimation=H)}if(t.DataParser.ACTIONS in e)for(var j=0,V=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null);j<V.length;j++){z=V[j];n.addAction(z,!1)}for(var W in this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[W];for(var W in this._weightBonePoses)delete this._weightBonePoses[W];for(var W in this._cacheBones)delete this._cacheBones[W];for(var W in this._slotChildActions)delete this._slotChildActions[W];return n},ObjectDataParser.prototype._parseBone=function(e){if(0===(t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getBoneType(e[t.DataParser.TYPE]):ObjectDataParser._getNumber(e,t.DataParser.TYPE,0))){var i=this._armature.scale,n=t.BaseObject.borrowObject(t.BoneData);return n.inheritTranslation=ObjectDataParser._getBoolean(e,t.DataParser.INHERIT_TRANSLATION,!0),n.inheritRotation=ObjectDataParser._getBoolean(e,t.DataParser.INHERIT_ROTATION,!0),n.inheritScale=ObjectDataParser._getBoolean(e,t.DataParser.INHERIT_SCALE,!0),n.inheritReflection=ObjectDataParser._getBoolean(e,t.DataParser.INHERIT_REFLECTION,!0),n.length=ObjectDataParser._getNumber(e,t.DataParser.LENGTH,0)*i,n.alpha=ObjectDataParser._getNumber(e,t.DataParser.ALPHA,1),n.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],n.transform,i),n}var a=t.BaseObject.borrowObject(t.SurfaceData);return a.alpha=ObjectDataParser._getNumber(e,t.DataParser.ALPHA,1),a.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),a.segmentX=ObjectDataParser._getNumber(e,t.DataParser.SEGMENT_X,0),a.segmentY=ObjectDataParser._getNumber(e,t.DataParser.SEGMENT_Y,0),this._parseGeometry(e,a.geometry),a},ObjectDataParser.prototype._parseIKConstraint=function(e){var i=this._armature.getBone(ObjectDataParser._getString(e,t.DataParser.BONE,""));if(null===i)return null;var n=this._armature.getBone(ObjectDataParser._getString(e,t.DataParser.TARGET,""));if(null===n)return null;var a=ObjectDataParser._getNumber(e,t.DataParser.CHAIN,0),s=t.BaseObject.borrowObject(t.IKConstraintData);return s.scaleEnabled=ObjectDataParser._getBoolean(e,t.DataParser.SCALE,!1),s.bendPositive=ObjectDataParser._getBoolean(e,t.DataParser.BEND_POSITIVE,!0),s.weight=ObjectDataParser._getNumber(e,t.DataParser.WEIGHT,1),s.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),s.type=0,s.target=n,a>0&&null!==i.parent?(s.root=i.parent,s.bone=i):(s.root=i,s.bone=null),s},ObjectDataParser.prototype._parsePathConstraint=function(e){var i=this._armature.getSlot(ObjectDataParser._getString(e,t.DataParser.TARGET,""));if(null===i)return null;var n=this._armature.defaultSkin;if(null===n)return null;var a=n.getDisplay(i.name,ObjectDataParser._getString(e,t.DataParser.TARGET_DISPLAY,i.name));if(null===a||!(a instanceof t.PathDisplayData))return null;var s=e[t.DataParser.BONES];if(null===s||0===s.length)return null;var o=t.BaseObject.borrowObject(t.PathConstraintData);o.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),o.type=1,o.pathSlot=i,o.pathDisplayData=a,o.target=i.parent,o.positionMode=t.DataParser._getPositionMode(ObjectDataParser._getString(e,t.DataParser.POSITION_MODE,"")),o.spacingMode=t.DataParser._getSpacingMode(ObjectDataParser._getString(e,t.DataParser.SPACING_MODE,"")),o.rotateMode=t.DataParser._getRotateMode(ObjectDataParser._getString(e,t.DataParser.ROTATE_MODE,"")),o.position=ObjectDataParser._getNumber(e,t.DataParser.POSITION,0),o.spacing=ObjectDataParser._getNumber(e,t.DataParser.SPACING,0),o.rotateOffset=ObjectDataParser._getNumber(e,t.DataParser.ROTATE_OFFSET,0),o.rotateMix=ObjectDataParser._getNumber(e,t.DataParser.ROTATE_MIX,1),o.translateMix=ObjectDataParser._getNumber(e,t.DataParser.TRANSLATE_MIX,1);for(var h=0,l=s;h<l.length;h++){var c=l[h],p=this._armature.getBone(c);null!==p&&(o.AddBone(p),null===o.root&&(o.root=p))}return o},ObjectDataParser.prototype._parseSlot=function(e,i){var n=t.BaseObject.borrowObject(t.SlotData);return n.displayIndex=ObjectDataParser._getNumber(e,t.DataParser.DISPLAY_INDEX,0),n.zOrder=i,n.zIndex=ObjectDataParser._getNumber(e,t.DataParser.Z_INDEX,0),n.alpha=ObjectDataParser._getNumber(e,t.DataParser.ALPHA,1),n.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),n.parent=this._armature.getBone(ObjectDataParser._getString(e,t.DataParser.PARENT,"")),t.DataParser.BLEND_MODE in e&&"string"==typeof e[t.DataParser.BLEND_MODE]?n.blendMode=t.DataParser._getBlendMode(e[t.DataParser.BLEND_MODE]):n.blendMode=ObjectDataParser._getNumber(e,t.DataParser.BLEND_MODE,0),t.DataParser.COLOR in e?(n.color=t.SlotData.createColor(),this._parseColorTransform(e[t.DataParser.COLOR],n.color)):n.color=t.SlotData.DEFAULT_COLOR,t.DataParser.ACTIONS in e&&(this._slotChildActions[n.name]=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null)),n},ObjectDataParser.prototype._parseSkin=function(e){var i=t.BaseObject.borrowObject(t.SkinData);if(i.name=ObjectDataParser._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),t.DataParser.SLOT in e){var n=e[t.DataParser.SLOT];this._skin=i;for(var a=0,s=n;a<s.length;a++){var o=s[a],h=ObjectDataParser._getString(o,t.DataParser.NAME,""),l=this._armature.getSlot(h);if(null!==l){if(this._slot=l,t.DataParser.DISPLAY in o)for(var c=0,p=o[t.DataParser.DISPLAY];c<p.length;c++){var d=p[c];d?i.addDisplay(h,this._parseDisplay(d)):i.addDisplay(h,null)}this._slot=null}}this._skin=null}return i},ObjectDataParser.prototype._parseDisplay=function(e){var i=ObjectDataParser._getString(e,t.DataParser.NAME,""),n=ObjectDataParser._getString(e,t.DataParser.PATH,""),a=0,s=null;switch(a=t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getDisplayType(e[t.DataParser.TYPE]):ObjectDataParser._getNumber(e,t.DataParser.TYPE,a)){case 0:var o=s=t.BaseObject.borrowObject(t.ImageDisplayData);o.name=i,o.path=n.length>0?n:i,this._parsePivot(e,o);break;case 1:var h=s=t.BaseObject.borrowObject(t.ArmatureDisplayData);if(h.name=i,h.path=n.length>0?n:i,h.inheritAnimation=!0,t.DataParser.ACTIONS in e)for(var l=0,c=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null);l<c.length;l++){var p=c[l];h.addAction(p)}else if(this._slot.name in this._slotChildActions){var d=this._skin.getDisplays(this._slot.name);if(null===d?0===this._slot.displayIndex:this._slot.displayIndex===d.length){for(var u=0,m=this._slotChildActions[this._slot.name];u<m.length;u++){p=m[u];h.addAction(p)}delete this._slotChildActions[this._slot.name]}}break;case 2:var f=s=t.BaseObject.borrowObject(t.MeshDisplayData);f.geometry.inheritDeform=ObjectDataParser._getBoolean(e,t.DataParser.INHERIT_DEFORM,!0),f.name=i,f.path=n.length>0?n:i,t.DataParser.SHARE in e?(f.geometry.data=this._data,this._cacheRawMeshes.push(e),this._cacheMeshes.push(f)):this._parseMesh(e,f);break;case 3:var y=this._parseBoundingBox(e);if(null!==y){var g=s=t.BaseObject.borrowObject(t.BoundingBoxDisplayData);g.name=i,g.path=n.length>0?n:i,g.boundingBox=y}break;case 4:var P=e[t.DataParser.LENGTHS],_=s=t.BaseObject.borrowObject(t.PathDisplayData);_.closed=ObjectDataParser._getBoolean(e,t.DataParser.CLOSED,!1),_.constantSpeed=ObjectDataParser._getBoolean(e,t.DataParser.CONSTANT_SPEED,!1),_.name=i,_.path=n.length>0?n:i,_.curveLengths.length=P.length;for(var v=0,b=P.length;v<b;++v)_.curveLengths[v]=P[v];this._parsePath(e,_)}return null!==s&&t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],s.transform,this._armature.scale),s},ObjectDataParser.prototype._parsePath=function(t,e){this._parseGeometry(t,e.geometry)},ObjectDataParser.prototype._parsePivot=function(e,i){if(t.DataParser.PIVOT in e){var n=e[t.DataParser.PIVOT];i.pivot.x=ObjectDataParser._getNumber(n,t.DataParser.X,0),i.pivot.y=ObjectDataParser._getNumber(n,t.DataParser.Y,0)}else i.pivot.x=.5,i.pivot.y=.5},ObjectDataParser.prototype._parseMesh=function(e,i){if(this._parseGeometry(e,i.geometry),t.DataParser.WEIGHTS in e){var n=e[t.DataParser.SLOT_POSE],a=e[t.DataParser.BONE_POSE],s=this._skin.name+"_"+this._slot.name+"_"+i.name;this._weightSlotPose[s]=n,this._weightBonePoses[s]=a}},ObjectDataParser.prototype._parseBoundingBox=function(e){var i=null,n=0;switch(n=t.DataParser.SUB_TYPE in e&&"string"==typeof e[t.DataParser.SUB_TYPE]?t.DataParser._getBoundingBoxType(e[t.DataParser.SUB_TYPE]):ObjectDataParser._getNumber(e,t.DataParser.SUB_TYPE,n)){case 0:i=t.BaseObject.borrowObject(t.RectangleBoundingBoxData);break;case 1:i=t.BaseObject.borrowObject(t.EllipseBoundingBoxData);break;case 2:i=this._parsePolygonBoundingBox(e)}return null!==i&&(i.color=ObjectDataParser._getNumber(e,t.DataParser.COLOR,0),0!==i.type&&1!==i.type||(i.width=ObjectDataParser._getNumber(e,t.DataParser.WIDTH,0),i.height=ObjectDataParser._getNumber(e,t.DataParser.HEIGHT,0))),i},ObjectDataParser.prototype._parsePolygonBoundingBox=function(e){var i=t.BaseObject.borrowObject(t.PolygonBoundingBoxData);if(t.DataParser.VERTICES in e){var n=this._armature.scale,a=e[t.DataParser.VERTICES],s=i.vertices;s.length=a.length;for(var o=0,h=a.length;o<h;o+=2){var l=a[o]*n,c=a[o+1]*n;s[o]=l,s[o+1]=c,0===o?(i.x=l,i.y=c,i.width=l,i.height=c):(l<i.x?i.x=l:l>i.width&&(i.width=l),c<i.y?i.y=c:c>i.height&&(i.height=c))}i.width-=i.x,i.height-=i.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return i},ObjectDataParser.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);if(i.blendType=t.DataParser._getAnimationBlendType(ObjectDataParser._getString(e,t.DataParser.BLEND_TYPE,"")),i.frameCount=ObjectDataParser._getNumber(e,t.DataParser.DURATION,0),i.playTimes=ObjectDataParser._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=ObjectDataParser._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=ObjectDataParser._getNumber(e,t.DataParser.SCALE,1),i.name=ObjectDataParser._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),i.frameIntOffset=this._frameIntArray.length,i.frameFloatOffset=this._frameFloatArray.length,i.frameOffset=this._frameArray.length,this._animation=i,t.DataParser.FRAME in e){var n=e[t.DataParser.FRAME],a=n.length;if(a>0)for(var s=0,o=0;s<a;++s){var h=n[s];this._parseActionDataInFrame(h,o,null,null),o+=ObjectDataParser._getNumber(h,t.DataParser.DURATION,1)}}if(t.DataParser.Z_ORDER in e&&(this._animation.zOrderTimeline=this._parseTimeline(e[t.DataParser.Z_ORDER],null,t.DataParser.FRAME,1,0,0,this._parseZOrderFrame)),t.DataParser.BONE in e)for(var l=0,c=e[t.DataParser.BONE];l<c.length;l++){var p=c[l];this._parseBoneTimeline(p)}if(t.DataParser.SLOT in e)for(var d=0,u=e[t.DataParser.SLOT];d<u.length;d++){p=u[d];this._parseSlotTimeline(p)}if(t.DataParser.FFD in e)for(var m=0,f=e[t.DataParser.FFD];m<f.length;m++){p=f[m];var y=ObjectDataParser._getString(p,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME),g=ObjectDataParser._getString(p,t.DataParser.SLOT,""),P=ObjectDataParser._getString(p,t.DataParser.NAME,"");if(0===y.length&&(y=t.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(g),this._mesh=this._armature.getMesh(y,g,P),null!==this._slot&&null!==this._mesh)null!==(D=this._parseTimeline(p,null,t.DataParser.FRAME,22,2,0,this._parseSlotDeformFrame))&&this._animation.addSlotTimeline(g,D),this._slot=null,this._mesh=null}if(t.DataParser.IK in e)for(var _=0,v=e[t.DataParser.IK];_<v.length;_++){p=v[_];var b=ObjectDataParser._getString(p,t.DataParser.NAME,"");if(null!==this._armature.getConstraint(b))null!==(D=this._parseTimeline(p,null,t.DataParser.FRAME,30,1,2,this._parseIKConstraintFrame))&&this._animation.addConstraintTimeline(b,D)}if(this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,0,0,this._parseActionFrame),this._actionFrames.length=0),t.DataParser.TIMELINE in e)for(var T=0,S=e[t.DataParser.TIMELINE];T<S.length;T++){p=S[T];var x=ObjectDataParser._getNumber(p,t.DataParser.TYPE,0),w=ObjectDataParser._getString(p,t.DataParser.NAME,""),D=null;switch(x){case 0:break;case 20:case 23:case 60:case 24:case 40:case 41:if(20===x?(this._frameValueType=0,this._frameValueScale=1):(this._frameValueType=1,this._frameValueScale=23===x?1:40===x||41===x?1e4:100),this._frameDefaultValue=60===x||24===x||41===x?1:0,40===x&&0!==i.blendType){var C=D=t.BaseObject.borrowObject(t.AnimationTimelineData);C.x=ObjectDataParser._getNumber(p,t.DataParser.X,0),C.y=ObjectDataParser._getNumber(p,t.DataParser.Y,0)}D=this._parseTimeline(p,null,t.DataParser.FRAME,x,this._frameValueType,1,this._parseSingleValueFrame,D);break;case 11:case 12:case 13:case 30:case 42:30===x||42===x?(this._frameValueType=1,this._frameValueScale=42===x?1e4:100):(this._frameValueScale=12===x?t.Transform.DEG_RAD:1,this._frameValueType=2),this._frameDefaultValue=13===x||30===x?1:0,D=this._parseTimeline(p,null,t.DataParser.FRAME,x,this._frameValueType,2,this._parseDoubleValueFrame);break;case 1:break;case 50:var I=this._armature.getBone(w);if(null===I)continue;this._geometry=I.geometry,D=this._parseTimeline(p,null,t.DataParser.FRAME,x,2,0,this._parseDeformFrame),this._geometry=null;break;case 22:for(var y in this._geometry=null,this._armature.skins){var k=this._armature.skins[y];for(var B in k.displays)for(var E=0,A=k.displays[B];E<A.length;E++){var O=A[E];if(null!==O&&O.name===w){this._geometry=O.geometry;break}}}if(null===this._geometry)continue;D=this._parseTimeline(p,null,t.DataParser.FRAME,x,2,0,this._parseDeformFrame),this._geometry=null;break;case 21:D=this._parseTimeline(p,null,t.DataParser.FRAME,x,1,1,this._parseSlotColorFrame)}if(null!==D)switch(x){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(w,D);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(w,D);break;case 30:this._animation.addConstraintTimeline(w,D);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(w,D)}}return this._animation=null,i},ObjectDataParser.prototype._parseTimeline=function(e,n,a,s,o,h,l,c){if(void 0===c&&(c=null),null!==e&&a.length>0&&a in e&&(n=e[a]),null===n)return null;var p=n.length;if(0===p)return null;var d=this._frameIntArray.length,u=this._frameFloatArray.length,m=this._timelineArray.length;switch(null===c&&(c=t.BaseObject.borrowObject(t.TimelineData)),c.type=s,c.offset=m,this._frameValueType=o,this._timeline=c,this._timelineArray.length+=5+p,null!==e?(this._timelineArray[m+0]=Math.round(100*ObjectDataParser._getNumber(e,t.DataParser.SCALE,1)),this._timelineArray[m+1]=Math.round(100*ObjectDataParser._getNumber(e,t.DataParser.OFFSET,0))):(this._timelineArray[m+0]=100,this._timelineArray[m+1]=0),this._timelineArray[m+2]=p,this._timelineArray[m+3]=h,this._frameValueType){case 0:this._timelineArray[m+4]=0;break;case 1:this._timelineArray[m+4]=d-this._animation.frameIntOffset;break;case 2:this._timelineArray[m+4]=u-this._animation.frameFloatOffset}if(1===p)c.frameIndicesOffset=-1,this._timelineArray[m+5+0]=l.call(this,n[0],0,0)-this._animation.frameOffset;else{var f=this._animation.frameCount+1,y=this._data.frameIndices,g=y.length;y.length+=f,c.frameIndicesOffset=g;for(var P=0,_=0,v=0,b=0;P<f;++P){if(v+b<=P&&_<p){var T=n[_];v=P,b=_===p-1?this._animation.frameCount-v:T instanceof i?this._actionFrames[_+1].frameStart-v:ObjectDataParser._getNumber(T,t.DataParser.DURATION,1),this._timelineArray[m+5+_]=l.call(this,T,v,b)-this._animation.frameOffset,_++}y[g+P]=_-1}}return this._timeline=null,c},ObjectDataParser.prototype._parseBoneTimeline=function(e){var i=this._armature.getBone(ObjectDataParser._getString(e,t.DataParser.NAME,""));if(null!==i){var n;if(this._bone=i,this._slot=this._armature.getSlot(this._bone.name),t.DataParser.TRANSLATE_FRAME in e)this._frameDefaultValue=0,this._frameValueScale=1,null!==(n=this._parseTimeline(e,null,t.DataParser.TRANSLATE_FRAME,11,2,2,this._parseDoubleValueFrame))&&this._animation.addBoneTimeline(i.name,n);if(t.DataParser.ROTATE_FRAME in e)this._frameDefaultValue=0,this._frameValueScale=1,null!==(n=this._parseTimeline(e,null,t.DataParser.ROTATE_FRAME,12,2,2,this._parseBoneRotateFrame))&&this._animation.addBoneTimeline(i.name,n);if(t.DataParser.SCALE_FRAME in e)this._frameDefaultValue=1,this._frameValueScale=1,null!==(n=this._parseTimeline(e,null,t.DataParser.SCALE_FRAME,13,2,2,this._parseBoneScaleFrame))&&this._animation.addBoneTimeline(i.name,n);if(t.DataParser.FRAME in e)null!==(n=this._parseTimeline(e,null,t.DataParser.FRAME,10,2,6,this._parseBoneAllFrame))&&this._animation.addBoneTimeline(i.name,n);this._bone=null,this._slot=null}},ObjectDataParser.prototype._parseSlotTimeline=function(e){var i=this._armature.getSlot(ObjectDataParser._getString(e,t.DataParser.NAME,""));if(null!==i){var n=null,a=null;this._slot=i,n=t.DataParser.DISPLAY_FRAME in e?this._parseTimeline(e,null,t.DataParser.DISPLAY_FRAME,20,0,0,this._parseSlotDisplayFrame):this._parseTimeline(e,null,t.DataParser.FRAME,20,0,0,this._parseSlotDisplayFrame),a=t.DataParser.COLOR_FRAME in e?this._parseTimeline(e,null,t.DataParser.COLOR_FRAME,21,1,1,this._parseSlotColorFrame):this._parseTimeline(e,null,t.DataParser.FRAME,21,1,1,this._parseSlotColorFrame),null!==n&&this._animation.addSlotTimeline(i.name,n),null!==a&&this._animation.addSlotTimeline(i.name,a),this._slot=null}},ObjectDataParser.prototype._parseFrame=function(t,e,i){var n=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[n+0]=e,n},ObjectDataParser.prototype._parseTweenFrame=function(e,i,n){var a=this._parseFrame(e,i,n);if(n>0)if(t.DataParser.CURVE in e){var s=n+1;this._helpArray.length=s;var o=this._samplingEasingCurve(e[t.DataParser.CURVE],this._helpArray);this._frameArray.length+=2+this._helpArray.length,this._frameArray[a+1]=2,this._frameArray[a+2]=o?s:-s;for(var h=0;h<s;++h)this._frameArray[a+3+h]=Math.round(1e4*this._helpArray[h])}else{var l=-2;t.DataParser.TWEEN_EASING in e&&(l=ObjectDataParser._getNumber(e,t.DataParser.TWEEN_EASING,-2)),-2===l?(this._frameArray.length+=1,this._frameArray[a+1]=0):0===l?(this._frameArray.length+=1,this._frameArray[a+1]=1):l<0?(this._frameArray.length+=2,this._frameArray[a+1]=3,this._frameArray[a+2]=Math.round(100*-l)):l<=1?(this._frameArray.length+=2,this._frameArray[a+1]=4,this._frameArray[a+2]=Math.round(100*l)):(this._frameArray.length+=2,this._frameArray[a+1]=5,this._frameArray[a+2]=Math.round(100*l-100))}else this._frameArray.length+=1,this._frameArray[a+1]=0;return a},ObjectDataParser.prototype._parseSingleValueFrame=function(e,i,n){var a=0;switch(this._frameValueType){case 0:a=this._parseFrame(e,i,n),this._frameArray.length+=1,this._frameArray[a+1]=ObjectDataParser._getNumber(e,t.DataParser.VALUE,this._frameDefaultValue);break;case 1:a=this._parseTweenFrame(e,i,n);var s=this._frameIntArray.length;this._frameIntArray.length+=1,this._frameIntArray[s]=Math.round(ObjectDataParser._getNumber(e,t.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale);break;case 2:a=this._parseTweenFrame(e,i,n);s=this._frameFloatArray.length;this._frameFloatArray.length+=1,this._frameFloatArray[s]=ObjectDataParser._getNumber(e,t.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale}return a},ObjectDataParser.prototype._parseDoubleValueFrame=function(e,i,n){var a=0;switch(this._frameValueType){case 0:a=this._parseFrame(e,i,n),this._frameArray.length+=2,this._frameArray[a+1]=ObjectDataParser._getNumber(e,t.DataParser.X,this._frameDefaultValue),this._frameArray[a+2]=ObjectDataParser._getNumber(e,t.DataParser.Y,this._frameDefaultValue);break;case 1:a=this._parseTweenFrame(e,i,n);var s=this._frameIntArray.length;this._frameIntArray.length+=2,this._frameIntArray[s]=Math.round(ObjectDataParser._getNumber(e,t.DataParser.X,this._frameDefaultValue)*this._frameValueScale),this._frameIntArray[s+1]=Math.round(ObjectDataParser._getNumber(e,t.DataParser.Y,this._frameDefaultValue)*this._frameValueScale);break;case 2:a=this._parseTweenFrame(e,i,n);s=this._frameFloatArray.length;this._frameFloatArray.length+=2,this._frameFloatArray[s]=ObjectDataParser._getNumber(e,t.DataParser.X,this._frameDefaultValue)*this._frameValueScale,this._frameFloatArray[s+1]=ObjectDataParser._getNumber(e,t.DataParser.Y,this._frameDefaultValue)*this._frameValueScale}return a},ObjectDataParser.prototype._parseActionFrame=function(t,e,i){var n=this._frameArray.length,a=t.actions.length;this._frameArray.length+=2+a,this._frameArray[n+0]=e,this._frameArray[n+0+1]=a;for(var s=0;s<a;++s)this._frameArray[n+0+2+s]=t.actions[s];return n},ObjectDataParser.prototype._parseZOrderFrame=function(e,i,n){var a=this._parseFrame(e,i,n);if(t.DataParser.Z_ORDER in e){var s=e[t.DataParser.Z_ORDER];if(s.length>0){for(var o=this._armature.sortedSlots.length,h=new Array(o-s.length/2),l=new Array(o),c=0;c<h.length;++c)h[c]=0;for(var p=0;p<o;++p)l[p]=-1;for(var d=0,u=0,m=0,f=s.length;m<f;m+=2){for(var y=s[m],g=s[m+1];d!==y;)h[u++]=d++;l[d+g]=d++}for(;d<o;)h[u++]=d++;this._frameArray.length+=1+o,this._frameArray[a+1]=o;for(var P=o;P--;)-1===l[P]?this._frameArray[a+2+P]=h[--u]||0:this._frameArray[a+2+P]=l[P]||0;return a}}return this._frameArray.length+=1,this._frameArray[a+1]=0,a},ObjectDataParser.prototype._parseBoneAllFrame=function(e,i,n){this._helpTransform.identity(),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],this._helpTransform,1);var a=this._helpTransform.rotation;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=ObjectDataParser._getNumber(e,t.DataParser.TWEEN_ROTATE,0),this._prevRotation=a;var s=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[o++]=this._helpTransform.x,this._frameFloatArray[o++]=this._helpTransform.y,this._frameFloatArray[o++]=a,this._frameFloatArray[o++]=this._helpTransform.skew,this._frameFloatArray[o++]=this._helpTransform.scaleX,this._frameFloatArray[o++]=this._helpTransform.scaleY,this._parseActionDataInFrame(e,i,this._bone,this._slot),s},ObjectDataParser.prototype._parseBoneTranslateFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[s++]=ObjectDataParser._getNumber(e,t.DataParser.X,0),this._frameFloatArray[s++]=ObjectDataParser._getNumber(e,t.DataParser.Y,0),a},ObjectDataParser.prototype._parseBoneRotateFrame=function(e,i,n){var a=ObjectDataParser._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=ObjectDataParser._getNumber(e,t.DataParser.CLOCK_WISE,0),this._prevRotation=a;var s=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[o++]=a,this._frameFloatArray[o++]=ObjectDataParser._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD,s},ObjectDataParser.prototype._parseBoneScaleFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[s++]=ObjectDataParser._getNumber(e,t.DataParser.X,1),this._frameFloatArray[s++]=ObjectDataParser._getNumber(e,t.DataParser.Y,1),a},ObjectDataParser.prototype._parseSlotDisplayFrame=function(e,i,n){var a=this._parseFrame(e,i,n);return this._frameArray.length+=1,t.DataParser.VALUE in e?this._frameArray[a+1]=ObjectDataParser._getNumber(e,t.DataParser.VALUE,0):this._frameArray[a+1]=ObjectDataParser._getNumber(e,t.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(e,i,this._slot.parent,this._slot),a},ObjectDataParser.prototype._parseSlotColorFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=-1;if(t.DataParser.VALUE in e||t.DataParser.COLOR in e){var o=t.DataParser.VALUE in e?e[t.DataParser.VALUE]:e[t.DataParser.COLOR];for(var h in o){this._parseColorTransform(o,this._helpColorTransform),s=this._colorArray.length,this._colorArray.length+=8,this._colorArray[s++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._colorArray[s++]=Math.round(100*this._helpColorTransform.redMultiplier),this._colorArray[s++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._colorArray[s++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._colorArray[s++]=Math.round(this._helpColorTransform.alphaOffset),this._colorArray[s++]=Math.round(this._helpColorTransform.redOffset),this._colorArray[s++]=Math.round(this._helpColorTransform.greenOffset),this._colorArray[s++]=Math.round(this._helpColorTransform.blueOffset),s-=8;break}}s<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=s=this._colorArray.length,this._colorArray.length+=8,this._colorArray[s++]=100,this._colorArray[s++]=100,this._colorArray[s++]=100,this._colorArray[s++]=100,this._colorArray[s++]=0,this._colorArray[s++]=0,this._colorArray[s++]=0,this._colorArray[s++]=0),s=this._defaultColorOffset);var l=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[l]=s,a},ObjectDataParser.prototype._parseSlotDeformFrame=function(e,i,n){var a=this._frameFloatArray.length,s=this._parseTweenFrame(e,i,n),o=t.DataParser.VERTICES in e?e[t.DataParser.VERTICES]:null,h=ObjectDataParser._getNumber(e,t.DataParser.OFFSET,0),l=this._intArray[this._mesh.geometry.offset+0],c=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,p=this._mesh.geometry.weight,d=0,u=0,m=0,f=0;if(null!==p){var y=this._weightSlotPose[c];this._helpMatrixA.copyFromArray(y,0),this._frameFloatArray.length+=2*p.count,m=p.offset+2+p.bones.length}else this._frameFloatArray.length+=2*l;for(var g=0;g<2*l;g+=2)if(null===o?(d=0,u=0):(d=g<h||g-h>=o.length?0:o[g-h],u=g+1<h||g+1-h>=o.length?0:o[g+1-h]),null!==p){var P=this._weightBonePoses[c],_=this._intArray[m++];this._helpMatrixA.transformPoint(d,u,this._helpPoint,!0),d=this._helpPoint.x,u=this._helpPoint.y;for(var v=0;v<_;++v){var b=this._intArray[m++];this._helpMatrixB.copyFromArray(P,7*b+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(d,u,this._helpPoint,!0),this._frameFloatArray[a+f++]=this._helpPoint.x,this._frameFloatArray[a+f++]=this._helpPoint.y}}else this._frameFloatArray[a+g]=d,this._frameFloatArray[a+g+1]=u;if(0===i){var T=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[T+0]=this._mesh.geometry.offset,this._frameIntArray[T+1]=this._frameFloatArray.length-a,this._frameIntArray[T+2]=this._frameFloatArray.length-a,this._frameIntArray[T+3]=0,this._frameIntArray[T+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=T-this._animation.frameIntOffset}return s},ObjectDataParser.prototype._parseIKConstraintFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),s=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[s++]=ObjectDataParser._getBoolean(e,t.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[s++]=Math.round(100*ObjectDataParser._getNumber(e,t.DataParser.WEIGHT,1)),a},ObjectDataParser.prototype._parseActionData=function(e,i,n,a){var s=new Array;if("string"==typeof e)(c=t.BaseObject.borrowObject(t.ActionData)).type=i,c.name=e,c.bone=n,c.slot=a,s.push(c);else if(e instanceof Array)for(var o=0,h=e;o<h.length;o++){var l=h[o],c=t.BaseObject.borrowObject(t.ActionData);if(t.DataParser.GOTO_AND_PLAY in l?(c.type=0,c.name=ObjectDataParser._getString(l,t.DataParser.GOTO_AND_PLAY,"")):(t.DataParser.TYPE in l&&"string"==typeof l[t.DataParser.TYPE]?c.type=t.DataParser._getActionType(l[t.DataParser.TYPE]):c.type=ObjectDataParser._getNumber(l,t.DataParser.TYPE,i),c.name=ObjectDataParser._getString(l,t.DataParser.NAME,"")),t.DataParser.BONE in l){var p=ObjectDataParser._getString(l,t.DataParser.BONE,"");c.bone=this._armature.getBone(p)}else c.bone=n;if(t.DataParser.SLOT in l){var d=ObjectDataParser._getString(l,t.DataParser.SLOT,"");c.slot=this._armature.getSlot(d)}else c.slot=a;var u=null;if(t.DataParser.INTS in l){null===u&&(u=t.BaseObject.borrowObject(t.UserData));for(var m=0,f=l[t.DataParser.INTS];m<f.length;m++){var y=f[m];u.addInt(y)}}if(t.DataParser.FLOATS in l){null===u&&(u=t.BaseObject.borrowObject(t.UserData));for(var g=0,P=l[t.DataParser.FLOATS];g<P.length;g++){y=P[g];u.addFloat(y)}}if(t.DataParser.STRINGS in l){null===u&&(u=t.BaseObject.borrowObject(t.UserData));for(var _=0,v=l[t.DataParser.STRINGS];_<v.length;_++){y=v[_];u.addString(y)}}c.data=u,s.push(c)}return s},ObjectDataParser.prototype._parseDeformFrame=function(e,i,n){var a=this._frameFloatArray.length,s=this._parseTweenFrame(e,i,n),o=t.DataParser.VERTICES in e?e[t.DataParser.VERTICES]:t.DataParser.VALUE in e?e[t.DataParser.VALUE]:null,h=ObjectDataParser._getNumber(e,t.DataParser.OFFSET,0),l=this._intArray[this._geometry.offset+0],c=0,p=0;if(null!==this._geometry.weight);else{this._frameFloatArray.length+=2*l;for(var d=0;d<2*l;d+=2)null!==o?(c=d<h||d-h>=o.length?0:o[d-h],p=d+1<h||d+1-h>=o.length?0:o[d+1-h]):(c=0,p=0),this._frameFloatArray[a+d]=c,this._frameFloatArray[a+d+1]=p}if(0===i){var u=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[u+0]=this._geometry.offset,this._frameIntArray[u+1]=this._frameFloatArray.length-a,this._frameIntArray[u+2]=this._frameFloatArray.length-a,this._frameIntArray[u+3]=0,this._frameIntArray[u+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=u-this._animation.frameIntOffset}return s},ObjectDataParser.prototype._parseTransform=function(e,i,n){i.x=ObjectDataParser._getNumber(e,t.DataParser.X,0)*n,i.y=ObjectDataParser._getNumber(e,t.DataParser.Y,0)*n,t.DataParser.ROTATE in e||t.DataParser.SKEW in e?(i.rotation=t.Transform.normalizeRadian(ObjectDataParser._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(ObjectDataParser._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD)):(t.DataParser.SKEW_X in e||t.DataParser.SKEW_Y in e)&&(i.rotation=t.Transform.normalizeRadian(ObjectDataParser._getNumber(e,t.DataParser.SKEW_Y,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(ObjectDataParser._getNumber(e,t.DataParser.SKEW_X,0)*t.Transform.DEG_RAD)-i.rotation),i.scaleX=ObjectDataParser._getNumber(e,t.DataParser.SCALE_X,1),i.scaleY=ObjectDataParser._getNumber(e,t.DataParser.SCALE_Y,1)},ObjectDataParser.prototype._parseColorTransform=function(e,i){i.alphaMultiplier=.01*ObjectDataParser._getNumber(e,t.DataParser.ALPHA_MULTIPLIER,100),i.redMultiplier=.01*ObjectDataParser._getNumber(e,t.DataParser.RED_MULTIPLIER,100),i.greenMultiplier=.01*ObjectDataParser._getNumber(e,t.DataParser.GREEN_MULTIPLIER,100),i.blueMultiplier=.01*ObjectDataParser._getNumber(e,t.DataParser.BLUE_MULTIPLIER,100),i.alphaOffset=ObjectDataParser._getNumber(e,t.DataParser.ALPHA_OFFSET,0),i.redOffset=ObjectDataParser._getNumber(e,t.DataParser.RED_OFFSET,0),i.greenOffset=ObjectDataParser._getNumber(e,t.DataParser.GREEN_OFFSET,0),i.blueOffset=ObjectDataParser._getNumber(e,t.DataParser.BLUE_OFFSET,0)},ObjectDataParser.prototype._parseGeometry=function(e,i){var n=e[t.DataParser.VERTICES],a=Math.floor(n.length/2),s=0,o=this._intArray.length,h=this._floatArray.length;i.offset=o,i.data=this._data,this._intArray.length+=4,this._intArray[o+0]=a,this._intArray[o+2]=h,this._intArray[o+3]=-1,this._floatArray.length+=2*a;for(var l=0,c=2*a;l<c;++l)this._floatArray[h+l]=n[l];if(t.DataParser.TRIANGLES in e){var p=e[t.DataParser.TRIANGLES];s=Math.floor(p.length/3),this._intArray.length+=3*s;for(l=0,c=3*s;l<c;++l)this._intArray[o+4+l]=p[l]}if(this._intArray[o+1]=s,t.DataParser.UVS in e){var d=e[t.DataParser.UVS],u=h+2*a;this._floatArray.length+=2*a;for(l=0,c=2*a;l<c;++l)this._floatArray[u+l]=d[l]}if(t.DataParser.WEIGHTS in e){var m=e[t.DataParser.WEIGHTS],f=Math.floor(m.length-a)/2,y=this._intArray.length,g=this._floatArray.length,P=0,_=this._armature.sortedBones,v=t.BaseObject.borrowObject(t.WeightData);if(v.count=f,v.offset=y,this._intArray.length+=2+P+a+f,this._intArray[y+1]=g,t.DataParser.BONE_POSE in e){var b=e[t.DataParser.SLOT_POSE],T=e[t.DataParser.BONE_POSE],S=new Array;P=Math.floor(T.length/7),S.length=P;for(l=0;l<P;++l){var x=T[7*l],w=this._rawBones[x];v.addBone(w),S[l]=x,this._intArray[y+2+l]=_.indexOf(w)}this._floatArray.length+=3*f,this._helpMatrixA.copyFromArray(b,0);l=0;for(var D=0,C=y+2+P,I=g;l<a;++l){var k=2*l,B=this._intArray[C++]=m[D++],E=this._floatArray[h+k],A=this._floatArray[h+k+1];this._helpMatrixA.transformPoint(E,A,this._helpPoint),E=this._helpPoint.x,A=this._helpPoint.y;for(var O=0;O<B;++O){x=m[D++];var M=S.indexOf(x);this._helpMatrixB.copyFromArray(T,7*M+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(E,A,this._helpPoint),this._intArray[C++]=M,this._floatArray[I++]=m[D++],this._floatArray[I++]=this._helpPoint.x,this._floatArray[I++]=this._helpPoint.y}}}else{var R=e[t.DataParser.BONES];P=R.length;for(l=0;l<P;l++){x=R[l],w=this._rawBones[x];v.addBone(w),this._intArray[y+2+l]=_.indexOf(w)}this._floatArray.length+=3*f;l=0,D=0,I=0,C=y+2+P;for(var F=g;l<f;l++){B=m[D++];this._intArray[C++]=B;for(O=0;O<B;O++){M=m[D++];var N=m[D++];E=n[I++],A=n[I++];this._intArray[C++]=R.indexOf(M),this._floatArray[F++]=N,this._floatArray[F++]=E,this._floatArray[F++]=A}}}i.weight=v}},ObjectDataParser.prototype._parseArray=function(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0,this._colorArray.length=0},ObjectDataParser.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0),this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._colorArray.push(0);for(var t=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,e=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,i=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,n=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,a=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,s=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,o=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT,h=new ArrayBuffer(t+e+i+n+a+s+o),l=new Int16Array(h,0,this._intArray.length),c=new Float32Array(h,t,this._floatArray.length),p=new Int16Array(h,t+e,this._frameIntArray.length),d=new Float32Array(h,t+e+i,this._frameFloatArray.length),u=new Int16Array(h,t+e+i+n,this._frameArray.length),m=new Uint16Array(h,t+e+i+n+a,this._timelineArray.length),f=new Int16Array(h,t+e+i+n+a+s,this._colorArray.length),y=0,g=this._intArray.length;y<g;++y)l[y]=this._intArray[y];for(y=0,g=this._floatArray.length;y<g;++y)c[y]=this._floatArray[y];for(y=0,g=this._frameIntArray.length;y<g;++y)p[y]=this._frameIntArray[y];for(y=0,g=this._frameFloatArray.length;y<g;++y)d[y]=this._frameFloatArray[y];for(y=0,g=this._frameArray.length;y<g;++y)u[y]=this._frameArray[y];for(y=0,g=this._timelineArray.length;y<g;++y)m[y]=this._timelineArray[y];for(y=0,g=this._colorArray.length;y<g;++y)f[y]=this._colorArray[y];this._data.binary=h,this._data.intArray=l,this._data.floatArray=c,this._data.frameIntArray=p,this._data.frameFloatArray=d,this._data.frameArray=u,this._data.timelineArray=m,this._data.colorArray=f,this._defaultColorOffset=-1},ObjectDataParser.prototype.parseDragonBonesData=function(e,i){void 0===i&&(i=1),console.assert(null!=e,"Data error.");var n=ObjectDataParser._getString(e,t.DataParser.VERSION,""),a=ObjectDataParser._getString(e,t.DataParser.COMPATIBLE_VERSION,"");if(t.DataParser.DATA_VERSIONS.indexOf(n)>=0||t.DataParser.DATA_VERSIONS.indexOf(a)>=0){var s=t.BaseObject.borrowObject(t.DragonBonesData);if(s.version=n,s.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),s.frameRate=ObjectDataParser._getNumber(e,t.DataParser.FRAME_RATE,24),0===s.frameRate&&(s.frameRate=24),t.DataParser.ARMATURE in e){this._data=s,this._parseArray(e);for(var o=0,h=e[t.DataParser.ARMATURE];o<h.length;o++){var l=h[o];s.addArmature(this._parseArmature(l,i))}this._data.binary||this._modifyArray(),t.DataParser.STAGE in e?s.stage=s.getArmature(ObjectDataParser._getString(e,t.DataParser.STAGE,"")):s.armatureNames.length>0&&(s.stage=s.getArmature(s.armatureNames[0])),this._data=null}return t.DataParser.TEXTURE_ATLAS in e&&(this._rawTextureAtlases=e[t.DataParser.TEXTURE_ATLAS]),s}return console.assert(!1,"Nonsupport data version: "+n+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},ObjectDataParser.prototype.parseTextureAtlasData=function(e,i,n){if(void 0===n&&(n=1),console.assert(void 0!==e),null===e){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var a=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(a,i,n),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(i.width=ObjectDataParser._getNumber(e,t.DataParser.WIDTH,0),i.height=ObjectDataParser._getNumber(e,t.DataParser.HEIGHT,0),i.scale=1===n?1/ObjectDataParser._getNumber(e,t.DataParser.SCALE,1):n,i.name=ObjectDataParser._getString(e,t.DataParser.NAME,""),i.imagePath=ObjectDataParser._getString(e,t.DataParser.IMAGE_PATH,""),t.DataParser.SUB_TEXTURE in e)for(var s=e[t.DataParser.SUB_TEXTURE],o=0,h=s.length;o<h;++o){var l=s[o],c=ObjectDataParser._getNumber(l,t.DataParser.FRAME_WIDTH,-1),p=ObjectDataParser._getNumber(l,t.DataParser.FRAME_HEIGHT,-1),d=i.createTexture();d.rotated=ObjectDataParser._getBoolean(l,t.DataParser.ROTATED,!1),d.name=ObjectDataParser._getString(l,t.DataParser.NAME,""),d.region.x=ObjectDataParser._getNumber(l,t.DataParser.X,0),d.region.y=ObjectDataParser._getNumber(l,t.DataParser.Y,0),d.region.width=ObjectDataParser._getNumber(l,t.DataParser.WIDTH,0),d.region.height=ObjectDataParser._getNumber(l,t.DataParser.HEIGHT,0),c>0&&p>0&&(d.frame=t.TextureData.createRectangle(),d.frame.x=ObjectDataParser._getNumber(l,t.DataParser.FRAME_X,0),d.frame.y=ObjectDataParser._getNumber(l,t.DataParser.FRAME_Y,0),d.frame.width=c,d.frame.height=p),i.addTexture(d)}return!0},ObjectDataParser.getInstance=function(){return null===ObjectDataParser._objectDataParserInstance&&(ObjectDataParser._objectDataParserInstance=new ObjectDataParser),ObjectDataParser._objectDataParserInstance},ObjectDataParser._objectDataParserInstance=null,ObjectDataParser}(t.DataParser);t.ObjectDataParser=e;var i=function i(){this.frameStart=0,this.actions=[]};t.ActionFrame=i}(c||(c={})),function(t){var e=function(e){function BinaryDataParser(){return null!==e&&e.apply(this,arguments)||this}return a(BinaryDataParser,e),BinaryDataParser.prototype._inRange=function(t,e,i){return e<=t&&t<=i},BinaryDataParser.prototype._decodeUTF8=function(t){for(var e,i=0,n="",a=0,s=0,o=0,h=0;t.length>i;){var l=t[i++];if(-1===l)e=0!==s?65533:-1;else if(0===s)this._inRange(l,0,127)?e=l:(this._inRange(l,194,223)?(s=1,h=128,a=l-192):this._inRange(l,224,239)?(s=2,h=2048,a=l-224):this._inRange(l,240,244)&&(s=3,h=65536,a=l-240),a*=Math.pow(64,s),e=null);else if(this._inRange(l,128,191))if(o+=1,a+=(l-128)*Math.pow(64,s-o),o!==s)e=null;else{var c=a,p=h;a=0,s=0,o=0,h=0,e=this._inRange(c,p,1114111)&&!this._inRange(c,55296,57343)?c:l}else a=0,s=0,o=0,h=0,i--,e=l;null!==e&&-1!==e&&(e<=65535?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},BinaryDataParser.prototype._parseBinaryTimeline=function(e,i,n){void 0===n&&(n=null);var a=null!==n?n:t.BaseObject.borrowObject(t.TimelineData);a.type=e,a.offset=i,this._timeline=a;var s=this._timelineArrayBuffer[a.offset+2];if(1===s)a.frameIndicesOffset=-1;else{var o,h=this._animation.frameCount+1,l=this._data.frameIndices;o=l.length,l.length+=h,a.frameIndicesOffset=o;for(var c=0,p=0,d=0,u=0;c<h;++c)d+u<=c&&p<s&&(d=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[a.offset+5+p]],u=p===s-1?this._animation.frameCount-d:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[a.offset+5+p+1]]-d,p++),l[o+c]=p-1}return this._timeline=null,a},BinaryDataParser.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.blendType=t.DataParser._getAnimationBlendType(t.ObjectDataParser._getString(e,t.DataParser.BLEND_TYPE,"")),i.frameCount=t.ObjectDataParser._getNumber(e,t.DataParser.DURATION,0),i.playTimes=t.ObjectDataParser._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=t.ObjectDataParser._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=t.ObjectDataParser._getNumber(e,t.DataParser.SCALE,1),i.name=t.ObjectDataParser._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME);var n=e[t.DataParser.OFFSET];if(i.frameIntOffset=n[0],i.frameFloatOffset=n[1],i.frameOffset=n[2],this._animation=i,t.DataParser.ACTION in e&&(i.actionTimeline=this._parseBinaryTimeline(0,e[t.DataParser.ACTION])),t.DataParser.Z_ORDER in e&&(i.zOrderTimeline=this._parseBinaryTimeline(1,e[t.DataParser.Z_ORDER])),t.DataParser.BONE in e){var a=e[t.DataParser.BONE];for(var s in a){var o=a[s],h=this._armature.getBone(s);if(null!==h)for(var l=0,c=o.length;l<c;l+=2){var p=o[l],d=o[l+1],u=this._parseBinaryTimeline(p,d);this._animation.addBoneTimeline(h.name,u)}}}if(t.DataParser.SLOT in e){a=e[t.DataParser.SLOT];for(var s in a){o=a[s];var m=this._armature.getSlot(s);if(null!==m)for(l=0,c=o.length;l<c;l+=2){p=o[l],d=o[l+1],u=this._parseBinaryTimeline(p,d);this._animation.addSlotTimeline(m.name,u)}}}if(t.DataParser.CONSTRAINT in e){a=e[t.DataParser.CONSTRAINT];for(var s in a){o=a[s];var f=this._armature.getConstraint(s);if(null!==f)for(l=0,c=o.length;l<c;l+=2){p=o[l],d=o[l+1],u=this._parseBinaryTimeline(p,d);this._animation.addConstraintTimeline(f.name,u)}}}if(t.DataParser.TIMELINE in e)for(var y=0,g=o=e[t.DataParser.TIMELINE];y<g.length;y++){var P=g[y];if((d=t.ObjectDataParser._getNumber(P,t.DataParser.OFFSET,0))>=0){p=t.ObjectDataParser._getNumber(P,t.DataParser.TYPE,0);var _=t.ObjectDataParser._getString(P,t.DataParser.NAME,"");u=null;if(40===p&&0!==i.blendType){var v=u=t.BaseObject.borrowObject(t.AnimationTimelineData);v.x=t.ObjectDataParser._getNumber(P,t.DataParser.X,0),v.y=t.ObjectDataParser._getNumber(P,t.DataParser.Y,0)}switch(u=this._parseBinaryTimeline(p,d,u),p){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(_,u);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(_,u);break;case 30:this._animation.addConstraintTimeline(_,u);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(_,u)}}}return this._animation=null,i},BinaryDataParser.prototype._parseGeometry=function(e,i){i.offset=e[t.DataParser.OFFSET],i.data=this._data;var n=this._intArrayBuffer[i.offset+3];if(n<-1&&(n+=65536),n>=0){var a=t.BaseObject.borrowObject(t.WeightData),s=this._intArrayBuffer[i.offset+0],o=this._intArrayBuffer[n+0];a.offset=n;for(var h=0;h<o;++h){var l=this._intArrayBuffer[n+2+h];a.addBone(this._rawBones[l])}for(var c=n+2+o,p=0,d=(h=0,s);h<d;++h){var u=this._intArrayBuffer[c++];p+=u,c+=u}a.count=p,i.weight=a}},BinaryDataParser.prototype._parseArray=function(e){var i=e[t.DataParser.OFFSET],n=i[1],a=i[3],s=i[5],o=i[7],h=i[9],l=i[11],c=i.length>12?i[13]:0,p=new Int16Array(this._binary,this._binaryOffset+i[0],n/Int16Array.BYTES_PER_ELEMENT),d=new Float32Array(this._binary,this._binaryOffset+i[2],a/Float32Array.BYTES_PER_ELEMENT),u=new Int16Array(this._binary,this._binaryOffset+i[4],s/Int16Array.BYTES_PER_ELEMENT),m=new Float32Array(this._binary,this._binaryOffset+i[6],o/Float32Array.BYTES_PER_ELEMENT),f=new Int16Array(this._binary,this._binaryOffset+i[8],h/Int16Array.BYTES_PER_ELEMENT),y=new Uint16Array(this._binary,this._binaryOffset+i[10],l/Uint16Array.BYTES_PER_ELEMENT),g=c>0?new Int16Array(this._binary,this._binaryOffset+i[12],c/Uint16Array.BYTES_PER_ELEMENT):p;this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=p,this._data.floatArray=d,this._data.frameIntArray=u,this._data.frameFloatArray=m,this._data.frameArray=this._frameArrayBuffer=f,this._data.timelineArray=this._timelineArrayBuffer=y,this._data.colorArray=g},BinaryDataParser.prototype.parseDragonBonesData=function(t,i){void 0===i&&(i=1),console.assert(null!=t&&t instanceof ArrayBuffer,"Data error.");var n=new Uint8Array(t,0,8);if(n[0]!=="D".charCodeAt(0)||n[1]!=="B".charCodeAt(0)||n[2]!=="D".charCodeAt(0)||n[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var a=new Uint32Array(t,8,1)[0],s=new Uint8Array(t,12,a),o=this._decodeUTF8(s),h=JSON.parse(o);return this._binaryOffset=12+a,this._binary=t,e.prototype.parseDragonBonesData.call(this,h,i)},BinaryDataParser.getInstance=function(){return null===BinaryDataParser._binaryDataParserInstance&&(BinaryDataParser._binaryDataParserInstance=new BinaryDataParser),BinaryDataParser._binaryDataParserInstance},BinaryDataParser._binaryDataParserInstance=null,BinaryDataParser}(t.ObjectDataParser);t.BinaryDataParser=e}(c||(c={})),function(t){var e=function(){function BaseFactory(e){void 0===e&&(e=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,null===BaseFactory._objectParser&&(BaseFactory._objectParser=new t.ObjectDataParser),null===BaseFactory._binaryParser&&(BaseFactory._binaryParser=new t.BinaryDataParser),this._dataParser=null!==e?e:BaseFactory._objectParser}return BaseFactory.prototype._isSupportMesh=function(){return!0},BaseFactory.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap)for(var i=0,n=this._textureAtlasDataMap[t];i<n.length;i++){if(null!==(l=(h=n[i]).getTexture(e)))return l}if(this.autoSearch)for(var a in this._textureAtlasDataMap)for(var s=0,o=this._textureAtlasDataMap[a];s<o.length;s++){var h,l;if((h=o[s]).autoSearch)if(null!==(l=h.getTexture(e)))return l}return null},BaseFactory.prototype._fillBuildArmaturePackage=function(t,e,i,n,a){var s=null,o=null;if(e.length>0&&e in this._dragonBonesDataMap&&(o=(s=this._dragonBonesDataMap[e]).getArmature(i)),null===o&&(0===e.length||this.autoSearch))for(var h in this._dragonBonesDataMap)if(s=this._dragonBonesDataMap[h],(0===e.length||s.autoSearch)&&null!==(o=s.getArmature(i))){e=h;break}if(null!==o){if(t.dataName=e,t.textureAtlasName=a,t.data=s,t.armature=o,t.skin=null,n.length>0&&(t.skin=o.getSkin(n),null===t.skin&&this.autoSearch))for(var h in this._dragonBonesDataMap){var l=this._dragonBonesDataMap[h].getArmature(n);if(null!==l){t.skin=l.defaultSkin;break}}return null===t.skin&&(t.skin=o.defaultSkin),!0}return!1},BaseFactory.prototype._buildBones=function(e,i){for(var n=0,a=e.armature.sortedBones;n<a.length;n++){var s=a[n];t.BaseObject.borrowObject(0===s.type?t.Bone:t.Surface).init(s,i)}},BaseFactory.prototype._buildSlots=function(t,e){var i=t.skin,n=t.armature.defaultSkin;if(null!==i&&null!==n){var a={};for(var s in n.displays){var o=n.getDisplays(s);a[s]=o}if(i!==n)for(var s in i.displays){o=i.getDisplays(s);a[s]=o}for(var h=0,l=t.armature.sortedSlots;h<l.length;h++){var c=l[h],p=c.name in a?a[c.name]:null,d=this._buildSlot(t,c,e);if(null!==p){d.displayFrameCount=p.length;for(var u=0,m=d.displayFrameCount;u<m;++u){var f=p[u];if(d.replaceRawDisplayData(f,u),null!==f){if(t.textureAtlasName.length>0){var y=this._getTextureData(t.textureAtlasName,f.path);d.replaceTextureData(y,u)}var g=this._getSlotDisplay(t,f,d);d.replaceDisplay(g,u)}else d.replaceDisplay(null)}}d._setDisplayIndex(c.displayIndex,!0)}}},BaseFactory.prototype._buildConstraints=function(e,i){var n=e.armature.constraints;for(var a in n){var s=n[a];switch(s.type){case 0:var o=t.BaseObject.borrowObject(t.IKConstraint);o.init(s,i),i._addConstraint(o);break;case 1:var h=t.BaseObject.borrowObject(t.PathConstraint);h.init(s,i),i._addConstraint(h);break;default:var l=t.BaseObject.borrowObject(t.IKConstraint);l.init(s,i),i._addConstraint(l)}}},BaseFactory.prototype._buildChildArmature=function(t,e,i){return this.buildArmature(i.path,null!==t?t.dataName:"","",null!==t?t.textureAtlasName:"")},BaseFactory.prototype._getSlotDisplay=function(e,i,n){var a=null!==e?e.dataName:i.parent.parent.parent.name,s=null;switch(i.type){case 0:var o=i;null===o.texture&&(o.texture=this._getTextureData(a,i.path)),s=n.rawDisplay;break;case 2:var h=i;null===h.texture&&(h.texture=this._getTextureData(a,h.path)),s=this._isSupportMesh()?n.meshDisplay:n.rawDisplay;break;case 1:var l=i,c=this._buildChildArmature(e,n,l);if(null!==c){if(c.inheritAnimation=l.inheritAnimation,!c.inheritAnimation){var p=l.actions.length>0?l.actions:c.armatureData.defaultActions;if(p.length>0)for(var d=0,u=p;d<u.length;d++){var m=u[d],f=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(m,f,n.armature),f.slot=n,n.armature._bufferAction(f,!1)}else c.animation.play()}l.armature=c.armatureData}s=c}return s},BaseFactory.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);for(var n=t instanceof ArrayBuffer?BaseFactory._binaryParser:this._dataParser,a=n.parseDragonBonesData(t,i);;){var s=this._buildTextureAtlasData(null,null);if(!n.parseTextureAtlasData(null,s,i)){s.returnToPool();break}this.addTextureAtlasData(s,e)}return null!==a&&this.addDragonBonesData(a,e),a},BaseFactory.prototype.parseTextureAtlasData=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=1);var a=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,a,n),this._buildTextureAtlasData(a,e||null),this.addTextureAtlasData(a,i),a},BaseFactory.prototype.updateTextureAtlases=function(t,e){var i=this.getTextureAtlasData(e);if(null!==i)for(var n=0,a=i.length;n<a;++n)n<t.length&&this._buildTextureAtlasData(i[n],t[n])},BaseFactory.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null},BaseFactory.prototype.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),(e=null!==e?e:t.name)in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t)return;console.warn("Can not add same name data: "+e)}else this._dragonBonesDataMap[e]=t},BaseFactory.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0),t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])},BaseFactory.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null},BaseFactory.prototype.addTextureAtlasData=function(t,e){void 0===e&&(e=null);var i=(e=null!==e?e:t.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];i.indexOf(t)<0&&i.push(t)},BaseFactory.prototype.removeTextureAtlasData=function(t,e){if(void 0===e&&(e=!0),t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e)for(var n=0,a=i;n<a.length;n++){var s=a[n];this._dragonBones.bufferObject(s)}delete this._textureAtlasDataMap[t]}},BaseFactory.prototype.getArmatureData=function(t,e){void 0===e&&(e="");var n=new i;return this._fillBuildArmaturePackage(n,e,t,"","")?n.armature:null},BaseFactory.prototype.clear=function(t){for(var e in void 0===t&&(t=!0),this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=0,n=this._textureAtlasDataMap[e];i<n.length;i++){var a=n[i];this._dragonBones.bufferObject(a)}delete this._textureAtlasDataMap[e]}},BaseFactory.prototype.buildArmature=function(t,e,n,a){void 0===e&&(e=""),void 0===n&&(n=""),void 0===a&&(a="");var s=new i;if(!this._fillBuildArmaturePackage(s,e||"",t,n||"",a||""))return console.warn("No armature data: "+t+", "+(null!==e?e:"")),null;var o=this._buildArmature(s);return this._buildBones(s,o),this._buildSlots(s,o),this._buildConstraints(s,o),o.invalidUpdate(null,!0),o.advanceTime(0),o},BaseFactory.prototype.replaceDisplay=function(t,e,i){if(void 0===i&&(i=-1),i<0&&(i=t.displayIndex),i<0&&(i=0),t.replaceDisplayData(e,i),null!==e){var n=this._getSlotDisplay(null,e,t);if(0===e.type){var a=t.getDisplayFrameAt(i).rawDisplayData;null!==a&&2===a.type&&(n=t.meshDisplay)}t.replaceDisplay(n,i)}else t.replaceDisplay(null,i)},BaseFactory.prototype.replaceSlotDisplay=function(t,e,i,n,a,s){void 0===s&&(s=-1);var o=this.getArmatureData(e,t||"");if(null===o||null===o.defaultSkin)return!1;var h=o.defaultSkin.getDisplay(i,n);return this.replaceDisplay(a,h,s),!0},BaseFactory.prototype.replaceSlotDisplayList=function(t,e,i,n){var a=this.getArmatureData(e,t||"");if(!a||!a.defaultSkin)return!1;var s=a.defaultSkin.getDisplays(i);if(!s)return!1;n.displayFrameCount=s.length;for(var o=0,h=n.displayFrameCount;o<h;++o){var l=s[o];this.replaceDisplay(n,l,o)}return!0},BaseFactory.prototype.replaceSkin=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=null);for(var a=!1,s=e.parent.defaultSkin,o=0,h=t.getSlots();o<h.length;o++){var l=h[o];if(!(null!==n&&n.indexOf(l.name)>=0)){var c=e.getDisplays(l.name);if(null!==c||(null!==s&&e!==s&&(c=s.getDisplays(l.name)),null!==c)){l.displayFrameCount=c.length;for(var p=0,d=l.displayFrameCount;p<d;++p){var u=c[p];l.replaceRawDisplayData(u,p),null!==u?l.replaceDisplay(this._getSlotDisplay(null,u,l),p):l.replaceDisplay(null,p)}a=!0}else i&&(l.displayFrameCount=0)}}return a},BaseFactory.prototype.replaceAnimation=function(e,i,n){void 0===n&&(n=!0);var a=i.defaultSkin;if(null===a)return!1;if(n)e.animation.animations=i.animations;else{var s=e.animation.animations,o={};for(var h in s)o[h]=s[h];for(var h in i.animations)o[h]=i.animations[h];e.animation.animations=o}for(var l=0,c=e.getSlots();l<c.length;l++)for(var p=c[l],d=0,u=0,m=p.displayList;u<m.length;u++){var f=m[u];if(f instanceof t.Armature){var y=a.getDisplays(p.name);if(null!==y&&d<y.length){var g=y[d];if(null!==g&&1===g.type){var P=this.getArmatureData(g.path,g.parent.parent.parent.name);P&&this.replaceAnimation(f,P,n)}}}d++}return!0},BaseFactory.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},BaseFactory.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(BaseFactory.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(BaseFactory.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),BaseFactory._objectParser=null,BaseFactory._binaryParser=null,BaseFactory}();t.BaseFactory=e;var i=function i(){this.dataName="",this.textureAtlasName="",this.skin=null};t.BuildArmaturePackage=i}(c||(c={})),function(t){!function(t){!function(t){var e=function(t){function EventDispatcher(){return null!==t&&t.apply(this,arguments)||this}return a(EventDispatcher,t),EventDispatcher.prototype.hasDBEventListener=function(t){return this.listenerCount(t)>0},EventDispatcher.prototype.dispatchDBEvent=function(t,e){this.emit(t,e)},EventDispatcher.prototype.addDBEventListener=function(t,e,i){this.on(t,e,i)},EventDispatcher.prototype.removeDBEventListener=function(t,e,i){this.off(t,e,i)},EventDispatcher}(Phaser.Events.EventEmitter);t.EventDispatcher=e}(t.util||(t.util={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(t){t.Skew={getSkewX:function(){return this._skewX||0},setSkewX:function(t){this._skewX=t},getSkewY:function(){return this._skewY||0},setSkewY:function(t){this._skewY=t},setSkew:function(t,e){e=void 0===e?t:e,this._skewX=t,this._skewY=e}},t.extendSkew=function(e){Object.defineProperty(e.prototype,"skewX",{get:t.Skew.getSkewX,set:t.Skew.setSkewX,enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skewY",{get:t.Skew.getSkewY,set:t.Skew.setSkewY,enumerable:!0,configurable:!0}),e.prototype.setSkew=t.Skew.setSkew}}(t.util||(t.util={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(t){var e=function(t){function TransformMatrix(e,i,n,a,s,o){var h=t.call(this,e,i,n,a,s,o)||this;return h.decomposedMatrix.skewX=0,h.decomposedMatrix.skewY=0,h}return a(TransformMatrix,t),TransformMatrix.prototype.decomposeMatrix=function(){var t=this.a,e=this.b,i=this.c,n=this.d,a=-Math.atan2(-i,n),s=Math.atan2(e,t),o=Math.abs(a+s);return o<1e-5||Math.abs(Phaser.Math.PI2-o)<1e-5?(this.decomposedMatrix.rotation=s,t<0&&n>=0&&(this.decomposedMatrix.rotation+=this.decomposedMatrix.rotation<=0?Math.PI:-Math.PI),this.decomposedMatrix.skewX=this.decomposedMatrix.skewY=0):(this.decomposedMatrix.rotation=0,this.decomposedMatrix.skewX=a,this.decomposedMatrix.skewY=s),this.decomposedMatrix.scaleX=Math.sqrt(t*t+e*e),this.decomposedMatrix.scaleY=Math.sqrt(i*i+n*n),this.decomposedMatrix.translateX=this.tx,this.decomposedMatrix.translateY=this.ty,this.decomposedMatrix},TransformMatrix.prototype.applyITRSC=function(t,e,i,n,a,s,o){return this.a=Math.cos(i-o)*n,this.b=Math.sin(i-o)*n,this.c=-Math.sin(i+s)*a,this.d=Math.cos(i+s)*a,this.tx=t,this.ty=e,this},Object.defineProperty(TransformMatrix.prototype,"skewX",{get:function(){return-Math.atan2(-this.c,this.d)},enumerable:!0,configurable:!0}),Object.defineProperty(TransformMatrix.prototype,"skewY",{get:function(){return Math.atan2(this.b,this.a)},enumerable:!0,configurable:!0}),TransformMatrix}(Phaser.GameObjects.Components.TransformMatrix);t.TransformMatrix=e}(t.util||(t.util={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(e){var i=function(e){function DisplayContainer(i,n,a,s){var o=e.call(this,i,n,a,s)||this;return o._skewX=0,o._skewY=0,o.tempTransformMatrix=new t.util.TransformMatrix,o}return a(DisplayContainer,e),DisplayContainer.prototype.pointToContainer=function(t,e){if(void 0===e&&(e=new Phaser.Math.Vector2),this.parentContainer)return this.parentContainer.pointToContainer(t,e);var i=this.tempTransformMatrix;return i.applyITRSC(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this._skewX,this._skewY),i.invert(),i.transformPoint(t.x,t.y,e),e},Object.defineProperty(DisplayContainer.prototype,"skewX",{get:function(){return this._skewX},set:function(t){this._skewX=t},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayContainer.prototype,"skewY",{get:function(){return this._skewY},set:function(t){this._skewY=t},enumerable:!0,configurable:!0}),DisplayContainer.prototype.setSkew=function(t,e){return e=void 0===e?t:e,this.skewX=t,this.skewY=e,this},DisplayContainer}(Phaser.GameObjects.Container);e.DisplayContainer=i}(t.display||(t.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){var e,i;e=t.display||(t.display={}),i=function(t){function ArmatureDisplay(e){var i=t.call(this,e)||this;return i.debugDraw=!1,i}return a(ArmatureDisplay,t),ArmatureDisplay.prototype.dbInit=function(t){this._armature=t},ArmatureDisplay.prototype.dbClear=function(){this.removeAllListeners(),this._armature&&this._armature.dispose(),this._armature=null},ArmatureDisplay.prototype.dbUpdate=function(){this.debugDraw},ArmatureDisplay.prototype.dispose=function(e){this.dbClear(),!0===e&&t.prototype.destroy.call(this)},ArmatureDisplay.prototype.destroy=function(){this.dispose(!0)},ArmatureDisplay.prototype.dispatchDBEvent=function(t,e){this.emit(t,e)},ArmatureDisplay.prototype.hasDBEventListener=function(t){return this.listenerCount(t)>0},ArmatureDisplay.prototype.addDBEventListener=function(t,e,i){this.on(t,e,i)},ArmatureDisplay.prototype.removeDBEventListener=function(t,e,i){this.off(t,e,i)},Object.defineProperty(ArmatureDisplay.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(ArmatureDisplay.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),ArmatureDisplay.prototype.getBounds=function(t){void 0===t&&(t=new Phaser.Geom.Rectangle);for(var e=new Phaser.Geom.Rectangle,i=this.getBoundsTransformMatrix(),n=!0,a=0,s=this._armature.getSlots();a<s.length;a++){var o=s[a],h=o.display;if(h){if(h===o.meshDisplay){var l=h.fakeVertices;if(!(l&&l.length>0))continue;e.setTo(999999,999999,-999999,-999999);for(var c=0,p=l.length;c<p;c+=2){var d=l[c],u=l[c+1];e.x>d&&(e.x=d),e.width<d&&(e.width=d),e.y>u&&(e.y=u),e.height<u&&(e.height=u)}e.width-=e.x,e.height-=e.y}else if(o._displayFrame){var m=o._displayFrame.getTextureData();if(!m)continue;var f=m.parent.scale;e.width=m.region.width*f,e.height=m.region.height*f,e.x=-e.width/2,e.y=-e.height/2}e.width*=this.scaleX,e.height*=this.scaleY,i.transformPoint(e.x,e.y,e),n?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,n=!1):Phaser.Geom.Rectangle.Union(e,t,t)}}return t},ArmatureDisplay}(e.DisplayContainer),e.ArmatureDisplay=i}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(e){var i=function(t){function SlotImage(e,i,n,a,s){var o=t.call(this,e,i,n,a,s)||this;return o.setPipeline("PhaserTextureTintPipeline"),o}return a(SlotImage,t),SlotImage}(Phaser.GameObjects.Image);e.SlotImage=i,t.util.extendSkew(i)}(t.display||(t.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(e){var i=function(t){function SlotSprite(e,i,n,a,s){var o=t.call(this,e,i,n,a,s)||this;return o.setPipeline("PhaserTextureTintPipeline"),o}return a(SlotSprite,t),SlotSprite}(Phaser.GameObjects.Sprite);e.SlotSprite=i,t.util.extendSkew(i)}(t.display||(t.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(e){var i=function(t){function SlotMesh(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,i,n,a,s,o,h,l,c)||this;return p.setPipeline("PhaserTextureTintPipeline"),p}return a(SlotMesh,t),SlotMesh.prototype.setTint=function(t,e,i,n){},SlotMesh.prototype.updateVertices=function(){var t=this.fakeIndices,e=this.fakeVertices,i=this.fakeUvs;this.vertices=new Float32Array(2*t.length),this.uv=new Float32Array(2*t.length),this.alphas=new Uint32Array(t.length),this.colors=new Uint32Array(t.length);for(var n=0;n<t.length;n++)this.vertices[2*n]=e[2*t[n]],this.vertices[2*n+1]=e[2*t[n]+1],this.uv[2*n]=i[2*t[n]],this.uv[2*n+1]=i[2*t[n]+1],this.alphas[n]=1,this.colors[n]=16777215},SlotMesh}(Phaser.GameObjects.Mesh);e.SlotMesh=i,t.util.extendSkew(i)}(t.display||(t.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(e){!function(e){var i=function(i){function Slot(){return null!==i&&i.apply(this,arguments)||this}return a(Slot,i),Slot.toString=function(){return"[class dragonBones.PhaserSlot]"},Slot.prototype._onClear=function(){i.prototype._onClear.call(this),this._textureScale=1,this._renderDisplay&&(this._renderDisplay.destroy(),this._renderDisplay=null)},Slot.prototype._initDisplay=function(t,e){},Slot.prototype._disposeDisplay=function(t,e){},Slot.prototype._onUpdateDisplay=function(){this._renderDisplay=this._display||this._rawDisplay},Slot.prototype._addDisplay=function(){this.armature.display.add(this._renderDisplay)},Slot.prototype._replaceDisplay=function(t){this._renderDisplay.setSkew?(this.armature.display.replace(t,this._renderDisplay),this._renderDisplay.parentContainer=this.armature.display):console.warn("please call dragonBones.phaser.util.extendSkew to mix skew component into your display object,\n                                and set its pipeline to 'PhaserTextureTintPipeline' by calling 'setPiepline' method, more detail please refer to the 'ReplaceSlotDisplay.ts' example")},Slot.prototype._removeDisplay=function(){this._renderDisplay.parentContainer.remove(this._renderDisplay)},Slot.prototype._updateDisplayData=function(){i.prototype._updateDisplayData.call(this),null!==this.armature.replacedTexture&&(this._textureDirty=!0)},Slot.prototype._updateZOrder=function(){this._renderDisplay.depth!==this._zOrder&&this._renderDisplay.setDepth(this._zOrder)},Slot.prototype._updateVisible=function(){this._renderDisplay.setVisible(this._parent.visible&&this._visible)},Slot.prototype._updateBlendMode=function(){var t=Phaser.BlendModes.NORMAL;switch(this._blendMode){case 0:t=Phaser.BlendModes.NORMAL;break;case 1:t=Phaser.BlendModes.ADD;break;case 3:t=Phaser.BlendModes.DARKEN;break;case 4:t=Phaser.BlendModes.DIFFERENCE;break;case 6:t=Phaser.BlendModes.HARD_LIGHT;break;case 9:t=Phaser.BlendModes.LIGHTEN;break;case 10:t=Phaser.BlendModes.MULTIPLY;break;case 11:t=Phaser.BlendModes.OVERLAY;break;case 12:t=Phaser.BlendModes.SCREEN}this._renderDisplay.setBlendMode(t)},Slot.prototype._updateColor=function(){var t=this._colorTransform,i=this._globalAlpha*t.alphaMultiplier+t.alphaOffset;if(this._renderDisplay.setAlpha(i),!(this._renderDisplay instanceof e.DisplayContainer)){var n=255*t.redMultiplier+t.redOffset<<16|255*t.greenMultiplier+t.greenOffset<<8|255*t.blueMultiplier+t.blueOffset;this._renderDisplay.setTint(n)}},Slot.prototype._updateFrame=function(){if(!(this._renderDisplay instanceof e.DisplayContainer)){var i=this._textureData;if(this._displayIndex>=0&&null!==this._display&&null!==i){var n=i.parent;null!==this.armature.replacedTexture&&(null===this.armature._replaceTextureAtlasData?((n=t.BaseObject.borrowObject(e.TextureAtlasData)).copyFrom(i.parent),n.renderTexture=this.armature.replacedTexture,this.armature._replaceTextureAtlasData=n):n=this.armature._replaceTextureAtlasData,i=n.getTexture(i.name));var a=i.renderTexture;if(null!==a){if(null!==this._geometryData){var s=this._geometryData.data,o=s.intArray,h=s.floatArray,l=o[this._geometryData.offset+0],c=o[this._geometryData.offset+1],p=o[this._geometryData.offset+2];p<0&&(p+=65536);var d=p+2*l,u=this._armature._armatureData.scale,m=this._renderDisplay,f=i.region;m.fakeVertices=new Float32Array(2*l),m.fakeUvs=new Float32Array(2*l),m.fakeIndices=new Uint16Array(3*c);for(var y=0,g=2*l;y<g;++y)m.fakeVertices[y]=h[p+y]*u;for(y=0;y<3*c;++y)m.fakeIndices[y]=o[this._geometryData.offset+4+y];for(y=0,g=2*l;y<g;y+=2){var P=h[d+y],_=h[d+y+1];i.rotated?(m.fakeUvs[y]=(f.x+(1-_)*f.width)/n.width,m.fakeUvs[y+1]=(f.y+P*f.height)/n.height):(m.fakeUvs[y]=(f.x+P*f.width)/n.width,m.fakeUvs[y+1]=(f.y+_*f.height)/n.height)}this._textureScale=1,m.texture=a.texture,m.frame=a,m.updateVertices();var v=null!==this._geometryData.weight,b=0!==this._parent._boneData.type;(v||b)&&this._identityTransform()}else this._renderDisplay.texture=a.texture,this._renderDisplay.frame=a,this._renderDisplay.setDisplayOrigin(this._pivotX,this._pivotY),this._textureScale=i.parent.scale*this.armature.armatureData.scale,this._renderDisplay.setScale(this._textureScale);return void(this._visibleDirty=!0)}}else this._renderDisplay.x=0,this._renderDisplay.y=0,this._renderDisplay.setTexture(void 0)}},Slot.prototype._updateMesh=function(){var t=this._armature._armatureData.scale,e=this._displayFrame.deformVertices,i=this._geometryBones,n=this._geometryData,a=n.weight,s=e.length>0&&n.inheritDeform,o=this._renderDisplay;if(null!==a){var h=(D=n.data).intArray,l=D.floatArray,c=h[n.offset+0],p=h[a.offset+1];p<0&&(p+=65536);for(var d=0,u=0,m=a.offset+2+i.length,f=p,y=0;d<c;++d){for(var g=h[m++],P=0,_=0,v=0;v<g;++v){var b=i[h[m++]];if(null!==b){var T=b.globalTransformMatrix,S=l[f++],x=l[f++]*t,w=l[f++]*t;s&&(x+=e[y++],w+=e[y++]),P+=(T.a*x+T.c*w+T.tx)*S,_+=(T.b*x+T.d*w+T.ty)*S}}o.fakeVertices[u++]=P,o.fakeVertices[u++]=_}}else{var D,C=0!==this._parent._boneData.type,I=(h=(D=n.data).intArray,l=D.floatArray,c=h[n.offset+0],h[n.offset+2]);I<0&&(I+=65536);d=0;for(var k=2*c;d<k;d+=2){var B=l[I+d]*t,E=l[I+d+1]*t;if(s&&(B+=e[d],E+=e[d+1]),C){T=this._parent._getGlobalTransformMatrix(B,E);o.fakeVertices[d]=T.a*B+T.c*E+T.tx,o.fakeVertices[d+1]=T.b*B+T.d*E+T.ty}else o.fakeVertices[d]=B,o.fakeVertices[d+1]=E}}o.updateVertices()},Slot.prototype._updateTransform=function(){this.updateGlobalTransform();var t=this.global;this._renderDisplay.x=t.x,this._renderDisplay.y=t.y,this._renderDisplay.rotation=t.rotation,this._renderDisplay.setSkew(t.skew,0),this._renderDisplay.setScale(t.scaleX*this._textureScale,t.scaleY*this._textureScale)},Slot.prototype._identityTransform=function(){this._renderDisplay.setPosition(),this._renderDisplay.setRotation(),this._textureScale=1,this._renderDisplay.setScale(this._textureScale),this._renderDisplay.setSkew(0)},Slot}(t.Slot);e.Slot=i}(e.display||(e.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(e){!function(e){var i=function(e){function TextureAtlasData(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTexture=null,t}return a(TextureAtlasData,e),TextureAtlasData.toString=function(){return"[class dragonBones.PhaserTextureAtlasData]"},TextureAtlasData.prototype._onClear=function(){e.prototype._onClear.call(this),null!==this._renderTexture&&this._renderTexture.destroy(),this._renderTexture=null},TextureAtlasData.prototype.createTexture=function(){return t.BaseObject.borrowObject(n)},Object.defineProperty(TextureAtlasData.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(t&&this._renderTexture!==t)for(var e in this._renderTexture&&this._renderTexture.destroy(),this._renderTexture=t,this.textures){var i=this.textures[e],n=this._renderTexture.has(e)?this._renderTexture.get(e):this._renderTexture.add(e,0,i.region.x,i.region.y,i.region.width,i.region.height);i.rotated&&(n.rotated=!0,n.updateUVsInverted()),i.renderTexture=n}},enumerable:!0,configurable:!0}),TextureAtlasData}(t.TextureAtlasData);e.TextureAtlasData=i;var n=function(t){function TextureData(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderTexture=null,e}return a(TextureData,t),TextureData.toString=function(){return"[class dragonBones.PhaserTextureData]"},TextureData.prototype._onClear=function(){t.prototype._onClear.call(this),null!==this.renderTexture&&this.renderTexture.destroy(),this.renderTexture=null},TextureData}(t.TextureData);e.TextureData=n}(e.display||(e.display={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(e){var i=function(e){function TextureTintPipeline(i){var n=e.call(this,i)||this;return n._tempMatrix1=new t.util.TransformMatrix,n._tempMatrix2=new t.util.TransformMatrix,n._tempMatrix3=new t.util.TransformMatrix,n}return a(TextureTintPipeline,e),TextureTintPipeline.prototype.batchSprite=function(t,e,i){this.renderer.setPipeline(this);var n=this._tempMatrix1,a=this._tempMatrix2,s=this._tempMatrix3,o=t.frame,h=o.glTexture,l=o.u0,c=o.v0,p=o.u1,d=o.v1,u=o.x,m=o.y,f=o.width,y=o.height,g=-t.displayOriginX+u,P=-t.displayOriginY+m;if(t.isCropped){var _=t._crop;_.flipX===t.flipX&&_.flipY===t.flipY||o.updateCropUVs(_,t.flipX,t.flipY),l=_.u0,c=_.v0,p=_.u1,d=_.v1,f=_.width,y=_.height,u=_.x,m=_.y,g=-t.displayOriginX+u,P=-t.displayOriginY+m}t.flipX&&(g+=f,f*=-1),t.flipY&&(P+=y,y*=-1);var v=g+f,b=P+y;a.applyITRSC(t.x,t.y,t.rotation,t.scaleX,t.scaleY,t.skewX||0,t.skewY||0),n.copyFrom(e.matrix),i?(n.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),a.e=t.x,a.f=t.y,n.multiply(a,s)):(a.e-=e.scrollX*t.scrollFactorX,a.f-=e.scrollY*t.scrollFactorY,n.multiply(a,s));var T=s.getX(g,P),S=s.getY(g,P),x=s.getX(g,b),w=s.getY(g,b),D=s.getX(v,b),C=s.getY(v,b),I=s.getX(v,P),k=s.getY(v,P),B=Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(t._tintTL,e.alpha*t._alphaTL),E=Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(t._tintTR,e.alpha*t._alphaTR),A=Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(t._tintBL,e.alpha*t._alphaBL),O=Phaser.Renderer.WebGL.Utils.getTintAppendFloatAlpha(t._tintBR,e.alpha*t._alphaBR);e.roundPixels&&(T|=0,S|=0,x|=0,w|=0,D|=0,C|=0,I|=0,k|=0),this.setTexture2D(h,0);var M=t._isTinted&&t.tintFill;this.batchQuad(T,S,x,w,D,C,I,k,l,c,p,d,B,E,A,O,M)},TextureTintPipeline}(Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline);e.TextureTintPipeline=i}(t.pipeline||(t.pipeline={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(t){t.FileTypes={IMAGE:"imageFile",JSON:"jsonFile",BINARY:"binaryFile",map:{imageFile:Phaser.Loader.FileTypes.ImageFile,jsonFile:Phaser.Loader.FileTypes.JSONFile,binaryFile:Phaser.Loader.FileTypes.BinaryFile},setType:function(e,i){t.FileTypes.map[e]=i},getType:function(e){return t.FileTypes.map[e]}}}(t.plugin||(t.plugin={}))}(t.phaser||(t.phaser={}))}(c||(c={})),function(t){!function(t){!function(t){var e=function(e){function DragonBonesFile(i,n,a,s,o,h,l,c){var p,d,u,m,f=t.FileTypes.getType(t.FileTypes.BINARY),y=t.FileTypes.getType(t.FileTypes.JSON),g=t.FileTypes.getType(t.FileTypes.IMAGE),createBoneFileByType=function(t,e,i,n){var a="json";if(n&&n.responseType)switch(n.responseType){case"arraybuffer":case"blob":a="bin";break;case"json":case"text":a="json"}return"bin"===a?new f(t,e,i,n):new y(t,e,i,n)};if(Phaser.Utils.Objects.IsPlainObject(n)){var P=n;p=new g(i,{key:m=Phaser.Utils.Objects.GetFastValue(P,"key"),url:Phaser.Utils.Objects.GetFastValue(P,"textureURL"),extension:Phaser.Utils.Objects.GetFastValue(P,"textureExtension","png"),xhrSettings:Phaser.Utils.Objects.GetFastValue(P,"textureXhrSettings")}),d=new y(i,{key:m+"_atlasjson",url:Phaser.Utils.Objects.GetFastValue(P,"atlasURL"),extension:Phaser.Utils.Objects.GetFastValue(P,"atlasExtension","json"),xhrSettings:Phaser.Utils.Objects.GetFastValue(P,"atlasXhrSettings")}),u=createBoneFileByType(i,m,Phaser.Utils.Objects.GetFastValue(P,"boneURL"),Phaser.Utils.Objects.GetFastValue(P,"boneXhrSettings"))}else p=new g(i,m=n,a,h),d=new y(i,m+"_atlasjson",s,l),u=createBoneFileByType(i,m,o,c);return u.cache=i.cacheManager.custom.dragonbone,e.call(this,i,"dragonbone",m,[p,d,u])||this}return a(DragonBonesFile,e),DragonBonesFile.prototype.addToCache=function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2];e.addToCache(),i.addToCache(),t.addToCache(),this.complete=!0}},DragonBonesFile}(Phaser.Loader.MultiFile);t.DragonBonesFile=e}(t.plugin||(t.plugin={}))}(t.phaser||(t.phaser={}))}(c||(c={})),l=c||(c={}),function(t){var e=function(t){function DragonBonesScenePlugin(e,i){var n=t.call(this,e,i)||this,a=n.game;if(a.cache.addCustom("dragonbone"),n.game.config.renderType===Phaser.WEBGL){var s=n.game.renderer;s.hasPipeline("PhaserTextureTintPipeline")||s.addPipeline("PhaserTextureTintPipeline",new h.pipeline.TextureTintPipeline({game:a,renderer:s}))}return i.registerGameObject("dragonBones",CreateDragonBonesRegisterHandler),i.registerGameObject("armature",CreateArmatureRegisterHandler),i.registerGameObject("dragonBoneFactory",CreateDragonBoneFactoryRegisterHandler),i.registerFileType("dragonbone",DragonBoneFileRegisterHandler,e),n}return a(DragonBonesScenePlugin,t),DragonBonesScenePlugin.prototype.createArmature=function(t,e,i,n,a){void 0===a&&(a=1);var s=this.factory.buildArmatureDisplay(t,e,i,n,a);return this.systems.displayList.add(s),this._dbInst.clock.add(s.armature),s},DragonBonesScenePlugin.prototype.createDragonBones=function(t,e){return void 0===e&&(e=1),this.factory.buildDragonBonesData(t,e)},Object.defineProperty(DragonBonesScenePlugin.prototype,"factory",{get:function(){return this._factory||(this._dbInst=new c.DragonBones(new h.util.EventDispatcher),this._factory=new h.Factory(this._dbInst,this.scene)),this._factory},enumerable:!0,configurable:!0}),DragonBonesScenePlugin.prototype.createSlotDisplayPlaceholder=function(){return new h.display.SlotImage(this.scene,0,0)},DragonBonesScenePlugin.prototype.boot=function(){this.systems.events.once("destroy",this.destroy,this),this.start()},DragonBonesScenePlugin.prototype.start=function(){var t=this.systems.events;t.on("update",this.update,this),t.once("shutdown",this.shutdown,this)},DragonBonesScenePlugin.prototype.update=function(t,e){this._dbInst&&this._dbInst.advanceTime(.001*e)},DragonBonesScenePlugin.prototype.shutdown=function(){var t=this.systems.events;t.off("update",this.update,this),t.off("shutdown",this.shutdown,this)},DragonBonesScenePlugin.prototype.destroy=function(){this.shutdown(),this._factory=this._dbInst=null,this.pluginManager=this.game=this.scene=this.systems=null},DragonBonesScenePlugin.prototype.createMeshDisplayPlaceholder=function(){return new h.display.SlotMesh(this.scene,0,0,[],[],[],[],null,null)},DragonBonesScenePlugin}(Phaser.Plugins.ScenePlugin);t.DragonBonesScenePlugin=e;var CreateDragonBonesRegisterHandler=function(t,e){return void 0===e&&(e=1),this.scene.dragonbone.createDragonBones(t,e)},CreateArmatureRegisterHandler=function(t,e,i,n){return this.scene.dragonbone.createArmature(t,e,i,n)},CreateDragonBoneFactoryRegisterHandler=function(){return this.scene.dragonbone.factory},DragonBoneFileRegisterHandler=function(e,i,n,a,s,o,h){var l=new t.DragonBonesFile(this,e,i,n,a,s,o,h);return this.addFile(l.files),this}}((h=l.phaser||(l.phaser={})).plugin||(h.plugin={})),function(t){var e=function(e){function Factory(t,i,n){var a=e.call(this,n)||this;return a._scene=i,a._dragonBones=t,a}return a(Factory,e),Factory.prototype._isSupportMesh=function(){return!0},Factory.prototype._buildTextureAtlasData=function(e,i){return e?e.renderTexture=i:e=p.BaseObject.borrowObject(t.display.TextureAtlasData),e},Factory.prototype._buildArmature=function(e){var i=p.BaseObject.borrowObject(p.Armature),n=new t.display.ArmatureDisplay(this._scene);return i.init(e.armature,n,n,this._dragonBones),i},Factory.prototype._buildSlot=function(e,i,n){var a=p.BaseObject.borrowObject(t.display.Slot),s=this._scene.dragonbone.createSlotDisplayPlaceholder(),o=this._scene.dragonbone.createMeshDisplayPlaceholder();return a.init(i,n,s,o),a},Factory.prototype.buildArmatureDisplay=function(t,e,i,n,a){var s;return void 0===i&&(i=""),void 0===n&&(n=""),void 0===a&&(a=1),this.buildDragonBonesData(e,a)&&(s=this.buildArmature(t,e,i,n)),s.display},Factory.prototype.buildDragonBonesData=function(t,e){void 0===e&&(e=1);var i=this._dragonBonesDataMap[t];if(!i){var n=this._scene.cache,a=n.custom.dragonbone.get(t);if(a){i=this.parseDragonBonesData(a,t,e);var s=this._scene.textures.get(t),o=n.json.get(t+"_atlasjson");this.parseTextureAtlasData(o,s,s.key,e)}}return i},Object.defineProperty(Factory.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),Factory}(p.BaseFactory);t.Factory=e}((p=c||(c={})).phaser||(p.phaser={}))},,,,,,,,,,,,function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"Render",(function(){return k}));var n,a,s=i(463),o=(i(465),i(5)),h=i(2),l=i(3),c=i(1),p=i(610),d=i(632),u=i(546),m=i(631),f=i(483),y=i(545),g=i(202),P=i(0),_=i(608),v=i(623),b=i(484),T=i(485),S=i(654),x=i(58),w=i.n(x),D=i(615),C=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__decorate=function(t,e,i,n){var a,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var h=t.length-1;h>=0;h--)(a=t[h])&&(o=(s<3?a(o):s>3?a(e,i,o):a(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o},__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}};for(var I in c)l.PBpacket.addProtocol(c[I]);!function(t){t[t.DIRECTION_MOVE_STYLE=1]="DIRECTION_MOVE_STYLE",t[t.FOLLOW_MOUSE_MOVE_STYLE=2]="FOLLOW_MOUSE_MOVE_STYLE",t[t.PATH_MOVE_STYLE=3]="PATH_MOVE_STYLE"}(a||(a={}));var k=function(e){function Render(t,i){var n=e.call(this,P.RENDER_PEER)||this;return n.isConnect=!1,n.DEFAULT_WIDTH=360,n.DEFAULT_HEIGHT=640,n._moveStyle=0,n.isPause=!1,n.emitter=new Phaser.Events.EventEmitter,n.mConfig=t,n.mCallBack=i,n.gridsDebugger=D.GridsDebugger.getInstance(),n.astarDebugger=D.AstarDebugger.getInstance(),n.sortDebugger=new D.SortDebugger(n),n.editorModeDebugger=new D.EditorModeDebugger(n),n.mConnectFailFunc=n.mConfig.connectFail,n.mGameCreatedFunc=n.mConfig.game_created,n.mConfig.hasConnectFail=!!n.mConnectFailFunc,n.mConfig.hasCloseGame=!!n.mConfig.closeGame,n.mConfig.hasGameCreated=!!n.mConfig.game_created,n.mConfig.hasReload=!!n.mConfig.reload,delete n.mConfig.connectFail,delete n.mConfig.game_created,delete n.mConfig.closeGame,n.initConfig(),h.Logger.getInstance().log("Render version ====>:","v"+w.a),n.linkTo(P.MAIN_WORKER,P.MAIN_WORKER_URL).onceReady((function(){n.mMainPeer=n.remote[P.MAIN_WORKER].MainPeer,n.mMainPeer.updateFps(),n.createGame(),h.Logger.getInstance().debug("worker onReady")})),n.linkTo(P.PHYSICAL_WORKER,P.PHYSICAL_WORKER_URL).onceReady((function(){n.mPhysicalPeer=n.remote[P.PHYSICAL_WORKER].PhysicalPeer,n.mPhysicalPeer.setScaleRatio(Math.ceil(n.mConfig.devicePixelRatio||1)),n.mPhysicalPeer.start(),h.Logger.getInstance().debug("Physcialworker onReady")})),n}return C(Render,e),Object.defineProperty(Render.prototype,"physicalPeer",{get:function(){return this.mPhysicalPeer},enumerable:!1,configurable:!0}),Render.prototype.setKeyBoardHeight=function(t){throw new Error("Method not implemented.")},Object.defineProperty(Render.prototype,"config",{get:function(){return this.mConfig},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiRatio",{get:function(){return this.mUIRatio},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiScale",{get:function(){return this.mUIScale},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"scaleRatio",{get:function(){return this.mScaleRatio},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"account",{get:function(){return this.mAccount},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"uiManager",{get:function(){return this.mUiManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"sceneManager",{get:function(){return this.mSceneManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"camerasManager",{get:function(){return this.mCameraManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"displayManager",{get:function(){return this.mDisplayManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"localStorageManager",{get:function(){return this.mLocalStorageManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"editorCanvasManager",{get:function(){return this.mEditorCanvasManager},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"game",{get:function(){return this.mGame},enumerable:!1,configurable:!0}),Render.prototype.getSize=function(){if(this.mGame)return this.mGame.scale.gameSize},Render.prototype.createGame=function(){var t=this;this.newGame().then((function(){t.createManager(),t.remote[P.MAIN_WORKER].MainPeer.createGame(t.mConfig)}))},Render.prototype.createManager=function(){this.mUiManager||(this.mUiManager=new b.e(this)),this.mCameraManager||(this.mCameraManager=new y.a(this)),this.mLocalStorageManager||(this.mLocalStorageManager=new m.a),this.mSceneManager||(this.mSceneManager=new d.a(this)),this.mInputManager||(this.mInputManager=new v.a(this)),this.mDisplayManager||(this.mDisplayManager=new _.a(this)),this.mEditorCanvasManager||(this.mEditorCanvasManager=new S.a(this))},Render.prototype.destroyManager=function(){this.mUiManager&&(this.mUiManager.destroy(),this.mUiManager=void 0),this.mCameraManager&&(this.mCameraManager.destroy(),this.mCameraManager=void 0),this.mSceneManager&&(this.mSceneManager.destroy(),this.mSceneManager=void 0),this.mInputManager&&(this.mInputManager.destroy(),this.mInputManager=void 0),this.mDisplayManager&&(this.mDisplayManager.destroy(),this.mDisplayManager=void 0),this.mEditorCanvasManager&&(this.mEditorCanvasManager.destroy(),this.mEditorCanvasManager=void 0)},Render.prototype.clearManager=function(){this.mUiManager&&this.mUiManager.destroy(),this.mCameraManager&&this.mCameraManager.destroy(),this.mSceneManager&&this.mSceneManager.destroy(),this.mInputManager&&this.mInputManager.destroy(),this.mDisplayManager&&this.mDisplayManager.destroy()},Render.prototype.enterGame=function(){this.remote[P.MAIN_WORKER].MainPeer.loginEnterWorld(),this.mGame.scene.remove(u.a.name)},Render.prototype.resize=function(t,e){var i=this.uiManager.getPanel(P.ModuleName.BOTTOM);if(i){var n=this.game.domContainer.getElementsByTagName("input");if(n&&n.length>0)return i.getInputFocusing()?void i.showKeyboard(t*this.mConfig.devicePixelRatio,e*this.mConfig.devicePixelRatio):void i.hideKeyboard()}this.mConfig&&(this.mConfig.width=t,this.mConfig.height=e);var a=t*this.mConfig.devicePixelRatio,s=e*this.mConfig.devicePixelRatio;this.mScaleRatio=Math.ceil(this.mConfig.devicePixelRatio||1),this.mConfig.scale_ratio=this.mScaleRatio,this.mUIRatio=Math.round(this.mConfig.devicePixelRatio||1);var o=t/this.DEFAULT_WIDTH*(this.mConfig.devicePixelRatio/this.mUIRatio);if(this.mUIScale=this.game.device.os.desktop?1:o,this.mGame){this.mGame.scale.zoom=1/this.mConfig.devicePixelRatio,this.mGame.scale.resize(a,s);for(var h=0,l=this.mGame.scene.scenes;h<l.length;h++){var c=l[h].cameras.main;c&&c.setPixelRatio&&c.setPixelRatio(this.mScaleRatio)}}this.mUiManager&&this.mUiManager.resize(a,s),this.mInputManager&&this.mInputManager.resize(a,s),this.mDisplayManager&&this.mDisplayManager.resize(a,s),this.mCameraManager&&this.mCameraManager.resize(t,e)},Render.prototype.onOrientationChange=function(t,e,i){},Render.prototype.scaleChange=function(t){},Render.prototype.enableClick=function(){var t=this.sceneManager.getMainScene();t&&(t.input.enabled=!0);var e=this.game.scene.getScene("MainUIScene");e&&(e.input.enabled=!0)},Render.prototype.disableClick=function(){var t=this.sceneManager.getMainScene();t&&(t.input.enabled=!1);var e=this.game.scene.getScene("MainUIScene");e&&(e.input.enabled=!1)},Render.prototype.keyboardDidShow=function(t){var e=this.uiManager.getPanel(P.ModuleName.BOTTOM),i=this.mConfig.width,n=this.mConfig.height-t;e&&e.showKeyboard(i*this.mConfig.devicePixelRatio,n*this.mConfig.devicePixelRatio)},Render.prototype.keyboardDidHide=function(){var t=this.uiManager.getPanel(P.ModuleName.BOTTOM);t&&t.hideKeyboard()},Render.prototype.startFullscreen=function(){},Render.prototype.stopFullscreen=function(){},Render.prototype.setGameConfig=function(t){},Render.prototype.updatePalette=function(t){this.mainPeer.updatePalette(t)},Render.prototype.updateMoss=function(t){this.mainPeer.updateMoss(t)},Render.prototype.restart=function(t,e){},Render.prototype.initUI=function(){this.remote[P.MAIN_WORKER].MainPeer.initUI()},Render.prototype.startRoomPlay=function(){this.remote[P.MAIN_WORKER].MainPeer.startRoomPlay()},Render.prototype.updateRoom=function(t,e){this.mInputManager.update(t,e),this.mDisplayManager.update(t,e)},Render.prototype.destroy=function(){var t=this;return this.mainPeer.destroy(),this.physicalPeer.destroy(),new Promise((function(i,n){t.mGame?(t.destroyManager(),t.mGame.events.off(Phaser.Core.Events.FOCUS,t.onFocus,t),t.mGame.events.off(Phaser.Core.Events.BLUR,t.onBlur,t),t.mGame.scale.off("enterfullscreen",t.onFullScreenChange,t),t.mGame.scale.off("leavefullscreen",t.onFullScreenChange,t),t.mGame.scale.off("orientationchange",t.onOrientationChange,t),t.mGame.plugins.removeGlobalPlugin("rexButton"),t.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin"),t.mGame.plugins.removeGlobalPlugin("rexInputText"),t.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin"),t.mGame.plugins.removeGlobalPlugin("rexMoveTo"),t.mGame.plugins.removeScenePlugin("DragonBones"),t.mGame.events.once(Phaser.Core.Events.DESTROY,(function(){t.mGame=void 0,e.prototype.destroy.call(t),i()})),t.mGame.destroy(!0)):(e.prototype.destroy.call(t),i())}))},Object.defineProperty(Render.prototype,"curTime",{get:function(){return this._curTime},enumerable:!1,configurable:!0}),Object.defineProperty(Render.prototype,"moveStyle",{get:function(){return this._moveStyle},enumerable:!1,configurable:!0}),Render.prototype.initGameConfig=function(t){this.remote[P.MAIN_WORKER].MainPeer.initGameConfig(JSON.stringify(t))},Render.prototype.newGame=function(){var t=this;return new Promise((function(e,i){t.mGame&&e(!0),t.gameConfig={type:Phaser.AUTO,parent:t.mConfig.parent,loader:{timeout:300},disableContextMenu:!0,transparent:!1,backgroundColor:0,resolution:1,fps:{target:45,forceSetTimeOut:!0},dom:{createContainer:!0},plugins:{scene:[{key:"DragonBones",plugin:dragonBones.phaser.plugin.DragonBonesScenePlugin,mapping:"dragonbone"}]},render:{pixelArt:!0,roundPixels:!0},scale:{mode:Phaser.Scale.NONE,width:t.mConfig.width*window.devicePixelRatio,height:t.mConfig.height*window.devicePixelRatio,zoom:1/window.devicePixelRatio}},Object.assign(t.gameConfig,t.mConfig),t.mGame=new s.Game(t.gameConfig),t.mGame.input.mouse.capture=!0,t.mGame.device.os.desktop?(t.mUIScale=1,t.mConfig.platform="pc"):t.mConfig.platform="nopc",e(!0)}))},Render.prototype.closeConnect=function(t){this.mainPeer.closeConnect(t)},Render.prototype.send=function(t){this.mainPeer.send(t.Serialization)},Render.prototype.terminate=function(){this.mainPeer.terminate()},Render.prototype.changeScene=function(t){this.mInputManager&&this.mInputManager.setScene(t)},Render.prototype.onFocus=function(){this.resumeScene()},Render.prototype.onBlur=function(){this.pauseScene()},Render.prototype.syncClock=function(t){this.mainPeer.syncClock(t)},Render.prototype.clearClock=function(){this.mainPeer.clearClock()},Render.prototype.destroyClock=function(){this.mainPeer.destroyClock()},Render.prototype.exitUser=function(){this.mainPeer.exitUser()},Render.prototype.requestCurTime=function(){this.mainPeer.requestCurTime()},Render.prototype.setDirection=function(t,e){this.mainPeer.setDirection(t,e)},Render.prototype.onLoginErrorHanlerCallBack=function(t,e){},Render.prototype.onShowErrorHandlerCallBack=function(t,e){},Render.prototype.getCurrentRoomSize=function(){return this.mainPeer.getCurrentRoomSize()},Render.prototype.getCurrentRoomMiniSize=function(){return this.mainPeer.getCurrentRoomMiniSize()},Render.prototype.syncCameraScroll=function(){this.mMainPeer&&this.mMainPeer.syncCameraScroll()},Render.prototype.renderEmitter=function(t,e){this.mMainPeer&&this.mMainPeer.renderEmitter(t,e)},Render.prototype.renderToPhysicalEmitter=function(t,e){this.physicalPeer&&this.physicalPeer.renderEmitter(t,e)},Render.prototype.showMediator=function(t,e){this.mMainPeer&&this.mMainPeer.showMediator(t,e)},Render.prototype.getMainScene=function(){return this.mSceneManager.getMainScene()},Render.prototype.destroyAccount=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e,i){t.mAccount&&t.mAccount.destroy(),e()}))]}))}))},Render.prototype.reconnect=function(){this.createGame()},Render.prototype.showLogin=function(){this.sceneManager&&this.mSceneManager.startScene(P.SceneName.LOGIN_SCENE,this)},Render.prototype.hideLogin=function(){this.sceneManager&&this.sceneManager.stopScene(P.SceneName.LOGIN_SCENE)},Render.prototype.checkContains=function(t,e,i){var n=this;return new Promise((function(t,a){t(n.mCameraManager.checkContains(new h.Pos(e,i)))}))},Render.prototype.showCreateRolePanel=function(t){var e=this;return new Promise((function(i,n){var createPanel=function(){e.mUiManager.showPanel(P.ModuleName.PICACREATEROLE_NAME,t).then((function(t){t?t.addExportListener((function(){i(!0)})):n(!1)}))};e.mUiManager.scene&&e.mUiManager.scene.scene.key===P.SceneName.CREATE_ROLE_SCENE?createPanel():e.mSceneManager.startScene(P.SceneName.CREATE_ROLE_SCENE,{callBack:function(){createPanel()}})}))},Render.prototype.updateModel=function(t,e){this.displayManager&&this.displayManager.updateModel(t,e)},Render.prototype.showCreateRole=function(t){this.mSceneManager&&this.mSceneManager.startScene(P.SceneName.CREATE_ROLE_SCENE,{render:this,params:t})},Render.prototype.hideCreateRole=function(){this.mSceneManager&&this.mSceneManager.stopScene(P.SceneName.CREATE_ROLE_SCENE)},Render.prototype.showPlay=function(t){this.mSceneManager&&this.mSceneManager.startScene(P.SceneName.PLAY_SCENE,{render:this,params:t})},Render.prototype.updateFPS=function(){if(this.game){var t=this.game.scene.getScene(P.SceneName.MAINUI_SCENE);t&&t.scene.isVisible&&t.scene.isActive&&t.scene.isPaused&&t.updateFPS()}},Render.prototype.endFPS=function(){},Render.prototype.hidePlay=function(){this.mSceneManager&&this.mSceneManager.stopScene(P.SceneName.PLAY_SCENE)},Render.prototype.showPanel=function(t,e){var i=this;return new Promise((function(n,a){i.mUiManager.showPanel(t,e).then((function(t){t?t.addExportListener((function(){n(!0)})):a(!1)}))}))},Render.prototype.hidePanel=function(t){this.mUiManager&&this.mUiManager.hidePanel(t)},Render.prototype.reload=function(){h.Logger.getInstance().log("game relaod =====>"),window.location.reload()},Render.prototype.showJoystick=function(){this.mInputManager&&this.mInputManager.showJoystick()},Render.prototype.setInputVisible=function(t){},Render.prototype.setLoginEnable=function(t){},Render.prototype.onShowVerified=function(){},Render.prototype.setVerifiedEnable=function(t){},Render.prototype.onShowErrorHandler=function(t,e){this.onShowErrorHandlerCallBack(t,e)},Render.prototype.onLoginErrorHanler=function(t,e){this.onLoginErrorHanlerCallBack(t,e)},Render.prototype.updateCharacterPackage=function(){this.emitter.emit(P.MessageType.UPDATED_CHARACTER_PACKAGE)},Render.prototype.displayReady=function(t,e){var i=this.mDisplayManager.getDisplay(t);i&&e&&(i.play(e),i.showNickname())},Render.prototype.soundChangeRoom=function(t){},Render.prototype.playSound=function(t){},Render.prototype.onConnected=function(){this.isConnect=!0},Render.prototype.onDisConnected=function(){this.isConnect=!1},Render.prototype.onConnectError=function(t){this.isConnect=!1},Render.prototype.connectFail=function(){this.isConnect=!1,this.mConnectFailFunc&&this.mConnectFailFunc()},Render.prototype.updateUIState=function(t,e){this.uiManager.updateUIState(t,e)},Render.prototype.setMoveStyle=function(t){this._moveStyle=t},Render.prototype.onEnterRoom=function(t){},Render.prototype.scaleTween=function(t,e){},Render.prototype.getRenderPosition=function(t,e){return[]},Render.prototype.createAccount=function(t,e,i,n,a,s){var o=this;return new Promise((function(l,c){o.mAccount||(o.mAccount=new p.a);var d=(new Date).getTime();h.Logger.getInstance().debug("createAccount ====>",d),o.exportProperty(o.mAccount,o,P.ModuleName.ACCOUNT_NAME).onceReady((function(){h.Logger.getInstance().debug("createAccountExport ====>",(new Date).getTime()-d),o.mAccount.enterGame(t,e,i,{locX:n,locY:a,locZ:s}),l(!0)}))}))},Render.prototype.refreshAccount=function(t){this.account.refreshToken(t)},Render.prototype.getAccount=function(){return this.mAccount},Render.prototype.setAccount=function(t){this.mAccount.setAccount(t)},Render.prototype.getWorldView=function(){var t=this;if(this.sceneManager)return new Promise((function(e,i){var n=t.sceneManager.getMainScene();if(n){var a=n.cameras.main,s=a.worldView;e({x:s.x,y:s.y,width:a.width,height:a.height,zoom:a.zoom,scrollX:a.scrollX,scrollY:a.scrollY})}}))},Render.prototype.onClockReady=function(){},Render.prototype.showAlert=function(t,e){},Render.prototype.showLoading=function(t){var e=this;this.mSceneManager&&(t.callBack=function(){t.sceneName&&e.mSceneManager.startScene(t.sceneName)},t.dpr=this.uiRatio,this.mSceneManager.startScene(P.SceneName.LOADING_SCENE,t))},Render.prototype.updateProgress=function(t){t>1&&(t=1),t.toFixed(2),this.mSceneManager&&this.mSceneManager.showProgress(t)},Render.prototype.hideLoading=function(){this.mSceneManager&&this.mSceneManager.sleepScene(P.SceneName.LOADING_SCENE)},Render.prototype.onForceOfflineHandler=function(){this.uiManager.showAlertView(h.i18n.t("common.offline"),!0)},Render.prototype.loadStart=function(t,e){},Render.prototype.roomPause=function(t){},Render.prototype.roomResume=function(t){},Render.prototype.removeScene=function(t){this.sceneManager&&this.sceneManager.remove(t)},Render.prototype.showCreatePanelError=function(t){},Render.prototype.createSetNickName=function(t){},Render.prototype.renderReconnect=function(){},Render.prototype.createAnotherGame=function(t,e,i,n,a,s){h.Logger.getInstance().debug("gotoanothergame ====>"),this.account.enterGame(t,e,i,{x:n,y:a,z:s})},Render.prototype.setCamerasBounds=function(t,e,i,n){this.mCameraManager&&this.mCameraManager.setBounds(t,e,i,n)},Render.prototype.setCamerasScroll=function(t,e,i){this.mCameraManager&&this.mCameraManager.scrollTargetPoint(t,e,i)},Render.prototype.setInteractive=function(t,e){if(this.mDisplayManager){var i=this.mDisplayManager.getDisplay(t);i&&i.setInteractive()}},Render.prototype.disableInteractive=function(t,e){var i=this.mDisplayManager.getDisplay(t);i&&i.disableInteractive()},Render.prototype.fadeIn=function(t,e){},Render.prototype.fadeOut=function(t,e){},Render.prototype.fadeAlpha=function(t,e,i){},Render.prototype.getCurTime=function(t){return this._curTime=t},Render.prototype.createGameCallBack=function(t){this.mGame.events.on(Phaser.Core.Events.FOCUS,this.onFocus,this),this.mGame.events.on(Phaser.Core.Events.BLUR,this.onBlur,this),window.screen.width>window.screen.height?this.mConfig.width>this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width):this.mConfig.width<this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width),this.mGameCreatedFunc&&this.mGameCreatedFunc.call(this),this.gameCreated(t)},Render.prototype.addFillEffect=function(t,e,i){this.displayManager.addFillEffect(t,e,i)},Render.prototype.clearRoom=function(){this.clearManager()},Render.prototype.clearGame=function(t){var e=this;return new Promise((function(i,n){e.mGame?(e.destroyManager(),e.mGame.events.off(Phaser.Core.Events.FOCUS,e.onFocus,e),e.mGame.events.off(Phaser.Core.Events.BLUR,e.onBlur,e),e.mGame.scale.off("enterfullscreen",e.onFullScreenChange,e),e.mGame.scale.off("leavefullscreen",e.onFullScreenChange,e),e.mGame.scale.off("orientationchange",e.onOrientationChange,e),e.mGame.plugins.removeGlobalPlugin("rexButton"),e.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin"),e.mGame.plugins.removeGlobalPlugin("rexInputText"),e.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin"),e.mGame.plugins.removeGlobalPlugin("rexMoveTo"),e.mGame.plugins.removeScenePlugin("DragonBones"),e.mGame.events.once(Phaser.Core.Events.DESTROY,(function(){e.mGame=void 0,t?e.newGame().then((function(){e.createManager(),i()})):i()})),e.mGame.destroy(!0)):i()}))},Render.prototype.getMessage=function(t){return h.i18n.t(t)},Render.prototype.setLocalStorage=function(t,e){this.localStorageManager&&this.localStorageManager.setItem(t,e)},Render.prototype.getLocalStorage=function(t){return this.localStorageManager?this.localStorageManager.getItem(t):""},Render.prototype.removeLocalStorage=function(t){this.localStorageManager&&this.localStorageManager.removeItem(t)},Render.prototype.createPanel=function(t,e){var i=this;return new Promise((function(n,a){if(i.uiManager){var s=i.uiManager.showPanel(t);i.exportProperty(s,i,e).onceReady((function(){n(!0)}))}else a("uiManager not found")}))},Render.prototype.roomstartPlay=function(){if(this.mSceneManager&&this.mCameraManager){var t=this.mSceneManager.getMainScene();t?this.mCameraManager.camera=t.cameras.main:h.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.drawGrids=function(t){this.displayManager&&this.displayManager.showGridsDebug(t)},Render.prototype.drawAstar_init=function(t,e){this.displayManager&&this.displayManager.showAstarDebug_init(t,e)},Render.prototype.drawAstar_update=function(t,e,i){this.displayManager&&this.displayManager.showAstarDebug_update(t,e,i)},Render.prototype.drawAstar_findPath=function(t,e,i){this.displayManager&&this.displayManager.showAstarDebug_findPath(t,e,i)},Render.prototype.roomReady=function(){if(this.mSceneManager&&this.mCameraManager){var t=this.mSceneManager.getMainScene();t?t instanceof f.a&&t.onRoomCreated():h.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.playAnimation=function(t,e,i,n){if(this.mDisplayManager){var a=this.mDisplayManager.getDisplay(t);a&&a.play(e)}},Render.prototype.setCameraScroller=function(t,e){if(this.mSceneManager&&this.mCameraManager){var i=this.mSceneManager.getMainScene();if(i){var n=i.scale;this.mCameraManager.setScroll(t*this.scaleRatio-n.width/2,e*this.scaleRatio-n.height/2),this.syncCameraScroll()}else h.Logger.getInstance().fatal("scene does not exist")}},Render.prototype.createDragonBones=function(t,e,i){this.mDisplayManager&&this.mDisplayManager.addDragonbonesDisplay(t,e,i)},Render.prototype.createUserDragonBones=function(t,e){this.mDisplayManager&&this.mDisplayManager.addUserDragonbonesDisplay(t,!0,e)},Render.prototype.createFramesDisplay=function(t,e,i){this.mDisplayManager?this.mDisplayManager.addFramesDisplay(t,e,i):h.Logger.getInstance().debug("no displayManager ====>")},Render.prototype.createTerrainDisplay=function(t,e,i){this.mDisplayManager&&this.mDisplayManager.addTerrainDisplay(t,e,i)},Render.prototype.setModel=function(t){this.mDisplayManager&&this.mDisplayManager.setModel(t)},Render.prototype.updateDirection=function(t,e){this.mDisplayManager&&this.mDisplayManager.getDisplay(t).setDirection(e)},Render.prototype.addSkybox=function(t){this.mDisplayManager&&this.mDisplayManager.addSkybox(t)},Render.prototype.removeSkybox=function(t){this.mDisplayManager&&this.mDisplayManager.removeSkybox(t)},Render.prototype.showMatterDebug=function(t){this.mDisplayManager&&this.mDisplayManager.showMatterDebug(t)},Render.prototype.hideMatterDebug=function(){this.mDisplayManager&&this.mDisplayManager.hideMatterDebug()},Render.prototype.drawServerPosition=function(t,e){this.mDisplayManager&&this.mDisplayManager.drawServerPosition(t,e)},Render.prototype.changeAlpha=function(t,e){this.mDisplayManager&&this.mDisplayManager.changeAlpha(t,e)},Render.prototype.removeBlockObject=function(t){this.mDisplayManager&&this.mDisplayManager.removeDisplay(t)},Render.prototype.setPosition=function(t,e,i,n){if(this.mDisplayManager){var a=this.mDisplayManager.getDisplay(t);a&&a.setPosition(e,i,n)}},Render.prototype.showBubble=function(t,e,i){if(this.mDisplayManager){var n=this.mDisplayManager.getDisplay(t);n&&n.showBubble(e,i)}},Render.prototype.clearBubble=function(t){var e=this.mDisplayManager.getDisplay(t);e&&e.clearBubble()},Render.prototype.startFollow=function(t){var e=this.mDisplayManager.getDisplay(t);e&&this.mCameraManager.startFollow(e)},Render.prototype.stopFollow=function(){this.mCameraManager&&this.mCameraManager.stopFollow()},Render.prototype.cameraFollow=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return(i=this.mDisplayManager.getDisplay(t))?"liner"!==e?[3,2]:[4,this.mCameraManager.pan(i.x,i.y,i.y)]:[3,4];case 1:return n.sent(),this.mCameraManager.startFollow(i),[3,3];case 2:this.mCameraManager.startFollow(i),n.label=3;case 3:return[3,5];case 4:this.mCameraManager.stopFollow(),n.label=5;case 5:return[2]}}))}))},Render.prototype.cameraPan=function(t){var e=this.mDisplayManager.getDisplay(t);e&&this.mCameraManager.pan(e.x,e.y,300)},Render.prototype.updateSkyboxState=function(t){this.mDisplayManager&&this.mDisplayManager.updateSkyboxState(t)},Render.prototype.setLayerDepth=function(t){var e=this.mSceneManager.getMainScene();e?e.layerManager.depthSurfaceDirty=t:h.Logger.getInstance().fatal("scene does not exist")},Render.prototype.doMove=function(t,e){this.mDisplayManager&&this.mDisplayManager.displayDoMove(t,e)},Render.prototype.showNickname=function(t,e){this.mDisplayManager&&this.mDisplayManager.showNickname(t,e)},Render.prototype.showTopDisplay=function(t,e){this.mDisplayManager&&this.mDisplayManager.showTopDisplay(t,e)},Render.prototype.showRefernceArea=function(t,e,i){var n=this.mDisplayManager.getDisplay(t);n&&n.showRefernceArea(e,i)},Render.prototype.hideRefernceArea=function(t){var e=this.mDisplayManager.getDisplay(t);e&&e.hideRefernceArea()},Render.prototype.displayAnimationChange=function(t){var e=t.id,i=t.direction,n=this.mDisplayManager.getDisplay(e);n&&(n.direction=i,n.play(t.animation))},Render.prototype.workerEmitter=function(t,e){this.emitter.emit(t,e)},Render.prototype.physicalEmitter=function(t,e){this.emitter.emit(t,e)},Render.prototype.mount=function(t,e,i){this.mDisplayManager.mount(t,e,i)},Render.prototype.unmount=function(t,e){this.mDisplayManager.unmount(t,e)},Render.prototype.updateInput=function(t){this.sceneManager.updateInput(t)},Render.prototype.addEffect=function(t,e,i){this.mDisplayManager.addEffect(t,e,i)},Render.prototype.removeEffect=function(t){this.mDisplayManager.removeEffect(t)},Render.prototype.onFullScreenChange=function(){this.resize(this.mGame.scale.gameSize.width,this.mGame.scale.gameSize.height)},Render.prototype.gameCreated=function(t){this.mCallBack&&this.mCallBack(),this.mConfig.game_created&&this.mConfig.game_created(),this.mGame.scale.on("enterfullscreen",this.onFullScreenChange,this),this.mGame.scale.on("leavefullscreen",this.onFullScreenChange,this)},Render.prototype.initConfig=function(){this.mConfig.devicePixelRatio||(this.mConfig.devicePixelRatio=window.devicePixelRatio||1),void 0===this.mConfig.width&&(this.mConfig.width=window.innerWidth),void 0===this.mConfig.height&&(this.mConfig.height=window.innerHeight),this.mScaleRatio=Math.ceil(this.mConfig.devicePixelRatio||1),this.mConfig.scale_ratio=this.mScaleRatio,this.mUIRatio=Math.round(this.mConfig.devicePixelRatio||1),this.mUIScale=this.mConfig.width/this.DEFAULT_WIDTH*(this.mConfig.devicePixelRatio/this.mUIRatio),h.Url.OSD_PATH=this.mConfig.osd,h.Url.RES_PATH="./resources_v"+w.a+"/",h.Url.RESUI_PATH=h.Url.RES_PATH+"ui/",Object(h.initLocales)(g.relative(t,"../"+h.Url.RES_PATH+"/locales/{{lng}}.json"))},Render.prototype.resumeScene=function(){if(h.Logger.getInstance().debug("#BlackSceneFromBackground; world.resumeScene(); isPause:"+this.isPause+"; mGame:"+this.mGame),this.isPause&&(this.isPause=!1,this.mGame)){this.sceneManager.currentScene&&this.sceneManager.currentScene.scene.resume(),this.mainPeer.onFocus();var t=this.mGame.scene.getScene(T.b.name);t&&(t.sleep(),this.mGame.scene.stop(T.b.name))}},Render.prototype.pauseScene=function(){h.Logger.getInstance().debug("#BlackSceneFromBackground; world.pauseScene(); isPause:"+this.isPause+"; mGame:"+this.mGame),this.isPause||(this.isPause=!0,this.mGame&&(this.sceneManager.currentScene&&this.sceneManager.currentScene.scene.pause(),this.mainPeer.onBlur(),this.mGame.scene.getScene(T.b.name)||this.mGame.scene.add(T.b.name,T.b),this.mGame.scene.start(T.b.name,{render:this})))},Object.defineProperty(Render.prototype,"mainPeer",{get:function(){if(!this.mMainPeer)throw new Error("can't find main worker");return this.mMainPeer},enumerable:!1,configurable:!0}),__decorate([Object(o.Export)()],Render.prototype,"gridsDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"astarDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"sortDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"editorModeDebugger",void 0),__decorate([Object(o.Export)()],Render.prototype,"destroyAccount",null),__decorate([Object(o.Export)()],Render.prototype,"reconnect",null),__decorate([Object(o.Export)()],Render.prototype,"showLogin",null),__decorate([Object(o.Export)()],Render.prototype,"hideLogin",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"checkContains",null),__decorate([Object(o.Export)()],Render.prototype,"showCreateRolePanel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateModel",null),__decorate([Object(o.Export)()],Render.prototype,"showCreateRole",null),__decorate([Object(o.Export)()],Render.prototype,"hideCreateRole",null),__decorate([Object(o.Export)()],Render.prototype,"showPlay",null),__decorate([Object(o.Export)()],Render.prototype,"updateFPS",null),__decorate([Object(o.Export)()],Render.prototype,"endFPS",null),__decorate([Object(o.Export)()],Render.prototype,"hidePlay",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"showPanel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"hidePanel",null),__decorate([Object(o.Export)()],Render.prototype,"reload",null),__decorate([Object(o.Export)()],Render.prototype,"showJoystick",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setInputVisible",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setLoginEnable",null),__decorate([Object(o.Export)()],Render.prototype,"onShowVerified",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setVerifiedEnable",null),__decorate([Object(o.Export)()],Render.prototype,"onShowErrorHandler",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"onLoginErrorHanler",null),__decorate([Object(o.Export)()],Render.prototype,"updateCharacterPackage",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"displayReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"soundChangeRoom",null),__decorate([Object(o.Export)()],Render.prototype,"playSound",null),__decorate([Object(o.Export)()],Render.prototype,"onConnected",null),__decorate([Object(o.Export)()],Render.prototype,"onDisConnected",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"onConnectError",null),__decorate([Object(o.Export)()],Render.prototype,"connectFail",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"updateUIState",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"setMoveStyle",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.unit8array])],Render.prototype,"onEnterRoom",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"scaleTween",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"getRenderPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"createAccount",null),__decorate([Object(o.Export)()],Render.prototype,"refreshAccount",null),__decorate([Object(o.Export)()],Render.prototype,"getAccount",null),__decorate([Object(o.Export)()],Render.prototype,"setAccount",null),__decorate([Object(o.Export)()],Render.prototype,"getWorldView",null),__decorate([Object(o.Export)()],Render.prototype,"onClockReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"showAlert",null),__decorate([Object(o.Export)()],Render.prototype,"showLoading",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateProgress",null),__decorate([Object(o.Export)()],Render.prototype,"hideLoading",null),__decorate([Object(o.Export)()],Render.prototype,"onForceOfflineHandler",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str])],Render.prototype,"loadStart",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"roomPause",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"roomResume",null),__decorate([Object(o.Export)()],Render.prototype,"removeScene",null),__decorate([Object(o.Export)()],Render.prototype,"showCreatePanelError",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"createSetNickName",null),__decorate([Object(o.Export)()],Render.prototype,"renderReconnect",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.str,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"createAnotherGame",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCamerasBounds",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCamerasScroll",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setInteractive",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"disableInteractive",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeIn",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeOut",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"fadeAlpha",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"getCurTime",null),__decorate([Object(o.Export)()],Render.prototype,"createGameCallBack",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"addFillEffect",null),__decorate([Object(o.Export)()],Render.prototype,"clearRoom",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"clearGame",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"getMessage",null),__decorate([Object(o.Export)()],Render.prototype,"setLocalStorage",null),__decorate([Object(o.Export)()],Render.prototype,"getLocalStorage",null),__decorate([Object(o.Export)()],Render.prototype,"removeLocalStorage",null),__decorate([Object(o.Export)()],Render.prototype,"createPanel",null),__decorate([Object(o.Export)()],Render.prototype,"roomstartPlay",null),__decorate([Object(o.Export)()],Render.prototype,"drawGrids",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_init",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_update",null),__decorate([Object(o.Export)()],Render.prototype,"drawAstar_findPath",null),__decorate([Object(o.Export)()],Render.prototype,"roomReady",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"playAnimation",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setCameraScroller",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createDragonBones",null),__decorate([Object(o.Export)()],Render.prototype,"createUserDragonBones",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createFramesDisplay",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"createTerrainDisplay",null),__decorate([Object(o.Export)()],Render.prototype,"setModel",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"updateDirection",null),__decorate([Object(o.Export)()],Render.prototype,"addSkybox",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"removeSkybox",null),__decorate([Object(o.Export)()],Render.prototype,"showMatterDebug",null),__decorate([Object(o.Export)()],Render.prototype,"hideMatterDebug",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"drawServerPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"changeAlpha",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"removeBlockObject",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"setPosition",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"showBubble",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"clearBubble",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"startFollow",null),__decorate([Object(o.Export)()],Render.prototype,"stopFollow",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"cameraFollow",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"cameraPan",null),__decorate([Object(o.Export)()],Render.prototype,"updateSkyboxState",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.boolean])],Render.prototype,"setLayerDepth",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"doMove",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.str])],Render.prototype,"showNickname",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"showTopDisplay",null),__decorate([Object(o.Export)()],Render.prototype,"showRefernceArea",null),__decorate([Object(o.Export)()],Render.prototype,"hideRefernceArea",null),__decorate([Object(o.Export)()],Render.prototype,"displayAnimationChange",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"workerEmitter",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.str])],Render.prototype,"physicalEmitter",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"mount",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num,o.webworker_rpc.ParamType.num])],Render.prototype,"unmount",null),__decorate([Object(o.Export)([o.webworker_rpc.ParamType.num])],Render.prototype,"updateInput",null),__decorate([Object(o.Export)()],Render.prototype,"addEffect",null),__decorate([Object(o.Export)()],Render.prototype,"removeEffect",null),Render}(o.RPCPeer)}.call(this,"/")},function(t,e,i){"use strict";i(634),i(651);var n=i(615);i.o(n,"AlertView")&&i.d(e,"AlertView",(function(){return n.AlertView})),i.o(n,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return n.AlignmentType})),i.o(n,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return n.AnimationModel})),i.o(n,"AxisType")&&i.d(e,"AxisType",(function(){return n.AxisType})),i.o(n,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return n.BackgroundScaleButton})),i.o(n,"BasePanel")&&i.d(e,"BasePanel",(function(){return n.BasePanel})),i.o(n,"BubbleAnimation")&&i.d(e,"BubbleAnimation",(function(){return n.BubbleAnimation})),i.o(n,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return n.ButtonEventDispatcher})),i.o(n,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return n.CheckboxGroup})),i.o(n,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return n.CommonBackground})),i.o(n,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return n.ConstraintType})),i.o(n,"DragonbonesDisplay")&&i.d(e,"DragonbonesDisplay",(function(){return n.DragonbonesDisplay})),i.o(n,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return n.DynamicImage})),i.o(n,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return n.DynamicImageValue})),i.o(n,"FrameAnimation")&&i.d(e,"FrameAnimation",(function(){return n.FrameAnimation})),i.o(n,"FramesDisplay")&&i.d(e,"FramesDisplay",(function(){return n.FramesDisplay})),i.o(n,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return n.GridLayoutGroup})),i.o(n,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return n.ImageBBCodeValue})),i.o(n,"ImageValue")&&i.d(e,"ImageValue",(function(){return n.ImageValue})),i.o(n,"InputField")&&i.d(e,"InputField",(function(){return n.InputField})),i.o(n,"InputPanel")&&i.d(e,"InputPanel",(function(){return n.InputPanel})),i.o(n,"InputView")&&i.d(e,"InputView",(function(){return n.InputView})),i.o(n,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return n.ItemInfoTips})),i.o(n,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return n.ItemsConsumeFunPanel})),i.o(n,"LabelInput")&&i.d(e,"LabelInput",(function(){return n.LabelInput})),i.o(n,"MainUIScene")&&i.d(e,"MainUIScene",(function(){return n.MainUIScene})),i.o(n,"NinePatch")&&i.d(e,"NinePatch",(function(){return n.NinePatch})),i.o(n,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return n.NinePatchButton})),i.o(n,"PlayScene")&&i.d(e,"PlayScene",(function(){return n.PlayScene})),i.o(n,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return n.ProgressMaskBar})),i.o(n,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return n.ProgressThreeBar})),i.o(n,"PropItem")&&i.d(e,"PropItem",(function(){return n.PropItem})),i.o(n,"SoundButton")&&i.d(e,"SoundButton",(function(){return n.SoundButton})),i.o(n,"TextButton")&&i.d(e,"TextButton",(function(){return n.TextButton})),i.o(n,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return n.TextToolTips})),i.o(n,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return n.ThreeSliceButton})),i.o(n,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return n.ThreeSlicePath})),i.o(n,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return n.ToggleButton})),i.o(n,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return n.ToggleColorButton})),i.o(n,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return n.TweenCompent})),i.o(n,"UIDragonbonesDisplay")&&i.d(e,"UIDragonbonesDisplay",(function(){return n.UIDragonbonesDisplay})),i.o(n,"UiManager")&&i.d(e,"UiManager",(function(){return n.UiManager})),i.o(n,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return n.ValueContainer}));i(643),i(612),i(478);var a=i(485);i.d(e,"MainUIScene",(function(){return a.c})),i.d(e,"PlayScene",(function(){return a.d}));var s=i(214);i.o(s,"AlertView")&&i.d(e,"AlertView",(function(){return s.AlertView})),i.o(s,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return s.AlignmentType})),i.o(s,"AnimationModel")&&i.d(e,"AnimationModel",(function(){return s.AnimationModel})),i.o(s,"AxisType")&&i.d(e,"AxisType",(function(){return s.AxisType})),i.o(s,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return s.BackgroundScaleButton})),i.o(s,"BasePanel")&&i.d(e,"BasePanel",(function(){return s.BasePanel})),i.o(s,"BubbleAnimation")&&i.d(e,"BubbleAnimation",(function(){return s.BubbleAnimation})),i.o(s,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return s.ButtonEventDispatcher})),i.o(s,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return s.CheckboxGroup})),i.o(s,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return s.CommonBackground})),i.o(s,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return s.ConstraintType})),i.o(s,"DragonbonesDisplay")&&i.d(e,"DragonbonesDisplay",(function(){return s.DragonbonesDisplay})),i.o(s,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return s.DynamicImage})),i.o(s,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return s.DynamicImageValue})),i.o(s,"FrameAnimation")&&i.d(e,"FrameAnimation",(function(){return s.FrameAnimation})),i.o(s,"FramesDisplay")&&i.d(e,"FramesDisplay",(function(){return s.FramesDisplay})),i.o(s,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return s.GridLayoutGroup})),i.o(s,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return s.ImageBBCodeValue})),i.o(s,"ImageValue")&&i.d(e,"ImageValue",(function(){return s.ImageValue})),i.o(s,"InputField")&&i.d(e,"InputField",(function(){return s.InputField})),i.o(s,"InputPanel")&&i.d(e,"InputPanel",(function(){return s.InputPanel})),i.o(s,"InputView")&&i.d(e,"InputView",(function(){return s.InputView})),i.o(s,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return s.ItemInfoTips})),i.o(s,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return s.ItemsConsumeFunPanel})),i.o(s,"LabelInput")&&i.d(e,"LabelInput",(function(){return s.LabelInput})),i.o(s,"NinePatch")&&i.d(e,"NinePatch",(function(){return s.NinePatch})),i.o(s,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return s.NinePatchButton})),i.o(s,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return s.ProgressMaskBar})),i.o(s,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return s.ProgressThreeBar})),i.o(s,"PropItem")&&i.d(e,"PropItem",(function(){return s.PropItem})),i.o(s,"SoundButton")&&i.d(e,"SoundButton",(function(){return s.SoundButton})),i.o(s,"TextButton")&&i.d(e,"TextButton",(function(){return s.TextButton})),i.o(s,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return s.TextToolTips})),i.o(s,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return s.ThreeSliceButton})),i.o(s,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return s.ThreeSlicePath})),i.o(s,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return s.ToggleButton})),i.o(s,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return s.ToggleColorButton})),i.o(s,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return s.TweenCompent})),i.o(s,"UIDragonbonesDisplay")&&i.d(e,"UIDragonbonesDisplay",(function(){return s.UIDragonbonesDisplay})),i.o(s,"UiManager")&&i.d(e,"UiManager",(function(){return s.UiManager})),i.o(s,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return s.ValueContainer}));i(609)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBasePanel",(function(){return l}));var n,a=i(479),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBasePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i}return h(PicaBasePanel,t),PicaBasePanel.prototype.initResource=function(){var t;this.atlasNames&&(t=this.uiManager.getUrlDatas(this.atlasNames));if(this.textures){var e=this.uiManager.getUrlDatas(this.textures,s.e.texture);t=t?t.concat(e):e}if(t)for(var i=0,n=t;i<n.length;i++){var a=n[i];this.cacheExists(s.e[a.uiType],a.atlasName)||(a.uiType===s.e.atlas?this.setResourcesData("atlas",a.atlasName,a.atlasUrl,a.jsonUrl,a.foldType):a.uiType===s.e.texture?this.setResourcesData("image",a.atlasName,a.atlasUrl,void 0,a.foldType):a.uiType===s.e.video&&this.setResourcesData("video",a.atlasName,a.atlasUrl,void 0,a.foldType))}},PicaBasePanel.prototype.preload=function(){this.initResource(),t.prototype.preload.call(this)},PicaBasePanel.prototype.setLinear=function(e){if(t.prototype.setLinear.call(this,e),this.atlasNames)for(var i=0,n=this.atlasNames;i<n.length;i++){var a=n[i];"string"==typeof a?t.prototype.setLinear.call(this,a):t.prototype.setLinear.call(this,a.atlasName)}},PicaBasePanel.prototype.setResourcesData=function(t,e,i,n,a){this.cacheExists(t,e)||(this.mResources||(this.mResources=new Map),this.mResources.set(e,{dpr:this.dpr,type:t,texture:i,data:n,foldType:a}))},PicaBasePanel.prototype.addResources=function(t,e){if(e.type&&this.scene.load[e.type]){e.foldType=e.foldType||s.b.DPR;var i=e.foldType===s.b.DPR?o.Url.getUIRes(e.dpr,e.texture):o.Url.getNormalUIRes(e.texture),n=e.foldType===s.b.DPR?o.Url.getUIRes(e.dpr,e.data):o.Url.getNormalUIRes(e.data);"video"!==e.type?this.scene.load[e.type](t,i,n):this.scene.load.video(t,i,void 0,void 0,!0)}},PicaBasePanel.prototype.cacheExists=function(t,e){return"image"===t||"atlas"===t||"texture"===t?this.scene.textures.exists(e):("json"===t||"video"===t)&&this.scene.cache[t].exists(e)},PicaBasePanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e);var n=i(544);i.d(e,"ItemButton",(function(){return n.ItemButton}));var a=i(482);i.d(e,"DetailDisplay",(function(){return a.DetailDisplay}));var s=i(547);i.d(e,"BackTextButton",(function(){return s.BackTextButton}));var o=i(548);i.d(e,"EnergyProgressBar",(function(){return o.EnergyProgressBar}))},function(t,e,i){"use strict";i.r(e),i.d(e,"DetailDisplay",(function(){return c}));var n,a,s=i(479),o=i(2),h=i(290),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function DetailDisplay(e,i){var n=t.call(this,e)||this;return n.render=i,n.mFixedSize=0,n.curLoadType=a.None,n.isLoading=!1,n.mFixScale=1,n}return l(DetailDisplay,t),DetailDisplay.prototype.setFixedScale=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=0),this.mFixedSize=e,this.mFixScale=t,this.scale=t,this},DetailDisplay.prototype.loadDisplay=function(t){var e=t.display;if(e)if(""!==e.texturePath&&""!==e.dataPath){var i=t.animations;i&&i.length>0?this.loadElement(t):this.loadUrl(o.Url.getOsdRes(e.texturePath),o.Url.getOsdRes(e.dataPath))}else this.loadUrl(e.texturePath,e.dataPath)},DetailDisplay.prototype.loadElement=function(t){var e=this;this.curLoadType=a.FramesDisplay,this.clearDisplay(),this.mDisplay=t;var i=t.animations;this.mFramesDisplay||(this.mFramesDisplay=new s.FramesDisplay(this.scene,this.render,void 0));var n=t.display;if(n&&i.length>0){for(var l=[],c=i[0].node.name,p=0,d=i;p<d.length;p++){var u=d[p];u.baseLoc="0,0";for(var m=0,f=u.layer;m<f.length;m++){f[m].offsetLoc={x:0,y:0}}l.push(new s.AnimationModel(u))}var addDisplay_1=function(){var t=e.mFramesDisplay,i=t.spriteWidth,n=t.spriteHeight;if(0!==e.mFixedSize){e.scale=1;var a=e.width/i,s=e.height/n,o=a>s?s:a;e.mFramesDisplay.scale=1===e.mFixedSize?o:Math.round(o)}else e.mFramesDisplay.scale=1,e.scale=e.mFixScale;var h=e.mFramesDisplay.scale;e.mFramesDisplay.x=.5*-i*h,e.mFramesDisplay.y=.5*-n*h,e.addDisplay()};this.mFramesDisplay.createdHandler=new o.Handler(this,(function(){e.mFramesDisplay.play({name:c,flip:!1}),addDisplay_1()}));for(var y=new Map,g=0,P=l;g<P.length;g++){var _=P[g];y.set(_.name,_)}var v={animations:y,id:t.id,gene:h.sync(n.dataPath+n.texturePath),discriminator:"FramesModel",animationName:c,display:n};this.mFramesDisplay.load(v)||addDisplay_1()}},DetailDisplay.prototype.loadAvatar=function(t,e,i){var n=this;void 0===e&&(e=1),this.curLoadType=a.DragonbonesDisplay,this.clearDisplay(),this.mDragonboneDisplay||(this.mDragonboneDisplay=new s.UIDragonbonesDisplay(this.scene,this.render),i&&(this.mDragonboneDisplay.x+=i.x,this.mDragonboneDisplay.y+=i.y)),this.addDisplay(),t.suits&&this.mDragonboneDisplay.setSuits(t.suits),this.mDragonboneDisplay.once("initialized",(function(){n.mDragonboneDisplay.setBack(!1),n.mDragonboneDisplay.play({name:"idle",flip:!1})}));var o={id:0,avatar:t.avatar};this.mDragonboneDisplay.load(o),this.mDragonboneDisplay.scale=e,this.scale=1},DetailDisplay.prototype.loadUrl=function(t,e){this.mUrl=t,this.curLoadType=a.Image,this.clearDisplay(),this.mImage||(this.mImage=this.scene.make.image(void 0,!1)),this.scene.textures.exists(t)?this.onCompleteHandler():(e?this.scene.load.atlas(t,o.Url.getOsdRes(t),o.Url.getOsdRes(e)):this.scene.load.image(t,o.Url.getOsdRes(t)),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.start())},DetailDisplay.prototype.loadSprite=function(t,e,i,n){var h=this;this.curLoadType=a.FrameAnimation,this.clearDisplay(),this.mFrameAni||(this.mFrameAni=new s.FrameAnimation(this.scene)),this.mFrameAni.load(t,e,i,new o.Handler(this,(function(){if(void 0===n)if(0!==h.mFixedSize){h.scale=1;var t=h.width/h.mFrameAni.width,e=h.height/h.mFrameAni.height,i=t>e?e:t;h.mFrameAni.scale=1===h.mFixedSize?i:Math.round(i)}else h.mFrameAni.scale=1,h.scale=h.mFixScale;else h.mFrameAni.scale=n,h.scale=1;h.addDisplay()})))},DetailDisplay.prototype.displayLoading=function(t,e,i,n){this.loadSprite(t,e,i,n),this.isLoading=!0},DetailDisplay.prototype.setTexture=function(t,e,i){if(this.curLoadType=a.Image,this.clearDisplay(),this.mImage?this.mImage.setTexture(t,e):this.mImage=this.scene.make.image({key:t,frame:e},!1),this.addDisplay(),void 0===i)if(0!==this.mFixedSize){this.scale=1;var n=this.width/this.mImage.width,s=this.height/this.mImage.height,o=n>s?s:n;this.mImage.scale=1===this.mFixedSize?o:Math.round(o)}else this.mImage.scale=1,this.scale=this.mFixScale;else this.mImage.scale=i,this.scale=1;this.emit("show",this.mImage)},DetailDisplay.prototype.setNearest=function(){this.mImage&&this.mImage.texture.setFilter(Phaser.Textures.FilterMode.NEAREST)},DetailDisplay.prototype.setComplHandler=function(t){this.complHandler=t},DetailDisplay.prototype.setPlayAnimation=function(t,e){void 0===e&&(e=!1),this.mDragonboneDisplay&&(this.mDragonboneDisplay.setBack(e),this.mDragonboneDisplay.play(t))},Object.defineProperty(DetailDisplay.prototype,"display",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),DetailDisplay.prototype.onCompleteHandler=function(){if(this.scene){if(this.addDisplay(),this.mDisplay){this.mDisplay.display;var t=this.mDisplay.animations;if(!t||t.length<=0)return;this.mImage.setTexture(this.mDisplay.display.texturePath,t[0].frameName[0])}else this.mImage.setTexture(this.mUrl);if(0!==this.mFixedSize){this.scale=1,this.mImage.scale=1;var e=this.width/this.mImage.displayWidth,i=this.height/this.mImage.displayHeight,n=e>i?i:e;this.mImage.scale=1===this.mFixedSize?n:Math.round(n)}else this.mImage.scale=this.mFixScale,this.mImage.scale=1,this.setSize(this.mImage.width*this.scale,this.mImage.height*this.scale);this.emit("show",this.mImage),this.complHandler&&this.complHandler.run()}},DetailDisplay.prototype.clearDisplay=function(){this.mImage&&this.remove(this.mImage),this.mDragonboneDisplay&&this.remove(this.mDragonboneDisplay),this.mFramesDisplay&&this.remove(this.mFramesDisplay),this.mFrameAni&&(this.isLoading||this.remove(this.mFrameAni)),this.mDisplay=void 0,this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this)},DetailDisplay.prototype.addDisplay=function(){this.scene&&(this.isLoading&&this.remove(this.mFrameAni),this.curLoadType===a.Image?this.add(this.mImage):this.curLoadType===a.FramesDisplay?this.add(this.mFramesDisplay):this.curLoadType===a.FrameAnimation?this.add(this.mFrameAni):this.curLoadType===a.DragonbonesDisplay&&this.add(this.mDragonboneDisplay),this.isLoading=!1)},DetailDisplay}(Phaser.GameObjects.Container);!function(t){t[t.None=0]="None",t[t.Image=1]="Image",t[t.DragonbonesDisplay=2]="DragonbonesDisplay",t[t.FramesDisplay=3]="FramesDisplay",t[t.FrameAnimation=4]="FrameAnimation"}(a||(a={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n,a=i(2),s=i(435),o=i(15),h=i(147),l=i(540),c=i(0),p=i(612),d=i(485),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},u=function(){function MotionManager(t){this.render=t,this.dirty=!1,this.holdDelay=200,this.scaleRatio=t.scaleRatio}return MotionManager.prototype.addListener=function(){this.scene&&(this.scene.input.on("pointerup",this.onPointerUpHandler,this),this.scene.input.on("pointerdown",this.onPointerDownHandler,this),this.scene.input.on("gameobjectdown",this.onGameObjectDownHandler,this),this.scene.input.on("gameobjectup",this.onGameObjectUpHandler,this))},MotionManager.prototype.removeListener=function(){this.scene&&(this.scene.input.off("pointerup",this.onPointerUpHandler,this),this.scene.input.off("pointerdown",this.onPointerDownHandler,this),this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.scene.input.off("gameobjectdown",this.onGameObjectDownHandler,this),this.scene.input.off("gameobjectup",this.onGameObjectUpHandler,this))},MotionManager.prototype.resize=function(t,e){this.scaleRatio=this.render.scaleRatio},MotionManager.prototype.update=function(t,e){if(!1!==this.dirty&&(this.curtime+=e,!(this.curtime<200))){this.curtime=0;var i=this.scene.input.activePointer;if(i.camera&&i.camera.scene&&i.camera.scene.sys.settings.key===d.c.name)return this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),void this.clearGameObject();if(i&&this.render.displayManager.user&&this.render.displayManager){var n=this.render.displayManager.user,a=n.x,s=n.y,o=i.worldX/this.scaleRatio-a,h=i.worldY/this.scaleRatio-s,l=this.scene.cameras.main.getWorldPoint(i.x-o,i.y-h);this.start(l.x/this.scaleRatio,l.y/this.scaleRatio)}}},MotionManager.prototype.setScene=function(t){this.removeListener(),this.scene=t,this.scene&&this.addListener()},MotionManager.prototype.destroy=function(){this.removeListener()},MotionManager.prototype.start=function(t,e,i){this.render.physicalPeer.moveMotion(t,e,i)},MotionManager.prototype.movePath=function(t,e,i,n,a){this.render.physicalPeer.findPath(n,a)},MotionManager.prototype.stop=function(){this.render.physicalPeer.stopMove()},MotionManager.prototype.onPointerUpHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n,s,o;return __generator(this,(function(h){switch(h.label){case 0:return this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),Math.abs(t.downX-t.upX)>=5*this.render.scaleRatio&&Math.abs(t.downY-t.upY)>=5*this.render.scaleRatio||t.upTime-t.downTime>this.holdDelay?(this.stop(),[3,5]):[3,1];case 1:return this.gameObject?(e=this.gameObject.getData("id"))?(i=this.render.displayManager.getDisplay(e)).nodeType===p.a.CharacterNodeType?(this.render.mainPeer.activePlayer(e),this.clearGameObject(),[2]):[4,this.render.physicalPeer.getInteractivePosition(e)]:[3,3]:[3,4];case 2:(n=h.sent())&&0!==n.length||(s=i.x,o=i.y,n=[{x:s,y:o}]),this.movePath(t.worldX/this.render.scaleRatio,t.worldY/this.render.scaleRatio,0,n,e),h.label=3;case 3:return[3,5];case 4:this.movePath(t.worldX/this.render.scaleRatio,t.worldY/this.render.scaleRatio,0,[new a.LogicPos(t.worldX/this.scaleRatio,t.worldY/this.scaleRatio)]),h.label=5;case 5:return this.clearGameObject(),[2]}}))}))},MotionManager.prototype.onPointerDownHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return this.scene.input.on("pointermove",this.onPointerMoveHandler,this),this.holdTime=setTimeout((function(){t.dirty=!0}),this.holdDelay),[2]}))}))},MotionManager.prototype.onPointerMoveHandler=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.dirty=!0,[2]}))}))},MotionManager.prototype.onPointeroutHandler=function(){this.dirty=!1,this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.stop(),clearTimeout(this.holdTime)},MotionManager.prototype.onGameObjectDownHandler=function(t,e){this.gameObject=e},MotionManager.prototype.onGameObjectUpHandler=function(t,e){},MotionManager.prototype.clearGameObject=function(){this.gameObject=null,clearTimeout(this.holdTime)},MotionManager}(),m=i(13),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),y=function(t){function PlayScene(e){var i=t.call(this,e||{key:c.SceneName.PLAY_SCENE})||this;return i.loadState=c.PlaySceneLoadState.CREATING_SCENE,i}return f(PlayScene,t),PlayScene.prototype.preload=function(){t.prototype.preload.call(this)},Object.defineProperty(PlayScene.prototype,"motionMgr",{get:function(){return this.motionManager},enumerable:!1,configurable:!0}),PlayScene.prototype.create=function(){this.loadState=c.PlaySceneLoadState.CREATING_ROOM,a.Logger.getInstance().debug("create playscene");var e=this.cameras.main,i=this.sys.scale,n=i.width,l=i.height;(this.cameras.addExisting(new s.a(0,0,n,l,this.render.scaleRatio),!0),this.cameras.remove(e),this.game.scene.getScene(h.a.name)||this.game.scene.add(h.a.name,h.a,!1),this.game.scene.getScene(h.a.name).scene.isActive())?this.render.initUI():(this.scene.launch(h.a.name,{render:this.render}),this.render.sceneManager.bringToTop(c.SceneName.LOADING_SCENE));this.scene.sendToBack(),this.scale.on("orientationchange",this.checkOriention,this),this.scale.on("resize",this.checkSize,this),this.render.sceneManager.setMainScene(this),this.initInput(),this.render.camerasManager.startRoomPlay(this),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_GROUNDCLICK,1),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_GROUND2,2),this.layerManager.addLayer(this,o.h,PlayScene.LAYER_GROUND,3).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_MIDDLE,4).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.h,PlayScene.LAYER_FLOOR,4).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.l,PlayScene.LAYER_SURFACE,5).setScale(this.render.scaleRatio),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_ATMOSPHERE,6),this.layerManager.addLayer(this,o.d,PlayScene.LAYER_SCENEUI,7),this.render.startRoomPlay(),this.render.changeScene(this),this.initListener(),t.prototype.create.call(this)},PlayScene.prototype.update=function(t,e){this.render.updateRoom(t,e),this.layerManager.update(t,e),this.motionManager&&this.motionManager.update(t,e)},PlayScene.prototype.getKey=function(){return this.sys.config.key},Object.defineProperty(PlayScene.prototype,"loadState",{get:function(){return this.mLoadState},set:function(t){t!==this.mLoadState&&(a.Logger.getInstance().debug("PlayScene change loadState: ",t),this.mLoadState=t,t===c.PlaySceneLoadState.LOAD_COMPOLETE&&this.render.hideLoading())},enumerable:!1,configurable:!0}),PlayScene.prototype.onRoomCreated=function(){this.loadState=c.PlaySceneLoadState.LOAD_COMPOLETE},PlayScene.prototype.initInput=function(){this.motionManager=new u(this.render),this.motionManager.setScene(this)},PlayScene.prototype.initListener=function(){this.input.on("pointerdown",this.onPointerDownHandler,this),this.input.on("pointerup",this.onPointerUpHandler,this)},PlayScene.prototype.onPointerDownHandler=function(t){this.addPointerMoveHandler()},PlayScene.prototype.onPointerUpHandler=function(t){this.removePointerMoveHandler()},PlayScene.prototype.addPointerMoveHandler=function(){this.input.on("pointermove",this.onPointerMoveHandler,this),this.input.on("gameout",this.onGameOutHandler,this)},PlayScene.prototype.removePointerMoveHandler=function(){this.input.off("pointermove",this.onPointerMoveHandler,this),this.input.off("gameout",this.onGameOutHandler,this),this.render.camerasManager.moving&&(this.render.syncCameraScroll(),this.render.camerasManager.moving=!1)},PlayScene.prototype.onPointerMoveHandler=function(t){this.render.camerasManager.targetFollow||this.render.camerasManager.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},PlayScene.prototype.onGameOutHandler=function(){this.removePointerMoveHandler()},PlayScene.prototype.checkOriention=function(t){t===Phaser.Scale.PORTRAIT||Phaser.Scale.LANDSCAPE},PlayScene.prototype.checkSize=function(t){t.width,t.height},PlayScene.LAYER_GROUNDCLICK="groundClickLayer",PlayScene.LAYER_GROUND2="groundLayer2",PlayScene.LAYER_GROUND=m.LayerEnum.Terrain.toString(),PlayScene.LAYER_MIDDLE="middleLayer",PlayScene.LAYER_FLOOR=m.LayerEnum.Floor.toString(),PlayScene.LAYER_SURFACE=m.LayerEnum.Surface.toString(),PlayScene.LAYER_ATMOSPHERE="atmosphere",PlayScene.LAYER_SCENEUI="sceneUILayer",PlayScene}(l.a)},function(t,e,i){"use strict";i.d(e,"c",(function(){return a.ItemButton})),i.d(e,"a",(function(){return a.DetailDisplay})),i.d(e,"e",(function(){return a.PicaRenderUiManager})),i.d(e,"d",(function(){return a.PicaItemTipsPanel})),i.d(e,"b",(function(){return l}));var n,a=i(491),s=i(1),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function FallEffect(e,i){var n=t.call(this,e)||this;return n.scale=i,n}return h(FallEffect,t),FallEffect.prototype.show=function(t){this.mStatus=t,this.load()},FallEffect.prototype.load=function(){this.scene.textures.exists("fall_effect")?this.onCompleteHandler():(this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.atlas("fall_effect",o.Url.getRes("ui/fall_effect/falleffect.png"),o.Url.getRes("ui/fall_effect/falleffect.json")),this.scene.load.start())},FallEffect.prototype.showEnable=function(){this.mDisplay=new c(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.showDisable=function(){this.mDisplay=new p(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.onCompleteHandler=function(){var t=this;this.mStatus===s.op_def.PathReachableStatus.PATH_REACHABLE_AREA||this.mStatus===s.op_def.PathReachableStatus.PATH_REACHABLE_WITH_INTERACTION_SPRITE?this.showEnable():this.showDisable(),this.scene.tweens.add({targets:this,duration:1e3,ease:"Expo",delay:1e3,props:{alpha:0},onComplete:function(){t.destroy(),t.emit("remove",t)}})},FallEffect}(Phaser.GameObjects.Container),c=function(t){function EnableDisplay(e,i){var n=t.call(this,e)||this;n.mImage=e.make.sprite({key:i,x:9,y:-20},!1).setScale(.5),n.add(n.mImage),n.mEllipse=e.make.sprite(void 0,!1),n.addAt(n.mEllipse,0);var a={key:"fill_effect_enable",frames:n.scene.anims.generateFrameNames("fall_effect",{prefix:"enable",end:6,zeroPad:2}),frameRate:16,repeat:0};n.scene.anims.create(a),n.mImage.play("fill_effect_enable");var s={key:"fill_effect_ellipse",frames:n.scene.anims.generateFrameNames("fall_effect",{prefix:"ellipse",end:7,zeroPad:2}),frameRate:10,repeat:0};return n.scene.anims.create(s),n.mEllipse.play("fill_effect_ellipse"),n}return h(EnableDisplay,t),EnableDisplay}(Phaser.GameObjects.Container),p=function(t){function DisableDisplay(e,i){var n=t.call(this,e)||this;return n.mImage=e.make.image({key:i,y:-6,frame:"disable"},!1).setScale(.5),n.add(n.mImage),n.mEllipse=e.make.image({key:i,frame:"forbid"},!1).setScale(.5),n.add([n.mImage,n.mEllipse]),n}return h(DisableDisplay,t),DisableDisplay}(Phaser.GameObjects.Container);!function(){function FallEffectContainer(t){this.render=t,this.mFalls=[]}FallEffectContainer.prototype.addFall=function(t,e){if(t){var i=this.render.sceneManager.getMainScene(),n=new l(i,this.render.scaleRatio);n.once("remove",this.onRemoveHandler,this),n.setPosition(t.x,t.y),i.layerManager.addToLayer("sceneUILayer",n)}},FallEffectContainer.prototype.onRemoveHandler=function(t){}}()},function(t,e,i){"use strict";var n=i(294);i.d(e,"a",(function(){return n.a}));i(611);var a=i(619);i.d(e,"b",(function(){return a.a}));i(620),i(621),i(546);var s=i(147);i.d(e,"c",(function(){return s.a}));var o=i(483);i.d(e,"d",(function(){return o.a}));i(540),i(632),i(622),i(434)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaSingleManager",(function(){return a}));var n=i(2),a=function(){function PicaSingleManager(t){this.uiMgr=t,this.singleMap=new Map,this.uiMgr=t,PicaSingleManager.Intsance=this}return PicaSingleManager.prototype.destroy=function(){this.clearSingleMap()},PicaSingleManager.prototype.clearSingleMap=function(){var t=this.singleMap;t.forEach((function(t,e){t.destroy(),n.Logger.getInstance().debug(t)})),t.clear()},PicaSingleManager.createSinglePanel=function(t){var e=this.Intsance,i=new t(this.Intsance.uiMgr);return e.singleMap.set(t.name,i),i},PicaSingleManager}()},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorBasePanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaManorBasePanel(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.key=h,l.setSize(a,s),l.create(),l}return h(PicaManorBasePanel,t),PicaManorBasePanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorBasePanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaManorBasePanel.prototype.create=function(){var t=this.width,e=this.height;this.createBackground(t,e);var i=.5*-e;this.titlebg=this.scene.make.image({x:0,y:0,key:s.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i+5*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("manor.title"),style:{color:"#905C06",fontSize:21*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),this.titleText.setFontStyle("bold"),this.titleText.setResolution(this.dpr),this.add(this.titleText),this.closeBtn=new a.Button(this.scene,s.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn)},PicaManorBasePanel.prototype.createBackground=function(t,e){this.bg=new a.NineSlicePatch(this.scene,0,0,t,e,s.c.commonKey,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg)},PicaManorBasePanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorBasePanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"SecondaryMenuPanel",(function(){return o}));var n,a=i(6),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function SecondaryMenuPanel(e,i,n,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.dpr=h,p.zoom=l,p.setSize(s,o),c.cellupCallBack=p.onSelectCategoryHandler.bind(p),p.gameScroll=new a.GameScroller(p.scene,c),p.add(p.gameScroll),p}return s(SecondaryMenuPanel,t),SecondaryMenuPanel.prototype.setHandler=function(t,e){this.categoryHandler=t,this.subCategoryHandler=e},SecondaryMenuPanel.prototype.setButtonChangeHandler=function(t,e,i,n){this.categoryNormalHandler=t,this.categoryDownHandler=e,this.subNormalHandler=i,this.subDownHandler=n},SecondaryMenuPanel.prototype.setCategories=function(t,e,i,n){this.categoryBtn=void 0,this.gameScroll.clearItems();for(var a=i.width,s=i.height,o=i.key,h=i.normalFrame,l=i.downFrame,c=i.patchConfig,p=i.music,d=i.bold,u=[],m=0,f=e;m<f.length;m++){var y=f[m],g=y.text,P=new t(this.scene,o,h,l,g,p,this.dpr,this.zoom,c);i.textStyle&&P.setTextStyle(i.textStyle),P.setData("category",y.data),P.disableInteractive(),d&&P.setFontStyle("bold"),a&&(P.width=a),s&&(P.height=s),this.gameScroll.addItem(P),u.push(P)}this.gameScroll.Sort(!0),this.gameScroll.refreshMask(),n&&n.runWith([u]),this.onSelectCategoryHandler(u[0])},SecondaryMenuPanel.prototype.setSubItems=function(t){if(this.gridTable){this.subCategoryBtn=void 0,this.gridTable.setItems(t),this.gridTable.resetMask();var e=this.gridTable.getCells();if(e){var i=e[0];i&&i.container&&this.onSubCategoryHandler(i.container)}}},SecondaryMenuPanel.prototype.createGrideTable=function(t,e,i,n,s,o,h,l){var c=this;void 0===l&&(l=1);var p={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,zoom:this.zoom},scrollMode:l,clamplChildOY:!1,createCellContainerCallback:h};this.gridTable=new a.GameGridTable(this.scene,p),this.gridTable.layout(),this.gridTable.on("cellTap",(function(t){t&&c.onSubCategoryHandler(t)})),this.add(this.gridTable),this.gridTable.resetMask()},SecondaryMenuPanel.prototype.onSelectCategoryHandler=function(t){this.categoryBtn&&(this.categoryNormalHandler?this.categoryNormalHandler.runWith(this.categoryBtn):this.categoryBtn.changeNormal()),this.categoryDownHandler?this.categoryDownHandler.runWith(t):t.changeDown(),this.categoryBtn=t;var e=t.getData("category");this.categoryHandler&&this.categoryHandler.runWith(e)},SecondaryMenuPanel.prototype.onSubCategoryHandler=function(t){this.subCategoryBtn&&(this.subNormalHandler?this.subNormalHandler.runWith(this.subCategoryBtn):this.subCategoryBtn.changeNormal()),this.subDownHandler?this.subDownHandler.runWith(t):t.changeDown(),this.subCategoryBtn=t,this.subCategoryHandler&&this.subCategoryHandler.runWith(t)},SecondaryMenuPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessContentPanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessContentPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.setSize(a,s),c.dpr=o,c.key=h,c.key2=l,c.create(),c}return h(PicaBusinessContentPanel,t),PicaBusinessContentPanel.prototype.create=function(){var t=this.width,e=this.height;this.bg=new a.NineSlicePatch(this.scene,0,0,t,e,s.c.common2Key,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg);var i=.5*-e;this.topbg=this.scene.make.image({key:this.key,frame:"eaves"}),this.topbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.topbg.y=i-2*this.dpr,this.add(this.topbg),this.titlebg=this.scene.make.image({key:this.key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i-25*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y-5*this.dpr,text:o.i18n.t("business_street.commercial_street"),style:{fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(.5,0),this.titleText.setStroke("#553100",2*this.dpr),this.titleText.setShadow(2,2,"#553100",4*this.dpr,!0,!0),this.titleText.setFontStyle("bold"),this.add(this.titleText),this.closeBtn=new a.Button(this.scene,s.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.setContentSize(t,e)},PicaBusinessContentPanel.prototype.setContentSize=function(t,e){this.setSize(t,e),this.bg.resize(t,e);var i=.5*-e;this.topbg.y=i-2*this.dpr,this.titlebg.y=i-25*this.dpr,this.titleText.y=this.titlebg.y-5*this.dpr,this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr)},PicaBusinessContentPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaBusinessContentPanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaBusinessContentPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaBusinessContentPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChapterLevelClue",(function(){return h}));var n,a=i(21),s=i(481),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaChapterLevelClue(e,i,n,s){var o=t.call(this,e,a.d.uicommon,"bag_icon_common_bg",i,1,!1)||this;return o.dpr=i,o.setSize(n,s),o.gou=o.scene.make.image({key:a.d.uicommon,frame:"selected"}),o.gou.x=.5*o.width-.5*o.gou.width,o.gou.y=.5*o.height-.5*o.gou.height,o.add([o.gou]),o.BGVisible=!1,o}return o(PicaChapterLevelClue,t),PicaChapterLevelClue.prototype.setItemData=function(e){t.prototype.setItemData.call(this,e),this.gou.visible=0!==e.count},PicaChapterLevelClue}(s.ItemButton)},function(t,e,i){"use strict";i.r(e);var n=i(481);i.d(e,"ItemButton",(function(){return n.ItemButton})),i.d(e,"DetailDisplay",(function(){return n.DetailDisplay})),i.d(e,"BackTextButton",(function(){return n.BackTextButton})),i.d(e,"EnergyProgressBar",(function(){return n.EnergyProgressBar}));var a=i(549);i.d(e,"ActivityPanel",(function(){return a.ActivityPanel}));var s=i(493);i.d(e,"CharacterAttributePanel",(function(){return s.CharacterAttributePanel}));var o=i(494);i.d(e,"CharacterEditorPanel",(function(){return o.CharacterEditorPanel}));var h=i(550);i.d(e,"CharacterInfoPanel",(function(){return h.CharacterInfoPanel}));var l=i(551);i.d(e,"GraphicsProgressBar",(function(){return l.GraphicsProgressBar}));var c=i(552);i.d(e,"PicaHandheldPanel",(function(){return c.PicaHandheldPanel}));var p=i(495);i.d(e,"PicaChatInputPanel",(function(){return p.PicaChatInputPanel}));var d=i(496);i.d(e,"PicaGiftPanel",(function(){return d.PicaGiftPanel}));var u=i(553);i.d(e,"PicaChatPanel",(function(){return u.PicaChatPanel}));var m=i(554);i.d(e,"PicaMainUIPanel",(function(){return m.PicaMainUIPanel}));var f=i(555);i.d(e,"PicaRenderUiManager",(function(){return f.PicaRenderUiManager}));var y=i(558);i.d(e,"CutInPanel",(function(){return y.CutInPanel}));var g=i(560);i.d(e,"DialogPanel",(function(){return g.DialogPanel}));var P=i(561);i.d(e,"LoginPanel",(function(){return P.LoginPanel}));var _=i(562);i.d(e,"VerifiedPanel",(function(){return _.VerifiedPanel}));var v=i(557);i.d(e,"CreateRolePanel",(function(){return v.CreateRolePanel}));var b=i(498);i.d(e,"InteractionBubbleCell",(function(){return b.InteractionBubbleCell}));var T=i(499);i.d(e,"InteractionBubbleContainer",(function(){return T.InteractionBubbleContainer}));var S=i(556);i.d(e,"InteractiveBubblePanel",(function(){return S.InteractiveBubblePanel}));var x=i(590);i.d(e,"PicaNavigatePanel",(function(){return x.PicaNavigatePanel}));var w=i(567);i.d(e,"PicaBagPanel",(function(){return w.PicaBagPanel}));i(482);var D=i(523);i.d(e,"ElementDetail",(function(){return D.ElementDetail}));var C=i(586);i.d(e,"PicaMarketPanel",(function(){return C.PicaMarketPanel}));var I=i(524);i.d(e,"NumberCounter",(function(){return I.NumberCounter}));var k=i(525);i.d(e,"MarketItem",(function(){return k.MarketItem}));var B=i(579);i.d(e,"PicaFriendPanel",(function(){return B.PicaFriendPanel}));var E=i(597);i.d(e,"PicaPropFunPanel",(function(){return E.PicaPropFunPanel}));var A=i(593);i.d(e,"PicaNoticePanel",(function(){return A.PicaNoticePanel}));var O=i(596);i.d(e,"PicaPartyListPanel",(function(){return O.PicaPartyListPanel}));var M=i(521);i.d(e,"PicaManorContentPanel",(function(){return M.PicaManorContentPanel}));var R=i(585);i.d(e,"PicaManorListPanel",(function(){return R.PicaManorListPanel}));var F=i(522);i.d(e,"PicaManorScrollPanel",(function(){return F.PicaManorScrollPanel}));var N=i(530);i.d(e,"PicaOpenPartyCreatePanel",(function(){return N.PicaOpenPartyCreatePanel}));var L=i(595);i.d(e,"PicaOpenPartyPanel",(function(){return L.PicaOpenPartyPanel}));var H=i(607);i.d(e,"TaskPanel",(function(){return H.TaskPanel}));var G=i(487);i.d(e,"PicaManorBasePanel",(function(){return G.PicaManorBasePanel}));var U=i(500);i.d(e,"PicaManorChildPanel",(function(){return U.PicaManorChildPanel}));var z=i(563);i.d(e,"PicManorInfoPanel",(function(){return z.PicManorInfoPanel}));var j=i(501);i.d(e,"PicaManorShopPanel",(function(){return j.PicaManorShopPanel}));var V=i(564);i.d(e,"PicaManorTipsPanel",(function(){return V.PicaManorTipsPanel}));var W=i(489);i.d(e,"PicaBusinessContentPanel",(function(){return W.PicaBusinessContentPanel}));var Y=i(504);i.d(e,"PicaBusinessHistoryPanel",(function(){return Y.PicaBusinessHistoryPanel}));var K=i(505);i.d(e,"PicaBusinessMyStreetPanel",(function(){return K.PicaBusinessMyStreetPanel}));var q=i(506);i.d(e,"PicaBusinessRankRewardPanel",(function(){return q.PicaBusinessRankRewardPanel}));var X=i(507);i.d(e,"PicaBusinessRankingDetailPanel",(function(){return X.PicaBusinessRankingDetailPanel}));var Q=i(508);i.d(e,"PicaBusinessRankingPanel",(function(){return Q.PicaBusinessRankingPanel}));var Z=i(509);i.d(e,"PicaBusinessStoreCreatePanel",(function(){return Z.PicaBusinessStoreCreatePanel}));var J=i(510);i.d(e,"PicaBusinessStreetListPanel",(function(){return J.PicaBusinessStreetListPanel}));var $=i(569);i.d(e,"PicaBusinessStreetPanel",(function(){return $.PicaBusinessStreetPanel}));var tt=i(488);i.d(e,"SecondaryMenuPanel",(function(){return tt.SecondaryMenuPanel}));var et=i(502);i.d(e,"PicaBusinessChoosePlanPanel",(function(){return et.PicaBusinessChoosePlanPanel}));var it=i(568);i.d(e,"PicaBusinessMarketingPlanPanel",(function(){return it.PicaBusinessMarketingPlanPanel}));var nt=i(503);i.d(e,"PicaBusinessPlanPanel",(function(){return nt.PicaBusinessPlanPanel}));var rt=i(599);i.d(e,"PicaRechargePanel",(function(){return rt.PicaRechargePanel}));var at=i(572);i.d(e,"PicaDecorateControlPanel",(function(){return at.PicaDecorateControlPanel}));var st=i(565);i.d(e,"PicRoomUpgradePanel",(function(){return st.PicRoomUpgradePanel}));var ot=i(512);i.d(e,"PicaEquipUpgradeItem",(function(){return ot.PicaEquipUpgradeItem}));var ht=i(576);i.d(e,"PicaEquipUpgradePanel",(function(){return ht.PicaEquipUpgradePanel}));var lt=i(602);i.d(e,"PicaRoomListPanel",(function(){return lt.PicaRoomListPanel})),i.d(e,"RoomDelegate",(function(){return lt.RoomDelegate})),i.d(e,"RoomZoon",(function(){return lt.RoomZoon}));var ct=i(606);i.d(e,"PicaWorkPanel",(function(){return ct.PicaWorkPanel}));var pt=i(588);i.d(e,"PicaMineCarPanel",(function(){return pt.PicaMineCarPanel}));var dt=i(583);i.d(e,"PicaHousePanel",(function(){return dt.PicaHousePanel}));var ut=i(520);i.d(e,"PicaHouseInfoPanel",(function(){return ut.PicaHouseInfoPanel}));var mt=i(589);i.d(e,"PicaMineSettlePanel",(function(){return mt.PicaMineSettlePanel}));var ft=i(600);i.d(e,"PicaRewardTipPanel",(function(){return ft.PicaRewardTipPanel}));var yt=i(570);i.d(e,"PicaComposePanel",(function(){return yt.PicaComposePanel}));var gt=i(584);i.d(e,"PicaItemPopCardPanel",(function(){return gt.PicaItemPopCardPanel}));var Pt=i(587);i.d(e,"PicaMessageBoxPanel",(function(){return Pt.PicaMessageBoxPanel}));var _t=i(574);i.d(e,"PicaElementStoragePanel",(function(){return _t.PicaElementStoragePanel}));var vt=i(559);i.d(e,"CutInMenuPanel",(function(){return vt.CutInMenuPanel}));var bt=i(538);i.d(e,"PicaTreasureOpenPanel",(function(){return bt.PicaTreasureOpenPanel}));var Tt=i(605);i.d(e,"PicaTreasurePanel",(function(){return Tt.PicaTreasurePanel}));var St=i(539);i.d(e,"PicaTreasurePreviewPanel",(function(){return St.PicaTreasurePreviewPanel}));var xt=i(537);i.d(e,"PicaTreasureAllOpenPanel",(function(){return xt.PicaTreasureAllOpenPanel}));var wt=i(582);i.d(e,"PicaGiftEffectPanel",(function(){return wt.PicaGiftEffectPanel}));var Dt=i(518);i.d(e,"PicaGiftLateralItem",(function(){return Dt.PicaGiftLateralItem}));var Ct=i(517);i.d(e,"PicaGiftLaterctPanel",(function(){return Ct.PicaGiftLaterctPanel}));var It=i(519);i.d(e,"PicaGiftPlayerPanel",(function(){return It.PicaGiftPlayerPanel}));var kt=i(580);i.d(e,"PicaFurniFunPanel",(function(){return kt.PicaFurniFunPanel}));var Bt=i(592);i.d(e,"PicaNewRolePanel",(function(){return Bt.PicaNewRolePanel}));var Et=i(526);i.d(e,"PicaNewActivityPanel",(function(){return Et.PicaNewActivityPanel}));var At=i(527);i.d(e,"PicaNewChatPanel",(function(){return At.PicaNewChatPanel}));var Ot=i(528);i.d(e,"PicaNewHeadPanel",(function(){return Ot.PicaNewHeadPanel}));var Mt=i(529);i.d(e,"PicaNewLeftPanel",(function(){return Mt.PicaNewLeftPanel}));var Rt=i(497);i.d(e,"PicaNewNavigatePanel",(function(){return Rt.PicaNewNavigatePanel}));var Ft=i(591);i.d(e,"PicaNewMainPanel",(function(){return Ft.PicaNewMainPanel}));var Nt=i(566);i.d(e,"PicaAvatarPanel",(function(){return Nt.PicaAvatarPanel}));var Lt=i(594);i.d(e,"PicaOnlinePanel",(function(){return Lt.PicaOnlinePanel}));var Ht=i(573);i.d(e,"PicaEffectMgrPanel",(function(){return Ht.PicaEffectMgrPanel}));var Gt=i(511);i.d(e,"PicaFurniUnlockEffectPanel",(function(){return Gt.PicaFurniUnlockEffectPanel}));var Ut=i(534);i.d(e,"PicaTaskItem",(function(){return Ut.PicaTaskItem}));var zt=i(535);i.d(e,"PicaTaskMainPanel",(function(){return zt.PicaTaskMainPanel}));var jt=i(603);i.d(e,"PicaTaskPanel",(function(){return jt.PicaTaskPanel}));var Vt=i(604);i.d(e,"PicaTaskSidePanel",(function(){return Vt.PicaTaskSidePanel}));var Wt=i(575);i.d(e,"PicaElevatorPanel",(function(){return Wt.PicaElevatorPanel}));var Yt=i(571);i.d(e,"PicaCreateRolePanel",(function(){return Yt.PicaCreateRolePanel}));var Kt=i(536);i.d(e,"PicaItemTipsPanel",(function(){return Kt.PicaItemTipsPanel}));var qt=i(486);i.d(e,"PicaSingleManager",(function(){return qt.PicaSingleManager}));var Xt=i(581);i.d(e,"PicaFurnitureComposePanel",(function(){return Xt.PicaFurnitureComposePanel}));var Qt=i(598);i.d(e,"PicaRecastePanel",(function(){return Qt.PicaRecastePanel}));var Zt=i(532);i.d(e,"PicaRoamListPanel",(function(){return Zt.PicaRoamListPanel}));var Jt=i(601);i.d(e,"PicaRoamPanel",(function(){return Jt.PicaRoamPanel}));var $t=i(531);i.d(e,"PicaRoamDrawPanel",(function(){return $t.PicaRoamDrawPanel}));var te=i(533);i.d(e,"PicaRoamPreviewPanel",(function(){return te.PicaRoamPreviewPanel}));var ee=i(578);i.d(e,"PicaExploreLogPanel",(function(){return ee.PicaExploreLogPanel}));var ie=i(516);i.d(e,"PicaExploreLogSettlePanel",(function(){return ie.PicaExploreLogSettlePanel}));var ne=i(490);i.d(e,"PicaChapterLevelClue",(function(){return ne.PicaChapterLevelClue}));var re=i(513);i.d(e,"PicaExploreListBottomPanel",(function(){return re.PicaExploreListBottomPanel}));var ae=i(514);i.d(e,"PicaExploreListDetailPanel",(function(){return ae.PicaExploreListDetailPanel}));var se=i(515);i.d(e,"PicaExploreListLevelPanel",(function(){return se.PicaExploreListLevelPanel}));var oe=i(577);i.d(e,"PicaExploreListPanel",(function(){return oe.PicaExploreListPanel}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function AnimationUrlData(){}return AnimationUrlData.prototype.setData=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=".json"),this.resName=t,this.resUrl=e,this.pngUrl=e+"/"+t+(i?"_tex.png":".png"),this.jsonUrl=e+"/"+t+(i?"_tex.json":".json"),i&&(this.boneUrl=e+"/"+t+"_ske"+n),this.responseType=".dbbin"===n?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.setDisplayData=function(t,e,i){void 0===i&&(i=".json"),this.pngUrl=t,this.jsonUrl=e,this.responseType=".dbbin"===i?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.dispose=function(){this.textureXhrSettings=null,this.atlasXhrSettings=null,this.boneXhrSettings=null},AnimationUrlData}()},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterAttributePanel",(function(){return l}));var n,a=i(6),s=i(2),o=i(479),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function CharacterAttributePanel(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.attriItems=[],l.setSize(a,s),l.key=o,l.dpr=h,l.mspace=10*h,l}return h(CharacterAttributePanel,t),Object.defineProperty(CharacterAttributePanel.prototype,"space",{set:function(t){this.mspace=t},enumerable:!1,configurable:!0}),CharacterAttributePanel.prototype.setAttributeData=function(t){for(var e=t.length,i=e>4?2:1,n=this.width,a=this.height,s=20*this.dpr,o=n/2,h=.5*-a+10*this.dpr,l=0,p=this.attriItems;l<p.length;l++){(u=p[l]).visible=!1}for(var d=0;d<e;d++){var u=void 0;d<this.attriItems.length?u=this.attriItems[d]:(u=new c(this.scene,0,0,o,s,this.key,this.dpr),this.add(u),this.attriItems.push(u));var m=.5*(n-n/i)*(d<4?-1:1),f=h+.5*s+(s+this.mspace)*(d%4);u.setPosition(m,f),u.setInfo(t[d]),u.visible=!0}},CharacterAttributePanel}(Phaser.GameObjects.Container),c=function(t){function PlayerAttributeValue(e,i,n,h,l,c,p){var d=t.call(this,e,i,n)||this;return d.dpr=p,d.setSize(h,l),d.icon=new o.DynamicImage(d.scene,0,0),d.icon.x=.5*-h+10*p,d.nameText=d.scene.make.text({x:d.icon.x+13*p,y:0,text:"Attack:",style:{fontFamily:s.Font.DEFULT_FONT,fontSize:11*p,color:"#131313"}}).setOrigin(0,.5),d.valueText=new a.BBCodeText(d.scene,0,0,"100",{color:"#131313",fontSize:11*d.dpr,fontFamily:s.Font.DEFULT_FONT}).setOrigin(0,.5),d.valueText.x=d.nameText.x+d.nameText.width,d.add([d.icon,d.nameText,d.valueText]),d}return h(PlayerAttributeValue,t),PlayerAttributeValue.prototype.setInfo=function(t){var e=this;if(t.display){var i=s.Url.getOsdRes(t.display.texturePath);this.icon.load(i,this,(function(){e.icon.displayWidth=20*e.dpr,e.icon.scaleY=e.icon.scaleX}))}this.nameText.text=t.name+":",this.valueText.text=t.value+(t.tempValue?this.getRichLabel(t.tempValue):""),this.valueText.x=this.nameText.x+this.nameText.width+3*this.dpr},PlayerAttributeValue.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#0B77CD"),"[color="+e+"](+"+t+")[/color]"},PlayerAttributeValue}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterEditorPanel",(function(){return l}));var n,a=i(6),s=i(479),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function CharacterEditorPanel(e,i,n,h,l,c,p){var d=t.call(this,e,i,n)||this;d.dpr=0,d.key="",d.setSize(h,l),d.key=c,d.dpr=p;var u="bold "+15*d.dpr+"px Source Han Sans";d.title=d.scene.make.text({x:0,y:.5*-l+50*p,text:d.geti18n("edit_profile"),style:{font:u,blod:!0,color:"#ffffff",fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5);var m=d.scene.make.graphics(void 0,!1);m.clear(),m.fillStyle(16777215,.5),m.fillRect(0,0,247*p,350*p),m.setPosition(.5*-h,-184*p);var f=.5*-h+9*p,y=-170*p,g=50*p,P=d.scene.make.text({x:f,y:y,style:{blod:!0,color:"#0062BB",fontSize:15*p,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0);P.setText(d.geti18n("user_name")+":"),d.inputText=new a.InputText(d.scene,f+P.width+20*p,y,162*p,27*p,{type:"input",fontSize:18*p+"px",color:"#0062BB",align:"center",placeholder:d.geti18n("input_nickname")}).setOrigin(0);var _=d.createLine(-230*d.dpr*.5,y+32*d.dpr);d.add(m),d.add([d.title,P,d.inputText,_]),d.idText=d.createText("I        D:","",f,y+g),d.constellationText=d.createText(d.geti18n("constellation")+":","",f,y+2*g),d.birthdayText=d.createText(d.geti18n("birthday")+":","",f,y+3*g),d.cityText=d.createText(d.geti18n("city")+":","",f,y+4*g);var v=d.scene.make.text({x:f,y:y+5*g,style:{blod:!0,color:"#0062BB",fontSize:15*p,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0);v.setText(d.geti18n("signature")+":"),d.signInput=new a.InputText(d.scene,f+v.width+20*p,y+5*g,162*p,76*p,{type:"input",fontSize:18*p+"px",color:"#0062BB",align:"center",placeholder:d.geti18n("input_signature")}).setOrigin(0),d.add([v,d.signInput]);var b=new a.Button(d.scene,"common_key","back_arrow","back_arrow"),T=new s.NinePatchButton(d.scene,0,.5*l-40*p,174*d.dpr,37*d.dpr,"common_key","yellow_btn",d.geti18n("save"),{left:12*d.dpr,top:12*d.dpr,right:12*d.dpr,bottom:12*d.dpr});return T.setTextStyle({fontSize:16*d.dpr,color:"#ED7814"}),b.setPosition(f+8*p,.5*-l+50*p),b.on(a.ClickEvent.Tap,d.onBackHandler,d),T.on(a.ClickEvent.Tap,d.onSaveHandler,d),d.add([b,T]),d}return h(CharacterEditorPanel,t),CharacterEditorPanel.prototype.destroy=function(){this.inputText&&this.inputText.destroy(),this.signInput&&this.signInput.destroy(),t.prototype.destroy.call(this)},CharacterEditorPanel.prototype.createText=function(t,e,i,n){var a=this.scene.make.text({x:i,y:n,style:{blod:!0,color:"#0062BB",fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0,0);a.setText(t);var s=this.scene.make.text({x:i+a.width+20*this.dpr,y:n,text:e,style:{blod:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(0,0),h=this.createLine(-230*this.dpr*.5,n+32*this.dpr);return this.add([a,s,h]),s},CharacterEditorPanel.prototype.geti18n=function(t){return o.i18n.t("player_info."+t)},CharacterEditorPanel.prototype.createLine=function(t,e){var i=this.scene.make.graphics(void 0,!1);return i.clear(),i.fillStyle(25275,.6),i.fillRect(0,0,230*this.dpr,3),i.setPosition(t,e),i},CharacterEditorPanel.prototype.onBackHandler=function(){this.visible=!1,this.emit("editorHide")},CharacterEditorPanel.prototype.onSaveHandler=function(){},CharacterEditorPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChatInputPanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaChatInputPanel(e,i,n,h){var l=t.call(this)||this;l.chatArr=[],l.maxChatLength=100,l.isOpenQuickPanel=!1,l.isSendChat=!1,l.isDispose=!1,l.key=n,l.render=i,l.dpr=window.devicePixelRatio,l.scene=e,l.chatArr=h;var c=e.cameras.main.width,p=e.cameras.main.height;l.mBackground=e.add.graphics(),l.mBackground.clear(),l.mBackground.fillStyle(0,.6),l.mBackground.fillRect(0,0,c,p),l.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,c,p),Phaser.Geom.Rectangle.Contains),l.bottomCon=e.add.container(0,0),l.bottomCon.setPosition(.5*c,.5*p);var d=new a.NineSlicePatch(e,0,0,c,47*l.dpr,l.key,"chat_Input_bg",{left:2*l.dpr,top:0*l.dpr,right:2*l.dpr,bottom:0*l.dpr});l.bottomCon.setSize(c,d.height),l.bottomCon.add(d),l.sendBtn=new a.Button(l.scene,l.key,"chat_quick_2"),l.sendBtn.x=.5*-c+.5*l.sendBtn.width+12*l.dpr,l.sendBtn.on(String(a.ClickEvent.Tap),l.onQuickSendHandler,l),l.bottomCon.add(l.sendBtn),l.cancelBtn=new a.NineSliceButton(l.scene,0,0,63*l.dpr,28*l.dpr,s.c.commonKey,"red_btn_normal",o.i18n.t("common.cancel"),l.dpr,1,{left:14*l.dpr,top:0,right:14*l.dpr,bottom:0}),l.cancelBtn.setTextStyle({color:"#ffffff",fontSize:16*l.dpr,fontFamily:o.Font.DEFULT_FONT}),l.cancelBtn.x=.5*c-.5*l.cancelBtn.width-12*l.dpr,l.cancelBtn.on(String(a.ClickEvent.Tap),l.onCancelHandler,l),l.bottomCon.add(l.cancelBtn);var u=Math.abs(l.sendBtn.x-l.cancelBtn.x)-.5*l.sendBtn.width-.5*l.cancelBtn.width-16*l.dpr,m=l.sendBtn.x+.5*l.sendBtn.width+8*l.dpr+.5*u,f=new a.NineSlicePatch(l.scene,m,0,u,36*l.dpr,l.key,"chat_Input",{left:12*l.dpr,top:0*l.dpr,right:12*l.dpr,bottom:0*l.dpr});return l.bottomCon.add(f),l.mInput=new a.InputText(l.scene,m-.5*u,0,u,40*l.dpr,{type:"text",placeholder:"",color:"#0",fontSize:20*l.dpr+"px"}),l.mInput.setOrigin(0,.5),l.bottomCon.add(l.mInput),l.contentCon=e.add.container(0,0),l.contentCon.setSize(c,200*l.dpr),l.mOutputText=new a.BBCodeText(e,.5*-c+10*l.dpr,0,"",{fontSize:14*l.dpr+"px",fontFamily:o.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*l.dpr,textMask:!1,lineSpacing:2*l.dpr,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:c-12*l.dpr}}).setOrigin(0,.5),l.mOutputText.setResolution(l.dpr),l.gamescroll=new a.GameScroller(e,{x:0,y:0,width:c,height:l.contentCon.height,zoom:1,dpr:l.dpr,align:0,orientation:0,selfevent:!0}),l.contentCon.add(l.gamescroll),l.gamescroll.addItem(l.mOutputText),l.quickCon=l.scene.add.container(0,0),l.quickBg=l.scene.make.image({key:l.key,frame:"home_quick chat _bg"}),l.quickBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.quickCon.add(l.quickBg),l.quickCon.x=.5*c,l.quickChatScroll=new a.GameScroller(e,{x:0,y:0,width:c,height:200*l.dpr,zoom:1,dpr:l.dpr,align:2,orientation:0,cellupCallBack:function(t){l.onQuickChatItemHandler(t)}}),l.quickChatScroll.removeListen(),l.quickCon.add(l.quickChatScroll),l.mInput.on("blur",l.onBlurHandler,l),l.mInput.on("focus",l.onFocusHandler,l),l.mInput.node.addEventListener("keypress",(function(t){13===(t.keyCode||t.which)&&(l.isSendChat=!0,l.onSentChat())})),window.addEventListener("native.keyboardshow",l.onKeyboardHandler.bind(l)),l.bottomCon.visible=!1,l.contentCon.visible=!1,l}return h(PicaChatInputPanel,t),PicaChatInputPanel.prototype.setKeywordHeight=function(t){var e=this.scene.cameras.main.height,i=this.scene.cameras.main.width,n=e-t-0;this.bottomCon.visible=!0,this.contentCon.visible=!0,this.bottomCon.y=n-.5*this.bottomCon.height,this.contentCon.height=this.bottomCon.y-.5*this.bottomCon.height-20*this.dpr,this.contentCon.y=this.bottomCon.y-.5*this.bottomCon.height-.5*this.contentCon.height-5*this.dpr,this.contentCon.x=.5*i,this.gamescroll.resetSize(i,this.contentCon.height),this.gamescroll.refreshMask();var a=200*this.dpr;this.quickCon.y=this.bottomCon.y-.5*this.bottomCon.height,this.quickBg.y=.5*-a,this.quickBg.displayWidth=i+10*this.dpr,this.quickBg.displayHeight=a,this.quickChatScroll.y=this.quickBg.y,this.quickChatScroll.resetSize(i,a),this.keyboardHeight=t,this.setQuickChatItems()},PicaChatInputPanel.prototype.setQuickChatData=function(t){t&&(this.quickChatAtt=t),this.quickChatAtt.unshift(void 0),this.setKeywordHeight(0),this.onQuickSendHandler();for(var e="",i=0,n=this.chatArr;i<n.length;i++){e+=n[i]}this.mOutputText.text=e,this.gamescroll.Sort(),o.Logger.getInstance().debug(t)},PicaChatInputPanel.prototype.appendChat=function(t){this.chatArr.push(t),this.chatArr.length>this.maxChatLength&&this.chatArr.shift();for(var e="",i=0,n=this.chatArr;i<n.length;i++){e+=n[i]}this.mOutputText.text=e,this.gamescroll.Sort()},PicaChatInputPanel.prototype.onKeyboardHandler=function(t){o.Logger.getInstance().debug(t.keyboardHeight),this.keyboardHeight>0&&t.keyboardHeight===this.keyboardHeight||window.removeEventListener("native.keyboardshow",this.onKeyboardHandler.bind(this))},PicaChatInputPanel.prototype.setQuickChatItems=function(){this.quickChatScroll.clearItems(!0);this.scene.cameras.main.height;for(var t=this.scene.cameras.main.width,e=0;e<this.quickChatAtt.length;e++){var i=this.quickChatAtt[e];if(i){var n=new c(this.scene,t,30*this.dpr,this.key,this.dpr,0===e);this.quickChatScroll.addItem(n),n.setText(i)}}this.quickChatScroll.Sort(),this.quickCon.visible=!1},PicaChatInputPanel.prototype.setFirstQuickItem=function(){if(this.quickChatScroll.getItemList().length===this.quickChatAtt.length){var t=this.quickChatScroll.getItemList();t&&t.length>0&&t[0].setText(this.quickChatAtt[0])}else{var e=this.scene.cameras.main.width,i=new c(this.scene,e,40*this.dpr,this.key,this.dpr,!0);this.quickChatScroll.addItemAt(i,0),this.quickChatScroll.Sort(),i.setText(this.quickChatAtt[0])}},PicaChatInputPanel.prototype.onBlurHandler=function(){this.isOpenQuickPanel||this.isSendChat||this.onCancelHandler(),this.isSendChat=!1},PicaChatInputPanel.prototype.onFocusHandler=function(){},PicaChatInputPanel.prototype.onQuickSendHandler=function(){this.isOpenQuickPanel=!this.isOpenQuickPanel,this.isOpenQuickPanel?(this.quickCon.visible=!0,this.quickChatScroll.addListen()):(this.mInput.setFocus(),this.quickCon.visible=!1,this.quickChatScroll.removeListen(),this.isOpenQuickPanel=!1)},PicaChatInputPanel.prototype.onSentChat=function(){var t=this.mInput.text;""!==t&&(this.quickChatAtt[0]=t,this.setFirstQuickItem()),this.mInput.text="",this.mInput.setFocus(),this.sendChat(t)},PicaChatInputPanel.prototype.sendChat=function(t){this.emit("send",t)},PicaChatInputPanel.prototype.onQuickChatItemHandler=function(t){this.mInput.text=t.dataChat,this.mInput.setFocus(),this.quickCon.visible=!1,this.quickChatScroll.removeListen(),this.isOpenQuickPanel=!1},PicaChatInputPanel.prototype.onCancelHandler=function(){this.isDispose||(this.isDispose=!0,this.mInput.setBlur(),this.mBackground.destroy(),this.mInput.destroy(),this.bottomCon.destroy(),this.contentCon.destroy(),this.quickCon.destroy(),this.gamescroll.clearItems(!0),this.scene=void 0,this.render=void 0,this.gamescroll=void 0,this.mOutputText=void 0,this.quickChatScroll=void 0,this.emit("close"),this.destroy())},PicaChatInputPanel}(Phaser.Events.EventEmitter),c=function(t){function QuickChatItem(e,i,n,a,s,h){void 0===h&&(h=!1);var l,c=t.call(this,e)||this;(c.dataChat="",c.key=a,c.setSize(i,n),c.text=c.scene.make.text({x:0,y:0,text:"",style:{fontSize:13*s,fontFamily:o.Font.DEFULT_FONT,color:"#6F6F6F"}}).setOrigin(0,.5),c.text.x=.5*-i+20*s,c.add(c.text),h)?((l=c.scene.make.image({key:a,frame:"home_divider"})).texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.y=.5*n,c.add(l)):((l=c.scene.make.graphics(void 0)).clear(),l.fillStyle(7303023,.3),l.fillRect(.5*-i+20*s,-1,i,2),l.setPosition(0,.5*n),c.add(l));return c}return h(QuickChatItem,t),QuickChatItem.prototype.setText=function(t){this.text.text=t,this.dataChat=t},QuickChatItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaGiftPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.key=o,c.dpr=h,c.zoom=l,c.setSize(a,s),c.init(),c}return l(PicaGiftPanel,t),PicaGiftPanel.prototype.resize=function(){this.mPropGrid&&this.mPropGrid.resetMask()},PicaGiftPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaGiftPanel.prototype.hide=function(){this.visible=!1},PicaGiftPanel.prototype.show=function(){this.visible=!0},PicaGiftPanel.prototype.setGiftDatas=function(t){var e=12-t.length,i=e>0?t.concat(new Array(e)):t;this.mPropGrid.setItems(i);var n=this.mPropGrid.getCell(0);n&&n.container&&this.onSelectItemHandler(n.container)},PicaGiftPanel.prototype.setGiftActive=function(t){this.sendButton.enable=t},PicaGiftPanel.prototype.onUsePropHandler=function(t,e,i){var n={id:t.id,quantity:i,category:e.category};this.curGiftData.remain-=i,this.curGiftData.limit>0&&this.curGiftData.remain<=0&&this.mPropGrid.refresh(),this.emit("buyItem",n,t)},PicaGiftPanel.prototype.init=function(){var t=this,e=this.scene.make.graphics(void 0,!1);e.fillStyle(3355443,.5),e.fillRect(.5*-this.width,.5*-this.height,this.width,this.height),this.add(e);var i=this.scene.textures.getFrame(o.c.common2Key,"equp_bg"),n=i.width+10*this.dpr,l=i.height+10*this.dpr,c={x:0,y:.5*-this.height+60*this.dpr,table:{width:this.width-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:n,cellHeight:l,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.zoom,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.scene,a=e.item;return null===i&&(i=new p(n,0,0,t.key,t.dpr)),i.setItemData(a),a&&t.curGiftData&&t.curGiftData.id===a.id&&(i.isSelect=!0,t.curGiftItem=i),i}};this.mPropGrid=new a.GameGridTable(this.scene,c),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(e){t.onSelectItemHandler(e)})),this.add(this.mPropGrid),this.giftName=this.scene.make.text({x:.5*-this.width+10*this.dpr,y:this.mPropGrid.y+.5*this.mPropGrid.height+15*this.dpr,text:"",style:{fontSize:16*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(0,.5),this.add(this.giftName),this.giftPriceImage=new s.DynamicImage(this.scene,0,this.giftName.y),this.giftPriceImage.setTexture(o.c.commonKey,"iv_coin"),this.add(this.giftPriceImage),this.giftValue=this.scene.make.text({x:0,y:this.giftName.y,text:"",style:{fontSize:16*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFD248"}}).setOrigin(0,.5),this.add(this.giftValue),this.sendButton=new a.NineSliceButton(this.scene,0,0,95*this.dpr,36*this.dpr,o.c.commonKey,"yellow_btn_normal_s",h.i18n.t("chat.givegift"),this.dpr,this.scale,{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:10*this.dpr}),this.add(this.sendButton),this.sendButton.setTextStyle({fontSize:16*this.dpr,color:"#996600",fontFamily:h.Font.DEFULT_FONT}),this.sendButton.setFontStyle("bold"),this.sendButton.setPosition(.5*this.width-.5*this.sendButton.width-10*this.dpr,.5*this.height-.5*this.sendButton.height-10*this.dpr),this.sendButton.on(String(a.ClickEvent.Tap),this.onSendHandler,this),this.giftDescr=this.scene.make.text({x:this.giftName.x,y:this.giftName.y+.5*this.giftName.height+15*this.dpr,text:"",style:{fontSize:14*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#999999"}}).setOrigin(0,.5),this.add(this.giftDescr)},PicaGiftPanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;if(e){this.curGiftItem&&(this.curGiftItem.isSelect=!1),t.isSelect=!0,this.curGiftItem=t,this.curGiftData=e,this.giftName.text=e.name;var i=e.price[0];this.giftPriceImage.setTexture(o.c.commonKey,h.Coin.getIcon(i.coinType)),this.giftPriceImage.x=this.giftName.x+this.giftName.width+5*this.dpr+.5*this.giftPriceImage.width,this.giftValue.text=i.price+"",this.giftValue.x=this.giftPriceImage.x+.5*this.giftPriceImage.width+5*this.dpr,this.giftDescr.text=e.des}},PicaGiftPanel.prototype.onSendHandler=function(){if(this.curGiftData)if(this.curGiftData.limit>0&&this.curGiftData.remain<=0){this.emit("shownotice",h.i18n.t("party.giftsell"))}else{var t=this.getBuyPackageData(),e=h.i18n.t("chat.givegift"),i=this.curGiftData.icon,n=t.sellingPrice.price>0,a={resultHandler:{key:this.key,confirmFunc:"onUsePropHandler",confirmAddData:t},data:t,url:i,title:e,slider:n,line:!0};this.emit("showpropfun",a)}},PicaGiftPanel.prototype.getBuyPackageData=function(){var t=this.curGiftData;return{id:t.id,sellingPrice:t.price[0],name:t.name,shortName:t.shortName,category:t.category,count:t.price[0].price>0?99:1}},PicaGiftPanel}(Phaser.GameObjects.Container),p=function(t){function PicGiftItem(e,i,n,a,h){var l=t.call(this,e,i,n)||this;return l.mIsSelect=!1,l.dpr=h,l.key=a,l.bg=l.scene.make.image({key:o.c.common2Key,frame:"equp_bg"}),l.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.selectbg=l.scene.make.image({key:o.c.common2Key,frame:"selected_icon_bg"}),l.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.icon=new s.DynamicImage(e,0,0),l.add([l.bg,l.selectbg,l.icon]),l.setSize(l.selectbg.width,l.selectbg.height),l}return l(PicGiftItem,t),PicGiftItem.prototype.setItemData=function(t){var e=this;if(this.isSelect=!1,this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);this.icon.visible=!0,this.selectbg.visible=this.mIsSelect;var i=h.Url.getOsdRes(t.icon);this.icon.load(i,this,(function(){e.icon.scale=e.dpr})),t.limit>0&&t.remain<=0?this.icon.setTintFill(8947848):this.icon.clearTint()},Object.defineProperty(PicGiftItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),PicGiftItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewNavigatePanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaNewNavigatePanel(e,i,n){var a=t.call(this,e)||this;return a.dpr=n,a.key=i,a.init(),a}return h(PicaNewNavigatePanel,t),PicaNewNavigatePanel.prototype.init=function(){this.scene.make.graphics(void 0,!1);var t=this.scene.cameras.main.width;this.bg=this.scene.make.image({key:s.d.uicommon,frame:"bg"}).setOrigin(0),this.bg.displayWidth=t,this.setSize(this.bg.width,this.bg.height);var e=this.createButton("home_bag");e.x=.5*-this.width+.5*e.width+1*this.dpr,this.bagButton=e;var i=this.createButton("home_friend");i.x=e.x+.5*e.width+0*this.dpr+.5*i.width,this.friendButton=i;var n=this.createButton("home_avater");n.x=i.x+.5*i.width+0*this.dpr+.5*n.width,this.avatarButton=n;var a=this.createButton("home_shop");a.x=n.x+.5*n.width+0*this.dpr+.5*a.width,this.shopButton=a;var o=this.createButton("home_explore");o.x=a.x+.5*a.width+0*this.dpr+.5*o.width,this.exploreButton=o;var h=this.createButton("home_home");h.x=o.x+.5*o.width+0*this.dpr+.5*h.width,this.homeButton=h,this.add([this.bg,e,i,n,a,o,h]),this.addListen()},PicaNewNavigatePanel.prototype.addListen=function(){this.bagButton.on(a.ClickEvent.Tap,this.onBagHandler,this),this.friendButton.on(a.ClickEvent.Tap,this.onFriendHandler,this),this.avatarButton.on(a.ClickEvent.Tap,this.onAvatarHandler,this),this.shopButton.on(a.ClickEvent.Tap,this.onShopHandler,this),this.exploreButton.on(a.ClickEvent.Tap,this.onExploreHandler,this),this.homeButton.on(a.ClickEvent.Tap,this.onHomeHandler,this)},PicaNewNavigatePanel.prototype.removeListen=function(){this.bagButton.off(a.ClickEvent.Tap,this.onBagHandler,this),this.friendButton.off(a.ClickEvent.Tap,this.onFriendHandler,this),this.avatarButton.off(a.ClickEvent.Tap,this.onAvatarHandler,this),this.shopButton.off(a.ClickEvent.Tap,this.onShopHandler,this),this.exploreButton.off(a.ClickEvent.Tap,this.onExploreHandler,this),this.homeButton.off(a.ClickEvent.Tap,this.onHomeHandler,this)},PicaNewNavigatePanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewNavigatePanel.prototype.onBagHandler=function(){this.sendHandler&&this.sendHandler.runWith(["bag"])},PicaNewNavigatePanel.prototype.onFriendHandler=function(){this.sendHandler&&this.sendHandler.runWith(["friend"])},PicaNewNavigatePanel.prototype.onAvatarHandler=function(){this.sendHandler&&this.sendHandler.runWith(["avatar"])},PicaNewNavigatePanel.prototype.onShopHandler=function(){this.sendHandler&&this.sendHandler.runWith(["shop"])},PicaNewNavigatePanel.prototype.onExploreHandler=function(){this.sendHandler&&this.sendHandler.runWith(["explore"])},PicaNewNavigatePanel.prototype.onHomeHandler=function(){this.sendHandler&&this.sendHandler.runWith(["home"])},PicaNewNavigatePanel.prototype.createButton=function(t){this.isZh_CN&&(t+="_1");var e=new a.Button(this.scene,s.d.iconcommon,t,t);return e.y=.5*this.height,e},Object.defineProperty(PicaNewNavigatePanel.prototype,"isZh_CN",{get:function(){return"zh-CN"===o.i18n.language},enumerable:!1,configurable:!0}),PicaNewNavigatePanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractionBubbleCell",(function(){return o}));var n,a=i(479),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function InteractionBubbleCell(e,i){var n=t.call(this,e)||this;return n.mWdith=78,n.mHeight=78,n.width=n.mWdith*i,n.height=n.mHeight*i,n}return s(InteractionBubbleCell,t),InteractionBubbleCell.prototype.setContentData=function(t,e){this.content=t,this.handler&&this.handler.clear(),this.handler=e},InteractionBubbleCell.prototype.load=function(t,e,i){this.createAnimation(),this.mBubbleAni.load(t,e,i),this.mBubbleAni.play()},InteractionBubbleCell.prototype.show=function(){this.mBubbleAni&&this.add(this.mBubbleAni),this.removeDelay()},InteractionBubbleCell.prototype.hide=function(){this.mBubbleAni&&this.remove(this.mBubbleAni),this.mRemoveDelay&&(clearTimeout(this.mRemoveDelay),this.mRemoveDelay=null)},InteractionBubbleCell.prototype.destroy=function(){this.hide(),this.mBubbleAni&&this.mBubbleAni.destroy(),this.handler&&this.handler.clear(),this.mBubbleAni=null,this.handler=null,t.prototype.destroy.call(this)},InteractionBubbleCell.prototype.createAnimation=function(){this.mBubbleAni=new a.BubbleAnimation(this.scene),this.mBubbleAni.width=this.width,this.mBubbleAni.height=this.height;var t=Phaser.Input.Events.POINTER_DOWN;this.mBubbleAni.setInteractive(new Phaser.Geom.Rectangle(0,0,2*this.mBubbleAni.width,2*this.mBubbleAni.height),Phaser.Geom.Rectangle.Contains),this.mBubbleAni.on(t,this.onBubbleClick,this)},InteractionBubbleCell.prototype.onBubbleClick=function(){this.handler&&this.handler.runWith(this.content)},InteractionBubbleCell.prototype.removeDelay=function(){var t=this;this.mRemoveDelay=setTimeout((function(){t.handler&&t.handler.runWith(t.content.id),t.hide()}),this.content.duration)},InteractionBubbleCell}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractionBubbleContainer",(function(){return h}));var n,a=i(498),s=i(6),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function InteractionBubbleContainer(e,i){return t.call(this,e)||this}return o(InteractionBubbleContainer,t),Object.defineProperty(InteractionBubbleContainer.prototype,"show",{get:function(){return this.mShow},set:function(t){this.mShow=t},enumerable:!1,configurable:!0}),InteractionBubbleContainer.prototype.hide=function(){this.mShow=!1,this.parentContainer&&this.parentContainer.remove(this)},InteractionBubbleContainer.prototype.setFollow=function(e,i,n){t.prototype.setFollow.call(this,e,i,n)},InteractionBubbleContainer.prototype.setBubble=function(t,e){this.id=t.id;var i=t.display.resName,n=t.display.texturePath,s=t.display.dataPath;return this.mBubble||(this.mBubble=new a.InteractionBubbleCell(this.scene,this.dpr),this.mBubble.load(i,n,s),this.add(this.mBubble)),this.mBubble.setContentData(t,e),this.mBubble.show(),this.mBubble},InteractionBubbleContainer.prototype.destroy=function(){this.hide(),this.mBubble&&this.mBubble.destroy(),this.mBubble=null,t.prototype.destroy.call(this)},InteractionBubbleContainer}(s.BaseUI)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorChildPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=i(487),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaManorChildPanel(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,n,a,s,o,h,c)||this;return p.zoom=l,p.render=i,p}return c(PicaManorChildPanel,t),PicaManorChildPanel.prototype.setManorInfoData=function(t){this.nameTitle.text="某某某某某";var e=2;t.alreadyBuy&&(e=t.myowner?1:3),this.setLayout(e,t)},PicaManorChildPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorChildPanel.prototype.create=function(){var e=this;t.prototype.create.call(this);var i=.5*-this.height;this.headbg=this.scene.make.image({key:this.key,frame:"finca_master_head frame"}),this.headbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.headbg.y=i+.5*this.headbg.height+40*this.dpr,this.add(this.headbg),this.headIcon=new s.DynamicImage(this.scene,0,0,this.key,"finca_master_head"),this.add(this.headIcon),this.headIcon.x=this.headbg.x,this.headIcon.y=this.headbg.y;var n=this.headbg.y+.5*this.headbg.height+5*this.dpr;this.nameTitle=this.scene.make.text({x:this.headbg.x,y:n+10*this.dpr,text:"",style:{fontSize:17*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#000000"}}).setOrigin(.5),this.nameTitle.setFontStyle("bold"),this.add(this.nameTitle),this.contentbg=this.scene.make.image({key:this.key,frame:"finca_message_panel"}),this.contentbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.contentbg.y=this.nameTitle.y+.5*this.contentbg.height+30*this.dpr,this.add(this.contentbg),this.contentbg.visible=!1,this.detailText=new a.BBCodeText(this.scene,.5*-this.contentbg.width+20*this.dpr,this.contentbg.y,"",{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#813D01",align:"left",wrap:{mode:"char",width:240*this.dpr}}).setInteractive().on("areadown",(function(t){h.Logger.getInstance().debug(t)})).on("areaup",(function(t){new s.InputView(e.scene,e.render).show({title:h.i18n.t("manor.eidtnickname"),placeholder:h.i18n.t("manor.nicknameplaceholder"),handler:new h.Handler(e,(function(t){e.sendHandler&&e.sendHandler.runWith([3,t])}))})})),this.detailText.setOrigin(0,.5),this.add(this.detailText),this.detailText.visible=!1,this.detailText.addImage("finca_compile",{key:this.key,frame:"finca_compile",y:3*this.dpr,left:10*this.dpr,right:10*this.dpr}),this.detailText.addImage("iv_coin",{key:o.c.commonKey,frame:"iv_coin",y:-1*this.dpr,left:2*this.dpr,right:5*this.dpr}),this.detailText.addImage("iv_diamond",{key:o.c.commonKey,frame:"iv_diamond",y:-1*this.dpr,left:2*this.dpr,right:5*this.dpr}),this.editorButton=this.createNineButton(130*this.dpr,45*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("manor.editorbtn"),"#ffffff"),this.editorButton.x=.5*-this.editorButton.width-10*this.dpr,this.editorButton.y=.5*this.height-.5*this.editorButton.height-10*this.dpr,this.editorButton.on(String(a.ClickEvent.Tap),this.onEditorButtonHandler,this),this.add(this.editorButton),this.editorButton.visible=!1,this.shopButton=this.createNineButton(130*this.dpr,45*this.dpr,o.c.commonKey,"yellow_btn_normal",h.i18n.t("common.shop"),"#996600"),this.shopButton.x=.5*this.shopButton.width+10*this.dpr,this.shopButton.y=.5*this.height-.5*this.shopButton.height-10*this.dpr,this.shopButton.on(String(a.ClickEvent.Tap),this.onShopButtonHandler,this),this.add(this.shopButton),this.shopButton.visible=!1,this.buyButton=this.createNineButton(181*this.dpr,45*this.dpr,o.c.commonKey,"yellow_btn_normal",h.i18n.t("common.buy"),"#996600"),this.buyButton.y=.5*this.height-.5*this.buyButton.height-10*this.dpr,this.buyButton.on(String(a.ClickEvent.Tap),this.onBuyButtonHandler,this),this.add(this.buyButton),this.buyButton.visible=!1},PicaManorChildPanel.prototype.setLayout=function(t,e){3===t?(this.nameTitle.text=e.ownerName,this.nameTitle.visible=!0,this.detailText.setLineSpacing(20*this.dpr),this.headbg.visible=!0,this.headbg.y=.5*-this.height+80*this.dpr,this.headIcon.y=this.headbg.y,this.nameTitle.y=this.headbg.y+.5*this.headbg.height+16*this.dpr,this.contentbg.y=.5*this.contentbg.height+this.nameTitle.y+.5*this.nameTitle.height+10*this.dpr,this.detailText.y=this.contentbg.y):2===t?(this.nameTitle.text=h.i18n.t("manor.noowner"),this.nameTitle.visible=!0,this.detailText.setLineSpacing(9*this.dpr),this.headbg.visible=!1,this.headIcon.setTexture(this.key,"finca_dereliction_head"),this.headIcon.y=.5*-this.height+68*this.dpr,this.nameTitle.y=this.headIcon.y+.5*this.headIcon.height+16*this.dpr,this.contentbg.y=.5*this.contentbg.height+this.nameTitle.y+.5*this.nameTitle.height+10*this.dpr,this.detailText.y=this.contentbg.y,this.buyButton.y=.5*this.height-.5*this.buyButton.height-22*this.dpr):(this.nameTitle.visible=!1,this.headbg.visible=!0,this.headIcon.setTexture(this.key,"finca_master_head"),this.headIcon.y=this.headbg.y,this.contentbg.y=.5*this.contentbg.height+this.headbg.y+.5*this.headbg.height+10*this.dpr,this.detailText.y=this.contentbg.y,this.detailText.setLineSpacing(14*this.dpr),this.editorButton.y=.5*this.height-.5*this.editorButton.height-22*this.dpr,this.shopButton.y=this.editorButton.y),this.contentbg.visible=!0,this.detailText.visible=!0,this.setButtonActive(t);var i=this.getDetailText(t,e);this.detailText.setText(i)},PicaManorChildPanel.prototype.setButtonActive=function(t){1===t?(this.editorButton.setInteractive(),this.shopButton.setInteractive(),this.buyButton.disInteractive(),this.editorButton.visible=!0,this.shopButton.visible=!0,this.buyButton.visible=!1):2===t?(this.editorButton.disInteractive(),this.shopButton.disInteractive(),this.buyButton.setInteractive(),this.editorButton.visible=!1,this.shopButton.visible=!1,this.buyButton.visible=!0):(this.editorButton.disInteractive(),this.shopButton.disInteractive(),this.buyButton.disInteractive(),this.editorButton.visible=!1,this.shopButton.visible=!1,this.buyButton.visible=!1)},PicaManorChildPanel.prototype.getDetailText=function(t,e){var i="";if(3===t)i=""+h.i18n.t("manor.manorname")+e.manorName+"\n"+h.i18n.t("manor.manorarea")+e.streetName;else if(2===t){var n=e.price.price;i=""+h.i18n.t("manor.manorarea")+e.streetName+"\n"+h.i18n.t("manor.manorstatus")+"[color=#FF0000]"+h.i18n.t("manor.selling")+"[/color]\n"+h.i18n.t("manor.manorprice")+"[img=iv_coin]"+n+"\n"+h.i18n.t("manor.needlevel")+"20级"}else i=""+h.i18n.t("manor.manorname")+e.manorName+"[area=aaaa][img=finca_compile][/area]\n"+h.i18n.t("manor.manorowner")+e.ownerName+"\n"+h.i18n.t("manor.manorarea")+e.streetName;return i},PicaManorChildPanel.prototype.createNineButton=function(t,e,i,n,s,o){var l=new a.NineSliceButton(this.scene,0,0,t,e,i,n,s,this.dpr,this.zoom,h.UIHelper.button(this.dpr));return this.add(l),l.setTextStyle({fontSize:21*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:o}),l.setFontStyle("bold"),l},PicaManorChildPanel.prototype.onEditorButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([2])},PicaManorChildPanel.prototype.onShopButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([-1])},PicaManorChildPanel.prototype.onBuyButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith([1])},PicaManorChildPanel}(l.PicaManorBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorShopPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=i(488),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaManorShopPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.setSize(a,s),c.dpr=h,c.key=o,c.zoom=l,c.create(),c}return c(PicaManorShopPanel,t),PicaManorShopPanel.prototype.refreshMask=function(){this.shopgride.resetMask()},PicaManorShopPanel.prototype.create=function(){var t=this.width,e=this.height,i=.5*-e;this.bg=new a.NineSlicePatch(this.scene,0,0,t,e,o.c.common3Key,"bg",h.UIHelper.background_w(this.dpr)),this.add(this.bg),this.closeBtn=new a.Button(this.scene,o.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.titlebg=this.scene.make.image({key:this.key,frame:"tag_single"}),this.add(this.titlebg),this.titlebg.x=.5*-this.width+.5*this.titlebg.width+0*this.dpr,this.titlebg.y=.5*-this.height-.5*this.titlebg.height+14*this.dpr,this.imgtitle=new s.ImageValue(this.scene,135*this.dpr,16*this.dpr,this.key,"house_shop",this.dpr),this.imgtitle.setText(h.i18n.t("manor.manorshop")),this.imgtitle.setFontStyle("bold"),this.imgtitle.setTextStyle({fontSize:15*this.dpr}),this.imgtitle.x=this.titlebg.x-30*this.dpr,this.imgtitle.y=this.titlebg.y,this.add(this.imgtitle),this.secondMenu=new l.SecondaryMenuPanel(this.scene,0,.5*-this.height+46*this.dpr,302*this.dpr,29*this.dpr,this.dpr,this.zoom,{x:0,y:-14*this.dpr,width:this.width-32*this.dpr,height:30*this.dpr,zoom:this.zoom,dpr:this.dpr,space:6*this.dpr,orientation:1,align:2}),this.secondMenu.setHandler(new h.Handler(this,this.onTabButtonHandler)),this.secondMenu.setButtonChangeHandler(new h.Handler(this,(function(t){t.changeNormal(),t.setTextColor("#FE8737")})),new h.Handler(this,(function(t){t.changeDown(),t.setTextColor("#ffffff")}))),this.add(this.secondMenu);var n=302*this.dpr,c=324*this.dpr,p=.5*-n,d=.5*-c-20*this.dpr,u=this.scene.make.graphics(void 0,!1);u.fillStyle(16680759,1),u.fillRoundedRect(p,d,n,c,{tl:0,tr:5*this.dpr,bl:5*this.dpr,br:5*this.dpr}),this.add(u);var m=n-16*this.dpr,f=380*this.dpr,y=12*this.dpr;this.shopgride=this.createGrideTable(0,y,m,f,126*this.dpr,158*this.dpr),this.corfirmButton=this.createNineButton(o.c.commonKey,"yellow_btn_normal",h.i18n.t("common.confirm"),"#996600"),this.corfirmButton.y=.5*this.height-.5*this.corfirmButton.height-15*this.dpr,this.corfirmButton.on(String(a.ClickEvent.Tap),this.onConfirmButtonHandler,this)},PicaManorShopPanel.prototype.setShopCategories=function(t){for(var e=[],i=0,n=t.marketCategory;i<n.length;i++){var s=n[i],o={text:s.category.value,data:s};e.push(o)}this.secondMenu.setCategories(a.TabButton,e,{width:97*this.dpr,height:29*this.dpr,key:this.key,normalFrame:"manor_store_uncheck",downFrame:"manor_store_check",textStyle:{fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FE8737"},bold:!0})},PicaManorShopPanel.prototype.setShopDatas=function(t){if(t.commodities){var e=t.commodities.sort((function(t,e){var i=t.id.replace(/[^0-9]/gi,""),n=e.id.replace(/[^0-9]/gi,"");return Number(i)>Number(n)?1:-1}));this.shopgride.setItems(e)}},PicaManorShopPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorShopPanel.prototype.setHandler=function(t,e){this.sendHandler=t,this.closeHandler=e},PicaManorShopPanel.prototype.createNineButton=function(t,e,i,n){var s=new a.NineSliceButton(this.scene,0,0,182*this.dpr,47*this.dpr,t,e,i,this.dpr,this.zoom,{left:14*this.dpr,top:14*this.dpr,right:14*this.dpr,bottom:14*this.dpr});return this.add(s),s.setTextStyle({fontSize:21*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:n}),s.setFontStyle("bold"),s},PicaManorShopPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:2,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:0*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&((e=new d(h.scene,0,0,s,o,h.key,h.dpr)).on("buyitem",h.onBuyItemHandler,h),c.add(e)),e.setItemData(i),h.selectedItemData&&h.selectedItemData.id===i.id&&(h.selectedItemData=i,h.selectedItem=e),e}},c=new a.GameGridTable(this.scene,l);return c.layout(),c.on("cellTap",(function(t){t&&h.onSelectItemHandler(t)})),this.add(c),c},PicaManorShopPanel.prototype.onTabButtonHandler=function(t){this.emit("queryProp",1,t.category.key)},PicaManorShopPanel.prototype.onConfirmButtonHandler=function(){this.selectedItemData&&1===this.selectedItemData.manorState&&this.sendHandler&&this.sendHandler.runWith(["usetype",this.selectedItemData.id])},PicaManorShopPanel.prototype.onBuyItemHandler=function(t){var e={id:t.id,quantity:1,category:t.category};this.sendHandler&&this.sendHandler.runWith(["buytype",e])},PicaManorShopPanel.prototype.onSelectItemHandler=function(t){t.select=!0,this.selectedItem&&(this.selectedItem.select=!1),this.selectedItem=t,this.selectedItemData=t.shopData,this.selectedItem.select||(this.selectedItem=void 0,this.selectedItemData=void 0)},PicaManorShopPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorShopPanel}(Phaser.GameObjects.Container),d=function(t){function ManorShopItem(e,i,n,l,c,p,d){var u=t.call(this,e,i,n)||this;u.mselect=!1,u.dpr=d,u.key=p,u.setSize(l,c),u.bg=u.scene.make.image({key:p,frame:"manor_store_icon_bg"}),u.add(u.bg),u.nameText=u.scene.make.text({x:0,y:.5*-u.height+15*u.dpr,text:" ",style:{color:"#2B2B2B",fontSize:13*u.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),u.add(u.nameText),u.icon=new s.DynamicImage(e,0,-20*d,u.key,"floor_01"),u.add(u.icon);var m=u.scene.make.image({key:u.key,frame:"manor_store_price_bg"});return u.imgprice=new s.ImageValue(u.scene,90*d,17*d,o.c.commonKey,"iv_coin",u.dpr),u.imgprice.setLayout(2),u.imgprice.setTextStyle({color:"#000000"}),u.imgprice.addAt(m,0),u.add(u.imgprice),u.tipsText=u.scene.make.text({x:0,y:.5*u.height-20*u.dpr,text:h.i18n.t("manor.owned"),style:{color:"#E33922",fontSize:13*u.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),u.tipsText.setFontStyle("bold"),u.add(u.tipsText),u.button=new s.ThreeSliceButton(e,73*d,26*d,o.c.common3Key,h.UIHelper.threeRedNormal,h.UIHelper.threeRedNormal,h.i18n.t("manor.using")),u.button.setTextStyle(h.UIHelper.brownishStyle(d)),u.button.y=u.tipsText.y,u.button.on(a.ClickEvent.Tap,u.onButtonHandler,u),u.add(u.button),u.imgprice.y=u.button.y-.5*u.button.height-.5*u.imgprice.height-2*d,u}return c(ManorShopItem,t),ManorShopItem.prototype.setItemData=function(t){var e=this;this.shopData=t,this.setButtonState(t),this.nameText.text=t.name||t.shortName;var i=h.Url.getOsdRes(t.icon);this.icon.load(i,this,(function(){e.icon.scale=e.dpr}))},Object.defineProperty(ManorShopItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.mselect=t,this.bg.setFrame(t?"store_icon_check":"manor_store_icon_bg")},enumerable:!1,configurable:!0}),ManorShopItem.prototype.setButtonState=function(t){if(2===t.manorState)this.button.visible=!0,this.button.disInteractive(),this.button.setFrameNormal(h.UIHelper.threeGreenNormal,h.UIHelper.threeGreenNormal),this.button.setText(h.i18n.t("manor.using")),this.button.setTextColor(h.Color.black),this.tipsText.visible=!1,this.imgprice.visible=!1;else if(3===t.manorState){this.button.visible=!0,this.button.setInteractive(),this.button.setFrameNormal(h.UIHelper.threeYellowNormal,h.UIHelper.threeYellowNormal),this.button.setText(h.i18n.t("common.buy")),this.button.setTextColor(h.Color.brownish),this.tipsText.visible=!1,this.imgprice.visible=!0;var e=t.price[0];this.imgprice.setFrameValue(e.price+"",o.c.commonKey,h.Coin.getIcon(e.coinType))}else 1===t.manorState&&(this.button.visible=!1,this.button.disInteractive(),this.tipsText.visible=!0,this.imgprice.visible=!1)},ManorShopItem.prototype.onButtonHandler=function(){this.emit("buyitem",this.shopData)},ManorShopItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessChoosePlanPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessChoosePlanPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=l,c.zoom=h,c.setSize(a,s),c.create(),c}return l(PicaBusinessChoosePlanPanel,t),PicaBusinessChoosePlanPanel.prototype.setPlanData=function(t){this.gridtable.setItems(t);var e=this.gridtable.getCells();if(e){var i=e[0];i&&i.container&&this.onGridSelectHandler(i.container)}},PicaBusinessChoosePlanPanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.selectHandler=e},PicaBusinessChoosePlanPanel.prototype.resetMask=function(){this.gridtable.resetMask(),this.gameScroll.refreshMask()},PicaBusinessChoosePlanPanel.prototype.create=function(){var t=this,e=(this.height,this.width-29*this.dpr),i=100*this.dpr,n=.5*-this.height+.5*i+10*this.dpr;this.gridtable=this.createGrideTable(0,n,e,i,90*this.dpr,100*this.dpr),this.describleText=this.scene.make.text({x:.5*-this.width+20*this.dpr,y:n+.5*i+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.describleText.setWordWrapWidth(this.width-45*this.dpr,!0),this.add(this.describleText),this.effectText=this.scene.make.text({x:this.describleText.x,y:this.describleText.y+this.describleText.height+20*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(0),this.add(this.effectText),this.materialTitle=this.scene.make.text({x:this.describleText.x,y:this.effectText.y+this.effectText.height+5*this.dpr,text:h.i18n.t("business_street.material_requirements"),style:{fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.add(this.materialTitle),this.gameScroll=new a.GameScroller(this.scene,{x:0,y:this.materialTitle.y+this.materialTitle.height+22*this.dpr,width:this.width-40*this.dpr,height:60*this.dpr,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:10*this.dpr,cellupCallBack:function(e){t.onMaterialItemHandler(e)}}),this.add(this.gameScroll);var l=new a.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(l),l.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),l.on(String(a.ClickEvent.Tap),this.onCancelHandler,this);var c=new a.NineSliceButton(this.scene,60*this.dpr,l.y,92*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn",h.i18n.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.on(String(a.ClickEvent.Tap),this.onSelectHandler,this),c.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#996600"}),this.iteminfoTips=new s.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.c.common2Key,"tips_bg",this.dpr),this.iteminfoTips.setVisible(!1),this.add(this.iteminfoTips)},PicaBusinessChoosePlanPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(h.scene,0,0,s,o,h.key,h.dpr,h.zoom)),e.setData({item:i}),e.setPlanData(i),h.curSelectData&&i===h.curSelectData?e.select=!0:e.select=!1,e}},c=new a.GameGridTable(this.scene,l);return c.layout(),c.on("cellTap",(function(t){t&&h.onGridSelectHandler(t)})),this.add(c),c},PicaBusinessChoosePlanPanel.prototype.onGridSelectHandler=function(t){this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0;var e=t.palnData;this.gameScroll.clearItems();for(var i=0,n=e.requirements;i<n.length;i++){var a=n[i],s=new d(this.scene,0,0,36*this.dpr,36*this.dpr,this.key,this.dpr,this.zoom);s.setItemData(a),this.gameScroll.addItem(s)}this.gameScroll.Sort(),this.describleText.text=e.des,this.effectText.text=h.i18n.t("business_street.effect")+":"+e.buffDes,this.curSelectItem=t,this.curSelectData=e},PicaBusinessChoosePlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessChoosePlanPanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData.id),this.onCancelHandler()},PicaBusinessChoosePlanPanel.prototype.onMaterialItemHandler=function(t){if(this.iteminfoTips.setVisible(!this.iteminfoTips.visible),this.iteminfoTips&&this.iteminfoTips.visible){var e=t.itemData;this.iteminfoTips.setItemData(e),this.iteminfoTips.setTipsPosition(t,this,10*this.dpr)}},PicaBusinessChoosePlanPanel}(Phaser.GameObjects.Container),p=function(t){function PlanTypeItem(e,i,n,a,o,l,c,p){var d=t.call(this,e,i,n)||this;return d.isSelect=!1,d.dpr=c,d.key=l,d.setSize(a,o),d.bg=d.scene.make.image({key:l,frame:"store_bg"}),d.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.add(d.bg),d.storeIcon=new s.DynamicImage(d.scene,0,0),d.storeIcon.setTexture(d.key,"restaurant_icon"),d.storeIcon.setPosition(0,-8*c),d.add(d.storeIcon),d.storeName=d.scene.make.text({x:0,y:d.storeIcon.y+.5*d.storeIcon.height+10*c,text:"Restaurant",style:{color:"#0",fontSize:10*c,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),d.add(d.storeName),d}return l(PlanTypeItem,t),PlanTypeItem.prototype.setPlanData=function(t){var e=this;this.palnData=t;var i=t.icon;""===i&&t.requirements&&t.requirements.length>0&&(i=t.requirements[0].display.texturePath);var n=h.Url.getOsdRes(i);this.storeIcon.load(n,this,(function(){e.storeIcon.displayWidth=46*e.dpr,e.storeIcon.scaleY=e.storeIcon.scaleX})),this.storeName.text=t.name},Object.defineProperty(PlanTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var e=t?"store_bg_click":"store_bg";this.bg.setFrame(e)},enumerable:!1,configurable:!0}),PlanTypeItem}(Phaser.GameObjects.Container),d=function(t){function MaterialItem(e,i,n,o,l,c,p,d){var u=t.call(this,e,i,n)||this;u.dpr=p,u.key=c,u.setSize(o,l);var m=u.scene.make.image({key:u.key,frame:"item_bg"});return m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.add(m),u.itemIcon=new s.DynamicImage(u.scene,0,0),u.add(u.itemIcon),u.countText=new a.BBCodeText(u.scene,.5*m.width,.5*m.height).setOrigin(1,.5).setFontSize(12*p).setFontFamily(h.Font.DEFULT_FONT),u.add(u.countText),u}return l(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var e=this;this.itemData=t;var i=h.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.displayWidth=29*e.dpr,e.itemIcon.scaleY=e.itemIcon.scaleX})),this.countText.text=this.getCountText(t.count,t.neededCount)},MaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#0054FF":"#FF2B2B";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]"+("[stroke=#2D2D2D][color=#2D2D2D]/"+e+"[/color][/stroke]")},MaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessPlanPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessPlanPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=l,c.zoom=h,c.setSize(a,s),c.create(),c}return l(PicaBusinessPlanPanel,t),PicaBusinessPlanPanel.prototype.setRender=function(t){this.render=t},PicaBusinessPlanPanel.prototype.setPlanData=function(t){var e=t.marketPlanPairs,i=""!==t.industryBackground?t.industryBackground:"market_b";this.topbg.setFrame(i),this.describleText.text=t.industryDes,this.planBuffText.text=t.industryBuffDes,this.gridtable.setItems(e)},PicaBusinessPlanPanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.addPlanHandler=e},PicaBusinessPlanPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessPlanPanel.prototype.create=function(){var t=.5*-this.height,e=253*this.dpr,i=73*this.dpr;this.topbg=new a.NineSlicePatch(this.scene,0,0,e,i,this.key,"market_b",{left:6*this.dpr,top:0*this.dpr,right:6*this.dpr,bottom:0*this.dpr}),this.topbg.y=t+.5*i+10*this.dpr,this.add(this.topbg),this.describleText=this.scene.make.text({x:0,y:this.topbg.y-15*this.dpr,text:"Your store is now at a advantage",style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}}).setOrigin(.5),this.describleText.setWordWrapWidth(200*this.dpr),this.add(this.describleText),this.planBuffText=new a.BBCodeText(this.scene,0,this.topbg.y+15*this.dpr,"Store prosperity -10%",{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}).setOrigin(.5),this.add(this.planBuffText),this.planBuffText.setWrapWidth(200*this.dpr);var n=new a.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});n.x=0,n.y=this.topbg.y+.5*this.topbg.height+40*this.dpr,this.add(n);var s=this.scene.make.text({x:0,y:n.y,text:h.i18n.t("business_street.marketing_plan"),style:{fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(s),n.resize(135*this.dpr,17*this.dpr);var l=this.width-24*this.dpr,c=this.height-200*this.dpr,p=n.y+.5*n.height+20*this.dpr+.5*c;this.gridtable=this.createGrideTable(0,p,l,c,253*this.dpr,63*this.dpr);var d=new a.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(d),d.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),d.on(String(a.ClickEvent.Tap),this.onCancelHandler,this)},PicaBusinessPlanPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var l=this,c={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom,cellPadX:8*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(l.scene,0,0,s,o,l.key,l.dpr,l.zoom)).setHandler(new h.Handler(l,l.onAddPlanHandler)),e.setData({item:i}),l.render.mainPeer.requestCurTime().then((function(t){e.setPlanData(i,t)})),e}},d=new a.GameGridTable(this.scene,c);return d.layout(),d.on("cellTap",(function(t){t&&l.onGridSelectHandler(t)})),this.add(d),d},PicaBusinessPlanPanel.prototype.onGridSelectHandler=function(t){},PicaBusinessPlanPanel.prototype.onAddPlanHandler=function(t){this.addPlanHandler&&this.addPlanHandler.runWith(t.marketPlanType)},PicaBusinessPlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessPlanPanel}(Phaser.GameObjects.Container),p=function(t){function MarketingPlanItem(e,i,n,o,l,c,p,d){var u=t.call(this,e,i,n)||this;u.dpr=p,u.key=c,u.setSize(o,l),u.bg=new a.NineSlicePatch(u.scene,0,0,o,53*p,u.key,"no_plan_bg",{left:6*u.dpr,top:0*u.dpr,right:6*u.dpr,bottom:0*u.dpr}),u.add(u.bg);var m=u.scene.make.image({key:u.key,frame:"plan_icon_bg"});m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.x=.5*-u.width+.5*m.width+5*p,u.add(m),u.planIcon=new s.DynamicImage(u.scene,0,0),u.planIcon.setPosition(m.x,0),u.add(u.planIcon),u.planText=u.scene.make.text({x:m.x+.5*m.width+10*p,y:0,style:{color:"#0",fontSize:10*p,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),u.planText.text=h.i18n.t("business_street.plan_title"),u.add(u.planText),u.planName=u.scene.make.text({x:m.x+.5*m.width+10*p,y:.5*-u.bg.height+4*p,text:"Plane Name",style:{color:"#ffffff",fontSize:12*p,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),u.add(u.planName),u.planAtt=new a.BBCodeText(u.scene,u.planName.x,u.planName.y+u.planName.height+4*p,"Competitiveness +10%,  Prosperity +10%",{color:"#0",fontSize:10*u.dpr,fontFamily:h.Font.DEFULT_FONT}).setOrigin(0),u.add(u.planAtt);var f=159*p,y=8*p,g={x:0,y:0,color:"#ffffff",fontSize:9*p,fontFamily:h.Font.DEFULT_FONT,halign:.5,valign:.5};return u.progress=new a.ProgressBar(u.scene,{x:5*p,y:u.planAtt.y+u.planAtt.height+4*p+.5*y,width:f,height:y,background:{x:0,y:0,width:f,height:y,config:{top:1*p,left:5*p,right:5*p,bottom:1*p},key:c,frame:"progress_bar_bg"},bar:{x:0,y:0,width:f,height:y-p,config:{top:1*p,left:5*p,right:5*p,bottom:1*p},key:c,frame:"progress_bar_g"},dpr:p,textConfig:g}),u.progress.text.setOrigin(.5),u.add(u.progress),u.addBtn=new a.Button(u.scene,u.key,"add_plan","add_plan"),u.addBtn.x=.5*u.width-.5*u.addBtn.width-20*p,u.addBtn.on(String(a.ClickEvent.Tap),u.onAddBtnHandler,u),u.add(u.addBtn),u}return l(MarketingPlanItem,t),MarketingPlanItem.prototype.setPlanData=function(t,e){var i=this;if(t.marketPlan){this.planName.visible=!0,this.planAtt.visible=!0,this.progress.visible=!0,this.planText.visible=!1,this.bg.setFrame("has_plan_bg"),this.remove(this.addBtn);var n="progress_bar_r",a=Math.floor(t.marketPlan.endTime-e/1e3),s=Math.floor(a/t.marketPlan.totalTime*100);s>30&&s<=50?n="progress_bar_y":s>50&&(n="progress_bar_g"),this.progress.bar.setFrame(n),this.progress.setProgress(a,t.marketPlan.totalTime),this.progress.setText(this.getDataFormat(1e3*a)),this.planName.text=t.marketPlan.name,this.planAtt.text=t.marketPlan.buffDes;var o=""!==t.marketPlan.icon?t.marketPlan.icon:t.marketPlan.requirements[0].texturePath;(""===o||!o)&&t.marketPlan.requirements&&t.marketPlan.requirements.length>0&&(o=t.marketPlan.requirements[0].texturePath);var l=h.Url.getOsdRes(o);this.planIcon.load(l,this,(function(){i.planIcon.displayWidth=30*i.dpr,i.planIcon.scaleY=i.planIcon.scaleX}))}else this.planName.visible=!1,this.planAtt.visible=!1,this.progress.visible=!1,this.add(this.addBtn),this.bg.setFrame("no_plan_bg");this.planData=t},MarketingPlanItem.prototype.setHandler=function(t){this.addBtnHandler=t},MarketingPlanItem.prototype.onAddBtnHandler=function(){this.addBtnHandler&&this.addBtnHandler.runWith(this.planData)},MarketingPlanItem.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,s="";return e>0?(s=e+"  "+h.i18n.t("timeuint.day"),(i>0||n>0)&&(s+=this.stringFormat(i)+":"+this.stringFormat(n))):s=i>0?n>0?this.stringFormat(i)+":"+this.stringFormat(n):this.stringFormat(i)+" "+h.i18n.t("timeuint.hour"):n>0?this.stringFormat(n)+" "+h.i18n.t("timeuint.minute"):this.stringFormat(a)+" "+h.i18n.t("timeuint.second"),s},MarketingPlanItem.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},MarketingPlanItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessHistoryPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessHistoryPanel(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.dpr=o,p.key=l,p.key2=c,p.zoom=h,p.setSize(a,s),p.create(),p}return l(PicaBusinessHistoryPanel,t),PicaBusinessHistoryPanel.prototype.setHistoryeData=function(t){this.gridtable.setItems(t),this.titleText.text=h.i18n.t("business_street.history_title",{name:t.length})},PicaBusinessHistoryPanel.prototype.setHandler=function(t){this.backHandler=t},PicaBusinessHistoryPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessHistoryPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.text({x:e+30*this.dpr,y:t+6*this.dpr,text:h.i18n.t("business_street.history_title"),style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);i.setStroke("#553100",2*this.dpr),this.add(i),this.titleText=i;var n=this.width,s=this.height-80*this.dpr,l=t+33*this.dpr+.5*s;this.gridtable=this.createGrideTable(0,l,n,s,256*this.dpr,50*this.dpr);var c=new a.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),c.on(String(a.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessHistoryPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(h.scene,0,0,s,o,h.key,h.key2,h.dpr,h.zoom),c.add(e)),e.setData({item:i}),e.setStoreData(i),e}},c=new a.GameGridTable(this.scene,l);return c.layout(),this.add(c),c},PicaBusinessHistoryPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessHistoryPanel}(Phaser.GameObjects.Container),p=function(t){function PicHistoryItem(e,i,n,o,l,c,p,d,u){var m=t.call(this,e,i,n)||this;m.dpr=d,m.key=c,m.key2=p,m.setSize(o,l);var f=.5*-m.width,y=.5*-m.height;m.bg=new a.NineSlicePatch(m.scene,0,0,o,45*d,m.key,"resturant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var g=m.scene.make.image({key:p,frame:"icon_bg_s"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.setPosition(f+.5*g.width+3*d,0),m.add(g),m.storeIcon=new s.DynamicImage(m.scene,g.x,0),m.add(m.storeIcon);var P=g.x+.5*g.width+10*d;return m.storeName=m.scene.make.text({x:P,y:y+10*d,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:P,y:m.storeName.y+.5*m.storeName.height+10*d,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"entertainment_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m}return l(PicHistoryItem,t),PicHistoryItem.prototype.setStoreData=function(t){this.storeData=t,this.bg.setTexture(this.key2,t.industry+"_bg"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.industryIcon.setFrame(t.industry+"_tag_s")},PicHistoryItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessMyStreetPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessMyStreetPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.isCanNewCreate=!1,c.dpr=o,c.key=l,c.zoom=h,c.setSize(a,s),c.create(),c}return l(PicaBusinessMyStreetPanel,t),PicaBusinessMyStreetPanel.prototype.setMyStoreData=function(t){var e=t.storeList;this.storelimitText.text=h.i18n.t("business_street.store_limit")+":"+e.length+"/"+t.storeLimit,this.gridtable.setItems(e),this.isCanNewCreate=e.length<t.storeLimit},PicaBusinessMyStreetPanel.prototype.setHandler=function(t,e,i,n){this.takeAllHandler=t,this.goOutHandler=e,this.newStoreHandler=i,this.enterRoomHandler=n},PicaBusinessMyStreetPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessMyStreetPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.image({key:this.key,frame:"store_icon"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i.x=e+30*this.dpr,i.y=t+6*this.dpr,this.add(i);var n=i.x+.5*i.width+10*this.dpr,s=this.scene.make.text({x:n,y:i.y,text:h.i18n.t("business_street.my_store"),style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);s.setStroke("#553100",2*this.dpr),this.add(s);var l=this.width,c=this.height-68*this.dpr,p=t+28*this.dpr+.5*c;this.gridtable=this.createGrideTable(0,p,l,c,256*this.dpr,87*this.dpr),this.newStoreBtn=new a.Button(this.scene,this.key,"new_store","new_store");var d=-e-.5*this.newStoreBtn.width-20*this.dpr;this.newStoreBtn.setPosition(d,t+6*this.dpr),this.newStoreBtn.on(String(a.ClickEvent.Tap),this.onNewStoreHandler,this),this.add(this.newStoreBtn),this.storelimitText=this.scene.make.text({x:d-.5*this.newStoreBtn.width-10*this.dpr,y:t+5*this.dpr,text:"store limit",style:{color:"#0",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(1,.5),this.add(this.storelimitText),this.storeCountText=this.scene.make.text({x:d+.5*this.newStoreBtn.width+20*this.dpr,y:t,text:"",style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(1,0),this.add(this.storeCountText);var u=new a.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("business_street.takeall"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(u),u.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),u.on(String(a.ClickEvent.Tap),this.onTalkAllHandler,this);var m=new a.NineSliceButton(this.scene,60*this.dpr,u.y,92*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn",h.i18n.t("business_street.goout"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(m),m.on(String(a.ClickEvent.Tap),this.onGoOutHandler,this),m.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#996600"})},PicaBusinessMyStreetPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var l=this,c={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&((e=new p(l.scene,0,0,s,o,l.key,l.dpr,l.zoom)).setHandler(new h.Handler(l,l.onEnterHandler)),d.add(e)),e.setData({item:i}),e.setStoreData(i),e}},d=new a.GameGridTable(this.scene,c);return d.layout(),this.add(d),d},PicaBusinessMyStreetPanel.prototype.onEnterHandler=function(t){this.enterRoomHandler&&this.enterRoomHandler.runWith(t.roomId)},PicaBusinessMyStreetPanel.prototype.onTalkAllHandler=function(){this.takeAllHandler&&this.takeAllHandler.run()},PicaBusinessMyStreetPanel.prototype.onGoOutHandler=function(){this.goOutHandler&&this.goOutHandler.run()},PicaBusinessMyStreetPanel.prototype.onNewStoreHandler=function(){this.isCanNewCreate&&this.newStoreHandler&&this.newStoreHandler.run()},PicaBusinessMyStreetPanel}(Phaser.GameObjects.Container),p=function(t){function MyStoreItem(e,i,n,l,c,p,d,u){var m=t.call(this,e,i,n)||this;m.dpr=d,m.key=p,m.setSize(l,c);var f=.5*-m.width,y=.5*-m.height;m.bg=new a.NineSlicePatch(m.scene,0,0,l,80*d,m.key,"resturant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var g=m.scene.make.image({key:p,frame:"store_icon_bg"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.setPosition(f+.5*g.width+10*d,0),m.add(g),m.storeIcon=new s.DynamicImage(m.scene,g.x,0),m.add(m.storeIcon);var P=g.x+.5*g.width+10*d;m.storeName=m.scene.make.text({x:P,y:y+5*d,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.lvimgCon=m.scene.make.container(void 0,!1),m.lvimgCon.height=14*d,m.lvimgCon.setPosition(P+6*d,m.storeName.y+m.storeName.height+.5*m.lvimgCon.height+2*d),m.add(m.lvimgCon),m.savings=m.scene.make.text({x:P,y:m.lvimgCon.y+.5*m.lvimgCon.height+2*d,text:"Savings: 13000",style:{color:"#ffffff",fontSize:10*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.savings),m.competitiveness=m.scene.make.text({x:P,y:m.savings.y+m.savings.height+2*d,text:"Competitiveness: 13000",style:{color:"#ffffff",fontSize:10*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.competitiveness),m.turnover=m.scene.make.text({x:P,y:m.competitiveness.y+m.competitiveness.height+2*d,text:"Prosperity: +13000 / Day",style:{color:"#ffffff",fontSize:10*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.turnover),m.industryIcon=m.scene.make.image({key:m.key,frame:"entertainment_tag"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon);var _=new a.NineSliceButton(e,-f,0,48*d,27*d,o.c.commonKey,"yellow_btn_normal_s",h.i18n.t("business_street.enter"),m.dpr,u,{left:10*m.dpr,top:10*m.dpr,right:10*m.dpr,bottom:10*m.dpr});return _.setTextStyle({fontSize:10*d,fontFamily:h.Font.DEFULT_FONT,color:"#996600"}),_.x=-f-.5*_.width-10*d,_.on(String(a.ClickEvent.Tap),m.onEnterHandler,m),m.add(_),m}return l(MyStoreItem,t),MyStoreItem.prototype.setStoreData=function(t){var e=t.industry,i=t.storeType;this.bg.setFrame(e+"_bg"),this.storeIcon.setTexture(this.key,i+"_icon"),this.storeName.text=t.name,this.lvimgCon.removeAll(!0),this.setImageInfo(o.c.common2Key,this.getLevelImgs(t.roomLevel.level)),this.savings.text=h.i18n.t("business_street.savings")+":"+t.savings,this.competitiveness.text=h.i18n.t("business_street.competitiveness")+":"+t.competitiveness,this.turnover.text=h.i18n.t("business_street.turnover")+":"+t.turnover,this.industryIcon.setFrame(e+"_tag"),this.storeData=t},MyStoreItem.prototype.setHandler=function(t){this.enterHandler=t},MyStoreItem.prototype.setImageInfo=function(t,e){for(var i=0,n=15*this.dpr,a=0,s=e;a<s.length;a++){var o=s[a],h=this.scene.make.image({key:t,frame:o});h.x=i,i+=.5*h.width+n,this.lvimgCon.add(h)}},MyStoreItem.prototype.onEnterHandler=function(){this.enterHandler&&this.enterHandler.runWith(this.storeData)},MyStoreItem.prototype.getLevelImgs=function(t){t=t||0;for(var e=[],i=Math.floor(t/Math.pow(4,3)),n=t%Math.pow(4,3),a=Math.floor(n/Math.pow(4,2)),s=n%Math.pow(4,2),o=Math.floor(s/Math.pow(4,1)),h=s%Math.pow(4,1),l=0;l<i;l++)e.push("bear");for(l=0;l<a;l++)e.push("sun");for(l=0;l<o;l++)e.push("moon");for(l=0;l<h;l++)e.push("star");return 0===t&&e.push("star"),e},MyStoreItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankRewardPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessRankRewardPanel(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.dpr=o,p.key=l,p.key2=c,p.zoom=h,p.setSize(a,s),p.create(),p}return l(PicaBusinessRankRewardPanel,t),PicaBusinessRankRewardPanel.prototype.setRankRewardData=function(t){this.gridtable.setItems(t)},PicaBusinessRankRewardPanel.prototype.setHandler=function(t){this.backHandler=t},PicaBusinessRankRewardPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessRankRewardPanel.prototype.create=function(){var t=.5*-this.height,e=this.width-20*this.dpr,i=this.height-70*this.dpr,n=t+23*this.dpr+.5*i;this.gridtable=this.createGrideTable(-5*this.dpr,n,e,i,256*this.dpr,80*this.dpr);var s=new a.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(s),s.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),s.on(String(a.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankRewardPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(h.scene,0,0,s,o,h.key,h.key2,h.dpr,h.zoom),c.add(e)),e.setData({item:i}),e.setRankRewardData(i),e}},c=new a.GameGridTable(this.scene,l);return c.layout(),this.add(c),c},PicaBusinessRankRewardPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessRankRewardPanel}(Phaser.GameObjects.Container),p=function(t){function PicRankRewardItem(e,i,n,a,s,o,l,c,p){var d=t.call(this,e,i,n)||this;d.rewardItems=[],d.dpr=c,d.zoom=p,d.key=o,d.key2=l,d.setSize(a,s);var u=d.scene.make.image({key:d.key2,frame:"reward_bg"});u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.add(u),d.rankIcon=d.scene.make.image({key:l,frame:"1"}),d.rankIcon.x=.5*-a+.5*d.rankIcon.width+10*c,d.add(d.rankIcon);var m=d.rankIcon.x;return d.rankText=d.scene.make.text({x:m,y:0,text:"3",style:{color:"#0",fontSize:12*c,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),d.add(d.rankText),d}return l(PicRankRewardItem,t),PicRankRewardItem.prototype.setRankRewardData=function(t){if(this.rewardData!==t){t.start===t.end?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.start+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,this.rankText.text=t.start+"~"+t.end);for(var e=0,i=this.rewardItems;e<i.length;e++){(a=i[e]).visible=!1}for(var n=0;n<t.rewards.length;n++){var a=void 0;n<this.rewardItems.length?a=this.rewardItems[n]:(a=new d(this.scene,0,0,50*this.dpr,50*this.dpr,this.key2,this.dpr,this.zoom),this.add(a),this.rewardItems.push(a)),a.visible=!0,a.setRewardData(t.rewards[n])}this.Sort(),this.rewardData=t}},PicRankRewardItem.prototype.Sort=function(){for(var t=10*this.dpr,e=-50*this.dpr,i=0,n=this.rewardItems;i<n.length;i++){var a=n[i];a.x=a.width*a.originX+e,e+=a.width+t}},PicRankRewardItem}(Phaser.GameObjects.Container),d=function(t){function RewardItem(e,i,n,a,o,l,c,p){var d=t.call(this,e,i,n)||this;d.dpr=c,d.key2=l,d.setSize(a,o);var u=d.scene.make.image({key:d.key2,frame:"icon_bg_m"});return u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.add(u),d.itemIcon=new s.DynamicImage(d.scene,0,0),d.add(d.itemIcon),d.countText=d.scene.make.text({x:.5*u.width,y:.5*u.height,text:"4~10",style:{color:"#0",fontSize:12*c,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(1,.5),d.add(d.countText),d}return l(RewardItem,t),RewardItem.prototype.setRewardData=function(t){var e=this,i=h.Url.getOsdRes(t.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.displayWidth=43*e.dpr,e.itemIcon.scaleY=e.itemIcon.scaleX})),this.countText.text=t.count+""},RewardItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankingDetailPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaBusinessRankingDetailPanel(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.dpr=o,p.key=l,p.key2=c,p.zoom=h,p.setSize(a,s),p.create(),p}return l(PicaBusinessRankingDetailPanel,t),PicaBusinessRankingDetailPanel.prototype.setRankingDetailData=function(t){this.content=t;var e=t.stores;if(this.gridtable.setItems(e),t.playerStore){this.myRankItem.visible=!0,this.myitembg.visible=!0,this.myRankItem.setDetailData(t.playerStore);var i=.5*-this.height,n=this.width,a=this.height-125*this.dpr,s=i+30*this.dpr+.5*a;this.gridtable.y=s,this.gridtable.setSize(n,a)}else{this.myitembg.visible=!1,this.myRankItem.visible=!1;i=.5*-this.height,n=this.width,a=this.height-100*this.dpr,s=i+30*this.dpr+.5*a;this.gridtable.y=s,this.gridtable.setSize(n,a)}},PicaBusinessRankingDetailPanel.prototype.setHandler=function(t,e){this.backHandler=t,this.rankRewardHandler=e},PicaBusinessRankingDetailPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessRankingDetailPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width;this.timeText=this.scene.make.text({x:0,y:t+6*this.dpr,text:h.i18n.t("6 DAY 23:24:16"),style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#D9270F"}}).setOrigin(.5),this.timeText.setStroke("#553100",2*this.dpr),this.add(this.timeText),this.timeText.visible=!1;var i=new a.NineSliceButton(this.scene,0,this.timeText.y,60*this.dpr,26*this.dpr,o.c.commonKey,"yellow_btn_normal_s",h.i18n.t("business_street.rank_reward"),this.dpr,this.zoom,{left:10*this.dpr,top:6*this.dpr,right:10*this.dpr,bottom:6*this.dpr});i.x=-e-.5*i.width-30*this.dpr,i.setTextStyle({fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#996600"}),i.on(String(a.ClickEvent.Tap),this.onRankRewardHandler,this),this.add(i);var n=this.width,s=this.height-125*this.dpr,l=t+30*this.dpr+.5*s;this.gridtable=this.createGrideTable(0,l,n,s,256*this.dpr,50*this.dpr),this.myitembg=this.scene.make.image({key:this.key2,frame:"my_rank_bg"}),this.myitembg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.myitembg.y=l+.5*s+.5*this.myitembg.height-3*this.dpr,this.add(this.myitembg),this.myRankItem=new p(this.scene,0,this.myitembg.y+5*this.dpr,256*this.dpr,50*this.dpr,this.key,this.key2,this.dpr,this.zoom),this.add(this.myRankItem);var c=new a.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,o.c.commonKey,"red_btn",h.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),c.on(String(a.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankingDetailPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(h.scene,0,0,s,o,h.key,h.key2,h.dpr,h.zoom),c.add(e)),e.setData({item:i}),e.setDetailData(i),e}},c=new a.GameGridTable(this.scene,l);return c.layout(),this.add(c),c},PicaBusinessRankingDetailPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.content=void 0},PicaBusinessRankingDetailPanel.prototype.onRankRewardHandler=function(){this.rankRewardHandler&&this.content&&this.rankRewardHandler.runWith([this.content.key,this.content.type])},PicaBusinessRankingDetailPanel}(Phaser.GameObjects.Container),p=function(t){function PicRankingDetailItem(e,i,n,o,l,c,p,d,u){var m=t.call(this,e,i,n)||this;m.dpr=d,m.key=c,m.key2=p,m.setSize(o,l);var f=.5*-m.width,y=.5*-m.height;m.bg=new a.NineSlicePatch(m.scene,0,0,o,45*d,m.key,"restaurant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var g=m.scene.make.image({key:p,frame:"icon_bg_s"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.setPosition(f+.5*g.width+3*d,0),m.add(g),m.storeIcon=new s.DynamicImage(m.scene,g.x,0),m.add(m.storeIcon);var P=g.x+.5*g.width+10*d;return m.storeName=m.scene.make.text({x:P,y:y+10*d,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:P,y:m.storeName.y+.5*m.storeName.height+10*d,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"restaurant_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m.rankIcon=m.scene.make.image({key:p,frame:"1"}),m.rankIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.rankIcon.x=-f-80*d,m.add(m.rankIcon),m.rankText=m.scene.make.text({x:P,y:0,text:"Restaurant",style:{color:"#ffffff",fontSize:18*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),m.rankText.x=m.rankIcon.x,m.add(m.rankText),m.praiseCount=m.scene.make.text({x:m.rankIcon.x+.5*m.rankIcon.width+10*d,y:m.rankIcon.y,text:"66666666",style:{color:"#ffffff",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),m.add(m.praiseCount),m}return l(PicRankingDetailItem,t),PicRankingDetailItem.prototype.setDetailData=function(t){this.detailData=t,this.storeName.text=t.name,this.playerName.text=t.ownerName,t.index<4&&t.index>0?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.index+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,t.index<=0?this.rankText.text=h.i18n.t("business_street.onrank"):this.rankText.text=t.index+""),this.praiseCount.text=t.value+"",this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.bg.setFrame(t.industryType+"_bg"),this.industryIcon.setFrame(t.industryType+"_tag_s")},PicRankingDetailItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessRankingPanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessRankingPanel(e,i,n,a,s,o,h,l,c){var p=t.call(this,e,i,n)||this;return p.boundOffset=85,p.dpr=o,p.key=l,p.key2=c,p.zoom=h,p.setSize(a,s),p.create(),p}return h(PicaBusinessRankingPanel,t),PicaBusinessRankingPanel.prototype.create=function(){var t=this,e=.5*-this.height,i=(this.width,this.scene.make.text({x:0,y:e+20*this.dpr,text:o.i18n.t("business_street.ranking_list"),style:{fontSize:18*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(.5));i.setStroke("#553100",2*this.dpr),this.add(i),this.titleText=i;var n=this.scene.make.image({x:0,y:i.y+.5*i.height+10*this.dpr,key:this.key2,frame:"title"});n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add(n);var h=this.width-28*this.dpr,l=this.height-80*this.dpr;this.dpr;this.gameScroll=new a.GameScroller(this.scene,{x:0,y:0,width:h,height:l,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:function(e){t.onScrollValueChange(e)},cellupCallBack:function(e){t.onScrollClickHandler(e)}}),this.add(this.gameScroll);var c=new a.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,s.c.commonKey,"red_btn",o.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),c.on(String(a.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessRankingPanel.prototype.setRankingData=function(t){var e=this.scene.make.container(void 0,!1);this.boundOffset=35*this.dpr,e.setSize(this.boundOffset,185*this.dpr),this.gameScroll.clearItems(),this.gameScroll.addItem(e);for(var i=0,n=t;i<n.length;i++){var a=n[i],s=new c(this.scene,0,0,133*this.dpr,185*this.dpr,this.key,this.key2,this.dpr,this.zoom);s.setRankData(a),this.gameScroll.addItem(s)}var o=this.scene.make.container(void 0,!1);o.setSize(this.boundOffset,185*this.dpr),this.gameScroll.addItem(o),this.gameScroll.Sort(),this.gameScroll.refreshMask(),this.gameScroll.setValue(this.gameScroll.bounds[1])},PicaBusinessRankingPanel.prototype.setHandler=function(t,e){this.backHandler=t,this.rankHandler=e},PicaBusinessRankingPanel.prototype.resetMask=function(){this.gameScroll.refreshMask()},PicaBusinessRankingPanel.prototype.show=function(){this.addListen(),this.visible=!0},PicaBusinessRankingPanel.prototype.hide=function(){this.removeListen()},PicaBusinessRankingPanel.prototype.onScrollValueChange=function(t){if(this.gameScroll){for(var e=133*this.dpr,i=.25*(this.gameScroll.width-e),n=0,a=this.gameScroll.getItemList();n<a.length;n++){var s=a[n],o=Math.abs(s.getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx)-.25*e;o<0&&(o=0);var h=1-Math.abs(o)/i;s instanceof c&&s.setRadio(h)}this.gameScroll.Sort(!0,!1)}},PicaBusinessRankingPanel.prototype.onScrollUpHandler=function(){var t=this;if(this.gameScroll){var e=this.gameScroll.getValue(),i=this.gameScroll.bounds[1]-e,n=Math.floor((i+66*this.dpr)/(133*this.dpr+20*this.dpr)),a=this.gameScroll.getItemList().length;if(n>=0&&n<a-1){var s=this.gameScroll.getItemAt(n+1).getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx;if((s*=this.scale)<0){var o=Math.abs(s)+e;this.timerID=setInterval((function(){e+=10*t.dpr,t.gameScroll.setValue(e),e>=o&&(t.gameScroll.setValue(o),clearInterval(t.timerID),t.timerID=void 0)}),20)}else{var h=e-Math.abs(s);this.timerID=setInterval((function(){e-=10*t.dpr,t.gameScroll.setValue(e),e<=h&&(t.gameScroll.setValue(h),clearInterval(t.timerID),t.timerID=void 0)}),20)}}this.gameScroll.Sort(!0,!1)}},PicaBusinessRankingPanel.prototype.onScrollClickHandler=function(t){if(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.rankHandler){var e=t.rankData;this.rankHandler.runWith([e.key,e.type])}},PicaBusinessRankingPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.gameScroll.clearItems()},PicaBusinessRankingPanel.prototype.addListen=function(){this.scene&&(this.removeListen(),this.scene.input.on("pointerdown",this.pointerDownHandler,this),this.scene.input.on("pointerup",this.pointerUpHandler,this))},PicaBusinessRankingPanel.prototype.removeListen=function(){this.scene&&(this.scene.input.off("pointerdown",this.pointerDownHandler,this),this.scene.input.off("pointerup",this.pointerUpHandler,this))},PicaBusinessRankingPanel.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this.gameScroll,t)&&(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.moveTimerID&&(clearInterval(this.moveTimerID),this.moveTimerID=void 0))},PicaBusinessRankingPanel.prototype.pointerUpHandler=function(t){var e=this;this.checkPointerInBounds(this.gameScroll,t)&&setTimeout((function(){e.gameScroll.isSliding?e.moveTimerID=setInterval((function(){e.gameScroll.isSliding||(e.onScrollUpHandler(),clearInterval(e.moveTimerID),e.moveTimerID=void 0)}),20):e.onScrollUpHandler()}),20)},PicaBusinessRankingPanel.prototype.checkPointerInBounds=function(t,e){if(this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0)),this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,e){var i=t.getWorldTransformMatrix(),n=e.x-i.tx,a=e.y-i.ty;return this.mRectangle.left<=n&&this.mRectangle.right>=n&&this.mRectangle.top<=a&&this.mRectangle.bottom>=a}return!1},PicaBusinessRankingPanel}(Phaser.GameObjects.Container),c=function(t){function PicRankingItem(e,i,n,s,h,l,c,p,d){var u=t.call(this,e,i,n)||this;u.radio=0,u.imgtype=1,u.dpr=p,u.key=l,u.key2=c,u.setSize(s,h);u.width;var m=.5*-u.height;return u.bg=u.scene.make.image({key:u.key2,frame:"restaurant_rank_bg_s"}),u.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.add(u.bg),u.titleText=u.scene.make.text({x:0,y:m,text:"Restaurant",style:{color:"#0555AF",fontSize:14*p,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),u.add(u.titleText),u.storebg=new a.NineSlicePatch(u.scene,0,0,72*p,17*p,u.key2,"store_name_bg_s",{left:8*u.dpr,top:0*u.dpr,right:8*u.dpr,bottom:0*u.dpr}),u.storebg.y=u.titleText.y+10*p,u.add(u.storebg),u.storeName=u.scene.make.text({x:0,y:u.storebg.y,text:"Restaurant",style:{color:"#0",fontSize:12*p,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),u.add(u.storeName),u.storeIcon=u.scene.make.image({key:u.key2,frame:"restaurant_rank_icon_s"}),u.storeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.storeIcon.y=-m-.5*u.storeIcon.height-5*p,u.add(u.storeIcon),u}return h(PicRankingItem,t),PicRankingItem.prototype.setRankData=function(t){this.rankData=t,this.titleText.text=t.name,this.storeName.text=t.champion,this.switchImage(1)},PicRankingItem.prototype.setRadio=function(t){var e=1;t>1&&(t=1),t>0&&(e=2),this.imgtype!==e&&(this.switchImage(e),this.imgtype=e),this.scale=2===e?1/this.radio+t*(1-1/this.radio):1,this.width=this.bg.displayWidth*this.scale,this.height=this.bg.displayHeight*this.scale},PicRankingItem.prototype.switchImage=function(t){var e,i,n,a,s,o,h,l,c=this.rankData.type,p=133*this.dpr,d=133*this.dpr;1===t?(e=c+"_rank_bg_s",i=14*this.dpr,n="store_name_bg_s",a=72*this.dpr,s=14*this.dpr,o=10*this.dpr,h=c+"_rank_icon_s",d=133*this.dpr,this.storebg.setConfig({left:8*this.dpr,top:0*this.dpr,right:8*this.dpr,bottom:0*this.dpr})):(e=c+"_rank_bg_m",i=18*this.dpr,n="store_name_bg_m",a=88*this.dpr,s=17*this.dpr,o=12*this.dpr,h=c+"_rank_icon_m",d=163*this.dpr,this.storebg.setConfig({left:11*this.dpr,top:0*this.dpr,right:11*this.dpr,bottom:0*this.dpr})),l=d/p,this.radio=l,this.bg.setFrame(e),this.titleText.setFontSize(i),this.storebg.setFrame(n),this.storebg.resize(a,s),this.storeName.setFontSize(o),this.storeIcon.setFrame(h),this.setSize(this.bg.width,this.bg.height),this.titleText.y=.5*-this.height+.5*this.titleText.height+10*this.dpr*l,this.storebg.y=this.titleText.y+.5*this.titleText.height+10*this.dpr*l,this.storeName.y=this.storebg.y,this.storeIcon.y=.5*this.height-.5*this.storeIcon.height-10*this.dpr*l},PicRankingItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStoreCreatePanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaBusinessStoreCreatePanel(e,i,n,a,s,o,h,l,c){void 0===c&&(c=!0);var p=t.call(this,e,i,n)||this;return p.isFirst=!0,p.dpr=o,p.key=l,p.zoom=h,p.setSize(a,s),p.isFirst=c,p.create(),p}return h(PicaBusinessStoreCreatePanel,t),PicaBusinessStoreCreatePanel.prototype.setTypeData=function(t){t instanceof Array?this.gridtable.setItems(t):this.gridtable.setItems(t.roomModels);var e=this.gridtable.getCells()[0];e&&e.container&&this.onGridSelectHandler(e.container),this.gridtable.setT(0)},PicaBusinessStoreCreatePanel.prototype.setTypeInfo=function(t){if(this.curSelectData=t,"industryType"in t)this.recommendedText.text=t.state,this.describleText.text=t.des,this.turnoverText.setText(t.buffDes);else{var e=t;e.price&&(this.coinImg.setFrame(o.Coin.getIcon(e.price.coinType)),this.coinCount.text=e.price.price+""),this.describleText2.text=e.des}},PicaBusinessStoreCreatePanel.prototype.setHandler=function(t,e){this.cancelHandler=t,this.selectHandler=e},PicaBusinessStoreCreatePanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessStoreCreatePanel.prototype.create=function(){var t=.5*-this.height,e=new a.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});e.x=0,e.y=t+10*this.dpr,this.add(e);var i=this.scene.make.text({x:0,y:e.y,text:o.i18n.t("business_street.choosetheindustry"),style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(i);var n=this.width-24*this.dpr,h=100*this.dpr,l=-50*this.dpr;this.gridtable=this.createGrideTable(0,l,n,h,90*this.dpr,100*this.dpr),this.isFirst?(this.recommendedText=this.scene.make.text({x:0,y:20*this.dpr,text:"Recommended",style:{fontSize:13*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#697AFF"}}).setOrigin(.5,0),this.recommendedText.setFontStyle("bold"),this.add(this.recommendedText),this.describleText=this.scene.make.text({x:0,y:this.recommendedText.y+this.recommendedText.height+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5,0),this.add(this.describleText),this.turnoverText=new a.BBCodeText(this.scene,0,this.describleText.y+this.describleText.height+10*this.dpr).setOrigin(.5,0).setFontSize(11*this.dpr).setFontFamily(o.Font.DEFULT_FONT).setColor("#0"),this.add(this.turnoverText),i.text=o.i18n.t("business_street.choosetheindustry"),e.resize(135*this.dpr,17*this.dpr)):(this.coinBg=this.scene.make.image({key:s.c.commonKey,frame:"price_bg"}),this.coinBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.coinBg.y=30*this.dpr,this.add(this.coinBg),this.coinImg=this.scene.make.image({key:s.c.commonKey,frame:"iv_coin"}),this.coinImg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.coinImg.setPosition(this.coinBg.x-.5*this.coinImg.width-15*this.dpr,this.coinBg.y),this.add(this.coinImg),this.coinCount=this.scene.make.text({x:this.coinImg.x+.5*this.coinImg.width+10*this.dpr,y:this.coinImg.y,text:"0",style:{fontSize:11*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0"}}).setOrigin(0,.5),this.add(this.coinCount),this.describleText2=this.scene.make.text({x:0,y:this.coinCount.y+50*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(.5),this.add(this.describleText2),i.text=o.i18n.t("business_street.choosestorelike"),e.resize(155*this.dpr,17*this.dpr));var c=new a.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,s.c.commonKey,"red_btn",o.i18n.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),c.on(String(a.ClickEvent.Tap),this.onCancelHandler,this);var p=new a.NineSliceButton(this.scene,60*this.dpr,c.y,92*this.dpr,34*this.dpr,s.c.commonKey,"yellow_btn",o.i18n.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(p),p.on(String(a.ClickEvent.Tap),this.onSelectHandler,this),p.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#996600"})},PicaBusinessStoreCreatePanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new c(h.scene,0,0,s,o,h.key,h.dpr,h.zoom)),e.setData({item:i}),e.setStoreData(i),h.curSelectData&&i===h.curSelectData?e.select=!0:e.select=!1,e}},p=new a.GameGridTable(this.scene,l);return p.layout(),p.on("cellTap",(function(t){t&&h.onGridSelectHandler(t)})),this.add(p),p},PicaBusinessStoreCreatePanel.prototype.onGridSelectHandler=function(t){this.setTypeInfo(t.storeData),this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0,this.curSelectItem=t},PicaBusinessStoreCreatePanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicaBusinessStoreCreatePanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData)},PicaBusinessStoreCreatePanel}(Phaser.GameObjects.Container),c=function(t){function StoreTypeItem(e,i,n,a,s,h,l,c){var p=t.call(this,e,i,n)||this;return p.isSelect=!1,p.dpr=l,p.key=h,p.setSize(a,s),p.bg=p.scene.make.image({key:h,frame:"store_bg"}),p.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.add(p.bg),p.storeIcon=p.scene.make.image({key:h,frame:"restaurant_icon"}),p.storeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.storeIcon.setPosition(0,-8*l),p.add(p.storeIcon),p.storeName=p.scene.make.text({x:0,y:p.storeIcon.y+.5*p.storeIcon.height+10*l,text:"Restaurant",style:{color:"#0",fontSize:10*l,fontFamily:o.Font.DEFULT_FONT}}).setOrigin(.5),p.add(p.storeName),p}return h(StoreTypeItem,t),StoreTypeItem.prototype.setStoreData=function(t){if(this.storeData=t,"industryType"in t)this.storeIcon.setFrame(t.industryType+"_icon"),this.storeName.text=t.name;else{var e=t;this.storeIcon.setFrame(e.storeType+"_icon"),this.storeName.text=e.name}},Object.defineProperty(StoreTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var e=t?"store_bg_click":"store_bg";this.bg.setFrame(e)},enumerable:!1,configurable:!0}),StoreTypeItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStreetListPanel",(function(){return d}));var n,a,s=i(488),o=i(6),h=i(2),l=i(479),c=i(21),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaBusinessStreetListPanel(e,i,n,s,o,h,l,c,p){var d=t.call(this,e,i,n)||this;return d.curCategoryType=a.popularity,d.dpr=h,d.key=c,d.key2=p,d.zoom=l,d.setSize(s,o),d.create(),d}return p(PicaBusinessStreetListPanel,t),PicaBusinessStreetListPanel.prototype.setIndustryModels=function(t){for(var e=[{text:h.i18n.t("business_street.popularity"),data:{categoryType:a.popularity}},{text:h.i18n.t("business_street.praise"),data:{categoryType:a.praise}}],i=[],n=0,s=t.industry;n<s.length;n++)for(var l=0,c=s[n].roomModels;l<c.length;l++){var p=c[l];-1===i.indexOf(p.storeType)&&i.push({type:p.storeType,name:p.name})}this.secondaryPanel.setCategories(o.TabButton,e,{width:88*this.dpr,height:27*this.dpr,key:this.key2,normalFrame:"navigation_bar_click",downFrame:"navigation_bar_click",textStyle:{fontSize:14*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}},new h.Handler(this,(function(t){for(var e=0,i=t;e<i.length;e++){i[e].background.visible=!1}}))),this.secondaryPanel.setSubItems(i)},PicaBusinessStreetListPanel.prototype.setStreetListData=function(t){this.gridtable.setT(0),this.gridtable.setItems(t)},PicaBusinessStreetListPanel.prototype.setHandler=function(t,e,i,n,a){this.historyHandler=t,this.rankHandler=e,this.backHandler=i,this.queryHandler=n,this.enterHandler=a},PicaBusinessStreetListPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaBusinessStreetListPanel.prototype.create=function(){var t=this,e=.5*-this.height,i=.5*-this.width,n=this.scene.make.image({key:this.key,frame:"store_icon"});n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),n.x=i+30*this.dpr,n.y=e+6*this.dpr,this.add(n);var a=n.x+.5*n.width+10*this.dpr,p=this.scene.make.text({x:a,y:n.y,text:h.i18n.t("business_street.street"),style:{fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);p.setFontStyle("bold"),p.setStroke("#553100",2*this.dpr),this.add(p),this.secondaryPanel=new s.SecondaryMenuPanel(this.scene,0,e+56*this.dpr,this.width,60*this.dpr,this.dpr,this.zoom,{x:0,y:-15*this.dpr,width:this.width-30*this.dpr,height:30*this.dpr,zoom:this.zoom,dpr:this.dpr,orientation:1,align:1}),this.add(this.secondaryPanel);var d=this.scene.make.image({key:this.key2,frame:"navigation_bar"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.secondaryPanel.gameScroll.addAt(d),this.secondaryPanel.createGrideTable(0,13*this.dpr,this.width-30*this.dpr,40*this.dpr,65*this.dpr,40*this.dpr,(function(e,i){var n=e.item;return i||(i=new l.TextButton(t.scene,t.dpr,t.zoom)).setFontSize(13*t.dpr),i.getData("itemData")!==n&&(i.setText(n.name),i.setData("itemData",n),t.subCategory===n.type?i.changeDown():i.changeNormal()),i})),this.secondaryPanel.setHandler(new h.Handler(this,this.onCategoryHandler),new h.Handler(this,this.onSubCategoryHandle)),this.secondaryPanel.setButtonChangeHandler(new h.Handler(this,(function(t){t.background.visible=!1})),new h.Handler(this,(function(t){t.background.visible=!0,t.changeDown()})));var u=this.scene.make.image({key:this.key2,frame:"navigation_bar_2"});u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.secondaryPanel.gridTable.addAt(u);var m=this.width,f=this.height-130*this.dpr,y=e+88*this.dpr+.5*f;this.gridtable=this.createGrideTable(0,y,m,f,256*this.dpr,50*this.dpr);var g=new o.Button(this.scene,this.key2,"ranking","ranking"),P=-i-.5*g.width-20*this.dpr;g.setPosition(P,e+6*this.dpr),g.on(String(o.ClickEvent.Tap),this.onRankHandler,this),this.add(g);var _=new o.Button(this.scene,this.key2,"history","history");_.setPosition(P-.5*g.width-.5*_.width-10*this.dpr,e+6*this.dpr),_.on(String(o.ClickEvent.Tap),this.onHistoryHandler,this),this.add(_);var v=new o.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,c.c.commonKey,"red_btn",h.i18n.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(v),v.setTextStyle({fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#ffffff"}),v.on(String(o.ClickEvent.Tap),this.onBackHandler,this)},PicaBusinessStreetListPanel.prototype.createGrideTable=function(t,e,i,n,a,s){var h=this,c={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:a,cellHeight:s,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},press:{tapInterval:50},scrollMode:0,clamplChildOY:!1,interactive:!0,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new u(h.scene,0,0,a,s,h.key,h.key2,h.dpr,h.zoom),p.add(e)),e.setData({item:i}),e.setStoreData(i,h.curCategoryType),e}},p=new o.GameGridTable(this.scene,c);return p.on("cellTap",(function(t){t&&h.onSelectItemHandler(t)})),p.on("cellDown",(function(t){new l.TweenCompent(h.scene,t,{scale:.96,pingpang:!0}).tween()})),p.layout(),this.add(p),p},PicaBusinessStreetListPanel.prototype.onCategoryHandler=function(t){if(this.curCategoryType=t.categoryType,void 0!==this.subCategory){var e=this.curCategoryType===a.popularity?"popularity":"praise";this.queryHandler.runWith([e,this.subCategory])}},PicaBusinessStreetListPanel.prototype.onSubCategoryHandle=function(t){var e=t.getData("itemData");this.curSubCategoryItem&&this.curSubCategoryItem.changeNormal(),t.changeDown(),this.curSubCategoryItem=t,this.subCategory=e.type;var i=this.curCategoryType===a.popularity?"popularity":"praise";this.queryHandler&&this.queryHandler.runWith([i,this.subCategory])},PicaBusinessStreetListPanel.prototype.onSelectItemHandler=function(t){var e=t.storeData;this.enterHandler&&this.enterHandler.runWith(e.roomId)},PicaBusinessStreetListPanel.prototype.onHistoryHandler=function(){this.historyHandler&&this.historyHandler.run()},PicaBusinessStreetListPanel.prototype.onRankHandler=function(){this.rankHandler&&this.rankHandler.run()},PicaBusinessStreetListPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicaBusinessStreetListPanel}(Phaser.GameObjects.Container),u=function(t){function PicStreetItem(e,i,n,a,s,c,p,d,u){var m=t.call(this,e,i,n)||this;m.dpr=d,m.key=c,m.key2=p,m.setSize(a,s);var f=.5*-m.width,y=.5*-m.height;m.bg=new o.NineSlicePatch(m.scene,0,0,a,45*d,m.key,"restaurant_bg",{left:4*m.dpr,top:9*m.dpr,right:4*m.dpr,bottom:9*m.dpr}),m.add(m.bg);var g=m.scene.make.image({key:p,frame:"icon_bg_s"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.setPosition(f+.5*g.width+3*d,0),m.add(g),m.storeIcon=new l.DynamicImage(m.scene,g.x,0),m.add(m.storeIcon);var P=g.x+.5*g.width+10*d;return m.storeName=m.scene.make.text({x:P,y:y+10*d,text:"",style:{color:"#FFE11A",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.storeName),m.playerName=m.scene.make.text({x:P,y:m.storeName.y+.5*m.storeName.height+10*d,text:"",style:{color:"#ffffff",fontSize:11*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0),m.add(m.playerName),m.industryIcon=m.scene.make.image({key:m.key2,frame:"entertainment_tag_s"}),m.industryIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.industryIcon.x=.5*m.width-.5*m.industryIcon.width,m.add(m.industryIcon),m.praiseIcon=m.scene.make.image({key:p,frame:"praise"}),m.praiseIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.praiseIcon.x=-f-80*d,m.add(m.praiseIcon),m.praiseCount=m.scene.make.text({x:m.praiseIcon.x+.5*m.praiseIcon.width+10*d,y:m.praiseIcon.y,text:"",style:{color:"#ffffff",fontSize:12*d,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),m.add(m.praiseCount),m}return p(PicStreetItem,t),PicStreetItem.prototype.setStoreData=function(t,e){var i=t.industry,n=t.storeType;this.bg.setFrame(i+"_bg"),this.storeIcon.setTexture(this.key2,n+"_icon_s"),this.praiseIcon.setFrame(e===a.praise?"praise":"store_popularity"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.praiseCount.text=(e===a.praise?t.praise:t.popularity)+"",this.industryIcon.setFrame(i+"_tag_s"),this.storeData=t},PicStreetItem}(Phaser.GameObjects.Container);!function(t){t[t.popularity=1]="popularity",t[t.praise=2]="praise"}(a||(a={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurniUnlockEffectPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaFurniUnlockEffectPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.render=i,h.effectQueue=[],h.isPlaying=!1,h.setSize(n,a),h.key=s,h.dpr=o,h}return l(PicaFurniUnlockEffectPanel,t),PicaFurniUnlockEffectPanel.prototype.play=function(t){this.effectQueue=this.effectQueue.concat(t),this.playNext()},PicaFurniUnlockEffectPanel.prototype.playNext=function(){var t=this;if(!this.isPlaying&&this.effectQueue.length>0){var e=this.effectQueue.shift(),i=new p(this.scene,o.d.effectcommon,this.dpr);i.setItemData(e,h.Handler.create(this,(function(){t.isPlaying=!1,t.playNext()})));var n=.5*-this.height+100*this.dpr,a=n+.5*i.width-10*this.dpr,s=n+20*this.dpr;i.x=0,i.alpha=0,i.playMove(a,s),this.add(i),this.isPlaying=!0}},PicaFurniUnlockEffectPanel}(Phaser.GameObjects.Container),p=function(t){function PicaUnlockEffectItem(e,i,n){var o=t.call(this,e)||this;return o.relativepoints=[0,-67,-50,-59,-52,-59,-54],o.key=i,o.dpr=n,o.bg=e.make.image({key:i,frame:"repair_popup_bg"}),o.add(o.bg),o.setSize(o.bg.width,o.bg.height),o.titletext=new a.BBCodeText(e,0,0,"",{fontFamily:h.Font.DEFULT_FONT,fontSize:14*n,color:"#00CCFF",lineSpacing:4*n}).setOrigin(0),o.titletext.x=.5*-o.width+20*n,o.titletext.y=-6*n,o.add(o.titletext),o.furinIcon=new s.DynamicImage(e,.5*o.width-50*n,0),o.add(o.furinIcon),o.sprite1=o.scene.make.image({key:i,frame:"repair_popup_star1"}),o.sprite1.x=.5*o.width-.5*o.sprite1.width-20*n,o.sprite1.y=3*n,o.sprite1.alpha=0,o.sprite2=o.scene.make.image({key:i,frame:"repair_popup_star2"}),o.sprite2.x=-50*n,o.sprite2.y=-33*n,o.sprite2.alpha=0,o.add([o.sprite1,o.sprite2]),o}return l(PicaUnlockEffectItem,t),PicaUnlockEffectItem.prototype.setItemData=function(t,e){this.compl=e;var i="[b][color=#00CCFF]"+t.line1+"[/color][/b]";t.line2&&(i+="\n[b][color=#00CCFF]"+t.line2+"[/color][/b]"),this.titletext.setText(i)},PicaUnlockEffectItem.prototype.playMove=function(t,e){var i=this;if(this.scene){var n=[];this.y=t+this.relativepoints[0]*this.dpr;for(var a=0,s=this.relativepoints;a<s.length;a++){var o=s[a];n.push({y:t+o*this.dpr})}this.alpha=0;var h=this.scene.tweens.add({targets:this,alpha:{from:0,to:1,duration:200,ease:"Cubic.easeIn"},delay:50,onComplete:function(){h.stop(),h.remove()}});this.scene.tweens.timeline({targets:this,ease:"Linear",tweens:n,totalDuration:700,onComplete:function(){i.scene&&(i.playAlphaAni(i.sprite1),setTimeout((function(){i.playAlphaAni(i.sprite2)}),300),setTimeout((function(){i.playFadeout()}),3e3))}})}},PicaUnlockEffectItem.prototype.playAlphaAni=function(t,e,i,n){var a=this;if(void 0===e&&(e=!0),void 0===i&&(i=0),void 0===n&&(n=400),this.scene)var s=this.scene.tweens.add({targets:t,alpha:{from:0,to:1},ease:"Linear",duration:n,yoyo:e,onComplete:function(){s.stop(),s.remove(),++i<2?a.playAlphaAni(t,!0,i):2===i&&a.playAlphaAni(t,!1,i,400)}})},PicaUnlockEffectItem.prototype.playFadeout=function(){var t=this;if(this.scene)var e=this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:200,onComplete:function(){e.stop(),e.remove(),t.compl&&t.compl.run(),t.destroy()}})},PicaUnlockEffectItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEquipUpgradeItem",(function(){return l}));var n,a=i(6),s=i(2),o=i(479),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaEquipUpgradeItem(e,i,n,a,s,o){var h=t.call(this)||this;return h.haveEquiped=!1,h.cellWidth=0,h.cellHeight=0,h.dpr=n,h.zoom=a,h.key=s,h.commonKey=o,h.mScene=e,h.mContainer=i,h.create(),h}return h(PicaEquipUpgradeItem,t),PicaEquipUpgradeItem.prototype.setEquipItems=function(t){var e=t.equipmentType,i=t.mineEquipments;this.titleName.text=e;for(var n=0,a=i;n<a.length;n++){if(a[n].selected){this.haveEquiped=!0;break}0}this.gridTable.setItems(i),this.haveEquiped&&this.setBgTexture(t.isblue)},PicaEquipUpgradeItem.prototype.setTransPosition=function(t,e){this.bg.x+=t,this.bg.y+=e,this.titleName.x+=t,this.titleName.y+=e,this.bottombg.x+=t,this.bottombg.y+=e,this.equipName.x+=t,this.equipName.y+=e,this.penetrationText.x+=t,this.penetrationText.y+=e,this.equipDes.x+=t,this.equipDes.y+=e,this.topbg.x+=t,this.topbg.y+=e,this.unlockbtn.x+=t,this.unlockbtn.y+=e,this.gridTable.refreshPos(t,e-10*this.dpr),this.gridTable.resetMask()},Object.defineProperty(PicaEquipUpgradeItem.prototype,"displayList",{get:function(){return[this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]},enumerable:!1,configurable:!0}),PicaEquipUpgradeItem.prototype.refreshEquipData=function(t,e){this.gridTable.items[e]=t;for(var i=0,n=this.gridTable.getCells();i<n.length;i++){var a=n[i];if(a&&a.container){var s=a.container.itemData;s.id===t.id?a.container.setItemData(t):a.container.setItemData(s)}}this.curSelectItemData.id===t.id&&(this.curSelectItemData=t),this.updateEquipItem(this.curSelectItemData)},PicaEquipUpgradeItem.prototype.destroy=function(){this.unlockbtn&&this.unlockbtn.off("pointerup",this.onUnlockEquipHandler,this),t.prototype.destroy.call(this),this.gridTable&&this.gridTable.destroy(),this.bg=null,this.topbg=null,this.bottombg=null,this.gridTable=null,this.titleName=null,this.equipName=null,this.penetrationText=null,this.equipDes=null,this.unlockbtn=null,this.costNum=null,this.diamondIcon=null,this.curEquipItem=null,this.curSelectItemData=null},PicaEquipUpgradeItem.prototype.setBgTexture=function(t){var e=t?"topbg1":"topbg",i=t?"bottombg1":"bottombg",n=t?"#0867AE":"#8F4300";this.topbg.setTexture(this.key,e),this.bottombg.setTexture(this.key,i),this.titleName.setColor(n).setStroke(n,1),this.equipName.setColor(n).setStroke(n,1),this.penetrationText.setColor(n).setStroke(n,1)},PicaEquipUpgradeItem.prototype.create=function(){this.bg=this.mScene.make.image({x:0,y:-21*this.dpr,key:this.key,frame:"bg1"}),this.topbg=this.mScene.make.image({x:0,y:-61*this.dpr,key:this.key,frame:"topbg"}),this.titleName=this.mScene.make.text({x:0,y:this.topbg.y+0*this.dpr,text:"矿镐",style:{blod:!0,color:"#8F4300",fontSize:14*this.dpr,fontFamily:s.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.titleName.setFontStyle("bold"),this.bottombg=this.mScene.make.image({x:0,y:42*this.dpr,key:this.key,frame:"bottombg"}),this.equipName=this.mScene.make.text({x:-120*this.dpr,y:15*this.dpr,text:"精铁镐",style:{color:"#8F4300",fontSize:14*this.dpr,fontFamily:s.Font.DEFULT_FONT}}),this.equipName.setFontStyle("bold"),this.penetrationText=this.mScene.make.text({x:-60*this.dpr,y:16*this.dpr,text:"穿透力:10",style:{color:"#8F4300",fontSize:12*this.dpr,fontFamily:s.Font.DEFULT_FONT}}),this.equipDes=this.mScene.make.text({x:-120*this.dpr,y:35*this.dpr,text:"描述文字",style:{color:"#000000",fontSize:10*this.dpr,fontFamily:s.Font.DEFULT_FONT,wordWrap:{width:130*this.dpr,useAdvancedWrap:!0}}}),this.equipDes.setStroke("#000000",1),this.mContainer.add([this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]),this.createGridTable(),this.createBtn()},PicaEquipUpgradeItem.prototype.createGridTable=function(){var t=this,e=this.mScene.textures.getFrame(this.key,"equipbg"),i=e.width+10*this.dpr,n=e.height+30*this.dpr;this.cellWidth=i,this.cellHeight=n;var s={x:0,y:0,scrollMode:1,table:{width:259*this.dpr,height:77*this.dpr,columns:1,cellWidth:i,cellHeight:n,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.zoom},clamplChildOY:!1,createCellContainerCallback:function(e,a){var s=e.scene,o=e.item;e.index;return null===a&&((a=new c(s,t.dpr,t.key)).setSize(i,n),a.setChildPosition()),a.setData({item:o}),a.setItemData(o),t.curSelectItemData===o?(a.setSelect(!0),t.curEquipItem=a):a.setSelect(!1),null==t.curEquipItem&&(t.haveEquiped&&!o.selected||t.onSelectItemHandler(a)),a}};this.gridTable=new a.GameGridTable(this.mScene,s),this.gridTable.layout(),this.gridTable.on("cellTap",(function(e){t.onSelectItemHandler(e)})),this.mContainer.add(this.gridTable)},PicaEquipUpgradeItem.prototype.onSelectItemHandler=function(t){this.curEquipItem&&this.curEquipItem.setSelect(!1);var e=t.itemData;this.curSelectItemData=e,this.updateEquipItem(e),t.setSelect(!0),this.curEquipItem&&this.curEquipItem.setSelect(!1),this.curEquipItem=t,e.owned&&!e.selected&&this.emit("reqEquiped",e.id)},PicaEquipUpgradeItem.prototype.updateEquipItem=function(t){if(this.penetrationText.text=t.buffDisplayNames[0],this.equipDes.text=t.description,this.equipName.text=t.name,t.owned?this.unlockbtn.visible=!1:this.unlockbtn.visible=!0,t.qualified?(this.unlockCondition.visible=!1,this.unlockbtn.setInteractive(),this.unlockBg.clearTint(),this.costNum.setColor("#ffffff")):t.owned||(this.unlockCondition.visible=!0,this.unlockCondition.text=t.conditionDisplayNames[0],this.unlockbtn.disableInteractive(),this.unlockBg.setTintFill(8947848),this.costNum.setColor("#999999")),null===t.price)this.costNum.visible=!1,this.diamondIcon.visible=!1,this.btnName.setPosition(0,0*this.dpr);else{var e=t.price.price,i=Math.pow(10,t.price.displayPrecision);this.costNum.text=Math.floor(e*i)/i+"",this.costNum.visible=!0,this.diamondIcon.visible=!0,this.diamondIcon.setTexture(this.commonKey,s.Coin.getIcon(t.price.coinType)),this.diamondIcon.setDisplaySize(12*this.dpr,12*this.dpr),this.btnName.setPosition(0,6*this.dpr)}},PicaEquipUpgradeItem.prototype.onUnlockEquipHandler=function(){this.emit("reqActive",this.curEquipItem.itemData.id)},PicaEquipUpgradeItem.prototype.createBtn=function(){this.unlockCondition=new a.BBCodeText(this.mScene,0,-26*this.dpr,"",{}).setOrigin(.5).setFontSize(10*this.dpr).setFontFamily(s.Font.DEFULT_FONT),this.unlockbtn=this.mScene.make.container(void 0,!1);var t=new a.NinePatch(this.mScene,0,0,88*this.dpr,31*this.dpr,this.commonKey,"yellow_btn_normal",void 0,void 0,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr});this.unlockBg=t,this.diamondIcon=this.mScene.make.image({x:-13*this.dpr,y:-8*this.dpr,key:this.commonKey,frame:"test_diamond"}),this.costNum=this.mScene.make.text({x:-2,y:-8*this.dpr,text:"1000",style:{color:"#ffffff",fontSize:10*this.dpr,fontFamily:s.Font.DEFULT_FONT}}).setOrigin(0,.5),this.btnName=this.mScene.make.text({x:0,y:6*this.dpr,text:"立即解锁",style:{color:"#8F4300",fontSize:11*this.dpr,fontFamily:s.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.costNum.setStroke("#ffffff",1),this.btnName.setStroke("#8F4300",1),this.unlockCondition.setStroke("#000000",1),this.unlockbtn.setPosition(70*this.dpr,48*this.dpr),this.unlockbtn.setSize(t.width,t.height),this.unlockbtn.add([this.unlockCondition,t,this.diamondIcon,this.costNum,this.btnName]),this.unlockbtn.on("pointerup",this.onUnlockEquipHandler,this),this.mContainer.add(this.unlockbtn)},PicaEquipUpgradeItem}(Phaser.Events.EventEmitter),c=function(t){function EquipItemCell(e,i,n){var a=t.call(this,e)||this;return a.isSelect=!1,a.isUnlock=!1,a.dpr=i,a.key=n,a.create(),a}return h(EquipItemCell,t),EquipItemCell.prototype.setItemData=function(t){var e=this;this.itemData=t;var i=s.Url.getOsdRes(t.display.texturePath);this.equipIcon.load(i,this,(function(){e.equipIcon.scale=e.dpr})),this.setEquiped(t.selected,t.owned),this.setSelect(this.isSelect)},EquipItemCell.prototype.setSelect=function(t){this.isSelect=t;var e="equipbg";t||(e=this.isUnlock?"equipbg2":"equipbg1"),this.itemData.selected&&(e="equipbg2"),this.bg.setTexture(this.key,e)},EquipItemCell.prototype.setChildPosition=function(){var t=.5*this.bg.width+10*this.dpr,e=this.height-10*this.dpr;this.bg.setPosition(t,e),t+=1*this.dpr,e=.5*this.height+2*this.dpr,this.equipIcon.setPosition(t,e),t+=22*this.dpr,e=8*this.dpr,this.unlock.setPosition(t,e)},EquipItemCell.prototype.setEquiped=function(t,e){this.isUnlock=e,this.unlock.visible=!1,t?(this.isUnlock=!0,this.unlock.visible=!0,this.unlock.setTexture(this.key,"ok")):this.isUnlock||(this.unlock.visible=!0,this.unlock.setTexture(this.key,"lock"))},EquipItemCell.prototype.create=function(){this.bg=this.scene.make.image({x:0,y:-10*this.dpr,key:this.key,frame:"equipbg"}),this.equipIcon=new o.DynamicImage(this.scene,15*this.dpr,0*this.dpr),this.unlock=this.scene.make.image({x:30*this.dpr,y:-10*this.dpr,key:this.key,frame:"lock"}),this.add([this.bg,this.equipIcon,this.unlock])},EquipItemCell}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListBottomPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaExploreListBottomPanel(e,i,n,a,s){var o=t.call(this,e,a,s)||this;return o.chapterItems=[],o.curChapterID=0,o.unlockChapterID=0,o.setSize(i,n),o.dpr=a,o.zoom=s,o.init(),o}return l(PicaExploreListBottomPanel,t),PicaExploreListBottomPanel.prototype.resize=function(t,e){this.setSize(t,e),this.leftButton.x=.5*-this.width+48*this.dpr,this.rightButton.x=.5*this.width-48*this.dpr},PicaExploreListBottomPanel.prototype.refreshMask=function(){for(var t=0,e=this.chapterItems;t<e.length;t++){e[t].refreshMask()}},PicaExploreListBottomPanel.prototype.setChapterDatas=function(t){this.chapterProDatas=t,this.onChapterProHandler(t.nextChapterId)},PicaExploreListBottomPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListBottomPanel.prototype.setChapterProData=function(){if(this.chapterProDatas)for(var t=this.chapterProDatas.chapters,e=this.curChapterID-2,i=0;i<5;i++){var n=this.chapterItems[i];if(e>=1)if(e<=t.length){var a=t[e-1];n.setChapterData(a),-1!==a.progress&&(this.unlockChapterID=a.chapterId)}else n.setChapterData(void 0);else n.setChapterData(void 0);e+=1}},PicaExploreListBottomPanel.prototype.init=function(){this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_nav_bg"}),this.bg.displayWidth=this.width,this.leftButton=new a.Button(this.scene,o.d.explorelog,"explore_switch_left"),this.rightButton=new a.Button(this.scene,o.d.explorelog,"explore_switch_right"),this.leftButton.on(a.ClickEvent.Tap,this.onLeftClickHandler,this),this.rightButton.on(a.ClickEvent.Tap,this.onRightClickHandler,this),this.add([this.bg,this.leftButton,this.rightButton]),this.createChapterItems(),this.resize(this.width,this.bg.height)},PicaExploreListBottomPanel.prototype.createChapterItems=function(){for(var t,e=16*this.dpr,i=-91*this.dpr,n=0;n<5;n++){var a=2===n,s=new p(this.scene,this.dpr,this.zoom,a);s.setHandler(new h.Handler(this,this.onChapterProHandler)),0!==n&&(i+=.5*s.width+e+(t?.5*t.width:.5*s.width)),s.x=i,this.chapterItems.push(s),t=s}this.add(this.chapterItems)},PicaExploreListBottomPanel.prototype.onLeftClickHandler=function(){var t=this.curChapterID;1!==t&&(--t<1&&(t=1),this.onChapterProHandler(t))},PicaExploreListBottomPanel.prototype.onRightClickHandler=function(){var t=this.curChapterID;t!==this.unlockChapterID&&(t++,this.chapterProDatas||(t=1),t>this.unlockChapterID&&(t=this.unlockChapterID),this.onChapterProHandler(t))},PicaExploreListBottomPanel.prototype.onChapterProHandler=function(t){this.curChapterID!==t&&(this.curChapterID=t,this.setChapterProData(),this.send&&this.send.runWith(["chapterdata",t]))},PicaExploreListBottomPanel}(Phaser.GameObjects.Container),p=function(t){function ChapterItemProgress(e,i,n,a){var s=t.call(this,e,0,0,!1)||this;return s.proValue=0,s.unlock=!1,s.dpr=i,s.zoom=n,s.isZoom=a,s.init(),s.setZoom(a),s}return l(ChapterItemProgress,t),ChapterItemProgress.prototype.setChapterData=function(t){this.chapterProData=t,t?(-1===this.chapterProData.progress?(this.unlock=!1,this.lockImg.visible=!0,this.finishImg.visible=!1,this.levelTex.visible=!1,this.setProgress(0)):(this.unlock=!0,100===t.progress?this.finishImg.visible=!0:this.finishImg.visible=!1,this.lockImg.visible=!1,this.levelTex.visible=!0,this.setProgress(t.progress/100)),this.levelTex.text=t.chapterId+""):(this.lockImg.visible=!1,this.setProgress(0),this.finishImg.visible=!1,this.unlock=!1,this.levelTex.visible=!1)},ChapterItemProgress.prototype.setProgress=function(t){var e=360*t-90;this.barmask.clear(),this.barmask.fillStyle(16777215),this.barmask.slice(0,0,43*this.dpr/this.zoom,Phaser.Math.DegToRad(-90),Phaser.Math.DegToRad(e),!1),this.barmask.fillPath(),this.proValue=t},ChapterItemProgress.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.barmask.setPosition(t.tx,t.ty)},ChapterItemProgress.prototype.destroy=function(){t.prototype.destroy.call(this),this.barmask.destroy()},ChapterItemProgress.prototype.setZoom=function(t){t?(this.bg.setFrame("explore_sequence_select_bottom"),this.lightbg.setFrame("explore_sequence_select_schedule"),this.topbg.setFrame("explore_sequence_select_top"),this.finishImg.setFrame("explore_sequence_uncheck_big"),this.levelTex.setFontSize(24*this.dpr),this.setSize(this.bg.width,this.bg.height)):(this.bg.setFrame("explore_sequence_uncheck_bottom"),this.lightbg.setFrame("explore_sequence_uncheck_schedule"),this.topbg.setFrame("explore_sequence_uncheck_top"),this.finishImg.setFrame("explore_sequence_uncheck_small"),this.levelTex.setFontSize(16*this.dpr),this.setSize(this.bg.width,this.bg.height)),this.enable=!1,this.enable=!0},ChapterItemProgress.prototype.setHandler=function(t){this.send=t},ChapterItemProgress.prototype.init=function(){this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_bottom"}),this.lightbg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_schedule"}),this.topbg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_top"}),this.levelTex=this.scene.make.text({style:h.UIHelper.whiteStyle(this.dpr,16)}).setOrigin(.5),this.levelTex.setFontStyle("bold"),this.finishImg=this.scene.make.image({key:o.d.explorelog,frame:"explore_sequence_uncheck_small"}),this.lockImg=this.scene.make.image({key:o.d.explorelog,frame:"explore_switch_lock"}),this.finishImg.y=.5*this.height,this.barmask=this.scene.make.graphics(void 0,!1),this.lightbg.mask=this.barmask.createGeometryMask(),this.add([this.bg,this.lightbg,this.topbg,this.levelTex,this.finishImg,this.lockImg]),this.setSize(this.bg.width,this.bg.height),this.on(a.ClickEvent.Tap,this.onClickHandler,this),this.finishImg.visible=!1,this.lockImg.visible=!1},ChapterItemProgress.prototype.onClickHandler=function(){this.unlock&&this.send&&this.send.runWith(this.chapterProData.chapterId)},ChapterItemProgress}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListDetailPanel",(function(){return d}));var n,a=i(6),s=i(2),o=i(21),h=i(479),l=i(0),c=i(490),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaExploreListDetailPanel(e,i,n,a,s){var o=t.call(this,e,0,0)||this;return o.needItems=[],o.labels=[],o.needDatas=[],o.indexed=-1,o.labelsCount=0,o.dpr=a,o.zoom=s,o.setSize(i,n),o.init(),o.setInteractive(),o}return p(PicaExploreListDetailPanel,t),PicaExploreListDetailPanel.prototype.resize=function(t,e){this.setSize(t,e),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.73),this.blackGraphic.fillRect(0,0,t,e),this.blackGraphic.x=.5*-t,this.blackGraphic.y=.5*-e,this.lineGraphic.clear(),this.lineGraphic.fillStyle(723723,1),this.lineGraphic.fillRect(-12*this.dpr,-this.dpr,24*this.dpr,2*this.dpr),this.mPropGrid.resetMask()},PicaExploreListDetailPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListDetailPanel.prototype.setCaptoreResultData=function(t){var e="zh-CN"!==s.i18n.language?t.chapter.chapterId+"":l.ChineseUnit.numberToChinese(t.chapter.chapterId);this.titleTex.text=s.i18n.t("explore.chaptertitle",{name:e}),this.captoreTex.text=t.chapter.name,this.captoreDes.text=t.chapter.des,this.taskTex.text=s.i18n.t("explore.taskneedtips"),this.needDatas.length=0;for(var i=0,n=t.levels;i<n.length;i++)for(var a=0,o=n[i].clueItems;a<o.length;a++){var h=o[a];this.needDatas.push(h)}this.setNeedItems(this.needDatas);var c=Math.ceil(this.needDatas.length/6);this.setNeedBottomImgs(c),this.setLabelsSelect(0)},PicaExploreListDetailPanel.prototype.setNeedItems=function(t){for(var e=[],i=0;i<t.length;i+=6){for(var n=[],a=i;a<i+6;a++)a<t.length&&n.push(t[a]);e.push(n)}this.mPropGrid.setItems(e)},PicaExploreListDetailPanel.prototype.setNeedBottomImgs=function(t){this.labelsCount=t;for(var e=0,i=this.labels;e<i.length;e++){(a=i[e]).visible=!1}for(var n=0;n<t;n++){var a=void 0;n<this.labels.length?a=this.labels[n]:(a=this.scene.make.image({key:o.d.explorelog,frame:"explore_page_down"}),this.content.add(a),this.labels.push(a)),a.visible=!0}this.setLabelLayout(t)},PicaExploreListDetailPanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.bg=this.scene.make.image({key:o.d.explorelog,frame:"explore_chapter_total_open"}),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.add(this.content),this.backButton=new a.Button(this.scene,o.d.uicommon,"close"),this.backButton.on(a.ClickEvent.Tap,this.onHideHandler,this),this.backButton.x=.5*this.content.width,this.backButton.y=.5*-this.content.height;var t=-75*this.dpr,e=75*this.dpr,i=.5*-this.content.height+20*this.dpr;this.titleTex=this.scene.make.text({style:s.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.x=t,this.titleTex.y=i,this.captoreTex=this.scene.make.text({style:s.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.captoreTex.setFontStyle("bold"),this.captoreTex.y=this.titleTex.y+25*this.dpr,this.captoreTex.x=t,this.lineGraphic=this.scene.make.graphics(void 0,!1),this.lineGraphic.x=t,this.lineGraphic.y=this.captoreTex.y+15*this.dpr,this.captoreDes=this.scene.make.text({style:s.UIHelper.blackStyle(this.dpr,11)}).setOrigin(0),this.captoreDes.setWordWrapWidth(117*this.dpr,!0),this.captoreDes.x=t-58*this.dpr,this.captoreDes.y=this.lineGraphic.y+16*this.dpr,this.taskTex=this.scene.make.text({style:s.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.taskTex.setFontStyle("bold"),this.taskTex.x=e,this.taskTex.y=this.captoreTex.y,this.mPropGrid=this.createGrid(),this.mPropGrid.x=e+5*this.dpr,this.mPropGrid.y=15*this.dpr,this.content.add([this.bg,this.backButton,this.titleTex,this.captoreTex,this.lineGraphic,this.captoreDes,this.taskTex,this.mPropGrid]),this.resize(this.width,this.height)},PicaExploreListDetailPanel.prototype.setLabelLayout=function(t){for(var e=6*this.dpr,i=8*this.dpr,n=.5*this.content.height-30*this.dpr,a=80*this.dpr-.5*(e*t+i*(t-1))+.5*e,s=0;s<t;s++){var o=this.labels[s];o.x=a,o.y=n,a+=e+i}},PicaExploreListDetailPanel.prototype.onHideHandler=function(){this.send&&this.send.runWith("hide")},PicaExploreListDetailPanel.prototype.createGrid=function(){var t=this,e=110*this.dpr,i=157*this.dpr,n={x:0,y:0,table:{width:110*this.dpr,height:157*this.dpr,columns:1,cellWidth:e,cellHeight:i,reuseCellContainer:!0,zoom:this.zoom,mask:!0},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.item;return null===i&&(i=t.createGridLayout()),i.setItems(n),i},onScrollValueChange:function(e){e<0?e=0:e>1&&(e=1);var i=Math.floor(e*t.labelsCount);t.setLabelsSelect(i)}},s=new a.GameGridTable(this.scene,n);return s.layout(),s.on("cellTap",(function(e){e&&t.onSelectItemHandler(e,t.scene.input.activePointer)})),s},PicaExploreListDetailPanel.prototype.setLabelsSelect=function(t){if(this.indexed!==t){t>=this.labelsCount&&(t=this.labelsCount-1);for(var e=0;e<this.labelsCount;e++)t===e?this.labels[e].setFrame("explore_page_up"):this.labels[e].setFrame("explore_page_down");this.indexed=t}},PicaExploreListDetailPanel.prototype.createGridLayout=function(){return new u(this.scene,120*this.dpr,157*this.dpr,this.dpr,{cellSize:new Phaser.Math.Vector2(45*this.dpr,45*this.dpr),space:new Phaser.Math.Vector2(15*this.dpr,5*this.dpr),startAxis:h.AxisType.Vertical,constraint:h.ConstraintType.FixedColumnCount,constraintCount:2,alignmentType:h.AlignmentType.UpperCenter})},PicaExploreListDetailPanel.prototype.onSelectItemHandler=function(t,e){t.checkPointer(e)},PicaExploreListDetailPanel}(Phaser.GameObjects.Container),u=function(t){function ChapterGridLayout(e,i,n,a,s){var o=t.call(this,e,0,0,s)||this;return o.items=[],o.dpr=a,o.setSize(i,n),o}return p(ChapterGridLayout,t),ChapterGridLayout.prototype.setItems=function(t){for(var e=0,i=this.items;e<i.length;e++){(a=i[e]).visible=!1}for(var n=0;n<t.length;n++){var a=void 0;n<this.items.length?a=this.items[n]:(a=new c.PicaChapterLevelClue(this.scene,this.dpr,43*this.dpr,43*this.dpr),this.add(a),this.items.push(a)),a.visible=!0,a.setItemData(t[n])}this.Layout()},ChapterGridLayout.prototype.checkPointer=function(t){for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.visible&&s.Tool.checkPointerContains(n,t)&&n.showTips()}},ChapterGridLayout}(h.GridLayoutGroup)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListLevelPanel",(function(){return d}));var n,a=i(479),s=i(21),o=i(2),h=i(6),l=i(0),c=i(490),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaExploreListLevelPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.levelItems=[],o.posValue=0,o.topHeight=0,o.bottomHeight=0,o.setSize(i,n),o.dpr=a,o.zoom=s,o.init(),o}return p(PicaExploreListLevelPanel,t),PicaExploreListLevelPanel.prototype.resize=function(t,e){this.setSize(t,e),this.topbg.x=0,this.topbg.y=.5*-this.height+.5*this.topbg.height-this.topHeight,this.titlebg.x=0,this.titlebg.y=.5*-this.height+.5*this.titlebg.height,this.titleTex.x=this.titlebg.x,this.titleTex.y=this.titlebg.y;var i=e-this.titlebg.height-15*this.dpr;this.captorScroll.resetSize(t,i),this.captorScroll.x=0,this.captorScroll.y=.5*this.height-.5*i,this.refreshMask()},PicaExploreListLevelPanel.prototype.refreshMask=function(){this.captorScroll.refreshMask()},PicaExploreListLevelPanel.prototype.setHandler=function(t){this.send=t},PicaExploreListLevelPanel.prototype.setTopAndBottomHeight=function(t,e){this.topHeight=t,this.bottomHeight=e},PicaExploreListLevelPanel.prototype.setCaptoreResult=function(t,e){this.chapterResult=t;var i=t.chapter,n=t.lock,a="zh-CN"!==o.i18n.language?i.chapterId+"":l.ChineseUnit.numberToChinese(i.chapterId,!0);this.titleTex.text=o.i18n.t("explore.chaptertitle",{name:a}),this.captorScroll.clearItems(!1),this.setForwardDatas(t.chapter,n),n||this.setLevelDatas(t.levels,e),this.posValue=0,this.captorScroll.Sort(),n?this.captorScroll.setEnable(!1):(this.captorScroll.setEnable(!0),this.setIndexedLayout(e-t.levels[0].levelId))},PicaExploreListLevelPanel.prototype.setLevelDatas=function(t,e){for(var i=0,n=this.levelItems;i<n.length;i++){(s=n[i]).visible=!1}for(var a=0;a<t.length;a++){var s=void 0;a<this.levelItems.length?s=a===t.length-1?this.finalItem:this.levelItems[a]:(a===t.length-1?this.finalItem?s=this.finalItem:(s=2===t[a].type?new g(this.scene,this.dpr):new f(this.scene,this.dpr),this.finalItem=s):(s=new f(this.scene,this.dpr),this.levelItems.push(s)),s.setHandler(new o.Handler(this,this.onChapterLevelHandler))),this.captorScroll.addItem(s),s.visible=!0;var h=t[a],l=h.id>e;s.setLevelData(h,l)}},PicaExploreListLevelPanel.prototype.setForwardDatas=function(t,e){this.forewordItem||(this.forewordItem=new u(this.scene,this.dpr),this.forewordItem.on(h.ClickEvent.Tap,this.onForewordClickHandler,this)),this.forewordItem.setCaptoreData(t),this.captorScroll.addItem(this.forewordItem),e&&(this.lockItem=new y(this.scene,this.dpr),this.lockItem.setHandler(new o.Handler(this,this.onChapterLockHandler)),this.captorScroll.addItem(this.lockItem),this.lockItem.setLevelData(t,!1))},PicaExploreListLevelPanel.prototype.init=function(){var t=this;this.topbg=this.scene.make.image({key:"explore_mask"}),this.titlebg=this.scene.make.image({key:s.d.explorelog,frame:"explore_title"}),this.titleTex=this.scene.make.text({style:o.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(.5),this.titleTex.setFontStyle("bold");var e=this.height-this.titlebg.height-15*this.dpr;this.captorScroll=new h.GameScroller(this.scene,{x:0,y:0,width:this.width,height:e,zoom:this.zoom,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,mask:!1,valuechangeCallback:function(e){t.onScrollValueChange(e)},cellupCallBack:function(e){t.onScrollClickHandler(e)}}),this.add([this.captorScroll,this.topbg,this.titlebg,this.titleTex]),this.resize(this.width,this.height),this.topbg.visible=!1},PicaExploreListLevelPanel.prototype.setIndexedLayout=function(t){var e,i=((e=t<this.chapterResult.levels.length-1?this.levelItems[t]:this.finalItem).getWorldTransformMatrix().ty-this.captorScroll.getWorldTransformMatrix().ty)/this.zoom-(.5*this.captorScroll.height-.5*e.height);i>0&&this.captorScroll.setValue(this.posValue-i)},PicaExploreListLevelPanel.prototype.onScrollClickHandler=function(t){t instanceof u&&this.onForewordClickHandler()},PicaExploreListLevelPanel.prototype.onScrollValueChange=function(t){0===this.posValue&&(this.posValue=t),t<this.posValue-20*this.dpr?(this.send&&this.send.runWith(["move",!0]),this.topbg.visible=!0):this.send&&(this.send.runWith(["move",!1]),this.topbg.visible=!1);for(var e=0,i=this.levelItems;e<i.length;e++){i[e].refreshMask()}},PicaExploreListLevelPanel.prototype.onForewordClickHandler=function(){this.send&&this.send.runWith(["foreword",this.chapterResult])},PicaExploreListLevelPanel.prototype.onChapterLevelHandler=function(t){this.send&&this.send.runWith(["roomid",t.roomId])},PicaExploreListLevelPanel.prototype.onChapterLockHandler=function(t,e){},PicaExploreListLevelPanel}(Phaser.GameObjects.Container),u=function(t){function ForewordChapterItem(e,i){var n=t.call(this,e,0,0,!1)||this;return n.dpr=i,n.init(),n}return p(ForewordChapterItem,t),ForewordChapterItem.prototype.setCaptoreData=function(t){this.captoreData=t;var e=o.Url.getOsdRes(t.texturePath+"_"+this.dpr+"x.png");this.icon.load(e)},ForewordChapterItem.prototype.init=function(){var t=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_total"});this.setSize(t.width,t.height);var e=this.scene.make.text({text:o.i18n.t("explore.foreword"),style:o.UIHelper.whiteStyle(this.dpr,11)}).setOrigin(.5);e.setFontStyle("bold"),e.x=-3*this.dpr,e.y=.5*-this.height+23*this.dpr,this.icon=new a.DynamicImage(this.scene,0,0),this.add([t,e,this.icon])},ForewordChapterItem}(a.ButtonEventDispatcher),m=function(t){function ChapterLevelBaseItem(e,i){var n=t.call(this,e)||this;return n.unlock=!1,n.dpr=i,n.init(),n}return p(ChapterLevelBaseItem,t),ChapterLevelBaseItem.prototype.refreshMask=function(){},ChapterLevelBaseItem.prototype.setLevelData=function(t,e){this.chapterData=t,this.unlock=!e},ChapterLevelBaseItem.prototype.setHandler=function(t){this.send=t},ChapterLevelBaseItem.prototype.init=function(){},ChapterLevelBaseItem}(Phaser.GameObjects.Container),f=function(t){function ChapterLevelItem(e,i){var n=t.call(this,e,i)||this;return n.clueItms=[],n}return p(ChapterLevelItem,t),ChapterLevelItem.prototype.refreshMask=function(){this.starProgress.refreshMask()},ChapterLevelItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i),this.levelTex.text=e.id+"",this.leftLine.x=this.levelTex.x-.5*this.leftLine.width-.5*this.levelTex.width-2*this.dpr,this.rightLine.x=this.levelTex.x+.5*this.rightLine.width+.5*this.levelTex.width+2*this.dpr;var n=this.getProgressValue(e.progress);this.starProgress.setProgress(n,500);var a=o.Url.getOsdRes(e.texturePath+"_"+this.dpr+"x.png");this.icon.load(a),this.nameTex.text=e.name,this.energyImg.setText("-"+e.costEnergy),this.lockimg.visible=i,this.icon.visible=!i,i?(this.unlockTex.visible=!0,this.unlockTex.text=o.i18n.t("explore.unlock"),this.openButton.setFrameNormal("butt_gray"),this.openButton.setTextStyle(o.UIHelper.whiteStyle(this.dpr,13)),this.energyImg.setTextStyle(o.UIHelper.blackStyle(this.dpr,13))):(this.unlockTex.visible=!1,this.openButton.setFrameNormal("yellow_btn_normal"),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.energyImg.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.setClueData(e.clueItems))},ChapterLevelItem.prototype.setClueData=function(t){for(var e=0,i=this.clueItms;e<i.length;e++){(a=i[e]).visible=!1}if(t){for(var n=0;n<t.length;n++){var a=void 0;n<this.clueItms.length?a=this.clueItms[n]:((a=new c.PicaChapterLevelClue(this.scene,this.dpr,43*this.dpr,43*this.dpr)).enable=!0,this.clueItms.push(a),this.add(a)),a.visible=!0,a.setItemData(t[n])}this.setLayoutItems(t.length)}},ChapterLevelItem.prototype.setLayoutItems=function(t){var e=.5*this.width-94*this.dpr,i=-15*this.dpr;if(1===t)this.clueItms[0].x=e,this.clueItms[0].y=i;else for(var n=42*this.dpr,a=16*this.dpr,s=e-.5*(n+a),o=0;o<2;o++){var h=this.clueItms[o];h.x=s,h.y=i,s+=n+a}},ChapterLevelItem.prototype.setHandler=function(t){this.send=t},ChapterLevelItem.prototype.init=function(){this.bg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_checkpoint"}),this.setSize(this.bg.width,this.bg.height);var t=.5*-this.width+85*this.dpr,e=.5*this.width-85*this.dpr,i=.5*-this.height+18*this.dpr;this.levelTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#5885FD",17*this.dpr)}).setOrigin(.5),this.levelTex.setFontStyle("bold"),this.levelTex.y=i,this.levelTex.x=t,this.leftLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_explore_chapter_left"}),this.leftLine.x=t-this.leftLine.width,this.leftLine.y=i+2*this.dpr,this.rightLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_explore_chapter_right"}),this.rightLine.x=t+this.rightLine.width,this.rightLine.y=this.leftLine.y,this.nameTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=e,this.nameTex.y=i+4*this.dpr,this.starProgress=new a.ProgressMaskBar(this.scene,s.d.explorelog,"explore_star_empty","explore_star_full"),this.starProgress.x=t,this.starProgress.y=i+.5*this.leftLine.height+.5*this.starProgress.height+5*this.dpr,this.iconbg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_scene_bg"}),this.iconbg.x=t,this.iconbg.y=this.starProgress.y+.5*this.starProgress.height+.5*this.iconbg.height+5*this.dpr,this.icon=new a.DynamicImage(this.scene,this.iconbg.x,this.iconbg.y),this.lockimg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_scene_lock"}),this.lockimg.x=this.iconbg.x,this.lockimg.y=this.iconbg.y,this.unlockTex=this.scene.make.text({style:o.UIHelper.blackStyle(this.dpr,11)}).setOrigin(0),this.unlockTex.setWordWrapWidth(106*this.dpr,!0),this.unlockTex.x=e-53*this.dpr,this.unlockTex.y=i+20*this.dpr;this.openButton=new h.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,s.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.open"),this.dpr,1,o.UIHelper.button(this.dpr)),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.openButton.setFontStyle("bold"),this.openButton.setTextOffset(-15*this.dpr,0),this.openButton.x=e,this.openButton.y=.5*this.height-.5*this.openButton.height-24*this.dpr,this.openButton.on(h.ClickEvent.Tap,this.onClickHandler,this),this.energyImg=new a.ImageValue(this.scene,43*this.dpr,15*this.dpr,s.d.uicommon,"explore_physical_icon",this.dpr,o.UIHelper.brownishStyle(this.dpr,14)),this.energyImg.x=14*this.dpr,this.energyImg.setOffset(-4*this.dpr,0),this.energyImg.setLayout(1),this.energyImg.setText(""),this.openButton.add(this.energyImg),this.add([this.bg,this.leftLine,this.rightLine,this.levelTex,this.nameTex,this.starProgress,this.iconbg,this.icon,this.lockimg,this.unlockTex,this.openButton])},ChapterLevelItem.prototype.getProgressValue=function(t){var e=Math.floor(t/100),i=75.75*e+30.3*e;return(i=i<0?0:i)+Math.floor(t%100)/100*75.75},ChapterLevelItem.prototype.onClickHandler=function(){this.unlock&&this.send&&this.send.runWith([this.chapterData])},ChapterLevelItem}(m),y=function(t){function ChapterLevelLockItem(e,i){return t.call(this,e,i)||this}return p(ChapterLevelLockItem,t),ChapterLevelLockItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i),this.rightTex.text=o.i18n.t("explore.unlocktips",{name:e.requiredPlayerLevel})},ChapterLevelLockItem.prototype.init=function(){this.bg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_checkpoint"}),this.setSize(this.bg.width,this.bg.height);var t=-80*this.dpr,e=80*this.dpr,i=.5*-this.height+23*this.dpr;this.nameTex=this.scene.make.text({text:o.i18n.t("explore.nextleveltips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=0,this.nameTex.y=i,this.leftLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_explore_chapter_left"}),this.leftLine.x=.5*-this.nameTex.width-.5*this.leftLine.width-5*this.dpr,this.leftLine.y=i,this.rightLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_explore_chapter_right"}),this.rightLine.x=.5*this.nameTex.width+.5*this.rightLine.width+5*this.dpr,this.rightLine.y=this.leftLine.y,this.leftbg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_scene_bg"}),this.leftbg.x=t,this.leftbg.y=i+.5*this.leftbg.height+20*this.dpr,this.leftTex=this.scene.make.text({text:o.i18n.t("explore.finishchaptertips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.leftTex.x=this.leftbg.x,this.leftTex.y=this.leftbg.y,this.rightbg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_scene_bg"}),this.rightbg.x=e,this.rightbg.y=i+.5*this.leftbg.height+20*this.dpr,this.rightTex=this.scene.make.text({text:"",style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.rightTex.x=this.rightbg.x,this.rightTex.y=this.rightbg.y,this.goButton=new h.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,s.d.uicommon,"yellow_btn_normal",o.i18n.t("task.go"),this.dpr,1,o.UIHelper.button(this.dpr)),this.goButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.goButton.setFontStyle("bold"),this.goButton.on(h.ClickEvent.Tap,this.onGoClickHandler,this),this.goButton.x=.5*-this.goButton.width-30*this.dpr,this.goButton.y=.5*this.height-10*this.dpr,this.finishButton=new h.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,s.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.finish"),this.dpr,1,o.UIHelper.button(this.dpr)),this.finishButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.finishButton.setFontStyle("bold"),this.finishButton.on(h.ClickEvent.Tap,this.onFinishClickHandler,this),this.finishButton.x=.5*this.finishButton.width+30*this.dpr,this.finishButton.y=.5*this.height-10*this.dpr,this.add([this.bg,this.leftLine,this.rightLine,this.nameTex,this.leftbg,this.leftTex,this.rightbg,this.rightTex,this.goButton,this.finishButton])},ChapterLevelLockItem.prototype.onGoClickHandler=function(){this.send&&this.send.runWith(["lockgo",this.chapterData])},ChapterLevelLockItem.prototype.onFinishClickHandler=function(){this.send&&this.send.runWith(["lockfinish",this.chapterData])},ChapterLevelLockItem}(m),g=function(t){function ChapterLevelEventuallyItem(e,i){return t.call(this,e,i)||this}return p(ChapterLevelEventuallyItem,t),ChapterLevelEventuallyItem.prototype.setLevelData=function(e,i){t.prototype.setLevelData.call(this,e,i);var n=o.Url.getOsdRes(e.texturePath+"_"+this.dpr+"x.png");this.icon.load(n),i?(this.iconbg2.visible=!1,this.openButton.setFrameNormal("butt_gray"),this.openButton.setTextStyle(o.UIHelper.whiteStyle(this.dpr,13))):(this.iconbg2.visible=!0,this.openButton.setFrameNormal("yellow_btn_normal"),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)))},ChapterLevelEventuallyItem.prototype.init=function(){var t=10*this.dpr;this.bg=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_checkpoint"}),this.setSize(this.bg.width,this.bg.height+2*t),this.bg.y=-t;var e=.5*-this.height+20*this.dpr;this.nameTex=this.scene.make.text({text:o.i18n.t("explore.eventuallytips"),style:o.UIHelper.colorStyle("#8743B9",14*this.dpr)}).setOrigin(.5),this.nameTex.setFontStyle("bold"),this.nameTex.y=e,this.leftLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_left"}),this.leftLine.y=this.nameTex.y,this.leftLine.x=.5*-this.nameTex.width-.5*this.leftLine.width-10*this.dpr,this.rightLine=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_right"}),this.rightLine.y=this.leftLine.y,this.rightLine.x=.5*this.nameTex.width+.5*this.rightLine.width+10*this.dpr,this.iconbg1=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_close"}),this.iconbg1.y=4*this.dpr-t,this.iconbg2=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_undraw"}),this.iconbg2.y=this.iconbg1.y,this.iconbg3=this.scene.make.image({key:s.d.explorelog,frame:"explore_chapter_end_curtain"}),this.iconbg3.y=this.iconbg2.y,this.icon=new a.DynamicImage(this.scene,0,0),this.icon.y=this.iconbg3.y,this.openButton=new h.NineSliceButton(this.scene,0,0,88*this.dpr,32*this.dpr,s.d.uicommon,"yellow_btn_normal",o.i18n.t("explore.open"),this.dpr,1,o.UIHelper.button(this.dpr)),this.openButton.setTextStyle(o.UIHelper.brownishStyle(this.dpr,13)),this.openButton.setFontStyle("bold"),this.openButton.on(h.ClickEvent.Tap,this.onGoClickHandler,this),this.openButton.x=0,this.openButton.y=.5*this.height-6*this.dpr-2*t,this.add([this.bg,this.iconbg1,this.icon,this.iconbg2,this.iconbg3,this.leftLine,this.rightLine,this.nameTex,this.openButton])},ChapterLevelEventuallyItem.prototype.onGoClickHandler=function(){this.send&&this.send.runWith(this.chapterData)},ChapterLevelEventuallyItem}(m)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreLogSettlePanel",(function(){return p}));var n,a=i(6),s=i(2),o=i(21),h=i(481),l=i(479),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaExploreLogSettlePanel(e,i,n,s,o){var h=t.call(this,e,0,0,!1)||this;return h.tweens=[],h.curTempScore=0,h.allScore=0,h.isPlayed=!1,h.finished=!1,h.dpr=s,h.zoom=o,h.setSize(i,n),h.init(),h.enable=!0,h.on(a.ClickEvent.Tap,h.onClickHandler,h),h}return c(PicaExploreLogSettlePanel,t),PicaExploreLogSettlePanel.prototype.resize=function(t,e){this.setSize(t,e),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.8),this.blackGraphic.fillRect(.5*-t,.5*-e,t,e)},PicaExploreLogSettlePanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.width,this.height),this.add(this.content);var t=-200*this.dpr;this.titleimage=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_title"},!1),this.titleimage.y=t,this.starPro=new l.ProgressMaskBar(this.scene,o.d.explorelog,"Settlement_star_default","Settlement_star_Light"),this.starPro.y=this.titleimage.y+.5*this.titleimage.height+.5*this.starPro.height+5*this.dpr,this.starText=this.scene.make.text({x:0,y:this.titleimage.y+40*this.dpr,text:"",style:s.UIHelper.whiteStyle(this.dpr,11)}).setOrigin(.5),this.starText.y=this.starPro.y+.5*this.starPro.height+10*this.dpr,this.starText.visible=!1,this.scorebg=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_score_bg"}),this.scorebg.y=this.starText.y+15*this.dpr+.5*this.scorebg.height,this.scoreTex=this.scene.make.text({x:0,y:this.scorebg.y,text:"",style:s.UIHelper.colorStyle("#FFE057",39*this.dpr)}).setOrigin(.5),this.lightImg=this.scene.make.image({key:o.d.explorelog,frame:"Settlement_light"}),this.lightImg.y=this.scoreTex.y,this.lightImg.visible=!1,this.scoreTipsCon=this.scene.make.container(void 0,!1),this.scoreTipsCon.setSize(244*this.dpr,160*this.dpr),this.scoreTipsCon.y=this.scorebg.y+.5*this.scoreTipsCon.height,this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskWidth=336*this.dpr,this.maskHeight=215*this.dpr,this.content.add([this.titleimage,this.starPro,this.starText,this.scorebg,this.scoreTex,this.lightImg,this.scoreTipsCon])},PicaExploreLogSettlePanel.prototype.setHandler=function(t){this.closeHandler=t},PicaExploreLogSettlePanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaExploreLogSettlePanel.prototype.setSettleData=function(t){if(t){this.initParam(),this.settleData=t,this.scoreDatas=this.getScoreArr(t),this.playScoreTipsAnimation(),this.curLayoutGroup=this.createLayoutGroup(t.rewards),this.curLayoutGroup.y=.5*this.height,this.curLayoutGroup.visible=!1,this.setLayoutMask(this.maskWidth,this.maskHeight);var e=this.getProgressValue(t.previousProgress);this.starPro.setProgress(e,500)}},PicaExploreLogSettlePanel.prototype.initParam=function(){this.isPlayed=!1,this.allScore=0,this.curTempScore=0,this.scoreTex.text=this.allScore+""},PicaExploreLogSettlePanel.prototype.getScoreArr=function(t){var e=[];return t.pointBase>=0&&(e.push({tip:s.i18n.t("explore.basetips"),score:t.pointBase}),this.allScore+=t.pointBase),t.pointTime>=0&&(e.push({tip:s.i18n.t("explore.timetips"),score:t.pointTime}),this.allScore+=t.pointTime),t.pointAccuracy>=0&&(e.push({tip:s.i18n.t("explore.accuracytips"),score:t.pointAccuracy}),this.allScore+=t.pointAccuracy),t.pointHint>=0&&(e.push({tip:s.i18n.t("explore.hinttips"),score:t.pointHint}),this.allScore+=t.pointHint),e},PicaExploreLogSettlePanel.prototype.setLayoutMask=function(t,e){var i=t,n=e;this.maskGraphic.clear(),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var a=this.getWorldTransformMatrix(),s=.5*e+30*this.dpr;this.maskGraphic.setPosition(a.tx,a.ty+s),this.curLayoutGroup.setMask(this.maskGraphic.createGeometryMask())},PicaExploreLogSettlePanel.prototype.excuteNextDatas=function(t){var e=this.scoreDatas;if(e.length>0){var i=e.shift(),n=new d(this.scene,100*this.dpr,45*this.dpr,this.dpr,this.zoom);return n.setTextData(i.tip,i.score),n.y=.5*this.scoreTipsCon.height+10*this.dpr,this.scoreTipsCon.add(n),!0===t?this.playScoreTipsFadeIn(n):!1===t&&this.playScoreTipsFadeOut(n),n.alpha=0,n}this.isPlayed=!0,t?this.curFadeInObj=void 0:this.curFadeOutObj=void 0},PicaExploreLogSettlePanel.prototype.playScoreTipsAnimation=function(){var t=this,e=this.excuteNextDatas(void 0);e.y=0,this.playAlphaTween(e,0,1,500,new s.Handler(this,(function(){t.playScoreTipsFadeOut(e)})))},PicaExploreLogSettlePanel.prototype.clearScoreAnimation=function(){if(this.tweens.length>0)for(var t=0,e=this.tweens;t<e.length;t++){var i=e[t];i.stop(),i.remove()}this.scoreTimer&&(clearInterval(this.scoreTimer),this.scoreTimer=void 0),this.tweens.length=0,this.scoreTipsCon.removeAll(!0),this.lightImg.visible=!1,this.scoreTex.text=this.allScore+"",this.starPro.setProgress(this.settleData.latestProgress,500)},PicaExploreLogSettlePanel.prototype.playCalculateScoreAnimation=function(t,e,i){var n=this,a=t/(e/30),s=this.curTempScore,o=0,h=0;this.scoreTimer=setInterval((function(){(o+=a)>=t&&(clearInterval(n.scoreTimer),o=t,n.curTempScore+=t,n.scoreTimer=void 0,i&&i.run());var e=Math.floor(o);e!==h&&(h=e,n.scoreTex.text=s+h+"")}),30),this.playLightAnimation()},PicaExploreLogSettlePanel.prototype.playScoreTipsFadeIn=function(t){var e=.5*this.scoreTipsCon.height;t.y=e,t.alpha=0,this.playtPosYTween(t,e,0,500),this.playAlphaTween(t,0,1,500),this.curFadeInObj=t},PicaExploreLogSettlePanel.prototype.playScoreTipsFadeOut=function(t){var e=this,i=.5*-this.scoreTipsCon.height;t.y=0,t.alpha=1,this.playtPosYTween(t,0,i,500,void 0),this.playAlphaTween(t,1,0,500,new s.Handler(this,(function(){e.playCalculateScoreAnimation(t.value,300,new s.Handler(e,(function(){e.isPlayed&&(e.playLayoutAnimation(),e.lightImg.visible=!1,e.playStarAnimation(e.settleData.previousProgress,e.settleData.latestProgress,500)),e.curFadeInObj&&e.playScoreTipsFadeOut(e.curFadeInObj)}))),t.destroy()}))),this.scene&&this.excuteNextDatas(!0),this.curFadeOutObj=t},PicaExploreLogSettlePanel.prototype.playStarAnimation=function(t,e,i){var n=this,a=(e-t)/i*5e3,s=Math.floor(e/100),o=Math.floor(e%100),h=this.getProgressValue(e),l=this.getProgressValue(t),c=this.scene.tweens.addCounter({from:l,to:h,ease:"Linear",duration:a,onUpdate:function(t,e){n.starPro.setProgress(e.value,i)},onComplete:function(){c.stop(),c.remove(),n.removeTween(c)}});this.tweens.push(c);var p=196*this.dpr,d=29*this.dpr,u=12*this.dpr;this.starText.text=o+"%",this.starText.x=.5*-p+s*(d+u)+.5*d,this.starText.visible=!0},PicaExploreLogSettlePanel.prototype.getProgressValue=function(t){var e=Math.floor(t/100),i=75.75*e+30.3*e;return(i=i<0?0:i)+Math.floor(t%100)/100*75.75},PicaExploreLogSettlePanel.prototype.playLayoutAnimation=function(){var t=this.curLayoutGroup,e=.5*this.maskHeight+30*this.dpr,i=e+this.maskHeight+20*this.dpr;t.y=i,this.curLayoutGroup.visible=!0,this.playItemTween(t,i,e,620)},PicaExploreLogSettlePanel.prototype.playItemTween=function(t,e,i,n){var a=this,s=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Back.easeOut",duration:400,delay:n,onComplete:function(){s.stop(),s.remove(),a.removeTween(s),a.finished=!0}});this.tweens.push(s)},PicaExploreLogSettlePanel.prototype.playLightAnimation=function(){var t=this;if(!this.lightImg.visible){this.lightImg.visible=!0,this.lightImg.alpha=0;var e=new s.Handler(this,(function(i){t.lightImg.visible&&(1===i?t.playAlphaTween(t.lightImg,1,.8,60,e):t.playAlphaTween(t.lightImg,.8,1,60,e))}));this.playAlphaTween(this.lightImg,0,1,100,e)}},PicaExploreLogSettlePanel.prototype.playtPosYTween=function(t,e,i,n,a,s){var o=this;if(void 0===n&&(n=500),this.scene){var h=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Linear",duration:n,delay:s,onComplete:function(){h.stop(),h.remove(),o.removeTween(h),a&&a.run()}});this.tweens.push(h)}},PicaExploreLogSettlePanel.prototype.playAlphaTween=function(t,e,i,n,a,s){var o=this;if(void 0===n&&(n=500),this.scene){var h=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:"Linear",duration:n,delay:s,onComplete:function(){h.stop(),h.remove(),o.removeTween(h),a&&a.runWith(i)}});this.tweens.push(h)}},PicaExploreLogSettlePanel.prototype.removeTween=function(t){var e=this.tweens.indexOf(t);-1!==e&&this.tweens.splice(e,1)},PicaExploreLogSettlePanel.prototype.createLayoutGroup=function(t){var e=new u(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaExploreLogSettlePanel.prototype.onClickHandler=function(){this.isPlayed?this.finished&&this.closeHandler&&this.closeHandler.run():(this.clearScoreAnimation(),this.isPlayed=!0,this.playLayoutAnimation())},PicaExploreLogSettlePanel}(l.ButtonEventDispatcher),d=function(t){function ScoreTipsPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.value=0,o.dpr=a,o.zoom=s,o.setSize(i,n),o.init(),o}return c(ScoreTipsPanel,t),ScoreTipsPanel.prototype.setTextData=function(t,e){this.title.text=t,this.valueTex.text="+"+e,this.value=e},ScoreTipsPanel.prototype.init=function(){this.title=this.scene.make.text({x:0,y:0,text:"",style:s.UIHelper.whiteStyle(this.dpr)}).setOrigin(.5),this.title.y=-12*this.dpr,this.valueTex=this.scene.make.text({x:0,y:0,text:"",style:s.UIHelper.whiteStyle(this.dpr,24)}).setOrigin(.5),this.valueTex.y=11*this.dpr,this.add([this.title,this.valueTex])},ScoreTipsPanel}(Phaser.GameObjects.Container),u=function(t){function RewardLayoutGroup(e,i,n,a,s,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=h,c.zoom=l,c.setSize(a,s),c.bg=c.scene.make.image({key:o.d.explorelog,frame:"Settlement_reward_bg"}),c.content=c.scene.make.container(void 0,!1),c.content.y=10*h,c.add([c.bg,c.content]),c}return c(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new h.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.content.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.content.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,a=e.height,s=0,o=0;if(i<=3)for(var h=2===i?20*this.dpr:10*this.dpr,l=i*n+h*(i-1),c=0;c<i;c++){(_=t[c]).x=.5*-l+(n+h)*c+.5*n}else if(4===i){var p=20*this.dpr,d=15*this.dpr;for(c=0;c<2;c++)for(var u=0;u<2;u++){(_=t[2*c+u]).x=.5*-(n+p)+(n+p)*u,_.y=.5*-(a+d)+(a+d)*c}}else if(5===i){l=3*n+2*(p=10*this.dpr);var m=2*a+(d=15*this.dpr);for(c=0;c<3;c++){(_=t[c]).x=.5*-l+(n+p)*c+.5*n,_.y=.5*-m+.5*a}for(u=0;u<2;u++){(_=t[u+3]).x=.5*-(2*n+p)+.5*n+(n+p)*u,_.y=.5*m-.5*a}}else if(6===i)for(l=3*n+2*(p=10*this.dpr),m=2*a+(d=15*this.dpr),c=0;c<2;c++)for(u=0;u<3;u++){(_=t[3*c+u]).x=.5*-l+(n+p)*u+.5*n,_.y=.5*-m+(a+d)*c+.5*a}else{p=10*this.dpr,d=10*this.dpr;var f=Math.floor(t.length/4),y=t.length%4,g=(l=4*n+3*p,f+(0===y?0:1));for(m=g*a+d*(g-1),c=0;c<f;c++)for(u=0;u<4;u++){(_=t[4*c+u]).x=.5*-l+(n+p)*u+.5*n,_.y=.5*-m+(a+d)*c+.5*a}var P=y*n+p*(y-1);for(u=0;u<y;u++){var _;(_=t[u+4*f]).x=.5*-P+.5*n+(n+p)*u,_.y=.5*m-.5*a}s=l,o=m,this.width<s&&(this.width=s),this.height<o&&(this.height=o)}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftLaterctPanel",(function(){return h}));var n,a=i(2),s=i(518),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaGiftLaterctPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.render=i,h.giftQueue=[],h.isPlaying=!1,h.setSize(n,a),h.key=s,h.dpr=o,h}return o(PicaGiftLaterctPanel,t),PicaGiftLaterctPanel.prototype.play=function(t){this.giftQueue=this.giftQueue.concat(new Array(30)),this.playNext()},PicaGiftLaterctPanel.prototype.playNext=function(){var t=this;if(!this.isPlaying&&this.giftQueue.length>0){this.giftQueue.shift();var e=new s.PicaGiftLateralItem(this.scene,this.key,this.dpr);e.setItemData(a.Handler.create(this,(function(){t.isPlaying=!1,t.playNext()})));var i=.5*-this.width-.5*e.width-10*this.dpr,n=.5*-this.width+.5*e.width+10*this.dpr;e.x=i,e.y=.5*this.height-100*this.dpr,e.playMove(i,n),this.add(e),this.isPlaying=!0}},PicaGiftLaterctPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftLateralItem",(function(){return l}));var n,a=i(6),s=i(479),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaGiftLateralItem(e,i,n){var h=t.call(this,e)||this;return h.giftCount=0,h.key=i,h.dpr=n,h.bg=e.make.image({key:i,frame:"gift_bg"}),h.add(h.bg),h.setSize(h.bg.width,h.bg.height),h.headicon=e.make.image({key:i,frame:"gift_head"}),h.headicon.x=.5*-h.width+.5*h.headicon.width+2*n,h.add(h.headicon),h.titletext=new a.BBCodeText(e,0,0,"",o.UIHelper.whiteStyle(n)).setOrigin(0),h.titletext.x=h.headicon.x+.5*h.headicon.width+10*n,h.titletext.y=.5*-h.height+2*n,h.add(h.titletext),h.giftIcon=new s.DynamicImage(e,.5*h.width-50*n,0),h.add(h.giftIcon),h.countTex=h.scene.make.text({x:.5*h.width-5*n,y:0,text:"",padding:{left:0,right:10*n},style:{fontFamily:o.Font.DEFULT_FONT,fontSize:28*n,color:"#FCF863"}}).setFontStyle("bold italic").setStroke("#C25E0D",2*n).setOrigin(.5),h.add(h.countTex),h}return h(PicaGiftLateralItem,t),PicaGiftLateralItem.prototype.setItemData=function(t){this.compl=t,this.titletext.setText("一只狐狸\n"+o.i18n.t("common.give")+"[color=#FFFF41]能量电池[/color]"),this.countTex.text="",this.giftCount=Math.floor(50*Math.random())},PicaGiftLateralItem.prototype.playMove=function(t,e){var i=this,n=this.scene.tweens.add({targets:this,x:{from:t,to:e},ease:"Linear",duration:300,onComplete:function(){n.stop(),n.remove(),i.playCount()}})},PicaGiftLateralItem.prototype.playCount=function(){var t=this,e=this.getCountTweenData(this.giftCount),i=0,n=0===e.acc?1:0,tweenFun=function(){n+=e.acc,(i+=n)>t.giftCount&&(i=t.giftCount),t.countTex.text="x"+i;var a=t.scene.tweens.add({targets:t.countTex,scale:{from:.5,to:1},ease:"Linear",duration:e.duration,onComplete:function(){a.stop(),a.remove(),i<t.giftCount?setTimeout((function(){tweenFun()}),e.interval):setTimeout((function(){t.playAlpha()}),1e3)}})};tweenFun()},PicaGiftLateralItem.prototype.playAlpha=function(){var t=this,e=this.scene.tweens.add({targets:this,alpha:{from:1,to:0},ease:"Linear",duration:200,onComplete:function(){e.stop(),e.remove(),t.compl&&t.compl.run(),t.destroy()}})},PicaGiftLateralItem.prototype.getCountTweenData=function(t){var e;return t<10?e={duration:300,interval:20,acc:0}:t>=10&&t<30?e={duration:300,interval:20,acc:1}:t>=30&&(e={duration:300,interval:20,acc:2}),e},PicaGiftLateralItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftPlayerPanel",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function PicaGiftPlayerPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.render=i,h.giftQueue=[],h.isPlaying=!1,h.setSize(n,a),h.key=s,h.dpr=o,h}return a(PicaGiftPlayerPanel,t),PicaGiftPlayerPanel.prototype.play=function(t){this.giftQueue.push(new Array(30)),this.playNext()},PicaGiftPlayerPanel.prototype.playNext=function(){},PicaGiftPlayerPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHouseInfoPanel",(function(){return c}));var n,a=i(6),s=i(2),o=i(479),h=i(21),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaHouseInfoPanel(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.key=o,l.dpr=h,l.setSize(a,s),l.createAttribute(),l}return l(PicaHouseInfoPanel,t),PicaHouseInfoPanel.prototype.setAttributeData=function(t,e){this.roomname.setTextInfo(s.i18n.t("room_info.roomname"),t.name);var i=0,n=0,a=0;t.roomLevel&&(i=t.roomLevel.level,n=t.roomLevel.currentLevelExp?t.roomLevel.currentLevelExp:0,a=t.roomLevel.nextLevelExp?t.roomLevel.nextLevelExp:0),this.roomlevel.setImageInfo(s.i18n.t("room_info.roomlevel"),h.c.common2Key,this.getLevelImgs(i));var o="[color=#0D8288]"+n+"[/color]/"+a;if(this.expvalue.setTextInfo(s.i18n.t("room_info.expvalue"),o),this.popvalue.setTextInfo(s.i18n.t("room_info.popvalue"),t.popularity+""),this.goodvalue.setTextInfo(s.i18n.t("room_info.goodvalue"),t.praise+""),"store"===t.roomType){this.compviness.visible=!0,this.turnover.visible=!0,this.deprecia.visible=!0,this.compviness.setTextInfo(s.i18n.t("room_info.compveness"),t.competitiveness+"");var l="";l=t.turnoverProp.tempValue>0?t.turnoverProp.value+"(+"+t.turnoverProp.tempValue+")":t.turnoverProp.tempValue<0?t.turnoverProp.value+"[color=#ff0000]("+t.turnoverProp.tempValue+")[/color]":""+t.turnoverProp.value,this.turnover.setTextInfo(s.i18n.t("room_info.turnover"),l),this.deprecia.setTextInfo(s.i18n.t("room_info.depreciation"),Math.floor(100*t.undepreciated)+"%"),this.add([this.compviness,this.turnover,this.deprecia,this.helptips]),e?this.deprecia.add([this.renovateBtn,this.help]):this.deprecia.remove([this.renovateBtn,this.help])}else this.compviness.visible=!1,this.turnover.visible=!1,this.deprecia.visible=!1,this.remove([this.compviness,this.turnover,this.deprecia,this.helptips])},PicaHouseInfoPanel.prototype.setHandler=function(t){this.equirementsHandler=t},PicaHouseInfoPanel.prototype.createAttribute=function(){var t=.5*-this.height+10*this.dpr,e=20*this.dpr,i=this.width,n=20*this.dpr+e;this.roomname=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.roomlevel=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.expvalue=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.popvalue=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.goodvalue=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.compviness=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.turnover=new p(this.scene,0,t,i,e,this.dpr),t+=n,this.deprecia=new p(this.scene,0,t,i,e,this.dpr),this.renovateBtn=new a.Button(this.scene,h.c.commonKey,"order_yellow_butt","order_yellow_butt",s.i18n.t("room_info.renovate")),this.renovateBtn.scale=1.1,this.renovateBtn.setTextStyle({fontSize:12*this.dpr,color:"#ED7814"}),this.renovateBtn.on(String(a.ClickEvent.Tap),this.onRenovateHandler,this),this.renovateBtn.x=.5*this.width-60*this.dpr,this.help=new a.Button(this.scene,h.c.common2Key,"icon_tips","icon_tips"),this.help.x=.5*this.width-20*this.dpr,this.help.on(String(a.ClickEvent.Tap),this.onHelpHandler,this),this.deprecia.add([this.renovateBtn,this.help]),this.helptips=new o.ItemInfoTips(this.scene,140*this.dpr,46*this.dpr,h.c.common2Key,"tips_bg",this.dpr),this.helptips.x=60*this.dpr,this.helptips.y=this.deprecia.y-20*this.dpr,this.helptips.setText(s.i18n.t("room_info.helptips"),1),this.helptips.setInvalidArea(s.Tool.getRectangle(this.help,this.scene)),this.helptips.setVisible(!1),this.add([this.roomname,this.roomlevel,this.expvalue,this.popvalue,this.goodvalue])},PicaHouseInfoPanel.prototype.onRenovateHandler=function(){this.equirementsHandler&&this.equirementsHandler.run()},PicaHouseInfoPanel.prototype.onHelpHandler=function(){this.helptips.setVisible(!this.helptips.visible)},PicaHouseInfoPanel.prototype.getLevelImgs=function(t){t=t||0;for(var e=[],i=Math.floor(t/Math.pow(4,3)),n=t%Math.pow(4,3),a=Math.floor(n/Math.pow(4,2)),s=n%Math.pow(4,2),o=Math.floor(s/Math.pow(4,1)),h=s%Math.pow(4,1),l=0;l<i;l++)e.push("bear");for(l=0;l<a;l++)e.push("sun");for(l=0;l<o;l++)e.push("moon");for(l=0;l<h;l++)e.push("star");return 0===t&&e.push("star"),e},PicaHouseInfoPanel.prototype.getpopImgs=function(){return["popularity","popularity","popularity","popularity","popularity"]},PicaHouseInfoPanel.prototype.getgoodImgs=function(){return["good","good","good","good1","good1"]},PicaHouseInfoPanel}(Phaser.GameObjects.Container),p=function(t){function HouseAttributeValue(e,i,n,o,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=l,c.setSize(o,h),c.nameText=c.scene.make.text({x:.5*-o+15*l,y:0,text:"",style:{fontFamily:s.Font.DEFULT_FONT,fontSize:14*l,color:"#FFC51A"}}).setOrigin(0,.5).setResolution(l),c.valueText=new a.BBCodeText(c.scene,0,0,"",{color:"#000000",fontSize:13*c.dpr,fontFamily:s.Font.DEFULT_FONT}).setOrigin(0,.5).setResolution(l),c.imgCon=c.scene.make.container(void 0,!1),c.imgCon.x=10*l,c.add([c.nameText,c.valueText,c.imgCon]),c}return l(HouseAttributeValue,t),HouseAttributeValue.prototype.setTextInfo=function(t,e){this.nameText.text=t,this.valueText.text=e},HouseAttributeValue.prototype.setImageInfo=function(t,e,i){this.nameText.text=t;for(var n=0,a=10*this.dpr,s=0,o=i;s<o.length;s++){var h=o[s],l=this.scene.make.image({key:e,frame:h});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.x=n,n+=.5*l.width+a,this.imgCon.add(l)}this.valueText.visible=!1},HouseAttributeValue}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorContentPanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaManorContentPanel(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.setSize(a,s),l.dpr=o,l.key=h,l.create(),l}return h(PicaManorContentPanel,t),PicaManorContentPanel.prototype.create=function(){var t=this.width,e=this.height;this.bg=new a.NineSlicePatch(this.scene,0,0,t,e,s.c.commonKey,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg);var i=.5*-e;this.titlebg=this.scene.make.image({x:0,y:0,key:s.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=i+3*this.dpr,this.add(this.titlebg),this.titleText=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("manor.title"),style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleText.setFontStyle("bold"),this.titleText.setResolution(this.dpr),this.add(this.titleText),this.closeBtn=new a.Button(this.scene,s.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.setContentSize(t,e)},PicaManorContentPanel.prototype.setContentSize=function(t,e){this.setSize(t,e),this.bg.resize(t,e);var i=.5*-e;this.titlebg.y=i+5*this.dpr,this.titleText.y=this.titlebg.y+2*this.dpr,this.closeBtn.setPosition(.5*this.width-8*this.dpr,i+7*this.dpr)},PicaManorContentPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicaManorContentPanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicaManorContentPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicaManorContentPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorScrollPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaManorScrollPanel(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.dpr=o,c.key=l,c.zoom=h,c.setSize(a,s),c.create(),c}return l(PicaManorScrollPanel,t),PicaManorScrollPanel.prototype.setManorListData=function(t){var e=t.street.sort((function(t,e){return t.streetId>e.streetId?-1:1}));this.gridtable.setItems(e)},PicaManorScrollPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorScrollPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicaManorScrollPanel.prototype.create=function(){var t=.5*-this.height,e=.5*-this.width,i=this.scene.make.image({key:this.key,frame:"finca_list_block"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),i.x=e+35*this.dpr,i.y=t+30*this.dpr,this.add(i);var n=i.x+.5*i.width+5*this.dpr,a=this.scene.make.text({x:n,y:i.y,text:h.i18n.t("manor.title"),style:{fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFC51A"}}).setOrigin(0,.5);a.setFontStyle("bold"),a.setStroke("#553100",2*this.dpr),this.add(a);var s=this.scene.make.graphics(void 0,!1);s.clear(),s.fillStyle(0,.11),s.fillRect(.5*-this.width+20*this.dpr,i.y+20*this.dpr,256*this.dpr,2),this.add(s);var o=293*this.dpr,l=360*this.dpr,c=t+53*this.dpr+.5*l;this.gridtable=this.createGrideTable(0,c,o,l,293*this.dpr,58*this.dpr)},PicaManorScrollPanel.prototype.createGrideTable=function(t,e,i,n,s,o){var h=this,l={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:o,reuseCellContainer:!0,tableOX:0*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=new p(h.scene,0,0,s,o,h.key,h.dpr,h.zoom),c.add(e)),e.setManorData(i),e}},c=new a.GameGridTable(this.scene,l);return c.layout(),c.on("cellTap",this.onGridTableHandler,this),this.add(c),c},PicaManorScrollPanel.prototype.onGridTableHandler=function(t){this.onEnterHandler(t.manorData)},PicaManorScrollPanel.prototype.onEnterHandler=function(t){this.sendHandler&&this.sendHandler.runWith(t.roomId)},PicaManorScrollPanel.prototype.onSearchBtnHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel.prototype.onFiltrateHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel.prototype.onSortBtnHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorScrollPanel}(Phaser.GameObjects.Container),p=function(t){function ManorItem(e,i,n,l,c,p,d,u){var m=t.call(this,e,i,n)||this;m.dpr=d,m.key=p,m.setSize(l,c);m.width,m.height;m.bg=new a.NineSlicePatch(m.scene,0,0,l,50*d,m.key,"list_bg",{left:10*m.dpr,top:0*m.dpr,right:10*m.dpr,bottom:0*m.dpr}),m.add(m.bg);var f=.5*-m.width+10*d;return m.manorName=m.scene.make.text({x:f,y:0,text:"",style:{color:"#333333",fontSize:15*m.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),m.manorName.setFontStyle("bold"),m.add(m.manorName),m.playerCount=new s.ImageValue(e,30*d,20*d,o.c.commonKey,"home_persons",d,{fontFamily:h.Font.DEFULT_FONT,fontSize:15*d,color:"#333333"}),m.playerCount.setFontStyle("bold"),m.playerCount.x=.5*m.width-35*d,m.add(m.playerCount),m.playerCount.setText("100"),m}return l(ManorItem,t),ManorItem.prototype.setManorData=function(t){this.manorData=t,this.manorName.text=t.name,this.playerCount.setText(t.playerCount+"")},ManorItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ElementDetail",(function(){return p}));var n,a=i(482),s=i(6),o=i(524),h=i(2),l=i(21),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function ElementDetail(e,i,n,l,c){var p=t.call(this,e)||this;p.render=i,p.key=n,p.dpr=l,p.zoom=c,p.setPosition(0,0),p.mCounter=new o.NumberCounter(p.scene,n,360,700,p.dpr,i.uiScale);var u=p.scene.textures.getFrame(p.key,"yellow_button_normal"),m=60,f=65;u&&(m=u.width,f=u.height),p.mBuyBtn=new s.NineSliceButton(p.scene,440,700,81*p.dpr,41*p.dpr,p.key,"yellow_button",h.i18n.t("common.buy"),p.dpr,p.scale,{left:14*p.dpr,top:14*p.dpr,right:m-2-14*p.dpr,bottom:f-2-14*p.dpr}),p.mBuyBtn.setTextStyle({color:"#976400",fontSize:16*p.dpr,fontFamily:h.Font.DEFULT_FONT}),p.mBuyBtn.setFontStyle("bold"),p.mBuyBtn.on(String(s.ClickEvent.Tap),p.onBuyHandler,p),p.mPriceContainer=p.scene.make.container(void 0,!1),p.mPriceIcon=p.scene.make.image({x:-78,key:p.key,frame:"iv_coin"},!1),p.mPriceIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.mPriceText=p.scene.make.text({x:0,style:{fontSize:14*p.dpr,fontFamily:h.Font.NUMBER}}).setOrigin(.5);var y=p.scene.make.image({key:p.key,frame:"price_bg"});return y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),p.mDetailDisplay=new a.DetailDisplay(p.scene,p.render),p.mDetailDisplay.setFixedScale(2*p.dpr/p.zoom),p.mDetailDisplay.y=110*p.dpr,p.mDetailBubble=new d(p.scene,p.key,p.dpr),p.mDetailBubble.x=4*p.dpr,p.mDetailBubble.y=400*p.dpr,p.add([p.mDetailDisplay,p.mPriceContainer,p.mCounter,p.mBuyBtn,p.mDetailBubble]),p.mPriceContainer.add([y,p.mPriceIcon,p.mPriceText]),p.addActionListener(),p}return c(ElementDetail,t),ElementDetail.prototype.resize=function(t,e){var i=t,n=e/2-150,a=t/2;this.mBuyBtn.x=i-this.mBuyBtn.displayWidth/2-10*this.dpr,this.mBuyBtn.y=this.height-this.y-this.mBuyBtn.displayHeight/2-12*this.dpr;var s=this.mBuyBtn.x-this.mBuyBtn.displayWidth/2-this.mCounter.displayWidth/2-17*this.dpr;this.mCounter.x=s,this.mCounter.y=this.mBuyBtn.y,this.mDetailBubble.x=4*this.dpr,this.mDetailBubble.y=this.mCounter.y-70*this.dpr,this.mPriceContainer.x=this.mCounter.x,this.mPriceContainer.y=this.mCounter.y-35*this.dpr,this.mDetailDisplay.x=a,this.mDetailDisplay.y=(this.height-this.y)/2;var o=.8*i,h=.7*n;this.setInteractive(new Phaser.Geom.Rectangle((i>>1)+(i-o>>1),n>>1,o,h),Phaser.Geom.Rectangle.Contains),this.mCounter.resize(),this.mDetailBubble.visible=!0},ElementDetail.prototype.addActionListener=function(){this.mCounter&&(this.mCounter.addActionListener(),this.mCounter.on("change",this.onChangeCounterHandler,this),this.on("pointerup",this.onPointerUpHandler,this))},ElementDetail.prototype.removeActionListener=function(){this.mCounter&&(this.mCounter.removeActionListener(),this.mCounter.off("change",this.onChangeCounterHandler,this),this.off("gameobjectup",this.onPointerUpHandler,this))},ElementDetail.prototype.setProp=function(t){var e=this;this.mSelectedProp=t,t.price&&t.price.length>0?(this.mPriceIcon.setTexture(this.key,h.Coin.getIcon(t.price[0].coinType)),this.updatePrice(t.price[0].price.toString())):this.mPriceText.setText("");var i=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return i=t,e.serviceTimestamp})).then((function(n){e.mDetailBubble.setProp(t,Math.floor(n/1e3),i),e.mDetailBubble.y=e.height-e.y-e.mDetailBubble.height-6*e.dpr,e.mCounter.setCounter(1)}))},ElementDetail.prototype.setResource=function(t){var e=this;t.display?this.mDetailDisplay.loadDisplay(t):t.avatar?this.render.mainPeer.getPlayerAvatar().then((function(i){var n=i.avatar,a=i.suits;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o&&!t.avatar[s]&&(t.avatar[s]=o)}if(a)for(var h=t.suits[0],l=0,c=a;l<c.length;l++){var p=c[l];p.suit_type!==h.suit_type&&t.suits.push(p)}var d=new Phaser.Geom.Point(0,70);e.mDetailDisplay.loadAvatar(t,2*e.dpr,d)})):this.mDetailDisplay.loadUrl(this.mSelectedProp.icon)},Object.defineProperty(ElementDetail.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),ElementDetail.prototype.updatePrice=function(t){this.mPriceText.setText(t),this.mPriceIcon.x=this.mPriceText.x-this.mPriceText.width/2-16*this.dpr},ElementDetail.prototype.onBuyHandler=function(){if(this.mSelectedProp){var t={id:null,quantity:null,category:null};t.id=this.mSelectedProp.id,t.quantity=this.mCounter.number,t.category=this.mSelectedProp.category,this.emit("buyItem",t)}},ElementDetail.prototype.onChangeCounterHandler=function(t){this.mSelectedProp&&(!this.mSelectedProp.price||this.mSelectedProp.price.length<1||this.updatePrice((this.mSelectedProp.price[0].price*this.mCounter.number).toString()))},ElementDetail.prototype.onPointerUpHandler=function(){this.mCounter.setBlur()},ElementDetail}(Phaser.GameObjects.Container),d=function(t){function DetailBubble(e,i,n,a){void 0===a&&(a=1);var o=t.call(this,e)||this;o.dpr=n;var c=100*n,p=96*n;return o.setSize(c,p),o.tipsbg=new s.NineSlicePatch(o.scene,0,0,c,p,l.d.uicommon,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,.5),o.tipsbg.setPosition(.5*c,.5*p),o.tipsbg.alpha=.6,o.tipsText=new s.BBCodeText(o.scene,7*n,-p+60*o.dpr,"",{color:"#333333",fontSize:10*o.dpr,fontFamily:h.Font.DEFULT_FONT,lineSpacing:6*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("string"),o.mExpires=new s.BBCodeText(e,7*n,85*n,"",{fontSize:10*o.dpr,fontFamily:h.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:l.c.commonKey,frame:"iv_coin"}),o.tipsText.addImage("iv_diamond",{key:l.c.commonKey,frame:"iv_diamond"}),o}return c(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){if(t){this.tipsText.setWrapWidth(void 0);var n="",a="",s="",o="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]"+"\n",l=100*this.dpr;this.tipsText.text=o,l=l<this.tipsText.width?this.tipsText.width:l,t.des&&""!==t.des&&(o+="\n"+(n=t.des),this.tipsText.text=n,l=l<this.tipsText.width?this.tipsText.width:l);var c=!1;if(t.affectValues){for(var p=t.affectValues.length,d=0;d<p;d++){var u=t.affectValues[d];if(i.propertiesMap.has(u.key)){var m=i.propertiesMap.get(u.key),f=u.value>0?"[color=#ffff00]+"+u.value+"[/color]":"[color=#ff0000]"+u.value+"[/color]";a+="\n"+m.name+": "+f}}a.length>0&&(c||(c=!0,o+="\n-- -- -- -- -- -- -- --"),o+="\n[color=#ffffff]"+h.i18n.t("furni_bag.properties")+"[/color]"+a)}if(t.requireValues){for(p=t.requireValues.length,d=0;d<p;d++){var y=t.requireValues[d];if(i.propertiesMap.has(y.key)){f=((m=i.propertiesMap.get(y.key)).value,y.value,"[color=#00ff00]("+y.value+")[/color]");s+="\n"+m.name+": "+f}}s.length>0&&(c||(c=!0,o+="\n-- -- -- -- -- -- -- --"),o+="\n"+h.i18n.t("furni_bag.needproper")+":"+s)}this.tipsText.setWrapWidth(l),this.tipsText.text=o,this.width=l+14*this.dpr,this.resize()}else this.tipsText.setText(h.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,s=h.i18n.t("furni_bag.timelimit")+":  ";if(e>0)s+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]";else if(i>0||n>0||a>0){s+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]"}else{s+="[color=#FF0000]"+(""+h.i18n.t("furni_bag.expires"))+"[/color]"}return s},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble.prototype.getComparTag=function(t){var e="";switch(t){case 1:e="=";case 2:e="!=";case 3:e="<=";case 4:e="<";case 5:e=">=";case 6:e=">";default:e="="}return e},DetailBubble}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"NumberCounter",(function(){return o}));var n,a=i(479),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function NumberCounter(e,i,n,s,o,h){void 0===o&&(o=1),void 0===h&&(h=1);var l=t.call(this,e,n,s)||this;return l.pressDelay=500,l.mMinNum=1,l.mMaxNum=99,l.zoom=1,l.zoom=h,l.mBackground=l.scene.make.image({key:i,frame:"input_bg"}),l.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mReduceBtn=l.scene.make.image({key:i,frame:"reduce"},!1).setInteractive(),l.mReduceBtn.x=-l.mBackground.displayWidth/2-l.mReduceBtn.displayWidth/2-7*o,l.mReduceBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mIncreaseBtn=l.scene.make.image({key:i,frame:"increase"},!1).setInteractive(),l.mIncreaseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mIncreaseBtn.x=(l.mBackground.displayWidth+l.mIncreaseBtn.displayWidth)/2+7*o,l.mLabelInput=new a.LabelInput(l.scene,{x:0,y:0,width:l.mBackground.height,height:26*o,fontSize:14*o+"px",color:"#666666",align:"center",type:"number"}),l.mLabelInput.setOrigin(.5),l.mLabelInput.setText("1"),l.mLabelInput.on("textchange",l.onTextChangeHandler,l),l.mLabelInput.on("blur",l.onTextBlurHandler,l),l.mLabelInput.on("focus",l.onFocusHandler,l),l.add([l.mBackground,l.mLabelInput,l.mReduceBtn,l.mIncreaseBtn]),l.setSize(l.mIncreaseBtn.displayWidth+l.mReduceBtn.displayWidth+l.mBackground.displayWidth+14*o,l.mBackground.displayHeight),l}return s(NumberCounter,t),NumberCounter.prototype.resize=function(){},NumberCounter.prototype.setMinNumber=function(t){this.mMinNum=t},NumberCounter.prototype.setMaxNumber=function(t){this.mMaxNum=t},NumberCounter.prototype.addActionListener=function(){this.mIncreaseBtn.on("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.on("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.on("pointerup",this.onReduceHandler,this),this.mReduceBtn.on("pointerdown",this.onReduceDownHandler,this)},NumberCounter.prototype.removeActionListener=function(){this.mIncreaseBtn.off("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.off("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.off("pointerup",this.onReduceHandler,this),this.mReduceBtn.off("pointerdown",this.onReduceDownHandler,this),this.scene&&this.scene.input.off("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.setCounter=function(t){(isNaN(t)||t<0)&&(t=0),t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t)},NumberCounter.prototype.setBlur=function(){this.mLabelInput.setBlur()},NumberCounter.prototype.destroy=function(){this.removeActionListener(),t.prototype.destroy.call(this)},Object.defineProperty(NumberCounter.prototype,"number",{get:function(){return parseInt(this.mLabelInput.text,10)},enumerable:!1,configurable:!0}),NumberCounter.prototype.onReduceHandler=function(){var t=parseInt(this.mLabelInput.text,10);--t<this.mMinNum&&(t=this.mMinNum),this.setCounter(t),this.clearTween()},NumberCounter.prototype.onIncreaseHandler=function(){var t=parseInt(this.mLabelInput.text,10);this.setCounter(++t),this.clearTween()},NumberCounter.prototype.onTextChangeHandler=function(){this.setCounter(parseInt(this.mLabelInput.text,10))},NumberCounter.prototype.onTextBlurHandler=function(){var t=parseInt(this.mLabelInput.text,0);t<this.mMinNum?t=this.mMinNum:t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t)},NumberCounter.prototype.onReduceDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMinNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.onIncreaseDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMaxNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.delayTweenNumber=function(t){var e=this,i=this.number;this.tween=this.scene.tweens.addCounter({from:i,to:t,onUpdate:function(){e.setCounter(e.tween.getValue()>>0)},duration:50*Math.abs(i-t)})},NumberCounter.prototype.clearTween=function(){clearTimeout(this.pressTimeout),this.tween&&(this.tween.stop(),this.tween=void 0)},NumberCounter.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this,t)||(this.mLabelInput.setBlur(),this.scene.input.off("pointerdown",this.pointerDownHandler,this))},NumberCounter.prototype.onFocusHandler=function(){this.scene.input.on("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.checkPointerInBounds=function(t,e,i){void 0===i&&(i=!1),this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var n=this.zoom?this.zoom:1;if(this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,e){var a=t.getWorldTransformMatrix(),s=(e.x-a.tx)/n,o=(e.y-a.ty)/n;return this.mRectangle.left<=s&&this.mRectangle.right>=s&&this.mRectangle.top<=o&&this.mRectangle.bottom>=o}return!1},NumberCounter}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"MarketItem",(function(){return l}));var n,a=i(479),s=i(0),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function MarketItem(e,i,n,h,l){var c=t.call(this,e,i,n)||this;c.zoom=1,c.dpr=h,c.zoom=l,c.mBackground=c.scene.make.image({key:s.ModuleName.PICAMARKET_NAME,frame:"border"},!1).setOrigin(0),c.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mBorder=c.scene.make.image({x:3*h,y:3*h,key:s.ModuleName.PICAMARKET_NAME,frame:"item_border"},!1).setOrigin(0),c.mBorder.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mPropImage=new a.DynamicImage(e,0,0),c.mPropImage.scale=c.dpr/c.zoom,c.mNickName=c.scene.make.text({x:62*c.dpr,y:6*c.dpr,style:{fontSize:13*c.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#3399cc"}},!1),c.mCoinIcon=c.scene.make.image({x:45*c.dpr,y:40*c.dpr,key:s.ModuleName.PICAMARKET_NAME},!1).setOrigin(0);var p=c.scene.make.image({x:62*c.dpr,y:39*c.dpr,key:s.ModuleName.PICAMARKET_NAME,frame:"price_border"},!1).setOrigin(0);return c.mPriceText=c.scene.make.text({x:92*c.dpr,y:49*c.dpr,style:{fontSize:13*c.dpr,fontFamily:o.Font.NUMBER,color:"#996600"}}).setOrigin(.5),c.mTagIcon=c.scene.make.image({key:s.ModuleName.PICAMARKET_NAME,frame:"tip_red",x:-86*c.dpr,y:-34*c.dpr},!1).setOrigin(0),c.add([c.mBackground,c.mBorder,c.mPropImage,c.mNickName,p,c.mCoinIcon,c.mPriceText]),c.setSize(c.mBackground.displayWidth,c.mBackground.displayHeight),c}return h(MarketItem,t),MarketItem.prototype.setProp=function(t){if(this.mProp=t,t.icon){var e=o.Url.getOsdRes(t.icon);this.mPropImage.load(e,this,this.onPropLoadComplete)}else o.Logger.getInstance().error(t.name+" : "+t.id+" icon value is empty");this.mPropImage.x=this.mBorder.x+this.mBorder.displayWidth/2,this.mPropImage.y=this.mBorder.y+this.mBorder.displayHeight/2;var i=t.shortName||t.name;if(i.length>4)for(var n=50*this.dpr,a=4;a<i.length;a++){var s=i.slice(0,a);if(this.mNickName.setText(s).width>n){i=s+="...";break}}this.mNickName.setText(i),this.mPriceText.setText(t.price[0].price.toString());var h=o.Coin.getIcon(t.price[0].coinType);this.mCoinIcon.setFrame(h)},MarketItem.prototype.onPropLoadComplete=function(){if(this.mPropImage){var t=this.mPropImage.texture;t&&t.setFilter(Phaser.Textures.FilterMode.LINEAR)}},MarketItem.prototype.onPointerUpHandler=function(){this.emit("select",this.mProp)},MarketItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewActivityPanel",(function(){return h}));var n,a=i(6),s=i(21),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaNewActivityPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.listPosY=[],o.isFold=!1,o.setSize(i,n),o.dpr=s,o.key=a,o.init(),o}return o(PicaNewActivityPanel,t),PicaNewActivityPanel.prototype.init=function(){var t=new a.Button(this.scene,s.d.iconcommon,"home_activity","home_activity");t.y=.5*-this.height+.5*t.height,this.activityButton=t,this.activityButton.on(a.ClickEvent.Tap,this.onActivityHandler,this);var e=new a.Button(this.scene,s.d.iconcommon,"home_indent","home_indent");e.y=t.y+.5*t.height+15*this.dpr+.5*e.height,this.indentButton=e,this.indentButton.on(a.ClickEvent.Tap,this.onIndentHandler,this);var i=new a.Button(this.scene,s.d.iconcommon,"home_recharge","home_recharge");i.y=e.y+.5*e.height+15*this.dpr+.5*i.height,this.rechargeButton=i,this.rechargeButton.on(a.ClickEvent.Tap,this.onRechargeHandler,this);var n=new a.Button(this.scene,s.d.iconcommon,"home_email","home_email");n.y=i.y+.5*i.height+15*this.dpr+.5*n.height,this.emailButton=n,this.emailButton.on(a.ClickEvent.Tap,this.onEmailHandler,this),this.roamButton=new a.Button(this.scene,s.d.iconcommon,"home_roam","home_roam"),this.roamButton.y=t.y,this.roamButton.x=t.x-.5*this.roamButton.width-.5*t.width-15*this.dpr,this.roamButton.on(a.ClickEvent.Tap,this.onRoamHandler,this),this.arrowButton=new a.Button(this.scene,s.d.uicommon,"home_more_2","home_more_2"),this.arrowButton.y=n.y+.5*n.height+10*this.dpr+.5*this.arrowButton.height,this.arrowButton.on(a.ClickEvent.Tap,this.onArrowHandler,this),this.listBtns=[t,e,i,n],this.listBtns2=[this.roamButton],this.listPosY=[t.y,e.y,i.y,n.y],this.add(this.listBtns),this.add(this.listBtns2),this.add(this.arrowButton)},PicaNewActivityPanel.prototype.addListen=function(){this.indentButton.on(a.ClickEvent.Tap,this.onIndentHandler,this),this.rechargeButton.on(a.ClickEvent.Tap,this.onRechargeHandler,this),this.emailButton.on(a.ClickEvent.Tap,this.onEmailHandler,this)},PicaNewActivityPanel.prototype.removeListen=function(){this.indentButton.off(a.ClickEvent.Tap,this.onIndentHandler,this),this.rechargeButton.off(a.ClickEvent.Tap,this.onRechargeHandler,this),this.emailButton.off(a.ClickEvent.Tap,this.onEmailHandler,this)},PicaNewActivityPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewActivityPanel.prototype.onActivityHandler=function(){this.sendHandler&&this.sendHandler.runWith(["activity"])},PicaNewActivityPanel.prototype.onIndentHandler=function(){this.sendHandler&&this.sendHandler.runWith(["indent"])},PicaNewActivityPanel.prototype.onRechargeHandler=function(){this.sendHandler&&this.sendHandler.runWith(["recharge"])},PicaNewActivityPanel.prototype.onEmailHandler=function(){this.sendHandler&&this.sendHandler.runWith(["email"])},PicaNewActivityPanel.prototype.onRoamHandler=function(){this.sendHandler&&this.sendHandler.runWith(["roam"])},PicaNewActivityPanel.prototype.onArrowHandler=function(){this.isFold=!this.isFold,this.isFold?this.foldButtons():this.unfoldButtons()},PicaNewActivityPanel.prototype.foldButtons=function(){var t=this,e=this.listPosY[this.listPosY.length-1],i=this.listPosY[0],n=this.scene.tweens.addCounter({from:e,to:i,ease:"Linear",duration:150,onUpdate:function(e,i){t.updateAllButtons(i.value)},onComplete:function(){n.stop(),n.remove(),t.arrowButton.setFrameNormal("home_more_1"),t.removeListen()}})},PicaNewActivityPanel.prototype.unfoldButtons=function(){var t=this,e=this.listPosY[0],i=this.listPosY[this.listPosY.length-1],n=this.scene.tweens.addCounter({from:e,to:i,ease:"Linear",duration:150,onUpdate:function(e,i){t.updateAllButtons(i.value)},onComplete:function(){n.stop(),n.remove(),t.arrowButton.setFrameNormal("home_more_2"),t.addListen()}})},PicaNewActivityPanel.prototype.updateAllButtons=function(t){this.updateButtons(t,this.listBtns),this.updateButtons(t,this.listBtns2);var e=this.listBtns[this.listBtns.length-1];this.arrowButton.y=e.y+.5*e.height+10*this.dpr+.5*this.arrowButton.height,e.y===this.listPosY[0]?this.listBtns2[0].visible=!1:this.listBtns2[0].visible=!0},PicaNewActivityPanel.prototype.updateButtons=function(t,e){for(var i=this.listPosY[0],n=this.listPosY[this.listPosY.length-1]-t,a=1;a<e.length;a++){var s=e[a],o=this.listPosY[a]-n;s.y=o;var h=this.listPosY[a];o>h&&(o=h),o<i&&(o=i);var l=(o-i)/(.5*s.height);l=(l=l<0?0:l)>1?1:l,s.alpha=l,s.y=o}},PicaNewActivityPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewChatPanel",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function PicaNewChatPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.setSize(i,n),o.dpr=s,o.key=a,o}return a(PicaNewChatPanel,t),PicaNewChatPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewHeadPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaNewHeadPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.money=0,o.diamond=0,o.praise=!1,o.isself=!1,o.setSize(i,n),o.dpr=s,o.key=a,o.init(),o}return l(PicaNewHeadPanel,t),PicaNewHeadPanel.prototype.init=function(){this.headCon=this.scene.make.container(void 0,!1),this.moneyCon=this.scene.make.container(void 0,!1),this.sceneCon=this.scene.make.container(void 0,!1),this.add([this.headCon,this.sceneCon]);var t=this.scene.make.image({x:0,y:0,key:o.d.iconcommon,frame:"home_head_bg"},!1),e=new s.ButtonEventDispatcher(this.scene,0,0);e.setSize(40*this.dpr,40*this.dpr),e.enable=!0,e.on(a.ClickEvent.Tap,this.onHeadHandler,this);var i=this.scene.make.image({x:0,y:10*this.dpr,key:o.d.iconcommon,frame:"home_vip_mark"},!1);this.levelTex=this.scene.make.text({x:0,y:0,text:"",style:{color:"#0089D3",fontSize:14*this.dpr,fontFamily:h.Font.NUMBER}}).setStroke("#ffffff",2*this.dpr).setFontStyle("bold").setOrigin(.5),this.powerPro=new s.ProgressMaskBar(this.scene,o.d.uicommon,"home_progress_bottom","strength_progress",void 0,{width:41*this.dpr,height:11*this.dpr,left:4*this.dpr,right:4*this.dpr,top:0,bottom:0}),this.powerPro.x=0,this.powerPro.y=.5*t.height+.5*this.powerPro.height-4*this.dpr,this.powerTex=new s.ImageValue(this.scene,43*this.dpr,15*this.dpr,o.d.uicommon,"strength_icon",this.dpr,{color:"#ffffff",fontSize:8*this.dpr,fontFamily:h.Font.NUMBER}),this.powerTex.y=this.powerPro.y,this.powerTex.x=-2*this.dpr,this.powerTex.setFontStyle("bold"),this.powerTex.setStroke("#000000",2*this.dpr),this.powerTex.setOffset(-4*this.dpr,0),this.powerTex.setLayout(2),this.powerTex.setText(""),this.powerAddBtn=new a.Button(this.scene,o.d.uicommon,"add_btn","add_btn"),this.powerAddBtn.x=this.powerPro.x+.5*this.powerPro.width+7*this.dpr,this.powerAddBtn.y=this.powerPro.y,this.powerAddBtn.on(a.ClickEvent.Tap,this.onEnergyHandler,this),this.headCon.add([this.powerPro,t,i,this.levelTex,e,this.powerTex,this.powerAddBtn]),this.headCon.x=.5*-this.width+33*this.dpr,this.headCon.y=-2*this.dpr;var n=new a.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,o.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});n.x=.5*-n.width;var l=this.scene.make.image({x:n.x,y:0,key:o.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:h.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=n.x-.5*n.width+22*this.dpr,this.diamondvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_diamond",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:h.Font.NUMBER}),this.diamondvalue.setLayout(1),this.diamondvalue.x=n.x+22*this.dpr,this.moneyAddBtn=new a.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg");var c=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(c),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(a.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon.add([n,l,this.moneyvalue,this.diamondvalue,this.moneyAddBtn]),this.moneyCon.x=.5*this.width-10*this.dpr,this.moneyCon.y=-5*this.dpr;var p=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_persons_bg"},!1);p.x=.5*-p.width,this.peoplebg=p,this.peoplevalue=new s.ImageValue(this.scene,45*this.dpr,27*this.dpr,o.d.uicommon,"home_persons",this.dpr,{color:"#ffffff",fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.peoplevalue.setLayout(2),this.peoplevalue.setText("0"),this.peoplevalue.x=p.x-2*this.dpr;var d=new s.ButtonEventDispatcher(this.scene,0,0);d.setSize(40*this.dpr,40*this.dpr),d.enable=!0,d.on(a.ClickEvent.Tap,this.onOpenOnlineHandler,this),d.x=this.peoplevalue.x;var u=new a.NineSlicePatch(this.scene,0,-this.dpr,50*this.dpr,27*this.dpr,o.d.uicommon,"home_mapname_bg",{left:16*this.dpr,top:0*this.dpr,right:16*this.dpr,bottom:0*this.dpr},this.dpr,this.scale,0);u.x=-p.width-15*this.dpr-.5*u.width,this.sceneTex=this.scene.make.text({x:u.x-10*this.dpr,y:0,text:"",style:{color:"#FFF449",fontSize:11*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5),this.praisebg=u,this.praiseButton=new a.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg"),this.praiseImg=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_praise"},!1),this.praiseButton.add(this.praiseImg),this.praiseButton.x=-p.width-29*this.dpr,this.praiseButton.y=0,this.praiseButton.visible=!1;var m=new s.ButtonEventDispatcher(this.scene,0,0);m.setSize(100*this.dpr,30*this.dpr),m.enable=!0,m.on(a.ClickEvent.Tap,this.onOpenHouseHandler,this),m.x=u.x,this.sceneCon.add([p,this.peoplevalue,d,u,this.sceneTex,m,this.praiseButton]),this.sceneCon.x=.5*this.width-10*this.dpr,this.sceneCon.y=-5*this.dpr},PicaNewHeadPanel.prototype.setHeadData=function(t,e,i,n){t&&(this.levelTex.text=t.value+""),e&&(this.powerTex.setText(e.value+"/"+e.max),this.powerPro.setProgress(e.value,e.max)),i=i||0,this.moneyvalue.setText(i+""),n=n||0,this.diamondvalue.setText(n+""),this.money===i&&this.diamond===n||this.moveMoneyCon(),this.money=i,this.diamond=n},PicaNewHeadPanel.prototype.setSceneData=function(t,e,i,n,s){var o;(void 0===s&&(s=!1),this.sceneTex.text=t,this.praise=e,this.isself=s,this.peoplevalue.setText(i+""),this.praiseButton.off(a.ClickEvent.Tap,this.onPraiseHandler,this),this.canPraise(n))?(this.praiseButton.visible=!0,this.praiseButton.on(a.ClickEvent.Tap,this.onPraiseHandler,this),s?this.praiseImg.setFrame("home_set"):this.praiseImg.setFrame(e?"home_praise_1":"home_praise"),o=(o=this.sceneTex.width+40*this.dpr)<60*this.dpr?60*this.dpr:o,this.praisebg.resize(o,25*this.dpr),this.praisebg.x=-this.peoplebg.width-15*this.dpr-.5*this.praisebg.width,this.sceneTex.x=this.praisebg.x-11*this.dpr):(o=(o=this.sceneTex.width+20*this.dpr)<40*this.dpr?40*this.dpr:o,this.praisebg.resize(o,25*this.dpr),this.praiseButton.visible=!1,this.praisebg.x=-this.peoplebg.width-15*this.dpr-.5*this.praisebg.width,this.sceneTex.x=this.praisebg.x)},PicaNewHeadPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewHeadPanel.prototype.onHeadHandler=function(){this.sendHandler&&this.sendHandler.runWith(["head"])},PicaNewHeadPanel.prototype.onEnergyHandler=function(){this.sendHandler&&this.sendHandler.runWith(["energy"])},PicaNewHeadPanel.prototype.onPraiseHandler=function(){this.isself?this.sendHandler&&this.sendHandler.runWith(["party"]):this.sendHandler&&this.sendHandler.runWith(["praise",!this.praise])},PicaNewHeadPanel.prototype.onRechargeHandler=function(){this.sendHandler&&this.sendHandler.runWith(["recharge"])},PicaNewHeadPanel.prototype.onOpenHouseHandler=function(){this.sendHandler&&this.sendHandler.runWith(["room"])},PicaNewHeadPanel.prototype.onOpenOnlineHandler=function(){this.sendHandler&&this.sendHandler.runWith("online")},PicaNewHeadPanel.prototype.moveMoneyCon=function(){var t=this;if(this.scene){var e=this.width+190*this.dpr,i=.5*this.width-10*this.dpr;this.moneyCon.x=e,this.moneyCon.alpha=1,this.add(this.moneyCon),this.clearTween(),this.moneyTween=this.scene.tweens.add({targets:this.moneyCon,x:{from:e,to:i},ease:"Linear",duration:600,onComplete:function(){t.clearTween(),t.fadeOutHeadCon()}})}},PicaNewHeadPanel.prototype.fadeOutHeadCon=function(){var t=this;this.scene&&(this.moneyTween=this.scene.tweens.add({targets:this.moneyCon,alpha:{from:1,to:.2},ease:"Linear",duration:150,delay:3e3,onComplete:function(){t.clearTween(),t.remove(t.moneyCon)}}))},PicaNewHeadPanel.prototype.canPraise=function(t){return"room"===t||"store"===t},PicaNewHeadPanel.prototype.clearTween=function(){this.moneyTween&&(this.moneyTween.stop(),this.moneyTween.remove(),this.moneyTween=void 0)},PicaNewHeadPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewLeftPanel",(function(){return h}));var n,a=i(6),s=i(21),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function PicaNewLeftPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.setSize(i,n),o.dpr=s,o.key=a,o.init(),o}return o(PicaNewLeftPanel,t),PicaNewLeftPanel.prototype.init=function(){var t=new a.Button(this.scene,s.d.iconcommon,"home_map","home_map");t.y=.5*-this.height+.5*t.height,t.on(a.ClickEvent.Tap,this.onMapButtonHandler,this);var e=new a.Button(this.scene,s.d.iconcommon,"home_task","home_task");e.y=t.y+.5*t.height+20*this.dpr+.5*e.height,e.on(a.ClickEvent.Tap,this.onTaskButtonHandler,this),this.add([t,e])},PicaNewLeftPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaNewLeftPanel.prototype.onMapButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith(["maphome"])},PicaNewLeftPanel.prototype.onTaskButtonHandler=function(){this.sendHandler&&this.sendHandler.runWith(["task"])},PicaNewLeftPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOpenPartyCreatePanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(2),h=i(21),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaOpenPartyCreatePanel(e,i,n,a,s,o,h,l){var c=t.call(this,e.scene,i,n)||this;return c.uiManager=e,c.itemCount=0,c.expiredTime=0,c.key=o,c.dpr=h,c.render=e.render,c.zoom=l,c.setSize(a,s),c.create(),c}return c(PicaOpenPartyCreatePanel,t),PicaOpenPartyCreatePanel.prototype.resize=function(){this.gamegride&&this.gamegride.resetMask()},PicaOpenPartyCreatePanel.prototype.hide=function(){this.visible=!1,this.changeInputState(!1)},PicaOpenPartyCreatePanel.prototype.show=function(){this.visible=!0,this.changeInputState(!0)},PicaOpenPartyCreatePanel.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.timer&&this.timer.clear()},PicaOpenPartyCreatePanel.prototype.setPartyData=function(t,e,i){this.partyData=t,this.setPartyInfoType(!t.created);var n,a=t.ticketsCount,s=t.topics;if(this.timeSlider.setValue(0,0,1),this.partyTimevalue.text="x"+a,t.created?(this.mNameInput.text=t.name,this.describleInput.text=t.des,this.setExpiredValue(t.expired,i)):(this.mNameInput.text=o.i18n.t("party.defaultname",{name:e}),this.describleInput.text=o.i18n.t("party.describletitle")),this.gamegride.setItems(s),t.created){for(var h=t.topics,l=0,c=0,p=h;c<p.length;c++){var d=p[c];if(d.key===t.topic.key){n=d;break}l++}this.gamegride.setT(l/h.length),n=this.gamegride.getCell(l)}else n=this.gamegride.getCell(0);n&&n.container&&this.onGridTableHandler(n.container)},PicaOpenPartyCreatePanel.prototype.setExpiredValue=function(t,e){var i=this;this.expiredTime=t;var n=t-e;n<0?this.timer&&this.timer.clear():(this.timer||(this.timer=new l.TimerCountDown(new o.Handler(this,(function(t,e){i.overageValue.text=e,t<=0&&i.emit("querytheme")})))),this.timer.execute(n))},PicaOpenPartyCreatePanel.prototype.setPartyInfoType=function(t){t?(this.partyNameTitle.text="[b]"+o.i18n.t("party.partyname")+"[/b]",this.partyThemeTitle.text="[b]"+o.i18n.t("party.partytheme")+"[/b]",this.describleTitle.text="[b]"+o.i18n.t("party.partydescrible")+"[/b]",this.partyTimeTitle.text="[b]"+o.i18n.t("party.partytime")+"[/b]",this.overageTitle.visible=!1,this.overageValue.visible=!1,this.partyTimeTitle.y=this.describleTitle.y+70*this.dpr,this.timeSlider.y=this.partyTimeTitle.y,this.openBtn.setText(o.i18n.t("party.partyopen"))):(this.partyNameTitle.text="[b]"+o.i18n.t("party.modifyname")+"[/b]",this.partyThemeTitle.text="[b]"+o.i18n.t("party.modifytheme")+"[/b]",this.describleTitle.text="[b]"+o.i18n.t("party.modifydescrible")+"[/b]",this.partyTimeTitle.text="[b]"+o.i18n.t("party.suppletime")+"[/b]",this.overageTitle.visible=!0,this.overageValue.visible=!0,this.partyTimeTitle.y=this.overageValue.y+45*this.dpr,this.timeSlider.y=this.partyTimeTitle.y,this.openBtn.setText(o.i18n.t("common.confirm"))),this.partyTimeLable.y=this.partyTimeTitle.y+34*this.dpr,this.partyCardImage.y=this.partyTimeLable.y,this.partyTimevalue.y=this.partyTimeLable.y},PicaOpenPartyCreatePanel.prototype.changeInputState=function(t){this.describleInput.visible=t,this.describleInput.node.style.display=t?"true":"none",this.mNameInput.visible=t,this.mNameInput.node.style.display=t?"true":"none",t?this.openBtn.on(String(a.ClickEvent.Tap),this.onOpenPartyHandler,this):this.openBtn.off(String(a.ClickEvent.Tap),this.onOpenPartyHandler,this)},PicaOpenPartyCreatePanel.prototype.create=function(){var t=this;this.partyNameTitle=new a.BBCodeText(this.scene,.5*-this.width+10*this.dpr,.5*-this.height+10*this.dpr,o.i18n.t("party.partyname"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyNameTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyNameTitle),this.mNameInput=this.createInput(this.partyNameTitle.x+this.partyNameTitle.width+13*this.dpr,this.partyNameTitle.y,190*this.dpr,37*this.dpr,13*this.dpr),this.mNameInput.on("textchange",this.onTextChangeHandler,this),this.partyThemeTitle=new a.BBCodeText(this.scene,this.partyNameTitle.x,this.partyNameTitle.y+65*this.dpr,o.i18n.t("party.partytheme"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyThemeTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyThemeTitle);var e={x:30*this.dpr,y:this.partyThemeTitle.y+7*this.dpr,table:{width:200*this.dpr,height:90*this.dpr,columns:1,cellWidth:70*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.zoom,padding:{left:-10*this.dpr}},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(e,i){var n=e.item;return null===i&&(i=new d(t.scene,65*t.dpr,70*t.dpr,t.key,t.dpr)),i.setThemeData(n),t.curPartyData&&t.curPartyData.key===n.key&&(i.select=!0,t.curSelectItem=i),i}};this.gamegride=new a.GameGridTable(this.scene,e),this.gamegride.layout(),this.gamegride.on("cellTap",this.onGridTableHandler,this),this.add(this.gamegride),this.describleTitle=new a.BBCodeText(this.scene,this.partyThemeTitle.x,this.partyThemeTitle.y+80*this.dpr,o.i18n.t("party.partydescrible"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.describleTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.describleTitle),this.describleInput=this.createInput(this.describleTitle.x+this.describleTitle.width+13*this.dpr,this.describleTitle.y+10*this.dpr,190*this.dpr,52*this.dpr,12*this.dpr,"textarea"),this.overageTitle=new a.BBCodeText(this.scene,this.describleTitle.x,this.describleTitle.y+65*this.dpr,"[b]"+o.i18n.t("party.overagetime")+"[/b]",{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.overageTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.overageTitle),this.overageValue=this.scene.make.text({x:this.overageTitle.x+this.overageTitle.width+30*this.dpr,y:this.overageTitle.y,text:"",style:{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#333333"}}),this.overageValue.setOrigin(0,.5).setResolution(this.dpr),this.add(this.overageValue),this.partyTimeTitle=new a.BBCodeText(this.scene,this.overageTitle.x,this.overageTitle.y+50*this.dpr,o.i18n.t("party.partytime"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyTimeTitle.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyTimeTitle);var i=190*this.dpr,n=4*this.dpr,l=this.partyTimeTitle.x+this.partyTimeTitle.width+10*this.dpr+.5*i;this.createSlider(l,this.partyTimeTitle.y,i,n),this.partyTimeLable=new a.BBCodeText(this.scene,this.partyTimeTitle.x+50*this.dpr,this.partyTimeTitle.y+40*this.dpr,o.i18n.t("party.partycardlabel"),{fontFamily:o.Font.DEFULT_FONT,fontSize:11*this.dpr,color:"#000000"}),this.partyTimeLable.setOrigin(0,.5).setResolution(this.dpr),this.partyTimeLable.x=.5*-this.partyTimeLable.width-20*this.dpr,this.add(this.partyTimeLable),this.partyCardImage=new s.DynamicImage(this.scene,0,this.partyTimeLable.y),this.partyCardImage.setTexture(this.key,"party_card"),this.partyCardImage.x=this.partyTimeLable.x+this.partyTimeLable.width+.5*this.partyCardImage.width,this.add(this.partyCardImage),this.partyTimevalue=this.scene.make.text({x:this.partyCardImage.x+.5*this.partyCardImage.width+2*this.dpr,y:this.partyCardImage.y,text:"",style:{fontFamily:o.Font.DEFULT_FONT,fontSize:14*this.dpr,color:"#000000"}}),this.partyTimevalue.setOrigin(0,.5).setResolution(this.dpr),this.partyTimevalue.setStroke("#000000",2),this.add(this.partyTimevalue),this.openBtn=new a.NineSliceButton(this.scene,0,.5*this.height+2*this.dpr,100*this.dpr,33*this.dpr,h.c.commonKey,"yellow_btn_normal",o.i18n.t("party.partyopen"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.openBtn.setTextStyle({color:"#996600",fontSize:13*this.dpr,fontFamily:o.Font.DEFULT_FONT}),this.openBtn.setFontStyle("bold"),this.add(this.openBtn)},PicaOpenPartyCreatePanel.prototype.createSlider=function(t,e,i,n){var s=new a.NineSlicePatch(this.scene,0,0,8,7*this.dpr,h.c.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),l=new a.NineSlicePatch(this.scene,0,0,8,7*this.dpr,h.c.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1});this.thumb=this.scene.make.image({key:h.c.common2Key,frame:"block"}),this.thumb.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:12*this.dpr,fontFamily:o.Font.DEFULT_FONT}},!1).setFontStyle("bold").setOrigin(.5),this.timeSlider=new a.GameSlider(this.scene,{x:t,y:e,width:i,height:n,orientation:1,background:s,indicator:l,thumb:this.thumb,offsetX:.5*this.thumb.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.timeSlider.add(this.itemCountText),this.timeSlider.setValue(0),this.add(this.timeSlider)},PicaOpenPartyCreatePanel.prototype.onSliderValueHandler=function(t){var e=this.partyData?this.partyData.ticketsCount:0;this.itemCountText.x=this.thumb.x,this.itemCount=Math.ceil(t*e),this.itemCount>e&&(this.itemCount=e),this.itemCountText.text=this.itemCount+""},PicaOpenPartyCreatePanel.prototype.onTextChangeHandler=function(){var t=170*this.dpr;this.mNameInput.text.length;this.mNameInput.text=o.UIHelper.spliceText(t,this.mNameInput.text,13*this.dpr,this.scene)},PicaOpenPartyCreatePanel.prototype.onOpenPartyHandler=function(){var t=this;if(this.curPartyData){var e=this.curPartyData.key,i=this.mNameInput.text,n=this.describleInput.text,a=this.itemCount,h=this.partyData.created;a>0?(this.describleInput.node.style.display="none",this.describleInput.visible=!1,new s.AlertView(this.uiManager).show({title:o.i18n.t("main_ui.party"),text:h?o.i18n.t("party.modifyconfirm",{count:a}):o.i18n.t("party.openconfirm",{count:a}),oy:302*this.dpr*this.render.uiScale,callback:function(){t.emit("openparty",e,i,n,a,h)},cancelback:function(){t.describleInput.node.style.display="true",t.describleInput.visible=!0}})):h?this.emit("openparty",e,i,n,a,h):this.emit("showtips","PicaNotice",o.i18n.t("party.ticketinsuff"))}},PicaOpenPartyCreatePanel.prototype.onGridTableHandler=function(t){this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0,this.curPartyData=t.partyData,this.curSelectItem=t},PicaOpenPartyCreatePanel.prototype.createInput=function(t,e,i,n,s,h){void 0===h&&(h="text");var l=this.scene.make.graphics(void 0,!1);l.fillStyle(10809331,.66),l.fillRoundedRect(0,.5*-n,i,n,6*this.dpr),l.setPosition(t,e),this.add(l);var c=new a.InputText(this.scene,t+.5*i+8*this.dpr,e,i,n-10*this.dpr,{type:h,placeholder:o.i18n.t("party.partydescrible"),color:"#055C62",fontSize:s+"px"});return this.add(c),c},PicaOpenPartyCreatePanel}(Phaser.GameObjects.Container),d=function(t){function PicPartyThemeItem(e,i,n,a,h){var l=t.call(this,e)||this;return l.dpr=h,l.setSize(i,n),l.selectbg=l.scene.make.image({key:a,frame:"party_selected_bg"}),l.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.icon=new s.DynamicImage(e,0,0),l.icon.setTexture(a,"party_icon_1"),l.value=e.make.text({x:0,y:0,text:"10",style:{color:"#333333",fontSize:11*h,fontFamily:o.Font.DEFULT_FONT}}),l.value.setOrigin(.5,0),l.value.y=.5*l.height-7*h,l.value.setWordWrapWidth(l.width,!0),l.add([l.selectbg,l.icon,l.value]),l.selectbg.visible=!1,l}return c(PicPartyThemeItem,t),PicPartyThemeItem.prototype.setThemeData=function(t){this.selectbg.visible=!1,this.partyData=t,this.value.text=t.name;var e=t.display.texturePath,i=e.lastIndexOf("/"),n=e.slice(i+1,e.length),a=e.slice(0,i+1),s=o.Url.getOsdRes(a+n+"_"+this.dpr+"x.png");this.icon.load(s)},Object.defineProperty(PicPartyThemeItem.prototype,"select",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),PicPartyThemeItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamDrawPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaRoamDrawPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.money=0,o.token=0,o.setSize(i,n),o.dpr=a,o.zoom=s,o.init(),o.setInteractive(),o}return l(PicaRoamDrawPanel,t),PicaRoamDrawPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.setSize(i,n),this.drawProgress.refreshMask()},PicaRoamDrawPanel.prototype.setHandler=function(t){this.send=t},PicaRoamDrawPanel.prototype.init=function(){this.bg=new s.CommonBackground(this.scene,0,0,this.width,this.height,o.d.roam,"roam_bg",7530491);var t=this.scene.make.image({key:"roam_topic"});t.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var e=this.scene.make.image({key:"roam_stripe"});e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),t.y=.5*-this.height+.5*t.height,e.y=.5*-this.height+.5*e.height,this.closeBtn=new a.Button(this.scene,o.d.uicommon,"back_arrow","back_arrow"),this.closeBtn.setPosition(.5*-this.width+21*this.dpr,.5*-this.height+35*this.dpr),this.closeBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this);var i=new a.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,o.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});i.x=.5*-i.width;var n=this.scene.make.image({x:i.x,y:0,key:o.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:h.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=i.x-.5*i.width+22*this.dpr,this.tokenvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,o.d.uicommon,"roam_ordinary_icon",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:h.Font.NUMBER}),this.tokenvalue.setLayout(1),this.tokenvalue.x=i.x+22*this.dpr,this.moneyAddBtn=new a.Button(this.scene,o.d.uicommon,"home_praise_bg","home_praise_bg");var l=this.scene.make.image({x:0,y:0,key:o.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(l),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(a.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon=this.scene.make.container(void 0,!1),this.moneyCon.setSize(i.width,i.height),this.moneyCon.add([i,n,this.moneyvalue,this.tokenvalue,this.moneyAddBtn]),this.moneyCon.x=.5*this.width-20*this.dpr,this.moneyCon.y=this.closeBtn.y;var c=new a.NineSliceButton(this.scene,0,0,76*this.dpr,30*this.dpr,o.d.uicommon,"home_persons_bg",h.i18n.t("roam.previewtex"),this.dpr,this.zoom,{left:20*this.dpr,right:20*this.dpr,top:0,bottom:0});c.setTextStyle(h.UIHelper.whiteStyle(this.dpr)),c.setFontStyle("bold"),c.x=.5*this.width-.5*c.width-15*this.dpr,c.y=this.moneyCon.y+.5*this.moneyCon.height+.5*c.height+15*this.dpr,c.on(a.ClickEvent.Tap,this.onDrawPreviewHandler,this),this.cloudPanel=new m(this.scene,this.width,137*this.dpr,this.dpr),this.cloudPanel.y=.5*this.height-.5*this.cloudPanel.height,this.drawProgress=new p(this.scene,this.dpr,this.zoom),this.drawProgress.setHandler(new h.Handler(this,this.onProgressHandler)),this.drawProgress.y=t.y+.5*t.height-66*this.dpr,this.oneRoamItem=new u(this.scene,this.dpr,this.zoom),this.oneRoamItem.x=.5*-this.oneRoamItem.width-10*this.dpr,this.oneRoamItem.y=.5*this.height-.5*this.oneRoamItem.height-60*this.dpr,this.oneRoamItem.setHandler(new h.Handler(this,this.onRoamDrawHandler,["one"])),this.tenRoamItem=new u(this.scene,this.dpr,this.zoom),this.tenRoamItem.x=-this.oneRoamItem.x,this.tenRoamItem.y=this.oneRoamItem.y,this.tenRoamItem.setHandler(new h.Handler(this,this.onRoamDrawHandler,["ten"])),this.bottomtips=this.scene.make.text({text:h.i18n.t("roam.bottomtips"),style:h.UIHelper.blackStyle(this.dpr,14)}).setOrigin(.5),this.bottomtips.y=.5*this.height-20*this.dpr,this.add([this.bg,e,t,this.closeBtn,this.moneyCon,c,this.cloudPanel,this.drawProgress,this.oneRoamItem,this.tenRoamItem,this.bottomtips]),this.resize()},PicaRoamDrawPanel.prototype.setRoamDatas=function(t){this.poolDatas=t;for(var e=0,i=t;e<i.length;e++){var n=i[e];if(1===n.drawTime)this.oneRoamItem.setRoamData(n);else if(this.tenRoamItem.setRoamData(n),n.diamond)this.drawProgress.visible=!1;else{this.drawProgress.visible=!0;for(var a=0;a<n.progressAward.length;a++){var s=n.progressAward[a];if(!s.received){var o=1e3*n.progressExpireTime-n.unixTime;this.drawProgress.setRoadLvData(n.progress,o,a+1,s);break}}}}},PicaRoamDrawPanel.prototype.setMoneyData=function(t,e,i){var n="home_silver",a="roam_ordinary_icon";"IV0000002"===i&&(n="home_diamond",a="roam_advanced_icon"),this.moneyvalue.setFrameValue(t+"",o.d.uicommon,n),this.tokenvalue.setFrameValue(e+"",o.d.uicommon,a),this.money=t,this.token=e,this.tokenid=i},PicaRoamDrawPanel.prototype.onRoamDrawHandler=function(t,e){if("one"===t){if(e.one=!0,!e.free&&this.token<e.drawTime&&this.money<e.unitPrice*e.drawTime){var i="IV0000002"===this.tokenid?h.i18n.t("coin.diamond"):h.i18n.t("coin.coin"),n=h.i18n.t("roam.moneytips",{name:i});return void(this.send&&this.send.runWith(["notice",n]))}}else if("ten"===t&&(e.one=!1,!e.free&&this.token<e.drawTime)){i="IV0000002"===this.tokenid?h.i18n.t("coin.diamond"):h.i18n.t("coin.coin");var a="IV0000002"===this.tokenid?h.i18n.t("coin.gold"):h.i18n.t("coin.silver"),s=e.drawTime-this.token,o=e.unitPrice*s;if(o<=this.money){n=h.i18n.t("roam.paytips",{name:o+i,count:s,tag:a});this.send&&this.send.runWith(["pay",{tokenID:this.tokenid,id:e.id,value:o,text:n}])}else{n=h.i18n.t("roam.moneytips",{name:i});this.send&&this.send.runWith(["notice",n])}return}this.send&&this.send.runWith(["draw",e])},PicaRoamDrawPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamDrawPanel.prototype.onRechargeHandler=function(){},PicaRoamDrawPanel.prototype.onDrawPreviewHandler=function(){this.send&&this.send.runWith("preview")},PicaRoamDrawPanel.prototype.onProgressHandler=function(t,e){"help"===t||"reward"===t&&this.send&&this.send.runWith(["progressrewards",e])},PicaRoamDrawPanel}(Phaser.GameObjects.Container),p=function(t){function RoamDrawProgress(e,i,n){var a=t.call(this,e)||this;return a.dpr=i,a.zoom=n,a.init(),a}return l(RoamDrawProgress,t),RoamDrawProgress.prototype.refreshMask=function(){this.progreItem.refreshMask()},RoamDrawProgress.prototype.init=function(){var t=this.scene.make.image({key:o.d.roam,frame:"roam_lv_bg"});t.y=0,this.setSize(t.width,t.height),this.progreItem=new d(this.scene,this.dpr,this.zoom),this.progreItem.y=-13*this.dpr,this.progreTex=this.scene.make.text({text:"",style:h.UIHelper.whiteStyle(this.dpr)}).setOrigin(.5),this.progreTex.setFontStyle("bold"),this.progreTex.y=this.progreItem.y,this.roamLevTex=new a.BBCodeText(this.scene,0,0,"",h.UIHelper.blackStyle(this.dpr)).setOrigin(.5),this.roamLevTex.y=.5*t.height+15*this.dpr,this.roamLevHelp=new a.Button(this.scene,o.d.uicommon1,"icon_tips"),this.roamLevHelp.on(a.ClickEvent.Tap,this.onHelpHandler,this),this.roamLevHelp.y=this.roamLevTex.y,this.roamLevHelp.x=this.roamLevTex.x+.5*this.roamLevTex.width+15*this.dpr,this.roamLevTips=this.scene.make.text({text:"",style:h.UIHelper.blackStyle(this.dpr)}).setOrigin(.5),this.roamLevTips.y=this.roamLevTex.y+20*this.dpr,this.resetTimeTex=this.scene.make.text({text:"",style:h.UIHelper.redStyle(this.dpr,8)}).setOrigin(.5),this.resetTimeTex.setStroke("#ffffff",this.dpr),this.resetTimeTex.y=20*this.dpr,this.add([t,this.progreItem,this.progreTex,this.roamLevTex,this.roamLevHelp,this.roamLevTips,this.resetTimeTex]),this.on("pointerup",this.onRecivedRewardHandler,this)},RoamDrawProgress.prototype.setRoadLvData=function(t,e,i,n){this.indexed=i,this.expireTime=e,this.roamLevTex.text=h.i18n.t("roam.roamlv",{name:""})+" [color=#FF693A][size="+14*this.dpr+"][b]LV"+i+"[/b][/size][/color]",t=t>n.targetValue?t=n.targetValue:t,this.progreTex.text=t+"/"+n.targetValue,this.progreItem.setProgress(t,n.targetValue),t>=n.targetValue?this.setInteractive():this.disableInteractive(),this.roamLevTips.text=n.rewards[0].des,e>0?(this.resetTimeTex.visible=!0,this.resetTimeTex.text=h.i18n.t("roam.resettips",{name:h.TimeUtils.getDataFormat(e,!1)}),this.loopTimeOut(e)):this.resetTimeTex.visible=!1,this.roamLevHelp.x=this.roamLevTex.x+.5*this.roamLevTex.width+.5*this.roamLevHelp.width+20*this.dpr},RoamDrawProgress.prototype.setHandler=function(t){this.send=t},RoamDrawProgress.prototype.onHelpHandler=function(){this.visible&&this.send&&this.send.runWith("help")},RoamDrawProgress.prototype.onRecivedRewardHandler=function(){this.visible&&this.send&&this.send.runWith(["reward",this.indexed])},RoamDrawProgress.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=1e3)>0?(excute(),e.resetTimeTex.text=h.i18n.t("roam.resettips",{name:h.TimeUtils.getDataFormat(t,!1)})):e.resetTimeTex.visible=!1)}),1e3)};excute()},RoamDrawProgress}(Phaser.GameObjects.Container),d=function(t){function ProgressItem(e,i,n){var a=t.call(this,e)||this;return a.max=1,a.value=0,a.animkey="roamlv1",a.animkey2="roamlv2",a.dpr=i,a.zoom=n,a.init(),a}return l(ProgressItem,t),ProgressItem.prototype.init=function(){this.progreimg=this.scene.make.image({key:o.d.roam,frame:"roam_lv"}),this.setSize(this.progreimg.width,this.progreimg.height),this.sprite=this.createSprite(o.d.roam,this.animkey,"roam_lv_1_",[1,6],9,-1),this.sprite2=this.createSprite(o.d.roam,this.animkey2,"roam_lv_2_",[1,6],9,-1),this.graphic=this.scene.make.graphics(void 0,!1),this.graphic.clear(),this.graphic.fillStyle(16695063,1),this.graphic.fillRect(.5*-this.width,0,this.width,this.height),this.imgMask=this.scene.make.image({key:o.d.roam,frame:"roam_lv"}),this.mask=new Phaser.Display.Masks.BitmapMask(this.scene,this.imgMask),this.add([this.progreimg,this.graphic,this.sprite,this.sprite2])},ProgressItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.imgMask.destroy(!0)},ProgressItem.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.imgMask.x=t.tx,this.imgMask.y=t.ty},ProgressItem.prototype.setProgress=function(t,e){this.value=t,this.max=e;var i=t/e*this.height,n=.5*this.height-i;this.sprite.y=n,this.sprite2.y=n,this.graphic.y=n+7*this.dpr,t>=e?(this.progreimg.visible=!0,this.sprite.visible=!1,this.sprite2.visible=!1,this.graphic.visible=!1):(this.progreimg.visible=!1,this.sprite.visible=!0,this.sprite2.visible=!0,this.graphic.visible=!0)},ProgressItem.prototype.createSprite=function(t,e,i,n,a,s){void 0===a&&(a=30),void 0===s&&(s=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:a,repeat:s}),o.play(e),o},ProgressItem}(Phaser.GameObjects.Container),u=function(t){function RoamDrawItem(e,i,n){var l=t.call(this,e)||this;return l.dpr=i,l.zoom=n,l.setSize(158*i,77*i),l.drawTips=l.scene.make.text({x:0,y:.5*-l.height+5*i,text:"",style:h.UIHelper.blackStyle(i)}).setOrigin(.5),l.drawButton=new s.BackgroundScaleButton(l.scene,158*i,65*l.dpr,o.d.roam,"roam_butt_one","roam_butt_one_1",void 0,l.dpr,1,!1),l.drawButton.on(a.ClickEvent.Tap,l.onButtonHandler,l),l.drawButton.y=15*i,l.add([l.drawTips,l.drawButton]),l}return l(RoamDrawItem,t),RoamDrawItem.prototype.setHandler=function(t){this.send=t},RoamDrawItem.prototype.setRoamData=function(t){this.roamData=t;var e=1===t.drawTime?"roam_butt_one":"roam_butt_ten",i=1===t.drawTime?"roam_butt_one_1":"roam_butt_ten_1";if("IV0000002"===t.tokenId&&(e=1===t.drawTime?"roam_diamond_butt_one":"roam_diamond_butt_ten",i=1===t.drawTime?"roam_diamond_butt_one_1":"roam_diamond_butt_ten_1"),this.drawButton.setFrameNormal(e,i),t.free)this.drawTips.text=h.i18n.t("roam.drawfreetips"),this.drawTips.visible=!0;else if(void 0!==t.nextFreeTime){var n=1e3*t.nextFreeTime-t.unixTime;n>0?(this.drawTips.visible=!0,this.drawTips.text=h.i18n.t("roam.endtips",{name:h.TimeUtils.getDataFormat(n,!1)}),this.loopTimeOut(n)):(this.drawTips.visible=!0,this.drawTips.text=h.i18n.t("roam.drawfreetips"))}else this.drawTips.visible=!1},RoamDrawItem.prototype.onButtonHandler=function(){this.send&&this.send.runWith(this.roamData)},RoamDrawItem.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=1e3)>0?(e.drawTips.text=h.i18n.t("roam.endtips",{name:h.TimeUtils.getDataFormat(t,!1)}),excute()):(e.drawTips.text=h.i18n.t("roam.drawfreetips"),e.roamData.free=!0))}),1e3)};excute()},RoamDrawItem}(Phaser.GameObjects.Container),m=function(t){function CloudDisplayItem(e,i,n,a){var s=t.call(this,e)||this;return s.dpr=a,s.setSize(i,n),s.init(),s}return l(CloudDisplayItem,t),CloudDisplayItem.prototype.init=function(){var t=.5*this.height;this.left_in=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_3"}),this.left_in.x=.5*-this.width+this.left_in.width,this.left_in.y=t-.5*this.left_in.height-23*this.dpr,this.center=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_center"}),this.center.y=t-.5*this.center.height,this.right_in=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_left_2"}),this.right_in.x=.5*this.width-.5*this.right_in.width-7*this.dpr,this.right_in.y=t-.5*this.right_in.height-30*this.dpr,this.left_out=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_2"}),this.left_out.x=.5*-this.width+.5*this.left_out.width,this.left_out.y=t-.5*this.left_out.height,this.right_out=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_left_1"}),this.right_out.x=.5*this.width-.5*this.right_out.width,this.right_out.y=t-.5*this.right_out.height,this.right_out_2=this.scene.make.image({key:o.d.roam,frame:"rome_cloud_right_1"}),this.right_out_2.x=.5*-this.width+.5*this.right_out_2.width+48*this.dpr,this.right_out_2.y=t-.5*this.right_out_2.height,this.add([this.left_in,this.center,this.right_in,this.left_out,this.right_out,this.right_out_2])},CloudDisplayItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamListPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaRoamListPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.poolsStatus=new Map,o.setSize(i,n),o.dpr=a,o.zoom=s,o.init(),o}return l(PicaRoamListPanel,t),PicaRoamListPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.setSize(i,n),this.mGameGrid.resetMask()},PicaRoamListPanel.prototype.setHandler=function(t){this.send=t},PicaRoamListPanel.prototype.init=function(){var t=this,e=340*this.dpr,i=455*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add(this.content),this.bg=new a.NineSlicePatch(this.scene,0,0,e,i,o.d.uicommon1,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var n=.5*-i;this.titlebg=this.scene.make.image({x:0,y:0,key:o.d.uicommon1,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+3*this.dpr,this.titleTex=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:h.i18n.t("roam.title"),style:h.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.setResolution(this.dpr),this.closeBtn=new a.Button(this.scene,o.d.uicommon,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.closeBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this);var s={x:0,y:10*this.dpr,table:{width:e-10*this.dpr,height:i-50*this.dpr,columns:1,cellWidth:e-10*this.dpr,cellHeight:120*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=t.mGameGrid.items.length-e.index,a=e.item;return null===i&&(i=new p(t.scene,t.dpr,t.zoom)),i.setRoamData(a,n),i}};this.mGameGrid=new a.GameGridTable(this.scene,s),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(e){t.onSelectItemHandler(e.roamData)})),this.content.add([this.bg,this.titlebg,this.titleTex,this.closeBtn,this.mGameGrid]),this.resize()},PicaRoamListPanel.prototype.setRoamDataList=function(t){this.poolsStatus.clear();for(var e=0,i=t;e<i.length;e++){var n=i[e];if(this.poolsStatus.has(n.tokenId)){(a=this.poolsStatus.get(n.tokenId)).push(n)}else{var a=[n];this.poolsStatus.set(n.tokenId,a)}}var s=[];this.poolsStatus.forEach((function(t){s.push(t[0])})),this.mGameGrid.setItems(s),this.mGameGrid.setT(0)},PicaRoamListPanel.prototype.getRoamTokenDatas=function(){return this.poolsStatus.get(this.tokenId)},PicaRoamListPanel.prototype.onSelectItemHandler=function(t){this.tokenId=t.tokenId,this.send&&this.send.runWith(["roam",this.poolsStatus.get(t.tokenId)])},PicaRoamListPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamListPanel}(Phaser.GameObjects.Container),p=function(t){function RoamItem(e,i,n){var l=t.call(this,e)||this;l.dpr=i,l.zoom=n,l.setSize(302*i,110*i),l.bg=new a.NineSlicePatch(e,0,0,l.width,l.height,o.d.roam,"roam_list_bg",{left:7*i,top:0,right:7*i,bottom:0}),l.dybg=new s.DynamicImage(e,0,0),l.nameTex=l.scene.make.text({x:.5*l.width-20*i,y:-20*i,text:"",style:h.UIHelper.colorStyle("#1F95F8",22*i)}).setOrigin(1,.5),l.nameTex.setPadding(0,0,3*i,0),l.nameTex.setFontStyle("bold italic"),l.nameTex.setStroke("#ffffff",2*i),l.desTex=l.scene.make.text({x:.5*l.width-10*i,y:10*i,text:"",style:h.UIHelper.colorStyle("#FFFD50",22*i)}).setOrigin(.5),l.desTex.setPadding(0,0,3*i,0),l.desTex.setFontStyle("bold italic");var c=l.desTex.context.createLinearGradient(0,0,0,l.desTex.height);return c.addColorStop(0,"#FFFD50"),c.addColorStop(1,"#FAB600"),l.desTex.setFill(c),l.timebg=new a.NineSlicePatch(l.scene,0,0,84*i,32*i,o.d.roam,"roam_countbg",{left:3*i,top:0,right:3*i,bottom:0},0),l.timetips=l.scene.make.text({text:h.i18n.t("roam.timeendtips"),style:h.UIHelper.whiteStyle(i,11)}).setOrigin(.5),l.timeTex=new a.BBCodeText(l.scene,0,0,"",h.UIHelper.blackStyle(i,8)).setOrigin(.5),l.timeTex.setPadding(3*i,3*i,3*i,0),l.timebg.x=.5*-l.width+.5*l.timebg.width+3*i,l.timebg.y=.5*l.height-.5*l.timebg.height-5*i,l.timetips.x=l.timebg.x,l.timetips.y=l.timebg.y-8*i,l.timeTex.x=l.timebg.x,l.timeTex.y=l.timebg.y+10*i,l.add([l.bg,l.dybg,l.nameTex,l.desTex,l.timebg,l.timetips,l.timeTex]),l.desTex.visible=!1,l.nameTex.visible=!1,l}return l(RoamItem,t),RoamItem.prototype.setRoamData=function(t){if(this.roamData=t,"IV0000002"===t.tokenId){this.dybg.setTexture(o.d.roam,"roan_banner_diamond");this.timeTex.text=this.getTimeTex(6048e5),this.loopTimeOut(6048e5),this.timeTex.visible=!0,this.timebg.visible=!0}else this.dybg.setTexture(o.d.roam,"roan_banner_silver"),this.timeTex.visible=!1,this.timebg.visible=!1},RoamItem.prototype.loopTimeOut=function(t){var e=this;this.timer&&(clearTimeout(this.timer),this.timer=void 0);var excute=function(){e.timer=setTimeout((function(){e.scene&&((t-=6e4)<0&&(t=0),e.timeTex.text=e.getTimeTex(t),t>0&&excute())}),6e4)};excute()},RoamItem.prototype.getTimeTex=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60;return 0!==e||0!==i||0!==n?this.timeFormat(e)+h.i18n.t("timeuint.day")+this.timeFormat(i)+h.i18n.t("timeuint.hour")+this.timeFormat(n)+h.i18n.t("timeuint.minutes"):h.i18n.t("roam.timeend")},RoamItem.prototype.timeFormat=function(t){return"[color=#724DF4][size="+14*this.dpr+"][b]"+t+"[/b][/size][/color]"},RoamItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamPreviewPanel",(function(){return l}));var n,a=i(6),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaRoamPreviewPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.poolsStatus=new Map,o.setSize(i,n),o.dpr=a,o.zoom=s,o.setInteractive(),o.init(),o}return h(PicaRoamPreviewPanel,t),PicaRoamPreviewPanel.prototype.resize=function(t,e){var i=t||this.width,n=e||this.height;this.mBackground.clear(),this.mBackground.fillStyle(0,.8),this.mBackground.fillRoundedRect(.5*-i,.5*-n,i,n),this.setSize(i,n),this.mGameGrid.resetMask()},PicaRoamPreviewPanel.prototype.setHandler=function(t){this.send=t},PicaRoamPreviewPanel.prototype.init=function(){var t=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=340*this.dpr,i=455*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add(this.content),this.bg=new a.NineSlicePatch(this.scene,0,0,e,i,s.d.uicommon1,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var n=.5*-i;this.titlebg=this.scene.make.image({x:0,y:0,key:s.d.uicommon1,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+3*this.dpr,this.titleTex=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:o.i18n.t("roam.previewtex"),style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.setResolution(this.dpr),this.closeBtn=new a.Button(this.scene,s.d.uicommon,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.closeBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this);var h={x:0,y:10*this.dpr,table:{width:e-10*this.dpr,height:i-50*this.dpr,columns:1,cellWidth:e-10*this.dpr,cellHeight:38*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=e.index,a=e.item;return null===i&&(i=new c(t.scene,t.dpr,t.zoom)),i.setRoamData(a,n%2==0?0:1),i}};this.mGameGrid=new a.GameGridTable(this.scene,h),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(e){t.onSelectItemHandler(e.roamData)})),this.content.add([this.bg,this.titlebg,this.titleTex,this.closeBtn,this.mGameGrid]),this.resize(),this.loadPreviewJson()},PicaRoamPreviewPanel.prototype.setRoamDrawData=function(t){this.mGameGrid.setItems(t),this.mGameGrid.setT(0)},PicaRoamPreviewPanel.prototype.loadPreviewJson=function(){var t=o.Url.getRes("ui/roampreview/preview.json");this.scene.load.json("roampreview",t),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.loadJsonComplete,this),this.scene.load.start()},PicaRoamPreviewPanel.prototype.loadJsonComplete=function(){if(this.scene.cache.json.has("roampreview")){this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.loadJsonComplete,this);for(var t=this.scene.cache.json.get("roampreview"),e=[],i=0;i<t.length;i+=2){var n=[t[i],t[i+1]];e.push(n)}this.setRoamDrawData(e)}},PicaRoamPreviewPanel.prototype.onSelectItemHandler=function(t){},PicaRoamPreviewPanel.prototype.onCloseHandler=function(){this.send&&this.send.runWith("close")},PicaRoamPreviewPanel}(Phaser.GameObjects.Container),c=function(t){function RoamPreviewItem(e,i,n){var a=t.call(this,e)||this;return a.dpr=i,a.zoom=n,a.setSize(311*i,38*i),a.bg=a.scene.make.image({key:s.d.roam,frame:"roam_preview_list"}),a.bg.displayWidth=a.width,a.leftItem=new p(a.scene,155*i,38*i,i),a.rightItem=new p(a.scene,155*i,38*i,i),a.leftItem.x=.5*-a.leftItem.width,a.rightItem.x=.5*a.leftItem.width,a.add([a.bg,a.leftItem,a.rightItem]),a}return h(RoamPreviewItem,t),RoamPreviewItem.prototype.setRoamData=function(t,e){this.leftItem.setDrawData(t[0]),this.rightItem.setDrawData(t[1]),this.bg.alpha=e},RoamPreviewItem}(Phaser.GameObjects.Container),p=function(t){function PreviewCellItem(e,i,n,a){var s=t.call(this,e)||this;return s.setSize(i,n),s.dpr=a,s.init(),s}return h(PreviewCellItem,t),PreviewCellItem.prototype.init=function(){this.nameTex=this.scene.make.text({text:"",style:o.UIHelper.blackStyle(this.dpr)}).setOrigin(0,.5),this.image=this.scene.make.image({key:s.d.roam,frame:"roam_preview_star_1"}),this.value=this.scene.make.text({text:"",style:o.UIHelper.blackStyle(this.dpr)}).setOrigin(0,.5),this.add([this.nameTex,this.image,this.value])},PreviewCellItem.prototype.setDrawData=function(t){this.nameTex.text=t.name,t.star>0?(this.image.visible=!0,this.image.setFrame("roam_preview_star_"+t.star)):this.image.visible=!1,this.value.text=t.prob+"%",this.nameTex.x=.5*-this.width+15*this.dpr,this.image.x=this.nameTex.x+this.nameTex.width+.5*this.image.width+3*this.dpr,this.value.x=.5*this.width-this.value.width-15*this.dpr},PreviewCellItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskItem",(function(){return d}));var n,a=i(6),s=i(479),o=i(21),h=i(1),l=i(2),c=i(481),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaTaskItem(e,i,n){var h=t.call(this,e)||this;h.mIsExtend=!1,h.zoom=1,h.dpr=i,h.zoom=n;var c=272*i,p=70*i;h.setSize(c,p),h.content=e.make.container(void 0,!1),h.content.setSize(c,p),h.bg=new a.NineSlicePatch(h.scene,0,0,c,p,o.d.uicommon,"task_list_bg",{left:6*i,top:6*i,bottom:6*i,right:6*i});var d=.5*-c,u=e.make.image({key:o.d.uicommon,frame:"task_head_frame"});return u.x=d+25*i,h.headIcon=new s.DynamicImage(e,u.x,0),h.headIcon.scale=i/h.zoom,h.headIcon.y=-10*i,h.taskName=e.make.text({text:"",style:l.UIHelper.whiteStyle(i)}).setOrigin(0,.5),h.taskName.x=h.headIcon.x+28*i,h.taskName.y=.5*-p+15*i,h.taskDes=e.make.text({text:"",style:l.UIHelper.colorStyle("#FFF449",12*i)}).setOrigin(0),h.taskDes.x=h.taskName.x,h.taskDes.y=h.taskName.y+15*i,h.taskButton=new s.ThreeSliceButton(h.scene,62*i,25*i,o.d.uicommon,l.UIHelper.threeYellowSmall,l.UIHelper.threeYellowSmall,l.i18n.t("task.receive")),h.taskButton.setFontStyle("bold"),h.taskButton.x=.5*c-.5*h.taskButton.width-10*i,h.taskButton.on(a.ClickEvent.Tap,h.onTaskButtonHandler,h),h.arrow=h.scene.make.image({key:o.d.uicommon,frame:"task_list_arrow"}),h.arrow.y=.5*p-.5*h.arrow.height,h.content.add([h.bg,u,h.headIcon,h.taskName,h.taskDes,h.taskButton,h.arrow]),h.add(h.content),h.setSize(c,p),h}return p(PicaTaskItem,t),PicaTaskItem.prototype.setTaskData=function(t){this.questData=t,this.taskName.text=t.name+this.getProgressStr(t),this.setTextLimit(this.taskName,this.taskName.text),this.setTextLimit(this.taskDes,t.detail);var e=l.Url.getOsdRes(t.display.texturePath);this.headIcon.load(e,this,(function(){})),t.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING?(this.taskButton.setFrameNormal(l.UIHelper.threeGreenSmall),this.taskButton.setText(l.i18n.t("task.go")),this.taskButton.setTextStyle(l.UIHelper.colorStyle("#022B55",12*this.dpr))):t.stage!==h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&this.questData.stage!==h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END||(this.taskButton.setFrameNormal(l.UIHelper.threeYellowSmall),this.taskButton.setText(l.i18n.t("task.receive")),this.taskButton.setTextStyle(l.UIHelper.brownishStyle(this.dpr)))},PicaTaskItem.prototype.setTaskDetail=function(t){this.mExtend&&this.mExtend.setItemData(t)},PicaTaskItem.prototype.setHandler=function(t){this.send=t},PicaTaskItem.prototype.setExtend=function(t,e){void 0===e&&(e=!0),t?(this.openExtend(),e&&this.send&&this.send.runWith(["extend",{extend:!0,item:this}])):(this.closeExtend(),e&&this.send&&this.send.runWith(["extend",{extend:!1,item:this}]))},Object.defineProperty(PicaTaskItem.prototype,"extend",{get:function(){return this.mIsExtend},enumerable:!1,configurable:!0}),PicaTaskItem.prototype.getProgressStr=function(t){if(t.targets)for(var e=0,i=t.targets;e<i.length;e++){var n=i[e];if(n.neededCount)return" ("+n.count+"/"+n.neededCount+")"}return""},PicaTaskItem.prototype.onTaskButtonHandler=function(){this.questData.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING?this.send&&this.send.runWith(["go",this.questData]):this.questData.stage===h.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&this.send&&this.send.runWith(["finish",this.questData.id])},PicaTaskItem.prototype.openExtend=function(){this.mExtend||(this.mExtend=new u(this.scene,this.width,0,this.dpr,this.zoom),this.mExtend.setHandler(this.send),this.add(this.mExtend)),this.mExtend.setItemData(this.questData),this.mExtend.visible=!0,this.height=this.content.height+this.mExtend.height,this.content.y=.5*-this.height+.5*this.content.height,this.mExtend.y=this.content.y+.5*this.content.height,this.mIsExtend=!0,this.arrow.visible=!1},PicaTaskItem.prototype.closeExtend=function(){this.mExtend&&(this.mExtend.visible=!1),this.height=this.content.height,this.content.y=0,this.mIsExtend=!1,this.arrow.visible=!0},PicaTaskItem.prototype.setTextLimit=function(t,e,i){if(void 0===i&&(i=15),e.length>i)for(var n=155*this.dpr,a=4;a<e.length;a++){var s=e.slice(0,a);if(t.setText(s).width>n){s+="...",t.setText(s);break}}else t.setText(e)},PicaTaskItem}(Phaser.GameObjects.Container),u=function(t){function TaskItemExtend(e,i,n,s,h){var c=t.call(this,e)||this;c.needArr=[],c.rewardArr=[],c.dpr=0,c.zoom=1,c.width=i,c.dpr=s,c.zoom=h,c.bg=new a.NineSlicePatch(c.scene,0,0,i,n,o.d.uicommon,"task_list_unfold_bg",{left:4,top:4,right:4,bottom:4});var p=.5*-i+10*s,d=.5*-n+8*s;c.taskLabel=e.make.text({x:p,y:d,text:l.i18n.t("task.objective"),style:l.UIHelper.colorStyle("#625AC6",12*s)}),c.taskLabel.setFontStyle("bold"),c.taskTex=e.make.text({x:p,y:d+18*s,text:l.i18n.t("task.collect_materials"),style:l.UIHelper.colorStyle("#625AC6",12*s)}),c.taskTex.setWordWrapWidth(i-10*s,!0),c.rewardLabel=e.make.text({x:p,y:d+90*s,text:l.i18n.t("task.rewards"),style:l.UIHelper.colorStyle("#625AC6",12*s)}),c.rewardLabel.setFontStyle("bold");var u=e.make.image({key:o.d.uicommon,frame:"task_reward_divider"});return u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.setPosition(-10*s,d+110*s),c.line=u,c.add([c.bg,c.taskLabel,c.taskTex,c.rewardLabel,u]),c.setSize(i,n),c}return p(TaskItemExtend,t),TaskItemExtend.prototype.setItemData=function(t){var e=0,i=67*this.dpr;this.taskTex.text=this.getTaskTargetText(t),this.createTaskCells(this.needArr,t.targets,!0),e=this.taskTex.y+this.taskTex.height+8*this.dpr,t.targets.length>0&&this.hasTargetWithDisplay(t)&&(e+=.5*i,this.sortItem(this.needArr,e),e+=.5*i+15*this.dpr),this.rewardLabel.y=e,e+=this.rewardLabel.height+5*this.dpr,this.line.y=e,e+=5*this.dpr,this.createTaskCells(this.rewardArr,t.rewards,!1),e+=.5*i,this.sortItem(this.rewardArr,e),this.height=e+.5*i+10*this.dpr,this.bg.resize(this.width,this.height),this.bg.y=.5*this.height},TaskItemExtend.prototype.sortItem=function(t,e){void 0===e&&(e=0);for(var i=.5*-this.width+10*this.dpr,n=t,a=0,s=10*this.dpr,o=0,h=n;o<h.length;o++){var l=h[o];l.x=i+l.width*l.originX+a,l.y=e,a+=l.width+s}},TaskItemExtend.prototype.setHandler=function(t){this.send=t},TaskItemExtend.prototype.createTaskCells=function(t,e,i){void 0===i&&(i=!0);for(var n=0,s=t;n<s.length;n++){(l=s[n]).visible=!1}for(var h=0;h<e.length;h++){var l=void 0;h<t.length?l=t[h]:e[h].texturePath&&((l=new c.ItemButton(this.scene,o.d.uicommon,"bag_icon_common_bg",this.dpr,this.zoom,!0)).on(a.ClickEvent.Tap,this.onTaskCellHandler,this),t.push(l),this.add(l)),l&&(l.visible=!0,l.setItemData(e[h]))}return t},TaskItemExtend.prototype.hasTargetWithDisplay=function(t){for(var e=0,i=t.targets;e<i.length;e++){if(i[e].texturePath)return!0}},TaskItemExtend.prototype.getTaskTargetText=function(t){t.targets;return t.detail+this.getProgressStr(t)},TaskItemExtend.prototype.getProgressStr=function(t){if(t.targets)for(var e=0,i=t.targets;e<i.length;e++){var n=i[e];if(n.neededCount)return" ("+n.count+"/"+n.neededCount+")"}return""},TaskItemExtend.prototype.onTaskCellHandler=function(t,e){this.send&&this.send.runWith(["item",e])},TaskItemExtend}(Phaser.GameObjects.Container);!function(t){function TaskCell(e,i,n){var h=t.call(this,e,0,0)||this;return h.dpr=i,h.zoom=n,h.bg=e.make.image({key:o.d.uicommon,frame:"task_icon_bg"}),h.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.setSize(h.bg.width,h.bg.height),h.itemIcon=new s.DynamicImage(e,0,0),h.itemIcon.scale=h.dpr/h.zoom,h.countTex=new a.BBCodeText(h.scene,0,0,"",l.UIHelper.colorNumberStyle("#ffffff",12*i)).setOrigin(.5).setStroke("#000000",2*i),h.countTex.setPosition(.5*h.width,.5*h.height-2*i),h.add([h.bg,h.itemIcon,h.countTex]),h.enable=!0,h}p(TaskCell,t),TaskCell.prototype.setCellData=function(t,e){void 0===e&&(e=!0),this.itemData=t;var i=e?"task_icon_bg":"task_reward_bg";this.bg.setTexture(o.d.uicommon,i);var n=l.Url.getOsdRes(t.texturePath);this.itemIcon.load(n,this,(function(){})),e?(this.countTex.text=this.getCountText(t.count,t.neededCount),this.countTex.setOrigin(.5),this.countTex.x=0,this.countTex.y=.5*this.height+7*this.dpr):(this.countTex.text="[stroke=#2D2D2D][color=#ffffff]"+t.count+"[/color][/stroke]",this.countTex.x=.5*this.width-2*this.dpr,this.countTex.y=.5*this.height,this.countTex.setOrigin(1,1))},TaskCell.prototype.getCountText=function(t,e){return""+("[color="+(t>=e?"#0054FF":"#FF0000")+"]"+t+"[/color]")+("[color=#2D2D2D]/"+e+"[/color]")}}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskMainPanel",(function(){return u}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=i(1),c=i(534),p=i(536),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaTaskMainPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.taskItems=[],o.isMoveFinish=!1,o.isFinishGroup=!1,o.setSize(i,n),o.dpr=a,o.zoom=s,o.init(),o}return d(PicaTaskMainPanel,t),PicaTaskMainPanel.prototype.setHandler=function(t){this.send=t},PicaTaskMainPanel.prototype.refreshMask=function(){this.gameScroller.refreshMask(),this.mainItem&&this.mainItem.refreshMask()},PicaTaskMainPanel.prototype.setTaskDatas=function(t,e){if(this.curTaskItem&&this.curTaskItem.setExtend(!1),this.mainItem||(this.mainItem=new m(this.scene,272*this.dpr,126*this.dpr,this.dpr,this.zoom),this.gameScroller.addItem(this.mainItem),this.mainItem.setHandler(new h.Handler(this,this.onRewardHandler))),this.mainItem.setMainTaskData(t,e),this.questType!==e){var i=this.getTaskQuests(t.quests,void 0);this.setTaskItems(i);for(var n=[],a=0,s=this.taskItems;a<s.length;a++){(c=s[a]).visible&&n.push(c)}}else{i=this.getTaskQuests(t.quests,this.taskGroupData.quests);this.setTaskItems(i);n=[];for(var o=0,l=this.taskItems;o<l.length;o++){var c;(c=l[o]).visible&&n.push(c)}if(this.isFinishGroup)this.mainTaskAnimation=new f(this.scene,this.mainItem,n,this.width,this.dpr),this.isMoveFinish&&this.mainTaskAnimation.playIntoAnimation(),this.isFinishGroup=!1;else new y(this.scene,n,this.width,this.dpr).playGoOutAnimation()}this.taskGroupData=t,this.questType=e},PicaTaskMainPanel.prototype.setTaskDetail=function(t){this.curTaskItem&&t&&this.curTaskItem.questData.id===t.id&&this.curTaskItem.setTaskDetail(t)},PicaTaskMainPanel.prototype.setTaskItems=function(t){for(var e=0,i=this.taskItems;e<i.length;e++){(a=i[e]).visible=!1}for(var n=0;n<t.length;n++){var a=void 0;n<this.taskItems.length?a=this.taskItems[n]:(a=new c.PicaTaskItem(this.scene,this.dpr,this.zoom),this.gameScroller.addItem(a),a.setHandler(new h.Handler(this,this.onTaskItemHandler)),this.taskItems.push(a)),a.setTaskData(t[n]),a.visible=!0,a.x=0}this.gameScroller.Sort()},PicaTaskMainPanel.prototype.getTaskQuests=function(t,e){for(var i=[],n=0,a=t;n<a.length;n++){var s=a[n];if(s.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING||s.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED)i.push(s);else if(s.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&e)for(var o=0,h=e;o<h.length;o++){var c=h[o];c.id===s.id&&c.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED&&i.push(s)}}return i},PicaTaskMainPanel.prototype.playIntoAnimation=function(){this.mainTaskAnimation&&this.mainTaskAnimation.playIntoAnimation()},PicaTaskMainPanel.prototype.playGoOutAnimation=function(){},PicaTaskMainPanel.prototype.moveFinish=function(){this.isMoveFinish=!0,this.mainTaskAnimation&&this.mainTaskAnimation.playIntoAnimation()},PicaTaskMainPanel.prototype.init=function(){var t=this;this.gameScroller=new a.GameScroller(this.scene,{x:0,y:0*this.dpr,width:this.width,height:this.height,zoom:this.zoom,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,padding:{top:2*this.dpr},selfevent:!0,cellupCallBack:function(e){t.onPointerUpHandler(e)}}),this.itemTips=new s.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.d.uicommon,"tips_bg",this.dpr),this.itemTips.setVisible(!1),this.add([this.gameScroller,this.itemTips])},PicaTaskMainPanel.prototype.onPointerUpHandler=function(t){if(!(t instanceof m)){var e=!t.extend;t.setExtend(e,!0)}},PicaTaskMainPanel.prototype.onTaskItemHandler=function(t,e){if("extend"===t){var i=e.extend,n=e.item;this.onExtendsHandler(i,n)}else"go"===t||("finish"===t?this.send.runWith(["finish",e]):"item"===t&&this.onMaterialItemHandler(e))},PicaTaskMainPanel.prototype.onRewardHandler=function(t){this.send&&this.send.runWith(["reward",t]),this.isFinishGroup=!0},PicaTaskMainPanel.prototype.onExtendsHandler=function(t,e){this.curTaskItem&&this.curTaskItem.setExtend(!1,!1),this.curTaskItem=t?e:null,this.gameScroller.Sort(!0)},PicaTaskMainPanel.prototype.onMaterialItemHandler=function(t){p.PicaItemTipsPanel.Inst.showTips(t,t.itemData)},PicaTaskMainPanel}(Phaser.GameObjects.Container),m=function(t){function MainTaskItem(e,i,n,a,s){var o=t.call(this,e)||this;return o.isFinish=!1,o.dpr=a,o.zoom=s,o.setSize(i,n),o.init(),o}return d(MainTaskItem,t),MainTaskItem.prototype.refreshMask=function(){},MainTaskItem.prototype.setMainTaskData=function(t,e){this.titleTex.text=t.name,this.taskDes.text=t.des;var i=this.getFinishProgress(t);if(this.questType!==e)this.progress.setProgress(i,100);else{var n=this.previousProgress,a=2e3*i/100;this.playProgressTween(n,i,100,a)}this.progressTex.text=i+"%",this.isFinish=100===i,this.previousProgress=i,this.mainData=t;var s=h.Url.getOsdRes(t.reward.texturePath);this.rewardsImg.load(s,this,(function(){}))},MainTaskItem.prototype.setHandler=function(t){this.send=t},MainTaskItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.intervalTimer&&clearInterval(this.intervalTimer)},MainTaskItem.prototype.init=function(){this.bg=new a.NineSlicePatch(this.scene,0,0,this.width,this.height,o.d.uicommon,"task_chapter_bg",{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:8*this.dpr}),this.titleCon=this.scene.make.container(void 0,!1),this.titleCon.y=.5*-this.height+21*this.dpr;var t=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_left"}),e=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_right"}),i=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_title_middle"});i.y=-5*this.dpr,t.x=.5*-i.width-.5*t.width+7*this.dpr,e.x=.5*i.width+.5*e.width-7*this.dpr,this.titleTex=this.scene.make.text({text:"",style:{fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FFF6CA"}}).setOrigin(.5),this.titleTex.setFontStyle("bold"),this.titleTex.y=i.y,this.titleCon.add([t,i,e,this.titleTex]),this.taskDes=this.scene.make.text({x:.5*-this.width+12*this.dpr,y:-2*this.dpr,text:"",style:{fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#8C6003"}}).setOrigin(0,.5),this.taskDes.setWordWrapWidth(160*this.dpr,!0);var n=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_gift_bg"});n.x=.5*this.width-10*this.dpr-.5*n.width,n.y=10*this.dpr;var l=new s.ButtonEventDispatcher(this.scene,0,0);l.setSize(n.width,n.height),l.enable=!0,l.on(a.ClickEvent.Tap,this.onReceiveAwardHandler,this),l.x=n.x,l.y=n.y,this.rewardRotateImg=this.scene.make.image({key:o.d.uicommon,frame:"task_chapter_gift_bg1"}),this.rewardRotateImg.x=n.x,this.rewardRotateImg.y=n.y,this.rewardsImg=new s.DynamicImage(this.scene,0,0),this.rewardsImg.x=n.x,this.rewardsImg.y=n.y,this.rewardsImg.scale=this.dpr/this.zoom;var c={width:153*this.dpr,height:11*this.dpr,correct:0};this.progress=new s.ProgressThreeBar(this.scene,o.d.uicommon,["task_chapter_progress_bott_left","task_chapter_progress_bott_middle","task_chapter_progress_bott_right"],["task_chapter_progress_top_left","task_chapter_progress_top_middle","task_chapter_progress_top_right"],void 0,c,c),this.progress.x=.5*-this.width+.5*this.progress.width+15*this.dpr,this.progress.y=34*this.dpr,this.progressTex=this.scene.make.text({x:this.progress.x,y:this.progress.y+15*this.dpr,text:"",style:{fontSize:12*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#794400"}}).setOrigin(.5),this.add([this.bg,this.titleCon,this.taskDes,this.progress,this.progressTex,n,this.rewardRotateImg,this.rewardsImg,l])},MainTaskItem.prototype.onReceiveAwardHandler=function(){this.isFinish&&!this.mainData.rewardsReceived&&this.send&&this.send.runWith([this.mainData.id])},MainTaskItem.prototype.getFinishProgress=function(t){return t.progress},MainTaskItem.prototype.playProgressTween=function(t,e,i,n){var a=this;if(this.scene)var s=this.scene.tweens.addCounter({from:t,to:e,ease:"Linear",duration:n,onUpdate:function(t,e){if(!a.scene)return s.stop(),void s.remove();var n=e.value;a.progress.setProgress(n,i),a.progressTex.text=Math.floor(1e3*n/i)/10+"%"},onComplete:function(){s.stop(),e===i&&a.playRotateTween()}})},MainTaskItem.prototype.playRotateTween=function(){var t=this;this.scene&&(this.intervalTimer&&clearInterval(this.intervalTimer),this.intervalTimer=setInterval((function(){t.scene?t.rewardRotateImg.rotation+=.1:t.intervalTimer&&clearInterval(t.intervalTimer)}),30))},MainTaskItem}(Phaser.GameObjects.Container),f=function(){function MainTaskAnimation(t,e,i,n,a){this.listPosY=[],this.tempItems=[],this.isDispose=!1,this.indexed=-1,this.scene=t,this.mainItem=e,this.taskItems=i,this.width=n,this.dpr=a,this.setItemLayout()}return MainTaskAnimation.prototype.playIntoAnimation=function(){var t=this;this.mainItem.refreshMask(),this.playMoveX(this.mainItem,this.mainItem.x,0,!1),setTimeout((function(){t.mainItem.refreshMask(),t.playNextAnimation()}),300)},MainTaskAnimation.prototype.dispose=function(){this.tempItems.length=0,this.taskItems.length=0,this.mainItem=void 0,this.taskItems=void 0,this.tempItems=void 0,this.isDispose=!0},MainTaskAnimation.prototype.setItemLayout=function(){this.mainItem.x=-this.width-10*this.dpr;for(var t=0,e=this.taskItems;t<e.length;t++){var i=e[t];i.x=-this.width-10*this.dpr,this.listPosY.push(i.y)}},MainTaskAnimation.prototype.playNextAnimation=function(){if(!this.isDispose&&0!==this.taskItems.length){-1===this.indexed?this.indexed=this.taskItems.length-1:this.indexed--;var t=this.taskItems[this.indexed];t.y=this.listPosY[0],t.alpha=0,this.tempItems.push(t),this.playMoveX(t,t.x,0,!0),this.playAlpha(t,0,1,"Cubic.easeIn")}},MainTaskAnimation.prototype.playMoveX=function(t,e,i,n){var a=this;if(!this.isDispose)var s=this.scene.tweens.add({targets:t,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){s.stop(),s.remove(),n&&(a.indexed>0?a.playMoveY():a.dispose())}})},MainTaskAnimation.prototype.playAlpha=function(t,e,i,n){if(!this.isDispose)var a=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:n,duration:250,onComplete:function(){a.stop(),a.remove()}})},MainTaskAnimation.prototype.playMoveY=function(){var t=this;if(!this.isDispose)var e=this.listPosY[this.indexed]-this.listPosY[this.indexed-1],i=0,n=this.scene.tweens.addCounter({from:0,to:e,ease:"Linear",duration:200,onUpdate:function(e,n){for(var a=n.value-i,s=0,o=t.tempItems;s<o.length;s++){o[s].y+=a}i=n.value},onComplete:function(){n.stop(),n.remove(),t.playNextAnimation()}})},MainTaskAnimation}(),y=function(){function MainTaskGooutAnimation(t,e,i,n){this.listPosY=[],this.tempItems=[],this.isDispose=!1,this.scene=t,this.taskItems=e,this.width=i,this.dpr=n,this.setItemLayout()}return MainTaskGooutAnimation.prototype.playGoOutAnimation=function(){for(var t=this,e=[],i=[],n=[],a=this.taskItems.length-1;a>=0;a--){var s=this.taskItems[a];if(s.questData.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&(e.push(s),this.taskItems.splice(a,1),a<this.taskItems.length)){var o=this.taskItems.slice(a,this.taskItems.length);i.push(o),n.push(a)}}var h=this.width+10*this.dpr;e.length>0&&(this.playMoveX(e,0,h),this.playAlpha(e,0,1,"Cubic.easeOut"),setTimeout((function(){for(var e=0;e<i.length;e++){var a=i[e],s=n[e];t.playMoveGooutY(a,s)}}),300))},MainTaskGooutAnimation.prototype.dispose=function(){this.tempItems.length=0,this.taskItems.length=0,this.taskItems=void 0,this.tempItems=void 0,this.isDispose=!0},MainTaskGooutAnimation.prototype.setItemLayout=function(){for(var t=0,e=this.taskItems;t<e.length;t++){var i=e[t];this.listPosY.push(i.y)}},MainTaskGooutAnimation.prototype.playMoveX=function(t,e,i){var n=this;if(!this.isDispose)var a=this.scene.tweens.add({targets:t,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){if(a.stop(),a.remove(),n.scene)for(var e=0,i=t;e<i.length;e++){i[e].visible=!1}}})},MainTaskGooutAnimation.prototype.playAlpha=function(t,e,i,n){if(!this.isDispose)var a=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:n,duration:250,onComplete:function(){a.stop(),a.remove()}})},MainTaskGooutAnimation.prototype.playMoveGooutY=function(t,e){var i=this;if(!this.isDispose)var n=this.listPosY[e+1]-this.listPosY[e],a=0,s=this.scene.tweens.addCounter({from:0,to:n,ease:"Linear",duration:200,onUpdate:function(e,i){for(var n=i.value-a,s=0,o=t;s<o.length;s++){o[s].y-=n}a=i.value},onComplete:function(){s.stop(),s.remove(),i.isDispose||i.dispose()}})},MainTaskGooutAnimation}()},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaItemTipsPanel",(function(){return p}));var n,a=i(21),s=i(479),o=i(480),h=i(486),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaItemTipsPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[a.d.uicommon],i.key=l.ModuleName.PICAITEMTIPSPANEL_NAME,i.uiLayer=s.MainUIScene.LAYER_TOOLTIPS,i}return c(PicaItemTipsPanel,t),Object.defineProperty(PicaItemTipsPanel,"Inst",{get:function(){return this.mInstance||(this.mInstance=h.PicaSingleManager.createSinglePanel(PicaItemTipsPanel)),this.mInstance},enumerable:!1,configurable:!0}),PicaItemTipsPanel.prototype.showTips=function(t,e){this.mInitialized?this.displayTips(t,e):this.show({gameobj:t,data:e})},PicaItemTipsPanel.prototype.destroy=function(){t.prototype.destroy.call(this),PicaItemTipsPanel.mInstance=void 0},PicaItemTipsPanel.prototype.onShow=function(){if(this.mShowData){var t=this.mShowData;this.displayTips(t.gameobj,t.data)}},PicaItemTipsPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.itemTips=new s.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,a.d.uicommon,"tips_bg",this.dpr),this.itemTips.setVisible(!1),this.add(this.itemTips),t.prototype.init.call(this)},PicaItemTipsPanel.prototype.displayTips=function(t,e){this.itemTips.setVisible(!0),this.itemTips.setItemData(e),this.setTipsPosition(t,.5*-t.height-5*this.dpr)},PicaItemTipsPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);var i=t.getWorldTransformMatrix(),n=i.tx/this.scale,a=i.ty/this.scale,s=this.itemTips.width,o=.5*s+10*this.dpr,h=this.width-.5*s-10*this.dpr;n<o?n=o:n>h&&(n=h),a+=e,this.itemTips.x=n,this.itemTips.y=a},PicaItemTipsPanel}(o.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasureAllOpenPanel",(function(){return c}));var n,a=i(6),s=i(2),o=i(21),h=i(481),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaTreasureAllOpenPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.lightAniKey="treasurelight",h.starAniKey="treasurestar",h.indexed=0,h.isDispose=!1,h.tweens=[],h.maskWidth=0,h.maskHeight=0,h.dpr=s,h.zoom=o,h.key=a,h.setSize(i,n),h.init(),h}return l(PicaTreasureAllOpenPanel,t),PicaTreasureAllOpenPanel.prototype.resize=function(t,e){this.setSize(t,e);var i=this.getWorldTransformMatrix();this.maskGraphic.setPosition(i.tx,i.ty)},PicaTreasureAllOpenPanel.prototype.addListen=function(){this.confirmBtn.on(a.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureAllOpenPanel.prototype.removeListen=function(){this.confirmBtn.off(a.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureAllOpenPanel.prototype.init=function(){var t=.5*-this.height,e=this.scene.make.image({x:0,y:t+5*this.dpr,key:o.d.treasure,frame:"treasure_title_bg"},!1);this.titleimage=this.scene.make.image({x:0,y:e.y,key:o.d.treasure,frame:s.i18n.t("treasure.titleimg")},!1),this.titleimage.alpha=0,this.add([e,this.titleimage]),this.lightSprite=this.createSprite(o.d.circleeffect,this.lightAniKey,"",[1,16]),this.lightSprite.x=5*this.dpr,this.add(this.lightSprite),this.starSprite=this.createSprite(o.d.stareffect,this.starAniKey,"star",[1,18],10,-1),this.add(this.starSprite),this.starSprite.x=this.lightSprite.y;var i=this.maskWidth=this.width,n=this.maskHeight=200*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var h=this.getWorldTransformMatrix();this.maskGraphic.setPosition(h.tx,h.ty),this.content.setMask(this.maskGraphic.createGeometryMask()),this.confirmBtn=new a.Button(this.scene,o.d.treasure,"butt","butt",s.i18n.t("common.confirm")),this.confirmBtn.y=-t-8*this.dpr,this.confirmBtn.setTextStyle(s.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.confirmBtn.alpha=0,this.add(this.confirmBtn)},PicaTreasureAllOpenPanel.prototype.setHandler=function(t){this.closeHandler=t},PicaTreasureAllOpenPanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.isDispose=!0,this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaTreasureAllOpenPanel.prototype.setTreasureData=function(t){if(t){this.treasureData=t;var e=this.getNextDatas(),i=this.createLayoutGroup(e),n=.5*(i.height-this.maskHeight);this.setLayoutPanel(i.width,i.height),this.playAnimation();var a=280*this.dpr+n;i.y=a,this.playItemTween(i,a,n,620),this.curLayoutGroup=i}},PicaTreasureAllOpenPanel.prototype.setLayoutPanel=function(t,e){var i=this.width,n=e+40*this.dpr;this.maskGraphic.clear(),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var a=this.getWorldTransformMatrix(),s=.5*(e-this.maskHeight);this.maskGraphic.setPosition(a.tx,a.ty+s),this.confirmBtn.y=.5*this.height+38*this.dpr+s},PicaTreasureAllOpenPanel.prototype.playAnimation=function(){var t=this;this.titleimage.alpha=0,this.lightSprite.play(this.lightAniKey),setTimeout((function(){t.starSprite.play(t.starAniKey)}),208);var e=this.scene.tweens.add({targets:this.titleimage,alpha:{from:0,to:1},duration:300,onComplete:function(){e.stop(),e.remove()}});this.tweens.push(e);var i=this.scene.tweens.add({targets:this.confirmBtn,alpha:{from:0,to:1},duration:200,delay:720,onComplete:function(){i.stop(),i.remove()}});this.tweens.push(i)},PicaTreasureAllOpenPanel.prototype.playItemTween=function(t,e,i,n){var a=this,s=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Back.easeOut",duration:300,delay:n,onComplete:function(){s.stop(),s.remove(),a.playPageCount()}});this.tweens.push(s);var o=this.curLayoutGroup;if(o){var h=this.scene.tweens.add({targets:o,alpha:{from:1,to:0},duration:200,onComplete:function(){h.stop(),h.remove(),o.destroy()}});this.tweens.push(h)}},PicaTreasureAllOpenPanel.prototype.playPageCount=function(){this.isDispose},PicaTreasureAllOpenPanel.prototype.getNextDatas=function(){var t=this.treasureData;if(!(this.indexed>=t.length)){var e=this.indexed,i=t.length;return this.indexed=i,t.slice(e,i)}},PicaTreasureAllOpenPanel.prototype.createLayoutGroup=function(t){var e=new p(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaTreasureAllOpenPanel.prototype.createSprite=function(t,e,i,n,a,s){void 0===a&&(a=30),void 0===s&&(s=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:a,repeat:s}),o},PicaTreasureAllOpenPanel.prototype.onConfirmBtnClick=function(){var t=this.getNextDatas();if(t){var e=this.createLayoutGroup(t),i=.5*(e.height-this.maskHeight),n=280*this.dpr+i;e.y=n,this.playItemTween(e,n,i,200),this.curLayoutGroup=e}else this.closeHandler&&this.closeHandler.run()},PicaTreasureAllOpenPanel}(Phaser.GameObjects.Container),p=function(t){function RewardLayoutGroup(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.zoom=h,l.setSize(a,s),l}return l(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new h.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,a=e.height,s=0,o=0;if(i<=3)for(var h=2===i?20*this.dpr:10*this.dpr,l=i*n+h*(i-1),c=0;c<i;c++){(_=t[c]).x=.5*-l+(n+h)*c+.5*n}else if(4===i){var p=20*this.dpr,d=15*this.dpr;for(c=0;c<2;c++)for(var u=0;u<2;u++){(_=t[2*c+u]).x=.5*-(n+p)+(n+p)*u,_.y=.5*-(a+d)+(a+d)*c}}else if(5===i){l=3*n+2*(p=10*this.dpr);var m=2*a+(d=15*this.dpr);for(c=0;c<3;c++){(_=t[c]).x=.5*-l+(n+p)*c+.5*n,_.y=.5*-m+.5*a}for(u=0;u<2;u++){(_=t[u+3]).x=.5*-(2*n+p)+.5*n+(n+p)*u,_.y=.5*m-.5*a}}else if(6===i)for(l=3*n+2*(p=10*this.dpr),m=2*a+(d=15*this.dpr),c=0;c<2;c++)for(u=0;u<3;u++){(_=t[3*c+u]).x=.5*-l+(n+p)*u+.5*n,_.y=.5*-m+(a+d)*c+.5*a}else{p=10*this.dpr,d=10*this.dpr;var f=Math.floor(t.length/4),y=t.length%4,g=(l=4*n+3*p,f+(0===y?0:1));for(m=g*a+d*(g-1),c=0;c<f;c++)for(u=0;u<4;u++){(_=t[4*c+u]).x=.5*-l+(n+p)*u+.5*n,_.y=.5*-m+(a+d)*c+.5*a}var P=y*n+p*(y-1);for(u=0;u<y;u++){var _;(_=t[u+4*f]).x=.5*-P+.5*n+(n+p)*u,_.y=.5*m-.5*a}s=l,o=m,this.width<s&&(this.width=s),this.height<o&&(this.height=o)}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasureOpenPanel",(function(){return c}));var n,a=i(6),s=i(2),o=i(21),h=i(481),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaTreasureOpenPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.lightAniKey="treasurelight",h.starAniKey="treasurestar",h.indexed=0,h.isDispose=!1,h.tweens=[],h.maskWidth=0,h.maskHeight=0,h.dpr=s,h.zoom=o,h.key=a,h.setSize(i,n),h.init(),h}return l(PicaTreasureOpenPanel,t),PicaTreasureOpenPanel.prototype.resize=function(t,e){this.setSize(t,e);var i=this.getWorldTransformMatrix();this.maskGraphic.setPosition(i.tx,i.ty)},PicaTreasureOpenPanel.prototype.addListen=function(){this.confirmBtn.on(a.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureOpenPanel.prototype.removeListen=function(){this.confirmBtn.off(a.ClickEvent.Tap,this.onConfirmBtnClick,this)},PicaTreasureOpenPanel.prototype.init=function(){var t=.5*-this.height,e=this.scene.make.image({x:0,y:t+5*this.dpr,key:o.d.treasure,frame:"treasure_title_bg"},!1);this.titleimage=this.scene.make.image({x:0,y:e.y,key:o.d.treasure,frame:s.i18n.t("treasure.titleimg")},!1),this.titleimage.alpha=0,this.pageCount=this.scene.make.text({x:0,y:this.titleimage.y+40*this.dpr,text:"1/6",style:{color:"#FFE400",fontFamily:s.Font.DEFULT_FONT,fontSize:16*this.dpr}}).setOrigin(.5).setFontStyle("bold"),this.pageCount.visible=!1,this.add([e,this.titleimage,this.pageCount]),this.lightSprite=this.createSprite(o.d.circleeffect,this.lightAniKey,"",[1,16]),this.lightSprite.x=5*this.dpr,this.add(this.lightSprite),this.starSprite=this.createSprite(o.d.stareffect,this.starAniKey,"star",[1,18],10,-1),this.add(this.starSprite),this.starSprite.x=this.lightSprite.y;var i=this.maskWidth=this.width,n=this.maskHeight=180*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.maskGraphic=this.scene.make.graphics(void 0,!1),this.maskGraphic.fillStyle(0),this.maskGraphic.fillRect(.5*-i*this.zoom,.5*-n*this.zoom,i*this.zoom,n*this.zoom);var h=this.getWorldTransformMatrix();this.maskGraphic.setPosition(h.tx,h.ty),this.content.setMask(this.maskGraphic.createGeometryMask()),this.pagedown=this.scene.make.text({x:0,y:-t-45*this.dpr,text:s.i18n.t("treasure.pagedown"),style:{color:"#96F7FF",fontFamily:s.Font.DEFULT_FONT,fontSize:12*this.dpr}}).setOrigin(.5),this.add(this.pagedown),this.pagedown.visible=!1,this.confirmBtn=new a.Button(this.scene,o.d.treasure,"butt","butt",s.i18n.t("common.confirm")),this.confirmBtn.y=-t-8*this.dpr,this.confirmBtn.setTextStyle(s.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.confirmBtn.alpha=0,this.add(this.confirmBtn)},PicaTreasureOpenPanel.prototype.setHandler=function(t){this.closeHandler=t},PicaTreasureOpenPanel.prototype.destroy=function(){if(t.prototype.destroy.call(this),this.isDispose=!0,this.tweens.length>0)for(var e=0,i=this.tweens;e<i.length;e++){var n=i[e];n.stop(),n.remove()}this.tweens.length=0},PicaTreasureOpenPanel.prototype.setTreasureData=function(t){if(t){this.treasureData=t;var e=this.getNextDatas(),i=this.createLayoutGroup(e);this.playAnimation();var n=160*this.dpr+.5*(i.height-this.maskHeight);this.playItemTween(i,n,620),this.curLayoutGroup=i}},PicaTreasureOpenPanel.prototype.playAnimation=function(){var t=this;this.titleimage.alpha=0,this.lightSprite.play(this.lightAniKey),setTimeout((function(){t.starSprite.play(t.starAniKey)}),208);var e=this.scene.tweens.add({targets:this.titleimage,alpha:{from:0,to:1},duration:300,onComplete:function(){e.stop(),e.remove()}});this.tweens.push(e);var i=this.scene.tweens.add({targets:this.confirmBtn,alpha:{from:0,to:1},duration:200,delay:720,onComplete:function(){i.stop(),i.remove()}});this.tweens.push(i)},PicaTreasureOpenPanel.prototype.playItemTween=function(t,e,i){var n=this,a=this.scene.tweens.add({targets:t,y:{from:e,to:0},ease:"Back.easeOut",duration:300,delay:i,onComplete:function(){a.stop(),a.remove(),n.playPageCount()}});this.tweens.push(a);var s=this.curLayoutGroup;if(s){var o=this.scene.tweens.add({targets:s,alpha:{from:1,to:0},duration:200,onComplete:function(){o.stop(),o.remove(),s.destroy()}});this.tweens.push(o)}},PicaTreasureOpenPanel.prototype.playPageCount=function(){if(!this.isDispose){var t=this.treasureData.length;if(!(t<6)){this.pageCount.visible=!0,this.pagedown.visible=!0;var e=Math.ceil(t/6),i=Math.ceil(this.indexed/6);this.pageCount.text=i+" /"+e}}},PicaTreasureOpenPanel.prototype.getNextDatas=function(){var t=this.treasureData;if(!(this.indexed>=t.length)){var e=this.indexed,i=t.length>=e+6?e+6:t.length;return this.indexed=i,t.slice(e,i)}},PicaTreasureOpenPanel.prototype.createLayoutGroup=function(t){var e=new p(this.scene,0,this.maskHeight,235*this.dpr,this.maskHeight,this.dpr,this.zoom);return this.content.add(e),e.setRewardDatas(t),e},PicaTreasureOpenPanel.prototype.createSprite=function(t,e,i,n,a,s){void 0===a&&(a=30),void 0===s&&(s=0);var o=this.scene.make.sprite({key:t,frame:i+"1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:a,repeat:s}),o},PicaTreasureOpenPanel.prototype.onConfirmBtnClick=function(){var t=this.getNextDatas();if(t){var e=this.createLayoutGroup(t),i=160*this.dpr+.5*(e.height-this.height);this.playItemTween(e,i,200),this.curLayoutGroup=e}else this.closeHandler&&this.closeHandler.run()},PicaTreasureOpenPanel}(Phaser.GameObjects.Container),p=function(t){function RewardLayoutGroup(e,i,n,a,s,o,h){var l=t.call(this,e,i,n)||this;return l.dpr=o,l.zoom=h,l.setSize(a,s),l}return l(RewardLayoutGroup,t),RewardLayoutGroup.prototype.setRewardDatas=function(t){if(t){for(var e=t.length,i=0;i<e;i++){var n=new h.ItemButton(this.scene,o.d.uicommon1,"roam_reward_ordinary_bg",this.dpr,this.zoom,!0);n.setStateFrames("roam_reward_ordinary_bg","roam_reward_rare_bg"),n.setItemData(t[i]),this.add(n)}this.setLayout()}},RewardLayoutGroup.prototype.setLayout=function(){var t=this.list;if(0!==t.length){var e=t[0],i=t.length,n=e.width,a=e.height;if(i<=3)for(var s=2===i?20*this.dpr:10*this.dpr,o=i*n+s*(i-1),h=0;h<i;h++){(u=t[h]).x=.5*-o+(n+s)*h+.5*n}else if(4===i){var l=20*this.dpr,c=15*this.dpr;for(h=0;h<2;h++)for(var p=0;p<2;p++){(u=t[2*h+p]).x=.5*-(n+l)+(n+l)*p,u.y=.5*-(a+c)+(a+c)*h}}else if(5===i){o=3*n+2*(l=10*this.dpr);var d=2*a+(c=15*this.dpr);for(h=0;h<3;h++){(u=t[h]).x=.5*-o+(n+l)*h+.5*n,u.y=.5*-d+.5*a}for(p=0;p<2;p++){(u=t[p+3]).x=.5*-(2*n+l)+.5*n+(n+l)*p,u.y=.5*d-.5*a}}else if(6===i)for(o=3*n+2*(l=10*this.dpr),d=2*a+(c=15*this.dpr),h=0;h<2;h++)for(p=0;p<3;p++){var u;(u=t[3*h+p]).x=.5*-o+(n+l)*p+.5*n,u.y=.5*-d+(a+c)*h+.5*a}}},RewardLayoutGroup}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasurePreviewPanel",(function(){return p}));var n,a=i(6),s=i(484),o=i(2),h=i(21),l=i(481),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaTreasurePreviewPanel(e,i,n,a,s,o,h){var l=t.call(this,e)||this;return l.render=i,l.dpr=o,l.zoom=h,l.key=s,l.setSize(n,a),l.init(),l}return c(PicaTreasurePreviewPanel,t),PicaTreasurePreviewPanel.prototype.resize=function(t,e){this.setSize(t,e),this.rewardGameScroll.refreshMask()},PicaTreasurePreviewPanel.prototype.addListen=function(){this.confirmBtn.on(a.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaTreasurePreviewPanel.prototype.removeListen=function(){this.confirmBtn.off("click",this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaTreasurePreviewPanel.prototype.init=function(){var t=this;this.bg=new a.NineSlicePatch(this.scene,0,0,this.width,this.height,h.d.uicommon1,"bg1",o.UIHelper.background_w(this.dpr)),this.add(this.bg);var e=.5*-this.bg.height;this.titleimage=this.scene.make.image({x:0,y:e+5*this.dpr,key:h.d.uicommon1,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+2*this.dpr,text:"",style:o.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5).setFontStyle("bold"),this.closeBtn=new a.Button(this.scene,h.c.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-8*this.dpr,e+7*this.dpr),this.add([this.titleimage,this.titleName,this.closeBtn]),this.bgicon=this.scene.make.image({key:h.d.treasure,frame:"treasure_bg"}),this.bgicon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bgicon.y=this.titleName.y+.5*this.bgicon.height+34*this.dpr,this.add([this.bg,this.bgicon]),this.mDetailDisplay=new s.a(this.scene,this.render),this.mDetailDisplay.y=this.bgicon.y,this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.setSize(72*this.dpr,72*this.dpr),this.add(this.mDetailDisplay);var i=360*this.dpr,n=92*this.dpr;this.rewardCon=this.scene.make.container(void 0,!1).setSize(i,n),this.add(this.rewardCon),this.rewardCon.setPosition(0,-e-.5*n-68*this.dpr);var l=this.scene.make.text({x:0,y:.5*-n+8*this.dpr,text:o.i18n.t("treasure.tipslabel"),style:{color:"#253FCA",fontSize:12*this.dpr,fontFamily:o.Font.DEFULT_FONT}},!1).setOrigin(.5),c=this.scene.make.image({key:h.d.treasure,frame:"treasure_decorate_left"});c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var p=this.scene.make.image({key:h.d.treasure,frame:"treasure_decorate_right"});p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var d=.5*-l.width-.5*c.width-10*this.dpr;c.setPosition(d,l.y),p.setPosition(-d,l.y),this.rewardCon.add([l,c,p]),this.rewardGameScroll=new a.GameScroller(this.scene,{x:0,y:2*this.dpr,width:295*this.dpr,height:90*this.dpr,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:10*this.dpr,valuechangeCallback:void 0,cellupCallBack:function(e){t.onRewardItemHandler(e)}}),this.rewardCon.add(this.rewardGameScroll),this.confirmBtn=new a.Button(this.scene,h.d.treasure,"butt","butt",o.i18n.t("common.open")),this.confirmBtn.y=-e-38*this.dpr,this.confirmBtn.setTextStyle(o.UIHelper.brownishStyle(this.dpr,20)),this.confirmBtn.setFontStyle("bold"),this.add(this.confirmBtn)},PicaTreasurePreviewPanel.prototype.setHandler=function(t,e){this.sendHandler=t,this.closeHandler=e},PicaTreasurePreviewPanel.prototype.setTreasureData=function(t){this.titleName.text="某某某宝箱",this.setTreasureItems(t)},PicaTreasurePreviewPanel.prototype.setTreasureItems=function(t){this.rewardGameScroll.clearItems();for(var e=0;e<10;e++){var i=new l.ItemButton(this.scene,h.d.uicommon,"bag_icon_common_bg",this.dpr,this.zoom,!1);i.y=0,this.rewardGameScroll.addItem(i)}this.rewardGameScroll.Sort()},PicaTreasurePreviewPanel.prototype.onConfirmBtnClick=function(){this.treasureData;this.sendHandler&&this.sendHandler.run()},PicaTreasurePreviewPanel.prototype.OnClosePanel=function(){this.closeHandler&&this.closeHandler.run()},PicaTreasurePreviewPanel.prototype.onRewardItemHandler=function(t){this.selectMaterial&&this.selectMaterial!==t&&(this.selectMaterial.select=!1),t.select=!t.select,this.selectMaterial=t},PicaTreasurePreviewPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(294),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function RoomScene(){return null!==t&&t.apply(this,arguments)||this}return s(RoomScene,t),RoomScene.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this.mRoomID=e.roomid)},RoomScene.prototype.create=function(){t.prototype.create.call(this)},RoomScene}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n,a=i(15),s=i(0),o=i(2),h=i(542),l=i(633),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},p=function(t){function FramesDisplay(e,i,n,a){var s=t.call(this,e,n,a)||this;return s.render=i,s.mID=void 0,s.mName=void 0,s.mID=n,s.mMovement=new l.a(e,s,i),s}return c(FramesDisplay,t),FramesDisplay.prototype.startLoad=function(){return this.scene.load.start(),Promise.resolve(null)},FramesDisplay.prototype.destroy=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0),this.mChildMap&&(this.mChildMap.clear(),this.mChildMap=null),this.mTopDisplay&&this.mTopDisplay.destroy(),this.mMovement&&this.mMovement.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(FramesDisplay.prototype,"titleMask",{get:function(){return this.mTitleMask},set:function(t){this.mTitleMask=t},enumerable:!1,configurable:!0}),FramesDisplay.prototype.setRootMount=function(e){t.prototype.setRootMount.call(this,e),this.updateTopDisplay()},FramesDisplay.prototype.showRefernceArea=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){return!t||t.length<=0||!e||(this.mReferenceArea||(this.mReferenceArea=new a.j(this.scene),this.addChildMap("reference",this.mReferenceArea)),i=this.render.mainPeer.getCurrentRoomSize(),this.mReferenceArea.draw(t,e,i.tileWidth,i.tileHeight),this.addAt(this.mReferenceArea,0)),[2]}))}))},FramesDisplay.prototype.hideRefernceArea=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0)},FramesDisplay.prototype.updateTopDisplay=function(){this.mTopDisplay&&this.mTopDisplay.update()},FramesDisplay.prototype.showNickname=function(t){void 0===t&&(t=this.mName),this.mName=t,this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.checkShowNickname()&&this.mTopDisplay.showNickname(t)},FramesDisplay.prototype.showTopDisplay=function(t){if(!t)return this.mTopDisplay&&this.mTopDisplay.destroy(),void(this.mTopDisplay=void 0);this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.loadState(t)},FramesDisplay.prototype.showBubble=function(t,e){this.mTopDisplay||(this.mTopDisplay=new h.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.showBubble(t,e)},FramesDisplay.prototype.clearBubble=function(){this.mTopDisplay&&this.mTopDisplay.clearBubble()},FramesDisplay.prototype.created=function(){t.prototype.created.call(this),this.render.mainPeer.elementDisplayReady(this.id)},FramesDisplay.prototype.play=function(e){t.prototype.play.call(this,e),this.fetchProjection()},FramesDisplay.prototype.doMove=function(t){this.mMovement.doMove(t)},FramesDisplay.prototype.setPosition=function(e,i,n,a){return t.prototype.setPosition.call(this,e,i,n,a),this.updateTopDisplay(),this},FramesDisplay.prototype.addEffect=function(t){if(!t)return o.Logger.getInstance().error("Failed to add effect, display does not exist");var e=t.getSprite(s.DisplayField.BACKEND);e&&this.addAt(e,s.DisplayField.BACKEND);var i=t.getSprite(s.DisplayField.FRONTEND);i&&this.addAt(i,s.DisplayField.FRONTEND)},FramesDisplay.prototype.removeEffect=function(){this.mDisplayDatas.get(s.DisplayField.Effect)&&(this.mDisplayDatas.delete(s.DisplayField.Effect),this.removeDisplay(s.DisplayField.BACKEND),this.removeDisplay(s.DisplayField.FRONTEND))},FramesDisplay.prototype.unmount=function(e){this.mMountContainer&&(t.prototype.unmount.call(this,e),this.render.displayManager.addToSurfaceLayer(e))},FramesDisplay.prototype.scaleTween=function(){var t=this;if(!(this.mMountContainer&&this.mMountContainer.list.length>0||this.mScaleTween)){var e=this.scale;this.mScaleTween=this.scene.tweens.add({targets:this,duration:100,scale:1.25*e,yoyo:!0,repeat:0,onComplete:function(){t.scale=1,t.mScaleTween&&(t.mScaleTween=void 0)}})}},FramesDisplay.prototype.addChildMap=function(t,e){this.mChildMap||(this.mChildMap=new Map),this.mChildMap.set(t,e)},FramesDisplay.prototype.fetchProjection=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.id?(t=this,[4,this.render.mainPeer.fetchProjectionSize(this.id)]):[2];case 1:return t.mProjectionSize=e.sent(),this.updateSort(),[2]}}))}))},FramesDisplay.prototype.completeFrameAnimationQueue=function(){t.prototype.completeFrameAnimationQueue.call(this),this.render.mainPeer.completeFrameAnimationQueue(this.id)},FramesDisplay.prototype.checkShowNickname=function(){return(this.mTitleMask&s.TitleMask.TQ_NickName)>0},FramesDisplay.prototype.clearDisplay=function(){t.prototype.clearDisplay.call(this),this.mMountContainer&&this.mMountContainer.parentContainer&&this.mMountContainer.parentContainer.remove(this.mMountContainer)},FramesDisplay.prototype.onAnimationUpdateHandler=function(t,e){if(this.mMountContainer&&this.mCurAnimation){var i=this.mCurAnimation.mountLayer.frameVisible;if(i){var n=e.index-1;if(!(n>i.length))for(var a=0;a<this.mMountList.length;a++)this.mMountList[a].visible=this.getMaskValue(i[n],a)}}},FramesDisplay.prototype.getMaskValue=function(t,e){return(t>>e)%2==1},Object.defineProperty(FramesDisplay.prototype,"nickname",{get:function(){return this.mName},enumerable:!1,configurable:!0}),FramesDisplay}(a.c)},function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,a=i(2),s=i(613),o=i(15),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function ElementTopDisplay(e,i,n){var a=t.call(this,e,i,n)||this;return a.isDispose=!1,a}return h(ElementTopDisplay,t),ElementTopDisplay.prototype.showNickname=function(t){if(this.mOwner){var e=this.mFollows.get(o.f.Nickname),i=null;e?i=e.object:(i=this.scene.make.text({style:{fontSize:12*this.mDpr,fontFamily:a.Font.DEFULT_FONT}}).setOrigin(.5).setStroke("#000000",2*this.mDpr),e=new o.g(i,this.mOwner,this.mDpr),this.mFollows.set(o.f.Nickname,e)),i.text=t,this.mOwner.topPoint&&(this.addToSceneUI(i),e.setOffset(0,this.mOwner.topPoint.y),e.update())}},ElementTopDisplay.prototype.hideNickname=function(){this.removeFollowObject(o.f.Nickname)},ElementTopDisplay.prototype.showBubble=function(t,e){var i=this.scene;i&&(this.mBubble||(this.mBubble=new s.a(i,this.mDpr)),this.mBubble.addBubble(t,e),this.mBubble.follow(this.mOwner),this.addToSceneUI(this.mBubble))},ElementTopDisplay.prototype.clearBubble=function(){this.mBubble&&(this.mBubble.destroy(),this.mBubble=null)},ElementTopDisplay.prototype.loadState=function(t){var e=this,i="state_"+t;if(this.scene.cache.json.exists(i))this.showStateHandler(this.scene.cache.json.get(i));else{this.scene.load.once("filecomplete-json-"+i,(function(t){i===t&&e.showStateHandler(e.scene.cache.json.get(i))}),this),this.scene.load.json(i,a.Url.getRes("config/base/state/"+t+".json")),this.scene.load.start()}},ElementTopDisplay.prototype.showUIState=function(t){var e=this;if("text"!==t.type){var i=t.image.display.texturepath,n=t.image.display.datapath;this.loadAtals(i,n,this,(function(){var n,a,s=t.image.img;if("sprite"===t.type){var h=t.image.animation,l=h.frame;e.scene.anims.create({key:h.anikey,frames:e.scene.anims.generateFrameNames(i,{prefix:s+"_",frames:l}),duration:h.duration,repeat:h.repeat}),e.mFollows.has(o.f.Sprite)?a=(n=e.mFollows.get(o.f.Sprite)).object:(a=e.scene.make.sprite({key:i,frame:s+"_1"}),n=new o.g(a,e.mOwner,e.mDpr),e.mFollows.set(o.f.Sprite,n)),a.play(h.anikey)}else e.mFollows.has(o.f.Sprite)?(a=(n=e.mFollows.get(o.f.Sprite)).object).setTexture(i,s):(a=e.scene.make.image({key:i,frame:s}),n=new o.g(a,e.mOwner,e.mDpr),e.mFollows.set(o.f.Sprite,n));var c=e.getYOffset();n.setOffset(0,c.y),e.addToSceneUI(a),n.update()}))}},ElementTopDisplay.prototype.getYOffset=function(){var t=new Phaser.Geom.Point;return t.x=0,t.y=this.mOwner.topPoint.y,t},ElementTopDisplay.prototype.addDisplay=function(){var t=this;this.mFollows&&this.mFollows.forEach((function(e){e.object&&t.addToSceneUI(e.object)}))},ElementTopDisplay.prototype.removeDisplay=function(){this.mFollows&&this.mFollows.forEach((function(t){return t.remove()}))},ElementTopDisplay.prototype.hasTopPoint=function(){return this.mOwner&&this.mOwner.topPoint},ElementTopDisplay.prototype.hasNickName=function(){return!!this.mFollows.has(o.f.Nickname)},ElementTopDisplay.prototype.destroy=function(){this.mFollows&&(this.mFollows.forEach((function(t){return t.destroy()})),this.mFollows.clear(),this.mFollows=void 0),this.mBubble&&(this.mBubble.destroy(),this.mBubble=void 0)},ElementTopDisplay.prototype.update=function(){this.mFollows&&this.mFollows.forEach((function(t){return t.update()})),this.mBubble&&this.mBubble.follow(this.mOwner)},ElementTopDisplay.prototype.addToSceneUI=function(t){this.mOwner&&t&&this.scene.layerManager.addToLayer("sceneUILayer",t)},ElementTopDisplay.prototype.loadAtals=function(t,e,i,n){var s=this;this.scene.textures.exists(t)?!this.isDispose&&n&&n.call(i):(this.scene.load.atlas(t,a.Url.getUIRes(this.mDpr,t),a.Url.getUIRes(this.mDpr,e)),this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(){!s.isDispose&&n&&n.call(i)}),this),this.scene.load.start())},ElementTopDisplay.prototype.showStateHandler=function(t){this.showUIState(t)},ElementTopDisplay}(o.m)},function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n,a=i(15),s=i(2),o=i(0),h=i(609),l=i(542),c=i(633),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},d=function(t){function DragonbonesDisplay(e,i,n,a,s){var o=t.call(this,e)||this;return o.render=i,o.uuid=a,o.mID=void 0,o.mNodeType=void 0,o.mSortX=0,o.mSortY=0,o.mName=void 0,o.mID=n,o.mNodeType=s,o.mLoadQueue=new h.a(e),o.mLoadQueue.on("QueueProgress",o.fileComplete,o),o.mLoadQueue.on("QueueError",o.fileError,o),o.mMovement=new c.a(e,o,i),o}return p(DragonbonesDisplay,t),DragonbonesDisplay.prototype.load=function(e,i){return(i=i||o.DisplayField.STAGE)!==o.DisplayField.STAGE?Promise.reject("field is not STAGE"):t.prototype.load.call(this,e)},DragonbonesDisplay.prototype.startLoad=function(){var t=this;return new Promise((function(e,i){t.mLoadQueue&&!t.mCreated?(t.mLoadQueue.once("QueueComplete",(function(){e(null)}),t),t.mLoadQueue.startLoad()):e(null)}))},DragonbonesDisplay.prototype.destroy=function(){this.mLoadQueue&&(this.mLoadQueue.off("QueueProgress",this.fileComplete,this),this.mLoadQueue.off("QueueError",this.fileError,this),this.mLoadQueue.destroy()),this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0),this.mTopDisplay&&this.mTopDisplay.destroy(),this.mMovement&&this.mMovement.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(DragonbonesDisplay.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"nodeType",{get:function(){return this.mNodeType},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"titleMask",{get:function(){return this.mTitleMask},set:function(t){this.mTitleMask=t},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.setRootMount=function(e){t.prototype.setRootMount.call(this,e),this.updateTopDisplay()},DragonbonesDisplay.prototype.showRefernceArea=function(t,e){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return!t||t.length<=0||!e?[2]:(this.mReferenceArea||(this.mReferenceArea=new a.j(this.scene)),[4,this.render.mainPeer.getCurrentRoomSize()]);case 1:return i=n.sent(),this.mReferenceArea.draw(t,e,i.tileWidth,i.tileHeight),this.addAt(this.mReferenceArea,0),[2]}}))}))},DragonbonesDisplay.prototype.hideRefernceArea=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0)},DragonbonesDisplay.prototype.updateTopDisplay=function(){this.mTopDisplay&&this.mTopDisplay.update()},DragonbonesDisplay.prototype.showNickname=function(t){void 0===t&&(t=this.mName),this.mName=t,this.mTopDisplay||(this.mTopDisplay=new l.a(this.scene,this,this.render.scaleRatio)),this.checkShowNickname()&&this.mTopDisplay.showNickname(t)},DragonbonesDisplay.prototype.showTopDisplay=function(t){if(!t)return this.mTopDisplay&&this.mTopDisplay.destroy(),void(this.mTopDisplay=void 0);this.mTopDisplay||(this.mTopDisplay=new l.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.loadState(t)},DragonbonesDisplay.prototype.showBubble=function(t,e){this.mTopDisplay||(this.mTopDisplay=new l.a(this.scene,this,this.render.scaleRatio)),this.mTopDisplay.showBubble(t,e)},DragonbonesDisplay.prototype.clearBubble=function(){this.mTopDisplay&&this.mTopDisplay.clearBubble()},DragonbonesDisplay.prototype.created=function(){t.prototype.created.call(this),this.render.mainPeer.elementDisplayReady(this.id),this.render.renderEmitter("dragonBones_initialized")},Object.defineProperty(DragonbonesDisplay.prototype,"projectionSize",{get:function(){return this.mProjectionSize||(this.mProjectionSize={offset:{x:0,y:0},width:0,height:0}),this.mProjectionSize},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.play=function(e){t.prototype.play.call(this,e),this.fetchProjection()},DragonbonesDisplay.prototype.doMove=function(t){this.mMovement.doMove(t)},DragonbonesDisplay.prototype.setPosition=function(e,i,n,a){return t.prototype.setPosition.call(this,e,i,n,a),this.updateTopDisplay(),this},DragonbonesDisplay.prototype.addEffect=function(t){if(!t)return s.Logger.getInstance().error("Failed to add effect, display does not exist");var e=t.getSprite(o.DisplayField.BACKEND);e&&this.addAt(e,o.DisplayField.BACKEND);var i=t.getSprite(o.DisplayField.FRONTEND);i&&this.addAt(i,o.DisplayField.FRONTEND)},DragonbonesDisplay.prototype.removeEffect=function(){},DragonbonesDisplay.prototype.mount=function(t,e){},DragonbonesDisplay.prototype.unmount=function(t){},Object.defineProperty(DragonbonesDisplay.prototype,"sortX",{get:function(){return this.mSortX},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"sortY",{get:function(){return this.mSortY},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.loadCompleteHander=function(){this.closePlaceholder()},DragonbonesDisplay.prototype.createArmatureDisplay=function(e,i,n){this.scene&&(t.prototype.createArmatureDisplay.call(this,e,i,n),this.play({name:"idle",flip:!1}))},DragonbonesDisplay.prototype.refreshAvatar=function(){t.prototype.refreshAvatar.call(this)},DragonbonesDisplay.prototype.fetchProjection=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.id?(t=this,[4,this.render.mainPeer.fetchProjectionSize(this.id)]):[2];case 1:return t.mProjectionSize=e.sent(),[2]}}))}))},DragonbonesDisplay.prototype.fileComplete=function(t,e,i){e===this.resourceName&&"image"===i&&this.createArmatureDisplay()},DragonbonesDisplay.prototype.fileError=function(t){t===this.resourceName&&this.created()},DragonbonesDisplay.prototype.onArmatureLoopComplete=function(e){t.prototype.onArmatureLoopComplete.call(this,e),this.mArmatureDisplay&&this.mAnimation&&this.render.mainPeer.completeDragonBonesAnimationQueue(this.id)},DragonbonesDisplay.prototype.loadDragonBones=function(t,e,i){this.mLoadQueue.add([{type:h.b.DRAGONBONES,key:this.resourceName,textureUrl:t,jsonUrl:e,boneUrl:i}])},DragonbonesDisplay.prototype.generateReplaceTextureKey=function(){return t.prototype.generateReplaceTextureKey.call(this)+(this.uuid||0)},DragonbonesDisplay.prototype.checkShowNickname=function(){return(this.mTitleMask&o.TitleMask.TQ_NickName)>0},Object.defineProperty(DragonbonesDisplay.prototype,"nickname",{get:function(){return this.mName},enumerable:!1,configurable:!0}),DragonbonesDisplay}(a.b)},function(t,e,i){"use strict";i.r(e),i.d(e,"ItemButton",(function(){return p}));var n,a=i(28),s=i(6),o=i(21),h=i(2),l=i(484),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function ItemButton(e,i,n,l,c,p){var d=t.call(this,e,0,0)||this;return d.bgFrame="bag_icon_common_bg",d.selectFrame="bag_icon_select_bg",d.rarityFrame="bag_icon_rare_bg",d.dpr=l,d.zoom=c,d.bgFrame=n,d.key=i,d.bg=e.make.image({key:i,frame:n}),d.selectbg=e.make.image({key:o.d.uicommon,frame:d.selectFrame}),d.setSize(d.selectbg.width,d.selectbg.height),d.itemIcon=new a.DynamicImage(e,0,0),d.itemIcon.scale=d.dpr/d.zoom,d.countTex=d.scene.make.text({text:"",style:h.UIHelper.blackStyle(l)}).setOrigin(1).setPosition(.5*d.width-5*l,.5*d.height-4*l),d.starImg=d.scene.make.image({key:o.d.uicommon,frame:"bag_star_small_1"}).setOrigin(0),d.starImg.x=.5*-d.width+6*l,d.starImg.y=.5*-d.height+6*l,d.add([d.selectbg,d.bg,d.itemIcon,d.starImg,d.countTex]),d.selectbg.visible=!1,d.enable=p,d.on(s.ClickEvent.Tap,d.onTabClickHandler,d),d}return c(ItemButton,t),ItemButton.prototype.setStateFrames=function(t,e){this.bgFrame=t,this.rarityFrame=e},ItemButton.prototype.setItemData=function(t,e){var i=this;if(void 0===e&&(e=!1),this.itemData=t,this.select=!1,this.itemIcon.visible=!1,this.starImg.visible=!1,!t)return this.countTex.visible=!1,void this.bg.setTexture(this.key,this.bgFrame);5===t.rarity?this.bg.setTexture(this.key,this.rarityFrame):this.bg.setTexture(this.key,this.bgFrame);var n=h.Url.getOsdRes(t.texturePath);if(this.itemIcon.load(n,this,(function(){i.itemIcon.visible=!0})),e||t.count>1?(this.countTex.visible=!0,this.countTex.setText(t.count.toString())):this.countTex.visible=!1,t.grade>0){this.starImg.visible=!0;var a="bag_star_small_"+t.grade;this.starImg.setFrame(a)}else this.starImg.visible=!1},Object.defineProperty(ItemButton.prototype,"select",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(ItemButton.prototype,"BGVisible",{set:function(t){this.bg.visible=t},enumerable:!1,configurable:!0}),ItemButton.prototype.showTips=function(){this.onTabClickHandler()},ItemButton.prototype.onTabClickHandler=function(){l.d.Inst.showTips(this,this.itemData)},ItemButton}(a.ButtonEventDispatcher)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(15),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CamerasManager(e){var i=t.call(this)||this;return i.render=e,i.MINI_VIEW_SIZE=50,i.VIEW_PORT_SIZE=50,i.viewPort=new Phaser.Geom.Rectangle,i.miniViewPort=new Phaser.Geom.Rectangle,i.mCameras=[],i.zoom=i.render.scaleRatio,i}return o(CamerasManager,t),CamerasManager.prototype.startRoomPlay=function(t){this.mMain=t.cameras.main},CamerasManager.prototype.pan=function(t,e,i){var n=this;t*=this.zoom,e*=this.zoom;for(var a=0,s=this.mCameras;a<s.length;a++){s[a].pan(t,e,i)}return new Promise((function(t,e){n.mMain.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){t()}))}))},Object.defineProperty(CamerasManager.prototype,"camera",{get:function(){return this.mMain},set:function(t){this.mMain=t,this.addCamera(t),this.setViewPortSize()},enumerable:!1,configurable:!0}),CamerasManager.prototype.resize=function(t,e){s.Logger.getInstance().debug("resize"),this.resetCameraSize(t,e),s.Logger.getInstance().debug("camera ===== resize"),this.mTarget&&(s.Logger.getInstance().debug("target ===== resize"),this.startFollow(this.mTarget))},CamerasManager.prototype.scrollTargetPoint=function(t,e,i){var n=this;this.mMain&&(this.stopFollow(),i?this.pan(t,e,1e3).then((function(){n.render.syncCameraScroll()})):(this.setScroll(t,e),this.render.syncCameraScroll()))},CamerasManager.prototype.destroy=function(){s.Logger.getInstance().debug("camerasmanager destroy"),this.mMain=void 0,this.mTarget=void 0,this.mCameras=[]},CamerasManager.prototype.resetCameraSize=function(t,e){s.Logger.getInstance().debug("resetCamerSize"),this.render.mainPeer.resetGameraSize(t,e)},CamerasManager.prototype.setViewPortSize=function(){if(this.mMain){var t=this.render.getCurrentRoomSize();if(t){var e=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileWidth/2),i=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileHeight/2);this.viewPort.setSize(e,i);var n=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileWidth/2),a=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileHeight/2);this.miniViewPort.setSize(n,a)}else s.Logger.getInstance().error("room size does not exist")}else s.Logger.getInstance().error("camera does not exist")},CamerasManager}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(0),s=i(294),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function LoginScene(){return t.call(this,{key:a.SceneName.LOGIN_SCENE})||this}return o(LoginScene,t),LoginScene.prototype.preload=function(){},LoginScene.prototype.create=function(){(t.prototype.create.call(this),this.render)&&(this.render.showMediator("Login",!0),this.render.uiManager.setScene(this),this.render.hideLoading())},LoginScene.prototype.init=function(e){t.prototype.init.call(this,e),e&&(this.render=e)},LoginScene.prototype.stop=function(){this.render&&this.render.showMediator("Login",!1),t.prototype.stop.call(this)},LoginScene.prototype.sleep=function(){this.render&&this.render.showMediator("Login",!1)},LoginScene}(s.a)},function(t,e,i){"use strict";i.r(e),i.d(e,"BackTextButton",(function(){return l}));var n,a=i(479),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function BackTextButton(e,i){var n=t.call(this,e,0,0)||this;return n.dpr=i,n.init(),n}return h(BackTextButton,t),BackTextButton.prototype.setText=function(t){this.titleTex.text=t},BackTextButton.prototype.setTextStyle=function(t){this.titleTex.setStyle(t)},BackTextButton.prototype.setFontStyle=function(t){void 0===t&&(t="bold"),this.titleTex.setFontStyle(t)},BackTextButton.prototype.init=function(){var t=100*this.dpr,e=40*this.dpr;this.setSize(t,e),this.enable=!0;var i=this.scene.make.image({key:s.d.uicommon,frame:"back_arrow"});i.x=.5*-this.width+.5*i.width+10*this.dpr;var n=this.scene.make.text({text:"",style:o.UIHelper.whiteStyle(this.dpr,20)}).setOrigin(0,.5);n.setFontStyle("bold"),n.x=i.x+.5*i.width+10*this.dpr,this.titleTex=n,this.add([i,n])},BackTextButton}(a.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"EnergyProgressBar",(function(){return l}));var n,a=i(479),s=i(21),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function EnergyProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n.init(),n}return h(EnergyProgressBar,t),EnergyProgressBar.prototype.setEnergyData=function(t,e){this.powerTex.setText(t+"/"+e),this.powerPro.setProgress(t,e)},EnergyProgressBar.prototype.init=function(){var t=83*this.dpr,e=18*this.dpr;this.setSize(t,e);var i={width:t,height:e,left:9*this.dpr,right:9*this.dpr,top:0,bottom:0};this.powerPro=new a.ProgressMaskBar(this.scene,s.d.uicommon,"explore_physical_bottom","explore_physical_top",void 0,i,i),this.powerPro.x=0,this.powerTex=new a.ImageValue(this.scene,43*this.dpr,15*this.dpr,s.d.uicommon,"explore_physical_icon",this.dpr,o.UIHelper.colorNumberStyle("#ffffff",11*this.dpr)),this.powerTex.x=.5*-t+13*this.dpr,this.powerTex.y=-1*this.dpr,this.powerTex.setFontStyle("bold"),this.powerTex.setStroke("#000000",2*this.dpr),this.powerTex.setOffset(-4*this.dpr,0),this.powerTex.setLayout(1),this.powerTex.setText(""),this.add([this.powerPro,this.powerTex])},EnergyProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ActivityPanel",(function(){return l}));var n,a=i(6),s=i(479),o=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},l=function(t){function ActivityPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.ACTIVITY_NAME,i}return h(ActivityPanel,t),ActivityPanel.prototype.resize=function(t,e){var i=this.scaleWidth;this.scaleHeight;this.content.x=i-20*this.dpr,this.content.y=.5*this.content.height+90*this.dpr,this.setSize(t,e),this.mGameScroll.refreshMask()},ActivityPanel.prototype.show=function(e){this.mInitialized&&this.setInteractive(),t.prototype.show.call(this,e),this.checkUpdateActive()},ActivityPanel.prototype.addListen=function(){this.mInitialized&&this.mGameScroll.addListen()},ActivityPanel.prototype.removeListen=function(){this.mInitialized&&this.mGameScroll.removeListen()},ActivityPanel.prototype.updateUIState=function(t){this.mInitialized&&("activity.taskbtn"===t.name&&(this.mGameScroll.getItemAt(3).visible=t.visible,this.mGameScroll.Sort()))},ActivityPanel.prototype.preload=function(){this.addAtlas(this.key,"activity/activity.png","activity/activity.json"),t.prototype.preload.call(this)},ActivityPanel.prototype.init=function(){var e=this,i=60*this.dpr,n=270*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.mGameScroll=new a.GameScroller(this.scene,{x:0,y:0,width:this.content.width,height:this.content.height-50*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onPointerUpHandler(t)}}),this.content.add(this.mGameScroll);var s=this.scene.make.image({key:this.key,frame:"home_more"});s.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add(s),s.y=.5*n-.5*s.height;for(var o=0;o<4;o++){var h="icon_"+(o+1),l=this.scene.make.image({key:this.key,frame:h});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.name=o+1+"",this.mGameScroll.addItem(l)}this.mGameScroll.Sort(),this.resize(i,n),t.prototype.init.call(this)},ActivityPanel.prototype.onClickHandler=function(t){"4"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICATASK_NAME):"3"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICAFRIEND_NAME):"2"===t?this.render.renderEmitter("showPanel",o.ModuleName.PICAORDER_NAME):"1"===t&&this.render.renderEmitter("showPanel",o.ModuleName.PICARECHARGE_NAME)},ActivityPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.render.mainPeer.getActiveUIData("Activity")];case 1:if(t=a.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},ActivityPanel.prototype.onPointerUpHandler=function(t){var e=t.name;this.onClickHandler(e)},ActivityPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CharacterInfoPanel",(function(){return f}));var n,a,s=i(494),o=i(493),h=i(6),l=i(21),c=i(2),p=i(0),d=i(479),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<i;e++)for(var s=arguments[e],o=0,h=s.length;o<h;o++,a++)n[a]=s[o];return n},m=Phaser.GameObjects.Container,f=function(t){function CharacterInfoPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.commonkey="common_key",i.isOwner=!0,i.key=p.ModuleName.CHARACTERINFO_NAME,i}return u(CharacterInfoPanel,t),CharacterInfoPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a),this.content.setPosition(n/2,a/2),this.mSkillGrideTable.resetMask(),this.content.setInteractive(),this.mCategoryScroll.refreshMask();var s=this.mFirendMenu.getWorldTransformMatrix();this.mFirendMenu.addMask(s.tx-42*this.dpr*this.scale,s.ty,200*this.dpr*this.scale,80*this.dpr*this.scale)},CharacterInfoPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,t&&t.length>0&&this.setPlayerData(t),this.setInteractive(),this.addListen()):this.preload())},CharacterInfoPanel.prototype.hide=function(){t.prototype.hide.call(this)},CharacterInfoPanel.prototype.update=function(e){t.prototype.update.call(this,e),e&&this.setPlayerData(e)},CharacterInfoPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(String(h.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.on(String(h.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.on(String(h.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.on(String(h.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.on(String(h.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.register(),this.render.emitter.on("track",this.onTrackHandler,this),this.render.emitter.on("invite",this.onIntiveHandler,this),this.mCharacterMenu.register(),this.render.emitter.on("addBlack",this.onAddBlacklistHandler,this),this.render.emitter.on("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(String(h.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.off(String(h.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.off(String(h.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.off(String(h.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.off(String(h.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.unregister(),this.render.emitter.off("track",this.onTrackHandler,this),this.render.emitter.off("invite",this.onIntiveHandler,this),this.mCharacterMenu.unregister(),this.render.emitter.off("addBlack",this.onAddBlacklistHandler,this),this.render.emitter.off("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.preload=function(){this.addAtlas(this.key,"player_info/player_info.png","player_info/player_info.json"),this.commonkey=l.c.commonKey,this.addAtlas(this.commonkey,l.d.commonUrl+".png",l.d.commonUrl+".json"),t.prototype.preload.call(this)},CharacterInfoPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i,n),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"bg"}),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.add(this.content),this.content.add(this.bg),this.mainCon=this.scene.make.container(void 0,!1),this.mainCon.setSize(this.bg.width,this.bg.height),this.content.add(this.mainCon);var a=.5*-this.bg.height+43*this.dpr,s="bold "+15*this.dpr+"px Source Han Sans";this.labelText=this.scene.make.text({x:0,y:a,text:c.i18n.t("player_info.title"),style:{font:s,bold:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(.5,0),this.labelText.setStroke("#8F4300",1),this.closeBtn=new h.Button(this.scene,this.commonkey,"close"),this.closeBtn.setPosition(.5*this.mainCon.width-30*this.dpr,a-10*this.dpr),this.likeBtn=new h.Button(this.scene,this.key,"praise_bef","praise_bef","999"),this.likeBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:c.Font.DEFULT_FONT}),this.likeBtn.text.setOrigin(0,.5).x+=10*this.dpr,this.likeBtn.setPosition(.5*this.bg.width-50*this.dpr,a+50*this.dpr),this.likeBtn.visible=!1,this.avatar=new d.UIDragonbonesDisplay(this.scene,this.render),this.avatar.scale=2*this.dpr,this.avatar.x=0,this.avatar.y=-70*this.dpr,this.avatar.once("initialized",(function(){e.avatar.play({name:"idle",flip:!1})})),this.mainCon.add([this.labelText,this.closeBtn,this.likeBtn,this.avatar]),this.mFirendMenu=new P(this.uiManager.render,this.scene,this.dpr,this.scale),this.mFirendMenu.x=.5*this.bg.width-this.mFirendMenu.width-14*this.dpr,this.mFirendMenu.y=.5*-this.bg.height+200*this.dpr,this.mCharacterMenu=new _(this.uiManager.render,this.scene,this.dpr,this.scale),this.mCharacterMenu.x=.5*this.bg.width-this.mCharacterMenu.width-14*this.dpr,this.mCharacterMenu.y=.5*-this.bg.height+100*this.dpr,this.mExitBtn=new h.NineSliceButton(this.scene,.5*-this.bg.width+40*this.dpr,this.labelText.y+.5*this.labelText.height,48*this.dpr,26*this.dpr,this.commonkey,"yellow_btn_normal_s","注销",this.dpr,this.scale,{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:10*this.dpr}),this.mExitBtn.setTextStyle({fontSize:10*this.dpr,fontFamily:c.Font.DEFULT_FONT}),this.mainCon.add([this.mFirendMenu,this.mCharacterMenu,this.mExitBtn]);var l=Math.round(.5*-this.bg.width+25*this.dpr),p=Math.round(.5*this.bg.height-324*this.dpr)+30*this.dpr,u=Math.round(13*this.dpr);this.nickName=new h.BBCodeText(this.scene,l,p,"",{}).setOrigin(0,.5).setFontSize(u).setFontFamily(c.Font.DEFULT_FONT),this.nickEditor=new h.Button(this.scene,this.key,"edit","edit"),this.nickEditor.setPosition(.5*this.bg.width-30*this.dpr,p).visible=!1;var m=this.scene.make.image({x:0,y:this.nickName.y+12*this.dpr,key:this.key,frame:"splitters"});m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.scaleY=this.dpr,this.idText=new h.BBCodeText(this.scene,l,p).setFontSize(u).setOrigin(0,.5).setFontFamily(c.Font.DEFULT_FONT).setColor("#0062BC");var f=this.scene.make.image({x:0,y:this.idText.y+12*this.dpr,key:this.key,frame:"splitters"});f.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),f.scaleY=this.dpr,this.titleName=new h.BBCodeText(this.scene,l,p+30*this.dpr).setFontSize(u).setOrigin(0,.5).setFontFamily(c.Font.DEFULT_FONT);var g=this.scene.make.image({x:0,y:this.titleName.y+12*this.dpr,key:this.key,frame:"splitters"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.scaleY=this.dpr;var v=this.scene.make.image({x:0,y:0,key:this.key,frame:"level_bg"});v.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.lvText=this.scene.make.text({x:0,y:0,text:"lv 98",style:{color:"#996600",fontSize:u,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.lvCon=this.scene.make.container(void 0,!1),this.lvCon.setSize(v.width,v.height),this.lvCon.setPosition(.5*-this.content.width+.5*this.lvCon.width+20*this.dpr,.5*-this.content.height+90*this.dpr),this.lvCon.add([v,this.lvText]),this.mainCon.add([this.nickName,this.nickEditor,m,f,g,this.titleName,this.lvCon]);var b=260*this.dpr,T=210*this.dpr;this.bottomCon=this.scene.make.container(void 0,!1),this.bottomCon.setSize(b,T),this.bottomCon.setPosition(0,.5*this.bg.height-.5*T-30*this.dpr),this.mainCon.add(this.bottomCon),this.bottombg=this.scene.make.graphics(void 0,!1);var S=32*this.dpr,x=.5*-T+.5*S-3*this.dpr;this.mCategoryScroll=new h.GameScroller(this.scene,{x:0,y:x,width:b,height:S,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}});var w=this.scene.textures.getFrame(this.key,"skill_bg"),D=w.width+5*this.dpr,C=w.height+8*this.dpr,I=this.bottomCon.width,k=200*this.dpr,B=x+.5*S+.5*k;this.mSkillGrideTable=this.createGrideTable(0,B,I,k,D,C,(function(){return new y(e.scene,0,0,e.key,e.dpr)}),new c.Handler(this,this.onSelectItemHandler));var E=150*this.dpr;this.mAttrPanel=new o.CharacterAttributePanel(this.scene,0,B,I-30*this.dpr,E,this.key,this.dpr),this.bottomCon.add([this.bottombg,this.mCategoryScroll,this.mSkillGrideTable,this.mAttrPanel]);var A=-60*this.dpr,O=.5*this.bottomCon.height-20*this.dpr;this.addFriendBtn=new h.NineSliceButton(this.scene,0,O,94*this.dpr,37*this.dpr,this.key,"button_g",c.i18n.t("player_info.add_friend"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setFrameNormal("button_g"),this.privaCharBtn=new h.NineSliceButton(this.scene,A,O,94*this.dpr,37*this.dpr,this.commonkey,"yellow_btn",c.i18n.t("player_info.private_chat"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setTextStyle({fontSize:16*this.dpr,color:"#000000"}),this.privaCharBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.bottomCon.add([this.addFriendBtn,this.privaCharBtn]),this.content.visible=!1,this.resize(i,n),t.prototype.init.call(this)},CharacterInfoPanel.prototype.reqPlayerInfo=function(){this.render.renderEmitter("queryOwnerInfo")},CharacterInfoPanel.prototype.setPlayerData=function(t){if(this.mInitialized){this.mCharacterData=t,this.content.visible=!0;var e=t.nickname?t.nickname:"???",i=t.currentTitle?t.currentTitle:"???",n=(t.level&&t.level.currentLevelExp&&t.level.currentLevelExp,t.level&&t.level.nextLevelExp&&t.level.nextLevelExp,t.cid,t.level&&t.level.level?t.level.level:0),s=this.getspaceStr(1*this.dpr);if(this.avatar&&t.avatarSuit){var o=p.AvatarSuitType.getSuitsFromItem(t.avatarSuit);this.avatar.setSuits(o.suits),this.avatar.load({id:0,avatar:o.avatar})}this.titleName.setText(this.getRichLabel(c.i18n.t("player_info.player_title"))+s+i);var h=t.like?t.like+"":"???";this.likeBtn.setText(h+"");var l=.5*this.bg.width-.5*this.likeBtn.width-this.likeBtn.text.width;this.likeBtn.x=l-20*this.dpr,this.lvText.text="lv "+n,this.idText.setText("(52365404)");var d=new Map,u=t.lifeSkills?t.lifeSkills:[];if(d.set(a.Skill,u),t.isUser){this.nickName.setText(this.getRichLabel(c.i18n.t("player_info.nick_name"))+s+e),this.likeBtn.setFrame("praise_aft"),d.set(a.Attribute,t.properties?t.properties:[]),d.set(a.Badge,t.badges?t.badges:[]),this.addFriendBtn.visible=!1,this.privaCharBtn.visible=!1,this.mFirendMenu.visible=!1,this.mExitBtn.visible=!0,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height);var m=200*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,m);var f=0,y=this.mCategoryScroll.y+.5*m+0*this.dpr;this.mSkillGrideTable.refreshPos(f,y),this.mSkillGrideTable.setColumnCount(3),this.isOwner=!0,this.mCharacterMenu.visible=!1,this.mAttrPanel.setSize(this.mAttrPanel.width,m),this.mAttrPanel.y=y+15*this.dpr,this.mAttrPanel.space=20*this.dpr}else{this.nickName.setText(this.getRichLabel(c.i18n.t("player_info.nick_name"))+s+e),this.likeBtn.setFrame("praise_bef"),d.set(a.Attribute,t.properties?t.properties:[]),d.set(a.Badge,t.badges?t.badges:[]),this.addFriendBtn.visible=!!t.friend&&!t.friend,this.privaCharBtn.visible=!!t.friend&&t.friend,this.mExitBtn.visible=!1,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height-55*this.dpr);m=150*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,m);f=0,y=this.mCategoryScroll.y+.5*m+0*this.dpr;this.mSkillGrideTable.refreshPos(f,y),this.mSkillGrideTable.setColumnCount(2),this.isOwner=!1,this.mCharacterMenu.visible=!0,this.mAttrPanel.setSize(this.mAttrPanel.width,m),this.mAttrPanel.y=y+15*this.dpr,this.mAttrPanel.space=10*this.dpr}this.idText.x=this.nickName.x+this.nickName.width*(1-this.nickName.originX)+8*this.dpr,this.mFirendMenu.visible=!1,this.setSubCategory(d),this.setFriendRelation(p.FriendRelationEnum.Null)}else this.mShowData=t},CharacterInfoPanel.prototype.setFriendRelation=function(t){this.isOwner||(this.mRelation=t,this.mFirendMenu.visible=t===p.FriendRelationEnum.Friend,this.mCharacterMenu.setIsBlack(t===p.FriendRelationEnum.Blacklist),this.addFriendBtn.visible=t!==p.FriendRelationEnum.Blacklist,t===p.FriendRelationEnum.Followed||t===p.FriendRelationEnum.Friend?this.addFriendBtn.setText(c.i18n.t("friendlist.unfollow")):this.addFriendBtn.setText(c.i18n.t("friendlist.follow")))},CharacterInfoPanel.prototype.destroy=function(){this.mSkillGrideTable.destroy(),this.mCategoryScroll.destroy(),this.mBackGround&&this.mBackGround.clear(),t.prototype.destroy.call(this)},CharacterInfoPanel.prototype.createGrideTable=function(t,e,i,n,a,s,o,l){var c=this,p={x:t,y:e,table:{width:i,height:n,columns:3,cellWidth:a,cellHeight:s,reuseCellContainer:!0,cellPadX:24*this.dpr,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,e){t.scene;var i=t.item;return null===e&&(e=o()),e.setData({item:i}),e.setItemData(i,c.isOwner),e}},d=new h.GameGridTable(this.scene,p);return d.layout(),d.on("cellTap",(function(t){t&&l.runWith(t)})),d},CharacterInfoPanel.prototype.OnClosePanel=function(){this.render.renderEmitter("hide")},CharacterInfoPanel.prototype.setSubCategory=function(t){var e=this,i=(c.i18n.t("player_info.option_live"),c.i18n.t("player_info.option_attribute"),c.i18n.t("player_info.option_badge"),this.mScene.textures.getFrame(this.key,"title_select").width),n=this.mCategoryScroll.getItemList().concat();this.mCategoryScroll.clearItems(!1);for(var a=0,s=n;a<s.length;a++){s[a].visible=!1}var o=0;t.forEach((function(t,a){var s,l=e.getOptionName(a);o<n.length?s=n[o]:((s=new h.Button(e.scene,e.key,"title_normal","title_select",l)).width=i,s.height=41*e.dpr,n.push(s),s.setTextStyle({color:"#2B4BB5",fontSize:12*e.dpr,fontFamily:c.Font.DEFULT_FONT}),s.disInteractive(),s.removeListen()),s.visible=!0,s.setText(l),s.setData("subData",t),s.setData("optiontype",a),e.mCategoryScroll.addItem(s),o++})),n.length<=3?this.mCategoryScroll.setAlign(1):this.mCategoryScroll.setAlign(2),this.onSelectSubCategoryHandler(n[0])},CharacterInfoPanel.prototype.onSelectSubCategoryHandler=function(t){this.curSelectCategeory&&(this.curSelectCategeory.changeNormal(),this.curSelectCategeory.setTextColor("#2B4BB5")),t.changeDown(),t.setTextColor("#996600"),this.curSelectCategeory=t;var e=t.getData("subData"),i=t.getData("optiontype");i===a.Skill?(this.mSkillGrideTable.setItems(e),this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!0):i===a.Attribute?(e&&this.mAttrPanel.setAttributeData(e),this.mAttrPanel.visible=!0,this.mSkillGrideTable.setItems([]),this.mSkillGrideTable.visible=!1):i===a.Badge&&(this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!1)},CharacterInfoPanel.prototype.onSelectItemHandler=function(t){},CharacterInfoPanel.prototype.onEditorHandler=function(){var t=247*this.dpr,e=this.content.height;this.editorPanel||(this.editorPanel=new s.CharacterEditorPanel(this.scene,0,0,t,e,this.key,this.dpr)),this.content.add(this.editorPanel),this.editorPanel.visible=!0,this.editorPanel.on("editorHide",this.onEditorPanelHideHandler,this),this.setMainUIVisible(!1)},CharacterInfoPanel.prototype.onAddFriendHandler=function(){if(this.mCharacterData)switch(this.mRelation){case p.FriendRelationEnum.Friend:case p.FriendRelationEnum.Followed:this.render.renderEmitter("unfollow",this.mCharacterData.cid);break;case p.FriendRelationEnum.Fans:case p.FriendRelationEnum.Null:this.render.renderEmitter("follow",this.mCharacterData.cid)}},CharacterInfoPanel.prototype.onTradingHandler=function(){},CharacterInfoPanel.prototype.onPrivateChatHandler=function(){},CharacterInfoPanel.prototype.onExitHandler=function(){this.mWorld.exitUser()},CharacterInfoPanel.prototype.onEditorPanelHideHandler=function(){this.mainCon.visible=!0,this.remove(this.editorPanel),this.editorPanel.off("editorHide",this.onEditorPanelHideHandler,this),this.editorPanel.destroy(),this.editorPanel=null,this.setMainUIVisible(!0)},CharacterInfoPanel.prototype.setMainUIVisible=function(t){this.avatar.visible=t,this.mCategoryScroll.visible=t,this.mSkillGrideTable.visible=t,this.mainCon.visible=t},CharacterInfoPanel.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#2B4BB5"),"[stroke="+e+"][color="+e+"]"+t+":[/color][/stroke]"},CharacterInfoPanel.prototype.getspaceStr=function(t){for(var e="",i=0;i<t;i++)e+=" ";return e},CharacterInfoPanel.prototype.getOptionName=function(t){var e="";return t===a.Skill?e=c.i18n.t("player_info.option_live"):t===a.Attribute?e=c.i18n.t("player_info.option_attribute"):t===a.Badge?e=c.i18n.t("player_info.option_badge"):t===a.Title&&(e=c.i18n.t("player_info.option_title")),e},CharacterInfoPanel.prototype.onTrackHandler=function(){this.mCharacterData&&this.render.renderEmitter("track",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onIntiveHandler=function(){this.mCharacterData&&this.render.renderEmitter("invite",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onAddBlacklistHandler=function(){this.mCharacterData&&this.render.renderEmitter("addBlack",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onRemoveBlacklistHandler=function(){this.mCharacterData&&this.render.renderEmitter("removeBlack",this.mCharacterData.cid)},CharacterInfoPanel}(d.BasePanel);!function(t){t[t.Skill=0]="Skill",t[t.Attribute=1]="Attribute",t[t.Badge=2]="Badge",t[t.Title=3]="Title",t[t.Avatar=4]="Avatar"}(a||(a={}));var y=function(t){function CharacterOwnerItem(e,i,n,a,s){var o=t.call(this,e,i,n)||this;o.dpr=0;var l=o.scene.make.image({x:0,y:0,key:a,frame:"skill_bg"});return l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.nameText=o.scene.make.text({x:-1*s,y:0,text:"",style:{color:"#996600",fontSize:12*s,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),o.lvText=o.scene.make.text({x:-1*s,y:0,text:"",style:{color:"#996600",fontSize:12*s,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),o.progressBar=new h.ProgressBar(o.scene,{x:48*s/2,y:15*s,width:41*s,height:4*s,background:{x:0,y:0,width:41*s,height:4*s,config:{top:1*s,left:2*s,right:2*s,bottom:1*s},key:a,frame:"slider_bg"},bar:{x:0,y:0,width:41*s,height:4*s,config:{top:1*s,left:2*s,right:2*s,bottom:1*s},key:a,frame:"slider_rate"},dpr:s,textConfig:void 0}),o.icon=new d.DynamicImage(o.scene,.5*-l.width+22*s,0),o.add([l,o.icon,o.nameText,o.lvText,o.progressBar]),o.setSize(l.width,l.height),o.dpr=s,o.key=a,o}return u(CharacterOwnerItem,t),CharacterOwnerItem.prototype.setItemData=function(t,e){var i=this;void 0===e&&(e=!1),this.itemData=t,this.nameText.text=t.name;var n=e?-16*this.dpr:-11*this.dpr,a=e?20*this.dpr:25*this.dpr,s=10*this.dpr;this.nameText.y=n+.5*s,this.icon.setTexture(this.key,"test_skillicon");var o=this.icon.width;t.level?(this.lvText.text=t.level.level,this.lvText.y=n+a,this.progressBar.setProgress(t.level.currentLevelExp,t.level.nextLevelExp),this.progressBar.visible=e):(this.progressBar.visible=!1,this.lvText.visible=!1);var h=c.Url.getOsdRes(t.display.texturePath);this.icon.load(h,this,(function(){i.icon.scale=i.dpr;var t=.5*-i.width+.5*o+6*i.dpr;i.icon.setPosition(t,0)}))},CharacterOwnerItem}(m),g=function(t){function Menu(e,i,n,a,s,o){var h=t.call(this,i)||this;return h.render=e,h.mDpr=n,h.mScale=a,h.setSize(s,o),h.draw(),h}return u(Menu,t),Menu.prototype.register=function(){},Menu.prototype.unregister=function(){},Menu.prototype.addMask=function(t,e,i,n){this.maskGraphic||(this.maskGraphic=this.scene.make.graphics(void 0,!1)),this.maskGraphic.x=t,this.maskGraphic.y=e,this.maskGraphic.fillRect(.5*-i,.5*-n,i,n),this.setMask(this.maskGraphic.createGeometryMask())},Menu.prototype.draw=function(){this.createBackground()},Menu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t}),this.addAt(this.background,0)},Menu}(m),P=function(t){function FriendMenu(e,i,n,a){var s=t.call(this,e,i,n,a,58*n,40*n)||this;return s.isExpand=!1,s}return u(FriendMenu,t),FriendMenu.prototype.register=function(){this.trackBtn.on(String(h.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.on(String(h.ClickEvent.Tap),this.onInviteHandler,this);var t=this.operation,e=t.width,i=t.height;this.operation.setInteractive(new Phaser.Geom.Rectangle(-e,-i,3*e,3*i),Phaser.Geom.Rectangle.Contains),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.unregister=function(){this.trackBtn.off(String(h.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.off(String(h.ClickEvent.Tap),this.onInviteHandler,this),this.operation.disableInteractive(),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.destroy=function(){this.operationContaienr&&this.operationContaienr.destroy(),this.operation&&this.operation.destroy(),this.inviteBtn&&this.inviteBtn.destroy(),this.trackBtn&&this.trackBtn.destroy(),this.tween&&this.tween.stop(),this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.buttons=[]},FriendMenu.prototype.expand=function(){var t=this;if(!this.tween||!this.tween.isPlaying()){this.operationContaienr.remove(this.operation),this.operationContaienr.remove(this.background),this.operationContaienr.add(this.buttons);var e=this.getBounds();if(this.isExpand=!0,e){var i=e.width+8*this.mDpr;this.setSize(i,this.height),this.createBackground(),this.operationContaienr.addAt(this.background,0),this.operationContaienr.x=.5*e.width,this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*-e.width,alpha:1},duration:100}),this.autoCollapseTime=setTimeout((function(){t.autoCollapseTime=null,t.collapse()}),3e3)}}},FriendMenu.prototype.collapse=function(){var t=this;this.tween&&this.tween.isPlaying()||(this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*this.width},duration:100,onComplete:function(){t.operationContaienr.remove(__spreadArrays(t.buttons),!1),t.operationContaienr.add(t.operation),t.setSize(58*t.mDpr,40*t.mDpr),t.createBackground(),t.operationContaienr.addAt(t.background,0),t.operationContaienr.x=0,t.isExpand=!1}}))},FriendMenu.prototype.draw=function(){this.operationContaienr=this.scene.make.container(void 0,!1),this.add(this.operationContaienr),this.buttons=[],this.inviteBtn=this.createButton(c.i18n.t("player_info.invite")),this.buttons.push(this.inviteBtn),this.trackBtn=this.createButton(c.i18n.t("player_info.track")),this.buttons.push(this.trackBtn),this.operation=this.scene.make.text({x:.5*this.width,y:.5*this.height,text:c.i18n.t("player_info.operation"),style:{color:"#FFD248",fontSize:10*this.mDpr,fontFamily:c.Font.DEFULT_FONT}},!1).setOrigin(.5);for(var t=0;t<this.buttons.length;t++)this.buttons[t].x=0===t?.5*this.buttons[t].width+6*this.mDpr:this.buttons[t-1].x+.5*(this.buttons[t-1].width+this.buttons[t].width)+6*this.mDpr,this.buttons[t].y=.5*this.height;this.collapse()},FriendMenu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.clear(),this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t})},FriendMenu.prototype.onTrackHandler=function(){this.render.renderEmitter("track"),this.collapse()},FriendMenu.prototype.onInviteHandler=function(){this.render.renderEmitter("invite"),this.collapse()},FriendMenu.prototype.onSwitchOperationHandler=function(){this.isExpand?this.collapse():this.expand()},FriendMenu.prototype.createButton=function(t){var e=this.mDpr,i=this.mScale,n=new h.NineSliceButton(this.scene,-0,0,48*e,26*e,l.c.commonKey,"yellow_btn_normal_s",t,e,i,{left:8*e,top:8*e,right:8*e,bottom:10*e});return n.setTextStyle({color:"#996600",fontSize:10*e,fontFamily:c.Font.DEFULT_FONT}),n},FriendMenu}(g),_=function(t){function CharacterMenu(e,i,n,a){return t.call(this,e,i,n,a,58*n,36*n)||this}return u(CharacterMenu,t),CharacterMenu.prototype.register=function(){this.addBlacklistBtn.on(String(h.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.unregister=function(){this.addBlacklistBtn.off(String(h.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.setIsBlack=function(t){this.isBlack=t,this.addBlacklistBtn.setText(c.i18n.t(t?"player_info.remove_black":"player_info.add_black"))},CharacterMenu.prototype.draw=function(){t.prototype.draw.call(this),this.addBlacklistBtn=new h.NineSliceButton(this.scene,0,0,55*this.mDpr,24*this.mDpr,l.c.commonKey,"red_btn_normal",c.i18n.t("player_info.add_black"),this.mDpr,this.mScale,{left:12*this.mDpr,top:12*this.mDpr,right:12*this.mDpr,bottom:12*this.mDpr}),this.addBlacklistBtn.setTextStyle({color:"#FFFFFF",fontSize:10*this.mDpr,fontFamily:c.Font.DEFULT_FONT}),this.addBlacklistBtn.x=.5*this.width,this.addBlacklistBtn.y=6*this.mDpr+.5*this.addBlacklistBtn.height,this.add(this.addBlacklistBtn)},CharacterMenu.prototype.onAddBlackHandler=function(){this.render.emitter.emit(this.isBlack?"removeBlack":"addBlack")},CharacterMenu}(g)},function(t,e,i){"use strict";i.r(e),i.d(e,"GraphicsProgressBar",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function GraphicsProgressBar(e,i,n,a,s,o){void 0===o&&(o=!0);var h=t.call(this,e,i,n)||this;return h.value=.5,h.bgGraphics=h.scene.make.graphics(void 0,!1),h.barGraphics=h.scene.make.graphics(void 0,!1),h.add([h.bgGraphics,h.barGraphics]),h.setSize(a,s),h.bgColor=0,h.barColor=267386880,h.bgGraphics.clear(),h.bgGraphics.fillStyle(h.bgColor,1),h.bgGraphics.fillRect(0,0,h.width,h.height),h.setValue(h.value),h}return a(GraphicsProgressBar,t),GraphicsProgressBar.prototype.setColor=function(t,e){this.barColor=t,e&&(this.bgColor=e),this.bgGraphics.clear(),this.bgGraphics.fillStyle(this.bgColor,1),this.bgGraphics.fillRect(0,0,this.width,this.height),this.setValue(this.value)},GraphicsProgressBar.prototype.setValue=function(t){this.value=t;var e=this.width*(this.isHorizontal?t:1),i=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRect(0,0,e,i)},GraphicsProgressBar.prototype.setRoundedRectValue=function(t,e){this.value=t;var i=this.width*(this.isHorizontal?t:1),n=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRoundedRect(0,0,i,n,e)},GraphicsProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHandheldPanel",(function(){return c}));var n,a=i(6),s=i(2),o=i(0),h=i(479),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaHandheldPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isExtendsGrid=!1,i.key=o.ModuleName.PICAHANDHELD_NAME,i}return l(PicaHandheldPanel,t),PicaHandheldPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.updateLayout(),this.isExtendsGrid=!1},PicaHandheldPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData(),this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_handheldlist")):this.preload())},PicaHandheldPanel.prototype.hide=function(){this.mShow=!1,this.removeListen(),t.prototype.hide.call(this)},PicaHandheldPanel.prototype.addListen=function(){this.mInitialized&&this.handeldEqiped.addListen()},PicaHandheldPanel.prototype.removeListen=function(){this.mInitialized&&this.handeldEqiped.removeListen()},PicaHandheldPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaHandheldPanel.prototype.setEqipedDatas=function(t){var e=t.handheld,i=(e=e.sort((function(t,e){return t.latestUse>=e.latestUse?1:-1}))).splice(0,3);e=e.sort((function(t,e){return t.recommended>=e.recommended?1:-1})),e=i.concat(e);var n,a={id:"empty_handed",count:0};if(""!==t.currentHandheldId&&t.currentHandheldId)for(var s=0,o=e;s<o.length;s++){var h=o[s];if(h.id===t.currentHandheldId){n=h;break}}else n=a;if(e.unshift(a),this.handeldEqiped.setItemData(n),this.isExtendsGrid){var l=14-e.length,c=l>0?e.concat(new Array(l)):e;if(this.mPropGrid.setItems(c),n)for(var p=0,d=this.mPropGrid.getCells();p<d.length;p++){var u=d[p];if(u&&u.container){var m=u.container;m.itemData===n?(m.isSelect=!0,this.curHandheldItem=u):m.isSelect=!1}}}},PicaHandheldPanel.prototype.preload=function(){this.addAtlas(this.key,"hand_equp/hand_equp.png","hand_equp/hand_equp.json"),t.prototype.preload.call(this)},PicaHandheldPanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.gridContent=this.scene.make.container(void 0,!1),this.add(this.gridContent),this.gridContent.setSize(i,150*this.dpr),this.gridContent.x=.5*i,this.gridContent.y=n-.5*this.gridContent.height-200*this.dpr;var o=this.scene.make.graphics(void 0,!1);o.fillStyle(3355443,.5),o.fillRect(.5*-i,.5*-this.gridContent.height,i,150*this.dpr),this.gridContent.add(o),this.handeldEqiped=new d(this.scene,0,0,this.key,this.dpr),this.handeldEqiped.setClickHandler(new s.Handler(this,this.onHandheldEqipedHandler),new s.Handler(this,this.onShortcutHandler)),this.add(this.handeldEqiped);var h=this.scene.textures.getFrame(this.key,"equp_bg"),l=h.width+10*this.dpr,c=h.height+10*this.dpr,u={x:0,y:0,table:{width:i-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:l,cellHeight:c,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new p(n,0,0,e.key,e.dpr)),i.setItemData(a),i}};this.mPropGrid=new a.GameGridTable(this.scene,u),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){e.onSelectItemHandler(t)})),this.gridContent.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)}},PicaHandheldPanel.prototype.updateData=function(){this.updateLayout()},PicaHandheldPanel.prototype.updateLayout=function(){var t=this.scaleWidth,e=this.scaleHeight,i=t-.5*this.handeldEqiped.width-8*this.dpr,n=0;this.gridContent.y=e-.5*this.gridContent.height,this.isExtendsGrid?(n=e-.5*this.handeldEqiped.height-this.gridContent.height,this.gridContent.visible=!0,this.mPropGrid.resetMask(),this.handeldEqiped.normal(),this.handeldEqiped.hideShortcut()):(n=e-.5*this.handeldEqiped.height-10*this.dpr,this.gridContent.visible=!1,this.handeldEqiped.waiting(),this.handeldEqiped.isEmptyHanded||this.handeldEqiped.showShortcut()),this.handeldEqiped.setPosition(i,n)},PicaHandheldPanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;e&&(this.curHandheldItem&&(this.curHandheldItem.isSelect=!1),t.isSelect=!0,this.curHandheldItem=t,t.isEmptyHanded?this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_clearhandheld"):this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_changehandheld",e.id))},PicaHandheldPanel.prototype.onHandheldEqipedHandler=function(t){this.isExtendsGrid=!this.isExtendsGrid,this.isExtendsGrid?(this.gridContent.visible=!0,this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_handheldlist"),this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_openeqiped",!0)):(this.mPropGrid.setItems([]),this.gridContent.visible=!1,this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_openeqiped",!1)),this.updateLayout()},PicaHandheldPanel.prototype.onShortcutHandler=function(t){this.render.renderEmitter(o.ModuleName.PICAHANDHELD_NAME+"_clearhandheld")},PicaHandheldPanel}(h.BasePanel),p=function(t){function HandheldItem(e,i,n,a,s){var o=t.call(this,e,i,n)||this;return o.mIsSelect=!1,o.dpr=s,o.key=a,o.bg=o.scene.make.image({key:a,frame:"equp_bg"}),o.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.selectbg=o.scene.make.image({key:a,frame:"click_bg"}),o.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.icon=new h.DynamicImage(e,0,0),o.add([o.bg,o.selectbg,o.icon]),o.setSize(o.selectbg.width,o.selectbg.height),o.isSelect=!1,o}return l(HandheldItem,t),HandheldItem.prototype.setItemData=function(t){var e=this;if(this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);if(this.icon.visible=!0,this.selectbg.visible=this.mIsSelect,this.isEmptyHanded)this.icon.setTexture(this.key,"empty_handed");else{var i=t.display,n=s.Url.getOsdRes(i.texturePath);this.icon.load(n,this,(function(){e.icon.scale=1,e.icon.displayWidth=34*e.dpr,e.icon.scaleY=e.icon.scaleX}))}},Object.defineProperty(HandheldItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldItem.prototype,"isEmptyHanded",{get:function(){return!(!this.itemData||"empty_handed"!==this.itemData.id)},enumerable:!1,configurable:!0}),HandheldItem}(Phaser.GameObjects.Container),d=function(t){function HandheldEqiped(e,i,n,a,s){var o=t.call(this,e,i,n)||this;o.isExtendsGrid=!1,o.key=a,o.dpr=s,o.bg=o.scene.make.image({key:a,frame:"button_h"}),o.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutCon=o.scene.make.container(void 0,!1),o.shortcutbg=o.scene.make.image({key:a,frame:"superscript_h"}),o.shortcutbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutIcon=o.scene.make.image({key:a,frame:"hand"}),o.shortcutIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),o.shortcutCon.add([o.shortcutbg,o.shortcutIcon]);var l=40*s;return o.shortcutCon.setSize(l,l),o.shortcutbg.x=.5*-o.shortcutCon.width+.5*o.shortcutbg.width-5*s,o.shortcutbg.y=.5*o.shortcutCon.height-.5*o.shortcutbg.height+5*s,o.shortcutIcon.x=o.shortcutbg.x,o.shortcutIcon.y=o.shortcutbg.y,o.icon=new h.DynamicImage(e,0,0),o.icon.setTexture(o.key,"empty_handed"),o.shortcutCon.on("pointerup",o.onShortcutHandler,o),o.add([o.bg,o.icon,o.shortcutCon]),o.setSize(o.bg.width,o.bg.height),o.shortcutCon.setPosition(.5*o.width+.5*l-20*s,.5*-o.height-.5*l+15*s),o.on("pointerup",o.onClickHandler,o),o.hideShortcut(),o}return l(HandheldEqiped,t),HandheldEqiped.prototype.normal=function(){this.bg.setFrame("button_h"),this.setChildAlpha(1)},HandheldEqiped.prototype.waiting=function(){this.bg.setFrame("button_h"),this.setChildAlpha(.5)},HandheldEqiped.prototype.setItemData=function(t){var e=this;if(this.itemData=t,this.isEmptyHanded)this.icon.setScale(1),this.icon.setTexture(this.key,"empty_handed"),this.hideShortcut();else{var i=t.display,n=s.Url.getOsdRes(i.texturePath);this.icon.load(n,this,(function(){e.icon.displayWidth=24*e.dpr,e.icon.scaleY=e.icon.scaleX})),this.isExtendsGrid||this.showShortcut()}},HandheldEqiped.prototype.addListen=function(){this.setInteractive(),this.shortcutCon.setInteractive()},HandheldEqiped.prototype.removeListen=function(){this.disableInteractive(),this.shortcutCon.disableInteractive()},HandheldEqiped.prototype.setClickHandler=function(t,e){this.clickHandler=t,this.shortcutHandler=e},HandheldEqiped.prototype.setChildAlpha=function(t){this.bg.setAlpha(t),this.icon.setAlpha(t),this.shortcutbg.setAlpha(t),this.shortcutIcon.setAlpha(t)},HandheldEqiped.prototype.hideShortcut=function(){this.shortcutCon.visible=!1,this.shortcutCon.disableInteractive()},HandheldEqiped.prototype.showShortcut=function(){this.shortcutCon.visible=!0,this.shortcutCon.setInteractive()},Object.defineProperty(HandheldEqiped.prototype,"isCanShowShortcut",{get:function(){return!this.isEmptyHanded},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldEqiped.prototype,"isEmptyHanded",{get:function(){return!this.itemData||"empty_handed"===this.itemData.id},enumerable:!1,configurable:!0}),HandheldEqiped.prototype.onShortcutHandler=function(){this.shortcutHandler&&this.shortcutHandler.runWith(this.itemData)},HandheldEqiped.prototype.onClickHandler=function(){this.isExtendsGrid=!this.isExtendsGrid,this.clickHandler&&this.clickHandler.runWith(this.itemData)},HandheldEqiped}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaChatPanel",(function(){return m}));var n,a,s=i(6),o=i(479),h=i(21),l=i(0),c=i(2),p=i(495),d=i(496),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}};!function(t){t[t.CurrentScene=0]="CurrentScene",t[t.World=1]="World",t[t.Team=2]="Team",t[t.Private=3]="Private",t[t.System=4]="System"}(a||(a={}));var m=function(t){function PicaChatPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.chatCatchArr=[],i.chatMaxLen=100,i.MAX_HEIGHT=460*i.dpr,i.MIN_HEIGHT=100*i.dpr,i.scale=1,i.key=l.ModuleName.PICACHAT_NAME,i.UIType=s.UIType.Scene,i}return u(PicaChatPanel,t),PicaChatPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mShowData=e,this.mInitialized&&(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.checkUpdateActive())},PicaChatPanel.prototype.resize=function(e,i){var n=this.scale,a=this.scene.cameras.main.width,s=this.scene.cameras.main.height;e=a,i=i||133*this.dpr,this.giftPanel&&this.giftPanel.visible&&(i=185*this.dpr),this.setSize(a,i);var o=this.scene.textures.getFrame(this.key,"title_bg"),h=o?a/this.scale/o.width:1;this.mTitleBg.scaleX=h,this.mTitleBg.x=a/this.scale/2,this.y=s-this.height,this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,a/this.scale,i/this.scale),this.mTextArea.childrenMap.child.setMinSize(e,(i-16*this.dpr)*n),this.mTextArea.layout(),this.mTextArea.setPosition(this.width/2+4*this.dpr,this.y+this.mTextArea.height/2+10*this.dpr*n),this.mTextArea.childrenMap.text.y=8*this.dpr,this.mTextArea.scrollToBottom(),this.giftPanel&&(this.giftPanel.resize(),this.giftPanel.y=this.height-.5*this.giftPanel.height,this.giftPanel.x=.5*this.width),t.prototype.resize.call(this,e,i),this.mBackground.input=void 0,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,a/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains)},PicaChatPanel.prototype.chatHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e,i,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.render.mainPeer.getPlayerName(t.chatSenderid)];case 1:return e=a.sent(),i="",e?i=e:t.chatSenderid&&(i=c.i18n.t("chat.mystery")),n="#ffffff",t.chatSetting&&(n=t.chatSetting.textColor),this.showChat("[color="+n+"]["+this.getChannel(t.chatChannel)+"]"+i+": "+t.chatContext+"[/color]\n"),[2]}}))}))},PicaChatPanel.prototype.showChat=function(t){this.appendChat(t)},PicaChatPanel.prototype.getChannel=function(t){switch(t){case a.CurrentScene:return c.i18n.t("chat.current");case a.World:return c.i18n.t("chat.world");default:return c.i18n.t("chat.system")}},PicaChatPanel.prototype.setGiftData=function(t){this.giftPanel.setGiftDatas(t.commodities)},PicaChatPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom()),this.mInputText&&this.mInputText instanceof p.PicaChatInputPanel&&this.mInputText.appendChat(t)},PicaChatPanel.prototype.isShowChatPanel=function(){return!(!this.mTextArea||!this.mTextArea.visible)},PicaChatPanel.prototype.hide=function(){this.mTextArea&&this.mTextArea.destroy(),this.mOutputText&&this.mOutputText.destroy(),this.mShow=!1,this.removeListen(),t.prototype.hide.call(this)},PicaChatPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.mChatBtn.setInteractive(),this.mEmojiBtn.setInteractive(),this.mTextArea.visible&&this.mScrollBtn.setInteractive(),this.mGiftBtn.setInteractive(),this.mTextArea.childrenMap.child.setInteractive(),this.mScrollBtn.on("drag",this.onDragHandler,this),this.scene.input.setDraggable(this.mScrollBtn,!0),this.mChatBtn.on("pointerup",this.onShowInputHanldler,this),this.mGiftBtn.on("pointerup",this.onGiftHandler,this),this.mEmojiBtn.on("pointerup",this.onEmojiHandler,this),this.render.emitter.on(l.EventType.CHAT,this.chatHandler,this),this.render.emitter.on(l.EventType.UPDATE_PARTY_STATE,this.setGiftButtonState,this))},PicaChatPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.mChatBtn.disableInteractive(),this.mEmojiBtn.disableInteractive(),this.mScrollBtn.disableInteractive(),this.mGiftBtn.disableInteractive(),this.mTextArea.childrenMap.child.disableInteractive(),this.mEmojiBtn.off("pointerup",this.onEmojiHandler,this),this.mScrollBtn.off("drag",this.onDragHandler,this),this.mChatBtn.off("pointerup",this.onShowInputHanldler,this),this.mGiftBtn.off("pointerup",this.onGiftHandler,this),this.render.emitter.off(l.EventType.CHAT,this.chatHandler,this),this.render.emitter.off(l.EventType.UPDATE_PARTY_STATE,this.setGiftButtonState,this))},PicaChatPanel.prototype.updateUIState=function(t){this.mInitialized},PicaChatPanel.prototype.destroy=function(){this.mBackground&&this.mBackground.disableInteractive(),t.prototype.destroy.call(this)},PicaChatPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_chat/pica_chat.png","pica_chat/pica_chat.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),this.addAtlas(h.c.common2Key,h.d.common2Url+".png",h.d.common2Url+".json"),t.prototype.preload.call(this)},PicaChatPanel.prototype.init=function(){var e=this.scene.cameras.main.width;this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1);var i=this.scale;this.setSize(e,135*this.dpr),this.mTileContainer=this.scene.make.container(void 0,!1),this.mScrollBtn=this.scene.make.image({x:21*this.dpr*i,key:this.key,frame:"scroll_btn"},!1).setScale(i),this.mScrollBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mTitleBg=this.scene.make.image({key:this.key,frame:"title_bg"},!1).setScale(i),this.mChatBtn=this.scene.make.image({x:96*this.dpr*i,key:this.key,frame:"chat_icon"},!1).setScale(i),this.mHornBtn=this.scene.make.image({x:159*this.dpr*i,key:this.key,frame:"horn_icon"},!1).setScale(i),this.mEmojiBtn=this.scene.make.image({x:218*this.dpr*i,key:this.key,frame:"emoji"},!1).setScale(i),this.mGiftBtn=this.scene.make.image({x:218*this.dpr*i,key:this.key,frame:"party_gift_icon"},!1).setScale(i);var n=20*this.dpr;this.mTitleBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mScrollBtn.x=.5*this.mScrollBtn.width+5*this.dpr,this.mScrollBtn.y=-this.mScrollBtn.height/2+this.mTitleBg.height,this.mChatBtn.x=this.mScrollBtn.x+.5*this.mScrollBtn.width+n+.5*this.mChatBtn.width,this.mChatBtn.y=-this.mChatBtn.height/2+this.mTitleBg.height,this.mChatBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mHornBtn.x=this.mChatBtn.x+.5*this.mChatBtn.width+n+.5*this.mHornBtn.width,this.mHornBtn.y=-this.mHornBtn.height/2+this.mTitleBg.height,this.mHornBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mEmojiBtn.x=this.mHornBtn.x+.5*this.mHornBtn.width+n+.5*this.mEmojiBtn.width,this.mEmojiBtn.y=-this.mEmojiBtn.height/2+this.mTitleBg.height,this.mEmojiBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mGiftBtn.x=this.mEmojiBtn.x+.5*this.mEmojiBtn.width+n+.5*this.mGiftBtn.width,this.mGiftBtn.y=-this.mGiftBtn.height/2+this.mTitleBg.height,this.mGiftBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mOutputText=new s.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr/i+"px",fontFamily:c.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr*i,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:e-12*this.dpr*i}}),this.mOutputText.setResolution(this.dpr);var a=this.scene.make.graphics(void 0,!1);this.mTextArea=new s.TextArea(this.mScene,{x:e/2+4*this.dpr*i,y:160*this.dpr*i,textWidth:e-4*this.dpr*i,textHeight:this.MAX_HEIGHT,text:this.mOutputText}).layout(),this.mTileContainer.add([this.mTitleBg,this.mChatBtn,this.mHornBtn,this.mEmojiBtn,this.mGiftBtn,this.mScrollBtn]),this.add([this.mBackground,this.mTileContainer,this.mTextArea,this.mOutputText,a]),this.resize(this.width,133*this.dpr),t.prototype.init.call(this)},PicaChatPanel.prototype.onDragHandler=function(t,e,i){var n=this.height+(t.prevPosition.y-t.position.y);n>this.MAX_HEIGHT||n<this.MIN_HEIGHT||this.resize(this.width,n)},PicaChatPanel.prototype.setGiftButtonState=function(t){this.giftPanel&&this.giftPanel.setGiftActive(t)},PicaChatPanel.prototype.onShowNavigateHandler=function(){this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_showNavigate")},PicaChatPanel.prototype.onEmojiHandler=function(){var t=this.render.displayManager.user.id;this.render.mainPeer.setDragonBonesQueue(t,[{animationName:"idle",scale:!1,times:1}]),this.render.physicalPeer.changePlayerState(t,"jump",1)},PicaChatPanel.prototype.onGiftHandler=function(){var t=this;this.giftPanel&&this.giftPanel.visible?(this.giftPanel.hide(),this.showChatTextArea()):(this.hideAllChildPanel(),this.giftPanel||(this.giftPanel=new d.PicaGiftPanel(this.scene,0,0,this.width,175*this.dpr,this.key,this.dpr,this.scale),this.giftPanel.y=this.height-.5*this.giftPanel.height,this.giftPanel.x=.5*this.width,this.add(this.giftPanel),this.giftPanel.resize(),this.giftPanel.on("showpropfun",this.showPropFun,this),this.giftPanel.on("buyItem",this.onBuyItemHandler,this),this.giftPanel.on("shownotice",this.showNoticeHandler,this)),this.resize(this.width,185*this.dpr),this.giftPanel.show(),this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_querymarket"),this.render.mainPeer.getCurRoom().then((function(e){var i=!!e&&e.openingParty;t.giftPanel.setGiftActive(i)})))},PicaChatPanel.prototype.onShowInputHanldler=function(){var t=this;if(this.hideAllChildPanel(),this.showChatTextArea(),!this.mInputText){var e=window.pktGlobal;if(e&&"Cordova"===e.envPlatform)if(this.scene.cache.json.has("quickchat"))setTimeout((function(){t.openAppInputPanel()}),20);else{var i=c.Url.getRes("/ui/quickchat/"+c.i18n.language+".json");this.scene.load.json("quickchat",i),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this),this.scene.load.start()}else this.mInputText=new o.InputPanel(this.scene,this.render),this.mInputText.once("close",this.sendChat,this)}},PicaChatPanel.prototype.sendChat=function(t){this.mInputText=void 0,t&&this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_chat",t)},PicaChatPanel.prototype.openAppInputPanel=function(){if(this.scene.cache.json.has("quickchat")){this.mInputText=new p.PicaChatInputPanel(this.scene,this.render,this.key,this.chatCatchArr.concat()),this.mInputText.once("close",this.appCloseChat,this),this.mInputText.on("send",this.appSendChat,this);var t=this.scene.cache.json.get("quickchat");this.mInputText.setQuickChatData(t.concat()),this.parentContainer&&(this.parentContainer.visible=!1),this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this)}},PicaChatPanel.prototype.appSendChat=function(t){t&&this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_chat",t)},PicaChatPanel.prototype.appCloseChat=function(){this.mInputText.off("send",this.appSendChat,this),this.mInputText=void 0,this.parentContainer&&(this.parentContainer.visible=!0)},PicaChatPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getCurRoom().then((function(e){e&&t.setGiftButtonState(e.openingParty)})),this.render.mainPeer.getActiveUIData(l.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var a=n[i];t.updateUIState(a)}}))},PicaChatPanel.prototype.hideAllChildPanel=function(){this.giftPanel&&this.giftPanel.hide(),this.mTextArea&&(this.mTextArea.visible=!1),this.mScrollBtn.disableInteractive(),this.showPanelHandler(l.ModuleName.PICAHANDHELD_NAME,!1)},PicaChatPanel.prototype.showChatTextArea=function(){this.mTextArea.visible=!0,this.mScrollBtn.setInteractive(),this.showPanelHandler(l.ModuleName.PICAHANDHELD_NAME,!0)},PicaChatPanel.prototype.onBuyItemHandler=function(t,e){var i=this,n=new o.AlertView(this.uiManager);e.count*e.sellingPrice.price>0?n.show({title:c.i18n.t("party.sendgift"),text:c.i18n.t("party.sendgifttips",{count:t.quantity,name:e.name||e.shortName}),oy:302*this.dpr*this.render.uiScale,callback:function(){i.render.renderEmitter(l.RENDER_PEER+"_"+i.key+"_buyItem",t)}}):this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_buyItem",t)},PicaChatPanel.prototype.showPropFun=function(t){this.showPanelHandler(l.ModuleName.PICAPROPFUN_NAME,!0,t)},PicaChatPanel.prototype.showNoticeHandler=function(t){var e={text:[{text:t,node:void 0}]};this.showPanelHandler(l.ModuleName.PICANOTICE_NAME,!0,e)},PicaChatPanel.prototype.showPanelHandler=function(t,e,i){this.render&&(e?this.render.mainPeer.showMediator(t,!0,i):this.render.mainPeer.showMediator(t,!1))},PicaChatPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMainUIPanel",(function(){return p}));var n,a=i(6),s=i(21),o=i(479),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},p=function(t){function PicaMainUIPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isSceneNameActive=!1,i.key=h.ModuleName.PICAMAINUI_NAME,i}return c(PicaMainUIPanel,t),PicaMainUIPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&(this.setInteractive(),this.update(this.mShowData),this.checkUpdateActive())},PicaMainUIPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width/this.scale,a=this.scene.cameras.main.height/this.scale;t.prototype.resize.call(this,n,a),this.mCoinValue.x=n-this.mCoinValue.width/2-5*this.dpr,this.mDiamondValue.x=n-this.mDiamondValue.width/2-5*this.dpr},PicaMainUIPanel.prototype.preload=function(){this.addAtlas(this.key,"main_ui/mainui.png","main_ui/mainui.json"),this.addAtlas(s.c.commonKey,s.d.commonUrl+".png",s.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMainUIPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.on("pointerup",this.onOpenRoomPanel,this),this.render.emitter.on(h.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.on(h.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.on(h.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):l.Logger.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.off("pointerup",this.onOpenRoomPanel,this),this.render.emitter.off(h.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.off(h.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.off(h.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):l.Logger.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.playerInfo=void 0,this.roomInfo=void 0},PicaMainUIPanel.prototype.update=function(e){t.prototype.update.call(this),e&&(e.hasOwnProperty("roomId")?this.roomInfo=e:this.playerInfo=e),this.playerInfo&&this.updatePlayerInfo(this.playerInfo),this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaMainUIPanel.prototype.updatePlayerInfo=function(t){if(this.playerInfo=t,this.mInitialized){if(t.level){var e=t.level;this.playerLv.text=e.level+""}if(void 0!==t.coin&&this.mCoinValue.setText(this.getCoin().value+""||"0"),void 0!==t.diamond&&this.mDiamondValue.setText(this.getDiamond().value+""||"0"),t.energy){var i=t.energy;i?this.mStrengthValue.setValue(i.currentValue,i.max):this.mStrengthValue.setValue(0,100)}this.mSceneName.rightIcon.visible=this.isSelfRoom}},PicaMainUIPanel.prototype.updateDetail=function(t){var e=this;t&&(this.headImage||(this.headImage=new o.DynamicImage(this.scene,0,0),this.headImage.setScale(this.dpr),this.add(this.headImage)),this.headImage.load(l.Url.getOsdRes(t.avatar),this,(function(){e.headImage.x=.5*e.headImage.width+4*e.dpr,e.headImage.y=.5*e.headImage.height+4*e.dpr})))},PicaMainUIPanel.prototype.getCoin=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000001"===i.id)return i}else l.Logger.getInstance().error(i.key+"  缺少ID")}},PicaMainUIPanel.prototype.getDiamond=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000002"===i.id)return i}else l.Logger.getInstance().error(i.key+"  缺少ID")}},PicaMainUIPanel.prototype.updateRoomInfo=function(t){this.roomInfo=t,this.mInitialized&&(this.roomCon.setSize(60*this.dpr,30*this.dpr),t.name&&(this.mSceneName.setText(t.name),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr)),this.roomCon.setInteractive(),this.isSceneNameActive=!0,t.playerCount&&this.mCounter.setText(""+t.playerCount),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.praiseBtn.visible=!1,t.roomType&&("room"!==t.roomType&&"store"!==t.roomType||(this.praiseBtn.visible=!0),this.praiseBtn.setText(t.praise+""),this.praiseBtn.selected=t.hasPraised,t.hasPraised?(this.praiseBtn.setTextColor("#8E99C1"),this.praiseImg.setFrame("praise_after")):(this.praiseBtn.setTextColor("#ffffff"),this.praiseImg.setFrame("praise_before"))),this.mSceneName.rightIcon.visible=this.isSelfRoom,this.partyBtn.visible=this.isSelfRoom,t.openingParty?this.partyBtn.setText(l.i18n.t("common.manager")):this.partyBtn.setText(l.i18n.t("main_ui.party")))},Object.defineProperty(PicaMainUIPanel.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,e=this.roomInfo.roomId,i=0,n=t;i<n.length;i++){if(n[i].roomId===e)return!0}return!1},enumerable:!1,configurable:!0}),PicaMainUIPanel.prototype.updateUIState=function(t){this.mInitialized&&("mainui.playerinfo"===t.name&&(this.playerCon.visible=t.visible),"mainui.roominfo"===t.name&&(this.roomCon.visible=t.visible),"mainui.headbtn"===t.name&&(t.disabled?this.playerIcon.removeInteractive():this.playerIcon.setInteractive()),"mainui.entereditorbtn"===t.name&&(this.mSceneName.visible=t.visible,this.isSceneNameActive&&(t.disabled?this.roomCon.removeInteractive():(this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive()))))},PicaMainUIPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.playerCon=this.scene.make.container(void 0,!1),this.playerCon.y=25*this.dpr,this.add(this.playerCon),this.mCoinValue=new d(this.scene,this.key,"coin",this.dpr),this.mDiamondValue=new d(this.scene,this.key,"diamond",this.dpr),this.mDiamondValue.setHandler(new l.Handler(this,this.onOpenRechargeHandler)),this.mDiamondValue.y=35*this.dpr;var n=this.scene.textures.getFrame(this.key,"strength_progress");this.mStrengthValue=new f(this.scene,this.key,"strength_icon",this.dpr),this.mStrengthValue.x=76*this.dpr;var h=new a.NineSlicePatch(this.scene,68*this.dpr/2,this.mStrengthValue.height/2-n.height-1*this.dpr,92*this.dpr,n.height,this.key,"strength_progress",{left:8*this.dpr,top:3*this.dpr,right:n.width-2-8*this.dpr,bottom:n.height-1-3*this.dpr});this.mStrengthValue.setProgress(h,this.scale),this.playerIcon=this.scene.make.image({key:this.key,frame:"head"}),this.playerIcon.x=.5*-this.mStrengthValue.width-8*this.dpr,this.mStrengthValue.add(this.playerIcon),this.playerIcon.on("pointerup",this.onHeadHandler,this),this.playerIcon.setInteractive(),this.mStrengthValue.setValue(1e3,1e3),this.mStrengthValue.setInteractive(),this.mStrengthValue.on("pointerup",this.onStrengthHandler,this);var c=this.playerIcon.x+.5*this.playerIcon.width-2*this.dpr,p=this.playerIcon.y+.5*this.playerIcon.height-10*this.dpr;this.playerLv=this.scene.make.text({text:"0",x:c,y:p,style:{fontSize:11*this.dpr,bold:!0,fontFamily:l.Font.DEFULT_FONT,color:"#356EE3"}},!1).setOrigin(1,0),this.playerLv.setShadow(0,0,"#ffffff",2),this.playerLv.setStroke("#356EE3",2),this.playerLv.setShadowStroke(!0),this.mStrengthValue.add(this.playerLv),this.playerCon.add([this.mStrengthValue,this.mCoinValue,this.mDiamondValue]),this.roomCon=this.scene.make.container(void 0,!1),this.roomCon.y=this.playerCon.y+32*this.dpr,this.add(this.roomCon),this.mSceneName=new m(this.scene,this.key,"room_icon","setting_icon",this.dpr),this.mSceneName.setText(""),this.mSceneName.x=18*this.dpr,this.mCounter=new u(this.scene,s.c.commonKey,"home_persons",this.dpr),this.mCounter.setText(""),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.mCounter.y=this.mSceneName.y,this.mCounter.setColor("#28D5F5"),this.textToolTip=new o.TextToolTips(this.scene,s.c.commonKey,"tips_bg",this.dpr,this.scale),this.textToolTip.setSize(160*this.dpr,45).visible=!1,this.praiseBtn=new a.CheckBox(this.scene,this.key,"praise_before_bg","praise_after_bg","1"),this.praiseBtn.y=this.mSceneName.y+this.mSceneName.height+.5*this.praiseBtn.height+20*this.dpr,this.praiseBtn.x=8*this.dpr+.5*this.praiseBtn.width,this.praiseBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.praiseBtn.setTextOffset(10*this.dpr,0),this.praiseBtn.on(String(a.ClickEvent.Tap),this.onPraiseHandler,this),this.praiseImg=this.scene.make.image({key:this.key,frame:"praise_before"}),this.praiseImg.x=-10*this.dpr,this.praiseBtn.add(this.praiseImg),this.partyBtn=new a.Button(this.scene,this.key,"home_party_bg","home_party_bg",l.i18n.t("main_ui.party")),this.partyBtn.x=this.praiseBtn.x+.5*this.praiseBtn.width+.5*this.partyBtn.width+5*this.dpr,this.partyBtn.y=this.praiseBtn.y,this.partyBtn.setTextOffset(8*this.dpr,0),this.partyBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.partyBtn.on(String(a.ClickEvent.Tap),this.onPartyHandler,this),this.roomCon.add([this.mSceneName,this.mCounter,this.praiseBtn,this.partyBtn,this.textToolTip]),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.resize(e,i),t.prototype.init.call(this)},PicaMainUIPanel.prototype.onOpenRoomPanel=function(){this.render.renderEmitter("openroompanel")},PicaMainUIPanel.prototype.onHeadHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.CHARACTERINFO_NAME)},PicaMainUIPanel.prototype.onStrengthHandler=function(){var t=this;if(this.playerInfo){var e=this.playerInfo.energy,i=e.currentValue+"/"+e.max+"\n",n=l.i18n.t("main_ui.energy_tips",{name:i,interpolation:{escapeValue:!1}});this.textToolTip.visible||this.scene.input.on("pointerdown",this.onTextToolTipHandler,this),this.textToolTip.setDelayText(n,3e3,new l.Handler(this,(function(){t.scene.input.off("pointerdown",t.onTextToolTipHandler,t)}))),this.textToolTip.setPosition(120*this.dpr,20*this.dpr)}},PicaMainUIPanel.prototype.onTextToolTipHandler=function(){this.textToolTip.visible=!1,this.scene.input.off("pointerdown",this.onTextToolTipHandler,this)},PicaMainUIPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.mWorld.mainPeer.getActiveUIData("PicaMainUI")];case 1:if(t=a.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},PicaMainUIPanel.prototype.onUpdatePlayerHandler=function(t){this.playerInfo=t,this.updatePlayerInfo(t)},PicaMainUIPanel.prototype.onUpdateRoomHandler=function(t){this.roomInfo=t,this.updateRoomInfo(t)},PicaMainUIPanel.prototype.onUpdatePartyHandler=function(t){this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaMainUIPanel.prototype.onPraiseHandler=function(t,e){this.render.renderEmitter(h.EventType.QUERY_PRAISE,e.selected)},PicaMainUIPanel.prototype.onPartyHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.PICAOPENPARTY_NAME)},PicaMainUIPanel.prototype.onOpenRechargeHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.PICARECHARGE_NAME)},PicaMainUIPanel}(o.BasePanel),d=function(t){function ValueContainer(e,i,n,a){void 0===a&&(a=1);var s=t.call(this,e)||this;return s.init(i,n,a),s}return c(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.setHandler=function(t){this.sendHandler=t},ValueContainer.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:14*i,fontFamily:l.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new a.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=.5*-n.width+5*i,this.mLeft.y=n.y+.5*n.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*i,this.mText.x=4*i,this.add([n,this.mLeft,this.mText,this.mAddBtn]),this.mAddBtn.on(a.ClickEvent.Tap,this.onAddHandler,this)},ValueContainer.prototype.onAddHandler=function(){this.sendHandler&&this.sendHandler.run()},ValueContainer}(Phaser.GameObjects.Container),u=function(t){function IconText(e,i,n,a){void 0===a&&(a=1);var s=t.call(this,e)||this,o=e.make.image({key:i,frame:n},!1);return s.mText=e.make.text({style:{fontSize:14*a,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),s.mText.x=o.width/2+4*a,s.mText.setStroke("#000000",2*a),s.add([o,s.mText]),s}return c(IconText,t),IconText.prototype.setText=function(t){this.mText.setText(t)},IconText.prototype.setStroke=function(t,e){this.mText.setStroke(t,e)},IconText.prototype.setColor=function(t){this.mText.setColor(t)},IconText}(Phaser.GameObjects.Container),m=function(t){function SceneName(e,i,n,a,s){void 0===s&&(s=1);var o=t.call(this,e,i,n,s)||this;return o.mDpr=s,o.mRightIcon=e.make.image({y:2*s,key:i,frame:a},!1),o.add(o.mRightIcon),o.mRightIcon.y=8*s,o.mRightIcon.x=10*s,o}return c(SceneName,t),SceneName.prototype.setText=function(e){t.prototype.setText.call(this,e)},Object.defineProperty(SceneName.prototype,"rightbound",{get:function(){return this.mText.x+this.mText.width+10*this.mDpr},enumerable:!1,configurable:!0}),Object.defineProperty(SceneName.prototype,"rightIcon",{get:function(){return this.mRightIcon},enumerable:!1,configurable:!0}),SceneName}(u),f=(function(t){function ExpProgress(e,i,n,s,o){var h=t.call(this,e)||this,c=o.getSize().width/s,p=h.scene.textures.getFrame(i,"exp_bg");h.setSize(c,p.height);var d=h.width,u=h.height;h.mProgressBar=new y(e,n),h.mProgressBar.setSize(h.width,h.height);var m=new a.NineSlicePatch(h.scene,d/2,u/2,d,u,i,"exp_bg",{left:8*n,top:3*n,right:p.width-2-8*n,bottom:p.height-1-3*n});h.mProgressBar.setBackground(m),p=h.scene.textures.getFrame(i,"exp_progress");var f=new a.NineSlicePatch(h.scene,d/2,u/2,c,p.height,i,"exp_progress",{left:8*n,top:3*n,right:p.width-2-10*n,bottom:p.height-1-5*n});return h.mProgressBar.setProgress(f,s),h.mProgressBar.setRatio(.5),h.mCurrentLv=e.make.text({text:"57",style:{fontSize:10*n,fontFamily:l.Font.DEFULT_FONT}},!1),h.mCurrentLv.setStroke("#000000",1*n),h.mNextLv=e.make.text({text:"58",style:{fontSize:10*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,0),h.mNextLv.setStroke("#000000",1*n),h.mNextLv.x=h.width-h.mNextLv.width,h.add([h.mProgressBar,h.mCurrentLv,h.mNextLv]),h}c(ExpProgress,t),ExpProgress.prototype.setLv=function(t,e){this.mCurrentLv.setText(t.toString()),this.mNextLv.setText((t+1).toString()),this.mNextLv.x=this.width-this.mNextLv.width,this.mProgressBar.setRatio(e)}}(Phaser.GameObjects.Container),function(t){function ProgressValue(e,i,n,a){return t.call(this,e,i,n,a)||this}return c(ProgressValue,t),ProgressValue.prototype.setProgress=function(t,e){this.mProgress.setProgress(t,e)},ProgressValue.prototype.setValue=function(t,e){this.mText&&(this.mText.text=t+"/"+e,this.mProgress.setRatio(t/e))},ProgressValue.prototype.setInteractive=function(e){return e=e||new Phaser.Geom.Rectangle(0,0,this.width,this.height),t.prototype.setInteractive.call(this,e,Phaser.Geom.Rectangle.Contains),this},ProgressValue.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.setSize(n.width,n.height),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mProgress=new y(this.scene,i),this.mProgress.x=-this.width/2+10*i,this.mProgress.y=4*i,this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:10*i,fontFamily:l.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new a.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=-this.width*this.originX+13*i,this.mAddBtn.x=this.width*this.originX-10*i,this.add([n,this.mProgress,this.mLeft,this.mText,this.mAddBtn])},ProgressValue}(d)),y=function(t){function ProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n}return c(ProgressBar,t),ProgressBar.prototype.setBackground=function(t){this.addAt(t,0)},ProgressBar.prototype.setProgress=function(t,e){this.mScale=e,this.mProgress=t,this.add(this.mProgress),this.setSize(t.width*this.mScale,t.height*this.mScale);var i=t.getWorldTransformMatrix();this.worldpos=new Phaser.Geom.Point(i.tx,i.ty),this.mMaskGraphics=this.scene.make.graphics(void 0,!1),this.mMaskGraphics.fillStyle(16750848),this.mMaskGraphics.fillRect(0,0,this.width,this.height+8*this.dpr),this.mProgress.mask=new Phaser.Display.Masks.GeometryMask(this.scene,this.mMaskGraphics),this.mMaskGraphics.y=i.ty+this.height+4*this.dpr,this.mMaskGraphics.x=i.tx},ProgressBar.prototype.setRatio=function(t){this.mMaskGraphics&&(this.mMaskGraphics.x=this.worldpos.x+4*this.dpr-.5*this.mProgress.width+(this.width*t-this.width))},ProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRenderUiManager",(function(){return l}));var n,a=i(479),s=i(21),o=i(486),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaRenderUiManager(e){var i=t.call(this,e)||this;return i.mAtalsManager=new s.a,i.singleManager=new o.PicaSingleManager(i),i.mAtalsManager.init(e),i}return h(PicaRenderUiManager,t),PicaRenderUiManager.prototype.getUrlDatas=function(t,e){return void 0===e&&(e=s.e.atlas),this.mAtalsManager.getUrlDatas(t,e)},PicaRenderUiManager.prototype.showAlertView=function(e,i,n,a){void 0===n&&(n=!1),t.prototype.showAlertView.call(this,e,i,n,a)},PicaRenderUiManager.prototype.destroy=function(){t.prototype.destroy.call(this),this.singleManager.destroy()},PicaRenderUiManager.prototype._showPanel=function(e,n){this.mPanelMap||(this.mPanelMap=new Map);var a=e+"Panel",s=new(i(652)("./"+e+"/"+a)[a])(this);if(s)return this.mPanelMap.set(e,s),s.show(n),s;t.prototype._showPanel.call(this,e,n)},PicaRenderUiManager}(a.UiManager)},function(t,e,i){"use strict";i.r(e),i.d(e,"InteractiveBubblePanel",(function(){return c}));var n,a=i(479),s=i(0),o=i(2),h=i(499),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function InteractiveBubblePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.map=new Map,i.key=s.ModuleName.BUBBLE_NAME,i}return l(InteractiveBubblePanel,t),InteractiveBubblePanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.setSize(e,i)},InteractiveBubblePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.scale;this.resize(e,i),t.prototype.init.call(this)},InteractiveBubblePanel.prototype.destroy=function(){if(this.map){for(var e in this.map){var i=this.map.get(Number(e));i&&i.destroy()}this.map.clear()}t.prototype.destroy.call(this)},InteractiveBubblePanel.prototype.clearInteractionBubble=function(t){this.map.has(t)&&(this.map.get(t).destroy(),this.map.delete(t))},InteractiveBubblePanel.prototype.showInteractionBubble=function(t,e){var i=this,n=this.dpr;t.display.resName=null,t.display.texturePath=o.Url.getUIRes(n,"bubble/bubblebg.png"),t.display.dataPath=o.Url.getUIRes(n,"bubble/tipsicon.png");var s=t.id;this.mBubble&&this.mBubble.hide(),this.map.has(s)?this.mBubble=this.map.get(s):(this.mBubble=new h.InteractionBubbleContainer(this.scene,n),this.map.set(s,this.mBubble)),this.mBubble.setBubble(t,new o.Handler(this,this.onInteractiveBubbleHandler));var l=this.render.sceneManager.getSceneByName(a.PlayScene.name);l?(this.updateBubblePos(e,l),this.mBubble.setFollow(e,l,(function(t){i.updateBubblePos(e,t.scene)})),this.mBubble.show=!0,this.add(this.mBubble)):o.Logger.getInstance().fatal("scene does not exist")},InteractiveBubblePanel.prototype.updateBubblePos=function(t,e){var i=this.dpr,n=this.render.uiScale,a=t.getDisplay();if(a){var s=a.getWorldTransformMatrix();if(s){var h=o.Tool.getPosByScenes(e,new o.Pos(s.tx,s.ty-33*i*n));this.mBubble.setPosition(h.x,h.y)}}},InteractiveBubblePanel.prototype.update=function(){this.map&&this.map.forEach((function(t){t&&t.show&&t.updatePos()}))},InteractiveBubblePanel.prototype.onInteractiveBubbleHandler=function(t){this.render.renderEmitter(s.RENDER_PEER+"_"+this.key+"_queryinteractive",t)},InteractiveBubblePanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CreateRolePanel",(function(){return c}));var n,a=i(6),s=i(2),o=i(0),h=i(479),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function CreateRolePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mCurPageNum=0,i.setTween(!1),i.scene.add.container(0,0).add(i),i.scene.scale.on("resize",i.onResize,i),i.mMediator=i.render.mainPeer[o.ModuleName.CREATEROLE_NAME],i.key=o.ModuleName.CREATEROLE_NAME,i}return l(CreateRolePanel,t),CreateRolePanel.prototype.show=function(e){e&&(this.avatars=this.creatAvatars(e),t.prototype.show.call(this,e))},CreateRolePanel.prototype.preload=function(){this.addAtlas(this.key,"create_role/create_role.png","create_role/create_role.json"),t.prototype.preload.call(this)},CreateRolePanel.prototype.hide=function(){t.prototype.hide.call(this)},CreateRolePanel.prototype.resize=function(t,e){if(this.mBackground){var i=this.scale,n=this.scene.cameras.main.width/i,a=this.scene.cameras.main.height/i,s=this.scene.cameras.main.centerX/i;this.mBackground.x=s,this.mFoot.x=s,this.mFoot.y=a-(this.mFoot.height>>1),this.mBackgroundColor.clear(),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,n,a),this.mSubmit.x=s,this.inputText.x=s,this.mInputTextBg.x=s,this.dragonbones.x=s,this.mNextPageBtn.x=n-150,this.mRandomBtn.x=this.mInputTextBg.x+this.mInputTextBg.width/2-26*this.dpr}},CreateRolePanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height;this.mBackground=this.scene.make.image({key:this.key,frame:"bg.png",x:i>>1}),this.mBackground.y=this.mBackground.height/2+92*this.dpr,this.add(this.mBackground),this.mFoot=this.scene.make.image({key:this.key,frame:"bg_foot.png"},!1),this.add(this.mFoot),this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,i,n),this.addAt(this.mBackgroundColor,0),this.mInputTextBg=new a.NineSlicePatch(this.scene,i>>1,350*this.dpr,255*this.dpr,50*this.dpr,this.key,"input_bg.png",{left:27*this.dpr,top:24*this.dpr,right:28*this.dpr,bottom:24*this.dpr}),this.add(this.mInputTextBg),this.inputText=new a.InputText(this.scene,i>>1,350*this.dpr,160*this.dpr,80,{type:"input",fontSize:18*this.dpr+"px",color:"#717171",align:"center",placeholder:s.i18n.t("create_role.enter_nick")}).setOrigin(.5),this.add(this.inputText);var o=s.i18n.t("create_role.commit");this.mShowData&&this.mShowData.button&&(o=this.mShowData.button.text);var l=this.scene.textures.getFrame(this.key,"submit_button_normal"),c=42,p=43;l&&(c=l.width,p=l.height),this.mSubmit=new a.NineSliceButton(this.scene,i>>1,445*this.dpr,202*this.dpr,55*this.dpr,this.key,"submit_button",o,void 0,void 0,{left:19*this.dpr,top:20*this.dpr,right:c-2-19*this.dpr,bottom:p-2-20*this.dpr}),this.mSubmit.setTextStyle({color:"#976400",fontSize:18*this.dpr,fontFamily:s.Font.DEFULT_FONT}),this.mSubmit.setFontStyle("bold"),this.mSubmit.on("pointerup",this.onSubmitHandler,this),this.add(this.mSubmit),this.mPrePageBtn=this.scene.make.image({x:60*this.dpr,y:216*this.dpr,key:this.key,frame:"arrow_left.png"}).setInteractive(),this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn=this.scene.make.image({x:i-60*this.dpr,y:this.mPrePageBtn.y,key:this.key,frame:"arrow.png"}).setFlipX(!0).setInteractive(),this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mRandomBtn=this.scene.make.image({x:this.mInputTextBg.x,y:this.mInputTextBg.y,key:this.key,frame:"random.png"}).setInteractive(),this.add([this.mPrePageBtn,this.mNextPageBtn,this.mRandomBtn]),this.mRandomBtn.on("pointerup",this.onRandomNameHandler,this),this.mErrorBg=this.scene.make.image({key:this.key,frame:"tips_bg.png",x:220*this.dpr,y:57*this.dpr}).setVisible(!1),this.mError=this.scene.make.text({x:127*this.dpr,y:30*this.dpr,style:{color:"#26265d",font:"bold 34px YaHei",wordWrap:{width:420,useAdvancedWrap:!0}}},!1).setVisible(!1),this.add([this.mErrorBg,this.mError]),this.dragonbones=new h.DragonbonesDisplay(this.scene,this.render),this.dragonbones.scale=2*this.dpr,this.dragonbones.x=i>>1,this.dragonbones.y=this.mNextPageBtn.y+70*this.dpr,this.dragonbones.on("initialized",this.loadDragonbonesComplete,this),this.add(this.dragonbones),this.setPageNum(0),t.prototype.init.call(this),this.resize(0,0)},CreateRolePanel.prototype.setAvatars=function(t){},CreateRolePanel.prototype.showError=function(t){this.mError&&(this.mError.text=t,this.mError.setVisible(!0),this.mErrorBg.setVisible(!0))},CreateRolePanel.prototype.setNickName=function(t){this.inputText&&(this.inputText.text=t)},CreateRolePanel.prototype.destroy=function(){this.scene&&this.scene.scale.off("resize",this.onResize,this),this.dragonbones&&this.dragonbones.off("initialized",this.loadDragonbonesComplete,this),t.prototype.destroy.call(this)},CreateRolePanel.prototype.creatAvatars=function(t){for(var e=[],i=0,n=t.avatarSuits;i<n.length;i++){for(var a=[],s=0,h=n[i].avatarSuit;s<h.length;s++){var l=h[s],c={id:l.id,suit_type:l.suitType,slot:l.slot,tag:l.tag,sn:l.sn};a.push(c)}var p=o.AvatarSuitType.createHasBaseAvatar(a);e.push(p)}return t.avatars=e,e},CreateRolePanel.prototype.onRandomNameHandler=function(){this.mediator.randomName(),this.inputText.setBlur()},CreateRolePanel.prototype.onSubmitHandler=function(){this.mediator.submit(this.inputText.text,this.mCurPageNum),this.inputText.setBlur(),this.mError&&(this.mError.setVisible(!1),this.mErrorBg.setVisible(!1))},CreateRolePanel.prototype.onPrePageHandler=function(){this.setPageNum(this.mCurPageNum-1),this.inputText.setBlur()},CreateRolePanel.prototype.onNextPageHandler=function(){this.setPageNum(this.mCurPageNum+1),this.inputText.setBlur()},CreateRolePanel.prototype.setPageNum=function(t){this.mCurPageNum=t,this.avatars&&(this.mCurPageNum<0?this.mCurPageNum=this.avatars.length-1:this.mCurPageNum>=this.avatars.length&&(this.mCurPageNum=0),this.dragonbones.load({id:0,avatar:this.avatars[this.mCurPageNum]}),this.dragonbones.startLoad())},CreateRolePanel.prototype.onResize=function(t){this.resize(t.width,t.height)},CreateRolePanel.prototype.loadDragonbonesComplete=function(){this.dragonbones.play({name:"idle",flip:!1})},Object.defineProperty(CreateRolePanel.prototype,"mediator",{get:function(){if(this.mMediator)return this.mMediator},enumerable:!1,configurable:!0}),CreateRolePanel}(h.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CutInPanel",(function(){return h}));var n,a=i(479),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function CutInPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key="cut_in",i}return o(CutInPanel,t),CutInPanel.prototype.show=function(t){var e=this;if(this.mShowData=t,this.mInitialized){if(t){var i=t.text;this.mName&&this.mName.setText(i[0].text)}else this.mName&&this.mName.setText("???");var n=this.scene.cameras.main.width;this.x=n+this.width/2;var a=this.scene.cameras.main.width/2;this.scene.tweens.timeline({targets:this,duration:300,tweens:[{x:a,alpha:1,ease:"Sine.easeInOut"},{delay:2e3,y:this.y-10*this.dpr,alpha:0}],onComplete:function(){e.emit("close")}})}else this.preload()},CutInPanel.prototype.resize=function(t,e){this.y=140*this.dpr},CutInPanel.prototype.preload=function(){this.addImage(this.key,"cut_in/cut_in_bg.png"),t.prototype.preload.call(this)},CutInPanel.prototype.init=function(){var e=this.scene.make.image({key:this.key},!1);this.setSize(e.width*this.scale,e.height*this.scale),this.mName=this.scene.make.text({style:{color:"#ffcc33",fontSize:18*this.dpr,fotnFamily:s.Font.DEFULT_FONT}},!1).setOrigin(.5),this.mName.setFontStyle("bold"),this.mName.setStroke("#000000",1*this.dpr),this.add([e,this.mName]),t.prototype.init.call(this),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height)},CutInPanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"CutInMenuPanel",(function(){return l}));var n,a=i(479),s=i(0),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function CutInMenuPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mapPop=new Map,i.key=s.ModuleName.CUTINMENU_NAME,i}return h(CutInMenuPanel,t),CutInMenuPanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.setSize(e,i)},CutInMenuPanel.prototype.preload=function(){this.addAtlas(this.key,"cutInmenu/cutInmenu.png","cutInmenu/cutInmenu.json"),t.prototype.preload.call(this)},CutInMenuPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=this.buttonType;this.rightPopButton="work"===n?new p(this.scene,e,this.key,this.dpr):new c(this.scene,e,this.key,this.dpr);var a=e+.5*this.rightPopButton.width-15*this.dpr;this.rightPopButton.setPosition(a,.5*i+20*this.dpr),this.rightPopButton.setClickHandler(new o.Handler(this,this.onRightClickHandler)),this.add(this.rightPopButton),this.resize(e,i),t.prototype.init.call(this),this.opneButton()},CutInMenuPanel.prototype.onShow=function(){this.setPopData(this.popData)},CutInMenuPanel.prototype.setPopData=function(t){if(this.popData=t,this.mInitialized){var e=this.buttonType;"work"===e&&this.rightPopButton.setCount(t)}},CutInMenuPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},CutInMenuPanel.prototype.opneButton=function(){this.rightPopButton.onTakeBack()},CutInMenuPanel.prototype.onRightClickHandler=function(){var t=this.buttonType;"work"===t?this.render.renderEmitter(s.ModuleName.CUTINMENU_NAME+"_openmed",s.ModuleName.PICAWORK_NAME):"minecar"===t&&this.render.renderEmitter(s.ModuleName.CUTINMENU_NAME+"_openmed",s.ModuleName.PICAMINECAR_NAME)},Object.defineProperty(CutInMenuPanel.prototype,"buttonType",{get:function(){return this.mShowData.button[0].text},enumerable:!1,configurable:!0}),CutInMenuPanel}(a.BasePanel),c=function(t){function RightPopContainer(e,i,n,a){var s=t.call(this,e)||this;s.isPop=!1,s.isPlaying=!1,s.dpr=a,s.key=n,s.scaleWidth=i;var h=s.scene.make.image({key:s.key,frame:"minebag_bg"});h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.bgSprite=s.scene.make.image({key:s.key,frame:"minebag_bg_brth"},!1),s.bgSprite.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.imgIcon=s.scene.make.image({key:s.key,frame:"minecar"}),s.imgIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.imgIcon.setPosition(-12*a,.5*-s.imgIcon.height),s.text=e.make.text({x:s.imgIcon.x,y:2*a,text:o.i18n.t("common.open"),style:o.UIHelper.whiteStyle(a,12)},!1).setOrigin(.5),s.text.setFontStyle("bold"),s.text.setStroke("#2D1415",3*a);var l=s.scene.make.image({key:s.key,frame:"arow"});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var c=e.make.container(void 0,!1);return c.setSize(25*a,31*a),c.add(l),c.setPosition(.5*-h.width+10*a,0),s.add([s.bgSprite,h,s.imgIcon,s.text,c]),h.on("pointerup",s.onClickHandler,s),h.setInteractive(),c.on("pointerup",s.onTakeBack,s),c.setInteractive(),s.setSize(h.width,h.height),s.tween=s.scene.tweens.add({targets:s.bgSprite,alpha:{value:0,duration:500,ease:"Power1",yoyo:!0},repeat:-1}),s}return h(RightPopContainer,t),RightPopContainer.prototype.setClickHandler=function(t){this.clickHandler=t},RightPopContainer.prototype.setIconFrame=function(t){this.imgIcon.setFrame(t)},RightPopContainer.prototype.setPopData=function(t){this.popData=t},RightPopContainer.prototype.play=function(){this.bgSprite.alpha=1,this.tween.resume(),this.isPop=!1},RightPopContainer.prototype.stop=function(){this.tween.pause(),this.bgSprite.alpha=0,this.isPop=!0},RightPopContainer.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this.popData)},RightPopContainer.prototype.onTakeBack=function(){this.isPlaying||this.isPop?!this.isPlaying&&this.isPop&&this.takeback():this.popAnim()},RightPopContainer.prototype.popAnim=function(){this.isPlaying=!0;var t=this.scaleWidth-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.stop(),e.isPlaying=!1}})},RightPopContainer.prototype.takeback=function(){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),this.isPlaying=!0;var t=this.scaleWidth+.5*this.width-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.play(),e.isPlaying=!1}})},RightPopContainer}(Phaser.GameObjects.Container),p=function(t){function WorkPopContainer(e,i,n,a){var s=t.call(this,e,i,n,a)||this;s.imgIcon.x=-22*a,s.text.x=s.imgIcon.x;var h=s.scene.make.image({key:s.key,frame:"time"});return h.x=s.imgIcon.x+.5*h.width+20*a,h.y=2*a,s.add(h),s.countTex=e.make.text({x:h.x,y:h.y,text:"",style:o.UIHelper.whiteStyle(a,10)},!1).setOrigin(.5),s.countTex.setFontStyle("bold"),s.add(s.countTex),s.setIconFrame("work_icon"),s.text.text=o.i18n.t("work.title"),s}return h(WorkPopContainer,t),WorkPopContainer.prototype.setCount=function(t){this.countTex.text=t+""},WorkPopContainer.prototype.popAnim=function(){this.isPlaying=!0;var t=this.scaleWidth-25*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.stop(),e.isPlaying=!1}})},WorkPopContainer.prototype.takeback=function(){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),this.isPlaying=!0;var t=this.scaleWidth+.5*this.width-15*this.dpr,e=this;this.scene.tweens.add({targets:e,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){e.play(),e.isPlaying=!1}})},WorkPopContainer}(c)},function(t,e,i){"use strict";i.r(e),i.d(e,"DialogPanel",(function(){return u}));var n,a,s,o=i(6),h=i(2),l=i(0),c=i(479),p=i(21),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t[t.HORIZONTAL_LEFT=0]="HORIZONTAL_LEFT",t[t.HORIZONTAL_CENTER=1]="HORIZONTAL_CENTER",t[t.HORIZONTAL_RIGHT=2]="HORIZONTAL_RIGHT"}(a||(a={})),function(t){t[t.VERTICAL_TOP=0]="VERTICAL_TOP",t[t.VERTICAL_CENTER=1]="VERTICAL_CENTER",t[t.VERTICAL_BOTTOM=2]="VERTICAL_BOTTOM"}(s||(s={}));var u=function(t){function DialogPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=l.ModuleName.DIALOG_NAME,i.listItems=[],i.key=l.ModuleName.DIALOG_NAME,i}return d(DialogPanel,t),DialogPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight,s=177*this.dpr;t.prototype.resize.call(this,n,a),this.content.setPosition(.5*n,a-s/2),this.setSize(n,a),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRect(0,0,n,a),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains),this.bg.scaleX=1.5*n,this.bg.x=0,this.bg.setInteractive(),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR)},DialogPanel.prototype.preload=function(){this.addAtlas(this.key,p.d.textureUrl(p.d.commonUrl),p.d.jsonUrl(p.d.commonUrl)),t.prototype.preload.call(this)},DialogPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setDialogData(this.mShowData)):this.preload())},DialogPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=177*this.dpr;this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg),this.content=this.scene.make.container({x:0*this.dpr,y:(i-n)/2,width:e,height:n},!1),this.content.setSize(e,n),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"menu_bg_l"}),this.bg.scaleY=this.scale,this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bg.displayWidth=e,this.bg.displayHeight=n;var a=this.scene.make.graphics(void 0,!1),s=e-30*this.dpr,l=122*this.dpr;a.setPosition(-s>>1,.5*-l+13*this.dpr),a.clear(),a.fillStyle(16777215,1),a.fillRoundedRect(0,0,s,l,8*this.dpr),this.text=this.scene.make.text({x:.5*-s+20*this.dpr,y:.5*-l+30*this.dpr,text:"",style:{color:"#000000",fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0).setWordWrapWidth(s-35*this.dpr,!0);var p=.5*-e+38*this.dpr,d=.5*-n+25*this.dpr;this.npcIcon=new c.DynamicImage(this.scene,p,d-20*this.dpr);var u=this.scene.make.image({x:p+135*this.dpr,y:d,key:this.key,frame:"name_bg"});this.npcName=this.scene.make.text({x:u.x,y:u.y,text:"",style:{fontSize:15*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5);var m=new o.Button(this.scene,this.key,"close_1","close_1");m.setPosition(.5*e-30*this.dpr,.5*-n+10*this.dpr),m.on(o.ClickEvent.Tap,this.onCloseHandler,this),m.visible=!1,this.content.add([this.bg,this.npcIcon,a,this.text,u,this.npcName,m]),this.bg.setInteractive(),this.bg.on("pointerdown",this.onNextDialogHandler,this),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.mScene.layerManager.addToLayer(c.MainUIScene.LAYER_DIALOG,this)},DialogPanel.prototype.setLayoutItems=function(t){var e=t.length,i=e>4?2:1,n=(this.dpr,295*this.dpr),a=27*this.dpr,s=n/i,o=4*this.dpr;2===e?o=15*this.dpr:3===e&&(o=10*this.dpr);for(var l=(124*this.dpr-(o+a)*(e<4?e:4)-o)/2-42*this.dpr,c=0,p=this.listItems;c<p.length;c++){(u=p[c]).visible=!1}for(var d=0;d<e;d++){var u=void 0;d<this.listItems.length?u=this.listItems[d]:(u=new m(this.scene,this.dpr,this.scale,this.key),this.content.add(u),this.listItems.push(u),u.setHandler(new h.Handler(this,this.onItemHandler)));var f=.5*(n-s)*(d<4?-1:1),y=l+.5*a+(a+o)*(d%4);u.setItemSize(s,a),u.setPosition(f,y),u.setItemData(t[d]),u.visible=!0}},DialogPanel.prototype.setDialogData=function(t){var e=this;if(t.text&&t.text[1]&&(this.npcName.text=t.text[1].text),t.display&&t.display[0]){this.npcIcon.visible=!0;var i=t.display[0],n=h.Url.getOsdRes(i.texturePath);this.npcIcon.load(n,this,(function(){var t=e.content.width,n=e.content.height,s=e.npcIcon.width,o=(e.npcIcon.height,e.npcIcon.x),h=.5*-n-50*e.dpr;i.horizontal===a.HORIZONTAL_LEFT?o=.5*-t+.5*s:i.horizontal===a.HORIZONTAL_CENTER?o=0:i.horizontal===a.HORIZONTAL_RIGHT&&(o=.5*t-.5*s-20*e.dpr),e.npcIcon.displayWidth=212*e.dpr,e.npcIcon.scaleY=e.npcIcon.scaleX,e.npcIcon.x=o,e.npcIcon.y=h}))}else this.npcIcon.visible=!1;if(t.button&&t.button.length>0)this.setLayoutItems(t.button),this.text.visible=!1;else{for(var s=0,o=this.listItems;s<o.length;s++){o[s].visible=!1}this.text.text=t.text[0].text,this.text.visible=!0}},DialogPanel.prototype.update=function(t){this.mShowData=t,this.setDialogData(t)},DialogPanel.prototype.onItemHandler=function(t){for(var e=0,i=this.listItems;e<i.length;e++){i[e].select=!1}t.select=!0;var n=this.showData;this.render.renderEmitter(this.key+"_querydialog",{id:n.id,nodeid:t.itemData.node.id})},DialogPanel.prototype.onNextDialogHandler=function(){var t=this.showData;this.render.renderEmitter(this.key+"_querydialog",{id:t.id,nodeid:0})},DialogPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_hide")},DialogPanel}(c.BasePanel),m=function(t){function NpcDialogueItem(e,i,n,a){var s=t.call(this,e)||this;return s.dpr=0,s.zoom=0,s.zoom=n,s.dpr=i,s.selectBg=s.scene.make.image({x:0,y:0,key:a,frame:"select_bg"}),s.arrImg=s.scene.make.image({x:.5*-s.selectBg.width,y:0,key:a,frame:"arrow_r"}),s.content=s.scene.make.text({x:0,y:0,text:"",style:{color:"#000000",fontSize:15*i,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),s.add([s.selectBg,s.arrImg,s.content]),s.width=s.selectBg.width,s.height=s.selectBg.height,s.on("pointerdown",s.onClickHandler,s),s}return d(NpcDialogueItem,t),NpcDialogueItem.prototype.setItemData=function(t){this.itemData=t,this.content.text=t.text,this.select=!1},NpcDialogueItem.prototype.setHandler=function(t){this.handler=t},Object.defineProperty(NpcDialogueItem.prototype,"select",{set:function(t){this.selectBg.visible=t},enumerable:!1,configurable:!0}),NpcDialogueItem.prototype.setItemSize=function(e,i){t.prototype.setSize.call(this,e,i),this.selectBg.displayWidth=e,this.arrImg.x=.5*-e*.9,this.content.x=this.arrImg.x+20*this.dpr*this.zoom,this.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains)},NpcDialogueItem.prototype.onClickHandler=function(){this.handler&&this.handler.runWith(this)},NpcDialogueItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"LoginPanel",(function(){return p}));var n,a=i(6),s=i(21),o=i(479),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function LoginPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.areaCode="86",i.downcount=-1,i.mMediator=i.render.mainPeer[h.ModuleName.LOGIN_NAME],i.key=h.ModuleName.LOGIN_NAME,i}return c(LoginPanel,t),LoginPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&this.setInputVisible(!0)},LoginPanel.prototype.hide=function(){t.prototype.hide.call(this)},LoginPanel.prototype.setInputVisible=function(t){this.mPhoneCodeInput&&(this.mPhoneCodeInput.visible=t,this.mPhoneInput.visible=t)},LoginPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.fetchTime&&clearTimeout(this.fetchTime)},LoginPanel.prototype.setLoginEnable=function(t){this.loginBtn.enable=t},LoginPanel.prototype.preload=function(){this.addAtlas(this.key,"login/login.png","login/login.json"),this.addAtlas(s.c.commonKey,s.d.commonUrl+".png",s.d.commonUrl+".json"),t.prototype.preload.call(this)},LoginPanel.prototype.init=function(){var e=this.scene.cameras.main.width/this.scale,i=this.scene.cameras.main.height/this.scale,n=(this.scene.add.container(0,0,this),this.scale,this.scene.make.graphics(void 0,!1));n.fillRect(0,0,e,i),n.fillGradientStyle(7304703,7304703,118271,118271);var h=this.scene.make.image({x:0,y:0,key:this.key,frame:"cloud_left"},!1).setOrigin(0);h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var c=this.scene.make.image({x:e,y:0,key:this.key,frame:"cloud_right"},!1).setOrigin(1,0);c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var p=this.scene.make.image({x:.5*e,y:44*this.dpr,key:this.key,frame:"logo"},!1).setOrigin(.5,0);p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var d=this.scene.make.image({key:this.key,frame:"bg"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.x=.5*e,d.y=i-.5*d.height,this.mPhoneInput=new o.InputField(this.scene,0,0,256*this.dpr,40*this.dpr,{type:"tel",maxLength:11,placeholder:"请输入手机号码",color:"#717171",fontSize:16*this.dpr+"px"}),this.mPhoneInput.on("enter",this.onEnterPhoneHandler,this);var u=this.createInput(this.mPhoneInput,.5*e,97*this.dpr+p.y+p.height),m=localStorage.getItem("accountphone");if(m)try{this.mPhoneInput.text=JSON.parse(m).account}catch(t){}this.mPhoneCodeInput=new o.InputField(this.scene,0,0,156*this.dpr,40*this.dpr,{type:"tel",maxLength:4,placeholder:"验证码",color:"#717171",text:"",fontSize:16*this.dpr+"px"}).setOrigin(0,.5),this.mPhoneCodeInput.on("enter",this.onEnterCodeHandler,this);var f=this.createInput(this.mPhoneCodeInput,.5*e,172*this.dpr+p.y+p.height,256*this.dpr);this.mPhoneCodeInput.x=-f.width/2+8*this.dpr;var y=this.scene.make.text({x:.5*e,text:"抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",style:{color:"#FFEC48",align:"center",fontSize:11*this.dpr+"px",fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5);y.y=i-50*this.dpr-.5*y.height;var g=this.scene.make.text({x:.5*e,text:"本网络游戏适合年满16周岁以上的用户，请您确认已如实进行\n实名注册，为了您的健康，请合理控制游戏时间。",style:{color:"#FFFFFF",align:"center",fontSize:9.33*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5);g.y=i-16*this.dpr-.5*g.height;var P=this.scene.make.image({x:12*this.dpr,key:this.key,frame:"line"},!1);P.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.fetchCode=this.scene.make.text({text:"获取验证码",style:{fontSize:14*this.dpr+"px",fontFamily:l.Font.DEFULT_FONT,color:"#2B5AF3"}},!1).setOrigin(.5).setInteractive(),this.fetchCode.x=.5*(f.width-this.fetchCode.width)-22*this.dpr,this.fetchCode.on("pointerup",this.onFetchCodeHandler,this),this.fetchCode.on("pointerdown",this.onFetchCodeDownHandler,this),f.add([P,this.fetchCode]),this.loginBtn=new a.NineSliceButton(this.scene,.5*e,f.y+f.height+33*this.dpr,191*this.dpr,50*this.dpr,s.c.commonKey,"yellow_btn","登 录",this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:14*this.dpr,bottom:12*this.dpr}),this.loginBtn.setTextStyle({color:"#995E00",fontSize:22*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.loginBtn.setFontStyle("bold"),this.loginBtn.on(String(a.ClickEvent.Down),this.LoginDownHandler,this),this.loginBtn.on(String(a.ClickEvent.Tap),this.tryLogin,this);var _=new a.BBCodeText(this.scene,0,0,"我已阅读并同意皮卡堂的[area=userService][color=#FFEC48]《用户服务协议》[/color][/area]和[area=privacy][color=#FFEC48]《隐私与保护政策》[/color][/area]",{color:"#ffffff",fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}).setOrigin(.5,.5).setInteractive().on("areadown",(function(t){l.Helpers.openUrl("https://picatown.com/con_news/news.php?nid=1201")}));this.acceptBtn=new a.CheckBox(this.scene,this.key,"accept_unchecked","accept_checked").on(String(a.ClickEvent.Tap),this.onCheckboxHandler,this),_.x=this.loginBtn.x+8*this.dpr,_.y=this.loginBtn.y+.5*this.loginBtn.height+24*this.dpr,this.acceptBtn.x=_.x-.5*_.width-8*this.dpr,this.acceptBtn.y=_.y,this.acceptBtn.selected=!0,this.add([n,d,h,c,p,u,f,y,g,this.loginBtn,this.acceptBtn,_]),t.prototype.init.call(this)},LoginPanel.prototype.createInput=function(t,e,i,n){var s=this.scene.make.container({x:e,y:i},!1),o=this.scene.textures.getFrame(this.key,"input_bg"),h=new a.NineSlicePatch(this.scene,t.x-8*this.dpr,t.y,(n||t.width)+14*this.dpr,o.height,this.key,"input_bg",{left:27*this.dpr,top:0*this.dpr,right:28*this.dpr,bottom:0*this.dpr},this.dpr,1);return s.add([t,h]),s.setSize(h.width,h.height),s},LoginPanel.prototype.onFetchCodeDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onFetchCodeHandler=function(){var t=this;11===this.mPhoneInput.text.length?this.fetchTime||(this.downcount=60,this.fetchTime=setInterval((function(){--t.downcount<=0&&(clearInterval(t.fetchTime),t.fetchTime=void 0),t.downcount>0?t.fetchCode.setText("获取验证码("+t.downcount+")"):t.fetchCode.setText("获取验证码")}),1e3),this.render.remote[h.MAIN_WORKER].onFetchCodeHandler()):this.render.onLoginErrorHanler("error","手机格式错误")},LoginPanel.prototype.tryLogin=function(){var t=this.mPhoneInput.text,e=this.mPhoneCodeInput.text;11===t.length?e?(this.mMediator||(this.mMediator=this.render.mainPeer[h.ModuleName.LOGIN_NAME]),this.mMediator.login(t,e,this.areaCode)):this.render.onLoginErrorHanler("error","验证码格式错误"):this.render.onLoginErrorHanler("error","手机格式错误")},LoginPanel.prototype.LoginDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onCheckboxHandler=function(){this.tryLogin&&(this.loginBtn.enable=this.acceptBtn.selected)},LoginPanel.prototype.onEnterPhoneHandler=function(){this.mPhoneCodeInput.setFocus()},LoginPanel.prototype.onEnterCodeHandler=function(){this.mPhoneCodeInput.setBlur(),this.tryLogin()},LoginPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"VerifiedPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function VerifiedPanel(e,i){var n=t.call(this,e,i)||this;return n.isIDCard=/^[1-9]\d{5}(19|20|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,n.key=l.ModuleName.VERIFIED_NAME,n}return c(VerifiedPanel,t),VerifiedPanel.prototype.setVerifiedEnable=function(t){this.mIDCardInput&&(this.mNameInput.visible=t,this.mIDCardInput.visible=t,this.mVerifiedBtn.enable=t)},VerifiedPanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},VerifiedPanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height,s=this.scene.make.graphics(void 0,!1);s.fillStyle(0,.6),s.fillRect(.5*-i,.5*-n,i,n).setInteractive(new Phaser.Geom.Rectangle(.5*-i,.5*-n,i,n),Phaser.Geom.Rectangle.Contains);var l=this.scene.make.container({},!1),c=this.scene.make.image({key:o.c.common2Key,frame:"bg"},!1);l.setSize(c.width,c.height);var p=this.scene.make.image({y:-16.33*this.dpr-.5*l.height,key:o.c.common2Key,frame:"title"},!1).setOrigin(.5,0),d=this.scene.make.text({y:p.y+14.67*this.dpr,text:"实名注册",style:{color:"#905B06",fontSize:16*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(.5,0);this.mNameInput=new a.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"text",placeholder:"请输入真实姓名",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5),this.mIDCardInput=new a.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"tel",maxLength:18,placeholder:"请输入有效身份证号",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5);var u=this.createInput(this.mNameInput,"*真实姓名：",0,0);u.x=.5*-u.width,u.y=95*this.dpr+.5*u.height-.5*l.height;var m=this.createInput(this.mIDCardInput,"*身份证号：",0,u.y+u.height+15*this.dpr);m.x=u.x;var f=this.scene.make.text({y:40*this.dpr-.5*l.height,text:"根据国家新闻出版署发布《关于未成年人沉迷网络\n游戏的通知》规定，网络游戏用户需要使用有效期\n身份证进行实名注册才能体验游戏。",style:{align:"center",fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#111111"}},!1).setOrigin(.5,0),y=this.scene.make.text({y:.5*l.height-75*this.dpr,text:"请务必保证您的身份信息确实无误，此信息仅作实名认证，我们将严格\n按照有关法律法规妥善保存、保护，不会用做其他用途。",style:{align:"center",fontSize:8*this.dpr,fontFamily:h.Font.DEFULT_FONT,color:"#FF0000"}},!1).setOrigin(.5,1);this.add([s,l]),this.mVerifiedBtn=new a.NineSliceButton(this.scene,0,.5*l.height-16*this.dpr,110*this.dpr,34*this.dpr,o.c.commonKey,"yellow_btn","提交认证",this.dpr,this.scale,{left:12*this.dpr*this.scale,top:12*this.dpr*this.scale,right:12*this.dpr*this.scale,bottom:12*this.dpr*this.scale}),this.mVerifiedBtn.setTextStyle({color:"#996600",fontSize:14*this.dpr,fontFamily:h.Font.DEFULT_FONT}),this.mVerifiedBtn.on(String(a.ClickEvent.Down),this.onVerifiedDownHandler,this),this.mVerifiedBtn.on(String(a.ClickEvent.Tap),this.onVerifiedHandler,this),this.mVerifiedBtn.y-=this.mVerifiedBtn.height/2,this.mVerifiedBtn.setFontStyle("bold"),l.add([c,p,d,u,m,f,y,this.mVerifiedBtn]),t.prototype.init.call(this),this.x=i*this.originX,this.y=n*this.originY,l.y=.3*-this.y},VerifiedPanel.prototype.onVerifiedHandler=function(){var t=this.mNameInput.text,e=this.mIDCardInput.text;t?e&&18===e.length?this.checkIdCard()?(this.render.onLoginErrorHanler("error","[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]"),this.render.remote[l.MAIN_WORKER].onVerifiedHandler(t,e)):this.render.onLoginErrorHanler("error","[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]"):this.render.onLoginErrorHanler("error","[color=#F9361B]证件格式有误[/color]"):this.render.onLoginErrorHanler("error","[color=#F9361B]名字不能为空[/color]")},VerifiedPanel.prototype.onVerifiedDownHandler=function(){this.mNameInput&&(this.mNameInput.setBlur(),this.mIDCardInput.setBlur())},VerifiedPanel.prototype.createInput=function(t,e,i,n){var a=this.scene.make.container({x:i,y:n},!1),s=this.scene.make.text({text:e,style:{color:"#ff0000",fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT}}).setOrigin(0,.5),o=this.scene.make.graphics(void 0,!1),l=189*this.dpr,c=36.67*this.dpr;return o.fillStyle(14540253),o.lineStyle(2*this.dpr,10592673),o.fillRoundedRect(s.width,.5*-c,l,c,2*this.dpr),t.x=s.width+10*this.dpr,a.add([s,o,t]),a.setSize(l+t.x,c),a},VerifiedPanel.prototype.checkIdCard=function(){var t=this.mIDCardInput.text;if(this.isIDCard.test(t)&&18===t.length){for(var e=t.split(""),i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,a=0;a<17;a++)n+=e[a]*i[a];return["1","0","X","9","8","7","6","5","4","3","2"][n%11]===e[17].toLocaleUpperCase()}return!1},Object.defineProperty(VerifiedPanel.prototype,"verifiedBtn",{get:function(){return this.mVerifiedBtn},enumerable:!1,configurable:!0}),VerifiedPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicManorInfoPanel",(function(){return d}));var n,a=i(500),s=i(501),o=i(479),h=i(0),l=i(21),c=i(2),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicManorInfoPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAMANORINFO_NAME,i}return p(PicManorInfoPanel,t),PicManorInfoPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a),this.content.x=.5*n,this.content.y=.5*a},PicManorInfoPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.mShowData&&this.setManorInfo(this.mShowData)):this.preload())},PicManorInfoPanel.prototype.addListen=function(){this.mInitialized},PicManorInfoPanel.prototype.removeListen=function(){this.mInitialized},PicManorInfoPanel.prototype.preload=function(){this.addAtlas(this.key,"manor/manor.png","manor/manor.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),this.addAtlas(l.c.common2Key,l.d.common2Url+".png",l.d.common2Url+".json"),this.addAtlas(l.c.common3Key,l.d.textureUrl(l.d.common3Url),l.d.jsonUrl(l.d.common3Url)),t.prototype.preload.call(this)},PicManorInfoPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround),this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.resize(i,n),this.openManorChild(),t.prototype.init.call(this)},PicManorInfoPanel.prototype.setManorInfo=function(t){this.manorInfo=t,this.picChildPanel&&this.picChildPanel.setManorInfoData(t)},PicManorInfoPanel.prototype.setShopCategories=function(t){this.picShopPanel&&this.picShopPanel.setShopCategories(t)},PicManorInfoPanel.prototype.setShopDatas=function(t){this.picShopPanel&&this.picShopPanel.setShopDatas(t)},PicManorInfoPanel.prototype.setManorTips=function(){this.picTipsPanel.setManorTipsData(c.i18n.t("manor.successtitle"))},PicManorInfoPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicManorInfoPanel.prototype.openManorChild=function(){this.showChildPanel(),this.picChildPanel.setTitleText(c.i18n.t("manor.landstatus"))},PicManorInfoPanel.prototype.openManorShop=function(){this.showShopPanel(),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_getCategories",this.manorInfo.manorIndex)},PicManorInfoPanel.prototype.showChildPanel=function(){var t=this;if(!this.picChildPanel){var e=334*this.dpr,i=353*this.dpr;this.picChildPanel=new a.PicaManorChildPanel(this.scene,this.render,0,0,e,i,this.dpr,this.scale,this.key),this.picChildPanel.setHandler(new c.Handler(this,(function(e,i){-1!==e?t.manorInfo&&t.render.mainPeer.getUserData_CurRoomID().then((function(n){t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_buyeditor",{roomid:n,index:t.manorInfo.manorIndex,type:e,manorName:i})})):(t.openManorShop(),t.hideChildPanel())}))),this.picChildPanel.setCloseHandler(new c.Handler(this,this.OnCloseHandler))}this.content.add(this.picChildPanel)},PicManorInfoPanel.prototype.hideChildPanel=function(){this.content.remove(this.picChildPanel)},PicManorInfoPanel.prototype.showShopPanel=function(){var t=this;if(!this.picShopPanel){var e=334*this.dpr,i=455*this.dpr;this.picShopPanel=new s.PicaManorShopPanel(this.scene,0,0,e,i,this.key,this.dpr,this.scale),this.picShopPanel.setHandler(new c.Handler(this,(function(e,i){"usetype"===e?t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_usingitem",i):"buytype"===e&&t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_buyItem",i)})),new c.Handler(this,(function(){t.hideShopPanel(),t.openManorChild()}))),this.picShopPanel.on("queryProp",(function(e,i,n){t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_queryProp",{page:e,category:i,subCategory:n})}),this)}this.content.add(this.picShopPanel),this.picShopPanel.refreshMask()},PicManorInfoPanel.prototype.hideShopPanel=function(){this.content.remove(this.picShopPanel)},PicManorInfoPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_hide")},PicManorInfoPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorTipsPanel",(function(){return c}));var n,a=i(6),s=i(21),o=i(2),h=i(487),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaManorTipsPanel(e,i,n,a,s,o,h,l){return t.call(this,e,i,n,a,s,o,l)||this}return l(PicaManorTipsPanel,t),PicaManorTipsPanel.prototype.setManorTipsData=function(t){this.contentText.text=t;this.nineButton.setFrameNormal("red_btn_normal"),this.nineButton.setText(o.i18n.t("manor.otherbtn")),this.nineButton.setTextColor("#ffffff")},PicaManorTipsPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaManorTipsPanel.prototype.create=function(){t.prototype.create.call(this);this.contentText=this.scene.make.text({x:0,y:-10*this.dpr,text:o.i18n.t(""),style:{fontSize:18*this.dpr,align:"center",fontFamily:o.Font.DEFULT_FONT,color:"#111111"}}).setOrigin(.5),this.contentText.setLineSpacing(20*this.dpr),this.add(this.contentText),this.nineButton=new a.NineSliceButton(this.scene,0,0,110*this.dpr,35*this.dpr,s.c.commonKey,"red_btn_normal",o.i18n.t("business_street.takeall"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.add(this.nineButton),this.nineButton.y=.5*this.height-.5*this.nineButton.height-15*this.dpr,this.nineButton.setTextStyle({fontSize:15*this.dpr,fontFamily:o.Font.DEFULT_FONT,color:"#ffffff"}),this.nineButton.setFontStyle("bold"),this.nineButton.on(String(a.ClickEvent.Tap),this.onNineButtonHandler,this)},PicaManorTipsPanel.prototype.createBackground=function(t,e){this.bg=this.scene.make.image({key:s.c.common2Key,frame:"bg_universal_box"}),this.add(this.bg)},PicaManorTipsPanel.prototype.onNineButtonHandler=function(){this.sendHandler&&this.sendHandler.run()},PicaManorTipsPanel}(h.PicaManorBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicRoomUpgradePanel",(function(){return l}));var n,a=i(479),s=i(0),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicRoomUpgradePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.MAX_TIMES=4,i.key=s.ModuleName.PICAROOMUPGRADE_NAME,i}return h(PicRoomUpgradePanel,t),PicRoomUpgradePanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n)},PicRoomUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicRoomUpgradePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicRoomUpgradePanel.prototype.updateData=function(){var t=this.mShowData;this.mTitleName.text=t.text[0].text;var e=t.data[0];this.roomIcon.on(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this),this.mPlayedTimes=0,this.roomIcon.play("lv"+e)},PicRoomUpgradePanel.prototype.addListen=function(){this.mInitialized&&(this.setInteractive(new Phaser.Geom.Rectangle(.5*this.width,.5*this.height,this.width,this.height),Phaser.Geom.Rectangle.Contains),this.on("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.removeListen=function(){this.mInitialized&&(this.removeInteractive(),this.off("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.destroy=function(){this.mPlayedTimes=0,t.prototype.destroy.call(this)},PicRoomUpgradePanel.prototype.preload=function(){this.addAtlas(this.key,"e_roomupgrade/e_roomupgrade.png","e_roomupgrade/e_roomupgrade.json"),t.prototype.preload.call(this)},PicRoomUpgradePanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.clear(),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,462*this.dpr);var n=this.scene.make.image({x:0,y:-20*this.dpr,key:this.key,frame:"effect_bg"});this.content.add(n);var a=this.scene.make.image({key:this.key,frame:"tittle_bg"});a.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.y=.5*-this.content.height;var s=22*this.dpr+"px "+o.Font.DEFULT_FONT;this.mTitleName=this.scene.make.text({x:0,y:a.y,text:"",style:{font:s,fill:"#FFF36D"}}).setOrigin(.5),this.mTitleName.setStroke("#471C1E",8),this.mTitleName.setShadow(2,2,"#471C1E",2,!0,!0),this.mTitleName.setTint(16773997,16773997,16756224,16756224),this.content.add([a,this.mTitleName]);var h=this.scene.make.text({x:0,y:.5*this.content.height-40*this.dpr,text:o.i18n.t("room_upgrade.clicktocontinue"),style:{fontFamily:o.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#FFF000"}}).setOrigin(.5);this.roomIcon=this.scene.make.sprite({key:this.key,frame:"lv1"}),this.roomIcon.y=-40*this.dpr,this.content.add([this.roomIcon,h]),this.add(this.content),this.createAnimations(),this.resize(0,0),t.prototype.init.call(this)}},PicRoomUpgradePanel.prototype.onClickHandler=function(){if(!(this.mPlayedTimes<this.MAX_TIMES)){var t=this.mShowData;this.render.renderEmitter(s.ModuleName.PICAROOMUPGRADE_NAME+"_querytargetui",t.id)}},PicRoomUpgradePanel.prototype.createAnimations=function(){for(var t=1;t<=4;t++)this.scene.anims.create({key:"lv"+t,frames:this.scene.anims.generateFrameNames(this.key,{prefix:"lv",frames:[t-1,t]}),duration:500,repeat:-1})},PicRoomUpgradePanel.prototype.animationRepeat=function(){this.mPlayedTimes++,this.mPlayedTimes>=this.MAX_TIMES&&this.roomIcon.off(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this)},PicRoomUpgradePanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaAvatarPanel",(function(){return m}));var n,a=i(6),s=i(479),o=i(484),h=i(21),l=i(0),c=i(2),p=i(1),d=i(480),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},m=function(t){function PicaAvatarPanel(e,i){var n=t.call(this,e)||this;return n.mSelectedItemData=[],n.mSelectedItems=[],n.dressAvatarIDS=[],n.dressAvatarDatas=[],n.isInitAvatar=!1,n.avatarDirection=0,n.key=l.ModuleName.PICAAVATAR_NAME,n.mSceneType=i,n.atlasNames=[h.d.uicommon],n.textures=[{atlasName:"avater_bg_adorn",folder:"texture"},{atlasName:"avater_bg_stripe",folder:"texture"}],n}return u(PicaAvatarPanel,t),PicaAvatarPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.mBackground.clear(),this.mBackground.fillStyle(118271),this.mBackground.fillRect(0,0,n,a),this.mShelfContainer.setSize(n,295*this.dpr),this.mShelfContainer.y=a-this.mShelfContainer.height+6*this.dpr,this.mDetailBubble.y=this.mShelfContainer.y-10*this.dpr-this.mDetailBubble.height,this.mCategoryScroll.x=.5*n,this.mCategoryScroll.y=this.mShelfContainer.y+20*this.dpr,this.mBg.x=n/2,this.mBg.y=this.mBg.height/2+10*this.dpr;var s=a-this.mShelfContainer.height-80*this.dpr;this.mDetailDisplay.x=n/2,this.mDetailDisplay.y=.5*s+80*this.dpr,this.mDetailDisplay.setInteractive(new Phaser.Geom.Rectangle(0,0,110*this.dpr,s),Phaser.Geom.Rectangle.Contains),this.rotateAvatarBtn.x=n/2+100*this.dpr,this.rotateAvatarBtn.y=this.mDetailDisplay.y,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=this.mShelfContainer.y+.5*this.mPropGrid.height+48*this.dpr,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,a),this.setInteractive()},PicaAvatarPanel.prototype.setCategories=function(t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var a={value:"",key:""};a.value=c.i18n.t("common.all"),a.key="alltype",t.unshift(a);for(var o=0;o<t.length;o++){var h=new s.TextButton(this.scene,this.dpr,1,t[o].value,0,0);h.x=o*e,h.y=i-h.text.height-20*this.dpr,h.setData("item",t[o]),h.setSize(e,i),this.mCategoryScroll.addItem(h),h.setChangeColor("#FFD248"),n[o]=h,h.setFontSize(17*this.dpr),h.setFontStyle("bold")}n.length>1&&this.onSelectSubCategoryHandler(n[0]),this.updateCategeoriesLoc(!1)},PicaAvatarPanel.prototype.setProp=function(t,e){void 0===e&&(e=!1),t=t||[],this.mSelectedItems.length=0;var i=t.length;if(i<24&&(t=t.concat(new Array(24-i))),this.mPropGrid.setItems(t),0===this.dressAvatarDatas.length){for(var n=0,a=t;n<a.length;n++){var s=a[n];s&&s.rightSubscript===p.op_pkt_def.PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK&&this.dressAvatarDatas.push(s)}this.isInitAvatar&&this.initBaseAvatar(),this.isInitAvatar=!0}},PicaAvatarPanel.prototype.setDressAvatarIds=function(t){this.dressAvatarIDS=t,this.isInitAvatar&&this.initBaseAvatar(),this.isInitAvatar=!0},PicaAvatarPanel.prototype.initBaseAvatar=function(){var t=this;if(this.isInitAvatar){for(var e=[],i=0,n=this.dressAvatarIDS;i<n.length;i++)for(var a=n[i],s=0,o=this.dressAvatarDatas;s<o.length;s++){var h=o[s];h.id===a&&(e.push(h),this.mSelectedItemData.push(h))}this.dressAvatarDatas.length=0,this.dressAvatarDatas=e,this.displayAvatar(),this.mDetailBubble.visible=!1}else{var l=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(e){return l=e,t.serviceTimestamp})).then((function(e){t.mDetailBubble.setProp(null,Math.floor(e/1e3),l),t.mDetailBubble.y=t.mShelfContainer.y-10*t.dpr-t.mDetailBubble.height}))}},PicaAvatarPanel.prototype.displayAvatar=function(t){var e=this;t||(t={avatar:{}}),this.render.mainPeer.getPlayerAvatar().then((function(i){var n=i.avatar;i.suits;for(var a in n=n||l.AvatarSuitType.createBaseAvatar()){if(n.hasOwnProperty(a))(d=n[a])&&(t.avatar[a]=d)}for(var s=0,o=e.mSelectedItemData;s<o.length;s++){var h=o[s],p=l.AvatarSuitType.createAvatarBySn(h.suitType,h.sn,h.slot,h.tag,h.version);for(var a in p){var d;if(p.hasOwnProperty(a))(d=p[a])&&(t.avatar[a]=d)}if("weapon"===h.suitType){var u={suit_type:h.suitType,tag:h.tag};t.suits=[u]}}var m=new Phaser.Geom.Point(0,50*e.dpr);e.mDetailDisplay.loadAvatar(t,2*e.dpr,m),c.Logger.getInstance().error("测试调用+++++装扮重置问题",e.mSelectedItemData)}))},PicaAvatarPanel.prototype.setSelectedResource=function(t){t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.displayAvatar()},PicaAvatarPanel.prototype.resetAvatar=function(t){var e={avatar:null};e.avatar=t.avatar;var i=new Phaser.Geom.Point(0,50*this.dpr);this.mDetailDisplay.loadAvatar(e,2*this.dpr,i),this.mSelectedItemData.length=0},PicaAvatarPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this),this.saveBtn.on(a.ClickEvent.Tap,this.onSaveBtnHandler,this),this.resetBtn.on(a.ClickEvent.Tap,this.onResetBtnHandler,this),this.rotateAvatarBtn.on(a.ClickEvent.Tap,this.onRotateAvatarHandler,this))},PicaAvatarPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(a.ClickEvent.Tap,this.onCloseHandler,this),this.saveBtn.off(a.ClickEvent.Tap,this.onSaveBtnHandler,this),this.resetBtn.off(a.ClickEvent.Tap,this.onResetBtnHandler,this),this.rotateAvatarBtn.off(a.ClickEvent.Tap,this.onRotateAvatarHandler,this))},PicaAvatarPanel.prototype.fetchCategory=function(){this.onSelectedCategory(p.op_pkt_def.PKT_PackageType.AvatarPackage)},PicaAvatarPanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaAvatarPanel.prototype.queryRefreshPackage=function(t){void 0===t&&(t=!1),this.queryPackege(t)},PicaAvatarPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1);var s=this.scene.make.image({key:h.d.uicommon,frame:"avater_bg"});s.displayWidth=i,s.x=.5*i,this.mBg=this.scene.make.image({key:"avater_bg_stripe"},!1),this.mBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mShelfContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.setSize(i,295*this.dpr),this.mShelfContainer.y=n-this.mShelfContainer.height;var l=this.scene.make.image({key:h.d.uicommon,frame:"avater_nav"});l.displayWidth=i,l.x=.5*i,l.y=.5*l.height,this.mShelfContainer.add(l),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new a.Button(this.scene,h.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,50*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains);var p=this.scene.make.image({key:h.d.uicommon,frame:"avater_name_bg"});p.x=.5*i,p.y=this.mCloseBtn.y,this.nameText=this.scene.make.text({x:p.x,y:p.y,text:"",style:c.UIHelper.whiteStyle(this.dpr,14)}).setOrigin(.5);var d=this.scene.make.image({key:"avater_bg_adorn"});d.x=.5*d.width,d.y=.5*d.height,d.scaleX=-1;var u=this.scene.make.image({key:"avater_bg_adorn"});u.x=i-.5*d.width,u.y=.5*d.height;var m=90*this.dpr,g=38*this.dpr,P=i-m/2-20*this.dpr,_=this.mShelfContainer.y-25*this.dpr;this.saveBtn=this.createNineButton(P,_,m,g,h.d.uicommon,"yellow_btn",c.i18n.t("common.save"),"#996600"),this.resetBtn=new a.Button(this.scene,h.d.uicommon,"avater_repeal"),this.resetBtn.x=i-30*this.dpr,this.resetBtn.y=this.mCloseBtn.y,this.rotateAvatarBtn=new a.Button(this.scene,h.d.uicommon,"avater_turn_back","avater_turn_back"),this.mDetailDisplay=new o.a(this.scene,this.render),this.mDetailDisplay.setComplHandler(new c.Handler(this,(function(){e.mDetailDisplay.visible=!0}))),this.mDetailDisplay.setTexture(h.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.mDetailDisplay.on("pointerup",this.onAvatarClickHandler,this),this.mDetailDisplay.y=this.mBg.y+this.mBg.height/2,this.mDetailBubble=new f(this.scene,h.d.uicommon,this.dpr),this.mDetailBubble.x=10*this.dpr,this.mCategoryScroll=new a.GameScroller(this.scene,{x:.5*i,y:this.mShelfContainer.y+20*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.add([this.mBackground,s,d,u,this.mBg,this.mCloseBtn,p,this.nameText,this.mDetailDisplay,this.mDetailBubble]),this.add([this.mShelfContainer,this.mCategoryScroll,this.saveBtn,this.resetBtn,this.rotateAvatarBtn]);var v=this.scene.textures.getFrame(h.d.uicommon,"avater_icon_check"),b=v.width+2*this.dpr,T=v.height+2*this.dpr,S={x:0,y:0,table:{width:i,height:260*this.dpr,columns:3,cellWidth:b,cellHeight:T,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;if(null===i&&(i=new y(n,0,0,h.d.uicommon,e.dpr,e.scale)),i.setData({item:a}),i.setProp(a),a&&e.isSelectedItemData(a))i.isSelect=!0,e.mSelectedItems.push(i);else{var s=e.mSelectedItems.indexOf(i);-1!==s&&e.mSelectedItems.splice(s,1)}return i}};this.mPropGrid=new a.GameGridTable(this.scene,S),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaAvatarPanel.prototype.createNineButton=function(t,e,i,n,s,o,h,l){var p=new a.NineSliceButton(this.scene,t,e,i,n,s,o,h,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return h&&(p.setTextStyle({color:l,fontSize:16*this.dpr,fontFamily:c.Font.DEFULT_FONT}),p.setFontStyle("bold")),p},PicaAvatarPanel.prototype.setSelectAvatarSuitItem=function(t,e){var i=t.suitType;if(i){for(var n=0,a=this.mSelectedItems;n<a.length;n++){a[n].isSelect=!1}for(var s=[],o=0,h=this.mSelectedItemData;o<h.length;o++){var d=h[o];l.SuitAlternativeType.checkAlternative(i,d.suitType)&&s.push(d)}for(var u=0,m=s;u<m.length;u++){d=m[u];var f=this.mSelectedItemData.indexOf(d);this.mSelectedItemData.splice(f,1);for(var y=0;y<this.mSelectedItems.length;y++){if(this.mSelectedItems[y].propData===d){this.mSelectedItems.splice(y,1);break}}}this&&this.mSelectedItemData.push(t),this.mSelectedItems.push(e),e.isSelect=!0;var g=new p.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;g.avatar=l.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version),g.animations=t.animations,this.setSelectedResource(g)}else c.Logger.getInstance().error("CountablePackageItem avatar does not exist",t)},PicaAvatarPanel.prototype.isSelectedItemData=function(t){if(this.mSelectedItemData.length>0&&this.mSelectedItemData[this.mSelectedItemData.length-1].indexId===t.indexId)return!0;return!1},PicaAvatarPanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){this.mPreCategoryBtn&&this.mPreCategoryBtn instanceof s.TextButton&&this.mPreCategoryBtn.changeNormal(),t instanceof s.TextButton&&t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0);var i=0!==this.mSelectedItemData.length;this.queryPackege(i),this.mPreCategoryBtn=t}this.mPropGrid.setT(0)},PicaAvatarPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaAvatarPanel.prototype.queryPackege=function(t){void 0===t&&(t=!1),this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryPackage",{packType:this.categoryType,key:this.mSelectedCategeories.key,isupdate:t})},PicaAvatarPanel.prototype.onSelectItemHandler=function(t){var e=this,i=t.getData("item");if(i)if(this.isSelectedItemData(i))t.isSelect=!0;else{this.mDetailBubble.visible=!0;var n=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return n=t,e.serviceTimestamp})).then((function(t){e.mDetailBubble.setProp(i,Math.floor(t/1e3),n),e.mDetailBubble.y=e.mShelfContainer.y-10*e.dpr-e.mDetailBubble.height})),i&&(this.avatarDirection=0,this.setSelectAvatarSuitItem(i,t),this.nameText.text=i.name)}},PicaAvatarPanel.prototype.onSelectedCategory=function(t){this.categoryType=t,this.render.renderEmitter(this.key+"_queryDressAvatarIDS"),this.render.renderEmitter(this.key+"_getCategories",t)},PicaAvatarPanel.prototype.onSaveBtnHandler=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n,a,s,o,h,c,p;return __generator(this,(function(d){switch(d.label){case 0:for(this.dressAvatarIDS.length=0,this.dressAvatarDatas.length=0,t=[],e=0,i=this.mSelectedItemData;e<i.length;e++)n=i[e],t.push(n.id),this.dressAvatarIDS.push(n.id),this.dressAvatarDatas.push(n);for(this.render.renderEmitter(this.key+"_querySaveAvatar",t),a=[],s=l.AvatarSuitType.suitPart,o=0,h=this.dressAvatarDatas;o<h.length;o++)c=h[o],a.push({parts:s[c.suitType],id:c.sn});return[4,this.render.editorCanvasManager.createHeadIcon(a)];case 1:return p=d.sent(),this.render.mainPeer.uploadHeadImage(p),[2]}}))}))},PicaAvatarPanel.prototype.onResetBtnHandler=function(){this.mSelectedItemData.length=0;for(var t=0,e=this.dressAvatarDatas;t<e.length;t++){var i=e[t];this.mSelectedItemData.push(i)}this.displayAvatar(),this.mPropGrid.refresh()},PicaAvatarPanel.prototype.onRotateAvatarHandler=function(){this.avatarDirection++,this.avatarDirection>=2&&(this.avatarDirection=0);var t=this.getAvatarAni(),e={name:"idle",flip:t.flip},i=t.back;this.mDetailDisplay.setPlayAnimation(e,i)},PicaAvatarPanel.prototype.onAvatarClickHandler=function(){var t=["idle","run","mining","crafting"],e=t[Math.floor(Math.random()*t.length)],i=this.getAvatarAni(),n={name:e,flip:i.flip,times:1,playingQueue:{name:"idle",playTimes:-1}},a=i.back;this.mDetailDisplay.setPlayAnimation(n,a)},PicaAvatarPanel.prototype.getAvatarAni=function(){var t=!1,e=!1;switch(this.avatarDirection){case 0:t=!1,e=!1;break;case 1:case 2:t=!0,e=!0;break;case 3:t=!1,e=!0}return{back:t,flip:e}},PicaAvatarPanel.prototype.updateCategeoriesLoc=function(t){for(var e=this.mCategoryScroll.getItemList(),i=(this.dpr,null),n=30*this.dpr,a=(this.mScene.cameras.main.width,n),s=0;s<e.length;s++){var o=e[s];s>0?(i=e[s-1],o.x=i.x+i.width):o.x=a,a+=o.width}this.mCategoryScroll.setAlign()},Object.defineProperty(PicaAvatarPanel.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),PicaAvatarPanel}(d.PicaBasePanel),f=function(t){function DetailBubble(e,i,n,s){void 0===s&&(s=1);var o=t.call(this,e)||this;o.dpr=n;var l=100*n,p=96*n;return o.setSize(l,p),o.tipsbg=new a.NineSlicePatch(o.scene,0,0,l,p,h.d.uicommon,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,0),o.tipsbg.setPosition(.5*l,.5*p),o.tipsbg.alpha=.6,o.tipsText=new a.BBCodeText(o.scene,7*n,-p+60*o.dpr,"",{color:"#333333",fontSize:12*o.dpr,fontFamily:c.Font.DEFULT_FONT,lineSpacing:6*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("char"),o.tipsText.setWrapWidth(200*n),o.mExpires=new a.BBCodeText(e,7*n,85*n,"",{fontSize:12*o.dpr,fontFamily:c.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:h.d.uicommon,frame:"home_silver",y:-3*o.dpr}),o.tipsText.addImage("iv_diamond",{key:h.d.uicommon,frame:"home_diamond",y:-3*o.dpr}),o}return u(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){var n=this;if(t){this.tipsText.setWrapWidth(void 0);var a="",s="",o="",h="",l="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]",p=100*this.dpr;this.tipsText.text=l,p=p<this.tipsText.width?this.tipsText.width:p,t.source&&(a=""+t.source,l+="[color=#ffffff][size="+12*this.dpr+"]"+a+"[/size][/color]",this.tipsText.text=a,p=p<this.tipsText.width?this.tipsText.width:p),t.des&&""!==t.des&&(l+="\n"+(s=t.des),this.tipsText.text=s,p=p<this.tipsText.width?this.tipsText.width:p);var d=!1;if(t.affectValues){for(var u=t.affectValues.length,m=0;m<u;m++){var f=t.affectValues[m];if(i.hasProperty(f.key)){var y=i.getProperty(f.key),g=f.value>0?"[color=#ffff00]+"+f.value+"[/color]":"[color=#ff0000]"+f.value+"[/color]";o+="\n"+y.name+": "+g}}o.length>0&&(d||(d=!0,l+="\n-- -- -- -- -- -- -- --"),l+="\n[color=#ffffff]"+c.i18n.t("furni_bag.properties")+"[/color]"+o)}if(t.requireValues){for(u=t.requireValues.length,m=0;m<u;m++){var P=t.requireValues[m];if(i.hasProperty(P.key)){g=(y=i.propertiesMap.get(P.key)).value>=P.value?"[color=#00ff00]("+P.value+")[/color]":"[color=#ff0000]("+P.value+")[/color]";h+="\n"+y.name+": "+g}}h.length>0&&(d||(d=!0,l+="\n-- -- -- -- -- -- -- --"),l+="\n"+c.i18n.t("furni_bag.needproper")+":"+h)}if(this.tipsText.text=l,this.width=this.tipsText.width+14*this.dpr,t.expiredTime>0){d||(d=!0,l+="\n-- -- -- -- -- -- -- --");var _=t.expiredTime-e,timeout_1=function(){n.mExpires.visible=!0,n.mExpires.text=n.getDataFormat(1e3*_),n.timeID=_>0?setTimeout((function(){_-=1,timeout_1()}),1e3):void 0};timeout_1()}else this.mExpires.visible=!1,this.timeID&&clearTimeout(this.timeID);this.resize()}else this.tipsText.setText(c.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,s=c.i18n.t("furni_bag.timelimit")+":  ";if(e>0)s+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]";else if(i>0||n>0||a>0){s+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]"}else{s+="[color=#FF0000]"+(""+c.i18n.t("furni_bag.expires"))+"[/color]"}return s},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble}(Phaser.GameObjects.Container),y=function(t){function Item(e,i,n,a,o,h){var l=t.call(this,e,i,n)||this;l.zoom=1,l.dpr=o,l.zoom=h,l.key=a;var p=e.make.image({key:a,frame:"avater_icon_uncheck"},!1);return p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.selectbg=e.make.image({key:a,frame:"avater_icon_check"},!1),l.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.setSize(p.displayWidth,p.displayHeight),l.selectIcon=e.make.image({key:a,frame:"selected"},!1).setOrigin(1).setPosition(.5*l.width,.5*l.height),l.selectIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mPropImage=new s.DynamicImage(l.scene,0,0),l.mPropImage.scale=o/l.zoom,l.mCounter=e.make.text({x:.5*l.width-2*o,y:.5*l.height,style:{fontSize:12*o,fontFamily:c.Font.DEFULT_FONT}},!1).setOrigin(1),l.add([p,l.selectbg,l.selectIcon,l.mPropImage,l.mCounter]),l.isSelect=!1,l.isEquip=!1,l}return u(Item,t),Item.prototype.setProp=function(t){this.propData=t,this.isSelect=!1,this.isEquip=!1,this.mPropImage.visible=!1,t?(t.tag&&"remove"===JSON.parse(t.tag).type?(this.mPropImage.setTexture(h.d.uicommon,"backpack_close"),this.mPropImage.scale=1,this.mPropImage.visible=!0):(this.mPropImage.scale=this.dpr/this.zoom,this.mPropImage.load(c.Url.getOsdRes(t.texturePath),this,this.onPropLoadCompleteHandler)),t.count>1?(this.mCounter.visible=!0,this.mCounter.setText(t.count.toString())):this.mCounter.visible=!1,1===t.rightSubscript?this.isEquip=!0:this.isEquip=!1):this.mCounter.visible=!1},Item.prototype.onPropLoadCompleteHandler=function(){if(this.mPropImage&&this.mPropImage.texture){var t=this.mPropImage.texture;this.mPropImage.visible=!0,t&&t.setFilter(Phaser.Textures.FilterMode.NEAREST)}},Object.defineProperty(Item.prototype,"isSelect",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(Item.prototype,"isEquip",{set:function(t){this.selectIcon.visible=t},enumerable:!1,configurable:!0}),Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBagPanel",(function(){return m}));var n,a=i(6),s=i(479),o=i(484),h=i(21),l=i(0),c=i(2),p=i(1),d=i(480),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaBagPanel(e){var i=t.call(this,e)||this;return i.topBtns=[],i.mEnableEdit=!1,i.mAttributes=[],i.atlasNames=[h.d.uicommon],i.textures=[{atlasName:"bag_bg",folder:"texture"}],i.key=l.ModuleName.PICABAG_NAME,i}return u(PicaBagPanel,t),PicaBagPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.mBackground.x=.5*n,this.mBackground.y=.5*a,this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=a-this.mPropGrid.height-.5*this.mCategoryCon.height-47*this.dpr,this.mCategoryCon.x=.5*n,this.mDetailBubble.y=this.mCategoryCon.y-10*this.dpr-this.mDetailBubble.height,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.mCategoriesBar.fillStyle(439765),this.mCategoriesBar.fillRect(0,40*this.dpr,n,3*this.dpr),this.useBtn.x=n-this.useBtn.width/2-10*this.dpr,this.useBtn.y=this.mCategoryCon.y-this.useBtn.height/2,this.recasteBtn.x=this.useBtn.x,this.recasteBtn.y=this.useBtn.y-this.recasteBtn.height-15*this.dpr,this.mDetailDisplay.x=n/2,this.mDetailDisplay.y=.5*(a-296*this.dpr-60*this.dpr)+60*this.dpr,this.mIconBg.x=this.mDetailDisplay.x,this.mIconBg.y=this.mDetailDisplay.y,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(8250878),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=a-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=a-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,a),this.setInteractive()},PicaBagPanel.prototype.setCategories=function(t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var a={value:c.i18n.t("common.all"),key:"alltype"};t.unshift(a);for(var o=0;o<t.length;o++){var h=new s.TextButton(this.scene,this.dpr,1,t[o].value,0,0);h.setData("item",t[o]),h.setSize(e,i),this.mCategoryScroll.addItem(h),n[o]=h,h.setFontSize(18*this.dpr),h.setFontStyle("bold")}this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0]),this.updateCategeoriesLoc(!1)},PicaBagPanel.prototype.setProp=function(t,e){void 0===e&&(e=!1),t=t||[];var i=[],n=this.mSelectedCategeories.key;this.mSelectedItem=void 0;for(var a=!1,s=0,o=t;s<o.length;s++){var h=o[s];this.mSelectedItemData&&h.indexId===this.mSelectedItemData.indexId&&(this.mSelectedItemData=h,a=!0),"alltype"!==n&&n!==h.subcategory||i.push(h)}e&&(this.mSelectedItemData||(e=!1),a||(e=!1));var l=i.length;if(l<18&&(i=i.concat(new Array(18-l))),this.mPropGrid.setItems(i),!e){this.mSelectedItemData=void 0;var c=this.mPropGrid.getCell(0);c.container&&this.onSelectItemHandler(c.container)}},PicaBagPanel.prototype.setMoneyData=function(t,e){t=t||0,e=e||0,this.moneyData={money:t,diamond:e},this.mInitialized&&(this.moneyvalue.setText(t+""),this.diamondvalue.setText(e+""))},PicaBagPanel.prototype.setSceneData=function(t,e){this.mSceneType=t,this.mEnableEdit=e,this.sceneData={sceneType:t,editor:e},this.mInitialized&&this.createCategory(t,e)},PicaBagPanel.prototype.setSelectedResource=function(t){t.display&&this.mDetailDisplay.loadDisplay(t)},PicaBagPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this),this.useBtn.on(a.ClickEvent.Tap,this.onUseBtnHandler,this),this.recasteBtn.on(a.ClickEvent.Tap,this.onRecasteHandler,this))},PicaBagPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(a.ClickEvent.Tap,this.onCloseHandler,this),this.useBtn.off(a.ClickEvent.Tap,this.onUseBtnHandler,this),this.recasteBtn.off(a.ClickEvent.Tap,this.onRecasteHandler,this))},PicaBagPanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaBagPanel.prototype.queryRefreshPackage=function(t){void 0===t&&(t=!1),this.queryPackege(t)},PicaBagPanel.prototype.onSellPropsHandler=function(t,e,i){this.mCategoryScroll.addListen(),this.render.renderEmitter(this.key+"_sellProps",{prop:e,count:i,category:t})},PicaBagPanel.prototype.onSellPropsFailedHandler=function(t){this.mCategoryScroll.addListen()},PicaBagPanel.prototype.onUsePropsHandler=function(t,e){this.mCategoryScroll.addListen(),this.render.renderEmitter(this.key+"_useprops",{itemid:t.id,count:e})},PicaBagPanel.prototype.onUsePropsFailedHandler=function(t){this.mCategoryScroll.addListen()},PicaBagPanel.prototype.onInitialized=function(){this.moneyData&&(this.moneyvalue.setText(this.moneyData.money+""),this.diamondvalue.setText(this.moneyData.diamond+"")),this.sceneData&&this.createCategory(this.sceneData.sceneType,this.sceneData.editor)},PicaBagPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new s.CommonBackground(this.scene,0,0,i,n),this.mIconBg=this.scene.make.image({key:"bag_bg"},!1),this.mIconBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new a.Button(this.scene,h.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,35*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains);var l=new a.NineSlicePatch(this.scene,0,-this.dpr,190*this.dpr,28*this.dpr,h.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});l.x=.5*-l.width;var p=this.scene.make.image({x:l.x,y:0,key:h.d.uicommon,frame:"home_assets_division"},!1);this.moneyvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,h.d.uicommon,"home_silver",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:c.Font.NUMBER}),this.moneyvalue.setLayout(1),this.moneyvalue.x=l.x-.5*l.width+22*this.dpr,this.diamondvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,h.d.uicommon,"home_diamond",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:c.Font.NUMBER}),this.diamondvalue.setLayout(1),this.diamondvalue.x=l.x+22*this.dpr,this.moneyAddBtn=new a.Button(this.scene,h.d.uicommon,"home_praise_bg","home_praise_bg");var d=this.scene.make.image({x:0,y:0,key:h.d.uicommon,frame:"home_assets_add"},!1);this.moneyAddBtn.add(d),this.moneyAddBtn.x=.5*-this.moneyAddBtn.width-4*this.dpr,this.moneyAddBtn.on(a.ClickEvent.Tap,this.onRechargeHandler,this),this.moneyCon=this.scene.make.container(void 0,!1),this.moneyCon.setSize(l.width,l.height),this.moneyCon.add([l,p,this.moneyvalue,this.diamondvalue,this.moneyAddBtn]),this.moneyCon.x=i-20*this.dpr,this.moneyCon.y=this.mCloseBtn.y;var u=this.scene.make.image({key:h.d.uicommon,frame:"avater_name_bg"});u.x=.5*i,u.y=this.mCloseBtn.y+40*this.dpr,this.nameText=this.scene.make.text({x:u.x,y:u.y,text:"",style:c.UIHelper.whiteStyle(this.dpr,14)}).setOrigin(.5),this.nameText.setFontStyle("bold"),this.starImage=this.scene.make.image({key:h.d.uicommon,frame:"bag_star_big_1"}),this.starImage.x=u.x,this.starImage.y=u.y+.5*u.height+15*this.dpr,this.moreButton=new a.Button(this.scene,h.d.uicommon,"online_more"),this.moreButton.x=i-.5*this.moreButton.width-20*this.dpr,this.moreButton.y=u.y,this.moreButton.on(a.ClickEvent.Tap,this.onMoreHandler,this),this.moreButton.visible=!1;var m=100*this.dpr,y=40*this.dpr,g=i-m/2-20*this.dpr,P=this.mCategoryCon.y-25*this.dpr;this.useBtn=this.createNineButton(g+100*this.dpr,P,m,y,h.d.uicommon,"yellow_btn",c.i18n.t("common.use"),"#996600"),this.recasteBtn=this.createNineButton(this.useBtn.x,this.useBtn.y,m,y,h.d.uicommon,"yellow_btn",c.i18n.t("furni_bag.recaste"),"#996600"),this.recasteBtn.visible=!1,this.mDetailDisplay=new o.a(this.scene,this.render),this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.mDetailDisplay.setComplHandler(new c.Handler(this,(function(){e.mDetailDisplay.visible=!0}))),this.mDetailDisplay.setTexture(h.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.mDetailDisplay.y=this.mIconBg.y+this.mIconBg.height/2,this.mDetailBubble=new f(this.scene,h.d.uicommon,this.dpr),this.mDetailBubble.x=10*this.dpr,this.mCategoryScroll=new a.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add([this.mCategoriesBar,this.mCategoryScroll]),this.add([this.mBackground,this.mPropGridBg,this.mIconBg,this.mCloseBtn,this.moneyCon,this.mDetailDisplay,u,this.nameText,this.starImage,this.moreButton,this.mDetailBubble,this.mCategoryCon,this.useBtn,this.recasteBtn]);var _=this.scene.textures.getFrame(h.d.uicommon,"bag_icon_common_bg"),v=_.width+9*this.dpr,b=_.height+9*this.dpr,T={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:v,cellHeight:b,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new o.c(n,h.d.uicommon,"bag_icon_common_bg",e.dpr,e.scale,!1)),i.setData({item:a}),i.setItemData(a),a&&e.isSelectedItemData(a)&&(i.isSelect=!0,e.mSelectedItem=i,e.mSelectedItemData=a),i}};this.mPropGrid=new a.GameGridTable(this.scene,T),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaBagPanel.prototype.createCategory=function(t,e){var i=this.scaleWidth,n=90*this.dpr,o=35*this.dpr,l=23*this.dpr;this.topCheckBox=new s.CheckboxGroup;var p=[3,1],d=[c.i18n.t("furni_bag.Props"),c.i18n.t("furni_bag.furni")];2===t&&(p=[5],d=[c.i18n.t("furni_bag.furni")]);var u=.5*-i+.5*n+1*this.dpr,m=this.scene.textures.getFrame(h.d.uicommon,"bag_tab_uncheck"),f=60;m&&(f=m.width,m.height);var y={left:f/2,top:12*this.dpr,right:4*this.dpr,bottom:2*this.dpr};for(var g in p){var P=p[v=Number(g)],_=new a.NinePatchTabButton(this.scene,n,o,h.d.uicommon,"bag_tab_uncheck","bag_tab_select",d[v],[y]);_.tweenScale=1,_.setTextStyle(c.UIHelper.whiteStyle(this.dpr,18)),_.setData("data",P),_.setSize(n,o),_.setFontStyle("bold"),_.y=l,_.x=u,u+=n+3*this.dpr,this.topBtns.push(_)}if(this.topCheckBox.appendItemAll(this.topBtns),this.topCheckBox.on("selected",this.onTopCategoryHandler,this),this.mCategoryCon.add(this.topBtns),e){var v=p.indexOf(5);this.topCheckBox.selectIndex(v)}else this.topCheckBox.selectIndex(0)},PicaBagPanel.prototype.createNineButton=function(t,e,i,n,s,o,h,l){var p=new a.NineSliceButton(this.scene,t,e,i,n,s,o,h,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return h&&(p.setTextStyle({color:l,fontSize:16*this.dpr,fontFamily:c.Font.DEFULT_FONT}),p.setFontStyle("bold")),p},PicaBagPanel.prototype.setSelectedItem=function(t,e){if(this.mSelectedItem&&(this.mSelectedItem.isSelect=!1),this.nameText.text=t.name||t.shortName,t.grade>0){this.starImage.visible=!0;var i="bag_star_big_"+t.grade;this.starImage.setFrame(i)}else this.starImage.visible=!1;this.mSelectedItemData=t,this.mSelectedItem=e,e.isSelect=!0,this.mDetailDisplay.displayLoading("loading_ui",c.Url.getUIRes(this.dpr,"loading_ui"),c.Url.getUIRes(this.dpr,"loading_ui"));var n=new p.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;n.display=1===this.categoryType?t.animationDisplay:t.display,n.animations=t.animations,this.setSelectedResource(n)},PicaBagPanel.prototype.isSelectedItemData=function(t){return!!this.mSelectedItemData&&this.mSelectedItemData.indexId===t.indexId},PicaBagPanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){this.mPreCategoryBtn&&this.mPreCategoryBtn instanceof s.TextButton&&this.mPreCategoryBtn.changeNormal(),t instanceof s.TextButton&&t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0);var i=void 0!==this.mSelectedItemData;this.queryPackege(i),this.mPreCategoryBtn=t}this.mPropGrid.setT(0)},PicaBagPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaBagPanel.prototype.queryPackege=function(t){void 0===t&&(t=!1),this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryPackage",{packType:this.categoryType,key:this.mSelectedCategeories.key,isupdate:t})},PicaBagPanel.prototype.onSelectItemHandler=function(t){var e=this,i=t.getData("item");if(!(i&&this.mSelectedItemData===i||this.mSelectedItemData&&!i)){this.mDetailBubble.visible=!0;var n=null;this.render.mainPeer.getUserData_PlayerProperty().then((function(t){return n=t,e.serviceTimestamp})).then((function(t){e.mDetailBubble.setProp(i,Math.floor(t/1e3),n),e.mDetailBubble.y=e.mCategoryCon.y-10*e.dpr-e.mDetailBubble.height,i&&e.setItemAttribute(i,n)})),i?(3===this.categoryType&&"pkt_market_tag_20013"!==i.subcategory?this.useBtn.visible=!1:this.useBtn.visible=!0,this.setSelectedItem(i,t)):2!==this.categoryType&&void 0===this.mSelectedItemData&&(this.useBtn.visible=!1,this.mDetailDisplay.setTexture(h.d.uicommon,"bag_nothing",1),this.mDetailDisplay.setNearest(),this.nameText.text="")}},PicaBagPanel.prototype.setItemAttribute=function(t,e){for(var i=0,n=this.mAttributes;i<n.length;i++){(d=n[i]).visible=!1}if(t.affectValues){for(var o=t.affectValues.length>=6?6:t.affectValues.length,l=0;l<o;l++){var p=t.affectValues[l],d=void 0;if(l<this.mAttributes.length)(d=this.mAttributes[l]).visible=!0;else{var u=new a.NineSlicePatch(this.scene,0,0,56*this.dpr,22*this.dpr,h.d.uicommon,"bag_attribute_bg",{left:12*this.dpr,right:12*this.dpr,top:0,bottom:0});(d=new s.DynamicImageValue(this.scene,56*this.dpr,22*this.dpr,h.d.uicommon,"",this.dpr)).setOffset(-3*this.dpr,0),d.addAt(u,0),d.setLayout(2),this.add(d),this.mAttributes.push(d)}if(e.propertiesMap){var m=e.propertiesMap.get(p.key);if(m){var f=p.value>0?"+"+p.value:p.value+"";m.display?(d.load(c.Url.getOsdRes(m.display.texturePath)),d.setText(f),d.setOffset(-3*this.dpr,0)):(d.setText(f),d.setOffset(-10*this.dpr,0))}else d.visible=!1}else d.visible=!1}this.setLayoutAttribute()}},PicaBagPanel.prototype.setLayoutAttribute=function(){var t=[];if(this.mAttributes.forEach((function(e){e.visible&&t.push(e)})),0!==t.length){for(var e=56*this.dpr,i=21*this.dpr,n=23*this.dpr,a=.5*this.scaleWidth,s=this.nameText.y+30*this.dpr,o=t.length>3?3:t.length,h=e*o+n*(o-1),l=a-.5*h,c=0,p=0,d=t;p<d.length;p++){var u=d[p];u.x=l+.5*e,u.y=s,l+=e+n,3===++c&&(l=a-.5*h,s+=13*this.dpr+i)}t.length=0}},PicaBagPanel.prototype.onAddFurniToSceneHandler=function(){if(this.mSelectedItemData)if(this.mSceneType===p.op_def.SceneTypeEnum.EDIT_SCENE_TYPE||this.mEnableEdit)this.render.renderEmitter(this.key+"_addFurniToScene",this.mSelectedItemData.id);else{var t={text:[{text:c.i18n.t("furni_bag.placetips"),node:void 0}]};this.render.mainPeer.showMediator(l.ModuleName.PICANOTICE_NAME,!0,t),this.mCategoryScroll.addListen()}},PicaBagPanel.prototype.onTopCategoryHandler=function(t){var e=t.getData("data");this.clearCategoryData(),this.recasteBtn.visible=!1,e&&(this.onSelectedCategory(e),1===e||5===e?(this.useBtn.setText(c.i18n.t("furni_bag.add")),1===e&&(this.moreButton.visible=!0)):(this.useBtn.setText(c.i18n.t("common.use")),this.moreButton.visible=!1))},PicaBagPanel.prototype.clearCategoryData=function(){this.mSelectedItemData=void 0},PicaBagPanel.prototype.onSelectedCategory=function(t){this.categoryType=t,this.render.renderEmitter(this.key+"_getCategories",t)},PicaBagPanel.prototype.getPropResource=function(t){var e={};return t.suitType?e.avatar=l.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version):e.display=t.display,e.suit=[{suit_type:t.suitType,sn:t.sn,tag:t.tag,version:t.version}],e.animations=t.animations,e},PicaBagPanel.prototype.onMoreButtonHandler=function(t){"place"===t?this.onAddFurniToSceneHandler():"sell"===t&&this.onSellBtnHandler()},PicaBagPanel.prototype.onSellBtnHandler=function(){if(this.mCategoryScroll.removeListen(),this.mSelectedItemData){var t=this.mSelectedItemData;if(!t.recyclable)return;var e=c.i18n.t("common.sold"),i=this.getPropResource(t);t.avatar?i.avatar=t.avatar:i.display=t.display,i.animations=t.animations;var n={key:this.key,confirmFunc:"onSellPropsHandler",cancelFunc:"onSellPropsFailedHandler",confirmAddData:this.categoryType};this.showPropFun({resultHandler:n,data:t,title:e,resource:i})}},PicaBagPanel.prototype.onUseBtnHandler=function(){if(this.mCategoryScroll.removeListen(),this.mSelectedItemData)if(1===this.categoryType||5===this.categoryType)this.onAddFurniToSceneHandler();else{var t=this.mSelectedItemData,e=c.i18n.t("common.use"),i=this.getPropResource(t),n={key:this.key,confirmFunc:"onUsePropsHandler",cancelFunc:"onUsePropsFailedHandler"};this.showPropFun({resultHandler:n,data:t,price:!1,title:e,resource:i})}},PicaBagPanel.prototype.onRechargeHandler=function(){},PicaBagPanel.prototype.onRecasteHandler=function(){if(5!==this.mSelectedItemData.rarity){var t=this.mSelectedItemData;this.render.mainPeer.showMediator(l.ModuleName.PICARECASTE_NAME,!0,t)}else{var e={text:[{text:c.i18n.t("recaste.raritytips"),node:void 0}]};this.render.mainPeer.showMediator(l.ModuleName.PICANOTICE_NAME,!0,e)}},PicaBagPanel.prototype.onMoreHandler=function(){this.recasteBtn.visible=!0,this.moreButton.visible=!1},PicaBagPanel.prototype.updateCategeoriesLoc=function(t){for(var e=this.mCategoryScroll.getItemList(),i=(this.dpr,null),n=30*this.dpr,a=(this.mScene.cameras.main.width,n),s=0;s<e.length;s++){var o=e[s];s>0?(i=e[s-1],o.x=i.x+i.width):o.x=a,a+=o.width}this.mCategoryScroll.setAlign()},PicaBagPanel.prototype.showPropFun=function(t){this.render.mainPeer.showMediator(l.ModuleName.PICAPROPFUN_NAME,!0,t)},Object.defineProperty(PicaBagPanel.prototype,"serviceTimestamp",{get:function(){var t=this;return new Promise((function(e,i){t.render.mainPeer.requestCurTime().then((function(t){e(t)}))}))},enumerable:!1,configurable:!0}),PicaBagPanel}(d.PicaBasePanel),f=function(t){function DetailBubble(e,i,n,s){void 0===s&&(s=1);var o=t.call(this,e)||this;o.dpr=n,o.key=i;var h=100*n,l=96*n;return o.setSize(h,l),o.tipsbg=new a.NineSlicePatch(o.scene,0,0,h,l,o.key,"tips_bg",{left:10*o.dpr,top:10*o.dpr,right:10*o.dpr,bottom:10*o.dpr},void 0,void 0,0),o.tipsbg.setPosition(.5*h,.5*l),o.tipsbg.alpha=.6,o.tipsText=new a.BBCodeText(o.scene,7*n,-l+60*o.dpr,"",{color:"#333333",fontSize:12*o.dpr,fontFamily:c.Font.DEFULT_FONT,lineSpacing:5*n,padding:{top:2*n}}).setOrigin(0),o.tipsText.setWrapMode("char"),o.tipsText.setWrapWidth(200*n),o.mExpires=new a.BBCodeText(e,7*n,85*n,"",{fontSize:12*o.dpr,fontFamily:c.Font.DEFULT_FONT}).setOrigin(0),o.add([o.tipsbg,o.tipsText,o.mExpires]),o.tipsText.addImage("iv_coin",{key:o.key,frame:"home_silver",y:-3*o.dpr}),o.tipsText.addImage("iv_diamond",{key:o.key,frame:"home_diamond",y:-3*o.dpr}),o}return u(DetailBubble,t),DetailBubble.prototype.setProp=function(t,e,i){var n=this;if(t){var a="",s="",o="",h="",l="[color=#32347b][b][size="+14*this.dpr+"]"+(t.shortName||t.name)+"[/size][/b][/color]",p=100*this.dpr;this.tipsText.text=l,p=p<this.tipsText.width?this.tipsText.width:p,t.source&&(a=""+t.source,l+="[color=#ffffff][size="+12*this.dpr+"]"+a+"[/size][/color]",this.tipsText.text=a,p=p<this.tipsText.width?this.tipsText.width:p),t.des&&""!==t.des&&(l+="\n"+(s=t.des),this.tipsText.text=s,p=p<this.tipsText.width?this.tipsText.width:p);var d=!1;if(t.affectValues){for(var u=t.affectValues.length,m=0;m<u;m++){var f=t.affectValues[m];if(i.propertiesMap)if(g=i.propertiesMap.get(f.key)){var y=f.value>0?"[color=#ffff00]+"+f.value+"[/color]":"[color=#ff0000]"+f.value+"[/color]";o+="\n"+g.name+": "+y}}o.length>0&&(d||(d=!0,l+="\n-- -- -- -- -- -- -- --"),l+="\n[color=#ffffff]"+c.i18n.t("furni_bag.properties")+"[/color]"+o)}if(t.requireValues){for(u=t.requireValues.length,m=0;m<u;m++){var g,P=t.requireValues[m];if(i.propertiesMap)if(g=i.propertiesMap.get(P.key)){y=g.value>=P.value?"[color=#00ff00]("+P.value+")[/color]":"[color=#ff0000]("+P.value+")[/color]";h+="\n"+g.name+": "+y}}h.length>0&&(d||(d=!0,l+="\n-- -- -- -- -- -- -- --"),l+="\n"+c.i18n.t("furni_bag.needproper")+":"+h)}if(this.tipsText.text=l,this.width=this.tipsText.width+14*this.dpr,t.expiredTime>0){d||(d=!0,l+="\n-- -- -- -- -- -- -- --");var _=t.expiredTime-e,timeout_1=function(){n.mExpires.visible=!0,n.mExpires.text=n.getDataFormat(1e3*_),n.timeID=_>0?setTimeout((function(){_-=1,timeout_1()}),1e3):void 0};timeout_1()}else this.mExpires.visible=!1,this.timeID&&clearTimeout(this.timeID);this.resize()}else this.tipsText.setText(c.i18n.t("furni_bag.empty_backpack")),this.mExpires.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,e){var i=96*this.dpr,n=this.tipsText.height;this.mExpires.visible&&(n+=this.mExpires.height+3*this.dpr),n=(n+=14*this.dpr)<i?i:n,this.setSize(this.width,n),this.tipsbg.resize(this.width,this.height),this.tipsbg.x=.5*this.width,this.tipsbg.y=.5*this.height,this.tipsText.y=7*this.dpr,this.mExpires.y=this.tipsText.y+this.tipsText.height+3*this.dpr},DetailBubble.prototype.getDataFormat=function(t){var e=Math.floor(t/864e5),i=Math.floor(t/36e5)%24,n=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,s=c.i18n.t("furni_bag.timelimit")+":  ";if(e>0)s+="[color=#FF0000]"+(e+"-"+this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]";else if(i>0||n>0||a>0){s+="[color=#FF0000]"+(this.stringFormat(i)+":"+this.stringFormat(n)+":"+this.stringFormat(a))+"[/color]"}else{s+="[color=#FF0000]"+(""+c.i18n.t("furni_bag.expires"))+"[/color]"}return s},DetailBubble.prototype.stringFormat=function(t){var e=t+"";return e.length<=1&&(e="0"+e),e},DetailBubble}(Phaser.GameObjects.Container);!function(t){function Item(e,i,n,a,o,h){void 0===h&&(h=1);var l=t.call(this,e,i,n)||this;l.dpr=o,l.zoom=h,l.key=a;var p=e.make.image({key:a,frame:"grid_bg"},!1);return p.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.selectbg=e.make.image({key:a,frame:"grid_choose"},!1),l.selectbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.setSize(p.displayWidth,p.displayHeight),l.selectIcon=e.make.image({key:a,frame:"selected"},!1).setOrigin(1).setPosition(.5*l.width,.5*l.height),l.selectIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.mPropImage=new s.DynamicImage(l.scene,0,0),l.mPropImage.scale=o/l.zoom,l.timeIcon=e.make.image({key:a,frame:"time"}),l.timeIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.timeIcon.setPosition(.5*-l.width+.5*l.timeIcon.width,.5*-l.height+.5*l.timeIcon.height),l.mCounter=e.make.text({x:.5*l.width-2*o,y:.5*l.height,style:{fontSize:12*o,fontFamily:c.Font.DEFULT_FONT}},!1).setOrigin(1),l.add([p,l.selectbg,l.selectIcon,l.mPropImage,l.timeIcon,l.mCounter]),l.isSelect=!1,l.isEquip=!1,l}u(Item,t),Item.prototype.setProp=function(t){if(this.propData=t,this.isSelect=!1,this.isEquip=!1,this.mPropImage.visible=!1,!t)return this.mCounter.visible=!1,void(this.timeIcon.visible=!1);t.tag&&"remove"===JSON.parse(t.tag).type?(this.mPropImage.setTexture(h.d.uicommon,"backpack_close"),this.mPropImage.scale=1,this.mPropImage.visible=!0):(this.mPropImage.scale=this.dpr/this.zoom,this.mPropImage.load(c.Url.getOsdRes(t.texturePath),this,this.onPropLoadCompleteHandler)),this.timeIcon.visible=t.expiredTime>0,t.count>1?(this.mCounter.visible=!0,this.mCounter.setText(t.count.toString())):this.mCounter.visible=!1,1===t.rightSubscript?this.isEquip=!0:this.isEquip=!1},Item.prototype.onPropLoadCompleteHandler=function(){if(this.mPropImage&&this.mPropImage.texture){var t=this.mPropImage.texture;this.mPropImage.visible=!0,t&&t.setFilter(Phaser.Textures.FilterMode.NEAREST)}},Object.defineProperty(Item.prototype,"isSelect",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(Item.prototype,"isEquip",{set:function(t){this.selectIcon.visible=t},enumerable:!1,configurable:!0})}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessMarketingPlanPanel",(function(){return u}));var n,a=i(503),s=i(502),o=i(479),h=i(489),l=i(0),c=i(21),p=i(2),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaBusinessMarketingPlanPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key2="c_street_2",i.key=l.ModuleName.PICABUSINESSMARKETINGPLAN_NAME,i}return d(PicaBusinessMarketingPlanPanel,t),PicaBusinessMarketingPlanPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a)},PicaBusinessMarketingPlanPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaBusinessMarketingPlanPanel.prototype.addListen=function(){this.mInitialized},PicaBusinessMarketingPlanPanel.prototype.removeListen=function(){this.mInitialized},PicaBusinessMarketingPlanPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(c.c.common2Key,c.d.common2Url+".png",c.d.common2Url+".json"),t.prototype.preload.call(this)},PicaBusinessMarketingPlanPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var a=90*this.dpr,s=74*this.dpr,o=295*this.dpr,l=n-a-s,c=a+.5*l,d=.5*i;this.content=new h.PicaBusinessContentPanel(this.scene,d,c,o,l,this.dpr,this.key,this.key2),this.content.setCloseHandler(new p.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.setLinear(this.key2),this.openPlanPanel()},PicaBusinessMarketingPlanPanel.prototype.setPlanModels=function(t){this.picChoosePlanPanel.setPlanData(t.marketPlan)},PicaBusinessMarketingPlanPanel.prototype.setEquipedPlan=function(t){this.picBusinessPlanPanel.setPlanData(t)},PicaBusinessMarketingPlanPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaBusinessMarketingPlanPanel.prototype.openPlanPanel=function(){this.showMarketingPlanPanel(),this.picBusinessPlanPanel.setRender(this.render),this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_querymarketplan")},PicaBusinessMarketingPlanPanel.prototype.openChoosePlanPanel=function(){this.showChoosePlanPanel(),this.picChoosePlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.showMarketingPlanPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picBusinessPlanPanel){var n=this.content.width,s=this.content.height-50*this.dpr;this.picBusinessPlanPanel=new a.PicaBusinessPlanPanel(this.scene,0,0,n,s,this.dpr,this.scale,this.key),this.picBusinessPlanPanel.setHandler(new p.Handler(this,(function(){t.hideMarketingPlanPanel(),t.OnCloseHandler()})),new p.Handler(this,(function(e){t.hideMarketingPlanPanel(),t.openChoosePlanPanel(),t.render.renderEmitter(l.RENDER_PEER+"_"+t.key+"_queryplanmodels",e)})))}this.content.add(this.picBusinessPlanPanel),this.picBusinessPlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.hideMarketingPlanPanel=function(){this.content.remove(this.picBusinessPlanPanel)},PicaBusinessMarketingPlanPanel.prototype.showChoosePlanPanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,a=320*this.dpr,o=.5*i,h=.5*e;if(this.content.setPosition(h,o),this.content.setContentSize(n,a),!this.picChoosePlanPanel){var c=this.content.width,d=this.content.height-50*this.dpr;this.picChoosePlanPanel=new s.PicaBusinessChoosePlanPanel(this.scene,0,0,c,d,this.dpr,this.scale,this.key),this.picChoosePlanPanel.setHandler(new p.Handler(this,(function(){t.hideChoosePlanPanel(),t.openPlanPanel()})),new p.Handler(this,(function(e){t.render.renderEmitter(l.RENDER_PEER+"_"+t.key+"_queryselectplan",e)})))}this.content.add(this.picChoosePlanPanel),this.picBusinessPlanPanel.resetMask()},PicaBusinessMarketingPlanPanel.prototype.hideChoosePlanPanel=function(){this.content.remove(this.picChoosePlanPanel)},PicaBusinessMarketingPlanPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,a=295*this.dpr,s=n-t-e,o=t+.5*s,h=.5*i;this.content.setPosition(h,o),this.content.setContentSize(a,s)},PicaBusinessMarketingPlanPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(l.RENDER_PEER+"_"+this.key+"_hide")},PicaBusinessMarketingPlanPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaBusinessStreetPanel",(function(){return P}));var n,a=i(489),s=i(505),o=i(509),h=i(510),l=i(504),c=i(508),p=i(507),d=i(506),u=i(479),m=i(0),f=i(21),y=i(2),g=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),P=function(t){function PicaBusinessStreetPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key2="c_street_2",i.key=m.ModuleName.PICABUSINESSSTREET_NAME,i}return g(PicaBusinessStreetPanel,t),PicaBusinessStreetPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a)},PicaBusinessStreetPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaBusinessStreetPanel.prototype.addListen=function(){this.mInitialized},PicaBusinessStreetPanel.prototype.removeListen=function(){this.mInitialized},PicaBusinessStreetPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(f.c.commonKey,f.d.commonUrl+".png",f.d.commonUrl+".json"),this.addAtlas(f.c.common2Key,f.d.common2Url+".png",f.d.common2Url+".json"),t.prototype.preload.call(this)},PicaBusinessStreetPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var s=90*this.dpr,o=74*this.dpr,h=295*this.dpr,l=n-s-o,c=s+.5*l,p=.5*i;this.content=new a.PicaBusinessContentPanel(this.scene,p,c,h,l,this.dpr,this.key,this.key2),this.content.setCloseHandler(new y.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.setLinear(this.key2),this.openMyStreet()},PicaBusinessStreetPanel.prototype.setMyStore=function(t){this.picMyStreetPanel.setMyStoreData(t)},PicaBusinessStreetPanel.prototype.setCommercialStreet=function(t){this.picStreetListPanel&&this.picStreetListPanel.setStreetListData(t.commercialStreet)},PicaBusinessStreetPanel.prototype.setIndustryModels=function(t){this.industryModels=t,this.picStoreCreatePanel&&this.picStoreCreatePanel.parentContainer&&this.picStoreCreatePanel.setTypeData(t.industry),this.picStreetListPanel&&this.picStreetListPanel.parentContainer&&this.picStreetListPanel.setIndustryModels(this.industryModels)},PicaBusinessStreetPanel.prototype.setStoreRankingList=function(t){this.picStreetRankingPanel.setRankingData(t.rankChampions)},PicaBusinessStreetPanel.prototype.setStoreRankingDetial=function(t){this.picRankingDetailPanel.setRankingDetailData(t)},PicaBusinessStreetPanel.prototype.setStoreRankingReward=function(t){this.picRankRewardPanel.setRankRewardData(t.rewardStage)},PicaBusinessStreetPanel.prototype.setEnterHistory=function(t){this.picStreetHistoryPanel.setHistoryeData(t.history)},PicaBusinessStreetPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaBusinessStreetPanel.prototype.setSecondStore=function(t){this.picSecondStorePanel.setTypeData(t)},PicaBusinessStreetPanel.prototype.openMyStreet=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymystore"),this.showMyStreetPanel(),this.content.setTitleText(y.i18n.t("business_street.commercial_street"))},PicaBusinessStreetPanel.prototype.openStoreCreatePanel=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymodels"),this.showStoreCreatePanel(),this.content.setTitleText(y.i18n.t("business_street.newstore"))},PicaBusinessStreetPanel.prototype.openSecondStorePanel=function(){this.showSecondStorePanel(),this.content.setTitleText(y.i18n.t("business_street.newstore"))},PicaBusinessStreetPanel.prototype.openStoreStreetPanel=function(){this.showStreetListPanel(),this.industryModels?this.picStreetListPanel.setIndustryModels(this.industryModels):this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_querymodels"),this.content.setTitleText(y.i18n.t("business_street.commercial_street"))},PicaBusinessStreetPanel.prototype.openStreetHistoryPanel=function(){this.showStreetHistoryPanel(),this.content.setTitleText(y.i18n.t("business_street.history"))},PicaBusinessStreetPanel.prototype.openStreetRankingPanel=function(){this.showStreetRankingPanel(),this.content.setTitleText(y.i18n.t("business_street.ranking"))},PicaBusinessStreetPanel.prototype.openRankingDetailPanel=function(){this.showRankingDetailPanel(),this.content.setTitleText(y.i18n.t("business_street.ranking"))},PicaBusinessStreetPanel.prototype.openRankRewardPanel=function(){this.showRankRewardPanel(),this.content.setTitleText(y.i18n.t("business_street.rankreward"))},PicaBusinessStreetPanel.prototype.showMyStreetPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picMyStreetPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picMyStreetPanel=new s.PicaBusinessMyStreetPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key),this.picMyStreetPanel.setHandler(new y.Handler(this,(function(){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryallsaves")})),new y.Handler(this,(function(){t.openStoreStreetPanel(),t.hideMyStreetPanel()})),new y.Handler(this,(function(){t.hideMyStreetPanel(),t.openStoreCreatePanel()})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterroom",{roomid:e,password:i})})))}this.content.add(this.picMyStreetPanel),this.picMyStreetPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideMyStreetPanel=function(){this.content.remove(this.picMyStreetPanel)},PicaBusinessStreetPanel.prototype.showStoreCreatePanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,a=320*this.dpr,s=.5*i,h=.5*e;if(this.content.setPosition(h,s),this.content.setContentSize(n,a),!this.picStoreCreatePanel){var l=this.content.width,c=this.content.height-50*this.dpr;this.picStoreCreatePanel=new o.PicaBusinessStoreCreatePanel(this.scene,0,0,l,c,this.dpr,this.scale,this.key),this.picStoreCreatePanel.setHandler(new y.Handler(this,(function(){t.openMyStreet(),t.hideStoreCreatePanel()})),new y.Handler(this,(function(e){t.openSecondStorePanel(),t.hideStoreCreatePanel(),t.setSecondStore(e)})))}this.content.add(this.picStoreCreatePanel),this.picStoreCreatePanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStoreCreatePanel=function(){this.content.remove(this.picStoreCreatePanel)},PicaBusinessStreetPanel.prototype.showSecondStorePanel=function(){var t=this,e=this.scaleWidth,i=this.scaleHeight,n=295*this.dpr,a=320*this.dpr,s=.5*i,h=.5*e;if(this.content.setPosition(h,s),this.content.setContentSize(n,a),!this.picSecondStorePanel){var l=this.content.width,c=this.content.height-50*this.dpr;this.picSecondStorePanel=new o.PicaBusinessStoreCreatePanel(this.scene,0,0,l,c,this.dpr,this.scale,this.key,!1),this.picSecondStorePanel.setHandler(new y.Handler(this,(function(){t.openStoreCreatePanel(),t.hideSecondStorePanel()})),new y.Handler(this,(function(e){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_querycreatestore",e.modelId)})))}this.content.add(this.picSecondStorePanel),this.picSecondStorePanel.resetMask()},PicaBusinessStreetPanel.prototype.hideSecondStorePanel=function(){this.content.remove(this.picSecondStorePanel)},PicaBusinessStreetPanel.prototype.showStreetListPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picStreetListPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picStreetListPanel=new h.PicaBusinessStreetListPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key,this.key2),this.picStreetListPanel.setHandler(new y.Handler(this,(function(){t.openStreetHistoryPanel(),t.hideStreetListPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterhistory")})),new y.Handler(this,(function(){t.openStreetRankingPanel(),t.hideStreetListPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryranklist")})),new y.Handler(this,(function(){t.hideStreetListPanel(),t.openMyStreet()})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_querystreet",{storeby:e,storetype:i})})),new y.Handler(this,(function(e,i){t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryenterroom",{roomid:e,password:i})})))}this.content.add(this.picStreetListPanel),this.picStreetListPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetListPanel=function(){this.content.remove(this.picStreetListPanel)},PicaBusinessStreetPanel.prototype.showStreetHistoryPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picStreetHistoryPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picStreetHistoryPanel=new l.PicaBusinessHistoryPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key,this.key2),this.picStreetHistoryPanel.setHandler(new y.Handler(this,(function(){t.hideStreetHistoryPanel(),t.openStoreStreetPanel()})))}this.content.add(this.picStreetHistoryPanel),this.picStreetHistoryPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetHistoryPanel=function(){this.content.remove(this.picStreetHistoryPanel)},PicaBusinessStreetPanel.prototype.showStreetRankingPanel=function(){var t=this,e=110*this.dpr,i=94*this.dpr;if(this.setContentSize(e,i),!this.picStreetRankingPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picStreetRankingPanel=new c.PicaBusinessRankingPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key,this.key2),this.picStreetRankingPanel.setHandler(new y.Handler(this,(function(){t.hideStreetRankingPanel(),t.openStoreStreetPanel()})),new y.Handler(this,(function(e,i){t.openRankingDetailPanel(),t.hideStreetRankingPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryrankdetail",{key:e,type:i})})))}this.content.add(this.picStreetRankingPanel),this.picStreetRankingPanel.show(),this.picStreetRankingPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideStreetRankingPanel=function(){this.content.remove(this.picStreetRankingPanel),this.picStreetRankingPanel.hide()},PicaBusinessStreetPanel.prototype.showRankingDetailPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picRankingDetailPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picRankingDetailPanel=new p.PicaBusinessRankingDetailPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key,this.key2),this.picRankingDetailPanel.setHandler(new y.Handler(this,(function(){t.hideRankingDetailPanel(),t.openStreetRankingPanel()})),new y.Handler(this,(function(e,i){t.hideRankingDetailPanel(),t.openRankRewardPanel(),t.render.renderEmitter(m.RENDER_PEER+"_"+t.key+"_queryrankreward",{key:e,type:i})})))}this.content.add(this.picRankingDetailPanel),this.picRankingDetailPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideRankingDetailPanel=function(){this.content.remove(this.picRankingDetailPanel)},PicaBusinessStreetPanel.prototype.showRankRewardPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picRankRewardPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picRankRewardPanel=new d.PicaBusinessRankRewardPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key,this.key2),this.picRankRewardPanel.setHandler(new y.Handler(this,(function(){t.hideRankRewardPanel(),t.openRankingDetailPanel()})))}this.content.add(this.picRankRewardPanel),this.picRankRewardPanel.resetMask()},PicaBusinessStreetPanel.prototype.hideRankRewardPanel=function(){this.content.remove(this.picRankRewardPanel)},PicaBusinessStreetPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,a=295*this.dpr,s=n-t-e,o=t+.5*s,h=.5*i;this.content.setPosition(h,o),this.content.setContentSize(a,s)},PicaBusinessStreetPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(m.RENDER_PEER+"_"+this.key+"_hide")},PicaBusinessStreetPanel.prototype.onSelectItemHandler=function(t){},PicaBusinessStreetPanel.prototype.getRichLabel=function(t,e){return void 0===e&&(e="#2B4BB5"),"[stroke="+e+"][color="+e+"]"+t+":[/color][/stroke]"},PicaBusinessStreetPanel.prototype.getspaceStr=function(t){for(var e="",i=0;i<t;i++)e+=" ";return e},PicaBusinessStreetPanel}(u.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaComposePanel",(function(){return u}));var n,a=i(1),s=i(6),o=i(479),h=i(482),l=i(0),c=i(21),p=i(2),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaComposePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=l.ModuleName.PICACOMPOSE_NAME,i}return d(PicaComposePanel,t),PicaComposePanel.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.content.x=.5*e,this.content.y=.5*i,this.mGrideTable.resetMask(),this.materialGameScroll.refreshMask(),this.setSize(e,i)},PicaComposePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaComposePanel.prototype.addListen=function(){this.mInitialized&&this.makeBtn.on(String(s.ClickEvent.Tap),this.onMakeHandler,this)},PicaComposePanel.prototype.removeListen=function(){this.mInitialized&&this.makeBtn.off(String(s.ClickEvent.Tap),this.onMakeHandler,this)},PicaComposePanel.prototype.preload=function(){this.addAtlas(this.key,"compose/compose.png","compose/compose.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaComposePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content);var a=this.scene.make.graphics(void 0,!1);a.clear(),a.fillGradientStyle(7365356,7365356,13408757,13408757),a.fillRect(.5*-i,.5*-n,i,n);var l=this.scene.make.image({key:this.key,frame:"main_bg"});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.y=.5*-n+.5*l.height,l.setInteractive(new Phaser.Geom.Rectangle(0,0,this.cameraWidth,this.cameraHeight),Phaser.Geom.Rectangle.Contains),l.displayWidth=i,this.content.add([a,l]);var d=this.scene.make.image({key:this.key,frame:"title_bg"});d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),d.y=.5*-n+23*this.dpr;var u=this.scene.make.text({x:0,y:d.y,text:p.i18n.t("compose.title"),style:{color:"#8B5603",fontSize:15*this.dpr,fontFamily:p.Font.DEFULT_FONT}}).setOrigin(.5);u.setFontStyle("bold"),this.content.add([d,u]);var y=new s.Button(this.scene,c.c.commonKey,"back_arrow","back_arrow");y.setPosition(.5*-i+20*this.dpr,.5*-n+30*this.dpr),y.on(s.ClickEvent.Tap,this.onBackHandler,this),this.content.add(y),this.mDetailDisplay=new h.DetailDisplay(this.scene,this.render),this.mDetailDisplay.y=-140*this.dpr,this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.content.add(this.mDetailDisplay),this.mDetailBubble=new m(this.scene,this.dpr),this.mDetailBubble.x=.5*-i,this.mDetailBubble.y=.5*n-360*this.dpr,this.content.add(this.mDetailBubble),this.makeBtn=new s.NineSliceButton(this.scene,Math.ceil(.5*i-60*this.dpr),Math.ceil(.5*n-310*this.dpr),106*this.dpr,40*this.dpr,c.c.commonKey,"yellow_btn",p.i18n.t("compose.make"),this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.makeBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.content.add(this.makeBtn);var g=360*this.dpr,P=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(g,P),this.content.add(this.materialCon),this.materialCon.setPosition(0,.5*n-230*this.dpr);var _=this.scene.make.image({x:0,y:0,key:this.key,frame:"sourcelist_bg"});_.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),_.displayWidth=i;var v=this.scene.make.text({x:0,y:.5*-P+12*this.dpr,text:p.i18n.t("compose.needMaterials"),style:{color:"#ffffff",fontSize:13*this.dpr,fontFamily:p.Font.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(.5),b=this.scene.make.image({x:-10*this.dpr,y:v.y,key:this.key,frame:"sourcelist_title_1"});b.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var T=this.scene.make.image({x:10*this.dpr,y:v.y,key:this.key,frame:"sourcelist_title_1"});T.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var S=.5*-v.width-.5*b.width-10*this.dpr;b.setPosition(S,v.y),T.setPosition(-S,v.y).rotation=-Math.PI;var x=this.scene.make.image({x:0,y:v.y+12*this.dpr,key:this.key,frame:"separator"});x.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.materialCon.add([_,v,b,T,x]),this.materialGameScroll=new s.GameScroller(this.scene,{x:0,y:10*this.dpr,width:i,height:70*this.dpr,zoom:this.scale,align:2,orientation:1,dpr:this.dpr,space:10*this.dpr,padding:{left:10*this.dpr},cellupCallBack:function(t){e.onMaterialItemHandler(t)}}),this.materialCon.add(this.materialGameScroll),this.itemtips=new o.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,c.c.commonKey,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add(this.itemtips);var w=this.scene.textures.getFrame(this.key,"bprint_bg_2"),D=w.width+10*this.dpr,C=w.height+12*this.dpr,I=190*this.dpr,k={x:0,y:.5*n-.5*I+20*this.dpr,table:{width:i,height:I,columns:2,cellWidth:D,cellHeight:C,reuseCellContainer:!0,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new f(n,e.key,e.dpr,e.scale)),i.setItemData(a),a&&e.mSelectItemData&&a.skill.id===e.mSelectItemData.skill.id&&(i.select=!0,e.mSelectItem=i),i}};this.mGrideTable=new s.GameGridTable(this.scene,k),this.mGrideTable.layout(),this.mGrideTable.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.content.add(this.mGrideTable),this.resize(i,n),t.prototype.init.call(this),this.mShowData&&this.setComposeData(this.mShowData.skills)},PicaComposePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaComposePanel.prototype.setComposeData=function(t){if(t&&t.length>0){this.mGrideTable.setItems(t);var e=this.mSelectItem?this.mSelectItem:this.mGrideTable.getCell(0).container;this.onSelectItemHandler(e)}},PicaComposePanel.prototype.setComposeDetialData=function(t){this.mDetailBubble.setDetailData(t.productName,t.productDes),this.setDetailDisplay(t),this.setMaterialItems(t.materials)},PicaComposePanel.prototype.setDetailDisplay=function(t){this.mDetailDisplay.loadSprite("loading_ui",p.Url.getUIRes(this.dpr,"loading_ui"),p.Url.getUIRes(this.dpr,"loading_ui"));var e=new a.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;if(e.animations=t.productAnimations,e.display=t.productDisplay,e.avatar=t.productAvatar,e.display)this.mDetailDisplay.loadDisplay(e);else if(e.avatar){var i=new Phaser.Geom.Point;i.x=0,i.y=20*this.dpr,this.mDetailDisplay.loadAvatar(e,2*this.dpr,i)}},PicaComposePanel.prototype.onSelectItemHandler=function(t){var e=t.itemData;this.mSelectItemData=t.itemData,this.makeBtn.enable=e.skill.active&&e.skill.qualified,this.mSelectItem&&(this.mSelectItem.select=!1),this.mSelectItem=t,t.select=!0,this.setComposeDetialData(e)},PicaComposePanel.prototype.setMaterialItems=function(t){var e=t.length,i=[];this.materialGameScroll.clearItems();for(var n=0;n<e;n++){var a=new y(this.scene,this.key,this.dpr);a.y=0,i.push(a),a.setItemData(t[n]),a.setData("itemData",t[n]),this.materialGameScroll.addItem(a)}this.materialGameScroll.Sort()},PicaComposePanel.prototype.onMaterialItemHandler=function(t){this.itemtips.setVisible(!0),this.itemtips.setItemData(t.itemData),this.itemtips.setTipsPosition(t,this.content,-10*this.dpr)},PicaComposePanel.prototype.onMakeHandler=function(){if(this.mSelectItemData){var t={text:[{text:p.i18n.t("compose.confirmation",{name:this.mSelectItemData.productName})}],title:[{text:p.i18n.t("compose.synthesis")}],button:[{text:p.i18n.t("common.cancel"),local:!0,param:0},{text:p.i18n.t("common.confirm"),local:!0,clickhandler:{key:this.key,clickfun:"onConfirmMakeHandler"},param:1}]};this.render.renderEmitter(l.ModuleName.PICACOMPOSE_NAME+"_showpanel",{panel:l.ModuleName.PICAMESSAGEBOX_NAME,data:t})}},PicaComposePanel.prototype.onConfirmMakeHandler=function(){this.render.renderEmitter(l.ModuleName.PICACOMPOSE_NAME+"_reqUseFormula",this.mSelectItemData.skill.id)},PicaComposePanel.prototype.onBackHandler=function(){this.render.renderEmitter(l.ModuleName.PICACOMPOSE_NAME+"_hide")},PicaComposePanel}(o.BasePanel),m=function(t){function DetailBubble(e,i){var n=t.call(this,e)||this;n.dpr=i,n.mDetailBubble=n.scene.make.graphics(void 0,!1);var a=198*i,s=96*i;return n.mDetailBubble=n.scene.make.graphics(void 0,!1),n.mDetailBubble.fillStyle(16777215,.1),n.mDetailBubble.fillRoundedRect(0,0,a,s),n.mItemName=n.scene.make.text({x:7*n.dpr,y:9*n.dpr,text:"道具名称道具名称",style:{fontSize:12*n.dpr,fontFamily:p.Font.DEFULT_FONT,color:"#8C55E1",align:"center"}}),n.mDesText=n.scene.make.text({x:8*i,y:30*i,style:{color:"#ffffff",fontSize:10*i,fontFamily:p.Font.DEFULT_FONT,wordWrap:{width:180*i,useAdvancedWrap:!0}}},!1),n.add([n.mDetailBubble,n.mItemName,n.mDesText]),n.setSize(a,s),n}return d(DetailBubble,t),DetailBubble.prototype.setDetailData=function(t,e){this.mItemName.setText(t),this.mDesText.setText(e),this.resize()},DetailBubble.prototype.resize=function(t,e){void 0===t&&(t=this.width);var i=this.mDesText.height+60*this.dpr;t===this.width&&i===this.height||(this.mDetailBubble.clear(),this.mDetailBubble.fillStyle(16777215,.1),this.mDetailBubble.fillRoundedRect(0,0,t,i),this.setSize(t,i))},DetailBubble}(Phaser.GameObjects.Container),f=function(t){function ComposeItem(e,i,n,a){var s=t.call(this,e)||this;s.zoom=1,s.dpr=n,s.key=i,s.zoom=a,s.bg=s.scene.make.image({key:s.key,frame:"bprint_bg_1"}),s.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.setSize(s.bg.width,s.bg.height),s.itemIcon=new o.DynamicImage(s.scene,0,0),s.itemIcon.scale=s.dpr/s.zoom;var h=s.width,l=s.height;return s.newIcon=s.scene.make.image({key:s.key,frame:"tag_new"}),s.newIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.newIcon.setPosition(.5*-h+3*n,.5*-l+3*n),s.newText=s.scene.make.text({x:s.newIcon.x,y:s.newIcon.y,text:"N",style:{fontSize:11*s.dpr,fontFamily:p.Font.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),s.qualityIcon=s.scene.make.image({key:s.key,frame:"tag_rank_a"}),s.qualityIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.qualityIcon.setPosition(.5*-h+.5*s.qualityIcon.width-2*n,.5*l-.5*s.qualityIcon.height),s.qualityTex=s.scene.make.text({x:s.qualityIcon.x,y:s.qualityIcon.y,text:"A",style:{fontSize:11*s.dpr,fontFamily:p.Font.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),s.qualifiedIcon=s.scene.make.image({key:s.key,frame:"tag_ready"},!1),s.qualifiedIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.qualifiedIcon.setOrigin(1).setPosition(.5*h-3*n,.5*l-3*n),s.lockbg=s.scene.make.image({key:s.key,frame:"bprint_mask"}),s.lockbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.lockIcon=s.scene.make.image({key:s.key,frame:"lock"}),s.lockIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),s.add([s.bg,s.itemIcon,s.newIcon,s.newText,s.qualityIcon,s.qualityTex,s.lockbg,s.lockIcon]),s}return d(ComposeItem,t),ComposeItem.prototype.setItemData=function(t){this.itemData=t;var e=t.skill,i=e.active;this.newIcon.visible=i,this.newText.visible=i,this.qualityIcon.visible=i,this.qualityTex.visible=i,this.qualityTex.text=e.quality,this.qualifiedIcon.visible=i&&e.qualified,this.lockbg.visible=!e.active,this.lockIcon.visible=!e.active,this.setQualityTexture(e.quality),e.display&&this.setItemIcon(e.display),this.select=!1},Object.defineProperty(ComposeItem.prototype,"select",{set:function(t){t?this.bg.setFrame("bprint_bg_2"):this.bg.setFrame("bprint_bg_1")},enumerable:!1,configurable:!0}),ComposeItem.prototype.setItemIcon=function(t){var e=this,i=p.Url.getOsdRes(t.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.setPosition(0,0)}))},ComposeItem.prototype.setQualityTexture=function(t){this.qualityIcon.visible=!0,"A"===t?this.qualityIcon.setFrame("tag_rank_a"):"B"===t?this.qualityIcon.setFrame("tag_rank_b"):"C"===t?this.qualityIcon.setFrame("tag_rank_c"):this.qualityIcon.visible=!1},ComposeItem}(Phaser.GameObjects.Container),y=function(t){function ComposeMaterialItem(e,i,n){var a=t.call(this,e)||this;a.dpr=n,a.key=i;var h=a.scene.make.image({key:a.key,frame:"source_bg"});return h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.itemIcon=new o.DynamicImage(e,0,0),a.itemCount=new s.BBCodeText(a.scene,0,0,"",{}).setOrigin(.5).setFontSize(11*n).setFontFamily(p.Font.NUMBER),a.add([h,a.itemIcon,a.itemCount]),a.setSize(h.width,h.height),a.itemCount.y=.5*a.height,a}return d(ComposeMaterialItem,t),ComposeMaterialItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var i=p.Url.getOsdRes(t.texturePath);this.itemIcon.load(i,this,(function(){e.itemIcon.scale=e.dpr,e.itemIcon.setPosition(0,0)}))},ComposeMaterialItem.prototype.getCountText=function(t,e){var i=t>=e?"#ffffff":"#ff0000";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]/"+e},ComposeMaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaCreateRolePanel",(function(){return u}));var n,a=i(6),s=i(2),o=i(0),h=i(479),l=i(480),c=i(21),p=i(1),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaCreateRolePanel(e){var i=t.call(this,e)||this;return i.suitDatasMap=new Map,i.curSuitMap=new Map,i.suitItemMap=new Map,i.setTween(!1),i.scene.add.container(0,0).add(i),i.scene.scale.on("resize",i.onResize,i),i.atlasNames=[c.d.uicommon],i.textures=[{atlasName:"Create_bg_texture",folder:"texture"},{atlasName:"Create_role_bg",folder:"texture"}],i.mMediator=i.render.mainPeer[o.ModuleName.PICACREATEROLE_NAME],i.key=o.ModuleName.PICACREATEROLE_NAME,i}return d(PicaCreateRolePanel,t),PicaCreateRolePanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n},PicaCreateRolePanel.prototype.onShow=function(){this.showData&&this.showData.avatars&&this.setSuitDatas(this.showData.avatars)},PicaCreateRolePanel.prototype.onResize=function(t){this.resize(t.width,t.height)},PicaCreateRolePanel.prototype.setSuitDatas=function(t){var e=this;this.suitDatasMap.clear();for(var i=0,n=t;i<n.length;i++){var a=n[i],s=this.suitDatasMap.get(a.suitType);s||(s=[],this.suitDatasMap.set(a.suitType,s)),s.push(a)}this.suitDatasMap.forEach((function(t,i){"base"!==i&&"costume"!==i?e.suitItemMap.get(i).setSuitDatas(t):"base"===i?e.curSuitMap.set(i,t[1]):"costume"===i&&e.curSuitMap.set(i,t[0])})),this.onSkinHandler(void 0,this.skinCon.getAt(1)),this.onSixHandler(void 0,this.manButton)},PicaCreateRolePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.commonBackground=new h.CommonBackground(this.scene,0,0,e,i),this.mBottomBg=this.scene.make.image({key:"Create_bg_texture"}),this.mBottomBg.y=.5*i-.5*this.mBottomBg.height;var n=this.scene.make.image({key:"Create_role_bg"});n.y=-150*this.dpr,this.dragonbones=new h.UIDragonbonesDisplay(this.scene,this.render),this.dragonbones.scale=2.2*this.dpr,this.dragonbones.y=n.y+45*this.dpr,this.dragonbones.on("initialized",this.loadDragonbonesComplete,this);var s=new h.ButtonEventDispatcher(this.scene,0,0);s.setSize(130*this.dpr,130*this.dpr),s.enable=!0,s.on(a.ClickEvent.Tap,this.onAvatarClickHandler,this),s.y=this.dragonbones.y-65*this.dpr,this.backButton=new a.Button(this.scene,c.d.uicommon,"back_arrow"),this.backButton.x=.5*-e+.5*this.backButton.width+20*this.dpr,this.backButton.y=.5*-i+.5*this.backButton.height+23*this.dpr,this.backButton.on(a.ClickEvent.Tap,this.onBackHandler,this),this.content.add([this.commonBackground,this.mBottomBg,n,this.dragonbones,s]),this.createSixCon(),this.createSuitCon(),t.prototype.init.call(this),this.resize(0,0)},PicaCreateRolePanel.prototype.createSixCon=function(){this.sixCon=this.scene.make.container(void 0,!1),this.sixCon.y=70*this.dpr,this.manButton=new h.ToggleButton(this.scene,0,0,c.d.uicommon,"Create_gender_uncheck","Create_gender_select",this.dpr),this.manButton.on(a.ClickEvent.Tap,this.onSixHandler,this),this.manIcon=this.scene.make.image({key:c.d.uicommon,frame:"Create_gender_boy"}),this.manButton.add(this.manIcon),this.manButton.x=-60*this.dpr,this.manButton.y=-60*this.dpr,this.womanButton=new h.ToggleButton(this.scene,0,0,c.d.uicommon,"Create_gender_uncheck","Create_gender_select",this.dpr),this.womanButton.on(a.ClickEvent.Tap,this.onSixHandler,this),this.womanIcon=this.scene.make.image({key:c.d.uicommon,frame:"Create_gender_girl"}),this.womanButton.add(this.womanIcon),this.womanButton.x=-this.manButton.x,this.womanButton.y=this.manButton.y,this.nextButton=new a.NineSliceButton(this.scene,0,70*this.dpr,191*this.dpr,55*this.dpr,c.d.uicommon,"yellow_btn_normal",s.i18n.t("creatrole.next"),this.dpr,this.scale,s.UIHelper.button(this.dpr)),this.nextButton.setTextStyle(s.UIHelper.brownishStyle(this.dpr,23)),this.nextButton.on(a.ClickEvent.Tap,this.onNextHandler,this),this.sixCon.add([this.manButton,this.womanButton,this.nextButton]),this.content.add(this.sixCon)},PicaCreateRolePanel.prototype.createSuitCon=function(){var t=-40*this.dpr,e=-115*this.dpr;this.skinCon=this.scene.make.container(void 0,!1);for(var i=0;i<5;i++){var n=i+1,o="Create_complexion_"+n,h=new a.Button(this.scene,c.d.uicommon,o);h.name=n+"",h.y=t,h.x=e,h.on(a.ClickEvent.Tap,this.onSkinHandler,this),this.skinCon.add(h),e+=25*this.dpr+32*this.dpr}this.selectSkinBg=this.scene.make.image({key:c.d.uicommon,frame:"Create_complexion_select"}),this.skinCon.add(this.selectSkinBg),t+=56*this.dpr,this.suitCon=this.scene.make.container(void 0,!1);var l=["hair","eye","mouse"],p=[s.i18n.t("creatrole.hair"),s.i18n.t("creatrole.eye"),s.i18n.t("creatrole.mouth")];for(i=0;i<l.length;i++){var d=l[i],u=p[i],f=new m(this.scene,264*this.dpr,33*this.dpr,this.dpr,d,u);f.setHandler(new s.Handler(this,this.onSuitDataHandler)),f.y=t,t+=60*this.dpr,this.suitCon.add(f),this.suitItemMap.set(d,f)}this.enterButton=new a.NineSliceButton(this.scene,0,t+48*this.dpr,191*this.dpr,55*this.dpr,c.d.uicommon,"yellow_btn_normal",s.i18n.t("creatrole.gointo"),this.dpr,this.scale,s.UIHelper.button(this.dpr)),this.enterButton.setTextStyle(s.UIHelper.brownishStyle(this.dpr,23)),this.enterButton.setFontStyle("bold"),this.enterButton.on(a.ClickEvent.Tap,this.onSubmitHandler,this),this.suitCon.add([this.skinCon,this.enterButton])},PicaCreateRolePanel.prototype.onSubmitHandler=function(){var t=[];this.curSuitMap.forEach((function(e,i){t.push(e.id)})),this.mediator.submit(this.mgender,t)},PicaCreateRolePanel.prototype.onNextHandler=function(){this.suitCon.visible=!0,this.content.add(this.suitCon),this.content.remove(this.sixCon),this.content.add(this.backButton)},PicaCreateRolePanel.prototype.onAvatarClickHandler=function(){var t=["walk","run","greet01"],e={name:t[Math.floor(Math.random()*t.length)],flip:!1,times:1,playingQueue:{name:"idle",playTimes:-1}};this.dragonbones.play(e)},PicaCreateRolePanel.prototype.onSixHandler=function(t,e){this.manButton===e?(this.mgender=p.op_def.Gender.Male,this.womanButton.isOn=!1):this.womanButton===e&&(this.mgender=p.op_def.Gender.Female,this.manButton.isOn=!1),e.isOn=!0,this.setSixedSuitsData(this.mgender)},PicaCreateRolePanel.prototype.setSixedSuitsData=function(t){var e=t===p.op_def.Gender.Female?3:0,i=t===p.op_def.Gender.Female?2:0,n=t===p.op_def.Gender.Female?3:1;this.suitItemMap.get("hair").setInexed(e),this.suitItemMap.get("eye").setInexed(i),this.suitItemMap.get("mouse").setInexed(n),this.displayAvatar()},PicaCreateRolePanel.prototype.onBackHandler=function(){this.suitCon.parentContainer&&(this.suitCon.visible=!1,this.content.remove(this.suitCon)),this.content.add(this.sixCon),this.content.remove(this.backButton)},PicaCreateRolePanel.prototype.onSkinHandler=function(t,e){var i=Number(e.name)-1,n=this.suitDatasMap.get("base")[i];this.curSuitMap.set("base",n),this.selectSkinBg.x=e.x,this.selectSkinBg.y=e.y,this.displayAvatar()},PicaCreateRolePanel.prototype.onSuitDataHandler=function(t,e){this.curSuitMap.set(t,e),this.suitCon.visible&&this.displayAvatar()},PicaCreateRolePanel.prototype.displayAvatar=function(){var t=Array.from(this.curSuitMap.values()),e=this.creatAvatars(t);this.dragonbones.load({id:0,avatar:e}),this.dragonbones.startLoad()},PicaCreateRolePanel.prototype.loadDragonbonesComplete=function(){this.dragonbones.play({name:"idle",flip:!1})},PicaCreateRolePanel.prototype.creatAvatars=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var a=n[i],s={id:a.id,suit_type:a.suitType,slot:a.slot,tag:a.tag,sn:a.sn};e.push(s)}return o.AvatarSuitType.createHasBaseAvatar(e)},Object.defineProperty(PicaCreateRolePanel.prototype,"mediator",{get:function(){if(this.mMediator)return this.mMediator},enumerable:!1,configurable:!0}),PicaCreateRolePanel}(l.PicaBasePanel),m=function(t){function SelectSuitAvatarItem(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.indexed=0,h.setSize(i,n),h.dpr=a,h.tag=s,h.text=o,h.init(),h}return d(SelectSuitAvatarItem,t),SelectSuitAvatarItem.prototype.setSuitDatas=function(t){this.suitDatas=t},SelectSuitAvatarItem.prototype.setInexed=function(t){this.indexed=t,this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.setHandler=function(t){this.send=t},SelectSuitAvatarItem.prototype.init=function(){this.leftButton=new a.Button(this.scene,c.d.uicommon,"Create_arrow_left"),this.leftButton.x=.5*-this.width+.5*this.leftButton.width,this.leftButton.on(a.ClickEvent.Tap,this.onLeftButtonHandler,this),this.midBackground=this.scene.make.image({key:c.d.uicommon,frame:"Create_name_bg"}),this.nameTex=this.scene.make.text({text:"",style:s.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(.5),this.rightButton=new a.Button(this.scene,c.d.uicommon,"Create_arrow_right"),this.rightButton.x=.5*this.width-.5*this.rightButton.width,this.rightButton.on(a.ClickEvent.Tap,this.onRightButtonHandler,this),this.add([this.leftButton,this.midBackground,this.nameTex,this.rightButton])},SelectSuitAvatarItem.prototype.onLeftButtonHandler=function(){this.indexed--,-1===this.indexed&&(this.indexed=this.suitDatas.length-1),this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.onRightButtonHandler=function(){this.indexed++,this.indexed===this.suitDatas.length&&(this.indexed=0),this.updateCurrentSuitData()},SelectSuitAvatarItem.prototype.updateCurrentSuitData=function(){var t=this.suitDatas[this.indexed];this.nameTex.text=this.text+(this.indexed+1),this.send&&this.send.runWith([this.tag,t])},SelectSuitAvatarItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaDecorateControlPanel",(function(){return l}));var n,a=i(6),s=i(479),o=i(0),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaDecorateControlPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mSaving=!1,i.key=o.ModuleName.PICADECORATECONTROL_NAME,i}return h(PicaDecorateControlPanel,t),PicaDecorateControlPanel.prototype.addListen=function(){this.mInitialized&&(this.mExitBtn.on(a.ClickEvent.Tap,this.onExitHandler,this),this.mRecycleAllBtn.on(a.ClickEvent.Tap,this.onRecycleAllHandler,this),this.mRedoBtn.on(a.ClickEvent.Tap,this.onRedoHandler,this),this.mFurniBtn.on(a.ClickEvent.Tap,this.onShowFurniHandler,this),this.mSaveBtn.on(a.ClickEvent.Tap,this.onSaveHandler,this),this.mDoorBtn.on(a.ClickEvent.Tap,this.onGetDoorHandler,this))},PicaDecorateControlPanel.prototype.removeListen=function(){this.mInitialized&&(this.mExitBtn.off(a.ClickEvent.Tap,this.onExitHandler,this),this.mRecycleAllBtn.off(a.ClickEvent.Tap,this.onRecycleAllHandler,this),this.mRedoBtn.off(a.ClickEvent.Tap,this.onRedoHandler,this),this.mFurniBtn.off(a.ClickEvent.Tap,this.onShowFurniHandler,this),this.mSaveBtn.off(a.ClickEvent.Tap,this.onSaveHandler,this),this.mDoorBtn.off(a.ClickEvent.Tap,this.onGetDoorHandler,this))},PicaDecorateControlPanel.prototype.resize=function(e,i){this.setSize(e,131*this.dpr),this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,this.width,this.height),t.prototype.resize.call(this,e,i)},PicaDecorateControlPanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_control/decorate_control.png","decorate_control/decorate_control.json"),t.prototype.preload.call(this)},PicaDecorateControlPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1),this.mTopBtns=[],this.mExitBtn=new a.Button(this.scene,this.key,"exitBtn.png"),this.mRecycleAllBtn=new a.Button(this.scene,this.key,"recycleAllBtn.png"),this.mRedoBtn=new a.Button(this.scene,this.key,"redoBtn.png"),this.mFurniBtn=new a.Button(this.scene,this.key,"furniBtn.png"),this.mSaveBtn=new a.Button(this.scene,this.key,"saveBtn.png"),this.mDoorBtn=new a.Button(this.scene,this.key,"doorBtn.png"),this.mDoorBtn.setPosition(10*this.dpr+.5*this.mDoorBtn.width,83*this.dpr+.5*this.mDoorBtn.height),this.mStairBtn=new a.Button(this.scene,this.key,"stairBtn.png"),this.mStairBtn.setPosition(64*this.dpr+.5*this.mStairBtn.width,83*this.dpr+.5*this.mStairBtn.height),this.mTopBtns=[this.mExitBtn,this.mRecycleAllBtn,this.mRedoBtn,this.mFurniBtn,this.mSaveBtn],this.add(this.mBackground),this.add(this.mTopBtns),this.add([this.mDoorBtn,this.mStairBtn]);var n=this.render.uiScale,s=e-20*this.dpr*n;this.mTopBtns.map((function(t){return s-=t.width*n}));for(var o=s/(this.mTopBtns.length-1)/n,h=0;h<this.mTopBtns.length;h++)this.mTopBtns[h].x=h>0?o+.5*this.mTopBtns[h-1].width+this.mTopBtns[h-1].x+.5*this.mTopBtns[h].width:10*this.dpr+.5*this.mTopBtns[h].width,this.mTopBtns[h].y=11*this.dpr+.5*this.mTopBtns[h].height;this.resize(e,i),this.mSaving=!1,t.prototype.init.call(this)},PicaDecorateControlPanel.prototype.onExitHandler=function(){this.mSaving||(this.mSaving=!0,this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_exit"))},PicaDecorateControlPanel.prototype.onRecycleAllHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_recycleAll")},PicaDecorateControlPanel.prototype.onRedoHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_redo")},PicaDecorateControlPanel.prototype.onShowFurniHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_showFurni")},PicaDecorateControlPanel.prototype.onSaveHandler=function(){this.mSaving||(this.mSaving=!0,this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_save"))},PicaDecorateControlPanel.prototype.onGetDoorHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_getDoor")},PicaDecorateControlPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEffectMgrPanel",(function(){return c}));var n,a=i(21),s=i(0),o=i(480),h=i(511),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaEffectMgrPanel(e){var i=t.call(this,e)||this;return i.tempQueue=new Map,i.key=s.ModuleName.PICAEFFECTMGR_NAME,i.atlasNames=[a.d.effectcommon],i}return l(PicaEffectMgrPanel,t),PicaEffectMgrPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;this.content.x=n/2,this.content.y=a/2,t.prototype.resize.call(this,n,a),this.setSize(n,a)},PicaEffectMgrPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.furniEffectPanel=new h.PicaFurniUnlockEffectPanel(this.scene,this.render,e,i,this.key,this.dpr),this.content.add(this.furniEffectPanel),this.resize(0,0),t.prototype.init.call(this)},PicaEffectMgrPanel.prototype.play=function(t,e){if(this.mInitialized)"unlock"===e&&this.furniEffectPanel.play(t);else{var i=this.tempQueue.get(e);i=i?i.concat(t):t,this.tempQueue.set(e,i)}},PicaEffectMgrPanel.prototype.onShow=function(){var t=this;this.tempQueue.size>0&&this.tempQueue.forEach((function(e,i){t.play(e,i)}))},PicaEffectMgrPanel}(o.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaElementStoragePanel",(function(){return p}));var n,a=i(626),s=i(6),o=i(479),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaElementStoragePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mExpaned=!0,i.mItemNum=32,i.key=h.ModuleName.PICAELEMENTSTORAGE_NAME,i.setTween(!1),i.dpr/=2,i}return c(PicaElementStoragePanel,t),PicaElementStoragePanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&this.setPackageNum(1)},PicaElementStoragePanel.prototype.resize=function(t){var e=this.render.getSize();if(this.scale=this.dpr,this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){this.setSize(341,450),this.x=e.width-this.width*this.dpr-10,this.y=e.height-this.height*this.dpr>>1,this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(327,423),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=145,this.mSearchInput.y=40,this.mDragBtn.x=-this.mDragBtn.height,this.mDragBtn.y=this.height>>1;for(var i=this.mProps.length,n=0;n<i;n++)this.mProps[n].x=n%4*60+20,this.mProps[n].y=60*Math.floor(n/4)+80}else{this.setSize(510,329),this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(496,303),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=270,this.mSearchInput.y=33,this.x=e.width-this.width*this.dpr>>1,this.y=e.height-this.height*this.dpr-10,this.mDragBtn.x=this.width>>1,this.mDragBtn.y=-this.mDragBtn.height>>1;for(i=this.mProps.length,n=0;n<i;n++)this.mProps[n].x=n%8*60+20,this.mProps[n].y=60*Math.floor(n/8)+80}this.mPrePageBtn.y=this.height>>1,this.mNextPageBtn.x=this.width,this.mNextPageBtn.y=this.height>>1,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,this.width,this.height),Phaser.Geom.Rectangle.Contains)},PicaElementStoragePanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mBackground&&this.mBackground.on("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.on("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.on("dragstart",this.onDragStartHandler,this),this.scene.input.on("dragend",this.onDragEndHandler,this),this.scene.input.on("drag",this.onDragHandler,this))},PicaElementStoragePanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mBackground&&this.mBackground.off("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.off("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.off("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.off("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this))},PicaElementStoragePanel.prototype.setProps=function(t){var e=t.items;this.clearItem();for(var i=0;i<e.length;i++){if(i>=this.mProps.length)return;this.mProps[i].setProp(e[i])}},PicaElementStoragePanel.prototype.expand=function(){if(!this.mExpaned){var t=this.render.getSize(),e=null;e=this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width-this.width*this.dpr-10}:{y:t.height-this.height*this.dpr-10},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:e}),this.remove(this.mDragBtn),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!0}},PicaElementStoragePanel.prototype.collapse=function(){if(this.mExpaned){var t=this.render.getSize(),e=null;e=this.render.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width}:{y:t.height},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:e}),this.addAt(this.mDragBtn,0),this.remove([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!1}},PicaElementStoragePanel.prototype.destroy=function(){this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this)),t.prototype.destroy.call(this)},PicaElementStoragePanel.prototype.preload=function(){this.scene.load.image(l.Border.getName(),l.Border.getPNG()),this.scene.load.image("button",l.Url.getRes("ui/common/button.png")),this.scene.load.image("prop_background",l.Url.getRes("ui/common/prop_background.png")),this.scene.load.atlas("slip",l.Url.getRes("ui/bag/slip.png"),l.Url.getRes("ui/bag/slip.json")),this.mScene.load.atlas("clsBtn",l.Url.getRes("ui/common/common_clsBtn.png"),l.Url.getRes("ui/common/common_clsBtn.json")),this.scene.load.image(l.Background.getName(),l.Background.getPNG()),t.prototype.preload.call(this)},PicaElementStoragePanel.prototype.init=function(){this.mBackground=new o.NinePatch(this.scene,0,0,this.width,this.height,l.Background.getName(),null,l.Background.getConfig()),this.mBorder=new o.NinePatch(this.scene,7,19,327,423,l.Border.getName(),null,l.Border.getConfig()),this.mSearchInput=new s.InputText(this.scene,145,40,210,26,{type:"input",fontSize:"14px",color:"#808080",placeholder:"输入关键词进行搜索"});this.mDragBtn=new s.NineSliceButton(this.scene,0,-20,80,40,"button","","物件容器",this.dpr,this.scale,{left:4,top:4,right:4,bottom:4}),this.mPrePageBtn=this.scene.make.sprite({key:"slip"},!1),this.mPrePageBtn.setInteractive(),this.mNextPageBtn=this.scene.make.sprite({key:"slip"},!1).setFlipX(!0),this.mNextPageBtn.setInteractive(),this.mProps=[],this.add([this.mBackground,this.mBorder,this.mSearchInput]);for(var e=0;e<this.mItemNum;e++){var i=new a.Item(this.scene);this.mProps[e]=i}this.add(this.mProps),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mCloseBtn=this.scene.make.image({key:"clsBtn",frame:"btn_normal"},!1).setInteractive().setScale(2),this.add(this.mCloseBtn),t.prototype.init.call(this),this.resize(),this.expand()},PicaElementStoragePanel.prototype.onPrePageHandler=function(){this.setPackageNum(this.mPacgeNum-1)},PicaElementStoragePanel.prototype.onNextPageHandler=function(){this.setPackageNum(this.mPacgeNum+1)},PicaElementStoragePanel.prototype.setPackageNum=function(t){this.mPacgeNum=t<1?1:t,this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_queryElement",{page:this.mPacgeNum,perPage:32})},PicaElementStoragePanel.prototype.switchExpand=function(){this.mExpaned?this.collapse():this.expand()},PicaElementStoragePanel.prototype.onSelectedHandler=function(){},PicaElementStoragePanel.prototype.onClick=function(t){},PicaElementStoragePanel.prototype.onDragStartHandler=function(t,e,i,n){var s=e.parentContainer;s instanceof a.Item&&(this.mDragData=s.prop),this.mDragImage||(this.mDragImage=this.scene.make.image(void 0,!1),this.add(this.mDragImage)),this.mDragImage.x=s.x,this.mDragImage.y=s.y,this.mDragImage.setTexture(e.texture.key),this.mDragging=!0},PicaElementStoragePanel.prototype.onDragEndHandler=function(){this.mDragImage&&(this.mDragImage.setTexture(void 0),this.mDragging=!1)},PicaElementStoragePanel.prototype.onDragHandler=function(t,e,i,n){this.mDragImage&&(this.mDragImage.x+=t.x-t.prevPosition.x,this.mDragImage.y+=t.y-t.prevPosition.y)},PicaElementStoragePanel.prototype.onPointerOutHandler=function(){this.mDragImage&&this.mDragging&&(this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_selectedElement",this.mDragData),this.mDragImage.setTexture(void 0),this.mDragging=!1)},PicaElementStoragePanel.prototype.clearItem=function(){this.mProps&&this.mProps.map((function(t){return t.clear()}))},PicaElementStoragePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_hide")},PicaElementStoragePanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaElevatorPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaElevatorPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAELEVATOR_NAME,i}return c(PicaElevatorPanel,t),PicaElevatorPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,a),this.content.x=.5*n,this.content.y=.5*a,this.mGameGrid.resetMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains)},PicaElevatorPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setElevtorDataList(this.mShowData[0])):this.preload())},PicaElevatorPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaElevatorPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaElevatorPanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},PicaElevatorPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=405*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new a.NineSlicePatch(this.scene,0,0,i,n,o.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr}),this.content.add(this.bg),this.closeBtn=new a.Button(this.scene,o.c.commonKey,"close","close"),this.closeBtn.setPosition(.5*this.bg.width-5*this.dpr,.5*-this.bg.height+5*this.dpr),this.content.add(this.closeBtn);var s={x:0,y:0,table:{width:i-20*this.dpr,height:n-30*this.dpr,columns:1,cellWidth:i-20*this.dpr,cellHeight:85*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=e.mGameGrid.items.length-t.index,a=t.item;return null===i&&(i=new d(e.scene,e.key,e.dpr)),i.setFloorData(a,n),i}};this.mGameGrid=new a.GameGridTable(this.scene,s),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",(function(t){e.onSelectItemHandler(t.floorData)})),this.content.add(this.mGameGrid),this.resize(),t.prototype.init.call(this)},PicaElevatorPanel.prototype.setElevtorDataList=function(t){var e=t.button.reverse();this.mGameGrid.setItems(e),this.mGameGrid.setT(1)},PicaElevatorPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaElevatorPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(h.RENDER_PEER+this.key+"_hide")},PicaElevatorPanel.prototype.onSendHandler=function(){},PicaElevatorPanel.prototype.onSelectItemHandler=function(t){var e=this.showData[0];t.text.split("#")[1];this.render.renderEmitter(h.RENDER_PEER+this.key+"_queryui",{uiId:e.id,componentId:t.node.id})},PicaElevatorPanel}(s.BasePanel),d=function(t){function ElevatorItem(e,i,n){var h=t.call(this,e)||this;return h.key=i,h.dpr=n,h.bg=new s.DynamicImage(e,0,0),h.add(h.bg),h.setSize(268*n,81*n),h.namebg=new a.NineSlicePatch(h.scene,0,0,82*n,22*n,o.c.common2Key,"floor_title_bg",{left:15*h.dpr,top:0*h.dpr,right:15*h.dpr,bottom:0*h.dpr},void 0,void 0,0),h.namebg.x=.5*h.width-.5*h.namebg.width-10*n,h.namebg.y=.5*-h.height+.5*h.namebg.height+10*n,h.add(h.namebg),h.nameTex=h.scene.make.text({x:h.namebg.x,y:h.namebg.y,text:"",style:{color:"#22E2FF",fontFamily:l.Font.DEFULT_FONT,fontSize:12*h.dpr}}).setOrigin(.5),h.add(h.nameTex),h.levelbg=h.scene.make.image({key:o.c.common2Key,frame:"floor_number_unlock"}),h.levelbg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),h.levelbg.x=.5*-h.width+.5*h.levelbg.width+5*n,h.levelbg.y=.5*h.height-.5*h.levelbg.height-5*n,h.add(h.levelbg),h.levelTex=h.scene.make.text({x:h.levelbg.x,y:h.levelbg.y,text:"",style:{color:"#FAD555",fontFamily:l.Font.NUMBER,fontSize:17*h.dpr}}).setOrigin(.5),h.add(h.levelTex),h}return c(ElevatorItem,t),ElevatorItem.prototype.setFloorData=function(t,e){this.floorData=t;var i=t.text.split("#");"false"!==i[1]?(this.levelbg.setFrame("floor_number_unlock"),this.levelTex.setColor("#FAD555"),this.nameTex.setColor("#22E2FF")):(this.levelbg.setFrame("floor_number_lock"),this.levelTex.setColor("#BDBDBD"),this.nameTex.setColor("#DDDDDD")),this.levelTex.text=e+l.i18n.t("picelevator.floor"),this.nameTex.text=i[0];var n=t.tips.lastIndexOf("/"),a=t.tips.slice(n+1,t.tips.length),s=t.tips.slice(0,n+1),o=l.Url.getOsdRes(s+a+"_"+this.dpr+"x.png");this.bg.load(o,this,(function(){}))},ElevatorItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaEquipUpgradePanel",(function(){return d}));var n,a=i(479),s=i(6),o=i(0),h=i(21),l=i(2),c=i(512),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaEquipUpgradePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.commonkey="common_key",i.equipItems=[],i.key=o.ModuleName.PICAEQUIPUPGRADE_NAME,i}return p(PicaEquipUpgradePanel,t),PicaEquipUpgradePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.bg.x=n/2,this.bg.y=a/2,this.tilteName.x=this.bg.x,this.tilteName.y=this.bg.y-this.bg.height/2,this.titlebg.x=this.bg.x,this.titlebg.y=this.bg.y-this.bg.height/2,this.closeBtn.x=this.bg.x+this.bg.width/2-10*this.dpr,this.closeBtn.y=this.bg.y-this.bg.height/2+10*this.dpr,this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,n,a),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName])},PicaEquipUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.refreshData(),this.addListen()):this.preload())},PicaEquipUpgradePanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaEquipUpgradePanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaEquipUpgradePanel.prototype.preload=function(){this.commonkey=h.c.commonKey,this.addAtlas(this.key,"equip_upgrade/mine_eqpm.png","equip_upgrade/mine_eqpm.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaEquipUpgradePanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.blackBg=this.scene.make.graphics(void 0,!1),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(0,0,e,i),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,this.scene.cameras.main.width,this.scene.cameras.main.height),Phaser.Geom.Rectangle.Contains),this.bg=new s.NinePatch(this.scene,0,0,300*this.dpr,300*this.dpr,this.commonkey,"bg",void 0,void 0,{left:40,top:40,bottom:40,right:40});var n=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:n,key:this.key,frame:"titlebg"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.tilteName=this.scene.make.text({x:0,y:n,text:l.i18n.t("equipupgrade.title"),style:{color:"#8F4300",fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,0),this.tilteName.setFontStyle("bold"),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:n+5*this.dpr,key:this.commonkey,frame:"close"}),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.tilteName.setStroke("#8F4300",1),this.closeBtn.setInteractive(),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this)},PicaEquipUpgradePanel.prototype.setEquipDatas=function(t){if(this.content=t,this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight,n=t.mineEquipments,a=175*this.dpr*n.length-(n.length>=2?40*(n.length-2):0),s=155*this.dpr;this.resetPosition(this.bg.width,a);for(var o=.5*-a+100*this.dpr,h=0,l=0,p=n;l<p.length;l++){var d=p[l];d.isblue=h%2!=0;var u=new c.PicaEquipUpgradeItem(this.scene,this,this.dpr,this.scale,this.key,this.commonkey);u.on("reqActive",this.onReqActiveEquipment,this),u.on("reqEquiped",this.onReqEquipedEquipment,this),u.setEquipItems(d),u.setTransPosition(e/2,o+i/2),this.equipItems.push(u),o+=s,h++}this.resize(e,i)}},PicaEquipUpgradePanel.prototype.setActiveEquipment=function(t){for(var e=0,i=0,n=this.content.mineEquipments;i<n.length;i++){for(var a=n[i],s=this.equipItems[e],o=-1,h=0;h<a.mineEquipments.length;h++){var l=a.mineEquipments[h];l.id===t.id?(a.mineEquipments[h]=t,s.refreshEquipData(t,h),o=h):l.selected&&(l.selected=!1)}o>=0&&s.refreshEquipData(t,o),e++}},PicaEquipUpgradePanel.prototype.destroy=function(){if(this.equipItems){for(var e=0,i=this.equipItems;e<i.length;e++){i[e].destroy()}this.equipItems.length=0}this.equipItems=null,this.content=null,t.prototype.destroy.call(this)},PicaEquipUpgradePanel.prototype.getEuipDatas=function(){for(var t=[],e=0;e<3;e++){var i={};i.name=0===e?"矿镐":"矿车",i.items=[],i.isblue=!(e%2==0);for(var n=0;n<15;n++){var a={};a.name="矿镐"+n,a.penetration=10+n,a.des="describle",a.cost=100*n,a.unlock=!1,i.items.push(a)}t.push(i)}return t},PicaEquipUpgradePanel.prototype.refreshData=function(){var t=this.getData("upgradeData");t&&this.setEquipDatas(t)},PicaEquipUpgradePanel.prototype.resetPosition=function(t,e){this.bg.resize(t,e);var i=.5*-e;this.titlebg.setPosition(0,i),this.tilteName.setPosition(0,i),this.closeBtn.setPosition(.5*t-8*this.dpr,i+8*this.dpr)},PicaEquipUpgradePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_hide")},PicaEquipUpgradePanel.prototype.onReqActiveEquipment=function(t){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_reqActive",t)},PicaEquipUpgradePanel.prototype.onReqEquipedEquipment=function(t){this.render.renderEmitter(o.ModuleName.PICAEQUIPUPGRADE_NAME+"_reqEquiped",t)},PicaEquipUpgradePanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreListPanel",(function(){return y}));var n,a=i(479),s=i(6),o=i(0),h=i(21),l=i(2),c=i(480),p=i(514),d=i(481),u=i(513),m=i(515),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),y=function(t){function PicaExploreListPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[h.d.explorelog,h.d.uicommon1,h.d.uicommon],i.textures=[{atlasName:"explore_bg_stripe_top",folder:h.d.explorelog},{atlasName:"explore_bg_stripe_middle",folder:h.d.explorelog},{atlasName:"explore_mask",folder:h.d.explorelog}],i.key=o.ModuleName.PICAEXPLORELIST_NAME,i}return f(PicaExploreListPanel,t),PicaExploreListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.bg.x=.5*n,this.bg.y=.5*a,this.topbg.y=.5*this.topbg.height,this.topbg.x=.5*n,this.midbg.y=this.topbg.y+.5*this.midbg.height,this.midbg.x=this.topbg.x,this.mBackBtn.x=.5*this.mBackBtn.width+8*this.dpr,this.mBackBtn.y=.5*this.mBackBtn.height+12*this.dpr,this.energyProgress.x=n-.5*this.energyProgress.width-17*this.dpr,this.energyProgress.y=this.mBackBtn.y;var s=63*this.dpr,o=56*this.dpr,h=a-s-o;this.levelPanel.x=.5*n,this.levelPanel.y=s+.5*h,this.levelPanel.setTopAndBottomHeight(s,o),this.levelPanel.resize(n,h),this.bottomPanel.x=.5*n,this.bottomPanel.y=a-.5*this.bottomPanel.height,this.bottomPanel.resize(n,57*this.dpr)},PicaExploreListPanel.prototype.addListen=function(){this.mInitialized&&this.mBackBtn.on(s.ClickEvent.Tap,this.onBackHandler,this)},PicaExploreListPanel.prototype.removeListen=function(){this.mInitialized&&this.mBackBtn.off(s.ClickEvent.Tap,this.onBackHandler,this)},PicaExploreListPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=63*this.dpr,s=56*this.dpr;this.setSize(e,i),this.bg=new a.CommonBackground(this.scene,0,0,e,i,h.d.explorelog,"explore_bg",16183516),this.topbg=this.scene.make.image({key:"explore_bg_stripe_top"}),this.midbg=this.scene.make.image({key:"explore_bg_stripe_middle"}),this.mBackBtn=new d.BackTextButton(this.scene,this.dpr),this.mBackBtn.setText(l.i18n.t("explore.title")),this.energyProgress=new d.EnergyProgressBar(this.scene,this.dpr);var o=i-n-s;this.levelPanel=new m.PicaExploreListLevelPanel(this.scene,this.width,o,this.dpr,this.scale),this.levelPanel.setHandler(new l.Handler(this,this.onLevelPanelHandler)),this.bottomPanel=new u.PicaExploreListBottomPanel(this.scene,this.width,57*this.dpr,this.dpr,this.scale),this.bottomPanel.setHandler(new l.Handler(this,this.onBottomPanelHandler)),this.add([this.bg,this.topbg,this.midbg,this.levelPanel,this.mBackBtn,this.energyProgress,this.bottomPanel]),this.resize(e,i),t.prototype.init.call(this)},PicaExploreListPanel.prototype.onShow=function(){this.mShowData&&this.setExploreChapters(this.mShowData),this.tempDatas&&this.setEnergyData(this.tempDatas.value,this.tempDatas.max)},PicaExploreListPanel.prototype.setExploreChapterResult=function(t){var e=this.mShowData.nextLevelId;this.levelPanel.setCaptoreResult(t,e)},PicaExploreListPanel.prototype.setExploreChapters=function(t){this.mShowData=t,this.mInitialized&&this.bottomPanel.setChapterDatas(t)},PicaExploreListPanel.prototype.setEnergyData=function(t,e){this.tempDatas={value:t,max:e},this.mInitialized&&this.energyProgress.setEnergyData(t,e)},PicaExploreListPanel.prototype.openDetialPanel=function(){var t=this.width,e=this.height;this.detialPanel||(this.detialPanel=new p.PicaExploreListDetailPanel(this.scene,t,e,this.dpr,this.scale),this.detialPanel.setHandler(new l.Handler(this,this.onDetialHandler)),this.detialPanel.y=-20*this.dpr),this.add(this.detialPanel),this.detialPanel.visible=!0,this.detialPanel.x=.5*t,this.detialPanel.y=.5*e,this.detialPanel.resize(t,e)},PicaExploreListPanel.prototype.hideDetailPanel=function(){this.detialPanel.visible=!1},PicaExploreListPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaExploreListPanel.prototype.onBackHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_hide")},PicaExploreListPanel.prototype.onDetialHandler=function(t,e){"hide"===t&&this.hideDetailPanel()},PicaExploreListPanel.prototype.onLevelPanelHandler=function(t,e){"foreword"===t?(this.openDetialPanel(),this.detialPanel.setCaptoreResultData(e)):"roomid"===t?this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_queyenterroom",e):"move"===t&&(e?(this.topbg.visible=!1,this.midbg.visible=!1):(this.topbg.visible=!0,this.midbg.visible=!0))},PicaExploreListPanel.prototype.onBottomPanelHandler=function(t,e){"chapterdata"===t&&this.render.renderEmitter(o.ModuleName.PICAEXPLORELIST_NAME+"_queyexplorechapter",e)},PicaExploreListPanel}(c.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaExploreLogPanel",(function(){return u}));var n,a=i(479),s=i(6),o=i(0),h=i(21),l=i(2),c=i(480),p=i(516),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaExploreLogPanel(e){var i=t.call(this,e)||this;return i.atlasNames=[h.d.explorelog,h.d.uicommon1],i.key=o.ModuleName.PICAEXPLORELOG_NAME,i}return d(PicaExploreLogPanel,t),PicaExploreLogPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.goOutBtn.x=n-.5*this.goOutBtn.width-10*this.dpr,this.goOutBtn.y=.5*this.goOutBtn.height+10*this.dpr,this.continueProgress.x=.5*n,this.continueProgress.y=.5*-this.continueProgress.height,this.continueText.x=this.continueProgress.x+.5*this.continueProgress.width+5*this.dpr,this.continueText.y=this.continueProgress.y,this.expProgress.x=n-.5*this.expProgress.width-40*this.dpr,this.expProgress.y=a-240*this.dpr,this.textCon.y=this.expProgress.y+55*this.dpr,this.textCon.x=.5*n,this.expProgress.refreshMask(),this.textCon.refreshMask()},PicaExploreLogPanel.prototype.addListen=function(){this.mInitialized&&this.goOutBtn.on(s.ClickEvent.Tap,this.onGoOutHandler,this)},PicaExploreLogPanel.prototype.removeListen=function(){this.mInitialized&&this.goOutBtn.off(s.ClickEvent.Tap,this.onGoOutHandler,this)},PicaExploreLogPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.setSize(e,i),this.goOutBtn=new s.Button(this.scene,h.d.explorelog,"checkpoint_abort"),this.expProgress=new m(this.scene,this.dpr,this.scale),this.expProgress.setHandler(new l.Handler(this,this.onProClickHandler)),this.continueProgress=new a.ProgressMaskBar(this.scene,h.d.explorelog,"checkpoint_progress bar_bottom","checkpoint_progress bar_top"),this.continueProgress.visible=!1,this.continueText=this.scene.make.text({style:l.UIHelper.yellowStyle(this.dpr,24)}).setOrigin(0,.5),this.continueText.setFontStyle("bold italic"),this.textCon=new f(this.scene,e,138*this.dpr,this.dpr,this.scale),this.add([this.goOutBtn,this.expProgress,this.continueProgress,this.continueText,this.textCon]),this.resize(e,i),t.prototype.init.call(this),this.setTimeProgress(3e4)},PicaExploreLogPanel.prototype.setExploreDatas=function(t){this.textCon.setTextTips(t)},PicaExploreLogPanel.prototype.setExploreCountDown=function(t){var e=this;if(this.continueProgress.setProgress(100,100),this.continueText.text="x"+t.combo,this.continueProgress.visible)this.playRotateTween(0,100,1e3*t.seconds),this.continueText.scale=.1,this.continueText.alpha=1,l.UIHelper.playScaleTween(this.scene,this.continueText,.1,1,200,"Linear",void 0);else{this.continueProgress.visible=!0;var i=.5*this.continueProgress.height+20*this.dpr;this.continueText.scale=.01,l.UIHelper.playtPosYTween(this.scene,this.continueProgress,0,i,300,"Bounce.easeOut",void 0,new l.Handler(this,(function(){e.scene&&(e.playRotateTween(0,100,1e3*t.seconds),e.continueText.alpha=1,l.UIHelper.playScaleTween(e.scene,e.continueText,.1,1,200,"Back.easeInOut",void 0))})),new l.Handler(this,(function(){e.scene&&(e.continueProgress.refreshMask(),e.continueText.y=e.continueProgress.y)})))}},PicaExploreLogPanel.prototype.setExploreSettleDatas=function(t){this.openSettlePanel(),this.settlePanel.setSettleData(t),this.clearRotateTween()},PicaExploreLogPanel.prototype.setTimeProgress=function(t){var e=this;this.expProgress.setProgress(0),this.clearTimer();var i=0;this.timer=setInterval((function(){var n=i/t;i+=20,e.expProgress.setProgress(n),n>=1&&e.clearTimer()}),20)},PicaExploreLogPanel.prototype.openSettlePanel=function(){var t=this.width,e=this.height;this.settlePanel||(this.settlePanel=new p.PicaExploreLogSettlePanel(this.scene,t,e,this.dpr,this.scale),this.settlePanel.setHandler(new l.Handler(this,this.onSettleHandler)),this.settlePanel.y=-20*this.dpr),this.add(this.settlePanel),this.settlePanel.x=.5*t,this.settlePanel.y=.5*e,this.settlePanel.resize(t,e)},PicaExploreLogPanel.prototype.hideSettlePanel=function(){this.settlePanel.visible=!1},PicaExploreLogPanel.prototype.setTipsLayout=function(t){var e=t?this.scaleHeight-360*this.dpr:this.scaleHeight-240*this.dpr;this.expProgress.y=e,this.textCon.y=this.expProgress.y+55*this.dpr,this.expProgress.refreshMask(),this.textCon.refreshMask()},PicaExploreLogPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.clearTimer()},PicaExploreLogPanel.prototype.onProClickHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_queryexplorehint"),this.setTimeProgress(3e4)},PicaExploreLogPanel.prototype.onGoOutHandler=function(){var t=this;l.UIHelper.createMessageBox(this.render,this,this.key,l.i18n.t("explore.exit"),l.i18n.t("explore.exittips"),(function(){t.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_querygohome")}))},PicaExploreLogPanel.prototype.onSettleHandler=function(){this.render.renderEmitter(o.ModuleName.PICAEXPLORELOG_NAME+"_showexplorelist"),this.hideSettlePanel()},PicaExploreLogPanel.prototype.clearTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},PicaExploreLogPanel.prototype.playRotateTween=function(t,e,i){var n=this;this.scene&&(this.clearRotateTween(),this.rotateTween=this.scene.tweens.addCounter({from:t,to:e,ease:"Linear",duration:i,onUpdate:function(t,i){n.scene||(n.rotateTween.stop(),n.rotateTween.remove()),n.continueProgress.setProgress(e-i.value,e),i.value===e&&l.UIHelper.playAlphaTween(n.scene,n.continueProgress,1,0,500,"Linear",void 0,new l.Handler(n,(function(){n.scene&&(n.continueProgress.visible=!1,n.continueProgress.y=.5*-n.continueProgress.height,n.continueProgress.alpha=1)})),new l.Handler(n,(function(t){n.continueText.alpha=t})))},onComplete:function(){n.clearRotateTween()}}))},PicaExploreLogPanel.prototype.clearRotateTween=function(){this.rotateTween&&(this.rotateTween.stop(),this.rotateTween.remove(),this.rotateTween=void 0)},PicaExploreLogPanel}(c.PicaBasePanel),m=function(t){function ExploreTimeProgress(e,i,n){var a=t.call(this,e,0,0,!1)||this;return a.proValue=0,a.dpr=i,a.zoom=n,a.init(),a.enable=!0,a}return d(ExploreTimeProgress,t),ExploreTimeProgress.prototype.setProgress=function(t){var e=360*t-90;this.barmask.clear(),this.barmask.fillStyle(16777215),this.barmask.slice(0,0,43*this.dpr/this.zoom,Phaser.Math.DegToRad(-90),Phaser.Math.DegToRad(e),!1),this.barmask.fillPath(),t>=1?this.lightIcon.setFrame("checkpoint_prompt_icon_light"):this.lightIcon.setFrame("checkpoint_prompt_icon_gray"),this.proValue=t},ExploreTimeProgress.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.barmask.setPosition(t.tx,t.ty)},ExploreTimeProgress.prototype.destroy=function(){t.prototype.destroy.call(this),this.barmask.destroy()},ExploreTimeProgress.prototype.setHandler=function(t){this.send=t},ExploreTimeProgress.prototype.init=function(){this.bg=this.scene.make.image({key:h.d.explorelog,frame:"checkpoint_prompt_bottom"}),this.lightbg=this.scene.make.image({key:h.d.explorelog,frame:"checkpoint_prompt_schedule"}),this.topbg=this.scene.make.image({key:h.d.explorelog,frame:"checkpoint_prompt_top"}),this.lightIcon=this.scene.make.image({key:h.d.explorelog,frame:"checkpoint_prompt_icon_gray"}),this.barmask=this.scene.make.graphics(void 0,!1),this.lightbg.mask=this.barmask.createGeometryMask(),this.add([this.bg,this.lightbg,this.topbg,this.lightIcon]),this.setSize(this.bg.width,this.bg.height),this.on(s.ClickEvent.Tap,this.onClickHandler,this)},ExploreTimeProgress.prototype.onClickHandler=function(){this.send&&this.proValue>=1&&this.send.run()},ExploreTimeProgress}(a.ButtonEventDispatcher),f=function(t){function ExploreTipsTextsCon(e,i,n,a,s){var o=t.call(this,e)||this;return o.tipsItems=[],o.tweens=[],o.texts=[],o.dpr=a,o.zoom=s,o.setSize(i,n),o.maskGrap=o.scene.make.graphics(void 0,!1),o.maskGrap.clear(),o.maskGrap.fillStyle(0,1),o.maskGrap.fillRect(.5*-i*s,.5*-n*s,i*s,n*s),o.mask=o.maskGrap.createGeometryMask(),o}return d(ExploreTipsTextsCon,t),ExploreTipsTextsCon.prototype.refreshMask=function(){var t=this.getWorldTransformMatrix();this.maskGrap.setPosition(t.tx,t.ty)},ExploreTipsTextsCon.prototype.setTextTips=function(t){for(var e=107*this.dpr,i=25*this.dpr,n=.5*-this.width+.5*e+7*this.dpr,a=0===this.tipsItems.length,o=0;o<t.length;o++){var c=t[o];if(this.texts[o]!==c&&""!==c){var p=new s.NineSliceButton(this.scene,0,0,e,i,h.d.explorelog,"checkpoint_aims_bg",c,this.dpr,this.scale,{left:10*this.dpr,right:10*this.dpr,top:0*this.dpr,bottom:0*this.dpr});p.setTextStyle(l.UIHelper.colorStyle("#FFEE5D",11*this.dpr)),p.x=n;var d=this.tipsItems[o];a||this.replaceAnimation(p,d),this.add(p),this.tipsItems[o]=p}else if(""===c){d=this.tipsItems[o];a||this.replaceAnimation(void 0,d)}n+=e+12*this.dpr,this.texts[o]=c}a&&this.firstAnimation()},ExploreTipsTextsCon.prototype.firstAnimation=function(){for(var t=0,e=0,i=this.tipsItems;e<i.length;e++){var n=i[e];n.y=.5*this.height,this.playtPosYTween(n,.5*this.height,0,600,void 0,t),t+=50}},ExploreTipsTextsCon.prototype.replaceAnimation=function(t,e){e&&(e.y=0,this.playtPosYTween(e,0,.5*-this.height,600*this.dpr,new l.Handler(this,(function(){e.destroy()}))),this.playAlphaTween(e,1,0,500)),t&&(t.y=.5*this.height,this.playtPosYTween(t,.5*this.height,0,600))},ExploreTipsTextsCon.prototype.playtPosYTween=function(t,e,i,n,a,s){var o=this;if(void 0===n&&(n=500),this.scene){var h=this.scene.tweens.add({targets:t,y:{from:e,to:i},ease:"Bounce.easeOut",duration:n,delay:s,onComplete:function(){h.stop(),h.remove(),o.removeTween(h),a&&a.run()}});this.tweens.push(h)}},ExploreTipsTextsCon.prototype.playAlphaTween=function(t,e,i,n,a,s){var o=this;if(void 0===n&&(n=500),this.scene){var h=this.scene.tweens.add({targets:t,alpha:{from:e,to:i},ease:"Linear",duration:n,delay:s,onComplete:function(){h.stop(),h.remove(),o.removeTween(h),a&&a.runWith(i)}});this.tweens.push(h)}},ExploreTipsTextsCon.prototype.removeTween=function(t){var e=this.tweens.indexOf(t);-1!==e&&this.tweens.splice(e,1)},ExploreTipsTextsCon}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFriendPanel",(function(){return d}));var n,a=i(6),s=i(479),o=i(0),h=i(21),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=Phaser.GameObjects.Container,d=function(t){function PicaFriendPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=o.ModuleName.PICAFRIEND_NAME,i.mSubContanerMap=new Map,i.mSubContanerMap.set(o.FriendChannel.Blacklist,T),i.mSubContanerMap.set(o.FriendChannel.Search,b),i.mSubContanerMap.set(o.FriendChannel.Notice,x),i}return c(PicaFriendPanel,t),PicaFriendPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a),this.content.setPosition(n/2,a/2),this.friendContainer.parentContainer&&this.friendContainer.resize()},PicaFriendPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.friendContainer.setChannel(o.FriendChannel.Friends)):this.preload())},PicaFriendPanel.prototype.hide=function(){t.prototype.hide.call(this)},PicaFriendPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(a.ClickEvent.Tap,this.OnClosePanel,this),this.friendContainer.register(),this.friendContainer.on("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.on(o.EventType.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.on(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.on(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.on(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this))},PicaFriendPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(a.ClickEvent.Tap,this.OnClosePanel,this),this.friendContainer.off("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.off(o.EventType.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.off(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.off(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.off(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.friendContainer.unregister())},PicaFriendPanel.prototype.setFriend=function(t,e){this.mSubContanerMap.get(t)?this.mShowingSubContainer&&this.mShowingSubContainer.setItems(e):this.friendContainer&&this.friendContainer.setFriends(t,e)},PicaFriendPanel.prototype.updateFriend=function(t){this.mShowingSubContainer?this.mShowingSubContainer.updateFriends(t):this.friendContainer.updateFriends(t)},PicaFriendPanel.prototype.updateRelation=function(t){this.mShowingSubContainer&&this.mShowingSubContainer instanceof b&&this.mShowingSubContainer.updateRelation(t)},PicaFriendPanel.prototype.filterById=function(t){this.mShowingSubContainer?this.mShowingSubContainer.filterById(t):this.friendContainer&&this.friendContainer.filterById(t)},PicaFriendPanel.prototype.fetchCurrentFriend=function(){this.friendContainer&&this.friendContainer.fetchCurrentFriend()},PicaFriendPanel.prototype.preload=function(){this.addAtlas(this.key,"friend_list/friend_list.png","friend_list/friend_list.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaFriendPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,.5),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"phone"}),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.content.add(this.bg),this.closeBtn=new a.Button(this.scene,h.c.commonKey,"close"),this.closeBtn.setPosition(.5*this.content.width-30*this.dpr,.5*(-this.bg.height+this.closeBtn.height)+25*this.dpr),this.friendContainer=new m(this.render.uiManager,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.content.add([this.friendContainer,this.closeBtn]),this.add([this.mBackGround,this.content]),this.resize(i,n),t.prototype.init.call(this)},PicaFriendPanel.prototype.destroy=function(){this.friendContainer&&this.friendContainer.destroy(),this.mShowingSubContainer&&this.mShowingSubContainer.destroy(),t.prototype.destroy.call(this)},PicaFriendPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.RENDER_PEER+this.key+"_hide")},PicaFriendPanel.prototype.onFetchFriendHandler=function(t){this.render.renderEmitter(o.EventType.FETCH_FRIEND,t)},PicaFriendPanel.prototype.onReqFriendAttributesHandler=function(t){this.render.renderEmitter(o.EventType.REQ_FRIEND_ATTRIBUTES,t)},PicaFriendPanel.prototype.onShowAddFriendHandler=function(t){this.mShowingSubContainer&&this.mShowingSubContainer.destroy();var e=this.mSubContanerMap.get(t);if(e){this.mShowingSubContainer=new e(this.uiManager,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.mShowingSubContainer.register(),this.mShowingSubContainer.on("hide",this.onHideSearchHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.mShowingSubContainer.on(o.EventType.RENDERER_EVENT,this.onRendererEventHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.mShowingSubContainer.on(o.EventType.REQ_FRIEND_RELATION,this.onReqFriendRelationHandler,this),this.content.remove(this.friendContainer),this.content.add(this.mShowingSubContainer),this.mShowingSubContainer.resize();var i=this.mShowingSubContainer.fetchEventName();i&&this.render.renderEmitter(i)}},PicaFriendPanel.prototype.onHideSearchHandler=function(){this.content.add(this.friendContainer),this.mShowingSubContainer&&(this.mShowingSubContainer.unregister(),this.mShowingSubContainer.destroy(),this.mShowingSubContainer=null),this.friendContainer.fetchCurrentFriend()},PicaFriendPanel.prototype.onReqFriendListHandler=function(t){this.render.renderEmitter(o.EventType.REQ_PLAYER_LIST,t)},PicaFriendPanel.prototype.onRendererEventHandler=function(t,e){t&&this.render.renderEmitter(t,e)},PicaFriendPanel.prototype.onReqFriendRelationHandler=function(t){if(t){var e=t.map((function(t){return t.id}));e.length>0&&this.render.renderEmitter(o.EventType.REQ_RELATION,e)}},PicaFriendPanel}(s.BasePanel),u=function(t){function FriendContainer(e,i,n,a,s,o){var h=t.call(this,e.scene,0,0)||this;return h.uiManager=e,h.key=a,h.dpr=s,h.uiScale=o,h.render=e.render,h.setSize(i,n),h}return c(FriendContainer,t),FriendContainer.prototype.draw=function(){var t=49*this.dpr-.5*this.height;this.titleText=this.scene.make.text({x:0,y:t,style:{fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#0"}}).setOrigin(.5,0),this.titleText.setFontStyle("bold"),this.add(this.titleText)},FriendContainer.prototype.createGrideTable=function(t,e,i,n,s,h,l,c,p){var d=this,u={x:t,y:e,table:{width:i,height:n,columns:1,cellWidth:s,cellHeight:h,reuseCellContainer:!0,zoom:this.uiScale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,e){var i=t.item;return null===e&&(e=l(d.scene,t)),i.type===o.FriendChannel.Null?t.setHeight(11*d.dpr):t.height!==h&&t.setHeight(h),e.setSize(t.width,t.height),e.setData({item:i}),e.setItemData(i),p&&p(t,e),e}},m=new a.GameGridTable(this.scene,u);return m.layout(),m.on("cellTap",(function(t){t&&c.runWith(t)})),this.add(m),m},FriendContainer.prototype.sortByName=function(t){return t.sort((function(t,e){return t.nickname.localeCompare(e.nickname,l.i18n.language)}))},FriendContainer.prototype.sortByCreate=function(t){return t.sort((function(t,e){return e.createAt-t.createAt}))},FriendContainer.prototype.sortByOnlien=function(t){return t.sort((function(t,e){var i=t.lv?1:0,n=e.lv?1:0;return t.type===o.FriendChannel.Menu||e.type===o.FriendChannel.Menu||t.type===o.FriendChannel.Null||e.type===o.FriendChannel.Null?1:n-i}))},FriendContainer}(p),m=function(t){function MainContainer(e,i,n,a,s,o){var h=t.call(this,e,i,n,a,s,o)||this;return h.friendDatas=new Map,h.draw(),h}return c(MainContainer,t),MainContainer.prototype.register=function(){this.searchInput.on("textchange",this.onTextChangeHandler,this),this.searchBtn.on(a.ClickEvent.Tap,this.onSeachHandler,this),this.onlineCheckBox.on(a.ClickEvent.Tap,this.onCheckoutOnlineHandler,this),this.addFriendBtn.on(a.ClickEvent.Tap,this.onShowAddFriendHandler,this)},MainContainer.prototype.unregister=function(){this.searchInput.off("textchange",this.onTextChangeHandler,this),this.searchBtn.off(a.ClickEvent.Tap,this.onSeachHandler,this),this.onlineCheckBox.off(a.ClickEvent.Tap,this.onCheckoutOnlineHandler,this),this.addFriendBtn.off(a.ClickEvent.Tap,this.onShowAddFriendHandler,this)},MainContainer.prototype.resize=function(){this.friendTabel&&this.friendTabel.resetMask()},MainContainer.prototype.setChannel=function(t){this.channelGroup&&this.channelGroup.selectIndex(t)},MainContainer.prototype.updateFriends=function(t){var e=t.playerInfos,i=null,n=this.friendDatas.get(this.channelGroup.selectedIndex);if(n){for(var _loop_1=function(t){(i=n.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},a=0,s=e;a<s.length;a++){_loop_1(s[a])}this.showFriend(this.channelGroup.selectedIndex,n)}},MainContainer.prototype.setFriends=function(t,e){for(var i,n=[],a=null,s=[],h=0,l=e;h<l.length;h++){var c=l[h];if(t===o.FriendChannel.Followes?(a=c.followed_user,i=o.FriendRelationEnum.Followed):t===o.FriendChannel.Fans?(a=c.user,i=o.FriendRelationEnum.Fans):(a=c,i=o.FriendRelationEnum.Friend),a){var p=0;a.createAt&&(p=Date.parse(a.createAt)),n.push({type:t,id:a._id,nickname:a.nickname,relation:i,createAt:p}),s.push(a._id)}}this.friendDatas.set(t,n),s.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,s),this.showFriend(t,n)},MainContainer.prototype.showFriend=function(t,e){var i="",n="";switch(t){case o.FriendChannel.Friends:this.sortByOnlien(e),i=l.i18n.t("friendlist.title"),n=l.i18n.t("friendlist.friends"),e=[{type:o.FriendChannel.Menu,menuData:{type:o.FriendChannel.Notice}},{type:o.FriendChannel.Menu,menuData:{type:o.FriendChannel.Blacklist}},{type:o.FriendChannel.Null}].concat(e);break;case o.FriendChannel.Fans:i=l.i18n.t("friendlist.fans"),n=l.i18n.t("friendlist.fans");break;case o.FriendChannel.Followes:i=l.i18n.t("friendlist.follow"),n=l.i18n.t("friendlist.fans");break;case o.FriendChannel.Blacklist:i=l.i18n.t("friendlist.blacklist")}t!==o.FriendChannel.Friends&&this.sortByCreate(e),this.sortByOnlien(e),this.showingFriends=e,this.friendTabel.setItems(this.showingFriends),i&&this.titleText.setText(i);var a=this.friendDatas.get(this.channelGroup.selectedIndex);a&&this.friendNum.setText(n+": "+a.length),this.friendTabel&&this.friendTabel.setT(0)},MainContainer.prototype.filterById=function(t){if(this.showingFriends){var e=this.friendDatas.get(this.channelGroup.selectedIndex);e&&(e=e.filter((function(e){return e.id!==t}))),this.showingFriends=this.showingFriends.filter((function(e){return e.id!==t})),this.friendTabel.setItems(this.showingFriends)}},MainContainer.prototype.fetchCurrentFriend=function(){!this.channelGroup||this.channelGroup.selectedIndex<0||this.emit(o.EventType.FETCH_FRIEND,this.channelGroup.selectedIndex)},MainContainer.prototype.draw=function(){var e=this;t.prototype.draw.call(this);var i=.5*-this.height+17.33*this.dpr;this.friendNum=this.scene.make.text({x:0,y:i,text:"",style:{color:"#ffffff",fontSize:12*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,0),this.add(this.friendNum),this.topContent=this.scene.make.container(void 0,!1),this.add(this.topContent);var n=new a.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});this.topContent.setPosition(0,73.67*this.dpr+.5*(n.height-this.height)),this.onlineCheckBox=new a.CheckBox(this.scene,this.key,"online_unchecked","online_checked"),this.onlineCheckBox.setPosition(12*this.dpr-.5*n.width,0);var h=this.scene.make.text({x:6.67*this.dpr+.5*this.onlineCheckBox.width,y:0,text:l.i18n.t("friendlist.olinetitle"),style:{fontSize:9.33*this.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#0098D8"}}).setOrigin(0,.5);this.onlineCheckBox.add(h),this.searchBtn=new a.Button(this.scene,this.key,"search"),this.searchBtn.x=.5*n.width-39*this.dpr-.5*this.searchBtn.width,this.addFriendBtn=new a.Button(this.scene,this.key,"add"),this.addFriendBtn.x=.5*n.width-7.33*this.dpr-.5*this.addFriendBtn.width,this.searchInput=new S(this.render.uiManager,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:l.i18n.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.topContent.add([n,this.onlineCheckBox,this.searchInput,this.searchBtn,this.addFriendBtn]);var c={fontSize:14*this.dpr,fontFamily:l.Font.DEFULT_FONT},p=new a.TabButton(this.scene,this.key,"friend_default","friend_select",l.i18n.t("friendlist.friends"));p.y=.5*this.height-14*this.dpr-.5*p.height,p.setTextStyle(c);var d=new a.TabButton(this.scene,this.key,"fans_default","fans_select",l.i18n.t("friendlist.fans"));d.y=p.y,d.setTextStyle(c);var u=new a.TabButton(this.scene,this.key,"follow_default","follow_select",l.i18n.t("friendlist.follow"));u.y=p.y,u.setTextStyle(c),p.x=.5*(-d.width-p.width)-.67*this.dpr,u.x=.5*(d.width+u.width)+.67*this.dpr,this.add([p,d,u]),this.channelGroup=new s.CheckboxGroup,this.channelGroup.on("selected",this.onSelectChannelHandler,this),this.channelGroup.appendItemAll([p,d,u]),this.friendTabel=this.createGrideTable(0,this.topContent.y+this.topContent.height+380*this.dpr*.5+18*this.dpr,275*this.dpr,380*this.dpr,275*this.dpr,36*this.dpr,(function(t,i){var n=new f(e.render.uiManager,0,0,e.key,e.dpr);return n.on(o.EventType.REQ_FRIEND_ATTRIBUTES,e.onFtechPlayerHandler,e),n.on(o.EventType.RENDERER_EVENT,e.onRendererEventHandler,e),n}),new l.Handler(this,this.onSelectItemHandler))},MainContainer.prototype.onRendererEventHandler=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.emit(o.EventType.RENDERER_EVENT,t,e)},MainContainer.prototype.onFtechPlayerHandler=function(t){void 0!==t.lv&&this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,t.id),this.searchInput.setBlur()},MainContainer.prototype.onSelectChannelHandler=function(t){this.fetchCurrentFriend()},MainContainer.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&e.menuData&&e.type===o.FriendChannel.Menu&&this.emit("shwoAddFriend",e.menuData.type)},MainContainer.prototype.onCheckoutOnlineHandler=function(){var t=this.showingFriends;this.onlineCheckBox.selected&&(t=this.showingFriends.slice(0).filter((function(t){return!0===t.online})));this.friendTabel.setItems(t)},MainContainer.prototype.onShowAddFriendHandler=function(){this.emit("shwoAddFriend",o.FriendChannel.Search),this.searchInput.setBlur()},MainContainer.prototype.onSeachHandler=function(){var t=this.searchInput.text;if(t){var e=this.showingFriends.slice(0);e=e.filter((function(e){return!!(e.nickname&&e.nickname.indexOf(t)>-1)})),this.friendTabel.setItems(e)}else this.friendTabel.setItems(this.showingFriends)},MainContainer.prototype.onTextChangeHandler=function(){this.onSeachHandler()},MainContainer}(u),f=function(t){function PicFriendItem(e,i,n,a,s){var o=t.call(this,e.scene,i,n)||this;return o.mDpr=0,o.render=e.render,o.setSize(275*s,36*s),o.mDpr=s,o.mKey=a,o}return c(PicFriendItem,t),PicFriendItem.prototype.setItemData=function(t){this.itemData=t,this.currnetType!==t.type&&(this.currnetType=t.type,this.currentRender&&(this.currentRender.destroy(),this.currentRender=null),this.currentRender=this.createRenderer(t.type)),this.currentRender&&this.currentRender.setItemData(t)},PicFriendItem.prototype.createAddBtn=function(t){var e=48*this.mDpr,i=24*this.mDpr;return new a.NineSliceButton(this.scene,.5*(this.width-e)-18*this.mDpr,0,e,i,h.c.commonKey,"yellow_btn_normal_s",l.i18n.t("common.add"),this.mDpr,this.scale,{left:10*this.mDpr,top:10*this.mDpr,right:10*this.mDpr,bottom:10*this.mDpr})},PicFriendItem.prototype.onHeadhandler=function(){this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,this.itemData)},PicFriendItem.prototype.createRenderer=function(t){switch(t){case o.FriendChannel.Fans:case o.FriendChannel.Search:case o.FriendChannel.Friends:case o.FriendChannel.Followes:case o.FriendChannel.Blacklist:return new _(this.scene,this);case o.FriendChannel.Null:return new P(this.scene,this);case o.FriendChannel.Menu:return new y(this.scene,this);case o.FriendChannel.Notice:return new g(this.scene,this)}},Object.defineProperty(PicFriendItem.prototype,"key",{get:function(){return this.mKey},enumerable:!1,configurable:!0}),Object.defineProperty(PicFriendItem.prototype,"dpr",{get:function(){return this.mDpr},enumerable:!1,configurable:!0}),PicFriendItem}(p),y=function(){function MenuRenderer(t,e){this.scene=t,this.owner=e,this.icon=this.scene.make.image({x:7.44*this.owner.dpr-.5*this.owner.width,key:e.key,frame:"black_list"},!1).setOrigin(0,.5),this.text=this.scene.make.text({x:this.icon.x+this.icon.width+9.67*e.dpr,style:{fontSize:9.33*e.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#000000"}}).setOrigin(0,.5),this.arrow=this.scene.make.image({x:.5*e.width-20*e.dpr,key:e.key,frame:"arrow"}).setOrigin(1,.5),this.owner.add([this.icon,this.text,this.arrow])}return MenuRenderer.prototype.setItemData=function(t){var e=t.menuData;if(e)switch(e.type){case o.FriendChannel.Notice:this.icon.setFrame("notice"),this.text.text=l.i18n.t("friendlist.notice");break;case o.FriendChannel.Blacklist:this.icon.setFrame("black_list"),this.text.text=l.i18n.t("friendlist.blacklist")}},MenuRenderer.prototype.destroy=function(){this.icon&&this.icon.destroy(),this.text&&this.text.destroy(),this.arrow&&this.arrow.destroy()},MenuRenderer}(),g=function(){function NoticeRenderer(t,e){this.scene=t,this.owner=e,this.icon=this.scene.make.image({x:7.44*this.owner.dpr-.5*this.owner.width,key:e.key,frame:"notice_icon"},!1).setOrigin(0,.5),this.text=new a.BBCodeText(this.scene,this.icon.x+this.icon.width+9.67*e.dpr,0,"",{fontSize:9.33*e.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#000000"}),this.text.setOrigin(0,.5),this.owner.add([this.icon,this.text])}return NoticeRenderer.prototype.setItemData=function(t){this.text.setText("[color=#00dffc]"+t.nickname+"[/color] "+l.i18n.t("friendlist.followed_you"))},NoticeRenderer.prototype.destroy=function(){this.icon&&this.icon.destroy(),this.text&&this.text.destroy()},NoticeRenderer}(),P=function(){function NullRenderer(t,e){this.owner=e,this.graphics=t.make.graphics(void 0,!1),this.graphics.fillStyle(16119285),this.graphics.fillRect(.5*-this.owner.width,-18*e.dpr,this.owner.width,this.owner.height),e.add(this.graphics)}return NullRenderer.prototype.setItemData=function(t){},NullRenderer.prototype.destroy=function(){this.graphics&&this.graphics.destroy()},NullRenderer}(),_=function(){function FriendRenderer(t,e){this.scene=t,this.owner=e,this.icon=t.make.image({x:7.44*e.dpr-.5*e.width,key:e.key,frame:"offline_head"}).setOrigin(0,.5).setInteractive().on("pointerup",this.onHeadhandler,this),this.icon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.nameText=t.make.text({x:this.icon.x+this.icon.width+9.67*e.dpr,y:.5*-this.icon.height+1*e.dpr,style:{fontSize:10*e.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#6F75FF"}},!1),this.level=t.make.text({x:this.nameText.x,y:this.nameText.y+18*e.dpr,text:"",style:{fontSize:8*e.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#6F75FF"}}),this.addBtn=this.createAddBtn(l.i18n.t("friendlist.follow")),this.addBtn.on(a.ClickEvent.Tap,this.onAddHandler,this),this.owner.add(this.addBtn),e.add([this.icon,this.nameText,this.level,this.addBtn])}return FriendRenderer.prototype.setItemData=function(t){this.itemData=t,this.nameText.text=t.nickname;var e=t.lv?l.i18n.t("friendlist.lv")+"："+t.lv:l.i18n.t("friendlist.unregistered_game");this.level.setText(e),this.curRelation!==t.relation&&(this.curRelation=t.relation,this.updateRelation())},FriendRenderer.prototype.destroy=function(){if(this.owner)for(var t=this.owner.list;t.length;)t[t.length-1].destroy()},FriendRenderer.prototype.updateRelation=function(){this.curRelation&&this[this.curRelation]?this[this.curRelation]():(this.addBtn.visible=!1,this.friendEvnet=null)},FriendRenderer.prototype.fans=function(){this.addBtn.visible=!0,this.addBtn.setText(l.i18n.t("friendlist.follow")),this.friendEvnet=o.EventType.FOLLOW},FriendRenderer.prototype.followed=function(){this.addBtn.visible=!0,this.addBtn.setText(l.i18n.t("friendlist.unfollow")),this.friendEvnet=o.EventType.UNFOLLOW},FriendRenderer.prototype.blacklist=function(){this.addBtn.visible=!0,this.addBtn.setText(l.i18n.t("friendlist.remove")),this.friendEvnet=o.EventType.REMOVE_FROM_BLACKLIST},FriendRenderer.prototype.null=function(){this.fans()},FriendRenderer.prototype.createAddBtn=function(t){var e=this.owner,i=e.width,n=(e.height,e.key,e.dpr),s=48*n,o=24*n,c=new a.NineSliceButton(this.scene,.5*(i-s)-18*n,0,s,o,h.c.commonKey,"yellow_btn_normal_s",t,n,1,{left:10*n,top:6*n,right:10*n,bottom:6*n});return c.setTextStyle({fontSize:9*n,fontFamily:l.Font.DEFULT_FONT}),c},FriendRenderer.prototype.onHeadhandler=function(){this.owner.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,this.itemData)},FriendRenderer.prototype.onAddHandler=function(){this.friendEvnet&&this.itemData&&this.owner.emit(o.EventType.RENDERER_EVENT,this.friendEvnet,this.itemData.id)},FriendRenderer}(),v=function(t){function SubFriendContainer(e,i,n,a,s,o){var h=t.call(this,e,i,n,a,s,o)||this;return h.draw(),h}return c(SubFriendContainer,t),SubFriendContainer.prototype.register=function(){this.backBtn.on(a.ClickEvent.Tap,this.onBackHandler,this)},SubFriendContainer.prototype.unregister=function(){this.backBtn.off(a.ClickEvent.Tap,this.onBackHandler,this)},SubFriendContainer.prototype.resize=function(){this.gridTable&&this.gridTable.resetMask()},SubFriendContainer.prototype.setItems=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SubFriendContainer.prototype.filterById=function(t){!this.items||this.items.length<1||(this.items&&(this.items=this.items.filter((function(e){return e.id!==t}))),this.gridTable&&this.gridTable.setItems(this.items))},SubFriendContainer.prototype.updateFriends=function(t){},SubFriendContainer.prototype.fetchEventName=function(){return""},SubFriendContainer.prototype.destroy=function(){this.unregister(),this.gridTable&&this.gridTable.destroy(),t.prototype.destroy.call(this)},SubFriendContainer.prototype.draw=function(){var e=this;t.prototype.draw.call(this),this.backBtn=new a.Button(this.scene,this.key,"back"),this.backBtn.setPosition(.5*(-this.width+this.backBtn.width)+21.67*this.dpr,.5*(-this.height+this.backBtn.height)+47*this.dpr),this.gridTable=this.createGrideTable(0,18*this.dpr,275*this.dpr,400*this.dpr,275*this.dpr,36*this.dpr,(function(){var t=new f(e.uiManager,0,0,e.key,e.dpr);return t.on(o.EventType.REQ_FRIEND_ATTRIBUTES,e.onFtechPlayerHandler,e),t.on(o.EventType.RENDERER_EVENT,e.onRendererEventHandler,e),t}),new l.Handler(this.onItemClickHandler)),this.add([this.backBtn])},SubFriendContainer.prototype.onBackHandler=function(){this.emit("hide")},SubFriendContainer.prototype.onItemClickHandler=function(){},SubFriendContainer.prototype.onFtechPlayerHandler=function(t){this.emit(o.EventType.REQ_FRIEND_ATTRIBUTES,t.id)},SubFriendContainer.prototype.onRendererEventHandler=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.emit(o.EventType.RENDERER_EVENT,t,e)},SubFriendContainer}(u),b=function(t){function SearchContainer(e,i,n,a,s,h){var l=t.call(this,e,i,n,a,s,h)||this;return l.friendType=o.FriendChannel.Search,l}return c(SearchContainer,t),SearchContainer.prototype.setItems=function(t){if(t){for(var e=[],i=0,n=t;i<n.length;i++){var a=n[i],s=a.platformId,h=a.nickname,l=a.level;e.push({type:this.friendType,nickname:h,id:s,lv:l.level})}this.emit(o.EventType.REQ_FRIEND_RELATION,e),this.items=e}},SearchContainer.prototype.updateRelation=function(t){if(this.items){for(var _loop_2=function(t){e.items.find((function(e){return e.id===t.id})).relation=t.relation},e=this,i=0,n=t;i<n.length;i++){_loop_2(n[i])}this.updateFriends(this.items)}},SearchContainer.prototype.updateFriends=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SearchContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.i18n.t("friendlist.search"));var e=new a.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});e.setPosition(0,73.67*this.dpr+.5*(e.height-this.height)),this.searchInput=new S(this.uiManager,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:l.i18n.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.searchInput.setPosition(0,e.y),this.searchInput.on("search",this.onSearchHandler,this),this.gridTable.y=e.height,this.gridTable.layout(),this.add([e,this.searchInput])},SearchContainer.prototype.onSearchHandler=function(t){this.emit(o.EventType.RENDERER_EVENT,o.EventType.SEARCH_FRIEND,t),this.resize()},SearchContainer}(v),T=function(t){function BlackContainer(e,i,n,a,s,h){var l=t.call(this,e,i,n,a,s,h)||this;return l.friendType=o.FriendChannel.Blacklist,l}return c(BlackContainer,t),BlackContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.i18n.t("friendlist.blacklist"))},BlackContainer.prototype.setItems=function(e){if(e){for(var i=[],n=[],a=null,s=0,h=e;s<h.length;s++){(a=h[s].ban_user)&&(n.push(a._id),i.push({type:o.FriendChannel.Blacklist,id:a._id,nickname:a.nickname,relation:o.FriendRelationEnum.Blacklist}))}t.prototype.setItems.call(this,i),n.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,n)}},BlackContainer.prototype.updateFriends=function(t){for(var e=t.playerInfos,i=null,_loop_3=function(t){(i=n.items.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},n=this,a=0,s=e;a<s.length;a++){_loop_3(s[a])}this.gridTable&&this.gridTable.setItems(this.items)},BlackContainer.prototype.fetchEventName=function(){return o.EventType.REQ_BLACKLIST},BlackContainer}(v),S=function(t){function SearchInput(e,i,n,s){var o=t.call(this,e.scene,i)||this;o.render=e.render,o.searchBtn=new a.Button(o.scene,n,"search_blue"),o.searchBtn.x=i.width+4*s+.5*o.searchBtn.width,o.searchBtn.on(a.ClickEvent.Tap,o.onSearchHandler,o),o.add(o.searchBtn);var h=e.scene.make.graphics(void 0,!1);return h.fillStyle(16777215),h.fillRoundedRect(-5*s,.5*-i.height,i.width+14*s+o.searchBtn.width,i.height,.5*i.height),o.addAt(h,0),o.setOrigin(0,.5),o}return c(SearchInput,t),SearchInput.prototype.onSearchHandler=function(){this.setBlur(),this.emit("search",this.text)},SearchInput}(s.LabelInput),x=function(t){function NoticeContainer(e,i,n,a,s,h){var l=t.call(this,e,i,n,a,s,h)||this;return l.friendType=o.FriendChannel.Search,l}return c(NoticeContainer,t),NoticeContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.i18n.t("friendlist.notice"))},NoticeContainer.prototype.setItems=function(e){if(e){for(var i=[],n=[],a=Date.now(),s=0,h=e;s<h.length;s++){var l=h[s];if(l.created_at)if(a-Date.parse(l.created_at)<2592e5){var c=l.user;c&&(i.push({type:o.FriendChannel.Notice,id:c._id,nickname:c.nickname}),n.push(c._id))}}t.prototype.setItems.call(this,i),n.length>0&&this.emit(o.EventType.REQ_PLAYER_LIST,n)}},NoticeContainer.prototype.updateFriends=function(t){for(var e=t.playerInfos,i=null,_loop_4=function(t){(i=n.items.find((function(e){return e.id===t.platformId})))&&(i.nickname=t.nickname,t.level&&(i.lv=t.level.level))},n=this,a=0,s=e;a<s.length;a++){_loop_4(s[a])}this.gridTable&&this.gridTable.setItems(this.items)},NoticeContainer.prototype.fetchEventName=function(){return o.EventType.REQ_NEW_FANS},NoticeContainer}(v);!function(t){function NavigateContaienr(e,i,n,a,s,o){var h=t.call(this,e,i,n)||this;h.setSize(a,s),h.chars=[];for(var c=0;c<26;c++)h.chars.push(String.fromCharCode(c+65));h.chars.push("#"),h.texts=[];var p=s/h.chars.length,d={color:"#0",fontSize:8*o,fontFamily:l.Font.DEFULT_FONT},u=0,m=0;for(c=0;c<h.chars.length;c++){var f=h.scene.make.text({y:c*p-.5*h.height,text:h.chars[c],style:d}).setOrigin(.5);h.texts[c]=f,u||(u=f.width+8*o,m=f.height+2*o)}return h.selected=h.scene.make.graphics(void 0,!1),h.selected.fillStyle(3115002),h.selected.fillRect(.5*-u,.5*-m,u,m),h.add(h.selected),h.selected.x=h.texts[0].x,h.selected.y=h.texts[0].y,h.add(h.texts),h}c(NavigateContaienr,t),NavigateContaienr.prototype.checkSlider=function(t){if(t){this.selected.visible=!0;for(var e=0;e<this.chars.length;e++)if(t.localeCompare(this.chars[e])>-1)return this.selected.x=this.texts[e].x,void(this.selected.y=this.texts[e].y)}else this.selected.visible=!1}}(p)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurniFunPanel",(function(){return u}));var n,a=i(1),s=i(6),o=i(479),h=i(484),l=i(0),c=i(21),p=i(2),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaFurniFunPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=l.ModuleName.PICAFURNIFUN_NAME,i}return d(PicaFurniFunPanel,t),PicaFurniFunPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,a),this.content.x=Math.floor(n/2),this.content.y=Math.floor(a/2),this.setSize(n*this.scale,a*this.scale),this.materialGameScroll.refreshMask()},PicaFurniFunPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setFuritDisplay(),this.setMaterialsData(this._getMaterialData())):this.preload())},PicaFurniFunPanel.prototype.addListen=function(){this.mInitialized&&(this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.on(s.ClickEvent.Tap,this.OnClosePanel,this))},PicaFurniFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.confirmBtn.off(s.ClickEvent.Tap,this.onConfirmBtnClick,this),this.closeBtn.off(s.ClickEvent.Tap,this.OnClosePanel,this))},PicaFurniFunPanel.prototype.preload=function(){this.addAtlas(this.key,"furni_unlock/furni_unlock.png","furni_unlock/furni_unlock.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(c.c.common2Key,c.d.common2Url+".png",c.d.common2Url+".json"),t.prototype.preload.call(this)},PicaFurniFunPanel.prototype.init=function(){var e=this,i=this.cameraWidth,n=this.cameraHeight;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,i/this.scale,n/this.scale),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var a=295*this.dpr,l=400*this.dpr;this.content.setSize(a,l),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,a,l,c.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:40*this.dpr}),this.content.add(this.bg);var d=.5*-this.bg.height;this.titleimage=this.scene.make.image({x:0,y:d+5*this.dpr,key:c.c.common2Key,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+2*this.dpr,text:p.i18n.t("furni_unlock.title"),style:{color:"#905B06",fontFamily:p.Font.DEFULT_FONT,fontSize:16*this.dpr}}).setOrigin(.5,.5).setFontStyle("bold"),this.closeBtn=new s.Button(this.scene,c.c.commonKey,"close"),this.closeBtn.x=.5*this.bg.width-8*this.dpr,this.closeBtn.y=d+7*this.dpr,this.content.add([this.titleimage,this.titleName,this.closeBtn]),this.itemName=this.scene.make.text({x:0,y:this.titleimage.y+.5*this.titleimage.height+13*this.dpr,text:"",style:{color:"#FFC51A",fontFamily:p.Font.DEFULT_FONT,fontSize:14*this.dpr}}).setFontStyle("bold").setStroke("#996600",4).setOrigin(.5),this.content.add(this.itemName),this.bgicon=this.scene.make.image({key:this.key,frame:"bg_f"}),this.bgicon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bgicon.y=this.itemName.y+.5*this.bgicon.height+13*this.dpr,this.content.add([this.bg,this.bgicon]),this.mDetailDisplay=new h.a(this.scene,this.render),this.mDetailDisplay.setTexture(this.key,"bg_f"),this.mDetailDisplay.y=this.bgicon.y,this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.setSize(72*this.dpr,72*this.dpr),this.content.add(this.mDetailDisplay);var u=360*this.dpr,m=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(u,m),this.content.add(this.materialCon),this.materialCon.setPosition(0,-d-.5*m-66*this.dpr);var f=this.scene.make.text({x:0,y:.5*-m+12*this.dpr,text:p.i18n.t("furni_unlock.needMaterials"),style:{color:"#253FCA",fontSize:12*this.dpr,fontFamily:p.Font.DEFULT_FONT}},!1).setOrigin(.5),y=this.scene.make.image({key:this.key,frame:"sourcelist_title"});y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var g=this.scene.make.image({key:this.key,frame:"sourcelist_title"});g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var P=.5*-f.width-.5*y.width-10*this.dpr;y.setPosition(P,f.y),g.setPosition(-P,f.y).rotation=-Math.PI,this.materialCon.add([f,y,g]),this.materialGameScroll=new s.GameScroller(this.scene,{x:0,y:2*this.dpr,width:240*this.dpr,height:90*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:void 0,cellupCallBack:function(t){e.onMaterialItemHandler(t)}}),this.materialCon.add(this.materialGameScroll);var _=145*this.dpr,v=55*this.dpr;this.itemtips=new o.ItemInfoTips(this.scene,_,v,c.c.common2Key,"tips_bg",this.dpr,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.itemtips.x=.5*-this.width+.5*_+10*this.dpr,this.itemtips.y=.5*-this.height+70*this.dpr,this.itemtips.setVisible(!1),this.itemtips.setHandler(new p.Handler(this,this.onItemTipsHideHandler)),this.content.add(this.itemtips),this.confirmBtn=new s.NineSliceButton(this.scene,0,-d-35*this.dpr,100*this.dpr,40*this.dpr,c.c.commonKey,"yellow_btn_over",p.i18n.t("furni_unlock.unlock"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:12*this.dpr,fontFamily:p.Font.DEFULT_FONT,stroke:"#976400"}),this.confirmBtn.setTextOffset(10*this.dpr,0);var b=this.scene.make.image({key:this.key,frame:"repair_icon"});b.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),b.x=-28*this.dpr,this.confirmBtn.add(b),this.content.add(this.confirmBtn),this.resize(0,0),t.prototype.init.call(this)},PicaFurniFunPanel.prototype.destroy=function(){this.removeListen(),this.confirmBtn&&this.confirmBtn.destroy(),this.confirmBtn=null,t.prototype.destroy.call(this)},PicaFurniFunPanel.prototype.setFuritDisplay=function(){var t=this._getDisplayData(),e=t.displayInfo,i=new a.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE;i.display=e.display;var n=this.createProtocolObject(e.animations);if(n.length>1){for(var s=[],o=0,h=n;o<h.length;o++){var l=h[o];"lock"!==l.node.name&&(l.frameName=l.layer[0].frameName,s.push(l))}0===s.length&&s.push(n[0]),i.animations=s}else i.animations=n;this.mDetailDisplay.loadDisplay(i),this.itemName.text=t.nickname},PicaFurniFunPanel.prototype.isTeamBuild=function(){return this.mShowData.tag&&"teambuild"===this.mShowData.tag},PicaFurniFunPanel.prototype._getDisplayData=function(){return this.isTeamBuild()?this.mShowData.element:this.mShowData},PicaFurniFunPanel.prototype._getMaterialData=function(){return this.isTeamBuild()?this.mShowData.materials:this.materials},PicaFurniFunPanel.prototype.setMaterialsData=function(t){this.materials=t,this.mInitialized&&t&&this.setMaterialItems(this.materials)},PicaFurniFunPanel.prototype.createProtocolObject=function(t){var e=[];return t.forEach((function(t){var i={node:t.mNode,baseLoc:"0,0",originPoint:[0,0],layer:[]},n=new o.AnimationModel(i);Object.assign(n,t);var a=n.createProtocolObject();e.push(a)}),this),e},PicaFurniFunPanel.prototype.setMaterialItems=function(t){var e=t.length;this.materialGameScroll.clearItems();for(var i=0;i<e;i++){var n=new m(this.scene,this.key,this.dpr,this.scale);n.y=0,n.setItemData(t[i]),n.setData("itemData",t[i]),this.materialGameScroll.addItem(n)}this.materialGameScroll.Sort()},PicaFurniFunPanel.prototype.onConfirmBtnClick=function(){var t=this.showData;t&&(this.isTeamBuild()?this.render.renderEmitter(this.key+"_queryTeamBuild",[t.element.id]):this.render.renderEmitter(this.key+"_queryunlock",[t.id]),this.OnClosePanel())},PicaFurniFunPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(this.key+"_close")},PicaFurniFunPanel.prototype.onMaterialItemHandler=function(t){this.itemtips.setVisible(!1),this.selectMaterial&&this.selectMaterial!==t&&(this.selectMaterial.select=!1),t.select=!t.select,t.select&&(this.itemtips.setItemData(t.itemData),this.itemtips.setVisible(!0)),this.selectMaterial=t,this.setTipsPosition(t)},PicaFurniFunPanel.prototype.onItemTipsHideHandler=function(){this.selectMaterial&&(this.selectMaterial.select=!1)},PicaFurniFunPanel.prototype.setTipsPosition=function(t){for(var e=t.x,i=t.y,n=t;n.parentContainer!==this.content;)e+=n.parentContainer.x,i+=n.parentContainer.y,n=n.parentContainer;e-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:e+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=e,this.itemtips.y=i-.5*this.itemtips.height+5*this.dpr},PicaFurniFunPanel}(o.BasePanel),m=function(t){function MaterialItem(e,i,n,a){var h=t.call(this,e)||this;return h.mselect=!1,h.dpr=n,h.key=i,h.zoom=a,h.bg=h.scene.make.image({key:h.key,frame:"bg_m"}),h.itemIcon=new o.DynamicImage(e,0,0),h.itemIcon.scale=h.dpr/h.zoom,h.itemCount=new s.BBCodeText(h.scene,0,15*n,"10/20",{color:"#000000"}).setOrigin(.5).setFontSize(11*n).setFontFamily(p.Font.DEFULT_FONT),h.add([h.bg,h.itemIcon,h.itemCount]),h.setSize(h.bg.width,h.bg.height),h.itemCount.y=.5*h.height+8*n,h}return d(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){this.itemData=t,this.itemCount.text=this.getCountText(t);var e=p.Url.getOsdRes(t.texturePath);this.itemIcon.load(e,this,(function(){}))},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.bg.setFrame(t?"bg_select":"bg_m"),this.mselect=t},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t){var e="[color="+(t.count>=t.neededCount?"#000000":"#ff0000")+"]"+t.count+"[/color]/"+t.neededCount;return t.hasOwnProperty("recommended")&&(e=t.recommended+"/"+e),e},MaterialItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaFurnitureComposePanel",(function(){return u}));var n,a=i(6),s=i(479),o=i(484),h=i(21),l=i(0),c=i(2),p=i(480),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaFurnitureComposePanel(e){var i=t.call(this,e)||this;return i.mSelectedItemData=[],i.subCategoryType=1,i.atlasNames=[h.d.uicommon,h.d.effectcommon],i.key=l.ModuleName.PICAFURNITURECOMPOSE_NAME,i}return d(PicaFurnitureComposePanel,t),PicaFurnitureComposePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.mBackground.x=.5*n,this.mBackground.y=.5*a,this.topBackground.x=.5*n,this.topBackground.y=.5*this.topBackground.height;var s=79*this.dpr,o=a-this.mPropGrid.height-.5*s-47*this.dpr;this.furiAnimation.x=.5*n,this.furiAnimation.y=.5*o+7*this.dpr,this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=o,this.mCategoryCon.x=.5*n,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(10841086),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.mCategoriesBar.fillStyle(8539348),this.mCategoriesBar.fillRect(0,40*this.dpr,n,3*this.dpr),this.composeBtn.x=n-this.composeBtn.width/2-20*this.dpr,this.composeBtn.y=this.mCategoryCon.y-this.composeBtn.height/2+35*this.dpr,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(13531891),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=a-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=a-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,a),this.setInteractive()},PicaFurnitureComposePanel.prototype.setCategories=function(){var t=[{name:c.i18n.t("furnicompose.onestar"),value:1},{name:c.i18n.t("furnicompose.twostar"),value:2},{name:c.i18n.t("furnicompose.threestar"),value:3},{name:c.i18n.t("furnicompose.fourstar"),value:4}];this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();for(var a=0;a<t.length;a++){var o=new s.TextButton(this.scene,this.dpr,1,t[a].name,0,0);o.setData("item",t[a]),o.setSize(e,i),this.mCategoryScroll.addItem(o),o.setChangeColor("#FFE63C"),n[a]=o,o.setFontSize(16*this.dpr),o.setFontStyle("bold")}this.mCategoryScroll.setAlign(1),this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0])},PicaFurnitureComposePanel.prototype.setGridProp=function(t){this.setProps(t),this.mPropGrid.setT(0),this.updateSelectItemDatas(t)},PicaFurnitureComposePanel.prototype.updateGridProp=function(t){this.setProps(t),this.updateSelectItemDatas(t)},PicaFurnitureComposePanel.prototype.setProps=function(t){var e=(t=t||[]).length;e<24&&(t=t.concat(new Array(24-e))),this.mPropGrid.setItems(t)},PicaFurnitureComposePanel.prototype.setStarData=function(t){this.starCount=t,this.mInitialized&&this.starvalue.setText(t+"")},PicaFurnitureComposePanel.prototype.updateSelectItemDatas=function(t){for(var e=[],i=0,n=this.mSelectedItemData;i<n.length;i++)for(var a=n[i],s=0,o=t;s<o.length;s++){var h=o[s];a&&h.indexId===a.indexId&&e.push(h)}this.mSelectedItemData.length=0,this.mSelectedItemData=e},PicaFurnitureComposePanel.prototype.setComposeResult=function(t){},PicaFurnitureComposePanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this),this.composeBtn.on(a.ClickEvent.Tap,this.onComposeBtnHandler,this))},PicaFurnitureComposePanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(a.ClickEvent.Tap,this.onCloseHandler,this),this.composeBtn.off(a.ClickEvent.Tap,this.onComposeBtnHandler,this))},PicaFurnitureComposePanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaFurnitureComposePanel.prototype.queryRefreshPackage=function(t){this.queryPackege(t)},PicaFurnitureComposePanel.prototype.onInitialized=function(){this.starCount&&this.starvalue.setText(this.starCount+"")},PicaFurnitureComposePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new s.CommonBackground(this.scene,0,0,i,n,h.d.effectcommon,"synthetic_bg",13204211),this.topBackground=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_bg_stripe"}),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new s.ButtonEventDispatcher(this.scene,0,0),this.mCloseBtn.setSize(100*this.dpr,40*this.dpr),this.mCloseBtn.enable=!0,this.mCloseBtn.x=.5*this.mCloseBtn.width+10*this.dpr,this.mCloseBtn.y=35*this.dpr;var l=this.scene.make.image({key:h.d.uicommon,frame:"back_arrow"});l.x=.5*-this.mCloseBtn.width+.5*l.width+10*this.dpr;var p=this.scene.make.text({text:"",style:c.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5);p.text=c.i18n.t("compose.title"),p.x=l.x+.5*l.width+10*this.dpr,this.mCloseBtn.add([l,p]),this.furiAnimation=new m(this.scene,this.dpr,this.scale),this.furiAnimation.setHandler(new c.Handler(this,this.onFuriComposeAnimationHandler));var d=new a.NineSlicePatch(this.scene,0,-this.dpr,80*this.dpr,28*this.dpr,h.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});d.x=.5*-d.width,this.starvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,h.d.uicommon,"Recast_pica star_big",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:c.Font.NUMBER}),this.starvalue.setLayout(1),this.starvalue.x=d.x-.5*d.width+22*this.dpr,this.starCountCon=this.scene.make.container(void 0,!1),this.starCountCon.setSize(d.width,d.height),this.starCountCon.add([d,this.starvalue]),this.starCountCon.x=i-20*this.dpr,this.starCountCon.y=this.mCloseBtn.y;var u=100*this.dpr,f=40*this.dpr,y=i-u/2-20*this.dpr,g=this.mCategoryCon.y-25*this.dpr;this.composeBtn=this.createNineButton(y+100*this.dpr,g,u,f,h.d.uicommon,"yellow_btn",c.i18n.t("compose.title"),"#996600"),this.mCategoryScroll=new a.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:28*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add([this.mCategoriesBar,this.mCategoryScroll]),this.add([this.mBackground,this.topBackground,this.mPropGridBg,this.mCloseBtn,this.furiAnimation,this.starCountCon,this.mCategoryCon,this.composeBtn]);var P=this.scene.textures.getFrame(h.d.uicommon,"bag_icon_common_bg"),_=P.width+9*this.dpr,v=P.height+9*this.dpr,b={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:_,cellHeight:v,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new o.c(n,h.d.effectcommon,"synthetic_icon_bg",e.dpr,e.scale,!1)),i.setData({item:a}),i.setItemData(a,!0),i}};this.mPropGrid=new a.GameGridTable(this.scene,b),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaFurnitureComposePanel.prototype.createNineButton=function(t,e,i,n,s,o,h,l){var p=new a.NineSliceButton(this.scene,t,e,i,n,s,o,h,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return h&&(p.setTextStyle({color:l,fontSize:16*this.dpr,fontFamily:c.Font.DEFULT_FONT}),p.setFontStyle("bold")),p},PicaFurnitureComposePanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");e&&(this.mPreCategoryBtn&&this.mPreCategoryBtn.changeNormal(),t.changeDown(),this.mSelectedCategeories=e,this.subCategoryType=e.value,this.queryPackege(!1),this.mPreCategoryBtn=t),this.mPropGrid.setT(0),this.furiAnimation.clearItemDatas(!0),this.furiAnimation.setStarType(this.subCategoryType)},PicaFurnitureComposePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaFurnitureComposePanel.prototype.queryPackege=function(t){this.mSelectedCategeories&&this.render.renderEmitter(this.key+"_queryfuripackage",{type:this.subCategoryType,update:t})},PicaFurnitureComposePanel.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&this.checkSelectItemDatas(e,!0)},PicaFurnitureComposePanel.prototype.onComposeBtnHandler=function(){if(this.mSelectedItemData&&5===this.mSelectedItemData.length){if(this.starCount<this.subCategoryType){var t={text:[{text:c.i18n.t("furnicompose.starpicatips"),node:void 0}]};return void this.render.mainPeer.showMediator(l.ModuleName.PICANOTICE_NAME,!0,t)}for(var e=[],i=0,n=this.mSelectedItemData;i<n.length;i++){t=n[i];e.push(t.id)}this.render.renderEmitter(this.key+"_queryfuricompose",e),this.furiAnimation.playComposeAnimation(),this.mSelectedItemData.length=0}else{t={text:[{text:c.i18n.t("furnicompose.selecttips"),node:void 0}]};this.render.mainPeer.showMediator(l.ModuleName.PICANOTICE_NAME,!0,t)}},PicaFurnitureComposePanel.prototype.checkSelectItemDatas=function(t,e){if(!e||5!==this.mSelectedItemData.length){for(var i=-1,n=0;n<this.mSelectedItemData.length;n++){this.mSelectedItemData[n].indexId===t.indexId&&(i=n)}if(e)t.count>0&&(this.mSelectedItemData.push(t),this.furiAnimation.setItemData(t,this.subCategoryType),t.count--);else if(-1!==i)this.mSelectedItemData.splice(i,1)[0].count++;this.mPropGrid.refresh()}},PicaFurnitureComposePanel.prototype.onFuriComposeAnimationHandler=function(t,e){"remove"===t&&this.checkSelectItemDatas(e,!1)},PicaFurnitureComposePanel}(p.PicaBasePanel),m=function(t){function FuriComposeAnimation(e,i,n){var a=t.call(this,e)||this;return a.starImgList=[],a.itemList=[],a.indexeds=[0,0,0,0,0],a.tweens=[],a.canPlay=!1,a.dpr=i,a.zoom=n,a.init(),a.setSize(a.bgring1.width,a.bgring1.height),a}return d(FuriComposeAnimation,t),FuriComposeAnimation.prototype.setHandler=function(t){this.send=t},FuriComposeAnimation.prototype.setStarType=function(t){this.starType=t,this.bgstarLev.setFrame("synthetic_center_star"+(t+1)),this.spendStarTex.text=c.i18n.t("furnicompose.spendstar",{name:t}),this.bgstarLev.visible=!0},FuriComposeAnimation.prototype.setItemData=function(t,e){this.starType=e;for(var i=-1,n=0;n<this.indexeds.length;n++){if(0===this.indexeds[n])-1===i&&(i=n);else this.itemList[n].itemData.indexId===t.indexId&&0}-1!==i&&t.count>0&&(this.indexeds[i]=1,this.itemList[i].setItemData(t),this.starImgList[i].visible=!0,this.playAnimation());this.displayStarImg()},FuriComposeAnimation.prototype.removeItemData=function(t){this.indexeds[t]=0;var e=this.itemList[t];e.itemData&&(this.send&&this.send.runWith(["remove",e.itemData]),e.setItemData(void 0)),this.displayStarImg();for(var i=!1,n=0,a=this.indexeds;n<a.length;n++){1===a[n]&&(i=!0)}i?this.playAnimation():this.stopAnimation()},FuriComposeAnimation.prototype.clearItemDatas=function(t){for(var e=0;e<this.indexeds.length;e++){this.indexeds[e]=0;var i=this.itemList[e];i.itemData&&(t&&this.send&&this.send.runWith(["remove",i.itemData]),i.setItemData(void 0))}this.stopTweens(),this.displayStarImg(),this.stopAnimation(),this.layoutItemsPosition()},FuriComposeAnimation.prototype.playComposeAnimation=function(){for(var t=0,e=this.itemList;t<e.length;t++){var i=e[t];this.playMove(i,0,0,200)}},FuriComposeAnimation.prototype.update=function(){this.canPlay&&(this.bgring1.rotation+=.04,this.bgring2.rotation-=.015,this.bgring3.rotation+=.02)},FuriComposeAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.stopAnimation(),this.stopTweens()},FuriComposeAnimation.prototype.init=function(){this.bgring1=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_1"}),this.bgring2=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_2"}),this.bgring3=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_3"}),this.bgring4=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_4"}),this.bgring5=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_5"}),this.bgring6=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_ring_6"}),this.bgringstar=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_star_default"}),this.bgstarLev=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_center_star2"}),this.bglightstar=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_star_illume_5"}),this.bglightstar.y=3*this.dpr,this.spendStarTex=new a.BBCodeText(this.scene,0,.5*this.bgring1.height+15*this.dpr,"",c.UIHelper.whiteStyle(this.dpr,11)).setOrigin(.5),this.add([this.bgring1,this.bgring2,this.bgring3,this.bgring4,this.bgring5,this.bgring6,this.bgringstar,this.bgstarLev,this.bglightstar,this.spendStarTex]),this.createStarImg(),this.createItem(),this.bglightstar.visible=!1,this.bgstarLev.visible=!1},FuriComposeAnimation.prototype.createStarImg=function(){for(var t=2*Math.PI/5-.0096,e=0;e<5;e++){var i=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_star_illume_1"});i.rotation=-t*e+5e-4,this.starImgList.push(i),i.visible=!1,i.y=3*this.dpr,i.x=-2*this.dpr}this.add(this.starImgList)},FuriComposeAnimation.prototype.createItem=function(){for(var t=0;t<5;t++){var e=new f(this.scene,this.dpr,this.zoom);this.itemList.push(e),e.on(a.ClickEvent.Tap,this.onItemHandler,this)}this.add(this.itemList),this.layoutItemsPosition()},FuriComposeAnimation.prototype.layoutItemsPosition=function(){for(var t=3*Math.PI/2-2*Math.PI/5,e=108*this.dpr,i=0;i<this.itemList.length;i++){var n=this.itemList[i],a=t-2*Math.PI/5*i;n.y=Math.sin(a)*e,n.x=Math.cos(a)*e}},FuriComposeAnimation.prototype.displayStarImg=function(){for(var t=0,e=0;e<this.indexeds.length;e++){var i=this.indexeds[e];this.starImgList[e].visible=0!==i,0===i?this.starImgList[e].visible=!1:(this.starImgList[e].visible=!0,t++)}if(5===t){this.bglightstar.visible=!0;for(var n=0,a=this.starImgList;n<a.length;n++){a[n].visible=!1}}else this.bglightstar.visible=!1},FuriComposeAnimation.prototype.playAnimation=function(){this.canPlay=!0,this.timerID||(this.timerID=setInterval(this.update.bind(this),20))},FuriComposeAnimation.prototype.stopAnimation=function(){this.canPlay=!1,this.bgring1.rotation=0,this.bgring2.rotation=0,this.bgring3.rotation=0,this.timerID&&(this.timerID=clearInterval(this.timerID),this.timerID=void 0)},FuriComposeAnimation.prototype.onItemHandler=function(t,e){var i=this.itemList.indexOf(e);this.removeItemData(i)},FuriComposeAnimation.prototype.playMove=function(t,e,i,n){var a=this;if(this.scene){var s=this.scene.tweens.add({targets:t,x:{value:0},y:{value:3*this.dpr},ease:"Linear",duration:n,onComplete:function(){s.stop(),s.remove(),a.clearItemDatas(!1)}});this.tweens.push(s)}},FuriComposeAnimation.prototype.stopTweens=function(){for(var t=0,e=this.tweens;t<e.length;t++){var i=e[t];i.stop(),i.remove()}this.tweens.length=0},FuriComposeAnimation}(Phaser.GameObjects.Container),f=function(t){function FuriComposeItem(e,i,n){var a=t.call(this,e,0,0)||this;return a.dpr=i,a.zoom=n,a.init(),a.setSize(a.bg.width,a.bg.height),a.enable=!0,a}return d(FuriComposeItem,t),FuriComposeItem.prototype.setItemData=function(t){if(this.itemData=t,this.lightbg.alpha=0,this.icon.alpha=0,t){var e=c.Url.getOsdRes(t.texturePath);this.icon.load(e),this.icon.visible=!0,this.playAlphaAni([this.icon,this.lightbg])}else this.icon.visible=!1},FuriComposeItem.prototype.init=function(){this.bg=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_default"}),this.lightbg=this.scene.make.image({key:h.d.effectcommon,frame:"synthetic_Light"}),this.icon=new s.DynamicImage(this.scene,0,0),this.icon.scale=this.dpr/this.zoom,this.add([this.bg,this.lightbg,this.icon]),this.lightbg.alpha=0,this.icon.alpha=0},FuriComposeItem.prototype.playAlphaAni=function(t){if(this.scene)var e=this.scene.tweens.add({targets:t,alpha:{from:0,to:1},ease:"Linear",duration:300,onComplete:function(){e.stop(),e.remove()}})},FuriComposeItem}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaGiftEffectPanel",(function(){return c}));var n,a=i(479),s=i(0),o=i(517),h=i(519),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaGiftEffectPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=s.ModuleName.PICAGIFTEFFECT_NAME,i}return l(PicaGiftEffectPanel,t),PicaGiftEffectPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;this.content.x=n/2,this.content.y=a/2,t.prototype.resize.call(this,n,a),this.setSize(n*this.scale,a*this.scale)},PicaGiftEffectPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||this.mInitialized||this.preload()},PicaGiftEffectPanel.prototype.preload=function(){this.addAtlas(this.key,"gifteffect/gifteffect.png","gifteffect/gifteffect.json"),t.prototype.preload.call(this)},PicaGiftEffectPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.laterctPanel=new o.PicaGiftLaterctPanel(this.scene,this.mWorld,e,i,this.key,this.dpr),this.playerPanel=new h.PicaGiftPlayerPanel(this.scene,this.mWorld,e,i,this.key,this.dpr),this.content.add(this.laterctPanel),this.content.add(this.playerPanel),this.resize(0,0),t.prototype.init.call(this),this.play(void 0)},PicaGiftEffectPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaGiftEffectPanel.prototype.play=function(t){this.mInitialized&&(this.laterctPanel.play(t),this.playerPanel.play(t))},PicaGiftEffectPanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaHousePanel",(function(){return d}));var n,a=i(6),s=i(479),o=i(520),h=i(0),l=i(2),c=i(21),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaHousePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAHOUSE_NAME,i}return p(PicaHousePanel,t),PicaHousePanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n),this.itemsPanel.y=.5*this.height-60*this.dpr,this.itemsPanel.x=.5*this.width},PicaHousePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicaHousePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicaHousePanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on("pointerup",this.onCloseHandler,this),this.editorRoomBtn.on("pointerup",this.onEnterEditorHandler,this))},PicaHousePanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off("pointerup",this.onCloseHandler,this),this.editorRoomBtn.off("pointerup",this.onEnterEditorHandler,this))},PicaHousePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaHousePanel.prototype.setRoomInfoData=function(t,e){if(void 0===e&&(e=!0),this.mRoomInfoData=t,this.mInitialized){var i=295*this.dpr,n=370*this.dpr;"store"===t.roomType?(n=460*this.dpr,this.content.setSize(i,n),this.bg.resize(i,n),this.roomInfoBtn.y=.5*-this.content.height-.5*this.roomInfoBtn.height+5*this.dpr,this.roomSettingBtn.y=this.roomInfoBtn.y,this.closeBtn.y=.5*-this.bg.height+5*this.dpr,this.editorRoomBtn.y=.5*this.content.height-30*this.dpr,this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr):this.closeShopBtn.visible=!1,this.houseInfoPanel.setAttributeData(t,e),this.roomSettingBtn.visible=e,this.editorRoomBtn.visible=e}},PicaHousePanel.prototype.on_REFURBISH_REQUIREMENTS=function(t){var e=this;this.itemsPanel.setHandler(new l.Handler(this,(function(){e.render.renderEmitter(h.ModuleName.PICAHOUSE_NAME+"_queryrefurbish",e.mRoomInfoData.roomId)}))),this.itemsPanel.setItemDatas(t.requirements)},PicaHousePanel.prototype.preload=function(){this.addAtlas(this.key,"room_information/room_information.png","room_information/room_information.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(c.c.common2Key,c.d.common2Url+".png",c.d.common2Url+".json"),t.prototype.preload.call(this)},PicaHousePanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,i,n),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var p=295*this.dpr,d=370*this.dpr;this.content.setSize(p,d),this.bg=new a.NineSlicePatch(this.scene,0,0,p,d,c.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:c.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.roomInfoBtn=this.createTabButton(l.i18n.t("room_info.infobtn"),"small_information"),this.roomSettingBtn=this.createTabButton(l.i18n.t("room_info.setting"),"small_setting"),this.roomInfoBtn.setPosition(.5*-this.roomInfoBtn.width-2*this.dpr,.5*-this.content.height-.5*this.roomInfoBtn.height+3*this.dpr),this.roomSettingBtn.setPosition(.5*this.roomSettingBtn.width+2*this.dpr,this.roomInfoBtn.y),this.topCheckBox=new s.CheckboxGroup,this.topCheckBox.appendItemAll([this.roomInfoBtn,this.roomSettingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.roomInfoBtn,this.roomSettingBtn]),this.houseInfoPanel=new o.PicaHouseInfoPanel(this.scene,0,0,this.content.width-40*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr),this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr,this.houseInfoPanel.setHandler(new l.Handler(this,(function(){e.itemsPanel.visible=!0,e.add(e.itemsPanel),e.itemsPanel.resetMask(),e.mRoomInfoData.undepreciated<1?e.render.renderEmitter(h.ModuleName.PICAHOUSE_NAME+"_queryrequirements",e.mRoomInfoData.roomId):(e.itemsPanel.setContent(l.i18n.t("room_info.renovatetips")),e.itemsPanel.setHandler(null))}))),this.content.add(this.houseInfoPanel),this.closeShopBtn=new a.NineSliceButton(this.scene,0,this.houseInfoPanel.height-30*this.dpr,94*this.dpr,29*this.dpr,this.key,"close_shop",l.i18n.t("room_info.closeshop"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.closeShopBtn.setTextStyle({color:"#C12914",fontSize:12*this.dpr,fontFamily:l.Font.DEFULT_FONT});var u=this.houseInfoPanel.y+.5*this.houseInfoPanel.height+.5*this.closeShopBtn.height+20*this.dpr;this.closeShopBtn.y=u,this.houseInfoPanel.add(this.closeShopBtn),this.closeShopBtn.visible=!1;var m=.5*this.content.height;this.editorRoomBtn=new a.NineSliceButton(this.scene,0,m-30*this.dpr,100*this.dpr,35*this.dpr,c.c.commonKey,"button_g",l.i18n.t("room_info.editorroom"),this.dpr,this.scale,{left:16*this.dpr,top:16*this.dpr,right:16*this.dpr,bottom:16*this.dpr}),this.editorRoomBtn.setTextStyle({color:"#022B55",fontSize:12*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.editorRoomBtn.setTextOffset(10*this.dpr,0);var f=.5*-this.editorRoomBtn.width+8*this.dpr,y=this.scene.make.image({x:f,y:-3*this.dpr,key:this.key,frame:"renovation"});y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.editorRoomBtn.add(y),this.content.add(this.editorRoomBtn),this.editorRoomBtn.visible=!1,this.topCheckBox.selectIndex(0),this.itemsPanel=new s.ItemsConsumeFunPanel(this.scene,278*this.dpr,198*this.dpr,this.dpr,this.scale),this.itemsPanel.createBackGrphaic(i,n),this.itemsPanel.setTextInfo(l.i18n.t("room_info.renovate").toUpperCase(),l.i18n.t("room_info.needmaterials")),this.itemsPanel.visible=!1,this.add(this.content),this.resize(0,0),t.prototype.init.call(this)}},PicaHousePanel.prototype.updateData=function(){this.mRoomInfoData&&this.setRoomInfoData(this.mRoomInfoData)},PicaHousePanel.prototype.onTabBtnHandler=function(t){this.roomInfoBtn===t?this.houseInfoPanel.visible=!0:this.houseInfoPanel.visible=!1,this.roomSettingBtn===t&&(this.houseInfoPanel.visible=!1)},PicaHousePanel.prototype.createTabButton=function(t,e){var i=new a.TabButton(this.scene,this.key,"default tab","check tab",t);i.setTextStyle({fontFamily:l.Font.DEFULT_FONT,fontSize:12*this.dpr,color:"#ffffff"}),i.setTextOffset(13*this.dpr,0);var n=this.scene.make.image({key:this.key,frame:e});return i.add(n),n.x=.5*-i.width+.5*n.width+7*this.dpr,i},PicaHousePanel.prototype.onCloseShopHandler=function(){this.render.renderEmitter(h.ModuleName.PICAHOUSE_NAME+"_closeshop",this.mRoomInfoData)},PicaHousePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.ModuleName.PICAHOUSE_NAME+"_hide")},PicaHousePanel.prototype.onEnterEditorHandler=function(){this.render.renderEmitter(h.ModuleName.PICAHOUSE_NAME+"_scenedecorate")},PicaHousePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaItemPopCardPanel",(function(){return p}));var n,a=i(653),s=i(479),o=i(0),h=i(2),l=i(482),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaItemPopCardPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mPressDelay=1e3,i.key=o.ModuleName.PICAITEMPOPCARD_NAME,i.setTween(!1),i}return c(PicaItemPopCardPanel,t),PicaItemPopCardPanel.prototype.addListen=function(){this.mInitialized&&(this.mDetailDisplay.on("show",this.onShowHandler,this),this.on("pointerup",this.onCloseHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mNickName.on("pointerup",this.onPointerNickNameHandler,this),this.mNickName.on("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.on("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.on("pointerup",this.onPointerNickNameHandler,this))},PicaItemPopCardPanel.prototype.removeListen=function(){this.mInitialized&&(this.mDetailDisplay.off("show",this.onShowHandler,this),this.off("pointerup",this.onCloseHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mNickName.off("pointerup",this.onPointerNickNameHandler,this),this.mNickName.off("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.off("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.off("pointerup",this.onPointerNickNameHandler,this))},PicaItemPopCardPanel.prototype.resize=function(e,i){var n=this.render.uiScale,a=this.scene.cameras.main.width/n,s=this.scene.cameras.main.height/n,o=this.scene.cameras.main.centerX/n,h=this.scene.cameras.main.centerY/n;this.setSize(a,s),this.mCardContainer.x=o,this.mCardContainer.y=h,this.mCloseBtn.x=o,this.mCloseBtn.y=h+this.mCardContainer.height/2+48*this.dpr,t.prototype.resize.call(this,e,i)},PicaItemPopCardPanel.prototype.setProp=function(){if(this.mShowData){var t=this.mShowData[0].prop;if(t){this.mDesText.setText(t.des),this.mNickName.setText(t.name),t.source?this.mSource.setText(t.source):this.mSource.setText("");var e=this.mShowData[0].display;e&&(e.display?this.mDetailDisplay.loadDisplay(e):e.avatar?this.mDetailDisplay.loadAvatar(e.avatar):this.mDetailDisplay.loadUrl(t.icon))}}},PicaItemPopCardPanel.prototype.preload=function(){this.addAtlas(this.key,"item_pop_card/item_pop_card.png","item_pop_card/item_pop_card.json"),t.prototype.preload.call(this)},PicaItemPopCardPanel.prototype.init=function(){this.mCardContainer=this.scene.make.container({width:325*this.dpr,height:468*this.dpr},!1),this.mCardContainer.setSize(325*this.dpr,468*this.dpr),this.mCardContainer.setInteractive(),this.mBorder=this.scene.make.graphics(void 0,!1),this.mBorder.fillGradientStyle(7304703,7304703,118271,118271),this.mBorder.fillRect(-this.mCardContainer.width/2,-this.mCardContainer.height/2,this.mCardContainer.width,this.mCardContainer.height);var e=this.scene.make.image({key:this.key,frame:"bg.png"},!1);e.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),e.y=23*this.dpr-e.height/2;var i=this.scene.make.image({y:42*this.dpr,key:this.key,frame:"name_bg.png"});i.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mNickName=this.scene.make.text({y:42*this.dpr,style:{fontSize:18*this.dpr,fontFamily:h.Font.DEFULT_FONT}},!1).setOrigin(.5).setInteractive();var n=this.scene.make.image({y:138*this.dpr,key:this.key,frame:"des_bg.png"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mDesText=this.scene.make.text({x:n.x-n.width/2+12*this.dpr,y:n.y-n.height/2+10*this.dpr,style:{fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT,wordWrap:{width:240*this.dpr,useAdvancedWrap:!0}}},!1).setInteractive(),this.mDetailDisplay=new l.DetailDisplay(this.scene,this.render),this.mDetailDisplay.setFixedScale(2*this.dpr/this.scale),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close.png"},!1).setInteractive(),this.mCloseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mSource=this.scene.make.text({x:n.x-n.width/2+12*this.dpr,y:n.y+n.height/2-23*this.dpr,style:{fontSize:10*this.dpr,fontFamily:h.Font.DEFULT_FONT}},!1),this.add(this.mCardContainer),this.mCardContainer.add([this.mBorder,e,n,this.mDetailDisplay,i,this.mNickName,this.mDesText,this.mSource]),this.add(this.mCloseBtn),this.resize(0,0),t.prototype.init.call(this),this.setInteractive(),this.setProp()},PicaItemPopCardPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_close"),clearTimeout(this.mPressTime),this.mNickNameDown=!1},PicaItemPopCardPanel.prototype.onPointerNickNameHandler=function(){clearTimeout(this.mPressTime),this.mNickNameDown=!1},PicaItemPopCardPanel.prototype.onPointerNickNameDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyName()}),this.mPressDelay)},PicaItemPopCardPanel.prototype.onPointerDesDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyDes()}),this.mPressDelay)},PicaItemPopCardPanel.prototype.copyName=function(){if(this.mNickName){a(this.mNickName.text);var t={noticeContext:h.i18n.t("item.copy_suc",{name:h.i18n.t("item.name")})};this.render.renderEmitter(o.MessageType.SHOW_NOTICE,{content:t})}},PicaItemPopCardPanel.prototype.copyDes=function(){if(this.mDesText){a(this.mDesText.text);var t={noticeContext:h.i18n.t("item.copy_suc",{name:h.i18n.t("item.des")})};this.render.renderEmitter(o.MessageType.SHOW_NOTICE,{content:t})}},PicaItemPopCardPanel.prototype.onShowHandler=function(t){this.mDetailDisplay.y=-this.mCardContainer.height/4},PicaItemPopCardPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaManorListPanel",(function(){return d}));var n,a=i(479),s=i(21),o=i(0),h=i(2),l=i(521),c=i(522),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaManorListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAMANORLIST_NAME,i}return p(PicaManorListPanel,t),PicaManorListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,n,a)},PicaManorListPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaManorListPanel.prototype.addListen=function(){this.mInitialized},PicaManorListPanel.prototype.removeListen=function(){this.mInitialized},PicaManorListPanel.prototype.preload=function(){this.addAtlas(this.key,"manor/manor.png","manor/manor.json"),this.addAtlas(s.c.commonKey,s.d.commonUrl+".png",s.d.commonUrl+".json"),this.addAtlas(s.c.common2Key,s.d.common2Url+".png",s.d.common2Url+".json"),t.prototype.preload.call(this)},PicaManorListPanel.prototype.init=function(){var e=this.scale,i=this.scaleWidth,n=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i*e,n*e),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var a=90*this.dpr,s=74*this.dpr,o=295*this.dpr,c=n-a-s,p=a+.5*c,d=.5*i;this.content=new l.PicaManorContentPanel(this.scene,d,p,o,c,this.dpr,this.key),this.content.setCloseHandler(new h.Handler(this,this.OnCloseHandler)),this.add(this.content),this.resize(i,n),t.prototype.init.call(this),this.openManorList()},PicaManorListPanel.prototype.setManorList=function(t){this.picScrollPanel.setManorListData(t)},PicaManorListPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaManorListPanel.prototype.openManorList=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_querylist"),this.showScrollPanel(),this.content.setTitleText(h.i18n.t("manor.title"))},PicaManorListPanel.prototype.showScrollPanel=function(){var t=this,e=90*this.dpr,i=74*this.dpr;if(this.setContentSize(e,i),!this.picScrollPanel){var n=this.content.width,a=this.content.height-50*this.dpr;this.picScrollPanel=new c.PicaManorScrollPanel(this.scene,0,0,n,a,this.dpr,this.scale,this.key),this.picScrollPanel.setHandler(new h.Handler(this,(function(e){t.render.renderEmitter(o.RENDER_PEER+"_"+t.key+"_queryenter",e)})))}this.content.add(this.picScrollPanel),this.picScrollPanel.resetMask()},PicaManorListPanel.prototype.hideScrollPanel=function(){this.content.remove(this.picScrollPanel)},PicaManorListPanel.prototype.setContentSize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight,a=334*this.dpr,s=452*this.dpr,o=.5*n,h=.5*i;this.content.setPosition(h,o),this.content.setContentSize(a,s)},PicaManorListPanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")},PicaManorListPanel.prototype.onSelectItemHandler=function(t){},PicaManorListPanel}(a.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMarketPanel",(function(){return u}));var n,a=i(523),s=i(525),o=i(6),h=i(479),l=i(0),c=i(2),p=i(21),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaMarketPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=l.ModuleName.PICAMARKET_NAME,i.mSubTabs=[],i.mTabs=[],i}return d(PicaMarketPanel,t),PicaMarketPanel.prototype.addListen=function(){this.mInitialized&&(this.mSelectItem.on("buyItem",this.onBuyItemHandler,this),this.mSelectItem.on("popItemCard",this.onPopItemCardHandler,this))},PicaMarketPanel.prototype.removeListen=function(){this.mInitialized&&(this.mSelectItem.off("buyItem",this.onBuyItemHandler,this),this.mSelectItem.off("popItemCard",this.onPopItemCardHandler,this))},PicaMarketPanel.prototype.resize=function(t,e){var i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.mTIle.x=i/2;var a=290*this.dpr;this.mBackgroundColor.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mShelfContainer.setSize(i,a),this.mShelfContainer.setPosition(0,n-this.mShelfContainer.height),this.mShelfBackground.clear(),this.mShelfBackground.fillStyle(183551),this.mShelfBackground.fillRect(0,0,this.mShelfContainer.width,this.mShelfContainer.height),this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSelectItem.resize(i,n),this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,i,40*this.dpr),this.mCategoriesBar.fillStyle(308179),this.mCategoriesBar.fillRect(0,40*this.dpr,i,3*this.dpr),this.mSubCategeoriesContainer.setSize(i,43*this.dpr)},PicaMarketPanel.prototype.setCategories=function(t){if(this.mCategoriesContainer){this.mCategoriesContainer.removeAll(!0);var e=t.marketCategory;this.mTabs=[];var i=this.scene.textures.getFrame(this.key,"categories_normal"),n=60;i&&(n=i.width,i.height);for(var a={left:n/2,top:12*this.dpr,right:4*this.dpr,bottom:2*this.dpr},s=new h.CheckboxGroup,l=77*this.dpr,p=38*this.dpr,d=0;d<e.length;d++){var u=new o.NinePatchTabButton(this.scene,l,p,this.key,"categories_normal","categories_down",e[d].category.value,[a],1,1);u.setTextStyle({fontSize:18*this.dpr,fontFamily:c.Font.DEFULT_FONT}),this.mTabs[d]=u,u.setData("category",e[d]),u.x=80*d*this.dpr+l/2,u.y=p/2}this.mCategoriesContainer.setSize(this.mTabs.length*l,p),this.mShelfContainer.add(this.mTabs),this.layoutCategories(),s.on("selected",this.onSelectCategoryHandler,this),s.appendItemAll(this.mTabs),s.selectIndex(0)}},PicaMarketPanel.prototype.setProp=function(t){this.clearCategories(this.mItems),this.mItems=[];var e=t.commodities;this.mPropGrid.setItems(e),this.mPropGrid.layout(),this.mPropGrid.setT(0),e.length>0&&this.onSelectItemHandler(e[0])},PicaMarketPanel.prototype.setCommodityResource=function(t){this.mSelectItem&&(this.mSelectItem.setResource(t),this.mSelectItem.setData("display",t))},PicaMarketPanel.prototype.destroy=function(){this.mSubCategorisScroll&&this.mSubCategorisScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaMarketPanel.prototype.onPropConfirmHandler=function(t,e){this.render.renderEmitter(this.key+"_buyItem",t)},PicaMarketPanel.prototype.layoutCategories=function(){this.mCategoriesBar.y=this.mCategoriesContainer.height+this.mShelfContainer.y,this.mSubCategeoriesContainer.addAt(this.mCategoriesBar,0),this.mPropContainer.y=this.mSubCategeoriesContainer.y+43*this.dpr+this.mSubCategeoriesContainer.height+9*this.dpr,this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSubCategorisScroll.y=this.mCategoriesBar.y+25*this.dpr,this.randomCon.y=this.mSubCategorisScroll.y,this.mPropGrid.y=this.mCategoriesBar.y+this.mSubCategeoriesContainer.height+.5*this.mPropGrid.height+5*this.dpr,this.mPropGrid.layout(),this.mSubCategorisScroll.layout(),this.mSubCategorisScroll.resetMask(),this.mPropGrid.resetMask()},PicaMarketPanel.prototype.preload=function(){this.addAtlas(this.key,"market/market.png","market/market.json"),this.addAtlas(p.c.commonKey,p.d.commonUrl+".png",p.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMarketPanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,i,n),this.add(this.mBackgroundColor),this.mShelfContainer=this.scene.make.container({x:i/2,y:n},!1).setSize(i,290*this.dpr);for(var l=this.scene.textures.getFrame(this.key,"bg"),d=Math.ceil(i/l.width),u=Math.ceil((n-this.mShelfContainer.height+l.height)/l.height),m=0;m<d;m++)for(var f=0;f<u;f++){var y=this.scene.make.image({x:m*l.width,y:f*l.height,key:this.key,frame:"bg"},!1);y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.add(y)}this.mShelfBackground=this.scene.make.graphics(void 0,!1),this.mCloseBtn=new o.Button(this.scene,p.d.uicommon,"back_arrow","back_arrow"),this.mCloseBtn.setPosition(21*this.dpr,35*this.dpr),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains),this.mCloseBtn.on(o.ClickEvent.Tap,this.onCloseHandler,this),this.mPropContainer=this.scene.make.container(void 0,!1),this.mCategoriesContainer=this.scene.make.container(void 0,!1),this.mSubCategeoriesContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.add([this.mShelfBackground,this.mCategoriesContainer,this.mPropContainer]),this.add([this.mShelfContainer,this.mSubCategeoriesContainer]),this.mSelectItem=new a.ElementDetail(this.scene,this.render,this.key,this.dpr,this.scale),this.mSelectItem.setSize(i,n-this.mShelfContainer.height),this.mTIle=this.scene.make.text({text:c.i18n.t("market.title"),y:30*this.dpr,style:{fontSize:36*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(.5),this.add([this.mTIle,this.mSelectItem,this.mCloseBtn]),t.prototype.init.call(this),this.mCategoriesBar=this.scene.make.graphics(void 0,!1);var g=56*this.dpr,P=41*this.dpr,_={x:i/2,y:0,table:{width:i,height:50*this.dpr,cellWidth:g,cellHeight:P,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new h.TextButton(n,e.dpr)),i.getData("item")!==a&&(i.setText(a.value),i.setData({item:a}),a&&e.mPreSubCategoris&&e.mPreSubCategoris.key===a.key?i.changeDown():i.changeNormal()),i}};this.mSubCategorisScroll=new o.GameGridTable(this.scene,_),this.mSubCategorisScroll.on("cellTap",(function(t,i){e.onSelectSubCategoryHandler(t)})),this.add(this.mSubCategorisScroll),this.randomCon=this.scene.make.container(void 0,!1),this.randomCon.x=.5*i,this.randomCon.visible=!1,this.add(this.randomCon),this.randomRefeshTime=this.scene.make.text({x:.5*-i+10*this.dpr,y:-12*this.dpr,text:c.i18n.t("market.refreshtime"),style:{color:"#007AAE",fontSize:13*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5);var v=80*this.dpr,b=30*this.dpr;this.randomRefreshBtn=new o.NineSliceButton(this.scene,.5*i,this.randomRefeshTime.y,v,b,p.c.commonKey,"button_g",c.i18n.t("market.refresh"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.randomRefreshBtn.x=.5*i-.5*this.randomRefreshBtn.width-10*this.dpr,this.randomRefreshBtn.setTextOffset(0,5*this.dpr),this.randomRefreshBtn.setTextStyle({color:"#0",fontSize:13*this.dpr,fontFamily:c.Font.DEFULT_FONT}),this.randomRefreshBtn.setFontStyle("bold"),this.refreshIcon=this.scene.make.image({key:p.c.commonKey,frame:"iv_coin"}).setScale(.8),this.refreshIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.refreshIcon.setPosition(-10*this.dpr,-8*this.dpr),this.refreshNeedCount=this.scene.make.text({x:0*this.dpr,y:this.refreshIcon.y,text:"100",style:{fontSize:10*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),this.randomRefreshBtn.add([this.refreshIcon,this.refreshNeedCount]),this.randomCon.add([this.randomRefeshTime,this.randomRefreshBtn]);var T=this.scene.textures.getFrame(this.key,"border"),S=T.width+6*this.dpr,x=T.height+10*this.dpr,w={x:i/2+4*this.dpr,y:0,table:{width:i,height:224*this.dpr,columns:3,cellWidth:S,cellHeight:x,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale,mask:!1},scroller:{backDeceleration:!1,slidingDeceleration:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new s.MarketItem(n,0,0,e.dpr,e.scale)),i.setData({item:a}),i.setProp(a),i}};this.mPropGrid=new o.GameGridTable(this.scene,w),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var i=t.getData("item");i&&e.onSelectItemHandler(i)})),this.add(this.mPropGrid),this.resize(0,0),this.render.renderEmitter(this.key+"_getCategories")}},PicaMarketPanel.prototype.setSelect=function(){},PicaMarketPanel.prototype.clearCategories=function(t){t&&(t.map((function(t){return t.destroy()})),t=void 0)},PicaMarketPanel.prototype.onSelectCategoryHandler=function(t){if(this.mSubCategeoriesContainer){this.mSubCategorisScroll.setT(0),this.mPreSubCategoris=null,this.clearCategories(this.mSubTabs);var e=t.getData("category");if(this.mSelectedCategories=t,e){var i=e.subcategory;if(this.mSubCategorisScroll){this.mSubCategorisScroll.setItems(i),this.mSubCategorisScroll.layout();var n=this.mSubCategorisScroll.getCell(0);this.onSelectSubCategoryHandler(n.container)}}}},PicaMarketPanel.prototype.onSelectSubCategoryHandler=function(t){if(this.mSelectedCategories&&t instanceof h.TextButton){var e=this.mSelectedCategories.getData("category");if(e){var i=t.getData("item");i&&(this.queryProp(e.category.key,i.key),this.mPreSubCategoris=i,this.mPreSubCategorisItem&&this.mPreSubCategorisItem.changeNormal(),t.changeDown(),this.mPreSubCategorisItem=t)}}},PicaMarketPanel.prototype.queryProp=function(t,e){this.render.renderEmitter(this.key+"_queryProp",{page:1,category:t,subCategory:e})},PicaMarketPanel.prototype.onSelectItemHandler=function(t){if(this.mSelectItem.setProp(t),this.mSelectItem.setData("propdata",t),t.suitType&&""!==t.suitType){var e=this.getCommodityResource(t);this.setCommodityResource(e)}else this.render.renderEmitter(this.key+"_queryPropResource",t)},PicaMarketPanel.prototype.onBuyItemHandler=function(t){var e=this.getBuyPackageData();e.count=t.quantity;var i=e,n=c.i18n.t("market.payment"),a=this.mSelectItem.getData("display"),s={key:this.key,confirmFunc:"onPropConfirmHandler",confirmAddData:t};this.showPropFun({resultHandler:s,data:i,resource:a,slider:!1,title:n})},PicaMarketPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaMarketPanel.prototype.onPopItemCardHandler=function(t,e){t&&this.render.renderEmitter(this.key+"_popItemCard",{prop:t,display:e})},PicaMarketPanel.prototype.getBuyPackageData=function(){var t=this.mSelectItem.getData("propdata"),e={id:null,sellingPrice:null,name:null,shortName:null,count:1};return e.id=t.id,e.sellingPrice=t.price[0],e.name=t.name,e.shortName=t.shortName,e},PicaMarketPanel.prototype.showPropFun=function(t){this.render.mainPeer.showMediator(l.ModuleName.PICAPROPFUN_NAME,!0,t)},PicaMarketPanel.prototype.getCommodityResource=function(t){var e={};return e.avatar=l.AvatarSuitType.createAvatarBySn(t.suitType,t.sn,t.slot,t.tag,t.version),e.suits=[{suit_type:t.suitType,sn:t.sn,tag:t.tag,version:t.version}],e},PicaMarketPanel}(h.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMessageBoxPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(0),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaMessageBoxPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAMESSAGEBOX_NAME,i}return l(PicaMessageBoxPanel,t),PicaMessageBoxPanel.prototype.show=function(t){if(this.mShowData=t,!this.mPreLoad)if(this.mInitialized){var e=t;this.mButtons=[],e&&(e.text&&e.text[0]&&(this.mText.setText(e.text[0].text),this.mText.x=-this.mText.width/2,this.mText.y=-this.mText.height),e.title&&this.mTitleLabel.setText(e.title.text));var i=e.button.sort((function(t,e){return t.param>e.param?1:-1}));if(i){var n=114*this.dpr,s=40*this.dpr,o=(this.width-30*this.dpr)/i.length;this.mButtonContaier.y=this.height/2-s;var l=this.scene.textures.getFrame(this.key,"yellow_btn_normal");if(!l)return;for(var c={left:13*this.dpr,top:13*this.dpr,bottom:l.width-2-13*this.dpr,right:l.height-2-13*this.dpr},p=.5*-(o*i.length),d=0;d<i.length;d++){var u=i[d]?i[d].text:"",m=i[d].param,f=1===m?"yellow_btn":"red_btn",y=1===m?h.Color.brownish:h.Color.white,g=new a.NineSliceButton(this.mScene,0,0,n,s,this.key,f,u,this.dpr,this.scale,c,void 0,i[d]);g.setTextStyle({fontFamily:h.Font.DEFULT_FONT,fontSize:16*this.dpr,color:y}),g.setFontStyle("bold"),g.x=p+.5*o,p+=o,this.mButtons.push(g),g.on(a.ClickEvent.Tap,this.onClickHandler,this)}this.mButtonContaier.add(this.mButtons),this.mButtonContaier.x=0}this.resize(0,0)}else this.preload()},PicaMessageBoxPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width,a=this.scene.cameras.main.height;this.x=n/2,this.y=a/2,t.prototype.resize.call(this,e,i),this.border.setInteractive(new Phaser.Geom.Rectangle(.5*-n,.5*-a,n,a),Phaser.Geom.Rectangle.Contains)},PicaMessageBoxPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_message_box/pica_message_box.png","pica_message_box/pica_message_box.json"),t.prototype.preload.call(this)},PicaMessageBoxPanel.prototype.init=function(){var e=this.scene.cameras.main,i=e.width,n=e.height,s=this.scene.make.graphics(void 0,!1);s.fillStyle(0,.6),s.fillRect(.5*-i,.5*-n,i,n),this.add(s),this.border=s;var o=this.scene.make.image({key:this.key,frame:"bg_universal_box"});this.add(o),this.setSize(o.width,o.height),this.closeBtn=new a.Button(this.scene,this.key,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-5*this.dpr,.5*-this.height+4*this.dpr),this.closeBtn.on(String(a.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.mButtonContaier=this.scene.make.container(void 0,!1);var l=this.scene.make.image({y:-o.height/2,key:this.key,frame:"title"});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mTitleLabel=this.scene.make.text({y:l.y-6*this.dpr,style:{fontFamily:h.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#3366cc"}},!1).setOrigin(.5),this.mText=new a.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr+"px",fontFamily:h.Font.DEFULT_FONT,color:"#000000",origin:{x:.5,y:.5},wrap:{mode:"char",width:this.width},align:"center"}),this.add([o,l,this.mTitleLabel,this.mText,this.mButtonContaier]),t.prototype.init.call(this),this.resize(i,n),this.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains)},PicaMessageBoxPanel.prototype.onClickHandler=function(t,e){if(e){var i=e.getBtnData();if(i)if(i.local){if(i.clickhandler){var n=this.render.uiManager.getPanel(""+i.clickhandler.key);if(n&&i.clickhandler.clickfun)n[i.clickhandler.clickfun].apply(n,i.data)}this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")}else this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_click",i)}},PicaMessageBoxPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(o.RENDER_PEER+"_"+this.key+"_hide")},PicaMessageBoxPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMineCarPanel",(function(){return p}));var n,a,s=i(6),o=i(479),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaMineCarPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.mFilterItem=[],i.key=h.ModuleName.PICAMINECAR_NAME,i.disInteractive(),i}return c(PicaMineCarPanel,t),PicaMineCarPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,e,i),this.setSize(n,a),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,n,a),this.mBg.x=n/2,this.mBg.y=this.mBg.displayHeight/2+107*this.dpr,this.carIcon.x=this.mBg.x/2-4*this.dpr,this.carIcon.y=this.mBg.y-(this.mBg.displayHeight-this.carIcon.displayHeight)/2+4*this.dpr,this.mCloseBtn.x=this.mBg.x+this.mBg.displayWidth/2,this.mCloseBtn.y=this.mBg.y-(this.mBg.displayHeight-this.mCloseBtn.displayHeight)/2+10*this.dpr,this.mCounter.x=this.mBg.x/2,this.mCounter.y=this.mBg.y+(this.mBg.displayHeight-this.mDiscardBtn.displayHeight)/2-16*this.dpr,this.mCounter.setResolution(this.dpr),this.mTips.x=this.mBg.x+20*this.dpr,this.mTips.y=this.mBg.y-this.mBg.displayHeight/2-15*this.dpr,this.mDiscardBtn.x=this.mBg.x+this.mBg.displayWidth/2-this.mDiscardBtn.displayWidth/2-9*this.dpr,this.mDiscardBtn.y=this.mBg.y+this.mBg.displayHeight/2-this.mDiscardBtn.displayHeight/2-9*this.dpr,this.categoriesBg.x=this.mBg.x,this.categoriesBg.y=this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+38*this.dpr,this.mPropGrid.refreshPos(this.mBg.x+2*this.dpr,this.mBg.y+6*this.dpr),this.mCategoryTable.refreshPos(this.mBg.x,this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+44*this.dpr),this.mPropGrid.resetMask(),this.mCategoryTable.resetMask()},PicaMineCarPanel.prototype.show=function(e){t.prototype.show.call(this,e)},PicaMineCarPanel.prototype.setCategories=function(t){this.mPreSelectedCategorie=void 0,this.mPreSelectedCategorieData=void 0,this.mCategoryTable.setItems(t)},PicaMineCarPanel.prototype.setCategoriesData=function(t){this.mDiscardBtn.changeState(a.Discard),this.setCategories(t)},PicaMineCarPanel.prototype.addListen=function(){this.mInitialized&&(this.removeListen(),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mDiscardBtn.on(s.ClickEvent.Tap,this.enterDiscardMode,this))},PicaMineCarPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mDiscardBtn.off(s.ClickEvent.Tap,this.enterDiscardMode,this))},PicaMineCarPanel.prototype.setProp=function(t,e){var i=t||[];this.mLimit=e||0,this.mFilterItem.length=0;for(var n=0,a=i;n<a.length;n++){var s=a[n];this.mFilterItem.push({item:s})}for(var o=this.mLimit-this.mFilterItem.length,h=0;h<o;h++)this.mFilterItem.push({item:null});this.mPropGrid.setItems(this.mFilterItem),this.mCounter.setText(i.length+"/"+this.mLimit)},PicaMineCarPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.mCategoryTable&&this.mCategoryTable.destroy(),t.prototype.destroy.call(this)},PicaMineCarPanel.prototype.queryRefreshPackage=function(){this.mPreSelectedCategorieData&&this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querypackage",{type:4,key:this.mPreSelectedCategorieData.key})},PicaMineCarPanel.prototype.preload=function(){this.addAtlas(this.key,"mine_car/mine_car.png","mine_car/mine_car.json"),t.prototype.preload.call(this)},PicaMineCarPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,i,n),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mBg=this.scene.make.image({key:this.key,frame:"bg.png"}),this.mBg.x=i/2,this.mBg.y=n/2,this.carIcon=this.scene.make.image({key:this.key,frame:"car_icon.png"},!1),this.carIcon.x=-(this.mBg.width-this.carIcon.width)/2+28*this.dpr,this.carIcon.y=-(this.mBg.height-this.carIcon.height/2)/2+10*this.dpr,this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1),this.mCloseBtn.setInteractive(),this.mCloseBtn.x=this.mBg.width/2,this.mCloseBtn.y=-(this.mBg.height-this.mCloseBtn.height)/2+10*this.dpr,this.mCloseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCounter=this.scene.make.text({text:"25/50",style:{fontFamily:l.Font.DEFULT_FONT,color:"#FFFFFF",fontSize:12*this.dpr}},!1),this.mCounter.x=-this.displayWidth/2+17*this.dpr,this.mCounter.y=this.displayHeight/2-18*this.dpr-this.mCounter.height,this.mCounter.setFontStyle("bold"),this.mTips=new u(this.scene,this.key,this.dpr),this.mTips.x=40*this.dpr,this.mTips.y=-(this.mBg.height+this.mTips.height)/2+15*this.dpr,this.mDiscardBtn=new m(this.scene,this.key,"yellow_btn.png",void 0,"丢弃"),this.mDiscardBtn.x=(this.mBg.width-this.mDiscardBtn.displayWidth)/2-17*this.dpr,this.mDiscardBtn.y=(this.mBg.height-this.mDiscardBtn.displayHeight)/2-10*this.dpr,this.mDiscardBtn.setTextStyle({color:"##996600",fontFamily:l.Font.DEFULT_FONT,fontSize:10*this.dpr}),this.mDiscardBtn.changeState(a.Discard),this.categoriesBg=this.scene.make.image({key:this.key,frame:"nav_bg.png"}),this.categoriesBg.y=-(this.displayHeight-this.categoriesBg.displayHeight)/2+36*this.dpr;var o=this.scene.textures.getFrame(this.key,"item_border.png"),c=o.width+4*this.dpr,p=o.height+4*this.dpr,y=236*this.dpr,g={x:-7*this.dpr,y:-16*this.dpr,table:{width:y,height:295*this.dpr,columns:4,cellsCount:25,cellWidth:c,cellHeight:p,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new d(n,e.key,e.dpr)),i.setData({item:a}),i.setProp(a),i}};this.mPropGrid=new s.GameGridTable(this.scene,g),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){e.onSelectItemHandler(t)}));var P=this.scene.textures.getFrame(this.key,"nav_btn_normal.png"),_={x:-9*this.dpr,y:-155*this.dpr,table:{width:y,height:this.categoriesBg.displayHeight,cellWidth:P.width+4*this.dpr,cellHeight:P.height,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&((i=new f(n,e.key,"nav_btn_normal.png","nav_btn_down.png","1")).setTextStyle({color:"#566ddb",fontFamily:l.Font.DEFULT_FONT,fontSize:10*e.dpr}),i.setFontStyle("bold")),i.setText(a.value),i.setData("data",a),e.mPreSelectedCategorieData===a?(i.changeDown(),e.mPreSelectedCategorie=i):i.changeNormal(),e.mPreSelectedCategorie||e.onClickCategoryHandler(i),i}};this.mCategoryTable=new s.GameGridTable(this.scene,_),this.mCategoryTable.layout(),this.mCategoryTable.on("cellTap",(function(t){e.onClickCategoryHandler(t)})),this.add([this.mBackGround,this.mBg,this.carIcon,this.mCounter,this.categoriesBg,this.mPropGrid,this.mCategoryTable,this.mCloseBtn,this.mDiscardBtn]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querycategory")},PicaMineCarPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_close")},PicaMineCarPanel.prototype.onSelectItemHandler=function(t){if(this.mDiscardBtn&&this.mDiscardBtn.buttonState!==a.Discard)return t.switchSelect(),void this.checkMode();t&&t.item.item?(this.mTips.parentContainer||this.add(this.mTips),this.mTips.setItem(t.item.item)):this.remove(this.mTips)},PicaMineCarPanel.prototype.onClickCategoryHandler=function(t){var e=t.getData("data");e&&(this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querypackage",{type:4,key:e.key}),this.mPreSelectedCategorie&&this.mPreSelectedCategorie.changeNormal(),t.changeDown(),this.mPreSelectedCategorie=t,this.mPreSelectedCategorieData=e)},PicaMineCarPanel.prototype.checkMode=function(){if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var t=0,e=this.mFilterItem;t<e.length;t++){if(e[t].selected)return void this.mDiscardBtn.changeState(a.Sutmit)}this.mDiscardBtn.changeState(a.Cancel)}},PicaMineCarPanel.prototype.onDiscardSelectedItem=function(){var t=this;if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var e=[],i=[],n=0,a=this.mFilterItem;n<a.length;n++){var s=a[n];s.item&&s.selected&&(e.push(s.item),i.push(s.item.name+"*"+s.item.count))}new o.AlertView(this.uiManager).show({text:l.i18n.t("minecar.confirmation",{name:""+i.join("、")}),title:l.i18n.t("minecar.discard"),oy:302*this.dpr*this.render.uiScale,callback:function(){t.render.renderEmitter(h.RENDER_PEER+"_"+t.key+"_discard",e)}})}},PicaMineCarPanel.prototype.enterDiscardMode=function(){if(this.mFilterItem){var t=this.mDiscardBtn.buttonState,e=!1;t===a.Discard?(this.mDiscardBtn.changeState(a.Cancel),e=!0):(t===a.Sutmit&&this.onDiscardSelectedItem(),this.mDiscardBtn.changeState(a.Discard)),this.mFilterItem.length>0&&this.mFilterItem[0].selectVisible!==e&&(this.mFilterItem.map((function(t){t.selectVisible=e,t.selected=!1})),this.mPropGrid.setItems(this.mFilterItem))}},PicaMineCarPanel}(o.BasePanel),d=function(t){function PackageItem(e,i,n){var a=t.call(this,e)||this,s=a.scene.make.image({key:i,frame:"item_border.png"},!1).setOrigin(0);return a.setSize(s.width,s.height),a.mItemImage=new o.DynamicImage(a.scene,0,0),a.mItemImage.setOrigin(0),a.mItemImage.setScale(n),a.mCounter=a.scene.make.text({x:s.displayWidth-2*n,y:s.displayHeight-1*n,style:{fontFamily:l.Font.DEFULT_FONT,fontSize:9*n,color:"#566DDB"}}).setOrigin(1),a.mCounter.setFontStyle("bold"),a.mSelectedIcon=a.scene.make.image({key:i,frame:"icon_normal.png"},!1),a.mSelectedIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.mSelectedIcon.x=s.width-2*n-a.mSelectedIcon.width/2,a.mSelectedIcon.y=2*n+a.mSelectedIcon.height/2,a.add(s),a.add([a.mItemImage,a.mCounter,a.mSelectedIcon]),a}return c(PackageItem,t),PackageItem.prototype.setProp=function(t){this.itemData=t;var e=t.item;if(!t||!e)return this.mItemImage.visible=!1,this.mCounter.visible=!1,void(this.mSelectedIcon.visible=!1);this.itemData&&(this.mItemImage.load(l.Url.getOsdRes(e.display.texturePath),this,this.onLoadCompleteHandler),this.mItemImage.visible=!0,e.count>1?(this.mCounter.setText(e.count.toString()),this.mCounter.visible=!0):this.mCounter.visible=!1,this.mSelectedIcon.visible=!!this.itemData.selectVisible,this.setSelected())},PackageItem.prototype.switchSelect=function(){this.itemData.item&&(this.itemData.selected=!this.itemData.selected,this.setSelected())},Object.defineProperty(PackageItem.prototype,"item",{get:function(){return this.itemData},enumerable:!1,configurable:!0}),PackageItem.prototype.onLoadCompleteHandler=function(){this.mItemImage&&(this.mItemImage.x=this.width-this.mItemImage.displayWidth>>1,this.mItemImage.y=this.height-this.mItemImage.displayHeight>>1)},PackageItem.prototype.setSelected=function(){this.itemData.selected?this.mSelectedIcon.setFrame("icon_selected.png"):this.mSelectedIcon.setFrame("icon_normal.png")},PackageItem}(Phaser.GameObjects.Container),u=function(t){function Tips(e,i,n){var a=t.call(this,e)||this;a.mDpr=n;var s=a.scene.make.image({key:i,frame:"tips_bg.png"},!1);return s.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.mName=a.scene.make.text({x:-s.width/2+12*n,y:-s.height/2+5*n,style:{fontFamily:l.Font.DEFULT_FONT,fontSize:10*n,color:"#000000"}},!1),a.mDes=a.scene.make.text({x:a.mName.x,style:{fontFamily:l.Font.DEFULT_FONT,fontSize:10*n,color:"#000000"}},!1).setOrigin(0,1),a.add([s,a.mName,a.mDes]),a.setSize(s.width,s.height),a}return c(Tips,t),Tips.prototype.setItem=function(t){if(t){var e=this.y,i=this.alpha;this.y=e+50*this.mDpr,this.alpha=0,this.scene.tweens.add({targets:this,props:{alpha:i,y:e},duration:200,ease:Phaser.Math.Easing.Elastic.Out}),this.mName.setText(t.shortName||t.name),this.mDes.setText(t.des)}},Tips}(Phaser.GameObjects.Container),m=function(t){function DiscardButton(e,i,n,a,s){return t.call(this,e,i,n,a,s)||this}return c(DiscardButton,t),DiscardButton.prototype.changeState=function(t){if(this.mState!==t)switch(this.mState=t,t){case a.Cancel:this.setText("取消"),this.setFrame("gray_btn.png");break;case a.Sutmit:this.setText("提交"),this.setFrame("yellow_btn.png");break;default:this.setText("丢弃"),this.setFrame("yellow_btn.png")}},Object.defineProperty(DiscardButton.prototype,"buttonState",{get:function(){return this.mState},enumerable:!1,configurable:!0}),DiscardButton}(s.Button);!function(t){t[t.Discard=0]="Discard",t[t.Cancel=1]="Cancel",t[t.Sutmit=2]="Sutmit"}(a||(a={}));var f=function(t){function CategorieButton(e,i,n,a,s){var o=t.call(this,e,i,n,a,s)||this;return o.disInteractive(),o.removeListen(),o.mBackground.setOrigin(0,0),o.mText&&o.mText.setPosition(o.mBackground.width/2,o.mBackground.height/2),o}return c(CategorieButton,t),CategorieButton}(s.TabButton)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMineSettlePanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaMineSettlePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAMINESETTLE_NAME,i}return c(PicaMineSettlePanel,t),PicaMineSettlePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.bg.x=n/2,this.bg.y=a/2,this.titleimage.x=n/2,this.titleimage.y=this.bg.y-this.bg.displayHeight/2-8*this.dpr,this.confirmBtn.x=n/2,this.confirmBtn.y=this.bg.y+100*this.dpr,this.titleName.x=n/2,this.titleName.y=this.titleimage.y+32*this.dpr,this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,a),this.mPropGrid.refreshPos(n/2,this.bg.y-2*this.dpr),this.mPropGrid.resetMask(),this.setSize(n,a)},PicaMineSettlePanel.prototype.show=function(t){this.mShowData=t,this.refreshData(),this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaMineSettlePanel.prototype.addListen=function(){this.mInitialized&&this.confirmBtn.on(String(a.ClickEvent.Tap),this.onConfirmBtnClick,this)},PicaMineSettlePanel.prototype.removeListen=function(){this.mInitialized&&this.confirmBtn.off(String(a.ClickEvent.Tap),this.onConfirmBtnClick,this)},PicaMineSettlePanel.prototype.preload=function(){this.addAtlas(this.key,"minesettle/settlement.png","minesettle/settlement.json"),this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaMineSettlePanel.prototype.init=function(){var e=this,i=this.cameraWidth,n=this.cameraHeight;this.bg=new s.NinePatch(this.scene,0,0,293*this.dpr,260*this.dpr,this.key,"bg",{left:10,top:10,right:10,bottom:10}),this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains);var h=this.scene.textures.getFrame(this.key,"icon_test"),c=h.width+20*this.dpr,p=h.height+25*this.dpr,u={x:0,y:0,table:{width:280*this.dpr,height:160*this.dpr,columns:5,cellWidth:c,cellHeight:p,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,cellPadX:18*this.dpr,zoom:this.scale},clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new d(n,e.dpr)),i.setData({item:a}),i.setItemData(a),i}};this.mPropGrid=new a.GameGridTable(this.scene,u),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var i=t.itemData;i&&e.onSelectItemHandler(i)})),this.titleimage=this.scene.make.image({x:0,y:.5*-this.bg.displayWidth-10*this.dpr,key:this.key,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+32*this.dpr,text:l.i18n.t("minesettle.settle"),style:{fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,.5),this.confirmBtn=new a.NineSliceButton(this.scene,0,100*this.dpr,90*this.dpr,40*this.dpr,o.c.commonKey,"yellow_btn",l.i18n.t("minesettle.savebag"),this.dpr,this.scale,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.add([this.blackGraphic,this.bg,this.titleimage,this.titleName,this.confirmBtn]),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaMineSettlePanel.prototype.setMineSettlePacket=function(t){this.mInitialized&&this.mPropGrid.setItems(t.items)},PicaMineSettlePanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.confirmBtn&&this.confirmBtn.destroy(),this.mPropGrid=null,this.confirmBtn=null,t.prototype.destroy.call(this)},PicaMineSettlePanel.prototype.refreshData=function(){var t=this.getData("settleData");t&&this.setMineSettlePacket(t)},PicaMineSettlePanel.prototype.onSelectItemHandler=function(t){},PicaMineSettlePanel.prototype.onConfirmBtnClick=function(t){this.checkPointerDis(t)&&this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_hide")},PicaMineSettlePanel.prototype.checkPointerDis=function(t){return!this.render||Math.abs(t.downX-t.upX)<10*this.render.uiRatio*this.render.uiScale&&Math.abs(t.downY-t.upY)<10*this.render.uiRatio*this.render.uiScale},PicaMineSettlePanel}(s.BasePanel),d=function(t){function MineSettleItem(e,i){var n=t.call(this,e)||this;return n.dpr=i,n.icon=new s.DynamicImage(e,0,0),n.itemCount=n.scene.make.text({text:"600",style:{fontSize:18,fontFamily:l.Font.DEFULT_FONT}},!1),n.itemCount.setOrigin(.5,0),n.icon.setOrigin(0,0),n.icon.setScale(n.dpr),n.itemCount.setPosition(0,n.icon.height),n.add(n.icon),n.add(n.itemCount),n}return c(MineSettleItem,t),MineSettleItem.prototype.setItemData=function(t){var e=this;this.itemData=t,this.itemCount.setFontSize(14*this.dpr),this.itemCount.text=t.count+"";var i=l.Url.getOsdRes(t.texturePath);this.icon.load(i,this,(function(){e.icon.setScale(33*e.dpr/e.icon.width),e.icon.setPosition(0,3*e.dpr),e.itemCount.setPosition(.5*e.icon.displayWidth,e.icon.x+e.icon.displayHeight+3*e.dpr)}))},MineSettleItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.icon&&this.icon.destroy(),this.itemCount&&this.itemCount.destroy(),this.itemData=null,this.icon=null,this.itemCount=null,this.scene=null},MineSettleItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNavigatePanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaNavigatePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key_lang="key_lang",i.key=h.ModuleName.PICANAVIGATE_NAME,i.UIType=a.UIType.Scene,i.setTween(!1),i.setInteractive(),i}return c(PicaNavigatePanel,t),PicaNavigatePanel.prototype.resize=function(e,i){var n=this.scale;e=e||this.mBackground.width*n,i=i||this.mBackground.height*n,this.setSize(e,i);var a=this.scene.cameras.main.width/n,s=this.scene.cameras.main.height,h=a/this.scene.textures.getFrame(o.c.commonKey,"menu_bg").width*this.dpr;this.mBackground.scaleX=h,this.mBackground.x=a/2,this.mBackground.setInteractive(),this.mCloseBtn.x=a-this.mCloseBtn.width/2-3*this.dpr,this.mGoHomeBtn.x=this.mCloseBtn.x-.5*this.mCloseBtn.width-.5*this.mGoHomeBtn.width-24*this.dpr,this.y=s-this.height/2,t.prototype.resize.call(this,e,i)},PicaNavigatePanel.prototype.addListen=function(){this.mInitialized&&this.interactiveBoo&&(this.mMapBtn.on("pointerup",this.onShowMapHandler,this),this.mShopBtn.on("pointerup",this.onShowShopHandler,this),this.mBagBtn.on("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.on("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.removeListen=function(){this.mInitialized&&(this.mMapBtn.off("pointerup",this.onShowMapHandler,this),this.mShopBtn.off("pointerup",this.onShowShopHandler,this),this.mBagBtn.off("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.off("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.hide=function(){this.mShow=!1,t.prototype.hide.call(this),this.removeListen()},PicaNavigatePanel.prototype.show=function(e){t.prototype.show.call(this,e),this.checkUpdateActive(),this.addListen()},PicaNavigatePanel.prototype.updateUIState=function(t){this.mInitialized&&("picanavigate.mapbtn"===t.name&&(this.mMapBtn.visible=t.visible,t.disabled?this.mMapBtn.removeInteractive():this.mMapBtn.setInteractive()),"picanavigate.marketbtn"===t.name&&(this.mShopBtn.visible=t.visible,t.disabled?this.mShopBtn.removeInteractive():this.mShopBtn.setInteractive()),"picanavigate.bagbtn"===t.name&&(this.mBagBtn.visible=t.visible,t.disabled?this.mBagBtn.removeInteractive():this.mBagBtn.setInteractive()),"picanavigate.gohomebtn"===t.name&&(this.mGoHomeBtn.visible=t.visible,t.disabled?this.mGoHomeBtn.removeInteractive():this.mGoHomeBtn.setInteractive()))},Object.defineProperty(PicaNavigatePanel.prototype,"isZh_CN",{get:function(){return"zh-CN"===l.i18n.language},enumerable:!1,configurable:!0}),PicaNavigatePanel.prototype.preload=function(){this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json");var e="cn";this.isZh_CN||(e="en"),this.addAtlas(this.key_lang,"pica_navigate/pica_navigate_"+e+".png","pica_navigate/pica_navigate_"+e+".json"),t.prototype.preload.call(this)},PicaNavigatePanel.prototype.init=function(){this.mBackground=this.createImage(o.c.commonKey,"menu_bg"),this.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mMapBtn=this.createButton(this.key_lang,"map_btn"),this.mShopBtn=this.createButton(this.key_lang,"shop_btn"),this.mBagBtn=this.createButton(this.key_lang,"bag_btn"),this.mFamilyBtn=this.createButton(this.key_lang,"family_btn"),this.mGoHomeBtn=this.createImage(this.key_lang,"home_btn").setInteractive(),this.mCloseBtn=this.createImage(o.c.commonKey,"close_1").setInteractive();var e,i=[this.mMapBtn,this.mShopBtn,this.mBagBtn,this.mFamilyBtn,this.mGoHomeBtn];this.add([this.mBackground]),this.add(i),this.add(this.mCloseBtn);for(var n=0;n<i.length;n++)0===n?i[n].x=10.33*this.dpr+.5*i[n].width:(e=i[n-1],i[n].x=e.x+12*this.dpr+.5*(i[n].width+e.width));var a=this.scale;this.resize(this.mBackground.width*a,this.mBackground.height*a),t.prototype.init.call(this)},PicaNavigatePanel.prototype.createButton=function(t,e){var i;return(i=this.isZh_CN?this.createImage(t,e):this.createSprite(t,e)).setInteractive(),i},PicaNavigatePanel.prototype.createImage=function(t,e){return this.scene.make.image({key:t,frame:e},!1)},PicaNavigatePanel.prototype.createSprite=function(t,e){var i=this.scene.make.sprite({key:this.key_lang,frame:e+"_1"});return this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(this.key_lang,{prefix:e+"_",frames:[1,3]}),duration:500,repeat:-1}),i.play(e),i},PicaNavigatePanel.prototype.onShowMapHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_showPanel",h.ModuleName.PICAPARTYLIST_NAME)},PicaNavigatePanel.prototype.onShowShopHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_showPanel",h.ModuleName.PICAMARKET_NAME)},PicaNavigatePanel.prototype.onShowBagHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_showPanel",h.ModuleName.PICABAG_NAME)},PicaNavigatePanel.prototype.onShowFamilyHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_showPanel",h.ModuleName.PICAGIFTEFFECT_NAME)},PicaNavigatePanel.prototype.onShowGoHomeHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_goHome")},PicaNavigatePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_close")},PicaNavigatePanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(h.ModuleName.PICAHANDHELD_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var a=n[i];t.updateUIState(a)}}))},PicaNavigatePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewMainPanel",(function(){return f}));var n,a=i(6),s=i(21),o=i(0),h=i(2),l=i(480),c=i(526),p=i(527),d=i(528),u=i(529),m=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),f=function(t){function PicaNewMainPanel(e){var i=t.call(this,e)||this;return i.isFold=!1,i.atlasNames=[s.d.uicommon,s.d.iconcommon],i.key=o.ModuleName.PICANEWMAIN_NAME,i}return m(PicaNewMainPanel,t),PicaNewMainPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;this.foldButton.x=.5*this.foldButton.width+5*this.dpr,this.foldButton.y=.5*this.foldButton.height+5*this.dpr,this.headPanel.x=.5*n,this.headPanel.y=.5*this.headPanel.height,this.leftPanel.x=.5*this.leftPanel.width+10*this.dpr,this.leftPanel.y=this.headPanel.height+.5*this.leftPanel.height+20*this.dpr,this.activityPanel.x=n-.5*this.activityPanel.width-10*this.dpr,this.activityPanel.y=this.headPanel.height+.5*this.activityPanel.height+0*this.dpr,t.prototype.resize.call(this,n,a)},PicaNewMainPanel.prototype.addListen=function(){t.prototype.addListen.call(this)},PicaNewMainPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this)},PicaNewMainPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaNewMainPanel.prototype.hide=function(){t.prototype.hide.call(this)},PicaNewMainPanel.prototype.update=function(e){t.prototype.update.call(this)},PicaNewMainPanel.prototype.setPlayerInfo=function(t,e,i,n){this.headData={level:t,energy:e,money:i,diamond:n},this.mInitialized&&this.headPanel.setHeadData(t,e,i,n)},PicaNewMainPanel.prototype.setRoomInfo=function(t,e,i,n,a){void 0===a&&(a=!1),this.sceneData={sceneName:t,isPraise:e,people:i,roomType:n,isself:a},this.mInitialized&&this.headPanel.setSceneData(t,e,i,n,a)},PicaNewMainPanel.prototype.updateUIState=function(t){},PicaNewMainPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight;this.foldButton=new a.Button(this.scene,s.d.uicommon,"home_retract"),this.foldButton.on(a.ClickEvent.Tap,this.onFoldButtonHandler,this),this.add(this.foldButton),this.headPanel=new d.PicaNewHeadPanel(this.scene,e,70*this.dpr,this.key,this.dpr),this.headPanel.setHandler(new h.Handler(this,this.onHeadHandler)),this.add(this.headPanel),this.leftPanel=new u.PicaNewLeftPanel(this.scene,40*this.dpr,170*this.dpr,this.key,this.dpr),this.leftPanel.setHandler(new h.Handler(this,this.onLeftHandler)),this.add(this.leftPanel),this.activityPanel=new c.PicaNewActivityPanel(this.scene,40*this.dpr,170*this.dpr,this.key,this.dpr),this.activityPanel.setHandler(new h.Handler(this,this.onActivityHandler)),this.add(this.activityPanel),this.chatPanel=new p.PicaNewChatPanel(this.scene,e,201*this.dpr,this.key,this.dpr),this.add(this.chatPanel),this.resize(e,i),t.prototype.init.call(this)},PicaNewMainPanel.prototype.onInitialized=function(){this.headData&&this.headPanel.setHeadData(this.headData.level,this.headData.energy,this.headData.money,this.headData.diamond),this.sceneData&&this.headPanel.setSceneData(this.sceneData.sceneName,this.sceneData.isPraise,this.sceneData.people,this.sceneData.roomType,this.sceneData.isself)},PicaNewMainPanel.prototype.onFoldButtonHandler=function(){this.isFold=!this.isFold,this.isFold?(this.foldButton.setFrameNormal("home_spread","home_spread"),this.headPanel.visible=!1,this.leftPanel.visible=!1,this.activityPanel.visible=!1):(this.foldButton.setFrameNormal("home_retract","home_retract"),this.headPanel.visible=!0,this.leftPanel.visible=!0,this.activityPanel.visible=!0)},PicaNewMainPanel.prototype.onHeadHandler=function(t,e){"head"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.CHARACTERINFO_NAME):"energy"===t||("praise"===t?this.render.renderEmitter(o.EventType.QUERY_PRAISE,e):"recharge"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICARECHARGE_NAME):"room"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_openhousepanel"):"party"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAOPENPARTY_NAME):"online"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAONLINE_NAME))},PicaNewMainPanel.prototype.onLeftHandler=function(t,e){"maphome"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAPARTYLIST_NAME):"task"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICATASK_NAME)},PicaNewMainPanel.prototype.onActivityHandler=function(t,e){"activity"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAORDER_NAME):"indent"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAPARTYLIST_NAME):"recharge"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAFURNITURECOMPOSE_NAME):("email"===t||"roam"===t)&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAROAM_NAME)},PicaNewMainPanel.prototype.onNavigateHandler=function(t,e){"bag"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICABAG_NAME):"friend"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAFRIEND_NAME):"avatar"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAAVATAR_NAME):"shop"===t?this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAMARKET_NAME):"explore"===t&&this.render.renderEmitter(o.ModuleName.PICANEWMAIN_NAME+"_showpanel",o.ModuleName.PICAEXPLORELIST_NAME)},PicaNewMainPanel}(l.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewRolePanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(0),h=i(21),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaNewRolePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.followed=!1,i.key=o.ModuleName.PICANEWROLE_NAME,i.UIType=a.UIType.Scene,i}return c(PicaNewRolePanel,t),PicaNewRolePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,a),this.content.x=.5*n,this.content.y=a+.5*this.content.height+10*this.dpr,this.content.setInteractive(),this.setInteractive(new Phaser.Geom.Rectangle(0,0,2*n,2*a),Phaser.Geom.Rectangle.Contains);var s=this.scaleHeight+.5*this.content.height+10*this.dpr,o=this.scaleHeight-.5*this.content.height;this.playMove(s,o)},PicaNewRolePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.render.renderEmitter(this.key+"_initialized"),this.setRoleData(this.roleData),this.setFollowButton(this.followed)):this.preload())},PicaNewRolePanel.prototype.addListen=function(){this.mInitialized&&(this.openBigBtn.on(a.ClickEvent.Tap,this.onOpeningCharacterHandler,this),this.followBtn.on(a.ClickEvent.Tap,this.onFollowHandler,this),this.tradingBtn.on(a.ClickEvent.Tap,this.onTradingHandler,this),this.on("pointerdown",this.OnClosePanel,this))},PicaNewRolePanel.prototype.removeListen=function(){this.mInitialized&&(this.openBigBtn.off(a.ClickEvent.Tap,this.onOpeningCharacterHandler,this),this.followBtn.off(a.ClickEvent.Tap,this.onFollowHandler,this),this.tradingBtn.off(a.ClickEvent.Tap,this.onTradingHandler,this),this.off("pointerdown",this.OnClosePanel,this))},PicaNewRolePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaNewRolePanel.prototype.preload=function(){this.addAtlas(this.key,h.d.textureUrl(h.d.uicommonurl),h.d.jsonUrl(h.d.uicommonurl)),t.prototype.preload.call(this)},PicaNewRolePanel.prototype.init=function(){var e=this.scaleWidth,i=87*this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=new s.ThreeSlicePath(this.scene,0,0,e,87*this.dpr,this.key,["people_panel_bg_left","people_panel_bg_middle","people_panel_bg_right"],this.dpr),this.bg.y=.5*i-.5*this.bg.height,this.content.add(this.bg),this.headAvatar=new s.UIDragonbonesDisplay(this.scene,this.render),this.headAvatar.x=.5*-e+60*this.dpr,this.headAvatar.y=35*this.dpr,this.headAvatar.scale=2*this.dpr,this.headAvatar.visible=!1,this.content.add(this.headAvatar),this.nameImage=new s.ImageValue(this.scene,60*this.dpr,20*this.dpr,this.key,"people_woman",this.dpr),this.nameImage.setOffset(-this.dpr,0),this.nameImage.setTextStyle(l.UIHelper.whiteStyle(this.dpr,14)),this.nameImage.setLayout(1),this.nameImage.setText(""),this.nameImage.x=this.headAvatar.x+70*this.dpr,this.nameImage.y=.5*-i+15*this.dpr,this.content.add(this.nameImage),this.levelLabel=this.scene.make.text({x:this.nameImage.x-8*this.dpr,y:this.nameImage.y+20*this.dpr,text:"",style:l.UIHelper.whiteStyle(this.dpr)}),this.levelLabel.setOrigin(0,.5),this.content.add(this.levelLabel),this.openBigBtn=new a.Button(this.scene,this.key,"people_minute","people_minute"),this.openBigBtn.setSize(20*this.dpr,20*this.dpr),this.openBigBtn.removeInteractive(),this.openBigBtn.setInteractive(),this.openBigBtn.y=.5*-i+15*this.dpr,this.openBigBtn.x=.5*e-20*this.dpr,this.content.add(this.openBigBtn);var n=["butt_yellow_left_s","butt_yellow_middle_s","butt_yellow_right_s"];this.followBtn=new s.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,n,n,l.i18n.t("player_info.follow")),this.followBtn.setTextStyle(l.UIHelper.brownishStyle(this.dpr)),this.followBtn.y=.5*i-.5*this.followBtn.height-5*this.dpr,this.followBtn.x=.5*-this.followBtn.width+20*this.dpr,this.content.add(this.followBtn);var o=["butt_red_left_s","butt_red_middle_s","butt_red_right_s"];this.tradingBtn=new s.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,o,o,l.i18n.t("player_info.trading")),this.tradingBtn.setTextStyle(l.UIHelper.brownishStyle(this.dpr)),this.tradingBtn.y=this.followBtn.y,this.tradingBtn.x=.5*this.tradingBtn.width+40*this.dpr,this.content.add(this.tradingBtn),this.resize(),t.prototype.init.call(this)},PicaNewRolePanel.prototype.setRoleData=function(t){var e=this;if(this.roleData=t,this.mInitialized&&this.roleData){var i=o.AvatarSuitType.getSuitsFromItem(t.avatarSuit),n={id:t.id,avatar:i.avatar};this.headAvatar.visible=!1,this.headAvatar.setSuits(i.suits),this.headAvatar.once("replacefinished",(function(){e.headAvatar.play({name:"idle",flip:!1}),e.headAvatar.visible=!0})),this.headAvatar.load(n),this.nameImage.setFrameValue(t.nickname,this.key,"people_man"),this.levelLabel.text=l.i18n.t("common.lv")+" "+t.level.level;var a=["butt_gray_left_s","butt_gray_middle_s","butt_gray_right_s"];this.tradingBtn.setFrameNormal(a,a),this.tradingBtn.setTextColor("#000000"),this.tradingBtn.setEnable(!1,!1)}},PicaNewRolePanel.prototype.setFollowButton=function(t){this.followed=t,this.mInitialized&&this.followBtn.setText(t?l.i18n.t("friendlist.unfollow"):l.i18n.t("friendlist.follow"))},PicaNewRolePanel.prototype.playMove=function(t,e){var i=this.scene.tweens.add({targets:this.content,y:{from:t,to:e},ease:"Linear",duration:150,onComplete:function(){i.stop(),i.remove()}})},PicaNewRolePanel.prototype.onOpeningCharacterHandler=function(){this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_openingcharacter",this.roleData),this.OnClosePanel()},PicaNewRolePanel.prototype.onFollowHandler=function(){void 0!==this.roleData&&this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_followcharacter",{uid:this.roleData.cid,follow:this.followed})},PicaNewRolePanel.prototype.onTradingHandler=function(){this.render.renderEmitter(o.ModuleName.PICANEWROLE_NAME+"_tradingcharacter",this.roleData)},PicaNewRolePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(this.key+"_hide")},PicaNewRolePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNoticePanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(0),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaNoticePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isbigbg=!1,i.key=o.ModuleName.PICANOTICE_NAME,i}return l(PicaNoticePanel,t),PicaNoticePanel.prototype.show=function(t){var e=this;if(t&&Array.isArray(t)&&t.length>0&&(t=t[0]),this.mShowData=t,t&&t.display&&t.display.length>0&&(this.isbigbg=!0),this.mInitialized){if(t){var i=t.text;this.mContent&&i&&i.length>0&&(this.mContent.setText(i[0].text),this.isbigbg&&(this.mContent.y=.5*-this.bg.height+.5*this.mContent.height+2*this.dpr));var n=t.display;if(this.imageIcon&&n&&n.length>0){var a=h.Url.getOsdRes(n[0].texturePath);this.imageIcon.load(a,this,(function(){e.imageIcon.scale=e.dpr,e.mContent&&""!==e.mContent.text&&(e.imageIcon.y=.5*e.bg.height-.5*e.imageIcon.displayHeight-2*e.dpr)}))}this.scene.cameras.main.width;this.scene.tweens.timeline({targets:this,duration:500,tweens:[{y:"-="+20*this.dpr,ease:"Bounce.easeOut"},{delay:2e3,y:"-="+20*this.dpr,ease:"Linear",alpha:0}],onComplete:function(){e.render.renderEmitter(o.RENDER_PEER+"_"+e.key+"_close")}})}}else this.preload()},PicaNoticePanel.prototype.resize=function(){this.x=this.scene.cameras.main.width/2,this.y=170*this.dpr},PicaNoticePanel.prototype.preload=function(){var e=this.isbigbg?"pica_notice/bg_big.png":"pica_notice/bg.png",i=this.isbigbg?"pica_notice_bg_big":"pica_notice_bg";this.addImage(i,e),t.prototype.preload.call(this)},PicaNoticePanel.prototype.init=function(){var e=this.isbigbg?"pica_notice_bg_big":"pica_notice_bg";this.bg=this.scene.make.image({key:e},!1),this.mContent=new a.BBCodeText(this.mScene,0,0,"",{fontSize:16*this.dpr+"px",fontFamily:h.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr,align:"center",textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:this.bg.width*this.scale-12*this.dpr}}).setOrigin(.5,.5),this.mContent.setFontStyle("bold"),this.add([this.bg,this.mContent]),this.isbigbg&&(this.imageIcon=new s.DynamicImage(this.scene,0,0),this.add(this.imageIcon)),this.mScene.layerManager.addToLayer(s.MainUIScene.LAYER_TOOLTIPS,this),t.prototype.init.call(this),this.resize()},PicaNoticePanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOnlinePanel",(function(){return u}));var n,a=i(479),s=i(21),o=i(0),h=i(2),l=i(480),c=i(6),p=i(627),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaOnlinePanel(e){var i=t.call(this,e)||this;return i.key=o.ModuleName.PICAONLINE_NAME,i.atlasNames=[s.d.uicommon],i}return d(PicaOnlinePanel,t),PicaOnlinePanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.mBackground.clear(),this.mBackground.fillStyle(118271,1),this.mBackground.fillRect(0,0,this.content.width,n),this.mBackground.x=.5*-this.content.width,this.mBackground.y=.5*-n,this.content.x=i+.5*this.content.width+10*this.dpr,this.content.y=.5*n,this.bottomPanel.x=.5*i,this.bottomPanel.y=.5*n,this.setSize(i,n)},PicaOnlinePanel.prototype.addListen=function(){this.mInitialized&&this.mBlack.on("pointerup",this.onCloseHandler,this)},PicaOnlinePanel.prototype.removeListen=function(){this.mInitialized&&this.mBlack.off("pointerup",this.onCloseHandler,this)},PicaOnlinePanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaOnlinePanel.prototype.setOnlineDatas=function(t,e,i){this.onlineData=t,this.userid=i,this.people=e,this.mInitialized&&(this.peopleImg.setText(e+""),this.mGameGrid.setItems(t))},PicaOnlinePanel.prototype.setBlackList=function(t){this.blackList=t,this.mInitialized&&this.refreshBottomPanel()},PicaOnlinePanel.prototype.setAvatarList=function(t){for(var e=0,i=this.onlineData;e<i.length;e++)for(var n=i[e],a=0,s=t;a<s.length;a++){var o=s[a],h=o._id,l=o.avatar;n.platformId===h&&(n.avatar=l)}this.mInitialized&&this.mGameGrid.refresh()},PicaOnlinePanel.prototype.onInitialized=function(){this.onlineData&&this.mGameGrid.setItems(this.onlineData),this.people&&this.peopleImg.setText(this.people+"")},PicaOnlinePanel.prototype.init=function(){var e=this;if(!this.mInitialized){var i=this.scaleWidth,n=this.scaleHeight;this.mBlack=this.scene.make.graphics(void 0,!1),this.mBlack.fillStyle(0,.66),this.mBlack.fillRect(0,0,i,n),this.mBlack.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.add(this.mBlack),this.mBackground=this.scene.make.graphics(void 0,!1),this.content=this.scene.make.container(void 0,!1);var o=237*this.dpr;this.content.setSize(o,n),this.content.setInteractive(),this.bg=this.scene.make.image({key:s.d.uicommon,frame:"online_bg"}),this.bg.displayWidth=o,this.bg.y=.5*-n+.5*this.bg.height,this.titleTex=this.scene.make.text({x:0,y:0,text:h.i18n.t("online.title"),style:h.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5),this.titleTex.setFontStyle("bold"),this.titleTex.x=.5*-this.content.width+10*this.dpr,this.titleTex.y=.5*-this.content.height+20*this.dpr,this.peopleImg=new a.ImageValue(this.scene,50*this.dpr,20*this.dpr,s.d.uicommon,"online_people",this.dpr),this.peopleImg.setOffset(-this.dpr,0),this.peopleImg.setTextStyle(h.UIHelper.whiteStyle(this.dpr,14)),this.peopleImg.setLayout(3),this.peopleImg.setText("1000"),this.peopleImg.x=.5*this.content.width-30*this.dpr,this.peopleImg.y=this.titleTex.y;var l=new h.Handler(this,this.onSimpleHandler),d={x:0,y:25*this.dpr,table:{width:o,height:n-40*this.dpr,columns:1,cellWidth:o,cellHeight:50*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=t.index,a=t.item;return null===i&&(i=new m(e.scene,s.d.uicommon,e.dpr)).setHandler(l),i.setPlayerInfo(a,n),i}};this.mGameGrid=new c.GameGridTable(this.scene,d),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",this.onGridTableHandler,this),this.content.add([this.mBackground,this.bg,this.titleTex,this.peopleImg,this.mGameGrid]),this.add(this.content),this.bottomPanel=new p.PicaOnlineBottomPanel(this.scene,i,n,s.d.uicommon,this.dpr),this.bottomPanel.setHandler(new h.Handler(this,this.onBottomPanelHandler)),this.add(this.bottomPanel),this.bottomPanel.visible=!1,this.resize(0,0),t.prototype.init.call(this),this.playMove()}},PicaOnlinePanel.prototype.onGridTableHandler=function(t){var e=t.playerData;this.render.renderEmitter(this.key+"_openingcharacter",e.platformId)},PicaOnlinePanel.prototype.playMove=function(){var t=this,e=this.scaleWidth,i=e+.5*this.content.width+10*this.dpr,n=e-.5*this.content.width,a=this.scene.tweens.add({targets:this.content,x:{from:i,to:n},ease:"Linear",duration:300,onComplete:function(){a.stop(),a.remove(),t.mGameGrid.resetMask()}})},PicaOnlinePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaOnlinePanel.prototype.onSimpleHandler=function(t){if(t.platformId===this.userid)this.render.renderEmitter(this.key+"_openingcharacter",t.platformId);else{this.add(this.bottomPanel),this.bottomPanel.show();var e=-1!==this.blackList.indexOf(t.platformId);this.bottomPanel.setRoleData(t,e)}},PicaOnlinePanel.prototype.refreshBottomPanel=function(){if(this.bottomPanel.visible){var t=this.bottomPanel.roleData.platformId,e=-1!==this.blackList.indexOf(t);this.bottomPanel.refreshBlack(e)}},PicaOnlinePanel.prototype.onBottomPanelHandler=function(t,e){"report"===t||("block"===t?this.render.renderEmitter(this.key+"_block",e):"close"===t&&this.closeBottomPanel())},PicaOnlinePanel.prototype.closeBottomPanel=function(){this.bottomPanel.hide(),this.remove(this.bottomPanel)},PicaOnlinePanel}(l.PicaBasePanel),m=function(t){function OnlineItem(e,i,n){var o=t.call(this,e,0,0)||this;return o.key=i,o.dpr=n,o.setSize(237*n,48*n),o.headicon=new a.DynamicImage(o.scene,0,0),o.headicon.x=.5*-o.width+10*o.dpr,o.headicon.y=0,o.headicon.scale=.8*o.dpr,o.headicon.visible=!1,o.add(o.headicon),o.nameImage=new a.ImageValue(o.scene,60*o.dpr,20*o.dpr,o.key,"people_woman",o.dpr),o.nameImage.setOffset(-o.dpr,0),o.nameImage.setTextStyle(h.UIHelper.whiteStyle(o.dpr,14)),o.nameImage.setLayout(1),o.nameImage.setText(""),o.nameImage.x=o.headicon.x+70*o.dpr,o.nameImage.y=.5*-o.height+15*o.dpr,o.add(o.nameImage),o.levelLabel=o.scene.make.text({x:o.nameImage.x-8*o.dpr,y:o.nameImage.y+20*o.dpr,text:"",style:h.UIHelper.whiteStyle(o.dpr)}),o.levelLabel.setOrigin(0,.5),o.add(o.levelLabel),o.vipImage=new a.ImageValue(o.scene,60*o.dpr,20*o.dpr,o.key,"people_woman",o.dpr),o.vipImage.setOffset(-o.dpr,0),o.vipImage.setTextStyle(h.UIHelper.whiteStyle(o.dpr,14)),o.vipImage.setLayout(1),o.vipImage.setText(""),o.vipImage.x=o.levelLabel.x+70*o.dpr,o.vipImage.y=.5*-o.width+15*o.dpr,o.line=o.scene.make.image({key:s.d.uicommon,frame:"online_divider"}),o.line.y=.5*o.height,o.add(o.line),o.simpleButton=new c.Button(o.scene,o.key,"online_more"),o.simpleButton.on(c.ClickEvent.Tap,o.onSimpleClickHandler,o),o.simpleButton.x=.5*o.width-.5*o.simpleButton.width-10*n,o.add(o.simpleButton),o}return d(OnlineItem,t),OnlineItem.prototype.setPlayerInfo=function(t){var e=this;if(this.playerData=t,this.nameImage.setText(t.nickname),this.levelLabel.text=h.i18n.t("common.lv")+" "+t.level.level,this.headicon.visible=!1,t.avatar){var i=h.Url.getOsdRes(t.avatar);this.headicon.load(i,this,(function(){e.headicon.x=.5*-e.width+.5*e.headicon.displayWidth+10*e.dpr,e.headicon.visible=!0}))}},OnlineItem.prototype.setHandler=function(t){this.sendHandler=t},OnlineItem.prototype.onSimpleClickHandler=function(){this.sendHandler&&this.sendHandler.runWith(this.playerData)},OnlineItem}(a.ButtonEventDispatcher)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOpenPartyPanel",(function(){return u}));var n,a=i(1),s=i(6),o=i(479),h=i(0),l=i(2),c=i(21),p=i(530),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},u=function(t){function PicaOpenPartyPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=h.ModuleName.PICAOPENPARTY_NAME,i}return d(PicaOpenPartyPanel,t),PicaOpenPartyPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n,this.setSize(i,n),this.partyCreatePanel.resize()},PicaOpenPartyPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())},PicaOpenPartyPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicaOpenPartyPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicaOpenPartyPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaOpenPartyPanel.prototype.setPartyData=function(t,e){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(n){switch(n.label){case 0:return this.settingBtn.visible=e,[4,this.render.mainPeer.getRoomUserName()];case 1:return i=n.sent(),this.partyCreatePanel.setPartyData(t,i,Math.ceil(this.render.mainPeer.getClockNow()/1e3)),t.created?this.partyBtn.setText(l.i18n.t("party.partymgr")):this.partyBtn.setText(l.i18n.t("main_ui.party")),[2]}}))}))},PicaOpenPartyPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(c.c.common2Key,c.d.common2Url+".png",c.d.common2Url+".json"),t.prototype.preload.call(this)},PicaOpenPartyPanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var n=295*this.dpr,a=450*this.dpr;this.content.setSize(n,a),this.bg=new s.NineSlicePatch(this.scene,0,0,n,a,c.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:c.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.partyBtn=this.createTabButton(l.i18n.t("main_ui.party")),this.settingBtn=this.createTabButton(l.i18n.t("common.setting")),this.partyBtn.setPosition(.5*-this.partyBtn.width-2*this.dpr,.5*-this.content.height-.5*this.partyBtn.height+3*this.dpr),this.settingBtn.setPosition(.5*this.settingBtn.width+2*this.dpr,this.partyBtn.y),this.topCheckBox=new o.CheckboxGroup,this.topCheckBox.appendItemAll([this.partyBtn,this.settingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.partyBtn,this.settingBtn]),this.partyCreatePanel=new p.PicaOpenPartyCreatePanel(this.uiManager,0,0,this.content.width-20*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr,this.scale),this.partyCreatePanel.on("openparty",this.onOpenPartyHandler,this),this.partyCreatePanel.on("showtips",this.showPanelHandler,this),this.partyCreatePanel.on("querytheme",this.onQueryThemeHandler,this),this.partyCreatePanel.y=0,this.content.add(this.partyCreatePanel),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicaOpenPartyPanel.prototype.onTabBtnHandler=function(t){this.partyBtn===t?(this.partyCreatePanel.show(),this.onQueryThemeHandler()):this.partyCreatePanel.hide(),this.settingBtn},PicaOpenPartyPanel.prototype.createTabButton=function(t){var e=new s.TabButton(this.scene,c.c.common2Key,"default_tab","check_tab",t);return e.tweenEnable=!1,e.setTextStyle({fontFamily:l.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#ffffff"}),e.setTextOffset(0,0),e},PicaOpenPartyPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.ModuleName.PICAOPENPARTY_NAME+"_close")},PicaOpenPartyPanel.prototype.onOpenPartyHandler=function(t,e,i,n,a){this.render.renderEmitter(h.ModuleName.PICAOPENPARTY_NAME+"_queryopen",{topic:t,name:e,des:i,ticket:n}),this.render.renderEmitter(h.ModuleName.PICAOPENPARTY_NAME+"_close"),this.showPanelHandler("PicaNotice",a?l.i18n.t("party.modifytips"):l.i18n.t("party.opentips"))},PicaOpenPartyPanel.prototype.showPanelHandler=function(t,e){if(this.mWorld){var i=new a.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI;i.text=[{text:e,node:void 0}],this.render.mainPeer.showMediator(t,!0,i)}},PicaOpenPartyPanel.prototype.onQueryThemeHandler=function(){this.render.renderEmitter(h.ModuleName.PICAOPENPARTY_NAME+"_querytheme")},PicaOpenPartyPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPartyListPanel",(function(){return u}));var n,a=i(6),s=i(479),o=i(21),h=i(0),l=i(2),c=i(629),p=i(628),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaPartyListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICAPARTYLIST_NAME,i}return d(PicaPartyListPanel,t),PicaPartyListPanel.prototype.resize=function(t,e){this.scale;var i=this.scaleWidth,n=this.scaleHeight;this.content.x=.5*i,this.content.y=.5*n+20*this.dpr,this.setSize(i,n)},PicaPartyListPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())},PicaPartyListPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicaPartyListPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicaPartyListPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicaPartyListPanel.prototype.setPartyListData=function(t,e){void 0===e&&(e=!0),this.mPartyData=t,this.partyNavigationPanel.setPartyDataList(t)},PicaPartyListPanel.prototype.setOnlineProgress=function(t){this.partyNavigationPanel.setSignProgress(t)},PicaPartyListPanel.prototype.setRoomListData=function(t){this.myRoomNavigationPanel.setRoomDataList(t)},PicaPartyListPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(o.c.commonKey,o.d.commonUrl+".png",o.d.commonUrl+".json"),this.addAtlas(o.c.common2Key,o.d.common2Url+".png",o.d.common2Url+".json"),t.prototype.preload.call(this)},PicaPartyListPanel.prototype.init=function(){if(!this.mInitialized){var e=this.scaleWidth,i=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,e,i),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var n=295*this.dpr,h=490*this.dpr;this.content.setSize(n,h),this.bg=new a.NineSlicePatch(this.scene,0,0,n,h,o.c.commonKey,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:o.c.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.navigationBtn=this.createTabButton(l.i18n.t("party.navigation")),this.mineBtn=this.createTabButton(l.i18n.t("party.mine")),this.navigationBtn.setPosition(-this.navigationBtn.width-2*this.dpr,.5*-this.content.height-.5*this.navigationBtn.height+5*this.dpr),this.mineBtn.setPosition(this.navigationBtn.x+this.navigationBtn.width+2*this.dpr,this.navigationBtn.y),this.topCheckBox=new s.CheckboxGroup,this.topCheckBox.appendItemAll([this.navigationBtn,this.mineBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.navigationBtn,this.mineBtn]),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicaPartyListPanel.prototype.onTabBtnHandler=function(t){this.navigationBtn===t?(this.openPartyNavigationPanel(),this.hideRoomNavigationPanel(),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_querylist"),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_questprogress")):this.mineBtn===t?(this.openRoomNavigationPanel(),this.hidePartyNavigationPanel(),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_getMyRoomList")):this.searchBtn},PicaPartyListPanel.prototype.openPartyNavigationPanel=function(){this.partyNavigationPanel||(this.partyNavigationPanel=new c.PicaPartyNavigationPanel(this.scene,this.content.width-40*this.dpr,this.content.height-40*this.dpr,this.key,this.dpr,this.scale),this.partyNavigationPanel.setHandler(new l.Handler(this,this.onPartyListHandler)),this.partyNavigationPanel.y=0*this.dpr,this.partyNavigationPanel.on("questreward",this.onProgressRewardHandler,this)),this.content.add(this.partyNavigationPanel),this.partyNavigationPanel.refreshMask()},PicaPartyListPanel.prototype.hidePartyNavigationPanel=function(){this.partyNavigationPanel&&this.content.remove(this.partyNavigationPanel)},PicaPartyListPanel.prototype.openRoomNavigationPanel=function(){this.myRoomNavigationPanel||(this.myRoomNavigationPanel=new p.PicaMyRoomNavigationPanel(this.scene,this.content.width-40*this.dpr,this.content.height-34*this.dpr,this.key,this.dpr,this.scale),this.myRoomNavigationPanel.setHandler(new l.Handler(this,this.onEnterRoomHandler)),this.myRoomNavigationPanel.y=-10*this.dpr),this.content.add(this.myRoomNavigationPanel),this.myRoomNavigationPanel.refreshMask()},PicaPartyListPanel.prototype.hideRoomNavigationPanel=function(){this.myRoomNavigationPanel&&(this.myRoomNavigationPanel.clear(),this.content.remove(this.myRoomNavigationPanel))},PicaPartyListPanel.prototype.createTabButton=function(t){var e=new a.TabButton(this.scene,o.c.common2Key,"default_tab_s","check_tab_s",t);return e.tweenEnable=!1,e.setTextStyle({fontFamily:l.Font.DEFULT_FONT,fontSize:16*this.dpr,color:"#ffffff"}),e},PicaPartyListPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_close")},PicaPartyListPanel.prototype.onPartyListHandler=function(t,e){"hotel"!==t&&"pictown"!==t&&"partylist"!==t||this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_queryenter",e.roomId)},PicaPartyListPanel.prototype.onProgressRewardHandler=function(t){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_questreward",t)},PicaPartyListPanel.prototype.onEnterRoomHandler=function(t){this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_queryenter",t)},PicaPartyListPanel}(s.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPropFunPanel",(function(){return d}));var n,a=i(482),s=i(6),o=i(479),h=i(0),l=i(2),c=i(21),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaPropFunPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.itemCount=1,i.line=!1,i.key=h.ModuleName.PICAPROPFUN_NAME,i}return p(PicaPropFunPanel,t),PicaPropFunPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,n,a),this.content.x=n/2,this.content.y=a/2,this.setSize(n*this.scale,a*this.scale)},PicaPropFunPanel.prototype.show=function(t){if(this.mShowData=t,!this.mPreLoad)if(this.mInitialized){if(!this.mShow){this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen();var e=this.mShowData;this.setProp(e),this.updateData()}}else this.preload()},PicaPropFunPanel.prototype.addListen=function(){this.mInitialized&&(this.cancelBtn.on(s.ClickEvent.Tap,this.onCancelBtnHandler,this),this.confirmBtn.on(s.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaPropFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.cancelBtn.off(s.ClickEvent.Tap,this.onCancelBtnHandler,this),this.confirmBtn.off(s.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaPropFunPanel.prototype.preload=function(){this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(c.c.common2Key,c.d.common2Url+".png",c.d.common2Url+".json"),t.prototype.preload.call(this)},PicaPropFunPanel.prototype.init=function(){var e=this.scaleWidth,i=this.scaleHeight,n=this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var o=299*this.dpr,h=305*this.dpr;this.content.setSize(o,h),this.add(this.content);var p=new s.NineSlicePatch(this.scene,0,0,o,h,c.c.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:30*this.dpr,bottom:40*this.dpr});p.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains);var d=.5*-p.height+3*n,u=this.scene.make.image({x:0,y:d,key:c.c.common2Key,frame:"title"});u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:d+3*n,text:"售出",style:{color:"#905B06",fontSize:16*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5),this.titleName.setFontStyle("bold"),this.itemName=this.scene.make.text({x:0,y:d+40*n,style:{color:"#000000",fontSize:15*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5);var m=-40*n;this.mDetailDisplay=new a.DetailDisplay(this.scene,this.render),this.mDetailDisplay.setFixedScale(this.dpr/this.scale),this.mDetailDisplay.y=m;var f=30*n;this.priceBg=this.scene.make.image({x:0,y:f,key:c.c.common2Key,frame:"price_bg"}),this.priceBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.pricText=this.scene.make.text({x:0,y:f,style:{color:"#000000",fontSize:15*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5),this.mCoinIcon=this.scene.make.image({x:-45*this.dpr,y:f,key:c.c.commonKey,frame:"iv_coin"},!1).setOrigin(.5),this.mCoinIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var y=new s.NineSlicePatch(this.scene,0,0,8,7*n,c.c.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),g=new s.NineSlicePatch(this.scene,0,0,8,7*n,c.c.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1}),P=this.scene.make.image({key:c.c.common2Key,frame:"block"});this.thumb=P,this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:15*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(.5),this.slider=new s.GameSlider(this.scene,{x:0,y:70*n,width:136*n,height:7*n,orientation:1,background:y,indicator:g,thumb:P,offsetX:.5*P.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.slider.add(this.itemCountText),this.slider.setValue(0);var _=.5*p.height-30*n,v=-66*n;this.cancelBtn=new s.NineSliceButton(this.scene,v,_,112*n,36*n,c.c.commonKey,"red_btn",l.i18n.t("common.cancel"),n,this.scale,{left:12*n,top:12*n,right:12*n,bottom:12*n}),this.confirmBtn=new s.NineSliceButton(this.scene,-v,_,112*n,36*n,c.c.commonKey,"yellow_btn",l.i18n.t("common.confirm"),n,this.scale,{left:12*n,top:12*n,right:12*n,bottom:12*n}),this.cancelBtn.setTextStyle({color:"#FFFFFF",fontSize:16*n,fontFamily:l.Font.DEFULT_FONT}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*n,fontFamily:l.Font.DEFULT_FONT}),this.content.add([p,u,this.titleName,this.itemName,this.mDetailDisplay,this.priceBg,this.mCoinIcon,this.pricText,this.slider,this.cancelBtn,this.confirmBtn]),this.resize(0,0),t.prototype.init.call(this)},PicaPropFunPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaPropFunPanel.prototype.setProp=function(t){this.prop=t;var e=void 0===t.price||t.price;e=!!this.prop.data.sellingPrice&&e;var i=void 0===t.slider||t.slider;if(this.line=t.line||!1,this.itemData=this.prop.data,this.itemCount=i?1:this.itemData.count,t.resource&&this.setResource(t.resource),t.url&&this.mDetailDisplay.loadUrl(t.url),this.itemName.text=this.itemData.name||this.itemData.shortName,this.itemCountText.text=this.itemCount+"",t.title&&(this.titleName.text=t.title),e){this.pricText.visible=!0,this.priceBg.visible=!0,this.mCoinIcon.visible=!0,this.slider.y=70*this.dpr,this.pricText.text=l.Coin.getName(this.itemData.sellingPrice.coinType)+" x "+this.itemData.sellingPrice.price*this.itemCount;var n=l.Coin.getIcon(this.itemData.sellingPrice.coinType);this.mCoinIcon.setFrame(n)}else this.pricText.visible=!1,this.priceBg.visible=!1,this.mCoinIcon.visible=!1,this.slider.y=50*this.dpr;if(t.resultHandler.key&&t.resultHandler.key.length>0){var a=this.uiManager.getPanel(""+t.resultHandler.key);a&&(t.resultHandler.confirmFunc&&t.resultHandler.confirmFunc in a&&"function"==typeof a[t.resultHandler.confirmFunc]&&(this.confirmHandler=a[t.resultHandler.confirmFunc]),t.resultHandler.confirmAddData&&(this.confirmHandlerAddData=t.resultHandler.confirmAddData),t.resultHandler.cancelFunc&&t.resultHandler.cancelFunc in a&&"function"==typeof a[t.resultHandler.cancelFunc]&&(this.cancelHandler=a[t.resultHandler.cancelFunc]))}this.slider.visible=i,this.slider.setValue(0)},PicaPropFunPanel.prototype.setResource=function(t){t?t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.mDetailDisplay.loadAvatar(t,2,new Phaser.Geom.Point(0,70)):this.mDetailDisplay.loadUrl(this.itemData.texturePath)},PicaPropFunPanel.prototype.updateData=function(){this.itemCountText&&(this.itemCountText.text=this.itemCount+""),this.pricText&&this.itemData&&this.itemData.sellingPrice&&(this.pricText.text=l.Coin.getName(this.itemData.sellingPrice.coinType)+" x "+this.itemData.sellingPrice.price*this.itemCount)},PicaPropFunPanel.prototype.onCancelBtnHandler=function(){var t=this.uiManager.getPanel(""+this.prop.resultHandler.key);t&&this.cancelHandler&&this.cancelHandler.apply(t,this.itemData),this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_close")},PicaPropFunPanel.prototype.onConfirmBtnHandler=function(){if(this.confirmHandler){var t=this.uiManager.getPanel(""+this.prop.resultHandler.key);t&&(this.confirmHandlerAddData?this.confirmHandler.apply(t,[this.confirmHandlerAddData,this.itemData,this.itemCount]):this.confirmHandler.apply(t,[this.itemData,this.itemCount]))}this.render.renderEmitter(h.RENDER_PEER+"_"+this.key+"_close")},PicaPropFunPanel.prototype.onSliderValueHandler=function(t){this.itemCountText.x=this.thumb.x,this.itemCount=this.line?this.calcuSliderValue(t):this.lineSliderValue(t),this.updateData()},PicaPropFunPanel.prototype.calcuSliderValue=function(t){var e=this.itemData?this.itemData.count:1,i=0;if(e<=40)i=Math.round(e*t);else if(t<=1/4)i=40*t;else{var n=e-10;if(n<=40)i=10+n*(t-1/4)/.75;else{var a=n/4;i=10;for(var s=1;s<4;s++){var o=a+n/12*(s-1);if(t>s/4&&t<=(s+1)/4){i+=o*(t-s/4)/(1/4);break}i+=o}}}return(i=Math.round(i))<1&&(i=1),i},PicaPropFunPanel.prototype.lineSliderValue=function(t){var e=this.itemData?this.itemData.count:1;return Math.round(e*t)},PicaPropFunPanel}(o.BasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRecastePanel",(function(){return m}));var n,a=i(6),s=i(479),o=i(484),h=i(21),l=i(0),c=i(2),p=i(1),d=i(480),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaRecastePanel(e){var i=t.call(this,e)||this;return i.tempData={},i.atlasNames=[h.d.uicommon],i.textures=[{atlasName:"Recast_aims_icon_bg",folder:"texture"},{atlasName:"Recast_bg_texture",folder:"texture"}],i.key=l.ModuleName.PICARECASTE_NAME,i}return u(PicaRecastePanel,t),PicaRecastePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.mBackground.x=.5*n,this.mBackground.y=.5*a,this.mTopBg.x=.5*n,this.mTopBg.y=.5*this.mTopBg.height;var s=79*this.dpr,o=a-this.mPropGrid.height-.5*s-47*this.dpr;this.mCategoryCon.setSize(n,79*this.dpr),this.mCategoryCon.y=o,this.mCategoryCon.x=.5*n,this.mCategoriesBar.y=40*this.dpr,this.mCategoriesBar.x=.5*-n,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,n,40*this.dpr),this.confirmBtn.x=n-this.confirmBtn.width/2-10*this.dpr,this.confirmBtn.y=this.mCategoryCon.y-this.confirmBtn.height/2+25*this.dpr,this.labelTipTex.x=15*this.dpr,this.labelTipTex.y=this.confirmBtn.y,this.displayPanel.x=.5*n,this.displayPanel.y=.5*o+17*this.dpr,this.mPropGridBg.clear(),this.mPropGridBg.fillStyle(8250878),this.mPropGridBg.fillRect(0,0,this.mPropGrid.width,this.mPropGrid.height+10*this.dpr),this.mPropGridBg.y=a-this.mPropGrid.height-4*this.dpr,this.mPropGrid.x=n/2+3*this.dpr,this.mPropGrid.y=a-.5*this.mPropGrid.height,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(n,a),this.setInteractive()},PicaRecastePanel.prototype.setRecasteResult=function(t){t&&(this.mRecasteItemData.count--,this.displayPanel.setRecasteItemData(this.mRecasteItemData))},PicaRecastePanel.prototype.setCategories=function(t){if(this.tempData.subcategory=t,this.mInitialized&&t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var e=60*this.dpr,i=41*this.dpr,n=[];this.mCategoryScroll.clearItems();var a={value:c.i18n.t("common.all"),key:"alltype"};t.unshift(a);for(var o=0;o<t.length;o++){var l=new s.TextButton(this.scene,this.dpr,1,t[o].value,0,0);l.setData("item",t[o]),l.setSize(e,i),this.mCategoryScroll.addItem(l),n[o]=l,l.setFontSize(18*this.dpr),l.setFontStyle("bold");var p=this.scene.make.image({key:h.d.uicommon,frame:"Recast_nav_Select"});p.y=21*this.dpr,l.add(p),p.visible=!1,l.setData("lineImg",p)}this.mCategoryScroll.Sort(),this.mCategoryScroll.refreshMask(),n.length>1&&this.onSelectSubCategoryHandler(n[0])}},PicaRecastePanel.prototype.onShow=function(){this.setStarData(this.starCount),this.setRecasteItemData(this.mShowData),this.setCategories(this.tempData.subcategory)},PicaRecastePanel.prototype.setProp=function(t){var e=(t=t||[]).length;e<18&&(t=t.concat(new Array(18-e))),this.mPropGrid.setItems(t)},PicaRecastePanel.prototype.setStarData=function(t){this.starCount=t,this.mInitialized&&this.starvalue.setText(t+"")},PicaRecastePanel.prototype.setRecasteItemData=function(t){this.mRecasteItemData=t,this.displayPanel.setRecasteItemData(t)},PicaRecastePanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this),this.confirmBtn.on(a.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaRecastePanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off(a.ClickEvent.Tap,this.onCloseHandler,this),this.confirmBtn.off(a.ClickEvent.Tap,this.onConfirmBtnHandler,this))},PicaRecastePanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicaRecastePanel.prototype.queryRecasteList=function(){if(this.mSelectedCategeories){var t=this.mSelectedCategeories;this.render.renderEmitter(this.key+"_queryrecastelist",{type:t.key,star:this.mRecasteItemData.grade})}},PicaRecastePanel.prototype.onInitialized=function(){this.starCount&&this.starvalue.setText(this.starCount+"")},PicaRecastePanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.mBackground=new s.CommonBackground(this.scene,0,0,i,n),this.mTopBg=this.scene.make.image({key:"Recast_bg_texture"},!1),this.displayPanel=new f(this.scene,i,248*this.dpr,this.render,this.dpr,this.scale),this.mTopBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCategoryCon=this.scene.make.container(void 0,!1),this.mCategoryCon.setSize(i,295*this.dpr),this.mCategoryCon.y=n-this.mCategoryCon.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add(this.mCategoriesBar),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,n),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=new s.ButtonEventDispatcher(this.scene,0,0),this.mCloseBtn.setSize(100*this.dpr,40*this.dpr),this.mCloseBtn.enable=!0,this.mCloseBtn.x=.5*this.mCloseBtn.width+10*this.dpr,this.mCloseBtn.y=35*this.dpr;var l=this.scene.make.image({key:h.d.uicommon,frame:"back_arrow"});l.x=.5*-this.mCloseBtn.width+.5*l.width+10*this.dpr;var p=this.scene.make.text({text:"",style:c.UIHelper.whiteStyle(this.dpr,18)}).setOrigin(0,.5);p.setFontStyle("bold"),p.text=c.i18n.t("furni_bag.recaste"),p.x=l.x+.5*l.width+10*this.dpr,this.mCloseBtn.add([l,p]);var d=new a.NineSlicePatch(this.scene,0,-this.dpr,80*this.dpr,28*this.dpr,h.d.uicommon,"home_assets_bg",{left:17*this.dpr,top:0*this.dpr,right:17*this.dpr,bottom:0*this.dpr});d.x=.5*-d.width,this.starvalue=new s.ImageValue(this.scene,60*this.dpr,26*this.dpr,h.d.uicommon,"Recast_pica star_big",this.dpr,{color:"#ffffff",fontSize:15*this.dpr,fontFamily:c.Font.NUMBER}),this.starvalue.setLayout(1),this.starvalue.x=d.x-.5*d.width+22*this.dpr,this.starCountCon=this.scene.make.container(void 0,!1),this.starCountCon.setSize(d.width,d.height),this.starCountCon.add([d,this.starvalue]),this.starCountCon.x=i-20*this.dpr,this.starCountCon.y=this.mCloseBtn.y;var u=100*this.dpr,m=40*this.dpr,y=i-u/2-20*this.dpr,g=this.mCategoryCon.y-25*this.dpr;this.confirmBtn=this.createNineButton(y+100*this.dpr,g,u,m,h.d.uicommon,"yellow_btn",c.i18n.t("common.confirm"),"#996600"),this.labelTipTex=this.scene.make.text({text:c.i18n.t("recaste.tip"),style:c.UIHelper.colorStyle("#FAF916",14*this.dpr)}).setOrigin(0,.5),this.mCategoryScroll=new a.GameScroller(this.scene,{x:0,y:60*this.dpr,width:i,height:44*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onSelectSubCategoryHandler(t)}}),this.mPropGridBg=this.scene.make.graphics(void 0,!1),this.mCategoryCon.add(this.mCategoryScroll),this.add([this.mBackground,this.mPropGridBg,this.mTopBg,this.displayPanel,this.mCloseBtn,this.starCountCon,this.mCategoryCon,this.confirmBtn,this.labelTipTex]);var P=this.scene.textures.getFrame(h.d.uicommon,"bag_icon_common_bg"),_=P.width+9*this.dpr,v=P.height+9*this.dpr,b={x:0,y:0,table:{width:i,height:231*this.dpr,columns:3,cellWidth:_,cellHeight:v,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.scene,a=t.item;return null===i&&(i=new o.c(n,h.d.uicommon,"bag_icon_common_bg",e.dpr,e.scale,!1)),i.setData({item:a}),i.setItemData(a),e.mSelectedItemData&&a&&e.mSelectedItemData.id===a.id&&(i.isSelect=!0,e.mSelectedItem=i),i}};this.mPropGrid=new a.GameGridTable(this.scene,b),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&e.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},PicaRecastePanel.prototype.createNineButton=function(t,e,i,n,s,o,h,l){var p=new a.NineSliceButton(this.scene,t,e,i,n,s,o,h,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return h&&(p.setTextStyle({color:l,fontSize:16*this.dpr,fontFamily:c.Font.DEFULT_FONT}),p.setFontStyle("bold")),p},PicaRecastePanel.prototype.onSelectSubCategoryHandler=function(t){var e=t.getData("item");if(e){if(this.mPreCategoryBtn)this.mPreCategoryBtn.changeNormal(),this.mPreCategoryBtn.getData("lineImg").visible=!1;t.changeDown(),this.mSelectedCategeories=e,this.mPropGrid.setT(0),this.queryRecasteList(),this.mPreCategoryBtn=t,t.getData("lineImg").visible=!0}this.mPropGrid.setT(0)},PicaRecastePanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaRecastePanel.prototype.onSelectItemHandler=function(t){var e=t.getData("item");e&&this.mSelectedItemData===e||!e||(this.mSelectedItemData=e,this.displayPanel.setRecasteTargetData(e),this.mSelectedItem&&(this.mSelectedItem.select=!1),t.select=!0,this.mSelectedItem=t)},PicaRecastePanel.prototype.onConfirmBtnHandler=function(){var t;if(this.mSelectedItemData?this.starCount<this.mSelectedItemData.grade?t=c.i18n.t("furnicompose.starpicatips"):0===this.mRecasteItemData.count?t=c.i18n.t("recaste.counttips"):this.mRecasteItemData.id===this.mSelectedItemData.id&&(t=c.i18n.t("recaste.sametips")):t=c.i18n.t("recaste.selecttips"),t){var e={text:[{text:t,node:void 0}]};this.render.mainPeer.showMediator(l.ModuleName.PICANOTICE_NAME,!0,e)}else this.render.renderEmitter(this.key+"_queryrecaste",{consumedId:this.mRecasteItemData.id,targetId:this.mSelectedItemData.id})},PicaRecastePanel}(d.PicaBasePanel),f=function(t){function RecasteDisplayPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.setSize(i,n),h.dpr=s,h.zoom=o,h.render=a,h.init(),h}return u(RecasteDisplayPanel,t),RecasteDisplayPanel.prototype.setRecasteItemData=function(t){this.recasteItem.setItemData(t,!0),this.starvalue.setText(t.grade+"")},RecasteDisplayPanel.prototype.setRecasteTargetData=function(t){this.recasteTarget.displayLoading("loading_ui",c.Url.getUIRes(this.dpr,"loading_ui"),c.Url.getUIRes(this.dpr,"loading_ui"),this.dpr/this.zoom);var e=new p.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;e.display=t.animationDisplay,e.animations=t.animations,this.recasteTarget.loadDisplay(e),this.starLevelImg.setFrame("Recast_star_big_"+t.grade),this.nameTex.text=t.name||t.shortName,this.starLevelImg.visible=!0},RecasteDisplayPanel.prototype.init=function(){var t=this,e=this.scene.make.image({key:"Recast_aims_icon_bg"});e.x=.5*this.width-.5*e.width-15*this.dpr,this.recasteItem=new o.c(this.scene,h.d.uicommon,"Recast_default_icon_bg",this.dpr,this.zoom,!1),this.recasteItem.x=.5*-this.width+.5*this.recasteItem.width+20*this.dpr,this.recasteItem.y=0;var i=this.scene.make.image({key:h.d.uicommon,frame:"Recast_arrow"});i.x=this.recasteItem.x+.5*this.recasteItem.width+.5*i.width+6*this.dpr,i.y=this.recasteItem.y,this.starvalue=new s.ImageValue(this.scene,60*this.dpr,20*this.dpr,h.d.uicommon,"Recast_pica star_small",this.dpr,c.UIHelper.colorNumberStyle("#ffffff",20*this.dpr)),this.starvalue.x=i.x-11*this.dpr,this.starvalue.y=i.y-10*this.dpr,this.nameTex=this.scene.make.text({text:"",style:c.UIHelper.colorStyle("#FFFF00",14*this.dpr)}).setOrigin(0,.5),this.nameTex.setFontStyle("bold"),this.nameTex.x=e.x-.5*e.width,this.nameTex.y=e.y-.5*e.height-18*this.dpr,this.starLevelImg=this.scene.make.image({key:h.d.uicommon,frame:"Recast_star_big_1"}).setOrigin(1,.5),this.starLevelImg.x=e.x+.5*e.width-.5*this.starLevelImg.width-12*this.dpr,this.starLevelImg.y=e.y-.5*e.height+.5*this.starLevelImg.height+8*this.dpr,this.starLevelImg.visible=!1,this.recasteTarget=new o.a(this.scene,this.render),this.recasteTarget.setFixedScale(2*this.dpr/this.zoom),this.recasteTarget.setComplHandler(new c.Handler(this,(function(){t.recasteTarget.visible=!0}))),this.recasteTarget.setTexture(h.d.uicommon,"bag_nothing",1),this.recasteTarget.setNearest(),this.recasteTarget.x=e.x,this.recasteTarget.y=e.y,this.add([e,this.recasteItem,this.recasteTarget,i,this.starvalue,this.nameTex,this.starLevelImg])},RecasteDisplayPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRechargePanel",(function(){return d}));var n,a,s=i(6),o=i(479),h=i(0),l=i(21),c=i(2),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaRechargePanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.PICARECHARGE_NAME,i}return p(PicaRechargePanel,t),PicaRechargePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.mBackground.clear(),this.mBackground.fillGradientStyle(7304703,7304703,314367,314367),this.mBackground.fillRect(0,0,n,a),this.content.setSize(n,a),this.content.x=.5*n,this.content.y=.5*a,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains),this.top.y=.5*-a+.5*this.top.height,this.bottom.y=.5*a-.5*this.bottom.height;var s=640*this.dpr;this.middle.y=i<s?this.top.y+this.top.height+.5*this.middle.height:28*this.dpr;var o=this.top.height+this.bottom.height;this.bg.scaleY=1,this.bg.displayHeight=a-o+60*this.dpr,this.gamescroll&&this.gamescroll.refreshMask()},PicaRechargePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaRechargePanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaRechargePanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaRechargePanel.prototype.preload=function(){this.addAtlas(this.key,"recharge/recharge.png","recharge/recharge.json"),this.addAtlas(l.c.commonKey,l.d.textureUrl(l.d.commonUrl),l.d.jsonUrl(l.d.commonUrl)),this.addAtlas(l.c.common2Key,l.d.textureUrl(l.d.common2Url),l.d.jsonUrl(l.d.common2Url)),this.addAtlas(l.c.common3Key,l.d.textureUrl(l.d.common3Url),l.d.jsonUrl(l.d.common3Url)),t.prototype.preload.call(this)},PicaRechargePanel.prototype.init=function(){this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=this.scaleWidth,i=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=this.scene.make.image({key:this.key,frame:"recharge_bg"}),this.bg.scale=1,this.bg.displayHeight=i-(96*this.dpr+50*this.dpr),this.bg.y=23*this.dpr,this.content.add(this.bg),this.top=this.scene.make.container(void 0,!1),this.top.setSize(e,100*this.dpr),this.top.y=.5*-i+.5*this.top.height,this.content.add(this.top);var n=.5*-this.top.height;this.topbg=this.scene.make.image({key:this.key,frame:"recharge_head"}),this.topbg.y=n+.5*this.topbg.height+43*this.dpr,this.titlebg=this.scene.make.image({x:0,y:0,key:this.key,frame:"recharge_text"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=n+45*this.dpr,this.tilteName=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:c.i18n.t("recharge.title"),style:c.UIHelper.titleYellowStyle_m(this.dpr)}).setOrigin(.5),this.tilteName.setFontStyle("bold"),this.tilteName.setResolution(this.dpr),this.closeBtn=new s.Button(this.scene,l.c.commonKey,"back_arrow","back_arrow"),this.closeBtn.x=.5*-e+.5*this.closeBtn.width+15*this.dpr,this.closeBtn.y=n+.5*this.closeBtn.height+10*this.dpr,this.diamondvalue=new o.ValueContainer(this.scene,l.c.common3Key,"diamond",this.dpr),this.diamondvalue.x=.5*e-46*this.dpr,this.diamondvalue.y=this.closeBtn.y,this.top.add([this.topbg,this.titlebg,this.tilteName,this.closeBtn,this.diamondvalue]),this.createMiddle(e,i),this.createBottom(e,50*this.dpr),this.itemtips=new o.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,l.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add(this.itemtips),this.resize(),t.prototype.init.call(this),this.setDataList()},PicaRechargePanel.prototype.setDataList=function(){var t=this;if(this.gamescroll){for(var e=0;e<3;e++){(i=new m(this.scene,this.width,110*this.dpr,this.key,this.dpr,this.scale)).setHandler(new c.Handler(this,(function(e){t.buy("com.tooqing.app.60diamond","测试付费项目")}))),i.setTwoData(),this.gamescroll.addItem(i)}this.gamescroll.Sort()}else{for(e=0;e<6;e++){var i;(i=new u(this.scene,this.key,this.dpr,this.scale)).setHandler(new c.Handler(this,(function(e){t.buy("com.tooqing.app.60diamond","测试付费项目")}))),this.gridlayout.add(i)}this.gridlayout.Layout()}},PicaRechargePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaRechargePanel.prototype.createMiddle=function(t,e){this.middle=this.scene.make.container(void 0,!1),this.content.add(this.middle),this.banner=new f(this.scene,0,0,308*this.dpr,96*this.dpr,this.key,"recharge_banner",this.scale),this.middle.add(this.banner);var i=150*this.dpr,n=e-i;if(n<640*this.dpr-i){this.middle.setSize(t,n),this.middle.y=this.top.y+this.top.height+.5*this.middle.height,this.banner.y=.5*-this.middle.height+.5*this.banner.height,(c=this.scene.make.image({key:this.key,frame:"recharge_division"})).y=this.banner.y+.5*this.banner.height+.5*c.height,this.middle.add(c);var a=n-110*this.dpr,s=.5*a+c.y+.5*c.height;this.gamescroll=this.createGameScroll(0,s,t,a),this.middle.add(this.gamescroll)}else{this.middle.setSize(t,500*this.dpr),this.middle.y=28*this.dpr,this.banner.y=.5*-this.middle.height+.5*this.banner.height+3*this.dpr;for(var h=this.banner.y+.5*this.banner.height-this.dpr,l=0;l<4;l++){var c;(c=this.scene.make.image({key:this.key,frame:"recharge_division"})).y=h+.5*c.height,h+=131*this.dpr,this.middle.add(c)}this.gridlayout=new o.GridLayoutGroup(this.scene,0,0,{cellSize:new Phaser.Math.Vector2(149*this.dpr,110*this.dpr),space:new Phaser.Math.Vector2(10*this.dpr,21*this.dpr),startAxis:o.AxisType.Horizontal,constraint:o.ConstraintType.FixedColumnCount,constraintCount:2,alignmentType:o.AlignmentType.UpperCenter}),this.gridlayout.y=this.banner.y+.5*this.banner.height+21*this.dpr,this.middle.add(this.gridlayout)}},PicaRechargePanel.prototype.createBottom=function(t,e){this.bottom=this.scene.make.container(void 0,!1),this.bottom.setSize(t,e),this.content.add(this.bottom),this.bottom.y=.5*this.scaleHeight-.5*e;var i=this.scene.make.image({key:this.key,frame:"recharge_nav_bg"});this.bottom.add(i);var n=102*this.dpr,h=41*this.dpr,l=15*this.dpr,p=c.UIHelper.blueStyle(this.dpr,15);this.checkBox=new o.CheckboxGroup;for(var d=[a.GIFT,a.PRIVILEGE,a.DIAMONO],u=[c.i18n.t("recharge.gift"),c.i18n.t("recharge.privilege"),c.i18n.t("recharge.diamond")],m=.5*-(n*d.length+l*(d.length-1)),f=0;f<d.length;f++){var y=d[f],g=new s.TabButton(this.scene,this.key,"recharge_tab_uncheck","recharge_tab_check",u[f]);g.setTextStyle(p),g.setData("data",y),g.setSize(n,h),g.setFontStyle("bold"),g.y=1*this.dpr,g.x=m+.5*n,m+=n+l,this.checkBox.appendItem(g),this.bottom.add(g)}this.checkBox.on("selected",this.onTabButtonHandler,this),this.checkBox.selectIndex(0)},PicaRechargePanel.prototype.createGameScroll=function(t,e,i,n){return new s.GameScroller(this.scene,{x:t,y:e,width:i,height:n,zoom:this.scale,align:2,orientation:0,dpr:this.dpr,space:20*this.dpr,selfEvent:!0,padding:{top:10*this.dpr,bottom:10*this.dpr}})},PicaRechargePanel.prototype.buy=function(t,e){window.IAP&&window.IAP.buy(t,(function(){alert("购买"+e+"成功，等待发货！")}))},PicaRechargePanel.prototype.onTabButtonHandler=function(t){},PicaRechargePanel.prototype.OnClosePanel=function(){this.render.renderEmitter(h.ModuleName.PICARECHARGE_NAME+"_hide")},PicaRechargePanel.prototype.onPointerUpHandler=function(t){},PicaRechargePanel.prototype.onSendHandler=function(t){this.render.renderEmitter(h.ModuleName.PICARECHARGE_NAME+"_questwork",t)},PicaRechargePanel.prototype.onItemInfoTips=function(t,e,i){this.itemtips.visible=e,this.itemtips.x=i.x*this.scale-this.content.x,this.itemtips.y=i.y*this.scale-this.content.y-30*this.dpr,this.itemtips.setText(this.getDesText(t))},PicaRechargePanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),c.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaRechargePanel}(o.BasePanel),u=function(t){function RechargeItem(e,i,n,a){var h=t.call(this,e)||this;h.giftbags=[],h.key=i,h.dpr=n,h.zoom=a;var p=149*n,d=108*n;return h.setSize(p,d),h.bg=h.scene.make.image({key:i,frame:"recharge_diamond_bg"}),h.add(h.bg),h.title=new s.BBCodeText(h.scene,0,0,"",{color:"#ffffff",fontSize:14*n,fontFamily:c.Font.DEFULT_FONT}).setOrigin(.5),h.title.x=0,h.title.y=.5*-d+10*n,h.add(h.title),h.imgicon=h.scene.make.image({key:i,frame:"recharge_diamond_1.99"}),h.add(h.imgicon),h.imgicon.x=.5*-h.width+48*n,h.imgicon.y=2*n,h.tipsbg=h.scene.make.image({key:i,frame:"recharge_first_purchase"}),h.add(h.tipsbg),h.tipsbg.x=.5*h.width-.5*h.tipsbg.width+3*n,h.tipsbg.y=.5*-h.height+.5*h.tipsbg.height+23*n,h.tipsvalue=h.scene.make.text({text:"",style:c.UIHelper.whiteStyle(n)}),h.tipsvalue.setOrigin(0,.5),h.add(h.tipsvalue),h.tipsvalue.x=.5*-h.width+3*n,h.tipsvalue.y=h.tipsbg.y-7*n,h.tipstext=h.scene.make.text({text:"First Purchase",style:c.UIHelper.whiteStyle(n,11)}),h.tipstext.setOrigin(1,.5),h.add(h.tipstext),h.tipstext.x=.5*h.width-3*n,h.tipstext.y=h.tipsbg.y-3*n,h.purchaseBtn=new o.ThreeSliceButton(e,63*n,22*n,l.c.common3Key,c.UIHelper.threeYellowNormal,c.UIHelper.threeYellowNormal,"$ 1.99"),h.purchaseBtn.setTextStyle(c.UIHelper.brownishStyle(n)),h.purchaseBtn.setFontStyle("bold"),h.add(h.purchaseBtn),h.purchaseBtn.x=.5*h.width-.5*h.purchaseBtn.width-10*n,h.purchaseBtn.y=.5*h.height-.5*h.purchaseBtn.height-9*n,h.purchaseBtn.on(String(s.ClickEvent.Tap),h.onSendHandler,h),h.setRechargeData(void 0),h}return p(RechargeItem,t),RechargeItem.prototype.setHandler=function(t){this.sendHandler=t},RechargeItem.prototype.setRechargeData=function(t){this.rechargeData=t,this.title.text="[color=#FFE400]100[/color]Diamond",this.setPropItems()},RechargeItem.prototype.setPropItems=function(){for(var t=0,e=this.giftbags;t<e.length;t++){(s=e[t]).visible=!1,s.enable=!1}var i=[],n=0;1===i.length?(this.addimg&&(this.addimg.visible=!1),n=.5*this.width-55*this.dpr):(n+=20*this.dpr,this.addimg?this.addimg.visible=!0:(this.addimg=this.scene.make.image({key:this.key,frame:"recharge_diamond_gift"}),this.add(this.addimg)));for(var a=0;a<i.length;a++){var s=void 0,h=i[a];a<this.giftbags.length?s=this.giftbags[a]:((s=new o.PropItem(this.scene,this.key,"recharge_diamond_gift",this.dpr,this.zoom)).enable=!0,this.giftbags.push(s),this.add(s)),s.setItemData(h),s.visible=!0,s.x=n+.5*s.width,s.y=0,n+=s.width+20*this.dpr}},RechargeItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([100])},RechargeItem}(Phaser.GameObjects.Container),m=function(t){function TwoRechargeItem(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.key=a,h.dpr=s,h.zoom=o,h.bottombg=h.scene.make.image({key:a,frame:"recharge_division"}),h.setSize(i,n),h.add(h.bottombg),h.bottombg.y=.5*h.height+.5*h.bottombg.height-1*s,h}return p(TwoRechargeItem,t),TwoRechargeItem.prototype.setHandler=function(t){this.sendHandler=t},TwoRechargeItem.prototype.setTwoData=function(){for(var t=0;t<2;t++){var e=new u(this.scene,this.key,this.dpr,this.scale);e.setHandler(this.sendHandler),this.add(e),e.x=.5*-e.width-5*this.dpr+t*(e.width+10*this.dpr)}},TwoRechargeItem}(Phaser.GameObjects.Container),f=function(t){function RechargeBanner(e,i,n,a,s,o,h,l){var c=t.call(this,e,i,n)||this;return c.key=o,c.frame=h,c.banners=[],c.setSize(a,s),c.setBannerData(),c.enable=!0,c}return p(RechargeBanner,t),RechargeBanner.prototype.setBannerData=function(){for(var t=0,e=0;e<6;e++){var i=new o.DynamicImage(this.scene,0,0,this.key,this.frame);this.banners.push(i),i.x=t,t+=i.width+10*this.dpr}this.add(this.banners)},RechargeBanner.prototype.onPointerMoveHandler=function(e){t.prototype.onPointerMoveHandler.call(this,e),this.banners.length>1&&this.moveBanner(e.deltaX)},RechargeBanner.prototype.onPointerUpHandler=function(t){this.interactiveBoo?this.mTweenBoo?this.tween(!1,this.pointerUp.bind(this,t)):this.pointerUp(t):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)},RechargeBanner.prototype.moveBanner=function(t){for(var e=0,i=this.banners;e<i.length;e++){i[e].x+=t}},RechargeBanner.prototype.tween=function(t,e){var i=this;this.mTweening=!0,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0),this.mTween=this.scene.tweens.add({targets:this.list,duration:45,ease:"Linear",x:0,onComplete:function(){i.tweenComplete(),e&&e()},onCompleteParams:[this]})},RechargeBanner.prototype.tweenComplete=function(){this.mTweening=!1,this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=void 0)},RechargeBanner}(o.SoundButton);!function(t){t[t.GIFT=0]="GIFT",t[t.PRIVILEGE=1]="PRIVILEGE",t[t.DIAMONO=2]="DIAMONO"}(a||(a={}))},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRewardTipPanel",(function(){return l}));var n,a=i(479),s=i(0),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaRewardTipPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.mTips=[],i.showingList=[],i.key=s.ModuleName.PICAREWARDTIP_NAME,i}return h(PicaRewardTipPanel,t),PicaRewardTipPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&0===this.showingList.length&&this.showAward(),this.mScene.layerManager.addToLayer(a.MainUIScene.LAYER_TOOLTIPS,this)},PicaRewardTipPanel.prototype.appendAward=function(t){this.mTips.push(t),this.show()},PicaRewardTipPanel.prototype.addAward=function(){},PicaRewardTipPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.mTips&&(this.mTips=[])},PicaRewardTipPanel.prototype.preload=function(){this.addImage(this.key,"reaward_tips/bg.png"),t.prototype.preload.call(this)},PicaRewardTipPanel.prototype.init=function(){this.setSize(20,20),t.prototype.init.call(this),this.y=250*this.dpr},PicaRewardTipPanel.prototype.showAward=function(){if(!(this.mTips.length<1)&&this.scene&&!(this.showingList.length>=3)){for(var t=0,e=this.showingList;t<e.length;t++){e[t].beUp()}var i=new c(this.scene,this.key,this.dpr,this.scale);i.once("destroy",this.onDestroyHanlder,this),i.once("show",this.onAwardItemShowHandler,this),i.setProp(this.mTips.pop()),this.add(i),this.showingList.push(i)}},PicaRewardTipPanel.prototype.onAwardItemShowHandler=function(){this.showAward()},PicaRewardTipPanel.prototype.onDestroyHanlder=function(t){var e=this.showingList.indexOf(t);e>-1&&this.showingList.splice(e,1),this.showAward()},PicaRewardTipPanel}(a.BasePanel),c=function(t){function AwardItem(e,i,n,s){var h=t.call(this,e)||this;return h.mBg=h.scene.make.image({key:i},!1),h.mScaleRatio=n*s,h.mImage=new a.DynamicImage(h.scene,0,0),h.mImage.setScale(n),h.mImage.setOrigin(.5,1),h.mImage.y=h.mBg.height*s/2,h.mLabel=h.scene.make.text({x:h.mBg.width*h.originX-6*h.mScaleRatio,style:{fontFamily:o.Font.DEFULT_FONT,fontSize:11*h.mScaleRatio,color:"#00FF00"}},!1).setOrigin(1,.5),h.addAt(h.mBg,0),h.add([h.mImage,h.mLabel]),h.setSize(h.mBg.width*s,h.mBg.height*s),h}return h(AwardItem,t),AwardItem.prototype.setProp=function(t){t&&(t.display&&t.display.texturePath&&this.mImage.load(o.Url.getOsdRes(t.display.texturePath)),this.mLabel.setText(t.text),this.showTween())},AwardItem.prototype.showTween=function(){var t=this;this.scene.tweens.add({targets:this,props:{x:"+="+.3*this.width},ease:"Bounce.easeOut",onComplete:function(){t.emit("show"),t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)},duration:300})},AwardItem.prototype.closeTween=function(){var t=this;this.scene&&this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio,alpha:"0"},ease:"Linear",duration:300,onComplete:function(){t.destroy()}})},AwardItem.prototype.beUp=function(){var t=this;clearTimeout(this.closeDelay),this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio},ease:"Linear",duration:300,onComplete:function(){t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)}})},AwardItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamPanel",(function(){return m}));var n,a=i(21),s=i(0),o=i(2),h=i(480),l=i(532),c=i(531),p=i(533),d=i(630),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaRoamPanel(e){var i=t.call(this,e)||this;return i.isOneDraw=!0,i.key=s.ModuleName.PICAROAM_NAME,i.atlasNames=[a.d.uicommon,a.d.uicommon1,a.d.roam,{atlasName:"roam_effect_1",folder:"roam_effect",foldType:a.b.NORMAL}],i.textures=[{atlasName:"roam_stripe",folder:"roam"},{atlasName:"roam_topic",folder:"roam"},{atlasName:"roamone",folder:"roam_effect",foldType:a.b.NORMAL,uiType:a.e.video},{atlasName:"roamtenrepead",folder:"roam_effect",foldType:a.b.NORMAL,uiType:a.e.video},{atlasName:"roamreward",folder:"roam_effect",foldType:a.b.NORMAL,uiType:a.e.video}],i}return u(PicaRoamPanel,t),PicaRoamPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,a),this.content.x=.5*n,this.content.y=.5*a,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains)},PicaRoamPanel.prototype.addListen=function(){this.mInitialized},PicaRoamPanel.prototype.removeListen=function(){this.mInitialized},PicaRoamPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.roamListPanel&&this.roamListPanel.destroy(),this.roamDrawPanel&&this.roamDrawPanel.destroy(),this.roamPreviewPanel&&this.roamPreviewPanel.destroy()},PicaRoamPanel.prototype.init=function(){this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var e=295*this.dpr,i=405*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.resize(),t.prototype.init.call(this)},PicaRoamPanel.prototype.onShow=function(){this.openRoamList(),this.tempDatas&&this.roamListPanel.setRoamDataList(this.tempDatas)},PicaRoamPanel.prototype.setRoamDataList=function(t){if(this.tempDatas=t,this.mInitialized&&(this.roamListPanel.setRoamDataList(t),this.roamDrawPanel)){var e=this.roamListPanel.getRoamTokenDatas();this.roamDrawPanel.setRoamDatas(e)}},PicaRoamPanel.prototype.openRoamEffectOnePanel=function(t){this.showRoamEffectOnePanel(),this.roamEffectOnePanel.setRewardDatas(t,this.isOneDraw)},PicaRoamPanel.prototype.hideRoamEffectOnePanel=function(){this.roamEffectOnePanel.visible=!1},PicaRoamPanel.prototype.payDrawHandler=function(t){this.render.renderEmitter(this.key+"_queryroamdraw",t),this.isOneDraw=!1},PicaRoamPanel.prototype.setRoamTokenData=function(t,e,i){this.roamDrawPanel&&this.roamDrawPanel.setMoneyData(t,e,i)},PicaRoamPanel.prototype.openRoamList=function(){this.showRoamListPanel()},PicaRoamPanel.prototype.showRoamListPanel=function(){this.roamListPanel||(this.roamListPanel=new l.PicaRoamListPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamListPanel.setHandler(new o.Handler(this,this.onRoamListHandler))),this.content.add(this.roamListPanel),this.roamListPanel.visible=!0,this.roamListPanel.resize(this.scaleWidth,this.scaleHeight),this.render.renderEmitter(this.key+"_updatepools")},PicaRoamPanel.prototype.hideRoamListPanel=function(){this.roamListPanel.visible=!1},PicaRoamPanel.prototype.openRoamDrawPanel=function(t){this.showRoamDrawPanel(),this.roamDrawPanel.setRoamDatas(t);var e=t[0],i={tokenId:e.tokenId,alterId:e.alterTokenId};this.render.renderEmitter(this.key+"_updatetoken",i),this.tokenId=e.tokenId},PicaRoamPanel.prototype.showRoamDrawPanel=function(){this.roamDrawPanel||(this.roamDrawPanel=new c.PicaRoamDrawPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamDrawPanel.setHandler(new o.Handler(this,this.onRoamDrawHandler))),this.content.add(this.roamDrawPanel),this.roamDrawPanel.visible=!0,this.roamDrawPanel.resize(this.scaleWidth,this.scaleHeight)},PicaRoamPanel.prototype.hideRoamDrawPanel=function(){this.roamDrawPanel.visible=!1},PicaRoamPanel.prototype.showRoamPreviewPanel=function(){this.roamPreviewPanel||(this.roamPreviewPanel=new p.PicaRoamPreviewPanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr,this.scale),this.roamPreviewPanel.setHandler(new o.Handler(this,this.onRoamPreviewHandler))),this.content.add(this.roamPreviewPanel),this.roamPreviewPanel.visible=!0,this.roamPreviewPanel.resize(this.scaleWidth,this.scaleHeight)},PicaRoamPanel.prototype.hideRoamPreviewPanel=function(){this.roamPreviewPanel.visible=!1},PicaRoamPanel.prototype.showRoamEffectOnePanel=function(){this.roamEffectOnePanel||(this.roamEffectOnePanel=new d.PicaRoamEffectOnePanel(this.scene,this.scaleWidth,this.scaleHeight,this.dpr),this.roamEffectOnePanel.setHandler(new o.Handler(this,this.onRoamEffectOneHandler))),this.content.add(this.roamEffectOnePanel),this.roamEffectOnePanel.visible=!0},PicaRoamPanel.prototype.onRoamListHandler=function(t,e){"close"===t?this.onCloseHandler():"roam"===t&&this.openRoamDrawPanel(e)},PicaRoamPanel.prototype.onRoamDrawHandler=function(t,e){if("close"===t)this.hideRoamDrawPanel(),this.showRoamListPanel();else if("draw"===t)this.render.renderEmitter(this.key+"_queryroamdraw",e.id),this.isOneDraw=e.one;else{if("notice"===t){var i={text:[{text:e,node:void 0}]};return void this.render.mainPeer.showMediator(s.ModuleName.PICANOTICE_NAME,!0,i)}if("pay"===t){var n=o.UIHelper.createMessageBoxConfig(e.text,o.i18n.t("roam.title"),this.key,"payDrawHandler",[e.id]);this.render.mainPeer.showMediator(s.ModuleName.PICAMESSAGEBOX_NAME,!0,n)}else"preview"===t?this.showRoamPreviewPanel():"progressrewards"===t&&this.render.renderEmitter(this.key+"_queryprogressrewards",e)}},PicaRoamPanel.prototype.onRoamPreviewHandler=function(t,e){"close"===t&&this.hideRoamPreviewPanel()},PicaRoamPanel.prototype.onRoamEffectOneHandler=function(t){this.render.renderEmitter(this.key+"_queryrareeffect")},PicaRoamPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_hide")},PicaRoamPanel}(h.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoomListPanel",(function(){return d})),i.d(e,"RoomDelegate",(function(){return u})),i.d(e,"RoomZoon",(function(){return f}));var n,a=i(1),s=i(6),o=i(479),h=i(0),l=i(2),c=i(21),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function PicaRoomListPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.mSelectIndex=0,i.key=h.ModuleName.PICAROOMLIST_NAME,i}return p(PicaRoomListPanel,t),PicaRoomListPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;this.content.x=n>>1,this.content.y=a>>1,this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,n,a),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains),t.prototype.resize.call(this,n,a),this.setSize(n,a)},PicaRoomListPanel.prototype.updateRoomList=function(t){t&&this.mRoomDele.updateList(t)},PicaRoomListPanel.prototype.updateMyRoomList=function(t){t&&this.mMyRoomDele.updateList(t)},PicaRoomListPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mSeachBtn.on("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mSeachBtn.off("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.destroy=function(){this.mScroller&&this.mScroller.destroy(),t.prototype.destroy.call(this)},PicaRoomListPanel.prototype.preload=function(){this.addAtlas(c.c.commonKey,c.d.commonUrl+".png",c.d.commonUrl+".json"),this.addAtlas(this.key,"pica_roomlist/pica_roomlist.png","pica_roomlist/pica_roomlist.json"),t.prototype.preload.call(this)},PicaRoomListPanel.prototype.init=function(){var e=this;this.setSize(this.scaleWidth,this.scaleWidth);var i=this.mWorld.uiScale,n=this.scene.make.image({key:this.key,frame:"bg.png"},!1).setInteractive();this.mBackGround=this.scene.make.graphics(void 0,!1),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1).setInteractive(),this.mCloseBtn.x=n.width/2-this.mCloseBtn.width/2-2*this.dpr,this.mCloseBtn.y=-n.height/2+this.mCloseBtn.height/2,this.mRoomDeleBtn=new s.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",l.i18n.t("room_list.visit")),this.mRoomDeleBtn.x=-54*this.dpr,this.mRoomDeleBtn.y=-n.height/2+this.mRoomDeleBtn.displayHeight/2-4*this.dpr,this.mRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:l.Font.DEFULT_FONT,fontSize:14*this.dpr}),this.mRoomDeleBtn.setFontStyle("bold"),this.mMyRoomDeleBtn=new s.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",l.i18n.t("room_list.my")),this.mMyRoomDeleBtn.x=54*this.dpr,this.mMyRoomDeleBtn.y=this.mRoomDeleBtn.y,this.mMyRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:l.Font.DEFULT_FONT,fontSize:16*this.dpr}),this.mMyRoomDeleBtn.setFontStyle("bold");var a=new o.CheckboxGroup;a.appendItemAll([this.mRoomDeleBtn,this.mMyRoomDeleBtn]),a.on("selected",this.onSelectedHandler,this),this.mSelectIndex=0,this.mRoomContainer=this.scene.make.container(void 0,!1),this.mRoomContainer.setSize(282*this.dpr,362*this.dpr),this.mRoomContainer.y=-n.height/2+11*this.dpr*i,this.mSeachBtn=this.scene.make.image({key:this.key,frame:"seach_btn.png"},!1).setInteractive(),this.mSeachBtn.y=n.height/2-this.mSeachBtn.height/2+12*this.dpr;var h=this.scene.make.text({x:-35*this.dpr,y:this.mSeachBtn.y,text:l.i18n.t("room_list.seach"),style:{color:"#996600",fontFamily:l.Font.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5),c=this.scene.make.text({x:35*this.dpr,y:this.mSeachBtn.y,text:l.i18n.t("room_list.room"),style:{color:"#996600",fontFamily:l.Font.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5);this.content=this.scene.make.container(void 0,!1),this.content.setSize(n.width,n.height),this.content.add([n,this.mRoomContainer,this.mCloseBtn,this.mSeachBtn,h,c]),this.add([this.mBackGround,this.content]),t.prototype.init.call(this),this.resize(0,0);var p=this.mRoomContainer.width*this.scale,d=this.mRoomContainer.height*this.scale,u={x:this.scaleWidth-p/this.scale>>1,y:this.content.y-this.content.height/2+20*this.dpr*this.scale,clickX:0,clickY:0,width:this.scaleWidth,height:d,boundPad0:-40*this.dpr*i,zoom:i,dpr:this.dpr,value:this.content.y,valuechangeCallback:function(t){e.mRoomContainer.y=t-e.content.y-d/2},cellupCallBack:function(t){t.onEnterRoomHandler()},overminCallbackScope:this,overminCallback:function(){e.mRoomDele&&0===e.mSelectIndex&&e.mRoomDele.overminHandler(),e.mMyRoomDele||1!==e.mSelectIndex||e.mMyRoomDele.overminHandler()}};this.mScroller=new s.BaseScroller(this.scene,this.mRoomContainer,u),this.content.add([this.mRoomDeleBtn,this.mMyRoomDeleBtn,this.mCloseBtn]),a.selectIndex(0)},PicaRoomListPanel.prototype.showRoomList=function(){this.mMyRoomDele&&(this.mMyRoomDele.removeFromContainer(),this.mMyRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mRoomDele||(this.mRoomDele=new u(this.mRoomContainer,this.mScroller,this.scene,this.mWorld,this.key,this.dpr)),this.mRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mRoomDele.addToContainer(),this.render.renderEmitter(h.ModuleName.PICAROOMLIST_NAME+"_getRoomList")},PicaRoomListPanel.prototype.showMyRoomList=function(){this.mRoomDele&&(this.mRoomDele.removeFromContainer(),this.mRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mMyRoomDele||(this.mMyRoomDele=new m(this.mRoomContainer,this.mScroller,this.mWorld,this.scene,this.key,this.dpr)),this.mMyRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mMyRoomDele.addToContainer(),this.render.renderEmitter(h.ModuleName.PICAROOMLIST_NAME+"_getMyRoomList")},PicaRoomListPanel.prototype.onEnterRoomHandler=function(t){this.render.renderEmitter(h.ModuleName.PICAROOMLIST_NAME+"_enterRoom",t)},PicaRoomListPanel.prototype.onSelectedHandler=function(t){if(t instanceof s.Button){switch(this.mRoomContainer.removeAll(!1),t){case this.mRoomDeleBtn:this.showRoomList(),this.mSelectIndex=0;break;case this.mMyRoomDeleBtn:this.showMyRoomList(),this.mSelectIndex=1}t.setTextColor("#996600"),this.preTabButton&&this.preTabButton.setTextColor("#3333cc"),this.preTabButton=t}},PicaRoomListPanel.prototype.onSeachHandler=function(){},PicaRoomListPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(h.ModuleName.PICAROOMLIST_NAME+"_close")},PicaRoomListPanel}(o.BasePanel),u=function(t){function RoomDelegate(e,i,n,a,s,o){void 0===o&&(o=1);var h=t.call(this)||this;return h.mChildPad=0,h.mDpr=1,h.mHeight=0,h.mDpr=o,h.mRender=a,h.mChildPad=0,h.mScene=n,h.mContainer=e,h.mScroller=i,h.mKey=s,h.init(),h}return p(RoomDelegate,t),RoomDelegate.prototype.addListen=function(){this.mPopularityRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.on("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.removeListen=function(){this.mPopularityRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.off("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.updateList=function(t){this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mContent&&this.mPopularityRoom.addItem(t.popularRooms,this.mChildPad)},RoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},RoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mPopularityRoom&&this.mPopularityRoom.clear(),this.mPlayerRoom&&this.mPlayerRoom.clear()},RoomDelegate.prototype.destroy=function(){this.removeListen(),this.mPlayerRoom&&this.mPopularityRoom.destroy(),this.mPopularityRoom&&this.mPopularityRoom.destroy(),this.mScroller&&this.mScroller.destroy(),this.activity&&this.activity.destroy(),t.prototype.destroy.call(this)},RoomDelegate.prototype.overminHandler=function(){var t=this.mPlayerRoom.updateItem();t&&this.mPlayerRoom.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mPlayerRoom.mRefreshRooms),this.setUpdateScrollInteractive(this.mPlayerRoom.mRefreshRooms))},RoomDelegate.prototype.setUpdateScrollInteractive=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];this.mScroller.setInteractiveObject(n)}this.mScroller.refreshBound(this.mHeight)},RoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad+=this.activity.height/2+18*this.mDpr,this.mPopularityRoom=new g(this.mScene,this.mKey,"popularity_icon.png",l.i18n.t("room_list.popularity_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mPopularityRoom.roomList&&t.setScrollInteractive(t.mPopularityRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mChildPad+=t.mPopularityRoom.height,t.mPlayerRoom.addItem(t.mContent.playerRooms,t.mChildPad)})),this.mPlayerRoom=new f(this.mScene,this.mKey,"player_icon.png",l.i18n.t("room_list.player_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mPlayerRoom.roomList&&t.setScrollInteractive(t.mPlayerRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},RoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mPopularityRoom&&this.mPopularityRoom.showList&&(this.mContainer.add(this.mPopularityRoom.showList),this.mPopularityRoom.roomList&&this.mPopularityRoom.roomList.forEach((function(e){t.mContainer.add(e)}))),this.mPlayerRoom&&this.mPlayerRoom.showList&&(this.mContainer.add(this.mPlayerRoom.showList),this.mPlayerRoom.roomList&&this.mPlayerRoom.roomList.forEach((function(e){t.mContainer.add(e)})))},RoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomDelegate.prototype.setScrollInteractive=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];this.mScroller.setInteractiveObject(n)}this.refreshPos()},RoomDelegate}(Phaser.Events.EventEmitter),m=function(t){function MyRoomDelegate(e,i,n,a,s,o){return void 0===o&&(o=1),t.call(this,e,i,a,n,s,o)||this}return p(MyRoomDelegate,t),MyRoomDelegate.prototype.addListen=function(){this.mMyRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.on("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.removeListen=function(){this.mMyRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.off("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},MyRoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mMyRoom&&this.mMyRoom.clear(),this.mMyHistory&&this.mMyHistory.clear()},MyRoomDelegate.prototype.updateList=function(t){this.mMyRoom&&(this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom.addItem(t.selfRooms,this.mChildPad))},MyRoomDelegate.prototype.overminHandler=function(){var t=this.mMyHistory.updateItem();t&&this.mMyHistory.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mMyHistory.mRefreshRooms),this.setUpdateScrollInteractive(this.mMyHistory.mRefreshRooms))},MyRoomDelegate.prototype.destroy=function(){this.mMyRoom&&this.mMyRoom.destroy(),this.mMyHistory&&this.mMyHistory.destroy(),t.prototype.destroy.call(this)},MyRoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mMyRoom&&this.mMyRoom.showList&&(this.mContainer.add(this.mMyRoom.showList),this.mMyRoom.roomList&&this.mMyRoom.roomList.forEach((function(e){t.mContainer.add(e)}))),this.mMyHistory&&this.mMyHistory.showList&&(this.mContainer.add(this.mMyHistory.showList),this.mMyHistory.roomList&&this.mMyHistory.roomList.forEach((function(e){t.mContainer.add(e)})))},MyRoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom=new y(this.mScene,this.mKey,"my_room_icon.png",l.i18n.t("room_list.my_room"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mMyRoom.roomList&&t.setScrollInteractive(t.mMyRoom.roomList),t.mHeight+=e,t.refreshPos(),t.mChildPad+=t.mMyRoom.height,t.mMyHistory.addItem(t.mContent.historyRooms,t.mChildPad)})),this.mMyHistory=new f(this.mScene,this.mKey,"history_icon.png",l.i18n.t("room_list.my_history"),this.mDpr,this.mRender.uiScale,0,this.mChildPad,(function(e){t.mMyHistory.roomList&&t.setScrollInteractive(t.mMyHistory.roomList),t.mHeight+=e,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},MyRoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},MyRoomDelegate}(u),f=function(t){function RoomZoon(e,i,n,a,s,o,h,c,p){void 0===h&&(h=0),void 0===c&&(c=0);var d=t.call(this)||this;return d.mWidth=0,d.mHeight=0,d.mPad1=0,d.mShowList=[],d.mScene=e,d.mKey=i,d.mDpr=s,d.uiScale=o,d.mPad=c,d.mOrientaction=h,d.mIconFrame=n,d.mLabel=a,d.icon=e.make.image({key:i,frame:n},!1),d.icon.x=h?-254*s/2+c:-254*s/2,d.icon.y=h?0:c,d.text=e.make.text({text:a,style:{color:"#ffcc33",fontSize:16*s,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),d.text.setStroke("#663300",2*s),d.text.x=h?d.icon.x+d.icon.width/2+4*s+c:d.icon.x+d.icon.width/2+4*s,d.text.y=h?0:c,d.mWidth=d.icon.width,d.mHeight=d.icon.height,d.mAddCallBack=p,d.mRooms=[],d}return p(RoomZoon,t),Object.defineProperty(RoomZoon.prototype,"showList",{get:function(){return this.mShowList},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"roomList",{get:function(){return this.mRooms},enumerable:!1,configurable:!0}),RoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad,this.mPad1=e;var i=this.uiScale,n=this.mOrientaction?this.mPad+e:0,a=6*this.mDpr*i;if(t.length>0){var s=t.length;this.mPad+=this.icon.height+12*this.mDpr*i;for(var o=0;o<s;o++)if(o*(P.Hei+a)+this.mPad<=362*this.mDpr+P.Hei+a){var h=new P(this.mScene,this.mKey,this.mDpr);h.setInfo(t[0]),t.splice(0,1),h.on("enterRoom",this.onEnterRoomHandler,this),h.x=n;var c=o*(P.Hei+a)+this.mPad;this.mRooms.push(h),h.y=c,this.mHeight+=P.Hei+a}this.mRoomDatas=t}this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},RoomZoon.prototype.updateItem=function(){var t=this.mRoomDatas.slice(0,10),e=t.length;if(e<1)return 0;var i=this.uiScale,n=this.mOrientaction?this.mPad+this.mPad1:0,a=6*this.mDpr*i,s=this.mRooms.length;this.mRefreshRooms=[];for(var o=0,h=0;h<e;h++){var l=new P(this.mScene,this.mKey,this.mDpr);l.setInfo(t[h]),l.on("enterRoom",this.onEnterRoomHandler,this),l.x=n;var c=(h+s)*(P.Hei+a)+this.mPad;l.y=c,this.mRefreshRooms.push(l),this.mRooms.push(l),this.mHeight+=P.Hei+a,o+=P.Hei+a}return this.mRoomDatas.splice(0,10),o},Object.defineProperty(RoomZoon.prototype,"width",{get:function(){return this.mWidth},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"height",{get:function(){return this.mHeight},enumerable:!1,configurable:!0}),RoomZoon.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},RoomZoon.prototype.clear=function(){for(var t=0,e=this.mRooms;t<e.length;t++){e[t].destroy()}for(var i=0,n=this.mShowList;i<n.length;i++){n[i].destroy()}this.icon.destroy(),this.text.destroy(),this.mShowList.length=0,this.mRooms.length=0},RoomZoon.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomZoon}(Phaser.Events.EventEmitter),y=function(t){function MyRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return p(MyRoomZoon,t),MyRoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad;var i=this.uiScale,n=this.mOrientaction?this.mPad+e:0,a=6*this.mDpr*i;if(t.length>0){this.mPad+=this.icon.height+14*this.mDpr*i;for(var s=0;s<t.length;s++){var o=new _(this.mScene,this.mKey,this.mDpr);o.setInfo(t[s]),o.on("enterRoom",this.onEnterRoomHandler,this),o.x=n;var h=s*(P.Hei+a)+this.mPad;o.y=h,this.mRooms[s]=o,this.mHeight+=P.Hei+a}}this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},MyRoomZoon}(f),g=function(t){function PopularRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return p(PopularRoomZoon,t),PopularRoomZoon.prototype.addItem=function(t,e){void 0===e&&(e=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+e:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:e,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+e:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:e,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=e||this.mPad;var i=this.uiScale,n=this.mOrientaction?this.mPad:0,a=6*this.mDpr*i;if(t.length>0){this.mPad+=this.icon.height+12*this.mDpr*i;for(var s=0;s<t.length;s++){var o=new v(this.mScene,this.mKey,this.mDpr);o.setInfo(t[s]),o.setRank(s+1),o.on("enterRoom",this.onEnterRoomHandler,this),o.x=n;var h=s*(o.height+a)+this.mPad;o.y=h,this.mHeight+=o.height+a,this.mRooms[s]=o}}return this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight),this.mHeight},PopularRoomZoon}(f),P=function(t){function RoomItem(e,i,n){void 0===n&&(n=1);var a=t.call(this,e)||this;return a.mKey=i,a.mDpr=n,a.init(i,n),a}return p(RoomItem,t),RoomItem.prototype.setInfo=function(t){t&&(t.name&&this.mNickName.setText(t.name),t.playerCount&&this.mCounter.setText(t.playerCount.toString())),this.mCounterIcon.x=this.mCounter.x-this.mCounter.width/2-this.mCounterIcon.width/2-4*this.mDpr,this.mRoom=t},RoomItem.prototype.roomData=function(){return this.mRoom},RoomItem.prototype.onEnterRoomHandler=function(t){this.mRoom&&this.emit("enterRoom",this.mRoom.roomId)},RoomItem.prototype.init=function(t,e){this.mBackground=this.scene.make.image({key:t,frame:"room_gray.png"},!1).setInteractive(),this.setSize(this.mBackground.width,this.mBackground.height),RoomItem.Hei=this.mBackground.height,this.mNickName=this.scene.make.text({style:{color:"#000000",fontFamily:l.Font.DEFULT_FONT,fontSize:14*e}},!1),this.mNickName.x=-this.width/2+12*e,this.mNickName.y=-this.mNickName.height/2,this.mCounterIcon=this.scene.make.image({key:c.c.commonKey,frame:"home_persons"},!1),this.mCounter=this.scene.make.text({style:{color:"#000000",fontFamily:l.Font.DEFULT_FONT,fontSize:14*e}},!1).setOrigin(.5),this.mCounter.x=this.width/2-23*e,this.add([this.mBackground,this.mNickName,this.mCounterIcon,this.mCounter])},RoomItem.prototype.crateLabel=function(t){var e="",i="";t===a.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_LOCKED?(e="passworld_label.png",i=l.i18n.t("room_list.password")):t===a.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_PRIVATE&&(e="close_label.png",i=l.i18n.t("room_list.close")),""!==e&&""!==i&&(this.mLabelImg=this.scene.make.image({key:this.mKey,frame:e},!1),this.mLabelText=this.scene.make.text({text:i,style:{color:"#666666",fontFamily:l.Font.DEFULT_FONT,fontSize:12*this.mDpr}},!1).setOrigin(0,.5),this.add([this.mLabelImg,this.mLabelText]),this.mLabelImg.x=this.width/2-85*this.mDpr,this.mLabelText.x=this.mLabelImg.x-7*this.mDpr)},RoomItem}(Phaser.GameObjects.Container),_=function(t){function MyRoomItem(e,i,n){return void 0===n&&(n=1),t.call(this,e,i,n)||this}return p(MyRoomItem,t),MyRoomItem.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.mBackground&&this.mBackground.setFrame("room_yellow.png"),this.mNickName&&(this.mNickName.setColor("#663300"),this.mCounter.setColor("#663300"))},MyRoomItem}(P),v=function(t){function PopularRoomItem(e,i,n){return void 0===n&&(n=1),t.call(this,e,i,n)||this}return p(PopularRoomItem,t),PopularRoomItem.prototype.setRank=function(t){this.mRankImage&&(this.mRankImage.setTexture(this.mKey,"rank_"+t+".png"),this.mRankImage.x=-this.width/2+this.mRankImage.width/2-2*this.mDpr,this.add(this.mRankImage))},PopularRoomItem.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.mRankImage=this.scene.make.image(void 0,!1),this.mNickName.x=-this.width/2+37*i},PopularRoomItem}(_)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskPanel",(function(){return m}));var n,a=i(1),s=i(479),o=i(0),h=i(21),l=i(2),c=i(480),p=i(535),d=i(6),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),m=function(t){function PicaTaskPanel(e){var i=t.call(this,e)||this;return i.key=o.ModuleName.PICATASK_NAME,i.atlasNames=[h.d.uicommon],i}return u(PicaTaskPanel,t),PicaTaskPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRect(-this.x,-this.y,n,a),this.bg.clear(),this.bg.fillStyle(0,.6),this.bg.fillRect(0,0,this.content.width,a),this.bg.x=.5*-this.content.width,this.bg.y=.5*-this.content.height,this.rewardLine.clear(),this.rewardLine.fillStyle(16777215,.6),this.rewardLine.fillRect(-136*this.dpr,0,272*this.dpr,1*this.dpr),this.selectLine.clear(),this.selectLine.fillStyle(16774217,.5),this.selectLine.fillRect(-29*this.dpr,0,58*this.dpr,2*this.dpr),this.content.x=.5*-this.content.width-10*this.dpr,this.content.y=.5*a,this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains),this.mainPanel.refreshMask()},PicaTaskPanel.prototype.addListen=function(){this.mInitialized&&this.blackBg.on("pointerup",this.OnClosePanel,this)},PicaTaskPanel.prototype.removeListen=function(){this.mInitialized&&this.blackBg.off("pointerup",this.OnClosePanel,this)},PicaTaskPanel.prototype.init=function(){this.setSize(this.scaleWidth,this.scaleHeight),this.blackBg=this.scene.make.graphics(void 0,!1);var e=300*this.dpr,i=this.height;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.content.setInteractive(),this.add([this.blackBg,this.content]),this.bg=this.scene.make.graphics(void 0,!1),this.tilteName=this.scene.make.text({text:l.i18n.t("task.title"),style:l.UIHelper.whiteStyle(this.dpr,18)}),this.tilteName.setOrigin(0,.5),this.tilteName.setFontStyle("bold"),this.tilteName.x=.5*-e+20*this.dpr,this.tilteName.y=.5*-i+40*this.dpr,this.selectLine=this.scene.make.graphics(void 0,!1),this.rewardLine=this.scene.make.graphics(void 0,!1),this.rewardLine.x=0,this.rewardLine.y=this.tilteName.y+55*this.dpr,this.content.add([this.bg,this.tilteName,this.rewardLine,this.selectLine]);var n=.5*this.height-this.rewardLine.y-10*this.dpr;this.mainPanel=new p.PicaTaskMainPanel(this.scene,this.content.width,n,this.dpr,this.scale),this.mainPanel.setHandler(new l.Handler(this,this.onMainPanelHandler)),this.mainPanel.y=.5*this.height-.5*n,this.content.add(this.mainPanel),this.createOptionButtons(),this.resize(),t.prototype.init.call(this),this.playMove()},PicaTaskPanel.prototype.createOptionButtons=function(){for(var t,e=[{text:l.i18n.t("task.main_quest"),type:a.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION},{text:l.i18n.t("task.daily_quest"),type:a.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL}],i=272*this.dpr,n=i/e.length,o=20*this.dpr,h=-i/2,c=.5*-this.height+75*this.dpr,p=0;p<e.length;p++){var u=e[p],m=new s.ToggleColorButton(this.scene,n,20*this.dpr,this.dpr,u.text);m.on(d.ClickEvent.Tap,this.onToggleButtonHandler,this),m.x=h+.5*n,m.y=c,m.setData("item",u.type),m.setSize(n,o),this.content.add(m),m.setChangeColor("#FFF449"),m.setFontSize(14*this.dpr),h+=n,t||(t=m)}t.isOn=!0,this.onToggleButtonHandler(void 0,t)},PicaTaskPanel.prototype.setTaskDatas=function(t){this.mainPanel.setTaskDatas(t,this.questType)},PicaTaskPanel.prototype.setTaskDetail=function(t){},PicaTaskPanel.prototype.onToggleButtonHandler=function(t,e){this.curToggleItem!==e&&(this.curToggleItem&&(this.curToggleItem.isOn=!1),this.curToggleItem=e,this.questType=e.getData("item"),this.selectLine.x=e.x,this.selectLine.y=e.y+20*this.dpr,this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_questlist",this.questType))},PicaTaskPanel.prototype.onMainPanelHandler=function(t,e){"finish"===t?this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_submitquest",e):"go"===t||"detail"===t||"reward"===t&&this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_queryreward",this.questType)},PicaTaskPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICATASK_NAME+"_hide")},PicaTaskPanel.prototype.playMove=function(){var t=this,e=.5*-this.content.width-10*this.dpr,i=.5*this.content.width,n=this.scene.tweens.add({targets:this.content,x:{from:e,to:i},ease:"Linear",duration:300,onComplete:function(){n.stop(),n.remove(),t.mainPanel.refreshMask(),t.mainPanel.moveFinish()}})},PicaTaskPanel}(c.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTaskSidePanel",(function(){return n}));var n=function n(){}},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaTreasurePanel",(function(){return u}));var n,a=i(21),s=i(0),o=i(2),h=i(480),l=i(537),c=i(538),p=i(539),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function PicaTreasurePanel(e){var i=t.call(this,e)||this;return i.atlasNames=[a.d.treasure,a.d.uicommon1,a.d.uicommon,a.d.circleeffect,a.d.stareffect],i.key=s.ModuleName.PICATREASURE_NAME,i}return d(PicaTreasurePanel,t),PicaTreasurePanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.88),this.blackGraphic.fillRect(0,0,n,a),this.content.x=n/2,this.content.y=a/2,this.setSize(n*this.scale,a*this.scale)},PicaTreasurePanel.prototype.onShow=function(){this.setInteractive(),this.setTreasureData(this.showData)},PicaTreasurePanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.previewPanel&&this.previewPanel.destroy(),this.treasureOpenPanel&&this.treasureOpenPanel.destroy(),this.treasureAllOpenPanel&&this.treasureAllOpenPanel.destroy()},PicaTreasurePanel.prototype.init=function(){var e=this.cameraWidth,i=this.cameraHeight;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,e/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.add(this.content),this.resize(0,0),t.prototype.init.call(this)},PicaTreasurePanel.prototype.setTreasureData=function(t){this.trasureData=t,this.mInitialized&&t&&("preview"===t.type?this.setPreviewData(t.data):"open"===t.type?this.setTreasureOpenData(t.data):"roamdraw"===t.type?this.setTreasureAllOpenData(t.data):this.setPreviewData(t.data))},PicaTreasurePanel.prototype.setPreviewData=function(t){this.openPreviewPanel(),this.previewPanel.setTreasureData(t)},PicaTreasurePanel.prototype.setTreasureOpenData=function(t){this.openTreasureOpenPanel(),this.treasureOpenPanel.setTreasureData(t)},PicaTreasurePanel.prototype.setTreasureAllOpenData=function(t){this.openTreasureAllOpenPanel(),this.treasureAllOpenPanel.setTreasureData(t)},PicaTreasurePanel.prototype.openPreviewPanel=function(){var t=this,e=334*this.dpr,i=353*this.dpr;this.previewPanel||(this.previewPanel=new p.PicaTreasurePreviewPanel(this.scene,this.render,e,i,this.key,this.dpr,this.scale),this.previewPanel.setHandler(new o.Handler(this,(function(){t.hidePreviewPanel(),t.setTreasureOpenData(new Array(6))})),new o.Handler(this,this.OnCloseHandler))),this.content.add(this.previewPanel),this.previewPanel.resize(e,i),this.previewPanel.addListen()},PicaTreasurePanel.prototype.hidePreviewPanel=function(){this.content.remove(this.previewPanel),this.previewPanel.removeListen()},PicaTreasurePanel.prototype.openTreasureOpenPanel=function(){var t=this.width,e=310*this.dpr;this.treasureOpenPanel||(this.treasureOpenPanel=new c.PicaTreasureOpenPanel(this.scene,t,e,this.key,this.dpr,this.scale),this.treasureOpenPanel.setHandler(new o.Handler(this,this.OnCloseHandler)),this.treasureOpenPanel.y=-20*this.dpr),this.content.add(this.treasureOpenPanel),this.treasureOpenPanel.resize(t,e),this.treasureOpenPanel.addListen()},PicaTreasurePanel.prototype.hideOpenPanel=function(){this.content.remove(this.treasureOpenPanel),this.treasureOpenPanel.removeListen()},PicaTreasurePanel.prototype.openTreasureAllOpenPanel=function(){var t=this.width,e=320*this.dpr;this.treasureAllOpenPanel||(this.treasureAllOpenPanel=new l.PicaTreasureAllOpenPanel(this.scene,t,e,this.key,this.dpr,this.scale),this.treasureAllOpenPanel.setHandler(new o.Handler(this,this.OnCloseHandler)),this.treasureAllOpenPanel.y=-20*this.dpr),this.content.add(this.treasureAllOpenPanel),this.treasureAllOpenPanel.resize(t,e),this.treasureAllOpenPanel.addListen()},PicaTreasurePanel.prototype.hideAllOpenPanel=function(){this.content.remove(this.treasureAllOpenPanel),this.treasureAllOpenPanel.removeListen()},PicaTreasurePanel.prototype.OnCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},PicaTreasurePanel}(h.PicaBasePanel)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaWorkPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(0),h=i(21),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaWorkPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=o.ModuleName.PICAWORK_NAME,i.workItems=[],i}return c(PicaWorkPanel,t),PicaWorkPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,a),this.content.x=.5*n,this.content.y=.5*a,this.mGameScroll.refreshMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains),this.itemtips.setInvalidArea(l.Tool.getRectangle(this.helpBtn,this.scene))},PicaWorkPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaWorkPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.preload=function(){this.addAtlas(this.key,"work/work.png","work/work.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),this.addAtlas(h.c.common2Key,h.d.common2Url+".png",h.d.common2Url+".json"),t.prototype.preload.call(this)},PicaWorkPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new a.NineSlicePatch(this.scene,0,0,i,n,h.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var o=.5*-n;this.titlebg=this.scene.make.image({x:0,y:0,key:h.c.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=o+3*this.dpr,this.tilteName=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:l.i18n.t("work.title"),style:{color:"#905C06",fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5),this.closeBtn=this.scene.make.image({x:.5*i-5*this.dpr,y:o+5*this.dpr,key:h.c.commonKey,frame:"close"}),this.tilteName.setStroke("#905C06",2),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive(),this.timesPorgress=new m(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_orange",l.i18n.t("work.worktimes"),this.dpr),this.timesPorgress.setImageValue(this.key,"icon_work"),this.timesPorgress.y=.5*-n+40*this.dpr,this.timesPorgress.x=-43*this.dpr,this.powerProgress=new m(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_blue",l.i18n.t("work.vim"),this.dpr),this.powerProgress.setImageValue(this.key,"icon_strength"),this.powerProgress.y=this.timesPorgress.y,this.powerProgress.x=70*this.dpr,this.helpBtn=new a.Button(this.scene,this.key,"icon_tips","icon_tips"),this.helpBtn.y=this.powerProgress.y,this.helpBtn.x=this.powerProgress.x+.5*this.powerProgress.width+5*this.dpr+.5*this.helpBtn.width,this.helpBtn.on(a.ClickEvent.Tap,this.onHelpHandler,this),this.mGameScroll=new a.GameScroller(this.scene,{x:0,y:18*this.dpr,width:i,height:n-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){e.onPointerUpHandler(t)}}),this.itemtips=new s.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,h.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.timesPorgress,this.powerProgress,this.helpBtn,this.mGameScroll,this.itemtips]),this.resize(),t.prototype.init.call(this),this.emit("questlist")},PicaWorkPanel.prototype.setWorkDataList=function(t){var e=t.jobs;this.mGameScroll.clearItems(!1);for(var i=0,n=this.workItems;i<n.length;i++){(s=n[i]).visible=!1}for(var a=0;a<e.length;a++){var s=void 0;a<this.workItems.length?s=this.workItems[a]:(s=new d(this.scene,this.key,this.dpr),this.workItems.push(s),s.setHandler(new l.Handler(this,this.onSendHandler),new l.Handler(this,this.onItemInfoTips))),s.visible=!0,s.setJobData(e[a]),this.mGameScroll.addItem(s)}this.mGameScroll.Sort()},PicaWorkPanel.prototype.setProgressData=function(t,e){e&&this.timesPorgress.setProgressDatas(e),t&&this.powerProgress.setProgressDatas(t)},PicaWorkPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaWorkPanel.prototype.onHelpHandler=function(){this.itemtips.setVisible(!this.itemtips.visible),this.itemtips.setText(l.i18n.t("work.worktips")),this.itemtips.setTipsPosition(this.helpBtn,this.content)},PicaWorkPanel.prototype.OnClosePanel=function(){this.emit("hide")},PicaWorkPanel.prototype.onPointerUpHandler=function(t){this.selectItem&&this.selectItem.setExtend(!1),t.setExtend(!0),this.selectItem=t,this.mGameScroll.Sort(!0)},PicaWorkPanel.prototype.onSendHandler=function(t){this.emit("questwork",t)},PicaWorkPanel.prototype.onItemInfoTips=function(t,e,i){this.itemtips.visible=e,this.itemtips.x=i.x*this.scale-this.content.x,this.itemtips.y=i.y*this.scale-this.content.y-30*this.dpr,this.itemtips.setText(this.getDesText(t))},PicaWorkPanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),l.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaWorkPanel}(s.BasePanel),d=function(t){function WorkItem(e,i,n){var o=t.call(this,e)||this;o.imageValues=[],o.isExtend=!1,o.pointTimestamp=0,o.key=i,o.dpr=n;var c=256*n,p=68*n;o.setSize(c,p),o.topCon=e.make.container(void 0,!1),o.add(o.topCon),o.topCon.setSize(c,p),o.bg=new a.NineSlicePatch(o.scene,0,0,c,p,o.key,"bg_default",{left:6*o.dpr,top:0*o.dpr,bottom:0*o.dpr,right:6*n}),o.headIcon=new s.DynamicImage(e,0,0),o.title=e.make.text({x:.5*-o.width+60*n,y:.5*-p+5*n,text:"",style:{color:"#ffffff",fontSize:13*n,fontFamily:l.Font.DEFULT_FONT}}),o.salaryvalue=new s.ImageValue(e,60*n,20*n,o.key,void 0,o.dpr),o.salaryvalue.setTextStyle({color:"#FFEA00"}),o.salaryvalue.setFrameValue("",h.c.commonKey,"iv_coin"),o.salaryvalue.x=.5*o.width-30*n,o.salaryvalue.y=.5*-o.height+10*n,o.salaryLabel=e.make.text({x:o.salaryvalue.x-.5*o.salaryvalue.width-5*n,y:o.salaryvalue.y,text:l.i18n.t("work.salary")+":",style:{color:"#ffffff",fontSize:11*n,fontFamily:l.Font.DEFULT_FONT}}),o.salaryLabel.setOrigin(1,.5),o.worklabel=e.make.text({x:.5*-o.width+60*n,y:.5*o.height-12*n,text:"",style:{color:"#ffffff",fontSize:11*n,fontFamily:l.Font.DEFULT_FONT}}),o.worklabel.setOrigin(0,.5),o.topCon.add([o.bg,o.headIcon,o.title,o.salaryvalue,o.salaryLabel,o.worklabel]);var d=46*n;return o.bottomCon=e.make.container(void 0,!1),o.bottomCon.setSize(c,d),o.workbg=new a.NineSlicePatch(o.scene,0,0,o.width,d,o.key,"bg_a_unfold",{left:6*o.dpr,top:0*o.dpr,bottom:0*o.dpr,right:6*n}),o.workBtn=new a.NineSliceButton(e,0,0,90*n,36*n,h.c.commonKey,"yellow_btn_normal",l.i18n.t("work.title"),n,void 0,{left:14*o.dpr,top:14*o.dpr,bottom:14*o.dpr,right:14*n}),o.workBtn.x=0,o.workBtn.setTextStyle({fontSize:12*n,color:"#996600",fontFamily:l.Font.DEFULT_FONT}),o.workBtn.setFontStyle("bold"),o.bottomCon.add([o.workbg,o.workBtn]),o.workBtn.on(String(a.ClickEvent.Tap),o.onWorkHandler,o),o}return c(WorkItem,t),WorkItem.prototype.setHandler=function(t,e){this.sendHandler=t,this.tipsHandler=e},WorkItem.prototype.setJobData=function(t){var e=this;this.jobData=t;var i=l.Url.getOsdRes(t.display.texturePath);this.headIcon.load(i,this,(function(){e.headIcon.scale=1,e.headIcon.scaleX=45*e.dpr/e.headIcon.displayHeight,e.headIcon.scaleY=e.headIcon.scaleX,e.headIcon.x=.5*-e.width+.5*e.headIcon.displayWidth+10*e.dpr})),this.title.text=t.name;var n="0";if(t.rewards){var a=t.rewards[0].countRange;n=a.start+"~"+a.stop}this.salaryvalue.setText(n),this.salaryvalue.x=.5*this.width-.5*this.salaryvalue.width-10*this.dpr,this.salaryLabel.x=this.salaryvalue.x-.5*this.salaryvalue.width-5*this.dpr,this.worklabel.text=t.detail;for(var s=t.targets,o=0,h=this.imageValues;o<h.length;o++){(d=h[o]).visible=!1}for(var c=.5*-this.width+55*this.dpr,p=0;p<s.length;p++){var d=void 0,m=s[p];p<this.imageValues.length?d=this.imageValues[p]:(d=new u(this.scene,35*this.dpr,15*this.dpr,this.key,this.dpr),this.topCon.add(d),this.imageValues.push(d),d.setHandler(new l.Handler(this,this.onTipsandler)));var f=l.Url.getOsdRes(m.display.texturePath);d.setUrlValue(f,m.neededCount),d.setTextStyle({color:m.count>=m.neededCount?"#000000":"#E71313"}),d.setImageData(m),d.visible=!0,d.x=c+.5*d.width,d.y=0,c+=d.width+20*this.dpr}},WorkItem.prototype.setExtend=function(t){if(this.isExtend!==t)if(this.isExtend=t,this.bottomCon.visible=t,t){this.add(this.bottomCon);var e=this.topCon.height+this.bottomCon.height;this.setSize(this.width,e),this.topCon.y=.5*-e+.5*this.topCon.height,this.bottomCon.y=this.topCon.y+.5*this.topCon.height+.5*this.bottomCon.height,this.bg.setFrame("bg_click")}else{this.remove(this.bottomCon);e=this.topCon.height;this.setSize(this.width,e),this.topCon.y=0,this.bg.setFrame("bg_default")}},WorkItem.prototype.destroy=function(e){t.prototype.destroy.call(this,e)},WorkItem.prototype.onWorkHandler=function(){var t=(new Date).getTime();this.pointTimestamp>t||(this.pointTimestamp=t+1e3,this.sendHandler&&this.sendHandler.runWith(this.jobData.id))},WorkItem.prototype.onTipsandler=function(t,e){var i=t.getWorldTransformMatrix();this.tipsHandler&&this.tipsHandler.runWith([t.imageData,e,new Phaser.Geom.Point(i.tx,i.ty)])},WorkItem}(Phaser.GameObjects.Container),u=function(t){function PointerImageValue(e,i,n,a,s){var o=t.call(this,e,i,n,a,void 0,s)||this;return o.addListen(),o}return c(PointerImageValue,t),PointerImageValue.prototype.setImageData=function(t){this.imageData=t},PointerImageValue.prototype.setUrlValue=function(t,e){var i=this;this.value.text=e,this.icon.load(t,this,(function(){i.icon.scale=1,i.icon.scaleY=14*i.dpr/i.icon.displayHeight,i.icon.scaleX=i.icon.scaleY,i.value.x=i.icon.x+.5*i.icon.displayWidth+10*i.dpr,i.resetSize()}))},PointerImageValue.prototype.addListen=function(){this.setInteractive(),this.on("pointerdown",this.onClickDownHandler,this),this.scene.input.on("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.removeListen=function(){this.disableInteractive(),this.off("pointerdown",this.onClickDownHandler,this),this.scene.input.off("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},PointerImageValue.prototype.setHandler=function(t){this.tipsHandler=t},PointerImageValue.prototype.create=function(){this.icon=new s.DynamicImage(this.scene,0,0),this.value=this.scene.make.text({x:0,y:this.offset.y,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},PointerImageValue.prototype.onClickDownHandler=function(){new Phaser.Geom.Point;this.tipsHandler&&this.tipsHandler.runWith([this,!0])},PointerImageValue.prototype.onClickUpHandler=function(){this.tipsHandler&&this.tipsHandler.runWith([this,!1])},PointerImageValue}(s.ImageValue),m=function(t){function ProgressItem(e,i,n,o,h,c,p){var d=t.call(this,e)||this;d.setSize(i,n),d.dpr=p,d.key=o;var u={x:0,y:0,width:i,height:n,background:{x:0,y:0,width:i,height:n,config:{top:0*p,left:7*p,right:7*p,bottom:0*p},key:o,frame:"slider_bottom"},bar:{x:0,y:0,width:i-4*p,height:n-4*p,config:{top:0*p,left:7*p,right:7*p,bottom:0*p},key:o,frame:h},dpr:p,textConfig:void 0};return d.progress=new a.ProgressBar(e,u),d.add(d.progress),d.imgvalue=new s.ImageValue(e,d.width-20*p,d.height,o,void 0,p),d.imgvalue.y=p,d.add(d.imgvalue),d.imgvalue.setTextStyle({fontSize:10*p,fontFamily:l.Font.NUMBER}),d.imgvalue.setTextFilter(Phaser.Textures.FilterMode.LINEAR),d.title=e.make.text({x:.5*-d.progress.width-3*p,y:0,text:c,style:{color:"#6A7AFF",fontSize:9*p,fontFamily:l.Font.DEFULT_FONT}}),d.title.setOrigin(1,.5),d.add(d.title),d}return c(ProgressItem,t),ProgressItem.prototype.setImageValue=function(t,e){this.imgvalue.setFrameValue("",t,e)},ProgressItem.prototype.setProgressDatas=function(t){this.progress.setProgress(t.value,t.max),this.imgvalue.setText(t.value+"/"+t.max)},ProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"TaskPanel",(function(){return d}));var n,a=i(1),s=i(6),o=i(479),h=i(0),l=i(21),c=i(2),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),d=function(t){function TaskPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.taskItems=[],i.key=h.ModuleName.PICATASK_NAME,i}return p(TaskPanel,t),TaskPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,n,a),this.content.x=.5*n,this.content.y=.5*a,this.mGameScroll.refreshMask(),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains)},TaskPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},TaskPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.preload=function(){this.addAtlas(this.key,"task/task.png","task/task.json"),this.addAtlas(l.c.commonKey,l.d.commonUrl+".png",l.d.commonUrl+".json"),t.prototype.preload.call(this)},TaskPanel.prototype.init=function(){this.setSize(this.scaleWidth,this.scaleWidth),this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg);var e=300*this.dpr,i=418*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=new s.NineSlicePatch(this.scene,0,0,e,i,l.c.commonKey,"bg",{left:40,top:40,bottom:50,right:50});var n=this.bg.width,a=this.bg.height,o=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:o,key:this.key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=o-.5*this.titlebg.height+20*this.dpr;var p="bold "+15*this.dpr+"px Source Han Sans";this.tilteName=this.scene.make.text({x:0,y:o-12*this.dpr,text:c.i18n.t("task.title"),style:{font:p,color:"#8F4300",fontSize:15*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:o+5*this.dpr,key:l.c.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",1),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive();var d=this.scene.make.container(void 0,!1);d.setSize(80*this.dpr,30*this.dpr),d.setPosition(.5*-n+70*this.dpr,.5*-a+30*this.dpr),d.setInteractive(),d.on("pointerup",this.onOpenOptionHandler,this),this.optionText=this.scene.make.text({x:-30*this.dpr,y:0,text:c.i18n.t("task.all_task"),style:{color:"#8F4300",fontSize:16*this.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),this.optionArrow=this.scene.make.image({x:0,y:0,key:this.key,frame:"drop_down"}),this.optionArrow.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.optionArrow.x=this.optionText.x+this.optionText.width+10*this.dpr,d.add([this.optionText,this.optionArrow]);var u=253*this.dpr,m=this.scene.make.graphics(void 0,!1);m.clear(),m.fillStyle(12632256,1),m.fillRect(.5*-u,-1,u,2),m.y=.5*-a+50*this.dpr,this.optionCon=this.scene.make.container(void 0,!1),this.optionCon.visible=!1,this.optionCon.y=.5*-a+50*this.dpr,this.mGameScroll=new s.GameScroller(this.scene,{x:0,y:18*this.dpr,width:n,height:a-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:20*this.dpr,padding:{top:2*this.dpr}}),this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.mGameScroll,d,m,this.optionCon]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(h.ModuleName.PICATASK_NAME+"_questlist")},TaskPanel.prototype.setTaskDatas=function(t){this.mInitialized&&(this.curTaskItem&&this.curTaskItem.setExtend(!1),this.taskDatas=t,this.setTaskOptions(),this.setTaskItems(t),this.onTaskOptionHandler(this.curOptionItem))},TaskPanel.prototype.setTaskOptions=function(){for(var t=[0,a.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION,a.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION,a.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL],e=this.optionCon.list,i=0,n=e;i<n.length;i++){(o=n[i]).visible=!1}for(var s=0;s<t.length;s++){var o=void 0;s<e.length?o=e[s]:((o=new y(this.scene,this.key,this.dpr)).setHandler(new c.Handler(this,this.onTaskOptionHandler)),this.optionCon.add(o)),o.visible=!0,o.setOptionData(t[s])}for(var h=0,l=0,p=e;l<p.length;l++){var d=p[l];d.y=d.height*d.originY+h,h+=d.height+2}this.curOptionItem||(this.curOptionItem=e[0])},TaskPanel.prototype.setTaskDetail=function(t){this.curTaskItem&&t&&this.curTaskItem.questData.id===t.id&&this.curTaskItem.setTaskDetail(t)},TaskPanel.prototype.setTaskItems=function(t){for(var e=0,i=this.taskItems;e<i.length;e++){(a=i[e]).visible=!1}for(var n=0;n<t.length;n++){var a=void 0;n<this.taskItems.length?a=this.taskItems[n]:(a=new u(this.scene,this.key,this.dpr),this.mGameScroll.addItem(a),a.setHandler(new c.Handler(this,this.onExtendsHandler),new c.Handler(this,this.onFinishHandler)),this.taskItems.push(a)),a.setTaskData(t[n]),a.visible=!0}this.mGameScroll.Sort()},TaskPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},TaskPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(h.ModuleName.PICATASK_NAME+"_hide")},TaskPanel.prototype.onFinishHandler=function(t){this.render.renderEmitter(h.ModuleName.PICATASK_NAME+"_submitquest",t)},TaskPanel.prototype.onExtendsHandler=function(t,e){this.curTaskItem&&this.curTaskItem.setExtend(!1,!1),this.curTaskItem=e,t?this.render.renderEmitter(h.ModuleName.PICATASK_NAME+"_questdetail",e.questData.id):this.curTaskItem=null,this.mGameScroll.Sort(!0)},TaskPanel.prototype.onOpenOptionHandler=function(){var t=this.optionCon.visible;this.optionCon.visible=!t,this.optionArrow.scaleY=t?-1:1},TaskPanel.prototype.onTaskOptionHandler=function(t){for(var e=0,i=this.optionCon.list;e<i.length;e++){i[e].changeNormal()}var n;n=0===t.optionData?this.taskDatas:this.taskDatas.filter((function(e){return e.questType===t.optionData})),this.setTaskItems(n),this.optionCon.visible=!1,this.curOptionItem=t,t.changeDown(),this.optionText.text=t.optionText,this.optionArrow.x=this.optionText.x+this.optionText.width+10*this.dpr},TaskPanel}(o.BasePanel),u=function(t){function TaskItem(e,i,n){var a=t.call(this,e)||this;a.key=i,a.dpr=n;var h=254*n,l=45*n;a.content=e.make.container(void 0,!1),a.content.setSize(h,l),a.bg=new s.NineSlicePatch(a.scene,0,0,h,l,i,"main_bg",{left:6*n,top:6*n,bottom:6*n,right:6*n});var p=.5*-h,d=.5*-l,u=e.make.image({key:i,frame:"head_border"});return u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.x=p+25*n,a.headIcon=new o.DynamicImage(e,u.x,0),a.headIcon.setTexture(i,"head_test"),a.typeBg=e.make.image({key:i,frame:"tag_main"}),a.typeBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.typeBg.setPosition(p+.5*a.typeBg.width,d+.5*a.typeBg.height-2*n),a.typeTex=e.make.text({x:0,y:0,text:c.i18n.t("task.m"),style:{color:"#ffffff",fontSize:10*a.dpr,fontFamily:c.Font.DEFULT_FONT}}),a.typeTex.setOrigin(.5).setPosition(a.typeBg.x-1*n,a.typeBg.y),a.taskName=e.make.text({x:a.headIcon.x+20*n,y:-9*n,text:"",style:{color:"#ffffff",fontSize:13*a.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),a.taskDes=e.make.text({x:a.headIcon.x+25*n,y:10*n,text:"",style:{color:"#ffffff",fontSize:12*a.dpr,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),a.finish=e.make.image({key:i,frame:"done"}),a.finish.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.finish.setPosition(.5*h-30*n,4*n),a.openBtn=new s.Button(e,i,"open","open"),a.setExtendBtn(a.openBtn),a.openBtn.setPosition(.5*h-25*n,4*n),a.closeBtn=new s.Button(e,i,"close"),a.setExtendBtn(a.closeBtn),a.closeBtn.setPosition(a.openBtn.x,a.openBtn.y).visible=!1,a.openBtn.on(s.ClickEvent.Tap,a.onOpenHandler,a),a.closeBtn.on(s.ClickEvent.Tap,a.onCloseHandler,a),a.content.add([a.bg,u,a.headIcon,a.typeBg,a.typeTex,a.taskName,a.taskDes,a.finish,a.openBtn,a.closeBtn]),a.add(a.content),a.setSize(h,l),a}return p(TaskItem,t),TaskItem.prototype.setTaskData=function(t){this.questData=t;var e=this.getQuestTypeTag(t.questType);this.typeBg.setFrame(e[0]),this.typeTex.text=e[1],this.setTextLimit(this.taskName,e[2]+t.name,12),this.bg.setFrame(e[3]),this.setTextLimit(this.taskDes,t.detail),this.taskDes.setColor(e[4]),this.finish.visible=t.stage===a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItem.prototype.setTaskDetail=function(t){var e=this.getQuestTypeTag(t.questType);this.extend&&this.extend.setItemData(t,e[5])},TaskItem.prototype.setHandler=function(t,e){this.extendHandler=t,this.finishHandler=e},TaskItem.prototype.setExtend=function(t,e){void 0===e&&(e=!0),t?e?this.onOpenHandler():this.openExtend():e?this.onCloseHandler():this.closeExtend()},TaskItem.prototype.onOpenHandler=function(){this.openExtend(),this.extendHandler&&this.extendHandler.runWith([!0,this])},TaskItem.prototype.openExtend=function(){this.extend||(this.extend=new m(this.scene,this.key,this.dpr),this.extend.setFinishHandler(new c.Handler(this,this.onFinishHandler)),this.add(this.extend),this.extend.y=.5*this.height+.5*this.extend.height),this.extend.visible=!0,this.height=this.content.height+this.extend.height,this.content.y=.5*-this.height+.5*this.content.height,this.extend.y=.5*-this.height+this.content.height+.5*this.extend.height,this.openBtn.visible=!1,this.closeBtn.visible=!0},TaskItem.prototype.setExtendBtn=function(t){var e=60*this.dpr,i=60*this.dpr,n=this.scene.make.graphics(void 0,!1);n.clear(),n.fillStyle(16185078,0),n.fillRect(.5*-e,.5*-i,e,i),t.addAt(n,0),t.setInteractive(new Phaser.Geom.Rectangle(0,0,e,i),Phaser.Geom.Rectangle.Contains)},TaskItem.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.runWith(this.questData.id)},TaskItem.prototype.onCloseHandler=function(){this.closeExtend(),this.extendHandler&&this.extendHandler.runWith([!1,this])},TaskItem.prototype.closeExtend=function(){this.extend&&(this.extend.visible=!1),this.height=this.content.height,this.content.y=0,this.openBtn.visible=!0,this.closeBtn.visible=!1},TaskItem.prototype.getQuestTypeTag=function(t){var e=[];return t===a.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?(e[0]="tag_main",e[1]=c.i18n.t("task.m"),e[2]=""+c.i18n.t("task.main"),e[3]="main_bg",e[4]="#4C42C8",e[5]="#8780E0",e):t===a.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?(e[0]="tag_side",e[1]=c.i18n.t("task.s"),e[2]=c.i18n.t("task.side"),e[3]="side_bg",e[4]="#CB0A1D",e[5]="#F4919B",e):t===a.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?(e[0]="tag_daly",e[1]=c.i18n.t("task.d"),e[2]=c.i18n.t("task.daily"),e[3]="daly_bg",e[4]="#866107",e[5]="#F1D56C",e):void 0},TaskItem.prototype.setTextLimit=function(t,e,i){if(void 0===i&&(i=15),e.length>i)for(var n=155*this.dpr,a=4;a<e.length;a++){var s=e.slice(0,a);if(t.setText(s).width>n){s+="...",t.setText(s);break}}else t.setText(e)},TaskItem}(Phaser.GameObjects.Container),m=function(t){function TaskItemExtend(e,i,n){var a=t.call(this,e)||this;a.needArr=[],a.rewardArr=[],a.dpr=0;var o=253*n,h=202*n;a.dpr=n;var p=new s.NineSlicePatch(a.scene,0,0,o,h,i,"detail_bg",{left:4,top:4,right:4,bottom:4}),d=.5*-o+10*n,u=.5*-h+5*n;a.taskLabel=e.make.text({x:d,y:u,text:c.i18n.t("task.objective"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:c.Font.DEFULT_FONT}}),a.taskTex=e.make.text({x:d,y:u+18*n,text:c.i18n.t("task.collect_materials"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:c.Font.DEFULT_FONT}}),a.taskTex.setWordWrapWidth(o-10*n,!0),a.rewardLabel=e.make.text({x:d,y:u+90*n,text:c.i18n.t("task.rewards"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:c.Font.DEFULT_FONT}});var m=e.make.image({key:i,frame:"reward_cutline"});return m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),m.setPosition(0,u+110*n),a.line=m,a.finishBtn=new s.NineSliceButton(a.scene,Math.ceil(.5*o-40*a.dpr),Math.ceil(.5*h-25*a.dpr),60*a.dpr,30*a.dpr,l.c.commonKey,"button_g",c.i18n.t("task.submit_task"),a.dpr,a.scale,{left:12*a.dpr,top:12*a.dpr,right:12*a.dpr,bottom:12*a.dpr}),a.finishBtn.setTextStyle({fontSize:12*n,color:"#000000"}),a.finishBtn.on(s.ClickEvent.Tap,a.onFinishHandler,a),a.add([p,a.taskLabel,a.taskTex,a.rewardLabel,m,a.finishBtn]),a.setSize(o,h),a.key=i,a.finishBtn.visible=!1,a}return p(TaskItemExtend,t),TaskItemExtend.prototype.setItemData=function(t,e){this.taskLabel.setColor(e),this.taskTex.setColor(e),this.rewardLabel.setColor(e);var i=0,n=33*this.dpr;this.taskTex.text=this.getTaskTargetText(t),this.createTaskCells(this.needArr,t.targets,!0),i=this.taskTex.y+this.taskTex.height+5*this.dpr,t.targets.length>0&&(i+=.5*n,this.sortItem(this.needArr,i),i+=.5*n+8*this.dpr),this.rewardLabel.y=i,i+=this.rewardLabel.height+5*this.dpr,this.line.y=i,i+=5*this.dpr,this.createTaskCells(this.rewardArr,t.rewards,!1),i+=.5*n,this.sortItem(this.rewardArr,i),this.finishBtn.visible=t.stage===a.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItemExtend.prototype.setFinishHandler=function(t){this.finishHandler=t},TaskItemExtend.prototype.sortItem=function(t,e){void 0===e&&(e=0);for(var i=.5*-this.width+10*this.dpr,n=t,a=0,s=10*this.dpr,o=0,h=n;o<h.length;o++){var l=h[o];l.x=i+l.width*l.originX+a,l.y=e,a+=l.width+s}},TaskItemExtend.prototype.createTaskCells=function(t,e,i){void 0===i&&(i=!0);for(var n=0,a=t;n<a.length;n++){(o=a[n]).visible=!1}for(var s=0;s<e.length;s++){var o=void 0;s<t.length?o=t[s]:(o=new f(this.scene,this.key,this.dpr),t.push(o),this.add(o)),o.visible=!0,o.setCellData(e[s],i)}return t},TaskItemExtend.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.run()},TaskItemExtend.prototype.getTaskTargetText=function(t){t.targets;return t.detail},TaskItemExtend}(Phaser.GameObjects.Container),f=function(t){function TaskCell(e,i,n){var a=t.call(this,e)||this;return a.key=i,a.dpr=n,a.bg=e.make.image({key:i,frame:"task_bg"}),a.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.setSize(a.bg.width,a.bg.height),a.itemIcon=new o.DynamicImage(e,0,0),a.countTex=new s.BBCodeText(a.scene,0,0).setOrigin(.5).setFontSize(12*n).setFontFamily(c.Font.DEFULT_FONT),a.countTex.setPosition(.5*a.width,.5*a.height-2*n),a.add([a.bg,a.itemIcon,a.countTex]),a}return p(TaskCell,t),TaskCell.prototype.setCellData=function(t,e){var i=this;void 0===e&&(e=!0);var n=e?"task_bg":"reward_bg";this.bg.setTexture(this.key,n);var a=c.Url.getOsdRes(t.display.texturePath);this.itemIcon.load(a,this,(function(){i.itemIcon.scale=.6*i.dpr})),this.countTex.text=e?this.getCountText(t.count,t.neededCount):"[stroke=#666666][color=#666666]"+t.count+"[/color][/stroke]"},TaskCell.prototype.getCountText=function(t,e){var i=t>=e?"#0054FF":"#FF2B2B";return"[stroke="+i+"][color="+i+"]"+t+"[/color][/stroke]"+"/"+("[stroke=#2D2D2D][color=#2D2D2D]"+e+"[/color][/stroke]")},TaskCell}(Phaser.GameObjects.Container),y=function(t){function TaskOption(e,i,n){var a=t.call(this,e)||this;a.dpr=0;var s=256*n,o=30*n;a.dpr=n,a.bg=e.make.graphics(void 0,!1),a.text=e.make.text({x:0,y:0,text:"全部",style:{color:"#666666",fontSize:15*n,fontFamily:c.Font.DEFULT_FONT}}).setOrigin(0,.5),a.bg.clear(),a.bg.fillStyle(16185078,1),a.bg.fillRect(.5*-s,.5*-o,s,o);var h=a.scene.make.graphics(void 0,!1);return h.clear(),h.fillStyle(13421772,1),h.fillRect(.5*-s,.5*o,s,2),a.add([a.bg,a.text,h]),a.setSize(s,o),a.bg.setInteractive(new Phaser.Geom.Rectangle(.5*-s,.5*-o,s,o),Phaser.Geom.Rectangle.Contains),a.bg.on("pointerup",a.onClickHandler,a),a}return p(TaskOption,t),TaskOption.prototype.setSize=function(e,i){return t.prototype.setSize.call(this,e,i),this.text.setPosition(.5*-e+20*this.dpr,0),this.changeNormal(),this},TaskOption.prototype.setOptionData=function(t){this.optionData=t,t===a.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?this.text.text=c.i18n.t("task.main_quest"):t===a.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?this.text.text=c.i18n.t("task.side_quest"):t===a.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?this.text.text=c.i18n.t("task.daily_quest"):this.text.text=c.i18n.t("task.all_task"),this.optionText=this.text.text},TaskOption.prototype.changeDown=function(){this.bg.clear(),this.bg.fillStyle(14673663,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.changeNormal=function(){this.bg.clear(),this.bg.fillStyle(16185078,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.setHandler=function(t){this.clickHandler=t},TaskOption.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this)},TaskOption}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return y}));var n,a=i(2),s=i(541),o=i(483),h=i(543),l=i(0),c=i(433),p=function(){function MatterBodies(t){this.render=t;var e=this.render.sceneManager.getSceneByName(o.a.name);e?(this.mGraphics=e.make.graphics(void 0,!1),e.layerManager.addToLayer("middleLayer",this.mGraphics)):a.Logger.getInstance().error("no matter scene")}return MatterBodies.prototype.update=function(){this.mGraphics&&this.mGraphics.clear()},MatterBodies.prototype.renderWireframes=function(t){var e=this.mGraphics;if(e&&(e.clear(),t)){e.lineStyle(1,16711680),e.beginPath();for(var i=this.render.scaleRatio,n=0,a=t;n<a.length;n++){var s=a[n];e.moveTo(s[0].x/i,s[0].y/i);for(var o=1;o<s.length;o++)e.lineTo(s[o].x/i,s[o].y/i);e.lineTo(s[0].x/i,s[0].y/i)}e.strokePath()}},MatterBodies.prototype.destroy=function(){this.mGraphics&&this.mGraphics.destroy()},MatterBodies}(),d=function(){function ServerPosition(t){var e=t.sceneManager.getSceneByName(o.a.name);this.dpr=t.scaleRatio,this.mGridhics=e.make.graphics(void 0,!1),e.layerManager.addToLayer("middleLayer",this.mGridhics)}return ServerPosition.prototype.draw=function(t,e){this.mGridhics.clear(),this.mGridhics.fillStyle(65280,1),this.mGridhics.fillCircle(t,e,2*this.dpr)},ServerPosition.prototype.destroy=function(){this.mGridhics&&this.mGridhics.destroy()},ServerPosition}(),u=i(484),m=i(618),f=i(617);!function(t){t[t.UnknownNodeType=0]="UnknownNodeType",t[t.GameNodeType=1]="GameNodeType",t[t.SceneNodeType=2]="SceneNodeType",t[t.ElementNodeType=3]="ElementNodeType",t[t.TerrainNodeType=4]="TerrainNodeType",t[t.CharacterNodeType=5]="CharacterNodeType",t[t.LocationType=6]="LocationType",t[t.MovableType=7]="MovableType",t[t.DisplayType=8]="DisplayType",t[t.AttributeType=9]="AttributeType",t[t.FunctionType=10]="FunctionType",t[t.AnimationsType=11]="AnimationsType",t[t.EventType=12]="EventType",t[t.MapSizeType=13]="MapSizeType",t[t.UIType=14]="UIType",t[t.TimerType=15]="TimerType",t[t.PackageType=16]="PackageType",t[t.PackageItemType=17]="PackageItemType",t[t.AvatarType=18]="AvatarType",t[t.SettingsType=19]="SettingsType",t[t.CampType=20]="CampType",t[t.MutexType=21]="MutexType",t[t.AnimationDataType=22]="AnimationDataType",t[t.ForkType=23]="ForkType",t[t.ButtonType=24]="ButtonType",t[t.TextType=25]="TextType",t[t.AccessType=26]="AccessType",t[t.SpawnPointType=27]="SpawnPointType",t[t.CommodityType=28]="CommodityType",t[t.ShopType=29]="ShopType",t[t.PaletteType=30]="PaletteType",t[t.TerrainCollectionType=31]="TerrainCollectionType",t[t.AssetsType=32]="AssetsType",t[t.MossType=33]="MossType",t[t.MossCollectionType=34]="MossCollectionType",t[t.SceneryType=35]="SceneryType",t[t.ModsType=36]="ModsType",t[t.InputTextType=37]="InputTextType"}(n||(n={}));var y=function(){function DisplayManager(t){this.render=t,this.loading=!1,this.uuid=0,this.sceneManager=t.sceneManager,this.displays=new Map,this.scenerys=new Map,this.preLoadList=[]}return Object.defineProperty(DisplayManager.prototype,"user",{get:function(){return this.mUser},enumerable:!1,configurable:!0}),DisplayManager.prototype.update=function(t,e){this.preLoadList&&this.preLoadList.length>0&&!this.loading&&(this.loading=!0,this.loadProgress())},DisplayManager.prototype.resize=function(t,e){this.scenerys.forEach((function(i){i.resize(t,e)}))},DisplayManager.prototype.updateModel=function(t,e){if(this.sceneManager.getMainScene()){var i=this.displays.get(t);i&&(i.load(e),this.render.mainPeer.elementDisplaySyncReady(t))}else a.Logger.getInstance().fatal("scene does not exist")},DisplayManager.prototype.addDragonbonesDisplay=function(t,e,i){if(e){var s,o=this.sceneManager.getMainScene();if(o)this.displays.has(t)?s=this.displays.get(t):(s=new h.a(o,this.render,t,this.uuid++,n.CharacterNodeType),this.displays.set(t,s),this.preLoadList.push(s)),s.load(e),o.layerManager.addToLayer(i.toString(),s);else a.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addUserDragonbonesDisplay=function(t,e,i){if(void 0===e&&(e=!1),t){var s,o=this.sceneManager.getMainScene();if(o)return this.displays.has(t.id)?s=this.displays.get(t.id):(s=new h.a(o,this.render,t.id,this.uuid++,n.CharacterNodeType),this.displays.set(t.id,s)),s.load(t),s.startLoad(),o.layerManager.addToLayer(i.toString(),s),e&&(this.mUser=s),s;a.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addTerrainDisplay=function(t,e,i){if(e){var o,h=this.sceneManager.getMainScene();if(h)return this.displays.has(t)?o=this.displays.get(t):(o=new s.a(h,this.render,t,n.TerrainNodeType),this.displays.set(t,o)),o.load(e),h.layerManager.addToLayer(i.toString(),o),o;a.Logger.getInstance().fatal("scene does not exist")}},DisplayManager.prototype.addFramesDisplay=function(t,e,i,o){if(e){var h,l=this.sceneManager.getMainScene();if(l)return this.displays.has(t)?h=this.displays.get(t):(57255261===t&&a.Logger.getInstance().debug("no load obj render",e),h=new s.a(l,this.render,t,n.ElementNodeType),this.displays.set(t,h)),h.load(e,o),l.layerManager.addToLayer(i.toString(),h),h;a.Logger.getInstance().fatal("scene does not exist")}else a.Logger.getInstance().debug("addFramesDisplay ====>",t)},DisplayManager.prototype.addToSurfaceLayer=function(t){var e=this.sceneManager.getMainScene();e?e.layerManager.addToLayer(o.a.LAYER_SURFACE,t):a.Logger.getInstance().fatal("scene does not exist")},DisplayManager.prototype.removeDisplay=function(t){this.displays.has(t)&&(this.displays.get(t).destroy(),this.displays.delete(t))},DisplayManager.prototype.addFillEffect=function(t,e,i){var n=this.render.sceneManager.getMainScene(),a=new u.b(n,this.render.scaleRatio);a.show(i),a.setPosition(t,e),n.layerManager.addToLayer("sceneUILayer",a)},DisplayManager.prototype.load=function(t,e,i){this.displays.has(t)?this.displays.get(t).load(e,i):a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.changeAlpha=function(t,e){this.displays.has(t)?this.displays.get(t).changeAlpha(e):a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.fadeIn=function(t){this.displays.has(t)?this.displays.get(t).fadeIn():a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.fadeOut=function(t){this.displays.has(t)?this.displays.get(t).fadeOut():a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.play=function(t,e,i,n){this.displays.has(t)?this.displays.get(t).play(e):a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.mount=function(t,e,i){var n=this.displays.get(t);if(n){var s=this.displays.get(e);s?(s.setRootMount(n),n.mount(s,i)):a.Logger.getInstance().error("BaseDisplay not found: ",e)}else a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.unmount=function(t,e){var i=this.displays.get(t);if(i){var n=this.displays.get(e);n?(n.setRootMount(null),i.unmount(n)):a.Logger.getInstance().error("BaseDisplay not found: ",e)}else a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.addEffect=function(t,e,i){var n=this.getDisplay(t),a=this.addFramesDisplay(e,i,l.DisplayField.Effect);n&&a&&a.once("initialized",(function(){n.addEffect(a)}))},DisplayManager.prototype.removeEffect=function(t){var e=this.displays.get(t);e?(e.removeEffect(),e.destroy()):a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.showEffect=function(t){if(this.displays.has(t))this.displays.get(t);else a.Logger.getInstance().error("BaseDisplay not found: ",t)},DisplayManager.prototype.setModel=function(t){var e=this.displays.get(t.id);e&&(t.pos||(t.pos=new a.LogicPos(0,0,0)),e.titleMask=t.titleMask,e.setPosition(t.pos.x,t.pos.y,t.pos.z),e.changeAlpha(t.alpha))},DisplayManager.prototype.addSkybox=function(t){var e=new c.a(t,this.render);this.scenerys.set(t.id,e)},DisplayManager.prototype.updateSkyboxState=function(t){this.scenerys.forEach((function(e){e.setState(t)}))},DisplayManager.prototype.removeSkybox=function(t){var e=this.scenerys.get(t);e&&(e.destroy(),this.scenerys.delete(t))},DisplayManager.prototype.getDisplay=function(t){return this.displays.get(t)},DisplayManager.prototype.displayDoMove=function(t,e){var i=this.getDisplay(t);i&&i.doMove(e)},DisplayManager.prototype.showNickname=function(t,e){var i=this.getDisplay(t);if(!i)return a.Logger.getInstance().debug("can't show nickname "+e);i.showNickname(e)},DisplayManager.prototype.showTopDisplay=function(t,e){var i=this.getDisplay(t);i&&i.showTopDisplay(e)},DisplayManager.prototype.showMatterDebug=function(t){this.matterBodies||(this.matterBodies=new p(this.render)),this.matterBodies.renderWireframes(t)},DisplayManager.prototype.hideMatterDebug=function(){this.matterBodies&&(this.matterBodies.destroy(),this.matterBodies=void 0)},DisplayManager.prototype.showGridsDebug=function(t){this.mGridsDebug||(this.mGridsDebug=new f.a(this.render)),this.mGridsDebug.setData(t)},DisplayManager.prototype.hideGridsDebug=function(){this.mGridsDebug&&(this.mGridsDebug.destroy(),this.mGridsDebug=null)},DisplayManager.prototype.showAstarDebug_init=function(t,e){this.mAstarDebug||(this.mAstarDebug=new m.a(this.render)),this.mAstarDebug.initData(t,e)},DisplayManager.prototype.showAstarDebug_update=function(t,e,i){this.mAstarDebug&&this.mAstarDebug.updateData(t,e,i)},DisplayManager.prototype.showAstarDebug_findPath=function(t,e,i){this.mAstarDebug&&this.mAstarDebug.showPath(t,e,i)},DisplayManager.prototype.hideAstarDebug=function(){this.mAstarDebug&&(this.mAstarDebug.destroy(),this.mAstarDebug=null)},DisplayManager.prototype.drawServerPosition=function(t,e){this.serverPosition||(this.serverPosition=new d(this.render)),this.serverPosition.draw(t,e)},DisplayManager.prototype.destroy=function(){this.loading=!1,this.preLoadList&&(this.preLoadList.length=0,this.preLoadList=[]),this.displays&&(this.displays.forEach((function(t){t&&t.destroy()})),this.displays.clear()),this.scenerys&&(this.scenerys.forEach((function(t){t&&t.destroy()})),this.scenerys.clear()),this.matterBodies&&(this.matterBodies.destroy(),this.matterBodies=null),this.serverPosition&&(this.serverPosition.destroy(),this.serverPosition=null),this.mAstarDebug&&(this.mAstarDebug.destroy(),this.mAstarDebug=null),this.mGridsDebug&&(this.mGridsDebug.destroy(),this.mGridsDebug=null)},DisplayManager.prototype.loadProgress=function(){var t=this,e=this.preLoadList.shift();e?e.startLoad().then((function(){t.loadProgress()})).catch((function(){t.loadProgress()})):this.loading=!1},DisplayManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return c}));var n,a,s,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){t[t.IMAGE=0]="IMAGE",t[t.JSON=1]="JSON",t[t.ALTAS=2]="ALTAS",t[t.DRAGONBONES=3]="DRAGONBONES"}(a||(a={})),function(t){t[t.NONE=0]="NONE",t[t.PRELOAD=1]="PRELOAD",t[t.PROGRESS=2]="PROGRESS",t[t.COMPLETE=3]="COMPLETE",t[t.ERROR=4]="ERROR",t[t.RETRY=5]="RETRY"}(s||(s={}));var h=function(t){function LoadQueue(e){var i=t.call(this)||this;return i.scene=e,i.mQueue=[],i}return o(LoadQueue,t),LoadQueue.prototype.add=function(t){var e=this;t.forEach((function(t){if(t){var i=t.type,n=t.key,s=t.altasUrl,o=t.textureUrl,h=t.jsonUrl,l=t.boneUrl;switch(i){case a.ALTAS:e.scene.load.atlas(n,s);break;case a.IMAGE:e.scene.load.image(n,o);break;case a.JSON:e.scene.load.json(n,h);break;case a.DRAGONBONES:e.scene.load.dragonbone(n,o,h,l,null,null,{responseType:"arraybuffer"})}e.mQueue.push(t)}}))},LoadQueue.prototype.startLoad=function(){this.mQueue.forEach((function(t){t.state=s.PROGRESS})),this.addListen(),this.scene.load.start()},LoadQueue.prototype.destroy=function(){this.removeListen(),this.mQueue&&(this.mQueue=null),t.prototype.destroy.call(this)},LoadQueue.prototype.addListen=function(){this.removeListen(),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.fileComplete,this),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.totalComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.fileLoadError,this)},LoadQueue.prototype.removeListen=function(){this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.fileComplete,this),this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.totalComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.fileLoadError,this)},LoadQueue.prototype.totalComplete=function(){this.emit("QueueComplete"),this.clearQueue()},LoadQueue.prototype.fileComplete=function(t,e){this.emit("QueueProgress",this.scene.load.progress,t,e)},LoadQueue.prototype.fileLoadError=function(t){this.emit("QueueError",t.key)},LoadQueue.prototype.clearQueue=function(){this.removeListen(),this.mQueue&&(this.mQueue.length=0,this.mQueue=[])},LoadQueue}(Phaser.Events.EventEmitter),l=i(2),c=function(){function LoadingTips(){}return LoadingTips.enterWorld=function(){return l.i18n.t("loading.enter_game")},LoadingTips.loginGame=function(){return l.i18n.t("loading.logging")},LoadingTips.downloadGameConfig=function(){return l.i18n.t("loading.downloading_config")},LoadingTips.downloadSceneConfig=function(){return l.i18n.t("loading.downloading_scene_config")},LoadingTips.parseConfig=function(){return l.i18n.t("loading.parse_config")},LoadingTips.loadingResources=function(){return l.i18n.t("loading.loading_resources")},LoadingTips.createScene=function(){return l.i18n.t("loading.create_scene")},LoadingTips.waitEnterRoom=function(){return l.i18n.t("loading.wait_enter_room")},LoadingTips}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function Account(){}return Account.prototype.getAccountData=function(){return this.accountData},Account.prototype.setAccount=function(t){this.accountData={id:t.id,fingerprint:t.fingerprint,refreshToken:t.refreshToken,expire:t.expire,accessToken:t.token||t.accessToken},this.saveLocalStorage()},Account.prototype.refreshToken=function(t){if(this.accountData){var e=t.newExpire,i=t.newFingerprint,n=t.newToken;this.accountData.expire=e,this.accountData.fingerprint=i,this.accountData.accessToken=n,this.saveLocalStorage()}},Account.prototype.saveLocalStorage=function(){if(this.accountData){var t=this.accountData,e=t.id,i=t.fingerprint,n=t.refreshToken,a=t.expire,s=t.accessToken;localStorage.setItem("token",JSON.stringify({id:e,fingerprint:i,refreshToken:n,expire:a,accessToken:s}))}},Account.prototype.clear=function(){this.accountData={accessToken:"",expire:0,fingerprint:"",id:"",refreshToken:""}},Account.prototype.destroy=function(){this.clear(),localStorage.removeItem("token"),this.enterGame(void 0,void 0,void 0,void 0)},Account.prototype.enterGame=function(t,e,i,n){this.gameId=t,this.virtualWorldId=e,this.sceneID=i,this.loc=n},Object.defineProperty(Account.prototype,"gameID",{get:function(){return this.gameId},enumerable:!1,configurable:!0}),Object.defineProperty(Account.prototype,"sceneId",{get:function(){return this.sceneID},enumerable:!1,configurable:!0}),Account}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,a=i(294),s=i(0),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function CreateRoleScene(){return t.call(this,{key:s.SceneName.CREATE_ROLE_SCENE})||this}return h(CreateRoleScene,t),CreateRoleScene.prototype.init=function(e){t.prototype.init.call(this,e),this.params=e.params},CreateRoleScene.prototype.create=function(){this.render&&(this.render.uiManager.setScene(this),o.Logger.getInstance().debug("createrole===scene"));t.prototype.create.call(this)},CreateRoleScene.prototype.stop=function(){this.render&&this.render.showMediator("CreateRoleScene",!1),t.prototype.stop.call(this)},CreateRoleScene}(a.a)},function(t,e,i){"use strict";var n=i(608);i.d(e,"a",(function(){return n.b}));i(631)},function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,a=i(614),s=i(59),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function BubbleContainer(e,i){var n=t.call(this,e)||this;return n.mBubbles=[],n.mScale=i,n.mArrow=new s.DynamicImage(n.scene,0,0),n.mArrow.scale=i,n.mArrow.load(o.Url.getRes("ui/chat/bubble_arrow.png")),n.add(n.mArrow),n}return h(BubbleContainer,t),BubbleContainer.prototype.addBubble=function(t,e){var i=this.createBubble(e),n=this.mBubbles.length,a=null,s=0;i.show(t,e);for(var o=n-1;o>=0;o--)s+=(a=this.mBubbles[o]).minHeight+5*this.mScale,a.tweenTo(-s);this.add(i),this.mArrow.y=4*this.mScale},BubbleContainer.prototype.follow=function(t){if(0!==this.mBubbles.length){var e=t.getPosition();e&&this.updatePos(e.x,e.y-110)}},BubbleContainer.prototype.updatePos=function(t,e){this.x=t*this.mScale,this.y=e*this.mScale},BubbleContainer.prototype.destroy=function(e){if(this.mBubbles){for(var i=null,n=this.mBubbles.length-1;n>=0;n--)(i=this.mBubbles[n])&&i.destroy();this.mBubbles=null,this.removeFormParent(),t.prototype.destroy.call(this,e)}},BubbleContainer.prototype.removeFormParent=function(){this.parentContainer&&this.parentContainer.remove(this)},BubbleContainer.prototype.createBubble=function(t){if(t){var e=new a.a(this.scene,this.mScale);this.mBubbles.push(e);var i=t.duration?t.duration:5e3;return e.durationRemove(i,this.onRemoveBubble,this),e}},BubbleContainer.prototype.onRemoveBubble=function(t){t&&(this.mBubbles=this.mBubbles.filter((function(e){return t!==e})),this.remove(t),t.destroy(),0===this.mBubbles.length&&this.removeFormParent())},BubbleContainer}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,a=i(295),s=i(6),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function Bubble(e,i){var n=t.call(this,e)||this;return n.mMinWidth=0,n.mMinHeight=0,n.mScale=i,n.x=-40*i,n}return h(Bubble,t),Bubble.prototype.show=function(t,e){this.mChatContent=new s.BBCodeText(this.scene,0,4*this.mScale,t,{fontFamily:o.Font.DEFULT_FONT,fontSize:14*this.mScale,color:"#000000",origin:{x:0,y:0},wrap:{width:200*this.mScale,mode:"character"}}),this.add(this.mChatContent);var i=36*this.mScale,n=60*this.mScale;this.mMinHeight=this.mChatContent.height+18*this.mScale,this.mMinHeight=this.mMinHeight<i?i:this.mMinHeight,this.mMinWidth=this.mChatContent.width+20*this.mScale,this.mMinWidth=this.mMinWidth<n?n:this.mMinWidth,this.mBubbleBg=new a.DynamicNinepatch(this.scene,this);var h=o.Url.getOsdRes(e.bubbleResource||"platformitem/thumbnail/bubble_01.png");this.mBubbleBg.load(h,{width:this.mMinWidth,height:this.mMinHeight,key:h,columns:[34,2,32],rows:[42,2,9]},this.onComplete,this)},Bubble.prototype.tweenTo=function(t){this.mToY=t,this.scene.tweens.add({targets:this,y:t,alpha:1,duration:200})},Bubble.prototype.durationRemove=function(t,e,i){var n=this;this.mTweenCompleteCallback=e,this.mTweenCallContext=i,this.mRemoveDelay=setTimeout((function(){n.removeTween()}),t)},Bubble.prototype.removeTween=function(){var t=this,e=this.mToY-30;this.scene.tweens.add({targets:this,y:e,alpha:0,duration:200,onComplete:function(){t.mTweenCompleteCallback&&t.mTweenCompleteCallback.call(t.mTweenCallContext,t)}})},Bubble.prototype.destroy=function(){this.mChatContent&&this.mChatContent.destroy(!0),this.mChatContent=null,this.mMinWidth=0,this.mMinHeight=0,this.mToY=0,this.mTweenCompleteCallback=null,this.mTweenCallContext=null,this.mRemoveDelay&&clearTimeout(this.mRemoveDelay),t.prototype.destroy.call(this,!0)},Bubble.prototype.onComplete=function(t){if(t&&this.scene){t.setOrigin(0,0),this.addAt(t,0);this.getBounds();this.mChatContent.x=this.mMinWidth-this.mChatContent.width>>1,this.mChatContent.y=6+(this.mMinHeight-this.mChatContent.height>>1)}},Object.defineProperty(Bubble.prototype,"minWidth",{get:function(){return this.mMinWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Bubble.prototype,"minHeight",{get:function(){return this.mMinHeight},enumerable:!1,configurable:!0}),Bubble}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i(542);var n=i(543);i.d(e,"DragonbonesDisplay",(function(){return n.a}));var a=i(541);i.d(e,"FramesDisplay",(function(){return a.a}));var s=i(635);i.d(e,"BubbleAnimation",(function(){return s.a}));i(636);var o=i(637);i.d(e,"FrameAnimation",(function(){return o.a}));i(492);var h=i(638);i.d(e,"AnimationModel",(function(){return h.a}));i(614),i(613);var l=i(639);i.d(e,"UIDragonbonesDisplay",(function(){return l.a}));var c=i(640);i.o(c,"AlertView")&&i.d(e,"AlertView",(function(){return c.AlertView})),i.o(c,"AlignmentType")&&i.d(e,"AlignmentType",(function(){return c.AlignmentType})),i.o(c,"AstarDebugger")&&i.d(e,"AstarDebugger",(function(){return c.AstarDebugger})),i.o(c,"AxisType")&&i.d(e,"AxisType",(function(){return c.AxisType})),i.o(c,"BackgroundScaleButton")&&i.d(e,"BackgroundScaleButton",(function(){return c.BackgroundScaleButton})),i.o(c,"BasePanel")&&i.d(e,"BasePanel",(function(){return c.BasePanel})),i.o(c,"ButtonEventDispatcher")&&i.d(e,"ButtonEventDispatcher",(function(){return c.ButtonEventDispatcher})),i.o(c,"CheckboxGroup")&&i.d(e,"CheckboxGroup",(function(){return c.CheckboxGroup})),i.o(c,"CommonBackground")&&i.d(e,"CommonBackground",(function(){return c.CommonBackground})),i.o(c,"ConstraintType")&&i.d(e,"ConstraintType",(function(){return c.ConstraintType})),i.o(c,"DynamicImage")&&i.d(e,"DynamicImage",(function(){return c.DynamicImage})),i.o(c,"DynamicImageValue")&&i.d(e,"DynamicImageValue",(function(){return c.DynamicImageValue})),i.o(c,"EditorModeDebugger")&&i.d(e,"EditorModeDebugger",(function(){return c.EditorModeDebugger})),i.o(c,"GridLayoutGroup")&&i.d(e,"GridLayoutGroup",(function(){return c.GridLayoutGroup})),i.o(c,"GridsDebugger")&&i.d(e,"GridsDebugger",(function(){return c.GridsDebugger})),i.o(c,"ImageBBCodeValue")&&i.d(e,"ImageBBCodeValue",(function(){return c.ImageBBCodeValue})),i.o(c,"ImageValue")&&i.d(e,"ImageValue",(function(){return c.ImageValue})),i.o(c,"InputField")&&i.d(e,"InputField",(function(){return c.InputField})),i.o(c,"InputPanel")&&i.d(e,"InputPanel",(function(){return c.InputPanel})),i.o(c,"InputView")&&i.d(e,"InputView",(function(){return c.InputView})),i.o(c,"ItemInfoTips")&&i.d(e,"ItemInfoTips",(function(){return c.ItemInfoTips})),i.o(c,"ItemsConsumeFunPanel")&&i.d(e,"ItemsConsumeFunPanel",(function(){return c.ItemsConsumeFunPanel})),i.o(c,"LabelInput")&&i.d(e,"LabelInput",(function(){return c.LabelInput})),i.o(c,"MainUIScene")&&i.d(e,"MainUIScene",(function(){return c.MainUIScene})),i.o(c,"NinePatch")&&i.d(e,"NinePatch",(function(){return c.NinePatch})),i.o(c,"NinePatchButton")&&i.d(e,"NinePatchButton",(function(){return c.NinePatchButton})),i.o(c,"PlayScene")&&i.d(e,"PlayScene",(function(){return c.PlayScene})),i.o(c,"ProgressMaskBar")&&i.d(e,"ProgressMaskBar",(function(){return c.ProgressMaskBar})),i.o(c,"ProgressThreeBar")&&i.d(e,"ProgressThreeBar",(function(){return c.ProgressThreeBar})),i.o(c,"PropItem")&&i.d(e,"PropItem",(function(){return c.PropItem})),i.o(c,"SortDebugger")&&i.d(e,"SortDebugger",(function(){return c.SortDebugger})),i.o(c,"SoundButton")&&i.d(e,"SoundButton",(function(){return c.SoundButton})),i.o(c,"TextButton")&&i.d(e,"TextButton",(function(){return c.TextButton})),i.o(c,"TextToolTips")&&i.d(e,"TextToolTips",(function(){return c.TextToolTips})),i.o(c,"ThreeSliceButton")&&i.d(e,"ThreeSliceButton",(function(){return c.ThreeSliceButton})),i.o(c,"ThreeSlicePath")&&i.d(e,"ThreeSlicePath",(function(){return c.ThreeSlicePath})),i.o(c,"ToggleButton")&&i.d(e,"ToggleButton",(function(){return c.ToggleButton})),i.o(c,"ToggleColorButton")&&i.d(e,"ToggleColorButton",(function(){return c.ToggleColorButton})),i.o(c,"TweenCompent")&&i.d(e,"TweenCompent",(function(){return c.TweenCompent})),i.o(c,"UiManager")&&i.d(e,"UiManager",(function(){return c.UiManager})),i.o(c,"ValueContainer")&&i.d(e,"ValueContainer",(function(){return c.ValueContainer}));var p=i(617);i.d(e,"GridsDebugger",(function(){return p.b}));var d=i(618);i.d(e,"AstarDebugger",(function(){return d.b}));var u=i(641);i.d(e,"SortDebugger",(function(){return u.a}));var m=i(642);i.d(e,"EditorModeDebugger",(function(){return m.a}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n,a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),s=function(t){function BaseAnimation(e){var i=t.call(this,e)||this;return i.loaded=!1,i.isPlaying=!1,i.loop=!1,i}return a(BaseAnimation,t),BaseAnimation.prototype.load=function(t,e,i){this.destroy(),this.resName=t||e,this.curAniName=t,this.resUrl=e},BaseAnimation.prototype.play=function(t){t&&(this.curAniName=t),this.isPlaying=!0},BaseAnimation.prototype.destroy=function(){this.animUrlData&&this.animUrlData.dispose(),this.animUrlData=void 0,this.curAniName=void 0,this.isPlaying=!1,this.loaded=!1,this.loop=!1},BaseAnimation.prototype.onLoadComplete=function(t,e,i){},BaseAnimation}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));var n=i(2),a=i(483),s=function(){function Grids(t){this.render=t,o.getInstance().setDebugger(this)}return Grids.prototype.destroy=function(){this.mGraphic&&this.mGraphic.destroy(),this.mRoomSize=null,o.getInstance().setDebugger(null)},Grids.prototype.setData=function(t){this.mRoomSize=t,o.getInstance().isDebug?this.show():this.hide()},Grids.prototype.show=function(){if(this.mRoomSize){var t=this.render.sceneManager.getMainScene();if(t&&t instanceof a.a){this.mGraphic&&this.mGraphic.destroy(),this.mGraphic=t.make.graphics(void 0,!1),this.mGraphic.clear(),this.mGraphic.lineStyle(1,65280),this.mGraphic.beginPath();for(var e=0;e<=this.mRoomSize.rows;e++)this.drawLine(this.mRoomSize,this.mGraphic,0,e,this.mRoomSize.cols,e);for(e=0;e<=this.mRoomSize.cols;e++)this.drawLine(this.mRoomSize,this.mGraphic,e,0,e,this.mRoomSize.rows);this.mGraphic.closePath(),this.mGraphic.strokePath(),t.layerManager.addToLayer("middleLayer",this.mGraphic)}}},Grids.prototype.hide=function(){this.mGraphic&&this.mGraphic.destroy()},Grids.prototype.drawLine=function(t,e,i,a,s,o){var h=new n.LogicPos(i,a);h=n.Position45.transformTo90(h,t),e.moveTo(h.x,h.y),h=new n.LogicPos(s,o),h=n.Position45.transformTo90(h,t),e.lineTo(h.x,h.y)},Grids}(),o=function(){function GridsDebugger(){this.isDebug=!1,this.mGrids=null}return GridsDebugger.getInstance=function(){return GridsDebugger._instance||(GridsDebugger._instance=new GridsDebugger),GridsDebugger._instance},GridsDebugger.prototype.setDebugger=function(t){this.mGrids=t},GridsDebugger.prototype.q=function(){this.isDebug=!1,this.mGrids&&this.mGrids.hide()},GridsDebugger.prototype.v=function(){this.isDebug=!0,this.mGrids&&this.mGrids.show()},GridsDebugger}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));var n=i(483),a=i(2),s=function(){function Astar(t){this.render=t,this.CIRCLE_RADIUS_POINTS=2,this.CIRCLE_RADIUS_START_POSITION=4,this.CIRCLE_RADIUS_TARGET_POSITION=4,this.CIRCLE_COLOR_POINTS_PASS=65280,this.CIRCLE_COLOR_POINTS_NOTPASS=16711680,this.CIRCLE_COLOR_START_POSITION=16776960,this.CIRCLE_COLOR_TARGET_POSITION=16776960,this.LINE_COLOR_PATH=16776960,this.mShowAllPoints=!1,this.mPoints=new Map,this.mStartPos=null,this.mTargetPos=null,this.mPath=null,o.getInstance().setDebugger(this)}return Astar.prototype.destroy=function(){this.clearAll(),this.mAstarSize&&(this.mAstarSize=null),o.getInstance().setDebugger(null)},Astar.prototype.initData=function(t,e){this.mAstarSize=e,o.getInstance().isDebug?this.drawPoints():this.clearAll()},Astar.prototype.updateData=function(t,e,i){this.mAstarSize&&(o.getInstance().isDebug?this.drawPoints():this.clearAll())},Astar.prototype.showPath=function(t,e,i){this.mAstarSize&&(o.getInstance().isDebug?this.drawPath(t,e,i):this.clearPath())},Astar.prototype.drawPoints=function(){var t=this;if(this.mShowAllPoints&&this.mAstarSize){var e=this.render.sceneManager.getMainScene();if(e&&e instanceof n.a){this.clearAll();for(var _loop_1=function(n){for(var _loop_2=function(s){i.render.physicalPeer.isWalkableAt(s,n).then((function(i){var o=t.getColorByValue(i),h=new a.LogicPos(s,n);(h=a.Position45.transformTo90(h,t.mAstarSize)).y+=t.mAstarSize.tileHeight/2;var l=t.drawCircle(e,h,o,t.CIRCLE_RADIUS_POINTS);t.mPoints.set(new a.LogicPos(s,n),l)}))},s=0;s<i.mAstarSize.cols;s++)_loop_2(s)},i=this,s=0;s<this.mAstarSize.rows;s++)_loop_1(s)}}},Astar.prototype.clearAll=function(){this.mPoints.forEach((function(t){t.destroy()})),this.mPoints.clear(),this.clearPath()},Astar.prototype.clearPath=function(){this.mStartPos&&(this.mStartPos.destroy(),this.mStartPos=null),this.mTargetPos&&(this.mTargetPos.destroy(),this.mTargetPos=null),this.mPath&&(this.mPath.destroy(),this.mPath=null)},Astar.prototype.drawPath=function(t,e,i){if(this.mAstarSize){var a=this.render.sceneManager.getMainScene();a&&a instanceof n.a&&(this.clearPath(),this.mStartPos=this.drawCircle(a,t,this.CIRCLE_COLOR_START_POSITION,this.CIRCLE_RADIUS_START_POSITION),this.mTargetPos=this.drawCircle(a,e,this.CIRCLE_COLOR_TARGET_POSITION,this.CIRCLE_RADIUS_TARGET_POSITION),i.length>1&&(this.mPath=this.drawLine(a,i,this.LINE_COLOR_PATH)))}},Astar.prototype.drawCircle=function(t,e,i,n){var a=t.make.graphics(void 0,!1);return a.clear(),a.fillStyle(i,1),a.fillCircle(e.x,e.y,n),t.layerManager.addToLayer("middleLayer",a),a},Astar.prototype.drawLine=function(t,e,i){var n=t.make.graphics(void 0,!1);n.lineStyle(1,i),n.beginPath();for(var s=0;s<e.length-1;s++){var o=e[s],h=new a.LogicPos(o.x,o.y);n.moveTo(h.x,h.y),o=e[s+1],h=new a.LogicPos(o.x,o.y),n.lineTo(h.x,h.y)}return n.closePath(),n.strokePath(),t.layerManager.addToLayer("middleLayer",n),n},Astar.prototype.getColorByValue=function(t){return t?this.CIRCLE_COLOR_POINTS_PASS:this.CIRCLE_COLOR_POINTS_NOTPASS},Astar}(),o=function(){function AstarDebugger(){this.isDebug=!1,this.mAstar=null}return AstarDebugger.getInstance=function(){return AstarDebugger._instance||(AstarDebugger._instance=new AstarDebugger),AstarDebugger._instance},AstarDebugger.prototype.setDebugger=function(t){this.mAstar=t},AstarDebugger.prototype.q=function(){this.isDebug=!1,this.mAstar&&this.mAstar.clearAll()},AstarDebugger.prototype.v=function(){this.isDebug=!0,this.mAstar&&this.mAstar.drawPoints()},AstarDebugger}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(2),s=i(294),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function GamePauseScene(){return t.call(this,{key:GamePauseScene.name})||this}return o(GamePauseScene,t),GamePauseScene.prototype.preload=function(){this.load.image("gamepause.png",a.Url.getRes("gamepause.png"))},GamePauseScene.prototype.init=function(e){t.prototype.init.call(this,e),this.mRender=e.render},GamePauseScene.prototype.create=function(){t.prototype.create.call(this);var e=this.scale.gameSize.width,i=this.scale.gameSize.height;this.bg=this.add.graphics(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,e,i),this.pauseImg=this.add.image(e>>1,i>>1,"gamepause.png"),this.tipTF=this.add.text(e-240>>1,i-50,"点击任意位置开始游戏",{font:"30px Tahoma"}),this.scale.on("resize",this.checkSize,this),this.checkSize(new a.Size(e,i)),this.input.on("pointerdown",this.downHandler,this)},GamePauseScene.prototype.awake=function(){this.scale.on("resize",this.checkSize,this),this.input.on("pointerdown",this.downHandler,this),this.scene.wake()},GamePauseScene.prototype.sleep=function(){this.scale.off("resize",this.checkSize,this),this.input.off("pointerdown",this.downHandler,this),this.scene.sleep()},GamePauseScene.prototype.getKey=function(){return this.sys.config.key},GamePauseScene.prototype.downHandler=function(){this.mRender.onFocus()},GamePauseScene.prototype.checkSize=function(t){var e=t.width,i=t.height;this.bg.clear(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,e,i),this.pauseImg.scaleX=this.pauseImg.scaleY=.7*this.mRender.uiScale,this.pauseImg.x=e>>1,this.pauseImg.y=i>>1,this.tipTF.scaleX=this.tipTF.scaleY=this.mRender.uiScale,this.tipTF.x=e-280*this.mRender.uiScale>>1,this.tipTF.y=i-50*this.mRender.uiScale},GamePauseScene}(s.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n,a=i(2),s=i(485),o=i(58),h=i.n(o),l=i(0),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},p=function(t){function LoadingScene(){return t.call(this,{key:l.SceneName.LOADING_SCENE})||this}return c(LoadingScene,t),LoadingScene.prototype.preload=function(){this.load.image("avatar_placeholder",a.Url.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",a.Url.getUIRes(this.dpr,"loading/curtain.png"),a.Url.getUIRes(this.dpr,"loading/curtain.json")),this.load.atlas("loading",a.Url.getRes("ui/loading/loading.png"),a.Url.getRes("ui/loading/loading.json")),this.load.script("webfont",a.Url.getRes("scripts/webfont/1.6.26/webfont.js"))},LoadingScene.prototype.init=function(e){t.prototype.init.call(this,e),this.createFont(),this.dpr=e.dpr||2,this.mRequestCom=!1,this.mCallback=e.callBack,this.tipsText=e.text||""},LoadingScene.prototype.create=function(){t.prototype.create.call(this);try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){a.Logger.getInstance().warn("webfont failed to load")}var e=this.scale.gameSize.width,i=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1}),this.curtain=new d(this,this.dpr),this.mask=this.add.graphics(void 0),this.mask.fillStyle(0),this.mask.fillRect(0,0,e,i);var n=this.render.uiRatio;this.bg=this.add.sprite(.5*e,.5*i,"loading").setScale(this.render.uiScale*n*2),this.bg.play("loading_anis"),this.progressText=this.add.text(this.bg.x,this.bg.y+.5*this.bg.displayHeight,this.tipsText,{fontSize:12*n,fontFamily:a.Font.DEFULT_FONT}).setOrigin(.5),this.debug=this.add.text(e-4*n,i-4*n,"v"+h.a+" "+this.getDebug(),{fontSize:12*n,fontFamily:a.Font.DEFULT_FONT}).setOrigin(1)},LoadingScene.prototype.show=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.wake(),this.curtain?(this.displayVisible(!1),[2,this.curtain.open()]):[2,Promise.resolve()]}))}))},LoadingScene.prototype.close=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.curtain?(this.displayVisible(!1),[2,this.curtain.close()]):[2]}))}))},LoadingScene.prototype.updateProgress=function(t){t&&(this.tipsText=t,t&&this.progressText&&this.progressText.active&&this.progressText.setText(t))},LoadingScene.prototype.wake=function(e){var i=this;this.scene&&this.scene.settings&&(this.curtain&&(this.displayVisible(!0),this.curtain.open().then((function(){i.scene.wake()})).catch((function(t){a.Logger.getInstance().debug(t)})),this.scene.bringToTop(l.SceneName.LOADING_SCENE),t.prototype.wake.call(this,e)),e&&(this.tipsText=e.text,a.Logger.getInstance().debug("loadState:----",e.text),e.text&&this.progressText&&this.progressText.active&&this.progressText.setText(e.text)))},LoadingScene.prototype.sleep=function(){var t=this;this.progressText&&this.progressText.active&&this.progressText.setText(""),this.scene&&this.scene.settings&&(this.curtain?(this.displayVisible(!1),this.curtain.close().then((function(){t.scene.sleep()}))):(this.displayVisible(!0),this.scene.sleep()))},LoadingScene.prototype.appendProgress=function(t){this.progressText&&this.progressText.setText(t)},LoadingScene.prototype.getKey=function(){return this.sys.config.key},LoadingScene.prototype.getDebug=function(){var t="WebGL",e=this.game.config;e.renderType===Phaser.CANVAS?t="Canvas":e.renderType===Phaser.HEADLESS&&(t="Headless");var i=e.audio,n=this.game.device.audio;return"("+t+" | "+(!n.webAudio||i&&i.disableWebAudio?i&&i.noAudio||!n.webAudio&&!n.audioData?"No Audio":"HTML5 Audio":"Web Audio")+")"},LoadingScene.prototype.displayVisible=function(t){this.bg&&(this.bg.visible=t,this.debug.visible=t,this.mask.visible=t)},LoadingScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var e=t.sheet,i="@font-face { font-family: 'tt0173m_'; src: url('"+a.Url.getRes("fonts/en/tt0173m_.ttf")+"') format('truetype');font-display:swap }\n",n="@font-face { font-family: 'tt0503m_'; src: url('"+a.Url.getRes("fonts/en/tt0503m_.ttf")+"') format('truetype'); font-display:swap}\n",s="@font-face { font-family: 't04B25'; src: url('"+a.Url.getRes("fonts/04B.ttf")+"') format('truetype'); font-display:swap}";e.insertRule(i,0),e.insertRule(n,0),e.insertRule(s,0)},LoadingScene}(s.a),d=function(){function Curtain(t,e){this.scene=t,this.dpr=e,this.key="curtain",this.upDisplay=this.scene.add.image(0,0,this.key,"up.png").setOrigin(0).setVisible(!1).setScale(this.dpr),this.downDisplay=this.scene.add.image(0,0,this.key,"down.png").setOrigin(0,1).setVisible(!1).setScale(this.dpr)}return Curtain.prototype.open=function(){var t=this;return this.upDisplay.visible=!0,this.downDisplay.visible=!0,new Promise((function(e,i){if(t.scene.cameras.main)if(t.upTween||t.downTween)i();else{var n=t.scene.cameras.main.height;t.upDisplay.y=-t.upDisplay.displayHeight,t.downDisplay.y=n+t.downDisplay.displayHeight,t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:0},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:n},duration:1e3,onComplete:function(){t.clearTween(),e()}})}else e()}))},Curtain.prototype.close=function(){var t=this;return this.downDisplay.visible=!0,this.upDisplay.visible=!0,new Promise((function(e,i){if(t.scene.cameras.main){var n=t.scene.cameras.main.height;t.upDisplay.y=0,t.downDisplay.y=n,t.clearTween(),t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:-t.upDisplay.displayHeight},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:n+t.downDisplay.displayHeight},duration:1e3,onComplete:function(){t.clearTween(),e()}})}else e(null)}))},Curtain.prototype.destroy=function(){},Curtain.prototype.clearTween=function(){this.upTween&&(this.upTween.stop(),this.upTween=null),this.downTween&&(this.downTween.stop(),this.downTween=null)},Curtain}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(294),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function LoginAccountScene(){return t.call(this,{key:LoginAccountScene.name})||this}return o(LoginAccountScene,t),LoginAccountScene.prototype.preload=function(){var t=2;this.mWorld&&(t=this.mWorld.uiRatio||2),this.load.image("avatar_placeholder",s.Url.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",s.Url.getUIRes(t,"loading/curtain.png"),s.Url.getUIRes(t,"loading/curtain.json")),this.load.atlas("loading",s.Url.getRes("ui/loading/loading.png"),s.Url.getRes("ui/loading/loading.json")),this.load.script("webfont","./resources/scripts/webfont/1.6.26/webfont.js")},LoginAccountScene.prototype.init=function(e){t.prototype.init.call(this,e),this.createFont(),this.mWorld=e.world,this.mCallback=e.callBack},LoginAccountScene.prototype.create=function(){var e=this;t.prototype.create.call(this);try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){s.Logger.getInstance().warn("webfont failed to load")}var i=this.scale.gameSize.width,n=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1});var a=this.mWorld.uiRatio;this.bg=this.add.sprite(.5*i,.5*n,"loading").setScale(this.mWorld.uiScale*a*2),this.bg.play("loading_anis"),this.checkSize(new s.Size(i,n)),this.scale.on("resize",this.checkSize,this);var o=this.add.graphics();o.fillStyle(16763904,.8),o.fillRect(0,0,100,50),o.setInteractive(new Phaser.Geom.Rectangle(0,0,100,50),Phaser.Geom.Rectangle.Contains),o.x=200,o.y=300,o.on("pointerdown",(function(){e.mCallback&&(e.mCallback.call(e,e),e.mCallback=void 0)}),this)},LoginAccountScene.prototype.getKey=function(){return this.sys.config.key},LoginAccountScene.prototype.checkSize=function(t){},LoginAccountScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var e=t.sheet;e.insertRule("@font-face { font-family: 'tt0173m_'; src: url('./resources/fonts/en/tt0173m_.ttf') format('truetype');font-display:swap }\n",0),e.insertRule("@font-face { font-family: 'tt0503m_'; src: url('./resources/fonts/en/tt0503m_.ttf') format('truetype'); font-display:swap}\n",0),e.insertRule("@font-face { font-family: 't04B25'; src: url('./resources/fonts/04B.ttf') format('truetype'); font-display:swap}",0)},LoginAccountScene}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(294),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function SelectRoleScene(){return t.call(this,{key:SelectRoleScene.name})||this}return s(SelectRoleScene,t),SelectRoleScene.prototype.preload=function(){},SelectRoleScene.prototype.init=function(t){this.mWorld=t},SelectRoleScene.prototype.create=function(){t.prototype.create.call(this)},Object.defineProperty(SelectRoleScene.prototype,"key",{get:function(){return this.sys.config.key},enumerable:!1,configurable:!0}),SelectRoleScene}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(624),a=i(625),s=function(){function InputManager(t){this.render=t,this.mMouseManager=new a.a(t)}return InputManager.prototype.showJoystick=function(){this.mJoystickManager=new n.a(this.render),this.mJoystickManager.setScene(this.mScene)},InputManager.prototype.setScene=function(t){this.mScene=t,this.mMouseManager.changeScene(t),this.mJoystickManager&&this.mJoystickManager.setScene(t)},InputManager.prototype.resize=function(t,e){this.mMouseManager.resize(t,e)},InputManager.prototype.update=function(t,e){},InputManager.prototype.destroy=function(){this.mMouseManager&&this.mMouseManager.destroy(),this.mJoystickManager&&this.mJoystickManager.destroy()},InputManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(3),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function JoystickManager(e){var i=t.call(this)||this;return i.render=e,i.mScaleRatio=e.scaleRatio,i.mJoystick=i.render.mainPeer.JoystickManager,i}return s(JoystickManager,t),JoystickManager.prototype.setScene=function(t){this.scene=t,t&&this.onListener()},JoystickManager.prototype.onListener=function(){this.scene.input.on("pointerdown",this.onDownHandler,this),this.scene.input.on("pointerup",this.onUpHandler,this)},JoystickManager.prototype.offListener=function(){this.scene.input.off("pointermove",this.onPointerMoveHandler,this),this.scene.input.off("pointerdown",this.onDownHandler,this),this.scene.input.off("pointerup",this.onUpHandler,this)},JoystickManager.prototype.destroy=function(){this.offListener()},JoystickManager.prototype.onPointerMoveHandler=function(t){this.calcAngle(t)},JoystickManager.prototype.onDownHandler=function(t){this.scene.input.on("pointermove",this.onPointerMoveHandler,this),this.calcAngle(t),this.start()},JoystickManager.prototype.onUpHandler=function(t){this.scene.input.off("pointermove",this.onPointerMoveHandler,this),(t.downX-t.upX>10*this.mScaleRatio||Math.abs(t.downY-t.upY)>10*this.mScaleRatio)&&this.stop()},JoystickManager.prototype.calcAngle=function(t){this.mJoystick&&this.mJoystick.calcAngle(Math.ceil(t.worldX/this.mScaleRatio),Math.ceil(t.worldY/this.mScaleRatio))},JoystickManager.prototype.start=function(){this.mJoystick&&this.mJoystick.start()},JoystickManager.prototype.stop=function(){this.mJoystick&&this.mJoystick.stop()},JoystickManager}(a.PacketHandler)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(541),s=i(0),o=i(608);!function(t){t[t.RightMouseDown=1]="RightMouseDown",t[t.RightMouseUp=2]="RightMouseUp",t[t.LeftMouseDown=3]="LeftMouseDown",t[t.LeftMouseUp=4]="LeftMouseUp",t[t.WheelDown=5]="WheelDown",t[t.WheelUp=6]="WheelUp",t[t.RightMouseHolding=7]="RightMouseHolding",t[t.LeftMouseHolding=8]="LeftMouseHolding",t[t.Tap=9]="Tap"}(n||(n={}));var h=function(){function MouseManager(t){this.render=t,this.running=!1,this.mDownDelay=1e3,this.delay=500,this.zoom=this.render.scaleRatio||1}return Object.defineProperty(MouseManager.prototype,"clickID",{get:function(){return this.mClickID},enumerable:!1,configurable:!0}),MouseManager.prototype.changeScene=function(t){this.pause(),this.mGameObject=null,this.mScene=t,this.mScene&&(t.input.on("gameobjectdown",this.groundDown,this),t.input.on("pointerdown",this.pointerDownHandler,this),this.resume())},MouseManager.prototype.resize=function(t,e){this.zoom=this.render.scaleRatio||1},MouseManager.prototype.pause=function(){this.running=!1},MouseManager.prototype.resume=function(){this.running=!0},MouseManager.prototype.onUpdate=function(t,e){if(!1!==this.running&&void 0!==t){var i=[];t.leftButtonDown()?i.push(n.LeftMouseDown):t.leftButtonReleased()&&i.push(n.LeftMouseUp),t.middleButtonDown()?i.push(n.WheelDown):t.middleButtonReleased()&&i.push(n.WheelUp),t.rightButtonDown()?i.push(n.RightMouseDown):t.rightButtonReleased()&&i.push(n.RightMouseUp);var s=0,h=null;if(e&&e.parentContainer&&(s=e.parentContainer.getData("id"),h=e.parentContainer.parentContainer||e.parentContainer),!1===t.isDown){var l=Math.abs(t.downX-t.upX),c=Math.abs(t.downY-t.upY);l<10&&c<10&&e&&e.parentContainer&&h&&h instanceof a.a&&h.nodeType===o.b.ElementNodeType&&h.scaleTween()}0!==i.length&&this.sendMouseEvent(i,s,{x:t.worldX/this.zoom,y:t.worldY/this.zoom})}},Object.defineProperty(MouseManager.prototype,"enable",{get:function(){return!!this.mScene&&this.mScene.input.mouse.enabled},set:function(t){this.mScene&&(this.mScene.input.mouse.enabled=t)},enumerable:!1,configurable:!0}),MouseManager.prototype.destroy=function(){this.mScene=null,this.running=!1,this.debounce=null,this.mScene&&(this.mScene.input.off("gameobjectdown",this.groundDown,this),this.mScene.input.off("pointerdown",this.pointerDownHandler,this)),this.pause()},MouseManager.prototype.groundDown=function(t,e){this.mGameObject=e,this.mDownTime=setTimeout(this.holdHandler.bind(this),this.mDownDelay,t,e)},MouseManager.prototype.groundUp=function(t,e){this.onUpdate(t,e)},MouseManager.prototype.pointerDownHandler=function(t,e){var i=this;this.debounce?this.mGameObject=null:(this.debounce=setTimeout((function(){i.debounce=null}),this.delay),this.mScene.input.off("pointerup",this.onPointerUpHandler,this),this.mScene.input.once("pointerup",this.onPointerUpHandler,this),this.render&&this.render.emitter&&this.render.emitter.emit(s.MessageType.SCENE_BACKGROUND_CLICK,t),this.onUpdate(t,this.mGameObject))},MouseManager.prototype.onPointerUpHandler=function(t){clearTimeout(this.mDownTime),this.onUpdate(t,this.mGameObject),this.mGameObject=null},MouseManager.prototype.holdHandler=function(t,e){if(clearTimeout(this.mDownTime),!(Math.abs(t.downX-t.x)>5*this.zoom||Math.abs(t.downY-t.y)>5*this.zoom)){var i=0;e&&e.parentContainer&&(i=e.parentContainer.getData("id"),e.parentContainer.parentContainer||e.parentContainer,this.sendMouseEvent([n.LeftMouseHolding],i,{x:t.worldX/this.zoom,y:t.worldY/this.zoom}))}},MouseManager.prototype.sendMouseEvent=function(t,e,i){this.mClickID=e,this.render.mainPeer.sendMouseEvent(e,t,i)},MouseManager}()},function(t,e,i){"use strict";i.r(e),i.d(e,"Item",(function(){return h}));var n,a=i(479),s=i(2),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function Item(e){var i=t.call(this,e)||this,n=e.make.image({key:"prop_background"}).setOrigin(0,0);return i.setSize(n.width,n.height),i.add(n),i.mImage=new a.DynamicImage(i.scene,0,0).setOrigin(0,0),i.add(i.mImage),i.mCount=e.make.text(void 0,!1),i.mCount.setAlign("right"),i.mCount.y=i.height-20,i.add(i.mCount),i}return o(Item,t),Item.prototype.setProp=function(t){var e=this;this.mProp=t,this.mCount&&t&&(this.mImage.load(s.Url.getOsdRes(t.texturePath),this,(function(){e.mImage.setInteractive(),e.scene.input.setDraggable(e.mImage);var t=1;e.mImage.width>e.width&&(t=e.width/e.mImage.width),e.mImage.height>e.height&&(t=e.height/e.mImage.height),e.mImage.scale=t})),this.mCount.setText(t.count>1?t.count.toString():""),this.mCount.x=this.width-this.mCount.width)},Item.prototype.clear=function(){this.count&&this.mProp&&(this.mCount.setText(""),this.mImage.setTexture(void 0),this.mImage.off("pointerup",this.onPointerUpHandler,this),this.mProp=void 0)},Item.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},Object.defineProperty(Item.prototype,"prop",{get:function(){return this.mProp},enumerable:!1,configurable:!0}),Item.prototype.onPointerUpHandler=function(){this.emit("click",this.mProp)},Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOnlineBottomPanel",(function(){return l}));var n,a=i(6),s=i(479),o=i(2),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),l=function(t){function PicaOnlineBottomPanel(e,i,n,a,s){var o=t.call(this,e)||this;return o.key=a,o.dpr=s,o.isblack=!1,o.setSize(i,n),o.setInteractive(),o.init(),o}return h(PicaOnlineBottomPanel,t),PicaOnlineBottomPanel.prototype.init=function(){var t=this.width,e=69*this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,this.width,this.height),this.blackGraphic.x=.5*-this.width,this.blackGraphic.y=.5*-this.height,this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1),this.content.setSize(t,e),this.add(this.content),this.bg=new s.ThreeSlicePath(this.scene,0,0,t,87*this.dpr,this.key,["people_panel_bg_left","people_panel_bg_middle","people_panel_bg_right"],this.dpr),this.bg.y=.5*e-.5*this.bg.height+18*this.dpr,this.content.add(this.bg),this.headIcon=new s.DynamicImage(this.scene,0,0),this.headIcon.x=.5*-t+40*this.dpr,this.headIcon.y=0*this.dpr,this.headIcon.scale=this.dpr,this.headIcon.visible=!1,this.content.add(this.headIcon),this.nameText=this.scene.make.text({x:.5*-t+96*this.dpr,y:.5*-e+15*this.dpr,text:"",style:o.UIHelper.whiteStyle(this.dpr,14)}),this.nameText.setFontStyle("bold"),this.nameText.setOrigin(0,.5),this.content.add(this.nameText);var i=["butt_yellow_left_s","butt_yellow_middle_s","butt_yellow_right_s"];this.reportBtn=new s.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,i,i,o.i18n.t("player_info.report")),this.reportBtn.setTextStyle(o.UIHelper.brownishStyle(this.dpr)),this.reportBtn.y=.5*e-.5*this.reportBtn.height-5*this.dpr,this.reportBtn.x=.5*this.reportBtn.width+20*this.dpr,this.reportBtn.on(a.ClickEvent.Tap,this.onReportHandler,this),this.content.add(this.reportBtn);var n=["butt_red_left_s","butt_red_middle_s","butt_red_right_s"];this.blackBtn=new s.ThreeSliceButton(this.scene,84*this.dpr,31*this.dpr,this.key,n,n,o.i18n.t("player_info.blockuer")),this.blackBtn.setTextStyle(o.UIHelper.whiteStyle(this.dpr)),this.blackBtn.y=this.reportBtn.y,this.blackBtn.x=.5*-this.blackBtn.width-5*this.dpr,this.blackBtn.on(a.ClickEvent.Tap,this.onBlockHandler,this),this.content.add(this.blackBtn),this.content.x=0,this.content.y=.5*this.height+.5*this.content.height+10*this.dpr,this.content.setInteractive()},PicaOnlineBottomPanel.prototype.setRoleData=function(t,e){var i=this;if(this.roleData=t,this.isblack=e,this.roleData){if(this.headIcon.visible=!1,this.nameText.text=t.nickname,t.avatar){var n=o.Url.getOsdRes(t.avatar);this.headIcon.load(n,this,(function(){i.headIcon.visible=!0}))}this.blackBtn.setText(e?o.i18n.t("player_info.remove_black"):o.i18n.t("player_info.blockuer"))}},PicaOnlineBottomPanel.prototype.refreshBlack=function(t){this.setRoleData(this.roleData,t)},PicaOnlineBottomPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaOnlineBottomPanel.prototype.addListen=function(){this.reportBtn.on(a.ClickEvent.Tap,this.onReportHandler,this),this.blackBtn.on(a.ClickEvent.Tap,this.onBlockHandler,this),this.on("pointerdown",this.onCloseHandler,this)},PicaOnlineBottomPanel.prototype.removeListen=function(){this.reportBtn.off(a.ClickEvent.Tap,this.onReportHandler,this),this.blackBtn.off(a.ClickEvent.Tap,this.onBlockHandler,this),this.off("pointerdown",this.onCloseHandler,this)},PicaOnlineBottomPanel.prototype.show=function(){this.addListen(),this.visible=!0;var t=.5*this.height+.5*this.content.height+10*this.dpr;this.content.y=t;var e=t,i=.5*this.height-.5*this.content.height;this.playMove(e,i)},PicaOnlineBottomPanel.prototype.hide=function(){this.removeListen(),this.visible=!1},PicaOnlineBottomPanel.prototype.playMove=function(t,e){var i=this.scene.tweens.add({targets:this.content,y:{from:t,to:e},ease:"Linear",duration:150,onComplete:function(){i.stop(),i.remove()}})},PicaOnlineBottomPanel.prototype.onReportHandler=function(){this.sendHandler&&this.sendHandler.runWith(["report"])},PicaOnlineBottomPanel.prototype.onBlockHandler=function(){this.sendHandler&&this.sendHandler.runWith(["block",{uid:this.roleData.platformId,black:!this.isblack}])},PicaOnlineBottomPanel.prototype.onCloseHandler=function(){this.hide(),this.sendHandler&&this.sendHandler.runWith(["close"])},PicaOnlineBottomPanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaMyRoomNavigationPanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(21),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaMyRoomNavigationPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.setSize(i,n),h.key=a,h.dpr=s,h.zoom=o,h.create(),h}return l(PicaMyRoomNavigationPanel,t),PicaMyRoomNavigationPanel.prototype.create=function(){var t=this;this.gameScroll=new a.GameScroller(this.scene,{x:0,y:10*this.dpr,width:this.width,height:this.height,zoom:this.zoom,align:2,orientation:0,dpr:this.dpr,space:10*this.dpr,padding:{top:10*this.dpr},cellupCallBack:function(e){t.onGameScrollHandler(e)}}),this.add(this.gameScroll)},PicaMyRoomNavigationPanel.prototype.clear=function(){this.gameScroll.clearItems(!0)},PicaMyRoomNavigationPanel.prototype.refreshMask=function(){this.gameScroll.refreshMask()},PicaMyRoomNavigationPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaMyRoomNavigationPanel.prototype.setRoomDataList=function(t){var e=this;this.gameScroll.clearItems(!0),this.setMyRoomDatas(t.selfRooms,new h.Handler(this,(function(){e.setHistoryDatas(t.historyRooms)})))},PicaMyRoomNavigationPanel.prototype.setMyRoomDatas=function(t,e){var i=new s.ImageValue(this.scene,78*this.dpr,15*this.dpr,this.key,"my_house",this.dpr,{color:"#FFC51A",fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT});i.setStroke("#744803",2*this.dpr),i.x=.5*-this.width+20*this.dpr,i.setFrameValue(h.i18n.t("room_list.my_room"),this.key,"my_house"),this.gameScroll.addItem(i),this.createRoomItemByFrame(t,"my_home_bg","#744803",e)},PicaMyRoomNavigationPanel.prototype.createRoomItemByFrame=function(t,e,i,n){var a=this;void 0===e&&(e="list_bg"),void 0===i&&(i="#333333");var s=0,framefun=function(){for(var o=0,h=t.slice(s,s+5);o<h.length;o++){var l=h[o],c=new p(a.scene,a.key,a.dpr,e,i);c.setRoomData(l),a.gameScroll.addItem(c)}a.gameScroll.Sort(!0),(s+=5)<t.length?setTimeout((function(){framefun()}),20):n&&n.run()};framefun()},PicaMyRoomNavigationPanel.prototype.setHistoryDatas=function(t){var e=new s.ImageValue(this.scene,78*this.dpr,30*this.dpr,this.key,"footprint",this.dpr,{color:"#FFC51A",fontSize:13*this.dpr,fontFamily:h.Font.DEFULT_FONT});e.setStroke("#744803",2*this.dpr),e.x=.5*-this.width+20*this.dpr,e.setFrameValue(h.i18n.t("room_list.my_history"),this.key,"footprint"),this.gameScroll.addItem(e),this.createRoomItemByFrame(t)},PicaMyRoomNavigationPanel.prototype.onGameScrollHandler=function(t){t&&t.roomData&&this.onSendHandler(t.roomData)},PicaMyRoomNavigationPanel.prototype.onSendHandler=function(t){this.sendHandler&&this.sendHandler.runWith(t.roomId)},PicaMyRoomNavigationPanel}(Phaser.GameObjects.Container),p=function(t){function RoomListItem(e,i,n,l,c){void 0===l&&(l="list_bg"),void 0===c&&(c="#333333");var p=t.call(this,e)||this;return p.key=i,p.dpr=n,p.bg=new a.NineSlicePatch(p.scene,0,0,254*n,40*n,p.key,l,{left:12*p.dpr,top:0*p.dpr,right:12*p.dpr,bottom:0*p.dpr}),p.add(p.bg),p.setSize(p.bg.width,p.bg.height),p.roomName=new a.BBCodeText(p.scene,.5*-p.width+10*n,.5*-p.height+5*n,"",{fontFamily:h.Font.DEFULT_FONT,fontSize:12*n,color:c}),p.roomName.setOrigin(0),p.add(p.roomName),p.roomOwnerName=new s.ImageBBCodeValue(e,50*n,20*n,i,"user",n,{fontFamily:h.Font.DEFULT_FONT,fontSize:11*n,color:"#333333"}),p.roomOwnerName.x=p.roomName.x+.5*p.roomOwnerName.width,p.roomOwnerName.y=p.roomName.y+25*n,p.add(p.roomOwnerName),p.playerCount=new s.ImageBBCodeValue(e,30*n,20*n,o.c.commonKey,"home_persons",n,{fontFamily:h.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),p.playerCount.x=.5*p.width-35*n,p.add(p.playerCount),p}return l(RoomListItem,t),RoomListItem.prototype.setRoomData=function(t){this.roomData=t,this.roomName.text="[b]"+t.name+"[/b]",this.playerCount.setText("[b]"+t.playerCount+"[/b]"),this.roomOwnerName.setText(t.ownerName)},RoomListItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaPartyNavigationPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(21),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaPartyNavigationPanel(e,i,n,a,s,o){var h=t.call(this,e)||this;return h.setSize(i,n),h.key=a,h.dpr=s,h.zoom=o,h.create(),h}return c(PicaPartyNavigationPanel,t),PicaPartyNavigationPanel.prototype.create=function(){var t=this;this.signProgressPanel=new u(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.signProgressPanel.y=.5*-this.height+15*this.dpr,this.signProgressPanel.setHandler(new l.Handler(this,this.onProgressHandler)),this.add(this.signProgressPanel);var e={x:0,y:60*this.dpr,table:{width:254*this.dpr,height:330*this.dpr,columns:1,cellWidth:254*this.dpr,cellHeight:50*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(e,i){e.scene;var n=e.index,a=e.item;return null===i&&(i=new d(t.scene,t.key,t.dpr)),i.setPartyData(a,n),i}};this.mGameGrid=new a.GameGridTable(this.scene,e),this.mGameGrid.layout(),this.mGameGrid.on("cellTap",this.onGridTableHandler,this),this.add(this.mGameGrid),this.noPartyImg=this.scene.make.image({key:this.key,frame:"no_party"}),this.noPartyImg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.noPartyImg.y=20*this.dpr,this.add(this.noPartyImg),this.noPartyText=this.scene.make.text({x:0,y:this.noPartyImg.y+.5*this.noPartyImg.height+10*this.dpr,text:l.i18n.t("party.nopartytips"),style:{color:"#AAAAAA",fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5),this.add(this.noPartyText),this.itemtips=new s.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,o.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.add(this.itemtips),this.hotelBtn=new a.Button(this.scene,this.key,"hotel","hotel",l.i18n.t("party.hotel")),this.hotelBtn.text.setOrigin(0,1),this.hotelBtn.tweenScale=.88,this.hotelBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#FFDE00",stroke:"#222222",strokeThickness:2*this.dpr}),this.hotelBtn.setTextOffset(.5*-this.hotelBtn.width+5*this.dpr,.5*this.hotelBtn.height-2*this.dpr),this.hotelBtn.setPosition(.5*-this.hotelBtn.width-18*this.dpr,this.signProgressPanel.y+.5*this.signProgressPanel.height+.5*this.hotelBtn.height+20*this.dpr),this.hotelBtn.on(String(a.ClickEvent.Tap),this.onHotelHandler,this),this.add(this.hotelBtn),this.picatownBtn=new a.Button(this.scene,this.key,"town","town",l.i18n.t("party.picatown")),this.picatownBtn.text.setOrigin(0,1),this.picatownBtn.tweenScale=.88,this.picatownBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:l.Font.DEFULT_FONT,color:"#FFDE00",stroke:"#222222",strokeThickness:2*this.dpr}),this.picatownBtn.setTextOffset(.5*-this.picatownBtn.width+5*this.dpr,.5*this.picatownBtn.height-2*this.dpr),this.picatownBtn.setPosition(.5*this.picatownBtn.width-10*this.dpr,this.hotelBtn.y),this.picatownBtn.on(String(a.ClickEvent.Tap),this.onPicatownHandler,this),this.add(this.picatownBtn)},PicaPartyNavigationPanel.prototype.refreshMask=function(){this.mGameGrid.resetMask()},PicaPartyNavigationPanel.prototype.setHandler=function(t){this.sendHandler=t},PicaPartyNavigationPanel.prototype.setPartyDataList=function(t){this.partyData=t,t.party.length>0?(this.mGameGrid.setItems(t.party),this.mGameGrid.visible=!0,this.noPartyText.visible=!1,this.noPartyImg.visible=!1):(this.noPartyText.visible=!0,this.noPartyImg.visible=!0,this.mGameGrid.visible=!1)},PicaPartyNavigationPanel.prototype.setSignProgress=function(t){this.progressData=t,this.signProgressPanel.setProgressDatas(t)},PicaPartyNavigationPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaPartyNavigationPanel.prototype.onGridTableHandler=function(t){this.onSendHandler(t.partyData)},PicaPartyNavigationPanel.prototype.onHotelHandler=function(){this.partyData&&this.sendHandler&&this.sendHandler.runWith(["hotel",this.partyData.hotel])},PicaPartyNavigationPanel.prototype.onPicatownHandler=function(){this.partyData&&this.sendHandler&&this.sendHandler.runWith(["pictown",this.partyData.picatown])},PicaPartyNavigationPanel.prototype.onSendHandler=function(t){this.sendHandler&&this.sendHandler.runWith(["partylist",t])},PicaPartyNavigationPanel.prototype.onProgressHandler=function(t,e){if(this.progressData){var i=e.progressData;i.received||(i.targetValue<=this.progressData.currentProgressValue?this.emit("questreward",t):(this.itemtips.setItemData(i.rewards[0]),this.showItemTipsState(e)))}},PicaPartyNavigationPanel.prototype.showItemTipsState=function(t,e){void 0===e&&(e=0);var i=this.itemtips.x,n=this.itemtips.y;this.setTipsPosition(t,e),i!==this.itemtips.x||n!==this.itemtips.y?this.itemtips.setVisible(!0):this.itemtips.setVisible(!this.itemtips.visible)},PicaPartyNavigationPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);for(var i=t.x,n=t.y,a=t;a.parentContainer!==this;)i+=a.parentContainer.x,n+=a.parentContainer.y,a=a.parentContainer;i-.5*this.itemtips.width<.5*-this.width?this.itemtips.x=.5*this.itemtips.width-.5*this.width+20*this.dpr:i+.5*this.itemtips.width>.5*this.width?this.itemtips.x=.5*this.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=i,this.itemtips.y=n-.5*this.itemtips.height+10*this.dpr+e},PicaPartyNavigationPanel}(Phaser.GameObjects.Container),d=function(t){function PartyListItem(e,i,n){var h=t.call(this,e)||this;return h.key=i,h.dpr=n,h.bg=new a.NineSlicePatch(h.scene,0,0,254*n,40*n,h.key,"list_bg",{left:12*h.dpr,top:0*h.dpr,right:12*h.dpr,bottom:0*h.dpr}),h.add(h.bg),h.setSize(h.bg.width,h.bg.height),h.imagIcon=new s.DynamicImage(e,0,0),h.imagIcon.setTexture(h.key,"party_icon_1"),h.imagIcon.x=.5*-h.width+.5*h.imagIcon.width+8*n,h.imagIcon.y=.5*-h.height+.5*h.imagIcon.height+5*n,h.add(h.imagIcon),h.hotImageValue=new s.ImageBBCodeValue(e,30*n,10*n,i,"hot",n,{fontSize:9*n,color:"#FFDD00",fontFamily:l.Font.DEFULT_FONT,stroke:"#666666",strokeThickness:2*n}),h.hotImageValue.setOffset(-3*n,0),h.hotImageValue.x=.5*-h.width+.5*h.hotImageValue.width+8*n,h.hotImageValue.y=.5*h.height-.5*h.hotImageValue.height-5*n,h.add(h.hotImageValue),h.partyName=new a.BBCodeText(h.scene,.5*-h.width+45*n,.5*-h.height+5*n,"",{fontFamily:l.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),h.partyName.setOrigin(0),h.add(h.partyName),h.partyOwnerName=new s.ImageBBCodeValue(e,50*n,20*n,i,"user",n,{fontFamily:l.Font.DEFULT_FONT,fontSize:11*n,color:"#333333"}),h.partyOwnerName.x=h.partyName.x+.5*h.partyOwnerName.width,h.partyOwnerName.y=h.partyName.y+25*n,h.add(h.partyOwnerName),h.playerCount=new s.ImageBBCodeValue(e,30*n,20*n,o.c.commonKey,"home_persons",n,{fontFamily:l.Font.DEFULT_FONT,fontSize:12*n,color:"#333333"}),h.playerCount.x=.5*h.width-35*n,h.add(h.playerCount),h}return c(PartyListItem,t),PartyListItem.prototype.setPartyData=function(t){this.partyData=t;var e=t.topic.display.texturePath,i=e.lastIndexOf("/"),n=e.slice(i+1,e.length),a=e.slice(0,i+1),s=l.Url.getOsdRes(a+n+"_s_"+this.dpr+"x.png");this.imagIcon.load(s),this.hotImageValue.setText(this.getHotText(t.focus)),this.partyName.text="[b]"+t.name+"[/b]",this.playerCount.setText("[b]"+t.playerCount+"[/b]"),this.partyOwnerName.setText(t.ownerName)},PartyListItem.prototype.getHotText=function(t){var e=t+"";return"en"===l.i18n.language?e.length>=4&&e.length<7?e=Math.floor(t/100)/10+l.i18n.t("quantityunit.k"):e.length>=7&&(e=Math.floor(t/1e5)/10+l.i18n.t("quantityunit.m")):e=h.ChineseUnit.getChineseUnit(t,1),"[stroke]"+e+" [/stroke]"},PartyListItem}(Phaser.GameObjects.Container),u=function(t){function SignProgressPanel(e,i,n,s,o){var h=t.call(this,e)||this;h.progressItems=[],h.setSize(i,n),h.dpr=o,h.key=s;var c={x:0*o/2,y:15*o,width:218*o,height:11*o,background:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:s,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:s,frame:"order_progress_top"},dpr:o,textConfig:void 0};return h.progress=new a.ProgressBar(e,c),h.add(h.progress),h.text=e.make.text({x:h.width/2,y:.5*-h.height+11*o,text:"",style:{color:"#6666FF",fontSize:13*o,fontFamily:l.Font.DEFULT_FONT}}),h.text.setOrigin(1,.5),h.add(h.text),h}return c(SignProgressPanel,t),SignProgressPanel.prototype.setProgressDatas=function(t){for(var e=t.steps.length,i=100,n=this.progress.width,a=0,s=0;s<e;s++){var o=t.steps[s],h=void 0;s<this.progressItems.length?h=this.progressItems[s]:(h=new m(this.scene,0,0,this.key,this.dpr),this.add(h),this.progressItems.push(h),h.setHandler(this.receiveHandler)),h.x=.5*-n+(e>1?n*s/(e-1):.5*n),h.y=15*this.dpr,h.setItemData(o,s,t.currentProgressValue),i=o.targetValue,o.targetValue>t.currentProgressValue&&0===a&&(a=o.targetValue)}this.progress.setProgress(t.currentProgressValue,i),this.initCountDown(a-t.currentProgressValue,i===a)},SignProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressPanel.prototype.destroy=function(){clearInterval(this.timerID),t.prototype.destroy.call(this)},SignProgressPanel.prototype.initCountDown=function(t,e){var i=this;this.timerID&&(clearTimeout(this.timerID),this.timerID=void 0);var timeextu=function(){var e=Math.floor(t/60),n=t%60,a=(e<10?"0"+e:e+"")+":"+(n<10?"0"+n:n+"");i.text.text=l.i18n.t("party.progresstips",{timer:a}),--t>0?i.timerID=setTimeout((function(){timeextu()}),1e3):(i.text.text="",i.timerID=void 0)};timeextu()},SignProgressPanel}(Phaser.GameObjects.Container),m=function(t){function SignProgressItem(e,i,n,o,h){var c=t.call(this,e,i,n)||this;return c.dpr=h,c.key=o,c.bg=new a.Button(e,o,"order_progress_unfinished","order_progress_unfinished"),c.icon=new s.DynamicImage(e,0,0),c.text=e.make.text({x:2*h,y:.5*-c.bg.height-8*h,text:"10",style:{color:"#FFDD00",fontSize:13*h,fontFamily:l.Font.DEFULT_FONT}}),c.text.setStroke("#905B06",2*h).setOrigin(.5),c.finishIcon=e.make.image({key:o,frame:"order_progress_ok"}),c.finishIcon.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.balckgraphic=e.make.graphics(void 0,!1),c.balckgraphic.clear(),c.balckgraphic.fillStyle(0,.5),c.balckgraphic.fillCircle(0,0,16*h),c.add([c.bg,c.icon,c.text,c.balckgraphic,c.finishIcon]),c.finishIcon.visible=!1,c}return c(SignProgressItem,t),SignProgressItem.prototype.setItemData=function(t,e,i){var n=this;if(this.progressData=t,this.index=e,this.text.text=0===e?l.i18n.t("common.sign"):l.i18n.t("party.onlinetime",{name:Math.floor(t.targetValue/60)}),this.text.visible=0===e,t.rewards&&t.rewards.length>0){var s=l.Url.getOsdRes(t.rewards[0].display.texturePath);this.icon.load(s,this,(function(){n.icon.scale=1,n.icon.scaleY=29*n.dpr/n.icon.displayHeight,n.icon.scaleX=n.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<=i?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received&&(this.finishIcon.visible=!0,this.balckgraphic.visible=!0),this.icon.clearTint()):(this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),this.icon.setTint(9145210)),t.received?this.bg.off(String(a.ClickEvent.Tap),this.onReceiveHandler,this):(this.bg.off(String(a.ClickEvent.Tap),this.onReceiveHandler,this),this.bg.on(String(a.ClickEvent.Tap),this.onReceiveHandler,this))},SignProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith([this.index,this])},SignProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaRoamEffectOnePanel",(function(){return o}));var n,a=i(2),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function PicaRoamEffectOnePanel(e,i,n,a){var s=t.call(this,e)||this;return s.isOne=!0,s.loopTimes=0,s.setSize(i,n),s.init(),s.setInteractive(),s}return s(PicaRoamEffectOnePanel,t),PicaRoamEffectOnePanel.prototype.init=function(){this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,1),this.blackGraphic.fillRect(.5*-this.width,.5*-this.height,2*this.width,2*this.height),this.blackGraphic.visible=!1,this.blackGraphic.alpha=0,this.video=this.scene.make.video({key:"roamone"}),this.video.on("complete",this.onCompleteHandler,this),this.add([this.video,this.blackGraphic])},PicaRoamEffectOnePanel.prototype.setHandler=function(t){this.send=t},PicaRoamEffectOnePanel.prototype.setRewardDatas=function(t,e){this.rewardDatas=t,this.isOne=e,e?"roamone"!==this.video.getVideoKey()?this.video.changeSource("roamone",!0):this.video.play():("roamtenrepead"!==this.video.getVideoKey()?this.video.changeSource("roamtenrepead",!0,!1):this.video.play(),this.loopTimes=1),this.setVideoSize(),this.video.visible=!0,this.blackGraphic.visible=!1},PicaRoamEffectOnePanel.prototype.play=function(){this.video&&this.video.play(!1)},PicaRoamEffectOnePanel.prototype.onCompleteHandler=function(){if(!this.isOne&&this.loopTimes>0)return this.loopTimes--,void(0===this.loopTimes?this.video.changeSource("roamreward",!0,!1):this.video.play());this.send&&this.send.runWith("compl"),this.blackGraphic.alpha=0,this.blackGraphic.visible=!0,a.UIHelper.playAlphaTween(this.scene,this.blackGraphic,0,1)},PicaRoamEffectOnePanel.prototype.setVideoSize=function(){this.video.scale=1;var t=this.width/this.video.displayWidth,e=this.height/this.video.displayHeight;this.video.scale=t>e?t:e},PicaRoamEffectOnePanel}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){function LocalStorageManager(){}return LocalStorageManager.prototype.setItem=function(t,e){localStorage.setItem(t,e)},LocalStorageManager.prototype.removeItem=function(t){localStorage.removeItem(t)},LocalStorageManager.prototype.getItem=function(t){return localStorage.getItem(t)},LocalStorageManager.prototype.clear=function(){localStorage.clear()},LocalStorageManager.prototype.destroy=function(){this.clear()},LocalStorageManager}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return x}));var n,a,s=i(0),o=i(2),h=i(609),l=i(294),c=i(611),p=i(483),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function DecorateManager(e,i){var n=t.call(this)||this;return n.render=i,n.mSelecting=!1,n.mDisplayManager=n.render.displayManager,n.mDpr=n.render.scaleRatio,n}return d(DecorateManager,t),DecorateManager.prototype.setElement=function(t){this.mSelectorElement=this.mDisplayManager.getDisplay(t),this.mediator.setElement(t,!0),this.mSelecting=!0},DecorateManager.prototype.moveElement=function(t){if(this.mSelectorElement&&t){var e=this.mediator,i=t.worldX/this.mDpr,n=t.worldY/this.mDpr;e.moveElement(i,n)}},DecorateManager.prototype.isDragging=function(){return this.mSelectorElement&&this.mSelecting},Object.defineProperty(DecorateManager.prototype,"mediator",{get:function(){return this.render.mainPeer[s.ModuleName.PICADECORATE_NAME]},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateManager.prototype,"selecting",{get:function(){return this.mSelecting},set:function(t){this.mSelecting=t},enumerable:!1,configurable:!0}),DecorateManager}(Phaser.Events.EventEmitter),m=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),f=function(t){function DecorateScene(e){return t.call(this,e||{key:s.SceneName.DECORATE_SCENE})||this}return m(DecorateScene,t),DecorateScene.prototype.initListener=function(){this.input.on("pointerup",this.onPointerUpHandler,this),this.input.on("pointerdown",this.onPointerDownHandler,this),this.input.on("gameobjectdown",this.onGameobjectDownHandler,this)},DecorateScene.prototype.initInput=function(){this.mDecorateManager=new u(this,this.render)},DecorateScene.prototype.onGameobjectDownHandler=function(t,e){if(e){var i=e.getData("id");i&&this.mDecorateManager.setElement(i)}},DecorateScene.prototype.onPointerUpHandler=function(e){t.prototype.onPointerUpHandler.call(this,e),this.mDecorateManager.selecting=!1},DecorateScene.prototype.onGameobjectUpHandler=function(t){this.removePointerMoveHandler(),this.mDecorateManager.selecting=!1},DecorateScene.prototype.onPointerMoveHandler=function(t){this.mDecorateManager.isDragging()?t.downX===t.x&&t.downY===t.y||this.mDecorateManager.moveElement(t):this.render.camerasManager.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},DecorateScene}(p.a),y=i(619),g=i(620),P=i(621),_=i(546),v=i(147),b=i(540),T=i(622),S=i(434),x=function(){function SceneManager(t){this.render=t,this.sceneClass={BasicScene:l.a,CreateRoleScene:c.a,GamePauseScene:y.a,LoadingScene:g.a,LoginAccountScene:P.a,LoginScene:_.a,MainUIScene:v.a,PlayScene:p.a,RoomScene:b.a,SelectRoleScene:T.a,SkyBoxScene:S.a,DecorateScene:f},this.render.exportProperty(this,this.render,s.ModuleName.SCENEMANAGER_NAME).onceReady((function(){}))}return Object.defineProperty(SceneManager.prototype,"currentScene",{get:function(){var t=this.render.game.scene;return t?t.getScene(this.mCurSceneName):null},enumerable:!1,configurable:!0}),SceneManager.prototype.resize=function(t,e){var i=this.render.game.scene;if(!i)return null;var n=this.render.scaleRatio,a=i.getScene("PlayScene");a&&a.setScale(n);var s=i.getScene("MainUIScene");s&&s.setScale(n)},SceneManager.prototype.getSceneByName=function(t){if(this.render&&this.render.game)return this.render.game.scene.getScene(t)},SceneManager.prototype.showProgress=function(t){var e=this.render.game.scene;if(e){var i=e.getScene("LoadingScene");if(i&&i.scene.isActive){t*=100;var n=o.StringUtils.format("正在加载资源 {0}",[t.toFixed(0)+"%"]);i.updateProgress(n)}e.bringToTop("LoadingScene")}},SceneManager.prototype.bringToTop=function(t){var e=this.render.game.scene;if(e){var i=e.getScene(t);i&&i.scene.isActive&&e.bringToTop(t)}},SceneManager.prototype.startScene=function(t,e){var i=this.render.game.scene;if(e||(e={render:this.render}),i&&this.sceneClass.hasOwnProperty(t)){if(e.render=this.render,void 0!==e.state)switch(e.state){case s.LoadState.ENTERWORLD:e.text=h.c.enterWorld();break;case s.LoadState.DOWNLOADGAMECONFIG:e.text=h.c.downloadGameConfig();break;case s.LoadState.DOWNLOADSCENECONFIG:e.text=h.c.downloadSceneConfig();break;case s.LoadState.LOADINGRESOURCES:e.text=h.c.loadingResources();break;case s.LoadState.LOGINGAME:e.text=h.c.loginGame();break;case s.LoadState.PARSECONFIG:e.text=h.c.parseConfig();break;case s.LoadState.WAITENTERROOM:e.text=h.c.waitEnterRoom();break;case s.LoadState.CREATESCENE:e.text=h.c.createScene()}var n=i.getScene(t);if(n)n.scene.isActive(t)?n.updateProgress(e.text):n.wake(e),e.callBack&&e.callBack();else this.render.emitter.once("sceneCreated",(function(){o.Logger.getInstance().debug("sceneCreated===scenemanager"),e.callBack&&e.callBack()}),this),i.add(t,this.sceneClass[t]),i.start(t,e);this.mCurSceneName=t}},SceneManager.prototype.launchScene=function(t,e,i){var n=this.render.game.scene;if(i||(i={render:this.render}),n&&this.sceneClass.hasOwnProperty(e)){i.render=this.render;var a=n.getScene(e);this.render.emitter.once("sceneCreated",(function(){i.callBack&&i.callBack()}),this),a||n.add(e,this.sceneClass[e]),t.scene.launch(e,i)}},SceneManager.prototype.stopScene=function(t){var e=this.render.game.scene;if(!e)return Promise.reject("start faild. SceneManager does not exist");if(!this.sceneClass.hasOwnProperty(t))return Promise.reject("className error: "+t);var i=e.getScene(t);i&&(i.stop(),this.render.game.scene.remove(t))},SceneManager.prototype.wakeScene=function(t,e){var i=this.render.game.scene;if(!i)return Promise.reject("start faild. SceneManager does not exist");if(!this.sceneClass.hasOwnProperty(t))return Promise.reject("className error: "+t);var n=i.getScene(t);n&&n.wake(e)},SceneManager.prototype.sleepScene=function(t){if(this.render.game.scene.getScene(t)){var e=this.render.game.scene.getScene(t);e.scene.isActive(t)&&e.sleep()}else o.Logger.getInstance().debug(t+"sleep faild")},SceneManager.prototype.pauseScene=function(t){var e=this.render.game.scene.getScene(t);e?e.scene.pause(t):o.Logger.getInstance().error("scene not found : ",t)},SceneManager.prototype.resumeScene=function(t){var e=this.render.game.scene.getScene(t);e?e.scene.resume(t):o.Logger.getInstance().error("scene not found : ",t)},SceneManager.prototype.remove=function(t){this.render.game.scene.remove(t)},SceneManager.prototype.isActive=function(t){return!!this.render.game.scene.getScene(t)&&this.render.game.scene.getScene(t).scene.isActive()},SceneManager.prototype.destroy=function(){this.mCurSceneName&&(this.mCurSceneName=void 0),this.render&&this.render.hasOwnProperty(s.ModuleName.SCENEMANAGER_NAME)&&delete this.render[s.ModuleName.SCENEMANAGER_NAME],this.mMainScene=void 0},SceneManager.prototype.setMainScene=function(t){this.mMainScene=t},SceneManager.prototype.getMainScene=function(){return this.mMainScene},SceneManager.prototype.updateInput=function(t){this.render.game.scene.getScenes().map((function(e){return e.input.enabled=t!==a.Disable}))},SceneManager.prototype.sceneCallback=function(t){return Promise.resolve()},SceneManager}();!function(t){t[t.Disable=0]="Disable",t[t.Mouse=1]="Mouse",t[t.Keyboard=2]="Keyboard",t[t.All=3]="All"}(a||(a={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(2),a=function(){function DisplayMovement(t,e,i){this.scene=t,this.display=e,this.render=i}return DisplayMovement.prototype.destroy=function(){},DisplayMovement.prototype.doMove=function(t){var e=this;if(t.posPath){this.moveData=t;var i=t.tweenLineAnim;i&&(i.stop(),i.destroy());for(var n=[],a=0,s=0,o=t.posPath;s<o.length;s++){var h=o[s],l=h.duration,c=h.direction;n.push({x:h.x,y:h.y,direction:c,duration:l,onStartParams:c,onCompleteParams:{duration:l,index:a},onStart:function(t,i,n){e.onCheckDirection(n)},onComplete:function(t,i,n){e.onMovePathPointComplete(n)}}),a++}t.tweenLineAnim=this.scene.tweens.timeline({targets:this,ease:"Linear",tweens:n,onStart:function(){e.onMoveStart()},onComplete:function(){e.onMoveComplete()},onUpdate:function(){e.onMoving()},onCompleteParams:[this.display]})}},DisplayMovement.prototype.onCheckDirection=function(t){if("number"!=typeof t)return this.display.direction;n.Logger.getInstance().debug("dir:====",t),t!==this.display.displayInfo.avatarDir&&(this.display.direction=t,n.Logger.getInstance().debug("renderSetDirection:=====",t),this.render.setDirection(this.display.id,t))},DisplayMovement.prototype.onMovePathPointComplete=function(t){this.moveData&&(this.moveData.step+=1)},DisplayMovement.prototype.onMoveStart=function(){this.render.mainPeer.displayStartMove(this.display.id)},DisplayMovement.prototype.onMoveComplete=function(){this.moveData.tweenLineAnim&&this.moveData.tweenLineAnim.stop(),this.render.mainPeer.displayCompleteMove(this.display.id),this.stopMove()},DisplayMovement.prototype.onMoving=function(){var t=this.render.mainPeer.now();t-(this.moveData.tweenLastUpdate||0)>=50&&(this.display.setDepth(0),this.moveData.tweenLastUpdate=t),this.display.updateTopDisplay()},DisplayMovement.prototype.stopMove=function(){this.moveData&&this.moveData.posPath&&(delete this.moveData.posPath,this.moveData.arrivalTime&&(this.moveData.arrivalTime=0),this.moveData.tweenLineAnim&&(this.moveData.tweenLineAnim.stop(),this.moveData.tweenLineAnim.destroy())),this.render.mainPeer.displayStopMove(this.display.id)},DisplayMovement}()},function(t,e,i){"use strict";i(610)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(616),s=i(492),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function BubbleAnimation(e){return t.call(this,e)||this}return o(BubbleAnimation,t),BubbleAnimation.prototype.load=function(e,i,n){t.prototype.load.call(this,e,i,n),this.animUrlData=new s.a,e?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,n),this.scene.load.image(this.resName,this.animUrlData.pngUrl),this.scene.load.image(this.animUrlData.jsonUrl,this.animUrlData.jsonUrl),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},BubbleAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.frameAnim&&(this.setScale(.2,.2),this.y=50,this.scene.tweens.add({targets:this,y:{value:-100,duration:300,ease:"Bounce.easeOut"},scaleX:{value:1,duration:300,ease:"Bounce.easeOut"},scaleY:{value:1,duration:300,ease:"Bounce.easeOut"}}))},BubbleAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.frameAnim&&this.frameAnim.destroy(),this.bubblebg&&this.bubblebg.destroy(),this.frameAnim=null,this.bubblebg=null},BubbleAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.bubblebg=this.scene.add.image(0,0,this.resName),this.frameAnim=this.scene.add.image(0,0,this.animUrlData.jsonUrl),this.add([this.bubblebg,this.frameAnim]),this.isPlaying&&this.play()},BubbleAnimation}(a.a)},function(t,e,i){"use strict";var n,a=i(616),s=i(492),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});!function(t){function DragonbonesAnimation(e){return t.call(this,e)||this}o(DragonbonesAnimation,t),DragonbonesAnimation.prototype.load=function(e,i,n){t.prototype.load.call(this,e,i,n),this.animUrlData=new s.a,e?this.animUrlData.setData(this.resName,this.resUrl,!0,".dbbin"):this.animUrlData.setDisplayData(i,n),this.scene.load.dragonbone(this.resName,this.animUrlData.pngUrl,this.animUrlData.jsonUrl,this.animUrlData.boneUrl,this.animUrlData.textureXhrSettings,this.animUrlData.atlasXhrSettings,this.animUrlData.boneXhrSettings),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},DragonbonesAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.armatureDisplay&&this.armatureDisplay.animation.play(e)},DragonbonesAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.armatureDisplay&&this.armatureDisplay.destroy(),this.armatureDisplay=null},DragonbonesAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.armatureDisplay=this.scene.add.armature("mecha_1002_101d",this.resName),this.add(this.armatureDisplay),this.isPlaying&&this.play(this.curAniName)}}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,a=i(616),s=i(492),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),h=function(t){function FrameAnimation(e){return t.call(this,e)||this}return o(FrameAnimation,t),FrameAnimation.prototype.load=function(e,i,n,a){t.prototype.load.call(this,e,i,n),this.complHandler=a,this.animUrlData=new s.a,e?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,n),this.scene.load.atlas(this.resName,this.animUrlData.pngUrl,this.animUrlData.jsonUrl,this.animUrlData.textureXhrSettings,this.animUrlData.atlasXhrSettings),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},FrameAnimation.prototype.play=function(e){t.prototype.play.call(this,e),this.frameAnim&&this.frameAnim.play(this.curAniName)},FrameAnimation.prototype.destroy=function(){t.prototype.destroy.call(this),this.frameAnim&&this.frameAnim.destroy(),this.frameAnim=null,this.complHandler=void 0},FrameAnimation.prototype.onLoadComplete=function(t,e,i){this.loaded=!0,this.scene.anims.exists(this.curAniName)||this.scene.anims.create({key:this.curAniName,frames:this.scene.anims.generateFrameNames(this.resName),repeat:-1}),this.frameAnim||(this.frameAnim=this.scene.add.sprite(0,0,this.resName),this.add(this.frameAnim)),0===this.width?(this.setSize(this.frameAnim.width,this.frameAnim.height),this.scale=1):this.scale=this.width/this.frameAnim.displayWidth,this.isPlaying||this.play(this.curAniName),this.complHandler&&this.complHandler.run()},FrameAnimation}(a.a)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(1),a=i(2),s=function(){function AnimationModel(t){var e=t.baseLoc.split(",");this.mNode=t.node,this.id=t.node.id,this.name=t.node.name,this.frameName=t.frameName,!t.frameName||this.frameName.length,this.loop=t.loop,t.loop,t.frameRate,t.originPoint,t.baseLoc,this.frameRate=t.frameRate,this.baseLoc=new a.LogicPoint(parseInt(e[0],10),parseInt(e[1],10));var i=t.originPoint;this.originPoint=new a.LogicPoint(i[0],i[1]),"string"==typeof t.collisionArea?this.collisionArea=this.stringToArray(t.collisionArea,",","&")||[[0]]:this.collisionArea=t.collisionArea||[[0]],"string"==typeof t.walkableArea?this.walkableArea=this.stringToArray(t.walkableArea,",","&")||[[0]]:this.walkableArea=t.walkableArea||[[0]],this.interactiveArea=t.interactiveArea,this.changeLayer(t.layer),this.mountLayer=t.mountLayer}return AnimationModel.prototype.changeLayer=function(t){this.layer=t,this.layer.length<1&&(this.layer=[{frameName:this.frameName,offsetLoc:this.baseLoc}])},AnimationModel.prototype.createProtocolObject=function(){var t=n.op_gameconfig_01.AnimationData.create();t.node=this.mNode,t.baseLoc=this.baseLoc.x+","+this.baseLoc.y,t.node.name=this.name,t.loop=this.loop,t.frameRate=this.frameRate,t.frameName=this.frameName,t.originPoint=[this.originPoint.x,this.originPoint.y],t.walkOriginPoint=[this.originPoint.x,this.originPoint.y],t.walkableArea=this.arrayToString(this.walkableArea,",","&"),t.collisionArea=this.arrayToString(this.collisionArea,",","&"),t.interactiveArea=this.interactiveArea;for(var e=[],i=0,a=this.layer;i<a.length;i++){var s=a[i];e.push(n.op_gameconfig_01.AnimationLayer.create(s))}return t.layer=e,this.changeLayer(t.layer),t.mountLayer=this.mountLayer,t},AnimationModel.prototype.stringToArray=function(t,e,i){if(t){for(var n=[],a=0,s=t.split(i);a<s.length;a++){var o=s[a].split(e);n.push(o.map((function(t){return parseInt(t,10)})))}return n}},AnimationModel.prototype.arrayToString=function(t,e,i){if(!t)return"";for(var n=[],a=0,s=t;a<s.length;a++){var o=s[a];n.push(o.join(e))}return n.join(i)},AnimationModel}()},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,a=i(543),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),o=function(t){function UIDragonbonesDisplay(){var e=null!==t&&t.apply(this,arguments)||this;return e.mInteractive=!1,e.isBack=!1,e}return s(UIDragonbonesDisplay,t),UIDragonbonesDisplay.prototype.play=function(e){e.name=this.getAnimationName(e.name)+(this.isBack?"_back":""),t.prototype.play.call(this,e),this.mArmatureDisplay&&(this.mArmatureDisplay.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)&&this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),e.times>0&&this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this))},UIDragonbonesDisplay.prototype.setBack=function(t){this.isBack=t},UIDragonbonesDisplay.prototype.setCompleteHandler=function(t){this.mComplHandler=t},UIDragonbonesDisplay.prototype.setSuits=function(t){if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];if("weapon"===n.suit_type&&n.tag)return void(this.AniAction=JSON.parse(n.tag).action)}this.AniAction=void 0},UIDragonbonesDisplay.prototype.getAnimationName=function(t){if(this.AniAction){if("idle"===t)return this.AniAction[0];if("walk"===t)return this.AniAction[1]}return t},Object.defineProperty(UIDragonbonesDisplay.prototype,"back",{get:function(){return this.isBack},enumerable:!1,configurable:!0}),UIDragonbonesDisplay.prototype.onArmatureLoopComplete=function(t){if(this.mArmatureDisplay&&this.mAnimation){this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this);var e=this.mAnimation.playingQueue;if(e&&void 0!==e.name){var i={name:e.name,times:e.playTimes,flip:this.mAnimation.flip};this.play(i)}else this.mComplHandler&&this.mComplHandler.run()}},UIDragonbonesDisplay}(a.a)},function(t,e){},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(2),a=i(485),s=function(){function SortDebugger(t){this.render=t,this.isDebug=!1,this.RECT_COLOR=65280,SortDebugger._instance=this,this.mData=new Map,this.mGraphics=new Map}return SortDebugger.getInstance=function(){return SortDebugger._instance||n.Logger.getInstance().error("SortDebugger not created"),SortDebugger._instance},SortDebugger.prototype.q=function(){this.isDebug=!1,this.clear()},SortDebugger.prototype.v=function(){this.isDebug||this.redraw(),this.isDebug=!0},SortDebugger.prototype.clear=function(){this.mGraphics.forEach((function(t){t.destroy()})),this.mGraphics.clear()},SortDebugger.prototype.addDisplayObject=function(t,e,i,n,s){var h=this,l=new o(e,i,n,s);if(this.mData.set(t,l),this.isDebug){var c=this.render.sceneManager.getMainScene();c&&c instanceof a.d&&this.render.mainPeer.getCurrentRoomSize().then((function(e){h.mGraphics.get(t)&&h.mGraphics.get(t).destroy(),h.mGraphics.set(t,h.drawObj(c,h.RECT_COLOR,l,e))}))}},SortDebugger.prototype.redraw=function(){var t=this;this.clear();var e=this.render.sceneManager.getMainScene();e&&e instanceof a.d&&this.render.mainPeer.getCurrentRoomSize().then((function(i){t.mData.forEach((function(n,a){t.mGraphics.set(a,t.drawObj(e,t.RECT_COLOR,n,i))}))}))},SortDebugger.prototype.drawObj=function(t,e,i,a){n.Logger.getInstance().debug("#sort drawRect: ",i);var s=new n.LogicPos(i.x,i.y),o=new n.LogicPos(i.x+i.w,i.y),h=new n.LogicPos(i.x+i.w,i.y+i.h),l=new n.LogicPos(i.x,i.y+i.h),c=t.make.graphics(void 0,!1);return c.lineStyle(1,e),c.fillStyle(e,1),c.moveTo(s.x,s.y),c.lineTo(o.x,o.y),c.lineTo(h.x,h.y),c.lineTo(l.x,l.y),c.lineTo(s.x,s.y),c.fillPath(),t.layerManager.addToLayer("middleLayer",c),c},SortDebugger}(),o=function o(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(2),a=function(){function EditorModeDebugger(t){this.render=t,this.isDebug=!1,EditorModeDebugger._instance=this}return EditorModeDebugger.getInstance=function(){return EditorModeDebugger._instance||n.Logger.getInstance().error("SortDebugger not created"),EditorModeDebugger._instance},EditorModeDebugger.prototype.getIsDebug=function(){return this.isDebug},EditorModeDebugger.prototype.q=function(){this.isDebug&&this.render.mainPeer.elementsHideReferenceArea(),this.isDebug=!1},EditorModeDebugger.prototype.v=function(){this.isDebug||this.render.mainPeer.elementsShowReferenceArea(),this.isDebug=!0},EditorModeDebugger}()},function(t,e,i){"use strict";i(623),i(624),i(625)},function(t,e,i){"use strict";i.r(e),i.d(e,"BottomPanel",(function(){return u}));var n,a=i(479),s=i(6),o=i(0),h=i(2),l=i(21),c=i(497),p=i(480),d=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),u=function(t){function BottomPanel(e){var i=t.call(this,e)||this;return i.chatCatchArr=[],i.chatMaxLen=100,i.atlasNames=[l.d.uicommon,l.d.iconcommon],i.key=o.ModuleName.BOTTOM,i}return d(BottomPanel,t),BottomPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.initialized&&this.checkUpdateActive()},BottomPanel.prototype.resize=function(t,e){this.scale,this.scene.cameras.main.width;var i=this.scene.cameras.main.height;this.mInput.resize(),this.y=i,this.mNavigate.y=-this.mNavigate.height,this.mInput.y=this.mNavigate.y-this.mInput.height,this.updateOutputLayout()},BottomPanel.prototype.addListen=function(){this.mInput.on("enter",this.onSendMsgHandler,this),this.mInput.on("pointerScene",this.onPointerSceneHandler,this),this.resizeColtroll.addListen(),this.resizeColtroll.on("toggleSize",this.onToggleSizeHandler,this)},BottomPanel.prototype.removeListen=function(){this.mInput.on("enter",this.onSendMsgHandler,this),this.mInput.off("pointerScene",this.onPointerSceneHandler,this),this.resizeColtroll.removeListen(),this.resizeColtroll.off("toggleSize",this.onToggleSizeHandler,this)},BottomPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mOutput&&this.mOutput.appendChat(t)},BottomPanel.prototype.preload=function(){this.addAtlas(this.key,"bottom/bottom.png","bottom/bottom.json"),t.prototype.preload.call(this)},BottomPanel.prototype.showKeyboard=function(t,e){var i=this.cameraHeight/this.scale-e/this.scale;0!==i?(this.mInput.y=-i-this.mInput.height,this.updateOutputLayout()):this.hideKeyboard()},BottomPanel.prototype.hideKeyboard=function(){this.mInput.y=this.mNavigate.y-this.mInput.height,this.updateOutputLayout()},BottomPanel.prototype.getInputFocusing=function(){return this.mInput.getFocusing()},BottomPanel.prototype.init=function(){this.mOutput=new m(this.scene,this.dpr,this.scale),this.mInput=new f(this.scene,this.key,this.dpr),this.mNavigate=new c.PicaNewNavigatePanel(this.scene,this.key,this.dpr),this.mNavigate.setHandler(new h.Handler(this,this.onNavigateHandler)),this.resizeColtroll=new y(this.scene,this.key,this.dpr),this.add([this.mOutput,this.mInput,this.mNavigate,this.resizeColtroll]),this.resize(this.width,this.mOutput.height+this.mInput.height+this.mNavigate.height),t.prototype.init.call(this),this.onToggleSizeHandler(!1)},BottomPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(o.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var a=n[i];t.updateUIState(a)}}))},BottomPanel.prototype.sendChat=function(t){if(t){var e=this.mediator;e&&e.sendChat(t)}},BottomPanel.prototype.onSendMsgHandler=function(t){this.sendChat(t)},BottomPanel.prototype.onNavigateHandler=function(t,e){"bag"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICABAG_NAME):"friend"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAFRIEND_NAME):"avatar"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAAVATAR_NAME):"shop"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAMARKET_NAME):"explore"===t?this.render.renderEmitter(o.ModuleName.BOTTOM+"_showpanel",o.ModuleName.PICAEXPLORELIST_NAME):"home"===t&&this.render.renderEmitter(o.ModuleName.BOTTOM+"_gohome")},BottomPanel.prototype.onToggleSizeHandler=function(t){this.expanded=t,t?(this.mOutput.expand(),this.resizeColtroll.expand()):(this.mOutput.collapse(),this.resizeColtroll.collapse()),this.render.renderEmitter(o.EventType.CHAT_PANEL_EXTPAND,t),this.updateOutputLayout()},BottomPanel.prototype.onPointerSceneHandler=function(t){if(t&&t.length>0)for(var e=0,i=t;e<i.length;e++){if(i[e].parentContainer===this.resizeColtroll)return}this.mInput.blurInput()},BottomPanel.prototype.updateOutputLayout=function(){this.expanded?(this.mOutput.x=0,this.mOutput.y=this.mInput.y-1*this.dpr-this.mOutput.height,this.resizeColtroll.y=this.mOutput.y-.5*this.resizeColtroll.height,this.mOutput.expand()):(this.mOutput.x=this.resizeColtroll.width-1*this.dpr,this.mOutput.y=this.mInput.y-1*this.dpr-this.mOutput.height,this.resizeColtroll.y=this.mInput.y-1*this.dpr-.5*this.resizeColtroll.height,this.mOutput.collapse()),this.mOutput.updateLayout()},BottomPanel.prototype.onFocusHandler=function(){this.showKeyboard(window.document.documentElement.clientWidth*window.devicePixelRatio,window.document.documentElement.clientHeight*window.devicePixelRatio)},BottomPanel.prototype.onBlurHandler=function(){this.hideKeyboard()},Object.defineProperty(BottomPanel.prototype,"mediator",{get:function(){return this.render.mainPeer[this.key]},enumerable:!1,configurable:!0}),BottomPanel}(p.PicaBasePanel),m=function(t){function OutputContainer(e,i,n){var a=t.call(this,e)||this;a.dpr=i,a.scaleRatio=n,a.background=a.scene.make.graphics(void 0,!1),a.background.clear();var o=a.scene.cameras.main.width,l=a.scaleRatio;return a.mOutputText=new s.BBCodeText(a.scene,0,0,"",{fontSize:12*a.dpr+"px",fontFamily:h.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*a.dpr*l,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:o-12*a.dpr*l}}),a.mTextArea=new s.TextArea(a.scene,{x:.5*o+8*a.dpr*l,y:6*a.dpr,textWidth:o-4*a.dpr*l,textHeight:126*a.dpr*l,text:a.mOutputText}).layout(),a.updateLayout(),a.add([a.background,a.mTextArea,a.mOutputText]),a}return d(OutputContainer,t),OutputContainer.prototype.resize=function(t,e){this.setSize(t,e),this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t+1*this.dpr,e),this.mTextArea.childrenMap.child.setMinSize(t*this.scaleRatio,e*this.scaleRatio),this.mTextArea.layout(),this.mTextArea.setChildOY(4*this.dpr*this.scaleRatio),this.updateLayout(),this.mTextArea.childrenMap.text.y=4*this.dpr,this.mTextArea.scrollToBottom()},OutputContainer.prototype.expand=function(){this.resize(this.scene.cameras.main.width,125.33*this.dpr),this.mTextArea.setScrollerEnable(!0)},OutputContainer.prototype.collapse=function(){this.resize(296*this.dpr,40*this.dpr),this.mTextArea.setScrollerEnable(!1)},OutputContainer.prototype.updateLayout=function(){var t=this.getWorldTransformMatrix(this.getLocalTransformMatrix());this.mTextArea.setPosition(this.width*this.scaleRatio*.5+8*this.dpr,t.ty+.5*this.mTextArea.height),this.mTextArea.scrollToBottom()},OutputContainer.prototype.appendChat=function(t){this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},OutputContainer}(Phaser.GameObjects.Container),f=function(t){function InputContainer(e,i,n){var s=t.call(this,e)||this;s.dpr=n,s.mFocusing=!1,s.background=e.make.graphics(void 0,!1);var o=h.i18n.t("chat.placeholder");s.emoji=e.make.image({key:i,frame:"home_face"}),s.emoji.x=12.67*n+.5*s.emoji.width;var l=s.scene.cameras.main.width;return s.inputText=new a.LabelInput(s.scene,{width:l-46*s.dpr,height:16*s.dpr,placeholder:o,fontSize:11*s.dpr+"px",color:"#ffffff"}).setOrigin(0,.5).setAutoBlur(!1),s.add([s.background,s.emoji,s.inputText]),s.inputText.on("enter",s.onEnterHandler,s),s.inputText.on("blur",s.onInputBlurHandler,s),s.inputText.on("focus",s.onInputFocusHandler,s),s}return d(InputContainer,t),InputContainer.prototype.resize=function(){var t=this.scene.cameras.main.width;this.setSize(t,38.33*this.dpr),this.inputText.x=46*this.dpr,this.inputText.y=.5*this.height,this.inputText.setSize(this.inputText.width,this.height),this.emoji.y=.5*this.height,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,this.height),this.background.input=void 0,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t/this.scale,this.height/this.scale),Phaser.Geom.Rectangle.Contains)},InputContainer.prototype.setText=function(t){this.inputText.setText(t)},InputContainer.prototype.blurInput=function(){this.inputText.setBlur()},InputContainer.prototype.getFocusing=function(){return this.mFocusing},InputContainer.prototype.onEnterHandler=function(t){this.emit("enter",t),this.inputText.setText("")},InputContainer.prototype.onInputBlurHandler=function(){this.scene.input.off("pointerdown",this.onPointerSceneHandler,this),this.inputText.setBlur()},InputContainer.prototype.onInputFocusHandler=function(){this.scene.input.on("pointerdown",this.onPointerSceneHandler,this),this.mFocusing=!0},InputContainer.prototype.onPointerSceneHandler=function(t,e){this.emit("pointerScene",e),this.inputText.setBlur(),this.mFocusing=!1},InputContainer}(Phaser.GameObjects.Container),y=function(t){function ResizeControll(e,i,n){var a=t.call(this,e)||this;return a.dpr=n,a.expaned=!0,a.background=new s.Button(a.scene,i,"home_chat_pack_up_bg"),a.background.tweenEnable=!1,a.bubble=a.scene.make.image({key:i,frame:"home_chat"}),a.arrow=a.scene.make.image({key:i,frame:"home_unwind"}),a.setSize(a.background.width,a.background.height),a.bubble.x=.5*(-a.width+a.bubble.width)+12.67*n,a.arrow.x=.5*(-a.width+a.arrow.width)+43*n,a.add([a.background,a.bubble,a.arrow]),a.x=.5*a.background.width,a}return d(ResizeControll,t),ResizeControll.prototype.addListen=function(){this.background.on(s.ClickEvent.Tap,this.onToggleSizeHandler,this)},ResizeControll.prototype.removeListen=function(){this.background.off(s.ClickEvent.Tap,this.onToggleSizeHandler,this)},ResizeControll.prototype.expand=function(){this.background.setFrame("home_chat_unwind_bg"),this.arrow.scaleY=-1,this.expaned=!0,this.setSize(this.background.width,this.background.height)},ResizeControll.prototype.collapse=function(){this.background.setFrame("home_chat_pack_up_bg"),this.arrow.scaleY=1,this.expaned=!1,this.setSize(this.background.width,this.background.height)},ResizeControll.prototype.getExpaned=function(){return this.expaned},ResizeControll.prototype.onToggleSizeHandler=function(){this.expaned=!this.expaned,this.emit("toggleSize",this.expaned)},ResizeControll}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"ChatPanel",(function(){return c}));var n,a=i(479),s=i(6),o=i(0),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function ChatPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.chatCatchArr=[],i.chatMaxLen=100,i.scale=1,i.key=o.ModuleName.CHAT_NAME,i}return l(ChatPanel,t),ChatPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.initialized&&this.checkUpdateActive()},ChatPanel.prototype.resize=function(e,i){var n=this.scale,a=this.scene.cameras.main.width,s=this.scene.cameras.main.height;e=a,i=i||133*this.dpr,this.mInputPanel.resize(),this.setSize(a,i+this.mInputPanel.height),this.y=s-this.height-54*this.dpr,this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,a/this.scale,i/this.scale),this.mTextArea.childrenMap.child.setMinSize(e,(i-16*this.dpr)*n),this.mTextArea.layout(),this.mTextArea.setPosition(this.width/2+4*this.dpr,this.y+this.mTextArea.height/2+10*this.dpr*n),this.mTextArea.childrenMap.text.y=8*this.dpr,this.mTextArea.scrollToBottom(),t.prototype.resize.call(this,e,i),this.mBackground.input=void 0,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,a/this.scale,i/this.scale),Phaser.Geom.Rectangle.Contains)},ChatPanel.prototype.addListen=function(){this.mInputPanel.on("enter",this.onSendMsgHandler,this)},ChatPanel.prototype.removeListen=function(){this.mInputPanel.on("enter",this.onSendMsgHandler,this)},ChatPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},ChatPanel.prototype.init=function(){var e=this.scene.cameras.main.width;this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1);var i=this.scale;this.mOutputText=new s.BBCodeText(this.mScene,0,0,"",{fontSize:12*this.dpr/i+"px",fontFamily:h.Font.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr*i,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:e-12*this.dpr*i}}),this.mTextArea=new s.TextArea(this.mScene,{x:e/2+4*this.dpr*i,y:160*this.dpr*i,textWidth:e-4*this.dpr*i,textHeight:126*this.dpr*i,text:this.mOutputText}).layout(),this.mInputPanel=new p(this.scene,this.dpr),this.mInputPanel.y=134*this.dpr,this.add([this.mBackground,this.mTextArea,this.mOutputText,this.mInputPanel]),this.resize(this.width,133*this.dpr),t.prototype.init.call(this)},ChatPanel.prototype.checkUpdateActive=function(){var t=this;this.render.mainPeer.getActiveUIData(o.ModuleName.PICACHAT_NAME).then((function(e){if(e)for(var i=0,n=e;i<n.length;i++){var a=n[i];t.updateUIState(a)}}))},ChatPanel.prototype.sendChat=function(t){if(t){var e=this.mediator;e&&e.sendChat(t)}},ChatPanel.prototype.onSendMsgHandler=function(t){this.sendChat(t)},Object.defineProperty(ChatPanel.prototype,"mediator",{get:function(){return this.render.mainPeer[o.ModuleName.CHAT_NAME]},enumerable:!1,configurable:!0}),ChatPanel}(a.BasePanel),p=function(t){function InputPanle(e,i){var n=t.call(this,e)||this;n.dpr=i,n.background=e.make.graphics(void 0,!1);var s=h.i18n.t("chat.placeholder"),o=n.scene.cameras.main.width;return n.inputText=new a.LabelInput(n.scene,{width:o,height:16*n.dpr,placeholder:s,fontSize:11*n.dpr+"px",color:"#ffffff"}).setOrigin(0,.5),n.add([n.background,n.inputText]),n.inputText.on("enter",n.onEnterHandler,n),n}return l(InputPanle,t),InputPanle.prototype.resize=function(){var t=this.scene.cameras.main.width;this.setSize(t,38.33*this.dpr),this.inputText.x=46*this.dpr,this.inputText.y=.5*this.height,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,this.height),this.background.input=void 0,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t/this.scale,this.height/this.scale),Phaser.Geom.Rectangle.Contains)},InputPanle.prototype.onEnterHandler=function(){this.emit("enter",this.inputText.text),this.inputText.setBlur(),this.inputText.setText("")},InputPanle}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"GMToolsPanel",(function(){return c}));var n,a=i(6),s=i(21),o=i(479),h=i(0),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function GMToolsPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.key=h.ModuleName.GM_TOOLS_NAME,i}return l(GMToolsPanel,t),GMToolsPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&this.showButtons()},GMToolsPanel.prototype.update=function(e){t.prototype.update.call(this,e),this.mInitialized&&this.showButtons()},GMToolsPanel.prototype.addListen=function(){this.mInitialized&&(this.command.on("enter",this.onEnterCommandHandler,this),this.closeBtn.on(a.ClickEvent.Tap,this.onCloseHandler,this),this.commitBtn.on(a.ClickEvent.Tap,this.onCommitCmdHandler,this))},GMToolsPanel.prototype.removeListen=function(){this.mInitialized&&(this.command.off("enter",this.onEnterCommandHandler,this),this.closeBtn.off(a.ClickEvent.Tap,this.onCloseHandler,this),this.commitBtn.off(a.ClickEvent.Tap,this.onCommitCmdHandler,this))},GMToolsPanel.prototype.resize=function(){var t=this.scaleWidth,e=this.scaleHeight;this.setSize(this.scaleWidth,this.scaleHeight),this.closeBtn.x=.5*(t-this.closeBtn.width)-16*this.dpr,this.closeBtn.y=.5*-(e-this.closeBtn.height)+16*this.dpr,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,e),this.background.x=.5*-t,this.background.y=.5*-e,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t,e),Phaser.Geom.Rectangle.Contains),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.x=.5*this.cameraWidth,this.y=.5*this.cameraHeight,this.commitBtn.x=this.command.x+this.command.width+.5*this.commitBtn.width+16*this.dpr,this.commitBtn.y=this.command.y+.5*this.command.height,this.gridtable.setSize(this.width,e-110*this.dpr),this.gridtable.layout(),this.gridtable.resetMask()},GMToolsPanel.prototype.preload=function(){this.addAtlas(s.c.commonKey,s.d.commonUrl+".png",s.d.commonUrl+".json"),t.prototype.preload.call(this)},GMToolsPanel.prototype.init=function(){var e=this,i=this.scaleWidth,n=this.scaleHeight;this.setSize(i,n),this.background=this.scene.make.graphics(void 0,!1);var h=this.scale,l=i-30*this.dpr,c=46*this.dpr,d=null;this.scene.textures.exists("gmtools_btn")||((d=this.scene.make.graphics(void 0,!1)).fillStyle(36026),d.fillRoundedRect(0,0,l,c),d.generateTexture("gmtools_btn",l,c)),this.command=new o.LabelInput(this.scene,{width:this.width-110*this.dpr,height:16*this.dpr,placeholder:"输入命令",fontSize:14*this.dpr+"px",color:"#666666"}).setOrigin(0,0),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.command.createBackground(6*this.dpr,10*this.dpr),this.scene.textures.exists("gmtools_commit")||(d.clear(),d.fillStyle(699050),d.fillRoundedRect(0,0,50*this.dpr,30*this.dpr),d.generateTexture("gmtools_commit",50*this.dpr,30*this.dpr),d.destroy()),this.commitBtn=new a.Button(this.scene,"gmtools_commit","","","提交"),this.commitBtn.setTextStyle({fontSize:12*this.dpr});var u=54*this.dpr,m={x:0,y:60*this.dpr,table:{width:i,height:n-110*this.dpr,columns:1,cellWidth:i,cellHeight:u,reuseCellContainer:!0,zoom:h,cellPadX:0,cellPadY:10*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){var n=t.item;return null===i&&(i=new p(e.scene,91*e.dpr,46*e.dpr,e.dpr)).on("targetUI",e.onTargetUIHandler,e),i.setSize(t.width,t.height),i.setData({item:n}),i.setItemData(n),i}};this.gridtable=new a.GameGridTable(this.scene,m),this.gridtable.on("cellTap",(function(t){if(t){var i=t.item;i&&i.node&&e.onTargetUIHandler(i.node.id)}})),this.closeBtn=new a.Button(this.scene,s.c.commonKey,"close"),this.add([this.background,this.gridtable,this.closeBtn,this.command,this.commitBtn]),t.prototype.init.call(this),this.resize()},GMToolsPanel.prototype.showButtons=function(){if(this.mShowData){var t=this.showData,e=t.button;e.length>=1&&this.gridtable.setItems(e);var i=t.inputText;i&&i.length>0&&this.command.setData({item:i[0]})}},GMToolsPanel.prototype.onTargetUIHandler=function(t){!this.mShowData||this.mShowData.length<1||(this.emit("targetUI",this.mShowData.id,t),this.render.renderEmitter(this.key+"_targetUI",{id:this.mShowData.id,componentId:t}),this.command.setBlur())},GMToolsPanel.prototype.onCloseHandler=function(){this.render.renderEmitter(this.key+"_close")},GMToolsPanel.prototype.onCommitCmdHandler=function(){if(this.command.setBlur(),this.mShowData&&!(this.mShowData.length<1)){var t=this.command.text;if(t){var e=this.command.getData("item");e&&e.node&&this.render.renderEmitter(this.key+"_targetUI",{id:this.mShowData.id,componentId:e.node.id,text:t})}}},GMToolsPanel.prototype.onEnterCommandHandler=function(){this.onCommitCmdHandler()},GMToolsPanel}(o.BasePanel),p=function(t){function Item(e,i,n,s){var o=t.call(this,e)||this;return o.btn=new a.Button(o.scene,"gmtools_btn","","","1"),o.btn.on(String(a.ClickEvent.Tap),o.onBtnHandler,o),o.btn.setTextStyle({fontSize:12*s}),o.btn.removeInteractive(),o.add(o.btn),o}return l(Item,t),Item.prototype.setItemData=function(t){this.item=t,this.btn.setText(t.text)},Item.prototype.onBtnHandler=function(){this.item&&this.emit("targetUI",this.item.id)},Item}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaDecoratePanel",(function(){return c}));var n,a=i(6),s=i(479),o=i(0),h=i(2),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),c=function(t){function PicaDecoratePanel(e){var i=t.call(this,e.render.sceneManager.getMainScene(),e.render)||this;return i.resKey="decorate",i.minGrid=2,i.maxGrid=10,i.offset=new h.LogicPos,i.mScaleRatio=1,i.key=o.ModuleName.PICADECORATE_NAME,i.mScaleRatio=e.render.scaleRatio,i}return l(PicaDecoratePanel,t),PicaDecoratePanel.prototype.show=function(t){this.mShowData=t,this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.scene.layerManager.addToLayer("sceneUILayer",this)):this.preload()},PicaDecoratePanel.prototype.addListen=function(){this.mCancelBtn&&this.mCancelBtn.on(a.ClickEvent.Tap,this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.on(a.ClickEvent.Tap,this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.on(a.ClickEvent.Tap,this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.on(a.ClickEvent.Tap,this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.on(a.ClickEvent.Tap,this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.on(a.ClickEvent.Tap,this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.on(a.ClickEvent.Tap,this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.register(),this.mMoveMenuContainer.on(a.ClickEvent.Tap,this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.register(),this.mRepeatMenuContainer.on(a.ClickEvent.Tap,this.onRepeatHandler,this),this.mRepeatMenuContainer.on(a.ClickEvent.Hold,this.onHoldRepeatHandler,this))},PicaDecoratePanel.prototype.removeListen=function(){this.mCancelBtn&&this.mCancelBtn.off(a.ClickEvent.Tap,this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.off(a.ClickEvent.Tap,this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.off(a.ClickEvent.Tap,this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.off(a.ClickEvent.Tap,this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.off(a.ClickEvent.Tap,this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.off(a.ClickEvent.Tap,this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.off(a.ClickEvent.Tap,this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.unRegister(),this.mMoveMenuContainer.off(a.ClickEvent.Tap,this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.unRegister(),this.mRepeatMenuContainer.off(a.ClickEvent.Tap,this.onRepeatHandler,this),this.mRepeatMenuContainer.off(a.ClickEvent.Hold,this.onHoldRepeatHandler,this))},PicaDecoratePanel.prototype.setElement=function(t){this.mDisplayObject=this.render.displayManager.getDisplay(t),this.mInitialized&&(this.mDisplayObject&&this.setPos(this.mDisplayObject.x,this.mDisplayObject.y),this.addListen())},PicaDecoratePanel.prototype.canPut=function(t){if(t!==this.mCanPut){if(this.mCanPut=t,!this.mOkBtn)return;this.mOkBtn.enable=t}},PicaDecoratePanel.prototype.setPos=function(t,e,i){this.x=t*this.mScaleRatio,this.y=(e+this.offset.y)*this.mScaleRatio,this.z=i||0},PicaDecoratePanel.prototype.setOffset=function(t,e){this.offset.x=t,this.offset.y=e,this.mDisplayObject&&this.setPos(this.mDisplayObject.x,this.mDisplayObject.y)},PicaDecoratePanel.prototype.destroy=function(){this.mRepeatMenuContainer&&this.mRepeatMenuContainer.destroy(),this.mMoveMenuContainer&&this.mMoveMenuContainer.destroy(),t.prototype.destroy.call(this)},PicaDecoratePanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_edit_menu/decorate_edit_menu.png","decorate_edit_menu/decorate_edit_menu.json"),t.prototype.preload.call(this)},PicaDecoratePanel.prototype.init=function(){var e=this.scene.cameras.main.width/this.scale;this.scene.cameras.main.height,this.scale;this.mMainMenus=[],this.mMenuContainer=this.scene.make.container({x:e>>1},!1),this.mSubMenus=this.scene.make.container({x:e>>1,y:60*this.dpr},!1),this.mOkBtn=new a.Button(this.scene,this.key,"ok_btn.png"),this.mRecycleBtn=new a.Button(this.scene,this.key,"recycly_btn.png"),this.mTurnBtn=new a.Button(this.scene,this.key,"turn_btn.png"),this.mCancelBtn=new a.Button(this.scene,this.key,"cancel_btn.png"),this.mMenuContainer.y=.5*this.mOkBtn.height,this.mSubMenus.y=this.mMenuContainer.y+60*this.dpr,this.mHorizontalBtn=new a.Button(this.scene,this.key,"horizontal_btn.png"),this.mMoveBtn=new a.Button(this.scene,this.key,"move_btn.png"),this.mRepeatBtn=new a.Button(this.scene,this.key,"repeat_btn.png"),this.mExtendBtn=new a.Button(this.scene,this.key,"extend_btn.png"),this.mMoveMenuContainer=new p(this.scene,this.key,this.dpr,this.scale),this.mMoveMenuContainer.y=this.mSubMenus.y+15*this.dpr+this.mMoveMenuContainer.height,this.mRepeatMenuContainer=new p(this.scene,this.key,this.dpr,this.scale),this.mRepeatMenuContainer.y=this.mMoveMenuContainer.y;var i=this.scale;this.add([this.mMenuContainer,this.mSubMenus]),this.mMenuContainer.add([this.mOkBtn,this.mTurnBtn,this.mRecycleBtn,this.mCancelBtn]),this.mSubMenus.add([this.mHorizontalBtn,this.mMoveBtn,this.mRepeatBtn,this.mExtendBtn]);var n=e-55*this.dpr*this.mWorld.uiScale*2;this.mMenuContainer.x=-n>>1;var s=this.mMenuContainer.list;s.map((function(t){return n-=t.width}));for(var o=n/(s.length-1)/i,h=1;h<s.length;h++){var l=s[h-1];s[h].x=l.width+l.x+o}n=e-70*this.dpr*this.mWorld.uiScale*2,this.mSubMenus.x=-n>>1;var c=this.mSubMenus.list;c.map((function(t){return n-=t.width})),o=n/(c.length-1)/i;for(h=1;h<c.length;h++){l=c[h-1];c[h].x=l.width+l.x+o}this.mMoveMenuContainer.x=this.mSubMenus.x+this.mMoveBtn.x+29*this.dpr,this.mRepeatMenuContainer.x=this.mSubMenus.x+this.mRepeatBtn.x+29*this.dpr,this.mOkBtn.enable=this.mCanPut,t.prototype.init.call(this),this.mDisplayObject&&this.setElement(this.mDisplayObject)},PicaDecoratePanel.prototype.onTurnHandler=function(){var t=this.mediator;t&&t.turn()},PicaDecoratePanel.prototype.onRecycleHandler=function(){var t=this.mediator;t&&t.recycle()},PicaDecoratePanel.prototype.onCancelHandler=function(){var t=this.mediator;t&&t.cancel()},PicaDecoratePanel.prototype.onAddHandler=function(){if(this.mCanPut){var t=this.mediator;t&&t.putElement()}},PicaDecoratePanel.prototype.onMoveHandler=function(t){if("number"==typeof t){var e=this.mediator;e&&e.moveDir(t)}},PicaDecoratePanel.prototype.onRepeatHandler=function(t){var e=this.mediator;e&&e.repeatAdd(t,2)},PicaDecoratePanel.prototype.onHoldRepeatHandler=function(t){var e=this.mediator;e&&e.repeatAdd(t,10)},PicaDecoratePanel.prototype.onShowMoveMenuHandler=function(){this.add(this.mMoveMenuContainer),this.remove(this.mRepeatMenuContainer)},PicaDecoratePanel.prototype.onShowRepeatHandler=function(){this.add(this.mRepeatMenuContainer),this.remove(this.mMoveMenuContainer)},PicaDecoratePanel.prototype.onShowExtendsHandler=function(){},Object.defineProperty(PicaDecoratePanel.prototype,"mediator",{get:function(){return this.render.mainPeer[o.ModuleName.PICADECORATE_NAME]},enumerable:!1,configurable:!0}),PicaDecoratePanel}(s.BasePanel),p=function(t){function MoveMenu(e,i,n,s){void 0===n&&(n=1),void 0===s&&(s=1);var o=t.call(this,e)||this,l=e.make.image({key:i,frame:"bg.png"},!1);o.setSize(l.displayWidth,l.displayHeight),o.mArrow1=new a.Button(o.scene,i,"arrow_1.png"),o.mArrow1.setData("dir",h.Direction.north_west),o.mArrow3=new a.Button(o.scene,i,"arrow_3.png"),o.mArrow3.setData("dir",h.Direction.west_south),o.mArrow5=new a.Button(o.scene,i,"arrow_5.png"),o.mArrow5.setData("dir",h.Direction.south_east),o.mArrow7=new a.Button(o.scene,i,"arrow_7.png"),o.mArrow7.setData("dir",h.Direction.east_north),o.mBtns=[o.mArrow1,o.mArrow3,o.mArrow5,o.mArrow7],o.add(l),o.add(o.mBtns);o.width;var c=o.width-20*n;o.mBtns.map((function(t){return c-=t.displayWidth}));for(var p=c/=o.mBtns.length-1,d=3*n,u=0;u<o.mBtns.length;u++)o.mBtns[u].x=0===u?10*n+o.mBtns[u].width/2-o.width/2:p+o.mBtns[u-1].x+o.mBtns[u-1].width,o.mBtns[u].y=d;return o.setInteractive(),o}return l(MoveMenu,t),MoveMenu.prototype.register=function(){this.mArrow1.on(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow1.on(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow3.on(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow3.on(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow5.on(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow5.on(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow7.on(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow7.on(a.ClickEvent.Tap,this.onClickHandler,this)},MoveMenu.prototype.unRegister=function(){this.mArrow1.off(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow1.off(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow3.off(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow3.off(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow5.off(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow5.off(a.ClickEvent.Tap,this.onClickHandler,this),this.mArrow7.off(a.ClickEvent.Hold,this.onHoldHandler,this),this.mArrow7.off(a.ClickEvent.Tap,this.onClickHandler,this)},MoveMenu.prototype.onHoldHandler=function(t){this.emit(a.ClickEvent.Hold,t.getData("dir"))},MoveMenu.prototype.onClickHandler=function(t,e){this.emit(a.ClickEvent.Tap,e.getData("dir"))},MoveMenu}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaNewOldMainPanel",(function(){return p}));var n,a=i(6),s=i(21),o=i(479),h=i(0),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},p=function(t){function PicaNewOldMainPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.isSceneNameActive=!1,i.key=h.ModuleName.PICAMAINUI_NAME,i}return c(PicaNewOldMainPanel,t),PicaNewOldMainPanel.prototype.show=function(e){t.prototype.show.call(this,e),this.mInitialized&&(this.setInteractive(),this.update(this.mShowData),this.checkUpdateActive())},PicaNewOldMainPanel.prototype.resize=function(e,i){var n=this.scene.cameras.main.width/this.scale,a=this.scene.cameras.main.height/this.scale;t.prototype.resize.call(this,n,a),this.mCoinValue.x=n-this.mCoinValue.width/2-5*this.dpr,this.mDiamondValue.x=n-this.mDiamondValue.width/2-5*this.dpr},PicaNewOldMainPanel.prototype.preload=function(){this.addAtlas(this.key,"main_ui/mainui.png","main_ui/mainui.json"),this.addAtlas(s.c.commonKey,s.d.commonUrl+".png",s.d.commonUrl+".json"),t.prototype.preload.call(this)},PicaNewOldMainPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.on("pointerup",this.onOpenRoomPanel,this),this.render.emitter.on(h.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.on(h.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.on(h.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):l.Logger.getInstance().fatal(PicaNewOldMainPanel.name+": sceneName does not exist!"))},PicaNewOldMainPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.roomCon?(this.roomCon.off("pointerup",this.onOpenRoomPanel,this),this.render.emitter.off(h.EventType.UPDATE_ROOM_INFO,this.onUpdateRoomHandler,this),this.render.emitter.off(h.EventType.UPDATE_PLAYER_INFO,this.onUpdatePlayerHandler,this),this.render.emitter.off(h.EventType.UPDATE_PARTY_STATE,this.onUpdatePartyHandler,this)):l.Logger.getInstance().fatal(PicaNewOldMainPanel.name+": sceneName does not exist!"))},PicaNewOldMainPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.playerInfo=void 0,this.roomInfo=void 0},PicaNewOldMainPanel.prototype.update=function(e){t.prototype.update.call(this),e&&(e.hasOwnProperty("roomId")?this.roomInfo=e:this.playerInfo=e),this.playerInfo&&this.updatePlayerInfo(this.playerInfo),this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaNewOldMainPanel.prototype.updatePlayerInfo=function(t){if(this.playerInfo=t,this.mInitialized){if(t.level){var e=t.level;this.playerLv.text=e.level+""}if(void 0!==t.coin&&this.mCoinValue.setText(this.getCoin().value+""||"0"),void 0!==t.diamond&&this.mDiamondValue.setText(this.getDiamond().value+""||"0"),t.energy){var i=t.energy;i?this.mStrengthValue.setValue(i.currentValue,i.max):this.mStrengthValue.setValue(0,100)}this.mSceneName.rightIcon.visible=this.isSelfRoom}},PicaNewOldMainPanel.prototype.getCoin=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000001"===i.id)return i}else l.Logger.getInstance().error(i.key+"  缺少ID")}},PicaNewOldMainPanel.prototype.getDiamond=function(){for(var t=0,e=this.playerInfo.properties;t<e.length;t++){var i=e[t];if(i.hasOwnProperty("id")){if("IV0000002"===i.id)return i}else l.Logger.getInstance().error(i.key+"  缺少ID")}},PicaNewOldMainPanel.prototype.updateRoomInfo=function(t){this.roomInfo=t,this.mInitialized&&(this.roomCon.setSize(60*this.dpr,30*this.dpr),t.name&&(this.mSceneName.setText(t.name),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr)),this.roomCon.setInteractive(),this.isSceneNameActive=!0,t.playerCount&&this.mCounter.setText(""+t.playerCount),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.praiseBtn.visible=!1,t.roomType&&("room"!==t.roomType&&"store"!==t.roomType||(this.praiseBtn.visible=!0),this.praiseBtn.setText(t.praise+""),this.praiseBtn.selected=t.hasPraised,t.hasPraised?(this.praiseBtn.setTextColor("#8E99C1"),this.praiseImg.setFrame("praise_after")):(this.praiseBtn.setTextColor("#ffffff"),this.praiseImg.setFrame("praise_before"))),this.mSceneName.rightIcon.visible=this.isSelfRoom,this.partyBtn.visible=this.isSelfRoom,t.openingParty?this.partyBtn.setText(l.i18n.t("common.manager")):this.partyBtn.setText(l.i18n.t("main_ui.party")))},Object.defineProperty(PicaNewOldMainPanel.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,e=this.roomInfo.roomId,i=0,n=t;i<n.length;i++){if(n[i].roomId===e)return!0}return!1},enumerable:!1,configurable:!0}),PicaNewOldMainPanel.prototype.updateUIState=function(t){this.mInitialized&&("mainui.playerinfo"===t.name&&(this.playerCon.visible=t.visible),"mainui.roominfo"===t.name&&(this.roomCon.visible=t.visible),"mainui.headbtn"===t.name&&(t.disabled?this.playerIcon.removeInteractive():this.playerIcon.setInteractive()),"mainui.entereditorbtn"===t.name&&(this.mSceneName.visible=t.visible,this.isSceneNameActive&&(t.disabled?this.roomCon.removeInteractive():(this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive()))))},PicaNewOldMainPanel.prototype.init=function(){var e=this.scene.cameras.main.width,i=this.scene.cameras.main.height;this.playerCon=this.scene.make.container(void 0,!1),this.playerCon.y=25*this.dpr,this.add(this.playerCon),this.mCoinValue=new d(this.scene,this.key,"coin",this.dpr),this.mDiamondValue=new d(this.scene,this.key,"diamond",this.dpr),this.mDiamondValue.setHandler(new l.Handler(this,this.onOpenRechargeHandler)),this.mDiamondValue.y=35*this.dpr;var n=this.scene.textures.getFrame(this.key,"strength_progress");this.mStrengthValue=new f(this.scene,this.key,"strength_icon",this.dpr),this.mStrengthValue.x=76*this.dpr;var h=new a.NineSlicePatch(this.scene,68*this.dpr/2,this.mStrengthValue.height/2-n.height-1*this.dpr,92*this.dpr,n.height,this.key,"strength_progress",{left:8*this.dpr,top:3*this.dpr,right:n.width-2-8*this.dpr,bottom:n.height-1-3*this.dpr});this.mStrengthValue.setProgress(h,this.scale),this.playerIcon=this.scene.make.image({key:this.key,frame:"head"}),this.playerIcon.x=.5*-this.mStrengthValue.width-8*this.dpr,this.mStrengthValue.add(this.playerIcon),this.playerIcon.on("pointerup",this.onHeadHandler,this),this.playerIcon.setInteractive(),this.mStrengthValue.setValue(1e3,1e3),this.mStrengthValue.setInteractive(),this.mStrengthValue.on("pointerup",this.onStrengthHandler,this);var c=this.playerIcon.x+.5*this.playerIcon.width-2*this.dpr,p=this.playerIcon.y+.5*this.playerIcon.height-10*this.dpr;this.playerLv=this.scene.make.text({text:"0",x:c,y:p,style:{fontSize:11*this.dpr,bold:!0,fontFamily:l.Font.DEFULT_FONT,color:"#356EE3"}},!1).setOrigin(1,0),this.playerLv.setShadow(0,0,"#ffffff",2),this.playerLv.setStroke("#356EE3",2),this.playerLv.setShadowStroke(!0),this.mStrengthValue.add(this.playerLv),this.playerCon.add([this.mStrengthValue,this.mCoinValue,this.mDiamondValue]),this.roomCon=this.scene.make.container(void 0,!1),this.roomCon.y=this.playerCon.y+32*this.dpr,this.add(this.roomCon),this.mSceneName=new m(this.scene,this.key,"room_icon","setting_icon",this.dpr),this.mSceneName.setText(""),this.mSceneName.x=18*this.dpr,this.mCounter=new u(this.scene,s.c.commonKey,"home_persons",this.dpr),this.mCounter.setText(""),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.mCounter.y=this.mSceneName.y,this.mCounter.setColor("#28D5F5"),this.textToolTip=new o.TextToolTips(this.scene,s.c.commonKey,"tips_bg",this.dpr,this.scale),this.textToolTip.setSize(160*this.dpr,45).visible=!1,this.praiseBtn=new a.CheckBox(this.scene,this.key,"praise_before_bg","praise_after_bg","1"),this.praiseBtn.y=this.mSceneName.y+this.mSceneName.height+.5*this.praiseBtn.height+20*this.dpr,this.praiseBtn.x=8*this.dpr+.5*this.praiseBtn.width,this.praiseBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.praiseBtn.setTextOffset(10*this.dpr,0),this.praiseBtn.on(String(a.ClickEvent.Tap),this.onPraiseHandler,this),this.praiseImg=this.scene.make.image({key:this.key,frame:"praise_before"}),this.praiseImg.x=-10*this.dpr,this.praiseBtn.add(this.praiseImg),this.partyBtn=new a.Button(this.scene,this.key,"home_party_bg","home_party_bg",l.i18n.t("main_ui.party")),this.partyBtn.x=this.praiseBtn.x+.5*this.praiseBtn.width+.5*this.partyBtn.width+5*this.dpr,this.partyBtn.y=this.praiseBtn.y,this.partyBtn.setTextOffset(8*this.dpr,0),this.partyBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.partyBtn.on(String(a.ClickEvent.Tap),this.onPartyHandler,this),this.roomCon.add([this.mSceneName,this.mCounter,this.praiseBtn,this.partyBtn,this.textToolTip]),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.resize(e,i),t.prototype.init.call(this)},PicaNewOldMainPanel.prototype.onOpenRoomPanel=function(){this.render.renderEmitter("openroompanel")},PicaNewOldMainPanel.prototype.onHeadHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.CHARACTERINFO_NAME)},PicaNewOldMainPanel.prototype.onStrengthHandler=function(){var t=this;if(this.playerInfo){var e=this.playerInfo.energy,i=e.currentValue+"/"+e.max+"\n",n=l.i18n.t("main_ui.energy_tips",{name:i,interpolation:{escapeValue:!1}});this.textToolTip.visible||this.scene.input.on("pointerdown",this.onTextToolTipHandler,this),this.textToolTip.setDelayText(n,3e3,new l.Handler(this,(function(){t.scene.input.off("pointerdown",t.onTextToolTipHandler,t)}))),this.textToolTip.setPosition(120*this.dpr,20*this.dpr)}},PicaNewOldMainPanel.prototype.onTextToolTipHandler=function(){this.textToolTip.visible=!1,this.scene.input.off("pointerdown",this.onTextToolTipHandler,this)},PicaNewOldMainPanel.prototype.checkUpdateActive=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,i,n;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.mWorld.mainPeer.getActiveUIData("PicaMainUI")];case 1:if(t=a.sent())for(e=0,i=t;e<i.length;e++)n=i[e],this.updateUIState(n);return[2]}}))}))},PicaNewOldMainPanel.prototype.onUpdatePlayerHandler=function(t){this.playerInfo=t,this.updatePlayerInfo(t)},PicaNewOldMainPanel.prototype.onUpdateRoomHandler=function(t){this.roomInfo=t,this.updateRoomInfo(t)},PicaNewOldMainPanel.prototype.onUpdatePartyHandler=function(t){this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaNewOldMainPanel.prototype.onPraiseHandler=function(t,e){this.render.renderEmitter(h.EventType.QUERY_PRAISE,e.selected)},PicaNewOldMainPanel.prototype.onPartyHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.PICAOPENPARTY_NAME)},PicaNewOldMainPanel.prototype.onOpenRechargeHandler=function(){this.render.renderEmitter("showPanel",h.ModuleName.PICARECHARGE_NAME)},PicaNewOldMainPanel}(o.BasePanel),d=function(t){function ValueContainer(e,i,n,a){void 0===a&&(a=1);var s=t.call(this,e)||this;return s.init(i,n,a),s}return c(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.setHandler=function(t){this.sendHandler=t},ValueContainer.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:14*i,fontFamily:l.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new a.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=.5*-n.width+5*i,this.mLeft.y=n.y+.5*n.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*i,this.mText.x=4*i,this.add([n,this.mLeft,this.mText,this.mAddBtn]),this.mAddBtn.on(a.ClickEvent.Tap,this.onAddHandler,this)},ValueContainer.prototype.onAddHandler=function(){this.sendHandler&&this.sendHandler.run()},ValueContainer}(Phaser.GameObjects.Container),u=function(t){function IconText(e,i,n,a){void 0===a&&(a=1);var s=t.call(this,e)||this,o=e.make.image({key:i,frame:n},!1);return s.mText=e.make.text({style:{fontSize:14*a,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,.5),s.mText.x=o.width/2+4*a,s.mText.setStroke("#000000",2*a),s.add([o,s.mText]),s}return c(IconText,t),IconText.prototype.setText=function(t){this.mText.setText(t)},IconText.prototype.setStroke=function(t,e){this.mText.setStroke(t,e)},IconText.prototype.setColor=function(t){this.mText.setColor(t)},IconText}(Phaser.GameObjects.Container),m=function(t){function SceneName(e,i,n,a,s){void 0===s&&(s=1);var o=t.call(this,e,i,n,s)||this;return o.mDpr=s,o.mRightIcon=e.make.image({y:2*s,key:i,frame:a},!1),o.add(o.mRightIcon),o.mRightIcon.y=8*s,o.mRightIcon.x=10*s,o}return c(SceneName,t),SceneName.prototype.setText=function(e){t.prototype.setText.call(this,e)},Object.defineProperty(SceneName.prototype,"rightbound",{get:function(){return this.mText.x+this.mText.width+10*this.mDpr},enumerable:!1,configurable:!0}),Object.defineProperty(SceneName.prototype,"rightIcon",{get:function(){return this.mRightIcon},enumerable:!1,configurable:!0}),SceneName}(u),f=(function(t){function ExpProgress(e,i,n,s,o){var h=t.call(this,e)||this,c=o.getSize().width/s,p=h.scene.textures.getFrame(i,"exp_bg");h.setSize(c,p.height);var d=h.width,u=h.height;h.mProgressBar=new y(e,n),h.mProgressBar.setSize(h.width,h.height);var m=new a.NineSlicePatch(h.scene,d/2,u/2,d,u,i,"exp_bg",{left:8*n,top:3*n,right:p.width-2-8*n,bottom:p.height-1-3*n});h.mProgressBar.setBackground(m),p=h.scene.textures.getFrame(i,"exp_progress");var f=new a.NineSlicePatch(h.scene,d/2,u/2,c,p.height,i,"exp_progress",{left:8*n,top:3*n,right:p.width-2-10*n,bottom:p.height-1-5*n});return h.mProgressBar.setProgress(f,s),h.mProgressBar.setRatio(.5),h.mCurrentLv=e.make.text({text:"57",style:{fontSize:10*n,fontFamily:l.Font.DEFULT_FONT}},!1),h.mCurrentLv.setStroke("#000000",1*n),h.mNextLv=e.make.text({text:"58",style:{fontSize:10*n,fontFamily:l.Font.DEFULT_FONT}},!1).setOrigin(0,0),h.mNextLv.setStroke("#000000",1*n),h.mNextLv.x=h.width-h.mNextLv.width,h.add([h.mProgressBar,h.mCurrentLv,h.mNextLv]),h}c(ExpProgress,t),ExpProgress.prototype.setLv=function(t,e){this.mCurrentLv.setText(t.toString()),this.mNextLv.setText((t+1).toString()),this.mNextLv.x=this.width-this.mNextLv.width,this.mProgressBar.setRatio(e)}}(Phaser.GameObjects.Container),function(t){function ProgressValue(e,i,n,a){return t.call(this,e,i,n,a)||this}return c(ProgressValue,t),ProgressValue.prototype.setProgress=function(t,e){this.mProgress.setProgress(t,e)},ProgressValue.prototype.setValue=function(t,e){this.mText&&(this.mText.text=t+"/"+e,this.mProgress.setRatio(t/e))},ProgressValue.prototype.setInteractive=function(e){return e=e||new Phaser.Geom.Rectangle(0,0,this.width,this.height),t.prototype.setInteractive.call(this,e,Phaser.Geom.Rectangle.Contains),this},ProgressValue.prototype.init=function(t,e,i){var n=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);n.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.setSize(n.width,n.height),this.mLeft=this.scene.make.image({key:t,frame:e},!1),this.mLeft.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mProgress=new y(this.scene,i),this.mProgress.x=-this.width/2+10*i,this.mProgress.y=4*i,this.mText=this.scene.make.text({text:"0",width:n.width,height:n.height,style:{fontSize:10*i,fontFamily:l.Font.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*i),this.mText.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mAddBtn=new a.Button(this.scene,t,"add_btn","add_btn"),this.setSize(n.width,n.height),this.mLeft.x=-this.width*this.originX+13*i,this.mAddBtn.x=this.width*this.originX-10*i,this.add([n,this.mProgress,this.mLeft,this.mText,this.mAddBtn])},ProgressValue}(d)),y=function(t){function ProgressBar(e,i){var n=t.call(this,e)||this;return n.dpr=i,n}return c(ProgressBar,t),ProgressBar.prototype.setBackground=function(t){this.addAt(t,0)},ProgressBar.prototype.setProgress=function(t,e){this.mScale=e,this.mProgress=t,this.add(this.mProgress),this.setSize(t.width*this.mScale,t.height*this.mScale);var i=t.getWorldTransformMatrix();this.worldpos=new Phaser.Geom.Point(i.tx,i.ty),this.mMaskGraphics=this.scene.make.graphics(void 0,!1),this.mMaskGraphics.fillStyle(16750848),this.mMaskGraphics.fillRect(0,0,this.width,this.height+8*this.dpr),this.mProgress.mask=new Phaser.Display.Masks.GeometryMask(this.scene,this.mMaskGraphics),this.mMaskGraphics.y=i.ty+this.height+4*this.dpr,this.mMaskGraphics.x=i.tx},ProgressBar.prototype.setRatio=function(t){this.mMaskGraphics&&(this.mMaskGraphics.x=this.worldpos.x+4*this.dpr-.5*this.mProgress.width+(this.width*t-this.width))},ProgressBar}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaOrderPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(0),h=i(21),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),__awaiter=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var i,n,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function verb(s){return function(h){return function step(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},p=function(t){function PicaOrderPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.uiManager=e,i.key=o.ModuleName.PICAORDER_NAME,i}return c(PicaOrderPanel,t),PicaOrderPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,n,a),this.content.x=.5*n,this.content.y=.5*a+10*this.dpr,this.mGameGrid.resetMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,n,a),Phaser.Geom.Rectangle.Contains)},PicaOrderPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicaOrderPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaOrderPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaOrderPanel.prototype.preload=function(){this.addAtlas(this.key,"order/order.png","order/order.json"),this.addAtlas(h.c.commonKey,h.d.commonUrl+".png",h.d.commonUrl+".json"),this.addAtlas(h.c.common2Key,h.d.common2Url+".png",h.d.common2Url+".json"),l.Logger.getInstance().debug("=====>> dpr",this.dpr),t.prototype.preload.call(this)},PicaOrderPanel.prototype.init=function(){var e=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var i=295*this.dpr,n=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,n),this.add(this.content),this.bg=new a.NineSlicePatch(this.scene,0,0,i,n,h.c.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var c=.5*-n;this.titlebg=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title_bg"}),this.titlebg.y=c-.5*this.titlebg.height+2*this.dpr;var p=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title"});p.y=this.titlebg.y+34*this.dpr,this.tilteName=this.scene.make.text({x:0,y:c-18*this.dpr,text:l.i18n.t("order.title"),style:{color:"#905B06",fontSize:15*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*i-5*this.dpr,y:c+5*this.dpr,key:h.c.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",2),this.tilteName.setResolution(this.dpr),this.closeBtn.setInteractive(),this.orderProgressPanel=new f(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.orderProgressPanel.y=.5*-n+20*this.dpr,this.orderProgressPanel.setHandler(new l.Handler(this,this.onProgressHandler));var u={x:0,y:15*this.dpr,table:{width:i-40*this.dpr,height:n-110*this.dpr,columns:1,cellWidth:i-40*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var n=t.index,a=t.item;return null===i&&((i=new d(e.uiManager,e.key,e.dpr)).setHandler(new l.Handler(e,e.onSendHandler),new l.Handler(e,e.onRefreshOrderList),new l.Handler(e,e.onItemInfoTips)),i.on("pointerdown",e.onClickDownHandler,e)),i.setOrderData(a,n),i}};this.mGameGrid=new a.GameGridTable(this.scene,u),this.mGameGrid.layout(),this.goldImageValue=new s.ImageValue(this.scene,50*this.dpr,14*this.dpr,this.key,"iv_coin_s",this.dpr),this.goldImageValue.setFrameValue("",this.key,"order_precious"),this.goldImageValue.setTextStyle({color:"#144B99",fontSize:10*this.dpr,fontFamily:l.Font.DEFULT_FONT}),this.goldImageValue.setFontStyle("bold"),this.goldImageValue.y=.5*n-25*this.dpr,this.goldImageValue.visible=!1,this.orderProgressPanel.visible=!1,this.itemtips=new s.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,h.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.bg,this.closeBtn,this.titlebg,p,this.tilteName,this.orderProgressPanel,this.mGameGrid,this.goldImageValue,this.itemtips]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questlist"),this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questprogress")},PicaOrderPanel.prototype.setOrderDataList=function(t){this.goldImageValue.visible=!0,this.orderProgressPanel.visible=!0;var e=t.orders;this.mGameGrid.setItems(e),this.royalOrderLimit=t.royalOrderLimit,this.goldImageValue.setText(this.royalOrderLimit.currentValue+"/"+this.royalOrderLimit.max),this.goldImageValue.resetSize(),this.goldImageValue.x=.5*this.content.width-.5*this.goldImageValue.width-20*this.dpr},PicaOrderPanel.prototype.setOrderProgress=function(t){this.progressData=t,this.orderProgressPanel.setProgressDatas(t)},PicaOrderPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaOrderPanel.prototype.OnClosePanel=function(){this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_hide")},PicaOrderPanel.prototype.onSendHandler=function(t,e){var i=this;2===e?new s.AlertView(this.uiManager).show({text:l.i18n.t("order.refreshtips"),title:l.i18n.t("order.refreshtitle"),oy:302*this.dpr*this.mWorld.uiScale,callback:function(){i.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_changeorder",{index:t,orderOperator:e})}}):this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_changeorder",{index:t,orderOperator:e})},PicaOrderPanel.prototype.onProgressHandler=function(t,e){if(this.progressData){var i=e.progressData;i.received||(i.targetValue<=this.progressData.currentProgressValue?this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questreward",t):(this.itemtips.setItemData(i.rewards[0]),this.showItemTipsState(e)))}},PicaOrderPanel.prototype.onRefreshOrderList=function(){this.render.renderEmitter(o.ModuleName.PICAORDER_NAME+"_questlist")},PicaOrderPanel.prototype.onItemInfoTips=function(t){var e=t.itemData;this.itemtips.setItemData(e),this.showItemTipsState(t,10*this.dpr)},PicaOrderPanel.prototype.onClickDownHandler=function(){this.itemtips.setVisible(!1)},PicaOrderPanel.prototype.showItemTipsState=function(t,e){void 0===e&&(e=0);var i=this.itemtips.x,n=this.itemtips.y;this.setTipsPosition(t,e),i!==this.itemtips.x||n!==this.itemtips.y?this.itemtips.setVisible(!0):this.itemtips.setVisible(!this.itemtips.visible)},PicaOrderPanel.prototype.setTipsPosition=function(t,e){void 0===e&&(e=0);for(var i=t.x,n=t.y,a=t;a.parentContainer!==this.content;)i+=a.parentContainer.x,n+=a.parentContainer.y,a=a.parentContainer;i-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:i+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=i,this.itemtips.y=n-.5*this.itemtips.height+10*this.dpr+e},PicaOrderPanel}(s.BasePanel),d=function(t){function OrderItem(e,i,n){var o=t.call(this,e.scene)||this;o.materialItems=[],o.imageValues=[],o.orderRewards=[],o.key=i,o.dpr=n,o.mScene=e.scene,o.mRender=e.render,o.bg=o.mScene.make.image({key:i,frame:"order_ordinary_bg"}),o.add(o.bg),o.setSize(o.bg.width,o.bg.height),o.headbg=o.mScene.make.image({key:i,frame:"order_ordinary_head_bg"}),o.add(o.headbg),o.headbg.x=.5*-o.width+.5*o.headbg.width+4*n,o.headbg.y=5*n,o.headIcon=new s.DynamicImage(o.mScene,o.headbg.x,0),o.add(o.headIcon),o.refreshBtn=new a.Button(o.mScene,o.key,"order_delete_bg","order_delete_bg"),o.refreshBtn.x=.5*o.width-.5*o.refreshBtn.width,o.refreshBtn.y=.5*-o.height+.5*o.refreshBtn.height,o.add(o.refreshBtn);var c=o.mScene.make.image({key:i,frame:"order_delete"});return o.refreshBtn.add(c),o.sendBtn=new a.Button(o.mScene,h.c.commonKey,"order_green_butt","order_green_butt",l.i18n.t("order.send")),o.sendBtn.x=.5*o.width-.5*o.sendBtn.width-5*n,o.sendBtn.setTextStyle({fontSize:10*n}),o.add(o.sendBtn),o.sendTitle=o.mScene.make.text({x:.5*o.width-5*n,y:0,text:l.i18n.t("order.deliverying"),style:{color:"#ffffff",fontSize:13*n,fontFamily:l.Font.DEFULT_FONT}}),o.sendTitle.setOrigin(1,.5),o.add(o.sendTitle),o.acceleBtn=new a.Button(o.mScene,h.c.commonKey,"order_red_butt","order_red_butt",l.i18n.t("order.accele")),o.acceleBtn.x=20*n,o.acceleBtn.y=0,o.acceleBtn.setTextStyle({fontSize:11*n}),o.add(o.acceleBtn),o.acceleSpend=new s.ImageValue(o.mScene,30*n,10*n,o.key,"iv_coin_s",o.dpr),o.acceleSpend.x=o.acceleBtn.x,o.acceleSpend.y=o.acceleBtn.y-.5*o.acceleBtn.height-10*n,o.add(o.acceleSpend),o.calcuTime=new s.ImageValue(o.mScene,30*n,10*n,o.key,"iv_coin_s",n),o.add(o.calcuTime),o.calcuTime.setTextStyle({color:"#144B99",fontSize:10*o.dpr,fontFamily:l.Font.DEFULT_FONT}),o.calcuTime.setFontStyle("bold"),o.calcuTime.x=o.acceleBtn.x,o.calcuTime.y=o.acceleBtn.y+.5*o.acceleBtn.height+10*n,o.sendBtn.on(String(a.ClickEvent.Tap),o.onSendHandler,o),o.acceleBtn.on(String(a.ClickEvent.Tap),o.onAcceleHandler,o),o.refreshBtn.on(String(a.ClickEvent.Tap),o.onRefreshHandler,o),o.setInteractive(),o}return c(OrderItem,t),OrderItem.prototype.setHandler=function(t,e,i){this.sendHandler=t,this.tipsHandler=i,this.refreshHandler=e},OrderItem.prototype.setOrderData=function(t,e){var i=this;if(this.orderData=t,this.index=e,this.hideAllElement(),this.bg.setFrame(5===t.questType?"order_precious_bg":"order_ordinary_bg"),4!==t.stage){var n=l.Url.getOsdRes(t.display.texturePath);this.headIcon.load(n,this,(function(){i.headIcon.scale=1,i.headIcon.scaleY=49*i.dpr/i.headIcon.displayHeight,i.headIcon.scaleX=i.headIcon.scaleY})),this.headIcon.visible=!0}1===t.stage?(this.deliveryState(t),this.orderOperator=0):2===t.stage?this.deliveryingState(t):3===t.stage?(this.rewardState(t),this.orderOperator=3):4===t.stage&&(this.cooldownState(t),this.orderOperator=1)},OrderItem.prototype.destroy=function(e){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),t.prototype.destroy.call(this,e)},OrderItem.prototype.getServiceTimestamp=function(){return this.mRender.mainPeer.now()},OrderItem.prototype.onAcceleHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onRefreshHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,2])},OrderItem.prototype.deliveryState=function(t){var e=t.questType;this.headbg.setFrame(5===e?"order_precious_head_bg":"order_ordinary_head_bg"),this.refreshBtn.visible=!0,this.refreshBtn.setInteractive(),this.refreshBtn.setFrameNormal(5===e?"order_precious_delete_bg":"order_delete_bg");for(var i=.5*-this.width+58*this.dpr,n=!0,a=0;a<t.targets.length;a++){var o=t.targets[a],h=void 0;a<this.materialItems.length?h=this.materialItems[a]:(h=new u(this.scene,this.key,this.dpr),this.add(h),this.materialItems.push(h),h.setHandler(this.tipsHandler),h.addListen()),h.setMaterialData(o),h.x=i+.5*h.width,i+=h.width+8*this.dpr,h.y=-10*this.dpr,h.visible=!0,n&&(n=o.count>=o.neededCount)}n?(this.sendBtn.setFrameNormal("order_green_butt"),this.sendBtn.setInteractive()):(this.sendBtn.setFrameNormal("order_gray_butt"),this.sendBtn.disInteractive()),this.sendBtn.visible=!0,this.sendBtn.setText(l.i18n.t("order.send")),this.sendBtn.setTextColor("#ffffff"),i=.5*-this.width+58*this.dpr;for(a=0;a<t.rewards.length;a++){var c=t.rewards[a];h=void 0;a<this.imageValues.length?h=this.imageValues[a]:(h=new s.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,"iv_coin_s",this.dpr),this.add(h),this.imageValues.push(h)),h.setOffset(0,this.dpr),h.setFrameValue(""+c.count,this.key,this.getIconName(c.texturePath)+"_s"),h.setTextStyle({color:5===e?"#ffffff":"#2154BD"}),h.x=i+.5*h.width,i+=h.width+20*this.dpr,h.y=.5*this.height-.5*h.height-4*this.dpr,h.visible=!0}},OrderItem.prototype.deliveryingState=function(t){var e=this;this.deliverybg?this.deliverybg.visible=!0:(this.deliverybg=this.scene.make.image({key:this.key,frame:"order_transport"}),this.addAt(this.deliverybg,1),this.deliverybg.x=.5*this.width-.5*this.deliverybg.width-10*this.dpr),this.headbg.setFrame("order_ordinary_head_bg"),this.sendTitle.visible=!0,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){return __awaiter(e,void 0,void 0,(function(){var e,i,n,a,s;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getServiceTimestamp()];case 1:return e=o.sent(),(i=Math.ceil(t.deliveryDeadline-e/1e3))<0&&(i=0),n=Math.floor(i/60),s=(n<10?"0"+n:n+"")+":"+((a=i%60)<10?"0"+a:a+""),this.calcuTime.visible=!0,this.calcuTime.setFrameValue(s,this.key,"order_time"),this.calcuTime.resetSize(),this.calcuTime.x=.5*this.width-.5*this.calcuTime.width-10*this.dpr,this.calcuTime.y=.5*this.height-.5*this.calcuTime.height-5*this.dpr,i>0?this.timeID=setTimeout((function(){timeextu()}),1e3):(this.timeID&&this.refreshHandler&&this.refreshHandler.run(),this.timeID=void 0),[2]}}))}))};timeextu();for(var i=.5*-this.width+60*this.dpr,n=0;n<t.rewards.length;n++){var a=t.rewards[n],o=void 0;n<this.imageValues.length?o=this.imageValues[n]:(o=new s.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,"iv_coin_s",this.dpr),this.add(o),this.imageValues.push(o)),o.setFrameValue(""+a.count,this.key,this.getIconName(a.display.texturePath)+"_s"),o.setTextStyle({color:"#2154BD"}),o.x=i+.5*o.width,i+=o.width+20*this.dpr,o.y=.5*this.height-.5*o.height-4*this.dpr,o.visible=!0}},OrderItem.prototype.rewardState=function(t){this.headbg.setFrame("order_ordinary_head_bg"),this.sendBtn.visible=!0,this.sendBtn.setInteractive(),this.sendBtn.setFrameNormal("order_yellow_butt"),this.sendBtn.setText(l.i18n.t("order.receive")),this.sendBtn.setTextColor("#9A6600");for(var e=.5*-this.width+60*this.dpr,i=0;i<t.rewards.length;i++){var n=t.rewards[i],a=void 0;i<this.orderRewards.length?a=this.orderRewards[i]:(a=new m(this.scene,this.key,this.dpr),this.add(a),this.orderRewards.push(a)),a.x=e+.5*a.width,e+=a.width+20*this.dpr,a.y=-6*this.dpr,a.visible=!0,a.setItemData(n)}},OrderItem.prototype.cooldownState=function(t){var e=this;this.headbg.setFrame("order_unknown_head"),this.headIcon.visible=!1,this.acceleBtn.visible=!0,this.acceleBtn.setInteractive(),this.acceleSpend.visible=!0,this.calcuTime.visible=!0,this.calcuTime.y=this.acceleBtn.y+.5*this.acceleBtn.height+10*this.dpr,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){return __awaiter(e,void 0,void 0,(function(){var e,i,n,a,s;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getServiceTimestamp()];case 1:return e=o.sent(),(i=Math.ceil(t.refreshDeadline-e/1e3))<0&&(i=0),n=Math.floor(i/60),s=(n<10?"0"+n:n+"")+":"+((a=i%60)<10?"0"+a:a+""),this.calcuTime.visible=!0,this.calcuTime.setFrameValue(s,this.key,"order_time"),this.calcuTime.resetSize(),this.calcuTime.x=this.acceleBtn.x,this.acceleSpend.setFrameValue(n+"",this.key,"iv_diamond_s"),i>0?this.timeID=setTimeout((function(){timeextu()}),1e3):(this.timeID&&this.refreshHandler&&this.refreshHandler.run(),this.timeID=void 0),[2]}}))}))};timeextu()},OrderItem.prototype.getIconName=function(t){var e=t,i=e.lastIndexOf("/"),n=e.lastIndexOf(".");return e.slice(i+1,n)},OrderItem.prototype.hideAllElement=function(){this.refreshBtn.visible=!1,this.refreshBtn.disInteractive(),this.sendBtn.visible=!1,this.sendBtn.disInteractive(),this.sendTitle.visible=!1,this.acceleBtn.visible=!1,this.acceleBtn.disInteractive(),this.acceleSpend.visible=!1,this.calcuTime.visible=!1,this.deliverybg&&(this.deliverybg.visible=!1);for(var t=0,e=this.materialItems;t<e.length;t++){(o=e[t]).visible=!1,o.removeListen()}for(var i=0,n=this.orderRewards;i<n.length;i++){(o=n[i]).visible=!1}for(var a=0,s=this.imageValues;a<s.length;a++){var o;(o=s[a]).visible=!1}this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0)},OrderItem}(Phaser.GameObjects.Container),u=function(t){function MaterialItem(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.dpr=n,o.bg=e.make.image({key:i,frame:"order_demand_icon"}),o.setSize(o.bg.width,o.bg.height),o.icon=new s.DynamicImage(e,0,-5*n),o.icon.setSize(15*n,15*n),o.value=new a.BBCodeText(o.scene,0,.5*o.height-10*n,"60/30",{color:"#0",fontSize:8*o.dpr,fontFamily:l.Font.DEFULT_FONT}).setOrigin(.5),o.add([o.bg,o.icon,o.value]),o.setInteractive(),o}return c(MaterialItem,t),MaterialItem.prototype.setMaterialData=function(t){var e=this;this.itemData=t;var i=l.Url.getOsdRes(t.texturePath);this.icon.load(i,this,(function(){e.icon.scale=1,e.icon.scaleX=15*e.dpr/e.icon.displayWidth,e.icon.scaleY=e.icon.scaleX})),this.value.text=t.count+"/"+t.neededCount},MaterialItem.prototype.setHandler=function(t){this.tipsHandler=t},MaterialItem.prototype.addListen=function(){this.on("pointerup",this.onClickHandler,this)},MaterialItem.prototype.removeListen=function(){this.off("pointerdown",this.onClickHandler,this)},MaterialItem.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},MaterialItem.prototype.onClickHandler=function(){this.tipsHandler&&this.tipsHandler.runWith(this)},MaterialItem}(Phaser.GameObjects.Container),m=function(t){function OrderRewardItem(e,i,n){var a=t.call(this,e)||this;return a.key=i,a.dpr=n,a.bg=e.make.image({key:i,frame:"order_reward"}),a.setSize(a.bg.width,a.bg.height),a.icon=e.make.image({key:i,frame:"order_silver_middle"}),a.add([a.bg,a.icon]),a}return c(OrderRewardItem,t),OrderRewardItem.prototype.setItemData=function(t){this.imageValue=new s.ImageValue(this.scene,30*this.dpr,13*this.dpr,this.key,void 0,this.dpr),this.imageValue.setFrameValue(""+t.count,this.key,this.getIconName(t.texturePath)+"_s"),this.imageValue.x=-4*this.dpr,this.imageValue.y=this.height-.5*this.imageValue.height+2*this.dpr,this.imageValue.setOffset(0,this.dpr),this.imageValue.setTextStyle({color:"#2154BD"}),this.add([this.imageValue]),this.icon.setFrame(this.getIconName(t.texturePath))},OrderRewardItem.prototype.getIconName=function(t){var e=t,i=e.lastIndexOf("/"),n=e.lastIndexOf(".");return e.slice(i+1,n)},OrderRewardItem}(Phaser.GameObjects.Container),f=function(t){function OrderProgressPanel(e,i,n,s,o){var h=t.call(this,e)||this;h.progressItems=[],h.setSize(i,n),h.dpr=o,h.key=s;var l={x:0*o/2,y:15*o,width:251*o,height:11*o,background:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:s,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*o,height:11*o,config:{top:0*o,left:7*o,right:7*o,bottom:0*o},key:s,frame:"order_progress_top"},dpr:o,textConfig:void 0};return h.progress=new a.ProgressBar(e,l),h.add(h.progress),h}return c(OrderProgressPanel,t),OrderProgressPanel.prototype.setProgressDatas=function(t){for(var e=t.steps.length,i=100,n=0;n<e;n++){var a=t.steps[n],s=void 0;n<this.progressItems.length?s=this.progressItems[n]:(s=new y(this.scene,0,0,this.key,this.dpr),this.add(s),this.progressItems.push(s),s.setHandler(this.receiveHandler)),s.x=.5*-this.width+this.width*(n+1)/e-16*this.dpr,s.y=15*this.dpr,s.setItemData(a,n,t.currentProgressValue),i=a.targetValue}this.progress.setProgress(t.currentProgressValue,i)},OrderProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressPanel}(Phaser.GameObjects.Container),y=function(t){function OrderProgressItem(e,i,n,o,h){var c=t.call(this,e,i,n)||this;return c.dpr=h,c.key=o,c.bg=new a.Button(e,o,"order_progress_unfinished","order_progress_unfinished"),c.icon=new s.DynamicImage(e,0,0),c.text=e.make.text({x:0,y:.5*c.bg.height+10*h,text:"10",style:{color:"#2154BD",fontSize:12*h,fontFamily:l.Font.DEFULT_FONT}}),c.text.setFontStyle("bold"),c.text.setOrigin(.5),c.finishIcon=e.make.image({key:o,frame:"order_progress_ok"}),c.balckgraphic=e.make.graphics(void 0,!1),c.balckgraphic.clear(),c.balckgraphic.fillStyle(0,.5),c.balckgraphic.fillCircle(0,0,16*h),c.add([c.bg,c.icon,c.text,c.balckgraphic,c.finishIcon]),c.finishIcon.visible=!1,c}return c(OrderProgressItem,t),OrderProgressItem.prototype.setItemData=function(t,e,i){var n=this;if(this.progressData=t,this.index=e,this.text.text=t.targetValue+"",t.rewards){var s=l.Url.getOsdRes(t.rewards[0].texturePath);this.icon.load(s,this,(function(){n.icon.scale=1,n.icon.scaleY=29*n.dpr/n.icon.displayHeight,n.icon.scaleX=n.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<=i?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received&&(this.finishIcon.visible=!0,this.balckgraphic.visible=!0),this.text.setColor("#2154BD")):(this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),this.text.setColor("#989898")),t.received?this.bg.off(String(a.ClickEvent.Tap),this.onReceiveHandler,this):(this.bg.off(String(a.ClickEvent.Tap),this.onReceiveHandler,this),this.bg.on(String(a.ClickEvent.Tap),this.onReceiveHandler,this))},OrderProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith([this.index,this])},OrderProgressItem}(Phaser.GameObjects.Container)},function(t,e,i){"use strict";i.r(e),i.d(e,"PicaWorkPanel",(function(){return p}));var n,a=i(6),s=i(479),o=i(0),h=i(21),l=i(2),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function PicaWorkPanel(e){var i=t.call(this,e.scene,e.render)||this;return i.imageValues=[],i.curProgress=0,i.isWorking=!1,i.moneyAniKey="workemoeny",i.starAniKey="workstar",i.key=o.ModuleName.PICAWORK_NAME,i}return c(PicaWorkPanel,t),PicaWorkPanel.prototype.resize=function(e,i){var n=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,n,a),this.setSize(n,a),this.content.x=.5*n,this.content.y=a-.5*this.content.height,this.content.setInteractive()},PicaWorkPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.render.renderEmitter(this.key+"_initialized")):this.preload())},PicaWorkPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicaWorkPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicaWorkPanel.prototype.preload=function(){this.addAtlas(this.key,"work/work.png","work/work.json"),this.addAtlas(h.c.commonKey,h.d.textureUrl(h.d.commonUrl),h.d.jsonUrl(h.d.commonUrl)),this.addAtlas(h.c.common2Key,h.d.textureUrl(h.d.common2Url),h.d.jsonUrl(h.d.common2Url)),t.prototype.preload.call(this)},PicaWorkPanel.prototype.init=function(){var e=this.scaleWidth,i=153*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(e,i),this.add(this.content),this.bg=this.scene.make.image({key:this.key,frame:"work_bg"}),this.bg.y=.5*i-.5*this.bg.height,this.headIcon=new s.DynamicImage(this.scene,0,0,this.key,"work_npc"),this.headIcon.x=.5*-e+65*this.dpr,this.headIcon.y=-5*this.dpr,this.headIcon.scale=this.dpr,this.headIcon.visible=!1;var n=new a.NineSlicePatch(this.scene,0,0,95*this.dpr,24*this.dpr,this.key,"work_name",{left:14*this.dpr,top:0*this.dpr,bottom:0*this.dpr,right:14*this.dpr});n.x=.5*-e+.5*n.width+15*this.dpr,n.y=35*this.dpr,this.titleName=this.scene.make.text({x:n.x,y:n.y,text:"这是额二比大厨师",style:{color:"#FFE11A",fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}}).setOrigin(.5),this.salaryLabel=this.scene.make.text({x:.5*-e+20*this.dpr,y:this.bg.y+7*this.dpr,text:l.i18n.t("work.salary")+":",style:l.UIHelper.whiteStyle(this.dpr,11)}),this.salaryLabel.setOrigin(0,.5),this.salaryvalue=new s.ImageValue(this.scene,60*this.dpr,20*this.dpr,h.c.commonKey,"iv_coin",this.dpr),this.salaryvalue.setOffset(-this.dpr,0),this.salaryvalue.setTextStyle({color:"#FFEA00"}),this.salaryvalue.setLayout(1),this.salaryvalue.x=this.salaryLabel.x+this.salaryLabel.width+.5*this.salaryvalue.width+3*this.dpr,this.salaryvalue.y=this.salaryLabel.y,this.workbutton=new u(this.scene,132*this.dpr,35*this.dpr,this.key,"progress_top",l.i18n.t("work.title"),this.dpr),this.workbutton.x=30*this.dpr,this.workbutton.y=5*this.dpr,this.workbutton.on(a.ClickEvent.Tap,this.onSendHandler,this),this.starSprite=this.createSprite(this.key,this.starAniKey,"star",[1,30],24),this.moneySprite=this.createSprite(this.key,this.moneyAniKey,"workover",[1,10],24),this.starSprite.x=this.workbutton.x,this.starSprite.y=this.workbutton.y,this.moneySprite.x=this.starSprite.x,this.moneySprite.y=this.starSprite.y,this.closeBtn=new a.Button(this.scene,this.key,"close","close"),this.closeBtn.y=this.bg.y+2*this.dpr,this.closeBtn.x=.5*this.content.width-.5*this.closeBtn.width-10*this.dpr,this.itemtips=new s.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,h.c.common2Key,"tips_bg",this.dpr),this.itemtips.setVisible(!1),this.content.add([this.headIcon,this.bg,this.closeBtn,n,this.titleName,this.salaryLabel,this.salaryvalue,this.workbutton,this.starSprite,this.moneySprite,this.closeBtn,this.itemtips]),this.resize(),t.prototype.init.call(this),this.render.renderEmitter(this.key+"_questlist")},PicaWorkPanel.prototype.setWorkData=function(t){this.setJobData(t),this.workbutton.setProgressDatas(0,100)},PicaWorkPanel.prototype.setWorkChance=function(t){t<=0?this.workbutton.disInteractive():this.workbutton.setInteractive()},PicaWorkPanel.prototype.setJobData=function(t){var e=this;this.jobData=t;var i=l.Url.getOsdRes(t.display.texturePath);this.headIcon.load(i,this,(function(){e.headIcon.scale=e.dpr})),this.headIcon.visible=!0,this.titleName.text=t.name;var n="0";if(t.rewards){var a=t.rewards[0].countRange;n=a.start+"~"+a.stop}this.salaryvalue.setText(n);for(var s=t.targets,o=0,h=this.imageValues;o<h.length;o++){(u=h[o]).visible=!1}for(var c=this.salaryvalue.x+.5*this.salaryvalue.width+20*this.dpr,p=0;p<s.length;p++){var u=void 0,m=s[p];p<this.imageValues.length?u=this.imageValues[p]:(u=new d(this.scene,35*this.dpr,15*this.dpr,this.key,this.dpr),this.content.add(u),this.imageValues.push(u),u.setHandler(new l.Handler(this,this.onItemInfoTips)));var f=l.Url.getOsdRes(m.texturePath);u.setUrlValue(f,m.neededCount),u.setTextStyle({color:m.count>=m.neededCount?"#000000":"#E71313"}),u.setImageData(m),u.visible=!0,u.x=c+.5*u.width,u.y=this.salaryLabel.y,u.visible=!0,c+=u.width+20*this.dpr}},PicaWorkPanel.prototype.createSprite=function(t,e,i,n,a,s,o){void 0===a&&(a=30),void 0===s&&(s=0);var h=this.scene.make.sprite({key:t,frame:i+"1"});h.visible=!1;var l=this.scene.anims.create({key:e,frames:this.scene.anims.generateFrameNames(t,{prefix:i+"",start:n[0],end:n[1]}),frameRate:a,repeat:s});return l.removeAllListeners(),l.on(Phaser.Animations.Events.ANIMATION_COMPLETE,(function(){h.visible=!1,o&&o.run()}),this),l.on(Phaser.Animations.Events.ANIMATION_START,(function(){h.visible=!0}),this),h},PicaWorkPanel.prototype.calculateTimeout=function(){var t=this;this.isWorking=!0,this.interTimeerID=setTimeout((function(){t.curProgress+=.1,t.workbutton.setProgressDatas(t.curProgress,100),t.curProgress<100?t.calculateTimeout():(t.isWorking=!1,t.curProgress=0,t.workbutton.setProgressDatas(t.curProgress,100),t.render.renderEmitter(t.key+"_questwork"),t.interTimeerID=void 0,t.moneySprite.play(t.moneyAniKey))}),20)},PicaWorkPanel.prototype.OnClosePanel=function(){this.interTimeerID&&clearTimeout(this.interTimeerID),this.render.renderEmitter(this.key+"_hide")},PicaWorkPanel.prototype.onSendHandler=function(t){this.curProgress+=3,this.isWorking||this.calculateTimeout(),this.starSprite.play(this.starAniKey,!0)},PicaWorkPanel.prototype.onItemInfoTips=function(t){var e=t.imageData;this.itemtips.visible=!0,this.itemtips.setTipsPosition(t,this),this.itemtips.setText(this.getDesText(e))},PicaWorkPanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),l.i18n.t("work.attri",{name:""+t.name,value:t.neededCount})},PicaWorkPanel}(s.BasePanel),d=function(t){function PointerImageValue(e,i,n,a,s){var o=t.call(this,e,i,n,a,void 0,s)||this;return o.addListen(),o}return c(PointerImageValue,t),PointerImageValue.prototype.setImageData=function(t){this.imageData=t},PointerImageValue.prototype.setUrlValue=function(t,e){var i=this;this.value.text=e,this.icon.load(t,this,(function(){i.icon.scale=1,i.icon.scaleY=14*i.dpr/i.icon.displayHeight,i.icon.scaleX=i.icon.scaleY,i.value.x=i.icon.x+.5*i.icon.displayWidth+10*i.dpr,i.resetSize()}))},PointerImageValue.prototype.addListen=function(){this.setInteractive(),this.on("pointerdown",this.onClickDownHandler,this),this.scene.input.on("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.removeListen=function(){this.disableInteractive(),this.off("pointerdown",this.onClickDownHandler,this),this.scene.input.off("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.destroy=function(e){this.removeListen(),t.prototype.destroy.call(this,e)},PointerImageValue.prototype.setHandler=function(t){this.tipsHandler=t},PointerImageValue.prototype.create=function(){this.icon=new s.DynamicImage(this.scene,0,0),this.value=this.scene.make.text({x:0,y:this.offset.y,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:l.Font.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},PointerImageValue.prototype.onClickDownHandler=function(){new Phaser.Geom.Point;this.tipsHandler&&this.tipsHandler.runWith([this,!0])},PointerImageValue.prototype.onClickUpHandler=function(){this.tipsHandler&&this.tipsHandler.runWith([this,!1])},PointerImageValue}(s.ImageValue),u=function(t){function ProgressItem(e,i,n,a,o,h,c){var p=t.call(this,e,0,0)||this;return p.setSize(i,n),p.dpr=c,p.key=a,p.progress=new s.ProgressMaskBar(e,a,"progress_bottom","progress_top"),p.add(p.progress),p.title=e.make.text({x:0,y:0,text:h,style:{color:"#512103",fontSize:14*c,fontFamily:l.Font.DEFULT_FONT}}),p.title.setFontStyle("bold"),p.title.setOrigin(.5),p.add(p.title),p.enable=!0,p.mDuration=35,p}return c(ProgressItem,t),ProgressItem.prototype.setProgressDatas=function(t,e){this.progress.setProgress(t,e)},ProgressItem}(s.ButtonEventDispatcher)},function(t,e,i){"use strict";var n,a=i(545),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function __(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)});(function(t){function EditorCamerasManager(){return null!==t&&t.apply(this,arguments)||this}s(EditorCamerasManager,t),EditorCamerasManager.prototype.centerCameas=function(){},EditorCamerasManager.prototype.offsetScroll=function(t,e){if(this.mMain)for(var i=0,n=this.mCameras;i<n.length;i++){var a=n[i];a.scrollX+=t/this.zoom,a.scrollY+=e/this.zoom}},EditorCamerasManager.prototype.syncCameraScroll=function(){}})(a.a),i(435)},function(t,e,i){var n={"./":491,"./Activity/ActivityPanel":549,"./Activity/ActivityPanel.ts":549,"./Bottom/BottomPanel":644,"./Bottom/BottomPanel.ts":644,"./Bubble/InteractionBubbleCell":498,"./Bubble/InteractionBubbleCell.ts":498,"./Bubble/InteractionBubbleContainer":499,"./Bubble/InteractionBubbleContainer.ts":499,"./Bubble/InteractiveBubblePanel":556,"./Bubble/InteractiveBubblePanel.ts":556,"./CharacterInfo/CharacterAttributePanel":493,"./CharacterInfo/CharacterAttributePanel.ts":493,"./CharacterInfo/CharacterEditorPanel":494,"./CharacterInfo/CharacterEditorPanel.ts":494,"./CharacterInfo/CharacterInfoPanel":550,"./CharacterInfo/CharacterInfoPanel.ts":550,"./CharacterInfo/GraphicsProgressBar":551,"./CharacterInfo/GraphicsProgressBar.ts":551,"./Chat/ChatPanel":645,"./Chat/ChatPanel.ts":645,"./Components":481,"./Components/":481,"./Components/Item.button":544,"./Components/Item.button.ts":544,"./Components/back.text.button":547,"./Components/back.text.button.ts":547,"./Components/detail.display":482,"./Components/detail.display.ts":482,"./Components/energy.progress.bar":548,"./Components/energy.progress.bar.ts":548,"./Components/index":481,"./Components/index.ts":481,"./CreateRole/CreateRolePanel":557,"./CreateRole/CreateRolePanel.ts":557,"./CutIn/CutInPanel":558,"./CutIn/CutInPanel.ts":558,"./CutInMenu/CutInMenuPanel":559,"./CutInMenu/CutInMenuPanel.ts":559,"./Dialog/DialogPanel":560,"./Dialog/DialogPanel.ts":560,"./GMTools/GMToolsPanel":646,"./GMTools/GMToolsPanel.ts":646,"./Login/LoginPanel":561,"./Login/LoginPanel.ts":561,"./Login/VerifiePanel":562,"./Login/VerifiePanel.ts":562,"./PicManorInfo/PicManorInfoPanel":563,"./PicManorInfo/PicManorInfoPanel.ts":563,"./PicManorInfo/PicaManorBasePanel":487,"./PicManorInfo/PicaManorBasePanel.ts":487,"./PicManorInfo/PicaManorChildPanel":500,"./PicManorInfo/PicaManorChildPanel.ts":500,"./PicManorInfo/PicaManorShopPanel":501,"./PicManorInfo/PicaManorShopPanel.ts":501,"./PicManorInfo/PicaManorTipsPanel":564,"./PicManorInfo/PicaManorTipsPanel.ts":564,"./PicRoomUpgrade/PicRoomUpgradePanel":565,"./PicRoomUpgrade/PicRoomUpgradePanel.ts":565,"./PicaAvatar/PicaAvatarPanel":566,"./PicaAvatar/PicaAvatarPanel.ts":566,"./PicaBag/PicaBagPanel":567,"./PicaBag/PicaBagPanel.ts":567,"./PicaBusinessMarketingPlan/PicaBusinessChoosePlanPanel":502,"./PicaBusinessMarketingPlan/PicaBusinessChoosePlanPanel.ts":502,"./PicaBusinessMarketingPlan/PicaBusinessMarketingPlanPanel":568,"./PicaBusinessMarketingPlan/PicaBusinessMarketingPlanPanel.ts":568,"./PicaBusinessMarketingPlan/PicaBusinessPlanPanel":503,"./PicaBusinessMarketingPlan/PicaBusinessPlanPanel.ts":503,"./PicaBusinessStreet/PicaBusinessContentPanel":489,"./PicaBusinessStreet/PicaBusinessContentPanel.ts":489,"./PicaBusinessStreet/PicaBusinessHistoryPanel":504,"./PicaBusinessStreet/PicaBusinessHistoryPanel.ts":504,"./PicaBusinessStreet/PicaBusinessMyStreetPanel":505,"./PicaBusinessStreet/PicaBusinessMyStreetPanel.ts":505,"./PicaBusinessStreet/PicaBusinessRankRewardPanel":506,"./PicaBusinessStreet/PicaBusinessRankRewardPanel.ts":506,"./PicaBusinessStreet/PicaBusinessRankingDetailPanel":507,"./PicaBusinessStreet/PicaBusinessRankingDetailPanel.ts":507,"./PicaBusinessStreet/PicaBusinessRankingPanel":508,"./PicaBusinessStreet/PicaBusinessRankingPanel.ts":508,"./PicaBusinessStreet/PicaBusinessStoreCreatePanel":509,"./PicaBusinessStreet/PicaBusinessStoreCreatePanel.ts":509,"./PicaBusinessStreet/PicaBusinessStreetListPanel":510,"./PicaBusinessStreet/PicaBusinessStreetListPanel.ts":510,"./PicaBusinessStreet/PicaBusinessStreetPanel":569,"./PicaBusinessStreet/PicaBusinessStreetPanel.ts":569,"./PicaBusinessStreet/SecondaryMenuPanel":488,"./PicaBusinessStreet/SecondaryMenuPanel.ts":488,"./PicaChat/PicaChatInputPanel":495,"./PicaChat/PicaChatInputPanel.ts":495,"./PicaChat/PicaChatPanel":553,"./PicaChat/PicaChatPanel.ts":553,"./PicaChat/PicaGiftPanel":496,"./PicaChat/PicaGiftPanel.ts":496,"./PicaCompose/PicaComposePanel":570,"./PicaCompose/PicaComposePanel.ts":570,"./PicaCreateRole/PicaCreateRolePanel":571,"./PicaCreateRole/PicaCreateRolePanel.ts":571,"./PicaDecorate/PicaDecoratePanel":647,"./PicaDecorate/PicaDecoratePanel.ts":647,"./PicaDecorateControl/PicaDecorateControlPanel":572,"./PicaDecorateControl/PicaDecorateControlPanel.ts":572,"./PicaEffectMgr/PicaEffectMgrPanel":573,"./PicaEffectMgr/PicaEffectMgrPanel.ts":573,"./PicaEffectMgr/PicaFurniUnlockEffectPanel":511,"./PicaEffectMgr/PicaFurniUnlockEffectPanel.ts":511,"./PicaElementStorage/Item":626,"./PicaElementStorage/Item.ts":626,"./PicaElementStorage/PicaElementStoragePanel":574,"./PicaElementStorage/PicaElementStoragePanel.ts":574,"./PicaElevator/PicaElevatorPanel":575,"./PicaElevator/PicaElevatorPanel.ts":575,"./PicaEquipUpgrade/PicaEquipUpgradeItem":512,"./PicaEquipUpgrade/PicaEquipUpgradeItem.ts":512,"./PicaEquipUpgrade/PicaEquipUpgradePanel":576,"./PicaEquipUpgrade/PicaEquipUpgradePanel.ts":576,"./PicaExploreList/PicaChapterLevelClue":490,"./PicaExploreList/PicaChapterLevelClue.ts":490,"./PicaExploreList/PicaExploreListBottomPanel":513,"./PicaExploreList/PicaExploreListBottomPanel.ts":513,"./PicaExploreList/PicaExploreListDetailPanel":514,"./PicaExploreList/PicaExploreListDetailPanel.ts":514,"./PicaExploreList/PicaExploreListLevelPanel":515,"./PicaExploreList/PicaExploreListLevelPanel.ts":515,"./PicaExploreList/PicaExploreListPanel":577,"./PicaExploreList/PicaExploreListPanel.ts":577,"./PicaExploreLog/PicaExploreLogPanel":578,"./PicaExploreLog/PicaExploreLogPanel.ts":578,"./PicaExploreLog/PicaExploreLogSettlePanel":516,"./PicaExploreLog/PicaExploreLogSettlePanel.ts":516,"./PicaFriend/PicaFriendPanel":579,"./PicaFriend/PicaFriendPanel.ts":579,"./PicaFurniFun/PicaFurniFunPanel":580,"./PicaFurniFun/PicaFurniFunPanel.ts":580,"./PicaFurnitureCompose/PicaFurnitureComposePanel":581,"./PicaFurnitureCompose/PicaFurnitureComposePanel.ts":581,"./PicaGiftEffect/PicaGiftEffectPanel":582,"./PicaGiftEffect/PicaGiftEffectPanel.ts":582,"./PicaGiftEffect/PicaGiftLateralItem":518,"./PicaGiftEffect/PicaGiftLateralItem.ts":518,"./PicaGiftEffect/PicaGiftLaterctPanel":517,"./PicaGiftEffect/PicaGiftLaterctPanel.ts":517,"./PicaGiftEffect/PicaGiftPlayerPanel":519,"./PicaGiftEffect/PicaGiftPlayerPanel.ts":519,"./PicaHandheld/PicaHandheldPanel":552,"./PicaHandheld/PicaHandheldPanel.ts":552,"./PicaHouse/PicaHouseInfoPanel":520,"./PicaHouse/PicaHouseInfoPanel.ts":520,"./PicaHouse/PicaHousePanel":583,"./PicaHouse/PicaHousePanel.ts":583,"./PicaItemPopCard/PicaItemPopCardPanel":584,"./PicaItemPopCard/PicaItemPopCardPanel.ts":584,"./PicaMainUI/PicaMainUIPanel":554,"./PicaMainUI/PicaMainUIPanel.ts":554,"./PicaManorList/PicaManorContentPanel":521,"./PicaManorList/PicaManorContentPanel.ts":521,"./PicaManorList/PicaManorListPanel":585,"./PicaManorList/PicaManorListPanel.ts":585,"./PicaManorList/PicaManorScrollPanel":522,"./PicaManorList/PicaManorScrollPanel.ts":522,"./PicaMarket/ElementDetail":523,"./PicaMarket/ElementDetail.ts":523,"./PicaMarket/NumberCounter":524,"./PicaMarket/NumberCounter.ts":524,"./PicaMarket/PicaMarketPanel":586,"./PicaMarket/PicaMarketPanel.ts":586,"./PicaMarket/item":525,"./PicaMarket/item.ts":525,"./PicaMessageBox/PicaMessageBoxPanel":587,"./PicaMessageBox/PicaMessageBoxPanel.ts":587,"./PicaMineCar/PicaMineCarPanel":588,"./PicaMineCar/PicaMineCarPanel.ts":588,"./PicaMineSettle/PicaMineSettlePanel":589,"./PicaMineSettle/PicaMineSettlePanel.ts":589,"./PicaNavigate/PicaNavigatePanel":590,"./PicaNavigate/PicaNavigatePanel.ts":590,"./PicaNewMain/PicaNewActivityPanel":526,"./PicaNewMain/PicaNewActivityPanel.ts":526,"./PicaNewMain/PicaNewChatPanel":527,"./PicaNewMain/PicaNewChatPanel.ts":527,"./PicaNewMain/PicaNewHeadPanel":528,"./PicaNewMain/PicaNewHeadPanel.ts":528,"./PicaNewMain/PicaNewLeftPanel":529,"./PicaNewMain/PicaNewLeftPanel.ts":529,"./PicaNewMain/PicaNewMainPanel":591,"./PicaNewMain/PicaNewMainPanel.ts":591,"./PicaNewMain/PicaNewNavigatePanel":497,"./PicaNewMain/PicaNewNavigatePanel.ts":497,"./PicaNewMain/PicaNewOldMainPanel":648,"./PicaNewMain/PicaNewOldMainPanel.ts":648,"./PicaNewRole/PicaNewRolePanel":592,"./PicaNewRole/PicaNewRolePanel.ts":592,"./PicaNotice/PicaNoticePanel":593,"./PicaNotice/PicaNoticePanel.ts":593,"./PicaOnline/PicaOnlineBottomPanel":627,"./PicaOnline/PicaOnlineBottomPanel.ts":627,"./PicaOnline/PicaOnlinePanel":594,"./PicaOnline/PicaOnlinePanel.ts":594,"./PicaOpenParty/PicaOpenPartyCreatePanel":530,"./PicaOpenParty/PicaOpenPartyCreatePanel.ts":530,"./PicaOpenParty/PicaOpenPartyPanel":595,"./PicaOpenParty/PicaOpenPartyPanel.ts":595,"./PicaOrder/PicaOrderPanel":649,"./PicaOrder/PicaOrderPanel.ts":649,"./PicaPartyList/PicaMyRoomNavigationPanel":628,"./PicaPartyList/PicaMyRoomNavigationPanel.ts":628,"./PicaPartyList/PicaPartyListPanel":596,"./PicaPartyList/PicaPartyListPanel.ts":596,"./PicaPartyList/PicaPartyNavigationPanel":629,"./PicaPartyList/PicaPartyNavigationPanel.ts":629,"./PicaPropFun/PicaPropFunPanel":597,"./PicaPropFun/PicaPropFunPanel.ts":597,"./PicaRecaste/PicaRecastePanel":598,"./PicaRecaste/PicaRecastePanel.ts":598,"./PicaRecharge/PicaRechargePanel":599,"./PicaRecharge/PicaRechargePanel.ts":599,"./PicaRewardTip/PicaRewardTipPanel":600,"./PicaRewardTip/PicaRewardTipPanel.ts":600,"./PicaRoam/PicaRoamDrawPanel":531,"./PicaRoam/PicaRoamDrawPanel.ts":531,"./PicaRoam/PicaRoamEffectOnePanel":630,"./PicaRoam/PicaRoamEffectOnePanel.ts":630,"./PicaRoam/PicaRoamListPanel":532,"./PicaRoam/PicaRoamListPanel.ts":532,"./PicaRoam/PicaRoamPanel":601,"./PicaRoam/PicaRoamPanel.ts":601,"./PicaRoam/PicaRoamPreviewPanel":533,"./PicaRoam/PicaRoamPreviewPanel.ts":533,"./PicaRoomList/PicaRoomListPanel":602,"./PicaRoomList/PicaRoomListPanel.ts":602,"./PicaTask/PicaTaskItem":534,"./PicaTask/PicaTaskItem.ts":534,"./PicaTask/PicaTaskMainPanel":535,"./PicaTask/PicaTaskMainPanel.ts":535,"./PicaTask/PicaTaskPanel":603,"./PicaTask/PicaTaskPanel.ts":603,"./PicaTask/PicaTaskSidePanel":604,"./PicaTask/PicaTaskSidePanel.ts":604,"./PicaTreasure/PicaTreasureAllOpenPanel":537,"./PicaTreasure/PicaTreasureAllOpenPanel.ts":537,"./PicaTreasure/PicaTreasureOpenPanel":538,"./PicaTreasure/PicaTreasureOpenPanel.ts":538,"./PicaTreasure/PicaTreasurePanel":605,"./PicaTreasure/PicaTreasurePanel.ts":605,"./PicaTreasure/PicaTreasurePreviewPanel":539,"./PicaTreasure/PicaTreasurePreviewPanel.ts":539,"./PicaWork/PicaWorkOldPanel":606,"./PicaWork/PicaWorkOldPanel.ts":606,"./PicaWork/PicaWorkPanel":650,"./PicaWork/PicaWorkPanel.ts":650,"./SinglePanel/PicaItemTipsPanel":536,"./SinglePanel/PicaItemTipsPanel.ts":536,"./SinglePanel/PicaSingleManager":486,"./SinglePanel/PicaSingleManager.ts":486,"./Task/TaskPanel":607,"./Task/TaskPanel.ts":607,"./index":491,"./index.ts":491,"./pica.Renderuimanager":555,"./pica.Renderuimanager.ts":555,"./pica.base.panel":480,"./pica.base.panel.ts":480};function webpackContext(t){var e=webpackContextResolve(t);return i(e)}function webpackContextResolve(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=652},,function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(437),a=i(334),s=function(){function EditorCanvasManager(t){this.render=t,this.AVATAR_CANVAS_TEST_DATA=[{id:"5facff1a67d3b140e835e1d0",parts:["head_hair"]}],this.AVATAR_CANVAS_RESOURCE_PATH="https://osd-alpha.tooqing.com",this.AVATAR_CANVAS_PARENT="avatarCanvas",this.SCENEKEY_SNAPSHOT="AvatarEditorSnapshotScene"}return EditorCanvasManager.prototype.destroy=function(){this.render.game&&(this.render.game.scene.stop(this.SCENEKEY_SNAPSHOT),this.render.game.scene.remove(this.SCENEKEY_SNAPSHOT))},EditorCanvasManager.prototype.createHeadIcon=function(t){var e=this;return new Promise((function(i,s){e.render.game.scene.getScene(e.SCENEKEY_SNAPSHOT)||e.render.game.scene.add(e.SCENEKEY_SNAPSHOT,n.b,!1),e.render.sceneManager.currentScene.scene.launch(e.SCENEKEY_SNAPSHOT,{onCreated:function(n){e.render.game.scene.sendToBack(e.SCENEKEY_SNAPSHOT);new a.a(n,e.AVATAR_CANVAS_RESOURCE_PATH,e.render.emitter,!1,t,(function(t){t.generateHeadIcon().then((function(n){i(n),t.destroy(),e.render.game.scene.stop(e.SCENEKEY_SNAPSHOT),e.render.game.scene.remove(e.SCENEKEY_SNAPSHOT)}))}))}})}))},EditorCanvasManager}()}]]);