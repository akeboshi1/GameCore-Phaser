/*! For license information please see game_v1.0.382.js.LICENSE.txt */
(this.webpackJsonpTooqingCore=this.webpackJsonpTooqingCore||[]).push([[0],Array(109).concat([function(t,i,o){!function webpackUniversalModuleDefinition(i,o){t.exports=o()}(window,(function(){return function(t){var i={};function __webpack_require__(o){if(i[o])return i[o].exports;var r=i[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=t,__webpack_require__.c=i,__webpack_require__.d=function(t,i,o){__webpack_require__.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,i){if(1&i&&(t=__webpack_require__(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(__webpack_require__.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)__webpack_require__.d(o,r,function(i){return t[i]}.bind(null,r));return o},__webpack_require__.n=function(t){var i=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(i,"a",i),i},__webpack_require__.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./lib/ui/ui-components.ts")}({"./lib/plugins/bbcodetext.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/bbcodetext/Factory.js"),a=o("./lib/plugins/gameobjects/text/bbcodetext/Creator.js"),h=o("./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");Phaser.GameObjects.GameObjectFactory.register("TooqingBBCodeText",r.default),Phaser.GameObjects.GameObjectCreator.register("TooqingBBCodeText",a.default),i.default=h.default},"./lib/plugins/behaviors/anchor/Anchor.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/anchor/GetViewport.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=Phaser.Geom.Rectangle,h=function(){function Anchor(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Anchor),this.gameObject=t,this.viewport=new a,this.resetFromJSON(i),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Anchor,[{key:"resetFromJSON",value:function resetFromJSON(t){var i,o,r,a,h,l,c,u;return void 0!==t.x?(i=null,o=t.x):void 0!==t.left?(i=0,o=t.left):void 0!==t.right?(i=1,o=t.right):void 0!==t.centerX&&(i=.5,o=t.centerX),void 0!==t.y?(r=null,a=t.y):void 0!==t.top?(r=0,a=t.top):void 0!==t.bottom?(r=1,a=t.bottom):void 0!==t.centerY&&(r=.5,a=t.centerY),void 0!==o&&(o=o.replace("left","0%").replace("right","100%").replace("center","50%").split("%"),h=parseFloat(o[0])/100,l=""===o[1]?0:parseFloat(o[1])),void 0!==a&&(a=a.replace("top","0%").replace("bottom","100%").replace("center","50%").split("%"),c=parseFloat(a[0])/100,u=""===a[1]?0:parseFloat(a[1])),this.setAlign(i,r),this.setPercentage(h,c),this.setOffset(l,u),this}},{key:"boot",value:function boot(){this.scaleManamger.on("resize",this.anchor,this),this.gameObject.on("destroy",this.destroy,this),this.anchor()}},{key:"shutdown",value:function shutdown(){this.scaleManamger.off("resize",this.anchor,this),this.gameObject=void 0}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setAlign",value:function setAlign(t,i){return this.alignX=t,this.alignY=i,this}},{key:"setPercentage",value:function setPercentage(t,i){return this.percentageX=t,this.percentageY=i,this}},{key:"setOffset",value:function setOffset(t,i){return this.offsetX=t,this.offsetY=i,this}},{key:"anchor",value:function anchor(){return Object(r.default)(this.scaleManamger,this.viewport),this.updatePosition(),this}},{key:"updatePosition",value:function updatePosition(){var t=this.gameObject;return null===this.alignX?t.x=this.anchorX:void 0!==this.alignX&&(t.x=this.anchorX+t.displayWidth*(t.originX-this.alignX)),null===this.alignY?this.gameObject.y=this.anchorY:void 0!==this.alignY&&(t.y=this.anchorY+t.displayHeight*(t.originY-this.alignY)),this}},{key:"scaleManamger",get:function get(){return this.gameObject.scene.scale}},{key:"anchorX",get:function get(){return this.viewport.x+this.viewport.width*this.percentageX+this.offsetX}},{key:"anchorY",get:function get(){return this.viewport.y+this.viewport.height*this.percentageY+this.offsetY}}]),Anchor}();i.default=h},"./lib/plugins/behaviors/anchor/GetViewport.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Geom.Rectangle;i.default=function GetViewport(t,i){void 0===i&&(i=new r);var o=t.canvasBounds,a=t.displayScale,h=t.autoCenter;return i.x=o.x>=0?0:-o.x*a.x,i.y=o.y>=0?0:-o.y*a.y,i.width=o.width*a.x-i.x,i.height=o.height*a.y-i.y,1!==h&&2!==h||(i.width-=i.x),1!==h&&3!==h||(i.height-=i.y),i}},"./lib/plugins/behaviors/fade/Fade.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/tween/TweenBase.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=Phaser.Utils.Objects.GetValue,h=Phaser.Utils.Objects.GetAdvancedValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Fade,t);var i=_createSuper(Fade);function Fade(t,o){var r;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Fade),(r=i.call(this,t)).gameObject=t,r.alphaStart=void 0,r.alphaEnd=void 0,r.resetFromJSON(o),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Fade,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setMode(a(t,"mode",0)),this.setAlphaRange(h(t,"start",this.gameObject.alpha),h(t,"end",0)),this.setDelay(h(t,"delay",0)),this.setDuration(h(t,"duration",1e3)),this}},{key:"toJSON",value:function toJSON(){return{mode:this.mode,start:this.alphaStart,end:this.alphaEnd,delay:this.delay,duration:this.duration}}},{key:"shutdown",value:function shutdown(){return _get(_getPrototypeOf(Fade.prototype),"shutdown",this).call(this),this.gameObject=void 0,this}},{key:"setMode",value:function setMode(t){return"string"==typeof t&&(t=c[t]),this.mode=t,this}},{key:"setAlphaRange",value:function setAlphaRange(t,i){return this.alphaStart=t,this.alphaEnd=i,this}},{key:"setDelay",value:function setDelay(t){return this.delay=t,this}},{key:"setDuration",value:function setDuration(t){return this.duration=t,this}},{key:"start",value:function start(){return this.isRunning||(this.gameObject.setAlpha(this.alphaStart),_get(_getPrototypeOf(Fade.prototype),"start",this).call(this,{targets:this.gameObject,alpha:this.alphaEnd,delay:this.delay,duration:this.duration,ease:"Linear",yoyo:2==this.mode,repeat:2==this.mode?-1:0})),this}},{key:"complete",value:function complete(){return _get(_getPrototypeOf(Fade.prototype),"complete",this).call(this),1===this.mode&&this.gameObject.destroy(),this}}]),Fade}(r.default),c={stop:0,destroy:1,yoyo:2};i.default=l},"./lib/plugins/behaviors/flip/Flip.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/tween/TweenBase.js"),a=o("./lib/plugins/behaviors/flip/GetFaceUpdatingCallback.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=Phaser.Utils.Objects.GetAdvancedValue,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Flip,t);var i=_createSuper(Flip);function Flip(t,o){var r;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Flip),(r=i.call(this,t,{eventEmitter:!0})).gameObject=t,r.resetFromJSON(o),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Flip,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setOrientation(h(t,"orientation",0)),this.setDelay(l(t,"delay",0)),this.setDuration(l(t,"duration",500)),this.setEase(h(t,"ease","Sine")),this.setFrontFace(h(t,"front",void 0)),this.setBackFace(h(t,"back",void 0)),this.setFace(h(t,"face",0)),this}},{key:"shutdown",value:function shutdown(){return _get(_getPrototypeOf(Flip.prototype),"shutdown",this).call(this),this.gameObject=void 0,this}},{key:"setOrientation",value:function setOrientation(t){return"string"==typeof t&&(t=u[t]),this.orientation=t,this}},{key:"setDelay",value:function setDelay(t){return this.delay=t,this}},{key:"setDuration",value:function setDuration(t){return this.duration=t,this}},{key:"setEase",value:function setEase(t){return void 0===t&&(t="Linear"),this.ease=t,this}},{key:"setFace",value:function setFace(t){return this.face=t,this}},{key:"toggleFace",value:function toggleFace(){var t=0===this.face?1:0;return this.setFace(t),this}},{key:"setFrontFace",value:function setFrontFace(t,i){return this.frontFaceCallback=Object(a.default)(t,i,this.gameObject),this}},{key:"setBackFace",value:function setBackFace(t,i){return this.backFaceCallback=Object(a.default)(t,i,this.gameObject),this}},{key:"start",value:function start(){if(this.isRunning)return this;var t={targets:this.gameObject,delay:this.delay,duration:this.duration/2,ease:this.ease,yoyo:!0,repeat:0,onYoyo:this.toggleFace,onYoyoScope:this};return t[0===this.orientation?"scaleX":"scaleY"]={from:1,to:0},_get(_getPrototypeOf(Flip.prototype),"start",this).call(this,t),this}},{key:"flip",value:function flip(t){return this.isRunning||(void 0!==t&&this.setDuration(t),this.start()),this}},{key:"face",get:function get(){return this._face},set:function set(t){"string"==typeof t&&(t=p[t]),this._face=t,0===t&&this.frontFaceCallback?this.frontFaceCallback(this.gameObject):1===t&&this.backFaceCallback&&this.backFaceCallback(this.gameObject)}}]),Flip}(r.default),u={x:0,horizontal:0,y:1,vertical:1},p={front:0,back:1};i.default=c},"./lib/plugins/behaviors/flip/GetFaceUpdatingCallback.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Utils.Objects.IsPlainObject,a=Phaser.Utils.Objects.GetValue;i.default=function GetFaceUpdatingCallback(t,i,o){var h;if(void 0===t)t=o.texture.key,i=o.frame.name;else if(r(t)){var l=t;t=a(l,"key",o.texture.key),i=a(l,"frame",o.frame.name)}else"string"==typeof t||(h=t);return void 0===h&&(h=function callback(o){o.setTexture(t,i)}),h}},"./lib/plugins/behaviors/scale/Scale.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/tween/TweenBase.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=Phaser.Utils.Objects.GetValue,h=Phaser.Utils.Objects.GetAdvancedValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Scale,t);var i=_createSuper(Scale);function Scale(t,o){var r;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Scale),(r=i.call(this,t)).gameObject=t,r.scaleStart={},r.scaleEnd={},r.resetFromJSON(o),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Scale,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setMode(a(t,"mode",0)),this.setScaleRange(h(t,"start",void 0),h(t,"end",0)),this.setDelay(h(t,"delay",0)),this.setDuration(h(t,"duration",1e3)),this.setEase(a(t,"ease",void 0)),this}},{key:"toJSON",value:function toJSON(){return{mode:this.mode,start:this.scaleStart,end:this.scaleEnd,delay:this.delay,duration:this.duration}}},{key:"setMode",value:function setMode(t){return"string"==typeof t&&(t=c[t]),this.mode=t,this}},{key:"setScaleRange",value:function setScaleRange(t,i){return"number"==typeof t?(this.scaleStart.x=t,this.scaleStart.y=t):(this.scaleStart.x=a(t,"x",this.gameObject.scaleX),this.scaleStart.y=a(t,"y",this.gameObject.scaleY)),"number"==typeof i?(this.scaleEnd.x=i,this.scaleEnd.y=i):(this.scaleEnd.x=a(i,"x",this.scaleStart.x),this.scaleEnd.y=a(i,"y",this.scaleStart.y)),this}},{key:"setDelay",value:function setDelay(t){return this.delay=t,this}},{key:"setDuration",value:function setDuration(t){return this.duration=t,this}},{key:"setEase",value:function setEase(t){return void 0===t&&(t="Linear"),this.ease=t,this}},{key:"start",value:function start(){return this.isRunning||(this.gameObject.setScale(this.scaleStart.x,this.scaleStart.y),_get(_getPrototypeOf(Scale.prototype),"start",this).call(this,{targets:this.gameObject,scaleX:this.scaleEnd.x,scaleY:this.scaleEnd.y,duration:this.duration,ease:this.ease,yoyo:2==this.mode,repeat:2==this.mode?-1:0})),this}},{key:"complete",value:function complete(){return _get(_getPrototypeOf(Scale.prototype),"complete",this).call(this),1===this.mode&&this.gameObject.destroy(),this}}]),Scale}(r.default),c={stop:0,destroy:1,yoyo:2};i.default=l},"./lib/plugins/behaviors/textedit/CreateInputText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/inputtext/InputText.js"),a=Phaser.Utils.Objects.GetValue,h=function GetHAlign(t){return t.hasOwnProperty("align")?t.align:t.hasOwnProperty("halign")?t.halign:"left"};i.default=function CreateInputText(t,i){void 0===i&&(i={});var o=t.scene,l=t.style,c=a(i,"backgroundColor",l.backgroundColor);null===c&&(c="transparent"),i.text=a(i,"text",t.text),i.fontFamily=a(i,"fontFamily",l.fontFamily),i.fontSize=a(i,"fontSize",l.fontSize),i.color=a(i,"color",l.color),i.backgroundColor=c,i.align=a(i,"align",h(l));var u=new r.default(o,t.x,t.y,a(i,"width",t.width),a(i,"height",t.height),i);return u.setOrigin(t.originX,t.originY),o.add.existing(u),u}},"./lib/plugins/behaviors/textedit/Edit.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/textedit/TextEdit.js");i.default=function Edit(t,i,o){return t._edit||(t._edit=new r.default(t)),t._edit.open(i,o),t._edit}},"./lib/plugins/behaviors/textedit/TextEdit.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/system/GetSceneObject.js"),a=o("./lib/plugins/behaviors/textedit/CreateInputText.js"),h=o("./lib/plugins/utils/object/IsFunction.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=Phaser.Utils.Objects.GetValue,c=function(){function TextEdit(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TextEdit),this.gameObject=t,this.scene=Object(r.default)(t),this.inputText=void 0,this.onClose=void 0,this.delayCall=void 0,this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TextEdit,[{key:"boot",value:function boot(){return this.gameObject.on("destroy",this.destroy,this),this}},{key:"shutdown",value:function shutdown(){return this.close(),this.gameObject=void 0,this.scene=void 0,u===this&&(u=void 0),this}},{key:"destroy",value:function destroy(){return this.shutdown(),this}},{key:"open",value:function open(t,i){void 0!==u&&u.close(),u=this,Object(h.default)(t)&&(i=t,t=void 0),void 0===i&&(i=l(t,"onClose",void 0));var o=l(t,"onTextChanged",void 0);return this.inputText=Object(a.default)(this.gameObject,t).on("textchange",(function(t){var i=t.text;o?o(this.gameObject,i):this.gameObject.text=i}),this).setFocus(),this.gameObject.setVisible(!1),this.onClose=i,this.scene.input.keyboard.once("keydown-ENTER",this.close,this),this.delayCall=this.scene.time.delayedCall(0,(function(){this.scene.input.once("pointerdown",this.close,this)}),[],this),this}},{key:"close",value:function close(){return u=void 0,this.inputText?(this.gameObject.setVisible(!0),this.inputText.destroy(),this.inputText=void 0,this.delayCall&&(this.delayCall.remove(),this.delayCall=void 0),this.scene.input.keyboard.off("keydown-ENTER",this.close,this),this.scene.input.off("pointerdown",this.close,this),this.onClose&&this.onClose(this.gameObject),this):this}},{key:"isOpened",get:function get(){return void 0!==this.inputText}},{key:"text",get:function get(){return this.isOpened?this.inputText.text:this.gameObject.text}}]),TextEdit}(),u=void 0;i.default=c},"./lib/plugins/dragspeed.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/dragspeed/DragSpeed.js");i.default=r.default},"./lib/plugins/fade-in.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/fade.js"),a=Phaser.Utils.Objects.IsPlainObject,h={};i.default=function FadeIn(t,i,o,l){var c,u;return a(o)?(c=o.start,u=o.end):u=o,void 0===c&&(c=0),void 0===u&&(u=t.alpha),h.mode=0,h.start=c,h.end=u,h.duration=i,void 0===l?l=new r.default(t,h):l.resetFromJSON(h),l.restart(),l}},"./lib/plugins/fade-out-destroy.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/fade.js"),a={};i.default=function FadeOutDestroy(t,i,o,h){return o instanceof r.default&&(h=o,o=void 0),void 0===o&&(o=!0),a.mode=o?1:0,a.end=0,a.duration=i,void 0===h?h=new r.default(t,a):h.resetFromJSON(a),h.restart(),h}},"./lib/plugins/fade.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/fade/Fade.js");i.default=r.default},"./lib/plugins/flip.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/flip/Flip.js");i.default=r.default},"./lib/plugins/fsm.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/logic/fsm/FSM.js");i.default=r.default},"./lib/plugins/gameobjects/canvas/Canvas.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/canvas/render/Render.js"),a=o("./lib/plugins/gameobjects/canvas/CanvasMethods.js"),h=o("./lib/plugins/gameobjects/canvas/TextureMethods.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Phaser.Display.Canvas.CanvasPool,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Canvas,t);var i=_createSuper(Canvas);function Canvas(t,o,r,a,h){var c;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Canvas),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=1),void 0===h&&(h=1),(c=i.call(this,t,"TooqingCanvas")).renderer=t.sys.game.renderer,c.resolution=t.sys.game.config.resolution,c.canvas=l.create(_assertThisInitialized(c),c.resolution*a,c.resolution*h),c.context=c.canvas.getContext("2d"),c.dirty=!1,c.setPosition(o,r),c.setSize(a,h),c.setOrigin(.5,.5),c.initPipeline(),c._crop=c.resetCropObject(),c.texture=t.sys.textures.addCanvas(null,c.canvas,!0),c.frame=c.texture.get(),c.frame.source.resolution=c.resolution,c.renderer&&c.renderer.gl&&(c.renderer.deleteTexture(c.frame.source.glTexture),c.frame.source.glTexture=null),c.dirty=!0,t.sys.game.events.on("contextrestored",(function(){this.dirty=!0}),_assertThisInitialized(c)),c}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Canvas,[{key:"getCanvas",value:function getCanvas(t){return t||(this.dirty=!0),this.canvas}},{key:"needRedraw",value:function needRedraw(){return this.dirty=!0,this}},{key:"preDestroy",value:function preDestroy(){l.remove(this.canvas)}},{key:"resize",value:function resize(t,i){return this.width===t&&this.height===i||(this.setSize(t,i).updateDisplayOrigin(),t*=this.resolution,i*=this.resolution,t=Math.max(Math.ceil(t),1),i=Math.max(Math.ceil(i),1),this.canvas.width=t,this.canvas.height=i,this.dirty=!0),this}}]),Canvas}(Phaser.GameObjects.GameObject),u=Phaser.GameObjects.Components;Phaser.Class.mixin(c,[u.Alpha,u.BlendMode,u.ComputedSize,u.Crop,u.Depth,u.Flip,u.GetBounds,u.Mask,u.Origin,u.Pipeline,u.ScrollFactor,u.Tint,u.Transform,u.Visible,r.default,a.default,h.default]),i.default=c},"./lib/plugins/gameobjects/canvas/CanvasMethods.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Display.Color;i.default={clear:function clear(){return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},fill:function fill(t){return this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this},getPixel:function getPixel(t,i,o){void 0===o&&(o=new r);var a=this.context.getImageData(t,i,1,1);return o.setTo(a.data[0],a.data[1],a.data[2],a.data[3]),o},setPixel:function setPixel(t,i,o,r,a,h){if("number"!=typeof o){var l=o;o=l.red,r=l.green,a=l.blue,h=l.alpha}void 0===h&&(h=0!==o||0!==r||0!==a?255:0);var c=this.context.createImageData(1,1);return c.data[0]=o,c.data[1]=r,c.data[2]=a,c.data[3]=h,this.context.putImageData(c,t,i),this.dirty=!0,this}}},"./lib/plugins/gameobjects/canvas/TextureMethods.js":function(t,i,o){"use strict";o.r(i),i.default={updateTexture:function updateTexture(t,i){t&&(i?t.call(i,this.canvas,this.context):t(this.canvas,this.context)),this.canvas.width===this.frame.width&&this.canvas.height===this.frame.height||this.frame.setSize(this.canvas.width,this.canvas.height),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(this.canvas,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!1;var o=this.input;return o&&!o.customHitArea&&(o.hitArea.width=this.width,o.hitArea.height=this.height),this},generateTexture:function generateTexture(t,i,o,r,a){var h,l=this.canvas,c=this.scene.sys,u=c.game.renderer;void 0===i&&(i=0),void 0===o&&(o=0),void 0===r?r=l.width:r*=this.resolution,void 0===a?a=l.height:a*=this.resolution;var p=(h=c.textures.exists(t)?c.textures.get(t):c.textures.createCanvas(t,r,a)).getSourceImage();p.width!==r&&(p.width=r),p.height!==a&&(p.height=a);var d=p.getContext("2d");return d.clearRect(0,0,r,a),d.drawImage(l,i,o,r,a),u.gl&&h&&u.canvasToTexture(p,h.source[0].glTexture,!0,0),this},loadTexture:function loadTexture(t,i){var o=this.scene.textures.getFrame(t,i);return o?(this.width!==o.cutWidth||this.height!==o.cutHeight?this.resize(o.cutWidth,o.cutHeight):this.context.clearRect(0,0,o.cutWidth,o.cutHeight),this.context.drawImage(o.source.image,o.cutX,o.cutY,o.cutWidth,o.cutHeight,0,0,this.canvas.width,this.canvas.height),this.dirty=!0,this):this}}},"./lib/plugins/gameobjects/canvas/render/CanvasRenderer.js":function(t,i,o){"use strict";o.r(i);i.default=function CanvasRenderer(t,i,o,r,a){0!==i.width&&0!==i.height&&t.batchSprite(i,i.frame,r,a)}},"./lib/plugins/gameobjects/canvas/render/Render.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/canvas/render/WebGLRenderer.js"),a=o("./lib/plugins/gameobjects/canvas/render/CanvasRenderer.js"),h=o("./lib/plugins/utils/object/NOOP.js"),l=h.default,c=h.default;l=r.default,c=a.default,i.default={renderWebGL:l,renderCanvas:c}},"./lib/plugins/gameobjects/canvas/render/WebGLRenderer.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Renderer.WebGL.Utils;i.default=function WebGLRenderer(t,i,o,a,h){if(i.dirty&&(i.updateTexture(),i.dirty=!1),0!==i.width&&0!==i.height){var l=i.frame,c=l.width,u=l.height,p=r.getTintAppendFloatAlpha;this.pipeline.batchTexture(i,l.glTexture,c,u,i.x,i.y,c/i.resolution,u/i.resolution,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.displayOriginX,i.displayOriginY,0,0,c,u,p(i._tintTL,a.alpha*i._alphaTL),p(i._tintTR,a.alpha*i._alphaTR),p(i._tintBL,a.alpha*i._alphaBL),p(i._tintBR,a.alpha*i._alphaBR),i._isTinted&&i.tintFill,0,0,a,h)}}},"./lib/plugins/gameobjects/containerlite/Active.js":function(t,i,o){"use strict";o.r(i),i.default={updateChildActive:function updateChildActive(t){return t.active=this.active&&this.getLocalState(t).active,this},syncActive:function syncActive(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildActive,this),this},resetChildActiveState:function resetChildActiveState(t){return this.getLocalState(t).active=t.active,this},setChildActive:function setChildActive(t,i){return t.active=i,this.resetChildActiveState(t),this},setChildLocalActive:function setChildLocalActive(t,i){return void 0===i&&(i=!0),this.getLocalState(t).active=i,this.updateChildActive(t),this}}},"./lib/plugins/gameobjects/containerlite/AddChild.js":function(t,i,o){"use strict";o.r(i),i.default={add:function add(t){return Array.isArray(t)?this.addMultiple(t):this._add(t),this},addMultiple:function addMultiple(t){return t.forEach(this._add,this),this},_add:function _add(t){return this.children.add(t),this.resetChildState(t).updateChildVisible(t).updateChildActive(t).updateChildScrollFactor(t).updateChildMask(t),this}}},"./lib/plugins/gameobjects/containerlite/Alpha.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/Scale.js");i.default={updateChildAlpha:function updateChildAlpha(t){return t.alpha=this.alpha*this.getLocalState(t).alpha,this},syncAlpha:function syncAlpha(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildAlpha,this),this},resetChildAlphaState:function resetChildAlphaState(t){return this.getLocalState(t).alpha=Object(r.default)(t.alpha,this.alpha),this},setChildAlpha:function setChildAlpha(t,i){return t.alpha=i,this.resetChildAlphaState(t),this._add},setChildLocalAlpha:function setChildLocalAlpha(t,i){return this.getLocalState(t).alpha=i,this.updateChildAlpha(t),this}}},"./lib/plugins/gameobjects/containerlite/ChildState.js":function(t,i,o){"use strict";o.r(i),i.default={getLocalState:function getLocalState(t){return t.hasOwnProperty("TooqingContainer")||(t.TooqingContainer={}),t.TooqingContainer},resetChildState:function resetChildState(t){return this.resetChildPositionState(t).resetChildVisibleState(t).resetChildAlphaState(t).resetChildActiveState(t),this},resetChildrenState:function resetChildrenState(t){for(var i=0,o=t.length;i<o;i++)this.resetChildState(t[i]);return this},syncProperties:function syncProperties(){return this.syncPosition().syncVisible().syncAlpha().syncActive().syncScrollFactor().syncMask(),this}}},"./lib/plugins/gameobjects/containerlite/Children.js":function(t,i,o){"use strict";function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function _unsupportedIterableToArray(t,i){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(t,i)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,i){(null==i||i>t.length)&&(i=t.length);for(var o=0,r=new Array(i);o<i;o++)r[o]=t[o];return r}o.r(i);var r=Phaser.Utils.Array;i.default={getChildren:function getChildren(){return this.children.getChildren()},getAllChildren:function getAllChildren(t){void 0===t&&(t=[]);for(var i,o=this.children.getChildren(),r=0,a=o.length;r<a;r++){var h;if(i=o[r],t.push(i),i.hasOwnProperty("isTooqingContainerLite"))(h=t).push.apply(h,_toConsumableArray(i.getAllChildren()))}return t},contains:function contains(t){if(this.children.contains(t))return!0;for(var i,o=this.children.getChildren(),r=0,a=o.length;r<a;r++)if((i=o[r]).isTooqingContainerLite&&i.contains(t))return!0;return!1},getByName:function getByName(t){return r.GetFirst(this.list,"name",t)},getRandom:function getRandom(t,i){return r.GetRandom(this.list,t,i)},getFirst:function getFirst(t,i,o,a){return r.GetFirstElement(this.list,t,i,o,a)},getAll:function getAll(t,i,o,a){return r.GetAll(this.list,t,i,o,a)},count:function count(t,i,o,a){return r.CountAllMatching(this.list,t,i,o,a)},swap:function swap(t,i){return r.Swap(this.list,t,i),this},moveTo:function moveTo(t,i){return r.MoveTo(this.list,t,i),this},setAll:function setAll(t,i,o,a){return r.SetAll(this.list,t,i,o,a),this}}},"./lib/plugins/gameobjects/containerlite/ContainerLite.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/AddChild.js"),a=o("./lib/plugins/gameobjects/containerlite/RemoveChild.js"),h=o("./lib/plugins/gameobjects/containerlite/ChildState.js"),l=o("./lib/plugins/gameobjects/containerlite/Transform.js"),c=o("./lib/plugins/gameobjects/containerlite/Position.js"),u=o("./lib/plugins/gameobjects/containerlite/Visible.js"),p=o("./lib/plugins/gameobjects/containerlite/Alpha.js"),d=o("./lib/plugins/gameobjects/containerlite/Active.js"),m=o("./lib/plugins/gameobjects/containerlite/ScrollFactor.js"),y=o("./lib/plugins/gameobjects/containerlite/Mask.js"),g=o("./lib/plugins/gameobjects/containerlite/Depth.js"),_=o("./lib/plugins/gameobjects/containerlite/Children.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function set(t,i,o,r){return(set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function set(t,i,o,r){var a,h=_superPropBase(t,i);if(h){if((a=Object.getOwnPropertyDescriptor(h,i)).set)return a.set.call(r,o),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(r,i)){if(!a.writable)return!1;a.value=o,Object.defineProperty(r,i,a)}else!function _defineProperty(t,i,o){i in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o;return t}(r,i,o);return!0})(t,i,o,r)}function _set(t,i,o,r,a){if(!set(t,i,o,r||t)&&a)throw new Error("failed to set property");return o}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=_superPropBase(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=Phaser.GameObjects.Zone,b=Phaser.GameObjects.Components,P=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(ContainerLite,t);var i=_createSuper(ContainerLite);function ContainerLite(t,o,r,a,h,l){var c;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,ContainerLite),Array.isArray(a)&&(l=a,a=void 0),void 0===a&&(a=1),void 0===h&&(h=1),(c=i.call(this,t,o,r,a,h)).children=t.add.group(),c.type="TooqingContainerLite",c.isTooqingContainerLite=!0,c.syncChildrenEnable=!0,c._flipX=!1,c._flipY=!1,c._alpha=1,c._active=!0,c._mask=null,c._scrollFactorX=1,c._scrollFactorY=1,l&&c.add(l),c}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(ContainerLite,[{key:"destroy",value:function destroy(t){this.scene&&(this.children.destroy(!t),this.children=void 0,_get(_getPrototypeOf(ContainerLite.prototype),"destroy",this).call(this,t))}},{key:"resize",value:function resize(t,i){return this.setSize(t,i),this}},{key:"x",get:function get(){return this._x},set:function set(t){this._x!==t&&(this._x=t,this.syncPosition())}},{key:"y",get:function get(){return this._y},set:function set(t){this._y!==t&&(this._y=t,this.syncPosition())}},{key:"rotation",get:function get(){return _get(_getPrototypeOf(ContainerLite.prototype),"rotation",this)},set:function set(t){this.rotation!==t&&(_set(_getPrototypeOf(ContainerLite.prototype),"rotation",t,this,!0),this.syncPosition())}},{key:"scaleX",get:function get(){return _get(_getPrototypeOf(ContainerLite.prototype),"scaleX",this)},set:function set(t){this.scaleX!==t&&(_set(_getPrototypeOf(ContainerLite.prototype),"scaleX",t,this,!0),this.syncPosition())}},{key:"scaleY",get:function get(){return _get(_getPrototypeOf(ContainerLite.prototype),"scaleY",this)},set:function set(t){this.scaleY!==t&&(_set(_getPrototypeOf(ContainerLite.prototype),"scaleY",t,this,!0),this.syncPosition())}},{key:"flipX",get:function get(){return this._flipX},set:function set(t){this._flipX!==t&&(this._flipX=t,this.syncPosition())}},{key:"flipY",get:function get(){return this._flipY},set:function set(t){this._flipY!==t&&(this._flipY=t,this.syncPosition())}},{key:"visible",get:function get(){return _get(_getPrototypeOf(ContainerLite.prototype),"visible",this)},set:function set(t){this.visible!==t&&(_set(_getPrototypeOf(ContainerLite.prototype),"visible",t,this,!0),this.syncVisible())}},{key:"alpha",get:function get(){return this._alpha},set:function set(t){this._alpha!==t&&(this._alpha=t,this.syncAlpha())}},{key:"active",get:function get(){return this._active},set:function set(t){this._active!==t&&(this._active=t,this.syncActive())}},{key:"mask",get:function get(){return this._mask},set:function set(t){this._mask!==t&&(this._mask=t,this.syncMask())}},{key:"scrollFactorX",get:function get(){return this._scrollFactorX},set:function set(t){this._scrollFactorX!==t&&(this._scrollFactorX=t,this.syncScrollFactor())}},{key:"scrollFactorY",get:function get(){return this._scrollFactorY},set:function set(t){this._scrollFactorY!==t&&(this._scrollFactorY=t,this.syncScrollFactor())}},{key:"list",get:function get(){return this.children.getChildren()}}]),ContainerLite}(v);Object.assign(P.prototype,r.default,a.default,h.default,l.default,c.default,u.default,p.default,m.default,d.default,y.default,g.default,_.default,b.Alpha,b.Flip),i.default=P},"./lib/plugins/gameobjects/containerlite/Depth.js":function(t,i,o){"use strict";o.r(i),i.default={setDepth:function setDepth(t){if(this.depth=t,this.children)for(var i=this.getAllChildren(),o=0,r=i.length;o<r;o++)i[o].depth=t;return this},swapDepth:function swapDepth(t){var i=this.depth,o=t.depth;return this.setDepth(o),t.setDepth(i),this},incDepth:function incDepth(t){if(this.depth+=t,this.children)for(var i=this.getAllChildren(),o=0,r=i.length;o<r;o++)i[o].depth+=t;return this}}},"./lib/plugins/gameobjects/containerlite/Mask.js":function(t,i,o){"use strict";o.r(i),i.default={updateChildMask:function updateChildMask(t){return null==this.mask||(this.mask.hasOwnProperty("geometryMask")?this.mask.geometryMask:this.mask.bitmapMask)!==t&&(t.mask=this.mask),this},syncMask:function syncMask(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildMask,this),this},setMask:function setMask(t){return this.mask=t,this},clearMask:function clearMask(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this}}},"./lib/plugins/gameobjects/containerlite/MaskChildren.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/mask/MaskToGameObject.js"),a=Phaser.Geom.Intersects.RectangleToRectangle,h=Phaser.Geom.Rectangle.Overlaps,l=function containsPoints(t,i){var o=0,r=i.top,a=i.bottom,h=i.left,l=i.right;return o+=t.contains(h,r)?1:0,o+=t.contains(h,a)?1:0,o+=t.contains(l,r)?1:0,o+=t.contains(l,a)?1:0},c=function showAll(t,i){t.setVisible(!0),t.clearMask&&t.clearMask()},u=function showSome(t,i){t.setVisible(!0),t.setMask&&t.setMask(i)},p=function showNone(t,i){t.setVisible(!1),t.clearMask&&t.clearMask()};i.default=function MaskChildren(t,i,o){if(i){void 0===o&&(o=t.getAllChildren());for(var d,m,y=t.getBounds(),g=Object(r.default)(i),_=0,v=o.length;_<v;_++)if(!(d=o[_]).hasOwnProperty("isTooqingContainerLite")&&d!==g){if(d.getBounds)switch(m=d.getBounds(m),l(y,m)){case 4:c(d,i);break;case 0:a(y,m)||h(y,m)?u(d,i):p(d,i);break;default:u(d,i)}else u(d,i);t.resetChildVisibleState(d).updateChildVisible(d)}}}},"./lib/plugins/gameobjects/containerlite/Position.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/Scale.js");i.default={updateChildPosition:function updateChildPosition(t){t.isTooqingContainerLite&&(t.syncChildrenEnable=!1);var i=this.getLocalState(t);return t.x=i.x,t.y=i.y,this.localToWorld(t),t.scaleX=i.scaleX*this.scaleX,t.scaleY=i.scaleY*this.scaleY,void 0!==t.flipX&&(t.flipX=this.flipX?!i.flipX:i.flipX,t.flipY=this.flipY?!i.flipY:i.flipY),t.rotation=i.rotation+this.rotation,t.isTooqingContainerLite&&(t.syncChildrenEnable=!0,t.syncPosition()),this},syncPosition:function syncPosition(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildPosition,this),this},resetChildPositionState:function resetChildPositionState(t){var i=this.getLocalState(t);return i.x=t.x,i.y=t.y,this.worldToLocal(i),i.scaleX=Object(r.default)(t.scaleX,this.scaleX),i.scaleY=Object(r.default)(t.scaleY,this.scaleY),void 0!==t.flipX&&(i.flipX=t.flipX,i.flipY=t.flipY),i.rotation=t.rotation-this.rotation,this},setChildPosition:function setChildPosition(t,i,o){return t.x=i,t.y=o,this.resetChildPositionState(t),this},setChildLocalPosition:function setChildLocalPosition(t,i,o){var r=this.getLocalState(t);return r.x=i,r.y=o,this.updateChildPosition(t),this}}},"./lib/plugins/gameobjects/containerlite/RemoveChild.js":function(t,i,o){"use strict";o.r(i),i.default={remove:function remove(t,i){return this.children.remove(t,!1,i),this},clear:function clear(t){return this.children.clear(!1,t),this}}},"./lib/plugins/gameobjects/containerlite/Scale.js":function(t,i,o){"use strict";o.r(i);i.default=function Scale(t,i){return t===i?1:t/i}},"./lib/plugins/gameobjects/containerlite/ScrollFactor.js":function(t,i,o){"use strict";o.r(i),i.default={updateChildScrollFactor:function updateChildScrollFactor(t){return t.setScrollFactor(this.scrollFactorX,this.scrollFactorY),this},syncScrollFactor:function syncScrollFactor(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildScrollFactor,this),this}}},"./lib/plugins/gameobjects/containerlite/Transform.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Math.RotateAround;i.default={worldToLocal:function worldToLocal(t){return t.x-=this.x,t.y-=this.y,r(t,0,0,-this.rotation),t.x/=this.scaleX,t.y/=this.scaleY,t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t},localToWorld:function localToWorld(t){return t.x*=this.flipX?-1:1,t.y*=this.flipY?-1:1,t.x*=this.scaleX,t.y*=this.scaleY,r(t,0,0,this.rotation),t.x+=this.x,t.y+=this.y,t}}},"./lib/plugins/gameobjects/containerlite/Visible.js":function(t,i,o){"use strict";o.r(i),i.default={updateChildVisible:function updateChildVisible(t){return t.visible=this.visible&&this.getLocalState(t).visible,this},syncVisible:function syncVisible(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildVisible,this),this},resetChildVisibleState:function resetChildVisibleState(t){return this.getLocalState(t).visible=t.visible,this},setChildVisible:function setChildVisible(t,i){return t.visible=i,this.resetChildVisibleState(t),this},setChildLocalVisible:function setChildLocalVisible(t,i){return void 0===i&&(i=!0),this.getLocalState(t).visible=i,this.updateChildVisible(t),this}}},"./lib/plugins/gameobjects/gridtable/Cell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/data/DataMethods.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function Cell(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Cell),this.container=null,this.setParent(t),this._deltaHeight=0}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Cell,[{key:"setParent",value:function setParent(t){this.parent=t,this.parentContainer=t.getParentContainer()}},{key:"destroy",value:function destroy(t){if(void 0===t&&(t=!1),!t){var i=this.parent;0!==this.deltaHeight&&i.nonZeroDeltaHeightCount--,this.destroyContainer()}this.data=void 0,this.container=null,this.parent=void 0,this.parentContainer=void 0}},{key:"getContainer",value:function getContainer(){return this.container}},{key:"setContainer",value:function setContainer(t){return t?(this.container&&this.container.destroy(),this.container=t,this.parentContainer.add(t),this):(this.destroyContainer(),this)}},{key:"destroyContainer",value:function destroyContainer(){return this.container&&(this.container.destroy(),this.container=null),this}},{key:"popContainer",value:function popContainer(){if(this.container){var t=this.container;return this.container=null,this.parentContainer.remove(t),t}return null}},{key:"setXY",value:function setXY(t,i){return this.container&&this.parentContainer.setChildLocalPosition(this.container,t,i),this}},{key:"setDeltaHeight",value:function setDeltaHeight(t){return this.deltaHeight=t,this}},{key:"setHeight",value:function setHeight(t){return this.height=t,this}},{key:"setWidth",value:function setWidth(t){return this.width=t,this}},{key:"table",get:function get(){return this.parent}},{key:"scrollMode",get:function get(){return this.parentContainer.scrollMode}},{key:"colIndx",get:function get(){return this.parent.cellIndxeToColIndex(this.index)}},{key:"rowIndx",get:function get(){return this.parent.cellIndxeToRowIndex(this.index)}},{key:"deltaHeight",get:function get(){return this._deltaHeight},set:function set(t){null==t&&(t=0);var i=this.parent;0===this._deltaHeight&&0!==t?i.nonZeroDeltaHeightCount++:0!==this._deltaHeight&&0===t&&i.nonZeroDeltaHeightCount--,this._deltaHeight=t}},{key:"height",get:function get(){return 0===this.scrollMode?this.deltaHeight+this.parent.defaultCellHeight:this.parent.defaultCellWidth},set:function set(t){1!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}},{key:"width",get:function get(){return 0===this.scrollMode?this.parent.defaultCellWidth:this.deltaHeight+this.parent.defaultCellHeight},set:function set(t){0!==this.scrollMode&&this.setDeltaHeight(t-this.parent.defaultCellHeight)}},{key:"scene",get:function get(){return this.parentContainer.scene}}]),Cell}();Object.assign(a.prototype,r.default),i.default=a},"./lib/plugins/gameobjects/gridtable/GridTable.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/ContainerLite.js"),a=o("./lib/plugins/gameobjects/gridtable/Table.js"),h=o("./lib/plugins/utils/mask/DefaultMask.js"),l=o("./lib/plugins/utils/size/ResizeGameObject.js"),c=o("./lib/plugins/utils/mask/MaskToGameObject.js"),u=o("./lib/plugins/gameobjects/gridtable/methods/Methods.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=r.default,d=Phaser.GameObjects.Components,m=Phaser.Structs.Set,y=Phaser.Utils.Objects.GetValue,g=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GridTable,t);var i=_createSuper(GridTable);function GridTable(t,o,r,h,l,c){var u;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GridTable),void 0===c&&(c={}),(u=i.call(this,t,o,r,h,l)).type="TooqingGridTable",u._tableOX=y(c,"tableOX",0),u._tableOY=y(c,"tableOY",0),u.visibleCells=new m,u.preVisibleCells=new m,u.visibleStartX=null,u.visibleEndX=null,u.visibleStartY=null,u.visibleEndY=null,u.lastVisibleCellIdx=null,u.execeedTopState=!1,u.execeedBottomState=!1,u.execeedLeftState=!1,u.execeedRightState=!1;var p=y(c,"reuseCellContainer",!1);u.cellContainersPool=p?t.add.group():void 0;var d=y(c,"cellVisibleCallback",null);if(null!==d){var g=y(c,"cellVisibleCallbackScope",void 0);u.on("cellvisible",d,g)}if(null!==(d=y(c,"cellInvisibleCallback",null))){g=y(c,"cellInvisibleCallbackScope",void 0);u.on("cellinvisible",d,g)}if(u.zoom=y(c,"zoom",1),u.cellsMask=void 0,u.setCellsMask(y(c,"mask",!0)),u.setScrollMode(y(c,"scrollMode",0)),u.setClampMode(y(c,"clamplTableOXY",!0)),0===u.scrollMode){var _=y(c,"cellWidth",void 0);if(u.expandCellSize=void 0===_,void 0===_){var v=y(c,"columns",1);c.cellWidth=u.width/v}}else{_=y(c,"cellHeight",void 0);var b=y(c,"cellWidth",void 0);u.expandCellSize=void 0===_,c.cellWidth=_,c.cellHeight=b}y(c,"cellOriginX",.5),y(c,"cellOriginY",.5);return u.table=new a.default(_assertThisInitialized(u),c),u.updateTable(),u}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GridTable,[{key:"destroy",value:function destroy(t){this.scene&&(this.table.destroy(t),this.table=void 0,this.cellContainersPool&&(this.cellContainersPool.destroy(!0),this.cellContainersPool=void 0),_get(_getPrototypeOf(GridTable.prototype),"destroy",this).call(this,t))}},{key:"setScrollMode",value:function setScrollMode(t){return"string"==typeof t&&(t=_[t.toLowerCase()]),this.scrollMode=t,this}},{key:"setClampMode",value:function setClampMode(t){return this.clampTableOXYMode=t,this}},{key:"setColumnCount",value:function setColumnCount(t){return this.table.setColumnCount(t),this}},{key:"setTableOXY",value:function setTableOXY(t,i){return this.setTableOY(i).setTableOX(t),this}},{key:"addTableOY",value:function addTableOY(t){return this.setTableOY(this.tableOY+t),this}},{key:"addTableOX",value:function addTableOX(t){return this.setTableOX(this.tableOX+t),this}},{key:"addTableOXY",value:function addTableOXY(t,i){return this.addTableOY(i).addTableOX(t),this}},{key:"setTableOYByPercentage",value:function setTableOYByPercentage(t){return this.setTableOY(-this.tableVisibleHeight*t),this}},{key:"getTableOYPercentage",value:function getTableOYPercentage(){var t=this.tableVisibleHeight;return 0===t?0:this.tableOY/-t}},{key:"getCells",value:function getCells(){return this.table.cells}},{key:"getCell",value:function getCell(t){return this.table.getCell(t,!0)}},{key:"getCellContainer",value:function getCellContainer(t){var i,o=this.table.getCell(t,!1);return o&&(i=o.getContainer()),i}},{key:"setCellHeight",value:function setCellHeight(t,i){return("number"==typeof t?this.table.getCell(t,!0):t).height=i,this}},{key:"setCellWidth",value:function setCellWidth(t,i){return("number"==typeof t?this.table.getCell(t,!0):t).width=i,this}},{key:"setCellsMask",value:function setCellsMask(t){var i,o;return!0===t?(i=!0,o=0):!1===t?i=!1:(i=y(t,"mask",!0),o=y(t,"padding",0)),i&&(this.cellsMaskGameObject=new h.default(this,0,o),this.cellsMask=this.cellsMaskGameObject.createGeometryMask()),this}},{key:"getCellsMaskGameObject",value:function getCellsMaskGameObject(){return this.cellsMaskGameObject}},{key:"resize",value:function resize(t,i){return this.width===t&&this.height===i||(_get(_getPrototypeOf(GridTable.prototype),"resize",this).call(this,t,i),this.cellsMask&&Object(l.default)(Object(c.default)(this.cellsMask),t*this.zoom,i*this.zoom),this.expandCellSize&&this.table.setDefaultCellWidth(this.instWidth/this.table.colCount),this.updateTable(!0)),this}},{key:"tableOY",get:function get(){return this._tableOY},set:function set(t){this.setTableOY(t).updateTable(!0)}},{key:"tableOX",get:function get(){return this._tableOX},set:function set(t){this.setTableOX(t).updateTable(!0)}},{key:"t",set:function set(t){this.setTableOYByPercentage(t).updateTable()},get:function get(){return this.getTableOYPercentage()}},{key:"cellsCount",get:function get(){return this.table.cellsCount}},{key:"columnCount",get:function get(){return this.table.colCount}},{key:"instHeight",get:function get(){return 0===this.scrollMode?this.height:this.width}},{key:"instWidth",get:function get(){return 0===this.scrollMode?this.width:this.height}},{key:"tableHeight",get:function get(){return this.table.totalRowsHeight}},{key:"tableWidth",get:function get(){return this.table.totalColumnWidth}},{key:"topTableOY",get:function get(){return 0}},{key:"bottomTableOY",get:function get(){return-this.tableVisibleHeight}},{key:"leftTableOX",get:function get(){return 0}},{key:"rightTableOX",get:function get(){return-this.tableVisibleWidth}},{key:"tableVisibleHeight",get:function get(){var t=this.tableHeight,i=this.instHeight;return t>i?t-i:0}},{key:"tableVisibleWidth",get:function get(){var t=this.tableWidth,i=this.instWidth;return t>i?t-i:0}},{key:"bottomLeftY",get:function get(){return-this.displayHeight*this.originY+this.displayHeight}},{key:"topRightX",get:function get(){return-this.displayWidth*this.originX+this.displayWidth}},{key:"topLeftX",get:function get(){return-this.displayWidth*this.originX}},{key:"topLeftY",get:function get(){return-this.displayHeight*this.originY}},{key:"bottomBound",get:function get(){return 0===this.scrollMode?this.bottomLeftY+this.originOffsetY:this.topRightX+this.originOffsetX}},{key:"rightBound",get:function get(){return 0===this.scrollMode?this.topRightX+this.originOffsetX:this.bottomLeftY+this.originOffsetY}},{key:"originOffsetX",get:function get(){var t=this.table;return t.defaultCellWidth*t.cellOriginX+t.padX}},{key:"originOffsetY",get:function get(){var t=this.table;return t.defaultCellHeight*t.cellOriginY+t.padY}}]),GridTable}(p);Object.assign(g.prototype,d.GetBounds,u.default);var _={v:0,vertical:0,h:1,horizontal:1};i.default=g},"./lib/plugins/gameobjects/gridtable/Table.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/Cell.js"),a=o("./lib/plugins/pool.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=Phaser.Utils.Objects.GetValue,l=Phaser.Utils.Array.SpliceOne,c=function(){function Table(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Table),this.parent=t,this.cells=[],this.cellPool=new a.default,this.resetFromJSON(i)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Table,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.colCount=void 0,this._nonZeroDeltaHeightCount=0,this.resetTotalRowsHeight(),this.zoom=h(t,"zoom",1),this.dpr=h(t,"dpr",1),this.cellOriginX=h(t,"cellOriginX",.5),this.cellOriginY=h(t,"cellOriginY",.5),this.padX=h(t,"cellPadX",0),this.padY=h(0,"cellPadY",0),this.setDefaultCellHeight(h(t,"cellHeight",30)),this.setDefaultCellWidth(h(t,"cellWidth",30)),this.initCells(h(t,"cellsCount",0)),this.setColumnCount(h(t,"columns",1)),this}},{key:"destroy",value:function destroy(t){for(var i=0,o=this.cells.length;i<o;i++)this.freeCell(this.cells[i],t);this.cellPool.destroy(),this.cells=void 0,this.parent=void 0}},{key:"setDefaultCellHeight",value:function setDefaultCellHeight(t){return this.defaultCellHeight=t,this}},{key:"setDefaultCellWidth",value:function setDefaultCellWidth(t){return this.defaultCellWidth=t,this}},{key:"initCells",value:function initCells(t){var i=this.cells;i.length=t;for(var o=0;o<t;o++)i[o]=null;return this}},{key:"insertNewCells",value:function insertNewCells(t,i){var o=this.cells;if(t===o.length){var r=t+i;o.length=r;for(var a=t;a<r;a++)o[a]=null}else{var h,l=[];l.length=i;for(a=0;a<i;a++)l[a]=null;(h=this.cells).splice.apply(h,[t,0].concat(l))}return this.resetTotalRowsHeight(),this}},{key:"removeCells",value:function removeCells(t,i){for(var o=t+i,r=t;r<o;r++)this.freeCell(r);return o===this.cells.length?this.cells.length=t:(1===i?l(this.cells,t):this.cells.splice(t,i),this.buildCellIndex(t)),this.resetTotalRowsHeight(),this}},{key:"setColumnCount",value:function setColumnCount(t){return this.colCount=t,this.resetTotalRowsHeight(),this}},{key:"isValidCellIdx",value:function isValidCellIdx(t){return t>=0&&t<this.cells.length}},{key:"heightToRowIndex",value:function heightToRowIndex(t,i){if(this.defaultCellHeightMode){var o=t/this.defaultCellHeight;return o=i?Math.ceil(o):Math.floor(o)}var r,a=this.rowCount,h=t;for(o=0;;){if(r=o>=0&&o<a,!((h-=this.getRowHeight(o))>0&&r)){if(0===h)return o;if(i){var l=o;(r=(o+=1)>=0&&o<a)||(o=l)}return o}o+=1}}},{key:"widthToColIndex",value:function widthToColIndex(t,i){var o=t/this.defaultCellWidth;return o=i?Math.ceil(o):Math.floor(o)}},{key:"colRowToCellIndex",value:function colRowToCellIndex(t,i){return t>=this.colCount?null:i*this.colCount+t}},{key:"rowIndexToHeight",value:function rowIndexToHeight(t,i){if(this.defaultCellHeightMode)return(i-t+1)*this.defaultCellHeight+this.defaultCellHeight*this.cellOriginY+this.padY;for(var o=0,r=t;r<=i;r++)o+=this.getRowHeight(r);return o+=this.getRowHeight(t)*this.cellOriginY}},{key:"colIndexToWidth",value:function colIndexToWidth(t,i){return(i-t+1)*this.defaultCellWidth+this.defaultCellWidth*this.cellOriginX+this.padX}},{key:"getRowHeight",value:function getRowHeight(t){var i=this.colCount;if(i<=1)return this.getCellHeight(this.colRowToCellIndex(0,t));for(var o,r=0,a=0;a<i;a++)r<(o=this.getCellHeight(this.colRowToCellIndex(a,t)))&&(r=o);return r}},{key:"getColWidth",value:function getColWidth(t){return this.defaultCellWidth}},{key:"getCellHeight",value:function getCellHeight(t){if(!this.isValidCellIdx(t))return 0;var i;if(this.defaultCellHeightMode)i=this.defaultCellHeight;else{var o=this.getCell(t,!1),r=o?o.deltaHeight:0;i=this.defaultCellHeight+r}return i}},{key:"resetTotalRowsHeight",value:function resetTotalRowsHeight(){this._totalRowsHeight=null}},{key:"cellIndxeToColIndex",value:function cellIndxeToColIndex(t){return t%this.colCount}},{key:"cellIndxeToRowIndex",value:function cellIndxeToRowIndex(t){return Math.floor(t/this.colCount)}},{key:"getCell",value:function getCell(t,i){if(!this.isValidCellIdx(t))return null;if(void 0===i&&(i=!0),null===this.cells[t]&&i){var o=this.newCell(t);this.cells[t]=o}return this.cells[t]}},{key:"newCell",value:function newCell(t){var i=this.cellPool.pop();return null===i?i=new r.default(this):i.setParent(this),i.index=t,i}},{key:"buildCellIndex",value:function buildCellIndex(t){void 0===t&&(t=0);for(var i,o=this.cells,r=t,a=o.length;r<a;r++)(i=o[r])&&(i.index=r);return this}},{key:"getParentContainer",value:function getParentContainer(){return this.parent}},{key:"freeCell",value:function freeCell(t,i){return"number"==typeof t&&(t=this.cells[t]),t?(t.destroy(i),i||this.cellPool.push(t),this):this}},{key:"nonZeroDeltaHeightCount",get:function get(){return this._nonZeroDeltaHeightCount},set:function set(t){this._nonZeroDeltaHeightCount!==t&&(this._nonZeroDeltaHeightCount=t,this.resetTotalRowsHeight())}},{key:"defaultCellHeightMode",get:function get(){return 0===this.nonZeroDeltaHeightCount}},{key:"rowCount",get:function get(){return Math.ceil(this.cells.length/this.colCount)}},{key:"cellsCount",get:function get(){return this.cells.length}},{key:"totalRowsHeight",get:function get(){if(null===this._totalRowsHeight)if(this.defaultCellHeightMode)this._totalRowsHeight=this.rowCount*this.defaultCellHeight+this.padY;else{for(var t=0,i=0;i<=this.rowCount;i++)t+=this.getRowHeight(i);this._totalRowsHeight=t}return this._totalRowsHeight}},{key:"totalColumnWidth",get:function get(){return this.colCount*this.defaultCellWidth+this.padX}}]),Table}();i.default=c},"./lib/plugins/gameobjects/gridtable/methods/EachCell.js":function(t,i,o){"use strict";o.r(i),o.d(i,"EachVisibleCell",(function(){return r})),o.d(i,"IterateVisibleCell",(function(){return a})),o.d(i,"EachCell",(function(){return h})),o.d(i,"IterateCell",(function(){return l}));var r=function EachVisibleCell(t,i){return this.visibleCells.each(t,i),this},a=function IterateVisibleCell(t,i){return this.visibleCells.iterate(t,i),this},h=function EachCell(t,i){return this.table.cells.slice().forEach(t,i),this},l=function IterateCell(t,i){return this.table.cells.forEach(t,i),this}},"./lib/plugins/gameobjects/gridtable/methods/InsertNewCells.js":function(t,i,o){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o.r(i);var r=Phaser.Math.Clamp;i.default=function InsertNewCells(t,i){return"object"===_typeof(t)&&(t=t.index),void 0===i&&(i=1),i<=0||(t=r(t,0,this.cellsCount),this.table.insertNewCells(t,i)),this}},"./lib/plugins/gameobjects/gridtable/methods/IsCellVisible.js":function(t,i,o){"use strict";o.r(i);i.default=function IsCellVisible(t){var i=this.table.getCell(t,!1);return i&&this.visibleCells.contains(i)}},"./lib/plugins/gameobjects/gridtable/methods/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/methods/SetTableOY.js"),a=o("./lib/plugins/gameobjects/gridtable/methods/SetTableOX.js"),h=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/UpdateTable.js"),l=o("./lib/plugins/gameobjects/gridtable/methods/IsCellVisible.js"),c=o("./lib/plugins/gameobjects/gridtable/methods/PointerToCell.js"),u=o("./lib/plugins/gameobjects/gridtable/methods/EachCell.js"),p=o("./lib/plugins/gameobjects/gridtable/methods/SetCellsCount.js"),d=o("./lib/plugins/gameobjects/gridtable/methods/InsertNewCells.js"),m=o("./lib/plugins/gameobjects/gridtable/methods/RemoveCells.js"),y=o("./lib/plugins/gameobjects/gridtable/methods/SetColumnCount.js"),g=o("./lib/plugins/gameobjects/gridtable/methods/SetGridSize.js");i.default={setTableOY:r.default,setTableOX:a.default,updateTable:h.default,isCellVisible:l.default,pointerToCellIndex:c.PointerToCellIndex,pointerToCellContainer:c.PointerToCellContainer,eachVisibleCell:u.EachVisibleCell,iterateVisibleCell:u.IterateVisibleCell,eachCell:u.EachCell,iterateCell:u.IterateCell,setCellsCount:p.default,insertNewCells:d.default,removeCells:m.default,setColumnCount:y.default,setGridSize:g.default}},"./lib/plugins/gameobjects/gridtable/methods/PointerToCell.js":function(t,i,o){"use strict";o.r(i),o.d(i,"PointerToCellIndex",(function(){return r})),o.d(i,"PointerToCellContainer",(function(){return a}));var r=function PointerToCellIndex(t,i){var o=this.getWorldTransformMatrix(),r=o.tx;i-=o.ty+this.topLeftY*this.zoom,t-=r+this.topLeftX*this.zoom;var a=this.tableOY*this.zoom-(0===this.scrollMode?i:t),h=this.tableOX*this.zoom-(0===this.scrollMode?t:i),l=this.table,c=l.heightToRowIndex(-a),u=l.widthToColIndex(-h),p=l.colRowToCellIndex(u,c);return null===p?null:this.isCellVisible(p)?p:null},a=function PointerToCellContainer(t,i){var o=r.call(this,t,i);if(null!==o)return this.getCellContainer(o)}},"./lib/plugins/gameobjects/gridtable/methods/RemoveCells.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i.default=function RemoveCells(t,i){if("object"===_typeof(t)&&(t=t.index),void 0===i&&(i=1),t<0&&(i+=t,t=0),i<=0)return this;if(t>this.cellsCount)return this;if(t<=this.lastVisibleCellIdx)for(var o,a=this.preVisibleCells,h=this.visibleCells,l=t,c=t+i;l<c;l++)(o=this.getCell(l,!1))&&(h.contains(o)&&(r.default.call(this,o),h.delete(o)),a.delete(o));return this.table.removeCells(t,i),this}},"./lib/plugins/gameobjects/gridtable/methods/SetCellsCount.js":function(t,i,o){"use strict";o.r(i);i.default=function SetCellsCount(t){var i=this.cellsCount;return i===t||(i>t?this.removeCells(t,i-t):this.insertNewCells(i,t-i)),this}},"./lib/plugins/gameobjects/gridtable/methods/SetColumnCount.js":function(t,i,o){"use strict";o.r(i);i.default=function SetColumnCount(t){return this.table.colCount===t||this.table.setColumnCount(t),this}},"./lib/plugins/gameobjects/gridtable/methods/SetGridSize.js":function(t,i,o){"use strict";o.r(i);i.default=function SetGridSize(t,i){return this.setCellsCount(t*i),this.table.setColumnCount(t),this}},"./lib/plugins/gameobjects/gridtable/methods/SetTableOX.js":function(t,i,o){"use strict";o.r(i);i.default=function SetTableOX(t){var i=this.table,o=this.leftTableOX,r=this.rightTableOX,a=t>this.leftTableOX,h=t<this.rightTableOX;this.clampTableOXYMode&&(i.colCount<i.widthToColIndex(this.instWidth,!0)?t=0:a?t=o:h&&(t=r));return this._tableOX!==t&&(this._tableOX=t),a&&(this.execeedLeftState||this.emit("execeedleft",this,t,o)),this.execeedLeftState=a,h&&(this.execeedRightState||this.emit("execeedright",this,t,r)),this.execeedRightState=h,this}},"./lib/plugins/gameobjects/gridtable/methods/SetTableOY.js":function(t,i,o){"use strict";o.r(i);i.default=function SetTableOY(t){var i=this.table,o=this.topTableOY,r=this.bottomTableOY,a=t>this.topTableOY,h=t<this.bottomTableOY;this.clampTableOXYMode&&(i.rowCount<i.heightToRowIndex(this.instHeight,!0)?t=0:a?t=o:h&&(t=r));return this._tableOY!==t&&(this._tableOY=t),a&&(this.execeedTopState||this.emit("execeedtop",this,t,o)),this.execeedTopState=a,h&&(this.execeedBottomState||this.emit("execeedbottom",this,t,r)),this.execeedBottomState=h,this}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js":function(t,i,o){"use strict";o.r(i);i.default=function HideCell(t){if(this.emit("cellinvisible",t),this.cellContainersPool){var i=t.popContainer();i&&this.cellContainersPool.killAndHide(i)}t.destroyContainer()}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/HideCells.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js");i.default=function HideCells(){var t=this.preVisibleCells,i=this.visibleCells;t.iterate((function(t){i.contains(t)||r.default.call(this,t)}),this)}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/MaskCells.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/MaskChildren.js");i.default=function MaskCells(){for(var t,i=[],o=this.visibleCells.entries,a=0,h=o.length;a<h;a++)(t=o[a].getContainer())&&(t.isTooqingContainerLite?t.getAllChildren(i):i.push(t));Object(r.default)(this,this.cellsMask,i)}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCell.js":function(t,i,o){"use strict";o.r(i);i.default=function ShowCell(t){var i=null;if(this.cellContainersPool&&null!==(i=this.cellContainersPool.getFirstDead())&&i.setActive(!0).setVisible(!0),this.emit("cellvisible",t,i),this.cellContainersPool){var o=t.getContainer();o?null===i?this.cellContainersPool.add(o):i!==o&&(this.cellContainersPool.add(o),this.cellContainersPool.killAndHide(i)):null!==i&&this.cellContainersPool.killAndHide(i)}}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCells.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCell.js"),a=function GetCellTLX(t){var i=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,t-1)+i},h=function GetCellTLY(t){var i=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,t-1)+i};i.default=function ShowCells(){if(0!==this.cellsCount){var t=this.table,i=t.heightToRowIndex(-this.tableOY);i<0&&(i=0);var o=t.widthToColIndex(-this.tableOX);o<0&&(o=0);var l=t.colRowToCellIndex(o,i),c=this.bottomBound,u=this.rightBound,p=t.cellsCount-1,d=t.colCount-1,m=a.call(this,o),y=m,g=h.call(this,i);for(this.visibleStartY=null,this.visibleEndY=null,this.visibleStartX=null,this.visibleEndX=null,this.lastVisibleCellIdx=null;g<c&&l<=p;){if(this.table.isValidCellIdx(l)){null===this.visibleStartY&&(this.visibleStartY=i,this.visibleEndY=i),null===this.visibleStartX&&(this.visibleStartX=o,this.visibleEndX=o),null===this.lastVisibleCellIdx&&(this.lastVisibleCellIdx=l),this.visibleEndY<i&&(this.visibleEndY=i),this.visibleEndX<o&&(this.visibleEndX=o),this.lastVisibleCellIdx<l&&(this.lastVisibleCellIdx=l);var _=t.getCell(l,!0);this.visibleCells.set(_),this.preVisibleCells.contains(_)||r.default.call(this,_),0===this.scrollMode?_.setXY(y,g):_.setXY(g,y)}y<u&&o<d?(y+=t.getColWidth(o),o+=1):(y=m,g+=t.getRowHeight(i),o=this.visibleStartX,i+=1),l=t.colRowToCellIndex(o,i)}}}},"./lib/plugins/gameobjects/gridtable/methods/updatetable/UpdateTable.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/HideCells.js"),a=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCells.js"),h=o("./lib/plugins/gameobjects/gridtable/methods/updatetable/MaskCells.js"),l=function ClearVisibleCellIndexes(){var t=this.preVisibleCells;this.preVisibleCells=this.visibleCells,this.visibleCells=t,this.visibleCells.clear()};i.default=function UpdateTable(t){return void 0===t&&(t=!1),t&&(l.call(this),r.default.call(this)),l.call(this),a.default.call(this),r.default.call(this),h.default.call(this),this}},"./lib/plugins/gameobjects/inputtext/InputText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/input/StopPropagationTouchEvents.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=Phaser.GameObjects.DOMElement,h=Phaser.Utils.Objects.IsPlainObject,l=Phaser.Utils.Objects.GetValue,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(InputText,t);var i=_createSuper(InputText);function InputText(t,o,a,c,m,y){var g;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,InputText),h(o)?(o=l(y=o,"x",0),a=l(y,"y",0),c=l(y,"width",void 0),m=l(y,"height",void 0)):h(c)&&(c=l(y=c,"width",void 0),m=l(y,"height",void 0)),void 0===y&&(y={});var _,v=t.scale.autoRound;void 0!==c&&(v&&(c=Math.floor(c)),y.width=c+"px"),void 0!==m&&(v&&(m=Math.floor(m)),y.height=m+"px");var b,P,w=l(y,"type","text");for(var S in"textarea"===w?(_=document.createElement("textarea")).style.resize="none":(_=document.createElement("input")).type=w,u)b=u[S],void 0!==(P=l(y,S,b[1]))&&(_[b[0]]=P);var C,T,k=l(y,"style",void 0);for(var S in void 0===k&&(k={}),p)C=p[S],void 0!==(T=l(y,S,C[1]))&&(k[C[0]]=T);var O=_.style;for(var S in y)S in u||S in p||S in O&&(k[S]=y[S]);k["box-sizing"]="border-box",(g=i.call(this,t,o,a,_,k)).type="TooqingInputText";var I=function _loop(t){g.node[d[t]]=function(){this.emit(t,this)}.bind(_assertThisInitialized(g))};for(var M in d)I(M);return Object(r.default)(g.node),g}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(InputText,[{key:"resize",value:function resize(t,i){var o=this.node.style;return o.width=t+"px",o.height=i+"px",this.updateSize(),this}},{key:"setText",value:function setText(t){return this.text=t,this}},{key:"selectText",value:function selectText(){return this.node.select(),this}},{key:"setPlaceholder",value:function setPlaceholder(t){return this.placeholder=t,this}},{key:"setTooltip",value:function setTooltip(t){return this.tooltip=t,this}},{key:"setTextChangedCallback",value:function setTextChangedCallback(t){return this.onTextChanged=t,this}},{key:"setReadOnly",value:function setReadOnly(t){return void 0===t&&(t=!0),this.readOnly=t,this}},{key:"setSpellCheck",value:function setSpellCheck(t){return this.spellCheck=t,this}},{key:"setStyle",value:function setStyle(t,i){return this.node.style[t]=i,this}},{key:"getStyle",value:function getStyle(t){return this.node.style[t]}},{key:"scrollToBottom",value:function scrollToBottom(){return this.node.scrollTop=this.node.scrollHeight,this}},{key:"setEnabled",value:function setEnabled(t){return void 0===t&&(t=!0),this.node.disabled=!t,this}},{key:"setBlur",value:function setBlur(){return this.node.blur(),this}},{key:"setFocus",value:function setFocus(){return this.node.focus(),this}},{key:"text",get:function get(){return this.node.value},set:function set(t){this.node.value=t}},{key:"placeholder",get:function get(){return this.node.placeholder},set:function set(t){this.node.placeholder=t}},{key:"tooltip",get:function get(){return this.node.title},set:function set(t){this.node.title=t}},{key:"readOnly",get:function get(){return this.node.readOnly},set:function set(t){this.node.readOnly=t}},{key:"spellCheck",get:function get(){return this.node.spellcheck},set:function set(t){this.node.spellcheck=t}}]),InputText}(a),u={id:["id",void 0],text:["value",void 0],placeholder:["placeholder",void 0],tooltip:["title",void 0],readOnly:["readonly",!1],spellCheck:["spellcheck",!1],autoComplete:["autocomplete","off"]},p={align:["textAlign",void 0],width:["width",void 0],height:["height",void 0],fontFamily:["fontFamily",void 0],fontSize:["font-size",void 0],color:["color","#ffffff"],backgroundColor:["backgroundColor","transparent"],borderColor:["borderColor","transparent"],outline:["outline","none"]},d={textchange:"oninput",click:"onclick",dblclick:"ondblclick",focus:"onfocus",blur:"onblur"};i.default=c},"./lib/plugins/gameobjects/ninepatch/NinePatch.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/ninepatch/texture/TextureMethods.js"),a=o("./lib/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js"),h=o("./lib/plugins/utils/object/IsArray.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Phaser.GameObjects.RenderTexture,c=Phaser.Utils.Objects.IsPlainObject,u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(NinePatch,t);var i=_createSuper(NinePatch);function NinePatch(t,o,r,a,l,p,d,m,y,g){var _;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,NinePatch),c(o)?(o=u(g=o,"x",0),r=u(g,"y",0),a=u(g,"width",1),l=u(g,"height",1),p=u(g,"key",void 0),d=u(g,"baseFrame",void 0),m=u(g,"columns",void 0),y=u(g,"rows",void 0)):c(a)?(a=u(g=a,"width",1),l=u(g,"height",1),p=u(g,"key",void 0),d=u(g,"baseFrame",void 0),m=u(g,"columns",void 0),y=u(g,"rows",void 0)):c(p)?(p=u(g=p,"key",void 0),d=u(g,"baseFrame",void 0),m=u(g,"columns",void 0),y=u(g,"rows",void 0)):c(d)?(d=u(g=d,"baseFrame",void 0),m=u(g,"columns",void 0),y=u(g,"rows",void 0)):Object(h.default)(d)?(g=y,y=m,m=d,d=u(g,"baseFrame",void 0)):c(m)&&(m=u(g=m,"columns",void 0),y=u(g,"rows",void 0)),(_=i.call(this,t,o,r,a,l)).columns={},_.rows={},_.stretchMode={},_._tileSprite=void 0,_._image=void 0,_.setOrigin(.5,.5),_.setGetFrameNameCallback(u(g,"getFrameNameCallback",void 0)),_.setStretchMode(u(g,"stretchMode",0)),_.setTexture(p,d,m,y),_}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(NinePatch,[{key:"setGetFrameNameCallback",value:function setGetFrameNameCallback(t){return void 0===t&&(t=a.default),this.getFrameNameCallback=t,this}},{key:"resize",value:function resize(t,i){return this.width===t&&this.height===i||(_get(_getPrototypeOf(NinePatch.prototype),"resize",this).call(this,t,i),this.updateTexture()),this}},{key:"minWidth",get:function get(){return this.columns.minWidth}},{key:"minHeight",get:function get(){return this.rows.minHeight}}]),NinePatch}(l);Object.assign(p.prototype,r.default),i.default=p},"./lib/plugins/gameobjects/ninepatch/texture/GetStretchMode.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/ninepatch/utils/IsEdge.js");i.default=function GetStretchMode(t,i){return r.default.call(this,t,i)?this.stretchMode.edge:this.stretchMode.internal}},"./lib/plugins/gameobjects/ninepatch/texture/SetStretchMode.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Utils.Objects.IsPlainObject,a=Phaser.Utils.Objects.GetValue,h=function parseMode(t){return"string"==typeof t&&(t=l[t]),t},l={scale:0,repeat:1};i.default=function SetStretchMode(t){return r(t)?(this.stretchMode.edge=h(a(t,"edge",0)),this.stretchMode.internal=h(a(t,"internal",0))):(t=h(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this}},"./lib/plugins/gameobjects/ninepatch/texture/SetTexture.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/object/IsArray.js");i.default=function SetTexture(t,i,o,a){Object(r.default)(i)&&(a=o,o=i,i=void 0),void 0===i&&(i="__BASE"),this.textureKey=t,this.baseFrameName=i,this.columns.data=o,this.columns.count=o?o.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=a,this.rows.count=a?a.length:0,this.rows.stretch=0,this.rows.minHeight=0;var h=this.scene.textures.get(t);if(!h)return this.clear(),this;if(!o||!a)return this.clear(),this;for(var l=h.frames[i],c=l.width,u=0,p=0,d=o.length;p<d;p++)void 0===o[p]?u++:"number"==typeof o[p]?c-=o[p]:c-=o[p].width;var m=c/u,y=l.height,g=0;for(p=0,d=a.length;p<d;p++)void 0===a[p]?g++:"number"==typeof a[p]?y-=a[p]:y-=a[p].width;for(var _,v,b,P,w,S=y/g,C=0,T=0,k=0,O=a.length;k<O;k++){void 0===a[k]&&(a[k]=S),"number"==typeof a[k]&&(a[k]={height:a[k],stretch:k%2}),b=(_=a[k]).height,this.rows.stretch+=0|_.stretch,this.rows.minHeight+=_.stretch>0?0:b,C=0;p=0;for(var I=o.length;p<I;p++)void 0===o[p]&&(o[p]=m),"number"==typeof o[p]&&(o[p]={width:o[p],stretch:p%2}),P=(v=o[p]).width,0===k&&(this.columns.stretch+=0|v.stretch,this.columns.minWidth+=v.stretch>0?0:P),P>=1&&b>=1?(w=this.getFrameNameCallback(p,k,i))&&h.add(w,0,C+l.cutX,T+l.cutY,P,b):console.warn("Size of Grid(".concat(p,",").concat(k,") = ").concat(P,"x").concat(b,", which is invalid")),C+=P;T+=b}return this.updateTexture(),this}},"./lib/plugins/gameobjects/ninepatch/texture/TextureMethods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/ninepatch/texture/SetTexture.js"),a=o("./lib/plugins/gameobjects/ninepatch/texture/UpdateTexture.js"),h=o("./lib/plugins/gameobjects/ninepatch/texture/SetStretchMode.js"),l=o("./lib/plugins/gameobjects/ninepatch/texture/GetStretchMode.js");i.default={setTexture:r.default,updateTexture:a.default,setStretchMode:h.default,getStretchMode:l.default}},"./lib/plugins/gameobjects/ninepatch/texture/UpdateTexture.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/renderTexture/MakeChildImageGameObject.js");i.default=function UpdateTexture(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var i,o,a=this.width-this.columns.minWidth;a>=0?(i=this.columns.stretch>0?a/this.columns.stretch:0,o=1):(i=0,o=this.width/this.columns.minWidth);var h,l,c,u,p,d,m,y=this.height-this.rows.minHeight;y>=0?(h=this.rows.stretch>0?y/this.rows.stretch:0,l=1):(h=0,l=this.height/this.rows.minHeight);for(var g,_=0,v=0,b=0,P=this.rows.count;b<P;b++){m=0===(p=this.rows.data[b]).stretch?p.height*l:h*p.stretch,_=0;for(var w=0,S=this.columns.count;w<S;w++)d=0===(u=this.columns.data[w]).stretch?u.width*o:i*u.stretch,(c=this.getFrameNameCallback(w,b,this.baseFrameName))&&d>0&&m>0&&t.has(c)&&(0===(0===p.stretch&&0===u.stretch||0===this.getStretchMode(w,b)?0:1)?(g=Object(r.default)(this,"_image","image")).setTexture(this.textureKey,c).setDisplaySize(d,m):(g=Object(r.default)(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,c).setSize(d,m)),g&&(this.draw(g,_,v),g=void 0),_+=d;v+=m}}},"./lib/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js":function(t,i,o){"use strict";o.r(i);i.default=function GetFrameNameCallback(t,i,o){return"__BASE"===o?"".concat(t,",").concat(i):"".concat(o,"_").concat(t,",").concat(i)}},"./lib/plugins/gameobjects/ninepatch/utils/IsEdge.js":function(t,i,o){"use strict";o.r(i);i.default=function IsEdge(t,i){return 0===t||t===this.columns.count-1||0===i||i===this.rows.count-1}},"./lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js"),a=o("./lib/plugins/gameobjects/shape/utils/LineTo.js"),h=o("./lib/plugins/gameobjects/shape/utils/ArcTo.js"),l=o("./lib/plugins/utils/geom/polygon/Earcut.js"),c=o("./lib/plugins/gameobjects/shape/roundrectangle/render/Render.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(RoundRectangle,Phaser.GameObjects.Shape);var i=_createSuper(RoundRectangle);function RoundRectangle(t,o,a,h,l,c,p,d){var m;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,RoundRectangle),void 0===o&&(o=0),void 0===a&&(a=0);var y=u(c,"iteration",void 0);c=u(c,"radius",c);var g=new r.default(0,0,h,l,c);return(m=i.call(this,t,"RoundRectangle",g)).setIteration(y),m.setPosition(o,a),void 0!==p&&m.setFillStyle(p,d),m.updateDisplayOrigin(),m.updateData(),m}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(RoundRectangle,[{key:"updateData",value:function updateData(){var t=this.geom,i=this.pathData;i.length=0;var o,r=t.cornerRadius,c=this.iteration+1;if(o=r.br,d(o)){var u=t.width-o.x,p=t.height-o.y;Object(h.default)(u,p,o.x,o.y,0,90,!1,c,i)}else Object(a.default)(t.width,t.height,i);if(o=r.bl,d(o)){u=o.x,p=t.height-o.y;Object(h.default)(u,p,o.x,o.y,90,180,!1,c,i)}else Object(a.default)(0,t.height,i);if(o=r.tl,d(o)){u=o.x,p=o.y;Object(h.default)(u,p,o.x,o.y,180,270,!1,c,i)}else Object(a.default)(0,0,i);if(o=r.tr,d(o)){u=t.width-o.x,p=o.y;Object(h.default)(u,p,o.x,o.y,270,360,!1,c,i)}else Object(a.default)(t.width,0,i);return i.push(i[0],i[1]),this.pathIndexes=Object(l.default)(i),this}},{key:"resize",value:function resize(t,i){if(void 0===i&&(i=t),this.geom.width===t&&this.geom.height===i)return this;this.geom.height=i,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var o=this.input;return o&&!o.customHitArea&&(o.hitArea.width=t,o.hitArea.height=i),this}},{key:"setIteration",value:function setIteration(t){return void 0===t&&(t=6),this.iteration=t,this}},{key:"setRadius",value:function setRadius(t){return void 0===t&&(t=0),this.radius=t,this}},{key:"setCornerRadius",value:function setCornerRadius(t){return this.setRadius(t)}},{key:"width",get:function get(){return this.geom.width},set:function set(t){this.resize(t,this.height)}},{key:"height",get:function get(){return this.geom.height},set:function set(t){this.resize(this.width,t)}},{key:"iteration",get:function get(){return this._iteration},set:function set(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}},{key:"radius",get:function get(){return this.geom.radius},set:function set(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}},{key:"cornerRadius",get:function get(){return this.geom.cornerRadius},set:function set(t){this.radius=t}}]),RoundRectangle}(),d=function isArcCorner(t){return 0!==t.x&&0!==t.y};Object.assign(p.prototype,c.default),i.default=p},"./lib/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js":function(t,i,o){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.r(i);var r=Phaser.Utils.Objects.GetValue,a=function(){function RoundRectangle(t,i,o,r,a){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,RoundRectangle),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,i,o,r,a)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(RoundRectangle,[{key:"setTo",value:function setTo(t,i,o,r,a){return this.setPosition(t,i),this.setRadius(a),this.setSize(o,r),this}},{key:"setPosition",value:function setPosition(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x=t,this.y=i,this}},{key:"setRadius",value:function setRadius(t){var i,o;void 0===t&&(t=0),"number"==typeof t?(i=t,o=t):(i=r(t,"x",0),o=r(t,"y",0));var a=this.cornerRadius;return a.tl=h(r(t,"tl",void 0),i,o),a.tr=h(r(t,"tr",void 0),i,o),a.bl=h(r(t,"bl",void 0),i,o),a.br=h(r(t,"br",void 0),i,o),this}},{key:"setSize",value:function setSize(t,i){return this.width=t,this.height=i,this}},{key:"minWidth",get:function get(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}},{key:"minHeight",get:function get(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}},{key:"width",get:function get(){return this._width},set:function set(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}},{key:"height",get:function get(){return this._height},set:function set(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}},{key:"radius",get:function get(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}}]),RoundRectangle}(),h=function GetRadius(t,i,o){return void 0===t?{x:i,y:o}:"number"==typeof t?{x:t,y:t}:t};i.default=a},"./lib/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/utils/FillStyleCanvas.js"),a=o("./lib/plugins/gameobjects/shape/utils/LineStyleCanvas.js"),h=Phaser.Renderer.Canvas.SetTransform;i.default=function PolygonCanvasRenderer(t,i,o,l,c){var u=t.currentContext;if(h(t,u,i,l,c)){var p=i._displayOriginX,d=i._displayOriginY,m=i.pathData,y=m.length-1,g=m[0]-p,_=m[1]-d;u.beginPath(),u.moveTo(g,_),i.closePath||(y-=2);for(var v=2;v<y;v+=2){var b=m[v]-p,P=m[v+1]-d;u.lineTo(b,P)}u.closePath(),i.isFilled&&(Object(r.default)(u,i),u.fill()),i.isStroked&&(Object(a.default)(u,i),u.stroke()),u.restore()}}},"./lib/plugins/gameobjects/shape/roundrectangle/render/Render.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js"),a=o("./lib/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js"),h=o("./lib/plugins/utils/object/NOOP.js"),l=h.default,c=h.default;l=r.default,c=a.default,i.default={renderWebGL:l,renderCanvas:c}},"./lib/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/utils/FillPathWebGL.js"),a=o("./lib/plugins/gameobjects/shape/utils/StrokePathWebGL.js");i.default=function PolygonWebGLRenderer(t,i,o,h,l){var c=this.pipeline,u=c._tempMatrix1,p=c._tempMatrix2,d=c._tempMatrix3;t.setPipeline(c),p.applyITRS(i.x,i.y,i.rotation,i.scaleX,i.scaleY),u.copyFrom(h.matrix),l?(u.multiplyWithOffset(l,-h.scrollX*i.scrollFactorX,-h.scrollY*i.scrollFactorY),p.e=i.x,p.f=i.y):(p.e-=h.scrollX*i.scrollFactorX,p.f-=h.scrollY*i.scrollFactorY),u.multiply(p,d);var m=i._displayOriginX,y=i._displayOriginY,g=h.alpha*i.alpha;i.isFilled&&Object(r.default)(c,d,i,g,m,y),i.isStroked&&Object(a.default)(c,i,g,m,y)}},"./lib/plugins/gameobjects/shape/utils/ArcTo.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/utils/LineTo.js"),a=o("./lib/plugins/utils/math/DegToRad.js");i.default=function ArcTo(t,i,o,h,l,c,u,p,d){var m,y,g;u&&(c+=360),l=Object(a.default)(l);for(var _=((c=Object(a.default)(c))-l)/p,v=0;v<=p;v++)g=l+_*v,m=t+o*Math.cos(g),y=i+h*Math.sin(g),Object(r.default)(m,y,d);return d}},"./lib/plugins/gameobjects/shape/utils/FillPathWebGL.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Renderer.WebGL.Utils;i.default=function FillPathWebGL(t,i,o,a,h,l){for(var c=r.getTintAppendFloatAlphaAndSwap(o.fillColor,o.fillAlpha*a),u=o.pathData,p=o.pathIndexes,d=0;d<p.length;d+=3){var m=2*p[d],y=2*p[d+1],g=2*p[d+2],_=u[m+0]-h,v=u[m+1]-l,b=u[y+0]-h,P=u[y+1]-l,w=u[g+0]-h,S=u[g+1]-l,C=i.getX(_,v),T=i.getY(_,v),k=i.getX(b,P),O=i.getY(b,P),I=i.getX(w,S),M=i.getY(w,S);t.setTexture2D(),t.batchTri(C,T,k,O,I,M,0,0,1,1,c,c,c,t.tintEffect)}}},"./lib/plugins/gameobjects/shape/utils/FillStyleCanvas.js":function(t,i,o){"use strict";o.r(i);i.default=function FillStyleCanvas(t,i,o,r){var a=o||i.fillColor,h=r||i.fillAlpha,l=(16711680&a)>>>16,c=(65280&a)>>>8,u=255&a;t.fillStyle="rgba("+l+","+c+","+u+","+h+")"}},"./lib/plugins/gameobjects/shape/utils/LineStyleCanvas.js":function(t,i,o){"use strict";o.r(i);i.default=function LineStyleCanvas(t,i,o,r){var a=o||i.strokeColor,h=r||i.strokeAlpha,l=(16711680&a)>>>16,c=(65280&a)>>>8,u=255&a;t.strokeStyle="rgba("+l+","+c+","+u+","+h+")",t.lineWidth=i.lineWidth}},"./lib/plugins/gameobjects/shape/utils/LineTo.js":function(t,i,o){"use strict";o.r(i);i.default=function LineTo(t,i,o){var r=o.length;if(r>=2){var a=o[r-2],h=o[r-1];if(t===a&&i===h)return o}return o.push(t,i),o}},"./lib/plugins/gameobjects/shape/utils/StrokePathWebGL.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Renderer.WebGL.Utils;i.default=function StrokePathWebGL(t,i,o,a,h){var l=t.strokeTint,c=r.getTintAppendFloatAlphaAndSwap(i.strokeColor,i.strokeAlpha*o);l.TL=c,l.TR=c,l.BL=c,l.BR=c;var u=i.pathData,p=u.length-1,d=i.lineWidth,m=d/2,y=u[0]-a,g=u[1]-h;i.closePath||(p-=2);for(var _=2;_<p;_+=2){var v=u[_]-a,b=u[_+1]-h;t.setTexture2D(),t.batchLine(y,g,v,b,m,m,d,_-2,!!i.closePath&&_===p-1),y=v,g=b}}},"./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/Text.js"),a=o("./lib/plugins/gameobjects/text/bbcodetext/parser.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(BBCodeText,t);var i=_createSuper(BBCodeText);function BBCodeText(t,o,r,h,l){return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,BBCodeText),i.call(this,t,o,r,h,l,"TooqingBBCodeText",a.default)}return BBCodeText}(r.default);i.default=h},"./lib/plugins/gameobjects/text/bbcodetext/Creator.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js"),a=Phaser.Utils.Objects.GetAdvancedValue,h=Phaser.GameObjects.BuildGameObject;i.default=function(t,i){var o=a(t,"text",""),l=a(t,"style",null),c=a(t,"padding",null);null!==c&&(l.padding=c),void 0!==i&&(t.add=i);var u=new r.default(this.scene,0,0,o,l);return h(this.scene,u,t),u.autoRound=a(t,"autoRound",!0),u.resolution=a(t,"resolution",1),u}},"./lib/plugins/gameobjects/text/bbcodetext/Factory.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");i.default=function(t,i,o,a){var h=new r.default(this.scene,t,i,o,a);return this.scene.add.existing(h),h}},"./lib/plugins/gameobjects/text/bbcodetext/parser.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js"),a={plainText:null,prevProp:null},h=new r.default,l={},c={splitText:function splitText(t,i){for(var o,r,a=[],h=0,l=t.length,c=l;o=d.exec(t);)r=o[0],h<(c=d.lastIndex-r.length)&&a.push(t.substring(h,c)),void 0===i&&a.push(r),h=d.lastIndex;return h<l&&a.push(t.substring(h,l)),a},tagTextToProp:function tagTextToProp(t,i){var o,r;null==i&&(i={}),i.img&&u(i,L,"img"),m.test(t)?(u(i,A,"b",!0),o=""):y.test(t)?(u(i,L,"b"),o=""):g.test(t)?(u(i,A,"i",!0),o=""):_.test(t)?(u(i,L,"i"),o=""):v.test(t)?(r=t.match(v),u(i,A,"size",r[1]+"px"),o=""):b.test(t)?(u(i,L,"size"),o=""):P.test(t)?(r=t.match(P),u(i,A,"color",r[1]),o=""):w.test(t)?(u(i,L,"color"),o=""):S.test(t)?(r=t.match(S),u(i,A,"u",!0),o=""):C.test(t)?(r=t.match(C),u(i,A,"u",r[1]),o=""):T.test(t)?(u(i,L,"u"),o=""):k.test(t)?(u(i,A,"shadow",!0),o=""):O.test(t)?(u(i,L,"shadow"),o=""):I.test(t)?(u(i,A,"stroke",!0),o=""):M.test(t)?(r=t.match(M),u(i,A,"stroke",r[1]),o=""):E.test(t)?(u(i,L,"stroke"),o=""):x.test(t)?(r=t.match(x),u(i,A,"img",r[1]),o=""):B.test(t)?(u(i,L,"img"),o=""):R.test(t)?(r=t.match(R),u(i,A,"area",r[1]),o=""):D.test(t)?(u(i,L,"area"),o=""):o=t;var h=a;return h.plainText=o,h.prop=i,h},propToContextStyle:function propToContextStyle(t,i){var o=h;if(i.hasOwnProperty("img"))o.image=i.img;else{if(o.image=null,i.hasOwnProperty("family")?o.fontFamily=i.family:o.fontFamily=t.fontFamily,i.hasOwnProperty("size")){var r=i.size;"number"==typeof r&&(r=r.toString()+"px"),o.fontSize=r}else o.fontSize=t.fontSize;o.fontStyle=p(i.b,i.i),i.hasOwnProperty("color")?o.color=i.color:o.color=t.color,i.hasOwnProperty("stroke")?!0===i.stroke?(o.stroke=t.stroke,o.strokeThickness=t.strokeThickness):(o.stroke=i.stroke,o.strokeThickness=t.strokeThickness):(o.stroke=t.stroke,o.strokeThickness=0)}return i.hasOwnProperty("shadow")?!0===i.shadow?(o.shadowColor=t.shadowColor,o.shadowOffsetX=t.shadowOffsetX,o.shadowOffsetY=t.shadowOffsetY,o.shadowBlur=t.shadowBlur,o.shadowStroke=!0,o.shadowFill=!0):(o.shadowColor=i.shadow,o.shadowOffsetX=t.shadowOffsetX,o.shadowOffsetY=t.shadowOffsetY,o.shadowBlur=t.shadowBlur,o.shadowStroke=!0,o.shadowFill=!0):(o.shadowColor="#000",o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=0,o.shadowStroke=!1,o.shadowFill=!1),i.hasOwnProperty("u")?!0===i.u?(o.underlineColor=t.underlineColor,o.underlineThickness=t.underlineThickness,o.underlineOffset=t.underlineOffset):(o.underlineColor=i.u,o.underlineThickness=t.underlineThickness,o.underlineOffset=t.underlineOffset):(o.underlineColor="#000",o.underlineThickness=0,o.underlineOffset=0),o},propToTagText:function propToTagText(t,i,o){for(var r in null==o&&(o=l),o)i.hasOwnProperty(r)||(t="[/"+r+"]"+t);var a="";for(var r in i)o[r]!==i[r]&&("size"===r?a+="[size="+i[r].replace("px","")+"]":"color"===r||"stroke"===r||"img"===r?a+="["+r+"="+i[r]+"]":"u"===r?!0===i[r]?a+="[u]":a+="[u="+i[r]+"]":a+="["+r+"]");return t=a+t}},u=function updateProp(t,i,o,r){return i===A?t[o]=r:t.hasOwnProperty(o)&&delete t[o],t},p=function getFontStyle(t,i){return t&&i?"bold italic":t?"bold":i?"italic":""},d=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]|\[area=([^\]]+)\]|\[\/area\]/gi,m=/\[b\]/i,y=/\[\/b\]/i,g=/\[i\]/i,_=/\[\/i\]/i,v=/\[size=(\d+)\]/i,b=/\[\/size\]/i,P=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,w=/\[\/color\]/i,S=/\[u\]/i,C=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,T=/\[\/u\]/i,k=/\[shadow\]/i,O=/\[\/shadow\]/i,I=/\[stroke\]/i,M=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,E=/\[\/stroke\]/i,x=/\[img=([^\]]+)\]/i,B=/\[\/img\]/i,R=/\[area=([^\]]+)\]/i,D=/\[\/area\]/i,L=!1,A=!0;i.default=c},"./lib/plugins/gameobjects/text/tagtext/Parser.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a={plainText:null,prevProp:null},h=new r.default,l=function(){function parser(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,parser),void 0===t&&(t={}),this.tags=t}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(parser,[{key:"addTag",value:function addTag(t,i){this.tags[t]=i}},{key:"splitText",value:function splitText(t,i){for(var o,r,a,h=[],l=0,c=t.length,u=c;o=p.exec(t);)r=o[0],l<(u=p.lastIndex-r.length)&&h.push(t.substring(l,u)),void 0===i?h.push(r):1===i&&(d.test(r)?(a=r.match(m),h.push(a[2])):y.test(r)&&(a=r.match(g),h.push(a[2]))),l=p.lastIndex;return l<c&&h.push(t.substring(l,c)),h}},{key:"tagTextToProp",value:function tagTextToProp(t,i){var o,r;if(d.test(t)){if(null!=(u=t.match(m))){var h=u[1],l=this.tags;(r=l.hasOwnProperty(h)?l[h]:{})._class=h,o=u[2]}}else if(y.test(t)){var u;if(null!=(u=t.match(g))){var p=u[1];(r=c(p))._style=p,o=u[2]}}null==o&&(o=t),null==r&&(r={});var _=a;return _.plainText=o,_.prop=r,_}},{key:"propToContextStyle",value:function propToContextStyle(t,i){var o=h;if(i.hasOwnProperty("img"))o.image=i.img;else{if(o.image=null,i.hasOwnProperty("family")||i.hasOwnProperty("fontFamily")||i.hasOwnProperty("font-family")){var r=i.hasOwnProperty("family")?i.family:i.hasOwnProperty("fontFamily")?i.fontFamily:i["font-family"];o.fontFamily=r}else o.fontFamily=t.fontFamily;if(i.hasOwnProperty("size")||i.hasOwnProperty("fontSize")||i.hasOwnProperty("font-size")){var a=i.hasOwnProperty("size")?i.size:i.hasOwnProperty("fontSize")?i.fontSize:i["font-size"];"number"==typeof a&&(a=a.toString()+"px"),o.fontSize=a}else o.fontSize=t.fontSize;if(i.hasOwnProperty("style")||i.hasOwnProperty("fontStyle")||i.hasOwnProperty("font-style")){var l=i.hasOwnProperty("style")?i.style:i.hasOwnProperty("fontStyle")?i.fontStyle:i["font-style"];o.fontStyle=l}else o.fontStyle=t.fontStyle;if(i.hasOwnProperty("color")||i.hasOwnProperty("font-color")){i.hasOwnProperty("color")?i.color:i["font-color"];o.color=i.color}else o.color=t.color;if(i.hasOwnProperty("stroke")){var c=i.stroke;o.stroke=c.hasOwnProperty("color")?c.color:t.stroke,o.strokeThickness=c.hasOwnProperty("thinkness")?c.thinkness:t.strokeThickness}else o.stroke=t.stroke,o.strokeThickness=t.strokeThickness}if(i.hasOwnProperty("shadow")){var u=i.shadow;o.shadowColor=u.hasOwnProperty("color")?u.color:t.shadowColor,o.shadowOffsetX=u.hasOwnProperty("offsetX")?u.offsetX:t.shadowOffsetX,o.shadowOffsetY=u.hasOwnProperty("offsetY")?u.offsetY:t.shadowOffsetY,o.shadowBlur=u.hasOwnProperty("blur")?u.blur:t.shadowBlur,o.shadowStroke=!0,o.shadowFill=!0}else o.shadowColor=t.shadowColor,o.shadowOffsetX=t.shadowOffsetX,o.shadowOffsetY=t.shadowOffsetY,o.shadowBlur=t.shadowBlur,o.shadowStroke=t.shadowStroke,o.shadowFill=t.shadowFill;if(i.hasOwnProperty("u")||i.hasOwnProperty("underline")){var p=i.hasOwnProperty("u")?i.u:i.underline;o.underlineColor=p.hasOwnProperty("color")?p.color:t.underlineColor,o.underlineThickness=p.hasOwnProperty("thinkness")?p.thinkness:t.underlineThickness,o.underlineOffset=p.hasOwnProperty("offset")?p.offset:t.underlineOffset}else o.underlineColor=t.underlineColor,o.underlineThickness=t.underlineThickness,o.underlineOffset=t.underlineOffset;return o}},{key:"propToTagText",value:function propToTagText(t,i,o){return i.hasOwnProperty("_class")?""===t&&this.isTextTag(i._class)?"":"<class='"+i._class+"'>"+t+"</class>":i.hasOwnProperty("_style")?"<style='"+i._style+"'>"+t+"</style>":void 0}},{key:"destroy",value:function destroy(){this.tags=void 0}},{key:"isTextTag",value:function isTextTag(t){var i=this.tags[t];return!!i&&null==i.img}}]),parser}(),c=function styleToProp(t){for(var i,o,r,a={},h=0,l=(t=t.split(";")).length;h<l;h++)if(o=(i=t[h].split(":"))[0],r=i[1],!u(o)&&!u(r)){switch(o){case"stroke":var c=r.split(" ");r={},(d=c.length)>=1&&(r.color=c[0]),d>=2&&(r.thinkness=parseInt(c[1].replace("px","")));break;case"shadow":var p=r.split(" ");r={},(d=p.length)>=1&&(r.color=p[0]),d>=2&&(r.offsetX=parseInt(p[1].replace("px",""))),d>=3&&(r.offsetY=parseInt(p[2].replace("px",""))),d>=4&&(r.blur=parseInt(p[3].replace("px","")));break;case"u":case"underline":var d,m=r.split(" ");r={},(d=m.length)>=1&&(r.color=m[0]),d>=2&&(r.thinkness=parseInt(m[1].replace("px",""))),d>=3&&(r.offset=parseInt(m[2].replace("px","")))}a[o]=r}return a},u=function isEmpty(t){return 0===(t=t.replace(_,"")).length},p=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>|<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/g,d=/<\s*class=/i,m=/<\s*class=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/class\s*\>/,y=/<\s*style=/i,g=/<\s*style=["|']([^"|']+)["|']\s*\>([\s\S]*?)<\s*\/style\s*\>/,_=/^\s+|\s+$/;i.default=l},"./lib/plugins/gameobjects/text/tagtext/TagText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/Text.js"),a=o("./lib/plugins/gameobjects/text/tagtext/Parser.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(TagText,t);var i=_createSuper(TagText);function TagText(t,o,r,l,c){var u;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TagText);var p=h(c,"tags",void 0),d=new a.default(p);return(u=i.call(this,t,o,r,l,c,"TooqingTagText",d)).parser=d,u}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TagText,[{key:"addTag",value:function addTag(t,i){return this.parser.addTag(t,i),this.updateText(!0)}},{key:"addTags",value:function addTags(t){for(var i in t)this.parser.addTag(i,t[i]);return this.updateText(!0)}},{key:"preDestroy",value:function preDestroy(){_get(_getPrototypeOf(TagText.prototype),"preDestroy",this).call(this),this.parser.destroy(),this.parser=void 0}}]),TagText}(r.default);i.default=l},"./lib/plugins/gameobjects/text/textbase/Text.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/render/Render.js"),a=o("./lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js"),h=o("./lib/plugins/gameobjects/text/textbase/canvastext/CanvasText.js"),l=o("./lib/plugins/pool.js"),c=o("./lib/plugins/gameobjects/text/textbase/const.js"),u=o("./lib/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function set(t,i,o,r){return(set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function set(t,i,o,r){var a,h=_superPropBase(t,i);if(h){if((a=Object.getOwnPropertyDescriptor(h,i)).set)return a.set.call(r,o),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(r,i)){if(!a.writable)return!1;a.value=o,Object.defineProperty(r,i,a)}else!function _defineProperty(t,i,o){i in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o;return t}(r,i,o);return!0})(t,i,o,r)}function _set(t,i,o,r,a){if(!set(t,i,o,r||t)&&a)throw new Error("failed to set property");return o}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=_superPropBase(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=Phaser.DOM.AddToDOM,d=Phaser.Display.Canvas.CanvasPool,m=Phaser.GameObjects.GameObject,y=Phaser.Utils.Objects.GetValue,g=Phaser.DOM.RemoveFromDOM,_=c.default.SPLITREGEXP,v={},b=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Text,t);var i=_createSuper(Text);function Text(t,o,r,c,u,p,m){var y;if(function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Text),void 0===o&&(o=0),void 0===r&&(r=0),(y=i.call(this,t,p)).renderer=t.sys.game.renderer,y.setPosition(o,r),y.setOrigin(0,0),y.initPipeline(),y.canvas=d.create(_assertThisInitialized(y)),y.context=y.canvas.getContext("2d"),u&&u.hasOwnProperty("align")){var g=u.align;delete u.align,u.halign=g}return y.style=new a.default(_assertThisInitialized(y),u),y.autoRound=!0,y._text=void 0,y.padding={left:0,right:0,top:0,bottom:0},y.width=1,y.height=1,y.dirty=!1,0===y.style.resolution&&(y.style.resolution=t.sys.game.config.resolution),y._crop=y.resetCropObject(),y.texture=t.sys.textures.addCanvas(null,y.canvas,!0),y.frame=y.texture.get(),y.frame.source.resolution=y.style.resolution,y.renderer&&y.renderer.gl&&(y.renderer.deleteTexture(y.frame.source.glTexture),y.frame.source.glTexture=null),v.hasOwnProperty(p)||(v[p]=new l.default),y.canvasText=new h.default({parent:_assertThisInitialized(y),context:y.context,parser:m,style:y.style,pensPool:v[p]}),u&&u.padding&&y.setPadding(u.padding),y.setText(c),t.sys.game.events.on("contextrestored",(function(){this.dirty=!0}),_assertThisInitialized(y)),y}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Text,[{key:"initRTL",value:function initRTL(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",p(this.canvas,this.scene.sys.canvas),this.originX=1)}},{key:"setText",value:function setText(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this}},{key:"setStyle",value:function setStyle(t){return this.style.setStyle(t)}},{key:"setFont",value:function setFont(t){return this.style.setFont(t)}},{key:"setFontFamily",value:function setFontFamily(t){return this.style.setFontFamily(t)}},{key:"setFontSize",value:function setFontSize(t){return this.style.setFontSize(t)}},{key:"setFontStyle",value:function setFontStyle(t){return this.style.setFontStyle(t)}},{key:"setFixedSize",value:function setFixedSize(t,i){return this.style.setFixedSize(t,i)}},{key:"setBackgroundColor",value:function setBackgroundColor(t){return this.style.setBackgroundColor(t)}},{key:"setFill",value:function setFill(t){return this.style.setFill(t)}},{key:"setColor",value:function setColor(t){return this.style.setColor(t)}},{key:"setStroke",value:function setStroke(t,i){return this.style.setStroke(t,i)}},{key:"setShadow",value:function setShadow(t,i,o,r,a,h){return this.style.setShadow(t,i,o,r,a,h)}},{key:"setShadowOffset",value:function setShadowOffset(t,i){return this.style.setShadowOffset(t,i)}},{key:"setShadowColor",value:function setShadowColor(t){return this.style.setShadowColor(t)}},{key:"setShadowBlur",value:function setShadowBlur(t){return this.style.setShadowBlur(t)}},{key:"setShadowStroke",value:function setShadowStroke(t){return this.style.setShadowStroke(t)}},{key:"setShadowFill",value:function setShadowFill(t){return this.style.setShadowFill(t)}},{key:"setWrapMode",value:function setWrapMode(t){return this.style.setWrapMode(t)}},{key:"setWrapWidth",value:function setWrapWidth(t){return this.style.setWrapWidth(t)}},{key:"setAlign",value:function setAlign(t){return this.style.setHAlign(t)}},{key:"setLineSpacing",value:function setLineSpacing(t){return this.style.setLineSpacing(t)}},{key:"setPadding",value:function setPadding(t,i,o,r){if("object"===_typeof(t)){var a=t,h=y(a,"x",null);null!==h?(t=h,o=h):(t=y(a,"left",0),o=y(a,"right",t));var l=y(a,"y",null);null!==l?(i=l,r=l):(i=y(a,"top",0),r=y(a,"bottom",i))}else void 0===t&&(t=0),void 0===i&&(i=t),void 0===o&&(o=t),void 0===r&&(r=i);return this.padding.left=t,this.padding.top=i,this.padding.right=o,this.padding.bottom=r,this.updateText(!1)}},{key:"setResolution",value:function setResolution(t){return this.style.setResolution(t)}},{key:"setMaxLines",value:function setMaxLines(t){return this.style.setMaxLines(t)}},{key:"updateText",value:function updateText(t){void 0===t&&(t=!0);var i=this.canvasText,o=this.style;t&&i.updatePenManager(this._text,o.wrapMode,o.wrapWidth,o.lineHeight);var r,a,h=this.padding;0===o.fixedWidth?(this.width=i.linesWidth+h.left+h.right,r=i.linesWidth):(this.width=o.fixedWidth,(r=this.width-h.left-h.right)<i.linesWidth&&(r=i.linesWidth)),0===o.fixedHeight?(this.height=i.linesHeight+h.top+h.bottom,a=i.linesHeight):(this.height=o.fixedHeight,(a=this.height-h.top-h.bottom)<i.linesHeight&&(a=i.linesHeight));var l=this.width,c=this.height;this.updateDisplayOrigin();var u=o.resolution;l*=u,c*=u,l=Math.max(Math.ceil(l),1),c=Math.max(Math.ceil(c),1);var p=this.canvas,d=this.context;p.width!==l||p.height!==c?(p.width=l,p.height=c,this.frame.setSize(l,c)):d.clearRect(0,0,l,c),d.save(),d.scale(u,u),i.draw(h.left,h.top,r,a),d.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(p,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;var m=this.input;return m&&!m.customHitArea&&(m.hitArea.width=this.width,m.hitArea.height=this.height),this}},{key:"getTextMetrics",value:function getTextMetrics(){return this.style.getTextMetrics()}},{key:"toJSON",value:function toJSON(){var t=P.ToJSON(this),i={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),resolution:this.resolution,padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=i,t}},{key:"preDestroy",value:function preDestroy(){this.style.rtl&&g(this.canvas),d.remove(this.canvas),this.canvasText.destroy()}},{key:"setInteractive",value:function setInteractive(t,i,o){return m.prototype.setInteractive.call(this,t,i,o),this.canvasText.setInteractive(),this}},{key:"getWrappedText",value:function getWrappedText(t,i,o){return(t=this.canvasText.getText(t,i,o,!0)).split(_)}},{key:"getPlainText",value:function getPlainText(t,i,o){return this.canvasText.getPlainText(t,i,o)}},{key:"getText",value:function getText(t,i,o){return this.canvasText.getText(t,i,o,!1)}},{key:"getSubString",value:function getSubString(t,i,o){return this.getText(t,i,o)}},{key:"copyPenManager",value:function copyPenManager(t){return this.canvasText.copyPenManager(t)}},{key:"getPenManager",value:function getPenManager(t,i){return this.canvasText.getPenManager(t,i)}},{key:"setSize",value:function setSize(t,i){return this.setFixedSize(t,i)}},{key:"resize",value:function resize(t,i){return this.setFixedSize(t,i)}},{key:"addImage",value:function addImage(t,i){return this.imageManager.add(t,i),this}},{key:"drawAreaBounds",value:function drawAreaBounds(t,i){return this.canvasText.hitAreaManager.drawBounds(t,i,this),this}},{key:"text",set:function set(t){this.setText(t)},get:function get(){return this._text}},{key:"lineSpacing",set:function set(t){this.setLineSpacing(t)},get:function get(){return this.style.lineSpacing}},{key:"imageManager",get:function get(){return Object(u.default)(this.scene.textures)}},{key:"visible",get:function get(){return _get(_getPrototypeOf(Text.prototype),"visible",this)},set:function set(t){_set(_getPrototypeOf(Text.prototype),"visible",t,this,!0)}}]),Text}(m),P=Phaser.GameObjects.Components;Phaser.Class.mixin(b,[P.Alpha,P.BlendMode,P.ComputedSize,P.Crop,P.Depth,P.Flip,P.GetBounds,P.Mask,P.Origin,P.Pipeline,P.ScrollFactor,P.Tint,P.Transform,P.Visible,r.default]),i.default=b},"./lib/plugins/gameobjects/text/textbase/canvastext/CanvasText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js"),a=o("./lib/plugins/gameobjects/text/textbase/penmanger/PenManager.js"),h=o("./lib/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js"),l=o("./lib/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js"),c=o("./lib/plugins/gameobjects/text/textbase/const.js"),u=o("./lib/plugins/gameobjects/text/textbase/canvastext/WrapText.js"),p=o("./lib/plugins/utils/object/Clone.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=Phaser.Utils.Objects.GetValue,m=c.default.NO_WRAP,y=c.default.NO_NEWLINE,g=function(){function CanvasText(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,CanvasText),this.parent=t.parent,this.context=d(t,"context",null),this.canvas=this.context.canvas,this.parser=d(t,"parser",null),this.defatultStyle=d(t,"style",null),this.autoRound=!0,this.pensPool=d(t,"pensPool",null),this.penManager=this.newPenManager(),this._tmpPenManager=null,this.hitAreaManager=new h.default;var i=this.context;this.getTextWidth=function(t){return i.measureText(t).width}}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(CanvasText,[{key:"destroy",value:function destroy(){this.context=void 0,this.canvas=void 0,this.parser=void 0,this.defatultStyle=void 0,this.penManager&&(this.penManager.destroy(),this.penManager=void 0),this._tmpPenManager&&(this._tmpPenManager.destroy(),this._tmpPenManager=void 0),this.hitAreaManager&&(this.hitAreaManager.destroy(),this.hitAreaManager=void 0)}},{key:"updatePenManager",value:function updatePenManager(t,i,o,r,a){if(void 0===a&&(a=this.penManager),a.freePens(),""===t)return a;for(var h,l,c,d,g,_=this.canvas,v=this.context,b=0,P=0,w=this.parser.splitText(t),S=0,C=w.length;S<C;S++)if(h=(d=this.parser.tagTextToProp(w[S],l)).plainText,(l=d.prop).img){var T=this.imageManager.getOuterWidth(l.img);o>0&&i!==m&&o<b+T&&(a.addNewLinePen(),P+=r,b=0),a.addImagePen(b,P,T,Object(p.default)(l)),b+=T}else if(""!==h){var k;this.context.save(),(c=this.parser.propToContextStyle(this.defatultStyle,l)).buildFont(),c.syncFont(_,v),c.syncStyle(_,v);for(var O=0,I=(g=Object(u.default)(h,this.getTextWidth,i,o,b)).length;O<I;O++)k=g[O],a.addTextPen(k.text,b,P,k.width,Object(p.default)(l),k.newLineMode),k.newLineMode!==y?(b=0,P+=r):b+=k.width;this.context.restore()}return a}},{key:"newPenManager",value:function newPenManager(){return new a.default({pensPool:this.pensPool,tagToText:this.parser.propToTagText,tagToTextScope:this.parser})}},{key:"getPlainText",value:function getPlainText(t,i,o){var r;if(null==t)r=this.penManager.plainText;else{var a=this.parser.splitText(t,1);r="";for(var h=0,l=a.length;h<l;h++)r+=a[h]}return null==i&&null==o||(null==i&&(i=0),null==o&&(o=r.length),r=r.substring(i,o)),r}},{key:"getPenManager",value:function getPenManager(t,i){if(void 0===t)return this.copyPenManager(i,this.penManager);void 0===i&&(i=this.newPenManager());var o=this.defatultStyle;return this.updatePenManager(t,o.wrapMode,o.wrapWidth,o.lineHeight,i),i}},{key:"getText",value:function getText(t,i,o,r){if(null==t)return this.penManager.getSliceTagText(i,o,r);var a=this.tmpPenManager,h=this.defatultStyle;return this.updatePenManager(t,h.wrapMode,h.wrapWidth,h.lineHeight,a),a.getSliceTagText(i,o,r)}},{key:"copyPenManager",value:function copyPenManager(t,i){return void 0===i&&(i=this.penManager),i.copy(t)}},{key:"getTextWidth",value:function getTextWidth(t){return void 0===t&&(t=this.penManager),t.getMaxLineWidth()}},{key:"getLastPen",value:function getLastPen(t){return void 0===t&&(t=this.penManager),t.lastPen}},{key:"startXOffset",get:function get(){return this.defatultStyle.strokeThickness/2}},{key:"startYOffset",get:function get(){var t=this.defatultStyle;return t.strokeThickness/2+t.metrics.ascent}},{key:"lines",get:function get(){return this.penManager.lines}},{key:"desplayLinesCount",get:function get(){var t=this.penManager.linesCount,i=this.defatultStyle.maxLines;return i>0&&t>i&&(t=i),t}},{key:"linesWidth",get:function get(){return this.penManager.getMaxLineWidth()}},{key:"linesHeight",get:function get(){var t=this.desplayLinesCount,i=this.defatultStyle.lineHeight*t;return t>0&&(i-=this.defatultStyle.lineSpacing),i}},{key:"imageManager",get:function get(){return this.parent.imageManager}},{key:"tmpPenManager",get:function get(){return null===this._tmpPenManager&&(this._tmpPenManager=this.newPenManager()),this._tmpPenManager}}]),CanvasText}(),_={setInteractive:l.default};Object.assign(g.prototype,r.default,_),i.default=g},"./lib/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js":function(t,i,o){"use strict";o.r(i),i.default={draw:function draw(t,i,o,r){var a=this.penManager;this.hitAreaManager.clear();var h=this.context;h.save(),this.drawBackground(this.defatultStyle.backgroundColor);var l=this.defatultStyle;t+=this.startXOffset,i+=this.startYOffset;var c,u,p,d,m,y,g=l.halign,_=l.valign,v=l.lineHeight,b=a.lines,P=b.length,w=l.maxLines;w>0&&P>w?(u=w,p="center"===_?Math.floor((P-u)/2):"bottom"===_?P-u:0):(u=P,p=0),d=p+u,y="center"===_?Math.max((r-u*v)/2,0):"bottom"===_?Math.max(r-u*v-2,0):0,y+=i;for(var S=p;S<d;S++)if(0!==(c=a.getLineWidth(S))){m="center"===g?(o-c)/2:"right"===g?o-c:0,m+=t;for(var C=b[S],T=0,k=C.length;T<k;T++)this.drawPen(C[T],m,y)}h.restore()},drawPen:function drawPen(t,i,o){i+=t.x,o+=t.y;var r=this.canvas,a=this.context;a.save();var h=this.parser.propToContextStyle(this.defatultStyle,t.prop);h.buildFont(),h.syncFont(r,a),h.syncStyle(r,a),h.underlineThickness>0&&t.width>0&&this.drawUnderline(i,o,t.width,h),t.isTextPen&&this.drawText(i,o,t.text,h),t.isImagePen&&this.drawImage(i,o,t.prop.img,h),a.restore(),t.hasAreaMarker&&t.width>0&&this.hitAreaManager.add(t.prop.area,i,o-this.startYOffset,t.width,this.defatultStyle.lineHeight)},clear:function clear(){var t=this.canvas;this.context.clearRect(0,0,t.width,t.height)},drawBackground:function drawBackground(t){null!==t&&(this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height))},drawUnderline:function drawUnderline(t,i,o,r){i+=r.underlineOffset-r.underlineThickness/2,this.autoRound&&(t=Math.round(t),i=Math.round(i));var a=this.context,h=a.lineCap;a.lineCap="butt",a.beginPath(),a.strokeStyle=r.underlineColor,a.lineWidth=r.underlineThickness,a.moveTo(t,i),a.lineTo(t+o,i),a.stroke(),a.lineCap=h},drawText:function drawText(t,i,o,r){this.autoRound&&(t=Math.round(t),i=Math.round(i));var a=this.context;r.strokeThickness&&(r.syncShadow(a,r.shadowStroke),a.strokeText(o,t,i)),r.color&&"none"!==r.color&&(r.syncShadow(a,r.shadowFill),a.fillText(o,t,i))},drawImage:function drawImage(t,i,o,r){var a=this.parent.imageManager,h=a.get(o),l=a.getFrame(o);t+=h.left,i+=-this.startYOffset+h.y,this.autoRound&&(t=Math.round(t),i=Math.round(i)),this.context.drawImage(l.source.image,l.cutX,l.cutY,l.cutWidth,l.cutHeight,t,i,h.width,h.height)}}},"./lib/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js":function(t,i,o){"use strict";o.r(i);var r=function FireEvent(t,i,o,r){var a=this.hitAreaManager.contains(o,r);!1!==a&&(this.parent.emit("".concat(t,"-").concat(a),i,o,r),this.parent.emit(t,a,i,o,r))};i.default=function SetInteractive(){this.parent.on("pointerdown",(function(t,i,o,a){r.call(this,"areadown",t,i,o)}),this).on("pointerup",(function(t,i,o,a){r.call(this,"areaup",t,i,o)}),this)}},"./lib/plugins/gameobjects/text/textbase/canvastext/WrapText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/pool.js"),a=o("./lib/plugins/gameobjects/text/textbase/const.js"),h=a.default.NO_NEWLINE,l=a.default.RAW_NEWLINE,c=a.default.WRAPPED_NEWLINE,u=a.default.NO_WRAP,p=a.default.WORD_WRAP,d=(a.default.CHAR_WRAP,a.default.SPLITREGEXP),m=[],y=new r.default;y.newline=function(t,i,o){var r=this.pop();return null===r&&(r={}),r.text=t,r.width=i,r.newLineMode=o,r},i.default=function WrapText(t,i,o,r,a){r<=0&&(o=u);var g=m;if(y.pushMultiple(g),!t||!t.length)return g;for(var _,v,b,P=t.split(d),w=0,S=P.length;w<S;w++)if(_=P[w],b=w===S-1?h:l,o!==u){var C,T;if(v=0===w?r-a:r,_.length<=100)if((B=i(_))<=v){g.push(y.newline(_,B,b));continue}for(var k,O="",I="",M=0,E=0,x=(C=o===p?_.split(" "):_).length;E<x;E++)T=C[E],o===p?(O+=T,E<x-1&&(O+=" ")):O+=T,(k=i(O))>v&&(0===E?g.push(y.newline("",0,c)):(g.push(y.newline(I,M,c)),O=T,o===p&&E<x-1&&(O+=" "),k=i(O)),v=r),I=O,M=k;g.push(y.newline(I,M,b))}else{var B=i(_);g.push(y.newline(_,B,b))}return g}},"./lib/plugins/gameobjects/text/textbase/const.js":function(t,i,o){"use strict";o.r(i);i.default={NO_NEWLINE:0,RAW_NEWLINE:1,WRAPPED_NEWLINE:2,NO_WRAP:0,WORD_WRAP:1,CHAR_WRAP:2,SPLITREGEXP:/(?:\r\n|\r|\n)/}},"./lib/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/pool.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=Phaser.Geom.Rectangle,h=new r.default,l=function(){function HitAreaManager(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,HitAreaManager),this.hitAreas=[]}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(HitAreaManager,[{key:"destroy",value:function destroy(){this.clear()}},{key:"clear",value:function clear(){return h.pushMultiple(this.hitAreas),this}},{key:"add",value:function add(t,i,o,r,l){var c=h.pop();return null===c?c=new a(i,o,r,l):c.setTo(i,o,r,l),c.key=t,this.hitAreas.push(c),this}},{key:"contains",value:function contains(t,i){for(var o,r=this.hitAreas,a=0,h=r.length;a<h;a++)if((o=r[a]).contains(t,i))return o.key;return!1}},{key:"drawBounds",value:function drawBounds(t,i,o){void 0===i&&(i=16777215),o&&t.save().scaleCanvas(o.scaleX,o.scaleY).rotateCanvas(o.rotation).translateCanvas(o.x,o.y);for(var r,a=this.hitAreas,h=0,l=a.length;h<l;h++)r=a[h],t.lineStyle(1,i).strokeRect(r.x,r.y,r.width,r.height);return o&&t.restore(),this}}]),HitAreaManager}();i.default=l},"./lib/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js":function(t,i,o){"use strict";o.r(i);var r,a=o("./lib/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js");i.default=function(t){return void 0===r&&(r=new a.default(t)),r}},"./lib/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js":function(t,i,o){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.r(i);var r=Phaser.Utils.Objects.GetValue,a=function(){function ImageManager(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,ImageManager),this.textureManager=t,this.images={}}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(ImageManager,[{key:"add",value:function add(t,i){if("string"==typeof t)this._add(t,i);else if(Array.isArray(t))for(var o=0,r=(a=t).length;o<r;o++)this._add(a[o]);else{var a=t;for(var t in a)this._add(t,a[t])}return this}},{key:"_add",value:function _add(t,i){void 0===i&&(i={key:t});var o=i.key,a=i.frame,h=i.width,l=i.height;if(void 0===h||void 0===l){var c=this.textureManager.getFrame(o,a),u=c?c.cutWidth:0,p=c?c.cutHeight:0;void 0===h&&void 0===l?(h=u,l=p):void 0===h?h=u*(l/p):void 0===l&&(l=p*(h/u))}this.images[t]={key:o,frame:a,width:h,height:l,y:r(i,"y",0),left:r(i,"left",0),right:r(i,"right",0)}}},{key:"remove",value:function remove(t){return this.images.hasOwnProperty(t)&&delete this.images[t],this}},{key:"get",value:function get(t){return this.images.hasOwnProperty(t)||this.textureManager.exists(t)&&this.add(t),this.images[t]}},{key:"getOuterWidth",value:function getOuterWidth(t){var i=this.get(t);return i?i.width+i.left+i.right:0}},{key:"getFrame",value:function getFrame(t){var i=this.get(t);return i?this.textureManager.getFrame(i.key,i.frame):void 0}},{key:"hasTexture",value:function hasTexture(t){return!!this.getFrame(t)}}]),ImageManager}();i.default=a},"./lib/plugins/gameobjects/text/textbase/penmanger/Pen.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/const.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=Phaser.Utils.Objects.GetValue,h=r.default.NO_NEWLINE,l=r.default.RAW_NEWLINE,c=function(){function Pen(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Pen),this.prop={},this.resetFromJSON(t)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Pen,[{key:"resetFromJSON",value:function resetFromJSON(t){this.text=a(t,"text",""),this.x=a(t,"x",0),this.y=a(t,"y",0),this.width=a(t,"width",0);var i=a(t,"prop",null);null===i&&(i={}),this.prop=i,this.newLineMode=a(t,"newLineMode",0),this.startIndex=a(t,"startIndex",0)}},{key:"plainText",get:function get(){var t=this.text;return this.newLineMode===l&&(t+="\n"),t}},{key:"wrapText",get:function get(){var t=this.text;return this.newLineMode!==h&&(t+="\n"),t}},{key:"rawTextLength",get:function get(){var t=this.text.length;return this.newLineMode===l&&(t+=1),t}},{key:"endIndex",get:function get(){return this.startIndex+this.rawTextLength}},{key:"lastX",get:function get(){return this.x+this.width}},{key:"isTextPen",get:function get(){return""!==this.text}},{key:"isImagePen",get:function get(){return!!this.prop.img}},{key:"hasAreaMarker",get:function get(){return!!this.prop.area}}]),Pen}();i.default=c},"./lib/plugins/gameobjects/text/textbase/penmanger/PenManager.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/pool.js"),a=o("./lib/plugins/gameobjects/text/textbase/penmanger/Pen.js"),h=o("./lib/plugins/gameobjects/text/textbase/const.js"),l=o("./lib/plugins/utils/object/Clone.js"),c=o("./lib/plugins/utils/object/NOOP.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=Phaser.Utils.Objects.GetFastValue,p=h.default.NO_NEWLINE,d=h.default.WRAPPED_NEWLINE,m=new r.default,y=new r.default,g=function(){function PenManager(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,PenManager),this.pens=[],this.lines=[],this.maxLinesWidth=void 0,this.PensPool=u(t,"pensPool",m),this.LinesPool=u(t,"linesPool",y),this.tagToText=u(t,"tagToText",c.default),this.tagToTextScope=u(t,"tagToTextScope",void 0)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(PenManager,[{key:"destroy",value:function destroy(){this.freePens(),this.tagToText=void 0,this.tagToTextScope=void 0}},{key:"freePens",value:function freePens(){for(var t=0,i=this.lines.length;t<i;t++)this.lines[t].length=0;this.PensPool.pushMultiple(this.pens),this.LinesPool.pushMultiple(this.lines),this.maxLinesWidth=void 0}},{key:"addTextPen",value:function addTextPen(t,i,o,r,h,l){var c=this.PensPool.pop();return null==c&&(c=new a.default),_.text=t,_.x=i,_.y=o,_.width=r,_.prop=h,_.newLineMode=l,c.resetFromJSON(_),this.addPen(c),this}},{key:"addImagePen",value:function addImagePen(t,i,o,r){return this.addTextPen("",t,i,o,r,p),this}},{key:"addNewLinePen",value:function addNewLinePen(){var t=this.lastPen,i=t?t.lastX:0,o=t?t.y:0,r=t?Object(l.default)(t.prop):null;return this.addTextPen("",i,o,0,r,d),this}},{key:"addPen",value:function addPen(t){var i=this.lastPen;t.startIndex=null==i?0:i.endIndex,this.pens.push(t);var o=this.lastLine;null==o&&(o=this.LinesPool.pop()||[],this.lines.push(o)),o.push(t),t.newLineMode!==p&&(o=this.LinesPool.pop()||[],this.lines.push(o)),this.maxLinesWidth=void 0}},{key:"clone",value:function clone(t){null==t&&(t=new PenManager),t.freePens();for(var i=0,o=this.lines.length;i<o;i++)for(var r=this.lines[i],a=0,h=r.length;a<h;a++){var c=r[a];t.addPen(c.text,c.x,c.y,c.width,Object(l.default)(c.prop),c.newLineMode)}return t}},{key:"getLineStartIndex",value:function getLineStartIndex(t){if(t>=this.lines.length)return this.getLineEndIndex(t);var i=this.lines[t];return i&&i[0]?i[0].startIndex:0}},{key:"getLineEndIndex",value:function getLineEndIndex(t){t>=this.lines.length&&(t=this.lines.length-1);var i,o,r=!1;for(i=t;i>=0&&!(r=null!=(o=this.lines[i])&&o.length>0);i--);return r?o[o.length-1].endIndex:0}},{key:"getLineWidth",value:function getLineWidth(t){var i=this.lines[t];if(!i)return 0;var o=i[i.length-1];return null==o?0:o.lastX}},{key:"getMaxLineWidth",value:function getMaxLineWidth(){if(void 0!==this.maxLinesWidth)return this.maxLinesWidth;for(var t,i=0,o=0,r=this.lines.length;o<r;o++)(t=this.getLineWidth(o))>i&&(i=t);return this.maxLinesWidth=i,i}},{key:"getLineWidths",value:function getLineWidths(){for(var t=[],i=0,o=this.lines.length;i<o;i++)t.push(this.getLineWidth(i));return t}},{key:"getSliceTagText",value:function getSliceTagText(t,i,o){if(void 0===t&&(t=0),void 0===i){var r=this.lastPen;if(null==r)return"";i=r.endIndex}void 0===o&&(o=!1);for(var a,h,l,c,u,p,d="",m=0,y=this.pens.length;m<y&&((c=(a=this.pens[m]).endIndex)<=t||(a=this.pens[m],h=o?a.wrapText:a.plainText,u=a.prop,(l=a.startIndex)>=t&&c<=i||(h=h.substring(t-l,i-l)),this.tagToTextScope?d+=this.tagToText.call(this.tagToTextScope,h,u,p):d+=this.tagToText(h,u,p),p=u,!(c>=i)));m++);return d}},{key:"lastPen",get:function get(){return this.pens[this.pens.length-1]}},{key:"lastLine",get:function get(){return this.lines[this.lines.length-1]}},{key:"linesCount",get:function get(){return this.lines.length}},{key:"plainText",get:function get(){for(var t="",i=this.pens,o=0,r=i.length;o<r;o++)t+=i[o].plainText;return t}},{key:"rawTextLength",get:function get(){for(var t=0,i=this.pens,o=0,r=this.pens.length;o<r;o++)t+=i[o].rawTextLength;return t}}]),PenManager}(),_={};i.default=g},"./lib/plugins/gameobjects/text/textbase/render/CanvasRenderer.js":function(t,i,o){"use strict";o.r(i);i.default=function TextCanvasRenderer(t,i,o,r,a){0!==i.width&&0!==i.height&&t.batchSprite(i,i.frame,r,a)}},"./lib/plugins/gameobjects/text/textbase/render/Render.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/render/WebGLRenderer.js"),a=o("./lib/plugins/gameobjects/text/textbase/render/CanvasRenderer.js"),h=o("./lib/plugins/utils/object/NOOP.js"),l=h.default,c=h.default;l=r.default,c=a.default,i.default={renderWebGL:l,renderCanvas:c}},"./lib/plugins/gameobjects/text/textbase/render/WebGLRenderer.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Renderer.WebGL.Utils;i.default=function TextWebGLRenderer(t,i,o,a,h){if(0!==i.width&&0!==i.height){var l=i.frame,c=l.width,u=l.height,p=r.getTintAppendFloatAlpha;this.pipeline.batchTexture(i,l.glTexture,c,u,i.x,i.y,c/i.style.resolution,u/i.style.resolution,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.displayOriginX,i.displayOriginY,0,0,c,u,p(i._tintTL,a.alpha*i._alphaTL),p(i._tintTR,a.alpha*i._alphaTR),p(i._tintBL,a.alpha*i._alphaBL),p(i._tintBR,a.alpha*i._alphaBR),i._isTinted&&i.tintFill,0,0,a,h)}}},"./lib/plugins/gameobjects/text/textbase/textstyle/MeasureText.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Display.Canvas.CanvasPool;i.default=function MeasureText(t){var i=r.create(this),o=i.getContext("2d");t.syncFont(i,o);var a=Math.ceil(o.measureText(t.testString).width*t.baselineX),h=a,l=2*h;h=h*t.baselineY|0,i.width=a,i.height=l,o.fillStyle="#f00",o.fillRect(0,0,a,l),o.font=t._font,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(t.testString,0,h);var c={ascent:0,descent:0,fontSize:0};if(!o.getImageData(0,0,a,l))return c.ascent=h,c.descent=h+6,c.fontSize=c.ascent+c.descent,r.remove(i),c;var u,p,d=o.getImageData(0,0,a,l).data,m=d.length,y=4*a,g=0,_=!1;for(u=0;u<h;u++){for(p=0;p<y;p+=4)if(255!==d[g+p]){_=!0;break}if(_)break;g+=y}for(c.ascent=h-u,g=m-y,_=!1,u=l;u>h;u--){for(p=0;p<y;p+=4)if(255!==d[g+p]){_=!0;break}if(_)break;g-=y}return c.descent=u-h,c.fontSize=c.ascent+c.descent,r.remove(i),c}},"./lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/textbase/textstyle/MeasureText.js"),a=o("./lib/plugins/gameobjects/text/textbase/const.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=Phaser.Utils.Objects.GetAdvancedValue,l=Phaser.Utils.Objects.GetValue,c={backgroundColor:["backgroundColor",null],fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],underlineColor:["underline.color","#000"],underlineThickness:["underline.thickness",0],underlineOffset:["underline.offset",0],halign:["halign","left"],valign:["valign","top"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],lineSpacing:["lineSpacing",0],rtl:["rtl",!1],testString:["testString","|MÃ‰qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wrapMode:["wrap.mode",1],wrapWidth:["wrap.width",0]},u=function(){function TextStyle(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TextStyle),this.parent=t,this.backgroundColor,this.fontFamily,this.fontSize,this.fontStyle,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.underlineColor,this.underlineThickness,this.underlineOffset,this.halign,this.valign,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.lineSpacing,this.rtl,this.testString,this.baselineX,this.baselineY,this._font,this.setStyle(i,!1);var o=l(i,"metrics",!1);this.metrics=o?{ascent:l(o,"ascent",0),descent:l(o,"descent",0),fontSize:l(o,"fontSize",0)}:Object(r.default)(this)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TextStyle,[{key:"setStyle",value:function setStyle(t,i){if(void 0===i&&(i=!0),t&&t.hasOwnProperty("wrap")){var o=t.wrap;if(o.hasOwnProperty("mode")){var r=o.mode;"string"==typeof r&&(o.mode=p[r])}else o.hasOwnProperty("width")&&(o.mode=1)}for(var a in t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),c)this[a]="wrapCallback"===a||"wrapCallbackScope"===a?l(t,c[a][0],c[a][1]):h(t,c[a][0],c[a][1]);var u=l(t,"font",null);this._font=null===u?this.fontStyle+" "+this.fontSize+" "+this.fontFamily:u;var d=l(t,"fill",null);return null!==d&&(this.color=d),i?this.update(!0):this.parent}},{key:"syncFont",value:function syncFont(t,i){i.font=this._font}},{key:"syncStyle",value:function syncStyle(t,i){i.textBaseline="alphabetic",i.fillStyle=this.color,i.strokeStyle=this.stroke,i.lineWidth=this.strokeThickness,i.lineCap="round",i.lineJoin="round"}},{key:"syncShadow",value:function syncShadow(t,i){i?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)}},{key:"update",value:function update(t){return t&&(this._font=this.fontStyle+" "+this.fontSize+" "+this.fontFamily,this.metrics=Object(r.default)(this)),this.parent.updateText(t)}},{key:"buildFont",value:function buildFont(){var t=this.fontStyle+" "+this.fontSize+" "+this.fontFamily;return t!==this._font&&(this._font=t),this}},{key:"setFont",value:function setFont(t){return"string"==typeof t?(this.fontFamily=t,this.fontSize="",this.fontStyle=""):(this.fontFamily=l(t,"fontFamily","Courier"),this.fontSize=l(t,"fontSize","16px"),this.fontStyle=l(t,"fontStyle","")),this.update(!0)}},{key:"setFontFamily",value:function setFontFamily(t){return this.fontFamily=t,this.update(!0)}},{key:"setFontStyle",value:function setFontStyle(t){return this.fontStyle=t,this.update(!0)}},{key:"setFontSize",value:function setFontSize(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize=t,this.update(!0)}},{key:"setTestString",value:function setTestString(t){return this.testString=t,this.update(!0)}},{key:"setFixedSize",value:function setFixedSize(t,i){return this.fixedWidth=t,this.fixedHeight=i,t&&(this.parent.width=t),i&&(this.parent.height=i),this.update(!1)}},{key:"setResolution",value:function setResolution(t){return this.resolution=t,this.update(!1)}},{key:"setLineSpacing",value:function setLineSpacing(t){return this.lineSpacing=t,this.update(!1)}},{key:"setBackgroundColor",value:function setBackgroundColor(t){return this.backgroundColor=t,this.update(!1)}},{key:"setFill",value:function setFill(t){return this.color=t,this.update(!1)}},{key:"setColor",value:function setColor(t){return this.color=t,this.update(!1)}},{key:"setStroke",value:function setStroke(t,i){return void 0===t?this.strokeThickness=0:(void 0===i&&(i=this.strokeThickness),this.stroke=t,this.strokeThickness=i),this.update(!0)}},{key:"setShadow",value:function setShadow(t,i,o,r,a,h){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o="#000"),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===h&&(h=!0),this.shadowOffsetX=t,this.shadowOffsetY=i,this.shadowColor=o,this.shadowBlur=r,this.shadowStroke=a,this.shadowFill=h,this.update(!1)}},{key:"setShadowOffset",value:function setShadowOffset(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.shadowOffsetX=t,this.shadowOffsetY=i,this.update(!1)}},{key:"setShadowColor",value:function setShadowColor(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)}},{key:"setShadowBlur",value:function setShadowBlur(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)}},{key:"setShadowStroke",value:function setShadowStroke(t){return this.shadowStroke=t,this.update(!1)}},{key:"setShadowFill",value:function setShadowFill(t){return this.shadowFill=t,this.update(!1)}},{key:"setUnderline",value:function setUnderline(t,i,o){return void 0===t&&(t="#000"),void 0===i&&(i=0),void 0===o&&(o=0),this.underlineColor=t,this.underlineThickness=i,this.underlineOffset=o,this.update(!1)}},{key:"setUnderlineColor",value:function setUnderlineColor(t){return void 0===t&&(t="#000"),this.underlineColor=t,this.update(!1)}},{key:"setUnderlineThickness",value:function setUnderlineThickness(t){return void 0===t&&(t=0),this.underlineThickness=t,this.update(!1)}},{key:"setUnderlineOffset",value:function setUnderlineOffset(t){return void 0===t&&(t=0),this.underlineOffset=t,this.update(!1)}},{key:"setWrapMode",value:function setWrapMode(t){return"string"==typeof t&&(t=p[t.toLowerCase()]||0),this.wrapMode=t,this.update(!0)}},{key:"setWrapWidth",value:function setWrapWidth(t){return this.wrapWidth=t,this.update(!1)}},{key:"setAlign",value:function setAlign(t,i){return void 0===t&&(t="left"),void 0===i&&(i="top"),this.halign=t,this.valign=i,this.update(!1)}},{key:"setHAlign",value:function setHAlign(t){return void 0===t&&(t="left"),this.halign=t,this.update(!1)}},{key:"setVAlign",value:function setVAlign(t){return void 0===t&&(t="top"),this.valign=t,this.update(!1)}},{key:"setMaxLines",value:function setMaxLines(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)}},{key:"getTextMetrics",value:function getTextMetrics(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}}},{key:"toJSON",value:function toJSON(){var t={};for(var i in c)t[i]=this[i];return t.metrics=this.getTextMetrics(),t}},{key:"destroy",value:function destroy(){this.parent=void 0}},{key:"lineHeight",get:function get(){return this.metrics.fontSize+this.strokeThickness+this.lineSpacing}}]),TextStyle}(),p=(a.default.hleft,a.default.hcenter,a.default.hright,a.default.vtop,a.default.vcenter,a.default.vbottom,{none:a.default.NO_WRAP,word:a.default.WORD_WRAP,char:a.default.CHAR_WRAP,character:a.default.CHAR_WRAP});i.default=u},"./lib/plugins/input/button/Button.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js"),a=o("./lib/plugins/utils/system/GetSceneObject.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=Phaser.Utils.Objects.GetValue,l=function(){function Button(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Button),this.gameObject=t,this.scene=Object(a.default)(t),this.setEventEmitter(h(i,"eventEmitter",void 0)),t.setInteractive(h(i,"inputConfig",void 0)),this.resetFromJSON(i),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Button,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.pointer=void 0,this.lastClickTime=void 0,this.setEnable(h(t,"enable",!0)),this.setMode(h(t,"mode",1)),this.setClickInterval(h(t,"clickInterval",100)),this.setDragThreshold(h(t,"threshold",void 0)),this}},{key:"boot",value:function boot(){this.gameObject.on("pointerdown",this.onPress,this),this.gameObject.on("pointerup",this.onRelease,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onMove,this),this.gameObject.on("destroy",this.destroy,this)}},{key:"shutdown",value:function shutdown(){this.destroyEventEmitter(),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable===t||(t||this.cancel(),this.enable=t,this.gameObject.input.enabled=t),this}},{key:"setMode",value:function setMode(t){return"string"==typeof t&&(t=c[t]),this.mode=t,this}},{key:"setClickInterval",value:function setClickInterval(t){return this.clickInterval=t,this}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"onPress",value:function onPress(t,i,o,r){void 0===this.pointer&&(this.pointer=t,0===this.mode&&this.click(t.downTime,t,r))}},{key:"onRelease",value:function onRelease(t,i,o,r){this.pointer===t&&(1===this.mode&&this.click(t.upTime,t,r),this.pointer=void 0)}},{key:"onPointOut",value:function onPointOut(t,i){this.pointer===t&&this.cancel()}},{key:"onMove",value:function onMove(t,i,o,r){this.pointer===t&&void 0!==this.dragThreshold&&t.getDistance()>=this.dragThreshold&&this.cancel()}},{key:"click",value:function click(t,i,o){if(void 0===t)return this.emit("click",this,this.gameObject,i,o),this;this.pointer=void 0;var r=this.lastClickTime;return void 0!==r&&t-r<=this.clickInterval||(this.lastClickTime=t,this.emit("click",this,this.gameObject,i,o)),this}},{key:"cancel",value:function cancel(){return this.pointer=void 0,this}}]),Button}();Object.assign(l.prototype,r.default);var c={press:0,pointerdown:0,release:1,pointerup:1};i.default=l},"./lib/plugins/input/dragspeed/DragSpeed.js":function(t,i,o){"use strict";o.r(i);o("./lib/plugins/utils/system/GetSceneObject.js");var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=Phaser.Utils.Objects.GetValue,h=Phaser.Math.Distance.Between,l=function(){function DragSpeed(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,DragSpeed),this.gameObject=t,this.scene=t.scene||void 0,this.setEventEmitter(a(i,"eventEmitter",void 0)),t.setInteractive(a(i,"inputConfig",void 0)),this.resetFromJSON(i),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(DragSpeed,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.pointer=void 0,this.isInTouched=!1,this.holdStartTime=void 0,this.x=void 0,this.y=void 0,this.pTooqing=void 0,this.preY=void 0,this.localX=void 0,this.localY=void 0,this.justMoved=!1,this.setEnable(a(t,"enable",!0)),this.holdThreshold=a(t,"holdThreshold",50),this}},{key:"boot",value:function boot(){this.gameObject.on("pointerdown",this.onPointIn,this),this.gameObject.on("pointerover",this.onPointIn,this),this.gameObject.on("pointerup",this.onPointOut,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onPointerMove,this),this.gameObject.on("destroy",this.destroy,this),this.scene.events.on("preupdate",this.preupdate,this)}},{key:"shutdown",value:function shutdown(){this.scene&&this.scene.events.off("preupdate",this.preupdate,this),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0,this.destroyEventEmitter()}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable===t||(t||(this.isInTouched=!1,this.pointer=void 0),this.enable=t,this.gameObject.input.enabled=t),this}},{key:"onPointIn",value:function onPointIn(t,i,o){t.isDown&&void 0===this.pointer&&(this.pointer=t,this.localX=i,this.localY=o)}},{key:"onPointOut",value:function onPointOut(t){this.pointer===t&&(this.pointer=void 0)}},{key:"onPointerMove",value:function onPointerMove(t,i,o){t.isDown&&this.pointer===t&&(this.localX=i,this.localY=o)}},{key:"preupdate",value:function preupdate(t,i){var o=this.pointer;this.justMoved=!1,o&&!this.isInTouched?(this.x=o.x,this.y=o.y,this.pTooqing=o.x,this.preY=o.y,this.isInTouched=!0,this.holdStartTime=void 0,this.emit("touchstart",o,this.localX,this.localY)):o&&this.isInTouched?this.x===o.x&&this.y===o.y?void 0===this.holdStartTime?this.holdStartTime=t:t-this.holdStartTime>this.holdThreshold&&(this.pTooqing=this.x,this.preY=this.y):(this.pTooqing=this.x,this.preY=this.y,this.x=o.x,this.y=o.y,this.holdStartTime=void 0,this.justMoved=!0,this.emit("touchmove",o,this.localX,this.localY)):!o&&this.isInTouched&&(this.isInTouched=!1,this.holdStartTime=void 0,this.emit("touchend",o))}},{key:"isDown",get:function get(){return this.pointer&&this.pointer.isDown}},{key:"isUp",get:function get(){return!this.isDown}},{key:"dx",get:function get(){return this.x-this.pTooqing}},{key:"dy",get:function get(){return this.y-this.preY}},{key:"dt",get:function get(){return this.scene.sys.game.loop.delta}},{key:"speed",get:function get(){return this.x===this.pTooqing&&this.y===this.preY?0:h(this.pTooqing,this.preY,this.x,this.y)/(.001*this.dt)}},{key:"speedX",get:function get(){return this.dx/(.001*this.dt)}},{key:"speedY",get:function get(){return this.dy/(.001*this.dt)}}]),DragSpeed}();Object.assign(l.prototype,r.default),i.default=l},"./lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/ticktask/TickTask.js"),a=o("./lib/plugins/utils/system/GetSceneObject.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(OnePointerTracer,t);var i=_createSuper(OnePointerTracer);function OnePointerTracer(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,OnePointerTracer);var l=Object(a.default)(t);return l===t&&(t=void 0),(r=i.call(this,l,o)).scene=l,r.gameObject=t,t&&t.setInteractive(h(o,"inputConfig",void 0)),r.resetFromJSON(o),r.boot(),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(OnePointerTracer,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setEnable(h(t,"enable",!0)),void 0===this.gameObject?this.bounds=h(t,"bounds",void 0):this.bounds=void 0,this.tracerState=c,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,this.isTouchingAnyObject=!1,this}},{key:"boot",value:function boot(){_get(_getPrototypeOf(OnePointerTracer.prototype),"boot",this).call(this),this.gameObject?this.gameObject.on("pointerdown",this.onPointerDown,this):this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function shutdown(){this.gameObject?this.gameObject.off("pointerdown",this.onPointerDown,this):this.scene&&this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene&&(this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0,this.gameObject=void 0,this.bounds=void 0,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,_get(_getPrototypeOf(OnePointerTracer.prototype),"shutdown",this).call(this)}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable===t||(t||this.dragCancel(),this.enable=t),this}},{key:"onPointerDown",value:function onPointerDown(t,i){this.enable&&(void 0===this.pointer&&(!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer!==t&&(this.pointer=t,this.lastPointer=t,this.movedState=!1,this.tracerState=u,void 0===this.gameObject&&(this.isTouchingAnyObject=i.length>0),this.onDragStart()))}},{key:"onPointerUp",value:function onPointerUp(t){this.enable&&((!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer===t&&(this.pointer=void 0,this.movedState=!1,this.tracerState=c,this.onDragEnd()))}},{key:"onPointerMove",value:function onPointerMove(t){if(this.enable&&t.isDown){var i=!this.bounds||this.bounds.contains(t.x,t.y),o=this.pointer===t;!o&&i||(o&&!i?this.onPointerUp(t):(this.movedState||(this.movedState=t.x!==t.downX||t.y!==t.downY),this.movedState&&this.onDrag()))}}},{key:"dragCancel",value:function dragCancel(){return this.tracerState===u&&this.onDragEnd(),this.pointer=void 0,this.tracerState=c,this}},{key:"onDragStart",value:function onDragStart(){this.emit("dragstart",this)}},{key:"onDragEnd",value:function onDragEnd(){this.emit("dragend",this)}},{key:"onDrag",value:function onDrag(){this.emit("drag",this)}},{key:"preUpdate",value:function preUpdate(t,i){}},{key:"postUpdate",value:function postUpdate(t,i){}},{key:"startTicking",value:function startTicking(){_get(_getPrototypeOf(OnePointerTracer.prototype),"startTicking",this).call(this),this.scene.events.on("preupdate",this.preUpdate,this),this.scene.events.on("postupdate",this.postUpdate,this)}},{key:"stopTicking",value:function stopTicking(){_get(_getPrototypeOf(OnePointerTracer.prototype),"stopTicking",this).call(this),this.scene&&(this.scene.events.off("preupdate",this.preUpdate,this),this.scene.events.off("postupdate",this.postUpdate,this))}},{key:"setRecongizedStateObject",value:function setRecongizedStateObject(t){return this.recongizedState=t,this}},{key:"cancel",value:function cancel(){return this.state=p,this}},{key:"state",get:function get(){return this.recongizedState.state},set:function set(t){this.recongizedState.state=t}}]),OnePointerTracer}(r.default),c=0,u=1,p="IDLE";i.default=l},"./lib/plugins/input/gestures/press/Press.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js"),a=o("./lib/plugins/fsm.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Press,t);var i=_createSuper(Press);function Press(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Press);var h=_assertThisInitialized(r=i.call(this,t,o)),l={states:{IDLE:{enter:function enter(){h.x=0,h.y=0,h.worldX=0,h.worldY=0},exit:function exit(){var t=h.lastPointer;h.x=t.x,h.y=t.y,h.worldX=t.worldX,h.worldY=t.worldY}},BEGIN:{enter:function enter(){h.start()},exit:function exit(){h.stop()}},RECOGNIZED:{enter:function enter(){h.emit("pressstart",h,h.gameObject,h.lastPointer)},exit:function exit(){h.emit("pressend",h,h.gameObject,h.lastPointer)}}},init:function init(){this.state=c},eventEmitter:!1};return r.setRecongizedStateObject(new a.default(l)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Press,[{key:"resetFromJSON",value:function resetFromJSON(t){return _get(_getPrototypeOf(Press.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(h(t,"threshold",9)),this.setMinHoldTime(h(t,"time",251)),this}},{key:"onDragStart",value:function onDragStart(){this.state=0===this.holdTime?p:u}},{key:"onDragEnd",value:function onDragEnd(){this.state=c}},{key:"onDrag",value:function onDrag(){this.state!==c&&this.pointer.getDistance()>this.dragThreshold&&(this.state=c)}},{key:"preUpdate",value:function preUpdate(t,i){this.state===u&&(t-this.pointer.downTime>=this.holdTime&&(this.state=p))}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"setMinHoldTime",value:function setMinHoldTime(t){return this.holdTime=t,this}},{key:"isPressed",get:function get(){return this.state===p}}]),Press}(r.default),c="IDLE",u="BEGIN",p="RECOGNIZED";i.default=l},"./lib/plugins/input/gestures/rotate/Rotate.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js"),a=o("./lib/plugins/fsm.js"),h=o("./lib/plugins/input/gestures/rotate/SpinObject.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Phaser.Utils.Objects.GetValue,c=Phaser.Math.Angle.WrapDegrees,u=Phaser.Math.Angle.ShortestBetween,p=Phaser.Math.RadToDeg,d=Phaser.Math.DegToRad,m=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Rotate,t);var i=_createSuper(Rotate);function Rotate(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Rotate);var h=_assertThisInitialized(r=i.call(this,t,o)),l={states:{IDLE:{enter:function enter(){h.prevAngle=void 0,h.angle=0}},BEGIN:{},RECOGNIZED:{enter:function enter(){h.emit("rotatestart",h)},exit:function exit(){h.emit("rotateend",h)}}},init:function init(){this.state=g},eventEmitter:!1};return r.setRecongizedStateObject(new a.default(l)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Rotate,[{key:"resetFromJSON",value:function resetFromJSON(t){return _get(_getPrototypeOf(Rotate.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(l(t,"threshold",0)),this}},{key:"onDrag2Start",value:function onDrag2Start(){this.prevAngle=c(p(this.angleBetween)),this.state=0===this.rotationThreshold?v:_}},{key:"onDrag2End",value:function onDrag2End(){this.state=g}},{key:"onDrag2",value:function onDrag2(){switch(this.state){case _:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=c(p(this.angleBetween));this.angle=u(this.prevAngle,t),this.prevAngle=t,this.state=v}break;case v:t=c(p(this.angleBetween));this.angle=u(this.prevAngle,t),this.prevAngle=t,this.emit("rotate",this)}}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"isRotation",get:function get(){return this.state===v}},{key:"rotation",get:function get(){return d(this.angle)}}]),Rotate}(r.default),y={spinObject:h.default};Object.assign(m.prototype,y);var g="IDLE",_="BEGIN",v="RECOGNIZED";i.default=m},"./lib/plugins/input/gestures/rotate/SpinObject.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/actions/RotateObjectAround.js"),a={};i.default=function SpinObject(t,i){if(!this.isRotation)return this;void 0===i&&(i=this.pointers[0].camera);var o=this.movementCenterX,h=this.movementCenterY;i.getWorldPoint(this.centerX,this.centerY,a);var l=a.x,c=a.y,u=this.rotation;if(Array.isArray(t))for(var p=t,d=0,m=p.length;d<m;d++)(t=p[d]).x+=o,t.y+=h,Object(r.default)(t,l,c,u);else t.x+=o,t.y+=h,Object(r.default)(t,x,y,u);return this}},"./lib/plugins/input/gestures/swipe/Swipe.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js"),a=o("./lib/plugins/fsm.js"),h=o("./lib/plugins/input/gestures/swipe/VelocityMethods.js"),l=o("./lib/plugins/utils/math/angle/angletodirections/Const.js"),c=o("./lib/plugins/utils/math/angle/angletodirections/AngleToDirections.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=Phaser.Utils.Objects.GetValue,p=Phaser.Math.RadToDeg,d=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Swipe,t);var i=_createSuper(Swipe);function Swipe(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Swipe);var h=_assertThisInitialized(r=i.call(this,t,o)),l={states:{IDLE:{enter:function enter(){h.x=0,h.y=0,h.worldX=0,h.worldY=0},exit:function exit(){var t=h.lastPointer;h.x=t.x,h.y=t.y,h.worldX=t.worldX,h.worldY=t.worldY}},BEGIN:{enter:function enter(){h.validDrag=!1}},RECOGNIZED:{enter:function enter(){h.start(),h.updateDirectionStates(),h.emit("swipe",h,h.gameObject,h.lastPointer)},exit:function exit(){h.stop(),h.clearDirectionStates()}}},init:function init(){this.state=m},eventEmitter:!1};return r.setRecongizedStateObject(new a.default(l)),r.clearDirectionStates(),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Swipe,[{key:"resetFromJSON",value:function resetFromJSON(t){return _get(_getPrototypeOf(Swipe.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(u(t,"threshold",10)),this.setMinDragVelocity(u(t,"velocityThreshold",1e3)),this.setDirectionMode(u(t,"dir","8dir")),this}},{key:"onDragStart",value:function onDragStart(){this.state=y}},{key:"onDragEnd",value:function onDragEnd(){this.state=m}},{key:"onDrag",value:function onDrag(){this.state===y&&(this.vaildDrag||(this.vaildDrag=0===this.dragThreshold||this.pointer.getDistance()>=this.dragThreshold),this.vaildDrag&&this.dragVelocity>this.minDragVelocity&&(this.state=g))}},{key:"postUpdate",value:function postUpdate(t,i){this.state===g&&(this.state=m)}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"setMinDragVelocity",value:function setMinDragVelocity(t){return this.minDragVelocity=t,this}},{key:"setDirectionMode",value:function setDirectionMode(t){return"string"==typeof t&&(t=l.default[t]),this.dirMode=t,this}},{key:"updateDirectionStates",value:function updateDirectionStates(){var t=p(this.getVelocityAngle());return Object(c.default)(t,this.dirMode,this),this}},{key:"clearDirectionStates",value:function clearDirectionStates(){return this.left=!1,this.right=!1,this.up=!1,this.down=!1,this}},{key:"isSwiped",get:function get(){return this.state===g}},{key:"dragVelocity",get:function get(){var t;switch(this.dirMode){case 0:t=this.getVelocityY();break;case 1:t=this.getVelocityX();break;default:t=this.getVelocity()}return t}}]),Swipe}(r.default);Object.assign(d.prototype,h.default);var m="IDLE",y="BEGIN",g="RECOGNIZED";i.default=d},"./lib/plugins/input/gestures/swipe/VelocityMethods.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Math.Distance.Between,a=Phaser.Math.Angle.Between;i.default={getDt:function getDt(){return this.scene.sys.game.loop.delta},getVelocity:function getVelocity(){var t=this.pointer.position,i=this.pointer.prevPosition;return r(i.x,i.y,t.x,t.y)/(.001*this.getDt())},getVelocityX:function getVelocityX(){var t=this.pointer.position,i=this.pointer.prevPosition;return Math.abs(t.x-i.x)/(.001*this.getDt())},getVelocityY:function getVelocityY(){var t=this.pointer.position,i=this.pointer.prevPosition;return Math.abs(t.y-i.y)/(.001*this.getDt())},getVelocityAngle:function getVelocityAngle(){var t=this.pointer.position,i=this.pointer.prevPosition;return a(i.x,i.y,t.x,t.y)}}},"./lib/plugins/input/gestures/tap/Tap.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js"),a=o("./lib/plugins/fsm.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=Phaser.Math.Distance.Between,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Tap,t);var i=_createSuper(Tap);function Tap(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Tap);var h=_assertThisInitialized(r=i.call(this,t,o)),l={states:{IDLE:{enter:function enter(){h.stop(),h.tapsCount=0,h.x=0,h.y=0,h.worldX=0,h.worldY=0},exit:function exit(){var t=h.lastPointer;h.x=t.x,h.y=t.y,h.worldX=t.worldX,h.worldY=t.worldY}},BEGIN:{enter:function enter(){h.start(),h.tapsCount=0,h.emit("tappingstart",h,h.gameObject,h.lastPointer)}},RECOGNIZED:{enter:function enter(){h.start(),h.emit("tap",h,h.gameObject,h.lastPointer),h.emit("".concat(h.tapsCount,"tap"),h,h.gameObject,h.lastPointer)}}},init:function init(){this.state=u},eventEmitter:!1};return r.setRecongizedStateObject(new a.default(l)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Tap,[{key:"resetFromJSON",value:function resetFromJSON(t){_get(_getPrototypeOf(Tap.prototype),"resetFromJSON",this).call(this,t),this.setMaxHoldTime(h(t,"time",250)),this.setTapInterval(h(t,"tapInterval",200)),this.setDragThreshold(h(t,"threshold",9)),this.setTapOffset(h(t,"tapOffset",10));var i=h(t,"taps",void 0);return void 0!==i?this.setTaps(i):(this.setMaxTaps(h(t,"maxTaps",void 0)),this.setMinTaps(h(t,"minTaps",void 0))),this}},{key:"onDragStart",value:function onDragStart(){switch(this.state){case u:this.state=p;break;case p:var t=this.lastPointer;l(t.upX,t.upY,t.x,t.y)>this.tapOffset&&(this.state=d,this.state=p);break;case d:this.state=p}}},{key:"onDragEnd",value:function onDragEnd(){this.state===p&&(this.tapsCount++,this.emit("tapping",this,this.gameObject,this.lastPointer),void 0!==this.maxTaps&&this.tapsCount===this.maxTaps&&(this.state=d))}},{key:"onDrag",value:function onDrag(){this.state!==u&&this.pointer.getDistance()>this.dragThreshold&&(this.state=u)}},{key:"preUpdate",value:function preUpdate(t,i){if(this.state===p){var o=this.lastPointer;if(o.isDown)t-o.downTime>this.holdTime&&(this.state=u);else t-o.upTime>this.tapInterval&&(void 0===this.minTaps||this.tapsCount>=this.minTaps?this.state=d:this.state=u)}}},{key:"postUpdate",value:function postUpdate(t,i){this.state===d&&(this.state=u)}},{key:"setMaxHoldTime",value:function setMaxHoldTime(t){return this.holdTime=t,this}},{key:"setTapInterval",value:function setTapInterval(t){return this.tapInterval=t,this}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"setTapOffset",value:function setTapOffset(t){return this.tapOffset=t,this}},{key:"setMaxTaps",value:function setMaxTaps(t){return this.maxTaps=t,this}},{key:"setMinTaps",value:function setMinTaps(t){return this.minTaps=t,this}},{key:"setTaps",value:function setTaps(t,i){return void 0===i&&(i=t),this.setMinTaps(t).setMaxTaps(i),this}},{key:"isTapped",get:function get(){return this.state===d}}]),Tap}(r.default),u="IDLE",p="BEGIN",d="RECOGNIZED";i.default=c},"./lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js"),a=o("./lib/plugins/utils/object/Clear.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=Phaser.Utils.Objects.GetValue,l=Phaser.Utils.Array.SpliceOne,c=Phaser.Math.Distance.Between,u=Phaser.Math.Angle.Between,p=function(){function TwoPointersTracer(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TwoPointersTracer);var o=t.input.manager.pointersTotal-1;o<2&&t.input.addPointer(2-o),this.scene=t,this.setEventEmitter(h(i,"eventEmitter",void 0)),this.pointers=[],this.movedState={},this.resetFromJSON(i),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TwoPointersTracer,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setEnable(h(t,"enable",!0)),this.bounds=h(t,"bounds",void 0),this.tracerState=m,this.pointers.length=0,Object(a.default)(this.movedState),this}},{key:"boot",value:function boot(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function shutdown(){this.destroyEventEmitter(),this.pointers.length=0,Object(a.default)(this.movedState),this.scene&&(this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable===t||(t||this.dragCancel(),this.enable=t),this}},{key:"onPointerDown",value:function onPointerDown(t){if(this.enable&&(2!==this.pointers.length&&(!this.bounds||this.bounds.contains(t.x,t.y))&&-1===this.pointers.indexOf(t)))switch(this.movedState[t.id]=!1,this.pointers.push(t),this.tracerState){case m:this.tracerState=y,this.onDrag1Start();break;case y:this.tracerState=g,this.onDrag2Start()}}},{key:"onPointerUp",value:function onPointerUp(t){if(this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))){var i=this.pointers.indexOf(t);if(-1!==i)switch(delete this.movedState[t.id],l(this.pointers,i),this.tracerState){case y:this.tracerState=m,this.onDrag1End();break;case g:this.tracerState=y,this.onDrag2End(),this.onDrag1Start()}}}},{key:"onPointerMove",value:function onPointerMove(t){if(this.enable&&t.isDown){var i=!this.bounds||this.bounds.contains(t.x,t.y),o=-1!==this.pointers.indexOf(t);if(!o&&i);else if(o&&!i)this.onPointerUp(t);else if(this.movedState[t.id]||(this.movedState[t.id]=t.x!==t.downX||t.y!==t.downY),this.movedState[t.id])switch(this.tracerState){case y:this.onDrag1();break;case g:this.onDrag2()}}}},{key:"dragCancel",value:function dragCancel(){return this.tracerState===g&&this.onDrag2End(),this.pointers.length=0,Object(a.default)(this.movedState),this.tracerState=m,this}},{key:"onDrag1Start",value:function onDrag1Start(){this.emit("drag1start",this)}},{key:"onDrag1End",value:function onDrag1End(){this.emit("drag1end",this)}},{key:"onDrag1",value:function onDrag1(){this.emit("drag1",this)}},{key:"onDrag2Start",value:function onDrag2Start(){this.emit("drag2start",this)}},{key:"onDrag2End",value:function onDrag2End(){this.emit("drag2end",this)}},{key:"onDrag2",value:function onDrag2(){this.emit("drag2",this)}},{key:"setRecongizedStateObject",value:function setRecongizedStateObject(t){return this.recongizedState=t,this}},{key:"cancel",value:function cancel(){return this.state=_,this}},{key:"distanceBetween",get:function get(){if(this.tracerState!==g)return 0;var t=this.pointers[0],i=this.pointers[1];return c(t.x,t.y,i.x,i.y)}},{key:"angleBetween",get:function get(){if(this.tracerState!==g)return 0;var t=this.pointers[0],i=this.pointers[1];return u(t.x,t.y,i.x,i.y)}},{key:"drag1Vector",get:function get(){var t=this.pointers[0];if(t&&this.movedState[t.id]){var i=t.position,o=t.prevPosition;d.x=i.x-o.x,d.y=i.y-o.y}else d.x=0,d.y=0;return d}},{key:"centerX",get:function get(){if(this.tracerState!==g)return 0;var t=this.pointers[0].position,i=this.pointers[1].position;return(t.x+i.x)/2}},{key:"centerY",get:function get(){if(this.tracerState!==g)return 0;var t=this.pointers[0].position,i=this.pointers[1].position;return(t.y+i.y)/2}},{key:"prevCenterX",get:function get(){if(this.tracerState!==g)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,i=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.x+i.x)/2}},{key:"prevCenterY",get:function get(){if(this.tracerState!==g)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,i=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.y+i.y)/2}},{key:"movementCenterX",get:function get(){return this.centerX-this.prevCenterX}},{key:"movementCenterY",get:function get(){return this.centerY-this.prevCenterY}},{key:"state",get:function get(){return this.recongizedState.state},set:function set(t){this.recongizedState.state=t}}]),TwoPointersTracer}();Object.assign(p.prototype,r.default);var d={},m=0,y=1,g=2,_="IDLE";i.default=p},"./lib/plugins/input/scroller/Scroller.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/system/GetSceneObject.js"),a=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js"),h=o("./lib/plugins/input/scroller/State.js"),l=o("./lib/plugins/dragspeed.js"),c=o("./lib/plugins/utils/movement/SlowDown.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=Phaser.Utils.Objects.GetValue,p=function(){function Scroller(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Scroller),this.gameObject=t,this.scene=Object(r.default)(t),this.setEventEmitter(u(i,"eventEmitter",void 0));var o=u(i,"enable",!0),a={enable:o,eventEmitter:!1};this._state=new h.default(this,a);var p={inputConfig:u(i,"inputConfig",void 0),enable:o,eventEmitter:!1};this.dragState=new l.default(t,p),this._value=void 0,this._slowDown=new c.default;var d=u(i,"valuechangeCallback",null);if(null!==d){var m=u(i,"valuechangeCallbackScope",void 0);this.on("valuechange",d,m)}if(null!==(d=u(i,"overmaxCallback",null))){m=u(i,"overmaxCallbackScope",void 0);this.on("overmax",d,m)}if(null!==(d=u(i,"overminCallback",null))){m=u(i,"overminCallbackScope",void 0);this.on("overmin",d,m)}this.resetFromJSON(i),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Scroller,[{key:"resetFromJSON",value:function resetFromJSON(t){this.setOrientationMode(u(t,"orientation",0)),this.setDragThreshold(u(t,"threshold",10)),this.setSlidingDeceleration(u(t,"slidingDeceleration",5e3)),this.setBackDeceleration(u(t,"backDeceleration",2e3)),this.boundPad0=u(t,"boundPad0",0),this.boundPad1=u(t,"boundPad1",0);var i=u(t,"bounds",void 0);return i?this.setBounds(i):this.setBounds(u(t,"max",0),u(t,"min",0)),this.setValue(u(t,"value",this.maxValue||0+this.boundPad1)),this.setEnable(u(t,"enable",!0)),this}},{key:"boot",value:function boot(){this.scene.events.on("update",this._state.update,this._state),this.gameObject.on("destroy",this.destroy,this)}},{key:"shutdown",value:function shutdown(){this.destroyEventEmitter(),this.scene&&this.scene.events.off("update",this._state.update,this._state),this.gameObject=void 0,this.scene=void 0,this._state.destroy(),this.dragState.destroy()}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"setOrientationMode",value:function setOrientationMode(t){return"string"==typeof t&&(t=d[t]),this.orientationMode=t,this}},{key:"setDragThreshold",value:function setDragThreshold(t){return this.dragThreshold=t,this}},{key:"setSlidingDeceleration",value:function setSlidingDeceleration(t){return this.slidingDeceleration=t,this}},{key:"setBackDeceleration",value:function setBackDeceleration(t){return this.backDeceleration=t,this}},{key:"setBounds",value:function setBounds(t,i){if(Array.isArray(t)){var o=t;t=o[0],i=o[1]}return t<i?(this.minValue=t+this.boundPad0,this.maxValue=i+this.boundPad1):(this.minValue=i+this.boundPad0,this.maxValue=t+this.boundPad1),this}},{key:"setValue",value:function setValue(t){this.value=t}},{key:"setEnable",value:function setEnable(t){return this._state.setEnable(t),this.dragState.setEnable(t),this}},{key:"overMax",value:function overMax(t){return null!=this.maxValue&&t>this.maxValue}},{key:"overMin",value:function overMin(t){return null!=this.minValue&&t<this.minValue}},{key:"dragging",value:function dragging(){this.value+=this.dragDelta}},{key:"onSliding",value:function onSliding(){var t=this.value,i=this.dragSpeed;if(0===i)return this._slowDown.stop(),void this._state.next();var o=this.slidingDeceleration;this._slowDown.init(t,i>0,Math.abs(i),o)}},{key:"sliding",value:function sliding(t,i){i*=.001;var o=this._slowDown.update(i).value;this.overMax(o)?(this.value=this.maxValue,this._slowDown.stop()):this.overMin(o)?(this.value=this.minValue,this._slowDown.stop()):this.value=o}},{key:"onPullBack",value:function onPullBack(){var t=this.value,i=this.outOfMinBound?this.minValue:this.maxValue,o=Math.abs(i-t),r=this.backDeceleration,a=Math.sqrt(2*r*o);this._slowDown.init(t,void 0,a,r,i)}},{key:"pullBack",value:function pullBack(t,i){i*=.001,this.value=this._slowDown.update(i).value,this._slowDown.isMoving||this._state.next()}},{key:"stop",value:function stop(){this._slowDown.stop()}},{key:"value",get:function get(){return this._value},set:function set(t){if(t!==this._value){var i=this._value,o=this.overMax(t),r=this.overMin(t);o&&this.emit("overmax",t,i),r&&this.emit("overmin",t,i),this.backEnable||(o&&(t=this.maxValue),r&&(t=this.minValue)),this._value=t,this.emit("valuechange",t,i)}}},{key:"state",get:function get(){return this._state.state}},{key:"isDragging",get:function get(){return this.dragState.isInTouched}},{key:"outOfMaxBound",get:function get(){return this.overMax(this.value)}},{key:"outOfMinBound",get:function get(){return this.overMin(this.value)}},{key:"outOfBounds",get:function get(){return this.outOfMinBound||this.outOfMaxBound}},{key:"backEnable",get:function get(){return"number"==typeof this.backDeceleration}},{key:"isPullBack",get:function get(){return this._slowDown.isMoving}},{key:"slidingEnable",get:function get(){return"number"==typeof this.slidingDeceleration}},{key:"isSliding",get:function get(){return this._slowDown.isMoving}},{key:"dragDelta",get:function get(){return 0===this.orientationMode?this.dragState.dy:1===this.orientationMode?this.dragState.dx:0}},{key:"dragSpeed",get:function get(){return 0===this.orientationMode?this.dragState.speedY:1===this.orientationMode?this.dragState.speedX:0}}]),Scroller}();Object.assign(p.prototype,a.default);var d={y:0,v:0,vertical:0,x:1,h:1,horizontal:1};i.default=p},"./lib/plugins/input/scroller/State.js":function(t,i,o){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}o.r(i);var r=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(State,t);var i=_createSuper(State);function State(t,o){var r;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,State),(r=i.call(this,o)).parent=t,r.init(),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(State,[{key:"init",value:function init(){this.start("IDLE")}},{key:"next_IDLE",value:function next_IDLE(){var t,i=this.parent;return i.dragState.isDown&&(t=0===i.dragThreshold?"DRAG":"DRAGBEGIN"),t}},{key:"update_IDLE",value:function update_IDLE(t,i){this.next()}},{key:"next_DRAGBEGIN",value:function next_DRAGBEGIN(){var t=this.parent,i=t.dragState;return i.isDown?i.pointer.getDistance()>=t.dragThreshold?"DRAG":"DRAGBEGIN":"IDLE"}},{key:"update_DRAGBEGIN",value:function update_DRAGBEGIN(t,i){this.next()}},{key:"next_DRAG",value:function next_DRAG(){var t,i=this.parent;return i.dragState.isUp&&(t=i.outOfBounds?"BACK":i.slidingEnable?"SLIDE":"IDLE"),t}},{key:"update_DRAG",value:function update_DRAG(t,i){var o=this.parent;o.dragState.justMoved&&o.dragging(),this.next()}},{key:"next_SLIDE",value:function next_SLIDE(){var t,i=this.parent;return i.dragState.isDown?t="DRAG":i.isSliding||(t="IDLE"),t}},{key:"enter_SLIDE",value:function enter_SLIDE(){this.parent.onSliding()}},{key:"exit_SLIDE",value:function exit_SLIDE(){this.parent.stop()}},{key:"update_SLIDE",value:function update_SLIDE(t,i){this.parent.sliding(t,i),this.next()}},{key:"next_BACK",value:function next_BACK(){var t,i=this.parent;return i.dragState.isDown?t="DRAG":i.isPullBack||(t="IDLE"),t}},{key:"enter_BACK",value:function enter_BACK(){this.parent.onPullBack()}},{key:"exit_BACK",value:function exit_BACK(){this.parent.stop()}},{key:"update_BACK",value:function update_BACK(t,i){this.parent.pullBack(t,i),this.next()}}]),State}(o("./lib/plugins/fsm.js").default);i.default=r},"./lib/plugins/logic/fsm/FSM.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js"),a=o("./lib/plugins/utils/object/GetValue.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function FSM(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,FSM);var i=Object(a.default)(t,"states",void 0);i&&this.addStates(i);var o=Object(a.default)(t,"extend",void 0);if(o)for(var r in o)this.hasOwnProperty(r)&&void 0!==this[r]||(this[r]=o[r]);var h=Object(a.default)(t,"eventEmitter",void 0),l=Object(a.default)(t,"EventEmitterClass",void 0);this.setEventEmitter(h,l),this._stateLock=!1,this.resetFromJSON(t)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(FSM,[{key:"shutdown",value:function shutdown(){this.destroyEventEmitter()}},{key:"destroy",value:function destroy(){this.shutdown()}},{key:"resetFromJSON",value:function resetFromJSON(t){this.setEnable(Object(a.default)(t,"enable",!0)),this.start(Object(a.default)(t,"start",void 0));var i=Object(a.default)(t,"init",void 0);return i&&i.call(this),this}},{key:"toJSON",value:function toJSON(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}}},{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"start",value:function start(t){return this._start=t,this._prevState=void 0,this._state=t,this}},{key:"goto",value:function goto(t){return null!=t&&(this.state=t),this}},{key:"next",value:function next(){var t,i=this["next_"+this.state];return i&&(t="string"==typeof i?i:i.call(this)),this.goto(t),this}},{key:"addState",value:function addState(t,i){var o=Object(a.default)(i,"next",void 0);o&&(this["next_"+t]=o);var r=Object(a.default)(i,"exit",void 0);r&&(this["exit_"+t]=r);var h=Object(a.default)(i,"enter",void 0);return h&&(this["enter_"+t]=h),this}},{key:"addStates",value:function addStates(t){for(var i in t)this.addState(i,t[i]);return this}},{key:"update",value:function update(t,i,o){void 0===o&&(o="update");var r=this[o+"_"+this.state];r&&r.call(this,t,i)}},{key:"preupdate",value:function preupdate(t,i){this.update(t,i,"preupdate")}},{key:"postupdate",value:function postupdate(t,i){this.update(t,i,"postupdate")}},{key:"state",set:function set(t){if(this.enable&&!this._stateLock&&this._state!==t){if(this._prevState=this._state,this._state=t,this._stateLock=!0,this.emit("statechange",this),null!=this._prevState){var i="exit_"+this._prevState,o=this[i];o&&o.call(this),this.emit(i,this)}if(this._stateLock=!1,null!=this._state){var r="enter_"+this._state,a=this[r];a&&a.call(this),this.emit(r,this)}}},get:function get(){return this._state}},{key:"prevState",get:function get(){return this._prevState}}]),FSM}();Object.assign(h.prototype,r.default),i.default=h},"./lib/plugins/pool.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/struct/Stack.js");i.default=r.default},"./lib/plugins/popup.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/scale.js"),a={};i.default=function PopUp(t,i,o,h,l){switch(a.mode=0,o){case 0:case"x":a.start={x:0};break;case 1:case"y":a.start={y:0};break;default:a.start=0}return a.end=1,a.duration=i,a.ease=void 0===h?"Cubic":h,void 0===l?l=new r.default(t,a):l.resetFromJSON(a),l.restart(),l}},"./lib/plugins/scale-down-destroy.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/scale.js"),a={};i.default=function ScaleDownDestroy(t,i,o,h,l,c){switch(l instanceof r.default&&(c=l,l=void 0),void 0===l&&(l=!0),a.mode=l?1:0,o){case 0:case"x":a.end={x:0};break;case 1:case"y":a.end={y:0};break;default:a.end=0}return a.duration=i,a.ease=void 0===h?"Linear":h,void 0===c?c=new r.default(t,a):c.resetFromJSON(a),c.restart(),c}},"./lib/plugins/scale.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/scale/Scale.js");i.default=r.default},"./lib/plugins/scroller.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/scroller/Scroller.js");i.default=r.default},"./lib/plugins/utils/actions/GlobZone.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/object/NOOP.js"),a=new Phaser.GameObjects.Zone({sys:{queueDepthSort:r.default,events:{once:r.default}}},0,0,1,1);a.setOrigin(0),i.default=a},"./lib/plugins/utils/actions/RotateObjectAround.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Math.RotateAround;i.default=function RotateObjectAround(t,i,o,a){return r(t,i,o,a),t.rotation+=a,t}},"./lib/plugins/utils/align/align/const.js":function(t,i,o){"use strict";o.r(i);i.default={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12}},"./lib/plugins/utils/align/align/in/BottomCenter.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetBottom.js"),a=o("./lib/plugins/utils/align/bounds/GetCenterX.js"),h=o("./lib/plugins/utils/align/bounds/SetBottom.js"),l=o("./lib/plugins/utils/align/bounds/SetCenterX.js");i.default=function BottomCenter(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(l.default)(t,Object(a.default)(i)+o),Object(h.default)(t,Object(r.default)(i)+c),t}},"./lib/plugins/utils/align/align/in/BottomLeft.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetBottom.js"),a=o("./lib/plugins/utils/align/bounds/GetLeft.js"),h=o("./lib/plugins/utils/align/bounds/SetBottom.js"),l=o("./lib/plugins/utils/align/bounds/SetLeft.js");i.default=function BottomLeft(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(l.default)(t,Object(a.default)(i)-o),Object(h.default)(t,Object(r.default)(i)+c),t}},"./lib/plugins/utils/align/align/in/BottomRight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetBottom.js"),a=o("./lib/plugins/utils/align/bounds/GetRight.js"),h=o("./lib/plugins/utils/align/bounds/SetBottom.js"),l=o("./lib/plugins/utils/align/bounds/SetRight.js");i.default=function BottomRight(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(l.default)(t,Object(a.default)(i)+o),Object(h.default)(t,Object(r.default)(i)+c),t}},"./lib/plugins/utils/align/align/in/Center.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/CenterOn.js"),a=o("./lib/plugins/utils/align/bounds/GetCenterX.js"),h=o("./lib/plugins/utils/align/bounds/GetCenterY.js");i.default=function Center(t,i,o,l){return void 0===o&&(o=0),void 0===l&&(l=0),Object(r.default)(t,Object(a.default)(i)+o,Object(h.default)(i)+l),t}},"./lib/plugins/utils/align/align/in/LeftCenter.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetCenterY.js"),a=o("./lib/plugins/utils/align/bounds/GetLeft.js"),h=o("./lib/plugins/utils/align/bounds/SetCenterY.js"),l=o("./lib/plugins/utils/align/bounds/SetLeft.js");i.default=function LeftCenter(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(l.default)(t,Object(a.default)(i)-o),Object(h.default)(t,Object(r.default)(i)+c),t}},"./lib/plugins/utils/align/align/in/QuickSet.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/align/const.js"),a=o("./lib/plugins/utils/align/align/in/BottomCenter.js"),h=o("./lib/plugins/utils/align/align/in/BottomLeft.js"),l=o("./lib/plugins/utils/align/align/in/BottomRight.js"),c=o("./lib/plugins/utils/align/align/in/Center.js"),u=o("./lib/plugins/utils/align/align/in/LeftCenter.js"),p=o("./lib/plugins/utils/align/align/in/RightCenter.js"),d=o("./lib/plugins/utils/align/align/in/TopCenter.js"),m=o("./lib/plugins/utils/align/align/in/TopLeft.js"),y=o("./lib/plugins/utils/align/align/in/TopRight.js"),g=[];g[r.default.BOTTOM_CENTER]=a.default,g[r.default.BOTTOM_LEFT]=h.default,g[r.default.BOTTOM_RIGHT]=l.default,g[r.default.CENTER]=c.default,g[r.default.LEFT_CENTER]=u.default,g[r.default.RIGHT_CENTER]=p.default,g[r.default.TOP_CENTER]=d.default,g[r.default.TOP_LEFT]=m.default,g[r.default.TOP_RIGHT]=y.default;i.default=function QuickSet(t,i,o,r,a){return g[o](t,i,r,a)}},"./lib/plugins/utils/align/align/in/RightCenter.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetCenterY.js"),a=o("./lib/plugins/utils/align/bounds/GetRight.js"),h=o("./lib/plugins/utils/align/bounds/SetCenterY.js"),l=o("./lib/plugins/utils/align/bounds/SetRight.js");i.default=function RightCenter(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(l.default)(t,Object(a.default)(i)+o),Object(h.default)(t,Object(r.default)(i)+c),t}},"./lib/plugins/utils/align/align/in/TopCenter.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetCenterX.js"),a=o("./lib/plugins/utils/align/bounds/GetTop.js"),h=o("./lib/plugins/utils/align/bounds/SetCenterX.js"),l=o("./lib/plugins/utils/align/bounds/SetTop.js");i.default=function TopCenter(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(h.default)(t,Object(r.default)(i)+o),Object(l.default)(t,Object(a.default)(i)-c),t}},"./lib/plugins/utils/align/align/in/TopLeft.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetLeft.js"),a=o("./lib/plugins/utils/align/bounds/GetTop.js"),h=o("./lib/plugins/utils/align/bounds/SetLeft.js"),l=o("./lib/plugins/utils/align/bounds/SetTop.js");i.default=function TopLeft(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(h.default)(t,Object(r.default)(i)-o),Object(l.default)(t,Object(a.default)(i)-c),t}},"./lib/plugins/utils/align/align/in/TopRight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/GetRight.js"),a=o("./lib/plugins/utils/align/bounds/GetTop.js"),h=o("./lib/plugins/utils/align/bounds/SetRight.js"),l=o("./lib/plugins/utils/align/bounds/SetTop.js");i.default=function TopRight(t,i,o,c){return void 0===o&&(o=0),void 0===c&&(c=0),Object(h.default)(t,Object(r.default)(i)+o),Object(l.default)(t,Object(a.default)(i)-c),t}},"./lib/plugins/utils/align/bounds/CenterOn.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/bounds/SetCenterX.js"),a=o("./lib/plugins/utils/align/bounds/SetCenterY.js");i.default=function CenterOn(t,i,o){return Object(r.default)(t,i),Object(a.default)(t,o)}},"./lib/plugins/utils/align/bounds/GetBottom.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetBottom(t){var i=Object(r.GetDisplayHeight)(t);return t.y+i-i*t.originY}},"./lib/plugins/utils/align/bounds/GetCenterX.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetCenterX(t){var i=Object(r.GetDisplayWidth)(t);return t.x-i*t.originX+.5*i}},"./lib/plugins/utils/align/bounds/GetCenterY.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetCenterY(t){var i=Object(r.GetDisplayHeight)(t);return t.y-i*t.originY+.5*i}},"./lib/plugins/utils/align/bounds/GetLeft.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetLeft(t){var i=Object(r.GetDisplayWidth)(t);return t.x-i*t.originX}},"./lib/plugins/utils/align/bounds/GetRight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetRight(t){var i=Object(r.GetDisplayWidth)(t);return t.x+i-i*t.originX}},"./lib/plugins/utils/align/bounds/GetTop.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetTop(t){var i=Object(r.GetDisplayHeight)(t);return t.y-i*t.originY}},"./lib/plugins/utils/align/bounds/SetBottom.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetBottom(t,i){var o=Object(r.GetDisplayHeight)(t);return t.y=i-o+o*t.originY,t}},"./lib/plugins/utils/align/bounds/SetCenterX.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetCenterX(t,i){var o=Object(r.GetDisplayWidth)(t),a=o*t.originX;return t.x=i+a-.5*o,t}},"./lib/plugins/utils/align/bounds/SetCenterY.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetCenterY(t,i){var o=Object(r.GetDisplayHeight)(t),a=o*t.originY;return t.y=i+a-.5*o,t}},"./lib/plugins/utils/align/bounds/SetLeft.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetLeft(t,i){var o=Object(r.GetDisplayWidth)(t);return t.x=i+o*t.originX,t}},"./lib/plugins/utils/align/bounds/SetRight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetRight(t,i){var o=Object(r.GetDisplayWidth)(t);return t.x=i-o+o*t.originX,t}},"./lib/plugins/utils/align/bounds/SetTop.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function SetTop(t,i){var o=Object(r.GetDisplayHeight)(t);return t.y=i+o*t.originY,t}},"./lib/plugins/utils/data/DataMethods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/object/GetValue.js"),a=o("./lib/plugins/utils/object/Clear.js"),h=o("./lib/plugins/utils/object/Clone.js");i.default={enableData:function enableData(){return void 0===this.data&&(this.data={}),this},getData:function getData(t,i){return this.enableData(),void 0===t?this.data:Object(r.default)(this.data,t,i)},setData:function setData(t,i){return this.enableData(),this.data[t]=i,this},incData:function incData(t,i,o){return void 0===o&&(o=0),this.enableData(),this.setData(t,this.getData(t,o)+i),this},mulData:function mulData(t,i,o){return void 0===o&&(o=0),this.enableData(),this.setData(t,this.getData(t,o)*i),this},clearData:function clearData(){return this.data&&Object(a.default)(this.data),this},resetData:function resetData(t){if(this.clearData(),t)for(var i in this.enableData(),t)this.data[i]=t[i];return this},cloneData:function cloneData(){return this.data?Object(h.default)(this.data):{}}}},"./lib/plugins/utils/defaultbounds/GetDefaultBounds.js":function(t,i,o){"use strict";o.r(i);var r;i.default=function GetDefaultBounds(t,i){void 0===i&&(void 0===r&&(r=new Phaser.Geom.Rectangle),i=r);var o=t.game.config;return i.setTo(0,0,o.width,o.height),i}},"./lib/plugins/utils/eventemitter/EventEmitterMethods.js":function(t,i,o){"use strict";o.r(i),i.default={setEventEmitter:function setEventEmitter(t,i){return void 0===i&&(i=Phaser.Events.EventEmitter),this._privateEE=void 0===t,this._eventEmitter=this._privateEE?new i:t,this},destroyEventEmitter:function destroyEventEmitter(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function getEventEmitter(){return this._eventEmitter},on:function on(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function once(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function off(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function emit(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function addListener(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function removeListener(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function removeAllListeners(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function listenerCount(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function listeners(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]}}},"./lib/plugins/utils/geom/polygon/Earcut.js":function(t,i,o){"use strict";function earcut(t,i,o){o=o||2;var r,a,h,l,c,u,p,d=i&&i.length,m=d?i[0]*o:t.length,y=linkedList(t,0,m,o,!0),g=[];if(!y||y.next===y.prev)return g;if(d&&(y=function eliminateHoles(t,i,o,r){var a,h,l,c,u,p=[];for(a=0,h=i.length;a<h;a++)l=i[a]*r,c=a<h-1?i[a+1]*r:t.length,(u=linkedList(t,l,c,r,!1))===u.next&&(u.steiner=!0),p.push(getLeftmost(u));for(p.sort(compaTooqing),a=0;a<p.length;a++)eliminateHole(p[a],o),o=filterPoints(o,o.next);return o}(t,i,y,o)),t.length>80*o){r=h=t[0],a=l=t[1];for(var _=o;_<m;_+=o)(c=t[_])<r&&(r=c),(u=t[_+1])<a&&(a=u),c>h&&(h=c),u>l&&(l=u);p=0!==(p=Math.max(h-r,l-a))?1/p:0}return earcutLinked(y,g,o,r,a,p),g}function linkedList(t,i,o,r,a){var h,l;if(a===signedArea(t,i,o,r)>0)for(h=i;h<o;h+=r)l=insertNode(h,t[h],t[h+1],l);else for(h=o-r;h>=i;h-=r)l=insertNode(h,t[h],t[h+1],l);return l&&equals(l,l.next)&&(removeNode(l),l=l.next),l}function filterPoints(t,i){if(!t)return t;i||(i=t);var o,r=t;do{if(o=!1,r.steiner||!equals(r,r.next)&&0!==area(r.prev,r,r.next))r=r.next;else{if(removeNode(r),(r=i=r.prev)===r.next)break;o=!0}}while(o||r!==i);return i}function earcutLinked(t,i,o,r,a,h,l){if(t){!l&&h&&function indexCurve(t,i,o,r){var a=t;do{null===a.z&&(a.z=zOrder(a.x,a.y,i,o,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==t);a.prevZ.nextZ=null,a.prevZ=null,function sortLinked(t){var i,o,r,a,h,l,c,u,p=1;do{for(o=t,t=null,h=null,l=0;o;){for(l++,r=o,c=0,i=0;i<p&&(c++,r=r.nextZ);i++);for(u=p;c>0||u>0&&r;)0!==c&&(0===u||!r||o.z<=r.z)?(a=o,o=o.nextZ,c--):(a=r,r=r.nextZ,u--),h?h.nextZ=a:t=a,a.prevZ=h,h=a;o=r}h.nextZ=null,p*=2}while(l>1);return t}(a)}(t,r,a,h);for(var c,u,p=t;t.prev!==t.next;)if(c=t.prev,u=t.next,h?isEarHashed(t,r,a,h):isEar(t))i.push(c.i/o),i.push(t.i/o),i.push(u.i/o),removeNode(t),t=u.next,p=u.next;else if((t=u)===p){l?1===l?earcutLinked(t=cureLocalIntersections(t,i,o),i,o,r,a,h,2):2===l&&splitEarcut(t,i,o,r,a,h):earcutLinked(filterPoints(t),i,o,r,a,h,1);break}}}function isEar(t){var i=t.prev,o=t,r=t.next;if(area(i,o,r)>=0)return!1;for(var a=t.next.next;a!==t.prev;){if(pointInTriangle(i.x,i.y,o.x,o.y,r.x,r.y,a.x,a.y)&&area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function isEarHashed(t,i,o,r){var a=t.prev,h=t,l=t.next;if(area(a,h,l)>=0)return!1;for(var c=a.x<h.x?a.x<l.x?a.x:l.x:h.x<l.x?h.x:l.x,u=a.y<h.y?a.y<l.y?a.y:l.y:h.y<l.y?h.y:l.y,p=a.x>h.x?a.x>l.x?a.x:l.x:h.x>l.x?h.x:l.x,d=a.y>h.y?a.y>l.y?a.y:l.y:h.y>l.y?h.y:l.y,m=zOrder(c,u,i,o,r),y=zOrder(p,d,i,o,r),g=t.prevZ,_=t.nextZ;g&&g.z>=m&&_&&_.z<=y;){if(g!==t.prev&&g!==t.next&&pointInTriangle(a.x,a.y,h.x,h.y,l.x,l.y,g.x,g.y)&&area(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,_!==t.prev&&_!==t.next&&pointInTriangle(a.x,a.y,h.x,h.y,l.x,l.y,_.x,_.y)&&area(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;g&&g.z>=m;){if(g!==t.prev&&g!==t.next&&pointInTriangle(a.x,a.y,h.x,h.y,l.x,l.y,g.x,g.y)&&area(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;_&&_.z<=y;){if(_!==t.prev&&_!==t.next&&pointInTriangle(a.x,a.y,h.x,h.y,l.x,l.y,_.x,_.y)&&area(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function cureLocalIntersections(t,i,o){var r=t;do{var a=r.prev,h=r.next.next;!equals(a,h)&&intersects(a,r,r.next,h)&&locallyInside(a,h)&&locallyInside(h,a)&&(i.push(a.i/o),i.push(r.i/o),i.push(h.i/o),removeNode(r),removeNode(r.next),r=t=h),r=r.next}while(r!==t);return r}function splitEarcut(t,i,o,r,a,h){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&isValidDiagonal(l,c)){var u=splitPolygon(l,c);return l=filterPoints(l,l.next),u=filterPoints(u,u.next),earcutLinked(l,i,o,r,a,h),void earcutLinked(u,i,o,r,a,h)}c=c.next}l=l.next}while(l!==t)}function compaTooqing(t,i){return t.x-i.x}function eliminateHole(t,i){if(i=function findHoleBridge(t,i){var o,r=i,a=t.x,h=t.y,l=-1/0;do{if(h<=r.y&&h>=r.next.y&&r.next.y!==r.y){var c=r.x+(h-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(c<=a&&c>l){if(l=c,c===a){if(h===r.y)return r;if(h===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==i);if(!o)return null;if(a===l)return o.prev;var u,p=o,d=o.x,m=o.y,y=1/0;r=o.next;for(;r!==p;)a>=r.x&&r.x>=d&&a!==r.x&&pointInTriangle(h<m?a:l,h,d,m,h<m?l:a,h,r.x,r.y)&&((u=Math.abs(h-r.y)/(a-r.x))<y||u===y&&r.x>o.x)&&locallyInside(r,t)&&(o=r,y=u),r=r.next;return o}(t,i)){var o=splitPolygon(i,t);filterPoints(o,o.next)}}function zOrder(t,i,o,r,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-o)*a)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-r)*a)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function getLeftmost(t){var i=t,o=t;do{i.x<o.x&&(o=i),i=i.next}while(i!==t);return o}function pointInTriangle(t,i,o,r,a,h,l,c){return(a-l)*(i-c)-(t-l)*(h-c)>=0&&(t-l)*(r-c)-(o-l)*(i-c)>=0&&(o-l)*(h-c)-(a-l)*(r-c)>=0}function isValidDiagonal(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function intersectsPolygon(t,i){var o=t;do{if(o.i!==t.i&&o.next.i!==t.i&&o.i!==i.i&&o.next.i!==i.i&&intersects(o,o.next,t,i))return!0;o=o.next}while(o!==t);return!1}(t,i)&&locallyInside(t,i)&&locallyInside(i,t)&&function middleInside(t,i){var o=t,r=!1,a=(t.x+i.x)/2,h=(t.y+i.y)/2;do{o.y>h!=o.next.y>h&&o.next.y!==o.y&&a<(o.next.x-o.x)*(h-o.y)/(o.next.y-o.y)+o.x&&(r=!r),o=o.next}while(o!==t);return r}(t,i)}function area(t,i,o){return(i.y-t.y)*(o.x-i.x)-(i.x-t.x)*(o.y-i.y)}function equals(t,i){return t.x===i.x&&t.y===i.y}function intersects(t,i,o,r){return!!(equals(t,i)&&equals(o,r)||equals(t,r)&&equals(o,i))||area(t,i,o)>0!=area(t,i,r)>0&&area(o,r,t)>0!=area(o,r,i)>0}function locallyInside(t,i){return area(t.prev,t,t.next)<0?area(t,i,t.next)>=0&&area(t,t.prev,i)>=0:area(t,i,t.prev)<0||area(t,t.next,i)<0}function splitPolygon(t,i){var o=new Node(t.i,t.x,t.y),r=new Node(i.i,i.x,i.y),a=t.next,h=i.prev;return t.next=i,i.prev=t,o.next=a,a.prev=o,r.next=o,o.prev=r,h.next=r,r.prev=h,r}function insertNode(t,i,o,r){var a=new Node(t,i,o);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function removeNode(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Node(t,i,o){this.i=t,this.x=i,this.y=o,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(t,i,o,r){for(var a=0,h=i,l=o-r;h<o;h+=r)a+=(t[l]-t[h])*(t[h+1]+t[l+1]),l=h;return a}o.r(i),i.default=earcut,earcut.deviation=function(t,i,o,r){var a=i&&i.length,h=a?i[0]*o:t.length,l=Math.abs(signedArea(t,0,h,o));if(a)for(var c=0,u=i.length;c<u;c++){var p=i[c]*o,d=c<u-1?i[c+1]*o:t.length;l-=Math.abs(signedArea(t,p,d,o))}var m=0;for(c=0;c<r.length;c+=3){var y=r[c]*o,g=r[c+1]*o,_=r[c+2]*o;m+=Math.abs((t[y]-t[_])*(t[g+1]-t[y+1])-(t[y]-t[g])*(t[_+1]-t[y+1]))}return 0===l&&0===m?0:Math.abs((m-l)/l)},earcut.flatten=function(t){for(var i=t[0][0].length,o={vertices:[],holes:[],dimensions:i},r=0,a=0;a<t.length;a++){for(var h=0;h<t[a].length;h++)for(var l=0;l<i;l++)o.vertices.push(t[a][h][l]);a>0&&(r+=t[a-1].length,o.holes.push(r))}return o}},"./lib/plugins/utils/input/IsPointerInBounds.js":function(t,i,o){"use strict";o.r(i);var r=void 0;i.default=function IsPointerInBounds(t,i,o,a){if(void 0===r&&(r=new Phaser.Geom.Rectangle),t.getBounds(r),i)return!(o&&!o(t,i))&&(!!r.contains(i.x,i.y)&&!(a&&!a(t,i)));for(var h=t.scene.input.manager,l=h.pointersTotal,c=h.pointers,u=0;u<l;u++)if(i=c[u],(!o||o(t,i))&&r.contains(i.x,i.y)&&(!a||a(t,i)))return!0;return!1}},"./lib/plugins/utils/input/StopPropagationTouchEvents.js":function(t,i,o){"use strict";o.r(i);var r=function callback(t){t.stopPropagation()};i.default=function StopPropagationTouchEvents(t){t.addEventListener("touchstart",r,!1),t.addEventListener("touchmove",r,!1),t.addEventListener("touchend",r,!1),t.addEventListener("mousedown",r,!1),t.addEventListener("mouseup",r,!1),t.addEventListener("mousemove",r,!1)}},"./lib/plugins/utils/mask/DefaultMask.js":function(t,i,o){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}o.r(i);var r=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(DefaultMask,t);var i=_createSuper(DefaultMask);function DefaultMask(t,o,r){var h;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,DefaultMask),void 0===o&&(o=0),"string"==typeof o&&(shaep=a[o]),void 0===r&&(r=0),(h=i.call(this,t.scene)).parent=t,h.shape=o,h.padding=r,h.setPosition().resize(),h}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(DefaultMask,[{key:"destroy",value:function destroy(){return this.parent=void 0,_get(_getPrototypeOf(DefaultMask.prototype),"destroy",this).call(this),this}},{key:"setPosition",value:function setPosition(t,i){var o=this.parent;if(o)var r=o.getWorldTransformMatrix();return void 0===t&&(t=r.tx?r.tx:o.x),void 0===i&&(i=r.ty?r.ty:o.y),_get(_getPrototypeOf(DefaultMask.prototype),"setPosition",this).call(this,t,i),this}},{key:"resize",value:function resize(t,i,o){var r=this.parent,a=void 0===r.zoom?1:r.zoom;if(void 0===t&&(t=r.width*a),void 0===i&&(i=r.height*a),void 0===o&&(o=this.padding*a),this.widthSave===t&&this.heightSave===i&&this.paddingSave===o)return this;switch(this.clear().fillStyle(16777215),this.shape){case 1:var h=Math.min(t,i)/2;this.fillCircle(0,0,h+o);break;default:this.fillRect(-t*r.originX-o,-i*r.originY-o,t+2*o,i+2*o)}return this.widthSave=t,this.heightSave=i,this.paddingSave=o,this}}]),DefaultMask}(Phaser.GameObjects.Graphics),a={rectangle:0,circle:1};i.default=r},"./lib/plugins/utils/mask/MaskToGameObject.js":function(t,i,o){"use strict";o.r(i);i.default=function MaskToGameObject(t){return t.hasOwnProperty("geometryMask")?t.geometryMask:t.bitmapMask}},"./lib/plugins/utils/math/DegToRad.js":function(t,i,o){"use strict";o.r(i);var r=Math.PI/180;i.default=function DegToRad(t){return t*r}},"./lib/plugins/utils/math/angle/angletodirections/AngleToDirections.js":function(t,i,o){"use strict";o.r(i);var r={};i.default=function AngleToDirections(t,i,o){switch(void 0===o?o={}:!0===o&&(o=r),o.left=!1,o.right=!1,o.up=!1,o.down=!1,t=(t+360)%360,i){case 0:t<180?o.down=!0:o.up=!0;break;case 1:t>90&&t<=270?o.left=!0:o.right=!0;break;case 2:t>45&&t<=135?o.down=!0:t>135&&t<=225?o.left=!0:t>225&&t<=315?o.up=!0:o.right=!0;break;case 3:t>22.5&&t<=67.5?(o.down=!0,o.right=!0):t>67.5&&t<=112.5?o.down=!0:t>112.5&&t<=157.5?(o.down=!0,o.left=!0):t>157.5&&t<=202.5?o.left=!0:t>202.5&&t<=247.5?(o.left=!0,o.up=!0):t>247.5&&t<=292.5?o.up=!0:t>292.5&&t<=337.5?(o.up=!0,o.right=!0):o.right=!0}return o}},"./lib/plugins/utils/math/angle/angletodirections/Const.js":function(t,i,o){"use strict";o.r(i),i.default={"up&down":0,"left&right":1,"4dir":2,"8dir":3}},"./lib/plugins/utils/movement/Movement.js":function(t,i,o){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.r(i);var r=Phaser.Utils.Objects.GetValue,a=function(){function Movement(t){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Movement),this.resetFromJSON(t)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Movement,[{key:"resetFromJSON",value:function resetFromJSON(t){return this.setValue(r(t,"value",0)),this.setSpeed(r(t,"speed",0)),this.setAcceleration(r(t,"acceleration",0)),this}},{key:"reset",value:function reset(){this.setValue(0),this.setSpeed(0),this.setAcceleration(0)}},{key:"setValue",value:function setValue(t){return this.value=t,this}},{key:"setSpeed",value:function setSpeed(t){return this.speed=t,this}},{key:"setAcceleration",value:function setAcceleration(t){return this.acceleration=t,this}},{key:"updateSpeed",value:function updateSpeed(t){return 0!==this.acceleration&&(this.speed+=this.acceleration*t,this.speed<0&&(this.speed=0)),this}},{key:"getDeltaValue",value:function getDeltaValue(t){return this.updateSpeed(t),this.speed<=0?0:this.speed*t}},{key:"update",value:function update(t){return this.updateSpeed(t),this.speed>0&&(this.value+=this.getDeltaValue(t)),this}},{key:"isMoving",get:function get(){return this.speed>0}}]),Movement}();i.default=a},"./lib/plugins/utils/movement/SlowDown.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/movement/Movement.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function SlowDown(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,SlowDown),this.value,this.dir,this.movement=new r.default}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(SlowDown,[{key:"init",value:function init(t,i,o,r,a){return this.value=t,this.end=a,this.dir=void 0!==a?t<a:i,this.movement.setSpeed(o).setAcceleration(-r),this}},{key:"stop",value:function stop(){this.movement.reset()}},{key:"update",value:function update(t){var i=this.movement.getDeltaValue(t);return this.dir||(i=-i),void 0===this.end?this.value+=i:0===i?this.value=this.end:(this.value+=i,this.dir?this.value>this.end&&(this.value=this.end):this.value<this.end&&(this.value=this.end)),this}},{key:"isMoving",get:function get(){return this.movement.isMoving}}]),SlowDown}();i.default=a},"./lib/plugins/utils/object/Clear.js":function(t,i,o){"use strict";o.r(i);i.default=function Clear(t){if(Array.isArray(t))t.length=0;else for(var i in t)delete t[i]}},"./lib/plugins/utils/object/Clone.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/object/Clear.js");i.default=function Clone(t,i){var o=Array.isArray(t);if(void 0===i?i=o?[]:{}:Object(r.default)(i),o){i.length=t.length;for(var a=0,h=t.length;a<h;a++)i[a]=t[a]}else for(var l in t)i[l]=t[l];return i}},"./lib/plugins/utils/object/GetValue.js":function(t,i,o){"use strict";o.r(i);i.default=function GetValue(t,i,o){if(t&&"number"!=typeof t){if(t.hasOwnProperty(i))return t[i];if(-1!==i.indexOf(".")){for(var r=i.split("."),a=t,h=o,l=0;l<r.length;l++){if(!a.hasOwnProperty(r[l])){h=o;break}h=a[r[l]],a=a[r[l]]}return h}return o}return o}},"./lib/plugins/utils/object/IsArray.js":function(t,i,o){"use strict";o.r(i);i.default=function IsArray(t){return"[object Array]"===Object.prototype.toString.call(t)}},"./lib/plugins/utils/object/IsFunction.js":function(t,i,o){"use strict";o.r(i);i.default=function IsFunction(t){return t&&"function"==typeof t}},"./lib/plugins/utils/object/NOOP.js":function(t,i,o){"use strict";o.r(i);i.default=function NOOP(){}},"./lib/plugins/utils/promise/WaitEvent.js":function(t,i,o){"use strict";o.r(i),o.d(i,"WaitEvent",(function(){return r})),o.d(i,"WaitComplete",(function(){return a}));var r=function WaitEvent(t,i){return new Promise((function(o,r){t.once(i,(function(){o()}))}))},a=function WaitComplete(t){return r(t,"complete")}},"./lib/plugins/utils/renderTexture/MakeChildImageGameObject.js":function(t,i,o){"use strict";o.r(i);i.default=function MakeChildImageGameObject(t,i,o){return void 0===o&&(o="image"),t[i]||(t[i]=t.scene.make[o]({add:!1,origin:{x:0,y:0}}),t.on("destroy",(function(){t[i]&&(t[i].destroy(),t[i]=void 0)}))),t[i]}},"./lib/plugins/utils/size/GetDisplaySize.js":function(t,i,o){"use strict";o.r(i),o.d(i,"GetDisplayWidth",(function(){return r})),o.d(i,"GetDisplayHeight",(function(){return a}));var r=function GetDisplayWidth(t){return void 0!==t.displayWidth?t.displayWidth:t.width},a=function GetDisplayHeight(t){return void 0!==t.displayHeight?t.displayHeight:t.height}},"./lib/plugins/utils/size/ResizeGameObject.js":function(t,i,o){"use strict";o.r(i);i.default=function ResizeGameObject(t,i,o){!t||void 0===i&&void 0===o||(t.resize?(void 0===i&&(i=t.width),void 0===o&&(o=t.height),t.resize(i,o)):(void 0!==i&&(t.displayWidth=i),void 0!==o&&(t.displayHeight=o)))}},"./lib/plugins/utils/struct/Stack.js":function(t,i,o){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.r(i);var r=function(){function Stack(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Stack),this.items=[]}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Stack,[{key:"destroy",value:function destroy(){this.clear(),this.items=void 0}},{key:"pop",value:function pop(){return this.items.length>0?this.items.pop():null}},{key:"push",value:function push(t){return this.items.push(t),this}},{key:"pushMultiple",value:function pushMultiple(t){return this.items.push.apply(this.items,t),t.length=0,this}},{key:"clear",value:function clear(){return this.items.length=0,this}}]),Stack}();i.default=r},"./lib/plugins/utils/system/GetSceneObject.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/system/IsSceneObject.js");i.default=function GetSceneObject(t){return Object(r.default)(t)?t:t.scene&&Object(r.default)(t.scene)?t.scene:t.parent&&t.parent.scene&&Object(r.default)(t.parent.scene)?t.parent.scene:void 0}},"./lib/plugins/utils/system/IsGameObject.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.GameObjects.GameObject;i.default=function IsGameObject(t){return t instanceof r}},"./lib/plugins/utils/system/IsSceneObject.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Scene;i.default=function IsSceneObject(t){return t instanceof r}},"./lib/plugins/utils/text/IsTextGameObject.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.GameObjects.Text;i.default=function IsTextGameObject(t){return t instanceof r}},"./lib/plugins/utils/ticktask/TickTask.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=Phaser.Utils.Objects.GetValue,h=function(){function TickTask(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TickTask),this.parent=t,this._isRunning=!1,this.tickingState=!1,this.setEventEmitter(a(i,"eventEmitter",void 0)),this.setTickingMode(a(i,"tickingMode",1))}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TickTask,[{key:"boot",value:function boot(){2!==this.tickingMode||this.tickingState||this.startTicking()}},{key:"shutdown",value:function shutdown(){this.destroyEventEmitter(),this.tickingState&&this.stopTicking()}},{key:"setTickingMode",value:function setTickingMode(t){"string"==typeof t&&(t=l[t]),this.tickingMode=t}},{key:"startTicking",value:function startTicking(){this.tickingState=!0}},{key:"stopTicking",value:function stopTicking(){this.tickingState=!1}},{key:"start",value:function start(){return this.isRunning=!0,this}},{key:"pause",value:function pause(){return this.isRunning=!1,this}},{key:"resume",value:function resume(){return this.isRunning=!0,this}},{key:"stop",value:function stop(){return this.isRunning=!1,this}},{key:"complete",value:function complete(){this.isRunning=!1,this.emit("complete",this.parent,this)}},{key:"isRunning",get:function get(){return this._isRunning},set:function set(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()))}}]),TickTask}();Object.assign(h.prototype,r.default);var l={no:0,lazy:1,always:2};i.default=h},"./lib/plugins/utils/tween/TweenBase.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/eventemitter/EventEmitterMethods.js"),a=o("./lib/plugins/utils/system/GetSceneObject.js"),h=o("./lib/plugins/utils/system/IsGameObject.js"),l=o("./lib/plugins/utils/system/IsSceneObject.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=Phaser.Utils.Objects.GetValue,u=function(){function TweenBase(t,i){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TweenBase),this.parent=t,this.scene=Object(a.default)(t);var o=c(i,"eventEmitter",!1);!0===o&&(o=void 0),this.setEventEmitter(o),this.boot()}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TweenBase,[{key:"boot",value:function boot(){Object(h.default)(this.parent)?this.parent.once&&this.parent.on("destroy",this.destroy,this):Object(l.default)(this.parent)&&this.parent.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function shutdown(){return this.stop(),Object(l.default)(this.parent)&&this.parent.events.off("shutdown",this.destroy,this),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this}},{key:"destroy",value:function destroy(){return this.shutdown(),this}},{key:"start",value:function start(t){return this.isRunning||(this.tween=this.scene.tweens.add(t).on("complete",this.complete,this),!1===this.getEventEmitter()&&this.setEventEmitter(this.tween)),this}},{key:"restart",value:function restart(){return this.stop().start(),this}},{key:"stop",value:function stop(){return this.tween?(this.getEventEmitter()===this.tween&&this.setEventEmitter(!1),this.tween.remove(),this.tween=void 0,this):this}},{key:"complete",value:function complete(){return this.stop(),this.getEventEmitter()&&this.emit("complete"),this}},{key:"isRunning",get:function get(){return!!this.tween}}]),TweenBase}();Object.assign(u.prototype,r.default),i.default=u},"./lib/ui/baseUI/BaseMediator.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/interface/baseUI/UIType.js");function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(i,"__esModule",{value:!0});var h=function(){function BaseMediator(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,BaseMediator),this.mView,this.mParam,this.mShow=!1,this.mUIType=a.default.None}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(BaseMediator,[{key:"updateViewPos",value:function updateViewPos(){this.mView&&this.mView.updatePos()}},{key:"tweenExpand",value:function tweenExpand(t){this.mView&&this.mView.tweenExpand(t)}},{key:"getView",value:function getView(){return this.mView}},{key:"hide",value:function hide(){this.mShow=!1;var t=this.getView();t&&t.hide()}},{key:"isSceneUI",value:function isSceneUI(){return!1}},{key:"isShow",value:function isShow(){return this.mShow}},{key:"resize",value:function resize(t,i){var o=this.getView();o&&o.isShow()&&o.resize(t,i)}},{key:"show",value:function show(t){this.mShow=!0}},{key:"update",value:function update(t){var i=this.getView();i&&i.update(t)}},{key:"setParam",value:function setParam(t){this.mParam=t}},{key:"getParam",value:function getParam(){return this.mParam}},{key:"destroy",value:function destroy(){this.mShow=!1,this.mParam=null,this.mView&&(this.mView.destroy(),this.mView=void 0)}},{key:"UIType",get:function get(){return this.mUIType}}]),BaseMediator}();o.default=h},"./lib/ui/baseUI/BaseUI.js":function(t,o,r){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}r.r(o),Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(BaseUI,Phaser.GameObjects.Container);var i=_createSuper(BaseUI);function BaseUI(t,o,r){var a;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,BaseUI),(a=i.call(this,t)).silent=!1,a.mInitialized=!1,a.interactiveBoo=!1,a.mShow=!1,a.dpr=o||1,a.scale=r||1,a.soundMap=new Map,a.disInteractive(),a}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(BaseUI,[{key:"setFollow",value:function setFollow(t,i,o){this.mFollow=t,this.mFroscene=i,o&&(this.posFunc=o)}},{key:"updatePos",value:function updatePos(){if(this.mShow)if(this.posFunc)this.posFunc({scene:this.mFroscene,followX:this.mFollow.x,followY:this.mFollow.y,baseX:this.x,baseY:this.y});else{var t=this.mFroscene.cameras.main,i=this.x-t.scrollX,o=this.y-t.scrollY;this.x=i,this.y=o}}},{key:"setInteractive",value:function setInteractive(t,i,o){return this.interactiveBoo=!0,_get(_getPrototypeOf(BaseUI.prototype),"setInteractive",this).call(this,t,i,o),this}},{key:"disInteractive",value:function disInteractive(){this.interactiveBoo=!1,_get(_getPrototypeOf(BaseUI.prototype),"disableInteractive",this).call(this)}},{key:"addListen",value:function addListen(){}},{key:"removeListen",value:function removeListen(){}},{key:"playSound",value:function playSound(t){if(!this.silent){var i=t.key;this.scene.cache.audio.exists(i)&&this.startPlay(t)}}},{key:"startPlay",value:function startPlay(t){if(!this.silent){var i=t.key,o=this.soundMap.get(i);o||(o=this.scene.sound.add(i,t.soundConfig),this.soundMap.set(i,o)),o.isPlaying||o.play()}}},{key:"stopSound",value:function stopSound(){this.silent||this.soundMap.forEach((function(t){t.isPlaying&&t.stop()}))}},{key:"pauseSound",value:function pauseSound(){this.silent||this.soundMap.forEach((function(t){t.isPaused||t.pause()}))}},{key:"resumeSound",value:function resumeSound(){this.silent||this.soundMap.forEach((function(t){t.isPaused&&t.resume()}))}},{key:"setSilent",value:function setSilent(t){this.silent=t}},{key:"destroy",value:function destroy(){this.soundMap.forEach((function(t){t.isPlaying&&t.stop()})),this.mInitialized=!1,this.interactiveBoo=!1,this.silent=!1,this.removeListen(),_get(_getPrototypeOf(BaseUI.prototype),"destroy",this).call(this)}},{key:"checkPointerDelection",value:function checkPointerDelection(t){return!this.scene||(Math.abs(t.downX-t.upX)<10*this.dpr*this.scale||Math.abs(t.downY-t.upY)<10*this.dpr*this.scale)}}]),BaseUI}();o.default=a},"./lib/ui/basesizer/AddChildrenMap.js":function(t,i,o){"use strict";o.r(i);i.default=function AddChildrenMap(t,i){return this.childrenMap,void 0===this.childrenMap&&(this.childrenMap={}),this.childrenMap[t]=i,this}},"./lib/ui/basesizer/BaseSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/basesizer/Methods.js"),a=o("./lib/plugins/utils/size/GetDisplaySize.js"),h=o("./lib/ui/container/Container.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Phaser.Utils.Objects.GetValue,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Base,t);var i=_createSuper(Base);function Base(t,o,r,a,h,c){var u;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Base),(u=i.call(this,t,o,r,2,2)).isTooqingSizer=!0,u.setMinSize(a,h),u.setName(l(c,"name","")),u.TooqingSizer={},u.backgroundChildren=void 0;var p=l(c,"anchor",void 0);return p&&u.setAnchor(p),u.setDraggable(l(c,"draggable",!1)),u}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Base,[{key:"destroy",value:function destroy(t){this.scene&&(void 0!==this.backgroundChildren&&(this.backgroundChildren.length=0),_get(_getPrototypeOf(Base.prototype),"destroy",this).call(this,t))}},{key:"setMinSize",value:function setMinSize(t,i){return this.setMinWidth(t).setMinHeight(i),this}},{key:"setMinWidth",value:function setMinWidth(t){return null==t&&(t=0),this.minWidth=t,this}},{key:"setMinHeight",value:function setMinHeight(t){return null==t&&(t=0),this.minHeight=t,this}},{key:"alignLeft",value:function alignLeft(t){return this.left=t,this}},{key:"alignRight",value:function alignRight(t){return this.right=t,this}},{key:"alignCenterX",value:function alignCenterX(t){return this.centerX=t,this}},{key:"alignTop",value:function alignTop(t){return this.top=t,this}},{key:"alignBottom",value:function alignBottom(t){return this.bottom=t,this}},{key:"alignCenterY",value:function alignCenterY(t){return this.centerY=t,this}},{key:"pin",value:function pin(t){return _get(_getPrototypeOf(Base.prototype),"add",this).call(this,t),this}},{key:"addBackground",value:function addBackground(t,i){return void 0===this.backgroundChildren&&(this.backgroundChildren=[]),_get(_getPrototypeOf(Base.prototype),"add",this).call(this,t),this.getSizerConfig(t).parent=this,this.backgroundChildren.push(t),void 0!==i&&this.addChildrenMap(i,t),this}},{key:"childrenWidth",get:function get(){return void 0===this._childrenWidth&&(this._childrenWidth=this.getChildrenWidth()),this._childrenWidth}},{key:"childrenHeight",get:function get(){return void 0===this._childrenHeight&&(this._childrenHeight=this.getChildrenHeight()),this._childrenHeight}},{key:"left",get:function get(){return this.x-Object(a.GetDisplayWidth)(this)*this.originX},set:function set(t){this.x+=t-this.left}},{key:"right",get:function get(){return this.left+Object(a.GetDisplayWidth)(this)},set:function set(t){this.x+=t-this.right}},{key:"centerX",get:function get(){return this.left+Object(a.GetDisplayWidth)(this)/2},set:function set(t){this.x+=t-this.centerX}},{key:"top",get:function get(){return this.y-Object(a.GetDisplayHeight)(this)*this.originY},set:function set(t){this.y+=t-this.top}},{key:"bottom",get:function get(){return this.top+Object(a.GetDisplayHeight)(this)},set:function set(t){this.y+=t-this.bottom}},{key:"centerY",get:function get(){return this.top+Object(a.GetDisplayHeight)(this)/2},set:function set(t){this.y+=t-this.centerY}}]),Base}(h.default);Object.assign(c.prototype,r.default),i.default=c},"./lib/ui/basesizer/DrawBounds.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/AlignConst.js"),a=o("./lib/plugins/utils/actions/GlobZone.js"),h=o("./lib/plugins/utils/align/align/in/QuickSet.js"),l=Phaser.Utils.Objects.GetValue,c=function DefaultCreateTextCallback(t,i,o){return t.add.text(0,0,"")},u=new Phaser.Geom.Rectangle;i.default=function DrawBounds(t,i){var o,p,d,m,y=t.scene;if("number"==typeof i)o=i;else{o=l(i,"color",16777215);var g=l(i,"name",!1);g&&(p=l(g,"createTextCallback",c),d=l(g,"createTextCallbackScope",void 0),"string"==typeof(m=l(g,"align","left-top"))&&(m=r.default[m]))}if(p&&!t.children){t.children=y.add.group(),t.on("destroy",(function(){t.children.destroy(),t.children=void 0}));var _=t.clear.bind(t);t.clear=function(){_(),t.children.clear(!1,!0)}}for(var v,b,P=this.getAllChildren([this]),w=0,S=P.length;w<S;w++)(v=P[w]).getBounds&&(o&&t.lineStyle(1,o).strokeRectShape(v.getBounds(u)),v.name&&p&&(b=d?p.call(d,y):p(y))&&(b.setText(v.name),t.children.add(b),a.default.setPosition(u.x,u.y).setSize(u.width,u.height),Object(h.default)(b,a.default,m)));return this}},"./lib/ui/basesizer/FadeMethods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/fade-in.js"),a=o("./lib/plugins/fade-out-destroy.js"),h=o("./lib/plugins/utils/promise/WaitEvent.js"),l=Phaser.Utils.Objects.IsPlainObject,c=Phaser.Utils.Objects.GetValue;i.default={fadeIn:function fadeIn(t,i){l(t)&&(t=c(t,"duration",void 0));return this._fade=Object(r.default)(this,t,i,this._fade),this._fade.once("complete",(function(){this.emit("fadein.complete",this)}),this),this},fadeInPromoise:function fadeInPromoise(t,i){return this.fadeIn(t,i),Object(h.WaitComplete)(this._fade)},fadeOutDestroy:function fadeOutDestroy(t,i){if(l(t)){var o=t;t=c(o,"duration",void 0),i=c(o,"destroy",void 0)}return this._fade=Object(a.default)(this,t,i,this._fade),this._fade.once("complete",(function(){this.emit("fadeout.complete",this)}),this),this},fadeOutDestroyPromise:function fadeOutDestroyPromise(t,i){return this.fadeOutDestroy(t,i),Object(h.WaitComplete)(this._fade)},fadeOut:function fadeOut(t){return this.fadeOutDestroy(t,!1),this},fadeOutPromise:function fadeOutPromise(t){return this.fadeOut(t),Object(h.WaitComplete)(this._fade)}}},"./lib/ui/basesizer/GetAllChildrenSizers.js":function(t,i,o){"use strict";o.r(i);i.default=function GetAllChildrenSizers(t){void 0===t&&(t=[]);for(var i=t.length,o=this.getChildrenSizers(t),r=t.length,a=i;a<r;a++)o[a].getAllChildrenSizers(t);return t}},"./lib/ui/basesizer/GetChildrenHeight.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenHeight(){return 0}},"./lib/ui/basesizer/GetChildrenSizers.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenSizers(t){return void 0===t&&(t=[]),t}},"./lib/ui/basesizer/GetChildrenWidth.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenWidth(){return 0}},"./lib/ui/basesizer/GetElement.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/object/IsArray.js"),a=function GetElementByName(t,i){var o;if(Object(r.default)(t)){for(var a=0,l=t.length;a<l;a++)if(o=h(t[a],i))return o}else for(var c in t)if(o=h(t[c],i))return o},h=function TestName(t,i){return t?t.hasOwnProperty("name")?t.name===i?t:null:a(t,i):null},l=/(\S+)\[(\d+)\]/i;i.default=function GetElement(t){if(void 0!==this.childrenMap&&("string"==typeof t&&(t=t.split(".")),0!==t.length)){var i,o=t.shift();if("#"===o.charAt(0))o=o.substring(1),i=a(this.childrenMap,o);else if(-1===o.indexOf("["))i=this.childrenMap[o];else{var r=o.match(l);if(null!=r){var h=this.childrenMap[r[1]];h&&(i=h[r[2]])}}return 0===t.length?i:i&&i.childrenMap?i.getElement(t):null}}},"./lib/ui/basesizer/GetParentSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetParentSizer.js");i.default=function(){return Object(r.default)(this)}},"./lib/ui/basesizer/GetTopmostSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetTopmostSizer.js");i.default=function(){return Object(r.default)(this)}},"./lib/ui/basesizer/IsInTouching.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/input/IsPointerInBounds.js");i.default=function(t){return Object(r.default)(this,t)}},"./lib/ui/basesizer/Layout.js":function(t,i,o){"use strict";o.r(i);i.default=function Layout(t,i,o){return this.TooqingSizer.hidden?this:(this.preLayout(),this.postLayout())}},"./lib/ui/basesizer/LayoutBackgrounds.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/ResizeGameObject.js"),a=o("./lib/plugins/utils/actions/GlobZone.js"),h=o("./lib/plugins/utils/align/align/in/QuickSet.js"),l=Phaser.Display.Align.CENTER;i.default=function LayoutBackgrounds(){if(void 0!==this.backgroundChildren)for(var t,i=this.backgroundChildren,o=this.left,c=this.top,u=this.width,p=this.height,d=0,m=i.length;d<m;d++)(t=i[d]).TooqingSizer.hidden||(Object(r.default)(t,u,p),a.default.setPosition(o,c).setSize(u,p),Object(h.default)(t,a.default,l),this.resetChildPositionState(t))}},"./lib/ui/basesizer/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetSizerConfig.js"),a=o("./lib/ui/basesizer/PushIntoBounds.js"),h=o("./lib/ui/basesizer/DrawBounds.js"),l=o("./lib/ui/basesizer/AddChildrenMap.js"),c=o("./lib/ui/basesizer/GetElement.js"),u=o("./lib/ui/basesizer/GetChildrenWidth.js"),p=o("./lib/ui/basesizer/GetChildrenHeight.js"),d=o("./lib/ui/basesizer/GetAllChildrenSizers.js"),m=o("./lib/ui/basesizer/GetChildrenSizers.js"),y=o("./lib/ui/basesizer/PreLayout.js"),g=o("./lib/ui/basesizer/Layout.js"),_=o("./lib/ui/basesizer/PostLayout.js"),v=o("./lib/ui/basesizer/_layoutInit.js"),b=o("./lib/ui/basesizer/SetAnchor.js"),P=o("./lib/ui/basesizer/ScaleMethods.js"),w=o("./lib/ui/basesizer/FadeMethods.js"),S=o("./lib/ui/basesizer/IsInTouching.js"),C=o("./lib/ui/basesizer/GetParentSizer.js"),T=o("./lib/ui/basesizer/GetTopmostSizer.js"),k=o("./lib/ui/basesizer/LayoutBackgrounds.js"),O=o("./lib/ui/basesizer/SetDraggable.js"),I={getSizerConfig:r.default,pushIntoBounds:a.default,drawBounds:h.default,getChildrenWidth:u.default,getChildrenHeight:p.default,addChildrenMap:l.default,addElement:l.default,getElement:c.default,getAllChildrenSizers:d.default,getChildrenSizers:m.default,preLayout:y.default,_layoutInit:v.default,layout:g.default,layoutBackgrounds:k.default,postLayout:_.default,setAnchor:b.default,isInTouching:S.default,getParentSizer:C.default,getTopmostSizer:T.default,setDraggable:O.default};Object.assign(I,w.default,P.default),i.default=I},"./lib/ui/basesizer/PostLayout.js":function(t,i,o){"use strict";o.r(i);i.default=function PostLayout(t,i,o){return this._anchor&&this._anchor.updatePosition(),this}},"./lib/ui/basesizer/PreLayout.js":function(t,i,o){"use strict";o.r(i);i.default=function LayoutInit(t){if(!t)for(var i,o=this.getAllChildrenSizers([this]),r=0,a=o.length;r<a;r++)(i=o[r]).TooqingSizer&&i._layoutInit()}},"./lib/ui/basesizer/PushIntoBounds.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/defaultbounds/GetDefaultBounds.js");i.default=function PushIntoBounds(t){return void 0===t&&(t=Object(r.default)(this.scene)),this.left=Math.max(this.left,t.left),this.right=Math.min(this.right,t.right),this.top=Math.max(this.top,t.top),this.bottom=Math.min(this.bottom,t.bottom),this}},"./lib/ui/basesizer/ScaleMethods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/popup.js"),a=o("./lib/plugins/scale-down-destroy.js"),h=o("./lib/plugins/utils/promise/WaitEvent.js"),l=Phaser.Utils.Objects.IsPlainObject,c=Phaser.Utils.Objects.GetValue;i.default={popUp:function popUp(t,i,o){if(l(t)){var a=t;t=c(a,"duration",void 0),i=c(a,"orientation",void 0),o=c(a,"ease",void 0)}return this._scale=Object(r.default)(this,t,i,o,this._scale),this._scale.once("complete",(function(){this.emit("popup.complete",this)}),this),this},popUpPromise:function popUpPromise(t,i,o){return this.popUp(t,i,o),Object(h.WaitComplete)(this._scale)},scaleDownDestroy:function scaleDownDestroy(t,i,o,r){if(l(t)){var h=t;t=c(h,"duration",void 0),i=c(h,"orientation",void 0),o=c(h,"ease",void 0),r=c(h,"destroy",void 0)}return this._scale=Object(a.default)(this,t,i,o,r,this._scale),this._scale.once("complete",(function(){this.emit("scaledown.complete",this)}),this),this},scaleDownDestroyPromise:function scaleDownDestroyPromise(t,i,o,r){return this.scaleDownDestroy(t,i,o,r),Object(h.WaitComplete)(this._scale)},scaleDown:function scaleDown(t,i,o){return this.scaleDownDestroy(t,i,o,!1),this},scaleDownPromise:function scaleDownPromise(t,i,o){return this.scaleDown(t,i,o),Object(h.WaitComplete)(this._scale)}}},"./lib/ui/basesizer/SetAnchor.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/behaviors/anchor/Anchor.js");i.default=function SetAnchor(t){return void 0===this._anchor?this._anchor=new r.default(this,t):this._anchor.resetFromJSON(t),this}},"./lib/ui/basesizer/SetDraggable.js":function(t,i,o){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o.r(i);var r=function onDrag(t,i,o){var r=this.getTopmostSizer();r.x+=i-this.x,r.y+=o-this.y};i.default=function SetDraggable(t,i){var o=_typeof(t);return"string"===o?t=this.getElement(t):void 0!==t&&"object"==o||(i=t,t=this),void 0===i&&(i=!0),t.input&&t.input.hasOwnProperty("draggable")?t.input.draggable=i:i&&(t.setInteractive(),t.scene.input.setDraggable(t),t.on("drag",r,this)),this}},"./lib/ui/basesizer/_layoutInit.js":function(t,i,o){"use strict";o.r(i);i.default=function _layoutInit(){}},"./lib/ui/bbcodetext/BBCodeText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js").default;i.default=r},"./lib/ui/button/Button.js":function(t,o,r){"use strict";r.r(o),r.d(o,"Button",(function(){return p})),r.d(o,"ButtonState",(function(){return l})),r.d(o,"NinePatchConfig",(function(){return c})),r.d(o,"ButtonConfig",(function(){return u}));var a=r("./lib/ui/baseUI/BaseUI.js"),h=r("./lib/ui/interface/event/ClickEvent.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l={Normal:0,Over:1,Select:2,Disable:3},c={width:0,height:0,configlist:void 0},u={key:void 0,normalFrame:void 0,downFrame:void 0,text:void 0,music:void 0,dpr:1,scale:1,nineConfig:void 0,data:void 0},p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Button,t);var i=_createSuper(Button);function Button(t,o,r,a,h,l,c,u,p){var d;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Button),(d=i.call(this,t)).mDownTime=0,d.mPressDelay=1e3,d.mIsMove=!1,d.dpr=c||1,d.zoom=u||1,d.soundGroup={up:{key:"click"}},Object.assign(d.soundGroup,l),d.ninePatchConfig=p,d.mKey=o,d.mFrame=r||"__BASE",d.mDownFrame=a,d.mText,d.mBackground,d.createBackground(),h&&(d.mText=d.scene.make.text(void 0,!1).setOrigin(.5,.5).setText(h),d.mBackground&&d.mText.setSize(d.mBackground.width,d.mBackground.height),d.add(d.mText)),d.setInteractive(),d.addListen(),d}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Button,[{key:"addListen",value:function addListen(){this.removeListen(),this.on("pointerdown",this.onPointerDownHandler,this),this.on("pointerup",this.onPointerUpHandler,this),this.on("pointermove",this.onPointerMoveHandler,this)}},{key:"removeListen",value:function removeListen(){this.off("pointerdown",this.onPointerDownHandler,this),this.off("pointerup",this.onPointerUpHandler,this),this.off("pointermove",this.onPointerMoveHandler,this)}},{key:"mute",value:function mute(t){this.silent=t}},{key:"changeNormal",value:function changeNormal(){this.setBgFrame(this.mFrame)}},{key:"changeDown",value:function changeDown(){this.mDownFrame&&this.setBgFrame(this.mDownFrame)}},{key:"setFrame",value:function setFrame(t){this.setBgFrame(t)}},{key:"setText",value:function setText(t){this.mText&&this.mText.setText(t)}},{key:"setTextStyle",value:function setTextStyle(t){this.mText&&this.mText.setStyle(t)}},{key:"setFontStyle",value:function setFontStyle(t){this.mText&&this.mText.setFontStyle(t)}},{key:"setTextOffset",value:function setTextOffset(t,i){this.mText&&this.mText.setPosition(t,i)}},{key:"setTextColor",value:function setTextColor(t){this.mText&&this.mText.setColor(t)}},{key:"setFrameNormal",value:function setFrameNormal(t,i,o){return this.mFrame=t,this.mDownFrame=i||t,this.changeNormal(),this}},{key:"createBackground",value:function createBackground(){this.mFrame&&(this.mBackground=this.scene.make.image({key:this.mKey,frame:this.mFrame},!1),this.setSize(this.mBackground.width,this.mBackground.height),this.add(this.mBackground))}},{key:"setBgFrame",value:function setBgFrame(t){this.mBackground&&(this.mBackground.setFrame(t),this.setSize(this.mBackground.width,this.mBackground.height))}},{key:"buttonStateChange",value:function buttonStateChange(t){switch(t){case l.Normal:this.changeNormal();break;case l.Over:break;case l.Select:this.changeDown();break;case l.Disable:}}},{key:"onPointerMoveHandler",value:function onPointerMoveHandler(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move),this.interactiveBoo&&(this.mIsMove=!0,this.emit(h.default.Move))}},{key:"onPointerUpHandler",value:function onPointerUpHandler(t){if(this.interactiveBoo){this.buttonStateChange(l.Normal);var i=this.checkPointerInBounds(this,t.worldX,t.worldY);this.emit(h.default.Up,this),i&&this.mIsDown&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.emit(h.default.Tap,t,this)),clearTimeout(this.mPressTime),this.mIsMove=!1,this.mIsDown=!1,this.mDownTime=0}else this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"onPointerDownHandler",value:function onPointerDownHandler(t){var i=this;this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.buttonStateChange(l.Select),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){i.emit(h.default.Hold,i)}),this.mPressDelay),this.emit(h.default.Down,this),this.mIsDown=!0):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"checkPointerInBounds",value:function checkPointerInBounds(t,i,o){this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var r=this.zoom?this.zoom:1;this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2;var a=t.getWorldTransformMatrix(),h=(i-a.tx)/r,l=(o-a.ty)/r;return this.mRectangle.left<=h&&this.mRectangle.right>=h&&this.mRectangle.top<=l&&this.mRectangle.bottom>=l}},{key:"background",get:function get(){return this.mBackground}},{key:"text",get:function get(){return this.mText}},{key:"enable",set:function set(t){t?(this.mBackground&&(this.mBackground.clearTint(),this.mText&&this.mText.clearTint()),this.setInteractive()):(this.mBackground&&(this.mBackground.setTintFill(6710886),this.mText&&this.mText.setTintFill(7829367)),this.removeInteractive())}}]),Button}(a.default)},"./lib/ui/button/NineSliceButton.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/ninepatch/NineSlicePatch.js"),h=r("./lib/ui/button/Button.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(NineSliceButton,t);var i=_createSuper(NineSliceButton);function NineSliceButton(t,o,r,a,h,l,c,u,p,d,m,y,g){var _;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,NineSliceButton),(_=i.call(this,t,l,c,c,u,y,p,d,{width:a,height:h,configlist:[m]})).x=o,_.y=r,g&&(_.btnData=g),_}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(NineSliceButton,[{key:"getBtnData",value:function getBtnData(){return this.btnData}},{key:"createBackground",value:function createBackground(){this.mFrame=this.mFrame?this.mFrame:"__BASE",this.initFrame();var t=this.ninePatchConfig.configlist[0],i=this.ninePatchConfig.width,o=this.ninePatchConfig.height;this.mBackground=new a.default(this.scene,0,0,i,o,this.mKey,this.mFrame,{left:t.left,top:t.top,right:t.right,bottom:t.bottom},this.dpr,1),this.add(this.mBackground),this.setSize(i,o)}},{key:"isExists",value:function isExists(t){var i=this.scene.textures.get(this.mKey);return!(!i||!i.has(t))}},{key:"initFrame",value:function initFrame(){var t=this.mFrame?this.mFrame:this.mKey;return this.mFrame="".concat(t,"_normal"),this.isExists(this.mFrame)||(this.mFrame=t),this.mDownFrame="".concat(t,"_down"),this.isExists(this.mDownFrame)||(this.mDownFrame=this.mFrame),this.mFrame}},{key:"enable",set:function set(t){t?(this.mBackground.clearTint(),this.mText&&this.mText.clearTint(),this.setInteractive()):(this.mBackground.setTintFill(6710886),this.mText&&this.mText.setTintFill(7829367),this.removeInteractive())}}]),NineSliceButton}(h.Button);o.default=l},"./lib/ui/buttons/ButtonMethods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/buttons/ButtonSetInteractive.js"),a=o("./lib/ui/utils/Hide.js");i.default={getButton:function getButton(t){var i;return"number"==typeof t?i=this.childrenMap.buttons[t]:(i=t,-1===this.childrenMap.buttons.indexOf(i)&&(i=void 0)),i},emitButtonClick:function emitButtonClick(t){return r.FireEvent.call(this,"button.click",t),this},showButton:function showButton(t){return Object(a.Show)(this.getButton(t)),this},hideButton:function hideButton(t){return Object(a.Hide)(this.getButton(t)),this},isButtonShown:function isButtonShown(t){return Object(a.IsShown)(this.getButton(t)),this},forEachButtton:function forEachButtton(t,i){for(var o=this.childrenMap.buttons,r=0,a=o.length;r<a;r++)i?t.call(i,o[r],r,o):t(o[r],r,o);return this}}},"./lib/ui/buttons/ButtonSetInteractive.js":function(t,i,o){"use strict";o.r(i),o.d(i,"ButtonSetInteractive",(function(){return a})),o.d(i,"FireEvent",(function(){return h}));var r=o("./lib/plugins/input/button/Button.js"),a=function ButtonSetInteractive(t,i){t._buttonBehavior=new r.default(t,i),t._buttonBehavior.on("click",(function(i,o,r,a){h.call(this,"button.click",t,r,a)}),this),t.on("pointerover",(function(i,o,r,a){h.call(this,"button.over",t,i,a)}),this).on("pointerout",(function(i,o){h.call(this,"button.out",t,i,o)}),this)},h=function FireEvent(t,i,o,r){var a;if("number"==typeof i){if(a=i,!(i=this.childrenMap.buttons[a]))return}else if(-1===(a=this.childrenMap.buttons.indexOf(i)))return;this.eventEmitter!==this&&this.emit(t,i,a,o,r),void 0!==this.groupName?this.eventEmitter.emit(t,i,this.groupName,a,o,r):this.eventEmitter.emit(t,i,a,o,r)}},"./lib/ui/buttons/Buttons.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/Sizer.js"),a=o("./lib/ui/buttons/ButtonSetInteractive.js"),h=o("./lib/ui/buttons/ButtonMethods.js"),l=o("./lib/ui/buttons/types/SetType.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=Phaser.Utils.Objects.GetValue,u=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Buttons,t);var i=_createSuper(Buttons);function Buttons(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Buttons),void 0===o&&(o={}),(r=i.call(this,t,o)).type="TooqingButtons",r.eventEmitter=c(o,"eventEmitter",_assertThisInitialized(r)),r.groupName=c(o,"groupName",void 0);var h=c(o,"background",void 0),u=c(o,"buttons",void 0);u&&0===u.length&&(u=void 0);var p=c(o,"space",0);if(h&&r.addBackground(h),u){var d,m,y=c(o,"expand",!1),g=y?1:0,_=c(o,"align",void 0),v=c(o,"click",void 0);y||"right"!==_&&"bottom"!==_&&"center"!==_||r.addSpace();for(var b=0,P=u.length;b<P;b++)d=u[b],m=0===r.orientation?{left:b>=1?p:0,right:0,top:0,bottom:0}:{left:0,right:0,top:b>=1?p:0,bottom:0},r.add(d,g,"center",m,!0),a.ButtonSetInteractive.call(_assertThisInitialized(r),d,v);y||"center"!==_||r.addSpace()}return r.addChildrenMap("background",h),r.addChildrenMap("buttons",u||[]),l.default.call(_assertThisInitialized(r),o),r}return Buttons}(r.default);Object.assign(u.prototype,h.default),i.default=u},"./lib/ui/buttons/types/InitData.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Utils.Objects.GetValue;i.default=function InitData(t,i){void 0===i&&(i=!1);var o=r(t,"dataManager",void 0),a=r(t,"setValueCallback",void 0),h=r(t,"setValueCallbackScope",void 0);void 0===o&&(this.setDataEnabled(),o=this.data),this.childrenMap.buttons.forEach((function(t){var r=t.name;a&&o.events.on("changedata-".concat(r),(function(i,o,r){h?a.call(h,t,o,r):a(t,o)}),this),o.set(r,void 0),o.set(r,i)})),this._dataManager=o}},"./lib/ui/buttons/types/SetCheckboxesType.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/buttons/types/InitData.js");i.default=function SetCheckboxesType(t){r.default.call(this,t),this.on("button.click",(function(t){var i=this._dataManager,o=t.name,r=i.get(o);i.set(o,!r)}),this)}},"./lib/ui/buttons/types/SetRadioType.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/buttons/types/InitData.js");i.default=function SetRadioType(t){r.default.call(this,t),this._value=void 0,Object.defineProperty(this,"value",{get:function(){return this._value}.bind(this),set:function(t){if(t!==this._value){this._value=t;var i=this._dataManager;this.getElement("buttons").forEach((function(o){var r=o.name,a=i.get(r);r===t?a||i.set(r,!0):a&&i.set(r,!1)}))}}.bind(this),enumerable:!0,configurable:!0}),this.on("button.click",(function(t){this.value=t.name}),this)}},"./lib/ui/buttons/types/SetType.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/buttons/types/SetRadioType.js"),a=o("./lib/ui/buttons/types/SetCheckboxesType.js"),h=Phaser.Utils.Objects.GetValue,l={radio:r.default,checkboxes:a.default};i.default=function SetType(t){var i=h(t,"type",void 0);i&&l.hasOwnProperty(i)&&l[i].call(this,t)}},"./lib/ui/canvas/Canvas.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/canvas/Canvas.js");i.default=r.default},"./lib/ui/checkbox/CheckBox.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/button/Button.js"),h=r("./lib/ui/interface/event/ClickEvent.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=0,c=2,u=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(CheckBox,t);var i=_createSuper(CheckBox);function CheckBox(t,o,r,a,h,l,c,u,p){var d;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,CheckBox),(d=i.call(this,t,o,r,a,h,l,c,u,p)).mSelected=!1,d}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(CheckBox,[{key:"destroy",value:function destroy(){this.selected=!1,_get(_getPrototypeOf(CheckBox.prototype),"destroy",this).call(this)}},{key:"onPointerUpHandler",value:function onPointerUpHandler(t){this.interactiveBoo?((!this.mIsMove||Date.now()-this.mDownTime>this.mPressTime)&&Math.abs(t.downX-t.upX)<30&&Math.abs(t.downY-t.upY)<30&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.selected=!this.selected,this.emit(h.default.Tap,t,this)),clearTimeout(this.mPressDelay),this.mIsMove=!1,this.mDownTime=0):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"onPointerDownHandler",value:function onPointerDownHandler(t){var i=this;this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){i.emit(h.default.Hold,i)}),this.mPressTime),this.emit(h.default.Down,this)):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"selected",set:function set(t){this.mSelected=t;var i=t?c:l;this.buttonStateChange(i),this.emit("selectChange",t)},get:function get(){return this.mSelected}}]),CheckBox}(a.Button);o.default=u},"./lib/ui/combobox/Combobox.js":function(t,o,r){"use strict";r.r(o),r.d(o,"SelectCallItem",(function(){return h})),r.d(o,"ComboBox",(function(){return l}));var a=r("./lib/ui/baseUI/BaseUI.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var h=function(t){_inherits(SelectCallItem,t);var i=_createSuper(SelectCallItem);function SelectCallItem(t,o,r,a,h){var l;_classCallCheck(this,SelectCallItem),(l=i.call(this,t)).mSelect=!1,l.mSelectCallUI=o,l.soundGroup=h,l.mText=l.scene.make.text({x:-r>>1,y:-a>>1,style:{fill:"#F7EDED",fontSize:18}},!1);return l.mSelectBG=t.make.graphics(void 0,!1),l.mSelectBG.fillStyle(16763904,.8),l.mSelectBG.fillRect(-r>>1,-a>>1,r,a),l.mSelectBG.visible=!1,l.add([l.mSelectBG,l.mText]),l.width=r,l.height=a,l.setSize(r,a),l.setInteractive(),l}return _createClass(SelectCallItem,[{key:"setInteractive",value:function setInteractive(){return _get(_getPrototypeOf(SelectCallItem.prototype),"setInteractive",this).call(this,new Phaser.Geom.Rectangle(0,0,this.width,this.height),Phaser.Geom.Rectangle.Contains),this}},{key:"addListen",value:function addListen(){this.on("pointerover",this.overHandler,this),this.on("pointerout",this.outHandler,this),this.on("pointerdown",this.selectHandler,this)}},{key:"removeListen",value:function removeListen(){this.off("pointerover",this.overHandler,this),this.off("pointerout",this.outHandler,this),this.off("pointerdown",this.selectHandler,this)}},{key:"destroy",value:function destroy(){this.mInitialized&&(this.mText.destroy(!0),this.mSelectBG.destroy(!0),this.mItemData=null,this.mText=null,this.mSelectBG=null,this.mSelectCallUI=null,_get(_getPrototypeOf(SelectCallItem.prototype),"destroy",this).call(this))}},{key:"overHandler",value:function overHandler(){this.interactiveBoo&&(this.mSelectBG.visible=!0)}},{key:"selectHandler",value:function selectHandler(){this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.mSelectCallUI.playSound(this.soundGroup.down),this.overHandler(),this.mSelectCallUI.selectCall(this.mItemData)):this.soundGroup&&this.soundGroup.disabled&&this.mSelectCallUI.playSound(this.soundGroup.disabled)}},{key:"outHandler",value:function outHandler(){this.interactiveBoo&&(this.mSelectBG.visible=!1)}},{key:"itemData",set:function set(t){this.mItemData=t,this.mText.text=this.mItemData.text,this.mText.x=-this.width/2+(this.width-this.mText.width>>1),this.mText.y=-this.height/2+(this.height-this.mText.height>>1)},get:function get(){return this.mItemData}},{key:"selected",set:function set(t){this.mSelectBG.visible=t,this.mSelect=t},get:function get(){return this.mSelect}},{key:"interactive",get:function get(){return this.interactiveBoo}}]),SelectCallItem}(a.default),l=function(t){_inherits(ComboBox,t);var i=_createSuper(ComboBox);function ComboBox(t,o){var r;return _classCallCheck(this,ComboBox),(r=i.call(this,t)).mIsopen=!1,r.mInitialize=!1,r.itemList=[],r.mConfig=o,r.soundGroup=o.boxMusic,r.init(),r}return _createClass(ComboBox,[{key:"selectCall",value:function selectCall(t){this.mtxt.text=t.text,this.mtxt.x=this.mConfig.wid-this.mtxt.width>>1,this.mtxt.y=this.mConfig.hei-this.mtxt.height>>1,this.showTween(!1),this.mConfig.clickCallBack&&this.mConfig.clickCallBack.call(this,t)}},{key:"addListen",value:function addListen(){_get(_getPrototypeOf(ComboBox.prototype),"addListen",this).call(this),this.on("uiClick",this.openHandler,this)}},{key:"removeListen",value:function removeListen(){_get(_getPrototypeOf(ComboBox.prototype),"removeListen",this).call(this),this.off("uiClick",this.openHandler,this)}},{key:"destroy",value:function destroy(){if(this.itemList){for(var t=this.itemList.length,i=0;i<t;i++){var o=this.itemList[i];o&&o.destroy()}this.itemList.length=0,this.itemList=null}_get(_getPrototypeOf(ComboBox.prototype),"destroy",this).call(this)}},{key:"init",value:function init(){var t=this.mConfig.resKey,i=this.mConfig.resPng,o=this.mConfig.resJson;this.mInitialize=!1,this.scene.textures.exists(t)?this.onLoadCompleteHandler():(this.scene.load.atlas(t,i,o),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.scene.load.start())}},{key:"onLoadCompleteHandler",value:function onLoadCompleteHandler(){var t=this.mConfig.resKey;this.mBg=this.scene.make.image(void 0,!1),this.mBg.setTexture(t,this.mConfig.resBg),this.mBg.x=this.mConfig.wid/2,this.mBg.y=this.mConfig.hei/2,this.mBg.setSize(this.mConfig.wid,this.mConfig.hei),this.mArrow=this.scene.make.image(void 0,!1),this.mArrow.setTexture(t,this.mConfig.resArrow),this.mArrow.scaleY=this.mConfig.up?-1:1,this.mArrow.x=this.mConfig.wid-this.mArrow.width,this.mArrow.y=4+(this.mConfig.hei-this.mArrow.height>>1),this.mtxt=this.scene.make.text({x:0,y:0,style:{fill:"#F7EDED",fontSize:18}},!1),this.add([this.mBg,this.mArrow,this.mtxt]),this.mInitialize=!0,this.mSelectData=this.itemList[0],this.mSelectData&&this.selectCall(this.mSelectData)}},{key:"openHandler",value:function openHandler(){this.interactiveBoo?(this.soundGroup&&this.soundGroup.expand&&this.playSound(this.soundGroup.expand),!this.itemList||this.itemList.length<1||this.showTween(this.mIsopen)):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"showTween",value:function showTween(t){t?(this.mItemBG=this.createTexture(),this.addAt(this.mItemBG,0)):this.mItemBG&&(this.mItemBG.parentContainer&&this.mItemBG.parentContainer.remove(this.mItemBG),this.mItemBG.destroy()),this.mArrow.scaleY=t?1:-1,this.showTweenItem(t),this.mIsopen=!this.mIsopen}},{key:"showTweenItem",value:function showTweenItem(t){for(var i=this,o=this.itemList.length,r=function _loop(o){var r=i.itemList[o];if(!r)return"continue";r.x=i.mConfig.wid>>1,i.add(r),i.scene.tweens.add({targets:r,duration:50*o,props:{y:{value:t?-i.mConfig.hei*o-i.mConfig.hei/2:-i.mConfig.hei>>1},alpha:{value:t?1:0}},onComplete:function onComplete(o,a,h){t||i.remove(r)},onCompleteParams:[i]})},a=0;a<o;a++)r(a)}},{key:"createTexture",value:function createTexture(){var t=this.mConfig.hei*this.itemList.length,i=this.scene.make.graphics(void 0,!1);return i.fillStyle(4012088,.8),i.fillRect(0,-t,this.mConfig.wid,t),i}},{key:"text",set:function set(t){if(this.mInitialize){if(this.itemList){for(var i=this.itemList.length,o=0;o<i;o++){var r=this.itemList[o];r&&(r.destroy(),r=null)}this.itemList.length=0}this.itemList=[];for(var a=t.length,l=0;l<a;l++){var c=new h(this.scene,this,this.mConfig.wid,this.mConfig.hei,this.mConfig.itemMusic),u=t[l];c.itemData={index:l,text:u,data:{},selected:!1,enabled:!0},this.itemList.push(c)}this.selectCall(this.itemList[0].itemData)}}}]),ComboBox}(a.default)},"./lib/ui/container/Container.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/ContainerLite.js").default;i.default=r},"./lib/ui/flip/Flip.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/flip.js");i.default=r.default},"./lib/ui/gridsizer/GetChildrenHeight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenHeight(){if(this.TooqingSizer.hidden)return 0;for(var t,i,o,a,h,l=0,c=this.gridChildren,u=0;u<this.rowCount;u++){if(t=0,void 0===(h=this.rowProportions[u])||0===h){for(var p=0;p<this.columnCount;p++)(i=c[u*this.columnCount+p])&&(i.TooqingSizer.hidden||(a=i.isTooqingSizer?Math.max(i.minHeight,i.childrenHeight):Object(r.GetDisplayHeight)(i),a+=(o=i.TooqingSizer.padding).top+o.bottom,t=Math.max(t,a)));l+=t}this.rowHeight[u]=t}return l}},"./lib/ui/gridsizer/GetChildrenSizers.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenSizers(t){void 0===t&&(t=[]);for(var i,o=this.gridChildren,r=0,a=o.length;r<a;r++)(i=o[r])&&i.isTooqingSizer&&t.push(i);return t}},"./lib/ui/gridsizer/GetChildrenWidth.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenWidth(){if(this.TooqingSizer.hidden)return 0;for(var t,i,o,a,h,l=0,c=this.gridChildren,u=0;u<this.columnCount;u++){if(t=0,void 0===(h=this.columnProportions[u])||0===h){for(var p=0;p<this.rowCount;p++)(i=c[p*this.columnCount+u])&&(i.TooqingSizer.hidden||(a=i.isTooqingSizer?Math.max(i.minWidth,i.childrenWidth):Object(r.GetDisplayWidth)(i),a+=(o=i.TooqingSizer.padding).left+o.right,t=Math.max(t,a)));l+=t}this.columnWidth[u]=t}return l}},"./lib/ui/gridsizer/GetExpandedChildHeight.js":function(t,i,o){"use strict";o.r(i);i.default=function GetExpandedChildHeight(t,i){var o,r=t.TooqingSizer;if(r.expand){var a=r.padding;o=i-a.top-a.bottom}return o}},"./lib/ui/gridsizer/GetExpandedChildWidth.js":function(t,i,o){"use strict";o.r(i);i.default=function GetExpandedChildWidth(t,i){var o,r=t.TooqingSizer;if(r.expand){var a=r.padding;o=i-a.left-a.right}return o}},"./lib/ui/gridsizer/GridSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/basesizer/BaseSizer.js"),a=o("./lib/ui/gridsizer/Methods.js"),h=o("./lib/ui/utils/GetBoundsConfig.js"),l=o("./lib/ui/utils/AlignConst.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=Phaser.Utils.Objects.IsPlainObject,u=Phaser.Utils.Objects.GetValue,p=Phaser.Utils.Array.Remove,d=Phaser.Display.Align.CENTER,m=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GridSizer,t);var i=_createSuper(GridSizer);function GridSizer(t,o,r,a,h,l,p,d,m){var y,g;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GridSizer),c(o)?(o=u(g=o,"x",0),r=u(g,"y",0),a=u(g,"width",void 0),h=u(g,"height",void 0),l=u(g,"column",0),p=u(g,"row",0),d=u(g,"columnProportions",void 0),m=u(g,"rowProportions",void 0)):c(a)?(a=u(g=a,"width",void 0),h=u(g,"height",void 0),l=u(g,"column",0),p=u(g,"row",0),d=u(g,"columnProportions",void 0),m=u(g,"rowProportions",void 0)):c(l)?(l=u(g=l,"column",0),p=u(g,"row",0),d=u(g,"columnProportions",void 0),m=u(g,"rowProportions",void 0)):c(d)&&(d=u(g=d,"columnProportions",void 0),m=u(g,"rowProportions",void 0)),(y=i.call(this,t,o,r,a,h,g)).type="TooqingGridSizer",y.initialGrid(l,p,d,m),y}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GridSizer,[{key:"destroy",value:function destroy(t){this.scene&&(this.gridChildren.length=0,_get(_getPrototypeOf(GridSizer.prototype),"destroy",this).call(this,t))}},{key:"setColumnProportion",value:function setColumnProportion(t,i){return t>=this.columnProportions.length||(this.columnProportions[t]=i),this}},{key:"setRowProportion",value:function setRowProportion(t,i){return t>=this.rowProportions.length||(this.rowProportions[t]=i),this}},{key:"add",value:function add(t,i,o,r,a,p,m){var y;(_get(_getPrototypeOf(GridSizer.prototype),"add",this).call(this,t),c(i))&&(i=u(y=i,"column",0),o=u(y,"row",0),r=u(y,"align",d),a=u(y,"padding",0),p=u(y,"expand",!1),m=u(y,"key",void 0));return"string"==typeof r&&(r=l.default[r]),void 0===r&&(r=d),void 0===a&&(a=0),void 0===p&&(p=!0),(y=this.getSizerConfig(t)).parent=this,y.align=r,y.padding=Object(h.default)(a),y.expand=p,this.gridChildren[o*this.columnCount+i]=t,void 0!==m&&this.addChildrenMap(m,t),this}},{key:"remove",value:function remove(t){var i=this.getSizerConfig(t);return i.parent!==this||(i.parent=void 0,p(this.gridChildren,t),void 0!==this.backgroundChildren&&p(this.backgroundChildren,t),_get(_getPrototypeOf(GridSizer.prototype),"remove",this).call(this,t)),this}},{key:"initialGrid",value:function initialGrid(t,i,o,r){if(this.columnCount=t,this.rowCount=i,this.gridChildren=[],this.gridChildren.length=t*i,this.columnProportions=[],this.columnProportions.length=t,this.columnWidth=[],this.columnWidth.length=t,this.rowProportions=[],this.rowProportions.length=i,this.rowHeight=[],this.rowHeight.length=i,o)for(var a="number"==typeof o,h=0;h<t;h++)if(a)this.setColumnProportion(h,o);else{var l=o[h];l>0&&this.setColumnProportion(h,l)}if(r){var c="number"==typeof r;for(h=0;h<i;h++)if(c)this.setRowProportion(h,r);else{var u=r[h];u>0&&this.setRowProportion(h,u)}}return this}},{key:"totalColumnProportions",get:function get(){for(var t,i=0,o=0;o<this.columnCount;o++)(t=this.columnProportions[o])>0&&(i+=t);return i}},{key:"totalRowProportions",get:function get(){for(var t,i=0,o=0;o<this.rowCount;o++)(t=this.rowProportions[o])>0&&(i+=t);return i}}]),GridSizer}(r.default);Object.assign(m.prototype,a.default),i.default=m},"./lib/ui/gridsizer/Layout.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/gridsizer/GetExpandedChildWidth.js"),a=o("./lib/ui/gridsizer/GetExpandedChildHeight.js"),h=o("./lib/plugins/utils/size/ResizeGameObject.js"),l=o("./lib/plugins/utils/actions/GlobZone.js"),c=o("./lib/plugins/utils/align/align/in/QuickSet.js");i.default=function Layout(t,i,o){if(this.TooqingSizer.hidden)return this;this.preLayout(t);var u,p,d,m,y=this.totalColumnProportions,g=this.totalRowProportions;if(void 0===i)if(t&&y>0){var _=this.TooqingSizer.padding;i=t.width-_.left-_.right}else i=Math.max(this.childrenWidth,this.minWidth);if(void 0===o)if(t&&g>0){var _=this.TooqingSizer.padding;o=t.height-_.top-_.bottom}else o=Math.max(this.childrenHeight,this.minHeight);this.resize(i,o),u=y>0?(this.width-this.childrenWidth)/y:0,p=g>0?(this.height-this.childrenHeight)/g:0;for(var v,b,P,w,S,C,T,k,O,I,M=this.left,E=M,x=this.top,B=0;B<this.rowCount;B++){I=0===(k=this.rowProportions[B]||0)?this.rowHeight[B]:k*p,E=M;for(var R=0;R<this.columnCount;R++)O=0===(T=this.columnProportions[R]||0)?this.columnWidth[R]:T*u,(d=this.gridChildren[B*this.columnCount+R])&&!d.TooqingSizer.hidden?(S=Object(r.default)(d,O),C=Object(a.default)(d,I),d.isTooqingSizer?d.layout(this,S,C):Object(h.default)(d,S,C),v=E+(_=(m=d.TooqingSizer).padding).left,P=O-_.left-_.right,b=x+_.top,w=I-_.top-_.bottom,l.default.setPosition(v,b).setSize(P,w),Object(c.default)(d,l.default,m.align),this.resetChildPositionState(d),E+=O):E+=O;x+=I}return this.layoutBackgrounds(),this.postLayout()}},"./lib/ui/gridsizer/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/gridsizer/GetChildrenWidth.js"),a=o("./lib/ui/gridsizer/GetChildrenHeight.js"),h=o("./lib/ui/gridsizer/GetChildrenSizers.js"),l=o("./lib/ui/gridsizer/Layout.js"),c=o("./lib/ui/gridsizer/_layoutInit.js");i.default={getChildrenWidth:r.default,getChildrenHeight:a.default,getChildrenSizers:h.default,layout:l.default,_layoutInit:c.default}},"./lib/ui/gridsizer/_layoutInit.js":function(t,i,o){"use strict";o.r(i);i.default=function LayoutInitChild(){this._childrenWidth=void 0,this._childrenHeight=void 0}},"./lib/ui/gridtable/GameGridTable.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/gridtable/GridTable.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});Phaser.Utils.Objects.GetValue;var h=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GameGridTable,Phaser.GameObjects.Container);var i=_createSuper(GameGridTable);function GameGridTable(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GameGridTable),(r=i.call(this,t)).zoom=1;var h=o.x,l=o.y,c=o.table.width,u=o.table.height;r.setPosition(h,l),r.setSize(c,u),o.x=0,o.y=0;var p=o.createCellContainerCallback;o.createCellContainerCallback=function(t,i){var o=!i;return i=p(t,i),o&&r.add(i),i};var d=o.table.mask;if(o.table.mask=!1,void 0===d||!0===d){var m=o.table.zoom?o.table.zoom:1;r.zoom=m,r.maskGraphic=t.make.graphics(void 0,!1),r.maskGraphic.fillStyle(0);var y=r.width*r.zoom,g=r.height*r.zoom;r.maskGraphic.fillRect(.5*-y,.5*-g,y,g);var _=r.getWorldTransformMatrix();r.maskGraphic.setPosition(_.tx,_.ty),r.setMask(r.maskGraphic.createGeometryMask())}return r.mGridTable=new a.default(t,o),r.add(r.table),r.addListen(),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GameGridTable,[{key:"adjustCellHeight",value:function adjustCellHeight(t){if(this.mGridTable)for(var i=0,o=this.mGridTable.getCells().length;i<o;i++)this.mGridTable.setCellHeight(i,t)}},{key:"adjusetCellWidth",value:function adjusetCellWidth(t){if(this.mGridTable)for(var i=0,o=this.mGridTable.getCells().length;i<o;i++)this.mGridTable.setCellWidth(i,t)}},{key:"setItems",value:function setItems(t){this.mGridTable&&(this.mGridTable.setItems(t),this.mGridTable.layout())}},{key:"setColumnCount",value:function setColumnCount(t){return this.mGridTable.setColumnCount(t),this}},{key:"getCells",value:function getCells(){return this.mGridTable.getCells()}},{key:"getCell",value:function getCell(t){return this.mGridTable.getCell(t,!0)}},{key:"setT",value:function setT(t){this.mGridTable&&this.mGridTable.setT(t)}},{key:"addListen",value:function addListen(){this.mGridTable&&this.mGridTable.on("cell.1tap",this.cellTapHandler,this)}},{key:"removeListen",value:function removeListen(){this.mGridTable&&this.mGridTable.off("cell.1tap",this.cellTapHandler,this)}},{key:"refresh",value:function refresh(){this.mGridTable&&this.mGridTable.refresh()}},{key:"resetMask",value:function resetMask(t,i,o,r){if(this.mGridTable&&this.mGridTable.resetMask(),this.maskGraphic){var a=this.getWorldTransformMatrix();this.maskGraphic.setPosition(a.tx,a.ty)}}},{key:"layout",value:function layout(){this.mGridTable&&this.mGridTable.layout()}},{key:"refreshPos",value:function refreshPos(t,i,o,r){this.mGridTable&&(this.x=t,this.y=i,this.table&&void 0!==o&&void 0!==r&&(this.table.tableOX=o,this.table.tableOY=r),this.mGridTable.layout(),this.resetMask())}},{key:"setSize",value:function setSize(t,i){if(_get(_getPrototypeOf(GameGridTable.prototype),"setSize",this).call(this,t,i),this.maskGraphic){var o=this.width*this.zoom,r=this.height*this.zoom;this.maskGraphic.fillRect(.5*-o,.5*-r,o,r)}return this.mGridTable&&this.mGridTable.resetSize(t,i),this.resetMask(),this}},{key:"destroy",value:function destroy(){this.mGridTable&&(this.removeListen(),this.mGridTable.destroy())}},{key:"cellTapHandler",value:function cellTapHandler(t){this.emit("cellTap",t)}},{key:"gridTable",get:function get(){return this.mGridTable}},{key:"childrenMap",get:function get(){if(this.mGridTable)return this.mGridTable.childrenMap}},{key:"table",get:function get(){if(this.mGridTable)return this.mGridTable.getElement("table")}},{key:"items",get:function get(){return this.mGridTable?this.mGridTable.items:null}}]),GameGridTable}();o.default=h},"./lib/ui/gridtable/GridTable.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/scrollable/Scrollable.js"),a=o("./lib/ui/utils/GetScrollMode.js"),h=o("./lib/plugins/gameobjects/gridtable/GridTable.js"),l=o("./lib/ui/gridtable/InjectProperties.js"),c=o("./lib/ui/gridtable/TableOnCellVisible.js"),u=o("./lib/ui/gridtable/input/TableSetInteractive.js"),p=o("./lib/plugins/utils/object/NOOP.js"),d=o("./lib/ui/gridtable/SetItems.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m=Phaser.Utils.Objects.GetValue,y=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GridTable,t);var i=_createSuper(GridTable);function GridTable(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GridTable),void 0===o&&(o={});var d=Object(a.default)(o),y=m(o,"table",void 0);void 0===y&&(y={}),y.scrollMode=d,y.clamplTableOXY=m(o,"clamplChildOY",!1);var g,_,v=m(y,"width",void 0),b=m(y,"height",void 0),P=new h.default(t,0,0,v,b,y);t.add.existing(P),0===d?(g=void 0===v?1:0,_=void 0===b):(g=void 0===b?1:0,_=void 0===v),Object(l.default)(P),o.type="rexGridTable",o.child={gameObject:P,proportion:g,expand:_};var w=m(o,"space",void 0);w&&(w.child=w.table),(r=i.call(this,t,o)).addChildrenMap("table",P),r.eventEmitter=m(o,"eventEmitter",_assertThisInitialized(r));var S=m(o,"createCellContainerCallback",p.default),C=m(o,"createCellContainerCallbackScope",void 0);return r.setCreateCellContainerCallback(S,C),c.default.call(_assertThisInitialized(r),P),m(y,"interactive",!0)&&u.default.call(_assertThisInitialized(r),P,y),r.setItems(m(o,"items",[])),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GridTable,[{key:"setColumnCount",value:function setColumnCount(t){var i=this.getElement("table");return i&&i.setColumnCount(t),this}},{key:"getCells",value:function getCells(){return this.getElement("table").table.cells}},{key:"getCell",value:function getCell(t){return this.getElement("table").getCell(t,!0)}},{key:"setCreateCellContainerCallback",value:function setCreateCellContainerCallback(t,i){return this.createCellContainerCallback=t,this.createCellContainerCallbackScope=i,this}},{key:"resetMask",value:function resetMask(t,i,o,r){var a=this.getElement("table").getCellsMaskGameObject();a&&(a.setPosition(t,i),a.resize(o,r))}},{key:"refresh",value:function refresh(){return this.setItems(this.items),this}},{key:"resetSize",value:function resetSize(t,i){this.getElement("table").resize(t,i)}},{key:"tableOX",set:function set(t){var i=this.getElement("table");i&&(i.tableOX=t)}},{key:"tableOY",set:function set(t){var i=this.getElement("table");i&&(i.tableOY=t)}}]),GridTable}(r.default),g={setItems:d.default};Object.assign(y.prototype,g),i.default=y},"./lib/ui/gridtable/InjectProperties.js":function(t,i,o){"use strict";o.r(i);i.default=function InjectProperties(t){Object.defineProperty(t,"childOY",{configurable:!0,get:function get(){return t.tableOY},set:function set(i){t.tableOY=i}}),Object.defineProperty(t,"topChildOY",{get:function get(){return t.topTableOY}}),Object.defineProperty(t,"bottomChildOY",{get:function get(){return t.bottomTableOY}})}},"./lib/ui/gridtable/SetItems.js":function(t,i,o){"use strict";o.r(i);i.default=function SetItems(t){void 0===t?this.items.length=0:this.items=t;var i=this.childrenMap.child;return i.setCellsCount(this.items.length),i.updateTable(!0),this.resizeController(),this}},"./lib/ui/gridtable/TableOnCellVisible.js":function(t,i,o){"use strict";o.r(i);i.default=function TableOnCellVisible(t){t.on("cellvisible",(function(t,i){var o=this.createCellContainerCallback,r=this.createCellContainerCallbackScope;t.item=this.items[t.index],(i=r?o.call(r,t,i):o(t,i))&&(i.setOrigin&&i.setOrigin(0),i.isTooqingSizer&&i.layout()),t.item=void 0,t.setContainer(i)}),this)}},"./lib/ui/gridtable/input/ClickCell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/button/Button.js"),a=o("./lib/ui/gridtable/input/EmitCellEvent.js");i.default=function ClickCell(t,i){t._click=new r.default(t,{threshold:10}),t._click.on("click",(function(t,i,o){Object(a.default)(this.eventEmitter,"cell.click",i,o.x,o.y)}),this)}},"./lib/ui/gridtable/input/EmitCellEvent.js":function(t,i,o){"use strict";o.r(i);i.default=function EmitCellEvent(t,i,o,r,a){var h;if(null!=(h=void 0===a?r:o.pointerToCellIndex(r,a))){var l=o.getCellContainer(h);t.emit(i,l,h)}}},"./lib/ui/gridtable/input/OverCell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/gridtable/input/EmitCellEvent.js"),a=function OnMove(t){if(!t.isDown){var i=this.childrenMap.child,o=i.pointerToCellIndex(t.x,t.y);if(o!==this._lastOverCellIndex){var a=this._lastOverCellIndex;this._lastOverCellIndex=o,Object(r.default)(this.eventEmitter,"cell.out",i,a),Object(r.default)(this.eventEmitter,"cell.over",i,o)}}},h=function OnOut(){var t=this.childrenMap.child,i=this._lastOverCellIndex;this._lastOverCellIndex=void 0,Object(r.default)(this.eventEmitter,"cell.out",t,i)};i.default=function OverCell(t,i){t.on("pointermove",a,this).on("pointerover",a,this).on("pointerup",h,this).on("pointerout",h,this)}},"./lib/ui/gridtable/input/PressCell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/press/Press.js"),a=o("./lib/ui/gridtable/input/EmitCellEvent.js"),h=Phaser.Utils.Objects.GetValue;i.default=function PressCell(t,i){var o=h(i,"press",void 0);t._press=new r.default(t,o),t._press.on("pressstart",(function(i){var o=t.pointerToCellIndex(i.x,i.y);i._cellIndex=o,Object(a.default)(this.eventEmitter,"cell.pressstart",t,o)}),this).on("pressend",(function(i){var o=i._cellIndex;i._cellIndex=void 0,Object(a.default)(this.eventEmitter,"cell.pressend",t,o)}),this)}},"./lib/ui/gridtable/input/SwipeCell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/swipe/Swipe.js"),a=o("./lib/ui/gridtable/input/EmitCellEvent.js"),h=Phaser.Utils.Objects.GetValue;i.default=function SwipeCell(t,i){var o=h(i,"swipe",void 0);void 0===o&&(o={}),o.dir="4dir",t._swipe=new r.default(t,o),t._swipe.on("swipe",(function(i){if(0===t.scrollMode?i.left||i.right:i.up||i.down){var o=t.pointerToCellIndex(i.x,i.y),r=i.left?"left":i.right?"right":i.up?"up":"down";Object(a.default)(this.eventEmitter,"cell.swipe".concat(r),t,o)}}),this)}},"./lib/ui/gridtable/input/TableSetInteractive.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/gridtable/input/ClickCell.js"),a=o("./lib/ui/gridtable/input/OverCell.js"),h=o("./lib/ui/gridtable/input/TapCell.js"),l=o("./lib/ui/gridtable/input/PressCell.js"),c=o("./lib/ui/gridtable/input/SwipeCell.js");i.default=function TableSetInteractive(t,i){t.setInteractive(),r.default.call(this,t,i),a.default.call(this,t,i),h.default.call(this,t,i),l.default.call(this,t,i),c.default.call(this,t,i)}},"./lib/ui/gridtable/input/TapCell.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/tap/Tap.js"),a=o("./lib/ui/gridtable/input/EmitCellEvent.js"),h=Phaser.Utils.Objects.GetValue;i.default=function TapCell(t,i){var o=h(i,"press",void 0);t._tap=new r.default(t,o),t._tap.on("tap",(function(t){var i="cell.".concat(t.tapsCount,"tap");Object(a.default)(this.eventEmitter,i,t.gameObject,t.x,t.y)}),this)}},"./lib/ui/inputText/InputText.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/plugins/utils/input/StopPropagationTouchEvents.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var h=Phaser.Utils.Objects.IsPlainObject,l=Phaser.Utils.Objects.GetValue,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(InputText,Phaser.GameObjects.DOMElement);var i=_createSuper(InputText);function InputText(t,o,r,c,m,y){var g;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,InputText),h(o)?(o=l(y=o,"x",0),r=l(y,"y",0),c=l(y,"width",void 0),m=l(y,"height",void 0)):h(c)&&(c=l(y=c,"width",void 0),m=l(y,"height",void 0)),void 0===y&&(y={});var _,v=t.scale.autoRound;void 0!==c&&(v&&(c=Math.floor(c)),y.width=c+"px"),void 0!==m&&(v&&(m=Math.floor(m)),y.height=m+"px");var b,P,w=l(y,"type","text");for(var S in"textarea"===w?(_=document.createElement("textarea")).style.resize="none":(_=document.createElement("input")).type=w,u)b=u[S],void 0!==(P=l(y,S,b[1]))&&(_[b[0]]=P);var C,T,k=l(y,"style",void 0);for(var S in void 0===k&&(k={}),p)C=p[S],void 0!==(T=l(y,S,C[1]))&&(k[C[0]]=T);var O=_.style;for(var S in y)S in u||S in p||S in O&&(k[S]=y[S]);k["box-sizing"]="border-box",(g=i.call(this,t,o,r,_,k)).type="TooqingInputText";var I=function _loop(t){g.node[d[t]]=function(){this.emit(t,this)}.bind(_assertThisInitialized(g))};for(var M in d)I(M);return Object(a.default)(g.node),g}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(InputText,[{key:"resize",value:function resize(t,i){var o=this.node.style;return o.width=t+"px",o.height=i+"px",this.updateSize(),this}},{key:"setText",value:function setText(t){return this.text=t,this}},{key:"selectText",value:function selectText(){return this.node.select(),this}},{key:"setPlaceholder",value:function setPlaceholder(t){return this.placeholder=t,this}},{key:"setTooltip",value:function setTooltip(t){return this.tooltip=t,this}},{key:"setTextChangedCallback",value:function setTextChangedCallback(t){return this.onTextChanged=t,this}},{key:"setReadOnly",value:function setReadOnly(t){return void 0===t&&(t=!0),this.readOnly=t,this}},{key:"setSpellCheck",value:function setSpellCheck(t){return this.spellCheck=t,this}},{key:"setStyle",value:function setStyle(t,i){return this.node.style[t]=i,this}},{key:"getStyle",value:function getStyle(t){return this.node.style[t]}},{key:"scrollToBottom",value:function scrollToBottom(){return this.node.scrollTop=this.node.scrollHeight,this}},{key:"setEnabled",value:function setEnabled(t){return void 0===t&&(t=!0),this.node.disabled=!t,this}},{key:"setBlur",value:function setBlur(){return this.node.blur(),this}},{key:"setFocus",value:function setFocus(){return this.node.focus(),this}},{key:"text",get:function get(){return this.node.value},set:function set(t){this.node.value=t}},{key:"placeholder",get:function get(){return this.node.placeholder},set:function set(t){this.node.placeholder=t}},{key:"tooltip",get:function get(){return this.node.title},set:function set(t){this.node.title=t}},{key:"readOnly",get:function get(){return this.node.readOnly},set:function set(t){this.node.readOnly=t}},{key:"spellCheck",get:function get(){return this.node.spellcheck},set:function set(t){this.node.spellcheck=t}}]),InputText}(),u={id:["id",void 0],text:["value",void 0],placeholder:["placeholder",void 0],tooltip:["title",void 0],readOnly:["readonly",!1],spellCheck:["spellcheck",!1],autoComplete:["autocomplete","off"]},p={align:["textAlign",void 0],width:["width",void 0],height:["height",void 0],fontFamily:["fontFamily",void 0],fontSize:["font-size",void 0],color:["color","#ffffff"],backgroundColor:["backgroundColor","transparent"],borderColor:["borderColor","transparent"],outline:["outline","none"]},d={textchange:"oninput",click:"onclick",dblclick:"ondblclick",focus:"onfocus",blur:"onblur"};o.default=c},"./lib/ui/interface/baseUI/Patches.config.js":function(t,o,r){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r.r(o),r.d(o,"Patches_config",(function(){return h})),r.d(o,"IPatchesConfig",(function(){return a})),Object.defineProperty(i,"__esModule",{value:!0});var a={top:0,left:0,right:0,bottom:0},h=function(){function Patches_config(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Patches_config)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Patches_config,null,[{key:"normalizePatchesConfig",value:function normalizePatchesConfig(t){return t.bottom=void 0!==t.bottom?t.bottom:t.top,t.left=void 0!==t.left?t.left:t.top,t.right=void 0!==t.right?t.right:t.left,t}},{key:"resetPatchesConfig",value:function resetPatchesConfig(t){return t.top=0,t.bottom=0,t.left=0,t.right=0,t}}]),Patches_config}()},"./lib/ui/interface/baseUI/UIType.js":function(t,o,r){"use strict";r.r(o),Object.defineProperty(i,"__esModule",{value:!0});o.default={None:1,Scene:2,Normal:3,Pop:4,Tips:5,Monopoly:6,Activity:7}},"./lib/ui/interface/event/ClickEvent.js":function(t,o,r){"use strict";r.r(o),Object.defineProperty(i,"__esModule",{value:!0});o.default={Click:"click",Up:"Up",Down:"Down",Hold:"Hold",Tap:"Tap",Move:"Move",Over:"Over",Out:"Out",DragStart:"DragStart",DragStop:"DragStop"}},"./lib/ui/interface/ninepatch/NinePatchSkin.js":function(t,i,o){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(NinePatchSkin,Phaser.Events.EventEmitter);var i=_createSuper(NinePatchSkin);function NinePatchSkin(t,o){var r;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,NinePatchSkin),(r=i.call(this)).mScene=t,r.setSkinData(o),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(NinePatchSkin,[{key:"setSkinData",value:function setSkinData(t){this.mSkinData=t,this.mSkinData&&this.setNinePatchRes(this.mSkinData,this.mSkin)}},{key:"destroy",value:function destroy(){this.mSkin&&(this.mSkin.destroy(),this.mSkin=null),_get(_getPrototypeOf(NinePatchSkin.prototype),"destroy",this).call(this)}},{key:"setNinePatchRes",value:function setNinePatchRes(t,i){}},{key:"x",set:function set(t){this.mSkin&&(this.mSkin.x=t)}},{key:"y",set:function set(t){this.mSkin&&(this.mSkin.y=t)}},{key:"skin",get:function get(){return this.mSkin}}]),NinePatchSkin}();i.NinePatchSkin=r},"./lib/ui/interface/sound/ISoundConfig.js":function(t,o,r){"use strict";r.r(o),r.d(o,"ISoundGroup",(function(){return h})),r.d(o,"ISoundConfig",(function(){return a})),Object.defineProperty(i,"__esModule",{value:!0});var a={key:"",field:0,soundConfig:void 0},h={open:void 0,close:void 0,click:void 0,down:void 0,up:void 0,move:void 0,disabled:void 0,progress:void 0,expand:void 0}},"./lib/ui/interface/sound/SoundField.js":function(t,o,r){"use strict";r.r(o),Object.defineProperty(i,"__esModule",{value:!0});o.default={Background:"Background",Element:"Element",Effect:"Effect"}},"./lib/ui/label/Label.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/Sizer.js"),a=o("./lib/ui/utils/AddChildMask.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=Phaser.Utils.Objects.GetValue,l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Label,t);var i=_createSuper(Label);function Label(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Label),(r=i.call(this,t,o)).type="TooqingLabel";var a=h(o,"background",void 0),l=h(o,"icon",void 0),c=h(o,"iconMask",void 0),u=h(o,"text",void 0),p=h(o,"action",void 0),d=h(o,"actionMask",void 0),m=h(o,"align",void 0),y=h(o,"space.left",0),g=h(o,"space.right",0),_=h(o,"space.top",0),v=h(o,"space.bottom",0),b=h(o,"space.icon",0),P=h(o,"space.text",0);(a&&r.addBackground(a),"right"!==m&&"bottom"!==m&&"center"!==m||r.addSpace(),l)&&(S=0===r.orientation?{left:y,right:u||p?b:g,top:_,bottom:v}:{left:y,right:g,top:_,bottom:u||p?b:v},r.add(l,0,"center",S),c&&(c=r.addChildMask(l,l,1)));if(u){var w,S,C,T=h(o,"expandTextWidth",!1),k=h(o,"expandTextHeight",!1);0===r.orientation?(w=T?1:0,S={left:l?0:y,right:p?P:g,top:_,bottom:v},C=k):(w=k?1:0,S={left:y,right:g,top:l?0:_,bottom:p?P:v},C=T),r.add(u,w,"center",S,C)}p&&(S=0===r.orientation?{left:l||u?0:y,right:g,top:_,bottom:v}:{left:y,right:g,top:l||u?0:_,bottom:v},r.add(p,0,"center",S),d&&(d=r.addChildMask(p,p,1)));return"center"===m&&r.addSpace(),r.addChildrenMap("background",a),r.addChildrenMap("icon",l),r.addChildrenMap("iconMask",c),r.addChildrenMap("text",u),r.addChildrenMap("action",p),r.addChildrenMap("actionMask",d),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Label,[{key:"setText",value:function setText(t){return this.text=t,this}},{key:"appendText",value:function appendText(t){this.text+=t}},{key:"layout",value:function layout(t,i,o){_get(_getPrototypeOf(Label.prototype),"layout",this).call(this,t,i,o);var r=this.childrenMap.iconMask;r&&(r.setPosition(),this.resetChildPositionState(r));var a=this.childrenMap.actionMask;return a&&(a.setPosition(),this.resetChildPositionState(a)),this}},{key:"resize",value:function resize(t,i){_get(_getPrototypeOf(Label.prototype),"resize",this).call(this,t,i);var o=this.childrenMap.iconMask;o&&o.resize();var r=this.childrenMap.actionMask;return r&&r.resize(),this}},{key:"text",get:function get(){var t=this.childrenMap.text;return void 0===t?"":t.text?t.text:t.getData("text")},set:function set(t){var i=this.childrenMap.text;void 0!==i&&(i.setText?i.setText(t):i.setData("text",t))}}]),Label}(r.default),c={addChildMask:a.default};Object.assign(l.prototype,c),i.default=l},"./lib/ui/menu/Collapse.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/menu/GetEaseConfig.js");i.default=function Collapse(){return this.root.emit("collapse",this,this.parentButton,this.parentMenu),this.scaleDownDestroy(Object(r.default)(this,this.root.easeOut)),this.collapseSubMenu(),this}},"./lib/ui/menu/CollapseSubMenu.js":function(t,i,o){"use strict";o.r(i);i.default=function CollapseSubMenu(){if(void 0===this.childrenMap.subMenu)return this;var t=this.childrenMap.subMenu;return this.childrenMap.subMenu=void 0,this.remove(t),t.collapse(),this}},"./lib/ui/menu/CreateBackground.js":function(t,i,o){"use strict";o.r(i);i.default=function CreateBackground(t,i,o,r){var a;return o&&(i.scene=t,a=r?o.call(r,i):o(i),i.scene=void 0),a}},"./lib/ui/menu/CreateButtons.js":function(t,i,o){"use strict";o.r(i);i.default=function CreateButtons(t,i,o,r){var a,h,l=[];if(i&&o)for(var c=0,u=i.length;c<u;c++)(a=i[c]).scene=t,h=r?o.call(r,a,c,i):o(a,c,i),a.scene=void 0,l.push(h);return l}},"./lib/ui/menu/ExpandSubMenu.js":function(t,i,o){"use strict";o.r(i);i.default=function ExpandSubMenu(t,i){var o;this.collapseSubMenu(),o=this.root.toggleOrientation?0===this.orientation?1:0:this.orientation;var r=new this.constructor(this.scene,{items:i,orientation:o,createBackgroundCallback:this.root.createBackgroundCallback,createBackgroundCallbackScope:this.root.createBackgroundCallbackScope,createButtonCallback:this.root.createButtonCallback,createButtonCallbackScope:this.root.createButtonCallbackScope,easeIn:this.root.easeIn,easeOut:this.root.easeOut,_rootMenu:this.root,_parentMenu:this,_parentButton:t});return this.pin(r),this.childrenMap.subMenu=r,this.root.emit("expand",r,t,this),this}},"./lib/ui/menu/GetEaseConfig.js":function(t,i,o){"use strict";o.r(i);i.default=function GetEaseConfig(t,i){return i.orientation=t.orientation,i}},"./lib/ui/menu/Menu.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/buttons/Buttons.js"),a=o("./lib/ui/menu/Methods.js"),h=o("./lib/ui/menu/CreateBackground.js"),l=o("./lib/ui/menu/CreateButtons.js"),c=o("./lib/plugins/utils/defaultbounds/GetDefaultBounds.js"),u=o("./lib/ui/menu/MenuSetInteractive.js"),p=o("./lib/ui/menu/GetEaseConfig.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=Phaser.Utils.Objects.GetValue,m=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Menu,t);var i=_createSuper(Menu);function Menu(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Menu),void 0===o&&(o={}),o.hasOwnProperty("orientation")||(o.orientation=1);var a=o._rootMenu,m=o._parentMenu,y=o._parentButton,g=d(o,"items",void 0),_=d(o,"createBackgroundCallback",void 0),v=d(o,"createBackgroundCallbackScope",void 0);o.background=Object(h.default)(t,g,_,v);var b=d(o,"createButtonCallback",void 0),P=d(o,"createButtonCallbackScope",void 0);o.buttons=Object(l.default)(t,g,b,P),(r=i.call(this,t,o)).type="TooqingMenu",r.items=g,r.root=void 0===a?_assertThisInitialized(r):a,r.parentMenu=m,r.parentButton=y;var w=r.root===_assertThisInitialized(r);w&&(void 0===(S=o.bounds)&&(S=Object(c.default)(t)),r.bounds=S,r.expandEventName=d(o,"expandEvent","button.click"),r.toggleOrientation=d(o,"toggleOrientation",!1),r.easeIn=d(o,"easeIn",0),"number"==typeof r.easeIn&&(r.easeIn={duration:r.easeIn}),r.easeOut=d(o,"easeOut",0),"number"==typeof r.easeOut&&(r.easeOut={duration:r.easeOut}),r.createBackgroundCallback=_,r.createBackgroundCallbackScope=v,r.createButtonCallback=b,r.createButtonCallbackScope=P,r._isPassedEvent=!1);r.setOrigin(0).layout();var S=r.root.bounds;if(w)r.expandOrientation=[r.y<S.centerY?1:3,r.x<S.centerX?0:2];else switch(r.root.expandOrientation[m.orientation]){case 0:r.alignTop(y.top).alignLeft(y.right);break;case 1:r.alignLeft(y.left).alignTop(y.bottom);break;case 2:r.alignTop(y.top).alignRight(y.left);break;case 3:r.alignLeft(y.left).alignBottom(y.top)}return r.pushIntoBounds(S),Object(u.default)(_assertThisInitialized(r)),r.popUp(Object(p.default)(_assertThisInitialized(r),r.root.easeIn)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Menu,[{key:"isInTouching",value:function isInTouching(t){return!!_get(_getPrototypeOf(Menu.prototype),"isInTouching",this).call(this,t)||!!this.childrenMap.subMenu&&this.childrenMap.subMenu.isInTouching(t)}}]),Menu}(r.default);Object.assign(m.prototype,a.default),i.default=m},"./lib/ui/menu/MenuSetInteractive.js":function(t,i,o){"use strict";o.r(i);i.default=function MenuSetInteractive(t){t.on(t.root.expandEventName,(function(t,i){if(!this._isPassedEvent){var o=this.items[i].children;o&&this.expandSubMenu(t,o)}}),t).on("button.click",(function(t,i,o,r){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.click",t,i,o,r),this.root._isPassedEvent=!1)}),t).on("button.over",(function(t,i,o,r){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.over",t,i,o,r),this.root._isPassedEvent=!1)}),t).on("button.out",(function(t,i,o,r){this!==this.root&&(this.root._isPassedEvent=!0,this.root.emit("button.out",t,i,o,r),this.root._isPassedEvent=!1)}),t)}},"./lib/ui/menu/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/menu/ExpandSubMenu.js"),a=o("./lib/ui/menu/Collapse.js"),h=o("./lib/ui/menu/CollapseSubMenu.js");i.default={expandSubMenu:r.default,collapse:a.default,collapseSubMenu:h.default}},"./lib/ui/messageBox/MessageBox.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/panel/Panel.js"),h=r("./lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js"),l=r("./lib/ui/interface/event/ClickEvent.js"),c=r("./lib/ui/button/Button.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(MessageBox,t);var i=_createSuper(MessageBox);function MessageBox(t,o,r){var a;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,MessageBox),(a=i.call(this,t,o)).btnNum=2,a.key=void 0!==r?u(r,"key","pica_alert"):"pica_alert",a.png=void 0!==r?u(r,"png","pica_alert/pica_alert.png"):"pica_alert/pica_alert.png",a.json=void 0!==r?u(r,"json","pica_alert/pica_alert.json"):"pica_alert/pica_alert.json",a.bgFrame=void 0!==r?u(r,"bgFrame","bg.png"):"bg.png",a.titleFrame=void 0!==r?u(r,"titleFrame","title.png"):"title.png",a.disInteractive(),a}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(MessageBox,[{key:"show",value:function show(t){this.mCurData=t,_get(_getPrototypeOf(MessageBox.prototype),"show",this).call(this,t),this.mInitialized&&(this.mWorld.uiManager.getUILayerManager().addToDialogLayer(this),this.x=this.scene.cameras.main.width/2,this.y=this.scene.cameras.main.height/2,this.mContent.setText(t.text),t.title&&this.mTitleLabel.setText(t.title),this.btnNum>0&&(!this.btnList||this.btnList.length<1)&&this.setbtnNum(this.btnNum))}},{key:"preload",value:function preload(){this.addAtlas(this.key,this.png,this.json),_get(_getPrototypeOf(MessageBox.prototype),"preload",this).call(this)}},{key:"setText",value:function setText(t){this.mContent&&this.mContent.setText("[color=#FF0000]"+t+"[/color]")}},{key:"setTitle",value:function setTitle(t){this.mTitleLabel&&this.mTitleLabel.setText(t)}},{key:"setbtnNum",value:function setbtnNum(t){if(this.btnNum=t||MessageBox.OK,this.mInitialized){this.btnList=[],this.btnNum>=MessageBox.OK&&(this.add(this.mOkBtn),this.mOkBtn.visible=!0,this.btnList.push(this.mOkBtn)),this.btnNum>=MessageBox.CANCEL&&(this.add(this.mCancelBtn),this.mCancelBtn.visible=!0,this.btnList.push(this.mCancelBtn));for(var i=this.width/(this.btnList.length+1),o=0;o<this.btnList.length;o++)this.btnList[o].x=o*i-(this.btnList[o].width>>1)}}},{key:"addResources",value:function addResources(t,i){_get(_getPrototypeOf(MessageBox.prototype),"addResources",this).call(this,t,i),i.data&&this.scene.load.atlas(t,this.png,this.json)}},{key:"init",value:function init(){var t=this.scene.make.image({key:this.key,frame:this.bgFrame},!1);this.setSize(t.width,t.height);var i=this.scene.make.image({key:this.key,frame:this.titleFrame},!1);i.y=-t.height/2,this.mTitleLabel=this.scene.make.text({text:"title",style:{fontFamily:"'Source Han Sans'",fontSize:10*this.dpr,color:"#905B06"}},!1).setOrigin(.5),this.mTitleLabel.y=i.y,this.mContent=new h.default(this.scene,0,-11*this.dpr,"",{fontSize:9*this.dpr+"px",fontFamily:"'Source Han Sans'",color:"#0",wrap:{mode:"char",width:145*this.dpr}}),this.mContent.setOrigin(.5,.5),this.mContent.setText("[color=#FF0000]content[/color]"),this.mOkBtn=new c.Button(this.scene,this.key,"yellow_btn.png",void 0,"确定"),this.mOkBtn.setTextColor("#905B06"),this.mOkBtn.x=(t.width-this.mOkBtn.width)/2-20*this.dpr,this.mOkBtn.y=(t.height-this.mOkBtn.height)/2-11*this.dpr,this.mOkBtn.on(l.default.Tap,this.onOkHandler,this),this.mCancelBtn=new c.Button(this.scene,this.key,"red_btn.png",void 0,"取消"),this.mCancelBtn.x=-(t.width-this.mCancelBtn.width)/2+20*this.dpr,this.mCancelBtn.y=this.mOkBtn.y,this.mCancelBtn.on(l.default.Tap,this.onCancelHandler,this),this.add([t,i,this.mTitleLabel,this.mTitleLabel,this.mContent,this.mOkBtn,this.mCancelBtn]),this.mCancelBtn.visible=!1,this.mOkBtn.visible=!1,_get(_getPrototypeOf(MessageBox.prototype),"init",this).call(this)}},{key:"onOkHandler",value:function onOkHandler(){if(this.mCurData){var t=this.mCurData.callback;t&&t.call(this.mCurData.content)}}},{key:"onCancelHandler",value:function onCancelHandler(){this&&this.parentContainer&&this.parentContainer.remove(this)}}]),MessageBox}(a.default);p.OK=1,p.CANCEL=2,o.default=p},"./lib/ui/ninepatch/NinePatch.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/ninepatch/NinePatch.js").default;i.default=r},"./lib/ui/ninepatch/NineSlicePatch.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/baseUI/BaseUI.js"),h=r("./lib/ui/interface/baseUI/Patches.config.js");r("./lib/ui/tool/Tool.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});Phaser.Utils.Objects.GetValue;var l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(NineSlicePatch,t);var i=_createSuper(NineSlicePatch);function NineSlicePatch(t,o,r,a,h,l,c,u,p,d,m){var y;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,NineSlicePatch),(y=i.call(this,t,p,d)).mCorrection=4,y.dpr=p||1,y.scale=d||1,y.mCorrection=void 0===m?4:0,y.patchesConfig={top:0,left:0,right:0,bottom:0},y.patchKey=1e3*Math.random()+"",y.setConfig(u),y.setSize(a,h),y.setTexture(l,c),y.setPosition(o,r),y}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(NineSlicePatch,[{key:"resize",value:function resize(t,i){return t=Math.round(t),i=Math.round(i),this.patchesConfig?this.width===t&&this.height===i?this:(this.setSize(t,i),void this.drawPatches()):this}},{key:"getConfig",value:function getConfig(){return this.patchesConfig}},{key:"setConfig",value:function setConfig(t){Object.assign(this.patchesConfig,t),this.patchesConfig.top=Math.round(this.patchesConfig.top),this.patchesConfig.right&&(this.patchesConfig.right=Math.round(this.patchesConfig.right)),this.patchesConfig.bottom&&(this.patchesConfig.bottom=Math.round(this.patchesConfig.bottom)),this.patchesConfig.left&&(this.patchesConfig.left=Math.round(this.patchesConfig.left)),h.Patches_config.normalizePatchesConfig(t),h.Patches_config.normalizePatchesConfig}},{key:"setTexture",value:function setTexture(t,i){return this.originTexture=this.scene.textures.get(t),this.originTexture.setFilter(Phaser.Textures.FilterMode.NEAREST),this.setFrame(i),this}},{key:"setFrame",value:function setFrame(t){return this.originFrame=this.originTexture.frames[t]||this.originTexture.frames[NineSlicePatch.__BASE],this.createPatches(),this.drawPatches(),this}},{key:"setSize",value:function setSize(t,i){_get(_getPrototypeOf(NineSlicePatch.prototype),"setSize",this).call(this,t,i);var o=this.width/(this.patchesConfig.left+this.patchesConfig.right),r=this.width/(this.patchesConfig.top+this.patchesConfig.bottom);o=o>=1?1:o,r=r>=1?1:r;var a=this.width-this.patchesConfig.right>0?this.width-this.patchesConfig.right:this.patchesConfig.right,h=this.height-this.patchesConfig.bottom>0?this.height-this.patchesConfig.bottom:this.patchesConfig.right;return this.finalXs=[0,this.patchesConfig.left*o,a*o,this.width],this.finalYs=[0,this.patchesConfig.top*r,h*r,this.height],this}},{key:"setTint",value:function setTint(t){return this.tint=t,this}},{key:"setTintFill",value:function setTintFill(t){return this.tint=t,this.tintFill=!0,this}},{key:"clearTint",value:function clearTint(){this.each((function(t){return t.clearTint()})),this.internalTint=void 0,this.tintFill=!1}},{key:"destroy",value:function destroy(){if(this.originTexture)for(var t=0,i=0;i<3;i++)for(var o=0;o<3;o++){var r=this.getPatchNameByIndex(t);this.originTexture.frames.hasOwnProperty(r)&&this.originTexture.remove(r),++t}_get(_getPrototypeOf(NineSlicePatch.prototype),"destroy",this).call(this)}},{key:"createPatches",value:function createPatches(){for(var t=[0,this.patchesConfig.left,this.originFrame.width-this.patchesConfig.right,this.originFrame.width],i=[0,this.patchesConfig.top,this.originFrame.height-this.patchesConfig.bottom,this.originFrame.height],o=0,r=0;r<3;r++)for(var a=0;a<3;a++)this.createPatchFrame(this.getPatchNameByIndex(o),t[a],i[r],t[a+1]-t[a],i[r+1]-i[r]),++o}},{key:"drawPatches",value:function drawPatches(){var t=this.tintFill;this.removeAll(!0);for(var i=0,o=0;o<3;o++)for(var r=0;r<3;r++){var a=this.originTexture.frames[this.getPatchNameByIndex(i)],h=new Phaser.GameObjects.Image(this.scene,0,0,a.texture.key,a.name);h.setOrigin(0),h.setPosition(this.finalXs[r]-this.width*this.originX,this.finalYs[o]-this.height*this.originY),h.displayWidth=this.finalXs[r+1]-this.finalXs[r]+(r<2?this.mCorrection:0),h.displayHeight=this.finalYs[o+1]-this.finalYs[o]+(o<2?this.mCorrection:0),h.texture.setFilter(Phaser.Textures.FilterMode.NEAREST),this.add(h),this.internalTint&&h.setTint(this.internalTint),h.tintFill=t,++i}}},{key:"createPatchFrame",value:function createPatchFrame(t,i,o,r,a){this.originTexture.frames.hasOwnProperty(t)||this.originTexture.add(t,this.originFrame.sourceIndex,this.originFrame.cutX+i,this.originFrame.cutY+o,r,a)}},{key:"getPatchNameByIndex",value:function getPatchNameByIndex(t){return this.originFrame.name+NineSlicePatch.patches[t]+this.patchKey}},{key:"correctValue",set:function set(t){this.mCorrection=t}},{key:"tintFill",get:function get(){return this.first&&this.first.tintFill},set:function set(t){this.each((function(i){return i.tintFill=t}))}},{key:"tint",set:function set(t){this.each((function(i){return i.setTint(t)})),this.internalTint=t}},{key:"isTinted",get:function get(){return this.first&&this.first.isTinted}}]),NineSlicePatch}(a.default);l.__BASE="__BASE",l.patches=["[0][0]","[1][0]","[2][0]","[0][1]","[1][1]","[2][1]","[0][2]","[1][2]","[2][2]"],o.default=l},"./lib/ui/panel/Panel.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/tool/Tool.js"),h=r("./lib/ui/baseUI/BaseUI.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Panel,t);var i=_createSuper(Panel);function Panel(t,o,r){var a;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Panel),(a=i.call(this,t,o.uiRatio,o.uiScale)).mPanelTween,a.mResources,a.mReLoadResources,a.mShowData,a.id,a.UIType,a.mPreLoad=!1,a.mTweening=!1,a.mReloadTimes=0,a.mTweenBoo=!0,a.mMute=!1,a.mEnabled=!0,a.soundMap=new Map,a.scene=t,a.mWorld=o,a.soundGroup=r,a.mInitialized=!1,a.setTween(!1),a}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Panel,[{key:"addListen",value:function addListen(){this.mInitialized&&(this.removeListen(),_get(_getPrototypeOf(Panel.prototype),"addListen",this).call(this))}},{key:"removeListen",value:function removeListen(){this.mInitialized&&_get(_getPrototypeOf(Panel.prototype),"removeListen",this).call(this)}},{key:"setFollow",value:function setFollow(t,i,o){this.mFollow=t,this.mFroscene=i,o&&(this.posFunc=o)}},{key:"isShow",value:function isShow(){return this.mShow}},{key:"hide",value:function hide(){this.soundGroup&&this.soundGroup.close&&this.playSound(this.soundGroup.close),!this.mTweening&&this.mTweenBoo?this.showTween(!1):this.destroy()}},{key:"destroy",value:function destroy(){this.mPanelTween&&(this.mPanelTween.stop(),this.mPanelTween.remove(),this.mPanelTween=void 0),this.mResources&&(this.mResources.clear(),this.mResources=void 0),this.mMute=!1,this.mInitialized=!1,this.mShow=!1,this.width=0,this.height=0,this.mReloadTimes=0,this.offLoad(),_get(_getPrototypeOf(Panel.prototype),"destroy",this).call(this)}},{key:"resize",value:function resize(t,i){}},{key:"show",value:function show(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())}},{key:"update",value:function update(t){this.mShowData=t}},{key:"updateUIState",value:function updateUIState(t){}},{key:"tweenExpand",value:function tweenExpand(t){}},{key:"setTween",value:function setTween(t){this.mTweenBoo=t}},{key:"showTween",value:function showTween(t){var i=this;this.mTweening=!0;var o=t?this.scale:0;this.scale=o,this.mPanelTween&&this.mPanelTween.stop(),this.mPanelTween=this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:{scaleX:{value:o},scaleY:{value:o}},onComplete:function onComplete(){i.tweenComplete(t)},onCompleteParams:[this]})}},{key:"tweenComplete",value:function tweenComplete(t){this.mTweening=!1,this.mPanelTween.stop(),this.mShow=t,t||this.destroy()}},{key:"init",value:function init(){this.mInitialized=!0,this.mResources&&(this.mResources.clear(),this.mResources=null),this.show(this.mShowData)}},{key:"addAtlas",value:function addAtlas(t,i,o){this.mResources||(this.mResources=new Map),this.mResources.set(t,{dpr:this.dpr,type:"atlas",texture:i,data:o})}},{key:"addImage",value:function addImage(t,i){this.mResources||(this.mResources=new Map),void 0===i&&(i=t),this.mResources.set(t,{dpr:this.dpr,type:"image",texture:i})}},{key:"preload",value:function preload(){var t=this;this.mPreLoad=!0,this.scene&&(this.mResources&&this.mResources.forEach((function(i,o){t.addResources(o,i)}),this),this.startLoad())}},{key:"loadComplete",value:function loadComplete(t,i,o){this.mPreLoad&&(this.mPreLoad=!1,this.mInitialized||(o>0&&this.mResources&&this.mResources.size>0?this.reload():(this.offLoad(),this.init())))}},{key:"loadError",value:function loadError(t){if(this.mResources){var i=this.mResources.get(t.key);i&&(i.dpr=2,this.mReLoadResources||(this.mReLoadResources=new Map),this.mReLoadResources.set(t.key,i))}}},{key:"onFileKeyComplete",value:function onFileKeyComplete(t){this.mResources&&this.mResources.has(t)&&this.mResources.delete(t)}},{key:"addResources",value:function addResources(t,i){this.scene}},{key:"reload",value:function reload(){var t=this;!this.mReLoadResources||this.mReLoadResources.size<=0||++this.mReloadTimes>1||(this.mReLoadResources.forEach((function(i,o){t.addResources(o,i)}),this),this.startLoad())}},{key:"startLoad",value:function startLoad(){this.scene&&(this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onFileKeyComplete,this),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.loadComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.loadError,this),this.scene.load.start())}},{key:"offLoad",value:function offLoad(){this.scene&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onFileKeyComplete,this),this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.loadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.loadError,this))}},{key:"sceneClick",value:function sceneClick(t){a.Tool.checkPointerContains(this,t)&&this.checkPointerDelection(t)&&this.emit("panelClick",t)}},{key:"uiClick",value:function uiClick(t){this.checkPointerDelection(t)&&this.emit("panelClick",t)}},{key:"showData",get:function get(){return this.mShowData}},{key:"interactive",get:function get(){return this.mEnabled}}]),Panel}(h.default);o.default=l},"./lib/ui/press/Press.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/press/Press.js");i.default=r.default},"./lib/ui/progressbar/ProgressBar.js":function(t,o,r){"use strict";r.r(o),r.d(o,"ProgressBarEvent",(function(){return l})),r.d(o,"ProgressBar",(function(){return u}));var a=r("./lib/ui/ninepatch/NineSlicePatch.js"),h=r("./lib/ui/baseUI/BaseUI.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l={tweenStart:"tweenStart",tweenComplete:"tweenComplete",tweenUpdate:"tweenUpdate"},c=Phaser.Utils.Objects.GetValue,u=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(ProgressBar,t);var i=_createSuper(ProgressBar);function ProgressBar(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,ProgressBar),(r=i.call(this,t)).mConfig=o;var h=o.x,l=o.y;r.width=o.width,r.height=o.height,r.setPosition(h,l),r.setSize(r.width,r.height),r.dpr=c(o,"dpr",1),r.scale=c(o,"scale",1);var u=o.background,p=o.bar;r.mBgSkin=new a.default(t,u.x,u.y,u.width,u.height,u.key,u.frame,u.config,r.dpr,r.scale),r.mBarSkin=new a.default(t,p.x,p.y,p.width,p.height,p.key,p.frame,p.config,r.dpr,r.scale);r.mText=t.make.text({style:Object.assign({},o.textConfig)},!1),r.barWid=p.width;var d=r.mBarSkin.height;return r.mBarMaskGraphics=r.scene.make.graphics(void 0,!1),r.mBarMaskGraphics.fillStyle(0,1),r.mBarMaskGraphics.beginPath(),r.mBarMaskGraphics.fillRect(0,0,10,d),r.mBarMaskGraphics.setPosition(-r.barWid/2,-d/2),r.add([r.mBgSkin,r.mBarSkin,r.mText]),r.disInteractive(),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(ProgressBar,[{key:"setProgress",value:function setProgress(t,i){var o=t/i;o>1?o=1:o<0&&(o=0),this.curWid=o*this.barWid;var r=this.mBarSkin.height;this.mBarSkin.resize(this.curWid,r),this.mBarSkin.x=-this.barWid/2+this.curWid/2}},{key:"setText",value:function setText(t){this.mText&&(this.mText.text=t,this.mText.parentContainer||this.add(this.mText))}},{key:"destory",value:function destory(){_get(_getPrototypeOf(ProgressBar.prototype),"destroy",this).call(this)}},{key:"text",get:function get(){return this.mText}},{key:"bar",get:function get(){return this.mBarSkin}}]),ProgressBar}(h.default)},"./lib/ui/rotate/Rotate.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/rotate/Rotate.js");i.default=r.default},"./lib/ui/roundrectangle/RoundRectangle.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js").default;i.default=r},"./lib/ui/scrollableblock/GetChildrenHeight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenHeight(){if(this.TooqingSizer.hidden)return 0;var t=this.child;return t.TooqingSizer.hidden||0===this.scrollMode?0:t.isTooqingSizer?Math.max(t.minHeight,t.childrenHeight):Object(r.GetDisplayHeight)(t)}},"./lib/ui/scrollableblock/GetChildrenWidth.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenWidth(){if(this.TooqingSizer.hidden)return 0;var t=this.child;return t.TooqingSizer.hidden?0:0===this.scrollMode?t.isTooqingSizer?Math.max(t.minWidth,t.childrenWidth):Object(r.GetDisplayWidth)(t):0}},"./lib/ui/scrollableblock/Layout.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/ResizeGameObject.js"),a=o("./lib/plugins/utils/mask/MaskToGameObject.js");i.default=function Layout(t,i,o){if(this.TooqingSizer.hidden)return this;this.preLayout(t),void 0===i&&(i=Math.max(this.childrenWidth,this.minWidth)),void 0===o&&(o=Math.max(this.childrenHeight,this.minHeight)),this.resize(i,o);var h,l,c=this.child;if(!c.TooqingSizer.hidden&&(0===this.scrollMode?h=this.width:l=this.height,c.isTooqingSizer?c.layout(this,h,l):Object(r.default)(c,h,l),this.resetChildPosition(),this.childMask)){var u=Object(a.default)(this.childMask);u.setPosition().resize(),this.resetChildPositionState(u)}return this.postLayout()}},"./lib/ui/scrollableblock/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/scrollableblock/SetChild.js"),a=o("./lib/ui/scrollableblock/GetChildrenWidth.js"),h=o("./lib/ui/scrollableblock/GetChildrenHeight.js"),l=o("./lib/ui/scrollableblock/ResetChildPosition.js"),c=o("./lib/ui/scrollableblock/Layout.js");i.default={setChild:r.default,getChildrenWidth:a.default,getChildrenHeight:h.default,resetChildPosition:l.default,layout:c.default}},"./lib/ui/scrollableblock/ResetChildPosition.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/containerlite/MaskChildren.js");i.default=function ResetChildPosition(){var t=this.left,i=this.top;0===this.scrollMode?i+=this.childOY:t+=this.childOY,this.child.setPosition(t,i),Object(r.default)(this,this.childMask,this.child.getAllChildren()),this.resetChildPositionState(this.child)}},"./lib/ui/scrollableblock/ScrollableBlock.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/basesizer/BaseSizer.js"),a=o("./lib/ui/scrollableblock/Methods.js"),h=o("./lib/ui/utils/ScrollModeConst.js"),l=o("./lib/plugins/utils/size/GetDisplaySize.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=Phaser.Utils.Objects.IsPlainObject,u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(ScrollableBlock,t);var i=_createSuper(ScrollableBlock);function ScrollableBlock(t,o,r,a,h,l){var p;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,ScrollableBlock),c(o)?(o=u(l=o,"x",0),r=u(l,"y",0),a=u(l,"width",void 0),h=u(l,"height",void 0)):c(a)&&(a=u(l=a,"width",void 0),h=u(l,"height",void 0)),(p=i.call(this,t,o,r,a,h,l)).type="TooqingScrollableBlock",p.child=void 0,p.childMask=void 0,p._childOY=0,p.execeedTopState=!1,p.execeedBottomState=!1,p.setScrollMode(u(l,"scrollMode",!0)),p.setClampMode(u(l,"clamplChildOY",!0));var d=u(l,"child",void 0),m=u(l,"expand",!0),y=u(l,"mask",void 0);return p.setChild(d,m,y),p}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(ScrollableBlock,[{key:"destroy",value:function destroy(t){this.scene&&(this.child=void 0,this.childMask&&(this.childMask.destroy(),this.childMask=void 0),_get(_getPrototypeOf(ScrollableBlock.prototype),"destroy",this).call(this,t))}},{key:"setScrollMode",value:function setScrollMode(t){return"string"==typeof t&&(t=h.default[t.toLowerCase()]),this.scrollMode=t,this}},{key:"setClampMode",value:function setClampMode(t){return this.clampChildOYMode=t,this}},{key:"childOYExceedTop",value:function childOYExceedTop(t){return void 0===t&&(t=this.childOY),t>this.topChildOY}},{key:"childOYExeceedBottom",value:function childOYExeceedBottom(t){return void 0===t&&(t=this.childOY),t<this.bottomChildOY}},{key:"setChildOY",value:function setChildOY(t){return this.childOY=t,this}},{key:"setChildOYByPercentage",value:function setChildOYByPercentage(t){return this.t=t,this}},{key:"instHeight",get:function get(){return 0===this.scrollMode?this.height:this.width}},{key:"instWidth",get:function get(){return 0===this.scrollMode?this.width:this.height}},{key:"childHeight",get:function get(){return 0===this.scrollMode?Object(l.GetDisplayHeight)(this.child):Object(l.GetDisplayWidth)(this.child)}},{key:"childWidth",get:function get(){return 0===this.scrollMode?Object(l.GetDisplayWidth)(this.child):Object(l.GetDisplayHeight)(this.child)}},{key:"topChildOY",get:function get(){return 0}},{key:"bottomChildOY",get:function get(){return-this.visibleHeight}},{key:"visibleHeight",get:function get(){var t=this.childHeight,i=this.instHeight;return t>i?t-i:0}},{key:"childOY",get:function get(){return this._childOY},set:function set(t){var i=this.topChildOY,o=this.bottomChildOY,r=this.childOYExceedTop(t),a=this.childOYExeceedBottom(t);this.clampChildOYMode&&(this.instHeight>this.childHeight?t=0:r?t=i:a&&(t=o)),this._childOY!==t&&(this._childOY=t,this.resetChildPosition()),r&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=r,a&&(this.execeedBottomState||this.emit("execeedbottom",this,t,o)),this.execeedBottomState=a}},{key:"t",set:function set(t){this.childOY=-this.visibleHeight*t},get:function get(){var t=this.visibleHeight;return 0===t?0:this.childOY/-t}}]),ScrollableBlock}(r.default);Object.assign(p.prototype,a.default),i.default=p},"./lib/ui/scrollableblock/SetChild.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/mask/DefaultMask.js"),a=Phaser.Utils.Objects.GetValue,h=Phaser.Display.Align.TOP_LEFT;i.default=function SetChild(t,i,o){t.setOrigin&&t.setOrigin(0),this.add(t);var l,c,u=this.getSizerConfig(t);if(u.parent=this,u.align=h,u.expand=i,this.child=t,!0===o?(l=!0,c=0):!1===o?l=!1:(l=a(o,"mask",!0),c=a(o,"padding",0)),l){var p=new r.default(this,0,c);this.childMask=p.createGeometryMask(),this.pin(p)}return this}},"./lib/ui/scrollablepanel/ScrollablePanel.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/scrollable/Scrollable.js"),a=o("./lib/ui/utils/GetScrollMode.js"),h=o("./lib/ui/scrollableblock/ScrollableBlock.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Phaser.Utils.Objects.GetValue,c=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(ScrollablePanel,t);var i=_createSuper(ScrollablePanel);function ScrollablePanel(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,ScrollablePanel),void 0===o&&(o={});var c=Object(a.default)(o),u=l(o,"panel",void 0);void 0===u&&(u={}),u.scrollMode=c,u.clamplChildOY=l(o,"clamplChildOY",!1);var p,d,m=new h.default(t,u),y=l(u,"width",void 0),g=l(u,"height",void 0);0===c?(p=void 0===y?1:0,d=void 0===g):(p=void 0===g?1:0,d=void 0===y),o.type="TooqingScrollablePanel",o.child={gameObject:m,proportion:p,expand:d};var _=l(o,"space",void 0);return _&&(_.child=_.panel),(r=i.call(this,t,o)).addChildrenMap("panel",r.childrenMap.child.child),r}return ScrollablePanel}(r.default);i.default=c},"./lib/ui/scroller/GameScroller.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/plugins/input/scroller/Scroller.js"),h=r("./lib/ui/baseUI/BaseUI.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function _unsupportedIterableToArray(t,i){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _arrayLikeToArray(t,i)}(t))){var i=0,o=function F(){};return{s:o,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a,h=!0,l=!1;return{s:function s(){r=t[Symbol.iterator]()},n:function n(){var t=r.next();return h=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{h||null==r.return||r.return()}finally{if(l)throw a}}}}function _arrayLikeToArray(t,i){(null==i||i>t.length)&&(i=t.length);for(var o=0,r=new Array(i);o<i;o++)r[o]=t[o];return r}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l="downinBound",c="downoutBound",u="upinBound",p="upoutBound",d=Phaser.Utils.Objects.GetValue,m=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GameScroller,t);var i=_createSuper(GameScroller);function GameScroller(t,o,r){var h;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GameScroller),(h=i.call(this,t)).mMoveing=!1,h.zoom=1,h.soundMap=new Map,h.mConfig=o,h.soundGroup=o.music,h.x=o.x,h.y=o.y,h.width=h.mConfig.width,h.height=h.mConfig.height,h.zoom=o.zoom?o.zoom:1,h.maskGraphic=t.make.graphics(void 0,!1),h.maskGraphic.fillStyle(0),h.maskGraphic.fillRect(.5*-h.width*h.zoom,.5*-h.height*h.zoom,h.width*h.zoom,h.height*h.zoom);var l=h.getWorldTransformMatrix();h.maskGraphic.setPosition(l.tx,l.ty),r?h.mGameObject=r:(h.mGameObject=t.make.container(void 0,!1),h.add(h.mGameObject)),h.mGameObject.setMask(h.maskGraphic.createGeometryMask());var c=o.valuechangeCallback;return o.valuechangeCallback=function(t){h.onScrollValueChange(t),c&&c(t)},h.mScroller=new a.default(_assertThisInitialized(h),o),h.mDisDelection=d(o,"interactivedisDetection",10),h.mCellDownHandler=d(o,"celldownCallBack",void 0),h.mCellUpHandler=d(o,"cellupCallBack",void 0),h.setInteractive(),h.addListen(),h}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GameScroller,[{key:"setEnable",value:function setEnable(t){this.mScroller&&this.mScroller.setEnable(t)}},{key:"setValue",value:function setValue(t){this.mScroller&&this.mScroller.setValue(t)}},{key:"getValue",value:function getValue(){return this.mScroller.value}},{key:"adjustBackDeceleration",value:function adjustBackDeceleration(t){this.mScroller&&this.mScroller.setBackDeceleration(t)}},{key:"adjustSlidingDeceleration",value:function adjustSlidingDeceleration(t){this.mScroller&&this.mScroller.setSlidingDeceleration(t)}},{key:"adjustScrollMode",value:function adjustScrollMode(t){this.mConfig.orientation&&this.mConfig.orientation===t||this.mScroller&&this.mScroller.setOrientationMode(t),this.mConfig.orientation=t}},{key:"adjustDragThreshol",value:function adjustDragThreshol(t){this.mScroller&&this.mScroller.setDragThreshold(t)}},{key:"updateScrollPos",value:function updateScrollPos(t){this.mConfig.orientation?this.mGameObject.x=t:this.mGameObject.y=t}},{key:"setParent",value:function setParent(t){t.add(this),this.refreshMask()}},{key:"resetSize",value:function resetSize(t,i){this.setSize(t,i),this.scene.input.setHitArea(this),this.maskGraphic&&(this.maskGraphic.clear(),this.maskGraphic.fillRect(.5*-this.width*this.zoom,.5*-this.height*this.zoom,this.width*this.zoom,this.height*this.zoom),this.refreshMask()),this.Sort()}},{key:"refreshMask",value:function refreshMask(){var t=this.getWorldTransformMatrix();this.maskGraphic.setPosition(t.tx,t.ty)}},{key:"adjustMask",value:function adjustMask(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.mConfig.x,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.mConfig.y;this.mGameObject.clearMask();var a=this.scene.make.graphics(void 0,!1);a.fillStyle(0),a.fillRect(0,0,t,i),a.setPosition(o,r),this.mGameObject.setMask(a.createGeometryMask())}},{key:"addItem",value:function addItem(t){this.mGameObject.add(t),this.setInteractiveObject(t)}},{key:"addItems",value:function addItems(t){this.mGameObject.add(t);var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var r=i.value;this.setInteractiveObject(r)}}catch(t){o.e(t)}finally{o.f()}}},{key:"addItemAt",value:function addItemAt(t,i){this.mGameObject.addAt(t,i),this.setInteractiveObject(t)}},{key:"getItemList",value:function getItemList(){return this.mGameObject.list}},{key:"getItemAt",value:function getItemAt(t){return this.mGameObject.list[t]}},{key:"setBounds",value:function setBounds(t,i){this.mScroller.setBounds(t,i)}},{key:"setAlign",value:function setAlign(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;this.mConfig.align=t,this.Sort()}},{key:"Sort",value:function Sort(){var t,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0,a=i?this.getScrollBound():0,h=void 0===this.mConfig.space?0:this.mConfig.space,l=this.mGameObject.list,c=[],u=_createForOfIteratorHelper(l);try{for(u.s();!(t=u.n()).done;){var p=t.value;p.visible&&c.push(p)}}catch(t){u.e(t)}finally{u.f()}for(var d=0,m=c;d<m.length;d++){var y=m[d];1===this.mConfig.orientation?(y.x=y.width*y.originX+r,r+=y.width+h):(y.y=y.height*y.originY+r,r+=y.height+h)}if(r-=h,1===this.mConfig.orientation){this.mGameObject.width=r;var g,_=_createForOfIteratorHelper(c);try{for(_.s();!(g=_.n()).done;){var v=g.value;v.x-=.5*r}}catch(t){_.e(t)}finally{_.f()}r-=this.width}else{this.mGameObject.height=r;var b,P=_createForOfIteratorHelper(c);try{for(P.s();!(b=P.n()).done;){var w=b.value;w.y-=.5*r}}catch(t){P.e(t)}finally{P.f()}r-=this.height}var S=0,C=0,T=0;r<0?T=S=C=0===this.mConfig.align?-r/2:1===this.mConfig.align?0:r/2:(S=-r/2,C=r/2,T=0===this.mConfig.align?S:1===this.mConfig.align?0:C),this.mLeftBound=S,this.mRightBound=C;var k=T;i&&((k+=a)<S&&(k=S),k>C&&(k=C)),this.setBounds(S,C),o&&this.setValue(k)}},{key:"getScrollBound",value:function getScrollBound(){var t=0,i=0,o=0;1===this.mConfig.orientation?(t=this.width,i=this.mGameObject.width):(t=this.height,i=this.mGameObject.height),o=i-t,0===this.mConfig.align?o=-o/2:1===this.mConfig.align?o=0:o/=2;return 1===this.mConfig.orientation?this.mGameObject.x-o:this.mGameObject.y-o}},{key:"clearItems",value:function clearItems(){var t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=this.mGameObject.list,r=_createForOfIteratorHelper(o);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.mGameObject.remove(a),i&&a.destroy()}}catch(t){r.e(t)}finally{r.f()}this.clearInteractiveObject()}},{key:"removeInteractiveObject",value:function removeInteractiveObject(t){var i=this.mInteractiveList.indexOf(t);i>-1&&this.mInteractiveList.splice(i,1)}},{key:"addListen",value:function addListen(){this.scene&&(this.removeListen(),this.mConfig.selfevent||!1?(this.on("pointermove",this.pointerMoveHandler,this),this.on("pointerdown",this.pointerDownHandler,this),this.on("pointerup",this.pointerUpHandler,this)):(this.scene.input.on("pointermove",this.pointerMoveHandler,this),this.scene.input.on("pointerdown",this.pointerDownHandler,this),this.scene.input.on("pointerup",this.pointerUpHandler,this)))}},{key:"removeListen",value:function removeListen(){(this.mMoveing=!1,this.scene)&&(this.mConfig.selfevent||!1?(this.off("pointermove",this.pointerMoveHandler,this),this.off("pointerdown",this.pointerDownHandler,this),this.off("pointerup",this.pointerUpHandler,this)):(this.scene.input.off("pointerdown",this.pointerDownHandler,this),this.scene.input.off("pointerup",this.pointerUpHandler,this),this.scene.input.off("pointermove",this.pointerMoveHandler,this)))}},{key:"setInteractiveObject",value:function setInteractiveObject(t){this.mInteractiveList||(this.mInteractiveList=[]),this.mInteractiveList.push(t)}},{key:"destroy",value:function destroy(){this.mMoveing=!1,this.mGameObject&&this.mGameObject.clearMask(!0),this.mScroller&&this.mScroller.destroy(),_get(_getPrototypeOf(GameScroller.prototype),"destroy",this).call(this)}},{key:"clearInteractiveObject",value:function clearInteractiveObject(){this.mInteractiveList&&(this.mInteractiveList.length=0,this.mInteractiveList=[],this.mScroller.setBounds(0,0))}},{key:"pointerMoveHandler",value:function pointerMoveHandler(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move)}},{key:"pointerDownHandler",value:function pointerDownHandler(t){t.upX=t.downX,t.upY=t.downY,this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down);var i=this.checkPointerInBounds(this,t);if(i){if(this.mCellDownHandler&&!this.mMoveing){if(!this.mInteractiveList)return;for(var o=0,r=this.mInteractiveList.length;o<r;o++){var a=this.mInteractiveList[o];if(this.checkPointerInBounds(a,t,!0)){this.mCellDownHandler(a);break}}}var h=i?l:c;this.emit(h,this)}}},{key:"pointerUpHandler",value:function pointerUpHandler(t,i){this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up);var o=this.checkPointerInBounds(this,t);if(o&&this.checkPointerDelection(t)){if(this.mCellUpHandler&&!this.mMoveing){if(!this.mInteractiveList)return;for(var r=0,a=this.mInteractiveList.length;r<a;r++){var h=this.mInteractiveList[r];if(this.checkPointerInBounds(h,t,!0)){this.mCellUpHandler(h);break}}}var l=o?u:p;this.emit(l,this)}this.mMoveing=!1}},{key:"checkPointerInBounds",value:function checkPointerInBounds(t,i){var o=30*this.mConfig.dpr;if(Math.abs(i.downX-i.upX)>=o||Math.abs(i.downY-i.upY)>=o)return!1;this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var r=this.mConfig.zoom?this.mConfig.zoom:1;if(this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,i){var a=t.getWorldTransformMatrix(),h=(i.x-a.tx)/r,l=(i.y-a.ty)/r;return this.mRectangle.left<=h&&this.mRectangle.right>=h&&this.mRectangle.top<=l&&this.mRectangle.bottom>=l}return!1}},{key:"onScrollValueChange",value:function onScrollValueChange(t){1===this.mConfig.orientation?this.mGameObject.x=t:this.mGameObject.y=t}},{key:"view",get:function get(){return this.mGameObject}},{key:"isSliding",get:function get(){return this.mScroller.isSliding}},{key:"dragSpeed",get:function get(){return this.mScroller.dragSpeed}},{key:"bounds",get:function get(){return[this.mLeftBound,this.mRightBound]}},{key:"left",get:function get(){return-this.mGameObject.width/2}},{key:"right",get:function get(){return this.mGameObject.width/2}},{key:"top",get:function get(){return-this.mGameObject.height/2}},{key:"bottom",get:function get(){return this.mGameObject.height/2}}]),GameScroller}(h.default);o.default=m},"./lib/ui/scroller/Scroller.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/plugins/input/scroller/Scroller.js"),h=r("./lib/ui/baseUI/BaseUI.js"),l=r("./lib/plugins/utils/size/ResizeGameObject.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var c=1,u=2,p=3,d=4,m=Phaser.Utils.Objects.GetValue,y=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(BaseScroller,t);var i=_createSuper(BaseScroller);function BaseScroller(t,o,r){var h;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,BaseScroller),(h=i.call(this,t)).soundGroup=r.music,h.mChildPad=0,h.mMoveing=!1,h.soundMap=new Map,h.mConfig=r;var l=t.make.graphics(void 0,!1);l.fillStyle(0),l.fillRect(0,0,r.width,r.height),l.setPosition(r.x,r.y),h.width=h.mConfig.width,h.height=h.mConfig.height,o.setMask(l.createGeometryMask()),h.mGameObject=o,h.basePoint=r.basePoint?r.basePoint:new Phaser.Geom.Point(h.mGameObject.parentContainer.x,h.mGameObject.parentContainer.y);var c=t.make.container(void 0,!1);return c.setSize(r.width,r.height),h.mGameObject.parentContainer&&(c.x=r.clickX,c.y=r.clickY,h.mGameObject.parentContainer.add(c)),h.mScroller=new a.default(c,r),h.clickContainer=c,h.mDisDelection=m(r,"interactivedisDetection",10),h.mCellDownHandler=m(r,"celldownCallBack",void 0),h.mCellUpHandler=m(r,"cellupCallBack",void 0),h.setInteractive(),h.addListen(),h}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(BaseScroller,[{key:"setEnable",value:function setEnable(t){this.mScroller&&this.mScroller.setEnable(t)}},{key:"setValue",value:function setValue(t){this.mScroller&&this.mScroller.setValue(t)}},{key:"adjustBackDeceleration",value:function adjustBackDeceleration(t){this.mScroller&&this.mScroller.setBackDeceleration(t)}},{key:"adjustSlidingDeceleration",value:function adjustSlidingDeceleration(t){this.mScroller&&this.mScroller.setSlidingDeceleration(t)}},{key:"adjustScrollMode",value:function adjustScrollMode(t){this.mConfig.orientation&&this.mConfig.orientation===t||this.mScroller&&this.mScroller.setOrientationMode(t),this.mConfig.orientation=t}},{key:"adjustDragThreshol",value:function adjustDragThreshol(t){this.mScroller&&this.mScroller.setDragThreshold(t)}},{key:"adjustMask",value:function adjustMask(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.mConfig.x,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.mConfig.y,a=this.mGameObject.mask;if(!a){var h=this.mConfig;(a=this.scene.make.graphics(void 0,!1)).fillStyle(0),a.fillRect(0,0,t,i),a.setPosition(h.x,h.y),this.width=t,this.height=i,this.mGameObject.setMask(a.createGeometryMask())}a.x=o,a.y=r,Object(l.default)(a,t,i)}},{key:"setBounds",value:function setBounds(t,i){this.mScroller.setBounds(t,i)}},{key:"resize",value:function resize(t,i,o,r){this.width=t,this.height=i,this.mGameObject.parentContainer&&(this.clickContainer.x=this.mConfig.clickX,this.clickContainer.y=this.mConfig.clickY,this.mGameObject.parentContainer.add(this.clickContainer)),void 0!==o&&void 0!==r&&this.mScroller.setBounds(o,r)}},{key:"clearInteractiveObject",value:function clearInteractiveObject(){this.mInteractiveList&&(this.mInteractiveList.length=0,this.mInteractiveList=[],this.mScroller.setBounds(0,0))}},{key:"setInteractiveObject",value:function setInteractiveObject(t){this.mInteractiveList||(this.mInteractiveList=[]),this.mInteractiveList.push(t)}},{key:"removeInteractiveObject",value:function removeInteractiveObject(t){var i=this.mInteractiveList.indexOf(t);i>-1&&this.mInteractiveList.splice(i,1)}},{key:"addListen",value:function addListen(){this.scene&&(this.removeListen(),this.scene.input.on("pointermove",this.pointerMoveHandler,this),this.scene.input.on("pointerdown",this.pointerDownHandler,this),this.scene.input.on("pointerup",this.pointerUpHandler,this))}},{key:"removeListen",value:function removeListen(){this.mMoveing=!1,this.scene&&(this.scene.input.off("pointerdown",this.pointerDownHandler,this),this.scene.input.off("pointerup",this.pointerUpHandler,this),this.scene.input.off("pointermove",this.pointerMoveHandler,this))}},{key:"destroy",value:function destroy(){this.mMoveing=!1,this.mGameObject&&this.mGameObject.clearMask(!0),this.mScroller&&this.mScroller.destroy(),this.clickContainer&&this.clickContainer.destroy(),_get(_getPrototypeOf(BaseScroller.prototype),"destroy",this).call(this)}},{key:"refreshBound",value:function refreshBound(t){var i=this,o=0;void 0!==t?o=t:this.mInteractiveList.forEach((function(t){t&&(o+=i.mConfig.orientation?t.width:t.height)}));var r=this.mConfig.orientation?this.basePoint.x:this.basePoint.y,a=this.mConfig.orientation?this.mConfig.width:this.mConfig.height;o<a&&(o=a),this.setBounds(r,r-o+a)}},{key:"pointerMoveHandler",value:function pointerMoveHandler(t){this.soundGroup&&this.soundGroup.move&&this.playSound(this.soundGroup.move)}},{key:"pointerDownHandler",value:function pointerDownHandler(t){this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down);var i=this.checkPointerInBounds(this.clickContainer,t);if(i&&this.checkPointerDelection(t)){if(this.mCellDownHandler&&!this.mMoveing){if(!this.mInteractiveList)return;for(var o=0,r=this.mInteractiveList.length;o<r;o++){var a=this.mInteractiveList[o];if(this.checkPointerInBounds(a,t,!0)){this.mCellDownHandler(a);break}}}var h=i?c:u;this.emit(h,this.clickContainer)}}},{key:"pointerUpHandler",value:function pointerUpHandler(t,i){if(!(i&&this.mInteractiveList&&this.mInteractiveList.length>0&&-1===this.mInteractiveList.indexOf(i[0])&&i[0]!==this.clickContainer)){this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up);var o=this.checkPointerInBounds(this.clickContainer,t);if(o&&this.checkPointerDelection(t)){if(this.mCellUpHandler&&!this.mMoveing){if(!this.mInteractiveList)return;for(var r=0,a=this.mInteractiveList.length;r<a;r++){var h=this.mInteractiveList[r];if(this.checkPointerInBounds(h,t,!0)){this.mCellUpHandler(h);break}}}var l=o?p:d;this.emit(l,this.clickContainer)}this.mMoveing=!1}}},{key:"checkPointerInBounds",value:function checkPointerInBounds(t,i){if(this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0)),this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,i){var o=t.getWorldTransformMatrix(),r=i.x-o.tx,a=i.y-o.ty;return this.mRectangle.left<=r&&this.mRectangle.right>=r&&this.mRectangle.top<=a&&this.mRectangle.bottom>=a}return!1}},{key:"bounds",get:function get(){return this.mConfig.bounds}},{key:"left",get:function get(){return-this.mGameObject.width/2}},{key:"right",get:function get(){return this.mGameObject.width/2}},{key:"top",get:function get(){return-this.mGameObject.height/2}},{key:"bottom",get:function get(){return this.mGameObject.height/2}},{key:"boundPad0",get:function get(){return this.mScroller.boundPad0}},{key:"boundPad1",get:function get(){return this.mScroller.boundPad1}}]),BaseScroller}(h.default);o.default=y},"./lib/ui/sizer/GetChildrenHeight.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenHeight(t){if(this.TooqingSizer.hidden)return 0;void 0===t&&(t=!0);var i,o,a,h=0,l=this.sizerChildren;if(0===this.orientation)for(var c=0,u=l.length;c<u;c++)(i=l[c]).TooqingSizer.hidden||(a=i.isTooqingSizer?Math.max(i.minHeight,i.childrenHeight):Object(r.GetDisplayHeight)(i),a+=(o=i.TooqingSizer.padding).top+o.bottom,h=Math.max(a,h));else for(c=0,u=l.length;c<u;c++)(i=l[c]).hasOwnProperty("TooqingSizer")&&(i.TooqingSizer.hidden||(a=0===i.TooqingSizer.proportion||t&&!i.isTooqingSpace&&i.TooqingSizer.proportion>0?i.isTooqingSizer?Math.max(i.minHeight,i.childrenHeight):Object(r.GetDisplayHeight)(i):0,h+=a+=(o=i.TooqingSizer.padding).top+o.bottom));return h}},"./lib/ui/sizer/GetChildrenProportion.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenProportion(){for(var t,i,o=0,r=this.sizerChildren,a=0,h=r.length;a<h;a++)(t=r[a]).TooqingSizer.hidden||(i=t.TooqingSizer.proportion)>0&&(o+=i);return o}},"./lib/ui/sizer/GetChildrenSizers.js":function(t,i,o){"use strict";o.r(i);i.default=function GetChildrenSizers(t){void 0===t&&(t=[]);for(var i,o=this.sizerChildren,r=0,a=o.length;r<a;r++)(i=o[r]).isTooqingSizer&&t.push(i);return t}},"./lib/ui/sizer/GetChildrenWidth.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function GetChildrenWidth(t){if(this.TooqingSizer.hidden)return 0;void 0===t&&(t=!0);var i,o,a,h=0,l=this.sizerChildren;if(0===this.orientation)for(var c=0,u=l.length;c<u;c++)(i=l[c]).TooqingSizer.hidden||(a=0===i.TooqingSizer.proportion||t&&!i.isTooqingSpace&&i.TooqingSizer.proportion>0?i.isTooqingSizer?Math.max(i.minWidth,i.childrenWidth):Object(r.GetDisplayWidth)(i):0,h+=a+=(o=i.TooqingSizer.padding).left+o.right);else for(c=0,u=l.length;c<u;c++)(i=l[c]).hasOwnProperty("TooqingSizer")&&(i.TooqingSizer.hidden||(a=i.isTooqingSizer?Math.max(i.minWidth,i.childrenWidth):Object(r.GetDisplayWidth)(i),a+=(o=i.TooqingSizer.padding).left+o.right,h=Math.max(a,h)));return h}},"./lib/ui/sizer/GetExpandedChildHeight.js":function(t,i,o){"use strict";o.r(i);i.default=function GetExpandedChildHeight(t,i){var o,r=i.TooqingSizer,a=r.padding;return 0===t.orientation?r.expand&&(o=t.height-a.top-a.bottom):r.proportion>0&&t.proportionLength>0&&(o=r.proportion*t.proportionLength),o}},"./lib/ui/sizer/GetExpandedChildWidth.js":function(t,i,o){"use strict";o.r(i);i.default=function GetExpandedChildWidth(t,i){var o,r=i.TooqingSizer,a=r.padding;return 0===t.orientation?r.proportion>0&&t.proportionLength>0&&(o=r.proportion*t.proportionLength):r.expand&&(o=t.width-a.left-a.right),o}},"./lib/ui/sizer/Layout.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/GetExpandedChildWidth.js"),a=o("./lib/ui/sizer/GetExpandedChildHeight.js"),h=o("./lib/plugins/utils/size/ResizeGameObject.js"),l=o("./lib/plugins/utils/actions/GlobZone.js"),c=o("./lib/plugins/utils/align/align/in/QuickSet.js"),u=o("./lib/plugins/utils/size/GetDisplaySize.js");i.default=function Layout(t,i,o){if(this.TooqingSizer.hidden)return this;var p;if(this.preLayout(t),void 0===i&&(i=Math.max(this.childrenWidth,this.minWidth)),void 0===o&&(o=Math.max(this.childrenHeight,this.minHeight)),this.resize(i,o),this.childrenProportion>0){var d=0===this.orientation?this.width-this.childrenWidth:this.height-this.childrenHeight;p=d>0?(d=0===this.orientation?this.width-this.getChildrenWidth(!1):this.height-this.getChildrenHeight(!1))/this.childrenProportion:0}else p=0;this.proportionLength=p;for(var m,y,g,_,v,b,P,w,S,C=this.sizerChildren,T=this.left,k=this.top,O=0,I=C.length;O<I;O++)(m=C[O]).TooqingSizer.hidden||(g=(y=m.TooqingSizer).padding,w=Object(r.default)(this,m),S=Object(a.default)(this,m),m.isTooqingSizer?m.layout(this,w,S):Object(h.default)(m,w,S),void 0===w&&(w=Object(u.GetDisplayWidth)(m)),void 0===S&&(S=Object(u.GetDisplayHeight)(m)),0===this.orientation?(_=T+g.left,b=0===y.proportion||0===p?w:y.proportion*p,v=k+g.top,P=this.height-g.top-g.bottom):(_=T+g.left,b=this.width-g.left-g.right,v=k+g.top,P=0===y.proportion||0===p?S:y.proportion*p),l.default.setPosition(_,v).setSize(b,P),Object(c.default)(m,l.default,y.align),this.resetChildPositionState(m),0===this.orientation?T+=b+g.left+g.right:k+=P+g.top+g.bottom);return this.layoutBackgrounds(),this.postLayout()}},"./lib/ui/sizer/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/GetChildrenWidth.js"),a=o("./lib/ui/sizer/GetChildrenHeight.js"),h=o("./lib/ui/sizer/GetChildrenProportion.js"),l=o("./lib/ui/sizer/GetChildrenSizers.js"),c=o("./lib/ui/sizer/Layout.js"),u=o("./lib/ui/sizer/_layoutInit.js");i.default={getChildrenWidth:r.default,getChildrenHeight:a.default,getChildrenProportion:h.default,getChildrenSizers:l.default,layout:c.default,_layoutInit:u.default}},"./lib/ui/sizer/Sizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/basesizer/BaseSizer.js"),a=o("./lib/ui/sizer/Methods.js"),h=o("./lib/ui/utils/GetBoundsConfig.js"),l=o("./lib/ui/utils/OrientationConst.js"),c=o("./lib/ui/utils/AlignConst.js"),u=o("./lib/ui/utils/Space.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=Phaser.Utils.Objects.IsPlainObject,d=Phaser.Utils.Objects.GetValue,m=Phaser.Utils.Array.Remove,y=Phaser.Display.Align.CENTER,g=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Sizer,t);var i=_createSuper(Sizer);function Sizer(t,o,r,a,h,l,c){var u;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Sizer),p(o)?(o=d(c=o,"x",0),r=d(c,"y",0),a=d(c,"width",void 0),h=d(c,"height",void 0)):p(a)?(a=d(c=a,"width",void 0),h=d(c,"height",void 0)):p(l)&&(c=l),void 0!==c&&(l=d(c,"orientation",0)),void 0===l&&(l=0),(u=i.call(this,t,o,r,a,h,c)).type="rexSizer",u.sizerChildren=[],u.setOrientation(l),u}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Sizer,[{key:"destroy",value:function destroy(t){this.scene&&(this.sizerChildren.length=0,_get(_getPrototypeOf(Sizer.prototype),"destroy",this).call(this,t))}},{key:"setOrientation",value:function setOrientation(t){return"string"==typeof t&&(t=l.default[t]),this.orientation=t,this}},{key:"add",value:function add(t,i,o,r,a,l){_get(_getPrototypeOf(Sizer.prototype),"add",this).call(this,t);var u=_typeof(i);if(null===i)return this;if("number"===u);else if("string"===u)i=_[i];else if(p(i)){var m;i=d(m=i,"proportion",0),o=d(m,"align",y),r=d(m,"padding",0),a=d(m,"expand",!1),l=d(m,"key",void 0)}return"string"==typeof o&&(o=c.default[o]),void 0===i&&(i=0),void 0===o&&(o=y),void 0===r&&(r=0),void 0===a&&(a=!1),(m=this.getSizerConfig(t)).parent=this,m.proportion=i,m.align=o,m.padding=Object(h.default)(r),m.expand=a,this.sizerChildren.push(t),void 0!==l&&this.addChildrenMap(l,t),this}},{key:"addSpace",value:function addSpace(t){return void 0===t&&(t=1),this.add(Object(u.default)(this.scene),t),this}},{key:"insert",value:function insert(t,i,o,r,a,h){return this.add(i,o,r,a,h),this.moveTo(i,t),this}},{key:"remove",value:function remove(t){var i=this.getSizerConfig(t);return i.parent!==this||(i.parent=void 0,m(this.sizerChildren,t),_get(_getPrototypeOf(Sizer.prototype),"remove",this).call(this,t)),this}},{key:"clear",value:function clear(t){for(var i=0,o=this.sizerChildren.length;i<o;i++)this.getSizerConfig(this.sizerChildren[i]).parent=void 0;return this.sizerChildren.length=0,_get(_getPrototypeOf(Sizer.prototype),"clear",this).call(this,t),this}},{key:"childrenProportion",get:function get(){return void 0===this._childrenProportion&&(this._childrenProportion=this.getChildrenProportion()),this._childrenProportion}}]),Sizer}(r.default);Object.assign(g.prototype,a.default);var _={min:0,full:-1};i.default=g},"./lib/ui/sizer/_layoutInit.js":function(t,i,o){"use strict";o.r(i);i.default=function LayoutInitChild(){this._childrenWidth=void 0,this._childrenHeight=void 0,this._childrenProportion=void 0}},"./lib/ui/slider/GameSlider.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/slider/Slider.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var h=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(GameSlider,Phaser.GameObjects.Container);var i=_createSuper(GameSlider);function GameSlider(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,GameSlider),r=i.call(this,t,o.x,o.y),o.x=0,o.y=0,r.slider=new a.default(t,o),r.add(r.slider);var h=r.slider.children;return r.add(h.getChildren()),r.slider.layout(_assertThisInitialized(r),o.width,o.height),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(GameSlider,[{key:"setEnable",value:function setEnable(t){this.slider.setEnable(t)}},{key:"setGap",value:function setGap(t){this.slider.setGap(t)}},{key:"setValue",value:function setValue(t,i,o){this.slider.setValue(t,i,o)}},{key:"addValue",value:function addValue(t,i,o){this.slider.addValue(t,i,o)}},{key:"getValue",value:function getValue(t,i){return this.slider.getValue(t,i)}},{key:"layout",value:function layout(t,i,o){this.slider.layout(t,i,o)}}]),GameSlider}();o.default=h},"./lib/ui/slider/GetEndPoint.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/slider/GetThumbAlignPoint.js"),a=Phaser.Display.Align.RIGHT_CENTER,h=Phaser.Display.Align.BOTTOM_CENTER,l={};i.default=function GetEndoint(t){if(void 0===t&&(t=l),this.childrenMap.thumb){var i=1===this.orientation?a:h;r.default.call(this,i,t)}else 0===this.orientation?(t.x=this.centerX,t.y=this.bottom-1):(t.x=this.right-1,t.y=this.centerY);return t}},"./lib/ui/slider/GetStartPoint.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/slider/GetThumbAlignPoint.js"),a=Phaser.Display.Align.LEFT_CENTER,h=Phaser.Display.Align.TOP_CENTER,l={};i.default=function GetStartPoint(t){if(void 0===t&&(t=l),this.childrenMap.thumb){var i=0===this.orientation?h:a;r.default.call(this,i,t)}else 0===this.orientation?(t.x=this.centerX,t.y=this.top+1):(t.x=this.left+1,t.y=this.centerY);return t}},"./lib/ui/slider/GetThumbAlignPoint.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/align/align/in/QuickSet.js"),a={};i.default=function GetThumbAlignPoint(t,i){void 0===i&&(i=a);var o=this.childrenMap.thumb,h=o.x,l=o.y;return Object(r.default)(o,this,t),i.x=o.x,i.y=o.y,o.x=h,o.y=l,i}},"./lib/ui/slider/OnDragThumb.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/slider/PositionToPercent.js"),a={};i.default=function OnDragThumb(t,i,o){this.enable&&(a.x=i,a.y=o,this.value=Object(r.default)(this.getStartPoint(),this.getEndPoint(),a))}},"./lib/ui/slider/OnTouchTrack.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/slider/PositionToPercent.js"),a={};i.default=function OnTouchTrack(t,i,o){this.enable&&t.isDown&&(a.x=t.worldX,a.y=t.worldY,this.value=Object(r.default)(this.getStartPoint(),this.getEndPoint(),a))}},"./lib/ui/slider/PercentToPosition.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Math.Linear,a={};i.default=function PercentToPosition(t,i,o,h){return void 0===h&&(h=a),h.x=r(i.x,o.x,t),h.y=r(i.y,o.y,t),h}},"./lib/ui/slider/PositionToPercent.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Math.Percent;i.default=function PositionToPercent(t,i,o){var a,h,l;return t.y===i.y?(a=Math.min(t.x,i.x),h=Math.max(t.x,i.x),l=r(o.x,a,h)):t.x===i.x&&(a=Math.min(t.y,i.y),h=Math.max(t.y,i.y),l=r(o.y,a,h)),l}},"./lib/ui/slider/Slider.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/Sizer.js"),a=o("./lib/ui/slider/OnDragThumb.js"),h=o("./lib/ui/slider/OnTouchTrack.js"),l=o("./lib/ui/slider/GetStartPoint.js"),c=o("./lib/ui/slider/GetEndPoint.js"),u=o("./lib/ui/slider/UpdateThumb.js"),p=o("./lib/ui/slider/UpdateIndicator.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=Phaser.Utils.Objects.GetValue,m=Phaser.Math.Clamp,y=Phaser.Math.Linear,g=Phaser.Math.Percent,_=Phaser.Math.Snap.To,v=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Slider,t);var i=_createSuper(Slider);function Slider(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Slider),(r=i.call(this,t,o)).type="TooqingSlider",r.eventEmitter=d(o,"eventEmitter",_assertThisInitialized(r));var l=d(o,"background",void 0),c=d(o,"track",void 0),u=d(o,"indicator",void 0),p=d(o,"thumb",void 0),m=d(o,"space.left",0),y=d(o,"space.right",0),g=d(o,"space.top",0),_=d(o,"space.bottom",0);d(o,"min",0),d(o,"max",100);if(l&&r.addBackground(l),c){var v={left:m,right:y,top:g,bottom:_};r.add(c,0,void 0,v,!0)}u&&r.add(u,null),p&&r.add(p,null);var P=d(o,"input",0);switch("string"==typeof P&&(P=b[P]),P){case 0:p&&(p.setInteractive(),r.scene.input.setDraggable(p),p.on("drag",a.default,_assertThisInitialized(r)));break;case 1:r.setInteractive().on("pointerdown",h.default,_assertThisInitialized(r)).on("pointermove",h.default,_assertThisInitialized(r))}r.addChildrenMap("background",l),r.addChildrenMap("track",c),r.addChildrenMap("indicator",u),r.addChildrenMap("thumb",p),r.calValueFunc=d(o,"calValueFunc",void 0);var w=d(o,"valuechangeCallback",null);if(null!==w){var S=d(o,"valuechangeCallbackScope",void 0);r.eventEmitter.on("valuechange",w,S)}return r.setEnable(d(o,"enable",void 0)),r.setGap(d(o,"gap",void 0)),r.setValue(d(o,"value",0)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Slider,[{key:"setEnable",value:function setEnable(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"setGap",value:function setGap(t){return this.gap=t,this}},{key:"setValue",value:function setValue(t,i,o){return null==t||(void 0!==i&&(t=g(t,i,o)),this.value=t),this}},{key:"addValue",value:function addValue(t,i,o){return void 0!==i&&(t=g(t,i,o)),this.value+=t,this}},{key:"getValue",value:function getValue(t,i){var o=this.value;return void 0!==t&&(o=void 0===this.calValueFunc?y(t,i,o):this.calValueFunc(t,i,o)),o}},{key:"layout",value:function layout(t,i,o){return _get(_getPrototypeOf(Slider.prototype),"layout",this).call(this,t,i,o),this.updateThumb(),this.updateIndicator(),this}},{key:"value",get:function get(){return this._value},set:function set(t){void 0!==this.gap&&(t=_(t,this.gap));var i=this._value;this._value=m(t,0,1),i!==this._value&&(this.updateThumb(this._value),this.updateIndicator(this._value),this.eventEmitter.emit("valuechange",this._value,i,this.eventEmitter))}}]),Slider}(r.default),b={drag:0,click:1,none:-1},P={getStartPoint:l.default,getEndPoint:c.default,updateThumb:u.default,updateIndicator:p.default};Object.assign(v.prototype,P),i.default=v},"./lib/ui/slider/UpdateIndicator.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/size/ResizeGameObject.js"),a=o("./lib/plugins/utils/align/align/in/QuickSet.js"),h=o("./lib/plugins/utils/size/GetDisplaySize.js"),l=Phaser.Display.Align.LEFT_CENTER,c=Phaser.Display.Align.TOP_CENTER;i.default=function UpdateIndicator(t){var i,o,u=this.childrenMap.indicator;if(void 0===u)return this;void 0===t&&(t=this.value);var p=this.childrenMap.thumb;if(p)if(0===this.orientation){var d=Object(h.GetDisplayHeight)(p);o=p.y-d*p.originY+d-this.top}else{var m=Object(h.GetDisplayWidth)(p);i=p.x-m*p.originX+m-this.left}else 0===this.orientation?o=this.height*t:i=this.width*t;Object(r.default)(u,i,o);var y=1===this.orientation?l:c;Object(a.default)(u,this,y),this.resetChildPositionState(u)}},"./lib/ui/slider/UpdateThumb.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/slider/PercentToPosition.js");i.default=function UpdateThumb(t){var i=this.childrenMap.thumb;return void 0===i||(void 0===t&&(t=this.value),Object(r.default)(t,this.getStartPoint(),this.getEndPoint(),i),this.resetChildPositionState(i)),this}},"./lib/ui/swipe/Swipe.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/swipe/Swipe.js");i.default=r.default},"./lib/ui/tab/NinePatchTabButton.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/ninepatch/NineSlicePatch.js"),h=r("./lib/ui/tab/TabButton.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(NinePatchTabButton,t);var i=_createSuper(NinePatchTabButton);function NinePatchTabButton(t,o,r,a,h,l,c,u,p,d,m){var y;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,NinePatchTabButton),(y=i.call(this,t,a,h,l,c,{},p,d,{width:o,height:r,configlist:u})).mKey,y.btnData,y.mBackground,y.mBackground.setConfig(u[0]),y.dpr=p||1,y.scale=d||1,y.setSize(o,r),m&&(y.btnData=m),y.changeNormal(),y.enable=!0,y}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(NinePatchTabButton,[{key:"changeNormal",value:function changeNormal(){this.setBgFrame(this.mFrame)}},{key:"changeDown",value:function changeDown(){this.mDownFrame&&this.setBgFrame(this.mDownFrame)}},{key:"setSize",value:function setSize(t,i){return _get(_getPrototypeOf(NinePatchTabButton.prototype),"setSize",this).call(this,t,i),this.mBackground.setSize(t,i),this}},{key:"getBtnData",value:function getBtnData(){return this.btnData}},{key:"createBackground",value:function createBackground(){var t=this.ninePatchConfig.configlist[0],i=this.ninePatchConfig.width,o=this.ninePatchConfig.height;this.mBackground=new a.default(this.scene,0,0,i,o,this.mKey,this.mFrame,{left:t.left,top:t.top,right:t.right,bottom:t.bottom},this.dpr,1),this.add(this.mBackground)}},{key:"setBgFrame",value:function setBgFrame(t){this.mBackground.setFrame(t)}},{key:"enable",set:function set(t){t?(this.mBackground.clearTint(),this.setInteractive()):(this.mBackground.setTintFill(6710886),this.removeInteractive())}}]),NinePatchTabButton}(h.default);o.default=l},"./lib/ui/tab/TabButton.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/interface/event/ClickEvent.js"),h=r("./lib/ui/button/Button.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=0,c=2,u=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(TabButton,t);var i=_createSuper(TabButton);function TabButton(t,o,r,a,h,l,c,u,p){var d;return function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TabButton),(d=i.call(this,t,o,r,a,h,l,c,u,p)).mSelected=!1,d}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TabButton,[{key:"destroy",value:function destroy(){this.selected=!1,_get(_getPrototypeOf(TabButton.prototype),"destroy",this).call(this)}},{key:"onPointerUpHandler",value:function onPointerUpHandler(t){if(this.interactiveBoo){var i=this.checkPointerInBounds(this,t.downX,t.downY);this.emit(a.default.Up,this),i&&(this.soundGroup&&this.soundGroup.up&&this.playSound(this.soundGroup.up),this.emit(a.default.Tap,t,this),this.selected=!0),clearTimeout(this.mPressDelay),this.mIsMove=!1,this.mDownTime=0}else this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"onPointerDownHandler",value:function onPointerDownHandler(t){var i=this;this.interactiveBoo?(this.soundGroup&&this.soundGroup.down&&this.playSound(this.soundGroup.down),this.mDownTime=Date.now(),this.mPressTime=setTimeout((function(){i.emit(a.default.Hold,i)}),this.mPressTime),this.emit(a.default.Down,this)):this.soundGroup&&this.soundGroup.disabled&&this.playSound(this.soundGroup.disabled)}},{key:"selected",set:function set(t){this.mSelected=t;var i=t?c:l;this.buttonStateChange(i),this.emit("selectChange",t)},get:function get(){return this.mSelected}}]),TabButton}(h.Button);o.default=u},"./lib/ui/tagtext/TagText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/gameobjects/text/tagtext/TagText.js");i.default=r.default},"./lib/ui/tap/Tap.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/input/gestures/tap/Tap.js");i.default=r.default},"./lib/ui/textBox/TextBox.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/plugins/bbcodetext.js"),h=r("./lib/plugins/behaviors/textedit/TextEdit.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(TextBox,Phaser.Events.EventEmitter);var i=_createSuper(TextBox);function TextBox(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TextBox),r=i.call(this);var l=o.textConfig,c=l.x,u=l.y,p=o.editType,d=o.text||"",m=o.onTextChanged||void 0,y=o.onClose||void 0,g={type:p,text:d,onTextChanged:m},_={};return Object.assign(_,l),r.mBBCodeText=new a.default(t,c,u,d,_),r.mBBCodeText.setOrigin(.5,.5),r.mBBCodeText.setInteractive(),r.mBBCodeText.on("pointerdown",(function(){r.mTextEdit||(r.mTextEdit=new h.default(r.mBBCodeText),r.mTextEdit.open(g,y))}),_assertThisInitialized(r)),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TextBox,[{key:"close",value:function close(){this.mTextEdit&&(this.mTextEdit.close(),this.mTextEdit.destroy())}},{key:"destroy",value:function destroy(){this.close(),this.mBBCodeText&&this.mBBCodeText.destroy(),_get(_getPrototypeOf(TextBox.prototype),"destroy",this).call(this)}},{key:"isOpened",get:function get(){return!!this.mTextEdit&&this.mTextEdit.isOpened}},{key:"text",get:function get(){return this.mTextEdit?this.mTextEdit.text:""}},{key:"view",get:function get(){return this.mBBCodeText}}]),TextBox}();o.default=l},"./lib/ui/textarea/AppendText.js":function(t,i,o){"use strict";o.r(i);i.default=function AppendText(t){return this.setText(this.text+t),this}},"./lib/ui/textarea/InjectProperties.js":function(t,i,o){"use strict";o.r(i);i.default=function InjectProperties(t){Object.defineProperty(t,"childOY",{configurable:!0,get:function get(){return t.textOY},set:function set(i){t.textOY=i}}),Object.defineProperty(t,"topChildOY",{get:function get(){return t.topTextOY}}),Object.defineProperty(t,"bottomChildOY",{get:function get(){return t.bottomTextOY}})}},"./lib/ui/textarea/SetText.js":function(t,i,o){"use strict";o.r(i);i.default=function SetText(t){return this.childrenMap.child.setText(t),this.resizeController(),this}},"./lib/ui/textarea/TextArea.js":function(t,o,r){"use strict";r.r(o);var a=r("./lib/ui/textblock/TextBlock.js"),h=r("./lib/ui/textarea/InjectProperties.js"),l=r("./lib/ui/utils/scrollable/Scrollable.js"),c=r("./lib/ui/textarea/SetText.js"),u=r("./lib/ui/textarea/AppendText.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(i,"__esModule",{value:!0});var p=Phaser.Utils.Objects.GetValue,d=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(TextArea,t);var i=_createSuper(TextArea);function TextArea(t,o){var r;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TextArea),void 0===o&&(o={});var l=p(o,"text",void 0),c=p(o,"textWidth",void 0),u=p(o,"textHeight",void 0),d=p(o,"textMask",!0),m=p(o,"content",""),y=new a.default(t,{width:c,height:u,text:l,textMask:d,content:m,clamplTextOY:p(o,"clamplChildOY",!1)}),g=void 0===c?1:0,_=void 0===u;Object(h.default)(y),o.scrollMode=0,o.type="TooqingTextArea",o.child={gameObject:y,proportion:g,expand:_};var v=p(o,"space",void 0);return v&&(v.child=v.text),(r=i.call(this,t,o)).addChildrenMap("text",l),r}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TextArea,[{key:"text",get:function get(){return this.childrenMap.child.text}},{key:"linesCount",get:function get(){return this.childrenMap.child.linesCount}}]),TextArea}(l.default),m={setText:c.default,appendText:u.default};Object.assign(d.prototype,m),o.default=d},"./lib/ui/textblock/GetLines.js":function(t,i,o){"use strict";o.r(i);i.default=function GetLines(t){var i,o=t+this.textObject.style.maxLines;if(0===this.textObjectType)i=this.lines.slice(t,o).join("\n");else{var r=this.lines.getLineStartIndex(t),a=this.lines.getLineEndIndex(o-1);i=this.lines.getSliceTagText(r,a,!0)}return i}},"./lib/ui/textblock/Layout.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/textblock/ResizeText.js"),a=o("./lib/ui/textblock/ResetTextObjectPosition.js"),h=o("./lib/plugins/utils/actions/GlobZone.js"),l=o("./lib/plugins/utils/align/align/in/QuickSet.js");i.default=function Layout(t,i,o){if(this.TooqingSizer.hidden)return this;var c,u,p;this.preLayout(t),void 0===i&&(i=this.minWidth),void 0===o&&(o=this.minHeight),this.resize(i,o);var d,m,y,g,_=this.left,v=this.top;return(c=this.textObject).TooqingSizer.hidden||(d=_+(p=(u=c.TooqingSizer).padding).left,m=v+p.top,y=this.width-p.left-p.right,g=this.height-p.top-p.bottom,r.default.call(this,c,y,g),h.default.setPosition(d,m).setSize(y,g),Object(l.default)(c,h.default,u.align),u.preOffsetY=0,a.default.call(this),this.textMask&&(this.textMask.setPosition().resize(),this.resetChildPositionState(this.textMask))),this.layoutBackgrounds(),this.postLayout()}},"./lib/ui/textblock/LinesCountToTextHeight.js":function(t,i,o){"use strict";o.r(i);i.default=function LinesCountToTextHeight(t){return t*(this.textLineHeight+this.textLineSpacing)-this.textLineSpacing}},"./lib/ui/textblock/Methods.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/textblock/SetTextObject.js"),a=o("./lib/ui/textblock/SetText.js"),h=o("./lib/ui/textblock/UpdateTextObject.js"),l=o("./lib/ui/textblock/Layout.js");i.default={setTextObject:r.default,setText:a.default,updateTextObject:h.default,layout:l.default}},"./lib/ui/textblock/ResetTextObjectPosition.js":function(t,i,o){"use strict";o.r(i);i.default=function ResetTextObjectPosition(){var t=this.textObject.TooqingSizer;this.textObject.y+=t.offsetY-t.preOffsetY,t.preOffsetY=t.offsetY,this.resetChildPositionState(this.textObject)}},"./lib/ui/textblock/ResizeText.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/textblock/TextHeightToLinesCount.js");i.default=function ResizeText(t,i,o){if(o+=this.textLineHeight+this.textLineSpacing,t.width!==i||t.height!==o){t.setFixedSize(i,o);var a=t.style,h=Math.max(i,0),l=Math.ceil(r.default.call(this,o))+1;0===this.textObjectType?(a.wordWrapWidth=h,a.maxLines=l):(a.wrapWidth=h,a.maxLines=l),this.setText()}}},"./lib/ui/textblock/SetText.js":function(t,i,o){"use strict";o.r(i);i.default=function SetText(t){return void 0!==t&&(this.text=t),0===this.textObjectType?this.lines=this.textObject.getWrappedText(this.text):this.lines=this.textObject.getPenManager(this.text,this.lines),this.updateTextObject(),this}},"./lib/ui/textblock/SetTextObject.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetBoundsConfig.js"),a=o("./lib/plugins/utils/text/IsTextGameObject.js"),h=o("./lib/plugins/utils/mask/DefaultMask.js"),l=Phaser.Display.Align.TOP_LEFT;i.default=function SetTextObject(t,i){void 0===i&&(i=!0),this.add(t);var o=this.getSizerConfig(t);return o.parent=this,o.align=l,o.padding=Object(r.default)(0),o.expand=!0,this.textObject=t,this.textObjectType=Object(a.default)(t)?0:1,o.preOffsetY=0,o.offsetY=0,i&&(this.textMask=new h.default(this),this.textObject.setMask(this.textMask.createGeometryMask()),this.pin(this.textMask)),this}},"./lib/ui/textblock/TextBlock.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/basesizer/BaseSizer.js"),a=o("./lib/ui/textblock/Methods.js"),h=o("./lib/ui/textblock/LinesCountToTextHeight.js"),l=o("./lib/ui/textblock/TextHeightToLinesCount.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=Phaser.Utils.Objects.IsPlainObject,u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(TextBlock,t);var i=_createSuper(TextBlock);function TextBlock(t,o,r,a,h,l){var p;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,TextBlock),c(o)?(o=u(l=o,"x",0),r=u(l,"y",0),a=u(l,"width",void 0),h=u(l,"height",void 0)):c(a)&&(a=u(l=a,"width",void 0),h=u(l,"height",void 0)),(p=i.call(this,t,o,r,a,h,l)).type="TooqingTextBlock",p.textObject=void 0,p.textMask=void 0,p.textObjectType=void 0,p.lines=void 0,p.text=u(l,"content",""),p._textOY=0,p.execeedTopState=!1,p.execeedBottomState=!1,p.setClampMode(u(l,"clamplTextOY",!0));var m=u(l,"background",void 0),y=u(l,"text",void 0);void 0===y&&(y=d(t));var g=u(l,"textMask",!0);return m&&p.addBackground(m),p.setTextObject(y,g),p.addChildrenMap("background",m),p.addChildrenMap("text",y),p}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(TextBlock,[{key:"destroy",value:function destroy(t){this.scene&&(this.textObject=void 0,this.textMask=void 0,void 0===this.lines||(0===this.textObjectType?this.lines.length=0:this.lines.destroy()),_get(_getPrototypeOf(TextBlock.prototype),"destroy",this).call(this,t))}},{key:"setClampMode",value:function setClampMode(t){return this.clampTextOYMode=t,this}},{key:"textOYExceedTop",value:function textOYExceedTop(t){return void 0===t&&(t=this.textOY),t>this.topTextOY}},{key:"textOYExeceedBottom",value:function textOYExeceedBottom(t){return void 0===t&&(t=this.textOY),t<this.bottomTextOY}},{key:"setTextOY",value:function setTextOY(t){return this.textOY=t,this}},{key:"setTextOYByPercentage",value:function setTextOYByPercentage(t){return this.t=t,this}},{key:"textLineHeight",get:function get(){var t=this.textObject.style;return t.metrics.fontSize+t.strokeThickness}},{key:"textLineSpacing",get:function get(){return this.textObject.lineSpacing}},{key:"linesCount",get:function get(){return void 0===this.lines?0:0===this.textObjectType?this.lines.length:this.lines.linesCount}},{key:"visibleLinesCount",get:function get(){return Math.floor(l.default.call(this,this.textObject.height))}},{key:"topTextOY",get:function get(){return 0}},{key:"bottomTextOY",get:function get(){return-this.textVisibleHeight}},{key:"textHeight",get:function get(){return h.default.call(this,this.linesCount)}},{key:"textObjectHeight",get:function get(){return this.textObject.height-this.textLineHeight-this.textLineSpacing}},{key:"textVisibleHeight",get:function get(){var t=this.textHeight,i=this.textObjectHeight;return t>i?t-i:0}},{key:"textOY",get:function get(){return this._textOY},set:function set(t){var i=this.topTextOY,o=this.bottomTextOY,r=this.textOYExceedTop(t),a=this.textOYExeceedBottom(t);this.clampTextOYMode&&(this.visibleLinesCount>this.linesCount?t=0:r?t=i:a&&(t=o)),this._textOY!==t&&(this._textOY=t,this.updateTextObject()),r&&(this.execeedTopState||this.emit("execeedtop",this,t,i)),this.execeedTopState=r,a&&(this.execeedBottomState||this.emit("execeedbottom",this,t,o)),this.execeedBottomState=a}},{key:"t",set:function set(t){this.textOY=-this.textVisibleHeight*t},get:function get(){var t=this.textVisibleHeight;return 0===t?0:this.textOY/-t}}]),TextBlock}(r.default),d=function createDefaultTextObject(t){return t.add.text(0,0,"")};Object.assign(p.prototype,a.default),i.default=p},"./lib/ui/textblock/TextHeightToLinesCount.js":function(t,i,o){"use strict";o.r(i);i.default=function TextHeightToLinesCount(t){return(t-this.textLineSpacing)/(this.textLineHeight+this.textLineSpacing)}},"./lib/ui/textblock/UpdateTextObject.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/textblock/TextHeightToLinesCount.js"),a=o("./lib/ui/textblock/LinesCountToTextHeight.js"),h=o("./lib/ui/textblock/GetLines.js"),l=o("./lib/ui/textblock/ResetTextObjectPosition.js");i.default=function UpdateTextObject(){var t=Math.max(Math.floor(r.default.call(this,-this.textOY)),0),i=a.default.call(this,t)+this.textOY;return this.textObject.setText(h.default.call(this,t)),this.textObject.TooqingSizer.offsetY=i,l.default.call(this),this}},"./lib/ui/tool/Tool.js":function(t,o,r){"use strict";function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r.r(o),r.d(o,"Tool",(function(){return h})),Object.defineProperty(i,"__esModule",{value:!0});var a=Phaser.Utils.Objects.GetValue,h=function(){function Tool(){!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Tool)}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Tool,null,[{key:"checkPointerContains",value:function checkPointerContains(t,i){var o=-t.width/2,r=t.width/2,a=-t.height/2,h=t.height/2;if(i){var l=t.getWorldTransformMatrix(),c=i.x-l.tx,u=i.y-l.ty;return o<=c&&r>=c&&a<=u&&h>=u}return!1}},{key:"getTransfrom",value:function getTransfrom(t){return t?t.transform:void 0}},{key:"getPos",value:function getPos(t){var i,o={x:0,y:0};if(!t)return o;var r=a(t,"width",0),h=a(t,"height",0);return void 0===t.x&&(t.x=0),void 0===t.y&&(t.y=0),"string"==typeof t.x?(i=a(t,"x","100%"),o.x=Number(i.split("%")[0])*r):o.x=a(t,"x",0),"string"==typeof t.y?(i=a(t,"y","100%"),o.y=Number(i.split("%")[0])*h):o.y=a(t,"y",0),o}},{key:"checkNinePatch",value:function checkNinePatch(t){return!!(t.top||t.bottom||t.right||t.left)}}]),Tool}()},"./lib/ui/ui-components.ts":function(t,i,o){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};const a=r(o("./lib/ui/roundrectangle/RoundRectangle.js")),h=r(o("./lib/ui/bbcodetext/BBCodeText.js")),l=r(o("./lib/ui/tagtext/TagText.js")),c=r(o("./lib/ui/container/Container.js")),u=r(o("./lib/ui/canvas/Canvas.js")),p=r(o("./lib/ui/ninepatch/NineSlicePatch.js")),d=r(o("./lib/ui/sizer/Sizer.js")),m=r(o("./lib/ui/gridsizer/GridSizer.js")),y=r(o("./lib/ui/label/Label.js")),g=r(o("./lib/ui/buttons/Buttons.js")),_=r(o("./lib/ui/slider/Slider.js")),v=r(o("./lib/ui/gridtable/GridTable.js")),b=r(o("./lib/ui/menu/Menu.js")),P=r(o("./lib/ui/textBox/TextBox.js")),w=r(o("./lib/ui/textblock/TextBlock.js")),S=r(o("./lib/ui/textarea/TextArea.js")),C=r(o("./lib/ui/scrollableblock/ScrollableBlock.js")),T=r(o("./lib/ui/scrollablepanel/ScrollablePanel.js")),k=r(o("./lib/ui/inputText/InputText.js")),O=r(o("./lib/ui/tap/Tap.js")),I=r(o("./lib/ui/press/Press.js")),M=r(o("./lib/ui/rotate/Rotate.js")),E=r(o("./lib/ui/flip/Flip.js")),x=r(o("./lib/ui/utils/GetParentSizer.js")),B=r(o("./lib/ui/utils/GetTopmostSizer.js")),R=r(o("./lib/plugins/utils/input/IsPointerInBounds.js")),D=o("./lib/ui/utils/Hide.js"),L=r(o("./lib/plugins/behaviors/textedit/Edit.js")),A=o("./lib/ui/utils/WaitEvent.js"),j=r(o("./lib/ui/baseUI/BaseUI.js")),H=o("./lib/ui/button/Button.js"),N=r(o("./lib/ui/button/NineSliceButton.js")),U=o("./lib/ui/combobox/Combobox.js"),G=r(o("./lib/ui/gridtable/GameGridTable.js")),z=o("./lib/ui/interface/ninepatch/NinePatchSkin.js"),V=r(o("./lib/ui/messageBox/MessageBox.js")),W=r(o("./lib/ui/ninepatch/NinePatch.js")),K=r(o("./lib/ui/panel/Panel.js")),q=o("./lib/ui/progressbar/ProgressBar.js"),Y=r(o("./lib/ui/scroller/GameScroller.js")),Q=r(o("./lib/ui/scroller/Scroller.js")),X=r(o("./lib/ui/tab/NinePatchTabButton.js")),J=r(o("./lib/ui/tab/TabButton.js")),Z=r(o("./lib/ui/textarea/SetText.js")),$=r(o("./lib/ui/textarea/AppendText.js")),tt=r(o("./lib/ui/interface/baseUI/UIType.js")),et=r(o("./lib/ui/slider/GameSlider.js")),it=r(o("./lib/ui/baseUI/BaseMediator.js")),nt=r(o("./lib/ui/checkbox/CheckBox.js")),ot=o("./lib/ui/tool/Tool.js"),rt=o("./lib/ui/interface/baseUI/Patches.config.js"),st=r(o("./lib/ui/interface/event/ClickEvent.js")),at=o("./lib/ui/interface/sound/ISoundConfig.js"),ht=r(o("./lib/ui/interface/sound/SoundField.js"));t.exports={SoundField:ht.default,ISoundConfig:at.ISoundConfig,AppendText:$.default,SetText:Z.default,ClickEvent:st.default,Patches_config:rt.Patches_config,Tool:ot.Tool,UIType:tt.default,BaseMediator:it.default,CheckBox:nt.default,InputText:k.default,RoundRectangle:a.default,BBCodeText:h.default,TagText:l.default,Container:c.default,Canvas:u.default,NineSlicePatch:p.default,Sizer:d.default,GridSizer:m.default,BaseUI:j.default,Button:H.Button,NineSliceButton:N.default,ComboBox:U.ComboBox,GameGridTable:G.default,NinePatchSkin:z.NinePatchSkin,MessageBox:V.default,NinePatch:W.default,Panel:K.default,ProgressBar:q.ProgressBar,GameScroller:Y.default,BaseScroller:Q.default,NinePatchTabButton:X.default,TabButton:J.default,Label:y.default,Buttons:g.default,Slider:_.default,GridTable:v.default,Menu:b.default,TextBlock:w.default,TextArea:S.default,ScrollableBlock:C.default,ScrollablePanel:T.default,Tap:O.default,Press:I.default,Rotate:M.default,Flip:E.default,GameSlider:et.default,GetParentSizer:x.default,GetTopmostSizer:B.default,IsPointerInBounds:R.default,Show:D.Show,Hide:D.Hide,IsShown:D.IsShown,Edit:L.default,WaitEvent:A.WaitEvent,WaitComplete:A.WaitComplete,TextBox:P.default}},"./lib/ui/utils/AddChildMask.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/mask/DefaultMask.js");i.default=function AddChildMask(t,i,o,a){var h=new r.default(i,o,a);return t&&!t.isTooqingSizer&&t.setMask(h.createGeometryMask()),this.pin(h),h}},"./lib/ui/utils/AlignConst.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Display.Align;i.default={center:r.CENTER,left:r.LEFT_CENTER,right:r.RIGHT_CENTER,top:r.TOP_CENTER,bottom:r.BOTTOM_CENTER,"left-top":r.TOP_LEFT,"left-center":r.LEFT_CENTER,"left-bottom":r.BOTTOM_LEFT,"center-top":r.TOP_CENTER,"center-center":r.CENTER,"center-bottom":r.BOTTOM_CENTER,"right-top":r.TOP_RIGHT,"right-center":r.RIGHT_CENTER,"right-bottom":r.BOTTOM_RIGHT}},"./lib/ui/utils/GetBoundsConfig.js":function(t,i,o){"use strict";o.r(i);var r=Phaser.Utils.Objects.GetValue;i.default=function GetBoundsConfig(t,i){return void 0===i&&(i={}),"number"==typeof t?(i.left=t,i.right=t,i.top=t,i.bottom=t):(i.left=r(t,"left",0),i.right=r(t,"right",0),i.top=r(t,"top",0),i.bottom=r(t,"bottom",0)),i}},"./lib/ui/utils/GetParentSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetSizerConfig.js");i.default=function GetParentSizer(t){return Object(r.default)(t).parent}},"./lib/ui/utils/GetScrollMode.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/ScrollModeConst.js"),a=Phaser.Utils.Objects.GetValue;i.default=function GetScrollMode(t,i){void 0===i&&(i="scrollMode");var o=a(t,"scrollMode",0);return"string"==typeof o&&(o=r.default[o]),o}},"./lib/ui/utils/GetSizerConfig.js":function(t,i,o){"use strict";o.r(i);i.default=function GetSizerConfig(t){return t.hasOwnProperty("TooqingSizer")||(t.TooqingSizer={}),t.TooqingSizer}},"./lib/ui/utils/GetTopmostSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetParentSizer.js");i.default=function GetTopmostSizer(t){for(var i=Object(r.default)(t);i;)t=i,i=Object(r.default)(i);return t}},"./lib/ui/utils/Hide.js":function(t,i,o){"use strict";o.r(i),o.d(i,"Show",(function(){return a})),o.d(i,"Hide",(function(){return h})),o.d(i,"IsShown",(function(){return l}));var r=o("./lib/ui/utils/GetSizerConfig.js"),a=function Show(t){c(t,!1)},h=function Hide(t){c(t,!0)},l=function IsShown(t){return!!t&&!Object(r.default)(t).hidden},c=function _hide(t,i){t&&(Object(r.default)(t).hidden=i,t.setVisible(!i))}},"./lib/ui/utils/OrientationConst.js":function(t,i,o){"use strict";o.r(i),i.default={x:0,h:0,horizontal:0,"left-to-right":0,y:1,v:1,vertical:1,"top-to-bottom":1}},"./lib/ui/utils/ScrollModeConst.js":function(t,i,o){"use strict";o.r(i),i.default={v:0,vertical:0,h:1,horizontal:1}},"./lib/ui/utils/Space.js":function(t,i,o){"use strict";o.r(i);i.default=function Space(t){var i=t.add.zone(0,0,1,1);return i.isTooqingSpace=!0,i}},"./lib/ui/utils/WaitEvent.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/plugins/utils/promise/WaitEvent.js");o.d(i,"WaitEvent",(function(){return r.WaitEvent})),o.d(i,"WaitComplete",(function(){return r.WaitComplete}))},"./lib/ui/utils/scrollable/CreateScrollableSizer.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/sizer/Sizer.js"),a=o("./lib/ui/utils/GetScrollMode.js"),h=o("./lib/ui/slider/Slider.js"),l=o("./lib/plugins/scroller.js"),c=Phaser.Utils.Objects.GetValue;i.default=function CreateScrollableSizer(t){var i,o,u=this.scene,p=Object(a.default)(t),d=new r.default(u,{orientation:p}),m=c(t,"child.gameObject",void 0),y=c(t,"slider",void 0),g=c(t,"scroller",!0);if(m){var _=c(t,"space.child",0);if(this.childPadding={},"number"!=typeof _){var v=_;0===p?(_=c(v,"right",0),this.childPadding.top=c(v,"top",0),this.childPadding.bottom=c(v,"bottom",0)):(_=c(v,"bottom",0),this.childPadding.top=c(v,"left",0),this.childPadding.bottom=c(v,"right",0))}else this.childPadding.top=0,this.childPadding.bottom=0;var b,P=c(t,"child.proportion",1),w=c(t,"child.expand",!0);b=0===p?{right:y?_:0}:{bottom:y?_:0},d.add(m,P,"center",b,w),y&&(!0===y&&(y={}),y.orientation=d.orientation,i=new h.default(u,y),d.add(i,0,"center",0,!0)),g&&(!0===g&&(g={}),g.orientation=p,o=new l.default(m,g))}return i&&i.on("valuechange",(function(t){this.t=t}),this),o&&o.on("valuechange",(function(t){this.childOY=t}),this),this.addChildrenMap("child",m),this.addChildrenMap("slider",i),this.addChildrenMap("scroller",o),d}},"./lib/ui/utils/scrollable/ResizeController.js":function(t,i,o){"use strict";o.r(i);i.default=function ResizeController(){var t=this.topChildOY,i=this.bottomChildOY,o=this.childrenMap.scroller,r=this.childrenMap.slider;return o&&o.setBounds(i,t),r&&r.setEnable(i!==t),this.updateController(),this}},"./lib/ui/utils/scrollable/Scrollable.js":function(t,i,o){"use strict";o.r(i);var r=o("./lib/ui/utils/GetScrollMode.js"),a=o("./lib/ui/utils/scrollable/CreateScrollableSizer.js"),h=o("./lib/ui/utils/scrollable/ResizeController.js"),l=o("./lib/ui/utils/scrollable/UpdateController.js"),c=o("./lib/ui/sizer/Sizer.js");function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,i){for(var o=0;o<i.length;o++){var r=i[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _get(t,i,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,i,o){var r=function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}(t,i);if(r){var a=Object.getOwnPropertyDescriptor(r,i);return a.get?a.get.call(o):a.value}})(t,i,o||t)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,i){return t.__proto__=i,t})(t,i)}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=_getPrototypeOf(t);if(i){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,i){return!i||"object"!==_typeof(i)&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=Phaser.Utils.Objects.GetValue,p=function(t){!function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}(Scrollable,t);var i=_createSuper(Scrollable);function Scrollable(t,o){var h;!function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,Scrollable),void 0===o&&(o={});var l=Object(r.default)(o);o.orientation=0===l?1:0,(h=i.call(this,t,o)).type=u(o,"type","TooqingScrollable");var c=u(o,"background",void 0),p=a.default.call(_assertThisInitialized(h),o),d=u(o,"header",void 0),m=u(o,"footer",void 0),y=u(o,"space.left",0),g=u(o,"space.right",0),_=u(o,"space.top",0),v=u(o,"space.bottom",0);if(c&&h.addBackground(c),d){var b=u(o,"align.header","center"),P=u(o,"space.header",0);S=0===l?{left:y,right:g,top:_,bottom:P}:{left:y,right:P,top:_,bottom:v};var w=u(o,"expand.header",!0);h.add(d,0,b,S,w)}p&&(S=0===l?{left:y,right:g,top:d?0:_,bottom:m?0:v}:{left:d?0:y,right:m?0:g,top:_,bottom:v},h.add(p,1,"center",S,!0));if(m){b=u(o,"align.footer","center");var S,C=u(o,"space.footer",0);S=0===l?{left:y,right:g,top:C,bottom:v}:{left:C,right:g,top:_,bottom:v};w=u(o,"expand.footer",!0);h.add(m,0,b,S,w)}return h.addChildrenMap("background",c),h.addChildrenMap("header",d),h.addChildrenMap("footer",m),h}return function _createClass(t,i,o){return i&&_defineProperties(t.prototype,i),o&&_defineProperties(t,o),t}(Scrollable,[{key:"layout",value:function layout(t,i,o){return _get(_getPrototypeOf(Scrollable.prototype),"layout",this).call(this,t,i,o),this.resizeController(),this}},{key:"setChildOY",value:function setChildOY(t){return this.childOY=t,this}},{key:"setT",value:function setT(t){return this.t=t,this}},{key:"scrollToTop",value:function scrollToTop(){return this.t=0,this}},{key:"scrollToBottom",value:function scrollToBottom(){return this.t=1,this}},{key:"setSliderEnable",value:function setSliderEnable(t){return void 0===t&&(t=!0),this.sliderEnable=t,this}},{key:"setScrollerEnable",value:function setScrollerEnable(t){return void 0===t&&(t=!0),this.scrollerEnable=t,this}},{key:"t",set:function set(t){var i=this.childPadding;if(0!==i.top||0!==i.bottom){var o=this.childrenMap.child,r=o.topChildOY-o.bottomChildOY;t=((r+i.top+i.bottom)*t-i.top)/r}this.childrenMap.child.t=t,this.updateController()},get:function get(){var t=this.childrenMap.child.t,i=this.childPadding;if(0!==i.top||0!==i.bottom){var o=this.childrenMap.child,r=o.topChildOY-o.bottomChildOY,a=r+i.top+i.bottom;t=(r*t+i.top)/a}return t}},{key:"childOY",set:function set(t){this.childrenMap.child.childOY=t,this.updateController()},get:function get(){return this.childrenMap.child.childOY}},{key:"topChildOY",get:function get(){return this.childrenMap.child.topChildOY+this.childPadding.top}},{key:"bottomChildOY",get:function get(){return this.childrenMap.child.bottomChildOY-this.childPadding.bottom}},{key:"sliderEnable",get:function get(){var t=this.childrenMap.slider;if(t)return t.enable},set:function set(t){var i=this.childrenMap.slider;i&&i.setEnable(t)}},{key:"scrollerEnable",get:function get(){var t=this.childrenMap.scroller;if(t)return t.enable},set:function set(t){var i=this.childrenMap.scroller;i&&i.setEnable(t)}}]),Scrollable}(c.default),d={resizeController:h.default,updateController:l.default};Object.assign(p.prototype,d),i.default=p},"./lib/ui/utils/scrollable/UpdateController.js":function(t,i,o){"use strict";o.r(i);i.default=function UpdateController(){var t=this.childrenMap.scroller,i=this.childrenMap.slider;t&&t.setValue(this.childOY),i&&i.setValue(this.t)}}})}))},,function(t,i,o){"use strict";o.d(i,"i",(function(){return l})),o.d(i,"g",(function(){return c})),o.d(i,"b",(function(){return u})),o.d(i,"c",(function(){return p})),o.d(i,"j",(function(){return d})),o.d(i,"e",(function(){return m})),o.d(i,"a",(function(){return y})),o.d(i,"d",(function(){return g})),o.d(i,"h",(function(){return _})),o.d(i,"f",(function(){return v}));var r=/^(http|https):/i,a=o(2),h=o(114),l=function(){function Url(){}return Url.getRes=function(t){return Object({debug:!0,api_root:"https://api-dev.tooqing.com/",osd:"https://osd-alpha.tooqing.com/",gateway:Object({host:"gdev.tooqing.com",port:11100,secure:!0}),game_id:"5cd8cf04cbcbf91a0afc3f96.5e410ba50681ad5557b4d6e9",virtual_world_id:"0"}).BUNDLE_RESOURCES_ROOT?Object({debug:!0,api_root:"https://api-dev.tooqing.com/",osd:"https://osd-alpha.tooqing.com/",gateway:Object({host:"gdev.tooqing.com",port:11100,secure:!0}),game_id:"5cd8cf04cbcbf91a0afc3f96.5e410ba50681ad5557b4d6e9",virtual_world_id:"0"}).BUNDLE_RESOURCES_ROOT+t:Url.RES_PATH+t},Url.getUIRes=function(t,i){return Object({debug:!0,api_root:"https://api-dev.tooqing.com/",osd:"https://osd-alpha.tooqing.com/",gateway:Object({host:"gdev.tooqing.com",port:11100,secure:!0}),game_id:"5cd8cf04cbcbf91a0afc3f96.5e410ba50681ad5557b4d6e9",virtual_world_id:"0"}).BUNDLE_RESOURCES_ROOT?Object({debug:!0,api_root:"https://api-dev.tooqing.com/",osd:"https://osd-alpha.tooqing.com/",gateway:Object({host:"gdev.tooqing.com",port:11100,secure:!0}),game_id:"5cd8cf04cbcbf91a0afc3f96.5e410ba50681ad5557b4d6e9",virtual_world_id:"0"}).BUNDLE_RESOURCES_ROOT+t+"x"+i:Url.RESUI_PATH+(t+"x/")+i},Url.getOsdRes=function(t){return Url.OSD_PATH?r.test(Url.OSD_PATH)?Url.OSD_PATH+t:"https://osd-alpha.tooqing.com/"+t:t},Url.OSD_PATH="",Url.RES_PATH="",Url.RESUI_PATH="",Url}(),c=function(){function ResUtils(){}return ResUtils.getPartName=function(t){return t+"_png"},ResUtils.getPartUrl=function(t){return r.test(l.OSD_PATH)?l.OSD_PATH+"avatar/part/"+t+".png":"https://osd-alpha.tooqing.com/avatar/part/"+t+".png"},ResUtils.getGameConfig=function(t){return r.test(t)?t:l.OSD_PATH+t},ResUtils}(),u=function(){function BlackButton(){}return BlackButton.getName=function(){return"black_button"},BlackButton.getPNG=function(){return l.getRes("ui/common/button.png")},BlackButton.getColumns=function(){return[4,2,4]},BlackButton.getRows=function(){return[4,2,4]},BlackButton.getConfig=function(){return{top:4,left:4,right:4,bottom:4}},BlackButton}(),p=function(){function BlueButton(){}return BlueButton.getName=function(){return"button_blue"},BlueButton.getPNG=function(){return l.getRes("ui/common/button_blue.png")},BlueButton.getJSON=function(){return l.getRes("ui/common/button_blue.json")},BlueButton.getColumns=function(){return[7,1,7]},BlueButton.getRows=function(){return[7,1,7]},BlueButton.getConfig=function(){return{left:7,top:7,right:7,bottom:7}},BlueButton}(),d=function(){function WhiteButton(){}return WhiteButton.getName=function(){return"button_white"},WhiteButton.getPNG=function(){return l.getRes("ui/common/button_white.png")},WhiteButton.getJSON=function(){return l.getRes("ui/common/button_white.json")},WhiteButton.getColumns=function(){return[7,1,7]},WhiteButton.getRows=function(){return[7,1,7]},WhiteButton.getConfig=function(){return{left:7,top:7,right:7,bottom:7}},WhiteButton}(),m=function(){function CloseButton(){}return CloseButton.getName=function(){return"common_clsBtn"},CloseButton.getPNG=function(){return l.getRes("ui/common/common_clsBtn.png")},CloseButton.getJSON=function(){return l.getRes("ui/common/common_clsBtn.json")},CloseButton.getFrameConfig=function(){return{frameWidth:16,frameHeight:16,startFrame:1,endFrame:3}},CloseButton}(),y=function(){function Background(){}return Background.getName=function(){return"common_background"},Background.getPNG=function(){return l.getRes("ui/common/common_panelBg.png")},Background.getColumns=function(){return[11,9,11]},Background.getRows=function(){return[14,13,14]},Background.getConfig=function(){return{left:10,top:15,right:10,bottom:15}},Background}(),g=function(){function Border(){}return Border.getName=function(){return"common_border"},Border.getPNG=function(){return l.getRes("ui/common/common_border.png")},Border.getColumns=function(){return[4,2,4]},Border.getRows=function(){return[4,2,4]},Border.getConfig=function(){return{left:4,top:4,right:4,bottom:4}},Border}(),_=function(){function TransparentButton(){}return TransparentButton.getName=function(){return"button_transparent"},TransparentButton.getPNG=function(){return l.getRes("ui/common/button_transparent.png")},TransparentButton.getJSON=function(){return l.getRes("ui/common/button_transparent.json")},TransparentButton.getConfig=function(){return{left:4,top:4,right:4,bottom:4}},TransparentButton}(),v=function(){function Coin(){}return Coin.getIcon=function(t){var i="tuding_icon",o=t;return o===a.op_def.CoinType.COIN?i="iv_coin":o===a.op_def.CoinType.DIAMOND?i="iv_diamond":o===a.op_def.CoinType.GOLD_COIN||o===a.op_def.CoinType.QING_SONG_TANG||a.op_def.CoinType.TU_DING_COIN,i},Coin.getName=function(t){var i="银币",o=t;return o===a.op_def.CoinType.COIN?i=h.a.t("coin.coin"):o===a.op_def.CoinType.DIAMOND?i=h.a.t("coin.diamond"):o===a.op_def.CoinType.GOLD_COIN?i=h.a.t("coin.gold_coin"):o===a.op_def.CoinType.QING_SONG_TANG||a.op_def.CoinType.TU_DING_COIN,i},Coin}()},function(t,i,o){"use strict";o.r(i),o.d(i,"BasePanel",(function(){return c}));var r,a=o(111),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function BasePanel(i,o){var r=t.call(this,i,o)||this;return r.mTweening=!1,r.mWidth=0,r.mHeight=0,r.mReloadTimes=0,r.mScene=i,r.mWorld=o,r.mInitialized=!1,o&&(r.dpr=Math.round(o.uiRatio||1),r.scale=r.mWorld.uiScale),r}return l(BasePanel,t),BasePanel.prototype.addResources=function(i,o){t.prototype.addResources.call(this,i,o),o.type&&this.scene.load[o.type]&&this.scene.load[o.type](i,a.i.getUIRes(o.dpr,o.texture),a.i.getUIRes(o.dpr,o.data))},Object.defineProperty(BasePanel.prototype,"scaleWidth",{get:function(){return this.scene.cameras.main.width/this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"scaleHeight",{get:function(){return this.scene.cameras.main.height/this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"cameraWidth",{get:function(){return this.scene.cameras.main.width},enumerable:!1,configurable:!0}),Object.defineProperty(BasePanel.prototype,"cameraHeight",{get:function(){return this.scene.cameras.main.height},enumerable:!1,configurable:!0}),BasePanel}(h.Panel)},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(114),a=function(){function Font(){}return Object.defineProperty(Font,"DEFULT_FONT",{get:function(){return"en"===r.a.language?this.EN_MAINT:this.ZH_MAIN},enumerable:!1,configurable:!0}),Object.defineProperty(Font,"BOLD_FONT",{get:function(){return"en"===r.a.language?this.EN_BOLD:this.ZH_MAIN},enumerable:!1,configurable:!0}),Font.YAHEI_14_BOLD="bold 14px YaHei",Font.YAHEI_16_BOLD="bold 16px YaHei",Font.YAHEI_18_BOLD="bold 18px YaHei",Font.YAHEI_20_BOLD="bold 20px YaHei",Font.ZH_MAIN="Source Han Sans",Font.EN_MAINT="tt0503m_",Font.EN_BOLD="tt0173m_",Font.NUMBER="t04B25",Font}()},function(t,i,o){"use strict";o.d(i,"b",(function(){return initLocales})),o.d(i,"a",(function(){return l}));var r=o(426),a=o(405),h=o(406);function initLocales(t){return r.a.use(a.a).use(h.a).init({fallbackLng:"en",backend:{loadPath:t,crossDomain:!0}})}var l=r.a},function(t,i,o){"use strict";o.r(i),o.d(i,"UIAtlasName",(function(){return r})),o.d(i,"UIAtlasKey",(function(){return a}));var r=function(){function UIAtlasName(){}return UIAtlasName.commonUrl="common/ui_base",UIAtlasName.common2Url="ui_base2/ui_base2",UIAtlasName}(),a=function(){function UIAtlasKey(){}return UIAtlasKey.commonKey="common_key",UIAtlasKey.common2Key="common2_key",UIAtlasKey}()},function(t,i,o){"use strict";o.r(i),o.d(i,"DynamicImage",(function(){return l}));var r,a=o(0),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function DynamicImage(i,o,r){return t.call(this,i,o,r,void 0)||this}return h(DynamicImage,t),DynamicImage.prototype.load=function(t,i,o,r){this.mLoadCompleteCallbak=o,this.mLoadErrorCallback=r,this.mLoadContext=i,this.scene?(this.mUrl=t,this.scene.textures.exists(t)?this.onLoadComplete(t):(this.scene.load.image(t,t),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start())):a.a.getInstance().fatal(DynamicImage.name+" Create failed does not exist")},DynamicImage.prototype.destroy=function(i){void 0===i&&(i=!1),this.mLoadCompleteCallbak=null,this.mLoadContext=null,this.mLoadErrorCallback=null,this.mUrl="",this.scene&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this)),t.prototype.destroy.call(this,i)},DynamicImage.prototype.onLoadComplete=function(t){if(t===this.mUrl&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onLoadComplete,this),this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.setTexture(this.mUrl),this.mLoadCompleteCallbak)){var i=this.mLoadCompleteCallbak;this.mLoadCompleteCallbak=null,i.call(this.mLoadContext),this.mLoadContext=null}},DynamicImage.prototype.onLoadError=function(t){if(this.mUrl===t.url&&this.mLoadErrorCallback){var i=this.mLoadErrorCallback;this.mLoadErrorCallback=null,i.call(this.mLoadContext),this.mLoadContext=null}},DynamicImage}(Phaser.GameObjects.Image)},function(t,i,o){"use strict";o.r(i),o.d(i,"NinePatch",(function(){return l}));var r,a=o(185),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function NinePatch(i,o,r,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.config=p||d.scene.cache.custom.ninePatch.get(u?""+u:c),d.patchKey=1e3*Math.random()+"",d.config.top=Math.round(d.config.top),d.config.right&&(d.config.right=Math.round(d.config.right)),d.config.bottom&&(d.config.bottom=Math.round(d.config.bottom)),d.config.left&&(d.config.left=Math.round(d.config.left)),Object(a.normalizePatchesConfig)(d.config),d.setSize(h,l),d.setTexture(c,u),d}return h(NinePatch,t),NinePatch.prototype.resize=function(t,i){return t=Math.round(t),i=Math.round(i),this.config?this.width===t&&this.height===i?this:(t=Math.max(t,this.config.left+this.config.right+1),i=Math.max(i,this.config.top+this.config.bottom+1),this.setSize(t,i),void this.drawPatches()):this},NinePatch.prototype.setTexture=function(t,i){return this.originTexture=this.scene.textures.get(t),this.setFrame(i),this.originTexture.setFilter(Phaser.Textures.FilterMode.LINEAR),this},NinePatch.prototype.setFrame=function(t){return this.originFrame=this.originTexture.frames[t]||this.originTexture.frames[NinePatch.__BASE],this.createPatches(),this.drawPatches(),this},NinePatch.prototype.setSize=function(i,o){return t.prototype.setSize.call(this,i,o),this.finalXs=[0,this.config.left,this.width-this.config.right,this.width],this.finalYs=[0,this.config.top,this.height-this.config.bottom,this.height],this},NinePatch.prototype.setTint=function(t){return this.tint=t,this},NinePatch.prototype.setTintFill=function(t){return this.tint=t,this.tintFill=!0,this},Object.defineProperty(NinePatch.prototype,"tintFill",{get:function(){return this.first&&this.first.tintFill},set:function(t){this.each((function(i){return i.tintFill=t}))},enumerable:!1,configurable:!0}),Object.defineProperty(NinePatch.prototype,"tint",{set:function(t){this.each((function(i){return i.setTintFill(t)})),this.internalTint=t},enumerable:!1,configurable:!0}),Object.defineProperty(NinePatch.prototype,"isTinted",{get:function(){return this.first&&this.first.isTinted},enumerable:!1,configurable:!0}),NinePatch.prototype.clearTint=function(){this.each((function(t){return t.clearTint()})),this.internalTint=void 0,this.tintFill=!1},NinePatch.prototype.destroy=function(){if(this.originTexture)for(var i=0,o=0;o<3;o++)for(var r=0;r<3;r++){var a=this.getPatchNameByIndex(i);this.originTexture.frames.hasOwnProperty(a)&&this.originTexture.remove(a),++i}t.prototype.destroy.call(this)},NinePatch.prototype.getPatchNameByIndex=function(t){return this.originFrame.name+NinePatch.patches[t]+this.patchKey},NinePatch.prototype.createPatches=function(){for(var t=[0,this.config.left,this.originFrame.width-this.config.right,this.originFrame.width],i=[0,this.config.top,this.originFrame.height-this.config.bottom,this.originFrame.height],o=0,r=0;r<3;r++)for(var a=0;a<3;a++)this.createPatchFrame(this.getPatchNameByIndex(o),t[a],i[r],t[a+1]-t[a],i[r+1]-i[r]),++o},NinePatch.prototype.drawPatches=function(){var t=this.tintFill;this.removeAll(!0);for(var i=0,o=0;o<3;o++)for(var r=0;r<3;r++){var a=this.originTexture.frames[this.getPatchNameByIndex(i)],h=new Phaser.GameObjects.Image(this.scene,0,0,a.texture.key,a.name);h.setOrigin(0),h.setPosition((1e3*this.finalXs[r]-this.width*this.originX*1e3)/1e3,(1e3*this.finalYs[o]-this.height*this.originY*1e3)/1e3),h.displayWidth=this.finalXs[r+1]-this.finalXs[r],h.displayHeight=this.finalYs[o+1]-this.finalYs[o],this.add(h),this.internalTint&&h.setTint(this.internalTint),h.tintFill=t,h.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),++i}},NinePatch.prototype.createPatchFrame=function(t,i,o,r,a){this.originTexture.frames.hasOwnProperty(t)||this.originTexture.add(t,this.originFrame.sourceIndex,this.originFrame.cutX+i,this.originFrame.cutY+o,r,a)},NinePatch.__BASE="__BASE",NinePatch.patches=["[0][0]","[1][0]","[2][0]","[0][1]","[1][1]","[2][1]","[0][2]","[1][2]","[2][2]"],NinePatch}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function Pos(t,i,o,r){this.x=t||0,this.y=i||0,this.z=o||0,this.depth=0|r}return Pos.prototype.add=function(t,i,o){return this.x+=t,this.x+=i,this.z+=o||0,this},Pos.prototype.equal=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.depth===this.depth},Pos.prototype.toString=function(){return"Pos >> x: "+this.x+", y: "+this.y+", z: "+this.z+", depth: "+this.depth},Pos.prototype.toPoint=function(){return new Phaser.Geom.Point(this.x,this.y)},Pos}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function MessageType(){}return MessageType.CREATE_ROLE="create_role",MessageType.APP_START="app_start",MessageType.EDITOR_CHANGE_MODE="editor_change_mode",MessageType.CLIENT_RESIZE="app_client_resize",MessageType.SCENE_INITIALIZED="SCENE_INITIALIZED",MessageType.SCENE_CLEARED="SCENE_CLEARED",MessageType.SCENE_CHANGE_TO="SCENE_CHANGE_TO",MessageType.SCENE_MOVE_TO="scene_move_to",MessageType.SCENE_MOVE_STOP="scene_move_stop",MessageType.CHANGE_ELEMENT_ANIMATION="change_element_animation",MessageType.CHANGE_CHARACTER_ANIMATION="change_character_animation",MessageType.CHAT_TO="chat_to",MessageType.SHOW_CHAT_BUBBLE="show_chat_bubble",MessageType.REMOVE_CHAT_BUBBLE="remove_chat_bubble",MessageType.PROMPT_ALERT="prompt_alert",MessageType.CHARACTER_TALING="characterTaling",MessageType.CHARACTER_SHUT_UP="characterShutUp",MessageType.QCLOUD_AUTH="qcloud_auth",MessageType.ENTER_SCENE="enter_scene",MessageType.SCENE_ADD_PLAYER="scene_add_player",MessageType.SCENE_REMOVE_PLAYER="scene_remove_player",MessageType.SCENE_UPDATE_PLAYER="scene_update_player",MessageType.SCENE_ADD_ELEMENT="scene_add_element",MessageType.SCENE_ADD_TERRAIN="scene_add_terrain",MessageType.SCENE_ADD_TERRAIN_END="scene_add_terrain_end",MessageType.SCENE_ADD_ALL_TERRAIN="scene_add_all_terrain",MessageType.SCENE_REMOVE_ELEMENT="scene_remove_element",MessageType.SCENE_REMOVE_TERRAIN="scene_remove_terrain",MessageType.SCENE_REMOVE_ALL_TERRAIN="scene_remove_all_terrain",MessageType.SCENE_MOUSE_FOLLOW="scene_mouse_follow",MessageType.SCENE_SELECT_ELEMENT="scene_select_element",MessageType.SCENE_FIXED_TO_ELEMENT="scene_fixed_to_element",MessageType.SCENE_UPDATE_ELEMENT="sceneUpdateElement",MessageType.SCENE_SYNCHRO_PACKAGE="sceneSynchroPackage",MessageType.SCENE_VISIBLE_GRID="sceneVisibleGrid",MessageType.PLAYER_SELECT_CHARACTER="player_select_character",MessageType.PLAYER_DATA_INITIALIZE="player_data_initialize",MessageType.SCENE_DATA_INITIALIZE="scene_data_initialize",MessageType.PACKAGE_ITEM_ADD="package_item_add",MessageType.PACKAGE_ITEM_REMOVE="package_item_remove",MessageType.PACKAGE_EXCHANGE_ITEM_POS="package_exchange_item_pos",MessageType.SCENE_BACKGROUND_CLICK="SCENE_BACKGROUND_CLICK",MessageType.CHANGE_SELF_AVATAR="CHANGE_SELF_AVATAR",MessageType.DRAG_TO_DROP="DRAG_TO_DROP",MessageType.DRAG_OVER_DROP="DRAG_OVER_DROP",MessageType.QUERY_PACKAGE="query_package",MessageType.SYNC_USER_BALANCE="syncUserBalance",MessageType.UPDATED_CHARACTER_PACKAGE="updatedCharacterPackage",MessageType.SHOW_EFFECT="showEffect",MessageType.EDIT_MODE_QUERY_PACKAGE="editModeQueryPackage",MessageType.PRESS_ELEMENT="PRESS_ELEMENT",MessageType.TURN_ELEMENT="turnElement",MessageType.RECYCLE_ELEMENT="recycleElement",MessageType.PUT_ELEMENT="putElement",MessageType.CANCEL_PUT="cancelPut",MessageType.EDIT_PACKAGE_EXPANED="editPackageExpaned",MessageType.EDIT_PACKAGE_COLLAPSE="editPackageCollapse",MessageType.SELECTED_DECORATE_ELEMENT="selectedDecorateElement",MessageType.CANCEL_DECORATE_ELEMENT="cancelDecorateElement",MessageType.ADD_ICON_TO_TOP="addIconToTop",MessageType.REMOVE_ICON_FROM_TOP="removeIconFromTop",MessageType.SHOW_UI="showUI",MessageType.SHOW_NOTICE="showNotice",MessageType}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function Handler(t,i,o,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=!1),this.once=!1,this._id=0,this.setTo(t,i,o,r)}return Handler.create=function(t,i,o,r){return void 0===o&&(o=null),void 0===r&&(r=!0),Handler._pool.length?Handler._pool.pop().setTo(t,i,o,r):new Handler(t,i,o,r)},Handler.prototype.setTo=function(t,i,o,r){return this._id=Handler._gid++,this.caller=t,this.method=i,this.args=o,this.once=r,this},Handler.prototype.run=function(){if(null==this.method)return null;var t=this._id,i=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),i},Handler.prototype.runWith=function(t){if(null==this.method)return null;var i=this._id;if(null==t)var o=this.method.apply(this.caller,this.args);else o=this.args||t instanceof Array?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===i&&this.once&&this.recover(),o},Handler.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Handler.prototype.recover=function(){this._id>0&&(this._id=0,Handler._pool.push(this.clear()))},Handler._pool=[],Handler._gid=1,Handler}()},function(t,i,o){"use strict";o.r(i),o.d(i,"NinePatchButton",(function(){return l}));var r,a=o(117),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function NinePatchButton(i,o,r,h,l,c,u,p,d,m){var y=t.call(this,i,o,r)||this;return y.mScene=i,y.mKey=c,y.mFrame=u||"__BASE",y.initFrame(),y.setSize(h,l),y.mNingBg=new a.NinePatch(y.scene,0,0,h,l,c,y.mFrame_nrmal,d),y.add(y.mNingBg),m&&(y.btnData=m),y.mLabel=y.scene.make.text(void 0,!1).setOrigin(.5,.5).setSize(y.width,y.height).setAlign("center").setText(p),y.add(y.mLabel),y.setInteractive(new Phaser.Geom.Rectangle(0,0,h,l),Phaser.Geom.Rectangle.Contains),y.on("pointerdown",y.onPointerDown,y),y.on("pointerup",y.onPointerUp,y),y}return h(NinePatchButton,t),Object.defineProperty(NinePatchButton.prototype,"enable",{set:function(t){t?(this.mNingBg.clearTint(),this.mLabel.clearTint(),this.setInteractive()):(this.mNingBg.setTintFill(6710886),this.mLabel.setTintFill(7829367),this.removeInteractive())},enumerable:!1,configurable:!0}),NinePatchButton.prototype.getBtnData=function(){return this.btnData},NinePatchButton.prototype.setText=function(t){this.mLabel.setText(t)},NinePatchButton.prototype.getText=function(){return this.mLabel.text},NinePatchButton.prototype.setTextStyle=function(t){this.mLabel.setStyle(t)},NinePatchButton.prototype.setFontStyle=function(t){this.mLabel.setFontStyle(t)},NinePatchButton.prototype.setTextOffset=function(t,i){this.mLabel.setPosition(t,i)},NinePatchButton.prototype.setFrame=function(t){return this.mNingBg.setFrame(t),this},NinePatchButton.prototype.destroy=function(i){this.mLabel&&this.mLabel.destroy(),t.prototype.destroy.call(this,i)},NinePatchButton.prototype.setFrameNormal=function(t,i,o){return this.mFrame_nrmal=t,this.mFrame_down=i||t,this.mFrame_over=o||t,this.changeNormal(),this},NinePatchButton.prototype.changeNormal=function(){this.setFrame(this.mFrame_nrmal)},NinePatchButton.prototype.changeDown=function(){this.setFrame(this.mFrame_down)},NinePatchButton.prototype.changeOver=function(){this.setFrame(this.mFrame_over)},NinePatchButton.prototype.isExists=function(t){var i=this.scene.textures.get(this.mKey);return!(!i||!i.has(t))},NinePatchButton.prototype.onPointerDown=function(t){this.changeDown()},NinePatchButton.prototype.onPointerUp=function(t){this.changeNormal(),this.emit("click",t,this)},Object.defineProperty(NinePatchButton.prototype,"label",{get:function(){return this.mLabel},enumerable:!1,configurable:!0}),NinePatchButton.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},NinePatchButton.prototype.initFrame=function(){var t=this.mFrame?this.mFrame:this.mKey;this.mFrame_nrmal=t+"_normal";var i=t+"_down";this.isExists(i)||(i=t+"_normal"),this.mFrame_down=i;var o=t+"_over";this.isExists(o)||(o=t+"_normal"),this.mFrame_over=o},NinePatchButton}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"d",(function(){return a})),o.d(i,"a",(function(){return h})),o.d(i,"c",(function(){return l})),o.d(i,"b",(function(){return N}));var r,a,h,l,c=o(153),u=o(141),p=o(2),d=o(0),m=o(118),y=o(175),g=o(176),_=o(111),v=o(113),b=o(109),P=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),w=function(t){function Bubble(i,o){var r=t.call(this,i)||this;return r.mMinWidth=0,r.mMinHeight=0,r.mScale=o,r.x=-40*o,r}return P(Bubble,t),Bubble.prototype.show=function(t,i){this.mChatContent=new b.BBCodeText(this.scene,0,4*this.mScale,t,{fontFamily:v.a.DEFULT_FONT,fontSize:14*this.mScale,color:"#000000",origin:{x:0,y:0},wrap:{width:200*this.mScale,mode:"character"}}),this.add(this.mChatContent);var o=36*this.mScale,r=60*this.mScale;this.mMinHeight=this.mChatContent.height+18*this.mScale,this.mMinHeight=this.mMinHeight<o?o:this.mMinHeight,this.mMinWidth=this.mChatContent.width+20*this.mScale,this.mMinWidth=this.mMinWidth<r?r:this.mMinWidth,this.mBubbleBg=new g.DynamicNinepatch(this.scene,this);var a=_.i.getOsdRes(i.bubbleResource||"platformitem/thumbnail/bubble_01.png");this.mBubbleBg.load(a,{width:this.mMinWidth,height:this.mMinHeight,key:a,columns:[34,2,32],rows:[42,2,9]},this.onComplete,this)},Bubble.prototype.tweenTo=function(t){this.mToY=t,this.scene.tweens.add({targets:this,y:t,alpha:1,duration:200})},Bubble.prototype.durationRemove=function(t,i,o){var r=this;this.mTweenCompleteCallback=i,this.mTweenCallContext=o,this.mRemoveDelay=setTimeout((function(){r.removeTween()}),t)},Bubble.prototype.removeTween=function(){var t=this,i=this.mToY-30;this.scene.tweens.add({targets:this,y:i,alpha:0,duration:200,onComplete:function(){t.mTweenCompleteCallback&&t.mTweenCompleteCallback.call(t.mTweenCallContext,t)}})},Bubble.prototype.destroy=function(){this.mChatContent&&this.mChatContent.destroy(!0),this.mChatContent=null,this.mMinWidth=0,this.mMinHeight=0,this.mToY=0,this.mTweenCompleteCallback=null,this.mTweenCallContext=null,this.mRemoveDelay&&clearTimeout(this.mRemoveDelay),t.prototype.destroy.call(this,!0)},Bubble.prototype.onComplete=function(t){if(t){t.setOrigin(0,0),this.addAt(t,0);this.getBounds();this.mChatContent.x=this.mMinWidth-this.mChatContent.width>>1,this.mChatContent.y=6+(this.mMinHeight-this.mChatContent.height>>1)}},Object.defineProperty(Bubble.prototype,"minWidth",{get:function(){return this.mMinWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Bubble.prototype,"minHeight",{get:function(){return this.mMinHeight},enumerable:!1,configurable:!0}),Bubble}(Phaser.GameObjects.Container),S=o(116),C=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),T=function(t){function BubbleContainer(i,o){var r=t.call(this,i)||this;return r.mBubbles=[],r.mScale=o,r.mArrow=new S.DynamicImage(r.scene,0,0),r.mArrow.scale=o,r.mArrow.load(_.i.getRes("ui/chat/bubble_arrow.png")),r.add(r.mArrow),r}return C(BubbleContainer,t),BubbleContainer.prototype.addBubble=function(t,i){var o=this.createBubble(i),r=this.mBubbles.length,a=null,h=0;o.show(t,i);for(var l=r-1;l>=0;l--)h+=(a=this.mBubbles[l]).minHeight+5*this.mScale,a.tweenTo(-h);this.add(o),this.mArrow.y=4*this.mScale},BubbleContainer.prototype.follow=function(t){if(0!==this.mBubbles.length){var i=t.getPosition();i&&this.updatePos(i.x,i.y-110)}},BubbleContainer.prototype.updatePos=function(t,i){this.x=t*this.mScale,this.y=i*this.mScale},BubbleContainer.prototype.destroy=function(i){if(this.mBubbles){for(var o=null,r=this.mBubbles.length-1;r>=0;r--)(o=this.mBubbles[r])&&o.destroy();this.mBubbles=null,this.removeFormParent(),t.prototype.destroy.call(this,i)}},BubbleContainer.prototype.removeFormParent=function(){this.parentContainer&&this.parentContainer.remove(this)},BubbleContainer.prototype.createBubble=function(t){if(t){var i=new w(this.scene,this.mScale);this.mBubbles.push(i);var o=t.duration?t.duration:5e3;return i.durationRemove(o,this.onRemoveBubble,this),i}},BubbleContainer.prototype.onRemoveBubble=function(t){t&&(this.mBubbles=this.mBubbles.filter((function(i){return t!==i})),this.remove(t),t.destroy(),0===this.mBubbles.length&&this.removeFormParent())},BubbleContainer}(Phaser.GameObjects.Container),k=o(110),O=function O(){},I=o(119),M=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),E=function(t){function ShopEntity(i){var o=t.call(this)||this;return o.mWorld=i,o.mInitialize=!1,o.mConnect=o.mWorld.connection,o.addHandlerFun(p.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QUERY_PACKAGE,o.handlerQueryPackage),o.mShopModel=new O,o}return M(ShopEntity,t),ShopEntity.prototype.initialize=function(){return this.mInitialize},ShopEntity.prototype.register=function(){this.mConnect.addPacketListener(this)},ShopEntity.prototype.unRegister=function(){this.mConnect.removePacketListener(this)},ShopEntity.prototype.destroy=function(){this.unRegister(),this.mShopModel=null,this.mInitialize=!1,this.mConnect=null},ShopEntity.prototype.handlerQueryPackage=function(t){var i=t.content;this.mWorld.emitter.emit(I.a.QUERY_PACKAGE,i)},ShopEntity.NAME="ShopModel",ShopEntity}(k.PacketHandler),x=o(137),B=function(){function AIAction(){this.isBreak=!0,this.isEnd=!1}return AIAction.prototype.nextAction=function(){this.isEnd=!0,this.group&&this.group.nextAction()},AIAction.prototype.destroy=function(){this.owner=null,this.group=null},AIAction}(),R=function(){function ActionGroup(){}return ActionGroup.prototype.addAction=function(t){this.list||(this.list=[]),this.list.push(t)},ActionGroup.prototype.nextAction=function(){this.current&&(this.current.destroy(),this.current=null),this.list&&this.list.length>0&&(this.current=this.list.splice(0,1)[0],this.current.isEnd=!1,this.current.execute())},ActionGroup.prototype.setComplHandler=function(t){this.compHandler=t},ActionGroup.prototype.clear=function(){if(this.list){for(var t=0,i=this.list;t<i.length;t++){i[t].destroy()}this.list.length=0}this.current&&(this.current.destroy(),this.current=null)},ActionGroup.prototype.stopCurrentAction=function(){this.current&&(this.current.destroy(),this.current=null)},ActionGroup.prototype.isExecuting=function(){return!(!this.current||this.current.isEnd)},ActionGroup.prototype.hasLast=function(){return!(!this.list||0===this.list.length)},ActionGroup.prototype.breakAction=function(){for(var t=0,i=this.list;t<i.length;t++){i[t].destroy()}this.list.length=0,this.current&&this.current.isBreak&&(this.current.destroy(),this.current=null)},ActionGroup.prototype.destroy=function(){this.clear(),this.list=null,this.sleepAction&&(this.sleepAction.destroy(),this.sleepAction=null),this.compHandler&&(this.compHandler.clear(),this.compHandler=null)},ActionGroup}(),D=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),L=function(t){function AI(i){var o=t.call(this)||this;return o.owner=i,o.group=new R,o}return D(AI,t),AI.prototype.execute=function(){this.group.nextAction()},AI.prototype.nextAction=function(){this.group.nextAction()},AI.prototype.addAction=function(t,i){void 0===i&&(i=!1),t.group=this.group,t.owner=this.owner,i&&this.group.current&&this.group.current.isBreak&&this.group.stopCurrentAction(),this.group.addAction(t),this.group.isExecuting()||this.group.nextAction()},AI.prototype.breakAction=function(){this.group.breakAction()},AI.prototype.destroy=function(){this.group.destroy(),this.owner=null},AI}(B),A=o(44),j=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}();!function(t){t.IDLE="idle",t.WALK="walk",t.RUN="run",t.ATTACK="attack",t.JUMP="jump",t.INJURED="injured",t.FAILED="failed",t.DANCE01="dance01",t.DANCE02="dance02",t.FISHING="fishing",t.GREET01="greet01",t.SIT="sit",t.LIE="lit",t.EMOTION01="emotion01"}(a||(a={})),function(t){t[t.north=0]="north",t[t.north_west=1]="north_west",t[t.west=2]="west",t[t.west_south=3]="west_south",t[t.south=4]="south",t[t.south_east=5]="south_east",t[t.east=6]="east",t[t.east_north=7]="east_north"}(h||(h={})),function(t){t[t.Diasble=0]="Diasble",t[t.Enable=1]="Enable",t[t.Interactive=2]="Interactive"}(l||(l={}));var H,N=function(t){function Element(i,o){var r=t.call(this,o?o.roomService:void 0)||this;return r.mElementManager=o,r.mAnimationName="",r.mMoveData={},r.mCurState=a.IDLE,r.mOffsetY=void 0,r.mMoving=!1,r.mDirty=!1,r.mAi=new L(r),i?(r.mId=i.id,r.model=i,r):r}return j(Element,t),Object.defineProperty(Element.prototype,"dir",{get:function(){return void 0!==this.mDisplayInfo.avatarDir?this.mDisplayInfo.avatarDir:3},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"roomService",{get:function(){if(this.mElementManager)return this.mElementManager.roomService},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"id",{get:function(){return this.mId},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"model",{get:function(){return this.mModel},set:function(t){this.setModel(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"scene",{get:function(){if(this.mElementManager)return this.mElementManager.scene},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"ai",{get:function(){return this.mAi},enumerable:!1,configurable:!0}),Object.defineProperty(Element.prototype,"eleMgr",{get:function(){if(this.mElementManager)return this.mElementManager},enumerable:!1,configurable:!0}),Element.prototype.load=function(t){this.mDisplayInfo=t,this.loadDisplayInfo()},Element.prototype.setModel=function(t){if(this.mModel=t,t&&(this.mQueueAnimations=void 0,this.load(this.mModel.displayInfo),this.mDisplay)){this.mModel.pos&&this.setPosition(this.mModel.pos),this.mDisplay.changeAlpha(this.mModel.alpha),this.getFollowObject(H.Nickname)&&this.showNickname(),this.setDirection(this.mModel.direction);var i=this.mDisplayInfo;this.mInputEnable===l.Interactive&&this.setInputEnable(this.mInputEnable),i&&i.shops&&(this.mShopEntity=new E(this.mElementManager.roomService.world),this.mShopEntity.register()),t.mountSprites&&t.mountSprites.length>0&&this.updateMounth(t.mountSprites),this.update()}},Element.prototype.updateModel=function(t){if(this.mModel.id===t.id){if(t.hasOwnProperty("avatar")&&(this.mModel.updateAvatar(t.avatar),this.load(this.mModel.displayInfo)),t.display&&t.animations&&(this.mModel.updateDisplay(t.display,t.animations),this.load(this.mModel.displayInfo)),t.hasOwnProperty("currentAnimationName")&&(this.play(t.currentAnimationName),this.setInputEnable(this.mInputEnable),this.mModel.setAnimationQueue(void 0)),t.hasOwnProperty("direction")&&this.setDirection(t.direction),t.hasOwnProperty("mountSprites")){var i=t.mountSprites;this.mergeMounth(i),this.updateMounth(i)}if(t.hasOwnProperty("point3f")){var o=t.point3f;this.setPosition(new m.a(o.x,o.y,o.z))}this.update()}},Element.prototype.scaleTween=function(){this.mDisplay&&this.mDisplay.scaleTween()},Element.prototype.play=function(t,i){if(this.mModel){if(this.mModel.currentAnimationName!==t&&(this.mModel.currentAnimationName=t),!this.mDisplay)return d.a.getInstance().warn("display can't initlized");void 0!==i&&(i=i>0?i-1:-1),this.mDisplay.play(this.model.currentAnimation,void 0,i)}else d.a.getInstance().error(Element.name+": sprite is empty")},Element.prototype.setQueue=function(t){var i=this;if(this.mModel){for(var o=[],r=0,h=t;r<h.length;r++){var l=h[r],c={name:l.animationName,playTimes:l.times};l.times>0&&(c.complete=function(){var t=i.model.animationQueue;t.shift();var o,r=a.IDLE;t.length>0&&(r=t[0].name,o=t[0].playTimes),i.play(r,o)}),o.push(c)}this.mModel.setAnimationQueue(o),o.length>0&&this.play(t[0].animationName,t[0].times)}},Element.prototype.setDirection=function(t){this.mDisplayInfo&&(this.mDisplayInfo.avatarDir=t),this.mDisplay&&this.model&&(this.model.direction=t,this.mDisplay.play(this.model.currentAnimation))},Element.prototype.getDirection=function(){return this.mDisplayInfo&&this.mDisplayInfo.avatarDir?this.mDisplayInfo.avatarDir:3},Element.prototype.changeState=function(t){this.mCurState!==t&&(this.mCurState=t,this.mDisplay&&(t||(t=a.IDLE),this.play(this.mCurState)))},Element.prototype.getState=function(){return this.mCurState},Element.prototype.getRenderable=function(){return this.mRenderable},Element.prototype.getDisplay=function(){return this.mDisplay},Element.prototype.update=function(){!1!==this.mDirty&&(this.mDirty=!1,this.mBubble&&this.mBubble.follow(this),this.mBlockable&&this.roomService.updateBlockObject(this),this.mFollowObjects&&this.mFollowObjects.forEach((function(t){return t.update()})))},Element.prototype.move=function(t){this.mElementManager&&this.mDisplay&&(this.mMoveData.arrivalTime=t.timestemp,this.mMoveData.posPath=[{x:t.destinationPoint3f.x,y:t.destinationPoint3f.y}],this._doMove())},Element.prototype.movePosition=function(t,i){if(this.mElementManager&&this.mDisplay){this.startMove(),t.depth||(t.depth=this.getDepth()),this.setPosition(t);var o=this.calculateDirectionByAngle(i);-1!==o&&o!==this.model.direction&&this.setDirection(o)}},Element.prototype.movePath=function(t){var i=this;if(this.mElementManager&&(this.mDisplay&&t.path)){this.mMoveData.arrivalTime=t.timestemp;for(var o=new m.a(this.mDisplay.x,this.mDisplay.y-this.offsetY),r=[],a=null,h=null,l=this.mElementManager.roomService.now(),c=0,u=0,p=t.path;u<p.length;u++){var d=p[u];(h=d.point3f).y===o.y&&h.x===o.x||(a=Math.atan2(h.y-o.y,h.x-o.x)*(180/Math.PI)),l+=c,c=d.timestemp-l,r.push({x:h.x,y:h.y,duration:c,onStartParams:a,onStart:function(t,o,r){i.onCheckDirection(r)}}),o=new m.a(h.x,h.y)}this.mMoveData.posPath=r,this._doMove()}},Element.prototype.startMove=function(){this.changeState(a.WALK)},Element.prototype.stopMove=function(){this.mMoving=!1,this.mDisplay&&(this.mMoveData&&this.mMoveData.posPath&&(this.mModel.setPosition(this.mDisplay.x,this.mDisplay.y),delete this.mMoveData.posPath,this.mMoveData.arrivalTime&&(this.mMoveData.arrivalTime=0),this.mMoveData.tweenLineAnim&&(this.mMoveData.tweenLineAnim.stop(),this.mMoveData.tweenLineAnim.destroy())),this.changeState(a.IDLE))},Element.prototype.getPosition=function(){var t;return this.mDisplay?(this.mRootMount?((t=this.mRootMount.getPosition()).x+=this.mDisplay.x,t.y+=this.mDisplay.y,t.z+=this.mDisplay.z):t=new m.a(this.mDisplay.x,this.mDisplay.y,this.mDisplay.z),t):new m.a(0,0)},Element.prototype.setPosition=function(t){if(this.mMoving&&this.stopMove(),this.mDisplay&&t){if(this.mModel.setPosition(t.x,t.y),this.mRootMount)return;this.mDisplay.setPosition(t.x,t.y,t.z);var i=t.depth?t.depth:0;this.setDepth(i)}this.updateBlock(),this.update()},Element.prototype.getRootPosition=function(){return new m.a(this.mDisplay.x,this.mDisplay.y,0)},Element.prototype.showBubble=function(t,i){var o=this.mElementManager.scene;o&&(this.mBubble||(this.mBubble=new T(o,this.roomService.world.scaleRatio)),this.mBubble.addBubble(t,i),this.mBubble.follow(this),this.roomService.addToSceneUI(this.mBubble))},Element.prototype.clearBubble=function(){this.mBubble&&(this.mBubble.destroy(),this.mBubble=null)},Element.prototype.showNickname=function(){if(this.mDisplay&&this.model&&this.mDisplay.topPoint){var t=this.mRoomService.world.scaleRatio,i=this.getFollowObject(H.Nickname),o=null;i&&i.object?o=i.object:(o=this.scene.make.text({style:{fontSize:12*t,fontFamily:v.a.DEFULT_FONT}}).setOrigin(.5).setStroke("0x0",2*t),i=new U(o,this,t),this.addFollowObject(H.Nickname,i)),o.text=this.mModel.nickname,i.setOffset(0,this.mDisplay.topPoint.y),this.mDisplay.parentContainer&&this.roomService.addToSceneUI(o)}},Element.prototype.hideNickname=function(){this.removeFollowObject(H.Nickname)},Element.prototype.showEffected=function(t,i){if(t&&this.mDisplay){t.gene;this.mDisplay.load(t,x.a.Effect)}},Element.prototype.turn=function(){this.mModel&&(this.mModel.turn(),this.mDisplay&&this.mDisplay.play(this.mModel.currentAnimation))},Element.prototype.setAlpha=function(t){this.mDisplay&&this.mDisplay.setAlpha(t)},Element.prototype.mount=function(t){return this.mRootMount=t,this.mMoving&&this.stopMove(),this.disableBlock(),this.mDirty=!0,this},Element.prototype.unmount=function(){if(this.mRootMount&&this.mDisplay){var t=this.mRootMount.getPosition();t.x+=this.mDisplay.x,t.y+=this.mDisplay.y,this.mRootMount=null,this.setPosition(t),this.enableBlock(),this.mDirty=!0}return this},Element.prototype.addMount=function(t,i){return this.mMounts||(this.mMounts=[]),t.mount(this),this.mDisplay&&this.mDisplay.mount(t.getDisplay(),i),-1===this.mMounts.indexOf(t)&&this.mMounts.push(t),this},Element.prototype.removeMount=function(t){if(t.unmount(),!this.mMounts)return this;this.mDisplay&&this.mDisplay.unmount(t.getDisplay());var i=this.mMounts.indexOf(t);return i>-1&&this.mMounts.splice(i,1),this},Element.prototype.setState=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i];switch(r.execCode){case p.op_def.ExecCode.EXEC_CODE_ADD:case p.op_def.ExecCode.EXEC_CODE_UPDATE:this.updateStateHandler(r);break;case p.op_def.ExecCode.EXEC_CODE_DELETE:this.removeStateHandler(r)}}},Element.prototype.getDepth=function(){var t=0;return this.model&&this.model.pos&&(t=this.model.pos.depth?this.model.pos.depth:0),t},Element.prototype.destroy=function(){this.mMoveData&&this.mMoveData.tweenAnim&&(this.mMoveData.tweenAnim.stop(),this.mMoveData.tweenAnim.remove(),this.mMoveData.tweenAnim=null,this.mMoveData=null),this.mDisplay&&(this.mBlockable&&this.roomService.removeBlockObject(this),this.mDisplay.destroy(),this.mDisplay=null),this.mBubble&&(this.mBubble.destroy(),this.mBubble=void 0),this.mShopEntity&&(this.mShopEntity.destroy(),this.mShopEntity=null),this.mAi&&(this.mAi.destroy(),this.mAi=null),this.mFollowObjects&&(this.mFollowObjects.forEach((function(t){return t.destroy()})),this.mFollowObjects.clear(),this.mFollowObjects=void 0),t.prototype.destroy.call(this)},Element.prototype._doMove=function(){var t=this;if(this.mMoveData.posPath){var i=this.mMoveData.tweenLineAnim;i&&(i.stop(),i.destroy());var o=this.mMoveData.posPath;this.mMoveData.tweenLineAnim=this.mElementManager.scene.tweens.timeline({targets:this.mDisplay,ease:"Linear",tweens:o,onStart:function(){t.onMoveStart()},onComplete:function(){t.onMoveComplete()},onUpdate:function(){t.onMoving()},onCompleteParams:[this]})}},Element.prototype.createDisplay=function(){if(this.mDisplayInfo){if(this.mDisplay)return this.mDisplay;var t=this.mElementManager.scene;if(t){"DragonbonesModel"===this.mDisplayInfo.discriminator?this.mDisplay=new c.a(t,this.mElementManager.roomService,this):this.mDisplay=new u.a(t,this.mElementManager.roomService,this);var i=this.mModel.pos;i&&this.mDisplay.setPosition(i.x,i.y,i.z),this.addToBlock()}return this.mDisplay}d.a.getInstance().error("displayinfo does not exist, Create "+this.model.nickname+" failed")},Element.prototype.loadDisplayInfo=function(){this.mDisplayInfo&&(this.mDisplay||this.createDisplay(),this.mDisplay.once("initialized",this.onDisplayReady,this),this.mDisplay.on("updateAnimation",this.onUpdateAnimationHandler,this),this.mDisplay.load(this.mDisplayInfo))},Element.prototype.addDisplay=function(){this.createDisplay();var t=this.roomService;if(t&&this.mDisplay){t.addToSurface(this.mDisplay);var i=0;this.model&&this.model.pos&&(i=this.model.pos.depth?this.model.pos.depth:0),this.mFollowObjects&&this.mFollowObjects.forEach((function(i){i.object&&t.addToSceneUI(i.object)})),this.setDepth(i)}},Element.prototype.removeDisplay=function(){t.prototype.removeDisplay.call(this),this.mFollowObjects&&this.mFollowObjects.forEach((function(t){return t.remove()}))},Element.prototype.setDepth=function(t){if(this.mDisplay){if(!this.roomService)throw new Error("roomService is undefined");var i=this.roomService.layerManager;if(!i)throw new Error("layerManager is undefined");i.depthSurfaceDirty=!0}},Element.prototype.onDisplayReady=function(t){if(this.mDisplay){this.mDisplay.play(this.model.currentAnimation),this.mModel.mountSprites&&this.mModel.mountSprites.length>0&&this.updateMounth(this.mModel.mountSprites);var i=0;this.model&&this.model.pos&&(i=this.model.pos.depth?this.model.pos.depth:0),this.setDepth(i)}},Element.prototype.onUpdateAnimationHandler=function(){this.mDisplay&&this.setInputEnable(this.mInputEnable)},Element.prototype.onMoveStart=function(){this.mMoving=!0},Element.prototype.onMoveComplete=function(){this.stopMove()},Element.prototype.onMoving=function(){var t=this.roomService.now();t-(this.mMoveData.tweenLastUpdate||0)>=50&&(this.setDepth(0),this.mMoveData.tweenLastUpdate=t),this.mDirty=!0},Object.defineProperty(Element.prototype,"offsetY",{get:function(){if(void 0===this.mOffsetY){if(!this.mElementManager||!this.mElementManager.roomService||!this.mElementManager.roomService.roomSize)return 0;this.mOffsetY=this.mElementManager.roomService.roomSize.tileHeight>>2}return 0},enumerable:!1,configurable:!0}),Element.prototype.onCheckDirection=function(t){if("number"==typeof t){var i=this.calculateDirectionByAngle(t);-1!==i&&this.setDirection(i)}},Element.prototype.calculateDirectionByAngle=function(t){return t>90?3:t>=0?5:t>=-90?7:1},Element.prototype.mergeMounth=function(t){for(var i=this.mModel.mountSprites||[],o=this.mRoomService,r=0,a=i;r<a.length;r++){var h=a[r];if(-1===t.indexOf(h)){var l=o.getElement(h);l&&this.removeMount(l)}}},Element.prototype.updateMounth=function(t){var i=this.mRoomService;if(t.length>0)for(var o=0;o<t.length;o++){var r=i.getElement(t[o]);r&&this.addMount(r,o)}this.mModel.mountSprites=t},Element.prototype.updateStateHandler=function(t){switch(t.name){case"effect":var i=A.Buffer.from(t.packet).readDoubleBE(0),o=this.roomService.effectManager.get(i);o.displayInfo?this.showEffected(o.displayInfo):o.once("updateDisplayInfo",this.showEffected,this)}},Element.prototype.removeStateHandler=function(t){switch(t.name){case"effect":this.mDisplay&&this.mDisplay.removeEffect(x.a.Effect)}},Element.prototype.addFollowObject=function(t,i){this.mFollowObjects||(this.mFollowObjects=new Map),this.mFollowObjects.set(t,i)},Element.prototype.removeFollowObject=function(t){if(this.mFollowObjects){var i=this.mFollowObjects.get(t);i&&(i.destroy(),this.mFollowObjects.delete(t))}},Element.prototype.getFollowObject=function(t){if(this.mFollowObjects)return this.mFollowObjects.get(t)},Element}(y.a),U=function(){function FollowObject(t,i,o){void 0===o&&(o=1),this.mDpr=o,this.mOffset=new Phaser.Geom.Point,this.mObject=t,this.mTarget=i}return FollowObject.prototype.setOffset=function(t,i){this.mOffset.setTo(t,i),this.update()},FollowObject.prototype.update=function(){if(this.mTarget&&this.mObject){var t=this.mTarget.getPosition();this.mObject.x=Math.round((t.x+this.mOffset.x)*this.mDpr),this.mObject.y=Math.round((t.y+this.mOffset.y)*this.mDpr)}},FollowObject.prototype.remove=function(){if(this.mObject){var t=this.mObject;t.parentContainer&&t.parentContainer.remove(t)}},FollowObject.prototype.destroy=function(){this.mObject&&this.mObject.destroy(),this.mObject=void 0},Object.defineProperty(FollowObject.prototype,"object",{get:function(){return this.mObject},enumerable:!1,configurable:!0}),FollowObject.prototype.linear=function(t,i,o){return(i-t)*o+t},FollowObject}();!function(t){t[t.Nickname=0]="Nickname"}(H||(H={}))},,function(t,i,o){"use strict";o.r(i),o.d(i,"IconBtn",(function(){return c}));var r,a=o(118),h=o(111),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function IconBtn(i,o,r){var a=t.call(this,i)||this;return a.mScene=i,a.mWorld=o,a.mBtnBg=i.make.image(void 0,!1),a.mBgResKey=r.bgResKey,a.mBgTexture=r.bgTextures,a.mData=r,!a.mScene.textures.exists(a.mBgResKey)&&r.pngUrl&&r.jsonUrl?(a.mScene.load.atlas(r.key,h.i.getRes(r.pngUrl),h.i.getRes(r.jsonUrl)),a.mScene.load.once(Phaser.Loader.Events.COMPLETE,a.loadComplete,a),a.mScene.load.start(),a):(a.loadComplete(),a)}return l(IconBtn,t),IconBtn.prototype.getKey=function(){return this.mData.key},IconBtn.prototype.setPos=function(t,i){this.mBasePos||(this.mBasePos=new a.a),this.mBasePos.x=t,this.mBasePos.y=i},IconBtn.prototype.getPos=function(){return this.mBasePos},IconBtn.prototype.setBtnData=function(t){this.mBtnData=t},IconBtn.prototype.getBtnData=function(){return this.mBtnData},IconBtn.prototype.setClick=function(t){this.monClick=t},IconBtn.prototype.destroy=function(){this.mBtnBg&&this.mBtnBg.destroy(!0),this.mBtnIcon&&this.mBtnIcon.destroy(!0),this.monClick=null,this.mBtnBg=null,this.mBtnIcon=null,this.mBtnData=null,this.mScene=null,t.prototype.destroy.call(this)},IconBtn.prototype.loadComplete=function(){this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[0]),this.mBtnBg.scaleX=this.mBtnBg.scaleY=this.mData.scale,this.addAt(this.mBtnBg,0),this.mData.iconResKey&&this.mData.iconTexture&&this.mData.iconTexture.length>0&&(this.mBtnIcon=this.mScene.make.image(void 0,!1),this.mBtnIcon.setTexture(this.mData.iconResKey,this.mData.iconTexture),this.add(this.mBtnIcon)),this.setSize(this.mBtnBg.width,this.mBtnBg.height),this.setInteractive(),this.on("pointerup",this.upHandler,this),this.on("pointerdown",this.downHandler,this),this.on("pointerover",this.overHandler,this),this.on("pointerout",this.outHandler,this)},IconBtn.prototype.overHandler=function(t){this.mBgTexture.length<2||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[1])},IconBtn.prototype.outHandler=function(t){this.mBgTexture.length<2||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[0])},IconBtn.prototype.upHandler=function(){this.monClick&&this.monClick(),this.mData&&this.mData.callBack&&this.mData.callBack.apply(this),this.emit("click",this),this.mBgTexture.length<3||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[2])},IconBtn.prototype.downHandler=function(){this.mBgTexture.length<4||this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[3])},IconBtn.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},IconBtn}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"UIMediatorType",(function(){return r}));var r=function(){function UIMediatorType(){}return UIMediatorType.BagMediator="BagMediator",UIMediatorType.ChatMediator="ChatMediator",UIMediatorType.NOTICE="Notice",UIMediatorType.DIALOGO="DIALOGO",UIMediatorType.Turn_Btn_Top="Turn_Btn_Top",UIMediatorType.Turn_Btn_Bottom="Turn_Btn_Bottom",UIMediatorType.App_Back="App_Back",UIMediatorType.Editor_Save="Editor_Save",UIMediatorType.Editor_Cancel="Editor_Cancel",UIMediatorType.Close_Btn="Close_Btn",UIMediatorType.ControlF="ControlF",UIMediatorType.Storage="Storage",UIMediatorType.UserInfo="UserInfo",UIMediatorType.UserMenu="UserMenu",UIMediatorType.MessageBox="MessageBox",UIMediatorType.ComponentRank="ComponentRank",UIMediatorType.Rank="Rank",UIMediatorType.VoteResult="VoteResult",UIMediatorType.Shop="Shop",UIMediatorType.MineSettle="MineSettle",UIMediatorType.EquipUpgrade="EquipUpgrade",UIMediatorType}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return m}));var r=o(118),a=o(154),h=o(2),l=o(142),c=o(143),u=o(155),p=o(0),d=o(122),m=function(){function Sprite(t,i){if(this.mID=t.id,t.point3f){var o=t.point3f;this.mPos=new r.a(o.x,o.y,o.z)}this.mAttrs=t.attrs,t.avatar&&this.updateAvatar(t.avatar),t.display&&this.updateDisplay(t.display,t.animations,t.currentAnimationName),t.sn&&(this.mSn=t.sn),this.tryRegisterAnimation(t.animationRegistrationMap),this.mCurrentAnimationName=t.currentAnimationName,this.direction=t.direction||3,this.mNickname=t.nickname,this.mBindID=t.bindId,this.mAlpha=void 0===t.opacity?1:t.opacity/100,this.mDisplayBadgeCards=t.displayBadgeCards,this.mNodeType=i,t.version&&(this.mVersion=t.version),void 0!==t.isMoss&&(this.isMoss=t.isMoss),this.mMountSprites=t.mountSprites}return Sprite.prototype.toSprite=function(){var t=h.op_client.Sprite.create();if(t.id=this.id,t.nickname=this.mNickname,this.mDisplayInfo instanceof l.a){t.display=this.mDisplayInfo.display,t.currentAnimationName=this.currentAnimationName;var i=h.op_def.PBPoint3f.create();i.x=this.pos.x,i.y=this.pos.y,i.z=this.pos.z,t.point3f=i,t.animations=this.displayInfo.createProtocolObject()}return t.direction=this.direction,t.bindId=this.bindID,t.sn=this.sn,t.version=this.mVersion,t},Sprite.prototype.newID=function(){this.mID=u.a.genId()},Sprite.prototype.setPosition=function(t,i){this.mPos||(this.mPos=new r.a),this.mPos.x=t,this.mPos.y=i},Sprite.prototype.turn=function(){if(this.mDisplayInfo){var t=this.dirable(this.mCurrentAnimationName),i=t.indexOf(this.mDirection);return i>-1?this.direction=t[(i+1)%t.length]:p.a.getInstance().error(Sprite.name+": error dir "+this.mDirection),this}},Sprite.prototype.updateAvatar=function(t){this.mDisplayInfo&&this.mDisplayInfo.destroy(),this.mAvatar={id:t.id},this.mAvatar=Object.assign(this.mAvatar,t),this.mDisplayInfo=new a.a(this)},Sprite.prototype.updateDisplay=function(t,i,o){if(t&&i&&(this.mDisplayInfo&&this.mDisplayInfo.destroy(),t)){for(var r=[],a=0,h=i;a<h.length;a++){var u=h[a];r.push(new c.a(u))}o=o||this.mCurrentAnimationName||"",this.mDisplayInfo=new l.a({animations:{defaultAnimationName:o,display:t,animationData:r},id:this.id}),o&&(this.currentAnimationName=o)}},Sprite.prototype.setAnimationQueue=function(t){this.mAnimationQueue=t},Sprite.prototype.setMountSprites=function(t){this.mMountSprites=t},Sprite.prototype.updateAttr=function(t){this.mAttrs=t},Sprite.prototype.setAnimationName=function(t){return this.mDisplayInfo&&(this.mDisplayInfo.animationName=t),this.mCurrentAnimationName=t,this.setAnimationData(t,this.direction)},Object.defineProperty(Sprite.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"pos",{get:function(){return this.mPos},set:function(t){this.mPos=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"avatar",{get:function(){return this.mAvatar},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"currentAnimationName",{get:function(){return this.mCurrentAnimationName},set:function(t){this.mDisplayInfo&&(this.mDisplayInfo.animationName=t),this.mCurrentAnimationName=t,this.setAnimationData(t,this.direction)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"direction",{get:function(){return this.mDirection},set:function(t){this.mDirection=t||3,this.mDisplayInfo&&this.setAnimationData(this.mCurrentAnimationName,this.mDirection)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"nickname",{get:function(){return this.mNickname},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"bindID",{get:function(){return this.mBindID},set:function(t){this.mBindID=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"sn",{get:function(){return this.mSn},set:function(t){this.mSn=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"alpha",{get:function(){return this.mAlpha},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"package",{get:function(){return this.mPackage},set:function(t){this.mPackage=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"sceneId",{get:function(){return this.mSceneId},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"uuid",{get:function(){return this.mUuid},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"displayBadgeCards",{get:function(){return this.mDisplayBadgeCards},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"platformId",{get:function(){return this.mPlatformId},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"displayInfo",{get:function(){return this.mDisplayInfo},set:function(t){this.mDisplayInfo=t,this.currentAnimationName?(this.mDisplayInfo.animationName=this.currentAnimationName,this.setAnimationData(this.currentAnimationName,this.direction)):t.animationName&&(this.currentAnimationName=t.animationName)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"isMoss",{get:function(){return this.mIsMoss},set:function(t){this.mIsMoss=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"animationQueue",{get:function(){return this.mAnimationQueue},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"nodeType",{get:function(){return this.mNodeType},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"currentAnimation",{get:function(){return this.mCurrentAnimation},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"currentCollisionArea",{get:function(){return this.mCurrentCollisionArea||(this.mCurrentCollisionArea=this.getCollisionArea()),this.mCurrentCollisionArea},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"currentWalkableArea",{get:function(){return this.mCurrentWalkableArea||(this.mCurrentWalkableArea=this.getWalkableArea()),this.mCurrentWalkableArea},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"currentCollisionPoint",{get:function(){return this.mCurrentCollisionPoint||(this.mCurrentCollisionPoint=this.getOriginPoint()),this.mCurrentCollisionPoint},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"hasInteractive",{get:function(){if(!this.mDisplayInfo||!this.mCurrentAnimation)return!1;var t=this.mCurrentAnimation.name,i=this.mDisplayInfo.getInteractiveArea(t);return!!(i&&i.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"mountSprites",{get:function(){return this.mMountSprites},set:function(t){this.mMountSprites=t},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"animationMap",{get:function(){return this.mRegisterAnimation||(this.mRegisterAnimation=new Map),this.mRegisterAnimation},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"originCollisionPoint",{get:function(){return this._originCollisionPoint},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"originWalkPoint",{get:function(){return this._originWalkPoint},enumerable:!1,configurable:!0}),Object.defineProperty(Sprite.prototype,"attrs",{get:function(){return this.mAttrs},enumerable:!1,configurable:!0}),Sprite.prototype.setOriginCollisionPoint=function(t){void 0===this._originCollisionPoint&&(this._originCollisionPoint=new Phaser.Geom.Point),t&&t.length>1&&(this._originCollisionPoint.x=t[0],this._originCollisionPoint.y=t[1])},Sprite.prototype.setOriginWalkPoint=function(t){void 0===this._originWalkPoint&&(this._originWalkPoint=new Phaser.Geom.Point),t&&t.length>1&&(this._originWalkPoint.x=t[0],this._originWalkPoint.y=t[1])},Sprite.prototype.getInteracviveArea=function(){if(this.mDisplayInfo&&this.mCurrentAnimation){var t=this.mCurrentAnimation.name;return this.mDisplayInfo.getInteractiveArea(t)}},Sprite.prototype.setAnimationData=function(t,i){if(this.displayInfo&&t){var o=t.split("_")[0];return this.mRegisterAnimation&&this.mRegisterAnimation.has(o)&&(o=this.mRegisterAnimation.get(o)),this.mCurrentAnimation=this.displayInfo.findAnimation(o,i),this.mAnimationQueue&&this.mAnimationQueue.length>0&&(this.mCurrentAnimation.playingQueue=this.mAnimationQueue[0]),this.mCurrentCollisionArea&&this.setArea(),this.mCurrentAnimation}},Sprite.prototype.checkDirectionAnimation=function(t,i){var o=t+"_"+i;return this.mDisplayInfo.existAnimation(o)?o:null},Sprite.prototype.setArea=function(){this.mCurrentCollisionArea=this.getCollisionArea(),this.mCurrentWalkableArea=this.getWalkableArea(),this.mCurrentCollisionPoint=this.getOriginPoint()},Sprite.prototype.getCollisionArea=function(){if(this.mDisplayInfo&&this.mCurrentAnimation){var t=this.mCurrentAnimation,i=t.name,o=t.flip;return this.mDisplayInfo.getCollisionArea(i,o)}},Sprite.prototype.getWalkableArea=function(){if(this.mDisplayInfo&&this.mCurrentAnimation){var t=this.mCurrentAnimation,i=t.name,o=t.flip;return this.mDisplayInfo.getWalkableArea(i,o)}},Sprite.prototype.getOriginPoint=function(){if(this.mDisplayInfo&&this.mCurrentAnimation){var t=this.mCurrentAnimation,i=t.name,o=t.flip;return this.mDisplayInfo.getOriginPoint(i,o)}},Sprite.prototype.dirable=function(t){var i=t.split("_")[0],o=[3,5];return this.checkDirectionAnimation(i,d.a.east_north)&&o.push(7,1),o},Sprite.prototype.tryRegisterAnimation=function(t){if(t&&!(t.length<1)){this.mRegisterAnimation=new Map;for(var i=0,o=t;i<o.length;i++){var r=o[i];this.mRegisterAnimation.set(r.key,r.value)}}},Sprite}()},function(t,i,o){"use strict";o.r(i),o.d(i,"CheckboxGroup",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function CheckboxGroup(){var i=t.call(this)||this;return i.mList=[],i}return a(CheckboxGroup,t),CheckboxGroup.prototype.appendItem=function(t){return this.mList.push(t),t.on("Tap",this.onGameObjectUpHandler,this),this},CheckboxGroup.prototype.appendItemAll=function(t){this.mList=this.mList.concat(t);for(var i=0,o=t;i<o.length;i++){o[i].on("Tap",this.onGameObjectUpHandler,this)}return this},CheckboxGroup.prototype.removeItem=function(t){return this.mList=this.mList.filter((function(i){return i!==t})),t.removeAllListeners(),this},CheckboxGroup.prototype.selectIndex=function(t){return t<0&&(t=0),t>=this.mList.length&&(t=this.mList.length-1),this.mList.length>0&&this.select(this.mList[t]),this},CheckboxGroup.prototype.select=function(t){this.mSelectedButton!==t&&(this.mSelectedButton&&this.mSelectedButton.changeNormal(),t.changeDown(),this.mSelectedButton=t,this.emit("selected",t))},CheckboxGroup.prototype.reset=function(){var t=this;this.mList&&this.mList.forEach((function(i){t.removeItem(i)}))},CheckboxGroup.prototype.destroy=function(){var i=this;this.mList&&this.mList.forEach((function(t){i.removeItem(t),t.destroy()})),t.prototype.destroy.call(this)},CheckboxGroup.prototype.onGameObjectUpHandler=function(t,i){this.select(i)},Object.defineProperty(CheckboxGroup.prototype,"selectedIndex",{get:function(){return this.mList.indexOf(this.mSelectedButton)},enumerable:!1,configurable:!0}),CheckboxGroup}(Phaser.Events.EventEmitter)},function(t,i,o){"use strict";o.d(i,"a",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function BasicScene(i){var o=t.call(this,i)||this;return o.mInitialize=!1,o.mShow=!1,o}return a(BasicScene,t),BasicScene.prototype.create=function(){this.mInitialize=!0},BasicScene.prototype.sceneInitialize=function(){return this.mInitialize},BasicScene.prototype.getShow=function(){return this.mShow},BasicScene.prototype.setViewPort=function(t,i,o,r){this.cameras.main.setViewport(t,i,o,r)},BasicScene}(Phaser.Scene)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemInfoTips",(function(){return u}));var r,a=o(113),h=o(109),l=o(114),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function ItemInfoTips(i,o,r,a,h,l,c){var u=t.call(this,i)||this;return u.setSize(o,r),u.key=a,u.dpr=l,u.config=c||{left:15*u.dpr,top:15*u.dpr,right:15*u.dpr,bottom:15*u.dpr},u.create(h),u}return c(ItemInfoTips,t),ItemInfoTips.prototype.setText=function(t){this.tipsText.text=t;var i=this.tipsText.height+20*this.dpr,o=this.tipsbg.width;this.setSize(o,i),this.tipsbg.resize(o,i),this.tipsbg.y=.5*-this.tipsbg.height,this.tipsText.y=-i+10*this.dpr},ItemInfoTips.prototype.setItemData=function(t){var i=this.getDesText(t);this.setText(i)},ItemInfoTips.prototype.create=function(t){var i=this.width,o=this.height,r=new h.NineSlicePatch(this.scene,0,0,i,o,this.key,t,this.config,void 0,void 0,0);r.setPosition(0,.5*-o),this.tipsbg=r;var l=new h.BBCodeText(this.scene,.5*-this.width+10*this.dpr,-o+60*this.dpr,"",{color:"#333333",fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,wrap:{width:this.width-15*this.dpr,mode:"string"}}).setOrigin(0);this.tipsText=l,this.add([r,l])},ItemInfoTips.prototype.getDesText=function(t){t||(t={sellingPrice:!0,tradable:!1});var i="[stroke=#2640CA][color=#2640CA][b]"+t.name+"[/b][/color][/stroke]\n",o="[stroke=#2640CA][color=#2640CA]"+l.a.t("common.source")+"[/color][/stroke]：";i+=(o+=t.source)+"\n";var r="[stroke=#2640CA][color=#2640CA]"+l.a.t("common.description")+"[/color][/stroke]：";return i+=r+=t.des},ItemInfoTips}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"DetailDisplay",(function(){return v}));var r,a=o(111),h=o(153),l=o(154),c=o(120),u=o(343),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function FrameAnimation(i){var o=t.call(this,i)||this;return o.loaded=!1,o.isPlaying=!1,o.loop=!1,o}return p(FrameAnimation,t),FrameAnimation.prototype.load=function(t,i,o,r){this.resName=t||i,this.resUrl=i,this.complHandler=r,this.animUrlData=new u.a,t?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,o),this.scene.load.atlas(this.resName,this.animUrlData.pngUrl,this.animUrlData.jsonUrl,this.animUrlData.textureXhrSettings,this.animUrlData.atlasXhrSettings),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},FrameAnimation.prototype.play=function(t){this.curAniName=t||this.resName,this.isPlaying=!0,this.frameAnim&&this.frameAnim.play(this.curAniName)},FrameAnimation.prototype.destroy=function(){this.frameAnim&&this.frameAnim.destroy(),this.animUrlData&&this.animUrlData.dispose(),this.frameAnim=null,this.animUrlData=null,this.complHandler=void 0,this.isPlaying=!1},FrameAnimation.prototype.onLoadComplete=function(t,i,o){this.loaded=!0,this.scene.anims.exists(this.resName)||this.scene.anims.create({key:this.resName,frames:this.scene.anims.generateFrameNames(this.resName),repeat:-1}),this.frameAnim||(this.frameAnim=this.scene.add.sprite(0,0,this.resName),this.add(this.frameAnim)),0===this.width?(this.setSize(this.frameAnim.width,this.frameAnim.height),this.scale=1):this.scale=this.width/this.frameAnim.displayWidth,this.isPlaying||this.play(this.curAniName),this.complHandler&&this.complHandler.run()},FrameAnimation}(Phaser.GameObjects.Container),m=o(141),y=o(142),g=o(143),_=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),v=function(t){function DetailDisplay(i,o){void 0===o&&(o=!1);var r=t.call(this,i)||this;return r.mKeepScale=!1,r.mKeepScale=o,r}return _(DetailDisplay,t),DetailDisplay.prototype.loadDisplay=function(t){var i=t.display;i&&(""!==i.texturePath&&""!==i.dataPath?t.animations.length>0?this.loadElement(t):this.loadUrl(a.i.getOsdRes(i.texturePath),a.i.getOsdRes(i.dataPath)):this.loadUrl(i.texturePath,i.dataPath))},DetailDisplay.prototype.loadElement=function(t){var i=this;this.clearDisplay(),this.mDisplay=t;var o=t.animations;this.mFramesDisplay||(this.mFramesDisplay=new m.a(this.scene,void 0,void 0)),this.add(this.mFramesDisplay);var r=t.display;if(r&&o.length>0){for(var a=[],h=o[0].node.name,l=0,c=o;l<c.length;l++){var u=c[l];u.baseLoc="0,0";for(var p=0,d=u.layer;p<d.length;p++){d[p].offsetLoc={x:0,y:0}}a.push(new g.a(u))}this.mFramesDisplay.once("initialized",(function(){i.mFramesDisplay.play({name:h,flip:!1});var t=i.mFramesDisplay,o=t.spriteWidth,r=t.spriteHeight;if(i.mFramesDisplay.x=.5*-o,i.mFramesDisplay.y=.5*-r,i.mKeepScale){var a=i.width/o,l=i.height/r;i.mFramesDisplay.scale=a>l?l:a}else i.mFramesDisplay.scale=1})),this.mFramesDisplay.load(new y.a({animations:{display:r,defaultAnimationName:h,animationData:a},id:t.id}))}},DetailDisplay.prototype.loadAvatar=function(t,i,o){var r=this;void 0===i&&(i=1),this.clearDisplay(),this.mDragonboneDisplay||(this.mDragonboneDisplay=new h.a(this.scene,void 0,void 0,!0),o&&(this.mDragonboneDisplay.x+=o.x,this.mDragonboneDisplay.y+=o.y)),this.mDragonboneDisplay.once("initialized",(function(){r.mDragonboneDisplay.play({name:"idle",flip:!1})})),this.mDragonboneDisplay.load(new l.a({id:0,avatar:t.avatar})),this.mDragonboneDisplay.scale=i,this.add(this.mDragonboneDisplay)},DetailDisplay.prototype.loadUrl=function(t,i){this.mUrl=t,this.clearDisplay(),this.mImage||(this.mImage=this.scene.make.image(void 0,!1)),this.add(this.mImage),this.scene.textures.exists(t)?this.onCompleteHandler():(i?this.scene.load.atlas(t,a.i.getOsdRes(t),a.i.getOsdRes(i)):this.scene.load.image(t,a.i.getOsdRes(t)),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.start())},DetailDisplay.prototype.loadSprite=function(t,i,o,r){var a=this;void 0===r&&(r=!1),this.clearDisplay(),this.frameAni||(this.frameAni=new d(this.scene)),this.mImage&&this.remove(this.mImage),this.scale=1,this.frameAni.load(t,i,o,new c.a(this,(function(){if(r){var t=a.width/a.frameAni.width,i=a.height/a.frameAni.height;a.frameAni.scale=t>i?i:t}else a.frameAni.scale=1}))),this.add(this.frameAni)},DetailDisplay.prototype.setTexture=function(t,i){if(this.clearDisplay(),this.mImage?this.mImage.setTexture(t,i):this.mImage=this.scene.make.image({key:t,frame:i},!1),this.add(this.mImage),this.emit("show",this.mImage),this.mKeepScale){this.mImage.scale=1;var o=this.width/this.mImage.displayWidth,r=this.height/this.mImage.displayHeight;this.mImage.scale=o>r?r:o}else this.mImage.scale=1,this.setSize(this.mImage.width*this.scale,this.mImage.height*this.scale)},DetailDisplay.prototype.setNearest=function(){this.mImage&&this.mImage.texture.setFilter(Phaser.Textures.FilterMode.NEAREST)},DetailDisplay.prototype.setComplHandler=function(t){this.complHandler=t},Object.defineProperty(DetailDisplay.prototype,"display",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),DetailDisplay.prototype.onCompleteHandler=function(){if(this.scene){if(this.mDisplay){this.mDisplay.display;var t=this.mDisplay.animations;if(!t||t.length<=0)return;this.mImage.setTexture(this.mDisplay.display.texturePath,t[0].frameName[0])}else this.mImage.setTexture(this.mUrl);if(this.mKeepScale){this.mImage.scale=1;var i=this.width/this.mImage.displayWidth,o=this.height/this.mImage.displayHeight;this.mImage.scale=i>o?o:i}else this.setSize(this.mImage.width*this.scale,this.mImage.height*this.scale);this.emit("show",this.mImage),this.complHandler&&this.complHandler.run()}},DetailDisplay.prototype.clearDisplay=function(){this.mImage&&this.remove(this.mImage),this.mDragonboneDisplay&&(this.mDragonboneDisplay.destroy(),this.mDragonboneDisplay=void 0),this.mFramesDisplay&&(this.mFramesDisplay.destroy(),this.mFramesDisplay=void 0),this.mDisplay=void 0,this.frameAni&&(this.remove(this.frameAni),this.frameAni.destroy()),this.scene.load.off(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this)},DetailDisplay}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"a",(function(){return y}));var r,a=o(179),h=o(111),l=o(0),c=o(128),u=o(113),p=o(24),d=o.n(p),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),__awaiter=function(t,i,o,r){return new(o||(o=Promise))((function(a,h){function fulfilled(t){try{step(r.next(t))}catch(t){h(t)}}function rejected(t){try{step(r.throw(t))}catch(t){h(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof o?t:new o((function(i){i(t)}))}(t.value).then(fulfilled,rejected)}step((r=r.apply(t,i||[])).next())}))},__generator=function(t,i){var o,r,a,h,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return h={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h;function verb(h){return function(c){return function step(h){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=2&h[0]?r.return:h[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,h[1])).done)return a;switch(r=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return l.label++,{value:h[1],done:!1};case 5:l.label++,r=h[1],h=[0];continue;case 7:h=l.ops.pop(),l.trys.pop();continue;default:if(!(a=l.trys,(a=a.length>0&&a[a.length-1])||6!==h[0]&&2!==h[0])){l=0;continue}if(3===h[0]&&(!a||h[1]>a[0]&&h[1]<a[3])){l.label=h[1];break}if(6===h[0]&&l.label<a[1]){l.label=a[1],a=h;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(h);break}a[2]&&l.ops.pop(),l.trys.pop();continue}h=i.call(t,l)}catch(t){h=[6,t],r=0}finally{o=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([h,c])}}},y=function(t){function LoadingScene(){var i=t.call(this,{key:LoadingScene.name})||this;return i.mRequestCom=!1,i}return m(LoadingScene,t),LoadingScene.prototype.preload=function(){var t=2;this.mWorld&&(t=this.mWorld.uiRatio||2),this.load.image("avatar_placeholder",h.i.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",h.i.getUIRes(t,"loading/curtain.png"),h.i.getUIRes(t,"loading/curtain.json")),this.load.atlas("loading",h.i.getRes("ui/loading/loading.png"),h.i.getRes("ui/loading/loading.json")),this.load.script("webfont","./resources/scripts/webfont/1.6.26/webfont.js")},LoadingScene.prototype.init=function(t){this.createFont(),this.mWorld=t.world,this.mRoom=t.room,this.mRequestCom=!1,this.mCallback=t.callBack,this.tipsText=t.text},LoadingScene.prototype.create=function(){try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){l.a.getInstance().warn("webfont failed to load")}var t=this.scale.gameSize.width,i=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1});var o=this.mWorld.uiRatio;this.bg=this.add.sprite(.5*t,.5*i,"loading").setScale(this.mWorld.uiScale*o*2),this.bg.play("loading_anis"),this.curtain=new g(this,this.mWorld),this.progressText=this.add.text(this.bg.x,this.bg.y+.5*this.bg.displayHeight,this.tipsText,{fontSize:12*o,fontFamily:u.a.DEFULT_FONT}).setOrigin(.5);this.add.text(t-4*o,i-4*o,"v"+d.a+" "+this.getDebug(),{fontSize:12*o,fontFamily:u.a.DEFULT_FONT}).setOrigin(1);this.checkSize(new a.a(t,i)),this.mCallback&&(this.mCallback.call(this,this),this.mCallback=void 0),this.scale.on("resize",this.checkSize,this)},LoadingScene.prototype.show=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.awake(),this.curtain?(this.bg&&(this.bg.visible=!1),[2,this.curtain.open()]):[2,Promise.resolve()]}))}))},LoadingScene.prototype.close=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return this.mShow=!1,this.curtain?(this.bg&&(this.bg.visible=!1),[2,this.curtain.close()]):[2]}))}))},LoadingScene.prototype.awake=function(t){this.mShow=!0,this.scale.on("resize",this.checkSize,this),this.scene.wake(),t&&(this.tipsText=t.text,t.text&&this.progressText&&this.progressText.active&&this.progressText.setText(t.text))},LoadingScene.prototype.sleep=function(){var t=this;this.progressText&&this.progressText.active&&this.progressText.setText(""),this.curtain?(this.bg&&(this.bg.visible=!1),this.curtain.close().then((function(){t.scale.off("resize",t.checkSize,t),t.scene.sleep()}))):(this.scale.off("resize",this.checkSize,this),this.scene.sleep())},LoadingScene.prototype.appendProgress=function(t){this.progressText&&this.progressText.setText(t)},LoadingScene.prototype.getKey=function(){return this.sys.config.key},LoadingScene.prototype.getDebug=function(){var t="WebGL",i=this.game.config;i.renderType===Phaser.CANVAS?t="Canvas":i.renderType===Phaser.HEADLESS&&(t="Headless");var o=i.audio,r=this.game.device.audio;return"("+t+" | "+(!r.webAudio||o&&o.disableWebAudio?o&&o.noAudio||!r.webAudio&&!r.audioData?"No Audio":"HTML5 Audio":"Web Audio")+")"},LoadingScene.prototype.checkSize=function(t){},LoadingScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var i=t.sheet;i.insertRule("@font-face { font-family: 'tt0173m_'; src: url('./resources/fonts/en/tt0173m_.ttf') format('truetype');font-display:swap }\n",0),i.insertRule("@font-face { font-family: 'tt0503m_'; src: url('./resources/fonts/en/tt0503m_.ttf') format('truetype'); font-display:swap}\n",0),i.insertRule("@font-face { font-family: 't04B25'; src: url('./resources/fonts/04B.ttf') format('truetype'); font-display:swap}",0)},LoadingScene}(c.a),g=function(){function Curtain(t,i){this.scene=t,this.key="curtain",this.upDisplay=this.scene.add.image(0,0,this.key,"up.png").setOrigin(0).setVisible(!1).setScale(i.uiScale),this.downDisplay=this.scene.add.image(0,0,this.key,"down.png").setOrigin(0,1).setVisible(!1).setScale(i.uiScale)}return Curtain.prototype.open=function(){var t=this;return this.upDisplay.visible=!0,this.downDisplay.visible=!0,new Promise((function(i,o){if(t.scene.cameras.main){var r=t.scene.cameras.main.height;t.upDisplay.y=-t.upDisplay.displayHeight,t.downDisplay.y=r+t.downDisplay.displayHeight,t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:0},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:r},duration:1e3,onComplete:function(){t.upDisplay.visible=!1,t.downDisplay.visible=!1,t.clearTween(),i()}})}else i()}))},Curtain.prototype.close=function(){var t=this;return this.downDisplay.visible=!0,this.upDisplay.visible=!0,new Promise((function(i,o){if(t.scene.cameras.main){var r=t.scene.cameras.main.height;t.upDisplay.y=0,t.downDisplay.y=r,t.upTween=t.scene.add.tween({targets:t.upDisplay,props:{y:-t.upDisplay.displayHeight},duration:1e3}),t.downTween=t.scene.add.tween({targets:t.downDisplay,props:{y:r+t.downDisplay.displayHeight},duration:1e3,onComplete:function(){t.downDisplay.visible=!1,t.upDisplay.visible=!1,t.clearTween(),i()}})}else i()}))},Curtain.prototype.destroy=function(){this.destroy()},Curtain.prototype.clearTween=function(){this.upTween&&(this.upTween.stop(),this.upTween=null),this.downTween&&(this.downTween.stop(),this.downTween=null)},Curtain}()},function(t,i,o){"use strict";o.r(i),o.d(i,"DragType",(function(){return a})),o.d(i,"DropType",(function(){return h})),o.d(i,"BagMediator",(function(){return m}));var r,a,h,l=o(119),c=o(0),u=o(192),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)});!function(t){t[t.DRAG_TYPE_SHORTCUT=1]="DRAG_TYPE_SHORTCUT",t[t.DRAG_TYPE_BAG=2]="DRAG_TYPE_BAG"}(a||(a={})),function(t){t[t.DROP_TYPE_SHORTCUT=1]="DROP_TYPE_SHORTCUT",t[t.DROP_TYPE_BAG=2]="DROP_TYPE_BAG"}(h||(h={}));var m=function(t){function BagMediator(i,o,r){var a=t.call(this)||this;return a.mPageNum=0,a.mLayerManager=i,a.world=o,a.mScene=r,a.mUIType=p.UIType.Normal,a}return d(BagMediator,t),BagMediator.prototype.resize=function(t,i){this.mView&&this.mView.resize(t,i)},BagMediator.prototype.isSceneUI=function(){return!1},BagMediator.prototype.isShow=function(){if(this.mView)return this.mView.isShow()},BagMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||(this.mView||(this.mView=new u.BagPanel(this.mScene,this.world)),this.world.emitter.on(l.a.SCENE_SYNCHRO_PACKAGE,this.handleSynchroPackage,this),this.world.emitter.on(l.a.UPDATED_CHARACTER_PACKAGE,this.onUpdatePackageHandler,this),this.world.emitter.on(l.a.QUERY_PACKAGE,this.handleSynchroPackage,this),this.mScene.input.on("gameobjectdown",this.onBtnHandler,this),i?this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(i[0].id,1,u.BagPanel.PageMaxCount):this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(this.world.roomManager.currentRoom.playerManager.actor.package.id,1,u.BagPanel.PageMaxCount),this.mView.show(i),this.mLayerManager.addToUILayer(this.mView),this.world.uiManager.checkUIState(BagMediator.NAME,!1),this.refrehView(),t.prototype.show.call(this,i))},BagMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},BagMediator.prototype.hide=function(){this.world.emitter.off(l.a.DRAG_TO_DROP,this.handleDrop,this),this.world.emitter.off(l.a.SCENE_SYNCHRO_PACKAGE,this.handleSynchroPackage,this),this.world.emitter.off(l.a.UPDATED_CHARACTER_PACKAGE,this.onUpdatePackageHandler,this),this.world.emitter.off(l.a.QUERY_PACKAGE,this.handleSynchroPackage,this),this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),this.mView&&(this.mView.hide(),this.mView=null,this.world.uiManager.checkUIState(BagMediator.NAME,!0))},BagMediator.prototype.destroy=function(){this.world.emitter.off(l.a.DRAG_TO_DROP,this.handleDrop,this),this.world.emitter.off(l.a.SCENE_SYNCHRO_PACKAGE,this.handleSynchroPackage,this),this.world.emitter.off(l.a.UPDATED_CHARACTER_PACKAGE,this.onUpdatePackageHandler,this),this.world.emitter.off(l.a.QUERY_PACKAGE,this.handleSynchroPackage,this),this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),this.mView&&(this.mView.destroy(),this.mView=null),this.mPageNum=0,this.mScene=null,this.world=null},BagMediator.prototype.handleDrop=function(t){var i=t[0];t[1].getDropType()===h.DROP_TYPE_BAG&&i.getDragType()===a.DRAG_TYPE_SHORTCUT&&c.a.getInstance().debug("背包拖到快捷栏了！！！")},BagMediator.prototype.refrehView=function(t){var i;if(t)i=t;else{var o=this.world.roomManager.currentRoom.playerManager.actor.package;if(null==o)return;i=o.items}this.setListData(i)},BagMediator.prototype.onBtnHandler=function(t,i){i instanceof p.InputText||this.mView&&this.mView.setBlur()},BagMediator.prototype.setListData=function(t){this.mView.setDataList()},BagMediator.prototype.handleSynchroPackage=function(){var t=this.world.roomManager.currentRoom.playerManager.actor.package.items;this.refrehView(t)},BagMediator.prototype.onUpdatePackageHandler=function(){var t=this.world.roomManager.currentRoom.playerManager.actor.package.items;this.refrehView(t)},BagMediator.NAME="BagMediator",BagMediator}(p.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemSlot",(function(){return u}));var r=o(2),a=o(145),h=o(110),l=o(111),c=o(158),u=function(){function ItemSlot(t,i,o,r,a,h,l,c,u,p,d){this.minitialize=!1,this.mWid=0,this.mHei=0,this.isTipBoo=!0,this.mScene=t,this.mWorld=i,this.toolTipCon=t.make.container(void 0,!1),this.toolTipCon.x=r,this.toolTipCon.y=a,o.add(this.toolTipCon),this.mResStr=h,this.mResPng=l,this.mResJson=c,this.mResSlot=u,this.mSubScriptRes=d,this.mSelectRes=p}return Object.defineProperty(ItemSlot.prototype,"hasTip",{get:function(){return this.isTipBoo},set:function(t){this.isTipBoo=t},enumerable:!1,configurable:!0}),ItemSlot.prototype.createUI=function(){this.onLoadCompleteHandler()},ItemSlot.prototype.getView=function(){return this.toolTipCon},ItemSlot.prototype.getBg=function(){return this.itemBG},ItemSlot.prototype.getIcon=function(){return this.mIcon},ItemSlot.prototype.dataChange=function(t){var i=this;if(this.minitialize)if(this.mData=t,this.mIcon){var o=void 0;if(this.mData&&this.mData.display){o=this.mData.display.texturePath;this.mData.des&&this.mData.des;this.setToolTipData(this.mData.name+this.mData.des)}else this.mIcon.icon.visible=!1;if(!o)return;this.mScene.textures.exists(l.i.getOsdRes(o))?this.mData&&(this.mIcon.icon.setTexture(l.i.getOsdRes(o)),this.mIcon.icon.visible=!0):this.mIcon.load(o,this,(function(){i.mData&&(i.mIcon.icon.visible=!0)}))}else this.mIcon.icon.visible=!1},ItemSlot.prototype.destroy=function(){this.mSubScriptSprite&&(this.mSubScriptSprite.destroy(!0),this.mSubScriptSprite=null),this.mSelectSprite&&(this.mSelectSprite.destroy(!0),this.mSelectSprite=null),this.mIcon&&this.mIcon.destroy(),this.toolTipCon&&(this.toolTipCon.destroy(),this.toolTipCon=null),this.toolTip&&(this.toolTip.destroy(),this.toolTip=null),this.mAnimationCon&&(this.mAnimationCon.destroy(!0),this.mAnimationCon=null),this.itemBG&&(this.itemBG.destroy(!0),this.itemBG=null),this.index=0,this.mData=null,this.mScene=null,this.mWorld=null,this.mResStr=null,this.mResPng=null,this.mResSlot=null,this.mResJson=null,this.mSubScriptRes=null,this.mSelectRes=null,this.mWorld=null,this.minitialize=!1,this.mWid=0,this.mHei=0,this.mData=null,this.isTipBoo=!0},ItemSlot.prototype.setToolTipData=function(t){this.toolTip&&this.toolTip.setToolTipData(t)},ItemSlot.prototype.onLoadCompleteHandler=function(){this.itemBG=this.mScene.make.sprite(void 0,!1),this.itemBG.setTexture(this.mResStr,this.mResSlot),this.toolTipCon.addAt(this.itemBG,0),this.toolTipCon.setSize(this.itemBG.width,this.itemBG.height),this.mIcon=new a.DragDropIcon(this.mScene,0,0),this.toolTipCon.addAt(this.mIcon,1),this.mSubScriptRes&&(this.mSubScriptSprite=this.mScene.make.sprite(void 0,!1),this.mSubScriptSprite.setTexture(this.mResStr,this.mSubScriptRes),this.mSubScriptSprite.x=this.mSubScriptSprite.width-this.itemBG.width>>1,this.mSubScriptSprite.y=this.mSubScriptSprite.height-this.itemBG.height>>1),this.isTipBoo&&(this.toolTip=new c.ToolTip(this.mScene,"itemSlotTip",l.i.getRes("ui/toolTip/toolTip.json"),l.i.getRes("ui/toolTip/toolTip.png"),this.mWorld.uiScale)),this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0,0,this.itemBG.width,56),Phaser.Geom.Rectangle.Contains),this.toolTipCon.on("pointerover",this.overHandler,this),this.toolTipCon.on("pointerout",this.outHandler,this),this.toolTipCon.on("pointerdown",this.downHandler,this),this.toolTipCon.on("pointerup",this.outHandler,this),this.minitialize=!0,this.mData&&this.dataChange(this.mData),this.mWid+=this.itemBG.width,this.mHei+=this.itemBG.height},ItemSlot.prototype.downHandler=function(t){if(this.mData&&this.mWorld.roomManager.currentRoom.playerManager.actor&&this.mWorld.roomManager.currentRoom&&this.mWorld.roomManager.currentRoom.playerManager){var i=this.mWorld.roomManager.currentRoom.playerManager.actor.package,o=new h.PBpacket(r.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),a=o.content;a.uiId=i.id,a.componentId=this.mData.id,this.mWorld.connection.send(o)}},ItemSlot.prototype.overHandler=function(t){this.toolTip&&this.mData&&(this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this.toolTip),this.toolTip.setToolTipData(this.mData.name+this.mData.des),this.toolTip.x=t.x,this.toolTip.y=t.y),this.mSelectRes&&this.mSelectRes.length>0&&(this.mSelectSprite=this.mScene.make.sprite(void 0,!1),this.mSelectSprite.play(this.mSelectRes),this.toolTipCon.add(this.mSelectSprite))},ItemSlot.prototype.outHandler=function(t){this.toolTip&&this.toolTip.parentContainer&&this.toolTip.parentContainer.remove(this.toolTip),this.mSelectSprite&&this.mSelectSprite.parentContainer&&(this.mSelectSprite.parentContainer.remove(this.mSelectSprite),this.mSelectSprite.destroy(!0),this.mSelectSprite=null)},ItemSlot}()},function(t,i,o){"use strict";o.r(i),o.d(i,"BaseFaceMediator",(function(){return l}));var r,a=o(109),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function BaseFaceMediator(i,o){var r=t.call(this)||this;return r.mScene=o,r.world=i,r.mUIType=a.UIType.Scene,r}return h(BaseFaceMediator,t),BaseFaceMediator.prototype.getView=function(){return this.mView},BaseFaceMediator.prototype.isSceneUI=function(){return!0},BaseFaceMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},BaseFaceMediator.prototype.resize=function(){var t=this.world.getSize(),i=this.getView();if(this.mView&&i.isShow())return this.mView.resize(t.width,t.height)},BaseFaceMediator.prototype.hide=function(){this.mShow=!1,this.mView&&this.mView.hide()},BaseFaceMediator.prototype.destroy=function(){t.prototype.destroy.call(this)},BaseFaceMediator}(a.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"AlertView",(function(){return d})),o.d(i,"Buttons",(function(){return a}));var r,a,h=o(112),l=o(113),c=o(114),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function AlertView(i,o){var r=t.call(this,i,o)||this;return r.key="pica_alert",r.disInteractive(),r}return p(AlertView,t),AlertView.prototype.show=function(i){if(this.mShowData=i,t.prototype.show.call(this,i),this.mInitialized){this.mWorld.uiManager.getUILayerManager().addToDialogLayer(this);var o=i.ox,r=i.oy;this.x=o||this.scene.cameras.main.width/2,this.y=r||this.scene.cameras.main.height/2,this.mContent.setText(i.text),i.title&&this.mTitleLabel.setText(i.title);var h=i.btns;h===a.Cancel?(this.remove(this.mOkBtn),this.mCancelBtn.x=0):h===a.Ok&&(this.remove(this.mCancelBtn),this.mOkBtn.x=0)}},AlertView.prototype.preload=function(){this.addAtlas(this.key,"pica_alert/pica_alert.png","pica_alert/pica_alert.json"),t.prototype.preload.call(this)},AlertView.prototype.setOKText=function(t){return this.mOkText=t,this.mOkBtn&&this.mOkBtn.setText(t),this},AlertView.prototype.init=function(){var i=this.mWorld.uiScale||1,o=this.scene.make.image({key:this.key,frame:"bg.png"},!1),r=this.scene.make.image({key:this.key,frame:"title.png"},!1);r.y=-o.height/2,this.mTitleLabel=this.scene.make.text({text:c.a.t("common.tips"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:12*this.dpr*i,color:"#905B06"}},!1).setOrigin(.5),this.mTitleLabel.y=r.y,this.mContent=new u.BBCodeText(this.scene,0,-11*this.dpr,"",{fontSize:12*this.dpr*i+"px",fontFamily:l.a.DEFULT_FONT,color:"#0",wrap:{mode:"char",width:218*this.dpr}}),this.mContent.setOrigin(.5,.5),this.mOkBtn=new u.Button(this.scene,this.key,"yellow_btn.png",void 0,this.mOkText||c.a.t("common.confirm")),this.mOkBtn.setTextStyle({color:"#905B06",fontFamily:l.a.DEFULT_FONT,fontSize:13*this.dpr*i}),this.mOkBtn.x=(o.width-this.mOkBtn.displayWidth)/2-38*this.dpr,this.mOkBtn.y=(o.height-this.mOkBtn.displayHeight)/2-16*this.dpr,this.mOkBtn.on("Tap",this.onOkHandler,this),this.mCancelBtn=new u.Button(this.scene,this.key,"red_btn.png",void 0,c.a.t("common.cancel")),this.mCancelBtn.setTextStyle({fontFamily:l.a.DEFULT_FONT,fontSize:13*this.dpr*i}),this.mCancelBtn.x=-(o.width-this.mCancelBtn.displayWidth)/2+38*this.dpr,this.mCancelBtn.y=this.mOkBtn.y,this.mCancelBtn.on("Tap",this.onCancelHandler,this),this.add([o,r,this.mTitleLabel,this.mTitleLabel,this.mContent,this.mOkBtn,this.mCancelBtn]),t.prototype.init.call(this)},AlertView.prototype.onOkHandler=function(){if(this.mShowData){var t=this.mShowData.callback;t&&t.call(this.mShowData.content),this.onCancelHandler()}},AlertView.prototype.onCancelHandler=function(){this.parentContainer&&this.parentContainer.remove(this)},AlertView}(h.BasePanel);!function(t){t[t.Ok=0]="Ok",t[t.Cancel=1]="Cancel",t[t.OKAndCancel=2]="OKAndCancel"}(a||(a={}))},,function(t,i,o){"use strict";o.d(i,"a",(function(){return a})),o.d(i,"b",(function(){return d}));var r,a,h=o(174),l=o(116),c=o(111),u=o(337),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)});!function(t){t[t.BACKEND=0]="BACKEND",t[t.STAGE=1]="STAGE",t[t.FRONTEND=2]="FRONTEND",t[t.FLAG=3]="FLAG",t[t.Effect=4]="Effect"}(a||(a={}));var d=function(t){function DisplayObject(i,o,r,a){void 0===a&&(a=!1);var h=t.call(this,i)||this;return h.mAlpha=1,h.mDirection=3,h.mAntial=!1,h.mElement=r,h.mRoomService=o,h.mAntial=a,h}return p(DisplayObject,t),DisplayObject.prototype.changeAlpha=function(t){this.mAlpha!==t&&(this.alpha=t,this.mAlpha=t)},DisplayObject.prototype.removeFromParent=function(){this.parentContainer&&this.parentContainer.remove(this)},DisplayObject.prototype.fadeIn=function(t){},DisplayObject.prototype.fadeOut=function(t){},DisplayObject.prototype.load=function(t,i){},DisplayObject.prototype.play=function(t,i,o){},DisplayObject.prototype.mount=function(t,i){},DisplayObject.prototype.unmount=function(t){},DisplayObject.prototype.removeEffect=function(t){},DisplayObject.prototype.removeDisplay=function(t){},DisplayObject.prototype.destroy=function(i){this.mFlagContainer&&(this.mNickname&&(this.mNickname.destroy(),this.mNickname=void 0),this.mBackEffect&&(this.mBackEffect.destroy(),this.mBackEffect=void 0),this.mFrontEffect&&(this.mFrontEffect.destroy(),this.mFrontEffect=void 0),this.clearBadges(),this.mFlagContainer.destroy(),this.mFlagContainer=void 0),this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0),this.mChildMap&&(this.mChildMap.clear(),this.mChildMap=null),t.prototype.destroy.call(this,i)},DisplayObject.prototype.setDisplayBadges=function(t){this.mBadges?this.clearBadges():this.mBadges=[];for(var i=0,o=t;i<o.length;i++){var r=o[i],a=new l.DynamicImage(this.scene,0,0);a.load(c.i.getOsdRes(r.thumbnail),this,this.layouFlag),this.flagContainer.add(a),this.mBadges.push(a)}},DisplayObject.prototype.showRefernceArea=function(){this.mReferenceArea||(this.mReferenceArea=new u.a(this.scene,this.mRoomService),this.addChildMap("reference",this.mReferenceArea)),!this.mCollisionArea||this.mCollisionArea.length<=0||(this.mReferenceArea.draw(this.mCollisionArea,this.mOriginPoint),this.addAt(this.mReferenceArea,0))},DisplayObject.prototype.hideRefernceArea=function(){this.mReferenceArea&&(this.mReferenceArea.destroy(),this.mReferenceArea=void 0)},DisplayObject.prototype.scaleTween=function(){},DisplayObject.prototype.showEffect=function(){this.addEffect(this.mBackEffect,c.i.getRes("ui/vip/vip_effect_back.png"),c.i.getRes("ui/vip/vip_effect_back.json"),!0,15,!1,!0),this.addEffect(this.mFrontEffect,c.i.getRes("ui/vip/vip_effect_front.png"),c.i.getRes("ui/vip/vip_effect_front.json"),!0,15,!1,!0)},DisplayObject.prototype.getElement=function(t){if(this.mChildMap)return this.mChildMap.get(t)},DisplayObject.prototype.addEffect=function(t,i,o,r,l,c,u){t||(t=new h.DynamicSprite(this.scene,0,0)),t.load(i,o),t.y=-20,r?this.addAt(t,a.BACKEND):this.addAt(t,a.FRONTEND),t.once(Phaser.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){t.destroy()}))},DisplayObject.prototype.layouFlag=function(t){if(void 0===t&&(t=4),this.mFlagContainer){this.mFlagContainer.y=-96,this.bringToTop(this.mNickname);for(var i=0,o=0,r=this.mFlagContainer.list;o<r.length;o++){var a=r[o];a.x=i,a.width&&(i=a.width)}}},DisplayObject.prototype.clearBadges=function(){if(this.mBadges){for(var t=0,i=this.mBadges;t<i.length;t++){i[t].destroy()}this.mBadges.length=0}},Object.defineProperty(DisplayObject.prototype,"flagContainer",{get:function(){return this.mFlagContainer||(this.mFlagContainer=this.scene.make.container(void 0,!1),this.addAt(this.mFlagContainer,a.FLAG)),this.mFlagContainer},enumerable:!1,configurable:!0}),DisplayObject.prototype.addChildMap=function(t,i){this.mChildMap||(this.mChildMap=new Map),this.mChildMap.set(t,i)},DisplayObject.prototype.removeChildMap=function(t){this.mChildMap&&this.mChildMap.delete(t)},Object.defineProperty(DisplayObject.prototype,"topPoint",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"sortX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"sortY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"sortZ",{get:function(){return this.z||0},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"element",{get:function(){return this.mElement},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"collisionArea",{get:function(){return this.mCollisionArea},enumerable:!1,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"originPoint",{get:function(){return this.mOriginPoint},enumerable:!1,configurable:!0}),DisplayObject}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(118),a=function(){function Position45(){}return Position45.transformTo90=function(t,i){var o=i.rows*(i.tileWidth/2);return new r.a((t.x-t.y)*(i.tileWidth/2)+o,(t.x+t.y)*(i.tileHeight/2))},Position45.transformTo45=function(t,i){var o=i.rows*(i.tileWidth/2);return new r.a(Math.floor((t.y+t.z)/i.tileHeight+(t.x-o)/i.tileWidth),Math.floor((t.y+t.z)/i.tileHeight-(t.x-o)/i.tileWidth))},Position45}()},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFriendRelation",(function(){return a})),o.d(i,"FriendRelationEnum",(function(){return r}));var r,a=function(){function PicFriendRelation(){}return PicFriendRelation.check=function(t,i,o){var a=r.Null;if(o.length>0){if(o[0].ban)return{id:i,relation:r.Blacklist};o[0].followed_user===i?a=r.Followed:o[0].followed_user===t&&(a=r.Fans),o.length>=2&&o[0].user===o[1].followed_user&&o[1].followed_user===o[0].user&&(a=r.Friend)}return{id:i,relation:a}},PicFriendRelation}();!function(t){t.Null="null",t.Friend="friend",t.Fans="fans",t.Followed="followed",t.Blacklist="blacklist"}(r||(r={}))},,function(t,i,o){"use strict";o.d(i,"a",(function(){return u}));var r,a=o(0),h=o(137),l=o(111),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function FramesDisplay(){var i=null!==t&&t.apply(this,arguments)||this;return i.mDisplayDatas=new Map,i.mSprites=new Map,i.mDisplays=[],i}return c(FramesDisplay,t),FramesDisplay.prototype.load=function(t,i){var o=this;i=i||h.a.STAGE;var r=t;if(r&&r.gene){var c=this.mDisplayDatas.get(i);if(!c||c.gene!==t.gene)if(this.mDisplayDatas.set(i,r),this.setData("id",r.id),this.scene.textures.exists(r.gene))this.onLoadCompleted(i);else{var u=r.display;if(u||a.a.getInstance().error("display is undefined"),""===u.texturePath&&""===u.dataPath)a.a.getInstance().error("动画资源报错：",r);else{this.scene.load.atlas(r.gene,l.i.OSD_PATH+u.texturePath,l.i.OSD_PATH+u.dataPath);var cb_1=function(t){o.onAddTextureHandler(t,i,cb_1)};this.scene.textures.on(Phaser.Textures.Events.ADD,cb_1,this),this.scene.load.start()}}}},FramesDisplay.prototype.play=function(t,i,o){if(t){i=i||h.a.STAGE;var r=this.mDisplayDatas.get(i);if(!1!==this.scene.textures.exists(r.gene)&&(this.mCurAnimation=r.getAnimations(t.name),this.mCurAnimation)){this.clear();var a=this.mCurAnimation.layer,l=this.mSprites.get(h.a.STAGE);l||((l=this.scene.make.container(void 0,!1)).setData("id",r.id),this.addAt(l,h.a.STAGE),this.mSprites.set(h.a.STAGE,l));for(var c=0;c<a.length;c++){var u=void 0,p=a[c],d=p.frameName,m=p.offsetLoc;if(d.length>1){var y=r.gene+"_"+t.name+"_"+c;this.makeAnimation(r.gene,y,a[c].frameName,a[c].frameVisible,this.mCurAnimation);var g=(u=this.scene.make.sprite(void 0,!1)).anims;g.play(y),"number"==typeof o&&g.setRepeat(o),this.mMainSprite||(this.mMainSprite=u)}else u=this.scene.make.image(void 0,!1).setTexture(r.gene,d[0]);this.mDisplays.push(u),u.scaleX=t.flip?-1:1;var _=m.x,v=m.y;t.flip&&(_=0-(u.width+_)),u.x=_+.5*u.width,u.y=v+.5*u.height,l.add(u)}if(this.initBaseLoc(h.a.STAGE,t),this.emit("updateAnimation"),this.mMainSprite&&this.mMainSprite.on(Phaser.Animations.Events.ANIMATION_REPEAT,this.onAnimationRepeatHander,this),this.mMountContainer&&this.mCurAnimation.mountLayer){var b=this.mSprites.get(h.a.STAGE);b&&b.addAt(this.mMountContainer,this.mCurAnimation.mountLayer.index)}this.mActionName=t}}},FramesDisplay.prototype.playEffect=function(){var t=this.mDisplayDatas.get(h.a.Effect);if(t){var i=t.getAnimations("idle");if(i){for(var o=i.layer,r=[],a=0;a<o.length;a++){var l=void 0,c=o[a],u=c.frameName,p=c.offsetLoc;if(u.length>1){var d=t.gene+"_idle_"+a;this.makeAnimation(t.gene,d,o[a].frameName,o[a].frameVisible,i),l=this.scene.make.sprite(void 0,!1).play(d)}else l=this.scene.make.image(void 0,!1).setTexture(t.gene,u[0]);l.x=p.x+.5*l.width,l.y=p.y+.5*l.height,r.push(l)}r.length>1&&(this.addAt(r[1],h.a.BACKEND),this.mSprites.set(h.a.BACKEND,r[1])),this.addAt(r[0],h.a.FRONTEND),this.mSprites.set(h.a.FRONTEND,r[0])}}},FramesDisplay.prototype.mount=function(t,i){if(t&&!(this.mDisplays.length<=0)&&this.mCurAnimation)if(this.mCurAnimation.mountLayer){var o=this.mCurAnimation.mountLayer,r=o.index,l=o.mountPoint;if(void 0===i&&(i=0),i>=l.length)a.a.getInstance().error("mount index does not exist");else{var c=l[i].x;if(this.mActionName.flip&&(c=0-c),t.x=c,t.y=l[i].y,this.mMountContainer||(this.mMountContainer=this.scene.make.container(void 0,!1)),!this.mMountContainer.parentContainer){var u=this.mSprites.get(h.a.STAGE);u&&u.addAt(this.mMountContainer,r)}this.mMountContainer.addAt(t,i),this.mMountList[i]=t,this.mMainSprite&&(this.mMainSprite.off("animationupdate",this.onAnimationUpdateHandler,this),this.mMainSprite.on("animationupdate",this.onAnimationUpdateHandler,this))}}else a.a.getInstance().error("mountLyaer does not exist "+(this.element?this.element.id:0))},FramesDisplay.prototype.unmount=function(t){if(this.mMountContainer){this.mMountContainer.remove(t);var i=this.mMountList.indexOf(t);t.visible=!0,i>-1&&this.mMountList.splice(i,1),this.mMountContainer.list.length<=0&&this.mDisplays.length>0&&this.mDisplays[0].off("animationupdate",this.onAnimationUpdateHandler,this)}},FramesDisplay.prototype.fadeIn=function(t){0!==this.mAlpha&&(this.alpha=0,this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:this.mAlpha,duration:1200,onComplete:function(){t&&t()}}))},FramesDisplay.prototype.fadeOut=function(t){this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:0,duration:1200,onComplete:function(){t&&t()}})},FramesDisplay.prototype.scaleTween=function(){var t=this;if(!(this.mMountContainer&&this.mMountContainer.list.length>0||this.mScaleTween)){var i=this.scale;this.mScaleTween=this.scene.tweens.add({targets:this,duration:100,scale:1.25*i,yoyo:!0,repeat:0,onComplete:function(){t.scale=1,t.mScaleTween&&(t.mScaleTween=void 0)}})}},FramesDisplay.prototype.setInteractive=function(t,i,o){return this.mDisplays.forEach((function(t){t.setInteractive({pixelPerfect:!0})})),this},FramesDisplay.prototype.disableInteractive=function(){return this.mDisplays.forEach((function(t){t.disableInteractive()})),this},FramesDisplay.prototype.removeEffect=function(){this.mDisplayDatas.get(h.a.Effect)&&(this.mDisplayDatas.delete(h.a.Effect),this.removeDisplay(h.a.BACKEND),this.removeDisplay(h.a.FRONTEND))},FramesDisplay.prototype.removeDisplay=function(t){var i=this.mSprites.get(t);i&&(this.mDisplayDatas.delete(t),i.destroy())},FramesDisplay.prototype.destroy=function(){this.mSprites.forEach((function(t){return t.destroy()})),this.mSprites.clear(),this.clear(),this.mFadeTween&&(this.clearFadeTween(),this.mFadeTween=void 0),this.mScaleTween&&(this.mScaleTween.stop(),this.mScaleTween=void 0),this.mDisplayDatas.clear(),t.prototype.destroy.call(this)},FramesDisplay.prototype.createDisplay=function(t,i){for(var o,r=i.layer,a=0;a<r.length;a++){if(r[a].frameName.length>1){o=this.scene.make.sprite(void 0,!1);i.name;this.makeAnimation(t,t,r[a].frameName,r[a].frameVisible,this.mCurAnimation),o=this.scene.make.sprite(void 0,!1)}else o=this.scene.make.image(void 0,!1);this.mDisplays.push(o)}},FramesDisplay.prototype.clearFadeTween=function(){this.mFadeTween&&(this.mFadeTween.stop(),this.mFadeTween.remove())},FramesDisplay.prototype.clear=function(){for(var t=0,i=this.mDisplays;t<i.length;t++){i[t].destroy()}this.mMountContainer&&this.mMountContainer.parentContainer&&this.mMountContainer.parentContainer.remove(this.mMountContainer),this.mMountList=[],this.mDisplays=[],this.mMainSprite=null},FramesDisplay.prototype.onAddTextureHandler=function(t,i,o){void 0===i&&(i=h.a.STAGE);var r=this.mDisplayDatas.get(i);r&&r.gene===t&&(this.scene.textures.off(Phaser.Textures.Events.ADD,o,this),this.onLoadCompleted(i))},FramesDisplay.prototype.onLoadCompleted=function(t){var i=this.mDisplayDatas.get(t);i&&this.scene.textures.exists(i.gene)&&(t===h.a.STAGE?this.emit("initialized",this):this.playEffect())},FramesDisplay.prototype.makeAnimation=function(t,i,o,r,a){var h=a.loop;if(!(r&&o.length!==r.length||this.scene.anims.exists(i))){for(var l=[],c=0;c<o.length;c++){var u=o[c],p=!r||r[c];l.push({key:t,frame:u,visible:p})}var d=h?-1:0,m={key:i,frames:l,frameRate:a.frameRate,repeat:d};this.scene.anims.create(m)}},FramesDisplay.prototype.initBaseLoc=function(t,i){var o=this.mDisplayDatas.get(t);if(!(this.mDisplays.length<1)&&o&&o.animations){var r=i.name,a=i.flip;this.mCollisionArea=o.getCollisionArea(r,a),this.mOriginPoint=o.getOriginPoint(r,a),this.mReferenceArea&&this.showRefernceArea()}},FramesDisplay.prototype.onAnimationRepeatHander=function(){var t=this.mActionName.playingQueue;void 0===t.playedTimes?t.playedTimes=1:t.playedTimes++,t.playedTimes>=t.playTimes&&(this.mMainSprite&&this.mMainSprite.off(Phaser.Animations.Events.ANIMATION_REPEAT,this.onAnimationRepeatHander,this),t.complete&&(t.complete.call(this),delete t.complete))},FramesDisplay.prototype.onAnimationUpdateHandler=function(t,i){if(this.mMountContainer&&this.mCurAnimation){var o=this.mCurAnimation.mountLayer.frameVisible;if(o){var r=i.index-1;if(!(r>o.length))for(var a=0;a<this.mMountList.length;a++)this.mMountList[a].visible=this.getMaskValue(o[r],a)}}},FramesDisplay.prototype.getMaskValue=function(t,i){return(t>>i)%2==1},Object.defineProperty(FramesDisplay.prototype,"spriteWidth",{get:function(){var t=0;if(this.mDisplays)for(var i=0,o=this.mDisplays;i<o.length;i++){var r=o[i];r.width>t&&(t=r.width)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(FramesDisplay.prototype,"spriteHeight",{get:function(){var t=0;if(this.mDisplays)for(var i=0,o=this.mDisplays;i<o.length;i++){var r=o[i];r.height>t&&(t=r.height)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(FramesDisplay.prototype,"topPoint",{get:function(){return new Phaser.Geom.Point(0,-this.spriteHeight)},enumerable:!1,configurable:!0}),FramesDisplay}(h.b)},function(t,i,o){"use strict";o.d(i,"a",(function(){return p}));var r=o(2),a=o(0),h=o(407),l=o(155),c=o(126),u=o(122),p=function(){function FramesModel(t){this.discriminator="FramesModel",this.id=t.id||0,this.type=t.sn||"";var i=t.animations;i&&(this.animationName=i.defaultAnimationName,this.setDisplay(i.display),this.setAnimationData(i.animationData))}return FramesModel.prototype.setInfo=function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])},FramesModel.prototype.getAnimationData=function(){return this.animations},FramesModel.prototype.existAnimation=function(t){return!!this.animations&&this.animations.has(t)},FramesModel.prototype.getAnimations=function(t){if(this.animations)return this.animations.get(t)},FramesModel.prototype.destroy=function(){this.animations&&this.animations.clear()},Object.defineProperty(FramesModel.prototype,"gene",{get:function(){return this.mGen},enumerable:!1,configurable:!0}),FramesModel.prototype.createProtocolObject=function(){var t=[];return this.animations.forEach((function(i){t.push(i.createProtocolObject())}),this),t},FramesModel.prototype.getCollisionArea=function(t,i){void 0===i&&(i=!1);var o=this.getAnimations(t);if(o)return i?l.a.flipArray(o.collisionArea):o.collisionArea},FramesModel.prototype.getWalkableArea=function(t,i){void 0===i&&(i=!1);var o=this.getAnimations(t);return i?l.a.flipArray(o.walkableArea):o.walkableArea},FramesModel.prototype.getInteractiveArea=function(t){var i=this.getAnimations(t);return i?i.interactiveArea:void 0},FramesModel.prototype.getOriginPoint=function(t,i){void 0===i&&(i=!1);var o=this.getAnimations(t);if(o){var r=o.originPoint;return i?new Phaser.Geom.Point(r.y,r.x):r}},FramesModel.prototype.getDirable=function(){},FramesModel.prototype.createSprite=function(t){var i=t.nodeType,o=t.x,a=t.y,h=t.z,u=t.id,p=t.dir,d=t.isMoss,m=r.op_client.Sprite.create();m.id=u||l.a.genId(),m.display=this.display,m.currentAnimationName=this.animationName;var y=r.op_def.PBPoint3f.create();return y.x=o,y.y=a,h&&(y.z=h),m.point3f=y,m.animations=this.createProtocolObject(),p&&(m.direction=p),void 0!==d&&(m.isMoss=d),new c.a(m,i)},FramesModel.prototype.findAnimation=function(t,i){var o=this.checkDirectionAnimation(t,i),r=!1;if(o)return{name:o,flip:r};switch(i){case u.a.west_south:case u.a.east_north:o=this.getDefaultAnimation(t);break;case u.a.south_east:o=this.getDefaultAnimation(t),r=!0;break;case u.a.north_west:null===(o=this.checkDirectionAnimation(t,u.a.east_north))&&(o=this.getDefaultAnimation(t)),r=!0}return{name:o,flip:r}},FramesModel.prototype.setDisplay=function(t){t?(this.display={dataPath:t.dataPath,texturePath:t.texturePath},this.mGen=h.sync(t.dataPath+t.texturePath)):a.a.getInstance().error(this.type+" display does not exist")},FramesModel.prototype.setAnimationData=function(t){if(t){this.animations=new Map;for(var i=0,o=t;i<o.length;i++){var r=o[i];this.animations.set(r.name,r)}}else a.a.getInstance().error(this.id+" animationData does not exist")},FramesModel.prototype.checkDirectionAnimation=function(t,i){var o=t+"_"+i;return this.existAnimation(o)?o:null},FramesModel.prototype.getDefaultAnimation=function(t){var i=this.checkDirectionAnimation(t,u.a.west_south);return null===i&&(this.existAnimation(t)?i=t:(a.a.getInstance().warn(FramesModel.name+": can't find animation "+t),i="idle")),i},FramesModel}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(2),a=function(){function Animation(t){var i=t.baseLoc.split(",");this.mNode=t.node,this.mID=t.node.id,this.mName=t.node.name,this.mFrameName=t.frameName,!t.frameName||this.mFrameName.length,this.mLoop=t.loop,t.loop,t.frameRate,t.originPoint,t.baseLoc,this.mFrameRate=t.frameRate,this.mBaseLoc=new Phaser.Geom.Point(parseInt(i[0],10),parseInt(i[1],10));var o=t.originPoint;this.mOriginPoint=new Phaser.Geom.Point(o[0],o[1]),"string"==typeof t.collisionArea?this.mCollisionArea=this.stringToArray(t.collisionArea,",","&")||[[0]]:this.mCollisionArea=t.collisionArea||[[0]],"string"==typeof t.walkableArea?this.mWalkableArea=this.stringToArray(t.walkableArea,",","&")||[[0]]:this.mWalkableArea=t.walkableArea||[[0]],this.mInteractiveArea=t.interactiveArea,this.mLayer=t.layer,this.mMountLayer=t.mountLayer}return Animation.prototype.createProtocolObject=function(){var t=r.op_gameconfig_01.AnimationData.create();t.node=this.mNode,t.baseLoc=this.baseLoc.x+","+this.baseLoc.y,t.node.name=this.name,t.loop=this.loop,t.frameRate=this.frameRate,t.frameName=this.frameName,t.originPoint=[this.originPoint.x,this.originPoint.y],t.walkOriginPoint=[this.originPoint.x,this.originPoint.y],t.walkableArea=this.arrayToString(this.mWalkableArea,",","&"),t.collisionArea=this.arrayToString(this.mCollisionArea,",","&"),t.interactiveArea=this.mInteractiveArea;for(var i=[],o=0,a=this.mLayer;o<a.length;o++){var h=a[o];i.push(r.op_gameconfig_01.AnimationLayer.create(h))}return t.layer=i,t.mountLayer=this.mMountLayer,t},Animation.prototype.stringToArray=function(t,i,o){if(t){for(var r=[],a=0,h=t.split(o);a<h.length;a++){var l=h[a].split(i);r.push(l.map((function(t){return parseInt(t,10)})))}return r}},Animation.prototype.arrayToString=function(t,i,o){if(!t)return"";for(var r=[],a=0,h=t;a<h.length;a++){var l=h[a];r.push(l.join(i))}return r.join(o)},Object.defineProperty(Animation.prototype,"baseLoc",{get:function(){return this.mBaseLoc},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"frameName",{get:function(){return this.mFrameName},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"frameRate",{get:function(){return this.mFrameRate},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"loop",{get:function(){return this.mLoop},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"name",{get:function(){return this.mName},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"collisionArea",{get:function(){return this.mCollisionArea},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"walkableArea",{get:function(){return this.mWalkableArea},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"originPoint",{get:function(){return this.mOriginPoint},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"interactiveArea",{get:function(){return this.mInteractiveArea},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"layer",{get:function(){return this.mLayer.length>0?this.mLayer:[{frameName:this.mFrameName,offsetLoc:this.mBaseLoc}]},enumerable:!1,configurable:!0}),Object.defineProperty(Animation.prototype,"mountLayer",{get:function(){return this.mMountLayer},enumerable:!1,configurable:!0}),Animation}()},function(t,i,o){"use strict";o.r(i),o.d(i,"ChatMediator",(function(){return y}));var r,a=o(110),h=o(2),l=o(0),c=o(184),u=o(186),p=o(187),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function ChatMediator(i,o){var r=t.call(this)||this;return r.mInRoom=!1,r.mAllMessage=[],r.mMaxMessageNum=50,r.world=i,r.mScene=o,r.chat=new p.Chat(i),r.mUIType=r.world.game.device.os.desktop?d.UIType.Scene:d.UIType.Normal,r}return m(ChatMediator,t),ChatMediator.prototype.getUIType=function(){return this.mUIType},ChatMediator.prototype.enterRoom=function(){if(this.room&&this.room.playerManager.actor&&this.mGMEApi){this.room.playerManager.actor.id;var t=this.room.id;this.mGMEApi.EnterRoom(t.toString(),1,this.mQCLoudAuth),this.mInRoom=!0,this.sendVoiceRoomStatus(h.op_def.ChatChannel.CurrentScene,t,h.op_def.VoiceRoomStatus.InVoiceRoom)}},ChatMediator.prototype.exitRoom=function(){this.mGMEApi&&(this.mGMEApi.EnableMic(!1),this.mGMEApi.ExitRoom(),this.mInRoom=!1,this.room&&this.sendVoiceRoomStatus(h.op_def.ChatChannel.CurrentScene,this.room.id,h.op_def.VoiceRoomStatus.OutsideVoiceRoom))},ChatMediator.prototype.isSceneUI=function(){return!0},ChatMediator.prototype.tweenView=function(t){this.mView&&this.mView.tweenExpand(t)},ChatMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},ChatMediator.prototype.showing=function(){return!0},ChatMediator.prototype.resize=function(){var t=this.world.getSize();this.mView&&this.mView.resize(t.width,t.height)},ChatMediator.prototype.show=function(t){this.mView&&this.mView.isShow()||(this.world.game.device.os.desktop?this.mView=new c.ChatPanelPC(this.mScene,this.world):(this.mView=new u.ChatPanelMobile(this.mScene,this.world),this.world.uiManager.checkUIState(ChatMediator.NAME,!1)),this.world.uiManager.getUILayerManager().addToUILayer(this.mView),this.addListen(),this.mView.show(),this.mView.scale=this.world.uiScale)},ChatMediator.prototype.update=function(t){this.mView.update(t),this.mParam=t},ChatMediator.prototype.hide=function(){this.removeListen(),this.mView.hide(),this.world.game.device.os.desktop||this.world.uiManager.checkUIState(ChatMediator.NAME,!0)},ChatMediator.prototype.setParam=function(t){this.mParam=t},ChatMediator.prototype.getParam=function(){return this.mParam},ChatMediator.prototype.destroy=function(){this.removeListen(),this.chat&&(this.chat.unregister(),this.chat=null),this.mGMEApi&&(this.mGMEApi=null),this.mScene=null,this.world=null,this.mInRoom=!1,this.mQCLoudAuth=null,this.mAllMessage.forEach((function(t){t&&(t=null)})),this.mAllMessage=null,t.prototype.destroy.call(this)},ChatMediator.prototype.addListen=function(){this.chat.on("characterChat",this.handleCharacterChat,this),this.chat.on("QCLoundGME",this.handleQCLoudGME,this),this.mView.on("sendChat",this.onSendChatHandler,this),this.mView.on("selectedVoice",this.onSelectedVoiceHandler,this),this.mView.on("selectedMic",this.onSelectedMicHandler,this),this.chat.register()},ChatMediator.prototype.removeListen=function(){this.chat.off("characterChat",this.handleCharacterChat,this),this.chat.off("QCLoundGME",this.handleQCLoudGME,this),this.mView.off("sendChat",this.onSendChatHandler,this),this.mView.off("selectedVoice",this.onSelectedVoiceHandler,this),this.mView.off("selectedMic",this.onSelectedMicHandler,this),this.chat.unregister()},ChatMediator.prototype.initGME=function(){var t=this;if(this.room.playerManager.actor){var i=this.room.playerManager.actor.id;this.mGMEApi=new WebGMEAPI,this.mGMEApi.Init(document,"1400209172",i.toString()),this.mGMEApi.SetTMGDelegate((function(i,o){switch(i){case t.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ENTER_ROOM:l.a.getInstance().log("[GME]: EnterRoom: "+o);break;case t.mGMEApi.event.ITMG_MAIN_EVNET_TYPE_USER_UPDATE:break;case t.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_EXIT_ROOM:l.a.getInstance().log("[GME]: ExitRoom");break;case t.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ROOM_DISCONNECT:l.a.getInstance().log("[GME]: Room Disconnect!!!");break;default:l.a.getInstance().log("[GME]: Sth wrong...")}}))}},ChatMediator.prototype.appendMessage=function(t,i){t.push(i),t.length>this.mMaxMessageNum&&t.shift()},ChatMediator.prototype.changeMessageChannel=function(){var t=this;if(this.mView)for(var i=this.mAllMessage.filter((function(i){return i.channel===t.mView.outChannel||i.channel===h.op_def.ChatChannel.System||null===t.mView.outChannel})),o=i.length,r=null,a="\n",l=0;l<o;l++)r=i[l],l===o-1&&(a=""),this.mView.appendChat(r.chat+a)},ChatMediator.prototype.handleCharacterChat=function(t){var i=t.content;if(this.world&&this.world.emitter&&this.room&&this.mView){var o=this.world.roomManager.currentRoom.playerManager;if(o){var r=o.get(i.chatSenderid),a=r?r.model.nickname+":":"",h=i.chatSetting&&i.chatSetting.textColor?i.chatSetting.textColor:"#FFFFFF";this.appendMessage(this.mAllMessage,{chat:"[color="+h+"]"+a+":"+i.chatContext+"[/color]",channel:i.chatChannel}),this.mView.appendChat("[b][color="+h+"]"+a+i.chatContext+"[/color][/b]\n")}}},ChatMediator.prototype.onSendChatHandler=function(t){if(this.world.connection){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_GATEWAY_REQ_VIRTUAL_WORLD_CHAT),o=i.content;o.chatChannel=0,o.chatContext=t,this.world.connection.send(i)}},ChatMediator.prototype.sendVoiceRoomStatus=function(t,i,o){if(this.room.connection){var r=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS),l=r.content;l.voiceChannel=t,l.voiceRoomId=i,l.voiceRoomStatus=o,this.room.connection.send(r)}},ChatMediator.prototype.handleQCLoudGME=function(t){var i=t.content;this.mQCLoudAuth=i.signature,this.initGME()},ChatMediator.prototype.onSelectedVoiceHandler=function(t){t?this.enterRoom():this.exitRoom()},ChatMediator.prototype.onSelectedMicHandler=function(t){if(this.mGMEApi&&(this.mInRoom&&this.mGMEApi.EnableMic(t),this.world.connection)){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS);this.world.connection.send(i)}},Object.defineProperty(ChatMediator.prototype,"room",{get:function(){if(this.world&&this.world.roomManager)return this.world.roomManager.currentRoom},enumerable:!1,configurable:!0}),ChatMediator.NAME="ChatMediator",ChatMediator}(d.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"DragDropIcon",(function(){return c}));var r,a=o(111),h=o(116),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function DragDropIcon(i,o,r,a){var l=t.call(this,i,o,r)||this;return l.mScene=i,l.mIcon=new h.DynamicImage(l.mScene,0,0),l.add(l.mIcon),l}return l(DragDropIcon,t),DragDropIcon.prototype.load=function(t,i,o){var r=this;this.mUrl=t;this.resKey;this.mIcon.load(a.i.getOsdRes(this.mUrl),(function(){r.mCallBack&&r.mCallBack()})),this.mCallBack=o},DragDropIcon.prototype.dragStart=function(){},DragDropIcon.prototype.dragStop=function(t){},DragDropIcon.prototype.dragDrop=function(t){},DragDropIcon.prototype.dragOver=function(t){},DragDropIcon.prototype.getDragData=function(){},DragDropIcon.prototype.getDropData=function(){},DragDropIcon.prototype.getDragImage=function(){return this.mIcon},DragDropIcon.prototype.getVisualDisplay=function(){},DragDropIcon.prototype.getBound=function(){var t=this.getBounds();return new Phaser.Geom.Rectangle(t.x,t.y,t.width,t.height)},Object.defineProperty(DragDropIcon.prototype,"resKey",{get:function(){return void 0===this.mUrl?"":a.i.getOsdRes(this.mUrl)},enumerable:!1,configurable:!0}),DragDropIcon.prototype.destroy=function(){this.mCallBack=null,t.prototype.destroy.call(this,!0)},Object.defineProperty(DragDropIcon.prototype,"icon",{get:function(){return this.mIcon},enumerable:!1,configurable:!0}),DragDropIcon.prototype.setDragType=function(t){this.mDragType=t},DragDropIcon.prototype.setDropType=function(t){this.mDropType=t},DragDropIcon.prototype.getDropType=function(){return this.mDropType},DragDropIcon.prototype.getDragType=function(){return this.mDragType},DragDropIcon}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(118),a=function(){function Tool(){}return Tool.getPosByScenes=function(t,i){var o=t.cameras.main,a=i.x-o.scrollX,h=i.y-o.scrollY;return new r.a(a,h)},Tool.twoPointDistance=function(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))},Tool.twoPointRadin=function(t,i){var o=t.x-i.x,r=t.y-i.y,a=Math.sqrt(Math.pow(o,2)+Math.pow(r,2)),h=Math.acos(o/a);return i.y<t.y&&(h=-h),h},Tool.formatChineseString=function(t,i,o){"string"==typeof i&&(i=parseInt(i,10));var r=Math.floor(o/i);return this.chunk(t,r).join(" ")},Tool.checkChinese=function(t){for(var i=/[\u4e00-\u9fa5]+/,o=t.split(""),r=0,a=o.length;r<a;r++)if(i.test(o[r]))return!0;return!1},Tool.checkItemName=function(t,i){var o=i.split("")||[],r=!1;return o.forEach((function(i){if(i)for(var o=new RegExp(i),a=t.split(""),h=0,l=a.length;h<l;h++)if(o.test(a[h])){r=!0;break}})),r},Tool.checkPointerContains=function(t,i){if(!t)return!1;var o=-t.width/2,r=t.width/2,a=-t.height/2,h=t.height/2;if(i){var l=t.getWorldTransformMatrix(),c=i.x-l.tx-t.x,u=i.y-l.ty-t.y;return o<=c&&r>=c&&a<=u&&h>=u}return!1},Tool.baseName=function(t){var i=new String(t).substring(t.lastIndexOf("/")+1);return-1!==i.lastIndexOf(".")&&(i=i.substring(0,i.lastIndexOf("."))),i},Tool.chunk=function(t,i){for(var o=[],r=0;r<t.length;r+=i)o.push(t.substr(r,i));return o},Tool}()},function(t,i,o){"use strict";o.r(i),o.d(i,"RankMediator",(function(){return c}));var r,a=o(194),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function RankMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mScene=o,a.mlayerManager=i,a.mUIType=a.world.game.device.os.desktop?h.UIType.Scene:h.UIType.Normal,a}return l(RankMediator,t),RankMediator.prototype.tweenView=function(t){this.mView&&this.world.game.device.os.desktop&&this.mView.tweenView(t)},RankMediator.prototype.getName=function(){return""},RankMediator.prototype.getView=function(){return this.mView},RankMediator.prototype.hide=function(){this.mShow=!1,this.mView&&(this.mView.hide(),this.mView=null,this.world.game.device.os.desktop||this.world.uiManager.checkUIState(RankMediator.NAME,!0))},RankMediator.prototype.isSceneUI=function(){return!1},RankMediator.prototype.isShow=function(){return!1},RankMediator.prototype.resize=function(){this.mView&&this.mView.resize()},RankMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||(this.mView=new a.RankPanel(this.mScene,this.world),this.mlayerManager.addToUILayer(this.mView),i&&i.length>0&&this.mView.addItem(i[0]),this.mView.show(),this.world.game.device.os.desktop||this.world.uiManager.checkUIState(RankMediator.NAME,!1),t.prototype.show.call(this,i))},RankMediator.prototype.update=function(t){this.mView&&t&&t.length>0&&this.mView.update(t[0])},RankMediator.prototype.destroy=function(){this.mView&&(this.mView.parentContainer&&this.mView.parentContainer.remove(this.mView),this.mView.destroy(),this.mView=null),this.mScene=null},RankMediator.NAME="RankMediator",RankMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaChatMediator",(function(){return d}));var r,a=o(212),h=o(214),l=o(2),c=o(114),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicaChatMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return p(PicaChatMediator,t),PicaChatMediator.prototype.show=function(){if(this.mView)return this.mView.show(),void this.layerManager.addToUILayer(this.mView);this.mChat||(this.mChat=new h.PicaChat(this.world),this.mChat.on("chat",this.onChatHandler,this),this.mChat.register()),this.mView||(this.mView=new a.PicaChatPanel(this.scene,this.world),this.mView.on("showNavigate",this.onShowNavigateHandler,this),this.mView.on("chat",this.onSendChatHandler,this)),this.mView.show(),this.layerManager.addToUILayer(this.mView)},PicaChatMediator.prototype.isSceneUI=function(){return!0},PicaChatMediator.prototype.destroy=function(){this.mChat&&(this.mChat.destroy(),this.mChat=void 0),t.prototype.destroy.call(this)},PicaChatMediator.prototype.hide=function(){t.prototype.hide.call(this),this.mView.removeListen(),this.layerManager.removeToUILayer(this.mView)},PicaChatMediator.prototype.onShowNavigateHandler=function(){if(this.world){var t=this.world.uiManager;t.showMed("PicaNavigate"),t.hideMed("PicHandheld"),this.hide()}},PicaChatMediator.prototype.onChatHandler=function(t){if(this.mView){var i=this.getSpeaker(t.chatSenderid),o="";i?o=""+i.model.nickname:t.chatSenderid&&(o=c.a.t("chat.mystery"));var r="#ffffff";t.chatSetting&&(r=t.chatSetting.textColor),this.appendChat("[color="+r+"]["+this.getChannel(t.chatChannel)+"]"+o+": "+t.chatContext+"[/color]\n")}},PicaChatMediator.prototype.appendChat=function(t){this.mView&&this.mView.appendChat(t)},PicaChatMediator.prototype.onSendChatHandler=function(t){this.mChat&&("whosyourdaddy"===t&&this.world.uiManager.showMed("DebugLogger"),this.mChat.sendMessage(t))},PicaChatMediator.prototype.getChannel=function(t){switch(t){case l.op_def.ChatChannel.CurrentScene:return c.a.t("chat.current");case l.op_def.ChatChannel.World:return c.a.t("chat.world");default:return c.a.t("chat.system")}},PicaChatMediator.prototype.getSpeaker=function(t){if(t){if(!this.world||!this.world.roomManager||!this.world.roomManager.currentRoom)return;return this.world.roomManager.currentRoom.getElement(t)}},PicaChatMediator.NAME="PicaChatMediator",PicaChatMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"LabelInput",(function(){return c}));var r,a=o(113),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function LabelInput(i,o){var r=t.call(this,i)||this,h={fontFamily:a.a.DEFULT_FONT},l=o.width||100,c=o.height||100;return r.mLabel=r.scene.make.text({text:o.placeholder,style:Object.assign(h,o)},!1).setInteractive(new Phaser.Geom.Rectangle(.5*-l,.5*-c,l,c),Phaser.Geom.Rectangle.Contains),r.mOriginX=r.mLabel.originX,r.mOriginY=r.mLabel.originY,r.mLabel.on("pointerup",r.onShowInputHandler,r),r.add(r.mLabel),r.setSize(l,c),r.mInputConfig=o,r}return l(LabelInput,t),LabelInput.prototype.setText=function(t){return this.mLabel.setText(t),this.mInputText&&(this.mInputText.text=t),this},LabelInput.prototype.setOrigin=function(t,i){return void 0===i&&(i=t),this.mLabel.setOrigin(t,i),this.mOriginX=t,this.mOriginY=i,this.mInputText&&this.mInputText.setOrigin(t,i),this.mLabel.input.hitArea=new Phaser.Geom.Rectangle(-this.width*t,-this.height*i,this.width,this.height),this},LabelInput.prototype.createBackground=function(t,i){this.mBackground||(this.mBackground=this.scene.make.graphics(void 0,!1)),this.mBackground.clear(),this.mBackground.fillStyle(16777215),this.mBackground.fillRoundedRect(-t+this.width*this.mLabel.originX,-t+this.height*this.mLabel.originY,this.width+2*t,this.height+2*t,i),this.addAt(this.mBackground,0)},LabelInput.prototype.setBlur=function(){this.onShowLabel()},LabelInput.prototype.destroy=function(){this.mLabel.destroy(),this.destroyInput(),t.prototype.destroy.call(this)},LabelInput.prototype.createInputText=function(){var t=this;this.mInputText&&this.mInputText.destroy(),this.mInputText=new h.InputText(this.scene,Object.assign({},this.mInputConfig)).setOrigin(this.mOriginX,this.mOriginY),this.mInputText.on("textchange",this.onTextChangeHandler,this),this.mInputText.on("blur",this.onTextBlurHandler,this),this.mInputText.on("focus",this.onTextFocusHandler,this),this.mInputText.node.addEventListener("keypress",(function(i){13===(i.keyCode||i.which)&&t.onShowLabel()}))},LabelInput.prototype.onShowInputHandler=function(){this.createInputText(),this.remove(this.mLabel),this.add(this.mInputText),this.mInputConfig.placeholder!==this.mLabel.text&&this.mInputText.setText(this.mLabel.text),this.mInputText.setFocus()},LabelInput.prototype.onShowLabel=function(){this.mInputText&&(!this.mInputText.text&&this.mInputConfig.placeholder?this.mLabel.setText(this.mInputConfig.placeholder):this.mLabel.setText(this.mInputText.text),this.destroyInput()),this.add(this.mLabel)},LabelInput.prototype.destroyInput=function(){this.mInputText&&(this.mInputText.destroy(),this.mInputText=void 0)},LabelInput.prototype.onTextChangeHandler=function(t,i){this.emit("textchange")},LabelInput.prototype.onTextBlurHandler=function(){this.emit("blur")},LabelInput.prototype.onTextFocusHandler=function(){this.emit("focus")},Object.defineProperty(LabelInput.prototype,"object",{get:function(){return this.mInputText||this.mLabel},enumerable:!1,configurable:!0}),Object.defineProperty(LabelInput.prototype,"text",{get:function(){return this.mInputText?this.mInputText.text:this.mLabel.text},enumerable:!1,configurable:!0}),LabelInput}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"TextButton",(function(){return l}));var r,a=o(113),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function TextButton(i,o,r,h,l,c){void 0===r&&(r=1);var u=t.call(this,i,l,c)||this;return u.normalColor="#FFFFFF",u.changeColor="#0099cc",u.mText=u.scene.make.text({text:h,style:{fontSize:15*window.devicePixelRatio,fontFamily:a.a.DEFULT_FONT}},!1).setOrigin(.5,.5),u.add(u.mText),u}return h(TextButton,t),TextButton.prototype.setText=function(t){this.mText.text=t},TextButton.prototype.setFontSize=function(t){this.mText.setFontSize(t)},TextButton.prototype.setFontStyle=function(t){this.mText.setFontStyle(t)},TextButton.prototype.setStyle=function(t){this.mText.setStyle(t)},TextButton.prototype.setNormalColor=function(t){this.normalColor=t},TextButton.prototype.setChangeColor=function(t){this.changeColor=t},TextButton.prototype.changeDown=function(){this.mText.setFill(this.changeColor)},TextButton.prototype.changeNormal=function(){this.mText.setFill(this.normalColor)},TextButton.prototype.onPointerUpHandler=function(t){this.emit("click",t,this)},Object.defineProperty(TextButton.prototype,"text",{get:function(){return this.mText},enumerable:!1,configurable:!0}),TextButton}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";var r;o.r(i),o.d(i,"PicFriendEvent",(function(){return r})),function(t){t.FETCH_FRIEND="fetchFriend",t.FOLLOW="follow",t.UNFOLLOW="unfollow",t.REMOVE_BAN_USER="removeBanUser",t.REQ_BLACKLIST="ReqBlacklist",t.REQ_FRIEND_ATTRIBUTES="reqFriendAttributes",t.REQ_FRIEND_GAME_DATA="reqFriendGameData",t.REMOVE_FROM_BLACKLIST="removeFromBlacklist",t.RENDERER_EVENT="rendererEvent",t.REQ_PLAYER_LIST="reqPlayerList",t.PLAYER_LIST="playerList",t.SEARCH_FRIEND="searchFriend",t.SEARCH_RESULT="searchResult",t.REQ_FRIEND_RELATION="reqFriendRelation",t.REQ_RELATION="reqRelation"}(r||(r={}))},function(t,i,o){"use strict";o.d(i,"a",(function(){return y}));var r,a=o(110),h=o(2),l=o(122),c=o(0),u=o(118),p=o(126),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=h.op_def.NodeType,y=function(t){function ElementManager(i){var o=t.call(this)||this;o.mRoom=i,o.hasAddComplete=!1,o.mElements=new Map,o.connection&&(o.connection.addPacketListener(o),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE,o.onAdd),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END,o.addComplete),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE,o.onRemove),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE,o.onMove),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION,o.onAdjust),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE,o.onSync),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE,o.onShowBubble),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN,o.onClearBubbleHandler),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION,o.onChangeAnimation),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION,o.onSetPosition)),o.mRoom&&o.mRoom.world&&(o.mGameConfig=o.mRoom.world.elementStorage);var r=o.mRoom.miniSize;o.mMap=new Array(r.rows);for(var a=0;a<o.mMap.length;a++)o.mMap[a]=new Array(r.cols).fill(-1);return o}return d(ElementManager,t),ElementManager.prototype.init=function(){},ElementManager.prototype.get=function(t){var i=this.mElements.get(t);if(i)return i},ElementManager.prototype.remove=function(t){var i=this.mElements.get(t);return i&&(this.mElements.delete(t),i.destroy(),this.removeMap(i.model)),i},ElementManager.prototype.getElements=function(){return Array.from(this.mElements.values())},ElementManager.prototype.add=function(t,i){for(var o=0,r=t;o<r.length;o++){var a=r[o];this._add(a,i)}},ElementManager.prototype.setState=function(t){if(t){var i=t.owner;if(i&&i.type===h.op_def.NodeType.ElementNodeType){var o=this.get(i.id);o&&o.setState(t.state)}}},ElementManager.prototype.destroy=function(){var t=this;this.connection&&this.connection.removePacketListener(this),this.mElements&&(this.mElements.forEach((function(i){return t.remove(i.id)})),this.mElements.clear())},ElementManager.prototype.update=function(t,i){},ElementManager.prototype.addMap=function(t){},ElementManager.prototype.removeMap=function(t){},Object.defineProperty(ElementManager.prototype,"camera",{get:function(){return this.mRoom.cameraService.camera},enumerable:!1,configurable:!0}),Object.defineProperty(ElementManager.prototype,"connection",{get:function(){if(this.mRoom)return this.mRoom.connection;c.a.getInstance().log("roomManager is undefined")},enumerable:!1,configurable:!0}),ElementManager.prototype.onAdjust=function(t){var i=t.content,o=i.spritePositions;if(i.nodeType===m.ElementNodeType)for(var r,a,h=0,l=o;h<l.length;h++){var c=l[h];(r=this.mElements.get(c.id))&&(a=c.point3f,r.setPosition(new u.a(a.x||0,a.y||0,a.z||0)))}},ElementManager.prototype.onAdd=function(t){if(this.mRoom.layerManager)if(this.mGameConfig){var i=t.content,o=i.sprites;if(o)if(i.nodeType===m.ElementNodeType){for(var r=null,a=[],h=0,l=o;h<l.length;h++){var u=l[h];u.point3f&&((r=new p.a(u,i.nodeType)).displayInfo||this.checkDisplay(r)||a.push(r.id),this._add(r))}this.fetchDisplay(a)}}else c.a.getInstance().error("gameConfig does not exist");else c.a.getInstance().error("layer manager does not exist")},ElementManager.prototype._add=function(t,i){void 0===i&&(i=!0);var o=this.mElements.get(t.id);return o?o.model=t:(o=new l.b(t,this)).setInputEnable(l.c.Interactive),i&&this.addMap(t),this.mElements.set(o.id||0,o),o},ElementManager.prototype.addComplete=function(t){this.hasAddComplete=!0},ElementManager.prototype.checkDisplay=function(t){if(!t.displayInfo){var i=this.roomService.world.elementStorage.getDisplayModel(t.bindID||t.id);if(i)return t.displayInfo=i,i}},ElementManager.prototype.fetchDisplay=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);i.content.ids=t,this.connection.send(i)},Object.defineProperty(ElementManager.prototype,"roomService",{get:function(){return this.mRoom},enumerable:!1,configurable:!0}),Object.defineProperty(ElementManager.prototype,"scene",{get:function(){if(this.mRoom)return this.mRoom.scene},enumerable:!1,configurable:!0}),Object.defineProperty(ElementManager.prototype,"map",{get:function(){return this.mMap},enumerable:!1,configurable:!0}),ElementManager.prototype.onSetPosition=function(t){var i=t.content,o=i.nodeType,r=i.id;o===m.ElementNodeType&&this.get(r).setPosition(new u.a(i.position.x,i.position.y,i.position.z))},ElementManager.prototype.onRemove=function(t){var i=t.content,o=i.nodeType,r=i.ids;if(o===m.ElementNodeType)for(var a=0,h=r;a<h.length;a++){var l=h[a];this.remove(l)}},ElementManager.prototype.onSync=function(t){var i=t.content;if(i.nodeType===m.ElementNodeType)for(var o=null,r=i.sprites,a=i.command,l=0,c=r;l<c.length;l++){var u=c[l];(o=this.get(u.id))&&(a===h.op_def.OpCommand.OP_COMMAND_UPDATE?o.model=new p.a(u):a===h.op_def.OpCommand.OP_COMMAND_PATCH&&o.updateModel(u))}},ElementManager.prototype.onMove=function(t){var i=t.content;if(i.moveData)for(var o=i.moveData,r=o.length,a=(i.nodeType,void 0),h=void 0,l=void 0,c=0;c<r;c++)h=(a=o[c]).moveObjectId,(l=this.get(h))&&l.move(a)},ElementManager.prototype.onShowBubble=function(t){var i=t.content,o=this.get(i.receiverid);o&&o.showBubble(i.context,i.chatsetting)},ElementManager.prototype.onClearBubbleHandler=function(t){var i=t.content,o=this.get(i.receiverid);o&&o.clearBubble()},ElementManager.prototype.onChangeAnimation=function(t){var i=t.content;if(i.nodeType===m.ElementNodeType)for(var o=null,r=0,a=i.ids;r<a.length;r++){var h=a[r];(o=this.get(h))&&o.setQueue(i.changeAnimation)}},ElementManager}(a.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return d}));var r,a,h,l=o(111),c=o(137),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)});!function(t){t.BodyCostDres="body_cost_$_dres",t.BodyCost="body_cost_$",t.BodyTail="body_tail_$",t.BodyWing="body_wing_$",t.BodyBase="body_base_$",t.BodySpec="body_spec_$",t.FlegSpec="fleg_spec_$",t.FlegBase="fleg_base_$",t.FlegCost="fleg_cost_$",t.BarmSpec="barm_spec_$",t.BarmBase="barm_base_$",t.BarmCost="barm_cost_$",t.WeapBarm="weap_barm_$",t.ShldBarm="shld_barm_$",t.BlegSpec="bleg_spec_$",t.BlegBase="bleg_base_$",t.BlegCost="bleg_cost_$",t.FarmSpec="farm_spec_$",t.FarmBase="farm_base_$",t.FarmCost="farm_cost_$",t.ShldFarm="shld_farm_$",t.WeapFarm="weap_farm_$",t.HeadSpec="head_spec_$",t.HeadMask="head_mask_$",t.HeadEyes="head_eyes_$",t.HeadBase="head_base_$",t.HeadHairBack="head_hair_$_back",t.HeadMous="head_mous_$",t.HeadHair="head_hair_$",t.HeadHats="head_hats_$"}(a||(a={})),function(t){t.BarmBase="barm_base_#_$",t.BarmCost="barm_cost_#_$",t.BarmSpec="barm_spec_#_$",t.BlegBase="bleg_base_#_$",t.BlegCost="bleg_cost_#_$",t.BlegSpec="bleg_spec_#_$",t.BodyBase="body_base_#_$",t.BodyCost="body_cost_#_$",t.BodyCostDres="body_cost_#_$_dres",t.BodySpec="body_spec_#_$",t.BodyTail="body_tail_#_$",t.BodyWing="body_wing_#_$",t.FarmBase="farm_base_#_$",t.FarmCost="farm_cost_#_$",t.FarmSpec="farm_spec_#_$",t.FlegBase="fleg_base_#_$",t.FlegCost="fleg_cost_#_$",t.FlegSpec="fleg_spec_#_$",t.HeadBase="head_base_#_$",t.HeadEyes="head_eyes_#_$",t.HeadHair="head_hair_#_$",t.HeadHairBack="head_hair_#_$_back",t.HeadHats="head_hats_#_$",t.HeadMask="head_mask_#_$",t.HeadMous="head_mous_#_$",t.HeadSpec="head_spec_#_$",t.ShldFarm="shld_farm_#_$",t.WeapFarm="weap_farm_#_$",t.ShldBarm="shld_barm_#_$",t.WeapBarm="weap_barm_#_$"}(h||(h={}));var d=function(t){function DragonbonesDisplay(i,o,r,h){void 0===h&&(h=!1);var l=t.call(this,i,o,r,h)||this;return l.mAnimationName="Armature",l.mDragonbonesName="",l.replaceArr=[],l.mHasLoadMap=new Map,l.mLoadMap=new Map,l.mErrorLoadMap=new Map,l.mNeedReplaceTexture=!1,l.UNPACKSLOTS=[a.WeapFarm,a.WeapBarm],l.UNCHECKAVATARPROPERTY=["id","dirable","farmWeapId","barmWeapId"],l}return p(DragonbonesDisplay,t),Object.defineProperty(DragonbonesDisplay.prototype,"displayInfo",{get:function(){return this.mDisplayInfo},set:function(t){!1===this.mNeedReplaceTexture&&(this.mNeedReplaceTexture=this.checkNeedReplaceTexture(this.mDisplayInfo,t)),this.mDisplayInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"spriteWidth",{get:function(){return this.mArmatureDisplay?this.mArmatureDisplay.width:0},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"spriteHeight",{get:function(){return this.mArmatureDisplay?this.mArmatureDisplay.height:0},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"topPoint",{get:function(){return this.mBoardPoint},enumerable:!1,configurable:!0}),Object.defineProperty(DragonbonesDisplay.prototype,"GameObject",{get:function(){return this},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.changeAlpha=function(t){},DragonbonesDisplay.prototype.load=function(t,i){if((i=i||c.a.STAGE)===c.a.STAGE){if(this.displayInfo=t,this.mCollisionArea=[[1,1],[1,1]],this.mOriginPoint=new Phaser.Geom.Point(1,1),!this.displayInfo)return;this.dragonBonesName="bones_human01"}},DragonbonesDisplay.prototype.getDisplay=function(){return this.mArmatureDisplay},DragonbonesDisplay.prototype.play=function(t){if(this.mActionName=t,this.mArmatureDisplay){if(this.mArmatureDisplay.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)&&this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),t.playingQueue&&t.playingQueue.complete&&this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),this.mArmatureDisplay.animation.play(t.name),this.mArmatureDisplay.scaleX=t.flip?-1:1,this.mArmatureDisplay&&this.mArmatureDisplay.armature){var i=this.mArmatureDisplay.armature.getBone("board");if(i)return void(this.mBoardPoint=new Phaser.Geom.Point(i.global.x,i.global.y))}this.mBoardPoint=new Phaser.Geom.Point}},DragonbonesDisplay.prototype.fadeIn=function(t){this.clearFadeTween(),this.alpha=0,this.mFadeTween=this.scene.tweens.add({targets:this,alpha:1,duration:1200,onComplete:function(){t&&t()}})},DragonbonesDisplay.prototype.fadeOut=function(t){this.clearFadeTween(),this.mFadeTween=this.scene.tweens.add({targets:this,alpha:0,duration:1200,onComplete:function(){t&&t()}})},DragonbonesDisplay.prototype.destroy=function(){this.mDisplayInfo=null,this.mNeedReplaceTexture=!1,this.mArmatureDisplay&&(this.mArmatureDisplay.dispose(!0),this.mArmatureDisplay=null),this.mClickCon&&(this.mClickCon.destroy(!0),this.mClickCon=null),this.mFadeTween&&(this.clearFadeTween(),this.mFadeTween=null),t.prototype.destroy.call(this)},DragonbonesDisplay.prototype.buildDragbones=function(){if(this.scene.cache.custom.dragonbone.get(this.mDragonbonesName))this.onLoadCompleteHandler();else{var t="./resources/dragonbones",i=t+"/"+this.mDragonbonesName+"_tex.png",o=t+"/"+this.mDragonbonesName+"_tex.json",r=t+"/"+this.mDragonbonesName+"_ske.dbbin";this.loadDragonBones(t,i,o,r)}},DragonbonesDisplay.prototype.onLoadCompleteHandler=function(t,i,o){if(this.scene){this.mArmatureDisplay||(this.mArmatureDisplay=this.scene.add.armature(this.mAnimationName,this.dragonBonesName),this.mArmatureDisplay.visible=!1,this.showPlaceholder(),this.add(this.mArmatureDisplay)),this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.SOUND_EVENT,this.onSoundEventHandler,this),this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.SOUND_EVENT,this.onSoundEventHandler,this),this.clearArmatureSlot(),this.getReplaceArr(),this.showReplaceArmatrue();var r=new Phaser.Geom.Rectangle(0,0,50,70);this.mClickCon||(this.mClickCon=this.scene.make.container(void 0,!1),this.mClickCon.setInteractive(r,Phaser.Geom.Rectangle.Contains),this.mClickCon.x=-r.width>>1,this.mClickCon.y=-r.height),this.setData("id",this.displayInfo.id),this.add(this.mClickCon),this.emit("initialized")}},DragonbonesDisplay.prototype.loadDragonBones=function(t,i,o,r){this.scene.load.dragonbone(this.mDragonbonesName,i,o,r,null,null,{responseType:"arraybuffer"}),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.onFileLoadHandler,this),this.scene.load.start()},DragonbonesDisplay.prototype.clearArmatureSlot=function(){this.mArmatureDisplay.armature.getSlots().forEach((function(t){t&&(t.display.visible=!1)}))},DragonbonesDisplay.prototype.clearReplaceArmature=function(){if(this.mArmatureDisplay.armature.animation.stop(),this.replaceArr&&0!==this.replaceArr.length)for(var t=this.replaceArr.length,i=0;i<t;i++){var o=this.replaceArr[i].slot.replace("$",this.replaceArr[i].dir.toString());this.mArmatureDisplay.armature.getSlot(o).replaceDisplay(null)}},DragonbonesDisplay.prototype.showReplaceArmatrue=function(){for(var t=0,i=this.replaceArr;t<i.length;t++){var o=i[t];this.replacePartDisplay(o.slot,o.part,o.dir,o.skin)}this.mLoadMap&&this.mLoadMap.size>0?this.startLoad():this.refreshAvatar()},DragonbonesDisplay.prototype.getReplaceArr=function(){this.replaceArr.length=0;var t=this.displayInfo.avatar;t.bodyBaseId&&(this.replaceArr.push({slot:a.BodyBase,part:h.BodyBase,dir:3,skin:t.bodyBaseId}),this.replaceArr.push({slot:a.BodyBase,part:h.BodyBase,dir:1,skin:t.bodyBaseId})),t.bodySpecId&&(this.replaceArr.push({slot:a.BodySpec,part:h.BodySpec,dir:3,skin:t.bodySpecId}),this.replaceArr.push({slot:a.BodySpec,part:h.BodySpec,dir:1,skin:t.bodySpecId})),t.bodyWingId&&(this.replaceArr.push({slot:a.BodyWing,part:h.BodyWing,dir:3,skin:t.bodyWingId}),this.replaceArr.push({slot:a.BodyWing,part:h.BodyWing,dir:1,skin:t.bodyWingId})),t.bodyTailId&&(this.replaceArr.push({slot:a.BodyTail,part:h.BodyTail,dir:3,skin:t.bodyTailId}),this.replaceArr.push({slot:a.BodyTail,part:h.BodyTail,dir:1,skin:t.bodyTailId})),t.bodyCostId&&(this.replaceArr.push({slot:a.BodyCost,part:h.BodyCost,dir:3,skin:t.bodyCostId}),this.replaceArr.push({slot:a.BodyCost,part:h.BodyCost,dir:1,skin:t.bodyCostId}),this.replaceArr.push({slot:a.BodyCostDres,part:h.BodyCostDres,dir:3,skin:t.bodyCostId}),this.replaceArr.push({slot:a.BodyCostDres,part:h.BodyCostDres,dir:1,skin:t.bodyCostId})),t.farmBaseId&&(this.replaceArr.push({slot:a.FarmBase,part:h.FarmBase,dir:3,skin:t.farmBaseId}),this.replaceArr.push({slot:a.FarmBase,part:h.FarmBase,dir:1,skin:t.farmBaseId})),t.farmSpecId&&(this.replaceArr.push({slot:a.FarmSpec,part:h.FarmSpec,dir:3,skin:t.farmSpecId}),this.replaceArr.push({slot:a.FarmSpec,part:h.FarmSpec,dir:1,skin:t.farmSpecId})),t.farmCostId&&(this.replaceArr.push({slot:a.FarmCost,part:h.FarmCost,dir:3,skin:t.farmCostId}),this.replaceArr.push({slot:a.FarmCost,part:h.FarmCost,dir:1,skin:t.farmCostId})),t.barmBaseId&&(this.replaceArr.push({slot:a.BarmBase,part:h.BarmBase,dir:3,skin:t.barmBaseId}),this.replaceArr.push({slot:a.BarmBase,part:h.BarmBase,dir:1,skin:t.barmBaseId})),t.barmSpecId&&(this.replaceArr.push({slot:a.BarmSpec,part:h.BarmSpec,dir:3,skin:t.barmSpecId}),this.replaceArr.push({slot:a.BarmSpec,part:h.BarmSpec,dir:1,skin:t.barmSpecId})),t.barmCostId&&(this.replaceArr.push({slot:a.BarmCost,part:h.BarmCost,dir:3,skin:t.barmCostId}),this.replaceArr.push({slot:a.BarmCost,part:h.BarmCost,dir:1,skin:t.barmCostId})),t.blegBaseId&&(this.replaceArr.push({slot:a.BlegBase,part:h.BlegBase,dir:3,skin:t.blegBaseId}),this.replaceArr.push({slot:a.BlegBase,part:h.BlegBase,dir:1,skin:t.blegBaseId})),t.blegSpecId&&(this.replaceArr.push({slot:a.BlegSpec,part:h.BlegSpec,dir:3,skin:t.blegSpecId}),this.replaceArr.push({slot:a.BlegSpec,part:h.BlegSpec,dir:1,skin:t.blegSpecId})),t.blegCostId&&(this.replaceArr.push({slot:a.BlegCost,part:h.BlegCost,dir:3,skin:t.blegCostId}),this.replaceArr.push({slot:a.BlegCost,part:h.BlegCost,dir:1,skin:t.blegCostId})),t.flegBaseId&&(this.replaceArr.push({slot:a.FlegBase,part:h.FlegBase,dir:3,skin:t.flegBaseId}),this.replaceArr.push({slot:a.FlegBase,part:h.FlegBase,dir:1,skin:t.flegBaseId})),t.flegSpecId&&(this.replaceArr.push({slot:a.FlegSpec,part:h.FlegSpec,dir:3,skin:t.flegSpecId}),this.replaceArr.push({slot:a.FlegSpec,part:h.FlegSpec,dir:1,skin:t.flegSpecId})),t.flegCostId&&(this.replaceArr.push({slot:a.FlegCost,part:h.FlegCost,dir:3,skin:t.flegCostId}),this.replaceArr.push({slot:a.FlegCost,part:h.FlegCost,dir:1,skin:t.flegCostId})),t.headBaseId&&(this.replaceArr.push({slot:a.HeadBase,part:h.HeadBase,dir:3,skin:t.headBaseId}),this.replaceArr.push({slot:a.HeadBase,part:h.HeadBase,dir:1,skin:t.headBaseId})),t.barmWeapId&&(this.replaceArr.push({slot:a.WeapBarm,part:h.WeapBarm,dir:3,skin:t.barmWeapId}),this.replaceArr.push({slot:a.WeapBarm,part:h.WeapBarm,dir:1,skin:t.barmWeapId})),t.headHairId&&(this.replaceArr.push({slot:a.HeadHair,part:h.HeadHair,dir:3,skin:t.headHairId}),this.replaceArr.push({slot:a.HeadHair,part:h.HeadHair,dir:1,skin:t.headHairId}),this.replaceArr.push({slot:a.HeadHairBack,part:h.HeadHairBack,dir:3,skin:t.headHairId}),this.replaceArr.push({slot:a.HeadHairBack,part:h.HeadHairBack,dir:1,skin:t.headHairId})),t.headHatsId&&(this.replaceArr.push({slot:a.HeadHats,part:h.HeadHats,dir:3,skin:t.headHatsId}),this.replaceArr.push({slot:a.HeadHats,part:h.HeadHats,dir:1,skin:t.headHatsId})),t.headSpecId&&(this.replaceArr.push({slot:a.HeadSpec,part:h.HeadSpec,dir:3,skin:t.headSpecId}),this.replaceArr.push({slot:a.HeadSpec,part:h.HeadSpec,dir:1,skin:t.headSpecId})),t.headEyesId&&this.replaceArr.push({slot:a.HeadEyes,part:h.HeadEyes,dir:3,skin:t.headEyesId}),t.headMousId&&this.replaceArr.push({slot:a.HeadMous,part:h.HeadMous,dir:3,skin:t.headMousId}),t.headMaskId&&this.replaceArr.push({slot:a.HeadMask,part:h.HeadMask,dir:3,skin:t.headMaskId}),t.farmShldId&&(this.replaceArr.push({slot:a.ShldFarm,part:h.ShldFarm,dir:3,skin:t.farmShldId}),this.replaceArr.push({slot:a.ShldFarm,part:h.ShldFarm,dir:1,skin:t.farmShldId}),this.replaceArr.push({slot:a.ShldBarm,part:h.ShldBarm,dir:3,skin:t.farmShldId}),this.replaceArr.push({slot:a.ShldBarm,part:h.ShldBarm,dir:1,skin:t.farmShldId})),t.farmWeapId&&(this.replaceArr.push({slot:a.WeapFarm,part:h.WeapFarm,dir:3,skin:t.farmWeapId}),this.replaceArr.push({slot:a.WeapFarm,part:h.WeapFarm,dir:1,skin:t.farmWeapId}),this.replaceArr.push({slot:a.WeapBarm,part:h.WeapBarm,dir:3,skin:t.farmWeapId}),this.replaceArr.push({slot:a.WeapBarm,part:h.WeapBarm,dir:1,skin:t.farmWeapId}))},DragonbonesDisplay.prototype.hideUnreplacedParts=function(){for(var t=[],i=0,o=this.replaceArr;i<o.length;i++){var r=o[i],a=r.slot.replace("$",r.dir.toString()),h=this.mArmatureDisplay.armature.getSlot(a);t.push(h)}for(var l=0,c=this.mArmatureDisplay.armature.getSlots();l<c.length;l++){(h=c[l])&&(h.display.visible=t.includes(h))}},DragonbonesDisplay.prototype.replacePartDisplay=function(t,i,o,r){var a=t.replace("$",o.toString()),h=this.mArmatureDisplay.armature.getSlot(a),c=i.replace("#",r.toString()).replace("$",o.toString()),u=this.scene.game.textures.get(this.mDragonbonesName);if(this.scene.cache.custom.dragonbone.get(this.dragonBonesName)){var p=l.g.getPartName(c),d="test resources/"+c;if(this.mErrorLoadMap.get(p))return;this.scene.textures.exists(p)||(u.frames[d]?this.mHasLoadMap.set(c,this.scene.textures.get(p)):this.mLoadMap.set(h.name,[h.name,c]))}},DragonbonesDisplay.prototype.startLoad=function(){var t=this,i=[];this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(o,r,a){i&&t.scene&&(t.refreshAvatar(),t.mLoadMap.clear())}),this),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,(function(i){t.mLoadMap.delete(i.key),t.mErrorLoadMap.set(i.key,i)}),this),this.mLoadMap.forEach((function(t){var o=t,r=l.g.getPartUrl(o[1]),a=l.g.getPartName(o[1]);i.push({key:a,url:r})})),this.scene.load.image(i),this.scene.load.start()},DragonbonesDisplay.prototype.refreshAvatar=function(){for(var t=this,i=this.scene.game.textures.get(this.mDragonbonesName),o=0,r=this.replaceArr;o<r.length;o++){var a=r[o],h=a.slot.replace("$",a.dir.toString()),c=this.mArmatureDisplay.armature.getSlot(h),u=a.part.replace("#",a.skin.toString()).replace("$",a.dir.toString()),p=l.g.getPartName(u),d="test resources/"+u;if(this.UNPACKSLOTS.includes(a.slot)){if(this.scene.textures.exists(p)){var m=new dragonBones.phaser.display.SlotImage(this.scene,c.display.x,c.display.y,p);c.display=m}}else c.display.visible=this.scene.textures.exists(p)||i.frames[d]}if(this.mNeedReplaceTexture){this.mNeedReplaceTexture=!1;var y=i.getFrameNames(),g="bones_"+this.displayInfo.id;this.scene.textures.get(g);this.mDragonBonesRenderTexture||(this.mDragonBonesRenderTexture=this.scene.make.renderTexture({x:0,y:0,width:i.source[0].width,height:i.source[0].height},!1)),this.mDragonBonesRenderTexture.clear();for(var _=0,v=y.length;_<v;_++){var b=y[_],P=(u=b.split("/")[1].split("_"))[4]?u[0]+"_"+u[1]+"_"+u[3]+"_"+u[4]:u[0]+"_"+u[1]+"_"+u[3],w=(c=this.mArmatureDisplay.armature.getSlot(P),i.get(b)),S=this.mLoadMap.get(P);if(S){var C=S[1]+"_png",T=this.scene.game.textures.get(C);this.mDragonBonesRenderTexture.drawFrame(C,T.firstFrame,w.cutX,w.cutY)}else for(var k=0,O=this.replaceArr;k<O.length;k++){var I=O[k],M=I.part.replace("#",I.skin.toString()).replace("$",I.dir.toString());p=l.g.getPartName(M),d="test resources/"+M;if((h=I.slot.replace("$",I.dir.toString()))===P){var E=this.scene.textures.get(p);if(i.frames[d]){this.mDragonBonesRenderTexture.drawFrame(this.mDragonbonesName,b,w.cutX,w.cutY);break}this.mDragonBonesRenderTexture.drawFrame(p,E.firstFrame,w.cutX,w.cutY);break}}}this.mDragonBonesRenderTexture.snapshotArea(0,0,i.source[0].width,i.source[0].height,(function(o){if(o instanceof HTMLImageElement){t.scene.game.textures.exists(g)&&t.scene.game.textures.removeKey(g);var r=t.scene.game.textures.create(g,o,i.source[0].width,i.source[0].height);t.mArmatureDisplay.armature.replacedTexture=r}}))}this.closePlaceholder(),this.mArmatureDisplay.visible=!0},DragonbonesDisplay.prototype.clearFadeTween=function(){this.mFadeTween&&(this.mFadeTween.stop(),this.mFadeTween.remove())},DragonbonesDisplay.prototype.onArmatureLoopComplete=function(t){if(this.mArmatureDisplay&&this.mActionName){var i=this.mActionName.playingQueue;void 0===i.playedTimes?i.playedTimes=1:i.playedTimes++,i.playedTimes>=i.playTimes&&(this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.onArmatureLoopComplete,this),i.complete&&(i.complete.call(this),delete i.complete))}},DragonbonesDisplay.prototype.onSoundEventHandler=function(t){t.name&&this.mRoomService.world.playSound({field:u.SoundField.Element,key:t.name})},Object.defineProperty(DragonbonesDisplay.prototype,"dragonBonesName",{get:function(){return this.mDragonbonesName},set:function(t){this.mDragonbonesName=t,this.buildDragbones()},enumerable:!1,configurable:!0}),DragonbonesDisplay.prototype.checkNeedReplaceTexture=function(t,i){if(!i)return!1;if(!t)return!0;var o=t.avatar,r=i.avatar;for(var a in r)if(r.hasOwnProperty(a)&&!this.UNCHECKAVATARPROPERTY.includes(a)){if(!o.hasOwnProperty(a))return!0;if(o[a]!==r[a])return!0}return!1},DragonbonesDisplay.prototype.showPlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=this.scene.make.image({key:"avatar_placeholder",x:-22,y:-68}).setOrigin(0),this.add(this.mPlaceholder)},DragonbonesDisplay.prototype.closePlaceholder=function(){this.mPlaceholder&&this.mPlaceholder.destroy(),this.mPlaceholder=void 0},DragonbonesDisplay.prototype.onFileLoadHandler=function(t,i){t===this.mDragonbonesName&&"image"===i&&(this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.onFileLoadHandler,this),this.onLoadCompleteHandler())},DragonbonesDisplay}(c.b)},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(122),a=function(){function DragonbonesModel(t){this.discriminator="DragonbonesModel",t&&(this.id=t.id,this.avatar=t.avatar)}return DragonbonesModel.prototype.setInfo=function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])},DragonbonesModel.prototype.destroy=function(){},DragonbonesModel.prototype.getCollisionArea=function(t){return[[1,1],[1,1]]},DragonbonesModel.prototype.getWalkableArea=function(){return[[1,1],[1,1]]},DragonbonesModel.prototype.getOriginPoint=function(t){return new Phaser.Geom.Point(1,1)},DragonbonesModel.prototype.getInteractiveArea=function(){},DragonbonesModel.prototype.existAnimation=function(t){return!0},DragonbonesModel.prototype.findAnimation=function(t,i){var o=!1;switch(i){case r.a.south_east:o=!0,i=r.a.west_south;break;case r.a.east_north:o=!0,i=r.a.north_west}var a="";return(i>=r.a.north&&i<r.a.west||i>r.a.east&&i<=r.a.east_north)&&(a="_back"),{name:""+t+a,flip:o}},DragonbonesModel}()},function(t,i,o){"use strict";var r=o(26),__spreadArrays=function(){for(var t=0,i=0,o=arguments.length;i<o;i++)t+=arguments[i].length;var r=Array(t),a=0;for(i=0;i<o;i++)for(var h=arguments[i],l=0,c=h.length;l<c;l++,a++)r[a]=h[l];return r},a=function(){function Helpers(){}return Helpers.genId=function(){return(new r).natural({min:1e4,max:Helpers.MAX_ID})},Helpers.flipArray=function(t){if(t){var i=__spreadArrays(t),o=[];if(i.length>0)for(var r=i[0].length,a=0;a<r;a++){o[a]=[];for(var h=0,l=i;h<l.length;h++){var c=l[h];o[a].push(c[a])}}return o}},Helpers.openUrl=function(t){var i=window.open("","_blank");i&&(i.location.href=t)},Helpers.MAX_ID=Math.pow(2,31),Helpers}();i.a=a},function(t,i,o){"use strict";o.r(i),o.d(i,"CheckButton",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function CheckButton(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h)||this;return c.mSelected=!1,c.mNormalFrame=h,c.mSelectFrame=l,c.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.setInteractive(new Phaser.Geom.Rectangle(0,0,c.width,c.height),Phaser.Geom.Rectangle.Contains),c.on("pointerup",c.onSelected,c),c}return a(CheckButton,t),CheckButton.prototype.onSelected=function(){this.selected=!this.mSelected,this.emit("selected",this.mSelected)},Object.defineProperty(CheckButton.prototype,"selected",{get:function(){return this.mSelected},set:function(t){if(this.mSelected!==t){this.mSelected=t;var i=t?this.mSelectFrame:this.mNormalFrame;this.setFrame(i)}},enumerable:!1,configurable:!0}),CheckButton}(Phaser.GameObjects.Image)},function(t,i,o){"use strict";o.r(i),o.d(i,"BaseChatPanel",(function(){return l}));var r,a=o(112),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function BaseChatPanel(i,o){return t.call(this,i,o)||this}return h(BaseChatPanel,t),BaseChatPanel.prototype.appendChat=function(t){},Object.defineProperty(BaseChatPanel.prototype,"outChannel",{get:function(){return 0},enumerable:!1,configurable:!0}),BaseChatPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ToolTip",(function(){return l}));var r,a=o(146),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function ToolTip(i,o,r,a,h){var l=t.call(this,i)||this;return l.mScene=i,l.resStr=o,l.resJson=r,l.resUrl=a,l.uiScale=h,l.mWidth=0,l.mHeight=0,l.mBaseMidHeight=0,l.preLoad(),l}return h(ToolTip,t),ToolTip.prototype.setToolTipData=function(t){if(this.mText){var i=a.a.formatChineseString(t,this.mText.style.fontSize,this.mWidth-20);this.mText.setText(i),this.refreshTip()}},ToolTip.prototype.destroy=function(){this.topImage&&this.topImage.destroy(!0),this.midImage&&this.midImage.destroy(!0),this.botImage&&this.botImage.destroy(!0),this.mText&&this.mText.destroy(!0),this.mWidth=0,this.mHeight=0,this.removeAllListeners(),this.removeAll(),t.prototype.destroy.call(this,!0)},ToolTip.prototype.preLoad=function(){this.scene.load.atlas(this.resStr,this.resUrl,this.resJson),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},ToolTip.prototype.init=function(){this.topImage=this.scene.make.image(void 0,!1),this.topImage.setOrigin(0,0),this.topImage.setTexture(this.resStr,ToolTip.TOP),this.midImage=this.scene.make.image(void 0,!1),this.midImage.setOrigin(0,0),this.midImage.setTexture(this.resStr,ToolTip.MID),this.botImage=this.scene.make.image(void 0,!1),this.botImage.setOrigin(0,0),this.botImage.setTexture(this.resStr,ToolTip.BOT),this.mText=this.scene.make.text(void 0,!1),this.mText.setFontFamily("YaHei"),this.mText.setFontStyle("bold"),this.mText.setFontSize(14),this.mText.style.align="center",this.mText.lineSpacing=15,this.mWidth=this.topImage.width,this.mBaseMidHeight=this.midImage.height,this.mText.style.fixedWidth=this.mWidth-20,this.mText.style.setWordWrapWidth(this.mWidth-20,!0),this.add(this.topImage),this.add(this.midImage),this.add(this.botImage),this.add(this.mText)},ToolTip.prototype.refreshTip=function(){this.midImage.scaleY=(this.mText.height+20)/this.mBaseMidHeight,this.mHeight=this.topImage.height+this.midImage.height*this.midImage.scaleY+this.botImage.height,this.topImage.y=-this.topImage.height>>1,this.midImage.y=this.topImage.y+this.topImage.height,this.botImage.y=this.midImage.y+this.midImage.height*this.midImage.scaleY,this.mText.x=this.mWidth-this.mText.style.fixedWidth>>1,this.mText.y=this.mHeight-this.mText.height-10>>1,this.setSize(this.mWidth,this.mHeight)},ToolTip.prototype.onLoadComplete=function(){this.init()},ToolTip.TOP="tip_top.png",ToolTip.MID="tip_mid.png",ToolTip.BOT="tip_bot.png",ToolTip}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"FriendMediator",(function(){return c}));var r,a=o(193),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function FriendMediator(i,o){var r=t.call(this)||this;return r.mUIType=h.UIType.Normal,r.mScene=i,r.world=o,r}return l(FriendMediator,t),FriendMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},FriendMediator.prototype.isSceneUI=function(){return!1},FriendMediator.prototype.resize=function(){if(this.mView)return this.mView.resize()},FriendMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new a.FriendPanel(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i))},FriendMediator.prototype.hide=function(){this.mShow=!1,this.mView&&(this.mView=null)},FriendMediator.prototype.destroy=function(){t.prototype.destroy.call(this)},FriendMediator.NAME="FriendMediator",FriendMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"BasicRankPanel",(function(){return p}));var r,a=o(112),h=o(111),l=o(113),c=o(117),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function BasicRankPanel(i,o){var r=t.call(this,i,o)||this;return r.mTexts=[],r.disInteractive(),r}return u(BasicRankPanel,t),BasicRankPanel.prototype.addItem=function(t){if(this.setData("data",t),this.mInitialized){this.clearText();var i=t.text;if(i&&!(i.length<1)){this.mTitleLabel&&(this.mTitleLabel.setText(i[0].text),this.mTitleLabel.setData("node",i[0].node));for(var o=[-this.width/2+15,-this.width/2+63,-this.width/2+241],r=0,a=1;a<4;a++){r=(h=this.scene.make.text({x:o[a-1],y:-this.height/2+22,text:i?i[a].text:"123",style:{font:l.a.YAHEI_16_BOLD}},!1)).y,h.setData("node",i[a].node),h.setStroke("#000000",2),this.mChildContainer.add(h),this.mTexts.push(h)}r+=20;for(a=4;a<i.length;a++){var h,c=i[a],u=(a-4)%3,p=22*Math.floor((a-4)/3);(h=this.scene.make.text({x:o[u],y:r+p,text:c?c.text:"123",style:{font:l.a.YAHEI_14_BOLD}},!1)).setData("node",c.node),h.setStroke("#000000",2),this.mChildContainer.add(h),this.mTexts.push(h)}}}},BasicRankPanel.prototype.tweenView=function(t){},BasicRankPanel.prototype.update=function(t){this.addItem(t)},BasicRankPanel.prototype.destroy=function(){this.mBackground&&this.mBackground.destroy();for(var i=this.mTexts.length,o=0;o<i;o++){var r=this.mTexts[o];r&&(r.destroy(!0),r=null)}this.mTitleLabel&&this.mTitleLabel.destroy(!0),this.mTexts=[],this.mBackground=null,this.mTitleLabel=null,t.prototype.destroy.call(this)},BasicRankPanel.prototype.preload=function(){this.scene.load.image(h.a.getName(),h.a.getPNG()),this.scene.load.image(h.d.getName(),h.d.getPNG()),this.scene.load.atlas("clsBtn",h.i.getRes("ui/common/common_clsBtn.png"),h.i.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas("rank_atlas",h.i.getRes("ui/rank/rank_atlas.png"),h.i.getRes("ui/rank/rank_atlas.json")),t.prototype.preload.call(this)},BasicRankPanel.prototype.init=function(){if(!this.mInitialized){this.setSize(328,361),this.mBackground=new c.NinePatch(this.scene,0,0,328,361,h.a.getName(),null,h.a.getConfig()),this.add(this.mBackground),this.mChildContainer=this.scene.make.container({},!1),this.add(this.mChildContainer);var i=new c.NinePatch(this.scene,0,0,315,318,h.d.getName(),null,h.d.getConfig());this.mChildContainer.add(i);var o=this.scene.make.image({x:-this.width/2+20,y:-this.height/2-12,key:"rank_atlas",frame:"icon.png"},!1).setOrigin(0,0);this.add(o),this.mTitleLabel=this.scene.make.text({x:-this.width/2+54,y:-this.height/2-10,text:"排行榜",style:{font:l.a.YAHEI_20_BOLD}}).setOrigin(0,0).setStroke("#000000",2),this.add(this.mTitleLabel),t.prototype.init.call(this)}},BasicRankPanel.prototype.clearText=function(){for(var t=0,i=this.mTexts;t<i.length;t++){i[t].destroy()}this.mTexts.length=0},BasicRankPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"RightMediator",(function(){return u}));var r,a=o(134),h=o(195),l=o(119),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function RightMediator(i,o){return t.call(this,i,o)||this}return c(RightMediator,t),RightMediator.prototype.tweenView=function(t){this.mView&&this.mView.tweenView(t)},RightMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new h.RightBtnGroup(this.mScene,this.world),this.mView.show(i),this.world.emitter.on(l.a.UPDATED_CHARACTER_PACKAGE,this.heroItemChange,this),this.world.emitter.on(l.a.PACKAGE_ITEM_ADD,this.heroItemChange,this),t.prototype.show.call(this,i))},RightMediator.prototype.hide=function(){this.mShow=!1,this.world.emitter.off(l.a.UPDATED_CHARACTER_PACKAGE,this.heroItemChange,this),this.world.emitter.off(l.a.PACKAGE_ITEM_ADD,this.heroItemChange,this),this.mView&&(this.mView.hide(),this.mView=null)},RightMediator.prototype.heroItemChange=function(){this.world.roomManager.currentRoom&&this.world.roomManager.currentRoom.playerManager&&this.world.roomManager.currentRoom.playerManager.actor&&this.mView&&this.mView&&this.mView.refreshSlot()},RightMediator.NAME="RightMediator",RightMediator}(a.BaseFaceMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"BottomMediator",(function(){return c}));var r,a=o(134),h=o(196),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function BottomMediator(i,o){return t.call(this,i,o)||this}return l(BottomMediator,t),BottomMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new h.BottomBtnGroup(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i))},BottomMediator.NAME="BottomMediator",BottomMediator}(a.BaseFaceMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ElementStorageMediator",(function(){return m}));var r,a=o(197),h=o(199),l=o(119),c=o(110),u=o(2),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function ElementStorageMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mStorage=new h.ElementStorage(r),a.mLayerManager=i,a.mScene=o,a.register(),a}return d(ElementStorageMediator,t),ElementStorageMediator.prototype.show=function(t){this.mParam=t,this.mView&&this.mView.isShow()||this.mShow||(this.mView=new a.ElementStoragePanel(this.mScene,this.world),this.mStorage.register(),this.mStorage.on(l.a.EDIT_MODE_QUERY_PACKAGE,this.onEditModeQueryPackageHandler,this),this.mLayerManager.addToUILayer(this.mView),this.mView.on("queryElement",this.onQueryElementHandler,this),this.mView.on("selectedElement",this.onSelectedElement,this),this.mView.show(t))},ElementStorageMediator.prototype.hide=function(){this.mParam=void 0,t.prototype.hide.call(this)},ElementStorageMediator.prototype.isSceneUI=function(){return!0},ElementStorageMediator.prototype.expand=function(){var t=this.getView();t&&t.expand()},ElementStorageMediator.prototype.collapse=function(){var t=this.getView();t&&t.collapse()},ElementStorageMediator.prototype.destroy=function(){this.unregister(),this.mStorage&&(this.mStorage.unregister(),this.mStorage=void 0),t.prototype.destroy.call(this)},ElementStorageMediator.prototype.getView=function(){return this.mView},ElementStorageMediator.prototype.onQueryElementHandler=function(t,i){this.mParam?this.mStorage.queryMarketPackage(t,i):this.mStorage.queryPackage(t,i)},ElementStorageMediator.prototype.register=function(){this.world.emitter.on(l.a.EDIT_PACKAGE_EXPANED,this.onExpanedHandler,this),this.world.emitter.on(l.a.EDIT_PACKAGE_COLLAPSE,this.onCollapseHandler,this)},ElementStorageMediator.prototype.unregister=function(){this.world.emitter.off(l.a.EDIT_PACKAGE_EXPANED,this.onExpanedHandler,this),this.world.emitter.off(l.a.EDIT_PACKAGE_COLLAPSE,this.onCollapseHandler,this)},ElementStorageMediator.prototype.onEditModeQueryPackageHandler=function(t){t&&this.getView().setProps(t)},ElementStorageMediator.prototype.onSelectedElement=function(t){var i=new c.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SELECTED_SPRITE);i.content.id=t.id,this.world.connection.send(i)},ElementStorageMediator.prototype.onExpanedHandler=function(){this.expand()},ElementStorageMediator.prototype.onCollapseHandler=function(){this.collapse()},ElementStorageMediator.NAME="ElementStorageMediator",ElementStorageMediator}(p.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"Radio",(function(){return u})),o.d(i,"RadioItemRender",(function(){return p}));var r,a=o(117),h=o(111),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function Radio(i,o){var r=t.call(this,i)||this;return r.mIsShow=!1,r.mInit=!1,r.mScene=i,r.mConfig=o,r.init(),r}return c(Radio,t),Radio.prototype.setRadioData=function(t){this.clearRadioData(),this.itemList=[];for(var i=t.length,o=0;o<i;o++){var r=new p(this.mScene,this,this.mConfig.wid+10,20,this.mConfig.resKey,this.mConfig.resArrow),a=t[o];r.itemData={index:o,text:a.text,data:a.node.id,selected:!1,enabled:!0},r.x=this.mConfig.wid/2+25,r.y=33*o+23,this.add(r),this.itemList.push(r)}},Radio.prototype.clearRadioData=function(){if(this.itemList){for(var t=this.itemList.length,i=0;i<t;i++){var o=this.itemList[i];o&&(o.destroy(),o=null)}this.itemList.length=0}},Object.defineProperty(Radio.prototype,"isShow",{get:function(){return this.mIsShow},set:function(t){this.mIsShow=t},enumerable:!1,configurable:!0}),Radio.prototype.selectCall=function(t){this.mConfig.clickCallBack&&this.mConfig.clickCallBack.call(this,t)},Radio.prototype.destroy=function(){if(this.itemList){for(var i=this.itemList.length,o=0;o<i;o++){var r=this.itemList[o];r&&r.destroy()}this.itemList.length=0,this.itemList=null}this.removeAll(),this.removeAllListeners(),this.parentContainer&&this.parentContainer.remove(this),t.prototype.destroy.call(this,!0)},Radio.prototype.init=function(){var t=this.mConfig.resKey,i=this.mConfig.resPng,o=this.mConfig.resJson;this.mScene.cache.obj.has(t)?this.onLoadCompleteHandler():(this.mScene.load.atlas(t,i,o),this.mScene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.mScene.load.start())},Radio.prototype.onLoadCompleteHandler=function(){this.mInit=!0;var t=this.mConfig.resKey;this.mBg=new a.NinePatch(this.scene,0,0,this.mConfig.wid+20,this.mConfig.hei,h.a.getName(),null,h.a.getConfig()),this.mBg.setTexture(t,this.mConfig.resBg),this.mBg.x=this.mConfig.wid/2-2,this.mBg.y=this.mConfig.hei/2,this.addAt(this.mBg,0),this.setSize(this.mConfig.wid,this.mConfig.hei),this.mConfig.completeBack&&this.mConfig.completeBack()},Radio}(Phaser.GameObjects.Container),p=function(t){function RadioItemRender(i,o,r,a,h,c){var u=t.call(this,i)||this;u.mSelectCallUI=o,u.mText=new l.BBCodeText(i,0,0,"",{fontSize:"20px",wrap:{mode:"char",width:r}});return u.mSelectBG=i.make.graphics(void 0,!1),u.mSelectBG.fillStyle(16763904,.8),u.mSelectBG.fillRect(-r>>1,-a>>1,r-36,a),u.mSelectBG.visible=!1,u.setSize(r,a),u.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains),u.addListen(),u.mArrow=i.make.image(void 0,!1),u.mArrow.setTexture(h,c),u.mArrow.x=-r/2-10,u.mArrow.y=0,u.mArrow.visible=!1,u.add([u.mSelectBG,u.mText,u.mArrow]),u}return c(RadioItemRender,t),RadioItemRender.prototype.addListen=function(){this.on("pointerover",this.overHandler,this),this.on("pointerout",this.outHandler,this),this.on("pointerdown",this.selectHandler,this)},RadioItemRender.prototype.removeListen=function(){this.off("pointerover",this.overHandler,this),this.off("pointerout",this.outHandler,this),this.off("pointerdown",this.selectHandler,this)},Object.defineProperty(RadioItemRender.prototype,"itemData",{get:function(){return this.mData},set:function(t){this.mData=t,this.mText.text=this.mData.text,this.mText.x=-this.width>>1,this.mText.y=-this.height/2+(this.height-this.mText.height>>1)},enumerable:!1,configurable:!0}),RadioItemRender.prototype.destroy=function(){this.removeListen(),this.mText.destroy(!0),this.mSelectBG.destroy(!0),this.mArrow.destroy(!0),this.mText=null,this.mData=null,this.mSelectCallUI=null,this.mArrow=null,t.prototype.destroy.call(this,!0)},RadioItemRender.prototype.setSelected=function(t){this.mSelectBG.visible=t,this.mArrow.visible=t,this.mSelectCallUI&&this.mSelectCallUI.selectCall(this.itemData)},RadioItemRender.prototype.overHandler=function(){this.mSelectBG.visible=!0,this.mArrow.visible=!0},RadioItemRender.prototype.outHandler=function(){this.mSelectBG.visible=!1,this.mArrow.visible=!1},RadioItemRender.prototype.selectHandler=function(){this.overHandler(),this.mSelectCallUI.selectCall(this.itemData)},RadioItemRender}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"InputPanel",(function(){return u}));var r,a=o(113),h=o(109),l=o(0),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function InputPanel(i,o,r){var l=t.call(this)||this;l.scene=i,l.world=o;var c=i.cameras.main.width,u=i.cameras.main.height;return l.mBackground=i.add.graphics(),l.mBackground.fillStyle(0,.6),l.mBackground.fillRect(0,0,c,u).setInteractive(new Phaser.Geom.Rectangle(0,0,c,u),Phaser.Geom.Rectangle.Contains),l.mTextArea=l.scene.add.text(c/2,u,"",{fontSize:11*o.uiRatio,bold:!0,fontFamily:a.a.DEFULT_FONT,color:"#356EE3"}).setOrigin(1,0),l.mInput=new h.InputText(i,6*o.uiRatio,6*o.uiRatio,c-12*o.uiRatio,40*o.uiRatio,{fontSize:20*o.uiRatio+"px",color:"#0",text:r,backgroundColor:"#FFFFFF",borderColor:"#FF9900"}).setOrigin(0,0),l.mInput.node.addEventListener("keypress",(function(t){13===(t.keyCode||t.which)&&l.onCloseHandler()})),l.scene.input.on("pointerdown",l.onFoucesHandler,l),l.mInput.setFocus(),l}return c(InputPanel,t),InputPanel.prototype.onCloseHandler=function(){this.emit("close",this.mInput.text),this.mBackground.destroy(),this.mInput.destroy(),this.destroy(),this.scene.input.off("pointerdown",this.onFoucesHandler,this),this.scene=void 0},InputPanel.prototype.onFoucesHandler=function(){l.a.getInstance().log("fouces----log"),this.mInput.node.focus()},InputPanel}(Phaser.Events.EventEmitter)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHandheldMediator",(function(){return p}));var r,a=o(244),h=o(245),l=o(148),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicHandheldMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return u(PicHandheldMediator,t),PicHandheldMediator.prototype.show=function(){this.picHand||(this.picHand=new a.PicHandheld(this.world),this.picHand.on("handheldlist",this.onHandheldList,this),this.picHand.register()),this.mView||(this.mView=new h.PicHandheldPanel(this.scene,this.world),this.mView.on("changehandheld",this.onChangeHandheld,this),this.mView.on("clearhandheld",this.onClearHandheld,this),this.mView.on("handheldlist",this.onReqHandheldList,this),this.mView.on("openeqiped",this.openEquipedPanel,this)),this.mView.show(),this.layerManager.addToUILayer(this.mView)},PicHandheldMediator.prototype.hide=function(){t.prototype.hide.call(this),this.layerManager.removeToUILayer(this.mView)},PicHandheldMediator.prototype.getView=function(){return this.mView},PicHandheldMediator.prototype.destroy=function(){this.picHand&&(this.picHand.destroy(),this.picHand=void 0),t.prototype.destroy.call(this)},PicHandheldMediator.prototype.isSceneUI=function(){return!0},PicHandheldMediator.prototype.onHandheldList=function(t){this.mView.setEqipedDatas(t)},PicHandheldMediator.prototype.onChangeHandheld=function(t){this.picHand.queryChangeHandheld(t)},PicHandheldMediator.prototype.onReqHandheldList=function(){this.picHand.queryHandheldList()},PicHandheldMediator.prototype.onClearHandheld=function(){this.picHand.queryClearHandheld()},PicHandheldMediator.prototype.openEquipedPanel=function(t){var i=this.world.uiManager.getMediator(l.PicaChatMediator.name);i&&(t?i.hide():(i.show(),this.layerManager.removeToUILayer(this.mView),this.layerManager.addToUILayer(this.mView)))},PicHandheldMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"DebugLoggerMediator",(function(){return c}));var r,a=o(264),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function DebugLoggerMediator(i,o,r){var a=t.call(this)||this;return a.mUIType=h.UIType.Scene,a.mScene=o,a.world=r,a}return l(DebugLoggerMediator,t),DebugLoggerMediator.prototype.resize=function(){if(this.mView)return this.mView.resize()},DebugLoggerMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},DebugLoggerMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new a.DebugLogger(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i))},DebugLoggerMediator.prototype.hide=function(){this.mShow=!1,this.mView&&(this.mView.hide(),this.mView=null)},DebugLoggerMediator.prototype.destroy=function(){this.mScene=null,t.prototype.destroy.call(this)},DebugLoggerMediator.NAME="DebugLoggerMediator",DebugLoggerMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessContentPanel",(function(){return p}));var r,a=o(113),h=o(115),l=o(114),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicBusinessContentPanel(i,o,r,a,h,l,c,u){var p=t.call(this,i,o,r)||this;return p.setSize(a,h),p.dpr=l,p.key=c,p.key2=u,p.create(),p}return u(PicBusinessContentPanel,t),PicBusinessContentPanel.prototype.create=function(){var t=this.width,i=this.height;this.bg=new c.NineSlicePatch(this.scene,0,0,t,i,h.UIAtlasKey.common2Key,"bg",{left:70*this.dpr,top:30*this.dpr,right:30*this.dpr,bottom:70*this.dpr}),this.add(this.bg);var o=.5*-i;this.topbg=this.scene.make.image({key:this.key,frame:"eaves"}),this.topbg.y=o-2*this.dpr,this.add(this.topbg),this.titlebg=this.scene.make.image({key:this.key,frame:"title"}),this.titlebg.y=o-25*this.dpr,this.add(this.titlebg);var r="bold "+15*this.dpr+"px "+a.a.BOLD_FONT;this.titleText=this.scene.make.text({x:0,y:this.titlebg.y-5*this.dpr,text:l.a.t("business_street.commercial_street"),style:{font:r,bold:!0,color:"#FFD248"}}).setOrigin(.5,0),this.titleText.setStroke("#553100",2*this.dpr),this.titleText.setShadow(2,2,"#553100",4*this.dpr,!0,!0),this.add(this.titleText),this.closeBtn=new c.Button(this.scene,h.UIAtlasKey.commonKey,"close"),this.closeBtn.setDisplaySize(28*this.dpr,28*this.dpr),this.closeBtn.setPosition(.5*this.width-6*this.dpr,o+5*this.dpr),this.closeBtn.on(String(c.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn),this.setContentSize(t,i)},PicBusinessContentPanel.prototype.setContentSize=function(t,i){this.setSize(t,i),this.bg.resize(t,i);var o=.5*-i;this.topbg.y=o-2*this.dpr,this.titlebg.y=o-25*this.dpr,this.titleText.y=this.titlebg.y-5*this.dpr,this.closeBtn.setPosition(.5*this.width-6*this.dpr,o+5*this.dpr)},PicBusinessContentPanel.prototype.setTitleText=function(t){this.titleText.text=t},PicBusinessContentPanel.prototype.setCloseHandler=function(t){this.closeHandler=t},PicBusinessContentPanel.prototype.onCloseHandler=function(){this.closeHandler&&this.closeHandler.run()},PicBusinessContentPanel}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.d(i,"a",(function(){return d}));var r,a=o(113),h=o(128),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function MainUIScene(){var i=t.call(this,{key:MainUIScene.name})||this;return i.timeOutID=0,i.timeOutCancelMap={},i.timeOutCallerList=[],i.timeOutTimeMap={},i}return l(MainUIScene,t),MainUIScene.prototype.preload=function(){},MainUIScene.prototype.init=function(t){this.mRoom=t.room,this.mRoom&&this.mRoom.world.uiManager.setScene(null)},MainUIScene.prototype.create=function(){t.prototype.create.call(this);var i=this.mRoom.world,o=i.getSize().width;this.fps=this.add.text(.5*o,10,"",{style:{color:"#64DD17"}}),this.fps.setStroke("0x0",1),this.fps.setFontFamily(a.a.DEFULT_FONT),this.fps.setFontSize(20*window.devicePixelRatio),this.fps.setDepth(1e3),this.sizeTF=this.add.text(10,50,"",{style:{color:"#64DD17"},wordWrap:{width:800,useAdvancedWrap:!0}}),this.sizeTF.setFontSize(20*window.devicePixelRatio),this.sizeTF.setFontFamily(a.a.DEFULT_FONT),this.sizeTF.setStroke("#0",3),i.game.device.os.desktop||i.inputManager&&i.inputManager.setScene(this),i.uiManager.setScene(this),this.mRoom.initUI()},MainUIScene.prototype.setTimeout=function(t,i){var o=Date.now();return this.timeOutCallerList[++this.timeOutID]=t,this.timeOutTimeMap[this.timeOutID]={now:o,delay:i},this.timeOutID},MainUIScene.prototype.clearTimeout=function(t){this.timeOutCancelMap[t]=!0},MainUIScene.prototype.update=function(t,i){this.fps.setText(this.game.loop.actualFps.toFixed())},MainUIScene.prototype.getKey=function(){return this.sys.config.key},MainUIScene.prototype.checkSize=function(t){t.width,t.height;var i=this.mRoom.world,o=i.getSize();this.sizeTF.text="CSS size: "+i.getConfig().width+" "+i.getConfig().height+"\n    Game size: "+o.width.toFixed(2)+" "+o.height.toFixed(2)+"\n    deviceRatio: "+window.devicePixelRatio+"\n    scene ratio: "+i.scaleRatio+"\n    ui ratio: "+i.uiRatio+"\n    ui scale: "+i.uiScale.toFixed(5)+"\n    "},MainUIScene}(h.a),u=o(341),p=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),d=function(t){function PlayScene(i){return t.call(this,i||{key:PlayScene.name})||this}return p(PlayScene,t),PlayScene.prototype.preload=function(){},PlayScene.prototype.init=function(t){t&&(this.mRoom=t.room)},PlayScene.prototype.create=function(){var t=this.cameras.main;this.cameras.addExisting(new u.a(0,0,this.sys.scale.width,this.sys.scale.height,this.mRoom.world.scaleRatio),!0),this.cameras.remove(t),this.game.scene.getScene(c.name)||this.game.scene.add(c.name,c,!1),this.game.scene.getScene(c.name).scene.isActive()?this.mRoom.initUI():this.scene.launch(c.name,{room:this.mRoom}),this.scene.sendToBack(),this.scale.on("orientationchange",this.checkOriention,this),this.scale.on("resize",this.checkSize,this),this.mRoom&&this.mRoom.startPlay()},PlayScene.prototype.update=function(t,i){this.mRoom&&this.mRoom.update(t,i)},PlayScene.prototype.getKey=function(){return this.sys.config.key},PlayScene.prototype.checkOriention=function(t){t===Phaser.Scale.PORTRAIT||Phaser.Scale.LANDSCAPE},PlayScene.prototype.checkSize=function(t){t.width,t.height},PlayScene}(h.a)},,,,,function(t,i,o){"use strict";o.r(i),o.d(i,"DynamicSprite",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function DynamicSprite(i,o,r){var a=t.call(this,i,o,r,void 0)||this;return i.sys.updateList.add(a),a}return a(DynamicSprite,t),DynamicSprite.prototype.load=function(t,i,o,r,a){this.mLoadCompleteCallbak=r,this.mLoadErrorCallback=a,this.mLoadContext=o,this.mUrl=t+i,this.scene.cache.obj.get(this.mUrl)?this.onLoadComplete():(this.scene.load.atlas(this.mUrl,t,i),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start())},DynamicSprite.prototype.destroy=function(i){this.scene.sys.updateList.remove(this),t.prototype.destroy.call(this,i)},DynamicSprite.prototype.onLoadComplete=function(){if(this.mLoadCompleteCallbak){var t=this.mLoadCompleteCallbak;this.mLoadCompleteCallbak=null,t.call(this.mLoadContext),this.mLoadContext=null}this.scene.anims.create({key:this.mUrl,frames:this.scene.anims.generateFrameNames(this.mUrl),repeat:1}),this.play(this.mUrl)},DynamicSprite.prototype.onLoadError=function(t){if(this.mUrl===t.url&&this.mLoadErrorCallback){var i=this.mLoadErrorCallback;this.mLoadErrorCallback=null,i.call(this.mLoadContext),this.mLoadContext=null}},DynamicSprite}(Phaser.GameObjects.Sprite)},function(t,i,o){"use strict";o.d(i,"a",(function(){return h}));var r=o(122),a=o(118),h=function(){function BlockObject(t){this.mRoomService=t,this.isUsed=!1,this.mRenderable=!1,this.mBlockable=!0,this.mInputEnable=r.c.Diasble,this.isUsed=!0}return BlockObject.prototype.setRenderable=function(t,i){var o=this;if(void 0===i&&(i=0),this.mRenderable!==t){if(this.mRenderable=t,t)return this.addDisplay(),void(i>0&&this.fadeIn());i>0?this.fadeOut((function(){o.removeDisplay()})):this.removeDisplay()}},BlockObject.prototype.getPosition=function(){return this.mDisplay?new a.a(this.mDisplay.x,this.mDisplay.y,this.mDisplay.z):new a.a},BlockObject.prototype.getPosition45=function(){var t=this.getPosition();return t?this.mRoomService.transformTo45(t):new a.a},BlockObject.prototype.getRenderable=function(){return this.mRenderable},BlockObject.prototype.fadeIn=function(t){this.mDisplay&&this.mDisplay.fadeIn(t)},BlockObject.prototype.fadeOut=function(t){this.mDisplay&&this.mDisplay.fadeOut(t)},BlockObject.prototype.fadeAlpha=function(t){this.mDisplay},BlockObject.prototype.setInputEnable=function(t){if(this.mInputEnable=t,this.mDisplay)switch(t){case r.c.Interactive:this.mModel&&this.mModel.hasInteractive&&this.mDisplay.setInteractive();break;case r.c.Enable:this.mDisplay.setInteractive();break;default:this.mDisplay.disableInteractive()}},BlockObject.prototype.setBlockable=function(t){return this.mBlockable!==t&&(this.mBlockable=t,this.mDisplay&&this.mRoomService&&(t?this.mRoomService.addBlockObject(this):this.mRoomService.removeBlockObject(this))),this},BlockObject.prototype.destroy=function(){this.mDisplay&&(this.mDisplay.destroy(),this.mDisplay=null)},BlockObject.prototype.clear=function(){this.isUsed=!1},BlockObject.prototype.addDisplay=function(){},BlockObject.prototype.removeDisplay=function(){this.mDisplay&&this.mDisplay.removeFromParent()},BlockObject.prototype.addToBlock=function(){this.mBlockable?this.mRoomService.addBlockObject(this):this.addDisplay()},BlockObject.prototype.removeFromBlock=function(t){this.mBlockable&&(this.mRoomService.removeBlockObject(this),t&&this.setRenderable(!1))},BlockObject.prototype.updateBlock=function(){this.mBlockable&&this.mRoomService.updateBlockObject(this)},BlockObject.prototype.disableBlock=function(){this.removeFromBlock(),this.mBlockable=!1,this.mRenderable=!1},BlockObject.prototype.enableBlock=function(){this.mBlockable=!0,this.addToBlock()},Object.defineProperty(BlockObject.prototype,"id",{get:function(){return-1},enumerable:!1,configurable:!0}),BlockObject}()},function(t,i,o){"use strict";o.r(i),o.d(i,"DynamicNinepatch",(function(){return a}));var r=o(109),a=function(){function DynamicNinepatch(t,i){this.mScene=t,this.mParent=i}return DynamicNinepatch.prototype.load=function(t,i,o,r){this.mLoadCompleteCallBack=o,this.mLoadContext=r,this.mConfig=i,this.mUrl=t,this.mScene.cache.obj.get(t)?this.onLoadCompleteHandler():(this.mScene.load.image(this.mUrl,this.mUrl),this.mScene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.mScene.load.start())},DynamicNinepatch.prototype.onLoadCompleteHandler=function(){this.mImage=new r.NinePatch(this.mScene,this.mConfig),this.mLoadCompleteCallBack&&(this.mLoadCompleteCallBack.call(this.mLoadContext,this.mImage),this.mLoadCompleteCallBack=null,this.mLoadContext=null)},Object.defineProperty(DynamicNinepatch.prototype,"image",{get:function(){return this.mImage},enumerable:!1,configurable:!0}),DynamicNinepatch}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return d}));var r,a=o(110),h=o(2),l=o(340),c=o(126),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=h.op_def.NodeType,d=function(t){function TerrainManager(i,o){var r=t.call(this)||this;r.mRoom=i,r.hasAddComplete=!1,r.mTerrains=new Map,r.mPacketFrameCount=0,r.mListener=o,r.connection&&(r.connection.addPacketListener(r),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE,r.onAdd),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END,r.addComplete),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE,r.onRemove),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE,r.onSyncSprite),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION,r.onChangeAnimation)),r.mRoom&&r.mRoom.world&&(r.mGameConfig=r.mRoom.world.elementStorage);var a=r.roomService.miniSize;r.mMap=new Array(a.cols);for(var l=0;l<a.rows;l++)r.mMap[l]=new Array(a.rows).fill(0);return r}return u(TerrainManager,t),TerrainManager.prototype.init=function(){},TerrainManager.prototype.destroy=function(){var t=this;this.connection&&this.connection.removePacketListener(this),this.mTerrains&&(this.mTerrains.forEach((function(i){return t.remove(i.id)})),this.mTerrains.clear())},TerrainManager.prototype.get=function(t){var i=this.mTerrains.get(t);if(i)return i},TerrainManager.prototype.add=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i];this._add(r)}},TerrainManager.prototype.remove=function(t){if(this.mTerrains){var i=this.mTerrains.get(t);return i&&(this.mTerrains.delete(t),i.destroy()),i}},TerrainManager.prototype.getElements=function(){return Array.from(this.mTerrains.values())},TerrainManager.prototype.onAdd=function(t){if(this.mPacketFrameCount++,this.mGameConfig){var i=t.content,o=i.sprites,r=i.nodeType,a=i.packet;if(r===h.op_def.NodeType.TerrainNodeType){for(var l=[],u=0,p=o;u<p.length;u++){var d=p[u];if(d.point3f){var m=new c.a(d,r);m.displayInfo||this.checkTerrainDisplay(m),m.displayInfo||l.push(m.id),this._add(m)}}this.fetchDisplay(l),this.mListener&&this.mPacketFrameCount===a.totalFrame&&this.mListener.onFullPacketReceived(r)}}},TerrainManager.prototype._add=function(t){var i=this.mTerrains.get(t.id);return i?i.model=t:i=new l.a(t,this),this.mTerrains.set(i.id||0,i),i},TerrainManager.prototype.addComplete=function(t){this.hasAddComplete=!0},TerrainManager.prototype.onRemove=function(t){var i=t.content,o=i.nodeType,r=i.ids;if(o===h.op_def.NodeType.TerrainNodeType)for(var a=0,l=r;a<l.length;a++){var c=l[a];this.remove(c)}},TerrainManager.prototype.onSyncSprite=function(t){var i=t.content;if(i.nodeType===h.op_def.NodeType.TerrainNodeType)for(var o=null,r=0,a=i.sprites;r<a.length;r++){var l=a[r];if(o=this.get(l.id)){var u=new c.a(l,i.nodeType);o.model=u}}},TerrainManager.prototype.checkDisplay=function(t){if(!t.displayInfo){var i=this.roomService.world.elementStorage.getDisplayModel(t.bindID||t.id);if(i)return t.displayInfo=i,i}},TerrainManager.prototype.checkTerrainDisplay=function(t){if(!t.displayInfo){var i=this.roomService.world.elementStorage.getTerrainPaletteByBindId(t.bindID);i&&(t.displayInfo=i)}},TerrainManager.prototype.fetchDisplay=function(t){if(0!==t.length){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);i.content.ids=t,this.connection.send(i)}},TerrainManager.prototype.removeMap=function(t){this.setMap(t,1)},TerrainManager.prototype.addMap=function(t){this.setMap(t,0)},TerrainManager.prototype.setMap=function(t,i){var o=t.displayInfo;if(o){var r=t.currentAnimation.name,a=o.getCollisionArea(r,!1),h=(o.getWalkableArea(r,!1),o.getOriginPoint(r,!1),a.length),l=a[0].length;1===h&&1===l&&(h=2,l=2,!1);t.pos;for(var c=0;c<h;c++)for(var u=0;u<l;u++);}},TerrainManager.prototype.onChangeAnimation=function(t){var i=t.content;if(i.nodeType===p.TerrainNodeType){i.changeAnimation;for(var o=0,r=i.ids;o<r.length;o++){var a=r[o];this.get(a)}}},Object.defineProperty(TerrainManager.prototype,"connection",{get:function(){if(this.mRoom)return this.mRoom.connection},enumerable:!1,configurable:!0}),Object.defineProperty(TerrainManager.prototype,"roomService",{get:function(){return this.mRoom},enumerable:!1,configurable:!0}),Object.defineProperty(TerrainManager.prototype,"scene",{get:function(){if(this.mRoom)return this.mRoom.scene},enumerable:!1,configurable:!0}),Object.defineProperty(TerrainManager.prototype,"camera",{get:function(){return this.camera},enumerable:!1,configurable:!0}),Object.defineProperty(TerrainManager.prototype,"map",{get:function(){return this.mMap},enumerable:!1,configurable:!0}),TerrainManager}(a.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return l}));var r,a=o(141),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function TerrainDisplay(){return null!==t&&t.apply(this,arguments)||this}return h(TerrainDisplay,t),TerrainDisplay.prototype.showRefernceArea=function(){},TerrainDisplay}(a.a)},function(t,i,o){"use strict";o.d(i,"a",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function Size(i,o){return t.call(this,i,o)||this}return a(Size,t),Size}(Phaser.Structs.Size)},function(t,i,o){"use strict";o.d(i,"a",(function(){return c}));var r,a=o(393),h=o(110),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function SkyBoxManager(i){var o=t.call(this)||this;return o.mRoom=i,o.mScenetys=new Map,o}return l(SkyBoxManager,t),SkyBoxManager.prototype.add=function(t){var i=new a.a(t,this.mRoom);this.mScenetys.set(t.id,i)},SkyBoxManager.prototype.update=function(t){var i=this.mScenetys.get(t.id);i&&i.update(t)},SkyBoxManager.prototype.remove=function(t){var i=this.mScenetys.get(t);i&&i.destroy()},SkyBoxManager.prototype.setState=function(t){this.mStateMap||(this.mStateMap=new Map),this.mStateMap.set(t.name,t),this.mScenetys.forEach((function(i){i.setState(t)}))},SkyBoxManager.prototype.resize=function(t,i){this.mScenetys&&this.mScenetys.forEach((function(o){o.resize(t,i)}))},SkyBoxManager.prototype.destroy=function(){if(this.mRoom){var t=this.mRoom.connection;t&&t.removePacketListener(this)}this.mScenetys.forEach((function(t){return t.destroy()})),this.mScenetys.clear()},Object.defineProperty(SkyBoxManager.prototype,"scenery",{get:function(){return Array.from(this.mScenetys.values())},enumerable:!1,configurable:!0}),SkyBoxManager}(h.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"DecorateManager",(function(){return u}));var r,a=o(182),h=o(110),l=o(2),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function DecorateManager(i,o){var r=t.call(this)||this;return r.mPanel=new a.DecoratePanel(i,o),r.mPanel.on("moveElement",r.onMoveElementHandler,r),r.mPanel.on("addSprite",r.onAddSpriteHandler,r),r.mPanel.on("addSingleSprite",r.onAddSingleSprtieHandle,r),r.mRoomService=o,r.mLayerManager=o.layerManager,r}return c(DecorateManager,t),DecorateManager.prototype.setElement=function(t){this.mPanel.setElement(t),this.mLayerManager.addToSceneToUI(this.mPanel),this.mPanel.show()},DecorateManager.prototype.canPut=function(t){this.mPanel&&this.mPanel.canPUt(t)},DecorateManager.prototype.remove=function(){this.mPanel.parentContainer&&this.mPanel.parentContainer.remove(this.mPanel),this.mPanel.removeListen()},DecorateManager.prototype.updatePos=function(t,i){this.mPanel&&this.mPanel.setPos(t,i)},DecorateManager.prototype.destroy=function(){this.mPanel&&this.mPanel.destroy(),t.prototype.destroy.call(this)},DecorateManager.prototype.onMoveElementHandler=function(t){this.emit("moveElement",t)},DecorateManager.prototype.onAddSpriteHandler=function(t,i){this.sendAddSpriteByType(t,i)},DecorateManager.prototype.onAddSingleSprtieHandle=function(t,i){this.sendAddSingleSprite(t,i)},DecorateManager.prototype.sendAddSpriteByType=function(t,i){if(t&&i&&!(i.length<1)){for(var o=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SPRITE_BY_TYPE),r=o.content,a=[],c=0,u=i;c<u.length;c++){var p=u[c],d=l.op_def.PBPoint3f.create();d.x=p.x,d.y=p.y,a.push(d)}r.nodeType=l.op_def.NodeType.ElementNodeType,r.sprite=t.toSprite(),r.points=a,this.mRoomService.connection.send(o)}},DecorateManager.prototype.sendAddSingleSprite=function(t,i){if(t&&i&&!(i.length<1)){for(var o=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SINGLE_SPRITE_BY_TYPE),r=o.content,a=[],c=0,u=i;c<u.length;c++){var p=u[c],d=l.op_def.PBPoint3f.create();d.x=p.x,d.y=p.y,a.push(d)}r.nodeType=l.op_def.NodeType.ElementNodeType,r.sprite=t.toSprite(),r.points=a,this.mRoomService.connection.send(o)}},DecorateManager}(Phaser.Events.EventEmitter)},function(t,i,o){"use strict";o.r(i),o.d(i,"DecoratePanel",(function(){return m}));var r,a=o(112),h=o(118),l=o(138),c=o(119),u=o(122),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function DecoratePanel(i,o){var r=t.call(this,i,o.world)||this;return r.mRoomService=o,r.resKey="decorate",r.minGrid=2,r.maxGrid=10,r.key="decorate_edit_menu",r.offset=new h.a,r.mScaleRatio=1,r.setTween(!1),r.mWorld&&(r.mScaleRatio=r.mWorld.scaleRatio),r}return d(DecoratePanel,t),DecoratePanel.prototype.show=function(t){this.mShowData=t,this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0):this.preload()},DecoratePanel.prototype.addListen=function(){this.mCancelBtn&&this.mCancelBtn.on(String(p.ClickEvent.Tap),this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.on(String(p.ClickEvent.Tap),this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.on(String(p.ClickEvent.Tap),this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.on(String(p.ClickEvent.Tap),this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.on(String(p.ClickEvent.Tap),this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.on(String(p.ClickEvent.Tap),this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.on(String(p.ClickEvent.Tap),this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.register(),this.mMoveMenuContainer.on("tap",this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.register(),this.mRepeatMenuContainer.on("tap",this.onRepeatHandler,this),this.mRepeatMenuContainer.on("hold",this.onHoldRepeatHandler,this))},DecoratePanel.prototype.removeListen=function(){this.mCancelBtn&&this.mCancelBtn.off(String(p.ClickEvent.Tap),this.onCancelHandler,this),this.mOkBtn&&this.mOkBtn.off(String(p.ClickEvent.Tap),this.onAddHandler,this),this.mRecycleBtn&&this.mRecycleBtn.off(String(p.ClickEvent.Tap),this.onRecycleHandler,this),this.mTurnBtn&&this.mTurnBtn.off(String(p.ClickEvent.Tap),this.onTurnHandler,this),this.mMoveBtn&&this.mMoveBtn.off(String(p.ClickEvent.Tap),this.onShowMoveMenuHandler,this),this.mRepeatBtn&&this.mRepeatBtn.off(String(p.ClickEvent.Tap),this.onShowRepeatHandler,this),this.mExtendBtn&&this.mExtendBtn.off(String(p.ClickEvent.Tap),this.onShowExtendsHandler,this),this.mMoveMenuContainer&&(this.mMoveMenuContainer.unRegister(),this.mMoveMenuContainer.off("tap",this.onMoveHandler,this)),this.mRepeatMenuContainer&&(this.mRepeatMenuContainer.unRegister(),this.mRepeatMenuContainer.off("tap",this.onRepeatHandler,this),this.mRepeatMenuContainer.off("hold",this.onHoldRepeatHandler,this))},DecoratePanel.prototype.setElement=function(t){if(this.mDisplayObject=t,this.mSprite=t.model,this.mInitialized){var i=this.mDisplayObject.getPosition();this.x=i.x,this.y=i.y,this.updateArrowPos(t),this.addListen()}},DecoratePanel.prototype.canPUt=function(t){if(t!==this.mCanPut){if(this.mCanPut=t,!this.mOkBtn)return;this.mOkBtn.enable=t}},DecoratePanel.prototype.setPos=function(t,i,o){return this.x=t*this.mScaleRatio,this.y=(i+this.offset.y)*this.mScaleRatio,this.z=o||0,this},DecoratePanel.prototype.destroy=function(){this.mRepeatMenuContainer&&this.mRepeatMenuContainer.destroy(),this.mMoveMenuContainer&&this.mMoveMenuContainer.destroy(),t.prototype.destroy.call(this)},DecoratePanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_edit_menu/decorate_edit_menu.png","decorate_edit_menu/decorate_edit_menu.json"),t.prototype.preload.call(this)},DecoratePanel.prototype.init=function(){var i=this.scene.cameras.main.width/this.scale;this.scene.cameras.main.height,this.scale;this.mMainMenus=[],this.mMenuContainer=this.scene.make.container({x:i>>1},!1),this.mSubMenus=this.scene.make.container({x:i>>1,y:60*this.dpr},!1),this.mOkBtn=new p.Button(this.scene,this.key,"ok_btn.png"),this.mRecycleBtn=new p.Button(this.scene,this.key,"recycly_btn.png"),this.mTurnBtn=new p.Button(this.scene,this.key,"turn_btn.png"),this.mCancelBtn=new p.Button(this.scene,this.key,"cancel_btn.png"),this.mMenuContainer.y=.5*this.mOkBtn.height,this.mSubMenus.y=this.mMenuContainer.y+60*this.dpr,this.mHorizontalBtn=new p.Button(this.scene,this.key,"horizontal_btn.png"),this.mMoveBtn=new p.Button(this.scene,this.key,"move_btn.png"),this.mRepeatBtn=new p.Button(this.scene,this.key,"repeat_btn.png"),this.mExtendBtn=new p.Button(this.scene,this.key,"extend_btn.png"),this.mMoveMenuContainer=new y(this.scene,this.key,this.dpr,this.scale),this.mMoveMenuContainer.y=this.mSubMenus.y+15*this.dpr+this.mMoveMenuContainer.height,this.mRepeatMenuContainer=new y(this.scene,this.key,this.dpr,this.scale),this.mRepeatMenuContainer.y=this.mMoveMenuContainer.y;var o=this.scale;this.add([this.mMenuContainer,this.mSubMenus]),this.mMenuContainer.add([this.mOkBtn,this.mTurnBtn,this.mRecycleBtn,this.mCancelBtn]),this.mSubMenus.add([this.mHorizontalBtn,this.mMoveBtn,this.mRepeatBtn,this.mExtendBtn]);var r=i-55*this.dpr*this.mWorld.uiScale*2;this.mMenuContainer.x=-r>>1;var a=this.mMenuContainer.list;a.map((function(t){return r-=t.width}));for(var h=r/(a.length-1)/o,l=1;l<a.length;l++){var c=a[l-1];a[l].x=c.width+c.x+h}r=i-70*this.dpr*this.mWorld.uiScale*2,this.mSubMenus.x=-r>>1;var u=this.mSubMenus.list;u.map((function(t){return r-=t.width})),h=r/(u.length-1)/o;for(l=1;l<u.length;l++){c=u[l-1];u[l].x=c.width+c.x+h}this.mMoveMenuContainer.x=this.mSubMenus.x+this.mMoveBtn.x+29*this.dpr,this.mRepeatMenuContainer.x=this.mSubMenus.x+this.mRepeatBtn.x+29*this.dpr,this.mOkBtn.enable=this.mCanPut,t.prototype.init.call(this),this.setElement(this.mDisplayObject)},DecoratePanel.prototype.onLeftUpHandler=function(){if(this.mDisplayObject){var t=this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());t.x-=1,this.onMoveElement(t)}},DecoratePanel.prototype.onLeftDownHandler=function(){var t=this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());t.y+=1,this.onMoveElement(t)},DecoratePanel.prototype.onRightUpHandler=function(){var t=this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());t.y-=1,this.onMoveElement(t)},DecoratePanel.prototype.onRightDownHandler=function(){var t=this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());t.x=t.x+1,this.onMoveElement(t)},DecoratePanel.prototype.getNorthWestPoints=function(t){void 0===t&&(t=10);for(var i=this.mSprite.currentCollisionArea,o=this.mSprite.currentCollisionPoint,r=[],a=this.mRoomService.transformToMini45(this.mSprite.pos),h=0;h<t;h++)r[h]=this.mRoomService.transformToMini90(a),a.x-=i[0].length;return this.checkNextPos(r,i,o)},DecoratePanel.prototype.getWestSouthPoints=function(t){void 0===t&&(t=10);for(var i=this.mSprite.currentCollisionArea,o=this.mSprite.currentCollisionPoint,r=[],a=this.mRoomService.transformToMini45(this.mSprite.pos),h=0;h<t;h++)r[h]=this.mRoomService.transformToMini90(a),a.y+=i.length;return this.checkNextPos(r,i,o)},DecoratePanel.prototype.getSouthEastPoints=function(t){void 0===t&&(t=10);for(var i=this.mSprite.currentCollisionArea,o=this.mSprite.currentCollisionPoint,r=[],a=this.mRoomService.transformToMini45(this.mSprite.pos),h=0;h<t;h++)r[h]=this.mRoomService.transformToMini90(a),a.x+=i[0].length;return this.checkNextPos(r,i,o)},DecoratePanel.prototype.getEastNorthPoints=function(t){void 0===t&&(t=10);for(var i=this.mSprite.currentCollisionArea,o=this.mSprite.currentCollisionPoint,r=[],a=this.mRoomService.transformToMini45(this.mSprite.pos),h=0;h<t;h++)r[h]=this.mRoomService.transformToMini90(a),a.y-=i.length;return this.checkNextPos(r,i,o)},DecoratePanel.prototype.checkNextPos=function(t,i,o){for(var r=[],a=0,h=t;a<h.length;a++){var l=h[a],c=this.getNextRepeatPos(l,i,o);if(!c)break;r.push(c)}return r},DecoratePanel.prototype.getNextRepeatPos=function(t,i,o){if(this.mRoomService.canPut(t,i,o))return t},DecoratePanel.prototype.onMoveElement=function(t){if(this.mDisplayObject){var i=this.mRoomService.transformToMini90(t);this.emit("moveElement",i)}},DecoratePanel.prototype.createImage=function(t,i,o,r){return this.scene.make.image({key:t,frame:i,x:o,y:r},!1).setInteractive().setOrigin(0)},DecoratePanel.prototype.validateGrid=function(t){return t>this.maxGrid&&(t=this.maxGrid),t<this.minGrid&&(t=this.minGrid),t},DecoratePanel.prototype.updateArrowPos=function(t){var i;if(t&&t.model&&t.getDisplay()){t.getDisplay();var o=t.model.currentCollisionArea.length,r=t.model.currentCollisionArea[0].length;o=this.validateGrid(o),r=this.validateGrid(r),-1===t.getDisplay().scaleX&&(o=(i=[r,o])[0],r=i[1]);var a=this.mRoomService.roomSize,c={rows:o,cols:r,tileWidth:a.tileWidth/2,tileHeight:a.tileHeight/2},u=t.model,p=l.a.transformTo90(new h.a(r-u.currentCollisionPoint.y,o-u.currentCollisionPoint.x),c);this.offset.y=p.y}},DecoratePanel.prototype.onTurnHandler=function(){this.mWorld.emitter.emit(c.a.TURN_ELEMENT,this.mDisplayObject)},DecoratePanel.prototype.onRecycleHandler=function(){this.mWorld.emitter.emit(c.a.RECYCLE_ELEMENT,this.mDisplayObject)},DecoratePanel.prototype.onCancelHandler=function(){this.mWorld.emitter.emit(c.a.CANCEL_PUT,this.mDisplayObject)},DecoratePanel.prototype.onAddHandler=function(){this.mCanPut&&this.mWorld.emitter.emit(c.a.PUT_ELEMENT,this.mDisplayObject)},DecoratePanel.prototype.onMoveHandler=function(t){if("number"==typeof t)switch(t){case u.a.north_west:this.onLeftUpHandler();break;case u.a.west_south:this.onLeftDownHandler();break;case u.a.south_east:this.onRightDownHandler();break;case u.a.east_north:this.onRightUpHandler()}},DecoratePanel.prototype.onPutHandler=function(){this.mWorld.emitter.emit(c.a.PUT_ELEMENT,this.mDisplayObject)},DecoratePanel.prototype.onRepeatHandler=function(t){var i=null;switch(t){case u.a.north_west:i=this.getNorthWestPoints(2);break;case u.a.west_south:i=this.getWestSouthPoints(2);break;case u.a.south_east:i=this.getSouthEastPoints(2);break;case u.a.east_north:i=this.getEastNorthPoints(2)}this.onSendAddSingleSprite(i)},DecoratePanel.prototype.onHoldRepeatHandler=function(t){var i=null;switch(t){case u.a.north_west:i=this.getNorthWestPoints();break;case u.a.west_south:i=this.getWestSouthPoints();break;case u.a.south_east:i=this.getSouthEastPoints();break;case u.a.east_north:i=this.getEastNorthPoints()}this.onSendAddSprites(i)},DecoratePanel.prototype.onShowMoveMenuHandler=function(){this.add(this.mMoveMenuContainer),this.remove(this.mRepeatMenuContainer)},DecoratePanel.prototype.onShowRepeatHandler=function(){this.add(this.mRepeatMenuContainer),this.remove(this.mMoveMenuContainer)},DecoratePanel.prototype.onShowExtendsHandler=function(){},DecoratePanel.prototype.onSendAddSprites=function(t){t.length>1&&this.emit("addSprite",this.mSprite,t)},DecoratePanel.prototype.onSendAddSingleSprite=function(t){t.length>1&&this.emit("addSingleSprite",this.mSprite,t)},DecoratePanel}(a.BasePanel),y=function(t){function MoveMenu(i,o,r,a){void 0===r&&(r=1),void 0===a&&(a=1);var h=t.call(this,i)||this,l=i.make.image({key:o,frame:"bg.png"},!1);h.setSize(l.displayWidth,l.displayHeight),h.mArrow1=new p.Button(h.scene,o,"arrow_1.png"),h.mArrow1.setData("dir",u.a.north_west),h.mArrow3=new p.Button(h.scene,o,"arrow_3.png"),h.mArrow3.setData("dir",u.a.west_south),h.mArrow5=new p.Button(h.scene,o,"arrow_5.png"),h.mArrow5.setData("dir",u.a.south_east),h.mArrow7=new p.Button(h.scene,o,"arrow_7.png"),h.mArrow7.setData("dir",u.a.east_north),h.mBtns=[h.mArrow1,h.mArrow3,h.mArrow5,h.mArrow7],h.add(l),h.add(h.mBtns);h.width;var c=h.width-20*r;h.mBtns.map((function(t){return c-=t.displayWidth}));for(var d=c/=h.mBtns.length-1,m=3*r,y=0;y<h.mBtns.length;y++)h.mBtns[y].x=0===y?10*r+h.mBtns[y].width/2-h.width/2:d+h.mBtns[y-1].x+h.mBtns[y-1].width,h.mBtns[y].y=m;return h.setInteractive(),h}return d(MoveMenu,t),MoveMenu.prototype.register=function(){this.mArrow1.on("Hold",this.onHoldHandler,this),this.mArrow1.on("Tap",this.onClickHandler,this),this.mArrow3.on("Hold",this.onHoldHandler,this),this.mArrow3.on("Tap",this.onClickHandler,this),this.mArrow5.on("Hold",this.onHoldHandler,this),this.mArrow5.on("Tap",this.onClickHandler,this),this.mArrow7.on("Hold",this.onHoldHandler,this),this.mArrow7.on("Tap",this.onClickHandler,this)},MoveMenu.prototype.unRegister=function(){this.mArrow1.off("Hold",this.onHoldHandler,this),this.mArrow1.off("Tap",this.onClickHandler,this),this.mArrow3.off("Hold",this.onHoldHandler,this),this.mArrow3.off("Tap",this.onClickHandler,this),this.mArrow5.off("Hold",this.onHoldHandler,this),this.mArrow5.off("Tap",this.onClickHandler,this),this.mArrow7.off("Hold",this.onHoldHandler,this),this.mArrow7.off("Tap",this.onClickHandler,this)},MoveMenu.prototype.onHoldHandler=function(t){this.emit("hold",t.getData("dir"))},MoveMenu.prototype.onClickHandler=function(t,i){this.emit("tap",i.getData("dir"))},MoveMenu}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"UiManager",(function(){return z}));var r,a=o(110),h=o(2),l=o(144),c=o(188),u=o(189),p=o(132),d=o(159),m=o(147),y=o(161),g=o(200),_=o(162),v=o(203),b=o(205),P=o(119),w=o(207),S=o(208),C=o(210),T=o(148),k=o(215),O=o(125),I=o(218),M=o(221),E=o(224),x=o(227),B=o(231),R=o(237),D=o(241),L=o(166),A=o(246),j=o(250),H=o(135),N=o(114),U=o(109),G=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),z=function(t){function UiManager(i){var o=t.call(this)||this;return o.worldService=i,o.mCache=[],o.mNoneUIMap=new Map,o.mSceneUIMap=new Map,o.mNormalUIMap=new Map,o.mPopUIMap=new Map,o.mTipUIMap=new Map,o.mMonopolyUIMap=new Map,o.mActivityUIMap=new Map,o.mShowuiList=[],o.mStackList=[],o.isShowMainUI=!1,o.mConnect=i.connection,o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI,o.handleShowUI),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_UPDATE_UI,o.handleUpdateUI),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CLOSE_UI,o.handleCloseUI),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_MARKET,o.onEnableMarket),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_REFRESH_ACTIVE_UI,o.onUIStateHandler),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_FORCE_OFFLINE,o.onForceOfflineHandler),o.mUILayerManager=new c.LayerManager,o.mInputTextFactory=new w.InputTextFactory(i),o}return G(UiManager,t),UiManager.prototype.getInputTextFactory=function(){return this.mInputTextFactory},UiManager.prototype.addPackListener=function(){this.mConnect&&(this.mConnect.addPacketListener(this),this.worldService.emitter.on(P.a.SHOW_UI,this.handleShowUI,this))},UiManager.prototype.removePackListener=function(){this.mConnect&&(this.mConnect.removePacketListener(this),this.worldService.emitter.off(P.a.SHOW_UI,this.handleShowUI,this))},UiManager.prototype.getUILayerManager=function(){return this.mUILayerManager},UiManager.prototype.getActiveUIData=function(t){if(!this.mAtiveUIData)return null;for(var i=[],o=0,r=this.mAtiveUIData.ui;o<r.length;o++){var a=r[o],h=a.name.split(".")[0];this.getPanelNameByStateTag(h)===t&&i.push(a)}return i},UiManager.prototype.setScene=function(t){this.mScene=t,this.mUILayerManager.setScene(t),t&&this.mCacheUI&&(this.mCacheUI(),this.mCacheUI=void 0)},UiManager.prototype.showMainUI=function(){var t=this;if(this.mScene){var i=this.mScene;if(this.clearMediator(),this.mMedMap||(this.mMedMap=new Map,this.worldService.game.device.os.desktop?this.mMedMap.set(v.BagGroupMediator.NAME,new v.BagGroupMediator(this.worldService,i)):(this.mMedMap.set(C.ActivityMediator.name,new C.ActivityMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(R.PicaMainUIMediator.name,new R.PicaMainUIMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(T.PicaChatMediator.name,new T.PicaChatMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(L.PicHandheldMediator.name,new L.PicHandheldMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(k.MineCarMediator.name,new k.MineCarMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(E.MineSettleMediator.name,new E.MineSettleMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(M.ComposeMediator.name,new M.ComposeMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(x.EquipUpgradeMediator.name,new x.EquipUpgradeMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(B.MarketMediator.name,new B.MarketMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(D.PicFurniFunMediator.name,new D.PicFurniFunMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(A.InteractiveBubbleMediator.name,new A.InteractiveBubbleMediator(this.mUILayerManager,i,this.worldService))),this.mMedMap.set(O.UIMediatorType.BagMediator,new p.BagMediator(this.mUILayerManager,this.worldService,i)),this.worldService.game.device.os.desktop&&this.mMedMap.set(O.UIMediatorType.ChatMediator,new l.ChatMediator(this.worldService,i)),this.mMedMap.set(O.UIMediatorType.NOTICE,new u.NoticeMediator(this.mUILayerManager,i,this.worldService)),this.mMedMap.set(d.FriendMediator.NAME,new d.FriendMediator(i,this.worldService)),this.mMedMap.set(I.ReAwardTipsMediator.name,new I.ReAwardTipsMediator(i,this.worldService)),this.mMedMap.set(j.CharacterInfoMediator.name,new j.CharacterInfoMediator(this.mUILayerManager,i,this.worldService))),this.mMedMap.forEach((function(i,o){var r,a=!!t.worldService.game.device.os.desktop;switch(o){case g.LeftMediator.NAME:case y.RightMediator.NAME:case _.BottomMediator.NAME:r=t.mSceneUIMap;break;case v.BagGroupMediator.NAME:case O.UIMediatorType.ChatMediator:case m.RankMediator.NAME:a&&(r=t.mSceneUIMap)}r&&r.set(o,i),i.isSceneUI()&&i.show()})),this.mAtiveUIData&&this.updateUIState(this.mAtiveUIData),this.mCache){for(var o=0,r=this.mCache;o<r.length;o++){var a=r[o][0];this.showMed(a.name,a)}this.mCache.length=0}}else this.mCacheUI=this.showMainUI},UiManager.prototype.showDecorateUI=function(){this.mScene?(this.clearMediator(),this.mMedMap||(this.mMedMap=new Map),this.mMedMap.set(S.DecorateControlMediator.NAME,new S.DecorateControlMediator(this.mUILayerManager,this.mScene,this.worldService)),this.mMedMap.set(O.UIMediatorType.NOTICE,new u.NoticeMediator(this.mUILayerManager,this.mScene,this.worldService)),this.showAll()):this.mCacheUI=this.showDecorateUI},UiManager.prototype.resize=function(t,i){this.mMedMap&&this.mMedMap.forEach((function(t){t.isShow&&t.resize()}))},UiManager.prototype.setMediator=function(t,i){this.mMedMap.set(t,i)},UiManager.prototype.getMediator=function(t){if(this.mMedMap)return this.mMedMap.get(t)},UiManager.prototype.clearMediator=function(){this.mMedMap&&(this.mMedMap.forEach((function(t){return t.destroy()})),this.mMedMap.clear(),this.mMedMap=null)},UiManager.prototype.destroy=function(){this.removePackListener(),this.clearMediator(),this.mMedMap=void 0,this.clearCache(),this.mScene=void 0},UiManager.prototype.baseFaceResize=function(){var t=this.getMediator(_.BottomMediator.NAME),i=this.getMediator(y.RightMediator.NAME),o=this.getMediator(g.LeftMediator.NAME);i&&i.getView()&&i.getView().resize(0,0),o&&o.getView()&&o.getView().resize(0,0),t&&t.getView()&&t.getView().resize(0,0)},UiManager.prototype.baseFaceTween=function(t){var i=this.getMediator(y.RightMediator.NAME),o=this.getMediator(g.LeftMediator.NAME),r=this.getMediator(_.BottomMediator.NAME);i&&i.getView()&&i.getView().tweenExpand(t),o&&o.getView()&&o.getView().tweenExpand(t),r&&r.getView()&&r.getView().tweenExpand(t)},UiManager.prototype.checkUIState=function(t,i){var o=this.mMedMap.get(t);if(o){var r,a=o.UIType,h=this.worldService.game.device.os.desktop;switch(a){case U.UIType.None:r=this.mNoneUIMap;break;case U.UIType.Scene:r=this.mSceneUIMap;break;case U.UIType.Normal:r=this.mNormalUIMap,h?this.checkNormalUITween(i,t):this.checkBaseUImap(i);break;case U.UIType.Monopoly:r=this.mMonopolyUIMap,this.checkBaseUImap(i),this.checkNormalUImap(i),this.chekcTipUImap(i);break;case U.UIType.Tips:r=this.mTipUIMap;break;case U.UIType.Pop:r=this.mPopUIMap;break;case U.UIType.Activity:r=this.mActivityUIMap}r&&r.set(t,o)}},UiManager.prototype.showMed=function(t){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(this.mScene){this.mMedMap||(this.mMedMap=new Map);var a=(t=this.getPanelNameByAlias(t))+"Mediator",h=this.mMedMap.get(a);if(!h){var l=o(414)("./"+t+"/"+a);if(!(h=new l[a](this.mUILayerManager,this.mScene,this.worldService)))return;this.mMedMap.set(t+"Mediator",h)}i&&h.setParam(i),this.checkUIState(a,!1),h.show(i)}else this.mCache.push(i)},UiManager.prototype.hideMed=function(t){if(this.mMedMap){var i=(t=this.getPanelNameByAlias(t))+"Mediator",o=this.mMedMap.get(i);o&&(this.checkUIState(i,!0),o.hide())}},UiManager.prototype.showExistMed=function(t,i){if(void 0===i&&(i="Mediator"),this.mMedMap){var o=(t=this.getPanelNameByAlias(t))+i,r=this.mMedMap.get(o);r&&r.show()}},UiManager.prototype.handleShowUI=function(t){var i=t.content;this.showMed(i.name,i)},UiManager.prototype.handleUpdateUI=function(t){var i=t.content;this.updateMed(i.name,i)},UiManager.prototype.handleCloseUI=function(t){var i=t.content;this.hideMed(i.name)},UiManager.prototype.onEnableEditMode=function(t){var i=this.mMedMap.get(b.TopMenuMediator.NAME);i||(i=new b.TopMenuMediator(this.mScene,this.worldService),this.mMedMap.set(b.TopMenuMediator.NAME,i)),i.addItem({key:"Turn_Btn_Top",name:"EnterDecorate",bgResKey:"baseView",bgTextures:["btnGroup_yellow_normal.png","btnGroup_yellow_light.png","btnGroup_yellow_select.png"],iconResKey:"",iconTexture:"btnGroup_top_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"})},UiManager.prototype.onEnableMarket=function(){if(this.mMedMap){var t=this.mMedMap.get(b.TopMenuMediator.NAME);t||(t=new b.TopMenuMediator(this.mScene,this.worldService),this.mMedMap.set(b.TopMenuMediator.NAME,t)),t.addItem({key:"Turn_Btn_Top",name:"Market",bgResKey:"baseView",bgTextures:["btnGroup_yellow_normal.png","btnGroup_yellow_light.png","btnGroup_yellow_select.png"],iconResKey:"",iconTexture:"btnGroup_top_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"})}},UiManager.prototype.checkBaseUImap=function(t){this.mSceneUIMap.forEach((function(i){i&&i.tweenExpand(t)}))},UiManager.prototype.checkNormalUITween=function(t,i){var o,r,a=this.worldService.getSize(),h=this.mShowuiList.length;if(t){var l=void 0;for(u=0;u<h;u++)o=this.mShowuiList[u],r=this.mMedMap.get(o),o!==i?r.resize(0,0):l=u;this.mShowuiList.splice(l,1)}else{-1===this.mShowuiList.indexOf(i)&&this.mShowuiList.push(i);for(var c=(h=this.mShowuiList.length)>1?a.width/3:0,u=0;u<h;u++)o=this.mShowuiList[u],r=this.mMedMap.get(o),h>2&&0===u?r.hide():r.resize((2*u-1)*c,0);h>2&&this.mShowuiList.shift()}},UiManager.prototype.checkNormalUImap=function(t){this.mNormalUIMap.forEach((function(i){i&&(t||i.hide())})),t||this.mNormalUIMap.clear()},UiManager.prototype.chekcTipUImap=function(t){this.mTipUIMap.forEach((function(i){i&&(t||i.hide())})),t||this.mNormalUIMap.clear()},UiManager.prototype.updateMed=function(t){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(this.mMedMap){var r=t+"Mediator",a=this.mMedMap.get(r);a&&(i&&a.setParam(i),a.update(i))}},UiManager.prototype.showAll=function(){this.mMedMap&&this.mMedMap.forEach((function(t){t.isSceneUI()&&t.show()}))},UiManager.prototype.clearCache=function(){this.mCacheUI=void 0,this.mCache=[]},UiManager.prototype.closeAll=function(){this.mMedMap&&this.mMedMap.forEach((function(t){return t.hide()}))},UiManager.prototype.onUIStateHandler=function(t){this.mAtiveUIData=t.content,this.mAtiveUIData&&this.mMedMap&&this.updateUIState(this.mAtiveUIData)},UiManager.prototype.updateUIState=function(t){for(var i=0,o=t.ui;i<o.length;i++){var r=o[i],a=r.name.split("."),h=this.getPanelNameByStateTag(a[0]);if(h){var l=this.mMedMap.get(h+"Mediator");if(l)if(1===a.length)r.visible||void 0===r.visible?this.showMed(h):this.hideMed(h);else{var c=l.getView();c&&c.updateUIState(r)}}}},UiManager.prototype.onForceOfflineHandler=function(t){new H.AlertView(this.mScene,this.worldService).show({text:N.a.t("common.offline"),callback:function(){},btns:H.Buttons.Ok})},UiManager.prototype.getPanelNameByStateTag=function(t){switch(t){case"mainui":return"PicaMainUI";case"activity":return"Activity";case"picachat":return"PicaChat";case"picanavigate":return"PicaNavigate";case"PicHandheld":return"PicHandheld"}return t},UiManager.prototype.getPanelNameByAlias=function(t){switch(t){case"MessageBox":return"PicaMessageBox"}return t},UiManager}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"ChatPanelPC",(function(){return m}));var r,a=o(121),h=o(111),l=o(156),c=o(117),u=o(157),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function ChatPanelPC(i,o){var r=t.call(this,i,o)||this;return r.mPreHei=0,r.mPreWid=0,r}return d(ChatPanelPC,t),ChatPanelPC.prototype.appendChat=function(t){this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},ChatPanelPC.prototype.tweenExpand=function(t){if(this.scene){var i=!0===t?0:-200,o=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Cubic.Out",props:{x:{value:i},alpha:{value:o}}})}},ChatPanelPC.prototype.setPosition=function(i,o){if(this.mInitialized){var r=this.mWorld.getSize();if(t.prototype.setPosition.call(this,0,r.height-this.mPreHei),this.mTextArea)this.mTextArea.childrenMap.text.y=r.height-this.height+25*this.dpr,this.mTextArea.scrollToBottom();return this}},ChatPanelPC.prototype.addListen=function(){this.mInitialized&&(this.sendMsgBtn&&this.sendMsgBtn.on("pointerdown",this.onSendMsgHandler,this),this.mVoiceBtn&&this.mVoiceBtn.on("selected",this.onSelectedVoiceHandler,this),this.mMicBtn&&this.mMicBtn.on("selected",this.onSelectedMicHandler,this),this.mInputText&&(this.mInputText.on("focus",this.onFocusHandler,this),this.mInputText.on("blur",this.onBlurHandler,this)))},ChatPanelPC.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mInitialized&&(this.sendMsgBtn&&this.sendMsgBtn.off("pointerdown",this.onSendMsgHandler,this),this.mVoiceBtn&&this.mVoiceBtn.off("selected",this.onSelectedVoiceHandler,this),this.mMicBtn&&this.mMicBtn.off("selected",this.onSelectedMicHandler,this),this.mInputText&&(this.mInputText.off("focus",this.onFocusHandler,this),this.mInputText.off("blur",this.onBlurHandler,this)))},ChatPanelPC.prototype.destroy=function(){t.prototype.destroy.call(this)},ChatPanelPC.prototype.preload=function(){this.scene&&(this.scene.load.image("button",h.i.getRes("ui/common/button.png")),this.scene.load.image("thumbTexture",h.i.getRes("ui/common/common_thumb_texture.png")),this.scene.load.image("track",h.i.getRes("ui/common/common_track.png")),this.scene.load.image("chat_input_bg",h.i.getRes("ui/chat/input_bg.png")),this.scene.load.image(h.d.getName(),h.d.getPNG()),this.scene.load.atlas("chat_atlas",h.i.getRes("ui/chat/chat_atlas.png"),h.i.getRes("ui/chat/chat_atlas.json")),t.prototype.preload.call(this))},ChatPanelPC.prototype.init=function(){if(!this.mInitialized){var i=this.mWorld.getSize();this.mPreHei=i.height,this.mPreWid=i.width,this.setSize(464,281);var o=new c.NinePatch(this.scene,0,0,this.width,this.height,h.d.getName(),null,h.d.getConfig());o.x=4*this.mWorld.uiScale+o.width*o.originX,o.y=i.height-260*this.mWorld.uiScale+o.height*o.originY,this.add(o),this.outPut=this.scene.make.container(void 0,!1),this.add(this.outPut);var r=new p.RoundRectangle(this.scene,0,0,2,2,3,8421504,.5);this.outPut.add(r);var u=new a.NinePatchButton(this.scene,0,0,4,7,"track","","",{left:0,top:2,right:0,bottom:2});u.x=100*this.mWorld.uiScale,u.y=10*this.mWorld.uiScale,this.outPut.add(u);var d=new p.BBCodeText(this.scene,0,0,"",{fontSize:"14px",wrap:{mode:"char",width:400*this.mWorld.uiScale}});this.outPut.add(d);var m=new a.NinePatchButton(this.scene,0,0,20,35,"button","","",{left:4,top:4,right:4,bottom:4});this.outPut.add(m),this.mTextArea=new p.TextArea(this.scene,{x:230*this.mWorld.uiScale,y:i.height-155*this.mWorld.uiScale,textWidth:430,textHeight:200,text:d,slider:{track:u,thumb:m}}).layout(),this.outPut.add(this.mTextArea);this.mTextArea.getElement("child");var y=this.scene.make.container(void 0,!1);this.add(y);var g=new c.NinePatch(this.scene,0,0,370,32,"chat_input_bg",null,{left:4,top:4,right:4,bottom:4});g.x=8*this.mWorld.uiScale+g.width*g.originX,g.y=i.height-46*this.mWorld.uiScale+g.height*g.originY,y.add(g),this.mInputText=new p.InputText(this.scene,0,0,10,10,{type:"input",fontSize:"14px",color:"#808080"}).resize(360,20).setOrigin(0,0).setStyle({font:"bold 16px YaHei"}),this.mInputText.x=12*this.mWorld.uiScale,this.mInputText.y=i.height-40*this.mWorld.uiScale,y.add(this.mInputText),this.sendMsgBtn=new a.NinePatchButton(this.scene,0,0,60,30,"button","","发送",{left:4,top:4,right:4,bottom:4}),this.sendMsgBtn.x=this.width-this.sendMsgBtn.width+10*this.mWorld.uiScale,this.sendMsgBtn.y=i.height-this.sendMsgBtn.height,this.add(this.sendMsgBtn),this.mSendKey=this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER),this.mVoiceBtn=new l.CheckButton(this.scene,0,0,"chat_atlas","voice_normal.png","voice_selected.png"),this.mVoiceBtn.x=this.width-60*this.mWorld.uiScale,this.mVoiceBtn.y=i.height-this.height,this.add(this.mVoiceBtn),this.mMicBtn=new l.CheckButton(this.scene,0,0,"chat_atlas","mic_normal.png","mic_selected.png"),this.mMicBtn.x=this.width-20*this.mWorld.uiScale,this.mMicBtn.y=i.height-this.height,this.add(this.mMicBtn),this.setPosition(),t.prototype.init.call(this)}},ChatPanelPC.prototype.onSelectedVoiceHandler=function(t){!1===t&&(this.mMicBtn.selected=!1),this.emit("selectedVoice",t)},ChatPanelPC.prototype.onSelectedMicHandler=function(t){!1!==this.mVoiceBtn.selected?(this.mMicBtn.selected=t,this.emit("selectedMic",t)):this.mMicBtn.selected=!1},ChatPanelPC.prototype.onSendMsgHandler=function(){var t=this.mInputText.text;t.length>0&&(this.emit("sendChat",t),this.mInputText.setText(""),this.mInputText.setBlur())},ChatPanelPC.prototype.onFocusHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mSendKey&&this.mSendKey.on("down",this.onDownEnter,this)},ChatPanelPC.prototype.onBlurHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mSendKey&&this.mSendKey.off("down",this.onDownEnter,this)},ChatPanelPC.prototype.onDownEnter=function(){this.onSendMsgHandler()},Object.defineProperty(ChatPanelPC.prototype,"outChannel",{get:function(){return 0},enumerable:!1,configurable:!0}),ChatPanelPC}(u.BaseChatPanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"normalizePatchesConfig",(function(){return normalizePatchesConfig}));var normalizePatchesConfig=function(t){return t.bottom=void 0!==t.bottom?t.bottom:t.top,t.left=void 0!==t.left?t.left:t.top,t.right=void 0!==t.right?t.right:t.left,t}},function(t,i,o){"use strict";o.r(i),o.d(i,"ChatPanelMobile",(function(){return d}));var r,a=o(157),h=o(111),l=o(117),c=o(121),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function ChatPanelMobile(i,o){var r=t.call(this,i,o)||this;return r.setTween(!1),r}return p(ChatPanelMobile,t),ChatPanelMobile.prototype.addListen=function(){this.mSendBtn.on("pointerdown",this.onSendMsgHandler,this),this.clickContainer.on("pointerdown",this.clickHandler,this),this.mInputText.on("focus",this.onFocusHandler,this),this.mInputText.on("blur",this.onBlurHandler,this)},ChatPanelMobile.prototype.removeListen=function(){this.mSendBtn.off("pointerdown",this.onSendMsgHandler,this),this.clickContainer.off("pointerdown",this.clickHandler,this),this.mInputText.off("focus",this.onFocusHandler,this),this.mInputText.off("blur",this.onBlurHandler,this)},ChatPanelMobile.prototype.appendChat=function(t){this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom())},ChatPanelMobile.prototype.show=function(i){t.prototype.show.call(this,i),this.tweenExpand(!0)},ChatPanelMobile.prototype.setPosition=function(t,i){if(this.mShow){var o,r,a,h=this.mWorld.getSize();if(this.mTextArea&&(this.mTextArea.destroy(),this.mTextArea=null,a=new u.BBCodeText(this.scene,0,0,"",{fontSize:"20px",wrap:{mode:"char",width:this.width>>1}}),o=new c.NinePatchButton(this.scene,0,0,4,7,"track","","",{left:0,top:2,right:0,bottom:2}),r=new c.NinePatchButton(this.scene,0,0,20,35,"button","","",{left:4,top:4,right:4,bottom:4}),this.add(a),this.add(o),this.add(r)),this.mInputText&&(this.mInputText.destroy(),this.mInputText=null,this.mInputText=new u.InputText(this.scene,0,0,10,10,{type:"input",fontSize:"20px",color:"#808080"}).resize(328,26).setOrigin(0,0).setStyle({font:"bold 20px YaHei"})),this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE)this.width=h.width>>1,this.height=h.height,this.mBorder.resize(this.width/this.mWorld.uiScale,this.height/this.mWorld.uiScale),this.x=0,this.y=0,this.clickContainer.x=this.width/this.mWorld.uiScale+this.clickContainer.width/2,this.clickContainer.y=this.height/(2*this.mWorld.uiScale),this.clickContainer.rotation=.5*Math.PI,this.arrow.rotation=.5*Math.PI,this.mInputBg.y=this.mBorder.height-this.mInputBg.height/2,this.mTextArea=new u.TextArea(this.scene,{x:.5*this.width/this.mWorld.uiScale,y:this.height/2,textWidth:this.mBorder.width-20*this.mWorld.uiScale,textHeight:this.height,text:a,slider:{track:o,thumb:r},clamplChildOY:!0}),this.mInputText.setPosition(2,this.mInputBg.y-12*this.mWorld.uiScale);else this.width=h.width,this.height=h.height/2,this.mBorder.resize(this.width/this.mWorld.uiScale,this.height/this.mWorld.uiScale),this.x=0,this.y=this.height+20*this.mWorld.uiScale,this.mInputBg.y=this.mBorder.height-this.mInputBg.height,this.mTextArea=new u.TextArea(this.scene,{x:(this.width-15)/this.mWorld.uiScale>>1,y:(h.height/2-this.mSendBtn.height-20)/this.mWorld.uiScale>>1,textWidth:this.mBorder.width-20*this.mWorld.uiScale,textHeight:(h.height/2-this.mSendBtn.height-20)/this.mWorld.uiScale,text:a,slider:{track:o,thumb:r},scroller:{bounds:[0,this.height>>1]},clamplChildOY:!0,backDeceleration:!0}),this.clickContainer.x=h.width/(2*this.mWorld.uiScale),this.clickContainer.y=-this.clickContainer.height>>1,this.mTextArea.getElement("slider").y=this.height>>1,this.clickContainer.rotation=Math.PI,this.arrow.rotation=1.5*Math.PI,this.mInputText.setPosition(2,this.mInputBg.y-6*this.mWorld.uiScale);return this.mTextArea.layout(),this.add(this.mTextArea),this.mTextArea.childrenMap.child.textMask.setPosition(-5,h.height-this.height).resize(this.width+18,this.height-this.mSendBtn.height),this.mBorder.x=this.mBorder.width/2,this.mBorder.y=this.mBorder.height/2,this.setSize(this.width,this.height),this.mInputBg.x=this.mInputBg.width>>1,this.mSendBtn.x=this.mBorder.width-this.mSendBtn.width,this.mSendBtn.y=this.mInputBg.y,this.scale=this.mWorld.uiScale,this.add(this.mInputText),this}},ChatPanelMobile.prototype.destroy=function(){t.prototype.destroy.call(this)},ChatPanelMobile.prototype.tweenExpand=function(t){var i=this,o=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:{alpha:{value:o}},onComplete:function(o,r,a){t||i.hide(),i.addListen()}}),t&&this.setPosition()},ChatPanelMobile.prototype.hide=function(){this.removeListen(),t.prototype.hide.call(this)},ChatPanelMobile.prototype.preload=function(){this.scene&&(this.scene.load.image("button",h.i.getRes("ui/common/button.png")),this.scene.load.image("thumbTexture",h.i.getRes("ui/common/common_thumb_texture.png")),this.scene.load.image("track",h.i.getRes("ui/common/common_track.png")),this.scene.load.image("channelSelect",h.i.getRes("ui/common/common_channelSelect.png")),this.scene.load.image("channelUnSelect",h.i.getRes("ui/common/common_channelUnSelect.png")),this.scene.load.image("arrow",h.i.getRes("ui/common/common_arrow.png")),this.scene.load.image("chat_input_bg",h.i.getRes("ui/chat/input_bg.png")),this.scene.load.image(h.d.getName(),h.d.getPNG()),this.scene.load.atlas(h.j.getName(),h.j.getPNG(),h.j.getJSON()),this.scene.load.atlas("chat_atlas",h.i.getRes("ui/chat/chat_atlas.png"),h.i.getRes("ui/chat/chat_atlas.json")),t.prototype.preload.call(this))},ChatPanelMobile.prototype.init=function(){if(!this.mInitialized){var i=this.mWorld.getSize();this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.width=i.width>>1,this.height=i.height):(this.width=i.width,this.height=i.height>>1),this.setSize(this.width,this.height),this.mBorder=new l.NinePatch(this.scene,0,0,this.width/this.mWorld.uiScale,this.height/this.mWorld.uiScale,h.d.getName(),null,h.d.getConfig()),this.mBorder.x=this.mBorder.width/2,this.mBorder.y=this.mBorder.height/2,this.addAt(this.mBorder,0);var o=new u.BBCodeText(this.scene,0,0,"",{fontSize:"20px",wrap:{mode:"char",width:this.width>>1}}),r=new c.NinePatchButton(this.scene,0,0,4,7,"track","","",{left:0,top:2,right:0,bottom:2});r.x=this.width/2,r.y=8*this.mWorld.uiScale;var a=new c.NinePatchButton(this.scene,0,0,20,35,"button","","",{left:4,top:4,right:4,bottom:4});this.add(o),this.add(r),this.add(a),this.mTextArea=new u.TextArea(this.scene,{x:this.width>>1,y:this.height+178*this.mWorld.uiScale>>1,textWidth:this.width,textHeight:this.height+150*this.mWorld.uiScale,text:o,slider:{track:r,thumb:a}}).layout(),this.add(this.mTextArea),this.mInputBg=new l.NinePatch(this.scene,0,0,340,30,"chat_input_bg",null,{left:4,top:4,right:4,bottom:4}),this.add(this.mInputBg),this.mInputText=new u.InputText(this.scene,0,0,10,10,{type:"input",fontSize:"20px",color:"#808080"}).resize(328,26).setOrigin(0,0).setStyle({font:"bold 20px YaHei"}).on("focus",this.onFocusHandler,this).on("blur",this.onBlurHandler,this),this.mSendBtn=new c.NinePatchButton(this.scene,0,0,60,30,h.j.getName(),"","发送",h.j.getConfig()),this.add(this.mSendBtn),this.clickContainer=this.scene.make.container(void 0,!1);var p=new l.NinePatch(this.scene,0,0,53/this.mWorld.uiScale,30/this.mWorld.uiScale,h.d.getName(),null,h.d.getConfig());this.arrow=this.scene.make.image(void 0,!1),this.arrow.setTexture("arrow"),this.clickContainer.setSize(p.width+4,p.height+10),this.clickContainer.add(p),this.clickContainer.add(this.arrow),this.clickContainer.setInteractive(),this.add(this.clickContainer),this.add(this.mInputText),this.setPosition(),t.prototype.init.call(this)}},ChatPanelMobile.prototype.clickHandler=function(){this.scene.tweens.add({targets:this.clickContainer,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.clickContainer.scaleX=this.clickContainer.scaleY=1,this.tweenExpand(!1),this.mWorld.uiManager.baseFaceTween(!0)},ChatPanelMobile.prototype.onSendMsgHandler=function(){var t=this.mInputText.text;t.length>0&&(this.emit("sendChat",t),this.mInputText.setText(""),this.mInputText.setBlur())},ChatPanelMobile.prototype.onFocusHandler=function(){this.mWorld&&this.mWorld.inputManager},ChatPanelMobile.prototype.onBlurHandler=function(){this.mWorld&&this.mWorld.inputManager},ChatPanelMobile}(a.BaseChatPanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"Chat",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Chat(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Chat,t),Chat.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Chat.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Chat.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT,this.handleCharacterChat),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QCLOUD_GME_AUTHBUFFER,this.handleQCLoudGME))},Chat.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Object.defineProperty(Chat.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Chat.prototype.handleCharacterChat=function(t){t.content;this.mEvent.emit("characterChat",t)},Chat.prototype.handleQCLoudGME=function(t){t.content;this.mEvent.emit("QCLoundGME",t)},Chat}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"LayerManager",(function(){return r}));var r=function(){function LayerManager(){}return LayerManager.prototype.setScene=function(t){t&&(this.destroy(),this.mScene=t,this.mUILayer=t.add.container(0,0),this.mDialogLayer=t.add.container(0,0),this.mToolTipsLyaer=t.add.container(0,0))},LayerManager.prototype.addToUILayer=function(t,i){void 0===i&&(i=-1),this.mUILayer&&(-1===i||void 0===i?this.mUILayer.add(t):this.mUILayer.addAt(t,i))},LayerManager.prototype.addToDialogLayer=function(t){this.mDialogLayer&&this.mDialogLayer.add(t)},LayerManager.prototype.addToToolTipsLayer=function(t){this.mToolTipsLyaer&&this.mToolTipsLyaer.add(t)},LayerManager.prototype.removeToUILayer=function(t){this.mUILayer.remove(t)},LayerManager.prototype.removeToDialogLayer=function(t){this.mDialogLayer.remove(t)},LayerManager.prototype.removeToToolTipsLayer=function(t){this.mToolTipsLyaer.remove(t)},LayerManager.prototype.destroy=function(){this.mUILayer&&(this.mUILayer.destroy(),this.mUILayer=null),this.mDialogLayer&&(this.mDialogLayer.destroy(),this.mDialogLayer=null),this.mToolTipsLyaer&&(this.mToolTipsLyaer.destroy(),this.mToolTipsLyaer=null)},Object.defineProperty(LayerManager.prototype,"interactive",{get:function(){return this.mInteractive},enumerable:!1,configurable:!0}),Object.defineProperty(LayerManager.prototype,"scene",{get:function(){return this.mScene},enumerable:!1,configurable:!0}),LayerManager}()},function(t,i,o){"use strict";o.r(i),o.d(i,"NoticeMediator",(function(){return p}));var r,a=o(190),h=o(119),l=o(191),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function NoticeMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mLayerManager=i,a.mScene=o,a.notice=new l.Notice(r),a.mUIType=c.UIType.Tips,a.addListen(),a}return u(NoticeMediator,t),NoticeMediator.prototype.setUiScale=function(t){this.mView.scale=t},NoticeMediator.prototype.getView=function(){return void 0!==this.mView?this.mView:void 0},NoticeMediator.prototype.getUIType=function(){return this.mUIType},NoticeMediator.prototype.hide=function(){this.mView&&t.prototype.hide.call(this)},NoticeMediator.prototype.destroy=function(){this.removeListen(),this.notice.unregister(),this.notice=null,t.prototype.destroy.call(this)},NoticeMediator.prototype.isShow=function(){return this.mView.isShow()},NoticeMediator.prototype.resize=function(){this.mView&&this.mView.resize()},NoticeMediator.prototype.show=function(t){this.mView&&this.mView.isShow()?this.mView.showNotice(t):(this.mView=new a.NoticePanel(this.mScene,this.world),this.mView.show(t),this.mView.showNotice(t),this.mLayerManager.addToDialogLayer(this.mView))},NoticeMediator.prototype.update=function(t){this.mParam=t,this.mView},NoticeMediator.prototype.setParam=function(t){this.mParam=t},NoticeMediator.prototype.getParam=function(){return this.mParam},NoticeMediator.prototype.addListen=function(){this.notice.on("showNotice",this.noticeHandler,this),this.world.emitter.on(h.a.SHOW_NOTICE,this.noticeHandler,this),this.notice.register()},NoticeMediator.prototype.removeListen=function(){this.notice.off("showNotice",this.noticeHandler,this),this.world.emitter.off(h.a.SHOW_NOTICE,this.noticeHandler,this)},NoticeMediator.prototype.noticeHandler=function(t){t&&t.content&&this.show(t.content)},NoticeMediator.NAME="NoticeMediator",NoticeMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"NoticePanel",(function(){return u}));var r,a=o(112),h=o(111),l=o(117),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function NoticePanel(i,o){var r=t.call(this,i,o)||this;return r.disInteractive(),r}return c(NoticePanel,t),NoticePanel.prototype.show=function(i){t.prototype.show.call(this,i),this.resize(),this.refreshData()},NoticePanel.prototype.addListen=function(){this.mInitialized},NoticePanel.prototype.removeListen=function(){this.mInitialized},NoticePanel.prototype.destroy=function(){this.mContentText&&(this.mContentText.destroy(),this.mContentText=null),this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=null),t.prototype.destroy.call(this)},NoticePanel.prototype.resize=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var o=this.scene.cameras.main.worldView;this.x=o.x+o.width+t>>1,this.y=180+i},NoticePanel.prototype.showNotice=function(t){var i=this;if(this.mInitialized&&t){this.mTween&&(this.mTween.stop(),this.mTween.remove());var o="#FFFFFF",r=5e3,a=t.chatsetting;a&&(a.textColor&&(o=a.textColor),a.duration&&(r=a.duration)),this.mContentText.setText(t.noticeContext),this.mContentText.setFill(o),this.mContentText.x=-(this.mContentText.width>>1),this.mContentText.y=-(this.mContentText.height>>1),this.mTween=this.scene.tweens.add({targets:this,alpha:0,duration:200,delay:r,onComplete:function(){i.removeFromParent()}})}},NoticePanel.prototype.preload=function(){this.scene.load.image(h.d.getName(),h.d.getPNG()),t.prototype.preload.call(this)},NoticePanel.prototype.init=function(){var i=new l.NinePatch(this.scene,0,0,1200,120,h.d.getName(),null,h.d.getConfig());this.add(i),this.mContentText=this.scene.make.text({align:"center",style:{fontFamily:"bold YaHei",fontSize:20*this.dpr*this.mWorld.uiScale,wordWrap:{width:1180,useAdvancedWrap:!0}}},!1).setStroke("#000000",1),this.add(this.mContentText),t.prototype.init.call(this)},NoticePanel.prototype.refreshData=function(){var t=this.mShowData;t&&this.showNotice(t)},NoticePanel.prototype.removeFromParent=function(){this.parentContainer&&this.parentContainer.remove(this),this.mTween&&(this.mTween.stop(),this.mTween.remove(),this.mTween=null),this.mShow=!1},NoticePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"Notice",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Notice(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Notice,t),Notice.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Notice.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Notice.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_NOTICE,this.noticeHandler))},Notice.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Object.defineProperty(Notice.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Notice.prototype.noticeHandler=function(t){t&&t.content&&this.mEvent.emit("showNotice",t)},Notice}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"BagPanel",(function(){return v}));var r,a=o(133),h=o(0),l=o(111),c=o(132),u=o(117),p=o(146),d=o(124),m=o(125),y=o(112),g=o(109),_=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),v=function(t){function BagPanel(i,o){var r=t.call(this,i,o)||this;return r.mPageNum=0,r.mPageIndex=1,r.mBaseStr="输入关键字进行搜索",r.bagSlotList=[],r.mCheckList=[],r}return _(BagPanel,t),BagPanel.prototype.resize=function(t,i){var o=this.mWorld.getSize();this.mWorld.game.device.os.desktop||this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.x=o.width>>1,this.y=o.height>>1):(this.x=o.width>>1,this.y=o.height-this.height/2*this.mWorld.uiScale>>1)},BagPanel.prototype.setDataList=function(){var t=this.mWorld.roomManager.currentRoom.playerManager.actor.package.items;this.mPageNum=Math.ceil(t.length/BagPanel.PageMaxCount),this.mDataList=t,this.mInitialized&&this.checkChinese()},BagPanel.prototype.getPageNum=function(){return this.mPageNum},BagPanel.prototype.destroy=function(){this.bagSlotList&&(this.bagSlotList.forEach((function(t){t&&t.destroy()})),this.bagSlotList.length=0,this.bagSlotList=null),this.mWorld=null,this.mPageNum=0,this.mPageIndex=1,t.prototype.destroy.call(this)},BagPanel.prototype.getCurPageIndex=function(){return this.mPageIndex},BagPanel.prototype.show=function(i){t.prototype.show.call(this,i),this.mInitialized&&(this.mPreBtn.play("slipBtn"),this.mNextBtn.play("slipBtn"))},BagPanel.prototype.setBlur=function(){this.mInputText&&this.mInputText.setBlur()},BagPanel.prototype.addListen=function(){this.mInitialized&&(this.mInputText.on("focus",this.onFocusHandler,this),this.mInputText.on("blur",this.onBlurHandler,this),this.mNextBtn.on("pointerup",this.nextHandler,this),this.mPreBtn.on("pointerup",this.preHandler,this),this.mClsBtn.on("pointerup",this.closeHandler,this))},BagPanel.prototype.removeListen=function(){this.mInitialized&&(this.mInputText.off("focus",this.onFocusHandler,this),this.mInputText.off("blur",this.onBlurHandler,this),this.mNextBtn.off("pointerup",this.nextHandler,this),this.mPreBtn.off("pointerup",this.preHandler,this),this.mClsBtn.off("pointerup",this.closeHandler,this))},BagPanel.prototype.init=function(){if(!this.mInitialized){var i,o=this.mWorld.getSize();this.mWorld.game.device.os.desktop||this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.x=o.width>>1,this.y=o.height>>1):(this.x=o.width>>1,this.y=o.height-this.height/2*this.mWorld.uiScale>>1);var r=0,h=0;this.mBg=new u.NinePatch(this.scene,0,0,500,350,l.a.getName(),null,l.a.getConfig()),this.addAt(this.mBg,0),this.setSize(this.mBg.width,this.mBg.height),this.mBorder=new u.NinePatch(this.scene,0,0,this.mBg.width-10,this.mBg.height-30,l.d.getName(),null,l.d.getConfig()),this.mBorder.x=this.mBg.x,this.mBorder.y=this.mBg.y+10,this.addAt(this.mBorder,1);var p=new u.NinePatch(this.scene,this.mBorder.width/4+5,-this.mBg.height/2+65,this.mBorder.width/2-40,35,l.d.getName(),null,l.d.getConfig());this.add(p),this.mInputText=new g.InputText(this.scene,0,0,10,10,{type:"input",fontSize:"14px",color:"#808080"}).resize(p.width,p.height).setOrigin(0,0).setStyle({font:"bold 16px YaHei"}),this.mInputText.x=p.x-p.width/2,this.mInputText.y=p.y-p.height/2,this.mInputText.setText(this.mBaseStr),this.add(this.mInputText),this.bagSlotList=[];for(var y=0;y<BagPanel.PageMaxCount;y++)r=y%8*60-210,h=60*Math.floor(y/8)-this.mBorder.height/2+this.mBorder.y+this.mBorder.height/2-55,(i=new a.ItemSlot(this.scene,this.mWorld,this,r,h,this.mResStr,this.mResPng,this.mResJson,"bagView_slot.png","itemSelectFrame")).createUI(),this.bagSlotList.push(i);this.mPreBtn=this.scene.make.sprite(void 0,!1),this.mPreBtn.x=-this.mBg.width>>1,this.mNextBtn=this.scene.make.sprite(void 0,!1),this.mNextBtn.scaleX=-1,this.mNextBtn.x=this.mBg.width>>1;var _=this.scene.make.sprite(void 0,!1);_.setTexture(this.mResStr,"bagView_titleBtn.png"),_.x=50+(-this.mBg.width>>1),_.y=-this.mBg.height>>1,this.add(_);var v=this.scene.make.text(void 0,!1);v.setFontFamily("Tahoma"),v.setFontStyle("bold"),v.setFontSize(20),v.setText("背包"),v.x=_.x+_.width-10,v.y=_.y-(v.height>>1),this.add(v),this.add(this.mPreBtn),this.add(this.mNextBtn),this.mNextBtn.setInteractive(),this.mPreBtn.setInteractive(),this.width=this.mBg.width,this.height=this.mBg.height,this.mClsBtn=new d.IconBtn(this.scene,this.mWorld,{key:m.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:this.mResPng,jsonUrl:this.mResJson}),this.mClsBtn.x=(this.width>>1)-65,this.mClsBtn.y=-this.height>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn),this.mInitialized=!0,this.mDataList&&this.refreshDataList(this.mDataList),this.setInteractive(),this.mWorld.uiManager.getMediator(c.BagMediator.NAME).resize(this.width,this.height),t.prototype.init.call(this)}},BagPanel.prototype.preload=function(){this.scene&&(this.mResStr="bagView",this.mResPng="ui/bag/bagView.png",this.mResJson="ui/bag/bagView.json",this.scene.load.atlas("itemChose",l.i.getRes("ui/bag/itemChose.png"),l.i.getRes("ui/bag/itemChose.json")),this.scene.load.atlas("slip",l.i.getRes("ui/bag/slip.png"),l.i.getRes("ui/bag/slip.json")),this.scene.load.image(l.d.getName(),l.d.getPNG()),this.scene.load.image(l.a.getName(),l.a.getPNG()),this.scene.load.atlas("clsBtn",l.i.getRes("ui/common/common_clsBtn.png"),l.i.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas(this.mResStr,l.i.getRes(this.mResPng),l.i.getRes(this.mResJson)),t.prototype.preload.call(this))},BagPanel.prototype.loadComplete=function(i,o,r){var a=this.scene.textures.get("itemChose").frames,h=[];for(var l in a){if("__BASE"!==l)a[l]&&h.push(l)}this.scene.anims.create({key:"itemSelectFrame",frames:this.scene.anims.generateFrameNumbers("itemChose",{start:0,end:8,frames:h}),frameRate:33,yoyo:!0,repeat:-1});var c=this.scene.textures.get("slip").frames,u=[];for(var l in c){if("__BASE"!==l)c[l]&&u.push(l)}this.scene.anims.create({key:"slipBtn",frames:this.scene.anims.generateFrameNumbers("slip",{start:0,end:14,frames:u}),frameRate:33,yoyo:!0,repeat:-1}),t.prototype.loadComplete.call(this,i,o,r)},BagPanel.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.getMediator(c.BagMediator.NAME).resize(this.width,this.height)},BagPanel.prototype.nextHandler=function(t,i){if(this.preNextBtnScaleHandler(this.mNextBtn,-1),!(this.mPageIndex>=this.mPageNum)){this.mPageIndex++;var o=this.mCheckList.length>0?this.mCheckList:this.mDataList;this.refreshDataList(o)}},BagPanel.prototype.preHandler=function(t,i){if(this.preNextBtnScaleHandler(this.mPreBtn),!(this.mPageIndex<=1)){this.mPageIndex--;var o=this.mCheckList.length>0?this.mCheckList:this.mDataList;this.refreshDataList(o)}},BagPanel.prototype.preNextBtnScaleHandler=function(t,i){void 0===i&&(i=1),this.scene.tweens.add({targets:t,duration:50,ease:"Linear",props:{scaleX:{value:.5*i},scaleY:{value:.5}},yoyo:!0,repeat:0}),t.scaleX=i,t.scaleY=1},BagPanel.prototype.refreshDataList=function(t){if(t)for(var i,o=t.slice((this.mPageIndex-1)*BagPanel.PageMaxCount,this.mPageIndex*BagPanel.PageMaxCount),r=BagPanel.PageMaxCount,a=0;a<r;a++)(i=this.bagSlotList[a])&&i.dataChange(o[a]);else h.a.getInstance().error("checkItemList is undefiend")},BagPanel.prototype.closeHandler=function(){this.mWorld.uiManager.getMediator(c.BagMediator.NAME).hide()},BagPanel.prototype.onFocusHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mInputText&&(this.mInputText.on("textchange",this.checkChinese,this),this.mInputText.setText(""))},BagPanel.prototype.onBlurHandler=function(){this.mWorld&&this.mWorld.inputManager&&this.mInputText&&(this.mInputText.on("textchange",this.checkChinese,this),this.mInputText.setText(this.mBaseStr))},BagPanel.prototype.checkChinese=function(){var t=this,i=this.mInputText.text;i.length<1||!p.a.checkChinese(i)||i===this.mBaseStr?this.refreshDataList(this.mDataList):(this.mWorld.roomManager.currentRoom.playerManager.actor.package.items.forEach((function(i){i&&p.a.checkItemName(i.name,t.mInputText.text)&&t.mCheckList.push(i)})),this.refreshDataList(this.mCheckList))},BagPanel.PageMaxCount=32,BagPanel}(y.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"FriendPanel",(function(){return _})),o.d(i,"FriendItem",(function(){return v}));var r,a=o(112),h=o(111),l=o(117),c=o(113),u=o(116),p=o(25),d=o(124),m=o(159),y=o(125),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function FriendPanel(i,o){var r=t.call(this,i,o)||this;return r.mIndex=0,r}return g(FriendPanel,t),FriendPanel.prototype.resize=function(t,i){var o=this.mWorld.getSize();this.mShow&&(this.mWorld.game.device.os.desktop?(this.x=o.width+t>>1,this.y=o.height+i>>1):this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.mBg.resize((.5*o.width-20)/this.mWorld.uiScale,(o.height-20)/this.mWorld.uiScale),this.setSize(this.mBg.width,this.mBg.height),this.x=(this.width/2+10)*this.mWorld.uiScale,this.y=(this.height/2+10)*this.mWorld.uiScale):(this.mBg.resize((o.width-20)/this.mWorld.uiScale,(.5*o.height-20)/this.mWorld.uiScale),this.setSize(this.mBg.width,this.mBg.height),this.x=(this.width/2+15)*this.mWorld.uiScale,this.y=o.height-.5*this.mBg.height*this.mWorld.uiScale-10),this.scale=this.mWorld.uiScale,this.mUpBtn.y=(this.mUpBtn.height/2-this.mBg.height)/2,this.mDownBtn.y=(this.mBg.height-this.mDownBtn.height/2)/2,this.mTitleTxt.x=-this.mBg.width/2+15,this.mTitleTxt.y=-this.mBg.height/2+8,this.mClsBtn&&(this.mClsBtn.x=(this.mBg.width>>1)-65,this.mClsBtn.y=-this.mBg.height>>1),this.initFriendItem(),this.addAt(this.mBg,0),this.add(this.mTitleTxt))},FriendPanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mDownBtn.on("pointerup",this.downHandler,this),this.mUpBtn.on("pointerup",this.upHandler,this),this.mClsBtn.on("pointerup",this.hide,this)},FriendPanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mDownBtn.off("pointerup",this.downHandler,this),this.mUpBtn.off("pointerup",this.upHandler,this),this.mClsBtn.off("pointerup",this.hide,this)},FriendPanel.prototype.show=function(i){this.mWorld.getSize();this.mShowData=i,this.mInitialized?t.prototype.show.call(this,i):this.preload()},FriendPanel.prototype.destroy=function(){this.mFriendList&&this.mFriendList.forEach((function(t){t&&(t.destory(),t=null)})),t.prototype.destroy.call(this)},FriendPanel.prototype.friendChat=function(t){},FriendPanel.prototype.friendGo=function(t){},FriendPanel.prototype.btnScaleHandler=function(t,i){void 0===i&&(i=1),this.mScene.tweens.add({targets:t,duration:50,ease:"Linear",props:{scaleX:{value:.5*i},scaleY:{value:.5}},yoyo:!0,repeat:0}),t.scaleX=i,t.scaleY=1},FriendPanel.prototype.hide=function(){this.mWorld.uiManager.baseFaceTween(!0),t.prototype.hide.call(this)},FriendPanel.prototype.preload=function(){this.mScene&&(this.mScene.load.image(h.d.getName(),h.d.getPNG()),this.mScene.load.image(h.a.getName(),h.a.getPNG()),this.mScene.load.atlas("clsBtn",h.i.getRes("ui/common/common_clsBtn.png"),h.i.getRes("ui/common/common_clsBtn.json")),this.scene.load.image("friendChat",h.i.getRes("ui/friend/friend_chat.png")),this.scene.load.image("friendGo",h.i.getRes("ui/friend/friend_go.png")),this.mScene.load.atlas("bagView",h.i.getRes("ui/bag/bagView.png"),h.i.getRes("ui/bag/bagView.json")),t.prototype.preload.call(this))},FriendPanel.prototype.init=function(){this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);var i=this.mWorld.getSize();this.mBg=new l.NinePatch(this.scene,0,0,600/this.mWorld.uiScale,.5*i.height*this.mWorld.uiScale,h.d.getName(),null,h.d.getConfig()),this.setSize(this.mBg.width,this.mBg.height),this.mTitleTxt=this.mScene.make.text(void 0,!1),this.mTitleTxt.setFontFamily("YaHei"),this.mTitleTxt.setFontStyle("bold"),this.mTitleTxt.setFontSize(14),this.mTitleTxt.style.align="left",this.mTitleTxt.setText("好友列表"),this.mUpBtn=this.mScene.make.sprite(void 0,!1),this.mUpBtn.setTexture("bagView","bagView_tab.png"),this.mUpBtn.rotation=Math.PI/2,this.mDownBtn=this.mScene.make.sprite(void 0,!1),this.mDownBtn.setTexture("bagView","bagView_tab.png"),this.mDownBtn.rotation=-Math.PI/2,this.mDownBtn.setInteractive(),this.mUpBtn.setInteractive();var o=this.scene.make.image(void 0,!1);o.setTexture(this.mWorld.roomManager.currentRoom.playerManager.actor.getDisplay().displayInfo.id+""),this.add(o),this.mBg=new l.NinePatch(this.scene,0,0,500,350,h.a.getName(),null,h.a.getConfig()),this.addAt(this.mBg,0),this.setSize(this.mBg.width,this.mBg.height),this.initFriendItem(),this.mClsBtn=new d.IconBtn(this.mScene,this.mWorld,{key:y.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=(this.mWidth>>1)-65,this.mClsBtn.y=-this.mHeight>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn),t.prototype.init.call(this)},FriendPanel.prototype.tweenComplete=function(i){var o=this;t.prototype.tweenComplete.call(this,i),this.mWorld.roomManager.currentRoom.playerManager.actor.getFriend().requestFriend((function(t){o.setDataList(t)})),i&&this.mWorld.uiManager.getMediator(m.FriendMediator.NAME).resize()},FriendPanel.prototype.downHandler=function(){this.btnScaleHandler(this.mDownBtn);var t=this.mFriendDataList?this.mFriendDataList.length:0,i=Math.floor(t/FriendPanel.count);this.mIndex=this.mIndex+1>i?i:this.mIndex+1,this.refreshDataList()},FriendPanel.prototype.upHandler=function(){this.btnScaleHandler(this.mUpBtn),this.mIndex=this.mIndex-1>0?this.mIndex-1:0,this.refreshDataList()},FriendPanel.prototype.setDataList=function(t){if(this.mFriendList){this.mFriendDataList=t;t.length>FriendPanel.count?FriendPanel.count:t.length;for(var i=0;i<4;i++){var o=this.mFriendList[i],r=t[this.mIndex*FriendPanel.count+i];r?(o.visible=!0,r.index=i):o.visible=!1}this.add(this.mUpBtn),this.add(this.mDownBtn)}},FriendPanel.prototype.refreshDataList=function(){},FriendPanel.prototype.initFriendItem=function(){var t=this.mFriendList?this.mFriendList.length:FriendPanel.count;if(this.mFriendList&&this.mFriendList.length>0)for(var i=0;i<t;i++){(r=this.mFriendList[i]).resize(),r.y=this.mWorld.game.device.os.desktop?(-this.mBg.height/2+this.mTitleTxt.height+i*(r.height+10)+(r.height/2+10))*this.mWorld.uiScale:(i-1.5)*(r.height+10)}else{this.mFriendList=[];var o=[{res:"friendChat",name:"聊天"},{res:"friendGo",name:"跟随"}];for(i=0;i<t;i++){var r;(r=new v(this.mWorld,this.mScene,this,o)).y=this.mWorld.game.device.os.desktop?(-this.mBg.height/2+this.mTitleTxt.height+i*(r.height+10)+(r.height/2+10))*this.mWorld.uiScale:(i-1.5)*(r.height+10),this.mFriendList.push(r)}}},FriendPanel.count=4,FriendPanel}(a.BasePanel),v=function(t){function FriendItem(i,o,r,a){var d=t.call(this,o)||this;d.iconResList=[],d.mPanel=r,d.mWorld=i,d.mScene=o;d.mWorld.getSize();if(d.mBg=new l.NinePatch(d.mScene,0,0,d.mPanel.width,90,h.d.getName(),null,h.d.getConfig()),d.addAt(d.mBg,0),d.setSize(d.mBg.width,d.mBg.height),d.mRoleIcon=new u.DynamicImage(d.mScene,-d.mBg.width/2,0),d.nameTF=d.mScene.make.text({align:"left",style:{font:c.a.YAHEI_20_BOLD,fill:"#FFCC00"}},!1),d.statusTF=d.mScene.make.text({align:"left",style:{font:"14px YaHei"}},!1),a)for(var m=a.length,_loop_1=function(t){var i=y.mScene.make.image(void 0,!1),o=y.mScene.make.container(void 0,!1),r=new l.NinePatch(y.mScene,0,0,60,60,h.d.getName(),null,h.d.getConfig()),c=y.mScene.make.text(void 0,!1),u=a[t];c.setText(u.name),i.setTexture(u.res),i.scaleX=i.scaleY=.8,o.add(i),o.add(c),o.addAt(r,0),o.setSize(60,60),o.setInteractive(new p.Geom.Rectangle(0,0,60,60),Phaser.Geom.Rectangle.Contains),o.on("pointerdown",(function(){d.mPanel.btnScaleHandler(o)}),y),i.y=-r.height/2+i.height/2,c.x=-c.width>>1,c.y=o.height/2-c.height-4,y.add(o),y.iconResList.push(o)},y=this,g=0;g<m;g++)_loop_1(g);return d.add(d.mRoleIcon),d.add(d.nameTF),d.add(d.statusTF),d.refreshUIPos(),d}return g(FriendItem,t),FriendItem.prototype.resize=function(){this.mWorld.game.device.os.desktop||(this.mBg.resize(.95*this.mPanel.width,90),this.setSize(this.mBg.width,this.mBg.height),this.addAt(this.mBg,0),this.refreshUIPos())},FriendItem.prototype.getView=function(){return this},FriendItem.prototype.dataChange=function(t){var i=this,o=(t.level,t.id,t.nickname||"test");this.nameTF.setText(o),this.mRoleIcon.load(h.i.getOsdRes(t.avatar||"1"),this,(function(){i.mRoleIcon.scaleX=i.height/i.mRoleIcon.width,i.mRoleIcon.scaleY=i.height/i.mRoleIcon.height}),(function(){i.mRoleIcon.scaleX=i.mRoleIcon.scaleY=1})),this.mRoleIcon.x=-this.width/2+64,this.nameTF.x=this.mRoleIcon.x+54,this.index=t.index},FriendItem.prototype.destory=function(){this.index=0,this.nameTF&&this.nameTF.destroy(!0),this.statusTF&&this.statusTF.destroy(!0),this.mRoleIcon&&this.mRoleIcon.destroy(!0),this.nameTF=null,this.statusTF=null,this.mPanel=null,this.mWorld=null,t.prototype.destroy.call(this,!0)},FriendItem.prototype.refreshUIPos=function(){if(this.mRoleIcon.x=-this.width/2+64,this.nameTF.x=this.mRoleIcon.x+54,this.mRoleIcon.y=0,this.nameTF.y=10-this.mBg.height/2,this.statusTF.x=this.nameTF.x,this.iconResList)for(var t=this.iconResList.length,i=0;i<t;i++){this.iconResList[i].x=this.width/2-70*(i+1)+20}},FriendItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"RankPanel",(function(){return p}));var r,a=o(160),h=o(124),l=o(147),c=o(125),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function RankPanel(i,o){var r=t.call(this,i,o)||this;return r.mCurrentIndex=0,r}return u(RankPanel,t),RankPanel.prototype.addListen=function(){this.mInitialized&&(this.mWorld.game.device.os.desktop?this.mZoonInBtn.on("pointerup",this.onZoomHandler,this):this.mClsBtn.on("pointerup",this.closeHandler,this))},RankPanel.prototype.removeListen=function(){this.mInitialized&&(this.mWorld.game.device.os.desktop?this.mZoonInBtn.off("pointerup",this.onZoomHandler,this):this.mClsBtn.off("pointerup",this.closeHandler,this))},RankPanel.prototype.resize=function(t,i){if(void 0===t&&(t=0),void 0===i&&(i=0),this.mWorld){var o=this.mWorld.getSize();this.mWorld.game.device.os.desktop?(this.x=o.width-this.width/2,this.y=this.height/2+10):(this.mWorld.game.scale.orientation,Phaser.Scale.Orientation.LANDSCAPE,this.x=o.width+t>>1,this.y=o.height+i>>1),this.scale=this.mWorld.uiScale}},RankPanel.prototype.tweenView=function(t){if(this.scene){var i=this.height/2+10,o=!0===t?i:i-300,r=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Cubic.Out",props:{y:{value:o},alpha:{value:r}}})}},RankPanel.prototype.destroy=function(){this.mZoonInBtn&&this.mZoonInBtn.destroy(!0),this.mZoonInBtn=null,this.mCurrentIndex=0,t.prototype.destroy.call(this)},RankPanel.prototype.init=function(){t.prototype.init.call(this),this.mWorld.game.device.os.desktop?(this.mZoonInBtn=this.scene.make.image({x:0,y:this.height/2-10,key:"rank_atlas",frame:"arrow.png"},!1),this.add(this.mZoonInBtn),this.mZoonInBtn.setInteractive()):(this.mClsBtn=new h.IconBtn(this.scene,this.mWorld,{key:c.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=this.width/2-35,this.mClsBtn.y=-this.height/2,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn)),this.resize()},RankPanel.prototype.tweenComplete=function(i){if(t.prototype.tweenComplete.call(this,i),i){var o=this.getData("data");o&&this.addItem(o)}},RankPanel.prototype.closeHandler=function(){this.mWorld.uiManager.getMediator(l.RankMediator.NAME).hide()},RankPanel.prototype.onZoomHandler=function(){this.currentSizeIndex=0===this.mCurrentIndex?1:0},Object.defineProperty(RankPanel.prototype,"currentSizeIndex",{set:function(t){if(this.mCurrentIndex!==t){this.mCurrentIndex=t;var i=1===this.mCurrentIndex?30:this.height,o=1===this.mCurrentIndex?-this.height/2+20:this.height/2-10,r=1===this.mCurrentIndex?-this.height/2+15:0;this.mBackground.resize(328,i),this.mZoonInBtn.angle=1===this.mCurrentIndex?180:0,i>300?this.parentContainer&&this.add(this.mChildContainer):this.remove(this.mChildContainer),this.mBackground.y=r,this.mZoonInBtn.y=o}},enumerable:!1,configurable:!0}),RankPanel}(a.BasicRankPanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"RightBtnGroup",(function(){return g}));var r,a=o(112),h=o(124),l=o(133),c=o(111),u=o(2),p=o(110),d=o(132),m=o(162),y=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),g=function(t){function RightBtnGroup(i,o){var r=t.call(this,i,o)||this;return r.mBtnY=0,r.mWid=0,r.mHei=0,r.disInteractive(),r}return y(RightBtnGroup,t),RightBtnGroup.prototype.show=function(i){t.prototype.show.call(this,i)},RightBtnGroup.prototype.resize=function(){var t=this.mWorld.getSize();this.refreshSlot();var i=this.mWorld.uiManager.getMediator(m.BottomMediator.NAME),o=i?i.getView().height:this.height/2;if(this.scale=this.mWorld.uiScale,this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){var r=this.mWorld.roomManager.currentRoom.playerManager.actor.package;this.y=t.height-this.height*this.mWorld.uiScale,this.x=t.width-this.width/2*this.mWorld.uiScale,r&&r.items&&r.items.length>0?(this.y=t.height-this.height/2*this.mWorld.uiScale,this.x=t.width-this.width/4*this.mWorld.uiScale):(this.y=t.height-this.height*this.mWorld.uiScale,this.x=t.width-this.width/2*this.mWorld.uiScale)}else this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.PORTRAIT&&(this.y=t.height-(o+this.height/2)*this.mWorld.uiScale,this.x=t.width-this.width/2*this.mWorld.uiScale)},RightBtnGroup.prototype.hide=function(){t.prototype.hide.call(this),this.destroy()},RightBtnGroup.prototype.destroy=function(){this.mBtnY=0,this.mWid=0,this.mHei=0,this.mBagSlotList&&this.mBagSlotList.forEach((function(t){t&&(t.destroy(),t=null)})),this.mResKey="",this.mBagSlotList=null,t.prototype.destroy.call(this)},RightBtnGroup.prototype.tweenView=function(t){var i,o=this.mWorld.getSize();if(this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){var r=this.mWorld.roomManager.currentRoom.playerManager.actor.package;i=r&&r.items&&r.items.length>0?o.width-this.width/4*this.mWorld.uiScale:o.width-this.width/2*this.mWorld.uiScale}else i=o.width-this.width/2*this.mWorld.uiScale;var a=!0===t?i:i+this.width,h=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:{x:{value:a},alpha:{value:h}}})},RightBtnGroup.prototype.refreshSlot=function(){if(this.handBtn){if(this.mHei=this.handBtn.height,this.mBagSlotList){this.mBagSlotList.forEach((function(t){t&&(t.getView().visible=!1)}));var t=this.mWorld.roomManager.currentRoom.playerManager.actor.package;if(t&&t.items)for(var i=t.items,o=i.length>RightBtnGroup.SlotMaxCount?RightBtnGroup.SlotMaxCount:i.length,r=0,a=0,h=0;h<o;h++){if(this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){var l=38*(h+2)/-180*Math.PI;r=110*Math.cos(l),a=this.handBtn.y+110*Math.sin(l),h===o-1&&(this.mWid=110+this.handBtn.width+30+28,this.mHei=110+this.handBtn.height+30+28)}else r=0,a=-56*(h+1)-20*h,h===o-1&&(this.mWid=this.handBtn.width,this.mHei=56*(o-1)+5*(o-2)+this.handBtn.height+5);var c=this.mBagSlotList[h];c.getView().visible=!0,c.toolTipCon.x=r,c.toolTipCon.y=a,c.dataChange(i[h])}}this.setSize(this.mWid,this.mHei)}},RightBtnGroup.prototype.tweenComplete=function(i){this.resize(),t.prototype.tweenComplete.call(this,i)},RightBtnGroup.prototype.preload=function(){this.mResKey="baseView",this.scene.load.atlas(this.mResKey,c.i.getRes("ui/baseView/mainui_mobile.png"),c.i.getRes("ui/baseView/mainui_mobile.json")),t.prototype.preload.call(this)},RightBtnGroup.prototype.init=function(){var i=this;this.mWorld.getSize();this.mWorld.uiManager.getUILayerManager().addToUILayer(this),this.mBtnY=0,this.handBtn=new h.IconBtn(this.scene,this.mWorld,{key:d.BagMediator.NAME,bgResKey:this.mResKey,bgTextures:["btnGroup_bg.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_hand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.handBtn.x=0,this.handBtn.y=this.mBtnY+this.handBtn.height/2,this.handBtn.setClick((function(){var t=new p.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);t.content.keyCodes=[70],i.mWorld.connection.send(t)})),this.add(this.handBtn),this.mWid=this.handBtn.width,this.mHei=this.handBtn.height,this.initBagSlotData(),t.prototype.init.call(this)},RightBtnGroup.prototype.initBagSlotData=function(){this.mBagSlotList=[];this.mWorld.getSize();for(var t=RightBtnGroup.SlotMaxCount,i=0;i<t;i++){var o=new l.ItemSlot(this.scene,this.mWorld,this,0,0,this.mResKey,c.i.getRes("ui/baseView/mainui_mobile.png"),c.i.getRes("ui/baseView/mainui_mobile.json"),"btnGroup_bg.png");o.createUI(),o.getBg().scaleX=o.getBg().scaleY=.8,o.getIcon().scaleX=o.getIcon().scaleY=1.2,this.mBagSlotList.push(o),this.add(o.toolTipCon),o.getView().visible=!1}this.resize()},RightBtnGroup.SlotMaxCount=4,RightBtnGroup}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"BottomBtnGroup",(function(){return _}));var r,a=o(112),h=o(111),l=o(124),c=o(125),u=o(144),p=o(156),d=o(132),m=o(161),y=o(163),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function BottomBtnGroup(i,o){var r=t.call(this,i,o)||this;return r.mExpandBoo=!1,r.tmpWid=0,r.tmpHei=0,r.disInteractive(),r}return g(BottomBtnGroup,t),BottomBtnGroup.prototype.show=function(i){t.prototype.show.call(this,i)},BottomBtnGroup.prototype.addListen=function(){this.mChatContainer.on("pointerdown",this.chatHandler,this),this.mVoiceBtn.on("selected",this.onSelectedVoiceHandler,this),this.mMicBtn.on("selected",this.onSelectedMicHandler,this)},BottomBtnGroup.prototype.removeListen=function(){this.mChatContainer.off("pointerdown",this.chatHandler,this),this.mVoiceBtn.off("selected",this.onSelectedVoiceHandler,this),this.mMicBtn.off("selected",this.onSelectedMicHandler,this)},BottomBtnGroup.prototype.resize=function(){var t=this.mWorld.getSize();this.scale=this.mWorld.uiScale,this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?(this.x=t.width>>1,this.mVoiceBtn.x=this.mVoiceBtn.width*this.mMicBtn.scaleX-this.mChatContainer.width/2,this.mVoiceBtn.y=-this.mVoiceBtn.height/2*this.mVoiceBtn.scaleY-this.mChatContainer.height/2,this.mMicBtn.x=this.mVoiceBtn.x+this.mVoiceBtn.width*this.mMicBtn.scaleX+20,this.mMicBtn.y=this.mVoiceBtn.y):this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.PORTRAIT&&(this.x=t.width-(this.width/2+40)*this.mWorld.uiScale,this.mVoiceBtn.x=this.mVoiceBtn.width-this.mChatContainer.width/2,this.mVoiceBtn.y=this.mChatContainer.y-this.mChatContainer.height/2-this.mVoiceBtn.height/2*this.mMicBtn.scaleX,this.mMicBtn.x=this.mVoiceBtn.x+this.mMicBtn.width*this.mMicBtn.scaleX+20,this.mMicBtn.y=this.mVoiceBtn.y),this.y=t.height-120*this.mWorld.uiScale;var i,o=this.mWorld.uiManager.getMediator(m.RightMediator.NAME);if(o&&(i=o.getView()),o){if(this.mWorld.inputManager)this.mWorld.inputManager.resize();i&&i.resize()}this.mChatText.setStyle({fontSize:Math.floor(30*this.mWorld.uiScale)})},BottomBtnGroup.prototype.tweenView=function(t){var i=this.mWorld.getSize().height-120*this.mWorld.uiScale,o=!0===t?i:i+50,r=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:{y:{value:o},alpha:{value:r}}})},BottomBtnGroup.prototype.preload=function(){this.scene&&(this.mResKey="baseView",this.scene.load.atlas("chat_atlas",h.i.getRes("ui/chat/chat_atlas.png"),h.i.getRes("ui/chat/chat_atlas.json")),this.scene.load.atlas(this.mResKey,h.i.getRes("ui/baseView/mainui_mobile.png"),h.i.getRes("ui/baseView/mainui_mobile.json")),t.prototype.preload.call(this))},BottomBtnGroup.prototype.init=function(){var i=this;this.mBtnList=[];var o=this.mWorld.getSize();this.mWorld.uiManager.getUILayerManager().addToUILayer(this);this.mChatContainer=this.scene.make.container(void 0,!1),this.mChatBg=this.scene.make.image(void 0,!1),this.mChatBg.setTexture(this.mResKey,"btnGroup_chatBg.png"),this.mChatContainer.addAt(this.mChatBg,0),this.mChatText=this.scene.make.text({width:430,height:230,style:{font:"bold YaHei",color:"#666666",fontSize:Math.floor(30*this.mWorld.uiScale),wordWrap:{width:430,useAdvancedWrap:!0}}},!1),this.mChatText.setText("点击窗口进入聊天界面"),this.mChatContainer.addAt(this.mChatText,1),this.mChatContainer.setSize(430,230),this.mChatText.x=-this.mChatContainer.width>>1,this.mChatText.y=-this.mChatContainer.height>>1,this.mChatContainer.setInteractive(new Phaser.Geom.Rectangle(0,0,430,230),Phaser.Geom.Rectangle.Contains),this.add(this.mChatContainer),this.tmpWid+=this.mChatContainer.width,this.tmpHei+=this.mChatContainer.height,this.mTurnBtn=new l.IconBtn(this.scene,this.mWorld,{key:c.UIMediatorType.Turn_Btn_Bottom,bgResKey:this.mResKey,bgTextures:["btnGroup_white_normal.png","btnGroup_white_light.png","btnGroup_white_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_bottom_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mTurnBtn.x=30+(this.tmpWid>>1),this.mTurnBtn.y=this.tmpHei-this.mTurnBtn.height>>1,this.mTurnBtn.setPos(this.mTurnBtn.x,this.mTurnBtn.y),this.add(this.mTurnBtn),this.mBagBtn=new l.IconBtn(this.scene,this.mWorld,{key:d.BagMediator.NAME,bgResKey:this.mResKey,bgTextures:["btnGroup_yellow_normal.png","btnGroup_yellow_light.png","btnGroup_yellow_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_bag_icon.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mBagBtn.x=this.mTurnBtn.x,this.mBagBtn.y=this.mTurnBtn.y-this.mTurnBtn.height/2-this.mBagBtn.height/2-10,this.mBagBtn.setPos(this.mBagBtn.x,this.mBagBtn.y),this.tmpWid+=this.mBagBtn.width+30,this.add(this.mBagBtn),this.mBtnList.push(this.mBagBtn),this.mTurnBtn.setClick((function(){i.turnHandler()})),this.mBagBtn.setClick((function(){i.bagHandler()})),this.mMarketBag=new l.IconBtn(this.scene,this.mWorld,{key:d.BagMediator.NAME,bgResKey:this.mResKey,bgTextures:["btnGroup_yellow_normal.png","btnGroup_yellow_light.png","btnGroup_yellow_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_bag_icon.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mMarketBag.x=this.mTurnBtn.x,this.mMarketBag.y=this.mTurnBtn.y-this.mTurnBtn.height/2-this.mBagBtn.height/2-60-this.mMarketBag.height/2,this.mMarketBag.setPos(this.mMarketBag.x,this.mBagBtn.y),this.tmpWid+=this.mMarketBag.width+30,this.add(this.mMarketBag),this.setSize(this.tmpWid,this.tmpHei),this.mBtnList.push(this.mMarketBag),this.mMarketBag.setClick((function(){i.marketBagHandler()})),this.mVoiceBtn=new p.CheckButton(this.scene,0,0,"chat_atlas","voice_normal.png","voice_selected.png"),this.mVoiceBtn.x=this.width-60*this.mWorld.uiScale,this.mVoiceBtn.y=o.height-this.height,this.add(this.mVoiceBtn),this.mMicBtn=new p.CheckButton(this.scene,0,0,"chat_atlas","mic_normal.png","mic_selected.png"),this.mMicBtn.x=this.width-20*this.mWorld.uiScale,this.mMicBtn.y=o.height-this.height,this.add(this.mMicBtn),this.mVoiceBtn.scaleX=this.mVoiceBtn.scaleY=1.5,this.mMicBtn.scaleX=this.mMicBtn.scaleY=1.5,this.setSize(this.tmpWid,this.tmpHei),this.resize(),t.prototype.init.call(this)},BottomBtnGroup.prototype.tweenComplete=function(i){this.resize(),t.prototype.tweenComplete.call(this,i)},BottomBtnGroup.prototype.onSelectedVoiceHandler=function(t){!1===t&&(this.mMicBtn.selected=!1),this.emit("selectedVoice",t)},BottomBtnGroup.prototype.onSelectedMicHandler=function(t){!1!==this.mVoiceBtn.selected?(this.mMicBtn.selected=t,this.emit("selectedMic",t)):this.mMicBtn.selected=!1},BottomBtnGroup.prototype.turnHandler=function(){var t=this;this.mVoiceBtn.visible=this.mExpandBoo,this.mMicBtn.visible=this.mExpandBoo;var i=this.mExpandBoo?"Sine.easeIn":"Sine.easeOut";if(this.mChatContainer&&this.mChatContainer.parentContainer){var o=this.mExpandBoo?1:0,r=this.mExpandBoo?1:0;this.scene.tweens.add({targets:this.mChatContainer,duration:300,ease:i,props:{scaleX:{value:o},scaleY:{value:r}}})}if(!this.mBtnList||this.mBtnList.length<1)this.mExpandBoo=!this.mExpandBoo;else{var a,h=this.mBtnList.length,l=this.mWorld.uiManager.getMediator(m.RightMediator.NAME);l&&(a=l.getView());for(var _loop_1=function(o){var r=c.mBtnList[o],u=c.mExpandBoo?r.getPos().x:c.mChatContainer.width/2-Math.abs(r.getPos().y)-20,p=c.mExpandBoo?r.getPos().y:c.mTurnBtn.y;c.scene.tweens.add({targets:r,duration:300,ease:i,props:{x:{value:u},y:{value:p}},onComplete:function(i,c,u){if(o===h-1&&(t.mExpandBoo=!t.mExpandBoo,t.mExpandBoo?t.setSize(t.tmpWid,2*r.height):t.setSize(t.tmpWid,t.tmpHei),l)){if(t.mWorld.inputManager)t.mWorld.inputManager.resize();a&&a.resize()}},onCompleteParams:[c]})},c=this,u=0;u<h;u++)_loop_1(u)}},BottomBtnGroup.prototype.chatHandler=function(){var t=this.mWorld.uiManager.getMediator(u.ChatMediator.NAME);void 0===t&&(t=new u.ChatMediator(this.mWorld,this.scene),this.mWorld.uiManager.setMediator(u.ChatMediator.NAME,t)),t.isShow()||t.show(),this.mWorld.uiManager.baseFaceTween(!1)},BottomBtnGroup.prototype.bagHandler=function(){this.mWorld.uiManager.getMediator(c.UIMediatorType.BagMediator).show()},BottomBtnGroup.prototype.marketBagHandler=function(){var t=this.mWorld.uiManager.getMediator(y.ElementStorageMediator.name);t||(t=new y.ElementStorageMediator(this.mWorld.uiManager.getUILayerManager(),this.scene,this.mWorld),this.mWorld.uiManager.setMediator(y.ElementStorageMediator.name,t)),t.isShow()?t.hide():t.show(!0)},BottomBtnGroup}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ElementStoragePanel",(function(){return m}));var r,a=o(112),h=o(117),l=o(111),c=o(198),u=o(163),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function ElementStoragePanel(i,o){var r=t.call(this,i,o)||this;return r.mExpaned=!0,r.mItemNum=32,r.setTween(!1),r.dpr/=2,r}return d(ElementStoragePanel,t),ElementStoragePanel.prototype.show=function(i){t.prototype.show.call(this,i),this.mInitialized&&this.setPackageNum(1)},ElementStoragePanel.prototype.resize=function(t){var i=this.mWorld.getSize();if(this.scale=this.dpr,this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE){this.setSize(341,450),this.x=i.width-this.width*this.dpr-10,this.y=i.height-this.height*this.dpr>>1,this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(327,423),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=145,this.mSearchInput.y=40,this.mDragBtn.x=-this.mDragBtn.height,this.mDragBtn.y=this.height>>1;for(var o=this.mProps.length,r=0;r<o;r++)this.mProps[r].x=r%4*60+20,this.mProps[r].y=60*Math.floor(r/4)+80}else{this.setSize(510,329),this.mBackground.resize(this.width,this.height),this.mBackground.x=this.mBackground.width>>1,this.mBackground.y=this.mBackground.height>>1,this.mBorder.resize(496,303),this.mBorder.x=7+(this.mBorder.width>>1),this.mBorder.y=19+(this.mBorder.height>>1),this.mSearchInput.x=270,this.mSearchInput.y=33,this.x=i.width-this.width*this.dpr>>1,this.y=i.height-this.height*this.dpr-10,this.mDragBtn.x=this.width>>1,this.mDragBtn.y=-this.mDragBtn.height>>1;for(o=this.mProps.length,r=0;r<o;r++)this.mProps[r].x=r%8*60+20,this.mProps[r].y=60*Math.floor(r/8)+80}this.mPrePageBtn.y=this.height>>1,this.mNextPageBtn.x=this.width,this.mNextPageBtn.y=this.height>>1,this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,this.width,this.height),Phaser.Geom.Rectangle.Contains)},ElementStoragePanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.mBackground&&this.mBackground.on("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.on("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.on("dragstart",this.onDragStartHandler,this),this.scene.input.on("dragend",this.onDragEndHandler,this),this.scene.input.on("drag",this.onDragHandler,this))},ElementStoragePanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.mBackground&&this.mBackground.off("pointerout",this.onPointerOutHandler,this),this.mDragBtn&&this.mDragBtn.off("pointerup",this.switchExpand,this),this.mPrePageBtn&&this.mPrePageBtn.off("pointerup",this.onPrePageHandler,this),this.mNextPageBtn&&this.mNextPageBtn.off("pointerup",this.onNextPageHandler,this),this.mCloseBtn&&this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this))},ElementStoragePanel.prototype.setProps=function(t){var i=t.items;this.clearItem();for(var o=0;o<i.length;o++){if(o>=this.mProps.length)return;this.mProps[o].setProp(i[o])}},ElementStoragePanel.prototype.expand=function(){if(!this.mExpaned){var t=this.mWorld.getSize(),i=null;i=this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width-this.width*this.dpr-10}:{y:t.height-this.height*this.dpr-10},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:i}),this.remove(this.mDragBtn),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!0}},ElementStoragePanel.prototype.collapse=function(){if(this.mExpaned){var t=this.mWorld.getSize(),i=null;i=this.mWorld.game.scale.orientation===Phaser.Scale.Orientation.LANDSCAPE?{x:t.width}:{y:t.height},this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:i}),this.addAt(this.mDragBtn,0),this.remove([this.mPrePageBtn,this.mNextPageBtn]),this.mExpaned=!1}},ElementStoragePanel.prototype.destroy=function(){this.scene&&(this.scene.input.off("dragstart",this.onDragStartHandler,this),this.scene.input.off("dragend",this.onDragEndHandler,this),this.scene.input.off("drag",this.onDragHandler,this)),t.prototype.destroy.call(this)},ElementStoragePanel.prototype.preload=function(){this.scene.load.image(l.d.getName(),l.d.getPNG()),this.scene.load.image("button",l.i.getRes("ui/common/button.png")),this.scene.load.image("prop_background",l.i.getRes("ui/common/prop_background.png")),this.scene.load.atlas("slip",l.i.getRes("ui/bag/slip.png"),l.i.getRes("ui/bag/slip.json")),this.mScene.load.atlas("clsBtn",l.i.getRes("ui/common/common_clsBtn.png"),l.i.getRes("ui/common/common_clsBtn.json")),this.scene.load.image(l.a.getName(),l.a.getPNG()),t.prototype.preload.call(this)},ElementStoragePanel.prototype.init=function(){this.mBackground=new h.NinePatch(this.scene,0,0,this.width,this.height,l.a.getName(),null,l.a.getConfig()),this.mBorder=new h.NinePatch(this.scene,7,19,327,423,l.d.getName(),null,l.d.getConfig()),this.mSearchInput=new p.InputText(this.scene,145,40,210,26,{type:"input",fontSize:"14px",color:"#808080",placeholder:"输入关键词进行搜索"});this.mDragBtn=new p.NineSliceButton(this.scene,0,-20,80,40,"button","","物件容器",this.dpr,this.scale,{left:4,top:4,right:4,bottom:4}),this.mPrePageBtn=this.scene.make.sprite({key:"slip"},!1),this.mPrePageBtn.setInteractive(),this.mNextPageBtn=this.scene.make.sprite({key:"slip"},!1).setFlipX(!0),this.mNextPageBtn.setInteractive(),this.mProps=[],this.add([this.mBackground,this.mBorder,this.mSearchInput]);for(var i=0;i<this.mItemNum;i++){var o=new c.Item(this.scene);this.mProps[i]=o}this.add(this.mProps),this.add([this.mPrePageBtn,this.mNextPageBtn]),this.mCloseBtn=this.scene.make.image({key:"clsBtn",frame:"btn_normal"},!1).setInteractive().setScale(2),this.add(this.mCloseBtn),t.prototype.init.call(this),this.resize(),this.expand()},ElementStoragePanel.prototype.onPrePageHandler=function(){this.setPackageNum(this.mPacgeNum-1)},ElementStoragePanel.prototype.onNextPageHandler=function(){this.setPackageNum(this.mPacgeNum+1)},ElementStoragePanel.prototype.setPackageNum=function(t){this.mPacgeNum=t<1?1:t,this.emit("queryElement",this.mPacgeNum,32)},ElementStoragePanel.prototype.switchExpand=function(){this.mExpaned?this.collapse():this.expand()},ElementStoragePanel.prototype.onSelectedHandler=function(){},ElementStoragePanel.prototype.onClick=function(t){},ElementStoragePanel.prototype.onDragStartHandler=function(t,i,o,r){var a=i.parentContainer;a instanceof c.Item&&(this.mDragData=a.prop),this.mDragImage||(this.mDragImage=this.scene.make.image(void 0,!1),this.add(this.mDragImage)),this.mDragImage.x=a.x,this.mDragImage.y=a.y,this.mDragImage.setTexture(i.texture.key),this.mDragging=!0},ElementStoragePanel.prototype.onDragEndHandler=function(){this.mDragImage&&(this.mDragImage.setTexture(void 0),this.mDragging=!1)},ElementStoragePanel.prototype.onDragHandler=function(t,i,o,r){this.mDragImage&&(this.mDragImage.x+=t.x-t.prevPosition.x,this.mDragImage.y+=t.y-t.prevPosition.y)},ElementStoragePanel.prototype.onPointerOutHandler=function(){this.mDragImage&&this.mDragging&&(this.emit("selectedElement",this.mDragData),this.mDragImage.setTexture(void 0),this.mDragging=!1)},ElementStoragePanel.prototype.clearItem=function(){this.mProps&&this.mProps.map((function(t){return t.clear()}))},ElementStoragePanel.prototype.onCloseHandler=function(){var t=this.mWorld.uiManager.getMediator(u.ElementStorageMediator.name);t&&t.hide()},ElementStoragePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"Item",(function(){return c}));var r,a=o(116),h=o(111),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Item(i){var o=t.call(this,i)||this,r=i.make.image({key:"prop_background"}).setOrigin(0,0);return o.setSize(r.width,r.height),o.add(r),o.mImage=new a.DynamicImage(o.scene,0,0).setOrigin(0,0),o.add(o.mImage),o.mCount=i.make.text(void 0,!1),o.mCount.setAlign("right"),o.mCount.y=o.height-20,o.add(o.mCount),o}return l(Item,t),Item.prototype.setProp=function(t){var i=this;this.mProp=t,this.mCount&&t&&(this.mImage.load(h.i.getOsdRes(t.display.texturePath),this,(function(){i.mImage.setInteractive(),i.scene.input.setDraggable(i.mImage);var t=1;i.mImage.width>i.width&&(t=i.width/i.mImage.width),i.mImage.height>i.height&&(t=i.height/i.mImage.height),i.mImage.scale=t})),this.mCount.setText(t.count>1?t.count.toString():""),this.mCount.x=this.width-this.mCount.width)},Item.prototype.clear=function(){this.count&&this.mProp&&(this.mCount.setText(""),this.mImage.setTexture(void 0),this.mImage.off("pointerup",this.onPointerUpHandler,this),this.mProp=void 0)},Item.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},Object.defineProperty(Item.prototype,"prop",{get:function(){return this.mProp},enumerable:!1,configurable:!0}),Item.prototype.onPointerUpHandler=function(){this.emit("click",this.mProp)},Item}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"ElementStorage",(function(){return u}));var r,a=o(110),h=o(2),l=o(119),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function ElementStorage(i){var o=t.call(this)||this;return o.world=i,o.event=new Phaser.Events.EventEmitter,o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_QUERY_EDIT_PACKAGE,o.onQueryEditPackageResuleHandler),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE,o.onQueryMarketPacketResuleHandler),o}return c(ElementStorage,t),ElementStorage.prototype.register=function(){this.world&&this.world.connection.addPacketListener(this)},ElementStorage.prototype.unregister=function(){this.world&&(this.world.connection.removePacketListener(this),this.event.removeAllListeners())},ElementStorage.prototype.on=function(t,i,o){this.event.on(t,i,o)},ElementStorage.prototype.off=function(t,i,o){this.event.off(t,i,o)},ElementStorage.prototype.queryPackage=function(t,i,o,r){this.world},ElementStorage.prototype.queryMarketPackage=function(t,i,o,r){this.world},ElementStorage.prototype.destroy=function(){this.unregister()},ElementStorage.prototype.onQueryEditPackageResuleHandler=function(t){this.event.emit(l.a.EDIT_MODE_QUERY_PACKAGE,t.content)},ElementStorage.prototype.onQueryMarketPacketResuleHandler=function(t){this.event.emit(l.a.EDIT_MODE_QUERY_PACKAGE,t.content)},ElementStorage}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"LeftMediator",(function(){return c}));var r,a=o(134),h=o(201),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function LeftMediator(i,o){return t.call(this,i,o)||this}return l(LeftMediator,t),LeftMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new h.LeftBtnGroup(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i))},LeftMediator.NAME="LeftMediator",LeftMediator}(a.BaseFaceMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"LeftBtnGroup",(function(){return u}));var r,a=o(112),h=o(111),l=o(202),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function LeftBtnGroup(i,o){var r=t.call(this,i,o)||this;return r.mCollapse=!1,r.disInteractive(),r}return c(LeftBtnGroup,t),LeftBtnGroup.prototype.show=function(i){this.scale=this.mWorld.uiScale,t.prototype.show.call(this,i)},LeftBtnGroup.prototype.resize=function(){this.x=this.width+5*this.mWorld.uiScale,this.y=this.height/2+10*this.mWorld.uiScale,this.scale=this.mWorld.uiScale},LeftBtnGroup.prototype.destroy=function(){this.mExpandBtn&&this.mExpandBtn.destroy(),this.mResKey="",this.mExpandBtn=null,this.mCollapse=!1,t.prototype.destroy.call(this)},LeftBtnGroup.prototype.tweenView=function(t){var i=this.width+5*this.mWorld.uiScale,o=!0===t?i:i-50,r=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Linear",props:{x:{value:o},alpha:{value:r}}})},LeftBtnGroup.prototype.addListen=function(){},LeftBtnGroup.prototype.removeListen=function(){},LeftBtnGroup.prototype.preload=function(){this.scene&&(this.mResKey="baseView",this.scene.load.atlas(this.mResKey,h.i.getRes("ui/baseView/mainui_mobile.png"),h.i.getRes("ui/baseView/mainui_mobile.json")),t.prototype.preload.call(this))},LeftBtnGroup.prototype.init=function(){var i=this;this.mWorld.uiManager.getUILayerManager().addToUILayer(this);var o=0;"app"!==this.mWorld.getConfig().platform&&(this.mExpandBtn=new l.IconSelectBtn(this.scene,this.mWorld,this.mResKey,["btnGroup_expand.png","btnGroup_collapse.png"],1),this.add(this.mExpandBtn),this.mExpandBtn.setClick((function(){i.mCollapse?i.mWorld.stopFullscreen():i.mWorld.startFullscreen(),i.mExpandBtn.setBgRes(Number(!i.mCollapse)),i.mCollapse=!i.mCollapse})),o+=this.mExpandBtn.height/2+20,this.setSize(this.mExpandBtn.width,o)),this.resize(),t.prototype.init.call(this)},LeftBtnGroup}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"IconSelectBtn",(function(){return l}));var r,a=o(118),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function IconSelectBtn(i,o,r,a,h){void 0===h&&(h=28/43);var l=t.call(this,i)||this;return l.mScene=i,l.mWorld=o,l.mBtnBg=i.make.image(void 0,!1),l.mBgTexture=a,l.mBgResKey=r,l.mBtnBg.setTexture(r,a[0]),l.mBtnBg.scaleX=l.mBtnBg.scaleY=h,l.addAt(l.mBtnBg,0),l.setSize(l.mBtnBg.width,l.mBtnBg.height),l.setInteractive(),l.on("pointerup",l.upHandler,l),l.on("pointerdown",l.downHandler,l),l.on("pointerover",l.overHandler,l),l.on("pointerout",l.outHandler,l),l}return h(IconSelectBtn,t),IconSelectBtn.prototype.setPos=function(t,i){this.mBasePos||(this.mBasePos=new a.a),this.mBasePos.x=t,this.mBasePos.y=i},IconSelectBtn.prototype.getPos=function(){return this.mBasePos},IconSelectBtn.prototype.setBtnData=function(t){this.mBtnData=t},IconSelectBtn.prototype.getBtnData=function(){return this.mBtnData},IconSelectBtn.prototype.setClick=function(t){this.monClick=t},IconSelectBtn.prototype.setBgRes=function(t){this.mBtnBg.setTexture(this.mBgResKey,this.mBgTexture[t]||0)},IconSelectBtn.prototype.destroy=function(){this.mBtnBg&&this.mBtnBg.destroy(!0),this.mBtnIcon&&this.mBtnIcon.destroy(!0),this.monClick=null,this.mBtnBg=null,this.mBtnIcon=null,this.mBtnData=null,this.mScene=null,t.prototype.destroy.call(this)},IconSelectBtn.prototype.overHandler=function(t){},IconSelectBtn.prototype.outHandler=function(t){},IconSelectBtn.prototype.upHandler=function(){this.monClick&&this.monClick()},IconSelectBtn.prototype.downHandler=function(){this.scaleHandler()},IconSelectBtn.prototype.scaleHandler=function(){this.mScene.tweens.add({targets:this,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),this.scaleX=this.scaleY=1},IconSelectBtn}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"BagGroupMediator",(function(){return p}));var r,a=o(134),h=o(119),l=o(204),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function BagGroupMediator(i,o){var r=t.call(this,i,o)||this;return r.mUIType=c.UIType.Scene,r}return u(BagGroupMediator,t),BagGroupMediator.prototype.isSceneUI=function(){return!0},BagGroupMediator.prototype.isShow=function(){if(this.mView)return this.mView.isShow()},BagGroupMediator.prototype.show=function(i){if(!this.mView||!this.mView.isShow()){var o=this.world.getSize();this.mView=new l.BagGroup(this.mScene,this.world,(o.width>>1)-29,o.height-50),this.mView.show(i),this.addListen(),t.prototype.show.call(this,i)}},BagGroupMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},BagGroupMediator.prototype.hide=function(){this.mShow=!1,this.removeListen(),this.mView&&(this.mView.hide(),this.mView=null)},BagGroupMediator.prototype.addListen=function(){this.world.emitter.on(h.a.QUERY_PACKAGE,this.queryPackAge,this),this.world.emitter.on(h.a.UPDATED_CHARACTER_PACKAGE,this.heroItemChange,this),this.world.emitter.on(h.a.PACKAGE_ITEM_ADD,this.heroItemChange,this)},BagGroupMediator.prototype.removeListen=function(){this.world.emitter.off(h.a.QUERY_PACKAGE,this.queryPackAge,this),this.world.emitter.off(h.a.UPDATED_CHARACTER_PACKAGE,this.heroItemChange,this),this.world.emitter.off(h.a.PACKAGE_ITEM_ADD,this.heroItemChange,this)},BagGroupMediator.prototype.heroItemChange=function(){if(this.world.roomManager.currentRoom&&this.world.roomManager.currentRoom.playerManager&&this.world.roomManager.currentRoom.playerManager.actor){var t=this.world.roomManager.currentRoom.playerManager.actor.package.items;this.mView&&this.mView.setDataList(t)}},BagGroupMediator.prototype.queryPackAge=function(t){this.world.roomManager.currentRoom&&this.world.roomManager.currentRoom.playerManager&&this.world.roomManager.currentRoom.playerManager.actor&&t.id===this.world.roomManager.currentRoom.playerManager.actor.package.id&&this.mView&&this.mView.setDataList(t.items)},BagGroupMediator.NAME="BagGroupMediator",BagGroupMediator}(a.BaseFaceMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"BagGroup",(function(){return m}));var r,a=o(133),h=o(111),l=o(164),c=o(144),u=o(132),p=o(112),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function BagGroup(i,o,r,a){var h=t.call(this,i,o)||this;return h.tmpWid=0,h.x=r,h.y=a,o.uiManager.getUILayerManager().addToToolTipsLayer(h),h.bagSlotList=[],h}return d(BagGroup,t),BagGroup.prototype.show=function(i){t.prototype.show.call(this)},BagGroup.prototype.resize=function(t,i){var o=this.mWorld.getSize(),r=this.mWorld.uiManager.getMediator(c.ChatMediator.NAME);this.x=(o.width-this.tmpWid)/2<r.getView().width?r.getView().width+this.width/2:(o.width-this.tmpWid)/2,this.y=o.height-50},BagGroup.prototype.tweenExpand=function(t){if(this.scene){var i=this.mWorld.getSize().height-50,o=!0===t?i:i+100,r=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Cubic.Out",props:{y:{value:o},alpha:{value:r}}})}},BagGroup.prototype.destroy=function(){this.bagSlotList&&(this.bagSlotList.forEach((function(t){t&&t.destroy()})),this.bagSlotList.length=0,this.bagSlotList=null),this.tmpWid=0,this.baseBagBgWid=0,this.mResStr=null,this.mResPng=null,this.mResJson=null,t.prototype.destroy.call(this)},BagGroup.prototype.addListen=function(){this.mBagBtnCon&&(this.mBagBtnCon.on("pointerdown",this.bagHandler,this),this.mBagBtnCon.on("pointerover",this.bagBtnOver,this),this.mBagBtnCon.on("pointerout",this.bagBtnOut,this))},BagGroup.prototype.removeListen=function(){this.mBagBtnCon&&(this.mBagBtnCon.off("pointerdown",this.bagHandler,this),this.mBagBtnCon.off("pointerover",this.bagBtnOver,this),this.mBagBtnCon.off("pointerout",this.bagBtnOut,this))},BagGroup.prototype.setDataList=function(t){this.bagSlotList&&this.bagSlotList.forEach((function(t){t&&(t.getView().visible=!1)}));for(var i=[],o=t.length>BagGroup.SlotMaxCount?BagGroup.SlotMaxCount:t.length,r=this.baseBagBgWid+5,a=0;a<o;a++){var h=this.bagSlotList[a];h.getView().visible=!0,i.push(h.toolTipCon),h.dataChange(t[a]),r+=61}this.width!==r&&(this.width=r,this.buttons&&(this.buttons.destroy(!0),this.buttons=null),this.buttons=this.scene.rexUI.add.buttons({x:(r+this.mBagBg.width)/2,y:0,width:56,height:56,orientation:0,buttons:i,groupName:"bagBtn",align:"right",click:{mode:"pointerup",clickInterval:100},space:5,name:"bag"}),this.buttons.layout(),this.setSize(r,65),this.mWorld.uiManager.baseFaceResize())},BagGroup.prototype.preload=function(){this.scene&&(this.mResStr="bag",this.mResPng="ui/bag/bag.png",this.mResJson="ui/bag/bag.json",this.scene.load.atlas(this.mResStr,h.i.getRes(this.mResPng),h.i.getRes(this.mResJson)),t.prototype.preload.call(this))},BagGroup.prototype.init=function(){if(this.mBagBtnCon=this.scene.add.container(0,0),this.mBagBg=this.scene.add.sprite(0,0,this.mResStr,"bag_BtnBg"),this.baseBagBgWid=this.mBagBg.width,this.tmpWid+=this.mBagBg.width+5,this.bagBtn=this.scene.add.sprite(this.mBagBg.x,this.mBagBg.y,this.mResStr,"bag_Btn"),this.mSubScriptSprite=this.scene.make.sprite(void 0,!1),this.mSubScriptSprite.setTexture(this.mResStr,"bag_SubScripta"),this.mSubScriptSprite.x=this.mSubScriptSprite.width-this.mBagBg.width>>1,this.mSubScriptSprite.y=this.mSubScriptSprite.height-this.mBagBg.height>>1,this.mBagBtnCon.addAt(this.mBagBg,0),this.mBagBtnCon.addAt(this.bagBtn,1),this.mBagBtnCon.setSize(56,56),this.mBagBtnCon.setInteractive(new Phaser.Geom.Rectangle(0,0,this.mBagBg.width,this.mBagBg.height),Phaser.Geom.Rectangle.Contains),this.initBagSlot(),this.setSize(this.tmpWid,65),this.mWorld.roomManager.currentRoom&&this.mWorld.roomManager.currentRoom.playerManager&&this.mWorld.roomManager.currentRoom.playerManager.actor){var i=this.mWorld.roomManager.currentRoom.playerManager.actor.package;i&&i.items&&this.setDataList(i.items)}this.add(this.mBagBtnCon),t.prototype.init.call(this)},BagGroup.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.baseFaceResize()},BagGroup.prototype.initBagSlot=function(){for(var t,i=["0","b","c"],o=0;o<BagGroup.SlotMaxCount;o++){t=o>=9?"bag_SubScript"+i[o%9]:"bag_SubScript"+(o+1);var r=new a.ItemSlot(this.scene,this.mWorld,this,0,0,this.mResStr,this.mResPng,this.mResJson,"bag_Slot","",t);r.createUI(),r.getView().visible=!1,this.bagSlotList.push(r)}},BagGroup.prototype.bagHandler=function(){var t=this.mWorld.uiManager.getMediator(u.BagMediator.NAME);t.isShow()?t.hide():t.show()},BagGroup.prototype.tmpLoad=function(){var t=this;this.radio?this.radio.isShow||this.radioComplete():this.radio=new l.Radio(this.scene,{wid:328,hei:142,resKey:"juqingRadio",resPng:"./resources/ui/juqing/juqing.png",resJson:"./resources/ui/juqing/juqing.json",resBg:"radio_bg.png",resArrow:"radio_arrow.png",fontStyle:{size:20,color:"#ffcc00",bold:!1},completeBack:function(){t.radioComplete()},clickCallBack:function(){t.radio&&t.radio.parentContainer&&(t.radio.clearRadioData(),t.radio.parentContainer.remove(t.radio))}})},BagGroup.prototype.radioComplete=function(){this.radio.setRadioData(["1111111111","2222222222","333333333333","444444444444"]),this.radio.x=this.bagBtn.x,this.radio.y=this.bagBtn.y-142,this.add(this.radio)},BagGroup.prototype.bagBtnOver=function(t){this.mBagSelect=this.scene.make.sprite(void 0,!1),this.mBagSelect.setTexture(this.mResStr,"bag_BtnSelect"),this.mBagBtnCon.add(this.mBagSelect)},BagGroup.prototype.bagBtnOut=function(t){this.mBagSelect&&this.mBagSelect.parentContainer&&this.mBagSelect.parentContainer.remove(this.mBagSelect)},BagGroup.SlotMaxCount=12,BagGroup}(p.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"TopMenuMediator",(function(){return d}));var r,a=o(119),h=o(206),l=o(110),c=o(2),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function TopMenuMediator(i,o){var r=t.call(this)||this;return r.scene=i,r.world=o,r}return p(TopMenuMediator,t),TopMenuMediator.prototype.show=function(){this.register()},TopMenuMediator.prototype.hide=function(){this.unregister()},TopMenuMediator.prototype.isSceneUI=function(){return!0},TopMenuMediator.prototype.register=function(){this.world.emitter.on(a.a.ADD_ICON_TO_TOP,this.onAddIconHandler,this),this.world.emitter.on(a.a.REMOVE_ICON_FROM_TOP,this.onAddIconHandler,this)},TopMenuMediator.prototype.unregister=function(){this.world.emitter.off(a.a.ADD_ICON_TO_TOP,this.onAddIconHandler,this),this.world.emitter.off(a.a.REMOVE_ICON_FROM_TOP,this.onRemoveIcon,this)},TopMenuMediator.prototype.destroy=function(){this.hide(),t.prototype.destroy.call(this)},TopMenuMediator.prototype.addItem=function(t){this.mView||(this.mView=new h.TopMenuContainer(this.scene,this.world),this.mView.on("saveDecorate",this.onSaveDecorateHandler,this),this.mView.on("enterDecorate",this.onEnterDecorateHandler,this),this.mView.on("showMarket",this.onShowMarketHandler,this)),this.mView.addItem(t)},TopMenuMediator.prototype.removeItem=function(t){this.mView&&this.mView.removeItem(t)},TopMenuMediator.prototype.onAddIconHandler=function(t){this.addItem(t)},TopMenuMediator.prototype.onRemoveIcon=function(t){this.removeItem(t)},TopMenuMediator.prototype.onSaveDecorateHandler=function(){var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);t.content.needSaveEditScene=!0,this.world.connection.send(t)},TopMenuMediator.prototype.onEnterDecorateHandler=function(){var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);this.world.connection.send(t)},TopMenuMediator.prototype.onShowMarketHandler=function(){var t=new l.PBpacket(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI);t.content.name="Market",this.world.emitter.emit(a.a.SHOW_UI,t)},TopMenuMediator.NAME="TopMenuMediator",TopMenuMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"TopMenuContainer",(function(){return c}));var r,a=o(112),h=o(111),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function TopMenuContainer(i,o){var r=t.call(this,i,o)||this;return r.maxNum=3,r.setTween(!1),r.mButtons=[],r}return l(TopMenuContainer,t),TopMenuContainer.prototype.resize=function(){var t=this.mWorld.getSize();this.x=t.width-50*this.mWorld.uiScale,this.y=this.height/2+120*this.mWorld.uiScale,this.scale=this.dpr},TopMenuContainer.prototype.show=function(){this.mWorld&&this.mWorld.uiManager.getUILayerManager().addToUILayer(this),t.prototype.show.call(this)},TopMenuContainer.prototype.hide=function(){this.parentContainer&&this.parentContainer.remove(this)},TopMenuContainer.prototype.addItem=function(t){},TopMenuContainer.prototype.removeItem=function(t){var i=this.mButtons.findIndex((function(i){return i.name===t}));i>=0&&(this.mButtons[i].destroy(),this.mButtons.splice(i,1)),this.mButtons.length,this.maxNum,0===this.mButtons.length&&this.hide(),this.refresh()},TopMenuContainer.prototype.preload=function(){this.scene.load.atlas("baseView",h.i.getRes("ui/baseView/mainui_mobile.png"),h.i.getRes("ui/baseView/mainui_mobile.json")),t.prototype.preload.call(this)},TopMenuContainer.prototype.init=function(){this.mInitialized||(t.prototype.init.call(this),this.resize())},TopMenuContainer.prototype.refresh=function(){for(var t=0;t<this.mButtons.length;t++)this.mButtons[t].x=-(60*t+30)},TopMenuContainer.prototype.expand=function(){},TopMenuContainer.prototype.collapse=function(){},TopMenuContainer.prototype.destroy=function(){this.mButtons.map((function(t){return t.destroy()})),this.mButtons.length=0,t.prototype.destroy.call(this)},TopMenuContainer.prototype.onGameObjectUpHandler=function(t){switch(t.name){case"SaveDecorate":this.emit("saveDecorate");break;case"EnterDecorate":this.emit("enterDecorate");break;case"Market":this.emit("showMarket")}},TopMenuContainer}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"InputTextFactory",(function(){return l})),o.d(i,"InputTextFieldEvent",(function(){return c})),o.d(i,"InputTextField",(function(){return u}));var r,a=o(109),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(){function InputTextFactory(t){this.mWorld=t}return InputTextFactory.prototype.getInputText=function(t,i){return new u(t,this.mWorld,i)},InputTextFactory}(),c={textchange:"textchange",textclick:"textclick",textdblclick:"textdblclick",textfocus:"textfocus",textblur:"textblur",textExit:"textExit"},u=function(t){function InputTextField(i,o,r){var a=t.call(this)||this;return a.mDelayTime=300,a.mScene=i,a.mWorld=o,a.textConfig=r,a.mTextField=i.make.text({x:r.x||0,y:r.y||0,stroke:"#000000",strokeThickness:2,align:r.align||"left",style:{color:r.color||"#fff",font:r.font||"16px YaHei",wordWrap:{width:r.textWidt||null}}},!1).setInteractive(new Phaser.Geom.Rectangle(0,0,r.textWidth,r.textHeight),Phaser.Geom.Rectangle.Contains),a.mTextField.setOrigin(.5,.5),a.mTextField.setAlign(r.align),a.mTextField.setText(r.text||""),a.mTextField.on("pointerdown",a.showText,a),a}return h(InputTextField,t),InputTextField.prototype.onBlur=function(){this.mInputText.onBlur()},InputTextField.prototype.onFocus=function(){this.mInputText.onFocus()},InputTextField.prototype.getText=function(){return this.mTextField.text},InputTextField.prototype.getSkin=function(){return this.mTextField},InputTextField.prototype.destroy=function(){this.mInputText&&this.mInputText.destroy(),this.mInputText=null},InputTextField.prototype.showText=function(){var t=this,i=1===this.textConfig.posType?-this.textConfig.textWidth>>1:-this.mWorld.getSize().width>>1,o=this.mTextField.text&&this.mTextField.text.length>0?this.mTextField.text:this.textConfig.minNum;this.mInputText?this.mInputText.setText(o):(this.mInputText=new a.InputText(this.mScene,{id:this.textConfig.id||"input",x:i||0,y:this.textConfig.y||0,width:this.textConfig.textWidth||100,height:this.textConfig.textHeight||100,type:this.textConfig.type||"",fontSize:this.textConfig.font||"16px YaHei",color:this.textConfig.color||"#fff","z-index":999,align:"left",text:o,posType:this.textConfig.posType}),this.mInputText.setOrigin(0,.6)),1===this.textConfig.posType&&(this.mTextField.visible=!1,this.mInputText.parentContainer||this.mTextField.parentContainer.add(this.mInputText)),this.mInputText.visible=!0,this.mInputText.on("textchange",this.onTextchange,this),this.mInputText.on("onclick",this.onTextClick,this),this.mInputText.on("ondblclick",this.onTextDbclick,this),this.mInputText.on("focus",this.onTextFocus,this),this.mInputText.on("blur",this.onTextBlur,this),this.mInputText.node.addEventListener("keypress",(function(i){13===(i.keyCode||i.which)&&(t.emit(c.textExit),t.hideText())})),this.mScene.input.on("gameobjectdown",this.sceneDown,this),this.mWorld.game.device.os.iOS&&!this.mWorld.game.device.os.desktop?this.setInputFocus():this.mInputTimeID=this.mScene.setTimeout((function(){t.setInputFocus()}),this.mDelayTime)},InputTextField.prototype.hideText=function(){if(this.mTextField.visible=!0,this.mInputText){this.mInputText.off("textchange",this.onTextchange,this),this.mInputText.off("onclick",this.onTextClick,this),this.mInputText.off("ondblclick",this.onTextDbclick,this),this.mInputText.off("focus",this.onTextFocus,this),this.mInputText.off("blur",this.onTextBlur,this),this.mScene.input.off("gameobjectdown",this.sceneDown,this);var t=this.mInputText.text;t.length>0&&this.mTextField.setText(t),this.mInputText.setText(""),this.mInputText.setBlur(),this.mInputText.visible=!1,this.mInputTimeID&&this.mScene.clearTimeout(this.mInputTimeID),1===this.textConfig.posType&&(this.mTextField.visible=!0)}},InputTextField.prototype.setInputFocus=function(){var t=document.all.namedItem(this.textConfig.id);t&&t.focus()},InputTextField.prototype.sceneDown=function(t,i){i&&i===this.mTextField||this.onTextBlur()},InputTextField.prototype.onTextchange=function(){if("number"===this.textConfig.type){var t=Number(this.mInputText.text);isNaN(t)&&(t=0),this.textConfig.minNum&&this.textConfig.maxNum&&(t<this.textConfig.minNum?t=this.textConfig.minNum:t>this.textConfig.maxNum&&(t=this.textConfig.maxNum)),this.mInputText.text=t+""}this.emit(c.textchange)},InputTextField.prototype.onTextClick=function(){this.emit(c.textclick)},InputTextField.prototype.onTextDbclick=function(){this.emit(c.textdblclick)},InputTextField.prototype.onTextFocus=function(){this.onFocus(),this.emit(c.textfocus)},InputTextField.prototype.onTextBlur=function(){this.onBlur(),this.hideText(),this.emit(c.textblur)},InputTextField}(Phaser.Events.EventEmitter)},function(t,i,o){"use strict";o.r(i),o.d(i,"DecorateControlMediator",(function(){return d}));var r,a=o(209),h=o(110),l=o(2),c=o(119),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function DecorateControlMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.world=r,r&&(r.emitter.on(c.a.SELECTED_DECORATE_ELEMENT,a.onSelectedDecorateHandler,a),r.emitter.on(c.a.CANCEL_DECORATE_ELEMENT,a.onCancelDecorateHandler,a)),a}return p(DecorateControlMediator,t),DecorateControlMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.DecorateControlPanel(this.scene,this.world)),this.addActionListener(),this.mView.show(),this.layerManager.addToUILayer(this.mView))},DecorateControlMediator.prototype.destroy=function(){this.world&&(this.world.emitter.on(c.a.SELECTED_DECORATE_ELEMENT,this.onSelectedDecorateHandler,this),this.world.emitter.on(c.a.CANCEL_DECORATE_ELEMENT,this.onCancelDecorateHandler,this)),t.prototype.destroy.call(this)},DecorateControlMediator.prototype.isSceneUI=function(){return!0},DecorateControlMediator.prototype.onSelectedDecorateHandler=function(){this.mView&&this.mView.parentContainer&&this.mView.parentContainer.remove(this.mView)},DecorateControlMediator.prototype.onCancelDecorateHandler=function(){this.mView&&this.layerManager.addToUILayer(this.mView)},DecorateControlMediator.prototype.addActionListener=function(){this.mView&&(this.mView.on("exit",this.onExitHandler,this),this.mView.on("recycleAll",this.onRecycleAllHandler,this),this.mView.on("redo",this.onRedoHandler,this),this.mView.on("showFurni",this.onShowFurniHandler,this),this.mView.on("save",this.onSaveHandler,this),this.mView.on("getDoor",this.onGetDoorHandler,this))},DecorateControlMediator.prototype.onExitHandler=function(){if(this.connection){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);t.content.needSaveEditScene=!1,this.world.connection.send(t)}},DecorateControlMediator.prototype.onRecycleAllHandler=function(){if(this.connection){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_ALL);this.world.connection.send(t)}},DecorateControlMediator.prototype.onRedoHandler=function(){if(this.connection){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_LAST_SPRITE);this.connection.send(t)}},DecorateControlMediator.prototype.onShowFurniHandler=function(){var t=this.world.uiManager;t&&t.showMed("FurniBag")},DecorateControlMediator.prototype.onSaveHandler=function(){if(this.connection){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);t.content.needSaveEditScene=!0,this.connection.send(t)}},DecorateControlMediator.prototype.onGetDoorHandler=function(){if(this.connection){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_SPAWN_POINT);this.connection.send(t)}},Object.defineProperty(DecorateControlMediator.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),DecorateControlMediator.NAME="DecorateControlMediator",DecorateControlMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"DecorateControlPanel",(function(){return l}));var r,a=o(112),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function DecorateControlPanel(i,o){var r=t.call(this,i,o)||this;return r.key="decorateControl",r}return h(DecorateControlPanel,t),DecorateControlPanel.prototype.addListen=function(){this.mInitialized&&(this.mExitBtn.on("pointerup",this.onExitHandler,this),this.mRecycleAllBtn.on("pointerup",this.onRecycleAllHandler,this),this.mRedoBtn.on("pointerup",this.onRedoHandler,this),this.mFurniBtn.on("pointerup",this.onShowFurniHandler,this),this.mSaveBtn.on("pointerup",this.onSaveHandler,this),this.mDoorBtn.on("pointerup",this.onGetDoorHandler,this))},DecorateControlPanel.prototype.removeListen=function(){this.mInitialized&&(this.mExitBtn.off("pointerup",this.onExitHandler,this),this.mRecycleAllBtn.off("pointerup",this.onRecycleAllHandler,this),this.mRedoBtn.off("pointerup",this.onRedoHandler,this),this.mFurniBtn.off("pointerup",this.onShowFurniHandler,this),this.mSaveBtn.off("pointerup",this.onSaveHandler,this),this.mDoorBtn.off("pointerup",this.onGetDoorHandler,this))},DecorateControlPanel.prototype.resize=function(i,o){this.setSize(i,131*this.dpr),this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,this.width,this.height),t.prototype.resize.call(this,i,o)},DecorateControlPanel.prototype.preload=function(){this.addAtlas(this.key,"decorate_control/decorate_control.png","decorate_control/decorate_control.json"),t.prototype.preload.call(this)},DecorateControlPanel.prototype.init=function(){var i=this.scene.cameras.main.width,o=this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1),this.mTopBtns=[],this.mExitBtn=this.scene.make.image({key:this.key,frame:"exitBtn.png"},!1).setOrigin(0).setInteractive(),this.mRecycleAllBtn=this.scene.make.image({key:this.key,frame:"recycleAllBtn.png"},!1).setOrigin(0).setInteractive(),this.mRedoBtn=this.scene.make.image({key:this.key,frame:"redoBtn.png"},!1).setOrigin(0).setInteractive(),this.mFurniBtn=this.scene.make.image({key:this.key,frame:"furniBtn.png"},!1).setOrigin(0).setInteractive(),this.mSaveBtn=this.scene.make.image({key:this.key,frame:"saveBtn.png"},!1).setOrigin(0).setInteractive(),this.mDoorBtn=this.scene.make.image({x:10*this.dpr,y:83*this.dpr,key:this.key,frame:"doorBtn.png"},!1).setOrigin(0).setInteractive(),this.mStairBtn=this.scene.make.image({x:64*this.dpr,y:83*this.dpr,key:this.key,frame:"stairBtn.png"},!1).setOrigin(0),this.mTopBtns=[this.mExitBtn,this.mRecycleAllBtn,this.mRedoBtn,this.mFurniBtn,this.mSaveBtn],this.add(this.mBackground),this.add(this.mTopBtns),this.add([this.mDoorBtn,this.mStairBtn]);var r=this.mWorld.uiScale,a=i-20*this.dpr*r;this.mTopBtns.map((function(t){return a-=t.width*r}));for(var h=a/(this.mTopBtns.length-1)/r,l=0;l<this.mTopBtns.length;l++)this.mTopBtns[l].x=l>0?h+this.mTopBtns[l-1].width+this.mTopBtns[l-1].x:10*this.dpr,this.mTopBtns[l].y=11*this.dpr;this.resize(i,o),t.prototype.init.call(this)},DecorateControlPanel.prototype.onExitHandler=function(){this.emit("exit")},DecorateControlPanel.prototype.onRecycleAllHandler=function(){this.emit("recycleAll")},DecorateControlPanel.prototype.onRedoHandler=function(){this.emit("redo")},DecorateControlPanel.prototype.onShowFurniHandler=function(){this.emit("showFurni")},DecorateControlPanel.prototype.onSaveHandler=function(){this.emit("save")},DecorateControlPanel.prototype.onGetDoorHandler=function(){this.emit("getDoor")},DecorateControlPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ActivityMediator",(function(){return c}));var r,a=o(211),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ActivityMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.mUIType=h.UIType.Scene,a.world=r,a}return l(ActivityMediator,t),ActivityMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.ActivityPanel(this.scene,this.world),this.mView.on("showPanel",this.onShowPanelHandler,this)),this.mView.show(),this.layerManager.addToUILayer(this.mView))},ActivityMediator.prototype.isSceneUI=function(){return!0},ActivityMediator.prototype.onShowPanelHandler=function(t,i){if(t&&this.world){var o=this.world.uiManager;i?o.showMed(t,i):o.showMed(t)}},ActivityMediator.NAME="ActivityMediator",ActivityMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ActivityPanel",(function(){return c}));var r,a=o(112),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ActivityPanel(i,o){var r=t.call(this,i,o)||this;return r.key="activity",r}return l(ActivityPanel,t),ActivityPanel.prototype.resize=function(t,i){var o=this.scaleWidth;this.scaleHeight;this.content.x=o-20*this.dpr,this.content.y=.5*this.content.height+90*this.dpr,this.setSize(t,i),this.mGameScroll.refreshMask()},ActivityPanel.prototype.show=function(i){this.mInitialized&&this.setInteractive(),t.prototype.show.call(this,i),this.checkUpdateActive()},ActivityPanel.prototype.updateUIState=function(t){this.mInitialized&&("activity.taskbtn"===t.name&&(this.mGameScroll.getItemAt(3).visible=t.visible,this.mGameScroll.Sort()))},ActivityPanel.prototype.preload=function(){this.addAtlas(this.key,"activity/activity.png","activity/activity.json"),t.prototype.preload.call(this)},ActivityPanel.prototype.init=function(){var i=this,o=60*this.dpr,r=300*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(o,r);var a=this.scene.make.image({key:this.key,frame:"home_more"});this.content.add(a),a.y=.5*-r+.5*a.height,this.add(this.content),this.mGameScroll=new h.GameScroller(this.scene,{x:0,y:0,width:this.content.width,height:this.content.height-50*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){i.onPointerUpHandler(t)}}),this.content.add(this.mGameScroll);for(var l=0;l<4;l++){var c="icon_"+(l+1),u=this.scene.make.image({key:this.key,frame:c});u.name=l+1+"",this.mGameScroll.addItem(u)}this.mGameScroll.Sort(),this.resize(o,r),t.prototype.init.call(this)},ActivityPanel.prototype.onClickHandler=function(t){"4"===t?this.emit("showPanel","Task"):"3"===t&&this.emit("showPanel","PicFriend")},ActivityPanel.prototype.checkUpdateActive=function(){var t=this.mWorld.uiManager.getActiveUIData("Activity");if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.updateUIState(r)}},ActivityPanel.prototype.onPointerUpHandler=function(t){var i=t.name;this.onClickHandler(i)},ActivityPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaChatPanel",(function(){return y}));var r,a=o(112),h=o(113),l=o(165),c=o(213),u=o(115),p=o(114),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicaChatPanel(i,o){var r=t.call(this,i,o)||this;return r.key="pica_chat",r.chatCatchArr=[],r.chatMaxLen=100,r.MAX_HEIGHT=460*r.dpr,r.MIN_HEIGHT=100*r.dpr,r.scale=1,r.UIType=d.UIType.Scene,r}return m(PicaChatPanel,t),PicaChatPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.checkUpdateActive()):this.preload())},PicaChatPanel.prototype.resize=function(i,o){var r=this.scale,a=this.scene.cameras.main.width,h=this.scene.cameras.main.height;i=a,o=o||133*this.dpr,this.setSize(a,o);var l=this.scene.textures.getFrame(this.key,"title_bg"),c=l?a/this.scale/l.width:1;this.mTitleBg.scaleX=c,this.mTitleBg.x=a/this.scale/2,this.y=h-this.height,this.mBackground.clear(),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,a/this.scale,o/this.scale),this.mTextArea.childrenMap.child.setMinSize(i,(o-16*this.dpr)*r),this.mTextArea.layout(),this.mTextArea.setPosition(this.width/2+4*this.dpr,this.y+this.mTextArea.height/2+10*this.dpr*r),this.mTextArea.childrenMap.text.y=8*this.dpr,this.mTextArea.scrollToBottom(),this.mNavigateBtn.x=a/this.scale-.5*this.mNavigateBtn.width-5*this.dpr,t.prototype.resize.call(this,i,o)},PicaChatPanel.prototype.appendChat=function(t){this.chatCatchArr.push(t),this.chatCatchArr.length>this.chatMaxLen&&this.chatCatchArr.shift(),this.mTextArea&&(this.mTextArea.appendText(t),this.mTextArea.scrollToBottom()),this.mInputText&&this.mInputText.appendChat(t)},PicaChatPanel.prototype.hide=function(){this.mShow=!1,this.removeInteractive()},PicaChatPanel.prototype.addListen=function(){this.mInitialized&&(this.mChatBtn.setInteractive(),this.mEmojiBtn.setInteractive(),this.mScrollBtn.setInteractive(),this.mNavigateBtn.setInteractive(),this.mTextArea.childrenMap.child.setInteractive(),this.mScrollBtn.on("drag",this.onDragHandler,this),this.scene.input.setDraggable(this.mScrollBtn,!0),this.mNavigateBtn.on("pointerup",this.onShowNavigateHandler,this),this.mChatBtn.on("pointerup",this.onShowInputHanldler,this))},PicaChatPanel.prototype.removeListen=function(){this.mInitialized&&(this.mChatBtn.disableInteractive(),this.mEmojiBtn.disableInteractive(),this.mScrollBtn.disableInteractive(),this.mNavigateBtn.disableInteractive(),this.mTextArea.childrenMap.child.disableInteractive(),this.mScrollBtn.off("drag",this.onDragHandler,this),this.mNavigateBtn.off("pointerup",this.onShowNavigateHandler,this),this.mChatBtn.off("pointerup",this.onShowInputHanldler,this))},PicaChatPanel.prototype.updateUIState=function(t){this.mInitialized&&"picachat.navigatebtn"===t.name&&this.mNavigateBtn.visible!==t.visible&&(this.mNavigateBtn.visible=t.visible)},PicaChatPanel.prototype.destroy=function(){this.mBackground&&this.mBackground.disableInteractive(),t.prototype.destroy.call(this)},PicaChatPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_chat/pica_chat.png","pica_chat/pica_chat.json"),this.addAtlas(u.UIAtlasKey.commonKey,u.UIAtlasName.commonUrl+".png",u.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},PicaChatPanel.prototype.init=function(){var i=this.scene.cameras.main.width;this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1);var o=this.scale;this.setSize(i,135*this.dpr),this.mTileContainer=this.scene.make.container(void 0,!1),this.mScrollBtn=this.scene.make.image({x:21*this.dpr*o,key:this.key,frame:"scroll_btn"},!1).setScale(o),this.mTitleBg=this.scene.make.image({key:this.key,frame:"title_bg"},!1).setScale(o),this.mChatBtn=this.scene.make.image({x:96*this.dpr*o,key:this.key,frame:"chat_icon"},!1).setScale(o),this.mHornBtn=this.scene.make.image({x:159*this.dpr*o,key:this.key,frame:"horn_icon"},!1).setScale(o),this.mEmojiBtn=this.scene.make.image({x:218*this.dpr*o,key:this.key,frame:"emoji"},!1).setScale(o),this.mNavigateBtn=this.scene.make.image({x:281*this.dpr,key:this.key,frame:"more_btn"},!1).setScale(o);var r=20*this.dpr;this.mTitleBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mScrollBtn.x=.5*this.mScrollBtn.width+5*this.dpr,this.mScrollBtn.y=-this.mScrollBtn.height/2+this.mTitleBg.height,this.mChatBtn.x=this.mScrollBtn.x+.5*this.mScrollBtn.width+r+.5*this.mChatBtn.width,this.mChatBtn.y=-this.mChatBtn.height/2+this.mTitleBg.height,this.mChatBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mHornBtn.x=this.mChatBtn.x+.5*this.mChatBtn.width+r+.5*this.mHornBtn.width,this.mHornBtn.y=-this.mHornBtn.height/2+this.mTitleBg.height,this.mHornBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mEmojiBtn.x=this.mHornBtn.x+.5*this.mHornBtn.width+r+.5*this.mEmojiBtn.width,this.mEmojiBtn.y=-this.mEmojiBtn.height/2+this.mTitleBg.height,this.mEmojiBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mNavigateBtn.y=-this.mNavigateBtn.height/2+this.mTitleBg.height,this.mNavigateBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mOutputText=new d.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr/o+"px",fontFamily:h.a.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr*o,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:i-12*this.dpr*o}}),this.mOutputText.setResolution(this.dpr);var a=this.scene.make.graphics(void 0,!1);this.mTextArea=new d.TextArea(this.mScene,{x:i/2+4*this.dpr*o,y:160*this.dpr*o,textWidth:i-4*this.dpr*o,textHeight:this.MAX_HEIGHT,text:this.mOutputText}).layout(),this.mTileContainer.add([this.mTitleBg,this.mChatBtn,this.mHornBtn,this.mEmojiBtn,this.mScrollBtn,this.mNavigateBtn]),this.add([this.mBackground,this.mTileContainer,this.mTextArea,this.mOutputText,a]),this.mTextArea.setSliderEnable(!1),this.resize(this.width,133*this.dpr),t.prototype.init.call(this),this.removeInteractive()},PicaChatPanel.prototype.onDragHandler=function(t,i,o){var r=this.height+(t.prevPosition.y-t.position.y);r>this.MAX_HEIGHT||r<this.MIN_HEIGHT||this.resize(this.width,r)},PicaChatPanel.prototype.onShowNavigateHandler=function(){this.emit("showNavigate")},PicaChatPanel.prototype.onShowInputHanldler=function(){var t=this;if(!this.mInputText){var i=window.pktGlobal;if(i&&"Cordova"===i.envPlatform)if(this.scene.cache.json.has("quickchat"))setTimeout((function(){t.openAppInputPanel()}),20);else{var o="../../resources/ui/quickchat/"+p.a.language+".json";this.scene.load.json("quickchat",o),this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this),this.scene.load.start()}else this.mInputText=new l.InputPanel(this.scene,this.mWorld),this.mInputText.once("close",this.sendChat,this)}},PicaChatPanel.prototype.sendChat=function(t){this.mInputText=void 0,t&&this.emit("chat",t)},PicaChatPanel.prototype.openAppInputPanel=function(){this.scene.cache.json.has("quickchat")&&(this.mInputText=new c.PicChatInputPanel(this.scene,this.mWorld,this.key,this.chatCatchArr.concat()),this.mInputText.once("close",this.appCloseChat,this),this.mInputText.on("send",this.appSendChat,this),this.mInputText.setQuickChatData(this.scene.cache.json.get("quickchat")),this.parentContainer&&(this.parentContainer.visible=!1),this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE,this.openAppInputPanel,this))},PicaChatPanel.prototype.appSendChat=function(t){t&&this.emit("chat",t)},PicaChatPanel.prototype.appCloseChat=function(){this.mInputText.off("send",this.appSendChat,this),this.mInputText=void 0,this.parentContainer&&(this.parentContainer.visible=!0)},PicaChatPanel.prototype.checkUpdateActive=function(){var t=this.mWorld.uiManager.getActiveUIData("PicaChat");if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.updateUIState(r)}},PicaChatPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicChatInputPanel",(function(){return p}));var r,a=o(114),h=o(115),l=o(113),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicChatInputPanel(i,o,r,u){var p=t.call(this)||this;p.chatArr=[],p.maxChatLength=100,p.isOpenQuickPanel=!1,p.isSendChat=!1,p.isDispose=!1,p.key=r,p.world=o,p.dpr=window.devicePixelRatio,p.scene=i,p.chatArr=u;var d=i.cameras.main.width,m=i.cameras.main.height;p.mBackground=i.add.graphics(),p.mBackground.clear(),p.mBackground.fillStyle(0,.6),p.mBackground.fillRect(0,0,d,m),p.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,d,m),Phaser.Geom.Rectangle.Contains),p.bottomCon=i.add.container(0,0),p.bottomCon.setPosition(.5*d,.5*m);var y=new c.NineSlicePatch(i,0,0,d,47*p.dpr,p.key,"chat_Input_bg",{left:2*p.dpr,top:0*p.dpr,right:2*p.dpr,bottom:0*p.dpr});p.bottomCon.setSize(d,y.height),p.bottomCon.add(y),p.sendBtn=new c.Button(p.scene,p.key,"chat_quick_2"),p.sendBtn.x=.5*-d+.5*p.sendBtn.width+12*p.dpr,p.sendBtn.on(String(c.ClickEvent.Tap),p.onQuickSendHandler,p),p.bottomCon.add(p.sendBtn),p.cancelBtn=new c.NineSliceButton(p.scene,0,0,63*p.dpr,28*p.dpr,h.UIAtlasKey.commonKey,"red_btn_normal",a.a.t("common.cancel"),p.dpr,1,{left:14*p.dpr,top:0,right:14*p.dpr,bottom:0}),p.cancelBtn.setTextStyle({color:"#ffffff",fontSize:16*p.dpr,fontFamily:l.a.DEFULT_FONT}),p.cancelBtn.x=.5*d-.5*p.cancelBtn.width-12*p.dpr,p.cancelBtn.on(String(c.ClickEvent.Tap),p.onCancelHandler,p),p.bottomCon.add(p.cancelBtn);var g=Math.abs(p.sendBtn.x-p.cancelBtn.x)-.5*p.sendBtn.width-.5*p.cancelBtn.width-16*p.dpr,_=p.sendBtn.x+.5*p.sendBtn.width+8*p.dpr+.5*g,v=new c.NineSlicePatch(p.scene,_,0,g,36*p.dpr,p.key,"chat_Input",{left:12*p.dpr,top:0*p.dpr,right:12*p.dpr,bottom:0*p.dpr});return p.bottomCon.add(v),p.mInput=new c.InputText(p.scene,_-.5*g,0,g,40*p.dpr,{type:"text",placeholder:"",color:"#0",fontSize:20*p.dpr+"px"}),p.mInput.setOrigin(0,.5),p.bottomCon.add(p.mInput),p.contentCon=i.add.container(0,0),p.contentCon.setSize(d,200*p.dpr),p.mOutputText=new c.BBCodeText(i,.5*-d+10*p.dpr,0,"",{fontSize:14*p.dpr+"px",fontFamily:l.a.DEFULT_FONT,stroke:"#000000",strokeThickness:1*p.dpr,textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:d-12*p.dpr}}).setOrigin(0,.5),p.mOutputText.setResolution(p.dpr),p.gamescroll=new c.GameScroller(i,{x:0,y:0,width:d,height:p.contentCon.height,zoom:1,dpr:p.dpr,align:0,orientation:0,selfevent:!0}),p.contentCon.add(p.gamescroll),p.gamescroll.addItem(p.mOutputText),p.quickCon=p.scene.add.container(0,0),p.quickBg=p.scene.make.image({key:p.key,frame:"home_quick chat _bg"}),p.quickCon.add(p.quickBg),p.quickCon.x=.5*d,p.quickChatScroll=new c.GameScroller(i,{x:0,y:0,width:d,height:200*p.dpr,zoom:1,dpr:p.dpr,align:2,orientation:0,cellupCallBack:function(t){p.onQuickChatItemHandler(t)}}),p.quickChatScroll.removeListen(),p.quickCon.add(p.quickChatScroll),p.mInput.on("blur",p.onBlurHandler,p),p.mInput.on("focus",p.onFocusHandler,p),p.mInput.node.addEventListener("keypress",(function(t){13===(t.keyCode||t.which)&&(p.isSendChat=!0,p.onSentChat())})),window.addEventListener("native.keyboardshow",p.onKeyboardHandler.bind(p)),p.bottomCon.visible=!1,p.contentCon.visible=!1,p}return u(PicChatInputPanel,t),PicChatInputPanel.prototype.setKeywordHeight=function(t){var i=this.scene.cameras.main.height,o=this.scene.cameras.main.width,r=i-t-0;this.bottomCon.visible=!0,this.contentCon.visible=!0,this.bottomCon.y=r-.5*this.bottomCon.height,this.contentCon.height=this.bottomCon.y-.5*this.bottomCon.height-20*this.dpr,this.contentCon.y=this.bottomCon.y-.5*this.bottomCon.height-.5*this.contentCon.height-5*this.dpr,this.contentCon.x=.5*o,this.gamescroll.resetSize(o,this.contentCon.height),this.gamescroll.refreshMask();var a=200*this.dpr;this.quickCon.y=this.bottomCon.y-.5*this.bottomCon.height,this.quickBg.y=.5*-a,this.quickBg.displayWidth=o+10*this.dpr,this.quickBg.displayHeight=a,this.quickChatScroll.y=this.quickBg.y,this.quickChatScroll.resetSize(o,a),this.keyboardHeight=t,this.setQuickChatItems()},PicChatInputPanel.prototype.setQuickChatData=function(t){t&&(this.quickChatAtt=t),this.quickChatAtt.unshift(void 0),this.mInput.setFocus(),this.setKeywordHeight(0),this.onQuickSendHandler(),console.log(t)},PicChatInputPanel.prototype.appendChat=function(t){this.chatArr.push(t),this.chatArr.length>this.maxChatLength&&this.chatArr.shift();for(var i="",o=0,r=this.chatArr;o<r.length;o++){i+=r[o]}this.mOutputText.text=i,this.gamescroll.Sort()},PicChatInputPanel.prototype.onKeyboardHandler=function(t){console.log(t.keyboardHeight),this.keyboardHeight>0&&t.keyboardHeight===this.keyboardHeight||window.removeEventListener("native.keyboardshow",this.onKeyboardHandler.bind(this))},PicChatInputPanel.prototype.setQuickChatItems=function(){this.quickChatScroll.clearItems(!0);this.scene.cameras.main.height;for(var t=this.scene.cameras.main.width,i=0;i<this.quickChatAtt.length;i++){var o=this.quickChatAtt[i];if(o){var r=new d(this.scene,t,30*this.dpr,this.key,this.dpr,0===i);this.quickChatScroll.addItem(r),r.setText(o)}}this.quickChatScroll.Sort(),this.quickCon.visible=!1},PicChatInputPanel.prototype.setFirstQuickItem=function(){if(this.quickChatScroll.getItemList().length===this.quickChatAtt.length){var t=this.quickChatScroll.getItemList();t&&t.length>0&&t[0].setText(this.quickChatAtt[0])}else{var i=this.scene.cameras.main.width,o=new d(this.scene,i,30*this.dpr,this.key,this.dpr,!0);this.quickChatScroll.addItemAt(o,0),this.quickChatScroll.Sort(),o.setText(this.quickChatAtt[0])}},PicChatInputPanel.prototype.onBlurHandler=function(){this.isOpenQuickPanel||this.isSendChat||this.onCancelHandler(),this.isSendChat=!1},PicChatInputPanel.prototype.onFocusHandler=function(){this.isOpenQuickPanel&&(this.quickCon.visible=!1,this.quickChatScroll.removeListen(),this.isOpenQuickPanel=!1)},PicChatInputPanel.prototype.onQuickSendHandler=function(){this.isOpenQuickPanel=!0,this.quickCon.visible=!0,this.quickChatScroll.addListen(),this.mInput.setBlur()},PicChatInputPanel.prototype.onSentChat=function(){var t=this.mInput.text;""!==t&&(this.quickChatAtt[0]=t,this.setFirstQuickItem()),this.mInput.text="",this.mInput.setFocus(),this.sendChat(t)},PicChatInputPanel.prototype.sendChat=function(t){this.emit("send",t)},PicChatInputPanel.prototype.onQuickChatItemHandler=function(t){this.sendChat(t.dataChat),this.mInput.setFocus()},PicChatInputPanel.prototype.onCancelHandler=function(){this.isDispose||(this.isDispose=!0,this.mInput.setBlur(),this.mBackground.destroy(),this.mInput.destroy(),this.bottomCon.destroy(),this.contentCon.destroy(),this.quickCon.destroy(),this.gamescroll.clearItems(!0),this.scene=void 0,this.world=void 0,this.gamescroll=void 0,this.mOutputText=void 0,this.quickChatScroll=void 0,this.emit("close"),this.destroy())},PicChatInputPanel}(Phaser.Events.EventEmitter),d=function(t){function QuickChatItem(i,o,r,a,h,c){void 0===c&&(c=!1);var u,p=t.call(this,i)||this;(p.dataChat="",p.key=a,p.setSize(o,r),p.text=p.scene.make.text({x:0,y:0,text:"",style:{fontSize:13*h,fontFamily:l.a.DEFULT_FONT,color:"#6F6F6F"}}).setOrigin(0,.5),p.text.x=.5*-o+20*h,p.add(p.text),c)?((u=p.scene.make.image({key:a,frame:"home_divider"})).y=.5*r,p.add(u)):((u=p.scene.make.graphics(void 0)).clear(),u.fillStyle(7303023,.3),u.fillRect(.5*-o+20*h,-1,o,2),u.setPosition(0,.5*r),p.add(u));return p}return u(QuickChatItem,t),QuickChatItem.prototype.setText=function(t){this.text.text=t,this.dataChat=t},QuickChatItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaChat",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicaChat(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicaChat,t),PicaChat.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT,this.handleCharacterChat))},PicaChat.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicaChat.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicaChat.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicaChat.prototype.sendMessage=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_GATEWAY_REQ_VIRTUAL_WORLD_CHAT),o=i.content;o.chatChannel=0,o.chatContext=t,this.connection.send(i)},PicaChat.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},PicaChat.prototype.handleCharacterChat=function(t){this.mEvent.emit("chat",t.content)},Object.defineProperty(PicaChat.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicaChat}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineCarMediator",(function(){return p}));var r,a=o(216),h=o(217),l=o(2),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function MineCarMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.world=r,a}return u(MineCarMediator,t),MineCarMediator.prototype.show=function(i){this.mShow||(t.prototype.show.call(this,i),this.mView||(this.mView=new a.MineCarPanel(this.scene,this.world),this.mView.on("querypackage",this.onQueryPackage,this),this.mView.on("querycategory",this.onQueryCategoryHandler,this)),this.mMineCar||(this.mMineCar=new h.MineCar(this.world),this.mMineCar.register(),this.mMineCar.on("packageCategory",this.onPackageCategoryHandler,this)),this.mView.show(i),this.mView.on("close",this.onCloseHandler,this),this.mView.on("discard",this.onDiscardHandler,this),this.layerManager.addToUILayer(this.mView)),this.addLisenter()},MineCarMediator.prototype.destroy=function(){this.mShow=!1,this.mMineCar&&(this.mMineCar.off("packageCategory",this.onPackageCategoryHandler,this),this.mMineCar.unregister(),this.mMineCar.destroy(),this.mMineCar=null),t.prototype.destroy.call(this),this.removeLisenter()},Object.defineProperty(MineCarMediator.prototype,"playerData",{get:function(){var t=this.bag;return t?t.playerData:null},enumerable:!1,configurable:!0}),Object.defineProperty(MineCarMediator.prototype,"bag",{get:function(){var t=this.world.user;if(t&&t.bag)return t.bag},enumerable:!1,configurable:!0}),MineCarMediator.prototype.addLisenter=function(){if(this.bag){var t=this.bag;t&&(t.on("syncfinish",this.onSyncFinishHandler,this),t.on("update",this.onUpdateHandler,this))}},MineCarMediator.prototype.removeLisenter=function(){if(this.bag){var t=this.bag;t&&(t.off("syncfinish",this.onSyncFinishHandler,this),t.off("update",this.onUpdateHandler,this))}},MineCarMediator.prototype.onSyncFinishHandler=function(){this.mView&&this.mView.queryRefreshPackage()},MineCarMediator.prototype.onUpdateHandler=function(){this.mView&&this.mView.queryRefreshPackage()},MineCarMediator.prototype.onPackageCategoryHandler=function(t){this.mView&&this.mView.setCategoriesData(t)},MineCarMediator.prototype.onQueryCategoryHandler=function(){this.mMineCar.getCategories(l.op_pkt_def.PKT_PackageType.MinePackage)},MineCarMediator.prototype.onQueryPackage=function(t,i){if(this.playerData){var o=this.playerData.mineBag,r=this.playerData.getItemsByCategory(t,i);this.mView.setProp(r,o.limit)}},MineCarMediator.prototype.onDiscardHandler=function(t){this.mMineCar&&this.mMineCar.discard(t)},MineCarMediator.prototype.onCloseHandler=function(){this.mView&&(this.mView.hide(),this.mView=void 0),this.mShow=!1},MineCarMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineCarPanel",(function(){return _}));var r,a,h=o(113),l=o(116),c=o(112),u=o(2),p=o(111),d=o(135),m=o(114),y=o(109),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function MineCarPanel(i,o){var r=t.call(this,i,o)||this;return r.key="mine_car",r.mFilterItem=[],r.disInteractive(),r}return g(MineCarPanel,t),MineCarPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,r,a),this.mBg.x=r/2,this.mBg.y=this.mBg.displayHeight/2+107*this.dpr,this.carIcon.x=this.mBg.x/2-4*this.dpr,this.carIcon.y=this.mBg.y-(this.mBg.displayHeight-this.carIcon.displayHeight)/2+4*this.dpr,this.mCloseBtn.x=this.mBg.x+this.mBg.displayWidth/2,this.mCloseBtn.y=this.mBg.y-(this.mBg.displayHeight-this.mCloseBtn.displayHeight)/2+10*this.dpr,this.mCounter.x=this.mBg.x/2,this.mCounter.y=this.mBg.y+(this.mBg.displayHeight-this.mDiscardBtn.displayHeight)/2-16*this.dpr,this.mCounter.setResolution(this.dpr),this.mTips.x=this.mBg.x+20*this.dpr,this.mTips.y=this.mBg.y-this.mBg.displayHeight/2-15*this.dpr,this.mDiscardBtn.x=this.mBg.x+this.mBg.displayWidth/2-this.mDiscardBtn.displayWidth/2-9*this.dpr,this.mDiscardBtn.y=this.mBg.y+this.mBg.displayHeight/2-this.mDiscardBtn.displayHeight/2-9*this.dpr,this.categoriesBg.x=this.mBg.x,this.categoriesBg.y=this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+38*this.dpr,this.mPropGrid.refreshPos(this.mBg.x+2*this.dpr,this.mBg.y+6*this.dpr),this.mCategoryTable.refreshPos(this.mBg.x,this.mBg.y-this.mBg.displayHeight/2+this.categoriesBg.displayHeight/2+44*this.dpr),this.mPropGrid.resetMask(),this.mCategoryTable.resetMask()},MineCarPanel.prototype.show=function(i){t.prototype.show.call(this,i)},MineCarPanel.prototype.setCategories=function(t){this.mPreSelectedCategorie=void 0,this.mPreSelectedCategorieData=void 0,this.mCategoryTable.setItems(t)},MineCarPanel.prototype.setCategoriesData=function(t){this.mDiscardBtn.changeState(a.Discard),this.setCategories(t)},MineCarPanel.prototype.addListen=function(){this.mInitialized&&(this.removeListen(),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mDiscardBtn.on("Tap",this.enterDiscardMode,this))},MineCarPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mDiscardBtn.off("Tap",this.enterDiscardMode,this))},MineCarPanel.prototype.setProp=function(t,i){var o=t||[];this.mLimit=i||0,this.mFilterItem.length=0;for(var r=0,a=o;r<a.length;r++){var h=a[r];this.mFilterItem.push({item:h})}for(var l=this.mLimit-this.mFilterItem.length,c=0;c<l;c++)this.mFilterItem.push({item:null});this.mPropGrid.setItems(this.mFilterItem),this.mCounter.setText(o.length+"/"+this.mLimit)},MineCarPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.mCategoryTable&&this.mCategoryTable.destroy(),t.prototype.destroy.call(this)},MineCarPanel.prototype.queryRefreshPackage=function(){this.mPreSelectedCategorieData&&this.emit("querypackage",u.op_pkt_def.PKT_PackageType.MinePackage,this.mPreSelectedCategorieData.key)},MineCarPanel.prototype.preload=function(){this.addAtlas(this.key,"mine_car/mine_car.png","mine_car/mine_car.json"),t.prototype.preload.call(this)},MineCarPanel.prototype.init=function(){var i=this,o=this.scaleWidth,r=this.scaleHeight;this.setSize(o,r),this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,o,r),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.mBg=this.scene.make.image({key:this.key,frame:"bg.png"}),this.mBg.x=o/2,this.mBg.y=r/2,this.carIcon=this.scene.make.image({key:this.key,frame:"car_icon.png"},!1),this.carIcon.x=-(this.mBg.width-this.carIcon.width)/2+28*this.dpr,this.carIcon.y=-(this.mBg.height-this.carIcon.height/2)/2+10*this.dpr,this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1),this.mCloseBtn.setInteractive(),this.mCloseBtn.x=this.mBg.width/2,this.mCloseBtn.y=-(this.mBg.height-this.mCloseBtn.height)/2+10*this.dpr,this.mCloseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mCounter=this.scene.make.text({text:"25/50",style:{fontFamily:h.a.DEFULT_FONT,color:"#FFFFFF",fontSize:12*this.dpr}},!1),this.mCounter.x=-this.displayWidth/2+17*this.dpr,this.mCounter.y=this.displayHeight/2-18*this.dpr-this.mCounter.height,this.mCounter.setFontStyle("bold"),this.mTips=new b(this.scene,this.key,this.dpr),this.mTips.x=40*this.dpr,this.mTips.y=-(this.mBg.height+this.mTips.height)/2+15*this.dpr,this.mDiscardBtn=new P(this.scene,this.key,"yellow_btn.png",void 0,"丢弃"),this.mDiscardBtn.x=(this.mBg.width-this.mDiscardBtn.displayWidth)/2-17*this.dpr,this.mDiscardBtn.y=(this.mBg.height-this.mDiscardBtn.displayHeight)/2-10*this.dpr,this.mDiscardBtn.setTextStyle({color:"##996600",fontFamily:h.a.DEFULT_FONT,fontSize:10*this.dpr}),this.mDiscardBtn.changeState(a.Discard),this.categoriesBg=this.scene.make.image({key:this.key,frame:"nav_bg.png"}),this.categoriesBg.y=-(this.displayHeight-this.categoriesBg.displayHeight)/2+36*this.dpr;var l=this.scene.textures.getFrame(this.key,"item_border.png"),c=l.width+4*this.dpr,u=l.height+4*this.dpr,p=236*this.dpr,d={x:-7*this.dpr,y:-16*this.dpr,table:{width:p,height:295*this.dpr,columns:4,cellsCount:25,cellWidth:c,cellHeight:u,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new v(r,i.key,i.dpr)),o.setData({item:a}),o.setProp(a),o}};this.mPropGrid=new y.GameGridTable(this.scene,d),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){i.onSelectItemHandler(t)}));var m=this.scene.textures.getFrame(this.key,"nav_btn_normal.png"),g={x:-9*this.dpr,y:-155*this.dpr,table:{width:p,height:this.categoriesBg.displayHeight,cellWidth:m.width+4*this.dpr,cellHeight:m.height,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale},scrollMode:1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&((o=new w(r,i.key,"nav_btn_normal.png","nav_btn_down.png","1")).setTextStyle({color:"#566ddb",fontFamily:h.a.DEFULT_FONT,fontSize:10*i.dpr}),o.setFontStyle("bold")),o.setText(a.value),o.setData("data",a),i.mPreSelectedCategorieData===a?(o.changeDown(),i.mPreSelectedCategorie=o):o.changeNormal(),i.mPreSelectedCategorie||i.onClickCategoryHandler(o),o}};this.mCategoryTable=new y.GameGridTable(this.scene,g),this.mCategoryTable.layout(),this.mCategoryTable.on("cellTap",(function(t){i.onClickCategoryHandler(t)})),this.add([this.mBackGround,this.mBg,this.carIcon,this.mCounter,this.categoriesBg,this.mPropGrid,this.mCategoryTable,this.mCloseBtn,this.mDiscardBtn]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this),this.emit("querycategory")},MineCarPanel.prototype.onCloseHandler=function(){this.emit("close")},MineCarPanel.prototype.onSelectItemHandler=function(t){if(this.mDiscardBtn&&this.mDiscardBtn.buttonState!==a.Discard)return t.switchSelect(),void this.checkMode();t&&t.item.item?(this.mTips.parentContainer||this.add(this.mTips),this.mTips.setItem(t.item.item)):this.remove(this.mTips)},MineCarPanel.prototype.onClickCategoryHandler=function(t){var i=t.getData("data");i&&(this.emit("querypackage",u.op_pkt_def.PKT_PackageType.MinePackage,i.key),this.mPreSelectedCategorie&&this.mPreSelectedCategorie.changeNormal(),t.changeDown(),this.mPreSelectedCategorie=t,this.mPreSelectedCategorieData=i)},MineCarPanel.prototype.checkMode=function(){if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var t=0,i=this.mFilterItem;t<i.length;t++){if(i[t].selected)return void this.mDiscardBtn.changeState(a.Sutmit)}this.mDiscardBtn.changeState(a.Cancel)}},MineCarPanel.prototype.onDiscardSelectedItem=function(){var t=this;if(this.mFilterItem&&!(this.mFilterItem.length<1)){for(var i=[],o=[],r=0,a=this.mFilterItem;r<a.length;r++){var h=a[r];h.item&&h.selected&&(i.push(h.item),o.push(h.item.name+"*"+h.item.count))}new d.AlertView(this.scene,this.mWorld).show({text:m.a.t("minecar.confirmation",{name:""+o.join("、")}),title:m.a.t("minecar.discard"),oy:302*this.dpr*this.mWorld.uiScale,callback:function(){t.emit("discard",i)}})}},MineCarPanel.prototype.enterDiscardMode=function(){if(this.mFilterItem){var t=this.mDiscardBtn.buttonState,i=!1;t===a.Discard?(this.mDiscardBtn.changeState(a.Cancel),i=!0):(t===a.Sutmit&&this.onDiscardSelectedItem(),this.mDiscardBtn.changeState(a.Discard)),this.mFilterItem.length>0&&this.mFilterItem[0].selectVisible!==i&&(this.mFilterItem.map((function(t){t.selectVisible=i,t.selected=!1})),this.mPropGrid.setItems(this.mFilterItem))}},MineCarPanel}(c.BasePanel),v=function(t){function PackageItem(i,o,r){var a=t.call(this,i)||this,c=a.scene.make.image({key:o,frame:"item_border.png"},!1).setOrigin(0);return a.setSize(c.width,c.height),a.mItemImage=new l.DynamicImage(a.scene,0,0),a.mItemImage.setOrigin(0),a.mItemImage.setScale(r),a.mCounter=a.scene.make.text({x:c.displayWidth-2*r,y:c.displayHeight-1*r,style:{fontFamily:h.a.DEFULT_FONT,fontSize:9*r,color:"#566DDB"}}).setOrigin(1),a.mCounter.setFontStyle("bold"),a.mSelectedIcon=a.scene.make.image({key:o,frame:"icon_normal.png"},!1),a.mSelectedIcon.x=c.width-2*r-a.mSelectedIcon.width/2,a.mSelectedIcon.y=2*r+a.mSelectedIcon.height/2,a.add(c),a.add([a.mItemImage,a.mCounter,a.mSelectedIcon]),a}return g(PackageItem,t),PackageItem.prototype.setProp=function(t){this.itemData=t;var i=t.item;if(!t||!i)return this.mItemImage.visible=!1,this.mCounter.visible=!1,void(this.mSelectedIcon.visible=!1);this.itemData&&(this.mItemImage.load(p.i.getOsdRes(i.display.texturePath),this,this.onLoadCompleteHandler),this.mItemImage.visible=!0,i.count>1?(this.mCounter.setText(i.count.toString()),this.mCounter.visible=!0):this.mCounter.visible=!1,this.mSelectedIcon.visible=!!this.itemData.selectVisible,this.setSelected())},PackageItem.prototype.switchSelect=function(){this.itemData.item&&(this.itemData.selected=!this.itemData.selected,this.setSelected())},Object.defineProperty(PackageItem.prototype,"item",{get:function(){return this.itemData},enumerable:!1,configurable:!0}),PackageItem.prototype.onLoadCompleteHandler=function(){this.mItemImage&&(this.mItemImage.x=this.width-this.mItemImage.displayWidth>>1,this.mItemImage.y=this.height-this.mItemImage.displayHeight>>1)},PackageItem.prototype.setSelected=function(){this.itemData.selected?this.mSelectedIcon.setFrame("icon_selected.png"):this.mSelectedIcon.setFrame("icon_normal.png")},PackageItem}(Phaser.GameObjects.Container),b=function(t){function Tips(i,o,r){var a=t.call(this,i)||this;a.mDpr=r;var l=a.scene.make.image({key:o,frame:"tips_bg.png"},!1);return a.mName=a.scene.make.text({x:-l.width/2+12*r,y:-l.height/2+5*r,style:{fontFamily:h.a.DEFULT_FONT,fontSize:10*r,color:"#000000"}},!1),a.mDes=a.scene.make.text({x:a.mName.x,style:{fontFamily:h.a.DEFULT_FONT,fontSize:10*r,color:"#000000"}},!1).setOrigin(0,1),a.add([l,a.mName,a.mDes]),a.setSize(l.width,l.height),a}return g(Tips,t),Tips.prototype.setItem=function(t){if(t){var i=this.y,o=this.alpha;this.y=i+50*this.mDpr,this.alpha=0,this.scene.tweens.add({targets:this,props:{alpha:o,y:i},duration:200,ease:Phaser.Math.Easing.Elastic.Out}),this.mName.setText(t.shortName||t.name),this.mDes.setText(t.des)}},Tips}(Phaser.GameObjects.Container),P=function(t){function DiscardButton(i,o,r,a,h){return t.call(this,i,o,r,a,h)||this}return g(DiscardButton,t),DiscardButton.prototype.changeState=function(t){if(this.mState!==t)switch(this.mState=t,t){case a.Cancel:this.setText("取消"),this.setFrame("gray_btn.png");break;case a.Sutmit:this.setText("提交"),this.setFrame("yellow_btn.png");break;default:this.setText("丢弃"),this.setFrame("yellow_btn.png")}},Object.defineProperty(DiscardButton.prototype,"buttonState",{get:function(){return this.mState},enumerable:!1,configurable:!0}),DiscardButton}(y.Button);!function(t){t[t.Discard=0]="Discard",t[t.Cancel=1]="Cancel",t[t.Sutmit=2]="Sutmit"}(a||(a={}));var w=function(t){function CategorieButton(i,o,r,a,h){var l=t.call(this,i,o,r,a,h)||this;return l.disInteractive(),l.removeListen(),l.mBackground.setOrigin(0,0),l.mText&&l.mText.setPosition(l.mBackground.width/2,l.mBackground.height/2),l}return g(CategorieButton,t),CategorieButton}(y.TabButton)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineCar",(function(){return u}));var r,a=o(110),h=o(2),l=o(114),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function MineCar(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return c(MineCar,t),MineCar.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_PACKAGE_CATEGORIES,this.onPackageCategoriesHandler))},MineCar.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},MineCar.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},MineCar.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},MineCar.prototype.discard=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MINING_MODE_DELETE_MINEPACKAGE_ITEM);i.content.items=t,this.connection.send(i)},MineCar.prototype.getCategories=function(t){if(this.subcategory)this.mEvent.emit("packageCategory",this.subcategory);else{var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_PACKAGE_CATEGORIES);i.content.category=t,this.connection.send(i)}},MineCar.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},MineCar.prototype.onPackageCategoriesHandler=function(t){var i=t.content;if(i.category===h.op_pkt_def.PKT_PackageType.MinePackage){var o=new h.op_def.StrPair;o.key="alltype",o.value=l.a.t("common.all"),i.subcategory.unshift(o),this.subcategory=i.subcategory,this.mEvent.emit("packageCategory",this.subcategory)}},Object.defineProperty(MineCar.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),MineCar}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"ReAwardTipsMediator",(function(){return u}));var r,a=o(219),h=o(220),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function ReAwardTipsMediator(i,o){var r=t.call(this)||this;return r.scene=i,r.world=o,r.mReAwardTips=new a.ReAwardTips(o),r.mReAwardTips.register(),r.mReAwardTips.on("showAward",r.onShowAwardHandler,r),r}return c(ReAwardTipsMediator,t),ReAwardTipsMediator.prototype.show=function(i){this.mView?this.mView.appendAward(i):(this.mView=new h.ReAwardTipsPanel(this.scene,this.world),this.mView.appendAward(i),t.prototype.show.call(this),this.world.uiManager.getUILayerManager().addToDialogLayer(this.mView))},ReAwardTipsMediator.prototype.destroy=function(){this.mReAwardTips&&this.mReAwardTips.destroy(),t.prototype.destroy.call(this)},ReAwardTipsMediator.prototype.onShowAwardHandler=function(t){this.show(t)},ReAwardTipsMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ReAwardTips",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ReAwardTips(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(ReAwardTips,t),ReAwardTips.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},ReAwardTips.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},ReAwardTips.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_REWARD_TIPS,this.onReAwardTipsHandler))},ReAwardTips.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},ReAwardTips.prototype.destroy=function(){this.unregister()},Object.defineProperty(ReAwardTips.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),ReAwardTips.prototype.onReAwardTipsHandler=function(t){this.mEvent.emit("showAward",t.content)},ReAwardTips}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"ReAwardTipsPanel",(function(){return p}));var r,a=o(112),h=o(116),l=o(113),c=o(111),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function ReAwardTipsPanel(i,o){var r=t.call(this,i,o)||this;return r.key="reaward_tips",r.mTips=[],r.showingList=[],r}return u(ReAwardTipsPanel,t),ReAwardTipsPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&0===this.showingList.length&&this.showAward()},ReAwardTipsPanel.prototype.appendAward=function(t){this.mTips.push(t),this.show()},ReAwardTipsPanel.prototype.addAward=function(){},ReAwardTipsPanel.prototype.preload=function(){this.addImage(this.key,"reaward_tips/bg.png"),t.prototype.preload.call(this)},ReAwardTipsPanel.prototype.init=function(){this.setSize(20,20),t.prototype.init.call(this),this.y=250*this.dpr},ReAwardTipsPanel.prototype.showAward=function(){if(!(this.mTips.length<1||this.showingList.length>=3)){for(var t=0,i=this.showingList;t<i.length;t++){i[t].beUp()}var o=new d(this.scene,this.key,this.dpr,this.scale);o.once("destroy",this.onDestroyHanlder,this),o.once("show",this.onAwardItemShowHandler,this),o.setProp(this.mTips.pop()),this.add(o),this.showingList.push(o)}},ReAwardTipsPanel.prototype.onAwardItemShowHandler=function(){this.showAward()},ReAwardTipsPanel.prototype.onDestroyHanlder=function(t){var i=this.showingList.indexOf(t);i>-1&&this.showingList.splice(i,1),this.showAward()},ReAwardTipsPanel}(a.BasePanel),d=function(t){function AwardItem(i,o,r,a){var c=t.call(this,i)||this;return c.mBg=c.scene.make.image({key:o},!1),c.mScaleRatio=r*a,c.mImage=new h.DynamicImage(c.scene,0,0),c.mImage.setScale(r),c.mImage.setOrigin(.5,1),c.mImage.y=c.mBg.height*a/2,c.mLabel=c.scene.make.text({x:c.mBg.width*c.originX-6*c.mScaleRatio,style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*c.mScaleRatio,color:"#00FF00"}},!1).setOrigin(1,.5),c.addAt(c.mBg,0),c.add([c.mImage,c.mLabel]),c.setSize(c.mBg.width*a,c.mBg.height*a),c}return u(AwardItem,t),AwardItem.prototype.setProp=function(t){t&&(t.display&&t.display.texturePath&&this.mImage.load(c.i.getOsdRes(t.display.texturePath)),this.mLabel.setText(t.text),this.showTween())},AwardItem.prototype.showTween=function(){var t=this;this.scene.tweens.add({targets:this,props:{x:"+="+.3*this.width},ease:"Bounce.easeOut",onComplete:function(){t.emit("show"),t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)},duration:300})},AwardItem.prototype.closeTween=function(){var t=this;this.scene&&this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio,alpha:"0"},ease:"Linear",duration:300,onComplete:function(){t.destroy()}})},AwardItem.prototype.beUp=function(){var t=this;clearTimeout(this.closeDelay),this.scene.tweens.add({targets:this,props:{y:"-="+50*this.mScaleRatio},ease:"Linear",duration:300,onComplete:function(){t.closeDelay=setTimeout((function(){t.closeTween()}),1e3)}})},AwardItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"ComposeMediator",(function(){return p}));var r,a=o(222),h=o(2),l=o(223),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function ComposeMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a.compose||(a.compose=new l.Compose(a.world),a.compose.on("formulaDetial",a.onRetFormulaDetial,a),a.compose.on("showopen",a.onShowPanel,a),a.compose.register()),a}return u(ComposeMediator,t),ComposeMediator.prototype.show=function(){this.mView&&this.mView.isShow()||(this.mView||(this.mView=new a.ComposePanel(this.scene,this.world),this.mView.on("hide",this.onHideView,this),this.mView.on("reqformula",this.onReqFormulaDetial,this),this.mView.on("reqUseFormula",this.onReqUseFormula,this)),this.layerMgr.addToUILayer(this.mView),this.mView.show(this.mParam[0]),this.addLisenter())},ComposeMediator.prototype.destroy=function(){this.compose&&this.compose.destroy(),this.compose=void 0,t.prototype.destroy.call(this),this.removeLisenter()},ComposeMediator.prototype.addLisenter=function(){if(this.world.user&&this.world.user.bag){var t=this.world.user.bag;t&&(t.on("syncfinish",this.onSyncFinishHandler,this),t.on("update",this.onUpdateHandler,this))}},ComposeMediator.prototype.removeLisenter=function(){if(this.world.user&&this.world.user.bag){var t=this.world.user.bag;t&&(t.off("syncfinish",this.onSyncFinishHandler,this),t.off("update",this.onUpdateHandler,this))}},ComposeMediator.prototype.onSyncFinishHandler=function(){if(this.mView){var t=this.mParam[0].skills;this.updateSkills(t),this.mView.setComposeData(t)}},ComposeMediator.prototype.onUpdateHandler=function(){if(this.mView){var t=this.mParam[0].skills;this.updateSkills(t),this.mView.setComposeData(t)}},Object.defineProperty(ComposeMediator.prototype,"playerData",{get:function(){return this.bag?this.bag.playerData:null},enumerable:!1,configurable:!0}),ComposeMediator.prototype.onReqFormulaDetial=function(t){this.compose.onReqFormulaDetail(t)},ComposeMediator.prototype.onReqUseFormula=function(t){this.compose.onReqUseFormula(t)},ComposeMediator.prototype.onRetFormulaDetial=function(t){this.mView.setComposeDetialData(t)},ComposeMediator.prototype.onHideView=function(){t.prototype.destroy.call(this)},ComposeMediator.prototype.onShowPanel=function(t){var i=t.skills;this.updateSkills(i),this.setParam([t]),this.show()},ComposeMediator.prototype.updateSkills=function(t){if(this.playerData)for(var i=0,o=t;i<o.length;i++){var r=o[i];r.skill.qualified=this.isQualified(r)}},ComposeMediator.prototype.isQualified=function(t){if(this.playerData){var i=!0,o=t.materials;if(o)for(var r=0,a=o;r<a.length;r++){var l=a[r],c=this.playerData.getItemsCount(h.op_pkt_def.PKT_PackageType.PropPackage,l.id,l.subcategory);l.count=c,c<l.neededCount&&(i=!1)}return i}return!1},Object.defineProperty(ComposeMediator.prototype,"bag",{get:function(){var t=this.world.user;if(t&&t.bag)return t.bag},enumerable:!1,configurable:!0}),ComposeMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ComposePanel",(function(){return b}));var r,a=o(113),h=o(2),l=o(112),c=o(117),u=o(111),p=o(130),d=o(116),m=o(115),y=o(114),g=o(120),_=o(109),v=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),b=function(t){function ComposePanel(i,o){var r=t.call(this,i,o)||this;return r.key="compose",r.world=o,r}return v(ComposePanel,t),ComposePanel.prototype.resize=function(i,o){t.prototype.resize.call(this,i,o),this.content.x=.5*i,this.content.y=.5*o,this.mGrideTable.resetMask(),this.materialGameScroll.refreshMask(),this.setSize(i,o)},ComposePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},ComposePanel.prototype.addListen=function(){this.mInitialized&&(this.scene.input.on("pointerup",this.onInputPointUp,this),this.makeBtn.on(String(_.ClickEvent.Tap),this.onMakeHandler,this))},ComposePanel.prototype.removeListen=function(){this.mInitialized&&(this.scene.input.off("pointerup",this.onInputPointUp,this),this.makeBtn.off(String(_.ClickEvent.Tap),this.onMakeHandler,this))},ComposePanel.prototype.preload=function(){this.addAtlas(this.key,"compose/compose.png","compose/compose.json"),this.addAtlas(m.UIAtlasKey.commonKey,m.UIAtlasName.commonUrl+".png",m.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},ComposePanel.prototype.init=function(){var i=this,o=this.scaleWidth,r=this.scaleHeight;this.content=this.scene.make.container(void 0,!1),this.content.setSize(o,r),this.add(this.content);var h=this.scene.make.graphics(void 0,!1);h.clear(),h.fillGradientStyle(7365356,7365356,13408757,13408757),h.fillRect(.5*-o,.5*-r,o,r);var l=this.scene.make.image({key:this.key,frame:"main_bg"});l.y=.5*-r+.5*l.height,l.setInteractive(new Phaser.Geom.Rectangle(0,0,this.cameraWidth,this.cameraHeight),Phaser.Geom.Rectangle.Contains),l.displayWidth=o,this.content.add([h,l]);var u="bold "+17*this.dpr+"px Source Han Sans",d=this.scene.make.image({key:this.key,frame:"title_bg"});d.y=.5*-r+23*this.dpr;var g=this.scene.make.text({x:0,y:d.y,text:y.a.t("compose.title"),style:{font:u,bold:!0,color:"#8B5603",fontSize:15*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5);this.content.add([d,g]);var v=new _.Button(this.scene,m.UIAtlasKey.commonKey,"back_arrow","back_arrow");v.setPosition(.5*-o+20*this.dpr,.5*-r+30*this.dpr),v.on("Tap",this.onBackHandler,this),this.content.add(v),this.mDetailDisplay=new p.DetailDisplay(this.scene,!0),this.mDetailDisplay.y=-140*this.dpr,this.mDetailDisplay.setSize(126*this.dpr,126*this.dpr),this.content.add(this.mDetailDisplay),this.mDetailBubble=new P(this.scene,this.dpr),this.mDetailBubble.x=.5*-o,this.mDetailBubble.y=.5*r-360*this.dpr,this.content.add(this.mDetailBubble),this.makeBtn=new _.NineSliceButton(this.scene,Math.ceil(.5*o-60*this.dpr),Math.ceil(.5*r-310*this.dpr),106*this.dpr,40*this.dpr,m.UIAtlasKey.commonKey,"yellow_btn",y.a.t("compose.make"),this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.makeBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.content.add(this.makeBtn);var b=360*this.dpr,S=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(b,S),this.content.add(this.materialCon),this.materialCon.setPosition(0,.5*r-230*this.dpr);var C=this.scene.make.image({x:0,y:0,key:this.key,frame:"sourcelist_bg"});C.displayWidth=o;var T=this.scene.make.text({x:0,y:.5*-S+12*this.dpr,text:y.a.t("compose.needMaterials"),style:{color:"#ffffff",fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(.5),k=this.scene.make.image({x:-10*this.dpr,y:T.y,key:this.key,frame:"sourcelist_title_1"}),O=this.scene.make.image({x:10*this.dpr,y:T.y,key:this.key,frame:"sourcelist_title_1"}),I=.5*-T.width-.5*k.width-10*this.dpr;k.setPosition(I,T.y),O.setPosition(-I,T.y).rotation=-Math.PI;var M=this.scene.make.image({x:0,y:T.y+12*this.dpr,key:this.key,frame:"separator"});this.materialCon.add([C,T,k,O,M]),this.materialGameScroll=new _.GameScroller(this.scene,{x:0,y:10*this.dpr,width:o,height:70*this.dpr,zoom:this.scale,align:2,orientation:1,dpr:this.dpr,celldownCallBack:function(t){i.materialTipsCon.visible=!0,i.onMaterialItemHandler(t)},cellupCallBack:function(t){i.materialTipsCon.visible=!1}}),this.materialCon.add(this.materialGameScroll),this.materialTipsCon=this.scene.make.container(void 0,!1).setPosition(0,-20*this.dpr),this.materialTipsCon.visible=!1,this.materialCon.add(this.materialTipsCon);var E=109*this.dpr,x=42*this.dpr,B=new c.NinePatch(this.scene,0,0,E,x,this.key,"tips_bg",{left:20*this.dpr,top:20*this.dpr,right:30*this.dpr,bottom:20*this.dpr});B.setPosition(26*this.dpr,.5*-x),this.tipsbg=B;var R=this.scene.make.image({key:this.key,frame:"tips_arrow"}),D=this.scene.make.text({x:0,y:.5*-S+12*this.dpr,text:"",style:{color:"#844ED5",fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(0,.5).setPosition(-19*this.dpr,-x+10*this.dpr);this.materialTipsName=D;var L=this.scene.make.text({x:0,y:.5*-S+12*this.dpr,text:"",style:{color:"#333333",fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,wordWrap:{width:100*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(0).setPosition(-19*this.dpr,-x+20*this.dpr);this.materialTipsDes=L,this.materialTipsCon.add([B,D,L,R]);var A=this.scene.textures.getFrame(this.key,"bprint_bg_2"),j=A.width+10*this.dpr,H=A.height+12*this.dpr,N=190*this.dpr,U={x:0,y:.5*r-.5*N+10*this.dpr,table:{width:o,height:N,columns:2,cellWidth:j,cellHeight:H,reuseCellContainer:!0,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new w(r,i.key,i.dpr)),o.setItemData(a),a&&i.mSelectItemData&&a.skill.id===i.mSelectItemData.skill.id&&(o.select=!0,i.mSelectItem=o),o}};this.mGrideTable=new _.GameGridTable(this.scene,U),this.mGrideTable.layout(),this.mGrideTable.on("cellTap",(function(t){t&&i.onSelectItemHandler(t)})),this.content.add(this.mGrideTable),this.resize(o,r),t.prototype.init.call(this),this.mShowData&&this.setComposeData(this.mShowData.skills)},ComposePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},ComposePanel.prototype.setComposeData=function(t){if(t&&t.length>0){this.mGrideTable.setItems(t);var i=this.mSelectItem?this.mSelectItem:this.mGrideTable.getCell(0).container;this.onSelectItemHandler(i)}},ComposePanel.prototype.setComposeDetialData=function(t){this.mDetailBubble.setDetailData(t.productName,t.productDes),this.setDetailDisplay(t),this.setMaterialItems(t.materials)},ComposePanel.prototype.setDetailDisplay=function(t){this.mDetailDisplay.loadSprite("loading_ui",u.i.getUIRes(this.dpr,"loading_ui"),u.i.getUIRes(this.dpr,"loading_ui"));var i=new h.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;if(i.animations=t.productAnimations,i.display=t.productDisplay,i.avatar=t.productAvatar,i.display)this.mDetailDisplay.loadDisplay(i);else if(i.avatar){var o=new Phaser.Geom.Point;o.x=0,o.y=20*this.dpr,this.mDetailDisplay.loadAvatar(i,2*this.dpr,o)}},ComposePanel.prototype.onSelectItemHandler=function(t){var i=t.itemData;this.mSelectItemData=t.itemData,this.makeBtn.enable=i.skill.active&&i.skill.qualified,this.mSelectItem&&(this.mSelectItem.select=!1),this.mSelectItem=t,t.select=!0,this.setComposeDetialData(i)},ComposePanel.prototype.setMaterialItems=function(t){var i=t.length,o=[];this.materialGameScroll.clearItems();for(var r=0;r<i;r++){var a=new S(this.scene,this.key,this.dpr);a.y=0,o.push(a),a.setItemData(t[r]),a.setData("itemData",t[r]),this.materialGameScroll.addItem(a)}this.materialGameScroll.Sort()},ComposePanel.prototype.onMaterialItemHandler=function(t){var i=t.getWorldTransformMatrix();this.materialTipsCon.x=i.tx-.5*this.scaleWidth,this.materialTipsName.text=t.itemData.name,this.materialTipsDes.text=t.itemData.source;var o=this.materialTipsName.height+this.materialTipsDes.height+20*this.dpr,r=this.tipsbg.width;this.tipsbg.resize(r,o),this.tipsbg.y=.5*-this.tipsbg.height,this.materialTipsName.y=-o+15*this.dpr,this.materialTipsDes.y=-o+25*this.dpr},ComposePanel.prototype.onMakeHandler=function(){var t=this;if(this.mSelectItemData){var i={text:[{text:y.a.t("compose.confirmation",{name:this.mSelectItemData.productName})}],title:[{text:y.a.t("compose.synthesis")}],button:[{text:y.a.t("common.confirm"),local:!0,clickhandler:new g.a(this,(function(){t.emit("reqUseFormula",t.mSelectItemData.skill.id)}))},{text:y.a.t("common.cancel"),local:!0}]};this.mWorld.uiManager.showMed("MessageBox",i)}},ComposePanel.prototype.onInputPointUp=function(){this.materialTipsCon.visible=!1},ComposePanel.prototype.onBackHandler=function(){this.emit("hide")},ComposePanel}(l.BasePanel),P=function(t){function DetailBubble(i,o){var r=t.call(this,i)||this;r.dpr=o,r.mDetailBubble=r.scene.make.graphics(void 0,!1);var h=198*o,l=96*o;return r.mDetailBubble=r.scene.make.graphics(void 0,!1),r.mDetailBubble.fillStyle(16777215,.1),r.mDetailBubble.fillRoundedRect(0,0,h,l),r.mItemName=r.scene.make.text({x:7*r.dpr,y:9*r.dpr,text:"道具名称道具名称",style:{fontSize:12*r.dpr,fontFamily:a.a.DEFULT_FONT,color:"#8C55E1",align:"center"}}),r.mDesText=r.scene.make.text({x:8*o,y:30*o,style:{color:"#ffffff",fontSize:10*o,fontFamily:a.a.DEFULT_FONT,wordWrap:{width:180*o,useAdvancedWrap:!0}}},!1),r.add([r.mDetailBubble,r.mItemName,r.mDesText]),r.setSize(h,l),r}return v(DetailBubble,t),DetailBubble.prototype.setDetailData=function(t,i){this.mItemName.setText(t),this.mDesText.setText(i),this.resize()},DetailBubble.prototype.resize=function(t,i){void 0===t&&(t=this.width);var o=this.mDesText.height+60*this.dpr;t===this.width&&o===this.height||(this.mDetailBubble.clear(),this.mDetailBubble.fillStyle(16777215,.1),this.mDetailBubble.fillRoundedRect(0,0,t,o),this.setSize(t,o))},DetailBubble}(Phaser.GameObjects.Container),w=function(t){function ComposeItem(i,o,r){var h=t.call(this,i)||this;h.dpr=r,h.key=o,h.bg=h.scene.make.image({key:h.key,frame:"bprint_bg_1"}),h.setSize(h.bg.width,h.bg.height),h.itemIcon=new d.DynamicImage(h.scene,0,0);var l=h.width,c=h.height;return h.newIcon=h.scene.make.image({key:h.key,frame:"tag_new"}),h.newIcon.setPosition(.5*-l+3*r,.5*-c+3*r),h.newText=h.scene.make.text({x:h.newIcon.x,y:h.newIcon.y,text:"N",style:{fontSize:11*h.dpr,fontFamily:a.a.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),h.qualityIcon=h.scene.make.image({key:h.key,frame:"tag_rank_a"}),h.qualityIcon.setPosition(.5*-l+.5*h.qualityIcon.width-2*r,.5*c-.5*h.qualityIcon.height),h.qualityTex=h.scene.make.text({x:h.qualityIcon.x,y:h.qualityIcon.y,text:"A",style:{fontSize:11*h.dpr,fontFamily:a.a.DEFULT_FONT,color:"#ffffff",align:"center"}}).setOrigin(.5),h.qualifiedIcon=h.scene.make.image({key:h.key,frame:"tag_ready"}),h.qualifiedIcon.setOrigin(1).setPosition(.5*l-3*r,.5*c-3*r),h.lockbg=h.scene.make.image({key:h.key,frame:"bprint_mask"}),h.lockIcon=h.scene.make.image({key:h.key,frame:"lock"}),h.add([h.bg,h.itemIcon,h.newIcon,h.newText,h.qualityIcon,h.qualityTex,h.qualifiedIcon,h.lockbg,h.lockIcon]),h}return v(ComposeItem,t),ComposeItem.prototype.setItemData=function(t){this.itemData=t;var i=t.skill,o=i.active;this.newIcon.visible=o,this.newText.visible=o,this.qualityIcon.visible=o,this.qualityTex.visible=o,this.qualityTex.text=i.quality,this.qualifiedIcon.visible=o&&i.qualified,this.lockbg.visible=!i.active,this.lockIcon.visible=!i.active,this.setQualityTexture(i.quality),i.display&&this.setItemIcon(i.display),this.select=!1},Object.defineProperty(ComposeItem.prototype,"select",{set:function(t){t?this.bg.setFrame("bprint_bg_2"):this.bg.setFrame("bprint_bg_1")},enumerable:!1,configurable:!0}),ComposeItem.prototype.setItemIcon=function(t){var i=this,o=u.i.getOsdRes(t.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.scale=i.dpr,i.itemIcon.setPosition(0,0)}))},ComposeItem.prototype.setQualityTexture=function(t){this.qualityIcon.visible=!0,"A"===t?this.qualityIcon.setFrame("tag_rank_a"):"B"===t?this.qualityIcon.setFrame("tag_rank_b"):"C"===t?this.qualityIcon.setFrame("tag_rank_c"):this.qualityIcon.visible=!1},ComposeItem}(Phaser.GameObjects.Container),S=function(t){function ComposeMaterialItem(i,o,r){var h=t.call(this,i)||this;h.dpr=r,h.key=o;var l=h.scene.make.image({key:h.key,frame:"source_bg"});return h.itemIcon=new d.DynamicImage(i,0,0),h.itemCount=new _.BBCodeText(h.scene,0,0,"",{}).setOrigin(.5).setFontSize(11*r).setFontFamily(a.a.DEFULT_FONT),h.add([l,h.itemIcon,h.itemCount]),h.setSize(l.width,l.height),h.itemCount.y=.5*h.height,h}return v(ComposeMaterialItem,t),ComposeMaterialItem.prototype.setItemData=function(t){var i=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var o=u.i.getOsdRes(t.display.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.scale=i.dpr,i.itemIcon.setPosition(0,0)}))},ComposeMaterialItem.prototype.getCountText=function(t,i){var o=t>=i?"#ffffff":"#ff0000";return"[stroke="+o+"][color="+o+"]"+t+"[/color][/stroke]/"+i},ComposeMaterialItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"Compose",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Compose(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Compose,t),Compose.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CRAFT_QUERY_FORMULA,this.onRetFormulaDetial),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CRAFT_SKILLS,this.openComposePanel))},Compose.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Compose.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Compose.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Compose.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(Compose.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Compose.prototype.onReqFormulaDetail=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CRAFT_QUERY_FORMULA);i.content.id=t,this.connection.send(i)},Compose.prototype.onReqUseFormula=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CRAFT_ALCHEMY);i.content.id=t,this.connection.send(i)},Compose.prototype.onRetFormulaDetial=function(t){var i=t.content;this.mEvent.emit("formulaDetial",i)},Compose.prototype.openComposePanel=function(t){var i=t.content;this.mEvent.emit("showopen",i)},Compose}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineSettleMediator",(function(){return u}));var r,a=o(225),h=o(226),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function MineSettleMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a.mineSettle||(a.mineSettle=new h.MineSettle(a.world),a.mineSettle.on("minesettlepacket",a.onMineSettlePacket,a),a.mineSettle.register()),a}return c(MineSettleMediator,t),MineSettleMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.MineSettlePanel(this.scene,this.world),this.mView.on("hide",this.onHideMineSettle,this)),t.prototype.show.call(this,i),this.layerMgr.addToUILayer(this.mView),this.mParam&&this.mParam.length>0&&this.setMIneSettlePanel(this.mParam[0]),this.mView.show())},MineSettleMediator.prototype.destroy=function(){this.mineSettle&&this.mineSettle.destroy(),this.mineSettle=void 0,t.prototype.destroy.call(this)},MineSettleMediator.prototype.onHideMineSettle=function(){this.mineSettle.reqMineSettlePacket(),t.prototype.destroy.call(this)},MineSettleMediator.prototype.onMineSettlePacket=function(t){this.mView&&this.mView.visible?this.setMIneSettlePanel(t):(this.setParam([t]),this.show())},MineSettleMediator.prototype.setMIneSettlePanel=function(t){var i=this.mView;i.setData("settleData",t),i.setMineSettlePacket(t)},MineSettleMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineSettlePanel",(function(){return g}));var r,a=o(113),h=o(116),l=o(112),c=o(117),u=o(111),p=o(114),d=o(115),m=o(109),y=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),g=function(t){function MineSettlePanel(i,o){var r=t.call(this,i,o)||this;return r.key="mine_settle",r}return y(MineSettlePanel,t),MineSettlePanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.bg.x=r/2,this.bg.y=a/2,this.titleimage.x=r/2,this.titleimage.y=this.bg.y-this.bg.displayHeight/2-8*this.dpr,this.confirmBtn.x=r/2,this.confirmBtn.y=this.bg.y+100*this.dpr,this.titleName.x=r/2,this.titleName.y=this.titleimage.y+32*this.dpr,this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,r,a),this.mPropGrid.refreshPos(r/2,this.bg.y-2*this.dpr),this.mPropGrid.resetMask(),this.setSize(r,a)},MineSettlePanel.prototype.show=function(t){this.mShowData=t,this.refreshData(),this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},MineSettlePanel.prototype.addListen=function(){this.mInitialized&&this.confirmBtn.on(String(m.ClickEvent.Tap),this.onConfirmBtnClick,this)},MineSettlePanel.prototype.removeListen=function(){this.mInitialized&&this.confirmBtn.off(String(m.ClickEvent.Tap),this.onConfirmBtnClick,this)},MineSettlePanel.prototype.preload=function(){this.addAtlas(this.key,"minesettle/settlement.png","minesettle/settlement.json"),this.addAtlas(d.UIAtlasKey.commonKey,d.UIAtlasName.commonUrl+".png",d.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},MineSettlePanel.prototype.init=function(){var i=this,o=this.cameraWidth,r=this.cameraHeight;this.bg=new c.NinePatch(this.scene,0,0,293*this.dpr,260*this.dpr,this.key,"bg",{left:10,top:10,right:10,bottom:10}),this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains);var h=this.scene.textures.getFrame(this.key,"icon_test"),l=h.width+20*this.dpr,u=h.height+25*this.dpr,y={x:0,y:0,table:{width:280*this.dpr,height:160*this.dpr,columns:5,cellWidth:l,cellHeight:u,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,cellPadX:18*this.dpr,zoom:this.scale},clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new _(r,i.dpr)),o.setData({item:a}),o.setItemData(a),o}};this.mPropGrid=new m.GameGridTable(this.scene,y),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var o=t.itemData;o&&i.onSelectItemHandler(o)})),this.titleimage=this.scene.make.image({x:0,y:.5*-this.bg.displayWidth-10*this.dpr,key:this.key,frame:"title"},!1),this.titleimage.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+32*this.dpr,text:p.a.t("minesettle.settle"),style:{fontSize:15*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5,.5),this.confirmBtn=new m.NineSliceButton(this.scene,0,100*this.dpr,90*this.dpr,40*this.dpr,d.UIAtlasKey.commonKey,"yellow_btn",p.a.t("minesettle.savebag"),this.dpr,this.scale,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*this.dpr,fontFamily:a.a.DEFULT_FONT}),this.add([this.blackGraphic,this.bg,this.titleimage,this.titleName,this.confirmBtn]),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},MineSettlePanel.prototype.setMineSettlePacket=function(t){this.mInitialized&&this.mPropGrid.setItems(t.items)},MineSettlePanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),this.confirmBtn&&this.confirmBtn.destroy(),this.mPropGrid=null,this.confirmBtn=null,t.prototype.destroy.call(this)},MineSettlePanel.prototype.refreshData=function(){var t=this.getData("settleData");t&&this.setMineSettlePacket(t)},MineSettlePanel.prototype.onSelectItemHandler=function(t){},MineSettlePanel.prototype.onConfirmBtnClick=function(t){this.checkPointerDis(t)&&this.emit("hide")},MineSettlePanel.prototype.checkPointerDis=function(t){return!this.mWorld||Math.abs(t.downX-t.upX)<10*this.mWorld.uiRatio*this.mWorld.uiScale&&Math.abs(t.downY-t.upY)<10*this.mWorld.uiRatio*this.mWorld.uiScale},MineSettlePanel}(l.BasePanel),_=function(t){function MineSettleItem(i,o){var r=t.call(this,i)||this;return r.dpr=o,r.icon=new h.DynamicImage(i,0,0),r.itemCount=r.scene.make.text({text:"600",style:{fontSize:18,fontFamily:a.a.DEFULT_FONT}},!1),r.itemCount.setOrigin(.5,0),r.icon.setOrigin(0,0),r.icon.setScale(r.dpr),r.itemCount.setPosition(0,r.icon.height),r.add(r.icon),r.add(r.itemCount),r}return y(MineSettleItem,t),MineSettleItem.prototype.setItemData=function(t){var i=this;this.itemData=t,this.itemCount.setFontSize(14*this.dpr),this.itemCount.text=t.count+"";var o=u.i.getOsdRes(t.display.texturePath);this.icon.load(o,this,(function(){i.icon.setScale(33*i.dpr/i.icon.width),i.icon.setPosition(0,3*i.dpr),i.itemCount.setPosition(.5*i.icon.displayWidth,i.icon.x+i.icon.displayHeight+3*i.dpr)}))},MineSettleItem.prototype.destroy=function(){t.prototype.destroy.call(this),this.icon&&this.icon.destroy(),this.itemCount&&this.itemCount.destroy(),this.itemData=null,this.icon=null,this.itemCount=null,this.scene=null},MineSettleItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"MineSettle",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function MineSettle(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(MineSettle,t),MineSettle.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MINING_MODE_SHOW_REWARD_PACKAGE,this.onMineSettlePackageHandler))},MineSettle.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},MineSettle.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},MineSettle.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},MineSettle.prototype.reqMineSettlePacket=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MINING_MODE_STORAGE_REWARD);this.connection.send(t)},MineSettle.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(MineSettle.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),MineSettle.prototype.onMineSettlePackageHandler=function(t){var i=t.content;this.mEvent.emit("minesettlepacket",i)},MineSettle}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"EquipUpgradeMediator",(function(){return u}));var r,a=o(228),h=o(230),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function EquipUpgradeMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a.equipUpgrade||(a.equipUpgrade=new h.EquipUpgrade(a.world),a.equipUpgrade.on("activeEquip",a.onActiveEquipment,a),a.equipUpgrade.on("showopen",a.onShowEquipPanel,a),a.equipUpgrade.register()),a}return c(EquipUpgradeMediator,t),EquipUpgradeMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.default(this.scene,this.world),this.mView.on("hide",this.onHidePanel,this),this.mView.on("reqActive",this.onReqActiveEquipment,this),this.mView.on("reqEquiped",this.onReqEquipedEquipment,this)),this.layerMgr.addToUILayer(this.mView),this.mParam&&this.mParam.length>0&&this.onEquipUpgradePacket(this.mParam[0]),this.mView.show())},EquipUpgradeMediator.prototype.destroy=function(){this.equipUpgrade&&this.equipUpgrade.destroy(),this.equipUpgrade=void 0,t.prototype.destroy.call(this)},EquipUpgradeMediator.prototype.onHidePanel=function(){t.prototype.destroy.call(this)},EquipUpgradeMediator.prototype.onEquipUpgradePacket=function(t){var i=this.mView;i&&(i.setData("upgradeData",t),i.setEquipDatas(t))},EquipUpgradeMediator.prototype.onActiveEquipment=function(t){this.mView&&this.mView.setActiveEquipment(t)},EquipUpgradeMediator.prototype.onReqEquipedEquipment=function(t){this.equipUpgrade&&this.equipUpgrade.reqEquipedEquipment(t)},EquipUpgradeMediator.prototype.onReqActiveEquipment=function(t){this.equipUpgrade&&this.equipUpgrade.reqActiveEquipment(t)},EquipUpgradeMediator.prototype.onShowEquipPanel=function(t){this.setParam([t]),this.show()},EquipUpgradeMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i);var r,a=o(112),h=o(113),l=o(229),c=o(117),u=o(114),p=o(115),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function EquipUpgradePanel(i,o){var r=t.call(this,i,o)||this;return r.key="equip_upgrade",r.commonkey="common_key",r.equipItems=[],r}return d(EquipUpgradePanel,t),EquipUpgradePanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.bg.x=r/2,this.bg.y=a/2,this.tilteName.x=this.bg.x,this.tilteName.y=this.bg.y-this.bg.height/2,this.titlebg.x=this.bg.x,this.titlebg.y=this.bg.y-this.bg.height/2,this.closeBtn.x=this.bg.x+this.bg.width/2-10*this.dpr,this.closeBtn.y=this.bg.y-this.bg.height/2+10*this.dpr,this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,r,a),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName])},EquipUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.refreshData(),this.addListen()):this.preload())},EquipUpgradePanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},EquipUpgradePanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},EquipUpgradePanel.prototype.preload=function(){this.commonkey=p.UIAtlasKey.commonKey,this.addAtlas(this.key,"equip_upgrade/mine_eqpm.png","equip_upgrade/mine_eqpm.json"),this.addAtlas(p.UIAtlasKey.commonKey,p.UIAtlasName.commonUrl+".png",p.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},EquipUpgradePanel.prototype.init=function(){var i=this.scaleWidth,o=this.scaleHeight;this.setSize(i,o),this.blackBg=this.scene.make.graphics(void 0,!1),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(0,0,i,o),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,this.scene.cameras.main.width,this.scene.cameras.main.height),Phaser.Geom.Rectangle.Contains),this.bg=new c.NinePatch(this.scene,0,0,300*this.dpr,300*this.dpr,this.commonkey,"bg",{left:40,top:40,bottom:40,right:40});var r=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:r,key:this.key,frame:"titlebg"});var a="bold "+15*this.dpr+"px Source Han Sans";this.tilteName=this.scene.make.text({x:0,y:r,text:u.a.t("equipupgrade.title"),style:{font:a,color:"#8F4300",fontSize:15*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:r+5*this.dpr,key:this.commonkey,frame:"close"}),this.tilteName.setStroke("#8F4300",1),this.closeBtn.setInteractive(),this.add([this.blackBg,this.bg,this.closeBtn,this.titlebg,this.tilteName]),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),t.prototype.init.call(this)},EquipUpgradePanel.prototype.setEquipDatas=function(t){if(this.content=t,this.mInitialized){var i=this.scaleWidth,o=this.scaleHeight,r=t.mineEquipments,a=175*this.dpr*r.length-(r.length>=2?40*(r.length-2):0),h=155*this.dpr;this.resetPosition(this.bg.width,a);for(var c=.5*-a+100*this.dpr,u=0,p=0,d=r;p<d.length;p++){var m=d[p];m.isblue=u%2!=0;var y=new l.EquipUpgradeItem(this.scene,this,this.dpr,this.scale,this.key,this.commonkey);y.on("reqActive",this.onReqActiveEquipment,this),y.on("reqEquiped",this.onReqEquipedEquipment,this),y.setEquipItems(m),y.setTransPosition(i/2,c+o/2),this.equipItems.push(y),c+=h,u++}this.resize(i,o)}},EquipUpgradePanel.prototype.setActiveEquipment=function(t){for(var i=0,o=0,r=this.content.mineEquipments;o<r.length;o++){for(var a=r[o],h=this.equipItems[i],l=-1,c=0;c<a.mineEquipments.length;c++){var u=a.mineEquipments[c];u.id===t.id?(a.mineEquipments[c]=t,h.refreshEquipData(t,c),l=c):u.selected&&(u.selected=!1)}l>=0&&h.refreshEquipData(t,l),i++}},EquipUpgradePanel.prototype.destroy=function(){if(this.equipItems){for(var i=0,o=this.equipItems;i<o.length;i++){o[i].destroy()}this.equipItems.length=0}this.equipItems=null,this.content=null,t.prototype.destroy.call(this)},EquipUpgradePanel.prototype.getEuipDatas=function(){for(var t=[],i=0;i<3;i++){var o={};o.name=0===i?"矿镐":"矿车",o.items=[],o.isblue=!(i%2==0);for(var r=0;r<15;r++){var a={};a.name="矿镐"+r,a.penetration=10+r,a.des="describle",a.cost=100*r,a.unlock=!1,o.items.push(a)}t.push(o)}return t},EquipUpgradePanel.prototype.refreshData=function(){var t=this.getData("upgradeData");t&&this.setEquipDatas(t)},EquipUpgradePanel.prototype.resetPosition=function(t,i){this.bg.resize(t,i);var o=.5*-i;this.titlebg.setPosition(0,o),this.tilteName.setPosition(0,o),this.closeBtn.setPosition(.5*t-8*this.dpr,o+8*this.dpr)},EquipUpgradePanel.prototype.OnClosePanel=function(){this.emit("hide")},EquipUpgradePanel.prototype.onReqActiveEquipment=function(t){this.emit("reqActive",t)},EquipUpgradePanel.prototype.onReqEquipedEquipment=function(t){this.emit("reqEquiped",t)},EquipUpgradePanel}(a.BasePanel);i.default=m},function(t,i,o){"use strict";o.r(i),o.d(i,"EquipUpgradeItem",(function(){return d}));var r,a=o(113),h=o(116),l=o(111),c=o(117),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function EquipUpgradeItem(i,o,r,a,h,l){var c=t.call(this)||this;return c.haveEquiped=!1,c.cellWidth=0,c.cellHeight=0,c.dpr=r,c.zoom=a,c.key=h,c.commonKey=l,c.mScene=i,c.mContainer=o,c.create(),c}return p(EquipUpgradeItem,t),EquipUpgradeItem.prototype.setEquipItems=function(t){var i=t.equipmentType,o=t.mineEquipments;this.titleName.text=i;for(var r=0,a=o;r<a.length;r++){if(a[r].selected){this.haveEquiped=!0;break}0}this.gridTable.setItems(o),this.haveEquiped&&this.setBgTexture(t.isblue)},EquipUpgradeItem.prototype.setTransPosition=function(t,i){this.bg.x+=t,this.bg.y+=i,this.titleName.x+=t,this.titleName.y+=i,this.bottombg.x+=t,this.bottombg.y+=i,this.equipName.x+=t,this.equipName.y+=i,this.penetrationText.x+=t,this.penetrationText.y+=i,this.equipDes.x+=t,this.equipDes.y+=i,this.topbg.x+=t,this.topbg.y+=i,this.unlockbtn.x+=t,this.unlockbtn.y+=i,this.gridTable.refreshPos(t,i-10*this.dpr),this.gridTable.resetMask()},Object.defineProperty(EquipUpgradeItem.prototype,"displayList",{get:function(){return[this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]},enumerable:!1,configurable:!0}),EquipUpgradeItem.prototype.refreshEquipData=function(t,i){this.gridTable.items[i]=t;for(var o=0,r=this.gridTable.getCells();o<r.length;o++){var a=r[o];if(a&&a.container){var h=a.container.itemData;h.id===t.id?a.container.setItemData(t):a.container.setItemData(h)}}this.curSelectItemData.id===t.id&&(this.curSelectItemData=t),this.updateEquipItem(this.curSelectItemData)},EquipUpgradeItem.prototype.destroy=function(){this.unlockbtn&&this.unlockbtn.off("pointerup",this.onUnlockEquipHandler,this),t.prototype.destroy.call(this),this.gridTable&&this.gridTable.destroy(),this.bg=null,this.topbg=null,this.bottombg=null,this.gridTable=null,this.titleName=null,this.equipName=null,this.penetrationText=null,this.equipDes=null,this.unlockbtn=null,this.costNum=null,this.diamondIcon=null,this.curEquipItem=null,this.curSelectItemData=null},EquipUpgradeItem.prototype.setBgTexture=function(t){var i=t?"topbg1":"topbg",o=t?"bottombg1":"bottombg",r=t?"#0867AE":"#8F4300";this.topbg.setTexture(this.key,i),this.bottombg.setTexture(this.key,o),this.titleName.setColor(r).setStroke(r,1),this.equipName.setColor(r).setStroke(r,1),this.penetrationText.setColor(r).setStroke(r,1)},EquipUpgradeItem.prototype.create=function(){this.bg=this.mScene.make.image({x:0,y:-21*this.dpr,key:this.key,frame:"bg1"}),this.topbg=this.mScene.make.image({x:0,y:-61*this.dpr,key:this.key,frame:"topbg"}),this.titleName=this.mScene.make.text({x:0,y:this.topbg.y+0*this.dpr,text:"矿镐",style:{blod:!0,color:"#8F4300",fontSize:14*this.dpr,font:this.getBoldFont(14*this.dpr)}}).setOrigin(.5,.5),this.bottombg=this.mScene.make.image({x:0,y:42*this.dpr,key:this.key,frame:"bottombg"}),this.equipName=this.mScene.make.text({x:-120*this.dpr,y:15*this.dpr,text:"精铁镐",style:{color:"#8F4300",fontSize:14*this.dpr,font:this.getBoldFont(14*this.dpr)}}),this.penetrationText=this.mScene.make.text({x:-60*this.dpr,y:16*this.dpr,text:"穿透力:10",style:{color:"#8F4300",fontSize:12*this.dpr,fontFamily:a.a.DEFULT_FONT}}),this.equipDes=this.mScene.make.text({x:-120*this.dpr,y:35*this.dpr,text:"描述文字",style:{color:"#000000",fontSize:10*this.dpr,fontFamily:a.a.DEFULT_FONT,wordWrap:{width:130*this.dpr,useAdvancedWrap:!0}}}),this.equipDes.setStroke("#000000",1),this.mContainer.add([this.bg,this.topbg,this.bottombg,this.titleName,this.equipName,this.penetrationText,this.equipDes]),this.createGridTable(),this.createBtn()},EquipUpgradeItem.prototype.createGridTable=function(){var t=this,i=this.mScene.textures.getFrame(this.key,"equipbg"),o=i.width+10*this.dpr,r=i.height+30*this.dpr;this.cellWidth=o,this.cellHeight=r;var a={x:0,y:0,scrollMode:1,table:{width:259*this.dpr,height:77*this.dpr,columns:1,cellWidth:o,cellHeight:r,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.zoom},clamplChildOY:!1,createCellContainerCallback:function(i,a){var h=i.scene,l=i.item;i.index;return null===a&&((a=new m(h,t.dpr,t.key)).setSize(o,r),a.setChildPosition()),a.setData({item:l}),a.setItemData(l),t.curSelectItemData===l?(a.setSelect(!0),t.curEquipItem=a):a.setSelect(!1),null==t.curEquipItem&&(t.haveEquiped&&!l.selected||t.onSelectItemHandler(a)),a}};this.gridTable=new u.GameGridTable(this.mScene,a),this.gridTable.layout(),this.gridTable.on("cellTap",(function(i){t.onSelectItemHandler(i)})),this.mContainer.add(this.gridTable)},EquipUpgradeItem.prototype.onSelectItemHandler=function(t){this.curEquipItem&&this.curEquipItem.setSelect(!1);var i=t.itemData;this.curSelectItemData=i,this.updateEquipItem(i),t.setSelect(!0),this.curEquipItem&&this.curEquipItem.setSelect(!1),this.curEquipItem=t,i.owned&&!i.selected&&this.emit("reqEquiped",i.id)},EquipUpgradeItem.prototype.updateEquipItem=function(t){if(this.penetrationText.text=t.buffDisplayNames[0],this.equipDes.text=t.description,this.equipName.text=t.name,t.owned?this.unlockbtn.visible=!1:this.unlockbtn.visible=!0,t.qualified?(this.unlockCondition.visible=!1,this.unlockbtn.setInteractive(),this.unlockBg.clearTint(),this.costNum.setColor("#ffffff")):t.owned||(this.unlockCondition.visible=!0,this.unlockCondition.text=t.conditionDisplayNames[0],this.unlockbtn.disableInteractive(),this.unlockBg.setTintFill(8947848),this.costNum.setColor("#999999")),null===t.price)this.costNum.visible=!1,this.diamondIcon.visible=!1,this.btnName.setPosition(0,0*this.dpr);else{var i=t.price.price,o=Math.pow(10,t.price.displayPrecision);this.costNum.text=Math.floor(i*o)/o+"",this.costNum.visible=!0,this.diamondIcon.visible=!0,this.diamondIcon.setTexture(this.commonKey,l.f.getIcon(t.price.coinType)),this.diamondIcon.setDisplaySize(12*this.dpr,12*this.dpr),this.btnName.setPosition(0,6*this.dpr)}},EquipUpgradeItem.prototype.onUnlockEquipHandler=function(){this.emit("reqActive",this.curEquipItem.itemData.id)},EquipUpgradeItem.prototype.createBtn=function(){this.unlockCondition=new u.BBCodeText(this.mScene,0,-26*this.dpr,"",{}).setOrigin(.5).setFontSize(10*this.dpr).setFontFamily(a.a.DEFULT_FONT),this.unlockbtn=this.mScene.make.container(void 0,!1);var t=new c.NinePatch(this.mScene,0,0,88*this.dpr,31*this.dpr,this.commonKey,"yellow_btn_normal",{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr});this.unlockBg=t,this.diamondIcon=this.mScene.make.image({x:-13*this.dpr,y:-8*this.dpr,key:this.commonKey,frame:"test_diamond"}),this.costNum=this.mScene.make.text({x:-2,y:-8*this.dpr,text:"1000",style:{color:"#ffffff",fontSize:10*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0,.5),this.btnName=this.mScene.make.text({x:0,y:6*this.dpr,text:"立即解锁",style:{color:"#8F4300",fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5,.5),this.costNum.setStroke("#ffffff",1),this.btnName.setStroke("#8F4300",1),this.unlockCondition.setStroke("#000000",1),this.unlockbtn.setPosition(70*this.dpr,48*this.dpr),this.unlockbtn.setSize(t.width,t.height),this.unlockbtn.add([this.unlockCondition,t,this.diamondIcon,this.costNum,this.btnName]),this.unlockbtn.on("pointerup",this.onUnlockEquipHandler,this),this.mContainer.add(this.unlockbtn)},EquipUpgradeItem.prototype.getBoldFont=function(t){return"bold "+t+"px Source Han Sans"},EquipUpgradeItem}(Phaser.Events.EventEmitter),m=function(t){function EquipItemCell(i,o,r){var a=t.call(this,i)||this;return a.isSelect=!1,a.isUnlock=!1,a.dpr=o,a.key=r,a.create(),a}return p(EquipItemCell,t),EquipItemCell.prototype.setItemData=function(t){var i=this;this.itemData=t;var o=l.i.getOsdRes(t.display.texturePath);this.equipIcon.load(o,this,(function(){i.equipIcon.scale=i.dpr})),this.setEquiped(t.selected,t.owned),this.setSelect(this.isSelect)},EquipItemCell.prototype.setSelect=function(t){this.isSelect=t;var i="equipbg";t||(i=this.isUnlock?"equipbg2":"equipbg1"),this.itemData.selected&&(i="equipbg2"),this.bg.setTexture(this.key,i)},EquipItemCell.prototype.setChildPosition=function(){var t=.5*this.bg.width+10*this.dpr,i=this.height-10*this.dpr;this.bg.setPosition(t,i),t+=1*this.dpr,i=.5*this.height+2*this.dpr,this.equipIcon.setPosition(t,i),t+=22*this.dpr,i=8*this.dpr,this.unlock.setPosition(t,i)},EquipItemCell.prototype.setEquiped=function(t,i){this.isUnlock=i,this.unlock.visible=!1,t?(this.isUnlock=!0,this.unlock.visible=!0,this.unlock.setTexture(this.key,"ok")):this.isUnlock||(this.unlock.visible=!0,this.unlock.setTexture(this.key,"lock"))},EquipItemCell.prototype.create=function(){this.bg=this.scene.make.image({x:0,y:-10*this.dpr,key:this.key,frame:"equipbg"}),this.equipIcon=new h.DynamicImage(this.scene,15*this.dpr,0*this.dpr),this.unlock=this.scene.make.image({x:30*this.dpr,y:-10*this.dpr,key:this.key,frame:"lock"}),this.add([this.bg,this.equipIcon,this.unlock])},EquipItemCell}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"EquipUpgrade",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function EquipUpgrade(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(EquipUpgrade,t),EquipUpgrade.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MINING_MODE_ACTIVE_EQUIPMENT,this.onActiveEquipmend),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MINING_MODE_SHOW_SELECT_EQUIPMENT_PANEL,this.openEquipUpgrade))},EquipUpgrade.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},EquipUpgrade.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},EquipUpgrade.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},EquipUpgrade.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(EquipUpgrade.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),EquipUpgrade.prototype.reqEquipedEquipment=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_MINING_MODE_EQUIP_EQUIPMENT);i.content.equipmentId=t,this.connection.send(i)},EquipUpgrade.prototype.reqActiveEquipment=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_MINING_MODE_ACTIVE_EQUIPMENT);i.content.equipmentId=t,this.connection.send(i)},EquipUpgrade.prototype.onActiveEquipmend=function(t){var i=t.content;this.mEvent.emit("activeEquip",i.mineEquipment)},EquipUpgrade.prototype.openEquipUpgrade=function(t){var i=t.content;this.mEvent.emit("showopen",i)},EquipUpgrade}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"MarketMediator",(function(){return p}));var r,a=o(232),h=o(236),l=o(119),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function MarketMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.world=r,a.layerManager=i,a.mMarket||(a.mMarket=new h.Market(a.world),a.mMarket.register(),a.mMarket.on("getMarketCategories",a.onCategoriesHandler,a),a.mMarket.on("queryMarket",a.onQueryResuleHandler,a),a.mMarket.on("queryCommodityResource",a.onQueryCommodityResourceHandler,a),a.mMarket.on("showopen",a.onShowOpenPanel,a)),a}return u(MarketMediator,t),MarketMediator.prototype.show=function(t){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.MarketPanel(this.scene,this.world),this.mView.on("getCategories",this.onGetCategoriesHandler,this),this.mView.on("queryProp",this.onQueryPropHandler,this),this.mView.on("buyItem",this.onBuyItemHandler,this),this.mView.on("close",this.onCloseHandler,this),this.mView.on("popItemCard",this.onPopItemCardHandler,this),this.mView.on("queryPropResource",this.onQueryPropresouceHandler,this)),t&&t[0]?this.mMarket.setMarketName(t[0].marketName):this.mMarket.setMarketName("shop"),this.mView.show(),this.layerManager.addToUILayer(this.mView))},MarketMediator.prototype.destroy=function(){this.mMarket&&this.mMarket.destroy(),this.mMarket=null,t.prototype.destroy.call(this)},MarketMediator.prototype.onCategoriesHandler=function(t){this.mView.setCategories(t)},MarketMediator.prototype.onQueryResuleHandler=function(t){this.mView.setProp(t)},MarketMediator.prototype.onGetCategoriesHandler=function(){this.mMarket.getMarkCategories()},MarketMediator.prototype.onQueryPropHandler=function(t,i,o){this.mMarket.queryMarket(t,i,o)},MarketMediator.prototype.onBuyItemHandler=function(t){this.mMarket.buyMarketCommodities([t])},MarketMediator.prototype.onQueryPropresouceHandler=function(t){this.mMarket.queryCommodityResource(t.id,t.category)},MarketMediator.prototype.onShowOpenPanel=function(t){this.setParam([t]),this.show([t])},MarketMediator.prototype.onPopItemCardHandler=function(t,i){var o={content:{name:"ItemPopCard",prop:t,display:i}};this.world.emitter.emit(l.a.SHOW_UI,o)},MarketMediator.prototype.onQueryCommodityResourceHandler=function(t){this.mView&&this.mView.setCommodityResource(t)},MarketMediator.prototype.onCloseHandler=function(){t.prototype.destroy.call(this)},MarketMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"MarketPanel",(function(){return b}));var r,a=o(112),h=o(233),l=o(114),c=o(2),u=o(127),p=o(150),d=o(235),m=o(113),y=o(120),g=o(115),_=o(109),v=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),b=function(t){function MarketPanel(i,o){var r=t.call(this,i,o)||this;return r.key="market",r.mSubTabs=[],r.mTabs=[],r}return v(MarketPanel,t),MarketPanel.prototype.addListen=function(){this.mInitialized&&(this.mSelectItem.on("buyItem",this.onBuyItemHandler,this),this.mSelectItem.on("popItemCard",this.onPopItemCardHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this))},MarketPanel.prototype.removeListen=function(){this.mInitialized&&(this.mSelectItem.off("buyItem",this.onBuyItemHandler,this),this.mSelectItem.off("popItemCard",this.onPopItemCardHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this))},MarketPanel.prototype.resize=function(t,i){var o=this.scaleWidth,r=this.scaleHeight;this.setSize(o,r),this.mTIle.x=o/2;var a=290*this.dpr;this.mBackgroundColor.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.mShelfContainer.setSize(o,a),this.mShelfContainer.setPosition(0,r-this.mShelfContainer.height),this.mShelfBackground.clear(),this.mShelfBackground.fillStyle(183551),this.mShelfBackground.fillRect(0,0,this.mShelfContainer.width,this.mShelfContainer.height),this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSelectItem.resize(o,r),this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(4121087),this.mCategoriesBar.fillRect(0,0,o,40*this.dpr),this.mCategoriesBar.fillStyle(308179),this.mCategoriesBar.fillRect(0,40*this.dpr,o,3*this.dpr),this.mSubCategeoriesContainer.setSize(o,43*this.dpr)},MarketPanel.prototype.setCategories=function(t){if(this.mCategoriesContainer){this.mCategoriesContainer.removeAll(!0);var i=t.marketCategory;this.mTabs=[];var o=this.scene.textures.getFrame(this.key,"categories_normal"),r=60;o&&(r=o.width,o.height);for(var a={left:r/2,top:12*this.dpr,right:4*this.dpr,bottom:2*this.dpr},h=new u.CheckboxGroup,l=77*this.dpr,c=38*this.dpr,p=0;p<i.length;p++){var d=new _.NinePatchTabButton(this.scene,l,c,this.key,"categories_normal","categories_down",i[p].category.value,[a],1,1);d.setTextStyle({fontSize:18*this.dpr,fontFamily:m.a.DEFULT_FONT}),this.mTabs[p]=d,d.setData("category",i[p]),d.x=80*p*this.dpr+l/2,d.y=c/2}this.mCategoriesContainer.setSize(this.mTabs.length*l,c),this.mShelfContainer.add(this.mTabs),this.layoutCategories(),h.on("selected",this.onSelectCategoryHandler,this),h.appendItemAll(this.mTabs),h.selectIndex(0)}},MarketPanel.prototype.setProp=function(t){this.clearCategories(this.mItems),this.mItems=[];var i=t.commodities;this.mPropGrid.setItems(i),this.mPropGrid.layout(),this.mPropGrid.setT(0),i.length>0&&this.onSelectItemHandler(i[0])},MarketPanel.prototype.setCommodityResource=function(t){this.mSelectItem&&(this.mSelectItem.setResource(t),this.mSelectItem.setData("display",t))},MarketPanel.prototype.destroy=function(){this.mSubCategorisScroll&&this.mSubCategorisScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},MarketPanel.prototype.layoutCategories=function(){this.mCategoriesBar.y=this.mCategoriesContainer.height+this.mShelfContainer.y,this.mSubCategeoriesContainer.addAt(this.mCategoriesBar,0),this.mPropContainer.y=this.mSubCategeoriesContainer.y+43*this.dpr+this.mSubCategeoriesContainer.height+9*this.dpr,this.mShelfBackground.y=this.mSubCategeoriesContainer.y+43*this.dpr,this.mSubCategorisScroll.y=this.mCategoriesBar.y+25*this.dpr,this.randomCon.y=this.mSubCategorisScroll.y,this.mPropGrid.y=this.mCategoriesBar.y+this.mSubCategeoriesContainer.height+.5*this.mPropGrid.height+5*this.dpr,this.mPropGrid.layout(),this.mSubCategorisScroll.layout(),this.mSubCategorisScroll.resetMask(),this.mPropGrid.resetMask()},MarketPanel.prototype.preload=function(){this.addAtlas(this.key,"market/market.png","market/market.json"),this.addAtlas(g.UIAtlasKey.commonKey,g.UIAtlasName.commonUrl+".png",g.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},MarketPanel.prototype.init=function(){var i=this;if(!this.mInitialized){var o=this.scaleWidth,r=this.scaleHeight;this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,o,r),this.add(this.mBackgroundColor),this.mShelfContainer=this.scene.make.container({x:o/2,y:r},!1).setSize(o,290*this.dpr);for(var a=this.scene.textures.getFrame(this.key,"bg"),c=Math.ceil(o/a.width),u=Math.ceil((r-this.mShelfContainer.height+a.height)/a.height),y=0;y<c;y++)for(var v=0;v<u;v++){var b=this.scene.make.image({x:y*a.width,y:v*a.height,key:this.key,frame:"bg"},!1);this.add(b)}this.mShelfBackground=this.scene.make.graphics(void 0,!1),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"back_arrow",x:21*this.dpr,y:30*this.dpr}),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains),this.mPropContainer=this.scene.make.container(void 0,!1),this.mCategoriesContainer=this.scene.make.container(void 0,!1),this.mSubCategeoriesContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.add([this.mShelfBackground,this.mCategoriesContainer,this.mPropContainer]),this.add([this.mShelfContainer,this.mSubCategeoriesContainer]),this.mSelectItem=new h.ElementDetail(this.scene,this.mWorld,this.key,this.dpr),this.mSelectItem.setSize(o,r-this.mShelfContainer.height),this.mTIle=this.scene.make.text({text:l.a.t("market.title"),y:30*this.dpr,style:{fontSize:36*this.dpr,fontFamily:m.a.DEFULT_FONT}}).setOrigin(.5),this.add([this.mTIle,this.mSelectItem,this.mCloseBtn]),t.prototype.init.call(this),this.mCategoriesBar=this.scene.make.graphics(void 0,!1);var P=56*this.dpr,w=41*this.dpr,S={x:o/2,y:0,table:{width:o,height:50*this.dpr,cellWidth:P,cellHeight:w,reuseCellContainer:!0,zoom:this.scale},scrollMode:1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new p.TextButton(r,i.dpr)),o.getData("item")!==a&&(o.setText(a.value),o.setData({item:a}),a&&i.mPreSubCategoris&&i.mPreSubCategoris.key===a.key?o.changeDown():o.changeNormal()),o}};this.mSubCategorisScroll=new _.GameGridTable(this.scene,S),this.mSubCategorisScroll.on("cellTap",(function(t,o){i.onSelectSubCategoryHandler(t)})),this.add(this.mSubCategorisScroll),this.randomCon=this.scene.make.container(void 0,!1),this.randomCon.x=.5*o,this.randomCon.visible=!1,this.add(this.randomCon),this.randomRefeshTime=this.scene.make.text({x:.5*-o+10*this.dpr,y:-12*this.dpr,text:l.a.t("market.refreshtime"),style:{color:"#007AAE",fontSize:13*this.dpr,fontFamily:m.a.DEFULT_FONT}}).setOrigin(0,.5);var C=80*this.dpr,T=30*this.dpr;this.randomRefreshBtn=new _.NineSliceButton(this.scene,.5*o,this.randomRefeshTime.y,C,T,g.UIAtlasKey.commonKey,"button_g",l.a.t("market.refresh"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.randomRefreshBtn.x=.5*o-.5*this.randomRefreshBtn.width-10*this.dpr,this.randomRefreshBtn.setTextOffset(0,5*this.dpr),this.randomRefreshBtn.setTextStyle({color:"#0",fontSize:13*this.dpr,fontFamily:m.a.BOLD_FONT}),this.randomRefreshBtn.setFontStyle("bold"),this.refreshIcon=this.scene.make.image({key:g.UIAtlasKey.commonKey,frame:"iv_coin"}).setScale(.8),this.refreshIcon.setPosition(-10*this.dpr,-8*this.dpr),this.refreshNeedCount=this.scene.make.text({x:0*this.dpr,y:this.refreshIcon.y,text:"100",style:{fontSize:10*this.dpr,fontFamily:m.a.DEFULT_FONT}}).setOrigin(0,.5),this.randomRefreshBtn.add([this.refreshIcon,this.refreshNeedCount]),this.randomCon.add([this.randomRefeshTime,this.randomRefreshBtn]);var k=this.scene.textures.getFrame(this.key,"border"),O=k.width+10*this.dpr,I=k.height+10*this.dpr,M={x:o/2,y:0,table:{width:o,height:224*this.dpr,columns:3,cellWidth:O,cellHeight:I,reuseCellContainer:!0,cellOriginX:0,cellOriginY:0,zoom:this.scale,mask:!1},scroller:{backDeceleration:!1,slidingDeceleration:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new d.MarketItem(r,0,0,i.dpr)),o.setData({item:a}),o.setProp(a),o}};this.mPropGrid=new _.GameGridTable(this.scene,M),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){var o=t.getData("item");o&&i.onSelectItemHandler(o)})),this.add(this.mPropGrid),this.resize(0,0),this.emit("getCategories")}},MarketPanel.prototype.setSelect=function(){},MarketPanel.prototype.clearCategories=function(t){t&&(t.map((function(t){return t.destroy()})),t=void 0)},MarketPanel.prototype.onSelectCategoryHandler=function(t){if(this.mSubCategeoriesContainer){this.mSubCategorisScroll.setT(0),this.mPreSubCategoris=null,this.clearCategories(this.mSubTabs);var i=t.getData("category");if(this.mSelectedCategories=t,i){var o=i.subcategory;if(this.mSubCategorisScroll){this.mSubCategorisScroll.setItems(o),this.mSubCategorisScroll.layout();var r=this.mSubCategorisScroll.getCell(0);this.onSelectSubCategoryHandler(r.container)}}}},MarketPanel.prototype.onSelectSubCategoryHandler=function(t){if(this.mSelectedCategories&&t instanceof p.TextButton){var i=this.mSelectedCategories.getData("category");if(i){var o=t.getData("item");o&&(this.queryProp(i.category.key,o.key),this.mPreSubCategoris=o,this.mPreSubCategorisItem&&this.mPreSubCategorisItem.changeNormal(),t.changeDown(),this.mPreSubCategorisItem=t)}}},MarketPanel.prototype.queryProp=function(t,i){this.emit("queryProp",1,t,i)},MarketPanel.prototype.onSelectItemHandler=function(t){this.mSelectItem.setProp(t),this.mSelectItem.setData("propdata",t),this.emit("queryPropResource",t)},MarketPanel.prototype.onBuyItemHandler=function(t){var i=this,o=this.getBuyPackageData();o.count=t.quantity;var r=o,a=l.a.t("market.payment"),h=this.mSelectItem.getData("display"),c=new y.a(this,(function(){i.emit("buyItem",t)}),[t]);this.showPropFun({confirmHandler:c,data:r,resource:h,slider:!1,title:a})},MarketPanel.prototype.onCloseHandler=function(){this.emit("close")},MarketPanel.prototype.onPopItemCardHandler=function(t,i){t&&this.emit("popItemCard",t,i)},MarketPanel.prototype.getBuyPackageData=function(){var t=this.mSelectItem.getData("propdata"),i=c.op_client.CountablePackageItem.create();return i.id=t.id,i.sellingPrice=t.price[0],i.name=t.name,i.shortName=t.shortName,i},MarketPanel.prototype.showPropFun=function(t){this.mWorld.uiManager.showMed("PicPropFun",t)},MarketPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ElementDetail",(function(){return y}));var r,a=o(234),h=o(2),l=o(114),c=o(130),u=o(113),p=o(111),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function ElementDetail(i,o,r,h){var p=t.call(this,i)||this;p.key=r,p.mWorld=o,p.dpr=h,p.setPosition(0,0),p.mCounter=new a.NumberCounter(p.scene,r,360,700,p.dpr,o.uiScale);var m=p.scene.textures.getFrame(p.key,"yellow_button_normal"),y=60,g=65;m&&(y=m.width,g=m.height),p.mBuyBtn=new d.NineSliceButton(p.scene,440,700,81*p.dpr,41*p.dpr,p.key,"yellow_button",l.a.t("common.buy"),p.dpr,p.scale,{left:14*p.dpr,top:14*p.dpr,right:y-2-14*p.dpr,bottom:g-2-14*p.dpr}),p.mBuyBtn.setTextStyle({color:"#976400",fontSize:16*p.dpr,fontFamily:u.a.DEFULT_FONT}),p.mBuyBtn.setFontStyle("bold"),p.mBuyBtn.on(String(d.ClickEvent.Tap),p.onBuyHandler,p),p.mNickName=p.scene.make.text({x:7*p.dpr,y:9*p.dpr,style:{fontSize:12*p.dpr,fontFamily:u.a.DEFULT_FONT,color:"#FFFF00",align:"center"}}),p.mPriceContainer=p.scene.make.container(void 0,!1),p.mPriceIcon=p.scene.make.image({x:-78,key:p.key,frame:"iv_coin"},!1),p.mPriceText=p.scene.make.text({x:0,style:{fontSize:14*p.dpr,fontFamily:u.a.NUMBER}}).setOrigin(.5);var _=p.scene.make.image({key:p.key,frame:"price_bg"});p.mDetailDisplay=new c.DetailDisplay(p.scene),p.mDetailDisplay.scale=p.dpr,p.mDetailDisplay.y=110*p.dpr;var v=110*p.dpr,b=96*p.dpr;return p.mDetailBubble=p.scene.make.graphics(void 0,!1),p.mDetailBubble.fillStyle(16777215,.1),p.mDetailBubble.fillRoundedRect(0,0,v,b),p.mDetailBubbleContainer=p.scene.make.container(void 0,!1),p.mDetailBubbleContainer.setSize(v,b),p.mDesText=p.scene.make.text({x:8*p.dpr,y:56*p.dpr,style:{color:"#32347b",fontSize:10*p.dpr,fontFamily:u.a.DEFULT_FONT,wordWrap:{width:90*p.dpr,useAdvancedWrap:!0}}},!1),p.mSource=p.scene.make.text({x:8*p.dpr,y:38*p.dpr,style:{fontSize:10*p.dpr,fontFamily:u.a.DEFULT_FONT}},!1),p.add([p.mDetailDisplay,p.mPriceContainer,p.mCounter,p.mBuyBtn,p.mDetailBubbleContainer]),p.mDetailBubbleContainer.add([p.mDetailBubble,p.mNickName,p.mDesText,p.mSource]),p.mPriceContainer.add([_,p.mPriceIcon,p.mPriceText]),p.addActionListener(),p}return m(ElementDetail,t),ElementDetail.prototype.resize=function(t,i){var o=t,r=i/2-150,a=t/2;this.mBuyBtn.x=o-this.mBuyBtn.displayWidth/2-10*this.dpr,this.mBuyBtn.y=this.height-this.y-this.mBuyBtn.displayHeight/2-12*this.dpr;var h=this.mBuyBtn.x-this.mBuyBtn.displayWidth/2-this.mCounter.displayWidth/2-17*this.dpr;this.mCounter.x=h,this.mCounter.y=this.mBuyBtn.y,this.mDetailBubbleContainer.x=10*this.dpr;var l=o-(o-this.mCounter.x)-this.mCounter.width/2;if(this.mDetailBubbleContainer.displayWidth+this.mDetailBubbleContainer.x+10*this.dpr>l){var c=l-16*this.dpr;this.mDesText.setWordWrapWidth(c-10*this.dpr,!0),this.resizeDesBubble(c,this.mDetailBubbleContainer.height)}this.mPriceContainer.x=this.mCounter.x,this.mPriceContainer.y=this.mCounter.y-35*this.dpr,this.mDetailDisplay.x=a,this.mDetailDisplay.y=(this.height-this.y)/2;var u=.8*o,p=.7*r;this.setInteractive(new Phaser.Geom.Rectangle((o>>1)+(o-u>>1),r>>1,u,p),Phaser.Geom.Rectangle.Contains),this.mCounter.resize()},ElementDetail.prototype.addActionListener=function(){this.mCounter&&(this.mCounter.addActionListener(),this.mCounter.on("change",this.onChangeCounterHandler,this),this.on("pointerup",this.onPointerUpHandler,this))},ElementDetail.prototype.removeActionListener=function(){this.mCounter&&(this.mCounter.removeActionListener(),this.mCounter.off("change",this.onChangeCounterHandler,this),this.off("gameobjectup",this.onPointerUpHandler,this))},ElementDetail.prototype.setProp=function(t){this.mSelectedProp=t,this.mNickName.setText(t.shortName||t.name),this.mDesText.setText(t.des),t.price&&t.price.length>0?(this.mPriceIcon.setTexture(this.key,p.f.getIcon(t.price[0].coinType)),this.updatePrice(t.price[0].price.toString())):this.mPriceText.setText(""),t.source?this.mSource.setText("来源： "+t.source):this.mSource.setText(""),this.resizeDesBubble(),this.mCounter.setCounter(1)},ElementDetail.prototype.setResource=function(t){if(t.display)this.mDetailDisplay.loadDisplay(t);else if(t.avatar){var i=this.mWorld.roomManager.currentRoom.playerManager.actor.model.avatar;for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];r&&!t.avatar[o]&&(t.avatar[o]=r)}var a=new Phaser.Geom.Point(0,70);this.mDetailDisplay.loadAvatar(t,2,a)}else this.mDetailDisplay.loadUrl(this.mSelectedProp.icon)},ElementDetail.prototype.updatePrice=function(t){this.mPriceText.setText(t),this.mPriceIcon.x=this.mPriceText.x-this.mPriceText.width/2-16*this.dpr},ElementDetail.prototype.onBuyHandler=function(){if(this.mSelectedProp){var t=h.op_def.OrderCommodities.create();t.id=this.mSelectedProp.id,t.quantity=this.mCounter.number,t.category=this.mSelectedProp.category,this.emit("buyItem",t)}},ElementDetail.prototype.onChangeCounterHandler=function(t){this.mSelectedProp&&(!this.mSelectedProp.price||this.mSelectedProp.price.length<1||this.updatePrice((this.mSelectedProp.price[0].price*this.mCounter.number).toString()))},ElementDetail.prototype.onPointerUpHandler=function(){this.mCounter.setBlur()},ElementDetail.prototype.resizeDesBubble=function(t,i){void 0===t&&(t=this.mDetailBubbleContainer.width);var o=this.mDesText.height+60*this.dpr;t===this.mDetailBubbleContainer.width&&o===this.mDetailBubbleContainer.height||(this.mDetailBubble.clear(),this.mDetailBubble.fillStyle(16777215,.1),this.mDetailBubble.fillRoundedRect(0,0,t,o),this.mDetailBubbleContainer.setSize(t,o),this.mDetailBubbleContainer.y=this.height-this.y-this.mDetailBubbleContainer.height-6*this.dpr)},ElementDetail}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"NumberCounter",(function(){return l}));var r,a=o(149),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function NumberCounter(i,o,r,h,l,c){void 0===l&&(l=1),void 0===c&&(c=1);var u=t.call(this,i,r,h)||this;return u.pressDelay=500,u.mMinNum=1,u.mMaxNum=99,u.zoom=1,u.zoom=c,u.mBackground=u.scene.make.image({key:o,frame:"input_bg"}),u.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.mReduceBtn=u.scene.make.image({key:o,frame:"reduce"},!1).setInteractive(),u.mReduceBtn.x=-u.mBackground.displayWidth/2-u.mReduceBtn.displayWidth/2-7*l,u.mReduceBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.mIncreaseBtn=u.scene.make.image({key:o,frame:"increase"},!1).setInteractive(),u.mIncreaseBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.mIncreaseBtn.x=(u.mBackground.displayWidth+u.mIncreaseBtn.displayWidth)/2+7*l,u.mLabelInput=new a.LabelInput(u.scene,{x:0,y:0,width:u.mBackground.height,height:26*l,fontSize:14*l+"px",color:"#666666",align:"center",type:"number"}),u.mLabelInput.setOrigin(.5),u.mLabelInput.setText("1"),u.mLabelInput.on("textchange",u.onTextChangeHandler,u),u.mLabelInput.on("blur",u.onTextBlurHandler,u),u.mLabelInput.on("focus",u.onFocusHandler,u),u.add([u.mBackground,u.mLabelInput,u.mReduceBtn,u.mIncreaseBtn]),u.setSize(u.mIncreaseBtn.displayWidth+u.mReduceBtn.displayWidth+u.mBackground.displayWidth+14*l,u.mBackground.displayHeight),u}return h(NumberCounter,t),NumberCounter.prototype.resize=function(){},NumberCounter.prototype.setMinNumber=function(t){this.mMinNum=t},NumberCounter.prototype.setMaxNumber=function(t){this.mMaxNum=t},NumberCounter.prototype.addActionListener=function(){this.mIncreaseBtn.on("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.on("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.on("pointerup",this.onReduceHandler,this),this.mReduceBtn.on("pointerdown",this.onReduceDownHandler,this)},NumberCounter.prototype.removeActionListener=function(){this.mIncreaseBtn.off("pointerup",this.onIncreaseHandler,this),this.mIncreaseBtn.off("pointerdown",this.onIncreaseDownHandler,this),this.mReduceBtn.off("pointerup",this.onReduceHandler,this),this.mReduceBtn.off("pointerdown",this.onReduceDownHandler,this),this.scene.input.off("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.setCounter=function(t){(isNaN(t)||t<0)&&(t=0),t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t)},NumberCounter.prototype.setBlur=function(){this.mLabelInput.setBlur()},NumberCounter.prototype.destroy=function(){this.removeActionListener(),t.prototype.destroy.call(this)},Object.defineProperty(NumberCounter.prototype,"number",{get:function(){return parseInt(this.mLabelInput.text,10)},enumerable:!1,configurable:!0}),NumberCounter.prototype.onReduceHandler=function(){var t=parseInt(this.mLabelInput.text,10);--t<this.mMinNum&&(t=this.mMinNum),this.setCounter(t),this.clearTween()},NumberCounter.prototype.onIncreaseHandler=function(){var t=parseInt(this.mLabelInput.text,10);this.setCounter(++t),this.clearTween()},NumberCounter.prototype.onTextChangeHandler=function(){this.setCounter(parseInt(this.mLabelInput.text,10))},NumberCounter.prototype.onTextBlurHandler=function(){var t=parseInt(this.mLabelInput.text,0);t<this.mMinNum?t=this.mMinNum:t>this.mMaxNum&&(t=this.mMaxNum),this.mLabelInput.setText(t.toString()),this.emit("change",t),this.scene.input.off("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.onReduceDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMinNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.onIncreaseDownHandler=function(){var t=this;this.pressTimeout=setTimeout((function(){t.delayTweenNumber(t.mMaxNum)}),this.pressDelay),this.setBlur()},NumberCounter.prototype.delayTweenNumber=function(t){var i=this,o=this.number;this.tween=this.scene.tweens.addCounter({from:o,to:t,onUpdate:function(){i.setCounter(i.tween.getValue()>>0)},duration:50*Math.abs(o-t)})},NumberCounter.prototype.clearTween=function(){clearTimeout(this.pressTimeout),this.tween&&(this.tween.stop(),this.tween=void 0)},NumberCounter.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this,t)||this.mLabelInput.setBlur()},NumberCounter.prototype.onFocusHandler=function(){this.scene.input.on("pointerdown",this.pointerDownHandler,this)},NumberCounter.prototype.checkPointerInBounds=function(t,i,o){void 0===o&&(o=!1),this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0));var r=this.zoom?this.zoom:1;if(this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,i){var a=t.getWorldTransformMatrix(),h=(i.x-a.tx)/r,l=(i.y-a.ty)/r;return this.mRectangle.left<=h&&this.mRectangle.right>=h&&this.mRectangle.top<=l&&this.mRectangle.bottom>=l}return!1},NumberCounter}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"MarketItem",(function(){return p}));var r,a=o(116),h=o(111),l=o(113),c=o(0),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function MarketItem(i,o,r,h){var c=t.call(this,i,o,r)||this;c.dpr=h,c.mBackground=c.scene.make.image({key:"market",frame:"border"},!1).setOrigin(0),c.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mBorder=c.scene.make.image({x:3*h,y:3*h,key:"market",frame:"item_border"},!1).setOrigin(0),c.mBorder.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),c.mPropImage=new a.DynamicImage(i,0,0),c.mPropImage.scale=c.dpr,c.mNickName=c.scene.make.text({x:62*c.dpr,y:6*c.dpr,style:{fontSize:13*c.dpr,fontFamily:l.a.DEFULT_FONT,color:"#3399cc"}},!1),c.mCoinIcon=c.scene.make.image({x:45*c.dpr,y:40*c.dpr,key:"market"},!1).setOrigin(0);var u=c.scene.make.image({x:62*c.dpr,y:39*c.dpr,key:"market",frame:"price_border"},!1).setOrigin(0);return c.mPriceText=c.scene.make.text({x:92*c.dpr,y:49*c.dpr,style:{fontSize:13*c.dpr,fontFamily:l.a.NUMBER,color:"#996600"}}).setOrigin(.5),c.mTagIcon=c.scene.make.image({key:"market",frame:"tip_red",x:-86*c.dpr,y:-34*c.dpr},!1).setOrigin(0),c.add([c.mBackground,c.mBorder,c.mPropImage,c.mNickName,u,c.mCoinIcon,c.mPriceText]),c.setSize(c.mBackground.displayWidth,c.mBackground.displayHeight),c}return u(MarketItem,t),MarketItem.prototype.setProp=function(t){if(this.mProp=t,t.icon){var i=h.i.getOsdRes(t.icon);this.mPropImage.load(i,this,this.onPropLoadComplete)}else c.a.getInstance().error(t.name+" : "+t.id+" icon value is empty");this.mPropImage.x=this.mBorder.x+this.mBorder.displayWidth/2,this.mPropImage.y=this.mBorder.y+this.mBorder.displayHeight/2;var o=t.shortName||t.name;if(o.length>4)for(var r=50*this.dpr,a=4;a<o.length;a++){var l=o.slice(0,a);if(this.mNickName.setText(l).width>r){o=l+="...";break}}this.mNickName.setText(o),this.mPriceText.setText(t.price[0].price.toString());var u=h.f.getIcon(t.price[0].coinType);this.mCoinIcon.setFrame(u)},MarketItem.prototype.onPropLoadComplete=function(){if(this.mPropImage){var t=this.mPropImage.texture;t&&t.setFilter(Phaser.Textures.FilterMode.LINEAR)}},MarketItem.prototype.onPointerUpHandler=function(){this.emit("select",this.mProp)},MarketItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"Market",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Market(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Market,t),Market.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_GET_MARKET_CATEGORIES,this.onGetMarketCategoriesHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY,this.onQueryMarketHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE,this.onQueryCommodityResultHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MARKET_SHOW_MARKET_BY_NAME,this.openMarketPanel))},Market.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Market.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Market.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Market.prototype.setMarketName=function(t){this.market_name=t},Market.prototype.getMarkCategories=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_GET_CATEGORIES);t.content.marketName=this.market_name,this.connection.send(t)},Market.prototype.queryMarket=function(t,i,o){var r=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY),l=r.content;l.page=t,l.perPage=1e3,l.category=i,l.subcategory=o,l.marketName=this.market_name,this.connection.send(r)},Market.prototype.buyMarketCommodities=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_BUY_ORDER_COMMODITIES),o=i.content;o.orderCommodities=t,o.marketName=this.market_name,this.connection.send(i)},Market.prototype.queryCommodityResource=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_COMMODITY_RESOURCE),r=o.content;r.id=t,r.category=i,r.marketName=this.market_name,this.connection.send(o)},Market.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Market.prototype.onGetMarketCategoriesHandler=function(t){this.mEvent.emit("getMarketCategories",t.content)},Market.prototype.onQueryMarketHandler=function(t){this.mEvent.emit("queryMarket",t.content)},Market.prototype.onQueryCommodityResultHandler=function(t){t.content;t.content.market_name=this.market_name,this.mEvent.emit("queryCommodityResource",t.content)},Market.prototype.openMarketPanel=function(t){var i=t.content;this.mEvent.emit("showopen",i)},Object.defineProperty(Market.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Market}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaMainUIMediator",(function(){return u}));var r,a=o(238),h=o(240),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicaMainUIMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.world=r,a.mainUI=new h.PicaMainUI(r),a.mainUI.on("updateplayer",a.onUpdatePlayerHandler,a),a.mainUI.on("updateroom",a.onUpdateRoomHandler,a),a}return c(PicaMainUIMediator,t),PicaMainUIMediator.prototype.show=function(t){this.mView?this.update(t):(this.mView||(this.mView=new a.PicaMainUIPanel(this.scene,this.world),this.mView.on("showPanel",this.onShowPanelHandler,this),this.mView.on("openroompanel",this.onOpenRoomHandler,this),this.mView.on("querypraise",this.onQuery_PRAISE_ROOM,this)),this.mView.show(t),this.layerManager.addToUILayer(this.mView),this.onUpdateHandler())},PicaMainUIMediator.prototype.destroy=function(){this.mainUI&&this.mainUI.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(PicaMainUIMediator.prototype,"playerInfo",{get:function(){return this.mPlayerInfo},enumerable:!1,configurable:!0}),Object.defineProperty(PicaMainUIMediator.prototype,"roomInfo",{get:function(){return this.mRoomInfo},enumerable:!1,configurable:!0}),Object.defineProperty(PicaMainUIMediator.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,i=this.roomInfo.roomId,o=0,r=t;o<r.length;o++){if(r[o].roomId===i)return!0}return!1},enumerable:!1,configurable:!0}),PicaMainUIMediator.prototype.onOpenRoomHandler=function(){!this.roomInfo||"room"!==this.roomInfo.roomType&&"store"!==this.roomInfo.roomType||this.world.uiManager.showMed("PicHouse")},PicaMainUIMediator.prototype.onUpdateHandler=function(){this.mPlayerInfo&&this.mView.updatePlayerInfo(this.mPlayerInfo),this.mRoomInfo&&this.mView.updateRoomInfo(this.mRoomInfo)},PicaMainUIMediator.prototype.onUpdatePlayerHandler=function(t){if(this.mPlayerInfo){for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];void 0!==o&&(o instanceof Array?o.length>0&&(this.mPlayerInfo[i]=o):this.mPlayerInfo[i]=o)}}else this.mPlayerInfo=t;this.mView&&this.mView.updatePlayerInfo(t)},PicaMainUIMediator.prototype.onUpdateRoomHandler=function(t){this.mRoomInfo=t,this.mView&&this.mView.updateRoomInfo(t)},PicaMainUIMediator.prototype.onShowPanelHandler=function(t,i){this.mainUI&&this.world&&(this.world.uiManager.showMed(t),"CharacterInfo"===t&&this.mainUI.fetchPlayerInfo())},PicaMainUIMediator.prototype.onQuery_PRAISE_ROOM=function(t){if(this.roomInfo&&("room"===this.roomInfo.roomType||"store"===this.roomInfo.roomType)){var i=this.mRoomInfo.roomId;this.mainUI.query_PRAISE_ROOM(i,t)}},PicaMainUIMediator.NAME="PicaMainUIMediator",PicaMainUIMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaMainUIPanel",(function(){return g}));var r,a=o(112),h=o(113),l=o(0),c=o(239),u=o(2),p=o(115),d=o(114),m=o(109),y=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),g=function(t){function PicaMainUIPanel(i,o){var r=t.call(this,i,o)||this;return r.key="main_ui",r.isSceneNameActive=!1,r}return y(PicaMainUIPanel,t),PicaMainUIPanel.prototype.show=function(i){t.prototype.show.call(this,i),this.mInitialized&&(this.setInteractive(),this.update(this.mShowData),this.checkUpdateActive())},PicaMainUIPanel.prototype.resize=function(i,o){var r=this.scene.cameras.main.width/this.scale,a=this.scene.cameras.main.height/this.scale;t.prototype.resize.call(this,r,a),this.mCoinValue.x=r-this.mCoinValue.width/2-5*this.dpr,this.mDiamondValue.x=r-this.mDiamondValue.width/2-5*this.dpr},PicaMainUIPanel.prototype.preload=function(){this.addAtlas(this.key,"main_ui/mainui.png","main_ui/mainui.json"),this.addAtlas(p.UIAtlasKey.commonKey,p.UIAtlasName.commonUrl+".png",p.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},PicaMainUIPanel.prototype.addListen=function(){this.mInitialized&&(this.roomCon?this.roomCon.on("pointerup",this.onOpenRoomPanel,this):l.a.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.removeListen=function(){this.mInitialized&&(this.roomCon?this.roomCon.off("pointerup",this.onOpenRoomPanel,this):l.a.getInstance().fatal(PicaMainUIPanel.name+": sceneName does not exist!"))},PicaMainUIPanel.prototype.update=function(i){var o;t.prototype.update.call(this),i&&i.length>0&&(o=i[0]),o&&(o instanceof u.op_client.OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_PLAYER_INFO?this.playerInfo=o:this.roomInfo=o),this.playerInfo&&this.updatePlayerInfo(this.playerInfo),this.roomInfo&&this.updateRoomInfo(this.roomInfo)},PicaMainUIPanel.prototype.updatePlayerInfo=function(t){if(this.playerInfo=t,this.mInitialized){if(t.level){var i=t.level;void 0===i.currentLevelExp||i.currentLevelExp;this.playerLv.text=i.level+""}if(void 0!==t.coin&&this.mCoinValue.setText(t.coin.toString()),void 0!==t.diamond&&this.mDiamondValue.setText(t.diamond.toString()),t.energy){var o=t.energy;o?this.mStrengthValue.setValue(o.currentValue,o.max):this.mStrengthValue.setValue(0,100)}this.mSceneName.rightIcon.visible=this.isSelfRoom}},PicaMainUIPanel.prototype.updateRoomInfo=function(t){this.roomInfo=t,this.mInitialized&&(t.name&&(this.mSceneName.setText(t.name),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive(),this.isSceneNameActive=!0),t.playerCount&&(this.mCounter.setText(""+t.playerCount),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr),this.praiseBtn.visible=!1,t.roomType&&("room"!==t.roomType&&"store"!==t.roomType||(this.praiseBtn.visible=!0),this.praiseBtn.setText(t.praise+""),this.praiseBtn.selected=t.hasPraised,t.hasPraised?(this.praiseBtn.setTextColor("#8E99C1"),this.praiseImg.setFrame("praise_after")):(this.praiseBtn.setTextColor("#ffffff"),this.praiseImg.setFrame("praise_before"))),this.mSceneName.rightIcon.visible=this.isSelfRoom)},Object.defineProperty(PicaMainUIPanel.prototype,"isSelfRoom",{get:function(){if(!this.playerInfo||!this.roomInfo)return!1;for(var t=this.playerInfo.rooms,i=this.roomInfo.roomId,o=0,r=t;o<r.length;o++){if(r[o].roomId===i)return!0}return!1},enumerable:!1,configurable:!0}),PicaMainUIPanel.prototype.updateUIState=function(t){this.mInitialized&&("mainui.playerinfo"===t.name&&(this.playerCon.visible=t.visible),"mainui.roominfo"===t.name&&(this.roomCon.visible=t.visible),"mainui.headbtn"===t.name&&(t.disabled?this.playerIcon.removeInteractive():this.playerIcon.setInteractive()),"mainui.entereditorbtn"===t.name&&(this.mSceneName.visible=t.visible,this.isSceneNameActive&&(t.disabled?this.roomCon.removeInteractive():(this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.roomCon.setInteractive()))))},PicaMainUIPanel.prototype.init=function(){var i=this.scene.cameras.main.width,o=this.scene.cameras.main.height;this.playerCon=this.scene.make.container(void 0,!1),this.playerCon.y=25*this.dpr,this.add(this.playerCon),this.mCoinValue=new _(this.scene,this.key,"coin",this.dpr),this.mDiamondValue=new _(this.scene,this.key,"diamond",this.dpr),this.mDiamondValue.y=35*this.dpr;var r=this.scene.textures.getFrame(this.key,"strength_progress");this.mStrengthValue=new P(this.scene,this.key,"strength_icon",this.dpr),this.mStrengthValue.x=76*this.dpr;var a=new m.NineSlicePatch(this.scene,68*this.dpr/2,this.mStrengthValue.height/2-r.height-1*this.dpr,92*this.dpr,r.height,this.key,"strength_progress",{left:8*this.dpr,top:3*this.dpr,right:r.width-2-8*this.dpr,bottom:r.height-1-3*this.dpr});this.mStrengthValue.setProgress(a,this.scale),this.playerIcon=this.scene.make.image({key:this.key,frame:"head"}),this.playerIcon.x=.5*-this.mStrengthValue.width-8*this.dpr,this.mStrengthValue.add(this.playerIcon),this.playerIcon.on("pointerup",this.onHeadHandler,this),this.playerIcon.setInteractive(),this.mStrengthValue.setValue(1e3,1e3),this.mStrengthValue.setInteractive(),this.mStrengthValue.on("pointerup",this.onStrengthHandler,this);var l=this.playerIcon.x+.5*this.playerIcon.width-2*this.dpr,u=this.playerIcon.y+.5*this.playerIcon.height-10*this.dpr;this.playerLv=this.scene.make.text({text:"0",x:l,y:u,style:{fontSize:11*this.dpr,bold:!0,fontFamily:h.a.DEFULT_FONT,color:"#356EE3"}},!1).setOrigin(1,0),this.playerLv.setShadow(0,0,"#ffffff",2),this.playerLv.setStroke("#356EE3",2),this.playerLv.setShadowStroke(!0),this.mStrengthValue.add(this.playerLv),this.playerCon.add([this.mStrengthValue,this.mCoinValue,this.mDiamondValue]),this.roomCon=this.scene.make.container(void 0,!1),this.roomCon.y=this.playerCon.y+32*this.dpr,this.add(this.roomCon),this.mSceneName=new b(this.scene,this.key,"room_icon","setting_icon",this.dpr),this.mSceneName.setText(""),this.mSceneName.x=18*this.dpr,this.mCounter=new v(this.scene,p.UIAtlasKey.commonKey,"home_persons",this.dpr),this.mCounter.setText(""),this.mCounter.x=this.mSceneName.x+this.mSceneName.rightbound+5*this.dpr,this.mCounter.y=this.mSceneName.y,this.mCounter.setColor("#28D5F5"),this.textToolTip=new c.TextToolTips(this.scene,p.UIAtlasKey.commonKey,"tips_bg",this.dpr,this.scale),this.textToolTip.setSize(160*this.dpr,45).visible=!1,this.praiseBtn=new m.CheckBox(this.scene,this.key,"praise_before_bg","praise_after_bg","1"),this.praiseBtn.y=this.mSceneName.y+this.mSceneName.height+.5*this.praiseBtn.height+20*this.dpr,this.praiseBtn.x=8*this.dpr+.5*this.praiseBtn.width,this.praiseBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.a.DEFULT_FONT}),this.praiseBtn.setTextOffset(10*this.dpr,0),this.praiseBtn.on(String(m.ClickEvent.Tap),this.onPraiseHandler,this),this.praiseImg=this.scene.make.image({key:this.key,frame:"praise_before"}),this.praiseImg.x=-10*this.dpr,this.praiseBtn.add(this.praiseImg),this.partyBtn=new m.Button(this.scene,this.key,"home_party_bg","home_party_bg",d.a.t("main_ui.party")),this.partyBtn.x=this.praiseBtn.x+.5*this.praiseBtn.width+.5*this.partyBtn.width+5*this.dpr,this.partyBtn.y=this.praiseBtn.y,this.partyBtn.setTextOffset(8*this.dpr,0),this.partyBtn.setTextStyle({fontSize:11*this.dpr,fontFamily:h.a.DEFULT_FONT}),this.partyBtn.on(String(m.ClickEvent.Tap),this.onPartyHandler,this),this.roomCon.add([this.mSceneName,this.mCounter,this.praiseBtn,this.partyBtn,this.textToolTip]),this.roomCon.setSize(2*this.mSceneName.rightbound,30*this.dpr),this.resize(i,o),t.prototype.init.call(this)},PicaMainUIPanel.prototype.onOpenRoomPanel=function(){this.emit("openroompanel")},PicaMainUIPanel.prototype.onHeadHandler=function(){this.emit("showPanel","CharacterInfo")},PicaMainUIPanel.prototype.onStrengthHandler=function(){if(this.playerInfo){var t=this.playerInfo.energy,i=t.currentValue+"/"+t.max+"\n",o=d.a.t("main_ui.energy_tips",{name:i,interpolation:{escapeValue:!1}});this.textToolTip.setTextData(o,3e3),this.textToolTip.setPosition(120*this.dpr,20*this.dpr)}},PicaMainUIPanel.prototype.checkUpdateActive=function(){var t=this.mWorld.uiManager.getActiveUIData("PicaMainUI");if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.updateUIState(r)}},PicaMainUIPanel.prototype.onPraiseHandler=function(t,i){this.emit("querypraise",i.selected)},PicaMainUIPanel.prototype.onPartyHandler=function(){this.emit("showPanel","PicOpenParty")},PicaMainUIPanel}(a.BasePanel),_=function(t){function ValueContainer(i,o,r,a){void 0===a&&(a=1);var h=t.call(this,i)||this;return h.init(o,r,a),h}return y(ValueContainer,t),ValueContainer.prototype.setText=function(t){this.mText.setText(t)},ValueContainer.prototype.init=function(t,i,o){var r=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);this.mLeft=this.scene.make.image({key:t,frame:i},!1),this.mText=this.scene.make.text({text:"0",width:r.width,height:r.height,style:{fontSize:14*o,fontFamily:h.a.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*o),this.mAddBtn=this.scene.make.image({key:t,frame:"add_btn"}),this.setSize(r.width,r.height),this.mLeft.x=.5*-r.width,this.mLeft.y=r.y+.5*r.height-.5*this.mLeft.height,this.mAddBtn.x=this.width*this.originX-this.mAddBtn.width*this.originX-5*o,this.mText.x=10*o,this.add([r,this.mLeft,this.mText,this.mAddBtn])},ValueContainer}(Phaser.GameObjects.Container),v=function(t){function IconText(i,o,r,a){void 0===a&&(a=1);var l=t.call(this,i)||this,c=i.make.image({key:o,frame:r},!1);return l.mText=i.make.text({style:{fontSize:14*a,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,.5),l.mText.x=c.width/2+4*a,l.mText.setStroke("#000000",2*a),l.add([c,l.mText]),l}return y(IconText,t),IconText.prototype.setText=function(t){this.mText.setText(t)},IconText.prototype.setStroke=function(t,i){this.mText.setStroke(t,i)},IconText.prototype.setColor=function(t){this.mText.setColor(t)},IconText}(Phaser.GameObjects.Container),b=function(t){function SceneName(i,o,r,a,h){void 0===h&&(h=1);var l=t.call(this,i,o,r,h)||this;return l.mDpr=h,l.mRightIcon=i.make.image({y:2*h,key:o,frame:a},!1),l.add(l.mRightIcon),l.mRightIcon.y=8*h,l.mRightIcon.x=10*h,l}return y(SceneName,t),SceneName.prototype.setText=function(i){t.prototype.setText.call(this,i)},Object.defineProperty(SceneName.prototype,"rightbound",{get:function(){return this.mText.x+this.mText.width+10*this.mDpr},enumerable:!1,configurable:!0}),Object.defineProperty(SceneName.prototype,"rightIcon",{get:function(){return this.mRightIcon},enumerable:!1,configurable:!0}),SceneName}(v),P=(function(t){function ExpProgress(i,o,r,a,l){var c=t.call(this,i)||this,u=l.getSize().width/a,p=c.scene.textures.getFrame(o,"exp_bg");c.setSize(u,p.height);var d=c.width,y=c.height;c.mProgressBar=new w(i,r),c.mProgressBar.setSize(c.width,c.height);var g=new m.NineSlicePatch(c.scene,d/2,y/2,d,y,o,"exp_bg",{left:8*r,top:3*r,right:p.width-2-8*r,bottom:p.height-1-3*r});c.mProgressBar.setBackground(g),p=c.scene.textures.getFrame(o,"exp_progress");var _=new m.NineSlicePatch(c.scene,d/2,y/2,u,p.height,o,"exp_progress",{left:8*r,top:3*r,right:p.width-2-10*r,bottom:p.height-1-5*r});return c.mProgressBar.setProgress(_,a),c.mProgressBar.setRatio(.5),c.mCurrentLv=i.make.text({text:"57",style:{fontSize:10*r,fontFamily:h.a.DEFULT_FONT}},!1),c.mCurrentLv.setStroke("#000000",1*r),c.mNextLv=i.make.text({text:"58",style:{fontSize:10*r,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,0),c.mNextLv.setStroke("#000000",1*r),c.mNextLv.x=c.width-c.mNextLv.width,c.add([c.mProgressBar,c.mCurrentLv,c.mNextLv]),c}y(ExpProgress,t),ExpProgress.prototype.setLv=function(t,i){this.mCurrentLv.setText(t.toString()),this.mNextLv.setText((t+1).toString()),this.mNextLv.x=this.width-this.mNextLv.width,this.mProgressBar.setRatio(i)}}(Phaser.GameObjects.Container),function(t){function ProgressValue(i,o,r,a){return t.call(this,i,o,r,a)||this}return y(ProgressValue,t),ProgressValue.prototype.setProgress=function(t,i){this.mProgress.setProgress(t,i)},ProgressValue.prototype.setValue=function(t,i){this.mText&&(this.mText.text=t+"/"+i,this.mProgress.setRatio(t/i))},ProgressValue.prototype.setInteractive=function(i){return i=i||new Phaser.Geom.Rectangle(0,0,this.width,this.height),t.prototype.setInteractive.call(this,i,Phaser.Geom.Rectangle.Contains),this},ProgressValue.prototype.init=function(t,i,o){var r=this.scene.make.image({key:t,frame:"home_progress_bottom"},!1);this.setSize(r.width,r.height),this.mLeft=this.scene.make.image({key:t,frame:i},!1),this.mProgress=new w(this.scene,o),this.mProgress.x=-this.width/2+10*o,this.mProgress.y=4*o,this.mText=this.scene.make.text({text:"0",width:r.width,height:r.height,style:{fontSize:10*o,fontFamily:h.a.NUMBER}},!1).setOrigin(.5),this.mText.setStroke("#000000",1*o),this.mAddBtn=this.scene.make.image({key:t,frame:"add_btn"}),this.setSize(r.width,r.height),this.mLeft.x=-this.width*this.originX+13*o,this.mAddBtn.x=this.width*this.originX-10*o,this.add([r,this.mProgress,this.mLeft,this.mText,this.mAddBtn])},ProgressValue}(_)),w=function(t){function ProgressBar(i,o){var r=t.call(this,i)||this;return r.dpr=o,r}return y(ProgressBar,t),ProgressBar.prototype.setBackground=function(t){this.addAt(t,0)},ProgressBar.prototype.setProgress=function(t,i){this.mScale=i,this.mProgress=t,this.add(this.mProgress),this.setSize(t.width*this.mScale,t.height*this.mScale);var o=t.getWorldTransformMatrix();this.worldpos=new Phaser.Geom.Point(o.tx,o.ty),this.mMaskGraphics=this.scene.make.graphics(void 0,!1),this.mMaskGraphics.fillStyle(16750848),this.mMaskGraphics.fillRect(0,0,this.width,this.height+8*this.dpr),this.mProgress.mask=new Phaser.Display.Masks.GeometryMask(this.scene,this.mMaskGraphics),this.mMaskGraphics.y=o.ty+this.height+4*this.dpr,this.mMaskGraphics.x=o.tx},ProgressBar.prototype.setRatio=function(t){this.mMaskGraphics&&(this.mMaskGraphics.x=this.worldpos.x+4*this.dpr-.5*this.mProgress.width+(this.width*t-this.width))},ProgressBar}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"TextToolTips",(function(){return u}));var r,a=o(117),h=o(113),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function TextToolTips(i,o,r,c,u){var p=t.call(this,i)||this,d=i.textures.getFrame(o,r),m=d.width,y=d.height;return p.dpr=c,p.bg=new a.NinePatch(p.scene,0,0,m,y,o,r,{left:20*c,top:20*c,right:20*c,bottom:20*c}),p.text=new l.BBCodeText(p.scene,0,0,"蓝矿石",{color:"#333333",fontSize:13*p.dpr,fontFamily:h.a.DEFULT_FONT,wrap:{width:90*p.dpr,mode:"string"}}).setOrigin(0),p.add([p.bg,p.text]),p.setSize(m+20*c,y+20*c),p}return c(TextToolTips,t),TextToolTips.prototype.setSize=function(i,o){t.prototype.setSize.call(this,i,o),this.bg.resize(i,o),this.bg.setPosition(0,0);var r=i-16*this.dpr,a=o-16*this.dpr;return this.text.setSize(r,a),this.text.setWrapWidth(r),this.text.setPosition(.5*-r,.5*-a),this},TextToolTips.prototype.setText=function(t){this.text.text=t,this.text.height>this.height&&this.setSize(this.width,this.text.height+16*this.dpr)},TextToolTips.prototype.setTextData=function(t,i){var o=this;this.visible=!0,this.setText(t),this.timeID&&clearTimeout(this.timeID),this.timeID=setTimeout((function(){o.visible=!1}),i)},TextToolTips}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaMainUI",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicaMainUI(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o.register(),o}return l(PicaMainUI,t),PicaMainUI.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicaMainUI.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicaMainUI.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_PLAYER_INFO,this.onUpdatePlayerInfo),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_INFO,this.onUpdateModeRoomInfo))},PicaMainUI.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicaMainUI.prototype.destroy=function(){this.unregister()},PicaMainUI.prototype.query_PRAISE_ROOM=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_PRAISE_ROOM),r=o.content;r.roomId=t,r.praise=i,this.connection.send(o)},PicaMainUI.prototype.fetchPlayerInfo=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SELF_PLAYER_INFO);this.connection.send(t)},PicaMainUI.prototype.onUpdatePlayerInfo=function(t){this.mEvent.emit("updateplayer",t.content)},PicaMainUI.prototype.onUpdateModeRoomInfo=function(t){this.mEvent.emit("updateroom",t.content)},Object.defineProperty(PicaMainUI.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicaMainUI}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFurniFunMediator",(function(){return p}));var r,a=o(2),h=o(242),l=o(243),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicFurniFunMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a.picFurni||(a.picFurni=new l.PicFurniFun(a.world),a.picFurni.register(),a.picFurni.on("openview",a.onOpenView,a)),a}return u(PicFurniFunMediator,t),PicFurniFunMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new h.PicFurniFunPanel(this.scene,this.world),this.mView.on("close",this.onCloseHandler,this),this.mView.on("queryunlock",this.queryUnlockElement,this)),this.mView.show(this.mParam)),this.layerManager.addToUILayer(this.mView)},PicFurniFunMediator.prototype.getView=function(){return this.mView},PicFurniFunMediator.prototype.destroy=function(){this.picFurni&&this.picFurni.destroy(),t.prototype.destroy.call(this)},Object.defineProperty(PicFurniFunMediator.prototype,"playerData",{get:function(){var t=this.world.user;if(t&&t.bag)return t.bag.playerData},enumerable:!1,configurable:!0}),PicFurniFunMediator.prototype.onCloseHandler=function(){t.prototype.destroy.call(this)},PicFurniFunMediator.prototype.onOpenView=function(t){t.materials&&this.updateMaterials(t.materials),this.setParam(t),this.show()},PicFurniFunMediator.prototype.queryUnlockElement=function(t){this.picFurni.queryUnlockElement(t)},PicFurniFunMediator.prototype.updateMaterials=function(t){if(this.playerData&&t)for(var i=0,o=t;i<o.length;i++){var r=o[i],h=this.playerData.getItemsCount(a.op_pkt_def.PKT_PackageType.PropPackage,r.id,r.subcategory);r.count=h}},PicFurniFunMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFurniFunPanel",(function(){return v}));var r,a=o(113),h=o(116),l=o(2),c=o(112),u=o(111),p=o(114),d=o(115),m=o(130),y=o(109),g=o(129),_=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),v=function(t){function PicFurniFunPanel(i,o){var r=t.call(this,i,o)||this;return r.key="furni_unlock",r}return _(PicFurniFunPanel,t),PicFurniFunPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,r,a),this.content.x=Math.floor(r/2),this.content.y=Math.floor(a/2),this.setSize(r*this.scale,a*this.scale),this.materialGameScroll.refreshMask()},PicFurniFunPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.updateData()):this.preload())},PicFurniFunPanel.prototype.addListen=function(){this.mInitialized&&(this.confirmBtn.on("Tap",this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this))},PicFurniFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.confirmBtn.off("click",this.onConfirmBtnClick,this),this.closeBtn.on("pointerup",this.OnClosePanel,this))},PicFurniFunPanel.prototype.preload=function(){this.addAtlas(this.key,"furni_unlock/furni_unlock.png","furni_unlock/furni_unlock.json"),this.addAtlas(d.UIAtlasKey.commonKey,d.UIAtlasName.commonUrl+".png",d.UIAtlasName.commonUrl+".json"),this.addAtlas(d.UIAtlasKey.common2Key,d.UIAtlasName.common2Url+".png",d.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicFurniFunPanel.prototype.init=function(){var i=this,o=this.cameraWidth,r=this.cameraHeight;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,o/this.scale,r/this.scale),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var h=295*this.dpr,l=400*this.dpr;this.content.setSize(h,l),this.add(this.content),this.bg=new y.NineSlicePatch(this.scene,0,0,h,l,d.UIAtlasKey.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:40*this.dpr}),this.content.add(this.bg);var c=.5*-this.bg.height;this.titleimage=this.scene.make.image({x:0,y:c+5*this.dpr,key:d.UIAtlasKey.common2Key,frame:"title"},!1),this.titleName=this.scene.make.text({x:0,y:this.titleimage.y+2*this.dpr,text:p.a.t("furni_unlock.title"),style:{color:"#905B06",fontFamily:a.a.EN_BOLD,bold:!0,fontSize:16*this.dpr}}).setOrigin(.5,.5).setStroke("#905B06",2),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:c+5*this.dpr,key:d.UIAtlasKey.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.content.add([this.titleimage,this.titleName,this.closeBtn]),this.itemName=this.scene.make.text({x:0,y:this.titleimage.y+.5*this.titleimage.height+13*this.dpr,text:"",style:{color:"#FFC51A",fontFamily:a.a.DEFULT_FONT,bold:!0,fontSize:14*this.dpr}}).setStroke("#FFC51A",4).setShadow(0,0,"#000000",2,!0).setOrigin(.5),this.content.add(this.itemName),this.bgicon=this.scene.make.image({key:this.key,frame:"bg_f"}),this.bgicon.y=this.itemName.y+.5*this.bgicon.height+13*this.dpr,this.content.add([this.bg,this.bgicon]),this.mDetailDisplay=new m.DetailDisplay(this.scene),this.mDetailDisplay.setTexture(this.key,"bg_f"),this.mDetailDisplay.y=this.bgicon.y,this.mDetailDisplay.scale=this.dpr/this.scale,this.mDetailDisplay.setSize(72*this.dpr,72*this.dpr),this.content.add(this.mDetailDisplay);var u=360*this.dpr,_=92*this.dpr;this.materialCon=this.scene.make.container(void 0,!1).setSize(u,_),this.content.add(this.materialCon),this.materialCon.setPosition(0,-c-.5*_-66*this.dpr);var v=this.scene.make.text({x:0,y:.5*-_+12*this.dpr,text:p.a.t("furni_unlock.needMaterials"),style:{color:"#253FCA",fontSize:12*this.dpr,fontFamily:a.a.DEFULT_FONT}},!1).setOrigin(.5),b=this.scene.make.image({key:this.key,frame:"sourcelist_title"}),P=this.scene.make.image({key:this.key,frame:"sourcelist_title"}),w=.5*-v.width-.5*b.width-10*this.dpr;b.setPosition(w,v.y),P.setPosition(-w,v.y).rotation=-Math.PI,this.materialCon.add([v,b,P]),this.materialGameScroll=new y.GameScroller(this.scene,{x:0,y:2*this.dpr,width:240*this.dpr,height:90*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:void 0,cellupCallBack:function(t){i.onMaterialItemHandler(t)}}),this.materialCon.add(this.materialGameScroll);var S=145*this.dpr,C=55*this.dpr;this.itemtips=new g.ItemInfoTips(this.scene,S,C,d.UIAtlasKey.common2Key,"tips_bg",this.dpr,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.itemtips.x=.5*-this.width+.5*S+10*this.dpr,this.itemtips.y=.5*-this.height+70*this.dpr,this.itemtips.visible=!1,this.content.add(this.itemtips),this.confirmBtn=new y.NineSliceButton(this.scene,0,-c-35*this.dpr,100*this.dpr,40*this.dpr,d.UIAtlasKey.commonKey,"yellow_btn_over",p.a.t("furni_unlock.unlock"),this.dpr,this.scale,{left:15*this.dpr,top:15*this.dpr,right:15*this.dpr,bottom:15*this.dpr}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:12*this.dpr,fontFamily:a.a.BOLD_FONT,bold:!0,stroke:"#976400",strokeThickness:2}),this.confirmBtn.setTextOffset(10*this.dpr,0);var T=this.scene.make.image({key:this.key,frame:"repair_icon"});T.x=-28*this.dpr,this.confirmBtn.add(T),this.content.add(this.confirmBtn),this.resize(0,0),t.prototype.init.call(this)},PicFurniFunPanel.prototype.destroy=function(){this.confirmBtn&&this.confirmBtn.destroy(),this.confirmBtn=null,t.prototype.destroy.call(this)},PicFurniFunPanel.prototype.updateData=function(){var t=this.mShowData;if(t.ids){var i=this.mWorld.roomManager.currentRoom.elementManager.get(t.ids[0]);if(i){var o=i.model.displayInfo,r=new l.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE;r.display=o.display;var a=o.createProtocolObject();if(a.length>1){for(var h=[],c=0,u=a;c<u.length;c++){var p=u[c];"lock"!==p.node.name&&(p.frameName=p.layer[0].frameName,h.push(p))}0===h.length&&h.push(a[0]),r.animations=h}else r.animations=a;this.mDetailDisplay.loadDisplay(r),this.itemName.text=i.model.nickname,this.setMaterialItems(t.materials)}}},PicFurniFunPanel.prototype.setMaterialItems=function(t){var i=t.length;this.materialGameScroll.clearItems();for(var o=0;o<i;o++){var r=new b(this.scene,this.key,this.dpr);r.y=0,r.setItemData(t[o]),r.setData("itemData",t[o]),this.materialGameScroll.addItem(r)}this.materialGameScroll.Sort()},PicFurniFunPanel.prototype.onConfirmBtnClick=function(){var t=this.showData;t&&t.ids&&(this.emit("queryunlock",t.ids),this.emit("close"))},PicFurniFunPanel.prototype.OnClosePanel=function(){this.emit("close")},PicFurniFunPanel.prototype.onMaterialItemHandler=function(t){this.itemtips.visible=!1,this.selectMaterial&&this.selectMaterial!==t&&(this.selectMaterial.select=!1),t.select=!t.select,t.select&&(this.itemtips.setItemData(t.itemData),this.itemtips.visible=!0),this.selectMaterial=t,this.setTipsPosition(t)},PicFurniFunPanel.prototype.setTipsPosition=function(t){for(var i=t.x,o=t.y,r=t;r.parentContainer!==this.content;)i+=r.parentContainer.x,o+=r.parentContainer.y,r=r.parentContainer;i-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:i+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=i,this.itemtips.y=o-.5*this.itemtips.height+5*this.dpr},PicFurniFunPanel}(c.BasePanel),b=function(t){function MaterialItem(i,o,r){var l=t.call(this,i)||this;return l.mselect=!1,l.dpr=r,l.key=o,l.bg=l.scene.make.image({key:l.key,frame:"bg_m"}),l.itemIcon=new h.DynamicImage(i,0,0),l.itemCount=new y.BBCodeText(l.scene,0,15*r,"10/20",{color:"#000000"}).setOrigin(.5).setFontSize(11*r).setFontFamily(a.a.DEFULT_FONT),l.add([l.bg,l.itemIcon,l.itemCount]),l.setSize(l.bg.width,l.bg.height),l.itemCount.y=.5*l.height+8*r,l}return _(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var i=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var o=u.i.getOsdRes(t.display.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.scale=i.dpr,i.itemIcon.setPosition(0,0)}))},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.bg.setFrame(t?"bg_select":"bg_m"),this.mselect=t},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t,i){var o=t>=i?"#000000":"#ff0000";return"[stroke="+o+"][color="+o+"]"+t+"[/color][/stroke]/"+i},MaterialItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFurniFun",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicFurniFun(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicFurniFun,t),PicFurniFun.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_UNLOCK_ELEMENT_REQUIREMENT,this.onRetOpenPanel))},PicFurniFun.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicFurniFun.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicFurniFun.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicFurniFun.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},PicFurniFun.prototype.queryUnlockElement=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_UNLOCK_ELEMENT);i.content.ids=t,this.connection.send(i)},PicFurniFun.prototype.onRetOpenPanel=function(t){var i=t.content;this.mEvent.emit("openview",i)},Object.defineProperty(PicFurniFun.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicFurniFun}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHandheld",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicHandheld(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicHandheld,t),PicHandheld.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_HANDHELD,this.onRetHandheldList))},PicHandheld.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicHandheld.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicHandheld.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicHandheld.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicHandheld.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicHandheld.prototype.queryChangeHandheld=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_PICK_HANDHELD);i.content.id=t,this.connection.send(i)},PicHandheld.prototype.queryClearHandheld=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_DROP_HANDHELD);this.connection.send(t)},PicHandheld.prototype.queryHandheldList=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_HANDHELD);this.connection.send(t)},PicHandheld.prototype.onRetHandheldList=function(t){var i=t.content;this.mEvent.emit("handheldlist",i)},PicHandheld}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHandheldPanel",(function(){return m}));var r,a=o(112),h=o(2),l=o(116),c=o(120),u=o(111),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function PicHandheldPanel(i,o){var r=t.call(this,i,o)||this;return r.key="pichandheldpanel",r.isExtendsGrid=!1,r}return d(PicHandheldPanel,t),PicHandheldPanel.prototype.resize=function(t,i){this.scale;var o=this.scaleWidth,r=this.scaleHeight;this.setSize(o,r),this.updateLayout(),this.isExtendsGrid=!1},PicHandheldPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData(),this.emit("handheldlist")):this.preload())},PicHandheldPanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicHandheldPanel.prototype.addListen=function(){this.mInitialized},PicHandheldPanel.prototype.removeListen=function(){this.mInitialized},PicHandheldPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicHandheldPanel.prototype.setEqipedDatas=function(t){var i=t.handheld,o=(i=i.sort((function(t,i){return t.latestUse>=i.latestUse?1:-1}))).splice(0,3);i=i.sort((function(t,i){return t.recommended>=i.recommended?1:-1})),i=o.concat(i);var r,a=h.op_client.CountablePackageItem.create({id:"empty_handed",count:0});if(""!==t.currentHandheldId&&t.currentHandheldId)for(var l=0,c=i;l<c.length;l++){var u=c[l];if(u.id===t.currentHandheldId){r=u;break}}else r=a;if(i.unshift(a),this.handeldEqiped.setItemData(r),this.isExtendsGrid){var p=14-i.length,d=p>0?i.concat(new Array(p)):i;if(this.mPropGrid.setItems(d),r)for(var m=0,y=this.mPropGrid.getCells();m<y.length;m++){var g=y[m];if(g&&g.container){var _=g.container;_.itemData===r?(_.isSelect=!0,this.curHandheldItem=g):_.isSelect=!1}}}},PicHandheldPanel.prototype.preload=function(){this.addAtlas(this.key,"hand_equp/hand_equp.png","hand_equp/hand_equp.json"),t.prototype.preload.call(this)},PicHandheldPanel.prototype.init=function(){var i=this;if(!this.mInitialized){var o=this.scaleWidth,r=this.scaleHeight;this.gridContent=this.scene.make.container(void 0,!1),this.add(this.gridContent),this.gridContent.setSize(o,150*this.dpr),this.gridContent.x=.5*o,this.gridContent.y=r-.5*this.gridContent.height-200*this.dpr;var a=this.scene.make.graphics(void 0,!1);a.fillStyle(3355443,.5),a.fillRect(.5*-o,.5*-this.gridContent.height,o,150*this.dpr),this.gridContent.add(a),this.handeldEqiped=new g(this.scene,0,0,this.key,this.dpr),this.handeldEqiped.setClickHandler(new c.a(this,this.onHandheldEqipedHandler),new c.a(this,this.onShortcutHandler)),this.add(this.handeldEqiped);var h=this.scene.textures.getFrame(this.key,"equp_bg"),l=h.width+10*this.dpr,u=h.height+10*this.dpr,d={x:0,y:0,table:{width:o-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:l,cellHeight:u,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;return null===o&&(o=new y(r,0,0,i.key,i.dpr)),o.setItemData(a),o}};this.mPropGrid=new p.GameGridTable(this.scene,d),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){i.onSelectItemHandler(t)})),this.gridContent.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)}},PicHandheldPanel.prototype.updateData=function(){this.updateLayout()},PicHandheldPanel.prototype.updateLayout=function(){var t=this.scaleWidth,i=this.scaleHeight,o=t-.5*this.handeldEqiped.width-8*this.dpr,r=0;this.gridContent.y=i-.5*this.gridContent.height,this.isExtendsGrid?(r=i-.5*this.handeldEqiped.height-this.gridContent.height,this.gridContent.visible=!0,this.mPropGrid.resetMask(),this.handeldEqiped.normal(),this.handeldEqiped.hideShortcut()):(r=i-.5*this.handeldEqiped.height-10*this.dpr,this.gridContent.visible=!1,this.handeldEqiped.waiting(),this.handeldEqiped.isEmptyHanded||this.handeldEqiped.showShortcut()),this.handeldEqiped.setPosition(o,r)},PicHandheldPanel.prototype.onSelectItemHandler=function(t){var i=t.itemData;i&&(this.curHandheldItem&&(this.curHandheldItem.isSelect=!1),t.isSelect=!0,this.curHandheldItem=t,t.isEmptyHanded?this.emit("clearhandheld"):this.emit("changehandheld",i.id))},PicHandheldPanel.prototype.onHandheldEqipedHandler=function(t){this.isExtendsGrid=!this.isExtendsGrid,this.isExtendsGrid?(this.gridContent.visible=!0,this.emit("handheldlist"),this.emit("openeqiped",!0)):(this.mPropGrid.setItems([]),this.gridContent.visible=!1,this.emit("openeqiped",!1)),this.updateLayout()},PicHandheldPanel.prototype.onShortcutHandler=function(t){this.emit("clearhandheld")},PicHandheldPanel}(a.BasePanel),y=function(t){function HandheldItem(i,o,r,a,h){var c=t.call(this,i,o,r)||this;return c.mIsSelect=!1,c.dpr=h,c.key=a,c.bg=c.scene.make.image({key:a,frame:"equp_bg"}),c.selectbg=c.scene.make.image({key:a,frame:"click_bg"}),c.icon=new l.DynamicImage(i,0,0),c.add([c.bg,c.selectbg,c.icon]),c.setSize(c.selectbg.width,c.selectbg.height),c.isSelect=!1,c}return d(HandheldItem,t),HandheldItem.prototype.setItemData=function(t){var i=this;if(this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);if(this.icon.visible=!0,this.selectbg.visible=this.mIsSelect,this.isEmptyHanded)this.icon.setTexture(this.key,"empty_handed");else{var o=t.display,r=u.i.getOsdRes(o.texturePath);this.icon.load(r,this,(function(){i.icon.displayWidth=34*i.dpr,i.icon.scaleY=i.icon.scaleX}))}},Object.defineProperty(HandheldItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldItem.prototype,"isEmptyHanded",{get:function(){return!(!this.itemData||"empty_handed"!==this.itemData.id)},enumerable:!1,configurable:!0}),HandheldItem}(Phaser.GameObjects.Container),g=function(t){function HandheldEqiped(i,o,r,a,h){var c=t.call(this,i,o,r)||this;c.isExtendsGrid=!1,c.key=a,c.dpr=h,c.bg=c.scene.make.image({key:a,frame:"button_h"}),c.shortcutCon=c.scene.make.container(void 0,!1),c.shortcutbg=c.scene.make.image({key:a,frame:"superscript_h"}),c.shortcutIcon=c.scene.make.image({key:a,frame:"hand"}),c.shortcutCon.add([c.shortcutbg,c.shortcutIcon]);var u=40*h;return c.shortcutCon.setSize(u,u),c.shortcutbg.x=.5*-c.shortcutCon.width+.5*c.shortcutbg.width-5*h,c.shortcutbg.y=.5*c.shortcutCon.height-.5*c.shortcutbg.height+5*h,c.shortcutIcon.x=c.shortcutbg.x,c.shortcutIcon.y=c.shortcutbg.y,c.icon=new l.DynamicImage(i,0,0),c.icon.setTexture(c.key,"empty_handed"),c.shortcutCon.on("pointerup",c.onShortcutHandler,c),c.add([c.bg,c.icon,c.shortcutCon]),c.setSize(c.bg.width,c.bg.height),c.setInteractive(),c.shortcutCon.setPosition(.5*c.width+.5*u-20*h,.5*-c.height-.5*u+15*h),c.shortcutCon.setInteractive(),c.on("pointerup",c.onClickHandler,c),c.hideShortcut(),c}return d(HandheldEqiped,t),HandheldEqiped.prototype.normal=function(){this.bg.setFrame("button_h"),this.setChildAlpha(1)},HandheldEqiped.prototype.waiting=function(){this.bg.setFrame("button_h"),this.setChildAlpha(.5)},HandheldEqiped.prototype.setItemData=function(t){var i=this;if(this.itemData=t,this.isEmptyHanded)this.icon.setScale(1),this.icon.setTexture(this.key,"empty_handed"),this.hideShortcut();else{var o=t.display,r=u.i.getOsdRes(o.texturePath);this.icon.load(r,this,(function(){i.icon.displayWidth=24*i.dpr,i.icon.scaleY=i.icon.scaleX})),this.isExtendsGrid||this.showShortcut()}},HandheldEqiped.prototype.setClickHandler=function(t,i){this.clickHandler=t,this.shortcutHandler=i},HandheldEqiped.prototype.setChildAlpha=function(t){this.bg.setAlpha(t),this.icon.setAlpha(t),this.shortcutbg.setAlpha(t),this.shortcutIcon.setAlpha(t)},HandheldEqiped.prototype.hideShortcut=function(){this.shortcutCon.visible=!1,this.shortcutCon.disableInteractive()},HandheldEqiped.prototype.showShortcut=function(){this.shortcutCon.visible=!0,this.shortcutCon.setInteractive()},Object.defineProperty(HandheldEqiped.prototype,"isCanShowShortcut",{get:function(){return!this.isEmptyHanded},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldEqiped.prototype,"isEmptyHanded",{get:function(){return!this.itemData||"empty_handed"===this.itemData.id},enumerable:!1,configurable:!0}),HandheldEqiped.prototype.onShortcutHandler=function(){this.shortcutHandler&&this.shortcutHandler.runWith(this.itemData)},HandheldEqiped.prototype.onClickHandler=function(){this.isExtendsGrid=!this.isExtendsGrid,this.clickHandler&&this.clickHandler.runWith(this.itemData)},HandheldEqiped}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractiveBubbleMediator",(function(){return u}));var r,a=o(247),h=o(249),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function InteractiveBubbleMediator(i,o,r){var l=t.call(this)||this;return l.layerMgr=i,l.mworld=r,l.scene=o,l.bubblePacket||(l.bubblePacket=new h.InteractiveBubble(r),l.bubblePacket.on("showbubble",l.onShowInteractiveBubble,l),l.bubblePacket.on("clearbubble",l.onClearInteractiveBubble,l),l.bubblePacket.register()),l.mView||(l.mView=new a.InteractiveBubblePanel(l.scene,l.mworld),l.mView.on("queryinteractive",l.onInteractiveBubbleHandler,l)),l}return c(InteractiveBubbleMediator,t),Object.defineProperty(InteractiveBubbleMediator.prototype,"currentRoom",{get:function(){return this.mworld.roomManager.currentRoom},enumerable:!1,configurable:!0}),InteractiveBubbleMediator.prototype.destroy=function(){this.mCurRoom&&this.mCurRoom.frameManager.remove(this,this.update),this.bubblePacket&&(this.bubblePacket.destroy(),this.bubblePacket=void 0),t.prototype.destroy.call(this),this.mCurRoom=void 0},InteractiveBubbleMediator.prototype.update=function(){this.mView&&this.mView.update()},InteractiveBubbleMediator.prototype.onShowInteractiveBubble=function(t){this.mCurRoom!==this.currentRoom&&(this.mCurRoom&&this.mCurRoom.frameManager.remove(this,this.update),this.mCurRoom=this.currentRoom,this.mCurRoom.frameManager.add(this,this.update));var i=this.currentRoom.elementManager.get(t.receiverId);i||(i=this.currentRoom.playerManager.get(t.receiverId)),i&&this.mView&&this.mView.showInteractionBubble(t,i),this.layerMgr.addToUILayer(this.mView,0)},InteractiveBubbleMediator.prototype.onClearInteractiveBubble=function(t){if(this.mView)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.mView.clearInteractionBubble(r)}},InteractiveBubbleMediator.prototype.onInteractiveBubbleHandler=function(t){this.mView&&("number"!=typeof t?this.bubblePacket.queryInteractiveHandler(t):this.mView.clearInteractionBubble(t))},InteractiveBubbleMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractiveBubblePanel",(function(){return y}));var r,a=o(112),h=o(111),l=o(248),c=o(120),u=o(118),p=o(146),d=o(169),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function InteractiveBubblePanel(i,o){var r=t.call(this,i,o)||this;return r.map=new Map,r.world=o,r}return m(InteractiveBubblePanel,t),InteractiveBubblePanel.prototype.resize=function(i,o){t.prototype.resize.call(this,i,o),this.setSize(i,o)},InteractiveBubblePanel.prototype.init=function(){var i=this.scaleWidth,o=this.scaleHeight;this.scale;this.resize(i,o),t.prototype.init.call(this)},InteractiveBubblePanel.prototype.destroy=function(){if(this.map){for(var i in this.map){var o=this.map.get(Number(i));o&&o.destroy()}this.map.clear()}t.prototype.destroy.call(this)},InteractiveBubblePanel.prototype.clearInteractionBubble=function(t){this.map.has(t)&&(this.map.get(t).destroy(),this.map.delete(t))},InteractiveBubblePanel.prototype.showInteractionBubble=function(t,i){var o=this,r=this.dpr;t.display.resName=null,t.display.texturePath=h.i.getUIRes(r,"bubble/bubblebg.png"),t.display.dataPath=h.i.getUIRes(r,"bubble/tipsicon.png");var a=t.id;this.mBubble&&this.mBubble.hide(),this.map.has(a)?this.mBubble=this.map.get(a):(this.mBubble=new l.InteractionBubbleContainer(this.scene,r),this.map.set(a,this.mBubble)),this.mBubble.setBubble(t,new c.a(this,this.onInteractiveBubbleHandler));var u=this.world.game.scene.getScene(d.a.name);this.updateBubblePos(i,u),this.mBubble.setFollow(i,u,(function(t){o.updateBubblePos(i,t.scene)})),this.mBubble.show=!0,this.add(this.mBubble)},InteractiveBubblePanel.prototype.updateBubblePos=function(t,i){var o=this.dpr,r=this.world.uiScale,a=t.getDisplay();if(a){var h=a.getWorldTransformMatrix();if(h){var l=p.a.getPosByScenes(i,new u.a(h.tx,h.ty-33*o*r));this.mBubble.setPosition(l.x,l.y)}}},InteractiveBubblePanel.prototype.update=function(){this.map&&this.map.forEach((function(t){t&&t.show&&t.updatePos()}))},InteractiveBubblePanel.prototype.onInteractiveBubbleHandler=function(t){this.emit("queryinteractive",t)},InteractiveBubblePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractionBubbleContainer",(function(){return c}));var r,a=o(329),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function InteractionBubbleContainer(i,o){return t.call(this,i)||this}return l(InteractionBubbleContainer,t),Object.defineProperty(InteractionBubbleContainer.prototype,"show",{get:function(){return this.mShow},set:function(t){this.mShow=t},enumerable:!1,configurable:!0}),InteractionBubbleContainer.prototype.hide=function(){this.mShow=!1,this.parentContainer&&this.parentContainer.remove(this)},InteractionBubbleContainer.prototype.setFollow=function(i,o,r){t.prototype.setFollow.call(this,i,o,r)},InteractionBubbleContainer.prototype.setBubble=function(t,i){this.id=t.id;var o=t.display.resName,r=t.display.texturePath,h=t.display.dataPath;return this.mBubble||(this.mBubble=new a.InteractionBubbleCell(this.scene,this.dpr),this.mBubble.load(o,r,h),this.add(this.mBubble)),this.mBubble.setContentData(t,i),this.mBubble.show(),this.mBubble},InteractionBubbleContainer.prototype.destroy=function(){this.hide(),this.mBubble&&this.mBubble.destroy(),this.mBubble=null,t.prototype.destroy.call(this)},InteractionBubbleContainer}(h.BaseUI)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractiveBubble",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function InteractiveBubble(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(InteractiveBubble,t),InteractiveBubble.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_INTERACTIVE_BUBBLE,this.onShowHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORDL_REQ_CLIENT_REMOVE_INTERACTIVE_BUBBLE,this.onClearHandler))},InteractiveBubble.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},InteractiveBubble.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},InteractiveBubble.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},InteractiveBubble.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},InteractiveBubble.prototype.queryInteractiveHandler=function(t){var i=this.connection,o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_ACTIVE_BUBBLE);o.content.id=t.id,i.send(o)},Object.defineProperty(InteractiveBubble.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),InteractiveBubble.prototype.onShowHandler=function(t){var i=t.content;this.mEvent.emit("showbubble",i)},InteractiveBubble.prototype.onClearHandler=function(t){var i=t.content;this.mEvent.emit("clearbubble",i.ids)},InteractiveBubble}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"CharacterInfoMediator",(function(){return d}));var r,a=o(251),h=o(252),l=o(139),c=o(255),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function CharacterInfoMediator(i,o,r){var h=t.call(this)||this;return h.scene=o,h.layerMgr=i,h.world=r,h.characterInfo=new a.CharacterInfo(h.world),h.characterInfo.on("ownerInfo",h.onOwnerCharacterInfo,h),h.characterInfo.on("otherInfo",h.onOtherCharacterInfo,h),h.characterInfo.register(),h}return p(CharacterInfoMediator,t),CharacterInfoMediator.prototype.show=function(t){this.mView||(this.mView||(this.mView=new c.default(this.scene,this.world),this.mView.on("hide",this.onHidePanel,this),this.mView.on("queryOwnerInfo",this.onQueryOwnerInfo,this),this.mView.on("track",this.onTrackHandler,this),this.mView.on("invite",this.onInviteHandler,this),this.mView.on("follow",this.onFollowHandler,this),this.mView.on("unfollow",this.onUnfollowHandler,this),this.mView.on("addBlack",this.onAddBlackHandler,this),this.mView.on("removeBlack",this.onRemoveBlackHandler,this)),this.layerMgr.addToUILayer(this.mView)),this.mView.show()},CharacterInfoMediator.prototype.isSceneUI=function(){return!1},CharacterInfoMediator.prototype.destroy=function(){this.characterInfo&&(this.characterInfo.destroy(),this.characterInfo=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},CharacterInfoMediator.prototype.onHidePanel=function(){this.mView&&this.mView.hide(),this.mView=void 0,this.hide()},CharacterInfoMediator.prototype.onOwnerCharacterInfo=function(t){this.mView&&this.mView.setPlayerData(t)},CharacterInfoMediator.prototype.onOtherCharacterInfo=function(t){this.mView&&(this.mView.setPlayerData(t),this.checkRelation(t.cid))},CharacterInfoMediator.prototype.onFollowHandler=function(t){var i=this;this.world.httpService.follow(t).then((function(o){var r=o.code;o.data;200!==r&&201!==r||i.mView&&(i.checkRelation(t),i.updateFrind())}))},CharacterInfoMediator.prototype.onUnfollowHandler=function(t){var i=this;this.world.httpService.unfollow(t).then((function(o){var r=o.code;o.data;200!==r&&201!==r||(i.checkRelation(t),i.updateFrind())}))},CharacterInfoMediator.prototype.checkRelation=function(t){var i=this,o=this.world.account.accountData.id;this.world.httpService.post("user/check_relation",{relations:[{userA:o,userB:t}]}).then((function(t){var o=t.code,r=t.data;if(200===o)for(var a in r){var h=a.split("_");i.mView.setFriendRelation(l.PicFriendRelation.check(h[0],h[1],r[a]).relation)}}))},CharacterInfoMediator.prototype.onAddBlackHandler=function(t){var i=this;this.world.httpService.banUser(t).then((function(o){var r=o.code;o.data;200!==r&&201!==r||i.checkRelation(t)}))},CharacterInfoMediator.prototype.onRemoveBlackHandler=function(t){var i=this;this.world.httpService.removeBanUser(t).then((function(o){var r=o.code;o.data;200!==r&&201!==r||i.checkRelation(t)}))},CharacterInfoMediator.prototype.onQueryOwnerInfo=function(){this.characterInfo.queryPlayerInfo()},CharacterInfoMediator.prototype.onTrackHandler=function(t){this.characterInfo.track(t)},CharacterInfoMediator.prototype.onInviteHandler=function(t){this.characterInfo.invite(t)},CharacterInfoMediator.prototype.updateFrind=function(){var t=this.world.uiManager.getMediator(h.PicFriendMediator.name);t&&t.fetchCurrentFriend()},CharacterInfoMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"CharacterInfo",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function CharacterInfo(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(CharacterInfo,t),CharacterInfo.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SELF_PLAYER_INFO,this.onOwnerCharacterInfo),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_ANOTHER_PLAYER_INFO,this.onOtherCharacterInfo))},CharacterInfo.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},CharacterInfo.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},CharacterInfo.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},CharacterInfo.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(CharacterInfo.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),CharacterInfo.prototype.queryPlayerInfo=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SELF_PLAYER_INFO);this.connection.send(t)},CharacterInfo.prototype.track=function(t){this.playerInteraction(t,h.op_pkt_def.PKT_PlayerInteraction.PKT_tracePlayer)},CharacterInfo.prototype.invite=function(t){this.playerInteraction(t,h.op_pkt_def.PKT_PlayerInteraction.PKT_invitePlayer)},CharacterInfo.prototype.playerInteraction=function(t,i){var o=h.op_def.GeneralParam.create();o.t=h.op_def.GeneralParamType.str,o.valStr=t;var r=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_PLAYER_INTERACTION),l=r.content;l.method=i,l.param=o,this.connection.send(r)},CharacterInfo.prototype.onOwnerCharacterInfo=function(t){var i=t.content;this.mEvent.emit("ownerInfo",i)},CharacterInfo.prototype.onOtherCharacterInfo=function(t){var i=t.content;this.mEvent.emit("otherInfo",i)},CharacterInfo}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFriendMediator",(function(){return d}));var r,a=o(253),h=o(254),l=o(151),c=o(139),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicFriendMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return p(PicFriendMediator,t),PicFriendMediator.prototype.show=function(){this.mView||(this.mView||(this.mView=new a.default(this.scene,this.world),this.mView.on("hide",this.onHidePanel,this),this.mView.on(l.PicFriendEvent.FETCH_FRIEND,this.onFetchFriendHandler,this),this.mView.on(l.PicFriendEvent.UNFOLLOW,this.onUnfollowHandler,this),this.mView.on(l.PicFriendEvent.FOLLOW,this.onFollowHandler,this),this.mView.on(l.PicFriendEvent.REMOVE_FROM_BLACKLIST,this.onRemoveBanUserHandler,this),this.mView.on(l.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.mView.on(l.PicFriendEvent.REQ_BLACKLIST,this.onReqBlacklistHandler,this),this.mView.on(l.PicFriendEvent.REMOVE_FROM_BLACKLIST,this.onRemoveFromBlacklistHandler,this),this.mView.on(l.PicFriendEvent.SEARCH_FRIEND,this.onSearchHandler,this),this.mView.on(l.PicFriendEvent.REQ_PLAYER_LIST,this.onReqPlayerListHanlder,this),this.mView.on(l.PicFriendEvent.REQ_RELATION,this.onReRelationHandler,this)),this.picFriend||(this.picFriend=new h.PicFriend(this.world),this.picFriend.on(l.PicFriendEvent.PLAYER_LIST,this.onPlayerListHandler,this),this.picFriend.on(l.PicFriendEvent.SEARCH_RESULT,this.onSearchResultHandler,this),this.picFriend.register()),this.layerMgr.addToUILayer(this.mView)),this.mView.show()},PicFriendMediator.prototype.destroy=function(){this.picFriend&&(this.picFriend.destroy(),this.picFriend=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},PicFriendMediator.prototype.fetchCurrentFriend=function(){this.mView&&this.mView.fetchCurrentFriend()},PicFriendMediator.prototype.onReRelationHandler=function(t){for(var i=this,o=[],r=this.world.account.accountData.id,a=0,h=t;a<h.length;a++){var l=h[a];o.push({userA:r,userB:l})}this.world.httpService.post("user/check_relation",{relations:o}).then((function(t){var o=t.code,r=t.data;if(200===o){var a=[];for(var h in r){var l=h.split("_");a.push(c.PicFriendRelation.check(l[0],l[1],r[h]))}i.mView.updateRelation(a)}}))},PicFriendMediator.prototype.onFetchFriendHandler=function(t){switch(t){case a.FriendChannel.Friends:this.getFriends();break;case a.FriendChannel.Fans:this.getFans();break;case a.FriendChannel.Followes:this.getFolloweds()}},PicFriendMediator.prototype.getFriends=function(){var t=this;this.picFriend.getFriends().then((function(i){t.mView.setFriend(a.FriendChannel.Friends,i.data)}))},PicFriendMediator.prototype.getFans=function(){var t=this;this.picFriend.getFans().then((function(i){var o=i.data;o&&t.mView.setFriend(a.FriendChannel.Fans,o.filter((function(t){return t.user})))}))},PicFriendMediator.prototype.getFolloweds=function(){var t=this;this.picFriend.getFolloweds().then((function(i){var o=i.data;o&&t.mView.setFriend(a.FriendChannel.Followes,o.filter((function(t){return t.followed_user})))}))},PicFriendMediator.prototype.onFollowHandler=function(t){var i=this;if(t&&!(t.length<0)){var o=t[0];this.world.httpService.follow(o).then((function(t){i.mView.filterById(o)}))}},PicFriendMediator.prototype.onUnfollowHandler=function(t){var i=this;if(t&&!(t.length<0)){var o=t[0];this.world.httpService.unfollow(o).then((function(t){i.mView.filterById(o)}))}},PicFriendMediator.prototype.onRemoveBanUserHandler=function(t){var i=this;!t||t.length<1||this.world.httpService.removeBanUser(t[0]).then((function(o){201===o.code&&i.mView.filterById(t[0])}))},PicFriendMediator.prototype.onReqBlacklistHandler=function(){var t=this;this.picFriend.getBanlist().then((function(i){t.mView.setFriend(a.FriendChannel.Blacklist,i.data)}))},PicFriendMediator.prototype.onRemoveFromBlacklistHandler=function(t){var i=this;!t||t.length<1||this.world.httpService.removeBanUser(t[0]).then((function(o){i.mView.filterById(t[0])}))},PicFriendMediator.prototype.fetchPlayerList=function(t){if(t){var i=t.map((function(t){return t.id}));this.picFriend.fetchFriendList(i)}},PicFriendMediator.prototype.onPlayerListHandler=function(t){this.mView.updateFriend(t)},PicFriendMediator.prototype.onReqFriendAttributesHandler=function(t){this.world.uiManager.showMed("CharacterInfo"),this.picFriend.fetchFriendInfo(t)},PicFriendMediator.prototype.onSearchHandler=function(t){t&&t.length>0&&this.picFriend.searchFriend(t[0])},PicFriendMediator.prototype.onSearchResultHandler=function(t){this.mView.setFriend(a.FriendChannel.Search,t.playerInfos)},PicFriendMediator.prototype.onReqPlayerListHanlder=function(t){this.picFriend.fetchFriendList(t)},PicFriendMediator.prototype.onHidePanel=function(){this.destroy()},PicFriendMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"FriendChannel",(function(){return P}));var r,a=o(112),h=o(113),l=o(114),c=o(120),u=o(127),p=o(151),d=o(149),m=o(139),y=o(109),g=o(115),_=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),v=Phaser.GameObjects.Container,b=function(t){function PicFriendPanel(i,o){var r=t.call(this,i,o)||this;return r.key="picfriendpanel",r.mSubContanerMap=new Map,r.mSubContanerMap.set(P.Blacklist,E),r.mSubContanerMap.set(P.Search,M),r.mSubContanerMap.set(P.NewFriend,B),r.mSubContanerMap.set(P.NewFans,x),r}return _(PicFriendPanel,t),PicFriendPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,r,a),this.content.setPosition(r/2,a/2),this.friendContainer.parentContainer&&this.friendContainer.resize()},PicFriendPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.friendContainer.setChannel(P.Friends)):this.preload())},PicFriendPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(String(y.ClickEvent.Tap),this.OnClosePanel,this),this.friendContainer.register(),this.friendContainer.on("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.on(p.PicFriendEvent.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.on(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.on(p.PicFriendEvent.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.on(p.PicFriendEvent.REQ_PLAYER_LIST,this.onReqFriendListHandler,this))},PicFriendPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(String(y.ClickEvent.Tap),this.OnClosePanel,this),this.friendContainer.off("shwoAddFriend",this.onShowAddFriendHandler,this),this.friendContainer.off(p.PicFriendEvent.FETCH_FRIEND,this.onFetchFriendHandler,this),this.friendContainer.off(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.friendContainer.off(p.PicFriendEvent.RENDERER_EVENT,this.onRendererEventHandler,this),this.friendContainer.off(p.PicFriendEvent.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.friendContainer.unregister())},PicFriendPanel.prototype.setFriend=function(t,i){this.mSubContanerMap.get(t)?this.mShowingSubContainer&&this.mShowingSubContainer.setItems(i):this.friendContainer&&this.friendContainer.setFriends(t,i)},PicFriendPanel.prototype.updateFriend=function(t){this.mShowingSubContainer?this.mShowingSubContainer.updateFriends(t):this.friendContainer.updateFriends(t)},PicFriendPanel.prototype.updateRelation=function(t){this.mShowingSubContainer&&this.mShowingSubContainer instanceof M&&this.mShowingSubContainer.updateRelation(t)},PicFriendPanel.prototype.filterById=function(t){this.mShowingSubContainer?this.mShowingSubContainer.filterById(t):this.friendContainer&&this.friendContainer.filterById(t)},PicFriendPanel.prototype.fetchCurrentFriend=function(){this.friendContainer&&this.friendContainer.fetchCurrentFriend()},PicFriendPanel.prototype.preload=function(){this.addAtlas(this.key,"friend_list/friend_list.png","friend_list/friend_list.json"),this.addAtlas(g.UIAtlasKey.commonKey,g.UIAtlasName.commonUrl+".png",g.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},PicFriendPanel.prototype.init=function(){var i=this.scale,o=this.scaleWidth,r=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,.5),this.mBackGround.fillRect(0,0,o*i,r*i),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"phone"}),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.content.add(this.bg),this.closeBtn=new y.Button(this.scene,g.UIAtlasKey.commonKey,"close"),this.closeBtn.setPosition(.5*this.content.width-30*this.dpr,.5*(-this.bg.height+this.closeBtn.height)+25*this.dpr),this.friendContainer=new S(this.scene,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.content.add([this.friendContainer,this.closeBtn]),this.add([this.mBackGround,this.content]),this.resize(o,r),t.prototype.init.call(this)},PicFriendPanel.prototype.destroy=function(){this.friendContainer&&this.friendContainer.destroy(),this.mShowingSubContainer&&this.mShowingSubContainer.destroy(),t.prototype.destroy.call(this)},PicFriendPanel.prototype.OnClosePanel=function(){this.emit("hide")},PicFriendPanel.prototype.onFetchFriendHandler=function(t){this.emit(p.PicFriendEvent.FETCH_FRIEND,t)},PicFriendPanel.prototype.onReqFriendAttributesHandler=function(t){this.emit(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,t)},PicFriendPanel.prototype.onReqFollowFriendHandler=function(t){this.emit(p.PicFriendEvent.FOLLOW,t)},PicFriendPanel.prototype.onUnfollowFriendHanlder=function(t){this.emit(p.PicFriendEvent.UNFOLLOW,t)},PicFriendPanel.prototype.onShowAddFriendHandler=function(t){this.mShowingSubContainer&&this.mShowingSubContainer.destroy();var i=this.mSubContanerMap.get(t);if(i){this.mShowingSubContainer=new i(this.scene,this.bg.width,this.bg.height,this.key,this.dpr,this.scale),this.mShowingSubContainer.register(),this.mShowingSubContainer.on("hide",this.onHideSearchHandler,this),this.mShowingSubContainer.on(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.onReqFriendAttributesHandler,this),this.mShowingSubContainer.on(p.PicFriendEvent.RENDERER_EVENT,this.onRendererEventHandler,this),this.mShowingSubContainer.on(p.PicFriendEvent.REQ_PLAYER_LIST,this.onReqFriendListHandler,this),this.mShowingSubContainer.on(p.PicFriendEvent.REQ_FRIEND_RELATION,this.onReqFriendRelationHandler,this),this.content.remove(this.friendContainer),this.content.add(this.mShowingSubContainer),this.mShowingSubContainer.resize();var o=this.mShowingSubContainer.fetchEventName();o&&this.emit(o)}},PicFriendPanel.prototype.onHideSearchHandler=function(){this.content.add(this.friendContainer),this.mShowingSubContainer&&(this.mShowingSubContainer.unregister(),this.mShowingSubContainer.destroy(),this.mShowingSubContainer=null),this.friendContainer.fetchCurrentFriend()},PicFriendPanel.prototype.onReqFriendListHandler=function(t){this.emit(p.PicFriendEvent.REQ_PLAYER_LIST,t)},PicFriendPanel.prototype.onRendererEventHandler=function(t,i){t&&this.emit(t,i)},PicFriendPanel.prototype.onReqFriendRelationHandler=function(t){if(t){var i=t.map((function(t){return t.id}));i.length>0&&this.emit(p.PicFriendEvent.REQ_RELATION,i)}},PicFriendPanel}(a.BasePanel);i.default=b;var P,w=function(t){function FriendContainer(i,o,r,a,h,l){var c=t.call(this,i,0,0)||this;return c.key=a,c.dpr=h,c.uiScale=l,c.setSize(o,r),c}return _(FriendContainer,t),FriendContainer.prototype.draw=function(){var t=49*this.dpr-.5*this.height,i="bold "+16*this.dpr+"px "+h.a.DEFULT_FONT;this.titleText=this.scene.make.text({x:0,y:t,style:{font:i,bold:!0,color:"#0"}}).setOrigin(.5,0),this.add(this.titleText)},FriendContainer.prototype.createGrideTable=function(t,i,o,r,a,h,l,c,u){var p=this,d={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,zoom:this.uiScale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){var o=t.item;return null===i&&(i=l(p.scene,t)),o.type===P.Null?t.setHeight(11*p.dpr):t.height!==h&&t.setHeight(h),i.setSize(t.width,t.height),i.setData({item:o}),i.setItemData(o),u&&u(t,i),i}},m=new y.GameGridTable(this.scene,d);return m.layout(),m.on("cellTap",(function(t){t&&c.runWith(t)})),this.add(m),m},FriendContainer.prototype.sortByName=function(t){return t.sort((function(t,i){return t.nickname.localeCompare(i.nickname,l.a.language)}))},FriendContainer.prototype.sortByOnlien=function(t){return t.sort((function(t,i){var o=t.lv?1:0;return(i.lv?1:0)-o}))},FriendContainer}(v),S=function(t){function MainContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.friendDatas=new Map,c.draw(),c}return _(MainContainer,t),MainContainer.prototype.register=function(){this.searchInput.on("textchange",this.onTextChangeHandler,this),this.searchBtn.on(String(y.ClickEvent.Tap),this.onSeachHandler,this),this.onlineCheckBox.on(String(y.ClickEvent.Tap),this.onCheckoutOnlineHandler,this),this.addFriendBtn.on(String(y.ClickEvent.Tap),this.onShowAddFriendHandler,this)},MainContainer.prototype.unregister=function(){this.searchInput.off("textchange",this.onTextChangeHandler,this),this.searchBtn.off(String(y.ClickEvent.Tap),this.onSeachHandler,this),this.onlineCheckBox.off(String(y.ClickEvent.Tap),this.onCheckoutOnlineHandler,this),this.addFriendBtn.off(String(y.ClickEvent.Tap),this.onShowAddFriendHandler,this)},MainContainer.prototype.resize=function(){this.friendTabel&&this.friendTabel.resetMask()},MainContainer.prototype.setChannel=function(t){this.channelGroup&&this.channelGroup.selectIndex(t)},MainContainer.prototype.updateFriends=function(t){var i=t.playerInfos,o=null,r=this.friendDatas.get(this.channelGroup.selectedIndex);if(r){for(var _loop_1=function(t){(o=r.find((function(i){return i.id===t.platformId})))&&(o.nickname=t.nickname,t.level&&(o.lv=t.level.level))},a=0,h=i;a<h.length;a++){_loop_1(h[a])}this.showFriend(this.channelGroup.selectedIndex,r)}},MainContainer.prototype.setFriends=function(t,i){for(var o,r=[],a=null,h=[],l=0,c=i;l<c.length;l++){var u=c[l];t===P.Followes?(a=u.followed_user,o=m.FriendRelationEnum.Followed):t===P.Fans?(a=u.user,o=m.FriendRelationEnum.Fans):(a=u,o=m.FriendRelationEnum.Friend),a&&(r.push({type:t,id:a._id,nickname:a.nickname,relation:o}),h.push(a._id))}this.friendDatas.set(t,r),h.length>0&&this.emit(p.PicFriendEvent.REQ_PLAYER_LIST,h),this.showFriend(t,r)},MainContainer.prototype.showFriend=function(t,i){this.sortByName(i),this.sortByOnlien(i);var o="",r="";switch(t){case P.Friends:o=l.a.t("friendlist.title"),r=l.a.t("friendlist.friends"),i=[{type:P.Menu,menuData:{type:P.NewFans}},{type:P.Menu,menuData:{type:P.NewFriend}},{type:P.Menu,menuData:{type:P.Blacklist}},{type:P.Null}].concat(i);break;case P.Fans:o=l.a.t("friendlist.fans"),r=l.a.t("friendlist.fans");break;case P.Followes:o=l.a.t("friendlist.follow"),r=l.a.t("friendlist.fans");break;case P.Blacklist:o=l.a.t("friendlist.blacklist")}this.showingFriends=i,this.friendTabel.setItems(this.showingFriends),o&&this.titleText.setText(o);var a=this.friendDatas.get(this.channelGroup.selectedIndex);a&&this.friendNum.setText(r+": "+a.length),this.friendTabel&&this.friendTabel.setT(0)},MainContainer.prototype.filterById=function(t){if(this.showingFriends){var i=this.friendDatas.get(this.channelGroup.selectedIndex);i&&(i=i.filter((function(i){return i.id!==t}))),this.showingFriends=this.showingFriends.filter((function(i){return i.id!==t})),this.friendTabel.setItems(this.showingFriends)}},MainContainer.prototype.fetchCurrentFriend=function(){!this.channelGroup||this.channelGroup.selectedIndex<0||this.emit(p.PicFriendEvent.FETCH_FRIEND,this.channelGroup.selectedIndex)},MainContainer.prototype.draw=function(){var i=this;t.prototype.draw.call(this);var o=.5*-this.height+17.33*this.dpr;this.friendNum=this.scene.make.text({x:0,y:o,text:"",style:{color:"#ffffff",fontSize:12*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5,0),this.add(this.friendNum),this.topContent=this.scene.make.container(void 0,!1),this.add(this.topContent);var r=new y.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});this.topContent.setPosition(0,73.67*this.dpr+.5*(r.height-this.height)),this.onlineCheckBox=new y.CheckBox(this.scene,this.key,"online_unchecked","online_checked"),this.onlineCheckBox.setPosition(12*this.dpr-.5*r.width,0);var a=this.scene.make.text({x:6.67*this.dpr+.5*this.onlineCheckBox.width,y:0,text:l.a.t("friendlist.olinetitle"),style:{fontSize:9.33*this.dpr,bold:!0,fontFamily:h.a.DEFULT_FONT,color:"#0098D8"}}).setOrigin(0,.5);this.onlineCheckBox.add(a),this.searchBtn=new y.Button(this.scene,this.key,"search"),this.searchBtn.x=.5*r.width-39*this.dpr-.5*this.searchBtn.width,this.addFriendBtn=new y.Button(this.scene,this.key,"add"),this.addFriendBtn.x=.5*r.width-7.33*this.dpr-.5*this.addFriendBtn.width,this.searchInput=new R(this.scene,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:l.a.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.topContent.add([r,this.onlineCheckBox,this.searchInput,this.searchBtn,this.addFriendBtn]);var d={fontSize:14*this.dpr,fontFamily:h.a.DEFULT_FONT},m=new y.TabButton(this.scene,this.key,"friend_default","friend_select",l.a.t("friendlist.friends"));m.y=.5*this.height-14*this.dpr-.5*m.height,m.setTextStyle(d);var g=new y.TabButton(this.scene,this.key,"fans_default","fans_select",l.a.t("friendlist.fans"));g.y=m.y,g.setTextStyle(d);var _=new y.TabButton(this.scene,this.key,"follow_default","follow_select",l.a.t("friendlist.follow"));_.y=m.y,_.setTextStyle(d),m.x=.5*(-g.width-m.width)-.67*this.dpr,_.x=.5*(g.width+_.width)+.67*this.dpr,this.add([m,g,_]),this.channelGroup=new u.CheckboxGroup,this.channelGroup.on("selected",this.onSelectChannelHandler,this),this.channelGroup.appendItemAll([m,g,_]),this.friendTabel=this.createGrideTable(0,this.topContent.y+this.topContent.height+380*this.dpr*.5+18*this.dpr,275*this.dpr,380*this.dpr,275*this.dpr,36*this.dpr,(function(t,o){var r=new C(i.scene,0,0,i.key,i.dpr);return r.on(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,i.onFtechPlayerHandler,i),r.on(p.PicFriendEvent.RENDERER_EVENT,i.onRendererEventHandler,i),r}),new c.a(this,this.onSelectItemHandler))},MainContainer.prototype.onRendererEventHandler=function(t){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];this.emit(p.PicFriendEvent.RENDERER_EVENT,t,i)},MainContainer.prototype.onFtechPlayerHandler=function(t){void 0!==t.lv&&this.emit(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,t.id),this.searchInput.setBlur()},MainContainer.prototype.onReqFollowFriendHandler=function(t){this.emit(p.PicFriendEvent.FOLLOW,t.id)},MainContainer.prototype.onReqUnfollowFriendHandler=function(t){this.emit(p.PicFriendEvent.UNFOLLOW,t.id)},MainContainer.prototype.onSelectChannelHandler=function(t){this.fetchCurrentFriend()},MainContainer.prototype.onSelectItemHandler=function(t){var i=t.getData("item");i&&i.menuData&&i.type===P.Menu&&this.emit("shwoAddFriend",i.menuData.type)},MainContainer.prototype.onCheckoutOnlineHandler=function(){var t=this.showingFriends;this.onlineCheckBox.selected&&(t=this.showingFriends.slice(0).filter((function(t){return!0===t.online})));this.friendTabel.setItems(t)},MainContainer.prototype.onShowAddFriendHandler=function(){this.emit("shwoAddFriend",P.Search),this.searchInput.setBlur()},MainContainer.prototype.onSeachHandler=function(){var t=this.searchInput.text;if(t){var i=this.showingFriends.slice(0);i=i.filter((function(i){return!!(i.nickname&&i.nickname.indexOf(t)>-1)})),this.friendTabel.setItems(i)}else this.friendTabel.setItems(this.showingFriends)},MainContainer.prototype.onTextChangeHandler=function(){this.onSeachHandler()},MainContainer}(w),C=function(t){function PicFriendItem(i,o,r,a,h){var l=t.call(this,i,o,r)||this;return l.mDpr=0,l.setSize(275*h,36*h),l.mDpr=h,l.mKey=a,l}return _(PicFriendItem,t),PicFriendItem.prototype.setItemData=function(t){this.itemData=t,this.currnetType!==t.type&&(this.currnetType=t.type,this.currentRender&&(this.currentRender.destroy(),this.currentRender=null),this.currentRender=this.createRenderer(t.type)),this.currentRender&&this.currentRender.setItemData(t)},PicFriendItem.prototype.createAddBtn=function(t){var i=48*this.mDpr,o=24*this.mDpr;return new y.NineSliceButton(this.scene,.5*(this.width-i)-18*this.mDpr,0,i,o,g.UIAtlasKey.commonKey,"yellow_btn_normal_s",l.a.t("common.add"),this.mDpr,this.scale,{left:10*this.mDpr,top:10*this.mDpr,right:10*this.mDpr,bottom:10*this.mDpr})},PicFriendItem.prototype.onHeadhandler=function(){this.emit(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.itemData)},PicFriendItem.prototype.createRenderer=function(t){switch(t){case P.Fans:case P.Search:case P.Friends:case P.Followes:case P.NewFriend:case P.Blacklist:return new O(this.scene,this);case P.Null:return new k(this.scene,this);case P.Menu:return new T(this.scene,this)}},Object.defineProperty(PicFriendItem.prototype,"key",{get:function(){return this.mKey},enumerable:!1,configurable:!0}),Object.defineProperty(PicFriendItem.prototype,"dpr",{get:function(){return this.mDpr},enumerable:!1,configurable:!0}),PicFriendItem}(v),T=function(){function MenuRenderer(t,i){this.scene=t,this.owner=i,this.icon=this.scene.make.image({x:7.44*this.owner.dpr-.5*this.owner.width,key:i.key,frame:"black_list"},!1).setOrigin(0,.5),this.text=this.scene.make.text({x:this.icon.x+this.icon.width+9.67*i.dpr,style:{fontSize:9.33*i.dpr,fontFamily:h.a.DEFULT_FONT,color:"#000000"}}).setOrigin(0,.5),this.arrow=this.scene.make.image({x:.5*i.width-20*i.dpr,key:i.key,frame:"arrow"}).setOrigin(1,.5),this.owner.add([this.icon,this.text,this.arrow])}return MenuRenderer.prototype.setItemData=function(t){var i=t.menuData;if(i)switch(i.type){case P.NewFans:this.icon.setFrame("new_fans"),this.text.text=l.a.t("friendlist.new_fans");break;case P.Blacklist:this.icon.setFrame("black_list"),this.text.text=l.a.t("friendlist.blacklist");break;case P.NewFriend:this.icon.setFrame("friend_add"),this.text.text=l.a.t("friendlist.new_friend")}},MenuRenderer.prototype.destroy=function(){this.icon&&this.icon.destroy(),this.text&&this.text.destroy(),this.arrow&&this.arrow.destroy()},MenuRenderer}(),k=function(){function NullRenderer(t,i){this.owner=i,this.graphics=t.make.graphics(void 0,!1),this.graphics.fillStyle(16119285),this.graphics.fillRect(.5*-this.owner.width,-18*i.dpr,this.owner.width,this.owner.height),i.add(this.graphics)}return NullRenderer.prototype.setItemData=function(t){},NullRenderer.prototype.destroy=function(){this.graphics&&this.graphics.destroy()},NullRenderer}(),O=function(){function FriendRenderer(t,i){this.scene=t,this.owner=i,this.icon=t.make.image({x:7.44*i.dpr-.5*i.width,key:i.key,frame:"offline_head"}).setOrigin(0,.5).setInteractive().on("pointerup",this.onHeadhandler,this),this.nameText=t.make.text({x:this.icon.x+this.icon.width+9.67*i.dpr,y:.5*-this.icon.height+1*i.dpr,style:{fontSize:10*i.dpr,fontFamily:h.a.DEFULT_FONT,color:"#6F75FF"}},!1),this.level=t.make.text({x:this.nameText.x,y:this.nameText.y+18*i.dpr,text:"",style:{fontSize:8*i.dpr,fontFamily:h.a.DEFULT_FONT,color:"#6F75FF"}}),this.addBtn=this.createAddBtn(l.a.t("friendlist.follow")),this.addBtn.on(String(y.ClickEvent.Tap),this.onAddHandler,this),this.owner.add(this.addBtn),i.add([this.icon,this.nameText,this.level,this.addBtn])}return FriendRenderer.prototype.setItemData=function(t){this.itemData=t,this.nameText.text=t.nickname;var i=t.lv?l.a.t("friendlist.lv")+"："+t.lv:l.a.t("friendlist.unregistered_game");this.level.setText(i),this.curRelation!==t.relation&&(this.curRelation=t.relation,this.updateRelation())},FriendRenderer.prototype.destroy=function(){if(this.owner)for(var t=this.owner.list;t.length;)t[t.length-1].destroy()},FriendRenderer.prototype.updateRelation=function(){this.curRelation&&this[this.curRelation]?this[this.curRelation]():(this.addBtn.visible=!1,this.friendEvnet=null)},FriendRenderer.prototype.fans=function(){this.addBtn.visible=!0,this.addBtn.setText(l.a.t("friendlist.follow")),this.friendEvnet=p.PicFriendEvent.FOLLOW},FriendRenderer.prototype.followed=function(){this.addBtn.visible=!0,this.addBtn.setText(l.a.t("friendlist.unfollow")),this.friendEvnet=p.PicFriendEvent.UNFOLLOW},FriendRenderer.prototype.blacklist=function(){this.addBtn.visible=!0,this.addBtn.setText(l.a.t("friendlist.remove")),this.friendEvnet=p.PicFriendEvent.REMOVE_FROM_BLACKLIST},FriendRenderer.prototype.null=function(){this.fans()},FriendRenderer.prototype.createAddBtn=function(t){var i=this.owner,o=i.width,r=(i.height,i.key,i.dpr),a=48*r,l=24*r,c=new y.NineSliceButton(this.scene,.5*(o-a)-18*r,0,a,l,g.UIAtlasKey.commonKey,"yellow_btn_normal_s",t,r,1,{left:10*r,top:6*r,right:10*r,bottom:6*r});return c.setTextStyle({fontSize:9*r,fontFamily:h.a.DEFULT_FONT}),c},FriendRenderer.prototype.onHeadhandler=function(){this.owner.emit(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,this.itemData)},FriendRenderer.prototype.onAddHandler=function(){this.friendEvnet&&this.itemData&&this.owner.emit(p.PicFriendEvent.RENDERER_EVENT,this.friendEvnet,this.itemData.id)},FriendRenderer}(),I=(function(t){function FansRenderer(i,o){return t.call(this,i,o)||this}_(FansRenderer,t),FansRenderer.prototype.onAddHandler=function(){this.itemData&&this.owner.emit(p.PicFriendEvent.RENDERER_EVENT,p.PicFriendEvent.FOLLOW,this.itemData.id)}}(O),function(t){function SubFriendContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.draw(),c}return _(SubFriendContainer,t),SubFriendContainer.prototype.register=function(){this.backBtn.on(String(y.ClickEvent.Tap),this.onBackHandler,this)},SubFriendContainer.prototype.unregister=function(){this.backBtn.off(String(y.ClickEvent.Tap),this.onBackHandler,this)},SubFriendContainer.prototype.resize=function(){this.gridTable&&this.gridTable.resetMask()},SubFriendContainer.prototype.setItems=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SubFriendContainer.prototype.filterById=function(t){!this.items||this.items.length<1||(this.items&&(this.items=this.items.filter((function(i){return i.id!==t}))),this.gridTable&&this.gridTable.setItems(this.items))},SubFriendContainer.prototype.updateFriends=function(t){},SubFriendContainer.prototype.fetchEventName=function(){return""},SubFriendContainer.prototype.destroy=function(){this.unregister(),this.gridTable&&this.gridTable.destroy(),t.prototype.destroy.call(this)},SubFriendContainer.prototype.draw=function(){var i=this;t.prototype.draw.call(this),this.backBtn=new y.Button(this.scene,this.key,"back"),this.backBtn.setPosition(.5*(-this.width+this.backBtn.width)+21.67*this.dpr,.5*(-this.height+this.backBtn.height)+47*this.dpr),this.gridTable=this.createGrideTable(0,18*this.dpr,275*this.dpr,400*this.dpr,275*this.dpr,36*this.dpr,(function(){var t=new C(i.scene,0,0,i.key,i.dpr);return t.on(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,i.onFtechPlayerHandler,i),t.on(p.PicFriendEvent.RENDERER_EVENT,i.onRendererEventHandler,i),t}),new c.a(this.onItemClickHandler)),this.add([this.backBtn])},SubFriendContainer.prototype.onBackHandler=function(){this.emit("hide")},SubFriendContainer.prototype.onItemClickHandler=function(){},SubFriendContainer.prototype.onFtechPlayerHandler=function(t){this.emit(p.PicFriendEvent.REQ_FRIEND_ATTRIBUTES,t.id)},SubFriendContainer.prototype.onRendererEventHandler=function(t){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];this.emit(p.PicFriendEvent.RENDERER_EVENT,t,i)},SubFriendContainer}(w)),M=function(t){function SearchContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.friendType=P.Search,c}return _(SearchContainer,t),SearchContainer.prototype.setItems=function(t){if(t){for(var i=[],o=0,r=t;o<r.length;o++){var a=r[o],h=a.platformId,l=a.nickname,c=a.level;i.push({type:this.friendType,nickname:l,id:h,lv:c.level})}this.emit(p.PicFriendEvent.REQ_FRIEND_RELATION,i),this.items=i}},SearchContainer.prototype.updateRelation=function(t){if(this.items){for(var _loop_2=function(t){i.items.find((function(i){return i.id===t.id})).relation=t.relation},i=this,o=0,r=t;o<r.length;o++){_loop_2(r[o])}this.updateFriends(this.items)}},SearchContainer.prototype.updateFriends=function(t){this.items=t,this.gridTable&&this.gridTable.setItems(t)},SearchContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.a.t("friendlist.search"));var i=new y.NineSlicePatch(this.scene,0,0,276*this.dpr,33*this.dpr,this.key,"min_pic_bg",{left:5*this.dpr,top:5*this.dpr,right:5*this.dpr,bottom:5*this.dpr});i.setPosition(0,73.67*this.dpr+.5*(i.height-this.height)),this.searchInput=new R(this.scene,{x:0,y:0,width:80*this.dpr,height:22*this.dpr,placeholder:l.a.t("friendlist.search_friends_notes"),fontSize:12*this.dpr+"px",color:"#666666"},this.key,this.dpr).setOrigin(0,.5),this.searchInput.setPosition(0,i.y),this.searchInput.on("search",this.onSearchHandler,this),this.gridTable.y=i.height,this.gridTable.layout(),this.add([i,this.searchInput])},SearchContainer.prototype.onSearchHandler=function(t){this.emit(p.PicFriendEvent.RENDERER_EVENT,p.PicFriendEvent.SEARCH_FRIEND,t),this.resize()},SearchContainer}(I),E=function(t){function BlackContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.friendType=P.Blacklist,c}return _(BlackContainer,t),BlackContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.a.t("friendlist.blacklist"))},BlackContainer.prototype.setItems=function(i){if(i){for(var o=[],r=[],a=null,h=0,l=i;h<l.length;h++){(a=l[h].ban_user)&&(r.push(a._id),o.push({type:P.Blacklist,id:a._id,nickname:a.nickname,relation:m.FriendRelationEnum.Blacklist}))}t.prototype.setItems.call(this,o),r.length>0&&this.emit(p.PicFriendEvent.REQ_PLAYER_LIST,r)}},BlackContainer.prototype.updateFriends=function(t){for(var i=t.playerInfos,o=null,_loop_3=function(t){(o=r.items.find((function(i){return i.id===t.platformId})))&&(o.nickname=t.nickname,t.level&&(o.lv=t.level.level))},r=this,a=0,h=i;a<h.length;a++){_loop_3(h[a])}this.gridTable&&this.gridTable.setItems(this.items)},BlackContainer.prototype.fetchEventName=function(){return p.PicFriendEvent.REQ_BLACKLIST},BlackContainer}(I),x=function(t){function NewFansContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.friendType=P.Blacklist,c}return _(NewFansContainer,t),NewFansContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.a.t("friendlist.new_fans"))},NewFansContainer}(I),B=function(t){function NewFriendContainer(i,o,r,a,h,l){var c=t.call(this,i,o,r,a,h,l)||this;return c.friendType=P.Blacklist,c}return _(NewFriendContainer,t),NewFriendContainer.prototype.draw=function(){t.prototype.draw.call(this),this.titleText.setText(l.a.t("friendlist.new_friend"))},NewFriendContainer}(I),R=function(t){function SearchInput(i,o,r,a){var h=t.call(this,i,o)||this;h.searchBtn=new y.Button(h.scene,r,"search_blue"),h.searchBtn.x=o.width+4*a+.5*h.searchBtn.width,h.searchBtn.on(String(y.ClickEvent.Tap),h.onSearchHandler,h),h.add(h.searchBtn);var l=i.make.graphics(void 0,!1);return l.fillStyle(16777215),l.fillRoundedRect(-5*a,.5*-o.height,o.width+14*a+h.searchBtn.width,o.height,.5*o.height),h.addAt(l,0),h.setOrigin(0,.5),h}return _(SearchInput,t),SearchInput.prototype.onSearchHandler=function(){this.setBlur(),this.emit("search",this.text)},SearchInput}(d.LabelInput);!function(t){function NavigateContaienr(i,o,r,a,l,c){var u=t.call(this,i,o,r)||this;u.setSize(a,l),u.chars=[];for(var p=0;p<26;p++)u.chars.push(String.fromCharCode(p+65));u.chars.push("#"),u.texts=[];var d=l/u.chars.length,m={color:"#0",fontSize:8*c,fontFamily:h.a.DEFULT_FONT},y=0,g=0;for(p=0;p<u.chars.length;p++){var _=u.scene.make.text({y:p*d-.5*u.height,text:u.chars[p],style:m}).setOrigin(.5);u.texts[p]=_,y||(y=_.width+8*c,g=_.height+2*c)}return u.selected=u.scene.make.graphics(void 0,!1),u.selected.fillStyle(3115002),u.selected.fillRect(.5*-y,.5*-g,y,g),u.add(u.selected),u.selected.x=u.texts[0].x,u.selected.y=u.texts[0].y,u.add(u.texts),u}_(NavigateContaienr,t),NavigateContaienr.prototype.checkSlider=function(t){if(t){this.selected.visible=!0;for(var i=0;i<this.chars.length;i++)if(t.localeCompare(this.chars[i])>-1)return this.selected.x=this.texts[i].x,void(this.selected.y=this.texts[i].y)}else this.selected.visible=!1}}(v);!function(t){t[t.Friends=0]="Friends",t[t.Fans=1]="Fans",t[t.Followes=2]="Followes",t[t.Blacklist=3]="Blacklist",t[t.Search=4]="Search",t[t.NewFriend=5]="NewFriend",t[t.Menu=6]="Menu",t[t.NewFans=7]="NewFans",t[t.Null=8]="Null"}(P||(P={}))},function(t,i,o){"use strict";o.r(i),o.d(i,"PicFriend",(function(){return p}));var r,a=o(110),h=o(2),l=o(0),c=o(151),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicFriend(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o.httpService=i.httpService,i.account&&i.account.accountData&&(o.userId=i.account.accountData.id),o}return u(PicFriend,t),PicFriend.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_PLAYER_LIST,this.onPlayerListHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SEARCH_PLAYER,this.onSearchHandler))},PicFriend.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicFriend.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicFriend.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicFriend.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},PicFriend.prototype.fetchFriendInfo=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_ANOTHER_PLAYER_INFO);i.content.platformId=t,this.connection.send(i)},PicFriend.prototype.fetchFriendList=function(t){if(t&&!(t.length<1)){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_PLAYER_LIST);i.content.platformIds=t,this.connection.send(i)}},PicFriend.prototype.searchFriend=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SEARCH_PLAYER);i.content.name=t,this.connection.send(i)},PicFriend.prototype.getFolloweds=function(){if(this.userId)return this.httpService.get("user/"+this.userId+"/followeds");l.a.getInstance().error("fetch follow error, userId does not exist")},PicFriend.prototype.getFans=function(){if(this.userId)return this.httpService.get("user/"+this.userId+"/fans");l.a.getInstance().error("fetch fans error, userId does not exist")},PicFriend.prototype.getBanlist=function(){return this.httpService.get("user/banlist")},PicFriend.prototype.getFriends=function(){return this.httpService.get("user/friends")},Object.defineProperty(PicFriend.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicFriend.prototype.onPlayerListHandler=function(t){this.mEvent.emit(c.PicFriendEvent.PLAYER_LIST,t.content)},PicFriend.prototype.onSearchHandler=function(t){this.mEvent.emit(c.PicFriendEvent.SEARCH_RESULT,t.content)},PicFriend}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i);var r,a,h=o(112),l=o(113),c=o(2),u=o(116),p=o(114),d=o(153),m=o(154),y=o(256),g=o(111),_=o(115),v=o(120),b=o(257),P=o(139),w=o(109),S=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),__spreadArrays=function(){for(var t=0,i=0,o=arguments.length;i<o;i++)t+=arguments[i].length;var r=Array(t),a=0;for(i=0;i<o;i++)for(var h=arguments[i],l=0,c=h.length;l<c;l++,a++)r[a]=h[l];return r},C=Phaser.GameObjects.Container,T=function(t){function CharacterInfoPanel(i,o){var r=t.call(this,i,o)||this;return r.key="player_info",r.commonkey="common_key",r.isOwner=!0,r}return S(CharacterInfoPanel,t),CharacterInfoPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,r,a),this.content.setPosition(r/2,a/2),this.mSkillGrideTable.resetMask(),this.content.setInteractive(),this.mCategoryScroll.refreshMask();var h=this.mFirendMenu.getWorldTransformMatrix();this.mFirendMenu.addMask(h.tx-42*this.dpr*this.scale,h.ty,200*this.dpr*this.scale,80*this.dpr*this.scale)},CharacterInfoPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,t&&this.setPlayerData(t),this.setInteractive(),this.addListen()):this.preload())},CharacterInfoPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(String(w.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.on(String(w.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.on(String(w.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.on(String(w.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.on(String(w.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.register(),this.mFirendMenu.on("track",this.onTrackHandler,this),this.mFirendMenu.on("invite",this.onIntiveHandler,this),this.mCharacterMenu.register(),this.mCharacterMenu.on("addBlack",this.onAddBlacklistHandler,this),this.mCharacterMenu.on("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(String(w.ClickEvent.Tap),this.OnClosePanel,this),this.nickEditor.off(String(w.ClickEvent.Tap),this.onEditorHandler,this),this.privaCharBtn.off(String(w.ClickEvent.Tap),this.onPrivateChatHandler,this),this.addFriendBtn.off(String(w.ClickEvent.Tap),this.onAddFriendHandler,this),this.mExitBtn.off(String(w.ClickEvent.Tap),this.onExitHandler,this),this.mFirendMenu.unregister(),this.mFirendMenu.off("track",this.onTrackHandler,this),this.mFirendMenu.off("invite",this.onIntiveHandler,this),this.mCharacterMenu.unregister(),this.mCharacterMenu.off("addBlack",this.onAddBlacklistHandler,this),this.mCharacterMenu.off("removeBlack",this.onRemoveBlacklistHandler,this))},CharacterInfoPanel.prototype.preload=function(){this.addAtlas(this.key,"player_info/player_info.png","player_info/player_info.json"),this.commonkey=_.UIAtlasKey.commonKey,this.addAtlas(this.commonkey,_.UIAtlasName.commonUrl+".png",_.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},CharacterInfoPanel.prototype.init=function(){var i=this,o=this.scaleWidth,r=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,o,r),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"bg"}),this.content=this.scene.make.container(void 0,!1),this.content.setSize(this.bg.width,this.bg.height),this.add(this.content),this.content.add(this.bg),this.mainCon=this.scene.make.container(void 0,!1),this.mainCon.setSize(this.bg.width,this.bg.height),this.content.add(this.mainCon);var a=.5*-this.bg.height+43*this.dpr,h="bold "+15*this.dpr+"px Source Han Sans";this.labelText=this.scene.make.text({x:0,y:a,text:p.a.t("player_info.title"),style:{font:h,bold:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:l.a.DEFULT_FONT}}).setOrigin(.5,0),this.labelText.setStroke("#8F4300",1),this.closeBtn=new w.Button(this.scene,this.commonkey,"close"),this.closeBtn.setPosition(.5*this.mainCon.width-30*this.dpr,a-10*this.dpr),this.likeBtn=new w.Button(this.scene,this.key,"praise_bef","praise_bef","999"),this.likeBtn.setTextStyle({fontSize:13*this.dpr,fontFamily:l.a.DEFULT_FONT}),this.likeBtn.text.setOrigin(0,.5).x+=10*this.dpr,this.likeBtn.setPosition(.5*this.bg.width-50*this.dpr,a+50*this.dpr),this.likeBtn.visible=!1,this.avatar=new d.a(this.scene,void 0,void 0,!0),this.avatar.scale=2*this.dpr,this.avatar.x=0,this.avatar.y=-70*this.dpr,this.avatar.once("initialized",(function(){i.avatar.play({name:"idle",flip:!1})})),this.mainCon.add([this.labelText,this.closeBtn,this.likeBtn,this.avatar]),this.mFirendMenu=new I(this.scene,this.dpr,this.scale),this.mFirendMenu.x=.5*this.bg.width-this.mFirendMenu.width-14*this.dpr,this.mFirendMenu.y=.5*-this.bg.height+200*this.dpr,this.mCharacterMenu=new M(this.scene,this.dpr,this.scale),this.mCharacterMenu.x=.5*this.bg.width-this.mCharacterMenu.width-14*this.dpr,this.mCharacterMenu.y=.5*-this.bg.height+100*this.dpr,this.mExitBtn=new w.NineSliceButton(this.scene,.5*-this.bg.width+40*this.dpr,this.labelText.y+.5*this.labelText.height,48*this.dpr,26*this.dpr,this.commonkey,"yellow_btn_normal_s","注销",this.dpr,this.scale,{left:8*this.dpr,top:8*this.dpr,right:8*this.dpr,bottom:10*this.dpr}),this.mExitBtn.setTextStyle({fontSize:10*this.dpr,fontFamily:l.a.DEFULT_FONT}),this.mainCon.add([this.mFirendMenu,this.mCharacterMenu,this.mExitBtn]);var c=Math.round(.5*-this.bg.width+25*this.dpr),u=Math.round(.5*this.bg.height-324*this.dpr)+30*this.dpr,m=Math.round(13*this.dpr);this.nickName=new w.BBCodeText(this.scene,c,u,"",{}).setOrigin(0,.5).setFontSize(m).setFontFamily(l.a.DEFULT_FONT),this.nickEditor=new w.Button(this.scene,this.key,"edit","edit"),this.nickEditor.setPosition(.5*this.bg.width-30*this.dpr,u).visible=!1;var y=this.scene.make.image({x:0,y:this.nickName.y+12*this.dpr,key:this.key,frame:"splitters"});y.scaleY=this.dpr,this.idText=new w.BBCodeText(this.scene,c,u).setFontSize(m).setOrigin(0,.5).setFontFamily(l.a.DEFULT_FONT).setColor("#0062BC");var g=this.scene.make.image({x:0,y:this.idText.y+12*this.dpr,key:this.key,frame:"splitters"});g.scaleY=this.dpr,this.titleName=new w.BBCodeText(this.scene,c,u+30*this.dpr).setFontSize(m).setOrigin(0,.5).setFontFamily(l.a.DEFULT_FONT);var _=this.scene.make.image({x:0,y:this.titleName.y+12*this.dpr,key:this.key,frame:"splitters"});_.scaleY=this.dpr;var P=this.scene.make.image({x:0,y:0,key:this.key,frame:"level_bg"});this.lvText=this.scene.make.text({x:0,y:0,text:"lv 98",style:{color:"#996600",fontSize:m,fontFamily:l.a.DEFULT_FONT}}).setOrigin(.5,.5),this.lvCon=this.scene.make.container(void 0,!1),this.lvCon.setSize(P.width,P.height),this.lvCon.setPosition(.5*-this.content.width+.5*this.lvCon.width+20*this.dpr,.5*-this.content.height+90*this.dpr),this.lvCon.add([P,this.lvText]),this.mainCon.add([this.nickName,this.nickEditor,y,g,_,this.titleName,this.lvCon]);var S=260*this.dpr,C=210*this.dpr;this.bottomCon=this.scene.make.container(void 0,!1),this.bottomCon.setSize(S,C),this.bottomCon.setPosition(0,.5*this.bg.height-.5*C-30*this.dpr),this.mainCon.add(this.bottomCon),this.bottombg=this.scene.make.graphics(void 0,!1);var T=32*this.dpr,O=.5*-C+.5*T-3*this.dpr;this.mCategoryScroll=new w.GameScroller(this.scene,{x:0,y:O,width:S,height:T,zoom:this.scale,orientation:1,dpr:this.dpr,space:10*this.dpr,cellupCallBack:function(t){i.onSelectSubCategoryHandler(t)}});var E=this.scene.textures.getFrame(this.key,"skill_bg"),x=E.width+5*this.dpr,B=E.height+8*this.dpr,R=this.bottomCon.width,D=200*this.dpr,L=O+.5*T+.5*D;this.mSkillGrideTable=this.createGrideTable(0,L,R,D,x,B,(function(){return new k(i.scene,0,0,i.key,i.dpr)}),new v.a(this,this.onSelectItemHandler));var A=150*this.dpr;this.mAttrPanel=new b.CharacterAttributePanel(this.scene,0,L,R-30*this.dpr,A,this.key,this.dpr),this.bottomCon.add([this.bottombg,this.mCategoryScroll,this.mSkillGrideTable,this.mAttrPanel]);var j=-60*this.dpr,H=.5*this.bottomCon.height-20*this.dpr;this.addFriendBtn=new w.NineSliceButton(this.scene,0,H,94*this.dpr,37*this.dpr,this.key,"button_g",p.a.t("player_info.add_friend"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setFrameNormal("button_g"),this.privaCharBtn=new w.NineSliceButton(this.scene,j,H,94*this.dpr,37*this.dpr,this.commonkey,"yellow_btn",p.a.t("player_info.private_chat"),this.dpr,this.scale,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.addFriendBtn.setTextStyle({fontSize:16*this.dpr,color:"#000000"}),this.privaCharBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.bottomCon.add([this.addFriendBtn,this.privaCharBtn]),this.content.visible=!1,this.resize(o,r),t.prototype.init.call(this)},CharacterInfoPanel.prototype.reqPlayerInfo=function(){this.emit("queryOwnerInfo")},CharacterInfoPanel.prototype.setPlayerData=function(t){if(this.mInitialized){this.mCharacterData=t,this.content.visible=!0;var i=t.nickname,o=t.currentTitle,r=(t.level.currentLevelExp,t.level.nextLevelExp,t.cid,t.level.level),h=this.getspaceStr(1*this.dpr);this.avatar&&this.avatar.load(new m.a({id:0,avatar:t.currentAvatar.avatar})),this.titleName.setText(this.getRichLabel(p.a.t("player_info.player_title"))+h+o),this.likeBtn.setText(t.like+"");var l=.5*this.bg.width-.5*this.likeBtn.width-this.likeBtn.text.width;this.likeBtn.x=l-20*this.dpr,this.lvText.text="lv "+r,this.idText.setText("(52365404)");var u=new Map;if(u.set(a.Skill,t.lifeSkills),t instanceof c.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SELF_PLAYER_INFO){this.nickName.setText(this.getRichLabel(p.a.t("player_info.nick_name"))+h+i),this.likeBtn.setFrame("praise_aft"),u.set(a.Attribute,t.properties),u.set(a.Badge,t.badges),this.addFriendBtn.visible=!1,this.privaCharBtn.visible=!1,this.mFirendMenu.visible=!1,this.mExitBtn.visible=!0,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height);var d=200*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,d);var y=0,g=this.mCategoryScroll.y+.5*d+0*this.dpr;this.mSkillGrideTable.refreshPos(y,g),this.mSkillGrideTable.setColumnCount(3),this.isOwner=!0,this.mCharacterMenu.visible=!1,this.mAttrPanel.setSize(this.mAttrPanel.width,d),this.mAttrPanel.y=g+15*this.dpr,this.mAttrPanel.space=20*this.dpr}else{t.remark?t.remark:p.a.t("player_info.note_nickname");this.nickName.setText(this.getRichLabel(p.a.t("player_info.nick_name"))+h+i),this.lvCon.setPosition(this.idText.x+.5*this.lvCon.width,.5*-this.mainCon.height+100*this.dpr),this.likeBtn.setFrame("praise_bef"),u.set(a.Attribute,t.properties),u.set(a.Badge,t.badges),this.addFriendBtn.visible=!t.friend,this.privaCharBtn.visible=t.friend,this.mExitBtn.visible=!1,this.bottombg.clear(),this.bottombg.fillStyle(7004927,1),this.bottombg.fillRect(.5*-this.bottomCon.width,.5*-this.bottomCon.height,this.bottomCon.width,this.bottomCon.height-55*this.dpr);d=150*this.dpr;this.mSkillGrideTable.setSize(this.mSkillGrideTable.width,d);y=0,g=this.mCategoryScroll.y+.5*d+0*this.dpr;this.mSkillGrideTable.refreshPos(y,g),this.mSkillGrideTable.setColumnCount(2),this.isOwner=!1,this.mCharacterMenu.visible=!0,this.mAttrPanel.setSize(this.mAttrPanel.width,d),this.mAttrPanel.y=g+15*this.dpr,this.mAttrPanel.space=10*this.dpr}this.idText.x=this.nickName.x+this.nickName.width*(1-this.nickName.originX)+8*this.dpr,this.mFirendMenu.visible=!1,this.setSubCategory(u),this.setFriendRelation(P.FriendRelationEnum.Null)}else this.mShowData=t},CharacterInfoPanel.prototype.setFriendRelation=function(t){this.isOwner||(this.mRelation=t,this.mFirendMenu.visible=t===P.FriendRelationEnum.Friend,this.mCharacterMenu.setIsBlack(t===P.FriendRelationEnum.Blacklist),this.addFriendBtn.visible=t!==P.FriendRelationEnum.Blacklist,t===P.FriendRelationEnum.Followed||t===P.FriendRelationEnum.Friend?this.addFriendBtn.setText(p.a.t("friendlist.unfollow")):this.addFriendBtn.setText(p.a.t("friendlist.follow")))},CharacterInfoPanel.prototype.destroy=function(){this.mSkillGrideTable.destroy(),this.mCategoryScroll.destroy(),t.prototype.destroy.call(this)},CharacterInfoPanel.prototype.createGrideTable=function(t,i,o,r,a,h,l,c){var u=this,p={x:t,y:i,table:{width:o,height:r,columns:3,cellWidth:a,cellHeight:h,reuseCellContainer:!0,cellPadX:24*this.dpr,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=l()),i.setData({item:o}),i.setItemData(o,u.isOwner),i}},d=new w.GameGridTable(this.scene,p);return d.layout(),d.on("cellTap",(function(t){t&&c.runWith(t)})),d},CharacterInfoPanel.prototype.OnClosePanel=function(){this.emit("hide")},CharacterInfoPanel.prototype.setSubCategory=function(t){var i=this,o=(p.a.t("player_info.option_live"),p.a.t("player_info.option_attribute"),p.a.t("player_info.option_badge"),this.mScene.textures.getFrame(this.key,"title_select").width),r=[];this.mCategoryScroll.clearItems(!0),t.forEach((function(t,a){var h=i.getOptionName(a),c=new w.Button(i.scene,i.key,"title_normal","title_select",h);c.width=o,c.height=41*i.dpr,r.push(c),c.setTextStyle({color:"#2B4BB5",fontSize:12*i.dpr,fontFamily:l.a.BOLD_FONT}),c.disInteractive(),c.removeListen(),c.setData("subData",t),c.setData("optiontype",a),i.mCategoryScroll.addItem(c)})),r.length<=3?this.mCategoryScroll.setAlign(1):this.mCategoryScroll.setAlign(2),this.onSelectSubCategoryHandler(r[0])},CharacterInfoPanel.prototype.onSelectSubCategoryHandler=function(t){this.curSelectCategeory&&(this.curSelectCategeory.changeNormal(),this.curSelectCategeory.setTextColor("#2B4BB5")),t.changeDown(),t.setTextColor("#996600"),this.curSelectCategeory=t;var i=t.getData("subData"),o=t.getData("optiontype");o===a.Skill?(this.mSkillGrideTable.setItems(i),this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!0):o===a.Attribute?(i&&this.mAttrPanel.setAttributeData(i),this.mAttrPanel.visible=!0,this.mSkillGrideTable.setItems([]),this.mSkillGrideTable.visible=!1):o===a.Badge&&(this.mAttrPanel.visible=!1,this.mSkillGrideTable.visible=!1)},CharacterInfoPanel.prototype.onSelectItemHandler=function(t){},CharacterInfoPanel.prototype.onEditorHandler=function(){var t=247*this.dpr,i=this.content.height;this.editorPanel||(this.editorPanel=new y.CharacterEditorPanel(this.scene,0,0,t,i,this.key,this.dpr)),this.content.add(this.editorPanel),this.editorPanel.visible=!0,this.editorPanel.on("editorHide",this.onEditorPanelHideHandler,this),this.setMainUIVisible(!1)},CharacterInfoPanel.prototype.onAddFriendHandler=function(){if(this.mCharacterData)switch(this.mRelation){case P.FriendRelationEnum.Friend:case P.FriendRelationEnum.Followed:this.emit("unfollow",this.mCharacterData.cid);break;case P.FriendRelationEnum.Fans:case P.FriendRelationEnum.Null:this.emit("follow",this.mCharacterData.cid)}},CharacterInfoPanel.prototype.onTradingHandler=function(){},CharacterInfoPanel.prototype.onPrivateChatHandler=function(){},CharacterInfoPanel.prototype.onExitHandler=function(){this.mWorld.exitUser()},CharacterInfoPanel.prototype.onEditorPanelHideHandler=function(){this.mainCon.visible=!0,this.remove(this.editorPanel),this.editorPanel.off("editorHide",this.onEditorPanelHideHandler,this),this.editorPanel.destroy(),this.editorPanel=null,this.setMainUIVisible(!0)},CharacterInfoPanel.prototype.setMainUIVisible=function(t){this.avatar.visible=t,this.mCategoryScroll.visible=t,this.mSkillGrideTable.visible=t,this.mainCon.visible=t},CharacterInfoPanel.prototype.getRichLabel=function(t,i){return void 0===i&&(i="#2B4BB5"),"[stroke="+i+"][color="+i+"]"+t+":[/color][/stroke]"},CharacterInfoPanel.prototype.getspaceStr=function(t){for(var i="",o=0;o<t;o++)i+=" ";return i},CharacterInfoPanel.prototype.getOptionName=function(t){var i="";return t===a.Skill?i=p.a.t("player_info.option_live"):t===a.Attribute?i=p.a.t("player_info.option_attribute"):t===a.Badge?i=p.a.t("player_info.option_badge"):t===a.Title&&(i=p.a.t("player_info.option_title")),i},CharacterInfoPanel.prototype.onTrackHandler=function(){this.mCharacterData&&this.emit("track",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onIntiveHandler=function(){this.mCharacterData&&this.emit("invite",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onAddBlacklistHandler=function(){this.mCharacterData&&this.emit("addBlack",this.mCharacterData.cid)},CharacterInfoPanel.prototype.onRemoveBlacklistHandler=function(){this.mCharacterData&&this.emit("removeBlack",this.mCharacterData.cid)},CharacterInfoPanel}(h.BasePanel);i.default=T,function(t){t[t.Skill=0]="Skill",t[t.Attribute=1]="Attribute",t[t.Badge=2]="Badge",t[t.Title=3]="Title",t[t.Avatar=4]="Avatar"}(a||(a={}));var k=function(t){function CharacterOwnerItem(i,o,r,a,h){var c=t.call(this,i,o,r)||this;c.dpr=0;var p=c.scene.make.image({x:0,y:0,key:a,frame:"skill_bg"});return c.nameText=c.scene.make.text({x:-1*h,y:0,text:"",style:{color:"#996600",fontSize:12*h,fontFamily:l.a.DEFULT_FONT}}).setOrigin(0,.5),c.lvText=c.scene.make.text({x:-1*h,y:0,text:"",style:{color:"#996600",fontSize:12*h,fontFamily:l.a.DEFULT_FONT}}).setOrigin(0,.5),c.progressBar=new w.ProgressBar(c.scene,{x:48*h/2,y:15*h,width:41*h,height:4*h,background:{x:0,y:0,width:41*h,height:4*h,config:{top:1*h,left:2*h,right:2*h,bottom:1*h},key:a,frame:"slider_bg"},bar:{x:0,y:0,width:41*h,height:4*h,config:{top:1*h,left:2*h,right:2*h,bottom:1*h},key:a,frame:"slider_rate"},dpr:h,textConfig:void 0}),c.icon=new u.DynamicImage(c.scene,.5*-p.width+22*h,0),c.add([p,c.icon,c.nameText,c.lvText,c.progressBar]),c.setSize(p.width,p.height),c.dpr=h,c.key=a,c}return S(CharacterOwnerItem,t),CharacterOwnerItem.prototype.setItemData=function(t,i){var o=this;void 0===i&&(i=!1),this.itemData=t,this.nameText.text=t.name;var r=i?-16*this.dpr:-11*this.dpr,a=i?20*this.dpr:25*this.dpr,h=10*this.dpr;this.nameText.y=r+.5*h,this.icon.setTexture(this.key,"test_skillicon");var l=this.icon.width;t.level?(this.lvText.text=t.level.level,this.lvText.y=r+a,this.progressBar.setProgress(t.level.currentLevelExp,t.level.nextLevelExp),this.progressBar.visible=i):(this.progressBar.visible=!1,this.lvText.visible=!1);var c=g.i.getOsdRes(t.display.texturePath);this.icon.load(c,this,(function(){o.icon.scale=o.dpr;var t=.5*-o.width+.5*l+6*o.dpr;o.icon.setPosition(t,0)}))},CharacterOwnerItem}(C),O=function(t){function Menu(i,o,r,a,h){var l=t.call(this,i)||this;return l.mDpr=o,l.mScale=r,l.setSize(a,h),l.draw(),l}return S(Menu,t),Menu.prototype.register=function(){},Menu.prototype.unregister=function(){},Menu.prototype.addMask=function(t,i,o,r){this.maskGraphic||(this.maskGraphic=this.scene.make.graphics(void 0,!1)),this.maskGraphic.x=t,this.maskGraphic.y=i,this.maskGraphic.fillRect(.5*-o,.5*-r,o,r),this.setMask(this.maskGraphic.createGeometryMask())},Menu.prototype.draw=function(){this.createBackground()},Menu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t}),this.addAt(this.background,0)},Menu}(C),I=function(t){function FriendMenu(i,o,r){var a=t.call(this,i,o,r,58*o,40*o)||this;return a.isExpand=!1,a}return S(FriendMenu,t),FriendMenu.prototype.register=function(){this.trackBtn.on(String(w.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.on(String(w.ClickEvent.Tap),this.onInviteHandler,this);var t=this.operation,i=t.width,o=t.height;this.operation.setInteractive(new Phaser.Geom.Rectangle(-i,-o,3*i,3*o),Phaser.Geom.Rectangle.Contains),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.unregister=function(){this.trackBtn.off(String(w.ClickEvent.Tap),this.onTrackHandler,this),this.inviteBtn.off(String(w.ClickEvent.Tap),this.onInviteHandler,this),this.operation.disableInteractive(),this.operation.on("pointerup",this.onSwitchOperationHandler,this)},FriendMenu.prototype.destroy=function(){this.operationContaienr&&this.operationContaienr.destroy(),this.operation&&this.operation.destroy(),this.inviteBtn&&this.inviteBtn.destroy(),this.trackBtn&&this.trackBtn.destroy(),this.tween&&this.tween.stop(),this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.buttons=[]},FriendMenu.prototype.expand=function(){var t=this;if(!this.tween||!this.tween.isPlaying()){this.operationContaienr.remove(this.operation),this.operationContaienr.remove(this.background),this.operationContaienr.add(this.buttons);var i=this.getBounds();if(this.isExpand=!0,i){var o=i.width+8*this.mDpr;this.setSize(o,this.height),this.createBackground(),this.operationContaienr.addAt(this.background,0),this.operationContaienr.x=.5*i.width,this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*-i.width,alpha:1},duration:100}),this.autoCollapseTime=setTimeout((function(){t.autoCollapseTime=null,t.collapse()}),3e3)}}},FriendMenu.prototype.collapse=function(){var t=this;this.tween&&this.tween.isPlaying()||(this.autoCollapseTime&&clearTimeout(this.autoCollapseTime),this.tween=this.scene.tweens.add({targets:this.operationContaienr,props:{x:.5*this.width},duration:100,onComplete:function(){t.operationContaienr.remove(__spreadArrays(t.buttons),!1),t.operationContaienr.add(t.operation),t.setSize(58*t.mDpr,40*t.mDpr),t.createBackground(),t.operationContaienr.addAt(t.background,0),t.operationContaienr.x=0,t.isExpand=!1}}))},FriendMenu.prototype.draw=function(){this.operationContaienr=this.scene.make.container(void 0,!1),this.add(this.operationContaienr),this.buttons=[],this.inviteBtn=this.createButton(p.a.t("player_info.invite")),this.buttons.push(this.inviteBtn),this.trackBtn=this.createButton(p.a.t("player_info.track")),this.buttons.push(this.trackBtn),this.operation=this.scene.make.text({x:.5*this.width,y:.5*this.height,text:p.a.t("player_info.operation"),style:{color:"#FFD248",fontSize:10*this.mDpr,fontFamily:l.a.DEFULT_FONT}},!1).setOrigin(.5);for(var t=0;t<this.buttons.length;t++)this.buttons[t].x=0===t?.5*this.buttons[t].width+6*this.mDpr:this.buttons[t-1].x+.5*(this.buttons[t-1].width+this.buttons[t].width)+6*this.mDpr,this.buttons[t].y=.5*this.height;this.collapse()},FriendMenu.prototype.createBackground=function(){this.background||(this.background=this.scene.make.graphics(void 0,!1));var t=3*this.mDpr;this.background.clear(),this.background.fillStyle(7583,.2),this.background.fillRoundedRect(0,0,this.width,this.height,{tl:t,tr:0,br:0,bl:t})},FriendMenu.prototype.onTrackHandler=function(){this.emit("track"),this.collapse()},FriendMenu.prototype.onInviteHandler=function(){this.emit("invite"),this.collapse()},FriendMenu.prototype.onSwitchOperationHandler=function(){this.isExpand?this.collapse():this.expand()},FriendMenu.prototype.createButton=function(t){var i=this.mDpr,o=this.mScale,r=new w.NineSliceButton(this.scene,-0,0,48*i,26*i,_.UIAtlasKey.commonKey,"yellow_btn_normal_s",t,i,o,{left:8*i,top:8*i,right:8*i,bottom:10*i});return r.setTextStyle({color:"#996600",fontSize:10*i,fontFamily:l.a.DEFULT_FONT}),r},FriendMenu}(O),M=function(t){function CharacterMenu(i,o,r){return t.call(this,i,o,r,58*o,36*o)||this}return S(CharacterMenu,t),CharacterMenu.prototype.register=function(){this.addBlacklistBtn.on(String(w.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.unregister=function(){this.addBlacklistBtn.off(String(w.ClickEvent.Tap),this.onAddBlackHandler,this)},CharacterMenu.prototype.setIsBlack=function(t){this.isBlack=t,this.addBlacklistBtn.setText(p.a.t(t?"player_info.remove_black":"player_info.add_black"))},CharacterMenu.prototype.draw=function(){t.prototype.draw.call(this),this.addBlacklistBtn=new w.NineSliceButton(this.scene,0,0,55*this.mDpr,24*this.mDpr,_.UIAtlasKey.commonKey,"red_btn_normal",p.a.t("player_info.add_black"),this.mDpr,this.mScale,{left:12*this.mDpr,top:12*this.mDpr,right:12*this.mDpr,bottom:12*this.mDpr}),this.addBlacklistBtn.setTextStyle({color:"#FFFFFF",fontSize:10*this.mDpr,fontFamily:l.a.DEFULT_FONT}),this.addBlacklistBtn.x=.5*this.width,this.addBlacklistBtn.y=6*this.mDpr+.5*this.addBlacklistBtn.height,this.add(this.addBlacklistBtn)},CharacterMenu.prototype.onAddBlackHandler=function(){this.emit(this.isBlack?"removeBlack":"addBlack")},CharacterMenu}(O)},function(t,i,o){"use strict";o.r(i),o.d(i,"CharacterEditorPanel",(function(){return p}));var r,a=o(113),h=o(121),l=o(114),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function CharacterEditorPanel(i,o,r,l,u,p,d){var m=t.call(this,i,o,r)||this;m.dpr=0,m.key="",m.setSize(l,u),m.key=p,m.dpr=d;var y="bold "+15*m.dpr+"px Source Han Sans";m.title=m.scene.make.text({x:0,y:.5*-u+50*d,text:m.geti18n("edit_profile"),style:{font:y,blod:!0,color:"#ffffff",fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5);var g=m.scene.make.graphics(void 0,!1);g.clear(),g.fillStyle(16777215,.5),g.fillRect(0,0,247*d,350*d),g.setPosition(.5*-l,-184*d);var _=.5*-l+9*d,v=-170*d,b=50*d,P=m.scene.make.text({x:_,y:v,style:{blod:!0,color:"#0062BB",fontSize:15*d,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0);P.setText(m.geti18n("user_name")+":"),m.inputText=new c.InputText(m.scene,_+P.width+20*d,v,162*d,27*d,{type:"input",fontSize:18*d+"px",color:"#0062BB",align:"center",placeholder:m.geti18n("input_nickname")}).setOrigin(0);var w=m.createLine(-230*m.dpr*.5,v+32*m.dpr);m.add(g),m.add([m.title,P,m.inputText,w]),m.idText=m.createText("I        D:","",_,v+b),m.constellationText=m.createText(m.geti18n("constellation")+":","",_,v+2*b),m.birthdayText=m.createText(m.geti18n("birthday")+":","",_,v+3*b),m.cityText=m.createText(m.geti18n("city")+":","",_,v+4*b);var S=m.scene.make.text({x:_,y:v+5*b,style:{blod:!0,color:"#0062BB",fontSize:15*d,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0);S.setText(m.geti18n("signature")+":"),m.signInput=new c.InputText(m.scene,_+S.width+20*d,v+5*b,162*d,76*d,{type:"input",fontSize:18*d+"px",color:"#0062BB",align:"center",placeholder:m.geti18n("input_signature")}).setOrigin(0),m.add([S,m.signInput]);var C=new c.Button(m.scene,"common_key","back_arrow","back_arrow"),T=new h.NinePatchButton(m.scene,0,.5*u-40*d,174*m.dpr,37*m.dpr,"common_key","yellow_btn",m.geti18n("save"),{left:12*m.dpr,top:12*m.dpr,right:12*m.dpr,bottom:12*m.dpr});return T.setTextStyle({fontSize:16*m.dpr,color:"#ED7814"}),C.setPosition(_+8*d,.5*-u+50*d),C.on("Tap",m.onBackHandler,m),T.on("Tap",m.onSaveHandler,m),m.add([C,T]),m}return u(CharacterEditorPanel,t),CharacterEditorPanel.prototype.destroy=function(){this.inputText&&this.inputText.destroy(),this.signInput&&this.signInput.destroy(),t.prototype.destroy.call(this)},CharacterEditorPanel.prototype.createText=function(t,i,o,r){var h=this.scene.make.text({x:o,y:r,style:{blod:!0,color:"#0062BB",fontSize:15*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0,0);h.setText(t);var l=this.scene.make.text({x:o+h.width+20*this.dpr,y:r,text:i,style:{blod:!0,color:"#ffffff",fontSize:15*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0,0),c=this.createLine(-230*this.dpr*.5,r+32*this.dpr);return this.add([h,l,c]),l},CharacterEditorPanel.prototype.geti18n=function(t){return l.a.t("player_info."+t)},CharacterEditorPanel.prototype.createLine=function(t,i){var o=this.scene.make.graphics(void 0,!1);return o.clear(),o.fillStyle(25275,.6),o.fillRect(0,0,230*this.dpr,3),o.setPosition(t,i),o},CharacterEditorPanel.prototype.onBackHandler=function(){this.visible=!1,this.emit("editorHide")},CharacterEditorPanel.prototype.onSaveHandler=function(){},CharacterEditorPanel}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"CharacterAttributePanel",(function(){return p}));var r,a=o(113),h=o(116),l=o(111),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function CharacterAttributePanel(i,o,r,a,h,l,c){var u=t.call(this,i,o,r)||this;return u.attriItems=[],u.setSize(a,h),u.key=l,u.dpr=c,u.mspace=10*c,u}return u(CharacterAttributePanel,t),Object.defineProperty(CharacterAttributePanel.prototype,"space",{set:function(t){this.mspace=t},enumerable:!1,configurable:!0}),CharacterAttributePanel.prototype.setAttributeData=function(t){for(var i=t.length,o=i>4?2:1,r=this.width,a=this.height,h=20*this.dpr,l=r/2,c=.5*-a+10*this.dpr,u=0,p=this.attriItems;u<p.length;u++){(y=p[u]).visible=!1}for(var m=0;m<i;m++){var y=void 0;m<this.attriItems.length?y=this.attriItems[m]:(y=new d(this.scene,0,0,l,h,this.key,this.dpr),this.add(y),this.attriItems.push(y));var g=.5*(r-r/o)*(m<4?-1:1),_=c+.5*h+(h+this.mspace)*(m%4);y.setPosition(g,_),y.setInfo(t[m]),y.visible=!0}},CharacterAttributePanel}(Phaser.GameObjects.Container),d=function(t){function PlayerAttributeValue(i,o,r,l,u,p,d){var m=t.call(this,i,o,r)||this;return m.dpr=d,m.setSize(l,u),m.icon=new h.DynamicImage(m.scene,0,0),m.icon.x=.5*-l+10*d,m.nameText=m.scene.make.text({x:m.icon.x+13*d,y:0,text:"Attack:",style:{fontFamily:a.a.DEFULT_FONT,fontSize:11*d,color:"#131313"}}).setOrigin(0,.5),m.valueText=new c.BBCodeText(m.scene,0,0,"100",{color:"#131313",fontSize:11*m.dpr,fontFamily:a.a.DEFULT_FONT}).setOrigin(0,.5),m.valueText.x=m.nameText.x+m.nameText.width,m.add([m.icon,m.nameText,m.valueText]),m}return u(PlayerAttributeValue,t),PlayerAttributeValue.prototype.setInfo=function(t){var i=this;if(t.display){var o=l.i.getOsdRes(t.display.texturePath);this.icon.load(o,this,(function(){i.icon.displayWidth=20*i.dpr,i.icon.scaleY=i.icon.scaleX}))}this.nameText.text=t.name+":",this.valueText.text=t.value+(t.tempValue?this.getRichLabel(t.tempValue):""),this.valueText.x=this.nameText.x+this.nameText.width+3*this.dpr},PlayerAttributeValue.prototype.getRichLabel=function(t,i){return void 0===i&&(i="#0B77CD"),"[color="+i+"](+"+t+")[/color]"},PlayerAttributeValue}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"ComponentRankMediator",(function(){return c}));var r,a=o(259),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ComponentRankMediator(i,o,r){var l=t.call(this)||this;return l.mUIType=h.UIType.Normal,l.mView=new a.ComponentRankPanel(o,r),i.addToUILayer(l.mView),l.mLayerManager=i,l.mScene=o,l.world=r,l}return l(ComponentRankMediator,t),ComponentRankMediator.prototype.getName=function(){return""},ComponentRankMediator.prototype.hide=function(){this.mShow=!1,this.mView&&(this.mView.hide(),this.mView=null)},ComponentRankMediator.prototype.isSceneUI=function(){return!1},ComponentRankMediator.prototype.isShow=function(){return!1},ComponentRankMediator.prototype.resize=function(){this.mView.resize()},ComponentRankMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||(this.mView=new a.ComponentRankPanel(this.mScene,this.world),this.mLayerManager.addToUILayer(this.mView),this.mView.show(),i&&i.length>0&&this.mView.addItem(i[0]),t.prototype.show.call(this,i))},ComponentRankMediator.prototype.destroy=function(){this.mView&&this.mView.parentContainer&&this.mView.parentContainer.remove(this.mView),t.prototype.destroy.call(this)},ComponentRankMediator.prototype.update=function(t){t&&t.length>0&&this.mView.addItem(t[0])},ComponentRankMediator.NAME="ComponentRankMediator",ComponentRankMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ComponentRankPanel",(function(){return u}));var r,a=o(160),h=o(111),l=o(258),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function ComponentRankPanel(i,o){return t.call(this,i,o)||this}return c(ComponentRankPanel,t),ComponentRankPanel.prototype.addListen=function(){this.mCloseBtn.on("pointerup",this.onCloseHandler,this)},ComponentRankPanel.prototype.removeListen=function(){this.mCloseBtn.off("pointerup",this.onCloseHandler,this)},ComponentRankPanel.prototype.resize=function(t,i){if(this.scene){var o=this.scene.cameras.main.worldView;this.x=o.width-this.width-t>>1,this.y=o.height-this.height-i>>1}},ComponentRankPanel.prototype.destroy=function(){this.mCloseBtn&&(this.mCloseBtn.destroy(!0),this.mCloseBtn=null),t.prototype.destroy.call(this)},ComponentRankPanel.prototype.preload=function(){this.scene.load.spritesheet(h.e.getName(),h.e.getPNG(),h.e.getFrameConfig()),t.prototype.preload.call(this)},ComponentRankPanel.prototype.init=function(){this.mCloseBtn=this.scene.make.image({x:0,y:0,key:h.e.getName(),frame:"btn_normal"},!1),this.mCloseBtn.setTexture(h.e.getName(),"btn_normal"),this.mCloseBtn.x=(this.width>>1)-65,this.mCloseBtn.y=-this.height>>1,t.prototype.init.call(this),this.add(this.mCloseBtn),this.mCloseBtn.setInteractive(),this.mWorld.uiManager.getMediator(l.ComponentRankMediator.NAME).resize(),this.mCloseBtn.x=this.width-18},ComponentRankPanel.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.getMediator(l.ComponentRankMediator.NAME).resize()},ComponentRankPanel.prototype.onCloseHandler=function(){this.hide()},ComponentRankPanel}(a.BasicRankPanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ControlFPanel",(function(){return u}));var r,a=o(112),h=o(111),l=o(113),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function ControlFPanel(i,o){var r=t.call(this,i,o)||this;return r.setTween(!1),r}return c(ControlFPanel,t),ControlFPanel.prototype.addListen=function(){this.on("pointerdown",this.onMouseDownHandler,this)},ControlFPanel.prototype.removeListen=function(){this.off("pointerdown",this.onMouseDownHandler,this)},ControlFPanel.prototype.resize=function(t,i){if(void 0===t&&(t=0),void 0===i&&(i=0),this.mScene){var o=this.mScene.cameras.main.worldView;this.x=o.x+(o.width>>1),this.y=o.y+(o.height>>1)}},ControlFPanel.prototype.destroy=function(){this.mControlText&&this.mControlText.destroy(!0),t.prototype.destroy.call(this)},ControlFPanel.prototype.preload=function(){this.mScene.load.image("controlF_background",h.i.getRes("ui/controlf/background.png")),t.prototype.preload.call(this)},ControlFPanel.prototype.init=function(){if(this.mScene){var i=this.mScene.make.image({key:"controlF_background"},!1);this.add(i),this.mControlText=this.mScene.make.text({align:"center",text:"F",style:{font:l.a.YAHEI_20_BOLD}},!1),this.mControlText.x=-(this.mControlText.width>>1),this.mControlText.y=-(this.mControlText.height>>1),this.add(this.mControlText),this.setSize(i.width,i.height),this.setInteractive(),t.prototype.init.call(this),this.resize()}},ControlFPanel.prototype.onMouseDownHandler=function(){this.scale=.8},ControlFPanel.prototype.onMouseUpHandler=function(){this.scale=1,this.emit("control")},ControlFPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"CutInPanel",(function(){return u}));var r,a=o(112),h=o(111),l=o(113),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function CutInPanel(i,o){var r=t.call(this,i,o)||this;return r.key="cut_in",r}return c(CutInPanel,t),CutInPanel.prototype.show=function(t){var i=this;if(this.mShowData=t,this.mInitialized){if(t&&t.length>0){var o=t[0].text;this.mName&&this.mName.setText(o[0].text)}else this.mName&&this.mName.setText("???");var r=this.scene.cameras.main.width;this.x=r+this.width/2;var a=this.scene.cameras.main.width/2;this.scene.tweens.timeline({targets:this,duration:300,tweens:[{x:a,alpha:1,ease:"Sine.easeInOut"},{delay:2e3,y:this.y-10*this.dpr,alpha:0}],onComplete:function(){i.emit("close")}})}else this.preload()},CutInPanel.prototype.resize=function(t,i){this.y=140*this.dpr},CutInPanel.prototype.preload=function(){this.scene.load.image(this.key,h.i.getUIRes(this.dpr,"cut_in/cut_in_bg.png")),t.prototype.preload.call(this)},CutInPanel.prototype.init=function(){var i=this.scene.make.image({key:this.key},!1);this.setSize(i.width*this.scale,i.height*this.scale),this.mName=this.scene.make.text({style:{color:"#ffcc33",fontSize:18*this.dpr,fotnFamily:l.a.DEFULT_FONT}},!1).setOrigin(.5),this.mName.setFontStyle("bold"),this.mName.setStroke("#000000",1*this.dpr),this.add([i,this.mName]),t.prototype.init.call(this),this.resize(this.scene.cameras.main.width,this.scene.cameras.main.height),this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this)},CutInPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"CutInMenu",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function CutInMenu(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(CutInMenu,t),CutInMenu.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},CutInMenu.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},CutInMenu.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},CutInMenu.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},CutInMenu.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},CutInMenu.prototype.reqRightButton=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),r=o.content;r.uiId=t,r.componentId=i,this.connection.send(o)},Object.defineProperty(CutInMenu.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),CutInMenu}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"CutInMenuPanel",(function(){return c}));var r,a=o(112),h=o(120),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function CutInMenuPanel(i,o){var r=t.call(this,i,o)||this;return r.key="cutinmenupanel",r.mapPop=new Map,r.world=o,r}return l(CutInMenuPanel,t),CutInMenuPanel.prototype.resize=function(i,o){t.prototype.resize.call(this,i,o),this.setSize(i,o)},CutInMenuPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen()):this.preload())},CutInMenuPanel.prototype.addListen=function(){this.mInitialized},CutInMenuPanel.prototype.removeListen=function(){this.mInitialized},CutInMenuPanel.prototype.preload=function(){this.addAtlas(this.key,"cutInmenu/cutInmenu.png","cutInmenu/cutInmenu.json"),t.prototype.preload.call(this)},CutInMenuPanel.prototype.init=function(){var i=this.scaleWidth,o=this.scaleHeight;this.rightPopButton=new u(this.scene,i,this.key,this.dpr);var r=i+.5*this.rightPopButton.width-15*this.dpr,a=this.getActivityBounds();a?this.rightPopButton.setPosition(r,a.bottom+this.rightPopButton.height):this.rightPopButton.setPosition(r,.5*o),this.rightPopButton.setClickHandler(new h.a(this,this.onRightClickHandler)),this.add(this.rightPopButton),this.resize(i,o),t.prototype.init.call(this),this.opneButton()},CutInMenuPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},CutInMenuPanel.prototype.opneButton=function(){this.rightPopButton.onTakeBack();var t=this.mShowData[0].button[0];"work"===t.text?this.rightPopButton.setIconFrame("work"):"minecar"===t.text&&this.rightPopButton.setIconFrame("minecar")},CutInMenuPanel.prototype.onRightClickHandler=function(){var t=this.mShowData[0].button[0];"work"===t.text?this.emit("openmed","PicWork"):"minecar"===t.text&&this.emit("openmed","MineCar")},CutInMenuPanel.prototype.getActivityBounds=function(){var t,i=this.world.uiManager.getMediator("ActivityMediator");return i&&(t=i.getView().getBounds()),t},CutInMenuPanel}(a.BasePanel),u=function(t){function RightPopContainer(i,o,r,a){var h=t.call(this,i)||this;h.isPop=!1,h.isPlaying=!1,h.dpr=a,h.key=r,h.scaleWidth=o;var l=h.scene.make.image({key:h.key,frame:"minebag_bg"});h.bgSprite=h.scene.make.image({key:h.key,frame:"minebag_bg_brth"},!1),h.minecar=h.scene.make.image({key:h.key,frame:"minecar"}),h.minecar.setPosition(-12*a,.5*-h.minecar.height),h.teximg=h.scene.make.image({key:h.key,frame:"text_minebag"}),h.teximg.setPosition(h.minecar.x,2*a);var c=h.scene.make.image({key:h.key,frame:"arow"}),u=i.make.container(void 0,!1);return u.setSize(25*a,31*a),u.add(c),u.setPosition(.5*-l.width+10*a,0),h.add([h.bgSprite,l,h.minecar,h.teximg,u]),l.on("pointerup",h.onClickHandler,h),l.setInteractive(),u.on("pointerup",h.onTakeBack,h),u.setInteractive(),h.setSize(l.width,l.height),h.tween=h.scene.tweens.add({targets:h.bgSprite,alpha:{value:0,duration:500,ease:"Power1",yoyo:!0},repeat:-1}),h}return l(RightPopContainer,t),RightPopContainer.prototype.setClickHandler=function(t){this.clickHandler=t},RightPopContainer.prototype.setIconFrame=function(t){this.minecar.setFrame(t)},RightPopContainer.prototype.setPopData=function(t){this.popData=t},RightPopContainer.prototype.play=function(){this.bgSprite.alpha=1,this.tween.resume(),this.isPop=!1},RightPopContainer.prototype.stop=function(){this.tween.pause(),this.bgSprite.alpha=0,this.isPop=!0},RightPopContainer.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this.popData)},RightPopContainer.prototype.onTakeBack=function(){this.isPlaying||this.isPop?!this.isPlaying&&this.isPop&&this.takeback():this.popAnim()},RightPopContainer.prototype.popAnim=function(){this.isPlaying=!0;var t=this.scaleWidth-15*this.dpr,i=this;this.scene.tweens.add({targets:i,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){i.stop(),i.isPlaying=!1}})},RightPopContainer.prototype.takeback=function(){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),this.isPlaying=!0;var t=this.scaleWidth+.5*this.width-15*this.dpr,i=this;this.scene.tweens.add({targets:i,x:{value:t,duration:300,ease:"Bounce.easeOut"},onComplete:function(){i.play(),i.isPlaying=!1}})},RightPopContainer}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"DebugLogger",(function(){return y}));var r,a=o(112),h=o(111),l=o(0),c=o(167),u=o(124),p=o(125),d=o(113),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function DebugLogger(i,o){var r=t.call(this,i,o)||this;return r.mDelay=0,r.setTween(!1),r}return m(DebugLogger,t),DebugLogger.prototype.addListen=function(){this.mClsBtn.on("pointerup",this.closeHandler,this)},DebugLogger.prototype.removeListen=function(){this.mWorld.game.device.os.desktop||this.mClsBtn.off("pointerup",this.closeHandler,this)},DebugLogger.prototype.show=function(t){this.mInitialized?(this.mShow=!0,this.resize()):this.preload()},DebugLogger.prototype.resize=function(t,i){this.mWorld.getSize();this.showDescTxT(),this.update(0)},DebugLogger.prototype.update=function(t){var i=this.mWorld.roomManager.currentRoom.now();this.mDelay-i<3e3&&(this.showDescTxT(),this.mTimeTF.setText("FPS:"+t),this.mDescTF.setText(this.mDescTxt),this.mDelay=i)},DebugLogger.prototype.preload=function(){this.mScene&&(this.mScene.load.atlas("clsBtn",h.i.getRes("ui/common/common_clsBtn.png"),h.i.getRes("ui/common/common_clsBtn.json")),t.prototype.preload.call(this))},DebugLogger.prototype.init=function(){this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);var i=this.mWorld.getSize();this.mBgWidth=400,this.mBgHeight=i.height>>1;var o=this.scene.cameras.main.width/2,r=this.scene.cameras.main.height;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.fillStyle(0,.6),this.mBackground.fillRect(0,0,o,r),this.setSize(o,r),this.add(this.mBackground),this.mTimeTF=this.mScene.make.text({style:{x:0,y:0,fontFamily:d.a.DEFULT_FONT,fontSize:14*this.dpr,origin:{x:0,y:0},wordWrap:{width:i.width-10,height:20,useAdvancedWrap:!0}}},!1),this.mDescTF=this.mScene.make.text({style:{x:0,y:20*this.dpr,fontFamily:d.a.DEFULT_FONT,fontSize:14*this.dpr,origin:{x:0,y:0},wordWrap:{width:this.width-10*this.dpr,height:this.height-30,useAdvancedWrap:!0}}},!1),this.add(this.mTimeTF),this.add(this.mDescTF),this.mWorld.game.device.os.desktop||(this.mClsBtn=new u.IconBtn(this.mScene,this.mWorld,{key:p.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=this.width,this.mClsBtn.y=10*this.dpr,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn)),t.prototype.init.call(this),this.addListen()},DebugLogger.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.getMediator(c.DebugLoggerMediator.NAME).resize()},DebugLogger.prototype.showDescTxT=function(){this.mWorld.getSize().width,this.mWorld.getSize().height;var t="WEBGL";this.mWorld.game.config.renderType===Phaser.CANVAS?t="CANVAS":this.mWorld.game.config.renderType===Phaser.HEADLESS&&(t="HEADLESS");var i=this.mWorld.getConfig();this.mDescTxt="\n            rendertype: "+t+"\n            size: "+i.width+" "+i.height+"\n            device size: "+this.mWorld.getSize().width.toFixed(2)+" "+this.mWorld.getSize().height.toFixed(2)+"\n            scene scale: "+this.mWorld.scaleRatio+"\n            devicePixel: "+this.mWorld.uiRatio+"\n            ui scale: "+this.mWorld.uiScale.toFixed(4)},DebugLogger.prototype.closeHandler=function(){this.mWorld.uiManager.getMediator(c.DebugLoggerMediator.NAME).hide()},DebugLogger.prototype.showErrTxt=function(){var t=l.a.getInstance().getErrorList();if(t){var i="";t.forEach((function(t){i+="\n"+t})),this.mDescTxt+=i}},DebugLogger}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"Dialog",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Dialog(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Dialog,t),Dialog.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},Dialog.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Dialog.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Dialog.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Dialog.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Dialog.prototype.queryNextDialog=function(t,i,o){var r=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),l=r.content;l.uiId=t,l.componentId=i,l.data=o,this.connection.send(r)},Object.defineProperty(Dialog.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Dialog}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"DialogPanel",(function(){return y}));var r,a=o(112),h=o(116),l=o(113),c=o(120),u=o(2),p=o(111),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function DialogPanel(i,o){var r=t.call(this,i,o)||this;return r.key="commonkey",r.listItems=[],r}return m(DialogPanel,t),DialogPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight,h=177*this.dpr;t.prototype.resize.call(this,r,a),this.content.setPosition(.5*r,a-h/2),this.setSize(r,a),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRect(0,0,r,a),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains);var l=r/this.scene.textures.getFrame(this.key,"menu_bg_l").width*this.dpr;this.bg.scaleX=1.5*l,this.bg.x=0,this.bg.setInteractive(),this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR)},DialogPanel.prototype.preload=function(){this.addAtlas(this.key,"common/ui_base.png","common/ui_base.json"),t.prototype.preload.call(this)},DialogPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen(),this.setDialogData(this.mShowData[0])):this.preload())},DialogPanel.prototype.init=function(){var i=this.scaleWidth,o=this.scaleHeight,r=177*this.dpr;this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg),this.content=this.scene.make.container({x:0*this.dpr,y:(o-r)/2,width:i,height:r},!1),this.content.setSize(i,r),this.bg=this.scene.make.image({x:0,y:0,key:this.key,frame:"menu_bg_l"}),this.bg.scaleY=this.scale,this.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.bg.displayWidth=i,this.bg.displayHeight=r;var a=this.scene.make.graphics(void 0,!1),c=i-30*this.dpr,u=122*this.dpr;a.setPosition(-c>>1,.5*-u+13*this.dpr),a.clear(),a.fillStyle(16777215,1),a.fillRoundedRect(0,0,c,u,8*this.dpr),this.text=this.scene.make.text({x:.5*-c+20*this.dpr,y:.5*-u+30*this.dpr,text:"",style:{color:"#000000",fontSize:15*this.dpr,fontFamily:l.a.DEFULT_FONT}}).setOrigin(0).setWordWrapWidth(c-35*this.dpr,!0);var p=.5*-i+38*this.dpr,m=.5*-r+25*this.dpr;this.npcIcon=new h.DynamicImage(this.scene,p,m-20*this.dpr);var y=this.scene.make.image({x:p+135*this.dpr,y:m,key:this.key,frame:"name_bg"});this.npcName=this.scene.make.text({x:y.x,y:y.y,text:"",style:{fontSize:15*this.dpr,fontFamily:l.a.DEFULT_FONT}}).setOrigin(.5);var g=new d.Button(this.scene,this.key,"close_1","close_1");g.setPosition(.5*i-30*this.dpr,.5*-r+10*this.dpr),g.on("Tap",this.onCloseHandler,this),g.visible=!1,this.content.add([this.bg,this.npcIcon,a,this.text,y,this.npcName,g]),this.bg.setInteractive(),this.bg.on("pointerdown",this.onNextDialogHandler,this),this.add(this.content),this.resize(0,0),t.prototype.init.call(this)},DialogPanel.prototype.setLayoutItems=function(t){var i=t.length,o=i>4?2:1,r=(this.dpr,295*this.dpr),a=27*this.dpr,h=r/o,l=4*this.dpr;2===i?l=15*this.dpr:3===i&&(l=10*this.dpr);for(var u=(124*this.dpr-(l+a)*(i<4?i:4)-l)/2-42*this.dpr,p=0,d=this.listItems;p<d.length;p++){(y=d[p]).visible=!1}for(var m=0;m<i;m++){var y=void 0;m<this.listItems.length?y=this.listItems[m]:(y=new g(this.scene,this.dpr,this.scale,this.key),this.content.add(y),this.listItems.push(y),y.setHandler(new c.a(this,this.onItemHandler)));var _=.5*(r-h)*(m<4?-1:1),v=u+.5*a+(a+l)*(m%4);y.setItemSize(h,a),y.setPosition(_,v),y.setItemData(t[m]),y.visible=!0}},DialogPanel.prototype.setDialogData=function(t){var i=this;if(t.text&&t.text[1]&&(this.npcName.text=t.text[1].text),t.display&&t.display[0]){this.npcIcon.visible=!0;var o=t.display[0],r=p.i.getOsdRes(o.texturePath);this.npcIcon.load(r,this,(function(){var t=i.content.width,r=i.content.height,a=i.npcIcon.width,h=(i.npcIcon.height,i.npcIcon.x),l=.5*-r-50*i.dpr;o.horizontal===u.op_def.HorizontalAlignment.HORIZONTAL_LEFT?h=.5*-t+.5*a:o.horizontal===u.op_def.HorizontalAlignment.HORIZONTAL_CENTER?h=0:o.horizontal===u.op_def.HorizontalAlignment.HORIZONTAL_RIGHT&&(h=.5*t-.5*a-20*i.dpr),i.npcIcon.displayWidth=212*i.dpr,i.npcIcon.scaleY=i.npcIcon.scaleX,i.npcIcon.x=h,i.npcIcon.y=l}))}else this.npcIcon.visible=!1;if(t.button&&t.button.length>0)this.setLayoutItems(t.button),this.text.visible=!1;else{for(var a=0,h=this.listItems;a<h.length;a++){h[a].visible=!1}this.text.text=t.text[0].text,this.text.visible=!0}},DialogPanel.prototype.update=function(t){this.mShowData=t,this.setDialogData(t[0])},DialogPanel.prototype.onItemHandler=function(t){for(var i=0,o=this.listItems;i<o.length;i++){o[i].select=!1}t.select=!0;var r=this.showData[0];this.emit("querydialog",r.id,t.itemData.node.id)},DialogPanel.prototype.onNextDialogHandler=function(){var t=this.showData[0];this.emit("querydialog",t.id,0)},DialogPanel.prototype.onCloseHandler=function(){this.emit("hide")},DialogPanel}(a.BasePanel),g=function(t){function NpcDialogueItem(i,o,r,a){var h=t.call(this,i)||this;return h.dpr=0,h.zoom=0,h.zoom=r,h.dpr=o,h.selectBg=h.scene.make.image({x:0,y:0,key:a,frame:"select_bg"}),h.arrImg=h.scene.make.image({x:.5*-h.selectBg.width,y:0,key:a,frame:"arrow_r"}),h.content=h.scene.make.text({x:0,y:0,text:"",style:{color:"#000000",fontSize:15*o,fontFamily:l.a.DEFULT_FONT}}).setOrigin(0,.5),h.add([h.selectBg,h.arrImg,h.content]),h.width=h.selectBg.width,h.height=h.selectBg.height,h.on("pointerdown",h.onClickHandler,h),h}return m(NpcDialogueItem,t),NpcDialogueItem.prototype.setItemData=function(t){this.itemData=t,this.content.text=t.text,this.select=!1},NpcDialogueItem.prototype.setHandler=function(t){this.handler=t},Object.defineProperty(NpcDialogueItem.prototype,"select",{set:function(t){this.selectBg.visible=t},enumerable:!1,configurable:!0}),NpcDialogueItem.prototype.setItemSize=function(i,o){t.prototype.setSize.call(this,i,o),this.selectBg.displayWidth=i,this.arrImg.x=.5*-i*.9,this.content.x=this.arrImg.x+20*this.dpr*this.zoom,this.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains)},NpcDialogueItem.prototype.onClickHandler=function(){this.handler&&this.handler.runWith(this)},NpcDialogueItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"FriendInvitePanel",(function(){return d}));var r,a=o(112),h=o(115),l=o(114),c=o(113),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function FriendInvitePanel(i,o){return t.call(this,i,o)||this}return p(FriendInvitePanel,t),FriendInvitePanel.prototype.show=function(i){t.prototype.show.call(this,i),this.mInitialized&&this.showInvite()},FriendInvitePanel.prototype.addListen=function(){t.prototype.addListen.call(this),this.refused.on(String(u.ClickEvent.Tap),this.onRefusedHandler,this),this.agree.on(String(u.ClickEvent.Tap),this.onAgreeHandler,this)},FriendInvitePanel.prototype.removeListen=function(){t.prototype.removeListen.call(this),this.refused.off(String(u.ClickEvent.Tap),this.onRefusedHandler,this),this.agree.off(String(u.ClickEvent.Tap),this.onAgreeHandler,this)},FriendInvitePanel.prototype.destroy=function(){this.tween&&this.tween.stop(),t.prototype.destroy.call(this)},FriendInvitePanel.prototype.preload=function(){this.addAtlas(h.UIAtlasKey.commonKey,h.UIAtlasName.commonUrl+".png",h.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},FriendInvitePanel.prototype.init=function(){this.setSize(168*this.dpr,59*this.dpr);var i=5*this.dpr;this.bg=this.scene.make.graphics(void 0,!1),this.bg.fillStyle(0,.6),this.bg.fillRoundedRect(0,0,this.width,this.height,{tl:0,tr:i,br:i,bl:0}),this.text=new u.BBCodeText(this.scene,.5*this.width,7*this.dpr,"",{}).setOrigin(.5,0).setFontSize(10*this.dpr).setFontFamily(c.a.DEFULT_FONT);var o=55*this.dpr,r=24*this.dpr,a={left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr};this.refused=new u.NineSliceButton(this.scene,.5*o+17.67*this.dpr,.5*r+31*this.dpr,o,r,h.UIAtlasKey.commonKey,"red_btn_normal",l.a.t("friend_invite.refused"),this.dpr,this.scale,a),this.agree=new u.NineSliceButton(this.scene,this.width-.5*o-24.33*this.dpr,.5*r+31*this.dpr,o,r,h.UIAtlasKey.commonKey,"button_g",l.a.t("friend_invite.agree"),this.dpr,this.scale,a),this.add([this.bg,this.text,this.refused,this.agree]),t.prototype.init.call(this),this.y=374*this.dpr},FriendInvitePanel.prototype.showInvite=function(){var t=this;if(this.tween&&this.tween.stop(),this.interval&&clearInterval(this.interval),this.showData&&!(this.showData.length<0)){var i=this.showData[0],o=i.button;o.length<2||(this.x=-this.width,this.text.text="[color=#FFFF00]"+i.text[0].text+"[/color]",this.agree.setText(o[1].text),this.agree.setData("data",o[1]),this.refused.setText(o[0].text),this.refused.setData("data",o[0]),this.countdown=10,this.setAgressText(),this.tween=this.scene.tweens.add({targets:this,props:{x:0},duration:200,onComplete:function(){t.interval=setInterval((function(){--t.countdown<0?t.close():t.setAgressText()}),1e3)}}))}},FriendInvitePanel.prototype.onAgreeHandler=function(){if(this.mShowData&&!(this.mShowData.length<1)){var t=this.agree.getData("data");t&&t.node&&(this.emit("targetUI",this.mShowData[0].id,t.node.id),this.close())}},FriendInvitePanel.prototype.onRefusedHandler=function(){this.close()},FriendInvitePanel.prototype.close=function(){var t=this;this.interval&&clearInterval(this.interval),this.tween&&this.tween.stop(),this.tween=this.scene.tweens.add({targets:this,props:{x:-this.width},duration:200,onComplete:function(){var i=t.refused.getData("data");i&&i.node&&t.emit("targetUI",t.mShowData[0].id,i.node.id)}})},FriendInvitePanel.prototype.setAgressText=function(){if(this.agree){var t=this.agree.getData("data");t&&this.agree.setText(t.text+"("+this.countdown+")")}},FriendInvitePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"FurniBag",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function FurniBag(i,o){var r=t.call(this)||this;return r.world=i,r.mSceneType=o,r.mEvent=new Phaser.Events.EventEmitter,r}return l(FurniBag,t),FurniBag.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_PACKAGE_CATEGORIES,this.onPackageCategoriesHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE,this.onQueryMarketPackage),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE,this.onQueryCommodityResultHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_QUERY_EDIT_PACKAGE,this.onQueryEditPackage),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_RESET_AVATAR,this.onQueryResetAvatar),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CURRENT_DRESS_AVATAR_ITEM_ID,this.onRetDressAvatarItemIDS))},FurniBag.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},FurniBag.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},FurniBag.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},FurniBag.prototype.getCategories=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_PACKAGE_CATEGORIES);i.content.category=t,this.connection.send(i),this.categoryType=t},FurniBag.prototype.queryPackage=function(t,i){this.mSceneType===h.op_def.SceneTypeEnum.NORMAL_SCENE_TYPE?this.queryMarketPackage(t,i):this.queryEditPackage(t,i)},FurniBag.prototype.queryCommodityResource=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE_ITEM_RESOURCE);i.content.id=t,this.connection.send(i)},FurniBag.prototype.addFurniToScene=function(t){if(this.mSceneType===h.op_def.SceneTypeEnum.EDIT_SCENE_TYPE){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SELECTED_SPRITE);i.content.id=t,this.connection.send(i)}},FurniBag.prototype.enterEditAndSelectedSprite=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENABLE_AND_SELECTED_SPRITE);i.content.id=t,this.connection.send(i)},FurniBag.prototype.seachPackage=function(t,i){this.queryPackage(i,t)},FurniBag.prototype.sellProps=function(t,i,o){var r=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_SELL_PACKAGE_ITEM),l=r.content;l.category=o;var c=h.op_client.CountablePackageItem.create(t);c.count=i,l.items=[c],l.totalPrice=c.sellingPrice,l.totalPrice.price*=i,this.connection.send(r)},FurniBag.prototype.useProps=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_USE_ITEM),r=o.content;r.itemId=t,r.count=i,this.connection.send(o)},FurniBag.prototype.querySaveAvatar=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_DRESS_UP_AVATAR);i.content.avatarItemIds=t,this.connection.send(i)},FurniBag.prototype.queryResetAvatar=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_RESET_AVATAR);this.connection.send(i)},FurniBag.prototype.queryDressAvatarItemIDs=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CURRENT_DRESS_AVATAR_ITEM_ID);this.connection.send(t)},FurniBag.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},FurniBag.prototype.onPackageCategoriesHandler=function(t){var i=t.content;i.category===this.categoryType&&this.mEvent.emit("packageCategory",i.subcategory)},FurniBag.prototype.onQueryMarketPackage=function(t){var i=t.content;i.category===this.categoryType&&this.mEvent.emit("queryPackage",i)},FurniBag.prototype.onQueryEditPackage=function(t){var i=t.content;i.category===this.categoryType&&this.mEvent.emit("queryPackage",i)},FurniBag.prototype.onQueryCommodityResultHandler=function(t){this.mEvent.emit("queryCommodityResource",t.content)},FurniBag.prototype.onQueryResetAvatar=function(t){var i=t.content;this.mEvent.emit("queryResetAvatar",i)},FurniBag.prototype.queryMarketPackage=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE),r=o.content;r.category=this.categoryType,r.page=1,r.perPage=1e6,r.subcategory=t,r.queryString=i,this.connection.send(o)},FurniBag.prototype.queryEditPackage=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_QUERY_EDIT_PACKAGE),r=o.content;r.category=this.categoryType,r.page=1,r.perPage=1e6,r.subcategory=t,r.queryString=i,this.connection.send(o)},FurniBag.prototype.onRetDressAvatarItemIDS=function(t){var i=t.content;this.mEvent.emit("avatarIDs",i.avatarItemIds)},Object.defineProperty(FurniBag.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),FurniBag}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"FurniBagPanel",(function(){return w}));var r,a=o(112),h=o(114),l=o(130),c=o(113),u=o(2),p=o(116),d=o(150),m=o(111),y=o(165),g=o(127),_=o(120),v=o(0),b=o(109),P=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),w=function(t){function FurniBagPanel(i,o,r){var a=t.call(this,i,o)||this;return a.key="furni_bag",a.commonkey="common_key",a.seachKey="key.seach",a.topBtns=[],a.mEnableEdit=!1,a.mInputBoo=!1,a.mSelectedItemData=[],a.mSelectedItems=[],a.mSceneType=r,a.setInteractive(),a}return P(FurniBagPanel,t),FurniBagPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.mBackground.clear(),this.mBackground.fillGradientStyle(7304703,7304703,314367,314367),this.mBackground.fillRect(0,0,r,a),this.mShelfContainer.setSize(r,295*this.dpr),this.mShelfContainer.y=a-this.mShelfContainer.height,this.mDetailBubble.y=this.mShelfContainer.y-10*this.dpr-this.mDetailBubble.height,this.mCategoriesBar.clear(),this.mCategoriesBar.fillStyle(3394815),this.mCategoriesBar.fillRect(0,0,r,40*this.dpr),this.mCategoriesBar.fillStyle(52428),this.mCategoriesBar.fillRect(0,40*this.dpr,r,3*this.dpr),this.mBg.x=r/2,this.mBg.y=this.mBg.height/2+10*this.dpr,this.mAdd.x=r-this.mAdd.width/2-10*this.dpr,this.mAdd.y=this.mShelfContainer.y-this.mAdd.height/2-9*this.dpr,this.useBtn.x=this.mAdd.x,this.useBtn.y=this.mAdd.y,this.sellBtn.x=Math.floor(this.mAdd.x-this.sellBtn.width-10*this.dpr),this.sellBtn.y=this.mAdd.y,this.resetBtn.x=this.mAdd.x+25*this.dpr,this.resetBtn.y=this.mAdd.y,this.saveBtn.x=this.resetBtn.x-(this.saveBtn.width+this.resetBtn.width)/2-10*this.dpr,this.saveBtn.y=this.resetBtn.y,this.mDetailDisplay.x=r/2,this.mDetailDisplay.y=this.mBg.y,this.mPropGrid.x=r/2,this.mPropGrid.y=this.mShelfContainer.y+.5*this.mPropGrid.height+50*this.dpr,this.mPropGrid.layout(),this.mPropGrid.resetMask(),this.mCategoryScroll.refreshMask(),this.setSize(r,a)},FurniBagPanel.prototype.setCategories=function(t){this.mPreCategoryBtn=null,this.mSelectedCategeories=null;var i=60*this.dpr,o=41*this.dpr,r=[];this.mSeachInput.parentContainer&&this.closeSeach(null),this.mCategoryScroll.clearItems();var a=new b.Button(this.scene,this.key,"seach_normal","seach_down");a.setData("item",{key:this.seachKey,value:h.a.t("common.search")}),a.y=o-40*this.dpr,this.mCategoryScroll.addItem(a);var l=new u.op_def.StrPair;l.value=h.a.t("common.all"),l.key="alltype",t.unshift(l);for(var c=0;c<t.length;c++){var p=new d.TextButton(this.scene,this.dpr,1,t[c].value,0,0);p.x=c*i,p.y=o-p.text.height-20*this.dpr,p.setData("item",t[c]),p.setSize(i,o),this.mCategoryScroll.addItem(p),r[c]=p,p.setFontSize(17*this.dpr),p.setFontStyle("bold")}r.length>1&&this.onSelectSubCategoryHandler(r[0]),this.updateCategeoriesLoc(!1)},FurniBagPanel.prototype.setProp=function(t,i){void 0===i&&(i=!1),t=t||[],this.mSelectedItems.length=0,i||(this.mSelectedItemData.length=0);var o=t.length;if(o<24&&(t=t.concat(new Array(24-o))),i||this.mPropGrid.setT(0),this.mPropGrid.setItems(t),this.categoryType!==u.op_pkt_def.PKT_PackageType.AvatarPackage){if(0===this.mSelectedItems.length){this.mPropGrid.setT(0),this.mSelectedItemData.length=0;var r=this.mPropGrid.getCell(0);this.onSelectItemHandler(r.container)}}else{this.mSelectedItemData.length=0;for(var a=0,h=t;a<h.length;a++){var l=h[a];l&&l.rightSubscript===u.op_pkt_def.PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK&&this.mSelectedItemData.push(l)}0===this.mSelectedItemData.length?this.displayAvatar():this.updateAvatarItems()}},FurniBagPanel.prototype.setDressAvatarIds=function(t){this.dressAvatarIDS=t,this.updateAvatarItems()},FurniBagPanel.prototype.displayAvatar=function(t){t||((t=new u.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE).avatar=new u.op_gameconfig.Avatar);var i=this.mWorld.roomManager.currentRoom.playerManager.actor.model.avatar;for(var o in i){if(i.hasOwnProperty(o))(l=i[o])&&(t.avatar[o]=l)}for(var r=0,a=this.mSelectedItemData;r<a.length;r++){var h=a[r].avatar;for(var o in h){var l;if(h.hasOwnProperty(o))(l=h[o])&&(t.avatar[o]=l)}}var c=new Phaser.Geom.Point(0,50*this.dpr);this.mDetailDisplay.loadAvatar(t,2*this.dpr,c)},FurniBagPanel.prototype.setSelectedResource=function(t){t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.displayAvatar()},FurniBagPanel.prototype.resetAvatar=function(t){var i=new u.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE;i.avatar=t.avatar;var o=new Phaser.Geom.Point(0,50*this.dpr);this.mDetailDisplay.loadAvatar(i,2*this.dpr,o),this.mSelectedItemData.length=0},FurniBagPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mSeachInput.on("seach",this.onSeachHandler,this),this.mAdd.on("pointerup",this.onAddFurniToSceneHandler,this),this.sellBtn.on("pointerup",this.onSellBtnHandler,this),this.useBtn.on("pointerup",this.onUseBtnHandler,this),this.saveBtn.on("pointerup",this.onSaveBtnHandler,this),this.resetBtn.on("pointerup",this.onResetBtnHandler,this))},FurniBagPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mSeachInput.off("seach",this.onSeachHandler,this),this.mAdd.off("pointerup",this.onAddFurniToSceneHandler,this),this.sellBtn.off("pointerup",this.onSellBtnHandler,this),this.useBtn.off("pointerup",this.onUseBtnHandler,this),this.saveBtn.on("pointerup",this.onSaveBtnHandler,this),this.resetBtn.on("pointerup",this.onResetBtnHandler,this))},FurniBagPanel.prototype.destroy=function(){this.mCategoryScroll&&this.mCategoryScroll.destroy(),this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},FurniBagPanel.prototype.queryRefreshPackage=function(t){void 0===t&&(t=!1),this.queryPackege(t)},FurniBagPanel.prototype.preload=function(){this.addAtlas(this.key,"furni_bag/furni_bag.png","furni_bag/furni_bag.json"),this.addAtlas(this.commonkey,"common/ui_base.png","common/ui_base.json"),t.prototype.preload.call(this)},FurniBagPanel.prototype.init=function(){var i=this,o=this.scaleWidth,r=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBg=this.scene.make.image({key:this.key,frame:"bg"},!1),this.mShelfContainer=this.scene.make.container(void 0,!1),this.mShelfContainer.setSize(o,295*this.dpr),this.mShelfContainer.y=r-this.mShelfContainer.height,this.mCategoriesBar=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"back_arrow",x:21*this.dpr,y:30*this.dpr}),this.mCloseBtn.setInteractive(new Phaser.Geom.Rectangle(-28*this.dpr,-20*this.dpr,56*this.dpr,40*this.dpr),Phaser.Geom.Rectangle.Contains);var a=90*this.dpr,p=38*this.dpr,d=o-a/2-20*this.dpr,m=this.mShelfContainer.y-25*this.dpr;this.mAdd=this.createNineButton(d+100*this.dpr,m,a,p,this.commonkey,"yellow_btn",h.a.t("furni_bag.add"),"#996600"),this.sellBtn=this.createNineButton(d,m,a,p,this.commonkey,"red_btn",h.a.t("common.sold"),"#FFFFFF"),this.useBtn=this.createNineButton(d+100*this.dpr,m,a,p,this.commonkey,"yellow_btn",h.a.t("common.use"),"#996600"),this.saveBtn=this.createNineButton(d+100*this.dpr,m,a,p,this.commonkey,"yellow_btn",h.a.t("common.save"),"#996600"),this.resetBtn=this.createNineButton(d+100*this.dpr,m-p-5*this.dpr,38*this.dpr,38*this.dpr,this.commonkey,"red_btn");var y=this.scene.make.image({key:this.key,frame:"restore"});this.resetBtn.add(y),this.mDetailDisplay=new l.DetailDisplay(this.scene,!0),this.mDetailDisplay.setSize(110*this.dpr,110*this.dpr),this.mDetailDisplay.setComplHandler(new _.a(this,(function(){i.mDetailDisplay.visible=!0}))),this.mDetailDisplay.setTexture(this.key,"ghost"),this.mDetailDisplay.setNearest(),this.mDetailDisplay.y=this.mBg.y+this.mBg.height/2,this.mDetailBubble=new C(this.scene,this.key,this.dpr),this.mDetailBubble.x=10*this.dpr,this.mSeachInput=new S(this.scene,this.mWorld,this.key,this.dpr);this.mInputBoo&&this.dpr;this.mCategoryScroll=new b.GameScroller(this.scene,{x:.5*o,y:this.mShelfContainer.y+20*this.dpr,width:o,height:41*this.dpr,zoom:this.scale,orientation:1,dpr:this.dpr,cellupCallBack:function(t){i.onSelectSubCategoryHandler(t)}}),this.add([this.mBackground,this.mBg,this.mCloseBtn,this.mDetailDisplay,this.mDetailBubble,this.mShelfContainer,this.mCategoryScroll]),this.add([this.sellBtn,this.useBtn,this.mAdd,this.saveBtn,this.resetBtn]),this.mShelfContainer.add(this.mCategoriesBar),this.mWorld&&this.mWorld.roomManager&&this.mWorld.roomManager.currentRoom&&(this.mEnableEdit=this.mWorld.roomManager.currentRoom.enableEdit);var v=67*this.dpr,P=30*this.dpr,w=30*this.dpr,k={fontFamily:c.a.BOLD_FONT,fontSize:20*this.dpr,color:"#FFFFFF"};this.topCheckBox=new g.CheckboxGroup;var O=[u.op_pkt_def.PKT_PackageType.PropPackage,u.op_pkt_def.PKT_PackageType.FurniturePackage,u.op_pkt_def.PKT_PackageType.AvatarPackage],I=[h.a.t("furni_bag.Props"),h.a.t("furni_bag.furni"),h.a.t("furni_bag.decorate")];this.mSceneType===u.op_def.SceneTypeEnum.EDIT_SCENE_TYPE&&(O=[u.op_pkt_def.PKT_PackageType.EditFurniturePackage],I=[h.a.t("furni_bag.furni")]);var M=.5*o-.5*v*(O.length-1)-20*this.dpr;for(var E in O){var x=O[R=Number(E)],B=new b.TabButton(this.scene,this.key,"tab_normal","tab_down",I[R]);B.setTextStyle(k),B.setData("data",x),B.setSize(v,P),B.setFontStyle("bold"),B.y=w,B.x=M+v*R,this.topBtns.push(B)}if(this.topCheckBox.appendItemAll(this.topBtns),this.topCheckBox.on("selected",this.onTopCategoryHandler,this),this.topBtns.forEach((function(t){i.add(t)})),this.mEnableEdit){var R=O.indexOf(u.op_pkt_def.PKT_PackageType.EditFurniturePackage);this.topCheckBox.selectIndex(R)}else this.topCheckBox.selectIndex(0);var D=this.scene.textures.getFrame(this.key,"grid_choose"),L=D.width,A=D.height,j={x:0,y:0,table:{width:o,height:260*this.dpr,columns:4,cellWidth:L,cellHeight:A,reuseCellContainer:!0,zoom:this.scale,mask:!1},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.scene,a=t.item;if(null===o&&(o=new T(r,0,0,i.key,i.dpr)),o.setData({item:a}),o.setProp(a),a&&i.isSelectedItemData(a))o.isSelect=!0,i.mSelectedItems.push(o);else{var h=i.mSelectedItems.indexOf(o);-1!==h&&i.mSelectedItems.splice(h,1)}return o}};this.mPropGrid=new b.GameGridTable(this.scene,j),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(t){t&&i.onSelectItemHandler(t)})),this.add(this.mPropGrid),this.resize(0,0),t.prototype.init.call(this)},FurniBagPanel.prototype.createNineButton=function(t,i,o,r,a,h,l,u){var p=new b.NineSliceButton(this.scene,t,i,o,r,a,h,l,this.dpr,1,{left:14*this.dpr,top:14*this.dpr,right:15*this.dpr,bottom:14*this.dpr});return l&&(p.setTextStyle({color:u,fontSize:16*this.dpr,fontFamily:c.a.DEFULT_FONT}),p.setFontStyle("bold")),p},FurniBagPanel.prototype.updateAvatarItems=function(){if(this.dressAvatarIDS&&this.mSelectedItemData.length>0){for(var t=[],i=0,o=this.dressAvatarIDS;i<o.length;i++)for(var r=o[i],a=0,h=this.mSelectedItemData;a<h.length;a++){var l=h[a];l.id===r&&t.push(l)}this.mSelectedItemData.length=0,this.mSelectedItemData=t,this.displayAvatar()}else this.mDetailBubble.setProp(null,this.serviceTimestamp),this.mDetailBubble.y=this.mShelfContainer.y-10*this.dpr-this.mDetailBubble.height},FurniBagPanel.prototype.replaceSelectItem=function(t,i){if(this.categoryType!==u.op_pkt_def.PKT_PackageType.AvatarPackage)this.mSelectedItems.length>0&&(this.mSelectedItems[0].isSelect=!1),this.mSelectedItemData.length=0,this.mSelectedItems.length=0,this.mSelectedItemData.push(t),this.mSelectedItems.push(i),i.isSelect=!0;else{var o=t.avatar;if(!o)return void v.a.getInstance().error("CountablePackageItem avatar does not exist",t);for(var r=[],a=0,h=this.mSelectedItemData;a<h.length;a++){var l=(d=h[a]).avatar;this.isContainProperty(l,o)&&r.push(d)}for(var c=0,p=r;c<p.length;c++){var d=p[c],m=this.mSelectedItemData.indexOf(d);this.mSelectedItemData.splice(m,1);for(var y=0;y<this.mSelectedItems.length;y++){var g=this.mSelectedItems[y];if(g.propData===d){g.isSelect=!1,this.mSelectedItems.splice(y,1);break}}}this.mSelectedItemData.push(t),this.mSelectedItems.push(i),i.isSelect=!0}},FurniBagPanel.prototype.isContainProperty=function(t,i){var o=!0;for(var r in t)if("headBackId"!==r&&"bodyDresId"!==r&&t.hasOwnProperty(r)&&!i.hasOwnProperty(r)){o=!1;break}return o},FurniBagPanel.prototype.isSelectedItemData=function(t){if(this.mSelectedItemData.length>0)for(var i=0,o=this.mSelectedItemData;i<o.length;i++){if(o[i].indexId===t.indexId)return!0}else if(t.rightSubscript===u.op_pkt_def.PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK)return!0;return!1},FurniBagPanel.prototype.setSelectedItem=function(t){this.sellBtn.enable=t.recyclable,this.useBtn.enable=t.executable,this.mAdd.enable=this.mSceneType===u.op_def.SceneTypeEnum.EDIT_SCENE_TYPE||this.mEnableEdit,this.categoryType===u.op_pkt_def.PKT_PackageType.AvatarPackage&&(this.saveBtn.enable=!0,this.resetBtn.enable=!0),this.mDetailDisplay.loadSprite("loading_ui",m.i.getUIRes(this.dpr,"loading_ui"),m.i.getUIRes(this.dpr,"loading_ui"));var i=new u.op_client.OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE;t.avatar?i.avatar=t.avatar:i.display=t.display,i.animations=t.animations,this.setSelectedResource(i)},FurniBagPanel.prototype.onSelectSubCategoryHandler=function(t){var i=t.getData("type");if(i)"seachBtn"===i?this.onSeachHandler(this.mSeachInput.seachText):"label"===i&&this.mSeachInput.showInputPanel();else{var o=t.getData("item");if(o){this.mPreCategoryBtn&&this.mPreCategoryBtn instanceof d.TextButton&&this.mPreCategoryBtn.changeNormal(),t instanceof d.TextButton&&t.changeDown();var r=o.key;if(r===this.seachKey)this.showSeach(t);else{if(this.mPreCategoryBtn)(r=this.mPreCategoryBtn.getData("item").key)===this.seachKey&&this.closeSeach(t);else this.closeSeach(t);this.mSelectedCategeories=o,this.queryPackege()}this.mPreCategoryBtn=t}this.mPropGrid.setT(0)}},FurniBagPanel.prototype.onCloseHandler=function(){this.emit("close")},FurniBagPanel.prototype.queryPackege=function(t){void 0===t&&(t=!1),this.mSelectedCategeories&&this.emit("queryPackage",this.categoryType,this.mSelectedCategeories.key,t)},FurniBagPanel.prototype.onSelectItemHandler=function(t){var i=t.getData("item");-1===this.mSelectedItemData.indexOf(i)&&(this.mDetailBubble.setProp(i,this.serviceTimestamp),this.mDetailBubble.y=this.mShelfContainer.y-10*this.dpr-this.mDetailBubble.height,i?(this.replaceSelectItem(i,t),this.setSelectedItem(i)):this.categoryType!==u.op_pkt_def.PKT_PackageType.AvatarPackage&&0===this.mSelectedItemData.length&&(this.sellBtn.enable=!1,this.useBtn.enable=!1,this.mAdd.enable=!1,this.saveBtn.enable=!1,this.resetBtn.enable=!1,this.mDetailDisplay.setTexture(this.key,"ghost"),this.mDetailDisplay.setNearest()))},FurniBagPanel.prototype.onSeachHandler=function(t){this.mSelectedCategeories&&t.length>0&&this.emit("seachPackage",t,this.mSelectedCategeories.key)},FurniBagPanel.prototype.onAddFurniToSceneHandler=function(){this.mSelectedItemData&&this.emit("addFurniToScene",this.mSelectedItemData[0].id)},FurniBagPanel.prototype.onTopCategoryHandler=function(t){var i=t.getData("data");this.scaleWidth;this.mSelectedItemData.length=0,i&&(this.onSelectedCategory(i),i===u.op_pkt_def.PKT_PackageType.FurniturePackage||i===u.op_pkt_def.PKT_PackageType.EditFurniturePackage?(this.sellBtn.visible=!0,this.mAdd.visible=!0,this.useBtn.visible=!1,this.saveBtn.visible=!1,this.resetBtn.visible=!1):i===u.op_pkt_def.PKT_PackageType.AvatarPackage?(this.sellBtn.visible=!1,this.saveBtn.visible=!0,this.resetBtn.visible=!0,this.useBtn.visible=!1,this.mAdd.visible=!1):(this.sellBtn.visible=!0,this.useBtn.visible=!0,this.mAdd.visible=!1,this.saveBtn.visible=!1,this.resetBtn.visible=!1)),this.layoutTopBtn(t)},FurniBagPanel.prototype.layoutTopBtn=function(t){for(var i=this.scaleWidth,o=0,r=0,a=this.topBtns;r<a.length;r++){o+=(p=a[r]).width+5*this.dpr}for(var h=.5*i-(o/=2),l=0,u=this.topBtns;l<u.length;l++){var p,d=0;(p=u[l])!==t?(p.setTextStyle({fontFamily:c.a.DEFULT_FONT,fontSize:12*this.dpr,color:"#2B4BB5"}),d=.5*p.height):(p.setTextStyle({fontFamily:c.a.DEFULT_FONT,fontSize:16*this.dpr,color:"#8B5603"}),d=.5*p.height+2*this.dpr);var m=.5*p.width;p.x=h+m,p.y=d,h+=2*m+12*this.dpr}},FurniBagPanel.prototype.onSelectedCategory=function(t){this.categoryType=t,t===u.op_pkt_def.PKT_PackageType.AvatarPackage&&this.emit("queryDressAvatarIDS"),this.emit("getCategories",t)},FurniBagPanel.prototype.onSellBtnHandler=function(){var t=this;if(this.mCategoryScroll.removeListen(),this.mSelectedItemData.length>0){var i=this.mSelectedItemData[0],o=h.a.t("common.sold"),r=new _.a(this,this.onSellPropsHandler,[this.categoryType]),a=new _.a(this,(function(){t.mCategoryScroll.addListen()}));this.showPropFun({confirmHandler:r,data:i,cancelHandler:a,title:o})}},FurniBagPanel.prototype.onUseBtnHandler=function(){var t=this;if(this.mCategoryScroll.removeListen(),this.mSelectedItemData.length>0){var i=this.mSelectedItemData[0],o=h.a.t("common.use"),r=new _.a(this,this.onUsePropsHandler),a=new _.a(this,(function(){t.mCategoryScroll.addListen()}));this.showPropFun({confirmHandler:r,data:i,cancelHandler:a,price:!1,title:o})}},FurniBagPanel.prototype.onSaveBtnHandler=function(){this.dressAvatarIDS.length=0;for(var t=[],i=0,o=this.mSelectedItemData;i<o.length;i++){var r=o[i];t.push(r.id),this.dressAvatarIDS.push(r.id)}this.emit("querySaveAvatar",t)},FurniBagPanel.prototype.onResetBtnHandler=function(){this.emit("queryResetAvatar")},FurniBagPanel.prototype.onSellPropsHandler=function(t,i,o){this.mCategoryScroll.addListen(),this.emit("sellProps",i,o,t)},FurniBagPanel.prototype.onUsePropsHandler=function(t,i){this.mCategoryScroll.addListen(),this.emit("useprops",t.id,i)},FurniBagPanel.prototype.showSeach=function(t){this.mCategoryScroll.addItemAt(this.mSeachInput,1),this.mCategoryScroll.setInteractiveObject(this.mSeachInput.seachBtn),this.mCategoryScroll.setInteractiveObject(this.mSeachInput.label),this.updateCategeoriesLoc(!0)},FurniBagPanel.prototype.closeSeach=function(t){this.mSeachInput.parentContainer&&this.mSeachInput.parentContainer.remove(this.mSeachInput),this.mCategoryScroll.removeInteractiveObject(this.mSeachInput.seachBtn),this.mCategoryScroll.removeInteractiveObject(this.mSeachInput.label),this.updateCategeoriesLoc(!1)},FurniBagPanel.prototype.updateCategeoriesLoc=function(t){for(var i=this.mCategoryScroll.getItemList(),o=(this.dpr,null),r=30*this.dpr,a=(this.mScene.cameras.main.width,r),h=0;h<i.length;h++){var l=i[h];h>0?(o=i[h-1],l.x=o.x+o.width):l.x=a,a+=l.width}this.mCategoryScroll.setAlign()},Object.defineProperty(FurniBagPanel.prototype,"enableEdit",{get:function(){return this.mEnableEdit},enumerable:!1,configurable:!0}),FurniBagPanel.prototype.showPropFun=function(t){this.mWorld.uiManager.showMed("PicPropFun",t)},Object.defineProperty(FurniBagPanel.prototype,"serviceTimestamp",{get:function(){return Math.floor(this.mWorld.clock.unixTime/1e3)},enumerable:!1,configurable:!0}),FurniBagPanel}(a.BasePanel),S=function(t){function SeachInput(i,o,r,a){var h=t.call(this,i)||this;return h.mText="",h.mWorldService=o,h.dpr=a,h.bg=i.make.image({key:r,frame:"seach_bg"},!1).setOrigin(.5,.5),h.mLabelInput=h.scene.make.text({x:0,width:h.bg.width,height:h.bg.height,style:{fontFamily:c.a.DEFULT_FONT,fontSize:14*a}},!1).setOrigin(0,.5),h.mLabelInput.setSize(h.bg.width,h.bg.height),h.mLabelInput.setInteractive(),h.mSeachBtn=i.make.image({key:r,frame:"seach_normal"},!1).setData("type","seachBtn"),h.mLabelInput.x=-h.bg.width/2+6*a*o.uiScale,h.mSeachBtn.x=h.bg.width/2-h.mSeachBtn.width,h.add([h.bg,h.mLabelInput,h.mSeachBtn]),h.disableInteractive(),h.setSize(h.bg.width,h.bg.height),h.setData("type","label"),h}return P(SeachInput,t),SeachInput.prototype.showInputPanel=function(){this.mInputText||(this.mInputText=new y.InputPanel(this.scene,this.mWorldService,this.mText),this.mInputText.once("close",this.sendChat,this))},SeachInput.prototype.sendChat=function(t){if(this.mText=t,this.mInputText.destroy(),this.mInputText=null,t.length>10)for(var i=this.bg.width-20*this.dpr,o=10;o<t.length;o++){var r=t.slice(0,o);if(this.mLabelInput.setText(r).width>i)break}else this.mLabelInput.setText(t);this.mLabelInput.setSize(this.bg.width,this.bg.height)},Object.defineProperty(SeachInput.prototype,"seachBtn",{get:function(){return this.mSeachBtn},enumerable:!1,configurable:!0}),Object.defineProperty(SeachInput.prototype,"label",{get:function(){return this.mLabelInput},enumerable:!1,configurable:!0}),Object.defineProperty(SeachInput.prototype,"seachText",{get:function(){return this.mText},enumerable:!1,configurable:!0}),SeachInput}(Phaser.GameObjects.Container),C=function(t){function DetailBubble(i,o,r,a){void 0===a&&(a=1);var h=t.call(this,i)||this;h.dpr=r,h.mDetailBubble=h.scene.make.graphics(void 0,!1);var l=100*r,u=96*r;return h.mDetailBubble=h.scene.make.graphics(void 0,!1),h.mDetailBubble.fillStyle(16777215,.1),h.mDetailBubble.fillRoundedRect(0,0,l,u),h.mNickName=h.scene.make.text({x:7*h.dpr,y:9*h.dpr,style:{fontSize:12*h.dpr,fontFamily:c.a.DEFULT_FONT,color:"#FFFF00",align:"center"}}),h.mPriceText=h.scene.make.text({x:7*h.dpr,y:28*h.dpr,style:{fontSize:10*h.dpr,fontFamily:c.a.DEFULT_FONT,color:"#DC143C",align:"center"}}),h.mSource=h.scene.make.text({x:8*r,y:47*r,style:{fontSize:10*r,fontFamily:c.a.DEFULT_FONT}},!1),h.mDesText=h.scene.make.text({x:8*r,y:66*r,style:{color:"#32347b",fontSize:10*r,fontFamily:c.a.DEFULT_FONT,wordWrap:{width:90*r,useAdvancedWrap:!0}}},!1),h.mExpires=new b.BBCodeText(i,8*r,85*r,"",{fontSize:10*h.dpr,fontFamily:c.a.DEFULT_FONT}),h.add([h.mDetailBubble,h.mNickName,h.mDesText,h.mSource,h.mPriceText,h.mExpires]),h.setSize(l,u),h}return P(DetailBubble,t),DetailBubble.prototype.setProp=function(t,i){var o=this;if(t){this.mNickName.setText(t.shortName||t.name);var r=9*this.dpr,a=21*this.dpr;t.recyclable?(r+=a,this.mPriceText.y=r,t.sellingPrice&&this.mPriceText.setText(h.a.t("furni_bag.sale_price")+"："+m.f.getName(t.sellingPrice.coinType)+" x "+t.sellingPrice.price)):(r+=a,this.mPriceText.y=r,this.mPriceText.setText(h.a.t("furni_bag.not_sale"))),t.source?(this.mSource.setText(h.a.t("furni_bag.source")+"： "+t.source),r+=a,this.mSource.y=r):this.mSource.setText("");var l=15*this.dpr,c=this.getMaxWidth(l);if(t.des?(r+=a,this.mDesText.setWordWrapWidth(c-l,!0),this.mDesText.setText(t.des),this.mDesText.y=r):this.mDesText.setText(""),t.expiredTime>0){r+=a,this.mExpires.y=r;var u=t.expiredTime-i,timeout_1=function(){o.mExpires.visible=!0,o.mExpires.text=o.getDataFormat(1e3*u),u>0&&(o.timeID=setTimeout((function(){u-=1,timeout_1()}),1e3))};timeout_1()}else this.mExpires.visible=!1;this.resize(c)}else this.mNickName.setText(h.a.t("furni_bag.empty_backpack")),this.mPriceText.text="",this.mSource.text="",this.mDesText.text="",this.resize();return this},DetailBubble.prototype.resize=function(t,i){void 0===t&&(t=this.width);var o=this.mDesText.height+80*this.dpr;t===this.width&&o===this.height||(this.mDetailBubble.clear(),this.mDetailBubble.fillStyle(16777215,.1),this.mDetailBubble.fillRoundedRect(0,0,t,o),this.setSize(t,o))},DetailBubble.prototype.getMaxWidth=function(t){void 0===t&&(t=0);var i=100*this.dpr,o=0;return o<this.mNickName.width&&(o=this.mNickName.width),o<this.mPriceText.width&&(o=this.mPriceText.width),o<this.mSource.width&&(o=this.mSource.width),i-o<t&&(o+=t+(o-i>=0?0:o-i)),o<i&&(o=i),o},DetailBubble.prototype.getDataFormat=function(t){var i=Math.floor(t/864e5),o=Math.floor(t/36e5)%24,r=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,l=h.a.t("furni_bag.timelimit")+":  ";if(i>0)l+="[color=#FF0000]"+(i+"-"+this.stringFormat(o)+":"+this.stringFormat(r)+":"+this.stringFormat(a))+"[/color]";else if(o>0||r>0||a>0){l+="[color=#FF0000]"+(this.stringFormat(o)+":"+this.stringFormat(r)+":"+this.stringFormat(a))+"[/color]"}else{l+="[color=#FF0000]"+(""+h.a.t("furni_bag.expires"))+"[/color]"}return l},DetailBubble.prototype.stringFormat=function(t){var i=t+"";return i.length<=1&&(i="0"+i),i},DetailBubble}(Phaser.GameObjects.Container),T=function(t){function Item(i,o,r,a,h,l){void 0===l&&(l=1);var u=t.call(this,i,o,r)||this;u.dpr=h,u.zoom=l;var d=i.make.image({key:a,frame:"grid_bg"},!1);return u.selectbg=i.make.image({key:a,frame:"grid_choose"},!1),u.setSize(d.displayWidth,d.displayHeight),u.selectIcon=i.make.image({key:a,frame:"selected"},!1).setOrigin(1).setPosition(.5*u.width,.5*u.height),u.mPropImage=new p.DynamicImage(u.scene,0,0),u.mPropImage.scale=h,u.timeIcon=i.make.image({key:a,frame:"time"}),u.timeIcon.setPosition(.5*-u.width+.5*u.timeIcon.width,.5*-u.height+.5*u.timeIcon.height),u.mCounter=i.make.text({x:.5*u.width-2*h,y:.5*u.height,style:{fontSize:12*h,fontFamily:c.a.DEFULT_FONT}},!1).setOrigin(1),u.add([d,u.selectbg,u.selectIcon,u.mPropImage,u.timeIcon,u.mCounter]),u.isSelect=!1,u.isEquip=!1,u}return P(Item,t),Item.prototype.setProp=function(t){if(this.propData=t,this.isSelect=!1,this.isEquip=!1,!t)return this.mCounter.visible=!1,this.mPropImage.visible=!1,void(this.timeIcon.visible=!1);this.mPropImage.load(m.i.getOsdRes(t.display.texturePath),this,this.onPropLoadCompleteHandler),this.mPropImage.visible=!0,this.timeIcon.visible=t.expiredTime>0,t.count>1?(this.mCounter.visible=!0,this.mCounter.setText(t.count.toString())):this.mCounter.visible=!1,t.rightSubscript===u.op_pkt_def.PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK?this.isEquip=!0:this.isEquip=!1},Item.prototype.onPropLoadCompleteHandler=function(){if(this.mPropImage&&this.mPropImage.texture){var t=this.mPropImage.texture;this.mPropImage.displayHeight=45*this.dpr,this.mPropImage.scaleX=this.mPropImage.scaleY,t&&t.setFilter(Phaser.Textures.FilterMode.NEAREST)}},Object.defineProperty(Item.prototype,"isSelect",{set:function(t){this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(Item.prototype,"isEquip",{set:function(t){this.selectIcon.visible=t},enumerable:!1,configurable:!0}),Item.prototype.onSelectedHandler=function(){this.emit("select",this.propData)},Item}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"GMToolsPanel",(function(){return d}));var r,a=o(112),h=o(115),l=o(149),c=o(0),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function GMToolsPanel(i,o){return t.call(this,i,o)||this}return p(GMToolsPanel,t),GMToolsPanel.prototype.show=function(i){t.prototype.show.call(this,i),this.mInitialized&&this.showButtons()},GMToolsPanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on(String(u.ClickEvent.Tap),this.onCloseHandler,this),this.commitBtn.on(String(u.ClickEvent.Tap),this.onCommitCmdHandler,this))},GMToolsPanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off(String(u.ClickEvent.Tap),this.onCloseHandler,this),this.commitBtn.off(String(u.ClickEvent.Tap),this.onCommitCmdHandler,this))},GMToolsPanel.prototype.resize=function(){var t=this.scaleWidth,i=this.scaleHeight;c.a.getInstance().log("resize: ",this.cameraWidth,this.scaleHeight),this.setSize(this.scaleWidth,this.scaleHeight),this.closeBtn.x=.5*(t-this.closeBtn.width)-16*this.dpr,this.closeBtn.y=.5*-(i-this.closeBtn.height)+16*this.dpr,this.background.clear(),this.background.fillStyle(0,.6),this.background.fillRect(0,0,t,i),this.background.x=.5*-t,this.background.y=.5*-i,this.background.setInteractive(new Phaser.Geom.Rectangle(0,0,t,i),Phaser.Geom.Rectangle.Contains),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.x=.5*this.cameraWidth,this.y=.5*this.cameraHeight,this.commitBtn.x=this.command.x+this.command.width+.5*this.commitBtn.width+16*this.dpr,this.commitBtn.y=this.command.y+.5*this.command.height,this.gridtable.setSize(this.width,i-110*this.dpr),this.gridtable.layout(),this.gridtable.resetMask()},GMToolsPanel.prototype.preload=function(){this.addAtlas(h.UIAtlasKey.commonKey,h.UIAtlasName.commonUrl+".png",h.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},GMToolsPanel.prototype.init=function(){var i=this,o=this.scaleWidth,r=this.scaleHeight;this.setSize(o,r),this.background=this.scene.make.graphics(void 0,!1);var a=this.scale,c=o-30*this.dpr,p=46*this.dpr,d=null;this.scene.textures.exists("gmtools_btn")||((d=this.scene.make.graphics(void 0,!1)).fillStyle(36026),d.fillRoundedRect(0,0,c,p),d.generateTexture("gmtools_btn",c,p)),this.command=new l.LabelInput(this.scene,{width:this.width-110*this.dpr,height:16*this.dpr,placeholder:"输入命令",fontSize:14*this.dpr+"px",color:"#666666"}).setOrigin(0,0),this.command.x=.5*-this.width+20*this.dpr,this.command.y=.5*-this.height+60*this.dpr,this.command.createBackground(6*this.dpr,10*this.dpr),this.scene.textures.exists("gmtools_commit")||(d.clear(),d.fillStyle(699050),d.fillRoundedRect(0,0,50*this.dpr,30*this.dpr),d.generateTexture("gmtools_commit",50*this.dpr,30*this.dpr),d.destroy()),this.commitBtn=new u.Button(this.scene,"gmtools_commit","","","提交"),this.commitBtn.setTextStyle({fontSize:12*this.dpr});var y=54*this.dpr,g={x:0,y:60*this.dpr,table:{width:o,height:r-110*this.dpr,columns:1,cellWidth:o,cellHeight:y,reuseCellContainer:!0,zoom:a,cellPadX:0,cellPadY:10*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,o){var r=t.item;return null===o&&(o=new m(i.scene,91*i.dpr,46*i.dpr,i.dpr)).on("targetUI",i.onTargetUIHandler,i),o.setSize(t.width,t.height),o.setData({item:r}),o.setItemData(r),o}};this.gridtable=new u.GameGridTable(this.scene,g),this.gridtable.on("cellTap",(function(t){if(t){var o=t.item;o&&o.node&&i.onTargetUIHandler(o.node.id)}})),this.closeBtn=new u.Button(this.scene,h.UIAtlasKey.commonKey,"close"),this.add([this.background,this.gridtable,this.closeBtn,this.command,this.commitBtn]),t.prototype.init.call(this),this.resize()},GMToolsPanel.prototype.showButtons=function(){if(this.mShowData&&!(this.mShowData.length<1)){var t=this.showData[0],i=t.button;i.length>=1&&this.gridtable.setItems(i);var o=t.inputText;o&&o.length>0&&this.command.setData({item:o[0]})}},GMToolsPanel.prototype.onTargetUIHandler=function(t){!this.mShowData||this.mShowData.length<1||(this.emit("targetUI",this.mShowData[0].id,t),this.command.setBlur())},GMToolsPanel.prototype.onCloseHandler=function(){this.emit("close")},GMToolsPanel.prototype.onCommitCmdHandler=function(){if(this.command.setBlur(),this.mShowData&&!(this.mShowData.length<1)){var t=this.command.text;if(t){var i=this.command.getData("item");i&&i.node&&this.emit("targetUI",this.mShowData[0].id,i.node.id,t)}}},GMToolsPanel}(a.BasePanel),m=function(t){function Item(i,o,r,a){var h=t.call(this,i)||this;return h.btn=new u.Button(h.scene,"gmtools_btn","","","1"),h.btn.on(String(u.ClickEvent.Tap),h.onBtnHandler,h),h.btn.setTextStyle({fontSize:12*a}),h.btn.removeInteractive(),h.add(h.btn),h}return p(Item,t),Item.prototype.setItemData=function(t){this.item=t,this.btn.setText(t.text)},Item.prototype.onBtnHandler=function(){this.item&&this.emit("targetUI",this.item.id)},Item}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"InfoPanel",(function(){return g}));var r,a=o(112),h=o(116),l=o(121),c=o(111),u=o(113),p=o(272),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=Phaser.Utils.Objects.GetValue,g=function(t){function InfoPanel(i,o){var r=t.call(this,i,o)||this;return r.mWorld=o,r}return m(InfoPanel,t),InfoPanel.prototype.addListen=function(){this.mInitialized&&this.mCloseBtn&&this.mCloseBtn.on("pointerup",this.closeHandler,this)},InfoPanel.prototype.removeListen=function(){this.mInitialized&&this.mCloseBtn&&this.mCloseBtn.off("pointerup",this.closeHandler,this)},InfoPanel.prototype.resize=function(t,i){if(this.mInitialized){var o=this.mWorld.getSize(),r=this.mWorld.uiScale,a=this.mWorld.uiRatio;this.x=o.width>>1,this.y=o.height>>1,this.mActor.x=-this.width/2+80*r*a,this.mActor.y=-this.height/2+160*r*a,this.mNameTextArea.setMinSize(220*this.dpr*r,222*this.dpr*r),this.mNameTextArea.setPosition(o.width/2+60*this.dpr*r,o.height/2-110*this.dpr*r),this.mNameTextArea.layout();var h=this.mNameTextArea.childrenMap.text;h.x=-10*this.dpr*r,h.y=-200*this.dpr*r,this.mAttributesTextArea.setMinSize(360*this.dpr*r,180*this.dpr*r),this.mAttributesTextArea.setPosition(o.width/2+3*this.dpr*r,o.height/2+95*this.dpr*r),this.mAttributesTextArea.layout();var l=this.mAttributesTextArea.childrenMap.text;l.x=-this.width/2+30*this.dpr*r,l.y=5*this.dpr*r}},InfoPanel.prototype.show=function(i){if(!this.mShow&&(t.prototype.show.call(this,i),this.mInitialized)){var o=this.mWorld.getSize();this.setData("data",i),this.setInfo(i),this.resize(o.width,o.height)}},InfoPanel.prototype.hide=function(){t.prototype.hide.call(this)},InfoPanel.prototype.setInfo=function(t){var i=this;if(this.mInitialized&&t){if(t.actors){if(0===t.actors.length)return;var o=t.actors[0];this.mWorld.httpService.userDetail(o.platformId).then((function(t){if(200===t.code){var o=t.data;o&&i.mActor.load(c.i.getOsdRes("show/"+o.username+".png"),i,void 0,i.loadDefaultAvatar)}}))}var r=t.text;r[0]&&this.mNameTextArea.setText(this.checkValue(r[0])),r[1]&&this.mAttributesTextArea.setText(this.checkValue(r[1]))}},InfoPanel.prototype.destroy=function(){this.mActor&&(this.mActor.destroy(!0),this.mActor=null),this.mNameTextArea&&(this.mNameTextArea.destroy(),this.mNameTextArea=null),this.mAttributesTextArea&&(this.mAttributesTextArea.destroy(),this.mAttributesTextArea=null),this.mWorld=null,t.prototype.destroy.call(this)},InfoPanel.prototype.preload=function(){this.scene.load.image(c.d.getName(),c.d.getPNG()),this.scene.load.image(c.a.getName(),c.a.getPNG()),this.scene.load.atlas(c.c.getName(),c.c.getPNG(),c.c.getJSON()),t.prototype.preload.call(this)},InfoPanel.prototype.init=function(){var i=this.mWorld.getSize(),o=this.mWorld.uiScale;this.setSize(400*this.dpr*o,500*this.dpr*o);var r=new d.NinePatch(this.scene,{width:this.width,height:this.height,key:c.a.getName(),columns:c.a.getColumns(),rows:c.a.getRows()}),a=new d.NinePatch(this.scene,{width:this.width-20*this.dpr*o,height:this.height-20*this.dpr*o,key:c.d.getName(),columns:c.d.getColumns(),rows:c.d.getRows()});this.mNameBBCodeText=new d.BBCodeText(this.scene,0,0,"",{fontSize:14*this.dpr*o+"px",fontFamily:u.a.DEFULT_FONT,textMask:!1,wrap:{mode:"char",width:270*this.dpr*o}}),this.mNameTextArea=new d.TextArea(this.scene,{x:this.width/2-80*o*this.dpr,y:-75*o*this.dpr,textWidth:270*this.dpr*o,textHeight:180*this.dpr*o,textMask:!0,text:this.mNameBBCodeText}).layout(),this.mAttributesBBCodeText=new d.BBCodeText(this.scene,0,0,"",{fontSize:14*this.dpr*o+"px",fontFamily:u.a.DEFULT_FONT,textMask:!1,wrap:{mode:"char",width:this.width-30*this.dpr*o}}),this.mAttributesTextArea=new d.TextArea(this.scene,{x:i.width/2+3*this.dpr*o,y:i.height/2+95*this.dpr*o,textMask:!0,textWidth:this.width-60*this.dpr*o,textHeight:180*this.dpr*o,text:this.mAttributesBBCodeText}).layout(),this.mCloseBtn=new l.NinePatchButton(this.scene,258,145,80,34,c.c.getName(),"","关闭",c.c.getConfig()),this.mCloseBtn.x=0,this.mCloseBtn.y=this.height-100*this.mWorld.uiRatio*o>>1,this.mCloseBtn.setTextStyle({font:u.a.YAHEI_16_BOLD}),this.mActor=new h.DynamicImage(this.scene,300,125).setOrigin(.5,1),this.mActor.scale=2,this.mWorld.uiManager.getMediator(p.InfoPanelMediator.NAME).resize(),this.add([r,a,this.mNameBBCodeText,this.mAttributesBBCodeText,this.mCloseBtn,this.mActor]),this.addListen(),t.prototype.init.call(this),this.setInfo(this.getData("data"))},InfoPanel.prototype.closeHandler=function(t){this.checkPointerDis(t)&&this.hide()},InfoPanel.prototype.checkPointerDis=function(t){return!this.mWorld||(Math.abs(t.downX-t.upX)<10*this.mWorld.uiRatio*this.mWorld.uiScale||Math.abs(t.downY-t.upY)<10*this.mWorld.uiRatio*this.mWorld.uiScale)},InfoPanel.prototype.loadDefaultAvatar=function(){var t=c.i.getOsdRes("show/avatar_default.png");this.scene.textures.exists(t)?this.mActor.setTexture(t):this.mActor.load(t)},InfoPanel.prototype.checkValue=function(t){return y(t,"text","")},InfoPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"InfoPanelMediator",(function(){return p}));var r,a=o(119),h=o(271),l=o(146),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function InfoPanelMediator(i,o,r){var a=t.call(this)||this;return a.mLayerManager=i,a.mScene=o,a.world=r,a}return u(InfoPanelMediator,t),InfoPanelMediator.prototype.hide=function(){this.mShow=!1,this.world.emitter.off(a.a.SCENE_BACKGROUND_CLICK,this.onClosePanel,this),this.mView&&(this.mView.hide(),this.mView=null)},InfoPanelMediator.prototype.isSceneUI=function(){return!1},InfoPanelMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},InfoPanelMediator.prototype.resize=function(){this.mView&&this.mView.resize()},InfoPanelMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||i&&0!==i.length&&(this.mView=new h.InfoPanel(this.mScene,this.world),this.mView.show(i[0]),this.mLayerManager.addToUILayer(this.mView),this.world.emitter.on(a.a.SCENE_BACKGROUND_CLICK,this.onClosePanel,this),t.prototype.show.call(this,i))},InfoPanelMediator.prototype.destroy=function(){this.mView&&this.mView.destroy()},InfoPanelMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},InfoPanelMediator.prototype.onClosePanel=function(t){l.a.checkPointerContains(this.mView,t)||this.hide()},InfoPanelMediator.NAME="InfoPanelMediator",InfoPanelMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractivePanel",(function(){return y}));var r,a=o(112),h=o(111),l=o(117),c=o(164),u=o(2),p=o(274),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function InteractivePanel(i,o){var r=t.call(this,i,o)||this;return r.mRadioCom=!1,r.mLeftBaseScaleX=1,r.mLeftBaseScaleY=1,r.mMidBaseScaleX=1,r.mMidBaseScaleY=1,r.mRightBaseScaleX=1,r.mRightBaseScaleY=1,r.mDisDelection=10,r.setTween(!1),r}return m(InteractivePanel,t),InteractivePanel.prototype.show=function(i){var o=this;t.prototype.show.call(this,i);this.mWorld.getSize();if(this.mShowData=i,this.mInitialized){this.mShow=!0;var r=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME),a=this.mShowData[0];if(this.mLeftFaceIcon&&(this.mLeftFaceIcon.visible=!1),this.mRightFaceIcon&&(this.mRightFaceIcon.visible=!1),this.mMidFaceIcon&&(this.mMidFaceIcon.visible=!1),a.display&&a.display.length>0){var l=a.display[0],u=h.i.getOsdRes(l.texturePath);this.scene.cache.obj.get(u)?this.onLoadComplete():(this.scene.load.image(u,u),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR,this.onLoadError,this),this.scene.load.start())}if(this.mDescTF.text="",this.mNameTF.text="",a.text&&a.text.length>0){var d=a.text[0];if(this.mDescCon.setData("nodeID",d.node.id),this.mTextArea.setText(d.text),this.mDescCon.off("pointerup",this.descConClick,this),this.mDescCon.on("pointerup",this.descConClick,this),a.text[1]){var m=a.text[1];this.mNameCon.setData("nodeID",m.node.id),this.mNameTF.text=m.text,this.mNameTF.x=-this.mNameTF.width>>1,this.mNameCon.off("pointerup",this.nameConClick,this),this.mNameCon.on("pointerup",this.nameConClick,this)}}if(this.mRadio&&(this.mRadio.visible=!1),a.button&&a.button.length>0){var y=33*(a.button.length-1)+46;this.mRadio||(this.mRadio=new c.Radio(this.mScene,{wid:350,hei:y,resKey:"juqing",resPng:"./resources/ui/juqing/juqing.png",resJson:"./resources/ui/juqing/juqing.json",resBg:"radio_bg.png",resArrow:"radio_arrow.png",fontStyle:{size:20,color:"#ffcc00",bold:!1},completeBack:function(){o.radioComplete()},clickCallBack:function(t){t&&r&&r.componentClick(t.data)}}),this.radioComplete()),this.setRadioData(a.button),this.mRadio.visible=!0}this.resize(),this.mShow}else this.preload()},InteractivePanel.prototype.hide=function(){t.prototype.hide.call(this)},InteractivePanel.prototype.update=function(t){this.show(t)},InteractivePanel.prototype.getRadio=function(){return this.mRadio},InteractivePanel.prototype.setRadioData=function(t){this.mRadio.setRadioData(t)},InteractivePanel.prototype.resize=function(i,o){void 0===i&&(i=0),void 0===o&&(o=0),this.scale=this.mWorld.uiScale;var r=this.mWorld.getSize(),a=this.mWorld.getSize().width,h=this.mWorld.getSize().height,l=this.mWorld.uiScale;this.mNameCon.add(this.mNameBg),this.mNameCon.add(this.mNameTF),this.mDescCon.add(this.mBg),this.mDescCon.add(this.mBorder),this.mDescCon.add(this.mDescTF),this.mDescCon.add(this.mTextArea),this.add(this.mNameCon),this.add(this.mDescCon),this.setSize(a,h),this.mWorld.game.device.os.desktop?this.y=r.height/2-250:(this.mWorld.game.scale.orientation,Phaser.Scale.Orientation.LANDSCAPE,this.mBg.resize((r.width-10)/this.mWorld.uiScale,.5*r.height/this.mWorld.uiScale),this.mBorder.resize((r.width-20)/this.mWorld.uiScale,(.5*r.height-20)/this.mWorld.uiScale),this.y=1.5*this.mBg.height*this.mWorld.uiScale),this.x=r.width>>1,this.refreshUIPos(),this.mRadio&&this.add(this.mRadio),this.mTextArea.childrenMap.child.setMinSize(this.mBorder.width-10*this.dpr*l,this.mBorder.height-3*this.dpr*l),this.mTextArea.layout(),this.mTextArea.setPosition(a/2,this.y+this.mDescCon.y);var c=this.mTextArea.childrenMap.text;c.x=-this.mBorder.width>>1,c.y=-this.mBorder.height/2+20*this.dpr,c.resize(this.mBorder.width,this.mDescTF.displayHeight+2e3),this.mTextArea.scrollToBottom(),t.prototype.resize.call(this,i,o)},InteractivePanel.prototype.destroy=function(){this.mInitialized=!1,this.mNameCon&&this.mNameCon.destroy(!0),this.mDescCon&&this.mDescCon.destroy(!0),this.mLeftFaceIcon&&this.mLeftFaceIcon.destroy(!0),this.mMidFaceIcon&&this.mMidFaceIcon.destroy(!0),this.mRightFaceIcon&&this.mRightFaceIcon.destroy(!0),this.mNameTF&&this.mNameTF.destroy(!0),this.mDescTF&&this.mDescTF.destroy(!0),this.mRadio&&this.mRadio.destroy(),this.mNameCon=null,this.mDescCon=null,this.mLeftFaceIcon=null,this.mMidFaceIcon=null,this.mRightFaceIcon=null,this.mNameTF=null,this.mDescTF=null,this.mRadio=null,t.prototype.destroy.call(this)},InteractivePanel.prototype.preload=function(){this.mScene&&(this.scene.load.image(h.a.getName(),h.a.getPNG()),this.scene.load.image(h.d.getName(),h.d.getPNG()),this.mScene.load.atlas("juqing",h.i.getRes("ui/juqing/juqing.png"),h.i.getRes("ui/juqing/juqing.json")),t.prototype.preload.call(this))},InteractivePanel.prototype.init=function(){var i=this.mWorld.getSize().width,o=this.mWorld.getSize().height,r=this.mWorld.uiScale;this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this),this.mNameCon=this.mScene.make.container(void 0,!1),this.mDescCon=this.mScene.make.container(void 0,!1),this.mBg=new l.NinePatch(this.scene,0,0,1080,320,h.a.getName(),null,h.a.getConfig()),this.setSize(i,o),this.mBorder=new l.NinePatch(this.scene,0,0,1040,280,h.d.getName(),null,h.d.getConfig()),this.mLeftFaceIcon=this.mScene.make.image(void 0,!1),this.mMidFaceIcon=this.mScene.make.image(void 0,!1),this.mRightFaceIcon=this.mScene.make.image(void 0,!1),this.mNameTF=new d.BBCodeText(this.mScene,0,0,"",{fontSize:"20px",wrap:{mode:"char",width:this.mBorder.width}}),this.mNameBg=this.mScene.make.image(void 0,!1),this.mNameBg.setTexture("juqing","juqing_name.png"),this.mDescTF=new d.BBCodeText(this.mScene,0,0,"",{fontSize:"20px",halign:"left",textMask:!1,padding:{top:0,bottom:0,left:8*this.dpr*r,right:3*this.dpr*r},wrap:{mode:"character",width:this.mBorder.width-12*this.dpr*r}}),this.mTextArea=new d.TextArea(this.mScene,{x:i/2,y:this.mBorder.y+this.mBorder.height/2+80*this.dpr*r,width:this.mBorder.width,height:this.mBorder.height-20*this.dpr*r,textWidth:this.mBorder.width-12*this.dpr*r,textHeight:0,text:this.mDescTF}).layout(),this.mDescCon.setSize(this.mBg.width,this.mBg.height),this.mNameCon.setSize(this.mNameBg.width,this.mNameBg.height),this.mDescCon.setInteractive(),this.mNameCon.setInteractive(),t.prototype.init.call(this)},InteractivePanel.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.resize()},InteractivePanel.prototype.refreshUIPos=function(){var t=this.mWorld.getSize(),i=this.mWorld.uiScale;this.mDescCon.setSize(this.mBg.width,this.mBg.height),this.mNameCon.setSize(this.mNameBg.width,this.mNameBg.height),this.mNameTF.y=-8*this.mWorld.uiScale,this.mDescCon.y=this.mWorld.game.device.os.desktop?t.height/2+80:0,this.mNameCon.x=150-this.mDescCon.width/2,this.mNameCon.y=this.mDescCon.y-this.mDescCon.height/2-this.mNameCon.height/2-10,this.mNameTF.setWrapWidth(this.mBorder.width),this.mDescTF.setWrapWidth(this.mBorder.width-10*this.dpr*i),this.mNameTF.x=-this.mNameTF.width>>1;this.mDescCon.getWorldTransformMatrix().ty;if(!this.mWorld.game.device.os.desktop){var o=this.mLeftFaceIcon.width*this.mWorld.uiScale,r=this.mLeftFaceIcon.height*this.mWorld.uiScale,a=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,o,r);this.mLeftFaceIcon.scaleX=this.mLeftBaseScaleX*a*.7,this.mLeftFaceIcon.scaleY=this.mLeftBaseScaleY*a*.7,this.mLeftFaceIcon.x=this.mNameCon.x,this.mLeftFaceIcon.y=this.mNameTF.y-this.mLeftFaceIcon.height;var h=this.mMidFaceIcon.width*this.mWorld.uiScale,l=this.mMidFaceIcon.height*this.mWorld.uiScale,c=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,h,l);this.mMidFaceIcon.scaleX=this.mMidBaseScaleX*c*.7,this.mMidFaceIcon.scaleY=this.mMidBaseScaleY*c*.7,this.mMidFaceIcon.x=0,this.mMidFaceIcon.y=this.mNameTF.y-this.mMidFaceIcon.height;var u=this.mRightFaceIcon.width*this.mWorld.uiScale,p=this.mRightFaceIcon.height*this.mWorld.uiScale,d=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,u,p);this.mRightFaceIcon.scaleX=this.mRightBaseScaleX*d*.7,this.mRightFaceIcon.scaleY=this.mRightBaseScaleY*d*.7,this.mRightFaceIcon.x=-this.mNameCon.x,this.mRightFaceIcon.y=this.mNameTF.y-this.mRightFaceIcon.height}this.mRadioCom&&(this.mWorld.game.device.os.desktop?(this.mRadio.x=this.mBg.x+this.mBg.width/2-this.mRadio.width,this.mRadio.y=this.mDescCon.y+this.mDescCon.height/2-this.mRadio.height):(this.mRadio.x=this.mBg.width/2-this.mRadio.width,this.mRadio.y=this.mBg.height/2-this.mRadio.height))},InteractivePanel.prototype.getScale=function(t,i,o,r){return t/o>i/r?t/o:i/r},InteractivePanel.prototype.onLoadComplete=function(){this.mWorld.getSize();var t=this.mShowData[0].display[0],i=h.i.getOsdRes(t.texturePath),o=-this.mBorder.width/2,r=(this.mBorder.height,t.scaleX),a=t.scaleY,l=1;this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);switch(t.horizontal){case u.op_def.HorizontalAlignment.HORIZONTAL_LEFT:this.mLeftFaceIcon.setTexture(i),this.mLeftFaceIcon.setData("nodeID",t.node.id),this.mLeftBaseScaleX=r,this.mLeftBaseScaleY=a,l=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,this.mLeftFaceIcon.width,this.mLeftFaceIcon.height),this.mLeftFaceIcon.scaleX=r*l,this.mLeftFaceIcon.scaleY=a*l,this.mLeftFaceIcon.x=o+200,this.mLeftFaceIcon.setInteractive(),this.addAt(this.mLeftFaceIcon,0),this.mLeftFaceIcon.visible=!0,this.mLeftFaceIcon.off("pointerup",this.leftFaceClick,this),this.mLeftFaceIcon.on("pointerup",this.leftFaceClick,this);break;case u.op_def.HorizontalAlignment.HORIZONTAL_CENTER:this.mMidFaceIcon.setTexture(i),this.mMidFaceIcon.setData("nodeID",t.node.id),this.mMidBaseScaleX=r,this.mMidBaseScaleY=a,l=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,this.mMidFaceIcon.width,this.mMidFaceIcon.height),this.mMidFaceIcon.scaleX=r*l,this.mMidFaceIcon.scaleY=a*l,this.mMidFaceIcon.x=0,this.addAt(this.mMidFaceIcon,0),this.mMidFaceIcon.visible=!0,this.mMidFaceIcon.setInteractive(),this.mLeftFaceIcon.off("pointerup",this.midFaceClick,this),this.mMidFaceIcon.on("pointerup",this.midFaceClick,this);break;case u.op_def.HorizontalAlignment.HORIZONTAL_RIGHT:this.mRightFaceIcon.setTexture(i),this.mRightFaceIcon.setData("nodeID",t.node.id),this.mRightBaseScaleX=r,this.mRightBaseScaleY=a,l=this.getScale(InteractivePanel.baseWidth,InteractivePanel.baseHeight,this.mRightFaceIcon.width,this.mRightFaceIcon.height),this.mRightFaceIcon.scaleX=r*l,this.mRightFaceIcon.scaleY=a*l,this.mRightFaceIcon.x=200,this.addAt(this.mRightFaceIcon,0),this.mRightFaceIcon.visible=!0,this.mRightFaceIcon.setInteractive(),this.mRightFaceIcon.off("pointerup",this.rightFaceClick,this),this.mRightFaceIcon.on("pointerup",this.rightFaceClick,this)}this.resize()},InteractivePanel.prototype.rightFaceClick=function(t){if(this.checkPointer(t)){var i=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);i&&i.componentClick(this.mRightFaceIcon.getData("nodeID"))}},InteractivePanel.prototype.midFaceClick=function(t){if(this.checkPointer(t)){var i=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);i&&i.componentClick(this.mMidFaceIcon.getData("nodeID"))}},InteractivePanel.prototype.leftFaceClick=function(t){if(this.checkPointer(t)){var i=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);i&&i.componentClick(this.mLeftFaceIcon.getData("nodeID"))}},InteractivePanel.prototype.descConClick=function(t){if(this.checkPointer(t)){var i=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);this.mDescCon.getData("nodeID")&&i&&i.componentClick(this.mDescCon.getData("nodeID"))}},InteractivePanel.prototype.nameConClick=function(t){if(this.checkPointer(t)){var i=this.mWorld.uiManager.getMediator(p.InteractivePanelMediator.NAME);this.mNameCon.getData("nodeID")&&i&&i.componentClick(this.mNameCon.getData("nodeID"))}},InteractivePanel.prototype.checkPointer=function(t){return Math.abs(t.downX-t.upX)<this.mDisDelection&&Math.abs(t.downY-t.upY)<this.mDisDelection},InteractivePanel.prototype.onLoadError=function(t){},InteractivePanel.prototype.radioComplete=function(){this.mRadioCom=!0,this.mRadio&&(this.mRadio.x=220,this.mRadio.y=this.mDescCon.height+200,this.resize())},InteractivePanel.baseWidth=720,InteractivePanel.baseHeight=720,InteractivePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractivePanelMediator",(function(){return p}));var r,a=o(273),h=o(109),l=o(2),c=o(110),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function InteractivePanelMediator(i,o,r){var a=t.call(this)||this;return a.mUIType=h.UIType.Monopoly,a.mScene=o,a.world=r,a}return u(InteractivePanelMediator,t),InteractivePanelMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},InteractivePanelMediator.prototype.isSceneUI=function(){return!1},InteractivePanelMediator.prototype.resize=function(){if(this.mView&&this.mView.isShow)return this.mView.resize()},InteractivePanelMediator.prototype.getView=function(){return this.mView},InteractivePanelMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new a.InteractivePanel(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i))},InteractivePanelMediator.prototype.update=function(i){this.mView&&this.mView.isShow&&t.prototype.update.call(this,i)},InteractivePanelMediator.prototype.hide=function(){this.mShow=!1,this.mView&&(this.mView.hide(),this.mView=null)},InteractivePanelMediator.prototype.destroy=function(){this.world=null,this.mScene=null,this.mParam=null,t.prototype.destroy.call(this)},InteractivePanelMediator.prototype.componentClick=function(t){if(this.mParam&&this.mParam.length>0){var i=new c.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),o=i.content;o.uiId=this.mParam[0].id,o.componentId=t,this.world.connection.send(i)}},InteractivePanelMediator.NAME="InteractivePanelMediator",InteractivePanelMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemDetail",(function(){return p}));var r,a=o(112),h=o(111),l=o(145),c=o(121),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function ItemDetail(i,o){var r=t.call(this,i,o)||this;return r.mBtnWid=100,r.mBtnHei=40,r.mWid=0,r.mHei=0,r}return u(ItemDetail,t),ItemDetail.prototype.getBtnList=function(){return this.mBtnList},ItemDetail.prototype.resize=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var o=this.mWorld.getSize();this.mWorld.game.device.os.desktop,this.x=o.width-(this.width+this.mBtnWid)/2*this.mWorld.uiScale>>1,this.y=o.height-this.height*this.mWorld.uiScale>>1,this.scale=this.mWorld.uiScale},ItemDetail.prototype.show=function(t){if(this.mShowData=t,this.mInitialized){this.mShow=!0;var i=this.mShowData[0];if(i.display.length>0&&this.loadIcon(i.display[0]),i.text.length>0&&this.setText(i.text[0].text),i.button.length>0){this.mBtnList=[];for(var o=void 0,r=i.button.length,a=20,l=this.mWid+50,u=0;u<r;u++){var p=i.button[u];o=new c.NinePatchButton(this.mScene,0,0,this.mBtnWid,this.mBtnHei,h.c.getName(),h.c.getName(),p.text,h.c.getConfig(),p),this.mBtnList.push(o),o.x=l,o.y=a,a+=o.height+40,this.add(o)}}var d=this.mScene.add.graphics();d.fillStyle(0,.6),d.fillRoundedRect(0,0,this.mWid,this.mHei,6),this.addAt(d,0),this.setSize(this.mWid+120,this.mHei),this.resize(),this.setInteractive()}else this.preload()},ItemDetail.prototype.setText=function(t){this.mDescTF.setText(t),this.mHei+=this.mDescTF.y+this.mDescTF.height+10},ItemDetail.prototype.loadIcon=function(t){var i=this;this.mIcon&&this.mIcon.load(h.i.getOsdRes(t),(function(){i.mHei+=i.mIcon.y+i.mIcon.height}))},ItemDetail.prototype.hide=function(){this.disInteractive(),t.prototype.hide.call(this)},ItemDetail.prototype.destroy=function(){this.mBtnList&&(this.mBtnList.forEach((function(t){t.destroy(!0),t=null})),this.mBtnList=null),this.mResStr="",this.mResPng="",this.mResJson="",this.mNameTF&&this.mNameTF.destroy(!0),this.mDescTF&&this.mDescTF.destroy(!0),this.mIcon&&this.mIcon.destroy(),this.mNameTF=null,this.mDescTF=null,this.mIcon=null,this.mWid=0,this.mHei=0,t.prototype.destroy.call(this)},ItemDetail.prototype.preload=function(){this.mResStr="itemDetail",this.mResPng="ui/bag/bagView.png",this.mResJson="ui/bag/bagView.json",this.mScene&&(this.mScene.load.atlas(h.c.getName(),h.c.getPNG(),h.c.getJSON()),this.mScene.load.atlas("itemDetail",h.i.getRes("ui/bag/bagView.png"),h.i.getRes("ui/bag/bagView.json")),t.prototype.preload.call(this))},ItemDetail.prototype.init=function(){this.mWorld.getSize();this.mWid=290,this.mHei=0,this.mIcon=new l.DragDropIcon(this.mScene,30,25),this.add(this.mIcon),this.mNameTF=this.scene.make.text({style:{fontFamily:"YaHei",fontSize:20,origin:{x:0,y:0},wordWrap:{width:250,useAdvancedWrap:!0}}},!1),this.mNameTF.setFontStyle("bold"),this.mNameTF.setAlign("left"),this.mNameTF.x=this.mIcon.x+this.mIcon.width,this.mNameTF.y=this.mIcon.y,this.add(this.mNameTF),this.mDescTF=this.scene.make.text({style:{fontFamily:"YaHei",fontSize:25,origin:{x:0,y:0},wordWrap:{width:250,useAdvancedWrap:!0}}},!1),this.mDescTF.setFontStyle("bold"),this.mDescTF.setAlign("left"),this.mDescTF.x=this.mIcon.x-this.mIcon.width/2,this.mDescTF.y=this.mIcon.y+this.mIcon.height+20,this.add(this.mDescTF),this.mInitialized=!0,this.show(this.mShowData)},ItemDetail}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemPopCardPanel",(function(){return m}));var r,a=o(112),h=o(114),l=o(415),c=o(130),u=o(119),p=o(113),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function ItemPopCardPanel(i,o){var r=t.call(this,i,o)||this;return r.key="item_pop_card",r.mPressDelay=1e3,r.setTween(!1),r}return d(ItemPopCardPanel,t),ItemPopCardPanel.prototype.addListen=function(){this.mInitialized&&(this.mDetailDisplay.on("show",this.onShowHandler,this),this.on("pointerup",this.onCloseHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mNickName.on("pointerup",this.onPointerNickNameHandler,this),this.mNickName.on("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.on("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.on("pointerup",this.onPointerNickNameHandler,this))},ItemPopCardPanel.prototype.removeListen=function(){this.mInitialized&&(this.mDetailDisplay.off("show",this.onShowHandler,this),this.off("pointerup",this.onCloseHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mNickName.off("pointerup",this.onPointerNickNameHandler,this),this.mNickName.off("pointerdown",this.onPointerNickNameDownHandler,this),this.mDesText.off("pointerdown",this.onPointerDesDownHandler,this),this.mDesText.off("pointerup",this.onPointerNickNameHandler,this))},ItemPopCardPanel.prototype.resize=function(i,o){var r=this.mWorld.uiScale,a=this.scene.cameras.main.width/r,h=this.scene.cameras.main.height/r,l=this.scene.cameras.main.centerX/r,c=this.scene.cameras.main.centerY/r;this.setSize(a,h),this.mCardContainer.x=l,this.mCardContainer.y=c,this.mCloseBtn.x=l,this.mCloseBtn.y=c+this.mCardContainer.height/2+48*this.dpr,t.prototype.resize.call(this,i,o)},ItemPopCardPanel.prototype.setProp=function(){if(this.mShowData){var t=this.mShowData[0].prop;if(t){this.mDesText.setText(t.des),this.mNickName.setText(t.name),t.source?this.mSource.setText(h.a.t("item.source")+t.source):this.mSource.setText("");var i=this.mShowData[0].display;i&&(i.display?this.mDetailDisplay.loadDisplay(i):i.avatar?this.mDetailDisplay.loadAvatar(i.avatar):this.mDetailDisplay.loadUrl(t.icon))}}},ItemPopCardPanel.prototype.preload=function(){this.addAtlas(this.key,"item_pop_card/item_pop_card.png","item_pop_card/item_pop_card.json"),t.prototype.preload.call(this)},ItemPopCardPanel.prototype.init=function(){this.mCardContainer=this.scene.make.container({width:325*this.dpr,height:468*this.dpr},!1),this.mCardContainer.setSize(325*this.dpr,468*this.dpr),this.mCardContainer.setInteractive(),this.mBorder=this.scene.make.graphics(void 0,!1),this.mBorder.fillGradientStyle(7304703,7304703,118271,118271),this.mBorder.fillRect(-this.mCardContainer.width/2,-this.mCardContainer.height/2,this.mCardContainer.width,this.mCardContainer.height);var i=this.scene.make.image({key:this.key,frame:"bg.png"},!1);i.y=23*this.dpr-i.height/2;var o=this.scene.make.image({y:42*this.dpr,key:this.key,frame:"name_bg.png"});this.mNickName=this.scene.make.text({y:42*this.dpr,style:{fontSize:18*this.dpr,fontFamily:p.a.DEFULT_FONT}},!1).setOrigin(.5).setInteractive();var r=this.scene.make.image({y:138*this.dpr,key:this.key,frame:"des_bg.png"},!1);this.mDesText=this.scene.make.text({x:r.x-r.width/2+12*this.dpr,y:r.y-r.height/2+10*this.dpr,style:{fontSize:10*this.dpr,fontFamily:p.a.DEFULT_FONT,wordWrap:{width:240*this.dpr,useAdvancedWrap:!0}}},!1).setInteractive(),this.mDetailDisplay=new c.DetailDisplay(this.scene),this.mDetailDisplay.scale=2*this.dpr,this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close.png"},!1).setInteractive(),this.mSource=this.scene.make.text({x:r.x-r.width/2+12*this.dpr,y:r.y+r.height/2-23*this.dpr,style:{fontSize:10*this.dpr,fontFamily:p.a.DEFULT_FONT}},!1),this.add(this.mCardContainer),this.mCardContainer.add([this.mBorder,i,r,this.mDetailDisplay,o,this.mNickName,this.mDesText,this.mSource]),this.add(this.mCloseBtn),this.resize(0,0),t.prototype.init.call(this),this.setInteractive(),this.setProp()},ItemPopCardPanel.prototype.onCloseHandler=function(){this.emit("close"),clearTimeout(this.mPressTime),this.mNickNameDown=!1},ItemPopCardPanel.prototype.onPointerNickNameHandler=function(){clearTimeout(this.mPressTime),this.mNickNameDown=!1},ItemPopCardPanel.prototype.onPointerNickNameDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyName()}),this.mPressDelay)},ItemPopCardPanel.prototype.onPointerDesDownHandler=function(){var t=this;this.mPressTime=setTimeout((function(){t.copyDes()}),this.mPressDelay)},ItemPopCardPanel.prototype.copyName=function(){if(this.mNickName){l(this.mNickName.text);var t={noticeContext:h.a.t("item.copy_suc",{name:h.a.t("item.name")})};this.mWorld.emitter.emit(u.a.SHOW_NOTICE,{content:t})}},ItemPopCardPanel.prototype.copyDes=function(){if(this.mDesText){l(this.mDesText.text);var t={noticeContext:h.a.t("item.copy_suc",{name:h.a.t("item.des")})};this.mWorld.emitter.emit(u.a.SHOW_NOTICE,{content:t})}},ItemPopCardPanel.prototype.onShowHandler=function(t){this.mDetailDisplay.y=-this.mCardContainer.height/4},ItemPopCardPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"LoginPanel",(function(){return m}));var r,a=o(112),h=o(131),l=o(113),c=o(115),u=o(155),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function LoginPanel(i,o){var r=t.call(this,i,o)||this;return r.key="login",r.areaCode="86",r.downcount=-1,r}return d(LoginPanel,t),LoginPanel.prototype.show=function(){t.prototype.show.call(this),this.mInitialized&&this.setInputVisible(!0)},LoginPanel.prototype.setInputVisible=function(t){this.mPhoneCodeInput&&(this.mPhoneCodeInput.visible=t,this.mPhoneInput.visible=t)},LoginPanel.prototype.destroy=function(){t.prototype.destroy.call(this),this.fetchTime&&clearTimeout(this.fetchTime)},LoginPanel.prototype.setLoginEnable=function(t){this.loginBtn.enable=t},LoginPanel.prototype.preload=function(){this.addAtlas(this.key,"./login/login.png","./login/login.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},LoginPanel.prototype.init=function(){t.prototype.init.call(this);var i=this.scene.cameras.main.width/this.scale,o=this.scene.cameras.main.height/this.scale,r=(this.scale,this.scene.make.graphics(void 0,!1));r.fillRect(0,0,i,o),r.fillGradientStyle(7304703,7304703,118271,118271);var a=this.scene.make.image({x:0,y:0,key:this.key,frame:"cloud_left"},!1).setOrigin(0);a.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var d=this.scene.make.image({x:i,y:0,key:this.key,frame:"cloud_right"},!1).setOrigin(1,0);d.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var m=this.scene.make.image({x:.5*i,y:44*this.dpr,key:this.key,frame:"logo"},!1).setOrigin(.5,0);m.texture.setFilter(Phaser.Textures.FilterMode.LINEAR);var y=this.scene.make.image({key:this.key,frame:"bg"});y.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),y.x=.5*i,y.y=o-.5*y.height,this.mPhoneInput=new p.InputText(this.scene,0,0,256*this.dpr,40*this.dpr,{type:"tel",maxLength:11,placeholder:"请输入手机号",color:"#717171",fontSize:16*this.dpr+"px"});var g=this.createInput(this.mPhoneInput,.5*i,97*this.dpr+m.y+m.height),_=localStorage.getItem("accountphone");if(_)try{this.mPhoneInput.text=JSON.parse(_).account}catch(t){}this.mPhoneCodeInput=new p.InputText(this.scene,0,0,156*this.dpr,40*this.dpr,{type:"tel",maxLength:4,placeholder:"验证码",color:"#717171",text:"",fontSize:16*this.dpr+"px"}).setOrigin(0,.5);var v=this.createInput(this.mPhoneCodeInput,.5*i,172*this.dpr+m.y+m.height,256*this.dpr);this.mPhoneCodeInput.x=-v.width/2+8*this.dpr;var b=this.scene.make.text({x:.5*i,text:"抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",style:{color:"#FFEC48",align:"center",fontSize:11*this.dpr,fontFamily:l.a.DEFULT_FONT}},!1).setOrigin(.5);b.setResolution(this.dpr),b.y=o-50*this.dpr-.5*b.height;var P=this.scene.make.text({x:.5*i,text:"本网络游戏适合年满16周岁以上的用户，请您确认已如实进行\n实名注册，为了您的健康，请合理控制游戏时间。",style:{color:"#FFFFFF",align:"center",fontSize:9.33*this.dpr,fontFamily:l.a.DEFULT_FONT}}).setOrigin(.5);P.setResolution(this.dpr),P.y=o-16*this.dpr-.5*P.height;var w=this.scene.make.image({x:12*this.dpr,key:this.key,frame:"line"},!1);w.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.fetchCode=this.scene.make.text({text:"获取验证码",style:{fontSize:14*this.dpr,fontFamily:l.a.DEFULT_FONT,color:"#2B5AF3"}},!1).setOrigin(.5).setInteractive(),this.fetchCode.x=.5*(v.width-this.fetchCode.width)-22*this.dpr,this.fetchCode.setResolution(this.dpr),this.fetchCode.on("pointerup",this.onFetchCodeHandler,this),this.fetchCode.on("pointerdown",this.onFetchCodeDownHandler,this),v.add([w,this.fetchCode]),this.loginBtn=new p.NineSliceButton(this.scene,.5*i,v.y+v.height+33*this.dpr,191*this.dpr,50*this.dpr,c.UIAtlasKey.commonKey,"yellow_btn","登 录",this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:14*this.dpr,bottom:12*this.dpr}),this.loginBtn.setTextStyle({color:"#995E00",fontSize:22*this.dpr,fontFamily:l.a.DEFULT_FONT}),this.loginBtn.setFontStyle("bold"),this.loginBtn.on(String(p.ClickEvent.Down),this.LoginDownHandler,this),this.loginBtn.on(String(p.ClickEvent.Tap),this.tryLogin,this);var S=new p.BBCodeText(this.scene,0,0,"我已阅读并同意皮卡堂的[area=userService][color=#FFEC48]《用户服务协议》[/color][/area]和[area=privacy][color=#FFEC48]《隐私与保护政策》[/color][/area]",{color:"#ffffff",fontSize:11*this.dpr,fontFamily:l.a.DEFULT_FONT}).setOrigin(.5,.5).setInteractive().on("areadown",(function(t){u.a.openUrl("https://picatown.com/con_news/news.php?nid=1201")}));S.setResolution(this.dpr),this.acceptBtn=new p.CheckBox(this.scene,this.key,"accept_unchecked","accept_checked").on(String(p.ClickEvent.Tap),this.onCheckboxHandler,this),S.x=this.loginBtn.x+8*this.dpr,S.y=this.loginBtn.y+.5*this.loginBtn.height+24*this.dpr,this.acceptBtn.x=S.x-.5*S.width-8*this.dpr,this.acceptBtn.y=S.y,this.acceptBtn.selected=!0,this.add([r,y,a,d,m,g,v,b,P,this.loginBtn,this.acceptBtn,S]),this.scene.scene.sleep(h.a.name),t.prototype.init.call(this)},LoginPanel.prototype.createInput=function(t,i,o,r){var a=this.scene.make.container({x:i,y:o},!1),h=this.scene.textures.getFrame(this.key,"input_bg"),l=new p.NineSlicePatch(this.scene,t.x-8*this.dpr,t.y,(r||t.width)+14*this.dpr,h.height,this.key,"input_bg",{left:27*this.dpr,top:0*this.dpr,right:28*this.dpr,bottom:0*this.dpr},this.dpr,1);return a.add([t,l]),a.setSize(l.width,l.height),a},LoginPanel.prototype.onFetchCodeDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onFetchCodeHandler=function(){var t=this,i=this.mPhoneInput.text;11===i.length?this.fetchTime||(this.downcount=60,this.fetchTime=setInterval((function(){--t.downcount<=0&&(clearInterval(t.fetchTime),t.fetchTime=void 0),t.downcount>0?t.fetchCode.setText("获取验证码("+t.downcount+")"):t.fetchCode.setText("获取验证码")}),1e3),this.emit("fetchCode",i,this.areaCode)):this.emit("error","手机格式错误")},LoginPanel.prototype.tryLogin=function(){var t=this.mPhoneInput.text,i=this.mPhoneCodeInput.text;11===t.length?i?this.emit("login",t,i,this.areaCode):this.emit("error","验证码格式错误"):this.emit("error","手机格式错误")},LoginPanel.prototype.LoginDownHandler=function(){this.mPhoneInput&&(this.mPhoneCodeInput.setBlur(),this.mPhoneInput.setBlur())},LoginPanel.prototype.onCheckboxHandler=function(){this.tryLogin&&(this.loginBtn.enable=this.acceptBtn.selected)},LoginPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"VerifiedPanel",(function(){return p}));var r,a=o(112),h=o(113),l=o(115),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function VerifiedPanel(i,o){var r=t.call(this,i,o)||this;return r.isIDCard=/^[1-9]\d{5}(19|20|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,r}return u(VerifiedPanel,t),VerifiedPanel.prototype.setVerifiedEnable=function(t){this.mIDCardInput&&(this.mNameInput.visible=t,this.mIDCardInput.visible=t,this.mVerifiedBtn.enable=t)},VerifiedPanel.prototype.preload=function(){this.addAtlas(l.UIAtlasKey.commonKey,l.UIAtlasName.commonUrl+".png",l.UIAtlasName.commonUrl+".json"),this.addAtlas(l.UIAtlasKey.common2Key,l.UIAtlasName.common2Url+".png",l.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},VerifiedPanel.prototype.init=function(){var i=this.scene.cameras.main,o=i.width,r=i.height,a=this.scene.make.graphics(void 0,!1);a.fillStyle(0,.6),a.fillRect(.5*-o,.5*-r,o,r).setInteractive(new Phaser.Geom.Rectangle(.5*-o,.5*-r,o,r),Phaser.Geom.Rectangle.Contains);var u=this.scene.make.container({},!1),p=this.scene.make.image({key:l.UIAtlasKey.common2Key,frame:"bg"},!1);u.setSize(p.width,p.height);var d=this.scene.make.image({y:-16.33*this.dpr-.5*u.height,key:l.UIAtlasKey.common2Key,frame:"title"},!1).setOrigin(.5,0),m=this.scene.make.text({y:d.y+14.67*this.dpr,text:"实名注册",style:{color:"#905B06",fontSize:16*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5,0);this.mNameInput=new c.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"text",placeholder:"请输入真实姓名",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5),this.mIDCardInput=new c.InputText(this.scene,0,0,160*this.dpr,36*this.dpr,{type:"tel",maxLength:18,placeholder:"请输入有效身份证号",color:"#838383",fontSize:10*this.dpr+"px"}).setOrigin(0,.5);var y=this.createInput(this.mNameInput,"*真实姓名：",0,0);y.x=.5*-y.width,y.y=95*this.dpr+.5*y.height-.5*u.height;var g=this.createInput(this.mIDCardInput,"*身份证号：",0,y.y+y.height+15*this.dpr);g.x=y.x;var _=this.scene.make.text({y:40*this.dpr-.5*u.height,text:"根据国家新闻出版署发布《关于未成年人沉迷网络\n游戏的通知》规定，网络游戏用户需要使用有效期\n身份证进行实名注册才能体验游戏。",style:{align:"center",fontSize:10*this.dpr,fontFamily:h.a.DEFULT_FONT,color:"#111111"}},!1).setOrigin(.5,0),v=this.scene.make.text({y:.5*u.height-75*this.dpr,text:"请务必保证您的身份信息确实无误，此信息仅作实名认证，我们将严格\n按照有关法律法规妥善保存、保护，不会用做其他用途。",style:{align:"center",fontSize:8*this.dpr,fontFamily:h.a.DEFULT_FONT,color:"#FF0000"}},!1).setOrigin(.5,1);this.add([a,u]),this.mVerifiedBtn=new c.NineSliceButton(this.scene,0,.5*u.height-16*this.dpr,110*this.dpr,34*this.dpr,l.UIAtlasKey.commonKey,"yellow_btn","提交认证",this.dpr,this.scale,{left:12*this.dpr*this.scale,top:12*this.dpr*this.scale,right:12*this.dpr*this.scale,bottom:12*this.dpr*this.scale}),this.mVerifiedBtn.setTextStyle({color:"#996600",fontSize:14*this.dpr,fontFamily:h.a.DEFULT_FONT}),this.mVerifiedBtn.on(String(c.ClickEvent.Down),this.onVerifiedDownHandler,this),this.mVerifiedBtn.on(String(c.ClickEvent.Tap),this.onVerifiedHandler,this),this.mVerifiedBtn.y-=this.mVerifiedBtn.height/2,this.mVerifiedBtn.setFontStyle("bold"),u.add([p,d,m,y,g,_,v,this.mVerifiedBtn]),t.prototype.init.call(this),this.x=o*this.originX,this.y=r*this.originY,u.y=.3*-this.y},VerifiedPanel.prototype.onVerifiedHandler=function(){var t=this.mNameInput.text,i=this.mIDCardInput.text;t?i&&18===i.length?this.checkIdCard()?this.emit("verified",t,i):this.emit("error","[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]"):this.emit("error","[color=#F9361B]证件格式有误[/color]"):this.emit("error","[color=#F9361B]名字不能为空[/color]")},VerifiedPanel.prototype.onVerifiedDownHandler=function(){this.mNameInput&&(this.mNameInput.setBlur(),this.mIDCardInput.setBlur())},VerifiedPanel.prototype.createInput=function(t,i,o,r){var a=this.scene.make.container({x:o,y:r},!1),l=this.scene.make.text({text:i,style:{color:"#ff0000",fontSize:10*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),c=this.scene.make.graphics(void 0,!1),u=189*this.dpr,p=36.67*this.dpr;return c.fillStyle(14540253),c.lineStyle(2*this.dpr,10592673),c.fillRoundedRect(l.width,.5*-p,u,p,2*this.dpr),t.x=l.width+10*this.dpr,a.add([l,c,t]),a.setSize(u+t.x,p),a},VerifiedPanel.prototype.checkIdCard=function(){var t=this.mIDCardInput.text;if(this.isIDCard.test(t)&&18===t.length){for(var i=t.split(""),o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],r=0,a=0;a<17;a++)r+=i[a]*o[a];return["1","0","X","9","8","7","6","5","4","3","2"][r%11]===i[17].toLocaleUpperCase()}return!1},Object.defineProperty(VerifiedPanel.prototype,"verifiedBtn",{get:function(){return this.mVerifiedBtn},enumerable:!1,configurable:!0}),VerifiedPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"MessageBoxView",(function(){return d}));var r,a=o(112),h=o(121),l=o(111),c=o(117),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function MessageBoxView(i,o){return t.call(this,i,o)||this}return p(MessageBoxView,t),MessageBoxView.prototype.resize=function(){var t=this.mWorld.getSize();this.mWorld.game.device.os.desktop,this.x=t.width>>1,this.y=t.height>>1},MessageBoxView.prototype.show=function(i){if(t.prototype.show.call(this,i),this.mInitialized){this.mButtons=[],i[0]&&i[0].text&&i[0].text[0]&&this.mTxt.setText(i[0].text[0].text);var o=i[0].button;if(o){var r=this.mWidth/o.length,a=this.mScene.make.container(void 0,!1);a.y=this.mHeight-24-100;for(var c=0;c<o.length;c++){o[c]&&o[c].text;var u=new h.NinePatchButton(this.mScene,0,0,46,24,"button_blue","button_blue",o[c].text,l.c.getConfig(),o[c]);u.x=c*r+23,this.mButtons.push(u),a.add(u)}a.setSize((o.length-1)*r+46,24),a.x=this.width-a.width>>1,this.add(a)}this.resize()}},MessageBoxView.prototype.destroy=function(){this.mTxt&&this.mTxt.destroy(!0),this.mButtons&&this.mButtons.length>0&&(this.mButtons.forEach((function(t){t&&t.destroy(!0)})),this.mButtons.length=0,this.mButtons=[]),this.mTxt=null,this.mButtons=null,t.prototype.destroy.call(this)},Object.defineProperty(MessageBoxView.prototype,"buttons",{get:function(){return this.mButtons},enumerable:!1,configurable:!0}),MessageBoxView.prototype.preload=function(){this.mScene&&(this.mScene.load.atlas(l.c.getName(),l.c.getPNG(),l.c.getJSON()),this.mScene.load.image(l.d.getName(),l.d.getPNG()),t.prototype.preload.call(this))},MessageBoxView.prototype.init=function(){this.mWorld.getSize();this.mWidth=300,this.mHeight=200;var i=new c.NinePatch(this.scene,0,0,this.mWidth,this.mHeight,l.d.getName(),null,l.d.getConfig());i.x=0,i.y=0,this.add(i),this.mTxt=new u.BBCodeText(this.mScene,0,0,"",{fontSize:"16px",wrap:{mode:"char",width:i.width},halign:"center"}),this.mTxt.x=-this.mWidth/2+10,this.mTxt.y=-this.mHeight/2+10,this.add(this.mTxt),t.prototype.init.call(this)},MessageBoxView}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessChoosePlanPanel",(function(){return y}));var r,a=o(113),h=o(115),l=o(114),c=o(111),u=o(116),p=o(129),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicBusinessChoosePlanPanel(i,o,r,a,h,l,c,u){var p=t.call(this,i,o,r)||this;return p.dpr=l,p.key=u,p.zoom=c,p.setSize(a,h),p.create(),p}return m(PicBusinessChoosePlanPanel,t),PicBusinessChoosePlanPanel.prototype.setPlanData=function(t){this.gridtable.setItems(t);var i=this.gridtable.getCells();if(i){var o=i[0];o&&o.container&&this.onGridSelectHandler(o.container)}},PicBusinessChoosePlanPanel.prototype.setHandler=function(t,i){this.cancelHandler=t,this.selectHandler=i},PicBusinessChoosePlanPanel.prototype.resetMask=function(){this.gridtable.resetMask(),this.gameScroll.refreshMask()},PicBusinessChoosePlanPanel.prototype.create=function(){var t=this,i=(this.height,this.width-29*this.dpr),o=100*this.dpr,r=.5*-this.height+.5*o+10*this.dpr;this.gridtable=this.createGrideTable(0,r,i,o,90*this.dpr,100*this.dpr),this.describleText=this.scene.make.text({x:.5*-this.width+20*this.dpr,y:r+.5*o+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.describleText.setWordWrapWidth(this.width-45*this.dpr,!0),this.add(this.describleText),this.effectText=this.scene.make.text({x:this.describleText.x,y:this.describleText.y+this.describleText.height+10*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(0),this.add(this.effectText),this.materialTitle=this.scene.make.text({x:this.describleText.x,y:this.effectText.y+this.effectText.height+5*this.dpr,text:l.a.t("business_street.material_requirements"),style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(0),this.add(this.materialTitle),this.gameScroll=new d.GameScroller(this.scene,{x:0,y:this.materialTitle.y+this.materialTitle.height+20*this.dpr,width:this.width-40*this.dpr,height:60*this.dpr,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:10*this.dpr,celldownCallBack:function(i){t.iteminfoTips.visible=!0,t.onMaterialItemHandler(i)},cellupCallBack:function(i){t.iteminfoTips.visible=!1}}),this.add(this.gameScroll);var c=new d.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,h.UIAtlasKey.commonKey,"red_btn",l.a.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(c),c.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),c.on(String(d.ClickEvent.Tap),this.onCancelHandler,this);var u=new d.NineSliceButton(this.scene,60*this.dpr,c.y,92*this.dpr,34*this.dpr,h.UIAtlasKey.commonKey,"yellow_btn",l.a.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(u),u.on(String(d.ClickEvent.Tap),this.onSelectHandler,this),u.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#996600"}),this.iteminfoTips=new p.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,h.UIAtlasKey.commonKey,"tips_bg",this.dpr),this.iteminfoTips.visible=!1,this.add(this.iteminfoTips)},PicBusinessChoosePlanPanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new g(l.scene,0,0,a,h,l.key,l.dpr,l.zoom)),i.setData({item:o}),i.setPlanData(o),l.curSelectData&&o===l.curSelectData?i.select=!0:i.select=!1,i}},u=new d.GameGridTable(this.scene,c);return u.layout(),u.on("cellTap",(function(t){t&&l.onGridSelectHandler(t)})),this.add(u),u},PicBusinessChoosePlanPanel.prototype.onGridSelectHandler=function(t){this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0;var i=t.palnData;this.gameScroll.clearItems();for(var o=0,r=i.requirements;o<r.length;o++){var a=r[o],h=new _(this.scene,0,0,36*this.dpr,36*this.dpr,this.key,this.dpr,this.zoom);h.setItemData(a),this.gameScroll.addItem(h)}this.gameScroll.Sort(),this.describleText.text=i.des,this.effectText.text=l.a.t("business_street.effect")+":"+i.buffDes,this.curSelectItem=t,this.curSelectData=i},PicBusinessChoosePlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicBusinessChoosePlanPanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData.id),this.onCancelHandler()},PicBusinessChoosePlanPanel.prototype.onMaterialItemHandler=function(t){var i=t.itemData;this.iteminfoTips.setText(this.getDesText(i));var o=t.getWorldTransformMatrix(),r=this.gameScroll.getWorldTransformMatrix();this.iteminfoTips.x=o.tx-r.tx,this.iteminfoTips.y=this.gameScroll.y-20*this.dpr},PicBusinessChoosePlanPanel.prototype.getDesText=function(t){t||(t={sellingPrice:!0,tradable:!1});var i=t.name+"\n",o=l.a.t("common.source")+":";if(i+=(o="[stroke=#333333][color=#333333]"+(o+=t.source)+"[/color][/stroke]")+"\n",t.sellingPrice){var r=l.a.t("common.sold");i+=(r="[stroke=#333333][color=#333333]"+(r+=c.f.getName(t.sellingPrice.coinType)+" x "+t.sellingPrice.price)+"[/color][/stroke]")+"\n"}if(!t.tradable){var a=l.a.t("furni_unlock.notrading");i+=a="[stroke=#333333][color=#ff0000]*"+a+"[/color][/stroke]"}return i},PicBusinessChoosePlanPanel}(Phaser.GameObjects.Container),g=function(t){function PlanTypeItem(i,o,r,h,l,c,p,d){var m=t.call(this,i,o,r)||this;return m.isSelect=!1,m.dpr=p,m.key=c,m.setSize(h,l),m.bg=m.scene.make.image({key:c,frame:"store_bg"}),m.add(m.bg),m.storeIcon=new u.DynamicImage(m.scene,0,0),m.storeIcon.setTexture(m.key,"restaurant_icon"),m.storeIcon.setPosition(0,-8*p),m.add(m.storeIcon),m.storeName=m.scene.make.text({x:0,y:m.storeIcon.y+.5*m.storeIcon.height+10*p,text:"Restaurant",style:{color:"#0",fontSize:10*p,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5),m.add(m.storeName),m}return m(PlanTypeItem,t),PlanTypeItem.prototype.setPlanData=function(t){var i=this;this.palnData=t;var o=t.icon;""===o&&t.requirements&&t.requirements.length>0&&(o=t.requirements[0].display.texturePath);var r=c.i.getOsdRes(o);this.storeIcon.load(r,this,(function(){i.storeIcon.displayWidth=46*i.dpr,i.storeIcon.scaleY=i.storeIcon.scaleX})),this.storeName.text=t.name},Object.defineProperty(PlanTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var i=t?"store_bg_click":"store_bg";this.bg.setFrame(i)},enumerable:!1,configurable:!0}),PlanTypeItem}(Phaser.GameObjects.Container),_=function(t){function MaterialItem(i,o,r,h,l,c,p,m){var y=t.call(this,i,o,r)||this;y.dpr=p,y.key=c,y.setSize(h,l);var g=y.scene.make.image({key:y.key,frame:"item_bg"});return y.add(g),y.itemIcon=new u.DynamicImage(y.scene,0,0),y.add(y.itemIcon),y.countText=new d.BBCodeText(y.scene,.5*g.width,.5*g.height).setOrigin(1,.5).setFontSize(12*p).setFontFamily(a.a.DEFULT_FONT),y.add(y.countText),y}return m(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var i=this;this.itemData=t;var o=c.i.getOsdRes(t.display.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.displayWidth=29*i.dpr,i.itemIcon.scaleY=i.itemIcon.scaleX})),this.countText.text=this.getCountText(t.count,t.neededCount)},MaterialItem.prototype.getCountText=function(t,i){var o=t>=i?"#0054FF":"#FF2B2B";return"[stroke="+o+"][color="+o+"]"+t+"[/color][/stroke]"+("[stroke=#2D2D2D][color=#2D2D2D]/"+i+"[/color][/stroke]")},MaterialItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessMarketingPlan",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicBusinessMarketingPlan(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicBusinessMarketingPlan,t),PicBusinessMarketingPlan.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_MARKET_PLAN,this.onEquiped_MARKET_PLAN),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_MARKET_PLAN_MODELS_BY_TYPE,this.onMARKET_PLAN_MODELS_BY_TYPE))},PicBusinessMarketingPlan.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicBusinessMarketingPlan.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicBusinessMarketingPlan.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicBusinessMarketingPlan.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicBusinessMarketingPlan.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicBusinessMarketingPlan.prototype.query_Equiped_MARKET_PLAN=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_MARKET_PLAN);i.content.roomId=t,this.connection.send(i)},PicBusinessMarketingPlan.prototype.query_MARKET_PLAN_MODELS_BY_TYPE=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_MARKET_PLAN_MODELS_BY_TYPE);i.content.marketPlanType=t,this.connection.send(i)},PicBusinessMarketingPlan.prototype.query_SELECT_MARKET_PLAN=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SELECT_MARKET_PLAN),r=o.content;r.marketPlanId=i,r.roomId=t,this.connection.send(o)},PicBusinessMarketingPlan.prototype.onEquiped_MARKET_PLAN=function(t){var i=t.content;this.mEvent.emit("onequipedplan",i)},PicBusinessMarketingPlan.prototype.onMARKET_PLAN_MODELS_BY_TYPE=function(t){var i=t.content;this.mEvent.emit("onplanmodels",i)},PicBusinessMarketingPlan}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i);var r,a=o(112),h=o(115),l=o(120),c=o(168),u=o(283),p=o(280),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function PicBusinessMarketingPlanPanel(i,o){var r=t.call(this,i,o)||this;return r.key="c_street_1",r.key2="c_street_2",r}return d(PicBusinessMarketingPlanPanel,t),PicBusinessMarketingPlanPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,r,a)},PicBusinessMarketingPlanPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicBusinessMarketingPlanPanel.prototype.addListen=function(){this.mInitialized},PicBusinessMarketingPlanPanel.prototype.removeListen=function(){this.mInitialized},PicBusinessMarketingPlanPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(h.UIAtlasKey.commonKey,h.UIAtlasName.commonUrl+".png",h.UIAtlasName.commonUrl+".json"),this.addAtlas(h.UIAtlasKey.common2Key,h.UIAtlasName.common2Url+".png",h.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicBusinessMarketingPlanPanel.prototype.init=function(){var i=this.scale,o=this.scaleWidth,r=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,o*i,r*i),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var a=90*this.dpr,h=74*this.dpr,u=295*this.dpr,p=r-a-h,d=a+.5*p,m=.5*o;this.content=new c.PicBusinessContentPanel(this.scene,m,d,u,p,this.dpr,this.key,this.key2),this.content.setCloseHandler(new l.a(this,this.OnCloseHandler)),this.add(this.content),this.resize(o,r),t.prototype.init.call(this),this.openPlanPanel()},PicBusinessMarketingPlanPanel.prototype.setPlanModels=function(t){this.picChoosePlanPanel.setPlanData(t.marketPlan)},PicBusinessMarketingPlanPanel.prototype.setEquipedPlan=function(t){this.picBusinessPlanPanel.setPlanData(t)},PicBusinessMarketingPlanPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicBusinessMarketingPlanPanel.prototype.openPlanPanel=function(){this.showMarketingPlanPanel(),this.picBusinessPlanPanel.setWorld(this.mWorld),this.emit("querymarketplan")},PicBusinessMarketingPlanPanel.prototype.openChoosePlanPanel=function(){this.showChoosePlanPanel(),this.picChoosePlanPanel.resetMask()},PicBusinessMarketingPlanPanel.prototype.showMarketingPlanPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picBusinessPlanPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picBusinessPlanPanel=new u.PicBusinessPlanPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key),this.picBusinessPlanPanel.setHandler(new l.a(this,(function(){t.hideMarketingPlanPanel(),t.OnCloseHandler()})),new l.a(this,(function(i){t.hideMarketingPlanPanel(),t.openChoosePlanPanel(),t.emit("queryplanmodels",i)})))}this.content.add(this.picBusinessPlanPanel),this.picBusinessPlanPanel.resetMask()},PicBusinessMarketingPlanPanel.prototype.hideMarketingPlanPanel=function(){this.content.remove(this.picBusinessPlanPanel)},PicBusinessMarketingPlanPanel.prototype.showChoosePlanPanel=function(){var t=this,i=this.scaleWidth,o=this.scaleHeight,r=295*this.dpr,a=320*this.dpr,h=.5*o,c=.5*i;if(this.content.setPosition(c,h),this.content.setContentSize(r,a),!this.picChoosePlanPanel){var u=this.content.width,d=this.content.height-50*this.dpr;this.picChoosePlanPanel=new p.PicBusinessChoosePlanPanel(this.scene,0,0,u,d,this.dpr,this.scale,this.key),this.picChoosePlanPanel.setHandler(new l.a(this,(function(){t.hideChoosePlanPanel(),t.openPlanPanel()})),new l.a(this,(function(i){t.emit("queryselectplan",i)})))}this.content.add(this.picChoosePlanPanel),this.picBusinessPlanPanel.resetMask()},PicBusinessMarketingPlanPanel.prototype.hideChoosePlanPanel=function(){this.content.remove(this.picChoosePlanPanel)},PicBusinessMarketingPlanPanel.prototype.setContentSize=function(t,i){var o=this.scaleWidth,r=this.scaleHeight,a=295*this.dpr,h=r-t-i,l=t+.5*h,c=.5*o;this.content.setPosition(c,l),this.content.setContentSize(a,h)},PicBusinessMarketingPlanPanel.prototype.OnCloseHandler=function(){this.emit("hide")},PicBusinessMarketingPlanPanel}(a.BasePanel);i.default=m},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessPlanPanel",(function(){return y}));var r,a=o(113),h=o(120),l=o(115),c=o(114),u=o(116),p=o(109),d=o(111),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicBusinessPlanPanel(i,o,r,a,h,l,c,u){var p=t.call(this,i,o,r)||this;return p.dpr=l,p.key=u,p.zoom=c,p.setSize(a,h),p.create(),p}return m(PicBusinessPlanPanel,t),PicBusinessPlanPanel.prototype.setWorld=function(t){this.world=t},PicBusinessPlanPanel.prototype.setPlanData=function(t){var i=t.marketPlanPairs,o=""!==t.industryBackground?t.industryBackground:"market_b";this.topbg.setFrame(o),this.describleText.text=t.industryDes,this.planBuffText.text=t.industryBuffDes,this.gridtable.setItems(i)},PicBusinessPlanPanel.prototype.setHandler=function(t,i){this.cancelHandler=t,this.addPlanHandler=i},PicBusinessPlanPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessPlanPanel.prototype.create=function(){var t=.5*-this.height,i=253*this.dpr,o=73*this.dpr;this.topbg=new p.NineSlicePatch(this.scene,0,0,i,o,this.key,"market_b",{left:6*this.dpr,top:0*this.dpr,right:6*this.dpr,bottom:0*this.dpr}),this.topbg.y=t+.5*o+10*this.dpr,this.add(this.topbg),this.describleText=this.scene.make.text({x:0,y:this.topbg.y-15*this.dpr,text:"Your store is now at a advantage",style:{fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#ffffff"}}).setOrigin(.5),this.describleText.setWordWrapWidth(200*this.dpr),this.add(this.describleText),this.planBuffText=new p.BBCodeText(this.scene,0,this.topbg.y+15*this.dpr,"Store prosperity -10%",{fontSize:13*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#ffffff"}).setOrigin(.5),this.add(this.planBuffText),this.planBuffText.setWrapWidth(200*this.dpr);var r=new p.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});r.x=0,r.y=this.topbg.y+.5*this.topbg.height+40*this.dpr,this.add(r);var h=this.scene.make.text({x:0,y:r.y,text:c.a.t("business_street.marketing_plan"),style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(h),r.resize(135*this.dpr,17*this.dpr);var u=this.width-24*this.dpr,d=this.height-200*this.dpr,m=r.y+.5*r.height+20*this.dpr+.5*d;this.gridtable=this.createGrideTable(0,m,u,d,253*this.dpr,63*this.dpr);var y=new p.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,l.UIAtlasKey.commonKey,"red_btn",c.a.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(y),y.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),y.on(String(p.ClickEvent.Tap),this.onCancelHandler,this)},PicBusinessPlanPanel.prototype.createGrideTable=function(t,i,o,r,a,l){var c=this,u={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:l,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom,cellPadX:8*this.dpr},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new g(c.scene,0,0,a,l,c.key,c.dpr,c.zoom)).setHandler(new h.a(c,c.onAddPlanHandler)),i.setData({item:o}),i.setPlanData(o,c.world.clock.unixTime),i}},d=new p.GameGridTable(this.scene,u);return d.layout(),d.on("cellTap",(function(t){t&&c.onGridSelectHandler(t)})),this.add(d),d},PicBusinessPlanPanel.prototype.onGridSelectHandler=function(t){},PicBusinessPlanPanel.prototype.onAddPlanHandler=function(t){this.addPlanHandler&&this.addPlanHandler.runWith(t.marketPlanType)},PicBusinessPlanPanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicBusinessPlanPanel}(Phaser.GameObjects.Container),g=function(t){function MarketingPlanItem(i,o,r,h,l,d,m,y){var g=t.call(this,i,o,r)||this;g.dpr=m,g.key=d,g.setSize(h,l),g.bg=new p.NineSlicePatch(g.scene,0,0,h,53*m,g.key,"no_plan_bg",{left:6*g.dpr,top:0*g.dpr,right:6*g.dpr,bottom:0*g.dpr}),g.add(g.bg);var _=g.scene.make.image({key:g.key,frame:"plan_icon_bg"});_.x=.5*-g.width+.5*_.width+5*m,g.add(_),g.planIcon=new u.DynamicImage(g.scene,0,0),g.planIcon.setPosition(_.x,0),g.add(g.planIcon),g.planText=g.scene.make.text({x:_.x+.5*_.width+10*m,y:0,style:{color:"#0",fontSize:10*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0,.5),g.planText.text=c.a.t("business_street.plan_title"),g.add(g.planText),g.planName=g.scene.make.text({x:_.x+.5*_.width+10*m,y:.5*-g.bg.height+4*m,text:"Plane Name",style:{color:"#ffffff",fontSize:12*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),g.add(g.planName),g.planAtt=new p.BBCodeText(g.scene,g.planName.x,g.planName.y+g.planName.height+4*m,"Competitiveness +10%,  Prosperity +10%",{color:"#0",fontSize:10*g.dpr,fontFamily:a.a.DEFULT_FONT}).setOrigin(0),g.add(g.planAtt);var v=159*m,b=8*m,P={x:0,y:0,color:"#ffffff",fontSize:9*m,fontFamily:a.a.DEFULT_FONT,halign:.5,valign:.5};return g.progress=new p.ProgressBar(g.scene,{x:5*m,y:g.planAtt.y+g.planAtt.height+4*m+.5*b,width:v,height:b,background:{x:0,y:0,width:v,height:b,config:{top:1*m,left:5*m,right:5*m,bottom:1*m},key:d,frame:"progress_bar_bg"},bar:{x:0,y:0,width:v,height:b-m,config:{top:1*m,left:5*m,right:5*m,bottom:1*m},key:d,frame:"progress_bar_g"},dpr:m,textConfig:P}),g.progress.text.setOrigin(.5),g.add(g.progress),g.addBtn=new p.Button(g.scene,g.key,"add_plan","add_plan"),g.addBtn.x=.5*g.width-.5*g.addBtn.width-20*m,g.addBtn.on(String(p.ClickEvent.Tap),g.onAddBtnHandler,g),g.add(g.addBtn),g}return m(MarketingPlanItem,t),MarketingPlanItem.prototype.setPlanData=function(t,i){var o=this;if(t.marketPlan){this.planName.visible=!0,this.planAtt.visible=!0,this.progress.visible=!0,this.planText.visible=!1,this.bg.setFrame("has_plan_bg"),this.remove(this.addBtn);var r="progress_bar_r",a=Math.floor(t.marketPlan.endTime-i/1e3),h=Math.floor(a/t.marketPlan.totalTime*100);h>30&&h<=50?r="progress_bar_y":h>50&&(r="progress_bar_g"),this.progress.bar.setFrame(r),this.progress.setProgress(a,t.marketPlan.totalTime),this.progress.setText(this.getDataFormat(1e3*a)),this.planName.text=t.marketPlan.name,this.planAtt.text=t.marketPlan.buffDes;var l=""!==t.marketPlan.icon?t.marketPlan.icon:t.marketPlan.requirements[0].display.texturePath;(""===l||!l)&&t.marketPlan.requirements&&t.marketPlan.requirements.length>0&&(l=t.marketPlan.requirements[0].display.texturePath);var c=d.i.getOsdRes(l);this.planIcon.load(c,this,(function(){o.planIcon.displayWidth=30*o.dpr,o.planIcon.scaleY=o.planIcon.scaleX}))}else this.planName.visible=!1,this.planAtt.visible=!1,this.progress.visible=!1,this.add(this.addBtn),this.bg.setFrame("no_plan_bg");this.planData=t},MarketingPlanItem.prototype.setHandler=function(t){this.addBtnHandler=t},MarketingPlanItem.prototype.onAddBtnHandler=function(){this.addBtnHandler&&this.addBtnHandler.runWith(this.planData)},MarketingPlanItem.prototype.getDataFormat=function(t){var i=Math.floor(t/864e5),o=Math.floor(t/36e5)%24,r=Math.floor(t/6e4)%60,a=Math.floor(t/1e3)%60,h="";return i>0?(h=i+"  "+c.a.t("business_street.day"),(o>0||r>0)&&(h+=this.stringFormat(o)+":"+this.stringFormat(r))):h=o>0?r>0?this.stringFormat(o)+":"+this.stringFormat(r):this.stringFormat(o)+" "+c.a.t("business_street.hour"):r>0?this.stringFormat(r)+" "+c.a.t("business_street.minute"):this.stringFormat(a)+" "+c.a.t("business_street.second"),h},MarketingPlanItem.prototype.stringFormat=function(t){var i=t+"";return i.length<=1&&(i="0"+i),i},MarketingPlanItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessHistoryPanel",(function(){return d}));var r,a=o(113),h=o(116),l=o(115),c=o(114),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicBusinessHistoryPanel(i,o,r,a,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.dpr=l,d.key=u,d.key2=p,d.zoom=c,d.setSize(a,h),d.create(),d}return p(PicBusinessHistoryPanel,t),PicBusinessHistoryPanel.prototype.setHistoryeData=function(t){this.gridtable.setItems(t),this.titleText.text=c.a.t("business_street.history_title",{name:t.length})},PicBusinessHistoryPanel.prototype.setHandler=function(t){this.backHandler=t},PicBusinessHistoryPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessHistoryPanel.prototype.create=function(){var t=.5*-this.height,i=.5*-this.width,o="bold "+13*this.dpr+"px "+a.a.BOLD_FONT,r=this.scene.make.text({x:i+30*this.dpr,y:t+6*this.dpr,text:c.a.t("business_street.history_title"),style:{font:o,bold:!0,color:"#FFC51A"}}).setOrigin(0,.5);r.setStroke("#553100",2*this.dpr),this.add(r),this.titleText=r;var h=this.width,p=this.height-80*this.dpr,d=t+33*this.dpr+.5*p;this.gridtable=this.createGrideTable(0,d,h,p,256*this.dpr,50*this.dpr);var m=new u.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,l.UIAtlasKey.commonKey,"red_btn",c.a.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(m),m.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),m.on(String(u.ClickEvent.Tap),this.onBackHandler,this)},PicBusinessHistoryPanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new m(l.scene,0,0,a,h,l.key,l.key2,l.dpr,l.zoom),p.add(i)),i.setData({item:o}),i.setStoreData(o),i}},p=new u.GameGridTable(this.scene,c);return p.layout(),this.add(p),p},PicBusinessHistoryPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicBusinessHistoryPanel}(Phaser.GameObjects.Container),m=function(t){function PicHistoryItem(i,o,r,l,c,p,d,m,y){var g=t.call(this,i,o,r)||this;g.dpr=m,g.key=p,g.key2=d,g.setSize(l,c);var _=.5*-g.width,v=.5*-g.height;g.bg=new u.NineSlicePatch(g.scene,0,0,l,45*m,g.key,"resturant_bg",{left:4*g.dpr,top:9*g.dpr,right:4*g.dpr,bottom:9*g.dpr}),g.add(g.bg);var b=g.scene.make.image({key:d,frame:"icon_bg_s"});b.setPosition(_+.5*b.width+3*m,0),g.add(b),g.storeIcon=new h.DynamicImage(g.scene,b.x,0),g.add(g.storeIcon);var P=b.x+.5*b.width+10*m;return g.storeName=g.scene.make.text({x:P,y:v+10*m,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),g.add(g.storeName),g.playerName=g.scene.make.text({x:P,y:g.storeName.y+.5*g.storeName.height+10*m,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),g.add(g.playerName),g.industryIcon=g.scene.make.image({key:g.key2,frame:"entertainment_tag_s"}),g.industryIcon.x=.5*g.width-.5*g.industryIcon.width,g.add(g.industryIcon),g}return p(PicHistoryItem,t),PicHistoryItem.prototype.setStoreData=function(t){this.storeData=t,this.bg.setTexture(this.key2,t.industry+"_bg"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.industryIcon.setFrame(t.industry+"_tag_s")},PicHistoryItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessMyStreetPanel",(function(){return m}));var r,a=o(113),h=o(120),l=o(116),c=o(115),u=o(114),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function PicBusinessMyStreetPanel(i,o,r,a,h,l,c,u){var p=t.call(this,i,o,r)||this;return p.isCanNewCreate=!1,p.dpr=l,p.key=u,p.zoom=c,p.setSize(a,h),p.create(),p}return d(PicBusinessMyStreetPanel,t),PicBusinessMyStreetPanel.prototype.setMyStoreData=function(t){var i=t.storeList;this.storelimitText.text=u.a.t("business_street.store_limit")+":"+i.length+"/"+t.storeLimit,this.gridtable.setItems(i),this.isCanNewCreate=i.length<t.storeLimit},PicBusinessMyStreetPanel.prototype.setHandler=function(t,i,o,r){this.takeAllHandler=t,this.goOutHandler=i,this.newStoreHandler=o,this.enterRoomHandler=r},PicBusinessMyStreetPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessMyStreetPanel.prototype.create=function(){var t=.5*-this.height,i=.5*-this.width,o=this.scene.make.image({key:this.key,frame:"store_icon"});o.x=i+30*this.dpr,o.y=t+6*this.dpr,this.add(o);var r="bold "+13*this.dpr+"px "+a.a.BOLD_FONT,h=o.x+.5*o.width+10*this.dpr,l=this.scene.make.text({x:h,y:o.y,text:u.a.t("business_street.my_store"),style:{font:r,bold:!0,color:"#FFC51A"}}).setOrigin(0,.5);l.setStroke("#553100",2*this.dpr),this.add(l);var d=this.width,m=this.height-68*this.dpr,y=t+28*this.dpr+.5*m;this.gridtable=this.createGrideTable(0,y,d,m,256*this.dpr,87*this.dpr),this.newStoreBtn=new p.Button(this.scene,this.key,"new_store","new_store");var g=-i-.5*this.newStoreBtn.width-20*this.dpr;this.newStoreBtn.setPosition(g,t+6*this.dpr),this.newStoreBtn.on(String(p.ClickEvent.Tap),this.onNewStoreHandler,this),this.add(this.newStoreBtn),this.storelimitText=this.scene.make.text({x:g-.5*this.newStoreBtn.width-10*this.dpr,y:t+5*this.dpr,text:"store limit",style:{color:"#0",fontSize:12*this.dpr,fontFamily:a.a.DEFULT_FONT}}).setOrigin(1,.5),this.add(this.storelimitText),this.storeCountText=this.scene.make.text({x:g+.5*this.newStoreBtn.width+20*this.dpr,y:t,text:"",style:{font:r,bold:!0,color:"#FFC51A"}}).setOrigin(1,0),this.add(this.storeCountText);var _=new p.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,c.UIAtlasKey.commonKey,"red_btn",u.a.t("business_street.takeall"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(_),_.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),_.on(String(p.ClickEvent.Tap),this.onTalkAllHandler,this);var v=new p.NineSliceButton(this.scene,60*this.dpr,_.y,92*this.dpr,34*this.dpr,c.UIAtlasKey.commonKey,"yellow_btn",u.a.t("business_street.goout"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(v),v.on(String(p.ClickEvent.Tap),this.onGoOutHandler,this),v.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#996600"})},PicBusinessMyStreetPanel.prototype.createGrideTable=function(t,i,o,r,a,l){var c=this,u={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:l,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&((i=new y(c.scene,0,0,a,l,c.key,c.dpr,c.zoom)).setHandler(new h.a(c,c.onEnterHandler)),d.add(i)),i.setData({item:o}),i.setStoreData(o),i}},d=new p.GameGridTable(this.scene,u);return d.layout(),this.add(d),d},PicBusinessMyStreetPanel.prototype.onEnterHandler=function(t){this.enterRoomHandler&&this.enterRoomHandler.runWith(t.roomId)},PicBusinessMyStreetPanel.prototype.onTalkAllHandler=function(){this.takeAllHandler&&this.takeAllHandler.run()},PicBusinessMyStreetPanel.prototype.onGoOutHandler=function(){this.goOutHandler&&this.goOutHandler.run()},PicBusinessMyStreetPanel.prototype.onNewStoreHandler=function(){this.isCanNewCreate&&this.newStoreHandler&&this.newStoreHandler.run()},PicBusinessMyStreetPanel}(Phaser.GameObjects.Container),y=function(t){function MyStoreItem(i,o,r,h,d,m,y,g){var _=t.call(this,i,o,r)||this;_.dpr=y,_.key=m,_.setSize(h,d);var v=.5*-_.width,b=.5*-_.height;_.bg=new p.NineSlicePatch(_.scene,0,0,h,80*y,_.key,"resturant_bg",{left:4*_.dpr,top:9*_.dpr,right:4*_.dpr,bottom:9*_.dpr}),_.add(_.bg);var P=_.scene.make.image({key:m,frame:"store_icon_bg"});P.setPosition(v+.5*P.width+10*y,0),_.add(P),_.storeIcon=new l.DynamicImage(_.scene,P.x,0),_.add(_.storeIcon);var w=P.x+.5*P.width+10*y;_.storeName=_.scene.make.text({x:w,y:b+5*y,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*y,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),_.add(_.storeName),_.lvimgCon=_.scene.make.container(void 0,!1),_.lvimgCon.height=14*y,_.lvimgCon.setPosition(w+6*y,_.storeName.y+_.storeName.height+.5*_.lvimgCon.height+2*y),_.add(_.lvimgCon),_.savings=_.scene.make.text({x:w,y:_.lvimgCon.y+.5*_.lvimgCon.height+2*y,text:"Savings: 13000",style:{color:"#ffffff",fontSize:10*y,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),_.add(_.savings),_.competitiveness=_.scene.make.text({x:w,y:_.savings.y+_.savings.height+2*y,text:"Competitiveness: 13000",style:{color:"#ffffff",fontSize:10*y,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),_.add(_.competitiveness),_.turnover=_.scene.make.text({x:w,y:_.competitiveness.y+_.competitiveness.height+2*y,text:"Prosperity: +13000 / Day",style:{color:"#ffffff",fontSize:10*y,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),_.add(_.turnover),_.industryIcon=_.scene.make.image({key:_.key,frame:"entertainment_tag"}),_.industryIcon.x=.5*_.width-.5*_.industryIcon.width,_.add(_.industryIcon);var S=new p.NineSliceButton(i,-v,0,48*y,27*y,c.UIAtlasKey.commonKey,"yellow_btn_normal_s",u.a.t("business_street.enter"),_.dpr,g,{left:10*_.dpr,top:10*_.dpr,right:10*_.dpr,bottom:10*_.dpr});return S.setTextStyle({fontSize:10*y,fontFamily:a.a.BOLD_FONT,color:"#996600"}),S.x=-v-.5*S.width-10*y,S.on(String(p.ClickEvent.Tap),_.onEnterHandler,_),_.add(S),_}return d(MyStoreItem,t),MyStoreItem.prototype.setStoreData=function(t){var i=t.industry,o=t.storeType;this.bg.setFrame(i+"_bg"),this.storeIcon.setTexture(this.key,o+"_icon"),this.storeName.text=t.name,this.lvimgCon.removeAll(!0),this.setImageInfo(c.UIAtlasKey.common2Key,this.getLevelImgs(t.roomLevel.level)),this.savings.text=u.a.t("business_street.savings")+":"+t.savings,this.competitiveness.text=u.a.t("business_street.competitiveness")+":"+t.competitiveness,this.turnover.text=u.a.t("business_street.turnover")+":"+t.turnover,this.industryIcon.setFrame(i+"_tag"),this.storeData=t},MyStoreItem.prototype.setHandler=function(t){this.enterHandler=t},MyStoreItem.prototype.setImageInfo=function(t,i){for(var o=0,r=15*this.dpr,a=0,h=i;a<h.length;a++){var l=h[a],c=this.scene.make.image({key:t,frame:l});c.x=o,o+=.5*c.width+r,this.lvimgCon.add(c)}},MyStoreItem.prototype.onEnterHandler=function(){this.enterHandler&&this.enterHandler.runWith(this.storeData)},MyStoreItem.prototype.getLevelImgs=function(t){t=t||0;for(var i=[],o=Math.floor(t/Math.pow(4,3)),r=t%Math.pow(4,3),a=Math.floor(r/Math.pow(4,2)),h=r%Math.pow(4,2),l=Math.floor(h/Math.pow(4,1)),c=h%Math.pow(4,1),u=0;u<o;u++)i.push("bear");for(u=0;u<a;u++)i.push("sun");for(u=0;u<l;u++)i.push("moon");for(u=0;u<c;u++)i.push("star");return 0===t&&i.push("star"),i},MyStoreItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessRankRewardPanel",(function(){return m}));var r,a=o(113),h=o(116),l=o(115),c=o(114),u=o(111),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function PicBusinessRankRewardPanel(i,o,r,a,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.dpr=l,d.key=u,d.key2=p,d.zoom=c,d.setSize(a,h),d.create(),d}return d(PicBusinessRankRewardPanel,t),PicBusinessRankRewardPanel.prototype.setRankRewardData=function(t){this.gridtable.setItems(t)},PicBusinessRankRewardPanel.prototype.setHandler=function(t){this.backHandler=t},PicBusinessRankRewardPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessRankRewardPanel.prototype.create=function(){var t=.5*-this.height,i=this.width-20*this.dpr,o=this.height-70*this.dpr,r=t+23*this.dpr+.5*o;this.gridtable=this.createGrideTable(-5*this.dpr,r,i,o,256*this.dpr,80*this.dpr);var h=new p.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,l.UIAtlasKey.commonKey,"red_btn",c.a.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(h),h.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),h.on(String(p.ClickEvent.Tap),this.onBackHandler,this)},PicBusinessRankRewardPanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new y(l.scene,0,0,a,h,l.key,l.key2,l.dpr,l.zoom),u.add(i)),i.setData({item:o}),i.setRankRewardData(o),i}},u=new p.GameGridTable(this.scene,c);return u.layout(),this.add(u),u},PicBusinessRankRewardPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicBusinessRankRewardPanel}(Phaser.GameObjects.Container),y=function(t){function PicRankRewardItem(i,o,r,h,l,c,u,p,d){var m=t.call(this,i,o,r)||this;m.rewardItems=[],m.dpr=p,m.zoom=d,m.key=c,m.key2=u,m.setSize(h,l);var y=m.scene.make.image({key:m.key2,frame:"reward_bg"});m.add(y),m.rankIcon=m.scene.make.image({key:u,frame:"1"}),m.rankIcon.x=.5*-h+.5*m.rankIcon.width+10*p,m.add(m.rankIcon);var g=m.rankIcon.x;return m.rankText=m.scene.make.text({x:g,y:0,text:"3",style:{color:"#0",bold:!0,fontSize:12*p,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5),m.add(m.rankText),m}return d(PicRankRewardItem,t),PicRankRewardItem.prototype.setRankRewardData=function(t){if(this.rewardData!==t){t.start===t.end?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.start+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,this.rankText.text=t.start+"~"+t.end);for(var i=0,o=this.rewardItems;i<o.length;i++){(a=o[i]).visible=!1}for(var r=0;r<t.rewards.length;r++){var a=void 0;r<this.rewardItems.length?a=this.rewardItems[r]:(a=new g(this.scene,0,0,50*this.dpr,50*this.dpr,this.key2,this.dpr,this.zoom),this.add(a),this.rewardItems.push(a)),a.visible=!0,a.setRewardData(t.rewards[r])}this.Sort(),this.rewardData=t}},PicRankRewardItem.prototype.Sort=function(){for(var t=10*this.dpr,i=-50*this.dpr,o=0,r=this.rewardItems;o<r.length;o++){var a=r[o];a.x=a.width*a.originX+i,i+=a.width+t}},PicRankRewardItem}(Phaser.GameObjects.Container),g=function(t){function RewardItem(i,o,r,l,c,u,p,d){var m=t.call(this,i,o,r)||this;m.dpr=p,m.key2=u,m.setSize(l,c);var y=m.scene.make.image({key:m.key2,frame:"icon_bg_m"});return m.add(y),m.itemIcon=new h.DynamicImage(m.scene,0,0),m.add(m.itemIcon),m.countText=m.scene.make.text({x:.5*y.width,y:.5*y.height,text:"4~10",style:{color:"#0",fontSize:12*p,fontFamily:a.a.DEFULT_FONT}}).setOrigin(1,.5),m.add(m.countText),m}return d(RewardItem,t),RewardItem.prototype.setRewardData=function(t){var i=this,o=u.i.getOsdRes(t.display.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.displayWidth=43*i.dpr,i.itemIcon.scaleY=i.itemIcon.scaleX})),this.countText.text=t.count+""},RewardItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessRankingDetailPanel",(function(){return d}));var r,a=o(113),h=o(116),l=o(115),c=o(114),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicBusinessRankingDetailPanel(i,o,r,a,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.dpr=l,d.key=u,d.key2=p,d.zoom=c,d.setSize(a,h),d.create(),d}return p(PicBusinessRankingDetailPanel,t),PicBusinessRankingDetailPanel.prototype.setRankingDetailData=function(t){this.content=t;var i=t.stores;if(this.gridtable.setItems(i),t.playerStore){this.myRankItem.visible=!0,this.myitembg.visible=!0,this.myRankItem.setDetailData(t.playerStore);var o=.5*-this.height,r=this.width,a=this.height-125*this.dpr,h=o+30*this.dpr+.5*a;this.gridtable.y=h,this.gridtable.setSize(r,a)}else{this.myitembg.visible=!1,this.myRankItem.visible=!1;o=.5*-this.height,r=this.width,a=this.height-100*this.dpr,h=o+30*this.dpr+.5*a;this.gridtable.y=h,this.gridtable.setSize(r,a)}},PicBusinessRankingDetailPanel.prototype.setHandler=function(t,i){this.backHandler=t,this.rankRewardHandler=i},PicBusinessRankingDetailPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessRankingDetailPanel.prototype.create=function(){var t=.5*-this.height,i=.5*-this.width,o="bold "+13*this.dpr+"px "+a.a.BOLD_FONT;this.timeText=this.scene.make.text({x:0,y:t+6*this.dpr,text:c.a.t("6 DAY 23:24:16"),style:{font:o,bold:!0,color:"#D9270F"}}).setOrigin(.5),this.timeText.setStroke("#553100",2*this.dpr),this.add(this.timeText),this.timeText.visible=!1;var r=new u.NineSliceButton(this.scene,0,this.timeText.y,60*this.dpr,26*this.dpr,l.UIAtlasKey.commonKey,"yellow_btn_normal_s",c.a.t("business_street.rank_reward"),this.dpr,this.zoom,{left:10*this.dpr,top:6*this.dpr,right:10*this.dpr,bottom:6*this.dpr});r.x=-i-.5*r.width-30*this.dpr,r.setTextStyle({fontSize:10*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#996600"}),r.on(String(u.ClickEvent.Tap),this.onRankRewardHandler,this),this.add(r);var h=this.width,p=this.height-125*this.dpr,d=t+30*this.dpr+.5*p;this.gridtable=this.createGrideTable(0,d,h,p,256*this.dpr,50*this.dpr),this.myitembg=this.scene.make.image({key:this.key2,frame:"my_rank_bg"}),this.myitembg.y=d+.5*p+.5*this.myitembg.height-3*this.dpr,this.add(this.myitembg),this.myRankItem=new m(this.scene,0,this.myitembg.y+5*this.dpr,256*this.dpr,50*this.dpr,this.key,this.key2,this.dpr,this.zoom),this.add(this.myRankItem);var y=new u.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,l.UIAtlasKey.commonKey,"red_btn",c.a.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(y),y.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),y.on(String(u.ClickEvent.Tap),this.onBackHandler,this)},PicBusinessRankingDetailPanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new m(l.scene,0,0,a,h,l.key,l.key2,l.dpr,l.zoom),p.add(i)),i.setData({item:o}),i.setDetailData(o),i}},p=new u.GameGridTable(this.scene,c);return p.layout(),this.add(p),p},PicBusinessRankingDetailPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.content=void 0},PicBusinessRankingDetailPanel.prototype.onRankRewardHandler=function(){this.rankRewardHandler&&this.content&&this.rankRewardHandler.runWith([this.content.key,this.content.type])},PicBusinessRankingDetailPanel}(Phaser.GameObjects.Container),m=function(t){function PicRankingDetailItem(i,o,r,l,c,p,d,m,y){var g=t.call(this,i,o,r)||this;g.dpr=m,g.key=p,g.key2=d,g.setSize(l,c);var _=.5*-g.width,v=.5*-g.height;g.bg=new u.NineSlicePatch(g.scene,0,0,l,45*m,g.key,"restaurant_bg",{left:4*g.dpr,top:9*g.dpr,right:4*g.dpr,bottom:9*g.dpr}),g.add(g.bg);var b=g.scene.make.image({key:d,frame:"icon_bg_s"});b.setPosition(_+.5*b.width+3*m,0),g.add(b),g.storeIcon=new h.DynamicImage(g.scene,b.x,0),g.add(g.storeIcon);var P=b.x+.5*b.width+10*m;return g.storeName=g.scene.make.text({x:P,y:v+10*m,text:"Restaurant",style:{color:"#FFE11A",fontSize:12*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),g.add(g.storeName),g.playerName=g.scene.make.text({x:P,y:g.storeName.y+.5*g.storeName.height+10*m,text:"Savings: 13000",style:{color:"#ffffff",fontSize:11*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0),g.add(g.playerName),g.industryIcon=g.scene.make.image({key:g.key2,frame:"restaurant_tag_s"}),g.industryIcon.x=.5*g.width-.5*g.industryIcon.width,g.add(g.industryIcon),g.rankIcon=g.scene.make.image({key:d,frame:"1"}),g.rankIcon.x=-_-80*m,g.add(g.rankIcon),g.rankText=g.scene.make.text({x:P,y:0,text:"Restaurant",style:{color:"#ffffff",bold:!0,fontSize:18*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5),g.rankText.x=g.rankIcon.x,g.add(g.rankText),g.praiseCount=g.scene.make.text({x:g.rankIcon.x+.5*g.rankIcon.width+10*m,y:g.rankIcon.y,text:"66666666",style:{color:"#ffffff",fontSize:12*m,fontFamily:a.a.DEFULT_FONT}}).setOrigin(0,.5),g.add(g.praiseCount),g}return p(PicRankingDetailItem,t),PicRankingDetailItem.prototype.setDetailData=function(t){this.detailData=t,this.storeName.text=t.name,this.playerName.text=t.ownerName,t.index<4&&t.index>0?(this.rankIcon.visible=!0,this.rankText.visible=!1,this.rankIcon.setFrame(t.index+"")):(this.rankIcon.visible=!1,this.rankText.visible=!0,t.index<=0?this.rankText.text=c.a.t("business_street.onrank"):this.rankText.text=t.index+""),this.praiseCount.text=t.value+"",this.storeIcon.setTexture(this.key2,t.storeType+"_icon_s"),this.bg.setFrame(t.industryType+"_bg"),this.industryIcon.setFrame(t.industryType+"_tag_s")},PicRankingDetailItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessRankingPanel",(function(){return p}));var r,a=o(113),h=o(115),l=o(114),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicBusinessRankingPanel(i,o,r,a,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.boundOffset=85,d.dpr=l,d.key=u,d.key2=p,d.zoom=c,d.setSize(a,h),d.create(),d}return u(PicBusinessRankingPanel,t),PicBusinessRankingPanel.prototype.create=function(){var t=this,i=.5*-this.height,o=(this.width,"bold "+18*this.dpr+"px "+a.a.BOLD_FONT),r=this.scene.make.text({x:0,y:i+20*this.dpr,text:l.a.t("business_street.ranking_list"),style:{font:o,bold:!0,color:"#FFC51A"}}).setOrigin(.5);r.setStroke("#553100",2*this.dpr),this.add(r),this.titleText=r;var u=this.scene.make.image({x:0,y:r.y+.5*r.height+10*this.dpr,key:this.key2,frame:"title"});this.add(u);var p=this.width-28*this.dpr,d=this.height-80*this.dpr;this.dpr;this.gameScroll=new c.GameScroller(this.scene,{x:0,y:0,width:p,height:d,zoom:this.zoom,dpr:this.dpr,align:2,orientation:1,space:20*this.dpr,valuechangeCallback:function(i){t.onScrollValueChange(i)},cellupCallBack:function(i){t.onScrollClickHandler(i)}}),this.add(this.gameScroll);var m=new c.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,h.UIAtlasKey.commonKey,"red_btn",l.a.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(m),m.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),m.on(String(c.ClickEvent.Tap),this.onBackHandler,this)},PicBusinessRankingPanel.prototype.setRankingData=function(t){var i=this.scene.make.container(void 0,!1);this.boundOffset=35*this.dpr,i.setSize(this.boundOffset,185*this.dpr),this.gameScroll.clearItems(),this.gameScroll.addItem(i);for(var o=0,r=t;o<r.length;o++){var a=r[o],h=new d(this.scene,0,0,133*this.dpr,185*this.dpr,this.key,this.key2,this.dpr,this.zoom);h.setRankData(a),this.gameScroll.addItem(h)}var l=this.scene.make.container(void 0,!1);l.setSize(this.boundOffset,185*this.dpr),this.gameScroll.addItem(l),this.gameScroll.Sort(),this.gameScroll.refreshMask(),this.gameScroll.setValue(this.gameScroll.bounds[1])},PicBusinessRankingPanel.prototype.setHandler=function(t,i){this.backHandler=t,this.rankHandler=i},PicBusinessRankingPanel.prototype.resetMask=function(){this.gameScroll.refreshMask()},PicBusinessRankingPanel.prototype.show=function(){this.addListen(),this.visible=!0},PicBusinessRankingPanel.prototype.hide=function(){this.removeListen()},PicBusinessRankingPanel.prototype.onScrollValueChange=function(t){if(this.gameScroll){for(var i=133*this.dpr,o=.25*(this.gameScroll.width-i),r=0,a=this.gameScroll.getItemList();r<a.length;r++){var h=a[r],l=Math.abs(h.getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx)-.25*i;l<0&&(l=0);var c=1-Math.abs(l)/o;h instanceof d&&h.setRadio(c)}this.gameScroll.Sort(!0,!1)}},PicBusinessRankingPanel.prototype.onScrollUpHandler=function(){var t=this;if(this.gameScroll){var i=this.gameScroll.getValue(),o=this.gameScroll.bounds[1]-i,r=Math.floor((o+66*this.dpr)/(133*this.dpr+20*this.dpr)),a=this.gameScroll.getItemList().length;if(r>=0&&r<a-1){var h=this.gameScroll.getItemAt(r+1).getWorldTransformMatrix().tx-this.getWorldTransformMatrix().tx;if((h*=this.scale)<0){var l=Math.abs(h)+i;this.timerID=setInterval((function(){i+=10*t.dpr,t.gameScroll.setValue(i),i>=l&&(t.gameScroll.setValue(l),clearInterval(t.timerID),t.timerID=void 0)}),20)}else{var c=i-Math.abs(h);this.timerID=setInterval((function(){i-=10*t.dpr,t.gameScroll.setValue(i),i<=c&&(t.gameScroll.setValue(c),clearInterval(t.timerID),t.timerID=void 0)}),20)}}this.gameScroll.Sort(!0,!1)}},PicBusinessRankingPanel.prototype.onScrollClickHandler=function(t){if(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.rankHandler){var i=t.rankData;this.rankHandler.runWith([i.key,i.type])}},PicBusinessRankingPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run(),this.gameScroll.clearItems()},PicBusinessRankingPanel.prototype.addListen=function(){this.scene&&(this.removeListen(),this.scene.input.on("pointerdown",this.pointerDownHandler,this),this.scene.input.on("pointerup",this.pointerUpHandler,this))},PicBusinessRankingPanel.prototype.removeListen=function(){this.scene&&(this.scene.input.off("pointerdown",this.pointerDownHandler,this),this.scene.input.off("pointerup",this.pointerUpHandler,this))},PicBusinessRankingPanel.prototype.pointerDownHandler=function(t){this.checkPointerInBounds(this.gameScroll,t)&&(this.timerID&&(clearInterval(this.timerID),this.timerID=void 0),this.moveTimerID&&(clearInterval(this.moveTimerID),this.moveTimerID=void 0))},PicBusinessRankingPanel.prototype.pointerUpHandler=function(t){var i=this;this.checkPointerInBounds(this.gameScroll,t)&&setTimeout((function(){i.gameScroll.isSliding?i.moveTimerID=setInterval((function(){i.gameScroll.isSliding||(i.onScrollUpHandler(),clearInterval(i.moveTimerID),i.moveTimerID=void 0)}),20):i.onScrollUpHandler()}),20)},PicBusinessRankingPanel.prototype.checkPointerInBounds=function(t,i){if(this.mRectangle||(this.mRectangle=new Phaser.Geom.Rectangle(0,0,0,0)),this.mRectangle.left=-t.width/2,this.mRectangle.right=t.width/2,this.mRectangle.top=-t.height/2,this.mRectangle.bottom=t.height/2,i){var o=t.getWorldTransformMatrix(),r=i.x-o.tx,a=i.y-o.ty;return this.mRectangle.left<=r&&this.mRectangle.right>=r&&this.mRectangle.top<=a&&this.mRectangle.bottom>=a}return!1},PicBusinessRankingPanel}(Phaser.GameObjects.Container),d=function(t){function PicRankingItem(i,o,r,h,l,u,p,d,m){var y=t.call(this,i,o,r)||this;y.radio=0,y.imgtype=1,y.dpr=d,y.key=u,y.key2=p,y.setSize(h,l);y.width;var g=.5*-y.height;return y.bg=y.scene.make.image({key:y.key2,frame:"restaurant_rank_bg_s"}),y.add(y.bg),y.titleText=y.scene.make.text({x:0,y:g,text:"Restaurant",style:{color:"#0555AF",fontSize:14*d,fontFamily:a.a.BOLD_FONT}}).setOrigin(.5),y.add(y.titleText),y.storebg=new c.NineSlicePatch(y.scene,0,0,72*d,17*d,y.key2,"store_name_bg_s",{left:8*y.dpr,top:0*y.dpr,right:8*y.dpr,bottom:0*y.dpr}),y.storebg.y=y.titleText.y+10*d,y.add(y.storebg),y.storeName=y.scene.make.text({x:0,y:y.storebg.y,text:"Restaurant",style:{color:"#0",fontSize:12*d,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5),y.add(y.storeName),y.storeIcon=y.scene.make.image({key:y.key2,frame:"restaurant_rank_icon_s"}),y.storeIcon.y=-g-.5*y.storeIcon.height-5*d,y.add(y.storeIcon),y}return u(PicRankingItem,t),PicRankingItem.prototype.setRankData=function(t){this.rankData=t,this.titleText.text=t.name,this.storeName.text=t.champion,this.switchImage(1)},PicRankingItem.prototype.setRadio=function(t){var i=1;t>1&&(t=1),t>0&&(i=2),this.imgtype!==i&&(this.switchImage(i),this.imgtype=i),this.scale=2===i?1/this.radio+t*(1-1/this.radio):1,this.width=this.bg.displayWidth*this.scale,this.height=this.bg.displayHeight*this.scale},PicRankingItem.prototype.switchImage=function(t){var i,o,r,a,h,l,c,u,p=this.rankData.type,d=133*this.dpr,m=133*this.dpr;1===t?(i=p+"_rank_bg_s",o=14*this.dpr,r="store_name_bg_s",a=72*this.dpr,h=14*this.dpr,l=10*this.dpr,c=p+"_rank_icon_s",m=133*this.dpr,this.storebg.setConfig({left:8*this.dpr,top:0*this.dpr,right:8*this.dpr,bottom:0*this.dpr})):(i=p+"_rank_bg_m",o=18*this.dpr,r="store_name_bg_m",a=88*this.dpr,h=17*this.dpr,l=12*this.dpr,c=p+"_rank_icon_m",m=163*this.dpr,this.storebg.setConfig({left:11*this.dpr,top:0*this.dpr,right:11*this.dpr,bottom:0*this.dpr})),u=m/d,this.radio=u,this.bg.setFrame(i),this.titleText.setFontSize(o),this.storebg.setFrame(r),this.storebg.resize(a,h),this.storeName.setFontSize(l),this.storeIcon.setFrame(c),this.setSize(this.bg.width,this.bg.height),this.titleText.y=.5*-this.height+.5*this.titleText.height+10*this.dpr*u,this.storebg.y=this.titleText.y+.5*this.titleText.height+10*this.dpr*u,this.storeName.y=this.storebg.y,this.storeIcon.y=.5*this.height-.5*this.storeIcon.height-10*this.dpr*u},PicRankingItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessStoreCreatePanel",(function(){return m}));var r,a=o(113),h=o(115),l=o(114),c=o(111),u=o(2),p=o(109),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),m=function(t){function PicBusinessStoreCreatePanel(i,o,r,a,h,l,c,u,p){void 0===p&&(p=!0);var d=t.call(this,i,o,r)||this;return d.isFirst=!0,d.dpr=l,d.key=u,d.zoom=c,d.setSize(a,h),d.isFirst=p,d.create(),d}return d(PicBusinessStoreCreatePanel,t),PicBusinessStoreCreatePanel.prototype.setTypeData=function(t){t instanceof Array?this.gridtable.setItems(t):this.gridtable.setItems(t.roomModels);var i=this.gridtable.getCells()[0];i&&i.container&&this.onGridSelectHandler(i.container),this.gridtable.setT(0)},PicBusinessStoreCreatePanel.prototype.setTypeInfo=function(t){if(this.curSelectData=t,t instanceof u.op_pkt_def.PKT_INDUSTRY)this.recommendedText.text=t.state,this.describleText.text=t.des,this.turnoverText.setText(t.buffDes);else{var i=t;i.price&&(this.coinImg.setFrame(c.f.getIcon(i.price.coinType)),this.coinCount.text=i.price.price+""),this.describleText2.text=i.des}},PicBusinessStoreCreatePanel.prototype.setHandler=function(t,i){this.cancelHandler=t,this.selectHandler=i},PicBusinessStoreCreatePanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessStoreCreatePanel.prototype.create=function(){var t=.5*-this.height,i=new p.NineSlicePatch(this.scene,0,0,135*this.dpr,17*this.dpr,this.key,"subtitle",{left:13*this.dpr,top:0*this.dpr,right:13*this.dpr,bottom:0*this.dpr});i.x=0,i.y=t+10*this.dpr,this.add(i);var o=this.scene.make.text({x:0,y:i.y,text:l.a.t("business_street.choosetheindustry"),style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(.5);this.add(o);var r=this.width-24*this.dpr,c=100*this.dpr,u=-50*this.dpr;if(this.gridtable=this.createGrideTable(0,u,r,c,90*this.dpr,100*this.dpr),this.isFirst){var d="bold "+13*this.dpr+"px "+a.a.BOLD_FONT;this.recommendedText=this.scene.make.text({x:0,y:20*this.dpr,text:"Recommended",style:{font:d,bold:!0,color:"#697AFF"}}).setOrigin(.5,0),this.add(this.recommendedText),this.describleText=this.scene.make.text({x:0,y:this.recommendedText.y+this.recommendedText.height+10*this.dpr,text:"This industry has great development potential.",style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(.5,0),this.add(this.describleText),this.turnoverText=new p.BBCodeText(this.scene,0,this.describleText.y+this.describleText.height+10*this.dpr).setOrigin(.5,0).setFontSize(11*this.dpr).setFontFamily(a.a.DEFULT_FONT).setColor("#0"),this.add(this.turnoverText),o.text=l.a.t("business_street.choosetheindustry"),i.resize(135*this.dpr,17*this.dpr)}else this.coinBg=this.scene.make.image({key:h.UIAtlasKey.commonKey,frame:"price_bg"}),this.coinBg.y=30*this.dpr,this.add(this.coinBg),this.coinImg=this.scene.make.image({key:h.UIAtlasKey.commonKey,frame:"iv_coin"}),this.coinImg.setPosition(this.coinBg.x-.5*this.coinImg.width-15*this.dpr,this.coinBg.y),this.add(this.coinImg),this.coinCount=this.scene.make.text({x:this.coinImg.x+.5*this.coinImg.width+10*this.dpr,y:this.coinImg.y,text:"0",style:{fontSize:11*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0"}}).setOrigin(0,.5),this.add(this.coinCount),this.describleText2=this.scene.make.text({x:0,y:this.coinCount.y+50*this.dpr,text:"55225sadffqwerqwerqwer",style:{fontSize:10*this.dpr,fontFamily:a.a.DEFULT_FONT,color:"#0",wordWrap:{width:244*this.dpr,useAdvancedWrap:!0}}}).setOrigin(.5),this.add(this.describleText2),o.text=l.a.t("business_street.choosestorelike"),i.resize(155*this.dpr,17*this.dpr);var m=new p.NineSliceButton(this.scene,-60*this.dpr,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,h.UIAtlasKey.commonKey,"red_btn",l.a.t("common.cancel"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(m),m.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#ffffff"}),m.on(String(p.ClickEvent.Tap),this.onCancelHandler,this);var y=new p.NineSliceButton(this.scene,60*this.dpr,m.y,92*this.dpr,34*this.dpr,h.UIAtlasKey.commonKey,"yellow_btn",l.a.t("business_street.select"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(y),y.on(String(p.ClickEvent.Tap),this.onSelectHandler,this),y.setTextStyle({fontSize:15*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#996600"})},PicBusinessStoreCreatePanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOY:5*this.dpr,zoom:this.zoom},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new y(l.scene,0,0,a,h,l.key,l.dpr,l.zoom)),i.setData({item:o}),i.setStoreData(o),l.curSelectData&&o===l.curSelectData?i.select=!0:i.select=!1,i}},u=new p.GameGridTable(this.scene,c);return u.layout(),u.on("cellTap",(function(t){t&&l.onGridSelectHandler(t)})),this.add(u),u},PicBusinessStoreCreatePanel.prototype.onGridSelectHandler=function(t){this.setTypeInfo(t.storeData),this.curSelectItem&&(this.curSelectItem.select=!1),t.select=!0,this.curSelectItem=t},PicBusinessStoreCreatePanel.prototype.onCancelHandler=function(){this.cancelHandler&&this.cancelHandler.run()},PicBusinessStoreCreatePanel.prototype.onSelectHandler=function(){this.selectHandler&&this.selectHandler.runWith(this.curSelectData)},PicBusinessStoreCreatePanel}(Phaser.GameObjects.Container),y=function(t){function StoreTypeItem(i,o,r,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.isSelect=!1,d.dpr=u,d.key=c,d.setSize(h,l),d.bg=d.scene.make.image({key:c,frame:"store_bg"}),d.add(d.bg),d.storeIcon=d.scene.make.image({key:c,frame:"restaurant_icon"}),d.storeIcon.setPosition(0,-8*u),d.add(d.storeIcon),d.storeName=d.scene.make.text({x:0,y:d.storeIcon.y+.5*d.storeIcon.height+10*u,text:"Restaurant",style:{color:"#0",fontSize:10*u,fontFamily:a.a.DEFULT_FONT}}).setOrigin(.5),d.add(d.storeName),d}return d(StoreTypeItem,t),StoreTypeItem.prototype.setStoreData=function(t){if(this.storeData=t,t instanceof u.op_pkt_def.PKT_INDUSTRY)this.storeIcon.setFrame(t.industryType+"_icon"),this.storeName.text=t.name;else{var i=t;this.storeIcon.setFrame(i.storeType+"_icon"),this.storeName.text=i.name}},Object.defineProperty(StoreTypeItem.prototype,"select",{get:function(){return this.isSelect},set:function(t){this.isSelect=t;var i=t?"store_bg_click":"store_bg";this.bg.setFrame(i)},enumerable:!1,configurable:!0}),StoreTypeItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessStreet",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicBusinessStreet(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicBusinessStreet,t),PicBusinessStreet.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_MY_STORE,this.onMyStoreList),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_COMMERCIAL_STREET,this.onCOMMERCIAL_STREET),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_INDUSTRY_MODELS,this.onINDUSTRY_MODELS),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_STORE_RANKING_LIST,this.onSTORE_RANKING_LIST),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_STORE_RANKING_DETAIL,this.onSTORE_RANKING_DETAIL),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_STORE_RANKING_REWARD,this.onSTORE_RANKING_REWARD),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_STORE_ENTER_HISTORY,this.onSTORE_ENTER_HISTORY))},PicBusinessStreet.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicBusinessStreet.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicBusinessStreet.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicBusinessStreet.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicBusinessStreet.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicBusinessStreet.prototype.query_My_STORE=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_MY_STORE);this.connection.send(t)},PicBusinessStreet.prototype.query_TAKE_ALL_STORE_SAVINGS=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_TAKE_ALL_STORE_SAVINGS);this.connection.send(t)},PicBusinessStreet.prototype.query_COMMERCIAL_STREET=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_COMMERCIAL_STREET),r=o.content;r.sortedBy=t,r.storeType=i,this.connection.send(o)},PicBusinessStreet.prototype.query_INDUSTRY_MODELS=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_INDUSTRY_MODELS);this.connection.send(t)},PicBusinessStreet.prototype.query_CREATE_STORE=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CREATE_STORE);i.content.modelId=t,this.connection.send(i)},PicBusinessStreet.prototype.query_ENTER_ROOM=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER_ROOM),r=o.content;r.roomId=t,r.password=i,this.connection.send(o)},PicBusinessStreet.prototype.query_RANKING_LIST=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_STORE_RANKING_LIST);this.connection.send(t)},PicBusinessStreet.prototype.query_STORE_RANKING_DETAIL=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_STORE_RANKING_DETAIL),r=o.content;r.key=t,r.type=i,this.connection.send(o)},PicBusinessStreet.prototype.query_STORE_RANKING_REWARD=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_STORE_RANKING_REWARD),r=o.content;r.key=t,r.type=i,this.connection.send(o)},PicBusinessStreet.prototype.query_STORE_ENTER_HISTORY=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_STORE_ENTER_HISTORY);this.connection.send(t)},PicBusinessStreet.prototype.onMyStoreList=function(t){var i=t.content;this.mEvent.emit("onmystore",i)},PicBusinessStreet.prototype.onCOMMERCIAL_STREET=function(t){var i=t.content;this.mEvent.emit("onstreet",i)},PicBusinessStreet.prototype.onINDUSTRY_MODELS=function(t){var i=t.content;this.mEvent.emit("onmodels",i)},PicBusinessStreet.prototype.onSTORE_RANKING_LIST=function(t){var i=t.content;this.mEvent.emit("onranklist",i)},PicBusinessStreet.prototype.onSTORE_RANKING_DETAIL=function(t){var i=t.content;this.mEvent.emit("onrankdetail",i)},PicBusinessStreet.prototype.onSTORE_RANKING_REWARD=function(t){var i=t.content;this.mEvent.emit("onrankreward",i)},PicBusinessStreet.prototype.onSTORE_ENTER_HISTORY=function(t){var i=t.content;this.mEvent.emit("onenterhistory",i)},PicBusinessStreet}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessStreetListPanel",(function(){return _}));var r,a,h=o(113),l=o(120),c=o(116),u=o(115),p=o(114),d=o(292),m=o(150),y=o(109),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function PicBusinessStreetListPanel(i,o,r,h,l,c,u,p,d){var m=t.call(this,i,o,r)||this;return m.curCategoryType=a.popularity,m.dpr=c,m.key=p,m.key2=d,m.zoom=u,m.setSize(h,l),m.create(),m}return g(PicBusinessStreetListPanel,t),PicBusinessStreetListPanel.prototype.setIndustryModels=function(t){for(var i=[{text:p.a.t("business_street.popularity"),data:{categoryType:a.popularity}},{text:p.a.t("business_street.praise"),data:{categoryType:a.praise}}],o=[],r=0,l=t.industry;r<l.length;r++)for(var c=0,u=l[r].roomModels;c<u.length;c++){var d=u[c];-1===o.indexOf(d.storeType)&&o.push({type:d.storeType,name:d.name})}this.secondaryPanel.setCategories(y.TabButton,i,{width:88*this.dpr,height:27*this.dpr,key:this.key2,normalFrame:"navigation_bar_click",downFrame:"navigation_bar_click",textStyle:{fontSize:14*this.dpr,fontFamily:h.a.DEFULT_FONT,color:"#ffffff"}}),this.secondaryPanel.setSubItems(o)},PicBusinessStreetListPanel.prototype.setStreetListData=function(t){this.gridtable.setT(0),this.gridtable.setItems(t)},PicBusinessStreetListPanel.prototype.setHandler=function(t,i,o,r,a){this.historyHandler=t,this.rankHandler=i,this.backHandler=o,this.queryHandler=r,this.enterHandler=a},PicBusinessStreetListPanel.prototype.resetMask=function(){this.gridtable.resetMask()},PicBusinessStreetListPanel.prototype.create=function(){var t=this,i=.5*-this.height,o=.5*-this.width,r=this.scene.make.image({key:this.key,frame:"store_icon"});r.x=o+30*this.dpr,r.y=i+6*this.dpr,this.add(r);var a="bold "+13*this.dpr+"px "+h.a.BOLD_FONT,c=r.x+.5*r.width+10*this.dpr,g=this.scene.make.text({x:c,y:r.y,text:p.a.t("business_street.street"),style:{font:a,bold:!0,color:"#FFC51A"}}).setOrigin(0,.5);g.setStroke("#553100",2*this.dpr),this.add(g),this.secondaryPanel=new d.SecondaryMenuPanel(this.scene,0,i+56*this.dpr,this.width,60*this.dpr,this.dpr,this.zoom,{x:0,y:-15*this.dpr,width:this.width-30*this.dpr,height:30*this.dpr,zoom:this.zoom,dpr:this.dpr,orientation:1}),this.add(this.secondaryPanel);var _=this.scene.make.image({key:this.key2,frame:"navigation_bar"});this.secondaryPanel.gameScroll.addAt(_),this.secondaryPanel.createGrideTable(0,13*this.dpr,this.width-30*this.dpr,40*this.dpr,65*this.dpr,40*this.dpr,(function(i,o){var r=i.item;return o||(o=new m.TextButton(t.scene,t.dpr,t.zoom)).setFontSize(13*t.dpr),o.getData("itemData")!==r&&(o.setText(r.name),o.setData("itemData",r),t.subCategory===r.type?o.changeDown():o.changeNormal()),o})),this.secondaryPanel.setHandler(new l.a(this,this.onCategoryHandler),new l.a(this,this.onSubCategoryHandle));var v=this.scene.make.image({key:this.key2,frame:"navigation_bar_2"});this.secondaryPanel.gridTable.addAt(v);var b=this.width,P=this.height-130*this.dpr,w=i+88*this.dpr+.5*P;this.gridtable=this.createGrideTable(0,w,b,P,256*this.dpr,50*this.dpr);var S=new y.Button(this.scene,this.key2,"ranking","ranking"),C=-o-.5*S.width-20*this.dpr;S.setPosition(C,i+6*this.dpr),S.on(String(y.ClickEvent.Tap),this.onRankHandler,this),this.add(S);var T=new y.Button(this.scene,this.key2,"history","history");T.setPosition(C-.5*S.width-.5*T.width-10*this.dpr,i+6*this.dpr),T.on(String(y.ClickEvent.Tap),this.onHistoryHandler,this),this.add(T);var k=new y.NineSliceButton(this.scene,0,.5*this.height-7*this.dpr,92*this.dpr,34*this.dpr,u.UIAtlasKey.commonKey,"red_btn",p.a.t("business_street.back"),this.dpr,this.zoom,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr});this.add(k),k.setTextStyle({fontSize:15*this.dpr,fontFamily:h.a.BOLD_FONT,color:"#ffffff"}),k.on(String(y.ClickEvent.Tap),this.onBackHandler,this)},PicBusinessStreetListPanel.prototype.createGrideTable=function(t,i,o,r,a,h){var l=this,c={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:a,cellHeight:h,reuseCellContainer:!0,tableOX:19*this.dpr,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,i){t.scene;var o=t.item;return null===i&&(i=new v(l.scene,0,0,a,h,l.key,l.key2,l.dpr,l.zoom),u.add(i)),i.setData({item:o}),i.setStoreData(o,l.curCategoryType),i}},u=new y.GameGridTable(this.scene,c);return u.on("cellTap",(function(t){t&&l.onSelectItemHandler(t)})),u.layout(),this.add(u),u},PicBusinessStreetListPanel.prototype.onCategoryHandler=function(t){if(this.curCategoryType=t.categoryType,void 0!==this.subCategory){var i=this.curCategoryType===a.popularity?"popularity":"praise";this.queryHandler.runWith([i,this.subCategory])}},PicBusinessStreetListPanel.prototype.onSubCategoryHandle=function(t){var i=t.getData("itemData");this.curSubCategoryItem&&this.curSubCategoryItem.changeNormal(),t.changeDown(),this.curSubCategoryItem=t,this.subCategory=i.type;var o=this.curCategoryType===a.popularity?"popularity":"praise";this.queryHandler&&this.queryHandler.runWith([o,this.subCategory])},PicBusinessStreetListPanel.prototype.onSelectItemHandler=function(t){var i=t.storeData;this.enterHandler&&this.enterHandler.runWith(i.roomId)},PicBusinessStreetListPanel.prototype.onHistoryHandler=function(){this.historyHandler&&this.historyHandler.run()},PicBusinessStreetListPanel.prototype.onRankHandler=function(){this.rankHandler&&this.rankHandler.run()},PicBusinessStreetListPanel.prototype.onBackHandler=function(){this.backHandler&&this.backHandler.run()},PicBusinessStreetListPanel}(Phaser.GameObjects.Container),v=function(t){function PicStreetItem(i,o,r,a,l,u,p,d,m){var g=t.call(this,i,o,r)||this;g.dpr=d,g.key=u,g.key2=p,g.setSize(a,l);var _=.5*-g.width,v=.5*-g.height;g.bg=new y.NineSlicePatch(g.scene,0,0,a,45*d,g.key,"restaurant_bg",{left:4*g.dpr,top:9*g.dpr,right:4*g.dpr,bottom:9*g.dpr}),g.add(g.bg);var b=g.scene.make.image({key:p,frame:"icon_bg_s"});b.setPosition(_+.5*b.width+3*d,0),g.add(b),g.storeIcon=new c.DynamicImage(g.scene,b.x,0),g.add(g.storeIcon);var P=b.x+.5*b.width+10*d;return g.storeName=g.scene.make.text({x:P,y:v+10*d,text:"",style:{color:"#FFE11A",fontSize:12*d,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0),g.add(g.storeName),g.playerName=g.scene.make.text({x:P,y:g.storeName.y+.5*g.storeName.height+10*d,text:"",style:{color:"#ffffff",fontSize:11*d,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0),g.add(g.playerName),g.industryIcon=g.scene.make.image({key:g.key2,frame:"entertainment_tag_s"}),g.industryIcon.x=.5*g.width-.5*g.industryIcon.width,g.add(g.industryIcon),g.praiseIcon=g.scene.make.image({key:p,frame:"praise"}),g.praiseIcon.x=-_-80*d,g.add(g.praiseIcon),g.praiseCount=g.scene.make.text({x:g.praiseIcon.x+.5*g.praiseIcon.width+10*d,y:g.praiseIcon.y,text:"",style:{color:"#ffffff",fontSize:12*d,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),g.add(g.praiseCount),g}return g(PicStreetItem,t),PicStreetItem.prototype.setStoreData=function(t,i){var o=t.industry,r=t.storeType;this.bg.setFrame(o+"_bg"),this.storeIcon.setTexture(this.key2,r+"_icon_s"),this.praiseIcon.setFrame(i===a.praise?"praise":"store_popularity"),this.storeName.text=t.name,this.playerName.text=t.ownerName,this.praiseCount.text=(i===a.praise?t.praise:t.popularity)+"",this.industryIcon.setFrame(o+"_tag_s"),this.storeData=t,this.storeName.removeInteractive(),this.storeName.setInteractive()},PicStreetItem}(Phaser.GameObjects.Container);!function(t){t[t.popularity=1]="popularity",t[t.praise=2]="praise"}(a||(a={}))},function(t,i,o){"use strict";o.r(i),o.d(i,"SecondaryMenuPanel",(function(){return l}));var r,a=o(109),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function SecondaryMenuPanel(i,o,r,h,l,c,u,p){var d=t.call(this,i,o,r)||this;return d.dpr=c,d.zoom=u,d.setSize(h,l),p.cellupCallBack=d.onSelectCategoryHandler.bind(d),d.gameScroll=new a.GameScroller(d.scene,p),d.add(d.gameScroll),d}return h(SecondaryMenuPanel,t),SecondaryMenuPanel.prototype.setHandler=function(t,i){this.categoryHandler=t,this.subCategoryHandler=i},SecondaryMenuPanel.prototype.setCategories=function(t,i,o){this.gameScroll.clearItems();for(var r=o.width,a=o.height,h=o.key,l=o.normalFrame,c=o.downFrame,u=o.patchConfig,p=o.music,d=[],m=0,y=i;m<y.length;m++){var g=y[m],_=g.text,v=new t(this.scene,h,l,c,_,p,this.dpr,this.zoom,u);o.textStyle&&v.setTextStyle(o.textStyle),v.setData("category",g.data),v.disableInteractive(),r&&(v.width=r),a&&(v.height=a),this.gameScroll.addItem(v),d.push(v)}this.gameScroll.setAlign(1),this.gameScroll.Sort(!0),this.gameScroll.refreshMask();for(var b=this.gameScroll.getItemList(),P=0,w=b;P<w.length;P++){w[P].background.visible=!1}this.onSelectCategoryHandler(b[0])},SecondaryMenuPanel.prototype.setSubItems=function(t){if(this.gridTable){this.gridTable.setItems(t),this.gridTable.resetMask();var i=this.gridTable.getCells();if(i){var o=i[0];o&&o.container&&this.onSubCategoryHandler(o.container)}}},SecondaryMenuPanel.prototype.createGrideTable=function(t,i,o,r,h,l,c,u){var p=this;void 0===u&&(u=1);var d={x:t,y:i,table:{width:o,height:r,columns:1,cellWidth:h,cellHeight:l,reuseCellContainer:!0,zoom:this.zoom},scrollMode:u,clamplChildOY:!1,createCellContainerCallback:c};this.gridTable=new a.GameGridTable(this.scene,d),this.gridTable.layout(),this.gridTable.on("cellTap",(function(t){t&&p.onSubCategoryHandler(t)})),this.add(this.gridTable),this.gridTable.resetMask()},SecondaryMenuPanel.prototype.onSelectCategoryHandler=function(t){this.categoryBtn&&(this.categoryBtn.background.visible=!1),t.background.visible=!0,t.changeDown(),this.categoryBtn=t;var i=t.getData("category");this.categoryHandler&&this.categoryHandler.runWith(i)},SecondaryMenuPanel.prototype.onSubCategoryHandler=function(t){this.subCategoryBtn&&this.subCategoryBtn.changeNormal(),t.changeDown(),this.subCategoryHandler&&this.subCategoryHandler.runWith(t)},SecondaryMenuPanel}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i);var r,a=o(112),h=o(115),l=o(120),c=o(168),u=o(285),p=o(289),d=o(291),m=o(284),y=o(288),g=o(287),_=o(286),v=o(114),b=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),P=function(t){function PicBusinessStreetPanel(i,o){var r=t.call(this,i,o)||this;return r.key="c_street_1",r.key2="c_street_2",r}return b(PicBusinessStreetPanel,t),PicBusinessStreetPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,i,o),this.setSize(r,a),this.mBackGround.clear(),this.mBackGround.fillStyle(0,.66),this.mBackGround.fillRect(0,0,r,a)},PicBusinessStreetPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicBusinessStreetPanel.prototype.addListen=function(){this.mInitialized},PicBusinessStreetPanel.prototype.removeListen=function(){this.mInitialized},PicBusinessStreetPanel.prototype.preload=function(){this.addAtlas(this.key,"c_street_1/c_street_1.png","c_street_1/c_street_1.json"),this.addAtlas(this.key2,"c_street_2/c_street_2.png","c_street_2/c_street_2.json"),this.addAtlas(h.UIAtlasKey.commonKey,h.UIAtlasName.commonUrl+".png",h.UIAtlasName.commonUrl+".json"),this.addAtlas(h.UIAtlasKey.common2Key,h.UIAtlasName.common2Url+".png",h.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicBusinessStreetPanel.prototype.init=function(){var i=this.scale,o=this.scaleWidth,r=this.scaleHeight;this.mBackGround=this.scene.make.graphics(void 0,!1),this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,o*i,r*i),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.add(this.mBackGround);var a=90*this.dpr,h=74*this.dpr,u=295*this.dpr,p=r-a-h,d=a+.5*p,m=.5*o;this.content=new c.PicBusinessContentPanel(this.scene,m,d,u,p,this.dpr,this.key,this.key2),this.content.setCloseHandler(new l.a(this,this.OnCloseHandler)),this.add(this.content),this.resize(o,r),t.prototype.init.call(this),this.openMyStreet()},PicBusinessStreetPanel.prototype.setMyStore=function(t){this.picMyStreetPanel.setMyStoreData(t)},PicBusinessStreetPanel.prototype.setCommercialStreet=function(t){this.picStreetListPanel&&this.picStreetListPanel.setStreetListData(t.commercialStreet)},PicBusinessStreetPanel.prototype.setIndustryModels=function(t){this.industryModels=t,this.picStoreCreatePanel&&this.picStoreCreatePanel.parentContainer&&this.picStoreCreatePanel.setTypeData(t.industry),this.picStreetListPanel&&this.picStreetListPanel.parentContainer&&this.picStreetListPanel.setIndustryModels(this.industryModels)},PicBusinessStreetPanel.prototype.setStoreRankingList=function(t){this.picStreetRankingPanel.setRankingData(t.rankChampions)},PicBusinessStreetPanel.prototype.setStoreRankingDetial=function(t){this.picRankingDetailPanel.setRankingDetailData(t)},PicBusinessStreetPanel.prototype.setStoreRankingReward=function(t){this.picRankRewardPanel.setRankRewardData(t.rewardStage)},PicBusinessStreetPanel.prototype.setEnterHistory=function(t){this.picStreetHistoryPanel.setHistoryeData(t.history)},PicBusinessStreetPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicBusinessStreetPanel.prototype.setSecondStore=function(t){this.picSecondStorePanel.setTypeData(t)},PicBusinessStreetPanel.prototype.openMyStreet=function(){this.emit("querymystore"),this.showMyStreetPanel(),this.content.setTitleText(v.a.t("business_street.commercial_street"))},PicBusinessStreetPanel.prototype.openStoreCreatePanel=function(){this.emit("querymodels"),this.showStoreCreatePanel(),this.content.setTitleText(v.a.t("business_street.newstore"))},PicBusinessStreetPanel.prototype.openSecondStorePanel=function(){this.showSecondStorePanel(),this.content.setTitleText(v.a.t("business_street.newstore"))},PicBusinessStreetPanel.prototype.openStoreStreetPanel=function(){this.showStreetListPanel(),this.industryModels?this.picStreetListPanel.setIndustryModels(this.industryModels):this.emit("querymodels"),this.content.setTitleText(v.a.t("business_street.commercial_street"))},PicBusinessStreetPanel.prototype.openStreetHistoryPanel=function(){this.showStreetHistoryPanel(),this.content.setTitleText(v.a.t("business_street.history"))},PicBusinessStreetPanel.prototype.openStreetRankingPanel=function(){this.showStreetRankingPanel(),this.content.setTitleText(v.a.t("business_street.ranking"))},PicBusinessStreetPanel.prototype.openRankingDetailPanel=function(){this.showRankingDetailPanel(),this.content.setTitleText(v.a.t("business_street.ranking"))},PicBusinessStreetPanel.prototype.openRankRewardPanel=function(){this.showRankRewardPanel(),this.content.setTitleText(v.a.t("business_street.rankreward"))},PicBusinessStreetPanel.prototype.showMyStreetPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picMyStreetPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picMyStreetPanel=new u.PicBusinessMyStreetPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key),this.picMyStreetPanel.setHandler(new l.a(this,(function(){t.emit("queryallsaves")})),new l.a(this,(function(){t.openStoreStreetPanel(),t.hideMyStreetPanel()})),new l.a(this,(function(){t.hideMyStreetPanel(),t.openStoreCreatePanel()})),new l.a(this,(function(i,o){t.emit("queryenterroom",i,o)})))}this.content.add(this.picMyStreetPanel),this.picMyStreetPanel.resetMask()},PicBusinessStreetPanel.prototype.hideMyStreetPanel=function(){this.content.remove(this.picMyStreetPanel)},PicBusinessStreetPanel.prototype.showStoreCreatePanel=function(){var t=this,i=this.scaleWidth,o=this.scaleHeight,r=295*this.dpr,a=320*this.dpr,h=.5*o,c=.5*i;if(this.content.setPosition(c,h),this.content.setContentSize(r,a),!this.picStoreCreatePanel){var u=this.content.width,d=this.content.height-50*this.dpr;this.picStoreCreatePanel=new p.PicBusinessStoreCreatePanel(this.scene,0,0,u,d,this.dpr,this.scale,this.key),this.picStoreCreatePanel.setHandler(new l.a(this,(function(){t.openMyStreet(),t.hideStoreCreatePanel()})),new l.a(this,(function(i){t.openSecondStorePanel(),t.hideStoreCreatePanel(),t.setSecondStore(i)})))}this.content.add(this.picStoreCreatePanel),this.picStoreCreatePanel.resetMask()},PicBusinessStreetPanel.prototype.hideStoreCreatePanel=function(){this.content.remove(this.picStoreCreatePanel)},PicBusinessStreetPanel.prototype.showSecondStorePanel=function(){var t=this,i=this.scaleWidth,o=this.scaleHeight,r=295*this.dpr,a=320*this.dpr,h=.5*o,c=.5*i;if(this.content.setPosition(c,h),this.content.setContentSize(r,a),!this.picSecondStorePanel){var u=this.content.width,d=this.content.height-50*this.dpr;this.picSecondStorePanel=new p.PicBusinessStoreCreatePanel(this.scene,0,0,u,d,this.dpr,this.scale,this.key,!1),this.picSecondStorePanel.setHandler(new l.a(this,(function(){t.openStoreCreatePanel(),t.hideSecondStorePanel()})),new l.a(this,(function(i){t.emit("querycreatestore",i.modelId)})))}this.content.add(this.picSecondStorePanel),this.picSecondStorePanel.resetMask()},PicBusinessStreetPanel.prototype.hideSecondStorePanel=function(){this.content.remove(this.picSecondStorePanel)},PicBusinessStreetPanel.prototype.showStreetListPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picStreetListPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picStreetListPanel=new d.PicBusinessStreetListPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key,this.key2),this.picStreetListPanel.setHandler(new l.a(this,(function(){t.openStreetHistoryPanel(),t.hideStreetListPanel(),t.emit("queryenterhistory")})),new l.a(this,(function(){t.openStreetRankingPanel(),t.hideStreetListPanel(),t.emit("queryranklist")})),new l.a(this,(function(){t.hideStreetListPanel(),t.openMyStreet()})),new l.a(this,(function(i,o){t.emit("querystreet",i,o)})),new l.a(this,(function(i,o){t.emit("queryenterroom",i,o)})))}this.content.add(this.picStreetListPanel),this.picStreetListPanel.resetMask()},PicBusinessStreetPanel.prototype.hideStreetListPanel=function(){this.content.remove(this.picStreetListPanel)},PicBusinessStreetPanel.prototype.showStreetHistoryPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picStreetHistoryPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picStreetHistoryPanel=new m.PicBusinessHistoryPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key,this.key2),this.picStreetHistoryPanel.setHandler(new l.a(this,(function(){t.hideStreetHistoryPanel(),t.openStoreStreetPanel()})))}this.content.add(this.picStreetHistoryPanel),this.picStreetHistoryPanel.resetMask()},PicBusinessStreetPanel.prototype.hideStreetHistoryPanel=function(){this.content.remove(this.picStreetHistoryPanel)},PicBusinessStreetPanel.prototype.showStreetRankingPanel=function(){var t=this,i=110*this.dpr,o=94*this.dpr;if(this.setContentSize(i,o),!this.picStreetRankingPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picStreetRankingPanel=new y.PicBusinessRankingPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key,this.key2),this.picStreetRankingPanel.setHandler(new l.a(this,(function(){t.hideStreetRankingPanel(),t.openStoreStreetPanel()})),new l.a(this,(function(i,o){t.openRankingDetailPanel(),t.hideStreetRankingPanel(),t.emit("queryrankdetail",i,o)})))}this.content.add(this.picStreetRankingPanel),this.picStreetRankingPanel.show(),this.picStreetRankingPanel.resetMask()},PicBusinessStreetPanel.prototype.hideStreetRankingPanel=function(){this.content.remove(this.picStreetRankingPanel),this.picStreetRankingPanel.hide()},PicBusinessStreetPanel.prototype.showRankingDetailPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picRankingDetailPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picRankingDetailPanel=new g.PicBusinessRankingDetailPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key,this.key2),this.picRankingDetailPanel.setHandler(new l.a(this,(function(){t.hideRankingDetailPanel(),t.openStreetRankingPanel()})),new l.a(this,(function(i,o){t.hideRankingDetailPanel(),t.openRankRewardPanel(),t.emit("queryrankreward",i,o)})))}this.content.add(this.picRankingDetailPanel),this.picRankingDetailPanel.resetMask()},PicBusinessStreetPanel.prototype.hideRankingDetailPanel=function(){this.content.remove(this.picRankingDetailPanel)},PicBusinessStreetPanel.prototype.showRankRewardPanel=function(){var t=this,i=90*this.dpr,o=74*this.dpr;if(this.setContentSize(i,o),!this.picRankRewardPanel){var r=this.content.width,a=this.content.height-50*this.dpr;this.picRankRewardPanel=new _.PicBusinessRankRewardPanel(this.scene,0,0,r,a,this.dpr,this.scale,this.key,this.key2),this.picRankRewardPanel.setHandler(new l.a(this,(function(){t.hideRankRewardPanel(),t.openRankingDetailPanel()})))}this.content.add(this.picRankRewardPanel),this.picRankRewardPanel.resetMask()},PicBusinessStreetPanel.prototype.hideRankRewardPanel=function(){this.content.remove(this.picRankRewardPanel)},PicBusinessStreetPanel.prototype.setContentSize=function(t,i){var o=this.scaleWidth,r=this.scaleHeight,a=295*this.dpr,h=r-t-i,l=t+.5*h,c=.5*o;this.content.setPosition(c,l),this.content.setContentSize(a,h)},PicBusinessStreetPanel.prototype.OnCloseHandler=function(){this.emit("hide")},PicBusinessStreetPanel.prototype.onSelectItemHandler=function(t){},PicBusinessStreetPanel.prototype.getRichLabel=function(t,i){return void 0===i&&(i="#2B4BB5"),"[stroke="+i+"][color="+i+"]"+t+":[/color][/stroke]"},PicBusinessStreetPanel.prototype.getspaceStr=function(t){for(var i="",o=0;o<t;o++)i+=" ";return i},PicBusinessStreetPanel}(a.BasePanel);i.default=P},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHouse",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicHouse(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicHouse,t),PicHouse.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_INFO,this.onRetRoomInfoHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_ROOM_REFURBISH_REQUIREMENTS,this.on_REFURBISH_REQUIREMENTS))},PicHouse.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicHouse.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicHouse.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicHouse.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicHouse.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicHouse.prototype.sendEnterDecorate=function(){this.connection&&this.connection.send(new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER))},PicHouse.prototype.queryRoomInfo=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_ROOM_INFO);i.content.roomId=t,this.connection.send(i)},PicHouse.prototype.query_REFURBISH_REQUIREMENTS=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_ROOM_REFURBISH_REQUIREMENTS);i.content.id=t,this.connection.send(i)},PicHouse.prototype.query_ROOM_REFURBISH=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_ROOM_REFURBISH);i.content.id=t,this.connection.send(i)},PicHouse.prototype.onRetRoomInfoHandler=function(t){var i=t.content;this.mEvent.emit("roominfo",i)},PicHouse.prototype.on_REFURBISH_REQUIREMENTS=function(t){var i=t.content;this.mEvent.emit("refurbish",i)},PicHouse}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHouseInfoPanel",(function(){return p}));var r,a=o(113),h=o(114),l=o(115),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicHouseInfoPanel(i,o,r,a,h,l,c){var u=t.call(this,i,o,r)||this;return u.key=l,u.dpr=c,u.setSize(a,h),u.createAttribute(),u}return u(PicHouseInfoPanel,t),PicHouseInfoPanel.prototype.setAttributeData=function(t){this.roomname.setTextInfo(h.a.t("room_info.roomname"),t.name);var i=0,o=0,r=0;t.roomLevel&&(i=t.roomLevel.level,o=t.roomLevel.currentLevelExp?t.roomLevel.currentLevelExp:0,r=t.roomLevel.nextLevelExp?t.roomLevel.nextLevelExp:0),this.roomlevel.setImageInfo(h.a.t("room_info.roomlevel"),l.UIAtlasKey.common2Key,this.getLevelImgs(i));var a="[color=#0D8288]"+o+"[/color]/"+r;this.expvalue.setTextInfo(h.a.t("room_info.expvalue"),a),this.popvalue.setTextInfo(h.a.t("room_info.popvalue"),t.popularity+""),this.goodvalue.setTextInfo(h.a.t("room_info.goodvalue"),t.praise+""),"store"===t.roomType?(this.compviness.visible=!0,this.turnover.visible=!0,this.deprecia.visible=!0,this.compviness.setTextInfo(h.a.t("room_info.compveness"),t.competitiveness+""),this.turnover.setTextInfo(h.a.t("room_info.turnover"),t.turnoverProp.value+"("+t.turnoverProp.tempValue+")"),this.deprecia.setTextInfo(h.a.t("room_info.depreciation"),100*t.undepreciated+"%"),this.add([this.compviness,this.turnover,this.deprecia])):(this.compviness.visible=!1,this.turnover.visible=!1,this.deprecia.visible=!1,this.remove([this.compviness,this.turnover,this.deprecia]))},PicHouseInfoPanel.prototype.setHandler=function(t){this.equirementsHandler=t},PicHouseInfoPanel.prototype.createAttribute=function(){var t=.5*-this.height+10*this.dpr,i=20*this.dpr,o=this.width,r=20*this.dpr+i;this.roomname=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.roomlevel=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.expvalue=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.popvalue=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.goodvalue=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.compviness=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.turnover=new d(this.scene,0,t,o,i,this.dpr),t+=r,this.deprecia=new d(this.scene,0,t,o,i,this.dpr),this.renovateBtn=new c.Button(this.scene,l.UIAtlasKey.commonKey,"order_yellow_butt","order_yellow_butt",h.a.t("room_info.renovate")),this.renovateBtn.scale=1.1,this.renovateBtn.setTextStyle({fontSize:12*this.dpr,color:"#ED7814"}),this.renovateBtn.on(String(c.ClickEvent.Tap),this.onRenovateHandler,this),this.renovateBtn.x=.5*this.width-60*this.dpr,this.help=new c.Button(this.scene,l.UIAtlasKey.common2Key,"icon_tips","icon_tips"),this.help.x=.5*this.width-20*this.dpr,this.deprecia.add([this.renovateBtn,this.help]),this.add([this.roomname,this.roomlevel,this.expvalue,this.popvalue,this.goodvalue])},PicHouseInfoPanel.prototype.onRenovateHandler=function(){this.equirementsHandler&&this.equirementsHandler.run()},PicHouseInfoPanel.prototype.getLevelImgs=function(t){t=t||0;for(var i=[],o=Math.floor(t/Math.pow(4,3)),r=t%Math.pow(4,3),a=Math.floor(r/Math.pow(4,2)),h=r%Math.pow(4,2),l=Math.floor(h/Math.pow(4,1)),c=h%Math.pow(4,1),u=0;u<o;u++)i.push("bear");for(u=0;u<a;u++)i.push("sun");for(u=0;u<l;u++)i.push("moon");for(u=0;u<c;u++)i.push("star");return 0===t&&i.push("star"),i},PicHouseInfoPanel.prototype.getpopImgs=function(){return["popularity","popularity","popularity","popularity","popularity"]},PicHouseInfoPanel.prototype.getgoodImgs=function(){return["good","good","good","good1","good1"]},PicHouseInfoPanel}(Phaser.GameObjects.Container),d=function(t){function HouseAttributeValue(i,o,r,h,l,u){var p=t.call(this,i,o,r)||this;return p.dpr=u,p.setSize(h,l),p.nameText=p.scene.make.text({x:.5*-h+15*u,y:0,text:"",style:{fontFamily:a.a.BOLD_FONT,fontSize:14*u,bold:!0,color:"#FFC51A"}}).setOrigin(0,.5).setResolution(u),p.valueText=new c.BBCodeText(p.scene,0,0,"",{color:"#000000",fontSize:13*p.dpr,fontFamily:a.a.DEFULT_FONT}).setOrigin(0,.5).setResolution(u),p.imgCon=p.scene.make.container(void 0,!1),p.imgCon.x=10*u,p.add([p.nameText,p.valueText,p.imgCon]),p}return u(HouseAttributeValue,t),HouseAttributeValue.prototype.setTextInfo=function(t,i){this.nameText.text=t,this.valueText.text=i},HouseAttributeValue.prototype.setImageInfo=function(t,i,o){this.nameText.text=t;for(var r=0,a=10*this.dpr,h=0,l=o;h<l.length;h++){var c=l[h],u=this.scene.make.image({key:i,frame:c});u.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),u.x=r,r+=.5*u.width+a,this.imgCon.add(u)}this.valueText.visible=!1},HouseAttributeValue}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHousePanel",(function(){return _}));var r,a=o(112),h=o(114),l=o(113),c=o(115),u=o(127),p=o(295),d=o(109),m=o(120),y=o(297),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function PicHousePanel(i,o){var r=t.call(this,i,o)||this;return r.key="pichousepanel",r}return g(PicHousePanel,t),PicHousePanel.prototype.resize=function(t,i){this.scale;var o=this.scaleWidth,r=this.scaleHeight;this.content.x=.5*o,this.content.y=.5*r,this.setSize(o,r),this.itemsPanel.y=.5*this.height-60*this.dpr,this.itemsPanel.x=.5*this.width},PicHousePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicHousePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicHousePanel.prototype.addListen=function(){this.mInitialized&&(this.closeBtn.on("pointerup",this.onCloseHandler,this),this.editorRoomBtn.on("pointerup",this.onEnterEditorHandler,this))},PicHousePanel.prototype.removeListen=function(){this.mInitialized&&(this.closeBtn.off("pointerup",this.onCloseHandler,this),this.editorRoomBtn.off("pointerup",this.onEnterEditorHandler,this))},PicHousePanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicHousePanel.prototype.setRoomInfoData=function(t,i){if(void 0===i&&(i=!0),this.mRoomInfoData=t,this.mInitialized){var o=295*this.dpr,r=370*this.dpr;"store"===t.roomType?(r=460*this.dpr,this.content.setSize(o,r),this.bg.resize(o,r),this.closeShopBtn.visible=!0,this.roomInfoBtn.y=.5*-this.content.height-.5*this.roomInfoBtn.height+5*this.dpr,this.roomSettingBtn.y=this.roomInfoBtn.y,this.closeBtn.y=.5*-this.bg.height+5*this.dpr,this.editorRoomBtn.y=.5*this.content.height-30*this.dpr,this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr,this.closeShopBtn.on(String(d.ClickEvent.Tap),this.onCloseShopHandler,this)):this.closeShopBtn.visible=!1,this.houseInfoPanel.setAttributeData(t),this.roomSettingBtn.visible=i,this.editorRoomBtn.visible=i}},PicHousePanel.prototype.on_REFURBISH_REQUIREMENTS=function(t){this.itemsPanel.setItemDatas(t.requirements)},PicHousePanel.prototype.preload=function(){this.addAtlas(this.key,"room_information/room_information.png","room_information/room_information.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),this.addAtlas(c.UIAtlasKey.common2Key,c.UIAtlasName.common2Url+".png",c.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicHousePanel.prototype.init=function(){var i=this;if(!this.mInitialized){var o=this.scaleWidth,r=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,o,r),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var a=295*this.dpr,g=370*this.dpr;this.content.setSize(a,g),this.bg=new d.NineSlicePatch(this.scene,0,0,a,g,c.UIAtlasKey.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:c.UIAtlasKey.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.roomInfoBtn=this.createTabButton(h.a.t("room_info.infobtn"),"small_information"),this.roomSettingBtn=this.createTabButton(h.a.t("room_info.setting"),"small_setting"),this.roomInfoBtn.setPosition(.5*-this.roomInfoBtn.width-2*this.dpr,.5*-this.content.height-.5*this.roomInfoBtn.height+3*this.dpr),this.roomSettingBtn.setPosition(.5*this.roomSettingBtn.width+2*this.dpr,this.roomInfoBtn.y),this.topCheckBox=new u.CheckboxGroup,this.topCheckBox.appendItemAll([this.roomInfoBtn,this.roomSettingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.roomInfoBtn,this.roomSettingBtn]),this.houseInfoPanel=new p.PicHouseInfoPanel(this.scene,0,0,this.content.width-40*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr),this.houseInfoPanel.y=.5*-this.content.height+.5*this.houseInfoPanel.height+30*this.dpr,this.houseInfoPanel.setHandler(new m.a(this,(function(){i.emit("queryrequirements",i.mRoomInfoData.roomId),i.itemsPanel.visible=!0,i.add(i.itemsPanel),i.itemsPanel.resetMask()}))),this.content.add(this.houseInfoPanel),this.closeShopBtn=new d.NineSliceButton(this.scene,0,this.houseInfoPanel.height-30*this.dpr,94*this.dpr,29*this.dpr,this.key,"close_shop",h.a.t("room_info.closeshop"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.closeShopBtn.setTextStyle({color:"#C12914",fontSize:12*this.dpr,fontFamily:l.a.BOLD_FONT});var _=this.houseInfoPanel.y+.5*this.houseInfoPanel.height+.5*this.closeShopBtn.height+20*this.dpr;this.closeShopBtn.y=_,this.houseInfoPanel.add(this.closeShopBtn),this.closeShopBtn.visible=!1;var v=.5*this.content.height;this.editorRoomBtn=new d.NineSliceButton(this.scene,0,v-30*this.dpr,100*this.dpr,35*this.dpr,c.UIAtlasKey.commonKey,"button_g",h.a.t("room_info.editorroom"),this.dpr,this.scale,{left:16*this.dpr,top:16*this.dpr,right:16*this.dpr,bottom:16*this.dpr}),this.editorRoomBtn.setTextStyle({color:"#022B55",fontSize:12*this.dpr,fontFamily:l.a.BOLD_FONT}),this.editorRoomBtn.setTextOffset(10*this.dpr,0);var b=.5*-this.editorRoomBtn.width+8*this.dpr,P=this.scene.make.image({x:b,y:-3*this.dpr,key:this.key,frame:"renovation"});this.editorRoomBtn.add(P),this.content.add(this.editorRoomBtn),this.editorRoomBtn.visible=!1,this.topCheckBox.selectIndex(0),this.itemsPanel=new y.ItemsConsumeFunPanel(this.scene,278*this.dpr,198*this.dpr,this.dpr,this.scale),this.itemsPanel.createBackGrphaic(o,r),this.itemsPanel.setTextInfo(h.a.t("room_info.renovate").toUpperCase(),h.a.t("compose.needMaterials")),this.itemsPanel.visible=!1,this.itemsPanel.setHandler(new m.a(this,(function(){i.emit("queryrefurbish",i.mRoomInfoData.roomId)}))),this.add(this.content),this.resize(0,0),t.prototype.init.call(this)}},PicHousePanel.prototype.updateData=function(){this.mRoomInfoData&&this.setRoomInfoData(this.mRoomInfoData)},PicHousePanel.prototype.onTabBtnHandler=function(t){this.roomInfoBtn===t?this.houseInfoPanel.visible=!0:this.houseInfoPanel.visible=!1,this.roomSettingBtn===t&&(this.houseInfoPanel.visible=!1)},PicHousePanel.prototype.createTabButton=function(t,i){var o=new d.TabButton(this.scene,this.key,"default tab","check tab",t);o.setTextStyle({fontFamily:l.a.BOLD_FONT,fontSize:12*this.dpr,color:"#ffffff"}),o.setTextOffset(13*this.dpr,0);var r=this.scene.make.image({key:this.key,frame:i});return o.add(r),r.x=.5*-o.width+.5*r.width+7*this.dpr,o},PicHousePanel.prototype.onCloseShopHandler=function(){this.emit("closeshop",this.mRoomInfoData)},PicHousePanel.prototype.onCloseHandler=function(){this.emit("hide")},PicHousePanel.prototype.onEnterEditorHandler=function(){this.emit("scenedecorate")},PicHousePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemsConsumeFunPanel",(function(){return y}));var r,a=o(114),h=o(113),l=o(129),c=o(115),u=o(116),p=o(111),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function ItemsConsumeFunPanel(i,o,r,a,h,l){void 0===l&&(l=!0);var c=t.call(this,i)||this;return c.materialItems=[],c.havebutton=!0,c.dpr=a,c.zoom=h,c.havebutton=l,c.setSize(o,r),c.create(),c}return m(ItemsConsumeFunPanel,t),ItemsConsumeFunPanel.prototype.createBackGrphaic=function(t,i){this.mblackGraphic=this.scene.make.graphics(void 0,!1),this.mblackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,t,i),Phaser.Geom.Rectangle.Contains),this.mblackGraphic.fillStyle(0,.66),this.mblackGraphic.fillRect(.5*-t,.5*-i+this.y,t,i),this.addAt(this.mblackGraphic,0)},ItemsConsumeFunPanel.prototype.resetMask=function(){this.gameScroll.refreshMask()},ItemsConsumeFunPanel.prototype.setHandler=function(t){this.confirmHandler=t},ItemsConsumeFunPanel.prototype.setTextInfo=function(t,i,o){this.title.text=t,this.materialTitle.text=i,this.materialLine.x=this.materialTitle.x-.5*this.materialTitle.width-5*this.dpr-.5*this.materialLine.width,this.materialLine2.x=this.materialTitle.x+.5*this.materialTitle.width+5*this.dpr+.5*this.materialLine2.width,this.havebutton&&void 0!==o&&this.confirmBtn.setText(o)},ItemsConsumeFunPanel.prototype.setItemDatas=function(t,i){void 0!==i&&(this.confirmHandler=i),this.gameScroll.clearItems(!1);for(var o=0,r=this.materialItems;o<r.length;o++){(h=r[o]).visible=!1}for(var a=0;a<t.length;a++){var h=void 0;a<this.materialItems.length?h=this.materialItems[a]:(h=new g(this.scene,this.dpr),this.materialItems.push(h)),h.visible=!0,h.setItemData(t[a]),this.gameScroll.addItem(h)}this.gameScroll.Sort()},ItemsConsumeFunPanel.prototype.create=function(){var t=this,i=this.scene.make.image({key:c.UIAtlasKey.common2Key,frame:"universal_box"});this.add(i),this.setSize(i.width,i.height),this.title=this.scene.make.text({x:0,y:.5*-this.height+25*this.dpr,text:"",style:{color:"#FFC51A",fontSize:13*this.dpr,fontFamily:h.a.BOLD_FONT}},!1).setOrigin(.5),this.add(this.title),this.closeBtn=new d.Button(this.scene,c.UIAtlasKey.commonKey,"close","close"),this.closeBtn.setPosition(.5*this.width-5*this.dpr,.5*-this.height+5*this.dpr).setScale(1.3),this.closeBtn.on(String(d.ClickEvent.Tap),this.onCloseHandler,this),this.add(this.closeBtn);var o=this.havebutton?0:20*this.dpr;this.materialTitle=this.scene.make.text({x:0,y:.5*-this.height+45*this.dpr+o,text:"",bold:!0,style:{color:"#263FCB",fontSize:13*this.dpr,fontFamily:h.a.DEFULT_FONT,wordWrap:{width:90*this.dpr,useAdvancedWrap:!0}}},!1).setOrigin(.5),this.materialLine=this.scene.make.image({x:-10*this.dpr,y:this.materialTitle.y,key:c.UIAtlasKey.common2Key,frame:"line_left"}),this.materialLine2=this.scene.make.image({x:10*this.dpr,y:this.materialTitle.y,key:c.UIAtlasKey.common2Key,frame:"line_right"}),this.add([this.materialTitle,this.materialLine,this.materialLine2]),this.gameScroll=new d.GameScroller(this.scene,{x:0,y:-10*this.dpr+o,width:this.width-40*this.dpr,height:90*this.dpr,zoom:this.zoom,align:2,orientation:1,dpr:this.dpr,cellupCallBack:function(i){t.onMaterialItemHandler(i)}}),this.add(this.gameScroll),this.havebutton&&(this.confirmBtn=new d.NineSliceButton(this.scene,0,0,106*this.dpr,40*this.dpr,c.UIAtlasKey.commonKey,"yellow_btn",a.a.t("common.confirm"),this.dpr,1,{left:12*this.dpr,top:12*this.dpr,right:12*this.dpr,bottom:12*this.dpr}),this.confirmBtn.y=.5*this.height-.5*this.confirmBtn.height-15*this.dpr,this.confirmBtn.setTextStyle({fontSize:16*this.dpr,color:"#996600"}),this.confirmBtn.on(String(d.ClickEvent.Tap),this.onConfirmHandler,this),this.add(this.confirmBtn));var r=145*this.dpr,u=55*this.dpr;this.itemtips=new l.ItemInfoTips(this.scene,r,u,c.UIAtlasKey.common2Key,"tips_bg",this.dpr,{left:10*this.dpr,top:10*this.dpr,right:10*this.dpr,bottom:10*this.dpr}),this.itemtips.x=.5*-this.width+.5*r+10*this.dpr,this.itemtips.y=.5*-this.height+70*this.dpr,this.itemtips.visible=!1,this.add(this.itemtips)},ItemsConsumeFunPanel.prototype.onConfirmHandler=function(){this.onCloseHandler(),this.confirmHandler&&this.confirmHandler.run()},ItemsConsumeFunPanel.prototype.onCloseHandler=function(){this.visible=!1,this.parentContainer&&this.parentContainer.remove(this)},ItemsConsumeFunPanel.prototype.onMaterialItemHandler=function(t){this.itemtips.visible=!1,this.curSelectItem&&this.curSelectItem!==t&&(this.curSelectItem.select=!1),t.select=!t.select,t.select&&(this.itemtips.setItemData(t.itemData),this.itemtips.visible=!0),this.curSelectItem=t,this.setTipsPosition(t)},ItemsConsumeFunPanel.prototype.setTipsPosition=function(t){for(var i=t.x,o=t.y,r=t;r.parentContainer!==this;)i+=r.parentContainer.x,o+=r.parentContainer.y,r=r.parentContainer;i-.5*this.itemtips.width<.5*-this.width?this.itemtips.x=.5*this.itemtips.width-.5*this.width:i+.5*this.itemtips.width>.5*this.width?this.itemtips.x=.5*this.width-.5*this.itemtips.width:this.itemtips.x=i,this.itemtips.y=o-.5*this.itemtips.height+5*this.dpr},ItemsConsumeFunPanel}(Phaser.GameObjects.Container),g=function(t){function MaterialItem(i,o){var r=t.call(this,i)||this;return r.mselect=!1,r.dpr=o,r.bg=r.scene.make.image({key:c.UIAtlasKey.common2Key,frame:"material_unchecked"}),r.itemIcon=new u.DynamicImage(i,0,0),r.itemCount=new d.BBCodeText(r.scene,0,15*o,"10/20",{color:"#000000"}).setOrigin(.5).setFontSize(11*o).setFontFamily(h.a.DEFULT_FONT),r.add([r.bg,r.itemIcon,r.itemCount]),r.setSize(r.bg.width,r.bg.height),r.itemCount.y=.5*r.height+8*o,r}return m(MaterialItem,t),MaterialItem.prototype.setItemData=function(t){var i=this;this.itemData=t,this.itemCount.text=this.getCountText(t.count,t.neededCount);var o=p.i.getOsdRes(t.display.texturePath);this.itemIcon.load(o,this,(function(){i.itemIcon.scale=i.dpr,i.itemIcon.setPosition(0,0)}))},Object.defineProperty(MaterialItem.prototype,"select",{get:function(){return this.mselect},set:function(t){this.mselect=t,this.bg.setFrame(t?"material_checked":"material_unchecked")},enumerable:!1,configurable:!0}),MaterialItem.prototype.getCountText=function(t,i){var o=t>=i?"#000000":"#ff0000";return"[stroke="+o+"][color="+o+"]"+t+"[/color][/stroke]/"+i},MaterialItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOpenParty",(function(){return l}));var r,a=o(110),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function PicOpenParty(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return h(PicOpenParty,t),PicOpenParty.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},PicOpenParty.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicOpenParty.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicOpenParty.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicOpenParty.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicOpenParty.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicOpenParty}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOpenPartyCreatePanel",(function(){return d}));var r,a=o(109),h=o(114),l=o(113),c=o(116),u=o(115),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicOpenPartyCreatePanel(i,o,r,a,h,l,c){var u=t.call(this,i,o,r)||this;return u.itemCount=0,u.key=l,u.dpr=c,u.setSize(a,h),u.create(),u.setPartyData(),u}return p(PicOpenPartyCreatePanel,t),PicOpenPartyCreatePanel.prototype.resize=function(){this.gamegride&&this.gamegride.resetMask()},PicOpenPartyCreatePanel.prototype.hide=function(){this.visible=!1,this.describleInput.visible=!1,this.describleInput.node.style.display="none",this.mNameInput.visible=!1,this.mNameInput.node.style.display="none",this.openBtn.off(String(a.ClickEvent.Tap),this.onOpenPartyHandler,this)},PicOpenPartyCreatePanel.prototype.show=function(){this.visible=!0,this.describleInput.visible=!0,this.describleInput.node.style.display="true",this.mNameInput.visible=!0,this.mNameInput.node.style.display="true",this.openBtn.on(String(a.ClickEvent.Tap),this.onOpenPartyHandler,this)},PicOpenPartyCreatePanel.prototype.setPartyData=function(){this.timeSlider.setValue(50,0,100),this.gamegride.setItems(new Array(60))},PicOpenPartyCreatePanel.prototype.create=function(){var t=this;this.partyNameTitle=this.scene.make.text({x:.5*-this.width+10*this.dpr,y:.5*-this.height+20*this.dpr,text:h.a.t("party.partyname"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*this.dpr,bold:!0,color:"#000000"}}),this.partyNameTitle.setOrigin(0,.5).setResolution(this.dpr),this.partyNameTitle.setStroke("#000000",2),this.add(this.partyNameTitle),this.mNameInput=this.createInput(this.partyNameTitle.x+this.partyNameTitle.width+5*this.dpr,this.partyNameTitle.y,203*this.dpr,37*this.dpr),this.partyThemeTitle=this.scene.make.text({x:this.partyNameTitle.x,y:this.partyNameTitle.y+60*this.dpr,text:h.a.t("party.partytheme"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*this.dpr,bold:!0,color:"#000000"}}),this.partyThemeTitle.setOrigin(0,.5).setResolution(this.dpr),this.partyThemeTitle.setStroke("#000000",2),this.add(this.partyThemeTitle);var i={x:20*this.dpr,y:this.partyThemeTitle.y,table:{width:207*this.dpr,height:90*this.dpr,columns:1,cellWidth:70*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(i,o){i.scene,i.index,i.item;return null===o&&(o=new m(t.scene,65*t.dpr,70*t.dpr,t.key,t.dpr)),o.setThemeData(),o}};this.gamegride=new a.GameGridTable(this.scene,i),this.gamegride.layout(),this.add(this.gamegride),this.describleTitle=this.scene.make.text({x:this.partyThemeTitle.x,y:this.partyThemeTitle.y+60*this.dpr,text:h.a.t("party.partydescrible"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*this.dpr,bold:!0,color:"#000000"}}),this.describleTitle.setOrigin(0,.5).setResolution(this.dpr),this.describleTitle.setStroke("#000000",2),this.add(this.describleTitle),this.describleInput=this.createInput(this.describleTitle.x+this.describleTitle.width+5*this.dpr,this.describleTitle.y+10*this.dpr,203*this.dpr,52*this.dpr,"textarea"),this.partyTimeTitle=this.scene.make.text({x:this.describleTitle.x,y:this.describleTitle.y+80*this.dpr,text:h.a.t("party.partytime"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*this.dpr,bold:!0,color:"#000000"}}),this.partyTimeTitle.setOrigin(0,.5).setResolution(this.dpr),this.partyTimeTitle.setStroke("#000000",2),this.add(this.partyTimeTitle);var o=200*this.dpr,r=4*this.dpr,p=this.partyTimeTitle.x+this.partyTimeTitle.width+5*this.dpr+.5*o;this.createSlider(p,this.partyTimeTitle.y,o,r),this.partyTimeLable=this.scene.make.text({x:this.partyTimeTitle.x,y:this.partyTimeTitle.y+60*this.dpr,text:h.a.t("party.partycardlabel"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:11*this.dpr,bold:!0,color:"#000000"}}),this.partyTimeLable.setOrigin(0,.5).setResolution(this.dpr),this.add(this.partyTimeLable),this.partyCardImage=new c.DynamicImage(this.scene,this.partyTimeLable.x+this.partyTimeLable.width,this.partyTimeLable.y),this.add(this.partyCardImage),this.partyTimevalue=this.scene.make.text({x:this.partyCardImage.x,y:this.partyCardImage.y,text:"",style:{fontFamily:l.a.DEFULT_FONT,fontSize:14*this.dpr,bold:!0,color:"#000000"}}),this.partyTimevalue.setOrigin(0,.5).setResolution(this.dpr),this.partyTimevalue.setStroke("#000000",2),this.add(this.partyTimevalue),this.openBtn=new a.NineSliceButton(this.scene,0,.5*this.height+2*this.dpr,100*this.dpr,33*this.dpr,u.UIAtlasKey.commonKey,"yellow_btn_normal",h.a.t("party.partyopen"),this.dpr,this.scale,{left:14*this.dpr,top:0*this.dpr,right:14*this.dpr,bottom:0*this.dpr}),this.openBtn.setTextStyle({color:"#996600",fontSize:13*this.dpr,fontFamily:l.a.BOLD_FONT}),this.add(this.openBtn)},PicOpenPartyCreatePanel.prototype.createSlider=function(t,i,o,r){var h=new a.NineSlicePatch(this.scene,0,0,8,7*this.dpr,u.UIAtlasKey.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),c=new a.NineSlicePatch(this.scene,0,0,8,7*this.dpr,u.UIAtlasKey.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1});this.thumb=this.scene.make.image({key:u.UIAtlasKey.common2Key,frame:"block"}),this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:12*this.dpr,fontFamily:l.a.DEFULT_FONT,bold:!0}},!1).setOrigin(.5),this.timeSlider=new a.GameSlider(this.scene,{x:t,y:i,width:o,height:r,orientation:1,background:h,indicator:c,thumb:this.thumb,offsetX:.5*this.thumb.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.timeSlider.add(this.itemCountText),this.timeSlider.setValue(0),this.add(this.timeSlider)},PicOpenPartyCreatePanel.prototype.onSliderValueHandler=function(t){this.itemCountText.x=this.thumb.x,this.itemCountText.text=Math.floor(100*t)+"",this.itemCount=t},PicOpenPartyCreatePanel.prototype.onOpenPartyHandler=function(){},PicOpenPartyCreatePanel.prototype.createInput=function(t,i,o,r,l){void 0===l&&(l="text");var c=this.scene.make.graphics(void 0,!1);c.fillStyle(10809331,.66),c.fillRect(0,.5*-r,o,r),c.setPosition(t,i),this.add(c);var u=new a.InputText(this.scene,t+.5*o,i,o,r-10*this.dpr,{type:l,placeholder:h.a.t("party.partydescrible"),color:"#055C62",fontSize:14*this.dpr+"px"});return this.add(u),u},PicOpenPartyCreatePanel}(Phaser.GameObjects.Container),m=function(t){function PicPartyThemeItem(i,o,r,a,h){var u=t.call(this,i)||this;return u.dpr=h,u.setSize(o,r),u.icon=new c.DynamicImage(i,0,0),u.icon.setTexture(a,"party_icon_1"),u.value=i.make.text({x:0,y:0,text:"10",style:{color:"#333333",fontSize:11*h,fontFamily:l.a.DEFULT_FONT}}),u.value.setOrigin(.5,0),u.value.y=.5*u.height-10*h,u.value.setWordWrapWidth(u.width,!0),u.add([u.icon,u.value]),u}return p(PicPartyThemeItem,t),PicPartyThemeItem.prototype.setThemeData=function(){this.value.text="发生四点山豆根士大夫敢死队风格去问人体温热太温柔额我让他为人体微软他"},PicPartyThemeItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOpenPartyPanel",(function(){return y}));var r,a=o(112),h=o(114),l=o(113),c=o(115),u=o(127),p=o(109),d=o(299),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicOpenPartyPanel(i,o){var r=t.call(this,i,o)||this;return r.key="picpartypanel",r}return m(PicOpenPartyPanel,t),PicOpenPartyPanel.prototype.resize=function(t,i){this.scale;var o=this.scaleWidth,r=this.scaleHeight;this.content.x=.5*o,this.content.y=.5*r,this.setSize(o,r),this.partyCreatePanel.resize()},PicOpenPartyPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicOpenPartyPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicOpenPartyPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicOpenPartyPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicOpenPartyPanel.prototype.setPartyData=function(t,i){void 0===i&&(i=!0),this.mPartyData=t,this.mInitialized&&(this.settingBtn.visible=i)},PicOpenPartyPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),this.addAtlas(c.UIAtlasKey.common2Key,c.UIAtlasName.common2Url+".png",c.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicOpenPartyPanel.prototype.init=function(){if(!this.mInitialized){var i=this.scaleWidth,o=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,i,o),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var r=295*this.dpr,a=450*this.dpr;this.content.setSize(r,a),this.bg=new p.NineSlicePatch(this.scene,0,0,r,a,c.UIAtlasKey.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:c.UIAtlasKey.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.partyBtn=this.createTabButton(h.a.t("main_ui.party")),this.settingBtn=this.createTabButton(h.a.t("common.setting")),this.partyBtn.setPosition(.5*-this.partyBtn.width-2*this.dpr,.5*-this.content.height-.5*this.partyBtn.height+3*this.dpr),this.settingBtn.setPosition(.5*this.settingBtn.width+2*this.dpr,this.partyBtn.y),this.topCheckBox=new u.CheckboxGroup,this.topCheckBox.appendItemAll([this.partyBtn,this.settingBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.partyBtn,this.settingBtn]),this.partyCreatePanel=new d.PicOpenPartyCreatePanel(this.scene,0,0,this.content.width-20*this.dpr,this.content.height-70*this.dpr,this.key,this.dpr),this.partyCreatePanel.y=0,this.content.add(this.partyCreatePanel),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicOpenPartyPanel.prototype.updateData=function(){this.mPartyData&&this.setPartyData(this.mPartyData)},PicOpenPartyPanel.prototype.onTabBtnHandler=function(t){this.partyBtn===t?this.partyCreatePanel.show():this.partyCreatePanel.hide(),this.settingBtn},PicOpenPartyPanel.prototype.createTabButton=function(t){var i=new p.TabButton(this.scene,c.UIAtlasKey.common2Key,"default_tab","check_tab",t);return i.setTextStyle({fontFamily:l.a.BOLD_FONT,fontSize:16*this.dpr,color:"#ffffff"}),i.setTextOffset(0,0),i},PicOpenPartyPanel.prototype.onCloseHandler=function(){this.emit("close")},PicOpenPartyPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOrder",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicOrder(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicOrder,t),PicOrder.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_ORDER_LIST,this.on_ORDER_LIST),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_PLAYER_PROGRESS,this.on_PLAYER_PROGRESS))},PicOrder.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicOrder.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicOrder.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicOrder.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicOrder.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicOrder.prototype.query_ORDER_LIST=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_ORDER_LIST);this.connection.send(t)},PicOrder.prototype.query_CHANGE_ORDER_STAGE=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CHANGE_ORDER_STAGE),r=o.content;r.index=t,r.op=i,this.connection.send(o)},PicOrder.prototype.query_PLAYER_PROGRESS=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_PLAYER_PROGRESS);this.connection.send(t)},PicOrder.prototype.query_PLAYER_PROGRESS_REWARD=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_TAKE_PLAYER_PROGRESS_REWARD);i.content.index=t,this.connection.send(i)},PicOrder.prototype.on_ORDER_LIST=function(t){var i=t.content;this.mEvent.emit("questlist",i)},PicOrder.prototype.on_PLAYER_PROGRESS=function(t){var i=t.content;this.mEvent.emit("progresslist",i)},PicOrder}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOrderPanel",(function(){return b}));var r,a=o(112),h=o(113),l=o(2),c=o(115),u=o(114),p=o(116),d=o(120),m=o(111),y=o(135),g=o(109),_=o(129),v=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),b=function(t){function PicOrderPanel(i,o){var r=t.call(this,i,o)||this;return r.key="order_ui",r}return v(PicOrderPanel,t),PicOrderPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.setSize(r,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,r,a),this.content.x=.5*r,this.content.y=.5*a,this.mGameGrid.resetMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains)},PicOrderPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicOrderPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicOrderPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicOrderPanel.prototype.preload=function(){this.addAtlas(this.key,"order/order.png","order/order.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),this.addAtlas(c.UIAtlasKey.common2Key,c.UIAtlasName.common2Url+".png",c.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicOrderPanel.prototype.init=function(){var i=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var o=295*this.dpr,r=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(o,r),this.add(this.content),this.bg=new g.NineSlicePatch(this.scene,0,0,o,r,c.UIAtlasKey.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var a=.5*-r;this.titlebg=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title_bg"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=a-.5*this.titlebg.height+2*this.dpr;var l=this.scene.make.image({x:0,y:0,key:this.key,frame:"order_title"});l.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),l.y=this.titlebg.y+34*this.dpr,this.tilteName=this.scene.make.text({x:0,y:a-18*this.dpr,text:u.a.t("order.title"),style:{color:"#905B06",fontSize:15*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*o-5*this.dpr,y:a+5*this.dpr,key:c.UIAtlasKey.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",2),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive(),this.orderProgressPanel=new T(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.orderProgressPanel.y=.5*-r+20*this.dpr,this.orderProgressPanel.setHandler(new d.a(this,this.onProgressHandler));var p={x:0,y:15*this.dpr,table:{width:o-40*this.dpr,height:r-110*this.dpr,columns:1,cellWidth:o-40*this.dpr,cellHeight:70*this.dpr,reuseCellContainer:!0,zoom:this.scale},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(t,o){t.scene;var r=t.index,a=t.item;return null===o&&((o=new P(i.scene,i.mWorld,i.key,i.dpr)).setHandler(new d.a(i,i.onSendHandler),new d.a(i,i.onRefreshOrderList),new d.a(i,i.onItemInfoTips)),o.on("pointerdown",i.onClickDownHandler,i)),o.setOrderData(a,r),o}};this.mGameGrid=new g.GameGridTable(this.scene,p),this.mGameGrid.layout(),this.goldImageValue=new S(this.scene,50*this.dpr,14*this.dpr,this.key,this.dpr),this.goldImageValue.setFrameValue("",this.key,"order_precious"),this.goldImageValue.setTextStyle({color:"#144B99",fontSize:10*this.dpr,bold:!0,stroke:"#144B99",strokeThickness:4}),this.goldImageValue.y=.5*r-25*this.dpr,this.goldImageValue.visible=!1,this.orderProgressPanel.visible=!1,this.itemtips=new _.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,c.UIAtlasKey.common2Key,"tips_bg",this.dpr),this.itemtips.visible=!1,this.content.add([this.bg,this.closeBtn,this.titlebg,l,this.tilteName,this.orderProgressPanel,this.mGameGrid,this.goldImageValue,this.itemtips]),this.resize(),t.prototype.init.call(this),this.emit("questlist"),this.emit("questprogress")},PicOrderPanel.prototype.setOrderDataList=function(t){this.goldImageValue.visible=!0,this.orderProgressPanel.visible=!0;var i=t.orders;this.mGameGrid.setItems(i),this.royalOrderLimit=t.royalOrderLimit,this.goldImageValue.setText(this.royalOrderLimit.currentValue+"/"+this.royalOrderLimit.max),this.goldImageValue.resetSize(),this.goldImageValue.x=.5*this.content.width-.5*this.goldImageValue.width-20*this.dpr},PicOrderPanel.prototype.setOrderProgress=function(t){this.progressData=t,this.orderProgressPanel.setProgressDatas(t)},PicOrderPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicOrderPanel.prototype.OnClosePanel=function(){this.emit("hide")},PicOrderPanel.prototype.onSendHandler=function(t,i){var o=this;i===l.op_pkt_def.PKT_Order_Operator.PKT_ORDER_DELETE?(this.alertView||(this.alertView=new y.AlertView(this.scene,this.mWorld)),this.parentContainer.add(this.alertView),this.alertView.show({text:u.a.t("order.refreshtips"),title:u.a.t("order.refreshtitle"),oy:302*this.dpr*this.mWorld.uiScale,callback:function(){o.emit("changeorder",t,i)}})):this.emit("changeorder",t,i)},PicOrderPanel.prototype.onProgressHandler=function(t,i){if(this.progressData){var o=i.progressData;o.received||(o.targetValue<=this.progressData.currentProgressValue?this.emit("questreward",t):(this.itemtips.setItemData(o.rewards[0]),this.showItemTipsState(i)))}},PicOrderPanel.prototype.onRefreshOrderList=function(){this.emit("questlist")},PicOrderPanel.prototype.onItemInfoTips=function(t){var i=t.itemData;this.itemtips.setText(this.getDesText(i)),this.showItemTipsState(t,10*this.dpr)},PicOrderPanel.prototype.onClickDownHandler=function(){this.setItemTipsVisible(!1)},PicOrderPanel.prototype.showItemTipsState=function(t,i){void 0===i&&(i=0);var o=this.itemtips.x,r=this.itemtips.y;this.setTipsPosition(t,i),o!==this.itemtips.x||r!==this.itemtips.y?this.setItemTipsVisible(!0):this.itemtips.visible?this.setItemTipsVisible(!1):this.setItemTipsVisible(!0)},PicOrderPanel.prototype.setItemTipsVisible=function(t){this.itemtips.visible=t},PicOrderPanel.prototype.setTipsPosition=function(t,i){void 0===i&&(i=0);for(var o=t.x,r=t.y,a=t;a.parentContainer!==this.content;)o+=a.parentContainer.x,r+=a.parentContainer.y,a=a.parentContainer;o-.5*this.itemtips.width<.5*-this.content.width?this.itemtips.x=.5*this.itemtips.width-.5*this.content.width+20*this.dpr:o+.5*this.itemtips.width>.5*this.content.width?this.itemtips.x=.5*this.content.width-.5*this.itemtips.width-20*this.dpr:this.itemtips.x=o,this.itemtips.y=r-.5*this.itemtips.height+10*this.dpr+i},PicOrderPanel.prototype.getDesText=function(t){t||(t={sellingPrice:!0,tradable:!1});var i=t.name+"\n",o=u.a.t("common.source")+":";if(i+=(o="[stroke=#333333][color=#333333]"+(o+=t.source)+"[/color][/stroke]")+"\n",t.sellingPrice){var r=u.a.t("common.sold");i+=(r="[stroke=#333333][color=#333333]"+(r+=m.f.getName(t.sellingPrice.coinType)+" x "+t.sellingPrice.price)+"[/color][/stroke]")+"\n"}if(!t.tradable){var a=u.a.t("furni_unlock.notrading");i+=a="[stroke=#333333][color=#ff0000]*"+a+"[/color][/stroke]"}return i},PicOrderPanel}(a.BasePanel),P=function(t){function OrderItem(i,o,r,a){var l=t.call(this,i)||this;l.materialItems=[],l.imageValues=[],l.orderRewards=[],l.key=r,l.dpr=a,l.mworld=o,l.bg=i.make.image({key:r,frame:"order_ordinary_bg"}),l.add(l.bg),l.setSize(l.bg.width,l.bg.height),l.headbg=i.make.image({key:r,frame:"order_ordinary_head_bg"}),l.add(l.headbg),l.headbg.x=.5*-l.width+.5*l.headbg.width+4*a,l.headbg.y=5*a,l.headIcon=new p.DynamicImage(i,l.headbg.x,0),l.add(l.headIcon),l.refreshBtn=new g.Button(i,l.key,"order_delete_bg","order_delete_bg"),l.refreshBtn.x=.5*l.width-.5*l.refreshBtn.width,l.refreshBtn.y=.5*-l.height+.5*l.refreshBtn.height,l.add(l.refreshBtn);var d=i.make.image({key:r,frame:"order_delete"});return l.refreshBtn.add(d),l.sendBtn=new g.Button(i,c.UIAtlasKey.commonKey,"order_green_butt","order_green_butt",u.a.t("order.send")),l.sendBtn.x=.5*l.width-.5*l.sendBtn.width-5*a,l.sendBtn.setTextStyle({fontSize:10*a}),l.add(l.sendBtn),l.sendTitle=i.make.text({x:.5*l.width-5*a,y:0,text:u.a.t("order.deliverying"),style:{color:"#ffffff",fontSize:13*a,fontFamily:h.a.DEFULT_FONT}}),l.sendTitle.setOrigin(1,.5),l.add(l.sendTitle),l.acceleBtn=new g.Button(i,c.UIAtlasKey.commonKey,"order_red_butt","order_red_butt",u.a.t("order.accele")),l.acceleBtn.x=20*a,l.acceleBtn.y=0,l.acceleBtn.setTextStyle({fontSize:11*a}),l.add(l.acceleBtn),l.acceleSpend=new S(i,30*a,10*a,l.key,l.dpr),l.acceleSpend.x=l.acceleBtn.x,l.acceleSpend.y=l.acceleBtn.y-.5*l.acceleBtn.height-10*a,l.add(l.acceleSpend),l.calcuTime=new S(i,30*a,10*a,l.key,a),l.add(l.calcuTime),l.calcuTime.setTextStyle({color:"#144B99",fontSize:10*a,bold:!0,shadow:{offsetX:0,offsetY:0,color:"#144B99",blur:4,stroke:!0,fill:!0}}),l.calcuTime.x=l.acceleBtn.x,l.calcuTime.y=l.acceleBtn.y+.5*l.acceleBtn.height+10*a,l.sendBtn.on(String(g.ClickEvent.Tap),l.onSendHandler,l),l.acceleBtn.on(String(g.ClickEvent.Tap),l.onAcceleHandler,l),l.refreshBtn.on(String(g.ClickEvent.Tap),l.onRefreshHandler,l),l.setInteractive(),l}return v(OrderItem,t),OrderItem.prototype.setHandler=function(t,i,o){this.sendHandler=t,this.tipsHandler=o,this.refreshHandler=i},OrderItem.prototype.setOrderData=function(t,i){var o=this;if(this.orderData=t,this.index=i,this.hideAllElement(),this.bg.setFrame(t.questType===l.op_pkt_def.PKT_Quest_Type.ORDER_QUEST_ROYAL_MISSION?"order_precious_bg":"order_ordinary_bg"),t.stage!==l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END){var r=m.i.getOsdRes(t.display.texturePath);this.headIcon.load(r,this,(function(){o.headIcon.scale=1,o.headIcon.scaleY=49*o.dpr/o.headIcon.displayHeight,o.headIcon.scaleX=o.headIcon.scaleY})),this.headIcon.visible=!0}t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_ACCEPTABLE?(this.deliveryState(t),this.orderOperator=l.op_pkt_def.PKT_Order_Operator.PKT_ORDER_DELIVERY):t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_PROCESSING?this.deliveryingState(t):t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED?(this.rewardState(t),this.orderOperator=l.op_pkt_def.PKT_Order_Operator.PKT_ORDER_GET_REWARD):t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_END&&(this.cooldownState(t),this.orderOperator=l.op_pkt_def.PKT_Order_Operator.PKT_ORDER_SPEED_UP)},OrderItem.prototype.destroy=function(i){this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0),t.prototype.destroy.call(this,i)},Object.defineProperty(OrderItem.prototype,"serviceTimestamp",{get:function(){return this.mworld.clock.unixTime},enumerable:!1,configurable:!0}),OrderItem.prototype.onAcceleHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,this.orderOperator])},OrderItem.prototype.onRefreshHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index,l.op_pkt_def.PKT_Order_Operator.PKT_ORDER_DELETE])},OrderItem.prototype.deliveryState=function(t){var i=t.questType;this.headbg.setFrame(i===l.op_pkt_def.PKT_Quest_Type.ORDER_QUEST_ROYAL_MISSION?"order_precious_head_bg":"order_ordinary_head_bg"),this.refreshBtn.visible=!0,this.refreshBtn.setInteractive(),this.refreshBtn.setFrameNormal(i===l.op_pkt_def.PKT_Quest_Type.ORDER_QUEST_ROYAL_MISSION?"order_precious_delete_bg":"order_delete_bg");for(var o=.5*-this.width+58*this.dpr,r=!0,a=0;a<t.targets.length;a++){var h=t.targets[a],c=void 0;a<this.materialItems.length?c=this.materialItems[a]:(c=new w(this.scene,this.key,this.dpr),this.add(c),this.materialItems.push(c),c.setHandler(this.tipsHandler),c.addListen()),c.setMaterialData(h),c.x=o+.5*c.width,o+=c.width+8*this.dpr,c.y=-10*this.dpr,c.visible=!0,r=h.count>=h.neededCount}r?(this.sendBtn.setFrameNormal("order_green_butt"),this.sendBtn.setInteractive()):(this.sendBtn.setFrameNormal("order_gray_butt"),this.sendBtn.disInteractive()),this.sendBtn.visible=!0,this.sendBtn.setText(u.a.t("order.send")),this.sendBtn.setTextColor("#ffffff"),o=.5*-this.width+58*this.dpr;for(a=0;a<t.rewards.length;a++){var p=t.rewards[a];c=void 0;a<this.imageValues.length?c=this.imageValues[a]:(c=new S(this.scene,30*this.dpr,13*this.dpr,this.key,this.dpr,this.dpr),this.add(c),this.imageValues.push(c)),c.setFrameValue("x"+p.count,this.key,this.getIconName(p.display.texturePath)+"_s"),c.setTextStyle({color:i===l.op_pkt_def.PKT_Quest_Type.ORDER_QUEST_ROYAL_MISSION?"#ffffff":"#2154BD"}),c.x=o+.5*c.width,o+=c.width+20*this.dpr,c.y=.5*this.height-.5*c.height-4*this.dpr,c.visible=!0}},OrderItem.prototype.deliveryingState=function(t){var i=this;this.deliverybg?this.deliverybg.visible=!0:(this.deliverybg=this.scene.make.image({key:this.key,frame:"order_transport"}),this.addAt(this.deliverybg,1),this.deliverybg.x=.5*this.width-.5*this.deliverybg.width-10*this.dpr),this.headbg.setFrame("order_ordinary_head_bg"),this.sendTitle.visible=!0,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){var o=Math.ceil(t.deliveryDeadline-i.serviceTimestamp/1e3);o<0&&(o=0);var r=Math.floor(o/60),a=o%60,h=(r<10?"0"+r:r+"")+":"+(a<10?"0"+a:a+"");i.calcuTime.visible=!0,i.calcuTime.setFrameValue(h,i.key,"order_time"),i.calcuTime.resetSize(),i.calcuTime.x=.5*i.width-.5*i.calcuTime.width-10*i.dpr,i.calcuTime.y=.5*i.height-.5*i.calcuTime.height-5*i.dpr,o>0?i.timeID=setTimeout((function(){timeextu()}),1e3):(i.timeID&&i.refreshHandler&&i.refreshHandler.run(),i.timeID=void 0)};timeextu();for(var o=.5*-this.width+60*this.dpr,r=0;r<t.rewards.length;r++){var a=t.rewards[r],h=void 0;r<this.imageValues.length?h=this.imageValues[r]:(h=new S(this.scene,30*this.dpr,13*this.dpr,this.key,this.dpr,this.dpr),this.add(h),this.imageValues.push(h)),h.setFrameValue("x"+a.count,this.key,this.getIconName(a.display.texturePath)+"_s"),h.setTextStyle({color:"#2154BD"}),h.x=o+.5*h.width,o+=h.width+20*this.dpr,h.y=.5*this.height-.5*h.height-4*this.dpr,h.visible=!0}},OrderItem.prototype.rewardState=function(t){this.headbg.setFrame("order_ordinary_head_bg"),this.sendBtn.visible=!0,this.sendBtn.setInteractive(),this.sendBtn.setFrameNormal("order_yellow_butt"),this.sendBtn.setText(u.a.t("order.receive")),this.sendBtn.setTextColor("#9A6600");for(var i=.5*-this.width+60*this.dpr,o=0;o<t.rewards.length;o++){var r=t.rewards[o],a=void 0;o<this.orderRewards.length?a=this.orderRewards[o]:(a=new C(this.scene,this.key,this.dpr),this.add(a),this.orderRewards.push(a)),a.x=i+.5*a.width,i+=a.width+20*this.dpr,a.y=-6*this.dpr,a.visible=!0,a.setItemData(r)}},OrderItem.prototype.cooldownState=function(t){var i=this;this.headbg.setFrame("order_unknown_head"),this.headIcon.visible=!1,this.acceleBtn.visible=!0,this.acceleBtn.setInteractive(),this.acceleSpend.visible=!0,this.calcuTime.visible=!0,this.calcuTime.y=this.acceleBtn.y+.5*this.acceleBtn.height+10*this.dpr,this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0);var timeextu=function(){var o=Math.ceil(t.refreshDeadline-i.serviceTimestamp/1e3);o<0&&(o=0);var r=Math.floor(o/60),a=o%60,h=(r<10?"0"+r:r+"")+":"+(a<10?"0"+a:a+"");i.calcuTime.visible=!0,i.calcuTime.setFrameValue(h,i.key,"order_time"),i.calcuTime.resetSize(),i.calcuTime.x=i.acceleBtn.x,i.acceleSpend.setFrameValue(r+"",i.key,"iv_diamond_s"),o>0?i.timeID=setTimeout((function(){timeextu()}),1e3):(i.timeID&&i.refreshHandler&&i.refreshHandler.run(),i.timeID=void 0)};timeextu()},OrderItem.prototype.getIconName=function(t){var i=t,o=i.lastIndexOf("/"),r=i.lastIndexOf(".");return i.slice(o+1,r)},OrderItem.prototype.hideAllElement=function(){this.refreshBtn.visible=!1,this.refreshBtn.disInteractive(),this.sendBtn.visible=!1,this.sendBtn.disInteractive(),this.sendTitle.visible=!1,this.acceleBtn.visible=!1,this.acceleBtn.disInteractive(),this.acceleSpend.visible=!1,this.calcuTime.visible=!1,this.deliverybg&&(this.deliverybg.visible=!1);for(var t=0,i=this.materialItems;t<i.length;t++){(l=i[t]).visible=!1,l.removeListen()}for(var o=0,r=this.orderRewards;o<r.length;o++){(l=r[o]).visible=!1}for(var a=0,h=this.imageValues;a<h.length;a++){var l;(l=h[a]).visible=!1}this.timeID&&(clearTimeout(this.timeID),this.timeID=void 0)},OrderItem}(Phaser.GameObjects.Container),w=function(t){function MaterialItem(i,o,r){var a=t.call(this,i)||this;return a.key=o,a.dpr=r,a.bg=i.make.image({key:o,frame:"order_demand_icon"}),a.setSize(a.bg.width,a.bg.height),a.icon=new p.DynamicImage(i,0,-5*r),a.icon.setSize(15*r,15*r),a.value=new g.BBCodeText(a.scene,0,6*r,"60/30",{color:"#0",fontSize:8*a.dpr,fontFamily:h.a.DEFULT_FONT}).setOrigin(.5),a.add([a.bg,a.icon,a.value]),a.setInteractive(),a}return v(MaterialItem,t),MaterialItem.prototype.setMaterialData=function(t){var i=this;this.itemData=t;var o=m.i.getOsdRes(t.display.texturePath);this.icon.load(o,this,(function(){i.icon.scale=1,i.icon.scaleX=i.icon.displayWidth/i.icon.width,i.icon.scaleY=i.icon.scaleX})),this.value.text=t.count+"/"+t.neededCount},MaterialItem.prototype.setHandler=function(t){this.tipsHandler=t},MaterialItem.prototype.addListen=function(){this.on("pointerup",this.onClickHandler,this)},MaterialItem.prototype.removeListen=function(){this.off("pointerdown",this.onClickHandler,this)},MaterialItem.prototype.destroy=function(i){this.removeListen(),t.prototype.destroy.call(this,i)},MaterialItem.prototype.onClickHandler=function(){this.tipsHandler&&this.tipsHandler.runWith(this)},MaterialItem}(Phaser.GameObjects.Container),S=function(t){function ImageValue(i,o,r,a,l,c){void 0===c&&(c=0);var u=t.call(this,i)||this;return u.dpr=l,u.setSize(o,r),u.icon=i.make.image({key:a,frame:"iv_coin_s"}),u.value=i.make.text({x:0,y:c,text:"10",style:{color:"#ffffff",fontSize:11*l,fontFamily:h.a.DEFULT_FONT}}),u.value.setOrigin(0,.5),u.add([u.icon,u.value]),u}return v(ImageValue,t),ImageValue.prototype.setFrameValue=function(t,i,o){this.icon.setTexture(i,o),this.value.text=t,this.resetPosition()},ImageValue.prototype.setText=function(t){this.value.text=t},ImageValue.prototype.setTextStyle=function(t){this.value.setStyle(t)},ImageValue.prototype.setShadow=function(t,i,o,r,a,h){this.value.setShadow(t,i,o,r,a,h)},ImageValue.prototype.setStroke=function(t,i){this.value.setStroke(t,i)},ImageValue.prototype.resetSize=function(){var t=this.icon.displayWidth+this.value.width;this.setSize(t,this.height),this.resetPosition()},ImageValue.prototype.resetPosition=function(){this.icon.x=.5*-this.width+.5*this.icon.displayWidth,this.value.x=this.icon.x+.5*this.icon.displayWidth+4*this.dpr},ImageValue}(Phaser.GameObjects.Container),C=function(t){function OrderRewardItem(i,o,r){var a=t.call(this,i)||this;return a.bg=i.make.image({key:o,frame:"order_reward"}),a.setSize(a.bg.width,a.bg.height),a.icon=i.make.image({key:o,frame:"order_silver_middle"}),a.text=i.make.text({x:0,y:.5*a.bg.height+13*r,text:"10",style:{color:"#144B99",fontSize:9*r,fontFamily:h.a.DEFULT_FONT}}),a.text.setOrigin(.5),a.add([a.bg,a.icon,a.text]),a}return v(OrderRewardItem,t),OrderRewardItem.prototype.setItemData=function(t){this.text.text=t.name+"*"+t.count;var i=t.display.texturePath,o=i.lastIndexOf("/"),r=i.lastIndexOf("."),a=t.display.texturePath.slice(o+1,r);this.icon.setFrame(a)},OrderRewardItem}(Phaser.GameObjects.Container),T=function(t){function OrderProgressPanel(i,o,r,a,h){var l=t.call(this,i)||this;l.progressItems=[],l.setSize(o,r),l.dpr=h,l.key=a;var c={x:0*h/2,y:15*h,width:251*h,height:11*h,background:{x:0,y:0,width:251*h,height:11*h,config:{top:0*h,left:7*h,right:7*h,bottom:0*h},key:a,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*h,height:11*h,config:{top:0*h,left:7*h,right:7*h,bottom:0*h},key:a,frame:"order_progress_top"},dpr:h,textConfig:void 0};return l.progress=new g.ProgressBar(i,c),l.add(l.progress),l}return v(OrderProgressPanel,t),OrderProgressPanel.prototype.setProgressDatas=function(t){for(var i=t.steps.length,o=100,r=0;r<i;r++){var a=t.steps[r],h=void 0;r<this.progressItems.length?h=this.progressItems[r]:(h=new k(this.scene,0,0,this.key,this.dpr),this.add(h),this.progressItems.push(h),h.setHandler(this.receiveHandler)),h.x=.5*-this.width+this.width*(r+1)/i-16*this.dpr,h.y=15*this.dpr,h.setItemData(a,r,t.currentProgressValue),o=a.targetValue}this.progress.setProgress(t.currentProgressValue,o)},OrderProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressPanel}(Phaser.GameObjects.Container),k=function(t){function OrderProgressItem(i,o,r,a,l){var c=t.call(this,i,o,r)||this;return c.dpr=l,c.key=a,c.bg=new g.Button(i,a,"order_progress_unfinished","order_progress_unfinished"),c.icon=new p.DynamicImage(i,0,0),c.text=i.make.text({x:0,y:.5*c.bg.height+10*l,text:"10",style:{color:"#2154BD",fontSize:12*l,bold:!0,fontFamily:h.a.DEFULT_FONT}}),c.text.setStroke("#2154BD",4),c.text.setOrigin(.5),c.finishIcon=i.make.image({key:a,frame:"order_progress_ok"}),c.balckgraphic=i.make.graphics(void 0,!1),c.balckgraphic.clear(),c.balckgraphic.fillStyle(0,.5),c.balckgraphic.fillCircle(0,0,16*l),c.add([c.bg,c.icon,c.text,c.balckgraphic,c.finishIcon]),c.finishIcon.visible=!1,c}return v(OrderProgressItem,t),OrderProgressItem.prototype.setItemData=function(t,i,o){var r=this;if(this.progressData=t,this.index=i,this.text.text=t.targetValue+"",t.rewards){var a=m.i.getOsdRes(t.rewards[0].display.texturePath);this.icon.load(a,this,(function(){r.icon.scale=1,r.icon.scaleY=29*r.dpr/r.icon.displayHeight,r.icon.scaleX=r.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<=o?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received&&(this.finishIcon.visible=!0,this.balckgraphic.visible=!0)):this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),t.received?this.bg.off(String(g.ClickEvent.Tap),this.onReceiveHandler,this):this.bg.on(String(g.ClickEvent.Tap),this.onReceiveHandler,this)},OrderProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},OrderProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith([this.index,this])},OrderProgressItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPartyList",(function(){return l}));var r,a=o(110),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function PicPartyList(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return h(PicPartyList,t),PicPartyList.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},PicPartyList.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicPartyList.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicPartyList.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicPartyList.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicPartyList.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicPartyList}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPartyListPanel",(function(){return y}));var r,a=o(112),h=o(114),l=o(113),c=o(115),u=o(127),p=o(109),d=o(305),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicPartyListPanel(i,o){var r=t.call(this,i,o)||this;return r.key="picpartypanel",r}return m(PicPartyListPanel,t),PicPartyListPanel.prototype.resize=function(t,i){this.scale;var o=this.scaleWidth,r=this.scaleHeight;this.content.x=.5*o,this.content.y=.5*r+20*this.dpr,this.partyNavigationPanel.refreshMask(),this.setSize(o,r)},PicPartyListPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicPartyListPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.onCloseHandler,this)},PicPartyListPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.onCloseHandler,this)},PicPartyListPanel.prototype.destroy=function(){this.removeListen(),t.prototype.destroy.call(this)},PicPartyListPanel.prototype.setPartyData=function(t,i){void 0===i&&(i=!0),this.mPartyData=t,this.mInitialized&&(this.mineBtn.visible=i)},PicPartyListPanel.prototype.preload=function(){this.addAtlas(this.key,"party/party.png","party/party.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),this.addAtlas(c.UIAtlasKey.common2Key,c.UIAtlasName.common2Url+".png",c.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicPartyListPanel.prototype.init=function(){if(!this.mInitialized){var i=this.scaleWidth,o=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,i,o),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1);var r=295*this.dpr,a=490*this.dpr;this.content.setSize(r,a),this.bg=new p.NineSlicePatch(this.scene,0,0,r,a,c.UIAtlasKey.commonKey,"bg",{left:20*this.dpr,top:20*this.dpr,right:20*this.dpr,bottom:60*this.dpr}),this.content.add(this.bg),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:.5*-this.bg.height+5*this.dpr,key:c.UIAtlasKey.commonKey,frame:"close"}).setScale(1.3),this.closeBtn.setInteractive(),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.content.add([this.closeBtn]),this.navigationBtn=this.createTabButton(h.a.t("party.navigation")),this.mineBtn=this.createTabButton(h.a.t("party.mine")),this.searchBtn=this.createTabButton(h.a.t("common.search")),this.navigationBtn.setPosition(-this.navigationBtn.width-2*this.dpr,.5*-this.content.height-.5*this.navigationBtn.height+6*this.dpr),this.mineBtn.setPosition(this.navigationBtn.x+this.navigationBtn.width+2*this.dpr,this.navigationBtn.y),this.searchBtn.setPosition(this.mineBtn.x+this.mineBtn.width+2*this.dpr,this.navigationBtn.y),this.topCheckBox=new u.CheckboxGroup,this.topCheckBox.appendItemAll([this.navigationBtn,this.mineBtn,this.searchBtn]),this.topCheckBox.on("selected",this.onTabBtnHandler,this),this.content.add([this.navigationBtn,this.mineBtn,this.searchBtn]),this.partyNavigationPanel=new d.PicPartyNavigationPanel(this.scene,this.content.width-40*this.dpr,this.content.height-40*this.dpr,this.key,this.dpr,this.scale),this.partyNavigationPanel.y=0*this.dpr,this.content.add(this.partyNavigationPanel),this.add(this.content),this.resize(0,0),t.prototype.init.call(this),this.topCheckBox.selectIndex(0)}},PicPartyListPanel.prototype.updateData=function(){this.mPartyData&&this.setPartyData(this.mPartyData)},PicPartyListPanel.prototype.onTabBtnHandler=function(t){this.partyNavigationPanel.visible=!1,this.navigationBtn===t?this.partyNavigationPanel.visible=!0:this.mineBtn===t||this.searchBtn},PicPartyListPanel.prototype.createTabButton=function(t){var i=new p.TabButton(this.scene,c.UIAtlasKey.common2Key,"default_tab_s","check_tab_s",t);return i.setTextStyle({fontFamily:l.a.BOLD_FONT,fontSize:16*this.dpr,color:"#ffffff"}),i},PicPartyListPanel.prototype.onCloseHandler=function(){this.emit("close")},PicPartyListPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPartyNavigationPanel",(function(){return g}));var r,a=o(113),h=o(115),l=o(114),c=o(116),u=o(120),p=o(111),d=o(109),m=o(129),y=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),g=function(t){function PicPartyNavigationPanel(i,o,r,a,h,l){var c=t.call(this,i)||this;return c.setSize(o,r),c.key=a,c.dpr=h,c.zoom=l,c.create(),c}return y(PicPartyNavigationPanel,t),PicPartyNavigationPanel.prototype.create=function(){var t=this;this.signProgressPanel=new b(this.scene,252*this.dpr,45*this.dpr,this.key,this.dpr),this.signProgressPanel.y=.5*-this.height+15*this.dpr,this.signProgressPanel.setHandler(new u.a(this,this.onProgressHandler)),this.add(this.signProgressPanel);var i={x:0,y:60*this.dpr,table:{width:254*this.dpr,height:330*this.dpr,columns:1,cellWidth:254*this.dpr,cellHeight:50*this.dpr,reuseCellContainer:!0,zoom:this.zoom},scrollMode:0,clamplChildOY:!1,createCellContainerCallback:function(i,o){i.scene;var r=i.index,a=i.item;return null===o&&(o=new _(t.scene,t.key,t.dpr)).setHandler(new u.a(t,t.onSendHandler)),o.setPartyData(a,r),o}};this.mGameGrid=new d.GameGridTable(this.scene,i),this.mGameGrid.layout(),this.add(this.mGameGrid),this.itemtips=new m.ItemInfoTips(this.scene,121*this.dpr,46*this.dpr,h.UIAtlasKey.commonKey,"tips_bg",this.dpr),this.itemtips.visible=!1,this.add(this.itemtips),this.hotelBtn=new d.Button(this.scene,this.key,"hotel","hotel",l.a.t("party.hotel")),this.hotelBtn.text.setOrigin(0,1),this.hotelBtn.setTextStyle({fontSize:16*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#FFDE00"}),this.hotelBtn.setTextOffset(.5*-this.hotelBtn.width+5*this.dpr,.5*this.hotelBtn.height-2*this.dpr),this.hotelBtn.setPosition(.5*-this.hotelBtn.width-18*this.dpr,this.signProgressPanel.y+.5*this.signProgressPanel.height+.5*this.hotelBtn.height+20*this.dpr),this.hotelBtn.on(String(d.ClickEvent.Tap),this.onHotelHandler,this),this.add(this.hotelBtn),this.picatownBtn=new d.Button(this.scene,this.key,"town","town",l.a.t("party.picatown")),this.picatownBtn.text.setOrigin(0,1),this.picatownBtn.setTextStyle({fontSize:16*this.dpr,fontFamily:a.a.BOLD_FONT,color:"#FFDE00"}),this.picatownBtn.setTextOffset(.5*-this.picatownBtn.width+5*this.dpr,.5*this.picatownBtn.height-2*this.dpr),this.picatownBtn.setPosition(.5*this.picatownBtn.width-10*this.dpr,this.hotelBtn.y),this.picatownBtn.on(String(d.ClickEvent.Tap),this.onPicatownHandler,this),this.add(this.picatownBtn),this.setPartyDataList(),this.setSignProgress()},PicPartyNavigationPanel.prototype.refreshMask=function(){this.mGameGrid.resetMask()},PicPartyNavigationPanel.prototype.setHandler=function(t){this.sendHandler=t},PicPartyNavigationPanel.prototype.setPartyDataList=function(){var t=new Array(60);this.mGameGrid.setItems(t)},PicPartyNavigationPanel.prototype.setSignProgress=function(){this.signProgressPanel.setProgressDatas(null)},PicPartyNavigationPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicPartyNavigationPanel.prototype.onHotelHandler=function(){this.sendHandler&&this.sendHandler.runWith(["hotel"])},PicPartyNavigationPanel.prototype.onPicatownHandler=function(){this.sendHandler&&this.sendHandler.runWith(["pictown"])},PicPartyNavigationPanel.prototype.onSendHandler=function(t,i){this.sendHandler&&this.sendHandler.runWith(["partylist"])},PicPartyNavigationPanel.prototype.onProgressHandler=function(){this.sendHandler&&this.sendHandler.runWith(["progress"])},PicPartyNavigationPanel.prototype.onItemInfoTips=function(t,i,o){this.itemtips.visible=i,this.itemtips.x=o.x,this.itemtips.y=o.y,this.itemtips.setText(this.getDesText(t))},PicPartyNavigationPanel.prototype.getDesText=function(t){t||(t={sellingPrice:!0,tradable:!1});var i=t.name+"\n",o=l.a.t("common.source")+":";if(i+=(o="[stroke=#333333][color=#333333]"+(o+=t.source)+"[/color][/stroke]")+"\n",t.sellingPrice){var r=l.a.t("common.sold");i+=(r="[stroke=#333333][color=#333333]"+(r+=p.f.getName(t.sellingPrice.coinType)+" x "+t.sellingPrice.price)+"[/color][/stroke]")+"\n"}if(!t.tradable){var a=l.a.t("furni_unlock.notrading");i+=a="[stroke=#333333][color=#ff0000]*"+a+"[/color][/stroke]"}return i},PicPartyNavigationPanel}(Phaser.GameObjects.Container),_=function(t){function PartyListItem(i,o,r){var l=t.call(this,i)||this;return l.key=o,l.dpr=r,l.bg=new d.NineSlicePatch(l.scene,0,0,254*r,40*r,l.key,"list_bg",{left:12*l.dpr,top:0*l.dpr,right:12*l.dpr,bottom:0*l.dpr}),l.add(l.bg),l.setSize(l.bg.width,l.bg.height),l.imagIcon=new c.DynamicImage(i,0,0),l.imagIcon.setTexture(l.key,"party_icon_1"),l.imagIcon.x=.5*-l.width+.5*l.imagIcon.width+8*r,l.imagIcon.y=.5*-l.height+.5*l.imagIcon.height+5*r,l.add(l.imagIcon),l.hotImageValue=new v(i,30*r,10*r,o,"hot",r),l.hotImageValue.setTextStyle({fontSize:10*r,color:"#D2691E"}),l.hotImageValue.x=.5*-l.width+.5*l.hotImageValue.width+8*r,l.hotImageValue.y=.5*l.height-.5*l.hotImageValue.height-5*r,l.add(l.hotImageValue),l.partyName=i.make.text({x:.5*-l.width+40*r,y:.5*-l.height+5*r,text:"某某某排队",style:{color:"#333333",fontSize:12*r,fontFamily:a.a.DEFULT_FONT}}),l.partyName.setOrigin(0),l.add(l.partyName),l.partyOwnerName=new v(i,50*r,20*r,o,"user",r),l.partyOwnerName.setTextStyle({fontSize:10*r,color:"#333333"}),l.partyOwnerName.x=l.partyName.x+.5*l.partyOwnerName.width,l.partyOwnerName.y=l.partyName.y+25*r,l.add(l.partyOwnerName),l.playerCount=new v(i,30*r,20*r,h.UIAtlasKey.commonKey,"home_persons",r),l.playerCount.setTextStyle({color:"#333333"}),l.playerCount.x=.5*l.width-25*r,l.add(l.playerCount),l.setPartyData(null,null),l}return y(PartyListItem,t),PartyListItem.prototype.setHandler=function(t){this.sendHandler=t},PartyListItem.prototype.setPartyData=function(t,i){this.hotImageValue.setText("88"),this.partyOwnerName.setText("派对主任昵称")},PartyListItem.prototype.onSendHandler=function(){this.sendHandler&&this.sendHandler.runWith([this.index])},PartyListItem}(Phaser.GameObjects.Container),v=function(t){function ImageValue(i,o,r,h,l,c,u){void 0===u&&(u=0);var p=t.call(this,i)||this;return p.dpr=c,p.setSize(o,r),p.icon=i.make.image({key:h,frame:l}),p.value=i.make.text({x:0,y:u,text:"10",style:{color:"#ffffff",fontSize:11*c,fontFamily:a.a.DEFULT_FONT}}),p.value.setOrigin(0,.5),p.add([p.icon,p.value]),p.resetSize(),p}return y(ImageValue,t),ImageValue.prototype.setFrameValue=function(t,i,o){this.icon.setTexture(i,o),this.value.text=t,this.resetPosition()},ImageValue.prototype.setText=function(t){this.value.text=t},ImageValue.prototype.setTextStyle=function(t){this.value.setStyle(t)},ImageValue.prototype.setShadow=function(t,i,o,r,a,h){this.value.setShadow(t,i,o,r,a,h)},ImageValue.prototype.setStroke=function(t,i){this.value.setStroke(t,i)},ImageValue.prototype.resetSize=function(){var t=this.icon.displayWidth+this.value.width;this.setSize(t,this.height),this.resetPosition()},ImageValue.prototype.resetPosition=function(){this.icon.x=.5*-this.width+.5*this.icon.displayWidth,this.value.x=this.icon.x+.5*this.icon.displayWidth+4*this.dpr},ImageValue}(Phaser.GameObjects.Container),b=function(t){function SignProgressPanel(i,o,r,a,h){var l=t.call(this,i)||this;l.progressItems=[],l.setSize(o,r),l.dpr=h,l.key=a;var c={x:0*h/2,y:15*h,width:251*h,height:11*h,background:{x:0,y:0,width:251*h,height:11*h,config:{top:0*h,left:7*h,right:7*h,bottom:0*h},key:a,frame:"order_progress_bottom"},bar:{x:0,y:0,width:251*h,height:11*h,config:{top:0*h,left:7*h,right:7*h,bottom:0*h},key:a,frame:"order_progress_top"},dpr:h,textConfig:void 0};return l.progress=new d.ProgressBar(i,c),l.add(l.progress),l}return y(SignProgressPanel,t),SignProgressPanel.prototype.setProgressDatas=function(t){for(var i=0;i<5;i++){var o=void 0;i<this.progressItems.length?o=this.progressItems[i]:(o=new P(this.scene,0,0,this.key,this.dpr),this.add(o),this.progressItems.push(o),o.setHandler(new u.a(this,this.onReceiveHandler))),o.x=.5*-this.width+this.width*(i+1)/5-16*this.dpr,o.y=15*this.dpr}},SignProgressPanel.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressPanel.prototype.onReceiveHandler=function(t){this.receiveHandler&&this.receiveHandler.runWith(t)},SignProgressPanel}(Phaser.GameObjects.Container),P=function(t){function SignProgressItem(i,o,r,h,l){var u=t.call(this,i,o,r)||this;return u.dpr=l,u.key=h,u.bg=new d.Button(i,h,"order_progress_unfinished","order_progress_unfinished"),u.icon=new c.DynamicImage(i,0,0),u.text=i.make.text({x:0,y:.5*-u.bg.height-8*l,text:"10",style:{color:"#FFDE00",fontSize:12*l,bold:!0,fontFamily:a.a.DEFULT_FONT}}),u.text.setStroke("#905C06",4),u.text.setOrigin(.5),u.finishIcon=i.make.image({key:h,frame:"order_progress_ok"}),u.balckgraphic=i.make.graphics(void 0,!1),u.balckgraphic.clear(),u.balckgraphic.fillStyle(0,.5),u.balckgraphic.fillCircle(0,0,16*l),u.add([u.bg,u.icon,u.text,u.balckgraphic,u.finishIcon]),u.finishIcon.visible=!1,u}return y(SignProgressItem,t),SignProgressItem.prototype.setItemData=function(t,i,o){var r=this;if(this.progressData=t,this.index=i,this.text.text=t.targetValue+"",t.rewards){var a=p.i.getOsdRes(t.rewards[0].display.texturePath);this.icon.load(a,this,(function(){r.icon.scale=1,r.icon.scaleY=29*r.dpr/r.icon.displayHeight,r.icon.scaleX=r.icon.scaleY}))}this.finishIcon.visible=!1,this.balckgraphic.visible=!1,t.targetValue<o?(this.bg.setFrameNormal("order_progress_finished","order_progress_finished"),t.received?(this.finishIcon.visible=!0,this.balckgraphic.visible=!0,this.bg.off(String(d.ClickEvent.Tap),this.onReceiveHandler,this)):this.bg.on(String(d.ClickEvent.Tap),this.onReceiveHandler,this)):(this.bg.setFrameNormal("order_progress_unfinished","order_progress_unfinished"),this.bg.off(String(d.ClickEvent.Tap),this.onReceiveHandler,this))},SignProgressItem.prototype.setHandler=function(t){this.receiveHandler=t},SignProgressItem.prototype.onReceiveHandler=function(){this.receiveHandler&&this.receiveHandler.runWith(this.index)},SignProgressItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPropFunPanel",(function(){return y}));var r,a=o(113),h=o(112),l=o(111),c=o(114),u=o(115),p=o(130),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicPropFunPanel(i,o){var r=t.call(this,i,o)||this;return r.itemCount=1,r.key="picpropfunpanel",r}return m(PicPropFunPanel,t),PicPropFunPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.blackGraphic.clear(),this.blackGraphic.fillStyle(0,.66),this.blackGraphic.fillRect(0,0,r,a),this.content.x=r/2,this.content.y=a/2,this.setSize(r*this.scale,a*this.scale)},PicPropFunPanel.prototype.show=function(t){if(this.mShowData=t,!this.mPreLoad)if(this.mInitialized){if(!this.mShow){this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen();var i=this.mShowData[0];this.setProp(i),this.updateData()}}else this.preload()},PicPropFunPanel.prototype.addListen=function(){this.mInitialized&&(this.cancelBtn.on("Tap",this.onCancelBtnHandler,this),this.confirmBtn.on("Tap",this.onConfirmBtnHandler,this))},PicPropFunPanel.prototype.removeListen=function(){this.mInitialized&&(this.cancelBtn.off("Tap",this.onCancelBtnHandler,this),this.confirmBtn.off("Tap",this.onConfirmBtnHandler,this))},PicPropFunPanel.prototype.preload=function(){this.addAtlas(u.UIAtlasKey.commonKey,u.UIAtlasName.commonUrl+".png",u.UIAtlasName.commonUrl+".json"),this.addAtlas(u.UIAtlasKey.common2Key,u.UIAtlasName.common2Url+".png",u.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicPropFunPanel.prototype.init=function(){var i=this.scaleWidth,o=this.scaleHeight,r=this.dpr;this.blackGraphic=this.scene.make.graphics(void 0,!1),this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains),this.add(this.blackGraphic),this.content=this.scene.make.container(void 0,!1);var h=299*this.dpr,l=305*this.dpr;this.content.setSize(h,l),this.add(this.content);var m=new d.NineSlicePatch(this.scene,0,0,h,l,u.UIAtlasKey.common2Key,"bg",{left:20*this.dpr,top:20*this.dpr,right:30*this.dpr,bottom:40*this.dpr});m.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains);var y=.5*-m.height+3*r,g=this.scene.make.image({x:0,y:y,key:u.UIAtlasKey.common2Key,frame:"title"});this.titleName=this.scene.make.text({x:0,y:y+3*r,text:"售出",style:{color:"#905B06",fontSize:16*r,fontFamily:a.a.BOLD_FONT}},!1).setOrigin(.5),this.titleName.setFontStyle("bold"),this.itemName=this.scene.make.text({x:0,y:y+40*r,style:{color:"#000000",fontSize:15*r,fontFamily:a.a.DEFULT_FONT}},!1).setOrigin(.5);var _=-40*r;this.mDetailDisplay=new p.DetailDisplay(this.scene),this.mDetailDisplay.scale=.8*this.dpr,this.mDetailDisplay.y=_;var v=30*r;this.priceBg=this.scene.make.image({x:0,y:v,key:u.UIAtlasKey.common2Key,frame:"price_bg"}),this.pricText=this.scene.make.text({x:0,y:v,style:{color:"#000000",fontSize:15*r,fontFamily:a.a.DEFULT_FONT}},!1).setOrigin(.5),this.mCoinIcon=this.scene.make.image({x:-45*this.dpr,y:v,key:u.UIAtlasKey.commonKey,frame:"iv_coin"},!1).setOrigin(.5);var b=new d.NineSlicePatch(this.scene,0,0,8,7*r,u.UIAtlasKey.common2Key,"slider_bg",{left:3,top:1,right:3,bottom:1}),P=new d.NineSlicePatch(this.scene,0,0,8,7*r,u.UIAtlasKey.common2Key,"slider_rate",{left:3,top:1,right:3,bottom:1}),w=this.scene.make.image({key:u.UIAtlasKey.common2Key,frame:"block"});this.thumb=w,this.itemCountText=this.scene.make.text({x:0,y:0,style:{color:"#744803",fontSize:15*r,fontFamily:a.a.DEFULT_FONT}},!1).setOrigin(.5),this.slider=new d.GameSlider(this.scene,{x:0,y:70*r,width:136*r,height:7*r,orientation:1,background:b,indicator:P,thumb:w,offsetX:.5*w.width,valuechangeCallback:this.onSliderValueHandler,valuechangeCallbackScope:this,value:.5}),this.slider.add(this.itemCountText),this.slider.setValue(0);var S=.5*m.height-30*r,C=-66*r;this.cancelBtn=new d.NineSliceButton(this.scene,C,S,112*r,36*r,u.UIAtlasKey.commonKey,"red_btn",c.a.t("common.cancel"),r,this.scale,{left:12*r,top:12*r,right:12*r,bottom:12*r}),this.confirmBtn=new d.NineSliceButton(this.scene,-C,S,112*r,36*r,u.UIAtlasKey.commonKey,"yellow_btn",c.a.t("common.confirm"),r,this.scale,{left:12*r,top:12*r,right:12*r,bottom:12*r}),this.cancelBtn.setTextStyle({color:"#FFFFFF",fontSize:16*r,fontFamily:a.a.BOLD_FONT}),this.confirmBtn.setTextStyle({color:"#976400",fontSize:16*r,fontFamily:a.a.BOLD_FONT}),this.content.add([m,g,this.titleName,this.itemName,this.mDetailDisplay,this.priceBg,this.mCoinIcon,this.pricText,this.slider,this.cancelBtn,this.confirmBtn]),this.resize(0,0),t.prototype.init.call(this)},PicPropFunPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicPropFunPanel.prototype.setProp=function(t){var i=t.data,o=void 0===t.price||t.price;o=!!i.sellingPrice&&o;var r=void 0===t.slider||t.slider;if(this.itemData=i,this.itemCount=r?1:i.count,this.setResource(t.resource),this.itemName.text=i.name||i.shortName,this.itemCountText.text=this.itemCount+"",t.title&&(this.titleName.text=t.title),o){this.pricText.visible=!0,this.priceBg.visible=!0,this.mCoinIcon.visible=!0,this.slider.y=70*this.dpr,this.pricText.text=l.f.getName(i.sellingPrice.coinType)+" x "+i.sellingPrice.price*this.itemCount;var a=l.f.getIcon(i.sellingPrice.coinType);this.mCoinIcon.setFrame(a)}else this.pricText.visible=!1,this.priceBg.visible=!1,this.mCoinIcon.visible=!1,this.slider.y=50*this.dpr;this.confirmHandler=t.confirmHandler,this.cancelHandler=t.cancelHandler,this.slider.visible=r,this.slider.setValue(0)},PicPropFunPanel.prototype.setResource=function(t){t?t.display?this.mDetailDisplay.loadDisplay(t):t.avatar&&this.mDetailDisplay.loadAvatar(t,2,new Phaser.Geom.Point(0,70)):this.mDetailDisplay.loadUrl(this.itemData.display.texturePath)},PicPropFunPanel.prototype.updateData=function(){this.itemCountText&&(this.itemCountText.text=this.itemCount+""),this.pricText&&this.itemData&&this.itemData.sellingPrice&&(this.pricText.text=l.f.getName(this.itemData.sellingPrice.coinType)+" x "+this.itemData.sellingPrice.price*this.itemCount)},PicPropFunPanel.prototype.onCancelBtnHandler=function(){this.cancelHandler&&this.cancelHandler.runWith(this.itemData),this.emit("close")},PicPropFunPanel.prototype.onConfirmBtnHandler=function(){this.confirmHandler&&this.confirmHandler.runWith([this.itemData,this.itemCount]),this.emit("close")},PicPropFunPanel.prototype.onSliderValueHandler=function(t){this.itemCountText.x=this.thumb.x,this.itemCount=this.calcuSliderValue(t),this.updateData()},PicPropFunPanel.prototype.calcuSliderValue=function(t){var i=this.itemData?this.itemData.count:1,o=0;if(i<=40)o=Math.round(i*t);else if(t<=1/4)o=40*t;else{var r=i-10;if(r<=40)o=10+r*(t-1/4)/.75;else{var a=r/4;o=10;for(var h=1;h<4;h++){var l=a+r/12*(h-1);if(t>h/4&&t<=(h+1)/4){o+=l*(t-h/4)/(1/4);break}o+=l}}}return(o=Math.round(o))<1&&(o=1),o},PicPropFunPanel}(h.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicRoomUpgrade",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicRoomUpgrade(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicRoomUpgrade,t),PicRoomUpgrade.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},PicRoomUpgrade.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicRoomUpgrade.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicRoomUpgrade.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicRoomUpgrade.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicRoomUpgrade.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicRoomUpgrade.prototype.queryTargetUI=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),o=i.content;o.uiId=t,o.componentId=0,this.connection.send(i)},PicRoomUpgrade}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicRoomUpgradePanel",(function(){return u}));var r,a=o(112),h=o(114),l=o(113),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicRoomUpgradePanel(i,o){var r=t.call(this,i,o)||this;return r.key="picroomupgradepanel",r.MAX_TIMES=4,r}return c(PicRoomUpgradePanel,t),PicRoomUpgradePanel.prototype.resize=function(t,i){var o=this.scaleWidth,r=this.scaleHeight;this.content.x=.5*o,this.content.y=.5*r,this.setSize(o,r)},PicRoomUpgradePanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.addListen(),this.updateData()):this.preload())},PicRoomUpgradePanel.prototype.hide=function(){this.mShow=!1,this.removeListen()},PicRoomUpgradePanel.prototype.updateData=function(){var t=this.mShowData[0];this.mTitleName.text=t.text[0].text;var i=t.data[0];this.roomIcon.on(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this),this.mPlayedTimes=0,this.roomIcon.play("lv"+i)},PicRoomUpgradePanel.prototype.addListen=function(){this.mInitialized&&(this.setInteractive(new Phaser.Geom.Rectangle(.5*this.width,.5*this.height,this.width,this.height),Phaser.Geom.Rectangle.Contains),this.on("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.removeListen=function(){this.mInitialized&&(this.removeInteractive(),this.off("pointerup",this.onClickHandler,this))},PicRoomUpgradePanel.prototype.destroy=function(){this.mPlayedTimes=0,t.prototype.destroy.call(this)},PicRoomUpgradePanel.prototype.preload=function(){this.addAtlas(this.key,"e_roomupgrade/e_roomupgrade.png","e_roomupgrade/e_roomupgrade.json"),t.prototype.preload.call(this)},PicRoomUpgradePanel.prototype.init=function(){if(!this.mInitialized){var i=this.scaleWidth,o=this.scaleHeight;this.mBackground=this.scene.make.graphics(void 0,!1),this.mBackground.clear(),this.mBackground.fillStyle(0,.66),this.mBackground.fillRect(0,0,i,o),this.add(this.mBackground),this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,462*this.dpr);var r=this.scene.make.image({x:0,y:-20*this.dpr,key:this.key,frame:"effect_bg"});this.content.add(r);var a=this.scene.make.image({key:this.key,frame:"tittle_bg"});a.y=.5*-this.content.height;var c=22*this.dpr+"px "+l.a.BOLD_FONT;this.mTitleName=this.scene.make.text({x:0,y:a.y,text:"",style:{font:c,fill:"#FFF36D"}}).setOrigin(.5),this.mTitleName.setStroke("#471C1E",8),this.mTitleName.setShadow(2,2,"#471C1E",2,!0,!0),this.mTitleName.setTint(16773997,16773997,16756224,16756224),this.content.add([a,this.mTitleName]);var u=this.scene.make.text({x:0,y:.5*this.content.height-40*this.dpr,text:h.a.t("room_upgrade.clicktocontinue"),style:{fontFamily:l.a.DEFULT_FONT,fontSize:16*this.dpr,color:"#FFF000"}}).setOrigin(.5);this.roomIcon=this.scene.make.sprite({key:this.key,frame:"lv1"}),this.roomIcon.y=-40*this.dpr,this.content.add([this.roomIcon,u]),this.add(this.content),this.createAnimations(),this.resize(0,0),t.prototype.init.call(this)}},PicRoomUpgradePanel.prototype.onClickHandler=function(){if(!(this.mPlayedTimes<this.MAX_TIMES)){var t=this.mShowData[0];this.emit("querytargetui",t.id)}},PicRoomUpgradePanel.prototype.createAnimations=function(){for(var t=1;t<=4;t++)this.scene.anims.create({key:"lv"+t,frames:this.scene.anims.generateFrameNames(this.key,{prefix:"lv",frames:[t-1,t]}),duration:500,repeat:-1})},PicRoomUpgradePanel.prototype.animationRepeat=function(){this.mPlayedTimes++,this.mPlayedTimes>=this.MAX_TIMES&&this.roomIcon.off(Phaser.Animations.Events.SPRITE_ANIMATION_REPEAT,this.animationRepeat,this)},PicRoomUpgradePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicWork",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicWork(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicWork,t),PicWork.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_JOB_LIST,this.on_JOB_LIST),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_PLAYER_INFO,this.onUpdatePlayerInfo))},PicWork.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicWork.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicWork.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicWork.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(PicWork.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicWork.prototype.query_JOB_LIST=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_JOB_LIST);this.connection.send(t)},PicWork.prototype.query_WORK_ON_JOB=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_WORK_ON_JOB);i.content.id=t,this.connection.send(i)},PicWork.prototype.on_JOB_LIST=function(t){var i=t.content;this.mEvent.emit("questlist",i)},PicWork.prototype.onUpdatePlayerInfo=function(t){this.mEvent.emit("updateplayer",t.content)},PicWork}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicWorkPanel",(function(){return _}));var r,a=o(112),h=o(113),l=o(115),c=o(114),u=o(116),p=o(120),d=o(111),m=o(129),y=o(109),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function PicWorkPanel(i,o){var r=t.call(this,i,o)||this;return r.key="work_ui",r.workItems=[],r}return g(PicWorkPanel,t),PicWorkPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.setSize(r,a),this.mBackground.clear(),this.mBackground.fillStyle(0,.5),this.mBackground.fillRoundedRect(-this.x,-this.y,r,a),this.content.x=.5*r,this.content.y=.5*a,this.mGameScroll.refreshMask(),this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains)},PicWorkPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},PicWorkPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},PicWorkPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},PicWorkPanel.prototype.preload=function(){this.addAtlas(this.key,"work/work.png","work/work.json"),this.addAtlas(l.UIAtlasKey.commonKey,l.UIAtlasName.commonUrl+".png",l.UIAtlasName.commonUrl+".json"),this.addAtlas(l.UIAtlasKey.common2Key,l.UIAtlasName.common2Url+".png",l.UIAtlasName.common2Url+".json"),t.prototype.preload.call(this)},PicWorkPanel.prototype.init=function(){var i=this;this.mBackground=this.scene.make.graphics(void 0,!1),this.add(this.mBackground);var o=295*this.dpr,r=454*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(o,r),this.add(this.content),this.bg=new y.NineSlicePatch(this.scene,0,0,o,r,l.UIAtlasKey.commonKey,"bg",{left:30*this.dpr,top:30*this.dpr,bottom:30*this.dpr,right:30*this.dpr});var a=.5*-r;this.titlebg=this.scene.make.image({x:0,y:0,key:l.UIAtlasKey.common2Key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=a+3*this.dpr,this.tilteName=this.scene.make.text({x:0,y:this.titlebg.y+2*this.dpr,text:c.a.t("work.title"),style:{color:"#905C06",fontSize:15*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5),this.closeBtn=this.scene.make.image({x:.5*o-5*this.dpr,y:a+5*this.dpr,key:l.UIAtlasKey.commonKey,frame:"close"}),this.tilteName.setStroke("#905C06",2),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive(),this.timesPorgress=new w(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_orange",c.a.t("work.worktimes"),this.dpr),this.timesPorgress.setImageValue(this.key,"icon_work"),this.timesPorgress.y=.5*-r+40*this.dpr,this.timesPorgress.x=-43*this.dpr,this.powerProgress=new w(this.scene,76*this.dpr,14*this.dpr,this.key,"slider_blue",c.a.t("work.vim"),this.dpr),this.powerProgress.setImageValue(this.key,"icon_strength"),this.powerProgress.y=this.timesPorgress.y,this.powerProgress.x=70*this.dpr,this.helpBtn=new y.Button(this.scene,this.key,"icon_tips","icon_tips"),this.helpBtn.y=this.powerProgress.y,this.helpBtn.x=this.powerProgress.x+.5*this.powerProgress.width+5*this.dpr+.5*this.helpBtn.width,this.mGameScroll=new y.GameScroller(this.scene,{x:0,y:18*this.dpr,width:o,height:r-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:10*this.dpr,selfevent:!0,cellupCallBack:function(t){i.onPointerUpHandler(t)}}),this.itemtips=new m.ItemInfoTips(this.scene,150*this.dpr,46*this.dpr,l.UIAtlasKey.commonKey,"tips_bg",this.dpr),this.itemtips.visible=!1,this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.timesPorgress,this.powerProgress,this.helpBtn,this.mGameScroll,this.itemtips]),this.resize(),t.prototype.init.call(this),this.emit("questlist")},PicWorkPanel.prototype.setWorkDataList=function(t){var i=t.jobs;this.mGameScroll.clearItems(!1);for(var o=0,r=this.workItems;o<r.length;o++){(h=r[o]).visible=!1}for(var a=0;a<i.length;a++){var h=void 0;a<this.workItems.length?h=this.workItems[a]:(h=new v(this.scene,this.key,this.dpr),this.workItems.push(h),h.setHandler(new p.a(this,this.onSendHandler),new p.a(this,this.onItemInfoTips))),h.visible=!0,h.setJobData(i[a]),this.mGameScroll.addItem(h)}this.mGameScroll.Sort()},PicWorkPanel.prototype.setProgressData=function(t,i){i&&this.timesPorgress.setProgressDatas(i),t&&this.powerProgress.setProgressDatas(t)},PicWorkPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},PicWorkPanel.prototype.OnClosePanel=function(){this.emit("hide")},PicWorkPanel.prototype.onPointerUpHandler=function(t){this.selectItem&&this.selectItem.setExtend(!1),t.setExtend(!0),this.selectItem=t,this.mGameScroll.Sort(!0)},PicWorkPanel.prototype.onSendHandler=function(t){this.emit("questwork",t)},PicWorkPanel.prototype.onItemInfoTips=function(t,i,o){this.itemtips.visible=i,this.itemtips.x=o.x*this.scale-this.content.x,this.itemtips.y=o.y*this.scale-this.content.y-30*this.dpr,this.itemtips.setText(this.getDesText(t))},PicWorkPanel.prototype.getDesText=function(t){return t||(t={sellingPrice:!0,tradable:!1}),c.a.t("work.attri",{name:""+t.name,value:t.neededCount})},PicWorkPanel}(a.BasePanel),v=function(t){function WorkItem(i,o,r){var a=t.call(this,i)||this;a.imageValues=[],a.isExtend=!1,a.pointTimestamp=0,a.key=o,a.dpr=r;var p=256*r,d=68*r;a.setSize(p,d),a.topCon=i.make.container(void 0,!1),a.add(a.topCon),a.topCon.setSize(p,d),a.bg=new y.NineSlicePatch(a.scene,0,0,p,d,a.key,"bg_default",{left:6*a.dpr,top:0*a.dpr,bottom:0*a.dpr,right:6*r}),a.headIcon=new u.DynamicImage(i,0,0),a.title=i.make.text({x:.5*-a.width+60*r,y:.5*-d+5*r,text:"",style:{color:"#ffffff",fontSize:13*r,fontFamily:h.a.DEFULT_FONT}}),a.salaryvalue=new b(i,60*r,20*r,a.key,a.dpr),a.salaryvalue.setTextStyle({color:"#FFEA00"}),a.salaryvalue.setFrameValue("",l.UIAtlasKey.commonKey,"iv_coin"),a.salaryvalue.x=.5*a.width-30*r,a.salaryvalue.y=.5*-a.height+10*r,a.salaryLabel=i.make.text({x:a.salaryvalue.x-.5*a.salaryvalue.width-5*r,y:a.salaryvalue.y,text:c.a.t("work.salary")+":",style:{color:"#ffffff",fontSize:11*r,fontFamily:h.a.DEFULT_FONT}}),a.salaryLabel.setOrigin(1,.5),a.worklabel=i.make.text({x:.5*-a.width+60*r,y:.5*a.height-12*r,text:"",style:{color:"#ffffff",fontSize:11*r,fontFamily:h.a.DEFULT_FONT}}),a.worklabel.setOrigin(0,.5),a.topCon.add([a.bg,a.headIcon,a.title,a.salaryvalue,a.salaryLabel,a.worklabel]);var m=46*r;return a.bottomCon=i.make.container(void 0,!1),a.bottomCon.setSize(p,m),a.workbg=new y.NineSlicePatch(a.scene,0,0,a.width,m,a.key,"bg_a_unfold",{left:6*a.dpr,top:0*a.dpr,bottom:0*a.dpr,right:6*r}),a.workBtn=new y.NineSliceButton(i,0,0,90*r,36*r,l.UIAtlasKey.commonKey,"yellow_btn_normal",c.a.t("work.title"),r,void 0,{left:14*a.dpr,top:14*a.dpr,bottom:14*a.dpr,right:14*r}),a.workBtn.x=0,a.workBtn.setTextStyle({fontSize:12*r,color:"#996600",bold:!0}),a.bottomCon.add([a.workbg,a.workBtn]),a.workBtn.on(String(y.ClickEvent.Tap),a.onWorkHandler,a),a}return g(WorkItem,t),WorkItem.prototype.setHandler=function(t,i){this.sendHandler=t,this.tipsHandler=i},WorkItem.prototype.setJobData=function(t){var i=this;this.jobData=t;var o=d.i.getOsdRes(t.display.texturePath);this.headIcon.load(o,this,(function(){i.headIcon.scale=1,i.headIcon.scaleX=45*i.dpr/i.headIcon.displayHeight,i.headIcon.scaleY=i.headIcon.scaleX,i.headIcon.x=.5*-i.width+.5*i.headIcon.displayWidth+10*i.dpr})),this.title.text=t.name;var r="0";if(t.rewards){var a=t.rewards[0].countRange;r=a.start+"~"+a.stop}this.salaryvalue.setText(r),this.salaryvalue.x=.5*this.width-.5*this.salaryvalue.width-10*this.dpr,this.salaryLabel.x=this.salaryvalue.x-.5*this.salaryvalue.width-5*this.dpr,this.worklabel.text=t.detail;for(var h=t.targets,l=0,c=this.imageValues;l<c.length;l++){(y=c[l]).visible=!1}for(var u=.5*-this.width+55*this.dpr,m=0;m<h.length;m++){var y=void 0,g=h[m];m<this.imageValues.length?y=this.imageValues[m]:(y=new P(this.scene,35*this.dpr,15*this.dpr,this.key,this.dpr),this.topCon.add(y),this.imageValues.push(y),y.setHandler(new p.a(this,this.onTipsandler)));var _=d.i.getOsdRes(g.display.texturePath);y.setUrlValue(_,g.neededCount),y.setTextStyle({color:g.count>=g.neededCount?"#000000":"#E71313"}),y.setImageData(g),y.visible=!0,y.x=u+.5*y.width,y.y=0,u+=y.width+20*this.dpr}},WorkItem.prototype.setExtend=function(t){if(this.isExtend!==t)if(this.isExtend=t,this.bottomCon.visible=t,t){this.add(this.bottomCon);var i=this.topCon.height+this.bottomCon.height;this.setSize(this.width,i),this.topCon.y=.5*-i+.5*this.topCon.height,this.bottomCon.y=this.topCon.y+.5*this.topCon.height+.5*this.bottomCon.height,this.bg.setFrame("bg_click")}else{this.remove(this.bottomCon);i=this.topCon.height;this.setSize(this.width,i),this.topCon.y=0,this.bg.setFrame("bg_default")}},WorkItem.prototype.destroy=function(i){t.prototype.destroy.call(this,i)},WorkItem.prototype.onWorkHandler=function(){var t=(new Date).getTime();this.pointTimestamp>t||(this.pointTimestamp=t+1e3,this.sendHandler&&this.sendHandler.runWith(this.jobData.id))},WorkItem.prototype.onTipsandler=function(t,i){var o=t.getWorldTransformMatrix();this.tipsHandler&&this.tipsHandler.runWith([t.imageData,i,new Phaser.Geom.Point(o.tx,o.ty)])},WorkItem}(Phaser.GameObjects.Container),b=function(t){function ImageValue(i,o,r,a,h,l){void 0===l&&(l=0);var c=t.call(this,i)||this;return c.dpr=h,c.key=a,c.offsetx=l,c.setSize(o,r),c.create(),c}return g(ImageValue,t),ImageValue.prototype.setFrameValue=function(t,i,o){this.icon.setTexture(i,o),this.value.text=t,this.resetSize()},ImageValue.prototype.setText=function(t){this.value.text=t,this.resetSize()},ImageValue.prototype.setTextStyle=function(t){this.value.setStyle(t)},ImageValue.prototype.setShadow=function(t,i,o,r,a,h){this.value.setShadow(t,i,o,r,a,h)},ImageValue.prototype.setStroke=function(t,i){this.value.setStroke(t,i)},ImageValue.prototype.resetSize=function(){var t=this.icon.displayWidth+this.value.width;this.setSize(t,this.height),this.resetPosition()},ImageValue.prototype.create=function(){this.icon=this.scene.make.image(void 0),this.value=this.scene.make.text({x:0,y:this.offsetx,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:h.a.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},ImageValue.prototype.resetPosition=function(){this.icon.x=.5*-this.width+.5*this.icon.displayWidth,this.value.x=this.icon.x+.5*this.icon.displayWidth+4*this.dpr},ImageValue}(Phaser.GameObjects.Container),P=function(t){function PointerImageValue(i,o,r,a,h,l){void 0===l&&(l=0);var c=t.call(this,i,o,r,a,h,l)||this;return c.addListen(),c}return g(PointerImageValue,t),PointerImageValue.prototype.setImageData=function(t){this.imageData=t},PointerImageValue.prototype.setUrlValue=function(t,i){var o=this;this.value.text=i,this.icon.load(t,this,(function(){o.icon.scale=1,o.icon.scaleY=14*o.dpr/o.icon.displayHeight,o.icon.scaleX=o.icon.scaleY,o.value.x=o.icon.x+.5*o.icon.displayWidth+10*o.dpr,o.resetSize()}))},PointerImageValue.prototype.addListen=function(){this.setInteractive(),this.on("pointerdown",this.onClickDownHandler,this),this.scene.input.on("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.removeListen=function(){this.disableInteractive(),this.off("pointerdown",this.onClickDownHandler,this),this.scene.input.off("pointerup",this.onClickUpHandler,this)},PointerImageValue.prototype.destroy=function(i){this.removeListen(),t.prototype.destroy.call(this,i)},PointerImageValue.prototype.setHandler=function(t){this.tipsHandler=t},PointerImageValue.prototype.create=function(){this.icon=new u.DynamicImage(this.scene,0,0),this.value=this.scene.make.text({x:0,y:this.offsetx,text:"10",style:{color:"#ffffff",fontSize:11*this.dpr,fontFamily:h.a.DEFULT_FONT}}),this.value.setOrigin(0,.5),this.add([this.icon,this.value])},PointerImageValue.prototype.onClickDownHandler=function(){new Phaser.Geom.Point;this.tipsHandler&&this.tipsHandler.runWith([this,!0])},PointerImageValue.prototype.onClickUpHandler=function(){this.tipsHandler&&this.tipsHandler.runWith([this,!1])},PointerImageValue}(b),w=function(t){function ProgressItem(i,o,r,a,l,c,u){var p=t.call(this,i)||this;p.setSize(o,r),p.dpr=u,p.key=a;var d={x:0,y:0,width:o,height:r,background:{x:0,y:0,width:o,height:r,config:{top:0*u,left:7*u,right:7*u,bottom:0*u},key:a,frame:"slider_bottom"},bar:{x:0,y:0,width:o-4*u,height:r-4*u,config:{top:0*u,left:7*u,right:7*u,bottom:0*u},key:a,frame:l},dpr:u,textConfig:void 0};return p.progress=new y.ProgressBar(i,d),p.add(p.progress),p.imgvalue=new b(i,p.width-20*u,p.height,a,u),p.imgvalue.y=u,p.add(p.imgvalue),p.imgvalue.setTextStyle({fontSize:10*u,fontFamily:h.a.NUMBER}),p.title=i.make.text({x:.5*-p.progress.width-3*u,y:0,text:c,style:{color:"#6A7AFF",fontSize:9*u,fontFamily:h.a.DEFULT_FONT}}),p.title.setOrigin(1,.5),p.add(p.title),p}return g(ProgressItem,t),ProgressItem.prototype.setImageValue=function(t,i){this.imgvalue.setFrameValue("",t,i)},ProgressItem.prototype.setProgressDatas=function(t){this.progress.setProgress(t.currentValue,t.max),this.imgvalue.setText(t.currentValue+"/"+t.max)},ProgressItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaMessageBoxPanel",(function(){return d}));var r,a=o(112),h=o(117),l=o(113),c=o(121),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicaMessageBoxPanel(i,o){var r=t.call(this,i,o)||this;return r.key="pica_message_box",r}return p(PicaMessageBoxPanel,t),PicaMessageBoxPanel.prototype.show=function(i){if(t.prototype.show.call(this,i),this.mInitialized){var o=i[0];this.mButtons=[],o&&(o.text&&o.text[0]&&(this.mText.setText(o.text[0].text),this.mText.x=-this.mText.width/2,this.mText.y=-this.mText.height),o.title&&this.mTitleLabel.setText(o.title.text));var r=o.button;if(r){var a=114*this.dpr,h=40*this.dpr,u=(this.width-42*this.dpr)/r.length;this.mButtonContaier.y=this.height/2-h;var p=this.scene.textures.getFrame(this.key,"yellow_btn_normal");if(!p)return;for(var d={left:13*this.dpr,top:13*this.dpr,bottom:p.width-2-13*this.dpr,right:p.height-2-13*this.dpr},m=0,y=0;y<r.length;y++){r[y]&&r[y].text;var g=new c.NinePatchButton(this.mScene,0,0,a,h,this.key,0===y?"yellow_btn":"red_btn",r[y].text,d,r[y]);g.setTextStyle({fontFamily:l.a.DEFULT_FONT,fontSize:16*this.dpr}),g.x=y*u+a/2,m+=y*u+a/2,this.mButtons.push(g),g.on("click",this.onClickHandler,this)}this.mButtonContaier.add(this.mButtons),this.mButtonContaier.x=-m/2}this.resize(0,0)}},PicaMessageBoxPanel.prototype.resize=function(i,o){var r=this.scene.cameras.main.width,a=this.scene.cameras.main.height;this.x=r/2,this.y=a/2,t.prototype.resize.call(this,i,o)},PicaMessageBoxPanel.prototype.preload=function(){this.addAtlas(this.key,"pica_message_box/pica_message_box.png","pica_message_box/pica_message_box.json"),t.prototype.preload.call(this)},PicaMessageBoxPanel.prototype.init=function(){var i=this.scene.cameras.main,o=i.width,r=i.height,a=this.scene.make.graphics(void 0,!1);a.fillStyle(0,.6),a.fillRect(.5*-o,.5*-r,o,r),a.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains),this.add(a);var c=this.scene.textures.getFrame(this.key,"bg"),p=new h.NinePatch(this.scene,0,0,286*this.dpr,c.height,this.key,"bg",{left:22*this.dpr,top:c.height,right:22*this.dpr,bottom:0});this.setSize(p.width,p.height),this.mButtonContaier=this.scene.make.container(void 0,!1);var d=this.scene.make.image({y:-p.height/2,key:this.key,frame:"title"});this.mTitleLabel=this.scene.make.text({y:d.y-6*this.dpr,style:{fontFamily:l.a.DEFULT_FONT,fontSize:16*this.dpr,color:"#3366cc"}},!1).setOrigin(.5),this.mText=new u.BBCodeText(this.mScene,0,0,"",{fontSize:14*this.dpr+"px",fontFamily:l.a.DEFULT_FONT,color:"#000000",origin:{x:.5,y:.5},wrap:{mode:"char",width:this.width},align:"center"}),this.add([p,d,this.mTitleLabel,this.mText,this.mButtonContaier]),t.prototype.init.call(this),this.resize(o,r),this.setInteractive(new Phaser.Geom.Rectangle(0,0,o,r),Phaser.Geom.Rectangle.Contains)},PicaMessageBoxPanel.prototype.onClickHandler=function(t,i){if(i){var o=i.getBtnData();o&&this.emit("click",o)}},PicaMessageBoxPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaNavigate",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicaNavigate(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(PicaNavigate,t),PicaNavigate.prototype.register=function(){this.connection&&this.connection.addPacketListener(this)},PicaNavigate.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},PicaNavigate.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PicaNavigate.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PicaNavigate.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},PicaNavigate.prototype.queryGOHomeHandler=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_GO_HOME);this.connection.send(t)},Object.defineProperty(PicaNavigate.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),PicaNavigate}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaNavigatePanel",(function(){return p}));var r,a=o(112),h=o(114),l=o(115),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicaNavigatePanel(i,o){var r=t.call(this,i,o)||this;return r.key="pica_navigate",r.key_lang="key_lang",r.UIType=c.UIType.Scene,r.setTween(!1),r.setInteractive(),r}return u(PicaNavigatePanel,t),PicaNavigatePanel.prototype.resize=function(i,o){this.setSize(i,o);var r=this.scale,a=this.scene.cameras.main.width/r,h=this.scene.cameras.main.height,c=a/this.scene.textures.getFrame(l.UIAtlasKey.commonKey,"menu_bg").width*this.dpr;this.mBackground.scaleX=c,this.mBackground.x=a/2,this.mBackground.setInteractive(),this.mCloseBtn.x=a-this.mCloseBtn.width/2-3*this.dpr,this.mGoHomeBtn.x=this.mCloseBtn.x-.5*this.mCloseBtn.width-.5*this.mGoHomeBtn.width-24*this.dpr,this.y=h-this.height/2,t.prototype.resize.call(this,i,o)},PicaNavigatePanel.prototype.addListen=function(){this.mInitialized&&this.interactiveBoo&&(this.mMapBtn.on("pointerup",this.onShowMapHandler,this),this.mShopBtn.on("pointerup",this.onShowShopHandler,this),this.mBagBtn.on("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.on("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.on("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.removeListen=function(){this.mInitialized&&(this.mMapBtn.off("pointerup",this.onShowMapHandler,this),this.mShopBtn.off("pointerup",this.onShowShopHandler,this),this.mBagBtn.off("pointerup",this.onShowBagHandler,this),this.mFamilyBtn.off("pointerup",this.onShowFamilyHandler,this),this.mGoHomeBtn.on("pointerup",this.onShowGoHomeHandler,this),this.mCloseBtn.off("pointerup",this.onCloseHandler,this))},PicaNavigatePanel.prototype.hide=function(){this.mShow=!1},PicaNavigatePanel.prototype.show=function(i){t.prototype.show.call(this,i),this.checkUpdateActive()},PicaNavigatePanel.prototype.updateUIState=function(t){this.mInitialized&&("picanavigate.mapbtn"===t.name&&(this.mMapBtn.visible=t.visible,t.disabled?this.mMapBtn.removeInteractive():this.mMapBtn.setInteractive()),"picanavigate.marketbtn"===t.name&&(this.mShopBtn.visible=t.visible,t.disabled?this.mShopBtn.removeInteractive():this.mShopBtn.setInteractive()),"picanavigate.bagbtn"===t.name&&(this.mBagBtn.visible=t.visible,t.disabled?this.mBagBtn.removeInteractive():this.mBagBtn.setInteractive()),"picanavigate.gohomebtn"===t.name&&(this.mGoHomeBtn.visible=t.visible,t.disabled?this.mGoHomeBtn.removeInteractive():this.mGoHomeBtn.setInteractive()))},Object.defineProperty(PicaNavigatePanel.prototype,"isZh_CN",{get:function(){return"zh-CN"===h.a.language},enumerable:!1,configurable:!0}),PicaNavigatePanel.prototype.preload=function(){this.addAtlas(l.UIAtlasKey.commonKey,l.UIAtlasName.commonUrl+".png",l.UIAtlasName.commonUrl+".json");var i="cn";this.isZh_CN||(i="en"),this.addAtlas(this.key_lang,"pica_navigate/pica_navigate_"+i+".png","pica_navigate/pica_navigate_"+i+".json"),t.prototype.preload.call(this)},PicaNavigatePanel.prototype.init=function(){this.mBackground=this.createImage(l.UIAtlasKey.commonKey,"menu_bg"),this.mBackground.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.mMapBtn=this.createButton(this.key_lang,"map_btn"),this.mShopBtn=this.createButton(this.key_lang,"shop_btn"),this.mBagBtn=this.createButton(this.key_lang,"bag_btn"),this.mFamilyBtn=this.createButton(this.key_lang,"family_btn"),this.mGoHomeBtn=this.createImage(this.key_lang,"home_btn").setInteractive(),this.mCloseBtn=this.createImage(l.UIAtlasKey.commonKey,"close_1").setInteractive();var i,o=[this.mMapBtn,this.mShopBtn,this.mBagBtn,this.mFamilyBtn,this.mGoHomeBtn];this.add([this.mBackground]),this.add(o),this.add(this.mCloseBtn);for(var r=0;r<o.length;r++)0===r?o[r].x=10.33*this.dpr+.5*o[r].width:(i=o[r-1],o[r].x=i.x+12*this.dpr+.5*(o[r].width+i.width));var a=this.scale;this.resize(this.mBackground.width*a,this.mBackground.height*a),t.prototype.init.call(this)},PicaNavigatePanel.prototype.createButton=function(t,i){var o;return(o=this.isZh_CN?this.createImage(t,i):this.createSprite(t,i)).setInteractive(),o},PicaNavigatePanel.prototype.createImage=function(t,i){return this.scene.make.image({key:t,frame:i},!1)},PicaNavigatePanel.prototype.createSprite=function(t,i){var o=this.scene.make.sprite({key:this.key_lang,frame:i+"_1"});return this.scene.anims.create({key:i,frames:this.scene.anims.generateFrameNames(this.key_lang,{prefix:i+"_",frames:[1,3]}),duration:500,repeat:-1}),o.play(i),o},PicaNavigatePanel.prototype.onShowMapHandler=function(){this.emit("showPanel","PicaRoomList")},PicaNavigatePanel.prototype.onShowShopHandler=function(){this.emit("showPanel","Market")},PicaNavigatePanel.prototype.onShowBagHandler=function(){this.emit("showPanel","FurniBag")},PicaNavigatePanel.prototype.onShowFamilyHandler=function(){this.emit("showPanel","PicOrder")},PicaNavigatePanel.prototype.onShowGoHomeHandler=function(){this.emit("goHome")},PicaNavigatePanel.prototype.onCloseHandler=function(){this.emit("close")},PicaNavigatePanel.prototype.checkUpdateActive=function(){var t=this.mWorld.uiManager.getActiveUIData("PicHandheld");if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.updateUIState(r)}},PicaNavigatePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaNoticePanel",(function(){return u}));var r,a=o(112),h=o(113),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicaNoticePanel(i,o){return t.call(this,i,o)||this}return c(PicaNoticePanel,t),PicaNoticePanel.prototype.show=function(t){var i=this;if(this.mShowData=t,this.mInitialized){if(t&&t.length>0){var o=t[0].text;this.mContent&&this.mContent.setText(o[0].text);this.scene.cameras.main.width;this.scene.tweens.timeline({targets:this,duration:500,tweens:[{y:"-="+20*this.dpr,ease:"Bounce.easeOut"},{delay:2e3,y:"-="+20*this.dpr,ease:"Linear",alpha:0}],onComplete:function(){i.emit("close")}})}}else this.preload()},PicaNoticePanel.prototype.resize=function(){this.x=this.scene.cameras.main.width/2,this.y=170*this.dpr},PicaNoticePanel.prototype.preload=function(){this.addImage("pica_notice_bg","pica_notice/bg.png"),t.prototype.preload.call(this)},PicaNoticePanel.prototype.init=function(){var i=this.scene.make.image({key:"pica_notice_bg"},!1);this.mContent=new l.BBCodeText(this.mScene,0,0,"",{fontSize:16*this.dpr+"px",fontFamily:h.a.DEFULT_FONT,stroke:"#000000",strokeThickness:1*this.dpr,align:"center",textMask:!1,shadow:{offsetX:0,offsetY:0,color:"#000",blur:4,stroke:!0,fill:!0},wrap:{mode:"char",width:i.width*this.scale-12*this.dpr}}).setOrigin(.5,.5),this.mContent.setFontStyle("bold"),this.add([i,this.mContent]),this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this),t.prototype.init.call(this),this.resize()},PicaNoticePanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaRoomListPanel",(function(){return y})),o.d(i,"RoomDelegate",(function(){return g})),o.d(i,"RoomZoon",(function(){return v}));var r,a=o(112),h=o(113),l=o(127),c=o(114),u=o(2),p=o(115),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function PicaRoomListPanel(i,o){var r=t.call(this,i,o)||this;return r.key="pica_roomlist",r.mSelectIndex=0,r}return m(PicaRoomListPanel,t),PicaRoomListPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;this.content.x=r>>1,this.content.y=a>>1,this.mBackGround.clear(),this.mBackGround.fillStyle(7004927,0),this.mBackGround.fillRect(0,0,r,a),this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains),t.prototype.resize.call(this,r,a),this.setSize(r,a)},PicaRoomListPanel.prototype.updateRoomList=function(t){t&&this.mRoomDele.updateList(t)},PicaRoomListPanel.prototype.updateMyRoomList=function(t){t&&this.mMyRoomDele.updateList(t)},PicaRoomListPanel.prototype.addListen=function(){this.mInitialized&&(this.mCloseBtn.on("pointerup",this.onCloseHandler,this),this.mSeachBtn.on("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.removeListen=function(){this.mInitialized&&(this.mCloseBtn.off("pointerup",this.onCloseHandler,this),this.mSeachBtn.off("pointerup",this.onSeachHandler,this))},PicaRoomListPanel.prototype.destroy=function(){this.mScroller&&this.mScroller.destroy(),t.prototype.destroy.call(this)},PicaRoomListPanel.prototype.preload=function(){this.addAtlas(p.UIAtlasKey.commonKey,p.UIAtlasName.commonUrl+".png",p.UIAtlasName.commonUrl+".json"),this.addAtlas(this.key,"pica_roomlist/pica_roomlist.png","pica_roomlist/pica_roomlist.json"),t.prototype.preload.call(this)},PicaRoomListPanel.prototype.init=function(){var i=this;this.setSize(this.scaleWidth,this.scaleWidth);var o=this.mWorld.uiScale,r=this.scene.make.image({key:this.key,frame:"bg.png"},!1).setInteractive();this.mBackGround=this.scene.make.graphics(void 0,!1),this.mCloseBtn=this.scene.make.image({key:this.key,frame:"close_btn.png"},!1).setInteractive(),this.mCloseBtn.x=r.width/2-this.mCloseBtn.width/2-2*this.dpr,this.mCloseBtn.y=-r.height/2+this.mCloseBtn.height/2,this.mRoomDeleBtn=new d.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",c.a.t("room_list.visit")),this.mRoomDeleBtn.x=-54*this.dpr,this.mRoomDeleBtn.y=-r.height/2+this.mRoomDeleBtn.displayHeight/2-4*this.dpr,this.mRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:h.a.DEFULT_FONT,fontSize:14*this.dpr}),this.mRoomDeleBtn.setFontStyle("bold"),this.mMyRoomDeleBtn=new d.TabButton(this.scene,this.key,"checkbox_normal","checkbox_down",c.a.t("room_list.my")),this.mMyRoomDeleBtn.x=54*this.dpr,this.mMyRoomDeleBtn.y=this.mRoomDeleBtn.y,this.mMyRoomDeleBtn.setTextStyle({color:"#3333cc",fontFamily:h.a.DEFULT_FONT,fontSize:16*this.dpr}),this.mMyRoomDeleBtn.setFontStyle("bold");var a=new l.CheckboxGroup;a.appendItemAll([this.mRoomDeleBtn,this.mMyRoomDeleBtn]),a.on("selected",this.onSelectedHandler,this),this.mSelectIndex=0,this.mRoomContainer=this.scene.make.container(void 0,!1),this.mRoomContainer.setSize(282*this.dpr,362*this.dpr),this.mRoomContainer.y=-r.height/2+11*this.dpr*o,this.mSeachBtn=this.scene.make.image({key:this.key,frame:"seach_btn.png"},!1).setInteractive(),this.mSeachBtn.y=r.height/2-this.mSeachBtn.height/2+12*this.dpr;var u=this.scene.make.text({x:-35*this.dpr,y:this.mSeachBtn.y,text:c.a.t("room_list.seach"),style:{color:"#996600",fontFamily:h.a.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5),p=this.scene.make.text({x:35*this.dpr,y:this.mSeachBtn.y,text:c.a.t("room_list.room"),style:{color:"#996600",fontFamily:h.a.DEFULT_FONT,fontSize:14*this.dpr}},!1).setOrigin(.5);this.content=this.scene.make.container(void 0,!1),this.content.setSize(r.width,r.height),this.content.add([r,this.mRoomContainer,this.mCloseBtn,this.mSeachBtn,u,p]),this.add([this.mBackGround,this.content]),t.prototype.init.call(this),this.resize(0,0);var m=this.mRoomContainer.width*this.scale,y=this.mRoomContainer.height*this.scale,g={x:this.scaleWidth-m/this.scale>>1,y:this.content.y-this.content.height/2+20*this.dpr*this.scale,clickX:0,clickY:0,width:this.scaleWidth,height:y,boundPad0:-40*this.dpr*o,zoom:o,dpr:this.dpr,value:this.content.y,valuechangeCallback:function(t){i.mRoomContainer.y=t-i.content.y-y/2},cellupCallBack:function(t){t.onEnterRoomHandler()},overminCallbackScope:this,overminCallback:function(){i.mRoomDele&&0===i.mSelectIndex&&i.mRoomDele.overminHandler(),i.mMyRoomDele||1!==i.mSelectIndex||i.mMyRoomDele.overminHandler()}};this.mScroller=new d.BaseScroller(this.scene,this.mRoomContainer,g),this.content.add([this.mRoomDeleBtn,this.mMyRoomDeleBtn,this.mCloseBtn]),a.selectIndex(0)},PicaRoomListPanel.prototype.showRoomList=function(){this.mMyRoomDele&&(this.mMyRoomDele.removeFromContainer(),this.mMyRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mRoomDele||(this.mRoomDele=new g(this.mRoomContainer,this.mScroller,this.scene,this.mWorld,this.key,this.dpr)),this.mRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mRoomDele.addToContainer(),this.emit("getRoomList")},PicaRoomListPanel.prototype.showMyRoomList=function(){this.mRoomDele&&(this.mRoomDele.removeFromContainer(),this.mRoomDele.off("enterRoom",this.onEnterRoomHandler,this)),this.mMyRoomDele||(this.mMyRoomDele=new _(this.mRoomContainer,this.mScroller,this.mWorld,this.scene,this.key,this.dpr)),this.mMyRoomDele.on("enterRoom",this.onEnterRoomHandler,this),this.mMyRoomDele.addToContainer(),this.emit("getMyRoomList")},PicaRoomListPanel.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},PicaRoomListPanel.prototype.onSelectedHandler=function(t){if(t instanceof d.Button){switch(this.mRoomContainer.removeAll(!1),t){case this.mRoomDeleBtn:this.showRoomList(),this.mSelectIndex=0;break;case this.mMyRoomDeleBtn:this.showMyRoomList(),this.mSelectIndex=1}t.setTextColor("#996600"),this.preTabButton&&this.preTabButton.setTextColor("#3333cc"),this.preTabButton=t}},PicaRoomListPanel.prototype.onSeachHandler=function(){},PicaRoomListPanel.prototype.onCloseHandler=function(){this.emit("close")},PicaRoomListPanel}(a.BasePanel),g=function(t){function RoomDelegate(i,o,r,a,h,l){void 0===l&&(l=1);var c=t.call(this)||this;return c.mChildPad=0,c.mDpr=1,c.mHeight=0,c.mDpr=l,c.mWorld=a,c.mChildPad=0,c.mScene=r,c.mContainer=i,c.mScroller=o,c.mKey=h,c.init(),c}return m(RoomDelegate,t),RoomDelegate.prototype.addListen=function(){this.mPopularityRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.on("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.removeListen=function(){this.mPopularityRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mPlayerRoom.off("enterRoom",this.onEnterRoomHandler,this)},RoomDelegate.prototype.updateList=function(t){this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mContent&&this.mPopularityRoom.addItem(t.popularRooms,this.mChildPad)},RoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},RoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mPopularityRoom&&this.mPopularityRoom.clear(),this.mPlayerRoom&&this.mPlayerRoom.clear()},RoomDelegate.prototype.destroy=function(){this.removeListen(),this.mPlayerRoom&&this.mPopularityRoom.destroy(),this.mPopularityRoom&&this.mPopularityRoom.destroy(),this.mScroller&&this.mScroller.destroy(),this.activity&&this.activity.destroy(),t.prototype.destroy.call(this)},RoomDelegate.prototype.overminHandler=function(){var t=this.mPlayerRoom.updateItem();t&&this.mPlayerRoom.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mPlayerRoom.mRefreshRooms),this.setUpdateScrollInteractive(this.mPlayerRoom.mRefreshRooms))},RoomDelegate.prototype.setUpdateScrollInteractive=function(t){for(var i=0,o=t.length;i<o;i++){var r=t[i];this.mScroller.setInteractiveObject(r)}this.mScroller.refreshBound(this.mHeight)},RoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad+=this.activity.height/2+18*this.mDpr,this.mPopularityRoom=new P(this.mScene,this.mKey,"popularity_icon.png",c.a.t("room_list.popularity_room"),this.mDpr,this.mWorld.uiScale,0,this.mChildPad,(function(i){t.mPopularityRoom.roomList&&t.setScrollInteractive(t.mPopularityRoom.roomList),t.mHeight+=i,t.refreshPos(),t.mChildPad+=t.mPopularityRoom.height,t.mPlayerRoom.addItem(t.mContent.playerRooms,t.mChildPad)})),this.mPlayerRoom=new v(this.mScene,this.mKey,"player_icon.png",c.a.t("room_list.player_room"),this.mDpr,this.mWorld.uiScale,0,this.mChildPad,(function(i){t.mPlayerRoom.roomList&&t.setScrollInteractive(t.mPlayerRoom.roomList),t.mHeight+=i,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},RoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mPopularityRoom&&this.mPopularityRoom.showList&&(this.mContainer.add(this.mPopularityRoom.showList),this.mPopularityRoom.roomList&&this.mPopularityRoom.roomList.forEach((function(i){t.mContainer.add(i)}))),this.mPlayerRoom&&this.mPlayerRoom.showList&&(this.mContainer.add(this.mPlayerRoom.showList),this.mPlayerRoom.roomList&&this.mPlayerRoom.roomList.forEach((function(i){t.mContainer.add(i)})))},RoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomDelegate.prototype.setScrollInteractive=function(t){for(var i=0,o=t.length;i<o;i++){var r=t[i];this.mScroller.setInteractiveObject(r)}this.refreshPos()},RoomDelegate}(Phaser.Events.EventEmitter),_=function(t){function MyRoomDelegate(i,o,r,a,h,l){return void 0===l&&(l=1),t.call(this,i,o,a,r,h,l)||this}return m(MyRoomDelegate,t),MyRoomDelegate.prototype.addListen=function(){this.mMyRoom.on("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.on("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.removeListen=function(){this.mMyRoom.off("enterRoom",this.onEnterRoomHandler,this),this.mMyHistory.off("enterRoom",this.onEnterRoomHandler,this)},MyRoomDelegate.prototype.addToContainer=function(){this.addListen(),this.refreshPos()},MyRoomDelegate.prototype.removeFromContainer=function(){this.removeListen(),this.mMyRoom&&this.mMyRoom.clear(),this.mMyHistory&&this.mMyHistory.clear()},MyRoomDelegate.prototype.updateList=function(t){this.mMyRoom&&(this.mContent=t,this.mScroller.clearInteractiveObject(),this.mHeight=this.activity.height,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom.addItem(t.selfRooms,this.mChildPad))},MyRoomDelegate.prototype.overminHandler=function(){var t=this.mMyHistory.updateItem();t&&this.mMyHistory.mRefreshRooms&&(this.mHeight+=t,this.mContainer.add(this.mMyHistory.mRefreshRooms),this.setUpdateScrollInteractive(this.mMyHistory.mRefreshRooms))},MyRoomDelegate.prototype.destroy=function(){this.mMyRoom&&this.mMyRoom.destroy(),this.mMyHistory&&this.mMyHistory.destroy(),t.prototype.destroy.call(this)},MyRoomDelegate.prototype.refreshPos=function(){var t=this;this.activity&&(this.activity.setTexture(this.mKey,"activity_title.png"),this.mContainer.add(this.activity)),this.mMyRoom&&this.mMyRoom.showList&&(this.mContainer.add(this.mMyRoom.showList),this.mMyRoom.roomList&&this.mMyRoom.roomList.forEach((function(i){t.mContainer.add(i)}))),this.mMyHistory&&this.mMyHistory.showList&&(this.mContainer.add(this.mMyHistory.showList),this.mMyHistory.roomList&&this.mMyHistory.roomList.forEach((function(i){t.mContainer.add(i)})))},MyRoomDelegate.prototype.init=function(){var t=this;this.activity=this.mScene.make.image({key:this.mKey,frame:"activity_title.png"},!1),this.activity.y=this.activity.height/2+2*this.mDpr,this.mChildPad=this.activity.height+14*this.mDpr,this.mMyRoom=new b(this.mScene,this.mKey,"my_room_icon.png",c.a.t("room_list.my_room"),this.mDpr,this.mWorld.uiScale,0,this.mChildPad,(function(i){t.mMyRoom.roomList&&t.setScrollInteractive(t.mMyRoom.roomList),t.mHeight+=i,t.refreshPos(),t.mChildPad+=t.mMyRoom.height,t.mMyHistory.addItem(t.mContent.historyRooms,t.mChildPad)})),this.mMyHistory=new v(this.mScene,this.mKey,"history_icon.png",c.a.t("room_list.my_history"),this.mDpr,this.mWorld.uiScale,0,this.mChildPad,(function(i){t.mMyHistory.roomList&&t.setScrollInteractive(t.mMyHistory.roomList),t.mHeight+=i,t.refreshPos(),t.mScroller.refreshBound(t.mHeight),t.mScroller.setValue(t.mContainer.parentContainer.y)})),this.mScroller.refreshBound(this.activity.height),this.mScroller.setValue(this.mContainer.parentContainer.y)},MyRoomDelegate.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},MyRoomDelegate}(g),v=function(t){function RoomZoon(i,o,r,a,l,c,u,p,d){void 0===u&&(u=0),void 0===p&&(p=0);var m=t.call(this)||this;return m.mWidth=0,m.mHeight=0,m.mPad1=0,m.mShowList=[],m.mScene=i,m.mKey=o,m.mDpr=l,m.uiScale=c,m.mPad=p,m.mOrientaction=u,m.mIconFrame=r,m.mLabel=a,m.icon=i.make.image({key:o,frame:r},!1),m.icon.x=u?-254*l/2+p:-254*l/2,m.icon.y=u?0:p,m.text=i.make.text({text:a,style:{color:"#ffcc33",fontSize:16*l,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,.5),m.text.setStroke("#663300",2*l),m.text.x=u?m.icon.x+m.icon.width/2+4*l+p:m.icon.x+m.icon.width/2+4*l,m.text.y=u?0:p,m.mWidth=m.icon.width,m.mHeight=m.icon.height,m.mAddCallBack=d,m.mRooms=[],m}return m(RoomZoon,t),Object.defineProperty(RoomZoon.prototype,"showList",{get:function(){return this.mShowList},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"roomList",{get:function(){return this.mRooms},enumerable:!1,configurable:!0}),RoomZoon.prototype.addItem=function(t,i){void 0===i&&(i=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+i:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:i,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+i:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:i,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=i||this.mPad,this.mPad1=i;var o=this.uiScale,r=this.mOrientaction?this.mPad+i:0,a=6*this.mDpr*o;if(t.length>0){var l=t.length;this.mPad+=this.icon.height+12*this.mDpr*o;for(var c=0;c<l;c++)if(c*(w.Hei+a)+this.mPad<=362*this.mDpr+w.Hei+a){var u=new w(this.mScene,this.mKey,this.mDpr);u.setInfo(t[0]),t.splice(0,1),u.on("enterRoom",this.onEnterRoomHandler,this),u.x=r;var p=c*(w.Hei+a)+this.mPad;this.mRooms.push(u),u.y=p,this.mHeight+=w.Hei+a}this.mRoomDatas=t}this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},RoomZoon.prototype.updateItem=function(){var t=this.mRoomDatas.slice(0,10),i=t.length;if(i<1)return 0;var o=this.uiScale,r=this.mOrientaction?this.mPad+this.mPad1:0,a=6*this.mDpr*o,h=this.mRooms.length;this.mRefreshRooms=[];for(var l=0,c=0;c<i;c++){var u=new w(this.mScene,this.mKey,this.mDpr);u.setInfo(t[c]),u.on("enterRoom",this.onEnterRoomHandler,this),u.x=r;var p=(c+h)*(w.Hei+a)+this.mPad;u.y=p,this.mRefreshRooms.push(u),this.mRooms.push(u),this.mHeight+=w.Hei+a,l+=w.Hei+a}return this.mRoomDatas.splice(0,10),l},Object.defineProperty(RoomZoon.prototype,"width",{get:function(){return this.mWidth},enumerable:!1,configurable:!0}),Object.defineProperty(RoomZoon.prototype,"height",{get:function(){return this.mHeight},enumerable:!1,configurable:!0}),RoomZoon.prototype.destroy=function(){this.clear(),t.prototype.destroy.call(this)},RoomZoon.prototype.clear=function(){for(var t=0,i=this.mRooms;t<i.length;t++){i[t].destroy()}for(var o=0,r=this.mShowList;o<r.length;o++){r[o].destroy()}this.icon.destroy(),this.text.destroy(),this.mShowList.length=0,this.mRooms.length=0},RoomZoon.prototype.onEnterRoomHandler=function(t){this.emit("enterRoom",t)},RoomZoon}(Phaser.Events.EventEmitter),b=function(t){function MyRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return m(MyRoomZoon,t),MyRoomZoon.prototype.addItem=function(t,i){void 0===i&&(i=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+i:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:i,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+i:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:i,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=i||this.mPad;var o=this.uiScale,r=this.mOrientaction?this.mPad+i:0,a=6*this.mDpr*o;if(t.length>0){this.mPad+=this.icon.height+14*this.mDpr*o;for(var l=0;l<t.length;l++){var c=new S(this.mScene,this.mKey,this.mDpr);c.setInfo(t[l]),c.on("enterRoom",this.onEnterRoomHandler,this),c.x=r;var u=l*(w.Hei+a)+this.mPad;c.y=u,this.mRooms[l]=c,this.mHeight+=w.Hei+a}}this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight)},MyRoomZoon}(v),P=function(t){function PopularRoomZoon(){return null!==t&&t.apply(this,arguments)||this}return m(PopularRoomZoon,t),PopularRoomZoon.prototype.addItem=function(t,i){void 0===i&&(i=0),this.icon=this.mScene.make.image({key:this.mKey,frame:this.mIconFrame},!1),this.text=this.mScene.make.text({text:this.mLabel,style:{color:"#ffcc33",fontSize:16*this.mDpr,fontFamily:h.a.DEFULT_FONT}},!1).setOrigin(0,.5),this.text.setStroke("#663300",2*this.mDpr),this.icon.x=this.mOrientaction?-254*this.mDpr/2+i:-254*this.mDpr/2,this.icon.y=this.mOrientaction?0:i,this.text.x=this.mOrientaction?this.icon.x+this.icon.width/2+4*this.mDpr+i:this.icon.x+this.icon.width/2+4*this.mDpr,this.text.y=this.mOrientaction?0:i,this.mShowList.push(this.icon),this.mShowList.push(this.text),this.mHeight=this.icon.height,this.mPad=i||this.mPad;var o=this.uiScale,r=this.mOrientaction?this.mPad:0,a=6*this.mDpr*o;if(t.length>0){this.mPad+=this.icon.height+12*this.mDpr*o;for(var l=0;l<t.length;l++){var c=new C(this.mScene,this.mKey,this.mDpr);c.setInfo(t[l]),c.setRank(l+1),c.on("enterRoom",this.onEnterRoomHandler,this),c.x=r;var u=l*(c.height+a)+this.mPad;c.y=u,this.mHeight+=c.height+a,this.mRooms[l]=c}}return this.mHeight+=a,this.mAddCallBack&&this.mAddCallBack(this.mHeight),this.mHeight},PopularRoomZoon}(v),w=function(t){function RoomItem(i,o,r){void 0===r&&(r=1);var a=t.call(this,i)||this;return a.mKey=o,a.mDpr=r,a.init(o,r),a}return m(RoomItem,t),RoomItem.prototype.setInfo=function(t){t&&(t.name&&this.mNickName.setText(t.name),t.playerCount&&this.mCounter.setText(t.playerCount.toString())),this.mCounterIcon.x=this.mCounter.x-this.mCounter.width/2-this.mCounterIcon.width/2-4*this.mDpr,this.mRoom=t},RoomItem.prototype.roomData=function(){return this.mRoom},RoomItem.prototype.onEnterRoomHandler=function(t){this.mRoom&&this.emit("enterRoom",this.mRoom.roomId)},RoomItem.prototype.init=function(t,i){this.mBackground=this.scene.make.image({key:t,frame:"room_gray.png"},!1).setInteractive(),this.setSize(this.mBackground.width,this.mBackground.height),RoomItem.Hei=this.mBackground.height,this.mNickName=this.scene.make.text({style:{color:"#000000",fontFamily:h.a.DEFULT_FONT,fontSize:14*i}},!1),this.mNickName.x=-this.width/2+12*i,this.mNickName.y=-this.mNickName.height/2,this.mCounterIcon=this.scene.make.image({key:p.UIAtlasKey.commonKey,frame:"home_persons"},!1),this.mCounter=this.scene.make.text({style:{color:"#000000",fontFamily:h.a.DEFULT_FONT,fontSize:14*i}},!1).setOrigin(.5),this.mCounter.x=this.width/2-23*i,this.add([this.mBackground,this.mNickName,this.mCounterIcon,this.mCounter])},RoomItem.prototype.crateLabel=function(t){var i="",o="";t===u.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_LOCKED?(i="passworld_label.png",o=c.a.t("room_list.password")):t===u.op_def.EditModeRoomPrivacy.EDIT_MODE_ROOM_PRIVATE&&(i="close_label.png",o=c.a.t("room_list.close")),""!==i&&""!==o&&(this.mLabelImg=this.scene.make.image({key:this.mKey,frame:i},!1),this.mLabelText=this.scene.make.text({text:o,style:{color:"#666666",fontFamily:h.a.DEFULT_FONT,fontSize:12*this.mDpr}},!1).setOrigin(0,.5),this.add([this.mLabelImg,this.mLabelText]),this.mLabelImg.x=this.width/2-85*this.mDpr,this.mLabelText.x=this.mLabelImg.x-7*this.mDpr)},RoomItem}(Phaser.GameObjects.Container),S=function(t){function MyRoomItem(i,o,r){return void 0===r&&(r=1),t.call(this,i,o,r)||this}return m(MyRoomItem,t),MyRoomItem.prototype.init=function(i,o){t.prototype.init.call(this,i,o),this.mBackground&&this.mBackground.setFrame("room_yellow.png"),this.mNickName&&(this.mNickName.setColor("#663300"),this.mCounter.setColor("#663300"))},MyRoomItem}(w),C=function(t){function PopularRoomItem(i,o,r){return void 0===r&&(r=1),t.call(this,i,o,r)||this}return m(PopularRoomItem,t),PopularRoomItem.prototype.setRank=function(t){this.mRankImage&&(this.mRankImage.setTexture(this.mKey,"rank_"+t+".png"),this.mRankImage.x=-this.width/2+this.mRankImage.width/2-2*this.mDpr,this.add(this.mRankImage))},PopularRoomItem.prototype.init=function(i,o){t.prototype.init.call(this,i,o),this.mRankImage=this.scene.make.image(void 0,!1),this.mNickName.x=-this.width/2+37*o},PopularRoomItem}(S)},function(t,i,o){"use strict";o.r(i),o.d(i,"RoomList",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function RoomList(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(RoomList,t),RoomList.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_LIST,this.onRoomListHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_PLAYER_ENTER_ROOM_HISTORY,this.onMyRoomListHandler),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ENTER_ROOM,this.onEnterRoomResultHandler))},RoomList.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},RoomList.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},RoomList.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},RoomList.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},RoomList.prototype.sendGetRoomList=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_ROOM_LIST),i=t.content;i.page=1,i.perPage=30,this.connection.send(t)},RoomList.prototype.sendMyHistory=function(){this.connection.send(new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_PLAYER_ENTER_ROOM_HISTORY))},RoomList.prototype.sendEnterRoom=function(t,i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER_ROOM),r=o.content;r.roomId=t,r.password=i,this.connection.send(o)},RoomList.prototype.onRoomListHandler=function(t){this.mEvent.emit("roomList",t.content)},RoomList.prototype.onMyRoomListHandler=function(t){this.mEvent.emit("myRoomList",t.content)},RoomList.prototype.onEnterRoomResultHandler=function(t){this.mEvent.emit("enterRoomResult",t)},Object.defineProperty(RoomList.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),RoomList}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"ShopMediator",(function(){return d}));var r,a=o(119),h=o(110),l=o(2),c=o(318),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function ShopMediator(i,o,r){var a=t.call(this)||this;return a._perPage=50,a.isEnd=!1,a.world=r,a.mScene=o,a.mLayerManager=i,a.mUIType=u.UIType.Normal,a}return p(ShopMediator,t),ShopMediator.prototype.isSceneUI=function(){return!1},ShopMediator.prototype.resize=function(){if(this.mView)return this.mView.resize()},ShopMediator.prototype.getView=function(){return this.mView},ShopMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||this.mShow||(this.mView=new c.ShopPanel(this.mScene,this.world),this.mView.show(i),this.world.emitter.on(a.a.QUERY_PACKAGE,this.queryPackageHandler,this),this.world.emitter.on(a.a.SYNC_USER_BALANCE,this.onSyncUserBalanceHandler,this),this.requestVirtualWorldQueryPackage(i[0].id,1,c.ShopPanel.ShopSlotCount),this.mLayerManager.addToUILayer(this.mView),this.world.uiManager.checkUIState(ShopMediator.NAME,!1),t.prototype.show.call(this,i))},ShopMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},ShopMediator.prototype.hide=function(){this.mView&&(this.mShow=!1,this.world.emitter.off(a.a.QUERY_PACKAGE,this.queryPackageHandler,this),this.world.emitter.off(a.a.SYNC_USER_BALANCE,this.onSyncUserBalanceHandler,this),this.mView.hide(),this.mView=null,this.world.uiManager.checkUIState(ShopMediator.NAME,!0),t.prototype.hide.call(this))},ShopMediator.prototype.destroy=function(){this.world.emitter.off(a.a.QUERY_PACKAGE,this.queryPackageHandler,this),this.world.emitter.off(a.a.SYNC_USER_BALANCE,this.onSyncUserBalanceHandler,this),this.world=null,this.mScene=null,this._curPage=0,this.fetching=!1,this.isEnd=!1,t.prototype.destroy.call(this)},ShopMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},ShopMediator.prototype.requestVirtualWorldQueryPackage=function(t,i,o){var r=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE),a=r.content;a.id=t,a.page=i,a.perPage=o,this.world.connection.send(r)},ShopMediator.prototype.queryShopProps=function(t,i){if(void 0===t&&(t=1),void 0===i&&(i=50),!1!=!!this.mParam){this.fetching=!0;var o=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE),r=o.content;r.id=this.mParam[0].id,r.page=t,r.perPage=i,this.world.connection.send(o)}},ShopMediator.prototype.queryPackageHandler=function(t){t.items.length>0&&t.id===this.mParam[0].id?this.mView.setDataList(t):this.isEnd=!0,this.fetching=!1},ShopMediator.prototype.onShowItemHandler=function(t){for(var i=0,o=t.price;i<o.length;i++){o[i].coinType,l.op_def.CoinType.TU_DING_COIN}var r=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),a=r.content;a.uiId=this.mParam[0].id,a.componentId=t.id,this.world.connection.send(r)},ShopMediator.prototype.syncUserBalance=function(){var t=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_USER_BALANCE);this.world.connection.send(t)},ShopMediator.prototype.onChangeIndex=function(t){t>=.9&&!1===this.fetching&&!1===this.isEnd&&(this._curPage++,this.queryShopProps(this._curPage))},ShopMediator.prototype.onSyncUserBalanceHandler=function(t){this.mView},ShopMediator.prototype.onPayTuDingHandler=function(){},ShopMediator.NAME="ShopMediator",ShopMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ShopPanel",(function(){return y}));var r,a=o(112),h=o(111),l=o(330),c=o(317),u=o(117),p=o(124),d=o(125),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function ShopPanel(i,o){var r=t.call(this,i,o)||this;return r.mWorld=o,r}return m(ShopPanel,t),ShopPanel.prototype.resize=function(t,i){var o=this.mWorld.getSize();this.mWorld.game.device.os.desktop?(this.x=o.width+t>>1,this.y=o.height+i>>1):(this.mWorld.game.scale.orientation,Phaser.Scale.Orientation.LANDSCAPE,this.x=o.width+t>>1,this.y=o.height+i>>1),this.scale=this.mWorld.uiScale},ShopPanel.prototype.setDataList=function(t){this.mShopData=t,this.mInitialized&&this.refreshDataList()},ShopPanel.prototype.destroy=function(){this.mShopItemSlotList&&(this.mShopItemSlotList.forEach((function(t){t&&t.destroy()})),this.mShopItemSlotList.length=0,this.mShopItemSlotList=null),this.mShopData=null,this.mInitialized=!1,t.prototype.destroy.call(this)},ShopPanel.prototype.addListen=function(){this.mInitialized&&this.mClsBtn.on("pointerup",this.shopMedClose,this)},ShopPanel.prototype.removeListen=function(){this.mInitialized&&this.mClsBtn.off("pointerup",this.shopMedClose,this)},ShopPanel.prototype.preload=function(){this.mScene&&(this.mScene.load.image(h.d.getName(),h.d.getPNG()),this.mScene.load.image(h.a.getName(),h.a.getPNG()),this.mScene.load.atlas("itemChose",h.i.getRes("ui/bag/itemChose.png"),h.i.getRes("ui/bag/itemChose.json")),this.mScene.load.atlas("clsBtn",h.i.getRes("ui/common/common_clsBtn.png"),h.i.getRes("ui/common/common_clsBtn.json")),this.mScene.load.atlas("shopView",h.i.getRes("ui/shop/shopView.png"),h.i.getRes("ui/shop/shopView.json")),t.prototype.preload.call(this))},ShopPanel.prototype.loadComplete=function(i,o,r){var a=this.mScene.textures.get("itemChose").frames,h=[];for(var l in a){if("__BASE"!==l)a[l]&&h.push(l)}this.mScene.anims.create({key:"itemSelectFrame",frames:this.mScene.anims.generateFrameNumbers("itemChose",{start:0,end:8,frames:h}),frameRate:33,yoyo:!0,repeat:-1}),t.prototype.loadComplete.call(this,i,o,r)},ShopPanel.prototype.init=function(){var i=this.mWorld.getSize();this.mBg=new u.NinePatch(this.scene,0,0,500,350,h.a.getName(),null,h.a.getConfig()),this.mBg.x=0,this.mBg.y=0,this.setSize(this.mBg.width,this.mBg.height),this.addAt(this.mBg,0),this.mBorder=new u.NinePatch(this.scene,0,0,this.mBg.width-10,this.mBg.height-30,h.d.getName(),null,h.d.getConfig()),this.mBorder.x=this.mBg.x,this.mBorder.y=this.mBg.y+10,this.addAt(this.mBorder,1),this.mWorld.game.device.os.desktop?(this.x=i.width>>1,this.y=i.height-300):(this.mWorld.game.scale.orientation,Phaser.Scale.Orientation.LANDSCAPE,this.x=i.width>>1,this.y=i.height>>1);var o=this.mScene.make.sprite(void 0,!1);o.setTexture("shopView","shopView_titleIcon"),o.x=35+(-this.mBg.width>>1),o.y=-this.mBg.height>>1,this.add(o);var r,a,c,m=this.mScene.make.text(void 0,!1);m.setFontFamily("Tahoma"),m.setFontStyle("bold"),m.setFontSize(20),m.setText("内购商城"),m.x=o.x+o.width-10,m.y=o.y-(m.height>>1),this.add(m),this.mShopItemSlotList=[];for(var y=0;y<20;y++)a=y%5*88-this.mBg.width/2+75,c=82*Math.floor(y/5)-this.mBg.height/2+72,(r=new l.ShopItemSlot(this.mScene,this.mWorld,this,a,c,"shopView","ui/shop/shopView.png","ui/shop/shopView.json","shopView_bagSlot","itemSelectFrame")).createUI(),this.mShopItemSlotList.push(r);this.mClsBtn=new p.IconBtn(this.mScene,this.mWorld,{key:d.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/shop/shopView.png",jsonUrl:"ui/shop/shopView.json"}),this.mClsBtn.x=(this.width>>1)-65,this.mClsBtn.y=-this.height>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn),this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this),this.mShopData&&this.refreshDataList(),t.prototype.init.call(this)},ShopPanel.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.getMediator(c.ShopMediator.NAME).resize()},ShopPanel.prototype.refreshDataList=function(){if(this.mShopData)for(var t,i=ShopPanel.ShopSlotCount,o=0;o<i;o++)(t=this.mShopItemSlotList[o])&&t.shopDataChange(this.mShopData.items[o],this.mShopData.id)},ShopPanel.prototype.shopMedClose=function(){this.mWorld.uiManager.getMediator(c.ShopMediator.NAME).hide()},ShopPanel.ShopSlotCount=20,ShopPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"Task",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function Task(i){var o=t.call(this)||this;return o.world=i,o.mEvent=new Phaser.Events.EventEmitter,o}return l(Task,t),Task.prototype.register=function(){this.connection&&(this.connection.addPacketListener(this),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_QUEST_LIST,this.onRetQuestList),this.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_QUEST_DETAIL,this.onRetQuestDetail))},Task.prototype.unregister=function(){this.connection&&this.connection.removePacketListener(this)},Task.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},Task.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},Task.prototype.destroy=function(){this.unregister(),this.mEvent.destroy()},Object.defineProperty(Task.prototype,"connection",{get:function(){if(this.world)return this.world.connection},enumerable:!1,configurable:!0}),Task.prototype.queryQuestList=function(){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_QUEST_LIST);this.connection.send(t)},Task.prototype.queryQuestDetail=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_QUEST_DETAIL);i.content.id=t,this.connection.send(i)},Task.prototype.querySubmitQuest=function(t){var i=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SUBMIT_QUEST);i.content.id=t,this.connection.send(i)},Task.prototype.onRetQuestList=function(t){var i=t.content;this.mEvent.emit("questlist",i.quests)},Task.prototype.onRetQuestDetail=function(t){var i=t.content;this.mEvent.emit("questdetail",i.quest)},Task}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"TaskPanel",(function(){return _}));var r,a=o(112),h=o(113),l=o(2),c=o(115),u=o(114),p=o(116),d=o(120),m=o(111),y=o(109),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=function(t){function TaskPanel(i,o){var r=t.call(this,i,o)||this;return r.key="task_ui",r.taskItems=[],r}return g(TaskPanel,t),TaskPanel.prototype.resize=function(i,o){var r=this.scaleWidth,a=this.scaleHeight;t.prototype.resize.call(this,r,a),this.setSize(r,a),this.blackBg.clear(),this.blackBg.fillStyle(0,.5),this.blackBg.fillRoundedRect(-this.x,-this.y,r,a),this.content.x=.5*r,this.content.y=.5*a,this.mGameScroll.refreshMask(),this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0,0,r,a),Phaser.Geom.Rectangle.Contains)},TaskPanel.prototype.show=function(t){this.mShowData=t,this.mPreLoad||(this.mInitialized?this.mShow||(this.soundGroup&&this.soundGroup.open&&this.playSound(this.soundGroup.open),!this.mTweening&&this.mTweenBoo?this.showTween(!0):this.mShow=!0,this.setInteractive(),this.addListen()):this.preload())},TaskPanel.prototype.addListen=function(){this.mInitialized&&this.closeBtn.on("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.removeListen=function(){this.mInitialized&&this.closeBtn.off("pointerup",this.OnClosePanel,this)},TaskPanel.prototype.preload=function(){this.addAtlas(this.key,"task/task.png","task/task.json"),this.addAtlas(c.UIAtlasKey.commonKey,c.UIAtlasName.commonUrl+".png",c.UIAtlasName.commonUrl+".json"),t.prototype.preload.call(this)},TaskPanel.prototype.init=function(){this.setSize(this.scaleWidth,this.scaleWidth),this.blackBg=this.scene.make.graphics(void 0,!1),this.add(this.blackBg);var i=300*this.dpr,o=418*this.dpr;this.content=this.scene.make.container(void 0,!1),this.content.setSize(i,o),this.add(this.content),this.bg=new y.NineSlicePatch(this.scene,0,0,i,o,c.UIAtlasKey.commonKey,"bg",{left:40,top:40,bottom:50,right:50});var r=this.bg.width,a=this.bg.height,l=.5*-this.bg.height;this.titlebg=this.scene.make.image({x:0,y:l,key:this.key,frame:"title"}),this.titlebg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.titlebg.y=l-.5*this.titlebg.height+20*this.dpr;var p="bold "+15*this.dpr+"px Source Han Sans";this.tilteName=this.scene.make.text({x:0,y:l-12*this.dpr,text:u.a.t("task.title"),style:{font:p,color:"#8F4300",fontSize:15*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(.5,0),this.closeBtn=this.scene.make.image({x:.5*this.bg.width-5*this.dpr,y:l+5*this.dpr,key:c.UIAtlasKey.commonKey,frame:"close"}),this.tilteName.setStroke("#8F4300",1),this.tilteName.setResolution(this.dpr),this.closeBtn.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.closeBtn.setInteractive();var d=this.scene.make.container(void 0,!1);d.setSize(80*this.dpr,30*this.dpr),d.setPosition(.5*-r+70*this.dpr,.5*-a+30*this.dpr),d.setInteractive(),d.on("pointerup",this.onOpenOptionHandler,this),this.optionText=this.scene.make.text({x:-30*this.dpr,y:0,text:u.a.t("task.all_task"),style:{color:"#8F4300",fontSize:16*this.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),this.optionArrow=this.scene.make.image({x:0,y:0,key:this.key,frame:"drop_down"}),this.optionArrow.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),this.optionArrow.x=this.optionText.x+30*this.dpr,d.add([this.optionText,this.optionArrow]);var m=253*this.dpr,g=this.scene.make.graphics(void 0,!1);g.clear(),g.fillStyle(12632256,1),g.fillRect(.5*-m,-1,m,2),g.y=.5*-a+50*this.dpr,this.optionCon=this.scene.make.container(void 0,!1),this.optionCon.visible=!1,this.optionCon.y=.5*-a+50*this.dpr,this.mGameScroll=new y.GameScroller(this.scene,{x:0,y:18*this.dpr,width:r,height:a-70*this.dpr,zoom:this.scale,dpr:this.dpr,align:2,orientation:0,space:20*this.dpr}),this.content.add([this.bg,this.closeBtn,this.titlebg,this.tilteName,this.mGameScroll,d,g,this.optionCon]),this.resize(),t.prototype.init.call(this),this.emit("questlist")},TaskPanel.prototype.setTaskDatas=function(t){this.mInitialized&&(this.curTaskItem&&this.curTaskItem.setExtend(!1),this.taskDatas=t,this.setTaskOptions(),this.setTaskItems(t),this.onTaskOptionHandler(this.curOptionItem))},TaskPanel.prototype.setTaskOptions=function(){var t=[0],i=l.op_pkt_def.PKT_Quest_Type;for(var o in i){var r=Number(o);if(!isNaN(r)){var a=r;t.push(a)}}for(var h=this.optionCon.list,c=0,u=h;c<u.length;c++){(m=u[c]).visible=!1}for(var p=0;p<t.length;p++){var m=void 0;p<h.length?m=h[p]:((m=new w(this.scene,this.key,this.dpr)).setHandler(new d.a(this,this.onTaskOptionHandler)),this.optionCon.add(m)),m.visible=!0,m.setOptionData(t[p])}for(var y=0,g=0,_=h;g<_.length;g++){var v=_[g];v.y=v.height*v.originY+y,y+=v.height+2}this.curOptionItem||(this.curOptionItem=h[0])},TaskPanel.prototype.setTaskDetail=function(t){this.curTaskItem&&t&&this.curTaskItem.questData.id===t.id&&this.curTaskItem.setTaskDetail(t)},TaskPanel.prototype.setTaskItems=function(t){for(var i=0,o=this.taskItems;i<o.length;i++){(a=o[i]).visible=!1}for(var r=0;r<t.length;r++){var a=void 0;r<this.taskItems.length?a=this.taskItems[r]:(a=new v(this.scene,this.key,this.dpr),this.mGameScroll.addItem(a),a.setHandler(new d.a(this,this.onExtendsHandler),new d.a(this,this.onFinishHandler)),this.taskItems.push(a)),a.setTaskData(t[r]),a.visible=!0}this.mGameScroll.Sort()},TaskPanel.prototype.destroy=function(){t.prototype.destroy.call(this)},TaskPanel.prototype.OnClosePanel=function(){this.emit("hide")},TaskPanel.prototype.onFinishHandler=function(t){this.emit("submitquest",t)},TaskPanel.prototype.onExtendsHandler=function(t,i){this.curTaskItem&&this.curTaskItem.setExtend(!1,!1),this.curTaskItem=i,t?this.emit("questdetail",i.questData.id):this.curTaskItem=null,this.mGameScroll.Sort(!0)},TaskPanel.prototype.onOpenOptionHandler=function(){var t=this.optionCon.visible;this.optionCon.visible=!t,this.optionArrow.scaleY=t?-1:1},TaskPanel.prototype.onTaskOptionHandler=function(t){for(var i=0,o=this.optionCon.list;i<o.length;i++){o[i].changeNormal()}var r;r=0===t.optionData?this.taskDatas:this.taskDatas.filter((function(i){return i.questType===t.optionData})),this.setTaskItems(r),this.optionCon.visible=!1,this.curOptionItem=t,t.changeDown(),this.optionText.text=t.optionText,this.optionArrow.x=this.optionText.x+this.optionText.width+10*this.dpr},TaskPanel}(a.BasePanel),v=function(t){function TaskItem(i,o,r){var a=t.call(this,i)||this;a.key=o,a.dpr=r;var l=254*r,c=45*r;a.content=i.make.container(void 0,!1),a.content.setSize(l,c),a.bg=new y.NineSlicePatch(a.scene,0,0,l,c,o,"main_bg",{left:6*r,top:6*r,bottom:6*r,right:6*r});var d=.5*-l,m=.5*-c,g=i.make.image({key:o,frame:"head_border"});return g.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),g.x=d+25*r,a.headIcon=new p.DynamicImage(i,g.x,0),a.headIcon.setTexture(o,"head_test"),a.typeBg=i.make.image({key:o,frame:"tag_main"}),a.typeBg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.typeBg.setPosition(d+.5*a.typeBg.width,m+.5*a.typeBg.height-2*r),a.typeTex=i.make.text({x:0,y:0,text:u.a.t("task.m"),style:{color:"#ffffff",fontSize:10*a.dpr,fontFamily:h.a.DEFULT_FONT}}),a.typeTex.setOrigin(.5).setPosition(a.typeBg.x-1*r,a.typeBg.y),a.taskName=i.make.text({x:a.headIcon.x+20*r,y:-9*r,text:"",style:{color:"#ffffff",fontSize:13*a.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),a.taskDes=i.make.text({x:a.headIcon.x+25*r,y:10*r,text:"",style:{color:"#ffffff",fontSize:12*a.dpr,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),a.finish=i.make.image({key:o,frame:"done"}),a.finish.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.finish.setPosition(.5*l-30*r,4*r),a.openBtn=new y.Button(i,o,"open","open"),a.setExtendBtn(a.openBtn),a.openBtn.setPosition(.5*l-25*r,4*r),a.closeBtn=new y.Button(i,o,"close"),a.setExtendBtn(a.closeBtn),a.closeBtn.setPosition(a.openBtn.x,a.openBtn.y).visible=!1,a.openBtn.on("Tap",a.onOpenHandler,a),a.closeBtn.on("Tap",a.onCloseHandler,a),a.content.add([a.bg,g,a.headIcon,a.typeBg,a.typeTex,a.taskName,a.taskDes,a.finish,a.openBtn,a.closeBtn]),a.add(a.content),a.setSize(l,c),a}return g(TaskItem,t),TaskItem.prototype.setTaskData=function(t){this.questData=t;var i=this.getQuestTypeTag(t.questType);this.typeBg.setFrame(i[0]),this.typeTex.text=i[1],this.setTextLimit(this.taskName,i[2]+t.name,12),this.bg.setFrame(i[3]),this.setTextLimit(this.taskDes,t.detail),this.taskDes.setColor(i[4]),this.finish.visible=t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItem.prototype.setTaskDetail=function(t){var i=this.getQuestTypeTag(t.questType);this.extend&&this.extend.setItemData(t,i[5])},TaskItem.prototype.setHandler=function(t,i){this.extendHandler=t,this.finishHandler=i},TaskItem.prototype.setExtend=function(t,i){void 0===i&&(i=!0),t?i?this.onOpenHandler():this.openExtend():i?this.onCloseHandler():this.closeExtend()},TaskItem.prototype.onOpenHandler=function(){this.openExtend(),this.extendHandler&&this.extendHandler.runWith([!0,this])},TaskItem.prototype.openExtend=function(){this.extend||(this.extend=new b(this.scene,this.key,this.dpr),this.extend.setFinishHandler(new d.a(this,this.onFinishHandler)),this.add(this.extend),this.extend.y=.5*this.height+.5*this.extend.height),this.extend.visible=!0,this.height=this.content.height+this.extend.height,this.content.y=.5*-this.height+.5*this.content.height,this.extend.y=.5*-this.height+this.content.height+.5*this.extend.height,this.openBtn.visible=!1,this.closeBtn.visible=!0},TaskItem.prototype.setExtendBtn=function(t){var i=60*this.dpr,o=60*this.dpr,r=this.scene.make.graphics(void 0,!1);r.clear(),r.fillStyle(16185078,0),r.fillRect(.5*-i,.5*-o,i,o),t.addAt(r,0),t.setInteractive(new Phaser.Geom.Rectangle(0,0,i,o),Phaser.Geom.Rectangle.Contains)},TaskItem.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.runWith(this.questData.id)},TaskItem.prototype.onCloseHandler=function(){this.closeExtend(),this.extendHandler&&this.extendHandler.runWith([!1,this])},TaskItem.prototype.closeExtend=function(){this.extend&&(this.extend.visible=!1),this.height=this.content.height,this.content.y=0,this.openBtn.visible=!0,this.closeBtn.visible=!1},TaskItem.prototype.getQuestTypeTag=function(t){var i=[];return t===l.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?(i[0]="tag_main",i[1]=u.a.t("task.m"),i[2]=""+u.a.t("task.main"),i[3]="main_bg",i[4]="#4C42C8",i[5]="#8780E0",i):t===l.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?(i[0]="tag_side",i[1]=u.a.t("task.s"),i[2]=u.a.t("task.side"),i[3]="side_bg",i[4]="#CB0A1D",i[5]="#F4919B",i):t===l.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?(i[0]="tag_daly",i[1]=u.a.t("task.d"),i[2]=u.a.t("task.daily"),i[3]="daly_bg",i[4]="#866107",i[5]="#F1D56C",i):void 0},TaskItem.prototype.setTextLimit=function(t,i,o){if(void 0===o&&(o=15),i.length>o)for(var r=155*this.dpr,a=4;a<i.length;a++){var h=i.slice(0,a);if(t.setText(h).width>r){h+="...",t.setText(h);break}}else t.setText(i)},TaskItem}(Phaser.GameObjects.Container),b=function(t){function TaskItemExtend(i,o,r){var a=t.call(this,i)||this;a.needArr=[],a.rewardArr=[],a.dpr=0;var l=253*r,p=202*r;a.dpr=r;var d=new y.NineSlicePatch(a.scene,0,0,l,p,o,"detail_bg",{left:4,top:4,right:4,bottom:4}),m=.5*-l+10*r,g=.5*-p+5*r;a.taskLabel=i.make.text({x:m,y:g,text:u.a.t("task.objective"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:h.a.DEFULT_FONT}}),a.taskTex=i.make.text({x:m,y:g+18*r,text:u.a.t("task.collect_materials"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:h.a.DEFULT_FONT}}),a.taskTex.setWordWrapWidth(l-10*r,!0),a.rewardLabel=i.make.text({x:m,y:g+90*r,text:u.a.t("task.rewards"),style:{color:"#8F4300",fontSize:12*a.dpr,fontFamily:h.a.DEFULT_FONT}});var _=i.make.image({key:o,frame:"reward_cutline"});return _.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),_.setPosition(0,g+110*r),a.line=_,a.finishBtn=new y.NineSliceButton(a.scene,Math.ceil(.5*l-40*a.dpr),Math.ceil(.5*p-25*a.dpr),60*a.dpr,30*a.dpr,c.UIAtlasKey.commonKey,"button_g",u.a.t("task.submit_task"),a.dpr,a.scale,{left:12*a.dpr,top:12*a.dpr,right:12*a.dpr,bottom:12*a.dpr}),a.finishBtn.setTextStyle({fontSize:12*r,color:"#000000"}),a.finishBtn.on("Tap",a.onFinishHandler,a),a.add([d,a.taskLabel,a.taskTex,a.rewardLabel,_,a.finishBtn]),a.setSize(l,p),a.key=o,a.finishBtn.visible=!1,a}return g(TaskItemExtend,t),TaskItemExtend.prototype.setItemData=function(t,i){this.taskLabel.setColor(i),this.taskTex.setColor(i),this.rewardLabel.setColor(i);var o=0,r=33*this.dpr;this.taskTex.text=this.getTaskTargetText(t),this.createTaskCells(this.needArr,t.targets,!0),o=this.taskTex.y+this.taskTex.height+5*this.dpr,t.targets.length>0&&(o+=.5*r,this.sortItem(this.needArr,o),o+=.5*r+8*this.dpr),this.rewardLabel.y=o,o+=this.rewardLabel.height+5*this.dpr,this.line.y=o,o+=5*this.dpr,this.createTaskCells(this.rewardArr,t.rewards,!1),o+=.5*r,this.sortItem(this.rewardArr,o),this.finishBtn.visible=t.stage===l.op_pkt_def.PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED},TaskItemExtend.prototype.setFinishHandler=function(t){this.finishHandler=t},TaskItemExtend.prototype.sortItem=function(t,i){void 0===i&&(i=0);for(var o=.5*-this.width+10*this.dpr,r=t,a=0,h=10*this.dpr,l=0,c=r;l<c.length;l++){var u=c[l];u.x=o+u.width*u.originX+a,u.y=i,a+=u.width+h}},TaskItemExtend.prototype.createTaskCells=function(t,i,o){void 0===o&&(o=!0);for(var r=0,a=t;r<a.length;r++){(l=a[r]).visible=!1}for(var h=0;h<i.length;h++){var l=void 0;h<t.length?l=t[h]:(l=new P(this.scene,this.key,this.dpr),t.push(l),this.add(l)),l.visible=!0,l.setCellData(i[h],o)}return t},TaskItemExtend.prototype.onFinishHandler=function(){this.finishHandler&&this.finishHandler.run()},TaskItemExtend.prototype.getTaskTargetText=function(t){t.targets;return t.detail},TaskItemExtend}(Phaser.GameObjects.Container),P=function(t){function TaskCell(i,o,r){var a=t.call(this,i)||this;return a.key=o,a.dpr=r,a.bg=i.make.image({key:o,frame:"task_bg"}),a.bg.texture.setFilter(Phaser.Textures.FilterMode.LINEAR),a.setSize(a.bg.width,a.bg.height),a.itemIcon=new p.DynamicImage(i,0,0),a.countTex=new y.BBCodeText(a.scene,0,0).setOrigin(.5).setFontSize(12*r).setFontFamily(h.a.DEFULT_FONT),a.countTex.setPosition(.5*a.width,.5*a.height-2*r),a.add([a.bg,a.itemIcon,a.countTex]),a}return g(TaskCell,t),TaskCell.prototype.setCellData=function(t,i){var o=this;void 0===i&&(i=!0);var r=i?"task_bg":"reward_bg";this.bg.setTexture(this.key,r);var a=m.i.getOsdRes(t.display.texturePath);this.itemIcon.load(a,this,(function(){o.itemIcon.scale=.6*o.dpr})),this.countTex.text=i?this.getCountText(t.count,t.neededCount):"[stroke=#666666][color=#666666]"+t.count+"[/color][/stroke]/"},TaskCell.prototype.getCountText=function(t,i){var o=t>=i?"#0054FF":"#FF2B2B";return"[stroke="+o+"][color="+o+"]"+t+"[/color][/stroke]"+"/"+("[stroke=#2D2D2D][color=#2D2D2D]"+i+"[/color][/stroke]")},TaskCell}(Phaser.GameObjects.Container),w=function(t){function TaskOption(i,o,r){var a=t.call(this,i)||this;a.dpr=0;var l=256*r,c=30*r;a.dpr=r,a.bg=i.make.graphics(void 0,!1),a.text=i.make.text({x:0,y:0,text:"全部",style:{color:"#666666",fontSize:15*r,fontFamily:h.a.DEFULT_FONT}}).setOrigin(0,.5),a.bg.clear(),a.bg.fillStyle(16185078,1),a.bg.fillRect(.5*-l,.5*-c,l,c);var u=a.scene.make.graphics(void 0,!1);return u.clear(),u.fillStyle(13421772,1),u.fillRect(.5*-l,.5*c,l,2),a.add([a.bg,a.text,u]),a.setSize(l,c),a.bg.setInteractive(new Phaser.Geom.Rectangle(.5*-l,.5*-c,l,c),Phaser.Geom.Rectangle.Contains),a.bg.on("pointerup",a.onClickHandler,a),a}return g(TaskOption,t),TaskOption.prototype.setSize=function(i,o){return t.prototype.setSize.call(this,i,o),this.text.setPosition(.5*-i+20*this.dpr,0),this.changeNormal(),this},TaskOption.prototype.setOptionData=function(t){this.optionData=t,t===l.op_pkt_def.PKT_Quest_Type.QUEST_MAIN_MISSION?this.text.text=u.a.t("task.main_quest"):t===l.op_pkt_def.PKT_Quest_Type.QUEST_SIDE_MISSION?this.text.text=u.a.t("task.side_quest"):t===l.op_pkt_def.PKT_Quest_Type.QUEST_DAILY_GOAL?this.text.text=u.a.t("task.daily_quest"):this.text.text=u.a.t("task.all_task"),this.optionText=this.text.text},TaskOption.prototype.changeDown=function(){this.bg.clear(),this.bg.fillStyle(14673663,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.changeNormal=function(){this.bg.clear(),this.bg.fillStyle(16185078,1),this.bg.fillRect(.5*-this.width,.5*-this.height,this.width,this.height)},TaskOption.prototype.setHandler=function(t){this.clickHandler=t},TaskOption.prototype.onClickHandler=function(){this.clickHandler&&this.clickHandler.runWith(this)},TaskOption}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"UserInfoMediator",(function(){return u}));var r,a=o(322),h=o(119),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function UserInfoMediator(i,o,r){var a=t.call(this)||this;return a.mLayerManager=i,a.mScene=o,a.world=r,a}return c(UserInfoMediator,t),UserInfoMediator.prototype.getView=function(){return this.mView},UserInfoMediator.prototype.hide=function(){this.mShow=!1,this.world.emitter.off(h.a.SCENE_BACKGROUND_CLICK,this.onClosePanel,this),this.mView&&(this.mView.hide(),this.mView=null)},UserInfoMediator.prototype.isSceneUI=function(){return!1},UserInfoMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},UserInfoMediator.prototype.resize=function(){this.mView&&this.mView.resize()},UserInfoMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||i&&0!==i.length&&(this.mView=new a.UserInfoPanel(this.mScene,this.world),this.mView.show(i[0]),this.mLayerManager.addToUILayer(this.mView),this.world.emitter.on(h.a.SCENE_BACKGROUND_CLICK,this.onClosePanel,this),t.prototype.show.call(this,i))},UserInfoMediator.prototype.destroy=function(){this.mView&&this.mView.destroy()},UserInfoMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},UserInfoMediator.prototype.onClosePanel=function(){this.hide()},UserInfoMediator.NAME="UserInfoMediator",UserInfoMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"UserInfoPanel",(function(){return y}));var r,a=o(112),h=o(116),l=o(111),c=o(113),u=o(121),p=o(321),d=o(109),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function UserInfoPanel(i,o){var r=t.call(this,i,o)||this;return r.mBadgeImages=[],r.mWorld=o,r}return m(UserInfoPanel,t),UserInfoPanel.prototype.show=function(i){t.prototype.show.call(this,i),this.setData("data",i),this.setInfo(i)},UserInfoPanel.prototype.hide=function(){this.clearBadge(),t.prototype.hide.call(this)},UserInfoPanel.prototype.resize=function(t,i){var o=this.mWorld.getSize();this.x=o.width-this.width-8,this.y=o.height-100-this.height},UserInfoPanel.prototype.setInfo=function(t){var i=this;if(this.mInitialized&&t&&0!==t.actors.length){var o=t.actors[0];this.mWorld.httpService.userDetail(o.platformId).then((function(t){if(200===t.code){var o=t.data;o&&(i.mActor.load(l.i.getOsdRes("show/"+o.username+".png"),i,void 0,i.loadDefaultAvatar),i.mNickName.setText(o.nickname),i.mLv.setText(o.level))}})),this.mWorld.httpService.badgecards(o.platformId).then((function(t){200===t.code&&i.createBadge(t.data)})),this.updateFollwer(o.platformId)}},UserInfoPanel.prototype.destroy=function(){this.mActor&&(this.mActor.destroy(!0),this.mActor=null),this.mBadgeImages&&(this.mBadgeImages.forEach((function(t){t.destroy(!0),t=null})),this.mBadgeImages=[]),this.mNickName&&(this.mNickName.destroy(!0),this.mNickName=null),this.mLv&&(this.mLv.destroy(!0),this.mLv=null),this.mFollwerBtn&&(this.mFollwerBtn.destroy(!0),this.mFollwerBtn=null),this.mWorld=null,t.prototype.destroy.call(this)},UserInfoPanel.prototype.preload=function(){this.scene.load.image(l.d.getName(),l.d.getPNG()),this.scene.load.image(l.a.getName(),l.a.getPNG()),this.scene.load.atlas(l.c.getName(),l.c.getPNG(),l.c.getJSON()),t.prototype.preload.call(this)},UserInfoPanel.prototype.init=function(){this.setSize(359,199);var i=new d.NinePatch(this.scene,{width:359,height:199,key:l.a.getName(),columns:l.a.getColumns(),rows:l.a.getRows()}).setOrigin(0,0);this.add(i);var o=new d.NinePatch(this.scene,{x:7,y:19,width:345,height:173,key:l.d.getName(),columns:l.d.getColumns(),rows:l.d.getRows()}).setOrigin(0,0);this.add(o);var r=this.scene.make.text({x:20,y:-5,text:"昵称：",stroke:"#000000",strokeThickness:2,style:{color:"#b4b4b4",font:c.a.YAHEI_18_BOLD}},!1);this.add(r);var a=this.scene.make.text({x:20,y:30,text:"等级：",stroke:"#000000",strokeThickness:2,color:"#b4b4b4",style:{color:"#b4b4b4",font:c.a.YAHEI_18_BOLD}},!1);this.add(a),this.mNickName=this.scene.make.text({x:r.x+50,y:r.y,stroke:"#000000",strokeThickness:2,color:"#FFFFFF",style:{font:c.a.YAHEI_18_BOLD}},!1),this.add(this.mNickName),this.mLv=this.scene.make.text({x:a.x+50,y:a.y,stroke:"#000000",strokeThickness:2,color:"#FFFFFF",style:{font:c.a.YAHEI_18_BOLD}}),this.add(this.mLv),this.mFollwerBtn=new u.NinePatchButton(this.scene,258,145,80,34,l.c.getName(),l.c.getName(),"关注",l.c.getConfig()),this.mFollwerBtn.x=258+(this.mFollwerBtn.width>>1),this.mFollwerBtn.y=145+(this.mFollwerBtn.height>>1),this.mFollwerBtn.setTextStyle({font:c.a.YAHEI_16_BOLD}),this.add(this.mFollwerBtn),this.mActor=new h.DynamicImage(this.scene,300,125).setOrigin(.5,1),this.mActor.scale=2,this.add(this.mActor),this.mWorld.uiManager.getMediator(p.UserInfoMediator.NAME).resize(),t.prototype.init.call(this),this.setInfo(this.getData("data"))},UserInfoPanel.prototype.updateFollwer=function(t){var i=this,o=this.mWorld.roomManager.currentRoom.playerManager.actor.model;o&&t!==o.platformId&&this.mWorld.httpService.checkFollowed([t]).then((function(o){200===o.code&&(o.data.length>0?i.mFollwerBtn.setText("取消关注"):i.mFollwerBtn.setText("关注"),i.mFollwerBtn.setData("node",{text:i.mFollwerBtn.getText(),platformId:t}))}))},UserInfoPanel.prototype.createBadge=function(t){if(t)for(var i=0;i<t.length;i++){var o=new h.DynamicImage(this.scene,70*i+60,100);o.load(l.i.getOsdRes(t[i].target_entity.thumbnail)),this.add(o),this.mBadgeImages.push(o)}},UserInfoPanel.prototype.loadDefaultAvatar=function(){this.mActor.load(l.i.getOsdRes("show/avatar_default.png"))},UserInfoPanel.prototype.clearBadge=function(){for(var t=0,i=this.mBadgeImages;t<i.length;t++){var o=i[t];o.destroy(),this.remove(o)}this.mBadgeImages.length=0},UserInfoPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"MenuItem",(function(){return u}));var r,a=o(121),h=o(117),l=o(111),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function MenuItem(i,o,r,a,h,l,c,u){return t.call(this,i,o,r,a,h,l,"",c,u)||this}return c(MenuItem,t),MenuItem.prototype.appendItem=function(t){this.mChild||(this.mMenus=[],this.mChild=this.scene.make.container(void 0,!1),this.mArrow=this.scene.make.image({x:this.width*this.originX-3,key:"usermenu_arrow"}),this.add(this.mArrow),this.mBackground=new h.NinePatch(this.scene,0,0,0,0,l.d.getName(),null,l.d.getConfig())),this.mChild.add(t),this.mMenus.push(t),this.mBackground.resize(74,32*this.mMenus.length),this.mBackground.x=this.mBackground.width,this.mBackground.y=this.mBackground.height/2-16,this.mChild.addAt(this.mBackground,0),this.mChild.setInteractive(new Phaser.Geom.Rectangle(0,0,this.mBackground.width,this.mBackground.height),Phaser.Geom.Rectangle.Contains)},MenuItem.prototype.show=function(){this.add(this.mChild)},MenuItem.prototype.destroy=function(i){if(this.mMenus){for(var o=this.mMenus.length,r=0;r<o;r++){var a=this.mMenus[r];a&&(a.destroy(!0),a=null)}this.mMenus=[]}this.mBackground&&(this.mBackground.destroy(),this.mBackground=null),this.mChild&&(this.mChild.destroy(!0),this.mChild=null),this.mArrow&&(this.mArrow.destroy(!0),this.mArrow=null),t.prototype.destroy.call(this,i)},Object.defineProperty(MenuItem.prototype,"menus",{get:function(){return this.mMenus||[]},enumerable:!1,configurable:!0}),MenuItem}(a.NinePatchButton)},function(t,i,o){"use strict";o.r(i),o.d(i,"StorageMediator",(function(){return c}));var r,a=o(325),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function StorageMediator(i,o,r){var a=t.call(this)||this;return a.mLayerManager=i,a.world=o,a.mScene=r,a.mUIType=h.UIType.Normal,a}return l(StorageMediator,t),StorageMediator.prototype.isShow=function(){return this.mView.isShow()},StorageMediator.prototype.resize=function(){this.mView&&this.mView.resize()},StorageMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||(this.mView||(this.mView=new a.StoragePanel(this.mScene,this.world)),this.mView.show(i),this.world.uiManager.checkUIState(StorageMediator.NAME,!1),t.prototype.show.call(this,i))},StorageMediator.prototype.update=function(t){this.mView&&this.mView.update(t)},StorageMediator.prototype.hide=function(){this.mView&&(this.mView.hide(),this.world.uiManager.checkUIState(StorageMediator.NAME,!0))},StorageMediator.prototype.destroy=function(){this.mView&&(this.mView.destroy(),this.mView=null)},StorageMediator.NAME="StorageMediator",StorageMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"StoragePanel",(function(){return y}));var r,a=o(133),h=o(111),l=o(124),c=o(117),u=o(324),p=o(125),d=o(112),m=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),y=function(t){function StoragePanel(i,o){return t.call(this,i,o)||this}return m(StoragePanel,t),StoragePanel.prototype.resize=function(t,i){var o=this.mWorld.getSize();this.x=o.width+t>>1,this.y=o.height+i-200},StoragePanel.prototype.destroy=function(){if(this.mBagItemSlotList){for(var i=this.mBagItemSlotList.length,o=0;o<i;o++){var r=this.mBagItemSlotList[o];r&&(r.destroy(),r=null)}this.mBagItemSlotList=null}this.mWorld=null,t.prototype.destroy.call(this)},StoragePanel.prototype.addListen=function(){this.mClsBtn.on("pointerup",this.hide,this)},StoragePanel.prototype.removeListen=function(){this.mClsBtn.off("pointerup",this.hide,this)},StoragePanel.prototype.init=function(){if(!this.mInitialized){t.prototype.init.call(this),this.mBg=new c.NinePatch(this.scene,0,0,500,350,h.a.getName(),null,h.a.getConfig()),this.addAt(this.mBg,0),this.setSize(this.mBg.width,this.mBg.height),this.mBorder=new c.NinePatch(this.scene,0,0,this.mBg.width-10,this.mBg.height-30,h.d.getName(),null,h.d.getConfig()),this.mBorder.x=this.mBg.x,this.mBorder.y=this.mBg.y+10,this.addAt(this.mBorder,1),this.setSize(this.mBg.width,this.mBg.height);var i=this.scene.make.image(void 0,!1);i.setTexture(this.mResStr,"itemBagView_title.png"),i.x=80+(-this.mBg.width>>1),i.y=-this.mBg.height>>1,this.add(i);var o,r=this.scene.make.text(void 0,!1);r.setFontFamily("Tahoma"),r.setFontStyle("bold"),r.setFontSize(20),r.setText("书柜"),r.x=i.x+i.width-10,r.y=i.y-(r.height>>1),this.add(r);var u=0,d=0;this.mBagItemSlotList=[];for(var m=0;m<9;m++)u=m%9*60+32-362,d=60*Math.floor(m/9)-55,(o=new a.ItemSlot(this.scene,this.mWorld,this,u,d,this.mResStr,this.mResPng,this.mResJson,"bagView_slot.png","bagView_itemSelect.png")).createUI(),this.mBagItemSlotList.push(o);this.mClsBtn=new l.IconBtn(this.scene,this.mWorld,{key:p.UIMediatorType.Close_Btn,bgResKey:"clsBtn",bgTextures:["btn_normal","btn_over","btn_click"],iconResKey:"",iconTexture:"",scale:1,pngUrl:"ui/common/common_clsBtn.png",jsonUrl:"ui/common/common_clsBtn.json"}),this.mClsBtn.x=(this.width>>1)-65,this.mClsBtn.y=-this.height>>1,this.mClsBtn.scaleX=this.mClsBtn.scaleY=2,this.add(this.mClsBtn)}},StoragePanel.prototype.preload=function(){this.scene&&(this.mResStr="bagView",this.mResPng="ui/bag/bagView.png",this.mResJson="ui/bag/bagView.json",this.scene.load.image(h.d.getName(),h.d.getPNG()),this.scene.load.image(h.a.getName(),h.a.getPNG()),this.scene.load.atlas("clsBtn",h.i.getRes("ui/common/common_clsBtn.png"),h.i.getRes("ui/common/common_clsBtn.json")),this.scene.load.atlas(this.mResStr,h.i.getRes(this.mResPng),h.i.getRes(this.mResJson)),t.prototype.preload.call(this))},StoragePanel.prototype.tweenComplete=function(i){t.prototype.tweenComplete.call(this,i),i&&this.mWorld.uiManager.getMediator(u.StorageMediator.NAME).resize()},StoragePanel}(d.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"TopBtnGroup",(function(){return d}));var r,a=o(112),h=o(111),l=o(124),c=o(167),u=o(125),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function TopBtnGroup(i,o){var r=t.call(this,i,o)||this;return r.mBtnPad=10,r.mBtnX=0,r.mExpandBoo=!1,r.mOrientation=Phaser.Scale.Orientation.LANDSCAPE,r.disInteractive(),r}return p(TopBtnGroup,t),TopBtnGroup.prototype.show=function(i){this.scale=this.mWorld.uiScale,t.prototype.show.call(this,i)},TopBtnGroup.prototype.resize=function(){var t=this.mWorld.getSize();this.x=t.width-50*this.mWorld.uiScale,this.y=this.height/2+10*this.mWorld.uiScale,this.scale=this.mWorld.uiScale},TopBtnGroup.prototype.destroy=function(){this.mBtnX=0,this.mTurnBtn&&this.mTurnBtn.destroy(),this.mReturnBtn&&this.mReturnBtn.destroy(),this.mDebugBtn&&this.mDebugBtn.destroy(),this.mBtnList&&this.mBtnList.forEach((function(t){t&&(t.destroy(),t=null)})),this.mResKey="",this.mBtnList=null,this.mTurnBtn=null,this.mReturnBtn=null,t.prototype.destroy.call(this)},TopBtnGroup.prototype.tweenView=function(t){if(this.scene){var i=this.height/2+10*this.mWorld.uiScale,o=!0===t?i:i-50,r=!0===t?1:0;this.scene.tweens.add({targets:this,duration:200,ease:"Cubic.Out",props:{y:{value:o},alpha:{value:r}}})}},TopBtnGroup.prototype.addBtn=function(t){if(this.mAddBtnDataList||(this.mAddBtnDataList=[]),this.mInitialized){var i=new l.IconBtn(this.scene,this.mWorld,t);this.mBtnList.push(i),this.btnRefreshPos()}else this.mAddBtnDataList.push(t)},TopBtnGroup.prototype.removeBtn=function(t){if(this.mRemoveBtnKeyList&&(this.mRemoveBtnKeyList=[]),this.mInitialized){for(var i=0,o=this.mBtnList.length;i<o;i++){var r=this.mBtnList[i];if(r){var a=r.getKey();if(a&&a===t){r.destroy(),r=null,this.mBtnList.splice(i,1);break}}}this.btnRefreshPos()}else this.mRemoveBtnKeyList.push(t)},TopBtnGroup.prototype.preload=function(){this.scene&&(this.mResKey="baseView",this.scene.load.atlas(this.mResKey,h.i.getRes("ui/baseView/mainui_mobile.png"),h.i.getRes("ui/baseView/mainui_mobile.json")),t.prototype.preload.call(this))},TopBtnGroup.prototype.init=function(){var i=this,o=0,r=0;this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this),this.mBtnList=[],this.mBtnX=0,this.mTurnBtn=new l.IconBtn(this.scene,this.mWorld,{key:u.UIMediatorType.Turn_Btn_Top,bgResKey:this.mResKey,bgTextures:["btnGroup_yellow_normal.png","btnGroup_yellow_light.png","btnGroup_yellow_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_top_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mTurnBtn.x=this.mBtnX,this.mTurnBtn.setPos(this.mBtnX,0),r+=this.mTurnBtn.width+this.mBtnPad,this.add(this.mTurnBtn),this.mBtnX+=-this.mTurnBtn.width-this.mBtnPad,o+=this.mTurnBtn.height/2+20,this.mWorld.game.device.os.desktop||(this.mReturnBtn=new l.IconBtn(this.scene,this.mWorld,{key:u.UIMediatorType.App_Back,bgResKey:this.mResKey,bgTextures:["btnGroup_white_normal.png","btnGroup_white_light.png","btnGroup_white_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_top_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mReturnBtn.x=this.mBtnX,this.mReturnBtn.setPos(this.mBtnX,0),this.mBtnList.push(this.mReturnBtn),r+=this.mReturnBtn.width+this.mBtnPad,this.add(this.mReturnBtn),this.mBtnX+=-this.mReturnBtn.width-this.mBtnPad,this.mDebugBtn=new l.IconBtn(this.scene,this.mWorld,{key:c.DebugLoggerMediator.NAME,bgResKey:this.mResKey,bgTextures:["btnGroup_blue_normal.png","btnGroup_blue_light.png","btnGroup_blue_select.png"],iconResKey:this.mResKey,iconTexture:"btnGroup_top_expand.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json"}),this.mDebugBtn.x=this.mBtnX,this.mDebugBtn.setPos(this.mBtnX,0),this.mBtnList.push(this.mDebugBtn),r+=this.mDebugBtn.width+this.mBtnPad,this.add(this.mDebugBtn),this.mReturnBtn.setClick((function(){i.mWorld.closeGame()})),this.mDebugBtn.setClick((function(){var t=i.mWorld.uiManager.getMediator(c.DebugLoggerMediator.NAME);t||(i.mWorld.uiManager.setMediator(c.DebugLoggerMediator.NAME,new c.DebugLoggerMediator(i.mWorld.uiManager.getUILayerManager(),i.scene,i.mWorld)),t=i.mWorld.uiManager.getMediator(c.DebugLoggerMediator.NAME)),t.isShow()?t.hide():t.show()}))),this.setSize(r,o),this.mTurnBtn.setClick((function(){i.turnHandler()})),this.resize(),t.prototype.init.call(this)},TopBtnGroup.prototype.tweenComplete=function(i){var o=this;t.prototype.tweenComplete.call(this,i),i&&(this.mAddBtnDataList&&this.mAddBtnDataList.forEach((function(t){o.addBtn(t)})),this.mRemoveBtnKeyList&&this.mRemoveBtnKeyList.forEach((function(t){o.removeBtn(t)})))},TopBtnGroup.prototype.turnHandler=function(){var t=this;if(this.mBtnList||!(this.mBtnList.length<1))for(var i=this.mBtnList.length,_loop_1=function(r){var a=o.mBtnList[r],h=o.mExpandBoo?a.getPos().x:o.mTurnBtn.width>>1,l=o.mExpandBoo?1:0,c=o.mExpandBoo?"Sine.easeIn":"Sine.easeOut";o.scene.tweens.add({targets:a,duration:300,ease:c,props:{x:{value:h},alpha:{value:l}},onComplete:function(o,a,h){r===i-1&&(t.mExpandBoo=!t.mExpandBoo)},onCompleteParams:[o]})},o=this,r=0;r<i;r++)_loop_1(r)},TopBtnGroup.prototype.btnRefreshPos=function(){var t=this;if(this.mBtnList&&this.mBtnList.length>1){this.mBtnX=-this.mTurnBtn.width-this.mBtnPad;var i=this.mTurnBtn.height/2+20,o=0;this.mBtnList.forEach((function(i){i&&(i.x=t.mBtnX,i.setPos(t.mBtnX,0),t.mBtnX+=-i.width-t.mBtnPad,o+=i.width+t.mBtnPad,t.add(i))})),this.setSize(o,i)}this.resize()},TopBtnGroup}(a.BasePanel)},function(t,i,o){"use strict";o.d(i,"a",(function(){return c}));var r,a=o(118),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function GridLayer(i){return t.call(this,i)||this}return h(GridLayer,t),GridLayer.prototype.draw=function(t){if(this.clear(),t&&t.roomSize){this.lineStyle(1,16777215);for(var i=t.roomSize.rows,o=t.roomSize.cols,r=0;r<=i;r++)this.drawLine(t.transformTo90(new a.a(0,r)),t.transformTo90(new a.a(o,r)));for(r=0;r<=o;r++)this.drawLine(t.transformTo90(new a.a(r,0)),t.transformTo90(new a.a(r,i)))}},GridLayer.prototype.drawLine=function(t,i){this.lineBetween(t.x,t.y,i.x,i.y)},GridLayer}(Phaser.GameObjects.Graphics),c=function(){function LayerManager(t){this.room=t,this.mSurfaceInteractived=!0,this.mDelta=0;var i=1;t&&(t.world&&(i=t.world.scaleRatio),this.mScene=t.scene,this.mGroundClickLayer=this.mScene.add.container(0,0),this.mUGroundLayer2=this.mScene.add.container(0,0),this.mGroundLayer=this.mScene.add.container(0,0).setScale(i),this.mTileLayer=new l(this.mScene).setScale(i),this.mScene.sys.displayList.add(this.mTileLayer),this.mMiddleLayer=this.mScene.add.container(0,0).setScale(i),this.mSurfaceLayer=this.mScene.add.container(0,0).setScale(i),this.mAtmosphere=this.mScene.add.container(0,0),this.mSceneUILayer=this.mScene.add.container(0,0))}return LayerManager.prototype.addToGround=function(t,i){void 0!==i?this.mGroundLayer.addAt(t,i):Array.isArray(t)?this.mGroundLayer.add(t):this.mGroundLayer.add([t])},LayerManager.prototype.addToSurface=function(t){Array.isArray(t)?this.mSurfaceLayer.add(t):this.mSurfaceLayer.add([t])},LayerManager.prototype.addToSceneToUI=function(t){this.mSceneUILayer.add(t)},LayerManager.prototype.addToAtmosphere=function(t){this.mAtmosphere.add(t)},LayerManager.prototype.addToMiddle=function(t){this.mMiddleLayer.add(t)},LayerManager.prototype.resize=function(t,i){var o=this.room.world.scaleRatio;this.mGroundLayer.setScale(o),this.mTileLayer.setScale(o),this.mMiddleLayer.setScale(o),this.mSurfaceLayer.setScale(o)},LayerManager.prototype.sortSurface=function(){this.mSurfaceLayer.sort("depth")},LayerManager.prototype.changeScene=function(){this._clearLayer()},LayerManager.prototype.drawGrid=function(t){this.mTileLayer&&this.mTileLayer.draw(t)},LayerManager.prototype.setGridVisible=function(t){this.mTileLayer&&this.mTileLayer.setVisible(t)},LayerManager.prototype.update=function(t,i){t-this.mDelta<200||(this.mDelta=t,this.mDepthGround&&(this.mGroundLayer.sort("depth"),this.mDepthGround=!1),this.mDepthSurface&&(this.mDepthSurface=!1,this.mSurfaceLayer.sort("depth",(function(t,i){return t.sortY+t.sortZ>i.sortY+i.sortZ}))))},LayerManager.prototype.setSurfaceInteractive=function(t){if(this.mSurfaceInteractived!==t){this.mSurfaceInteractived=t;var i=this.mSurfaceLayer.list;t?i.forEach((function(t){t.setInteractive()})):i.forEach((function(t){t.disableInteractive()}))}},LayerManager.prototype.destroy=function(){this.mDelta=0,this._clearLayer()},LayerManager.prototype._clearLayer=function(){this.clearLayer(this.mGroundClickLayer),this.clearLayer(this.mGroundLayer),this.clearLayer(this.mSurfaceLayer),this.clearLayer(this.mUGroundLayer2),this.clearLayer(this.mAtmosphere),this.mTileLayer.destroy(!0)},LayerManager.prototype.clearLayer=function(t,i){void 0===i&&(i=!1);var o=t.list;if(o)for(var r=o.length,a=void 0,h=0;h<r;h++)(a=o[h])&&(a.destroy(i),a=null);t.destroy(i)},Object.defineProperty(LayerManager.prototype,"depthSurfaceDirty",{set:function(t){this.mDepthSurface=t},enumerable:!1,configurable:!0}),Object.defineProperty(LayerManager.prototype,"depthGroundDirty",{set:function(t){this.mDepthGround=t},enumerable:!1,configurable:!0}),Object.defineProperty(LayerManager.prototype,"layer",{get:function(){return this.mGroundLayer},enumerable:!1,configurable:!0}),LayerManager}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return m}));var r,a=o(110),h=o(2),l=o(0),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function Rectangle45(i,o,r,a){var h=t.call(this,i,o,r,a)||this;return h.row=i,h.col=o,h.endRow=r,h.endCol=a,h}return c(Rectangle45,t),Rectangle45}(Phaser.Geom.Rectangle),p=o(118),d=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),m=function(t){function CamerasManager(i){var o=t.call(this)||this;return o.mRoomService=i,o.MINI_VIEW_SIZE=50,o.VIEW_PORT_SIZE=50,o.viewPort=new Phaser.Geom.Rectangle,o.miniViewPort=new Phaser.Geom.Rectangle,o.zoom=1,o.mRoomService&&o.mRoomService.world&&(o.zoom=o.mRoomService.world.scaleRatio),o.mCameras=[],o}return d(CamerasManager,t),CamerasManager.prototype.getViewPort=function(){if(this.mMain){var t=this.mMain.worldView;return this.viewPort.x=t.x/this.zoom+(t.width/this.zoom-this.viewPort.width>>1),this.viewPort.y=t.y/this.zoom+(t.height/this.zoom-this.viewPort.height>>1),this.viewPort}},CamerasManager.prototype.getMiniViewPort=function(){if(this.mMain){var t=this.mMain.worldView;this.miniViewPort.x=t.x/this.zoom+(t.width/this.zoom-this.miniViewPort.width>>1),this.miniViewPort.y=t.y/this.zoom+(t.height/this.zoom-this.miniViewPort.height>>1);var i=this.mRoomService.transformTo45(new p.a(this.miniViewPort.x+(this.miniViewPort.width>>1),this.miniViewPort.y));return new u(i.x,i.y,this.MINI_VIEW_SIZE,this.MINI_VIEW_SIZE)}},CamerasManager.prototype.pan=function(t,i,o){var r=this;t*=this.zoom,i*=this.zoom;for(var a=0,h=this.mCameras;a<h.length;a++){h[a].pan(t,i,o)}return new Promise((function(t,i){r.mMain.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){t()}))}))},Object.defineProperty(CamerasManager.prototype,"camera",{get:function(){return this.mMain},set:function(t){this.mMain=t,this.addCamera(t),this.setViewPortSize()},enumerable:!1,configurable:!0}),CamerasManager.prototype.resize=function(t,i){this.resetCameraSize(t,i),this.mTarget&&this.startFollow(this.mTarget)},CamerasManager.prototype.setScroll=function(t,i){if(this.mMain)for(var o=0,r=this.mCameras;o<r.length;o++){r[o].setScroll(t,i)}},CamerasManager.prototype.offsetScroll=function(t,i){if(this.mMain){for(var o=0,r=this.mCameras;o<r.length;o++){var a=r[o];a.scrollX+=t/this.camera.zoom,a.scrollY+=i/this.camera.zoom}this.moving=!0}},CamerasManager.prototype.startFollow=function(t){if(this.mTarget=t,this.mMain&&t)for(var i=0,o=this.mCameras;i<o.length;i++){o[i].startFollow(t)}},CamerasManager.prototype.stopFollow=function(){if(this.mTarget=null,this.mMain)for(var t=0,i=this.mCameras;t<i.length;t++){i[t].stopFollow()}},CamerasManager.prototype.addCamera=function(t){-1===this.mCameras.indexOf(t)&&this.mCameras.push(t),this.mTarget&&t.startFollow(this.mTarget)},CamerasManager.prototype.removeCamera=function(t){var i=this.mCameras.indexOf(t);i>-1&&this.mCameras.splice(i,1)},CamerasManager.prototype.setBounds=function(t,i,o,r,a){if(this.mMain)for(var h=0,c=this.mCameras;h<c.length;h++){c[h].setBounds(t,i,o,r,a)}else l.a.getInstance().error("camera does not exist")},CamerasManager.prototype.setPosition=function(t,i){if(this.mMain)for(var o=0,r=this.mCameras;o<r.length;o++){r[o].setPosition(t,i)}},CamerasManager.prototype.syncToEditor=function(){if(this.mMain){var t=this.mMain.worldView,i=new a.PBpacket(h.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA),o=i.content;o.x=t.x,o.y=t.y,o.width=t.width,o.height=t.height,this.connection.send(i)}},CamerasManager.prototype.centerCameas=function(){},CamerasManager.prototype.syncCamera=function(){if(this.mMain){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_RESET_CAMERA_SIZE),i=t.content;i.width=this.mMain.width/this.mMain.zoom,i.height=this.mMain.height/this.mMain.zoom,this.connection.send(t)}},CamerasManager.prototype.syncCameraScroll=function(){if(this.mMain){var t=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SET_CAMERA_POSITION),i=t.content,o=h.op_def.PBPoint3f.create();o.x=this.mMain.scrollX/Math.ceil(window.devicePixelRatio),o.y=this.mMain.scrollY/Math.ceil(window.devicePixelRatio),i.pos=o,this.connection.send(t)}},CamerasManager.prototype.scrollTargetPoint=function(t,i){this.mMain&&this.setScroll(t*this.mRoomService.world.scaleRatio-this.mMain.width/2,i*this.mRoomService.world.scaleRatio-this.mMain.height/2)},CamerasManager.prototype.destroy=function(){this.mMain=void 0,this.mCameras=[]},CamerasManager.prototype.resetCameraSize=function(t,i){this.connection?this.syncCamera():l.a.getInstance().error("connection is undefined")},CamerasManager.prototype.setViewPortSize=function(){if(this.mMain){var t=this.mRoomService.roomSize;if(t){var i=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileWidth/2),o=(this.VIEW_PORT_SIZE+this.VIEW_PORT_SIZE)*(t.tileHeight/2);this.viewPort.setSize(i,o);var r=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileWidth/2),a=(this.MINI_VIEW_SIZE+this.MINI_VIEW_SIZE)*(t.tileHeight/2);this.miniViewPort.setSize(r,a)}else l.a.getInstance().error("room size does not exist")}else l.a.getInstance().error("camera does not exist")},Object.defineProperty(CamerasManager.prototype,"connection",{get:function(){if(this.mRoomService)return this.mRoomService.connection;l.a.getInstance().error("room service is undefined")},enumerable:!1,configurable:!0}),Object.defineProperty(CamerasManager.prototype,"moving",{get:function(){return this.mMoving},set:function(t){this.mMoving=t},enumerable:!1,configurable:!0}),Object.defineProperty(CamerasManager.prototype,"targetFollow",{get:function(){return this.mTarget},enumerable:!1,configurable:!0}),CamerasManager}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),o.d(i,"InteractionBubbleCell",(function(){return u}));var r,a=o(343),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function BubbleAnimation(i){var o=t.call(this,i)||this;return o.loaded=!1,o.isPlaying=!1,o.loop=!1,o}return h(BubbleAnimation,t),BubbleAnimation.prototype.load=function(t,i,o){this.resName=t||i,this.resUrl=i,this.animUrlData=new a.a,t?this.animUrlData.setData(this.resName,this.resUrl):this.animUrlData.setDisplayData(i,o),this.scene.load.image(this.resName,this.animUrlData.pngUrl),this.scene.load.image(this.animUrlData.jsonUrl,this.animUrlData.jsonUrl),this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadComplete,this),this.scene.load.start()},BubbleAnimation.prototype.play=function(t){this.isPlaying=!0,this.frameAnim&&(this.setScale(.2,.2),this.y=50,this.scene.tweens.add({targets:this,y:{value:-100,duration:300,ease:"Bounce.easeOut"},scaleX:{value:1,duration:300,ease:"Bounce.easeOut"},scaleY:{value:1,duration:300,ease:"Bounce.easeOut"}}))},BubbleAnimation.prototype.destroy=function(){this.frameAnim&&this.frameAnim.destroy(),this.bubblebg&&this.bubblebg.destroy(),this.animUrlData&&this.animUrlData.dispose(),this.frameAnim=null,this.animUrlData=null,this.bubblebg=null},BubbleAnimation.prototype.onLoadComplete=function(t,i,o){this.loaded=!0,this.bubblebg=this.scene.add.image(0,0,this.resName),this.frameAnim=this.scene.add.image(0,0,this.animUrlData.jsonUrl),this.add([this.bubblebg,this.frameAnim]),this.isPlaying&&this.play()},BubbleAnimation}(Phaser.GameObjects.Container),c=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),u=function(t){function InteractionBubbleCell(i,o){var r=t.call(this,i)||this;return r.mWdith=78,r.mHeight=78,r.width=r.mWdith*o,r.height=r.mHeight*o,r}return c(InteractionBubbleCell,t),InteractionBubbleCell.prototype.setContentData=function(t,i){this.content=t,this.handler&&this.handler.clear(),this.handler=i},InteractionBubbleCell.prototype.load=function(t,i,o){this.createAnimation(),this.mBubbleAni.load(t,i,o),this.mBubbleAni.play()},InteractionBubbleCell.prototype.show=function(){this.mBubbleAni&&this.add(this.mBubbleAni),this.removeDelay()},InteractionBubbleCell.prototype.hide=function(){this.mBubbleAni&&this.remove(this.mBubbleAni),this.mRemoveDelay&&(clearTimeout(this.mRemoveDelay),this.mRemoveDelay=null)},InteractionBubbleCell.prototype.destroy=function(){this.hide(),this.mBubbleAni&&this.mBubbleAni.destroy(),this.handler&&this.handler.clear(),this.mBubbleAni=null,this.handler=null,t.prototype.destroy.call(this)},InteractionBubbleCell.prototype.createAnimation=function(){this.mBubbleAni=new l(this.scene),this.mBubbleAni.width=this.width,this.mBubbleAni.height=this.height;var t=Phaser.Input.Events.POINTER_DOWN;this.mBubbleAni.setInteractive(new Phaser.Geom.Rectangle(0,0,2*this.mBubbleAni.width,2*this.mBubbleAni.height),Phaser.Geom.Rectangle.Contains),this.mBubbleAni.on(t,this.onBubbleClick,this)},InteractionBubbleCell.prototype.onBubbleClick=function(){this.handler&&this.handler.runWith(this.content)},InteractionBubbleCell.prototype.removeDelay=function(){var t=this;this.mRemoveDelay=setTimeout((function(){t.handler&&t.handler.runWith(t.content.id),t.hide()}),this.content.duration)},InteractionBubbleCell}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"ShopItemSlot",(function(){return v}));var r,a,h,l=o(133),c=o(145),u=o(2),p=o(111);a=r||(r={}),h=function(){function TuDing18(){}return TuDing18.getName=function(){return"ui_moneyIcon_tuding_18_png"},TuDing18.getPNG=function(){return p.i.getRes("ui/moneyIcon/tuding_18.png")},TuDing18}(),a.TuDing18=h;var d,m=o(116),y=o(158),g=o(110),_=(d=function(t,i){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),v=function(t){function ShopItemSlot(i,o,r,a,h,l,c,u,p,d,m){return t.call(this,i,o,r,a,h,l,c,u,p,d)||this}return _(ShopItemSlot,t),ShopItemSlot.prototype.shopDataChange=function(i,o){if(i){this.mPackageID=o,t.prototype.dataChange.call(this,i);for(var a=i.price,h=a.length,l=0;l<h;l++){a[l].coinType===u.op_def.CoinType.TU_DING_COIN&&(r.TuDing18.getName(),r.TuDing18.getPNG()),this.makeCoin(a[l],20*l+30)}}},ShopItemSlot.prototype.destroy=function(){this.moneyIcon&&(this.moneyIcon.destroy(!0),this.moneyIcon=null),t.prototype.destroy.call(this)},ShopItemSlot.prototype.makeCoin=function(t,i){var o;t.coinType===u.op_def.CoinType.TU_DING_COIN&&(r.TuDing18.getName(),o=r.TuDing18.getPNG()),this.moneyIcon=new m.DynamicImage(this.mScene,0,0),this.moneyIcon.x=15+(-this.mWid>>1),this.moneyIcon.y=i,this.toolTipCon.add(this.moneyIcon),this.moneyIcon.load(o);var a=this.mScene.make.text(void 0,!1);a.setFontFamily("Tahoma"),a.setFontSize(15),a.x=-this.mWid/2+this.moneyIcon.width+20,a.y=i-9,this.toolTipCon.add(a),a.setText(t.price.toString())},ShopItemSlot.prototype.onLoadCompleteHandler=function(){this.mWid=80,this.mHei=88,this.itemBG=this.mScene.make.sprite(void 0,!1),this.itemBG.setTexture(this.mResStr,this.mResSlot),this.itemBG.y=-10,this.toolTipCon.setSize(this.mWid,this.mHei),this.toolTipCon.addAt(this.itemBG,0),this.mIcon=new c.DragDropIcon(this.mScene,0,-10),this.toolTipCon.addAt(this.mIcon,1),this.mSubScriptRes&&(this.mSubScriptSprite=this.mScene.make.sprite(void 0,!1),this.mSubScriptSprite.setTexture(this.mResStr,this.mSubScriptRes),this.mSubScriptSprite.x=this.mSubScriptSprite.width-this.itemBG.width>>1,this.mSubScriptSprite.y=this.mSubScriptSprite.height-this.itemBG.height>>1),this.isTipBoo&&(this.toolTip=new y.ToolTip(this.mScene,"itemSlotTip",p.i.getRes("ui/toolTip/toolTip.json"),p.i.getRes("ui/toolTip/toolTip.png"),this.mWorld.uiScale)),this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0,0,this.itemBG.width,56),Phaser.Geom.Rectangle.Contains),this.toolTipCon.on("pointerover",this.overHandler,this),this.toolTipCon.on("pointerout",this.outHandler,this),this.toolTipCon.on("pointerdown",this.downHandler,this),this.toolTipCon.on("pointerup",this.outHandler,this),this.minitialize=!0,this.mData&&this.dataChange(this.mData),this.mSelectSprite=this.mScene.make.sprite(void 0,!1),this.createTexture(this.mWid,this.mHei)},ShopItemSlot.prototype.overHandler=function(i){t.prototype.overHandler.call(this,i),this.mSelectSprite.y-=10},ShopItemSlot.prototype.downHandler=function(t){if(this.mData){var i=new g.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),o=i.content;o.uiId=this.mPackageID,o.componentId=this.mData.id,this.mWorld.connection.send(i)}},ShopItemSlot.prototype.outHandler=function(i){t.prototype.outHandler.call(this,i)},ShopItemSlot.prototype.createTexture=function(t,i){var o=this.mScene.add.graphics();o.fillStyle(11184553,.3),o.fillRoundedRect(0,0,t,i,5),o.generateTexture("selectBg",t,i),o.clear()},ShopItemSlot}(l.ItemSlot)},,,,,,,function(t,i,o){"use strict";o.d(i,"a",(function(){return c}));var r,a=o(118),h=o(138),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ReferenceArea(i,o){var r=t.call(this,i)||this;return r.mRoomService=o,r}return l(ReferenceArea,t),ReferenceArea.prototype.draw=function(t,i){if(this.clear(),0!==t.length&&0!==t[0].length){var o,r,l,c,u=t.length,p=t[0].length,d=this.mRoomService.roomSize,m=d.tileWidth/2,y=d.tileHeight/2;this.mOrigin=i,this.mSize={rows:u,cols:p,tileWidth:m,tileHeight:y,sceneWidth:(u+p)*(m/2),sceneHeight:(u+p)*(y/2)},this.beginPath();for(var g=0;g<u;g++)for(var _=0;_<p;_++)this.lineStyle(2,0),o=h.a.transformTo90(new a.a(_,g),this.mSize),r=h.a.transformTo90(new a.a(_+1,g),this.mSize),l=h.a.transformTo90(new a.a(_+1,g+1),this.mSize),c=h.a.transformTo90(new a.a(_,g+1),this.mSize),this.beginPath(),this.fillStyle(1===t[g][_]?65280:16711680),this.strokePoints([o.toPoint(),r.toPoint(),l.toPoint(),c.toPoint()],!0,!0),this.fillPath();this.setPosition(0,0)}},ReferenceArea.prototype.setPosition=function(i,o,r,a){if(this.mSize){var h=i-this.mSize.rows*(this.mSize.tileWidth>>1)-(this.mOrigin.x-this.mOrigin.y)*(this.mSize.tileWidth>>1),l=o-(this.mOrigin.x+this.mOrigin.y+.5)*(this.mSize.tileHeight>>1);return t.prototype.setPosition.call(this,h,l,r,a)}},Object.defineProperty(ReferenceArea.prototype,"size",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),ReferenceArea}(Phaser.GameObjects.Graphics)},,function(t,i,o){"use strict";o.d(i,"a",(function(){return p}));var r,a=o(122),h=o(2),l=o(118),c=o(110),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function Player(i,o){var r=t.call(this,i,o)||this;return r.mElementManager=o,r.nodeType=h.op_def.NodeType.CharacterNodeType,r.mOffsetY=void 0,r.mDisplay&&i.displayBadgeCards&&i.displayBadgeCards.length>0&&r.mDisplay.setDisplayBadges(i.displayBadgeCards),r}return u(Player,t),Player.prototype.setModel=function(i){t.prototype.setModel.call(this,i),this.showNickname()},Player.prototype.move=function(i){this.getDirection()!==i.direction&&(this.roomService.world.moveStyle===h.op_def.MoveStyle.DIRECTION_MOVE_STYLE?this.mId!==this.roomService.playerManager.actor.id&&this.setDirection(i.direction):this.setDirection(i.direction)),i.destinationPoint3f.y+=this.offsetY,t.prototype.move.call(this,i)},Player.prototype.movePath=function(t){var i=this;if(this.mDisplay){var o=t.path;if(o){var r=new l.a(this.mDisplay.x,this.mDisplay.y-this.offsetY),a=[];this.mMoveData.arrivalTime=t.timestemp;for(var h=null,c=null,u=this.mElementManager.roomService.now(),p=0,d=0,m=0,y=o;m<y.length;m++){var g=y[m];(c=g.point3f).y===r.y&&c.x===r.x||(h=Math.atan2(c.y-r.y,c.x-r.x)*(180/Math.PI)),u+=p,p=g.timestemp-u,a.push({x:c.x,y:c.y+this.offsetY,duration:p,onStartParams:h,onStart:function(t,o,r){i.onCheckDirection(r)},onCompleteParams:{duration:p,index:d},onComplete:function(t,o,r){i.onMovePathPointComplete(r)}}),r=new l.a(c.x,c.y),d++}this.mMoveData.posPath=a,this.mMoveData.onCompleteParams=c,this.mMoveData.onComplete=this.mMovePathPointFinished,this._doMove()}}},Player.prototype.setDirection=function(t){t!==this.mDisplayInfo.avatarDir&&(this.mDisplayInfo.avatarDir=t,this.mModel.direction=t,this.mDisplay&&this.mDisplay.play(this.mModel.currentAnimation))},Player.prototype.changeState=function(t){this.mDisplay&&this.mCurState!==t&&(t||(t=a.d.IDLE),this.mCheckStateHandle(t)&&(this.mCurState=t,this.mModel.currentAnimationName=this.mCurState,this.mDisplay.play(this.mModel.currentAnimation)))},Player.prototype.setPosition=function(i){i.y+=this.offsetY,t.prototype.setPosition.call(this,i)},Player.prototype.getPosition=function(){var i=t.prototype.getPosition.call(this);return i.y-=this.offsetY,i},Player.prototype.onCheckDirection=function(t){"number"==typeof t&&(t>90?this.setDirection(3):t>=0?this.setDirection(5):t>=-90?this.setDirection(7):this.setDirection(1))},Player.prototype.onMoveStart=function(){this.changeState(a.d.WALK),this.mMoveData&&(this.mMoveData.step=0),t.prototype.onMoveStart.call(this)},Player.prototype.onMoveComplete=function(){this.preMoveComplete(),t.prototype.onMoveComplete.call(this),this.changeState(a.d.IDLE)},Player.prototype.preMoveComplete=function(){if(this.mMoveData&&this.mMoveData.posPath){var t=this.mMoveData.onComplete;t&&(t.call(this,this.mMoveData.onCompleteParams),delete this.mMoveData.onComplete,delete this.mMoveData.onCompleteParams)}},Player.prototype.onMovePathPointComplete=function(t){this.mMoveData&&(this.mMoveData.step+=1)},Player.prototype.mMovePathPointFinished=function(t){if(t&&this.mRoomService){var i=new c.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOVE_PATH_POINT_FINISHED),o=i.content,r=h.op_def.PBPoint3f.create(),a=this.getPosition();r.x=a.x,r.y=a.y,r.z=a.z;var l=h.op_def.PBPoint3f.create();l.x=t.x,l.y=t.y,o.currentPoint=r,o.lastTargetPoint=l,o.timestemp=this.mRoomService.world.clock.unixTime,this.mRoomService.connection.send(i)}},Object.defineProperty(Player.prototype,"offsetY",{get:function(){if(void 0===this.mOffsetY){if(!this.mElementManager||!this.mElementManager.roomService||!this.mElementManager.roomService.roomSize)return 0;this.mOffsetY=this.mElementManager.roomService.roomSize.tileHeight>>2}return this.mOffsetY},enumerable:!1,configurable:!0}),Player.prototype.onDisplayReady=function(i){t.prototype.onDisplayReady.call(this,i),this.showNickname()},Player.prototype.mCheckStateHandle=function(t){return!0},Player}(a.b)},function(t,i,o){"use strict";o.d(i,"a",(function(){return u}));var r,a=o(0),h=o(178),l=o(175),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function Terrain(i,o){var r=t.call(this,o.roomService)||this;return r.mElementManager=o,r.mId=i.id,r.model=i,r}return c(Terrain,t),Terrain.prototype.setModel=function(t){this.mModel=t,t&&(this.load(this.mModel.displayInfo),this.mDisplay&&this.setPosition45(this.mModel.pos))},Terrain.prototype.updateModel=function(t){},Terrain.prototype.load=function(t){this.mDisplayInfo=t,this.mDisplayInfo&&(this.mDisplay||this.createDisplay(),this.mDisplayInfo=t,this.mDisplay.once("initialized",this.onInitializedHandler,this),this.mDisplay.load(this.mDisplayInfo))},Terrain.prototype.play=function(t){this.mModel?this.mModel.currentAnimationName!==t&&(this.mModel.currentAnimationName=t,this.mDisplay&&this.mDisplay.play(this.model.currentAnimation)):a.a.getInstance().error(Terrain.name+": sprite is empty")},Terrain.prototype.setDirection=function(t){this.mDisplayInfo&&this.mDisplayInfo.avatarDir&&(this.mDisplayInfo.avatarDir=t)},Terrain.prototype.getDirection=function(){return this.mDisplayInfo&&this.mDisplayInfo.avatarDir?this.mDisplayInfo.avatarDir:3},Terrain.prototype.setPosition=function(t){this.mDisplay&&this.mDisplay.setPosition(t.x,t.y,t.z),this.setDepth()},Terrain.prototype.getDisplay=function(){return this.mDisplay},Terrain.prototype.showNickname=function(){},Terrain.prototype.hideNickname=function(){},Terrain.prototype.showEffected=function(){},Terrain.prototype.turn=function(){},Terrain.prototype.setAlpha=function(t){},Terrain.prototype.scaleTween=function(){},Terrain.prototype.setQueue=function(){},Terrain.prototype.update=function(){},Terrain.prototype.mount=function(){return this},Terrain.prototype.unmount=function(){return this},Terrain.prototype.addMount=function(){return this},Terrain.prototype.removeMount=function(){return this},Terrain.prototype.destroy=function(){this.mBlockable&&this.mDisplay&&this.roomService.removeBlockObject(this),t.prototype.destroy.call(this)},Terrain.prototype.createDisplay=function(){if(this.mDisplayInfo){if(this.mDisplay)return this.mDisplay;var t=this.mElementManager.scene;return t&&(this.mDisplay=new h.a(t,this.mElementManager.roomService,this),this.setPosition45(this.model.pos),this.addToBlock()),this.mDisplay}},Terrain.prototype.addDisplay=function(){if(this.createDisplay(),this.mDisplay)if(this.mElementManager){var t=this.mElementManager.roomService;t?(t.addToGround(this.mDisplay),this.setDepth()):a.a.getInstance().error("roomService does not exist")}else a.a.getInstance().error("element manager does not exist")},Terrain.prototype.setDepth=function(){if(this.mDisplay){if(this.mDisplay.setDepth(this.mDisplay.y),!this.roomService)throw new Error("roomService is undefined");var t=this.roomService.layerManager;if(!t)throw new Error("layerManager is undefined");t.depthGroundDirty=!0}},Terrain.prototype.onInitializedHandler=function(){this.mDisplay&&this.mDisplay.play(this.model.currentAnimation)},Terrain.prototype.setPosition45=function(t){if(this.roomService){var i=this.roomService.transformTo90(t);this.setPosition(i)}else a.a.getInstance().error("roomService does not exist")},Object.defineProperty(Terrain.prototype,"id",{get:function(){return this.mId},enumerable:!1,configurable:!0}),Object.defineProperty(Terrain.prototype,"dir",{get:function(){return void 0!==this.mDisplayInfo.avatarDir?this.mDisplayInfo.avatarDir:3},enumerable:!1,configurable:!0}),Object.defineProperty(Terrain.prototype,"roomService",{get:function(){if(this.mElementManager)return this.mElementManager.roomService;a.a.getInstance().error("element manager is undefined")},enumerable:!1,configurable:!0}),Object.defineProperty(Terrain.prototype,"model",{get:function(){return this.mModel},set:function(t){this.setModel(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Terrain.prototype,"currentAnimationName",{get:function(){return this.mModel?this.mModel.currentAnimationName:""},enumerable:!1,configurable:!0}),Object.defineProperty(Terrain.prototype,"scene",{get:function(){if(this.mElementManager)return this.mElementManager.scene},enumerable:!1,configurable:!0}),Terrain}(l.a)},function(t,i,o){"use strict";o.d(i,"a",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function PlayCamera(i,o,r,a,h,l){var c=t.call(this,i,o,r,a)||this;return c.pixelRatio=h,c.moveRatio=l||1,c}return a(PlayCamera,t),PlayCamera.prototype.setPixelRatio=function(t){this.pixelRatio=t},PlayCamera.prototype.startFollow=function(t,i,o,r,a,h){void 0===i&&(i=!1),void 0===o&&(o=1),void 0===r&&(r=o),void 0===a&&(a=0),void 0===h&&(h=a),this._follow=t,this.roundPixels=i,this.lerp.set(o,r),this.followOffset.set(a,h);var l=this.width/2,c=this.height/2,u=this._follow.getPosition(),p=u.x*this.pixelRatio*this.moveRatio-a,d=u.y*this.pixelRatio*this.moveRatio-h;return this.midPoint.set(p,d),this.scrollX=p-l,this.scrollY=d-c,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},PlayCamera.prototype.preRender=function(t){var i=this.width,o=this.height,r=.5*i,a=.5*o,h=this.zoom*t,l=this.matrix,c=i*this.originX,u=o*this.originY,p=this._follow,d=this.deadzone,m=this.scrollX,y=this.scrollY;if(p&&!this.panEffect.isRunning){var g=p.getPosition(),_=g.x*this.pixelRatio*this.moveRatio-this.followOffset.x,v=g.y*this.pixelRatio*this.moveRatio-this.followOffset.y;d?(_<d.x?m=this.linear(m,m-(d.x-_),this.lerp.x):_>d.right&&(m=this.linear(m,m+(_-d.right),this.lerp.x)),v<d.y?y=this.linear(y,y-(d.y-v),this.lerp.y):v>d.bottom&&(y=this.linear(y,y+(v-d.bottom),this.lerp.y))):(m=this.linear(m,_-c,this.lerp.x),y=this.linear(y,v-u,this.lerp.y))}this.useBounds&&(m=this.clampX(m),y=this.clampY(y)),this.roundPixels&&(c=Math.round(c),u=Math.round(u)),this.scrollX=m,this.scrollY=y;var b=m+r,P=y+a;this.midPoint.set(b,P);var w=i/h,S=o/h;this.worldView.setTo(b-w/2,P-S/2,w,S),l.applyITRS(this.x+c,this.y+u,this.rotation,h,h),l.translate(-c,-u),this.shakeEffect.preRender()},PlayCamera.prototype.linear=function(t,i,o){return(i-t)*o+t},PlayCamera}(Phaser.Cameras.Scene2D.Camera)},function(t,i,o){"use strict";o.d(i,"b",(function(){return h})),o.d(i,"a",(function(){return r}));var r,a=o(0),h=function(){function Scenery(t){this.mID=t.id,this.mDepth=t.depth,this.mUris=[];var i=null;(i=Array.isArray(t.uris)?t.uris:t.uris.value).length<1&&a.a.getInstance().error(Scenery.name+": scenery uris is empty");for(var o=0;o<i.length;o++){var r=i[o].value||i;this.mUris[o]=new Array(r[o].length);for(var h=0;h<r[o].length;h++)this.mUris[o][h]=r[o][h]}this.mSpeed=t.speed||1,t.width||a.a.getInstance().error(Scenery.name+": scenery width is "+t.width),t.height||a.a.getInstance().error(Scenery.name+": scenery height is "+t.height),this.mWidth=t.width,this.mHeight=t.height,this.mFit=t.fit,this.mOffset=t.offset||{x:0,y:0}}return Object.defineProperty(Scenery.prototype,"width",{get:function(){return this.mWidth},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"height",{get:function(){return this.mHeight},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"depth",{get:function(){return this.mDepth},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"offset",{get:function(){return this.mOffset},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"speed",{get:function(){return this.mSpeed},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"uris",{get:function(){return this.mUris},enumerable:!1,configurable:!0}),Object.defineProperty(Scenery.prototype,"fit",{get:function(){return this.mFit},enumerable:!1,configurable:!0}),Scenery}();!function(t){t[t.Center=1]="Center",t[t.Fill=2]="Fill",t[t.Stretch=3]="Stretch",t[t.Repeat=4]="Repeat"}(r||(r={}))},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function AnimationUrlData(){}return AnimationUrlData.prototype.setData=function(t,i,o,r){void 0===o&&(o=!1),void 0===r&&(r=".json"),this.resName=t,this.resUrl=i,this.pngUrl=i+"/"+t+(o?"_tex.png":".png"),this.jsonUrl=i+"/"+t+(o?"_tex.json":".json"),o&&(this.boneUrl=i+"/"+t+"_ske"+r),this.responseType=".dbbin"===r?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.setDisplayData=function(t,i,o){void 0===o&&(o=".json"),this.pngUrl=t,this.jsonUrl=i,this.responseType=".dbbin"===o?"arraybuffer":null,this.boneXhrSettings=this.responseType?{responseType:"arraybuffer"}:null},AnimationUrlData.prototype.dispose=function(){this.textureXhrSettings=null,this.atlasXhrSettings=null,this.boneXhrSettings=null},AnimationUrlData}()},function(t,i,o){"use strict";o.r(i),o.d(i,"GraphicsProgressBar",(function(){return h}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function GraphicsProgressBar(i,o,r,a,h,l){void 0===l&&(l=!0);var c=t.call(this,i,o,r)||this;return c.value=.5,c.bgGraphics=c.scene.make.graphics(void 0,!1),c.barGraphics=c.scene.make.graphics(void 0,!1),c.add([c.bgGraphics,c.barGraphics]),c.setSize(a,h),c.bgColor=0,c.barColor=267386880,c.bgGraphics.clear(),c.bgGraphics.fillStyle(c.bgColor,1),c.bgGraphics.fillRect(0,0,c.width,c.height),c.setValue(c.value),c}return a(GraphicsProgressBar,t),GraphicsProgressBar.prototype.setColor=function(t,i){this.barColor=t,i&&(this.bgColor=i),this.bgGraphics.clear(),this.bgGraphics.fillStyle(this.bgColor,1),this.bgGraphics.fillRect(0,0,this.width,this.height),this.setValue(this.value)},GraphicsProgressBar.prototype.setValue=function(t){this.value=t;var i=this.width*(this.isHorizontal?t:1),o=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRect(0,0,i,o)},GraphicsProgressBar.prototype.setRoundedRectValue=function(t,i){this.value=t;var o=this.width*(this.isHorizontal?t:1),r=this.height*(this.isHorizontal?1:t);this.barGraphics.clear(),this.barGraphics.fillStyle(this.barColor,1),this.barGraphics.fillRoundedRect(0,0,o,r,i)},GraphicsProgressBar}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"GridLayoutGroup",(function(){return p})),o.d(i,"AlignmentType",(function(){return a})),o.d(i,"CornerType",(function(){return h})),o.d(i,"AxisType",(function(){return l})),o.d(i,"ConstraintType",(function(){return c}));var r,a,h,l,c,u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function GridLayoutGroup(i,o,r){var u=t.call(this,i,o,r)||this;return u.layoutElements=[],u._padding=new Phaser.Math.Vector4(0,0,0,0),u._cellSize=new Phaser.Math.Vector2(100,100),u._spacing=new Phaser.Math.Vector2(0,0),u._alignmentType=a.UpperLeft,u._startCorner=h.UpperLeft,u._startAxis=l.Horizontal,u._constraint=c.Flexible,u._constraintCount=4,u}return u(GridLayoutGroup,t),GridLayoutGroup.prototype.onPlay=function(){},GridLayoutGroup.prototype.start=function(){},Object.defineProperty(GridLayoutGroup.prototype,"padding",{get:function(){return this._padding},set:function(t){void 0!==t&&(this._padding=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"cellSize",{get:function(){return this._cellSize},set:function(t){void 0!==t&&(t.x<0&&(t.x=0),t.y<0&&(t.y=0),this._cellSize=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"spacing",{get:function(){return this._spacing},set:function(t){void 0!==t&&(this._spacing=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"alignmentType",{get:function(){return this._alignmentType},set:function(t){t!==this._alignmentType&&(this._alignmentType=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"startCorner",{get:function(){return this._startCorner},set:function(t){t!==this._startCorner&&(this._startCorner=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"startAxis",{get:function(){return this._startAxis},set:function(t){t!==this._startAxis&&(this._startAxis=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"constraint",{get:function(){return this._constraint},set:function(t){t!==this._constraint&&(this._constraint=t)},enumerable:!1,configurable:!0}),Object.defineProperty(GridLayoutGroup.prototype,"constraintCount",{get:function(){return this._constraintCount},set:function(t){void 0===t||isNaN(t)||(this._constraintCount=t)},enumerable:!1,configurable:!0}),GridLayoutGroup.prototype.Layout=function(){this.layoutElements.length=0;for(var t=0,i=this.list;t<i.length;t++){var o=i[t];o.active&&this.layoutElements.push(o)}if(0!==this.layoutElements.length){var r=this._startCorner%2,a=Math.floor(this._startCorner/2),h=0,c=0,u=0,p=this.getCellCount();this._startAxis===l.Horizontal?(h=p.x,c=Phaser.Math.Clamp(p.x,1,this.layoutElements.length),u=Phaser.Math.Clamp(p.y,1,Math.ceil(this.layoutElements.length/h))):(h=p.y,u=Phaser.Math.Clamp(p.y,1,this.layoutElements.length),c=Phaser.Math.Clamp(p.x,1,Math.ceil(this.layoutElements.length/h)));for(var d=new Phaser.Math.Vector2(c*this._cellSize.x+(c-1)*this._spacing.x,u*this._cellSize.y+(u-1)*this._spacing.y),m=new Phaser.Math.Vector2(this.getStartOffset(0,d.x),this.getStartOffset(1,d.y)),y=0,g=0,_=0;_<this.layoutElements.length;_++)this._startAxis===l.Horizontal?(y=_%h,g=Math.floor(_/h)):(y=Math.floor(_/h),g=_%h),1===r&&(y=c-1-y),1===a&&(g=u-1-g),this.setChildAlongAxis(this.layoutElements[_],0,m.x+(this._cellSize.x+this._spacing.x)*y,this._cellSize.x),this.setChildAlongAxis(this.layoutElements[_],1,m.y+(this._cellSize.y+this._spacing.y)*g,this._cellSize.y);var v=m.x+(this._cellSize.x+this._spacing.x)*(y+1),b=m.y+(this._cellSize.y+this._spacing.y)*(g+1);this.startAxis===l.Horizontal?(this.height=b,this.setAllChildPositionOffset(0)):(this.width=v,this.setAllChildPositionOffset(1)),this.width<v&&(this.width=v),this.height<b&&(this.height=b)}},GridLayoutGroup.prototype.setChildAlongAxis=function(t,i,o,r){0===i?t.width=r:t.height=r;var a=o;0===i?t.x=a+r*t.originX:t.y=a+r*t.originY},GridLayoutGroup.prototype.setAllChildPositionOffset=function(t){for(var i=0,o=this.layoutElements;i<o.length;i++){var r=o[i];if(0===t){var a=.5*this.width;r.x-=a}else{a=.5*this.height;r.y-=a}}},GridLayoutGroup.prototype.getStartOffset=function(t,i){var o=i+(0===t?this.paddingHorizontal():this.paddingVertical()),r=(0===t?this.width:this.height)-o,a=this.getAlignmentOnAxis(t);return(0===t?this._padding.x:this._padding.z)+r*a},GridLayoutGroup.prototype.getAlignmentOnAxis=function(t){return 0===t?this._alignmentType%3*.5:.5*Math.floor(this._alignmentType/3)},GridLayoutGroup.prototype.getCellCount=function(){var t=new Phaser.Math.Vector2;return this._constraint===c.FixedColumnCount?(t.x=this._constraintCount,this.layoutElements.length>=t.x&&(t.y=Math.floor(this.layoutElements.length/t.x)+(this.layoutElements.length%t.x>0?1:0))):this._constraint===c.FixedRowCount?(t.y=this._constraintCount,this.layoutElements.length>=t.y&&(t.x=Math.floor(this.layoutElements.length/t.y)+(this.layoutElements.length%t.y>0?1:0))):(t.x=Math.max(1,Math.floor((this.width-this.paddingHorizontal()+this._spacing.x+.001)/(this._cellSize.x+this._spacing.x))),t.y=Math.max(1,Math.floor((this.height-this.paddingVertical()+this._spacing.y+.001)/(this._cellSize.y+this._spacing.y)))),t},GridLayoutGroup.prototype.paddingHorizontal=function(){return this._padding.x+this._padding.y},GridLayoutGroup.prototype.paddingVertical=function(){return this._padding.z+this._padding.w},GridLayoutGroup.ClassName="gridLayoutGroup",GridLayoutGroup}(Phaser.GameObjects.Container);!function(t){t[t.UpperLeft=0]="UpperLeft",t[t.UpperCenter=1]="UpperCenter",t[t.UpperRight=2]="UpperRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.LowerLeft=6]="LowerLeft",t[t.LowerCenter=7]="LowerCenter",t[t.LowerRight=8]="LowerRight"}(a||(a={})),function(t){t[t.UpperLeft=0]="UpperLeft",t[t.UpperRight=1]="UpperRight",t[t.LowerLeft=2]="LowerLeft",t[t.LowerRight=3]="LowerRight"}(h||(h={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(l||(l={})),function(t){t[t.Flexible=0]="Flexible",t[t.FixedColumnCount=1]="FixedColumnCount",t[t.FixedRowCount=2]="FixedRowCount"}(c||(c={}))},function(t,i,o){"use strict";o.r(i),o.d(i,"ControlFMediator",(function(){return d}));var r,a=o(260),h=o(110),l=o(2),c=o(122),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function ControlFMediator(i,o,r){var a=t.call(this)||this;return a.mUIType=u.UIType.Tips,a.mScene=o,a.mLayerManager=i,a.world=r,a}return p(ControlFMediator,t),ControlFMediator.prototype.getName=function(){return""},ControlFMediator.prototype.getView=function(){},ControlFMediator.prototype.hide=function(){this.mShow=!1,this.mView&&this.mView.isShow()&&(this.world.roomManager.currentRoom&&this.world.roomManager.currentRoom.playerManager.actor&&this.world.roomManager.currentRoom.playerManager.actor.getState()!==c.d.WALK||(this.mView.off("control",this.handControlF,this),this.mView.destroy(),this.mView=null))},ControlFMediator.prototype.isSceneUI=function(){return!1},ControlFMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},ControlFMediator.prototype.resize=function(){this.mView&&this.mView.resize()},ControlFMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||this.mShow||(this.mView=new a.ControlFPanel(this.mScene,this.world),this.mView.on("control",this.handControlF,this),this.mLayerManager.addToUILayer(this.mView),this.mView.show(i),t.prototype.show.call(this,i))},ControlFMediator.prototype.update=function(t){},ControlFMediator.prototype.destroy=function(){this.mView&&(this.mView.off("control",this.handControlF,this),this.mView.destroy(),this.mView=null),this.mScene=null,this.mLayerManager=null,t.prototype.destroy.call(this)},ControlFMediator.prototype.handControlF=function(){if(this.world&&this.world.connection){var t,i=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN),o=i.content;t=(t=this.world.inputManager?this.world.inputManager.getKeyDowns():[]).concat(Phaser.Input.Keyboard.KeyCodes.F),o.keyCodes=t,this.world.connection.send(i)}},ControlFMediator.NAME="ControlFMediator",ControlFMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"CutInMediator",(function(){return c}));var r,a=o(261),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function CutInMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.world=r,a}return l(CutInMediator,t),CutInMediator.prototype.show=function(t){this.mView&&this.mView.isShow()||(this.mView=new a.CutInPanel(this.scene,this.world),this.mView.once("close",this.onCloseHandler,this),this.mView.show(t))},CutInMediator.prototype.onCloseHandler=function(){this.mView&&(this.mView.destroy(),this.mView=void 0)},CutInMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"CutInMenuMediator",(function(){return u}));var r,a=o(262),h=o(263),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function CutInMenuMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(CutInMenuMediator,t),CutInMenuMediator.prototype.show=function(t){this.mView||(this.mView||(this.mView=new h.CutInMenuPanel(this.scene,this.world),this.mView.on("hide",this.onHideView,this),this.mView.on("rightButton",this.onRightButtonHandler,this),this.mView.on("openmed",this.openPanelMediator,this)),this.cutInMenu||(this.cutInMenu=new a.CutInMenu(this.world),this.cutInMenu.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show(t))},CutInMenuMediator.prototype.isSceneUI=function(){return!0},CutInMenuMediator.prototype.destroy=function(){this.cutInMenu&&(this.cutInMenu.destroy(),this.cutInMenu=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},CutInMenuMediator.prototype.onRightButtonHandler=function(t,i){this.cutInMenu.reqRightButton(t,i)},CutInMenuMediator.prototype.openPanelMediator=function(t,i){var o=this.world.uiManager;i?o.showMed(t,i):o.showMed(t)},CutInMenuMediator.prototype.onHideView=function(){this.destroy()},CutInMenuMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"DialogMediator",(function(){return u}));var r,a=o(265),h=o(266),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function DialogMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(DialogMediator,t),DialogMediator.prototype.show=function(i){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new h.DialogPanel(this.scene,this.world),this.mView.on("querydialog",this.onQueryNextDialog,this),this.mView.on("hide",this.onHideHandler,this)),this.dialog||(this.dialog=new a.Dialog(this.world),this.dialog.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show(i),t.prototype.show.call(this,i))},DialogMediator.prototype.update=function(i){this.mView&&this.mView.isShow&&t.prototype.update.call(this,i)},DialogMediator.prototype.isSceneUI=function(){return!0},DialogMediator.prototype.destroy=function(){this.dialog&&(this.dialog.destroy(),this.dialog=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},DialogMediator.prototype.hide=function(){t.prototype.hide.call(this),this.destroy()},DialogMediator.prototype.onQueryNextDialog=function(t,i,o){this.dialog.queryNextDialog(t,i,o)},DialogMediator.prototype.onHideHandler=function(){this.hide(),this.destroy()},DialogMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"DragManager",(function(){return r}));var r=function(){function DragManager(t){}return DragManager.prototype.setDragProp=function(t){},DragManager}()},function(t,i,o){"use strict";o.r(i),o.d(i,"FriendInviteMediator",(function(){return p}));var r,a=o(267),h=o(2),l=o(110),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function FriendInviteMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mLayerManager=i,a.mScene=o,a}return u(FriendInviteMediator,t),FriendInviteMediator.prototype.show=function(t){if(this.mView)return this.mView.show(t),void this.mLayerManager.addToDialogLayer(this.mView);this.mView=new a.FriendInvitePanel(this.mScene,this.world),this.mView.on("hide",this.onHideHandler,this),this.mView.on("agree",this.onAgreeHandler,this),this.mView.on("targetUI",this.onTargetUIHandler,this),this.mView.show(t),this.mLayerManager.addToDialogLayer(this.mView)},FriendInviteMediator.prototype.onTargetUIHandler=function(t,i){if(this.world){var o=new l.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),r=o.content;r.uiId=t,r.componentId=i,this.world.connection.send(o),this.destroy()}},FriendInviteMediator.prototype.onAgreeHandler=function(){},FriendInviteMediator.prototype.onHideHandler=function(){this.destroy()},FriendInviteMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"FurniBagMediator",(function(){return p}));var r,a=o(269),h=o(268),l=o(2),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function FurniBagMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a.world&&a.world.roomManager&&a.world.roomManager.currentRoom?a.mScneType=a.world.roomManager.currentRoom.sceneType:a.mScneType=l.op_def.SceneTypeEnum.NORMAL_SCENE_TYPE,a}return u(FurniBagMediator,t),FurniBagMediator.prototype.show=function(){if(this.mView&&this.mView.isShow()||this.mShow)return this.layerManager.addToUILayer(this.mView),void this.addLisenter();this.mFurniBag||(this.mFurniBag=new h.FurniBag(this.world,this.mScneType),this.mFurniBag.register(),this.mFurniBag.on("packageCategory",this.onPackageCategoryHandler,this),this.mFurniBag.on("queryPackage",this.onQueryPackageHandler,this),this.mFurniBag.on("queryCommodityResource",this.onQueryCommodityResourceHandler,this),this.mFurniBag.on("queryResetAvatar",this.onResetAvatar,this),this.mFurniBag.on("avatarIDs",this.onDressAvatarIDS,this)),this.mView||(this.mView=new a.FurniBagPanel(this.scene,this.world,this.mScneType),this.mView.on("getCategories",this.onGetCategoriesHandler,this),this.mView.on("queryPackage",this.onQueryPackage,this),this.mView.on("close",this.onCloseHandler,this),this.mView.on("queryPropResource",this.onQueryPropResourceHandler,this),this.mView.on("seachPackage",this.onSeachPackageHandler,this),this.mView.on("addFurniToScene",this.onAddFurniHandler,this),this.mView.on("sellProps",this.onSellPropsHandler,this),this.mView.on("querySaveAvatar",this.onQuerySaveAvatar,this),this.mView.on("queryResetAvatar",this.onQueryResetAvatar,this),this.mView.on("queryDressAvatarIDS",this.queryDressAvatarIDS,this),this.mView.on("useprops",this.onUsePropsHandler,this)),this.mView.show(),this.layerManager.addToUILayer(this.mView),this.addLisenter()},FurniBagMediator.prototype.destroy=function(){this.mFurniBag&&(this.mFurniBag.destroy(),this.mFurniBag=void 0),t.prototype.destroy.call(this),this.removeLisenter()},Object.defineProperty(FurniBagMediator.prototype,"playerData",{get:function(){if(this.bag)return this.bag.playerData},enumerable:!1,configurable:!0}),Object.defineProperty(FurniBagMediator.prototype,"bag",{get:function(){if(this.world.user&&this.world.user.bag)return this.world.user.bag},enumerable:!1,configurable:!0}),FurniBagMediator.prototype.onCloseHandler=function(){this.destroy()},FurniBagMediator.prototype.addLisenter=function(){if(this.bag){var t=this.bag;t&&(t.on("syncfinish",this.onSyncFinishHandler,this),t.on("update",this.onUpdateHandler,this))}},FurniBagMediator.prototype.removeLisenter=function(){if(this.bag){var t=this.bag;t&&(t.off("syncfinish",this.onSyncFinishHandler,this),t.off("update",this.onUpdateHandler,this))}},FurniBagMediator.prototype.onSyncFinishHandler=function(){this.mView&&this.mView.queryRefreshPackage()},FurniBagMediator.prototype.onUpdateHandler=function(){this.mView&&this.mView.queryRefreshPackage(!0)},FurniBagMediator.prototype.onPackageCategoryHandler=function(t){this.mView&&this.mView.setCategories(t)},FurniBagMediator.prototype.onQueryCommodityResourceHandler=function(t){this.mView.setSelectedResource(t)},FurniBagMediator.prototype.onGetCategoriesHandler=function(t){this.mFurniBag&&this.mFurniBag.getCategories(t)},FurniBagMediator.prototype.onQueryPackageHandler=function(t){this.mView.setProp(t.items)},FurniBagMediator.prototype.onQueryPackage=function(t,i,o){if(this.playerData){var r=this.playerData.getItemsByCategory(t,i);this.mView.setProp(r,o)}},FurniBagMediator.prototype.onQueryPropResourceHandler=function(t){this.mFurniBag.queryCommodityResource(t.id)},FurniBagMediator.prototype.onQuerySaveAvatar=function(t){this.mFurniBag.querySaveAvatar(t)},FurniBagMediator.prototype.onQueryResetAvatar=function(t){this.mFurniBag.queryResetAvatar(t)},FurniBagMediator.prototype.onSeachPackageHandler=function(t,i){this.mFurniBag.seachPackage(t,i)},FurniBagMediator.prototype.onAddFurniHandler=function(t){this.mView.enableEdit?this.mFurniBag.enterEditAndSelectedSprite(t):this.mFurniBag.addFurniToScene(t),this.destroy()},FurniBagMediator.prototype.onSellPropsHandler=function(t,i,o){this.mFurniBag.sellProps(t,i,o)},FurniBagMediator.prototype.onUsePropsHandler=function(t,i){this.mFurniBag.useProps(t,i)},FurniBagMediator.prototype.onResetAvatar=function(t){this.mView.resetAvatar(t)},FurniBagMediator.prototype.onDressAvatarIDS=function(t){this.mView.setDressAvatarIds(t)},FurniBagMediator.prototype.queryDressAvatarIDS=function(){this.mFurniBag.queryDressAvatarItemIDs()},FurniBagMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"GMToolsMediator",(function(){return p}));var r,a=o(270),h=o(2),l=o(110),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function GMToolsMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return u(GMToolsMediator,t),GMToolsMediator.prototype.show=function(i){if(t.prototype.show.call(this,i),this.mView)return this.mView.show(i),void this.layerMgr.addToUILayer(this.mView);this.mView=new a.GMToolsPanel(this.scene,this.world),this.mView.on("close",this.onCloseHandler,this),this.mView.on("targetUI",this.onTargetUIHandler,this),this.mView.show(i),this.layerMgr.addToUILayer(this.mView)},GMToolsMediator.prototype.update=function(t){this.mView&&this.mView.show(t)},GMToolsMediator.prototype.hide=function(){this.destroy()},GMToolsMediator.prototype.onCloseHandler=function(){this.hide()},GMToolsMediator.prototype.onTargetUIHandler=function(t,i,o){if(this.world){var r=new l.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),a=r.content;a.uiId=t,a.componentId=i,a.strData=o,this.world.connection.send(r)}},GMToolsMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemDetailMediator",(function(){return d}));var r,a=o(275),h=o(2),l=o(110),c=o(121),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function ItemDetailMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mScene=o,a.mUIType=u.UIType.Tips,a.mLayerManager=i,a}return p(ItemDetailMediator,t),ItemDetailMediator.prototype.isSceneUI=function(){return!1},ItemDetailMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},ItemDetailMediator.prototype.show=function(t){this.mView&&this.isShow()||(this.mView=new a.ItemDetail(this.mScene,this.world),this.mView.show(t),this.mLayerManager.addToToolTipsLayer(this.mView),this.mScene.input.on("gameobjectdown",this.onBtnHandler,this),this.mShow=!0)},ItemDetailMediator.prototype.update=function(i){t.prototype.update.call(this,i)},ItemDetailMediator.prototype.hide=function(){this.mView&&(this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),this.mView.hide(),this.mView=null,t.prototype.hide.call(this))},ItemDetailMediator.prototype.destroy=function(){this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),t.prototype.destroy.call(this)},ItemDetailMediator.prototype.onBtnHandler=function(t,i){if(i&&i instanceof c.NinePatchButton){var o=this.mParam[0],r=new l.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),a=r.content;a.uiId=o.id,a.componentId=i.getBtnData().node.id,this.world.connection.send(r)}},ItemDetailMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"ItemPopCardMediator",(function(){return c}));var r,a=o(276),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function ItemPopCardMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.world=r,a.layerManager=i,a}return l(ItemPopCardMediator,t),ItemPopCardMediator.prototype.show=function(t){this.mView&&this.mView.isShow()||this.mShow||(this.mView=new a.ItemPopCardPanel(this.scene,this.world),this.mView.show(t),this.mView.on("close",this.onCloseHandler,this),this.layerManager.addToDialogLayer(this.mView))},ItemPopCardMediator.prototype.onCloseHandler=function(){this.mView&&(this.mView.hide(),this.mView=void 0)},ItemPopCardMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"LoginMediator",(function(){return d}));var r,a=o(0),h=o(277),l=o(278),c=o(135),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function LoginMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a}return p(LoginMediator,t),LoginMediator.prototype.show=function(){this.mView||(this.mView=new h.LoginPanel(this.layerManager.scene,this.world)),this.mView.show(),this.mView.on("fetchCode",this.onFetchCodeHandler,this),this.mView.on("login",this.onLoginHandler,this),this.mView.on("error",this.onLoginErrorHanler,this),this.layerManager.addToUILayer(this.mView)},LoginMediator.prototype.destroy=function(){t.prototype.destroy.call(this),this.verifiedPanel&&(this.verifiedPanel.destroy(),this.verifiedPanel=null)},LoginMediator.prototype.onFetchCodeHandler=function(t,i){this.world.httpService.requestPhoneCode(t,i)},LoginMediator.prototype.enterGame=function(t){var i=this;if(this.world.httpClock&&(this.world.httpClock.enable=!t),t)return this.destroy(),void this.world.enterGame();this.world.httpClock.allowLogin((function(){i.mView.setInputVisible(!0)})).then((function(t){t?(i.destroy(),i.world.enterGame()):i.mView.setInputVisible(!1)})).catch((function(t){i.onLoginErrorHanler("服务器错误，请与管管联系！","确定"),a.a.getInstance().error(t)}))},LoginMediator.prototype.onLoginHandler=function(t,i,o){var r=this;this.mView.setLoginEnable(!1),this.world.httpService.loginByPhoneCode(t,i,o).then((function(i){if(200===i.code||201===i.code){var o=i.data;r.world.account.setAccount(o),localStorage.setItem("accountphone",JSON.stringify({account:t}));var a=Object({debug:!0,api_root:"https://api-dev.tooqing.com/",osd:"https://osd-alpha.tooqing.com/",gateway:Object({host:"gdev.tooqing.com",port:11100,secure:!0}),game_id:"5cd8cf04cbcbf91a0afc3f96.5e410ba50681ad5557b4d6e9",virtual_world_id:"0"}).verified_enable;if(void 0!==a&&!1===a)return void r.enterGame(!a);o.hasIdentityInfo?r.enterGame(o.adult):(r.mView.setInputVisible(!1),r.onShowVerified())}else i.code>=400&&r.onLoginErrorHanler(i.msg||"服务器错误");r.mView.setLoginEnable(!0)}))},LoginMediator.prototype.onShowVerified=function(){this.verifiedPanel||(this.verifiedPanel=new l.VerifiedPanel(this.layerManager.scene,this.world)),this.verifiedPanel.isShow()||(this.verifiedPanel.show(),this.verifiedPanel.on("verified",this.onVerifiedHandler,this),this.verifiedPanel.on("error",this.onShowErrorHandler,this),this.layerManager.addToDialogLayer(this.verifiedPanel))},LoginMediator.prototype.onShowErrorHandler=function(t,i){var o=this;this.verifiedPanel.setVerifiedEnable(!1),new c.AlertView(this.layerManager.scene,this.world).setOKText(i||"重新输入").show({text:t||"[color=#F9361B]证件格式有误[/color]",title:"提示",callback:function(){o.verifiedPanel.setVerifiedEnable(!0)},btns:c.Buttons.Ok})},LoginMediator.prototype.onLoginErrorHanler=function(t,i){var o=this;this.mView.setInputVisible(!1),new c.AlertView(this.layerManager.scene,this.world).setOKText(i||"重新输入").show({text:t,title:"提示",callback:function(){o.mView.setInputVisible(!0)},btns:c.Buttons.Ok})},LoginMediator.prototype.onVerifiedHandler=function(t,i){var o=this;this.world.httpService.verified(t,i).then((function(t){var i=t.code;t.data;200===i||201===i||0===i?o.enterGame(!0):(10001===i||i>=400)&&(o.verifiedPanel.setVerifiedEnable(!1),o.onShowErrorHandler("[color=#F9361B]实名认证失败，身份证号码有误\n请如实进行实名认证！[/color]","重新认证"))}))},LoginMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"MessageBoxMediator",(function(){return d}));var r,a=o(279),h=o(121),l=o(2),c=o(110),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function MessageBoxMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mScene=o,a.mLayerManager=i,a.mUIType=u.UIType.Tips,a}return p(MessageBoxMediator,t),MessageBoxMediator.prototype.isSceneUI=function(){return!1},MessageBoxMediator.prototype.isShow=function(){return!!this.mView&&this.mView.isShow()},MessageBoxMediator.prototype.show=function(i){this.mView&&this.isShow()||(this.mView=new a.MessageBoxView(this.mScene,this.world),this.mView.show(i),this.mLayerManager.addToToolTipsLayer(this.mView),this.mScene.input.on("gameobjectdown",this.onBtnHandler,this),t.prototype.show.call(this,i))},MessageBoxMediator.prototype.update=function(i){t.prototype.update.call(this,i)},MessageBoxMediator.prototype.hide=function(){this.mShow=!1,this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),this.mView&&(this.mView.hide(),this.mView=null)},MessageBoxMediator.prototype.destroy=function(){this.mScene.input.off("gameobjectdown",this.onBtnHandler,this),t.prototype.destroy.call(this)},MessageBoxMediator.prototype.onBtnHandler=function(t,i){if(i&&i instanceof h.NinePatchButton){var o=i.getBtnData();if(!o)return;var r=this.mParam[0],a=new c.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),u=a.content;u.uiId=r.id,u.componentId=o.node.id,this.world.connection.send(a)}},MessageBoxMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessMarketingPlanMediator",(function(){return p}));var r,a=o(2),h=o(281),l=o(282),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicBusinessMarketingPlanMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return u(PicBusinessMarketingPlanMediator,t),PicBusinessMarketingPlanMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow?this.layerMgr.addToUILayer(this.mView):(this.mView||(this.mView=new l.default(this.scene,this.world),this.mView.on("queryplanmodels",this.query_MARKET_PLAN_MODELS_BY_TYPE,this),this.mView.on("querymarketplan",this.query_Equiped_MARKET_PLAN,this),this.mView.on("queryselectplan",this.query_SELECT_MARKET_PLAN,this),this.mView.on("hide",this.onHidePanel,this)),this.picPlan||(this.picPlan=new h.PicBusinessMarketingPlan(this.world),this.picPlan.on("onequipedplan",this.onEquiped_MARKET_PLAN,this),this.picPlan.on("onplanmodels",this.onMARKET_PLAN_MODELS_BY_TYPE,this),this.picPlan.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicBusinessMarketingPlanMediator.prototype.destroy=function(){this.picPlan&&(this.picPlan.destroy(),this.picPlan=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},Object.defineProperty(PicBusinessMarketingPlanMediator.prototype,"playerData",{get:function(){return this.bag?this.bag.playerData:null},enumerable:!1,configurable:!0}),Object.defineProperty(PicBusinessMarketingPlanMediator.prototype,"bag",{get:function(){var t=this.world.user;if(t&&t.bag)return t.bag},enumerable:!1,configurable:!0}),PicBusinessMarketingPlanMediator.prototype.onHidePanel=function(){this.destroy()},PicBusinessMarketingPlanMediator.prototype.query_MARKET_PLAN_MODELS_BY_TYPE=function(t){this.picPlan.query_MARKET_PLAN_MODELS_BY_TYPE(t)},PicBusinessMarketingPlanMediator.prototype.query_Equiped_MARKET_PLAN=function(){var t=this.world.uiManager.getMediator("PicaMainUIMediator").roomInfo.roomId;this.picPlan.query_Equiped_MARKET_PLAN(t)},PicBusinessMarketingPlanMediator.prototype.query_SELECT_MARKET_PLAN=function(t){var i=this.world.uiManager.getMediator("PicaMainUIMediator").roomInfo.roomId;this.picPlan.query_SELECT_MARKET_PLAN(i,t)},PicBusinessMarketingPlanMediator.prototype.onEquiped_MARKET_PLAN=function(t){this.mView.setEquipedPlan(t)},PicBusinessMarketingPlanMediator.prototype.onMARKET_PLAN_MODELS_BY_TYPE=function(t){if(this.mView.setPlanModels(t),t.marketPlan)for(var i=0,o=t.marketPlan;i<o.length;i++){var r=o[i].requirements;this.updateMaterials(r)}},PicBusinessMarketingPlanMediator.prototype.updateMaterials=function(t){if(this.playerData&&t)for(var i=0,o=t;i<o.length;i++){var r=o[i],h=this.playerData.getItemsCount(a.op_pkt_def.PKT_PackageType.PropPackage,r.id,r.subcategory);r.count=h}},PicBusinessMarketingPlanMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicBusinessStreetMediator",(function(){return u}));var r,a=o(293),h=o(290),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicBusinessStreetMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(PicBusinessStreetMediator,t),PicBusinessStreetMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow?this.layerMgr.addToUILayer(this.mView):(this.mView||(this.mView=new a.default(this.scene,this.world),this.mView.on("querymystore",this.queryMyStoreList,this),this.mView.on("queryallsaves",this.query_TAKE_ALL_STORE_SAVINGS,this),this.mView.on("querystreet",this.query_COMMERCIAL_STREET,this),this.mView.on("querymodels",this.query_INDUSTRY_MODELS,this),this.mView.on("querycreatestore",this.query_CREATE_STORE,this),this.mView.on("queryenterroom",this.query_ENTER_ROOM,this),this.mView.on("queryranklist",this.query_RANKING_LIST,this),this.mView.on("queryrankdetail",this.query_STORE_RANKING_DETAIL,this),this.mView.on("queryrankreward",this.query_STORE_RANKING_REWARD,this),this.mView.on("queryenterhistory",this.query_STORE_ENTER_HISTORY,this),this.mView.on("hide",this.onHidePanel,this)),this.picStreet||(this.picStreet=new h.PicBusinessStreet(this.world),this.picStreet.on("onmystore",this.onMyStoreList,this),this.picStreet.on("onstreet",this.onCOMMERCIAL_STREET,this),this.picStreet.on("onmodels",this.onINDUSTRY_MODELS,this),this.picStreet.on("onranklist",this.onSTORE_RANKING_LIST,this),this.picStreet.on("onrankdetail",this.onSTORE_RANKING_DETAIL,this),this.picStreet.on("onrankreward",this.onSTORE_RANKING_REWARD,this),this.picStreet.on("onenterhistory",this.onSTORE_ENTER_HISTORY,this),this.picStreet.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicBusinessStreetMediator.prototype.destroy=function(){this.picStreet&&(this.picStreet.destroy(),this.picStreet=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},PicBusinessStreetMediator.prototype.onHidePanel=function(){this.destroy()},PicBusinessStreetMediator.prototype.queryMyStoreList=function(){this.picStreet.query_My_STORE()},PicBusinessStreetMediator.prototype.query_TAKE_ALL_STORE_SAVINGS=function(){this.picStreet.query_TAKE_ALL_STORE_SAVINGS()},PicBusinessStreetMediator.prototype.query_COMMERCIAL_STREET=function(t,i){this.picStreet.query_COMMERCIAL_STREET(t,i)},PicBusinessStreetMediator.prototype.query_INDUSTRY_MODELS=function(){this.picStreet.query_INDUSTRY_MODELS()},PicBusinessStreetMediator.prototype.query_CREATE_STORE=function(t){this.picStreet.query_CREATE_STORE(t)},PicBusinessStreetMediator.prototype.query_ENTER_ROOM=function(t,i){this.picStreet.query_ENTER_ROOM(t,i)},PicBusinessStreetMediator.prototype.query_RANKING_LIST=function(){this.picStreet.query_RANKING_LIST()},PicBusinessStreetMediator.prototype.query_STORE_RANKING_DETAIL=function(t,i){this.picStreet.query_STORE_RANKING_DETAIL(t,i)},PicBusinessStreetMediator.prototype.query_STORE_RANKING_REWARD=function(t,i){this.picStreet.query_STORE_RANKING_REWARD(t,i)},PicBusinessStreetMediator.prototype.query_STORE_ENTER_HISTORY=function(){this.picStreet.query_STORE_ENTER_HISTORY()},PicBusinessStreetMediator.prototype.onMyStoreList=function(t){this.mView.setMyStore(t)},PicBusinessStreetMediator.prototype.onCOMMERCIAL_STREET=function(t){this.mView.setCommercialStreet(t)},PicBusinessStreetMediator.prototype.onINDUSTRY_MODELS=function(t){this.mView.setIndustryModels(t)},PicBusinessStreetMediator.prototype.onSTORE_RANKING_LIST=function(t){this.mView.setStoreRankingList(t)},PicBusinessStreetMediator.prototype.onSTORE_RANKING_DETAIL=function(t){this.mView.setStoreRankingDetial(t)},PicBusinessStreetMediator.prototype.onSTORE_RANKING_REWARD=function(t){this.mView.setStoreRankingReward(t)},PicBusinessStreetMediator.prototype.onSTORE_ENTER_HISTORY=function(t){this.mView.setEnterHistory(t)},PicBusinessStreetMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHouseMediator",(function(){return u}));var r,a=o(296),h=o(294),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicHouseMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return c(PicHouseMediator,t),PicHouseMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow?this.layerManager.addToUILayer(this.mView):(this.picHouse||(this.picHouse=new h.PicHouse(this.world),this.picHouse.on("roominfo",this.onRoomInfoHandler,this),this.picHouse.on("refurbish",this.on_REFURBISH_REQUIREMENTS,this),this.picHouse.register()),this.mView||(this.mView=new a.PicHousePanel(this.scene,this.world),this.mView.on("hide",this.onHideHandler,this),this.mView.on("scenedecorate",this.onSendEnterDecorate,this),this.mView.on("queryrequirements",this.query_REFURBISH_REQUIREMENTS,this),this.mView.on("queryrefurbish",this.query_ROOM_REFURBISH,this)),this.mView.show(),this.layerManager.addToUILayer(this.mView),this.queryRoomInfoHandler())},PicHouseMediator.prototype.hide=function(){t.prototype.hide.call(this),this.layerManager.removeToUILayer(this.mView)},PicHouseMediator.prototype.getView=function(){return this.mView},PicHouseMediator.prototype.destroy=function(){this.picHouse&&(this.picHouse.destroy(),this.picHouse=void 0),t.prototype.destroy.call(this)},PicHouseMediator.prototype.onRoomInfoHandler=function(t){var i=this.world.uiManager.getMediator("PicaMainUIMediator");this.mView.setRoomInfoData(t,i.isSelfRoom)},PicHouseMediator.prototype.queryRoomInfoHandler=function(){var t=this.world.uiManager.getMediator("PicaMainUIMediator").roomInfo;t&&this.picHouse.queryRoomInfo(t.roomId)},PicHouseMediator.prototype.query_REFURBISH_REQUIREMENTS=function(t){this.picHouse.query_REFURBISH_REQUIREMENTS(t)},PicHouseMediator.prototype.query_ROOM_REFURBISH=function(t){this.picHouse.query_ROOM_REFURBISH(t)},PicHouseMediator.prototype.on_REFURBISH_REQUIREMENTS=function(t){this.mView.on_REFURBISH_REQUIREMENTS(t)},PicHouseMediator.prototype.onHideHandler=function(){this.destroy()},PicHouseMediator.prototype.onSendEnterDecorate=function(){this.picHouse.sendEnterDecorate()},PicHouseMediator}(l.BaseMediator)},function(t,i){},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOpenPartyMediator",(function(){return u}));var r,a=o(109),h=o(300),l=o(298),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicOpenPartyMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(PicOpenPartyMediator,t),PicOpenPartyMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new h.PicOpenPartyPanel(this.scene,this.world),this.mView.on("close",this.onCloseHandler,this)),this.picOrder||(this.picOrder=new l.PicOpenParty(this.world),this.picOrder.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicOpenPartyMediator.prototype.isSceneUI=function(){return!0},PicOpenPartyMediator.prototype.destroy=function(){this.picOrder&&(this.picOrder.destroy(),this.picOrder=void 0),t.prototype.destroy.call(this)},PicOpenPartyMediator.prototype.onCloseHandler=function(){this.destroy()},PicOpenPartyMediator}(a.BaseMediator)},function(t,i){},function(t,i,o){"use strict";o.r(i),o.d(i,"PicOrderMediator",(function(){return p}));var r,a=o(2),h=o(302),l=o(301),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicOrderMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return u(PicOrderMediator,t),PicOrderMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new h.PicOrderPanel(this.scene,this.world),this.mView.on("questlist",this.query_ORDER_LIST,this),this.mView.on("changeorder",this.query_CHANGE_ORDER_STAGE,this),this.mView.on("questprogress",this.query_PLAYER_PROGRESS,this),this.mView.on("questreward",this.query_PLAYER_PROGRESS_REWARD,this),this.mView.on("hide",this.onHideView,this)),this.picOrder||(this.picOrder=new l.PicOrder(this.world),this.picOrder.on("questlist",this.on_ORDER_LIST,this),this.picOrder.on("progresslist",this.on_PLAYER_PROGRESS,this),this.picOrder.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicOrderMediator.prototype.isSceneUI=function(){return!0},PicOrderMediator.prototype.destroy=function(){this.picOrder&&(this.picOrder.destroy(),this.picOrder=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},Object.defineProperty(PicOrderMediator.prototype,"playerData",{get:function(){var t=this.world.user;if(t&&t.bag)return t.bag.playerData},enumerable:!1,configurable:!0}),PicOrderMediator.prototype.query_ORDER_LIST=function(){this.picOrder.query_ORDER_LIST()},PicOrderMediator.prototype.query_CHANGE_ORDER_STAGE=function(t,i){this.picOrder.query_CHANGE_ORDER_STAGE(t,i)},PicOrderMediator.prototype.query_PLAYER_PROGRESS=function(){this.picOrder.query_PLAYER_PROGRESS()},PicOrderMediator.prototype.query_PLAYER_PROGRESS_REWARD=function(t){this.picOrder.query_PLAYER_PROGRESS_REWARD(t)},PicOrderMediator.prototype.on_ORDER_LIST=function(t){for(var i=0,o=t.orders;i<o.length;i++){var r=o[i].targets;if(r)for(var h=0,l=r;h<l.length;h++){var c=l[h],u=this.playerData.getItemsCount(a.op_pkt_def.PKT_PackageType.PropPackage,c.id,c.subcategory);c.count=u}}this.mView.setOrderDataList(t)},PicOrderMediator.prototype.on_PLAYER_PROGRESS=function(t){this.mView.setOrderProgress(t)},PicOrderMediator.prototype.onHideView=function(){this.destroy()},PicOrderMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPartyListMediator",(function(){return u}));var r,a=o(109),h=o(303),l=o(304),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicPartyListMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(PicPartyListMediator,t),PicPartyListMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new l.PicPartyListPanel(this.scene,this.world),this.mView.on("close",this.onCloseHandler,this)),this.picList||(this.picList=new h.PicPartyList(this.world),this.picList.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicPartyListMediator.prototype.isSceneUI=function(){return!0},PicPartyListMediator.prototype.destroy=function(){t.prototype.destroy.call(this),this.picList&&(this.picList.destroy(),this.picList=void 0)},PicPartyListMediator.prototype.onCloseHandler=function(){this.destroy()},PicPartyListMediator}(a.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPropFunConfig",(function(){return r}));var r=function r(){}},function(t,i,o){"use strict";o.r(i),o.d(i,"PicPropFunMediator",(function(){return c}));var r,a=o(306),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicPropFunMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return l(PicPropFunMediator,t),PicPropFunMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.PicPropFunPanel(this.scene,this.world),this.mView.on("close",this.onCloseHandler,this)),this.mView.show(this.mParam)),this.layerManager.addToUILayer(this.mView)},PicPropFunMediator.prototype.getView=function(){return this.mView},PicPropFunMediator.prototype.onCloseHandler=function(){this.destroy()},PicPropFunMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicRoomUpgradeMediator",(function(){return u}));var r,a=o(308),h=o(307),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicRoomUpgradeMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return c(PicRoomUpgradeMediator,t),PicRoomUpgradeMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.picRoom||(this.picRoom=new h.PicRoomUpgrade(this.world),this.picRoom.register()),this.mView||(this.mView=new a.PicRoomUpgradePanel(this.scene,this.world),this.mView.on("querytargetui",this.onQueryTargetUI,this)),this.mView.show(this.mParam)),this.layerManager.addToUILayer(this.mView)},PicRoomUpgradeMediator.prototype.hide=function(){t.prototype.hide.call(this),this.layerManager.removeToUILayer(this.mView)},PicRoomUpgradeMediator.prototype.getView=function(){return this.mView},PicRoomUpgradeMediator.prototype.destroy=function(){this.picRoom&&(this.picRoom.destroy(),this.picRoom=void 0),t.prototype.destroy.call(this)},PicRoomUpgradeMediator.prototype.onQueryTargetUI=function(t){this.picRoom.queryTargetUI(t),this.destroy()},PicRoomUpgradeMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicWorkMediator",(function(){return u}));var r,a=o(310),h=o(309),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function PicWorkMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(PicWorkMediator,t),PicWorkMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.PicWorkPanel(this.scene,this.world),this.mView.on("questlist",this.query_ORDER_LIST,this),this.mView.on("questwork",this.query_WORK_ON_JOB,this),this.mView.on("hide",this.onHideView,this)),this.picWork||(this.picWork=new h.PicWork(this.world),this.picWork.on("questlist",this.on_ORDER_LIST,this),this.picWork.on("updateplayer",this.onUpdatePlayerInfo,this),this.picWork.register()),this.layerMgr.addToUILayer(this.mView),this.mView.show())},PicWorkMediator.prototype.isSceneUI=function(){return!0},PicWorkMediator.prototype.destroy=function(){this.picWork&&(this.picWork.destroy(),this.picWork=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},Object.defineProperty(PicWorkMediator.prototype,"playerInfo",{get:function(){if(!this.mPlayerInfo){var t=this.world.uiManager.getMediator("PicaMainUIMediator");t&&(this.mPlayerInfo=t.playerInfo)}return this.mPlayerInfo},enumerable:!1,configurable:!0}),PicWorkMediator.prototype.query_ORDER_LIST=function(){this.picWork.query_JOB_LIST()},PicWorkMediator.prototype.query_WORK_ON_JOB=function(t){this.picWork.query_WORK_ON_JOB(t)},PicWorkMediator.prototype.on_ORDER_LIST=function(t){this.mView.setWorkDataList(t),this.onUpdatePlayerInfo(this.playerInfo)},PicWorkMediator.prototype.onUpdatePlayerInfo=function(t){this.mView&&this.mView.setProgressData(t.energy,t.workChance)},PicWorkMediator.prototype.onHideView=function(){this.destroy()},PicWorkMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicHandheldPanel",(function(){return p}));var r,a=o(2),h=o(116),l=o(111),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicHandheldPanel(i,o,r,a,h,l,c,u){var p=t.call(this,i,o,r)||this;return p.isExtendsGrid=!1,p.key=l,p.dpr=c,p.zoom=u,p.setSize(a,h),p.init(),p}return u(PicHandheldPanel,t),PicHandheldPanel.prototype.destroy=function(){this.mPropGrid&&this.mPropGrid.destroy(),t.prototype.destroy.call(this)},PicHandheldPanel.prototype.setEqipedDatas=function(t){var i=t.handheld,o=(i=i.sort((function(t,i){return t.latestUse>=i.latestUse?1:-1}))).splice(0,3);i=i.sort((function(t,i){return t.recommended>=i.recommended?1:-1})),i=o.concat(i);var r,h=a.op_client.CountablePackageItem.create({id:"empty_handed",count:0});if(""!==t.currentHandheldId&&t.currentHandheldId)for(var l=0,c=i;l<c.length;l++){var u=c[l];if(u.id===t.currentHandheldId){r=u;break}}else r=h;if(i.unshift(h),this.isExtendsGrid){var p=14-i.length,d=p>0?i.concat(new Array(p)):i;if(this.mPropGrid.setItems(d),r)for(var m=0,y=this.mPropGrid.getCells();m<y.length;m++){var g=y[m];if(g&&g.container){var _=g.container;_.itemData===r?(_.isSelect=!0,this.curHandheldItem=g):_.isSelect=!1}}}},PicHandheldPanel.prototype.init=function(){var t=this,i=this.scene.make.graphics(void 0,!1);i.fillStyle(3355443,.5),i.fillRect(.5*-this.width,.5*-this.height,this.width,this.height),this.add(i);var o=this.scene.textures.getFrame(this.key,"equp_bg"),r=o.width+10*this.dpr,a=o.height+10*this.dpr,h={x:0,y:0,table:{width:this.width-20*this.dpr,height:120*this.dpr,columns:2,cellWidth:r,cellHeight:a,reuseCellContainer:!0,cellOriginX:.5,cellOriginY:.5,zoom:this.scale},scrollMode:1,clamplChildOY:!1,createCellContainerCallback:function(i,o){var r=i.scene,a=i.item;return null===o&&(o=new d(r,0,0,t.key,t.dpr)),o.setItemData(a),o}};this.mPropGrid=new c.GameGridTable(this.scene,h),this.mPropGrid.layout(),this.mPropGrid.on("cellTap",(function(i){t.onSelectItemHandler(i)})),this.add(this.mPropGrid)},PicHandheldPanel.prototype.onSelectItemHandler=function(t){var i=t.itemData;i&&(this.curHandheldItem&&(this.curHandheldItem.isSelect=!1),t.isSelect=!0,this.curHandheldItem=t,t.isEmptyHanded?this.emit("clearhandheld"):this.emit("changehandheld",i.id))},PicHandheldPanel.prototype.onShortcutHandler=function(t){this.emit("clearhandheld")},PicHandheldPanel}(Phaser.GameObjects.Container),d=function(t){function HandheldItem(i,o,r,a,l){var c=t.call(this,i,o,r)||this;return c.mIsSelect=!1,c.dpr=l,c.key=a,c.bg=c.scene.make.image({key:a,frame:"equp_bg"}),c.selectbg=c.scene.make.image({key:a,frame:"click_bg"}),c.icon=new h.DynamicImage(i,0,0),c.add([c.bg,c.selectbg,c.icon]),c.setSize(c.selectbg.width,c.selectbg.height),c.isSelect=!1,c}return u(HandheldItem,t),HandheldItem.prototype.setItemData=function(t){var i=this;if(this.itemData=t,!t)return this.icon.visible=!1,void(this.selectbg.visible=!1);if(this.icon.visible=!0,this.selectbg.visible=this.mIsSelect,this.isEmptyHanded)this.icon.setTexture(this.key,"empty_handed");else{var o=t.display,r=l.i.getOsdRes(o.texturePath);this.icon.load(r,this,(function(){i.icon.displayWidth=34*i.dpr,i.icon.scaleY=i.icon.scaleX}))}},Object.defineProperty(HandheldItem.prototype,"isSelect",{get:function(){return this.mIsSelect},set:function(t){this.mIsSelect=t,this.selectbg.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(HandheldItem.prototype,"isEmptyHanded",{get:function(){return!(!this.itemData||"empty_handed"!==this.itemData.id)},enumerable:!1,configurable:!0}),HandheldItem}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaMessageBoxMediator",(function(){return p}));var r,a=o(311),h=o(2),l=o(110),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicaMessageBoxMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return u(PicaMessageBoxMediator,t),PicaMessageBoxMediator.prototype.show=function(t){this.mParam=t,this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new a.PicaMessageBoxPanel(this.scene,this.world),this.mView.on("click",this.onClickHandler,this)),this.mView.show(t),this.layerManager.addToDialogLayer(this.mView))},PicaMessageBoxMediator.prototype.hide=function(){t.prototype.hide.call(this),t.prototype.destroy.call(this)},PicaMessageBoxMediator.prototype.onClickHandler=function(t){if(t.local)t.clickhandler&&t.clickhandler.run(),this.hide();else{var i=this.mParam[0],o=new l.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),r=o.content;r.uiId=i.id,r.componentId=t.node.id,this.world.connection.send(o)}},PicaMessageBoxMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaNavigateMediator",(function(){return d}));var r,a=o(313),h=o(148),l=o(312),c=o(166),u=o(109),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function PicaNavigateMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return p(PicaNavigateMediator,t),PicaNavigateMediator.prototype.show=function(){if(this.mView&&this.mView.isShow()||this.mShow)return this.mView.show(),void this.layerManager.addToUILayer(this.mView);this.mView||(this.mView=new a.PicaNavigatePanel(this.scene,this.world),this.mView.on("showPanel",this.onShowPanelHandler,this),this.mView.on("close",this.onCloseHandler,this),this.mView.on("goHome",this.onGomeHomeHandler,this)),this.picaNa||(this.picaNa=new l.PicaNavigate(this.world)),this.mView.show(),this.layerManager.addToUILayer(this.mView)},PicaNavigateMediator.prototype.isSceneUI=function(){return!1},PicaNavigateMediator.prototype.destroy=function(){this.picaNa&&(this.picaNa.destroy(),this.picaNa=void 0),t.prototype.destroy.call(this)},PicaNavigateMediator.prototype.onCloseHandler=function(){if(this.world){var t=this.world.uiManager;t.showExistMed(h.PicaChatMediator.name,""),t.showExistMed(c.PicHandheldMediator.name,""),this.destroy()}},PicaNavigateMediator.prototype.onShowPanelHandler=function(t,i){if(t&&this.world){var o=this.world.uiManager;i?o.showMed(t,i):o.showMed(t)}},PicaNavigateMediator.prototype.onGomeHomeHandler=function(){this.picaNa.queryGOHomeHandler()},PicaNavigateMediator.NAME="PicaNavigateMediator",PicaNavigateMediator}(u.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaNoticeMediator",(function(){return c}));var r,a=o(314),h=o(109),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function PicaNoticeMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.scene=o,a.panelQueue=[],a.world=r,a}return l(PicaNoticeMediator,t),PicaNoticeMediator.prototype.show=function(t){var i=new a.PicaNoticePanel(this.scene,this.world);if(i.once("close",this.onCloseHandler,this),this.mView){var o={param:t,view:i};this.panelQueue.push(o)}else this.mView=i,this.mView.show(t)},PicaNoticeMediator.prototype.onCloseHandler=function(){if(this.mView&&(this.mView.destroy(),this.mView=void 0),this.panelQueue.length>0){var t=this.panelQueue.shift();t.view.show(t.param)}},PicaNoticeMediator}(h.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"PicaRoomListMediator",(function(){return p}));var r,a=o(315),h=o(316),l=o(0),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PicaRoomListMediator(i,o,r){var a=t.call(this)||this;return a.layerManager=i,a.world=r,a.scene=a.layerManager.scene,a}return u(PicaRoomListMediator,t),PicaRoomListMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.roomList=new h.RoomList(this.world),this.roomList.register(),this.roomList.on("myRoomList",this.updateMyRoomListHandler,this),this.roomList.on("roomList",this.updateRoomListHandler,this),this.roomList.on("enterRoomResult",this.onEnterRoomResuleHandler,this),this.mView||(this.mView=new a.PicaRoomListPanel(this.scene,this.world)),this.mView.on("close",this.onCloseHandler,this),this.mView.on("getRoomList",this.onGetRoomListHandler,this),this.mView.on("getMyRoomList",this.onGetMyRoomListHandler,this),this.mView.on("enterRoom",this.onEnterRoomHandler,this),this.mView.show()),this.layerManager.addToUILayer(this.mView)},PicaRoomListMediator.prototype.getView=function(){return this.mView},PicaRoomListMediator.prototype.destroy=function(){this.roomList&&this.roomList.destroy(),this.mView&&(this.mView.destroy(),this.mView=void 0),t.prototype.destroy.call(this)},PicaRoomListMediator.prototype.onCloseHandler=function(){this.destroy()},PicaRoomListMediator.prototype.updateRoomListHandler=function(t){this.mView&&this.mView.updateRoomList(t)},PicaRoomListMediator.prototype.updateMyRoomListHandler=function(t){this.mView&&this.mView.updateMyRoomList(t)},PicaRoomListMediator.prototype.onEnterRoomResuleHandler=function(t){l.a.getInstance().log("enter room result:",t)},PicaRoomListMediator.prototype.onGetRoomListHandler=function(){this.roomList&&this.roomList.sendGetRoomList()},PicaRoomListMediator.prototype.onGetMyRoomListHandler=function(){this.roomList&&this.roomList.sendMyHistory()},PicaRoomListMediator.prototype.onEnterRoomHandler=function(t,i){this.roomList&&this.roomList.sendEnterRoom(t,i)},PicaRoomListMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"TaskMediator",(function(){return u}));var r,a=o(319),h=o(320),l=o(109),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function TaskMediator(i,o,r){var a=t.call(this)||this;return a.scene=o,a.layerMgr=i,a.world=r,a}return c(TaskMediator,t),TaskMediator.prototype.show=function(){this.mView&&this.mView.isShow()||this.mShow||(this.mView||(this.mView=new h.TaskPanel(this.scene,this.world),this.mView.on("hide",this.onHideView,this),this.mView.on("questlist",this.onQueryQuestList,this),this.mView.on("questdetail",this.onQueryQuestDetail,this),this.mView.on("submitquest",this.onQuerySubmitQuest,this)),this.task||(this.task=new a.Task(this.world),this.task.register(),this.task.on("questlist",this.onRetQuestList,this),this.task.on("questdetail",this.onRetQuestDetail,this)),this.layerMgr.addToUILayer(this.mView),this.mView.show())},TaskMediator.prototype.isSceneUI=function(){return!0},TaskMediator.prototype.destroy=function(){this.task&&(this.task.destroy(),this.task=void 0),this.mView&&(this.mView.hide(),this.mView=void 0)},TaskMediator.prototype.onHideView=function(){this.destroy()},TaskMediator.prototype.onQueryQuestList=function(){this.task.queryQuestList()},TaskMediator.prototype.onQueryQuestDetail=function(t){this.task.queryQuestDetail(t)},TaskMediator.prototype.onQuerySubmitQuest=function(t){this.task.querySubmitQuest(t)},TaskMediator.prototype.onRetQuestList=function(t){this.mView.setTaskDatas(t)},TaskMediator.prototype.onRetQuestDetail=function(t){this.mView.setTaskDetail(t)},TaskMediator}(l.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"UserMenuMediator",(function(){return p}));var r,a=o(110),h=o(2),l=o(119),c=o(109),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function UserMenuMediator(i,o,r){var a=t.call(this)||this;return a.world=r,a.mLayerManager=i,a.mScene=o,a.mUIType=c.UIType.Tips,a}return u(UserMenuMediator,t),UserMenuMediator.prototype.getView=function(){return this.mView},UserMenuMediator.prototype.hide=function(){this.mShow=!1,this.world.emitter.off(l.a.SCENE_BACKGROUND_CLICK,this.onClosePanel,this),this.mView&&(this.mView.off("menuClick",this.onClickMenuHandler,this),this.mView.hide(),this.mView=null)},UserMenuMediator.prototype.isSceneUI=function(){return!1},UserMenuMediator.prototype.isShow=function(){return!1},UserMenuMediator.prototype.resize=function(){this.mView&&this.mView.resize()},UserMenuMediator.prototype.show=function(t){},UserMenuMediator.prototype.update=function(t){this.mView&&this.mView.update(t[0])},UserMenuMediator.prototype.destroy=function(){this.mView&&(this.mView.destroy(),this.mView=null),this.mScene=null},UserMenuMediator.prototype.onClickMenuHandler=function(t){if(this.mView){var i=this.mView.getData("data");if(t&&i&&this.world&&this.world.connection)if(this.hide(),t.platformid)"关注"===t.text?this.world.httpService.follow(t.platformid):"取消关注"===t.text&&this.world.httpService.unfollow(t.platformid);else{var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI),r=o.content;r.uiId=i.id,r.componentId=t.id,this.world.connection.send(o)}}},UserMenuMediator.prototype.onClosePanel=function(t,i){this.hide()},UserMenuMediator}(c.BaseMediator)},function(t,i,o){"use strict";o.r(i),o.d(i,"UserMenuPanel",(function(){return p}));var r,a=o(112),h=o(111),l=o(323),c=o(117),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function UserMenuPanel(i,o){var r=t.call(this,i,o)||this;return r.mMenus=[],r.disInteractive(),r.scale=2,r}return u(UserMenuPanel,t),UserMenuPanel.prototype.show=function(i){t.prototype.show.call(this,i),this.scene&&(this.setData("data",i),this.addItem(i),this.x=this.scene.input.activePointer.x+32,this.y=this.scene.input.activePointer.y+32,this.scaleX=this.scaleY=this.scale)},UserMenuPanel.prototype.hide=function(){this.disInteractive(),this.clear(),t.prototype.hide.call(this)},UserMenuPanel.prototype.addListen=function(){this.mInitialized&&this.scene.input.on("gameobjectdown",this.onClickMenu,this)},UserMenuPanel.prototype.removeListen=function(){this.mInitialized&&this.scene.input.off("gameobjectdown",this.onClickMenu,this)},UserMenuPanel.prototype.setSize=function(i,o){return t.prototype.setSize.call(this,i,o),this.mBackground&&this.mBackground.resize(i,o),this},UserMenuPanel.prototype.destroy=function(){if(this.mBackground&&this.mBackground.destroy(),this.mMenus){for(var i=this.mMenus.length,o=0;o<i;o++){var r=this.mMenus[o];r||(r.destroy(!0),r=null)}this.mMenus=[]}t.prototype.destroy.call(this)},UserMenuPanel.prototype.addItem=function(t){if(this.mInitialized){this.clear();for(var i=t.menuItem,o=0;o<i.length;o++){var r=this.appendItem(i[o],0,32*o);this.add(r),this.mMenus.push(r)}this.setSize(70,30*this.mMenus.length);var a=this.mWorld.roomManager.currentRoom.playerManager.actor.model;if(a){var h=t.actors[0];if(h&&a.platformId!==h.platformId){var l={text:"关注",platformid:h.platformId},c=this.appendItem({text:"关注",node:void 0},0,31*this.mMenus.length);c.setData("node",l),this.add(c),this.mMenus.push(c),this.mWorld.httpService.checkFollowed([h.platformId]).then((function(t){200===t.code&&(t.data.length>0&&c.setText("取消关注"),l.text=c.getText(),c.setData("node",l))}))}}}},UserMenuPanel.prototype.preload=function(){this.scene.load.image(h.b.getName(),h.b.getPNG()),this.scene.load.image(h.d.getName(),h.d.getPNG()),this.scene.load.image("usermenu_arrow",h.i.getRes("ui/usermenu/arrow.png")),this.scene.load.atlas(h.h.getName(),h.h.getPNG(),h.h.getJSON()),t.prototype.preload.call(this)},UserMenuPanel.prototype.init=function(){this.mBackground=new c.NinePatch(this.scene,0,0,70,30,h.d.getName(),null,h.d.getConfig()),this.add(this.mBackground),t.prototype.init.call(this),this.mShowData&&this.addItem(this.showData)},UserMenuPanel.prototype.appendItem=function(t,i,o){var r=new l.MenuItem(this.scene,0,0,59,29,h.h.getName(),t.text,h.h.getConfig());if(r.x=i,r.y=o-(r.height>>1),r.setData("node",t.node),t.child&&t.child.length>0)for(var a=t.child,c=0,u=a.length;c<u;c++){var p=a[c],d=this.appendItem(p,73,31*c-15.5+31*this.mMenus.length);r.appendItem(d)}return r},UserMenuPanel.prototype.onClickMenu=function(t,i){i instanceof l.MenuItem&&(i.menus.length>0?i.show():this.emit("menuClick",i.getData("node")))},UserMenuPanel.prototype.resizeBackground=function(t,i){this.mBackground&&this.mBackground.resize(t,i)},UserMenuPanel.prototype.clear=function(){for(var t=0,i=this.mMenus;t<i.length;t++){var o=i[t];this.remove(o),o.off("pointerup",this.onClickMenu),o.destroy()}this.mMenus.length=0},UserMenuPanel}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"PopUpTextUI",(function(){return l}));var r,a=o(112),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function PopUpTextUI(i,o){var r=t.call(this,o,i)||this;return r.mWorld=i,r.scene=o,r.disInteractive(),r}return h(PopUpTextUI,t),PopUpTextUI.prototype.show=function(i){var o=this,r=this.mWorld.getSize(),a=this.scene.make.text({x:0,y:0,text:i,style:{fill:"#FF0000",fontSize:20}});this.add(a),this.setSize(a.width,a.height),this.setPosition(r.width-this.width>>1,r.height>>1),this.scene.tweens.add({targets:this,duration:1e3,ease:"Linear",props:{y:{value:(r.height>>1)-80},alhpa:{value:0}},onComplete:function(t,i,r){o.destroy()},onCompleteParams:[this]}),t.prototype.show.call(this,i)},PopUpTextUI.prototype.resize=function(){if(this.mInitialized){var t=this.mWorld.getSize();this.x=t.width-this.width>>1}},PopUpTextUI.prototype.destroy=function(){t.prototype.destroy.call(this)},PopUpTextUI}(a.BasePanel)},function(t,i){},function(t,i){},function(t,i){},function(t,i){},function(t,i){},function(t,i,o){"use strict";o.r(i),o.d(i,"TopMediator",(function(){return d}));var r,a=o(134),h=o(326),l=o(147),c=o(110),u=o(2),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function TopMediator(i,o){return t.call(this,i,o)||this}return p(TopMediator,t),TopMediator.prototype.preRefreshBtn=function(t){this.refreshMedList||(this.refreshMedList=[]),this.refreshMedList.push(t)},TopMediator.prototype.refreshBtn=function(t,i){var o=this,r=this.mView;switch(t){case l.RankMediator.NAME:i?r.addBtn({key:t,bgResKey:"baseView",bgTextures:["btnGroup_red_normal.png","btnGroup_red_light.png","btnGroup_red_select.png"],iconResKey:"baseView",iconTexture:"btnGroup_rank_icon.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json",callBack:function(){var i=o.world.uiManager.getMediator(t);if(i){var r=i.getParam();i.show(r)}}}):r.removeBtn(t);break;case"EnterDecorate":case"SaveDecorate":i?r.addBtn({key:t,bgResKey:"baseView",bgTextures:["btnGroup_red_normal.png","btnGroup_red_light.png","btnGroup_red_select.png"],iconResKey:"baseView",iconTexture:"btnGroup_rank_icon.png",scale:1,pngUrl:"ui/baseView/mainui_mobile.png",jsonUrl:"ui/baseView/mainui_mobile.json",callBack:function(){o.onEnterDecorate()}}):r.removeBtn(t)}},TopMediator.prototype.tweenView=function(t){this.mView&&this.mView.tweenView(t)},TopMediator.prototype.show=function(i){var o=this;this.mView&&this.isShow()||(this.mView=new h.TopBtnGroup(this.mScene,this.world),this.mView.show(i),t.prototype.show.call(this,i),this.refreshMedList&&this.refreshMedList.forEach((function(t){o.refreshBtn(t,!0)})))},TopMediator.prototype.hide=function(){var t=this;this.mShow=!1,this.refreshMedList&&this.refreshMedList.forEach((function(i){t.refreshBtn(i,!1)})),this.mView&&(this.mView.hide(),this.mView=null)},TopMediator.prototype.addBtn=function(t){this.mView&&this.mView.addBtn(t)},TopMediator.prototype.onEnterDecorate=function(){if(this.world&&this.world.connection){var t=new c.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);this.world.connection.send(t)}},TopMediator.prototype.onSaveDecorate=function(){if(this.world&&this.world.connection){var t=new c.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SAVE);this.world.connection.send(t)}},TopMediator.NAME="TopMediator",TopMediator}(a.BaseFaceMediator)},function(t,i){},function(t,i,o){"use strict";o.r(i),o.d(i,"LoadingView",(function(){return l}));var r,a=o(112),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function LoadingView(i,o){var r=t.call(this,i,o)||this;return r.key="loading_ui",r.disInteractive(),r}return h(LoadingView,t),LoadingView.prototype.show=function(t){},LoadingView.prototype.preload=function(){this.addAtlas(this.key,"pica_alert/pica_alert.png","pica_alert/pica_alert.json"),t.prototype.preload.call(this)},LoadingView.prototype.init=function(){t.prototype.init.call(this)},LoadingView}(a.BasePanel)},function(t,i,o){"use strict";o.r(i),o.d(i,"MessageBoxUI",(function(){return h})),o.d(i,"MessageBtn",(function(){return l}));var r,a=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),h=function(t){function MessageBoxUI(i,o){var r=t.call(this,i)||this;return r.mScene=i,r.mConfig=o,r.init(),r}return a(MessageBoxUI,t),MessageBoxUI.prototype.selectCall=function(t){this.mtxt.text=t.text,this.mtxt.x=this.mConfig.wid-this.mtxt.width>>1,this.mtxt.y=this.mConfig.hei-this.mtxt.height>>1,this.mConfig.clickCallBack&&this.mConfig.clickCallBack.call(this,t)},MessageBoxUI.prototype.init=function(){var t=this.mConfig.resKey,i=this.mConfig.resPng,o=this.mConfig.resJson;this.mScene.cache.obj.has(t)?this.onLoadCompleteHandler():(this.mScene.load.atlas(t,i,o),this.mScene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.mScene.load.start())},MessageBoxUI.prototype.onLoadCompleteHandler=function(){var t=this.mConfig.resKey,i=this.mConfig.resBtn;if(this.mBg=this.mScene.make.image(void 0,!1),this.mBg.setTexture(t,this.mConfig.resBg),this.mBg.x=this.mConfig.wid/2,this.mBg.y=this.mConfig.hei/2,this.mBg.setSize(this.mConfig.wid,this.mConfig.hei),this.mBtnList=[],this.mConfig.btnData)for(var o=this.mConfig.btnData.length,r=void 0,a=0;a<o;a++)r=new l(this.mScene,this,t,i,this.mConfig.btnWid,this.mConfig.btnHei),this.mBtnList.push(r);this.mtxt=this.mScene.make.text({x:0,y:0,style:{fill:"#F7EDED",fontSize:18}},!1),this.add(this.mBg),this.add(this.mtxt)},MessageBoxUI}(Phaser.GameObjects.Container),l=function(t){function MessageBtn(i,o,r,a,h,l){var c=t.call(this,i)||this;return c.messageBoxUI=o,c.mBtn=i.make.image(void 0,!1),c.mBtn.setTexture(r,a),c.mText=c.scene.make.text({x:-h>>1,y:-l>>1,style:{fill:"#F7EDED",fontSize:18}},!1),c.add(c.mBtn),c.add(c.mText),c.setSize(h,l),c.setInteractive(),c.on("pointerdown",c.selectHandler,c),c}return a(MessageBtn,t),Object.defineProperty(MessageBtn.prototype,"itemData",{get:function(){return this.mData},set:function(t){this.mData=t,this.mText.text=this.mData.text,this.mText.x=-this.width/2+(this.width-this.mText.width>>1),this.mText.y=-this.height/2+(this.height-this.mText.height>>1)},enumerable:!1,configurable:!0}),MessageBtn.prototype.destroy=function(){this.mText.destroy(!0),this.mBtn.destroy(!0),this.mData=null,t.prototype.destroy.call(this,!0)},MessageBtn.prototype.selectHandler=function(){this.addTween(this.mBtn),this.messageBoxUI.selectCall(this.itemData)},MessageBtn.prototype.addTween=function(t){this.scene.tweens.add({targets:t,duration:50,ease:"Linear",props:{scaleX:{value:.5},scaleY:{value:.5}},yoyo:!0,repeat:0}),t.scaleX=t.scaleY=1},MessageBtn}(Phaser.GameObjects.Container)},function(t,i,o){"use strict";o.r(i),o.d(i,"TabButton",(function(){return l}));var r,a=o(121),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function TabButton(i,o,r,a,h,l,c,u,p,d){var m=t.call(this,i,o,r,a,h,l,c,u,p,d)||this;return m.setInteractive(new Phaser.Geom.Rectangle(0,0,a,h),Phaser.Geom.Rectangle.Contains),m}return h(TabButton,t),TabButton.prototype.onPointerUp=function(){},TabButton}(a.NinePatchButton)},function(t,i,o){"use strict";o.r(i),o.d(i,"LoadingView",(function(){return r}));var r=function(){function LoadingView(t){this.mScene=t,this.mShowing=!1,this.createPanel()}return LoadingView.prototype.setFollow=function(t,i,o){},LoadingView.prototype.isShow=function(){return this.mShowing},LoadingView.prototype.show=function(t){this.mTween=this.mScene.tweens.add({targets:this.mBg,duration:2e6,ease:"Linear",props:{rotation:360}})},LoadingView.prototype.update=function(t){},LoadingView.prototype.hide=function(){this.mTween&&(this.mTween.stop(),this.mTween.remove())},LoadingView.prototype.tweenExpand=function(t){},LoadingView.prototype.resize=function(){},LoadingView.prototype.destroy=function(){this.mBg&&this.mBg.destroy()},LoadingView.prototype.createPanel=function(){var t=this.mScene.game.scale.gameSize;this.mBg=this.mScene.add.sprite(t.width>>1,t.height>>1,"stars"),this.mBg.scaleX=this.mBg.scaleY=1.3},LoadingView}()},function(t,i){},function(t,i,o){"use strict";o.d(i,"a",(function(){return j}));var r,a=o(392),h=o(328),l=o(327),c=o(138),u=o(2),p=o(118),d=o(110),m=o(131),y=o(169),g=o(0),_=o(137),v=o(178),b=o(152),P=o(126),w=o(122),S=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),C=u.op_def.NodeType,T=function(t){function DecorateElementManager(i){return t.call(this,i)||this}return S(DecorateElementManager,t),DecorateElementManager.prototype.addMap=function(t){var i=t.displayInfo;if(i&&(!this.mRoom.selectedSprite||this.mRoom.selectedSprite.id!==t.id)){var o=t.currentAnimation,r=o.name,a=o.flip,h=i.getCollisionArea(r,a),l=i.getWalkableArea(r,a),c=i.getOriginPoint(r,a),u=h.length,p=h[0].length,d=this.mRoom.transformToMini45(t.pos);if(!l){l=new Array(u);for(var m=0;m<u;m++)l[m]=new Array(p).fill(0)}var y=0,g=0;for(m=0;m<u;m++){y=d.y+m-c.y;for(var _=0;_<p;_++)1===h[m][_]&&(m>=l.length||_>=l[m].length||0===l[m][_])&&(g=d.x+_-c.x,y>=0&&y<this.mMap.length&&g>=0&&g<this.mMap[y].length&&(this.mMap[y][g]=1))}}},DecorateElementManager.prototype.removeMap=function(t){var i=t.displayInfo;if(i)for(var o=t.currentAnimation,r=o.name,a=o.flip,h=i.getCollisionArea(r,a),l=i.getOriginPoint(r,a),c=h.length,u=h[0].length,p=this.mRoom.transformToMini45(t.pos),d=0,m=0,y=0;y<c;y++){d=p.y+y-l.y;for(var g=0;g<u;g++)m=p.x+g-l.x,1===h[y][g]&&d>=0&&d<this.mMap.length&&m>=0&&m<this.mMap[d].length&&(this.mMap[d][m]=0)}},DecorateElementManager.prototype.canPut=function(t,i,o){for(var r=0,a=0,h=this.map,l=0;l<i.length;l++){if((r=l+t.y-o.y)<0||r>=h.length)return!1;for(var c=0;c<i[l].length;c++)if((a=c+t.x-o.x)>=h[l].length||1===h[r][a])return!1}return!0},DecorateElementManager.prototype._add=function(t,i){void 0===i&&(i=!0);var o=this.mElements.get(t.id);return o?o.model=t:(o=new w.b(t,this),"FROZEN"===this.getFrozenType(t)?o.setInputEnable(w.c.Diasble):o.setInputEnable(w.c.Enable)),i&&this.addMap(t),this.mElements.set(o.id||0,o),o},DecorateElementManager.prototype.onSync=function(t){var i=t.content;if(i.nodeType===C.ElementNodeType)for(var o=null,r=0,a=i.sprites;r<a.length;r++){var h=a[r];if(o=this.get(h.id)){var l=new P.a(h,i.nodeType);o.model=l,this.addMap(l)}}},Object.defineProperty(DecorateElementManager.prototype,"map",{get:function(){return this.mMap},enumerable:!1,configurable:!0}),DecorateElementManager.prototype.getFrozenType=function(t){var i,o=t.attrs;return o&&o.forEach((function(t){"frozenType"===t.key&&(i=t.value)})),i},DecorateElementManager}(b.a),k=o(119),O=o(177),I=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),M=function(t){function DecorateTerrainManager(i){var o=t.call(this,i)||this,r=i.miniSize;o.mMap=new Array(r.rows);for(var a=0;a<r.rows;a++)o.mMap[a]=new Array(r.cols).fill(0);return o}return I(DecorateTerrainManager,t),DecorateTerrainManager.prototype.remove=function(i){var o=t.prototype.remove.call(this,i);return o&&this.removeMap(o.model),o},DecorateTerrainManager.prototype.canPut=function(t,i,o){for(var r=0,a=0,h=this.map,l=0;l<i.length;l++){if((r=l+t.y-o.y)>=h.length)return!1;for(var c=0;c<i[l].length;c++)if((a=c+t.x-o.x)>=h[l].length||0===h[r][a])return!1}},DecorateTerrainManager.prototype._add=function(i){var o=t.prototype._add.call(this,i);return i.displayInfo&&this.addMap(i),o},DecorateTerrainManager.prototype.onSyncSprite=function(t){var i=t.content;if(i.nodeType===u.op_def.NodeType.TerrainNodeType)for(var o=null,r=0,a=i.sprites;r<a.length;r++){var h=a[r];if(o=this.get(h.id)){var l=new P.a(h,i.nodeType);o.model=l,l.displayInfo&&this.addMap(l)}}},DecorateTerrainManager.prototype.addMap=function(t){this.setMap(t,1)},DecorateTerrainManager.prototype.removeMap=function(t){this.setMap(t,0)},DecorateTerrainManager.prototype.setMap=function(t,i){var o=t.displayInfo;if(o){var r=t.currentAnimation,a=r.name,h=r.flip,l=o.getCollisionArea(a,h),c=o.getWalkableArea(a,h),u=o.getOriginPoint(a,h),p=l.length,d=l[0].length,m=!0;1===p&&1===d&&(p=2,d=2,m=!1);var y=t.pos;y.x*=2,y.y*=2;for(var g=0,_=0,v=0;v<p;v++){g=y.y+v-u.x;for(var b=0;b<d;b++)if(!m||1===l[v][b]&&1===c[v][b]){if(_=y.x+b-u.y,g>=this.mMap.length||_>=this.mMap[g].length)continue;this.mMap[g][_]=i}}}},DecorateTerrainManager}(O.a),E=o(142),x=o(143),B=function(){function SpawnPoint(){this.id=100,this.nodeType=u.op_def.NodeType.SpawnPointType,this.pos=new p.a,this.displayInfo=new E.a({id:0,animations:{defaultAnimationName:"idle",display:this.display,animationData:[new x.a(this.animation)]}}),this.currentAnimation={name:"idle",flip:!1},this.direction=3,this.nickname="出生点",this.alpha=1}return SpawnPoint.prototype.newID=function(){throw new Error("Method not implemented.")},SpawnPoint.prototype.setPosition=function(t,i){this.pos.x=t,this.pos.y=i},SpawnPoint.prototype.turn=function(){throw new Error("Method not implemented.")},SpawnPoint.prototype.toSprite=function(){throw new Error("Method not implemented.")},SpawnPoint.prototype.updateAvatar=function(t){throw new Error("Method not implemented.")},SpawnPoint.prototype.updateDisplay=function(t,i,o){throw new Error("Method not implemented.")},SpawnPoint.prototype.setAnimationName=function(){throw new Error("Method not implemented.")},SpawnPoint.prototype.setAnimationQueue=function(){throw new Error("Method not implemented.")},Object.defineProperty(SpawnPoint.prototype,"display",{get:function(){var t=u.op_gameconfig.Display.create();return t.texturePath="pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.png",t.dataPath="pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.json",t},enumerable:!1,configurable:!0}),Object.defineProperty(SpawnPoint.prototype,"animation",{get:function(){var t=u.op_gameconfig_01.AnimationData.create();return t.frameRate=5,t.collisionArea="1,1&1,1",t.loop=!0,t.baseLoc="-30,-30",t.originPoint=[0,0],t.frameName=["switch_0027_3_01.png"],t.node=u.op_gameconfig_01.Node.create(),t.node.id=0,t.node.name="idle",t.node.Parent=0,t},enumerable:!1,configurable:!0}),Object.defineProperty(SpawnPoint.prototype,"currentCollisionArea",{get:function(){return[[1,1],[1,1]]},enumerable:!1,configurable:!0}),Object.defineProperty(SpawnPoint.prototype,"currentWalkableArea",{get:function(){return[[0]]},enumerable:!1,configurable:!0}),Object.defineProperty(SpawnPoint.prototype,"currentCollisionPoint",{get:function(){return new Phaser.Geom.Point(0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(SpawnPoint.prototype,"hasInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),SpawnPoint}(),R=o(181),D=function(){function SelectorElement(t){var i=this;this.mElement=t,this.mScene=this.mElement.scene,this.mRoomService=this.mElement.roomService,this.mDecorateManager=new R.DecorateManager(this.mScene,this.mRoomService),this.mDecorateManager.setElement(t);var o=t.getDisplay();o.collisionArea?o.showRefernceArea():o.once("initialized",(function(){o.play(i.mElement.model.currentAnimation),o.showRefernceArea()})),this.mSelecting=!0,this.mDecorateManager.on("moveElement",this.onMoveElementHandler,this),this.mRoomService.world.emitter.emit(k.a.EDIT_PACKAGE_COLLAPSE),this.mRoomService.world.emitter.emit(k.a.SELECTED_DECORATE_ELEMENT)}return SelectorElement.prototype.turnElement=function(){this.mElement&&(this.mElement.turn(),this.checkCanPut())},SelectorElement.prototype.setDisplayPos=function(t){this.mElement&&(this.mElement.setPosition(t),this.checkCanPut())},SelectorElement.prototype.update=function(t,i){if(this.mElement){var o=this.mElement.getPosition();this.mDecorateManager.updatePos(o.x,o.y),this.checkCanPut()}},SelectorElement.prototype.clone=function(){if(this.mElement){var t=this.mElement.model,i=t.pos;this.mSourceData={x:i.x,y:i.y,z:i.z,direction:t.direction}}},SelectorElement.prototype.recover=function(){this.mElement&&this.mSourceData&&(this.mElement.setAlpha(1),this.mElement.setPosition(new p.a(this.mSourceData.x,this.mSourceData.y)),this.mElement.setDirection(this.mSourceData.direction))},SelectorElement.prototype.destroy=function(){if(this.mDecorateManager&&this.mDecorateManager.destroy(),this.mElement){var t=this.mElement.getDisplay();t&&t.hideRefernceArea()}this.mSourceData=void 0,this.mRoomService.world.emitter.emit(k.a.EDIT_PACKAGE_EXPANED),this.mRoomService.world.emitter.emit(k.a.CANCEL_DECORATE_ELEMENT)},SelectorElement.prototype.checkCanPut=function(){if(this.mRoomService&&this.mElement){var t=this.mElement.model,i=this.mRoomService.canPut(this.mElement.getPosition(),t.currentCollisionArea,t.currentCollisionPoint);i?this.element.setAlpha(1):this.element.setAlpha(.6),this.mDecorateManager&&this.mDecorateManager.canPut(i)}},SelectorElement.prototype.onMoveElementHandler=function(t){t&&this.setDisplayPos(t)},Object.defineProperty(SelectorElement.prototype,"selecting",{get:function(){return this.mSelecting},set:function(t){this.mSelecting=t},enumerable:!1,configurable:!0}),Object.defineProperty(SelectorElement.prototype,"element",{get:function(){return this.mElement},enumerable:!1,configurable:!0}),Object.defineProperty(SelectorElement.prototype,"root",{get:function(){return this.mSourceData},enumerable:!1,configurable:!0}),SelectorElement}(),L=o(180),A=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),j=function(t){function DecorateRoom(i){var o=t.call(this)||this;return o.clockSyncComplete=!0,o.world=i.world,o.mScaleRatio=o.world.scaleRatio,o.connection&&(o.connection.addPacketListener(o),o.addHandlerFun(u.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_SELECTED_SPRITE,o.onSelectSpriteHandler),o.addHandlerFun(u.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_SPAWN_POINT,o.onShowSpawnPointHandler),o.addHandlerFun(u.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ADD_SPRITE_BY_TYPE,o.onAddSpriteHandler),o.addHandlerFun(u.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ADD_SINGLE_SPRITE_BY_TYPE,o.onAddSingleSpriteHandler)),o}return A(DecorateRoom,t),DecorateRoom.prototype.enter=function(t){var i=this;this.mID=t.id;var o=t.rows,r=t.cols,a=t.tileWidth,l=t.tileHeight;this.mSize={cols:t.cols,rows:t.rows,tileHeight:t.tileHeight,tileWidth:t.tileWidth,sceneWidth:(t.rows+t.cols)*(t.tileWidth/2),sceneHeight:(t.rows+t.cols)*(t.tileHeight/2)},o*=2,r*=2,a/=2,l/=2,this.mMiniSize={cols:r,rows:o,tileHeight:l,tileWidth:a,sceneWidth:(o+r)*(a/2),sceneHeight:(o+r)*(l/2)},this.mMap=new Array(o);for(var c=0;c<o;c++)this.mMap[c]=new Array(r).fill(0);this.mCameraService=new h.a(this),this.world.showLoading().then((function(){i.completeLoad()}))},DecorateRoom.prototype.addBlockObject=function(t){this.mBlocks&&this.mBlocks.add(t)},DecorateRoom.prototype.addMouseListen=function(){},DecorateRoom.prototype.addToGround=function(t){this.mLayerManager.addToGround(t)},DecorateRoom.prototype.addToSceneUI=function(t){this.mLayerManager.addToSceneToUI(t)},DecorateRoom.prototype.addToSurface=function(t){this.mLayerManager.addToSurface(t)},DecorateRoom.prototype.addToUI=function(t){},DecorateRoom.prototype.completeLoad=function(){this.world.game.scene.add(y.a.name,y.a,!0,{room:this})},DecorateRoom.prototype.initUI=function(){this.world.uiManager&&this.world.uiManager.showDecorateUI()},DecorateRoom.prototype.destroy=function(){this.mTerrainManager&&this.mTerrainManager.destroy(),this.mElementManager&&this.mElementManager.destroy(),this.mLayerManager&&this.mLayerManager.destroy(),this.mBlocks&&this.mBlocks.destroy(),this.mSkyboxManager&&this.mSkyboxManager.destroy(),this.removePointerMoveHandler(),this.world.game.scene.remove(y.a.name),this.world.emitter.off(k.a.TURN_ELEMENT,this.onTurnElementHandler,this),this.world.emitter.off(k.a.RECYCLE_ELEMENT,this.onRecycleHandler,this),this.world.emitter.off(k.a.PUT_ELEMENT,this.onPutElement,this),this.world.emitter.off(k.a.CANCEL_PUT,this.onCancelPutHandler,this),this.mScene&&(this.mScene.input.off("pointerup",this.onPointerUpHandler,this),this.mScene.input.off("pointerdown",this.onPointerDownHandler,this),this.mScene.input.off("gameobjectdown",this.onGameobjectUpHandler,this))},DecorateRoom.prototype.now=function(){return 0},DecorateRoom.prototype.pause=function(){this.mScene&&this.mScene.scene.pause()},DecorateRoom.prototype.removeBlockObject=function(t){this.mBlocks&&this.mBlocks.remove(t)},DecorateRoom.prototype.requestActorMove=function(t,i){},DecorateRoom.prototype.resume=function(t){this.mScene&&this.mScene.scene.resume(t)},DecorateRoom.prototype.startLoad=function(){},DecorateRoom.prototype.startPlay=function(){this.mLayerManager&&this.mLayerManager.destroy(),this.mScene=this.world.game.scene.getScene(y.a.name),this.mLayerManager=new l.a(this),this.mTerrainManager=new M(this),this.mElementManager=new T(this),this.mBlocks=new a.a(this.mCameraService),this.mSkyboxManager=new L.a(this),this.mBlocks.int(this.mSize),this.mScene.input.on("pointerup",this.onPointerUpHandler,this),this.mScene.input.on("pointerdown",this.onPointerDownHandler,this),this.mScene.input.on("gameobjectdown",this.onGameobjectUpHandler,this);var t=this.scene.cameras.main;this.mCameraService.camera=t;var i=Math.ceil(window.devicePixelRatio);this.mCameraService.setBounds(-t.width>>1,-t.height>>1,this.mSize.sceneWidth*i+t.width,this.mSize.sceneHeight*i+t.height),this.cameraPos&&(this.mCameraService.scrollTargetPoint(this.cameraPos.x,this.cameraPos.y),this.mCameraService.syncCameraScroll()),this.world.changeRoom(this);var o=this.world.game.scene.getScene(m.a.name);o&&o.sleep(),this.connection.send(new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED)),this.world.emitter.on(k.a.TURN_ELEMENT,this.onTurnElementHandler,this),this.world.emitter.on(k.a.RECYCLE_ELEMENT,this.onRecycleHandler,this),this.world.emitter.on(k.a.PUT_ELEMENT,this.onPutElement,this),this.world.emitter.on(k.a.CANCEL_PUT,this.onCancelPutHandler,this),this.initSkyBox()},DecorateRoom.prototype.transformTo45=function(t){if(this.mSize)return c.a.transformTo45(t,this.mSize);g.a.getInstance().error("position object is undefined")},DecorateRoom.prototype.transformTo90=function(t){if(this.mSize)return c.a.transformTo90(t,this.mSize);g.a.getInstance().error("position object is undefined")},DecorateRoom.prototype.transformToMini90=function(t){if(this.mMiniSize)return c.a.transformTo90(t,this.mMiniSize);g.a.getInstance().error("position object is undefined")},DecorateRoom.prototype.transformToMini45=function(t){if(this.mMiniSize)return c.a.transformTo45(t,this.mMiniSize);g.a.getInstance().error("position object is undefined")},DecorateRoom.prototype.update=function(t,i){this.mLayerManager&&this.mLayerManager.update(t,i),this.mSelectorElement&&this.mSelectorElement.update(t,i),this.mBlocks&&this.mBlocks.update(t,i)},DecorateRoom.prototype.updateBlockObject=function(){},DecorateRoom.prototype.resize=function(t,i){this.layerManager.resize(t,i),this.mCameraService.resize(t,i)},DecorateRoom.prototype.transitionGrid=function(t,i){var o=new p.a(t,i),r=this.transformToMini45(o);return this.checkBound(r)},DecorateRoom.prototype.addElements=function(t,i){i===u.op_def.NodeType.ElementNodeType?this.mElementManager.add(t):i===u.op_def.NodeType.TerrainNodeType&&this.mTerrainManager.add(t)},DecorateRoom.prototype.setEnterPos=function(t,i){this.cameraPos=new p.a(t,i)},DecorateRoom.prototype.checkBound=function(t,i){var o=new p.a(t.x,t.y),r=this.mMiniSize;return t.x<0?o.x=0:t.x>r.cols&&(o.x=r.cols),t.y<0?o.y=0:t.y>r.rows&&(o.y=r.rows),o.equal(t)&&i?i:this.transformToMini90(o)},DecorateRoom.prototype.canPut=function(t,i,o){if(i&&o){var r=this.transformToMini45(t);if(r.x<0||r.y<0||r.y>this.miniSize.rows||r.x>this.miniSize.cols)return!1;for(var a=0,h=[this.mElementManager,this.mTerrainManager];a<h.length;a++){if(!1===h[a].canPut(r,i,o))return!1}return!0}},DecorateRoom.prototype.setMap=function(t,i,o){i<0||t<0||this.mMap.length<i||this.mMap[0].length<t||(this.mMap[t][i]=o)},DecorateRoom.prototype.getElement=function(t){var i=null;return this.mElementManager&&(i=this.elementManager.get(t)),!i&&this.mTerrainManager&&(i=this.mTerrainManager.get(t)),i},DecorateRoom.prototype.initSkyBox=function(){var t=this.world.elementStorage.getScenerys();if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.addSkyBox(r)}},DecorateRoom.prototype.addSkyBox=function(t){this.mSkyboxManager.add(t)},DecorateRoom.prototype.addPointerMoveHandler=function(){this.mScene&&(this.mScene.input.on("pointermove",this.onPointerMoveHandler,this),this.mScene.input.on("gameout",this.onGameOutHandler,this))},DecorateRoom.prototype.removePointerMoveHandler=function(){this.mScene&&(this.mScene.input.off("pointermove",this.onPointerMoveHandler,this),this.mScene.input.off("gameout",this.onGameOutHandler,this))},DecorateRoom.prototype.onPointerUpHandler=function(t){this.removePointerMoveHandler(),this.mSelectorElement&&(this.mSelectorElement.selecting=!1)},DecorateRoom.prototype.onPointerDownHandler=function(){this.addPointerMoveHandler()},DecorateRoom.prototype.onGameobjectUpHandler=function(t,i){var o=i.parentContainer.parentContainer||i.parentContainer;o&&o instanceof _.b&&(o instanceof v.a||this.selectedElement(o.element))},DecorateRoom.prototype.onPointerMoveHandler=function(t){!this.mSelectorElement||this.mSelectorElement&&!1===this.mSelectorElement.selecting?this.moveCamera(t):t.downX===t.x&&t.downY===t.y||this.moveElement(t)},DecorateRoom.prototype.onGameOutHandler=function(){this.removePointerMoveHandler()},DecorateRoom.prototype.moveCamera=function(t){this.cameraService.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},DecorateRoom.prototype.moveElement=function(t){var i=this.transitionGrid(t.worldX/this.mScaleRatio,t.worldY/this.mScaleRatio);this.mSelectorElement&&this.mSelectorElement.setDisplayPos(i)},DecorateRoom.prototype.removeElement=function(t,i){(i===u.op_def.NodeType.ElementNodeType||i===u.op_def.NodeType.SpawnPointType||i===u.op_def.NodeType.TerrainNodeType)&&this.elementManager.remove(t)},DecorateRoom.prototype.addElement=function(t,i){var o=t.nodeType;o===u.op_def.NodeType.ElementNodeType||o===u.op_def.NodeType.SpawnPointType?this.mElementManager.add([t],i):o===u.op_def.NodeType.TerrainNodeType&&this.mTerrainManager.add([t])},DecorateRoom.prototype.selectedElement=function(t,i){void 0===i&&(i=!0),t&&(this.mSelectorElement?this.mSelectorElement.element===t?this.mSelectorElement.selecting=!0:(this.onPutElement(null),this.selectedElement(t,i)):(this.mSelectorElement=new D(t),i&&(this.mSelectorElement.clone(),this.elementManager.removeMap(t.model)),this.mSelectorElement.update()))},DecorateRoom.prototype.cancelSelector=function(){if(this.mSelectorElement){var t=null;this.mSelectorElement.root&&(t=this.mSelectorElement.element.model),this.mSelectorElement.destroy(),this.mSelectorElement=void 0,t&&this.mElementManager.addMap(t)}},DecorateRoom.prototype.onTurnElementHandler=function(t){this.mSelectorElement&&this.mSelectorElement.turnElement()},DecorateRoom.prototype.onRecycleHandler=function(t){if(this.mSelectorElement){var i=this.mSelectorElement.element.model;if(i){var o=new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_SPRITE),r=o.content;r.sprites=[i.toSprite()],r.nodeType=i.nodeType,this.world.connection.send(o),this.mSelectorElement.destroy(),this.mSelectorElement=void 0}}},DecorateRoom.prototype.onPutElement=function(t){if(this.removePointerMoveHandler(),this.mSelectorElement){var i=this.mSelectorElement.element;if(i){var o=i.model;o&&(this.canPut(o.pos,o.currentCollisionArea,o.currentCollisionPoint)?(this.mSelectorElement.root?this.sendUpdateSprite(o):o.nodeType===u.op_def.NodeType.SpawnPointType?(this.sendSpawnPoint(o.pos),this.removeElement(o.id,o.nodeType)):this.sendAddSprite(o),this.cancelSelector()):this.onCancelPutHandler(i))}}},DecorateRoom.prototype.onCancelPutHandler=function(t){(this.removePointerMoveHandler(),this.mSelectorElement)&&(t||(t=this.mElementManager.get(this.mSelectorElement.element.id)),t&&(this.mSelectorElement.root?this.mSelectorElement.recover():this.removeElement(t.id,t.model.nodeType),this.cancelSelector()))},DecorateRoom.prototype.sendAddSprite=function(t){var i=new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SPRITE),o=i.content;o.sprites=[t.toSprite()],o.nodeType=t.nodeType,this.connection.send(i)},DecorateRoom.prototype.sendUpdateSprite=function(t){var i=new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_UPDATE_SPRITE),o=i.content;o.sprites=[t.toSprite()],o.nodeType=t.nodeType,this.connection.send(i)},DecorateRoom.prototype.sendSpawnPoint=function(t){var i=new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SET_SPAWN_POINT),o=i.content,r=u.op_def.PBPoint3f.create();r.x=t.x,r.y=t.y,o.spawnPoint=r,this.connection.send(i)},DecorateRoom.prototype.sendPosition=function(t){var i=new d.PBpacket(u.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_CHANGE_SPRITE_POSITION),o=i.content;o.sprites=[t.toSprite()],o.nodeType=t.nodeType,this.connection.send(i)},DecorateRoom.prototype.onSelectSpriteHandler=function(t){var i=t.content,o=this.cameraService.camera,r=new P.a(i.sprite,i.nodeType);r.setPosition((o.scrollX+o.width/2)/this.world.scaleRatio,(o.scrollY+o.height/2)/this.world.scaleRatio),this.addElement(r,!1);var a=this.mElementManager.get(i.sprite.id);a&&this.selectedElement(a,!1)},DecorateRoom.prototype.onShowSpawnPointHandler=function(t){var i=t.content,o=new B,r=i.spawnPoint;o.setPosition(r.x,r.y),this.addElement(o,!1),this.selectedElement(this.mElementManager.get(o.id),!1),this.mCameraService.scrollTargetPoint(r.x,r.y)},DecorateRoom.prototype.onAddSpriteHandler=function(t){t.content;this.cancelSelector()},DecorateRoom.prototype.onAddSingleSpriteHandler=function(t){var i=t.content,o=i.addedSprites;if(o){for(var r=[],a=0,h=o;a<h.length;a++){var l=h[a];r.push(new P.a(l,i.nodeType))}if(r.length>0){this.mElementManager.add(r);var c=this.mElementManager.get(r[r.length-1].id);c&&(this.cancelSelector(),this.selectedElement(c),this.mSelectorElement&&(this.mSelectorElement.selecting=!1))}}},Object.defineProperty(DecorateRoom.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"roomSize",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"terrainManager",{get:function(){return this.mTerrainManager},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"elementManager",{get:function(){return this.mElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"layerManager",{get:function(){return this.mLayerManager},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"cameraService",{get:function(){return this.mCameraService},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"scene",{get:function(){return this.mScene},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"connection",{get:function(){return this.world.connection},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"miniSize",{get:function(){return this.mMiniSize},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"selectedSprite",{get:function(){if(this.mSelectorElement)return this.mSelectorElement.element},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"enableEdit",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"sceneType",{get:function(){return u.op_def.SceneTypeEnum.EDIT_SCENE_TYPE},enumerable:!1,configurable:!0}),Object.defineProperty(DecorateRoom.prototype,"effectManager",{get:function(){},enumerable:!1,configurable:!0}),DecorateRoom}(d.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=function(){function Viewblock(t,i){this.mRect=t,this.mElements=new Map,this.mIndex=i}return Viewblock.prototype.add=function(t,i){if(this.mElements.set(t.id,t),i){var o=t.getPosition45();t.setRenderable(i.contains(o.x,o.y)&&this.mInCamera)}},Viewblock.prototype.remove=function(t){return this.mElements.delete(t.id)},Viewblock.prototype.check=function(t,i){if(t){var o=Phaser.Geom.Intersects.RectangleToRectangle(t,this.rectangle);i&&(this.mInCamera&&this.mElements.forEach((function(t){var o=t.getPosition45();t.setRenderable(i.contains(o.x,o.y),0)})),this.mInCamera=o)}},Viewblock.prototype.getElement=function(t){return this.mElements.get(t)},Object.defineProperty(Viewblock.prototype,"rectangle",{get:function(){return this.mRect||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Viewblock.prototype,"inCamera",{get:function(){return this.mInCamera},enumerable:!1,configurable:!0}),Viewblock}(),a=function(){function ViewblockManager(t){this.mBlocks=[],this.mDelay=0,this.mCameras=t}return ViewblockManager.prototype.add=function(t){if(!this.mCameras)return!1;for(var i=this.mCameras.getMiniViewPort(),o=0,r=this.mBlocks;o<r.length;o++){var a=r[o],h=a.rectangle,l=t.getPosition();if(!l)return;if(h.contains(l.x,l.y))return void a.add(t,i)}},ViewblockManager.prototype.remove=function(t){if(t)for(var i=0,o=this.mBlocks;i<o.length;i++){if(o[i].remove(t))return}},ViewblockManager.prototype.check=function(t){if(t)for(var i=0,o=this.mBlocks;i<o.length;i++){var r=o[i];if(r.inCamera){var a=r.rectangle,h=t.getPosition();if(a.contains(h.x,h.y))return void(r.getElement(t.id)||(this.remove(t),r.add(t)))}}},ViewblockManager.prototype.int=function(t){if(t){this.mBlocks=[];for(var i=t.tileWidth/2*20,o=t.tileHeight/2*20,a=t.sceneWidth/i,h=t.sceneHeight/o,l=0,c=0;c<a;c++)for(var u=0;u<h;u++){var p=new r(new Phaser.Geom.Rectangle(c*i,u*o,i,o),l++);this.mBlocks.push(p)}}},ViewblockManager.prototype.update=function(t,i){if(this.mCameras){this.mDelay=t;for(var o=this.mCameras.getViewPort(),r=this.mCameras.getMiniViewPort(),a=0,h=this.mBlocks;a<h.length;a++){h[a].check(o,r)}}},ViewblockManager.prototype.destroy=function(){this.mDelay=0},ViewblockManager}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return g}));var r,a=o(116),h=o(0),l=o(111),c=o(128),u=o(341),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),d=function(t){function SkyBoxScene(){return t.call(this,{})||this}return p(SkyBoxScene,t),SkyBoxScene.prototype.init=function(t){t&&(this.skyBoxManager=t)},SkyBoxScene.prototype.create=function(){var t=this.cameras.main;this.cameras.addExisting(new u.a(0,0,this.sys.scale.width,this.sys.scale.height,this.skyBoxManager.world.scaleRatio),!0),this.cameras.remove(t),this.skyBoxManager.startPlay(this)},SkyBoxScene.prototype.update=function(t,i){this.skyBoxManager.check(t,i)},SkyBoxScene}(c.a),m=o(342),y=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),g=function(){function BlockManager(t,i){this.mRows=1,this.mCols=1,this.mSceneName="",this.mGrids=[],this.mScenery=t,this.mUris=t.uris,this.mRoom=i,this.mWorld=i.world,this.mCameras=i.cameraService,this.mMainCamera=this.mCameras.camera,this._bound=this.mMainCamera.getBounds(),this.mScaleRatio=this.mWorld.scaleRatio,this.setSize(t.width,t.height);var o=i.scene;if(o){this.mSceneName=d.name+"_"+t.id;this.mWorld.game.scene.add(this.mSceneName,d,!1);o.scene.launch(this.mSceneName,this),this.updateDepth()}else h.a.getInstance().fatal(BlockManager.name+" scene does not exist")}return BlockManager.prototype.startPlay=function(t){var i=this;this.scene=t,this.initBlock(),this.mStateMap&&this.mStateMap.forEach((function(t){return i.handlerState(t)}))},BlockManager.prototype.check=function(t,i){for(var o=this.mMainCamera.worldView,r=new Phaser.Geom.Rectangle(o.x-o.width/2,o.y-o.height/2,2*o.width,2*o.height),a=0,h=this.mGrids;a<h.length;a++){var l=h[a];l.checkCamera(Phaser.Geom.Intersects.RectangleToRectangle(r,l.rectangle))}},BlockManager.prototype.update=function(t){this.mScenery=t,this.mUris=t.uris,this.setSize(t.width,t.height),this.initBlock(),this.updateDepth()},BlockManager.prototype.setSize=function(t,i,o,r){if(0!==this.mUris.length){var a=1,h=1;(this.mUris.length>1||this.mUris[0].length>1)&&(a=t/1024,h=i/1024),this.mCols=Math.round(a),this.mRows=Math.round(h),this.mGridWidth=t/this.mCols,this.mGridHeight=i/this.mRows}},BlockManager.prototype.resize=function(t,i){if(this.scene&&this.mMainCamera){var o=this.scene.cameras.main;if(o){this.mScaleRatio=this.mWorld.scaleRatio,this.updatePosition(),this._bound=this.mMainCamera.getBounds(),o.setBounds(this._bound.x,this._bound.y,this._bound.width,this._bound.height);for(var r=0,a=this.mGrids;r<a.length;r++){var h=a[r];h.setScaleRatio(this.mScaleRatio),h.resize(t,i)}}}},BlockManager.prototype.updatePosition=function(){var t=this.scene.cameras.main,i=this.mScenery.offset,o=this.fixPosition({x:i.x,y:i.y});t.setPosition(o.x,o.y);for(var r=0,a=this.mGrids;r<a.length;r++){a[r].updatePosition()}},BlockManager.prototype.destroy=function(){this.mWorld&&this.mWorld.game&&this.mWorld.game.scene.remove(this.mSceneName),this.mGrids.length=0},BlockManager.prototype.setState=function(t){this.handlerState(t)},BlockManager.prototype.playSkyBoxAnimation=function(t){var i=t.id,o=t.targets,r=t.duration,a=t.reset,h=t.resetDuration;if(void 0!==i&&void 0!==o&&void 0!==r&&this.scene&&i===this.mScenery.id){var l=this.scene.cameras.main;this.move(l,this.fixPosition(o),r,this.fixPosition(a),h)}},BlockManager.prototype.handlerState=function(t){for(var i=0,o=t.packet;i<o.length;i++){var r=o[i];this.mScenery.id===r.id&&this.playSkyBoxAnimation(r)}},BlockManager.prototype.updateDepth=function(){if(this.mRoom){var t=this.mRoom.scene;if(this.mScenery&&t){var i=this.mWorld.game.scene.getScene(this.mSceneName);i&&(this.mScenery.depth<0?i.scene.sendToBack(this.mSceneName):i.scene.moveAbove(t.sys.settings.key,this.mSceneName))}}},BlockManager.prototype.initBlock=function(){this.clear(),this.mContainer=this.scene.add.container(0,0),this.mContainer.setScale(this.mWorld.scaleRatio);var t=this.mUris.length;if(this.mScenery.fit===m.a.Repeat)for(var i=this.mRoom.getMaxScene(),o=i.width,r=i.height,a=Math.floor(o/this.mScenery.width),h=Math.floor(r/this.mScenery.height),l=0;l<a;l++)for(var c=0;c<h;c++){(p=new _(this.scene,this.mUris[0][0],this.mScaleRatio)).setRectangle(c*this.mGridWidth,l*this.mGridHeight,this.mGridWidth,this.mGridHeight),this.mGrids.push(p)}else for(l=0;l<t;l++){var u=this.mUris[l].length;for(c=0;c<u;c++){var p;(p=new _(this.scene,this.mUris[l][c],this.mScaleRatio)).setRectangle(c*this.mGridWidth,l*this.mGridHeight,this.mGridWidth,this.mGridHeight),this.mGrids.push(p)}}this.mContainer.add(this.mGrids),this.initCamera()},BlockManager.prototype.move=function(t,i,o,r,a){var h=this;this.tween&&(this.tween.stop(),this.tween.removeAllListeners()),this.tween=this.scene.tweens.add({targets:t,props:i,duration:o,loop:-1,onUpdate:function(){for(var t=0,i=h.mGrids;t<i.length;t++){i[t].updatePosition()}}}),r&&this.tween.once("loop",(function(){r&&(t.x=r.x,t.y=r.y),h.tween.stop(),h.move(t,i,a)}))},BlockManager.prototype.initCamera=function(){var t=this.scene.cameras.main;this.mCameras&&(t.setBounds(this._bound.x,this._bound.y,this._bound.width,this._bound.height),this.updatePosition(),t.setScroll(this.mMainCamera.scrollX,this.mMainCamera.scrollY),this.mCameras.addCamera(t))},BlockManager.prototype.clear=function(){for(var t=0,i=this.mGrids;t<i.length;t++){i[t].destroy()}this.mGrids.length=0,this.mContainer&&this.mContainer.destroy(!0)},Object.defineProperty(BlockManager.prototype,"world",{get:function(){return this.mWorld},enumerable:!1,configurable:!0}),Object.defineProperty(BlockManager.prototype,"scenery",{get:function(){return this.mScenery},enumerable:!1,configurable:!0}),BlockManager.prototype.fixPosition=function(t){if(t){var i=this.offset;return void 0!==t.x&&(t.x=(i.x+t.x)*this.mWorld.scaleRatio),void 0!==t.y&&(t.y=(i.y+t.y)*this.mWorld.scaleRatio),t}},Object.defineProperty(BlockManager.prototype,"offset",{get:function(){var t=0,i=0;if(this.mScenery&&this.mScenery.fit===m.a.Center){var o=this.mRoom.roomSize,r=this.mScenery,a=r.width,h=r.height;t=o.sceneWidth-a>>1,i=o.sceneHeight-h>>1}return{x:t,y:i}},enumerable:!1,configurable:!0}),BlockManager}(),_=function(t){function Block(i,o,r){var a=t.call(this,i,0,0)||this;return a.mLoaded=!1,a.mInCamera=!1,a.mKey=o,a.mScale=r,a.setOrigin(0),a}return y(Block,t),Block.prototype.checkCamera=function(t){this.mInCamera!==t&&(this.mInCamera=t,this.visible=t,this.mLoaded||this.load(l.i.getOsdRes(this.mKey)))},Block.prototype.setRectangle=function(t,i,o,r){this.x=t,this.y=i,this.setSize(o,r);var a=this.scene.cameras.main;this.mRectangle=new Phaser.Geom.Rectangle(t*this.mScale+a.x,i*this.mScale+a.y,o*this.mScale,r*this.mScale)},Block.prototype.updatePosition=function(){if(this.mRectangle){var t=this.scene.cameras.main;this.mRectangle.x=this.x*this.mScale+t.x,this.mRectangle.y=this.y*this.mScale+t.y}},Block.prototype.resize=function(t,i){var o=this.scene.cameras.main;this.mRectangle=new Phaser.Geom.Rectangle(this.x*this.mScale+o.x,this.y*this.mScale+o.y,this.width*this.mScale,this.height*this.mScale)},Block.prototype.setScaleRatio=function(t){this.mScale=t},Object.defineProperty(Block.prototype,"rectangle",{get:function(){return this.mRectangle},enumerable:!1,configurable:!0}),Object.defineProperty(Block.prototype,"key",{get:function(){return this.mKey},enumerable:!1,configurable:!0}),Block.prototype.onLoadComplete=function(i){t.prototype.onLoadComplete.call(this,i),this.texture&&(this.mLoaded=!0,this.texture.setFilter(Phaser.Textures.FilterMode.NEAREST))},Block}(a.DynamicImage)},function(t,i,o){"use strict";var r;o.d(i,"a",(function(){return r})),function(t){t[t.NONE=0]="NONE",t[t.GAME_INIT=1]="GAME_INIT",t[t.SOCKET_CONNECT=2]="SOCKET_CONNECT",t[t.LOGIN=3]="LOGIN",t[t.PLAYER_INIT=4]="PLAYER_INIT",t[t.WORLD_INIT=5]="WORLD_INIT",t[t.LOAD_PI=6]="LOAD_PI",t[t.PI_COMPLETE=7]="PI_COMPLETE",t[t.DECODE_PI=8]="DECODE_PI",t[t.GAME_CREATE=9]="GAME_CREATE",t[t.CHARACTER_CREATED=10]="CHARACTER_CREATED",t[t.ENTER_SCENE=11]="ENTER_SCENE",t[t.SCENE_CREATE=12]="SCENE_CREATE",t[t.PAUSE=13]="PAUSE",t[t.PLAYING=14]="PLAYING",t[t.SOCKET_DISCONNECT=15]="SOCKET_DISCONNECT",t[t.SOCKET_ERROR=16]="SOCKET_ERROR"}(r||(r={}))},,,,,,,,,,,,,,,function(t,i,o){"use strict";o.d(i,"a",(function(){return c}));var r,a=o(110),h=o(2),l=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),c=function(t){function KeyBoardManager(i,o){var r=t.call(this)||this;return r.worldService=i,r.mInitilized=!0,r.mKeyboardListeners=[],r.mKeyList=[],r.mKeyDownList=[],r.mKeyEvents=o,r.mTmpUpKeysStr="",r.mTmpDownKeyStr="",r.mKeyEventMap=new Map,r.mConnect=r.worldService.connection,r}return l(KeyBoardManager,t),KeyBoardManager.prototype.onRoomChanged=function(t,i){var o=this;if(this.mRoom=t,this.mScene=t.scene,this.mScene){if(this.mKeyEvents){for(var r=this.mKeyEvents.length,a=void 0,h=void 0,l=0;l<r;l++)(a=this.mKeyEvents[l]).keyCodes,h=a.tqEvent,this.mKeyEventMap.get(h)||this.mKeyEventMap.set(h,a);this.mKeyEvents.length=0,this.mKeyEvents=null}this.mKeyEventMap.forEach((function(t){if(t)for(var i=t.keyCodes,r=i.length,a=void 0,h=0;h<r;h++){a=i[h];var l=o.mScene.input.keyboard.addKey(a,!1);o.addKeyEvent(l,t.tqEvent)}}))}},KeyBoardManager.prototype.getKeyCodes=function(t){if(this.mKeyEventMap.has(t))return this.mKeyEventMap.get(t).keyCodes},KeyBoardManager.prototype.resize=function(t,i){},KeyBoardManager.prototype.addListener=function(t){this.mKeyboardListeners.push(t)},KeyBoardManager.prototype.removeListener=function(t){var i=this.mKeyboardListeners.indexOf(t);i>=0&&this.mKeyboardListeners.splice(i,1)},Object.defineProperty(KeyBoardManager.prototype,"enable",{get:function(){return void 0!==this.mScene&&this.mScene.input.keyboard.enabled},set:function(t){this.mScene&&(this.mScene.input.keyboard.enabled=t)},enumerable:!1,configurable:!0}),Object.defineProperty(KeyBoardManager.prototype,"keyList",{get:function(){return this.mKeyList},enumerable:!1,configurable:!0}),KeyBoardManager.prototype.getKeyDowns=function(){return this.mInitilized&&this.mKeyList?(this.mKeyDownList=this.mKeyList.filter((function(t){return t.isDown})),this.mKeyDownList.map((function(t){return t.keyCode}))):[]},KeyBoardManager.prototype.getKeyUps=function(){var t,i=[];if(!this.mInitilized)return i;if(!this.mKeyDownList)return[];for(var o=0;o<this.mKeyDownList.length;o++)(t=this.mKeyDownList[o])&&t.isUp&&(this.mKeyDownList.splice(o,1),i.push(t.keyCode),o--);return i},KeyBoardManager.prototype.destroy=function(){this.removeKeyEvents(),this.mKeyDownList&&(this.mKeyDownList.length=0,this.mKeyDownList=null),this.mTmpDownKeyStr=null,this.mTmpUpKeysStr=null,this.mScene=null,this.mConnect=null,this.mInitilized=!1},KeyBoardManager.prototype.concatArr=function(t,i){var o,r=t.length>i.length?i.length:t.length,a=t.length>i.length?t:i,h=t.length>i.length?i:t;for(o=0;o<r;o++)a.push(h[o]);return a},KeyBoardManager.prototype.checkMoveKeyDown=function(t){for(var i,o,r=this.mKeyList,a=r.length,l=[],c=0,u=this.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_LEFT),p=this.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_DOWN),d=this.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_RIGHT),m=this.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_UP),y=0;y<a;y++)if(o=(i=r[y]).keyCode,i&&i.isDown){if(l.push(i.keyCode),u)if(u.indexOf(o)>-1){c+=-1;continue}if(d)if(d.indexOf(o)>-1){c+=1;continue}if(p)if(p.indexOf(o)>-1){c+=3;continue}if(m)if(m.indexOf(o)>-1){c+=-3;continue}}if(0===c)return!1;var g,_=t.getDirection();switch(c){case-1:g=_<=1?1:3;break;case-2:g=7;break;case-3:g=_<=3?1:7;break;case-4:g=1;break;case 1:g=_<=5?5:7;break;case 2:g=3;break;case 3:g=_<=3?3:5;break;case 4:g=5}return this.enable&&(t.setDirection(g),t.downHandler(g,l),this.mRoom&&this.mRoom.playerManager.actor&&this.mRoom.playerManager.actor.setDirection(g)),!0},KeyBoardManager.prototype.checkMoveKeyAllUp=function(){for(var t,i=this.mKeyList,o=i.length,r=0;r<o;r++)if((t=i[r])&&t.isDown)return!1;return!0},KeyBoardManager.prototype.addKeyEvent=function(t,i){t.on("down",this.keyDownHandle,this),t.on("up",this.keyUpHandle,this),this.mKeyList.push(t)},KeyBoardManager.prototype.keyDownHandle=function(t){var i=this;if(this.enable){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN),r=o.content,l=this.getKeyDowns();this.mTmpDownKeyStr!==l.toString()&&(this.mTmpUpKeysStr="",this.mTmpDownKeyStr=l.toString(),r.keyCodes=l,this.mConnect.send(o),this.mKeyboardListeners.forEach((function(t){i.checkMoveKeyDown(t)})))}},KeyBoardManager.prototype.keyUpHandle=function(t){var i=this;if(this.enable){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_UP),r=o.content,l=this.getKeyUps();this.mTmpUpKeysStr===l.toString()||l.length<1||(this.mTmpDownKeyStr="",this.mTmpUpKeysStr=l.toString(),r.keyCodes=l,this.mConnect.send(o),this.mKeyboardListeners.forEach((function(t){i.checkMoveKeyAllUp()?t.upHandler():i.checkMoveKeyDown(t)})))}},KeyBoardManager.prototype.removeKeyEvents=function(){if(this.mScene){for(var t,i=this.mKeyList.length,o=0;o<i;o++)(t=this.mKeyList[o])&&(t.off("down",this.keyDownHandle),t.off("up",this.keyUpHandle),this.mScene.input.keyboard.removeKey(t.keyCode));this.mKeyList.length=0}},KeyBoardManager}(a.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return m}));var r,a,h=o(110),l=o(2),c=o(119),u=o(141),p=o(122),d=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)});!function(t){t[t.RightMouseDown=1]="RightMouseDown",t[t.RightMouseUp=2]="RightMouseUp",t[t.LeftMouseDown=3]="LeftMouseDown",t[t.LeftMouseUp=4]="LeftMouseUp",t[t.WheelDown=5]="WheelDown",t[t.WheelUp=6]="WheelUp",t[t.RightMouseHolding=7]="RightMouseHolding",t[t.LeftMouseHolding=8]="LeftMouseHolding",t[t.Tap=9]="Tap"}(a||(a={}));var m=function(t){function MouseManager(i){var o=t.call(this)||this;return o.worldService=i,o.running=!1,o.mDownDelay=1e3,o.delay=500,o.mConnect=o.worldService.connection,o.zoom=o.worldService.scaleRatio||1,o}return d(MouseManager,t),MouseManager.prototype.changeRoom=function(t){this.pause(),this.mGameObject=null,this.mScene=t.scene,this.mScene&&(t.scene.input.on("gameobjectdown",this.groundDown,this),t.scene.input.on("pointerdown",this.pointerDownHandler,this),this.resume())},MouseManager.prototype.resize=function(t,i){this.zoom=this.worldService.scaleRatio||1},MouseManager.prototype.pause=function(){this.running=!1},MouseManager.prototype.resume=function(){this.running=!0},MouseManager.prototype.onUpdate=function(t,i){if(!1!==this.running&&void 0!==t){var o=[];t.leftButtonDown()?o.push(a.LeftMouseDown):t.leftButtonReleased()&&o.push(a.LeftMouseUp),t.middleButtonDown()?o.push(a.WheelDown):t.middleButtonReleased()&&o.push(a.WheelUp),t.rightButtonDown()?o.push(a.RightMouseDown):t.rightButtonReleased()&&o.push(a.RightMouseUp);var r=0,h=null;if(i&&i.parentContainer&&(r=i.parentContainer.getData("id"),h=i.parentContainer.parentContainer||i.parentContainer),!1===t.isDown){var l=Math.abs(t.downX-t.upX),c=Math.abs(t.downY-t.upY);if(l<10&&c<10)if(this.worldService.emitter.emit("Tap",t,i),!1===t.isDown)if(h instanceof u.a)h.element instanceof p.b&&h.scaleTween()}0!==o.length&&this.sendMouseEvent(o,r,{x:t.worldX/this.zoom,y:t.worldY/this.zoom})}},Object.defineProperty(MouseManager.prototype,"enable",{get:function(){return!!this.mScene&&this.mScene.input.mouse.enabled},set:function(t){this.mScene&&(this.mScene.input.mouse.enabled=t)},enumerable:!1,configurable:!0}),MouseManager.prototype.destroy=function(){this.mScene=null,this.mConnect=null,this.running=!1,this.debounce=null},MouseManager.prototype.groundDown=function(t,i){this.mGameObject=i,this.mDownTime=setTimeout(this.holdHandler.bind(this),this.mDownDelay,t,i)},MouseManager.prototype.groundUp=function(t,i){this.onUpdate(t,i)},MouseManager.prototype.pointerDownHandler=function(t,i){var o=this;this.debounce?this.mGameObject=null:(this.debounce=setTimeout((function(){o.debounce=null}),this.delay),this.mScene.input.off("pointerup",this.onPointerUpHandler,this),this.mScene.input.once("pointerup",this.onPointerUpHandler,this),this.worldService&&this.worldService.emitter&&this.worldService.emitter.emit(c.a.SCENE_BACKGROUND_CLICK,t),this.onUpdate(t,this.mGameObject))},MouseManager.prototype.onPointerUpHandler=function(t){clearTimeout(this.mDownTime),this.onUpdate(t,this.mGameObject),this.mGameObject=null},MouseManager.prototype.holdHandler=function(t,i){var o=0;i&&i.parentContainer&&(o=i.parentContainer.getData("id"),i.parentContainer.parentContainer||i.parentContainer,this.sendMouseEvent([a.LeftMouseHolding],o,{x:t.worldX/this.zoom,y:t.worldY/this.zoom}))},MouseManager.prototype.sendMouseEvent=function(t,i,o){var r=new h.PBpacket(l.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOUSE_EVENT),a=r.content;a.id=i,a.mouseEvent=t,a.point3f=o,this.mConnect.send(r)},MouseManager}(h.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return c}));var r=o(0),a=o(122),h=o(2),l=o(391),c=function(){function JoyStickManager(t,i){this.worldService=t,this.mEnabled=!1,this.mOnListener=!1,this.mJoyListeners=[],this.mScale=t.uiScale,this.mKeyEvents=i,this.mKeyEventMap=new Map,r.a.getInstance().debug("JoyStickManager "+t.uiScale)}return JoyStickManager.prototype.onRoomChanged=function(t,i){this.mJoyStick?t instanceof l.a?this.mJoyStick.offListener():this.mJoyStick.onListener():this.mOnListener=!(t instanceof l.a)},JoyStickManager.prototype.setScene=function(t){if(this.mScene=t,this.mScene&&this.mKeyEvents){for(var i,o,r=this.mKeyEvents.length,a=0;a<r;a++)(i=this.mKeyEvents[a]).keyCodes,o=i.tqEvent,this.mKeyEventMap.get(o)||this.mKeyEventMap.set(o,i);this.mKeyEvents.length=0,this.mKeyEvents=null,this.mParentcon=this.mScene.add.container(0,0);var h=this.mScale?this.mScale:1;this.mJoyStick=new u(this.mScene,this.worldService,this.mParentcon,this.mJoyListeners,h),this.mOnListener?this.mJoyStick.onListener():this.mJoyStick.offListener()}},JoyStickManager.prototype.resize=function(){this.mParentcon&&(this.mParentcon.scaleX=this.mParentcon.scaleY=this.worldService.uiScale)},JoyStickManager.prototype.tweenView=function(t){this.mParentcon.visible=t},JoyStickManager.prototype.addListener=function(t){this.mJoyListeners.push(t),this.mJoyStick&&this.mJoyStick.changeListeners(this.mJoyListeners)},JoyStickManager.prototype.getKeyCodes=function(t){if(this.mKeyEventMap.has(t)){for(var i=this.mKeyEventMap.get(t).keyCodes.length,o=[],r=0;r<i;r++){var a=this.mKeyEventMap.get(t).keyCodes[r];o.push(a)}return o}},JoyStickManager.prototype.removeListener=function(t){var i=this.mJoyListeners.indexOf(t);i>=0&&this.mJoyListeners.splice(i,1),this.mJoyStick&&this.mJoyStick.changeListeners(this.mJoyListeners)},JoyStickManager.prototype.getKeyDowns=function(){return[]},JoyStickManager.prototype.getKeyUps=function(){return[]},JoyStickManager.prototype.downHandler=function(){},JoyStickManager.prototype.upHandler=function(){},Object.defineProperty(JoyStickManager.prototype,"enable",{get:function(){return this.mEnabled},set:function(t){this.mEnabled=t},enumerable:!1,configurable:!0}),JoyStickManager}(),u=function(){function JoyStick(t,i,o,r,a){this.mDown=!1,this.mScene=t,this.mWorld=i,this.parentCon=o,this.mJoyListeners=r,this.mScale=a,this.mKeyCodes=[],this.load()}return JoyStick.prototype.load=function(){this.mScene.load.atlas("joystick","./resources/ui/joystick/joystick.png","./resources/ui/joystick/joystick.json"),this.mScene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.mScene.load.start()},JoyStick.prototype.onListener=function(){this.mScene.input.on("pointerdown",this.downHandler,this),this.mScene.input.on("pointerup",this.upHandler,this)},JoyStick.prototype.offListener=function(){this.parentCon.visible=!1,this.mScene.input.off("pointermove",this.pointerMove,this),this.mScene.input.off("pointerdown",this.downHandler,this),this.mScene.input.off("pointerup",this.upHandler,this)},JoyStick.prototype.changeListeners=function(t){this.mJoyListeners=t},JoyStick.prototype.onLoadCompleteHandler=function(){this.mWorld.getSize();this.bg=this.mScene.make.sprite(void 0,!1),this.bg.setTexture("joystick","joystick_bg.png"),this.bgRadius=this.bg.width+100>>1,this.btn=this.mScene.make.sprite(void 0,!1),this.btn.name="joystick_btn",this.btn.setTexture("joystick","joystick_tab.png"),this.btn.x=this.bg.x,this.btn.y=this.bg.y,this.parentCon.alpha=.5,this.parentCon.addAt(this.bg,0),this.parentCon.addAt(this.btn,1),this.btn.setInteractive(new Phaser.Geom.Rectangle(0,0,this.btn.width,this.btn.height),Phaser.Geom.Rectangle.Contains),this.parentCon.setSize(this.bg.width,this.bg.height),this.parentCon.visible=!1},JoyStick.prototype.downHandler=function(t,i){if(this.mWorld.inputManager.enable&&!this.mDown){if(i){if(i.length>1)return;if(1===i.length){if(!i[0].name)return;if("joystick_btn"!==i[0].name)return}}this.mDown=!0,this.mScene.input.on("pointermove",this.pointerMove,this),this.parentCon.x=t.worldX,this.parentCon.y=t.worldY,this.parentCon.visible=!0}},JoyStick.prototype.pointerMove=function(t){var i=this;if(this.mWorld.inputManager.enable){var o=t.worldX-this.parentCon.x,r=t.worldY-this.parentCon.y,a=Math.sqrt(o*o+r*r);a>this.bgRadius&&(a=this.bgRadius);var h=Math.atan2(r,o);if(this.btn.x=Math.cos(h)*a,this.btn.y=Math.sin(h)*a,this.mWorld.inputManager.enable){var l=Math.acos(o/a);t.worldY>this.parentCon.y&&(l=-l),this.mJoyListeners.forEach((function(t){i.checkdragDown(t,l)}))}}},JoyStick.prototype.upHandler=function(t){var i=this;this.btn.x=this.bg.x,this.btn.y=this.bg.y,this.mDown=!1,this.parentCon.visible=!1,this.mScene.input.off("pointermove",this.pointerMove,this),this.mWorld.inputManager.enable&&this.mJoyListeners.forEach((function(t){i.checkdragUp()&&t.upHandler()}))},JoyStick.prototype.checkdragDown=function(t,i){var o,h=[],l=.125*Math.PI;if(i>-l&&i<=l?(o=a.a.east,r.a.getInstance().log("dir:Direction.east")):i>l&&i<=3*l?(o=a.a.east_north,r.a.getInstance().log("dir:Direction.east_north")):i>3*l&&i<=5*l?(o=a.a.north,r.a.getInstance().log("dir:Direction.north")):i>5*l&&i<=7*l?(o=a.a.north_west,r.a.getInstance().log("dir:Direction.nroth_west")):i>=7*l&&i<=Math.PI||i>=-Math.PI&&i<-7*l?(o=a.a.west,r.a.getInstance().log("dir:Direction.west")):i<-5*l&&i>=-7*l?(o=a.a.west_south,r.a.getInstance().log("dir:Direction.west_south")):i>-5*l&&i<=-3*l?(o=a.a.south,r.a.getInstance().log("dir:Direction.south")):i>-3*l&&i<=-l&&(o=a.a.south_east,r.a.getInstance().log("dir:Direction.south_east")),void 0!==o)return h=this.getKeys(o),this.mdownStr!==h.toString()&&(this.mdownStr=h.toString(),t.downHandler(o,h),this.mWorld.roomManager.currentRoom.playerManager.actor.setDirection(o),!0)},JoyStick.prototype.getKeys=function(t){var i=this.mKeyCodes[t];if(i)return i;switch(t){case 0:i=this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_UP);break;case 1:i=Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_UP).concat,this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_LEFT));break;case 2:i=this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_LEFT);break;case 3:i=Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_DOWN),this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_LEFT));break;case 4:i=this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_DOWN);break;case 5:i=Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_DOWN),this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_RIGHT));break;case 6:i=this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_RIGHT);break;case 7:i=Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_UP),this.mWorld.inputManager.getKeyCodes(h.op_def.TQ_EVENT.TQ_MOVE_RIGHT))}return this.mKeyCodes[t]=i,i},JoyStick.prototype.checkdragUp=function(){return this.mdownStr="",!0},JoyStick}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return u}));var r=o(142),a=o(0),h=o(2),l=o(143),c=o(111),u=function(){function ElementStorage(){this.mModels=new Map,this.mElementRef=new Map,this.terrainPalette=new Map,this.terrainPaletteWithBindId=new Map,this.mossPalette=new Map,this.event=new Phaser.Events.EventEmitter}return ElementStorage.prototype.on=function(t,i,o){this.event.on(t,i,o)},ElementStorage.prototype.off=function(t,i,o){this.event.off(t,i,o)},ElementStorage.prototype.setGameConfig=function(t){if(a.a.getInstance().log("TCL: ElementStorage -> config",t),t){for(var i=null,o=0,c=t.objectsList;o<c.length;o++){var u=c[o];if(u.type===h.op_def.NodeType.ElementNodeType){if(!(i=this.mModels.get(u.id))){for(var p=[],d=u.animations,m=0,y=d.animationData;m<y.length;m++){var g=y[m];p.push(new l.a(g.createProtocolObject()))}i=new r.a({id:u.id,sn:u.sn,animations:{defaultAnimationName:d.defaultAnimationName,display:d.display,animationData:p}}),this.mModels.set(u.id,i)}var _={id:u.id,displayModel:i};this.mElementRef.set(u.id,_)}}this.updatePalette(t.root.palette),this.updateMoss(t.root.moss),this.updateAssets(t.root.assets)}},ElementStorage.prototype.updatePalette=function(t){for(var i=0,o=Array.from(t.peersDict.keys());i<o.length;i++){var a=o[i],h=t.peersDict.get(a);if(!this.terrainPalette.get(h.id)){var c=new r.a({id:h.id,sn:h.sn,animations:{defaultAnimationName:h.animations.defaultAnimationName,display:h.animations.display,animationData:h.animations.animationData.map((function(t){return new l.a(t.createProtocolObject())}))}});this.terrainPalette.set(a,c),this.terrainPaletteWithBindId.set(h.id,c)}}},ElementStorage.prototype.updateMoss=function(t){for(var i=0,o=Array.from(t.peersDict.keys());i<o.length;i++){var a=o[i],h=t.peersDict.get(a);if(!this.mossPalette.get(h.id)){var c=new r.a({id:h.id,sn:h.sn,animations:{defaultAnimationName:h.animations.defaultAnimationName,display:h.animations.display,animationData:h.animations.animationData.map((function(t){return new l.a(t.createProtocolObject())}))}});this.mossPalette.set(a,c)}}},ElementStorage.prototype.updateAssets=function(t){var i=t.getAssetList();this._assets=[];for(var o=0,r=i;o<r.length;o++){var a=r[o],h=a.media;if(h){var l=h.match(/\.([a-zA-Z0-9]+)($|\?)/);l&&l[1]&&this._assets.push({type:l[1],key:a.key,source:c.i.getOsdRes(h)})}}},ElementStorage.prototype.setSceneConfig=function(t){for(var i=null,o=0,a=t.objectsList;o<a.length;o++){var c=a[o];if(c.type===h.op_def.NodeType.ElementNodeType){if(!(i=this.mModels.get(c.id))){for(var u=[],p=c.animations,d=0,m=p.animationData;d<m.length;d++){var y=m[d];u.push(new l.a(y.createProtocolObject()))}i=new r.a({id:c.id,sn:c.sn,animations:{defaultAnimationName:p.defaultAnimationName,display:p.display,animationData:u}}),this.mModels.set(c.id,i)}var g={id:c.id,displayModel:i};this.mElementRef.set(c.id,g)}}var _=t.root.children.find((function(t){return t.type===h.op_def.NodeType.SceneNodeType}));this._terrainCollection=_.terrainCollection,this._mossCollection=_.mossCollection,this._scenerys=_.getScenerys()},ElementStorage.prototype.add=function(t){this.mModels.set(t.id,t)},ElementStorage.prototype.getDisplayModel=function(t){var i=this.mElementRef.get(t);if(i)return i.displayModel},ElementStorage.prototype.getTerrainCollection=function(){return this._terrainCollection},ElementStorage.prototype.getTerrainPalette=function(t){if(this.terrainPalette.get(t))return this.terrainPalette.get(t)},ElementStorage.prototype.getTerrainPaletteByBindId=function(t){if(this.terrainPaletteWithBindId.get(t))return this.terrainPaletteWithBindId.get(t)},ElementStorage.prototype.getMossCollection=function(){return this._mossCollection},ElementStorage.prototype.getMossPalette=function(t){if(this.mossPalette.get(t))return this.mossPalette.get(t)},ElementStorage.prototype.getScenerys=function(){return this._scenerys},ElementStorage.prototype.getAssets=function(){return this._assets},ElementStorage.prototype.destroy=function(){this.mElementRef.clear(),this.terrainPalette.clear(),this.terrainPaletteWithBindId.clear(),this.mossPalette.clear(),this.mModels.forEach((function(t,i){t.destroy()})),this.mModels.clear(),this._assets=void 0},ElementStorage}()},function(t,i,o){"use strict";function load(t,i){return new Promise((function(o,r){var a=new XMLHttpRequest;a.onload=function(t){o(t.currentTarget)},a.onerror=function(){r(t+" load error")},a.open("GET",t),a.responseType=i||"",a.send()}))}o.d(i,"a",(function(){return load}))},function(t,i,o){var r={"./Activity/ActivityMediator":210,"./Activity/ActivityMediator.ts":210,"./Activity/ActivityPanel":211,"./Activity/ActivityPanel.ts":211,"./Bubble/InteractionBubbleCell":329,"./Bubble/InteractionBubbleCell.ts":329,"./Bubble/InteractionBubbleContainer":248,"./Bubble/InteractionBubbleContainer.ts":248,"./Bubble/InteractiveBubble":249,"./Bubble/InteractiveBubble.ts":249,"./Bubble/InteractiveBubbleMediator":246,"./Bubble/InteractiveBubbleMediator.ts":246,"./Bubble/InteractiveBubblePanel":247,"./Bubble/InteractiveBubblePanel.ts":247,"./CharacterInfo/CharacterAttributePanel":257,"./CharacterInfo/CharacterAttributePanel.ts":257,"./CharacterInfo/CharacterEditorPanel":256,"./CharacterInfo/CharacterEditorPanel.ts":256,"./CharacterInfo/CharacterInfo":251,"./CharacterInfo/CharacterInfo.ts":251,"./CharacterInfo/CharacterInfoMediator":250,"./CharacterInfo/CharacterInfoMediator.ts":250,"./CharacterInfo/CharacterInfoPanel":255,"./CharacterInfo/CharacterInfoPanel.ts":255,"./CharacterInfo/GraphicsProgressBar":344,"./CharacterInfo/GraphicsProgressBar.ts":344,"./CharacterInfo/GridLayoutGroup":345,"./CharacterInfo/GridLayoutGroup.ts":345,"./ComponentRank/ComponentRankMediator":258,"./ComponentRank/ComponentRankMediator.ts":258,"./ComponentRank/ComponentRankPanel":259,"./ComponentRank/ComponentRankPanel.ts":259,"./Compose/Compose":223,"./Compose/Compose.ts":223,"./Compose/ComposeMediator":221,"./Compose/ComposeMediator.ts":221,"./Compose/ComposePanel":222,"./Compose/ComposePanel.ts":222,"./ControlF/ControlFMediator":346,"./ControlF/ControlFMediator.ts":346,"./ControlF/ControlFPanel":260,"./ControlF/ControlFPanel.ts":260,"./CutIn/CutInMediator":347,"./CutIn/CutInMediator.ts":347,"./CutIn/CutInPanel":261,"./CutIn/CutInPanel.ts":261,"./CutInMenu/CutInMenu":262,"./CutInMenu/CutInMenu.ts":262,"./CutInMenu/CutInMenuMediator":348,"./CutInMenu/CutInMenuMediator.ts":348,"./CutInMenu/CutInMenuPanel":263,"./CutInMenu/CutInMenuPanel.ts":263,"./DebugLogger/DebugLoggerMediator":167,"./DebugLogger/DebugLoggerMediator.ts":167,"./DebugLogger/DebugLoggerPanel":264,"./DebugLogger/DebugLoggerPanel.ts":264,"./DecorateControl/DecorateControlMediator":208,"./DecorateControl/DecorateControlMediator.ts":208,"./DecorateControl/DecorateControlPanel":209,"./DecorateControl/DecorateControlPanel.ts":209,"./Dialog/Dialog":265,"./Dialog/Dialog.ts":265,"./Dialog/DialogMediator":349,"./Dialog/DialogMediator.ts":349,"./Dialog/DialogPanel":266,"./Dialog/DialogPanel.ts":266,"./ElementStorage/DragManager":350,"./ElementStorage/DragManager.ts":350,"./ElementStorage/ElementStorageMediator":163,"./ElementStorage/ElementStorageMediator.ts":163,"./ElementStorage/ElementStoragePanel":197,"./ElementStorage/ElementStoragePanel.ts":197,"./ElementStorage/ElementStorate":199,"./ElementStorage/ElementStorate.ts":199,"./ElementStorage/item/Item":198,"./ElementStorage/item/Item.ts":198,"./EquipUpgrade/EquipUpgrade":230,"./EquipUpgrade/EquipUpgrade.ts":230,"./EquipUpgrade/EquipUpgradeItem":229,"./EquipUpgrade/EquipUpgradeItem.ts":229,"./EquipUpgrade/EquipUpgradeMediator":227,"./EquipUpgrade/EquipUpgradeMediator.ts":227,"./EquipUpgrade/EquipUpgradePanel":228,"./EquipUpgrade/EquipUpgradePanel.ts":228,"./FriendInvite/FriendInviteMediator":351,"./FriendInvite/FriendInviteMediator.ts":351,"./FriendInvite/FriendInvitePanel":267,"./FriendInvite/FriendInvitePanel.ts":267,"./FurniBag/FurniBag":268,"./FurniBag/FurniBag.ts":268,"./FurniBag/FurniBagMediator":352,"./FurniBag/FurniBagMediator.ts":352,"./FurniBag/FurniBagPanel":269,"./FurniBag/FurniBagPanel.ts":269,"./GMTools/GMToolsMediator":353,"./GMTools/GMToolsMediator.ts":353,"./GMTools/GMToolsPanel":270,"./GMTools/GMToolsPanel.ts":270,"./InfoPanel/InfoPanel":271,"./InfoPanel/InfoPanel.ts":271,"./InfoPanel/InfoPanelMediator":272,"./InfoPanel/InfoPanelMediator.ts":272,"./InteractivePanel/InteractivePanel":273,"./InteractivePanel/InteractivePanel.ts":273,"./InteractivePanel/InteractivePanelMediator":274,"./InteractivePanel/InteractivePanelMediator.ts":274,"./ItemDetail/ItemDetail":275,"./ItemDetail/ItemDetail.ts":275,"./ItemDetail/ItemDetailMediator":354,"./ItemDetail/ItemDetailMediator.ts":354,"./ItemPopCard/ItemPopCardMediator":355,"./ItemPopCard/ItemPopCardMediator.ts":355,"./ItemPopCard/ItemPopCardPanel":276,"./ItemPopCard/ItemPopCardPanel.ts":276,"./Login/LoginMediator":356,"./Login/LoginMediator.ts":356,"./Login/LoginPanel":277,"./Login/LoginPanel.ts":277,"./Login/VerifiedPanel":278,"./Login/VerifiedPanel.ts":278,"./Market/DetailDisplay":130,"./Market/DetailDisplay.ts":130,"./Market/ElementDetail":233,"./Market/ElementDetail.ts":233,"./Market/Market":236,"./Market/Market.ts":236,"./Market/MarketMediator":231,"./Market/MarketMediator.ts":231,"./Market/MarketPanel":232,"./Market/MarketPanel.ts":232,"./Market/NumberCounter":234,"./Market/NumberCounter.ts":234,"./Market/item":235,"./Market/item.ts":235,"./MessageBox/MessageBoxMediator":357,"./MessageBox/MessageBoxMediator.ts":357,"./MessageBox/MessageBoxView":279,"./MessageBox/MessageBoxView.ts":279,"./MineCar/MineCar":217,"./MineCar/MineCar.ts":217,"./MineCar/MineCarMediator":215,"./MineCar/MineCarMediator.ts":215,"./MineCar/MineCarPanel":216,"./MineCar/MineCarPanel.ts":216,"./MineSettle/MineSettle":226,"./MineSettle/MineSettle.ts":226,"./MineSettle/MineSettleMediator":224,"./MineSettle/MineSettleMediator.ts":224,"./MineSettle/MineSettlePanel":225,"./MineSettle/MineSettlePanel.ts":225,"./Notice/Notice":191,"./Notice/Notice.ts":191,"./Notice/NoticeMediator":189,"./Notice/NoticeMediator.ts":189,"./Notice/NoticePanel":190,"./Notice/NoticePanel.ts":190,"./PicBusinessMarketingPlan/PicBusinessChoosePlanPanel":280,"./PicBusinessMarketingPlan/PicBusinessChoosePlanPanel.ts":280,"./PicBusinessMarketingPlan/PicBusinessMarketingPlan":281,"./PicBusinessMarketingPlan/PicBusinessMarketingPlan.ts":281,"./PicBusinessMarketingPlan/PicBusinessMarketingPlanMediator":358,"./PicBusinessMarketingPlan/PicBusinessMarketingPlanMediator.ts":358,"./PicBusinessMarketingPlan/PicBusinessMarketingPlanPanel":282,"./PicBusinessMarketingPlan/PicBusinessMarketingPlanPanel.ts":282,"./PicBusinessMarketingPlan/PicBusinessPlanPanel":283,"./PicBusinessMarketingPlan/PicBusinessPlanPanel.ts":283,"./PicBusinessStreet/PicBusinessContentPanel":168,"./PicBusinessStreet/PicBusinessContentPanel.ts":168,"./PicBusinessStreet/PicBusinessHistoryPanel":284,"./PicBusinessStreet/PicBusinessHistoryPanel.ts":284,"./PicBusinessStreet/PicBusinessMyStreetPanel":285,"./PicBusinessStreet/PicBusinessMyStreetPanel.ts":285,"./PicBusinessStreet/PicBusinessRankRewardPanel":286,"./PicBusinessStreet/PicBusinessRankRewardPanel.ts":286,"./PicBusinessStreet/PicBusinessRankingDetailPanel":287,"./PicBusinessStreet/PicBusinessRankingDetailPanel.ts":287,"./PicBusinessStreet/PicBusinessRankingPanel":288,"./PicBusinessStreet/PicBusinessRankingPanel.ts":288,"./PicBusinessStreet/PicBusinessStoreCreatePanel":289,"./PicBusinessStreet/PicBusinessStoreCreatePanel.ts":289,"./PicBusinessStreet/PicBusinessStreet":290,"./PicBusinessStreet/PicBusinessStreet.ts":290,"./PicBusinessStreet/PicBusinessStreetListPanel":291,"./PicBusinessStreet/PicBusinessStreetListPanel.ts":291,"./PicBusinessStreet/PicBusinessStreetMediator":359,"./PicBusinessStreet/PicBusinessStreetMediator.ts":359,"./PicBusinessStreet/PicBusinessStreetPanel":293,"./PicBusinessStreet/PicBusinessStreetPanel.ts":293,"./PicBusinessStreet/SecondaryMenuPanel":292,"./PicBusinessStreet/SecondaryMenuPanel.ts":292,"./PicFriend/PicFriend":254,"./PicFriend/PicFriend.ts":254,"./PicFriend/PicFriendEvent":151,"./PicFriend/PicFriendEvent.ts":151,"./PicFriend/PicFriendMediator":252,"./PicFriend/PicFriendMediator.ts":252,"./PicFriend/PicFriendPanel":253,"./PicFriend/PicFriendPanel.ts":253,"./PicFriend/PicFriendRelation":139,"./PicFriend/PicFriendRelation.ts":139,"./PicFurniFun/PicFurniFun":243,"./PicFurniFun/PicFurniFun.ts":243,"./PicFurniFun/PicFurniFunMediator":241,"./PicFurniFun/PicFurniFunMediator.ts":241,"./PicFurniFun/PicFurniFunPanel":242,"./PicFurniFun/PicFurniFunPanel.ts":242,"./PicHandheld/PicHandheld":244,"./PicHandheld/PicHandheld.ts":244,"./PicHandheld/PicHandheldMediator":166,"./PicHandheld/PicHandheldMediator.ts":166,"./PicHandheld/PicHandheldPanel":245,"./PicHandheld/PicHandheldPanel.ts":245,"./PicHouse/PicHouse":294,"./PicHouse/PicHouse.ts":294,"./PicHouse/PicHouseInfoPanel":295,"./PicHouse/PicHouseInfoPanel.ts":295,"./PicHouse/PicHouseMediator":360,"./PicHouse/PicHouseMediator.ts":360,"./PicHouse/PicHousePanel":296,"./PicHouse/PicHousePanel.ts":296,"./PicHouse/PicHouseSettingPanel":361,"./PicHouse/PicHouseSettingPanel.ts":361,"./PicOpenParty/PicOpenParty":298,"./PicOpenParty/PicOpenParty.ts":298,"./PicOpenParty/PicOpenPartyCreatePanel":299,"./PicOpenParty/PicOpenPartyCreatePanel.ts":299,"./PicOpenParty/PicOpenPartyMediator":362,"./PicOpenParty/PicOpenPartyMediator.ts":362,"./PicOpenParty/PicOpenPartyPanel":300,"./PicOpenParty/PicOpenPartyPanel.ts":300,"./PicOpenParty/PicOpenPartySettingPanel":363,"./PicOpenParty/PicOpenPartySettingPanel.ts":363,"./PicOrder/PicOrder":301,"./PicOrder/PicOrder.ts":301,"./PicOrder/PicOrderMediator":364,"./PicOrder/PicOrderMediator.ts":364,"./PicOrder/PicOrderPanel":302,"./PicOrder/PicOrderPanel.ts":302,"./PicPartyList/PicPartyList":303,"./PicPartyList/PicPartyList.ts":303,"./PicPartyList/PicPartyListMediator":365,"./PicPartyList/PicPartyListMediator.ts":365,"./PicPartyList/PicPartyListPanel":304,"./PicPartyList/PicPartyListPanel.ts":304,"./PicPartyList/PicPartyNavigationPanel":305,"./PicPartyList/PicPartyNavigationPanel.ts":305,"./PicPropFun/PicPropFunConfig":366,"./PicPropFun/PicPropFunConfig.ts":366,"./PicPropFun/PicPropFunMediator":367,"./PicPropFun/PicPropFunMediator.ts":367,"./PicPropFun/PicPropFunPanel":306,"./PicPropFun/PicPropFunPanel.ts":306,"./PicRoomUpgrade/PicRoomUpgrade":307,"./PicRoomUpgrade/PicRoomUpgrade.ts":307,"./PicRoomUpgrade/PicRoomUpgradeMediator":368,"./PicRoomUpgrade/PicRoomUpgradeMediator.ts":368,"./PicRoomUpgrade/PicRoomUpgradePanel":308,"./PicRoomUpgrade/PicRoomUpgradePanel.ts":308,"./PicWork/PicWork":309,"./PicWork/PicWork.ts":309,"./PicWork/PicWorkMediator":369,"./PicWork/PicWorkMediator.ts":369,"./PicWork/PicWorkPanel":310,"./PicWork/PicWorkPanel.ts":310,"./PicaChat/PicChatInputPanel":213,"./PicaChat/PicChatInputPanel.ts":213,"./PicaChat/PicGiftPanel":370,"./PicaChat/PicGiftPanel.ts":370,"./PicaChat/PicaChat":214,"./PicaChat/PicaChat.ts":214,"./PicaChat/PicaChatMediator":148,"./PicaChat/PicaChatMediator.ts":148,"./PicaChat/PicaChatPanel":212,"./PicaChat/PicaChatPanel.ts":212,"./PicaMainUI/PicaMainUI":240,"./PicaMainUI/PicaMainUI.ts":240,"./PicaMainUI/PicaMainUIMediator":237,"./PicaMainUI/PicaMainUIMediator.ts":237,"./PicaMainUI/PicaMainUIPanel":238,"./PicaMainUI/PicaMainUIPanel.ts":238,"./PicaMessageBox/PicaMessageBoxMediator":371,"./PicaMessageBox/PicaMessageBoxMediator.ts":371,"./PicaMessageBox/PicaMessageBoxPanel":311,"./PicaMessageBox/PicaMessageBoxPanel.ts":311,"./PicaNavigate/PicaNavigate":312,"./PicaNavigate/PicaNavigate.ts":312,"./PicaNavigate/PicaNavigateMediator":372,"./PicaNavigate/PicaNavigateMediator.ts":372,"./PicaNavigate/PicaNavigatePanel":313,"./PicaNavigate/PicaNavigatePanel.ts":313,"./PicaNotice/PicaNoticeMediator":373,"./PicaNotice/PicaNoticeMediator.ts":373,"./PicaNotice/PicaNoticePanel":314,"./PicaNotice/PicaNoticePanel.ts":314,"./PicaRoomList/PicaRoomListMediator":374,"./PicaRoomList/PicaRoomListMediator.ts":374,"./PicaRoomList/PicaRoomListPanel":315,"./PicaRoomList/PicaRoomListPanel.ts":315,"./PicaRoomList/RoomList":316,"./PicaRoomList/RoomList.ts":316,"./Rank/BasicRankPanel":160,"./Rank/BasicRankPanel.ts":160,"./Rank/RankMediator":147,"./Rank/RankMediator.ts":147,"./Rank/RankPanel":194,"./Rank/RankPanel.ts":194,"./ReAwardTips/ReAwardTip":219,"./ReAwardTips/ReAwardTip.ts":219,"./ReAwardTips/ReAwardTipsMediator":218,"./ReAwardTips/ReAwardTipsMediator.ts":218,"./ReAwardTips/ReAwardTipsPanel":220,"./ReAwardTips/ReAwardTipsPanel.ts":220,"./Shop/ShopMediator":317,"./Shop/ShopMediator.ts":317,"./Shop/ShopPanel":318,"./Shop/ShopPanel.ts":318,"./Shop/shop.itemSlot":330,"./Shop/shop.itemSlot.ts":330,"./Task/Task":319,"./Task/Task.ts":319,"./Task/TaskMediator":375,"./Task/TaskMediator.ts":375,"./Task/TaskPanel":320,"./Task/TaskPanel.ts":320,"./UserInfo/UserInfoMediator":321,"./UserInfo/UserInfoMediator.ts":321,"./UserInfo/UserInfoPanel":322,"./UserInfo/UserInfoPanel.ts":322,"./UserMenu/MenuItem":323,"./UserMenu/MenuItem.ts":323,"./UserMenu/UserMenuMediator":376,"./UserMenu/UserMenuMediator.ts":376,"./UserMenu/UserMenuPanel":377,"./UserMenu/UserMenuPanel.ts":377,"./alert/PopUpTextUI":378,"./alert/PopUpTextUI.ts":378,"./bag/IListItemRender":379,"./bag/IListItemRender.ts":379,"./bag/bagView/bagMediator":132,"./bag/bagView/bagMediator.ts":132,"./bag/bagView/bagPanel":192,"./bag/bagView/bagPanel.ts":192,"./bag/basebag":380,"./bag/basebag.ts":380,"./bag/baseitem":381,"./bag/baseitem.ts":381,"./bag/dragDropIcon":145,"./bag/dragDropIcon.ts":145,"./bag/idragable":382,"./bag/idragable.ts":382,"./bag/idropable":383,"./bag/idropable.ts":383,"./bag/item.slot":133,"./bag/item.slot.ts":133,"./bag/storage/storageMediator":324,"./bag/storage/storageMediator.ts":324,"./bag/storage/storagePanel":325,"./bag/storage/storagePanel.ts":325,"./baseView/bagGroup/bag.group":204,"./baseView/bagGroup/bag.group.mediator":203,"./baseView/bagGroup/bag.group.mediator.ts":203,"./baseView/bagGroup/bag.group.ts":204,"./baseView/baseFace.mediator":134,"./baseView/baseFace.mediator.ts":134,"./baseView/bottomGroup/bottom.btn.group":196,"./baseView/bottomGroup/bottom.btn.group.ts":196,"./baseView/bottomGroup/bottom.mediator":162,"./baseView/bottomGroup/bottom.mediator.ts":162,"./baseView/icon.btn":124,"./baseView/icon.btn.ts":124,"./baseView/icon.select.btn":202,"./baseView/icon.select.btn.ts":202,"./baseView/leftGroup/left.btn.group":201,"./baseView/leftGroup/left.btn.group.ts":201,"./baseView/leftGroup/left.mediator":200,"./baseView/leftGroup/left.mediator.ts":200,"./baseView/rightGroup/right.btn.group":195,"./baseView/rightGroup/right.btn.group.ts":195,"./baseView/rightGroup/right.mediator":161,"./baseView/rightGroup/right.mediator.ts":161,"./baseView/top.menu/top.menu.container":206,"./baseView/top.menu/top.menu.container.ts":206,"./baseView/top.menu/top.menu.mediator":205,"./baseView/top.menu/top.menu.mediator.ts":205,"./baseView/topGroup/top.btn.group":326,"./baseView/topGroup/top.btn.group.ts":326,"./baseView/topGroup/top.mediator":384,"./baseView/topGroup/top.mediator.ts":384,"./chat/Chat":187,"./chat/Chat.ts":187,"./chat/base.chat.panel":157,"./chat/base.chat.panel.ts":157,"./chat/chat.mediator":144,"./chat/chat.mediator.ts":144,"./chat/chatPanel.pc":184,"./chat/chatPanel.pc.ts":184,"./chat/message":385,"./chat/message.ts":385,"./chat/mobile/chatPanel.mobile":186,"./chat/mobile/chatPanel.mobile.ts":186,"./components/BasePanel":112,"./components/BasePanel.ts":112,"./components/ItemsConsumeFunPanel":297,"./components/ItemsConsumeFunPanel.ts":297,"./components/LoadingView":386,"./components/LoadingView.ts":386,"./components/TextButton":150,"./components/TextButton.ts":150,"./components/alert.view":135,"./components/alert.view.ts":135,"./components/check.button":156,"./components/check.button.ts":156,"./components/checkbox.group":127,"./components/checkbox.group.ts":127,"./components/dynamic.image":116,"./components/dynamic.image.ts":116,"./components/dynamic.ninepatch":176,"./components/dynamic.ninepatch.ts":176,"./components/dynamic.sprite":174,"./components/dynamic.sprite.ts":174,"./components/input.panel":165,"./components/input.panel.ts":165,"./components/inputTextFactory":207,"./components/inputTextFactory.ts":207,"./components/label.input":149,"./components/label.input.ts":149,"./components/message.box":387,"./components/message.box.ts":387,"./components/nine.patch":117,"./components/nine.patch.ts":117,"./components/ninepatch.button":121,"./components/ninepatch.button.ts":121,"./components/patches.config":185,"./components/patches.config.ts":185,"./components/radio":164,"./components/radio.ts":164,"./components/tab.button":388,"./components/tab.button.ts":388,"./decorate/decorate.manager":181,"./decorate/decorate.manager.ts":181,"./decorate/decorate.panel":182,"./decorate/decorate.panel.ts":182,"./friend/friend.mediator":159,"./friend/friend.mediator.ts":159,"./friend/friend.panel":193,"./friend/friend.panel.ts":193,"./layer.manager":188,"./layer.manager.ts":188,"./loadview":389,"./loadview.ts":389,"./tips/ItemInfoTips":129,"./tips/ItemInfoTips.ts":129,"./tips/TextToolTip":239,"./tips/TextToolTip.ts":239,"./tips/itoolTip":390,"./tips/itoolTip.ts":390,"./tips/toolTip":158,"./tips/toolTip.ts":158,"./ui.atals.name":115,"./ui.atals.name.ts":115,"./ui.manager":183,"./ui.manager.ts":183,"./ui.mediatorType":125,"./ui.mediatorType.ts":125};function webpackContext(t){var i=webpackContextResolve(t);return o(i)}function webpackContextResolve(t){if(!o.o(r,t)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return r[t]}webpackContext.keys=function webpackContextKeys(){return Object.keys(r)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=414},,function(t,i,o){"use strict";o.d(i,"a",(function(){return l}));var r,a=o(128),h=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),l=function(t){function LoginScene(){return t.call(this,{key:LoginScene.name})||this}return h(LoginScene,t),LoginScene.prototype.preload=function(){},LoginScene.prototype.create=function(){if(this.world){var t=this.world.uiManager;t.setScene(this),t.showMed("Login")}},LoginScene.prototype.init=function(t){t&&(this.world=t.world)},LoginScene}(a.a)},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function Account(){}return Account.prototype.setAccount=function(t){this.mCurAccountData={id:t.id,fingerprint:t.fingerprint,refreshToken:t.refreshToken,expire:t.expire,accessToken:t.token||t.accessToken},this.saveLocalStorage()},Account.prototype.refreshToken=function(t){if(this.mCurAccountData){var i=t.newExpire,o=t.newFingerprint,r=t.newToken;this.mCurAccountData.expire=i,this.mCurAccountData.fingerprint=o,this.mCurAccountData.accessToken=r,this.saveLocalStorage()}},Account.prototype.saveLocalStorage=function(){if(this.mCurAccountData){var t=this.mCurAccountData,i=t.id,o=t.fingerprint,r=t.refreshToken,a=t.expire,h=t.accessToken;localStorage.setItem("token",JSON.stringify({id:i,fingerprint:o,refreshToken:r,expire:a,accessToken:h}))}},Account.prototype.clear=function(){this.mCurAccountData={accessToken:"",expire:0,fingerprint:"",id:"",refreshToken:""}},Account.prototype.destroy=function(){this.clear(),localStorage.removeItem("token"),this.enterGame(void 0,void 0,void 0,void 0)},Object.defineProperty(Account.prototype,"accountData",{get:function(){return this.mCurAccountData},enumerable:!1,configurable:!0}),Account.prototype.enterGame=function(t,i,o,r){this.mGameId=t,this.mVirtualWorldId=i,this.mSceneID=o,this.mLoc=r},Object.defineProperty(Account.prototype,"gameID",{get:function(){return this.mGameId},enumerable:!1,configurable:!0}),Object.defineProperty(Account.prototype,"virtualWorldId",{get:function(){return this.mVirtualWorldId},enumerable:!1,configurable:!0}),Object.defineProperty(Account.prototype,"sceneId",{get:function(){return this.mSceneID},enumerable:!1,configurable:!0}),Object.defineProperty(Account.prototype,"loc",{get:function(){return this.mLoc},enumerable:!1,configurable:!0}),Account}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return r}));var r=function(){function HttpService(t){this.mWorld=t,this.api_root=this.mWorld.getConfig().api_root}return HttpService.prototype.follow=function(t){return this.post("user/follow",{fuid:t})},HttpService.prototype.unfollow=function(t){return this.post("user/unfollow",{fuid:t})},HttpService.prototype.banUser=function(t){return this.post("user/ban",{fuid:t})},HttpService.prototype.removeBanUser=function(t){return this.post("user/unban",{fuid:t})},HttpService.prototype.checkFollowed=function(t){return this.post("user/check_followed",{uids:t})},HttpService.prototype.login=function(t,i){return fetch(this.mWorld.getConfig().api_root+"account/signin",{body:JSON.stringify({account:t,password:i}),method:"POST",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))},HttpService.prototype.requestPhoneCode=function(t,i){return fetch(this.api_root+"account/sms_code",{body:JSON.stringify({phone:t,areaCode:i}),method:"POST",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))},HttpService.prototype.tokenCheck=function(){return this.get("account/tokencheck")},HttpService.prototype.refreshToekn=function(t,i){return this.post("account/refresh_token",{refreshToken:t,token:i})},HttpService.prototype.loginByPhoneCode=function(t,i,o){return fetch(this.api_root+"account/phone_signin",{body:JSON.stringify({phone:t,code:i,areaCode:o}),method:"POST",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))},HttpService.prototype.quickLogin=function(){return fetch(this.api_root+"account/quick_signin",{method:"POST"}).then((function(t){return t.json()}))},HttpService.prototype.verified=function(t,i){return this.post("game/real_name_authentication",{realName:t,identifcationCode:i})},HttpService.prototype.firend=function(){return this.get("user/friends")},HttpService.prototype.userDetail=function(t){return this.get("account/"+t+"/detail")},HttpService.prototype.badgecards=function(t){return this.get("userpackage/"+t+"/badgecards")},HttpService.prototype.playedDuration=function(t,i){return this.post("game/played_duration",{gameId:i},{"App-Key":t})},HttpService.prototype.post=function(t,i,o){var r=this.mWorld.account;if(!r)return Promise.reject("account does not exist");if(!r.accountData)return Promise.reject("token does not exist");o=Object.assign({"Content-Type":"application/json","X-Pixelpai-TK":r.accountData.accessToken},o);var a={body:JSON.stringify(i),method:"POST",headers:o};return fetch(""+this.api_root+t,a).then((function(t){return t.json()}))},HttpService.prototype.get=function(t){var i=this.mWorld.account;if(!i)return Promise.reject("account does not exist");if(!i.accountData)return Promise.reject("token does not exist");var o={method:"GET",headers:{"X-Pixelpai-TK":i.accountData.accessToken}};return fetch(""+this.api_root+t,o).then((function(t){return t.json()}))},HttpService}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return u}));var r,a=o(111),h=o(179),l=o(128),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function GamePauseScene(){return t.call(this,{key:GamePauseScene.name})||this}return c(GamePauseScene,t),GamePauseScene.prototype.preload=function(){this.load.image("gamepause.png",a.i.getRes("gamepause.png"))},GamePauseScene.prototype.init=function(t){this.mWorld=t.world},GamePauseScene.prototype.create=function(){var t=this.scale.gameSize.width,i=this.scale.gameSize.height;this.bg=this.add.graphics(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,t,i),this.pauseImg=this.add.image(t>>1,i>>1,"gamepause.png"),this.tipTF=this.add.text(t-240>>1,i-50,"点击任意位置开始游戏",{font:"30px Tahoma"}),this.scale.on("resize",this.checkSize,this),this.checkSize(new h.a(t,i)),this.input.on("pointerdown",this.downHandler,this)},GamePauseScene.prototype.awake=function(){this.scale.on("resize",this.checkSize,this),this.input.on("pointerdown",this.downHandler,this),this.scene.wake()},GamePauseScene.prototype.sleep=function(){this.scale.off("resize",this.checkSize,this),this.input.off("pointerdown",this.downHandler,this),this.scene.sleep()},GamePauseScene.prototype.getKey=function(){return this.sys.config.key},GamePauseScene.prototype.downHandler=function(){this.mWorld.onFocus()},GamePauseScene.prototype.checkSize=function(t){var i=t.width,o=t.height;this.bg.clear(),this.bg.fillStyle(0,.8),this.bg.fillRect(0,0,i,o),this.pauseImg.scaleX=this.pauseImg.scaleY=.7*this.mWorld.uiScale,this.pauseImg.x=i>>1,this.pauseImg.y=o>>1,this.tipTF.scaleX=this.tipTF.scaleY=this.mWorld.uiScale,this.tipTF.x=i-280*this.mWorld.uiScale>>1,this.tipTF.y=o-50*this.mWorld.uiScale},GamePauseScene}(l.a)},function(t,i,o){"use strict";o.d(i,"a",(function(){return d}));var r,a,h=o(0),l=o(110),c=o(2),u=o(111),p=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)});!function(t){t[t.Background=0]="Background",t[t.Element=1]="Element",t[t.Effect=2]="Effect"}(a||(a={}));var d=function(t){function SoundManager(i){var o=t.call(this)||this;return o.world=i,o}return p(SoundManager,t),SoundManager.prototype.addPackListener=function(){var t=this.world.connection;t&&(t.addPacketListener(this),this.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SOUND_CTL,this.onPlaySoundHandler))},SoundManager.prototype.removePacketListener=function(){var t=this.world.connection;t&&t.removePacketListener(this)},SoundManager.prototype.changeRoom=function(t){this.mSoundMap&&this.mSoundMap.clear(),this.mSoundMap=new Map,this.mScene=t.scene},SoundManager.prototype.play=function(t){if(this.mScene){var i=t.key;i||(i=Array.isArray(t.urls)?t.urls.join(""):t.urls);var o=t.field||a.Background,r=this.mSoundMap.get(o);r||(r=new m(this.mScene),this.mSoundMap.set(o,r)),r.play(i,t.urls,t.soundConfig)}else h.a.getInstance().fatal(SoundManager.name+" scene does not exist. play "+t.key+" fatal")},SoundManager.prototype.stop=function(t){if(this.mScene){var i=this.mSoundMap.get(t);i&&i.stop()}else h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't stop")},SoundManager.prototype.pause=function(t){if(this.mScene){var i=this.mSoundMap.get(t);i&&i.pause()}else h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't pause")},SoundManager.prototype.resumes=function(t){if(this.mScene){var i=this.mSoundMap.get(t);i&&i.resume()}else h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't resume")},SoundManager.prototype.stopAll=function(){this.mScene?this.mSoundMap.forEach((function(t){t&&t.stop()})):h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't stopAll")},SoundManager.prototype.pauseAll=function(){this.mScene?this.mSoundMap.forEach((function(t){t&&t.pause()})):h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't pauseAll")},SoundManager.prototype.resume=function(){this.mScene?this.mSoundMap.forEach((function(t){t&&t.resume()})):h.a.getInstance().fatal(SoundManager.name+" scene does not exist,can't resumeAll")},SoundManager.prototype.destroy=function(){this.mSoundMap&&(this.mSoundMap.forEach((function(t){t&&t.destroy()})),this.mSoundMap.clear(),this.mSoundMap=void 0),this.removePacketListener()},SoundManager.prototype.onPlaySoundHandler=function(t){var i=t.content;void 0===i.loop&&(i.loop=!0),this.play({key:i.soundKey,urls:u.i.getOsdRes(i.soundKey),field:i.scope,soundConfig:{loop:i.loop}})},SoundManager}(l.PacketHandler),m=function(){function Sound(t){this.scene=t}return Sound.prototype.sound=function(){return this.mSound},Sound.prototype.play=function(t,i,o){if(this.scene)if(this.mSound&&this.mSound.key===t){if(this.mSound.isPlaying)return;this.mSound.play()}else if(this.mKey=t,this.scene.cache.audio.exists(t))this.startPlay();else{if(!i)return;this.scene.load.once("filecomplete-audio-"+t,this.onSoundCompleteHandler,this),this.scene.load.audio(t,i),this.scene.load.start()}},Sound.prototype.pause=function(){if(this.scene)if(this.mSound){if(this.mSound.isPaused)return;this.mSound.pause()}else;},Sound.prototype.stop=function(){if(this.scene)if(this.mSound){if(!this.mSound.isPlaying)return;this.mSound.stop()}else;},Sound.prototype.resume=function(){if(this.scene)if(this.mSound){if(!this.mSound.isPaused)return;this.mSound.resume()}else;},Sound.prototype.destroy=function(){this.mSound&&(this.mSound.stop(),this.mSound.destroy(),this.mSound=void 0)},Sound.prototype.onSoundCompleteHandler=function(){this.startPlay()},Sound.prototype.startPlay=function(){this.mSound&&(this.mSound.stop(),this.mSound.destroy()),this.mSound=this.scene.sound.add(this.mKey),this.mSound.play()},Sound}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(131),__awaiter=function(t,i,o,r){return new(o||(o=Promise))((function(a,h){function fulfilled(t){try{step(r.next(t))}catch(t){h(t)}}function rejected(t){try{step(r.throw(t))}catch(t){h(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof o?t:new o((function(i){i(t)}))}(t.value).then(fulfilled,rejected)}step((r=r.apply(t,i||[])).next())}))},__generator=function(t,i){var o,r,a,h,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return h={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h;function verb(h){return function(c){return function step(h){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=2&h[0]?r.return:h[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,h[1])).done)return a;switch(r=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return l.label++,{value:h[1],done:!1};case 5:l.label++,r=h[1],h=[0];continue;case 7:h=l.ops.pop(),l.trys.pop();continue;default:if(!(a=l.trys,(a=a.length>0&&a[a.length-1])||6!==h[0]&&2!==h[0])){l=0;continue}if(3===h[0]&&(!a||h[1]>a[0]&&h[1]<a[3])){l.label=h[1];break}if(6===h[0]&&l.label<a[1]){l.label=a[1],a=h;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(h);break}a[2]&&l.ops.pop(),l.trys.pop();continue}h=i.call(t,l)}catch(t){h=[6,t],r=0}finally{o=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([h,c])}}},a=function(){function LoadingManager(t){this.world=t,this.mResources=[]}return LoadingManager.prototype.start=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(a){return(i=this.game.scene)?((o=i.getScene(r.a.name))||i.add(r.a.name,r.a),o?o.awake({world:this.world,text:t,callBack:this.sceneCallback.bind(this)}):i.start(r.a.name,{world:this.world,text:t,callBack:this.sceneCallback.bind(this)}),[2]):[2,Promise.reject("start faild. SceneManager does not exist")]}))}))},LoadingManager.prototype.addAssets=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o,r;return __generator(this,(function(a){if(!this.scene)return[2];if(!t)return[2];for(i=0,o=t;i<o.length;i++)r=o[i],this.loadAsset(r);return[2,this.startup(this.scene)]}))}))},LoadingManager.prototype.startup=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o,r,a=this;return __generator(this,(function(h){for(this.scene=t,this.scene.load.once(Phaser.Loader.Events.COMPLETE,(function(){return a.mLoading=!1,a.mResources=[],Promise.resolve()})),i=0,o=this.mResources;i<o.length;i++)r=o[i],this.loadAsset(r);return this.scene.load.start(),this.mLoading=!0,[2]}))}))},LoadingManager.prototype.destroy=function(){this.mResources&&(this.mResources=[]),this.scene=void 0},LoadingManager.prototype.loadAsset=function(t){var i=this.getLoadType(t.type);this.scene.load[i]&&this.scene.load[i](t.key,t.source)},LoadingManager.prototype.sceneCallback=function(t){return this.scene=t,this.mResources.length>0?this.addAssets(this.mResources):Promise.resolve()},Object.defineProperty(LoadingManager.prototype,"game",{get:function(){if(this.world)return this.world.game},enumerable:!1,configurable:!0}),LoadingManager.prototype.getLoadType=function(t){return"mp3"===t||"wmv"===t||"ogg"===t?"audio":t},LoadingManager}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return h}));var r=o(135),a=o(114),h=function(){function HttpClock(t){this.world=t,this.interval=6e4,this.mTimestamp=0,this.mEnable=!1,this.httpService=t.httpService}return HttpClock.prototype.update=function(t,i){!1!==this.mEnable&&(this.mTimestamp>this.interval&&(this.sync(),this.mTimestamp=0),this.mTimestamp+=i)},HttpClock.prototype.allowLogin=function(t){var i=this;return new Promise((function(o,r){i.fetch().then((function(a){var h=a.code,l=a.data;if(0===h){if(!i.allowedPeriod(l,t))return void o(!1);if(!i.checkTimeAllowed(l,t))return void o(!1);o(!0)}else r(a.msg)}))}))},HttpClock.prototype.fetch=function(){return this.world.httpService.playedDuration("831dab",this.world.getConfig().game_id)},HttpClock.prototype.sync=function(){var t=this;this.fetch().then((function(i){var o=i.code,r=i.data;0===o&&(t.checkTimeAllowed(r)&&t.allowedPeriod(r)||t.world.connection.closeConnect())}))},HttpClock.prototype.allowedPeriod=function(t,i){return!!t.in_allowed_period||(this.showAlert("[color=#ff0000][size="+14*this.world.uiRatio+"]您的账号属于未成年人[/size][/color]\n每日22:00~次日8:00是休息时间，根据相关规定，该时间不可登录游戏，请注意休息哦！",i),!1)},HttpClock.prototype.checkTimeAllowed=function(t,i){return!(t.time_played>=t.max_time_allowed)||(this.showAlert("[color=#ff0000][size="+14*this.world.uiRatio+"]您的账号属于未成年人[/size][/color]\n今日累计时长已超过"+(t.max_time_allowed/3600).toFixed(1)+"小时！\n不可登录",i),!1)},HttpClock.prototype.showAlert=function(t,i){var o=this.world.uiManager.getUILayerManager();new r.AlertView(o.scene,this.world).show({text:t,callback:i,btns:r.Buttons.Ok,title:a.a.t("common.tips")})},Object.defineProperty(HttpClock.prototype,"enable",{set:function(t){this.mEnable=t},enumerable:!1,configurable:!0}),HttpClock}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return a}));var r=o(114),a=function(){function LoadingTips(){}return LoadingTips.enterGame=function(){return r.a.t("loading.enter_game")},LoadingTips.downloadGameConfig=function(){return r.a.t("loading.downloading_config")},LoadingTips.downloadSceneConfig=function(){return r.a.t("loading.downloading_scene_config")},LoadingTips.parseConfig=function(){return r.a.t("loading.parse_config")},LoadingTips.waitEnterRoom=function(){return r.a.t("loading.wait_enter_room")},LoadingTips.loginGame=function(){return r.a.t("loading.logging")},LoadingTips}()},function(t,i,o){"use strict";o.d(i,"a",(function(){return p}));var r,a=o(179),h=o(111),l=o(0),c=o(128),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function LoginAccountScene(){return t.call(this,{key:LoginAccountScene.name})||this}return u(LoginAccountScene,t),LoginAccountScene.prototype.preload=function(){var t=2;this.mWorld&&(t=this.mWorld.uiRatio||2),this.load.image("avatar_placeholder",h.i.getRes("dragonbones/avatar.png")),this.load.atlas("curtain",h.i.getUIRes(t,"loading/curtain.png"),h.i.getUIRes(t,"loading/curtain.json")),this.load.atlas("loading",h.i.getRes("ui/loading/loading.png"),h.i.getRes("ui/loading/loading.json")),this.load.script("webfont","./resources/scripts/webfont/1.6.26/webfont.js")},LoginAccountScene.prototype.init=function(t){this.createFont(),this.mWorld=t.world,this.mCallback=t.callBack},LoginAccountScene.prototype.create=function(){var t=this;try{WebFont.load({custom:{families:["Source Han Sans","tt0173m_","tt0503m_","t04B25"]}})}catch(t){l.a.getInstance().warn("webfont failed to load")}var i=this.scale.gameSize.width,o=this.scale.gameSize.height;this.anims.create({key:"loading_anis",frames:this.anims.generateFrameNames("loading",{prefix:"loading_",start:1,end:3,zeroPad:1,suffix:".png"}),frameRate:5,repeat:-1});var r=this.mWorld.uiRatio;this.bg=this.add.sprite(.5*i,.5*o,"loading").setScale(this.mWorld.uiScale*r*2),this.bg.play("loading_anis"),this.checkSize(new a.a(i,o)),this.scale.on("resize",this.checkSize,this);var h=this.add.graphics();h.fillStyle(16763904,.8),h.fillRect(0,0,100,50),h.setInteractive(new Phaser.Geom.Rectangle(0,0,100,50),Phaser.Geom.Rectangle.Contains),h.x=200,h.y=300,h.on("pointerdown",(function(){t.mCallback&&(t.mCallback.call(t,t),t.mCallback=void 0)}),this)},LoginAccountScene.prototype.getKey=function(){return this.sys.config.key},LoginAccountScene.prototype.checkSize=function(t){},LoginAccountScene.prototype.createFont=function(){var t=document.createElement("style");document.head.appendChild(t);var i=t.sheet;i.insertRule("@font-face { font-family: 'tt0173m_'; src: url('./resources/fonts/en/tt0173m_.ttf') format('truetype');font-display:swap }\n",0),i.insertRule("@font-face { font-family: 'tt0503m_'; src: url('./resources/fonts/en/tt0503m_.ttf') format('truetype'); font-display:swap}\n",0),i.insertRule("@font-face { font-family: 't04B25'; src: url('./resources/fonts/04B.ttf') format('truetype'); font-display:swap}",0)},LoginAccountScene}(c.a)},function(t,i,o){"use strict";o.d(i,"a",(function(){return Kt}));var r,a,h=o(152),l=o(110),c=o(2),u=o(0),p=o(118),d=o(126),m=o(119),y=o(339),g=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),_=c.op_def.NodeType,v=function(t){function PlayerManager(i){var o=t.call(this)||this;return o.mRoom=i,o.hasAddComplete=!1,o.mPlayerMap=new Map,o.connection&&(o.connection.addPacketListener(o),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE,o.onAdd),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END,o.addComplete),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE,o.onRemove),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION,o.onAdjust),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE,o.onMove),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_EFFECT,o.onShowEffect),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE,o.onOnlyBubbleHandler),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT,o.onShowBubble),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN,o.onClearBubbleHandler),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE,o.onSync),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION,o.onChangeAnimation),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION,o.onSetPosition),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE_BY_PATH,o.onMovePath)),o}return g(PlayerManager,t),Object.defineProperty(PlayerManager.prototype,"actor",{get:function(){return this.mRoom.world.user},enumerable:!1,configurable:!0}),PlayerManager.prototype.destroy=function(){var t=this;this.mActor&&(this.mActor.destroy(),this.mActor=null),this.connection&&this.connection.removePacketListener(this),this.mPlayerMap&&(this.mPlayerMap.forEach((function(i){return t.removeFromMap(i.id)})),this.mPlayerMap.clear())},PlayerManager.prototype.removeFromMap=function(t){var i=this.mPlayerMap.get(t);i&&(this.mPlayerMap.delete(t),i.destroy())},PlayerManager.prototype.get=function(t){if(this.mPlayerMap){var i=this.mPlayerMap.get(t);if(!i){var o=this.actor;o&&o.id===t&&(i=o)}return i}},PlayerManager.prototype.add=function(t){},PlayerManager.prototype.remove=function(t){var i=this.mPlayerMap.get(t);return i&&(this.mPlayerMap.delete(t),i.destroy()),this.mActor&&(this.mActor.destroy(),this.mActor=null),i},PlayerManager.prototype.setMe=function(t){this.mActor=t,this.mPlayerMap.set(t.id,t)},PlayerManager.prototype.getElements=function(){return Array.from(this.mPlayerMap.values())},PlayerManager.prototype.set=function(t,i){this.mPlayerMap||(this.mPlayerMap=new Map),this.mPlayerMap.set(t,i)},Object.defineProperty(PlayerManager.prototype,"camera",{get:function(){return this.mRoom.cameraService.camera},enumerable:!1,configurable:!0}),PlayerManager.prototype.addPackItems=function(t,i){var o=this.mPlayerMap.get(t);o&&o.id===this.mActor.id&&(o.package||(o.package=c.op_gameconfig.Package.create()),o.package.items=o.package.items.concat(i),this.mRoom.world.emitter.emit(m.a.UPDATED_CHARACTER_PACKAGE))},PlayerManager.prototype.removePackItems=function(t,i){var o=this.mPlayerMap.get(t);if(o&&this.mActor.id)for(var r=o.package.items,a=r.length,h=0;h<a;h++)if(i===r[h].id)return r.splice(h,1),!0;return!1},PlayerManager.prototype.onSync=function(t){var i=t.content;if(i.nodeType===c.op_def.NodeType.CharacterNodeType)for(var o=null,r=i.sprites,a=i.command,h=0,l=r;h<l.length;h++){var u=l[h];(o=this.get(u.id))&&(a===c.op_def.OpCommand.OP_COMMAND_UPDATE?o.model=new d.a(u):a===c.op_def.OpCommand.OP_COMMAND_PATCH&&o.updateModel(u))}},PlayerManager.prototype.onAdjust=function(t){var i=t.content,o=i.spritePositions;if(i.nodeType===c.op_def.NodeType.CharacterNodeType&&this.mActor)for(var r=void 0,a=void 0,h=0,l=o;h<l.length;h++){var u=l[h];(r=this.mPlayerMap.get(u.id))&&(a=u.point3f,r.setPosition(new p.a(a.x||0,a.y||0,a.z||0)))}},PlayerManager.prototype.onAdd=function(t){this.mPlayerMap||(this.mPlayerMap=new Map);var i=t.content,o=i.sprites;if(i.nodeType===c.op_def.NodeType.CharacterNodeType)for(var r=0,a=o;r<a.length;r++){var h=a[r];this._add(new d.a(h))}},PlayerManager.prototype._add=function(t){if(this.mPlayerMap||(this.mPlayerMap=new Map),!this.mPlayerMap.has(t.id)){var i=new y.a(t,this);this.mPlayerMap.set(i.id||0,i)}},PlayerManager.prototype.addComplete=function(t){this.hasAddComplete=!0},PlayerManager.prototype.onRemove=function(t){var i=t.content,o=i.nodeType,r=i.ids;if(o===c.op_def.NodeType.CharacterNodeType)for(var a=0,h=r;a<h.length;a++){var l=h[a];this.removeFromMap(l)}},PlayerManager.prototype.onMove=function(t){var i=t.content;if(i.moveData)for(var o=i.moveData,r=o.length,a=(i.nodeType,void 0),h=void 0,l=void 0,c=0;c<r;c++)h=(a=o[c]).moveObjectId,(l=this.get(h))&&l.move(a)},PlayerManager.prototype.onSetPosition=function(t){var i=t.content,o=i.nodeType,r=i.id;if(o===_.CharacterNodeType){var a=this.get(r);a&&a.setPosition(new p.a(i.position.x,i.position.y,i.position.z))}},PlayerManager.prototype.onShowBubble=function(t){var i=t.content,o=this.get(i.chatSenderid);o&&o.showBubble(i.chatContext,i.chatSetting)},PlayerManager.prototype.onOnlyBubbleHandler=function(t){var i=t.content,o=this.get(i.receiverid);o&&o.showBubble(i.context,i.chatsetting)},PlayerManager.prototype.onClearBubbleHandler=function(t){var i=t.content,o=this.get(i.receiverid);o&&o.clearBubble()},PlayerManager.prototype.onShowEffect=function(t){for(var i,o=0,r=t.content.id;o<r.length;o++){var a=r[o];(i=this.get(a))&&i.showEffected(null)}},PlayerManager.prototype.onChangeAnimation=function(t){var i=t.content;if(i.nodeType===_.CharacterNodeType)for(var o=null,r=0,a=i.ids;r<a.length;r++){var h=a[r];(o=this.get(h))&&o.setQueue(i.changeAnimation)}},PlayerManager.prototype.onMovePath=function(t){var i=t.content;if(i.nodeType===_.CharacterNodeType){var o=this.get(i.id);o&&o.movePath(i)}},Object.defineProperty(PlayerManager.prototype,"roomService",{get:function(){return this.mRoom},enumerable:!1,configurable:!0}),Object.defineProperty(PlayerManager.prototype,"scene",{get:function(){if(this.mRoom)return this.mRoom.scene},enumerable:!1,configurable:!0}),Object.defineProperty(PlayerManager.prototype,"connection",{get:function(){if(this.mRoom)return this.mRoom.connection;u.a.getInstance().error("room is undefined")},enumerable:!1,configurable:!0}),Object.defineProperty(PlayerManager.prototype,"map",{get:function(){return[]},enumerable:!1,configurable:!0}),PlayerManager}(l.PacketHandler),b=o(327),P=o(177),w=o(138),S=o(328),C=o(169),T=o(392),k=o(131),O=o(122),I=o(137),M=o(337),E=o(111),x=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),B=function(t){function FallEffect(i,o){var r=t.call(this,i)||this;return r.scale=o,r}return x(FallEffect,t),FallEffect.prototype.show=function(t){this.mStatus=t,this.load()},FallEffect.prototype.load=function(){this.scene.textures.exists("fall_effect")?this.onCompleteHandler():(this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onCompleteHandler,this),this.scene.load.atlas("fall_effect",E.i.getRes("ui/fall_effect/falleffect.png"),E.i.getRes("ui/fall_effect/falleffect.json")),this.scene.load.start())},FallEffect.prototype.showEnable=function(){this.mDisplay=new R(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.showDisable=function(){this.mDisplay=new D(this.scene,"fall_effect"),this.add(this.mDisplay)},FallEffect.prototype.onCompleteHandler=function(){var t=this;this.mStatus===c.op_def.PathReachableStatus.PATH_REACHABLE_AREA||this.mStatus===c.op_def.PathReachableStatus.PATH_REACHABLE_WITH_INTERACTION_SPRITE?this.showEnable():this.showDisable(),this.scene.tweens.add({targets:this,duration:1e3,ease:"Expo",delay:1e3,props:{alpha:0},onComplete:function(){t.destroy(),t.emit("remove",t)}})},FallEffect}(Phaser.GameObjects.Container),R=function(t){function EnableDisplay(i,o){var r=t.call(this,i)||this;r.mImage=i.make.sprite({key:o,x:9,y:-20},!1).setScale(.5),r.add(r.mImage),r.mEllipse=i.make.sprite(void 0,!1),r.addAt(r.mEllipse,0);var a={key:"fill_effect_enable",frames:r.scene.anims.generateFrameNames("fall_effect",{prefix:"enable",end:6,zeroPad:2}),frameRate:16,repeat:0};r.scene.anims.create(a),r.mImage.play("fill_effect_enable");var h={key:"fill_effect_ellipse",frames:r.scene.anims.generateFrameNames("fall_effect",{prefix:"ellipse",end:7,zeroPad:2}),frameRate:10,repeat:0};return r.scene.anims.create(h),r.mEllipse.play("fill_effect_ellipse"),r}return x(EnableDisplay,t),EnableDisplay}(Phaser.GameObjects.Container),D=function(t){function DisableDisplay(i,o){var r=t.call(this,i)||this;return r.mImage=i.make.image({key:o,y:-6,frame:"disable"},!1).setScale(.5),r.add(r.mImage),r.mEllipse=i.make.image({key:o,frame:"forbid"},!1).setScale(.5),r.add([r.mImage,r.mEllipse]),r}return x(DisableDisplay,t),DisableDisplay}(Phaser.GameObjects.Container),L=function(){function FallEffectContainer(t,i){this.scene=t,this.room=i,this.mFalls=[]}return FallEffectContainer.prototype.addFall=function(t,i){if(t){var o=new B(this.scene,this.room.world.scaleRatio);o.once("remove",this.onRemoveHandler,this),o.setPosition(t.x,t.y),this.room.addToSceneUI(o)}},FallEffectContainer.prototype.onRemoveHandler=function(t){},FallEffectContainer}(),A=o(175),j=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),H=function(t){function WallDisplay(i,o){var r=t.call(this,i,0,0,void 0)||this;return r.roomService=o,r}return j(WallDisplay,t),WallDisplay.prototype.loadDisplay=function(t,i){this.scene.textures.exists("wall")?this.onLoadCompleteHandler():(this.scene.load.once(Phaser.Loader.Events.COMPLETE,this.onLoadCompleteHandler,this),this.scene.load.atlas("wall",t,i),this.scene.load.start())},WallDisplay.prototype.setDir=function(t){this.mImage&&(this.mImage.setTexture("wall","wall_"+t+".png"),t===a.LEFT?this.mImage.x=-this.mImage.width/2:t===a.RIGHT&&(this.mImage.x=this.mImage.width/2),this.mImage.y=-this.mImage.height/2+30)},WallDisplay.prototype.load=function(t){},WallDisplay.prototype.changeAlpha=function(t){},WallDisplay.prototype.play=function(t){},WallDisplay.prototype.removeFromParent=function(){this.parentContainer&&this.parentContainer.remove(this)},WallDisplay.prototype.fadeIn=function(t){},WallDisplay.prototype.fadeOut=function(t){},WallDisplay.prototype.showNickname=function(t){},WallDisplay.prototype.setDisplayBadges=function(t){},WallDisplay.prototype.showRefernceArea=function(){},WallDisplay.prototype.hideRefernceArea=function(){},WallDisplay.prototype.showEffect=function(){},WallDisplay.prototype.onLoadCompleteHandler=function(){this.mImage=this.scene.make.image({key:"wall",frame:"wall_up.png"},!1),this.add(this.mImage),this.mImage.y=-this.mImage.height/2+10,this.emit("initialized",this)},Object.defineProperty(WallDisplay.prototype,"sortX",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(WallDisplay.prototype,"sortY",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(WallDisplay.prototype,"sortZ",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(WallDisplay.prototype,"baseLoc",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(WallDisplay.prototype,"element",{get:function(){},enumerable:!1,configurable:!0}),WallDisplay}(Phaser.GameObjects.Container),N=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}();!function(t){t.UP="up",t.LEFT="left",t.RIGHT="right",t.DOWN="down"}(a||(a={}));var U,G,z=function(t){function Wall(i,o,r,a){var h=t.call(this,i)||this;return h.room=i,h.mID=o,h.mDirection=a,h.mPosition=r,h.createDisplay(),h}return N(Wall,t),Wall.prototype.setPosition=function(t){this.mPosition=t,this.mDisplay&&(this.mDisplay.x=t.x,this.mDisplay.y=t.y)},Wall.prototype.createDisplay=function(){if(this.mDisplay)return this.mDisplay;var t=this.room.scene;return t&&(this.mDisplay=new H(t,this.room),this.setPosition(this.mPosition),this.mDisplay.once("initialized",this.onInitializedHandler,this),this.mDisplay.loadDisplay(E.i.getRes("wall/wall.png"),E.i.getRes("wall/wall.json")),this.addToBlock()),this.mDisplay},Wall.prototype.onInitializedHandler=function(){this.mDisplay.setDir(this.mDirection)},Wall.prototype.addDisplay=function(){this.createDisplay(),this.mDisplay&&(this.mRoomService.addToGround(this.mDisplay,0),this.setDepth())},Wall.prototype.setDepth=function(){if(this.mDisplay){if(this.mDisplay.setDepth(this.mDisplay.y),!this.mRoomService)throw new Error("roomService is undefined");var t=this.mRoomService.layerManager;if(!t)throw new Error("layerManager is undefined");t.depthGroundDirty=!0}},Object.defineProperty(Wall.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Wall}(A.a),V=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),W=function(t){function WallManager(i){var o=t.call(this)||this;return o.mRoom=i,o.mWalls=new Map,o}return V(WallManager,t),WallManager.prototype.destroy=function(){this.mRoom.connection&&this.mRoom.connection.removePacketListener(this),this.mWalls.forEach((function(t){return t.destroy()})),this.mWalls.clear()},WallManager.prototype._add=function(t,i,o){var r=this.mRoom.transformTo90(new p.a(t,i));new z(this.mRoom,1e6*t+1e3*i,r,o)},WallManager.prototype.onDawWallHandler=function(t){var i=this.mRoom.world.elementStorage.getTerrainCollection();if(i){var o=this.mRoom.world.getConfig().game_id.split(".");if(!(o.length<2)&&"5e410ba50681ad5557b4d6e9"===o[1])for(var r=i.data,h=0;h<r.length;h++)for(var l=0;l<r[0].length;l++)0!==r[h][l]&&(this.isUp(h,l,r)?this._add(h,l,a.UP):this.isLeft(h,l,r)?this._add(h,l,a.RIGHT):this.isRight(h,l,r)?this._add(h,l,a.LEFT):this.isDown(h,l,r)&&this._add(h,l,a.DOWN))}},WallManager.prototype.isUp=function(t,i,o){return 0===t?0===i||0===o[t][i-1]:0===i?0===t||0===o[t-1][i]:0===o[t-1][i]&&0===o[t][i-1]},WallManager.prototype.isLeft=function(t,i,o){if(0===i){if(t>0)return!0}else if(t>0&&i>0&&0===o[t][i-1])return!0},WallManager.prototype.isRight=function(t,i,o){if(0===t){if(i>0)return!0}else if(i>0&&t>0&&0===o[t-1][i])return!0},WallManager.prototype.isDown=function(t,i,o){if(t>0&&i>0&&0===o[t-1][i-1]&&0!==o[t-1][i]&&0!==o[t][i-1])return!0},WallManager}(l.PacketHandler),K=o(180),q=o(120),Y=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Q=function(){function HandlerDispatcher(){}return HandlerDispatcher.prototype.hasListener=function(t){return!!(this._events&&this._events[t])},HandlerDispatcher.prototype.emitter=function(t,i){if(void 0===i&&(i=null),!this._events||!this._events[t])return!1;var o=this._events[t];if(o.run)o.once&&delete this._events[t],null!=i?o.runWith(i):o.run();else{for(var r=0,a=o.length;r<a;r++){var h=o[r];h&&(null!=i?h.runWith(i):h.run()),h&&!h.once||(o.splice(r,1),r--,a--)}0===o.length&&this._events&&delete this._events[t]}return!0},HandlerDispatcher.prototype.on=function(t,i,o,r){return void 0===r&&(r=null),this._createListener(t,i,o,r,!1)},HandlerDispatcher.prototype.once=function(t,i,o,r){return void 0===r&&(r=null),this._createListener(t,i,o,r,!0)},HandlerDispatcher.prototype.off=function(t,i,o,r){if(void 0===r&&(r=!1),!this._events||!this._events[t])return this;var a=this._events[t];if(null!=o)if(a.run)i&&a.caller!==i||a.method!==o||r&&!a.once||(delete this._events[t],a.recover());else{for(var h=0,l=a.length,c=0,u=a.length;c<u;c++){var p=a[c];!p||i&&p.caller!==i||p.method!==o||r&&!p.once||(h++,a[c]=null,p.recover())}h===l&&delete this._events[t]}return this},HandlerDispatcher.prototype.offAll=function(t){void 0===t&&(t=null);var i=this._events;if(!i)return this;if(t)this._recoverHandlers(i[t]),delete i[t];else{for(var o in i)this._recoverHandlers(i[o]);this._events=null}return this},HandlerDispatcher.prototype.destroy=function(){this.offAll()},HandlerDispatcher.prototype._createListener=function(t,i,o,r,a,h){void 0===h&&(h=!0),h&&this.off(t,i,o,a);var l=X.create(i||this,o,r,a);this._events||(this._events={});var c=this._events;return c[t]?c[t].run?c[t]=[c[t],l]:c[t].push(l):c[t]=l,this},HandlerDispatcher.prototype._recoverHandlers=function(t){if(t)if(t.run)t.recover();else for(var i=t.length-1;i>-1;i--)t[i]&&(t[i].recover(),t[i]=null)},HandlerDispatcher}(),X=function(t){function EventHandler(i,o,r,a){return t.call(this,i,o,r,a)||this}return Y(EventHandler,t),EventHandler.create=function(t,i,o,r){return void 0===o&&(o=null),void 0===r&&(r=!0),EventHandler._mpool.length?EventHandler._mpool.pop().setTo(t,i,o,r):new EventHandler(t,i,o,r)},EventHandler.prototype.recover=function(){this._id>0&&(this._id=0,EventHandler._mpool.push(this.clear()))},EventHandler._mpool=[],EventHandler}(q.a),J=function(){function FollowGroup(){this.groupType=U.Follow,this.eventDisp=new Q,this.childs=[]}return FollowGroup.prototype.addChild=function(t){this.removeChild(t),this.childs.push(t)},FollowGroup.prototype.removeChild=function(t){var i=this.childs.indexOf(t);-1!==i&&this.childs.splice(i,1)},FollowGroup.prototype.replaceOwner=function(t){this.owner=t,this.eventDisp.emitter(G.REPLACE_TYPE,t)},FollowGroup.prototype.emitter=function(t,i){t||(t=G.DEFAULT_TYPE),this.eventDisp.emitter(t,i)},FollowGroup.prototype.on=function(t,i,o,r){this.eventDisp.on(t,i,o,r)},FollowGroup.prototype.off=function(t,i,o){this.eventDisp.off(t,i,o)},FollowGroup.prototype.destroy=function(){this.eventDisp.destroy(),this.childs.length=0,this.owner=null,this.data=null},FollowGroup}(),Z=function(){function GroupManager(t){this.room=t,this.map=new Map}return GroupManager.prototype.createGroup=function(t,i){if(!this.hasGroup(t,i)){var o=this.map.get(t),r=void 0;if(o||(o=[],this.map.set(t,o)),i===U.Follow){var a=new J;a.owner=t,o.push(a),r=a}return r}},GroupManager.prototype.getGroup=function(t,i){var o;if(this.map.has(t))for(var r=0,a=this.map.get(t);r<a.length;r++){var h=a[r];if(h.groupType===i)return o=h}return o},GroupManager.prototype.hasGroup=function(t,i){return!!this.getGroup(t,i)},GroupManager.prototype.destroy=function(){this.map.forEach((function(t,i){for(var o=0,r=t;o<r.length;o++){r[o].destroy()}t.length=0})),this.map.clear()},GroupManager}();!function(t){t[t.Follow=1]="Follow"}(U||(U={})),function(t){t.DEFAULT_TYPE="DEFAULT_TYPE",t.REPLACE_TYPE="REPLACE_TYPE"}(G||(G={}));var $,tt=function(){function FrameManager(){this.handlers=[]}return FrameManager.prototype.add=function(t,i,o){this.remove(t,i);var r=new q.a(t,i,o);this.handlers.push(r)},FrameManager.prototype.remove=function(t,i){for(var o=-1,r=0;r<this.handlers.length;r++){var a=this.handlers[r];if(a.caller===t&&a.method===i){o=r;break}}-1!==o&&this.handlers.splice(o,1)[0].clear()},FrameManager.prototype.update=function(t,i){for(var o=0,r=this.handlers;o<r.length;o++){r[o].runWith([t,i])}},FrameManager.prototype.destroy=function(){for(var t=0,i=this.handlers;t<i.length;t++){i[t].clear()}this.handlers.length=0},FrameManager.prototype.hasRegistered=function(t,i){for(var o=-1,r=0;r<this.handlers.length;r++){var a=this.handlers[r];if(a.caller===t&&a.method===i){o=r;break}}return-1!==o},FrameManager}(),et=o(44),it=function(){function StateParse(){}return StateParse.decode=function(t,i){return this[t]?StateParse[t](i):StateParse.json(i)},StateParse.json=function(t){var i=et.Buffer.from(t),o=i.readUInt32BE(0);try{var r=i.slice(4);if(o===r.length)return JSON.parse(r.toString());u.a.getInstance().error("parse packet error. packet length: "+o+" received length: "+r.length)}catch(t){u.a.getInstance().error(t)}},StateParse.setCameraBounds=function(t){var i=et.Buffer.from(t);if(i){var o=null,r=null,a=i.readDoubleBE(0),h=i.readDoubleBE(8);return i.length>=24&&(o=a,r=h,a=i.readDoubleBE(16),h=i.readDoubleBE(24)),{x:o,y:r,width:a,height:h}}},StateParse}(),nt=(function(){function StateGroup(){this.states=[]}StateGroup.prototype.update=function(t){this.mName=t.owner.name}}(),function(){function State(t){this.mType=t.type,this.mName=t.name,t.packet&&(this.mPacket=it.decode(t.name,t.packet))}return Object.defineProperty(State.prototype,"name",{get:function(){return this.mName},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"type",{get:function(){return this.mType},enumerable:!1,configurable:!0}),Object.defineProperty(State.prototype,"packet",{get:function(){return this.mPacket},enumerable:!1,configurable:!0}),State}()),ot=o(142),rt=o(143),st=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),at=function(t){function Effect(i){var o=t.call(this)||this;return o.mID=i,o}return st(Effect,t),Effect.prototype.syncSprite=function(t){this.mDisplayInfo&&this.mDisplayInfo.destroy();var i=t.display,o=t.animations;if(i&&o){for(var r=[],a=0,h=o;a<h.length;a++){var l=h[a];r.push(new rt.a(l))}this.displayInfo=new ot.a({animations:{defaultAnimationName:t.currentAnimationName,display:i,animationData:r}})}},Effect.prototype.destroy=function(){},Object.defineProperty(Effect.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Effect.prototype,"displayInfo",{get:function(){return this.mDisplayInfo},set:function(t){this.mDisplayInfo=t,this.emit("updateDisplayInfo",t)},enumerable:!1,configurable:!0}),Effect}(Phaser.Events.EventEmitter),ht=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),lt=function(t){function EffectManager(i){var o=t.call(this)||this;return o.room=i,o.mEffects=new Map,o.connection.addPacketListener(o),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE,o.onSyncSprite),o}return ht(EffectManager,t),EffectManager.prototype.add=function(t){var i=new at(t);return this.mEffects.set(t,i),this.updateDisplay(i),i},EffectManager.prototype.remove=function(t){this.mEffects.delete(t)},EffectManager.prototype.get=function(t){var i=this.mEffects.get(t);return i||(i=this.add(t)),i},EffectManager.prototype.destroy=function(){this.mEffects.forEach((function(t){t.destroy()})),this.mEffects.clear(),this.connection.removePacketListener(this)},EffectManager.prototype.updateDisplay=function(t){var i=t.id,o=this.room.world.elementStorage.getDisplayModel(i);o?t.displayInfo=o:this.fetchDisplay([i])},EffectManager.prototype.fetchDisplay=function(t){var i=new l.PBpacket(c.op_virtual_world.OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);i.content.ids=t,this.connection.send(i)},EffectManager.prototype.onSyncSprite=function(t){var i=t.content;if(i.nodeType===c.op_def.NodeType.ElementNodeType)for(var o=null,r=0,a=i.sprites;r<a.length;r++){var h=a[r];(o=this.mEffects.get(h.id))&&o.syncSprite(h)}},Object.defineProperty(EffectManager.prototype,"connection",{get:function(){return this.room.connection},enumerable:!1,configurable:!0}),EffectManager}(l.PacketHandler),ct=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),ut=function(t){function Room(i){var o=t.call(this)||this;return o.manager=i,o.mEnableEdit=!1,o.mWorld=o.manager.world,o.moveStyle=o.mWorld.moveStyle,o.mScaleRatio=o.mWorld.scaleRatio,o.mWorld&&o.connection&&(o.connection.addPacketListener(o),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_EDIT_MODE,o.onEnableEditModeHandler),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_UNWALKABLE_BIT_MAP,o.onShowMapTitle),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE_BY_PATH,o.onMovePathHandler),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_CAMERA_FOLLOW,o.onCameraFollowHandler),o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_STATE,o.onSyncStateHandler)),o}return ct(Room,t),Room.prototype.enter=function(t){var i=this;this.mWorld.getSize();t&&(this.mID=t.id,this.mSize={cols:t.cols,rows:t.rows,tileHeight:t.tileHeight,tileWidth:t.tileWidth,sceneWidth:(t.rows+t.cols)*(t.tileWidth/2),sceneHeight:(t.rows+t.cols)*(t.tileHeight/2)},this.mMiniSize={cols:2*t.cols,rows:2*t.rows,tileWidth:t.tileWidth/2,tileHeight:t.tileHeight/2},this.world.showLoading().then((function(){i.completeLoad()})))},Room.prototype.onFullPacketReceived=function(t){c.op_def.NodeType.TerrainNodeType},Room.prototype.onClockReady=function(){},Room.prototype.startLoad=function(){},Room.prototype.completeLoad=function(){if(this.mWorld.game.scene.getScene(C.a.name)){var t=this.mWorld.game.scene.getScene(k.a.name);t&&t.sleep()}else this.mWorld.game.scene.add(C.a.name,C.a,!0,{room:this})},Room.prototype.startPlay=function(){if(this.mLayManager&&this.layerManager.destroy(),this.mCameraService=new S.a(this),this.mScene=this.world.game.scene.getScene(C.a.name),this.mTerrainManager=new P.a(this,this),this.mElementManager=new h.a(this),this.mPlayerManager=new v(this),this.mWallManager=new W(this),this.mBlocks=new T.a(this.mCameraService),this.mLayManager=new b.a(this),this.mGroupManager=new Z(this),this.mFrameManager=new tt,this.mSkyboxManager=new K.a(this),this.mEffectManager=new lt(this),this.scene){var t=this.scene.cameras.main;this.mCameraService.camera=t;var i=199*this.mScaleRatio;this.mCameraService.setBounds(-i,-i,this.mSize.sceneWidth*this.mScaleRatio+2*i,this.mSize.sceneHeight*this.mScaleRatio+2*i),this.mBlocks.int(this.mSize),this.mWorld.moveStyle!==c.op_def.MoveStyle.DIRECTION_MOVE_STYLE&&(this.mFallEffectContainer=new L(this.mScene,this))}this.mWorld.user.enterScene(this,this.mActorData);var o=this.mWorld.game.scene.getScene(k.a.name);this.world.emitter.on(m.a.PRESS_ELEMENT,this.onPressElementHandler,this),o&&o.sleep(),this.world.changeRoom(this),this.connection&&(this.cameraService.syncCamera(),this.connection.send(new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED))),this.scene.input.on("pointerdown",this.onPointerDownHandler,this),this.scene.input.on("pointerup",this.onPointerUpHandler,this),this.world.emitter.on("Tap",this.onTapHandler,this),this.initSkyBox()},Room.prototype.pause=function(){u.a.getInstance().log("#BlackSceneFromBackground; room.pause(); mScene:"+this.mScene),this.mScene&&this.mScene.scene.pause(),this.mWorld&&this.mWorld.inputManager&&(this.mWorld.inputManager.enable=!1)},Room.prototype.resume=function(t){u.a.getInstance().log("#BlackSceneFromBackground; room.resume(); name:"+t+"; mScene:"+this.mScene),this.mScene&&this.mScene.scene.resume(t),this.mWorld&&this.mWorld.inputManager&&(this.mWorld.inputManager.enable=!0)},Room.prototype.addActor=function(t){this.mActorData=t},Room.prototype.addBlockObject=function(t){this.blocks&&this.blocks.add(t)},Room.prototype.removeBlockObject=function(t){this.blocks&&this.blocks.remove(t)},Room.prototype.updateBlockObject=function(t){this.blocks&&this.blocks.check(t)},Room.prototype.addToGround=function(t,i){this.layerManager.addToGround(t,i)},Room.prototype.addToSurface=function(t){this.layerManager.addToSurface(t)},Room.prototype.addToSceneUI=function(t){this.layerManager.addToSceneToUI(t)},Room.prototype.resize=function(t,i){if(this.mScaleRatio=this.mWorld.scaleRatio,this.layerManager&&this.layerManager.resize(t,i),this.mCameraService){var o=199*this.mScaleRatio;this.mCameraService.setBounds(-o,-o,this.mSize.sceneWidth*this.mScaleRatio+2*o,this.mSize.sceneHeight*this.mScaleRatio+2*o),this.mCameraService.resize(t,i)}this.mSkyboxManager&&this.mSkyboxManager.resize(t,i)},Room.prototype.transformTo90=function(t){if(this.mSize)return w.a.transformTo90(t,this.mSize)},Room.prototype.transformTo45=function(t){if(this.mSize)return w.a.transformTo45(t,this.mSize)},Room.prototype.transformToMini90=function(t){if(this.mMiniSize)return w.a.transformTo90(t,this.miniSize)},Room.prototype.transformToMini45=function(t){if(this.mMiniSize)return w.a.transformTo45(t,this.mMiniSize)},Room.prototype.getElement=function(t){var i=null;return this.mPlayerManager&&(i=this.mPlayerManager.get(t)),!i&&this.mElementManager&&(i=this.elementManager.get(t)),i},Room.prototype.moveable=function(t){var i=this.transformToMini45(t),o=this.mElementManager.map;return!(i.x<0||i.x>o.length||i.y<0||i.y>o[0].length)&&0!==o[i.y][i.x]},Room.prototype.update=function(t,i){this.updateClock(t,i),this.mBlocks.update(t,i),this.layerManager&&this.layerManager.update(t,i),this.elementManager&&this.elementManager.update(t,i),this.mFrameManager&&this.frameManager.update(t,i),this.mWorld.httpClock&&this.mWorld.httpClock.update(t,i);for(var o=0,r=this.elementManager.getElements();o<r.length;o++){r[o].update()}for(var a=0,h=this.mPlayerManager.getElements();a<h.length;a++){h[a].update()}},Room.prototype.updateClock=function(t,i){this.mWorld.clock&&this.mWorld.clock.update(t,i)},Room.prototype.now=function(){return this.mWorld.clock.unixTime},Room.prototype.getMaxScene=function(){if(this.mSize){for(var t=this.mSize.sceneWidth,i=this.mSize.sceneHeight,o=0,r=this.mSkyboxManager.scenery;o<r.length;o++){var a=r[o];a.scenery&&(a.scenery.width>t&&(t=a.scenery.width),a.scenery.height>i&&(i=a.scenery.height))}return{width:t,height:i}}},Room.prototype.setState=function(t){var i;this.mStateMap||(this.mStateMap=new Map);for(var o=0,r=t;o<r.length;o++){var a=r[o];switch(a.execCode){case c.op_def.ExecCode.EXEC_CODE_ADD:case c.op_def.ExecCode.EXEC_CODE_UPDATE:i=new nt(a),this.mStateMap.set(a.name,new nt(a)),this.handlerState(i);break;case c.op_def.ExecCode.EXEC_CODE_DELETE:this.mStateMap.delete(a.name)}}},Room.prototype.initUI=function(){this.world.uiManager&&this.world.uiManager.showMainUI()},Room.prototype.clear=function(){this.mLayManager&&this.mLayManager.destroy(),this.mTerrainManager&&this.mTerrainManager.destroy(),this.mElementManager&&this.mElementManager.destroy(),this.mPlayerManager&&this.mPlayerManager.destroy(),this.mBlocks&&this.mBlocks.destroy(),this.mSkyboxManager&&this.mSkyboxManager.destroy(),this.mWallManager&&this.mWallManager.destroy(),this.mActorData&&(this.mActorData=null),this.mStateMap&&(this.mStateMap=null),this.mCameraService&&this.mCameraService.destroy(),this.mEffectManager&&this.mEffectManager.destroy()},Room.prototype.destroy=function(){this.world.emitter.off("Tap",this.onTapHandler,this),this.connection&&this.connection.removePacketListener(this),this.clear(),u.a.getInstance().log("#BlackSceneFromBackground; remove scene: ",C.a.name),this.mWorld.game.scene.remove(C.a.name),this.world.emitter.off(m.a.PRESS_ELEMENT,this.onPressElementHandler,this)},Room.prototype.initSkyBox=function(){var t=this.world.elementStorage.getScenerys();if(t)for(var i=0,o=t;i<o.length;i++){var r=o[i];this.addSkyBox(r)}},Room.prototype.addSkyBox=function(t){this.mSkyboxManager.add(t)},Room.prototype.onPointerDownHandler=function(t){this.addPointerMoveHandler()},Room.prototype.onPointerUpHandler=function(t){this.removePointerMoveHandler()},Room.prototype.addPointerMoveHandler=function(){this.mScene.input.on("pointermove",this.onPointerMoveHandler,this),this.mScene.input.on("gameout",this.onGameOutHandler,this)},Room.prototype.removePointerMoveHandler=function(){this.mScene.input.off("pointermove",this.onPointerMoveHandler,this),this.mScene.input.off("gameout",this.onGameOutHandler,this),this.cameraService.moving&&(this.cameraService.syncCameraScroll(),this.cameraService.moving=!1)},Room.prototype.onPointerMoveHandler=function(t){this.mCameraService.targetFollow||this.cameraService.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},Room.prototype.onGameOutHandler=function(){this.removePointerMoveHandler()},Room.prototype.handlerState=function(t){switch(t.name){case"skyBoxAnimation":this.mSkyboxManager.setState(t);break;case"setCameraBounds":if(this.mCameraService){var i=t.packet;if(!i||!i.width||!i.height)return void u.a.getInstance().log("setCameraBounds error",i);var o=i.x,r=i.y,a=i.width,h=i.height;null!==o&&null!==r||(o=.5*(this.mSize.sceneWidth-a),r=.5*(this.mSize.sceneHeight-h)),o*=this.mScaleRatio,r*=this.mScaleRatio,a*=this.mScaleRatio,h*=this.mScaleRatio,this.mCameraService.setBounds(o,r,a,h)}}},Object.defineProperty(Room.prototype,"scene",{get:function(){return this.mScene||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"terrainManager",{get:function(){return this.mTerrainManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"elementManager",{get:function(){return this.mElementManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"playerManager",{get:function(){return this.mPlayerManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"layerManager",{get:function(){return this.mLayManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"groupManager",{get:function(){return this.mGroupManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"frameManager",{get:function(){return this.mFrameManager||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"cameraService",{get:function(){return this.mCameraService||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"effectManager",{get:function(){return this.mEffectManager},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"id",{get:function(){return this.mID},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"roomSize",{get:function(){return this.mSize||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"miniSize",{get:function(){return this.mMiniSize},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"blocks",{get:function(){return this.mBlocks},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"world",{get:function(){return this.mWorld},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"enableEdit",{get:function(){return this.mEnableEdit},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"connection",{get:function(){if(this.manager)return this.manager.connection},enumerable:!1,configurable:!0}),Object.defineProperty(Room.prototype,"sceneType",{get:function(){return c.op_def.SceneTypeEnum.NORMAL_SCENE_TYPE},enumerable:!1,configurable:!0}),Room.prototype.onPressElementHandler=function(t,i){if(i&&i.parentContainer){var o=i.parentContainer;if(o instanceof I.b)if(o.element instanceof O.b&&this.mEnableEdit){var r=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);this.connection.send(r)}}},Room.prototype.onEnableEditModeHandler=function(t){this.mEnableEdit=!0},Room.prototype.onShowMapTitle=function(t){if(this.scene){for(var i=t.content,o=new M.a(this.scene,this),r=[],a=i.intArray,h=0;h<a.length;h++){r[h]=[];for(var l=0;l<a[h].value.length;l++)r[h][l]=a[h].value[l]}o.draw(r,new Phaser.Geom.Point(0,0)),o.setAlpha(.1),o.size&&(o.setPosition(o.size.sceneWidth/2,0),this.mLayManager.addToMiddle(o))}},Room.prototype.addFillEffect=function(t,i){if(this.scene){var o=new B(this.scene,this.mScaleRatio);o.show(i),o.setPosition(t.x*this.mScaleRatio,t.y*this.mScaleRatio),this.addToSceneUI(o)}else u.a.getInstance().log("Room scene  does not exist")},Room.prototype.onMovePathHandler=function(t){var i=t.content,o=i.pathStatus;if(o){var r=i.targetPos;this.addFillEffect({x:r.x,y:r.y},o)}},Room.prototype.onCameraFollowHandler=function(t){var i=this;if(this.mCameraService){var o=t.content,r=this.getElement(o.id);if(r)if("liner"===o.effect){var a=r.getPosition();this.mCameraService.pan(a.x,a.y,300).then((function(){i.mCameraService.startFollow(r)}))}else this.mCameraService.startFollow(r);else this.mCameraService.stopFollow()}},Room.prototype.onSyncStateHandler=function(t){for(var i=0,o=t.content.stateGroup;i<o.length;i++){var r=o[i];switch(r.owner.type){case c.op_def.NodeType.SceneNodeType:this.setState(r.state);break;case c.op_def.NodeType.ElementNodeType:this.elementManager.setState(r)}}},Room.prototype.move=function(t,i,o){if(this.moveStyle===c.op_def.MoveStyle.PATH_MOVE_STYLE&&this.mPlayerManager){var r=this.mPlayerManager.actor;if(r){var a=r.getPosition45(),h=this.transformTo45(new p.a(t,i));if(Math.abs(a.x-h.x)>20||Math.abs(a.y-h.y)>20)this.addFillEffect({x:t,y:i},c.op_def.PathReachableStatus.PATH_UNREACHABLE_AREA);else{var u=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOVE_TO_TARGET_BY_PATH),d=u.content;if(o){var m=o.parentContainer.parentContainer||o.parentContainer;if(m&&m instanceof I.b){var y=m.element;y&&y.model&&(d.id=y.model.id,d.nodeType=y.model.nodeType)}}d.point3f={x:t,y:i},this.connection.send(u),this.tryMove()}}}},Room.prototype.tryMove=function(){var t=this.mPlayerManager.actor;if(t){var i=t.moveData,o=i.posPath;if(o&&!(o.length<0)){var r=i.step||0;if(!(r>=o.length)){var a=t.getPosition(),h=c.op_def.PBPoint3f.create();h.x=a.x,h.y=a.y,void 0===o[r]&&u.a.getInstance().log("move error",o,r);var p=c.op_def.PBPoint3f.create();p.x=o[r].x,p.y=o[r].y;var d=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CHECK_MOVE_PATH_NEXT_POINT),m=d.content;m.timestemp=this.now(),m.position=h,m.nextPoint=p,this.connection.send(d)}}}},Room.prototype.onTapHandler=function(t,i){this.move(t.worldX/this.mScaleRatio,t.worldY/this.mScaleRatio,i)},Room.prototype.enterRoom=function(){this.mWorld.game.scene.run(C.a.name,{room:this})},Room}(l.PacketHandler);!function(t){t.MOVE="move",t.BRUSH="brush",t.SELECT="select",t.ERASER="eraser",t.FILL="FILL"}($||($={}));var pt=function(){function Brush(t){this.mEditorRoom=t,this.mMode=$.SELECT}return Object.defineProperty(Brush.prototype,"mode",{get:function(){return this.mMode},set:function(t){this.mMode=t},enumerable:!1,configurable:!0}),Brush}(),dt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),mt=function(t){function EditScene(){return t.call(this,{key:EditScene.name})||this}return dt(EditScene,t),EditScene.prototype.create=function(){this.mRoom.startPlay()},EditScene}(C.a),ft=o(141),yt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),gt=c.op_def.NodeType,_t=function(){function MouseFollow(t,i){this.mScene=t,this.mRoomService=i,this.mScaleRatio=1,this.mSize=1,this.mLayerManager=this.mRoomService.layerManager,this.mScaleRatio=this.mRoomService.world.scaleRatio}return MouseFollow.prototype.setDisplay=function(t){if(this.mScene){this.mDisplay&&(this.mDisplay.destroy(),this.mDisplay=null),this.mNodeType=t.nodeType,this.isMoss=t.isMoss,this.key=t.key,this.mSprite=new d.a(t.sprite,t.nodeType),this.mDisplay=new vt(this.mScene,this.mRoomService);var i=this.mNodeType===gt.TerrainNodeType?this.mSize:1;this.mDisplay.setDisplay(this.mSprite,i),this.mDisplay.scale=this.mScaleRatio,this.mLayerManager.addToSceneToUI(this.mDisplay),this.mNodeType===gt.TerrainNodeType?this.mElementManager=this.mRoomService.terrainManager:this.mNodeType!==gt.ElementNodeType&&this.mNodeType!==gt.SpawnPointType||(this.mElementManager=this.mRoomService.elementManager),this.mScene.input.on("pointermove",this.onPointerMoveHandler,this),this.mScene.input.on("wheel",this.onWheelHandler,this)}},MouseFollow.prototype.showEraserArea=function(){this.mScene&&(this.mDisplay&&this.mDisplay.destroy(),this.mDisplay=new bt(this.mScene,this.mRoomService),this.mDisplay.setDisplay(null,this.mSize),this.mNodeType=gt.TerrainNodeType,this.mLayerManager.addToSceneToUI(this.mDisplay),this.mScene.input.on("pointermove",this.onPointerMoveHandler,this),this.mScene.input.on("wheel",this.onWheelHandler,this))},MouseFollow.prototype.createTerrainsOrMossesData=function(){var t=this;return{locs:this.mDisplay.displays.map((function(i){return t.getPosition(i.x,i.y)})),key:this.key}},MouseFollow.prototype.createSprites=function(){if(this.mSprite){for(var t=[],i=null,o=0,r=this.mDisplay.displays;o<r.length;o++){var a=r[o];(i=Object.assign(Object.create(Object.getPrototypeOf(this.mSprite)),this.mSprite)).newID(),i.pos=this.getPosition(a.x,a.y),i.bindID=this.mSprite.id,i.sn=this.mSprite.sn,t.push(i)}return t}},MouseFollow.prototype.getEaserPosition=function(){var t=[];if(this.display){for(var i=null,o=0;o<this.mSize;o++)for(var r=0;r<this.mSize;r++)i=this.display.transformTo90(o,r),t.push(this.getPosition(i.x,i.y));return t}},MouseFollow.prototype.transitionGrid=function(t,i){var o=new p.a(t,i),r=this.mNodeType===c.op_def.NodeType.TerrainNodeType?this.mRoomService.transformTo45(o):this.mRoomService.transformToMini45(o);return!1===this.mAlignGrid?this.checkBound(r,o):this.checkBound(r)},MouseFollow.prototype.checkBound=function(t,i){var o=new p.a(t.x,t.y),r=this.mNodeType===c.op_def.NodeType.TerrainNodeType?this.mRoomService.roomSize:this.mRoomService.miniSize;return t.x<0?o.x=0:t.x>r.cols&&(o.x=r.cols),t.y<0?o.y=0:t.y>r.rows&&(o.y=r.rows),o.equal(t)&&i?i:this.mNodeType===c.op_def.NodeType.TerrainNodeType?this.mRoomService.transformTo90(o):this.mRoomService.transformToMini90(o)},MouseFollow.prototype.destroy=function(){this.mScene&&(this.mScene.input.off("pointermove",this.onPointerMoveHandler,this),this.mScene.input.off("wheel",this.onWheelHandler,this)),this.mDisplay&&(this.mDisplay.destroy(),this.mDisplay=null),this.mNodeType=gt.UnknownNodeType},MouseFollow.prototype.onPointerMoveHandler=function(t){this.updatePos(t.worldX/this.mScaleRatio,t.worldY/this.mScaleRatio)},MouseFollow.prototype.getPosition=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),this.mNodeType===c.op_def.NodeType.TerrainNodeType?this.mRoomService.transformTo45(new p.a(this.mDisplay.x/this.mScaleRatio+t,this.mDisplay.y/this.mScaleRatio+i)):new p.a(this.mDisplay.x/this.mScaleRatio+t,this.mDisplay.y/this.mScaleRatio+i,this.mDisplay.z)},MouseFollow.prototype.onWheelHandler=function(t){this.mNodeType===gt.TerrainNodeType&&(t.deltaY<0?this.size--:this.size++,this.updatePos(t.worldX/this.mScaleRatio,t.worldY/this.mScaleRatio))},MouseFollow.prototype.updatePos=function(t,i){if(this.mDisplay){var o=this.transitionGrid(t,i);o&&this.mDisplay.setLocation(o.x*this.mScaleRatio,o.y*this.mScaleRatio)}},Object.defineProperty(MouseFollow.prototype,"alignGrid",{set:function(t){this.mAlignGrid=t},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"display",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"sprite",{get:function(){return this.mSprite},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"nodeType",{get:function(){return this.mNodeType},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"elementManager",{get:function(){return this.mElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"size",{get:function(){return this.mSize},set:function(t){t<1&&(t=1),t>20&&(t=20),this.mSize=t,this.mDisplay.setDisplay(this.mSprite,this.mSize)},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"isMoss",{get:function(){return this._isMoss},set:function(t){this._isMoss=t},enumerable:!1,configurable:!0}),Object.defineProperty(MouseFollow.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t},enumerable:!1,configurable:!0}),MouseFollow}(),vt=function(t){function MouseDisplayContainer(i,o){var r=t.call(this,i)||this;return r.mRoomService=o,r.mScaleRatio=1,r.mScaleRatio=r.mRoomService.world.scaleRatio,r.mOffset=new Phaser.Geom.Point,r}return yt(MouseDisplayContainer,t),MouseDisplayContainer.prototype.setDisplay=function(t,i){if(this.clear(),this.mDisplay=[],this.mSprite=t,t){var o,r=t.displayInfo;this.mNodeType=t.nodeType;var a=this.mRoomService.roomSize,h=a.tileWidth,l=a.tileHeight;this.mTileSize={tileWidth:h,tileHeight:l,rows:i,cols:i,sceneWidth:(i+i)*(h/2),sceneHeight:(i+i)*(l/2)},this.mOffset.x=-this.mTileSize.sceneWidth/2*this.mScaleRatio,this.mOffset.y=-(this.mTileSize.sceneHeight/this.mScaleRatio-(i%2==0?0:l))/2;for(var c=0;c<i;c++)for(var u=0;u<i;u++){(o=new ft.a(this.scene,this.mRoomService)).setAlpha(.8),o.once("initialized",this.onInitializedHandler,this),o.load(r);var d=w.a.transformTo90(new p.a(c,u),this.mTileSize);o.x=d.x,o.y=d.y,this.add(o),this.mDisplay.push(o)}}},MouseDisplayContainer.prototype.transformTo90=function(t,i){return w.a.transformTo90(new p.a(t,i),this.mTileSize)},MouseDisplayContainer.prototype.transformTo45=function(t,i){return w.a.transformTo45(new p.a(t,i),this.mTileSize)},MouseDisplayContainer.prototype.setLocation=function(t,i){return this.x=t+this.mOffset.x,this.y=i+this.mOffset.y,this},MouseDisplayContainer.prototype.clear=function(){this.removeAll(!0),this.mDisplay=void 0},MouseDisplayContainer.prototype.destroy=function(i){this.clear(),t.prototype.destroy.call(this,i)},Object.defineProperty(MouseDisplayContainer.prototype,"displays",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),Object.defineProperty(MouseDisplayContainer.prototype,"tileWidth",{get:function(){var t=this.mTileSize.tileHeight;return this.mTileSize.rows%2==0&&(t=0),this.mTileSize.sceneWidth-t},enumerable:!1,configurable:!0}),Object.defineProperty(MouseDisplayContainer.prototype,"tileHeight",{get:function(){return this.mTileSize.sceneHeight},enumerable:!1,configurable:!0}),MouseDisplayContainer.prototype.onInitializedHandler=function(t){t&&(this.mSprite&&t.play(this.mSprite.currentAnimation),this.mNodeType!==c.op_def.NodeType.TerrainNodeType&&t.showRefernceArea())},MouseDisplayContainer}(Phaser.GameObjects.Container),bt=function(t){function EraserArea(i,o){return t.call(this,i,o)||this}return yt(EraserArea,t),EraserArea.prototype.setDisplay=function(t,i){this.area&&this.area.clear();var o,r,a,h,l=this.mRoomService.roomSize,c=l.tileWidth,u=l.tileHeight;this.mTileSize={tileWidth:c,tileHeight:u,rows:i,cols:i,sceneWidth:(i+i)*(c/2),sceneHeight:(i+i)*(u/2)},this.mOffset.x=-this.mTileSize.sceneWidth/2,this.mOffset.y=-(this.mTileSize.sceneHeight-(i%2==0?0:u))/2,this.area=this.scene.make.graphics(void 0,!1);for(var d=0;d<i;d++)for(var m=0;m<i;m++)this.area.lineStyle(2,0),o=w.a.transformTo90(new p.a(m,d),this.mTileSize),r=w.a.transformTo90(new p.a(m+1,d),this.mTileSize),a=w.a.transformTo90(new p.a(m+1,d+1),this.mTileSize),h=w.a.transformTo90(new p.a(m,d+1),this.mTileSize),this.area.beginPath(),this.area.fillStyle(0,.5),this.area.strokePoints([o.toPoint(),r.toPoint(),a.toPoint(),h.toPoint()],!0,!0),this.area.fillPath();this.add(this.area)},EraserArea}(vt),Pt=o(178),wt=o(116),St=function(){function SelectedElement(t,i){this.mScene=t,this.mLayerManager=i,this.mDisplayHeight=0,this.mEffecte=new wt.DynamicImage(this.mScene,0,0),this.mEffecte.load(E.i.getRes("ui/editor/selectFlag.png"))}return SelectedElement.prototype.setElement=function(t){this.mDisplay&&(this.mDisplay.hideRefernceArea(),this.mDisplay.element&&this.mDisplay.element.hideNickname(),this.mSprite=void 0),this.mDisplay=t,t.showRefernceArea(),this.mDisplayHeight=this.mDisplay.spriteHeight;var i=t.element;i&&(i.showNickname(),this.mSprite=i.model),this.mLayerManager.addToSceneToUI(this.mEffecte),this.mSelecting=!0,this.update()},SelectedElement.prototype.remove=function(){this.mSelecting=!1,this.mEffecte&&(this.mEffecte.parentContainer&&this.mEffecte.parentContainer.remove(this.mEffecte),this.mDisplay&&(this.mDisplay.parentContainer&&this.mDisplay.hideRefernceArea(),this.mDisplay=null,this.mSprite=void 0))},SelectedElement.prototype.update=function(){if(this.mDisplay){this.mEffecte.x=this.mDisplay.x,this.mEffecte.y=this.mDisplay.y-(this.mDisplayHeight>>1);var t=this.mDisplay.element;t&&t.update()}},SelectedElement.prototype.setDisplayPos=function(t,i){if(this.mDisplay&&(this.mDisplay.x=t,this.mDisplay.y=i,this.mSprite)){var o=this.mSprite.pos;o&&(o.x=t,o.y=i)}},SelectedElement.prototype.destroy=function(){this.mEffecte&&(this.remove(),this.mEffecte.destroy(),this.mEffecte=null)},Object.defineProperty(SelectedElement.prototype,"display",{get:function(){return this.mDisplay},enumerable:!1,configurable:!0}),Object.defineProperty(SelectedElement.prototype,"selecting",{get:function(){return this.mSelecting},set:function(t){this.mSelecting=t},enumerable:!1,configurable:!0}),Object.defineProperty(SelectedElement.prototype,"sprite",{get:function(){return this.mSprite},enumerable:!1,configurable:!0}),SelectedElement}(),Ct=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Tt=c.op_def.NodeType,kt=function(t){function EditorElementManager(i){var o=t.call(this,i)||this;return o.mRoom=i,o.taskQueue=new Map,o.connection&&(o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_CREATE_SPRITE,o.handleCreateElements),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITE,o.handleDeleteElements),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_SPRITE,o.handleSyncElements)),o}return Ct(EditorElementManager,t),EditorElementManager.prototype.update=function(){this.batchActionSprites()},EditorElementManager.prototype.addElements=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i];this.taskQueue.set(r.id,{action:"ADD",sprite:r})}this.callEditorCreateElementData(t)},EditorElementManager.prototype.callEditorCreateElementData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_SPRITE),o=i.content;o.nodeType=t[0].nodeType,o.sprites=t.map((function(t){return t.toSprite()})),this.connection.send(i),u.a.getInstance().log("add sprites: ",o)},EditorElementManager.prototype.updateElements=function(t){this.callEditorUpdateElementData(t)},EditorElementManager.prototype.callEditorUpdateElementData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_SPRITE);i.content.sprites=t,this.connection.send(i)},EditorElementManager.prototype.deleteElements=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i];this.taskQueue.set(r,{action:"DELETE",sprite:{id:r}})}this.callEditorDeleteElementData(t)},EditorElementManager.prototype.callEditorDeleteElementData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_SPRITE),o=i.content;o.ids=t,o.nodeType=c.op_def.NodeType.ElementNodeType,this.connection.send(i)},EditorElementManager.prototype.handleCreateElements=function(t){if(this.mRoom.layerManager)for(var i=t.content,o=i.sprites,r=(i.nodeType,0),a=o;r<a.length;r++){var h=a[r];this.taskQueue.set(h.id,{action:"ADD",sprite:new d.a(h)})}else u.a.getInstance().error("layer manager does not exist")},EditorElementManager.prototype.handleDeleteElements=function(t){var i=t.content,o=i.ids,r=i.nodeType;if(r===Tt.ElementNodeType||r===Tt.SpawnPointType){for(var a=0,h=o;a<h.length;a++){var l=h[a];this.taskQueue.set(l,{action:"DELETE",sprite:{id:l}})}this.roomService.removeSelected()}},EditorElementManager.prototype.handleSyncElements=function(t){var i=t.content,o=i.sprites;if(i.nodeType===c.op_def.NodeType.ElementNodeType)for(var r=0,a=o;r<a.length;r++){var h=a[r];this.taskQueue.set(h.id,{action:"UPDATE",sprite:new d.a(h)})}},EditorElementManager.prototype.batchActionSprites=function(){if(Array.from(this.taskQueue.keys()).length)for(var t=0,i=Array.from(this.taskQueue.keys()).splice(0,200);t<i.length;t++){var o=i[t],r=this.taskQueue.get(o),a=r.action,h=r.sprite;this.taskQueue.delete(o),"ADD"===a?this.mRoom.displayObjectPool.push("elements",h.id.toString(),h,this):"DELETE"===a?this.mRoom.displayObjectPool.remove("elements",h.id.toString()):"UPDATE"===a&&this.mRoom.displayObjectPool.update("elements",h.id.toString(),h)}},Object.defineProperty(EditorElementManager.prototype,"roomService",{get:function(){return this.mRoom},enumerable:!1,configurable:!0}),EditorElementManager}(h.a),Ot=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),__assign=function(){return(__assign=Object.assign||function(t){for(var i,o=1,r=arguments.length;o<r;o++)for(var a in i=arguments[o])Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a]);return t}).apply(this,arguments)},It=function(t){function EditorTerrainManager(i,o){var r=t.call(this,i,o)||this;return r.mRoom=i,r.taskQueue=new Map,r.mEditorTerrains=new Map,r.connection&&(r.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_ADD_SPRITES_WITH_LOCS,r.handleAddTerrains),r.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITES_WITH_LOCS,r.handleDeleteTerrains)),r}return Ot(EditorTerrainManager,t),EditorTerrainManager.prototype.addTerrains=function(t){for(var i=this,o=t.locs,r=t.key,a=o.filter((function(t){return i.canPut(t,r)})),h=0,l=a;h<l.length;h++){var c=l[h],u=this.genLocId(c.x,c.y),p=this.mEditorTerrains.get(u);p&&p!==r?this.taskQueue.set(u,{action:"UPDATE",loc:__assign(__assign({},c),{key:r})}):this.taskQueue.set(u,{action:"ADD",loc:__assign(__assign({},c),{key:r})})}this.reqEditorAddTerrainsData(a,r)},EditorTerrainManager.prototype.reqEditorAddTerrainsData=function(t,i){var o=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_ADD_TERRAINS),r=o.content;r.locs=t,r.key=i,this.connection.send(o)},EditorTerrainManager.prototype.removeTerrains=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i],a=this.genLocId(r.x,r.y);this.taskQueue.set(a,{action:"DELETE",loc:{x:r.x,y:r.y}})}this.reqEditorDeleteTerrainsData(t)},EditorTerrainManager.prototype.reqEditorDeleteTerrainsData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_TERRAINS);i.content.locs=t.map((function(t){return{x:t.x,y:t.y,z:t.z}})),this.connection.send(i)},EditorTerrainManager.prototype.update=function(){this.batchActionSprites()},EditorTerrainManager.prototype.handleAddTerrains=function(t){if(this.mRoom.layerManager){var i=t.content,o=i.locs;if(i.nodeType===c.op_def.NodeType.TerrainNodeType)for(var r=0,a=o;r<a.length;r++){var h=a[r],l=this.genLocId(h.x,h.y),p=this.mEditorTerrains.get(l);p&&p===h.key||this.taskQueue.set(l,{action:"ADD",loc:h})}}else u.a.getInstance().error("layer manager does not exist")},EditorTerrainManager.prototype.handleDeleteTerrains=function(t){if(this.mRoom.layerManager){var i=t.content,o=i.locs;if(i.nodeType===c.op_def.NodeType.TerrainNodeType)for(var r=0,a=o;r<a.length;r++){var h=a[r],l=this.genLocId(h.x,h.y);this.taskQueue.set(l,{action:"DELETE",loc:h})}}else u.a.getInstance().error("layer manager does not exist")},EditorTerrainManager.prototype.canPut=function(t,i){var o=this.genLocId(t.x,t.y),r=this.roomService.roomSize;return!!r&&(!(t.x<0||t.y<0||t.x>=r.cols||t.y>=r.rows)&&this.mEditorTerrains.get(o)!==i)},EditorTerrainManager.prototype.batchActionSprites=function(){if(Array.from(this.taskQueue.keys()).length)for(var t=0,i=Array.from(this.taskQueue.keys()).splice(0,200);t<i.length;t++){var o=i[t],r=this.taskQueue.get(o),a=r.action,h=r.loc,l=this.genLocId(h.x,h.y);if(this.taskQueue.delete(o),"ADD"===a){if(!(p=this.mRoom.world.elementStorage.getTerrainPalette(h.key)))continue;var u=p.createSprite({nodeType:c.op_def.NodeType.TerrainNodeType,x:h.x,y:h.y});this.mEditorTerrains.set(l,h.key),this.mRoom.displayObjectPool.push("terrains",l,u,this)}else if("DELETE"===a)this.mEditorTerrains.delete(l),this.mRoom.displayObjectPool.remove("terrains",l);else if("UPDATE"===a){var p;if(!(p=this.mRoom.world.elementStorage.getTerrainPalette(h.key)))continue;u=p.createSprite({nodeType:c.op_def.NodeType.TerrainNodeType,x:h.x,y:h.y});this.mEditorTerrains.set(l,h.key),this.mRoom.displayObjectPool.update("terrains",l,u)}}},EditorTerrainManager.prototype.genLocId=function(t,i){return t+"_"+i},EditorTerrainManager}(P.a),Mt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Et=function(t){function EditorCamerasManager(){return null!==t&&t.apply(this,arguments)||this}return Mt(EditorCamerasManager,t),EditorCamerasManager.prototype.centerCameas=function(){if(this.mMain&&this.mRoomService){var t=this.mRoomService.roomSize;this.mMain.setScroll(t.sceneWidth-this.mMain.width>>1,t.sceneHeight-this.mMain.height>>1);this.mMain.worldView;var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA),o=i.content;o.x=this.mMain.scrollX,o.y=this.mMain.scrollY,o.width=this.mMain.width,o.height=this.mMain.height,this.connection.send(i)}},EditorCamerasManager.prototype.offsetScroll=function(t,i){if(this.mMain)for(var o=0,r=this.mCameras;o<r.length;o++){var a=r[o];a.scrollX+=t/this.zoom,a.scrollY+=i/this.zoom}},EditorCamerasManager.prototype.syncCameraScroll=function(){var t=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA),i=t.content;i.x=this.mMain.scrollX/this.zoom,i.y=this.mMain.scrollY/this.zoom,i.width=0,i.height=0,this.connection.send(t)},EditorCamerasManager}(S.a),xt=o(155),Bt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),editor_moss_manager_assign=function(){return(editor_moss_manager_assign=Object.assign||function(t){for(var i,o=1,r=arguments.length;o<r;o++)for(var a in i=arguments[o])Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a]);return t}).apply(this,arguments)},Rt=function(t){function EditorMossManager(i){var o=t.call(this,i)||this;return o.mRoom=i,o.taskQueue=new Map,o.editorMosses=new Map,o.connection&&(o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_ADD_MOSSES,o.handleAddMosses),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_MOSSES,o.handleDeleteMosses),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_MOSSES,o.handleUpdateMosses)),o}return Bt(EditorMossManager,t),EditorMossManager.prototype.update=function(){this.batchActionSprites()},EditorMossManager.prototype.addMosses=function(t){for(var i=[],o=t.locs,r=t.key,a=0,h=o;a<h.length;a++){var l=h[a],c=xt.a.genId(),u={x:l.x,y:l.y,z:l.z,key:r,id:c};this.taskQueue.set(c,{action:"ADD",loc:u}),i.push(u)}this.reqEditorCreateMossData(i)},EditorMossManager.prototype.reqEditorCreateMossData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_MOSSES);i.content.locs=t,this.connection.send(i)},EditorMossManager.prototype.updateMosses=function(t){for(var i=[],o=0,r=t;o<r.length;o++){var a=r[o].display.element.model.toSprite(),h=this.editorMosses.get(a.id),l={x:a.point3f.x,y:a.point3f.y,z:a.point3f.z,id:a.id,dir:a.direction,key:h.key};this.taskQueue.set(a.id,{action:"UPDATE",loc:l}),i.push(l)}this.reqEditorUpdateMossData(i)},EditorMossManager.prototype.reqEditorUpdateMossData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_MOSSES);i.content.locs=t,this.connection.send(i)},EditorMossManager.prototype.deleteMosses=function(t){for(var i=[],o=0,r=t;o<r.length;o++){var a=r[o],h=this.editorMosses.get(a);i.push(h),this.taskQueue.set(a,{action:"DELETE",loc:h})}this.reqEditorDeleteMossData(i)},EditorMossManager.prototype.reqEditorDeleteMossData=function(t){var i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_MOSSES);i.content.locs=t,this.connection.send(i)},EditorMossManager.prototype.handleAddMosses=function(t){for(var i=0,o=t.content.locs;i<o.length;i++){var r=o[i];this.taskQueue.set(r.id,{action:"ADD",loc:r})}},EditorMossManager.prototype.handleDeleteMosses=function(t){for(var i=0,o=t.content.ids;i<o.length;i++){var r=o[i];this.taskQueue.set(r,{action:"DELETE",loc:this.editorMosses.get(r)})}this.roomService.removeSelected()},EditorMossManager.prototype.handleUpdateMosses=function(t){for(var i=0,o=t.content.locs;i<o.length;i++){var r=o[i];this.taskQueue.set(r.id,{action:"UPDATE",loc:r})}},EditorMossManager.prototype.batchActionSprites=function(){if(Array.from(this.taskQueue.keys()).length)for(var t=0,i=Array.from(this.taskQueue.keys()).splice(0,200);t<i.length;t++){var o=i[t],r=this.taskQueue.get(o),a=r.action,h=r.loc;if(this.taskQueue.delete(o),"ADD"===a){if(!(u=this.mRoom.world.elementStorage.getMossPalette(h.key)))continue;var l=u.createSprite(editor_moss_manager_assign(editor_moss_manager_assign({},h),{nodeType:c.op_def.NodeType.ElementNodeType,isMoss:!0}));this.editorMosses.set(h.id,h),this.mRoom.displayObjectPool.push("mosses",h.id.toString(),l,this)}else if("DELETE"===a)h&&(this.editorMosses.delete(h.id),this.mRoom.displayObjectPool.remove("mosses",h.id.toString()));else if("UPDATE"===a){var u;if(!(u=this.mRoom.world.elementStorage.getMossPalette(h.key)))continue;l=u.createSprite(editor_moss_manager_assign(editor_moss_manager_assign({},h),{nodeType:c.op_def.NodeType.ElementNodeType,isMoss:!0}));this.editorMosses.set(h.id,h),this.mRoom.displayObjectPool.update("mosses",h.id.toString(),l)}}},Object.defineProperty(EditorMossManager.prototype,"roomService",{get:function(){return this.mRoom},enumerable:!1,configurable:!0}),EditorMossManager}(h.a),Dt=o(340),Lt=function(){function DisplayObjectPool(){this.terrains=new Map,this.mosses=new Map,this.elements=new Map,this.POOLOBJECTCONFIG={terrains:Dt.a,mosses:O.b,elements:O.b}}return DisplayObjectPool.prototype.getPool=function(t){return this[t]},DisplayObjectPool.prototype.push=function(t,i,o,r){var a=this[t],h=new this.POOLOBJECTCONFIG[t](o,r);h.setBlockable(!1),h.setRenderable(!0),h instanceof O.b&&h.setInputEnable(O.c.Enable),a.set(i,h)},DisplayObjectPool.prototype.remove=function(t,i){var o=this[t].get(i);o&&(o.isUsed=!1,o.destroy()),this[t].delete(i)},DisplayObjectPool.prototype.update=function(t,i,o){var r=this[t].get(i);r&&(r.isUsed=!0,r.setModel(o))},DisplayObjectPool.prototype.destroy=function(){for(var t=0,i=Object.keys(this.POOLOBJECTCONFIG);t<i.length;t++){this[i[t]].clear()}},DisplayObjectPool}(),At=o(342),Ft=o(393),jt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Ht=function(t){function EditorBlockManager(i,o){return t.call(this,i,o)||this}return jt(EditorBlockManager,t),EditorBlockManager.prototype.move=function(){},EditorBlockManager}(Ft.a),Nt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),Ut=function(t){function EditorSkyBoxManager(i){var o=t.call(this,i)||this,r=i.connection;return r&&(r.addPacketListener(o),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_ADD_SCENERY,o.onAddSceneryHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_UPDATE_SCENERY,o.onUpdateSceneryHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SCENERY,o.onDeleteSceneryHandler)),o}return Nt(EditorSkyBoxManager,t),EditorSkyBoxManager.prototype.add=function(t){this.mScenetys.set(t.id,new Ht(t,this.mRoom))},EditorSkyBoxManager.prototype.fetch=function(t){this.mScenetys&&(this.mSelected=this.mScenetys.get(t))},EditorSkyBoxManager.prototype.move=function(t){if(this.selected){var i=this.mSelected.scenery;if(i){var o=i.offset;o.x+=(t.x-t.prevPosition.x)/this.mRoom.world.scaleRatio,o.y+=(t.y-t.prevPosition.y)/this.mRoom.world.scaleRatio,this.mSelected.updatePosition(),this.onSyncSceneryOffset()}}},EditorSkyBoxManager.prototype.keyboardMove=function(t){if(this.mSelected){var i=this.mSelected.scenery;if(i){var o=i.offset;switch(t){case 37:case 65:o.x--;break;case 38:case 87:o.y--;break;case 39:case 68:o.x++;break;case 40:case 83:o.y++}this.mSelected.updatePosition(),this.onSyncSceneryOffset()}}},EditorSkyBoxManager.prototype.removeSelect=function(){this.mSelected&&(this.mSelected=void 0)},EditorSkyBoxManager.prototype.onAddSceneryHandler=function(t){var i=t.content;this.add(new At.b(i))},EditorSkyBoxManager.prototype.onUpdateSceneryHandler=function(t){var i=t.content;this.update(new At.b(i))},EditorSkyBoxManager.prototype.onDeleteSceneryHandler=function(t){for(var i=0,o=t.content.ids;i<o.length;i++){var r=o[i];this.remove(r)}},EditorSkyBoxManager.prototype.onSyncSceneryOffset=function(){var t=this.mSelected.scenery,i=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_UPDATE_SCENERY),o=i.content;o.id=t.id;var r=c.op_def.PBPoint2f.create();Object.assign(r,t.offset),o.offset=r,this.mRoom.connection.send(i)},Object.defineProperty(EditorSkyBoxManager.prototype,"selected",{get:function(){return this.mSelected},enumerable:!1,configurable:!0}),EditorSkyBoxManager}(K.a),Gt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),zt=function(t){function EditorRoom(i){var o=t.call(this,i)||this;return o.mBrush=new pt(o),o.mPointerDelta=null,o.connection&&(o.connection.addPacketListener(o),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_SET_EDITOR_MODE,o.onSetEditorModeHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_ALIGN_GRID,o.onAlignGridHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_VISIBLE_GRID,o.onVisibleGridHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_FOLLOW,o.onMouseFollowHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_SELECTED_SPRITE,o.onMouseFollowHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_FETCH_SPRITE,o.onFetchSpriteHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_FETCH_SCENERY,o.onFetchSceneryHandler)),o}return Gt(EditorRoom,t),EditorRoom.prototype.enter=function(t){if(t){this.mID=t.id;var i=t.rows,o=t.cols,r=t.tileWidth,a=t.tileHeight;this.mSize={cols:o,rows:i,tileHeight:a,tileWidth:r,sceneWidth:(i+o)*(r/2),sceneHeight:(i+o)*(a/2)},i*=2,o*=2,r/=2,a/=2,this.mNimiSize={cols:o,rows:i,tileHeight:a,tileWidth:r,sceneWidth:(i+o)*(r/2),sceneHeight:(i+o)*(a/2)},this.editorTerrainManager=new It(this),this.editorElementManager=new kt(this),this.editorMossManager=new Rt(this),this.editorSkyboxManager=new Ut(this),this.mCameraService=new Et(this),this.displayObjectPool=new Lt,this.mWorld.game.scene.add(mt.name,mt,!1,{room:this}),this.mWorld.game.scene.start(mt.name,{room:this})}else u.a.getInstance().error("wrong room")},EditorRoom.prototype.startPlay=function(){this.mScene=this.mWorld.game.scene.getScene(mt.name),this.mLayManager=new b.a(this),this.mLayManager.drawGrid(this);var t=this.scene.cameras.main;this.mCameraService.camera=t;var i=this.world.scaleRatio;this.mCameraService.setBounds(-t.width>>1,-t.height>>1,this.mSize.sceneWidth*i+t.width,this.mSize.sceneHeight*i+t.height);var o=this.mWorld.game.scene.getScene(k.a.name);o&&o.sleep(),this.connection.send(new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED)),this.mCameraService.centerCameas(),this.mScene.input.on("pointerdown",this.onPointerDownHandler,this),this.mScene.input.on("pointerup",this.onPointerUpHandler,this),this.mScene.input.on("gameobjectdown",this.onGameobjectDownHandler,this),this.mScene.input.on("gameout",this.onGameOutHandler,this),this.mScene.input.keyboard.on("keydown",this.onKeyDownHandler,this)},EditorRoom.prototype.destroy=function(){this.mWorld&&this.mWorld.connection&&this.mWorld.connection.removePacketListener(this),this.editorTerrainManager&&this.editorTerrainManager.destroy(),this.editorMossManager&&this.editorMossManager.destroy(),this.editorElementManager&&this.editorElementManager.destroy(),this.displayObjectPool&&this.displayObjectPool.destroy(),this.editorSkyboxManager&&this.editorSkyboxManager.destroy(),t.prototype.destroy.call(this)},EditorRoom.prototype.update=function(t,i){this.layerManager&&this.layerManager.update(t,i),this.mSelectedElementEffect&&this.mSelectedElementEffect.update(),this.editorTerrainManager&&this.editorTerrainManager.update(),this.editorMossManager&&this.editorMossManager.update(),this.editorElementManager&&this.editorElementManager.update()},EditorRoom.prototype.transformToMini90=function(t){if(this.mNimiSize)return w.a.transformTo90(t,this.mNimiSize);u.a.getInstance().error("position object is undefined")},EditorRoom.prototype.transformToMini45=function(t){if(this.mNimiSize)return w.a.transformTo45(t,this.mNimiSize);u.a.getInstance().error("position object is undefined")},EditorRoom.prototype.removeSelected=function(){this.mSelectedElementEffect&&(this.mSelectedElementEffect.remove(),this.mPointerDelta=null)},EditorRoom.prototype.addPointerMoveHandler=function(){this.mScene.input.on("pointermove",this.onPointerMoveHandler,this)},EditorRoom.prototype.removePointerMoveHandler=function(){this.mScene.input.off("pointermove",this.onPointerMoveHandler,this)},EditorRoom.prototype.addPointerDownHandler=function(){this.mScene.input.on("pointerdown",this.onPointerDownHandler,this)},EditorRoom.prototype.removePointerDownHandler=function(){this.mScene.input.off("pointerdown",this.onPointerDownHandler,this)},EditorRoom.prototype.addPointerUpHandler=function(){this.mScene.input.on("pointerup",this.onPointerUpHandler,this)},EditorRoom.prototype.removePointerUpHandler=function(){this.mScene.input.off("pointerup",this.onPointerUpHandler,this)},EditorRoom.prototype.addGameObjectDownHandler=function(){this.mScene.input.on("gameobjectdown",this.onGameobjectDownHandler,this)},EditorRoom.prototype.removeGameObjectDownHandler=function(){this.mScene.input.off("gameobjectdown",this.onGameobjectDownHandler,this)},EditorRoom.prototype.addKeydownHandler=function(){this.mScene.input.keyboard.on("keydown",this.onKeyDownHandler,this)},EditorRoom.prototype.removeKeydownHandler=function(){this.mScene.input.keyboard.off("keydown",this.onKeyDownHandler,this)},EditorRoom.prototype.onPointerDownHandler=function(){var t=this.mouseFollow.nodeType;this.mouseFollow.key&&(t===c.op_def.NodeType.TerrainNodeType?this.world.elementStorage.getTerrainPalette(this.mouseFollow.key)||this.reqEditorSyncPaletteOrMoss(this.mouseFollow.key,this.mouseFollow.nodeType):t===c.op_def.NodeType.ElementNodeType&&(this.world.elementStorage.getMossPalette(this.mouseFollow.key)||this.reqEditorSyncPaletteOrMoss(this.mouseFollow.key,this.mouseFollow.nodeType))),this.addPointerMoveHandler()},EditorRoom.prototype.onPointerUpHandler=function(t){switch(this.removePointerMoveHandler(),this.brush.mode){case $.BRUSH:this.createElements();break;case $.SELECT:if(this.mSelectedElementEffect&&this.mSelectedElementEffect.selecting){if(t.downX!==t.upX&&t.downY!==t.upY)if(this.mSelectedElementEffect.sprite.isMoss)this.editorMossManager.updateMosses([this.mSelectedElementEffect]);else{var i=this.mSelectedElementEffect.display.element.model.toSprite();this.editorElementManager.updateElements([i])}this.mSelectedElementEffect.selecting=!1,this.mPointerDelta=null}break;case $.ERASER:this.eraserTerrains();break;case $.MOVE:this.mCameraService.syncCameraScroll()}},EditorRoom.prototype.onPointerMoveHandler=function(t){if(this.mScene.cameras)switch(this.mBrush.mode){case $.BRUSH:this.mMouseFollow.nodeType===c.op_def.NodeType.TerrainNodeType&&this.createElements();break;case $.MOVE:this.moveCameras(t);break;case $.SELECT:this.editorSkyboxManager&&this.editorSkyboxManager.move(t),this.moveElement(t);break;case $.ERASER:this.eraserTerrains()}},EditorRoom.prototype.moveCameras=function(t){this.cameraService.offsetScroll(t.prevPosition.x-t.position.x,t.prevPosition.y-t.position.y)},EditorRoom.prototype.reqEditorSyncPaletteOrMoss=function(t,i){var o=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_PALETTE_MOSS),r=o.content;r.key=t,r.type=i,this.connection.send(o)},EditorRoom.prototype.createElements=function(){if(this.mMouseFollow.sprite)if(this.mMouseFollow.nodeType===c.op_def.NodeType.TerrainNodeType){var t=this.mMouseFollow.createTerrainsOrMossesData();this.editorTerrainManager&&this.editorTerrainManager.addTerrains(t)}else if(this.mMouseFollow.nodeType===c.op_def.NodeType.ElementNodeType){if(!(o=this.mMouseFollow.createSprites()))return;if(!this.editorElementManager)return;if(this.mMouseFollow.isMoss){var i=this.mMouseFollow.createTerrainsOrMossesData();this.editorMossManager.addMosses(i)}else this.editorElementManager.addElements(o)}else if(this.mMouseFollow.nodeType===c.op_def.NodeType.SpawnPointType){var o=this.mMouseFollow.createSprites();this.editorElementManager.addElements(o)}},EditorRoom.prototype.eraserTerrains=function(){var t=this.mMouseFollow.getEaserPosition();this.editorTerrainManager.removeTerrains(t)},EditorRoom.prototype.onSetEditorModeHandler=function(t){var i=t.content;this.mBrush.mode=i.mode,this.mMouseFollow&&this.mMouseFollow.destroy(),this.mBrush.mode!==$.SELECT&&this.mSelectedElementEffect&&(this.mSelectedElementEffect.destroy(),this.mSelectedElementEffect=null,this.mPointerDelta=null),this.mBrush.mode===$.SELECT?(this.removeGameObjectDownHandler(),this.addGameObjectDownHandler()):this.removeGameObjectDownHandler(),this.mBrush.mode===$.ERASER&&(this.mMouseFollow||(this.mMouseFollow=new _t(this.mScene,this)),this.mMouseFollow.showEraserArea()),this.editorSkyboxManager&&this.editorSkyboxManager.removeSelect(),this.layerManager.setSurfaceInteractive(this.mBrush.mode!==$.ERASER)},EditorRoom.prototype.onAlignGridHandler=function(t){var i=t.content;this.mouseFollow.alignGrid=i.align},EditorRoom.prototype.onVisibleGridHandler=function(t){var i=t.content;this.layerManager.setGridVisible(i.visible)},EditorRoom.prototype.onMouseFollowHandler=function(t){var i=t.content;this.mScene&&this.mouseFollow.setDisplay(i)},EditorRoom.prototype.onFetchSpriteHandler=function(t){for(var i,o=t.content,r=o.ids,a=o.nodeType,h=((i={})[c.op_def.NodeType.SpawnPointType]="elements",i[c.op_def.NodeType.ElementNodeType]="elements",i[c.op_def.NodeType.MossCollectionType]="mosses",i),l=0,u=r;l<u.length;l++){var p=u[l],d=h[a],m=this.displayObjectPool.getPool(d).get(p.toString());m&&this.selectedElement(m.getDisplay())}},EditorRoom.prototype.sendFetch=function(t,i,o){if(this.mSelectedElementEffect&&this.mSelectedElementEffect.display){var r=new l.PBpacket(c.op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_FETCH_SPRITE),a=r.content;a.ids=t,a.isMoss=o,a.nodeType=i,this.connection.send(r),u.a.getInstance().log("fetch sprite",a)}},EditorRoom.prototype.onFetchSceneryHandler=function(t){if(this.mSelectedElementEffect&&(this.mSelectedElementEffect.destroy(),this.mSelectedElementEffect=null,this.mPointerDelta=null),this.editorSkyboxManager){var i=t.content;this.editorSkyboxManager.fetch(i.id)}},EditorRoom.prototype.onGameobjectDownHandler=function(t,i){var o=i.parentContainer.parentContainer||i.parentContainer;if(o){var r=this.selectedElement(o);r&&this.sendFetch([r.element.id],c.op_def.NodeType.ElementNodeType,r.element.model.isMoss)}},EditorRoom.prototype.selectedElement=function(t){if(t instanceof I.b&&!(t instanceof Pt.a))return this.mSelectedElementEffect||(this.mSelectedElementEffect=new St(this.mScene,this.layerManager)),this.mSelectedElementEffect.setElement(t),this.editorSkyboxManager&&this.editorSkyboxManager.removeSelect(),t},EditorRoom.prototype.onKeyDownHandler=function(t){if(this.editorSkyboxManager&&this.editorSkyboxManager.keyboardMove(t.keyCode),this.mSelectedElementEffect)switch(t.keyCode){case 37:case 38:case 39:case 40:case 65:case 87:case 83:case 68:this.keyboardMoveElement(t.keyCode)}},EditorRoom.prototype.keyboardMoveElement=function(t){var i=this.mSelectedElementEffect.display;if(i){var o=new p.a(i.x,i.y,i.z);switch(t){case 37:o.x--;break;case 38:o.y--;break;case 39:o.x++;break;case 40:o.y++}i.setPosition(o.x,o.y,o.z),this.layerManager.depthSurfaceDirty=!0}},EditorRoom.prototype.moveElement=function(t){if(this.mSelectedElementEffect&&this.mSelectedElementEffect.selecting&&this.mouseFollow&&this.mSelectedElementEffect.display){if(!this.mPointerDelta){var i=new Phaser.GameObjects.Components.TransformMatrix,o=new Phaser.GameObjects.Components.TransformMatrix;this.mSelectedElementEffect.display.getWorldTransformMatrix(i,o),this.mPointerDelta=new p.a(i.tx-t.worldX,i.ty-t.worldY)}var r=new p.a(this.mPointerDelta.x+t.worldX,this.mPointerDelta.y+t.worldY),a=this.mMouseFollow.transitionGrid(r.x/this.mScaleRatio,r.y/this.mScaleRatio);a&&(a.x===this.mSelectedElementEffect.display.x&&a.y===this.mSelectedElementEffect.display.y||(this.mSelectedElementEffect.setDisplayPos(a.x,a.y),this.mLayManager.depthSurfaceDirty=!0))}},Object.defineProperty(EditorRoom.prototype,"brush",{get:function(){return this.mBrush},enumerable:!1,configurable:!0}),Object.defineProperty(EditorRoom.prototype,"miniSize",{get:function(){return this.mNimiSize},enumerable:!1,configurable:!0}),Object.defineProperty(EditorRoom.prototype,"mouseFollow",{get:function(){return this.mMouseFollow||(this.mMouseFollow=new _t(this.mScene,this)),this.mMouseFollow},enumerable:!1,configurable:!0}),EditorRoom.prototype.removeDisplay=function(t){t.sprite.isMoss?this.editorMossManager.deleteMosses([t.sprite.id]):this.editorElementManager.deleteElements([t.sprite.id]),this.removeSelected()},EditorRoom}(ut),Vt=o(391),Wt=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),__awaiter=function(t,i,o,r){return new(o||(o=Promise))((function(a,h){function fulfilled(t){try{step(r.next(t))}catch(t){h(t)}}function rejected(t){try{step(r.throw(t))}catch(t){h(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof o?t:new o((function(i){i(t)}))}(t.value).then(fulfilled,rejected)}step((r=r.apply(t,i||[])).next())}))},__generator=function(t,i){var o,r,a,h,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return h={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h;function verb(h){return function(c){return function step(h){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=2&h[0]?r.return:h[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,h[1])).done)return a;switch(r=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return l.label++,{value:h[1],done:!1};case 5:l.label++,r=h[1],h=[0];continue;case 7:h=l.ops.pop(),l.trys.pop();continue;default:if(!(a=l.trys,(a=a.length>0&&a[a.length-1])||6!==h[0]&&2!==h[0])){l=0;continue}if(3===h[0]&&(!a||h[1]>a[0]&&h[1]<a[3])){l.label=h[1];break}if(6===h[0]&&l.label<a[1]){l.label=a[1],a=h;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(h);break}a[2]&&l.ops.pop(),l.trys.pop();continue}h=i.call(t,l)}catch(t){h=[6,t],r=0}finally{o=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([h,c])}}},Kt=function(t){function RoomManager(i){var o=t.call(this)||this;return o.mRooms=[],o.mWorld=i,o.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ENTER_SCENE,o.onEnterSceneHandler),o.addHandlerFun(c.op_client.OPCODE._OP_EDITOR_REQ_CLIENT_CHANGE_TO_EDITOR_MODE,o.onEnterEditor),o}return Wt(RoomManager,t),RoomManager.prototype.addPackListener=function(){this.connection&&this.connection.addPacketListener(this)},RoomManager.prototype.removePackListener=function(){this.connection&&this.connection.removePacketListener(this)},RoomManager.prototype.getRoom=function(t){return this.mRooms.find((function(i){return i.id===t}))},RoomManager.prototype.onFocus=function(){this.mRooms.forEach((function(t){t&&t.scene&&t.resume(t.scene.scene.key)}))},RoomManager.prototype.onBlur=function(){this.mRooms.forEach((function(t){t&&t.scene&&t.pause()}))},RoomManager.prototype.pasuseRoom=function(t){var i=this.mRooms.findIndex((function(i,o){return t===i.id}));i>=0&&this.mRooms[i].pause()},RoomManager.prototype.resumeRoom=function(t){var i=this.mRooms.findIndex((function(i,o){return t===i.id}));if(i>=0){var o=this.mRooms[i];o&&o.scene&&o.resume(o.scene.scene.key)}},RoomManager.prototype.stop=function(){this.mRooms.forEach((function(t){t&&t.scene&&t.destroy()}))},RoomManager.prototype.resize=function(t,i){this.mRooms.forEach((function(o){o&&o.resize(t,i)}))},RoomManager.prototype.destroy=function(){this.removePackListener(),this.mCurRoom=null;for(var t=0,i=this.mRooms;t<i.length;t++){var o=i[t];o.destroy(),o=null}this.mRooms.length=0},RoomManager.prototype.hasRoom=function(t){return this.mRooms.findIndex((function(i,o){return t===i.id}))>=0},RoomManager.prototype.onEnterScene=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o=this;return __generator(this,(function(r){return i=t,this.hasRoom(i.scene.id)?this.onEnterRoom(t):this.world.loadSceneConfig(i.scene.id.toString()).then((function(i){return __awaiter(o,void 0,void 0,(function(){return __generator(this,(function(o){return this.world.elementStorage.setSceneConfig(i),this.onEnterRoom(t),[2]}))}))})),[2]}))}))},RoomManager.prototype.onEnterRoom=function(t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return this.mCurRoom?[4,this.leaveScene(this.mCurRoom)]:[3,2];case 1:o.sent(),o.label=2;case 2:return i=new ut(this),this.mRooms.push(i),i.addActor(t.actor),i.enter(t.scene),this.mCurRoom=i,[2]}}))}))},RoomManager.prototype.onEnterDecorate=function(t){return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return this.mCurRoom?[4,this.leaveScene(this.mCurRoom)]:[3,2];case 1:r.sent(),r.label=2;case 2:return(i=new Vt.a(this)).enter(t.scene),(o=t.actor)&&i.setEnterPos(o.x,o.y),this.mRooms.push(i),this.mCurRoom=i,[2]}}))}))},RoomManager.prototype.onEnterEditor=function(t){var i=t.content,o=new zt(this);o.enter(i.scene),this.mCurRoom=o,this.mRooms.push(o)},RoomManager.prototype.leaveScene=function(t){return __awaiter(this,void 0,void 0,(function(){var i=this;return __generator(this,(function(o){return t?[2,new Promise((function(o,r){var a=i.mWorld.game.scene.getScene(k.a.name);a&&a.show().then((function(){i.mRooms=i.mRooms.filter((function(i){return i.id!==t.id})),t.destroy(),o()}))}))]:[2]}))}))},RoomManager.prototype.onEnterSceneHandler=function(t){var i=t.content;switch(i.scene.sceneType){case c.op_def.SceneTypeEnum.NORMAL_SCENE_TYPE:this.onEnterScene(i);break;case c.op_def.SceneTypeEnum.EDIT_SCENE_TYPE:this.onEnterDecorate(i)}},Object.defineProperty(RoomManager.prototype,"world",{get:function(){return this.mWorld},enumerable:!1,configurable:!0}),Object.defineProperty(RoomManager.prototype,"currentRoom",{get:function(){return this.mCurRoom},enumerable:!1,configurable:!0}),Object.defineProperty(RoomManager.prototype,"connection",{get:function(){if(this.mWorld)return this.mWorld.connection;u.a.getInstance().error("world manager is undefined")},enumerable:!1,configurable:!0}),RoomManager}(l.PacketHandler)},,function(t,i,o){"use strict";o.d(i,"a",(function(){return O}));var r,a=o(110),h=o(131),l=o(128),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function CreateRoleScene(){return t.call(this,{key:CreateRoleScene.name})||this}return c(CreateRoleScene,t),CreateRoleScene.prototype.init=function(t){t.role&&(this.role=t.role)},CreateRoleScene.prototype.create=function(){this.role&&(this.game.scene.stop(h.a.name),this.role.start(this))},CreateRoleScene}(l.a),p=o(112),d=o(121),m=o(117),y=o(153),g=o(154),_=o(113),v=o(114),b=o(109),P=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),w=function(t){function CreateRolePanel(i,o){var r=t.call(this,i,o)||this;return r.key="createCharacter",r.mCurPageNum=0,r.setTween(!1),r.scene.add.container(0,0).add(r),i.scale.on("resize",r.onResize,r),r}return P(CreateRolePanel,t),CreateRolePanel.prototype.show=function(i){i&&(this.avatars=i.avatars),t.prototype.show.call(this,i)},CreateRolePanel.prototype.preload=function(){this.addAtlas(this.key,"create_role/create_role.png","create_role/create_role.json"),t.prototype.preload.call(this)},CreateRolePanel.prototype.resize=function(t,i){this.mWorld.getSize();if(this.setSize(this.scaleWidth,this.scaleHeight),this.mBackground){var o=this.scale,r=this.scene.cameras.main.width/o,a=this.scene.cameras.main.height/o,h=this.scene.cameras.main.centerX/o;this.mBackground.x=h,this.mFoot.x=h,this.mFoot.y=a-(this.mFoot.height>>1),this.mBackgroundColor.clear(),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,r,a),this.mSubmit.x=h,this.inputText.x=h,this.mInputTextBg.x=h,this.dragonbones.x=h,this.mNextPageBtn.x=r-150,this.mRandomBtn.x=this.mInputTextBg.x+this.mInputTextBg.width/2-26*this.dpr}},CreateRolePanel.prototype.init=function(){var i=this.mWorld.getSize(),o=this.mWorld.uiScale;this.mBackground=this.scene.make.image({key:this.key,frame:"bg.png",x:i.width>>1}).setScale(o),this.mBackground.y=this.mBackground.height/2+92*this.dpr,this.add(this.mBackground),this.mFoot=this.scene.make.image({key:this.key,frame:"bg_foot.png"},!1),this.add(this.mFoot),this.mBackgroundColor=this.scene.make.graphics(void 0,!1),this.mBackgroundColor.fillGradientStyle(7304703,7304703,314367,314367),this.mBackgroundColor.fillRect(0,0,i.width,i.height),this.addAt(this.mBackgroundColor,0),this.mInputTextBg=new m.NinePatch(this.scene,i.width>>1,350*this.dpr,255*this.dpr,50*this.dpr,this.key,"input_bg.png",{left:27*this.dpr,top:24*this.dpr,right:28*this.dpr,bottom:24*this.dpr}),this.add(this.mInputTextBg),this.inputText=new b.InputText(this.scene,i.width>>1,350*this.dpr,160*this.dpr,80,{type:"input",fontSize:18*this.dpr+"px",color:"#717171",align:"center",placeholder:v.a.t("create_role.enter_nick")}).setOrigin(.5),this.add(this.inputText);var r=v.a.t("create_role.commit");this.mShowData&&this.mShowData.button&&(r=this.mShowData.button.text);var a=this.scene.textures.getFrame(this.key,"submit_button_normal"),h=42,l=43;a&&(h=a.width,l=a.height),this.mSubmit=new d.NinePatchButton(this.scene,i.width>>1,445*this.dpr,202*this.dpr,55*this.dpr,this.key,"submit_button",r,{left:19*this.dpr,top:20*this.dpr,right:h-2-19*this.dpr,bottom:l-2-20*this.dpr}),this.mSubmit.setTextStyle({color:"#976400",fontSize:18*this.dpr,fontFamily:_.a.DEFULT_FONT}),this.mSubmit.setFontStyle("bold"),this.mSubmit.on("pointerup",this.onSubmitHandler,this),this.add(this.mSubmit),this.mPrePageBtn=this.scene.make.image({x:60*this.dpr,y:216*this.dpr,key:this.key,frame:"arrow_left.png"}).setInteractive(),this.mPrePageBtn.on("pointerup",this.onPrePageHandler,this),this.mNextPageBtn=this.scene.make.image({x:i.width-60*this.dpr,y:this.mPrePageBtn.y,key:this.key,frame:"arrow.png"}).setFlipX(!0).setInteractive(),this.mNextPageBtn.on("pointerup",this.onNextPageHandler,this),this.mRandomBtn=this.scene.make.image({x:this.mInputTextBg.x,y:this.mInputTextBg.y,key:this.key,frame:"random.png"}).setInteractive(),this.add([this.mPrePageBtn,this.mNextPageBtn,this.mRandomBtn]),this.mRandomBtn.on("pointerup",this.onRandomNameHandler,this),this.mErrorBg=this.scene.make.image({key:this.key,frame:"tips_bg.png",x:220*this.dpr,y:57*this.dpr}).setVisible(!1),this.mError=this.scene.make.text({x:127*this.dpr,y:30*this.dpr,style:{color:"#26265d",font:"bold 34px YaHei",wordWrap:{width:420,useAdvancedWrap:!0}}},!1).setVisible(!1),this.add([this.mErrorBg,this.mError]),this.dragonbones=new y.a(this.scene,void 0,void 0,!0),this.dragonbones.scale=2*this.dpr,this.dragonbones.x=i.width>>1,this.dragonbones.y=this.mNextPageBtn.y+70*this.dpr,this.dragonbones.on("initialized",this.loadDragonbonesComplete,this),this.add(this.dragonbones),this.setPageNum(0),t.prototype.init.call(this),this.resize(0,0)},CreateRolePanel.prototype.setAvatars=function(t){this.avatars=t},CreateRolePanel.prototype.showError=function(t){this.mError&&(this.mError.text=t,this.mError.setVisible(!0),this.mErrorBg.setVisible(!0))},CreateRolePanel.prototype.setNickName=function(t){this.inputText&&(this.inputText.text=t)},CreateRolePanel.prototype.destroy=function(){this.scene&&this.scene.scale.off("resize",this.onResize,this),this.dragonbones&&this.dragonbones.off("initialized",this.loadDragonbonesComplete,this),t.prototype.destroy.call(this)},CreateRolePanel.prototype.onRandomNameHandler=function(){this.emit("randomName"),this.inputText.setBlur()},CreateRolePanel.prototype.onSubmitHandler=function(){this.emit("submit",this.inputText.text,this.avatars[this.mCurPageNum]),this.inputText.setBlur(),this.mError&&(this.mError.setVisible(!1),this.mErrorBg.setVisible(!1))},CreateRolePanel.prototype.onPrePageHandler=function(){this.setPageNum(this.mCurPageNum-1),this.inputText.setBlur()},CreateRolePanel.prototype.onNextPageHandler=function(){this.setPageNum(this.mCurPageNum+1),this.inputText.setBlur()},CreateRolePanel.prototype.setPageNum=function(t){this.mCurPageNum=t,this.mCurPageNum<0?this.mCurPageNum=this.avatars.length-1:this.mCurPageNum>=this.avatars.length&&(this.mCurPageNum=0),this.dragonbones.load(new g.a({id:0,avatar:this.avatars[this.mCurPageNum]}))},CreateRolePanel.prototype.onResize=function(t){this.resize(t.width,t.height)},CreateRolePanel.prototype.loadDragonbonesComplete=function(){this.dragonbones.play({name:"idle",flip:!1})},CreateRolePanel}(p.BasePanel),S=o(2),C=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),T=function(t){function CreateRole(i){var o=t.call(this)||this;return o.roleManager=i,o.world=o.roleManager.world,o}return C(CreateRole,t),CreateRole.prototype.enter=function(t){this.mAvatars=t.avatars,this.mParam=t,this.world.game.scene.getScene(u.name)||this.world.game.scene.add(u.name,u),this.world.game.scene.start(u.name,{world:this.world,role:this})},CreateRole.prototype.start=function(t){this.createPanel=new w(t,this.world),this.createPanel.show(this.mParam),this.createPanel.on("randomName",this.onRandomNameHandler,this),this.createPanel.on("submit",this.onSubmitHandler,this),this.world.connection&&(this.world.connection.addPacketListener(this),this.addHandlerFun(S.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_ERROR_MESSAGE,this.onCreateErrorHandler),this.addHandlerFun(S.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_GENERATE_NEW_NAME,this.onGenerateNameHandler))},CreateRole.prototype.destroy=function(){this.world.connection&&this.world.connection.removePacketListener(this),this.world.game.scene.remove(u.name)},CreateRole.prototype.onRandomNameHandler=function(){var t=this.world.connection,i=new a.PBpacket(S.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE_GENERATE_NEW_NAME);t.send(i)},CreateRole.prototype.onSubmitHandler=function(t,i){var o=this.world.connection,r=new a.PBpacket(S.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE),h=r.content;h.name=t,h.avatar=i,o.send(r)},CreateRole.prototype.onCreateErrorHandler=function(t){if(this.createPanel){var i=t.content;this.createPanel.showError(i.errorMsg)}},CreateRole.prototype.onGenerateNameHandler=function(t){if(this.createPanel){var i=t.content;this.createPanel.setNickName(i.name)}},CreateRole}(a.PacketHandler),k=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),O=function(t){function RoleManager(i){var o=t.call(this)||this;return o.world=i,o}return k(RoleManager,t),RoleManager.prototype.register=function(){if(this.world){var t=this.world.connection;t&&(t.addPacketListener(this),this.addHandlerFun(S.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_CREATE_ROLE_UI,this.onOpenCreateCharacter),this.addHandlerFun(S.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CLOSE_CREATE_ROLE_UI,this.onCloseCreateCharacterHandler))}},RoleManager.prototype.unregister=function(){if(this.world){var t=this.world.connection;t&&t.removePacketListener(this)}},RoleManager.prototype.onOpenCreateCharacter=function(t){this.mCreateCharacter=new T(this),this.mCreateCharacter.enter(t.content)},RoleManager.prototype.onCloseCreateCharacterHandler=function(){this.mCreateCharacter&&(this.mCreateCharacter.destroy(),this.mCreateCharacter=void 0)},RoleManager}(a.PacketHandler)},function(t,i,o){"use strict";o.d(i,"a",(function(){return P}));var r,a=o(339),h=o(2),l=o(126),c=o(118),u=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),p=function(t){function PlayerModel(i){var o=t.call(this,i)||this;return o.mPos=new c.a(i.x,i.y,i.z),o.mAlpha=1,o.mPackage=i.package,o.mSceneId=i.sceneId,o.mUuid=i.uuid,o.mPlatformId=i.platformId,o.currentAnimationName="idle",o}return u(PlayerModel,t),PlayerModel}(l.a),d=o(122),m=o(110),y=function(){function PlayerData(){}return PlayerData.prototype.destroy=function(){this.itemBag&&this.itemBag.destroy(),this.furniBag&&this.furniBag.destroy(),this.avatarBag&&this.avatarBag.destroy(),this.mineBag&&this.mineBag.destroy(),this.editFurniBag&&this.editFurniBag.destroy(),this.itemBag=void 0,this.furniBag=void 0,this.avatarBag=void 0,this.mineBag=void 0,this.editFurniBag=void 0},PlayerData.prototype.getItemsByCategory=function(t,i){return this.getPackage(t).getItemsByCategory(i)},PlayerData.prototype.getItems=function(t,i,o){return this.getPackage(t).getItems(i,o)},PlayerData.prototype.getItem=function(t,i,o,r){return this.getPackage(t).getItem(i,o,r)},PlayerData.prototype.getItemsCount=function(t,i,o){var r=this.getItems(t,i,o),a=0;return r.forEach((function(t){a+=t.count})),a},PlayerData.prototype.syncPackage=function(t){var i=this.getPackage(t.packageName);return i.syncPackage(t),i},PlayerData.prototype.updatePackage=function(t){this.getPackage(t.packageName).updatePackage(t)},PlayerData.prototype.getPackage=function(t){return t===h.op_pkt_def.PKT_PackageType.PropPackage?(this.itemBag||(this.itemBag=new g),this.itemBag):t===h.op_pkt_def.PKT_PackageType.FurniturePackage?(this.furniBag||(this.furniBag=new g),this.furniBag):t===h.op_pkt_def.PKT_PackageType.AvatarPackage?(this.avatarBag||(this.avatarBag=new g),this.avatarBag):t===h.op_pkt_def.PKT_PackageType.MinePackage?(this.mineBag||(this.mineBag=new g),this.mineBag):t===h.op_pkt_def.PKT_PackageType.EditFurniturePackage?(this.editFurniBag||(this.editFurniBag=new g),this.editFurniBag):void 0},PlayerData}(),g=function(){function PackageData(){this.syncFinish=!1,this.list=[],this.subMap=new Map}return PackageData.prototype.getItemsByCategory=function(t){if("alltype"===t)return Array.from(this.list);if(this.subMap.has(t)){var i=this.subMap.get(t);if(i)return Array.from(i.values())}},PackageData.prototype.getItems=function(t,i){var o=[];if(void 0!==i&&"alltype"!==i){var r=this.subMap.get(i);r&&r.forEach((function(i){i.id===t&&o.push(i)}))}else this.list.forEach((function(i){i.id===t&&o.push(i)}));return o},PackageData.prototype.getItem=function(t,i,o){var r;if(void 0!==o&&"alltype"!==o){var a=this.subMap.get(o);if(a){if(t&&a.has(t))return a.get(t);i&&a.forEach((function(t){if(t.id===i)return r=t}))}}else this.subMap.forEach((function(o){if(t&&o.has(t))return r=o.get(t);i&&o.forEach((function(t){if(t.id===i)return r=t}))}));return r},PackageData.prototype.syncPackage=function(t){this.packageName=t.packageName,this.syncFinish&&this.clear();for(var i=0,o=t.items;i<o.length;i++){var r=o[i],a=void 0!==r.subcategory?r.subcategory:"default",h=this.subMap.get(a);h||(h=new Map,this.subMap.set(a,h)),h.set(r.indexId,r),this.list.push(r)}t.packet.currentFrame===t.packet.totalFrame&&(this.syncFinish=!0),this.limit=t.limit},PackageData.prototype.updatePackage=function(t){for(var i=0,o=t.items;i<o.length;i++){var r=o[i];if("-1"===r.id){for(var a=void 0,h=-1,l=0,c=this.list;l<c.length;l++){var u=c[l];if(h++,u.indexId===r.indexId){a=u;break}}if(a){this.list.splice(h,1);var p=void 0!==a.subcategory?a.subcategory:"default";(d=this.subMap.get(p))&&d.has(a.indexId)&&d.delete(a.indexId)}}else{var d;p=void 0!==r.subcategory?r.subcategory:"default";if((d=this.subMap.get(p))||(d=new Map,this.subMap.set(p,d)),d.has(r.indexId)){a=d.get(r.indexId);for(var m in r)a[m]=r[m]}else d.set(r.indexId,r),this.list.push(r)}}},PackageData.prototype.destroy=function(){this.list.length=0,this.subMap.forEach((function(t){t.clear()})),this.subMap.clear(),this.list=null,this.subMap=null},PackageData.prototype.clear=function(){this.list.length=0,this.subMap.forEach((function(t){t.clear()})),this.subMap.clear()},PackageData}(),_=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),v=function(t){function PlayerDataManager(i){var o=t.call(this)||this;return o.mWorld=i,o.mEvent=new Phaser.Events.EventEmitter,o.mPlayerData=new y,o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SYNC_PACKAGE,o.onSYNC_PACKAHE),o.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_UPDATE_PACKAGE,o.onUPDATE_PACKAGE),o}return _(PlayerDataManager,t),PlayerDataManager.prototype.addPackListener=function(){this.connection&&this.connection.addPacketListener(this)},PlayerDataManager.prototype.removePackListener=function(){this.connection&&this.connection.removePacketListener(this)},PlayerDataManager.prototype.on=function(t,i,o){this.mEvent.on(t,i,o)},PlayerDataManager.prototype.off=function(t,i,o){this.mEvent.off(t,i,o)},PlayerDataManager.prototype.clear=function(){this.removePackListener(),this.playerData.destroy(),this.mEvent.removeAllListeners()},PlayerDataManager.prototype.destroy=function(){this.removePackListener(),this.mEvent.destroy(),this.playerData.destroy()},Object.defineProperty(PlayerDataManager.prototype,"connection",{get:function(){if(this.mWorld)return this.mWorld.connection},enumerable:!1,configurable:!0}),Object.defineProperty(PlayerDataManager.prototype,"playerData",{get:function(){if(this.mPlayerData)return this.mPlayerData},enumerable:!1,configurable:!0}),PlayerDataManager.prototype.querySYNC_ALL_PACKAGE=function(){this.querySYNC_PACKAGE(h.op_pkt_def.PKT_PackageType.PropPackage),this.querySYNC_PACKAGE(h.op_pkt_def.PKT_PackageType.AvatarPackage),this.querySYNC_PACKAGE(h.op_pkt_def.PKT_PackageType.FurniturePackage)},PlayerDataManager.prototype.querySYNC_PACKAGE=function(t){var i=new m.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SYNC_PACKAGE);i.content.packageName=t,this.connection.send(i)},PlayerDataManager.prototype.onSYNC_PACKAHE=function(t){var i=t.content;this.playerData.syncPackage(i).syncFinish&&this.mEvent.emit("syncfinish",i.packageName)},PlayerDataManager.prototype.onUPDATE_PACKAGE=function(t){var i=t.content;this.playerData.updatePackage(i),this.mEvent.emit("update",i.packageName)},PlayerDataManager}(m.PacketHandler),b=function(){var extendStatics=function(t,i){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)};return function(t,i){function __(){this.constructor=t}extendStatics(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}}(),P=function(t){function User(i){var o=t.call(this,void 0,void 0)||this;return o.mBlockable=!1,o.mBag=new v(i),o}return b(User,t),User.prototype.addPackListener=function(){this.mBag.addPackListener()},User.prototype.removePackListener=function(){this.mBag.removePackListener()},User.prototype.enterScene=function(t,i){if(t&&i){this.mId=i.id,this.mRoomService=t,this.mElementManager=t.playerManager,this.model=new p(i),t.world.inputManager&&t.world.inputManager.addListener(this),this.mRoomService.playerManager.setMe(this);var o=this.mElementManager.roomService;if(o&&o.cameraService){var r=this.mElementManager.scene.scale;o.cameraService.setScroll(i.x*o.world.scaleRatio-r.width/2,i.y*o.world.scaleRatio-r.height/2),o.cameraService.syncCameraScroll()}}},User.prototype.downHandler=function(t,i){if(this.mDisplay&&(this.startMove(),!this.roomService.world.game.device.os.desktop)){var o=new m.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);o.content.keyCodes=i,this.mRoomService.connection.send(o)}},User.prototype.upHandler=function(){this.mDisplay&&this.stopMove()},User.prototype.startMove=function(){t.prototype.startMove.call(this)},User.prototype.stopMove=function(){if(t.prototype.stopMove.call(this),this.mRoomService&&this.mRoomService.world.moveStyle===h.op_def.MoveStyle.DIRECTION_MOVE_STYLE){var i=new m.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_STOP_SPRITE),o=i.content;o.nodeType=this.nodeType;var r=this.getPosition();o.spritePositions={id:this.id,point3f:{x:r.x,y:r.y,z:r.z},direction:this.dir},this.mElementManager.connection.send(i)}},User.prototype.move=function(i){if(this.mRoomService.world.moveStyle===h.op_def.MoveStyle.DIRECTION_MOVE_STYLE){if(this.mCurState!==d.d.WALK)return}else this.startMove();t.prototype.move.call(this,i)},User.prototype.movePath=function(i){if(this.mRoomService.world.moveStyle!==h.op_def.MoveStyle.DIRECTION_MOVE_STYLE||this.mCurState===d.d.WALK){var o=i.path,r=this.mElementManager.roomService.now(),a=0;o.map((function(t){return r+=a,a=t.timestemp-r,{x:t.point3f.x,y:t.point3f.y,duration:a,timestemp:t.timestemp}}));t.prototype.movePath.call(this,i)}},User.prototype.setRenderable=function(t){},User.prototype.getBag=function(){},User.prototype.getFriend=function(){},User.prototype.clear=function(){this.removePackListener(),t.prototype.clear.call(this),this.mBag&&this.bag.destroy(),this.destroy()},User.prototype.onMoveComplete=function(){this.preMoveComplete(),this.mCurState===d.d.WALK?(this.mRoomService.world.moveStyle!==h.op_def.MoveStyle.DIRECTION_MOVE_STYLE&&(this.changeState(d.d.IDLE),this.stopMove()),this._doMove()):this.mMoveData.tweenAnim.stop()},User.prototype.onMoving=function(){this.mCurState===d.d.WALK?t.prototype.onMoving.call(this):this.mMoveData.tweenLineAnim.stop()},User.prototype.addToBlock=function(){this.addDisplay()},User.prototype.drawPath=function(t){},Object.defineProperty(User.prototype,"model",{get:function(){return this.mModel},set:function(t){this.mModel=t,t&&(t.package,this.load(this.mModel.displayInfo),this.mModel.pos&&this.setPosition(this.mModel.pos),this.mDisplay.changeAlpha(this.mModel.alpha),this.mModel.nickname&&this.showNickname(),this.setDirection(this.mModel.direction))},enumerable:!1,configurable:!0}),Object.defineProperty(User.prototype,"package",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(User.prototype,"moveData",{get:function(){return this.mMoveData},enumerable:!1,configurable:!0}),Object.defineProperty(User.prototype,"bag",{get:function(){return this.mBag},enumerable:!1,configurable:!0}),Object.defineProperty(User.prototype,"moveStyle",{get:function(){return this.mMoveStyle},set:function(t){this.mMoveStyle=t},enumerable:!1,configurable:!0}),User}(a.a)},function(t,i,o){"use strict";var r=o(110),a=o(44),h=o(0),mainWorker=function(){return new Worker(o.p+"js/cb0a13b23b7f4b1c0b0e.mainWorker.js")},l=o(2),c=o(16);for(var u in l)r.PBpacket.addProtocol(l[u]);var p=function(){function Connection(t){this.mPacketHandlers=[],this._isConnect=!1,this.mListener=t}return Connection.prototype.isConnect=function(){return this._isConnect},Connection.prototype.startConnect=function(t,i){this.mCachedServerAddress=t;try{this.mMainWorker=new mainWorker,this.mMainWorker.postMessage({method:"init"}),this._doConnect()}catch(t){throw new Error("startConnect Error: "+t)}},Connection.prototype.closeConnect=function(){this._isConnect=!1,this.mMainWorker&&(h.a.getInstance().log("close connect"),this.mMainWorker.postMessage({method:"close"}),this.mMainWorker.terminate(),this.mMainWorker=null),this.mCachedServerAddress=void 0,this.mTimeout=null,this.clearPacketListeners()},Connection.prototype.clearHeartBeat=function(){this.mMainWorker&&this.mMainWorker.postMessage({method:"clearBeat"})},Connection.prototype.addPacketListener=function(t){this.mPacketHandlers.push(t)},Connection.prototype.send=function(t){if(!this.mMainWorker)throw new Error("NetWorker is undefined.");this.mMainWorker.postMessage({method:"send",buffer:t.Serialization()})},Connection.prototype.clearReconnectCount=function(){this.mMainWorker.postMessage("clearBeat")},Connection.prototype.removePacketListener=function(t){var i=this.mPacketHandlers.indexOf(t);-1!==i&&this.mPacketHandlers.splice(i,1)},Connection.prototype.clearPacketListeners=function(){if(this.mPacketHandlers&&!(this.mPacketHandlers.length<1))for(var t=this.mPacketHandlers.length,i=0;i<t;i++){var o=this.mPacketHandlers[i];o&&(this.removePacketListener(o),i--)}},Connection.prototype.onFocus=function(){this.mMainWorker&&this.mMainWorker.postMessage({method:"focus"})},Connection.prototype.onBlur=function(){this.mMainWorker&&this.mMainWorker.postMessage({method:"blur"})},Connection.prototype.loadRes=function(t){this.mMainWorker&&this.mMainWorker.postMessage({method:"loadRes",url:t})},Connection.prototype.move=function(t,i){this.mMainWorker&&this.mMainWorker.postMessage({method:"move",data:i})},Connection.prototype._doConnect=function(){var t=this;this.mMainWorker&&(this.mMainWorker.onmessage=function(i){t.onWorkerMessage(i.data)},this.mMainWorker.postMessage({method:"connect",address:t.mCachedServerAddress}))},Connection.prototype.onWorkerMessage=function(t){switch(t.method){case"canStartBeat":h.a.getInstance().log("canStartBeat"),this.mMainWorker&&this.mMainWorker.postMessage({method:"startBeat"});break;case"onConnected":this.mListener.onConnected(),this._isConnect=!0;break;case"onReconnect":this._isConnect=!1,this.closeConnect(),this.mListener.onReconnect();break;case"onDisConnected":this._isConnect=!1,this.closeConnect(),this.mListener.onDisConnected();break;case"onConnectError":this._isConnect=!1,this.mListener.onError(),h.a.getInstance().error("error"+t.error);break;case"heartBeat":this.worldStartHeartBeat();break;case"endBeat":this.endHeartBeat();break;case"reConnect":this.closeConnect(),this.reConnect();break;default:t instanceof ArrayBuffer?this._onData(t):t instanceof Blob&&this._onBlob(t)}},Connection.prototype._onBlob=function(t){var i=this;new Promise((function(o,r){var a=new FileReader;a.readAsDataURL(t),a.onload=function(o){switch(t.type){case"image/png":break;case"application/json":new Response(t).arrayBuffer().then((function(t){var o=new c.Lite;o.deserialize(new Uint8Array(t)),i.mListener.elementStorage.setGameConfig(o)}))}}}))},Connection.prototype._onData=function(t){var i=new r.PBpacket;i.Deserialization(new a.Buffer(t)),this.mPacketHandlers.forEach((function(t){t.onPacketArrived(i)}))},Connection.prototype.reConnect=function(){this.mPacketHandlers[0].reconnect()},Connection.prototype.worldStartHeartBeat=function(){this.mPacketHandlers[0].startHeartBeat()},Connection.prototype.endHeartBeat=function(){this.mMainWorker&&this.mMainWorker.postMessage({method:"endHeartBeat"})},Connection}();i.a=p},function(t,i,o){"use strict";o.d(i,"a",(function(){return u}));var r,a=o(110),h=o(2),l=function(){function Algorithm(){}return Algorithm.median=function(t){var i=t.sort((function(t,i){return i-t})),o=Math.floor(i.length/2);return i.length%2==0?(i[o-1]+i[o])/2:i[o]},Algorithm}(),c=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),u=function(t){function Clock(i,o){var r=t.call(this)||this;return r.mClockSync=!1,r.mAutoSync=!1,r.mTimestamp=0,r.mLatency=[],r.mConn=i,r.mConn.addPacketListener(r),r.addHandlerFun(h.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SYNC_TIME,r.proof),r.mListener=o,r._check(),r}return c(Clock,t),Object.defineProperty(Clock.prototype,"sysUnixTime",{get:function(){return(new Date).getTime()},enumerable:!1,configurable:!0}),Object.defineProperty(Clock.prototype,"unixTime",{get:function(){return this.mTimestamp},set:function(t){this.mTimestamp=t},enumerable:!1,configurable:!0}),Clock.prototype.sync=function(t){if(void 0===t&&(t=1),this.mConn){t<0&&(t=1);for(var i=0;i<t;++i){var o=new a.PBpacket(h.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_TIME);o.content.clientStartTs=this.sysUnixTime,this.mConn.send(o)}}},Clock.prototype.update=function(t,i){this.mTimestamp?this.mTimestamp+=i:this.mTimestamp=t},Clock.prototype.clearTime=function(){this.mClockSync=!1,this.mIntervalId&&clearInterval(this.mIntervalId),this.mTimestamp=0,this._check()},Clock.prototype.destroy=function(){this.mConn&&(this.mConn.removePacketListener(this),this.mConn=void 0),this.mIntervalId&&clearInterval(this.mIntervalId),this.mLatency=void 0},Object.defineProperty(Clock.prototype,"clockSync",{get:function(){return this.mClockSync},enumerable:!1,configurable:!0}),Clock.prototype._check=function(){var t=this;this.mIntervalId=setInterval((function(){t.sync()}),8e3)},Clock.prototype.proof=function(t){var i=t.content,o=this.sysUnixTime,r=i.clientStartTs,a=i.serverReceiveTs,h=i.serverSendTs,c=h-a,u=o-r-c,p=Math.round(u/2);if(!(p<0)){this.mLatency.push(p),this.mLatency.length>7&&this.mLatency.shift();var d=h-(l.median(this.mLatency)+c);if(Math.abs(d-this.mTimestamp)>500)return this.mTimestamp=d,this.mAutoSync=!0,void this.sync(-1);this.mAutoSync=!1,this.mListener&&this.mLatency.length>=2&&!this.mAutoSync&&(this.mClockSync=!0,this.mListener.onClockReady())}},Object.defineProperty(Clock.prototype,"medianLatency",{get:function(){return l.median(this.mLatency)},enumerable:!1,configurable:!0}),Clock}(a.PacketHandler)},function(t,i,o){"use strict";o.r(i),function(t){o.d(i,"World",(function(){return N}));var r,a=o(25),h=(o(45),o(394)),l=o(110),c=o(2),u=o(429),p=o(0),d=o(425),m=o(409),y=o(410),g=o(411),_=o(412),v=o(413),b=o(111),P=o(16),w=o(183),S=o(416),C=o(417),T=o(418),k=o(419),O=o(430),I=o(427),M=o(114),E=o(11),x=o(146),B=o(420),R=o(421),D=o(422),L=o(423),A=o(428),j=o(424),H=(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(t,i)},function(t,i){function __(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(__.prototype=i.prototype,new __)}),__awaiter=function(t,i,o,r){return new(o||(o=Promise))((function(a,h){function fulfilled(t){try{step(r.next(t))}catch(t){h(t)}}function rejected(t){try{step(r.throw(t))}catch(t){h(t)}}function step(t){t.done?a(t.value):function adopt(t){return t instanceof o?t:new o((function(i){i(t)}))}(t.value).then(fulfilled,rejected)}step((r=r.apply(t,i||[])).next())}))},__generator=function(t,i){var o,r,a,h,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return h={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h;function verb(h){return function(c){return function step(h){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=2&h[0]?r.return:h[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,h[1])).done)return a;switch(r=0,a&&(h=[2&h[0],a.value]),h[0]){case 0:case 1:a=h;break;case 4:return l.label++,{value:h[1],done:!1};case 5:l.label++,r=h[1],h=[0];continue;case 7:h=l.ops.pop(),l.trys.pop();continue;default:if(!(a=l.trys,(a=a.length>0&&a[a.length-1])||6!==h[0]&&2!==h[0])){l=0;continue}if(3===h[0]&&(!a||h[1]>a[0]&&h[1]<a[3])){l.label=h[1];break}if(6===h[0]&&l.label<a[1]){l.label=a[1],a=h;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(h);break}a[2]&&l.ops.pop(),l.trys.pop();continue}h=i.call(t,l)}catch(t){h=[6,t],r=0}finally{o=a=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([h,c])}}},N=function(i){function World(t,o){var r=i.call(this)||this;return r.isPause=!1,r.DEFAULT_WIDTH=360,r.DEFAULT_HEIGHT=640,r.mMoveStyle=1,r.isFullStart=!1,r.mOrientation=0,r.gameConfigUrls=new Map,r.gameConfigUrl="",r.reconnectIng=!1,r._isIOS=-1,r.mReconnect=0,r.focusoutFunc=function(){r.game&&r.game.device.os.iOS&&window.scrollTo(0,0)},r.gameState=h.a.NONE,r.initWorld(t,o),r}return H(World,i),World.prototype.initWorld=function(i,o){if(this.mCallBack=o,this.mConfig=i,!i.game_id)throw new Error("Config.game_id is required.");i.devicePixelRatio||(i.devicePixelRatio=window.devicePixelRatio||1),void 0===i.width&&(i.width=window.innerWidth),void 0===i.height&&(i.height=window.innerHeight),this.mScaleRatio=Math.ceil(i.devicePixelRatio||1),this.mUIRatio=Math.round(i.devicePixelRatio||1);var r=i.width/this.DEFAULT_WIDTH*(i.devicePixelRatio/this.mUIRatio);this.mUIScale=r,b.i.OSD_PATH=this.mConfig.osd||"https://osd-alpha.tooqing.com/",b.i.RES_PATH="./resources/",b.i.RESUI_PATH="./resources/ui/",this.mUser=new A.a(this),this._newGame(),this.mConnection=i.connection||new u.a(this),this.mConnection.addPacketListener(this),this.addHandlerFun(c.op_client.OPCODE._OP_GATEWAY_RES_CLIENT_VIRTUAL_WORLD_INIT,this.onInitVirtualWorldPlayerInit),this.addHandlerFun(c.op_client.OPCODE._OP_GATEWAY_RES_CLIENT_ERROR,this.onClientErrorHandler),this.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SELECT_CHARACTER,this.onSelectCharacter),this.addHandlerFun(c.op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_GOTO_ANOTHER_GAME,this.onGotoAnotherGame),this.addHandlerFun(c.op_client.OPCODE._OP_GATEWAY_RES_CLIENT_PONG,this.heartBeatCallBack),this.mGameEmitter=new Phaser.Events.EventEmitter,this.mRoomMamager=new d.a(this),this.mUiManager=new w.UiManager(this),this.mMouseManager=new y.a(this),this.mElementStorage=new _.a,this.mHttpService=new T.a(this),this.mRoleManager=new I.a(this),this.mSoundManager=new B.a(this),this.mLoadingManager=new R.a(this),this.mAccount=new C.a,this.mAccount.enterGame(this.mConfig.game_id,this.mConfig.virtual_world_id,null,null),Object(M.b)(E.relative(t,"../resources/locales/{{lng}}.json")),this.mRoleManager.register(),this.mRoomMamager.addPackListener(),this.mUiManager.addPackListener(),this.mSoundManager.addPackListener(),this.user.addPackListener(),this.gameState=h.a.GAME_INIT;var a=this.mConfig.server_addr||Object({host:"gdev.tooqing.com",port:11100,secure:!0});a&&this.mConnection.startConnect(a),document.body.addEventListener("focusout",this.focusoutFunc)},Object.defineProperty(World.prototype,"moveStyle",{get:function(){return this.mMoveStyle},enumerable:!1,configurable:!0}),World.prototype.getConfig=function(){return this.mConfig},World.prototype.setKeyBoardHeight=function(t){this.mConfig.keyboardHeight=t},World.prototype.setGameConfig=function(t){this.elementStorage.setGameConfig(t)},World.prototype.updatePalette=function(t){this.elementStorage.updatePalette(t)},World.prototype.updateMoss=function(t){this.elementStorage.updateMoss(t)},World.prototype.destroy=function(){var t=this;return new Promise((function(i,o){t.mConnection.closeConnect(),document.body.removeEventListener("focusout",t.focusoutFunc),t.clearGame((function(){i()}))}))},World.prototype.onConnected=function(t){this.gameState=h.a.SOCKET_CONNECT,this.mReconnect=0,this.mClock||(this.mClock=new O.a(this.mConnection,this)),this.mHttpClock||(this.mHttpClock=new D.a(this)),this.enterVirtualWorld()},World.prototype.onDisConnected=function(t){var i=this;(this.gameState=h.a.SOCKET_DISCONNECT,p.a.getInstance().log("app connectFail=====disConnect"),this.game&&!this.isPause)&&(this.mConfig.connectFail?this.onError():this.mReconnect>2?(this.mGame.scene.getScene(j.a.name)||this.mGame.scene.add(j.a.name,j.a,!1,{world:this,callBack:function(){i.clearGame().then((function(){i.initWorld(i.mConfig,i.mCallBack)}))}}),this.mGame.scene.start(j.a.name)):(this.mReconnect++,this.clearGame().then((function(){i.initWorld(i.mConfig,i.mCallBack)}))))},World.prototype.onReconnect=function(t){var i=this;this.gameState=h.a.SOCKET_DISCONNECT,p.a.getInstance().log("app connectFail=====reconnect"),this.game&&!this.isPause&&(this.mConfig.connectFail?this.onError():this.clearGame().then((function(){i.initWorld(i.mConfig,i.mCallBack)})))},World.prototype.onError=function(t){if(this.gameState=h.a.SOCKET_ERROR,p.a.getInstance().log("socket error"),!this.mConnection.isConnect){if(this.mConfig.connectFail)return p.a.getInstance().log("app connectFail"),this.mConfig.connectFail();this.reconnect()}},World.prototype.onClientErrorHandler=function(t){var i=t.content;p.a.getInstance().error("Remote Error["+i.responseStatus+"]: "+i.msg)},World.prototype.changeRoom=function(t){this.mInputManager&&this.mInputManager.onRoomChanged(t),this.mMouseManager.changeRoom(t),this.mSoundManager.changeRoom(t)},World.prototype.getSize=function(){if(this.mGame)return this.mGame.scale.gameSize},World.prototype.scaleChange=function(t){this.emitter.emit(World.SCALE_CHANGE)},World.prototype.closeGame=function(){this.mConfig.closeGame&&(this.destroy(),this.mConfig.closeGame())},World.prototype.restart=function(t,i){p.a.getInstance().log("restart game"),t&&(this.mConfig=t),i&&(this.mCallBack=i);var o=this.mConfig.game_id,r=this.mConfig.virtual_world_id;this.mAccount.gameID&&this.mAccount.virtualWorldId&&(o=this.mAccount.gameID,r=this.mAccount.virtualWorldId),this._createAnotherGame(o,r,null,null)},World.prototype.resize=function(t,i){this.mConfig&&(this.mConfig.width=t,this.mConfig.height=i);var o=t*window.devicePixelRatio,r=i*window.devicePixelRatio;if(this.mGame){this.mScaleRatio=Math.ceil(window.devicePixelRatio||1),this.mUIRatio=Math.round(window.devicePixelRatio||1);var a=t/this.DEFAULT_WIDTH*(window.devicePixelRatio/this.mUIRatio);this.mUIScale=this.game.device.os.desktop?1:a,this.mGame.scale.zoom=1/window.devicePixelRatio,this.mGame.scale.resize(o,r);for(var h=0,l=this.mGame.scene.scenes;h<l.length;h++){var c=l[h].cameras.main;c&&c.setPixelRatio&&c.setPixelRatio(this.mScaleRatio)}}this.mRoomMamager&&this.mRoomMamager.resize(o,r),this.mUiManager&&this.mUiManager.resize(o,r),this.mInputManager&&this.mInputManager.resize(o,r),p.a.getInstance().log("resize"+o+"|"+r)},World.prototype.onOrientationChange=function(t,i,o){"app"!==this.mConfig.platform&&(this.mOrientation=t,this.mConfig.screenWidth>this.mConfig.screenHeight?t<=135&&t>=45||t<=-45&&t>=-135?this.orientationResize(this.mConfig.screenWidth,this.mConfig.screenHeight,i,o):this.orientationResize(this.mConfig.screenHeight,this.mConfig.screenWidth,i,o):t<=135&&t>=45||t<=-45&&t>=-135?this.orientationResize(this.mConfig.screenHeight,this.mConfig.screenWidth,i,o):this.orientationResize(this.mConfig.screenWidth,this.mConfig.screenHeight,i,o))},World.prototype.startFullscreen=function(){this.mGame&&(this.isFullStart=!0,this.mGame.scale.startFullscreen())},World.prototype.stopFullscreen=function(){this.mGame&&(this.isFullStart=!1,this.mGame.scale.stopFullscreen())},World.prototype.onGotoAnotherGame=function(t){var i=t.content;this._createAnotherGame(i.gameId,i.virtualWorldId,i.sceneId,i.loc)},World.prototype.changeScene=function(){return __awaiter(this,void 0,void 0,(function(){var t,i;return __generator(this,(function(o){switch(o.label){case 0:return t=this.mConfig.game_id,i=this.mConfig.virtual_world_id,[4,this.clearGame()];case 1:return o.sent(),this.mConfig.game_id=t,this.mConfig.virtual_world_id=i,this._newGame(),this.loginEnterWorld(),[2]}}))}))},World.prototype.reconnect=function(){if(this.mConfig.connectFail)return this.mConfig.connectFail();if(this.game&&!this.isPause&&!this.reconnectIng){this.reconnectIng=!0;var t=this.mConfig.game_id,i=this.mConfig.virtual_world_id;this.mAccount.gameID&&this.mAccount.virtualWorldId&&(t=this.mAccount.gameID,i=this.mAccount.virtualWorldId),this._createAnotherGame(t,i,null,null)}},World.prototype.startHeartBeat=function(){var t=new l.PBpacket(c.op_gateway.OPCODE._OP_CLIENT_REQ_GATEWAY_PING);this.mConnection.send(t),this.mClock.sync(-1)},World.prototype.playSound=function(t){this.mSoundManager.play(t)},Object.defineProperty(World.prototype,"uiScale",{get:function(){return this.mUIScale},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"uiRatio",{get:function(){return this.mUIRatio},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"scaleRatio",{get:function(){return this.mScaleRatio},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"game",{get:function(){return this.mGame},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"roomManager",{get:function(){return this.mRoomMamager},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"orientation",{get:function(){return this.mOrientation},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"elementStorage",{get:function(){return this.mElementStorage},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"uiManager",{get:function(){return this.mUiManager},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"mouseManager",{get:function(){return this.mMouseManager},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"inputManager",{get:function(){return this.mInputManager},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"connection",{get:function(){return this.mConnection},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"clock",{get:function(){return this.mClock},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"httpClock",{get:function(){return this.mHttpClock},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"emitter",{get:function(){return this.mGameEmitter},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"httpService",{get:function(){return this.mHttpService},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"account",{get:function(){return this.mAccount},enumerable:!1,configurable:!0}),Object.defineProperty(World.prototype,"user",{get:function(){return this.mUser},enumerable:!1,configurable:!0}),World.prototype.enableClick=function(){this.game&&this.mRoomMamager&&this.mRoomMamager.currentRoom&&this.mRoomMamager.currentRoom.scene&&this.mRoomMamager.currentRoom.scene.input&&(this.mRoomMamager.currentRoom.scene.input.enabled=!0)},World.prototype.disableClick=function(){this.game&&this.mRoomMamager&&this.mRoomMamager.currentRoom&&this.mRoomMamager.currentRoom.scene&&this.mRoomMamager.currentRoom.scene.input&&(this.mRoomMamager.currentRoom.scene.input.enabled=!1)},World.prototype.exitUser=function(){this.mConfig.token_expire=this.mConfig.token_fingerprint=this.mConfig.user_id=this.mConfig.auth_token=null,this.mAccount&&this.mAccount.destroy(),this._createAnotherGame(this.mConfig.game_id,this.mConfig.virtual_world_id,null,null)},World.prototype.showLoading=function(){return this.mLoadingManager.start()},World.prototype.getGameConfig=function(){return this.gameConfig},World.prototype.onClockReady=function(){this.mInputManager&&(this.mInputManager.enable=!0)},World.prototype.onFocus=function(){if(p.a.getInstance().log("#BlackSceneFromBackground; world.onFocus()"),this.connection){var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);t.content.gameStatus=c.op_def.GameStatus.Focus,this.connection.send(t),this.mClock.sync(-1)}else p.a.getInstance().error("connection is undefined");this.resumeScene()},World.prototype.onBlur=function(){if(p.a.getInstance().log("#BlackSceneFromBackground; world.onBlur()"),this.connection){var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);t.content.gameStatus=c.op_def.GameStatus.Blur,this.connection.send(t)}else p.a.getInstance().error("connection is undefined");this.pauseScene()},World.prototype.initgameConfigUrls=function(t){for(var i=0,o=t;i<o.length;i++){var r=o[i],a=x.a.baseName(r);this.gameConfigUrls.set(a,r),3===r.split(a).length&&(this.gameConfigUrl=r)}},World.prototype.getConfigUrl=function(t){return this.gameConfigUrls.get(t)},World.prototype.loadSceneConfig=function(t){var i=this.getConfigUrl(t);return this.mLoadingManager.start(L.a.downloadSceneConfig()),this.loadGameConfig(i)},World.prototype.createGame=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){switch(i.label){case 0:return this._newGame(),this.mGame.events.on(Phaser.Core.Events.BLUR,this.onBlur,this),this.moveStyle===c.op_def.MoveStyle.DIRECTION_MOVE_STYLE||1===this.moveStyle?this.mGame.device.os.desktop?this.mInputManager=new m.a(this,t):this.mInputManager=new g.a(this,t):this.mGame.device.os.desktop&&(this.mInputManager=new m.a(this,t)),this.mInputManager&&(this.mInputManager.enable=!1),window.screen.width>window.screen.height?this.mConfig.width>this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width):this.mConfig.width<this.mConfig.height?this.resize(this.mConfig.width,this.mConfig.height):this.resize(this.mConfig.height,this.mConfig.width),[4,this.mLoadingManager.addAssets(this.mElementStorage.getAssets())];case 1:return i.sent(),this.gameCreated(),[2]}}))}))},World.prototype.enterGame=function(){this.loginEnterWorld(),this.mGame.scene.remove(S.a.name),this.uiManager.destroy(),this.uiManager.addPackListener(),this.mLoadingManager.start(L.a.enterGame())},World.prototype._createAnotherGame=function(t,i,o,r){var a=this;this.clearGame().then((function(){a.isPause=!1,a.mConnection&&a.mConnection.closeConnect(),a.mClock&&(a.mClock.destroy(),a.mClock=null),a.mAccount&&a.mAccount.enterGame(t,i,o,r),a.mConnection.addPacketListener(a);var h=a.mConfig.server_addr||Object({host:"gdev.tooqing.com",port:11100,secure:!0});h&&a.mConnection.startConnect(h),a.mClock=new O.a(a.mConnection,a),a._newGame(),a.mGame.scene.getScene(S.a.name)&&a.mGame.scene.remove(S.a.name),a.mLoadingManager.start().then((function(){a.reconnectIng=!1}))}))},World.prototype.onFullScreenChange=function(){this.resize(this.mGame.scale.gameSize.width,this.mGame.scale.gameSize.height)},World.prototype.onSelectCharacter=function(){var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_CHARACTER_CREATED);this.connection.send(t);var i=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SET_LOCALE);i.content.localeCode=M.a.language,this.connection.send(i),this.user.bag.querySYNC_ALL_PACKAGE()},World.prototype.clearGame=function(t){var i=this;return new Promise((function(o,r){i.mClock&&(i.mClock.destroy(),i.mClock=null),i.mGame?(i.mGame.events.off(Phaser.Core.Events.BLUR,i.onBlur,i),i.mGame.scale.off("enterfullscreen",i.onFullScreenChange,i),i.mGame.scale.off("leavefullscreen",i.onFullScreenChange,i),i.mGame.scale.off("orientationchange",i.onOrientationChange,i),i.mGame.plugins.removeGlobalPlugin("rexButton"),i.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin"),i.mGame.plugins.removeGlobalPlugin("rexInputText"),i.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin"),i.mGame.plugins.removeGlobalPlugin("rexMoveTo"),i.mGame.plugins.removeScenePlugin("DragonBones"),i.mGameEmitter.destroy(),i.roomManager.destroy(),i.uiManager.destroy(),i.mElementStorage.destroy(),i.mLoadingManager.destroy(),i.game.scene.destroy(),i.user.clear(),i.mGame.events.once(Phaser.Core.Events.DESTROY,(function(){i.mGame=void 0,t&&t(),o()})),i.mGame.destroy(!0)):o()}))},World.prototype.heartBeatCallBack=function(){this.mConnection.clearHeartBeat()},World.prototype.login=function(){var t=this;this.mGame.scene.getScene(S.a.name)||this.mGame.scene.add(S.a.name,S.a),this.mGame.scene.start(S.a.name,{connect:this.mConnection,world:this,callBack:function(){t.enterGame()}})},World.prototype.orientationResize=function(t,i,o,r){this.mGame&&(o<r?(this.mGame.scale.orientation=Phaser.Scale.Orientation.PORTRAIT,this.isFullStart||p.a.getInstance().log("竖版"+this.mGame.scale.orientation)):(this.mGame.scale.orientation=Phaser.Scale.Orientation.LANDSCAPE,this.isFullStart||p.a.getInstance().log("横版"+this.mGame.scale.orientation)),this.mGame.scale.resize(t,i),p.a.getInstance().log("orientation"+this.mGame.scale.orientation)),this.mRoomMamager&&this.mRoomMamager.resize(o,r),this.mUiManager&&this.mUiManager.resize(o,r),this.mInputManager&&this.mInputManager.resize(o,r)},World.prototype.enterVirtualWorld=function(){var t=this;if(this.mGame){if(this.gameState=h.a.LOGIN,this.mConfig&&this.mConnection){var i=localStorage.getItem("token"),o=i?JSON.parse(i):null;if(this.mConfig.auth_token)this.mAccount.setAccount({token:this.mConfig.auth_token,expire:this.mConfig.token_expire,fingerprint:this.mConfig.token_fingerprint,refreshToken:o?o.refreshToken:"",id:this.mConfig.user_id?this.mConfig.user_id:o?o.id:""}),this.loginEnterWorld();else{if(!o)return void this.login();this.mAccount.setAccount(o),this.httpService.refreshToekn(o.refreshToken,o.accessToken).then((function(i){200===i.code?(t.mAccount.refreshToken(i),t.loginEnterWorld()):t.login()}))}}}else this.reconnect()},World.prototype.loginEnterWorld=function(){return __awaiter(this,void 0,void 0,(function(){var t,i,o,r,a,h;return __generator(this,(function(u){return this.mLoadingManager.start(L.a.enterGame()),t=new l.PBpacket(c.op_gateway.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PLAYER_INIT),i=t.content,o=this.mConfig.game_id,r=this.mConfig.virtual_world_id,a=null,h=null,this.mAccount&&this.mAccount.gameID&&void 0!==this.mAccount&&(o=this.mAccount.gameID,r=this.mAccount.virtualWorldId,a=this.mAccount.sceneId,h=this.mAccount.loc),i.virtualWorldUuid=r,this.mConfig.game_id&&this.mAccount&&this.mAccount.accountData&&this.mAccount.accountData.accessToken&&this.mAccount.accountData.expire&&this.mAccount.accountData.fingerprint?(i.gameId=o,i.userToken=this.mConfig.auth_token=this.mAccount.accountData.accessToken,i.expire=this.mConfig.token_expire=this.mAccount.accountData.expire+"",i.fingerprint=this.mConfig.token_fingerprint=this.mAccount.accountData.fingerprint,i.sceneId=a,i.loc=h,this.mConnection.send(t),[2]):(this.mGame&&this.mGame.destroy(!0),[2])}))}))},World.prototype.onInitVirtualWorldPlayerInit=function(t){var i=this,o=t.content,r=o.configUrls;if(this.mMoveStyle=o.moveStyle,this.clock.sync(-1),this.initgameConfigUrls(r),!r||r.length<=0)return p.a.getInstance().error("configUrls error: , "+r+", gameId: "+this.mAccount.gameID),void this.createGame(o.keyEvents);p.a.getInstance().log("mMoveStyle:"+o.moveStyle);var a=this.mAccount.gameID;a.indexOf(".")>-1&&(a=a.split(".")[1]);var h=this.gameConfigUrl;this.mLoadingManager.start(L.a.downloadGameConfig()),this.loadGameConfig(h).then((function(t){i.mElementStorage.setGameConfig(t),i.createGame(o.keyEvents),p.a.getInstance().debug("created game suc")})).catch((function(t){p.a.getInstance().log(t)}))},World.prototype._newGame=function(){return this.mGame||(p.a.getInstance().log("dragonbones: ",dragonBones),this.gameConfig={type:Phaser.AUTO,parent:this.mConfig.parent||"game",scene:null,disableContextMenu:!0,transparent:!1,backgroundColor:0,resolution:1,fps:{target:60,forceSetTimeOut:!0},dom:{createContainer:!0},plugins:{scene:[{key:"DragonBones",plugin:dragonBones.phaser.plugin.DragonBonesScenePlugin,mapping:"dragonbone"}]},render:{pixelArt:!0,roundPixels:!0},scale:{mode:Phaser.Scale.NONE,width:this.mConfig.width*window.devicePixelRatio,height:this.mConfig.height*window.devicePixelRatio,zoom:1/window.devicePixelRatio}},Object.assign(this.gameConfig,this.mConfig),this.mGame=new a.Game(this.gameConfig),this.mGame.input.mouse.capture=!0,this.mGame.device.os.desktop&&(this.mUIScale=1),this.mRoomMamager&&this.mRoomMamager.addPackListener(),this.mUiManager&&this.mUiManager.addPackListener(),this.mRoleManager&&this.mRoleManager.register(),this.mSoundManager&&this.mSoundManager.addPackListener(),this.user&&this.user.addPackListener(),this.mElementStorage&&this.mElementStorage.on("SCENE_PI_LOAD_COMPELETE",this.loadSceneConfig)),this.mGame},World.prototype.gameCreated=function(){if(this.connection){this.mLoadingManager.start(L.a.waitEnterRoom());var t=new l.PBpacket(c.op_virtual_world.OPCODE._OP_CLIENT_REQ_GATEWAY_GAME_CREATED);this.connection.send(t),this.mCallBack&&this.mCallBack(),this.mConfig.game_created&&this.mConfig.game_created()}this.mGame.scale.on("enterfullscreen",this.onFullScreenChange,this),this.mGame.scale.on("leavefullscreen",this.onFullScreenChange,this)},World.prototype.loadGameConfig=function(t){var i=this,o=b.g.getGameConfig(t);return Object(v.a)(o,"arraybuffer").then((function(t){return p.a.getInstance().log("start decodeConfig"),i.mLoadingManager.start(L.a.parseConfig()),i.decodeConfigs(t)}))},World.prototype.decodeConfigs=function(t){return new Promise((function(i,o){var r=t.response;if(r)try{var a=new P.Lite;a.deserialize(new Uint8Array(r)),p.a.getInstance().log("TCL: World -> gameConfig",a),i(a)}catch(t){o(t)}else o("error")}))},World.prototype.resumeScene=function(){if(p.a.getInstance().log("#BlackSceneFromBackground; world.resumeScene(); isEditor:"+this.mConfig.isEditor+"; isPause:"+this.isPause+"; mGame:"+this.mGame),!this.mConfig.isEditor&&this.isPause&&(this.isPause=!1,this.mGame)){if(!this.mConnection.isConnect)return this.mConfig.connectFail?this.mConfig.connectFail():this.onDisConnected();this.mConnection.onFocus(),this.mRoomMamager.onFocus();var t=this.mGame.scene.getScene(k.a.name);t&&(t.sleep(),this.mGame.scene.stop(k.a.name))}},World.prototype.pauseScene=function(){p.a.getInstance().log("#BlackSceneFromBackground; world.pauseScene(); isEditor:"+this.mConfig.isEditor+"; isPause:"+this.isPause+"; mGame:"+this.mGame),this.mConfig.isEditor||this.isPause||(this.isPause=!0,this.mGame&&(this.mConnection.onBlur(),this.mRoomMamager.onBlur(),this.mGame.scene.getScene(k.a.name)||this.mGame.scene.add(k.a.name,k.a),this.mGame.scene.start(k.a.name,{world:this})))},World.SCALE_CHANGE="scale_change",World}(l.PacketHandler)}.call(this,"/")}])]);