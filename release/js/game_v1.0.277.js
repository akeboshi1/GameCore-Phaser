/*! For license information please see game_v1.0.277.js.LICENSE.txt */
(this.webpackJsonpTooqingCore=this.webpackJsonpTooqingCore||[]).push([["game"],{"../game-capsule/dist/index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst capsule_1 = __webpack_require__(/*! ./lib/capsule */ "../game-capsule/dist/lib/capsule.js");\r\nexports.Capsule = capsule_1.default;\r\nconst constants_1 = __webpack_require__(/*! ./lib/constants */ "../game-capsule/dist/lib/constants.js");\r\nexports.Constants = constants_1.default;\r\nconst lite_1 = __webpack_require__(/*! ./lib/lite */ "../game-capsule/dist/lib/lite.js");\r\nexports.Lite = lite_1.default;\r\nconst helpers_1 = __webpack_require__(/*! ./lib/helpers */ "../game-capsule/dist/lib/helpers.js");\r\nexports.Helpers = helpers_1.default;\r\nvar animations_1 = __webpack_require__(/*! ./lib/configobjects/animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nexports.AnimationLayer = animations_1.AnimationLayer;\r\nexports.AnimationMountLayer = animations_1.AnimationMountLayer;\r\n__export(__webpack_require__(/*! ./lib/configobjects */ "../game-capsule/dist/lib/configobjects/index.js"));\r\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/index.js?')},"../game-capsule/dist/lib/capsule.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nconst config_object_factory_1 = __webpack_require__(/*! ./config_object_factory */ "../game-capsule/dist/lib/config_object_factory.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst children_index_1 = __webpack_require__(/*! ./children_index */ "../game-capsule/dist/lib/children_index.js");\r\nconst ConfigObjects = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst configobjects_1 = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst constants_1 = __webpack_require__(/*! ./constants */ "../game-capsule/dist/lib/constants.js");\r\nconst treeify = __webpack_require__(/*! treeify */ "../game-capsule/node_modules/treeify/treeify.js");\r\nvar Game = pixelpai_proto_1.op_gameconfig_01.Game;\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass Capsule extends children_index_1.default {\r\n    constructor() {\r\n        super();\r\n        // 缓存同族对象的源对象。\r\n        // 源对象指具有相同基因序列的第一个ConfigObject。\r\n        this._families = new Map();\r\n        this._ignore_serialize = new Map();\r\n        // initialize the factory.\r\n        this.add = new config_object_factory_1.default(this);\r\n        // initialize the only game node.\r\n        this._root = new configobjects_1.GameNode(this);\r\n    }\r\n    resetPreprocessedData() {\r\n        this._families.clear();\r\n        this._ignore_serialize.clear();\r\n    }\r\n    get families() {\r\n        return this._families;\r\n    }\r\n    get ignoreList() {\r\n        return this._ignore_serialize;\r\n    }\r\n    serialize() {\r\n        if (!this._root)\r\n            throw new Error(`Capsule::serialize() Error: Empty root node, aka GameNode.`);\r\n        const game = (this._bin_conf = Game.create());\r\n        // 1. serialize root node also known as GameNode first.\r\n        this._root.serialize(game);\r\n        // 2-1. pre-serialize\r\n        this.resetPreprocessedData();\r\n        this._objects.forEach((object) => {\r\n            object.preSerialize();\r\n        });\r\n        // 2-2. serialize all other objects.\r\n        this._objects.forEach((object) => {\r\n            if (!this._ignore_serialize.get(object.id))\r\n                object.serialize(game);\r\n        });\r\n        // 3. return binConfig buffer.\r\n        const buffer = Game.encode(this._bin_conf).finish();\r\n        return buffer;\r\n    }\r\n    serializeScene(sceneId) {\r\n        if (!this._root)\r\n            throw new Error(`Capsule::serialize() Error: Empty root node, aka GameNode.`);\r\n        const game = (this._bin_conf = Game.create());\r\n        const sceneNode = this._objects.get(sceneId);\r\n        if (sceneNode) {\r\n            const id = sceneNode.parent;\r\n            const name = sceneNode.name;\r\n            game.node = new (class {\r\n                constructor() {\r\n                    this.LockParent = null;\r\n                    this.Parent = 0;\r\n                    this.id = id;\r\n                    this.name = name;\r\n                    this.type = pixelpai_proto_1.op_def.NodeType.GameNodeType;\r\n                }\r\n            })();\r\n            const sceneReleatedObjects = this.iterateGetObjects(sceneNode);\r\n            // 2-1. pre-serialize\r\n            this.resetPreprocessedData();\r\n            sceneReleatedObjects.forEach((object) => {\r\n                object.preSerialize();\r\n            });\r\n            // 2-2. serialize all other objects.\r\n            sceneReleatedObjects.forEach((object) => {\r\n                if (!this._ignore_serialize.get(object.id))\r\n                    object.serialize(game);\r\n            });\r\n        }\r\n        const buffer = Game.encode(this._bin_conf).finish();\r\n        return buffer;\r\n    }\r\n    serializeRoot() {\r\n        if (!this._root)\r\n            throw new Error(`Capsule::serialize() Error: Empty root node, aka GameNode.`);\r\n        const game = (this._bin_conf = Game.create());\r\n        this._root.serialize(game);\r\n        this.resetPreprocessedData();\r\n        const needSerializeObjs = Array.from(this._objects.values()).filter((object) => {\r\n            return (object.type !== pixelpai_proto_1.op_def.NodeType.SceneNodeType &&\r\n                object.parent === this._root.id &&\r\n                !this._ignore_serialize.get(object.id));\r\n        });\r\n        this.iterateSerialize(needSerializeObjs, game);\r\n        this._terrain_objects.forEach((object) => {\r\n            if (!this._ignore_serialize.get(object.id))\r\n                object.serialize(game);\r\n        });\r\n        this._element_objects.forEach((object) => {\r\n            if (!this._ignore_serialize.get(object.id)) {\r\n                object.serialize(game);\r\n            }\r\n        });\r\n        const buffer = Game.encode(this._bin_conf).finish();\r\n        return buffer;\r\n    }\r\n    iterateSerialize(objs, game) {\r\n        for (const obj of objs) {\r\n            obj.serialize(game);\r\n            if (obj.children && obj.children.length > 0) {\r\n                this.iterateSerialize(obj.children, game);\r\n            }\r\n        }\r\n    }\r\n    iterateGetObjects(parentNode, ret = []) {\r\n        if (parentNode) {\r\n            ret.push(parentNode);\r\n            if (parentNode.children && parentNode.children.length > 0) {\r\n                for (const childNode of parentNode.children) {\r\n                    this.iterateGetObjects(childNode, ret);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    deserialize(buffer) {\r\n        const message = Game.decode(buffer);\r\n        const obj = Game.toObject(message);\r\n        const delayDeserialize = [];\r\n        // 1. deserialize game\r\n        this._root.deserialize(message);\r\n        this._root.preDeserializePalettes(message);\r\n        // 2-1. deserialize other objects.\r\n        for (const key of Object.keys(obj)) {\r\n            if (key === "scenes") {\r\n                continue;\r\n            }\r\n            if (key === "terrain") {\r\n                this.doDeserialize(obj[key]);\r\n            }\r\n            if (key === "mossList") {\r\n                this.doDeserialize(obj[key]);\r\n            }\r\n            const arr = obj[key];\r\n            if (Array.isArray(arr)) {\r\n                for (let proto of arr) {\r\n                    const nodeType = proto.node.type;\r\n                    if (nodeType == NodeType.ForkType) {\r\n                        // Fork 节点放到最后反序列化，确保他的parent先被加到树中。\r\n                        delayDeserialize.push(proto);\r\n                    }\r\n                    else {\r\n                        this.doDeserialize(proto);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // 2-2. deserialize all Fork objects\r\n        for (const proto of delayDeserialize) {\r\n            this.doDeserialize(proto);\r\n        }\r\n        // 2-3. Link all ConfigObjects\r\n        this._objects.forEach((object) => {\r\n            object.link();\r\n        });\r\n        this._root.deserializePalettes(message);\r\n    }\r\n    doDeserialize(protocolObj) {\r\n        if (protocolObj.hasOwnProperty("node")) {\r\n            const nodeType = protocolObj["node"].type;\r\n            const nodeConstructor = constants_1.default.NODE_T[nodeType] || "";\r\n            if (ConfigObjects.hasOwnProperty(nodeConstructor)) {\r\n                // @ts-ignore\r\n                const node = new ConfigObjects[nodeConstructor](this);\r\n                node.deserialize(protocolObj);\r\n            }\r\n        }\r\n    }\r\n    get root() {\r\n        return this._root;\r\n    }\r\n    getObjectBySN(sn) {\r\n        for (const object of this.objectsList) {\r\n            if (sn === object.sn) {\r\n                return object;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n    getAllChildrenIds(node) {\r\n        let ret = [];\r\n        const walkTree = (tree) => {\r\n            if (tree.children && tree.children.length > 0) {\r\n                for (let child of tree.children) {\r\n                    ret.push(child.id);\r\n                    walkTree(child);\r\n                }\r\n            }\r\n        };\r\n        walkTree(node);\r\n        return ret;\r\n    }\r\n    // 在保存到我的素材功能中，导入的是展开的节点，这时需要将存在父子关系的objects去重\r\n    deduplicateNodes(nodes) {\r\n        let nodesMap = {};\r\n        for (let node of nodes) {\r\n            node.ids = this.getAllChildrenIds(node);\r\n            nodesMap[node.id] = node;\r\n        }\r\n        for (let node of nodes) {\r\n            for (let id of node.ids) {\r\n                if (nodesMap[id]) {\r\n                    delete nodesMap[id];\r\n                }\r\n            }\r\n        }\r\n        return Object.values(nodesMap);\r\n    }\r\n    emptyObjectCap(objects) {\r\n        objects.forEach((obj) => {\r\n            obj.cap.families.clear();\r\n            if (obj.children && obj.children.length > 0) {\r\n                this.emptyObjectCap(obj.children);\r\n            }\r\n        });\r\n    }\r\n    // 从当前的Capsule中导出Nodes\r\n    export(objects) {\r\n        objects = this.deduplicateNodes(objects);\r\n        this.emptyObjectCap(objects);\r\n        const newCap = new Capsule();\r\n        const travel = (node, parent) => {\r\n            const newNode = _.clone(node);\r\n            if (parent)\r\n                newNode.parent = parent;\r\n            newCap.addObject(newNode);\r\n            for (const child of node.children) {\r\n                travel(child);\r\n            }\r\n        };\r\n        for (const object of objects) {\r\n            travel(object, newCap.root.id);\r\n        }\r\n        return newCap;\r\n    }\r\n    importScene(src) {\r\n        for (const obj of src.objectsList) {\r\n            if (obj.parent === src.root.id) {\r\n                obj.parent = this.root.id;\r\n            }\r\n            obj.cap = this;\r\n            this.addObject(obj);\r\n        }\r\n    }\r\n    // 从外部Capsule中导入Nodes\r\n    import(src, newId, disTarget, returnAll = false) {\r\n        const sourceCapsule = new Capsule();\r\n        sourceCapsule.deserialize(src.serialize());\r\n        for (const obj of sourceCapsule.objectsList) {\r\n            if (obj.parent === sourceCapsule.root.id) {\r\n                obj.parent = (disTarget || this.root).id;\r\n                obj.renewId(newId);\r\n            }\r\n            obj.cap = this;\r\n            this.addObject(obj);\r\n        }\r\n        // 给我一个父节点对象，如果不给我将挂载到GameNode上\r\n        // const parentObj: IConfigObject = disTarget || this.root;\r\n        // for (const obj of sourceCapsule.objectsList) {\r\n        //     // 如果obj的parent === src.root.id\r\n        //     // 把它改为新的parent\r\n        //     if (obj.parent === sourceCapsule.root.id) {\r\n        //         obj.parent = parentObj.id;\r\n        //     }\r\n        //     obj.cap = this;\r\n        //     this.addObject(obj);\r\n        // }\r\n        // 将顶级节点导出\r\n        const importList = this.walkTopLevelNode(sourceCapsule.root.children, returnAll);\r\n        return importList;\r\n    }\r\n    walkTopLevelNode(nodes, returnAll = false) {\r\n        let ret = [];\r\n        for (const node of nodes) {\r\n            ret.push(node.id);\r\n            if (node.children && node.children.length) {\r\n                if (returnAll) {\r\n                    this.walkTopLevelNode(node.children, returnAll);\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    // 用于在同一个Capsule中克隆ConfigObject\r\n    // 将会获得一个新的Node，如果此Node有子节点会同样克隆子节点\r\n    clone(src_id, parent, cloneFork = false) {\r\n        const origin = this.getObject(src_id);\r\n        if (!origin) {\r\n            console.error(`Origin object[${src_id}] does not exist.`);\r\n            return;\r\n        }\r\n        // @ts-ignore\r\n        const dolly = new ConfigObjects[origin.className](this);\r\n        dolly.parentObject = parent;\r\n        dolly.duplicate(origin);\r\n        this.addObject(dolly);\r\n        // 遍历克隆对象的子节点，克隆\r\n        for (const child of origin.children) {\r\n            if (child instanceof configobjects_1.ForkNode && !cloneFork)\r\n                continue;\r\n            const son = this.clone(child.id, dolly);\r\n            if (son)\r\n                son.link();\r\n        }\r\n        return dolly;\r\n    }\r\n    inspect() {\r\n        const self = this;\r\n        const printTree = function (id) {\r\n            const obj = self.getObject(id);\r\n            if (!obj) {\r\n                return;\r\n            }\r\n            let out = {};\r\n            for (const child of obj.children) {\r\n                out[`${child.className}[${child.id}]`] = printTree(child.id);\r\n            }\r\n            return out;\r\n        };\r\n        const cap = {};\r\n        cap[`${self.root.className}[${self.root.id}]`] = printTree(self.root.id);\r\n        console.log(`Capsule`);\r\n        console.log(treeify.asTree(cap, true, true));\r\n    }\r\n    destroy() {\r\n        this._root.destroy();\r\n        this._objects.forEach((obj, index) => {\r\n            obj.destroy();\r\n        });\r\n    }\r\n}\r\nexports.default = Capsule;\r\n//# sourceMappingURL=capsule.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/capsule.js?')},"../game-capsule/dist/lib/children_index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nclass ChildrenIndex {\r\n    constructor() {\r\n        this._objects = new Map();\r\n        this._terrain_objects = new Map();\r\n        this._element_objects = new Map();\r\n        this._branch_cache = new Map();\r\n    }\r\n    getChildrenList(parent) {\r\n        // const arr = Array.from<IConfigObject>(this._objects.values());\r\n        const branch = this._branch_cache.get(parent);\r\n        if (branch) {\r\n            return Array.from(branch.values());\r\n            // return Array.from(branch.values()).filter(\r\n            //     (o: IConfigObject) => parent === o.parent\r\n            // );\r\n        }\r\n        return [];\r\n    }\r\n    addTerrainMaterial(obj) {\r\n        if (!obj) {\r\n            throw new Error("Empty Object.");\r\n        }\r\n        this._terrain_objects.set(obj.id, obj);\r\n    }\r\n    addElementMaterial(obj) {\r\n        if (!obj) {\r\n            throw new Error("Empty Object.");\r\n        }\r\n        this._element_objects.set(obj.geneSequence(), obj);\r\n    }\r\n    addObject(obj) {\r\n        if (!obj) {\r\n            throw new Error(`Empty Object.`);\r\n        }\r\n        // add to this._objects\r\n        this._objects.set(obj.id, obj);\r\n        // link to parent.\r\n        // 如果是fork则不需要link到parent node\r\n        if (!obj.isFork) {\r\n            obj.link();\r\n        }\r\n        // add to cache\r\n        if (!this._branch_cache.has(obj.parent)) {\r\n            this._branch_cache.set(obj.parent, new Map());\r\n        }\r\n        const branch = this._branch_cache.get(obj.parent);\r\n        if (branch)\r\n            branch.set(obj.id, obj);\r\n    }\r\n    removeObject(obj) {\r\n        if (!obj) {\r\n            throw new Error(`Empty Object.`);\r\n        }\r\n        // 1. remove object from parent as member property.\r\n        obj.unlink();\r\n        // 2. remove object from tree.\r\n        this._objects.delete(obj.id);\r\n        // 3. remove from cache\r\n        const branch = this._branch_cache.get(obj.parent);\r\n        if (branch) {\r\n            branch.delete(obj.id);\r\n        }\r\n    }\r\n    removeObjectById(id) {\r\n        this._objects.delete(id);\r\n    }\r\n    setObject(id, node) {\r\n        this._objects.set(id, node);\r\n    }\r\n    getObject(childOrParentId) {\r\n        return this._objects.get(childOrParentId);\r\n    }\r\n    getElementMaterial(gen) {\r\n        return this._element_objects.get(gen);\r\n    }\r\n    getElementMeterials() {\r\n        return Array.from(this._element_objects.values());\r\n    }\r\n    getTerrainMaterial(id) {\r\n        return this._terrain_objects.get(id);\r\n    }\r\n    get objectsList() {\r\n        return Array.from(this._objects.values());\r\n    }\r\n}\r\nexports.default = ChildrenIndex;\r\n//# sourceMappingURL=children_index.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/children_index.js?')},"../game-capsule/dist/lib/config_object_factory.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst configobjects_1 = __webpack_require__(/*! ./configobjects */ "../game-capsule/dist/lib/configobjects/index.js");\r\nconst scene_1 = __webpack_require__(/*! ./configobjects/scene */ "../game-capsule/dist/lib/configobjects/scene.js");\r\nconst character_1 = __webpack_require__(/*! ./configobjects/character */ "../game-capsule/dist/lib/configobjects/character.js");\r\nconst terrain_1 = __webpack_require__(/*! ./configobjects/terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nconst package_1 = __webpack_require__(/*! ./configobjects/package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nconst location_1 = __webpack_require__(/*! ./configobjects/location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nconst shop_1 = __webpack_require__(/*! ./configobjects/shop */ "../game-capsule/dist/lib/configobjects/shop.js");\r\nconst scenery_1 = __webpack_require__(/*! ./configobjects/scenery */ "../game-capsule/dist/lib/configobjects/scenery.js");\r\nclass ConfigObjectFactory {\r\n    constructor(_cap) {\r\n        this._cap = _cap;\r\n    }\r\n    element(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const entity = new configobjects_1.ElementNode(this._cap, parentNode);\r\n        this._cap.addObject(entity);\r\n        return entity;\r\n    }\r\n    spawnpoint(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const spawnpoint = new configobjects_1.SpawnPointNode(this._cap, parentNode);\r\n        this._cap.addObject(spawnpoint);\r\n        return spawnpoint;\r\n    }\r\n    terrain(parent) {\r\n        const parentNode = parent || this._cap.root;\r\n        const t = new terrain_1.TerrainNode(this._cap, parentNode);\r\n        this._cap.addObject(t);\r\n        return t;\r\n    }\r\n    attr(parent) {\r\n        const attr = new configobjects_1.AttributeNode(this._cap, parent);\r\n        this._cap.addObject(attr);\r\n        return attr;\r\n    }\r\n    func(parent) {\r\n        const func = new configobjects_1.FunctionNode(this._cap, parent);\r\n        this._cap.addObject(func);\r\n        return func;\r\n    }\r\n    event(parent) {\r\n        const event = new configobjects_1.EventNode(this._cap, parent);\r\n        this._cap.addObject(event);\r\n        return event;\r\n    }\r\n    ui(parent) {\r\n        const ui = new configobjects_1.UINode(this._cap, parent);\r\n        this._cap.addObject(ui);\r\n        return ui;\r\n    }\r\n    // now time we only link timer to the game object.\r\n    timer(parent) {\r\n        const timer = new configobjects_1.TimerNode(this._cap, parent);\r\n        this._cap.addObject(timer);\r\n        return timer;\r\n    }\r\n    scene(rows, cols, name) {\r\n        const scene = new scene_1.default(this._cap, this._cap.root);\r\n        if (name) {\r\n            scene.name = name;\r\n        }\r\n        this._cap.addObject(scene);\r\n        const size = new configobjects_1.MapSizeNode(this._cap, scene);\r\n        size.rows = rows;\r\n        size.cols = cols;\r\n        this._cap.addObject(size);\r\n        const tc = new scene_1.TerrainCollectionNode(this._cap, scene);\r\n        tc.initTerrainCollection(rows, cols);\r\n        this._cap.addObject(tc);\r\n        const mc = new scene_1.MossCollectionNode(this._cap, scene);\r\n        this._cap.addObject(mc);\r\n        return scene;\r\n    }\r\n    scenery(parent) {\r\n        const scenery = new scenery_1.default(this._cap, parent);\r\n        this._cap.addObject(scenery);\r\n        return scenery;\r\n    }\r\n    character() {\r\n        const c = new character_1.default(this._cap, this._cap.root);\r\n        this._cap.addObject(c);\r\n        const camp = this.camp(1, c);\r\n        this._cap.addObject(camp);\r\n        const avatar = new configobjects_1.AvatarNode(this._cap, c);\r\n        this._cap.addObject(avatar);\r\n        return c;\r\n    }\r\n    camp(max_players, parent) {\r\n        const ca = new configobjects_1.CampNode(this._cap, parent);\r\n        ca.maxPlayers = max_players;\r\n        this._cap.addObject(ca);\r\n        return ca;\r\n    }\r\n    package(parent) {\r\n        const pkg = new package_1.default(this._cap, parent);\r\n        this._cap.addObject(pkg);\r\n        return pkg;\r\n    }\r\n    packageItem(parent) {\r\n        const pkgItem = new package_1.PackageItemNode(this._cap, parent);\r\n        this._cap.addObject(pkgItem);\r\n        return pkgItem;\r\n    }\r\n    animationdata(parent, name) {\r\n        if (!parent) {\r\n            return;\r\n        }\r\n        if (name && parent.checkSameName(name)) {\r\n            throw Error("重复的动画名称");\r\n        }\r\n        const ani = new configobjects_1.AnimationDataNode(this._cap, parent);\r\n        if (name)\r\n            ani.name = name;\r\n        this._cap.addObject(ani);\r\n        return ani;\r\n    }\r\n    animations(parent) {\r\n        const ani = new configobjects_1.AnimationsNode(this._cap, parent);\r\n        this._cap.addObject(ani);\r\n        ani.link();\r\n        return ani;\r\n    }\r\n    location(parent) {\r\n        const lo = new location_1.default(this._cap, parent);\r\n        this._cap.addObject(lo);\r\n        return lo;\r\n    }\r\n    display(parent) {\r\n        const display = new configobjects_1.DisplayNode(this._cap, parent);\r\n        this._cap.addObject(display);\r\n        return display;\r\n    }\r\n    shop(parent) {\r\n        const pkg = new shop_1.default(this._cap, parent);\r\n        this._cap.addObject(pkg);\r\n        return pkg;\r\n    }\r\n    shopItem(parent) {\r\n        const item = new shop_1.ShopItemNode(this._cap, parent);\r\n        this._cap.addObject(item);\r\n        return item;\r\n    }\r\n    commodity(parent) {\r\n        const com = new shop_1.CommodityNode(this._cap, parent);\r\n        this._cap.addObject(com);\r\n        return com;\r\n    }\r\n}\r\nexports.default = ConfigObjectFactory;\r\n//# sourceMappingURL=config_object_factory.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/config_object_factory.js?')},"../game-capsule/dist/lib/configobjects/access.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass AccessNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._access = 1;\r\n        this.name = "权限";\r\n    }\r\n    get properties() {\r\n        return {\r\n            access: this._access,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.access)) {\r\n            game.access = [];\r\n        }\r\n        return game.access;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Access.create();\r\n        obj.node = this.makeNode();\r\n        obj.access = this._access;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._access = obj.access;\r\n    }\r\n}\r\nexports.AccessNode = AccessNode;\r\n//# sourceMappingURL=access.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/access.js?')},"../game-capsule/dist/lib/configobjects/animations.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst display_1 = __webpack_require__(/*! ./display */ "../game-capsule/dist/lib/configobjects/display.js");\r\nclass AnimationsNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._defaultAnimation = "idle";\r\n        this._data_map = new Map();\r\n        this._editorToolType = 0;\r\n        this.name = "动画";\r\n    }\r\n    get properties() {\r\n        return {\r\n            dir: this._dir,\r\n            defaultAnimation: this._defaultAnimation,\r\n        };\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.animations)) {\r\n            game.animations = [];\r\n        }\r\n        return game.animations;\r\n    }\r\n    createProtocolObject() {\r\n        const animations = pixelpai_proto_1.op_gameconfig_01.Animations.create();\r\n        animations.node = super.makeNode();\r\n        animations.dir = this._dir;\r\n        animations.defaultAnimation = this._defaultAnimation;\r\n        animations.scale = this._scale;\r\n        return animations;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._defaultAnimation = as.defaultAnimation;\r\n        this._scale = as.scale;\r\n        this._dir = this._scale ? 5 : as.dir || 3;\r\n    }\r\n    importSprite(sprite) {\r\n        const display = sprite.display;\r\n        if (display) {\r\n            this.setDisplayPath(display.texturePath || "", display.dataPath || "");\r\n        }\r\n        if (sprite.direction) {\r\n            this.dir = sprite.direction;\r\n        }\r\n        const animations = sprite.animations;\r\n        if (animations && animations.length > 0) {\r\n            for (const animation of animations) {\r\n                const aniData = this._cap.add.animationdata(this);\r\n                if (aniData) {\r\n                    aniData.importAnimation(animation);\r\n                    aniData.parent = this.id;\r\n                }\r\n            }\r\n            if (sprite.currentAnimationName) {\r\n                this.defaultAnimationName = sprite.currentAnimationName;\r\n            }\r\n        }\r\n    }\r\n    syncSprite(sprite) {\r\n        if (sprite.direction) {\r\n            this.dir = sprite.direction;\r\n        }\r\n    }\r\n    addAnimationData(ani) {\r\n        this._data_map.set(ani.id, ani);\r\n    }\r\n    removeAnimationData(ani) {\r\n        this._data_map.delete(ani.id);\r\n    }\r\n    getAnimationData(id) {\r\n        return this._data_map.get(id);\r\n    }\r\n    // 物件编辑器中，初始化时读取并展示的动画\r\n    getDefaultAnimationData() {\r\n        if (this._data_map.size > 0)\r\n            return this._data_map.values().next().value;\r\n        return;\r\n    }\r\n    setDisplayPath(texturePath, dataPath) {\r\n        const display = this.display;\r\n        display.texturePath = texturePath;\r\n        display.dataPath = dataPath;\r\n    }\r\n    get dir() {\r\n        return this._dir;\r\n    }\r\n    set dir(val) {\r\n        this._dir = val;\r\n    }\r\n    get display() {\r\n        return this._display || this.cap.add.display(this);\r\n    }\r\n    get animationData() {\r\n        return Array.from(this._data_map.values());\r\n    }\r\n    get defaultAnimationName() {\r\n        return this._defaultAnimation;\r\n    }\r\n    set defaultAnimationName(val) {\r\n        this._defaultAnimation = val;\r\n    }\r\n    get editorToolType() {\r\n        return this._editorToolType;\r\n    }\r\n    set editorToolType(value) {\r\n        this._editorToolType = value;\r\n    }\r\n    get thumbBuffer() {\r\n        return this._thumbBuffer;\r\n    }\r\n    set thumbBuffer(buffer) {\r\n        this._thumbBuffer = buffer;\r\n    }\r\n    horizontalFlip() {\r\n        if (this.dir === 3 || this.dir === 5) {\r\n            this.dir = this.dir === 3 ? 5 : 3;\r\n        }\r\n        // 旧数据支持\r\n        this._scale = this.dir === 3 ? false : true;\r\n    }\r\n    static Flip(dir = 3) {\r\n        const dict = {\r\n            3: 5,\r\n            5: 3,\r\n        };\r\n        return dict[dir];\r\n    }\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n    setSelectedAnimation(id) {\r\n        this._selectedAnimationID = id;\r\n    }\r\n    get animationDataList() {\r\n        // TODO\r\n        return Array.from(this._data_map.values());\r\n    }\r\n    getSelectedAnimation() {\r\n        if (this._selectedAnimationID) {\r\n            return this._data_map.get(this._selectedAnimationID);\r\n        }\r\n        return;\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof AnimationDataNode) {\r\n            this.addAnimationData(object);\r\n        }\r\n        if (object instanceof display_1.default) {\r\n            this._display = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof AnimationDataNode) {\r\n            this.removeAnimationData(object);\r\n        }\r\n        if (object instanceof display_1.default) {\r\n            this._display = undefined;\r\n        }\r\n    }\r\n    // by 7 这是啥？？\r\n    geneSelfSequence() {\r\n        let gene = `${this.defaultAnimationName}`;\r\n        if (this._scale)\r\n            gene += this._scale.toString();\r\n        return gene;\r\n    }\r\n    geneSequence() {\r\n        let gene = `${this.defaultAnimationName}`;\r\n        if (this._display)\r\n            gene += this._display.geneSequence();\r\n        if (this._scale)\r\n            gene += this._scale.toString();\r\n        if (this._dir)\r\n            gene += this._dir.toString();\r\n        const animations = this.animationDataList.sort();\r\n        if (animations.length > 0) {\r\n            for (const animationData of animations) {\r\n                gene += animationData.geneSequence();\r\n            }\r\n        }\r\n        return gene;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AnimationsNode) {\r\n            this._defaultAnimation = src.defaultAnimationName;\r\n            this._dir = src.dir;\r\n            this._scale = src.scale;\r\n        }\r\n    }\r\n    checkSameName(name) {\r\n        const animationDatas = this.animationData;\r\n        for (const animation of animationDatas) {\r\n            if (animation.name === name) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexports.default = AnimationsNode;\r\nclass AnimationDataNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.areaRows = 51;\r\n        this.areaCols = 51;\r\n        this.centerPoint = {\r\n            x: this.areaRows >> 1,\r\n            y: this.areaCols >> 1,\r\n        };\r\n        this._frameRate = 5;\r\n        this._frameName = [];\r\n        this._loop = true;\r\n        this._baseLoc = { x: 0, y: 0 };\r\n        this.layerDict = new Map();\r\n        this.name = "序列帧数据";\r\n        this.frameDuration = [];\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    get properties() {\r\n        return {\r\n            frameRate: this._frameRate,\r\n            frameName: this._frameName,\r\n            loop: this._loop,\r\n            baseLoc: `${this._baseLoc.x},${this._baseLoc.y}`,\r\n            originPoint: this.collisionOriginPoint,\r\n            basicWalkableArea: this._basicWalkableArea,\r\n            basicCollisionArea: this._basicCollisionArea,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.animationdatas)) {\r\n            game.animationdatas = [];\r\n        }\r\n        return game.animationdatas;\r\n    }\r\n    createProtocolObject() {\r\n        const anim = pixelpai_proto_1.op_gameconfig_01.AnimationData.create();\r\n        anim.node = super.makeNode();\r\n        anim.baseLoc = `${this._baseLoc.x},${this._baseLoc.y}`;\r\n        anim.frameName = this._frameName;\r\n        anim.loop = this._loop;\r\n        anim.frameRate = this._frameRate;\r\n        if (this._collisionArea) {\r\n            anim.collisionArea = helpers_1.default.arrayToString(this._collisionArea, ",", "&");\r\n        }\r\n        if (this._walkableArea) {\r\n            anim.walkableArea = helpers_1.default.arrayToString(this._walkableArea, ",", "&");\r\n        }\r\n        if (this._collisionOriginPoint) {\r\n            const p = this._collisionOriginPoint;\r\n            anim.originPoint = [p.y, p.x];\r\n        }\r\n        if (this._interactiveArea) {\r\n            let point = null;\r\n            const points = [];\r\n            for (const area of this._interactiveArea) {\r\n                point = pixelpai_proto_1.op_def.PBPoint2i.create();\r\n                point.x = area.x;\r\n                point.y = area.y;\r\n                points.push(point);\r\n            }\r\n            anim.interactiveArea = points;\r\n        }\r\n        if (this._mainInteractivePoints) {\r\n            anim.mainInteractivePoints = [];\r\n            for (const interactivePoint of this._mainInteractivePoints) {\r\n                const point = pixelpai_proto_1.op_def.PBPoint2i.create();\r\n                Object.assign(point, interactivePoint);\r\n                anim.mainInteractivePoints.push(point);\r\n            }\r\n        }\r\n        if (this._frameDuration) {\r\n            anim.frameDuration = this._frameDuration;\r\n        }\r\n        if (this.layerDict.size > 0) {\r\n            anim.layer = _.orderBy(Array.from(this.layerDict.values()), ["depth"], ["asc"]).map((ly) => ly.serialize());\r\n        }\r\n        if (this._mountLayer) {\r\n            anim.mountLayer = this._mountLayer.serialize();\r\n        }\r\n        return anim;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._frameRate = obj.frameRate;\r\n        this._frameName = obj.frameName || [];\r\n        if (obj.frameDuration) {\r\n            this.frameDuration = obj.frameDuration;\r\n        }\r\n        else {\r\n            if (obj.frameName) {\r\n                this.frameDuration = new Array(obj.frameName.length).fill(0);\r\n            }\r\n        }\r\n        if (obj.layer) {\r\n            this._layer = [];\r\n            for (let i = 0; i < obj.layer.length; i++) {\r\n                const ly = obj.layer[i];\r\n                const aniLy = new AnimationLayer();\r\n                aniLy.deserialize(ly);\r\n                aniLy.initDepth(i, obj.mountLayer);\r\n                this._layer.push(aniLy);\r\n                this.layerDict.set(aniLy.id, aniLy);\r\n            }\r\n        }\r\n        else if (!obj.layer && obj.frameName && obj.frameName.length > 0) {\r\n            this._layer = [];\r\n            const aniLy = new AnimationLayer(obj.frameName);\r\n            aniLy.initDepth(0, obj.mountLayer);\r\n            this.frameDuration = new Array(obj.frameName.length).fill(0);\r\n            this._layer.push(aniLy);\r\n            this.layerDict.set(aniLy.id, aniLy);\r\n        }\r\n        this._loop = obj.loop || false;\r\n        if (obj.originPoint) {\r\n            this._collisionOriginPoint = {\r\n                x: obj.originPoint[1],\r\n                y: obj.originPoint[0],\r\n            };\r\n            this._walkableOriginPoint = {\r\n                x: obj.originPoint[1],\r\n                y: obj.originPoint[0],\r\n            };\r\n        }\r\n        if (obj.baseLoc) {\r\n            const baseLocAry = obj.baseLoc.split(",");\r\n            this._baseLoc = {\r\n                x: parseInt(baseLocAry[0]),\r\n                y: parseInt(baseLocAry[1]),\r\n            };\r\n            this.layerDict.forEach((layer) => {\r\n                if (layer.offsetLoc) {\r\n                    return;\r\n                }\r\n                else {\r\n                    const loc = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n                    loc.x = parseInt(baseLocAry[0]);\r\n                    loc.y = parseInt(baseLocAry[1]);\r\n                    layer.offsetLoc = loc;\r\n                }\r\n            });\r\n        }\r\n        if (obj.walkableArea) {\r\n            this._walkableArea = helpers_1.default.stringToArray(obj.walkableArea, ",", "&");\r\n            this._basicWalkableArea = this.initlizeBasicArea();\r\n            this.originalArea(this._basicWalkableArea, this._walkableArea, this._collisionOriginPoint);\r\n        }\r\n        if (obj.collisionArea) {\r\n            this._collisionArea = helpers_1.default.stringToArray(obj.collisionArea, ",", "&");\r\n            this._basicCollisionArea = this.initlizeBasicArea();\r\n            this.originalArea(this._basicCollisionArea, this._collisionArea, this._collisionOriginPoint);\r\n        }\r\n        const interactiveArea = obj.interactiveArea;\r\n        if (interactiveArea) {\r\n            const area = this.interactiveArea;\r\n            for (const point of interactiveArea) {\r\n                area.push(point);\r\n            }\r\n        }\r\n        if (obj.mainInteractivePoints) {\r\n            this.mainInteractivePoints = [];\r\n            for (const point of obj.mainInteractivePoints) {\r\n                this.mainInteractivePoints.push(point);\r\n            }\r\n        }\r\n        if (obj.mountLayer) {\r\n            const mountLy = new AnimationMountLayer();\r\n            mountLy.deserialize(obj.mountLayer);\r\n            this._mountLayer = mountLy;\r\n        }\r\n    }\r\n    cutBaseArea() {\r\n        if (this._basicCollisionArea) {\r\n            this._collisionArea = [];\r\n            this._collisionOriginPoint = Object.assign({}, this.centerPoint);\r\n            this._collisionArea = this.filterArea(this._basicCollisionArea, this._collisionOriginPoint);\r\n        }\r\n        if (this._basicWalkableArea) {\r\n            this._walkableArea = [];\r\n            this._walkableArea = this.filterArea(this.basicWalkableArea);\r\n        }\r\n    }\r\n    importAnimation(ani) {\r\n        this.frameName = ani.frameName || [];\r\n        this.frameRate = ani.frameRate;\r\n        if (ani.loop) {\r\n            this.loop = ani.loop;\r\n        }\r\n        if (ani.node) {\r\n            this.name = ani.node.name;\r\n            this.parent = ani.node.Parent;\r\n            this.type = ani.node.type;\r\n        }\r\n        const baseLoc = ani.baseLoc;\r\n        if (baseLoc) {\r\n            const tmpBaseLoc = baseLoc.split(",");\r\n            this.baseLoc = {\r\n                x: parseInt(tmpBaseLoc[0], 10),\r\n                y: parseInt(tmpBaseLoc[1], 10),\r\n            };\r\n        }\r\n        const originPoint = ani.originPoint;\r\n        if (originPoint) {\r\n            this.originPoint = { x: originPoint[1], y: originPoint[0] };\r\n        }\r\n        if (ani.walkableArea) {\r\n            this._walkableArea = helpers_1.default.stringToArray(ani.walkableArea, ",", "&");\r\n        }\r\n        if (ani.collisionArea) {\r\n            this._collisionArea = helpers_1.default.stringToArray(ani.collisionArea, ",", "&");\r\n        }\r\n        const interactiveArea = ani.interactiveArea;\r\n        if (interactiveArea) {\r\n            this.interactiveArea = [];\r\n            for (const point of interactiveArea) {\r\n                this.interactiveArea.push(point);\r\n            }\r\n        }\r\n        if (ani.layer) {\r\n            this.layer = ani.layer.map((ly) => new AnimationLayer(ly.frameName, ly.offsetLoc, ly.frameVisible));\r\n            for (const ly of this.layer) {\r\n                this.layerDict.set(ly.id, ly);\r\n            }\r\n        }\r\n        if (ani.mountLayer) {\r\n            this.mountLayer = new AnimationMountLayer(ani.mountLayer.index, ani.mountLayer.mountPoint, ani.mountLayer.frameVisible);\r\n        }\r\n    }\r\n    moveAnimationMountLayer(dir) {\r\n        if (this.mountLayer && this.mountLayer.index) {\r\n            this.mountLayer.index += dir;\r\n        }\r\n    }\r\n    initAnimationLayer() {\r\n        const layer = new AnimationLayer([], undefined, []);\r\n        this.layerDict.set(layer.id, layer);\r\n    }\r\n    updateAnimationLayerDepth(depthData) {\r\n        this.layerDict.forEach((layer) => {\r\n            const layerDepthData = depthData.find((item) => item.id === layer.id);\r\n            if (layerDepthData) {\r\n                layer.depth = layerDepthData.index;\r\n            }\r\n        });\r\n    }\r\n    updateAnimationMountLayerDepth(index) {\r\n        if (this.mountLayer) {\r\n            this.mountLayer.index = index;\r\n        }\r\n    }\r\n    addAnimationLayer(name) {\r\n        if (this.layerDict.size > 0) {\r\n            const frameLen = Array.from(this.layerDict.values())[0].frameName\r\n                .length;\r\n            const frames = new Array(frameLen).fill("blank");\r\n            const frameVisibles = new Array(frameLen).fill(true);\r\n            const aniLayer = new AnimationLayer(frames, undefined, frameVisibles);\r\n            aniLayer.depth = this.layerDict.size;\r\n            aniLayer.name = name;\r\n            this.layerDict.set(aniLayer.id, aniLayer);\r\n        }\r\n        else {\r\n            const aniLayer = new AnimationLayer([], undefined, []);\r\n            aniLayer.depth = 0;\r\n            aniLayer.name = name;\r\n            this.layerDict.set(aniLayer.id, aniLayer);\r\n        }\r\n    }\r\n    deleteAnimationLayer(layerId) {\r\n        this.layerDict.delete(layerId);\r\n    }\r\n    addAnimationMountLayer(index) {\r\n        if (this.mountLayer) {\r\n            return;\r\n        }\r\n        this.mountLayer = new AnimationMountLayer(index, [], []);\r\n    }\r\n    deleteAnimationMountLayer() {\r\n        this.mountLayer = undefined;\r\n    }\r\n    addDuration(index) {\r\n        this._frameDuration.splice(index, 0, 0);\r\n    }\r\n    deleteDuration(index) {\r\n        this._frameDuration.splice(index, 1);\r\n    }\r\n    get originPoint() {\r\n        if (!this._collisionOriginPoint) {\r\n            this._collisionOriginPoint = { x: 0, y: 0 };\r\n        }\r\n        return this._collisionOriginPoint;\r\n    }\r\n    set originPoint(value) {\r\n        this._collisionOriginPoint = value;\r\n    }\r\n    get frameRate() {\r\n        return this._frameRate;\r\n    }\r\n    set frameRate(value) {\r\n        this._frameRate = value;\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n    }\r\n    get baseLoc() {\r\n        return this._baseLoc;\r\n    }\r\n    set baseLoc(value) {\r\n        this._baseLoc = value;\r\n    }\r\n    get layer() {\r\n        return this._layer;\r\n    }\r\n    set layer(val) {\r\n        this._layer = val;\r\n        if (val) {\r\n            for (const ly of val) {\r\n                this.layerDict.set(ly.id, ly);\r\n            }\r\n        }\r\n    }\r\n    get basicCollisionArea() {\r\n        if (!this._basicCollisionArea ||\r\n            this._basicCollisionArea.length === 0) {\r\n            this._basicCollisionArea = this.initlizeBasicArea();\r\n        }\r\n        return this._basicCollisionArea;\r\n    }\r\n    setBasicCollisionArea(row, col, value) {\r\n        if (row < 0 || row > this.areaRows || col < 0 || col > this.areaCols) {\r\n            return;\r\n        }\r\n        if (!this._basicCollisionArea) {\r\n            return;\r\n        }\r\n        this._basicCollisionArea[row][col] = value;\r\n    }\r\n    get basicWalkableArea() {\r\n        if (!this._basicWalkableArea || this._basicWalkableArea.length === 0) {\r\n            this._basicWalkableArea = this.initlizeBasicArea();\r\n        }\r\n        return this._basicWalkableArea;\r\n    }\r\n    get interactiveArea() {\r\n        if (!this._interactiveArea) {\r\n            this._interactiveArea = [];\r\n        }\r\n        return this._interactiveArea;\r\n    }\r\n    set interactiveArea(val) {\r\n        this._interactiveArea = val;\r\n    }\r\n    get mainInteractivePoints() {\r\n        return this._mainInteractivePoints;\r\n    }\r\n    set mainInteractivePoints(val) {\r\n        this._mainInteractivePoints = val;\r\n    }\r\n    get frameName() {\r\n        return this._frameName;\r\n    }\r\n    set frameName(value) {\r\n        this._frameName = value;\r\n    }\r\n    get collisionArea() {\r\n        return this._collisionArea;\r\n    }\r\n    set collisionArea(ary) {\r\n        this._collisionArea = ary;\r\n    }\r\n    get walkableArea() {\r\n        return this._walkableArea;\r\n    }\r\n    set walkableArea(ary) {\r\n        this._walkableArea = ary;\r\n    }\r\n    get collisionOriginPoint() {\r\n        return this._collisionOriginPoint;\r\n    }\r\n    get walkableOriginPoint() {\r\n        return this._walkableOriginPoint;\r\n    }\r\n    get mountLayer() {\r\n        return this._mountLayer;\r\n    }\r\n    set mountLayer(val) {\r\n        this._mountLayer = val;\r\n    }\r\n    get frameDuration() {\r\n        return this._frameDuration;\r\n    }\r\n    set frameDuration(val) {\r\n        this._frameDuration = val;\r\n    }\r\n    setBasicWalkableArea(row, col, value) {\r\n        if (row < 0 || row > this.areaRows || col < 0 || col > this.areaCols) {\r\n            return;\r\n        }\r\n        if (!this._basicWalkableArea) {\r\n            return;\r\n        }\r\n        this._basicWalkableArea[row][col] = value;\r\n    }\r\n    convertToClientObject(scale) {\r\n        const ani = pixelpai_proto_1.op_gameconfig_01.AnimationData.create();\r\n        ani.node = super.makeNode();\r\n        ani.frameRate = this._frameRate;\r\n        ani.loop = this._loop || false;\r\n        ani.frameName = this._frameName || [];\r\n        ani.baseLoc = `${this.baseLoc.x},${this.baseLoc.y}`;\r\n        ani.walkOriginPoint = [this.originPoint.y, this.originPoint.x];\r\n        ani.originPoint = [this.originPoint.y, this.originPoint.x];\r\n        ani.interactiveArea = this.interactiveArea;\r\n        if (this._walkableArea) {\r\n            ani.walkableArea = helpers_1.default.arrayToString(this._walkableArea, ",", "&");\r\n        }\r\n        else {\r\n            ani.walkableArea = "";\r\n        }\r\n        if (this._collisionArea) {\r\n            ani.collisionArea = helpers_1.default.arrayToString(this._collisionArea, ",", "&");\r\n        }\r\n        else {\r\n            ani.collisionArea = "";\r\n        }\r\n        if (this._layer) {\r\n            ani.layer = this._layer.map((ly) => ly.serialize());\r\n        }\r\n        if (this._mountLayer) {\r\n            ani.mountLayer = this._mountLayer.serialize();\r\n        }\r\n        return ani;\r\n    }\r\n    geneSequence() {\r\n        let gene = `${this.name}${this._frameRate}`;\r\n        if (this.layer && this.layer.length > 0) {\r\n            if (this.layer[0].frameName) {\r\n                gene += this.layer[0].frameName.join("_");\r\n            }\r\n        }\r\n        gene += JSON.stringify(this.baseLoc);\r\n        gene += JSON.stringify(this.originPoint);\r\n        if (this._collisionArea) {\r\n            gene += JSON.stringify(this._collisionArea);\r\n        }\r\n        if (this._walkableArea) {\r\n            gene += JSON.stringify(this._walkableArea);\r\n        }\r\n        return gene;\r\n    }\r\n    filterArea(sourceArea, originPoint) {\r\n        const area = [...sourceArea];\r\n        this.removeHeadRows(area, originPoint);\r\n        this.removeHeadCols(area, originPoint);\r\n        this.removeTailRows(area);\r\n        this.removeTailCols(area);\r\n        return area;\r\n    }\r\n    originalArea(area, filterAry, originPoint) {\r\n        if (!area || !filterAry)\r\n            return;\r\n        originPoint = originPoint || { x: 0, y: 0 };\r\n        const startX = this.centerPoint.x - originPoint.x;\r\n        const startY = this.centerPoint.y - originPoint.y;\r\n        for (let i = 0; i < filterAry.length; i++) {\r\n            for (let j = 0; j < filterAry[0].length; j++) {\r\n                if (area.length > i + startX && area[i].length > j + startY)\r\n                    area[i + startX][j + startY] = filterAry[i][j];\r\n            }\r\n        }\r\n    }\r\n    removeHeadRows(ary, originPoint) {\r\n        // from begin to center row.\r\n        let startIndedx = 0;\r\n        if (this._collisionArea &&\r\n            this._collisionArea.length &&\r\n            this._collisionOriginPoint) {\r\n            startIndedx = this.centerPoint.x - this._collisionOriginPoint.x;\r\n            ary.splice(0, startIndedx);\r\n            return;\r\n        }\r\n        const tmpArr = ary.slice(startIndedx, this.centerPoint.x), len = tmpArr.length;\r\n        for (let i = 0; i < len; ++i) {\r\n            const row = tmpArr[i];\r\n            const idx = row.find((num) => num > 0);\r\n            if (idx) {\r\n                return;\r\n            }\r\n            else {\r\n                ary.shift();\r\n                if (originPoint)\r\n                    originPoint.x -= 1;\r\n            }\r\n        }\r\n    }\r\n    removeTailRows(ary) {\r\n        // from center to end row\r\n        let endIndex = 0;\r\n        if (this._collisionArea && this._collisionArea.length > 0) {\r\n            endIndex = this._collisionArea.length - 1;\r\n        }\r\n        const tmpArr = ary.slice(1), len = tmpArr.length;\r\n        for (let i = len - 1; i >= endIndex; i--) {\r\n            const row = tmpArr[i];\r\n            const idx = row.find((num) => num > 0);\r\n            if (idx && endIndex === 0) {\r\n                return;\r\n            }\r\n            else {\r\n                ary.pop();\r\n                // Note cut tail does not change the origin point\r\n            }\r\n        }\r\n    }\r\n    removeHeadCols(ary, originPoint) {\r\n        let edge = -1;\r\n        if (this._collisionArea &&\r\n            this._collisionArea.length &&\r\n            this._collisionOriginPoint) {\r\n            edge = this.centerPoint.y - this._collisionOriginPoint.y;\r\n        }\r\n        if (edge < 1) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                const rowArr = ary[row];\r\n                const idx = rowArr.findIndex((num) => num > 0);\r\n                if (idx > -1 && idx < this.centerPoint.x) {\r\n                    if (edge < 0) {\r\n                        edge = idx;\r\n                    }\r\n                    edge = Math.min(edge, idx);\r\n                }\r\n            }\r\n        }\r\n        if (edge < 0 || edge === NaN) {\r\n            edge = this.centerPoint.x;\r\n        }\r\n        // do the cut\r\n        if (edge > -1) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                // 0 0 0 0 E * * * * * ...\r\n                //         ^ > > > > >\r\n                ary[row] = ary[row].slice(edge);\r\n            }\r\n            if (originPoint)\r\n                originPoint.y -= edge;\r\n        }\r\n    }\r\n    removeTailCols(ary) {\r\n        let edge = 0;\r\n        if (this._collisionArea && this._collisionArea.length > 0) {\r\n            edge = this._collisionArea[0].length;\r\n        }\r\n        else {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                const rowArr = ary[row];\r\n                let idx = rowArr\r\n                    .slice()\r\n                    .reverse()\r\n                    .findIndex((val) => {\r\n                    return val > 0;\r\n                });\r\n                if (idx > -1) {\r\n                    idx = rowArr.length - idx;\r\n                    edge = Math.max(edge, idx);\r\n                }\r\n            }\r\n        }\r\n        if (edge < 1) {\r\n            edge = 1;\r\n        }\r\n        // do the cut\r\n        if (ary[0].length > edge) {\r\n            for (let row = 0; row < ary.length; ++row) {\r\n                // ... * * * * * E 0 0 0\r\n                //     < < < < < ^\r\n                ary[row] = ary[row].slice(0, edge);\r\n            }\r\n            // Note cut tail does not change the origin point\r\n        }\r\n    }\r\n    initlizeBasicArea() {\r\n        const result = [];\r\n        for (let i = 0; i < this.areaRows; i++) {\r\n            result[i] = [];\r\n            for (let j = 0; j < this.areaCols; j++) {\r\n                result[i][j] = 0;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AnimationDataNode) {\r\n            this._loop = src.loop;\r\n            this._baseLoc = src.baseLoc;\r\n            this._frameName = src.frameName;\r\n            this._frameRate = src.frameRate;\r\n            this._collisionArea = src.collisionArea;\r\n            this._collisionOriginPoint = src.collisionOriginPoint;\r\n            this._walkableArea = src.walkableArea;\r\n            this._walkableOriginPoint = src.walkableOriginPoint;\r\n            this._interactiveArea = src.interactiveArea;\r\n            this.layer = src._layer;\r\n            this.mountLayer = src.mountLayer;\r\n            this.frameDuration = src.frameDuration;\r\n        }\r\n    }\r\n}\r\nexports.AnimationDataNode = AnimationDataNode;\r\nclass AnimationLayer {\r\n    constructor(_frameName, _offsetLoc, _frameVisible) {\r\n        this._frameName = _frameName;\r\n        this._offsetLoc = _offsetLoc;\r\n        this._frameVisible = _frameVisible;\r\n        this.depth = 0;\r\n        this.frames = [];\r\n        this.layerVisible = true;\r\n        this.id = helpers_1.default.genId();\r\n        if (_frameName && _frameName.length > 0) {\r\n            this._frameVisible = new Array(_frameName.length).fill(true);\r\n        }\r\n    }\r\n    serialize() {\r\n        let layer = pixelpai_proto_1.op_gameconfig_01.AnimationLayer.create();\r\n        if (this._frameName) {\r\n            layer.frameName = this._frameName;\r\n        }\r\n        if (this._offsetLoc) {\r\n            const locItem = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n            Object.assign(locItem, this._offsetLoc);\r\n            layer.offsetLoc = locItem;\r\n        }\r\n        if (this._frameVisible) {\r\n            layer.frameVisible = this._frameVisible;\r\n        }\r\n        if (this.name) {\r\n            layer.name = this.name;\r\n        }\r\n        return layer;\r\n    }\r\n    deserialize(properties) {\r\n        if (!properties.frameName) {\r\n            properties.frameName = [];\r\n            properties.frameVisible = [];\r\n        }\r\n        this._frameName = properties.frameName;\r\n        this._offsetLoc = properties.offsetLoc;\r\n        if (properties.name) {\r\n            this.name = properties.name;\r\n        }\r\n        if (properties.frameVisible) {\r\n            this._frameVisible = properties.frameVisible;\r\n        }\r\n        else {\r\n            this._frameVisible = new Array(properties.frameName.length).fill(true);\r\n        }\r\n    }\r\n    initDepth(depth, mountLayer) {\r\n        if (mountLayer && mountLayer.index) {\r\n            if (mountLayer.index > depth) {\r\n                this.depth = depth;\r\n            }\r\n            else {\r\n                this.depth = depth + 1;\r\n            }\r\n        }\r\n        else {\r\n            this.depth = depth;\r\n        }\r\n    }\r\n    addFrame(frame) {\r\n        if (this.frameName && this.frameVisible) {\r\n            this.frameName.push(frame.name);\r\n            this.frameVisible.push(true);\r\n        }\r\n    }\r\n    addFrameAt(frameName, index) {\r\n        if (!this.frameName || !this.frameVisible) {\r\n            return;\r\n        }\r\n        if (index < 0) {\r\n            index = 0;\r\n        }\r\n        if (index > this.frameName.length) {\r\n            index = this.frameName.length;\r\n        }\r\n        this.frameName.splice(index, 0, frameName);\r\n        this.frameVisible.splice(index, 0, true);\r\n    }\r\n    removeFrame(frameIndex) {\r\n        if (this.frameName && this.frameVisible && frameIndex > -1) {\r\n            this.frameName.splice(frameIndex, 1);\r\n            this.frameVisible.splice(frameIndex, 1);\r\n        }\r\n    }\r\n    updateFrame(frame) {\r\n        if (!this.frameName || !this.frameVisible)\r\n            return;\r\n        this.frameName.splice(frame.frameIndex, 1, frame.name);\r\n        this.frameVisible.splice(frame.frameIndex, 1, frame.visible);\r\n    }\r\n    setOffsetLoc(x, y) {\r\n        if (!this._offsetLoc) {\r\n            this._offsetLoc = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n        }\r\n        this._offsetLoc.x = x;\r\n        this._offsetLoc.y = y;\r\n    }\r\n    get frameName() {\r\n        return this._frameName;\r\n    }\r\n    get offsetLoc() {\r\n        return this._offsetLoc;\r\n    }\r\n    set offsetLoc(val) {\r\n        this._offsetLoc = val;\r\n    }\r\n    get frameVisible() {\r\n        return this._frameVisible;\r\n    }\r\n}\r\nexports.AnimationLayer = AnimationLayer;\r\nclass AnimationMountLayer {\r\n    constructor(index, mountPoint, frameVisible) {\r\n        this._mountPoint = [];\r\n        this._frameVisible = [];\r\n        this.id = helpers_1.default.genId();\r\n        this._index = index;\r\n        this._mountPoint = mountPoint;\r\n        this._frameVisible = frameVisible;\r\n    }\r\n    initMountPoints(frameLen) {\r\n        this._mountPoint = [];\r\n        this._frameVisible = new Array(frameLen).fill(0);\r\n    }\r\n    addMountPoint(frameLen) {\r\n        const point = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n        point.x = 0;\r\n        point.y = 0;\r\n        if (this._mountPoint && this._frameVisible) {\r\n            this._mountPoint.push(point);\r\n            this._frameVisible = new Array(frameLen).fill(0);\r\n            for (let i = 0; i < this._frameVisible.length; i++) {\r\n                let visible = this._frameVisible[i];\r\n                for (let j = 0; j < this._mountPoint.length; j++) {\r\n                    visible = this.setIdx1(visible, j);\r\n                }\r\n                this._frameVisible[i] = visible;\r\n            }\r\n        }\r\n    }\r\n    setIdx1(tar, idx) {\r\n        const val = 1 << idx;\r\n        return tar | val;\r\n    }\r\n    setIdx0(tar, idx) {\r\n        const val = 1 << idx;\r\n        return tar & ~val;\r\n    }\r\n    deleteIdx(tar, idx) {\r\n        let low = tar % Math.pow(2, idx);\r\n        let high = Math.floor(tar / Math.pow(2, idx + 1));\r\n        return (high << idx) | low;\r\n    }\r\n    addFrameVisible(index) {\r\n        if (this._frameVisible && this._mountPoint) {\r\n            let visible = 0;\r\n            for (let j = 0; j < this._mountPoint.length; j++) {\r\n                visible = this.setIdx1(visible, j);\r\n            }\r\n            this._frameVisible[index] = visible;\r\n        }\r\n    }\r\n    deleteMountPoint(index) {\r\n        if (this._mountPoint && this._frameVisible) {\r\n            this._mountPoint.splice(index, 1);\r\n            for (let i = 0; i < this._frameVisible.length; i++) {\r\n                let visible = this._frameVisible[i];\r\n                visible = this.deleteIdx(visible, index);\r\n                this._frameVisible[i] = visible;\r\n            }\r\n        }\r\n    }\r\n    serialize() {\r\n        let mountLayer = pixelpai_proto_1.op_gameconfig_01.AnimationMountLayer.create();\r\n        if (this._index) {\r\n            mountLayer.index = this._index;\r\n        }\r\n        if (this._mountPoint) {\r\n            for (const p of this._mountPoint) {\r\n                const emptyPoint = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n                Object.assign(emptyPoint, p);\r\n                mountLayer.mountPoint.push(emptyPoint);\r\n            }\r\n        }\r\n        if (this._frameVisible) {\r\n            mountLayer.frameVisible = this._frameVisible;\r\n        }\r\n        return mountLayer;\r\n    }\r\n    deserialize(properties) {\r\n        this._index = properties.index;\r\n        if (properties.mountPoint) {\r\n            this._mountPoint = properties.mountPoint;\r\n        }\r\n        this._frameVisible = properties.frameVisible;\r\n    }\r\n    get index() {\r\n        return this._index;\r\n    }\r\n    set index(val) {\r\n        this._index = val;\r\n    }\r\n    get mountPoint() {\r\n        return this._mountPoint;\r\n    }\r\n    get frameVisible() {\r\n        return this._frameVisible;\r\n    }\r\n    set frameVisble(val) {\r\n        if (val && val.length > 8) {\r\n            throw new Error("Max frames length 8");\r\n        }\r\n        this._frameVisible = val;\r\n    }\r\n}\r\nexports.AnimationMountLayer = AnimationMountLayer;\r\n//# sourceMappingURL=animations.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/animations.js?')},"../game-capsule/dist/lib/configobjects/attribute.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nclass AttributeNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._key = "";\r\n        this.name = "自定义属性";\r\n    }\r\n    get key() {\r\n        return this._key;\r\n    }\r\n    set key(k) {\r\n        this._key = k;\r\n    }\r\n    set basicTypeVal(v) {\r\n        // if (_.isBoolean(v)) {\r\n        //     this._boolVal = v;\r\n        // }\r\n        // if (_.isNumber(v)) {\r\n        //     this._intVal = v;\r\n        // }\r\n        // if (_.isString(v)) {\r\n        //     this._strVal = v;\r\n        // }\r\n        if (typeof v === "boolean") {\r\n            this._boolVal = v;\r\n        }\r\n        if (typeof v === "number") {\r\n            this._intVal = v;\r\n        }\r\n        if (typeof v === "string") {\r\n            this._strVal = v;\r\n        }\r\n    }\r\n    get basicTypeVal() {\r\n        if (_.isUndefined(this._boolVal))\r\n            return this._boolVal;\r\n        if (_.isUndefined(this._intVal))\r\n            return this._intVal;\r\n        if (_.isUndefined(this._strVal))\r\n            return this._strVal;\r\n        return;\r\n    }\r\n    get intVal() {\r\n        return this._intVal;\r\n    }\r\n    set intVal(m) {\r\n        this._intVal = m;\r\n    }\r\n    get strVal() {\r\n        return this._strVal;\r\n    }\r\n    set strVal(m) {\r\n        this._strVal = m;\r\n    }\r\n    get boolVal() {\r\n        return this._boolVal;\r\n    }\r\n    set boolVal(m) {\r\n        this._boolVal = m;\r\n    }\r\n    get media() {\r\n        return this._media;\r\n    }\r\n    set media(m) {\r\n        this._media = m;\r\n    }\r\n    get title() {\r\n        return this._title;\r\n    }\r\n    set title(val) {\r\n        this._title = val;\r\n    }\r\n    get description() {\r\n        return this._description;\r\n    }\r\n    set description(val) {\r\n        this._description = val;\r\n    }\r\n    get properties() {\r\n        return {\r\n            key: this._key,\r\n            intVal: this._intVal,\r\n            strVal: this._strVal,\r\n            boolVal: this._boolVal,\r\n            media: this._media,\r\n            description: this._description,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.attr)) {\r\n            game.attr = [];\r\n        }\r\n        return game.attr;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Attribute.create();\r\n        obj.node = this.makeNode();\r\n        obj.key = this._key;\r\n        obj.intVal = this._intVal;\r\n        obj.strVal = this._strVal;\r\n        obj.boolVal = this._boolVal;\r\n        obj.media = this._media;\r\n        obj.description = this._description;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._key = obj.key;\r\n        if (obj.hasOwnProperty("intVal") && typeof obj.intVal === "number") {\r\n            this._intVal = obj.intVal;\r\n        }\r\n        else {\r\n            this._intVal = undefined;\r\n        }\r\n        if (obj.hasOwnProperty("strVal") && typeof obj.strVal === "string") {\r\n            this._strVal = obj.strVal;\r\n        }\r\n        else {\r\n            this._strVal = undefined;\r\n        }\r\n        if (obj.hasOwnProperty("boolVal") && typeof obj.boolVal === "boolean") {\r\n            this._boolVal = obj.boolVal;\r\n        }\r\n        else {\r\n            this._boolVal = undefined;\r\n        }\r\n        if (obj.hasOwnProperty("media") && typeof obj.media === "string") {\r\n            this._media = obj.media;\r\n        }\r\n        else {\r\n            this._media = undefined;\r\n        }\r\n        this._description = obj.description;\r\n    }\r\n    geneSequence() {\r\n        // edit by 7, 不要把值也纳入到基因算法中，attribute在序列化的时候不要ignore\r\n        // Only attribute key name is a genetic characteristics\r\n        return "" + this._key;\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof AttributeNode) {\r\n            this._key = src.key;\r\n            const basic = src.basicTypeVal;\r\n            // if (_.isNumber(basic)) this._intVal = basic;\r\n            // if (_.isString(basic)) this._strVal = basic;\r\n            // if (_.isBoolean(basic)) this._boolVal = basic;\r\n            this.basicTypeVal = basic;\r\n            const media = src.media;\r\n            if (media)\r\n                this._media = media;\r\n            if (src.description)\r\n                this._description = src.description;\r\n        }\r\n    }\r\n}\r\nexports.default = AttributeNode;\r\n//# sourceMappingURL=attribute.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/attribute.js?')},"../game-capsule/dist/lib/configobjects/avatar.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nclass AvatarNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        // 缓存\r\n        this._sets = [];\r\n        // {部件slot名：avatarSet}\r\n        this._parts = {};\r\n        this._dir = AvatarDirEnum.Front;\r\n        this._animations = ["idle", "walk", "sit", "run", "jump", "attack"];\r\n        this._curAnimationIndex = 0;\r\n        this._dbName = "bones_human01";\r\n        this._armatureName = "Armature";\r\n        this._dircy = false;\r\n        this.name = "变装";\r\n        this._backMap = {};\r\n        this._backMap["head_hair"] = ["head_hair", "head_back"];\r\n        this._backMap["body_cost"] = ["body_cost", "body_dres"];\r\n        this.defaultCostume();\r\n    }\r\n    // 将一组AvatatSet整合到一起形成一个完整的Avatar，并保存到self._parts里\r\n    merge(newSets) {\r\n        // 解决替换发型，后发分层存在的问题\r\n        for (let i = 0; i < newSets.length; i++) {\r\n            for (const key in this._backMap) {\r\n                if (this._backMap.hasOwnProperty(key)) {\r\n                    const parts = newSets[i].parts;\r\n                    for (const part of parts) {\r\n                        if (part === key) {\r\n                            _.remove(this._sets, n => {\r\n                                return part === key;\r\n                            });\r\n                            this._parts = _.omit(this._parts, this._backMap[key]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._sets = this._sets.concat(newSets);\r\n        for (const set of this._sets) {\r\n            for (const part of set.parts) {\r\n                this._parts[part] = set;\r\n            }\r\n        }\r\n        this._dircy = true;\r\n    }\r\n    // 获取整个avatar的部件标签对应的部件id\r\n    get parts() {\r\n        return this._parts;\r\n    }\r\n    // 获取整个avatar的部件标签对应的资源相对路径\r\n    resources(dir) {\r\n        const res = [];\r\n        const parts = this._parts;\r\n        for (const key in parts) {\r\n            if (parts.hasOwnProperty(key)) {\r\n                let set = parts[key];\r\n                if (!set.hasOwnProperty("localImages")) {\r\n                    // eyes mous 没有背面素材\r\n                    if (dir === 1 && key === "head_eyes") {\r\n                        // Do nothing\r\n                    }\r\n                    else if (dir === 1 && key === "head_mous") {\r\n                        // Do nothing\r\n                    }\r\n                    else if (key === "head_back") {\r\n                        res.push(this.relativeUri("head_hair", set.id, dir, "back"));\r\n                    }\r\n                    else if (key === "body_dres") {\r\n                        res.push(this.relativeUri("body_cost", set.id, dir, "dres"));\r\n                    }\r\n                    else {\r\n                        res.push(this.relativeUri(key, set.id, dir));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n    // 从部件ID转换为资源相对路径\r\n    relativeUri(part, id, dir, layer) {\r\n        if (layer) {\r\n            return `/avatar/part/${part}_${id}_${dir}_${layer}.png`;\r\n        }\r\n        return `/avatar/part/${part}_${id}_${dir}.png`;\r\n    }\r\n    // 返回自己应该去的容器数值，在Igame里的数值。如果没有初始化一个空数值。\r\n    // Used by super.serialize()\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.avatar)) {\r\n            game.avatar = [];\r\n        }\r\n        return game.avatar;\r\n    }\r\n    // 创建protobuf 对象用来序列化。\r\n    // Used by super.serialize()\r\n    createProtocolObject() {\r\n        const avatar = pixelpai_proto_1.op_gameconfig_01.Avatar.create();\r\n        avatar.node = this.makeNode();\r\n        avatar.defaultDir = this._dir;\r\n        // assign more properties to avatar\r\n        const reg = /[_]\\w/;\r\n        for (const partName in this.parts) {\r\n            const part = partName.replace(reg, s => {\r\n                return s.length > 1 ? s[1].toUpperCase() : s;\r\n            }) + "Id";\r\n            avatar[part] = this.parts[partName].id;\r\n        }\r\n        return avatar;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const avatar = data;\r\n        // deserialize other properties\r\n        this._dir = avatar.defaultDir;\r\n        if (avatar.backboneId)\r\n            this._parts["head_eyes"] = {\r\n                id: avatar.backboneId,\r\n                parts: ["head_eyes"],\r\n            };\r\n        if (avatar.barmBaseId)\r\n            this._parts["barm_base"] = {\r\n                id: avatar.barmBaseId,\r\n                parts: ["barm_base"],\r\n            };\r\n        if (avatar.barmCostId)\r\n            this._parts["barm_cost"] = {\r\n                id: avatar.barmCostId,\r\n                parts: ["barm_cost"],\r\n            };\r\n        if (avatar.barmShldId)\r\n            this._parts["barm_shld"] = {\r\n                id: avatar.barmShldId,\r\n                parts: ["barm_shld"],\r\n            };\r\n        if (avatar.barmSpecId)\r\n            this._parts["barm_spec"] = {\r\n                id: avatar.barmSpecId,\r\n                parts: ["barm_spec"],\r\n            };\r\n        if (avatar.barmWeapId)\r\n            this._parts["barm_weap"] = {\r\n                id: avatar.barmWeapId,\r\n                parts: ["barm_weap"],\r\n            };\r\n        if (avatar.blegBaseId)\r\n            this._parts["bleg_base"] = {\r\n                id: avatar.blegBaseId,\r\n                parts: ["bleg_base"],\r\n            };\r\n        if (avatar.blegCostId)\r\n            this._parts["bleg_cost"] = {\r\n                id: avatar.blegCostId,\r\n                parts: ["bleg_cost"],\r\n            };\r\n        if (avatar.blegSpecId)\r\n            this._parts["bleg_spec"] = {\r\n                id: avatar.blegSpecId,\r\n                parts: ["bleg_spec"],\r\n            };\r\n        if (avatar.bodyBaseId)\r\n            this._parts["body_base"] = {\r\n                id: avatar.bodyBaseId,\r\n                parts: ["body_base"],\r\n            };\r\n        if (avatar.bodyCostId)\r\n            this._parts["body_cost"] = {\r\n                id: avatar.bodyCostId,\r\n                parts: ["body_cost"],\r\n            };\r\n        if (avatar.bodyDresId)\r\n            this._parts["body_dres"] = {\r\n                id: avatar.bodyDresId,\r\n                parts: ["body_dres"],\r\n            };\r\n        if (avatar.bodySpecId)\r\n            this._parts["body_spec"] = {\r\n                id: avatar.bodySpecId,\r\n                parts: ["body_spec"],\r\n            };\r\n        if (avatar.bodyTailId)\r\n            this._parts["body_tail"] = {\r\n                id: avatar.bodyTailId,\r\n                parts: ["body_tail"],\r\n            };\r\n        if (avatar.bodyWingId)\r\n            this._parts["body_wing"] = {\r\n                id: avatar.bodyWingId,\r\n                parts: ["body_wing"],\r\n            };\r\n        if (avatar.farmBaseId)\r\n            this._parts["farm_base"] = {\r\n                id: avatar.farmBaseId,\r\n                parts: ["farm_base"],\r\n            };\r\n        if (avatar.farmCostId)\r\n            this._parts["farm_cost"] = {\r\n                id: avatar.farmCostId,\r\n                parts: ["farm_cost"],\r\n            };\r\n        if (avatar.farmShldId)\r\n            this._parts["farm_shld"] = {\r\n                id: avatar.farmShldId,\r\n                parts: ["farm_shld"],\r\n            };\r\n        if (avatar.farmWeapId)\r\n            this._parts["farm_weap"] = {\r\n                id: avatar.farmWeapId,\r\n                parts: ["farm_weap"],\r\n            };\r\n        if (avatar.flegBaseId)\r\n            this._parts["fleg_base"] = {\r\n                id: avatar.flegBaseId,\r\n                parts: ["fleg_base"],\r\n            };\r\n        if (avatar.flegCostId)\r\n            this._parts["fleg_cost"] = {\r\n                id: avatar.flegCostId,\r\n                parts: ["fleg_cost"],\r\n            };\r\n        if (avatar.flegSpecId)\r\n            this._parts["fleg_spec"] = {\r\n                id: avatar.flegSpecId,\r\n                parts: ["fleg_spec"],\r\n            };\r\n        if (avatar.headBackId)\r\n            this._parts["head_back"] = {\r\n                id: avatar.headBackId,\r\n                parts: ["head_back"],\r\n            };\r\n        if (avatar.headBaseId)\r\n            this._parts["head_base"] = {\r\n                id: avatar.headBaseId,\r\n                parts: ["head_base"],\r\n            };\r\n        if (avatar.headEyesId)\r\n            this._parts["head_eyes"] = {\r\n                id: avatar.headEyesId,\r\n                parts: ["head_eyes"],\r\n            };\r\n        if (avatar.headHairId)\r\n            this._parts["head_hair"] = {\r\n                id: avatar.headHairId,\r\n                parts: ["head_hair"],\r\n            };\r\n        if (avatar.headHatsId)\r\n            this._parts["head_hats"] = {\r\n                id: avatar.headHatsId,\r\n                parts: ["head_hats"],\r\n            };\r\n        if (avatar.headMaskId)\r\n            this._parts["head_mask"] = {\r\n                id: avatar.headMaskId,\r\n                parts: ["head_mask"],\r\n            };\r\n        if (avatar.headMousId)\r\n            this._parts["head_mous"] = {\r\n                id: avatar.headMousId,\r\n                parts: ["head_mous"],\r\n            };\r\n        if (avatar.headSpecId)\r\n            this._parts["head_spec"] = {\r\n                id: avatar.headSpecId,\r\n                parts: ["head_spec"],\r\n            };\r\n    }\r\n    clearParts() {\r\n        this._parts = {};\r\n        this._sets.length = 0;\r\n        this.defaultCostume();\r\n        this._dircy = true;\r\n    }\r\n    set dir(value) {\r\n        this._dir = value;\r\n        this._dircy = true;\r\n    }\r\n    get dir() {\r\n        return this._dir;\r\n    }\r\n    set dirty(value) {\r\n        this._dircy = value;\r\n    }\r\n    get dirty() {\r\n        return this._dircy;\r\n    }\r\n    set curAnimationIndex(val) {\r\n        if (val < 0 || val >= this._animations.length) {\r\n            val = 0;\r\n        }\r\n        this._curAnimationIndex = val;\r\n        this._dircy = true;\r\n    }\r\n    get curAnimationIndex() {\r\n        return this._curAnimationIndex;\r\n    }\r\n    set armatureName(val) {\r\n        this._armatureName = val;\r\n    }\r\n    get armatureName() {\r\n        return this._armatureName;\r\n    }\r\n    set dbName(val) {\r\n        this._dbName = val;\r\n    }\r\n    get dbName() {\r\n        return this._dbName;\r\n    }\r\n    getCurAnimation(dir) {\r\n        return `${this._animations[this._curAnimationIndex]}_${dir ? dir : this._dir}`;\r\n    }\r\n    defaultCostume() {\r\n        const defaulAvatar = [\r\n            { id: "0001", parts: ["head_base"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_hair"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_eyes"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["head_mous"] },\r\n            { id: "0001", parts: ["body_base"] },\r\n            { id: "5cd28238fb073710972a73c2", parts: ["body_cost"] },\r\n            { id: "0001", parts: ["farm_base"] },\r\n            { id: "0001", parts: ["barm_base"] },\r\n            { id: "0001", parts: ["fleg_base"] },\r\n            { id: "0001", parts: ["bleg_base"] },\r\n            { id: "0001", parts: ["farm_base"] },\r\n        ];\r\n        this.merge(defaulAvatar);\r\n    }\r\n}\r\nexports.default = AvatarNode;\r\nvar AvatarDirEnum;\r\n(function (AvatarDirEnum) {\r\n    AvatarDirEnum[AvatarDirEnum["Back"] = 1] = "Back";\r\n    AvatarDirEnum[AvatarDirEnum["Front"] = 3] = "Front";\r\n})(AvatarDirEnum = exports.AvatarDirEnum || (exports.AvatarDirEnum = {}));\r\n//# sourceMappingURL=avatar.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/avatar.js?')},"../game-capsule/dist/lib/configobjects/character.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst avatar_1 = __webpack_require__(/*! ./avatar */ "../game-capsule/dist/lib/configobjects/avatar.js");\r\nclass CharacterNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "游戏角色";\r\n    }\r\n    get camp() {\r\n        return this._camp || this.cap.add.camp(1, this);\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof CampNode) {\r\n            this._camp = object;\r\n        }\r\n        if (object instanceof avatar_1.default) {\r\n            this._avatar = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof CampNode) {\r\n            this._camp = undefined;\r\n        }\r\n        if (object instanceof avatar_1.default) {\r\n            this._avatar = undefined;\r\n        }\r\n    }\r\n}\r\nexports.default = CharacterNode;\r\nclass CampNode extends config_object_1.BaseConfigObject {\r\n    get properties() {\r\n        return {\r\n            maxNumber: this._maxNumber,\r\n        };\r\n    }\r\n    get maxPlayers() {\r\n        return this._maxNumber || 0;\r\n    }\r\n    set maxPlayers(n) {\r\n        this._maxNumber = n;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.camp)) {\r\n            game.camp = [];\r\n        }\r\n        return game.camp;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Camp.create();\r\n        obj.node = this.makeNode();\r\n        obj.maxNumber = this._maxNumber || 0;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        if (obj.maxNumber)\r\n            this._maxNumber = obj.maxNumber;\r\n    }\r\n}\r\nexports.CampNode = CampNode;\r\n//# sourceMappingURL=character.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/character.js?')},"../game-capsule/dist/lib/configobjects/config_object.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst metadata_1 = __webpack_require__(/*! ./metadata */ "../game-capsule/dist/lib/configobjects/metadata.js");\r\nconst constants_1 = __webpack_require__(/*! ../constants */ "../game-capsule/dist/lib/constants.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass BaseConfigObject extends metadata_1.default {\r\n    constructor(cap, parent) {\r\n        super(cap);\r\n        this._fork = false;\r\n        this.parentObject = parent;\r\n        this.type = constants_1.default.NODE_T.indexOf(this.className);\r\n    }\r\n    renewId(theNewId) {\r\n        const oldId = this.id;\r\n        const newId = theNewId || helpers_1.default.genId();\r\n        const children_ids = [];\r\n        for (const child of this.children) {\r\n            children_ids.push(child.id);\r\n        }\r\n        this.unlink(); // 需要把老的数据删除\r\n        this.id = newId;\r\n        this.cap.removeObjectById(oldId);\r\n        if (!this.cap.getObject(this.id)) {\r\n            this.cap.addObject(this);\r\n        }\r\n        // I am new!!\r\n        for (const id of children_ids) {\r\n            const obj = this.cap.getObject(id);\r\n            if (obj) {\r\n                obj.parent = newId;\r\n                obj.renewId();\r\n            }\r\n        }\r\n    }\r\n    copyId(id) {\r\n        this.id = id;\r\n    }\r\n    // a candy\r\n    get children() {\r\n        return this.cap.getChildrenList(this.id);\r\n    }\r\n    get isFork() {\r\n        return this._fork;\r\n    }\r\n    set isFork(val) {\r\n        this._fork = val;\r\n    }\r\n    ignore() {\r\n        for (const child of this.children) {\r\n            child.ignore();\r\n        }\r\n    }\r\n    preSerialize() {\r\n        // Do nothing here.\r\n    }\r\n    serialize(container) {\r\n        //1-0. if ignore serialize return\r\n        if (this.cap.ignoreList.get(this.id))\r\n            return;\r\n        // 1-1. choose my box.\r\n        const arr = this.findMyContainer(container);\r\n        // 1-2. jump into the box.\r\n        arr.push(this.createProtocolObject());\r\n    }\r\n    deserialize(data) {\r\n        if (!data) {\r\n            return;\r\n        }\r\n        if (data.hasOwnProperty("node")) {\r\n            const node = data["node"];\r\n            // node is an Object\r\n            if (node) {\r\n                this.setNode(node);\r\n            }\r\n        }\r\n        if (data.version) {\r\n            this.version = data.version;\r\n        }\r\n        if (data.isMoss) {\r\n            this.isMoss = data.isMoss;\r\n        }\r\n        this.cap.addObject(this);\r\n    }\r\n    findMyContainer(game) {\r\n        throw new Error(`Subclass must override this method! BaseConfigObject::findMyContainer`);\r\n    }\r\n    createProtocolObject() {\r\n        throw new Error(`Subclass must override this method! BaseConfigObject::createProtocolObject`);\r\n    }\r\n    appendNode(object) {\r\n        // do nothing. but check.\r\n        if (object.parent !== this.id) {\r\n            throw new Error(`${this.className}.appendNode(): I am not parent of Object[${object.className}.${object.id}].`);\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        // do nothing. but check.\r\n        if (object.parent !== this.id) {\r\n            throw new Error(`${this.className}.removeNode(): I am not parent of Object[${object.className}.${object.id}].`);\r\n        }\r\n    }\r\n    link() {\r\n        const p = this.parentObject;\r\n        if (p) {\r\n            p.appendNode(this);\r\n        }\r\n    }\r\n    unlink() {\r\n        const p = this.parentObject;\r\n        if (p) {\r\n            p.removeNode(this);\r\n        }\r\n    }\r\n    destroy() {\r\n        // remove my children\r\n        for (const child of this.children) {\r\n            if (child)\r\n                child.destroy();\r\n        }\r\n        //  remove myself from index\r\n        this.cap.removeObject(this);\r\n        //  destroy metadata\r\n        super.destroy();\r\n    }\r\n    // 获取基因序列，判断2个复合对象是否是同族。子类请扩展此方法\r\n    // 在克隆时判断是否要分叉。\r\n    // 在还原是判断是否要将一个Fork对象还原成本体。\r\n    geneSequence() {\r\n        return this.className;\r\n    }\r\n    // 从另一个ConfigObject对象上复制成员\r\n    // 此方法被Capsule.clone()方法调用，有成员属性的Node必须重写\r\n    duplicate(src) {\r\n        // 复制节点元数据\r\n        this.name = src.name;\r\n    }\r\n}\r\nexports.BaseConfigObject = BaseConfigObject;\r\nclass EntityNode extends BaseConfigObject {\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.entity)) {\r\n            game.entity = [];\r\n        }\r\n        return game.entity;\r\n    }\r\n    createProtocolObject() {\r\n        const ele = pixelpai_proto_1.op_gameconfig_01.Entity.create();\r\n        ele.node = this.makeNode();\r\n        ele.version = this.version;\r\n        return ele;\r\n    }\r\n}\r\nexports.EntityNode = EntityNode;\r\n//# sourceMappingURL=config_object.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/config_object.js?')},"../game-capsule/dist/lib/configobjects/display.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass DisplayNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._texturePath = "";\r\n        this._dataPath = "";\r\n        this.name = "显示元件";\r\n    }\r\n    ignore() {\r\n        super.ignore();\r\n        this.cap.ignoreList.set(this.id, this.id);\r\n    }\r\n    get properties() {\r\n        return {\r\n            texturePath: this._texturePath,\r\n            dataPath: this._dataPath,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!game.display) {\r\n            game.display = [];\r\n        }\r\n        return game.display;\r\n    }\r\n    createProtocolObject() {\r\n        const display = pixelpai_proto_1.op_gameconfig_01.Display.create();\r\n        display.node = this.makeNode();\r\n        display.texturePath = this._texturePath;\r\n        display.dataPath = this._dataPath;\r\n        return display;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._dataPath = as.dataPath || "";\r\n        this._texturePath = as.texturePath || "";\r\n    }\r\n    get texturePath() {\r\n        return this._texturePath;\r\n    }\r\n    set texturePath(value) {\r\n        this._texturePath = value;\r\n    }\r\n    get dataPath() {\r\n        return this._dataPath;\r\n    }\r\n    set dataPath(value) {\r\n        this._dataPath = value;\r\n    }\r\n    set dataJSON(value) {\r\n        this._dataJSON = value;\r\n    }\r\n    get dataJSON() {\r\n        return this._dataJSON;\r\n    }\r\n    set textureBuffer(texture) {\r\n        this._textureBuffer = texture;\r\n    }\r\n    get textureBuffer() {\r\n        return this._textureBuffer;\r\n    }\r\n    geneSequence() {\r\n        return helpers_1.default.sha1(this._dataPath + "&" + this._texturePath);\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof DisplayNode) {\r\n            this._dataPath = src.dataPath;\r\n            this._texturePath = src.texturePath;\r\n        }\r\n    }\r\n}\r\nexports.default = DisplayNode;\r\n//# sourceMappingURL=display.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/display.js?')},"../game-capsule/dist/lib/configobjects/element.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst location_1 = __webpack_require__(/*! ./location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\n// Element is a simple Entity =)\r\nclass ElementNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "物件";\r\n    }\r\n    get animations() {\r\n        if (!this._animations) {\r\n            this._animations = this.cap.add.animations(this);\r\n        }\r\n        return this._animations;\r\n    }\r\n    get location() {\r\n        if (!this._location) {\r\n            this._location = this.cap.add.location(this);\r\n        }\r\n        return this._location;\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof location_1.default) {\r\n            this._location = object;\r\n        }\r\n        if (object instanceof animations_1.default) {\r\n            this._animations = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof location_1.default) {\r\n            this._location = undefined;\r\n        }\r\n        if (object instanceof animations_1.default) {\r\n            this._animations = undefined;\r\n        }\r\n    }\r\n    getSnAndVersion() {\r\n        let sn = "";\r\n        let ver = "1";\r\n        const reg1 = new RegExp(/.*\\/.*\\/([a-f\\d]{24})\\/(\\d+)\\/[a-f\\d]{24}\\.json/);\r\n        const ret = this.animations.display.dataPath.match(reg1);\r\n        if (ret) {\r\n            ver = ret[2];\r\n            sn = ret[1];\r\n        }\r\n        if (this.sn) {\r\n            sn = this.sn;\r\n        }\r\n        if (this.version &&\r\n            !Number.isNaN(parseInt(ver)) &&\r\n            parseInt(this.version) > parseInt(ver)) {\r\n            ver = this.version;\r\n        }\r\n        return [sn, ver];\r\n    }\r\n    getSnKey() {\r\n        const [sn, ver] = this.getSnAndVersion();\r\n        return `${sn}#${ver}`;\r\n    }\r\n    judgeIsMoss() {\r\n        let isMoss = false;\r\n        if (this.isMoss !== undefined) {\r\n            isMoss = this.isMoss;\r\n        }\r\n        if (this._animations) {\r\n            const interactiveAreas = this._animations.animationData.reduce((ret, cur) => ret.concat(cur.interactiveArea), []);\r\n            if (interactiveAreas.length > 0) {\r\n                isMoss = false;\r\n            }\r\n            else {\r\n                isMoss = true;\r\n            }\r\n        }\r\n        if (this.children && this.children.length > 0) {\r\n            if (this.children\r\n                .map((node) => node.type)\r\n                .filter((type) => {\r\n                return (type !== pixelpai_proto_1.op_def.NodeType.LocationType &&\r\n                    type !== pixelpai_proto_1.op_def.NodeType.AnimationsType);\r\n            }).length > 0) {\r\n                isMoss = false;\r\n            }\r\n        }\r\n        return isMoss;\r\n    }\r\n    setToMoss(val) {\r\n        this.isMoss = val;\r\n    }\r\n    importSprite(sprite) {\r\n        this.id = sprite.id;\r\n        this.name = sprite.nickname || this.name;\r\n        if (sprite.point3f) {\r\n            const { x, y, z } = sprite.point3f;\r\n            if (this.location) {\r\n                this.location.x = x;\r\n                this.location.y = y;\r\n                this.location.z = z || 0;\r\n            }\r\n        }\r\n        if (sprite.animations) {\r\n            if (this._animations) {\r\n                this._animations.destroy();\r\n            }\r\n            this.animations.importSprite(sprite);\r\n        }\r\n        return this;\r\n    }\r\n    syncSprite(sprite) {\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        this.animations.syncSprite(sprite);\r\n        return this;\r\n    }\r\n    convertToSprite() {\r\n        const sprite = pixelpai_proto_1.op_client.Sprite.create();\r\n        sprite.id = this.id;\r\n        sprite.nickname = this.name;\r\n        const point3 = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n        point3.x = this.location.x;\r\n        point3.y = this.location.y;\r\n        point3.z = this.location.z;\r\n        sprite.point3f = point3;\r\n        sprite.sn = this.sn;\r\n        if (this.version) {\r\n            sprite.version = this.version;\r\n        }\r\n        else {\r\n            sprite.version = this.getSnAndVersion()[1];\r\n        }\r\n        if (this._animations) {\r\n            sprite.currentAnimationName = this._animations.defaultAnimationName;\r\n            sprite.direction = this._animations.dir || 3;\r\n            if (this._animations.animationData) {\r\n                if (this._animations.dir)\r\n                    sprite.direction = this._animations.dir;\r\n            }\r\n            const display = this._animations.display;\r\n            if (display) {\r\n                sprite.display = pixelpai_proto_1.op_gameconfig.Display.create();\r\n                sprite.display.dataPath = display.dataPath;\r\n                sprite.display.texturePath = display.texturePath;\r\n            }\r\n            const animations = this._animations.animationData;\r\n            sprite.animations = [];\r\n            for (const aniData of animations) {\r\n                sprite.animations.push(aniData.convertToClientObject(this._animations.scale));\r\n            }\r\n        }\r\n        return sprite;\r\n    }\r\n    geneSequence() {\r\n        let gene = super.geneSequence();\r\n        gene += this.parent;\r\n        if (this._location)\r\n            gene += this._location.geneSequence();\r\n        if (this._animations)\r\n            gene += this._animations.geneSequence();\r\n        const children = this.cap.getChildrenList(this.id);\r\n        for (const child of children) {\r\n            if (child instanceof config_object_1.BaseConfigObject) {\r\n                gene += child.geneSequence();\r\n            }\r\n        }\r\n        return helpers_1.default.sha1(gene);\r\n    }\r\n    preSerialize() {\r\n        const gen = this.geneSequence();\r\n        const origin_id = this.cap.families.get(gen);\r\n        if (origin_id) {\r\n            // 已经有源对象存在于此Capsule容器中了, 将本节点和源对象相同的子节点忽略掉。\r\n            for (const child of this.children) {\r\n                child.ignore();\r\n            }\r\n            this._fork = true;\r\n        }\r\n        else {\r\n            this.cap.families.set(gen, this.id);\r\n            this._fork = false;\r\n        }\r\n        // if (!this.animations || this.animations.animationData.length < 1) {\r\n        //     console.warn(\r\n        //         `${this.name} data error, has been deleted. sn: ${this.sn}`\r\n        //     );\r\n        //     this.cap.removeObject(this);\r\n        // }\r\n    }\r\n    // 物件重构父类的序列化方法\r\n    // 和普通节点不同的是，同族的物件需要被分叉为ForkNode，存入IGame.\r\n    createProtocolObject() {\r\n        const ele = pixelpai_proto_1.op_gameconfig_01.Entity.create();\r\n        ele.node = this.makeNode();\r\n        ele.version = this.getSnAndVersion()[1];\r\n        if (this.isMoss !== undefined) {\r\n            ele.isMoss = this.isMoss;\r\n        }\r\n        const origin_id = this.cap.families.get(this.geneSequence());\r\n        if (this._fork) {\r\n            const origin_id = this.cap.families.get(this.geneSequence());\r\n            if (!origin_id)\r\n                return;\r\n            // 已经有源对象存在于此Capsule容器中了\r\n            // 现在本对象要存为ForkNode了\r\n            // 改type\r\n            ele.node.type = pixelpai_proto_1.op_def.NodeType.ForkType;\r\n            // 把Fork的parent设置为源对象id\r\n            ele.node.Parent = origin_id;\r\n        }\r\n        return ele;\r\n    }\r\n}\r\nexports.default = ElementNode;\r\n//# sourceMappingURL=element.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/element.js?')},"../game-capsule/dist/lib/configobjects/event.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar GameEvent = pixelpai_proto_1.op_def.GameEvent;\r\nclass EventNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._eventName = GameEvent.onElementActive;\r\n        this.name = "事件";\r\n    }\r\n    get properties() {\r\n        return {\r\n            eventName: this._eventName,\r\n        };\r\n    }\r\n    set eventName(val) {\r\n        if (typeof val === "string") {\r\n            this._eventName = parseInt(val);\r\n        }\r\n        else {\r\n            this._eventName = val;\r\n        }\r\n    }\r\n    get eventName() {\r\n        return this._eventName;\r\n    }\r\n    // geneSequence(): string {\r\n    //     return this.name + this._eventName;\r\n    // }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.event)) {\r\n            game.event = [];\r\n        }\r\n        return game.event;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Event.create();\r\n        obj.node = this.makeNode();\r\n        obj.eventName = this._eventName;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._eventName = obj.eventName;\r\n    }\r\n}\r\nexports.default = EventNode;\r\n//# sourceMappingURL=event.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/event.js?')},"../game-capsule/dist/lib/configobjects/fork.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nconst ConfigObjects = __webpack_require__(/*! ./index */ "../game-capsule/dist/lib/configobjects/index.js");\r\nclass ForkNode extends config_object_1.EntityNode {\r\n    deserialize(data) {\r\n        if (!data || !data.hasOwnProperty("node")) {\r\n            return;\r\n        }\r\n        const node = data["node"];\r\n        const parent = node.Parent;\r\n        let entity;\r\n        // 在反序列化时已经将Fork最后反序列化，确保了Fork的父节点已经在Tree上\r\n        // 这里先获取父节点的公有属性节点 AnimationsNode EventNode\r\n        const origin = this.cap.getObject(parent);\r\n        if (!origin) {\r\n            // 数据有误\r\n            console.error(`${this.className}: My parent[${this.parent}] does not exist.`);\r\n            return;\r\n        }\r\n        const nodeConstructor = origin.className || "";\r\n        if (ConfigObjects.hasOwnProperty(nodeConstructor)) {\r\n            // @ts-ignore\r\n            entity = new ConfigObjects[nodeConstructor](this.cap);\r\n            if (entity) {\r\n                entity.isFork = true;\r\n                entity.parent = origin.parent;\r\n                data.node.Parent = origin.parent;\r\n                entity.deserialize(data);\r\n                entity.link();\r\n            }\r\n        }\r\n        if (entity && origin) {\r\n            // 把fork原本的children 挂到新的对象上\r\n            for (const child of origin.children) {\r\n                // Fork 在反序列的时候其他类型的Node 都已经加到树里了，包括Fork自己的Children\r\n                // 克隆Fork上的子节点到新的对象上。\r\n                if (child instanceof animations_1.default) {\r\n                    this.cap.clone(child.id, entity);\r\n                }\r\n                // if (child instanceof EventNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n                // if (child instanceof AttributeNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n                // if (child instanceof TimerNode) {\r\n                //     this.cap.clone(child.id, entity);\r\n                // }\r\n            }\r\n            this.parent = origin.parent;\r\n        }\r\n    }\r\n}\r\nexports.default = ForkNode;\r\n//# sourceMappingURL=fork.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/fork.js?')},"../game-capsule/dist/lib/configobjects/func.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass FunctionNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._fileName = "";\r\n        this._funcName = "";\r\n        this.name = "脚本";\r\n        this.newFileName();\r\n    }\r\n    newFileName() {\r\n        this.fileName = `${this.id}-t=${new Date().getTime()}.lua`;\r\n    }\r\n    get properties() {\r\n        return {\r\n            fileName: this._fileName,\r\n            funcName: this._funcName,\r\n        };\r\n    }\r\n    idToFilenmae() {\r\n        return `${this.id}?t=${new Date().getTime()}.lua`;\r\n    }\r\n    filenameToId() {\r\n        const index = this.fileName.indexOf("-t=");\r\n        if (index > -1) {\r\n            return parseInt(this.fileName.substring(0, index), 10);\r\n        }\r\n        return 0;\r\n    }\r\n    get fileName() {\r\n        return this._fileName;\r\n    }\r\n    set fileName(val) {\r\n        this._fileName = val;\r\n    }\r\n    get funcName() {\r\n        return this._funcName;\r\n    }\r\n    set funcName(val) {\r\n        this._funcName = val;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.func)) {\r\n            game.func = [];\r\n        }\r\n        return game.func;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Function.create();\r\n        obj.node = this.makeNode();\r\n        obj.fileName = this._fileName;\r\n        obj.funcName = this._funcName;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._fileName = obj.fileName;\r\n        this._funcName = obj.funcName;\r\n    }\r\n    duplicate(src) {\r\n        // by 7\r\n        // super.duplicate(src);\r\n        // if (src instanceof FunctionNode) {\r\n        //     this._fileName = src.fileName;\r\n        //     this._funcName = src.funcName;\r\n        //     this._version = src.version;\r\n        // }\r\n    }\r\n}\r\nexports.default = FunctionNode;\r\n//# sourceMappingURL=func.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/func.js?')},"../game-capsule/dist/lib/configobjects/game.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst terrain_1 = __webpack_require__(/*! ./terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nconst attribute_1 = __webpack_require__(/*! ./attribute */ "../game-capsule/dist/lib/configobjects/attribute.js");\r\nconst element_1 = __webpack_require__(/*! ./element */ "../game-capsule/dist/lib/configobjects/element.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass GameNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap) {\r\n        super(cap);\r\n        this._scenes = [];\r\n        // Game node is the only TOP node in a Capsule.\r\n        this.parent = 0;\r\n        this._settings = new SettingsNode(cap, this);\r\n        this._palette = new PaletteNode(cap, this);\r\n        this._moss = new MossNode(cap, this);\r\n        this._assets = new AssetsNode(cap, this);\r\n        this._mods = new ModsNode(cap, this);\r\n    }\r\n    get properties() {\r\n        return {};\r\n    }\r\n    get settings() {\r\n        return this._settings;\r\n    }\r\n    get palette() {\r\n        return this._palette;\r\n    }\r\n    get moss() {\r\n        return this._moss;\r\n    }\r\n    get assets() {\r\n        return this._assets;\r\n    }\r\n    get scenes() {\r\n        return this._scenes;\r\n    }\r\n    set scenes(val) {\r\n        if (val) {\r\n            this._scenes = val;\r\n        }\r\n    }\r\n    get mods() {\r\n        return this._mods;\r\n    }\r\n    serialize(container) {\r\n        // DO NOT INVOKE super.serialize()\r\n        // serialize Metadata.\r\n        container.node = this.makeNode();\r\n        if (!container.node.name) {\r\n            container.node.name = "Game";\r\n        }\r\n        // serialize Settings\r\n        this._settings.serialize(container);\r\n        this._palette.serialize(container);\r\n        this._assets.serialize(container);\r\n        this._moss.serialize(container);\r\n        this._mods.serialize(container);\r\n        this.serializeScenes(container);\r\n    }\r\n    serializeScenes(container) {\r\n        container.scenes = this.cap.root.children\r\n            .filter((node) => node.type === pixelpai_proto_1.op_def.NodeType.SceneNodeType)\r\n            .map((node) => {\r\n            return {\r\n                id: node.id,\r\n                name: node.name,\r\n            };\r\n        });\r\n    }\r\n    deserialize(container) {\r\n        // DO NOT INVOKE super.deserialize()\r\n        // deserialize Metadata\r\n        this.setNode(container.node);\r\n        this._settings.deserialize(container);\r\n        this._assets.deserialize(container);\r\n        this._mods.deserialize(container);\r\n        this.scenes = container.scenes;\r\n    }\r\n    preDeserializePalettes(container) {\r\n        this._palette.preDeserialize(container);\r\n        this._moss.preDeserizlize(container);\r\n    }\r\n    deserializePalettes(container) {\r\n        this._palette.deserialize();\r\n        this._moss.deserialize();\r\n    }\r\n    destroy() {\r\n        super.destroy();\r\n        this._settings.destroy();\r\n        this._palette.destroy();\r\n        this._assets.destroy();\r\n        this._moss.destroy();\r\n        this._mods.destroy();\r\n    }\r\n}\r\nexports.default = GameNode;\r\nclass SettingsNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._spawn_point = 0;\r\n        this._max_number = 10;\r\n        this._sceneid = 0;\r\n    }\r\n    get spawnpoint() {\r\n        return this._spawn_point;\r\n    }\r\n    set spawnpoint(id) {\r\n        this._spawn_point = id;\r\n    }\r\n    get maxNumber() {\r\n        return this._max_number;\r\n    }\r\n    set maxNumber(v) {\r\n        if (v) {\r\n            this._max_number = v;\r\n        }\r\n    }\r\n    set sceneid(v) {\r\n        if (v) {\r\n            this._sceneid = v;\r\n        }\r\n    }\r\n    get sceneid() {\r\n        return this._sceneid;\r\n    }\r\n    get properties() {\r\n        return {\r\n            sceneid: this._sceneid,\r\n            spawnpoint: this._spawn_point,\r\n            maxNumber: this._max_number,\r\n        };\r\n    }\r\n    serialize(container) {\r\n        const self = this;\r\n        container.settings = pixelpai_proto_1.op_gameconfig_01.Settings.create();\r\n        container.settings.node = self.makeNode();\r\n        if (self.maxNumber) {\r\n            container.settings.maxNumber = self.maxNumber;\r\n        }\r\n        else {\r\n            container.settings.maxNumber = null;\r\n        }\r\n        if (self.sceneid) {\r\n            container.settings.sceneid = self.sceneid;\r\n        }\r\n        if (self.spawnpoint) {\r\n            container.settings.spawnpointid = self.spawnpoint;\r\n        }\r\n    }\r\n    deserialize(container) {\r\n        const settings = container.settings;\r\n        if (settings) {\r\n            this.setNode(settings.node);\r\n            if (settings.sceneid) {\r\n                this._sceneid = settings.sceneid;\r\n            }\r\n            this._spawn_point = settings.spawnpointid;\r\n            if (settings.maxNumber) {\r\n                this._max_number = settings.maxNumber;\r\n            }\r\n            else {\r\n                this._max_number = null;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.SettingsNode = SettingsNode;\r\nclass PaletteNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._peers = [];\r\n        this._peersDict = new Map();\r\n        this._sn_peers = new Map();\r\n    }\r\n    get peers() {\r\n        return this._peers;\r\n    }\r\n    set peers(value) {\r\n        this._peers = value;\r\n    }\r\n    get peersDict() {\r\n        return this._peersDict;\r\n    }\r\n    get snPeers() {\r\n        return this._sn_peers;\r\n    }\r\n    getPaletteKeyBySn(sn) {\r\n        return this._sn_peers.get(sn);\r\n    }\r\n    addSnPalette(sn, key) {\r\n        this._sn_peers.set(sn, key);\r\n    }\r\n    convertPaletteOfSnKey() {\r\n        for (const peer of this.peers) {\r\n            if (peer.entity) {\r\n                this._sn_peers.set(`${peer.entity.node.sn}#${peer.entity.version}`, peer.key);\r\n            }\r\n        }\r\n    }\r\n    getTerrainPaletteKeyBySn(sn) {\r\n        return this._sn_peers.get(sn);\r\n    }\r\n    convertToPeerDict() {\r\n        for (const peer of this.peers) {\r\n            if (peer.entity) {\r\n                const id = peer.entity.node.id;\r\n                const terrain = this._cap.getObject(id);\r\n                this._peersDict.set(peer.key, terrain);\r\n            }\r\n        }\r\n    }\r\n    convertToPeers() {\r\n        const existKeys = [];\r\n        for (const node of this._cap.root.children.filter((node) => node.type === pixelpai_proto_1.op_def.NodeType.SceneNodeType)) {\r\n            const scene = node;\r\n            if (scene.terrainCollection) {\r\n                for (let row of scene.terrainCollection.data) {\r\n                    for (let key of row) {\r\n                        if (existKeys.indexOf(key) < 0 && key > 0) {\r\n                            existKeys.push(key);\r\n                        }\r\n                        else {\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        let ret = [];\r\n        for (const key of Array.from(this._peersDict.keys())) {\r\n            if (existKeys.indexOf(key) < 0)\r\n                continue;\r\n            const terrain = this._peersDict.get(key);\r\n            if (terrain) {\r\n                ret.push({\r\n                    key,\r\n                    entity: terrain.createProtocolObject(),\r\n                });\r\n                this.cap.addTerrainMaterial(terrain.animations);\r\n                this.cap.addTerrainMaterial(terrain.animations.display);\r\n                for (const ani of terrain.animations.animationData) {\r\n                    this.cap.addTerrainMaterial(ani);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    addToPalette(terrain) {\r\n        const [sn, ver] = terrain.getSnAndVersion();\r\n        const snKey = `${sn}#${ver}`;\r\n        const nextKey = this.getNextKey(terrain);\r\n        this.addPeer(nextKey, terrain);\r\n        this.addSnPalette(snKey, nextKey);\r\n        if (!this._cap.getTerrainMaterial(terrain.id)) {\r\n            this._cap.addTerrainMaterial(terrain);\r\n        }\r\n        return nextKey;\r\n    }\r\n    getNextKey(terrain) {\r\n        const [sn, ver] = terrain.getSnAndVersion();\r\n        const snKey = `${sn}#${ver}`;\r\n        if (this.snPeers.get(snKey)) {\r\n            return this.snPeers.get(snKey);\r\n        }\r\n        const keys = Array.from(this.peersDict.keys());\r\n        let nextKey = 1;\r\n        if (keys.length > 0) {\r\n            const maxKey = Math.max(...keys);\r\n            nextKey = maxKey + 1;\r\n        }\r\n        return nextKey;\r\n    }\r\n    addPeer(key, entity) {\r\n        this._peersDict.set(key, entity);\r\n    }\r\n    getPeer(key) {\r\n        return this._peersDict.get(key);\r\n    }\r\n    getPeerThroughBindId(bindId) {\r\n        const peer = Array.from(this._peersDict.values()).find((terrain) => {\r\n            return terrain.id === bindId;\r\n        });\r\n        return peer;\r\n    }\r\n    removePeer(key) {\r\n        this._peersDict.delete(key);\r\n    }\r\n    updatePeer(key, entity) {\r\n        this._peersDict.set(key, entity.createProtocolObject());\r\n    }\r\n    serialize(container) {\r\n        const peers = this.convertToPeers();\r\n        if (peers && peers.length > 0) {\r\n            container.palette = pixelpai_proto_1.op_gameconfig_01.Palette.create();\r\n            container.palette.node = this.makeNode();\r\n            container.palette.node.name = "PaletteNode";\r\n            container.palette.node.Parent = this._cap.root.id;\r\n            container.palette.peers = peers;\r\n        }\r\n    }\r\n    preDeserialize(container) {\r\n        if (container.palette && container.palette.peers) {\r\n            this.setNode(container.palette.node);\r\n            this.peers = container.palette.peers;\r\n            for (const peer of this.peers) {\r\n                const terrainNode = new terrain_1.TerrainNode(this._cap);\r\n                terrainNode.deserialize(peer.entity);\r\n                this._cap.addObject(terrainNode);\r\n            }\r\n        }\r\n    }\r\n    deserialize() {\r\n        this.convertToPeerDict();\r\n        this.convertPaletteOfSnKey();\r\n    }\r\n    destroy() {\r\n        super.destroy();\r\n        this._peersDict.forEach((node, index) => {\r\n            node.destroy();\r\n        });\r\n        this._peersDict.clear();\r\n    }\r\n}\r\nexports.PaletteNode = PaletteNode;\r\nclass AssetsNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._items = [];\r\n        this._itemsDict = new Map();\r\n        this.name = "资源仓库";\r\n    }\r\n    get items() {\r\n        return this._items;\r\n    }\r\n    convertToItemsDict() {\r\n        for (const item of this.items) {\r\n            this._itemsDict.set(item.id, item);\r\n        }\r\n    }\r\n    convertToItems() {\r\n        return Array.from(this._itemsDict.values()).map((item) => item.createProtocolObject());\r\n    }\r\n    addAssets(node) {\r\n        this._itemsDict.set(node.id, node);\r\n        this._cap.addObject(node);\r\n    }\r\n    deleteAsset(id) {\r\n        this._itemsDict.delete(id);\r\n        this._cap.removeObjectById(id);\r\n    }\r\n    updateAsset(node) {\r\n        this._itemsDict.set(node.id, node);\r\n    }\r\n    getAsset(id) {\r\n        return this._itemsDict.get(id);\r\n    }\r\n    getAssetList() {\r\n        return Array.from(this._itemsDict.values());\r\n    }\r\n    serialize(container) {\r\n        // for (const item of Array.from(this._itemsDict.values())) {\r\n        //     this._cap.removeObjectById(item.id);\r\n        // }\r\n        container.assets = pixelpai_proto_1.op_gameconfig_01.Assets.create();\r\n        container.assets.node = this.makeNode();\r\n        container.assets.node.Parent = this._cap.root.id;\r\n        container.assets.items = this.convertToItems();\r\n    }\r\n    deserialize(container) {\r\n        if (container.assets) {\r\n            this.setNode(container.assets.node);\r\n            for (const item of container.assets.items) {\r\n                const attrNode = new attribute_1.default(this._cap);\r\n                attrNode.deserialize(item);\r\n                this.children.push(attrNode);\r\n                this._items.push(attrNode);\r\n            }\r\n            this.convertToItemsDict();\r\n        }\r\n    }\r\n}\r\nexports.AssetsNode = AssetsNode;\r\nclass MossNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._peers = [];\r\n        this._peersDict = new Map();\r\n        this._sn_peers = new Map();\r\n    }\r\n    get peers() {\r\n        return this._peers;\r\n    }\r\n    set peers(value) {\r\n        this._peers = value;\r\n    }\r\n    get peersDict() {\r\n        return this._peersDict;\r\n    }\r\n    get snPeers() {\r\n        return this._sn_peers;\r\n    }\r\n    getPaletteKeyBySn(sn) {\r\n        return this._sn_peers.get(sn);\r\n    }\r\n    addSnPalette(elementSn, nextKey) {\r\n        this._sn_peers.set(elementSn, nextKey);\r\n    }\r\n    convertToPeerDict() {\r\n        for (const peer of this.peers) {\r\n            if (peer.entity) {\r\n                const id = peer.entity.node.id;\r\n                const element = this._cap.getObject(id);\r\n                this._peersDict.set(peer.key, element);\r\n            }\r\n        }\r\n    }\r\n    convertPaletteOfSnKey() {\r\n        for (let peer of this._peers) {\r\n            if (peer.entity) {\r\n                this._sn_peers.set(helpers_1.default.getElementSn(peer.entity.node.sn, peer.entity.version), peer.key);\r\n            }\r\n        }\r\n    }\r\n    getElementPaletteKeyBySn(sn) {\r\n        return this._sn_peers.get(sn);\r\n    }\r\n    convertToPeers() {\r\n        let pairs = [];\r\n        for (const key of Array.from(this._peersDict.keys())) {\r\n            const element = this._peersDict.get(key);\r\n            element.isFork = false;\r\n            if (element) {\r\n                pairs.push({\r\n                    key,\r\n                    entity: element.createProtocolObject(),\r\n                });\r\n                this.cap.addElementMaterial(element.animations);\r\n                this.cap.addElementMaterial(element.animations.display);\r\n                for (const ani of element.animations.animationData) {\r\n                    this.cap.addElementMaterial(ani);\r\n                }\r\n            }\r\n        }\r\n        return pairs;\r\n    }\r\n    addToPalette(element) {\r\n        const elementMaterials = this._cap.getElementMeterials();\r\n        if (elementMaterials.map((ele) => ele.id).indexOf(element.id) >= 0) {\r\n            element.renewId();\r\n        }\r\n        const [sn, ver] = element.getSnAndVersion();\r\n        const elementSn = helpers_1.default.getElementSn(sn, ver);\r\n        const nextKey = this.getNextKey(element);\r\n        this._peersDict.set(nextKey, element);\r\n        this.addSnPalette(elementSn, nextKey);\r\n        if (!this._cap.getElementMaterial(element.geneSequence())) {\r\n            this._cap.addElementMaterial(element);\r\n        }\r\n        return nextKey;\r\n    }\r\n    getNextKey(element) {\r\n        const [sn, ver] = element.getSnAndVersion();\r\n        const elementSn = helpers_1.default.getElementSn(sn, ver);\r\n        if (this.snPeers.get(elementSn)) {\r\n            return this.snPeers.get(elementSn);\r\n        }\r\n        const keys = Array.from(this.peersDict.keys());\r\n        let nextKey = 1;\r\n        if (keys.length > 0) {\r\n            const maxKey = Math.max(...keys);\r\n            nextKey = maxKey + 1;\r\n        }\r\n        return nextKey;\r\n    }\r\n    getPeer(key) {\r\n        return this._peersDict.get(key);\r\n    }\r\n    getPeerThroughBindId(bindId) {\r\n        return Array.from(this._peersDict.values()).find((element) => {\r\n            return element.id === bindId;\r\n        });\r\n    }\r\n    removePeer(key) {\r\n        this._peersDict.delete(key);\r\n    }\r\n    updatePeer(key, entity) {\r\n        this._peersDict.set(key, entity.createProtocolObject());\r\n    }\r\n    serialize(container) {\r\n        const peers = this.convertToPeers();\r\n        if (peers && peers.length > 0) {\r\n            container.moss = pixelpai_proto_1.op_gameconfig_01.Moss.create();\r\n            container.moss.node = this.makeNode();\r\n            container.moss.node.name = "MossNode";\r\n            container.moss.node.Parent = this._cap.root.id;\r\n            container.moss.peers = peers;\r\n        }\r\n    }\r\n    preDeserizlize(container) {\r\n        if (container.moss && container.moss.peers) {\r\n            this.setNode(container.moss.node);\r\n            this.peers = container.moss.peers;\r\n            for (const peer of this.peers) {\r\n                const ele = new element_1.default(this._cap);\r\n                ele.deserialize(peer.entity);\r\n                this._cap.addObject(ele);\r\n            }\r\n        }\r\n    }\r\n    deserialize() {\r\n        this.convertPaletteOfSnKey();\r\n        this.convertToPeerDict();\r\n    }\r\n    destroy() {\r\n        super.destroy();\r\n        this._peersDict.forEach((node, index) => {\r\n            node.destroy();\r\n        });\r\n        this._peersDict.clear();\r\n    }\r\n}\r\nexports.MossNode = MossNode;\r\nclass ModsNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.values = [];\r\n    }\r\n    serialize(container) {\r\n        container.mods = pixelpai_proto_1.op_gameconfig_01.Mods.create();\r\n        container.mods.node = this.makeNode();\r\n        container.mods.node.name = "ModesNode";\r\n        container.mods.node.Parent = this._cap.root.id;\r\n        container.mods.data = this.values;\r\n    }\r\n    deserialize(container) {\r\n        if (container.mods && container.mods.data) {\r\n            this.values = container.mods.data;\r\n        }\r\n    }\r\n    checkMode(name) {\r\n        return this.values.findIndex((v) => v.name === name) >= 0;\r\n    }\r\n    addMod(name, version) {\r\n        const sameMod = this.values.find((v) => v.name === name);\r\n        if (sameMod) {\r\n            sameMod.version = version;\r\n        }\r\n        else {\r\n            this.values.push({ name, version });\r\n        }\r\n    }\r\n    removeMod(name) {\r\n        const sameModIndex = this.values.findIndex((v) => v.name === name);\r\n        if (sameModIndex >= 0) {\r\n            this.values.splice(sameModIndex, 1);\r\n        }\r\n    }\r\n    updateMod(name, version) {\r\n        const sameMod = this.values.find((v) => v.name === name);\r\n        if (sameMod) {\r\n            sameMod.version = version;\r\n        }\r\n    }\r\n}\r\nexports.ModsNode = ModsNode;\r\n//# sourceMappingURL=game.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/game.js?')},"../game-capsule/dist/lib/configobjects/index.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst game_1 = __webpack_require__(/*! ./game */ "../game-capsule/dist/lib/configobjects/game.js");\r\nexports.GameNode = game_1.default;\r\nexports.SettingsNode = game_1.SettingsNode;\r\nexports.PaletteNode = game_1.PaletteNode;\r\nexports.AssetsNode = game_1.AssetsNode;\r\nexports.MossNode = game_1.MossNode;\r\nconst element_1 = __webpack_require__(/*! ./element */ "../game-capsule/dist/lib/configobjects/element.js");\r\nexports.ElementNode = element_1.default;\r\nconst location_1 = __webpack_require__(/*! ./location */ "../game-capsule/dist/lib/configobjects/location.js");\r\nexports.LocationNode = location_1.default;\r\nconst animations_1 = __webpack_require__(/*! ./animations */ "../game-capsule/dist/lib/configobjects/animations.js");\r\nexports.AnimationsNode = animations_1.default;\r\nexports.AnimationDataNode = animations_1.AnimationDataNode;\r\nconst display_1 = __webpack_require__(/*! ./display */ "../game-capsule/dist/lib/configobjects/display.js");\r\nexports.DisplayNode = display_1.default;\r\nconst avatar_1 = __webpack_require__(/*! ./avatar */ "../game-capsule/dist/lib/configobjects/avatar.js");\r\nexports.AvatarNode = avatar_1.default;\r\nconst movable_1 = __webpack_require__(/*! ./movable */ "../game-capsule/dist/lib/configobjects/movable.js");\r\nexports.MovableNode = movable_1.default;\r\nconst attribute_1 = __webpack_require__(/*! ./attribute */ "../game-capsule/dist/lib/configobjects/attribute.js");\r\nexports.AttributeNode = attribute_1.default;\r\nconst func_1 = __webpack_require__(/*! ./func */ "../game-capsule/dist/lib/configobjects/func.js");\r\nexports.FunctionNode = func_1.default;\r\nconst event_1 = __webpack_require__(/*! ./event */ "../game-capsule/dist/lib/configobjects/event.js");\r\nexports.EventNode = event_1.default;\r\nconst ui_1 = __webpack_require__(/*! ./ui */ "../game-capsule/dist/lib/configobjects/ui.js");\r\nexports.UINode = ui_1.default;\r\nexports.ButtonNode = ui_1.ButtonNode;\r\nexports.TextNode = ui_1.TextNode;\r\nconst timer_1 = __webpack_require__(/*! ./timer */ "../game-capsule/dist/lib/configobjects/timer.js");\r\nexports.TimerNode = timer_1.default;\r\nconst spawnpoint_1 = __webpack_require__(/*! ./spawnpoint */ "../game-capsule/dist/lib/configobjects/spawnpoint.js");\r\nexports.SpawnPointNode = spawnpoint_1.default;\r\nconst access_1 = __webpack_require__(/*! ./access */ "../game-capsule/dist/lib/configobjects/access.js");\r\nexports.AccessNode = access_1.AccessNode;\r\nconst scene_1 = __webpack_require__(/*! ./scene */ "../game-capsule/dist/lib/configobjects/scene.js");\r\nexports.SceneNode = scene_1.default;\r\nexports.MapSizeNode = scene_1.MapSizeNode;\r\nexports.TerrainCollectionNode = scene_1.TerrainCollectionNode;\r\nexports.MossCollectionNode = scene_1.MossCollectionNode;\r\nconst fork_1 = __webpack_require__(/*! ./fork */ "../game-capsule/dist/lib/configobjects/fork.js");\r\nexports.ForkNode = fork_1.default;\r\nconst package_1 = __webpack_require__(/*! ./package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nexports.PackageNode = package_1.default;\r\nexports.PackageItemNode = package_1.PackageItemNode;\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nexports.BaseConfigObject = config_object_1.BaseConfigObject;\r\nconst metadata_1 = __webpack_require__(/*! ./metadata */ "../game-capsule/dist/lib/configobjects/metadata.js");\r\nexports.Metadata = metadata_1.default;\r\nconst character_1 = __webpack_require__(/*! ./character */ "../game-capsule/dist/lib/configobjects/character.js");\r\nexports.CharacterNode = character_1.default;\r\nexports.CampNode = character_1.CampNode;\r\nconst terrain_1 = __webpack_require__(/*! ./terrain */ "../game-capsule/dist/lib/configobjects/terrain.js");\r\nexports.TerrainNode = terrain_1.TerrainNode;\r\nconst shop_1 = __webpack_require__(/*! ./shop */ "../game-capsule/dist/lib/configobjects/shop.js");\r\nexports.ShopNode = shop_1.default;\r\nexports.ShopItemNode = shop_1.ShopItemNode;\r\nexports.CommodityNode = shop_1.CommodityNode;\r\nconst scenery_1 = __webpack_require__(/*! ./scenery */ "../game-capsule/dist/lib/configobjects/scenery.js");\r\nexports.SceneryNode = scenery_1.default;\r\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/index.js?')},"../game-capsule/dist/lib/configobjects/location.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass LocationNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._z = 0;\r\n        this.name = "位置";\r\n    }\r\n    ignore() { }\r\n    get properties() {\r\n        return {\r\n            x: this._x,\r\n            y: this._y,\r\n            z: this._z,\r\n        };\r\n    }\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    set x(x) {\r\n        this._x = x;\r\n    }\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    set y(y) {\r\n        this._y = y;\r\n    }\r\n    get z() {\r\n        return this._z;\r\n    }\r\n    set z(z) {\r\n        this._z = z;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.loc)) {\r\n            game.loc = [];\r\n        }\r\n        return game.loc;\r\n    }\r\n    createProtocolObject() {\r\n        const location = pixelpai_proto_1.op_gameconfig_01.Location.create();\r\n        location.node = this.makeNode();\r\n        location.x = this._x;\r\n        location.y = this._y;\r\n        return location;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const location = data;\r\n        this._x = location.x;\r\n        this._y = location.y;\r\n    }\r\n    // NOTE!! That LocationNode is not a gene options, cause object\'s location is always different.\r\n    geneSequence() {\r\n        // ignore the genetic characteristics.\r\n        return "";\r\n    }\r\n    duplicate(src) {\r\n        super.duplicate(src);\r\n        if (src instanceof LocationNode) {\r\n            this._x = src.x;\r\n            this._y = src.y;\r\n            this._z = src.z;\r\n        }\r\n    }\r\n}\r\nexports.default = LocationNode;\r\n//# sourceMappingURL=location.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/location.js?')},"../game-capsule/dist/lib/configobjects/metadata.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst Chance = __webpack_require__(/*! chance */ "../game-capsule/node_modules/chance/chance.js");\r\nconst constants_1 = __webpack_require__(/*! ../constants */ "../game-capsule/dist/lib/constants.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nconst chance = new Chance();\r\nclass Metadata {\r\n    constructor(cap) {\r\n        this._id = helpers_1.default.genId();\r\n        this._parent = 0;\r\n        this._sn = "";\r\n        this._version = "1";\r\n        this._type = 0;\r\n        this._cap = cap;\r\n        this._name = `Object-${this.id}`;\r\n    }\r\n    get type() {\r\n        return this._type;\r\n    }\r\n    set type(t) {\r\n        this._type = t;\r\n    }\r\n    get cap() {\r\n        return this._cap;\r\n    }\r\n    set cap(cap) {\r\n        this._cap = cap;\r\n    }\r\n    get metaData() {\r\n        return {\r\n            id: this._id,\r\n            name: this._name,\r\n            Parent: this._parent,\r\n            sn: this._sn,\r\n            type: this.type,\r\n        };\r\n    }\r\n    get className() {\r\n        return helpers_1.default.getClassName(this);\r\n    }\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    set id(id) {\r\n        this._id = id;\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    set name(n) {\r\n        this._name = n;\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    set parent(p) {\r\n        this._parent = p;\r\n    }\r\n    get parentObject() {\r\n        if (this.parent) {\r\n            return this.cap.getObject(this.parent);\r\n        }\r\n        return;\r\n    }\r\n    set parentObject(p) {\r\n        if (p) {\r\n            this.parent = p.id;\r\n        }\r\n    }\r\n    get sn() {\r\n        return this._sn;\r\n    }\r\n    set sn(sn) {\r\n        this._sn = sn;\r\n    }\r\n    get version() {\r\n        return this._version;\r\n    }\r\n    set version(val) {\r\n        this._version = val;\r\n    }\r\n    get isMoss() {\r\n        return this._is_moss;\r\n    }\r\n    set isMoss(val) {\r\n        this._is_moss = val;\r\n    }\r\n    get nodeType() {\r\n        if (constants_1.default.NODETYPEMAP[this.type]) {\r\n            return this.type;\r\n        }\r\n        else {\r\n            throw new Error(`This Config object does not match any of type list in NodeType!`);\r\n        }\r\n    }\r\n    makeNode() {\r\n        const self = this;\r\n        return new (class {\r\n            constructor() {\r\n                this.LockParent = null;\r\n                this.Parent = self.parent;\r\n                this.id = self.id;\r\n                this.name = self.name;\r\n                this.sn = self.sn;\r\n                this.type = self.nodeType;\r\n            }\r\n        })();\r\n    }\r\n    setNode(n) {\r\n        if (n.hasOwnProperty("Parent"))\r\n            this._parent = n.Parent;\r\n        if (n.hasOwnProperty("id"))\r\n            this._id = n.id;\r\n        this._sn = n.sn || "";\r\n        if (n.hasOwnProperty("name"))\r\n            this._name = n.name;\r\n    }\r\n    destroy() {\r\n        this._cap = {};\r\n    }\r\n}\r\nexports.default = Metadata;\r\n//# sourceMappingURL=metadata.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/metadata.js?')},"../game-capsule/dist/lib/configobjects/movable.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass MovableNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._dir = 0;\r\n        this._angle = 0;\r\n        this._speed = 0;\r\n    }\r\n    get properties() {\r\n        return {\r\n            dir: this._dir,\r\n            angle: this._angle,\r\n            speed: this._speed,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.movable)) {\r\n            game.movable = [];\r\n        }\r\n        return game.movable;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Movable.create();\r\n        obj.node = this.makeNode();\r\n        if (this._dir)\r\n            obj.dir = this._dir;\r\n        if (this._angle)\r\n            obj.angle = this._angle;\r\n        if (this._speed)\r\n            obj.speed = this._speed;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        if (obj.dir)\r\n            this._dir = obj.dir;\r\n        if (obj.angle)\r\n            this._angle = obj.angle;\r\n        if (obj.speed)\r\n            this._speed = obj.speed;\r\n    }\r\n}\r\nexports.default = MovableNode;\r\n//# sourceMappingURL=movable.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/movable.js?')},"../game-capsule/dist/lib/configobjects/package.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst access_1 = __webpack_require__(/*! ./access */ "../game-capsule/dist/lib/configobjects/access.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass PackageNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._items = [];\r\n        this.name = "背包";\r\n    }\r\n    ignore() { }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) { }\r\n        if (obj instanceof access_1.AccessNode) {\r\n            this._access = obj;\r\n        }\r\n        if (obj.type === NodeType.PackageItemType) {\r\n            this._items.push(obj);\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        super.removeNode(object);\r\n        if (object instanceof access_1.AccessNode) {\r\n            this._access = undefined;\r\n        }\r\n        if (object instanceof access_1.AccessNode) {\r\n            // TODO delete\r\n        }\r\n    }\r\n}\r\nexports.default = PackageNode;\r\nclass PackageItemNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "道具";\r\n    }\r\n    ignore() { }\r\n}\r\nexports.PackageItemNode = PackageItemNode;\r\n//# sourceMappingURL=package.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/package.js?')},"../game-capsule/dist/lib/configobjects/scene.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst _ = __webpack_require__(/*! lodash */ "../game-capsule/node_modules/lodash/lodash.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nclass SceneNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._elements = new Map();\r\n        this._terrains = new Map();\r\n        this._characters = new Map();\r\n        this._spawnpoints = new Map();\r\n        this._scenerys = new Map();\r\n        this.name = "场景";\r\n    }\r\n    get properties() {\r\n        return {};\r\n    }\r\n    get size() {\r\n        return this._map_size;\r\n    }\r\n    get terrainCollection() {\r\n        return this._terrain_collection;\r\n    }\r\n    set terrainCollection(node) {\r\n        if (node) {\r\n            this._terrain_collection = node;\r\n        }\r\n    }\r\n    get mossCollection() {\r\n        return this._moss_collection;\r\n    }\r\n    set mossCollection(node) {\r\n        if (node) {\r\n            this._moss_collection = node;\r\n        }\r\n    }\r\n    // 将旧的地块数据转化为新的二维数组结构\r\n    convertOldTerrainData() {\r\n        if (!this._terrain_collection) {\r\n            this._terrain_collection = new TerrainCollectionNode(this._cap, this);\r\n            if (this._map_size) {\r\n                this._terrain_collection.initTerrainCollection(this._map_size.rows, this._map_size.cols);\r\n            }\r\n        }\r\n        if (Array.from(this._terrains.values()).length > 0) {\r\n            this._terrain_collection.convertTerrainNodes(Array.from(this._terrains.values()));\r\n        }\r\n    }\r\n    converElementsToMoss() {\r\n        if (!this._moss_collection) {\r\n            this._moss_collection = new MossCollectionNode(this._cap, this);\r\n        }\r\n        this._moss_collection.convertElementLikeMossInScene();\r\n    }\r\n    appendNode(object) {\r\n        try {\r\n            super.appendNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        switch (object.type) {\r\n            case pixelpai_proto_1.op_def.NodeType.ElementNodeType:\r\n                this._elements.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainNodeType:\r\n                this._terrains.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.CharacterNodeType:\r\n                this._characters.set(object.id, object);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.SpawnPointType:\r\n                this._spawnpoints.set(object.id, object);\r\n                if (!!this._cap.root.settings.spawnpoint === false) {\r\n                    this._cap.root.settings.spawnpoint = object.id;\r\n                }\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainCollectionType:\r\n                this._terrain_collection = object;\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.MossCollectionType:\r\n                this._moss_collection = object;\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.SceneryType:\r\n                this._scenerys.set(object.id, object);\r\n                break;\r\n        }\r\n        if (object instanceof MapSizeNode) {\r\n            this._map_size = object;\r\n        }\r\n    }\r\n    removeNode(object) {\r\n        try {\r\n            super.removeNode(object);\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        if (object instanceof MapSizeNode) {\r\n            this._map_size = undefined;\r\n        }\r\n        switch (object.type) {\r\n            case pixelpai_proto_1.op_def.NodeType.ElementNodeType:\r\n                this._elements.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.TerrainNodeType:\r\n                this._terrains.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.CharacterNodeType:\r\n                this._characters.delete(object.id);\r\n                break;\r\n            case pixelpai_proto_1.op_def.NodeType.SpawnPointType:\r\n                this._spawnpoints.delete(object.id);\r\n                if (this._cap.root.settings.spawnpoint === object.id) {\r\n                    this._cap.root.settings.spawnpoint = 0;\r\n                }\r\n                break;\r\n        }\r\n    }\r\n    getElements() {\r\n        return Array.from(this._elements.values());\r\n    }\r\n    getTerrains() {\r\n        return Array.from(this._terrains.values());\r\n    }\r\n    getCharacterNode() {\r\n        return Array.from(this._characters.values());\r\n    }\r\n    getSpawnPointNode() {\r\n        return Array.from(this._spawnpoints.values());\r\n    }\r\n    getScenerys() {\r\n        return Array.from(this._scenerys.values());\r\n    }\r\n    serialize(container) {\r\n        super.serialize(container);\r\n        if (this._terrain_collection) {\r\n            this._terrain_collection.serialize(container);\r\n        }\r\n        if (this._moss_collection) {\r\n            this._moss_collection.serialize(container);\r\n        }\r\n    }\r\n}\r\nexports.default = SceneNode;\r\nclass MapSizeNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._cols = 0;\r\n        this._rows = 0;\r\n        this._tileWidth = 60;\r\n        this._tileHeight = 30;\r\n    }\r\n    get properties() {\r\n        return {\r\n            cols: this._cols,\r\n            rows: this._rows,\r\n            tileWidth: this._tileWidth,\r\n            tileHeight: this._tileHeight,\r\n        };\r\n    }\r\n    get rows() {\r\n        return this._rows;\r\n    }\r\n    set rows(n) {\r\n        this._rows = n;\r\n    }\r\n    get cols() {\r\n        return this._cols;\r\n    }\r\n    set cols(n) {\r\n        this._cols = n;\r\n    }\r\n    get tileWidth() {\r\n        return this._tileWidth;\r\n    }\r\n    set tileWidth(val) {\r\n        this._tileWidth = val;\r\n    }\r\n    get tileHeight() {\r\n        return this._tileHeight;\r\n    }\r\n    set tileHeight(val) {\r\n        this._tileHeight = val;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.mapSize)) {\r\n            game.mapSize = [];\r\n        }\r\n        return game.mapSize;\r\n    }\r\n    createProtocolObject() {\r\n        const ms = pixelpai_proto_1.op_gameconfig_01.MapSize.create();\r\n        ms.node = this.makeNode();\r\n        ms.cols = this._cols;\r\n        ms.rows = this._rows;\r\n        ms.tileWidth = this._tileWidth;\r\n        ms.tileHeight = this._tileHeight;\r\n        return ms;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const ms = data;\r\n        // deserialize other properties\r\n        this._rows = ms.rows;\r\n        this._cols = ms.cols;\r\n        this._tileWidth = ms.tileWidth;\r\n        this._tileHeight = ms.tileHeight;\r\n    }\r\n}\r\nexports.MapSizeNode = MapSizeNode;\r\nclass TerrainCollectionNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._data = [];\r\n    }\r\n    // 场景返回二维数组\r\n    get data() {\r\n        return this._data;\r\n    }\r\n    initTerrainCollection(rows, cols) {\r\n        this._data = [];\r\n        for (let i = 0; i < cols; i++) {\r\n            let row = new Array(rows).fill(0);\r\n            this._data.push(row);\r\n        }\r\n    }\r\n    convertTerrainNodes(terrains) {\r\n        if (terrains.length > 0) {\r\n            for (const terrain of terrains) {\r\n                const snKey = terrain.getSnKey();\r\n                const key = this.cap.root.palette.getPaletteKeyBySn(snKey);\r\n                const loc = terrain.convertToSprite();\r\n                if (!key) {\r\n                    this.cap.root.palette.addToPalette(terrain);\r\n                }\r\n                else {\r\n                    terrain.destroy();\r\n                }\r\n                if (loc.point3f) {\r\n                    const { x, y, z } = loc.point3f;\r\n                    const key = this.cap.root.palette.getPaletteKeyBySn(snKey);\r\n                    if (this._data.length > x && this._data[x].length > y) {\r\n                        this._data[x][y] = key;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // 如果场景调整，需要将二维数组调整\r\n    adjustTerrainsArray() {\r\n        if (this.parentObject.size) {\r\n            const { rows, cols } = this.parentObject\r\n                .size;\r\n            let newArr = [];\r\n            for (let i = 0; i < cols; i++) {\r\n                let row = new Array(rows).fill(0);\r\n                if (!this._data[i]) {\r\n                    newArr.push(row);\r\n                }\r\n                else {\r\n                    for (let j = 0; j < rows; j++) {\r\n                        if (this._data[i][j]) {\r\n                            row[j] = this._data[i][j];\r\n                        }\r\n                    }\r\n                    newArr.push(row);\r\n                }\r\n            }\r\n            this._data = newArr;\r\n        }\r\n    }\r\n    drawTerrains(locs, key) {\r\n        for (const loc of locs) {\r\n            const { x, y, z } = loc;\r\n            this._data[x][y] = key;\r\n        }\r\n    }\r\n    eraseTerrains(locs) {\r\n        for (const loc of locs) {\r\n            const { x, y } = loc;\r\n            if (x < 0 || y < 0) {\r\n                continue;\r\n            }\r\n            if (!this._data[x])\r\n                continue;\r\n            if (!this._data[x][y])\r\n                continue;\r\n            this._data[x][y] = 0;\r\n        }\r\n    }\r\n    createProtocolObject() {\r\n        const tc = pixelpai_proto_1.op_gameconfig_01.TerrainCollection.create();\r\n        tc.node = this.makeNode();\r\n        tc.data = pixelpai_proto_1.op_def.IntArrays.create();\r\n        for (let i = 0; i < this._data.length; i++) {\r\n            const row = this._data[i];\r\n            let rowData = pixelpai_proto_1.op_def.IntArray.create();\r\n            for (let j = 0; j < row.length; j++) {\r\n                rowData.value.push(row[j]);\r\n            }\r\n            if (tc.data.value) {\r\n                tc.data.value.push(rowData);\r\n            }\r\n        }\r\n        return tc;\r\n    }\r\n    serialize(container) {\r\n        container.terrain = this.createProtocolObject();\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const tc = data;\r\n        if (tc.data.value) {\r\n            for (let i = 0; i < tc.data.value.length; i++) {\r\n                const row = tc.data.value[i];\r\n                if (row.value) {\r\n                    this._data.push(row.value);\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.TerrainCollectionNode = TerrainCollectionNode;\r\nclass MossCollectionNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._data = [];\r\n        this._data_map = new Map();\r\n    }\r\n    get data() {\r\n        return this._data;\r\n    }\r\n    get dataMap() {\r\n        return this._data_map;\r\n    }\r\n    placeMosses(locs) {\r\n        for (const loc of locs) {\r\n            if (!this._data_map.get(loc.id)) {\r\n                this._data_map.set(loc.id, loc);\r\n            }\r\n        }\r\n    }\r\n    updateMosses(locs) {\r\n        for (const loc of locs) {\r\n            if (this._data_map.get(loc.id)) {\r\n                this._data_map.set(loc.id, loc);\r\n            }\r\n        }\r\n    }\r\n    removeMosses(ids) {\r\n        for (const id of ids) {\r\n            this._data_map.delete(id);\r\n        }\r\n    }\r\n    getMoss(id) {\r\n        return this._data_map.get(id);\r\n    }\r\n    convertElementLikeMossInScene() {\r\n        const elements = this._cap.getChildrenList(this.parent);\r\n        const mossElements = elements\r\n            .filter((ele) => ele.type === pixelpai_proto_1.op_def.NodeType.ElementNodeType &&\r\n            ele.judgeIsMoss())\r\n            .map((ele) => {\r\n            ele.elementSn = `${ele.sn}#${ele.version}`;\r\n            return ele;\r\n        });\r\n        const group = _.groupBy(mossElements, "elementSn");\r\n        let needAppendToMossPalette = [];\r\n        for (const key of Object.keys(group)) {\r\n            const sameMosses = group[key];\r\n            const originMoss = sameMosses.find((moss) => !moss.isFork);\r\n            if (originMoss) {\r\n                needAppendToMossPalette.push(originMoss);\r\n            }\r\n            else {\r\n                needAppendToMossPalette.push(sameMosses.pop());\r\n            }\r\n        }\r\n        for (const palette of needAppendToMossPalette) {\r\n            palette.unlink();\r\n            palette.parent = 0;\r\n            this._cap.root.moss.addToPalette(palette);\r\n            this._cap.removeObjectById(palette.id);\r\n        }\r\n        const appendPaletteIds = needAppendToMossPalette.map((ele) => ele.id);\r\n        for (const element of elements) {\r\n            if (element.type === pixelpai_proto_1.op_def.NodeType.ElementNodeType) {\r\n                if (element.judgeIsMoss()) {\r\n                    const [sn, ver] = element.getSnAndVersion();\r\n                    const elementSn = helpers_1.default.getElementSn(sn, ver);\r\n                    let key = this._cap.root.moss.getPaletteKeyBySn(elementSn);\r\n                    if (!key)\r\n                        continue;\r\n                    const loc = {\r\n                        key,\r\n                        x: element.location.x,\r\n                        y: element.location.y,\r\n                        z: element.location.z,\r\n                        dir: element.animations.dir,\r\n                        id: element.id,\r\n                    };\r\n                    this._data_map.set(element.id, loc);\r\n                    if (appendPaletteIds.indexOf(element.id) < 0) {\r\n                        element.destroy();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    createProtocolObject() {\r\n        const mossCollection = pixelpai_proto_1.op_gameconfig_01.MossCollection.create();\r\n        mossCollection.node = this.makeNode();\r\n        mossCollection.data = pixelpai_proto_1.op_def.LocationMap.create();\r\n        for (const key of Array.from(this._data_map.keys())) {\r\n            const loc = this._data_map.get(key);\r\n            const val = pixelpai_proto_1.op_def.MossMetaData.create(loc);\r\n            if (mossCollection.data.locations) {\r\n                mossCollection.data.locations.push(val);\r\n            }\r\n        }\r\n        return mossCollection;\r\n    }\r\n    serialize(container) {\r\n        container.mossList = this.createProtocolObject();\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const mc = data;\r\n        if (mc.data.locations) {\r\n            mc.data.locations.forEach((loc) => {\r\n                const location = pixelpai_proto_1.op_def.MossMetaData.create(loc);\r\n                this._data.push(location);\r\n                this._data_map.set(location.id, location);\r\n            });\r\n        }\r\n    }\r\n}\r\nexports.MossCollectionNode = MossCollectionNode;\r\n//# sourceMappingURL=scene.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/scene.js?')},"../game-capsule/dist/lib/configobjects/scenery.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass SceneryNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._uris = [];\r\n        this._depth = 1;\r\n        this._fit = 1;\r\n        this.name = "天空盒";\r\n        this.offset = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n        this.offset.x = 0;\r\n        this.offset.y = 0;\r\n    }\r\n    get width() {\r\n        return this._width;\r\n    }\r\n    set width(val) {\r\n        this._width = val;\r\n    }\r\n    get height() {\r\n        return this._height;\r\n    }\r\n    set height(val) {\r\n        this._height = val;\r\n    }\r\n    get uris() {\r\n        return this._uris;\r\n    }\r\n    set uris(val) {\r\n        this._uris = val;\r\n    }\r\n    get depth() {\r\n        return this._depth;\r\n    }\r\n    set depth(val) {\r\n        this._depth = val;\r\n    }\r\n    get offset() {\r\n        return this._offset;\r\n    }\r\n    set offset(val) {\r\n        this._offset = val;\r\n    }\r\n    get speed() {\r\n        return this._speed;\r\n    }\r\n    set speed(val) {\r\n        this._speed = val;\r\n    }\r\n    get fit() {\r\n        return this._fit;\r\n    }\r\n    set fit(val) {\r\n        this._fit = val;\r\n    }\r\n    get properties() {\r\n        return {\r\n            uris: this.uris,\r\n            depth: this.depth,\r\n            offset: this.offset,\r\n            speed: this.speed,\r\n            fit: this.fit,\r\n            width: this.width,\r\n            height: this.height,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.seneries)) {\r\n            game.seneries = [];\r\n        }\r\n        return game.seneries;\r\n    }\r\n    createProtocolObject() {\r\n        const scenery = pixelpai_proto_1.op_gameconfig_01.Scenery.create();\r\n        scenery.node = this.makeNode();\r\n        const uris = pixelpai_proto_1.op_def.StrArrays.create();\r\n        for (const row of this.uris) {\r\n            const uriRow = pixelpai_proto_1.op_def.StrArray.create();\r\n            for (const uri of row) {\r\n                uriRow.value.push(uri);\r\n            }\r\n            uris.value.push(uriRow);\r\n        }\r\n        scenery.uris = uris;\r\n        scenery.depth = this.depth;\r\n        if (this.offset) {\r\n            const offset = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n            offset.x = this.offset.x;\r\n            offset.y = this.offset.y;\r\n            scenery.offset = offset;\r\n        }\r\n        scenery.speed = this.speed;\r\n        scenery.fit = this.fit;\r\n        scenery.width = this.width;\r\n        scenery.height = this.height;\r\n        return scenery;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const scenery = data;\r\n        if (scenery.uris.value) {\r\n            for (const row of scenery.uris.value) {\r\n                let uriRow = [];\r\n                if (row.value) {\r\n                    for (const uri of row.value) {\r\n                        uriRow.push(uri);\r\n                    }\r\n                    this.uris.push(uriRow);\r\n                }\r\n            }\r\n        }\r\n        this.depth = scenery.depth;\r\n        if (scenery.offset) {\r\n            this.offset = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n            this.offset.x = scenery.offset.x;\r\n            this.offset.y = scenery.offset.y;\r\n        }\r\n        else {\r\n            this.offset = pixelpai_proto_1.op_def.PBPoint2f.create();\r\n            this.offset.x = 0;\r\n            this.offset.y = 0;\r\n        }\r\n        this.speed = scenery.speed;\r\n        this.fit = scenery.fit;\r\n        if (scenery.width) {\r\n            this.width = scenery.width;\r\n        }\r\n        if (scenery.height) {\r\n            this.height = scenery.height;\r\n        }\r\n    }\r\n}\r\nexports.default = SceneryNode;\r\n//# sourceMappingURL=scenery.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/scenery.js?')},"../game-capsule/dist/lib/configobjects/shop.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nconst package_1 = __webpack_require__(/*! ./package */ "../game-capsule/dist/lib/configobjects/package.js");\r\nclass ShopNode extends config_object_1.EntityNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._items = [];\r\n        this.name = "内购商城";\r\n    }\r\n    ignore() { }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) { }\r\n        if (obj.type === NodeType.PackageItemType) {\r\n            this._items.push(obj);\r\n        }\r\n    }\r\n}\r\nexports.default = ShopNode;\r\nclass ShopItemNode extends package_1.PackageItemNode {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "内购道具";\r\n        this.type = pixelpai_proto_1.op_def.NodeType.PackageItemType;\r\n    }\r\n    appendNode(obj) {\r\n        try {\r\n            super.appendNode(obj);\r\n        }\r\n        catch (e) {\r\n            if (obj.type === NodeType.CommodityType) {\r\n                this._commodity = obj;\r\n            }\r\n        }\r\n    }\r\n}\r\nexports.ShopItemNode = ShopItemNode;\r\nclass CommodityNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._price = 100;\r\n        this._des = "";\r\n        this._coinType = pixelpai_proto_1.op_def.CoinType.TU_DING_COIN;\r\n        this.name = "售价";\r\n    }\r\n    get properties() {\r\n        return {\r\n            price: this.price,\r\n            description: this.description,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!game.commodities) {\r\n            game.commodities = [];\r\n        }\r\n        return game.commodities;\r\n    }\r\n    createProtocolObject() {\r\n        const commodity = pixelpai_proto_1.op_gameconfig_01.Commodity.create();\r\n        commodity.node = this.makeNode();\r\n        commodity.description = this._des;\r\n        commodity.coinType = this._coinType;\r\n        commodity.price = this._price;\r\n        return commodity;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const as = data;\r\n        // deserialize other properties\r\n        this._price = as.price || 100;\r\n        this._des = as.description || "";\r\n        this._coinType = as.coinType || pixelpai_proto_1.op_def.CoinType.TU_DING_COIN;\r\n    }\r\n    set price(val) {\r\n        if (this.coinType === pixelpai_proto_1.op_def.CoinType.TU_DING_COIN) {\r\n            if (val < 10 || val > 99999) {\r\n                throw new Error("图钉有效价格在10-99999");\r\n            }\r\n        }\r\n        this._price = val;\r\n    }\r\n    get price() {\r\n        return this._price;\r\n    }\r\n    set description(val) {\r\n        this._des = val;\r\n    }\r\n    get description() {\r\n        return this._des;\r\n    }\r\n    get coinType() {\r\n        return this._coinType;\r\n    }\r\n}\r\nexports.CommodityNode = CommodityNode;\r\n//# sourceMappingURL=shop.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/shop.js?')},"../game-capsule/dist/lib/configobjects/spawnpoint.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst helpers_1 = __webpack_require__(/*! ../helpers */ "../game-capsule/dist/lib/helpers.js");\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass SpawnPointNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "出生点";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.spawnpoint)) {\r\n            game.spawnpoint = [];\r\n        }\r\n        return game.spawnpoint;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.SpawnPoint.create();\r\n        obj.node = this.makeNode();\r\n        // 这个location是个错误，但是我们将错就错。\r\n        // 注意： 千万别把这个location当node加入到 capsule的objects map中。它是成员，不是节点。\r\n        if (this._loc)\r\n            obj.loc = this._loc;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this.location.node = obj.loc.node;\r\n        this.location.x = obj.loc.x;\r\n        this.location.y = obj.loc.y;\r\n        this.location.z = obj.loc.z;\r\n    }\r\n    importSprite(sprite) {\r\n        this.cap.removeObject(this);\r\n        this.id = sprite.id;\r\n        this.name = sprite.nickname || this.name;\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        this.cap.addObject(this);\r\n        return this;\r\n    }\r\n    syncSprite(sprite) {\r\n        const point = sprite.point3f;\r\n        if (point) {\r\n            this.location.x = point.x;\r\n            this.location.y = point.y;\r\n            this.location.z = point.z || 0;\r\n        }\r\n        // this.animations.syncSprite(sprite);\r\n        return this;\r\n    }\r\n    convertToSprite() {\r\n        const sprite = pixelpai_proto_1.op_client.Sprite.create();\r\n        sprite.id = this.id;\r\n        sprite.nickname = this.name;\r\n        const point3 = pixelpai_proto_1.op_def.PBPoint3f.create();\r\n        point3.x = this.location.x;\r\n        point3.y = this.location.y;\r\n        point3.z = this.location.z;\r\n        sprite.point3f = point3;\r\n        sprite.display = this.display;\r\n        sprite.animations = [this.animation];\r\n        sprite.currentAnimationName = this.animation.node.name;\r\n        sprite.direction = 3;\r\n        return sprite;\r\n    }\r\n    get display() {\r\n        if (!this._display) {\r\n            this._display = pixelpai_proto_1.op_gameconfig.Display.create();\r\n            this._display.texturePath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.png";\r\n            this._display.dataPath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.json";\r\n        }\r\n        return this._display;\r\n    }\r\n    get animation() {\r\n        if (!this._animation) {\r\n            const node = pixelpai_proto_1.op_gameconfig_01.Node.create();\r\n            node.name = "idle";\r\n            node.Parent = this.id;\r\n            this._animation = pixelpai_proto_1.op_gameconfig_01.AnimationData.create();\r\n            this._animation.node = node;\r\n            this._animation.frameRate = 5;\r\n            this._animation.collisionArea = "1,1&1,1";\r\n            this._animation.loop = true;\r\n            this._animation.baseLoc = "-30,-30";\r\n            this._animation.originPoint = [0, 0];\r\n            this._animation.frameName = ["switch_0027_3_01.png"];\r\n        }\r\n        return this._animation;\r\n    }\r\n    get location() {\r\n        if (!this._loc) {\r\n            this._loc = pixelpai_proto_1.op_gameconfig_01.Location.create();\r\n            // this._loc.node = this.makeNode();\r\n            const nd = (this._loc.node = pixelpai_proto_1.op_gameconfig_01.Node.create());\r\n            nd.id = helpers_1.default.genId();\r\n            nd.name = "位置";\r\n            nd.Parent = this.id;\r\n            nd.type = NodeType.LocationType;\r\n        }\r\n        return this._loc;\r\n    }\r\n}\r\nexports.default = SpawnPointNode;\r\n//# sourceMappingURL=spawnpoint.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/spawnpoint.js?')},"../game-capsule/dist/lib/configobjects/terrain.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst element_1 = __webpack_require__(/*! ./element */ "../game-capsule/dist/lib/configobjects/element.js");\r\nclass TerrainNode extends element_1.default {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "地形";\r\n    }\r\n}\r\nexports.TerrainNode = TerrainNode;\r\n//# sourceMappingURL=terrain.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/terrain.js?')},"../game-capsule/dist/lib/configobjects/timer.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass TimerNode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this._timeout = 0;\r\n        this._interval = 0;\r\n        this.name = "计时器";\r\n    }\r\n    get properties() {\r\n        return {\r\n            timeout: this._timeout,\r\n            interval: this._interval,\r\n        };\r\n    }\r\n    set timeout(val) {\r\n        this._timeout = val;\r\n    }\r\n    get timeout() {\r\n        return this._timeout;\r\n    }\r\n    set interval(val) {\r\n        this._interval = val;\r\n    }\r\n    get interval() {\r\n        return this._interval;\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.timer)) {\r\n            game.timer = [];\r\n        }\r\n        return game.timer;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Timer.create();\r\n        obj.node = this.makeNode();\r\n        obj.timeout = this._timeout;\r\n        obj.interval = this._interval;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._timeout = obj.timeout;\r\n        this._interval = obj.interval;\r\n    }\r\n}\r\nexports.default = TimerNode;\r\n//# sourceMappingURL=timer.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/timer.js?')},"../game-capsule/dist/lib/configobjects/ui.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst config_object_1 = __webpack_require__(/*! ./config_object */ "../game-capsule/dist/lib/configobjects/config_object.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nclass UINode extends config_object_1.BaseConfigObject {\r\n    constructor(cap, parent) {\r\n        super(cap, parent);\r\n        this.name = "界面";\r\n    }\r\n    get properties() {\r\n        return {\r\n            text: this._text,\r\n        };\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.ui)) {\r\n            game.ui = [];\r\n        }\r\n        return game.ui;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.UI.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n    }\r\n}\r\nexports.default = UINode;\r\nclass TextNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._text = "";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.text)) {\r\n            game.text = [];\r\n        }\r\n        return game.text;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Text.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n    }\r\n}\r\nexports.TextNode = TextNode;\r\nclass ButtonNode extends config_object_1.BaseConfigObject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._text = "";\r\n    }\r\n    findMyContainer(game) {\r\n        if (!Array.isArray(game.button)) {\r\n            game.button = [];\r\n        }\r\n        return game.button;\r\n    }\r\n    createProtocolObject() {\r\n        const obj = pixelpai_proto_1.op_gameconfig_01.Button.create();\r\n        obj.node = this.makeNode();\r\n        obj.text = this._text;\r\n        if (this._tips)\r\n            obj.tips = this._tips;\r\n        return obj;\r\n    }\r\n    deserialize(data) {\r\n        super.deserialize(data);\r\n        const obj = data;\r\n        this._text = obj.text;\r\n        if (obj.tips)\r\n            this._tips = obj.tips;\r\n    }\r\n}\r\nexports.ButtonNode = ButtonNode;\r\n//# sourceMappingURL=ui.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/configobjects/ui.js?')},"../game-capsule/dist/lib/constants.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nconst NodeType = pixelpai_proto_1.op_def.NodeType;\r\nclass Constants {\r\n}\r\nConstants.MAX_ID = Math.pow(2, 31);\r\nConstants.NODE_T = [\r\n    null,\r\n    `GameNode`,\r\n    `SceneNode`,\r\n    `ElementNode`,\r\n    `TerrainNode`,\r\n    `CharacterNode`,\r\n    `LocationNode`,\r\n    `MovableNode`,\r\n    `DisplayNode`,\r\n    `AttributeNode`,\r\n    `FunctionNode`,\r\n    `AnimationsNode`,\r\n    `EventNode`,\r\n    `MapSizeNode`,\r\n    `UINode`,\r\n    `TimerNode`,\r\n    `PackageNode`,\r\n    `PackageItemNode`,\r\n    `AvatarNode`,\r\n    `SettingsNode`,\r\n    `CampNode`,\r\n    `MutexNode`,\r\n    `AnimationDataNode`,\r\n    `ForkNode`,\r\n    `ButtonNode`,\r\n    `TextNode`,\r\n    `AccessNode`,\r\n    `SpawnPointNode`,\r\n    `CommodityNode`,\r\n    `ShopNode`,\r\n    `PaletteNode`,\r\n    `TerrainCollectionNode`,\r\n    `AssetsNode`,\r\n    `MossNode`,\r\n    `MossCollectionNode`,\r\n    `SceneryNode`,\r\n    `ModsNode`,\r\n];\r\nConstants.NODE_T_CN_Map = {\r\n    GameNode: "游戏",\r\n    SceneNode: "场景",\r\n    ElementNode: "物件",\r\n    TerrainNode: "地块",\r\n    CharacterNode: "角色",\r\n    LocationNode: "位置",\r\n    MovableNode: "可移动",\r\n    DisplayNode: "显示",\r\n    AttributeNode: "属性",\r\n    FunctionNode: "方法",\r\n    AnimationsNode: "动画",\r\n    EventNode: "事件",\r\n    MapSizeNode: "场景尺寸",\r\n    UINode: "交互显示",\r\n    TimerNode: "计时器",\r\n    PackageNode: "背包",\r\n    PackageItemNode: "背包道具",\r\n    AvatarNode: "装扮",\r\n    SettingsNode: "游戏设置",\r\n    CampNode: "阵营",\r\n    MutexNode: "互斥",\r\n    AnimationDataNode: "动画数据",\r\n    ForkNode: "备份节点",\r\n    ButtonNode: "按钮",\r\n    TextNode: "文字",\r\n    AccessNode: "传送点",\r\n    SpawnPointNode: "出生点",\r\n    ShopNode: "内购商城",\r\n    CommodityNode: "商品",\r\n    AssetsNode: "资源仓库",\r\n    SceneryNode: "天空盒",\r\n};\r\nConstants.NODETYPEMAP = {\r\n    [NodeType.GameNodeType]: "GameNode",\r\n    [NodeType.SceneNodeType]: "SceneNode",\r\n    [NodeType.ElementNodeType]: `ElementNode`,\r\n    [NodeType.TerrainNodeType]: `TerrainNode`,\r\n    [NodeType.CharacterNodeType]: `CharacterNode`,\r\n    [NodeType.LocationType]: `LocationNode`,\r\n    [NodeType.MovableType]: `MovableNode`,\r\n    [NodeType.DisplayType]: `DisplayNode`,\r\n    [NodeType.AttributeType]: `AttributeNode`,\r\n    [NodeType.FunctionType]: `FunctionNode`,\r\n    [NodeType.AnimationsType]: `AnimationsNode`,\r\n    [NodeType.EventType]: `EventNode`,\r\n    [NodeType.MapSizeType]: `MapSizeNode`,\r\n    [NodeType.UIType]: `UINode`,\r\n    [NodeType.TimerType]: `TimerNode`,\r\n    [NodeType.PackageType]: `PackageNode`,\r\n    [NodeType.PackageItemType]: `PackageItemNode`,\r\n    [NodeType.AvatarType]: `AvatarNode`,\r\n    [NodeType.SettingsType]: `SettingsNode`,\r\n    [NodeType.CampType]: `CampNode`,\r\n    [NodeType.MutexType]: `MutexNode`,\r\n    [NodeType.AnimationDataType]: `AnimationDataNode`,\r\n    [NodeType.ForkType]: `ForkNode`,\r\n    [NodeType.ButtonType]: `ButtonNode`,\r\n    [NodeType.TextType]: `TextNode`,\r\n    [NodeType.AccessType]: `AccessNode`,\r\n    [NodeType.SpawnPointType]: `SpawnPointNode`,\r\n    [NodeType.CommodityType]: `CommodityNode`,\r\n    [NodeType.ShopType]: "ShopNode",\r\n    [NodeType.PaletteType]: "PaletteNode",\r\n    [NodeType.TerrainCollectionType]: "TerrainCollectionNode",\r\n    [NodeType.AssetsType]: "AssetsNode",\r\n    [NodeType.MossType]: "MossNode",\r\n    [NodeType.MossCollectionType]: "MossCollectionNode",\r\n    [NodeType.SceneryType]: "SceneryNode",\r\n    [NodeType.ModsType]: "ModsNode",\r\n};\r\nexports.default = Constants;\r\n//# sourceMappingURL=constants.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/constants.js?')},"../game-capsule/dist/lib/helpers.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst CryptoJS = __webpack_require__(/*! crypto-js */ "../game-capsule/node_modules/crypto-js/index.js");\r\nconst Chance = __webpack_require__(/*! chance */ "../game-capsule/node_modules/chance/chance.js");\r\nconst constants_1 = __webpack_require__(/*! ./constants */ "../game-capsule/dist/lib/constants.js");\r\nclass Helpers {\r\n    static genId() {\r\n        return new Chance().natural({\r\n            min: 10000,\r\n            max: constants_1.default.MAX_ID,\r\n        });\r\n    }\r\n    static getClassName(instanceObj) {\r\n        return instanceObj.constructor.name;\r\n    }\r\n    // return hex encode of string hashed by sha1.\r\n    static sha1(s) {\r\n        return CryptoJS.enc.Hex.stringify(CryptoJS.SHA1(s));\r\n    }\r\n    static pointToString(p) {\r\n        return `${p.x},${p.y}`;\r\n    }\r\n    static flipArray(source) {\r\n        const array = [...source];\r\n        const result = [];\r\n        if (array.length > 0) {\r\n            const len = array[0].length;\r\n            for (let i = 0; i < len; i++) {\r\n                result[i] = [];\r\n                for (let j = 0; j < array.length; j++) {\r\n                    result[i].push(array[j][i]);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    static arrayToString(array, fristJoin, lastJoin) {\r\n        const tmp = [];\r\n        for (const ary of array) {\r\n            tmp.push(ary.join(fristJoin));\r\n        }\r\n        return tmp.join(lastJoin);\r\n    }\r\n    static stringToArray(string, fristJoin, lastJoin) {\r\n        const tmp = string.split(lastJoin);\r\n        const result = [];\r\n        for (const ary of tmp) {\r\n            const tmpAry = ary.split(fristJoin);\r\n            result.push(tmpAry.map((value) => parseInt(value)));\r\n        }\r\n        return result;\r\n    }\r\n    static getSnAndVersion(dataPath) {\r\n        let sn = "";\r\n        let ver = "1";\r\n        const reg = new RegExp(/.*\\/(Terrain|Element)Node\\/([a-f\\d]{24})\\/(\\d+)\\/[a-f\\d]{24}\\.json/);\r\n        const ret = dataPath.match(reg);\r\n        if (ret) {\r\n            ver = ret[2];\r\n            sn = ret[1];\r\n        }\r\n        return [sn, ver];\r\n    }\r\n    static getElementSn(sn, version = "1") {\r\n        return `${sn}#${version}`;\r\n    }\r\n}\r\nHelpers.ID_VOL = 900000;\r\nexports.default = Helpers;\r\n//# sourceMappingURL=helpers.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/helpers.js?')},"../game-capsule/dist/lib/lite.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nconst capsule_1 = __webpack_require__(/*! ./capsule */ "../game-capsule/dist/lib/capsule.js");\r\nconst pixelpai_proto_1 = __webpack_require__(/*! pixelpai_proto */ "../game-capsule/node_modules/pixelpai_proto/protocols.js");\r\nvar Game = pixelpai_proto_1.op_gameconfig_01.Game;\r\nvar NodeType = pixelpai_proto_1.op_def.NodeType;\r\nconst WHITE_LIST = [\r\n    NodeType.SceneNodeType,\r\n    NodeType.ElementNodeType,\r\n    NodeType.TerrainNodeType,\r\n    NodeType.PackageItemType,\r\n    NodeType.ForkType,\r\n    NodeType.CharacterNodeType,\r\n    NodeType.AvatarType,\r\n    NodeType.AnimationsType,\r\n    NodeType.AnimationDataType,\r\n    NodeType.DisplayType,\r\n    NodeType.TerrainCollectionType,\r\n    NodeType.MossCollectionType,\r\n    NodeType.SceneryType\r\n];\r\n// Lite is another entry of game-capsule,\r\n// its a readonly minimal Client-use controller.\r\nclass Lite extends capsule_1.default {\r\n    constructor() {\r\n        super();\r\n    }\r\n    deserialize(buffer) {\r\n        const message = Game.decode(buffer);\r\n        const delayDeserialize = [];\r\n        // 1. deserialize game\r\n        this._root.deserialize(message);\r\n        this._root.preDeserializePalettes(message);\r\n        // 2-1. deserialize other objects.\r\n        let tmp = [];\r\n        const arr = tmp.concat(message.entity, message.animations, message.animationdatas, message.avatar, message.display, message.terrain, message.mossList, message.seneries);\r\n        for (let proto of arr) {\r\n            if (!proto)\r\n                continue;\r\n            const nodeType = proto.node.type;\r\n            if (nodeType && WHITE_LIST.indexOf(nodeType) !== -1)\r\n                if (nodeType == NodeType.ForkType) {\r\n                    // Fork 节点放到最后反序列化，确保他的parent先被加到树中。\r\n                    delayDeserialize.push(proto);\r\n                }\r\n                else {\r\n                    this.doDeserialize(proto);\r\n                }\r\n        }\r\n        // 2-2. deserialize all Fork objects\r\n        for (const proto of delayDeserialize) {\r\n            this.doDeserialize(proto);\r\n        }\r\n        // 2-3. Link all ConfigObjects\r\n        this._objects.forEach((object) => {\r\n            object.link();\r\n        });\r\n        this._root.deserializePalettes(message);\r\n    }\r\n    serialize() {\r\n        throw new Error("don\'t serialize");\r\n    }\r\n}\r\nexports.default = Lite;\r\n//# sourceMappingURL=lite.js.map\n\n//# sourceURL=webpack://TooqingCore/../game-capsule/dist/lib/lite.js?')},"./lib/rexui/lib/plugins/bbcodetext-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_text_bbcodetext_Factory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/Factory */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Factory.js");\n/* harmony import */ var _gameobjects_text_bbcodetext_Creator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/Creator */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Creator.js");\n/* harmony import */ var _gameobjects_text_bbcodetext_BBCodeText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/BBCodeText */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _utils_object_SetValue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass BBCodeTextPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexBBCodeText\', _gameobjects_text_bbcodetext_Factory__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_text_bbcodetext_Creator__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.on(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.BBCodeText\', _gameobjects_text_bbcodetext_BBCodeText__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BBCodeTextPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/bbcodetext-plugin.js?')},"./lib/rexui/lib/plugins/bbcodetext.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_text_bbcodetext_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/Factory.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Factory.js");\n/* harmony import */ var _gameobjects_text_bbcodetext_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/Creator.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Creator.js");\n/* harmony import */ var _gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n\r\n\r\n\r\n\r\nPhaser.GameObjects.GameObjectFactory.register(\'rexBBCodeText\', _gameobjects_text_bbcodetext_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\nPhaser.GameObjects.GameObjectCreator.register(\'rexBBCodeText\', _gameobjects_text_bbcodetext_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/bbcodetext.js?')},"./lib/rexui/lib/plugins/behaviors/anchor/Anchor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetViewport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetViewport.js */ \"./lib/rexui/lib/plugins/behaviors/anchor/GetViewport.js\");\n\r\n\r\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nclass Anchor {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.viewport = new Rectangle();\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        var alignX, configX;\r\n        if (o.x !== undefined) {\r\n            alignX = null;\r\n            configX = o.x;\r\n        } else if (o.left !== undefined) {\r\n            alignX = 0;\r\n            configX = o.left;\r\n        } else if (o.right !== undefined) {\r\n            alignX = 1;\r\n            configX = o.right;\r\n        } else if (o.centerX !== undefined) {\r\n            alignX = 0.5;\r\n            configX = o.centerX;\r\n        }\r\n\r\n        var alignY, configY;\r\n        if (o.y !== undefined) {\r\n            alignY = null;\r\n            configY = o.y;\r\n        } else if (o.top !== undefined) {\r\n            alignY = 0;\r\n            configY = o.top;\r\n        } else if (o.bottom !== undefined) {\r\n            alignY = 1;\r\n            configY = o.bottom;\r\n        } else if (o.centerY !== undefined) {\r\n            alignY = 0.5;\r\n            configY = o.centerY;\r\n        }\r\n\r\n        var percentageX, offsetX;\r\n        if (configX !== undefined) {\r\n            configX = configX.replace('left', '0%').replace('right', '100%').replace('center', '50%').split('%');\r\n            percentageX = parseFloat(configX[0]) / 100;\r\n            offsetX = (configX[1] === '') ? 0 : parseFloat(configX[1]);\r\n        }\r\n        var percentageY, offsetY;\r\n        if (configY !== undefined) {\r\n            configY = configY.replace('top', '0%').replace('bottom', '100%').replace('center', '50%').split('%');\r\n            percentageY = parseFloat(configY[0]) / 100;\r\n            offsetY = (configY[1] === '') ? 0 : parseFloat(configY[1]);\r\n        }\r\n\r\n        this.setAlign(alignX, alignY);\r\n        this.setPercentage(percentageX, percentageY);\r\n        this.setOffset(offsetX, offsetY);\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scaleManamger.on('resize', this.anchor, this);\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n\r\n        this.anchor();\r\n    }\r\n\r\n    shutdown() {\r\n        this.scaleManamger.off('resize', this.anchor, this);\r\n        this.gameObject = undefined;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setAlign(x, y) {\r\n        this.alignX = x;\r\n        this.alignY = y;\r\n        return this;\r\n    }\r\n\r\n    setPercentage(x, y) {\r\n        this.percentageX = x;\r\n        this.percentageY = y;\r\n        return this;\r\n    }\r\n\r\n    setOffset(x, y) {\r\n        this.offsetX = x;\r\n        this.offsetY = y;\r\n        return this;\r\n    }\r\n\r\n    anchor() {\r\n        Object(_GetViewport_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.scaleManamger, this.viewport);\r\n        this.updatePosition();\r\n        return this;\r\n    }\r\n\r\n    updatePosition() {\r\n        var gameObject = this.gameObject;\r\n\r\n        if (this.alignX === null) {\r\n            gameObject.x = this.anchorX;\r\n        } else if (this.alignX !== undefined) {\r\n            gameObject.x = this.anchorX + (gameObject.displayWidth * (gameObject.originX - this.alignX));\r\n        }\r\n\r\n        if (this.alignY === null) {\r\n            this.gameObject.y = this.anchorY;\r\n        } else if (this.alignY !== undefined) {\r\n            gameObject.y = this.anchorY + (gameObject.displayHeight * (gameObject.originY - this.alignY));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get scaleManamger() {\r\n        return this.gameObject.scene.scale;\r\n    }\r\n\r\n    get anchorX() {\r\n        return this.viewport.x + (this.viewport.width * this.percentageX) + this.offsetX;\r\n    }\r\n\r\n    get anchorY() {\r\n        return this.viewport.y + (this.viewport.height * this.percentageY) + this.offsetY;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Anchor);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/anchor/Anchor.js?")},"./lib/rexui/lib/plugins/behaviors/anchor/GetViewport.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nvar GetViewport = function (scaleManager, out) {\r\n    if (out === undefined) {\r\n        out = new Rectangle();\r\n    }\r\n    var bounds = scaleManager.canvasBounds;\r\n    var scale = scaleManager.displayScale;\r\n    var autoCenter = scaleManager.autoCenter;\r\n    out.x = (bounds.x >= 0) ? 0 : -(bounds.x * scale.x);\r\n    out.y = (bounds.y >= 0) ? 0 : -(bounds.y * scale.y);\r\n    out.width = (bounds.width * scale.x) - out.x;\r\n    out.height = (bounds.height * scale.y) - out.y;\r\n    if ((autoCenter === 1) || (autoCenter === 2)) {\r\n        out.width -= out.x;\r\n    }\r\n    if ((autoCenter === 1) || (autoCenter === 3)) {\r\n        out.height -= out.y;\r\n    }\r\n    return out;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetViewport);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/anchor/GetViewport.js?')},"./lib/rexui/lib/plugins/behaviors/fade/Fade.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/tween/TweenBase.js */ \"./lib/rexui/lib/plugins/utils/tween/TweenBase.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Fade extends _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject);\r\n        this.gameObject = gameObject;\r\n\r\n        this.alphaStart = undefined;\r\n        this.alphaEnd = undefined;\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setMode(GetValue(o, 'mode', 0));\r\n        this.setAlphaRange(\r\n            GetAdvancedValue(o, 'start', this.gameObject.alpha),\r\n            GetAdvancedValue(o, 'end', 0)\r\n        );\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 1000));\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            mode: this.mode,\r\n            start: this.alphaStart,\r\n            end: this.alphaEnd,\r\n            delay: this.delay,\r\n            duration: this.duration\r\n        };\r\n    }\r\n\r\n    shutdown() {\r\n        super.shutdown();\r\n        this.gameObject = undefined;\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = MODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setAlphaRange(start, end) {\r\n        this.alphaStart = start;\r\n        this.alphaEnd = end;\r\n        return this;\r\n    }\r\n\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setAlpha(this.alphaStart);\r\n        super.start({\r\n            targets: this.gameObject,\r\n            alpha: this.alphaEnd,\r\n\r\n            delay: this.delay,\r\n            duration: this.duration,\r\n            ease: 'Linear',\r\n            yoyo: (this.mode == 2),\r\n            repeat: ((this.mode == 2) ? -1 : 0)\r\n        });\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        super.complete();\r\n        if (this.mode === 1) {\r\n            this.gameObject.destroy();\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nconst MODE = {\r\n    stop: 0,\r\n    destroy: 1,\r\n    yoyo: 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Fade);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/fade/Fade.js?")},"./lib/rexui/lib/plugins/behaviors/flip/Flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/tween/TweenBase.js */ \"./lib/rexui/lib/plugins/utils/tween/TweenBase.js\");\n/* harmony import */ var _GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetFaceUpdatingCallback.js */ \"./lib/rexui/lib/plugins/behaviors/flip/GetFaceUpdatingCallback.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Flip extends _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, { eventEmitter: true });\r\n        this.gameObject = gameObject;\r\n\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setOrientation(GetValue(o, 'orientation', 0));\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 500));\r\n        this.setEase(GetValue(o, 'ease', 'Sine'));\r\n\r\n        this.setFrontFace(GetValue(o, 'front', undefined));\r\n        this.setBackFace(GetValue(o, 'back', undefined));\r\n        this.setFace(GetValue(o, 'face', 0));\r\n        return this;\r\n    }\r\n\r\n    shutdown() {\r\n        super.shutdown();\r\n        this.gameObject = undefined;\r\n        return this;\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if (typeof (orientation) === 'string') {\r\n            orientation = ORIENTATIONMODE[orientation];\r\n        }\r\n        this.orientation = orientation;\r\n        return this;\r\n    }\r\n\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    setEase(ease) {\r\n        if (ease === undefined) {\r\n            ease = 'Linear';\r\n        }\r\n        this.ease = ease;\r\n        return this;\r\n    }\r\n\r\n    get face() {\r\n        return this._face;\r\n    }\r\n\r\n    set face(face) {\r\n        if (typeof (face) === 'string') {\r\n            face = FACEMODE[face];\r\n        }\r\n        this._face = face;\r\n        if ((face === 0) && this.frontFaceCallback) {\r\n            this.frontFaceCallback(this.gameObject);\r\n        } else if ((face === 1) && this.backFaceCallback) {\r\n            this.backFaceCallback(this.gameObject);\r\n        }\r\n    }\r\n\r\n    setFace(face) {\r\n        this.face = face;\r\n        return this;\r\n    }\r\n\r\n    toggleFace() {\r\n        var newFace = (this.face === 0) ? 1 : 0;\r\n        this.setFace(newFace);\r\n        return this;\r\n    }\r\n\r\n    setFrontFace(key, frame) {\r\n        this.frontFaceCallback = Object(_GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key, frame, this.gameObject);\r\n        return this;\r\n    }\r\n\r\n    setBackFace(key, frame) {\r\n        this.backFaceCallback = Object(_GetFaceUpdatingCallback_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key, frame, this.gameObject);\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        var config = {\r\n            targets: this.gameObject,\r\n            delay: this.delay,\r\n            duration: this.duration / 2,\r\n            ease: this.ease,\r\n            yoyo: true,\r\n            repeat: 0,\r\n\r\n            onYoyo: this.toggleFace,\r\n            onYoyoScope: this\r\n        }\r\n\r\n        var propKey = (this.orientation === 0) ? 'scaleX' : 'scaleY';\r\n        config[propKey] = { from: 1, to: 0 };\r\n\r\n        super.start(config);\r\n        return this;\r\n    }\r\n\r\n    flip(duration) {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n        if (duration !== undefined) {\r\n            this.setDuration(duration);\r\n        }\r\n        this.start();\r\n        return this;\r\n    }\r\n}\r\n\r\nconst ORIENTATIONMODE = {\r\n    x: 0,\r\n    horizontal: 0,\r\n    y: 1,\r\n    vertical: 1,\r\n}\r\n\r\nconst FACEMODE = {\r\n    front: 0,\r\n    back: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Flip);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/flip/Flip.js?")},"./lib/rexui/lib/plugins/behaviors/flip/GetFaceUpdatingCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar GetFaceUpdatingCallback = function (key, frame, gameObject) {\r\n    var callback;\r\n    if (key === undefined) {\r\n        key = gameObject.texture.key;\r\n        frame = gameObject.frame.name;\r\n    } else if (IsPlainObject(key)) {\r\n        var config = key;\r\n        key = GetValue(config, 'key', gameObject.texture.key);\r\n        frame = GetValue(config, 'frame', gameObject.frame.name);\r\n    } else if (typeof (key) === 'string') {\r\n    } else {\r\n        callback = key;\r\n    }\r\n\r\n    if (callback === undefined) {\r\n        callback = function (gameObject) {\r\n            gameObject.setTexture(key, frame);\r\n        }\r\n    }\r\n    return callback;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetFaceUpdatingCallback);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/flip/GetFaceUpdatingCallback.js?")},"./lib/rexui/lib/plugins/behaviors/scale/Scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/tween/TweenBase.js */ \"./lib/rexui/lib/plugins/utils/tween/TweenBase.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\n\r\nclass Scale extends _utils_tween_TweenBase_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]{\r\n    constructor(gameObject, config) {\r\n        super(gameObject);\r\n        this.gameObject = gameObject;\r\n\r\n        this.scaleStart = {};\r\n        this.scaleEnd = {};\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setMode(GetValue(o, 'mode', 0));\r\n        this.setScaleRange(\r\n            GetAdvancedValue(o, 'start', undefined),\r\n            GetAdvancedValue(o, 'end', 0)\r\n        );\r\n        this.setDelay(GetAdvancedValue(o, 'delay', 0));\r\n        this.setDuration(GetAdvancedValue(o, 'duration', 1000));\r\n        this.setEase(GetValue(o, 'ease', undefined));\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            mode: this.mode,\r\n            start: this.scaleStart,\r\n            end: this.scaleEnd,\r\n            delay: this.delay,\r\n            duration: this.duration\r\n        };\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = MODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setScaleRange(start, end) {\r\n        if (typeof (start) === 'number') {\r\n            this.scaleStart.x = start;\r\n            this.scaleStart.y = start;\r\n        } else {\r\n            this.scaleStart.x = GetValue(start, 'x', this.gameObject.scaleX);\r\n            this.scaleStart.y = GetValue(start, 'y', this.gameObject.scaleY);\r\n        }\r\n        if (typeof (end) === 'number') {\r\n            this.scaleEnd.x = end;\r\n            this.scaleEnd.y = end;\r\n        } else {\r\n            this.scaleEnd.x = GetValue(end, 'x', this.scaleStart.x);\r\n            this.scaleEnd.y = GetValue(end, 'y', this.scaleStart.y);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setDelay(time) {\r\n        this.delay = time;\r\n        return this;\r\n    }\r\n\r\n    setDuration(time) {\r\n        this.duration = time;\r\n        return this;\r\n    }\r\n\r\n    setEase(ease) {\r\n        if (ease === undefined) {\r\n            ease = 'Linear';\r\n        }\r\n        this.ease = ease;\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setScale(this.scaleStart.x, this.scaleStart.y);\r\n        super.start({\r\n            targets: this.gameObject,\r\n            scaleX: this.scaleEnd.x,\r\n            scaleY: this.scaleEnd.y,\r\n\r\n            duration: this.duration,\r\n            ease: this.ease,\r\n            yoyo: (this.mode == 2),\r\n            repeat: ((this.mode == 2) ? -1 : 0)\r\n        });\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        super.complete();\r\n        if (this.mode === 1) {\r\n            this.gameObject.destroy();\r\n        }\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nconst MODE = {\r\n    stop: 0,\r\n    destroy: 1,\r\n    yoyo: 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scale);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/scale/Scale.js?")},"./lib/rexui/lib/plugins/behaviors/textedit/CreateInputText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../gameobjects/inputtext/InputText.js */ \"./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar CreateInputText = function (text, config) {\r\n    if (config === undefined) {\r\n        config = {};\r\n    }\r\n\r\n    var scene = text.scene;\r\n    var style = text.style;\r\n    var backgroundColor = GetValue(config, 'backgroundColor', style.backgroundColor);\r\n    if (backgroundColor === null) {\r\n        backgroundColor = 'transparent';\r\n    }\r\n\r\n    config.text = GetValue(config, 'text', text.text);\r\n    config.fontFamily = GetValue(config, 'fontFamily', style.fontFamily);\r\n    config.fontSize = GetValue(config, 'fontSize', style.fontSize);\r\n    config.color = GetValue(config, 'color', style.color);\r\n    config.backgroundColor = backgroundColor;\r\n    config.align = GetValue(config, 'align', GetHAlign(style));\r\n\r\n    // config.paddingLeft = 0;\r\n    // config.paddingRight = 0;\r\n    // config.paddingTop = 0;\r\n    // config.paddingBottom = 0;\r\n    // var valign = GetVAlign(style);\r\n    // switch (valign) {\r\n    //     case 'top':\r\n    //         break;\r\n    //     case 'bottom':\r\n    //         break;\r\n    // }\r\n\r\n    var inputText = new _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](scene,\r\n        text.x, text.y,\r\n        GetValue(config, 'width', text.width),\r\n        GetValue(config, 'height', text.height),\r\n        config\r\n    );\r\n    inputText.setOrigin(text.originX, text.originY);\r\n    scene.add.existing(inputText);\r\n    return inputText;\r\n}\r\n\r\nvar GetHAlign = function (style) {\r\n    if (style.hasOwnProperty('align')) {\r\n        return style.align;\r\n    } else if (style.hasOwnProperty('halign')) {\r\n        return style.halign;\r\n    } else {\r\n        return 'left';\r\n    }\r\n}\r\n\r\nvar GetVAlign = function (style) {\r\n    if (style.hasOwnProperty('halign')) {\r\n        return style.halign;\r\n    } else {\r\n        return 'top';\r\n    }\r\n}\r\n\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CreateInputText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/textedit/CreateInputText.js?")},"./lib/rexui/lib/plugins/behaviors/textedit/Edit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextEdit_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextEdit.js */ "./lib/rexui/lib/plugins/behaviors/textedit/TextEdit.js");\n\r\n\r\nvar Edit = function (gameObject, config, onCloseCallback) {\r\n    if (!gameObject._edit) {\r\n        gameObject._edit = new _TextEdit_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject);\r\n    }\r\n    gameObject._edit.open(config, onCloseCallback);\r\n    return gameObject._edit;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Edit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/textedit/Edit.js?')},"./lib/rexui/lib/plugins/behaviors/textedit/TextEdit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _CreateInputText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CreateInputText.js */ \"./lib/rexui/lib/plugins/behaviors/textedit/CreateInputText.js\");\n/* harmony import */ var _utils_object_IsFunction_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/object/IsFunction.js */ \"./lib/rexui/lib/plugins/utils/object/IsFunction.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextEdit {\r\n    constructor(gameObject) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n\r\n        this.inputText = undefined;\r\n        this.onClose = undefined;\r\n        this.delayCall = undefined;\r\n        this.boot();\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n\r\n        return this;\r\n    }\r\n\r\n    shutdown() {\r\n        this.close();\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        if (globLastOpenedEditor === this) {\r\n            globLastOpenedEditor = undefined;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    open(config, onCloseCallback) {\r\n        if (globLastOpenedEditor !== undefined) {\r\n            globLastOpenedEditor.close();\r\n        }\r\n\r\n        globLastOpenedEditor = this;\r\n        if (Object(_utils_object_IsFunction_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(config)) {\r\n            onCloseCallback = config;\r\n            config = undefined;\r\n        }\r\n        if (onCloseCallback === undefined) {\r\n            onCloseCallback = GetValue(config, 'onClose', undefined);\r\n        }\r\n\r\n        var customOnTextChanged = GetValue(config, 'onTextChanged', undefined);\r\n\r\n        this.inputText = Object(_CreateInputText_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.gameObject, config)\r\n            .on('textchange', function (inputText) {\r\n                var text = inputText.text;\r\n                if (customOnTextChanged) { // Custom on-text-changed callback\r\n                    customOnTextChanged(this.gameObject, text);\r\n                } else { // Default on-text-changed callback\r\n                    this.gameObject.text = text;\r\n                }\r\n            }, this)\r\n            .setFocus();\r\n        this.gameObject.setVisible(false); // Set parent text invisible\r\n\r\n        // Attach close event\r\n        this.onClose = onCloseCallback;\r\n        this.scene.input.keyboard.once('keydown-ENTER', this.close, this);\r\n        // Attach pointerdown (outside of input-text) event, at next tick\r\n        this.delayCall = this.scene.time.delayedCall(0, function () {\r\n            this.scene.input.once('pointerdown', this.close, this);\r\n        }, [], this);\r\n        return this;\r\n    }\r\n\r\n    close() {\r\n        globLastOpenedEditor = undefined;\r\n        if (!this.inputText) {\r\n            return this;\r\n        }\r\n\r\n        this.gameObject.setVisible(true); // Set parent text visible\r\n\r\n        this.inputText.destroy();\r\n        this.inputText = undefined;\r\n        if (this.delayCall) {\r\n            this.delayCall.remove();\r\n            this.delayCall = undefined;\r\n        }\r\n\r\n        // Remove close event\r\n        this.scene.input.keyboard.off('keydown-ENTER', this.close, this);\r\n        this.scene.input.off('pointerdown', this.close, this);\r\n\r\n        if (this.onClose) {\r\n            this.onClose(this.gameObject);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isOpened() {\r\n        return (this.inputText !== undefined);\r\n    }\r\n\r\n    get text() {\r\n        return (this.isOpened) ? this.inputText.text : this.gameObject.text;\r\n    }\r\n}\r\n\r\nvar globLastOpenedEditor = undefined;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextEdit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/behaviors/textedit/TextEdit.js?")},"./lib/rexui/lib/plugins/button-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./button.js */ "./lib/rexui/lib/plugins/button.js");\n\r\n\r\nclass ButtonPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.on(\'destroy\', this.destroy, this);\r\n    }\r\n\r\n    add(gameObject, config) {\r\n        return new _button_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n    }\r\n\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ButtonPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/button-plugin.js?')},"./lib/rexui/lib/plugins/button.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/button/Button.js */ "./lib/rexui/lib/plugins/input/button/Button.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/button.js?')},"./lib/rexui/lib/plugins/dragspeed.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_dragspeed_DragSpeed_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/dragspeed/DragSpeed.js */ "./lib/rexui/lib/plugins/input/dragspeed/DragSpeed.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_dragspeed_DragSpeed_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/dragspeed.js?')},"./lib/rexui/lib/plugins/fade-in.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fade.js */ "./lib/rexui/lib/plugins/fade.js");\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\n\r\nvar FadeIn = function (gameObject, duration, alpha, fade) {\r\n    var startAlpha, endAlpha;\r\n    if (IsPlainObject(alpha)) {\r\n        startAlpha = alpha.start;\r\n        endAlpha = alpha.end;\r\n    } else {\r\n        endAlpha = alpha;\r\n    }\r\n    if (startAlpha === undefined) {\r\n        startAlpha = 0\r\n    }\r\n    if (endAlpha === undefined) {\r\n        endAlpha = gameObject.alpha;\r\n    }\r\n    defaultConfig.mode = 0;\r\n    defaultConfig.start = startAlpha;\r\n    defaultConfig.end = endAlpha;\r\n    defaultConfig.duration = duration;\r\n\r\n    if (fade === undefined) {\r\n        fade = new _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        fade.resetFromJSON(defaultConfig);\r\n    }\r\n    fade.restart();\r\n\r\n    return fade;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (FadeIn);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/fade-in.js?')},"./lib/rexui/lib/plugins/fade-out-destroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fade.js */ "./lib/rexui/lib/plugins/fade.js");\n\r\n\r\nvar FadeOutDestroy = function (gameObject, duration, destroyMode, fade) {\r\n    if (destroyMode instanceof _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"]) {\r\n        fade = destroyMode;\r\n        destroyMode = undefined;\r\n    }\r\n\r\n    if (destroyMode === undefined) {\r\n        destroyMode = true;\r\n    }\r\n\r\n    defaultConfig.mode = (destroyMode) ? 1 : 0;\r\n    defaultConfig.end = 0;\r\n    defaultConfig.duration = duration;\r\n\r\n    if (fade === undefined) {\r\n        fade = new _fade_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        fade.resetFromJSON(defaultConfig);\r\n    }\r\n    fade.restart();\r\n\r\n    return fade;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (FadeOutDestroy);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/fade-out-destroy.js?')},"./lib/rexui/lib/plugins/fade.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_fade_Fade_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/fade/Fade.js */ "./lib/rexui/lib/plugins/behaviors/fade/Fade.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_fade_Fade_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/fade.js?')},"./lib/rexui/lib/plugins/flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_flip_Flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/flip/Flip.js */ "./lib/rexui/lib/plugins/behaviors/flip/Flip.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_flip_Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/flip.js?')},"./lib/rexui/lib/plugins/fsm.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _logic_fsm_FSM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./logic/fsm/FSM.js */ "./lib/rexui/lib/plugins/logic/fsm/FSM.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_logic_fsm_FSM_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/fsm.js?')},"./lib/rexui/lib/plugins/gameobjects/canvas/Canvas.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./render/Render.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/render/Render.js");\n/* harmony import */ var _CanvasMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasMethods.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/CanvasMethods.js");\n/* harmony import */ var _TextureMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TextureMethods.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/TextureMethods.js");\n\r\n\r\n\r\n\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\nconst GameObject = Phaser.GameObjects.GameObject;\r\n\r\nclass Canvas extends GameObject {\r\n    constructor(scene, x, y, width, height) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n        if (width === undefined) {\r\n            width = 1;\r\n        }\r\n        if (height === undefined) {\r\n            height = 1;\r\n        }\r\n\r\n        super(scene, \'rexCanvas\');\r\n\r\n        this.renderer = scene.sys.game.renderer;\r\n\r\n        this.resolution = scene.sys.game.config.resolution;\r\n        this.canvas = CanvasPool.create(this, this.resolution * width, this.resolution * height);\r\n        this.context = this.canvas.getContext(\'2d\');\r\n        this.dirty = false;\r\n\r\n        this.setPosition(x, y);\r\n        this.setSize(width, height);\r\n        this.setOrigin(0.5, 0.5);\r\n        this.initPipeline();\r\n\r\n        this._crop = this.resetCropObject();\r\n\r\n        //  Create a Texture for this Text object\r\n        this.texture = scene.sys.textures.addCanvas(null, this.canvas, true);\r\n\r\n        //  Get the frame\r\n        this.frame = this.texture.get();\r\n\r\n        //  Set the resolution\r\n        this.frame.source.resolution = this.resolution;\r\n\r\n        if (this.renderer && this.renderer.gl) {\r\n            //  Clear the default 1x1 glTexture, as we override it later\r\n            this.renderer.deleteTexture(this.frame.source.glTexture);\r\n            this.frame.source.glTexture = null;\r\n        }\r\n\r\n        this.dirty = true;\r\n\r\n        scene.sys.game.events.on(\'contextrestored\', function () {\r\n            this.dirty = true;\r\n        }, this);\r\n    }\r\n\r\n    getCanvas(readOnly) {\r\n        if (!readOnly) {\r\n            this.dirty = true;\r\n        }\r\n        return this.canvas;\r\n    }\r\n\r\n    needRedraw() {\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n\r\n    preDestroy() {\r\n        CanvasPool.remove(this.canvas);\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        this\r\n            .setSize(width, height)\r\n            .updateDisplayOrigin();\r\n\r\n        width *= this.resolution;\r\n        height *= this.resolution;\r\n        width = Math.max(Math.ceil(width), 1);\r\n        height = Math.max(Math.ceil(height), 1);\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst Components = Phaser.GameObjects.Components;\r\nPhaser.Class.mixin(Canvas,\r\n    [\r\n        Components.Alpha,\r\n        Components.BlendMode,\r\n        Components.ComputedSize,\r\n        Components.Crop,\r\n        Components.Depth,\r\n        Components.Flip,\r\n        Components.GetBounds,\r\n        Components.Mask,\r\n        Components.Origin,\r\n        Components.Pipeline,\r\n        Components.ScrollFactor,\r\n        Components.Tint,\r\n        Components.Transform,\r\n        Components.Visible,\r\n        _render_Render_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n        _CanvasMethods_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n        _TextureMethods_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    ]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Canvas);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/Canvas.js?')},"./lib/rexui/lib/plugins/gameobjects/canvas/CanvasMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst Color = Phaser.Display.Color;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n    fill(color) {\r\n        this.context.fillStyle = color;\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n    getPixel(x, y, out) {\r\n        if (out === undefined) {\r\n            out = new Color();\r\n        }\r\n        var rgb = this.context.getImageData(x, y, 1, 1);\r\n        out.setTo(rgb.data[0], rgb.data[1], rgb.data[2], rgb.data[3])\r\n        return out;\r\n    },\r\n\r\n    setPixel(x, y, r, g, b, a) {\r\n        if (typeof (r) !== 'number') {\r\n            var color = r;\r\n            r = color.red;\r\n            g = color.green;\r\n            b = color.blue;\r\n            a = color.alpha;\r\n        }\r\n\r\n        if (a === undefined) {\r\n            a = ((r !== 0) || (g !== 0) || (b !== 0)) ? 255 : 0;\r\n        }\r\n\r\n        var imgData = this.context.createImageData(1, 1);\r\n        imgData.data[0] = r;\r\n        imgData.data[1] = g;\r\n        imgData.data[2] = b;\r\n        imgData.data[3] = a;\r\n        this.context.putImageData(imgData, x, y);\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/CanvasMethods.js?")},"./lib/rexui/lib/plugins/gameobjects/canvas/TextureMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    updateTexture(callback, scope) {\r\n        if (callback) {\r\n            if (scope) {\r\n                callback.call(scope, this.canvas, this.context);\r\n            } else {\r\n                callback(this.canvas, this.context);\r\n            }\r\n        }\r\n\r\n        if ((this.canvas.width !== this.frame.width) || (this.canvas.height !== this.frame.height)) {\r\n            this.frame.setSize(this.canvas.width, this.canvas.height);\r\n        }\r\n        if (this.renderer.gl) {\r\n            this.frame.source.glTexture = this.renderer.canvasToTexture(this.canvas, this.frame.source.glTexture, true);\r\n            this.frame.glTexture = this.frame.source.glTexture;\r\n        }\r\n        this.dirty = false;\r\n\r\n        var input = this.input;\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = this.width;\r\n            input.hitArea.height = this.height;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    generateTexture(key, x, y, width, height) {\r\n        var srcCanvas = this.canvas;\r\n        var sys = this.scene.sys;\r\n        var renderer = sys.game.renderer;\r\n        var texture;\r\n\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        if (width === undefined) {\r\n            width = srcCanvas.width;\r\n        } else {\r\n            width *= this.resolution;\r\n        }\r\n\r\n        if (height === undefined) {\r\n            height = srcCanvas.height;\r\n        } else {\r\n            height *= this.resolution;\r\n        }\r\n\r\n\r\n        if (sys.textures.exists(key)) {\r\n            texture = sys.textures.get(key);\r\n        } else {\r\n            texture = sys.textures.createCanvas(key, width, height);\r\n        }\r\n\r\n        var destCanvas = texture.getSourceImage();\r\n        if (destCanvas.width !== width) {\r\n            destCanvas.width = width;\r\n        }\r\n        if (destCanvas.height !== height) {\r\n            destCanvas.height = height;\r\n        }\r\n\r\n        var destCtx = destCanvas.getContext('2d');\r\n        destCtx.clearRect(0, 0, width, height);\r\n        destCtx.drawImage(srcCanvas, x, y, width, height);\r\n        if (renderer.gl && texture) {\r\n            renderer.canvasToTexture(destCanvas, texture.source[0].glTexture, true, 0);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    loadTexture(key, frame) {\r\n        var textureFrame = this.scene.textures.getFrame(key, frame);\r\n        if (!textureFrame) {\r\n            return this;\r\n        }\r\n\r\n        if ((this.width !== textureFrame.cutWidth) || (this.height !== textureFrame.cutHeight)) {\r\n            this.resize(textureFrame.cutWidth, textureFrame.cutHeight);\r\n        } else {\r\n            this.context.clearRect(0, 0, textureFrame.cutWidth, textureFrame.cutHeight);\r\n        }\r\n        this.context.drawImage(textureFrame.source.image,\r\n            textureFrame.cutX, textureFrame.cutY, textureFrame.cutWidth, textureFrame.cutHeight,\r\n            0, 0, this.canvas.width, this.canvas.height);\r\n        this.dirty = true;\r\n        return this;\r\n    },\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/TextureMethods.js?")},"./lib/rexui/lib/plugins/gameobjects/canvas/render/CanvasRenderer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// copy from Phaser.GameObjects.Text\r\n\r\nvar CanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n    renderer.batchSprite(src, src.frame, camera, parentMatrix);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CanvasRenderer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/render/CanvasRenderer.js?')},"./lib/rexui/lib/plugins/gameobjects/canvas/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/render/WebGLRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/render/CanvasRenderer.js");\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/object/NOOP.js */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__["default"];\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__["default"];\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/render/Render.js?')},"./lib/rexui/lib/plugins/gameobjects/canvas/render/WebGLRenderer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// copy from Phaser.GameObjects.Text\r\n\r\nconst Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\nvar WebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if (src.dirty) {\r\n        src.updateTexture();\r\n        src.dirty = false;\r\n    }\r\n\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    var frame = src.frame;\r\n    var width = frame.width;\r\n    var height = frame.height;\r\n    var getTint = Utils.getTintAppendFloatAlpha;\r\n\r\n    this.pipeline.batchTexture(\r\n        src,\r\n        frame.glTexture,\r\n        width, height,\r\n        src.x, src.y,\r\n        width / src.resolution, height / src.resolution,\r\n        src.scaleX, src.scaleY,\r\n        src.rotation,\r\n        src.flipX, src.flipY,\r\n        src.scrollFactorX, src.scrollFactorY,\r\n        src.displayOriginX, src.displayOriginY,\r\n        0, 0, width, height,\r\n        getTint(src._tintTL, camera.alpha * src._alphaTL),\r\n        getTint(src._tintTR, camera.alpha * src._alphaTR),\r\n        getTint(src._tintBL, camera.alpha * src._alphaBL),\r\n        getTint(src._tintBR, camera.alpha * src._alphaBR),\r\n        (src._isTinted && src.tintFill),\r\n        0, 0,\r\n        camera,\r\n        parentMatrix\r\n    );\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (WebGLRenderer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/canvas/render/WebGLRenderer.js?')},"./lib/rexui/lib/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar CircleMask = function (canvas, maskType) {\r\n    if (canvas.width === canvas.height) {\r\n        maskType = 0;\r\n    }\r\n\r\n    var x = Math.floor(canvas.width / 2);\r\n    var y = Math.floor(canvas.height / 2);\r\n\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.save();\r\n    ctx.globalCompositeOperation = 'destination-in';\r\n    ctx.beginPath();\r\n    if (maskType === 0) {\r\n        ctx.arc(x, y, Math.min(x, y), 0, 2 * Math.PI);\r\n    } else {\r\n        ctx.ellipse(x, y, x, y, 0, 0, 2 * Math.PI);\r\n    }\r\n    ctx.fill();\r\n    ctx.restore();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CircleMask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js?")},"./lib/rexui/lib/plugins/gameobjects/circlemaskimage/CircleMaskImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../canvas/Canvas.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/Canvas.js");\n/* harmony import */ var _ApplyCircleMask_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ApplyCircleMask.js */ "./lib/rexui/lib/plugins/gameobjects/circlemaskimage/ApplyCircleMask.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass CircleMaskImage extends _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, key, frame, config) {\r\n        super(scene, x, y);\r\n\r\n        this.type = \'rexCircleMaskImage\';\r\n        var maskType = GetValue(config, \'maskType\', 0);\r\n        this.setTexture(key, frame, maskType);\r\n    }\r\n\r\n    setTexture(key, frame, maskType) {\r\n        if (maskType === undefined) {\r\n            maskType = 0;\r\n        } else if (typeof (maskType) === \'string\') {\r\n            maskType = MASKTYPE[maskType];\r\n        }\r\n\r\n        this._textureKey = key;\r\n        this._frameName = frame;\r\n        this.loadTexture(key, frame);\r\n\r\n        if (maskType !== null) {\r\n            Object(_ApplyCircleMask_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.canvas, maskType);\r\n        }\r\n        this.dirty = true;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst MASKTYPE = {\r\n    circle: 0,\r\n    ellipse: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CircleMaskImage);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/circlemaskimage/CircleMaskImage.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Active.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildActive(child) {\r\n        child.active = this.active && this.getLocalState(child).active;\r\n        return this;\r\n    },\r\n\r\n    syncActive() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildActive, this);\r\n        }\r\n        return this;\r\n    },\r\n    \r\n    resetChildActiveState(gameObject) {\r\n        this.getLocalState(gameObject).active = gameObject.active;\r\n        return this;\r\n    },\r\n\r\n    setChildActive(gameObject, active) {\r\n        gameObject.active = active;\r\n        this.resetChildActiveState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    setChildLocalActive(gameObject, active) {\r\n        if (active === undefined) {\r\n            active = true;\r\n        }\r\n        this.getLocalState(gameObject).active = active;\r\n        this.updateChildActive(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Active.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/AddChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    add(gameObject) {\r\n        if (Array.isArray(gameObject)) {\r\n            this.addMultiple(gameObject);\r\n        } else {\r\n            this._add(gameObject);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addMultiple(gameObjects) {\r\n        gameObjects.forEach(this._add, this);\r\n        return this;\r\n    },\r\n\r\n    _add(gameObject) {\r\n        this.children.add(gameObject);\r\n\r\n        this\r\n            .resetChildState(gameObject)           // Reset local state of child\r\n            .updateChildVisible(gameObject)        // Apply parent's visible to child\r\n            .updateChildActive(gameObject)         // Apply parent's active to child\r\n            .updateChildScrollFactor(gameObject)   // Apply parent's scroll factor to child\r\n            .updateChildMask(gameObject);          // Apply parent's mask to child\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/AddChild.js?")},"./lib/rexui/lib/plugins/gameobjects/containerlite/Alpha.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Scale.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Scale.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildAlpha(child) {\r\n        child.alpha = this.alpha * this.getLocalState(child).alpha;\r\n        return this;\r\n    },\r\n\r\n    syncAlpha() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildAlpha, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildAlphaState(gameObject) {\r\n        this.getLocalState(gameObject).alpha = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.alpha, this.alpha);\r\n        return this;\r\n    },\r\n    \r\n    setChildAlpha(gameObject, alpha) {\r\n        gameObject.alpha = alpha;\r\n        this.resetChildAlphaState(gameObject);\r\n        return this._add;\r\n    },\r\n    \r\n    setChildLocalAlpha(gameObject, alpha) {\r\n        this.getLocalState(gameObject).alpha = alpha;\r\n        this.updateChildAlpha(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Alpha.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/ChildState.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    getLocalState(gameObject) {\r\n        if (!gameObject.hasOwnProperty('rexContainer')) {\r\n            gameObject.rexContainer = {};\r\n        }\r\n        return gameObject.rexContainer;\r\n    },\r\n\r\n    resetChildState(gameObject) {\r\n        this\r\n            .resetChildPositionState(gameObject)\r\n            .resetChildVisibleState(gameObject)\r\n            .resetChildAlphaState(gameObject)\r\n            .resetChildActiveState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    resetChildrenState(gameObjects) {\r\n        for (var i = 0, cnt = gameObjects.length; i < cnt; i++) {\r\n            this.resetChildState(gameObjects[i]);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncProperties() {\r\n        this\r\n            .syncPosition()\r\n            .syncVisible()\r\n            .syncAlpha()\r\n            .syncActive()\r\n            .syncScrollFactor()\r\n            .syncMask();\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/ChildState.js?")},"./lib/rexui/lib/plugins/gameobjects/containerlite/Children.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst ArrayUtils = Phaser.Utils.Array;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    getChildren() {\r\n        return this.children.getChildren();\r\n    },\r\n\r\n    getAllChildren(out) {\r\n        if (out === undefined) {\r\n            out = [];\r\n        }\r\n        var myCildren = this.children.getChildren(),\r\n            myChild;\r\n        for (var i = 0, cnt = myCildren.length; i < cnt; i++) {\r\n            myChild = myCildren[i];\r\n            out.push(myChild);\r\n\r\n            if (myChild.hasOwnProperty('isRexContainerLite')) {\r\n                out.push(...myChild.getAllChildren());\r\n            }\r\n        }\r\n\r\n        return out;\r\n    },\r\n\r\n    contains(gameObject) {\r\n        if (this.children.contains(gameObject)) {\r\n            return true;\r\n        }\r\n\r\n        var myCildren = this.children.getChildren(),\r\n            myChild;\r\n        for (var i = 0, cnt = myCildren.length; i < cnt; i++) {\r\n            myChild = myCildren[i];\r\n\r\n            if (myChild.isRexContainerLite) {\r\n                if (myChild.contains(gameObject)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    getByName(name) {\r\n        return ArrayUtils.GetFirst(this.list, 'name', name);\r\n    },\r\n\r\n    getRandom(startIndex, length) {\r\n        return ArrayUtils.GetRandom(this.list, startIndex, length);\r\n    },\r\n\r\n    getFirst(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.GetFirstElement(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    getAll(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.GetAll(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    count(property, value, startIndex, endIndex) {\r\n        return ArrayUtils.CountAllMatching(this.list, property, value, startIndex, endIndex);\r\n    },\r\n\r\n    swap(child1, child2) {\r\n        ArrayUtils.Swap(this.list, child1, child2);\r\n        return this;\r\n    },\r\n\r\n    moveTo(child, index) {\r\n        ArrayUtils.MoveTo(this.list, child, index);\r\n        return this;\r\n    },\r\n\r\n    setAll(property, value, startIndex, endIndex) {\r\n        ArrayUtils.SetAll(this.list, property, value, startIndex, endIndex);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Children.js?")},"./lib/rexui/lib/plugins/gameobjects/containerlite/ContainerLite.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _AddChild_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AddChild.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/AddChild.js");\n/* harmony import */ var _RemoveChild_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RemoveChild.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/RemoveChild.js");\n/* harmony import */ var _ChildState_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ChildState.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/ChildState.js");\n/* harmony import */ var _Transform_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Transform.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Transform.js");\n/* harmony import */ var _Position_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Position.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Position.js");\n/* harmony import */ var _Visible_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Visible.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Visible.js");\n/* harmony import */ var _Alpha_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Alpha.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Alpha.js");\n/* harmony import */ var _Active_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Active.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Active.js");\n/* harmony import */ var _ScrollFactor_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ScrollFactor.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/ScrollFactor.js");\n/* harmony import */ var _Mask_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Mask.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Mask.js");\n/* harmony import */ var _Depth_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Depth.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Depth.js");\n/* harmony import */ var _Children_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Children.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Children.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst Zone = Phaser.GameObjects.Zone;\r\nconst Components = Phaser.GameObjects.Components;\r\n\r\nclass ContainerLite extends Zone {\r\n    constructor(scene, x, y, width, height, children) {\r\n        if (Array.isArray(width)) {\r\n            children = width;\r\n            width = undefined;\r\n        }\r\n        if (width === undefined) {\r\n            width = 1;\r\n        }\r\n        if (height === undefined) {\r\n            height = 1;\r\n        }\r\n        super(scene, x, y, width, height);\r\n        this.children = scene.add.group();\r\n        this.type = \'rexContainerLite\';\r\n        this.isRexContainerLite = true;\r\n        this.syncChildrenEnable = true;\r\n\r\n        this._flipX = false;\r\n        this._flipY = false;\r\n        this._alpha = 1;\r\n        this._active = true;\r\n        this._mask = null;\r\n        this._scrollFactorX = 1;\r\n        this._scrollFactorY = 1;\r\n\r\n        if (children) {\r\n            this.add(children);\r\n        }\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        this.children.destroy(!fromScene);\r\n        this.children = undefined;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    resize(width, height) {\r\n        this.setSize(width, height);\r\n        return this;\r\n    }\r\n\r\n    get x() {\r\n        return this._x;\r\n    }\r\n\r\n    set x(value) {\r\n        if (this._x === value) {\r\n            return;\r\n        }\r\n        this._x = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    get y() {\r\n        return this._y;\r\n    }\r\n\r\n    set y(value) {\r\n        if (this._y === value) {\r\n            return;\r\n        }\r\n        this._y = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get rotation() {\r\n        return super.rotation;\r\n    }\r\n\r\n    set rotation(value) {\r\n        if (this.rotation === value) {\r\n            return;\r\n        }\r\n        super.rotation = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get scaleX() {\r\n        return super.scaleX;\r\n    }\r\n\r\n    set scaleX(value) {\r\n        if (this.scaleX === value) {\r\n            return;\r\n        }\r\n        super.scaleX = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get scaleY() {\r\n        return super.scaleY;\r\n    }\r\n\r\n    set scaleY(value) {\r\n        if (this.scaleY === value) {\r\n            return;\r\n        }\r\n        super.scaleY = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get flipX() {\r\n        return this._flipX;\r\n    }\r\n\r\n    set flipX(value) {\r\n        if (this._flipX === value) {\r\n            return;\r\n        }\r\n        this._flipX = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get flipY() {\r\n        return this._flipY;\r\n    }\r\n\r\n    set flipY(value) {\r\n        if (this._flipY === value) {\r\n            return;\r\n        }\r\n        this._flipY = value;\r\n\r\n        this.syncPosition();\r\n    }\r\n\r\n    // Override\r\n    get visible() {\r\n        return super.visible;\r\n    }\r\n\r\n    set visible(value) {\r\n        if (this.visible === value) {\r\n            return;\r\n        }\r\n        super.visible = value;\r\n\r\n        this.syncVisible();\r\n    }\r\n\r\n    // Override\r\n    get alpha() {\r\n        return this._alpha;\r\n    }\r\n\r\n    set alpha(value) {\r\n        if (this._alpha === value) {\r\n            return;\r\n        }\r\n        this._alpha = value;\r\n\r\n        this.syncAlpha();\r\n    }\r\n\r\n    // Override\r\n    get active() {\r\n        return this._active;\r\n    }\r\n\r\n    set active(value) {\r\n        if (this._active === value) {\r\n            return;\r\n        }\r\n        this._active = value;\r\n\r\n        this.syncActive();\r\n    }\r\n\r\n    // Override\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    set mask(mask) {\r\n        if (this._mask === mask) {\r\n            return;\r\n        }\r\n        this._mask = mask;\r\n\r\n        this.syncMask();\r\n    }\r\n\r\n    // Override\r\n    get scrollFactorX() {\r\n        return this._scrollFactorX;\r\n    }\r\n\r\n    set scrollFactorX(value) {\r\n        if (this._scrollFactorX === value) {\r\n            return;\r\n        }\r\n\r\n        this._scrollFactorX = value;\r\n        this.syncScrollFactor();\r\n    }\r\n    get scrollFactorY() {\r\n        return this._scrollFactorY;\r\n    }\r\n\r\n    set scrollFactorY(value) {\r\n        if (this._scrollFactorY === value) {\r\n            return;\r\n        }\r\n\r\n        this._scrollFactorY = value;\r\n        this.syncScrollFactor();\r\n    }\r\n\r\n    // Compatiable with container plugin\r\n    get list() {\r\n        return this.children.getChildren();\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    ContainerLite.prototype,\r\n    _AddChild_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    _RemoveChild_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    _ChildState_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    _Transform_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    _Position_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    _Visible_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n    _Alpha_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    _ScrollFactor_js__WEBPACK_IMPORTED_MODULE_8__["default"],\r\n    _Active_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n    _Mask_js__WEBPACK_IMPORTED_MODULE_9__["default"],\r\n    _Depth_js__WEBPACK_IMPORTED_MODULE_10__["default"],\r\n    _Children_js__WEBPACK_IMPORTED_MODULE_11__["default"],\r\n\r\n    Components.Alpha,\r\n    Components.Flip\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ContainerLite);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/ContainerLite.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Depth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setDepth(value) {\r\n        this.depth = value;\r\n        if (this.children) {\r\n            var children = this.getAllChildren();\r\n            for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n                children[i].depth = value;\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    swapDepth(containerB) {\r\n        var depthA = this.depth;\r\n        var depthB = containerB.depth;\r\n        this.setDepth(depthB);\r\n        containerB.setDepth(depthA);\r\n        return this;\r\n    },\r\n\r\n    incDepth(inc) {\r\n        this.depth += inc;\r\n        if (this.children) {\r\n            var children = this.getAllChildren();\r\n            for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n                children[i].depth += inc;\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Depth.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Mask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    updateChildMask(child) {\r\n        // Don't propagate null mask to clear children's mask\r\n        if (this.mask == null) {\r\n            return this;\r\n        }\r\n\r\n        var maskGameObject = (this.mask.hasOwnProperty('geometryMask')) ? this.mask.geometryMask : this.mask.bitmapMask;\r\n        if (maskGameObject !== child) {\r\n            child.mask = this.mask;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncMask() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildMask, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    setMask(mask) {\r\n        this.mask = mask;\r\n        return this;\r\n    },\r\n\r\n    clearMask(destroyMask) {\r\n        if (destroyMask === undefined) {\r\n            destroyMask = false;\r\n        }\r\n\r\n        if (destroyMask && this.mask) {\r\n            this.mask.destroy();\r\n        }\r\n        this.mask = null;\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Mask.js?")},"./lib/rexui/lib/plugins/gameobjects/containerlite/MaskChildren.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/mask/MaskToGameObject.js */ "./lib/rexui/lib/plugins/utils/mask/MaskToGameObject.js");\n\r\n\r\nconst Intersects = Phaser.Geom.Intersects.RectangleToRectangle;\r\nconst Overlaps = Phaser.Geom.Rectangle.Overlaps;\r\n\r\nvar MaskChildren = function (parent, mask, children) {\r\n    if (!mask) {\r\n        return;\r\n    }\r\n\r\n    if (children === undefined) {\r\n        children = parent.getAllChildren();\r\n    }\r\n\r\n    var parentBounds = parent.getBounds();\r\n    var maskGameObject = Object(_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(mask);\r\n\r\n    var child, childBounds, visiblePointsNumber;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.hasOwnProperty(\'isRexContainerLite\')) {\r\n            continue;\r\n        }\r\n        if (child === maskGameObject) {\r\n            continue;\r\n        }\r\n\r\n        if (child.getBounds) {\r\n            childBounds = child.getBounds(childBounds);\r\n            visiblePointsNumber = containsPoints(parentBounds, childBounds);\r\n            switch (visiblePointsNumber) {\r\n                case 4: // 4 points are all inside visible window, set visible\r\n                    showAll(child, mask);\r\n                    break;\r\n                case 0: // No point is inside visible window\r\n                    // Parent intersects with child, or parent is inside child, set visible, and apply mask\r\n                    if (Intersects(parentBounds, childBounds) || Overlaps(parentBounds, childBounds)) {\r\n                        showSome(child, mask);\r\n                    } else { // Set invisible\r\n                        showNone(child, mask);\r\n                    }\r\n                    break;\r\n                default: // Part of points are inside visible window, set visible, and apply mask\r\n                    showSome(child, mask);\r\n                    break;\r\n            }\r\n        } else {\r\n            showSome(child, mask);\r\n        }\r\n\r\n        parent\r\n            .resetChildVisibleState(child) // Reset local visible via child\'s visible\r\n            .updateChildVisible(child);  // Set child\'s visible via parent and local visible\r\n    }\r\n}\r\n\r\nvar containsPoints = function (rectA, rectB) {\r\n    var result = 0;\r\n    var top = rectB.top,\r\n        bottom = rectB.bottom,\r\n        left = rectB.left,\r\n        right = rectB.right;\r\n    result += rectA.contains(left, top) ? 1 : 0;\r\n    result += rectA.contains(left, bottom) ? 1 : 0;\r\n    result += rectA.contains(right, top) ? 1 : 0;\r\n    result += rectA.contains(right, bottom) ? 1 : 0;\r\n    return result;\r\n};\r\n\r\nvar showAll = function (child, mask) {\r\n    child.setVisible(true);\r\n    if (child.clearMask) {\r\n        child.clearMask();\r\n    }\r\n}\r\n\r\nvar showSome = function (child, mask) {\r\n    child.setVisible(true);\r\n    if (child.setMask) {\r\n        child.setMask(mask);\r\n    }\r\n}\r\n\r\nvar showNone = function (child, mask) {\r\n    child.setVisible(false);\r\n    if (child.clearMask) {\r\n        child.clearMask();\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (MaskChildren);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/MaskChildren.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Position.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Scale.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/Scale.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildPosition(child) {\r\n        if (child.isRexContainerLite) {\r\n            child.syncChildrenEnable = false;\r\n        }\r\n        var state = this.getLocalState(child);\r\n        child.x = state.x;\r\n        child.y = state.y;\r\n        this.localToWorld(child);\r\n\r\n        child.scaleX = state.scaleX * this.scaleX;\r\n        child.scaleY = state.scaleY * this.scaleY;\r\n\r\n        if (child.flipX !== undefined) {\r\n            child.flipX = (!this.flipX) ? state.flipX : !state.flipX;\r\n            child.flipY = (!this.flipY) ? state.flipY : !state.flipY;\r\n        }\r\n\r\n        child.rotation = state.rotation + this.rotation;\r\n\r\n        if (child.isRexContainerLite) {\r\n            child.syncChildrenEnable = true;\r\n            child.syncPosition();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    syncPosition() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildPosition, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildPositionState(gameObject) {\r\n        var state = this.getLocalState(gameObject);\r\n        state.x = gameObject.x;\r\n        state.y = gameObject.y;\r\n        this.worldToLocal(state);\r\n\r\n        state.scaleX = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.scaleX, this.scaleX);\r\n        state.scaleY = Object(_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject.scaleY, this.scaleY);\r\n\r\n        if (gameObject.flipX !== undefined) {\r\n            state.flipX = gameObject.flipX;\r\n            state.flipY = gameObject.flipY;\r\n        }\r\n\r\n        state.rotation = gameObject.rotation - this.rotation;\r\n        return this;\r\n    },\r\n    \r\n    setChildPosition(gameObject, x, y) {\r\n        gameObject.x = x;\r\n        gameObject.y = y;\r\n        this.resetChildPositionState(gameObject);\r\n        return this;\r\n    },\r\n\r\n    setChildLocalPosition(gameObject, x, y) {\r\n        var state = this.getLocalState(gameObject);\r\n        state.x = x;\r\n        state.y = y;\r\n        this.updateChildPosition(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Position.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/RemoveChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    remove(gameObject, destroyChild) {\r\n        this.children.remove(gameObject, false, destroyChild);\r\n        return this;\r\n    },\r\n\r\n    clear(destroyChild) {\r\n        this.children.clear(false, destroyChild);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/RemoveChild.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Scale = function (a, b) {\r\n    if (a === b) {\r\n        return 1;\r\n    } else {\r\n        return a / b;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Scale);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Scale.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/ScrollFactor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildScrollFactor(child) {\r\n        child.setScrollFactor(this.scrollFactorX, this.scrollFactorY);\r\n        return this;\r\n    },\r\n\r\n    syncScrollFactor() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildScrollFactor, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/ScrollFactor.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Transform.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst RotateAround = Phaser.Math.RotateAround;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    worldToLocal(point) {\r\n        // Transform\r\n        point.x -= this.x;\r\n        point.y -= this.y;\r\n        // Rotate\r\n        RotateAround(point, 0, 0, -this.rotation);\r\n        // Scale\r\n        point.x /= this.scaleX;\r\n        point.y /= this.scaleY;\r\n        // Flip\r\n        point.x *= ((!this.flipX) ? 1 : -1);\r\n        point.y *= ((!this.flipY) ? 1 : -1);\r\n        return point;\r\n    },\r\n\r\n    localToWorld(point) {\r\n        // Flip\r\n        point.x *= ((!this.flipX) ? 1 : -1);\r\n        point.y *= ((!this.flipY) ? 1 : -1);\r\n        // Scale\r\n        point.x *= this.scaleX;\r\n        point.y *= this.scaleY;\r\n        // Rotate\r\n        RotateAround(point, 0, 0, this.rotation);\r\n        // Transform\r\n        point.x += this.x;\r\n        point.y += this.y;\r\n        return point;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Transform.js?')},"./lib/rexui/lib/plugins/gameobjects/containerlite/Visible.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    updateChildVisible(child) {\r\n        child.visible = this.visible && this.getLocalState(child).visible;\r\n        return this;\r\n    },\r\n\r\n    syncVisible() {\r\n        if (this.children && this.syncChildrenEnable) {\r\n            this.children.getChildren().forEach(this.updateChildVisible, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetChildVisibleState(gameObject) {\r\n        this.getLocalState(gameObject).visible = gameObject.visible;\r\n        return this;\r\n    },\r\n\r\n    setChildVisible(gameObject, visible) {\r\n        gameObject.visible = visible;\r\n        this.resetChildVisibleState(gameObject);\r\n        return this;\r\n    },\r\n    \r\n    setChildLocalVisible(gameObject, visible) {\r\n        if (visible === undefined) {\r\n            visible = true;\r\n        }\r\n        this.getLocalState(gameObject).visible = visible;\r\n        this.updateChildVisible(gameObject);\r\n        return this;\r\n    },\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/containerlite/Visible.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/Cell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_data_DataMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/data/DataMethods.js */ "./lib/rexui/lib/plugins/utils/data/DataMethods.js");\n\r\n\r\nclass Cell {\r\n    constructor(parent, config) {\r\n        this.container = null;\r\n        this.setParent(parent);\r\n        this._deltaHeight = 0;\r\n        // this.resetFromJSON(config);\r\n    }\r\n\r\n    setParent(parent) {\r\n        this.parent = parent; // parent: table\r\n        this.parentContainer = parent.getParentContainer();\r\n    }\r\n\r\n    // resetFromJSON(o) {\r\n    //     return this;\r\n    // }\r\n\r\n    destroy(fromScene) {\r\n        if (fromScene === undefined) {\r\n            fromScene = false;\r\n        }\r\n\r\n        if (!fromScene) {\r\n            var table = this.parent;\r\n            if (this.deltaHeight !== 0) {\r\n                table.nonZeroDeltaHeightCount--;\r\n            }\r\n            this.destroyContainer();\r\n        }\r\n\r\n        this.data = undefined;\r\n        this.container = null;\r\n        this.parent = undefined;\r\n        this.parentContainer = undefined;\r\n    }\r\n\r\n    get table() {\r\n        return this.parent;\r\n    }\r\n\r\n    get scrollMode() {\r\n        return this.parentContainer.scrollMode;\r\n    }\r\n\r\n    get colIndx() {\r\n        return this.parent.cellIndxeToColIndex(this.index);\r\n    }\r\n\r\n    get rowIndx() {\r\n        return this.parent.cellIndxeToRowIndex(this.index);\r\n    }\r\n\r\n    getContainer() {\r\n        return this.container;\r\n    }\r\n\r\n    setContainer(container) {\r\n        if (!container) {\r\n            this.destroyContainer();\r\n            return this;\r\n        }\r\n\r\n        if (this.container) {\r\n            this.container.destroy();\r\n        }\r\n        this.container = container;\r\n        this.parentContainer.add(container);\r\n        return this;\r\n    }\r\n\r\n    destroyContainer() {\r\n        if (this.container) {\r\n            this.container.destroy();\r\n            this.container = null;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    popContainer() {\r\n        if (this.container) {\r\n            var container = this.container;\r\n            this.container = null;\r\n            this.parentContainer.remove(container);\r\n            return container;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    setXY(x, y) {\r\n        if (this.container) {\r\n            this.parentContainer.setChildLocalPosition(this.container, x, y);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get deltaHeight() {\r\n        return this._deltaHeight;\r\n    }\r\n\r\n    set deltaHeight(deltaHeight) {\r\n        if (deltaHeight == null) {\r\n            deltaHeight = 0;\r\n        }\r\n        var table = this.parent;\r\n        if ((this._deltaHeight === 0) && (deltaHeight !== 0)) {\r\n            table.nonZeroDeltaHeightCount++;\r\n        } else if ((this._deltaHeight !== 0) && (deltaHeight === 0)) {\r\n            table.nonZeroDeltaHeightCount--;\r\n        }\r\n\r\n        this._deltaHeight = deltaHeight;\r\n    }\r\n\r\n    setDeltaHeight(deltaHeight) {\r\n        this.deltaHeight = deltaHeight;\r\n        return this;\r\n    }\r\n\r\n    get height() {\r\n        if (this.scrollMode === 0) {\r\n            return this.deltaHeight + this.parent.defaultCellHeight;\r\n        } else {\r\n            return this.parent.defaultCellWidth;\r\n        }\r\n    }\r\n\r\n    set height(height) {\r\n        // Only worked when scrollMode is 0\r\n        if (this.scrollMode === 1) {\r\n            return;\r\n        }\r\n        this.setDeltaHeight(height - this.parent.defaultCellHeight);\r\n    }\r\n\r\n    setHeight(height) {\r\n        // Only worked when scrollMode is 0\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    get width() {\r\n        if (this.scrollMode === 0) {\r\n            return this.parent.defaultCellWidth;\r\n        } else {\r\n            return this.deltaHeight + this.parent.defaultCellHeight;\r\n        }\r\n    }\r\n\r\n    set width(width) {\r\n        // Only worked when scrollMode is 1\r\n        if (this.scrollMode === 0) {\r\n            return;\r\n        }\r\n        this.setDeltaHeight(width - this.parent.defaultCellHeight);\r\n    }\r\n\r\n    setWidth(width) {\r\n        this.width = width;\r\n        return this;\r\n    }\r\n\r\n    get scene() {\r\n        return this.parentContainer.scene;\r\n    }\r\n};\r\n\r\n\r\nObject.assign(\r\n    Cell.prototype,\r\n    _utils_data_DataMethods_js__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n);\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Cell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/Cell.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/GridTable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../containerlite/ContainerLite.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/ContainerLite.js");\n/* harmony import */ var _Table_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Table.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/Table.js");\n/* harmony import */ var _utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/mask/DefaultMask.js */ "./lib/rexui/lib/plugins/utils/mask/DefaultMask.js");\n/* harmony import */ var _utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/mask/MaskToGameObject.js */ "./lib/rexui/lib/plugins/utils/mask/MaskToGameObject.js");\n/* harmony import */ var _methods_Methods_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./methods/Methods.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/Methods.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst Container = _containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__["default"];\r\nconst Components = Phaser.GameObjects.Components;\r\nconst Set = Phaser.Structs.Set;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nclass GridTable extends Container {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        super(scene, x, y, width, height);\r\n        this.type = "rexGridTable";\r\n        this._tableOX = GetValue(config, "tableOX", 0);\r\n        this._tableOY = GetValue(config, "tableOY", 0);\r\n        this.visibleCells = new Set();\r\n        this.preVisibleCells = new Set();\r\n        this.visibleStartX = null;\r\n        this.visibleEndX = null;\r\n        this.visibleStartY = null;\r\n        this.visibleEndY = null;\r\n        this.lastVisibleCellIdx = null;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n        this.execeedLeftState = false;\r\n        this.execeedRightState = false;\r\n\r\n        var reuseCellContainer = GetValue(config, "reuseCellContainer", false);\r\n        this.cellContainersPool = reuseCellContainer\r\n            ? scene.add.group()\r\n            : undefined;\r\n        var callback = GetValue(config, "cellVisibleCallback", null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, "cellVisibleCallbackScope", undefined);\r\n            this.on("cellvisible", callback, scope);\r\n        }\r\n        callback = GetValue(config, "cellInvisibleCallback", null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(\r\n                config,\r\n                "cellInvisibleCallbackScope",\r\n                undefined\r\n            );\r\n            this.on("cellinvisible", callback, scope);\r\n        }\r\n        this.zoom = GetValue(config, "zoom", 1);\r\n        this.cellsMask = undefined;\r\n        this.setCellsMask(GetValue(config, "mask", true));\r\n        // this.cellsMaskGameObject = undefined;\r\n\r\n        this.setScrollMode(GetValue(config, "scrollMode", 0));\r\n        this.setClampMode(GetValue(config, "clamplTableOXY", true));\r\n        // var cellOriginX = GetValue(config, "cellOriginX", 0.5);\r\n        // var cellOriginY = GetValue(config, "cellOriginY", 0.5);\r\n        // var padX = 0;\r\n        // var padY = 0;\r\n        // Pre-process cell size\r\n        if (this.scrollMode === 0) {\r\n            // scroll y 垂直滚动\r\n            var cellWidth = GetValue(config, "cellWidth", undefined);\r\n            this.expandCellSize = cellWidth === undefined;\r\n            if (cellWidth === undefined) {\r\n                var columns = GetValue(config, "columns", 1);\r\n                config.cellWidth = this.width / columns;\r\n            }\r\n            // padY = cellOriginY * cellHeight;\r\n        } else {\r\n            // scroll x 水平滚动\r\n            // Swap cell width and cell height\r\n            var cellWidth = GetValue(config, "cellHeight", undefined);\r\n            var cellHeight = GetValue(config, "cellWidth", undefined);\r\n            this.expandCellSize = cellWidth === undefined;\r\n            config.cellWidth = cellWidth;\r\n            config.cellHeight = cellHeight;\r\n            // padX = cellOriginX * cellWidth;\r\n        }\r\n\r\n        const cellOriginX = GetValue(config, "cellOriginX", 0.5);\r\n        // if (cellOriginX > 0 && this.scrollMode) {\r\n        //     // 水平：宽高取值相反； 垂直：宽高取值正常\r\n        //     config.cellOriginX = 0;\r\n        // }\r\n        const cellOriginY = GetValue(config, "cellOriginY", 0.5);\r\n        // if (cellOriginY > 0 && !this.scrollMode) {\r\n        //     // 水平：宽高取值相反； 垂直：宽高取值正常\r\n        //     config.cellOriginY = 0;\r\n        // }\r\n        this.table = new _Table_js__WEBPACK_IMPORTED_MODULE_1__["default"](this, config);\r\n\r\n        this.updateTable();\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        this.table.destroy(fromScene);\r\n        this.table = undefined;\r\n        if (this.cellContainersPool) {\r\n            this.cellContainersPool.destroy(true);\r\n            this.cellContainersPool = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setScrollMode(mode) {\r\n        if (typeof mode === "string") {\r\n            mode = SCROLLMODE[mode.toLowerCase()];\r\n        }\r\n        this.scrollMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampTableOXYMode = mode;\r\n        return this;\r\n    }\r\n    setColumnCount(cnt) {\r\n        this.table.setColumnCount(cnt);\r\n        return this;\r\n    }\r\n    get tableOY() {\r\n        return this._tableOY;\r\n    }\r\n\r\n    get tableOX() {\r\n        return this._tableOX;\r\n    }\r\n\r\n    set tableOY(oy) {\r\n        this.setTableOY(oy).updateTable(true);\r\n    }\r\n\r\n    set tableOX(ox) {\r\n        this.setTableOX(ox).updateTable(true);\r\n    }\r\n\r\n    setTableOXY(ox, oy) {\r\n        this.setTableOY(oy).setTableOX(ox);\r\n        return this;\r\n    }\r\n\r\n    addTableOY(dy) {\r\n        this.setTableOY(this.tableOY + dy);\r\n        return this;\r\n    }\r\n\r\n    addTableOX(dx) {\r\n        this.setTableOX(this.tableOX + dx);\r\n        return this;\r\n    }\r\n\r\n    addTableOXY(dx, dy) {\r\n        this.addTableOY(dy).addTableOX(dx);\r\n        return this;\r\n    }\r\n\r\n    setTableOYByPercentage(percentage) {\r\n        this.setTableOY(-this.tableVisibleHeight * percentage);\r\n        return this;\r\n    }\r\n\r\n    getTableOYPercentage() {\r\n        var tableVisibleHeight = this.tableVisibleHeight;\r\n        if (tableVisibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return this.tableOY / -tableVisibleHeight;\r\n    }\r\n\r\n    set t(value) {\r\n        this.setTableOYByPercentage(value).updateTable();\r\n    }\r\n\r\n    get t() {\r\n        return this.getTableOYPercentage();\r\n    }\r\n\r\n    getCells() {\r\n        return this.table.cells;\r\n    }\r\n\r\n    getCell(cellIdx) {\r\n        return this.table.getCell(cellIdx, true);\r\n    }\r\n\r\n    getCellContainer(cellIdx) {\r\n        var cell = this.table.getCell(cellIdx, false);\r\n        var container;\r\n        if (cell) {\r\n            container = cell.getContainer();\r\n        }\r\n        return container;\r\n    }\r\n\r\n    get cellsCount() {\r\n        return this.table.cellsCount;\r\n    }\r\n\r\n    get columnCount() {\r\n        return this.table.colCount;\r\n    }\r\n\r\n    setCellHeight(cellIdx, height) {\r\n        var cell;\r\n        if (typeof cellIdx === "number") {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.height = height; // Only worked when scrollMode is 0\r\n        return this;\r\n    }\r\n\r\n    setCellWidth(cellIdx, width) {\r\n        var cell;\r\n        if (typeof cellIdx === "number") {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.width = width; // Only worked when scrollMode is 1\r\n        return this;\r\n    }\r\n\r\n    setCellsMask(maskConfig) {\r\n        var maskEnable, maskPadding;\r\n        if (maskConfig === true) {\r\n            maskEnable = true;\r\n            maskPadding = 0;\r\n        } else if (maskConfig === false) {\r\n            maskEnable = false;\r\n        } else {\r\n            maskEnable = GetValue(maskConfig, "mask", true);\r\n            maskPadding = GetValue(maskConfig, "padding", 0);\r\n        }\r\n        if (maskEnable) {\r\n            this.cellsMaskGameObject = new _utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__["default"](this, 0, maskPadding);\r\n            this.cellsMask = this.cellsMaskGameObject.createGeometryMask();\r\n            //  this.add(this.cellsMaskGameObject);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    getCellsMaskGameObject() {\r\n        return this.cellsMaskGameObject;\r\n    }\r\n\r\n    get instHeight() {\r\n        return this.scrollMode === 0 ? this.height : this.width;\r\n    }\r\n\r\n    get instWidth() {\r\n        return this.scrollMode === 0 ? this.width : this.height;\r\n    }\r\n\r\n    get tableHeight() {\r\n        return this.table.totalRowsHeight;\r\n    }\r\n\r\n    get tableWidth() {\r\n        return this.table.totalColumnWidth;\r\n    }\r\n\r\n    get topTableOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomTableOY() {\r\n        return -this.tableVisibleHeight;\r\n    }\r\n\r\n    get leftTableOX() {\r\n        return 0;\r\n    }\r\n\r\n    get rightTableOX() {\r\n        return -this.tableVisibleWidth;\r\n    }\r\n\r\n    get tableVisibleHeight() {\r\n        var h;\r\n        var tableHeight = this.tableHeight;\r\n        var instHeight = this.instHeight;\r\n        if (tableHeight > instHeight) {\r\n            h = tableHeight - instHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    get tableVisibleWidth() {\r\n        var w;\r\n        var tableWidth = this.tableWidth;\r\n        var instWidth = this.instWidth;\r\n        if (tableWidth > instWidth) {\r\n            w = tableWidth - instWidth;\r\n        } else {\r\n            w = 0;\r\n        }\r\n        return w;\r\n    }\r\n\r\n    get bottomLeftY() {\r\n        return -(this.displayHeight * this.originY) + this.displayHeight;\r\n    }\r\n\r\n    get topRightX() {\r\n        return -(this.displayWidth * this.originX) + this.displayWidth;\r\n    }\r\n\r\n    get topLeftX() {\r\n        return -(this.displayWidth * this.originX);\r\n    }\r\n\r\n    get topLeftY() {\r\n        return -(this.displayHeight * this.originY);\r\n    }\r\n\r\n    get bottomBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.bottomLeftY + this.originOffsetY;\r\n        } else {\r\n            return this.topRightX + this.originOffsetX;\r\n        }\r\n    }\r\n\r\n    get rightBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.topRightX + this.originOffsetX;\r\n        } else {\r\n            return this.bottomLeftY + this.originOffsetY;\r\n        }\r\n    }\r\n\r\n    get originOffsetX() {\r\n        var table = this.table;\r\n        var len = table.defaultCellWidth * table.cellOriginX + table.padX;\r\n        return len;\r\n    }\r\n\r\n    get originOffsetY() {\r\n        var table = this.table;\r\n        var len = table.defaultCellHeight * table.cellOriginY + table.padY;\r\n        return len;\r\n    }\r\n    resize(width, height) {\r\n        if (this.width === width && this.height === height) {\r\n            return this;\r\n        }\r\n\r\n        super.resize(width, height);\r\n        if (this.cellsMask) {\r\n            Object(_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_3__["default"])(Object(_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_4__["default"])(this.cellsMask), width * this.zoom, height * this.zoom);\r\n        }\r\n\r\n        if (this.expandCellSize) {\r\n            this.table.setDefaultCellWidth(\r\n                this.instWidth / this.table.colCount\r\n            );\r\n        }\r\n        this.updateTable(true);\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\n// mixin\r\nObject.assign(GridTable.prototype, Components.GetBounds, _methods_Methods_js__WEBPACK_IMPORTED_MODULE_5__["default"]);\r\n\r\nconst SCROLLMODE = {\r\n    v: 0,\r\n    vertical: 0,\r\n    h: 1,\r\n    horizontal: 1,\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GridTable);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/GridTable.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/Table.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Cell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Cell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/Cell.js");\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../pool.js */ "./lib/rexui/lib/plugins/pool.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst SpliceOne = Phaser.Utils.Array.SpliceOne;\r\n\r\nclass Table {\r\n    constructor(parent, config) {\r\n        this.parent = parent; // parent: GridTable game object (Container)\r\n        this.cells = [];\r\n        this.cellPool = new _pool_js__WEBPACK_IMPORTED_MODULE_1__["default"]();\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.colCount = undefined;\r\n        this._nonZeroDeltaHeightCount = 0;\r\n        this.resetTotalRowsHeight();\r\n        this.zoom = GetValue(o, \'zoom\', 1);\r\n        this.dpr = GetValue(o, \'dpr\', 1);\r\n        this.cellOriginX = GetValue(o, "cellOriginX", 0.5);\r\n        this.cellOriginY = GetValue(o, "cellOriginY", 0.5);\r\n        this.padX = GetValue(o, "cellPadX", 0);\r\n        this.padY = GetValue(0, "cellPadY", 0);\r\n        this.setDefaultCellHeight(GetValue(o, \'cellHeight\', 30));\r\n        this.setDefaultCellWidth(GetValue(o, \'cellWidth\', 30));\r\n        this.initCells(GetValue(o, \'cellsCount\', 0));\r\n        this.setColumnCount(GetValue(o, \'columns\', 1));\r\n        return this;\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        for (var i = 0, cnt = this.cells.length; i < cnt; i++) {\r\n            this.freeCell(this.cells[i], fromScene);\r\n        }\r\n        this.cellPool.destroy();\r\n        this.cells = undefined;\r\n        this.parent = undefined;\r\n    }\r\n\r\n    get nonZeroDeltaHeightCount() {\r\n        return this._nonZeroDeltaHeightCount;\r\n    }\r\n\r\n    set nonZeroDeltaHeightCount(count) {\r\n        if (this._nonZeroDeltaHeightCount === count) {\r\n            return;\r\n        }\r\n        this._nonZeroDeltaHeightCount = count;\r\n        this.resetTotalRowsHeight();\r\n    }\r\n\r\n    get defaultCellHeightMode() {\r\n        return (this.nonZeroDeltaHeightCount === 0);\r\n    }\r\n\r\n    setDefaultCellHeight(height) {\r\n        this.defaultCellHeight = height;\r\n        return this;\r\n    }\r\n\r\n    setDefaultCellWidth(width) {\r\n        this.defaultCellWidth = width;\r\n        return this;\r\n    }\r\n\r\n    initCells(size) {\r\n        var cells = this.cells;\r\n        cells.length = size;\r\n        for (var i = 0; i < size; i++) {\r\n            cells[i] = null;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    insertNewCells(cellIdx, count) {\r\n        var cells = this.cells;\r\n        if (cellIdx === cells.length) {\r\n            // append at end of array\r\n            var endIdx = cellIdx + count;\r\n            cells.length = endIdx;\r\n            for (var i = cellIdx; i < endIdx; i++) {\r\n                cells[i] = null;\r\n            }\r\n        } else {\r\n            var newCells = [];\r\n            newCells.length = count;\r\n            for (var i = 0; i < count; i++) {\r\n                newCells[i] = null;\r\n            }\r\n            this.cells.splice(cellIdx, 0, ...newCells);\r\n        }\r\n\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    removeCells(cellIdx, count) {\r\n        var endIdx = cellIdx + count;\r\n        for (var i = cellIdx; i < endIdx; i++) {\r\n            this.freeCell(i);\r\n        }\r\n\r\n        if (endIdx === this.cells.length) {\r\n            // remove until end of array\r\n            this.cells.length = cellIdx;\r\n        } else {\r\n            if (count === 1) {\r\n                SpliceOne(this.cells, cellIdx);\r\n            } else {\r\n                this.cells.splice(cellIdx, count);\r\n            }\r\n            this.buildCellIndex(cellIdx);\r\n        }\r\n\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    setColumnCount(cnt) {\r\n        this.colCount = cnt;\r\n        this.resetTotalRowsHeight();\r\n        return this;\r\n    }\r\n\r\n    get rowCount() {\r\n        return Math.ceil(this.cells.length / this.colCount);\r\n    }\r\n\r\n    get cellsCount() {\r\n        return this.cells.length;\r\n    }\r\n\r\n    isValidCellIdx(idx) {\r\n        return ((idx >= 0) && (idx < this.cells.length));\r\n    }\r\n\r\n    heightToRowIndex(height, isCeil) {\r\n        // defaultCellHeightMode\r\n        if (this.defaultCellHeightMode) {\r\n            var rowIdx = height / this.defaultCellHeight;\r\n            if (isCeil) {\r\n                rowIdx = Math.ceil(rowIdx);\r\n            } else {\r\n                rowIdx = Math.floor(rowIdx);\r\n            }\r\n\r\n            return rowIdx;\r\n        }\r\n\r\n        // count cell height one by one\r\n        var rowCount = this.rowCount;\r\n        var remainder = height,\r\n            isValidIdx;\r\n        var cell, rowHeight, rowIdx = 0;\r\n\r\n        while (1) {\r\n            rowHeight = this.getRowHeight(rowIdx);\r\n            remainder -= rowHeight;\r\n\r\n            isValidIdx = (rowIdx >= 0) && (rowIdx < rowCount);\r\n            if ((remainder > 0) && isValidIdx) {\r\n                rowIdx += 1;\r\n            } else if (remainder === 0) {\r\n                return rowIdx;\r\n            } else {\r\n                if (isCeil) {\r\n                    var preRowIdx = rowIdx;\r\n                    rowIdx += 1;\r\n                    isValidIdx = (rowIdx >= 0) && (rowIdx < rowCount);\r\n\r\n                    if (!isValidIdx)\r\n                        rowIdx = preRowIdx;\r\n                }\r\n\r\n                return rowIdx;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    widthToColIndex(width, isCeil) {\r\n        var colIdx = width / this.defaultCellWidth;\r\n        if (isCeil) {\r\n            colIdx = Math.ceil(colIdx);\r\n        } else {\r\n            colIdx = Math.floor(colIdx);\r\n        }\r\n\r\n        return colIdx;\r\n    }\r\n\r\n    colRowToCellIndex(colIdx, rowIdx) {\r\n        if (colIdx >= this.colCount) {\r\n            return null;\r\n        }\r\n        return (rowIdx * this.colCount) + colIdx;\r\n    }\r\n\r\n    rowIndexToHeight(start, end) {\r\n        // defaultCellHeightMode\r\n        if (this.defaultCellHeightMode) {\r\n            return (end - start + 1) * this.defaultCellHeight + this.defaultCellHeight * this.cellOriginY + this.padY;\r\n        }\r\n\r\n        var h, sum = 0;\r\n        for (var i = start; i <= end; i++) {\r\n            h = this.getRowHeight(i);\r\n            sum += h;\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    colIndexToWidth(start, end) {\r\n        return (end - start + 1) * this.defaultCellWidth + this.defaultCellWidth * this.cellOriginX + this.padX;\r\n    };\r\n\r\n    getRowHeight(rowIdx) {\r\n        var cnt = this.colCount;\r\n        // single column\r\n        if (cnt <= 1) {\r\n            return this.getCellHeight(this.colRowToCellIndex(0, rowIdx));\r\n        }\r\n\r\n        // multiple columns, get the maximum height\r\n        var maxHeight = 0,\r\n            cellHeight;\r\n        for (var i = 0; i < cnt; i++) {\r\n            cellHeight = this.getCellHeight(this.colRowToCellIndex(i, rowIdx));\r\n            if (maxHeight < cellHeight)\r\n                maxHeight = cellHeight;\r\n        }\r\n        return maxHeight;\r\n    }\r\n\r\n    getColWidth(idx) {\r\n        return this.defaultCellWidth;\r\n    }\r\n\r\n    getCellHeight(cellIdx) {\r\n        if (!this.isValidCellIdx(cellIdx)) {\r\n            return 0;\r\n        }\r\n\r\n        var cellHeight;\r\n        if (this.defaultCellHeightMode)\r\n            cellHeight = this.defaultCellHeight;\r\n        else {\r\n            var cell = this.getCell(cellIdx, false);\r\n            var deltaHeight = (cell) ? cell.deltaHeight : 0;\r\n            cellHeight = this.defaultCellHeight + deltaHeight;\r\n        }\r\n\r\n        return cellHeight;\r\n    }\r\n\r\n    resetTotalRowsHeight() {\r\n        this._totalRowsHeight = null;\r\n    }\r\n\r\n    get totalRowsHeight() {\r\n        if (this._totalRowsHeight === null) {\r\n            this._totalRowsHeight = this.rowIndexToHeight(0, this.rowCount - 1);\r\n        }\r\n\r\n        return this._totalRowsHeight;\r\n    }\r\n\r\n    get totalColumnWidth() {\r\n        return this.colCount * this.defaultCellWidth + this.cellOriginX * this.defaultCellWidth + this.padX;\r\n    }\r\n\r\n    cellIndxeToColIndex(cellIdx) {\r\n        return cellIdx % this.colCount;\r\n    }\r\n\r\n    cellIndxeToRowIndex(cellIdx) {\r\n        return Math.floor(cellIdx / this.colCount);\r\n    }\r\n\r\n    getCell(cellIdx, createNewCell) {\r\n        if (!this.isValidCellIdx(cellIdx)) {\r\n            return null;\r\n        }\r\n\r\n        if (createNewCell === undefined) {\r\n            createNewCell = true;\r\n        }\r\n        if ((this.cells[cellIdx] === null) && createNewCell) {\r\n            var cell = this.newCell(cellIdx);\r\n            this.cells[cellIdx] = cell;\r\n        }\r\n\r\n        return this.cells[cellIdx];\r\n    }\r\n\r\n    newCell(cellIdx) {\r\n        var cell = this.cellPool.pop();\r\n        if (cell === null) {\r\n            cell = new _Cell_js__WEBPACK_IMPORTED_MODULE_0__["default"](this);\r\n        } else {\r\n            cell.setParent(this);\r\n        }\r\n        cell.index = cellIdx;\r\n\r\n        return cell;\r\n    }\r\n\r\n    buildCellIndex(startIdx) {\r\n        if (startIdx === undefined) {\r\n            startIdx = 0;\r\n        }\r\n        var cells = this.cells,\r\n            cell;\r\n        for (var i = startIdx, len = cells.length; i < len; i++) {\r\n            cell = cells[i];\r\n            if (cell) {\r\n                cell.index = i;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    getParentContainer() {\r\n        return this.parent;\r\n    }\r\n\r\n    freeCell(cell, fromScene) {\r\n        if (typeof (cell) === \'number\') {\r\n            cell = this.cells[cell];\r\n        }\r\n\r\n        if (!cell) {\r\n            return this;\r\n        }\r\n\r\n        cell.destroy(fromScene);\r\n        if (!fromScene) {\r\n            this.cellPool.push(cell);\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Table);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/Table.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/EachCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EachVisibleCell", function() { return EachVisibleCell; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IterateVisibleCell", function() { return IterateVisibleCell; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EachCell", function() { return EachCell; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IterateCell", function() { return IterateCell; });\n// For when you know this Set will be modified during the iteration\r\nvar EachVisibleCell = function (callback, scope) {\r\n    this.visibleCells.each(callback, scope);\r\n    return this;\r\n}\r\n\r\n// For when you absolutely know this Set won\'t be modified during the iteration\r\nvar IterateVisibleCell = function (callback, scope) {\r\n    this.visibleCells.iterate(callback, scope);\r\n    return this;\r\n}\r\n\r\nvar EachCell = function (callback, scope) {\r\n    this.table.cells.slice().forEach(callback, scope);\r\n    return this;\r\n}\r\n\r\nvar IterateCell = function (callback, scope) {\r\n    this.table.cells.forEach(callback, scope);\r\n    return this;\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/EachCell.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/InsertNewCells.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst Clamp = Phaser.Math.Clamp;\r\n\r\nvar InsertNewCells = function (cellIdx, count) {\r\n    if (typeof (cellIdx) === 'object') {\r\n        cellIdx = cellIdx.index;\r\n    }\r\n    if (count === undefined) {\r\n        count = 1;\r\n    }\r\n    if (count <= 0) {\r\n        return this;\r\n    }\r\n    cellIdx = Clamp(cellIdx, 0, this.cellsCount);\r\n    this.table.insertNewCells(cellIdx, count);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InsertNewCells);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/InsertNewCells.js?")},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/IsCellVisible.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar IsCellVisible = function (cellIdx) {\r\n    var cell = this.table.getCell(cellIdx, false);\r\n    return cell && this.visibleCells.contains(cell);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsCellVisible);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/IsCellVisible.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetTableOY_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetTableOY.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOY.js");\n/* harmony import */ var _SetTableOX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetTableOX.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOX.js");\n/* harmony import */ var _updatetable_UpdateTable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./updatetable/UpdateTable.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/UpdateTable.js");\n/* harmony import */ var _IsCellVisible_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./IsCellVisible.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/IsCellVisible.js");\n/* harmony import */ var _PointerToCell_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PointerToCell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/PointerToCell.js");\n/* harmony import */ var _EachCell_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./EachCell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/EachCell.js");\n/* harmony import */ var _SetCellsCount_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SetCellsCount.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetCellsCount.js");\n/* harmony import */ var _InsertNewCells_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./InsertNewCells.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/InsertNewCells.js");\n/* harmony import */ var _RemoveCells_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./RemoveCells.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/RemoveCells.js");\n/* harmony import */ var _SetColumnCount_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SetColumnCount.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetColumnCount.js");\n/* harmony import */ var _SetGridSize_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./SetGridSize.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetGridSize.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setTableOY: _SetTableOY_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    setTableOX: _SetTableOX_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    updateTable: _updatetable_UpdateTable_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    isCellVisible: _IsCellVisible_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    pointerToCellIndex: _PointerToCell_js__WEBPACK_IMPORTED_MODULE_4__["PointerToCellIndex"],\r\n    pointerToCellContainer: _PointerToCell_js__WEBPACK_IMPORTED_MODULE_4__["PointerToCellContainer"],\r\n    eachVisibleCell: _EachCell_js__WEBPACK_IMPORTED_MODULE_5__["EachVisibleCell"],\r\n    iterateVisibleCell: _EachCell_js__WEBPACK_IMPORTED_MODULE_5__["IterateVisibleCell"],\r\n    eachCell: _EachCell_js__WEBPACK_IMPORTED_MODULE_5__["EachCell"],\r\n    iterateCell: _EachCell_js__WEBPACK_IMPORTED_MODULE_5__["IterateCell"],\r\n\r\n    setCellsCount: _SetCellsCount_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    insertNewCells: _InsertNewCells_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n    removeCells: _RemoveCells_js__WEBPACK_IMPORTED_MODULE_8__["default"],\r\n    setColumnCount: _SetColumnCount_js__WEBPACK_IMPORTED_MODULE_9__["default"],\r\n    setGridSize: _SetGridSize_js__WEBPACK_IMPORTED_MODULE_10__["default"]\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/Methods.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/PointerToCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PointerToCellIndex", function() { return PointerToCellIndex; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PointerToCellContainer", function() { return PointerToCellContainer; });\n// var PointerToCellIndex = function (x, y) {\r\n//     y -= (this.y + this.topLeftY);\r\n//     x -= (this.x + this.topLeftX);\r\n//     var offsetTableOY = this.tableOY - ((this.scrollMode === 0) ? y : x);\r\n//     var offsetTableOX = this.tableOX - ((this.scrollMode === 0) ? x : y);\r\n\r\n//     var table = this.table;\r\n//     var rowIdx = table.heightToRowIndex(-offsetTableOY);\r\n//     var colIdx = table.widthToColIndex(-offsetTableOX);\r\n//     var cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n//     if (cellIdx === null) {\r\n//         return null;\r\n//     }\r\n//     if (!this.isCellVisible(cellIdx)) {\r\n//         return null;\r\n//     }\r\n//     return cellIdx;\r\n// }\r\n\r\nvar PointerToCellIndex = function (x, y) {\r\n    var worldpos = this.getWorldTransformMatrix();\r\n    var mx = worldpos.tx;// this.x;\r\n    var my = worldpos.ty;// this.y;\r\n    y -= (my + this.topLeftY * this.zoom);\r\n    x -= (mx + this.topLeftX * this.zoom);\r\n    var offsetTableOY = this.tableOY * this.zoom - ((this.scrollMode === 0) ? y : x);\r\n    var offsetTableOX = this.tableOX * this.zoom - ((this.scrollMode === 0) ? x : y);\r\n\r\n    var table = this.table;\r\n    var rowIdx = table.heightToRowIndex(-offsetTableOY);\r\n    var colIdx = table.widthToColIndex(-offsetTableOX);\r\n    var cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n    if (cellIdx === null) {\r\n        return null;\r\n    }\r\n    if (!this.isCellVisible(cellIdx)) {\r\n        return null;\r\n    }\r\n    return cellIdx;\r\n}\r\n\r\nvar PointerToCellContainer = function (x, y) {\r\n    var cellIdx = PointerToCellIndex.call(this, x, y);\r\n    if (cellIdx === null) {\r\n        return undefined;\r\n    }\r\n    return this.getCellContainer(cellIdx);\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/PointerToCell.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/RemoveCells.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _updatetable_HideCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./updatetable/HideCell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js");\n\r\n\r\nvar RemoveCells = function (cellIdx, count) {\r\n    if (typeof (cellIdx) === \'object\') {\r\n        cellIdx = cellIdx.index;\r\n    }\r\n    if (count === undefined) {\r\n        count = 1;\r\n    }\r\n    if (cellIdx < 0) {\r\n        count += cellIdx;\r\n        cellIdx = 0;\r\n    }\r\n    if (count <= 0) {\r\n        return this;\r\n    }\r\n    // out-of-range\r\n    if (cellIdx > this.cellsCount) {\r\n        return this;\r\n    }\r\n\r\n    if (cellIdx <= this.lastVisibleCellIdx) {\r\n        var preList = this.preVisibleCells;\r\n        var curList = this.visibleCells;\r\n        var cell;\r\n        for (var i = cellIdx, endIdx = cellIdx + count; i < endIdx; i++) {\r\n            cell = this.getCell(i, false);\r\n            if (cell) {\r\n                if (curList.contains(cell)) {\r\n                    _updatetable_HideCell_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, cell);\r\n                    curList.delete(cell);\r\n                }\r\n                preList.delete(cell);\r\n            }\r\n        }\r\n    }\r\n\r\n    this.table.removeCells(cellIdx, count);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RemoveCells);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/RemoveCells.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetCellsCount.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetCellsCount = function (count) {\r\n    var cellsCount = this.cellsCount;\r\n    if (cellsCount === count) {\r\n        return this;\r\n    }\r\n\r\n    if (cellsCount > count) {\r\n        this.removeCells(count, cellsCount - count);\r\n    } else { // cellsCount < count\r\n        this.insertNewCells(cellsCount, count - cellsCount);\r\n    }\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetCellsCount);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetCellsCount.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetColumnCount.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetColumnCount = function (count) {\r\n    if (this.table.colCount === count) {\r\n        return this;\r\n    }\r\n    this.table.setColumnCount(count);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetColumnCount);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetColumnCount.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetGridSize.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetGridSize = function (colCount, rowCount) {\r\n    this.setCellsCount(colCount * rowCount);\r\n    this.table.setColumnCount(colCount);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetGridSize);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetGridSize.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOX.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetTableOX = function (ox) {\r\n    var table = this.table;\r\n    var leftTableOX = this.leftTableOX;\r\n    var rightTableOX = this.rightTableOX;\r\n    var tableOXExeceedLeft = (ox > this.leftTableOX);\r\n    var tableOXExeceedRight = (ox < this.rightTableOX);\r\n    if (this.clampTableOXYMode) {\r\n        var colCount = table.colCount;\r\n        var visibleColCount = table.widthToColIndex(this.instWidth, true);\r\n\r\n        // less then 1 page            \r\n        if (colCount < visibleColCount) {\r\n            ox = 0;\r\n        } else if (tableOXExeceedLeft) {\r\n            ox = leftTableOX\r\n        } else {\r\n            // var tableVisibleWidth = this.tableVisibleWidth;\r\n            if (tableOXExeceedRight)\r\n                ox = rightTableOX;\r\n        }\r\n    }\r\n\r\n    if (this._tableOX !== ox) {\r\n        this._tableOX = ox;\r\n    }\r\n\r\n    if (tableOXExeceedLeft) {\r\n        if (!this.execeedLeftState) {\r\n            this.emit('execeedleft', this, ox, leftTableOX);\r\n        }\r\n    }\r\n    this.execeedLeftState = tableOXExeceedLeft;\r\n\r\n    if (tableOXExeceedRight) {\r\n        if (!this.execeedRightState) {\r\n            this.emit('execeedright', this, ox, rightTableOX);\r\n        }\r\n    }\r\n    this.execeedRightState = tableOXExeceedRight;\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetTableOX);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOX.js?")},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOY.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetTableOY = function (oy) {\r\n    var table = this.table;\r\n    var topTableOY = this.topTableOY;\r\n    var bottomTableOY = this.bottomTableOY;\r\n    var tableOYExceedTop = (oy > this.topTableOY);\r\n    var tableOYExeceedBottom = (oy < this.bottomTableOY);\r\n    if (this.clampTableOXYMode) {\r\n        var rowCount = table.rowCount;\r\n        var visibleRowCount = table.heightToRowIndex(this.instHeight, true);\r\n\r\n        // less then 1 page            \r\n        if (rowCount < visibleRowCount) {\r\n            oy = 0;\r\n        } else if (tableOYExceedTop) {\r\n            oy = topTableOY\r\n        } else if (tableOYExeceedBottom) {\r\n            oy = bottomTableOY;\r\n        }\r\n    }\r\n\r\n    if (this._tableOY !== oy) {\r\n        this._tableOY = oy;\r\n    }\r\n\r\n\r\n    if (tableOYExceedTop) {\r\n        if (!this.execeedTopState) {\r\n            this.emit('execeedtop', this, oy, topTableOY);\r\n        }\r\n    }\r\n    this.execeedTopState = tableOYExceedTop;\r\n\r\n    if (tableOYExeceedBottom) {\r\n        if (!this.execeedBottomState) {\r\n            this.emit('execeedbottom', this, oy, bottomTableOY);\r\n        }\r\n    }\r\n    this.execeedBottomState = tableOYExeceedBottom;\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetTableOY);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/SetTableOY.js?")},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar HideCell = function (cell) {\r\n    // Option: pop container of cell by cell.popContainer() under this event \r\n    this.emit('cellinvisible', cell);\r\n\r\n    if (this.cellContainersPool) {\r\n        var cellContainer = cell.popContainer(); // null if already been removed\r\n        if (cellContainer) {\r\n            this.cellContainersPool.killAndHide(cellContainer);\r\n        }\r\n    }\r\n\r\n    cell.destroyContainer(); // Destroy container of cell\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (HideCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js?")},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCells.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _HideCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HideCell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCell.js");\n\r\n\r\nvar HideCells = function () {\r\n    var preList = this.preVisibleCells;\r\n    var curList = this.visibleCells;\r\n    preList.iterate(function (cell) {\r\n        if (!curList.contains(cell)) {\r\n            _HideCell_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, cell);\r\n        }\r\n    }, this);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (HideCells);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCells.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/MaskCells.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../containerlite/MaskChildren.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/MaskChildren.js");\n\r\n\r\nvar MaskCells = function () {\r\n    var children = [];\r\n    var cells = this.visibleCells.entries, container;\r\n    for (var i = 0, cnt = cells.length; i < cnt; i++) {\r\n        container = cells[i].getContainer();\r\n        if (container) {\r\n            if (container.isRexContainerLite) { // ContainerLite\r\n                container.getAllChildren(children);\r\n            } else { // Others\r\n                children.push(container);\r\n            }\r\n        }\r\n    }\r\n    Object(_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, this.cellsMask, children);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (MaskCells);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/MaskCells.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar ShowCell = function (cell) {\r\n    // Attach container to cell by cell.setContainer(container) under this event\r\n    var reusedCellContainer = null;\r\n    if (this.cellContainersPool) {\r\n        reusedCellContainer = this.cellContainersPool.getFirstDead();\r\n        if (reusedCellContainer !== null) { // Reuse this game object\r\n            reusedCellContainer.setActive(true).setVisible(true);\r\n        }\r\n    }\r\n\r\n    this.emit('cellvisible', cell, reusedCellContainer);\r\n\r\n    if (this.cellContainersPool) {\r\n        var cellContainer = cell.getContainer();\r\n        if (cellContainer) {\r\n            if (reusedCellContainer === null) {\r\n                this.cellContainersPool.add(cellContainer); // New cell container, add to pool\r\n            } else if (reusedCellContainer !== cellContainer) {\r\n                // Why reusedCellContainer is not equal to cellContainer?\r\n                this.cellContainersPool.add(cellContainer); // New cell container, add to pool\r\n                this.cellContainersPool.killAndHide(reusedCellContainer); // Unused cell container, put back to pool\r\n            }\r\n        } else { // No cell container added\r\n            if (reusedCellContainer !== null) {\r\n                this.cellContainersPool.killAndHide(reusedCellContainer); // Unused cell container, put back to pool\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ShowCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCell.js?")},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCells.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ShowCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ShowCell.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCell.js");\n\r\n\r\nvar ShowCells = function () {\r\n    if (this.cellsCount === 0) {\r\n        return;\r\n    }\r\n    var table = this.table;\r\n    var rowIdx = table.heightToRowIndex(-this.tableOY);\r\n    if (rowIdx < 0) {\r\n        rowIdx = 0;\r\n    }\r\n\r\n    var colIdx = table.widthToColIndex(-this.tableOX);\r\n    if (colIdx < 0) {\r\n        colIdx = 0;\r\n    }\r\n\r\n    var cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n    var bottomBound = this.bottomBound;\r\n    var rightBound = this.rightBound;\r\n    var lastIdx = table.cellsCount - 1;\r\n    var lastColIdx = table.colCount - 1;\r\n\r\n    var cellTLX0 = GetCellTLX.call(this, colIdx),\r\n        cellTLX = cellTLX0;\r\n    var cellTLY = GetCellTLY.call(this, rowIdx);\r\n    this.visibleStartY = null;\r\n    this.visibleEndY = null;\r\n    this.visibleStartX = null;\r\n    this.visibleEndX = null;\r\n    this.lastVisibleCellIdx = null;\r\n    while ((cellTLY < bottomBound) && (cellIdx <= lastIdx)) {\r\n        if (this.table.isValidCellIdx(cellIdx)) {\r\n            if (this.visibleStartY === null) {\r\n                this.visibleStartY = rowIdx;\r\n                this.visibleEndY = rowIdx;\r\n            }\r\n            if (this.visibleStartX === null) {\r\n                this.visibleStartX = colIdx;\r\n                this.visibleEndX = colIdx;\r\n            }\r\n\r\n            if (this.lastVisibleCellIdx === null) {\r\n                this.lastVisibleCellIdx = cellIdx;\r\n            }\r\n\r\n            if (this.visibleEndY < rowIdx) {\r\n                this.visibleEndY = rowIdx;\r\n            }\r\n\r\n            if (this.visibleEndX < colIdx) {\r\n                this.visibleEndX = colIdx;\r\n            }\r\n\r\n            if (this.lastVisibleCellIdx < cellIdx) {\r\n                this.lastVisibleCellIdx = cellIdx;\r\n            }\r\n\r\n            var cell = table.getCell(cellIdx, true);\r\n            this.visibleCells.set(cell);\r\n            if (!this.preVisibleCells.contains(cell)) {\r\n                _ShowCell_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, cell);\r\n            }\r\n            if (this.scrollMode === 0) {\r\n                cell.setXY(cellTLX, cellTLY);\r\n            } else {\r\n                cell.setXY(cellTLY, cellTLX);\r\n            }\r\n        }\r\n\r\n        if ((cellTLX < rightBound) && (colIdx < lastColIdx)) {\r\n            cellTLX += table.getColWidth(colIdx);\r\n            colIdx += 1;\r\n        } else {\r\n            cellTLX = cellTLX0;\r\n            cellTLY += table.getRowHeight(rowIdx);\r\n\r\n            colIdx = this.visibleStartX;\r\n            rowIdx += 1;\r\n        }\r\n\r\n        cellIdx = table.colRowToCellIndex(colIdx, rowIdx);\r\n    }\r\n}\r\n\r\nvar GetCellTLX = function (colIdx) {\r\n    var ox = (this.scrollMode === 0) ? this.topLeftX : this.topLeftY;\r\n    var x = this.tableOX + this.table.colIndexToWidth(0, colIdx - 1) + ox;\r\n    return x;\r\n}\r\n\r\nvar GetCellTLY = function (rowIdx) {\r\n    var oy = (this.scrollMode === 0) ? this.topLeftY : this.topLeftX;\r\n    var y = this.tableOY + this.table.rowIndexToHeight(0, rowIdx - 1) + oy;\r\n    return y;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ShowCells);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCells.js?')},"./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/UpdateTable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _HideCells_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HideCells.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/HideCells.js");\n/* harmony import */ var _ShowCells_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ShowCells.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/ShowCells.js");\n/* harmony import */ var _MaskCells_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MaskCells.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/MaskCells.js");\n\r\n\r\n\r\n\r\nvar UpdateTable = function (refresh) {\r\n    if (refresh === undefined) {\r\n        refresh = false;\r\n    }\r\n    if (refresh) {\r\n        ClearVisibleCellIndexes.call(this);\r\n        _HideCells_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this);\r\n    }\r\n    ClearVisibleCellIndexes.call(this);\r\n    _ShowCells_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this);\r\n    _HideCells_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this);\r\n    _MaskCells_js__WEBPACK_IMPORTED_MODULE_2__["default"].call(this);\r\n    return this;\r\n}\r\n\r\nvar ClearVisibleCellIndexes = function () {\r\n    var tmp = this.preVisibleCells;\r\n    this.preVisibleCells = this.visibleCells;\r\n    this.visibleCells = tmp;\r\n    this.visibleCells.clear();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateTable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/gridtable/methods/updatetable/UpdateTable.js?')},"./lib/rexui/lib/plugins/gameobjects/inputtext/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InputText.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (config, addToScene) {\r\n    var width = GetAdvancedValue(config, \'width\', undefined);\r\n    var height = GetAdvancedValue(config, \'height\', undefined);\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n    var gameObject = new _InputText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, 0, 0, width, height, config);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/inputtext/Creator.js?')},"./lib/rexui/lib/plugins/gameobjects/inputtext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InputText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InputText.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, width, height, config) {\r\n    var gameObject = new _InputText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/inputtext/Factory.js?')},"./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_input_StopPropagationTouchEvents_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/input/StopPropagationTouchEvents.js */ \"./lib/rexui/lib/plugins/utils/input/StopPropagationTouchEvents.js\");\n\r\n\r\nconst DOMElement = Phaser.GameObjects.DOMElement;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass InputText extends DOMElement {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', undefined);\r\n            height = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        var autoRound = scene.scale.autoRound;\r\n        if (width !== undefined) {\r\n            if (autoRound) {\r\n                width = Math.floor(width);\r\n            }\r\n            config.width = width + 'px';\r\n        }\r\n        if (height !== undefined) {\r\n            if (autoRound) {\r\n                height = Math.floor(height);\r\n            }\r\n            config.height = height + 'px';\r\n        }\r\n\r\n        var element;\r\n        var textType = GetValue(config, 'type', 'text');\r\n        if (textType === 'textarea') {\r\n            element = document.createElement(\"textarea\");\r\n            element.style.resize = 'none';\r\n        } else {\r\n            element = document.createElement(\"input\");\r\n            element.type = textType;\r\n        }\r\n\r\n        // Apply registed style properties\r\n        var elemProp, elemPropValue;\r\n        for (var key in ElementProperties) {\r\n            elemProp = ElementProperties[key];\r\n            elemPropValue = GetValue(config, key, elemProp[1]);\r\n            if (elemPropValue !== undefined) {\r\n                element[elemProp[0]] = elemPropValue;\r\n            }\r\n        }\r\n\r\n        var style = GetValue(config, 'style', undefined);\r\n        if (style === undefined) {\r\n            style = {};\r\n        }\r\n        // Apply registed style properties\r\n        var styleProp, stylePropValue;\r\n        for (var key in StyleProperties) {\r\n            styleProp = StyleProperties[key];\r\n            stylePropValue = GetValue(config, key, styleProp[1]);\r\n            if (stylePropValue !== undefined) {\r\n                style[styleProp[0]] = stylePropValue;\r\n            }\r\n        }\r\n        // Apply other style properties\r\n        var elementStyle = element.style;\r\n        for (var key in config) {\r\n            if ((key in ElementProperties) || (key in StyleProperties)) {\r\n                continue;\r\n            } else if (key in elementStyle) {\r\n                style[key] = config[key];\r\n            }\r\n        }\r\n        style['box-sizing'] = 'border-box';\r\n        super(scene, x, y, element, style);\r\n        this.type = 'rexInputText';\r\n\r\n        // Apply events\r\n        for (let eventName in ElementEvents) { // Note: Don't use `var` here\r\n            this.node[ElementEvents[eventName]] = (function () {\r\n                this.emit(eventName, this);\r\n            }).bind(this);\r\n        }\r\n\r\n        // Don't propagate touch/mouse events to parent(game canvas)\r\n        Object(_utils_input_StopPropagationTouchEvents_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.node);\r\n    }\r\n\r\n    resize(width, height) {\r\n        var style = this.node.style;\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        this.updateSize();\r\n        return this;\r\n    }\r\n\r\n    get text() {\r\n        return this.node.value;\r\n    }\r\n\r\n    set text(value) {\r\n        this.node.value = value;\r\n    }\r\n\r\n    setText(value) { // Override\r\n        this.text = value;\r\n        return this;\r\n    }\r\n\r\n    selectText() {\r\n        this.node.select();\r\n        return this;\r\n    }\r\n\r\n    get placeholder() {\r\n        return this.node.placeholder;\r\n    }\r\n\r\n    set placeholder(value) {\r\n        this.node.placeholder = value;\r\n    }\r\n\r\n    setPlaceholder(value) {\r\n        this.placeholder = value;\r\n        return this;\r\n    }\r\n\r\n    get tooltip() {\r\n        return this.node.title;\r\n    }\r\n\r\n    set tooltip(value) {\r\n        this.node.title = value;\r\n    }\r\n\r\n    setTooltip(value) {\r\n        this.tooltip = value;\r\n        return this;\r\n    }\r\n\r\n    setTextChangedCallback(callback) {\r\n        this.onTextChanged = callback;\r\n        return this;\r\n    }\r\n\r\n    get readOnly() {\r\n        return this.node.readOnly;\r\n    }\r\n\r\n    set readOnly(value) {\r\n        this.node.readOnly = value;\r\n    }\r\n\r\n    setReadOnly(value) {\r\n        if (value === undefined) {\r\n            value = true;\r\n        }\r\n        this.readOnly = value;\r\n        return this;\r\n    }\r\n\r\n    get spellCheck() {\r\n        return this.node.spellcheck;\r\n    }\r\n\r\n    set spellCheck(value) {\r\n        this.node.spellcheck = value;\r\n    }\r\n\r\n    setSpellCheck(value) {\r\n        this.spellCheck = value;\r\n        return this;\r\n    }\r\n\r\n    setStyle(key, value) {\r\n        this.node.style[key] = value;\r\n        return this;\r\n    }\r\n\r\n    getStyle(key) {\r\n        return this.node.style[key];\r\n    }\r\n\r\n    scrollToBottom() {\r\n        this.node.scrollTop = this.node.scrollHeight;\r\n        return this;\r\n    }\r\n\r\n    setEnabled(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.node.disabled = !enabled;\r\n        return this;\r\n    }\r\n\r\n    setBlur() {\r\n        this.node.blur();\r\n        return this;\r\n    }\r\n\r\n    setFocus() {\r\n        this.node.focus();\r\n        return this;\r\n    }\r\n}\r\n\r\nconst ElementProperties = {\r\n    id: ['id', undefined],\r\n    text: ['value', undefined],\r\n    placeholder: ['placeholder', undefined],\r\n    tooltip: ['title', undefined],\r\n    readOnly: ['readonly', false],\r\n    spellCheck: ['spellcheck', false],\r\n    autoComplete: ['autocomplete', 'off'],\r\n};\r\n\r\nconst StyleProperties = {\r\n    align: ['textAlign', undefined],\r\n    width: ['width', undefined],\r\n    height: ['height', undefined],\r\n    fontFamily: ['fontFamily', undefined],\r\n    fontSize: ['font-size', undefined],\r\n    color: ['color', '#ffffff'],\r\n    backgroundColor: ['backgroundColor', 'transparent'],\r\n    borderColor: ['borderColor', 'transparent'],\r\n    outline: ['outline', 'none'],\r\n};\r\n\r\nconst ElementEvents = {\r\n    textchange: 'oninput',\r\n    click: 'onclick',\r\n    dblclick: 'ondblclick',\r\n    focus: 'onfocus',\r\n    blur: 'onblur',\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InputText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (config, addToScene) {\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/Creator.js?')},"./lib/rexui/lib/plugins/gameobjects/ninepatch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, width, height, key, baseFrame, columns, rows, config) {\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, key, baseFrame, columns, rows, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/Factory.js?')},"./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _texture_TextureMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./texture/TextureMethods.js */ \"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/TextureMethods.js\");\n/* harmony import */ var _utils_DefaultGetFrameNameCallback_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/DefaultGetFrameNameCallback.js */ \"./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js\");\n/* harmony import */ var _utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/object/IsArray.js */ \"./lib/rexui/lib/plugins/utils/object/IsArray.js\");\n\r\n\r\n\r\n\r\nconst RenderTexture = Phaser.GameObjects.RenderTexture;\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass NinePatch extends RenderTexture {\r\n    constructor(scene, x, y, width, height, key, baseFrame, columns, rows, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            width = GetValue(config, 'width', 1);\r\n            height = GetValue(config, 'height', 1);\r\n            key = GetValue(config, 'key', undefined);\r\n            baseFrame = GetValue(config, 'baseFrame', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (IsPlainObject(width)) {\r\n            config = width;\r\n            width = GetValue(config, 'width', 1);\r\n            height = GetValue(config, 'height', 1);\r\n            key = GetValue(config, 'key', undefined);\r\n            baseFrame = GetValue(config, 'baseFrame', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (IsPlainObject(key)) {\r\n            config = key;\r\n            key = GetValue(config, 'key', undefined);\r\n            baseFrame = GetValue(config, 'baseFrame', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (IsPlainObject(baseFrame)) {\r\n            config = baseFrame;\r\n            baseFrame = GetValue(config, 'baseFrame', undefined);\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        } else if (Object(_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(baseFrame)) {\r\n            config = rows;\r\n            rows = columns;\r\n            columns = baseFrame;\r\n            baseFrame = GetValue(config, 'baseFrame', undefined);\r\n        } else if (IsPlainObject(columns)) {\r\n            config = columns;\r\n            columns = GetValue(config, 'columns', undefined);\r\n            rows = GetValue(config, 'rows', undefined);\r\n        }\r\n\r\n        super(scene, x, y, width, height);\r\n        this.columns = {};\r\n        this.rows = {};\r\n        this.stretchMode = {};\r\n        this._tileSprite = undefined; // Reserved for drawing image\r\n        this._image = undefined; // Reserved for drawing image\r\n\r\n        this.setOrigin(0.5, 0.5);\r\n        this.setGetFrameNameCallback(GetValue(config, 'getFrameNameCallback', undefined));\r\n        this.setStretchMode(GetValue(config, 'stretchMode', 0));\r\n        this.setTexture(key, baseFrame, columns, rows); // Also update render texture\r\n    }\r\n\r\n    setGetFrameNameCallback(callback) {\r\n        if (callback === undefined) {\r\n            callback = _utils_DefaultGetFrameNameCallback_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\r\n        }\r\n        this.getFrameNameCallback = callback;\r\n        return this;\r\n    }\r\n\r\n    get minWidth() {\r\n        return this.columns.minWidth;\r\n    }\r\n\r\n    get minHeight() {\r\n        return this.rows.minHeight;\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        super.resize(width, height);\r\n        this.updateTexture();\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    NinePatch.prototype,\r\n    _texture_TextureMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (NinePatch);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/GetStretchMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_IsEdge_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/IsEdge.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/IsEdge.js");\n\r\n\r\nvar GetStretchMode = function(colIndex, rowIndex) {\r\n    return (_utils_IsEdge_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, colIndex, rowIndex)) ? this.stretchMode.edge : this.stretchMode.internal;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetStretchMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/GetStretchMode.js?')},"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetStretchMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar SetStretchMode = function(mode) {\r\n    if (IsPlainObject(mode)) {\r\n        this.stretchMode.edge = parseMode(GetValue(mode, 'edge', 0));\r\n        this.stretchMode.internal = parseMode(GetValue(mode, 'internal', 0));\r\n    } else {\r\n        mode = parseMode(mode);\r\n        this.stretchMode.edge = mode;\r\n        this.stretchMode.internal = mode;\r\n    }\r\n    return this;\r\n};\r\n\r\nvar parseMode = function (mode) {\r\n    if (typeof (mode) === 'string') {\r\n        mode = EXTENDMODE[mode];\r\n    }\r\n    return mode;\r\n}\r\n\r\nconst EXTENDMODE = {\r\n    scale: 0,\r\n    repeat: 1,\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetStretchMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetStretchMode.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetTexture.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/object/IsArray.js */ \"./lib/rexui/lib/plugins/utils/object/IsArray.js\");\n\r\n\r\nvar SetTexture = function (key, baseFrameName, columns, rows) {\r\n    if (Object(_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(baseFrameName)) {\r\n        rows = columns;\r\n        columns = baseFrameName;\r\n        baseFrameName = undefined;\r\n    }\r\n\r\n    if (baseFrameName === undefined) {\r\n        baseFrameName = '__BASE';\r\n    }\r\n\r\n    this.textureKey = key;\r\n    this.baseFrameName = baseFrameName;\r\n    this.columns.data = columns;\r\n    this.columns.count = (columns) ? columns.length : 0;\r\n    this.columns.stretch = 0;\r\n    this.columns.minWidth = 0;\r\n    this.rows.data = rows;\r\n    this.rows.count = (rows) ? rows.length : 0;\r\n    this.rows.stretch = 0;\r\n    this.rows.minHeight = 0;\r\n\r\n    var texture = this.scene.textures.get(key);\r\n    if (!texture) {\r\n        this.clear();\r\n        return this;\r\n    }\r\n    if (!columns || !rows) {\r\n        this.clear();\r\n        return this;\r\n    }\r\n\r\n    // Get remainder width/height for unknown width/height\r\n    var baseFrame = texture.frames[baseFrameName];\r\n    var remainderTextureWidth = baseFrame.width;\r\n    var unknownColumnWidthCount = 0;\r\n    for (var i = 0, cnt = columns.length; i < cnt; i++) {\r\n        if (columns[i] === undefined) {\r\n            unknownColumnWidthCount++;\r\n        } else if (typeof (columns[i]) === 'number') {\r\n            remainderTextureWidth -= columns[i];\r\n        } else {\r\n            remainderTextureWidth -= columns[i].width;\r\n        }\r\n    }\r\n    var unknownColumnWidth = remainderTextureWidth / unknownColumnWidthCount;\r\n\r\n    var remainderTextureHeight = baseFrame.height;\r\n    var unknownRowHeightCount = 0;\r\n    for (var i = 0, cnt = rows.length; i < cnt; i++) {\r\n        if (rows[i] === undefined) {\r\n            unknownRowHeightCount++;\r\n        } else if (typeof (rows[i]) === 'number') {\r\n            remainderTextureHeight -= rows[i];\r\n        } else {\r\n            remainderTextureHeight -= rows[i].width;\r\n        }\r\n    }\r\n    var unknownRowHeight = remainderTextureHeight / unknownRowHeightCount;\r\n\r\n    var row, col, rowHeight, colWidth, frameName;\r\n    var offsetX = 0, offsetY = 0;\r\n    for (var j = 0, jcnt = rows.length; j < jcnt; j++) {\r\n        // Unknown height\r\n        if (rows[j] === undefined) {\r\n            rows[j] = unknownRowHeight;\r\n        }\r\n\r\n        if (typeof (rows[j]) === 'number') {\r\n            rows[j] = {\r\n                height: rows[j],\r\n                stretch: (j % 2),\r\n            }\r\n        }\r\n\r\n        row = rows[j];\r\n        rowHeight = row.height;\r\n\r\n        this.rows.stretch += (row.stretch | 0);\r\n        this.rows.minHeight += (row.stretch > 0) ? 0 : rowHeight;\r\n\r\n        offsetX = 0;\r\n        for (var i = 0, icnt = columns.length; i < icnt; i++) {\r\n            // Unknown width\r\n            if (columns[i] === undefined) {\r\n                columns[i] = unknownColumnWidth;\r\n            }\r\n\r\n            if (typeof (columns[i]) === 'number') {\r\n                columns[i] = {\r\n                    width: columns[i],\r\n                    stretch: (i % 2),\r\n                }\r\n            }\r\n\r\n            col = columns[i];\r\n            colWidth = col.width;\r\n\r\n            if (j === 0) {\r\n                this.columns.stretch += (col.stretch | 0);\r\n                this.columns.minWidth += (col.stretch > 0) ? 0 : colWidth;\r\n            }\r\n\r\n            if ((colWidth >= 1) && (rowHeight >= 1)) {\r\n                frameName = this.getFrameNameCallback(i, j, baseFrameName);\r\n                if (frameName) {\r\n                    texture.add(\r\n                        frameName, 0,\r\n                        (offsetX + baseFrame.cutX), (offsetY + baseFrame.cutY),\r\n                        colWidth, rowHeight\r\n                    );\r\n                    // Do nothing if frameName is existed\r\n                }\r\n            } else {\r\n                console.warn(`Size of Grid(${i},${j}) = ${colWidth}x${rowHeight}, which is invalid`);\r\n            }\r\n            offsetX += colWidth;\r\n        }\r\n        offsetY += rowHeight;\r\n    }\r\n\r\n    this.updateTexture();\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetTexture);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetTexture.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/TextureMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetTexture_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetTexture.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetTexture.js");\n/* harmony import */ var _UpdateTexture_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UpdateTexture.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/UpdateTexture.js");\n/* harmony import */ var _SetStretchMode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SetStretchMode.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/SetStretchMode.js");\n/* harmony import */ var _GetStretchMode_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetStretchMode.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/GetStretchMode.js");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setTexture: _SetTexture_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    updateTexture: _UpdateTexture_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    setStretchMode: _SetStretchMode_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getStretchMode: _GetStretchMode_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/TextureMethods.js?')},"./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/UpdateTexture.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_renderTexture_MakeChildImageGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/renderTexture/MakeChildImageGameObject.js */ \"./lib/rexui/lib/plugins/utils/renderTexture/MakeChildImageGameObject.js\");\n\r\n\r\nvar UpdateTexture = function () {\r\n    this.clear();\r\n\r\n    if (this.textureKey === undefined) {\r\n        return this;\r\n    }\r\n    var texture = this.scene.textures.get(this.textureKey);\r\n    if (!texture) {\r\n        return this;\r\n    }\r\n\r\n    var stretchWidth = this.width - this.columns.minWidth;\r\n    var proportionWidth, fixedPartScaleX;\r\n    if (stretchWidth >= 0) {\r\n        proportionWidth = (this.columns.stretch > 0) ? (stretchWidth / this.columns.stretch) : 0;\r\n        fixedPartScaleX = 1;\r\n    } else {\r\n        proportionWidth = 0;\r\n        fixedPartScaleX = (this.width / this.columns.minWidth);\r\n    }\r\n\r\n    var stretchHeight = this.height - this.rows.minHeight;\r\n    var proportionHeight, fixedPartScaleY;\r\n    if (stretchHeight >= 0) {\r\n        proportionHeight = (this.rows.stretch > 0) ? (stretchHeight / this.rows.stretch) : 0;\r\n        fixedPartScaleY = 1;\r\n    } else {\r\n        proportionHeight = 0;\r\n        fixedPartScaleY = (this.height / this.rows.minHeight);\r\n    }\r\n\r\n    var frameName, col, row, colWidth, rowHeight;\r\n    var offsetX = 0, offsetY = 0;\r\n    var gameObject, imageType;\r\n    for (var j = 0, jcnt = this.rows.count; j < jcnt; j++) {\r\n        row = this.rows.data[j];\r\n        rowHeight = (row.stretch === 0) ? (row.height * fixedPartScaleY) : (proportionHeight * row.stretch);\r\n\r\n        offsetX = 0;\r\n        for (var i = 0, icnt = this.columns.count; i < icnt; i++) {\r\n            col = this.columns.data[i];\r\n            colWidth = (col.stretch === 0) ? (col.width * fixedPartScaleX) : (proportionWidth * col.stretch);\r\n\r\n            frameName = this.getFrameNameCallback(i, j, this.baseFrameName);\r\n            if (frameName && (colWidth > 0) && (rowHeight > 0) && texture.has(frameName)) {\r\n                if ((row.stretch === 0) && (col.stretch === 0)) { // Fixed parts\r\n                    imageType = 0; // Draw image\r\n                } else { // Stretchable parts\r\n                    if (this.getStretchMode(i, j) === 0) { // Scaled image\r\n                        imageType = 0; // Draw scaled image\r\n                    } else { // Repeat tile-sprite\r\n                        imageType = 1; // Draw tile-sprite\r\n                    }\r\n                }\r\n\r\n                if (imageType === 0) {\r\n                    gameObject = Object(_utils_renderTexture_MakeChildImageGameObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, '_image', 'image');\r\n                    gameObject\r\n                        .setTexture(this.textureKey, frameName)\r\n                        .setDisplaySize(colWidth, rowHeight);\r\n                } else {\r\n                    gameObject = Object(_utils_renderTexture_MakeChildImageGameObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, '_tileSprite', 'tileSprite');\r\n                    gameObject\r\n                        .setTexture(this.textureKey, frameName)\r\n                        .setSize(colWidth, rowHeight);\r\n                }\r\n            }\r\n\r\n            if (gameObject) {\r\n                this.draw(gameObject, offsetX, offsetY);\r\n                gameObject = undefined;\r\n            }\r\n            offsetX += colWidth;\r\n        }\r\n\r\n        offsetY += rowHeight;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (UpdateTexture);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/texture/UpdateTexture.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst DefaultBaseFrameName = '__BASE';\r\n\r\nvar GetFrameNameCallback = function (colIndex, rowIndex, baseFrameName) {\r\n    if (baseFrameName === DefaultBaseFrameName) {\r\n        return `${colIndex},${rowIndex}`;\r\n    } else {\r\n        return `${baseFrameName}_${colIndex},${rowIndex}`;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetFrameNameCallback);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/DefaultGetFrameNameCallback.js?")},"./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/IsEdge.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar IsEdge = function (colIndex, rowIndex) {\r\n    return (colIndex === 0) || (colIndex === (this.columns.count - 1)) ||\r\n        (rowIndex === 0) || (rowIndex === (this.rows.count - 1));\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsEdge);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/ninepatch/utils/IsEdge.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _geom_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./geom/RoundRectangle.js */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js");\n/* harmony import */ var _utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/LineTo.js */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/LineTo.js");\n/* harmony import */ var _utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/ArcTo.js */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/ArcTo.js");\n/* harmony import */ var _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/geom/polygon/Earcut.js */ "./lib/rexui/lib/plugins/utils/geom/polygon/Earcut.js");\n/* harmony import */ var _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./render/Render.js */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/Render.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass RoundRectangle extends Phaser.GameObjects.Shape {\r\n    constructor(scene, x, y, width, height, radiusConfig, fillColor, fillAlpha) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        var iteration = GetValue(radiusConfig, \'iteration\', undefined);\r\n        radiusConfig = GetValue(radiusConfig, \'radius\', radiusConfig);\r\n        var geom = new _geom_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"](0, 0, width, height, radiusConfig);\r\n        super(scene, \'RoundRectangle\', geom);\r\n\r\n        this.setIteration(iteration);\r\n        this.setPosition(x, y);\r\n        // this.setSize(this.geom.width, this.geom.height);\r\n\r\n        if (fillColor !== undefined) {\r\n            this.setFillStyle(fillColor, fillAlpha);\r\n        }\r\n\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    updateData() {\r\n        var geom = this.geom;\r\n        var pathData = this.pathData;\r\n\r\n        pathData.length = 0;\r\n\r\n        var cornerRadius = geom.cornerRadius,\r\n            radius,\r\n            iteration = this.iteration + 1;\r\n        // bottom-right\r\n        radius = cornerRadius.br;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = geom.width - radius.x;\r\n            var centerY = geom.height - radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius.x, radius.y, 0, 90, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(geom.width, geom.height, pathData);\r\n        }\r\n\r\n        // bottom-left\r\n        radius = cornerRadius.bl;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = radius.x;\r\n            var centerY = geom.height - radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius.x, radius.y, 90, 180, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(0, geom.height, pathData);\r\n        }\r\n\r\n        // top-left\r\n        radius = cornerRadius.tl;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = radius.x;\r\n            var centerY = radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius.x, radius.y, 180, 270, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(0, 0, pathData);\r\n        }\r\n\r\n        // top-right\r\n        radius = cornerRadius.tr;\r\n        if (isArcCorner(radius)) {\r\n            var centerX = geom.width - radius.x;\r\n            var centerY = radius.y;\r\n            Object(_utils_ArcTo_js__WEBPACK_IMPORTED_MODULE_2__["default"])(centerX, centerY, radius.x, radius.y, 270, 360, false, iteration, pathData);\r\n        } else {\r\n            Object(_utils_LineTo_js__WEBPACK_IMPORTED_MODULE_1__["default"])(geom.width, 0, pathData);\r\n        }\r\n\r\n        pathData.push(pathData[0], pathData[1]); // Repeat first point to close curve\r\n        this.pathIndexes = _utils_geom_polygon_Earcut_js__WEBPACK_IMPORTED_MODULE_3___default()(pathData);\r\n        return this;\r\n    }\r\n\r\n    get width() {\r\n        return this.geom.width;\r\n    }\r\n    set width(value) {\r\n        this.resize(value, this.height);\r\n    }\r\n\r\n    get height() {\r\n        return this.geom.height;\r\n    }\r\n    set height(value) {\r\n        this.resize(this.width, value);\r\n    }\r\n\r\n    resize(width, height) {\r\n        if (height === undefined) {\r\n            height = width;\r\n        }\r\n        if ((this.geom.width === width) && (this.geom.height === height)) {\r\n            return this;\r\n        }\r\n        this.geom.height = height;\r\n        this.geom.width = width\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n\r\n        var input = this.input;\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = width;\r\n            input.hitArea.height = height;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get iteration() {\r\n        return this._iteration;\r\n    }\r\n\r\n    set iteration(value) {\r\n        // Set iteration first time\r\n        if (this._iteration === undefined) {\r\n            this._iteration = value;\r\n            return;\r\n        }\r\n\r\n        // Change iteration value\r\n        if (this._iteration === value) {\r\n            return;\r\n        }\r\n\r\n        this._iteration = value;\r\n        this.updateData();\r\n    }\r\n\r\n    setIteration(iteration) {\r\n        if (iteration === undefined) {\r\n            iteration = 6;\r\n        }\r\n        this.iteration = iteration;\r\n        return this;\r\n    }\r\n\r\n    get radius() {\r\n        return this.geom.radius;\r\n    }\r\n\r\n    set radius(value) {\r\n        this.geom.setRadius(value);\r\n        this.updateDisplayOrigin();\r\n        this.updateData();\r\n    }\r\n\r\n    setRadius(value) {\r\n        if (value === undefined) {\r\n            value = 0;\r\n        }\r\n        this.radius = value;\r\n        return this;\r\n    }\r\n\r\n    get cornerRadius() {\r\n        return this.geom.cornerRadius;\r\n    }\r\n\r\n    set cornerRadius(value) {\r\n        this.radius = value;\r\n    }\r\n\r\n    setCornerRadius(value) {\r\n        return this.setRadius(value);\r\n    }\r\n}\r\n\r\nvar isArcCorner = function (radius) {\r\n    return ((radius.x !== 0) && (radius.y !== 0));\r\n}\r\n\r\n\r\nObject.assign(\r\n    RoundRectangle.prototype,\r\n    _render_Render_js__WEBPACK_IMPORTED_MODULE_4__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RoundRectangle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass RoundRectangle {\r\n    constructor(x, y, width, height, radiusConfig) {\r\n        this.cornerRadius = {};\r\n        this._width = 0;\r\n        this._height = 0;\r\n        this.setTo(x, y, width, height, radiusConfig);\r\n    }\r\n\r\n    setTo(x, y, width, height, radiusConfig) {\r\n        this.setPosition(x, y);\r\n        this.setRadius(radiusConfig);\r\n        this.setSize(width, height);\r\n        return this;\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n        this.x = x;\r\n        this.y = y;\r\n        return this;\r\n    }\r\n\r\n    setRadius(config) {\r\n        if (config === undefined) {\r\n            config = 0;\r\n        }\r\n        var defaultRadiusX, defaultRadiusY;\r\n        if (typeof (config) === 'number') {\r\n            defaultRadiusX = config;\r\n            defaultRadiusY = config;\r\n        } else {\r\n            defaultRadiusX = GetValue(config, 'x', 0);\r\n            defaultRadiusY = GetValue(config, 'y', 0);\r\n        }\r\n\r\n        var radius = this.cornerRadius;\r\n        radius.tl = GetRadius(GetValue(config, 'tl', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.tr = GetRadius(GetValue(config, 'tr', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.bl = GetRadius(GetValue(config, 'bl', undefined), defaultRadiusX, defaultRadiusY);\r\n        radius.br = GetRadius(GetValue(config, 'br', undefined), defaultRadiusX, defaultRadiusY);\r\n        return this;\r\n    }\r\n\r\n    setSize(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        return this;\r\n    }\r\n\r\n    get minWidth() {\r\n        var radius = this.cornerRadius;\r\n        return Math.max(radius.tl.x + radius.tr.x, radius.bl.x + radius.br.x);\r\n    }\r\n\r\n    get minHeight() {\r\n        var radius = this.cornerRadius;\r\n        return Math.max(radius.tl.y + radius.bl.y, radius.tr.y + radius.br.y);\r\n    }\r\n\r\n    get width() {\r\n        return this._width;\r\n    }\r\n\r\n    set width(value) {\r\n        if (value == null) {\r\n            value = 0;\r\n        }\r\n        this._width = Math.max(value, this.minWidth);\r\n    }\r\n\r\n    get height() {\r\n        return this._height;\r\n    }\r\n\r\n    set height(value) {\r\n        if (value == null) {\r\n            value = 0;\r\n        }\r\n        this._height = Math.max(value, this.minHeight);\r\n    }\r\n\r\n    get radius() {\r\n        var radius = this.cornerRadius;\r\n        var max = Math.max(\r\n            radius.tl.x,\r\n            radius.tl.y,\r\n            radius.tr.x,\r\n            radius.tr.y,\r\n            radius.bl.x,\r\n            radius.bl.y,\r\n            radius.br.x,\r\n            radius.br.y\r\n        );\r\n        return max;\r\n    }\r\n}\r\n\r\nvar GetRadius = function (radius, defaultRadiusX, defaultRadiusY) {\r\n    if (radius === undefined) {\r\n        return {\r\n            x: defaultRadiusX,\r\n            y: defaultRadiusY\r\n        };\r\n    } else if (typeof (radius) === 'number') {\r\n        return {\r\n            x: radius,\r\n            y: radius\r\n        };\r\n    } else {\r\n        return radius;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (RoundRectangle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/geom/RoundRectangle.js?")},"./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js":function(module,exports,__webpack_require__){eval('/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar FillStyleCanvas = __webpack_require__(/*! ../../utils/FillStyleCanvas */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/FillStyleCanvas.js");\r\nvar LineStyleCanvas = __webpack_require__(/*! ../../utils/LineStyleCanvas */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/LineStyleCanvas.js");\r\nvar SetTransform = Phaser.Renderer.Canvas.SetTransform;\r\n\r\n/**\r\n * Renders this Game Object with the Canvas Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Polygon#renderCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.Canvas.CanvasRenderer} renderer - A reference to the current active Canvas renderer.\r\n * @param {Phaser.GameObjects.Polygon} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar PolygonCanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    var ctx = renderer.currentContext;\r\n\r\n    if (SetTransform(renderer, ctx, src, camera, parentMatrix)) {\r\n        var dx = src._displayOriginX;\r\n        var dy = src._displayOriginY;\r\n\r\n        var path = src.pathData;\r\n        var pathLength = path.length - 1;\r\n\r\n        var px1 = path[0] - dx;\r\n        var py1 = path[1] - dy;\r\n\r\n        ctx.beginPath();\r\n\r\n        ctx.moveTo(px1, py1);\r\n\r\n        if (!src.closePath) {\r\n            pathLength -= 2;\r\n        }\r\n\r\n        for (var i = 2; i < pathLength; i += 2) {\r\n            var px2 = path[i] - dx;\r\n            var py2 = path[i + 1] - dy;\r\n\r\n            ctx.lineTo(px2, py2);\r\n        }\r\n\r\n        ctx.closePath();\r\n\r\n        if (src.isFilled) {\r\n            FillStyleCanvas(ctx, src);\r\n\r\n            ctx.fill();\r\n        }\r\n\r\n        if (src.isStroked) {\r\n            LineStyleCanvas(ctx, src);\r\n\r\n            ctx.stroke();\r\n        }\r\n\r\n        //  Restore the context saved in SetTransform\r\n        ctx.restore();\r\n    }\r\n};\r\n\r\nmodule.exports = PolygonCanvasRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js");\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/CanvasRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/object/NOOP.js */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default.a;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/Render.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js":function(module,exports,__webpack_require__){eval('/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar FillPathWebGL = __webpack_require__(/*! ../../utils/FillPathWebGL */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/FillPathWebGL.js");\r\nvar StrokePathWebGL = __webpack_require__(/*! ../../utils/StrokePathWebGL */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/StrokePathWebGL.js");\r\n\r\n/**\r\n * Renders this Game Object with the WebGL Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Polygon#renderWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLRenderer} renderer - A reference to the current active WebGL renderer.\r\n * @param {Phaser.GameObjects.Polygon} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar PolygonWebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix)\r\n{\r\n    var pipeline = this.pipeline;\r\n\r\n    var camMatrix = pipeline._tempMatrix1;\r\n    var shapeMatrix = pipeline._tempMatrix2;\r\n    var calcMatrix = pipeline._tempMatrix3;\r\n\r\n    renderer.setPipeline(pipeline);\r\n\r\n    shapeMatrix.applyITRS(src.x, src.y, src.rotation, src.scaleX, src.scaleY);\r\n\r\n    camMatrix.copyFrom(camera.matrix);\r\n\r\n    if (parentMatrix)\r\n    {\r\n        //  Multiply the camera by the parent matrix\r\n        camMatrix.multiplyWithOffset(parentMatrix, -camera.scrollX * src.scrollFactorX, -camera.scrollY * src.scrollFactorY);\r\n\r\n        //  Undo the camera scroll\r\n        shapeMatrix.e = src.x;\r\n        shapeMatrix.f = src.y;\r\n    }\r\n    else\r\n    {\r\n        shapeMatrix.e -= camera.scrollX * src.scrollFactorX;\r\n        shapeMatrix.f -= camera.scrollY * src.scrollFactorY;\r\n    }\r\n\r\n    camMatrix.multiply(shapeMatrix, calcMatrix);\r\n\r\n    var dx = src._displayOriginX;\r\n    var dy = src._displayOriginY;\r\n\r\n    var alpha = camera.alpha * src.alpha;\r\n\r\n    if (src.isFilled)\r\n    {\r\n        FillPathWebGL(pipeline, calcMatrix, src, alpha, dx, dy);\r\n    }\r\n\r\n    if (src.isStroked)\r\n    {\r\n        StrokePathWebGL(pipeline, src, alpha, dx, dy);\r\n    }\r\n};\r\n\r\nmodule.exports = PolygonWebGLRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/render/WebGLRenderer.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/utils/ArcTo.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _LineTo_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LineTo.js */ "./lib/rexui/lib/plugins/gameobjects/shape/utils/LineTo.js");\n/* harmony import */ var _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/math/DegToRad.js */ "./lib/rexui/lib/plugins/utils/math/DegToRad.js");\n/* harmony import */ var _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\n\r\nvar ArcTo = function (centerX, centerY, radiusX, radiusY, startAngle, endAngle, antiClockWise, iteration, out) {\r\n    // startAngle, endAngle: 0 ~ 360\r\n    if (antiClockWise) {\r\n        endAngle += 360;\r\n    }\r\n\r\n    startAngle = _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default()(startAngle);\r\n    endAngle = _utils_math_DegToRad_js__WEBPACK_IMPORTED_MODULE_1___default()(endAngle);\r\n    var x, y, angle;\r\n    var step = (endAngle - startAngle) / iteration;\r\n    for (var i = 0; i <= iteration; i++) {\r\n        angle = startAngle + (step * i);\r\n        x = centerX + (radiusX * Math.cos(angle));\r\n        y = centerY + (radiusY * Math.sin(angle));\r\n        Object(_LineTo_js__WEBPACK_IMPORTED_MODULE_0__["default"])(x, y, out);\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (ArcTo);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/ArcTo.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/utils/FillPathWebGL.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders a filled path for the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#FillPathWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLPipeline} pipeline - The WebGL Pipeline used to render this Shape.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} calcMatrix - The transform matrix used to get the position values.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object shape being rendered in this call.\r\n * @param {number} alpha - The base alpha value.\r\n * @param {number} dx - The source displayOriginX.\r\n * @param {number} dy - The source displayOriginY.\r\n */\r\nvar FillPathWebGL = function (pipeline, calcMatrix, src, alpha, dx, dy)\r\n{\r\n    var fillTintColor = Utils.getTintAppendFloatAlphaAndSwap(src.fillColor, src.fillAlpha * alpha);\r\n\r\n    var path = src.pathData;\r\n    var pathIndexes = src.pathIndexes;\r\n\r\n    for (var i = 0; i < pathIndexes.length; i += 3)\r\n    {\r\n        var p0 = pathIndexes[i] * 2;\r\n        var p1 = pathIndexes[i + 1] * 2;\r\n        var p2 = pathIndexes[i + 2] * 2;\r\n\r\n        var x0 = path[p0 + 0] - dx;\r\n        var y0 = path[p0 + 1] - dy;\r\n        var x1 = path[p1 + 0] - dx;\r\n        var y1 = path[p1 + 1] - dy;\r\n        var x2 = path[p2 + 0] - dx;\r\n        var y2 = path[p2 + 1] - dy;\r\n\r\n        var tx0 = calcMatrix.getX(x0, y0);\r\n        var ty0 = calcMatrix.getY(x0, y0);\r\n\r\n        var tx1 = calcMatrix.getX(x1, y1);\r\n        var ty1 = calcMatrix.getY(x1, y1);\r\n\r\n        var tx2 = calcMatrix.getX(x2, y2);\r\n        var ty2 = calcMatrix.getY(x2, y2);\r\n    \r\n        pipeline.setTexture2D();\r\n\r\n        pipeline.batchTri(tx0, ty0, tx1, ty1, tx2, ty2, 0, 0, 1, 1, fillTintColor, fillTintColor, fillTintColor, pipeline.tintEffect);\r\n    }\r\n};\r\n\r\nmodule.exports = FillPathWebGL;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/FillPathWebGL.js?")},"./lib/rexui/lib/plugins/gameobjects/shape/utils/FillStyleCanvas.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * Sets the fillStyle on the target context based on the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#FillStyleCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {CanvasRenderingContext2D} ctx - The context to set the fill style on.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object to set the fill style from.\r\n * @param {number} [altColor] - An alternative color to render with.\r\n * @param {number} [altAlpha] - An alternative alpha to render with.\r\n */\r\nvar FillStyleCanvas = function (ctx, src, altColor, altAlpha)\r\n{\r\n    var fillColor = (altColor) ? altColor : src.fillColor;\r\n    var fillAlpha = (altAlpha) ? altAlpha : src.fillAlpha;\r\n\r\n    var red = ((fillColor & 0xFF0000) >>> 16);\r\n    var green = ((fillColor & 0xFF00) >>> 8);\r\n    var blue = (fillColor & 0xFF);\r\n\r\n    ctx.fillStyle = 'rgba(' + red + ',' + green + ',' + blue + ',' + fillAlpha + ')';\r\n};\r\n\r\nmodule.exports = FillStyleCanvas;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/FillStyleCanvas.js?")},"./lib/rexui/lib/plugins/gameobjects/shape/utils/LineStyleCanvas.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * Sets the strokeStyle and lineWidth on the target context based on the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#LineStyleCanvas\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {CanvasRenderingContext2D} ctx - The context to set the stroke style on.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object to set the stroke style from.\r\n * @param {number} [altColor] - An alternative color to render with.\r\n * @param {number} [altAlpha] - An alternative alpha to render with.\r\n */\r\nvar LineStyleCanvas = function (ctx, src, altColor, altAlpha)\r\n{\r\n    var strokeColor = (altColor) ? altColor : src.strokeColor;\r\n    var strokeAlpha = (altAlpha) ? altAlpha : src.strokeAlpha;\r\n\r\n    var red = ((strokeColor & 0xFF0000) >>> 16);\r\n    var green = ((strokeColor & 0xFF00) >>> 8);\r\n    var blue = (strokeColor & 0xFF);\r\n\r\n    ctx.strokeStyle = 'rgba(' + red + ',' + green + ',' + blue + ',' + strokeAlpha + ')';\r\n    ctx.lineWidth = src.lineWidth;\r\n};\r\n\r\nmodule.exports = LineStyleCanvas;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/LineStyleCanvas.js?")},"./lib/rexui/lib/plugins/gameobjects/shape/utils/LineTo.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LineTo = function (x, y, out) {\r\n    var cnt = out.length;\r\n    if (cnt >= 2) {\r\n        var lastX = out[cnt - 2];\r\n        var lastY = out[cnt - 1];\r\n        if ((x === lastX) && (y === lastY)) {\r\n            return out;\r\n        }\r\n    }\r\n\r\n    out.push(x, y);\r\n    return out;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LineTo);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/LineTo.js?')},"./lib/rexui/lib/plugins/gameobjects/shape/utils/StrokePathWebGL.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders a stroke outline around the given Shape.\r\n *\r\n * @method Phaser.GameObjects.Shape#StrokePathWebGL\r\n * @since 3.13.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLPipeline} pipeline - The WebGL Pipeline used to render this Shape.\r\n * @param {Phaser.GameObjects.Shape} src - The Game Object shape being rendered in this call.\r\n * @param {number} alpha - The base alpha value.\r\n * @param {number} dx - The source displayOriginX.\r\n * @param {number} dy - The source displayOriginY.\r\n */\r\nvar StrokePathWebGL = function (pipeline, src, alpha, dx, dy)\r\n{\r\n    var strokeTint = pipeline.strokeTint;\r\n    var strokeTintColor = Utils.getTintAppendFloatAlphaAndSwap(src.strokeColor, src.strokeAlpha * alpha);\r\n\r\n    strokeTint.TL = strokeTintColor;\r\n    strokeTint.TR = strokeTintColor;\r\n    strokeTint.BL = strokeTintColor;\r\n    strokeTint.BR = strokeTintColor;\r\n\r\n    var path = src.pathData;\r\n    var pathLength = path.length - 1;\r\n    var lineWidth = src.lineWidth;\r\n    var halfLineWidth = lineWidth / 2;\r\n\r\n    var px1 = path[0] - dx;\r\n    var py1 = path[1] - dy;\r\n\r\n    if (!src.closePath)\r\n    {\r\n        pathLength -= 2;\r\n    }\r\n\r\n    for (var i = 2; i < pathLength; i += 2)\r\n    {\r\n        var px2 = path[i] - dx;\r\n        var py2 = path[i + 1] - dy;\r\n\r\n        pipeline.setTexture2D();\r\n\r\n        pipeline.batchLine(\r\n            px1,\r\n            py1,\r\n            px2,\r\n            py2,\r\n            halfLineWidth,\r\n            halfLineWidth,\r\n            lineWidth,\r\n            i - 2,\r\n            (src.closePath) ? (i === pathLength - 1) : false\r\n        );\r\n\r\n        px1 = px2;\r\n        py1 = py2;\r\n    }\r\n};\r\n\r\nmodule.exports = StrokePathWebGL;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/shape/utils/StrokePathWebGL.js?")},"./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_Text__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/Text */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/Text.js");\n/* harmony import */ var _Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Parser */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Parser.js");\n\r\n\r\n\r\nclass BBCodeText extends _textbase_Text__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, text, style) {\r\n        super(scene, x, y, text, style, \'rexBBCodeText\', _Parser__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BBCodeText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js?')},"./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Creator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ \"./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js\");\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst BuildGameObject = Phaser.GameObjects.BuildGameObject;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (function (config, addToScene) {\r\n    // style Object = {\r\n    //     font: [ 'font', '16px Courier' ],\r\n    //     backgroundColor: [ 'backgroundColor', null ],\r\n    //     fill: [ 'fill', '#fff' ],\r\n    //     stroke: [ 'stroke', '#fff' ],\r\n    //     strokeThickness: [ 'strokeThickness', 0 ],\r\n    //     shadowOffsetX: [ 'shadow.offsetX', 0 ],\r\n    //     shadowOffsetY: [ 'shadow.offsetY', 0 ],\r\n    //     shadowColor: [ 'shadow.color', '#000' ],\r\n    //     shadowBlur: [ 'shadow.blur', 0 ],\r\n    //     shadowStroke: [ 'shadow.stroke', false ],\r\n    //     shadowFill: [ 'shadow.fill', false ],\r\n    //     align: [ 'align', 'left' ],\r\n    //     maxLines: [ 'maxLines', 0 ],\r\n    //     fixedWidth: [ 'fixedWidth', false ],\r\n    //     fixedHeight: [ 'fixedHeight', false ]\r\n    // }\r\n\r\n    var content = GetAdvancedValue(config, 'text', '');\r\n    var style = GetAdvancedValue(config, 'style', null);\r\n\r\n    //  Padding\r\n    //      { padding: 2 }\r\n    //      { padding: { x: , y: }}\r\n    //      { padding: { left: , top: }}\r\n    //      { padding: { left: , right: , top: , bottom: }}  \r\n\r\n    var padding = GetAdvancedValue(config, 'padding', null);\r\n\r\n    if (padding !== null) {\r\n        style.padding = padding;\r\n    }\r\n\r\n    if (addToScene !== undefined) {\r\n        config.add = addToScene;\r\n    }\r\n\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.scene, 0, 0, content, style);\r\n    BuildGameObject(this.scene, gameObject, config);\r\n\r\n    //  Text specific config options:\r\n\r\n    gameObject.autoRound = GetAdvancedValue(config, 'autoRound', true);\r\n    gameObject.resolution = GetAdvancedValue(config, 'resolution', 1);\r\n\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Creator.js?")},"./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (x, y, text, style) {\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});;\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Factory.js?')},"./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Parser.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_textstyle_TextStyle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/textstyle/TextStyle */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n\r\n\r\nvar GETPROP_RESULT = {\r\n    plainText: null,\r\n    prevProp: null\r\n};\r\n\r\nvar STYLE_RESULT = new _textbase_textstyle_TextStyle__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\nvar EMPTYPROP = {};\r\n\r\nvar parser = {\r\n    splitText: function (text, mode) {\r\n        var result = [];\r\n        var arr, m, charIdx = 0,\r\n            totalLen = text.length,\r\n            matchStart = totalLen;\r\n\r\n        while (true) {\r\n            arr = RE_SPLITTEXT.exec(text);\r\n            if (!arr) {\r\n                break;\r\n            }\r\n\r\n            m = arr[0];\r\n            matchStart = RE_SPLITTEXT.lastIndex - m.length;\r\n\r\n            if (charIdx < matchStart) {\r\n                result.push(text.substring(charIdx, matchStart));\r\n            }\r\n\r\n            if (mode === undefined) {\r\n                result.push(m);\r\n            }\r\n\r\n            charIdx = RE_SPLITTEXT.lastIndex;\r\n        }\r\n\r\n        if (charIdx < totalLen) {\r\n            result.push(text.substring(charIdx, totalLen));\r\n        }\r\n        return result; // [text,...]\r\n    },\r\n\r\n    tagTextToProp: function (text, prevProp) {\r\n        var plainText, innerMatch;\r\n\r\n        if (prevProp == null) {\r\n            prevProp = {};\r\n        }\r\n\r\n        // close image tag\r\n        if (prevProp.img) {\r\n            updateProp(prevProp, PROP_REMOVE, 'img');\r\n        }\r\n        // Check if current fragment is a class tag\r\n        if (RE_BLOD_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'b', true);\r\n            plainText = '';\r\n        } else if (RE_BLOD_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'b');\r\n            plainText = '';\r\n        } else if (RE_ITALICS_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'i', true);\r\n            plainText = '';\r\n        } else if (RE_ITALICS_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'i');\r\n            plainText = '';\r\n        } else if (RE_SIZE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_SIZE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'size', innerMatch[1] + 'px');\r\n            plainText = '';\r\n        } else if (RE_SIZE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'size');\r\n            plainText = '';\r\n        } else if (RE_COLOR_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_COLOR_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'color', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_COLOR_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'color');\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_UNDERLINE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'u', true);\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_OPENC.test(text)) {\r\n            innerMatch = text.match(RE_UNDERLINE_OPENC);\r\n            updateProp(prevProp, PROP_ADD, 'u', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_UNDERLINE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'u');\r\n            plainText = '';\r\n        } else if (RE_SHADOW_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'shadow', true);\r\n            plainText = '';\r\n        } else if (RE_SHADOW_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'shadow');\r\n            plainText = '';\r\n        } else if (RE_STROKE_OPEN.test(text)) {\r\n            updateProp(prevProp, PROP_ADD, 'stroke', true);\r\n            plainText = '';\r\n        } else if (RE_STROKE_OPENC.test(text)) {\r\n            innerMatch = text.match(RE_STROKE_OPENC);\r\n            updateProp(prevProp, PROP_ADD, 'stroke', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_STROKE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'stroke');\r\n            plainText = '';\r\n        } else if (RE_IMAGE_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_IMAGE_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'img', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_IMAGE_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'img');\r\n            plainText = '';\r\n        } else if (RE_AREA_OPEN.test(text)) {\r\n            innerMatch = text.match(RE_AREA_OPEN);\r\n            updateProp(prevProp, PROP_ADD, 'area', innerMatch[1]);\r\n            plainText = '';\r\n        } else if (RE_AREA_CLOSE.test(text)) {\r\n            updateProp(prevProp, PROP_REMOVE, 'area');\r\n            plainText = '';            \r\n        } else {\r\n            plainText = text\r\n        }\r\n\r\n        var result = GETPROP_RESULT;\r\n        result.plainText = plainText;\r\n        result.prop = prevProp;\r\n        return result;\r\n    },\r\n\r\n    propToContextStyle: function (defaultStyle, prop) {\r\n        var result = STYLE_RESULT;\r\n        if (!prop.hasOwnProperty('img')) {\r\n            result.image = null;\r\n\r\n            if (prop.hasOwnProperty('family')) {\r\n                result.fontFamily = prop.family;\r\n            } else {\r\n                result.fontFamily = defaultStyle.fontFamily;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('size')) {\r\n                var size = prop.size;\r\n                if (typeof (size) === 'number') {\r\n                    size = size.toString() + 'px';\r\n                }\r\n                result.fontSize = size;\r\n            } else {\r\n                result.fontSize = defaultStyle.fontSize;\r\n            }\r\n            result.fontStyle = getFontStyle(prop.b, prop.i);\r\n\r\n            if (prop.hasOwnProperty('color')) {\r\n                result.color = prop.color;\r\n            } else {\r\n                result.color = defaultStyle.color;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('stroke')) {\r\n                if (prop.stroke === true) {\r\n                    result.stroke = defaultStyle.stroke;\r\n                    result.strokeThickness = defaultStyle.strokeThickness;\r\n                } else {\r\n                    result.stroke = prop.stroke;\r\n                    result.strokeThickness = defaultStyle.strokeThickness;\r\n                }\r\n            } else {\r\n                result.stroke = defaultStyle.stroke;\r\n                result.strokeThickness = 0;\r\n            }\r\n        } else {\r\n            result.image = prop.img;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('shadow')) {\r\n            if (prop.shadow === true) {\r\n                result.shadowColor = defaultStyle.shadowColor;\r\n                result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n                result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n                result.shadowBlur = defaultStyle.shadowBlur;\r\n                result.shadowStroke = true;\r\n                result.shadowFill = true;\r\n            } else {\r\n                result.shadowColor = prop.shadow;\r\n                result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n                result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n                result.shadowBlur = defaultStyle.shadowBlur;\r\n                result.shadowStroke = true;\r\n                result.shadowFill = true;\r\n            }\r\n        } else {\r\n            result.shadowColor = '#000';\r\n            result.shadowOffsetX = 0;\r\n            result.shadowOffsetY = 0;\r\n            result.shadowBlur = 0;\r\n            result.shadowStroke = false;\r\n            result.shadowFill = false;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('u')) {\r\n            if (prop.u === true) {\r\n                result.underlineColor = defaultStyle.underlineColor;\r\n                result.underlineThickness = defaultStyle.underlineThickness;\r\n                result.underlineOffset = defaultStyle.underlineOffset;\r\n            } else {\r\n                result.underlineColor = prop.u;\r\n                result.underlineThickness = defaultStyle.underlineThickness;\r\n                result.underlineOffset = defaultStyle.underlineOffset;\r\n            }\r\n        } else {\r\n            result.underlineColor = '#000';\r\n            result.underlineThickness = 0;\r\n            result.underlineOffset = 0;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    propToTagText: function (text, prop, prevProp) {\r\n        if (prevProp == null) {\r\n            prevProp = EMPTYPROP;\r\n        }\r\n\r\n        for (var k in prevProp) {\r\n            if (prop.hasOwnProperty(k)) {\r\n                continue;\r\n            }\r\n\r\n            text = '[/' + k + ']' + text;\r\n        }\r\n\r\n        var header = '';\r\n        for (var k in prop) {\r\n            if (prevProp[k] === prop[k]) {\r\n                continue;\r\n            }\r\n\r\n            if (k === 'size') {\r\n                header += ('[size=' + prop[k].replace('px', '') + ']');\r\n            } else if ((k === 'color') || (k === 'stroke') || (k === 'img')) {\r\n                header += ('[' + k + '=' + prop[k] + ']');\r\n            } else if (k === 'u') {\r\n                if (prop[k] === true) {\r\n                    header += '[u]';\r\n                } else {\r\n                    header += ('[u=' + prop[k] + ']');\r\n                }\r\n            } else {\r\n                header += ('[' + k + ']');\r\n            }\r\n        }\r\n        text = header + text;\r\n\r\n        return text;\r\n    }\r\n};\r\n\r\nvar updateProp = function (prop, op, key, value) {\r\n    if (op === PROP_ADD) {\r\n        // PROP_ADD     \r\n        prop[key] = value;\r\n    } else {\r\n        // PROP_REMOVE        \r\n        if (prop.hasOwnProperty(key)) {\r\n            delete prop[key];\r\n        }\r\n    }\r\n\r\n    return prop;\r\n};\r\n\r\nvar getFontStyle = function (isBold, isItalic) {\r\n    if (isBold && isItalic) {\r\n        return 'bold italic';\r\n    } else if (isBold) {\r\n        return 'bold';\r\n    } else if (isItalic) {\r\n        return 'italic';\r\n    } else {\r\n        return '';\r\n    }\r\n};\r\n\r\nvar RE_SPLITTEXT = /\\[b\\]|\\[\\/b\\]|\\[i\\]|\\[\\/i\\]|\\[size=(\\d+)\\]|\\[\\/size\\]|\\[color=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/color\\]|\\[u\\]|\\[u=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/u\\]|\\[shadow\\]|\\[\\/shadow\\]|\\[stroke\\]|\\[stroke=([a-z]+|#[0-9abcdef]+)\\]|\\[\\/stroke\\]|\\[img=([^\\]]+)\\]|\\[\\/img\\]|\\[area=([^\\]]+)\\]|\\[\\/area\\]/ig;\r\n\r\nvar RE_BLOD_OPEN = /\\[b\\]/i;\r\nvar RE_BLOD_CLOSE = /\\[\\/b\\]/i;\r\nvar RE_ITALICS_OPEN = /\\[i\\]/i;\r\nvar RE_ITALICS_CLOSE = /\\[\\/i\\]/i;\r\nvar RE_SIZE_OPEN = /\\[size=(\\d+)\\]/i;\r\nvar RE_SIZE_CLOSE = /\\[\\/size\\]/i;\r\nvar RE_COLOR_OPEN = /\\[color=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_COLOR_CLOSE = /\\[\\/color\\]/i;\r\nvar RE_UNDERLINE_OPEN = /\\[u\\]/i;\r\nvar RE_UNDERLINE_OPENC = /\\[u=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_UNDERLINE_CLOSE = /\\[\\/u\\]/i;\r\nvar RE_SHADOW_OPEN = /\\[shadow\\]/i;\r\nvar RE_SHADOW_CLOSE = /\\[\\/shadow\\]/i;\r\nvar RE_STROKE_OPEN = /\\[stroke\\]/i;\r\nvar RE_STROKE_OPENC = /\\[stroke=([a-z]+|#[0-9abcdef]+)\\]/i;\r\nvar RE_STROKE_CLOSE = /\\[\\/stroke\\]/i;\r\nvar RE_IMAGE_OPEN = /\\[img=([^\\]]+)\\]/i;\r\nvar RE_IMAGE_CLOSE = /\\[\\/img\\]/i;\r\nvar RE_AREA_OPEN = /\\[area=([^\\]]+)\\]/i;\r\nvar RE_AREA_CLOSE = /\\[\\/area\\]/i;\r\nconst PROP_REMOVE = false;\r\nconst PROP_ADD = true;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (parser);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/Parser.js?")},"./lib/rexui/lib/plugins/gameobjects/text/tagtext/Parser.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/textstyle/TextStyle.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n\r\n\r\nvar GETPROP_RESULT = {\r\n    plainText: null,\r\n    prevProp: null\r\n};\r\n\r\nvar STYLE_RESULT = new _textbase_textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\r\nvar PROPLIST = [];\r\n\r\nclass parser {\r\n    constructor(tags) {\r\n        if (tags === undefined) {\r\n            tags = {};\r\n        }\r\n        this.tags = tags;\r\n    }\r\n\r\n    addTag(name, prop) {\r\n        this.tags[name] = prop;\r\n    }\r\n\r\n    splitText(text, mode) {\r\n        var result = [];\r\n        var arr, m, charIdx = 0,\r\n            totalLen = text.length,\r\n            matchStart = totalLen;\r\n        var innerMatch;\r\n        while (true) {\r\n            arr = RE_SPLITTEXT.exec(text);\r\n            if (!arr) {\r\n                break;\r\n            }\r\n\r\n            m = arr[0];\r\n            matchStart = RE_SPLITTEXT.lastIndex - m.length;\r\n\r\n            if (charIdx < matchStart) {\r\n                result.push(text.substring(charIdx, matchStart));\r\n            }\r\n            if (mode === undefined) {\r\n                result.push(m);\r\n            } else if (mode === 1) { // RAWTEXTONLY_MODE\r\n                if (RE_CLASS_HEADER.test(m)) {\r\n                    innerMatch = m.match(RE_CLASS);\r\n                    result.push(innerMatch[2]);\r\n                } else if (RE_STYLE_HEADER.test(m)) {\r\n                    innerMatch = m.match(RE_STYLE);\r\n                    result.push(innerMatch[2]);\r\n                }\r\n            }\r\n\r\n            charIdx = RE_SPLITTEXT.lastIndex;\r\n        }\r\n\r\n\r\n        if (charIdx < totalLen) {\r\n            result.push(text.substring(charIdx, totalLen));\r\n        }\r\n        return result; // [text,...]\r\n    }\r\n\r\n    tagTextToProp(text, prevProp) {\r\n        var plainText, propOut;\r\n        if (RE_CLASS_HEADER.test(text)) {\r\n            var innerMatch = text.match(RE_CLASS);\r\n            if (innerMatch != null) {\r\n                var name = innerMatch[1];\r\n                var tags = this.tags;\r\n                if (tags.hasOwnProperty(name)) {\r\n                    propOut = tags[name];\r\n                } else {\r\n                    propOut = {};\r\n                }\r\n                propOut._class = name;\r\n                plainText = innerMatch[2];\r\n            }\r\n        } else if (RE_STYLE_HEADER.test(text)) {\r\n            var innerMatch = text.match(RE_STYLE);\r\n            if (innerMatch != null) {\r\n                var style = innerMatch[1];\r\n                propOut = styleToProp(style);\r\n                propOut._style = style;\r\n                plainText = innerMatch[2];\r\n            }\r\n        }\r\n\r\n        if (plainText == null) {\r\n            plainText = text;\r\n        }\r\n\r\n        if (propOut == null) {\r\n            propOut = {};\r\n        }\r\n\r\n        var result = GETPROP_RESULT;\r\n        result.plainText = plainText;\r\n        result.prop = propOut;\r\n        return result;\r\n    }\r\n\r\n    propToContextStyle(defaultStyle, prop) {\r\n        var result = STYLE_RESULT;\r\n        if (!prop.hasOwnProperty('img')) {\r\n            result.image = null;\r\n\r\n            if (prop.hasOwnProperty('family') || prop.hasOwnProperty('fontFamily') || prop.hasOwnProperty('font-family')) {\r\n                var family = (prop.hasOwnProperty('family')) ? prop.family :\r\n                    (prop.hasOwnProperty('fontFamily')) ? prop.fontFamily :\r\n                    prop['font-family'];\r\n                result.fontFamily = family;\r\n            } else {\r\n                result.fontFamily = defaultStyle.fontFamily;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('size') || prop.hasOwnProperty('fontSize') || prop.hasOwnProperty('font-size')) {\r\n                var size = (prop.hasOwnProperty('size')) ? prop.size :\r\n                    (prop.hasOwnProperty('fontSize')) ? prop.fontSize :\r\n                    prop['font-size'];\r\n                if (typeof (size) === 'number') {\r\n                    size = size.toString() + 'px';\r\n                }\r\n                result.fontSize = size;\r\n            } else {\r\n                result.fontSize = defaultStyle.fontSize;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('style') || prop.hasOwnProperty('fontStyle') || prop.hasOwnProperty('font-style')) {\r\n                var fontStyle = (prop.hasOwnProperty('style')) ? prop.style :\r\n                    (prop.hasOwnProperty('fontStyle')) ? prop.fontStyle :\r\n                    prop['font-style'];\r\n                result.fontStyle = fontStyle;\r\n            } else {\r\n                result.fontStyle = defaultStyle.fontStyle;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('color') || prop.hasOwnProperty('font-color')) {\r\n                var color = (prop.hasOwnProperty('color')) ? prop.color : prop['font-color'];\r\n                result.color = prop.color;\r\n            } else {\r\n                result.color = defaultStyle.color;\r\n            }\r\n\r\n            if (prop.hasOwnProperty('stroke')) {\r\n                var stroke = prop.stroke; // {color, thinkness}\r\n                result.stroke = (stroke.hasOwnProperty('color')) ? stroke.color : defaultStyle.stroke;\r\n                result.strokeThickness = (stroke.hasOwnProperty('thinkness')) ? stroke.thinkness : defaultStyle.strokeThickness;\r\n            } else {\r\n                result.stroke = defaultStyle.stroke;\r\n                result.strokeThickness = defaultStyle.strokeThickness;\r\n            }\r\n        } else {\r\n            result.image = prop.img;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('shadow')) {\r\n            var shadow = prop.shadow; // {color, offsetX, offsetY, blur}\r\n            result.shadowColor = (shadow.hasOwnProperty('color')) ? shadow.color : defaultStyle.shadowColor;\r\n            result.shadowOffsetX = (shadow.hasOwnProperty('offsetX')) ? shadow.offsetX : defaultStyle.shadowOffsetX;\r\n            result.shadowOffsetY = (shadow.hasOwnProperty('offsetY')) ? shadow.offsetY : defaultStyle.shadowOffsetY;\r\n            result.shadowBlur = (shadow.hasOwnProperty('blur')) ? shadow.blur : defaultStyle.shadowBlur;\r\n            result.shadowStroke = true;\r\n            result.shadowFill = true;\r\n        } else {\r\n            result.shadowColor = defaultStyle.shadowColor;\r\n            result.shadowOffsetX = defaultStyle.shadowOffsetX;\r\n            result.shadowOffsetY = defaultStyle.shadowOffsetY;\r\n            result.shadowBlur = defaultStyle.shadowBlur;\r\n            result.shadowStroke = defaultStyle.shadowStroke;\r\n            result.shadowFill = defaultStyle.shadowFill;\r\n        }\r\n\r\n        if (prop.hasOwnProperty('u') || prop.hasOwnProperty('underline')) {\r\n            var u = (prop.hasOwnProperty('u')) ? prop.u : prop.underline; // {color, thinkness, offset}\r\n            result.underlineColor = (u.hasOwnProperty('color')) ? u.color : defaultStyle.underlineColor;\r\n            result.underlineThickness = (u.hasOwnProperty('thinkness')) ? u.thinkness : defaultStyle.underlineThickness;\r\n            result.underlineOffset = (u.hasOwnProperty('offset')) ? u.offset : defaultStyle.underlineOffset;\r\n        } else {\r\n            result.underlineColor = defaultStyle.underlineColor;\r\n            result.underlineThickness = defaultStyle.underlineThickness;\r\n            result.underlineOffset = defaultStyle.underlineOffset;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    propToTagText(text, prop, prevProp) {\r\n        if (prop.hasOwnProperty('_class')) { // class mode\r\n            if (text === '') {\r\n                if (this.isTextTag(prop._class)) {\r\n                    return '';\r\n                }\r\n            }\r\n            return \"<class='\" + prop._class + \"'>\" + text + \"</class>\";\r\n        } else if (prop.hasOwnProperty('_style')) { // class mode\r\n            return \"<style='\" + prop._style + \"'>\" + text + \"</style>\";\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.tags = undefined;\r\n    }\r\n\r\n    isTextTag(tagName) {\r\n        var tag = this.tags[tagName];\r\n        if (tag) {\r\n            return (tag.img == null);\r\n        } else { // tag not found\r\n            return false;\r\n        }\r\n    }\r\n};\r\n\r\nvar styleToProp = function (s) {\r\n    s = s.split(\";\");\r\n\r\n    var result = {},\r\n        prop, k, v;\r\n    for (var i = 0, slen = s.length; i < slen; i++) {\r\n        prop = s[i].split(\":\");\r\n        k = prop[0], v = prop[1];\r\n        if (isEmpty(k) || isEmpty(v)) {\r\n            continue;\r\n        }\r\n\r\n        switch (k) {\r\n            case 'stroke':\r\n                var stroke = v.split(' '); // stroke:blue 1px\r\n                var len = stroke.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = stroke[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.thinkness = parseInt(stroke[1].replace('px', ''));\r\n                }\r\n                break;\r\n            case 'shadow':\r\n                var shadow = v.split(' '); // shadow:blue 2px 2px 2px\r\n                var len = shadow.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = shadow[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.offsetX = parseInt(shadow[1].replace('px', ''));\r\n                }\r\n                if (len >= 3) {\r\n                    v.offsetY = parseInt(shadow[2].replace('px', ''));\r\n                }\r\n                if (len >= 4) {\r\n                    v.blur = parseInt(shadow[3].replace('px', ''));\r\n                }\r\n                break;\r\n            case 'u':\r\n            case 'underline': // underline:blue 3px -1px\r\n                var u = v.split(' ');\r\n                var len = u.length;\r\n                v = {};\r\n                if (len >= 1) {\r\n                    v.color = u[0];\r\n                }\r\n                if (len >= 2) {\r\n                    v.thinkness = parseInt(u[1].replace('px', ''));\r\n                }\r\n                if (len >= 3) {\r\n                    v.offset = parseInt(u[2].replace('px', ''));\r\n                }\r\n                break;\r\n        }\r\n        result[k] = v;\r\n    }\r\n    return result;\r\n};\r\n\r\nvar isEmpty = function (s) {\r\n    // Remove white spaces.\r\n    s = s.replace(RE_SPACE, '');\r\n    return (s.length === 0);\r\n};\r\n\r\nvar RE_SPLITTEXT = /<\\s*class=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/class\\s*\\>|<\\s*style=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/style\\s*\\>/g;\r\nvar RE_CLASS_HEADER = /<\\s*class=/i;\r\nvar RE_CLASS = /<\\s*class=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/class\\s*\\>/;\r\nvar RE_STYLE_HEADER = /<\\s*style=/i;\r\nvar RE_STYLE = /<\\s*style=[\"|']([^\"|']+)[\"|']\\s*\\>([\\s\\S]*?)<\\s*\\/style\\s*\\>/;\r\nvar RE_SPACE = /^\\s+|\\s+$/;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (parser);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/tagtext/Parser.js?")},"./lib/rexui/lib/plugins/gameobjects/text/tagtext/TagText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../textbase/Text.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/Text.js");\n/* harmony import */ var _Parser_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Parser.js */ "./lib/rexui/lib/plugins/gameobjects/text/tagtext/Parser.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TagText extends _textbase_Text_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, text, style) {\r\n        var tags = GetValue(style, \'tags\', undefined);\r\n        var parser = new _Parser_js__WEBPACK_IMPORTED_MODULE_1__["default"](tags);\r\n        super(scene, x, y, text, style, \'rexTagText\', parser);\r\n        this.parser = parser;\r\n    }\r\n\r\n    addTag(name, prop) {\r\n        this.parser.addTag(name, prop);\r\n        return this.updateText(true);\r\n    }\r\n\r\n    addTags(tags) {\r\n        for(var name in tags){\r\n            this.parser.addTag(name, tags[name]);\r\n        }\r\n        return this.updateText(true);\r\n    }\r\n\r\n    preDestroy() {\r\n        super.preDestroy();\r\n        this.parser.destroy();\r\n        this.parser = undefined;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TagText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/tagtext/TagText.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/Text.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _render_Render_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./render/Render.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/render/Render.js\");\n/* harmony import */ var _textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./textstyle/TextStyle.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js\");\n/* harmony import */ var _canvastext_CanvasText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./canvastext/CanvasText.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/CanvasText.js\");\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../pool.js */ \"./lib/rexui/lib/plugins/pool.js\");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./const.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js\");\n/* harmony import */ var _imagemanager_GetGlobImageManager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./imagemanager/GetGlobImageManager.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js\");\n\r\n // extended\r\n\r\n\r\n\r\n\r\n\r\nconst AddToDOM = Phaser.DOM.AddToDOM;\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\nconst GameObject = Phaser.GameObjects.GameObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveFromDOM = Phaser.DOM.RemoveFromDOM;\r\nconst SPLITREGEXP = _const_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].SPLITREGEXP;\r\n\r\nvar PensPools = {};\r\n\r\nclass Text extends GameObject {\r\n    constructor(scene, x, y, text, style, type, parser) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        super(scene, type);\r\n\r\n        this.renderer = scene.sys.game.renderer;\r\n\r\n        this.setPosition(x, y);\r\n        this.setOrigin(0, 0);\r\n        this.initPipeline();\r\n\r\n        this.canvas = CanvasPool.create(this);\r\n\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        if (style) {\r\n            // Override align\r\n            if (style.hasOwnProperty('align')) {\r\n                var halign = style.align;\r\n                delete style.align;\r\n                style.halign = halign;\r\n            }\r\n        }\r\n        this.style = new _textstyle_TextStyle_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, style);\r\n\r\n        this.autoRound = true;\r\n\r\n        this._text = undefined;\r\n\r\n        this.padding = {\r\n            left: 0,\r\n            right: 0,\r\n            top: 0,\r\n            bottom: 0\r\n        };\r\n\r\n        this.width = 1;\r\n\r\n        this.height = 1;\r\n\r\n        this.dirty = false;\r\n\r\n        //  If resolution wasn't set, then we get it from the game config\r\n        if (this.style.resolution === 0) {\r\n            this.style.resolution = scene.sys.game.config.resolution;\r\n        }\r\n\r\n        this._crop = this.resetCropObject();\r\n\r\n        //  Create a Texture for this Text object\r\n        this.texture = scene.sys.textures.addCanvas(null, this.canvas, true);\r\n\r\n        //  Get the frame\r\n        this.frame = this.texture.get();\r\n\r\n        //  Set the resolution\r\n        this.frame.source.resolution = this.style.resolution;\r\n\r\n        if (this.renderer && this.renderer.gl) {\r\n            //  Clear the default 1x1 glTexture, as we override it later\r\n\r\n            this.renderer.deleteTexture(this.frame.source.glTexture);\r\n\r\n            this.frame.source.glTexture = null;\r\n        }\r\n\r\n        if (!PensPools.hasOwnProperty(type)) {\r\n            PensPools[type] = new _pool_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]();\r\n        }\r\n        this.canvasText = new _canvastext_CanvasText_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n            parent: this,\r\n            context: this.context,\r\n            parser: parser,\r\n            style: this.style,\r\n            pensPool: PensPools[type]\r\n        });\r\n\r\n        //this.initRTL();\r\n\r\n        if (style && style.padding) {\r\n            this.setPadding(style.padding);\r\n        }\r\n\r\n        this.setText(text);\r\n\r\n        scene.sys.game.events.on('contextrestored', function () {\r\n            this.dirty = true;\r\n        }, this);\r\n    }\r\n\r\n    set text(value) {\r\n        this.setText(value);\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    initRTL() {\r\n        if (!this.style.rtl) {\r\n            return;\r\n        }\r\n\r\n        //  Here is where the crazy starts.\r\n        //\r\n        //  Due to browser implementation issues, you cannot fillText BiDi text to a canvas\r\n        //  that is not part of the DOM. It just completely ignores the direction property.\r\n\r\n        this.canvas.dir = 'rtl';\r\n\r\n        //  Experimental atm, but one day ...\r\n        this.context.direction = 'rtl';\r\n\r\n        //  Add it to the DOM, but hidden within the parent canvas.\r\n        this.canvas.style.display = 'none';\r\n\r\n        AddToDOM(this.canvas, this.scene.sys.canvas);\r\n\r\n        //  And finally we set the x origin\r\n        this.originX = 1;\r\n    }\r\n\r\n    setText(value) {\r\n        if (!value && value !== 0) {\r\n            value = '';\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n            value = value.join('\\n');\r\n        }\r\n\r\n        if (value !== this._text) {\r\n            this._text = value.toString();\r\n\r\n            this.updateText();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setStyle(style) {\r\n        return this.style.setStyle(style);\r\n    }\r\n\r\n    setFont(font) {\r\n        return this.style.setFont(font);\r\n    }\r\n\r\n    setFontFamily(family) {\r\n        return this.style.setFontFamily(family);\r\n    }\r\n\r\n    setFontSize(size) {\r\n        return this.style.setFontSize(size);\r\n    }\r\n\r\n    setFontStyle(style) {\r\n        return this.style.setFontStyle(style);\r\n    }\r\n\r\n    setFixedSize(width, height) {\r\n        return this.style.setFixedSize(width, height);\r\n    }\r\n\r\n    setBackgroundColor(color) {\r\n        return this.style.setBackgroundColor(color);\r\n    }\r\n\r\n    setFill(color) {\r\n        return this.style.setFill(color);\r\n    }\r\n\r\n    setColor(color) {\r\n        return this.style.setColor(color);\r\n    }\r\n\r\n    setStroke(color, thickness) {\r\n        return this.style.setStroke(color, thickness);\r\n    }\r\n\r\n    setShadow(x, y, color, blur, shadowStroke, shadowFill) {\r\n        return this.style.setShadow(x, y, color, blur, shadowStroke, shadowFill);\r\n    }\r\n\r\n    setShadowOffset(x, y) {\r\n        return this.style.setShadowOffset(x, y);\r\n    }\r\n\r\n    setShadowColor(color) {\r\n        return this.style.setShadowColor(color);\r\n    }\r\n\r\n    setShadowBlur(blur) {\r\n        return this.style.setShadowBlur(blur);\r\n    }\r\n\r\n    setShadowStroke(enabled) {\r\n        return this.style.setShadowStroke(enabled);\r\n    }\r\n\r\n    setShadowFill(enabled) {\r\n        return this.style.setShadowFill(enabled);\r\n    }\r\n\r\n    setWrapMode(mode) {\r\n        return this.style.setWrapMode(mode);\r\n    }\r\n\r\n    setWrapWidth(width) {\r\n        return this.style.setWrapWidth(width);\r\n    }\r\n\r\n    setAlign(align) {\r\n        return this.style.setHAlign(align);\r\n    }\r\n\r\n    setLineSpacing(value) {\r\n        return this.style.setLineSpacing(value);\r\n    }\r\n\r\n    setPadding(left, top, right, bottom) {\r\n        if (typeof left === 'object') {\r\n            var config = left;\r\n\r\n            //  If they specify x and/or y this applies to all\r\n            var x = GetValue(config, 'x', null);\r\n\r\n            if (x !== null) {\r\n                left = x;\r\n                right = x;\r\n            } else {\r\n                left = GetValue(config, 'left', 0);\r\n                right = GetValue(config, 'right', left);\r\n            }\r\n\r\n            var y = GetValue(config, 'y', null);\r\n\r\n            if (y !== null) {\r\n                top = y;\r\n                bottom = y;\r\n            } else {\r\n                top = GetValue(config, 'top', 0);\r\n                bottom = GetValue(config, 'bottom', top);\r\n            }\r\n        } else {\r\n            if (left === undefined) {\r\n                left = 0;\r\n            }\r\n            if (top === undefined) {\r\n                top = left;\r\n            }\r\n            if (right === undefined) {\r\n                right = left;\r\n            }\r\n            if (bottom === undefined) {\r\n                bottom = top;\r\n            }\r\n        }\r\n\r\n        this.padding.left = left;\r\n        this.padding.top = top;\r\n        this.padding.right = right;\r\n        this.padding.bottom = bottom;\r\n\r\n        return this.updateText(false);\r\n    }\r\n\r\n    setResolution(value) {\r\n        return this.style.setResolution(value);\r\n    }\r\n\r\n    setMaxLines(max) {\r\n        return this.style.setMaxLines(max);\r\n    }\r\n\r\n    updateText(runWrap) {\r\n        if (runWrap === undefined) {\r\n            runWrap = true;\r\n        }\r\n        var canvasText = this.canvasText;\r\n\r\n        // wrap text to pens\r\n        var style = this.style;\r\n        if (runWrap) {\r\n            canvasText.updatePenManager(\r\n                this._text,\r\n                style.wrapMode,\r\n                style.wrapWidth,\r\n                style.lineHeight\r\n            );\r\n        }\r\n\r\n        // resize\r\n        var padding = this.padding;\r\n        var textWidth, textHeight;\r\n        if (style.fixedWidth === 0) {\r\n            this.width = canvasText.linesWidth + padding.left + padding.right;\r\n            textWidth = canvasText.linesWidth;\r\n        }\r\n        else {\r\n            this.width = style.fixedWidth;\r\n            textWidth = this.width - padding.left - padding.right;\r\n            if (textWidth < canvasText.linesWidth) {\r\n                textWidth = canvasText.linesWidth;\r\n            }\r\n        }\r\n        if (style.fixedHeight === 0) {\r\n            this.height = canvasText.linesHeight + padding.top + padding.bottom;\r\n            textHeight = canvasText.linesHeight;\r\n        }\r\n        else {\r\n            this.height = style.fixedHeight;\r\n            textHeight = this.height - padding.top - padding.bottom;\r\n            if (textHeight < canvasText.linesHeight) {\r\n                textHeight = canvasText.linesHeight;\r\n            }\r\n        }\r\n\r\n        var w = this.width;\r\n        var h = this.height;\r\n\r\n        this.updateDisplayOrigin();\r\n\r\n        var resolution = style.resolution;\r\n        w *= resolution;\r\n        h *= resolution;\r\n\r\n        w = Math.max(Math.ceil(w), 1);\r\n        h = Math.max(Math.ceil(h), 1);\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n        if (canvas.width !== w || canvas.height !== h) {\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n            this.frame.setSize(w, h);\r\n        } else {\r\n            context.clearRect(0, 0, w, h);\r\n        }\r\n\r\n        context.save();\r\n        context.scale(resolution, resolution);\r\n\r\n        // draw\r\n        canvasText.draw(\r\n            padding.left,\r\n            padding.top,\r\n            textWidth,\r\n            textHeight\r\n        );\r\n\r\n        context.restore();\r\n\r\n        if (this.renderer.gl) {\r\n            this.frame.source.glTexture = this.renderer.canvasToTexture(canvas, this.frame.source.glTexture, true);\r\n            this.frame.glTexture = this.frame.source.glTexture;\r\n        }\r\n\r\n        this.dirty = true;\r\n\r\n        var input = this.input;\r\n\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = this.width;\r\n            input.hitArea.height = this.height;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    getTextMetrics() {\r\n        return this.style.getTextMetrics();\r\n    }\r\n\r\n    toJSON() {\r\n        var out = Components.ToJSON(this);\r\n\r\n        //  Extra Text data is added here\r\n\r\n        var data = {\r\n            autoRound: this.autoRound,\r\n            text: this._text,\r\n            style: this.style.toJSON(),\r\n            resolution: this.resolution,\r\n            padding: {\r\n                left: this.padding.left,\r\n                right: this.padding.right,\r\n                top: this.padding.top,\r\n                bottom: this.padding.bottom\r\n            }\r\n        };\r\n\r\n        out.data = data;\r\n\r\n        return out;\r\n    }\r\n\r\n    preDestroy() {\r\n        if (this.style.rtl) {\r\n            RemoveFromDOM(this.canvas);\r\n        }\r\n\r\n        CanvasPool.remove(this.canvas);\r\n        this.canvasText.destroy();\r\n    }\r\n\r\n    setInteractive(shape, callback, dropZone) {\r\n        GameObject.prototype.setInteractive.call(this, shape, callback, dropZone);\r\n        this.canvasText.setInteractive();\r\n        return this;\r\n    }\r\n\r\n    getWrappedText(text, start, end) {\r\n        text = this.canvasText.getText(text, start, end, true);\r\n        return text.split(SPLITREGEXP);\r\n    }\r\n\r\n    getPlainText(text, start, end) {\r\n        return this.canvasText.getPlainText(text, start, end);\r\n    }\r\n\r\n    getText(text, start, end) {\r\n        return this.canvasText.getText(text, start, end, false);\r\n    }\r\n\r\n    getSubString(text, start, end) {\r\n        return this.getText(text, start, end);\r\n    }\r\n\r\n    copyPenManager(penManager) {\r\n        return this.canvasText.copyPenManager(penManager);\r\n    }\r\n\r\n    getPenManager(text, penManager) {\r\n        return this.canvasText.getPenManager(text, penManager);\r\n    }\r\n\r\n    setSize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    resize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    set lineSpacing(value) {\r\n        this.setLineSpacing(value);\r\n    }\r\n    get lineSpacing() {\r\n        return this.style.lineSpacing;\r\n    }\r\n\r\n    get imageManager() {\r\n        return Object(_imagemanager_GetGlobImageManager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this.scene.textures);\r\n    }\r\n\r\n    addImage(key, config) {\r\n        this.imageManager.add(key, config);\r\n        return this;\r\n    }\r\n\r\n    drawAreaBounds(graphics, color) {\r\n        this.canvasText.hitAreaManager.drawBounds(graphics, color, this);\r\n        return this;\r\n    }\r\n}\r\n\r\nconst Components = Phaser.GameObjects.Components;\r\nPhaser.Class.mixin(Text,\r\n    [\r\n        Components.Alpha,\r\n        Components.BlendMode,\r\n        Components.ComputedSize,\r\n        Components.Crop,\r\n        Components.Depth,\r\n        Components.Flip,\r\n        Components.GetBounds,\r\n        Components.Mask,\r\n        Components.Origin,\r\n        Components.Pipeline,\r\n        Components.ScrollFactor,\r\n        Components.Tint,\r\n        Components.Transform,\r\n        Components.Visible,\r\n        _render_Render_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n    ]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Text);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/Text.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/CanvasText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _DrawMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DrawMethods.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js");\n/* harmony import */ var _penmanger_PenManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../penmanger/PenManager.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/PenManager.js");\n/* harmony import */ var _hitareamanager_HitAreaManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../hitareamanager/HitAreaManager.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js");\n/* harmony import */ var _SetInteractive_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SetInteractive.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js");\n/* harmony import */ var _WrapText_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./WrapText.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/WrapText.js");\n/* harmony import */ var _utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../utils/object/Clone.js */ "./lib/rexui/lib/plugins/utils/object/Clone.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst NO_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_4__["default"].NO_WRAP;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_4__["default"].NO_NEWLINE;\r\n\r\nclass CanvasText {\r\n    constructor(config) {\r\n        this.parent = config.parent;\r\n        this.context = GetValue(config, \'context\', null);\r\n        this.canvas = this.context.canvas;\r\n        this.parser = GetValue(config, \'parser\', null);\r\n        this.defatultStyle = GetValue(config, \'style\', null);\r\n        this.autoRound = true;\r\n\r\n        this.pensPool = GetValue(config, \'pensPool\', null);\r\n        this.penManager = this.newPenManager();\r\n        this._tmpPenManager = null;\r\n\r\n        this.hitAreaManager = new _hitareamanager_HitAreaManager_js__WEBPACK_IMPORTED_MODULE_2__["default"]();\r\n\r\n        var context = this.context;\r\n        this.getTextWidth = function (text) {\r\n            return context.measureText(text).width;\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.context = undefined;\r\n        this.canvas = undefined;\r\n        this.parser = undefined;\r\n        this.defatultStyle = undefined;\r\n\r\n        if (this.penManager) {\r\n            this.penManager.destroy();\r\n            this.penManager = undefined;\r\n        }\r\n        if (this._tmpPenManager) {\r\n            this._tmpPenManager.destroy();\r\n            this._tmpPenManager = undefined;\r\n        }\r\n        if (this.hitAreaManager) {\r\n            this.hitAreaManager.destroy();\r\n            this.hitAreaManager = undefined;\r\n        }\r\n    }\r\n\r\n    updatePenManager(text, wrapMode, wrapWidth, lineHeight, penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n        penManager.freePens();\r\n        if (text === "") {\r\n            return penManager;\r\n        }\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n\r\n        var cursorX = 0,\r\n            cursorY = 0;\r\n\r\n        var plainText, curProp, curStyle;\r\n        var match = this.parser.splitText(text),\r\n            result, wrapLines;\r\n        for (var i = 0, len = match.length; i < len; i++) {\r\n            result = this.parser.tagTextToProp(match[i], curProp);\r\n            plainText = result.plainText;\r\n            curProp = result.prop;\r\n\r\n            if (curProp.img) { // Image tag                \r\n                var imgWidth = this.imageManager.getOuterWidth(curProp.img);\r\n                if ((wrapWidth > 0) && (wrapMode !== NO_WRAP)) {  // Wrap mode\r\n                    if (wrapWidth < (cursorX + imgWidth)) {\r\n                        penManager.addNewLinePen();\r\n                        cursorY += lineHeight;\r\n                        cursorX = 0;\r\n                    }\r\n                }\r\n                penManager.addImagePen(cursorX, cursorY, imgWidth, Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__["default"])(curProp));\r\n                cursorX += imgWidth;\r\n\r\n            } else if (plainText !== \'\') {\r\n                // wrap text to lines\r\n                // Save the current context.\r\n                this.context.save();\r\n                curStyle = this.parser.propToContextStyle(\r\n                    this.defatultStyle,\r\n                    curProp\r\n                );\r\n                curStyle.buildFont();\r\n                curStyle.syncFont(canvas, context);\r\n                curStyle.syncStyle(canvas, context);\r\n                wrapLines = Object(_WrapText_js__WEBPACK_IMPORTED_MODULE_5__["default"])(plainText, this.getTextWidth, wrapMode, wrapWidth, cursorX);\r\n\r\n                // add pens\r\n                var n;\r\n                for (var j = 0, jLen = wrapLines.length; j < jLen; j++) {\r\n                    n = wrapLines[j];\r\n                    penManager.addTextPen(n.text, cursorX, cursorY, n.width, Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_6__["default"])(curProp), n.newLineMode);\r\n\r\n                    if (n.newLineMode !== NO_NEWLINE) {\r\n                        cursorX = 0;\r\n                        cursorY += lineHeight;\r\n                    } else {\r\n                        cursorX += n.width;\r\n                    }\r\n\r\n                }\r\n                this.context.restore();\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return penManager;\r\n    }\r\n\r\n    get startXOffset() {\r\n        var defatultStyle = this.defatultStyle;\r\n        return (defatultStyle.strokeThickness / 2);\r\n    }\r\n\r\n    get startYOffset() {\r\n        var defatultStyle = this.defatultStyle;\r\n        return (defatultStyle.strokeThickness / 2) + defatultStyle.metrics.ascent;\r\n    }\r\n\r\n    get lines() {\r\n        return this.penManager.lines;\r\n    }\r\n\r\n    get desplayLinesCount() {\r\n        var linesCount = this.penManager.linesCount,\r\n            maxLines = this.defatultStyle.maxLines;\r\n        if ((maxLines > 0) && (linesCount > maxLines)) {\r\n            linesCount = maxLines;\r\n        }\r\n        return linesCount;\r\n    }\r\n\r\n    get linesWidth() {\r\n        return this.penManager.getMaxLineWidth();\r\n    }\r\n\r\n    get linesHeight() {\r\n        var linesCount = this.desplayLinesCount;\r\n        var linesHeight = (this.defatultStyle.lineHeight * linesCount);\r\n        if (linesCount > 0) {\r\n            linesHeight -= this.defatultStyle.lineSpacing;\r\n        }\r\n        return linesHeight;\r\n    }\r\n\r\n    get imageManager() {\r\n        return this.parent.imageManager;\r\n    }\r\n\r\n    newPenManager() {\r\n        return new _penmanger_PenManager_js__WEBPACK_IMPORTED_MODULE_1__["default"]({\r\n            pensPool: this.pensPool,\r\n            tagToText: this.parser.propToTagText,\r\n            tagToTextScope: this.parser\r\n        });\r\n    }\r\n\r\n    get tmpPenManager() {\r\n        if (this._tmpPenManager === null) {\r\n            this._tmpPenManager = this.newPenManager();\r\n        }\r\n        return this._tmpPenManager;\r\n    }\r\n\r\n    getPlainText(text, start, end) {\r\n        var plainText;\r\n        if (text == null) {\r\n            plainText = this.penManager.plainText;\r\n        } else {\r\n            var m, match = this.parser.splitText(text, 1); // PLAINTEXTONLY_MODE\r\n            plainText = "";\r\n            for (var i = 0, len = match.length; i < len; i++) {\r\n                plainText += match[i];\r\n            }\r\n        }\r\n\r\n        if ((start != null) || (end != null)) {\r\n            if (start == null) {\r\n                start = 0;\r\n            }\r\n            if (end == null) {\r\n                end = plainText.length;\r\n            }\r\n            plainText = plainText.substring(start, end);\r\n        }\r\n\r\n        return plainText;\r\n    }\r\n\r\n    getPenManager(text, retPenManager) {\r\n        if (text === undefined) {\r\n            return this.copyPenManager(retPenManager, this.penManager);\r\n        }\r\n\r\n        if (retPenManager === undefined) {\r\n            retPenManager = this.newPenManager();\r\n        }\r\n\r\n        var defatultStyle = this.defatultStyle;\r\n        this.updatePenManager(\r\n            text,\r\n            defatultStyle.wrapMode,\r\n            defatultStyle.wrapWidth,\r\n            defatultStyle.lineHeight,\r\n            retPenManager\r\n        );\r\n        return retPenManager;\r\n    }\r\n\r\n    getText(text, start, end, wrap) {\r\n        if (text == null) {\r\n            return this.penManager.getSliceTagText(start, end, wrap);\r\n        }\r\n\r\n        var penManager = this.tmpPenManager;\r\n        var defatultStyle = this.defatultStyle;\r\n        this.updatePenManager(\r\n            text,\r\n            defatultStyle.wrapMode,\r\n            defatultStyle.wrapWidth,\r\n            defatultStyle.lineHeight,\r\n            penManager\r\n        );\r\n\r\n        return penManager.getSliceTagText(start, end, wrap);\r\n    }\r\n\r\n    copyPenManager(ret, src) {\r\n        if (src === undefined) {\r\n            src = this.penManager;\r\n        }\r\n        return src.copy(ret);\r\n    }\r\n\r\n    getTextWidth(penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n\r\n        return penManager.getMaxLineWidth();\r\n    }\r\n\r\n    getLastPen(penManager) {\r\n        if (penManager === undefined) {\r\n            penManager = this.penManager;\r\n        }\r\n\r\n        return penManager.lastPen;\r\n    }\r\n};\r\n\r\nvar methods = {\r\n    setInteractive: _SetInteractive_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n}\r\n\r\nObject.assign(\r\n    CanvasText.prototype,\r\n    _DrawMethods_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CanvasText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/CanvasText.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    draw(startX, startY, boxWidth, boxHeight) {\r\n        var penManager = this.penManager;\r\n        this.hitAreaManager.clear();\r\n\r\n        var context = this.context;\r\n        context.save();\r\n\r\n        // this.clear();\r\n        this.drawBackground(this.defatultStyle.backgroundColor);\r\n\r\n        // draw lines\r\n        var defatultStyle = this.defatultStyle;\r\n        startX += this.startXOffset;\r\n        startY += this.startYOffset;\r\n        var halign = defatultStyle.halign,\r\n            valign = defatultStyle.valign;\r\n\r\n        var lineWidth, lineHeight = defatultStyle.lineHeight;\r\n        var lines = penManager.lines;\r\n        var totalLinesNum = lines.length,\r\n            maxLines = defatultStyle.maxLines;\r\n        var drawLinesNum, drawLineStartIdx, drawLineEndIdx;\r\n        if ((maxLines > 0) && (totalLinesNum > maxLines)) {\r\n            drawLinesNum = maxLines;\r\n            if (valign === 'center') { // center\r\n                drawLineStartIdx = Math.floor((totalLinesNum - drawLinesNum) / 2);\r\n            } else if (valign === 'bottom') { // bottom\r\n                drawLineStartIdx = totalLinesNum - drawLinesNum;\r\n            } else {\r\n                drawLineStartIdx = 0;\r\n            }\r\n        } else {\r\n            drawLinesNum = totalLinesNum;\r\n            drawLineStartIdx = 0;\r\n        }\r\n        drawLineEndIdx = drawLineStartIdx + drawLinesNum;\r\n\r\n        var offsetX, offsetY;\r\n        if (valign === 'center') { // center\r\n            offsetY = Math.max((boxHeight - (drawLinesNum * lineHeight)) / 2, 0);\r\n        } else if (valign === 'bottom') { // bottom\r\n            offsetY = Math.max(boxHeight - (drawLinesNum * lineHeight) - 2, 0);\r\n        } else {\r\n            offsetY = 0;\r\n        }\r\n        offsetY += startY;\r\n        for (var lineIdx = drawLineStartIdx; lineIdx < drawLineEndIdx; lineIdx++) {\r\n            lineWidth = penManager.getLineWidth(lineIdx);\r\n            if (lineWidth === 0) {\r\n                continue;\r\n            }\r\n\r\n            if (halign === 'center') { // center\r\n                offsetX = (boxWidth - lineWidth) / 2;\r\n            } else if (halign === 'right') { // right\r\n                offsetX = boxWidth - lineWidth;\r\n            } else {\r\n                offsetX = 0;\r\n            }\r\n            offsetX += startX;\r\n\r\n            var pens = lines[lineIdx];\r\n            for (var penIdx = 0, pensLen = pens.length; penIdx < pensLen; penIdx++) {\r\n                this.drawPen(pens[penIdx], offsetX, offsetY);\r\n            }\r\n        }\r\n\r\n        context.restore();\r\n    },\r\n\r\n    drawPen(pen, offsetX, offsetY) {\r\n        offsetX += pen.x;\r\n        offsetY += pen.y;\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n        context.save();\r\n\r\n        var curStyle = this.parser.propToContextStyle(\r\n            this.defatultStyle,\r\n            pen.prop\r\n        );\r\n        curStyle.buildFont();\r\n        curStyle.syncFont(canvas, context);\r\n        curStyle.syncStyle(canvas, context);\r\n\r\n        // Underline\r\n        if ((curStyle.underlineThickness > 0) && (pen.width > 0)) {\r\n            this.drawUnderline(offsetX, offsetY, pen.width, curStyle);\r\n        }\r\n\r\n        // Text\r\n        if (pen.isTextPen) {\r\n            this.drawText(offsetX, offsetY, pen.text, curStyle);\r\n        }\r\n\r\n        // Image\r\n        if (pen.isImagePen) {\r\n            this.drawImage(offsetX, offsetY, pen.prop.img, curStyle);\r\n        }\r\n\r\n        context.restore();\r\n\r\n        if (pen.hasAreaMarker && (pen.width > 0)) {\r\n            this.hitAreaManager.add(\r\n                pen.prop.area,\r\n                offsetX, (offsetY - this.startYOffset),\r\n                pen.width, this.defatultStyle.lineHeight);\r\n        }\r\n    },\r\n\r\n    clear() {\r\n        var canvas = this.canvas;\r\n        this.context.clearRect(0, 0, canvas.width, canvas.height);\r\n    },\r\n\r\n    drawBackground(color) {\r\n        if (color === null) {\r\n            return;\r\n        }\r\n        this.context.fillStyle = color;\r\n        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n    },\r\n\r\n    drawUnderline(x, y, width, style) {\r\n        y += style.underlineOffset - (style.underlineThickness / 2);\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        var savedLineCap = context.lineCap;\r\n        context.lineCap = 'butt';\r\n        context.beginPath();\r\n        context.strokeStyle = style.underlineColor;\r\n        context.lineWidth = style.underlineThickness;\r\n        context.moveTo(x, y);\r\n        context.lineTo((x + width), y);\r\n        context.stroke();\r\n        context.lineCap = savedLineCap;\r\n    },\r\n\r\n    drawText(x, y, text, style) {\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        if (style.strokeThickness) {\r\n            style.syncShadow(context, style.shadowStroke);\r\n            context.strokeText(text, x, y);\r\n        }\r\n\r\n        if (style.color && (style.color !== 'none')) {\r\n            style.syncShadow(context, style.shadowFill);\r\n            context.fillText(text, x, y);\r\n        }\r\n    },\r\n\r\n    drawImage(x, y, imgKey, style) {\r\n        var imageManager = this.parent.imageManager;\r\n        var imgData = imageManager.get(imgKey);\r\n        var frame = imageManager.getFrame(imgKey);\r\n\r\n        x += imgData.left;\r\n        y += - this.startYOffset + imgData.y;\r\n        if (this.autoRound) {\r\n            x = Math.round(x);\r\n            y = Math.round(y);\r\n        }\r\n\r\n        var context = this.context;\r\n        context.drawImage(\r\n            frame.source.image,\r\n            frame.cutX, frame.cutY, frame.cutWidth, frame.cutHeight,\r\n            x, y, imgData.width, imgData.height\r\n        );\r\n    }\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/DrawMethods.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar SetInteractive = function () {\r\n    this.parent\r\n        .on('pointerdown', function (pointer, localX, localY, event) {\r\n            FireEvent.call(this, 'areadown', pointer, localX, localY);\r\n        }, this)\r\n        .on('pointerup', function (pointer, localX, localY, event) {\r\n            FireEvent.call(this, 'areaup', pointer, localX, localY);\r\n        }, this)\r\n}\r\n\r\nvar FireEvent = function (eventName, pointer, localX, localY) {\r\n    var key = this.hitAreaManager.contains(localX, localY);\r\n    if (key === false) {\r\n        return;\r\n    }\r\n    this.parent.emit(`${eventName}-${key}`, pointer, localX, localY)\r\n    this.parent.emit(eventName, key, pointer, localX, localY)\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/SetInteractive.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/WrapText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/lib/plugins/pool.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js");\n\r\n\r\n\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].NO_NEWLINE;\r\nconst RAW_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].RAW_NEWLINE;\r\nconst WRAPPED_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].WRAPPED_NEWLINE;\r\nconst NO_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].NO_WRAP;\r\nconst WORD_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].WORD_WRAP;\r\nconst CHAR_WRAP = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].CHAR_WRAP;\r\nconst splitRegExp = _const_js__WEBPACK_IMPORTED_MODULE_1__["default"].SPLITREGEXP;\r\n\r\nvar WRAP_RESULT = [];\r\nvar WrapText = function (text, getTextWidth, wrapMode, wrapWidth, offset) {\r\n    if (wrapWidth <= 0) {\r\n        wrapMode = NO_WRAP;\r\n    }\r\n\r\n    var retLines = WRAP_RESULT;\r\n    LinesPool.pushMultiple(retLines);\r\n\r\n    if (!text || !text.length) {\r\n        return retLines;\r\n    }\r\n\r\n    var lines = text.split(splitRegExp),\r\n        line, remainWidth, isLaseLine, newLineMode;\r\n    for (var i = 0, linesLen = lines.length; i < linesLen; i++) {\r\n        line = lines[i];\r\n        newLineMode = (i === (linesLen - 1)) ? NO_NEWLINE : RAW_NEWLINE;\r\n\r\n        if (wrapMode === NO_WRAP) {\r\n            var textWidth = getTextWidth(line);\r\n            retLines.push(LinesPool.newline(line, textWidth, newLineMode));\r\n            continue;\r\n        } else {\r\n            if (i === 0) {\r\n                remainWidth = wrapWidth - offset;\r\n            } else {\r\n                remainWidth = wrapWidth;\r\n            }\r\n        }\r\n\r\n        // short string testing\r\n        if (line.length <= 100) {\r\n            var textWidth = getTextWidth(line);\r\n            if (textWidth <= remainWidth) {\r\n                retLines.push(LinesPool.newline(line, textWidth, newLineMode));\r\n                continue;\r\n            }\r\n        }\r\n\r\n        // character mode\r\n        var tokenArray;\r\n        if (wrapMode === WORD_WRAP) {\r\n            // word mode\r\n            tokenArray = line.split(\' \');\r\n        } else {\r\n            tokenArray = line;\r\n        }\r\n        var token;\r\n        var curLineText = \'\',\r\n            lineText = \'\',\r\n            currLineWidth, lineWidth = 0;\r\n        for (var j = 0, tokenLen = tokenArray.length; j < tokenLen; j++) {\r\n            token = tokenArray[j];\r\n\r\n            if (wrapMode === WORD_WRAP) {\r\n                curLineText += token;\r\n\r\n                if (j < (tokenLen - 1)) {\r\n                    curLineText += \' \';\r\n                }\r\n            } else {\r\n                curLineText += token;\r\n            }\r\n\r\n            currLineWidth = getTextWidth(curLineText);\r\n            if (currLineWidth > remainWidth) {\r\n                // new line\r\n                if (j === 0) {\r\n                    retLines.push(LinesPool.newline(\'\', 0, WRAPPED_NEWLINE));\r\n                } else {\r\n                    retLines.push(LinesPool.newline(lineText, lineWidth, WRAPPED_NEWLINE));\r\n                    curLineText = token;\r\n                    if (wrapMode === WORD_WRAP) {\r\n                        if (j < (tokenLen - 1)) {\r\n                            curLineText += \' \';\r\n                        }\r\n                    }\r\n                    currLineWidth = getTextWidth(curLineText);\r\n                }\r\n\r\n                remainWidth = wrapWidth;\r\n            }\r\n\r\n            lineText = curLineText;\r\n            lineWidth = currLineWidth;\r\n        } // for token in tokenArray\r\n\r\n        // flush remain text\r\n        retLines.push(LinesPool.newline(lineText, lineWidth, newLineMode));\r\n\r\n    } // for each line in lines\r\n\r\n    return retLines;\r\n};\r\n\r\nvar LinesPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\nLinesPool.newline = function (text, width, newLineMode) {\r\n    var l = this.pop();\r\n    if (l === null) {\r\n        l = {};\r\n    }\r\n    l.text = text;\r\n    l.width = width;\r\n    l.newLineMode = newLineMode;\r\n    return l;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (WrapText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/canvastext/WrapText.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CONST = {\r\n    // new line mode\r\n    NO_NEWLINE: 0,\r\n    RAW_NEWLINE: 1,\r\n    WRAPPED_NEWLINE: 2,\r\n\r\n    // wrap mode\r\n    NO_WRAP: 0,\r\n    WORD_WRAP: 1,\r\n    CHAR_WRAP: 2,\r\n\r\n    // split lines\r\n    SPLITREGEXP: /(?:\\r\\n|\\r|\\n)/\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CONST);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/lib/plugins/pool.js");\n\r\n\r\nconst Rectangle = Phaser.Geom.Rectangle;\r\n\r\nvar RectanglePool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\nclass HitAreaManager {\r\n    constructor() {\r\n        this.hitAreas = [];\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n    }\r\n\r\n    clear() {\r\n        RectanglePool.pushMultiple(this.hitAreas);\r\n        return this;\r\n    }\r\n\r\n    add(key, x, y, width, height) {\r\n        var rectangle = RectanglePool.pop();\r\n        if (rectangle === null) {\r\n            rectangle = new Rectangle(x, y, width, height);\r\n        } else {\r\n            rectangle.setTo(x, y, width, height);\r\n        }\r\n        rectangle.key = key;\r\n        this.hitAreas.push(rectangle);\r\n        return this;\r\n    }\r\n\r\n    contains(x, y) {\r\n        var hitAreas = this.hitAreas, hitArea;\r\n        for (var i = 0, cnt = hitAreas.length; i < cnt; i++) {\r\n            hitArea = hitAreas[i];\r\n            if (hitArea.contains(x, y)) {\r\n                return hitArea.key;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    drawBounds(graphics, color, parent) {\r\n        if (color === undefined) {\r\n            color = 0xffffff;\r\n        }\r\n\r\n        if (parent) {\r\n            graphics\r\n                .save()\r\n                .scaleCanvas(parent.scaleX, parent.scaleY)\r\n                .rotateCanvas(parent.rotation)\r\n                .translateCanvas(parent.x, parent.y)\r\n        }\r\n\r\n        var hitAreas = this.hitAreas, hitArea;\r\n        for (var i = 0, cnt = hitAreas.length; i < cnt; i++) {\r\n            hitArea = hitAreas[i];\r\n            graphics.lineStyle(1, color).strokeRect(hitArea.x, hitArea.y, hitArea.width, hitArea.height);\r\n        }\r\n\r\n        if (parent) {\r\n            graphics\r\n                .restore()\r\n        }\r\n        return this;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (HitAreaManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/hitareamanager/HitAreaManager.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ImageManager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ImageManager.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js");\n\r\n\r\nvar globImageManager;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function(textureManager) {\r\n    if (globImageManager === undefined) {\r\n        globImageManager = new _ImageManager_js__WEBPACK_IMPORTED_MODULE_0__["default"](textureManager);\r\n    }\r\n    return globImageManager;\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/GetGlobImageManager.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ImageManager {\r\n    constructor(textureManager) {\r\n        this.textureManager = textureManager;\r\n        this.images = {};\r\n    }\r\n\r\n    add(key, config) {\r\n        if (typeof (key) === 'string') {\r\n            this._add(key, config);\r\n        } else if (Array.isArray(key)) {\r\n            var data = key;\r\n            for (var i = 0, cnt = data.length; i < cnt; i++) {\r\n                this._add(data[i]);\r\n            }\r\n        } else {\r\n            var data = key;\r\n            for (var key in data) {\r\n                this._add(key, data[key]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    _add(key, config) {\r\n        if (config === undefined) {\r\n            config = {\r\n                key: key\r\n            }\r\n        }\r\n\r\n        var textureKey = config.key, frameKey = config.frame;\r\n        var width = config.width, height = config.height;\r\n\r\n        if ((width === undefined) || (height === undefined)) {\r\n            var frame = this.textureManager.getFrame(textureKey, frameKey);\r\n            var frameWidth = (frame) ? frame.cutWidth : 0;\r\n            var frameHeight = (frame) ? frame.cutHeight : 0;\r\n            if ((width === undefined) && (height === undefined)) {\r\n                width = frameWidth;\r\n                height = frameHeight;\r\n            } else if (width === undefined) {\r\n                width = frameWidth * (height / frameHeight);\r\n            } else if (height === undefined) {\r\n                height = frameHeight * (width / frameWidth);\r\n            }\r\n        }\r\n\r\n        this.images[key] = {\r\n            key: textureKey,\r\n            frame: frameKey,\r\n            width: width,\r\n            height: height,\r\n            y: GetValue(config, 'y', 0),\r\n            left: GetValue(config, 'left', 0),\r\n            right: GetValue(config, 'right', 0)\r\n        }\r\n    }\r\n\r\n    remove(key) {\r\n        if (this.images.hasOwnProperty(key)) {\r\n            delete this.images[key];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get(key) {\r\n        if (!this.images.hasOwnProperty(key)) {\r\n            if (this.textureManager.exists(key)) {\r\n                this.add(key);\r\n            }\r\n        }\r\n        return this.images[key];\r\n    }\r\n\r\n    getOuterWidth(key) {\r\n        var data = this.get(key);\r\n        return (data) ? (data.width + data.left + data.right) : 0;\r\n    }\r\n\r\n    getFrame(key) {\r\n        var data = this.get(key);\r\n        return (data) ? this.textureManager.getFrame(data.key, data.frame) : undefined;\r\n    }\r\n\r\n    hasTexture(key) {\r\n        return !!this.getFrame(key);\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ImageManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/imagemanager/ImageManager.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/Pen.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].NO_NEWLINE;\r\nconst RAW_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].RAW_NEWLINE;\r\n\r\nclass Pen {\r\n    constructor(config) {\r\n        this.prop = {};\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) { // (txt, x, y, width, prop, newLineMode, startIndex)\r\n        this.text = GetValue(o, 'text', '');\r\n        this.x = GetValue(o, 'x', 0);\r\n        this.y = GetValue(o, 'y', 0);\r\n        this.width = GetValue(o, 'width', 0);\r\n\r\n        var prop = GetValue(o, 'prop', null);\r\n        if (prop === null) {\r\n            prop = {};\r\n        }\r\n        this.prop = prop;\r\n        this.newLineMode = GetValue(o, 'newLineMode', 0);\r\n        this.startIndex = GetValue(o, 'startIndex', 0);\r\n    }\r\n\r\n    get plainText() {\r\n        var txt = this.text\r\n        if (this.newLineMode === RAW_NEWLINE) {\r\n            txt += \"\\n\";\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get wrapText() {\r\n        var txt = this.text;\r\n        if (this.newLineMode !== NO_NEWLINE) {\r\n            txt += \"\\n\";\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get rawTextLength() {\r\n        var len = this.text.length;\r\n        if (this.newLineMode === RAW_NEWLINE) {\r\n            len += 1;\r\n        }\r\n        return len;\r\n    }\r\n\r\n    get endIndex() {\r\n        return this.startIndex + this.rawTextLength;\r\n    }\r\n\r\n    get lastX() {\r\n        return this.x + this.width;\r\n    }\r\n\r\n    get isTextPen() {\r\n        return (this.text !== '');\r\n    }\r\n\r\n    get isImagePen() {\r\n        return !!this.prop.img;\r\n    }\r\n\r\n    get hasAreaMarker() {\r\n        return !!this.prop.area;\r\n    }\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pen);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/Pen.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/PenManager.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _pool_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../pool.js */ "./lib/rexui/lib/plugins/pool.js");\n/* harmony import */ var _Pen_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Pen.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/Pen.js");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js");\n/* harmony import */ var _utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../utils/object/Clone.js */ "./lib/rexui/lib/plugins/utils/object/Clone.js");\n/* harmony import */ var _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../utils/object/NOOP.js */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetFastValue = Phaser.Utils.Objects.GetFastValue;\r\nconst NO_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_2__["default"].NO_NEWLINE;\r\nconst WRAPPED_NEWLINE = _const_js__WEBPACK_IMPORTED_MODULE_2__["default"].WRAPPED_NEWLINE;\r\n\r\nvar PensPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"](); // default pens pool\r\nvar LinesPool = new _pool_js__WEBPACK_IMPORTED_MODULE_0__["default"](); // default lines pool\r\nclass PenManager {\r\n    constructor(config) {\r\n        this.pens = []; // all pens\r\n        this.lines = []; // pens in lines [ [],[],[],.. ]\r\n        this.maxLinesWidth = undefined;\r\n\r\n        this.PensPool = GetFastValue(config, \'pensPool\', PensPool);\r\n        this.LinesPool = GetFastValue(config, \'linesPool\', LinesPool);\r\n        this.tagToText = GetFastValue(config, \'tagToText\', _utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_4__["default"]);\r\n        this.tagToTextScope = GetFastValue(config, \'tagToTextScope\', undefined);\r\n    }\r\n\r\n    destroy() {\r\n        this.freePens();\r\n        this.tagToText = undefined;\r\n        this.tagToTextScope = undefined;\r\n    }\r\n\r\n    freePens() {\r\n        for (var i = 0, len = this.lines.length; i < len; i++)\r\n            this.lines[i].length = 0;\r\n\r\n        this.PensPool.pushMultiple(this.pens);\r\n        this.LinesPool.pushMultiple(this.lines);\r\n        this.maxLinesWidth = undefined;\r\n    }\r\n\r\n    addTextPen(text, x, y, width, prop, newLineMode) {\r\n        var pen = this.PensPool.pop();\r\n        if (pen == null) {\r\n            pen = new _Pen_js__WEBPACK_IMPORTED_MODULE_1__["default"]();\r\n        }\r\n        PEN_CONFIG.text = text;\r\n        PEN_CONFIG.x = x;\r\n        PEN_CONFIG.y = y;\r\n        PEN_CONFIG.width = width;\r\n        PEN_CONFIG.prop = prop;\r\n        PEN_CONFIG.newLineMode = newLineMode;\r\n        pen.resetFromJSON(PEN_CONFIG);\r\n        this.addPen(pen);\r\n        return this;\r\n    }\r\n\r\n    addImagePen(x, y, width, prop) {\r\n        this.addTextPen(\'\', x, y, width, prop, NO_NEWLINE);\r\n        return this;\r\n    }\r\n\r\n    addNewLinePen() {\r\n        var previousPen = this.lastPen;\r\n        var x = (previousPen) ? previousPen.lastX : 0;\r\n        var y = (previousPen) ? previousPen.y : 0;\r\n        var prop = (previousPen) ? Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__["default"])(previousPen.prop) : null;\r\n        this.addTextPen(\'\', x, y, 0, prop, WRAPPED_NEWLINE);\r\n        return this;\r\n    }\r\n\r\n    addPen(pen) {\r\n        var previousPen = this.lastPen;\r\n        if (previousPen == null) {\r\n            pen.startIndex = 0;\r\n        } else {\r\n            pen.startIndex = previousPen.endIndex;\r\n        }\r\n        this.pens.push(pen);\r\n\r\n        // maintan lines\r\n        var line = this.lastLine;\r\n        if (line == null) {\r\n            line = this.LinesPool.pop() || [];\r\n            this.lines.push(line);\r\n        }\r\n        line.push(pen);\r\n\r\n        // new line, add an empty line\r\n        if (pen.newLineMode !== NO_NEWLINE) {\r\n            line = this.LinesPool.pop() || [];\r\n            this.lines.push(line);\r\n        }\r\n        this.maxLinesWidth = undefined;\r\n    }\r\n\r\n    clone(targetPenManager) {\r\n        if (targetPenManager == null)\r\n            targetPenManager = new PenManager();\r\n\r\n        targetPenManager.freePens();\r\n\r\n        for (var li = 0, llen = this.lines.length; li < llen; li++) {\r\n            var pens = this.lines[li];\r\n            for (var pi = 0, plen = pens.length; pi < plen; pi++) {\r\n                var pen = pens[pi];\r\n                targetPenManager.addPen(\r\n                    pen.text,\r\n                    pen.x,\r\n                    pen.y,\r\n                    pen.width,\r\n                    Object(_utils_object_Clone_js__WEBPACK_IMPORTED_MODULE_3__["default"])(pen.prop),\r\n                    pen.newLineMode\r\n                );\r\n            }\r\n        }\r\n\r\n        return targetPenManager;\r\n    }\r\n\r\n    get lastPen() {\r\n        return this.pens[this.pens.length - 1];\r\n    }\r\n\r\n    get lastLine() {\r\n        return this.lines[this.lines.length - 1];\r\n    }\r\n\r\n    getLineStartIndex(i) {\r\n        if (i >= this.lines.length) {\r\n            return this.getLineEndIndex(i);\r\n        } else {\r\n            var line = this.lines[i];\r\n            return (line && line[0]) ? line[0].startIndex : 0;\r\n        }\r\n    }\r\n\r\n    getLineEndIndex(i) {\r\n        if (i >= this.lines.length) {\r\n            i = this.lines.length - 1;\r\n        }\r\n        var li, hasLastPen = false,\r\n            line;\r\n        for (li = i; li >= 0; li--) {\r\n            line = this.lines[li];\r\n            hasLastPen = (line != null) && (line.length > 0);\r\n            if (hasLastPen) {\r\n                break;\r\n            }\r\n        }\r\n        if (!hasLastPen) {\r\n            return 0;\r\n        }\r\n\r\n        var lastPen = line[line.length - 1];\r\n        return lastPen.endIndex;\r\n    }\r\n\r\n    getLineWidth(i) {\r\n        var line = this.lines[i];\r\n        if (!line) {\r\n            return 0;\r\n        }\r\n\r\n        var lastPen = line[line.length - 1];\r\n        if (lastPen == null) {\r\n            return 0;\r\n        }\r\n\r\n        var lineWidth = lastPen.lastX; // start from 0\r\n        return lineWidth;\r\n    }\r\n\r\n    getMaxLineWidth() {\r\n        if (this.maxLinesWidth !== undefined) {\r\n            return this.maxLinesWidth;\r\n        }\r\n        var w, maxW = 0;\r\n        for (var i = 0, len = this.lines.length; i < len; i++) {\r\n            w = this.getLineWidth(i);\r\n            if (w > maxW) {\r\n                maxW = w;\r\n            }\r\n        }\r\n        this.maxLinesWidth = maxW;\r\n        return maxW;\r\n    }\r\n\r\n    getLineWidths() {\r\n        var result = [];\r\n        for (var i = 0, len = this.lines.length; i < len; i++) {\r\n            result.push(this.getLineWidth(i));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    get linesCount() {\r\n        return this.lines.length;\r\n    }\r\n\r\n    get plainText() {\r\n        var txt = "",\r\n            pens = this.pens;\r\n        for (var i = 0, len = pens.length; i < len; i++) {\r\n            txt += pens[i].plainText;\r\n        }\r\n\r\n        return txt;\r\n    }\r\n\r\n    get rawTextLength() {\r\n        var l = 0,\r\n            pens = this.pens;\r\n        for (var i = 0, len = this.pens.length; i < len; i++) {\r\n            l += pens[i].rawTextLength;\r\n        }\r\n\r\n        return l;\r\n    }\r\n\r\n    getSliceTagText(start, end, wrap) {\r\n        if (start === undefined) {\r\n            start = 0;\r\n        }\r\n        if (end === undefined) {\r\n            var lastPen = this.lastPen;\r\n            if (lastPen == null) {\r\n                return "";\r\n            }\r\n\r\n            end = lastPen.endIndex;\r\n        }\r\n        if (wrap === undefined) {\r\n            wrap = false;\r\n        }\r\n\r\n        var txt = "",\r\n            formatTxt,\r\n            pen, penTxt, penStartIdx, penEndIdx, isInRange;\r\n        var currentProp, previousProp;\r\n        for (var i = 0, len = this.pens.length; i < len; i++) {\r\n            pen = this.pens[i];\r\n            penEndIdx = pen.endIndex;\r\n            if (penEndIdx <= start) {\r\n                continue;\r\n            }\r\n            pen = this.pens[i];\r\n            penTxt = (!wrap) ? pen.plainText : pen.wrapText;\r\n            currentProp = pen.prop;\r\n            penStartIdx = pen.startIndex;\r\n\r\n            isInRange = (penStartIdx >= start) && (penEndIdx <= end);\r\n            if (!isInRange) {\r\n                penTxt = penTxt.substring(start - penStartIdx, end - penStartIdx);\r\n            }\r\n\r\n            if (this.tagToTextScope) {\r\n                txt += this.tagToText.call(this.tagToTextScope, penTxt, currentProp, previousProp);\r\n            } else {\r\n                txt += this.tagToText(penTxt, currentProp, previousProp);\r\n            }\r\n\r\n            previousProp = currentProp;\r\n            if (penEndIdx >= end) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return txt;\r\n    }\r\n};\r\n\r\nvar PEN_CONFIG = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PenManager);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/penmanger/PenManager.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/render/CanvasRenderer.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * Renders this Game Object with the Canvas Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Text#renderCanvas\r\n * @since 3.0.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.Canvas.CanvasRenderer} renderer - A reference to the current active Canvas renderer.\r\n * @param {Phaser.GameObjects.Text} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar TextCanvasRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    renderer.batchSprite(src, src.frame, camera, parentMatrix);\r\n};\r\n\r\nmodule.exports = TextCanvasRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/render/CanvasRenderer.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/render/Render.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./WebGLRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/render/WebGLRenderer.js");\n/* harmony import */ var _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CanvasRenderer.js */ "./lib/rexui/lib/plugins/gameobjects/text/textbase/render/CanvasRenderer.js");\n/* harmony import */ var _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/object/NOOP */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n\r\n\r\n\r\n\r\nvar renderWebGL = _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nvar renderCanvas = _utils_object_NOOP__WEBPACK_IMPORTED_MODULE_2__["default"];\r\n\r\nif (true) {\r\n    renderWebGL = _WebGLRenderer_js__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n}\r\n\r\nif (true) {\r\n    renderCanvas = _CanvasRenderer_js__WEBPACK_IMPORTED_MODULE_1___default.a;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    renderWebGL: renderWebGL,\r\n    renderCanvas: renderCanvas\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/render/Render.js?')},"./lib/rexui/lib/plugins/gameobjects/text/textbase/render/WebGLRenderer.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nvar Utils = Phaser.Renderer.WebGL.Utils;\r\n\r\n/**\r\n * Renders this Game Object with the WebGL Renderer to the given Camera.\r\n * The object will not render if any of its renderFlags are set or it is being actively filtered out by the Camera.\r\n * This method should not be called directly. It is a utility function of the Render module.\r\n *\r\n * @method Phaser.GameObjects.Text#renderWebGL\r\n * @since 3.0.0\r\n * @private\r\n *\r\n * @param {Phaser.Renderer.WebGL.WebGLRenderer} renderer - A reference to the current active WebGL renderer.\r\n * @param {Phaser.GameObjects.Text} src - The Game Object being rendered in this call.\r\n * @param {number} interpolationPercentage - Reserved for future use and custom pipelines.\r\n * @param {Phaser.Cameras.Scene2D.Camera} camera - The Camera that is rendering the Game Object.\r\n * @param {Phaser.GameObjects.Components.TransformMatrix} parentMatrix - This transform matrix is defined if the game object is nested\r\n */\r\nvar TextWebGLRenderer = function (renderer, src, interpolationPercentage, camera, parentMatrix) {\r\n    if ((src.width === 0) || (src.height === 0)) {\r\n        return;\r\n    }\r\n\r\n    var frame = src.frame;\r\n    var width = frame.width;\r\n    var height = frame.height;\r\n    var getTint = Utils.getTintAppendFloatAlpha;\r\n\r\n    this.pipeline.batchTexture(\r\n        src,\r\n        frame.glTexture,\r\n        width, height,\r\n        src.x, src.y,\r\n        width / src.style.resolution, height / src.style.resolution,\r\n        src.scaleX, src.scaleY,\r\n        src.rotation,\r\n        src.flipX, src.flipY,\r\n        src.scrollFactorX, src.scrollFactorY,\r\n        src.displayOriginX, src.displayOriginY,\r\n        0, 0, width, height,\r\n        getTint(src._tintTL, camera.alpha * src._alphaTL),\r\n        getTint(src._tintTR, camera.alpha * src._alphaTR),\r\n        getTint(src._tintBL, camera.alpha * src._alphaBL),\r\n        getTint(src._tintBR, camera.alpha * src._alphaBR),\r\n        (src._isTinted && src.tintFill),\r\n        0, 0,\r\n        camera,\r\n        parentMatrix\r\n    );\r\n};\r\n\r\nmodule.exports = TextWebGLRenderer;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/render/WebGLRenderer.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/MeasureText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\n\r\n/**\r\n * Calculates the ascent, descent and fontSize of a given font style.\r\n *\r\n * @function Phaser.GameObjects.Text.MeasureText\r\n * @since 3.0.0\r\n *\r\n * @param {Phaser.GameObjects.Text.TextStyle} textStyle - The TextStyle object to measure.\r\n *\r\n * @return {object} An object containing the ascent, descent and fontSize of the TextStyle.\r\n */\r\nvar MeasureText = function (textStyle) {\r\n    // @property {HTMLCanvasElement} canvas - The canvas element that the text is rendered.\r\n    var canvas = CanvasPool.create(this);\r\n\r\n    // @property {HTMLCanvasElement} context - The context of the canvas element that the text is rendered to.\r\n    var context = canvas.getContext('2d');\r\n\r\n    textStyle.syncFont(canvas, context);\r\n\r\n    var width = Math.ceil(context.measureText(textStyle.testString).width * textStyle.baselineX);\r\n    var baseline = width;\r\n    var height = 2 * baseline;\r\n\r\n    baseline = baseline * textStyle.baselineY | 0;\r\n\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    context.fillStyle = '#f00';\r\n    context.fillRect(0, 0, width, height);\r\n\r\n    context.font = textStyle._font;\r\n\r\n    context.textBaseline = 'alphabetic';\r\n    context.fillStyle = '#000';\r\n    context.fillText(textStyle.testString, 0, baseline);\r\n\r\n    var output = {\r\n        ascent: 0,\r\n        descent: 0,\r\n        fontSize: 0\r\n    };\r\n\r\n    if (!context.getImageData(0, 0, width, height)) {\r\n        output.ascent = baseline;\r\n        output.descent = baseline + 6;\r\n        output.fontSize = output.ascent + output.descent;\r\n\r\n        CanvasPool.remove(canvas);\r\n\r\n        return output;\r\n    }\r\n\r\n    var imagedata = context.getImageData(0, 0, width, height).data;\r\n    var pixels = imagedata.length;\r\n    var line = width * 4;\r\n    var i;\r\n    var j;\r\n    var idx = 0;\r\n    var stop = false;\r\n\r\n    // ascent. scan from top to bottom until we find a non red pixel\r\n    for (i = 0; i < baseline; i++) {\r\n        for (j = 0; j < line; j += 4) {\r\n            if (imagedata[idx + j] !== 255) {\r\n                stop = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!stop) {\r\n            idx += line;\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    output.ascent = baseline - i;\r\n\r\n    idx = pixels - line;\r\n    stop = false;\r\n\r\n    // descent. scan from bottom to top until we find a non red pixel\r\n    for (i = height; i > baseline; i--) {\r\n        for (j = 0; j < line; j += 4) {\r\n            if (imagedata[idx + j] !== 255) {\r\n                stop = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!stop) {\r\n            idx -= line;\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    output.descent = (i - baseline);\r\n    output.fontSize = output.ascent + output.descent;\r\n\r\n    CanvasPool.remove(canvas);\r\n\r\n    return output;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MeasureText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/MeasureText.js?")},"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _MeasureText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MeasureText.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/MeasureText.js\");\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../const.js */ \"./lib/rexui/lib/plugins/gameobjects/text/textbase/const.js\");\n/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n\r\n\r\n\r\nconst GetAdvancedValue = Phaser.Utils.Objects.GetAdvancedValue;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n//  Key: [ Object Key, Default Value ]\r\n\r\n/**\r\n * A custom function that will be responsible for wrapping the text.\r\n * @callback TextStyleWordWrapCallback\r\n *\r\n * @param {string} text - The string to wrap.\r\n * @param {Phaser.GameObjects.Text} textObject - The Text instance.\r\n *\r\n * @return {(string|string[])} Should return the wrapped lines either as an array of lines or as a string with\r\n * newline characters in place to indicate where breaks should happen.\r\n */\r\n\r\nvar propertyMap = {\r\n    // background\r\n    backgroundColor: ['backgroundColor', null],\r\n\r\n    // font\r\n    fontFamily: ['fontFamily', 'Courier'],\r\n    fontSize: ['fontSize', '16px'],\r\n    fontStyle: ['fontStyle', ''],\r\n    color: ['color', '#fff'],\r\n    stroke: ['stroke', '#fff'],\r\n    strokeThickness: ['strokeThickness', 0],\r\n    shadowOffsetX: ['shadow.offsetX', 0],\r\n    shadowOffsetY: ['shadow.offsetY', 0],\r\n    shadowColor: ['shadow.color', '#000'],\r\n    shadowBlur: ['shadow.blur', 0],\r\n    shadowStroke: ['shadow.stroke', false],\r\n    shadowFill: ['shadow.fill', false],\r\n\r\n    // underline\r\n    underlineColor: ['underline.color', '#000'],\r\n    underlineThickness: ['underline.thickness', 0],\r\n    underlineOffset: ['underline.offset', 0],\r\n\r\n    // align\r\n    halign: ['halign', 'left'],\r\n    valign: ['valign', 'top'],\r\n\r\n    // size\r\n    maxLines: ['maxLines', 0],\r\n    fixedWidth: ['fixedWidth', 0],\r\n    fixedHeight: ['fixedHeight', 0],\r\n    resolution: ['resolution', 0],\r\n    lineSpacing: ['lineSpacing', 0],\r\n\r\n    rtl: ['rtl', false],\r\n    testString: ['testString', '|MÃ‰qgy'],\r\n    baselineX: ['baselineX', 1.2],\r\n    baselineY: ['baselineY', 1.4],\r\n\r\n    // wrap\r\n    wrapMode: ['wrap.mode', 1],\r\n    wrapWidth: ['wrap.width', 0]\r\n    //wrapCallback: ['wrap.callback', null],\r\n    //wrapCallbackScope: ['wrap.callbackScope', null]\r\n};\r\n\r\nclass TextStyle {\r\n    constructor(text, style) {\r\n        this.parent = text;\r\n\r\n        this.backgroundColor;\r\n\r\n        this.fontFamily;\r\n        this.fontSize;\r\n        this.fontStyle;\r\n        this.color;\r\n        this.stroke;\r\n        this.strokeThickness;\r\n        this.shadowOffsetX;\r\n        this.shadowOffsetY;\r\n        this.shadowColor;\r\n        this.shadowBlur;\r\n        this.shadowStroke;\r\n        this.shadowFill;\r\n\r\n        this.underlineColor;\r\n        this.underlineThickness;\r\n        this.underlineOffset;\r\n\r\n        this.halign;\r\n        this.valign;\r\n\r\n        this.maxLines;\r\n        this.fixedWidth;\r\n        this.fixedHeight;\r\n        this.resolution;\r\n        this.lineSpacing;\r\n\r\n        this.rtl;\r\n        this.testString;\r\n\r\n\r\n        this.baselineX;\r\n        this.baselineY;\r\n\r\n        this._font;\r\n\r\n        //  Set to defaults + user style\r\n        this.setStyle(style, false);\r\n\r\n        var metrics = GetValue(style, 'metrics', false);\r\n\r\n        //  Provide optional TextMetrics in the style object to avoid the canvas look-up / scanning\r\n        //  Doing this is reset if you then change the font of this TextStyle after creation\r\n        if (metrics) {\r\n            this.metrics = {\r\n                ascent: GetValue(metrics, 'ascent', 0),\r\n                descent: GetValue(metrics, 'descent', 0),\r\n                fontSize: GetValue(metrics, 'fontSize', 0)\r\n            };\r\n        } else {\r\n            this.metrics = Object(_MeasureText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this);\r\n        }\r\n    }\r\n\r\n    setStyle(style, updateText) {\r\n        if (updateText === undefined) {\r\n            updateText = true;\r\n        }\r\n\r\n        if (style && style.hasOwnProperty('wrap')) {\r\n            var wrap = style.wrap;\r\n            if (wrap.hasOwnProperty('mode')) {\r\n                var mode = wrap.mode;\r\n                if (typeof mode === 'string') {\r\n                    wrap.mode = WRAPMODE[mode];\r\n                }\r\n            } else {\r\n                if (wrap.hasOwnProperty('width')) {\r\n                    wrap.mode = 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        //  Avoid type mutation\r\n        if (style && style.hasOwnProperty('fontSize') && typeof style.fontSize === 'number') {\r\n            style.fontSize = style.fontSize.toString() + 'px';\r\n        }\r\n\r\n        for (var key in propertyMap) {\r\n            if (key === 'wrapCallback' || key === 'wrapCallbackScope') {\r\n                // Callback & scope should be set without processing the values\r\n                this[key] = GetValue(style, propertyMap[key][0], propertyMap[key][1]);\r\n            } else {\r\n                this[key] = GetAdvancedValue(style, propertyMap[key][0], propertyMap[key][1]);\r\n            }\r\n        }\r\n\r\n        //  Allow for 'font' override\r\n        var font = GetValue(style, 'font', null);\r\n\r\n        if (font === null) {\r\n            this._font = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n        } else {\r\n            this._font = font;\r\n        }\r\n\r\n        //  Allow for 'fill' to be used in place of 'color'\r\n        var fill = GetValue(style, 'fill', null);\r\n\r\n        if (fill !== null) {\r\n            this.color = fill;\r\n        }\r\n\r\n        if (updateText) {\r\n            return this.update(true);\r\n        } else {\r\n            return this.parent;\r\n        }\r\n    }\r\n\r\n    syncFont(canvas, context) {\r\n        context.font = this._font;\r\n    }\r\n\r\n    syncStyle(canvas, context) {\r\n        context.textBaseline = 'alphabetic';\r\n\r\n        context.fillStyle = this.color;\r\n        context.strokeStyle = this.stroke;\r\n\r\n        context.lineWidth = this.strokeThickness;\r\n        context.lineCap = 'round';\r\n        context.lineJoin = 'round';\r\n    }\r\n\r\n    syncShadow(context, enabled) {\r\n        if (enabled) {\r\n            context.shadowOffsetX = this.shadowOffsetX;\r\n            context.shadowOffsetY = this.shadowOffsetY;\r\n            context.shadowColor = this.shadowColor;\r\n            context.shadowBlur = this.shadowBlur;\r\n        } else {\r\n            context.shadowOffsetX = 0;\r\n            context.shadowOffsetY = 0;\r\n            context.shadowColor = 0;\r\n            context.shadowBlur = 0;\r\n        }\r\n    }\r\n\r\n    update(recalculateMetrics) {\r\n        if (recalculateMetrics) {\r\n            this._font = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n\r\n            this.metrics = Object(_MeasureText_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this);\r\n        }\r\n\r\n        return this.parent.updateText(recalculateMetrics);\r\n    }\r\n\r\n    buildFont() {\r\n        var newFont = this.fontStyle + ' ' + this.fontSize + ' ' + this.fontFamily;\r\n        if (newFont !== this._font) {\r\n            this._font = newFont;\r\n            //this.metrics = MeasureText(this);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    setFont(font) {\r\n        if (typeof font === 'string') {\r\n            this.fontFamily = font;\r\n            this.fontSize = '';\r\n            this.fontStyle = '';\r\n        } else {\r\n            this.fontFamily = GetValue(font, 'fontFamily', 'Courier');\r\n            this.fontSize = GetValue(font, 'fontSize', '16px');\r\n            this.fontStyle = GetValue(font, 'fontStyle', '');\r\n        }\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontFamily(family) {\r\n        this.fontFamily = family;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontStyle(style) {\r\n        this.fontStyle = style;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFontSize(size) {\r\n        if (typeof size === 'number') {\r\n            size = size.toString() + 'px';\r\n        }\r\n\r\n        this.fontSize = size;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setTestString(string) {\r\n        this.testString = string;\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setFixedSize(width, height) {\r\n        this.fixedWidth = width;\r\n        this.fixedHeight = height;\r\n\r\n        if (width) {\r\n            this.parent.width = width;\r\n        }\r\n\r\n        if (height) {\r\n            this.parent.height = height;\r\n        }\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setResolution(value) {\r\n        this.resolution = value;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setLineSpacing(value) {\r\n        this.lineSpacing = value;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setBackgroundColor(color) {\r\n        this.backgroundColor = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setFill(color) {\r\n        this.color = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setStroke(color, thickness) {\r\n        if (color === undefined) {\r\n            //  Reset the stroke to zero (disabling it)\r\n            this.strokeThickness = 0;\r\n        } else {\r\n            if (thickness === undefined) {\r\n                thickness = this.strokeThickness;\r\n            }\r\n\r\n            this.stroke = color;\r\n            this.strokeThickness = thickness;\r\n        }\r\n\r\n        return this.update(true);\r\n    }\r\n\r\n    setShadow(x, y, color, blur, shadowStroke, shadowFill) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n        if (blur === undefined) {\r\n            blur = 0;\r\n        }\r\n        if (shadowStroke === undefined) {\r\n            shadowStroke = false;\r\n        }\r\n        if (shadowFill === undefined) {\r\n            shadowFill = true;\r\n        }\r\n\r\n        this.shadowOffsetX = x;\r\n        this.shadowOffsetY = y;\r\n        this.shadowColor = color;\r\n        this.shadowBlur = blur;\r\n        this.shadowStroke = shadowStroke;\r\n        this.shadowFill = shadowFill;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowOffset(x, y) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = x;\r\n        }\r\n\r\n        this.shadowOffsetX = x;\r\n        this.shadowOffsetY = y;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowColor(color) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n\r\n        this.shadowColor = color;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowBlur(blur) {\r\n        if (blur === undefined) {\r\n            blur = 0;\r\n        }\r\n\r\n        this.shadowBlur = blur;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowStroke(enabled) {\r\n        this.shadowStroke = enabled;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setShadowFill(enabled) {\r\n        this.shadowFill = enabled;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderline(color, thickness, offset) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n        if (thickness === undefined) {\r\n            thickness = 0;\r\n        }\r\n        if (offset === undefined) {\r\n            offset = 0;\r\n        }\r\n\r\n        this.underlineColor = color;\r\n        this.underlineThickness = thickness;\r\n        this.underlineOffset = offset;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineColor(color) {\r\n        if (color === undefined) {\r\n            color = '#000';\r\n        }\r\n\r\n        this.underlineColor = color;\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineThickness(thickness) {\r\n        if (thickness === undefined) {\r\n            thickness = 0;\r\n        }\r\n\r\n        this.underlineThickness = thickness;\r\n        return this.update(false);\r\n    }\r\n\r\n    setUnderlineOffset(offset) {\r\n        if (offset === undefined) {\r\n            offset = 0;\r\n        }\r\n\r\n        this.underlineOffset = offset;\r\n        return this.update(false);\r\n    }\r\n\r\n    setWrapMode(mode) {\r\n        if (typeof mode === 'string') {\r\n            mode = WRAPMODE[mode.toLowerCase()] || 0;\r\n        }\r\n        this.wrapMode = mode;\r\n        return this.update(true);\r\n    }\r\n\r\n    setWrapWidth(width) {\r\n        this.wrapWidth = width;\r\n        return this.update(false);\r\n    }\r\n\r\n    setAlign(halign, valign) {\r\n        if (halign === undefined) {\r\n            halign = 'left';\r\n        }\r\n        if (valign === undefined) {\r\n            valign = 'top';\r\n        }\r\n        this.halign = halign;\r\n        this.valign = valign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setHAlign(halign) {\r\n        if (halign === undefined) {\r\n            halign = 'left';\r\n        }\r\n        this.halign = halign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setVAlign(valign) {\r\n        if (valign === undefined) {\r\n            valign = 'top';\r\n        }\r\n        this.valign = valign;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    setMaxLines(max) {\r\n        if (max === undefined) {\r\n            max = 0;\r\n        }\r\n\r\n        this.maxLines = max;\r\n\r\n        return this.update(false);\r\n    }\r\n\r\n    getTextMetrics() {\r\n        var metrics = this.metrics;\r\n\r\n        return {\r\n            ascent: metrics.ascent,\r\n            descent: metrics.descent,\r\n            fontSize: metrics.fontSize\r\n        };\r\n    }\r\n\r\n    get lineHeight() {\r\n        return this.metrics.fontSize + this.strokeThickness + this.lineSpacing;\r\n    }\r\n\r\n    toJSON() {\r\n        var output = {};\r\n\r\n        for (var key in propertyMap) {\r\n            output[key] = this[key];\r\n        }\r\n\r\n        output.metrics = this.getTextMetrics();\r\n\r\n        return output;\r\n    }\r\n\r\n    destroy() {\r\n        this.parent = undefined;\r\n    }\r\n\r\n}\r\n\r\nconst HALIGNMODE = {\r\n    left: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hleft,\r\n    center: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hcenter,\r\n    right: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].hright,\r\n};\r\nconst VALIGNMODE = {\r\n    top: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vtop,\r\n    center: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vcenter,\r\n    bottom: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].vbottom,\r\n};\r\nconst WRAPMODE = {\r\n    none: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].NO_WRAP,\r\n    word: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].WORD_WRAP,\r\n    char: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].CHAR_WRAP,\r\n    character: _const_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].CHAR_WRAP\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextStyle);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/gameobjects/text/textbase/textstyle/TextStyle.js?")},"./lib/rexui/lib/plugins/input/button/Button.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Button {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.pointer = undefined;\r\n        this.lastClickTime = undefined;\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.setMode(GetValue(o, \"mode\", 1));\r\n        this.setClickInterval(GetValue(o, \"clickInterval\", 100));\r\n        this.setDragThreshold(GetValue(o, 'threshold', undefined));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('pointerdown', this.onPress, this);\r\n        this.gameObject.on('pointerup', this.onRelease, this);\r\n        this.gameObject.on('pointerout', this.onPointOut, this);\r\n        this.gameObject.on('pointermove', this.onMove, this);\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.pointer = undefined;\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        // gameObject events will be removed when this gameObject destroyed \r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.cancel();\r\n        }\r\n        this.enable = e;\r\n        this.gameObject.input.enabled = e;\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = CLICKMODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setClickInterval(interval) {\r\n        this.clickInterval = interval; // ms\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    // internal\r\n    onPress(pointer, localX, localY, event) {\r\n        if (this.pointer !== undefined) {\r\n            return;\r\n        }\r\n        this.pointer = pointer;\r\n        if (this.mode === 0) {\r\n            this.click(pointer.downTime, pointer, event);\r\n        }\r\n    }\r\n\r\n    onRelease(pointer, localX, localY, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        if (this.mode === 1) {\r\n            this.click(pointer.upTime, pointer, event);\r\n        }\r\n        this.pointer = undefined;\r\n    }\r\n\r\n    onPointOut(pointer, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        this.cancel();\r\n    }\r\n\r\n    onMove(pointer, localX, localY, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n\r\n        if (this.dragThreshold === undefined) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.getDistance() >= this.dragThreshold) {\r\n            this.cancel();\r\n        }\r\n    }\r\n\r\n    click(nowTime, pointer, event) {\r\n        if (nowTime === undefined) {\r\n            // fires 'click' event manually\r\n            this.emit('click', this, this.gameObject, pointer, event);\r\n            return this;\r\n        }\r\n\r\n        this.pointer = undefined;\r\n        var lastClickTime = this.lastClickTime;\r\n        if ((lastClickTime !== undefined) &&\r\n            ((nowTime - lastClickTime) <= this.clickInterval)) {\r\n            return this;\r\n        }\r\n        this.lastClickTime = nowTime;\r\n        this.emit('click', this, this.gameObject, pointer, event);\r\n        return this;\r\n    }\r\n\r\n    cancel() {\r\n        this.pointer = undefined;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Button.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nconst CLICKMODE = {\r\n    'press': 0,\r\n    'pointerdown': 0,\r\n    'release': 1,\r\n    'pointerup': 1,\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Button);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/button/Button.js?")},"./lib/rexui/lib/plugins/input/dragspeed/DragSpeed.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\n\r\nclass DragSpeed {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.pointer = undefined;\r\n        this.isInTouched = false;\r\n        this.holdStartTime = undefined;\r\n        this.x = undefined;\r\n        this.y = undefined;\r\n        this.preX = undefined;\r\n        this.preY = undefined;\r\n        this.localX = undefined;\r\n        this.localY = undefined;\r\n        this.justMoved = false;\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.holdThreshold = GetValue(o, \"holdThreshold\", 50); // ms\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('pointerdown', this.onPointIn, this);\r\n        this.gameObject.on('pointerover', this.onPointIn, this);\r\n        this.gameObject.on('pointerup', this.onPointOut, this);\r\n        this.gameObject.on('pointerout', this.onPointOut, this);\r\n        this.gameObject.on('pointermove', this.onPointerMove, this);\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n        this.scene.events.on('preupdate', this.preupdate, this);\r\n    }\r\n\r\n    shutdown() {\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('preupdate', this.preupdate, this);\r\n        }\r\n        this.pointer = undefined;\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        // GameObject events will be removed when this gameObject destroyed \r\n        this.destroyEventEmitter();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.isInTouched = false;\r\n            this.pointer = undefined;\r\n        }\r\n        this.enable = e;\r\n        this.gameObject.input.enabled = e;\r\n        return this;\r\n    }\r\n\r\n    get isDown() {\r\n        return this.pointer && this.pointer.isDown;\r\n    }\r\n\r\n    get isUp() {\r\n        return !this.isDown;\r\n    }\r\n\r\n    get dx() {\r\n        return this.x - this.preX;\r\n    }\r\n\r\n    get dy() {\r\n        return this.y - this.preY;\r\n    }\r\n\r\n    get dt() {\r\n        var game = this.scene.sys.game;\r\n        var delta = game.loop.delta;\r\n        return delta;\r\n    }\r\n\r\n    get speed() {\r\n        if ((this.x === this.preX) && (this.y === this.preY)) {\r\n            return 0;\r\n        }\r\n        var d = DistanceBetween(this.preX, this.preY, this.x, this.y);\r\n        var speed = d / (this.dt * 0.001);\r\n        return speed;\r\n    }\r\n\r\n    get speedX() {\r\n        return this.dx / (this.dt * 0.001);\r\n    }\r\n\r\n    get speedY() {\r\n        return this.dy / (this.dt * 0.001);\r\n    }\r\n\r\n    // internal\r\n    onPointIn(pointer, localX, localY) {\r\n        if (!pointer.isDown ||\r\n            (this.pointer !== undefined)) {\r\n            return;\r\n        }\r\n        this.pointer = pointer;\r\n        this.localX = localX;\r\n        this.localY = localY;\r\n    }\r\n\r\n    onPointOut(pointer) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        this.pointer = undefined;\r\n    }\r\n\r\n    onPointerMove(pointer, localX, localY) {\r\n        if (!pointer.isDown ||\r\n            (this.pointer !== pointer)) {\r\n            return;\r\n        }\r\n        this.localX = localX;\r\n        this.localY = localY;\r\n    }\r\n\r\n    preupdate(time, delta) {\r\n        var pointer = this.pointer;\r\n        this.justMoved = false;\r\n        if (pointer && (!this.isInTouched)) {\r\n            // Touch start\r\n            this.x = pointer.x;\r\n            this.y = pointer.y;\r\n            this.preX = pointer.x;\r\n            this.preY = pointer.y;\r\n            this.isInTouched = true;\r\n            this.holdStartTime = undefined;\r\n            this.emit('touchstart', pointer, this.localX, this.localY);\r\n\r\n        } else if (pointer && this.isInTouched) {\r\n            // In touch\r\n            if ((this.x === pointer.x) && (this.y === pointer.y)) {\r\n                // Hold\r\n                if (this.holdStartTime === undefined) {\r\n                    this.holdStartTime = time;\r\n                } else if (time - this.holdStartTime > this.holdThreshold) {\r\n                    this.preX = this.x;\r\n                    this.preY = this.y;\r\n                }\r\n            } else {\r\n                // Move\r\n                this.preX = this.x;\r\n                this.preY = this.y;\r\n                this.x = pointer.x;\r\n                this.y = pointer.y;\r\n                this.holdStartTime = undefined;\r\n                this.justMoved = true;\r\n                this.emit('touchmove', pointer, this.localX, this.localY);\r\n            }\r\n\r\n        } else if ((!pointer) && this.isInTouched) {\r\n            // Touch end\r\n            this.isInTouched = false;\r\n            this.holdStartTime = undefined;\r\n            this.emit('touchend', pointer);\r\n\r\n        }\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    DragSpeed.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (DragSpeed);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/dragspeed/DragSpeed.js?")},"./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/ticktask/TickTask.js */ \"./lib/rexui/lib/plugins/utils/ticktask/TickTask.js\");\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/system/GetSceneObject.js */ \"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass OnePointerTracer extends _utils_ticktask_TickTask_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        var scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(gameObject);\r\n        if (scene === gameObject) {\r\n            gameObject = undefined;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.scene = scene;\r\n        this.gameObject = gameObject;\r\n        if (gameObject) {\r\n            gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        }\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n\r\n        if (this.gameObject === undefined) {\r\n            this.bounds = GetValue(o, 'bounds', undefined);\r\n        } else {\r\n            this.bounds = undefined;\r\n        }\r\n\r\n        this.tracerState = TOUCH0;\r\n        // this.recongizedState = new stateClass(this);\r\n        this.pointer = undefined;\r\n        this.lastPointer = undefined; // Last catched pointer\r\n        this.movedState = false;\r\n        this.isTouchingAnyObject = false;\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        super.boot();\r\n        if (this.gameObject) {\r\n            this.gameObject.on('pointerdown', this.onPointerDown, this);\r\n        } else {\r\n            this.scene.input.on('pointerdown', this.onPointerDown, this);\r\n        }\r\n        this.scene.input.on('pointerup', this.onPointerUp, this);\r\n        this.scene.input.on('pointermove', this.onPointerMove, this);\r\n        this.scene.events.once('shutdown', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        if (this.gameObject) {\r\n            this.gameObject.off('pointerdown', this.onPointerDown, this);\r\n        } else if (this.scene) {\r\n            this.scene.input.off('pointerdown', this.onPointerDown, this);\r\n        }\r\n        if (this.scene) {\r\n            this.scene.input.off('pointerup', this.onPointerUp, this);\r\n            this.scene.input.off('pointermove', this.onPointerMove, this);\r\n            this.scene.events.off('destroy', this.destroy, this);\r\n            this.scene = undefined;\r\n        }\r\n\r\n        this.scene = undefined;\r\n        this.gameObject = undefined;\r\n        this.bounds = undefined;\r\n        this.pointer = undefined;\r\n        this.lastPointer = undefined; // Last catched pointer\r\n        this.movedState = false;\r\n        super.shutdown();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.dragCancel();\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    onPointerDown(pointer, gameObjects) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer !== undefined) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer === pointer) {\r\n            return;\r\n        }\r\n\r\n        this.pointer = pointer;\r\n        this.lastPointer = pointer;\r\n        this.movedState = false;\r\n        this.tracerState = TOUCH1;\r\n\r\n        if (this.gameObject === undefined) {\r\n            this.isTouchingAnyObject = (gameObjects.length > 0);\r\n        }\r\n        this.onDragStart();\r\n    }\r\n\r\n    onPointerUp(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n\r\n        this.pointer = undefined;\r\n        this.movedState = false;\r\n        this.tracerState = TOUCH0;\r\n        this.onDragEnd();\r\n    }\r\n\r\n    onPointerMove(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.isDown) {\r\n            var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            var isCatchedPointer = (this.pointer === pointer);\r\n            if (!isCatchedPointer && isInsideBounds) { // Pointer moves into bounds\r\n                // this.onPointerDown(pointer);\r\n            } else if (isCatchedPointer && !isInsideBounds) { // Pointer moves out of bounds\r\n                this.onPointerUp(pointer);\r\n            } else { // Pointer drags in bounds\r\n                if (!this.movedState) {\r\n                    this.movedState = (pointer.x !== pointer.downX) || (pointer.y !== pointer.downY);\r\n                }\r\n                if (this.movedState) {\r\n                    this.onDrag();\r\n                }\r\n            }\r\n        } else {\r\n            // var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            // var isLastCatchedPointer = (this.lastPointer === pointer);\r\n            // if (isLastCatchedPointer && isInsideBounds) {\r\n            //     this.onLastPointerMove();\r\n            // }\r\n        }\r\n    }\r\n\r\n    dragCancel() {\r\n        if (this.tracerState === TOUCH1) {\r\n            this.onDragEnd();\r\n        }\r\n        this.pointer = undefined;\r\n        this.tracerState = TOUCH0;\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.emit('dragstart', this);\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.emit('dragend', this);\r\n    }\r\n\r\n    onDrag() {\r\n        this.emit('drag', this);\r\n    }\r\n\r\n    // onLastPointerMove() { }\r\n\r\n    preUpdate(time, delta) { }\r\n\r\n    postUpdate(time, delta) { }\r\n\r\n    startTicking() {\r\n        super.startTicking();\r\n        this.scene.events.on('preupdate', this.preUpdate, this);\r\n        this.scene.events.on('postupdate', this.postUpdate, this);\r\n    }\r\n\r\n    stopTicking() {\r\n        super.stopTicking();\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('preupdate', this.preUpdate, this);\r\n            this.scene.events.off('postupdate', this.postUpdate, this);\r\n        }\r\n    }\r\n\r\n    setRecongizedStateObject(stateObject) {\r\n        this.recongizedState = stateObject;\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this.recongizedState.state;\r\n    }\r\n\r\n    set state(newState) {\r\n        this.recongizedState.state = newState;\r\n    }\r\n\r\n    cancel() {\r\n        this.state = IDLE;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst TOUCH0 = 0;\r\nconst TOUCH1 = 1;\r\n\r\nconst IDLE = 'IDLE';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (OnePointerTracer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js?")},"./lib/rexui/lib/plugins/input/gestures/pan/Pan.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Pan extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        var pointer = self.pointer;\r\n                        self.startX = pointer.x;\r\n                        self.startY = pointer.y;\r\n                        self.startWorldX = pointer.worldX;\r\n                        self.startWorldY = pointer.worldY;\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('panstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.endX = pointer.x;\r\n                        self.endY = pointer.y;\r\n                        self.endWorldX = pointer.worldX;\r\n                        self.endWorldY = pointer.worldY;\r\n                        self.emit('panend', self, self.gameObject, self.lastPointer);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 10));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = (this.dragThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if (this.pointer.getDistance() >= this.dragThreshold) {\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n\r\n            case RECOGNIZED:\r\n                var p1 = this.pointer.position;\r\n                var p0 = this.pointer.prevPosition;\r\n                this.dx = p1.x - p0.x;\r\n                this.dy = p1.y - p0.y;\r\n                var pointer = this.pointer;\r\n                self.x = pointer.x;\r\n                self.y = pointer.y;\r\n                self.worldX = pointer.worldX;\r\n                self.worldY = pointer.worldY;\r\n                this.emit('pan', this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isPan() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pan);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/pan/Pan.js?")},"./lib/rexui/lib/plugins/input/gestures/pinch/Pinch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../twopointerstracer/TwoPointersTracer.js */ \"./lib/rexui/lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Pinch extends _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        super(scene, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.prevDistance = undefined;\r\n                        self.scaleFactor = 1;\r\n                    },\r\n                },\r\n                BEGIN: {\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('pinchstart', self);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('pinchend', self);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 0));\r\n        return this;\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.scaleFactor = 1;\r\n        this.prevDistance = this.distanceBetween;\r\n        this.state = (this.dragThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag2() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if ((this.pointers[0].getDistance() >= this.dragThreshold) &&\r\n                    (this.pointers[1].getDistance() >= this.dragThreshold)) {\r\n                    var curDistance = this.distanceBetween;\r\n                    this.scaleFactor = curDistance / this.prevDistance;\r\n                    this.prevDistance = curDistance;\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n            case RECOGNIZED:\r\n                var curDistance = this.distanceBetween;\r\n                this.scaleFactor = curDistance / this.prevDistance;\r\n                this.emit('pinch', this);\r\n                this.prevDistance = curDistance;\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isPinch() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Pinch);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/pinch/Pinch.js?")},"./lib/rexui/lib/plugins/input/gestures/press/Press.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Press extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.x = 0;\r\n                        self.y = 0;\r\n                        self.worldX = 0;\r\n                        self.worldY = 0;\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.x = pointer.x;\r\n                        self.y = pointer.y;\r\n                        self.worldX = pointer.worldX;\r\n                        self.worldY = pointer.worldY;\r\n                    }\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.start();\r\n                    },\r\n                    exit: function () {\r\n                        self.stop();\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('pressstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('pressend', self, self.gameObject, self.lastPointer);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 9));\r\n        this.setMinHoldTime(GetValue(o, 'time', 251));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = (this.holdTime === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === IDLE) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer.getDistance() > this.dragThreshold) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    preUpdate(time, delta) {\r\n        if (this.state === BEGIN) {\r\n            var holdTime = time - this.pointer.downTime;\r\n            if (holdTime >= this.holdTime) {\r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    get isPressed() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setMinHoldTime(time) {\r\n        this.holdTime = time; // ms\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Press);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/press/Press.js?")},"./lib/rexui/lib/plugins/input/gestures/rotate/Rotate.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../twopointerstracer/TwoPointersTracer.js */ \"./lib/rexui/lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n/* harmony import */ var _SpinObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SpinObject.js */ \"./lib/rexui/lib/plugins/input/gestures/rotate/SpinObject.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst WrapDegrees = Phaser.Math.Angle.WrapDegrees; // Wrap degrees: -180 to 180 \r\nconst ShortestBetween = Phaser.Math.Angle.ShortestBetween;\r\nconst RadToDeg = Phaser.Math.RadToDeg;\r\nconst DegToRad = Phaser.Math.DegToRad;\r\n\r\nclass Rotate extends _twopointerstracer_TwoPointersTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        super(scene, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.prevAngle = undefined;\r\n                        self.angle = 0;\r\n                    },\r\n                },\r\n                BEGIN: {\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('rotatestart', self);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('rotateend', self);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 0));\r\n        return this;\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.prevAngle = WrapDegrees(RadToDeg(this.angleBetween)); // Degrees\r\n        this.state = (this.rotationThreshold === 0) ? RECOGNIZED : BEGIN;\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag2() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if ((this.pointers[0].getDistance() >= this.dragThreshold) &&\r\n                    (this.pointers[1].getDistance() >= this.dragThreshold)) {\r\n                    var curAngle = WrapDegrees(RadToDeg(this.angleBetween));\r\n                    this.angle = ShortestBetween(this.prevAngle, curAngle);\r\n                    this.prevAngle = curAngle;\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n            case RECOGNIZED:\r\n                var curAngle = WrapDegrees(RadToDeg(this.angleBetween));\r\n                this.angle = ShortestBetween(this.prevAngle, curAngle);\r\n                this.prevAngle = curAngle;\r\n                this.emit('rotate', this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isRotation() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    get rotation() {\r\n        return DegToRad(this.angle);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n}\r\n\r\nvar methods = {\r\n    spinObject: _SpinObject_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\r\n};\r\nObject.assign(\r\n    Rotate.prototype,\r\n    methods\r\n);\r\n\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Rotate);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/rotate/Rotate.js?")},"./lib/rexui/lib/plugins/input/gestures/rotate/SpinObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/actions/RotateObjectAround.js */ "./lib/rexui/lib/plugins/utils/actions/RotateObjectAround.js");\n\r\n\r\nvar SpinObject = function (gameObject, camera) {\r\n    if (!this.isRotation) {\r\n        return this;\r\n    }\r\n\r\n    if (camera === undefined) {\r\n        camera = this.pointers[0].camera;\r\n    }\r\n\r\n    var movementX = this.movementCenterX,\r\n        movementY = this.movementCenterY;\r\n\r\n    camera.getWorldPoint(this.centerX, this.centerY, tmpPos);\r\n    var centerWorldX = tmpPos.x;\r\n    var centerWorldY = tmpPos.y;\r\n\r\n    var angle = this.rotation;\r\n    if (Array.isArray(gameObject)) {\r\n        var gameObjects = gameObject;\r\n        for (var i = 0, cnt = gameObjects.length; i < cnt; i++) {\r\n            gameObject = gameObjects[i];\r\n            gameObject.x += movementX;\r\n            gameObject.y += movementY;\r\n            Object(_utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, centerWorldX, centerWorldY, angle);\r\n        }\r\n    } else {\r\n        gameObject.x += movementX;\r\n        gameObject.y += movementY;\r\n        Object(_utils_actions_RotateObjectAround_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, x, y, angle);\r\n    }\r\n    return this;\r\n}\r\n\r\nvar tmpPos = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SpinObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/rotate/SpinObject.js?')},"./lib/rexui/lib/plugins/input/gestures/swipe/Swipe.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ "./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ "./lib/rexui/lib/plugins/fsm.js");\n/* harmony import */ var _VelocityMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VelocityMethods.js */ "./lib/rexui/lib/plugins/input/gestures/swipe/VelocityMethods.js");\n/* harmony import */ var _utils_math_angle_angletodirections_Const_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/math/angle/angletodirections/Const.js */ "./lib/rexui/lib/plugins/utils/math/angle/angletodirections/Const.js");\n/* harmony import */ var _utils_math_angle_angletodirections_AngleToDirections_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/math/angle/angletodirections/AngleToDirections.js */ "./lib/rexui/lib/plugins/utils/math/angle/angletodirections/AngleToDirections.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RadToDeg = Phaser.Math.RadToDeg;\r\n\r\nclass Swipe extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.x = 0;\r\n                        self.y = 0;\r\n                        self.worldX = 0;\r\n                        self.worldY = 0;\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.x = pointer.x;\r\n                        self.y = pointer.y;\r\n                        self.worldX = pointer.worldX;\r\n                        self.worldY = pointer.worldY;\r\n                    }\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.validDrag = false;\r\n                    }\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.updateDirectionStates();\r\n                        self.emit(\'swipe\', self, self.gameObject, self.lastPointer);\r\n                    },\r\n\r\n                    exit: function () {\r\n                        self.stop();\r\n                        self.clearDirectionStates();\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__["default"](stateConfig));\r\n        this.clearDirectionStates();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, \'threshold\', 10));\r\n        this.setMinDragVelocity(GetValue(o, \'velocityThreshold\', 1000));\r\n        this.setDirectionMode(GetValue(o, \'dir\', \'8dir\'));\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        this.state = BEGIN;\r\n    }\r\n\r\n    onDragEnd() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === BEGIN) {\r\n            if (!this.vaildDrag) {\r\n                this.vaildDrag = (this.dragThreshold === 0) || (this.pointer.getDistance() >= this.dragThreshold);\r\n            }\r\n            if (this.vaildDrag && (this.dragVelocity > this.minDragVelocity)) {\r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    postUpdate(time, delta) {\r\n        // Clear RECOGNIZED after update()\r\n        if (this.state === RECOGNIZED) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    get isSwiped() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    get dragVelocity() {\r\n        var velocity;\r\n        switch (this.dirMode) {\r\n            case 0: velocity = this.getVelocityY(); break; // up & down\r\n            case 1: velocity = this.getVelocityX(); break; // left & right\r\n            default: velocity = this.getVelocity(); break; // 4 dir, 8 dir\r\n        }\r\n        return velocity;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setMinDragVelocity(velocity) {\r\n        this.minDragVelocity = velocity;\r\n        return this;\r\n    }\r\n\r\n    setDirectionMode(m) {\r\n        if (typeof (m) === \'string\') {\r\n            m = _utils_math_angle_angletodirections_Const_js__WEBPACK_IMPORTED_MODULE_3__["default"][m];\r\n        }\r\n        this.dirMode = m;\r\n        return this;\r\n    }\r\n\r\n    updateDirectionStates() {\r\n        var angle = RadToDeg(this.getVelocityAngle());\r\n        Object(_utils_math_angle_angletodirections_AngleToDirections_js__WEBPACK_IMPORTED_MODULE_4__["default"])(angle, this.dirMode, this);\r\n        return this;\r\n    }\r\n\r\n    clearDirectionStates() {\r\n        this.left = false;\r\n        this.right = false;\r\n        this.up = false;\r\n        this.down = false;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Swipe.prototype,\r\n    _VelocityMethods_js__WEBPACK_IMPORTED_MODULE_2__["default"]\r\n);\r\n\r\nconst IDLE = \'IDLE\';\r\nconst BEGIN = \'BEGIN\';\r\nconst RECOGNIZED = \'RECOGNIZED\';\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Swipe);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/swipe/Swipe.js?')},"./lib/rexui/lib/plugins/input/gestures/swipe/VelocityMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\nconst AngleBetween = Phaser.Math.Angle.Between;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getDt: function () {\r\n        var game = this.scene.sys.game;\r\n        var dt = game.loop.delta;\r\n        return dt;\r\n    },\r\n\r\n    getVelocity: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = DistanceBetween(p0.x, p0.y, p1.x, p1.y);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityX: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = Math.abs(p1.x - p0.x);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityY: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var d = Math.abs(p1.y - p0.y);\r\n        var velocity = d / (this.getDt() * 0.001);\r\n        return velocity;\r\n    },\r\n\r\n    getVelocityAngle: function () {\r\n        var p1 = this.pointer.position;\r\n        var p0 = this.pointer.prevPosition;\r\n        var angle = AngleBetween(p0.x, p0.y, p1.x, p1.y);\r\n        return angle;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/swipe/VelocityMethods.js?')},"./lib/rexui/lib/plugins/input/gestures/tap/Tap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../onepointertracer/OnePointerTracer.js */ \"./lib/rexui/lib/plugins/input/gestures/onepointertracer/OnePointerTracer.js\");\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\n\r\nclass Tap extends _onepointertracer_OnePointerTracer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(gameObject, config) {\r\n        super(gameObject, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.stop();\r\n                        self.tapsCount = 0;\r\n                        self.x = 0;\r\n                        self.y = 0;\r\n                        self.worldX = 0;\r\n                        self.worldY = 0;\r\n                    },\r\n                    exit: function () {\r\n                        var pointer = self.lastPointer;\r\n                        self.x = pointer.x;\r\n                        self.y = pointer.y;\r\n                        self.worldX = pointer.worldX;\r\n                        self.worldY = pointer.worldY;\r\n                    }\r\n                },\r\n                BEGIN: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.tapsCount = 0;\r\n                        self.emit('tappingstart', self, self.gameObject, self.lastPointer);\r\n                    },\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.start();\r\n                        self.emit('tap', self, self.gameObject, self.lastPointer);\r\n                        self.emit(`${self.tapsCount}tap`, self, self.gameObject, self.lastPointer);\r\n                    },\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new _fsm_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setMaxHoldTime(GetValue(o, 'time', 250)); // min-hold-time of Press is 251\r\n        this.setTapInterval(GetValue(o, 'tapInterval', 200));\r\n        this.setDragThreshold(GetValue(o, 'threshold', 9));\r\n        this.setTapOffset(GetValue(o, 'tapOffset', 10));\r\n\r\n        var taps = GetValue(o, 'taps', undefined);\r\n        if (taps !== undefined) {\r\n            this.setTaps(taps);\r\n        } else {\r\n            this.setMaxTaps(GetValue(o, 'maxTaps', undefined));\r\n            this.setMinTaps(GetValue(o, 'minTaps', undefined));\r\n        }\r\n        return this;\r\n    }\r\n\r\n    onDragStart() {\r\n        switch (this.state) {\r\n            case IDLE:\r\n                this.state = BEGIN;\r\n                break;\r\n\r\n            case BEGIN:\r\n                var pointer = this.lastPointer;\r\n                var tapsOffset = DistanceBetween(\r\n                    pointer.upX,\r\n                    pointer.upY,\r\n                    pointer.x,\r\n                    pointer.y);\r\n                if (tapsOffset > this.tapOffset) { // Can't recognize next level, restart here\r\n                    this.state = RECOGNIZED;\r\n                    this.state = BEGIN;\r\n                }\r\n                break;\r\n\r\n            case RECOGNIZED:\r\n                this.state = BEGIN;\r\n                break;\r\n        }\r\n    }\r\n\r\n    onDragEnd() {\r\n        if (this.state === BEGIN) {\r\n            this.tapsCount++; // Try recognize next level\r\n            this.emit('tapping', this, this.gameObject, this.lastPointer);\r\n\r\n            if ((this.maxTaps !== undefined) && (this.tapsCount === this.maxTaps)) { // Reach to maxTaps, stop here                \r\n                this.state = RECOGNIZED;\r\n            }\r\n        }\r\n    }\r\n\r\n    onDrag() {\r\n        if (this.state === IDLE) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointer.getDistance() > this.dragThreshold) { // Cancel\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    preUpdate(time, delta) {\r\n        if (this.state === BEGIN) {\r\n            var pointer = this.lastPointer;\r\n            if (pointer.isDown) {\r\n                var holdTime = time - pointer.downTime;\r\n                if (holdTime > this.holdTime) {\r\n                    this.state = IDLE;\r\n                }\r\n            } else { // isUp\r\n                var releasedTime = time - pointer.upTime;\r\n                if (releasedTime > this.tapInterval) {\r\n                    if ((this.minTaps === undefined) || (this.tapsCount >= this.minTaps)) {\r\n                        this.state = RECOGNIZED;\r\n                    } else {\r\n                        this.state = IDLE;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    postUpdate(time, delta) {\r\n        // Clear RECOGNIZED after update()\r\n        if (this.state === RECOGNIZED) {\r\n            this.state = IDLE;\r\n        }\r\n    }\r\n\r\n    get isTapped() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setMaxHoldTime(time) {\r\n        this.holdTime = time; // ms\r\n        return this;\r\n    }\r\n\r\n    setTapInterval(time) {\r\n        this.tapInterval = time; // ms\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setTapOffset(distance) {\r\n        this.tapOffset = distance;\r\n        return this;\r\n    }\r\n\r\n    setMaxTaps(taps) {\r\n        this.maxTaps = taps;\r\n        return this;\r\n    }\r\n\r\n    setMinTaps(taps) {\r\n        this.minTaps = taps;\r\n        return this;\r\n    }\r\n\r\n    setTaps(minTaps, maxTaps) {\r\n        if (maxTaps === undefined) {\r\n            maxTaps = minTaps;\r\n        }\r\n        this.setMinTaps(minTaps).setMaxTaps(maxTaps);\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Tap);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/tap/Tap.js?")},"./lib/rexui/lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/object/Clear.js */ \"./lib/rexui/lib/plugins/utils/object/Clear.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst SpliceOne = Phaser.Utils.Array.SpliceOne;\r\nconst DistanceBetween = Phaser.Math.Distance.Between;\r\nconst AngleBetween = Phaser.Math.Angle.Between;\r\n\r\nclass TwoPointersTracer {\r\n    constructor(scene, config) {\r\n        var amount = scene.input.manager.pointersTotal - 1;\r\n        if (amount < 2) {\r\n            scene.input.addPointer(2 - amount);\r\n        }\r\n\r\n        this.scene = scene;\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n        this.pointers = [];\r\n        this.movedState = {};\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.bounds = GetValue(o, 'bounds', undefined);\r\n\r\n        this.tracerState = TOUCH0;\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scene.input.on('pointerdown', this.onPointerDown, this);\r\n        this.scene.input.on('pointerup', this.onPointerUp, this);\r\n        this.scene.input.on('pointermove', this.onPointerMove, this);\r\n        this.scene.events.once('shutdown', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        if (this.scene) {\r\n            this.scene.input.off('pointerdown', this.onPointerDown, this);\r\n            this.scene.input.off('pointerup', this.onPointerUp, this);\r\n            this.scene.input.off('pointermove', this.onPointerMove, this);\r\n            this.scene.events.off('destroy', this.destroy, this);\r\n            this.scene = undefined;\r\n        }\r\n        this.scene = undefined;\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        if (this.enable === e) {\r\n            return this;\r\n        }\r\n\r\n        if (!e) {\r\n            this.dragCancel();\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    onPointerDown(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (this.pointers.length === 2) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        var index = this.pointers.indexOf(pointer);\r\n        if (index !== -1) { // Already in catched pointers\r\n            return;\r\n        }\r\n\r\n        this.movedState[pointer.id] = false;\r\n        this.pointers.push(pointer);\r\n\r\n        switch (this.tracerState) {\r\n            case TOUCH0:\r\n                this.tracerState = TOUCH1;\r\n                this.onDrag1Start();\r\n                break;\r\n            case TOUCH1:\r\n                this.tracerState = TOUCH2;\r\n                this.onDrag2Start();\r\n                break;\r\n        }\r\n    }\r\n\r\n    onPointerUp(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n        if (!isInsideBounds) {\r\n            return;\r\n        }\r\n\r\n        var index = this.pointers.indexOf(pointer);\r\n        if (index === -1) { // Not in catched pointers\r\n            return;\r\n        } else {\r\n            delete this.movedState[pointer.id];\r\n            SpliceOne(this.pointers, index);\r\n        }\r\n\r\n        switch (this.tracerState) {\r\n            case TOUCH1:\r\n                this.tracerState = TOUCH0;\r\n                this.onDrag1End();\r\n                break;\r\n            case TOUCH2:\r\n                this.tracerState = TOUCH1;\r\n                this.onDrag2End();\r\n                this.onDrag1Start();\r\n                break;\r\n        }\r\n    }\r\n\r\n    onPointerMove(pointer) {\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.isDown) {\r\n            var isInsideBounds = (this.bounds) ? this.bounds.contains(pointer.x, pointer.y) : true;\r\n            var isCatchedPointer = (this.pointers.indexOf(pointer) !== -1);\r\n            if (!isCatchedPointer && isInsideBounds) { // Pointer moves into bounds\r\n                // this.onPointerDown(pointer);\r\n            } else if (isCatchedPointer && !isInsideBounds) { // Pointer moves out of bounds, lose pointer\r\n                this.onPointerUp(pointer);\r\n            } else {  // Pointer drags in bounds\r\n                if (!this.movedState[pointer.id]) {\r\n                    this.movedState[pointer.id] = (pointer.x !== pointer.downX) || (pointer.y !== pointer.downY);\r\n                }\r\n                if (this.movedState[pointer.id]) {\r\n                    switch (this.tracerState) {\r\n                        case TOUCH1:\r\n                            this.onDrag1();\r\n                            break;\r\n                        case TOUCH2:\r\n                            this.onDrag2();\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    dragCancel() {\r\n        if (this.tracerState === TOUCH2) {\r\n            this.onDrag2End();\r\n        }\r\n        this.pointers.length = 0;\r\n        Object(_utils_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.movedState);\r\n        this.tracerState = TOUCH0;\r\n        return this;\r\n    }\r\n\r\n    onDrag1Start() {\r\n        this.emit('drag1start', this);\r\n    }\r\n\r\n    onDrag1End() {\r\n        this.emit('drag1end', this);\r\n    }\r\n\r\n    onDrag1() {\r\n        this.emit('drag1', this);\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.emit('drag2start', this);\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.emit('drag2end', this);\r\n    }\r\n\r\n    onDrag2() {\r\n        this.emit('drag2', this);\r\n    }\r\n\r\n    get distanceBetween() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0],\r\n            p1 = this.pointers[1];\r\n        return DistanceBetween(p0.x, p0.y, p1.x, p1.y);\r\n    }\r\n\r\n    get angleBetween() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0],\r\n            p1 = this.pointers[1];\r\n        return AngleBetween(p0.x, p0.y, p1.x, p1.y);\r\n    }\r\n\r\n    get drag1Vector() {\r\n        var pointer = this.pointers[0];\r\n        if (pointer && this.movedState[pointer.id]) {\r\n            var p1 = pointer.position;\r\n            var p0 = pointer.prevPosition;\r\n            tmpDragVector.x = p1.x - p0.x;\r\n            tmpDragVector.y = p1.y - p0.y;\r\n        } else {\r\n            tmpDragVector.x = 0;\r\n            tmpDragVector.y = 0;\r\n        }\r\n        return tmpDragVector;\r\n    }\r\n\r\n    get centerX() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0].position;\r\n        var p1 = this.pointers[1].position;\r\n        return (p0.x + p1.x) / 2;\r\n    }\r\n\r\n    get centerY() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var p0 = this.pointers[0].position;\r\n        var p1 = this.pointers[1].position;\r\n        return (p0.y + p1.y) / 2;\r\n    }\r\n\r\n    get prevCenterX() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var preP0 = (this.movedState[this.pointers[0].id]) ? this.pointers[0].prevPosition : this.pointers[0].position;\r\n        var preP1 = (this.movedState[this.pointers[1].id]) ? this.pointers[1].prevPosition : this.pointers[1].position;\r\n        return (preP0.x + preP1.x) / 2;\r\n    }\r\n\r\n    get prevCenterY() {\r\n        if (this.tracerState !== TOUCH2) {\r\n            return 0;\r\n        }\r\n        var preP0 = (this.movedState[this.pointers[0].id]) ? this.pointers[0].prevPosition : this.pointers[0].position;\r\n        var preP1 = (this.movedState[this.pointers[1].id]) ? this.pointers[1].prevPosition : this.pointers[1].position;\r\n        return (preP0.y + preP1.y) / 2;\r\n    }\r\n\r\n    get movementCenterX() {\r\n        return this.centerX - this.prevCenterX;\r\n    }\r\n\r\n    get movementCenterY() {\r\n        return this.centerY - this.prevCenterY;\r\n    }\r\n\r\n    setRecongizedStateObject(stateObject) {\r\n        this.recongizedState = stateObject;\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this.recongizedState.state;\r\n    }\r\n\r\n    set state(newState) {\r\n        this.recongizedState.state = newState;\r\n    }\r\n\r\n    cancel() {\r\n        this.state = IDLE;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    TwoPointersTracer.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nvar tmpDragVector = {};\r\n\r\nconst TOUCH0 = 0;\r\nconst TOUCH1 = 1;\r\nconst TOUCH2 = 2;\r\n\r\nconst IDLE = 'IDLE';\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TwoPointersTracer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/gestures/twopointerstracer/TwoPointersTracer.js?")},"./lib/rexui/lib/plugins/input/scroller/Scroller.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/system/GetSceneObject.js */ \"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js\");\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _State_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./State.js */ \"./lib/rexui/lib/plugins/input/scroller/State.js\");\n/* harmony import */ var _dragspeed_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../dragspeed.js */ \"./lib/rexui/lib/plugins/dragspeed.js\");\n/* harmony import */ var _utils_movement_SlowDown_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/movement/SlowDown.js */ \"./lib/rexui/lib/plugins/utils/movement/SlowDown.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Scroller {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = Object(_utils_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        var enable = GetValue(config, 'enable', true);\r\n        var stateConfig = {\r\n            enable: enable,\r\n            eventEmitter: false,\r\n        }\r\n        this._state = new _State_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this, stateConfig);\r\n\r\n        var drapSpeedConfig = {\r\n            inputConfig: GetValue(config, 'inputConfig', undefined),\r\n            enable: enable,\r\n            eventEmitter: false,\r\n        };\r\n        this.dragState = new _dragspeed_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](gameObject, drapSpeedConfig);\r\n\r\n        this._value = undefined;\r\n        this._slowDown = new _utils_movement_SlowDown_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"]();\r\n\r\n        var callback = GetValue(config, 'valuechangeCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'valuechangeCallbackScope', undefined);\r\n            this.on('valuechange', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'overmaxCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'overmaxCallbackScope', undefined);\r\n            this.on('overmax', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'overminCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'overminCallbackScope', undefined);\r\n            this.on('overmin', callback, scope);\r\n        }\r\n\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setOrientationMode(GetValue(o, 'orientation', 0));\r\n        this.setDragThreshold(GetValue(o, 'threshold', 10));\r\n        this.setSlidingDeceleration(GetValue(o, 'slidingDeceleration', 5000));\r\n        this.setBackDeceleration(GetValue(o, 'backDeceleration', 2000));\r\n        this.boundPad0 = GetValue(o, 'boundPad0', 0);\r\n        this.boundPad1 = GetValue(o, 'boundPad1', 0);\r\n        var bounds = GetValue(o, 'bounds', undefined);\r\n        if (bounds) {\r\n            this.setBounds(bounds);\r\n        } else {\r\n            this.setBounds(GetValue(o, 'max', 0), GetValue(o, 'min', 0));\r\n        }\r\n        this.setValue(GetValue(o, 'value', this.maxValue || 0 + this.boundPad1));\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.scene.events.on('update', this._state.update, this._state);\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        if (this.scene) { // Scene might be destoryed\r\n            this.scene.events.off('update', this._state.update, this._state);\r\n        }\r\n        this.gameObject = undefined;\r\n        this.scene = undefined;\r\n        this._state.destroy();\r\n        this.dragState.destroy();\r\n        // gameObject events will be removed when this gameObject destroyed \r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    setOrientationMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = ORIENTATIONMODE[m];\r\n        }\r\n        this.orientationMode = m;\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    setSlidingDeceleration(dec) {\r\n        this.slidingDeceleration = dec;\r\n        return this;\r\n    }\r\n\r\n    setBackDeceleration(dec) {\r\n        this.backDeceleration = dec;\r\n        return this;\r\n    }\r\n\r\n    setBounds(value0, value1) {\r\n        if (Array.isArray(value0)) {\r\n            var bounds = value0;\r\n            value0 = bounds[0];\r\n            value1 = bounds[1];\r\n        }\r\n        if (value0 < value1) {\r\n            this.minValue = value0 + this.boundPad0;\r\n            this.maxValue = value1 + this.boundPad1;\r\n        } else {\r\n            this.minValue = value1 + this.boundPad0;\r\n            this.maxValue = value0 + this.boundPad1;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get value() {\r\n        return this._value;\r\n    }\r\n\r\n    set value(value) {\r\n        if (value === this._value) {\r\n            return;\r\n        }\r\n\r\n        var oldValue = this._value;\r\n        var isOverMax = this.overMax(value);\r\n        var isOverMin = this.overMin(value);\r\n        if (isOverMax) {\r\n            this.emit('overmax', value, oldValue);\r\n        }\r\n        if (isOverMin) {\r\n            this.emit('overmin', value, oldValue);\r\n        }\r\n        if (!this.backEnable) {\r\n            if (isOverMax) {\r\n                value = this.maxValue;\r\n            }\r\n            if (isOverMin) {\r\n                value = this.minValue;\r\n            }\r\n        }\r\n\r\n        this._value = value;\r\n        this.emit('valuechange', value, oldValue);\r\n    }\r\n\r\n    setValue(value) {\r\n        this.value = value;\r\n    }\r\n\r\n    setEnable(e) {\r\n        this._state.setEnable(e);\r\n        this.dragState.setEnable(e);\r\n        return this;\r\n    }\r\n\r\n    get state() {\r\n        return this._state.state;\r\n    }\r\n\r\n    get isDragging() {\r\n        return this.dragState.isInTouched;\r\n    }\r\n\r\n    get outOfMaxBound() {\r\n        return this.overMax(this.value);\r\n    }\r\n\r\n    get outOfMinBound() {\r\n        return this.overMin(this.value);\r\n    }\r\n\r\n    get outOfBounds() {\r\n        return this.outOfMinBound || this.outOfMaxBound;\r\n    }\r\n\r\n    // internal\r\n    overMax(value) {\r\n        return (this.maxValue != null) && (value > this.maxValue);\r\n    }\r\n\r\n    overMin(value) {\r\n        return (this.minValue != null) && (value < this.minValue);\r\n    }\r\n\r\n    get backEnable() {\r\n        return (typeof (this.backDeceleration) === 'number');\r\n    }\r\n\r\n    get isPullBack() {\r\n        return this._slowDown.isMoving;\r\n    }\r\n\r\n    get slidingEnable() {\r\n        return (typeof (this.slidingDeceleration) === 'number');\r\n    }\r\n\r\n    get isSliding() {\r\n        return this._slowDown.isMoving;\r\n    }\r\n\r\n    get dragDelta() {\r\n        if (this.orientationMode === 0) { // y\r\n            return this.dragState.dy;\r\n        } else if (this.orientationMode === 1) { // x\r\n            return this.dragState.dx;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    get dragSpeed() {\r\n        if (this.orientationMode === 0) { // y\r\n            return this.dragState.speedY;\r\n        } else if (this.orientationMode === 1) { // x\r\n            return this.dragState.speedX;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    // everyTick_DRAG\r\n    dragging() {\r\n        this.value += this.dragDelta;\r\n    }\r\n\r\n    // enter_SLIDE \r\n    onSliding() {\r\n        var start = this.value;\r\n        var speed = this.dragSpeed;\r\n        if (speed === 0) {\r\n            this._slowDown.stop();\r\n            this._state.next();\r\n            return;\r\n        }\r\n        var dec = this.slidingDeceleration;\r\n        this._slowDown.init(start, (speed > 0), Math.abs(speed), dec)\r\n    }\r\n\r\n    // everyTick_SLIDE\r\n    sliding(time, delta) {\r\n        delta *= 0.001;\r\n        var newValue = this._slowDown.update(delta).value;\r\n        if (this.overMax(newValue)) {\r\n            this.value = this.maxValue;\r\n            this._slowDown.stop();\r\n        } else if (this.overMin(newValue)) {\r\n            this.value = this.minValue;\r\n            this._slowDown.stop();\r\n        } else {\r\n            this.value = newValue;\r\n        }\r\n    }\r\n\r\n    // enter_BACK\r\n    onPullBack() {\r\n        var start = this.value;\r\n        var end = (this.outOfMinBound) ? this.minValue : this.maxValue;\r\n        var dist = Math.abs(end - start);\r\n        var dec = this.backDeceleration;\r\n        var speed = Math.sqrt(2 * dec * dist);\r\n        this._slowDown.init(start, undefined, speed, dec, end);\r\n    }\r\n\r\n    // everyTick_BACK\r\n    pullBack(time, delta) {\r\n        delta *= 0.001;\r\n        this.value = this._slowDown.update(delta).value;\r\n\r\n        if (!this._slowDown.isMoving) {\r\n            this._state.next();\r\n        }\r\n    }\r\n\r\n    // exit_SLIDE, exit_BACK\r\n    stop() {\r\n        this._slowDown.stop();\r\n    }\r\n\r\n}\r\n\r\nObject.assign(\r\n    Scroller.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/** @private */\r\nconst ORIENTATIONMODE = {\r\n    y: 0,\r\n    v: 0,\r\n    vertical: 0,\r\n    x: 1,\r\n    h: 1,\r\n    horizontal: 1,\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scroller);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/scroller/Scroller.js?")},"./lib/rexui/lib/plugins/input/scroller/State.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _fsm_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../fsm.js */ \"./lib/rexui/lib/plugins/fsm.js\");\n\r\n\r\nclass State extends _fsm_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(parent, config) {\r\n        super(config);\r\n        this.parent = parent;\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.start('IDLE');\r\n    }\r\n\r\n    // IDLE -> DRAGBEGIN|DRAG\r\n    next_IDLE() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = (parent.dragThreshold === 0) ? 'DRAG' : 'DRAGBEGIN';\r\n        }\r\n        return nextState;\r\n    }\r\n    update_IDLE(time, delta) {\r\n        this.next();\r\n    }\r\n    // IDLE\r\n\r\n    // DRAGBEGIN -> DRAG|IDLE\r\n    next_DRAGBEGIN() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = (dragState.pointer.getDistance() >= parent.dragThreshold) ? 'DRAG' : 'DRAGBEGIN';\r\n        } else { // dragState.isUp\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    update_DRAGBEGIN(time, delta) {\r\n        this.next();\r\n    }\r\n    // DRAGBEGIN\r\n\r\n    // DRAG -> BACK|SLIDE|IDLE\r\n    next_DRAG() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isUp) {\r\n            if (parent.outOfBounds) {\r\n                nextState = 'BACK';\r\n            } else if (parent.slidingEnable) {\r\n                nextState = 'SLIDE';\r\n            } else {\r\n                nextState = 'IDLE';\r\n            }\r\n        }\r\n        return nextState;\r\n    }\r\n    update_DRAG(time, delta) {\r\n        var parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.justMoved) {\r\n            parent.dragging();\r\n        }\r\n        this.next();\r\n    }\r\n    // DRAG    \r\n\r\n    // SLIDE -> DRAG|IDLE\r\n    next_SLIDE() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = 'DRAG';\r\n        } else if (!parent.isSliding) {\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    enter_SLIDE() {\r\n        this.parent.onSliding();\r\n    }\r\n    exit_SLIDE() {\r\n        this.parent.stop();\r\n    }\r\n    update_SLIDE(time, delta) {\r\n        this.parent.sliding(time, delta);\r\n        this.next();\r\n    }\r\n    // SLIDE    \r\n\r\n    // BACK -> DRAG|IDLE\r\n    next_BACK() {\r\n        var nextState,\r\n            parent = this.parent,\r\n            dragState = parent.dragState;\r\n        if (dragState.isDown) {\r\n            nextState = 'DRAG';\r\n        } else if (!parent.isPullBack) {\r\n            nextState = 'IDLE';\r\n        }\r\n        return nextState;\r\n    }\r\n    enter_BACK() {\r\n        this.parent.onPullBack();\r\n    }\r\n    exit_BACK() {\r\n        this.parent.stop();\r\n    }\r\n    update_BACK(time, delta) {\r\n        this.parent.pullBack(time, delta);\r\n        this.next();\r\n    }\r\n    // BACK\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (State);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/input/scroller/State.js?")},"./lib/rexui/lib/plugins/inputtext-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_inputtext_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/inputtext/Factory.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/Factory.js");\n/* harmony import */ var _gameobjects_inputtext_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/inputtext/Creator.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/Creator.js");\n/* harmony import */ var _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/inputtext/InputText.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass InputTextPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexInputText\', _gameobjects_inputtext_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_inputtext_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.on(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.InputText\', _gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (InputTextPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/inputtext-plugin.js?')},"./lib/rexui/lib/plugins/logic/fsm/FSM.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/object/GetValue.js */ \"./lib/rexui/lib/plugins/utils/object/GetValue.js\");\n/* harmony import */ var _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\n\r\nclass FSM {\r\n    /*\r\n    var config = {\r\n        start: 'A',   // default: undefined\r\n        states: {\r\n            A: {\r\n                next: 'B',  // function() { return 'B'; }\r\n                enter: function() {},\r\n                exit: function() {}\r\n            },\r\n            // ...\r\n        },        \r\n        extend: {\r\n            i: 0,\r\n            name: 'abc'\r\n            // ...\r\n        },\r\n        init: function() {},\r\n        enable: true,\r\n        eventEmitter: true,\r\n    };\r\n    */\r\n    constructor(config) {\r\n        // Attach get-next-state function\r\n        var states = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'states', undefined);\r\n        if (states) {\r\n            this.addStates(states);\r\n        }\r\n\r\n        // Attach extend members\r\n        var extend = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'extend', undefined);\r\n        if (extend) {\r\n            for (var name in extend) {\r\n                if (!this.hasOwnProperty(name) || this[name] === undefined) {\r\n                    this[name] = extend[name];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Event emitter\r\n        var eventEmitter = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'eventEmitter', undefined);\r\n        var EventEmitterClass = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'EventEmitterClass', undefined);\r\n        this.setEventEmitter(eventEmitter, EventEmitterClass);\r\n\r\n        this._stateLock = false;\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setEnable(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'enable', true));\r\n        this.start(_utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'start', undefined));\r\n        var init = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(o, 'init', undefined);\r\n        if (init) {\r\n            init.call(this);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            curState: this.state,\r\n            prevState: this.prevState,\r\n\r\n            enable: this.enable,\r\n            start: this._start\r\n        };\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    set state(newState) {\r\n        if (!this.enable || this._stateLock) {\r\n            return;\r\n        }\r\n        if (this._state === newState) {\r\n            return;\r\n        }\r\n        this._prevState = this._state;\r\n        this._state = newState;\r\n\r\n        this._stateLock = true; // lock state\r\n\r\n        this.emit('statechange', this);\r\n\r\n        if (this._prevState != null) {\r\n            var exitEventName = 'exit_' + this._prevState;\r\n            var exitCallback = this[exitEventName];\r\n            if (exitCallback) {\r\n                exitCallback.call(this);\r\n            }\r\n            this.emit(exitEventName, this);\r\n        }\r\n\r\n        this._stateLock = false;\r\n\r\n        if (this._state != null) {\r\n            var enterEventName = 'enter_' + this._state;\r\n            var enterCallback = this[enterEventName];\r\n            if (enterCallback) {\r\n                enterCallback.call(this);\r\n            }\r\n            this.emit(enterEventName, this);\r\n        }\r\n    }\r\n\r\n    get state() {\r\n        return this._state;\r\n    }\r\n\r\n    get prevState() {\r\n        return this._prevState;\r\n    }\r\n\r\n    start(state) {\r\n        this._start = state;\r\n        this._prevState = undefined;\r\n        this._state = state; // Won't fire statechange events\r\n        return this;\r\n    }\r\n\r\n    goto(nextState) {\r\n        if (nextState != null) {\r\n            this.state = nextState;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    next() {\r\n        var nextState;\r\n        var getNextState = this['next_' + this.state];\r\n        if (getNextState) {\r\n            if (typeof (getNextState) === 'string') {\r\n                nextState = getNextState;\r\n            } else {\r\n                nextState = getNextState.call(this);\r\n            }\r\n        }\r\n\r\n        this.goto(nextState);\r\n        return this;\r\n    }\r\n\r\n    addState(name, config) {\r\n        var getNextStateCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'next', undefined);\r\n        if (getNextStateCallback) {\r\n            this['next_' + name] = getNextStateCallback;\r\n        }\r\n\r\n        var exitCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'exit', undefined);\r\n        if (exitCallback) {\r\n            this['exit_' + name] = exitCallback;\r\n        }\r\n\r\n        var enterCallback = _utils_object_GetValue_js__WEBPACK_IMPORTED_MODULE_1___default()(config, 'enter', undefined);\r\n        if (enterCallback) {\r\n            this['enter_' + name] = enterCallback;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addStates(states) {\r\n        for (var name in states) {\r\n            this.addState(name, states[name]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    update(time, delta, key) {\r\n        if (key === undefined) {\r\n            key = 'update';\r\n        }\r\n        var fn = this[key + '_' + this.state];\r\n        if (fn) {\r\n            fn.call(this, time, delta);\r\n        }\r\n    }\r\n\r\n    preupdate(time, delta) {\r\n        this.update(time, delta, 'preupdate');\r\n    }\r\n\r\n    postupdate(time, delta) {\r\n        this.update(time, delta, 'postupdate');\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    FSM.prototype,\r\n    _utils_eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (FSM);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/logic/fsm/FSM.js?")},"./lib/rexui/lib/plugins/ninepatch-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _gameobjects_ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./gameobjects/ninepatch/Factory.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/Factory.js");\n/* harmony import */ var _gameobjects_ninepatch_Creator_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameobjects/ninepatch/Creator.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/Creator.js");\n/* harmony import */ var _gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gameobjects/ninepatch/NinePatch.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n/* harmony import */ var _utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\nclass NinePatchPlugin extends Phaser.Plugins.BasePlugin {\r\n\r\n    constructor(pluginManager) {\r\n        super(pluginManager);\r\n\r\n        //  Register our new Game Object type\r\n        pluginManager.registerGameObject(\'rexNinePatch\', _gameobjects_ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_0__["default"], _gameobjects_ninepatch_Creator_js__WEBPACK_IMPORTED_MODULE_1__["default"]);\r\n    }\r\n\r\n    start() {\r\n        var eventEmitter = this.game.events;\r\n        eventEmitter.on(\'destroy\', this.destroy, this);\r\n    }\r\n}\r\n\r\nObject(_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.GameObjects.NinePatch\', _gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (NinePatchPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/ninepatch-plugin.js?')},"./lib/rexui/lib/plugins/pool.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_struct_Stack_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/struct/Stack.js */ "./lib/rexui/lib/plugins/utils/struct/Stack.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_utils_struct_Stack_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/pool.js?')},"./lib/rexui/lib/plugins/popup.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scale.js */ \"./lib/rexui/lib/plugins/scale.js\");\n\r\n\r\nvar PopUp = function (gameObject, duration, orientation, ease, scale) {\r\n    defaultConfig.mode = 0;\r\n    switch (orientation) {\r\n        case 0:\r\n        case 'x':\r\n            defaultConfig.start = {\r\n                x: 0\r\n            };\r\n            break;\r\n        case 1:\r\n        case 'y':\r\n            defaultConfig.start = {\r\n                y: 0\r\n            };\r\n            break;\r\n        default:\r\n            defaultConfig.start = 0;\r\n            break;\r\n    }\r\n    defaultConfig.end = 1;\r\n    defaultConfig.duration = duration;\r\n    defaultConfig.ease = (ease === undefined) ? 'Cubic' : ease;\r\n\r\n    if (scale === undefined) {\r\n        scale = new _scale_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](gameObject, defaultConfig);\r\n    } else {\r\n        scale.resetFromJSON(defaultConfig);\r\n    }\r\n    scale.restart();\r\n\r\n    return scale;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (PopUp);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/popup.js?")},"./lib/rexui/lib/plugins/scale-down-destroy.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scale.js */ "./lib/rexui/lib/plugins/scale.js");\n\r\n\r\nvar ScaleDownDestroy = function (gameObject, duration, orientation, ease, destroyMode, scale) {\r\n    if (destroyMode instanceof _scale_js__WEBPACK_IMPORTED_MODULE_0__["default"]) {\r\n        scale = destroyMode;\r\n        destroyMode = undefined;\r\n    }\r\n\r\n    if (destroyMode === undefined) {\r\n        destroyMode = true;\r\n    }\r\n\r\n    defaultConfig.mode = (destroyMode) ? 1 : 0;\r\n    switch (orientation) {\r\n        case 0:\r\n        case \'x\':\r\n            defaultConfig.end = {\r\n                x: 0\r\n            };\r\n            break;\r\n        case 1:\r\n        case \'y\':\r\n            defaultConfig.end = {\r\n                y: 0\r\n            };\r\n            break;\r\n        default:\r\n            defaultConfig.end = 0;\r\n            break;\r\n    }\r\n    defaultConfig.duration = duration;\r\n    defaultConfig.ease = (ease === undefined) ? \'Linear\' : ease;\r\n\r\n    if (scale === undefined) {\r\n        scale = new _scale_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, defaultConfig);\r\n    } else {\r\n        scale.resetFromJSON(defaultConfig);\r\n    }\r\n    scale.restart();\r\n\r\n    return scale;\r\n};\r\n\r\nvar defaultConfig = {}; // reuse this config\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ScaleDownDestroy);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/scale-down-destroy.js?')},"./lib/rexui/lib/plugins/scale.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _behaviors_scale_Scale_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./behaviors/scale/Scale.js */ "./lib/rexui/lib/plugins/behaviors/scale/Scale.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_behaviors_scale_Scale_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/scale.js?')},"./lib/rexui/lib/plugins/scroller.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./input/scroller/Scroller.js */ "./lib/rexui/lib/plugins/input/scroller/Scroller.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/scroller.js?')},"./lib/rexui/lib/plugins/utils/actions/GlobZone.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../object/NOOP.js */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n\r\nvar globZone = new Phaser.GameObjects.Zone({\r\n    sys: {\r\n        queueDepthSort: _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n        events: {\r\n            once: _object_NOOP_js__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n        }\r\n    }\r\n}, 0, 0, 1, 1);\r\nglobZone.setOrigin(0);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (globZone);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/actions/GlobZone.js?')},"./lib/rexui/lib/plugins/utils/actions/RotateObjectAround.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst RotateAround = Phaser.Math.RotateAround;\r\n\r\nvar RotateObjectAround = function (gameObject, x, y, angle) {\r\n    RotateAround(gameObject, x, y, angle);\r\n    gameObject.rotation += angle;\r\n    return gameObject;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RotateObjectAround);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/actions/RotateObjectAround.js?')},"./lib/rexui/lib/plugins/utils/align/align/const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ALIGN_CONST = {\r\n\r\n    /**\r\n    * A constant representing a top-left alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.TOP_LEFT\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    TOP_LEFT: 0,\r\n\r\n    /**\r\n    * A constant representing a top-center alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.TOP_CENTER\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    TOP_CENTER: 1,\r\n\r\n    /**\r\n    * A constant representing a top-right alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.TOP_RIGHT\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    TOP_RIGHT: 2,\r\n\r\n    /**\r\n    * A constant representing a left-top alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.LEFT_TOP\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    LEFT_TOP: 3,\r\n\r\n    /**\r\n    * A constant representing a left-center alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.LEFT_CENTER\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    LEFT_CENTER: 4,\r\n\r\n    /**\r\n    * A constant representing a left-bottom alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.LEFT_BOTTOM\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    LEFT_BOTTOM: 5,\r\n\r\n    /**\r\n    * A constant representing a center alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.CENTER\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    CENTER: 6,\r\n\r\n    /**\r\n    * A constant representing a right-top alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.RIGHT_TOP\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    RIGHT_TOP: 7,\r\n\r\n    /**\r\n    * A constant representing a right-center alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.RIGHT_CENTER\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    RIGHT_CENTER: 8,\r\n\r\n    /**\r\n    * A constant representing a right-bottom alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.RIGHT_BOTTOM\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    RIGHT_BOTTOM: 9,\r\n\r\n    /**\r\n    * A constant representing a bottom-left alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.BOTTOM_LEFT\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    BOTTOM_LEFT: 10,\r\n\r\n    /**\r\n    * A constant representing a bottom-center alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.BOTTOM_CENTER\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    BOTTOM_CENTER: 11,\r\n\r\n    /**\r\n    * A constant representing a bottom-right alignment or position.\r\n    * @constant\r\n    * @name Phaser.Display.Align.BOTTOM_RIGHT\r\n    * @since 3.0.0\r\n    * @type {integer}\r\n    */\r\n    BOTTOM_RIGHT: 12\r\n\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ALIGN_CONST);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/const.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/BottomCenter.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetBottom.js");\n/* harmony import */ var _bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterX.js");\n/* harmony import */ var _bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetBottom.js");\n/* harmony import */ var _bounds_SetCenterX_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterX.js");\n\r\n\r\n\r\n\r\n\r\nvar BottomCenter = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetCenterX_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) + offsetX);\r\n    Object(_bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BottomCenter);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/BottomCenter.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/BottomLeft.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetBottom.js");\n/* harmony import */ var _bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetLeft.js");\n/* harmony import */ var _bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetBottom.js");\n/* harmony import */ var _bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetLeft.js");\n\r\n\r\n\r\n\r\n\r\nvar BottomLeft = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) - offsetX);\r\n    Object(_bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BottomLeft);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/BottomLeft.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/BottomRight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetBottom.js");\n/* harmony import */ var _bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetRight.js");\n/* harmony import */ var _bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetBottom.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetBottom.js");\n/* harmony import */ var _bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetRight.js");\n\r\n\r\n\r\n\r\n\r\nvar BottomRight = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) + offsetX);\r\n    Object(_bounds_SetBottom_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetBottom_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BottomRight);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/BottomRight.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/Center.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_CenterOn_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/CenterOn.js */ "./lib/rexui/lib/plugins/utils/align/bounds/CenterOn.js");\n/* harmony import */ var _bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterX.js");\n/* harmony import */ var _bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/GetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterY.js");\n\r\n\r\n\r\n\r\nvar Center = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_CenterOn_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, Object(_bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) + offsetX, Object(_bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_2__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Center);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/Center.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/LeftCenter.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterY.js");\n/* harmony import */ var _bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetLeft.js");\n/* harmony import */ var _bounds_SetCenterY_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterY.js");\n/* harmony import */ var _bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetLeft.js");\n\r\n\r\n\r\n\r\n\r\nvar LeftCenter = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) - offsetX);\r\n    Object(_bounds_SetCenterY_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LeftCenter);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/LeftCenter.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _const_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const.js */ "./lib/rexui/lib/plugins/utils/align/align/const.js");\n/* harmony import */ var _BottomCenter_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BottomCenter.js */ "./lib/rexui/lib/plugins/utils/align/align/in/BottomCenter.js");\n/* harmony import */ var _BottomLeft_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BottomLeft.js */ "./lib/rexui/lib/plugins/utils/align/align/in/BottomLeft.js");\n/* harmony import */ var _BottomRight_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BottomRight.js */ "./lib/rexui/lib/plugins/utils/align/align/in/BottomRight.js");\n/* harmony import */ var _Center_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Center.js */ "./lib/rexui/lib/plugins/utils/align/align/in/Center.js");\n/* harmony import */ var _LeftCenter_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./LeftCenter.js */ "./lib/rexui/lib/plugins/utils/align/align/in/LeftCenter.js");\n/* harmony import */ var _RightCenter_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./RightCenter.js */ "./lib/rexui/lib/plugins/utils/align/align/in/RightCenter.js");\n/* harmony import */ var _TopCenter_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./TopCenter.js */ "./lib/rexui/lib/plugins/utils/align/align/in/TopCenter.js");\n/* harmony import */ var _TopLeft_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./TopLeft.js */ "./lib/rexui/lib/plugins/utils/align/align/in/TopLeft.js");\n/* harmony import */ var _TopRight_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./TopRight.js */ "./lib/rexui/lib/plugins/utils/align/align/in/TopRight.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar AlignInMap = [];\r\n\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].BOTTOM_CENTER] = _BottomCenter_js__WEBPACK_IMPORTED_MODULE_1__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].BOTTOM_LEFT] = _BottomLeft_js__WEBPACK_IMPORTED_MODULE_2__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].BOTTOM_RIGHT] = _BottomRight_js__WEBPACK_IMPORTED_MODULE_3__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].CENTER] = _Center_js__WEBPACK_IMPORTED_MODULE_4__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].LEFT_CENTER] = _LeftCenter_js__WEBPACK_IMPORTED_MODULE_5__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].RIGHT_CENTER] = _RightCenter_js__WEBPACK_IMPORTED_MODULE_6__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOP_CENTER] = _TopCenter_js__WEBPACK_IMPORTED_MODULE_7__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOP_LEFT] = _TopLeft_js__WEBPACK_IMPORTED_MODULE_8__["default"];\r\nAlignInMap[_const_js__WEBPACK_IMPORTED_MODULE_0__["default"].TOP_RIGHT] = _TopRight_js__WEBPACK_IMPORTED_MODULE_9__["default"];\r\n\r\nvar QuickSet = function (child, alignIn, position, offsetX, offsetY) {\r\n    return AlignInMap[position](child, alignIn, offsetX, offsetY);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (QuickSet);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/RightCenter.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterY.js");\n/* harmony import */ var _bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetRight.js");\n/* harmony import */ var _bounds_SetCenterY_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterY.js");\n/* harmony import */ var _bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetRight.js");\n\r\n\r\n\r\n\r\n\r\nvar RightCenter = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) + offsetX);\r\n    Object(_bounds_SetCenterY_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetCenterY_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (RightCenter);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/RightCenter.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/TopCenter.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetCenterX.js");\n/* harmony import */ var _bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetTop.js");\n/* harmony import */ var _bounds_SetCenterX_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterX.js");\n/* harmony import */ var _bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetTop.js");\n\r\n\r\n\r\n\r\n\r\nvar TopCenter = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetCenterX_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetCenterX_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetX);\r\n    Object(_bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) - offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TopCenter);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/TopCenter.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/TopLeft.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetLeft.js");\n/* harmony import */ var _bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetTop.js");\n/* harmony import */ var _bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetLeft.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetLeft.js");\n/* harmony import */ var _bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetTop.js");\n\r\n\r\n\r\n\r\n\r\nvar TopLeft = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetLeft_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetLeft_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) - offsetX);\r\n    Object(_bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) - offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TopLeft);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/TopLeft.js?')},"./lib/rexui/lib/plugins/utils/align/align/in/TopRight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bounds/GetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetRight.js");\n/* harmony import */ var _bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../bounds/GetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/GetTop.js");\n/* harmony import */ var _bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bounds/SetRight.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetRight.js");\n/* harmony import */ var _bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../bounds/SetTop.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetTop.js");\n\r\n\r\n\r\n\r\n\r\nvar TopRight = function (gameObject, alignIn, offsetX, offsetY) {\r\n    if (offsetX === undefined) { offsetX = 0; }\r\n    if (offsetY === undefined) { offsetY = 0; }\r\n\r\n    Object(_bounds_SetRight_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject, Object(_bounds_GetRight_js__WEBPACK_IMPORTED_MODULE_0__["default"])(alignIn) + offsetX);\r\n    Object(_bounds_SetTop_js__WEBPACK_IMPORTED_MODULE_3__["default"])(gameObject, Object(_bounds_GetTop_js__WEBPACK_IMPORTED_MODULE_1__["default"])(alignIn) - offsetY);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TopRight);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/align/in/TopRight.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/CenterOn.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetCenterX_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetCenterX.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterX.js");\n/* harmony import */ var _SetCenterY_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetCenterY.js */ "./lib/rexui/lib/plugins/utils/align/bounds/SetCenterY.js");\n\r\n\r\n\r\nvar CenterOn = function (gameObject, x, y) {\r\n    Object(_SetCenterX_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject, x);\r\n    return Object(_SetCenterY_js__WEBPACK_IMPORTED_MODULE_1__["default"])(gameObject, y);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CenterOn);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/CenterOn.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetBottom.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetBottom = function (gameObject) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    return (gameObject.y + height) - (height * gameObject.originY);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetBottom);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetBottom.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetCenterX.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetCenterX = function (gameObject) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    return gameObject.x - (width * gameObject.originX) + (width * 0.5);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetCenterX);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetCenterX.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetCenterY.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetCenterY = function (gameObject) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    return gameObject.y - (height * gameObject.originY) + (height * 0.5);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetCenterY);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetCenterY.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetLeft.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetLeft = function (gameObject) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    return gameObject.x - (width * gameObject.originX);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetLeft);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetLeft.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetRight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetRight = function (gameObject) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    return (gameObject.x + width) - (width * gameObject.originX);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetRight);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetRight.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/GetTop.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetTop = function (gameObject) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    return gameObject.y - (height * gameObject.originY);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetTop);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/GetTop.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetBottom.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetBottom = function (gameObject, value) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    gameObject.y = (value - height) + (height * gameObject.originY);\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetBottom);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetBottom.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetCenterX.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetCenterX = function (gameObject, x) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    var offsetX = width * gameObject.originX;\r\n    gameObject.x = (x + offsetX) - (width * 0.5);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetCenterX);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetCenterX.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetCenterY.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetCenterY = function (gameObject, y) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    var offsetY = height * gameObject.originY;\r\n    gameObject.y = (y + offsetY) - (height * 0.5);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetCenterY);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetCenterY.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetLeft.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetLeft = function (gameObject, value) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    gameObject.x = value + (width * gameObject.originX);\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetLeft);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetLeft.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetRight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetRight = function (gameObject, value) {\r\n    var width = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(gameObject);\r\n    gameObject.x = (value - width) + (width * gameObject.originX);\r\n\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetRight);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetRight.js?')},"./lib/rexui/lib/plugins/utils/align/bounds/SetTop.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar SetTop = function (gameObject, value) {\r\n    var height = Object(_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(gameObject);\r\n    gameObject.y = value + (height * gameObject.originY);\r\n    return gameObject;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetTop);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/align/bounds/SetTop.js?')},"./lib/rexui/lib/plugins/utils/data/DataMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../object/GetValue.js */ "./lib/rexui/lib/plugins/utils/object/GetValue.js");\n/* harmony import */ var _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_object_GetValue_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _object_Clear_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../object/Clear.js */ "./lib/rexui/lib/plugins/utils/object/Clear.js");\n/* harmony import */ var _object_Clone_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../object/Clone.js */ "./lib/rexui/lib/plugins/utils/object/Clone.js");\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    enableData() {\r\n        if (this.data === undefined) {\r\n            this.data = {};\r\n        }\r\n        return this;\r\n    },\r\n\r\n    getData(key, defaultValue) {\r\n        this.enableData();\r\n        return (key === undefined) ? this.data : _object_GetValue_js__WEBPACK_IMPORTED_MODULE_0___default()(this.data, key, defaultValue);\r\n    },\r\n\r\n    setData(key, value) {\r\n        this.enableData();\r\n        this.data[key] = value;\r\n        return this;\r\n    },\r\n\r\n    incData(key, inc, defaultValue) {\r\n        if (defaultValue === undefined) {\r\n            defaultValue = 0;\r\n        }\r\n        this.enableData();\r\n        this.setData(key, this.getData(key, defaultValue) + inc);\r\n        return this;\r\n    },\r\n\r\n    mulData(key, mul, defaultValue) {\r\n        if (defaultValue === undefined) {\r\n            defaultValue = 0;\r\n        }\r\n        this.enableData();\r\n        this.setData(key, this.getData(key, defaultValue) * mul);\r\n        return this;\r\n    },\r\n\r\n    clearData() {\r\n        if (this.data) {\r\n            Object(_object_Clear_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.data);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    resetData(data) {\r\n        this.clearData();\r\n\r\n        if (data) {\r\n            this.enableData();\r\n            for (var key in data) {\r\n                this.data[key] = data[key];\r\n            }\r\n        }\r\n        return this;\r\n    },\r\n\r\n    cloneData() {\r\n        if (this.data) {\r\n            return Object(_object_Clone_js__WEBPACK_IMPORTED_MODULE_2__["default"])(this.data);\r\n        } else {\r\n            return {};\r\n        }\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/data/DataMethods.js?')},"./lib/rexui/lib/plugins/utils/defaultbounds/GetDefaultBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetDefaultBounds = function (scene, out) {\r\n    if (out === undefined) {\r\n        if (GlobRectangle === undefined) {\r\n            GlobRectangle = new Phaser.Geom.Rectangle();\r\n        }\r\n        out = GlobRectangle;\r\n    }\r\n    var gameConfig = scene.game.config;\r\n    out.setTo(0, 0, gameConfig.width, gameConfig.height);\r\n    return out;\r\n}\r\n\r\nvar GlobRectangle;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetDefaultBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/defaultbounds/GetDefaultBounds.js?')},"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setEventEmitter(eventEmitter, EventEmitterClass) {\r\n        if (EventEmitterClass === undefined) {\r\n            EventEmitterClass = Phaser.Events.EventEmitter; // Use built-in EventEmitter class by default\r\n        }\r\n        this._privateEE = (eventEmitter === undefined);\r\n        this._eventEmitter = (this._privateEE) ? (new EventEmitterClass()) : eventEmitter;\r\n        return this;\r\n    },\r\n\r\n    destroyEventEmitter() {\r\n        if (this._eventEmitter && this._privateEE) {\r\n            this._eventEmitter.shutdown();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    getEventEmitter() {\r\n        return this._eventEmitter;\r\n    },\r\n\r\n    on: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.on.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    once: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.once.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    off: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.off.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    emit: function (event) {\r\n        if (this._eventEmitter && event) {\r\n            this._eventEmitter.emit.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addListener: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.addListener.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    removeListener: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.removeListener.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    removeAllListeners: function () {\r\n        if (this._eventEmitter) {\r\n            this._eventEmitter.removeAllListeners.apply(this._eventEmitter, arguments);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    listenerCount: function () {\r\n        if (this._eventEmitter) {\r\n            return this._eventEmitter.listenerCount.apply(this._eventEmitter, arguments);\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    listeners: function () {\r\n        if (this._eventEmitter) {\r\n            return this._eventEmitter.listeners.apply(this._eventEmitter, arguments);\r\n        }\r\n        return [];\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js?')},"./lib/rexui/lib/plugins/utils/geom/polygon/Earcut.js":function(module,exports,__webpack_require__){"use strict";eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n//  Earcut 2.1.4 (December 4th 2018)\r\n\r\n/*\r\n * ISC License\r\n * \r\n * Copyright (c) 2016, Mapbox\r\n * \r\n * Permission to use, copy, modify, and/or distribute this software for any purpose\r\n * with or without fee is hereby granted, provided that the above copyright notice\r\n * and this permission notice appear in all copies.\r\n * \r\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND\r\n * FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\r\n * OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER\r\n * TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF\r\n * THIS SOFTWARE.\r\n */\r\n\r\n\r\n\r\nmodule.exports = earcut;\r\n\r\nfunction earcut(data, holeIndices, dim) {\r\n\r\n    dim = dim || 2;\r\n\r\n    var hasHoles = holeIndices && holeIndices.length,\r\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\r\n        outerNode = linkedList(data, 0, outerLen, dim, true),\r\n        triangles = [];\r\n\r\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\r\n\r\n    var minX, minY, maxX, maxY, x, y, invSize;\r\n\r\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\r\n\r\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\r\n    if (data.length > 80 * dim) {\r\n        minX = maxX = data[0];\r\n        minY = maxY = data[1];\r\n\r\n        for (var i = dim; i < outerLen; i += dim) {\r\n            x = data[i];\r\n            y = data[i + 1];\r\n            if (x < minX) minX = x;\r\n            if (y < minY) minY = y;\r\n            if (x > maxX) maxX = x;\r\n            if (y > maxY) maxY = y;\r\n        }\r\n\r\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\r\n        invSize = Math.max(maxX - minX, maxY - minY);\r\n        invSize = invSize !== 0 ? 1 / invSize : 0;\r\n    }\r\n\r\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\r\n\r\n    return triangles;\r\n}\r\n\r\n// create a circular doubly linked list from polygon points in the specified winding order\r\nfunction linkedList(data, start, end, dim, clockwise) {\r\n    var i, last;\r\n\r\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\r\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\r\n    } else {\r\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\r\n    }\r\n\r\n    if (last && equals(last, last.next)) {\r\n        removeNode(last);\r\n        last = last.next;\r\n    }\r\n\r\n    return last;\r\n}\r\n\r\n// eliminate colinear or duplicate points\r\nfunction filterPoints(start, end) {\r\n    if (!start) return start;\r\n    if (!end) end = start;\r\n\r\n    var p = start,\r\n        again;\r\n    do {\r\n        again = false;\r\n\r\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\r\n            removeNode(p);\r\n            p = end = p.prev;\r\n            if (p === p.next) break;\r\n            again = true;\r\n\r\n        } else {\r\n            p = p.next;\r\n        }\r\n    } while (again || p !== end);\r\n\r\n    return end;\r\n}\r\n\r\n// main ear slicing loop which triangulates a polygon (given as a linked list)\r\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\r\n    if (!ear) return;\r\n\r\n    // interlink polygon nodes in z-order\r\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\r\n\r\n    var stop = ear,\r\n        prev, next;\r\n\r\n    // iterate through ears, slicing them one by one\r\n    while (ear.prev !== ear.next) {\r\n        prev = ear.prev;\r\n        next = ear.next;\r\n\r\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\r\n            // cut off the triangle\r\n            triangles.push(prev.i / dim);\r\n            triangles.push(ear.i / dim);\r\n            triangles.push(next.i / dim);\r\n\r\n            removeNode(ear);\r\n\r\n            // skipping the next vertex leads to less sliver triangles\r\n            ear = next.next;\r\n            stop = next.next;\r\n\r\n            continue;\r\n        }\r\n\r\n        ear = next;\r\n\r\n        // if we looped through the whole remaining polygon and can't find any more ears\r\n        if (ear === stop) {\r\n            // try filtering points and slicing again\r\n            if (!pass) {\r\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\r\n\r\n            // if this didn't work, try curing all small self-intersections locally\r\n            } else if (pass === 1) {\r\n                ear = cureLocalIntersections(ear, triangles, dim);\r\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\r\n\r\n            // as a last resort, try splitting the remaining polygon into two\r\n            } else if (pass === 2) {\r\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\r\n            }\r\n\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\n// check whether a polygon node forms a valid ear with adjacent nodes\r\nfunction isEar(ear) {\r\n    var a = ear.prev,\r\n        b = ear,\r\n        c = ear.next;\r\n\r\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n    // now make sure we don't have other points inside the potential ear\r\n    var p = ear.next.next;\r\n\r\n    while (p !== ear.prev) {\r\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.next;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction isEarHashed(ear, minX, minY, invSize) {\r\n    var a = ear.prev,\r\n        b = ear,\r\n        c = ear.next;\r\n\r\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\r\n\r\n    // triangle bbox; min & max are calculated like this for speed\r\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\r\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\r\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\r\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\r\n\r\n    // z-order range for the current triangle bbox;\r\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\r\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\r\n\r\n    var p = ear.prevZ,\r\n        n = ear.nextZ;\r\n\r\n    // look for points inside the triangle in both directions\r\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\r\n        if (p !== ear.prev && p !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.prevZ;\r\n\r\n        if (n !== ear.prev && n !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\r\n            area(n.prev, n, n.next) >= 0) return false;\r\n        n = n.nextZ;\r\n    }\r\n\r\n    // look for remaining points in decreasing z-order\r\n    while (p && p.z >= minZ) {\r\n        if (p !== ear.prev && p !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\r\n            area(p.prev, p, p.next) >= 0) return false;\r\n        p = p.prevZ;\r\n    }\r\n\r\n    // look for remaining points in increasing z-order\r\n    while (n && n.z <= maxZ) {\r\n        if (n !== ear.prev && n !== ear.next &&\r\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\r\n            area(n.prev, n, n.next) >= 0) return false;\r\n        n = n.nextZ;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n// go through all polygon nodes and cure small local self-intersections\r\nfunction cureLocalIntersections(start, triangles, dim) {\r\n    var p = start;\r\n    do {\r\n        var a = p.prev,\r\n            b = p.next.next;\r\n\r\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\r\n\r\n            triangles.push(a.i / dim);\r\n            triangles.push(p.i / dim);\r\n            triangles.push(b.i / dim);\r\n\r\n            // remove two nodes involved\r\n            removeNode(p);\r\n            removeNode(p.next);\r\n\r\n            p = start = b;\r\n        }\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    return p;\r\n}\r\n\r\n// try splitting polygon into two and triangulate them independently\r\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\r\n    // look for a valid diagonal that divides the polygon into two\r\n    var a = start;\r\n    do {\r\n        var b = a.next.next;\r\n        while (b !== a.prev) {\r\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\r\n                // split the polygon in two by the diagonal\r\n                var c = splitPolygon(a, b);\r\n\r\n                // filter colinear points around the cuts\r\n                a = filterPoints(a, a.next);\r\n                c = filterPoints(c, c.next);\r\n\r\n                // run earcut on each half\r\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\r\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\r\n                return;\r\n            }\r\n            b = b.next;\r\n        }\r\n        a = a.next;\r\n    } while (a !== start);\r\n}\r\n\r\n// link every hole into the outer loop, producing a single-ring polygon without holes\r\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\r\n    var queue = [],\r\n        i, len, start, end, list;\r\n\r\n    for (i = 0, len = holeIndices.length; i < len; i++) {\r\n        start = holeIndices[i] * dim;\r\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n        list = linkedList(data, start, end, dim, false);\r\n        if (list === list.next) list.steiner = true;\r\n        queue.push(getLeftmost(list));\r\n    }\r\n\r\n    queue.sort(compareX);\r\n\r\n    // process holes from left to right\r\n    for (i = 0; i < queue.length; i++) {\r\n        eliminateHole(queue[i], outerNode);\r\n        outerNode = filterPoints(outerNode, outerNode.next);\r\n    }\r\n\r\n    return outerNode;\r\n}\r\n\r\nfunction compareX(a, b) {\r\n    return a.x - b.x;\r\n}\r\n\r\n// find a bridge between vertices that connects hole with an outer ring and and link it\r\nfunction eliminateHole(hole, outerNode) {\r\n    outerNode = findHoleBridge(hole, outerNode);\r\n    if (outerNode) {\r\n        var b = splitPolygon(outerNode, hole);\r\n        filterPoints(b, b.next);\r\n    }\r\n}\r\n\r\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\r\nfunction findHoleBridge(hole, outerNode) {\r\n    var p = outerNode,\r\n        hx = hole.x,\r\n        hy = hole.y,\r\n        qx = -Infinity,\r\n        m;\r\n\r\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\r\n    // segment's endpoint with lesser x will be potential connection point\r\n    do {\r\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\r\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\r\n            if (x <= hx && x > qx) {\r\n                qx = x;\r\n                if (x === hx) {\r\n                    if (hy === p.y) return p;\r\n                    if (hy === p.next.y) return p.next;\r\n                }\r\n                m = p.x < p.next.x ? p : p.next;\r\n            }\r\n        }\r\n        p = p.next;\r\n    } while (p !== outerNode);\r\n\r\n    if (!m) return null;\r\n\r\n    if (hx === qx) return m.prev; // hole touches outer segment; pick lower endpoint\r\n\r\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\r\n    // if there are no points found, we have a valid connection;\r\n    // otherwise choose the point of the minimum angle with the ray as connection point\r\n\r\n    var stop = m,\r\n        mx = m.x,\r\n        my = m.y,\r\n        tanMin = Infinity,\r\n        tan;\r\n\r\n    p = m.next;\r\n\r\n    while (p !== stop) {\r\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\r\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\r\n\r\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\r\n\r\n            if ((tan < tanMin || (tan === tanMin && p.x > m.x)) && locallyInside(p, hole)) {\r\n                m = p;\r\n                tanMin = tan;\r\n            }\r\n        }\r\n\r\n        p = p.next;\r\n    }\r\n\r\n    return m;\r\n}\r\n\r\n// interlink polygon nodes in z-order\r\nfunction indexCurve(start, minX, minY, invSize) {\r\n    var p = start;\r\n    do {\r\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\r\n        p.prevZ = p.prev;\r\n        p.nextZ = p.next;\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    p.prevZ.nextZ = null;\r\n    p.prevZ = null;\r\n\r\n    sortLinked(p);\r\n}\r\n\r\n// Simon Tatham's linked list merge sort algorithm\r\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\r\nfunction sortLinked(list) {\r\n    var i, p, q, e, tail, numMerges, pSize, qSize,\r\n        inSize = 1;\r\n\r\n    do {\r\n        p = list;\r\n        list = null;\r\n        tail = null;\r\n        numMerges = 0;\r\n\r\n        while (p) {\r\n            numMerges++;\r\n            q = p;\r\n            pSize = 0;\r\n            for (i = 0; i < inSize; i++) {\r\n                pSize++;\r\n                q = q.nextZ;\r\n                if (!q) break;\r\n            }\r\n            qSize = inSize;\r\n\r\n            while (pSize > 0 || (qSize > 0 && q)) {\r\n\r\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\r\n                    e = p;\r\n                    p = p.nextZ;\r\n                    pSize--;\r\n                } else {\r\n                    e = q;\r\n                    q = q.nextZ;\r\n                    qSize--;\r\n                }\r\n\r\n                if (tail) tail.nextZ = e;\r\n                else list = e;\r\n\r\n                e.prevZ = tail;\r\n                tail = e;\r\n            }\r\n\r\n            p = q;\r\n        }\r\n\r\n        tail.nextZ = null;\r\n        inSize *= 2;\r\n\r\n    } while (numMerges > 1);\r\n\r\n    return list;\r\n}\r\n\r\n// z-order of a point given coords and inverse of the longer side of data bbox\r\nfunction zOrder(x, y, minX, minY, invSize) {\r\n    // coords are transformed into non-negative 15-bit integer range\r\n    x = 32767 * (x - minX) * invSize;\r\n    y = 32767 * (y - minY) * invSize;\r\n\r\n    x = (x | (x << 8)) & 0x00FF00FF;\r\n    x = (x | (x << 4)) & 0x0F0F0F0F;\r\n    x = (x | (x << 2)) & 0x33333333;\r\n    x = (x | (x << 1)) & 0x55555555;\r\n\r\n    y = (y | (y << 8)) & 0x00FF00FF;\r\n    y = (y | (y << 4)) & 0x0F0F0F0F;\r\n    y = (y | (y << 2)) & 0x33333333;\r\n    y = (y | (y << 1)) & 0x55555555;\r\n\r\n    return x | (y << 1);\r\n}\r\n\r\n// find the leftmost node of a polygon ring\r\nfunction getLeftmost(start) {\r\n    var p = start,\r\n        leftmost = start;\r\n    do {\r\n        if (p.x < leftmost.x) leftmost = p;\r\n        p = p.next;\r\n    } while (p !== start);\r\n\r\n    return leftmost;\r\n}\r\n\r\n// check if a point lies within a convex triangle\r\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\r\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\r\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\r\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\r\n}\r\n\r\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\r\nfunction isValidDiagonal(a, b) {\r\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) &&\r\n           locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b);\r\n}\r\n\r\n// signed area of a triangle\r\nfunction area(p, q, r) {\r\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\r\n}\r\n\r\n// check if two points are equal\r\nfunction equals(p1, p2) {\r\n    return p1.x === p2.x && p1.y === p2.y;\r\n}\r\n\r\n// check if two segments intersect\r\nfunction intersects(p1, q1, p2, q2) {\r\n    if ((equals(p1, q1) && equals(p2, q2)) ||\r\n        (equals(p1, q2) && equals(p2, q1))) return true;\r\n    return area(p1, q1, p2) > 0 !== area(p1, q1, q2) > 0 &&\r\n           area(p2, q2, p1) > 0 !== area(p2, q2, q1) > 0;\r\n}\r\n\r\n// check if a polygon diagonal intersects any polygon segments\r\nfunction intersectsPolygon(a, b) {\r\n    var p = a;\r\n    do {\r\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\r\n                intersects(p, p.next, a, b)) return true;\r\n        p = p.next;\r\n    } while (p !== a);\r\n\r\n    return false;\r\n}\r\n\r\n// check if a polygon diagonal is locally inside the polygon\r\nfunction locallyInside(a, b) {\r\n    return area(a.prev, a, a.next) < 0 ?\r\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\r\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\r\n}\r\n\r\n// check if the middle point of a polygon diagonal is inside the polygon\r\nfunction middleInside(a, b) {\r\n    var p = a,\r\n        inside = false,\r\n        px = (a.x + b.x) / 2,\r\n        py = (a.y + b.y) / 2;\r\n    do {\r\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\r\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\r\n            inside = !inside;\r\n        p = p.next;\r\n    } while (p !== a);\r\n\r\n    return inside;\r\n}\r\n\r\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\r\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\r\nfunction splitPolygon(a, b) {\r\n    var a2 = new Node(a.i, a.x, a.y),\r\n        b2 = new Node(b.i, b.x, b.y),\r\n        an = a.next,\r\n        bp = b.prev;\r\n\r\n    a.next = b;\r\n    b.prev = a;\r\n\r\n    a2.next = an;\r\n    an.prev = a2;\r\n\r\n    b2.next = a2;\r\n    a2.prev = b2;\r\n\r\n    bp.next = b2;\r\n    b2.prev = bp;\r\n\r\n    return b2;\r\n}\r\n\r\n// create a node and optionally link it with previous one (in a circular doubly linked list)\r\nfunction insertNode(i, x, y, last) {\r\n    var p = new Node(i, x, y);\r\n\r\n    if (!last) {\r\n        p.prev = p;\r\n        p.next = p;\r\n\r\n    } else {\r\n        p.next = last.next;\r\n        p.prev = last;\r\n        last.next.prev = p;\r\n        last.next = p;\r\n    }\r\n    return p;\r\n}\r\n\r\nfunction removeNode(p) {\r\n    p.next.prev = p.prev;\r\n    p.prev.next = p.next;\r\n\r\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\r\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\r\n}\r\n\r\nfunction Node(i, x, y) {\r\n    // vertex index in coordinates array\r\n    this.i = i;\r\n\r\n    // vertex coordinates\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    // previous and next vertex nodes in a polygon ring\r\n    this.prev = null;\r\n    this.next = null;\r\n\r\n    // z-order curve value\r\n    this.z = null;\r\n\r\n    // previous and next nodes in z-order\r\n    this.prevZ = null;\r\n    this.nextZ = null;\r\n\r\n    // indicates whether this is a steiner point\r\n    this.steiner = false;\r\n}\r\n\r\n// return a percentage difference between the polygon area and its triangulation area;\r\n// used to verify correctness of triangulation\r\nearcut.deviation = function (data, holeIndices, dim, triangles) {\r\n    var hasHoles = holeIndices && holeIndices.length;\r\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\r\n\r\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\r\n    if (hasHoles) {\r\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\r\n            var start = holeIndices[i] * dim;\r\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\r\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\r\n        }\r\n    }\r\n\r\n    var trianglesArea = 0;\r\n    for (i = 0; i < triangles.length; i += 3) {\r\n        var a = triangles[i] * dim;\r\n        var b = triangles[i + 1] * dim;\r\n        var c = triangles[i + 2] * dim;\r\n        trianglesArea += Math.abs(\r\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\r\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\r\n    }\r\n\r\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\r\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\r\n};\r\n\r\nfunction signedArea(data, start, end, dim) {\r\n    var sum = 0;\r\n    for (var i = start, j = end - dim; i < end; i += dim) {\r\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\r\n        j = i;\r\n    }\r\n    return sum;\r\n}\r\n\r\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\r\nearcut.flatten = function (data) {\r\n    var dim = data[0][0].length,\r\n        result = {vertices: [], holes: [], dimensions: dim},\r\n        holeIndex = 0;\r\n\r\n    for (var i = 0; i < data.length; i++) {\r\n        for (var j = 0; j < data[i].length; j++) {\r\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\r\n        }\r\n        if (i > 0) {\r\n            holeIndex += data[i - 1].length;\r\n            result.holes.push(holeIndex);\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/geom/polygon/Earcut.js?")},"./lib/rexui/lib/plugins/utils/input/IsPointerInBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar IsPointerInBounds = function (gameObject, pointer, preTest, postTest) {\r\n    if (globRect === undefined) {\r\n        globRect = new Phaser.Geom.Rectangle();\r\n    }\r\n    gameObject.getBounds(globRect);\r\n\r\n    if (pointer) {\r\n        if (preTest && !preTest(gameObject, pointer)) {\r\n            return false;\r\n        }\r\n        if (!globRect.contains(pointer.x, pointer.y)) {\r\n            return false;\r\n        }\r\n        if (postTest && !postTest(gameObject, pointer)) {\r\n            return false;\r\n        }\r\n        return true;\r\n\r\n    } else {\r\n        var inputManager = gameObject.scene.input.manager;\r\n        var pointersTotal = inputManager.pointersTotal;\r\n        var pointers = inputManager.pointers;\r\n        for (var i = 0; i < pointersTotal; i++) {\r\n            pointer = pointers[i];\r\n            if (preTest && !preTest(gameObject, pointer)) {\r\n                continue;\r\n            }\r\n            if (!globRect.contains(pointer.x, pointer.y)) {\r\n                continue;\r\n            }\r\n            if (postTest && !postTest(gameObject, pointer)) {\r\n                continue;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n\r\n    }\r\n\r\n}\r\n\r\nvar globRect = undefined;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsPointerInBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/input/IsPointerInBounds.js?')},"./lib/rexui/lib/plugins/utils/input/StopPropagationTouchEvents.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar StopPropagationTouchEvents = function (element) {\r\n    // Don\'t propagate touch/mouse events to parent(game canvas)\r\n    element.addEventListener("touchstart", callback, false);\r\n    element.addEventListener("touchmove", callback, false);\r\n    element.addEventListener("touchend", callback, false);\r\n    element.addEventListener("mousedown", callback, false);\r\n    element.addEventListener("mouseup", callback, false);\r\n    element.addEventListener("mousemove", callback, false);\r\n}\r\n\r\nvar callback = function (e) {\r\n    e.stopPropagation();\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (StopPropagationTouchEvents);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/input/StopPropagationTouchEvents.js?')},"./lib/rexui/lib/plugins/utils/mask/DefaultMask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst Graphics = Phaser.GameObjects.Graphics;\r\n\r\nclass DefaultMask extends Graphics {\r\n    constructor(parent, shape, padding) {\r\n        if (shape === undefined) {\r\n            shape = 0;\r\n        }\r\n        if (typeof (shape) === 'string') {\r\n            shaep = SHAPEMODE[shape];\r\n        }\r\n        if (padding === undefined) {\r\n            padding = 0;\r\n        }\r\n\r\n        super(parent.scene);\r\n        this.parent = parent;\r\n        this.shape = shape;\r\n        this.padding = padding;\r\n        this.setPosition().resize();\r\n        // Don't add it to display list\r\n        // Graphics does not have origin, bounds\r\n    }\r\n\r\n    destroy() {\r\n        this.parent = undefined;\r\n        super.destroy();\r\n        return this;\r\n    }\r\n\r\n    setPosition(x, y) {\r\n        var parent = this.parent;\r\n        if (parent)\r\n            var worldpos = parent.getWorldTransformMatrix();\r\n        if (x === undefined) {\r\n            x = (worldpos.tx ? worldpos.tx : parent.x);\r\n        }\r\n        if (y === undefined) {\r\n            y = (worldpos.ty ? worldpos.ty : parent.y);\r\n        }\r\n        super.setPosition(x, y);\r\n        return this;\r\n    }\r\n\r\n    resize(width, height, padding) {\r\n        var parent = this.parent;\r\n        var zoom = parent.zoom === undefined ? 1 : parent.zoom;\r\n        if (width === undefined) {\r\n            width = parent.width * zoom;\r\n        }\r\n        if (height === undefined) {\r\n            height = parent.height * zoom;\r\n        }\r\n        if (padding === undefined) {\r\n            padding = this.padding * zoom;\r\n        }\r\n        // if(padding===undefined)padding = 4;\r\n        if ((this.widthSave === width) && (this.heightSave === height) && (this.paddingSave === padding)) {\r\n            return this;\r\n        }\r\n\r\n        this.clear().fillStyle(0xffffff);\r\n        switch (this.shape) {\r\n            case 1: // circle\r\n                var radius = Math.min(width, height) / 2;\r\n                this.fillCircle(\r\n                    0,\r\n                    0,\r\n                    radius + padding\r\n                );\r\n                break;\r\n            default: // 0|'rectangle'\r\n                this.fillRect(\r\n                    -(width * parent.originX) - padding,\r\n                    -(height * parent.originY) - padding,\r\n                    width + (2 * padding),\r\n                    height + (2 * padding)\r\n                );\r\n                break;\r\n        }\r\n        this.widthSave = width;\r\n        this.heightSave = height;\r\n        this.paddingSave = padding;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst SHAPEMODE = {\r\n    rectangle: 0,\r\n    circle: 1,\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (DefaultMask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/mask/DefaultMask.js?")},"./lib/rexui/lib/plugins/utils/mask/MaskToGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar MaskToGameObject = function (mask) {\r\n    return (mask.hasOwnProperty('geometryMask')) ? mask.geometryMask : mask.bitmapMask;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MaskToGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/mask/MaskToGameObject.js?")},"./lib/rexui/lib/plugins/utils/math/DegToRad.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2018 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\nconst DEG_TO_RAD = Math.PI / 180;\r\n\r\n/**\r\n * Convert the given angle from degrees, to the equivalent angle in radians.\r\n *\r\n * @function Phaser.Math.DegToRad\r\n * @since 3.0.0\r\n *\r\n * @param {integer} degrees - The angle (in degrees) to convert to radians.\r\n *\r\n * @return {number} The given angle converted to radians.\r\n */\r\nvar DegToRad = function (degrees)\r\n{\r\n    return degrees * DEG_TO_RAD;\r\n};\r\n\r\nmodule.exports = DegToRad;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/math/DegToRad.js?")},"./lib/rexui/lib/plugins/utils/math/angle/angletodirections/AngleToDirections.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar AngleToDirections = function (angle, dirMode, out) {\r\n    if (out === undefined) {\r\n        out = {}\r\n    } else if (out === true) {\r\n        out = tmpOut;\r\n    }\r\n\r\n    out.left = false;\r\n    out.right = false;\r\n    out.up = false;\r\n    out.down = false;\r\n\r\n    angle = (angle + 360) % 360;\r\n    switch (dirMode) {\r\n        case 0: // up & down\r\n            if (angle < 180) {\r\n                out.down = true;\r\n            } else {\r\n                out.up = true;\r\n            }\r\n            break;\r\n\r\n        case 1: // left & right\r\n            if ((angle > 90) && (angle <= 270)) {\r\n                out.left = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n\r\n        case 2: // 4 dir\r\n            if ((angle > 45) && (angle <= 135)) {\r\n                out.down = true;\r\n            } else if ((angle > 135) && (angle <= 225)) {\r\n                out.left = true;\r\n            } else if ((angle > 225) && (angle <= 315)) {\r\n                out.up = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n\r\n        case 3: // 8 dir\r\n            if ((angle > 22.5) && (angle <= 67.5)) {\r\n                out.down = true;\r\n                out.right = true;\r\n            } else if ((angle > 67.5) && (angle <= 112.5)) {\r\n                out.down = true;\r\n            } else if ((angle > 112.5) && (angle <= 157.5)) {\r\n                out.down = true;\r\n                out.left = true;\r\n            } else if ((angle > 157.5) && (angle <= 202.5)) {\r\n                out.left = true;\r\n            } else if ((angle > 202.5) && (angle <= 247.5)) {\r\n                out.left = true;\r\n                out.up = true;\r\n            } else if ((angle > 247.5) && (angle <= 292.5)) {\r\n                out.up = true;\r\n            } else if ((angle > 292.5) && (angle <= 337.5)) {\r\n                out.up = true;\r\n                out.right = true;\r\n            } else {\r\n                out.right = true;\r\n            }\r\n            break;\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\nvar tmpOut = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (AngleToDirections);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/math/angle/angletodirections/AngleToDirections.js?')},"./lib/rexui/lib/plugins/utils/math/angle/angletodirections/Const.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    'up&down': 0,\r\n    'left&right': 1,\r\n    '4dir': 2,\r\n    '8dir': 3\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/math/angle/angletodirections/Const.js?")},"./lib/rexui/lib/plugins/utils/movement/Movement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Movement {\r\n    constructor(config) {\r\n        this.resetFromJSON(config);\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.setValue(GetValue(o, 'value', 0));\r\n        this.setSpeed(GetValue(o, 'speed', 0));\r\n        this.setAcceleration(GetValue(o, 'acceleration', 0));\r\n        return this;\r\n    }\r\n\r\n    reset() {\r\n        this.setValue(0);\r\n        this.setSpeed(0);\r\n        this.setAcceleration(0);\r\n    }\r\n\r\n    setValue(value) {\r\n        this.value = value;\r\n        return this;\r\n    }\r\n\r\n    setSpeed(speed) {\r\n        // speed == 0 : stop\r\n        // speed  > 0 : move\r\n        this.speed = speed;\r\n        return this;        \r\n    }\r\n\r\n    setAcceleration(acc) {\r\n        // acc == 0 : constant speed\r\n        // acc  > 0 : acceleration\r\n        // acc  < 0 : deceleration\r\n        this.acceleration = acc;\r\n        return this;\r\n    }\r\n\r\n    updateSpeed(delta) {\r\n        // delta in sec\r\n        if (this.acceleration !== 0) {\r\n            this.speed += (this.acceleration * delta);\r\n            if (this.speed < 0) {\r\n                this.speed = 0;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    getDeltaValue(delta) {\r\n        // delta in sec\r\n        this.updateSpeed(delta);\r\n        if (this.speed <= 0) {\r\n            return 0;\r\n        }\r\n        return (this.speed * delta);\r\n    }\r\n\r\n    update(delta) {\r\n        // delta in sec\r\n        this.updateSpeed(delta);\r\n        if (this.speed > 0) {\r\n            this.value += this.getDeltaValue(delta);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isMoving() {\r\n        return (this.speed > 0);\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Movement);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/movement/Movement.js?")},"./lib/rexui/lib/plugins/utils/movement/SlowDown.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Movement_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Movement.js */ "./lib/rexui/lib/plugins/utils/movement/Movement.js");\n\r\n\r\nclass SlowDown {\r\n    constructor() {\r\n        this.value;\r\n        this.dir; // true:+, false:-\r\n        this.movement = new _Movement_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\r\n    }\r\n\r\n    init(start, dir, speed, dec, end) {\r\n        this.value = start;\r\n        this.end = end;\r\n        if (end !== undefined) {\r\n            this.dir = (start < end);\r\n        } else {\r\n            this.dir = dir;\r\n        }\r\n\r\n        this.movement\r\n            .setSpeed(speed)\r\n            .setAcceleration(-dec);\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.movement.reset();\r\n    }\r\n\r\n    update(delta) {\r\n        // delta in sec\r\n        var d = this.movement.getDeltaValue(delta);\r\n        if (!this.dir) {\r\n            d = -d;\r\n        }\r\n\r\n        if (this.end === undefined) {\r\n            this.value += d;\r\n        } else {\r\n            if (d === 0) {\r\n                this.value = this.end;\r\n            } else {\r\n                this.value += d;\r\n                if (this.dir) { // +\r\n                    if (this.value > this.end) {\r\n                        this.value = this.end;\r\n                    }\r\n                } else { // -\r\n                    if (this.value < this.end) {\r\n                        this.value = this.end;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isMoving() {\r\n        return this.movement.isMoving;\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SlowDown);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/movement/SlowDown.js?')},"./lib/rexui/lib/plugins/utils/object/Clear.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Clear = function (obj) {\r\n    if (Array.isArray(obj)) {\r\n        obj.length = 0;\r\n    } else {\r\n        for (var key in obj) {\r\n            delete obj[key];\r\n        }\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Clear);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/Clear.js?')},"./lib/rexui/lib/plugins/utils/object/Clone.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Clear_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Clear.js */ "./lib/rexui/lib/plugins/utils/object/Clear.js");\n\r\n\r\n/**\r\n * Shallow Object Clone. Will not out nested objects.\r\n * @param {object} obj JSON object\r\n * @param {object} ret JSON object to return, set null to return a new object\r\n * @returns {object} this object\r\n */\r\nvar Clone = function (obj, out) {\r\n    var objIsArray = Array.isArray(obj);\r\n\r\n    if (out === undefined) {\r\n        out = (objIsArray) ? [] : {};\r\n    } else {\r\n        Object(_Clear_js__WEBPACK_IMPORTED_MODULE_0__["default"])(out);\r\n    }\r\n\r\n    if (objIsArray) {\r\n        out.length = obj.length;\r\n        for (var i = 0, cnt = obj.length; i < cnt; i++) {\r\n            out[i] = obj[i];\r\n        }\r\n    } else {\r\n        for (var key in obj) {\r\n            out[key] = obj[key];\r\n        }\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Clone);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/Clone.js?')},"./lib/rexui/lib/plugins/utils/object/GetValue.js":function(module,exports){eval("/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n//  Source object\r\n//  The key as a string, or an array of keys, i.e. 'banner', or 'banner.hideBanner'\r\n//  The default value to use if the key doesn't exist\r\n\r\n/**\r\n * Retrieves a value from an object.\r\n *\r\n * @function Phaser.Utils.Objects.GetValue\r\n * @since 3.0.0\r\n *\r\n * @param {object} source - The object to retrieve the value from.\r\n * @param {string} key - The name of the property to retrieve from the object. If a property is nested, the names of its preceding properties should be separated by a dot (`.`) - `banner.hideBanner` would return the value of the `hideBanner` property from the object stored in the `banner` property of the `source` object.\r\n * @param {*} defaultValue - The value to return if the `key` isn't found in the `source` object.\r\n *\r\n * @return {*} The value of the requested key.\r\n */\r\nvar GetValue = function (source, key, defaultValue)\r\n{\r\n    if (!source || typeof source === 'number')\r\n    {\r\n        return defaultValue;\r\n    }\r\n    else if (source.hasOwnProperty(key))\r\n    {\r\n        return source[key];\r\n    }\r\n    else if (key.indexOf('.') !== -1)\r\n    {\r\n        var keys = key.split('.');\r\n        var parent = source;\r\n        var value = defaultValue;\r\n\r\n        //  Use for loop here so we can break early\r\n        for (var i = 0; i < keys.length; i++)\r\n        {\r\n            if (parent.hasOwnProperty(keys[i]))\r\n            {\r\n                //  Yes it has a key property, let's carry on down\r\n                value = parent[keys[i]];\r\n\r\n                parent = parent[keys[i]];\r\n            }\r\n            else\r\n            {\r\n                //  Can't go any further, so reset to default\r\n                value = defaultValue;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return value;\r\n    }\r\n    else\r\n    {\r\n        return defaultValue;\r\n    }\r\n};\r\n\r\nmodule.exports = GetValue;\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/GetValue.js?")},"./lib/rexui/lib/plugins/utils/object/IsArray.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar IsArray = function(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Array]';\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (IsArray);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/IsArray.js?")},"./lib/rexui/lib/plugins/utils/object/IsFunction.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar IsFunction = function (obj) {    \r\n    return obj && (typeof(obj) === 'function');\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (IsFunction);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/IsFunction.js?")},"./lib/rexui/lib/plugins/utils/object/NOOP.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar NOOP = function () {\r\n    //  NOOP\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (NOOP);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/NOOP.js?')},"./lib/rexui/lib/plugins/utils/object/SetValue.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar IsInValidKey = function (keys) {\r\n    return (keys == null) || (keys === '') || (keys.length === 0);\r\n};\r\n\r\nvar GetEntry = function (target, keys, defaultEntry) {\r\n    var entry = target;\r\n    if (IsInValidKey(keys)) {\r\n        //entry = root;\r\n    } else {\r\n        if (typeof (keys) === 'string') {\r\n            keys = keys.split('.');\r\n        }\r\n\r\n        var key;\r\n        for (var i = 0, cnt = keys.length; i < cnt; i++) {\r\n            key = keys[i];\r\n            if ((entry[key] == null) || (typeof (entry[key]) !== 'object')) {\r\n                var newEntry;\r\n                if (i === cnt - 1) {\r\n                    if (defaultEntry === undefined) {\r\n                        newEntry = {};\r\n                    } else {\r\n                        newEntry = defaultEntry;\r\n                    }\r\n                } else {\r\n                    newEntry = {};\r\n                }\r\n\r\n                entry[key] = newEntry;\r\n            }\r\n\r\n            entry = entry[key];\r\n        }\r\n    }\r\n\r\n    return entry;\r\n};\r\n\r\nvar SetValue = function (target, keys, value) {\r\n    // no object\r\n    if (typeof (target) !== 'object') {\r\n        return;\r\n    }\r\n\r\n    // invalid key\r\n    else if (IsInValidKey(keys)) {\r\n        // don't erase target\r\n        if (value == null) {\r\n            return;\r\n        }\r\n        // set target to another object\r\n        else if (typeof (value) === 'object') {\r\n            target = value;\r\n        }\r\n    } else {\r\n        if (typeof (keys) === 'string') {\r\n            keys = keys.split('.');\r\n        }\r\n\r\n        var lastKey = keys.pop();\r\n        var entry = GetEntry(target, keys);\r\n        entry[lastKey] = value;\r\n    }\r\n\r\n    return target;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetValue);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/object/SetValue.js?")},"./lib/rexui/lib/plugins/utils/promise/WaitEvent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WaitEvent", function() { return WaitEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WaitComplete", function() { return WaitComplete; });\nvar WaitEvent = function (eventEmitter, eventName) {\r\n    return new Promise(function (resolve, reject) {\r\n        eventEmitter.once(eventName, function () {\r\n            resolve();\r\n        });\r\n    });\r\n}\r\n\r\nvar WaitComplete = function (eventEmitter) {\r\n    return WaitEvent(eventEmitter, \'complete\');\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/promise/WaitEvent.js?')},"./lib/rexui/lib/plugins/utils/renderTexture/MakeChildImageGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar MakeChildImageGameObject = function (parent, key, className) {\r\n    if (className === undefined) {\r\n        className = 'image';\r\n    }\r\n    if (!parent[key]) {\r\n        parent[key] = parent.scene.make[className]({\r\n            add: false,\r\n            origin: { x: 0, y: 0 },\r\n        });\r\n        parent.on('destroy', function () {\r\n            if (parent[key]) {\r\n                parent[key].destroy();\r\n                parent[key] = undefined;\r\n            }\r\n        })\r\n    }\r\n    return parent[key];\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MakeChildImageGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/renderTexture/MakeChildImageGameObject.js?")},"./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GetDisplayWidth", function() { return GetDisplayWidth; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GetDisplayHeight", function() { return GetDisplayHeight; });\nvar GetDisplayWidth = function (gameObject) {\r\n    if (gameObject.displayWidth !== undefined) {\r\n        return gameObject.displayWidth;\r\n    } else {\r\n        return gameObject.width;\r\n    }\r\n}\r\n\r\nvar GetDisplayHeight = function (gameObject) {\r\n    if (gameObject.displayHeight !== undefined) {\r\n        return gameObject.displayHeight;\r\n    } else {\r\n        return gameObject.height;\r\n    }\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js?')},"./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ResizeGameObject = function (gameObject, newWidth, newHeight) {\r\n    if (!gameObject || ((newWidth === undefined) && (newHeight === undefined))) {\r\n        return;\r\n    }\r\n    if (gameObject.resize) { // Has `resize` method\r\n        if (newWidth === undefined) {\r\n            newWidth = gameObject.width;\r\n        }\r\n        if (newHeight === undefined) {\r\n            newHeight = gameObject.height;\r\n        }\r\n        gameObject.resize(newWidth, newHeight);\r\n    } else { // Set display width/height\r\n        if (newWidth !== undefined) {\r\n            gameObject.displayWidth = newWidth;\r\n        }\r\n        if (newHeight !== undefined) {\r\n            gameObject.displayHeight = newHeight;\r\n        }\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResizeGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js?')},"./lib/rexui/lib/plugins/utils/struct/Stack.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nclass Stack {\r\n    constructor() {\r\n        this.items = [];\r\n    }\r\n\r\n    destroy() {\r\n        this.clear();\r\n        this.items = undefined;\r\n    }\r\n\r\n    pop() {\r\n        return (this.items.length > 0) ? this.items.pop() : null;\r\n    }\r\n\r\n    push(l) {\r\n        this.items.push(l);\r\n        return this;\r\n    }\r\n\r\n    pushMultiple(arr) {\r\n        this.items.push.apply(this.items, arr);\r\n        arr.length = 0;\r\n        return this;\r\n    }\r\n\r\n    clear() {\r\n        this.items.length = 0;\r\n        return this;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Stack);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/struct/Stack.js?')},"./lib/rexui/lib/plugins/utils/system/GetSceneObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./IsSceneObject.js */ "./lib/rexui/lib/plugins/utils/system/IsSceneObject.js");\n\r\n\r\nvar GetSceneObject = function (object) {\r\n    if (Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object)) { // object = scene\r\n        return object;\r\n    } else if (object.scene && Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object.scene)) { // object = game object\r\n        return object.scene;\r\n    } else if (object.parent && object.parent.scene && Object(_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(object.parent.scene)) { // parent = bob object\r\n        return object.parent.scene;\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetSceneObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/system/GetSceneObject.js?')},"./lib/rexui/lib/plugins/utils/system/IsGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst GameObjectClass = Phaser.GameObjects.GameObject;\r\nvar IsGameObject = function (object) {\r\n    return (object instanceof GameObjectClass);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (IsGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/system/IsGameObject.js?')},"./lib/rexui/lib/plugins/utils/system/IsSceneObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst SceneClass = Phaser.Scene;\r\nvar IsSceneObject = function (object) {\r\n    return (object instanceof SceneClass);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (IsSceneObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/system/IsSceneObject.js?')},"./lib/rexui/lib/plugins/utils/text/IsTextGameObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst TextKlass = Phaser.GameObjects.Text;\r\n\r\nvar IsTextGameObject = function (gameObject) {\r\n    return (gameObject instanceof TextKlass);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (IsTextGameObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/text/IsTextGameObject.js?')},"./lib/rexui/lib/plugins/utils/ticktask/TickTask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../eventemitter/EventEmitterMethods.js */ \"./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TickTask {\r\n    constructor(parent, config) {\r\n        this.parent = parent;\r\n        this._isRunning = false;\r\n        this.tickingState = false;\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n        this.setTickingMode(GetValue(config, 'tickingMode', 1));\r\n    }\r\n\r\n    // override\r\n    boot() {\r\n        if ((this.tickingMode === 2) && (!this.tickingState)) {\r\n            this.startTicking();\r\n        }\r\n    }\r\n\r\n    // override\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        if (this.tickingState) {\r\n            this.stopTicking();\r\n        }        \r\n    }\r\n\r\n    setTickingMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = TICKINGMODE[mode];\r\n        }\r\n        this.tickingMode = mode;\r\n    }\r\n\r\n    // override\r\n    startTicking() {\r\n        this.tickingState = true;\r\n    }\r\n\r\n    // override\r\n    stopTicking() {\r\n        this.tickingState = false;\r\n    }\r\n\r\n    get isRunning() {\r\n        return this._isRunning;\r\n    }\r\n\r\n    set isRunning(value) {\r\n        if (this._isRunning === value) {\r\n            return;\r\n        }\r\n\r\n        this._isRunning = value;\r\n        if ((this.tickingMode === 1) && (value != this.tickingState)) {\r\n            if (value) {\r\n                this.startTicking();\r\n            } else {\r\n                this.stopTicking();\r\n            }\r\n        }\r\n    }\r\n\r\n    start() {\r\n        this.isRunning = true;\r\n        return this;\r\n    }\r\n\r\n    pause() {\r\n        this.isRunning = false;\r\n        return this;\r\n    }\r\n\r\n    resume() {\r\n        this.isRunning = true;\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this.isRunning = false;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.isRunning = false;\r\n        this.emit('complete', this.parent, this);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    TickTask.prototype,\r\n    _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]\r\n);\r\n\r\nconst TICKINGMODE = {\r\n    'no': 0,\r\n    'lazy': 1,\r\n    'always': 2\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TickTask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/ticktask/TickTask.js?")},"./lib/rexui/lib/plugins/utils/tween/TweenBase.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../eventemitter/EventEmitterMethods.js */ "./lib/rexui/lib/plugins/utils/eventemitter/EventEmitterMethods.js");\n/* harmony import */ var _system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../system/GetSceneObject.js */ "./lib/rexui/lib/plugins/utils/system/GetSceneObject.js");\n/* harmony import */ var _system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../system/IsGameObject.js */ "./lib/rexui/lib/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _system_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../system/IsSceneObject.js */ "./lib/rexui/lib/plugins/utils/system/IsSceneObject.js");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TweenBase {\r\n    constructor(parent, config) {\r\n        this.parent = parent;\r\n        this.scene = Object(_system_GetSceneObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(parent);\r\n\r\n        /*\r\n        eventEmitter:\r\n        - false(default value): Use tween\'s event emitter.\r\n        - true: Create a private event emitter.\r\n        */\r\n        var eventEmitter = GetValue(config, \'eventEmitter\', false);\r\n        if (eventEmitter === true) {\r\n            eventEmitter = undefined;\r\n        }\r\n        this.setEventEmitter(eventEmitter);\r\n        this.boot();\r\n    }\r\n\r\n    boot() {\r\n        if (Object(_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(this.parent)) { // Parent is Game Object\r\n            if (this.parent.once) { // oops, bob object does not have event emitter\r\n                this.parent.on(\'destroy\', this.destroy, this);\r\n            }\r\n        } else if (Object(_system_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_3__["default"])(this.parent)) { // Parent is Scene Object\r\n            this.parent.events.once(\'shutdown\', this.destroy, this);\r\n        } else {\r\n            // ??\r\n        }\r\n    }\r\n\r\n    shutdown() {\r\n        this.stop();\r\n        if (Object(_system_IsSceneObject_js__WEBPACK_IMPORTED_MODULE_3__["default"])(this.parent)) {  // Parent is Scene Object\r\n            this.parent.events.off(\'shutdown\', this.destroy, this);\r\n        }\r\n        this.destroyEventEmitter();\r\n        this.parent = undefined;\r\n        this.scene = undefined;\r\n        return this;\r\n    }\r\n\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n        return this;\r\n    }\r\n\r\n    start(tweenConfig) {\r\n        if (this.isRunning) {\r\n            return this;\r\n        }\r\n\r\n        this.tween = this.scene.tweens.add(tweenConfig)\r\n            .on(\'complete\', this.complete, this);\r\n        if (this.getEventEmitter() === false) {\r\n            this.setEventEmitter(this.tween);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    restart() {\r\n        this.stop().start();\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        if (!this.tween) {\r\n            return this;\r\n        }\r\n\r\n        if (this.getEventEmitter() === this.tween) {\r\n            this.setEventEmitter(false);\r\n        }\r\n        this.tween.remove();\r\n        this.tween = undefined;\r\n        return this;\r\n    }\r\n\r\n    complete() {\r\n        this.stop();\r\n        if (this.getEventEmitter()) {\r\n            this.emit(\'complete\');\r\n        }\r\n        return this;\r\n    }\r\n\r\n    get isRunning() {\r\n        return (!!this.tween);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    TweenBase.prototype,\r\n    _eventemitter_EventEmitterMethods_js__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TweenBase);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/plugins/utils/tween/TweenBase.js?')},"./lib/rexui/lib/ui/ObjectFactory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nclass ObjectFactory {\r\n    constructor(scene) {\r\n        this.scene = scene;\r\n    }\r\n\r\n    static register(type, callback) {\r\n        ObjectFactory.prototype[type] = callback;\r\n    }\r\n};\r\n/* harmony default export */ __webpack_exports__["default"] = (ObjectFactory);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ObjectFactory.js?')},"./lib/rexui/lib/ui/baseUI/BaseMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseMediator", function() { return BaseMediator; });\n/* harmony import */ var _interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\n\r\nvar BaseMediator = /** @class */ (function () {\r\n    function BaseMediator() {\r\n        /**\r\n         * 面板处于打开状态\r\n         */\r\n        this.mShow = false;\r\n        this.mUIType = _interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_0__["UIType"].None;\r\n    }\r\n    Object.defineProperty(BaseMediator.prototype, "UIType", {\r\n        get: function () {\r\n            return this.mUIType;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BaseMediator.prototype.updateViewPos = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.updatePos();\r\n    };\r\n    BaseMediator.prototype.tweenExpand = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenExpand(show);\r\n    };\r\n    BaseMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    BaseMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        var view = this.getView();\r\n        if (view)\r\n            view.hide();\r\n    };\r\n    BaseMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    BaseMediator.prototype.isShow = function () {\r\n        return this.mShow;\r\n    };\r\n    BaseMediator.prototype.resize = function (width, height) {\r\n        var view = this.getView();\r\n        if (view && view.isShow())\r\n            view.resize(width, height);\r\n    };\r\n    BaseMediator.prototype.show = function (param) {\r\n        this.mShow = true;\r\n    };\r\n    BaseMediator.prototype.update = function (param) {\r\n        var view = this.getView();\r\n        if (view)\r\n            view.update(param);\r\n    };\r\n    BaseMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    BaseMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    BaseMediator.prototype.destroy = function () {\r\n        this.mShow = false;\r\n        this.mParam = null;\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    return BaseMediator;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/baseUI/BaseMediator.ts?')},"./lib/rexui/lib/ui/baseUI/BaseUI.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseUI", function() { return BaseUI; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/**\r\n * @class BaseUI\r\n * @memberof TooqinUI\r\n * @extends Phaser.GameObjects.Container\r\n */\r\nvar BaseUI = /** @class */ (function (_super) {\r\n    __extends(BaseUI, _super);\r\n    function BaseUI(scene, dpr, scale) {\r\n        var _this = _super.call(this, scene) || this;\r\n        /**\r\n         * 是否静音\r\n         */\r\n        _this.silent = false;\r\n        /**\r\n         * 移动端像素密度\r\n         */\r\n        _this.dpr = 1;\r\n        /**\r\n         * 是否初始化\r\n         */\r\n        _this.mInitialized = false;\r\n        _this.interactiveBoo = false;\r\n        _this.mShow = false;\r\n        _this.dpr = dpr || 1;\r\n        _this.scale = scale || 1;\r\n        _this.soundMap = new Map();\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    BaseUI.prototype.setFollow = function (gameObject, froscene, posFunc) {\r\n        this.mFollow = gameObject;\r\n        this.mFroscene = froscene;\r\n        if (posFunc)\r\n            this.posFunc = posFunc;\r\n    };\r\n    BaseUI.prototype.updatePos = function () {\r\n        if (!this.mShow)\r\n            return;\r\n        if (this.posFunc) {\r\n            this.posFunc({\r\n                scene: this.mFroscene,\r\n                followX: this.mFollow.x,\r\n                followY: this.mFollow.y,\r\n                baseX: this.x,\r\n                baseY: this.y\r\n            });\r\n        }\r\n        else {\r\n            var camera = this.mFroscene.cameras.main;\r\n            var px = this.x - camera.scrollX;\r\n            var py = this.y - camera.scrollY;\r\n            this.x = px;\r\n            this.y = py;\r\n        }\r\n    };\r\n    BaseUI.prototype.setInteractive = function (shape, callback, dropZone) {\r\n        this.interactiveBoo = true;\r\n        _super.prototype.setInteractive.call(this, shape, callback, dropZone);\r\n        return this;\r\n    };\r\n    BaseUI.prototype.disInteractive = function () {\r\n        this.interactiveBoo = false;\r\n        _super.prototype.disableInteractive.call(this);\r\n    };\r\n    BaseUI.prototype.addListen = function () {\r\n        // if (!this.mInitialized) return;\r\n        // let sizeBoo: boolean = true;\r\n        // if (this.width === 0 || this.height === 0) {\r\n        //     sizeBoo = false;\r\n        // }\r\n        // if (this.interactiveBoo) {\r\n        //     if (sizeBoo) {\r\n        //         this.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width, this.height), Phaser.Geom.Rectangle.Contains);\r\n        //         this.on("pointerup", this.uiClick, this);\r\n        //     }\r\n        //     this.scene.input.off("pointerup", this.sceneClick, this);\r\n        // } else {\r\n        //     if (sizeBoo) {\r\n        //         this.disableInteractive();\r\n        //         this.off("pointerup", this.uiClick, this);\r\n        //     }\r\n        //     this.scene.input.on("pointerup", this.sceneClick, this);\r\n        // }\r\n    };\r\n    BaseUI.prototype.removeListen = function () {\r\n        // if (!this.mInitialized) return;\r\n        // this.scene.input.off("pointerup", this.sceneClick, this);\r\n        // this.off("pointerup", this.uiClick, this);\r\n    };\r\n    BaseUI.prototype.playSound = function (config) {\r\n        if (this.silent)\r\n            return;\r\n        // if (config.key === undefined) {\r\n        //     if (typeof config.urls === "string") {\r\n        //         config.key = config.urls;\r\n        //     } else {\r\n        //         config.key = config.urls[0];\r\n        //     }\r\n        // }\r\n        var key = config.key;\r\n        // const urls = config.urls;\r\n        if (this.scene.cache.audio.exists(key)) {\r\n            this.startPlay(config);\r\n        }\r\n        else {\r\n            // this.scene.load.once(`filecomplete-audio-${key}`, () => {\r\n            //     this.startPlay(config);\r\n            // }, this);\r\n            // this.scene.load.audio(key, urls);\r\n            // this.scene.load.start();\r\n        }\r\n    };\r\n    BaseUI.prototype.startPlay = function (config) {\r\n        if (this.silent)\r\n            return;\r\n        var key = config.key;\r\n        var sound = this.soundMap.get(key);\r\n        if (!sound) {\r\n            sound = this.scene.sound.add(key, config.soundConfig);\r\n            this.soundMap.set(key, sound);\r\n        }\r\n        if (sound.isPlaying) {\r\n            return;\r\n        }\r\n        sound.play();\r\n    };\r\n    BaseUI.prototype.stopSound = function () {\r\n        if (this.silent)\r\n            return;\r\n        this.soundMap.forEach(function (sound) {\r\n            if (sound.isPlaying)\r\n                sound.stop();\r\n        });\r\n    };\r\n    BaseUI.prototype.pauseSound = function () {\r\n        if (this.silent)\r\n            return;\r\n        this.soundMap.forEach(function (sound) {\r\n            if (!sound.isPaused)\r\n                sound.pause();\r\n        });\r\n    };\r\n    BaseUI.prototype.resumeSound = function () {\r\n        if (this.silent)\r\n            return;\r\n        this.soundMap.forEach(function (sound) {\r\n            if (sound.isPaused)\r\n                sound.resume();\r\n        });\r\n    };\r\n    BaseUI.prototype.setSilent = function (boo) {\r\n        this.silent = boo;\r\n    };\r\n    BaseUI.prototype.destroy = function () {\r\n        this.soundMap.forEach(function (sound) {\r\n            if (sound.isPlaying)\r\n                sound.stop();\r\n        });\r\n        this.mInitialized = false;\r\n        this.interactiveBoo = false;\r\n        this.silent = false;\r\n        this.removeListen();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    // protected sceneClick(pointer: Phaser.Input.Pointer) {\r\n    //     if (Tool.checkPointerContains(this, pointer) && this.checkPointerDelection(pointer)) {\r\n    //         this.emit("uiClick");\r\n    //     }\r\n    // }\r\n    // protected uiClick(pointer: Phaser.Input.Pointer) {\r\n    //     if (this.checkPointerDelection(pointer)) {\r\n    //         this.emit("uiClick");\r\n    //     }\r\n    // }\r\n    BaseUI.prototype.checkPointerDelection = function (pointer) {\r\n        if (!this.scene)\r\n            return true;\r\n        return Math.abs(pointer.downX - pointer.upX) < 10 * this.dpr * this.scale ||\r\n            Math.abs(pointer.downY - pointer.upY) < 10 * this.dpr * this.scale;\r\n    };\r\n    return BaseUI;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/baseUI/BaseUI.ts?')},"./lib/rexui/lib/ui/basesizer/AddChildrenMap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/**\r\n * @function tooqinui.Base.AddChildrenMap\r\n * @param {*} key \r\n * @param {*} gameObject \r\n */\r\nvar AddChildrenMap = function (key, gameObject) {\r\n    if (this.childrenMap === undefined) {\r\n        this.childrenMap = {};\r\n    }\r\n    this.childrenMap[key] = gameObject;\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (AddChildrenMap);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/AddChildrenMap.js?')},"./lib/rexui/lib/ui/basesizer/BaseSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _container_Container_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../container/Container.js */ "./lib/rexui/lib/ui/container/Container.js");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ "./lib/rexui/lib/ui/basesizer/Methods.js");\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n/**\r\n * @class Base\r\n * @memberof tooqinui\r\n * @constructor\r\n * @param {Phaser.Scene} scene \r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} minWidth\r\n * @param {number} minHeight\r\n * @param {*} config\r\n * \r\n */\r\nclass Base extends _container_Container_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        super(scene, x, y, 2, 2);\r\n        /**\r\n         * @name Base.isRexSizer\r\n         * @type {boolean}\r\n         */\r\n        this.isRexSizer = true;\r\n        this.setMinSize(minWidth, minHeight);\r\n        this.setName(GetValue(config, \'name\', \'\'));\r\n        /**\r\n         * @name Base.rexSizer\r\n         * @type {*}\r\n         */\r\n        this.rexSizer = {};\r\n        /**\r\n         * @name Base.backgroundChildren\r\n         * @type {*}\r\n         */\r\n        this.backgroundChildren = undefined;\r\n\r\n        var anchorConfig = GetValue(config, \'anchor\', undefined);\r\n        if (anchorConfig) {\r\n            this.setAnchor(anchorConfig);\r\n        }\r\n\r\n        this.setDraggable(GetValue(config, \'draggable\', false));\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#destroy\r\n     * @param {boolean} fromScene \r\n     */\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.backgroundChildren !== undefined) {\r\n            this.backgroundChildren.length = 0;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#setMinSize\r\n     * @param {number} minWidth \r\n     * @param {number} minHeight \r\n     */\r\n    setMinSize(minWidth, minHeight) {\r\n        this.setMinWidth(minWidth).setMinHeight(minHeight);\r\n        return this;\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#setMinWidth\r\n     * @param {number} minWidth \r\n     */\r\n    setMinWidth(minWidth) {\r\n        if (minWidth == null) {\r\n            minWidth = 0;\r\n        }\r\n        this.minWidth = minWidth;\r\n        return this;\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#setMinHeight\r\n     * @param {number} minHeight \r\n     */\r\n    setMinHeight(minHeight) {\r\n        if (minHeight == null) {\r\n            minHeight = 0;\r\n        }\r\n        this.minHeight = minHeight;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.childrenWidth\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get childrenWidth() {\r\n        if (this._childrenWidth === undefined) {\r\n            this._childrenWidth = this.getChildrenWidth();\r\n        }\r\n        return this._childrenWidth;\r\n    }\r\n    /**\r\n     * @name Base.childrenHeight\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get childrenHeight() {\r\n        if (this._childrenHeight === undefined) {\r\n            this._childrenHeight = this.getChildrenHeight();\r\n        }\r\n        return this._childrenHeight;\r\n    }\r\n    /**\r\n     * @name Base.left\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get left() {\r\n        return this.x - (Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayWidth"])(this) * this.originX);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set left(value) {\r\n        this.x += (value - this.left);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignLeft\r\n     * @param {number} value \r\n     */\r\n    alignLeft(value) {\r\n        this.left = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.right\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get right() {\r\n        return this.left + Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayWidth"])(this);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set right(value) {\r\n        this.x += (value - this.right);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignRight\r\n     * @param {number} value \r\n     */\r\n    alignRight(value) {\r\n        this.right = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.centerX\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get centerX() {\r\n        return this.left + (Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayWidth"])(this) / 2);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set centerX(value) {\r\n        this.x += (value - this.centerX);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignCenterX\r\n     * @param {number} value \r\n     */\r\n    alignCenterX(value) {\r\n        this.centerX = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.top\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get top() {\r\n        return this.y - (Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayHeight"])(this) * this.originY);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set top(value) {\r\n        this.y += (value - this.top);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignTop\r\n     * @param {number} value \r\n     */\r\n    alignTop(value) {\r\n        this.top = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.bottom\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get bottom() {\r\n        return this.top + Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayHeight"])(this);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set bottom(value) {\r\n        this.y += (value - this.bottom);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignBottom\r\n     * @param {number} value \r\n     */\r\n    alignBottom(value) {\r\n        this.bottom = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @name Base.centerY\r\n     * @type {number}\r\n     * @return {number}\r\n     */\r\n    get centerY() {\r\n        return this.top + (Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayHeight"])(this) / 2);\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    set centerY(value) {\r\n        this.y += (value - this.centerY);\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#alignCenterY\r\n     * @param {number} value \r\n     */\r\n    alignCenterY(value) {\r\n        this.centerY = value;\r\n        return this;\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#pin\r\n     * @param {*} gameObject \r\n     */\r\n    pin(gameObject) {\r\n        super.add(gameObject);\r\n        return this;\r\n    }\r\n    /**\r\n     * @method tooqinui.Base#addBackground\r\n     * @param {*} gameObject \r\n     * @param {*} childKey \r\n     */\r\n    addBackground(gameObject, childKey) {\r\n        if (this.backgroundChildren === undefined) {\r\n            this.backgroundChildren = [];\r\n        }\r\n\r\n        super.add(gameObject);\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        this.backgroundChildren.push(gameObject);\r\n\r\n        if (childKey !== undefined) {\r\n            this.addChildrenMap(childKey, gameObject)\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Base.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Base);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/BaseSizer.js?')},"./lib/rexui/lib/ui/basesizer/DrawBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/lib/ui/utils/AlignConst.js\");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/utils/actions/GlobZone.js */ \"./lib/rexui/lib/plugins/utils/actions/GlobZone.js\");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ \"./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js\");\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n/**\r\n * @function tooqinui.DrawBounds\r\n * @param {Phaser.GameObjects.Graphics} graphics \r\n * @param {*} config \r\n */\r\nvar DrawBounds = function (graphics, config) {\r\n    var scene = graphics.scene;\r\n\r\n    var color;\r\n    var createTextCallback, createTextCallbackScope, textAlign;\r\n    if (typeof (config) === 'number') {\r\n        color = config;\r\n    } else {\r\n        color = GetValue(config, 'color', 0xffffff);\r\n        var nameTextConfig = GetValue(config, 'name', false);\r\n        if (nameTextConfig) {\r\n            createTextCallback = GetValue(nameTextConfig, 'createTextCallback', DefaultCreateTextCallback);\r\n            createTextCallbackScope = GetValue(nameTextConfig, 'createTextCallbackScope', undefined);\r\n            textAlign = GetValue(nameTextConfig, 'align', 'left-top');\r\n            if (typeof (textAlign) === 'string') {\r\n                textAlign = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"][textAlign];\r\n            }\r\n        }\r\n    }\r\n\r\n    if (createTextCallback && !graphics.children) {\r\n        graphics.children = scene.add.group();\r\n        graphics.on('destroy', function () {\r\n            graphics.children.destroy();\r\n            graphics.children = undefined;\r\n        })\r\n        var graphicsClear = graphics.clear.bind(graphics);\r\n        graphics.clear = function () {\r\n            graphicsClear();\r\n            graphics.children.clear(false, true);\r\n        }\r\n    }\r\n\r\n    var children = this.getAllChildren([this]), child;\r\n    var nameText;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (!child.getBounds) {\r\n            continue;\r\n        }\r\n        if (color) {\r\n            graphics\r\n                .lineStyle(1, color)\r\n                .strokeRectShape(child.getBounds(globRect));\r\n        }\r\n\r\n        if (child.name && createTextCallback) {\r\n            if (createTextCallbackScope) {\r\n                nameText = createTextCallback.call(createTextCallbackScope, scene);\r\n            } else {\r\n                nameText = createTextCallback(scene);\r\n            }\r\n            if (nameText) {\r\n                nameText.setText(child.name);\r\n                graphics.children.add(nameText);\r\n\r\n                _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].setPosition(globRect.x, globRect.y).setSize(globRect.width, globRect.height);\r\n                Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(nameText, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"], textAlign);\r\n            }\r\n        }\r\n    }\r\n    return this;\r\n}\r\n/**\r\n * @function tooqinui.DefaultCreateTextCallback\r\n * @param {Phaser.Scene} scene \r\n * @param {*} child \r\n * @param {Phaser.Geom.Rectangle} childBoundsRect \r\n * @return {Phaser.GameObjects.Text}\r\n */\r\nvar DefaultCreateTextCallback = function (scene, child, childBoundsRect) {\r\n    return scene.add.text(0, 0, '');\r\n}\r\n\r\nvar globRect = new Phaser.Geom.Rectangle();\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (DrawBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/DrawBounds.js?")},"./lib/rexui/lib/ui/basesizer/FadeMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_fade_in_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/fade-in.js */ "./lib/rexui/lib/plugins/fade-in.js");\n/* harmony import */ var _plugins_fade_out_destroy_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/fade-out-destroy.js */ "./lib/rexui/lib/plugins/fade-out-destroy.js");\n/* harmony import */ var _plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/promise/WaitEvent.js */ "./lib/rexui/lib/plugins/utils/promise/WaitEvent.js");\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    /**\r\n     * @function tooqinui.FadeMethods\r\n     * @param {number} duration \r\n     * @param {number} alpha \r\n     */\r\n    fadeIn(duration, alpha) {\r\n        if (IsPlainObject(duration)) {\r\n            var config = duration;\r\n            duration = GetValue(config, \'duration\', undefined);\r\n        }\r\n\r\n        this._fade = Object(_plugins_fade_in_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, duration, alpha, this._fade);\r\n        this._fade.once(\'complete\', function () {\r\n            this.emit(\'fadein.complete\', this);\r\n        }, this);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.fadeInPromoise\r\n     * @param {number} duration \r\n     * @param {number} alpha \r\n     * @return {Promise<*>}\r\n     */\r\n    fadeInPromoise(duration, alpha) {\r\n        this.fadeIn(duration, alpha);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__["WaitComplete"])(this._fade);\r\n    },\r\n    /**\r\n     * @function tooqinui.fadeOutDestroy\r\n     * @param {number} duration \r\n     * @param {*} destroyMode \r\n     */\r\n    fadeOutDestroy(duration, destroyMode) {\r\n        if (IsPlainObject(duration)) {\r\n            var config = duration;\r\n            duration = GetValue(config, \'duration\', undefined);\r\n            destroyMode = GetValue(config, \'destroy\', undefined);\r\n        }\r\n        this._fade = Object(_plugins_fade_out_destroy_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this, duration, destroyMode, this._fade);\r\n        this._fade.once(\'complete\', function () {\r\n            this.emit(\'fadeout.complete\', this);\r\n        }, this);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.fadeOutDestroyPromise\r\n     * @param {number} duration \r\n     * @param {*} destroyMode \r\n     * @return {Promise<*>}\r\n     */\r\n    fadeOutDestroyPromise(duration, destroyMode) {\r\n        this.fadeOutDestroy(duration, destroyMode);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__["WaitComplete"])(this._fade);\r\n    },\r\n    /**\r\n     * @function tooqinui.fadeOut\r\n     * @param {number} duration \r\n     */\r\n    fadeOut(duration) {\r\n        this.fadeOutDestroy(duration, false);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.fadeOutPromise\r\n     * @param {number} duration \r\n     * @return {Promise<*>}\r\n     */\r\n    fadeOutPromise(duration) {\r\n        this.fadeOut(duration);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__["WaitComplete"])(this._fade);\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/FadeMethods.js?')},"./lib/rexui/lib/ui/basesizer/GetAllChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/**\r\n * @function tooqinui.GetAllChildrenSizers\r\n * @param {array} out \r\n * @return {array}\r\n */\r\nvar GetAllChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var startIdx = out.length;\r\n    var children = this.getChildrenSizers(out);\r\n    var endIdx = out.length;\r\n    for (var i = startIdx; i < endIdx; i++) {\r\n        children[i].getAllChildrenSizers(out);\r\n    }\r\n\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetAllChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetAllChildrenSizers.js?')},"./lib/rexui/lib/ui/basesizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\n/**\r\n * @function tooqinui.GetChildrenHeight\r\n * @return {number}\r\n */\r\nvar GetChildrenHeight = function () {\r\n    return 0;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetChildrenHeight.js?')},"./lib/rexui/lib/ui/basesizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\n/**\r\n * @function tooqinui.GetChildrenSizers\r\n * @param {array} out \r\n * @return {array}\r\n */\r\nvar GetChildrenSizers = function(out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetChildrenSizers.js?')},"./lib/rexui/lib/ui/basesizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\n/**\r\n * @function tooqinui.GetChildrenWidth\r\n * @return {number}\r\n */\r\nvar GetChildrenWidth = function () {\r\n    return 0;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetChildrenWidth.js?')},"./lib/rexui/lib/ui/basesizer/GetElement.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/object/IsArray.js */ \"./lib/rexui/lib/plugins/utils/object/IsArray.js\");\n\r\n\r\n/**\r\n * @function tooqinui.GetElement\r\n * @param {string[]} mapNameList \r\n * @return {*}\r\n */\r\nvar GetElement = function (mapNameList) {\r\n    if (this.childrenMap === undefined) {\r\n        return undefined;\r\n    }\r\n\r\n    if (typeof (mapNameList) === 'string') {\r\n        mapNameList = mapNameList.split('.');\r\n    }\r\n    if (mapNameList.length === 0) {\r\n        return undefined;\r\n    }\r\n\r\n    var name = mapNameList.shift(),\r\n        element;\r\n    if (name.charAt(0) === '#') {\r\n        name = name.substring(1);\r\n        element = GetElementByName(this.childrenMap, name);\r\n    } else if (name.indexOf('[') === (-1)) {\r\n        element = this.childrenMap[name];\r\n    } else { // name[]\r\n        var innerMatch = name.match(RE_OBJ);\r\n        if (innerMatch != null) {\r\n            var elements = this.childrenMap[innerMatch[1]];\r\n            if (elements) {\r\n                element = elements[innerMatch[2]];\r\n            }\r\n        }\r\n    }\r\n\r\n    if (mapNameList.length === 0) {\r\n        return element;\r\n    } else if (element && element.childrenMap) {\r\n        return element.getElement(mapNameList);\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n/**\r\n * @function tooqinui.GetElementByName\r\n * @param {*} children \r\n * @param {string} name \r\n * @return {*}\r\n */\r\nvar GetElementByName = function (children, name) {\r\n    var child;\r\n    if (Object(_plugins_utils_object_IsArray_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(children)) {\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = TestName(children[i], name);\r\n            if (child) {\r\n                return child;\r\n            }\r\n        }\r\n    } else { // Is plain object\r\n        for (var key in children) {\r\n            child = TestName(children[key], name);\r\n            if (child) {\r\n                return child;\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * @function tooqinui.TestName\r\n * @param {*} gameObject \r\n * @param {string} name \r\n * @return {*}\r\n */\r\nvar TestName = function (gameObject, name) {\r\n    if (!gameObject) {\r\n        return null;\r\n    } else if (gameObject.hasOwnProperty('name')) {\r\n        return (gameObject.name === name) ? gameObject : null;\r\n    } else { // Array, or plain object\r\n        return GetElementByName(gameObject, name);\r\n    }\r\n}\r\n\r\nconst RE_OBJ = /(\\S+)\\[(\\d+)\\]/i;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetElement);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetElement.js?")},"./lib/rexui/lib/ui/basesizer/GetParentSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetParentSizer.js */ "./lib/rexui/lib/ui/utils/GetParentSizer.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function () {\r\n    return Object(_utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this);\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetParentSizer.js?')},"./lib/rexui/lib/ui/basesizer/GetTopmostSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetTopmostSizer.js */ "./lib/rexui/lib/ui/utils/GetTopmostSizer.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function () {\r\n    return Object(_utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this);\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/GetTopmostSizer.js?')},"./lib/rexui/lib/ui/basesizer/IsInTouching.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/input/IsPointerInBounds.js */ "./lib/rexui/lib/plugins/utils/input/IsPointerInBounds.js");\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (function (pointer) {\r\n    /**\r\n     * @function tooqinui.IsInTouching\r\n     * @param {*} gameObject \r\n     * @param {Phaser.Input.Pointer} pointer \r\n     * @return {boolean}\r\n     */\r\n    return Object(_plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, pointer);\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/IsInTouching.js?')},"./lib/rexui/lib/ui/basesizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\n/**\r\n * @function tooqinui.Layout\r\n * @param {*} parent \r\n * @param {number} newWidth \r\n * @param {number} newHeight \r\n * @return {*}\r\n */\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.preLayout()\r\n\r\n    // ...\r\n\r\n    return this.postLayout();\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/Layout.js?')},"./lib/rexui/lib/ui/basesizer/LayoutBackgrounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/lib/plugins/utils/actions/GlobZone.js");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n\r\n\r\n\r\n\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n/**\r\n * @function tooqinui.LayoutBackgrounds\r\n */\r\nvar LayoutBackgrounds = function () {\r\n    if (this.backgroundChildren === undefined) {\r\n        return;\r\n    }\r\n    var backgrounds = this.backgroundChildren;\r\n\r\n    var child;\r\n    var x = this.left,\r\n        y = this.top,\r\n        width = this.width,\r\n        height = this.height;\r\n\r\n    for (var i = 0, cnt = backgrounds.length; i < cnt; i++) {\r\n        child = backgrounds[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n        Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, width, height);\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"].setPosition(x, y).setSize(width, height);\r\n        Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_1__["default"], ALIGN_CENTER);\r\n        this.resetChildPositionState(child);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutBackgrounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/LayoutBackgrounds.js?')},"./lib/rexui/lib/ui/basesizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetSizerConfig.js */ "./lib/rexui/lib/ui/utils/GetSizerConfig.js");\n/* harmony import */ var _PushIntoBounds_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PushIntoBounds.js */ "./lib/rexui/lib/ui/basesizer/PushIntoBounds.js");\n/* harmony import */ var _DrawBounds_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DrawBounds.js */ "./lib/rexui/lib/ui/basesizer/DrawBounds.js");\n/* harmony import */ var _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AddChildrenMap.js */ "./lib/rexui/lib/ui/basesizer/AddChildrenMap.js");\n/* harmony import */ var _GetElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetElement.js */ "./lib/rexui/lib/ui/basesizer/GetElement.js");\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/lib/ui/basesizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/lib/ui/basesizer/GetChildrenHeight.js");\n/* harmony import */ var _GetAllChildrenSizers_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./GetAllChildrenSizers.js */ "./lib/rexui/lib/ui/basesizer/GetAllChildrenSizers.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/lib/ui/basesizer/GetChildrenSizers.js");\n/* harmony import */ var _PreLayout_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./PreLayout.js */ "./lib/rexui/lib/ui/basesizer/PreLayout.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/lib/ui/basesizer/Layout.js");\n/* harmony import */ var _PostLayout_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./PostLayout.js */ "./lib/rexui/lib/ui/basesizer/PostLayout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/lib/ui/basesizer/_layoutInit.js");\n/* harmony import */ var _SetAnchor_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SetAnchor.js */ "./lib/rexui/lib/ui/basesizer/SetAnchor.js");\n/* harmony import */ var _ScaleMethods_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ScaleMethods.js */ "./lib/rexui/lib/ui/basesizer/ScaleMethods.js");\n/* harmony import */ var _FadeMethods_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./FadeMethods.js */ "./lib/rexui/lib/ui/basesizer/FadeMethods.js");\n/* harmony import */ var _IsInTouching_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./IsInTouching.js */ "./lib/rexui/lib/ui/basesizer/IsInTouching.js");\n/* harmony import */ var _GetParentSizer_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./GetParentSizer.js */ "./lib/rexui/lib/ui/basesizer/GetParentSizer.js");\n/* harmony import */ var _GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./GetTopmostSizer.js */ "./lib/rexui/lib/ui/basesizer/GetTopmostSizer.js");\n/* harmony import */ var _LayoutBackgrounds_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./LayoutBackgrounds.js */ "./lib/rexui/lib/ui/basesizer/LayoutBackgrounds.js");\n/* harmony import */ var _SetDraggable_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./SetDraggable.js */ "./lib/rexui/lib/ui/basesizer/SetDraggable.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar methods = {\r\n    getSizerConfig: _utils_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    pushIntoBounds: _PushIntoBounds_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    drawBounds: _DrawBounds_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_6__["default"],\r\n    addChildrenMap: _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    addElement: _AddChildrenMap_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    getElement: _GetElement_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    getAllChildrenSizers: _GetAllChildrenSizers_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_8__["default"],\r\n    preLayout: _PreLayout_js__WEBPACK_IMPORTED_MODULE_9__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_12__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_10__["default"],\r\n    layoutBackgrounds: _LayoutBackgrounds_js__WEBPACK_IMPORTED_MODULE_19__["default"],\r\n    postLayout: _PostLayout_js__WEBPACK_IMPORTED_MODULE_11__["default"],\r\n\r\n    setAnchor: _SetAnchor_js__WEBPACK_IMPORTED_MODULE_13__["default"],\r\n    isInTouching: _IsInTouching_js__WEBPACK_IMPORTED_MODULE_16__["default"],\r\n    getParentSizer: _GetParentSizer_js__WEBPACK_IMPORTED_MODULE_17__["default"],\r\n    getTopmostSizer: _GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_18__["default"],\r\n    setDraggable: _SetDraggable_js__WEBPACK_IMPORTED_MODULE_20__["default"],\r\n};\r\n\r\nObject.assign(\r\n    methods,\r\n    _FadeMethods_js__WEBPACK_IMPORTED_MODULE_15__["default"],\r\n    _ScaleMethods_js__WEBPACK_IMPORTED_MODULE_14__["default"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (methods);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/Methods.js?')},"./lib/rexui/lib/ui/basesizer/PostLayout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/**\r\n * @function tooqinui.PostLayout\r\n * @param {*} parent \r\n * @param {number} newWidth \r\n * @param {number} newHeight \r\n */\r\nvar PostLayout = function (parent, newWidth, newHeight) {\r\n    if (this._anchor) {\r\n        this._anchor.updatePosition();\r\n    }\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (PostLayout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/PostLayout.js?')},"./lib/rexui/lib/ui/basesizer/PreLayout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/**\r\n * @function tooqinui.PreLayout\r\n * @param {*} parent \r\n */\r\nvar LayoutInit = function (parent) {\r\n    if (parent) {\r\n        return;\r\n    }\r\n\r\n    var children = this.getAllChildrenSizers([this]);\r\n    var child, parent;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (!child.rexSizer) {\r\n            continue;\r\n        }\r\n        child._layoutInit();\r\n    }\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/PreLayout.js?')},"./lib/rexui/lib/ui/basesizer/PushIntoBounds.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/defaultbounds/GetDefaultBounds.js */ "./lib/rexui/lib/plugins/utils/defaultbounds/GetDefaultBounds.js");\n\r\n/**\r\n * @function tooqinui.PushIntoBounds\r\n * @param {Phaser.Geom.Rectangle} bounds \r\n */\r\nvar PushIntoBounds = function (bounds) {\r\n    if (bounds === undefined) {\r\n        bounds = Object(_plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.scene);\r\n    }\r\n\r\n    this.left = Math.max(this.left, bounds.left);\r\n    this.right = Math.min(this.right, bounds.right);\r\n    this.top = Math.max(this.top, bounds.top);\r\n    this.bottom = Math.min(this.bottom, bounds.bottom);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PushIntoBounds);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/PushIntoBounds.js?')},"./lib/rexui/lib/ui/basesizer/ScaleMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_popup_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/popup.js */ \"./lib/rexui/lib/plugins/popup.js\");\n/* harmony import */ var _plugins_scale_down_destroy_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/scale-down-destroy.js */ \"./lib/rexui/lib/plugins/scale-down-destroy.js\");\n/* harmony import */ var _plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/promise/WaitEvent.js */ \"./lib/rexui/lib/plugins/utils/promise/WaitEvent.js\");\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    /**\r\n     * @function tooqinui.popUp\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     */\r\n    popUp(duration, orientation, ease) {\r\n        if (IsPlainObject(duration)) {\r\n            var config = duration;\r\n            duration = GetValue(config, 'duration', undefined);\r\n            orientation = GetValue(config, 'orientation', undefined);\r\n            ease = GetValue(config, 'ease', undefined);\r\n        }\r\n\r\n        this._scale = Object(_plugins_popup_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this, duration, orientation, ease, this._scale);\r\n        this._scale.once('complete', function () {\r\n            this.emit('popup.complete', this);\r\n        }, this);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.popUpPromise\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     * @return {Promise<*>}\r\n     */\r\n    popUpPromise(duration, orientation, ease) {\r\n        this.popUp(duration, orientation, ease);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__[\"WaitComplete\"])(this._scale);\r\n    },\r\n    /**\r\n     * @function tooqinui.scaleDownDestroy\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     * @param {*} destroyMode \r\n     */\r\n    scaleDownDestroy(duration, orientation, ease, destroyMode) {\r\n        if (IsPlainObject(duration)) {\r\n            var config = duration;\r\n            duration = GetValue(config, 'duration', undefined);\r\n            orientation = GetValue(config, 'orientation', undefined);\r\n            ease = GetValue(config, 'ease', undefined);\r\n            destroyMode = GetValue(config, 'destroy', undefined);\r\n        }\r\n\r\n        this._scale = Object(_plugins_scale_down_destroy_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this, duration, orientation, ease, destroyMode, this._scale);\r\n        this._scale.once('complete', function () {\r\n            this.emit('scaledown.complete', this);\r\n        }, this);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.scaleDownDestroyPromise\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     * @param {*} destroyMode \r\n     * @return {Promise<*>}\r\n     */\r\n    scaleDownDestroyPromise(duration, orientation, ease, destroyMode) {\r\n        this.scaleDownDestroy(duration, orientation, ease, destroyMode);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__[\"WaitComplete\"])(this._scale);\r\n    },\r\n    /**\r\n     * @function tooqinui.scaleDown\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     */\r\n    scaleDown(duration, orientation, ease) {\r\n        this.scaleDownDestroy(duration, orientation, ease, false);\r\n        return this;\r\n    },\r\n    /**\r\n     * @function tooqinui.scaleDownPromise\r\n     * @param {number} duration \r\n     * @param {number} orientation \r\n     * @param {*} ease \r\n     * @return {Promise<*>}\r\n     */\r\n    scaleDownPromise(duration, orientation, ease) {\r\n        this.scaleDown(duration, orientation, ease);\r\n        return Object(_plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_2__[\"WaitComplete\"])(this._scale);\r\n    }\r\n\r\n\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/ScaleMethods.js?")},"./lib/rexui/lib/ui/basesizer/SetAnchor.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_behaviors_anchor_Anchor_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/behaviors/anchor/Anchor.js */ "./lib/rexui/lib/plugins/behaviors/anchor/Anchor.js");\n\r\n/**\r\n * @function tooqinui.SetAnchor\r\n * @param {*} config \r\n */\r\nvar SetAnchor = function (config) {\r\n    if (this._anchor === undefined) {\r\n        this._anchor = new _plugins_behaviors_anchor_Anchor_js__WEBPACK_IMPORTED_MODULE_0__["default"](this, config);\r\n    } else {\r\n        this._anchor.resetFromJSON(config)\r\n    }\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetAnchor);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/SetAnchor.js?')},"./lib/rexui/lib/ui/basesizer/SetDraggable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/**\r\n * @function tooqinui.SetDraggable\r\n * @param {*} senser \r\n * @param {boolean} draggable \r\n */\r\nvar SetDraggable = function (senser, draggable) {\r\n    var senserType = typeof (senser);\r\n    if (senserType === 'string') {\r\n        senser = this.getElement(senser);\r\n    } else if ((senser === undefined) || (senserType != 'object')) {\r\n        draggable = senser;\r\n        senser = this;\r\n    }\r\n    if (draggable === undefined) {\r\n        draggable = true;\r\n    }\r\n\r\n    if (senser.input && senser.input.hasOwnProperty('draggable')) {\r\n        // Draggable is already registered\r\n        senser.input.draggable = draggable;\r\n    } else if (draggable) {\r\n        // Register draggable\r\n        senser.setInteractive();\r\n        senser.scene.input.setDraggable(senser);\r\n        senser.on('drag', onDrag, this);\r\n    } else {\r\n        // Not draggable and draggable is not registered yet, do nothing\r\n    }\r\n    return this;\r\n}\r\n/**\r\n * @function tooqinui.onDrag\r\n * @param {Phaser.Input.Pointer} pointer \r\n * @param {number} dragX \r\n * @param {number} dragY \r\n */\r\nvar onDrag = function (pointer, dragX, dragY) {\r\n    var topmostParent = this.getTopmostSizer();\r\n    topmostParent.x += (dragX - this.x);\r\n    topmostParent.y += (dragY - this.y);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetDraggable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/SetDraggable.js?")},"./lib/rexui/lib/ui/basesizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n// Override\r\nvar _layoutInit = function () {}\r\n/* harmony default export */ __webpack_exports__["default"] = (_layoutInit);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/basesizer/_layoutInit.js?')},"./lib/rexui/lib/ui/bbcodetext/BBCodeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n\r\n/**\r\n * @function tooqinui.BBCodeText\r\n * @param {Phaser.Scene} scene \r\n * @param {number} x \r\n * @param {number} y \r\n * @param {Phaser.GameObjects.Text} text \r\n * @param {*} style \r\n * @return {*}\r\n */\r\nvar BBCodeText = function (scene, x, y, text, style) {\r\n    return new _plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"](scene, x, y, text, style);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (BBCodeText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/bbcodetext/BBCodeText.js?')},"./lib/rexui/lib/ui/bbcodetext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BBCodeText.js */ "./lib/rexui/lib/ui/bbcodetext/BBCodeText.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'BBCodeText\', function (x, y, text, style) {\r\n    var gameObject = new _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.BBCodeText\', _BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_BBCodeText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/bbcodetext/Factory.js?')},"./lib/rexui/lib/ui/button/Button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ButtonState", function() { return ButtonState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ButtonSoundKey", function() { return ButtonSoundKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Button", function() { return Button; });\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\n/* harmony import */ var _interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interface/event/MouseEvent */ "./lib/rexui/lib/ui/interface/event/MouseEvent.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ButtonState;\r\n(function (ButtonState) {\r\n    ButtonState["Normal"] = "normal";\r\n    ButtonState["Over"] = "over";\r\n    ButtonState["Select"] = "select";\r\n    ButtonState["Disable"] = "disable";\r\n})(ButtonState || (ButtonState = {}));\r\nvar ButtonSoundKey;\r\n(function (ButtonSoundKey) {\r\n})(ButtonSoundKey || (ButtonSoundKey = {}));\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar Button = /** @class */ (function (_super) {\r\n    __extends(Button, _super);\r\n    function Button(scene, key, frame, downFrame, text, music, dpr, scale, nineConfig) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mDownTime = 0;\r\n        _this.mPressDelay = 1000;\r\n        _this.mIsMove = false;\r\n        _this.dpr = dpr || 1;\r\n        _this.scale = scale || 1;\r\n        _this.soundGroup = {\r\n            up: {\r\n                key: "click",\r\n            }\r\n        };\r\n        Object.assign(_this.soundGroup, music);\r\n        _this.ninePatchConfig = nineConfig;\r\n        _this.mKey = key;\r\n        _this.mFrame = frame;\r\n        _this.mDownFrame = downFrame;\r\n        _this.createBackground();\r\n        if (text) {\r\n            _this.mText = _this.scene.make.text(undefined, false)\r\n                .setOrigin(0.5, 0.5)\r\n                .setText(text)\r\n                .setSize(_this.mBackground.width, _this.mBackground.height);\r\n            _this.add(_this.mText);\r\n        }\r\n        _this.setInteractive();\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Button.prototype, "background", {\r\n        get: function () {\r\n            return this.mBackground;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Button.prototype, "text", {\r\n        get: function () {\r\n            return this.mText;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Button.prototype.addListen = function () {\r\n        this.removeListen();\r\n        this.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.on("pointerup", this.onPointerUpHandler, this);\r\n        this.on("pointermove", this.onPointerMoveHandler, this);\r\n    };\r\n    Button.prototype.removeListen = function () {\r\n        this.off("pointerdown", this.onPointerDownHandler, this);\r\n        this.off("pointerup", this.onPointerUpHandler, this);\r\n        this.off("pointermove", this.onPointerMoveHandler, this);\r\n    };\r\n    Button.prototype.mute = function (boo) {\r\n        this.silent = boo;\r\n    };\r\n    Button.prototype.changeNormal = function () {\r\n        this.setBgFrame(this.mFrame);\r\n    };\r\n    Button.prototype.changeDown = function () {\r\n        if (this.mDownFrame) {\r\n            this.setBgFrame(this.mDownFrame);\r\n        }\r\n    };\r\n    Button.prototype.setFrame = function (frame) {\r\n        if (this.mBackground) {\r\n            this.setBgFrame(frame);\r\n        }\r\n    };\r\n    Button.prototype.setText = function (val) {\r\n        if (this.mText) {\r\n            this.mText.setText(val);\r\n        }\r\n    };\r\n    Button.prototype.setTextStyle = function (style) {\r\n        if (this.mText) {\r\n            this.mText.setStyle(style);\r\n        }\r\n    };\r\n    Button.prototype.setFontStyle = function (val) {\r\n        if (this.mText) {\r\n            this.mText.setFontStyle(val);\r\n        }\r\n    };\r\n    Button.prototype.setTextOffset = function (x, y) {\r\n        if (this.mText) {\r\n            this.mText.setPosition(x, y);\r\n        }\r\n    };\r\n    Button.prototype.setTextColor = function (color) {\r\n        if (this.mText) {\r\n            this.mText.setColor(color);\r\n        }\r\n    };\r\n    Button.prototype.createBackground = function () {\r\n        this.mBackground = this.scene.make.image({\r\n            key: this.mKey,\r\n            frame: this.mFrame\r\n        }, false);\r\n        this.setSize(this.mBackground.width, this.mBackground.height);\r\n        this.add(this.mBackground);\r\n    };\r\n    Button.prototype.setBgFrame = function (frame) {\r\n        this.mBackground.setFrame(frame);\r\n        this.setSize(this.mBackground.width, this.mBackground.height);\r\n    };\r\n    Button.prototype.buttonStateChange = function (state) {\r\n        switch (state) {\r\n            case ButtonState.Normal:\r\n                this.changeNormal();\r\n                break;\r\n            case ButtonState.Over:\r\n                break;\r\n            case ButtonState.Select:\r\n                this.changeDown();\r\n                break;\r\n            case ButtonState.Disable:\r\n                break;\r\n        }\r\n    };\r\n    Button.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (this.soundGroup && this.soundGroup.move)\r\n            this.playSound(this.soundGroup.move);\r\n        if (!this.interactiveBoo)\r\n            return;\r\n        this.mIsMove = true;\r\n        this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Move);\r\n    };\r\n    Button.prototype.onPointerUpHandler = function (pointer) {\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        this.buttonStateChange(ButtonState.Normal);\r\n        if (!this.mIsMove || (Date.now() - this.mDownTime > this.mPressTime)) {\r\n            if (Math.abs(pointer.downX - pointer.upX) < 30 && Math.abs(pointer.downY - pointer.upY) < 30) {\r\n                if (this.soundGroup && this.soundGroup.up)\r\n                    this.playSound(this.soundGroup.up);\r\n                this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Tap, pointer, this);\r\n            }\r\n        }\r\n        clearTimeout(this.mPressDelay);\r\n        this.mIsMove = false;\r\n        this.mDownTime = 0;\r\n    };\r\n    Button.prototype.onPointerDownHandler = function (pointer) {\r\n        var _this = this;\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        if (this.soundGroup && this.soundGroup.down)\r\n            this.playSound(this.soundGroup.down);\r\n        this.buttonStateChange(ButtonState.Select);\r\n        this.mDownTime = Date.now();\r\n        this.mPressTime = setTimeout(function () {\r\n            _this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Hold, _this);\r\n        }, this.mPressTime);\r\n        this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Down, this);\r\n    };\r\n    return Button;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/button/Button.ts?')},"./lib/rexui/lib/ui/button/NineSliceButton.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NineSliceButton", function() { return NineSliceButton; });\n/* harmony import */ var _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ninepatch/NineSlicePatch */ "./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\n/* harmony import */ var _interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interface/event/MouseEvent */ "./lib/rexui/lib/ui/interface/event/MouseEvent.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar NineSliceButton = /** @class */ (function (_super) {\r\n    __extends(NineSliceButton, _super);\r\n    function NineSliceButton(scene, x, y, width, height, key, frame, text, dpr, scale, config, music, data) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.x = x;\r\n        _this.y = y;\r\n        _this.mKey = key;\r\n        _this.mFrame = frame ? frame : "__BASE";\r\n        _this.dpr = dpr || 1;\r\n        _this.scale = scale || 1;\r\n        _this.initFrame();\r\n        _this.setSize(width, height);\r\n        _this.mNingBg = new _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__["NineSlicePatch"](_this.scene, 0, 0, width, height, key, _this.mFrame_nrmal, config);\r\n        _this.add(_this.mNingBg);\r\n        if (data) {\r\n            _this.btnData = data;\r\n        }\r\n        _this.mLabel = _this.scene.make.text(undefined, false)\r\n            .setOrigin(0.5, 0.5)\r\n            .setSize(_this.width, _this.height)\r\n            .setAlign("center")\r\n            .setText(text);\r\n        _this.add(_this.mLabel);\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    NineSliceButton.prototype.addListen = function () {\r\n        this.removeListen();\r\n        this.on("pointerdown", this.onPointerDown, this);\r\n        this.on("pointerup", this.onPointerUp, this);\r\n    };\r\n    NineSliceButton.prototype.removeListen = function () {\r\n        this.off("pointerdown", this.onPointerDown, this);\r\n        this.off("pointerup", this.onPointerUp, this);\r\n    };\r\n    Object.defineProperty(NineSliceButton.prototype, "enable", {\r\n        set: function (value) {\r\n            if (value) {\r\n                this.mNingBg.clearTint();\r\n                this.mLabel.clearTint();\r\n                this.setInteractive();\r\n            }\r\n            else {\r\n                this.mNingBg.setTintFill(0x666666);\r\n                this.mLabel.setTintFill(0x777777);\r\n                this.removeInteractive();\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NineSliceButton.prototype.getBtnData = function () {\r\n        return this.btnData;\r\n    };\r\n    NineSliceButton.prototype.setText = function (text) {\r\n        this.mLabel.setText(text);\r\n    };\r\n    NineSliceButton.prototype.getText = function () {\r\n        return this.mLabel.text;\r\n    };\r\n    NineSliceButton.prototype.setTextStyle = function (style) {\r\n        this.mLabel.setStyle(style);\r\n    };\r\n    NineSliceButton.prototype.setFontStyle = function (val) {\r\n        this.mLabel.setFontStyle(val);\r\n    };\r\n    NineSliceButton.prototype.setTextOffset = function (x, y) {\r\n        this.mLabel.setPosition(x, y);\r\n    };\r\n    NineSliceButton.prototype.setFrame = function (frame) {\r\n        this.mNingBg.setFrame(frame);\r\n        return this;\r\n    };\r\n    NineSliceButton.prototype.destroy = function () {\r\n        this.removeListen();\r\n        if (this.mLabel)\r\n            this.mLabel.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    NineSliceButton.prototype.setFrameNormal = function (normal, down, over) {\r\n        this.mFrame_nrmal = normal;\r\n        this.mFrame_down = (down ? down : normal);\r\n        this.mFrame_over = (over ? over : normal);\r\n        this.changeNormal();\r\n        return this;\r\n    };\r\n    // public setState(val: string) {\r\n    // }\r\n    NineSliceButton.prototype.changeNormal = function () {\r\n        this.setFrame(this.mFrame_nrmal);\r\n    };\r\n    NineSliceButton.prototype.changeDown = function () {\r\n        // this.scale = 0.9;\r\n        this.setFrame(this.mFrame_down);\r\n    };\r\n    NineSliceButton.prototype.changeOver = function () {\r\n        // this.setTexture()\r\n        this.setFrame(this.mFrame_over);\r\n    };\r\n    NineSliceButton.prototype.isExists = function (frame) {\r\n        var originTexture = this.scene.textures.get(this.mKey);\r\n        if (originTexture && originTexture.has(frame))\r\n            return true;\r\n        return false;\r\n    };\r\n    NineSliceButton.prototype.onPointerDown = function (pointer) {\r\n        this.changeDown();\r\n    };\r\n    NineSliceButton.prototype.onPointerUp = function (pointer) {\r\n        this.changeNormal();\r\n        this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_2__["CoreUI"].MouseEvent.Tap, pointer, this);\r\n    };\r\n    Object.defineProperty(NineSliceButton.prototype, "label", {\r\n        get: function () {\r\n            return this.mLabel;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NineSliceButton.prototype.initFrame = function () {\r\n        var frame = this.mFrame ? this.mFrame : this.mKey;\r\n        this.mFrame_nrmal = frame + "_normal";\r\n        if (!this.isExists(this.mFrame_nrmal)) {\r\n            this.mFrame_nrmal = this.mFrame;\r\n        }\r\n        var down = frame + "_down";\r\n        if (!this.isExists(down)) {\r\n            down = this.mFrame_nrmal;\r\n        }\r\n        this.mFrame_down = down;\r\n        var over = frame + "_over";\r\n        if (!this.isExists(over)) {\r\n            over = this.mFrame_nrmal;\r\n        }\r\n        this.mFrame_over = over;\r\n    };\r\n    return NineSliceButton;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/button/NineSliceButton.ts?')},"./lib/rexui/lib/ui/buttons/ButtonMethods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ButtonSetInteractive.js */ "./lib/rexui/lib/ui/buttons/ButtonSetInteractive.js");\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Hide.js */ "./lib/rexui/lib/ui/utils/Hide.js");\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getButton(index) {\r\n        var button;\r\n        if (typeof (index) === \'number\') {\r\n            button = this.childrenMap.buttons[index];\r\n        } else {\r\n            button = index;\r\n            if (this.childrenMap.buttons.indexOf(button) === -1) {\r\n                button = undefined;\r\n            }\r\n        }\r\n        return button;\r\n    },\r\n\r\n    emitButtonClick(index) {\r\n        // index or button game object\r\n        _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_0__["FireEvent"].call(this, \'button.click\', index);\r\n        return this;\r\n    },\r\n\r\n    showButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["Show"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    hideButton(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["Hide"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    isButtonShown(index) {\r\n        Object(_utils_Hide_js__WEBPACK_IMPORTED_MODULE_1__["IsShown"])(this.getButton(index));\r\n        return this;\r\n    },\r\n\r\n    forEachButtton(callback, scope) {\r\n        var buttons = this.childrenMap.buttons;\r\n        for (var i = 0, cnt = buttons.length; i < cnt; i++) {\r\n            if (scope) {\r\n                callback.call(scope, buttons[i], i, buttons);\r\n            } else {\r\n                callback(buttons[i], i, buttons);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/ButtonMethods.js?')},"./lib/rexui/lib/ui/buttons/ButtonSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ButtonSetInteractive\", function() { return ButtonSetInteractive; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FireEvent\", function() { return FireEvent; });\n/* harmony import */ var _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/button/Button.js */ \"./lib/rexui/lib/plugins/input/button/Button.js\");\n\r\n\r\nvar ButtonSetInteractive = function (button, clickConfig) {\r\n    //Default: Fire 'click' event when touch released after pressed.\r\n    button._buttonBehavior = new _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](button, clickConfig);\r\n\r\n    button._buttonBehavior.on('click', function (buttonBehavior, gameObject, pointer, event) {\r\n        FireEvent.call(this, 'button.click', button, pointer, event);\r\n    }, this);\r\n\r\n    button\r\n        .on('pointerover', function (pointer, localX, localY, event) {\r\n            FireEvent.call(this, 'button.over', button, pointer, event);\r\n        }, this)\r\n        .on('pointerout', function (pointer, event) {\r\n            FireEvent.call(this, 'button.out', button, pointer, event);\r\n        }, this)\r\n}\r\n\r\nvar FireEvent = function (eventName, button, pointer, event) {\r\n    var index;\r\n    if (typeof (button) === 'number') {\r\n        index = button;\r\n        button = this.childrenMap.buttons[index];\r\n        if (!button) {\r\n            return;\r\n        }\r\n    } else {\r\n        index = this.childrenMap.buttons.indexOf(button);\r\n        if (index === -1) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    // Buttons is a child. Fire internal events.\r\n    if (this.eventEmitter !== this) {\r\n        this.emit(eventName, button, index, pointer, event);\r\n    }\r\n\r\n    if (this.groupName !== undefined) {\r\n        this.eventEmitter.emit(eventName, button, this.groupName, index, pointer, event);\r\n    } else {\r\n        this.eventEmitter.emit(eventName, button, index, pointer, event);\r\n    }\r\n}\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/ButtonSetInteractive.js?")},"./lib/rexui/lib/ui/buttons/Buttons.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/lib/ui/sizer/Sizer.js\");\n/* harmony import */ var _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ButtonSetInteractive.js */ \"./lib/rexui/lib/ui/buttons/ButtonSetInteractive.js\");\n/* harmony import */ var _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ButtonMethods.js */ \"./lib/rexui/lib/ui/buttons/ButtonMethods.js\");\n/* harmony import */ var _types_SetType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./types/SetType.js */ \"./lib/rexui/lib/ui/buttons/types/SetType.js\");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Buttons extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        // Create \r\n        super(scene, config);\r\n        this.type = 'rexButtons';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n        this.groupName = GetValue(config, 'groupName', undefined);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var buttons = GetValue(config, 'buttons', undefined);\r\n        if (buttons && buttons.length === 0) {\r\n            buttons = undefined;\r\n        }\r\n\r\n        // Space\r\n        var buttonSpace = GetValue(config, 'space', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (buttons) {\r\n            var expand = GetValue(config, 'expand', false);\r\n            var proportion = (expand) ? 1 : 0;\r\n            var buttonsAlign = GetValue(config, 'align', undefined); // undefined/left/top: no space\r\n            var clickConfig = GetValue(config, 'click', undefined);\r\n\r\n            // Add space\r\n            if ((!expand) &&\r\n                (\r\n                    (buttonsAlign === 'right') ||\r\n                    (buttonsAlign === 'bottom') ||\r\n                    (buttonsAlign === 'center')\r\n                )\r\n            ) {\r\n                this.addSpace();\r\n            }\r\n\r\n            var button, padding;\r\n            for (var i = 0, cnt = buttons.length; i < cnt; i++) {\r\n                button = buttons[i];\r\n                // Add to sizer\r\n                if (this.orientation === 0) {\r\n                    padding = {\r\n                        left: (i >= 1) ? buttonSpace : 0,\r\n                        right: 0,\r\n                        top: 0,\r\n                        bottom: 0\r\n                    }\r\n                } else {\r\n                    padding = {\r\n                        left: 0,\r\n                        right: 0,\r\n                        top: (i >= 1) ? buttonSpace : 0,\r\n                        bottom: 0\r\n                    }\r\n                }\r\n                this.add(button, proportion, 'center', padding, true);\r\n                _ButtonSetInteractive_js__WEBPACK_IMPORTED_MODULE_1__[\"ButtonSetInteractive\"].call(this, button, clickConfig);\r\n            }\r\n\r\n            // Add space\r\n            if ((!expand) && (buttonsAlign === 'center')) {\r\n                this.addSpace();\r\n            }\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('buttons', (buttons) ? buttons : []);\r\n\r\n        _types_SetType_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].call(this, config);\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Buttons.prototype,\r\n    _ButtonMethods_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Buttons);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/Buttons.js?")},"./lib/rexui/lib/ui/buttons/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Buttons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Buttons.js */ "./lib/rexui/lib/ui/buttons/Buttons.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'buttons\', function (config) {\r\n    var gameObject = new _Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Buttons\', _Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/Factory.js?')},"./lib/rexui/lib/ui/buttons/types/InitData.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar InitData = function (config, initialValue) {\r\n    if (initialValue === undefined) {\r\n        initialValue = false;\r\n    }\r\n\r\n    var dataManager = GetValue(config, 'dataManager', undefined);\r\n    var setValueCallback = GetValue(config, 'setValueCallback', undefined);\r\n    var setValueCallbackScope = GetValue(config, 'setValueCallbackScope', undefined);\r\n\r\n    if (dataManager === undefined) {\r\n        this.setDataEnabled();\r\n        dataManager = this.data;\r\n    }\r\n\r\n    this.childrenMap.buttons.forEach(function (button) {\r\n        var key = button.name;\r\n\r\n        if (setValueCallback) {\r\n            dataManager.events.on(`changedata-${key}`, function (parent, value, previousValue) {\r\n                if (setValueCallbackScope) {\r\n                    setValueCallback.call(setValueCallbackScope, button, value, previousValue);\r\n                } else {\r\n                    setValueCallback(button, value);\r\n                }\r\n            }, this)\r\n        }\r\n\r\n        dataManager.set(key, undefined);\r\n        dataManager.set(key, initialValue); // Trigger data event 'changedata'\r\n    })\r\n    this._dataManager = dataManager;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InitData);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/types/InitData.js?")},"./lib/rexui/lib/ui/buttons/types/SetCheckboxesType.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InitData_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InitData.js */ "./lib/rexui/lib/ui/buttons/types/InitData.js");\n\r\n\r\nvar SetCheckboxesType = function (config) {\r\n    _InitData_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, config);\r\n\r\n    this.on(\'button.click\', function (button) {\r\n        var dataManager = this._dataManager;\r\n        var key = button.name;\r\n        var value = dataManager.get(key);\r\n        dataManager.set(key, !value);\r\n    }, this);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetCheckboxesType);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/types/SetCheckboxesType.js?')},"./lib/rexui/lib/ui/buttons/types/SetRadioType.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _InitData_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InitData.js */ \"./lib/rexui/lib/ui/buttons/types/InitData.js\");\n\r\n\r\nvar SetRadioType = function (config) {\r\n    _InitData_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].call(this, config);\r\n\r\n    this._value = undefined;\r\n    Object.defineProperty(this, 'value', {\r\n        get: (function () {\r\n            return this._value;\r\n        }).bind(this),\r\n        set: (function (value) {\r\n            if (value === this._value) {\r\n                return;\r\n            }\r\n\r\n            this._value = value;\r\n\r\n            // Update state of button -> Fire `changedata-btnName` event -> setValueCallback\r\n            var dataManager = this._dataManager;\r\n            this.getElement('buttons').forEach(function (button) {\r\n                var key = button.name;\r\n                var state = dataManager.get(key);\r\n                if (key === value) {\r\n                    if (!state) {\r\n                        dataManager.set(key, true);\r\n                    }\r\n                } else {\r\n                    if (state) {\r\n                        dataManager.set(key, false);\r\n                    }\r\n                }\r\n            });\r\n        }).bind(this),\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n\r\n    this.on('button.click', function (button) {\r\n        this.value = button.name;\r\n    }, this);\r\n\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SetRadioType);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/types/SetRadioType.js?")},"./lib/rexui/lib/ui/buttons/types/SetType.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetRadioType_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetRadioType.js */ "./lib/rexui/lib/ui/buttons/types/SetRadioType.js");\n/* harmony import */ var _SetCheckboxesType_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetCheckboxesType.js */ "./lib/rexui/lib/ui/buttons/types/SetCheckboxesType.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nconst SetTypeCallbacks = {\r\n    radio: _SetRadioType_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    checkboxes: _SetCheckboxesType_js__WEBPACK_IMPORTED_MODULE_1__["default"]\r\n}\r\n\r\nvar SetType = function (config) {\r\n    var type = GetValue(config, \'type\', undefined);\r\n    if (type && SetTypeCallbacks.hasOwnProperty(type)) {\r\n        SetTypeCallbacks[type].call(this, config);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetType);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/buttons/types/SetType.js?')},"./lib/rexui/lib/ui/canvas/Canvas.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/canvas/Canvas.js */ "./lib/rexui/lib/plugins/gameobjects/canvas/Canvas.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/canvas/Canvas.js?')},"./lib/rexui/lib/ui/canvas/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Canvas_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Canvas.js */ "./lib/rexui/lib/ui/canvas/Canvas.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'canvas\', function (x, y, width, height) {\r\n    var gameObject = new _Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Canvas\', _Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Canvas_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/canvas/Factory.js?')},"./lib/rexui/lib/ui/circlemaskimage/CircleMaskImage.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_circlemaskimage_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/circlemaskimage/CircleMaskImage.js */ "./lib/rexui/lib/plugins/gameobjects/circlemaskimage/CircleMaskImage.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_circlemaskimage_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/circlemaskimage/CircleMaskImage.js?')},"./lib/rexui/lib/ui/circlemaskimage/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CircleMaskImage.js */ "./lib/rexui/lib/ui/circlemaskimage/CircleMaskImage.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'circleMaskImage\', function (x, y, key, frame, config) {\r\n    var gameObject = new _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, key, frame, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.CircleMaskImage\', _CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_CircleMaskImage_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/circlemaskimage/Factory.js?')},"./lib/rexui/lib/ui/combobox/Combobox.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectCallItem", function() { return SelectCallItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComboBox", function() { return ComboBox; });\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar SelectCallItem = /** @class */ (function (_super) {\r\n    __extends(SelectCallItem, _super);\r\n    function SelectCallItem(scene, selectCallUI, wid, hei, music) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mSelect = false;\r\n        _this.mSelectCallUI = selectCallUI;\r\n        _this.soundGroup = music;\r\n        _this.mText = _this.scene.make.text({\r\n            x: -wid >> 1, y: -hei >> 1,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        var COLOR = 0xffcc00;\r\n        _this.mSelectBG = scene.make.graphics(undefined, false);\r\n        _this.mSelectBG.fillStyle(COLOR, .8);\r\n        _this.mSelectBG.fillRect(-wid >> 1, -hei >> 1, wid, hei);\r\n        _this.mSelectBG.visible = false;\r\n        _this.add([_this.mSelectBG, _this.mText]);\r\n        _this.width = wid;\r\n        _this.height = hei;\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive();\r\n        return _this;\r\n    }\r\n    SelectCallItem.prototype.setInteractive = function () {\r\n        _super.prototype.setInteractive.call(this, new Phaser.Geom.Rectangle(0, 0, this.width, this.height), Phaser.Geom.Rectangle.Contains);\r\n        return this;\r\n    };\r\n    SelectCallItem.prototype.addListen = function () {\r\n        this.on("pointerover", this.overHandler, this);\r\n        this.on("pointerout", this.outHandler, this);\r\n        this.on("pointerdown", this.selectHandler, this);\r\n    };\r\n    SelectCallItem.prototype.removeListen = function () {\r\n        this.off("pointerover", this.overHandler, this);\r\n        this.off("pointerout", this.outHandler, this);\r\n        this.off("pointerdown", this.selectHandler, this);\r\n    };\r\n    Object.defineProperty(SelectCallItem.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mItemData;\r\n        },\r\n        set: function (val) {\r\n            this.mItemData = val;\r\n            this.mText.text = this.mItemData.text;\r\n            this.mText.x = -this.width / 2 + (this.width - this.mText.width >> 1);\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SelectCallItem.prototype.destroy = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mText.destroy(true);\r\n        this.mSelectBG.destroy(true);\r\n        this.mItemData = null;\r\n        this.mText = null;\r\n        this.mSelectBG = null;\r\n        this.mSelectCallUI = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(SelectCallItem.prototype, "selected", {\r\n        get: function () {\r\n            return this.mSelect;\r\n        },\r\n        set: function (val) {\r\n            this.mSelectBG.visible = val;\r\n            this.mSelect = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectCallItem.prototype, "interactive", {\r\n        get: function () {\r\n            return this.interactiveBoo;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SelectCallItem.prototype.overHandler = function () {\r\n        if (!this.interactiveBoo)\r\n            return;\r\n        this.mSelectBG.visible = true;\r\n    };\r\n    SelectCallItem.prototype.selectHandler = function () {\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.mSelectCallUI.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        if (this.soundGroup && this.soundGroup.down)\r\n            this.mSelectCallUI.playSound(this.soundGroup.down);\r\n        this.overHandler();\r\n        this.mSelectCallUI.selectCall(this.mItemData);\r\n    };\r\n    SelectCallItem.prototype.outHandler = function () {\r\n        if (!this.interactiveBoo)\r\n            return;\r\n        this.mSelectBG.visible = false;\r\n    };\r\n    return SelectCallItem;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__["BaseUI"]));\r\n\r\n/**\r\n * @class ComboBox\r\n * @memberof tooqinui.ComboBox\r\n * @constructor\r\n * @param {Phaser.Scene} scene\r\n * @param {*} config (export interface IComboboxConfig {wid: number;hei: number;\r\n    resKey: string;resPng: string;resJson: string;resBg: string;\r\n    resArrow: string;fontStyle: { size: number, color: string, bold: boolean };\r\n    up: boolean;clickCallBack: Function;boxMusic?: ISoundGroup;itemMusic?: ISoundGroup;\r\n  })\r\n */\r\nvar ComboBox = /** @class */ (function (_super) {\r\n    __extends(ComboBox, _super);\r\n    function ComboBox(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mIsopen = false;\r\n        _this.mInitialize = false;\r\n        _this.mConfig = config;\r\n        _this.soundGroup = config.boxMusic;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    ComboBox.prototype.selectCall = function (itemData) {\r\n        this.mtxt.text = itemData.text;\r\n        this.mtxt.x = this.mConfig.wid - this.mtxt.width >> 1;\r\n        this.mtxt.y = this.mConfig.hei - this.mtxt.height >> 1;\r\n        this.showTween(false);\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    ComboBox.prototype.addListen = function () {\r\n        _super.prototype.addListen.call(this);\r\n        this.on("uiClick", this.openHandler, this);\r\n    };\r\n    ComboBox.prototype.removeListen = function () {\r\n        _super.prototype.removeListen.call(this);\r\n        this.off("uiClick", this.openHandler, this);\r\n    };\r\n    Object.defineProperty(ComboBox.prototype, "text", {\r\n        set: function (value) {\r\n            if (!this.mInitialize) {\r\n                this.mSelectData = this.itemList[0].itemData;\r\n                return;\r\n            }\r\n            if (this.itemList) {\r\n                var itemLen = this.itemList.length;\r\n                for (var i = 0; i < itemLen; i++) {\r\n                    var item = this.itemList[i];\r\n                    if (!item)\r\n                        continue;\r\n                    item.destroy();\r\n                    item = null;\r\n                }\r\n                this.itemList.length = 0;\r\n            }\r\n            this.itemList = [];\r\n            var len = value.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = new SelectCallItem(this.scene, this, this.mConfig.wid, this.mConfig.hei, this.mConfig.itemMusic);\r\n                var str = value[i];\r\n                item.itemData = {\r\n                    index: i,\r\n                    text: str,\r\n                    data: {},\r\n                    selected: false,\r\n                    enabled: true,\r\n                };\r\n                this.itemList.push(item);\r\n            }\r\n            // 默認顯示第0個\r\n            this.selectCall(this.itemList[0].itemData);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ComboBox.prototype.destroy = function () {\r\n        if (this.itemList) {\r\n            var len = this.itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n            }\r\n            this.itemList.length = 0;\r\n            this.itemList = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComboBox.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        this.mInitialize = false;\r\n        if (!this.scene.textures.exists(resKey)) {\r\n            this.scene.load.atlas(resKey, resPng, resJson);\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.scene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    ComboBox.prototype.onLoadCompleteHandler = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        this.mBg = this.scene.make.image(undefined, false);\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.mBg.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        this.mArrow = this.scene.make.image(undefined, false);\r\n        this.mArrow.setTexture(resKey, this.mConfig.resArrow);\r\n        this.mArrow.scaleY = this.mConfig.up ? -1 : 1;\r\n        this.mArrow.x = this.mConfig.wid - this.mArrow.width;\r\n        this.mArrow.y = (this.mConfig.hei - this.mArrow.height >> 1) + 4;\r\n        this.mtxt = this.scene.make.text({\r\n            x: 0, y: 0,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        this.add([this.mBg, this.mArrow, this.mtxt]);\r\n        this.mInitialize = true;\r\n        if (this.mSelectData) {\r\n            this.selectCall(this.mSelectData);\r\n        }\r\n    };\r\n    ComboBox.prototype.openHandler = function () {\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        if (this.soundGroup && this.soundGroup.expand)\r\n            this.playSound(this.soundGroup.expand);\r\n        if (!this.itemList || this.itemList.length < 1)\r\n            return;\r\n        this.showTween(this.mIsopen);\r\n    };\r\n    ComboBox.prototype.showTween = function (open) {\r\n        if (open) {\r\n            this.mItemBG = this.createTexture();\r\n            this.addAt(this.mItemBG, 0);\r\n        }\r\n        else {\r\n            if (this.mItemBG) {\r\n                if (this.mItemBG.parentContainer) {\r\n                    this.mItemBG.parentContainer.remove(this.mItemBG);\r\n                }\r\n                this.mItemBG.destroy();\r\n            }\r\n        }\r\n        this.mArrow.scaleY = open ? 1 : -1;\r\n        this.showTweenItem(open);\r\n        this.mIsopen = !this.mIsopen;\r\n    };\r\n    ComboBox.prototype.showTweenItem = function (open) {\r\n        var _this = this;\r\n        var len = this.itemList.length;\r\n        var _loop_1 = function (i) {\r\n            var item = this_1.itemList[i];\r\n            if (!item) {\r\n                return "continue";\r\n            }\r\n            item.x = this_1.mConfig.wid >> 1;\r\n            this_1.add(item);\r\n            this_1.scene.tweens.add({\r\n                targets: item,\r\n                duration: 50 * i,\r\n                props: {\r\n                    y: { value: open ? -this_1.mConfig.hei * i - this_1.mConfig.hei / 2 : -this_1.mConfig.hei >> 1 },\r\n                    alpha: { value: open ? 1 : 0 }\r\n                },\r\n                onComplete: function (tween, targets, element) {\r\n                    if (!open) {\r\n                        _this.remove(item);\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1],\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    ComboBox.prototype.createTexture = function () {\r\n        var COLOR = 0x3D3838;\r\n        var height = this.mConfig.hei * this.itemList.length;\r\n        var bgGraphics = this.scene.make.graphics(undefined, false);\r\n        bgGraphics.fillStyle(COLOR, .8);\r\n        bgGraphics.fillRect(0, -height, this.mConfig.wid, height);\r\n        return bgGraphics;\r\n    };\r\n    return ComboBox;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/combobox/Combobox.ts?')},"./lib/rexui/lib/ui/container/Container.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/containerlite/ContainerLite.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/ContainerLite.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_containerlite_ContainerLite_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/container/Container.js?')},"./lib/rexui/lib/ui/container/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Container_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Container.js */ "./lib/rexui/lib/ui/container/Container.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'container\', function (x, y, width, height, children) {\r\n    var gameObject = new _Container_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, children);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Container\', _Container_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Container_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/container/Factory.js?')},"./lib/rexui/lib/ui/flip/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Flip.js */ "./lib/rexui/lib/ui/flip/Flip.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'flip\', function (gameObject, config) {\r\n    return new _Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Flip\', _Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/flip/Factory.js?')},"./lib/rexui/lib/ui/flip/Flip.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_flip_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/flip.js */ "./lib/rexui/lib/plugins/flip.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_flip_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/flip/Flip.js?')},"./lib/rexui/lib/ui/gridsizer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GridSizer.js */ "./lib/rexui/lib/ui/gridsizer/GridSizer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'gridSizer\', function (x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportion) {\r\n    var gameObject = new _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportion);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.GridSizer\', _GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_GridSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/Factory.js?')},"./lib/rexui/lib/ui/gridsizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0,\r\n        rowHeight;\r\n    var children = this.gridChildren;\r\n    var child, padding, childHeight, proportion;\r\n\r\n    for (var i = 0; i < this.rowCount; i++) {\r\n        proportion = this.rowProportions[i];\r\n        rowHeight = 0;\r\n        if ((proportion === undefined) || (proportion === 0)) {\r\n            for (var j = 0; j < this.columnCount; j++) {\r\n                child = children[(i * this.columnCount) + j];\r\n                if (!child) {\r\n                    continue;\r\n                }\r\n                if (child.rexSizer.hidden) {\r\n                    continue;\r\n                }\r\n\r\n                childHeight = (child.isRexSizer) ?\r\n                    Math.max(child.minHeight, child.childrenHeight) :\r\n                    Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(child);\r\n                padding = child.rexSizer.padding;\r\n                childHeight += (padding.top + padding.bottom);\r\n                rowHeight = Math.max(rowHeight, childHeight);\r\n            }\r\n            result += rowHeight;\r\n        }\r\n        this.rowHeight[i] = rowHeight;\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GetChildrenHeight.js?')},"./lib/rexui/lib/ui/gridsizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function (out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.gridChildren,\r\n        child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child && child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GetChildrenSizers.js?')},"./lib/rexui/lib/ui/gridsizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result = 0,\r\n        columnWidth;\r\n    var children = this.gridChildren;\r\n    var child, padding, childWidth, proportion;\r\n\r\n    for (var i = 0; i < this.columnCount; i++) {\r\n        proportion = this.columnProportions[i];\r\n        columnWidth = 0;\r\n        if ((proportion === undefined) || (proportion === 0)) {\r\n            for (var j = 0; j < this.rowCount; j++) {\r\n                child = children[(j * this.columnCount) + i];\r\n                if (!child) {\r\n                    continue;\r\n                }\r\n                if (child.rexSizer.hidden) {\r\n                    continue;\r\n                }\r\n\r\n                childWidth = (child.isRexSizer) ?\r\n                    Math.max(child.minWidth, child.childrenWidth) :\r\n                    Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(child);\r\n                padding = child.rexSizer.padding;\r\n                childWidth += (padding.left + padding.right);\r\n                columnWidth = Math.max(columnWidth, childWidth);\r\n            }\r\n            result += columnWidth;\r\n        }\r\n        this.columnWidth[i] = columnWidth;\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GetChildrenWidth.js?')},"./lib/rexui/lib/ui/gridsizer/GetExpandedChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildHeight = function (child, rowHeight) {\r\n    var newHeight;\r\n    var childConfig = child.rexSizer;    \r\n    if (childConfig.expand) {\r\n        var padding = childConfig.padding;\r\n        newHeight = rowHeight - padding.top - padding.bottom;\r\n    }\r\n    return newHeight;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GetExpandedChildHeight.js?')},"./lib/rexui/lib/ui/gridsizer/GetExpandedChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildWidth = function (child, colWidth) {\r\n    var newWidth;\r\n    var childConfig = child.rexSizer;    \r\n    if (childConfig.expand) {\r\n        var padding = childConfig.padding;\r\n        newWidth = colWidth - padding.left - padding.right;\r\n    }\r\n    return newWidth;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GetExpandedChildWidth.js?')},"./lib/rexui/lib/ui/gridsizer/GridSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/lib/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/lib/ui/gridsizer/Methods.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/lib/ui/utils/GetBoundsConfig.js\");\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/lib/ui/utils/AlignConst.js\");\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveItem = Phaser.Utils.Array.Remove;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nclass GridSizer extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, columnCount, rowCount, columnProportions, rowProportions) {\r\n        var config;\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(columnCount)) {\r\n            config = columnCount;\r\n            columnCount = GetValue(config, 'column', 0);\r\n            rowCount = GetValue(config, 'row', 0);\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        } else if (IsPlainObject(columnProportions)) {\r\n            config = columnProportions;\r\n            columnProportions = GetValue(config, 'columnProportions', undefined);\r\n            rowProportions = GetValue(config, 'rowProportions', undefined);\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexGridSizer';\r\n        this.initialGrid(columnCount, rowCount, columnProportions, rowProportions);\r\n\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.gridChildren.length = 0;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setColumnProportion(columnIndex, proportion) {\r\n        if (columnIndex >= this.columnProportions.length) {\r\n            return this;\r\n        }\r\n        this.columnProportions[columnIndex] = proportion;\r\n        return this;\r\n    }\r\n\r\n    setRowProportion(rowIndex, proportion) {\r\n        if (rowIndex >= this.rowProportions.length) {\r\n            return this;\r\n        }\r\n        this.rowProportions[rowIndex] = proportion;\r\n        return this;\r\n    }\r\n\r\n    add(gameObject, columnIndex, rowIndex, align, paddingConfig, expand, childKey) {\r\n        super.add(gameObject);\r\n        if (IsPlainObject(columnIndex)) {\r\n            var config = columnIndex;\r\n            columnIndex = GetValue(config, 'column', 0);\r\n            rowIndex = GetValue(config, 'row', 0);\r\n            align = GetValue(config, 'align', ALIGN_CENTER);\r\n            paddingConfig = GetValue(config, 'padding', 0);\r\n            expand = GetValue(config, 'expand', false);\r\n            childKey = GetValue(config, 'key', undefined);\r\n        }\r\n        if (typeof (align) === 'string') {\r\n            align = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"][align];\r\n        }\r\n        if (align === undefined) {\r\n            align = ALIGN_CENTER;\r\n        }\r\n        if (paddingConfig === undefined) {\r\n            paddingConfig = 0;\r\n        }\r\n        if (expand === undefined) {\r\n            expand = true;\r\n        }\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        config.align = align;\r\n        config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig);\r\n        config.expand = expand;\r\n        this.gridChildren[(rowIndex * this.columnCount) + columnIndex] = gameObject;\r\n\r\n        if (childKey !== undefined) {\r\n            this.addChildrenMap(childKey, gameObject)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    remove(gameObject) {\r\n        var config = this.getSizerConfig(gameObject);\r\n        if (config.parent !== this) {\r\n            return this;\r\n        }\r\n        config.parent = undefined;\r\n        RemoveItem(this.gridChildren, gameObject);\r\n\r\n        if (this.backgroundChildren !== undefined) {\r\n            RemoveItem(this.backgroundChildren, gameObject);\r\n        }\r\n        super.remove(gameObject);\r\n        return this;\r\n    }\r\n\r\n    get totalColumnProportions() {\r\n        var result = 0,\r\n            proportion;\r\n        for (var i = 0; i < this.columnCount; i++) {\r\n            proportion = this.columnProportions[i];\r\n            if (proportion > 0) {\r\n                result += proportion;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    get totalRowProportions() {\r\n        var result = 0,\r\n            proportion;\r\n        for (var i = 0; i < this.rowCount; i++) {\r\n            proportion = this.rowProportions[i];\r\n            if (proportion > 0) {\r\n                result += proportion;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    initialGrid(columnCount, rowCount, columnProportions, rowProportions) {\r\n        this.columnCount = columnCount;\r\n        this.rowCount = rowCount;\r\n        this.gridChildren = [];\r\n        this.gridChildren.length = columnCount * rowCount;\r\n        this.columnProportions = [];\r\n        this.columnProportions.length = columnCount;\r\n        this.columnWidth = [];\r\n        this.columnWidth.length = columnCount;\r\n        this.rowProportions = [];\r\n        this.rowProportions.length = rowCount;\r\n        this.rowHeight = [];\r\n        this.rowHeight.length = rowCount;\r\n\r\n        if (columnProportions) {\r\n            var columnProportionsIsNumber = (typeof (columnProportions) === 'number');\r\n            for (var i = 0; i < columnCount; i++) {\r\n                if (columnProportionsIsNumber) {\r\n                    this.setColumnProportion(i, columnProportions);\r\n                } else {\r\n                    var columnProportion = columnProportions[i];\r\n                    if (columnProportion > 0) {\r\n                        this.setColumnProportion(i, columnProportion);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (rowProportions) {\r\n            var rowProportionsIsNumber = (typeof (rowProportions) === 'number');\r\n            for (var i = 0; i < rowCount; i++) {\r\n                if (rowProportionsIsNumber) {\r\n                    this.setRowProportion(i, rowProportions);\r\n                } else {\r\n                    var rowProportion = rowProportions[i];\r\n                    if (rowProportion > 0) {\r\n                        this.setRowProportion(i, rowProportion);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    GridSizer.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GridSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/GridSizer.js?")},"./lib/rexui/lib/ui/gridsizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetExpandedChildWidth.js */ "./lib/rexui/lib/ui/gridsizer/GetExpandedChildWidth.js");\n/* harmony import */ var _GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetExpandedChildHeight.js */ "./lib/rexui/lib/ui/gridsizer/GetExpandedChildHeight.js");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/lib/plugins/utils/actions/GlobZone.js");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n\r\n\r\n\r\n\r\n\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.preLayout(parent);\r\n\r\n    var totalColumnProportions = this.totalColumnProportions;\r\n    var totalRowProportions = this.totalRowProportions;\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        if (parent && (totalColumnProportions > 0)) { // Expand to parent width\r\n            var padding = this.rexSizer.padding;\r\n            newWidth = parent.width - padding.left - padding.right;\r\n        } else {\r\n            newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n        }\r\n    }\r\n    if (newHeight === undefined) {\r\n        if (parent && (totalRowProportions > 0)) { // Expand to parent height\r\n            var padding = this.rexSizer.padding;\r\n            newHeight = parent.height - padding.top - padding.bottom;\r\n        } else {\r\n            newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n        }\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    var proportionWidthLength;\r\n    if (totalColumnProportions > 0) {\r\n        proportionWidthLength = (this.width - this.childrenWidth) / totalColumnProportions;\r\n    } else {\r\n        proportionWidthLength = 0;\r\n    }\r\n    var proportionHeightLength;\r\n    if (totalRowProportions > 0) {\r\n        proportionHeightLength = (this.height - this.childrenHeight) / totalRowProportions;\r\n    } else {\r\n        proportionHeightLength = 0;\r\n    }\r\n\r\n    // Layout children\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var itemX = startX,\r\n        itemY = startY;\r\n    var x, y, width, height; // Align zone\r\n    var childWidth, childHeight;\r\n    // Layout grid children\r\n    var colProportion, rowProportion,\r\n        colWidth, rowHeight;\r\n    for (var rowIndex = 0; rowIndex < this.rowCount; rowIndex++) {\r\n        rowProportion = this.rowProportions[rowIndex] || 0;\r\n        rowHeight = (rowProportion === 0) ? this.rowHeight[rowIndex] : (rowProportion * proportionHeightLength);\r\n\r\n        itemX = startX;\r\n        for (var columnIndex = 0; columnIndex < this.columnCount; columnIndex++) {\r\n            colProportion = this.columnProportions[columnIndex] || 0;\r\n            colWidth = (colProportion === 0) ? this.columnWidth[columnIndex] : (colProportion * proportionWidthLength);\r\n\r\n            child = this.gridChildren[(rowIndex * this.columnCount) + columnIndex];\r\n            if ((!child) || (child.rexSizer.hidden)) {\r\n                itemX += colWidth;\r\n                continue;\r\n            }\r\n\r\n            childWidth = Object(_GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, colWidth);\r\n            childHeight = Object(_GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(child, rowHeight);\r\n            if (child.isRexSizer) {\r\n                child.layout(this, childWidth, childHeight);\r\n            } else {\r\n                Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, childWidth, childHeight);\r\n            }\r\n\r\n            childConfig = child.rexSizer;\r\n            padding = childConfig.padding;\r\n            x = (itemX + padding.left);\r\n            width = colWidth - padding.left - padding.right;\r\n            y = (itemY + padding.top);\r\n            height = rowHeight - padding.top - padding.bottom;\r\n\r\n            _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"].setPosition(x, y).setSize(width, height);\r\n            Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_4__["default"])(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"], childConfig.align);\r\n            this.resetChildPositionState(child);\r\n\r\n            itemX += colWidth;\r\n        }\r\n\r\n        itemY += rowHeight;\r\n    }\r\n\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this.postLayout();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/Layout.js?')},"./lib/rexui/lib/ui/gridsizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/lib/ui/gridsizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/lib/ui/gridsizer/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/lib/ui/gridsizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/lib/ui/gridsizer/Layout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/lib/ui/gridsizer/_layoutInit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/Methods.js?')},"./lib/rexui/lib/ui/gridsizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInitChild = function () {\r\n    this._childrenWidth = undefined;\r\n    this._childrenHeight = undefined;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInitChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridsizer/_layoutInit.js?')},"./lib/rexui/lib/ui/gridtable/Factory.js":function(module,exports,__webpack_require__){"use strict";eval('\r\nObject.defineProperty(exports, "__esModule", { value: true });\r\nvar GridTable_js_1 = __webpack_require__(/*! ./GridTable.js */ "./lib/rexui/lib/ui/gridtable/GridTable.js");\r\nvar ObjectFactory_js_1 = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\r\nvar SetValue_js_1 = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\r\nObjectFactory_js_1.default.register(\'gridTable\', function (config) {\r\n    var gameObject = new GridTable_js_1.default(this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\nSetValue_js_1.default(window, \'RexPlugins.UI.GridTable\', GridTable_js_1.default);\r\nexports.default = GridTable_js_1.default;\r\n//# sourceMappingURL=Factory.js.map\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/Factory.js?')},"./lib/rexui/lib/ui/gridtable/GameGridTable.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameGridTable", function() { return GameGridTable; });\n/* harmony import */ var _GridTable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GridTable.js */ "./lib/rexui/lib/ui/gridtable/GridTable.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar GameGridTable = /** @class */ (function (_super) {\r\n    __extends(GameGridTable, _super);\r\n    function GameGridTable(scene, config) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mGridTable = new _GridTable_js__WEBPACK_IMPORTED_MODULE_0__["default"](scene, config);\r\n        _this.mConfig = config;\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    GameGridTable.prototype.adjustScrollMode = function (mode) {\r\n        // // Pre-process cell size\r\n        // this.mConfig.scrollMode = mode;\r\n        // const tableCoreConfig: GridTableCoreConfig;\r\n        // let cellWidth: number;\r\n        // let cellHeight: number;\r\n        // if (mode === 0) { // scroll y\r\n        //     cellWidth = GetValue(tableCoreConfig, "cellWidth", undefined);\r\n        //     this.expandCellSize = (cellWidth === undefined);\r\n        //     if (cellWidth === undefined) {\r\n        //         var columns = GetValue(tableCoreConfig, "columns", 1);\r\n        //         this.mConfig.cellWidth = this.width / columns;\r\n        //     }\r\n        // } else { // scroll x\r\n        //     // Swap cell width and cell height\r\n        //     cellWidth = GetValue(tableCoreConfig, "cellHeight", undefined);\r\n        //     cellHeight = GetValue(tableCoreConfig, \'cellWidth\', undefined);\r\n        //     this.expandCellSize = (cellWidth === undefined);\r\n        //     config.cellWidth = cellWidth;\r\n        //     config.cellHeight = cellHeight;\r\n        // }\r\n        // this.table = new Table(this, config);\r\n    };\r\n    /**\r\n     * 调整gridtable遮照范围\r\n     * @param width\r\n     * @param height\r\n     * @param x\r\n     * @param y\r\n     */\r\n    GameGridTable.prototype.adjustMask = function (x, y, width, height) {\r\n        if (x === void 0) { x = this.mConfig.x; }\r\n        if (y === void 0) { y = this.mConfig.y; }\r\n        if (!this.mGridTable)\r\n            return;\r\n        this.mGridTable.x = x;\r\n        this.mGridTable.y = y;\r\n        if (width !== this.mGridTable.width || height !== this.mGridTable.height) {\r\n            this.mGridTable.resize(width, height);\r\n        }\r\n    };\r\n    Object.defineProperty(GameGridTable.prototype, "gridTable", {\r\n        get: function () {\r\n            return this.mGridTable;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameGridTable.prototype, "childrenMap", {\r\n        get: function () {\r\n            if (this.mGridTable)\r\n                return this.mGridTable.childrenMap;\r\n            return undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameGridTable.prototype, "table", {\r\n        get: function () {\r\n            if (this.mGridTable)\r\n                return this.mGridTable.getElement("table");\r\n            return undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Only worked when scrollMode is 0\r\n     * @param hei\r\n     */\r\n    GameGridTable.prototype.adjustCellHeight = function (hei) {\r\n        if (!this.mGridTable)\r\n            return;\r\n        var cells = this.mGridTable.getCells();\r\n        for (var i = 0, len = cells.length; i < len; i++) {\r\n            this.mGridTable.setCellHeight(i, hei);\r\n        }\r\n    };\r\n    /**\r\n     * Only worked when scrollMode is 1\r\n     * @param wid\r\n     */\r\n    GameGridTable.prototype.adjusetCellWidth = function (wid) {\r\n        if (!this.mGridTable)\r\n            return;\r\n        var cells = this.mGridTable.getCells();\r\n        for (var i = 0, len = cells.length; i < len; i++) {\r\n            this.mGridTable.setCellWidth(i, wid);\r\n        }\r\n    };\r\n    Object.defineProperty(GameGridTable.prototype, "items", {\r\n        get: function () {\r\n            if (!this.mGridTable)\r\n                return null;\r\n            return this.mGridTable.items;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GameGridTable.prototype.setItems = function (items) {\r\n        if (this.mGridTable) {\r\n            this.mGridTable.setItems(items);\r\n            this.mGridTable.layout();\r\n        }\r\n    };\r\n    GameGridTable.prototype.setColumnCount = function (cnt) {\r\n        this.mGridTable.setColumnCount(cnt);\r\n        return this;\r\n    };\r\n    GameGridTable.prototype.getCells = function () {\r\n        return this.mGridTable.getCells();\r\n    };\r\n    GameGridTable.prototype.getCell = function (cellIdx) {\r\n        return this.mGridTable.getCell(cellIdx, true);\r\n    };\r\n    GameGridTable.prototype.setT = function (value) {\r\n        if (this.mGridTable)\r\n            this.mGridTable.setT(value);\r\n    };\r\n    GameGridTable.prototype.addListen = function () {\r\n        if (this.mGridTable) {\r\n            this.mGridTable.on("cell.1tap", this.cellTapHandler, this);\r\n        }\r\n    };\r\n    GameGridTable.prototype.removeListen = function () {\r\n        if (this.mGridTable) {\r\n            this.mGridTable.off("cell.1tap", this.cellTapHandler, this);\r\n        }\r\n    };\r\n    Object.defineProperty(GameGridTable.prototype, "x", {\r\n        get: function () {\r\n            if (!this.mGridTable)\r\n                return 0;\r\n            return this.mGridTable.x;\r\n        },\r\n        set: function (value) {\r\n            if (this.mGridTable)\r\n                this.mGridTable.x = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameGridTable.prototype, "y", {\r\n        get: function () {\r\n            if (!this.mGridTable)\r\n                return 0;\r\n            return this.mGridTable.y;\r\n        },\r\n        set: function (value) {\r\n            if (this.mGridTable)\r\n                this.mGridTable.y = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GameGridTable.prototype.refresh = function () {\r\n        if (this.mGridTable)\r\n            this.mGridTable.refresh();\r\n    };\r\n    GameGridTable.prototype.resetMask = function (x, y, width, height) {\r\n        if (this.mGridTable)\r\n            this.mGridTable.resetMask(x, y, width, height);\r\n    };\r\n    GameGridTable.prototype.layout = function () {\r\n        if (this.mGridTable)\r\n            this.mGridTable.layout();\r\n    };\r\n    GameGridTable.prototype.refreshPos = function (x, y, conx, cony) {\r\n        if (!this.mGridTable)\r\n            return;\r\n        this.mGridTable.x = x;\r\n        this.mGridTable.y = y;\r\n        if (this.table && conx !== undefined && cony !== undefined) {\r\n            this.table.tableOX = conx;\r\n            this.table.tableOY = cony;\r\n        }\r\n        this.adjustMask(x, y);\r\n        this.mGridTable.layout();\r\n        this.resetMask();\r\n    };\r\n    GameGridTable.prototype.destroy = function () {\r\n        if (this.mGridTable) {\r\n            this.removeListen();\r\n            this.mGridTable.destroy();\r\n        }\r\n    };\r\n    GameGridTable.prototype.cellTapHandler = function (cell) {\r\n        this.emit("cellTap", cell);\r\n    };\r\n    return GameGridTable;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/GameGridTable.ts?')},"./lib/rexui/lib/ui/gridtable/GridTable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ "./lib/rexui/lib/ui/utils/scrollable/Scrollable.js");\n/* harmony import */ var _utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/GetScrollMode.js */ "./lib/rexui/lib/ui/utils/GetScrollMode.js");\n/* harmony import */ var _plugins_gameobjects_gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/gameobjects/gridtable/GridTable.js */ "./lib/rexui/lib/plugins/gameobjects/gridtable/GridTable.js");\n/* harmony import */ var _InjectProperties_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./InjectProperties.js */ "./lib/rexui/lib/ui/gridtable/InjectProperties.js");\n/* harmony import */ var _TableOnCellVisible_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableOnCellVisible.js */ "./lib/rexui/lib/ui/gridtable/TableOnCellVisible.js");\n/* harmony import */ var _input_TableSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./input/TableSetInteractive.js */ "./lib/rexui/lib/ui/gridtable/input/TableSetInteractive.js");\n/* harmony import */ var _plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugins/utils/object/NOOP.js */ "./lib/rexui/lib/plugins/utils/object/NOOP.js");\n/* harmony import */ var _SetItems_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./SetItems.js */ "./lib/rexui/lib/ui/gridtable/SetItems.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nclass GridTable extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create grid table core\r\n        var scrollMode = Object(_utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__["default"])(config);\r\n        var tableConfig = GetValue(config, "table", undefined);\r\n        if (tableConfig === undefined) {\r\n            tableConfig = {};\r\n        }\r\n        tableConfig.scrollMode = scrollMode;\r\n        tableConfig.clamplTableOXY = GetValue(config, "clamplChildOY", false);\r\n        var tableWidth = GetValue(tableConfig, "width", undefined);\r\n        var tableHeight = GetValue(tableConfig, "height", undefined);\r\n        var table = new _plugins_gameobjects_gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_2__["default"](\r\n            scene,\r\n            0,\r\n            0,\r\n            tableWidth,\r\n            tableHeight,\r\n            tableConfig\r\n        );\r\n        scene.add.existing(table); // Important: Add to display list for touch detecting\r\n        var proportion, expand;\r\n        if (scrollMode === 0) {\r\n            proportion = tableWidth === undefined ? 1 : 0;\r\n            expand = tableHeight === undefined;\r\n        } else {\r\n            proportion = tableHeight === undefined ? 1 : 0;\r\n            expand = tableWidth === undefined;\r\n        }\r\n        // Inject properties for scrollable interface\r\n        Object(_InjectProperties_js__WEBPACK_IMPORTED_MODULE_3__["default"])(table);\r\n        // Fill config of scrollable\r\n        config.type = "rexGridTable";\r\n        config.child = {\r\n            gameObject: table,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, "space", undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.table;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap("table", table);\r\n\r\n        this.eventEmitter = GetValue(config, "eventEmitter", this);\r\n        var callback = GetValue(config, "createCellContainerCallback", _plugins_utils_object_NOOP_js__WEBPACK_IMPORTED_MODULE_6__["default"]);\r\n        var scope = GetValue(\r\n            config,\r\n            "createCellContainerCallbackScope",\r\n            undefined\r\n        );\r\n        this.setCreateCellContainerCallback(callback, scope);\r\n\r\n        _TableOnCellVisible_js__WEBPACK_IMPORTED_MODULE_4__["default"].call(this, table);\r\n\r\n        if (GetValue(tableConfig, "interactive", true)) {\r\n            _input_TableSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__["default"].call(this, table, tableConfig);\r\n        }\r\n        this.setItems(GetValue(config, "items", []));\r\n    }\r\n\r\n    set tableOX(ox) {\r\n        const table = this.getElement("table");\r\n        if (table) table.tableOX = ox;\r\n    }\r\n\r\n    set tableOY(oy) {\r\n        const table = this.getElement("table");\r\n        if (table) table.tableOY = oy;\r\n    }\r\n    setColumnCount(cnt) {\r\n        const table = this.getElement("table");\r\n        if (table) table.setColumnCount(cnt);\r\n        return this;\r\n    }\r\n\r\n    getCells() {\r\n        const table = this.getElement("table");\r\n        return table.table.cells;\r\n    }\r\n\r\n    getCell(cellIdx) {\r\n        const table = this.getElement("table");\r\n        return table.getCell(cellIdx, true);\r\n    }\r\n    setCreateCellContainerCallback(callback, scope) {\r\n        this.createCellContainerCallback = callback;\r\n        this.createCellContainerCallbackScope = scope;\r\n        return this;\r\n    }\r\n\r\n    resetMask(x,y,width,height){\r\n        const table = this.getElement("table");\r\n        const mask = table.getCellsMaskGameObject();\r\n        if(mask){\r\n            mask.setPosition(x,y);\r\n            mask.resize(width,height);\r\n        }\r\n    }\r\n    refresh() {\r\n        this.setItems(this.items);\r\n        return this;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    setItems: _SetItems_js__WEBPACK_IMPORTED_MODULE_7__["default"],\r\n};\r\nObject.assign(GridTable.prototype, methods);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GridTable);\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/GridTable.js?')},"./lib/rexui/lib/ui/gridtable/InjectProperties.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar InjectProperties = function (table) {\r\n    Object.defineProperty(table, 'childOY', {\r\n        configurable: true,\r\n        get: function () {\r\n            return table.tableOY;\r\n        },\r\n        set: function (value) {\r\n            table.tableOY = value;\r\n        }\r\n    });\r\n    Object.defineProperty(table, 'topChildOY', {\r\n        get: function () {\r\n            return table.topTableOY;\r\n        }\r\n    });\r\n    Object.defineProperty(table, 'bottomChildOY', {\r\n        get: function () {\r\n            return table.bottomTableOY;\r\n        }\r\n    });\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InjectProperties);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/InjectProperties.js?")},"./lib/rexui/lib/ui/gridtable/SetItems.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetItems = function (items) {\r\n    if (items === undefined) {\r\n        this.items.length = 0;\r\n    } else {\r\n        this.items = items;\r\n    }\r\n\r\n    var table = this.childrenMap.child;\r\n    table.setCellsCount(this.items.length);\r\n    table.updateTable(true);\r\n\r\n    this.resizeController();\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetItems);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/SetItems.js?')},"./lib/rexui/lib/ui/gridtable/TableOnCellVisible.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar TableOnCellVisible = function (table) {\r\n    table.on('cellvisible', function (cell, cellContainer) {\r\n        var callback = this.createCellContainerCallback;\r\n        var scope = this.createCellContainerCallbackScope;\r\n        cell.item = this.items[cell.index];\r\n        var cellContainer;\r\n        if (scope) {\r\n            cellContainer = callback.call(scope, cell, cellContainer);\r\n        } else {\r\n            cellContainer = callback(cell, cellContainer);\r\n        }\r\n        if (cellContainer) {\r\n            if (cellContainer.setOrigin) {\r\n                cellContainer.setOrigin(0);\r\n            }\r\n            if (cellContainer.isRexSizer) {\r\n                cellContainer.layout(); // Use original size\r\n            }\r\n        }\r\n\r\n        cell.item = undefined;\r\n        cell.setContainer(cellContainer);\r\n    }, this);\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TableOnCellVisible);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/TableOnCellVisible.js?")},"./lib/rexui/lib/ui/gridtable/input/ClickCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugins/input/button/Button.js */ "./lib/rexui/lib/plugins/input/button/Button.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nvar ClickCell = function (table, tableConfig) {\r\n    table._click = new _plugins_input_button_Button_js__WEBPACK_IMPORTED_MODULE_0__["default"](table, {\r\n        threshold: 10\r\n    });\r\n    table._click.on(\'click\', function (button, gameObject, pointer) {\r\n        Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.click\', gameObject, pointer.x, pointer.y);\r\n    }, this);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ClickCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/ClickCell.js?')},"./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar EmitCellEvent = function (eventEmitter, eventName, table, x, y) {\r\n    var cellIndex;\r\n    if (y === undefined) {\r\n        cellIndex = x;\r\n    } else {\r\n        cellIndex = table.pointerToCellIndex(x, y);\r\n    }\r\n    if ((cellIndex === null) || (cellIndex === undefined)) {\r\n        return;\r\n    }\r\n    var cellContainer = table.getCellContainer(cellIndex);\r\n    eventEmitter.emit(eventName, cellContainer, cellIndex);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (EmitCellEvent);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js?')},"./lib/rexui/lib/ui/gridtable/input/OverCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EmitCellEvent.js */ \"./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js\");\n\r\n\r\nvar OverCell = function (table, tableConfig) {\r\n    table\r\n        .on('pointermove', OnMove, this)\r\n        .on('pointerover', OnMove, this)\r\n        .on('pointerup', OnOut, this)\r\n        .on('pointerout', OnOut, this);\r\n}\r\n\r\nvar OnMove = function (pointer) {\r\n    if (pointer.isDown) {\r\n        return;\r\n    }\r\n    var table = this.childrenMap.child;\r\n    var cellIndex = table.pointerToCellIndex(pointer.x, pointer.y);\r\n    if (cellIndex === this._lastOverCellIndex) {\r\n        return;\r\n    }\r\n\r\n    var preCellIndex = this._lastOverCellIndex;\r\n    this._lastOverCellIndex = cellIndex;\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.out', table, preCellIndex);\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.over', table, cellIndex);\r\n}\r\n\r\nvar OnOut = function () {\r\n    var table = this.childrenMap.child;\r\n    var cellIndxe = this._lastOverCellIndex;\r\n    this._lastOverCellIndex = undefined;\r\n    Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.eventEmitter, 'cell.out', table, cellIndxe);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (OverCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/OverCell.js?")},"./lib/rexui/lib/ui/gridtable/input/PressCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _press_Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../press/Press.js */ "./lib/rexui/lib/ui/press/Press.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar PressCell = function (table, tableConfig) {\r\n    var pressConfig = GetValue(tableConfig, \'press\', undefined);\r\n    table._press = new _press_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"](table, pressConfig);\r\n    table._press\r\n        .on(\'pressstart\', function (press) {\r\n            var cellIndex = table.pointerToCellIndex(press.x, press.y);\r\n            press._cellIndex = cellIndex;\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.pressstart\', table, cellIndex);\r\n        }, this)\r\n        .on(\'pressend\', function (press) {\r\n            var cellIndex = press._cellIndex;\r\n            press._cellIndex = undefined;\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, \'cell.pressend\', table, cellIndex);\r\n        }, this)\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PressCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/PressCell.js?')},"./lib/rexui/lib/ui/gridtable/input/SwipeCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../swipe/Swipe.js */ \"./lib/rexui/lib/ui/swipe/Swipe.js\");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ \"./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar SwipeCell = function (table, tableConfig) {\r\n    var swipeConfig = GetValue(tableConfig, 'swipe', undefined);\r\n    if (swipeConfig === undefined) {\r\n        swipeConfig = {};\r\n    }\r\n    swipeConfig.dir = '4dir';\r\n    table._swipe = new _swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](table, swipeConfig);\r\n    table._swipe\r\n        .on('swipe', function (swipe) {\r\n            var isValidSwipe = (table.scrollMode === 0) ? (swipe.left || swipe.right) : (swipe.up || swipe.down);\r\n            if (isValidSwipe) {\r\n                var cellIndex = table.pointerToCellIndex(swipe.x, swipe.y);\r\n                var dirName =\r\n                    (swipe.left) ? 'left' :\r\n                        (swipe.right) ? 'right' :\r\n                            (swipe.up) ? 'up' :\r\n                                'down';\r\n                Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.eventEmitter, `cell.swipe${dirName}`, table, cellIndex);\r\n            }\r\n        }, this)\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (SwipeCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/SwipeCell.js?")},"./lib/rexui/lib/ui/gridtable/input/TableSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ClickCell_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ClickCell.js */ "./lib/rexui/lib/ui/gridtable/input/ClickCell.js");\n/* harmony import */ var _OverCell_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OverCell.js */ "./lib/rexui/lib/ui/gridtable/input/OverCell.js");\n/* harmony import */ var _TapCell_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TapCell.js */ "./lib/rexui/lib/ui/gridtable/input/TapCell.js");\n/* harmony import */ var _PressCell_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PressCell.js */ "./lib/rexui/lib/ui/gridtable/input/PressCell.js");\n/* harmony import */ var _SwipeCell_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SwipeCell.js */ "./lib/rexui/lib/ui/gridtable/input/SwipeCell.js");\n\r\n\r\n\r\n\r\n\r\n\r\nvar TableSetInteractive = function (table, tableConfig) {\r\n    table.setInteractive();\r\n\r\n    _ClickCell_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, table, tableConfig);\r\n    _OverCell_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this, table, tableConfig);\r\n    _TapCell_js__WEBPACK_IMPORTED_MODULE_2__["default"].call(this, table, tableConfig);\r\n    _PressCell_js__WEBPACK_IMPORTED_MODULE_3__["default"].call(this, table, tableConfig);\r\n    _SwipeCell_js__WEBPACK_IMPORTED_MODULE_4__["default"].call(this, table, tableConfig);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TableSetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/TableSetInteractive.js?')},"./lib/rexui/lib/ui/gridtable/input/TapCell.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../tap/Tap.js */ "./lib/rexui/lib/ui/tap/Tap.js");\n/* harmony import */ var _EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EmitCellEvent.js */ "./lib/rexui/lib/ui/gridtable/input/EmitCellEvent.js");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar TapCell = function (table, tableConfig) {\r\n    var tapConfig = GetValue(tableConfig, \'press\', undefined);\r\n    table._tap = new _tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"](table, tapConfig);\r\n    table._tap\r\n        .on(\'tap\', function (tap) {\r\n            var eventName = `cell.${tap.tapsCount}tap`\r\n            Object(_EmitCellEvent_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.eventEmitter, eventName, tap.gameObject, tap.x, tap.y);\r\n        }, this)\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TapCell);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/gridtable/input/TapCell.js?')},"./lib/rexui/lib/ui/interface/baseUI/Patches.config.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizePatchesConfig", function() { return normalizePatchesConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "resetPatchesConfig", function() { return resetPatchesConfig; });\nvar normalizePatchesConfig = function (config) {\r\n    config.bottom = (config.bottom !== undefined) ? config.bottom : config.top;\r\n    config.left = (config.left !== undefined) ? config.left : config.top;\r\n    config.right = (config.right !== undefined) ? config.right : config.left;\r\n    return config;\r\n};\r\nvar resetPatchesConfig = function (config) {\r\n    config.top = 0;\r\n    config.bottom = 0;\r\n    config.left = 0;\r\n    config.right = 0;\r\n    return config;\r\n};\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/interface/baseUI/Patches.config.ts?')},"./lib/rexui/lib/ui/interface/baseUI/UIType.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIType", function() { return UIType; });\n/**\r\n * @typedef {number} UIType\r\n */\r\n/**\r\n * @enum {UIType}\r\n * @memberof tooqinui\r\n * @readonly\r\n * @property {number} None 0\r\n * @property {number} Scene 1\r\n * @property {number} Normal 2\r\n * @property {number} Pop 3\r\n * @property {number} Tips 4\r\n * @property {number} Monopoly 5\r\n * @property {number} Activity 6\r\n*/\r\nvar UIType;\r\n(function (UIType) {\r\n    UIType[UIType["None"] = 0] = "None";\r\n    UIType[UIType["Scene"] = 1] = "Scene";\r\n    UIType[UIType["Normal"] = 2] = "Normal";\r\n    UIType[UIType["Pop"] = 3] = "Pop";\r\n    UIType[UIType["Tips"] = 4] = "Tips";\r\n    UIType[UIType["Monopoly"] = 5] = "Monopoly";\r\n    UIType[UIType["Activity"] = 6] = "Activity";\r\n})(UIType || (UIType = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/interface/baseUI/UIType.ts?')},"./lib/rexui/lib/ui/interface/event/MouseEvent.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CoreUI", function() { return CoreUI; });\nvar CoreUI;\r\n(function (CoreUI) {\r\n    var MouseEvent;\r\n    (function (MouseEvent) {\r\n        MouseEvent["Click"] = "click";\r\n        MouseEvent["Up"] = "Up";\r\n        MouseEvent["Down"] = "Down";\r\n        MouseEvent["Hold"] = "Hold";\r\n        MouseEvent["Tap"] = "Tap";\r\n        MouseEvent["Move"] = "Move";\r\n        MouseEvent["Over"] = "Over";\r\n        MouseEvent["Out"] = "Out";\r\n        MouseEvent["DragStart"] = "DragStart";\r\n        MouseEvent["DragStop"] = "DragStop";\r\n    })(MouseEvent = CoreUI.MouseEvent || (CoreUI.MouseEvent = {}));\r\n})(CoreUI || (CoreUI = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/interface/event/MouseEvent.ts?')},"./lib/rexui/lib/ui/interface/sound/ISoundConfig.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SoundField", function() { return SoundField; });\nvar SoundField;\r\n(function (SoundField) {\r\n    SoundField[SoundField["Background"] = 0] = "Background";\r\n    SoundField[SoundField["Element"] = 1] = "Element";\r\n    SoundField[SoundField["Effect"] = 2] = "Effect";\r\n})(SoundField || (SoundField = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/interface/sound/ISoundConfig.ts?')},"./lib/rexui/lib/ui/label/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Label_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Label.js */ "./lib/rexui/lib/ui/label/Label.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'label\', function (config) {\r\n    var gameObject = new _Label_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Label\', _Label_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Label_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/label/Factory.js?')},"./lib/rexui/lib/ui/label/Label.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/lib/ui/sizer/Sizer.js\");\n/* harmony import */ var _utils_AddChildMask_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/AddChildMask.js */ \"./lib/rexui/lib/ui/utils/AddChildMask.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Label extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        // Create sizer\r\n        super(scene, config);\r\n        this.type = 'rexLabel';\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var icon = GetValue(config, 'icon', undefined);\r\n        var iconMask = GetValue(config, 'iconMask', undefined);\r\n        var text = GetValue(config, 'text', undefined);\r\n        var action = GetValue(config, 'action', undefined);\r\n        var actionMask = GetValue(config, 'actionMask', undefined);\r\n        // Align\r\n        var align = GetValue(config, 'align', undefined); // undefined/left/top: no space\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n        var iconSpace = GetValue(config, 'space.icon', 0);\r\n        var textSpace = GetValue(config, 'space.text', 0);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        // Add space\r\n        if (\r\n            (align === 'right') ||\r\n            (align === 'bottom') ||\r\n            (align === 'center')\r\n        ) {\r\n            this.addSpace();\r\n        }\r\n\r\n        if (icon) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: (text || action) ? iconSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: (text || action) ? iconSpace : paddingBottom\r\n                }\r\n            }\r\n\r\n            this.add(icon, 0, 'center', padding);\r\n\r\n            if (iconMask) {\r\n                iconMask = this.addChildMask(icon, icon, 1); // Circle mask\r\n            }\r\n        }\r\n\r\n        if (text) {\r\n            var expandTextWidth = GetValue(config, 'expandTextWidth', false);\r\n            var expandTextHeight = GetValue(config, 'expandTextHeight', false);\r\n            var proportion, padding, expand;\r\n            if (this.orientation === 0) {\r\n                proportion = (expandTextWidth) ? 1 : 0;\r\n                padding = {\r\n                    left: (icon) ? 0 : paddingLeft,\r\n                    right: (action) ? textSpace : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                };\r\n                expand = expandTextHeight;\r\n            } else {\r\n                proportion = (expandTextHeight) ? 1 : 0;\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon) ? 0 : paddingTop,\r\n                    bottom: (action) ? textSpace : paddingBottom\r\n                }\r\n                expand = expandTextWidth;\r\n            }\r\n            this.add(text, proportion, 'center', padding, expand);\r\n        }\r\n\r\n        if (action) {\r\n            var padding;\r\n            if (this.orientation === 0) {\r\n                padding = {\r\n                    left: (icon || text) ? 0 : paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (icon || text) ? 0 : paddingTop,\r\n                    bottom: paddingBottom\r\n                }\r\n            }\r\n            this.add(action, 0, 'center', padding);\r\n\r\n            if (actionMask) {\r\n                actionMask = this.addChildMask(action, action, 1); // Circle mask\r\n            }\r\n        }\r\n\r\n        // Add space\r\n        if (align === 'center') {\r\n            this.addSpace();\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('icon', icon);\r\n        this.addChildrenMap('iconMask', iconMask);\r\n        this.addChildrenMap('text', text);\r\n        this.addChildrenMap('action', action);\r\n        this.addChildrenMap('actionMask', actionMask);\r\n    }\r\n\r\n    get text() {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return '';\r\n        }\r\n        var value;\r\n        if (textObject.text) {\r\n            value = textObject.text;\r\n        } else {\r\n            value = textObject.getData('text');\r\n        }\r\n        return value;\r\n    }\r\n\r\n    set text(value) {\r\n        var textObject = this.childrenMap.text;\r\n        if (textObject === undefined) {\r\n            return;\r\n        }\r\n        if (textObject.setText) {\r\n            textObject.setText(value);\r\n        } else {\r\n            textObject.setData('text', value);\r\n        }\r\n    }\r\n\r\n    setText(value) {\r\n        this.text = value;\r\n        return this;\r\n    }\r\n\r\n    appendText(value) {\r\n        this.text += value;\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        // Pin icon-mask to icon game object\r\n        var iconMask = this.childrenMap.iconMask;\r\n        if (iconMask) {\r\n            iconMask.setPosition();\r\n            this.resetChildPositionState(iconMask);\r\n        }\r\n        // Pin action-mask to action game object\r\n        var actionMask = this.childrenMap.actionMask;\r\n        if (actionMask) {\r\n            actionMask.setPosition();\r\n            this.resetChildPositionState(actionMask);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    resize(width, height) {\r\n        super.resize(width, height);\r\n        // Resize icon-mask to icon game object\r\n        var iconMask = this.childrenMap.iconMask;\r\n        if (iconMask) {\r\n            iconMask.resize();\r\n        }\r\n        // Resize action-mask to icon game object\r\n        var actionMask = this.childrenMap.actionMask;\r\n        if (actionMask) {\r\n            actionMask.resize();\r\n        }\r\n        return this;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    addChildMask: _utils_AddChildMask_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n}\r\n\r\nObject.assign(\r\n    Label.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Label);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/label/Label.js?")},"./lib/rexui/lib/ui/menu/Collapse.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetEaseConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetEaseConfig.js */ "./lib/rexui/lib/ui/menu/GetEaseConfig.js");\n\r\n\r\nvar Collapse = function () {\r\n    this.root.emit(\'collapse\', this, this.parentButton, this.parentMenu);\r\n    this.scaleDownDestroy(Object(_GetEaseConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, this.root.easeOut));\r\n    this.collapseSubMenu();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Collapse);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/Collapse.js?')},"./lib/rexui/lib/ui/menu/CollapseSubMenu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CollapseSubMenu = function () {\r\n    if (this.childrenMap.subMenu === undefined) {\r\n        return this;\r\n    }\r\n\r\n    var subMenu = this.childrenMap.subMenu;\r\n    this.childrenMap.subMenu = undefined;\r\n    this.remove(subMenu);\r\n    subMenu.collapse();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (CollapseSubMenu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/CollapseSubMenu.js?')},"./lib/rexui/lib/ui/menu/CreateBackground.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CreateBackground = function (scene, items, callback, scope) {\r\n    var background;\r\n    if (callback) {\r\n        items.scene = scene;\r\n        if (scope) {\r\n            background = callback.call(scope, items);\r\n        } else {\r\n            background = callback(items);\r\n        }\r\n        items.scene = undefined;\r\n    }\r\n\r\n    return background;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CreateBackground);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/CreateBackground.js?')},"./lib/rexui/lib/ui/menu/CreateButtons.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar CreateButtons = function (scene, items, callback, scope) {\r\n    var item;\r\n    var buttons = [],\r\n        button;\r\n    if (items && callback) {\r\n        for (var i = 0, cnt = items.length; i < cnt; i++) {\r\n            item = items[i];\r\n            item.scene = scene;\r\n            if (scope) {\r\n                button = callback.call(scope, item, i, items);\r\n            } else {\r\n                button = callback(item, i, items);\r\n            }\r\n            item.scene = undefined;\r\n            buttons.push(button);\r\n        }\r\n    }\r\n\r\n    return buttons;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (CreateButtons);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/CreateButtons.js?')},"./lib/rexui/lib/ui/menu/ExpandSubMenu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar ExpandSubMenu = function (parentButton, items) {\r\n    this.collapseSubMenu();\r\n\r\n    var orientation\r\n    if (this.root.toggleOrientation) {\r\n        orientation = (this.orientation === 0) ? 1 : 0;\r\n    } else {\r\n        orientation = this.orientation;\r\n    }\r\n\r\n    var subMenu = new this.constructor(this.scene, {\r\n        items: items,\r\n        orientation: orientation,\r\n\r\n        createBackgroundCallback: this.root.createBackgroundCallback,\r\n        createBackgroundCallbackScope: this.root.createBackgroundCallbackScope,\r\n        createButtonCallback: this.root.createButtonCallback,\r\n        createButtonCallbackScope: this.root.createButtonCallbackScope,\r\n        easeIn: this.root.easeIn,\r\n        easeOut: this.root.easeOut,\r\n\r\n        _rootMenu: this.root,\r\n        _parentMenu: this,\r\n        _parentButton: parentButton\r\n    });\r\n    this.pin(subMenu);\r\n    this.childrenMap.subMenu = subMenu;\r\n    this.root.emit('expand', subMenu, parentButton, this);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ExpandSubMenu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/ExpandSubMenu.js?")},"./lib/rexui/lib/ui/menu/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Menu_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Menu.js */ "./lib/rexui/lib/ui/menu/Menu.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'menu\', function (config) {\r\n    var gameObject = new _Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Menu\', _Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Menu_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/Factory.js?')},"./lib/rexui/lib/ui/menu/GetEaseConfig.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetEaseConfig = function (menu, config) {\r\n    config.orientation = menu.orientation;\r\n    return config;\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetEaseConfig);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/GetEaseConfig.js?')},"./lib/rexui/lib/ui/menu/Menu.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../buttons/Buttons.js */ "./lib/rexui/lib/ui/buttons/Buttons.js");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ "./lib/rexui/lib/ui/menu/Methods.js");\n/* harmony import */ var _CreateBackground_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CreateBackground.js */ "./lib/rexui/lib/ui/menu/CreateBackground.js");\n/* harmony import */ var _CreateButtons_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CreateButtons.js */ "./lib/rexui/lib/ui/menu/CreateButtons.js");\n/* harmony import */ var _plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugins/utils/defaultbounds/GetDefaultBounds.js */ "./lib/rexui/lib/plugins/utils/defaultbounds/GetDefaultBounds.js");\n/* harmony import */ var _MenuSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./MenuSetInteractive.js */ "./lib/rexui/lib/ui/menu/MenuSetInteractive.js");\n/* harmony import */ var _GetEaseConfig_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./GetEaseConfig.js */ "./lib/rexui/lib/ui/menu/GetEaseConfig.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Menu extends _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Orientation\r\n        if (!config.hasOwnProperty(\'orientation\')) {\r\n            config.orientation = 1; // y\r\n        }\r\n\r\n        // Parent\r\n        var rootMenu = config._rootMenu;\r\n        var parentMenu = config._parentMenu;\r\n        var parentButton = config._parentButton;\r\n        // Items\r\n        var items = GetValue(config, \'items\', undefined);\r\n        // Background\r\n        var createBackgroundCallback = GetValue(config, \'createBackgroundCallback\', undefined);\r\n        var createBackgroundCallbackScope = GetValue(config, \'createBackgroundCallbackScope\', undefined);\r\n        config.background = Object(_CreateBackground_js__WEBPACK_IMPORTED_MODULE_2__["default"])(scene, items, createBackgroundCallback, createBackgroundCallbackScope);\r\n        // Buttons\r\n        var createButtonCallback = GetValue(config, \'createButtonCallback\', undefined);\r\n        var createButtonCallbackScope = GetValue(config, \'createButtonCallbackScope\', undefined);\r\n        config.buttons = Object(_CreateButtons_js__WEBPACK_IMPORTED_MODULE_3__["default"])(scene, items, createButtonCallback, createButtonCallbackScope);\r\n\r\n        super(scene, config);\r\n        this.type = \'rexMenu\';\r\n\r\n        this.items = items;        \r\n        this.root = (rootMenu === undefined) ? this : rootMenu;\r\n        this.parentMenu = parentMenu;\r\n        this.parentButton = parentButton;\r\n        var isRootMenu = (this.root === this);\r\n        if (isRootMenu) {\r\n            // Bounds\r\n            var bounds = config.bounds;\r\n            if (bounds === undefined) {\r\n                bounds = Object(_plugins_utils_defaultbounds_GetDefaultBounds_js__WEBPACK_IMPORTED_MODULE_4__["default"])(scene);\r\n            }\r\n            this.bounds = bounds;\r\n\r\n            // Expand mode\r\n            this.expandEventName = GetValue(config, \'expandEvent\', \'button.click\');\r\n            // toggleOrientation mode\r\n            this.toggleOrientation = GetValue(config, \'toggleOrientation\', false);\r\n            // Transition\r\n            this.easeIn = GetValue(config, \'easeIn\', 0);\r\n            if (typeof (this.easeIn) === \'number\') {\r\n                this.easeIn = { duration: this.easeIn };\r\n            }\r\n            this.easeOut = GetValue(config, \'easeOut\', 0);\r\n            if (typeof (this.easeOut) === \'number\') {\r\n                this.easeOut = { duration: this.easeOut };\r\n            }\r\n            // Callbacks\r\n            this.createBackgroundCallback = createBackgroundCallback;\r\n            this.createBackgroundCallbackScope = createBackgroundCallbackScope;\r\n            this.createButtonCallback = createButtonCallback;\r\n            this.createButtonCallbackScope = createButtonCallbackScope;\r\n\r\n            // Event flag\r\n            this._isPassedEvent = false;\r\n        }\r\n        this\r\n            .setOrigin(0)\r\n            .layout();\r\n\r\n        var bounds = this.root.bounds;\r\n        // Align to parentButton\r\n        if (isRootMenu) {\r\n            this.expandOrientation = [\r\n                ((this.y < bounds.centerY) ? 1 : 3), // Expand down(1)/up(3)\r\n                ((this.x < bounds.centerX) ? 0 : 2)  // Expand right(0)/left(2)\r\n            ];\r\n\r\n        } else { // Sub-menu, align to parent button\r\n            var expandOrientation = this.root.expandOrientation[parentMenu.orientation];\r\n            switch (expandOrientation) {\r\n                case 0: //Expand right\r\n                    this.alignTop(parentButton.top).alignLeft(parentButton.right);\r\n                    break;\r\n                case 1: //Expand down\r\n                    this.alignLeft(parentButton.left).alignTop(parentButton.bottom);\r\n                    break;\r\n                case 2: //Expand left\r\n                    this.alignTop(parentButton.top).alignRight(parentButton.left);\r\n                    break;\r\n                case 3: //Expand up\r\n                    this.alignLeft(parentButton.left).alignBottom(parentButton.top);\r\n                    break;\r\n            }\r\n        }\r\n        this.pushIntoBounds(bounds);\r\n\r\n        Object(_MenuSetInteractive_js__WEBPACK_IMPORTED_MODULE_5__["default"])(this);\r\n\r\n        // Ease in menu\r\n        this.popUp(Object(_GetEaseConfig_js__WEBPACK_IMPORTED_MODULE_6__["default"])(this, this.root.easeIn));\r\n    }\r\n\r\n    isInTouching(pointer) {\r\n        if (super.isInTouching(pointer)) {\r\n            return true;\r\n        } else if (this.childrenMap.subMenu) {\r\n            return this.childrenMap.subMenu.isInTouching(pointer);\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Menu.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__["default"]\r\n);\r\n/* harmony default export */ __webpack_exports__["default"] = (Menu);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/Menu.js?')},"./lib/rexui/lib/ui/menu/MenuSetInteractive.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar MenuSetInteractive = function (menu) {\r\n    menu\r\n        // Expand sub event\r\n        .on(menu.root.expandEventName, function (button, index) {\r\n            if (this._isPassedEvent) {\r\n                return;\r\n            }\r\n            var subItems = this.items[index].children;\r\n            if (subItems) {\r\n                this.expandSubMenu(button, subItems);\r\n            } else {\r\n                // this.root.on('button.click', button); // TODO\r\n            }\r\n        }, menu)\r\n        // Click any button\r\n        .on('button.click', function (button, index, pointer, event) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root._isPassedEvent = true;\r\n                this.root.emit('button.click', button, index, pointer, event);\r\n                this.root._isPassedEvent = false;\r\n            }\r\n        }, menu)\r\n        //Pointer over any button\r\n        .on('button.over', function (button, index, pointer, event) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root._isPassedEvent = true;\r\n                this.root.emit('button.over', button, index, pointer, event);\r\n                this.root._isPassedEvent = false;\r\n            }\r\n        }, menu)\r\n        //Pointer out any button\r\n        .on('button.out', function (button, index, pointer, event) {\r\n            // Pass event to root menu object\r\n            if (this !== this.root) {\r\n                this.root._isPassedEvent = true;\r\n                this.root.emit('button.out', button, index, pointer, event);\r\n                this.root._isPassedEvent = false;\r\n            }\r\n        }, menu);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (MenuSetInteractive);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/MenuSetInteractive.js?")},"./lib/rexui/lib/ui/menu/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ExpandSubMenu_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ExpandSubMenu.js */ "./lib/rexui/lib/ui/menu/ExpandSubMenu.js");\n/* harmony import */ var _Collapse_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Collapse.js */ "./lib/rexui/lib/ui/menu/Collapse.js");\n/* harmony import */ var _CollapseSubMenu_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CollapseSubMenu.js */ "./lib/rexui/lib/ui/menu/CollapseSubMenu.js");\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    expandSubMenu: _ExpandSubMenu_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    collapse: _Collapse_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    collapseSubMenu: _CollapseSubMenu_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/menu/Methods.js?')},"./lib/rexui/lib/ui/ninepatch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NinePatch.js */ "./lib/rexui/lib/ui/ninepatch/NinePatch.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'ninePatch\', function (x, y, width, height, key, columns, rows, config) {\r\n    var gameObject = new _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, key, columns, rows, config);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.NinePatch\', _NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ninepatch/Factory.js?')},"./lib/rexui/lib/ui/ninepatch/NinePatch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/ninepatch/NinePatch.js */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_ninepatch_NinePatch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ninepatch/NinePatch.js?')},"./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NineSlicePatch", function() { return NineSlicePatch; });\n/* harmony import */ var _interface_baseUI_Patches_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interface/baseUI/Patches.config */ "./lib/rexui/lib/ui/interface/baseUI/Patches.config.ts");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar NineSlicePatch = /** @class */ (function (_super) {\r\n    __extends(NineSlicePatch, _super);\r\n    function NineSlicePatch(scene, x, y, width, height, key, frame, config, dpr, scale) {\r\n        var _this = _super.call(this, scene, dpr, scale) || this;\r\n        _this.dpr = dpr || 1;\r\n        _this.scale = scale || 1;\r\n        _this.patchesConfig = { top: 0, left: 0, right: 0, bottom: 0 };\r\n        _this.setConfig(config);\r\n        _this.setSize(width, height);\r\n        _this.setTexture(key, frame);\r\n        return _this;\r\n    }\r\n    NineSlicePatch.prototype.resize = function (width, height) {\r\n        width = Math.round(width);\r\n        height = Math.round(height);\r\n        if (!this.patchesConfig) {\r\n            return this;\r\n        }\r\n        if (this.width === width && this.height === height) {\r\n            return this;\r\n        }\r\n        // width = Math.max(width, this.patchesConfig.left + this.patchesConfig.right);\r\n        // height = Math.max(height, this.patchesConfig.top + this.patchesConfig.bottom);\r\n        this.setSize(width, height);\r\n        this.drawPatches();\r\n        return;\r\n    };\r\n    NineSlicePatch.prototype.getConfig = function () {\r\n        return this.patchesConfig;\r\n    };\r\n    NineSlicePatch.prototype.setConfig = function (config) {\r\n        Object.assign(this.patchesConfig, config);\r\n        this.patchesConfig.top = Math.round(this.patchesConfig.top);\r\n        if (this.patchesConfig.right)\r\n            this.patchesConfig.right = Math.round(this.patchesConfig.right);\r\n        if (this.patchesConfig.bottom)\r\n            this.patchesConfig.bottom = Math.round(this.patchesConfig.bottom);\r\n        if (this.patchesConfig.left)\r\n            this.patchesConfig.left = Math.round(this.patchesConfig.left);\r\n        Object(_interface_baseUI_Patches_config__WEBPACK_IMPORTED_MODULE_0__["normalizePatchesConfig"])(config);\r\n    };\r\n    NineSlicePatch.prototype.setTexture = function (key, frame) {\r\n        this.originTexture = this.scene.textures.get(key);\r\n        this.setFrame(frame);\r\n        return this;\r\n    };\r\n    NineSlicePatch.prototype.setFrame = function (frame) {\r\n        this.originFrame = this.originTexture.frames[frame] || this.originTexture.frames[NineSlicePatch.__BASE];\r\n        this.createPatches();\r\n        this.drawPatches();\r\n        return this;\r\n    };\r\n    NineSlicePatch.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        var right = this.width - this.patchesConfig.right > 0 ? this.width - this.patchesConfig.right : this.patchesConfig.right;\r\n        var bottom = this.height - this.patchesConfig.bottom > 0 ? this.height - this.patchesConfig.bottom : this.patchesConfig.right;\r\n        this.finalXs = [0, this.patchesConfig.left, right, this.width];\r\n        this.finalYs = [0, this.patchesConfig.top, bottom, this.height];\r\n        return this;\r\n    };\r\n    NineSlicePatch.prototype.setTint = function (tint) {\r\n        this.tint = tint;\r\n        return this;\r\n    };\r\n    NineSlicePatch.prototype.setTintFill = function (tint) {\r\n        this.tint = tint;\r\n        this.tintFill = true;\r\n        return this;\r\n    };\r\n    Object.defineProperty(NineSlicePatch.prototype, "tintFill", {\r\n        get: function () {\r\n            return this.first && this.first.tintFill;\r\n        },\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.tintFill = value; });\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NineSlicePatch.prototype, "tint", {\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.setTint(value); });\r\n            this.internalTint = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NineSlicePatch.prototype, "isTinted", {\r\n        get: function () {\r\n            return this.first && this.first.isTinted;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NineSlicePatch.prototype.clearTint = function () {\r\n        this.each(function (patch) { return patch.clearTint(); });\r\n        this.internalTint = undefined;\r\n        this.tintFill = false;\r\n    };\r\n    NineSlicePatch.prototype.createPatches = function () {\r\n        // The positions we want from the base texture\r\n        // 保存有x轴和y轴9宫坐标信息，如果存在坐标信息相同，则表示某一部分的图片尺寸为0，需要查看原因\r\n        var textureXs = [0, this.patchesConfig.left, this.originFrame.width - this.patchesConfig.right, this.originFrame.width];\r\n        var textureYs = [0, this.patchesConfig.top, this.originFrame.height - this.patchesConfig.bottom, this.originFrame.height];\r\n        var patchIndex = 0;\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                this.createPatchFrame(this.getPatchNameByIndex(patchIndex), textureXs[xi], // x\r\n                textureYs[yi], // y\r\n                textureXs[xi + 1] - textureXs[xi], // width\r\n                textureYs[yi + 1] - textureYs[yi] // height\r\n                );\r\n                ++patchIndex;\r\n            }\r\n        }\r\n    };\r\n    NineSlicePatch.prototype.drawPatches = function () {\r\n        var tintFill = this.tintFill;\r\n        this.removeAll(true);\r\n        var patchIndex = 0;\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            // 当缩放后的尺寸小于初始尺寸，中间缩放部分肯定为0，则对1，2两行不做处理\r\n            if (this.height < this.patchesConfig.bottom + this.patchesConfig.top && yi === 1) {\r\n                continue;\r\n            }\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                // 当缩放后的尺寸小于初始尺寸，中间缩放部分肯定为0，则对1，2两列不做处理\r\n                if (this.width < this.patchesConfig.left + this.patchesConfig.right && xi === 1) {\r\n                    continue;\r\n                }\r\n                var patch = this.originTexture.frames[this.getPatchNameByIndex(patchIndex)];\r\n                var patchImg = new Phaser.GameObjects.Image(this.scene, 0, 0, patch.texture.key, patch.name);\r\n                patchImg.setOrigin(0);\r\n                patchImg.setPosition((this.finalXs[xi] * 1000 - this.width * this.originX * 1000) / 1000, (this.finalYs[yi] * 1000 - this.height * this.originY * 1000) / 1000);\r\n                // let widScale: number = (this.finalXs[xi + 1] - this.finalXs[xi]) / patch.width;\r\n                // let heiScale: number = (this.finalYs[yi + 1] - this.finalYs[yi]) / patch.height;\r\n                // // 如果缩放后尺寸小于某一部分尺寸，则用当前部分对应计算做缩放，现在处理小于单边尺寸的逻辑是，只用左边和上边做比较处理，当缩放尺寸小于单边尺寸，则只会显示左边和上边的切片资源\r\n                // // 九宫不应该出现缩放尺寸小于单边或者左+右，上+下的情况，以上操作只是为了实现需求\r\n                // if (patch.width > this.width) widScale = this.width / patch.width;\r\n                // if (patch.height > this.height) heiScale = this.height / patch.height;\r\n                // patchImg.setScale(\r\n                //     widScale,\r\n                //     heiScale\r\n                // );\r\n                patchImg.displayWidth = this.finalXs[xi + 1] - this.finalXs[xi];\r\n                patchImg.displayHeight = this.finalYs[yi + 1] - this.finalYs[yi];\r\n                this.add(patchImg);\r\n                if (this.internalTint)\r\n                    patchImg.setTint(this.internalTint);\r\n                patchImg.tintFill = tintFill;\r\n                ++patchIndex;\r\n            }\r\n        }\r\n    };\r\n    NineSlicePatch.prototype.createPatchFrame = function (patch, x, y, width, height) {\r\n        if (this.originTexture.frames.hasOwnProperty(patch)) {\r\n            return;\r\n        }\r\n        this.originTexture.add(patch, this.originFrame.sourceIndex, this.originFrame.cutX + x, this.originFrame.cutY + y, width, height);\r\n    };\r\n    NineSlicePatch.prototype.getPatchNameByIndex = function (index) {\r\n        return this.originFrame.name + "|" + NineSlicePatch.patches[index];\r\n    };\r\n    NineSlicePatch.prototype.calculScale = function (num0, num1) {\r\n        return (num1 * num0) / (2 * num1 * (num1 + num0));\r\n    };\r\n    NineSlicePatch.__BASE = "__BASE";\r\n    NineSlicePatch.patches = ["[0][0]", "[1][0]", "[2][0]", "[0][1]", "[1][1]", "[2][1]", "[0][2]", "[1][2]", "[2][2]"];\r\n    return NineSlicePatch;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts?')},"./lib/rexui/lib/ui/pan/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Pan_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pan.js */ "./lib/rexui/lib/ui/pan/Pan.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/lib/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'pan\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Pan\', _Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/pan/Factory.js?')},"./lib/rexui/lib/ui/pan/Pan.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_pan_Pan_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/pan/Pan.js */ "./lib/rexui/lib/plugins/input/gestures/pan/Pan.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_pan_Pan_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/pan/Pan.js?')},"./lib/rexui/lib/ui/panel/Panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Panel", function() { return Panel; });\n/* harmony import */ var _tool_Tool__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../tool/Tool */ "./lib/rexui/lib/ui/tool/Tool.ts");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Panel = /** @class */ (function (_super) {\r\n    __extends(Panel, _super);\r\n    function Panel(scene, world, music) {\r\n        var _this = _super.call(this, scene, world.dpr, world.uiScaleNew) || this;\r\n        /**\r\n         * 是否正在加载中，加载中的ui不走show流程\r\n         */\r\n        _this.mPreLoad = false;\r\n        _this.mTweening = false;\r\n        _this.mReloadTimes = 0;\r\n        _this.mTweenBoo = true;\r\n        _this.mMute = false;\r\n        _this.mEnabled = true;\r\n        _this.soundMap = new Map();\r\n        _this.scene = scene;\r\n        _this.mWorld = world;\r\n        _this.soundGroup = music;\r\n        _this.mInitialized = false;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    Panel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.removeListen();\r\n        _super.prototype.addListen.call(this);\r\n    };\r\n    Panel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        _super.prototype.removeListen.call(this);\r\n    };\r\n    Panel.prototype.setFollow = function (gameObject, froscene, posFunc) {\r\n        this.mFollow = gameObject;\r\n        this.mFroscene = froscene;\r\n        if (posFunc)\r\n            this.posFunc = posFunc;\r\n    };\r\n    Panel.prototype.isShow = function () {\r\n        return this.mShow;\r\n    };\r\n    Panel.prototype.hide = function () {\r\n        if (this.soundGroup && this.soundGroup.close)\r\n            this.playSound(this.soundGroup.close);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(false);\r\n        }\r\n        else {\r\n            this.destroy();\r\n        }\r\n    };\r\n    Panel.prototype.destroy = function () {\r\n        if (this.mPanelTween) {\r\n            this.mPanelTween.stop();\r\n            this.mPanelTween.remove();\r\n            this.mPanelTween = undefined;\r\n        }\r\n        if (this.mResources) {\r\n            this.mResources.clear();\r\n            this.mResources = undefined;\r\n        }\r\n        this.mMute = false;\r\n        this.mInitialized = false;\r\n        this.mShow = false;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.mReloadTimes = 0;\r\n        this.offLoad();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Panel.prototype.resize = function (wid, hei) {\r\n    };\r\n    Panel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.addListen();\r\n    };\r\n    Panel.prototype.update = function (param) {\r\n        this.mShowData = param;\r\n    };\r\n    Panel.prototype.updateUIState = function (activeUI) {\r\n    };\r\n    Panel.prototype.tweenExpand = function (tweenBoo) {\r\n    };\r\n    Panel.prototype.setTween = function (boo) {\r\n        this.mTweenBoo = boo;\r\n    };\r\n    Object.defineProperty(Panel.prototype, "showData", {\r\n        get: function () {\r\n            return this.mShowData;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Panel.prototype, "interactive", {\r\n        get: function () {\r\n            return this.mEnabled;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Panel.prototype.showTween = function (show) {\r\n        var _this = this;\r\n        this.mTweening = true;\r\n        var scale = show ? this.scale : 0;\r\n        this.scale = scale;\r\n        if (this.mPanelTween) {\r\n            this.mPanelTween.stop();\r\n        }\r\n        this.mPanelTween = this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: scale },\r\n                scaleY: { value: scale },\r\n            },\r\n            onComplete: function () {\r\n                _this.tweenComplete(show);\r\n            },\r\n            onCompleteParams: [this]\r\n        });\r\n    };\r\n    Panel.prototype.tweenComplete = function (show) {\r\n        this.mTweening = false;\r\n        this.mPanelTween.stop();\r\n        this.mShow = show;\r\n        if (!show) {\r\n            this.destroy();\r\n        }\r\n    };\r\n    Panel.prototype.init = function () {\r\n        this.mInitialized = true;\r\n        if (this.mResources) {\r\n            this.mResources.clear();\r\n            this.mResources = null;\r\n        }\r\n        this.show(this.mShowData);\r\n    };\r\n    Panel.prototype.addAtlas = function (key, texture, data) {\r\n        if (!this.mResources) {\r\n            this.mResources = new Map();\r\n        }\r\n        this.mResources.set(key, {\r\n            dpr: this.dpr,\r\n            type: "atlas",\r\n            texture: texture,\r\n            data: data\r\n        });\r\n    };\r\n    Panel.prototype.addImage = function (key, value) {\r\n        if (!this.mResources) {\r\n            this.mResources = new Map();\r\n        }\r\n        if (value === undefined)\r\n            value = key;\r\n        this.mResources.set(key, {\r\n            dpr: this.dpr,\r\n            type: "image",\r\n            texture: value\r\n        });\r\n    };\r\n    Panel.prototype.preload = function () {\r\n        var _this = this;\r\n        this.mPreLoad = true;\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mResources) {\r\n            this.mResources.forEach(function (resource, key) {\r\n                _this.addResources(key, resource);\r\n            }, this);\r\n        }\r\n        this.startLoad();\r\n    };\r\n    Panel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        this.mPreLoad = false;\r\n        if (this.mInitialized) {\r\n            return;\r\n        }\r\n        if (totalFailed > 0 && this.mResources && this.mResources.size > 0) {\r\n            this.reload();\r\n            return;\r\n        }\r\n        this.offLoad();\r\n        this.init();\r\n    };\r\n    Panel.prototype.loadError = function (file) {\r\n        if (!this.mResources) {\r\n            return;\r\n        }\r\n        var resource = this.mResources.get(file.key);\r\n        if (!resource) {\r\n            return;\r\n        }\r\n        resource.dpr = 2;\r\n        if (!this.mReLoadResources) {\r\n            this.mReLoadResources = new Map();\r\n        }\r\n        this.mReLoadResources.set(file.key, resource);\r\n    };\r\n    Panel.prototype.onFileKeyComplete = function (key) {\r\n        if (!this.mResources) {\r\n            return;\r\n        }\r\n        if (this.mResources.has(key)) {\r\n            this.mResources.delete(key);\r\n        }\r\n    };\r\n    Panel.prototype.addResources = function (key, resource) {\r\n        // TODO Add IResource interface\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        // TODO add load type\r\n        // if (resource.data) this.scene.load.atlas(key, Url.getUIRes(resource.dpr, resource.texture), Url.getUIRes(resource.dpr, resource.data));\r\n    };\r\n    Panel.prototype.reload = function () {\r\n        var _this = this;\r\n        if (!this.mReLoadResources || this.mReLoadResources.size <= 0) {\r\n            return;\r\n        }\r\n        if (++this.mReloadTimes > 1) {\r\n            return;\r\n        }\r\n        this.mReLoadResources.forEach(function (resource, key) {\r\n            _this.addResources(key, resource);\r\n        }, this);\r\n        this.startLoad();\r\n    };\r\n    Panel.prototype.startLoad = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE, this.onFileKeyComplete, this);\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.loadComplete, this);\r\n        this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR, this.loadError, this);\r\n        this.scene.load.start();\r\n    };\r\n    Panel.prototype.offLoad = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE, this.onFileKeyComplete, this);\r\n        this.scene.load.off(Phaser.Loader.Events.COMPLETE, this.loadComplete, this);\r\n        this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR, this.loadError, this);\r\n    };\r\n    Panel.prototype.sceneClick = function (pointer) {\r\n        if (_tool_Tool__WEBPACK_IMPORTED_MODULE_0__["Tool"].checkPointerContains(this, pointer) && this.checkPointerDelection(pointer)) {\r\n            this.emit("panelClick", pointer);\r\n        }\r\n    };\r\n    Panel.prototype.uiClick = function (pointer) {\r\n        if (this.checkPointerDelection(pointer)) {\r\n            this.emit("panelClick", pointer);\r\n        }\r\n    };\r\n    return Panel;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/panel/Panel.ts?')},"./lib/rexui/lib/ui/pinch/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Pinch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Pinch.js */ "./lib/rexui/lib/ui/pinch/Pinch.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'pinch\', function (config) {\r\n    return new _Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Pinch\', _Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/pinch/Factory.js?')},"./lib/rexui/lib/ui/pinch/Pinch.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_pinch_Pinch_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/pinch/Pinch.js */ "./lib/rexui/lib/plugins/input/gestures/pinch/Pinch.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_pinch_Pinch_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/pinch/Pinch.js?')},"./lib/rexui/lib/ui/press/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Press.js */ "./lib/rexui/lib/ui/press/Press.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/lib/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'press\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Press_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Press\', _Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/press/Factory.js?')},"./lib/rexui/lib/ui/press/Press.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_press_Press_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/press/Press.js */ "./lib/rexui/lib/plugins/input/gestures/press/Press.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_press_Press_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/press/Press.js?')},"./lib/rexui/lib/ui/progressbar/ProgressBar.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProgressBarEvent", function() { return ProgressBarEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProgressBar", function() { return ProgressBar; });\n/* harmony import */ var _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ninepatch/NineSlicePatch */ "./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ProgressBarEvent;\r\n(function (ProgressBarEvent) {\r\n    ProgressBarEvent["tweenStart"] = "tweenStart";\r\n    ProgressBarEvent["tweenComplete"] = "tweenComplete";\r\n    ProgressBarEvent["tweenUpdate"] = "tweenUpdate";\r\n})(ProgressBarEvent || (ProgressBarEvent = {}));\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar ProgressBar = /** @class */ (function (_super) {\r\n    __extends(ProgressBar, _super);\r\n    function ProgressBar(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mConfig = config;\r\n        var posX = config.x;\r\n        var posY = config.y;\r\n        _this.width = config.width;\r\n        _this.height = config.height;\r\n        _this.setPosition(posX, posY);\r\n        _this.setSize(_this.width, _this.height);\r\n        _this.dpr = GetValue(config, "dpr", 1);\r\n        _this.scale = GetValue(config, "scale", 1);\r\n        var bgSkinData = config.background;\r\n        var barSkinData = config.bar;\r\n        _this.mBgSkin = new _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__["NineSlicePatch"](scene, bgSkinData.x, bgSkinData.y, bgSkinData.width, bgSkinData.height, bgSkinData.key, bgSkinData.frame, bgSkinData.config, _this.dpr, _this.scale);\r\n        _this.mBarSkin = new _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__["NineSlicePatch"](scene, barSkinData.x, barSkinData.y, barSkinData.width, barSkinData.height, barSkinData.key, barSkinData.frame, barSkinData.config, _this.dpr, _this.scale);\r\n        // 按钮文本\r\n        var textconfig = {};\r\n        _this.mText = scene.make.text({\r\n            style: Object.assign(textconfig, config.textConfig)\r\n        }, false);\r\n        _this.barWid = barSkinData.width;\r\n        var hei = _this.mBarSkin.height;\r\n        _this.mBarMaskGraphics = _this.scene.make.graphics(undefined, false);\r\n        _this.mBarMaskGraphics.fillStyle(0, 1);\r\n        _this.mBarMaskGraphics.beginPath();\r\n        _this.mBarMaskGraphics.fillRect(0, 0, 10, hei);\r\n        _this.mBarMaskGraphics.setPosition(-_this.barWid / 2, -hei / 2);\r\n        // this.mBarSkin.mask = this.mBarMaskGraphics.createGeometryMask();\r\n        _this.add([_this.mBgSkin, _this.mBarSkin, _this.mText]);\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    ProgressBar.prototype.setProgress = function (curVal, maxVal) {\r\n        this.curWid = (curVal / maxVal) * this.barWid;\r\n        var hei = this.mBarSkin.height;\r\n        this.mBarSkin.resize(this.curWid, hei);\r\n        this.mBarSkin.x = -this.barWid / 2 + this.curWid / 2;\r\n        // this.mBarMaskGraphics.clear();\r\n        // this.mBarMaskGraphics.fillRect(0, 0, this.curWid, hei);\r\n        // this.mBarMaskGraphics.setPosition(-this.barWid / 2, -hei / 2);\r\n        // if (this.mTween) {\r\n        //     this.mTween.stop();\r\n        //     this.mTween.remove();\r\n        // }\r\n        // this.mTween = this.scene.tweens.add({\r\n        //     targets: this.mBarMaskGraphics,\r\n        //     duration: 1000,\r\n        //     ease: "Linear",\r\n        //     scaleX: { value: curVal / maxVal },\r\n        //     onStart: () => {\r\n        //         this.onTweenStart();\r\n        //     },\r\n        //     onComplete: (tween, targets, element) => {\r\n        //         this.onTweenComplete();\r\n        //     },\r\n        //     onUpdate: (tween, targets, element) => {\r\n        //         this.onTweenUpdate();\r\n        //     },\r\n        //     onCompleteParams: [this]\r\n        // });\r\n    };\r\n    ProgressBar.prototype.setText = function (val) {\r\n        if (this.mText) {\r\n            this.mText.text = val;\r\n            if (!this.mText.parentContainer)\r\n                this.add(this.mText);\r\n        }\r\n    };\r\n    ProgressBar.prototype.destory = function () {\r\n        // if (this.mTween) {\r\n        //     this.mTween.stop();\r\n        //     this.mTween.remove();\r\n        //     this.mTween = null;\r\n        // }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return ProgressBar;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/progressbar/ProgressBar.ts?')},"./lib/rexui/lib/ui/rotate/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Rotate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Rotate.js */ "./lib/rexui/lib/ui/rotate/Rotate.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'rotate\', function (config) {\r\n    return new _Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Rotate\', _Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/rotate/Factory.js?')},"./lib/rexui/lib/ui/rotate/Rotate.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/rotate/Rotate.js */ "./lib/rexui/lib/plugins/input/gestures/rotate/Rotate.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/rotate/Rotate.js?')},"./lib/rexui/lib/ui/roundrectangle/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RoundRectangle.js */ "./lib/rexui/lib/ui/roundrectangle/RoundRectangle.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'roundRectangle\', function (x, y, width, height, radiusConfig, fillColor, fillAlpha) {\r\n    var gameObject = new _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, width, height, radiusConfig, fillColor, fillAlpha);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.RoundRectangle\', _RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/roundrectangle/Factory.js?')},"./lib/rexui/lib/ui/roundrectangle/RoundRectangle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_shape_roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/shape/roundrectangle/RoundRectangle.js */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_shape_roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/roundrectangle/RoundRectangle.js?')},"./lib/rexui/lib/ui/scrollableblock/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollableBlock.js */ "./lib/rexui/lib/ui/scrollableblock/ScrollableBlock.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'scrollableBlock\', function (config) {\r\n    var gameObject = new _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.ScrollableBlock\', _ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/Factory.js?')},"./lib/rexui/lib/ui/scrollableblock/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenHeight = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    var child = this.child,\r\n        childConfig = child.rexSizer;\r\n    if (childConfig.hidden) {\r\n        result = 0;\r\n    } else if (this.scrollMode === 0) { // scroll y   \r\n        result = 0;\r\n    } else { // scroll x\r\n        result = (child.isRexSizer) ?\r\n            Math.max(child.minHeight, child.childrenHeight) :\r\n            Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(child);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/GetChildrenHeight.js?')},"./lib/rexui/lib/ui/scrollableblock/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenWidth = function () {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    var result;\r\n    var child = this.child,\r\n        childConfig = child.rexSizer;\r\n    if (childConfig.hidden) {\r\n        result = 0;\r\n    } else if (this.scrollMode === 0) { // scroll y\r\n        result = (child.isRexSizer) ?\r\n            Math.max(child.minWidth, child.childrenWidth) :\r\n            Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(child);\r\n    } else { // scroll x\r\n        result = 0;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/GetChildrenWidth.js?')},"./lib/rexui/lib/ui/scrollableblock/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/utils/mask/MaskToGameObject.js */ "./lib/rexui/lib/plugins/utils/mask/MaskToGameObject.js");\n\r\n\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.preLayout(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout child\r\n    var child = this.child;\r\n    var childWidth, childHeight;\r\n    if (!child.rexSizer.hidden) {\r\n        // Set size\r\n        if (this.scrollMode === 0) {\r\n            childWidth = this.width;\r\n        } else {\r\n            childHeight = this.height;\r\n        }\r\n        if (child.isRexSizer) {\r\n            child.layout(this, childWidth, childHeight);\r\n        } else {\r\n            Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(child, childWidth, childHeight);\r\n        }\r\n\r\n        this.resetChildPosition();\r\n\r\n        // Layout child mask\r\n        if (this.childMask) {\r\n            var maskGameObject = Object(_plugins_utils_mask_MaskToGameObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this.childMask);\r\n            maskGameObject.setPosition().resize();\r\n            this.resetChildPositionState(maskGameObject);\r\n        }\r\n    }\r\n\r\n    return this.postLayout();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/Layout.js?')},"./lib/rexui/lib/ui/scrollableblock/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetChild_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetChild.js */ "./lib/rexui/lib/ui/scrollableblock/SetChild.js");\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/lib/ui/scrollableblock/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/lib/ui/scrollableblock/GetChildrenHeight.js");\n/* harmony import */ var _ResetChildPosition_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ResetChildPosition.js */ "./lib/rexui/lib/ui/scrollableblock/ResetChildPosition.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/lib/ui/scrollableblock/Layout.js");\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setChild: _SetChild_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    resetChildPosition: _ResetChildPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/Methods.js?')},"./lib/rexui/lib/ui/scrollableblock/ResetChildPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/containerlite/MaskChildren.js */ "./lib/rexui/lib/plugins/gameobjects/containerlite/MaskChildren.js");\n\r\n\r\nvar ResetChildPosition = function () {\r\n    var x = this.left;\r\n    var y = this.top;\r\n    if (this.scrollMode === 0) {\r\n        y += this.childOY;\r\n    } else {\r\n        x += this.childOY;\r\n    }\r\n    this.child.setPosition(x, y);\r\n    Object(_plugins_gameobjects_containerlite_MaskChildren_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, this.childMask, this.child.getAllChildren());\r\n    this.resetChildPositionState(this.child);\r\n};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResetChildPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/ResetChildPosition.js?')},"./lib/rexui/lib/ui/scrollableblock/ScrollableBlock.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/lib/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/lib/ui/scrollableblock/Methods.js\");\n/* harmony import */ var _utils_ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/ScrollModeConst.js */ \"./lib/rexui/lib/ui/utils/ScrollModeConst.js\");\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ \"./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js\");\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ScrollableBlock extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexScrollableBlock';\r\n        this.child = undefined;\r\n        this.childMask = undefined;\r\n        this._childOY = 0;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n\r\n        this.setScrollMode(GetValue(config, 'scrollMode', true))\r\n        this.setClampMode(GetValue(config, 'clamplChildOY', true));\r\n\r\n        // Add elements\r\n        // No background object, and child does not have padding\r\n        var child = GetValue(config, 'child', undefined);\r\n        var expand = GetValue(config, 'expand', true);\r\n        var childMask = GetValue(config, 'mask', undefined);\r\n\r\n        this.setChild(child, expand, childMask);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.child = undefined;\r\n        if (this.childMask) {\r\n            this.childMask.destroy();\r\n            this.childMask = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setScrollMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = _utils_ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"][mode.toLowerCase()];\r\n        }\r\n        this.scrollMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampChildOYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get instHeight() {\r\n        return (this.scrollMode === 0) ? this.height : this.width;\r\n    }\r\n\r\n    get instWidth() {\r\n        return (this.scrollMode === 0) ? this.width : this.height;\r\n    }\r\n\r\n    get childHeight() {\r\n        return (this.scrollMode === 0) ? Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_3__[\"GetDisplayHeight\"])(this.child) : Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_3__[\"GetDisplayWidth\"])(this.child);\r\n    }\r\n\r\n    get childWidth() {\r\n        return (this.scrollMode === 0) ? Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_3__[\"GetDisplayWidth\"])(this.child) : Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_3__[\"GetDisplayHeight\"])(this.child);\r\n    }\r\n\r\n    get topChildOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomChildOY() {\r\n        return -this.visibleHeight;\r\n    }\r\n\r\n    get visibleHeight() {\r\n        var h;\r\n        var childHeight = this.childHeight;\r\n        var instHeight = this.instHeight;\r\n        if (childHeight > instHeight) {\r\n            h = childHeight - instHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    childOYExceedTop(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.childOY;\r\n        }\r\n        return (oy > this.topChildOY);\r\n    }\r\n\r\n    childOYExeceedBottom(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.childOY;\r\n        }\r\n        return (oy < this.bottomChildOY);\r\n    }\r\n\r\n    get childOY() {\r\n        return this._childOY;\r\n    }\r\n\r\n    set childOY(oy) {\r\n        var topChildOY = this.topChildOY;\r\n        var bottomChildOY = this.bottomChildOY;\r\n        var childOYExceedTop = this.childOYExceedTop(oy);\r\n        var childOYExeceedBottom = this.childOYExeceedBottom(oy);\r\n\r\n        if (this.clampChildOYMode) {\r\n            if (this.instHeight > this.childHeight) {\r\n                oy = 0;\r\n            } else if (childOYExceedTop) {\r\n                oy = topChildOY\r\n            } else if (childOYExeceedBottom) {\r\n                oy = bottomChildOY;\r\n            }\r\n        }\r\n\r\n        if (this._childOY !== oy) {\r\n            this._childOY = oy;\r\n            this.resetChildPosition();\r\n        }\r\n\r\n        if (childOYExceedTop) {\r\n            if (!this.execeedTopState) {\r\n                this.emit('execeedtop', this, oy, topChildOY);\r\n            }\r\n        }\r\n        this.execeedTopState = childOYExceedTop;\r\n\r\n        if (childOYExeceedBottom) {\r\n            if (!this.execeedBottomState) {\r\n                this.emit('execeedbottom', this, oy, bottomChildOY);\r\n            }\r\n        }\r\n        this.execeedBottomState = childOYExeceedBottom;\r\n    }\r\n\r\n    setChildOY(oy) {\r\n        this.childOY = oy;\r\n        return this;\r\n    }\r\n\r\n    set t(value) {\r\n        this.childOY = -this.visibleHeight * value;\r\n    }\r\n\r\n    get t() {\r\n        var visibleHeight = this.visibleHeight;\r\n        if (visibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.childOY / -visibleHeight);\r\n    }\r\n\r\n    setChildOYByPercentage(percentage) {\r\n        this.t = percentage;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    ScrollableBlock.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ScrollableBlock);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/ScrollableBlock.js?")},"./lib/rexui/lib/ui/scrollableblock/SetChild.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/mask/DefaultMask.js */ "./lib/rexui/lib/plugins/utils/mask/DefaultMask.js");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst ALIGN_LEFTTOP = Phaser.Display.Align.TOP_LEFT;\r\n\r\nvar SetChild = function (gameObject, expand, maskConfig) {\r\n    if (gameObject.setOrigin) {\r\n        gameObject.setOrigin(0);\r\n    }\r\n\r\n    this.add(gameObject);\r\n\r\n    var config = this.getSizerConfig(gameObject);\r\n    config.parent = this;\r\n    config.align = ALIGN_LEFTTOP;\r\n    config.expand = expand;\r\n    this.child = gameObject;\r\n\r\n    // Create mask of child object\r\n    var maskEnable, maskPadding;\r\n    if (maskConfig === true) {\r\n        maskEnable = true;\r\n        maskPadding = 0;\r\n    } else if (maskConfig === false) {\r\n        maskEnable = false;\r\n    } else {\r\n        maskEnable = GetValue(maskConfig, \'mask\', true);\r\n        maskPadding = GetValue(maskConfig, \'padding\', 0);\r\n    }\r\n\r\n    if (maskEnable) {\r\n        var maskGameObject = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, maskPadding);\r\n        this.childMask = maskGameObject.createGeometryMask();\r\n        this.pin(maskGameObject);\r\n    }\r\n\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollableblock/SetChild.js?')},"./lib/rexui/lib/ui/scrollablepanel/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollablePanel.js */ "./lib/rexui/lib/ui/scrollablepanel/ScrollablePanel.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'scrollablePanel\', function (config) {\r\n    var gameObject = new _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.ScrollablePanel\', _ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollablepanel/Factory.js?')},"./lib/rexui/lib/ui/scrollablepanel/ScrollablePanel.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ \"./lib/rexui/lib/ui/utils/scrollable/Scrollable.js\");\n/* harmony import */ var _utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/GetScrollMode.js */ \"./lib/rexui/lib/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../scrollableblock/ScrollableBlock.js */ \"./lib/rexui/lib/ui/scrollableblock/ScrollableBlock.js\");\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass ScrollablePanel extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create scrollable-block\r\n        var scrollMode = Object(_utils_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config);\r\n        var panelConfig = GetValue(config, 'panel', undefined);\r\n        if (panelConfig === undefined) {\r\n            panelConfig = {};\r\n        }\r\n        panelConfig.scrollMode = scrollMode;\r\n        panelConfig.clamplChildOY = GetValue(config, 'clamplChildOY', false);\r\n        var scrollableBlock = new _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](scene, panelConfig);\r\n        var panelWidth = GetValue(panelConfig, 'width', undefined);\r\n        var panelHeight = GetValue(panelConfig, 'height', undefined);\r\n        var proportion, expand;\r\n        if (scrollMode === 0) {\r\n            proportion = (panelWidth === undefined) ? 1 : 0;\r\n            expand = (panelHeight === undefined);\r\n        } else {\r\n            proportion = (panelHeight === undefined) ? 1 : 0;\r\n            expand = (panelWidth === undefined);\r\n        }\r\n\r\n        // Fill config of scrollable\r\n        config.type = 'rexScrollablePanel';\r\n        config.child = {\r\n            gameObject: scrollableBlock,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, 'space', undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.panel;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap('panel', this.childrenMap.child.child);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (ScrollablePanel);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scrollablepanel/ScrollablePanel.js?")},"./lib/rexui/lib/ui/scroller/GameScroller.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScrollerEvent", function() { return ScrollerEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameScroller", function() { return GameScroller; });\n/* harmony import */ var _plugins_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/scroller/Scroller.js */ "./lib/rexui/lib/plugins/input/scroller/Scroller.js");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ScrollerEvent;\r\n(function (ScrollerEvent) {\r\n    ScrollerEvent["downinBound"] = "downinBound";\r\n    ScrollerEvent["downoutBound"] = "downoutBound";\r\n    ScrollerEvent["upinBound"] = "upinBound";\r\n    ScrollerEvent["upoutBound"] = "upoutBound";\r\n})(ScrollerEvent || (ScrollerEvent = {}));\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar GameScroller = /** @class */ (function (_super) {\r\n    __extends(GameScroller, _super);\r\n    function GameScroller(scene, config, gameObject) {\r\n        var _this = _super.call(this, scene) || this;\r\n        /**\r\n         * 是否在移动中\r\n         */\r\n        _this.mMoveing = false;\r\n        _this.soundMap = new Map();\r\n        _this.mConfig = config;\r\n        _this.soundGroup = config.music;\r\n        _this.x = config.x;\r\n        _this.y = config.y;\r\n        _this.width = _this.mConfig.width;\r\n        _this.height = _this.mConfig.height;\r\n        var zoom = config.zoom;\r\n        _this.maskGraphic = scene.make.graphics(undefined, false);\r\n        _this.maskGraphic.fillStyle(0);\r\n        _this.maskGraphic.fillRect(-_this.width * 0.5 * zoom, -_this.height * 0.5 * zoom, _this.width * zoom, _this.height * zoom);\r\n        var worldpos = _this.getWorldTransformMatrix();\r\n        _this.maskGraphic.setPosition(worldpos.tx, worldpos.ty);\r\n        // this.add(this.maskGraphic);\r\n        if (gameObject) {\r\n            _this.mGameObject = gameObject;\r\n        }\r\n        else {\r\n            _this.mGameObject = scene.make.container(undefined, false);\r\n            _this.add(_this.mGameObject);\r\n        }\r\n        _this.mGameObject.setMask(_this.maskGraphic.createGeometryMask());\r\n        // const bg1 = scene.make.graphics(undefined, false);\r\n        // bg1.fillStyle(0, .2);\r\n        // bg1.fillRect(0, 0, config.width, config.height);\r\n        // bg1.setPosition(-config.width / 2, -config.height / 2);\r\n        // this.add(bg1);\r\n        if (!config.valuechangeCallback)\r\n            config.valuechangeCallback = function (value) {\r\n                _this.onScrollValueChange(value);\r\n            };\r\n        _this.mScroller = new _plugins_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__["default"](_this, config);\r\n        _this.mDisDelection = GetValue(config, "interactivedisDetection", 10);\r\n        _this.mCellDownHandler = GetValue(config, "celldownCallBack", undefined);\r\n        _this.mCellUpHandler = GetValue(config, "cellupCallBack", undefined);\r\n        _this.setInteractive();\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(GameScroller.prototype, "view", {\r\n        get: function () {\r\n            return this.mGameObject;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GameScroller.prototype.setEnable = function (enable) {\r\n        if (this.mScroller)\r\n            this.mScroller.setEnable(enable);\r\n    };\r\n    GameScroller.prototype.setValue = function (value) {\r\n        if (this.mScroller)\r\n            this.mScroller.setValue(value);\r\n    };\r\n    GameScroller.prototype.getValue = function () {\r\n        return this.mScroller.value;\r\n    };\r\n    GameScroller.prototype.adjustBackDeceleration = function (deceler) {\r\n        if (this.mScroller)\r\n            this.mScroller.setBackDeceleration(deceler);\r\n    };\r\n    GameScroller.prototype.adjustSlidingDeceleration = function (deceler) {\r\n        if (this.mScroller)\r\n            this.mScroller.setSlidingDeceleration(deceler);\r\n    };\r\n    GameScroller.prototype.adjustScrollMode = function (mode) {\r\n        if (!this.mConfig.orientation || this.mConfig.orientation !== mode) {\r\n            if (this.mScroller)\r\n                this.mScroller.setOrientationMode(mode);\r\n        }\r\n        this.mConfig.orientation = mode;\r\n    };\r\n    GameScroller.prototype.adjustDragThreshol = function (hold) {\r\n        if (this.mScroller)\r\n            this.mScroller.setDragThreshold(hold);\r\n    };\r\n    GameScroller.prototype.updateScrollPos = function (pos) {\r\n        if (this.mConfig.orientation) {\r\n            this.mGameObject.x = pos;\r\n        }\r\n        else {\r\n            this.mGameObject.y = pos;\r\n        }\r\n    };\r\n    GameScroller.prototype.refreshMask = function () {\r\n        var worldpos = this.getWorldTransformMatrix();\r\n        this.maskGraphic.setPosition(worldpos.tx, worldpos.ty);\r\n    };\r\n    /***\r\n    *  调整scroller遮照范围\r\n    * @param width\r\n    * @param height\r\n    * @param x\r\n    * @param y\r\n    */\r\n    GameScroller.prototype.adjustMask = function (width, height, x, y) {\r\n        if (x === void 0) { x = this.mConfig.x; }\r\n        if (y === void 0) { y = this.mConfig.y; }\r\n        this.mGameObject.clearMask();\r\n        var mask = this.scene.make.graphics(undefined, false);\r\n        mask.fillStyle(0);\r\n        mask.fillRect(0, 0, width, height);\r\n        mask.setPosition(x, y);\r\n        this.mGameObject.setMask(mask.createGeometryMask());\r\n    };\r\n    GameScroller.prototype.addItem = function (item) {\r\n        this.mGameObject.add(item);\r\n        this.setInteractiveObject(item);\r\n    };\r\n    GameScroller.prototype.addItemAt = function (item, index) {\r\n        this.mGameObject.addAt(item, index);\r\n        // this.setInteractiveObject(item);\r\n    };\r\n    GameScroller.prototype.getItemList = function () {\r\n        return this.mGameObject.list;\r\n    };\r\n    GameScroller.prototype.setBounds = function (value0, value1) {\r\n        this.mScroller.setBounds(value0, value1);\r\n    };\r\n    /**\r\n     *\r\n     * @param align 2 居左 1居中 0居右 默认居左\r\n     */\r\n    GameScroller.prototype.setAlign = function (align) {\r\n        if (align === void 0) { align = 2; }\r\n        this.mConfig.align = align;\r\n        this.Sort();\r\n    };\r\n    GameScroller.prototype.Sort = function (isFixed) {\r\n        if (isFixed === void 0) { isFixed = false; }\r\n        var value = 0;\r\n        var offset = (isFixed ? this.getScrollBound() : 0);\r\n        var space = (this.mConfig.space === undefined ? 0 : this.mConfig.space);\r\n        var list = this.mGameObject.list;\r\n        var activeArr = [];\r\n        for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {\r\n            var item = list_1[_i];\r\n            if (item.visible) {\r\n                activeArr.push(item);\r\n            }\r\n        }\r\n        for (var _a = 0, activeArr_1 = activeArr; _a < activeArr_1.length; _a++) {\r\n            var item = activeArr_1[_a];\r\n            if (this.mConfig.orientation === 1) {\r\n                item.x = item.width * item.originX + value;\r\n                value += item.width + space;\r\n            }\r\n            else {\r\n                item.y = item.height * item.originY + value;\r\n                value += item.height + space;\r\n            }\r\n        }\r\n        value -= space;\r\n        if (this.mConfig.orientation === 1) {\r\n            this.mGameObject.width = value;\r\n            for (var _b = 0, activeArr_2 = activeArr; _b < activeArr_2.length; _b++) {\r\n                var item = activeArr_2[_b];\r\n                item.x -= value * 0.5;\r\n            }\r\n            value -= this.width;\r\n        }\r\n        else {\r\n            this.mGameObject.height = value;\r\n            for (var _c = 0, activeArr_3 = activeArr; _c < activeArr_3.length; _c++) {\r\n                var item = activeArr_3[_c];\r\n                item.y -= value * 0.5;\r\n            }\r\n            value -= this.height;\r\n        }\r\n        var leftBound = 0, rightBound = 0, bound = 0;\r\n        if (value < 0) {\r\n            if (this.mConfig.align === 0) {\r\n                leftBound = rightBound = -value / 2;\r\n            }\r\n            else if (this.mConfig.align === 1) {\r\n                leftBound = rightBound = 0;\r\n            }\r\n            else {\r\n                leftBound = rightBound = value / 2;\r\n            }\r\n            bound = leftBound;\r\n        }\r\n        else {\r\n            leftBound = -value / 2;\r\n            rightBound = value / 2;\r\n            if (this.mConfig.align === 0) {\r\n                bound = leftBound;\r\n            }\r\n            else if (this.mConfig.align === 1) {\r\n                bound = 0;\r\n            }\r\n            else {\r\n                bound = rightBound;\r\n            }\r\n        }\r\n        this.mLeftBound = leftBound;\r\n        this.mRightBound = rightBound;\r\n        var value0 = bound;\r\n        if (isFixed) {\r\n            value0 += offset;\r\n            if (value0 < leftBound)\r\n                value0 = leftBound;\r\n            if (value0 > rightBound)\r\n                value0 = rightBound;\r\n        }\r\n        this.setBounds(leftBound, rightBound);\r\n        this.setValue(value0);\r\n    };\r\n    GameScroller.prototype.getScrollBound = function () {\r\n        var scrollValue = 0;\r\n        var contentValue = 0;\r\n        var bound = 0;\r\n        if (this.mConfig.orientation === 1) {\r\n            scrollValue = this.width;\r\n            contentValue = this.mGameObject.width;\r\n        }\r\n        else {\r\n            scrollValue = this.height;\r\n            contentValue = this.mGameObject.height;\r\n        }\r\n        bound = contentValue - scrollValue;\r\n        if (bound < 0) {\r\n            if (this.mConfig.align === 0) {\r\n                bound = -bound / 2;\r\n            }\r\n            else if (this.mConfig.align === 1) {\r\n                bound = 0;\r\n            }\r\n            else {\r\n                bound = bound / 2;\r\n            }\r\n        }\r\n        else {\r\n            if (this.mConfig.align === 0) {\r\n                bound = -bound / 2;\r\n            }\r\n            else if (this.mConfig.align === 1) {\r\n                bound = 0;\r\n            }\r\n            else {\r\n                bound = bound / 2;\r\n            }\r\n        }\r\n        var offset = 0;\r\n        if (this.mConfig.orientation === 1) {\r\n            offset = this.mGameObject.x - bound;\r\n        }\r\n        else {\r\n            offset = this.mGameObject.y - bound;\r\n        }\r\n        return offset;\r\n    };\r\n    GameScroller.prototype.clearItems = function () {\r\n        var list = this.mGameObject.list;\r\n        for (var _i = 0, list_2 = list; _i < list_2.length; _i++) {\r\n            var item = list_2[_i];\r\n            item.destroy();\r\n        }\r\n        this.mGameObject.list.length = 0;\r\n        this.clearInteractiveObject();\r\n    };\r\n    Object.defineProperty(GameScroller.prototype, "bounds", {\r\n        get: function () {\r\n            return [this.mLeftBound, this.mRightBound];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GameScroller.prototype.removeInteractiveObject = function (obj) {\r\n        var index = this.mInteractiveList.indexOf(obj);\r\n        if (index > -1) {\r\n            this.mInteractiveList.splice(index, 1);\r\n        }\r\n    };\r\n    GameScroller.prototype.addListen = function () {\r\n        if (!this.scene)\r\n            return;\r\n        this.removeListen();\r\n        this.scene.input.on("pointermove", this.pointerMoveHandler, this);\r\n        this.scene.input.on("pointerdown", this.pointerDownHandler, this);\r\n        this.scene.input.on("pointerup", this.pointerUpHandler, this);\r\n    };\r\n    GameScroller.prototype.removeListen = function () {\r\n        this.mMoveing = false;\r\n        if (!this.scene)\r\n            return;\r\n        this.scene.input.off("pointerdown", this.pointerDownHandler, this);\r\n        this.scene.input.off("pointerup", this.pointerUpHandler, this);\r\n        this.scene.input.off("pointermove", this.pointerMoveHandler, this);\r\n    };\r\n    Object.defineProperty(GameScroller.prototype, "left", {\r\n        get: function () {\r\n            return -this.mGameObject.width / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameScroller.prototype, "right", {\r\n        get: function () {\r\n            return this.mGameObject.width / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameScroller.prototype, "top", {\r\n        get: function () {\r\n            return -this.mGameObject.height / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameScroller.prototype, "bottom", {\r\n        get: function () {\r\n            return this.mGameObject.height / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GameScroller.prototype.setInteractiveObject = function (obj) {\r\n        if (!this.mInteractiveList)\r\n            this.mInteractiveList = [];\r\n        this.mInteractiveList.push(obj);\r\n    };\r\n    GameScroller.prototype.destroy = function () {\r\n        this.mMoveing = false;\r\n        if (this.mGameObject)\r\n            this.mGameObject.clearMask(true);\r\n        if (this.mScroller)\r\n            this.mScroller.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    // public refreshBound(refreshSize?: number) {\r\n    //     if (!this.mInteractiveList) return;\r\n    //     // 滚动容器尺寸\r\n    //     let totalSize: number = 0;\r\n    //     if (refreshSize !== undefined) {\r\n    //         totalSize = refreshSize;\r\n    //     } else {\r\n    //         this.mInteractiveList.forEach((cell) => {\r\n    //             if (cell) {\r\n    //                 totalSize += this.mConfig.orientation ? cell.width : cell.height;\r\n    //             }\r\n    //         });\r\n    //     }\r\n    //     // // 滚动容器尺寸\r\n    //     // const tmpSize: number = this.mConfig.orientation ? this.mGameObject.width : this.mGameObject.height;\r\n    //     // 父容器初始位置\r\n    //     const baseSize: number = this.mConfig.orientation ? this.mGameObject.parentContainer.x : this.mGameObject.parentContainer.y;\r\n    //     // 视口范围尺寸（滚动不能小于改尺寸）\r\n    //     const baseShowSize: number = this.mConfig.orientation ? this.mConfig.width : this.mConfig.height;\r\n    //     if (totalSize < baseShowSize) totalSize = baseShowSize;\r\n    //     this.setBounds(baseSize, baseSize - totalSize + baseShowSize);\r\n    // }\r\n    GameScroller.prototype.clearInteractiveObject = function () {\r\n        if (!this.mInteractiveList)\r\n            return;\r\n        this.mInteractiveList.length = 0;\r\n        this.mInteractiveList = [];\r\n        this.mScroller.setBounds(0, 0);\r\n    };\r\n    GameScroller.prototype.pointerMoveHandler = function (pointer) {\r\n        if (this.soundGroup && this.soundGroup.move)\r\n            this.playSound(this.soundGroup.move);\r\n        this.mMoveing = true;\r\n    };\r\n    GameScroller.prototype.pointerDownHandler = function (pointer) {\r\n        // this.scene.input.off("pointermove", this.pointerMoveHandler, this);\r\n        if (this.soundGroup && this.soundGroup.down)\r\n            this.playSound(this.soundGroup.down);\r\n        var inBound = this.checkPointerInBounds(this, pointer);\r\n        if (inBound && this.checkPointerDelection(pointer)) {\r\n            if (this.mCellDownHandler && !this.mMoveing) {\r\n                if (!this.mInteractiveList)\r\n                    return;\r\n                for (var i = 0, len = this.mInteractiveList.length; i < len; i++) {\r\n                    var interactiveObj = this.mInteractiveList[i];\r\n                    if (this.checkPointerInBounds(interactiveObj, pointer, true)) {\r\n                        this.mCellDownHandler(interactiveObj);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            var eventName = inBound ? ScrollerEvent.downinBound : ScrollerEvent.downoutBound;\r\n            this.emit(eventName, this);\r\n        }\r\n    };\r\n    GameScroller.prototype.pointerUpHandler = function (pointer, gameObject) {\r\n        // this.scene.input.on("pointermove", this.pointerMoveHandler, this);\r\n        if (this.soundGroup && this.soundGroup.up)\r\n            this.playSound(this.soundGroup.up);\r\n        var inBound = this.checkPointerInBounds(this, pointer);\r\n        if (inBound && this.checkPointerDelection(pointer)) {\r\n            if (this.mCellUpHandler && !this.mMoveing) {\r\n                if (!this.mInteractiveList)\r\n                    return;\r\n                for (var i = 0, len = this.mInteractiveList.length; i < len; i++) {\r\n                    var interactiveObj = this.mInteractiveList[i];\r\n                    if (this.checkPointerInBounds(interactiveObj, pointer, true)) {\r\n                        this.mCellUpHandler(interactiveObj);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            var eventName = inBound ? ScrollerEvent.upinBound : ScrollerEvent.upoutBound;\r\n            this.emit(eventName, this);\r\n        }\r\n        this.mMoveing = false;\r\n    };\r\n    GameScroller.prototype.checkPointerInBounds = function (gameObject, pointer, isCell) {\r\n        if (isCell === void 0) { isCell = false; }\r\n        if (!this.mRectangle) {\r\n            this.mRectangle = new Phaser.Geom.Rectangle(0, 0, 0, 0);\r\n        }\r\n        this.mRectangle.left = -gameObject.width / 2;\r\n        this.mRectangle.right = gameObject.width / 2;\r\n        this.mRectangle.top = -gameObject.height / 2;\r\n        this.mRectangle.bottom = gameObject.height / 2;\r\n        if (pointer) {\r\n            var worldMatrix = gameObject.getWorldTransformMatrix();\r\n            var x = pointer.x - worldMatrix.tx;\r\n            var y = pointer.y - worldMatrix.ty;\r\n            if (this.mRectangle.left <= x && this.mRectangle.right >= x && this.mRectangle.top <= y && this.mRectangle.bottom >= y) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    };\r\n    GameScroller.prototype.onScrollValueChange = function (value) {\r\n        if (this.mConfig.orientation === 1) {\r\n            this.mGameObject.x = value;\r\n        }\r\n        else {\r\n            this.mGameObject.y = value;\r\n        }\r\n    };\r\n    return GameScroller;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scroller/GameScroller.ts?')},"./lib/rexui/lib/ui/scroller/Scroller.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseScrollerEvent", function() { return BaseScrollerEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseScroller", function() { return BaseScroller; });\n/* harmony import */ var _plugins_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/scroller/Scroller.js */ "./lib/rexui/lib/plugins/input/scroller/Scroller.js");\n/* harmony import */ var _baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar BaseScrollerEvent;\r\n(function (BaseScrollerEvent) {\r\n    BaseScrollerEvent["downinBound"] = "downinBound";\r\n    BaseScrollerEvent["downoutBound"] = "downoutBound";\r\n    BaseScrollerEvent["upinBound"] = "upinBound";\r\n    BaseScrollerEvent["upoutBound"] = "upoutBound";\r\n})(BaseScrollerEvent || (BaseScrollerEvent = {}));\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar BaseScroller = /** @class */ (function (_super) {\r\n    __extends(BaseScroller, _super);\r\n    function BaseScroller(scene, gameObject, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mChildPad = 0;\r\n        _this.mMoveing = false;\r\n        _this.soundMap = new Map();\r\n        _this.mConfig = config;\r\n        _this.soundGroup = config.music;\r\n        var bg = scene.make.graphics(undefined, false);\r\n        bg.fillStyle(0);\r\n        bg.fillRect(0, 0, config.width, config.height);\r\n        bg.setPosition(config.x, config.y);\r\n        _this.width = _this.mConfig.width;\r\n        _this.height = _this.mConfig.height;\r\n        gameObject.setMask(bg.createGeometryMask());\r\n        _this.mGameObject = gameObject;\r\n        _this.basePoint = (config.basePoint ? config.basePoint : new Phaser.Geom.Point(_this.mGameObject.parentContainer.x, _this.mGameObject.parentContainer.y));\r\n        var container = scene.make.container(undefined, false);\r\n        container.setSize(config.width, config.height);\r\n        // const bg1 = scene.make.graphics(undefined, false);\r\n        // bg1.fillStyle(0, .2);\r\n        // bg1.fillRect(0, 0, config.width, config.height);\r\n        // bg1.setPosition(-config.width / 2, -config.height / 2);\r\n        // container.add(bg1);\r\n        if (_this.mGameObject.parentContainer) {\r\n            container.x = config.clickX;\r\n            container.y = config.clickY;\r\n            _this.mGameObject.parentContainer.add(container);\r\n        }\r\n        _this.mScroller = new _plugins_input_scroller_Scroller_js__WEBPACK_IMPORTED_MODULE_0__["default"](container, config);\r\n        _this.clickContainer = container;\r\n        _this.mDisDelection = GetValue(config, "interactivedisDetection", 10);\r\n        _this.mCellDownHandler = GetValue(config, "celldownCallBack", undefined);\r\n        _this.mCellUpHandler = GetValue(config, "cellupCallBack", undefined);\r\n        _this.setInteractive();\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    BaseScroller.prototype.setEnable = function (enable) {\r\n        if (this.mScroller)\r\n            this.mScroller.setEnable(enable);\r\n    };\r\n    BaseScroller.prototype.setValue = function (value) {\r\n        if (this.mScroller)\r\n            this.mScroller.setValue(value);\r\n    };\r\n    BaseScroller.prototype.adjustBackDeceleration = function (deceler) {\r\n        if (this.mScroller)\r\n            this.mScroller.setBackDeceleration(deceler);\r\n    };\r\n    BaseScroller.prototype.adjustSlidingDeceleration = function (deceler) {\r\n        if (this.mScroller)\r\n            this.mScroller.setSlidingDeceleration(deceler);\r\n    };\r\n    BaseScroller.prototype.adjustScrollMode = function (mode) {\r\n        if (!this.mConfig.orientation || this.mConfig.orientation !== mode) {\r\n            if (this.mScroller)\r\n                this.mScroller.setOrientationMode(mode);\r\n        }\r\n        this.mConfig.orientation = mode;\r\n    };\r\n    BaseScroller.prototype.adjustDragThreshol = function (hold) {\r\n        if (this.mScroller)\r\n            this.mScroller.setDragThreshold(hold);\r\n    };\r\n    /***\r\n    *  调整scroller遮照范围\r\n    * @param width\r\n    * @param height\r\n    * @param x\r\n    * @param y\r\n    */\r\n    BaseScroller.prototype.adjustMask = function (width, height, x, y) {\r\n        if (x === void 0) { x = this.mConfig.x; }\r\n        if (y === void 0) { y = this.mConfig.y; }\r\n        var mask = this.mGameObject.mask;\r\n        if (!mask) {\r\n            var config = this.mConfig;\r\n            mask = this.scene.make.graphics(undefined, false);\r\n            mask.fillStyle(0);\r\n            mask.fillRect(0, 0, width, height);\r\n            mask.setPosition(config.x, config.y);\r\n            this.width = width;\r\n            this.height = height;\r\n            this.mGameObject.setMask(mask.createGeometryMask());\r\n        }\r\n        mask.x = x;\r\n        mask.y = y;\r\n        Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(mask, width, height);\r\n    };\r\n    BaseScroller.prototype.setBounds = function (value0, value1) {\r\n        this.mScroller.setBounds(value0, value1);\r\n    };\r\n    Object.defineProperty(BaseScroller.prototype, "bounds", {\r\n        get: function () {\r\n            return this.mConfig.bounds;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BaseScroller.prototype.resize = function (width, height, value0, value1) {\r\n        this.width = width;\r\n        this.height = height;\r\n        if (this.mGameObject.parentContainer) {\r\n            this.clickContainer.x = this.mConfig.clickX;\r\n            this.clickContainer.y = this.mConfig.clickY;\r\n            this.mGameObject.parentContainer.add(this.clickContainer);\r\n        }\r\n        if (value0 !== undefined && value1 !== undefined)\r\n            this.mScroller.setBounds(value0, value1);\r\n    };\r\n    // resize(width, height) {\r\n    //     if ((this.width === width) && (this.height === height)) {\r\n    //         return this;\r\n    //     }\r\n    //     super.resize(width, height);\r\n    //     if (this.cellsMask) {\r\n    //         ResizeGameObject(MaskToGameObject(this.cellsMask), width, height);\r\n    //     }\r\n    //     if (this.expandCellSize) {\r\n    //         this.table.setDefaultCellWidth(this.instWidth / this.table.colCount);\r\n    //     }\r\n    //     this.updateTable(true);\r\n    //     return this;\r\n    // }\r\n    BaseScroller.prototype.clearInteractiveObject = function () {\r\n        if (!this.mInteractiveList)\r\n            return;\r\n        this.mInteractiveList.length = 0;\r\n        this.mInteractiveList = [];\r\n        this.mScroller.setBounds(0, 0);\r\n    };\r\n    BaseScroller.prototype.setInteractiveObject = function (obj) {\r\n        if (!this.mInteractiveList)\r\n            this.mInteractiveList = [];\r\n        this.mInteractiveList.push(obj);\r\n    };\r\n    BaseScroller.prototype.removeInteractiveObject = function (obj) {\r\n        var index = this.mInteractiveList.indexOf(obj);\r\n        if (index > -1) {\r\n            this.mInteractiveList.splice(index, 1);\r\n        }\r\n    };\r\n    BaseScroller.prototype.addListen = function () {\r\n        if (!this.scene)\r\n            return;\r\n        this.removeListen();\r\n        this.scene.input.on("pointermove", this.pointerMoveHandler, this);\r\n        this.scene.input.on("pointerdown", this.pointerDownHandler, this);\r\n        this.scene.input.on("pointerup", this.pointerUpHandler, this);\r\n    };\r\n    BaseScroller.prototype.removeListen = function () {\r\n        this.mMoveing = false;\r\n        if (!this.scene)\r\n            return;\r\n        this.scene.input.off("pointerdown", this.pointerDownHandler, this);\r\n        this.scene.input.off("pointerup", this.pointerUpHandler, this);\r\n        this.scene.input.off("pointermove", this.pointerMoveHandler, this);\r\n    };\r\n    Object.defineProperty(BaseScroller.prototype, "left", {\r\n        get: function () {\r\n            return -this.mGameObject.width / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BaseScroller.prototype, "right", {\r\n        get: function () {\r\n            return this.mGameObject.width / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BaseScroller.prototype, "top", {\r\n        get: function () {\r\n            return -this.mGameObject.height / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BaseScroller.prototype, "bottom", {\r\n        get: function () {\r\n            return this.mGameObject.height / 2;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BaseScroller.prototype, "boundPad0", {\r\n        get: function () {\r\n            return this.mScroller.boundPad0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BaseScroller.prototype, "boundPad1", {\r\n        get: function () {\r\n            return this.mScroller.boundPad1;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BaseScroller.prototype.destroy = function () {\r\n        this.mMoveing = false;\r\n        if (this.mGameObject)\r\n            this.mGameObject.clearMask(true);\r\n        if (this.mScroller)\r\n            this.mScroller.destroy();\r\n        if (this.clickContainer)\r\n            this.clickContainer.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BaseScroller.prototype.refreshBound = function (refreshSize) {\r\n        var _this = this;\r\n        // if (!this.mInteractiveList) return;\r\n        // 滚动容器尺寸\r\n        var totalSize = 0;\r\n        if (refreshSize !== undefined) {\r\n            totalSize = refreshSize;\r\n        }\r\n        else {\r\n            this.mInteractiveList.forEach(function (cell) {\r\n                if (cell) {\r\n                    totalSize += _this.mConfig.orientation ? cell.width : cell.height;\r\n                }\r\n            });\r\n        }\r\n        // // 滚动容器尺寸\r\n        // const tmpSize: number = this.mConfig.orientation ? this.mGameObject.width : this.mGameObject.height;\r\n        // 父容器初始位置\r\n        var baseSize = this.mConfig.orientation ? this.basePoint.x : this.basePoint.y;\r\n        // 视口范围尺寸（滚动不能小于改尺寸）\r\n        var baseShowSize = this.mConfig.orientation ? this.mConfig.width : this.mConfig.height;\r\n        if (totalSize < baseShowSize)\r\n            totalSize = baseShowSize;\r\n        this.setBounds(baseSize, baseSize - totalSize + baseShowSize);\r\n    };\r\n    BaseScroller.prototype.pointerMoveHandler = function (pointer) {\r\n        if (this.soundGroup && this.soundGroup.move)\r\n            this.playSound(this.soundGroup.move);\r\n        this.mMoveing = true;\r\n    };\r\n    BaseScroller.prototype.pointerDownHandler = function (pointer) {\r\n        // this.scene.input.off("pointermove", this.pointerMoveHandler, this);\r\n        if (this.soundGroup && this.soundGroup.down)\r\n            this.playSound(this.soundGroup.down);\r\n        var inBound = this.checkPointerInBounds(this.clickContainer, pointer);\r\n        if (inBound && this.checkPointerDelection(pointer)) {\r\n            if (this.mCellDownHandler && !this.mMoveing) {\r\n                if (!this.mInteractiveList)\r\n                    return;\r\n                for (var i = 0, len = this.mInteractiveList.length; i < len; i++) {\r\n                    var interactiveObj = this.mInteractiveList[i];\r\n                    if (this.checkPointerInBounds(interactiveObj, pointer, true)) {\r\n                        this.mCellDownHandler(interactiveObj);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            var eventName = inBound ? BaseScrollerEvent.downinBound : BaseScrollerEvent.downoutBound;\r\n            this.emit(eventName, this.clickContainer);\r\n        }\r\n    };\r\n    BaseScroller.prototype.pointerUpHandler = function (pointer, gameObject) {\r\n        if (gameObject && this.mInteractiveList && this.mInteractiveList.length > 0) {\r\n            if (this.mInteractiveList.indexOf(gameObject[0]) === -1 && gameObject[0] !== this.clickContainer)\r\n                return;\r\n        }\r\n        // this.scene.input.on("pointermove", this.pointerMoveHandler, this);\r\n        if (this.soundGroup && this.soundGroup.up)\r\n            this.playSound(this.soundGroup.up);\r\n        var inBound = this.checkPointerInBounds(this.clickContainer, pointer);\r\n        if (inBound && this.checkPointerDelection(pointer)) {\r\n            if (this.mCellUpHandler && !this.mMoveing) {\r\n                if (!this.mInteractiveList)\r\n                    return;\r\n                for (var i = 0, len = this.mInteractiveList.length; i < len; i++) {\r\n                    var interactiveObj = this.mInteractiveList[i];\r\n                    if (this.checkPointerInBounds(interactiveObj, pointer, true)) {\r\n                        this.mCellUpHandler(interactiveObj);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            var eventName = inBound ? BaseScrollerEvent.upinBound : BaseScrollerEvent.upoutBound;\r\n            this.emit(eventName, this.clickContainer);\r\n        }\r\n        this.mMoveing = false;\r\n    };\r\n    BaseScroller.prototype.checkPointerInBounds = function (gameObject, pointer, isCell) {\r\n        if (isCell === void 0) { isCell = false; }\r\n        if (!this.mRectangle) {\r\n            this.mRectangle = new Phaser.Geom.Rectangle(0, 0, 0, 0);\r\n        }\r\n        this.mRectangle.left = -gameObject.width / 2;\r\n        this.mRectangle.right = gameObject.width / 2;\r\n        this.mRectangle.top = -gameObject.height / 2;\r\n        this.mRectangle.bottom = gameObject.height / 2;\r\n        if (pointer) {\r\n            var worldMatrix = gameObject.getWorldTransformMatrix();\r\n            var x = pointer.x - worldMatrix.tx;\r\n            var y = pointer.y - worldMatrix.ty;\r\n            if (this.mRectangle.left <= x && this.mRectangle.right >= x && this.mRectangle.top <= y && this.mRectangle.bottom >= y) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    };\r\n    return BaseScroller;\r\n}(_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_1__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/scroller/Scroller.ts?')},"./lib/rexui/lib/ui/sizer/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Sizer.js */ "./lib/rexui/lib/ui/sizer/Sizer.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'sizer\', function (x, y, minWidth, minHeight, orientation, config) {\r\n    var gameObject = new _Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, orientation, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Sizer\', _Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Sizer_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/Factory.js?')},"./lib/rexui/lib/ui/sizer/GetChildrenHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenHeight = function (minimumMode) {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    if (minimumMode === undefined) {\r\n        minimumMode = true;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, padding, childHeight;\r\n    if (this.orientation === 0) { // x\r\n        // Get maximun height\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            childHeight = (child.isRexSizer) ?\r\n                Math.max(child.minHeight, child.childrenHeight) :\r\n                Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(child);\r\n\r\n            padding = child.rexSizer.padding;\r\n            childHeight += (padding.top + padding.bottom);\r\n            result = Math.max(childHeight, result);\r\n        }\r\n    } else {\r\n        // Get summation of minimum height\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (!child.hasOwnProperty(\'rexSizer\')) {\r\n                continue;\r\n            }\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            if (\r\n                (child.rexSizer.proportion === 0) ||\r\n                (minimumMode && (!child.isRexSpace) && (child.rexSizer.proportion > 0))\r\n            ) {\r\n                childHeight = (child.isRexSizer) ?\r\n                    Math.max(child.minHeight, child.childrenHeight) :\r\n                    Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayHeight"])(child);\r\n            } else {\r\n                childHeight = 0;\r\n            }\r\n            padding = child.rexSizer.padding;\r\n            childHeight += (padding.top + padding.bottom);\r\n            result += childHeight;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetChildrenHeight.js?')},"./lib/rexui/lib/ui/sizer/GetChildrenProportion.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenProportion = function () {\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, proportion;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n        proportion = child.rexSizer.proportion;\r\n        if (proportion > 0) {\r\n            result += proportion;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenProportion);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetChildrenProportion.js?')},"./lib/rexui/lib/ui/sizer/GetChildrenSizers.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetChildrenSizers = function(out) {\r\n    if (out === undefined) {\r\n        out = [];\r\n    }\r\n    var children = this.sizerChildren,\r\n        child;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.isRexSizer) {\r\n            out.push(child);\r\n        }\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenSizers);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetChildrenSizers.js?')},"./lib/rexui/lib/ui/sizer/GetChildrenWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\nvar GetChildrenWidth = function (minimumMode) {\r\n    if (this.rexSizer.hidden) {\r\n        return 0;\r\n    }\r\n\r\n    if (minimumMode === undefined) {\r\n        minimumMode = true;\r\n    }\r\n\r\n    var result = 0;\r\n    var children = this.sizerChildren;\r\n    var child, padding, childWidth;\r\n    if (this.orientation === 0) { // x\r\n        // Get summation of minimum width\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            if (\r\n                (child.rexSizer.proportion === 0) ||\r\n                (minimumMode && (!child.isRexSpace) && (child.rexSizer.proportion > 0))\r\n            ) {\r\n                childWidth = (child.isRexSizer) ?\r\n                    Math.max(child.minWidth, child.childrenWidth) :\r\n                    Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(child);\r\n            } else {\r\n                childWidth = 0;\r\n            }\r\n            padding = child.rexSizer.padding;\r\n            childWidth += (padding.left + padding.right);\r\n            result += childWidth;\r\n        }\r\n    } else {\r\n        // Get maximun width\r\n        for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n            child = children[i];\r\n            if (!child.hasOwnProperty(\'rexSizer\')) {\r\n                continue;\r\n            }\r\n            if (child.rexSizer.hidden) {\r\n                continue;\r\n            }\r\n\r\n            childWidth = (child.isRexSizer) ?\r\n                Math.max(child.minWidth, child.childrenWidth) :\r\n                Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_0__["GetDisplayWidth"])(child);\r\n\r\n            padding = child.rexSizer.padding;\r\n            childWidth += (padding.left + padding.right);\r\n            result = Math.max(childWidth, result);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetChildrenWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetChildrenWidth.js?')},"./lib/rexui/lib/ui/sizer/GetExpandedChildHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildHeight = function (parent, child) {\r\n    var newHeight;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (parent.orientation === 0) { // x\r\n        if (childConfig.expand) {\r\n            newHeight = parent.height - padding.top - padding.bottom;\r\n        }\r\n    } else { // y\r\n        if ((childConfig.proportion > 0) && (parent.proportionLength > 0)) {\r\n            newHeight = (childConfig.proportion * parent.proportionLength);\r\n        }\r\n    }\r\n    return newHeight;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetExpandedChildHeight.js?')},"./lib/rexui/lib/ui/sizer/GetExpandedChildWidth.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar GetExpandedChildWidth = function (parent, child) {\r\n    var newWidth;\r\n    var childConfig = child.rexSizer;\r\n    var padding = childConfig.padding;\r\n    if (parent.orientation === 0) { // x\r\n        if ((childConfig.proportion > 0) && (parent.proportionLength > 0)) {\r\n            newWidth = (childConfig.proportion * parent.proportionLength);\r\n        }\r\n    } else { // y\r\n        if (childConfig.expand) {\r\n            newWidth = parent.width - padding.left - padding.right;\r\n        }\r\n    }\r\n    return newWidth;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetExpandedChildWidth);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/GetExpandedChildWidth.js?')},"./lib/rexui/lib/ui/sizer/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetExpandedChildWidth.js */ "./lib/rexui/lib/ui/sizer/GetExpandedChildWidth.js");\n/* harmony import */ var _GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetExpandedChildHeight.js */ "./lib/rexui/lib/ui/sizer/GetExpandedChildHeight.js");\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/lib/plugins/utils/actions/GlobZone.js");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.preLayout(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = Math.max(this.childrenWidth, this.minWidth);\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = Math.max(this.childrenHeight, this.minHeight);\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    var proportionLength;\r\n    if (this.childrenProportion > 0) {\r\n        var remainder = (this.orientation === 0) ?\r\n            (this.width - this.childrenWidth) :\r\n            (this.height - this.childrenHeight);\r\n\r\n        if (remainder > 0) {\r\n            remainder = (this.orientation === 0) ?\r\n                (this.width - this.getChildrenWidth(false)) :\r\n                (this.height - this.getChildrenHeight(false));\r\n            proportionLength = remainder / this.childrenProportion;\r\n        } else {\r\n            proportionLength = 0;\r\n        }\r\n    } else {\r\n        proportionLength = 0;\r\n    }\r\n    this.proportionLength = proportionLength;\r\n\r\n    // Layout children    \r\n    var children = this.sizerChildren;\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var itemX = startX,\r\n        itemY = startY;\r\n    var x, y, width, height; // Align zone\r\n    var childWidth, childHeight;\r\n    for (var i = 0, cnt = children.length; i < cnt; i++) {\r\n        child = children[i];\r\n        if (child.rexSizer.hidden) {\r\n            continue;\r\n        }\r\n\r\n        childConfig = child.rexSizer;\r\n        padding = childConfig.padding;\r\n\r\n        // Set size\r\n        childWidth = Object(_GetExpandedChildWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this, child);\r\n        childHeight = Object(_GetExpandedChildHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"])(this, child);\r\n        if (child.isRexSizer) {\r\n            child.layout(this, childWidth, childHeight);\r\n        } else {\r\n            Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(child, childWidth, childHeight);\r\n        }\r\n\r\n        if (childWidth === undefined) {\r\n            childWidth = Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_5__["GetDisplayWidth"])(child);\r\n        }\r\n        if (childHeight === undefined) {\r\n            childHeight = Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_5__["GetDisplayHeight"])(child);\r\n        }\r\n\r\n        // Set position\r\n        if (this.orientation === 0) { // x\r\n            x = (itemX + padding.left);\r\n            if ((childConfig.proportion === 0) || (proportionLength === 0)) {\r\n                width = childWidth;\r\n            } else {\r\n                width = (childConfig.proportion * proportionLength);\r\n            }\r\n\r\n            y = (itemY + padding.top);\r\n            height = (this.height - padding.top - padding.bottom);\r\n        } else { // y\r\n            x = (itemX + padding.left);\r\n            width = (this.width - padding.left - padding.right);\r\n\r\n            y = (itemY + padding.top);\r\n            if ((childConfig.proportion === 0) || (proportionLength === 0)) {\r\n                height = childHeight;\r\n            } else {\r\n                height = (childConfig.proportion * proportionLength);\r\n            }\r\n        }\r\n\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"].setPosition(x, y).setSize(width, height);\r\n        Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_4__["default"])(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_3__["default"], childConfig.align);\r\n        this.resetChildPositionState(child);\r\n\r\n        if (this.orientation === 0) { // x\r\n            itemX += (width + padding.left + padding.right);\r\n        } else { // y\r\n            itemY += (height + padding.top + padding.bottom);\r\n        }\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this.postLayout();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/Layout.js?')},"./lib/rexui/lib/ui/sizer/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetChildrenWidth.js */ "./lib/rexui/lib/ui/sizer/GetChildrenWidth.js");\n/* harmony import */ var _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GetChildrenHeight.js */ "./lib/rexui/lib/ui/sizer/GetChildrenHeight.js");\n/* harmony import */ var _GetChildrenProportion_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetChildrenProportion.js */ "./lib/rexui/lib/ui/sizer/GetChildrenProportion.js");\n/* harmony import */ var _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetChildrenSizers.js */ "./lib/rexui/lib/ui/sizer/GetChildrenSizers.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/lib/ui/sizer/Layout.js");\n/* harmony import */ var _layoutInit_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_layoutInit.js */ "./lib/rexui/lib/ui/sizer/_layoutInit.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    getChildrenWidth: _GetChildrenWidth_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    getChildrenHeight: _GetChildrenHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    getChildrenProportion: _GetChildrenProportion_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    getChildrenSizers: _GetChildrenSizers_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n    _layoutInit: _layoutInit_js__WEBPACK_IMPORTED_MODULE_5__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/Methods.js?')},"./lib/rexui/lib/ui/sizer/Sizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/lib/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/lib/ui/sizer/Methods.js\");\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ \"./lib/rexui/lib/ui/utils/GetBoundsConfig.js\");\n/* harmony import */ var _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/OrientationConst.js */ \"./lib/rexui/lib/ui/utils/OrientationConst.js\");\n/* harmony import */ var _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/AlignConst.js */ \"./lib/rexui/lib/ui/utils/AlignConst.js\");\n/* harmony import */ var _utils_Space_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/Space.js */ \"./lib/rexui/lib/ui/utils/Space.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveItem = Phaser.Utils.Array.Remove;\r\nconst ALIGN_CENTER = Phaser.Display.Align.CENTER;\r\n\r\nclass Sizer extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, orientation, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(orientation)) {\r\n            config = orientation;\r\n        }\r\n\r\n        if (config !== undefined) {\r\n            orientation = GetValue(config, 'orientation', 0);\r\n        }\r\n        if (orientation === undefined) {\r\n            orientation = 0;\r\n        }\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexSizer';\r\n        this.sizerChildren = [];\r\n        this.setOrientation(orientation);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.sizerChildren.length = 0;\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setOrientation(orientation) {\r\n        if (typeof (orientation) === 'string') {\r\n            orientation = _utils_OrientationConst_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"][orientation];\r\n        }\r\n        this.orientation = orientation;\r\n        return this;\r\n    }\r\n\r\n    add(gameObject, proportion, align, paddingConfig, expand, childKey) {\r\n        super.add(gameObject);\r\n\r\n        var proportionType = typeof (proportion);\r\n        if (proportion === null) {\r\n            return this;\r\n        } else if (proportionType === 'number') {\r\n\r\n        } else if (proportionType === 'string') {\r\n            proportion = PROPORTIONMODE[proportion];\r\n        } else if (IsPlainObject(proportion)) {\r\n            var config = proportion;\r\n            proportion = GetValue(config, 'proportion', 0);\r\n            align = GetValue(config, 'align', ALIGN_CENTER);\r\n            paddingConfig = GetValue(config, 'padding', 0);\r\n            expand = GetValue(config, 'expand', false);\r\n            childKey = GetValue(config, 'key', undefined);\r\n        }\r\n\r\n        if (typeof (align) === 'string') {\r\n            align = _utils_AlignConst_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"][align];\r\n        }\r\n\r\n        if (proportion === undefined) {\r\n            proportion = 0;\r\n        }\r\n        if (align === undefined) {\r\n            align = ALIGN_CENTER;\r\n        }\r\n        if (paddingConfig === undefined) {\r\n            paddingConfig = 0;\r\n        }\r\n        if (expand === undefined) {\r\n            expand = false;\r\n        }\r\n\r\n        var config = this.getSizerConfig(gameObject);\r\n        config.parent = this;\r\n        config.proportion = proportion;\r\n        config.align = align;\r\n        config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(paddingConfig);\r\n        config.expand = expand;\r\n        this.sizerChildren.push(gameObject);\r\n\r\n        if (childKey !== undefined) {\r\n            this.addChildrenMap(childKey, gameObject)\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addSpace(proportion) {\r\n        if (proportion === undefined) {\r\n            proportion = 1;\r\n        }\r\n        this.add(Object(_utils_Space_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(this.scene), proportion);\r\n        return this;\r\n    }\r\n\r\n    insert(index, gameObject, proportion, align, paddingConfig, expand) {\r\n        this.add(gameObject, proportion, align, paddingConfig, expand);\r\n        this.moveTo(gameObject, index);\r\n        return this;\r\n    }\r\n\r\n    remove(gameObject) {\r\n        var config = this.getSizerConfig(gameObject);\r\n        if (config.parent !== this) {\r\n            return this;\r\n        }\r\n        config.parent = undefined;\r\n        RemoveItem(this.sizerChildren, gameObject);\r\n        super.remove(gameObject);\r\n        return this;\r\n    }\r\n\r\n    clear(destroyChild) {\r\n        for (var i = 0, cnt = this.sizerChildren.length; i < cnt; i++) {\r\n            this.getSizerConfig(this.sizerChildren[i]).parent = undefined;\r\n        }\r\n        this.sizerChildren.length = 0;\r\n        super.clear(destroyChild);\r\n        return this;\r\n    }\r\n\r\n    get childrenProportion() {\r\n        if (this._childrenProportion === undefined) {\r\n            this._childrenProportion = this.getChildrenProportion();\r\n        }\r\n        return this._childrenProportion;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Sizer.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\nconst PROPORTIONMODE = {\r\n    min: 0,\r\n    full: -1,\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Sizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/Sizer.js?")},"./lib/rexui/lib/ui/sizer/_layoutInit.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LayoutInitChild = function () {\r\n    this._childrenWidth = undefined;\r\n    this._childrenHeight = undefined;\r\n    this._childrenProportion = undefined;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LayoutInitChild);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/sizer/_layoutInit.js?')},"./lib/rexui/lib/ui/slider/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Slider_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Slider.js */ "./lib/rexui/lib/ui/slider/Slider.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'slider\', function (config) {\r\n    var gameObject = new _Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.Slider\', _Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/Factory.js?')},"./lib/rexui/lib/ui/slider/GameSlider.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GameSlider", function() { return GameSlider; });\n/* harmony import */ var _Slider_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Slider.js */ "./lib/rexui/lib/ui/slider/Slider.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar GameSlider = /** @class */ (function (_super) {\r\n    __extends(GameSlider, _super);\r\n    function GameSlider(scene, config) {\r\n        var _this = _super.call(this, scene, config.x, config.y) || this;\r\n        config.x = 0;\r\n        config.y = 0;\r\n        _this.slider = new _Slider_js__WEBPACK_IMPORTED_MODULE_0__["default"](scene, config);\r\n        _this.add(_this.slider);\r\n        var group = _this.slider.children;\r\n        _this.add(group.getChildren());\r\n        _this.slider.layout(_this, config.width, config.height);\r\n        return _this;\r\n    }\r\n    GameSlider.prototype.setEnable = function (enable) {\r\n        this.slider.setEnable(enable);\r\n    };\r\n    GameSlider.prototype.setGap = function (gap) {\r\n        this.slider.setGap(gap);\r\n    };\r\n    GameSlider.prototype.setValue = function (value, min, max) {\r\n        this.slider.setValue(value, min, max);\r\n    };\r\n    GameSlider.prototype.addValue = function (inc, min, max) {\r\n        this.slider.addValue(inc, min, max);\r\n    };\r\n    GameSlider.prototype.getValue = function (min, max) {\r\n        var value = this.slider.getValue(min, max);\r\n        return value;\r\n    };\r\n    GameSlider.prototype.layout = function (parent, newWidth, newHeight) {\r\n        this.slider.layout(parent, newWidth, newHeight);\r\n    };\r\n    return GameSlider;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/GameSlider.ts?')},"./lib/rexui/lib/ui/slider/GetEndPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetThumbAlignPoint.js */ "./lib/rexui/lib/ui/slider/GetThumbAlignPoint.js");\n\r\n\r\nconst AlignRight = Phaser.Display.Align.RIGHT_CENTER;\r\nconst AlignBottom = Phaser.Display.Align.BOTTOM_CENTER;\r\n\r\nvar GetEndoint = function (out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    if (this.childrenMap.thumb) {\r\n        var align = (this.orientation === 1) ? AlignRight : AlignBottom;\r\n        _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, align, out);\r\n    } else {\r\n        if (this.orientation === 0) {\r\n            out.x = this.centerX;\r\n            out.y = this.bottom - 1; // Add 1 pixel margin\r\n        } else {\r\n            out.x = this.right - 1; // Add 1 pixel margin\r\n            out.y = this.centerY;\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetEndoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/GetEndPoint.js?')},"./lib/rexui/lib/ui/slider/GetStartPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetThumbAlignPoint.js */ "./lib/rexui/lib/ui/slider/GetThumbAlignPoint.js");\n\r\n\r\nconst AlignLeft = Phaser.Display.Align.LEFT_CENTER;\r\nconst AlignTop = Phaser.Display.Align.TOP_CENTER;\r\n\r\nvar GetStartPoint = function (out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    if (this.childrenMap.thumb) {\r\n        var align = (this.orientation === 0) ? AlignTop : AlignLeft;\r\n        _GetThumbAlignPoint_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, align, out);\r\n    } else {\r\n        if (this.orientation === 0) {\r\n            out.x = this.centerX;\r\n            out.y = this.top + 1; // Add 1 pixel margin\r\n        } else {\r\n            out.x = this.left + 1; // Add 1 pixel margin\r\n            out.y = this.centerY;\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetStartPoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/GetStartPoint.js?')},"./lib/rexui/lib/ui/slider/GetThumbAlignPoint.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n\r\n\r\nvar GetThumbAlignPoint = function (align, out) {\r\n    if (out === undefined) {\r\n        out = tmpPoint;\r\n    }\r\n    var thumb = this.childrenMap.thumb;\r\n    var currentX = thumb.x;\r\n    var currentY = thumb.y;\r\n\r\n    Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_0__["default"])(thumb, this, align, this.offsetX, this.offsetY);\r\n    out.x = thumb.x;\r\n    out.y = thumb.y;\r\n\r\n    thumb.x = currentX;\r\n    thumb.y = currentY;\r\n\r\n    return out;\r\n}\r\n\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetThumbAlignPoint);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/GetThumbAlignPoint.js?')},"./lib/rexui/lib/ui/slider/OnDragThumb.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PositionToPercent.js */ "./lib/rexui/lib/ui/slider/PositionToPercent.js");\n\r\n\r\nvar OnDragThumb = function (pointer, dragX, dragY) {\r\n    if (!this.enable) {\r\n        return;\r\n    }\r\n    tmpPoint.x = dragX;\r\n    tmpPoint.y = dragY;\r\n    this.value = Object(_PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.getStartPoint(), this.getEndPoint(), tmpPoint);\r\n}\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (OnDragThumb);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/OnDragThumb.js?')},"./lib/rexui/lib/ui/slider/OnTouchTrack.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PositionToPercent.js */ "./lib/rexui/lib/ui/slider/PositionToPercent.js");\n\r\n\r\nvar OnTouchTrack = function (pointer, localX, localY) {\r\n    if (!this.enable) {\r\n        return;\r\n    }\r\n    if (!pointer.isDown) {\r\n        return;\r\n    }\r\n    tmpPoint.x = pointer.worldX;\r\n    tmpPoint.y = pointer.worldY;\r\n    this.value = Object(_PositionToPercent_js__WEBPACK_IMPORTED_MODULE_0__["default"])(this.getStartPoint(), this.getEndPoint(), tmpPoint);\r\n}\r\nvar tmpPoint = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (OnTouchTrack);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/OnTouchTrack.js?')},"./lib/rexui/lib/ui/slider/PercentToPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Linear = Phaser.Math.Linear;\r\n\r\nvar PercentToPosition = function (t, startPoint, endPoint, out) {\r\n    if (out === undefined) {\r\n        out = tmpOut;\r\n    }\r\n    out.x = Linear(startPoint.x, endPoint.x, t);\r\n    out.y = Linear(startPoint.y, endPoint.y, t);\r\n    return out;\r\n}\r\nvar tmpOut = {};\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PercentToPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/PercentToPosition.js?')},"./lib/rexui/lib/ui/slider/PositionToPercent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nconst Percent = Phaser.Math.Percent;\r\n\r\nvar PositionToPercent = function (startPoint, endPoint, currentPoint) {\r\n    var min, max, value;\r\n    if (startPoint.y === endPoint.y) {\r\n        min = Math.min(startPoint.x, endPoint.x);\r\n        max = Math.max(startPoint.x, endPoint.x);\r\n        value = Percent(currentPoint.x, min, max);\r\n    } else if (startPoint.x === endPoint.x) {\r\n        min = Math.min(startPoint.y, endPoint.y);\r\n        max = Math.max(startPoint.y, endPoint.y);\r\n        value = Percent(currentPoint.y, min, max);\r\n    }\r\n    return value\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (PositionToPercent);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/PositionToPercent.js?')},"./lib/rexui/lib/ui/slider/Slider.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sizer/Sizer.js */ \"./lib/rexui/lib/ui/sizer/Sizer.js\");\n/* harmony import */ var _OnDragThumb_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OnDragThumb.js */ \"./lib/rexui/lib/ui/slider/OnDragThumb.js\");\n/* harmony import */ var _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OnTouchTrack.js */ \"./lib/rexui/lib/ui/slider/OnTouchTrack.js\");\n/* harmony import */ var _GetStartPoint_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GetStartPoint.js */ \"./lib/rexui/lib/ui/slider/GetStartPoint.js\");\n/* harmony import */ var _GetEndPoint_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./GetEndPoint.js */ \"./lib/rexui/lib/ui/slider/GetEndPoint.js\");\n/* harmony import */ var _UpdateThumb_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./UpdateThumb.js */ \"./lib/rexui/lib/ui/slider/UpdateThumb.js\");\n/* harmony import */ var _UpdateIndicator_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./UpdateIndicator.js */ \"./lib/rexui/lib/ui/slider/UpdateIndicator.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst Clamp = Phaser.Math.Clamp;\r\nconst Linear = Phaser.Math.Linear;\r\nconst Percent = Phaser.Math.Percent;\r\nconst SnapTo = Phaser.Math.Snap.To;\r\n\r\nclass Slider extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        // Create sizer\r\n        super(scene, config);\r\n        this.type = 'rexSlider';\r\n        this.eventEmitter = GetValue(config, 'eventEmitter', this);\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var track = GetValue(config, 'track', undefined);\r\n        var indicator = GetValue(config, 'indicator', undefined);\r\n        var thumb = GetValue(config, 'thumb', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n        this.offsetX = GetValue(config, 'offsetX', 0);\r\n        this.offsetY = GetValue(config, 'offsetY', 0);\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (track) {\r\n            var padding = {\r\n                left: paddingLeft,\r\n                right: paddingRight,\r\n                top: paddingTop,\r\n                bottom: paddingBottom\r\n            }\r\n            this.add(track, 0, undefined, padding, true);\r\n        }\r\n\r\n        if (indicator) {\r\n            this.add(indicator, null); // Put into container but not layout it\r\n        }\r\n\r\n        if (thumb) {\r\n            this.add(thumb, null); // Put into container but not layout it\r\n\r\n        }\r\n\r\n        // Input\r\n        var inputMode = GetValue(config, 'input', 0);\r\n        if (typeof (inputMode) === 'string') {\r\n            inputMode = INPUTMODE[inputMode];\r\n        }\r\n        switch (inputMode) {\r\n            case 0: // 'drag'\r\n                if (thumb) {\r\n                    thumb.setInteractive();\r\n                    this.scene.input.setDraggable(thumb);\r\n                    thumb.on('drag', _OnDragThumb_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"], this);\r\n                }\r\n                break;\r\n            case 1: // 'click'\r\n                this.setInteractive()\r\n                    .on('pointerdown', _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"], this)\r\n                    .on('pointermove', _OnTouchTrack_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"], this);\r\n                break;\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('track', track);\r\n        this.addChildrenMap('indicator', indicator);\r\n        this.addChildrenMap('thumb', thumb);\r\n        this.calValueFunc = GetValue(config, \"calValueFunc\", undefined);\r\n        var callback = GetValue(config, 'valuechangeCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'valuechangeCallbackScope', undefined);\r\n            this.eventEmitter.on('valuechange', callback, scope);\r\n        }\r\n        this.setEnable(GetValue(config, 'enable', undefined));\r\n        this.setGap(GetValue(config, 'gap', undefined));\r\n        this.setValue(GetValue(config, 'value', 0));\r\n    }\r\n\r\n    setEnable(enable) {\r\n        if (enable === undefined) {\r\n            enable = true;\r\n        }\r\n        this.enable = enable;\r\n        return this;\r\n    }\r\n\r\n    setGap(gap) {\r\n        this.gap = gap;\r\n        return this;\r\n    }\r\n\r\n    get value() {\r\n        return this._value;\r\n    }\r\n\r\n    set value(value) {\r\n        if (this.gap !== undefined) {\r\n            value = SnapTo(value, this.gap);\r\n        }\r\n        var oldValue = this._value;\r\n        this._value = Clamp(value, 0, 1);\r\n\r\n        if (oldValue !== this._value) {\r\n            // 滑动效果\r\n            this.updateThumb(this._value);\r\n            this.updateIndicator(this._value);\r\n            this.eventEmitter.emit('valuechange', this._value, oldValue, this.eventEmitter);\r\n        }\r\n    }\r\n\r\n    setValue(value, min, max) {\r\n        if ((value === undefined) || (value === null)) {\r\n            return this;\r\n        }\r\n\r\n        if (min !== undefined) {\r\n            value = Percent(value, min, max);\r\n        }\r\n        this.value = value;\r\n        return this;\r\n    }\r\n\r\n    addValue(inc, min, max) {\r\n        if (min !== undefined) {\r\n            inc = Percent(inc, min, max);\r\n        }\r\n        this.value += inc;\r\n        return this;\r\n    }\r\n\r\n    getValue(min, max) {\r\n        var value = this.value;\r\n        if (min !== undefined) {\r\n            value = this.calValueFunc === undefined ? Linear(min, max, value) : this.calValueFunc(min, max, value);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        this.updateThumb();\r\n        this.updateIndicator();\r\n        return this;\r\n    }\r\n}\r\n\r\nconst INPUTMODE = {\r\n    drag: 0,\r\n    click: 1,\r\n    none: -1,\r\n}\r\n\r\nvar methods = {\r\n    getStartPoint: _GetStartPoint_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n    getEndPoint: _GetEndPoint_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"],\r\n    updateThumb: _UpdateThumb_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\r\n    updateIndicator: _UpdateIndicator_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"],\r\n}\r\nObject.assign(\r\n    Slider.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Slider);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/Slider.js?")},"./lib/rexui/lib/ui/slider/UpdateIndicator.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/size/ResizeGameObject.js */ "./lib/rexui/lib/plugins/utils/size/ResizeGameObject.js");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n/* harmony import */ var _plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/size/GetDisplaySize.js */ "./lib/rexui/lib/plugins/utils/size/GetDisplaySize.js");\n\r\n\r\n\r\n\r\nconst AlignLeft = Phaser.Display.Align.LEFT_CENTER;\r\nconst AlignTop = Phaser.Display.Align.TOP_CENTER;\r\n\r\nvar UpdateIndicator = function (t) {\r\n    var indicator = this.childrenMap.indicator;\r\n    if (indicator === undefined) {\r\n        return this;\r\n    }\r\n\r\n    if (t === undefined) {\r\n        t = this.value;\r\n    }\r\n\r\n    var newWidth, newHeight;\r\n    var thumb = this.childrenMap.thumb;\r\n    if (thumb) {\r\n        if (this.orientation === 0) { // x, extend height\r\n            var thumbHeight = Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayHeight"])(thumb);\r\n            var thumbBottom = (thumb.y - (thumbHeight * thumb.originY)) + thumbHeight;\r\n            newHeight = thumbBottom - this.top;\r\n        } else { // y, extend width\r\n            var thumbWidth = Object(_plugins_utils_size_GetDisplaySize_js__WEBPACK_IMPORTED_MODULE_2__["GetDisplayWidth"])(thumb);\r\n            var thumbRight = (thumb.x - (thumbWidth * thumb.originX)) + thumbWidth;\r\n            newWidth = thumbRight - this.left;\r\n        }\r\n    } else {\r\n        if (this.orientation === 0) { // x, extend height\r\n            newHeight = this.height * t;\r\n        } else { // y, extend width\r\n            newWidth = this.width * t;\r\n        }\r\n    }\r\n    Object(_plugins_utils_size_ResizeGameObject_js__WEBPACK_IMPORTED_MODULE_0__["default"])(indicator, newWidth, newHeight);\r\n    var align = (this.orientation === 1) ? AlignLeft : AlignTop;\r\n    Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_1__["default"])(indicator, this, align);\r\n    this.resetChildPositionState(indicator);\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateIndicator);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/UpdateIndicator.js?')},"./lib/rexui/lib/ui/slider/UpdateThumb.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _PercentToPosition_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PercentToPosition.js */ "./lib/rexui/lib/ui/slider/PercentToPosition.js");\n\r\n\r\nvar UpdateThumb = function (t) {\r\n    var thumb = this.childrenMap.thumb;\r\n    if (thumb === undefined) {\r\n        return this;\r\n    }\r\n\r\n    if (t === undefined) {\r\n        t = this.value;\r\n    }\r\n    Object(_PercentToPosition_js__WEBPACK_IMPORTED_MODULE_0__["default"])(t, this.getStartPoint(), this.getEndPoint(), thumb);\r\n    this.resetChildPositionState(thumb);\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateThumb);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/slider/UpdateThumb.js?')},"./lib/rexui/lib/ui/swipe/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Swipe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Swipe.js */ "./lib/rexui/lib/ui/swipe/Swipe.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/lib/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'swipe\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Swipe\', _Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/swipe/Factory.js?')},"./lib/rexui/lib/ui/swipe/Swipe.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/swipe/Swipe.js */ "./lib/rexui/lib/plugins/input/gestures/swipe/Swipe.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_swipe_Swipe_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/swipe/Swipe.js?')},"./lib/rexui/lib/ui/tab/NinePatchTabButton.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NinePatchTabButton", function() { return NinePatchTabButton; });\n/* harmony import */ var _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ninepatch/NineSlicePatch */ "./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts");\n/* harmony import */ var _TabButton__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TabButton */ "./lib/rexui/lib/ui/tab/TabButton.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar NinePatchTabButton = /** @class */ (function (_super) {\r\n    __extends(NinePatchTabButton, _super);\r\n    function NinePatchTabButton(scene, width, height, key, normalFrame, downFrame, text, configlist, dpr, scale, data) {\r\n        var _this = _super.call(this, scene, key, normalFrame, downFrame, text, {}, dpr, scale, { width: width, height: height, configlist: configlist }) || this;\r\n        _this.mBackground.setConfig(configlist[0]);\r\n        _this.dpr = dpr || 1;\r\n        _this.scale = scale || 1;\r\n        _this.setSize(width, height);\r\n        if (data) {\r\n            _this.btnData = data;\r\n        }\r\n        _this.changeNormal();\r\n        _this.enable = true;\r\n        return _this;\r\n    }\r\n    NinePatchTabButton.prototype.changeNormal = function () {\r\n        // if (this.configlist && this.configlist.length > 0) {\r\n        // resetPatchesConfig(this.mBackground.getConfig());\r\n        // this.mBackground.setConfig(this.configlist[0]);\r\n        //     this.setSize(this.wid, this.hei);\r\n        // }\r\n        this.setBgFrame(this.mFrame);\r\n    };\r\n    NinePatchTabButton.prototype.changeDown = function () {\r\n        if (this.mDownFrame) {\r\n            // if (this.configlist && this.configlist.length > 1) {\r\n            // resetPatchesConfig(this.mBackground.getConfig());\r\n            // this.mBackground.setConfig(this.configlist[0]);\r\n            //     this.setSize(this.wid, this.hei);\r\n            // }\r\n            this.setBgFrame(this.mDownFrame);\r\n        }\r\n    };\r\n    NinePatchTabButton.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.mBackground.setSize(width, height);\r\n        return this;\r\n    };\r\n    NinePatchTabButton.prototype.getBtnData = function () {\r\n        return this.btnData;\r\n    };\r\n    Object.defineProperty(NinePatchTabButton.prototype, "enable", {\r\n        set: function (value) {\r\n            if (value) {\r\n                this.mBackground.clearTint();\r\n                this.setInteractive();\r\n            }\r\n            else {\r\n                this.mBackground.setTintFill(0x666666);\r\n                this.removeInteractive();\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NinePatchTabButton.prototype.createBackground = function () {\r\n        var config = this.ninePatchConfig.configlist[0];\r\n        var width = this.ninePatchConfig.width;\r\n        var height = this.ninePatchConfig.height;\r\n        this.mBackground = new _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_0__["NineSlicePatch"](this.scene, 0, 0, width, height, this.mKey, this.mFrame, { left: config.left, top: config.top, right: config.right, bottom: config.bottom }, this.dpr, 1);\r\n        this.add(this.mBackground);\r\n    };\r\n    NinePatchTabButton.prototype.setBgFrame = function (frame) {\r\n        this.mBackground.setFrame(frame);\r\n        // this.setSize(this.mBackground.width, this.mBackground.height);\r\n    };\r\n    return NinePatchTabButton;\r\n}(_TabButton__WEBPACK_IMPORTED_MODULE_1__["TabButton"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tab/NinePatchTabButton.ts?')},"./lib/rexui/lib/ui/tab/TabButton.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TabButton", function() { return TabButton; });\n/* harmony import */ var _button_Button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interface/event/MouseEvent */ "./lib/rexui/lib/ui/interface/event/MouseEvent.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar TabButton = /** @class */ (function (_super) {\r\n    __extends(TabButton, _super);\r\n    function TabButton(scene, key, frame, downFrame, text, music, dpr, scale, nineConfig) {\r\n        var _this = _super.call(this, scene, key, frame, downFrame, text, music, dpr, scale, nineConfig) || this;\r\n        _this.mSelected = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TabButton.prototype, "selected", {\r\n        get: function () {\r\n            return this.mSelected;\r\n        },\r\n        set: function (value) {\r\n            this.mSelected = value;\r\n            var buttonState = value ? _button_Button__WEBPACK_IMPORTED_MODULE_0__["ButtonState"].Select : _button_Button__WEBPACK_IMPORTED_MODULE_0__["ButtonState"].Normal;\r\n            this.buttonStateChange(buttonState);\r\n            this.emit("selectChange", value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    TabButton.prototype.destroy = function () {\r\n        this.selected = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TabButton.prototype.onPointerUpHandler = function (pointer) {\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        if (!this.mIsMove || (Date.now() - this.mDownTime > this.mPressTime)) {\r\n            if (Math.abs(pointer.downX - pointer.upX) < 30 && Math.abs(pointer.downY - pointer.upY) < 30) {\r\n                if (this.soundGroup && this.soundGroup.up)\r\n                    this.playSound(this.soundGroup.up);\r\n                this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Tap, pointer, this);\r\n                this.selected = true;\r\n            }\r\n        }\r\n        clearTimeout(this.mPressDelay);\r\n        this.mIsMove = false;\r\n        this.mDownTime = 0;\r\n    };\r\n    TabButton.prototype.onPointerDownHandler = function (pointer) {\r\n        var _this = this;\r\n        if (!this.interactiveBoo) {\r\n            if (this.soundGroup && this.soundGroup.disabled)\r\n                this.playSound(this.soundGroup.disabled);\r\n            return;\r\n        }\r\n        if (this.soundGroup && this.soundGroup.down)\r\n            this.playSound(this.soundGroup.down);\r\n        this.mDownTime = Date.now();\r\n        this.mPressTime = setTimeout(function () {\r\n            _this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Hold, _this);\r\n        }, this.mPressTime);\r\n        this.emit(_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_1__["CoreUI"].MouseEvent.Down, this);\r\n    };\r\n    return TabButton;\r\n}(_button_Button__WEBPACK_IMPORTED_MODULE_0__["Button"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tab/TabButton.ts?')},"./lib/rexui/lib/ui/tagtext/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TagText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TagText.js */ "./lib/rexui/lib/ui/tagtext/TagText.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'tagText\', function (x, y, text, style) {\r\n    var gameObject = new _TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, text, style);\r\n    this.scene.add.existing(gameObject);\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TagText\', _TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tagtext/Factory.js?')},"./lib/rexui/lib/ui/tagtext/TagText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_gameobjects_text_tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/gameobjects/text/tagtext/TagText.js */ "./lib/rexui/lib/plugins/gameobjects/text/tagtext/TagText.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_gameobjects_text_tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tagtext/TagText.js?')},"./lib/rexui/lib/ui/tap/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Tap.js */ "./lib/rexui/lib/ui/tap/Tap.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/system/IsGameObject.js */ "./lib/rexui/lib/plugins/utils/system/IsGameObject.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'tap\', function (gameObject, config) {\r\n    if (!Object(_plugins_utils_system_IsGameObject_js__WEBPACK_IMPORTED_MODULE_2__["default"])(gameObject)) {\r\n        config = gameObject;\r\n        gameObject = this.scene;\r\n    }\r\n    return new _Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"](gameObject, config);\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_3__["default"])(window, \'RexPlugins.UI.Tap\', _Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tap/Factory.js?')},"./lib/rexui/lib/ui/tap/Tap.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_input_gestures_tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/input/gestures/tap/Tap.js */ "./lib/rexui/lib/plugins/input/gestures/tap/Tap.js");\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_plugins_input_gestures_tap_Tap_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tap/Tap.js?')},"./lib/rexui/lib/ui/textBox/TextBox.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextBox", function() { return TextBox; });\n/* harmony import */ var _plugins_bbcodetext__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/bbcodetext */ "./lib/rexui/lib/plugins/bbcodetext.js");\n/* harmony import */ var _plugins_behaviors_textedit_TextEdit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/behaviors/textedit/TextEdit */ "./lib/rexui/lib/plugins/behaviors/textedit/TextEdit.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar TextBox = /** @class */ (function (_super) {\r\n    __extends(TextBox, _super);\r\n    function TextBox(scene, config) {\r\n        var _this = _super.call(this) || this;\r\n        var textConfig = config.textConfig;\r\n        var posX = textConfig.x;\r\n        var posY = textConfig.y;\r\n        var editType = config.editType;\r\n        var str = config.text || "";\r\n        var textChangeHandler = config.onTextChanged || undefined;\r\n        var closeHandler = config.onClose || undefined;\r\n        var editConfig = { type: editType, text: str, onTextChanged: textChangeHandler };\r\n        var styleConfig = {};\r\n        Object.assign(styleConfig, textConfig);\r\n        _this.mBBCodeText = new _plugins_bbcodetext__WEBPACK_IMPORTED_MODULE_0__["default"](scene, posX, posY, str, styleConfig);\r\n        _this.mBBCodeText.setOrigin(0.5, 0.5);\r\n        _this.mBBCodeText.setInteractive();\r\n        _this.mBBCodeText.on("pointerdown", function () {\r\n            if (!_this.mTextEdit) {\r\n                _this.mTextEdit = new _plugins_behaviors_textedit_TextEdit__WEBPACK_IMPORTED_MODULE_1__["default"](_this.mBBCodeText);\r\n                _this.mTextEdit.open(editConfig, closeHandler);\r\n            }\r\n            // (<any>scene).plugins.get("rextexteditplugin").edit(this.mBBCodeText, editConfig);\r\n        }, _this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TextBox.prototype, "isOpened", {\r\n        get: function () {\r\n            return this.mTextEdit ? this.mTextEdit.isOpened : false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TextBox.prototype, "text", {\r\n        get: function () {\r\n            return this.mTextEdit ? this.mTextEdit.text : "";\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TextBox.prototype, "view", {\r\n        get: function () {\r\n            return this.mBBCodeText;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    TextBox.prototype.close = function () {\r\n        if (this.mTextEdit) {\r\n            this.mTextEdit.close();\r\n            this.mTextEdit.destroy();\r\n        }\r\n    };\r\n    TextBox.prototype.destroy = function () {\r\n        this.close();\r\n        if (this.mBBCodeText)\r\n            this.mBBCodeText.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return TextBox;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textBox/TextBox.ts?')},"./lib/rexui/lib/ui/textarea/AppendText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar AppendText = function (text) {\r\n    this.setText(this.text + text);\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (AppendText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textarea/AppendText.js?')},"./lib/rexui/lib/ui/textarea/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextArea_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextArea.js */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'textArea\', function (config) {\r\n    var gameObject = new _TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TextArea\', _TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TextArea_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textarea/Factory.js?')},"./lib/rexui/lib/ui/textarea/InjectProperties.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar InjectProperties = function(textBlock) {\r\n    Object.defineProperty(textBlock, 'childOY', {\r\n        configurable: true,\r\n        get: function () {\r\n            return textBlock.textOY;\r\n        },\r\n        set: function (value) {\r\n            textBlock.textOY = value;\r\n        }\r\n    });\r\n    Object.defineProperty(textBlock, 'topChildOY', {\r\n        get: function () {\r\n            return textBlock.topTextOY;\r\n        }\r\n    });\r\n    Object.defineProperty(textBlock, 'bottomChildOY', {\r\n        get: function () {\r\n            return textBlock.bottomTextOY;\r\n        }\r\n    });\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (InjectProperties);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textarea/InjectProperties.js?")},"./lib/rexui/lib/ui/textarea/SetText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetText = function (text) {\r\n    var textBlock = this.childrenMap.child;\r\n    textBlock.setText(text);\r\n\r\n    this.resizeController();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SetText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textarea/SetText.js?')},"./lib/rexui/lib/ui/textarea/TextArea.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/scrollable/Scrollable.js */ "./lib/rexui/lib/ui/utils/scrollable/Scrollable.js");\n/* harmony import */ var _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../textblock/TextBlock.js */ "./lib/rexui/lib/ui/textblock/TextBlock.js");\n/* harmony import */ var _InjectProperties_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InjectProperties.js */ "./lib/rexui/lib/ui/textarea/InjectProperties.js");\n/* harmony import */ var _SetText_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./SetText.js */ "./lib/rexui/lib/ui/textarea/SetText.js");\n/* harmony import */ var _AppendText_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AppendText.js */ "./lib/rexui/lib/ui/textarea/AppendText.js");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextArea extends _utils_scrollable_Scrollable_js__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        // Create text-block\r\n        var textObject = GetValue(config, \'text\', undefined);\r\n        var textWidth = GetValue(config, \'textWidth\', undefined);\r\n        var textHeight = GetValue(config, \'textHeight\', undefined);\r\n        var textMask = GetValue(config, \'textMask\', true);\r\n        var content = GetValue(config, \'content\', \'\');\r\n        var textBlock = new _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_1__["default"](scene, {\r\n            width: textWidth,\r\n            height: textHeight,\r\n            text: textObject,\r\n            textMask: textMask,\r\n            content: content,\r\n            clamplTextOY: GetValue(config, \'clamplChildOY\', false),\r\n        });\r\n        var proportion = (textWidth === undefined) ? 1 : 0;\r\n        var expand = (textHeight === undefined);\r\n        // Inject properties for scrollable interface\r\n        Object(_InjectProperties_js__WEBPACK_IMPORTED_MODULE_2__["default"])(textBlock);\r\n\r\n        // Fill config of scrollable\r\n        config.scrollMode = 0; // Vertical\r\n        config.type = \'rexTextArea\';\r\n        config.child = {\r\n            gameObject: textBlock,\r\n            proportion: proportion,\r\n            expand: expand,\r\n        };\r\n        var spaceConfig = GetValue(config, \'space\', undefined);\r\n        if (spaceConfig) {\r\n            spaceConfig.child = spaceConfig.text;\r\n        }\r\n        super(scene, config);\r\n\r\n        this.addChildrenMap(\'text\', textObject);\r\n    }\r\n\r\n    get text() {\r\n        return this.childrenMap.child.text;\r\n    }\r\n\r\n    get linesCount() {\r\n        return this.childrenMap.child.linesCount;\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    setText: _SetText_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n    appendText: _AppendText_js__WEBPACK_IMPORTED_MODULE_4__["default"],\r\n}\r\nObject.assign(\r\n    TextArea.prototype,\r\n    methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (TextArea);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textarea/TextArea.js?')},"./lib/rexui/lib/ui/textblock/Factory.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextBlock.js */ "./lib/rexui/lib/ui/textblock/TextBlock.js");\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/object/SetValue.js */ "./lib/rexui/lib/plugins/utils/object/SetValue.js");\n\r\n\r\n\r\n\r\n_ObjectFactory_js__WEBPACK_IMPORTED_MODULE_1__["default"].register(\'textBlock\', function (x, y, minWidth, minHeight, textGameObject, config) {\r\n    var gameObject = new _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, x, y, minWidth, minHeight, textGameObject, config);\r\n    this.scene.add.existing(gameObject); // It won\'t be added to display list, neither update list\r\n    return gameObject;\r\n});\r\n\r\nObject(_plugins_utils_object_SetValue_js__WEBPACK_IMPORTED_MODULE_2__["default"])(window, \'RexPlugins.UI.TextBlock\', _TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (_TextBlock_js__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/Factory.js?')},"./lib/rexui/lib/ui/textblock/GetLines.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetLines = function (startLineIdx) {\r\n    var endLineIdx = startLineIdx + this.textObject.style.maxLines;\r\n    var text;\r\n    if (this.textObjectType === 0) {\r\n        text = this.lines.slice(startLineIdx, endLineIdx).join('\\n');\r\n    } else {\r\n        var startIdx = this.lines.getLineStartIndex(startLineIdx);\r\n        var endIdx = this.lines.getLineEndIndex(endLineIdx - 1);\r\n        text = this.lines.getSliceTagText(startIdx, endIdx, true);\r\n    }\r\n    return text;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetLines);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/GetLines.js?")},"./lib/rexui/lib/ui/textblock/Layout.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ResizeText_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ResizeText.js */ "./lib/rexui/lib/ui/textblock/ResizeText.js");\n/* harmony import */ var _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ResetTextObjectPosition.js */ "./lib/rexui/lib/ui/textblock/ResetTextObjectPosition.js");\n/* harmony import */ var _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/actions/GlobZone.js */ "./lib/rexui/lib/plugins/utils/actions/GlobZone.js");\n/* harmony import */ var _plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/utils/align/align/in/QuickSet.js */ "./lib/rexui/lib/plugins/utils/align/align/in/QuickSet.js");\n\r\n\r\n\r\n\r\n\r\nvar Layout = function (parent, newWidth, newHeight) {\r\n    // Skip invisible sizer\r\n    if (this.rexSizer.hidden) {\r\n        return this;\r\n    }\r\n\r\n    this.preLayout(parent);\r\n\r\n    // Set size\r\n    if (newWidth === undefined) {\r\n        newWidth = this.minWidth;\r\n    }\r\n    if (newHeight === undefined) {\r\n        newHeight = this.minHeight;\r\n    }\r\n    this.resize(newWidth, newHeight);\r\n\r\n    // Layout children\r\n    var child, childConfig, padding;\r\n    var startX = this.left,\r\n        startY = this.top;\r\n    var x, y, width, height; // Align zone\r\n\r\n    // Layout text child\r\n    // Skip invisible child\r\n    child = this.textObject;\r\n    if (!child.rexSizer.hidden) {\r\n        childConfig = child.rexSizer;\r\n        padding = childConfig.padding;\r\n        x = (startX + padding.left);\r\n        y = (startY + padding.top);\r\n        width = this.width - padding.left - padding.right;\r\n        height = this.height - padding.top - padding.bottom;\r\n        _ResizeText_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, child, width, height);\r\n        _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__["default"].setPosition(x, y).setSize(width, height);\r\n        Object(_plugins_utils_align_align_in_QuickSet_js__WEBPACK_IMPORTED_MODULE_3__["default"])(child, _plugins_utils_actions_GlobZone_js__WEBPACK_IMPORTED_MODULE_2__["default"], childConfig.align);\r\n\r\n        childConfig.preOffsetY = 0; // Clear preOffsetY\r\n        _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this);\r\n\r\n        if (this.textMask) {\r\n            this.textMask.setPosition().resize();\r\n            this.resetChildPositionState(this.textMask);\r\n        }\r\n\r\n    }\r\n\r\n    // Layout background children\r\n    this.layoutBackgrounds();\r\n\r\n    return this.postLayout();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Layout);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/Layout.js?')},"./lib/rexui/lib/ui/textblock/LinesCountToTextHeight.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar LinesCountToTextHeight = function (linesCount) {\r\n    // height = (maxLines * (lineHeight + lineSpacing)) - lineSpacing\r\n    return (linesCount * (this.textLineHeight + this.textLineSpacing)) - this.textLineSpacing;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (LinesCountToTextHeight);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/LinesCountToTextHeight.js?')},"./lib/rexui/lib/ui/textblock/Methods.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _SetTextObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SetTextObject.js */ "./lib/rexui/lib/ui/textblock/SetTextObject.js");\n/* harmony import */ var _SetText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SetText.js */ "./lib/rexui/lib/ui/textblock/SetText.js");\n/* harmony import */ var _UpdateTextObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./UpdateTextObject.js */ "./lib/rexui/lib/ui/textblock/UpdateTextObject.js");\n/* harmony import */ var _Layout_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Layout.js */ "./lib/rexui/lib/ui/textblock/Layout.js");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    setTextObject: _SetTextObject_js__WEBPACK_IMPORTED_MODULE_0__["default"],\r\n    setText: _SetText_js__WEBPACK_IMPORTED_MODULE_1__["default"],\r\n    updateTextObject: _UpdateTextObject_js__WEBPACK_IMPORTED_MODULE_2__["default"],\r\n    layout: _Layout_js__WEBPACK_IMPORTED_MODULE_3__["default"],\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/Methods.js?')},"./lib/rexui/lib/ui/textblock/ResetTextObjectPosition.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ResetTextObjectPosition = function () {\r\n    var config = this.textObject.rexSizer;\r\n    this.textObject.y += (config.offsetY - config.preOffsetY);\r\n    config.preOffsetY = config.offsetY;\r\n    this.resetChildPositionState(this.textObject);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (ResetTextObjectPosition);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/ResetTextObjectPosition.js?')},"./lib/rexui/lib/ui/textblock/ResizeText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ "./lib/rexui/lib/ui/textblock/TextHeightToLinesCount.js");\n\r\n\r\nvar ResizeText = function (textObject, width, height) {\r\n    height += this.textLineHeight + this.textLineSpacing; // Add 1 text line\r\n    if ((textObject.width === width) && (textObject.height === height)) {\r\n        return;\r\n    }\r\n\r\n    textObject.setFixedSize(width, height);\r\n\r\n    var style = textObject.style;\r\n    var wrapWidth = Math.max(width, 0);\r\n\r\n    var maxLines = Math.ceil(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, height)) + 1;\r\n\r\n    if (this.textObjectType === 0) {\r\n        style.wordWrapWidth = wrapWidth;\r\n        style.maxLines = maxLines;\r\n    } else {\r\n        style.wrapWidth = wrapWidth;\r\n        style.maxLines = maxLines;\r\n    }\r\n\r\n    // Render content again\r\n    this.setText();\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResizeText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/ResizeText.js?')},"./lib/rexui/lib/ui/textblock/SetText.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar SetText = function (text) {\r\n    if (text !== undefined) {\r\n        this.text = text;\r\n    }\r\n\r\n    // Wrap content in lines\r\n    if (this.textObjectType === 0) {\r\n        this.lines = this.textObject.getWrappedText(this.text); // lines in array\r\n    } else {\r\n        this.lines = this.textObject.getPenManager(this.text, this.lines); // pen manager\r\n    }\r\n\r\n    this.updateTextObject();\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (SetText);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/SetText.js?')},"./lib/rexui/lib/ui/textblock/SetTextObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/GetBoundsConfig.js */ "./lib/rexui/lib/ui/utils/GetBoundsConfig.js");\n/* harmony import */ var _plugins_utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugins/utils/text/IsTextGameObject.js */ "./lib/rexui/lib/plugins/utils/text/IsTextGameObject.js");\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/utils/mask/DefaultMask.js */ "./lib/rexui/lib/plugins/utils/mask/DefaultMask.js");\n\r\n\r\n\r\n\r\nconst ALIGN_LEFTTOP = Phaser.Display.Align.TOP_LEFT;\r\n\r\nvar SetTextObject = function (gameObject, maskEnable) {\r\n    if (maskEnable === undefined) {\r\n        maskEnable = true;\r\n    }\r\n\r\n    this.add(gameObject);\r\n\r\n    var config = this.getSizerConfig(gameObject);\r\n    config.parent = this;\r\n    config.align = ALIGN_LEFTTOP;\r\n    config.padding = Object(_utils_GetBoundsConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(0);\r\n    config.expand = true;\r\n    this.textObject = gameObject;\r\n    this.textObjectType = (Object(_plugins_utils_text_IsTextGameObject_js__WEBPACK_IMPORTED_MODULE_1__["default"])(gameObject)) ? 0 : 1;\r\n    // Add more variables\r\n    config.preOffsetY = 0;\r\n    config.offsetY = 0;\r\n\r\n    // Create mask of text object\r\n    if (maskEnable) {\r\n        this.textMask = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_2__["default"](this);\r\n        this.textObject.setMask(this.textMask.createGeometryMask());\r\n        this.pin(this.textMask);\r\n    }\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (SetTextObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/SetTextObject.js?')},"./lib/rexui/lib/ui/textblock/TextBlock.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../basesizer/BaseSizer.js */ \"./lib/rexui/lib/ui/basesizer/BaseSizer.js\");\n/* harmony import */ var _Methods_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Methods.js */ \"./lib/rexui/lib/ui/textblock/Methods.js\");\n/* harmony import */ var _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LinesCountToTextHeight.js */ \"./lib/rexui/lib/ui/textblock/LinesCountToTextHeight.js\");\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ \"./lib/rexui/lib/ui/textblock/TextHeightToLinesCount.js\");\n\r\n\r\n\r\n\r\n\r\nconst IsPlainObject = Phaser.Utils.Objects.IsPlainObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass TextBlock extends _basesizer_BaseSizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, x, y, minWidth, minHeight, config) {\r\n        if (IsPlainObject(x)) {\r\n            config = x;\r\n            x = GetValue(config, 'x', 0);\r\n            y = GetValue(config, 'y', 0);\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        } else if (IsPlainObject(minWidth)) {\r\n            config = minWidth;\r\n            minWidth = GetValue(config, 'width', undefined);\r\n            minHeight = GetValue(config, 'height', undefined);\r\n        }\r\n\r\n        super(scene, x, y, minWidth, minHeight, config);\r\n\r\n        this.type = 'rexTextBlock';\r\n        this.textObject = undefined;\r\n        this.textMask = undefined;\r\n        this.textObjectType = undefined;\r\n        this.lines = undefined; // array (default text object), or pens-manager (tag text object)\r\n        this.text = GetValue(config, 'content', '');\r\n        this._textOY = 0;\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n\r\n        this.setClampMode(GetValue(config, 'clamplTextOY', true));\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var textObject = GetValue(config, 'text', undefined);\r\n        if (textObject === undefined) {\r\n            textObject = createDefaultTextObject(scene);\r\n        }\r\n        var textMaskEnable = GetValue(config, 'textMask', true);\r\n\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        this.setTextObject(textObject, textMaskEnable);\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('text', textObject);\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.textObject = undefined;\r\n        this.textMask = undefined;\r\n        if (this.lines === undefined) {\r\n            // Do nothing\r\n        } else if (this.textObjectType === 0) {\r\n            this.lines.length = 0;\r\n        } else {\r\n            this.lines.destroy();\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampTextOYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get textLineHeight() {\r\n        var style = this.textObject.style;\r\n        return style.metrics.fontSize + style.strokeThickness;\r\n    }\r\n\r\n    get textLineSpacing() {\r\n        return this.textObject.lineSpacing;\r\n    }\r\n\r\n    get linesCount() {\r\n        var count;\r\n        if (this.lines === undefined) {\r\n            count = 0;\r\n        } else if (this.textObjectType === 0) {\r\n            count = this.lines.length;\r\n        } else {\r\n            count = this.lines.linesCount;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    get visibleLinesCount() {\r\n        return Math.floor(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].call(this, this.textObject.height));\r\n    }\r\n\r\n    get topTextOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomTextOY() {\r\n        return -this.textVisibleHeight;\r\n    }\r\n\r\n    get textHeight() {\r\n        return _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].call(this, this.linesCount);\r\n    }\r\n\r\n    get textObjectHeight() {\r\n        return this.textObject.height - this.textLineHeight - this.textLineSpacing; // Remove 1 text line\r\n    }\r\n\r\n    get textVisibleHeight() {\r\n        var h;\r\n        var textHeight = this.textHeight;\r\n        var textObjectHeight = this.textObjectHeight;\r\n        if (textHeight > textObjectHeight) {\r\n            h = textHeight - textObjectHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    textOYExceedTop(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.textOY;\r\n        }\r\n        return (oy > this.topTextOY);\r\n    }\r\n\r\n    textOYExeceedBottom(oy) {\r\n        if (oy === undefined) {\r\n            oy = this.textOY;\r\n        }\r\n        return (oy < this.bottomTextOY);\r\n    }\r\n\r\n    get textOY() {\r\n        return this._textOY;\r\n    }\r\n\r\n    set textOY(oy) {\r\n        var topTextOY = this.topTextOY;\r\n        var bottomTextOY = this.bottomTextOY;\r\n        var textOYExceedTop = this.textOYExceedTop(oy);\r\n        var textOYExeceedBottom = this.textOYExeceedBottom(oy);\r\n\r\n        if (this.clampTextOYMode) {\r\n            if (this.visibleLinesCount > this.linesCount) {\r\n                oy = 0;\r\n            } else if (textOYExceedTop) {\r\n                oy = topTextOY\r\n            } else if (textOYExeceedBottom) {\r\n                oy = bottomTextOY;\r\n            }\r\n        }\r\n\r\n        if (this._textOY !== oy) {\r\n            this._textOY = oy;\r\n            this.updateTextObject();\r\n        }\r\n\r\n        if (textOYExceedTop) {\r\n            if (!this.execeedTopState) {\r\n                this.emit('execeedtop', this, oy, topTextOY);\r\n            }\r\n        }\r\n        this.execeedTopState = textOYExceedTop;\r\n\r\n        if (textOYExeceedBottom) {\r\n            if (!this.execeedBottomState) {\r\n                this.emit('execeedbottom', this, oy, bottomTextOY);\r\n            }\r\n        }\r\n        this.execeedBottomState = textOYExeceedBottom;\r\n    }\r\n\r\n    setTextOY(oy) {\r\n        this.textOY = oy;\r\n        return this;\r\n    }\r\n\r\n    set t(value) {\r\n        this.textOY = -this.textVisibleHeight * value;\r\n    }\r\n\r\n    get t() {\r\n        var textVisibleHeight = this.textVisibleHeight;\r\n        if (textVisibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.textOY / -textVisibleHeight);\r\n    }\r\n\r\n    setTextOYByPercentage(percentage) {\r\n        this.t = percentage;\r\n        return this;\r\n    }\r\n}\r\n\r\nvar createDefaultTextObject = function (scene) {\r\n    return scene.add.text(0, 0, '');\r\n};\r\n\r\nObject.assign(\r\n    TextBlock.prototype,\r\n    _Methods_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (TextBlock);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/TextBlock.js?")},"./lib/rexui/lib/ui/textblock/TextHeightToLinesCount.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar TextHeightToLinesCount = function (height) {\r\n    // height = (maxLines * (lineHeight + lineSpacing)) - lineSpacing\r\n    return (height - this.textLineSpacing) / (this.textLineHeight + this.textLineSpacing);\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (TextHeightToLinesCount);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/TextHeightToLinesCount.js?')},"./lib/rexui/lib/ui/textblock/UpdateTextObject.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TextHeightToLinesCount.js */ "./lib/rexui/lib/ui/textblock/TextHeightToLinesCount.js");\n/* harmony import */ var _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LinesCountToTextHeight.js */ "./lib/rexui/lib/ui/textblock/LinesCountToTextHeight.js");\n/* harmony import */ var _GetLines_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GetLines.js */ "./lib/rexui/lib/ui/textblock/GetLines.js");\n/* harmony import */ var _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ResetTextObjectPosition.js */ "./lib/rexui/lib/ui/textblock/ResetTextObjectPosition.js");\n\r\n\r\n\r\n\r\n\r\nvar UpdateTextObject = function () {\r\n    var startLineIndex = Math.max(Math.floor(_TextHeightToLinesCount_js__WEBPACK_IMPORTED_MODULE_0__["default"].call(this, -this.textOY)), 0);\r\n    var textOffset = _LinesCountToTextHeight_js__WEBPACK_IMPORTED_MODULE_1__["default"].call(this, startLineIndex) + this.textOY;\r\n\r\n    this.textObject.setText(_GetLines_js__WEBPACK_IMPORTED_MODULE_2__["default"].call(this, startLineIndex));\r\n    this.textObject.rexSizer.offsetY = textOffset;\r\n    _ResetTextObjectPosition_js__WEBPACK_IMPORTED_MODULE_3__["default"].call(this);\r\n    return this;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateTextObject);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/textblock/UpdateTextObject.js?')},"./lib/rexui/lib/ui/tool/Tool.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Tool", function() { return Tool; });\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar Tool = /** @class */ (function () {\r\n    function Tool() {\r\n    }\r\n    Tool.checkPointerContains = function (gameObject, pointer) {\r\n        var left = -gameObject.width / 2;\r\n        var right = gameObject.width / 2;\r\n        var top = -gameObject.height / 2;\r\n        var bottom = gameObject.height / 2;\r\n        if (pointer) {\r\n            var worldMatrix = gameObject.getWorldTransformMatrix();\r\n            var x = pointer.x - worldMatrix.tx;\r\n            var y = pointer.y - worldMatrix.ty;\r\n            if (left <= x && right >= x && top <= y && bottom >= y) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    };\r\n    Tool.getTransfrom = function (config) {\r\n        return !config ? undefined : config.transform;\r\n    };\r\n    Tool.getPos = function (transform) {\r\n        var pos = { x: 0, y: 0 };\r\n        if (!transform) {\r\n            return pos;\r\n        }\r\n        var tmpValue;\r\n        var width = GetValue(transform, "width", 0);\r\n        var height = GetValue(transform, "height", 0);\r\n        if (transform.x === undefined) {\r\n            transform.x = 0;\r\n        }\r\n        if (transform.y === undefined) {\r\n            transform.y = 0;\r\n        }\r\n        if (typeof (transform.x) === "string") {\r\n            tmpValue = GetValue(transform, "x", "100%");\r\n            pos.x = Number(tmpValue.split("%")[0]) * width;\r\n        }\r\n        else {\r\n            pos.x = GetValue(transform, "x", 0);\r\n        }\r\n        if (typeof (transform.y) === "string") {\r\n            tmpValue = GetValue(transform, "y", "100%");\r\n            pos.y = Number(tmpValue.split("%")[0]) * height;\r\n        }\r\n        else {\r\n            pos.y = GetValue(transform, "y", 0);\r\n        }\r\n        return pos;\r\n    };\r\n    Tool.checkNinePatch = function (align) {\r\n        if (align.top || align.bottom || align.right || align.left) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    return Tool;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/tool/Tool.ts?')},"./lib/rexui/lib/ui/ui-components.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! phaser */ "./node_modules/phaser/dist/phaser.js-exposed");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./roundrectangle/RoundRectangle.js */ "./lib/rexui/lib/ui/roundrectangle/RoundRectangle.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RoundRectangle", function() { return _roundrectangle_RoundRectangle_js__WEBPACK_IMPORTED_MODULE_1__["default"]; });\n\n/* harmony import */ var _bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bbcodetext/BBCodeText.js */ "./lib/rexui/lib/ui/bbcodetext/BBCodeText.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BBCodeText", function() { return _bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"]; });\n\n/* harmony import */ var _tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tagtext/TagText.js */ "./lib/rexui/lib/ui/tagtext/TagText.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TagText", function() { return _tagtext_TagText_js__WEBPACK_IMPORTED_MODULE_3__["default"]; });\n\n/* harmony import */ var _container_Container_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./container/Container.js */ "./lib/rexui/lib/ui/container/Container.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Container", function() { return _container_Container_js__WEBPACK_IMPORTED_MODULE_4__["default"]; });\n\n/* harmony import */ var _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./canvas/Canvas.js */ "./lib/rexui/lib/ui/canvas/Canvas.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Canvas", function() { return _canvas_Canvas_js__WEBPACK_IMPORTED_MODULE_5__["default"]; });\n\n/* harmony import */ var _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ninepatch/NineSlicePatch */ "./lib/rexui/lib/ui/ninepatch/NineSlicePatch.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NineSlicePatch", function() { return _ninepatch_NineSlicePatch__WEBPACK_IMPORTED_MODULE_6__["NineSlicePatch"]; });\n\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./sizer/Sizer.js */ "./lib/rexui/lib/ui/sizer/Sizer.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Sizer", function() { return _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_7__["default"]; });\n\n/* harmony import */ var _gridsizer_GridSizer_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./gridsizer/GridSizer.js */ "./lib/rexui/lib/ui/gridsizer/GridSizer.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GridSizer", function() { return _gridsizer_GridSizer_js__WEBPACK_IMPORTED_MODULE_8__["default"]; });\n\n/* harmony import */ var _label_Label_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./label/Label.js */ "./lib/rexui/lib/ui/label/Label.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Label", function() { return _label_Label_js__WEBPACK_IMPORTED_MODULE_9__["default"]; });\n\n/* harmony import */ var _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./buttons/Buttons.js */ "./lib/rexui/lib/ui/buttons/Buttons.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Buttons", function() { return _buttons_Buttons_js__WEBPACK_IMPORTED_MODULE_10__["default"]; });\n\n/* harmony import */ var _button_Button__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Button", function() { return _button_Button__WEBPACK_IMPORTED_MODULE_11__["Button"]; });\n\n/* harmony import */ var _slider_Slider_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./slider/Slider.js */ "./lib/rexui/lib/ui/slider/Slider.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Slider", function() { return _slider_Slider_js__WEBPACK_IMPORTED_MODULE_12__["default"]; });\n\n/* harmony import */ var _gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./gridtable/GridTable.js */ "./lib/rexui/lib/ui/gridtable/GridTable.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GridTable", function() { return _gridtable_GridTable_js__WEBPACK_IMPORTED_MODULE_13__["default"]; });\n\n/* harmony import */ var _menu_Menu_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./menu/Menu.js */ "./lib/rexui/lib/ui/menu/Menu.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Menu", function() { return _menu_Menu_js__WEBPACK_IMPORTED_MODULE_14__["default"]; });\n\n/* harmony import */ var _textBox_TextBox__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./textBox/TextBox */ "./lib/rexui/lib/ui/textBox/TextBox.ts");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextBox", function() { return _textBox_TextBox__WEBPACK_IMPORTED_MODULE_15__["TextBox"]; });\n\n/* harmony import */ var _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./textblock/TextBlock.js */ "./lib/rexui/lib/ui/textblock/TextBlock.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextBlock", function() { return _textblock_TextBlock_js__WEBPACK_IMPORTED_MODULE_16__["default"]; });\n\n/* harmony import */ var _textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./textarea/TextArea.js */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextArea", function() { return _textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_17__["default"]; });\n\n/* harmony import */ var _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./scrollableblock/ScrollableBlock.js */ "./lib/rexui/lib/ui/scrollableblock/ScrollableBlock.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScrollableBlock", function() { return _scrollableblock_ScrollableBlock_js__WEBPACK_IMPORTED_MODULE_18__["default"]; });\n\n/* harmony import */ var _scrollablepanel_ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./scrollablepanel/ScrollablePanel.js */ "./lib/rexui/lib/ui/scrollablepanel/ScrollablePanel.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScrollablePanel", function() { return _scrollablepanel_ScrollablePanel_js__WEBPACK_IMPORTED_MODULE_19__["default"]; });\n\n/* harmony import */ var _tap_Tap_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./tap/Tap.js */ "./lib/rexui/lib/ui/tap/Tap.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Tap", function() { return _tap_Tap_js__WEBPACK_IMPORTED_MODULE_20__["default"]; });\n\n/* harmony import */ var _press_Press_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./press/Press.js */ "./lib/rexui/lib/ui/press/Press.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Press", function() { return _press_Press_js__WEBPACK_IMPORTED_MODULE_21__["default"]; });\n\n/* harmony import */ var _rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./rotate/Rotate.js */ "./lib/rexui/lib/ui/rotate/Rotate.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Rotate", function() { return _rotate_Rotate_js__WEBPACK_IMPORTED_MODULE_22__["default"]; });\n\n/* harmony import */ var _flip_Flip_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./flip/Flip.js */ "./lib/rexui/lib/ui/flip/Flip.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Flip", function() { return _flip_Flip_js__WEBPACK_IMPORTED_MODULE_23__["default"]; });\n\n/* harmony import */ var _utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./utils/GetParentSizer.js */ "./lib/rexui/lib/ui/utils/GetParentSizer.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GetParentSizer", function() { return _utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_24__["default"]; });\n\n/* harmony import */ var _utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./utils/GetTopmostSizer.js */ "./lib/rexui/lib/ui/utils/GetTopmostSizer.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GetTopmostSizer", function() { return _utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_25__["default"]; });\n\n/* harmony import */ var _plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../plugins/utils/input/IsPointerInBounds.js */ "./lib/rexui/lib/plugins/utils/input/IsPointerInBounds.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "IsPointerInBounds", function() { return _plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_26__["default"]; });\n\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/Hide.js */ "./lib/rexui/lib/ui/utils/Hide.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Show", function() { return _utils_Hide_js__WEBPACK_IMPORTED_MODULE_27__["Show"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Hide", function() { return _utils_Hide_js__WEBPACK_IMPORTED_MODULE_27__["Hide"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "IsShown", function() { return _utils_Hide_js__WEBPACK_IMPORTED_MODULE_27__["IsShown"]; });\n\n/* harmony import */ var _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../plugins/behaviors/textedit/Edit.js */ "./lib/rexui/lib/plugins/behaviors/textedit/Edit.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Edit", function() { return _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_28__["default"]; });\n\n/* harmony import */ var _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./utils/WaitEvent.js */ "./lib/rexui/lib/ui/utils/WaitEvent.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WaitEvent", function() { return _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_29__["WaitEvent"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WaitComplete", function() { return _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_29__["WaitComplete"]; });\n\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ui-components.ts?')},"./lib/rexui/lib/ui/ui-plugin.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ObjectFactory.js */ "./lib/rexui/lib/ui/ObjectFactory.js");\n/* harmony import */ var _roundrectangle_Factory_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./roundrectangle/Factory.js */ "./lib/rexui/lib/ui/roundrectangle/Factory.js");\n/* harmony import */ var _bbcodetext_Factory_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bbcodetext/Factory.js */ "./lib/rexui/lib/ui/bbcodetext/Factory.js");\n/* harmony import */ var _tagtext_Factory_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./tagtext/Factory.js */ "./lib/rexui/lib/ui/tagtext/Factory.js");\n/* harmony import */ var _container_Factory_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./container/Factory.js */ "./lib/rexui/lib/ui/container/Factory.js");\n/* harmony import */ var _canvas_Factory_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./canvas/Factory.js */ "./lib/rexui/lib/ui/canvas/Factory.js");\n/* harmony import */ var _circlemaskimage_Factory_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./circlemaskimage/Factory.js */ "./lib/rexui/lib/ui/circlemaskimage/Factory.js");\n/* harmony import */ var _ninepatch_Factory_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ninepatch/Factory.js */ "./lib/rexui/lib/ui/ninepatch/Factory.js");\n/* harmony import */ var _sizer_Factory_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./sizer/Factory.js */ "./lib/rexui/lib/ui/sizer/Factory.js");\n/* harmony import */ var _gridsizer_Factory_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./gridsizer/Factory.js */ "./lib/rexui/lib/ui/gridsizer/Factory.js");\n/* harmony import */ var _label_Factory_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./label/Factory.js */ "./lib/rexui/lib/ui/label/Factory.js");\n/* harmony import */ var _buttons_Factory_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./buttons/Factory.js */ "./lib/rexui/lib/ui/buttons/Factory.js");\n/* harmony import */ var _slider_Factory_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./slider/Factory.js */ "./lib/rexui/lib/ui/slider/Factory.js");\n/* harmony import */ var _gridtable_Factory_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./gridtable/Factory.js */ "./lib/rexui/lib/ui/gridtable/Factory.js");\n/* harmony import */ var _gridtable_Factory_js__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_gridtable_Factory_js__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var _menu_Factory_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./menu/Factory.js */ "./lib/rexui/lib/ui/menu/Factory.js");\n/* harmony import */ var _textblock_Factory_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./textblock/Factory.js */ "./lib/rexui/lib/ui/textblock/Factory.js");\n/* harmony import */ var _textarea_Factory_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./textarea/Factory.js */ "./lib/rexui/lib/ui/textarea/Factory.js");\n/* harmony import */ var _scrollableblock_Factory_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./scrollableblock/Factory.js */ "./lib/rexui/lib/ui/scrollableblock/Factory.js");\n/* harmony import */ var _scrollablepanel_Factory_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./scrollablepanel/Factory.js */ "./lib/rexui/lib/ui/scrollablepanel/Factory.js");\n/* harmony import */ var _tap_Factory_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./tap/Factory.js */ "./lib/rexui/lib/ui/tap/Factory.js");\n/* harmony import */ var _press_Factory_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./press/Factory.js */ "./lib/rexui/lib/ui/press/Factory.js");\n/* harmony import */ var _swipe_Factory_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./swipe/Factory.js */ "./lib/rexui/lib/ui/swipe/Factory.js");\n/* harmony import */ var _pan_Factory_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./pan/Factory.js */ "./lib/rexui/lib/ui/pan/Factory.js");\n/* harmony import */ var _pinch_Factory_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./pinch/Factory.js */ "./lib/rexui/lib/ui/pinch/Factory.js");\n/* harmony import */ var _rotate_Factory_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./rotate/Factory.js */ "./lib/rexui/lib/ui/rotate/Factory.js");\n/* harmony import */ var _flip_Factory_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./flip/Factory.js */ "./lib/rexui/lib/ui/flip/Factory.js");\n/* harmony import */ var _utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./utils/GetParentSizer.js */ "./lib/rexui/lib/ui/utils/GetParentSizer.js");\n/* harmony import */ var _utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/GetTopmostSizer.js */ "./lib/rexui/lib/ui/utils/GetTopmostSizer.js");\n/* harmony import */ var _plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../plugins/utils/input/IsPointerInBounds.js */ "./lib/rexui/lib/plugins/utils/input/IsPointerInBounds.js");\n/* harmony import */ var _utils_Hide_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./utils/Hide.js */ "./lib/rexui/lib/ui/utils/Hide.js");\n/* harmony import */ var _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../plugins/behaviors/textedit/Edit.js */ "./lib/rexui/lib/plugins/behaviors/textedit/Edit.js");\n/* harmony import */ var _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./utils/WaitEvent.js */ "./lib/rexui/lib/ui/utils/WaitEvent.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import ChartFactory from \'./chart/Factory.js\';\r\n\r\n// import YoutubePlayerFactory from \'./youtubeplayer/Factory.js\';\r\n\r\n\r\n\r\n//import FixWidthSizerFactory from \'./fixwidthsizer/Factory.js\';\r\n//import OverlapSizerFactory from \'./overlapsizer/Factory.js\';\r\n\r\n\r\n\r\n// import DialogFactory from \'./dialog/Factory.js\';\r\n//import TabsFactory from \'./tabs/Factory.js\';\r\n\r\n\r\n\r\n// import TextBoxFactory from \'./textbox/Factory.js\';\r\n// import NumberBarFactory from \'./numberbar/Factory.js\';\r\n// import PagesFactory from \'./pages/Factory.js\';\r\n\r\n\r\n\r\n\r\n// import ToastFactory from \'./toast/Factory.js\';\r\n// import SidesFactory from \'./sides/Factory.js\';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass UIPlugin extends Phaser.Plugins.ScenePlugin {\r\n    constructor(scene, pluginManager) {\r\n        super(scene, pluginManager);\r\n\r\n        this.add = new _ObjectFactory_js__WEBPACK_IMPORTED_MODULE_0__["default"](scene);\r\n    }\r\n}\r\n\r\nvar methods = {\r\n    getParentSizer: _utils_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_26__["default"],\r\n    getTopmostSizer: _utils_GetTopmostSizer_js__WEBPACK_IMPORTED_MODULE_27__["default"],\r\n    hide: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_29__["Hide"],\r\n    show: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_29__["Show"],\r\n    isShown: _utils_Hide_js__WEBPACK_IMPORTED_MODULE_29__["IsShown"],\r\n    edit: _plugins_behaviors_textedit_Edit_js__WEBPACK_IMPORTED_MODULE_30__["default"],\r\n    isInTouching: _plugins_utils_input_IsPointerInBounds_js__WEBPACK_IMPORTED_MODULE_28__["default"],\r\n    waitEvent: _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_31__["WaitEvent"],\r\n    waitComplete: _utils_WaitEvent_js__WEBPACK_IMPORTED_MODULE_31__["WaitComplete"]\r\n}\r\n\r\nObject.assign(\r\n    UIPlugin.prototype,\r\n    methods\r\n);\r\n\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UIPlugin);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/ui-plugin.js?')},"./lib/rexui/lib/ui/utils/AddChildMask.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/mask/DefaultMask.js */ "./lib/rexui/lib/plugins/utils/mask/DefaultMask.js");\n\r\n\r\nvar AddChildMask = function (maskTarget, sizeTarget, shape, padding) {\r\n    var maskGameObject = new _plugins_utils_mask_DefaultMask_js__WEBPACK_IMPORTED_MODULE_0__["default"](sizeTarget, shape, padding); // A Graphics game object\r\n    if (maskTarget && !maskTarget.isRexSizer) { // Sizer game object can\'t apply mask\r\n        maskTarget.setMask(maskGameObject.createGeometryMask());\r\n    }\r\n    this.pin(maskGameObject);\r\n    return maskGameObject;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (AddChildMask);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/AddChildMask.js?')},"./lib/rexui/lib/ui/utils/AlignConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst ALIGN = Phaser.Display.Align;\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    center: ALIGN.CENTER,\r\n    left: ALIGN.LEFT_CENTER,\r\n    right: ALIGN.RIGHT_CENTER,\r\n    top: ALIGN.TOP_CENTER,\r\n    bottom: ALIGN.BOTTOM_CENTER,\r\n\r\n    'left-top': ALIGN.TOP_LEFT,\r\n    'left-center': ALIGN.LEFT_CENTER,\r\n    'left-bottom': ALIGN.BOTTOM_LEFT,\r\n    'center-top': ALIGN.TOP_CENTER,\r\n    'center-center': ALIGN.CENTER,\r\n    'center-bottom': ALIGN.BOTTOM_CENTER,\r\n    'right-top': ALIGN.TOP_RIGHT,\r\n    'right-center': ALIGN.RIGHT_CENTER,\r\n    'right-bottom': ALIGN.BOTTOM_RIGHT\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/AlignConst.js?")},"./lib/rexui/lib/ui/utils/GetBoundsConfig.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nvar GetBoundsConfig = function (config, out) {\r\n    if (out === undefined) {\r\n        out = {};\r\n    }\r\n    if (typeof (config) === 'number') {\r\n        out.left = config;\r\n        out.right = config;\r\n        out.top = config;\r\n        out.bottom = config;\r\n    } else {\r\n        out.left = GetValue(config, 'left', 0);\r\n        out.right = GetValue(config, 'right', 0);\r\n        out.top = GetValue(config, 'top', 0);\r\n        out.bottom = GetValue(config, 'bottom', 0);\r\n    }\r\n    return out;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetBoundsConfig);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/GetBoundsConfig.js?")},"./lib/rexui/lib/ui/utils/GetParentSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetSizerConfig.js */ "./lib/rexui/lib/ui/utils/GetSizerConfig.js");\n\r\n/**\r\n * @function tooqinui.Utils.GetParentSizer\r\n * @param {*} gameObject \r\n * @return {*}\r\n */\r\nvar GetParentSizer = function (gameObject) {\r\n    return Object(_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject).parent;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetParentSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/GetParentSizer.js?')},"./lib/rexui/lib/ui/utils/GetScrollMode.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ScrollModeConst.js */ \"./lib/rexui/lib/ui/utils/ScrollModeConst.js\");\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar GetScrollMode = function (config, key) {\r\n    if (key === undefined) {\r\n        key = 'scrollMode';\r\n    }\r\n    var scrollMode = GetValue(config, 'scrollMode', 0); // Vertical\r\n    if (typeof (scrollMode) === 'string') {\r\n        scrollMode = _ScrollModeConst_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"][scrollMode];\r\n    }\r\n    return scrollMode;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetScrollMode);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/GetScrollMode.js?")},"./lib/rexui/lib/ui/utils/GetSizerConfig.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GetSizerConfig = function (gameObject) {\r\n    if (!gameObject.hasOwnProperty('rexSizer')) {\r\n        gameObject.rexSizer = {};\r\n    }\r\n    return gameObject.rexSizer;\r\n}\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (GetSizerConfig);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/GetSizerConfig.js?")},"./lib/rexui/lib/ui/utils/GetTopmostSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _GetParentSizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetParentSizer.js */ "./lib/rexui/lib/ui/utils/GetParentSizer.js");\n\r\n/**\r\n * @function tooqinui.Utils.GetTopmostSizer\r\n * @param {*} gameObject \r\n * @return {*}\r\n */\r\nvar GetTopmostSizer = function (gameObject) {\r\n    var parent = Object(_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject);\r\n    while (parent) {\r\n        gameObject = parent;\r\n        parent = Object(_GetParentSizer_js__WEBPACK_IMPORTED_MODULE_0__["default"])(parent);\r\n    }\r\n    return gameObject;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (GetTopmostSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/GetTopmostSizer.js?')},"./lib/rexui/lib/ui/utils/Hide.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Show", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Hide", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IsShown", function() { return IsShown; });\n/* harmony import */ var _GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./GetSizerConfig.js */ "./lib/rexui/lib/ui/utils/GetSizerConfig.js");\n\r\n\r\nvar Show = function (gameObject) {\r\n    _hide(gameObject, false);\r\n};\r\n\r\nvar Hide = function (gameObject) {\r\n    _hide(gameObject, true);\r\n};\r\n\r\nvar IsShown = function(gameObject) {\r\n    if (!gameObject) {\r\n        return false;\r\n    }\r\n    var config = Object(_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject);\r\n    return !config.hidden;\r\n}\r\n\r\nvar _hide = function (gameObject, hidden) {\r\n    if (!gameObject) {\r\n        return;\r\n    }\r\n    var config = Object(_GetSizerConfig_js__WEBPACK_IMPORTED_MODULE_0__["default"])(gameObject);\r\n    config.hidden = hidden;\r\n    gameObject.setVisible(!hidden);\r\n};\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/Hide.js?')},"./lib/rexui/lib/ui/utils/OrientationConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n    x: 0,\r\n    h: 0,\r\n    horizontal: 0,\r\n    'left-to-right': 0,\r\n    y: 1,\r\n    v: 1,\r\n    vertical: 1,\r\n    'top-to-bottom': 1\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/OrientationConst.js?")},"./lib/rexui/lib/ui/utils/ScrollModeConst.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__["default"] = ({\r\n    v: 0,\r\n    vertical: 0,\r\n    h: 1,\r\n    horizontal: 1\r\n});\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/ScrollModeConst.js?')},"./lib/rexui/lib/ui/utils/Space.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar Space = function (scene) {\r\n    var gameObject = scene.add.zone(0, 0, 1, 1);\r\n    gameObject.isRexSpace = true;\r\n    return gameObject;\r\n}\r\n/* harmony default export */ __webpack_exports__["default"] = (Space);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/Space.js?')},"./lib/rexui/lib/ui/utils/WaitEvent.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugins/utils/promise/WaitEvent.js */ "./lib/rexui/lib/plugins/utils/promise/WaitEvent.js");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WaitEvent", function() { return _plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_0__["WaitEvent"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WaitComplete", function() { return _plugins_utils_promise_WaitEvent_js__WEBPACK_IMPORTED_MODULE_0__["WaitComplete"]; });\n\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/WaitEvent.js?')},"./lib/rexui/lib/ui/utils/scrollable/CreateScrollableSizer.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sizer/Sizer.js */ \"./lib/rexui/lib/ui/sizer/Sizer.js\");\n/* harmony import */ var _GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GetScrollMode.js */ \"./lib/rexui/lib/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _slider_Slider_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../slider/Slider.js */ \"./lib/rexui/lib/ui/slider/Slider.js\");\n/* harmony import */ var _plugins_scroller_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugins/scroller.js */ \"./lib/rexui/lib/plugins/scroller.js\");\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nvar CreateScrollableSizer = function (config) {\r\n    var scene = this.scene;\r\n    var scrollMode = Object(_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config);\r\n    var scrollableSizer = new _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](scene, { orientation: scrollMode });\r\n\r\n    var child = GetValue(config, 'child.gameObject', undefined);\r\n    var sliderConfig = GetValue(config, 'slider', undefined), slider;\r\n    var scrollerConfig = GetValue(config, 'scroller', true), scroller;\r\n\r\n    // Child, slider, scroller\r\n    if (child) {\r\n        var childSpace = GetValue(config, 'space.child', 0);\r\n        this.childPadding = {};\r\n        if (typeof (childSpace) !== 'number') {\r\n            var childPadding = childSpace;\r\n            if (scrollMode === 0) {\r\n                childSpace = GetValue(childPadding, 'right', 0);\r\n                this.childPadding.top = GetValue(childPadding, 'top', 0);\r\n                this.childPadding.bottom = GetValue(childPadding, 'bottom', 0);\r\n            } else {\r\n                childSpace = GetValue(childPadding, 'bottom', 0);\r\n                this.childPadding.top = GetValue(childPadding, 'left', 0);\r\n                this.childPadding.bottom = GetValue(childPadding, 'right', 0);\r\n            }\r\n        } else {\r\n            this.childPadding.top = 0;\r\n            this.childPadding.bottom = 0;\r\n        }\r\n\r\n        var proportion = GetValue(config, 'child.proportion', 1);\r\n        var expand = GetValue(config, 'child.expand', true);\r\n        var padding;\r\n        if (scrollMode === 0) {\r\n            padding = {\r\n                right: (sliderConfig) ? childSpace : 0,\r\n            };\r\n        } else {\r\n            padding = {\r\n                bottom: (sliderConfig) ? childSpace : 0\r\n            };\r\n        }\r\n        scrollableSizer.add(child, proportion, 'center', padding, expand);\r\n\r\n        if (sliderConfig) {\r\n            if (sliderConfig === true) {\r\n                sliderConfig = {};\r\n            }\r\n            sliderConfig.orientation = scrollableSizer.orientation;\r\n            slider = new _slider_Slider_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"](scene, sliderConfig);\r\n            scrollableSizer.add(slider, 0, 'center', 0, true);\r\n        }\r\n\r\n\r\n        if (scrollerConfig) {\r\n            if (scrollerConfig === true) {\r\n                scrollerConfig = {};\r\n            }\r\n            scrollerConfig.orientation = scrollMode;\r\n            scroller = new _plugins_scroller_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](child, scrollerConfig);\r\n        }\r\n    }\r\n\r\n    // Control\r\n    if (slider) {\r\n        slider.on('valuechange', function (newValue) {\r\n            this.t = newValue;\r\n        }, this);\r\n    }\r\n    if (scroller) {\r\n        scroller.on('valuechange', function (newValue) {\r\n            this.childOY = newValue;\r\n        }, this);\r\n    }\r\n\r\n    this.addChildrenMap('child', child);\r\n    this.addChildrenMap('slider', slider);\r\n    this.addChildrenMap('scroller', scroller);\r\n\r\n    return scrollableSizer;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (CreateScrollableSizer);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/scrollable/CreateScrollableSizer.js?")},"./lib/rexui/lib/ui/utils/scrollable/ResizeController.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar ResizeController = function () {\r\n    var topChildOY = this.topChildOY;\r\n    var bottomChildOY = this.bottomChildOY;\r\n    var scroller = this.childrenMap.scroller;\r\n    var slider = this.childrenMap.slider;\r\n    if (scroller) {\r\n        scroller.setBounds(bottomChildOY, topChildOY);\r\n    }\r\n    if (slider) {\r\n        slider.setEnable(bottomChildOY !== topChildOY);\r\n    }\r\n    this.updateController();\r\n    return this;\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ResizeController);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/scrollable/ResizeController.js?')},"./lib/rexui/lib/ui/utils/scrollable/Scrollable.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sizer/Sizer.js */ \"./lib/rexui/lib/ui/sizer/Sizer.js\");\n/* harmony import */ var _GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GetScrollMode.js */ \"./lib/rexui/lib/ui/utils/GetScrollMode.js\");\n/* harmony import */ var _CreateScrollableSizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CreateScrollableSizer.js */ \"./lib/rexui/lib/ui/utils/scrollable/CreateScrollableSizer.js\");\n/* harmony import */ var _ResizeController_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ResizeController.js */ \"./lib/rexui/lib/ui/utils/scrollable/ResizeController.js\");\n/* harmony import */ var _UpdateController_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./UpdateController.js */ \"./lib/rexui/lib/ui/utils/scrollable/UpdateController.js\");\n\r\n\r\n\r\n\r\n\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nclass Scrollable extends _sizer_Sizer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\r\n    constructor(scene, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n\r\n        var scrollMode = Object(_GetScrollMode_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(config); // Left-to-right, or top-to-bottom\r\n        // Create sizer\r\n        config.orientation = (scrollMode === 0) ? 1 : 0;\r\n        super(scene, config);\r\n        this.type = GetValue(config, 'type', 'rexScrollable');\r\n\r\n        // Add elements\r\n        var background = GetValue(config, 'background', undefined);\r\n        var scrollableSizer = _CreateScrollableSizer_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].call(this, config);\r\n        var header = GetValue(config, 'header', undefined);\r\n        var footer = GetValue(config, 'footer', undefined);\r\n\r\n        // Space\r\n        var paddingLeft = GetValue(config, 'space.left', 0);\r\n        var paddingRight = GetValue(config, 'space.right', 0);\r\n        var paddingTop = GetValue(config, 'space.top', 0);\r\n        var paddingBottom = GetValue(config, 'space.bottom', 0);\r\n\r\n        // Background\r\n        if (background) {\r\n            this.addBackground(background);\r\n        }\r\n\r\n        if (header) {\r\n            var align = GetValue(config, 'align.header', 'center');\r\n            var headerSpace = GetValue(config, 'space.header', 0);\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: headerSpace,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: headerSpace,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            var expand = GetValue(config, 'expand.header', true);\r\n            this.add(header, 0, align, padding, expand);\r\n        }\r\n\r\n        if (scrollableSizer) {\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: (header) ? 0 : paddingTop,\r\n                    bottom: (footer) ? 0 : paddingBottom,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: (header) ? 0 : paddingLeft,\r\n                    right: (footer) ? 0 : paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            this.add(scrollableSizer, 1, 'center', padding, true);\r\n        }\r\n\r\n        if (footer) {\r\n            var align = GetValue(config, 'align.footer', 'center');\r\n            var footerSpace = GetValue(config, 'space.footer', 0);\r\n            var padding;\r\n            if (scrollMode === 0) {\r\n                padding = {\r\n                    left: paddingLeft,\r\n                    right: paddingRight,\r\n                    top: footerSpace,\r\n                    bottom: paddingBottom,\r\n                };\r\n            } else {\r\n                padding = {\r\n                    left: footerSpace,\r\n                    right: paddingRight,\r\n                    top: paddingTop,\r\n                    bottom: paddingBottom,\r\n                };\r\n            }\r\n            var expand = GetValue(config, 'expand.footer', true);\r\n            this.add(footer, 0, align, padding, expand);\r\n        }\r\n\r\n        this.addChildrenMap('background', background);\r\n        this.addChildrenMap('header', header);\r\n        this.addChildrenMap('footer', footer);\r\n\r\n        // Necessary properties of child object\r\n        // child.t (RW), child.childOY (RW), child.topChildOY (R), child.bottomChildOY (R)\r\n    }\r\n\r\n    layout(parent, newWidth, newHeight) {\r\n        super.layout(parent, newWidth, newHeight);\r\n        this.resizeController();\r\n        return this;\r\n    }\r\n\r\n    set t(t) {\r\n        // Get inner childT\r\n        var childPadding = this.childPadding;\r\n        if ((childPadding.top !== 0) || (childPadding.bottom !== 0)) {\r\n            var child = this.childrenMap.child\r\n            var innerHeight = (child.topChildOY - child.bottomChildOY);\r\n            var outterHeight = innerHeight + childPadding.top + childPadding.bottom;\r\n            var innerChildOY = (outterHeight * t) - childPadding.top;\r\n            t = innerChildOY / innerHeight;\r\n        }\r\n\r\n        this.childrenMap.child.t = t;\r\n        this.updateController();\r\n    }\r\n\r\n    get t() {\r\n        var t = this.childrenMap.child.t;\r\n\r\n        // Get outter childT\r\n        var childPadding = this.childPadding;\r\n        if ((childPadding.top !== 0) || (childPadding.bottom !== 0)) {\r\n            var child = this.childrenMap.child\r\n            var innerHeight = (child.topChildOY - child.bottomChildOY);\r\n            var outterHeight = innerHeight + childPadding.top + childPadding.bottom;\r\n            var outterChildOY = (innerHeight * t) + childPadding.top;\r\n            t = outterChildOY / outterHeight;\r\n        }\r\n        return t;\r\n    }\r\n\r\n    set childOY(value) {\r\n        this.childrenMap.child.childOY = value;\r\n        this.updateController();\r\n    }\r\n\r\n    get childOY() {\r\n        return this.childrenMap.child.childOY;\r\n    }\r\n\r\n    get topChildOY() {\r\n        return this.childrenMap.child.topChildOY + this.childPadding.top;\r\n    }\r\n\r\n    get bottomChildOY() {\r\n        return this.childrenMap.child.bottomChildOY - this.childPadding.bottom;\r\n    }\r\n\r\n    setChildOY(value) {\r\n        this.childOY = value;\r\n        return this;\r\n    }\r\n\r\n    setT(value) {\r\n        this.t = value;\r\n        return this;\r\n    }\r\n\r\n    scrollToTop() {\r\n        this.t = 0;\r\n        return this;\r\n    }\r\n\r\n    scrollToBottom() {\r\n        this.t = 1;\r\n        return this;\r\n    }\r\n\r\n    get sliderEnable() {\r\n        var slider = this.childrenMap.slider;\r\n        if (!slider) {\r\n            return undefined;\r\n        }\r\n\r\n        return slider.enable;\r\n    }\r\n\r\n    set sliderEnable(value) {\r\n        var slider = this.childrenMap.slider;\r\n        if (!slider) {\r\n            return;\r\n        }\r\n        slider.setEnable(value);\r\n    }\r\n\r\n    setSliderEnable(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.sliderEnable = enabled;\r\n        return this;\r\n    }\r\n\r\n    get scrollerEnable() {\r\n        var scroller = this.childrenMap.scroller;\r\n        if (!scroller) {\r\n            return undefined;\r\n        }\r\n\r\n        return scroller.enable;\r\n    }\r\n\r\n    set scrollerEnable(value) {\r\n        var scroller = this.childrenMap.scroller;\r\n        if (!scroller) {\r\n            return;\r\n        }\r\n        scroller.setEnable(value);\r\n    }\r\n\r\n    setScrollerEnable(enabled) {\r\n        if (enabled === undefined) {\r\n            enabled = true;\r\n        }\r\n        this.scrollerEnable = enabled;\r\n        return this;\r\n    }\r\n}\r\n\r\nvar Methods = {\r\n    resizeController: _ResizeController_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\r\n    updateController: _UpdateController_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"]\r\n}\r\n\r\n// mixin\r\nObject.assign(\r\n    Scrollable.prototype,\r\n    Methods\r\n);\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Scrollable);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/scrollable/Scrollable.js?")},"./lib/rexui/lib/ui/utils/scrollable/UpdateController.js":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\nvar UpdateController = function () {\r\n    var scroller = this.childrenMap.scroller;\r\n    var slider = this.childrenMap.slider;\r\n    if (scroller) {\r\n        scroller.setValue(this.childOY);\r\n    }\r\n    if (slider) {\r\n        slider.setValue(this.t);\r\n    }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (UpdateController);\n\n//# sourceURL=webpack://TooqingCore/./lib/rexui/lib/ui/utils/scrollable/UpdateController.js?')},"./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/heartbeatworker.ts":function(module,exports,__webpack_require__){eval('module.exports = function() {\n  return new Worker(__webpack_require__.p + "js/e30a64c7eb622b70017e.heartbeatworker.js");\n};\n\n//# sourceURL=webpack://TooqingCore/./src/net/heartbeatworker.ts?./node_modules/worker-loader/dist/cjs.js?name=js/0aa3.%5Bname%5D.js')},"./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/networker.ts":function(module,exports,__webpack_require__){eval('module.exports = function() {\n  return new Worker(__webpack_require__.p + "js/6f1cfb7def36ecbe013f.networker.js");\n};\n\n//# sourceURL=webpack://TooqingCore/./src/net/networker.ts?./node_modules/worker-loader/dist/cjs.js?name=js/bba7.%5Bname%5D.js')},"./src/Handler/Handler.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Handler", function() { return Handler; });\nvar Handler = /** @class */ (function () {\r\n    /**\r\n     * 根据指定的属性值，创建一个 <code>Handler</code> 类的实例。\r\n     * @param\tcaller 执行域。\r\n     * @param\tmethod 处理函数。\r\n     * @param\targs 函数参数。\r\n     * @param\tonce 是否只执行一次。\r\n     */\r\n    function Handler(caller, method, args, once) {\r\n        if (caller === void 0) { caller = null; }\r\n        if (method === void 0) { method = null; }\r\n        if (args === void 0) { args = null; }\r\n        if (once === void 0) { once = false; }\r\n        this.once = false;\r\n        this._id = 0;\r\n        this.setTo(caller, method, args, once);\r\n    }\r\n    /**\r\n     * 从对象池内创建一个Handler，默认会执行一次并立即回收，如果不需要自动回收，设置once参数为false。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 回调方法。\r\n     * @param\targs 携带的参数。\r\n     * @param\tonce 是否只执行一次，如果为true，回调后执行recover()进行回收，默认为true。\r\n     * @return  返回创建的handler实例。\r\n     */\r\n    Handler.create = function (caller, method, args, once) {\r\n        if (args === void 0) { args = null; }\r\n        if (once === void 0) { once = true; }\r\n        if (Handler._pool.length)\r\n            return Handler._pool.pop().setTo(caller, method, args, once);\r\n        return new Handler(caller, method, args, once);\r\n    };\r\n    /**\r\n     * 设置此对象的指定属性值。\r\n     * @param\tcaller 执行域(this)。\r\n     * @param\tmethod 回调方法。\r\n     * @param\targs 携带的参数。\r\n     * @param\tonce 是否只执行一次，如果为true，执行后执行recover()进行回收。\r\n     * @return  返回 handler 本身。\r\n     */\r\n    Handler.prototype.setTo = function (caller, method, args, once) {\r\n        this._id = Handler._gid++;\r\n        this.caller = caller;\r\n        this.method = method;\r\n        this.args = args;\r\n        this.once = once;\r\n        return this;\r\n    };\r\n    /**\r\n     * 执行处理器。\r\n     */\r\n    Handler.prototype.run = function () {\r\n        if (this.method == null)\r\n            return null;\r\n        var id = this._id;\r\n        var result = this.method.apply(this.caller, this.args);\r\n        // tslint:disable-next-line: no-unused-expression\r\n        this._id === id && this.once && this.recover();\r\n        return result;\r\n    };\r\n    /**\r\n     * 执行处理器，携带额外数据。\r\n     * @param\tdata 附加的回调数据，可以是单数据或者Array(作为多参)。\r\n     */\r\n    Handler.prototype.runWith = function (data) {\r\n        if (this.method == null)\r\n            return null;\r\n        var id = this._id;\r\n        if (data == null)\r\n            // tslint:disable-next-line: no-var-keyword\r\n            var result = this.method.apply(this.caller, this.args);\r\n        else if (!this.args && !(data instanceof Array))\r\n            result = this.method.call(this.caller, data);\r\n        // tslint:disable-next-line: comment-format\r\n        else if (this.args)\r\n            result = this.method.apply(this.caller, this.args.concat(data));\r\n        else\r\n            result = this.method.apply(this.caller, data);\r\n        // tslint:disable-next-line: no-unused-expression\r\n        this._id === id && this.once && this.recover();\r\n        return result;\r\n    };\r\n    /**\r\n     * 清理对象引用。\r\n     */\r\n    Handler.prototype.clear = function () {\r\n        this.caller = null;\r\n        this.method = null;\r\n        this.args = null;\r\n        return this;\r\n    };\r\n    /**\r\n     * 清理并回收到 Handler 对象池内。\r\n     */\r\n    Handler.prototype.recover = function () {\r\n        if (this._id > 0) {\r\n            this._id = 0;\r\n            Handler._pool.push(this.clear());\r\n        }\r\n    };\r\n    /*[DISABLE-ADD-VARIABLE-DEFAULT-VALUE]*/\r\n    Handler._pool = [];\r\n    Handler._gid = 1;\r\n    return Handler;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/Handler/Handler.ts?')},"./src/Handler/HandlerDispatcher.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HandlerDispatcher", function() { return HandlerDispatcher; });\n/* harmony import */ var _Handler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Handler */ "./src/Handler/Handler.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar HandlerDispatcher = /** @class */ (function () {\r\n    function HandlerDispatcher() {\r\n    }\r\n    HandlerDispatcher.prototype.hasListener = function (type) {\r\n        var listener = this._events && this._events[type];\r\n        return !!listener;\r\n    };\r\n    HandlerDispatcher.prototype.emitter = function (type, data) {\r\n        if (data === void 0) { data = null; }\r\n        if (!this._events || !this._events[type])\r\n            return false;\r\n        var listeners = this._events[type];\r\n        if (listeners.run) {\r\n            if (listeners.once)\r\n                delete this._events[type];\r\n            data != null ? listeners.runWith(data) : listeners.run();\r\n        }\r\n        else {\r\n            for (var i = 0, n = listeners.length; i < n; i++) {\r\n                var listener = listeners[i];\r\n                if (listener) {\r\n                    (data != null) ? listener.runWith(data) : listener.run();\r\n                }\r\n                if (!listener || listener.once) {\r\n                    listeners.splice(i, 1);\r\n                    i--;\r\n                    n--;\r\n                }\r\n            }\r\n            if (listeners.length === 0 && this._events)\r\n                delete this._events[type];\r\n        }\r\n        return true;\r\n    };\r\n    HandlerDispatcher.prototype.on = function (type, caller, listener, args) {\r\n        if (args === void 0) { args = null; }\r\n        return this._createListener(type, caller, listener, args, false);\r\n    };\r\n    HandlerDispatcher.prototype.once = function (type, caller, listener, args) {\r\n        if (args === void 0) { args = null; }\r\n        return this._createListener(type, caller, listener, args, true);\r\n    };\r\n    HandlerDispatcher.prototype.off = function (type, caller, listener, onceOnly) {\r\n        if (onceOnly === void 0) { onceOnly = false; }\r\n        if (!this._events || !this._events[type])\r\n            return this;\r\n        var listeners = this._events[type];\r\n        if (listener != null) {\r\n            if (listeners.run) {\r\n                if ((!caller || listeners.caller === caller) && listeners.method === listener && (!onceOnly || listeners.once)) {\r\n                    delete this._events[type];\r\n                    listeners.recover();\r\n                }\r\n            }\r\n            else {\r\n                var count = 0;\r\n                var len = listeners.length;\r\n                for (var i = 0, n = listeners.length; i < n; i++) {\r\n                    var item = listeners[i];\r\n                    if (item && (!caller || item.caller === caller) && item.method === listener && (!onceOnly || item.once)) {\r\n                        count++;\r\n                        listeners[i] = null;\r\n                        item.recover();\r\n                    }\r\n                }\r\n                if (count === len)\r\n                    delete this._events[type];\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    HandlerDispatcher.prototype.offAll = function (type) {\r\n        if (type === void 0) { type = null; }\r\n        var events = this._events;\r\n        if (!events)\r\n            return this;\r\n        if (type) {\r\n            this._recoverHandlers(events[type]);\r\n            delete events[type];\r\n        }\r\n        else {\r\n            for (var name_1 in events) {\r\n                this._recoverHandlers(events[name_1]);\r\n            }\r\n            this._events = null;\r\n        }\r\n        return this;\r\n    };\r\n    HandlerDispatcher.prototype.destroy = function () {\r\n        this.offAll();\r\n    };\r\n    HandlerDispatcher.prototype._createListener = function (type, caller, listener, args, once, offBefore) {\r\n        if (offBefore === void 0) { offBefore = true; }\r\n        if (offBefore)\r\n            this.off(type, caller, listener, once);\r\n        var handler = EventHandler.create(caller || this, listener, args, once);\r\n        if (!this._events)\r\n            this._events = {};\r\n        var events = this._events;\r\n        if (!events[type])\r\n            events[type] = handler;\r\n        else {\r\n            if (!events[type].run)\r\n                events[type].push(handler);\r\n            else\r\n                events[type] = [events[type], handler];\r\n        }\r\n        return this;\r\n    };\r\n    HandlerDispatcher.prototype._recoverHandlers = function (arr) {\r\n        if (!arr)\r\n            return;\r\n        if (arr.run) {\r\n            arr.recover();\r\n        }\r\n        else {\r\n            for (var i = arr.length - 1; i > -1; i--) {\r\n                if (arr[i]) {\r\n                    arr[i].recover();\r\n                    arr[i] = null;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return HandlerDispatcher;\r\n}());\r\n\r\nvar EventHandler = /** @class */ (function (_super) {\r\n    __extends(EventHandler, _super);\r\n    function EventHandler(caller, method, args, once) {\r\n        return _super.call(this, caller, method, args, once) || this;\r\n    }\r\n    EventHandler.create = function (caller, method, args, once) {\r\n        if (args === void 0) { args = null; }\r\n        if (once === void 0) { once = true; }\r\n        if (EventHandler._mpool.length)\r\n            return EventHandler._mpool.pop().setTo(caller, method, args, once);\r\n        return new EventHandler(caller, method, args, once);\r\n    };\r\n    EventHandler.prototype.recover = function () {\r\n        if (this._id > 0) {\r\n            this._id = 0;\r\n            EventHandler._mpool.push(this.clear());\r\n        }\r\n    };\r\n    EventHandler._mpool = [];\r\n    return EventHandler;\r\n}(_Handler__WEBPACK_IMPORTED_MODULE_0__["Handler"]));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/Handler/HandlerDispatcher.ts?')},"./src/const/MessageType.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageType", function() { return MessageType; });\n/**\r\n * 系统消息定义\r\n * author aaron\r\n */\r\nvar MessageType = /** @class */ (function () {\r\n    function MessageType() {\r\n    }\r\n    MessageType.CREATE_ROLE = "create_role";\r\n    MessageType.APP_START = "app_start";\r\n    MessageType.EDITOR_CHANGE_MODE = "editor_change_mode";\r\n    MessageType.CLIENT_RESIZE = "app_client_resize";\r\n    MessageType.SCENE_INITIALIZED = "SCENE_INITIALIZED";\r\n    MessageType.SCENE_CLEARED = "SCENE_CLEARED";\r\n    MessageType.SCENE_CHANGE_TO = "SCENE_CHANGE_TO";\r\n    MessageType.SCENE_MOVE_TO = "scene_move_to";\r\n    MessageType.SCENE_MOVE_STOP = "scene_move_stop";\r\n    MessageType.CHANGE_ELEMENT_ANIMATION = "change_element_animation";\r\n    MessageType.CHANGE_CHARACTER_ANIMATION = "change_character_animation";\r\n    MessageType.CHAT_TO = "chat_to";\r\n    MessageType.SHOW_CHAT_BUBBLE = "show_chat_bubble";\r\n    MessageType.REMOVE_CHAT_BUBBLE = "remove_chat_bubble";\r\n    MessageType.PROMPT_ALERT = "prompt_alert";\r\n    MessageType.CHARACTER_TALING = "characterTaling";\r\n    MessageType.CHARACTER_SHUT_UP = "characterShutUp";\r\n    /// never start\r\n    MessageType.QCLOUD_AUTH = "qcloud_auth";\r\n    MessageType.ENTER_SCENE = "enter_scene";\r\n    /// never end\r\n    MessageType.SCENE_ADD_PLAYER = "scene_add_player";\r\n    MessageType.SCENE_REMOVE_PLAYER = "scene_remove_player";\r\n    MessageType.SCENE_UPDATE_PLAYER = "scene_update_player";\r\n    MessageType.SCENE_ADD_ELEMENT = "scene_add_element";\r\n    MessageType.SCENE_ADD_TERRAIN = "scene_add_terrain";\r\n    MessageType.SCENE_ADD_TERRAIN_END = "scene_add_terrain_end";\r\n    MessageType.SCENE_ADD_ALL_TERRAIN = "scene_add_all_terrain";\r\n    MessageType.SCENE_REMOVE_ELEMENT = "scene_remove_element";\r\n    MessageType.SCENE_REMOVE_TERRAIN = "scene_remove_terrain";\r\n    MessageType.SCENE_REMOVE_ALL_TERRAIN = "scene_remove_all_terrain";\r\n    MessageType.SCENE_MOUSE_FOLLOW = "scene_mouse_follow";\r\n    MessageType.SCENE_SELECT_ELEMENT = "scene_select_element";\r\n    MessageType.SCENE_FIXED_TO_ELEMENT = "scene_fixed_to_element";\r\n    MessageType.SCENE_UPDATE_ELEMENT = "sceneUpdateElement";\r\n    MessageType.SCENE_SYNCHRO_PACKAGE = "sceneSynchroPackage";\r\n    MessageType.SCENE_VISIBLE_GRID = "sceneVisibleGrid";\r\n    MessageType.PLAYER_SELECT_CHARACTER = "player_select_character";\r\n    MessageType.PLAYER_DATA_INITIALIZE = "player_data_initialize";\r\n    MessageType.SCENE_DATA_INITIALIZE = "scene_data_initialize";\r\n    MessageType.PACKAGE_ITEM_ADD = "package_item_add";\r\n    MessageType.PACKAGE_ITEM_REMOVE = "package_item_remove";\r\n    MessageType.PACKAGE_EXCHANGE_ITEM_POS = "package_exchange_item_pos";\r\n    MessageType.SCENE_BACKGROUND_CLICK = "SCENE_BACKGROUND_CLICK";\r\n    MessageType.CHANGE_SELF_AVATAR = "CHANGE_SELF_AVATAR";\r\n    MessageType.DRAG_TO_DROP = "DRAG_TO_DROP";\r\n    MessageType.DRAG_OVER_DROP = "DRAG_OVER_DROP";\r\n    MessageType.QUERY_PACKAGE = "query_package";\r\n    MessageType.SYNC_USER_BALANCE = "syncUserBalance";\r\n    MessageType.UPDATED_CHARACTER_PACKAGE = "updatedCharacterPackage";\r\n    MessageType.SHOW_EFFECT = "showEffect";\r\n    MessageType.EDIT_MODE_QUERY_PACKAGE = "editModeQueryPackage";\r\n    MessageType.PRESS_ELEMENT = "PRESS_ELEMENT";\r\n    // 旋转物件\r\n    MessageType.TURN_ELEMENT = "turnElement";\r\n    // 回收\r\n    MessageType.RECYCLE_ELEMENT = "recycleElement";\r\n    // 放置\r\n    MessageType.PUT_ELEMENT = "putElement";\r\n    MessageType.CANCEL_PUT = "cancelPut";\r\n    // 展开物件容器\r\n    MessageType.EDIT_PACKAGE_EXPANED = "editPackageExpaned";\r\n    // 收起物件容器\r\n    MessageType.EDIT_PACKAGE_COLLAPSE = "editPackageCollapse";\r\n    MessageType.SELECTED_DECORATE_ELEMENT = "selectedDecorateElement";\r\n    MessageType.CANCEL_DECORATE_ELEMENT = "cancelDecorateElement";\r\n    MessageType.ADD_ICON_TO_TOP = "addIconToTop";\r\n    MessageType.REMOVE_ICON_FROM_TOP = "removeIconFromTop";\r\n    MessageType.SHOW_UI = "showUI";\r\n    MessageType.SHOW_NOTICE = "showNotice";\r\n    return MessageType;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/MessageType.ts?')},"./src/const/brush.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BrushEnum", function() { return BrushEnum; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Brush", function() { return Brush; });\nvar BrushEnum;\r\n(function (BrushEnum) {\r\n    BrushEnum["MOVE"] = "move";\r\n    BrushEnum["BRUSH"] = "brush";\r\n    BrushEnum["SELECT"] = "select";\r\n    BrushEnum["ERASER"] = "eraser";\r\n    BrushEnum["FILL"] = "FILL";\r\n})(BrushEnum || (BrushEnum = {}));\r\nvar Brush = /** @class */ (function () {\r\n    function Brush(mEditorRoom) {\r\n        this.mEditorRoom = mEditorRoom;\r\n        this.mMode = BrushEnum.SELECT;\r\n    }\r\n    Object.defineProperty(Brush.prototype, "mode", {\r\n        get: function () {\r\n            return this.mMode;\r\n        },\r\n        set: function (mode) {\r\n            this.mMode = mode;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Brush;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/brush.ts?')},"./src/const/constants.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PI_EXTENSION_REGEX", function() { return PI_EXTENSION_REGEX; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTP_REGEX", function() { return HTTP_REGEX; });\nvar PI_EXTENSION_REGEX = /\\.pi$/i;\r\nvar HTTP_REGEX = /^(http|https):/i;\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/constants.ts?')},"./src/const/res.const.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UI", function() { return UI; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n\r\nvar UI;\r\n(function (UI) {\r\n    var TuDing18 = /** @class */ (function () {\r\n        function TuDing18() {\r\n        }\r\n        TuDing18.getName = function () {\r\n            return "ui_moneyIcon_tuding_18_png";\r\n        };\r\n        TuDing18.getPNG = function () {\r\n            return _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("ui/moneyIcon/tuding_18.png");\r\n        };\r\n        return TuDing18;\r\n    }());\r\n    UI.TuDing18 = TuDing18;\r\n})(UI || (UI = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/const/res.const.ts?')},"./src/game/account.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });\nvar Account = /** @class */ (function () {\r\n    function Account() {\r\n        // TODO\r\n        // 1. 登陆注册的逻辑在这里做\r\n        // 2. 缓存用户登陆后的帐号咨讯\r\n    }\r\n    Account.prototype.setAccount = function (val) {\r\n        this.mCurAccountData = {\r\n            token: "",\r\n            expire: 0,\r\n            fingerprint: "",\r\n        };\r\n        Object.assign(this.mCurAccountData, val);\r\n    };\r\n    Object.defineProperty(Account.prototype, "accountData", {\r\n        get: function () {\r\n            return this.mCurAccountData;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Account;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/account.ts?')},"./src/game/element.storage.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorage", function() { return ElementStorage; });\n/* harmony import */ var _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../rooms/display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _rooms_display_animation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rooms/display/animation */ "./src/rooms/display/animation.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n\r\n\r\n\r\n\r\n\r\nvar ElementStorage = /** @class */ (function () {\r\n    function ElementStorage() {\r\n        this.mModels = new Map();\r\n        this.mElementRef = new Map();\r\n        this.terrainPalette = new Map();\r\n        this.terrainPaletteWithBindId = new Map();\r\n        this.mossPalette = new Map();\r\n        this.event = new Phaser.Events.EventEmitter();\r\n    }\r\n    ElementStorage.prototype.on = function (event, fn, context) {\r\n        this.event.on(event, fn, context);\r\n    };\r\n    ElementStorage.prototype.off = function (event, fn, context) {\r\n        this.event.off(event, fn, context);\r\n    };\r\n    ElementStorage.prototype.setGameConfig = function (config) {\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().log("TCL: ElementStorage -> config", config);\r\n        if (!config) {\r\n            return;\r\n        }\r\n        var objs = config.objectsList;\r\n        var displayModel = null;\r\n        for (var _i = 0, objs_1 = objs; _i < objs_1.length; _i++) {\r\n            var obj = objs_1[_i];\r\n            if (obj.type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType) {\r\n                displayModel = this.mModels.get(obj.id);\r\n                if (!displayModel) {\r\n                    var anis = [];\r\n                    var eleAnis = obj.animations;\r\n                    var objAnis = eleAnis.animationData;\r\n                    for (var _a = 0, objAnis_1 = objAnis; _a < objAnis_1.length; _a++) {\r\n                        var ani = objAnis_1[_a];\r\n                        anis.push(new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_3__["Animation"](ani.createProtocolObject()));\r\n                    }\r\n                    displayModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                        id: obj.id,\r\n                        sn: obj.sn,\r\n                        animations: {\r\n                            defaultAnimationName: eleAnis.defaultAnimationName,\r\n                            display: eleAnis.display,\r\n                            animationData: anis,\r\n                        },\r\n                    });\r\n                    this.mModels.set(obj.id, displayModel);\r\n                }\r\n                var ele = {\r\n                    id: obj.id,\r\n                    displayModel: displayModel,\r\n                };\r\n                this.mElementRef.set(obj.id, ele);\r\n            }\r\n        }\r\n        this.updatePalette(config.root.palette);\r\n        this.updateMoss(config.root.moss);\r\n        this.updateAssets(config.root.assets);\r\n    };\r\n    ElementStorage.prototype.updatePalette = function (palette) {\r\n        for (var _i = 0, _a = Array.from(palette.peersDict.keys()); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            var terrainPalette = palette.peersDict.get(key);\r\n            var terrainModel = this.terrainPalette.get(terrainPalette.id);\r\n            if (!terrainModel) {\r\n                var frameModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                    id: terrainPalette.id,\r\n                    sn: terrainPalette.sn,\r\n                    animations: {\r\n                        defaultAnimationName: terrainPalette.animations.defaultAnimationName,\r\n                        display: terrainPalette.animations.display,\r\n                        animationData: terrainPalette.animations.animationData.map(function (ani) { return new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_3__["Animation"](ani.createProtocolObject()); }),\r\n                    },\r\n                });\r\n                this.terrainPalette.set(key, frameModel);\r\n                this.terrainPaletteWithBindId.set(terrainPalette.id, frameModel);\r\n            }\r\n        }\r\n    };\r\n    ElementStorage.prototype.updateMoss = function (moss) {\r\n        for (var _i = 0, _a = Array.from(moss.peersDict.keys()); _i < _a.length; _i++) {\r\n            var peerKey = _a[_i];\r\n            var elementMoss = moss.peersDict.get(peerKey);\r\n            var elementModel = this.mossPalette.get(elementMoss.id);\r\n            if (!elementModel) {\r\n                var frameModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                    id: elementMoss.id,\r\n                    sn: elementMoss.sn,\r\n                    animations: {\r\n                        defaultAnimationName: elementMoss.animations.defaultAnimationName,\r\n                        display: elementMoss.animations.display,\r\n                        animationData: elementMoss.animations.animationData.map(function (ani) { return new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_3__["Animation"](ani.createProtocolObject()); }),\r\n                    },\r\n                });\r\n                this.mossPalette.set(peerKey, frameModel);\r\n            }\r\n        }\r\n    };\r\n    ElementStorage.prototype.updateAssets = function (assetsNode) {\r\n        var assets = assetsNode.getAssetList();\r\n        this._assets = [];\r\n        for (var _i = 0, assets_1 = assets; _i < assets_1.length; _i++) {\r\n            var asset = assets_1[_i];\r\n            var media = asset.media;\r\n            if (media) {\r\n                var fileType = media.match(/\\.([a-zA-Z0-9]+)($|\\?)/);\r\n                if (fileType && fileType[1]) {\r\n                    this._assets.push({\r\n                        type: fileType[1],\r\n                        key: asset.key,\r\n                        source: _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getOsdRes(media),\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ElementStorage.prototype.setSceneConfig = function (config) {\r\n        var objs = config.objectsList;\r\n        var displayModel = null;\r\n        // TODO Lite deserialize可能会有个别Display link失败\r\n        for (var _i = 0, objs_2 = objs; _i < objs_2.length; _i++) {\r\n            var obj = objs_2[_i];\r\n            if (obj.type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType) {\r\n                displayModel = this.mModels.get(obj.id);\r\n                if (!displayModel) {\r\n                    var anis = [];\r\n                    var eleAnis = obj.animations;\r\n                    var objAnis = eleAnis.animationData;\r\n                    for (var _a = 0, objAnis_2 = objAnis; _a < objAnis_2.length; _a++) {\r\n                        var ani = objAnis_2[_a];\r\n                        anis.push(new _rooms_display_animation__WEBPACK_IMPORTED_MODULE_3__["Animation"](ani.createProtocolObject()));\r\n                    }\r\n                    displayModel = new _rooms_display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                        id: obj.id,\r\n                        sn: obj.sn,\r\n                        animations: {\r\n                            defaultAnimationName: eleAnis.defaultAnimationName,\r\n                            display: eleAnis.display,\r\n                            animationData: anis,\r\n                        },\r\n                    });\r\n                    this.mModels.set(obj.id, displayModel);\r\n                }\r\n                var ele = {\r\n                    id: obj.id,\r\n                    displayModel: displayModel,\r\n                };\r\n                this.mElementRef.set(obj.id, ele);\r\n            }\r\n        }\r\n        var sceneNode = config.root.children.find(function (node) { return node.type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.SceneNodeType; });\r\n        this._terrainCollection = sceneNode.terrainCollection;\r\n        this._mossCollection = sceneNode.mossCollection;\r\n        this._scenerys = sceneNode.getScenerys();\r\n        // const scenerys = sceneNode.getScenerys();\r\n        // this._scenerys = [];\r\n        // for (const scenery of scenerys) {\r\n        //     this._scenerys.push(scenery);\r\n        // }\r\n    };\r\n    ElementStorage.prototype.add = function (obj) {\r\n        this.mModels.set(obj.id, obj);\r\n    };\r\n    ElementStorage.prototype.getDisplayModel = function (id) {\r\n        var ele = this.mElementRef.get(id);\r\n        if (ele) {\r\n            return ele.displayModel;\r\n        }\r\n        // Logger.getInstance().error(`can\'t find element ${id}`);\r\n        return;\r\n    };\r\n    ElementStorage.prototype.getTerrainCollection = function () {\r\n        return this._terrainCollection;\r\n    };\r\n    ElementStorage.prototype.getTerrainPalette = function (key) {\r\n        if (this.terrainPalette.get(key)) {\r\n            return this.terrainPalette.get(key);\r\n        }\r\n    };\r\n    ElementStorage.prototype.getTerrainPaletteByBindId = function (id) {\r\n        if (this.terrainPaletteWithBindId.get(id)) {\r\n            return this.terrainPaletteWithBindId.get(id);\r\n        }\r\n    };\r\n    ElementStorage.prototype.getMossCollection = function () {\r\n        return this._mossCollection;\r\n    };\r\n    ElementStorage.prototype.getMossPalette = function (id) {\r\n        if (this.mossPalette.get(id)) {\r\n            return this.mossPalette.get(id);\r\n        }\r\n    };\r\n    ElementStorage.prototype.getScenerys = function () {\r\n        return this._scenerys;\r\n    };\r\n    ElementStorage.prototype.getAssets = function () {\r\n        return this._assets;\r\n    };\r\n    ElementStorage.prototype.destroy = function () {\r\n        this.mElementRef.clear();\r\n        this.terrainPalette.clear();\r\n        this.terrainPaletteWithBindId.clear();\r\n        this.mossPalette.clear();\r\n        this.mModels.forEach(function (model, index) {\r\n            model.destroy();\r\n        });\r\n        this.mModels.clear();\r\n        this._assets = undefined;\r\n    };\r\n    return ElementStorage;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/element.storage.ts?')},"./src/game/joystick.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JoyStickManager", function() { return JoyStickManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JoyStick", function() { return JoyStick; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rooms/element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rooms/decorate.room */ "./src/rooms/decorate.room.ts");\n\r\n\r\n\r\n\r\nvar TEMP_CONST = {\r\n    MOUSE_DOWN: 0,\r\n    MOUSE_MOVE: 1,\r\n    MOUSE_UP: 2,\r\n    TOUCH_START: 3,\r\n    TOUCH_MOVE: 4,\r\n    TOUCH_END: 5,\r\n    POINTER_LOCK_CHANGE: 6,\r\n    TOUCH_CANCEL: 7,\r\n    MOUSE_WHEEL: 8\r\n};\r\nvar JoyStickManager = /** @class */ (function () {\r\n    function JoyStickManager(worldService, keyEvents) {\r\n        this.worldService = worldService;\r\n        this.mEnabled = false;\r\n        // 用于记录room类型，初始化完成后让joystick处理\r\n        this.mOnListener = false;\r\n        this.mJoyListeners = [];\r\n        this.mScale = worldService.uiScale;\r\n        this.mKeyEvents = keyEvents;\r\n        this.mKeyEventMap = new Map();\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().debug("JoyStickManager " + worldService.uiScale);\r\n    }\r\n    JoyStickManager.prototype.onRoomChanged = function (currentRoom, previousRoom) {\r\n        if (!this.mJoyStick) {\r\n            this.mOnListener = currentRoom instanceof _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__["DecorateRoom"] ? false : true;\r\n            return;\r\n        }\r\n        if (currentRoom instanceof _rooms_decorate_room__WEBPACK_IMPORTED_MODULE_3__["DecorateRoom"]) {\r\n            this.mJoyStick.offListener();\r\n        }\r\n        else {\r\n            this.mJoyStick.onListener();\r\n        }\r\n    };\r\n    JoyStickManager.prototype.setScene = function (scene) {\r\n        this.mScene = scene;\r\n        if (!this.mScene || !this.mKeyEvents)\r\n            return;\r\n        var len = this.mKeyEvents.length;\r\n        var keyEvent;\r\n        var codes;\r\n        var eventName;\r\n        for (var i = 0; i < len; i++) {\r\n            keyEvent = this.mKeyEvents[i];\r\n            codes = keyEvent.keyCodes;\r\n            eventName = keyEvent.tqEvent;\r\n            if (!this.mKeyEventMap.get(eventName)) {\r\n                this.mKeyEventMap.set(eventName, keyEvent);\r\n            }\r\n        }\r\n        this.mKeyEvents.length = 0;\r\n        this.mKeyEvents = null;\r\n        this.mParentcon = this.mScene.add.container(0, 0); // (150, size.height - 150);\r\n        var scale = !this.mScale ? 1 : this.mScale;\r\n        this.mJoyStick = new JoyStick(this.mScene, this.worldService, this.mParentcon, this.mJoyListeners, scale);\r\n        if (this.mOnListener) {\r\n            this.mJoyStick.onListener();\r\n        }\r\n        else {\r\n            this.mJoyStick.offListener();\r\n        }\r\n    };\r\n    JoyStickManager.prototype.resize = function () {\r\n        if (!this.mParentcon)\r\n            return;\r\n        this.mParentcon.scaleX = this.mParentcon.scaleY = this.worldService.uiScale;\r\n        // const size: Size = this.worldService.getSize();\r\n        // const mainUIMed = this.worldService.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // const padHei: number = !mainUIMed ? this.mParentcon.height : (mainUIMed.getView() as MainUIMobile).getBottomView().height;\r\n        // if (this.mParentcon) {\r\n        //     if (this.worldService.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n        //         this.mParentcon.x = this.mParentcon.width * this.worldService.uiScale;\r\n        //         this.mParentcon.y = size.height - this.mParentcon.height * this.worldService.uiScale;\r\n        //     } else {\r\n        //         this.mParentcon.x = this.mParentcon.width * this.worldService.uiScale;\r\n        //         this.mParentcon.y = size.height - (padHei + this.mParentcon.height) * this.worldService.uiScale;\r\n        //     }\r\n        //     this.mParentcon.scaleX = this.mParentcon.scaleY = this.worldService.uiScale;\r\n        // }\r\n    };\r\n    JoyStickManager.prototype.tweenView = function (show) {\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.mParentcon.visible = show;\r\n        // const size: Size = this.worldService.getSize();\r\n        // let baseX: number;\r\n        // let baseY: number;\r\n        // const mainUIMed = this.worldService.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // const padHei: number = !mainUIMed ? this.mParentcon.height : (mainUIMed.getView() as MainUIMobile).getBottomView().height;\r\n        // if (this.worldService.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n        //     baseX = this.mParentcon.width * this.worldService.uiScale;\r\n        //     baseY = size.height - this.mParentcon.height * this.worldService.uiScale;\r\n        // } else {\r\n        //     baseX = this.mParentcon.width * this.worldService.uiScale;\r\n        //     baseY = size.height - (padHei + this.mParentcon.height) * this.worldService.uiScale;\r\n        // }\r\n        // const toX: number = show === true ? baseX : baseX - this.mParentcon.width;\r\n        // const toY: number = baseY;\r\n        // this.mScene.tweens.add({\r\n        //     targets: this.mParentcon,\r\n        //     duration: 200,\r\n        //     ease: "Linear",\r\n        //     props: {\r\n        //         x: { value: toX },\r\n        //         y: { value: toY },\r\n        //         alpha: { value: toAlpha },\r\n        //     },\r\n        // });\r\n    };\r\n    JoyStickManager.prototype.addListener = function (l) {\r\n        this.mJoyListeners.push(l);\r\n        if (this.mJoyStick) {\r\n            this.mJoyStick.changeListeners(this.mJoyListeners);\r\n        }\r\n    };\r\n    JoyStickManager.prototype.getKeyCodes = function (eventName) {\r\n        if (!this.mKeyEventMap.has(eventName))\r\n            return undefined;\r\n        var len = this.mKeyEventMap.get(eventName).keyCodes.length;\r\n        var keyCodes = [];\r\n        for (var i = 0; i < len; i++) {\r\n            var keyCode = this.mKeyEventMap.get(eventName).keyCodes[i];\r\n            keyCodes.push(keyCode);\r\n        }\r\n        return keyCodes;\r\n    };\r\n    JoyStickManager.prototype.removeListener = function (l) {\r\n        // this.mJoyStick.removeListener(l);\r\n        var idx = this.mJoyListeners.indexOf(l);\r\n        if (idx >= 0) {\r\n            this.mJoyListeners.splice(idx, 1);\r\n        }\r\n        if (this.mJoyStick) {\r\n            this.mJoyStick.changeListeners(this.mJoyListeners);\r\n        }\r\n    };\r\n    JoyStickManager.prototype.getKeyDowns = function () {\r\n        return [];\r\n    };\r\n    JoyStickManager.prototype.getKeyUps = function () {\r\n        return [];\r\n    };\r\n    JoyStickManager.prototype.downHandler = function () {\r\n    };\r\n    JoyStickManager.prototype.upHandler = function () {\r\n    };\r\n    Object.defineProperty(JoyStickManager.prototype, "enable", {\r\n        get: function () {\r\n            return this.mEnabled;\r\n        },\r\n        set: function (val) {\r\n            this.mEnabled = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return JoyStickManager;\r\n}());\r\n\r\nvar JoyStick = /** @class */ (function () {\r\n    function JoyStick(scene, world, parentCon, joyListeners, scale) {\r\n        this.mDown = false;\r\n        this.mScene = scene;\r\n        this.mWorld = world;\r\n        this.parentCon = parentCon;\r\n        this.mJoyListeners = joyListeners;\r\n        this.mScale = scale;\r\n        this.mKeyCodes = [];\r\n        this.load();\r\n    }\r\n    JoyStick.prototype.load = function () {\r\n        this.mScene.load.atlas("joystick", "./resources/ui/joystick/joystick.png", "./resources/ui/joystick/joystick.json");\r\n        this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        this.mScene.load.start();\r\n    };\r\n    JoyStick.prototype.onListener = function () {\r\n        this.mScene.input.on("pointerdown", this.downHandler, this);\r\n        this.mScene.input.on("pointerup", this.upHandler, this);\r\n    };\r\n    JoyStick.prototype.offListener = function () {\r\n        this.parentCon.visible = false;\r\n        this.mScene.input.off("pointermove", this.pointerMove, this);\r\n        this.mScene.input.off("pointerdown", this.downHandler, this);\r\n        this.mScene.input.off("pointerup", this.upHandler, this);\r\n    };\r\n    JoyStick.prototype.changeListeners = function (list) {\r\n        this.mJoyListeners = list;\r\n    };\r\n    JoyStick.prototype.onLoadCompleteHandler = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.bg = this.mScene.make.sprite(undefined, false);\r\n        this.bg.setTexture("joystick", "joystick_bg.png");\r\n        this.bgRadius = this.bg.width + 100 >> 1;\r\n        this.btn = this.mScene.make.sprite(undefined, false);\r\n        this.btn.name = "joystick_btn";\r\n        this.btn.setTexture("joystick", "joystick_tab.png");\r\n        this.btn.x = this.bg.x;\r\n        this.btn.y = this.bg.y;\r\n        this.parentCon.alpha = .5;\r\n        this.parentCon.addAt(this.bg, 0);\r\n        this.parentCon.addAt(this.btn, 1);\r\n        this.btn.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.btn.width, this.btn.height), Phaser.Geom.Rectangle.Contains);\r\n        // this.mScene.input.setDraggable(this.btn);\r\n        // this.mScene.input.on("pointerdown", this.downHandler, this);\r\n        // this.mScene.input.on("pointerup", this.upHandler, this);\r\n        this.parentCon.setSize(this.bg.width, this.bg.height);\r\n        this.parentCon.visible = false;\r\n    };\r\n    // private dragStart(pointer) {\r\n    //     Logger.getInstance().log("dragstart");\r\n    //     this.btn.on("drag", this.dragUpdate, this);\r\n    //     this.btn.off("dragstart", this.dragStart, this);\r\n    //     this.btn.on("dragend", this.dragStop, this);\r\n    //     this.btn.on("dragcancel", this.dragStop, this);\r\n    // }\r\n    JoyStick.prototype.downHandler = function (pointer, gameojectList) {\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        if (this.mDown)\r\n            return;\r\n        if (gameojectList) {\r\n            if (gameojectList.length > 1) {\r\n                return;\r\n            }\r\n            else if (gameojectList.length === 1) {\r\n                if (gameojectList[0].name) {\r\n                    if (gameojectList[0].name !== "joystick_btn") {\r\n                        return;\r\n                    }\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this.mDown = true;\r\n        this.mScene.input.on("pointermove", this.pointerMove, this);\r\n        // 由于app环境下，游戏在浏览器中是全屏模式，所以需要在点击事件上除以当前UIscale调整位置\r\n        this.parentCon.x = pointer.worldX;\r\n        this.parentCon.y = pointer.worldY;\r\n        this.parentCon.visible = true;\r\n        // this.mScene.input.off("pointerdown", this.downHandler, this);\r\n        // this.mScene.input.manager.updateInputPlugins(TEMP_CONST.TOUCH_END, [pointer]);\r\n        // this.btn.on("dragstart", this.dragStart, this);\r\n        // this.mScene.input.manager.updateInputPlugins(TEMP_CONST.TOUCH_START, [pointer]);\r\n        // // phaser 的冒泡事件比较奇葩，没有停止冒泡的参数选项，只会把第一个有返回交互事件的scene返回过来，如果是多层scene，后续scene的交互就会return\r\n        // // 实际是为了防止多个事件派发，其实很蠢，应该给参数让用户自己选择是否派发\r\n        // const play: PlayScene = this.mWorld.game.scene.getScene(PlayScene.name) as PlayScene;\r\n        // if (play) (play.input as any).update(TEMP_CONST.MOUSE_DOWN, [pointer]);\r\n    };\r\n    JoyStick.prototype.pointerMove = function (pointer) {\r\n        var _this = this;\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        var dragX = pointer.worldX - this.parentCon.x;\r\n        var dragY = pointer.worldY - this.parentCon.y;\r\n        var d = Math.sqrt(dragX * dragX + dragY * dragY);\r\n        if (d > this.bgRadius) {\r\n            d = this.bgRadius;\r\n        }\r\n        var r = Math.atan2(dragY, dragX);\r\n        this.btn.x = Math.cos(r) * d;\r\n        this.btn.y = Math.sin(r) * d;\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        var radian = Math.acos(dragX / d);\r\n        if (pointer.worldY > this.parentCon.y) {\r\n            radian = -radian;\r\n        }\r\n        this.mJoyListeners.forEach(function (l) {\r\n            _this.checkdragDown(l, radian);\r\n        });\r\n    };\r\n    // private dragUpdate(pointer, dragX, dragY) {\r\n    //     Logger.getInstance().log("draging");\r\n    //     let d = Math.sqrt(dragX * dragX + dragY * dragY);\r\n    //     if (d > this.bgRadius) {\r\n    //         d = this.bgRadius;\r\n    //     }\r\n    //     const r = Math.atan2(dragY, dragX);\r\n    //     this.btn.x = Math.cos(r) * d + this.bg.x;\r\n    //     this.btn.y = Math.sin(r) * d + this.bg.y;\r\n    //     if (!(this.mWorld.inputManager as JoyStickManager).enable) {\r\n    //         return;\r\n    //     }\r\n    //     this.mJoyListeners.forEach((l: InputListener) => {\r\n    //         this.checkdragDown(l, r);\r\n    //     });\r\n    // }\r\n    JoyStick.prototype.upHandler = function (pointer) {\r\n        var _this = this;\r\n        this.btn.x = this.bg.x;\r\n        this.btn.y = this.bg.y;\r\n        this.mDown = false;\r\n        this.parentCon.visible = false;\r\n        this.mScene.input.off("pointermove", this.pointerMove, this);\r\n        if (!this.mWorld.inputManager.enable) {\r\n            return;\r\n        }\r\n        this.mJoyListeners.forEach(function (l) {\r\n            if (_this.checkdragUp()) {\r\n                l.upHandler();\r\n            }\r\n        });\r\n    };\r\n    JoyStick.prototype.checkdragDown = function (l, r) {\r\n        var dir;\r\n        var keyArr = [];\r\n        var radian = Math.PI * 0.125;\r\n        if (r > -radian && r <= radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].east;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.east");\r\n        }\r\n        else if (r > radian && r <= 3 * radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].east_north;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.east_north");\r\n        }\r\n        else if (r > 3 * radian && r <= 5 * radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].north;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.north");\r\n        }\r\n        else if (r > 5 * radian && r <= 7 * radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].north_west;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.nroth_west");\r\n        }\r\n        else if ((r >= 7 * radian && r <= Math.PI) || (r >= -Math.PI && r < -7 * radian)) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].west;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.west");\r\n        }\r\n        else if (r < -5 * radian && r >= -7 * radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].west_south;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.west_south");\r\n        }\r\n        else if (r > -5 * radian && r <= -3 * radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].south;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.south");\r\n        }\r\n        else if (r > -3 * radian && r <= -radian) {\r\n            dir = _rooms_element_element__WEBPACK_IMPORTED_MODULE_1__["Direction"].south_east;\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().log("dir:Direction.south_east");\r\n        }\r\n        if (dir === undefined) {\r\n            return;\r\n        }\r\n        keyArr = this.getKeys(dir);\r\n        if (this.mdownStr === keyArr.toString())\r\n            return false;\r\n        this.mdownStr = keyArr.toString();\r\n        l.downHandler(dir, keyArr);\r\n        // if (!(this.mWorld.inputManager as JoyStickManager).enable) {\r\n        //     return false;\r\n        // }\r\n        this.mWorld.roomManager.currentRoom.playerManager.actor.setDirection(dir);\r\n        return true;\r\n    };\r\n    JoyStick.prototype.getKeys = function (dir) {\r\n        var keyArr = this.mKeyCodes[dir];\r\n        if (keyArr) {\r\n            return keyArr;\r\n        }\r\n        switch (dir) {\r\n            case 0:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP);\r\n                break;\r\n            case 1:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP).concat, this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT));\r\n                break;\r\n            case 2:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT);\r\n                break;\r\n            case 3:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_LEFT));\r\n                break;\r\n            case 4:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN);\r\n                break;\r\n            case 5:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_DOWN), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT));\r\n                break;\r\n            case 6:\r\n                keyArr = this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT);\r\n                break;\r\n            case 7:\r\n                keyArr = Array.prototype.concat.apply(this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_UP), this.mWorld.inputManager.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT));\r\n                break;\r\n        }\r\n        this.mKeyCodes[dir] = keyArr;\r\n        return keyArr;\r\n    };\r\n    JoyStick.prototype.checkdragUp = function () {\r\n        this.mdownStr = "";\r\n        return true;\r\n    };\r\n    return JoyStick;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/joystick.manager.ts?')},"./src/game/keyboard.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KeyBoardManager", function() { return KeyBoardManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar KeyBoardManager = /** @class */ (function (_super) {\r\n    __extends(KeyBoardManager, _super);\r\n    function KeyBoardManager(worldService, keyEvents) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        // 是否初始化获取到了需要监听的key值列表\r\n        _this.mInitilized = true;\r\n        // 所有需要监听key的监听事件\r\n        _this.mKeyboardListeners = [];\r\n        // this.mCodeList = [37, 38, 39, 40, 65, 87, 68, 83];\r\n        _this.mKeyList = [];\r\n        _this.mKeyDownList = [];\r\n        _this.mKeyEvents = keyEvents;\r\n        _this.mTmpUpKeysStr = "";\r\n        _this.mTmpDownKeyStr = "";\r\n        _this.mKeyEventMap = new Map();\r\n        _this.mConnect = _this.worldService.connection;\r\n        return _this;\r\n    }\r\n    /**\r\n     * world中当scene发生变化时，传入当前激活的scene\r\n     * room由world去休眠/激活\r\n     */\r\n    KeyBoardManager.prototype.onRoomChanged = function (currentRoom, previousRoom) {\r\n        var _this = this;\r\n        this.mRoom = currentRoom;\r\n        this.mScene = currentRoom.scene;\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mKeyEvents) {\r\n            var len = this.mKeyEvents.length;\r\n            var keyEvent = void 0;\r\n            var codes = void 0;\r\n            var eventName = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                keyEvent = this.mKeyEvents[i];\r\n                codes = keyEvent.keyCodes;\r\n                eventName = keyEvent.tqEvent;\r\n                if (!this.mKeyEventMap.get(eventName)) {\r\n                    this.mKeyEventMap.set(eventName, keyEvent);\r\n                }\r\n            }\r\n            this.mKeyEvents.length = 0;\r\n            this.mKeyEvents = null;\r\n        }\r\n        // 暂时屏蔽\r\n        // this.removeKeyEvents();\r\n        this.mKeyEventMap.forEach(function (keyCodeEvent) {\r\n            if (keyCodeEvent) {\r\n                var keyCodes = keyCodeEvent.keyCodes;\r\n                var codesLen = keyCodes.length;\r\n                var keyCode = void 0;\r\n                for (var i = 0; i < codesLen; i++) {\r\n                    keyCode = keyCodes[i];\r\n                    var key = _this.mScene.input.keyboard.addKey(keyCode, false);\r\n                    _this.addKeyEvent(key, keyCodeEvent.tqEvent);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.getKeyCodes = function (eventName) {\r\n        if (!this.mKeyEventMap.has(eventName))\r\n            return undefined;\r\n        return this.mKeyEventMap.get(eventName).keyCodes;\r\n    };\r\n    KeyBoardManager.prototype.resize = function (width, height) {\r\n    };\r\n    KeyBoardManager.prototype.addListener = function (l) {\r\n        this.mKeyboardListeners.push(l);\r\n    };\r\n    KeyBoardManager.prototype.removeListener = function (l) {\r\n        var idx = this.mKeyboardListeners.indexOf(l);\r\n        if (idx >= 0) {\r\n            this.mKeyboardListeners.splice(idx, 1);\r\n        }\r\n    };\r\n    Object.defineProperty(KeyBoardManager.prototype, "enable", {\r\n        get: function () {\r\n            return this.mScene !== undefined ? this.mScene.input.keyboard.enabled : false;\r\n        },\r\n        /**\r\n         * 设置键盘开关\r\n         */\r\n        set: function (value) {\r\n            if (!this.mScene)\r\n                return;\r\n            this.mScene.input.keyboard.enabled = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(KeyBoardManager.prototype, "keyList", {\r\n        get: function () {\r\n            return this.mKeyList;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    KeyBoardManager.prototype.getKeyDowns = function () {\r\n        // let keyCodes: number[] = [];\r\n        if (!this.mInitilized) {\r\n            return [];\r\n        }\r\n        if (!this.mKeyList) {\r\n            return [];\r\n        }\r\n        this.mKeyDownList = this.mKeyList.filter(function (keyDown) { return keyDown.isDown; });\r\n        return this.mKeyDownList.map(function (key) { return key.keyCode; });\r\n    };\r\n    KeyBoardManager.prototype.getKeyUps = function () {\r\n        // 在keyDown列表里面查找是否有键抬起，其余没按的键不必监听\r\n        var keyCodes = [];\r\n        if (!this.mInitilized) {\r\n            return keyCodes;\r\n        }\r\n        if (!this.mKeyDownList) {\r\n            return [];\r\n        }\r\n        var key;\r\n        for (var i = 0; i < this.mKeyDownList.length; i++) {\r\n            key = this.mKeyDownList[i];\r\n            if (key && key.isUp) {\r\n                this.mKeyDownList.splice(i, 1);\r\n                keyCodes.push(key.keyCode);\r\n                i--;\r\n            }\r\n        }\r\n        // this.mKeyDownList = this.mKeyDownList.filter((keyDown) => keyDown.isDown);\r\n        return keyCodes;\r\n    };\r\n    KeyBoardManager.prototype.destroy = function () {\r\n        this.removeKeyEvents();\r\n        if (this.mKeyDownList) {\r\n            this.mKeyDownList.length = 0;\r\n            this.mKeyDownList = null;\r\n        }\r\n        // if (this.mCodeList) {\r\n        //     this.mCodeList.length = 0;\r\n        //     this.mCodeList = null;\r\n        // }\r\n        this.mTmpDownKeyStr = null;\r\n        this.mTmpUpKeysStr = null;\r\n        this.mScene = null;\r\n        this.mConnect = null;\r\n        this.mInitilized = false;\r\n    };\r\n    KeyBoardManager.prototype.concatArr = function (arr1, arr2) {\r\n        var i;\r\n        var len = arr1.length > arr2.length ? arr2.length : arr1.length;\r\n        var parentList = arr1.length > arr2.length ? arr1 : arr2;\r\n        var sonList = arr1.length > arr2.length ? arr2 : arr1;\r\n        for (i = 0; i < len; i++) {\r\n            parentList.push(sonList[i]);\r\n        }\r\n        return parentList;\r\n    };\r\n    KeyBoardManager.prototype.checkMoveKeyDown = function (l) {\r\n        var key;\r\n        var keyList = this.mKeyList;\r\n        var len = keyList.length;\r\n        var keyCodeList = [];\r\n        var keyCode;\r\n        var outPut = 0;\r\n        var keyLeftArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_LEFT);\r\n        var keyDownArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_DOWN);\r\n        var keyRightArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_RIGHT);\r\n        var keyUpArr = this.getKeyCodes(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].TQ_EVENT.TQ_MOVE_UP);\r\n        for (var i = 0; i < len; i++) {\r\n            key = keyList[i];\r\n            keyCode = key.keyCode;\r\n            if (key && key.isDown) {\r\n                keyCodeList.push(key.keyCode);\r\n                if (keyLeftArr) {\r\n                    var left = keyLeftArr.indexOf(keyCode);\r\n                    if (left > -1) {\r\n                        outPut += -1;\r\n                        continue;\r\n                    }\r\n                }\r\n                if (keyRightArr) {\r\n                    var right = keyRightArr.indexOf(keyCode);\r\n                    if (right > -1) {\r\n                        outPut += 1;\r\n                        continue;\r\n                    }\r\n                }\r\n                if (keyDownArr) {\r\n                    var down = keyDownArr.indexOf(keyCode);\r\n                    if (down > -1) {\r\n                        outPut += 3;\r\n                        continue;\r\n                    }\r\n                }\r\n                if (keyUpArr) {\r\n                    var up = keyUpArr.indexOf(keyCode);\r\n                    if (up > -1) {\r\n                        outPut += -3;\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (outPut === 0) {\r\n            return false;\r\n        }\r\n        var curDir = l.getDirection();\r\n        var newDir;\r\n        switch (outPut) {\r\n            case -1:\r\n                newDir = curDir <= 1 ? 1 : 3;\r\n                break;\r\n            case -2:\r\n                newDir = 7;\r\n                break;\r\n            case -3:\r\n                newDir = curDir <= 3 ? 1 : 7;\r\n                break;\r\n            case -4:\r\n                newDir = 1;\r\n                break;\r\n            case 1:\r\n                newDir = curDir <= 5 ? 5 : 7;\r\n                break;\r\n            case 2:\r\n                newDir = 3;\r\n                break;\r\n            case 3:\r\n                newDir = curDir <= 3 ? 3 : 5;\r\n                break;\r\n            case 4:\r\n                newDir = 5;\r\n                break;\r\n        }\r\n        if (this.enable) {\r\n            l.setDirection(newDir);\r\n            l.downHandler(newDir, keyCodeList);\r\n            if (this.mRoom && this.mRoom.playerManager.actor)\r\n                this.mRoom.playerManager.actor.setDirection(newDir);\r\n        }\r\n        return true;\r\n    };\r\n    KeyBoardManager.prototype.checkMoveKeyAllUp = function () {\r\n        var key;\r\n        var keyList = this.mKeyList;\r\n        var len = keyList.length;\r\n        for (var i = 0; i < len; i++) {\r\n            key = keyList[i];\r\n            if (key && key.isDown) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    KeyBoardManager.prototype.addKeyEvent = function (key, eventName) {\r\n        key.on("down", this.keyDownHandle, this);\r\n        key.on("up", this.keyUpHandle, this);\r\n        this.mKeyList.push(key);\r\n    };\r\n    KeyBoardManager.prototype.keyDownHandle = function (e) {\r\n        var _this = this;\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n        var content = pkt.content;\r\n        var keyArr = this.getKeyDowns();\r\n        if (this.mTmpDownKeyStr === keyArr.toString())\r\n            return;\r\n        this.mTmpUpKeysStr = "";\r\n        this.mTmpDownKeyStr = keyArr.toString();\r\n        content.keyCodes = keyArr;\r\n        this.mConnect.send(pkt);\r\n        // then trigger listener\r\n        this.mKeyboardListeners.forEach(function (l) {\r\n            _this.checkMoveKeyDown(l);\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.keyUpHandle = function (e) {\r\n        var _this = this;\r\n        if (!this.enable) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_UP);\r\n        var content = pkt.content;\r\n        var keyArr = this.getKeyUps();\r\n        if (this.mTmpUpKeysStr === keyArr.toString() || keyArr.length < 1)\r\n            return;\r\n        this.mTmpDownKeyStr = "";\r\n        this.mTmpUpKeysStr = keyArr.toString();\r\n        content.keyCodes = keyArr;\r\n        this.mConnect.send(pkt);\r\n        // then trigger listener\r\n        this.mKeyboardListeners.forEach(function (l) {\r\n            if (_this.checkMoveKeyAllUp()) {\r\n                l.upHandler();\r\n                return;\r\n            }\r\n            _this.checkMoveKeyDown(l);\r\n        });\r\n    };\r\n    KeyBoardManager.prototype.removeKeyEvents = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        var key;\r\n        var len = this.mKeyList.length;\r\n        for (var i = 0; i < len; i++) {\r\n            key = this.mKeyList[i];\r\n            if (!key) {\r\n                continue;\r\n            }\r\n            key.off("down", this.keyDownHandle);\r\n            key.off("up", this.keyUpHandle);\r\n            this.mScene.input.keyboard.removeKey(key.keyCode);\r\n        }\r\n        this.mKeyList.length = 0;\r\n        // this.mKeyList = null;\r\n    };\r\n    return KeyBoardManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/keyboard.manager.ts?')},"./src/game/mouse.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseEvent", function() { return MouseEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseManager", function() { return MouseManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _rooms_display_frames_display__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rooms/display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../rooms/element/element */ "./src/rooms/element/element.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar MouseEvent;\r\n(function (MouseEvent) {\r\n    MouseEvent[MouseEvent["RightMouseDown"] = 1] = "RightMouseDown";\r\n    MouseEvent[MouseEvent["RightMouseUp"] = 2] = "RightMouseUp";\r\n    MouseEvent[MouseEvent["LeftMouseDown"] = 3] = "LeftMouseDown";\r\n    MouseEvent[MouseEvent["LeftMouseUp"] = 4] = "LeftMouseUp";\r\n    MouseEvent[MouseEvent["WheelDown"] = 5] = "WheelDown";\r\n    MouseEvent[MouseEvent["WheelUp"] = 6] = "WheelUp";\r\n    MouseEvent[MouseEvent["RightMouseHolding"] = 7] = "RightMouseHolding";\r\n    MouseEvent[MouseEvent["LeftMouseHolding"] = 8] = "LeftMouseHolding";\r\n    MouseEvent[MouseEvent["Tap"] = 9] = "Tap";\r\n})(MouseEvent || (MouseEvent = {}));\r\nvar MouseManager = /** @class */ (function (_super) {\r\n    __extends(MouseManager, _super);\r\n    function MouseManager(worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        _this.running = false;\r\n        _this.mDownDelay = 2000;\r\n        _this.mGame = worldService.game;\r\n        _this.zoom = _this.worldService.scaleRatio || 1;\r\n        _this.mConnect = _this.worldService.connection;\r\n        return _this;\r\n    }\r\n    MouseManager.prototype.changeRoom = function (room) {\r\n        this.pause();\r\n        this.mScene = room.scene;\r\n        this.mRoom = room;\r\n        if (!this.mScene)\r\n            return;\r\n        try {\r\n            room.addMouseListen();\r\n        }\r\n        catch (e) {\r\n        }\r\n        room.scene.input.on("gameobjectdown", this.groundDown, this);\r\n        // room.scene.input.on("gameobjectup", this.groundUp, this);\r\n        room.scene.input.on("pointerdown", this.pointerDownHandler, this);\r\n        room.scene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.resume();\r\n    };\r\n    MouseManager.prototype.resize = function (width, height) {\r\n    };\r\n    MouseManager.prototype.pause = function () {\r\n        this.running = false;\r\n    };\r\n    MouseManager.prototype.resume = function () {\r\n        this.running = true;\r\n    };\r\n    MouseManager.prototype.onUpdate = function (pointer, gameobject) {\r\n        if (this.running === false || pointer === undefined) {\r\n            return;\r\n        }\r\n        var events = [];\r\n        if (pointer.leftButtonDown()) {\r\n            events.push(MouseEvent.LeftMouseDown);\r\n        }\r\n        else if (pointer.leftButtonReleased()) {\r\n            events.push(MouseEvent.LeftMouseUp);\r\n        }\r\n        if (pointer.middleButtonDown()) {\r\n            events.push(MouseEvent.WheelDown);\r\n        }\r\n        else if (pointer.middleButtonReleased()) {\r\n            events.push(MouseEvent.WheelUp);\r\n        }\r\n        if (pointer.rightButtonDown()) {\r\n            events.push(MouseEvent.RightMouseDown);\r\n        }\r\n        else if (pointer.rightButtonReleased()) {\r\n            events.push(MouseEvent.RightMouseUp);\r\n        }\r\n        var id = 0;\r\n        var com = null;\r\n        if (gameobject && gameobject.parentContainer) {\r\n            id = gameobject.parentContainer.getData("id");\r\n            // TODO 提供个接口\r\n            com = gameobject.parentContainer.parentContainer || gameobject.parentContainer;\r\n        }\r\n        if (pointer.isDown === false) {\r\n            var diffX = Math.abs(pointer.downX - pointer.upX);\r\n            var diffY = Math.abs(pointer.downY - pointer.upY);\r\n            if (diffX < 10 && diffY < 10) {\r\n                // events.push(MouseEvent.Tap);\r\n                this.worldService.emitter.emit("Tap", pointer, gameobject);\r\n                if (pointer.isDown === false) {\r\n                    if (com instanceof _rooms_display_frames_display__WEBPACK_IMPORTED_MODULE_3__["FramesDisplay"]) {\r\n                        // com.element.scaleTween();\r\n                        var ele = com.element;\r\n                        if (ele instanceof _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Element"]) {\r\n                            com.scaleTween();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (events.length === 0) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOUSE_EVENT);\r\n        var content = pkt.content;\r\n        content.id = id;\r\n        content.mouseEvent = events;\r\n        content.point3f = { x: pointer.worldX / this.zoom, y: pointer.worldY / this.zoom };\r\n        this.mConnect.send(pkt);\r\n    };\r\n    Object.defineProperty(MouseManager.prototype, "enable", {\r\n        get: function () {\r\n            if (this.mScene) {\r\n                return this.mScene.input.mouse.enabled;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 设置鼠标事件开关\r\n         */\r\n        set: function (value) {\r\n            if (this.mScene) {\r\n                this.mScene.input.mouse.enabled = value;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MouseManager.prototype.destroy = function () {\r\n        this.mScene = null;\r\n        this.mConnect = null;\r\n        this.mGroundLayer = null;\r\n        this.running = false;\r\n    };\r\n    MouseManager.prototype.groundDown = function (pointer, gameObject) {\r\n        var _this = this;\r\n        this.mGameObject = gameObject;\r\n        this.mDownTime = setTimeout(function () {\r\n            _this.worldService.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PRESS_ELEMENT, pointer, gameObject);\r\n        }, this.mDownDelay);\r\n    };\r\n    MouseManager.prototype.groundUp = function (pointer, gameObject) {\r\n        // this.mGameObject = null;\r\n        this.onUpdate(pointer, gameObject);\r\n    };\r\n    MouseManager.prototype.pointerDownHandler = function (pointer, gameobject) {\r\n        if (this.worldService) {\r\n            if (this.worldService.emitter) {\r\n                this.worldService.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SCENE_BACKGROUND_CLICK, pointer);\r\n            }\r\n        }\r\n        this.onUpdate(pointer, this.mGameObject);\r\n    };\r\n    MouseManager.prototype.onPointerUpHandler = function (pointer) {\r\n        clearTimeout(this.mDownTime);\r\n        this.onUpdate(pointer, this.mGameObject);\r\n        this.mGameObject = null;\r\n    };\r\n    return MouseManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/mouse.manager.ts?')},"./src/game/sound.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SoundField", function() { return SoundField; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SoundManager", function() { return SoundManager; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar SoundField;\r\n(function (SoundField) {\r\n    SoundField[SoundField["Background"] = 0] = "Background";\r\n    SoundField[SoundField["Element"] = 1] = "Element";\r\n    SoundField[SoundField["Effect"] = 2] = "Effect";\r\n})(SoundField || (SoundField = {}));\r\nvar SoundManager = /** @class */ (function (_super) {\r\n    __extends(SoundManager, _super);\r\n    function SoundManager(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    SoundManager.prototype.addPackListener = function () {\r\n        var connection = this.world.connection;\r\n        if (connection) {\r\n            connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SOUND_CTL, this.onPlaySoundHandler);\r\n        }\r\n    };\r\n    SoundManager.prototype.removePacketListener = function () {\r\n        var connection = this.world.connection;\r\n        if (connection) {\r\n            connection.removePacketListener(this);\r\n        }\r\n    };\r\n    SoundManager.prototype.changeRoom = function (room) {\r\n        if (this.mSoundMap) {\r\n            this.mSoundMap.clear();\r\n        }\r\n        this.mSoundMap = new Map();\r\n        this.mScene = room.scene;\r\n    };\r\n    SoundManager.prototype.play = function (config) {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist. play " + config.key + " fatal");\r\n            return;\r\n        }\r\n        var key = config.key;\r\n        if (!key) {\r\n            if (Array.isArray(config.urls)) {\r\n                key = config.urls.join("");\r\n            }\r\n            else {\r\n                key = config.urls;\r\n            }\r\n        }\r\n        var field = config.field || SoundField.Background;\r\n        var sound = this.mSoundMap.get(field);\r\n        if (!sound) {\r\n            sound = new Sound(this.mScene);\r\n            this.mSoundMap.set(field, sound);\r\n        }\r\n        // sound.play(key);\r\n        sound.play(key, config.urls, config.soundConfig);\r\n    };\r\n    SoundManager.prototype.stop = function (field) {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t stop");\r\n            return;\r\n        }\r\n        var sound = this.mSoundMap.get(field);\r\n        if (!sound) {\r\n            return;\r\n        }\r\n        sound.stop();\r\n    };\r\n    SoundManager.prototype.pause = function (field) {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t pause");\r\n            return;\r\n        }\r\n        var sound = this.mSoundMap.get(field);\r\n        if (!sound) {\r\n            return;\r\n        }\r\n        sound.pause();\r\n    };\r\n    SoundManager.prototype.resumes = function (field) {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t resume");\r\n            return;\r\n        }\r\n        var sound = this.mSoundMap.get(field);\r\n        if (!sound) {\r\n            return;\r\n        }\r\n        sound.resume();\r\n    };\r\n    SoundManager.prototype.stopAll = function () {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t stopAll");\r\n            return;\r\n        }\r\n        this.mSoundMap.forEach(function (sound) { if (sound)\r\n            sound.stop(); });\r\n    };\r\n    SoundManager.prototype.pauseAll = function () {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t pauseAll");\r\n            return;\r\n        }\r\n        this.mSoundMap.forEach(function (sound) { if (sound)\r\n            sound.pause(); });\r\n    };\r\n    SoundManager.prototype.resume = function () {\r\n        if (!this.mScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(SoundManager.name + " scene does not exist,can\'t resumeAll");\r\n            return;\r\n        }\r\n        this.mSoundMap.forEach(function (sound) { if (sound)\r\n            sound.resume(); });\r\n    };\r\n    SoundManager.prototype.destroy = function () {\r\n        if (this.mSoundMap) {\r\n            this.mSoundMap.forEach(function (sound) { if (sound)\r\n                sound.destroy(); });\r\n            this.mSoundMap.clear();\r\n            this.mSoundMap = undefined;\r\n        }\r\n        this.removePacketListener();\r\n    };\r\n    SoundManager.prototype.onPlaySoundHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (content.loop === undefined) {\r\n            content.loop = true;\r\n        }\r\n        // TODO\r\n        this.play({\r\n            key: content.soundKey,\r\n            urls: _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(content.soundKey),\r\n            field: content.scope,\r\n            soundConfig: { loop: content.loop }\r\n        });\r\n    };\r\n    return SoundManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PacketHandler"]));\r\n\r\nvar Sound = /** @class */ (function () {\r\n    function Sound(scene) {\r\n        this.scene = scene;\r\n    }\r\n    Sound.prototype.sound = function () {\r\n        return this.mSound;\r\n    };\r\n    Sound.prototype.play = function (key, urls, soundConfig) {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mSound && this.mSound.key === key) {\r\n            if (this.mSound.isPlaying)\r\n                return;\r\n            this.mSound.play();\r\n            return;\r\n        }\r\n        this.mKey = key;\r\n        if (this.scene.cache.audio.exists(key)) {\r\n            this.startPlay();\r\n        }\r\n        else {\r\n            if (!urls) {\r\n                return;\r\n            }\r\n            this.scene.load.once("filecomplete-audio-" + key, this.onSoundCompleteHandler, this);\r\n            this.scene.load.audio(key, urls);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    Sound.prototype.pause = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mSound) {\r\n            if (this.mSound.isPaused)\r\n                return;\r\n            this.mSound.pause();\r\n            return;\r\n        }\r\n    };\r\n    Sound.prototype.stop = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mSound) {\r\n            if (!this.mSound.isPlaying)\r\n                return;\r\n            this.mSound.stop();\r\n            return;\r\n        }\r\n    };\r\n    Sound.prototype.resume = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mSound) {\r\n            if (!this.mSound.isPaused)\r\n                return;\r\n            this.mSound.resume();\r\n            return;\r\n        }\r\n    };\r\n    Sound.prototype.destroy = function () {\r\n        if (this.mSound) {\r\n            this.mSound.stop();\r\n            this.mSound.destroy();\r\n            this.mSound = undefined;\r\n        }\r\n    };\r\n    Sound.prototype.onSoundCompleteHandler = function () {\r\n        this.startPlay();\r\n    };\r\n    Sound.prototype.startPlay = function () {\r\n        if (this.mSound) {\r\n            this.mSound.stop();\r\n            this.mSound.destroy();\r\n        }\r\n        this.mSound = this.scene.sound.add(this.mKey);\r\n        this.mSound.play();\r\n    };\r\n    return Sound;\r\n}());\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/game/sound.manager.ts?')},"./src/game/world.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(__dirname) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "World", function() { return World; });\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! phaser */ "./node_modules/phaser/dist/phaser.js-exposed");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var dragonBones__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dragonBones */ "./lib/dragonBones/dragonBones.js-exposed");\n/* harmony import */ var dragonBones__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(dragonBones__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _net_connection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../net/connection */ "./src/net/connection.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _rooms_room_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../rooms/room.manager */ "./src/rooms/room.manager.ts");\n/* harmony import */ var _keyboard_manager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./keyboard.manager */ "./src/game/keyboard.manager.ts");\n/* harmony import */ var _mouse_manager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mouse.manager */ "./src/game/mouse.manager.ts");\n/* harmony import */ var _joystick_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./joystick.manager */ "./src/game/joystick.manager.ts");\n/* harmony import */ var _element_storage__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./element.storage */ "./src/game/element.storage.ts");\n/* harmony import */ var _utils_http__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utils/http */ "./src/utils/http.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var game_capsule__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! game-capsule */ "../game-capsule/dist/index.js");\n/* harmony import */ var game_capsule__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(game_capsule__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var _ui_ui_manager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../ui/ui.manager */ "./src/ui/ui.manager.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_ninepatch_plugin_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/ninepatch-plugin.js */ "./lib/rexui/lib/plugins/ninepatch-plugin.js");\n/* harmony import */ var _lib_rexui_lib_plugins_inputtext_plugin_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/inputtext-plugin.js */ "./lib/rexui/lib/plugins/inputtext-plugin.js");\n/* harmony import */ var _lib_rexui_lib_plugins_bbcodetext_plugin_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/bbcodetext-plugin.js */ "./lib/rexui/lib/plugins/bbcodetext-plugin.js");\n/* harmony import */ var _lib_rexui_lib_plugins_button_plugin_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/button-plugin.js */ "./lib/rexui/lib/plugins/button-plugin.js");\n/* harmony import */ var _lib_rexui_lib_ui_ui_plugin_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../lib/rexui/lib/ui/ui-plugin.js */ "./lib/rexui/lib/ui/ui-plugin.js");\n/* harmony import */ var _scenes_login__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../scenes/login */ "./src/scenes/login.ts");\n/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./account */ "./src/game/account.ts");\n/* harmony import */ var _net_http_service__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../net/http.service */ "./src/net/http.service.ts");\n/* harmony import */ var _scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../scenes/gamepause */ "./src/scenes/gamepause.ts");\n/* harmony import */ var _rooms_clock__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../rooms/clock */ "./src/rooms/clock.ts");\n/* harmony import */ var _role_role_manager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../role/role.manager */ "./src/role/role.manager.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../i18n */ "./src/i18n.ts");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! path */ "./node_modules/path-browserify/index.js");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_27___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_27__);\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../utils/tool */ "./src/utils/tool.ts");\n/* harmony import */ var _sound_manager__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./sound.manager */ "./src/game/sound.manager.ts");\n/* harmony import */ var _loading_loading_manager__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../loading/loading.manager */ "./src/loading/loading.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError("Generator is already executing.");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// The World act as the global Phaser.World instance;\r\nvar World = /** @class */ (function (_super) {\r\n    __extends(World, _super);\r\n    function World(config, callBack) {\r\n        var _this = _super.call(this) || this;\r\n        _this.DEFAULT_WIDTH = 360;\r\n        _this.DEFAULT_HEIGHT = 640;\r\n        _this.mMoveStyle = 1;\r\n        _this.isFullStart = false;\r\n        _this.mOrientation = 0;\r\n        _this.gameConfigUrls = new Map();\r\n        _this.gameConfigUrl = "";\r\n        _this._isIOS = -1;\r\n        // 软键盘弹出的事件处理\r\n        _this.focusoutFunc = function () {\r\n            // isIOS函数在前面\r\n            if (_this.game && _this.game.device.os.iOS) {\r\n                window.scrollTo(0, 0);\r\n            }\r\n        };\r\n        _this.mCallBack = callBack;\r\n        _this.mConfig = config;\r\n        // TODO 检测config内的必要参数如确实抛异常.\r\n        if (!config.game_id) {\r\n            throw new Error("Config.game_id is required.");\r\n        }\r\n        if (!config.devicePixelRatio) {\r\n            config.devicePixelRatio = window.devicePixelRatio || 1;\r\n        }\r\n        if (config.width === undefined) {\r\n            config.width = window.innerWidth;\r\n        }\r\n        if (config.height === undefined) {\r\n            config.height = window.innerHeight;\r\n        }\r\n        _this.mScaleRatio = Math.ceil(config.devicePixelRatio || 1);\r\n        _this.mUIRatio = Math.round(config.devicePixelRatio || 1);\r\n        var scaleW = (config.width / _this.DEFAULT_WIDTH) * (config.devicePixelRatio / _this.mUIRatio);\r\n        // const scaleH = config.height / this.DEFAULT_HEIGHT;\r\n        _this.mUIScale = scaleW;\r\n        // if (!config.scale_ratio) {\r\n        // config.scale_ratio = Math.round(window.innerWidth / this.DEFAULT_WIDTH * window.devicePixelRatio);\r\n        // }\r\n        // this.mScaleRatio = config.scale_ratio ? config.scale_ratio : window.innerWidth / this.DEFAULT_WIDTH * window.devicePixelRatio;\r\n        _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__["Url"].OSD_PATH = _this.mConfig.osd || "https://osd.tooqing.com/";\r\n        _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__["Url"].RES_PATH = "./resources/";\r\n        _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__["Url"].RESUI_PATH = "./resources/ui/";\r\n        _this._newGame();\r\n        _this.mConnection = config.connection || new _net_connection__WEBPACK_IMPORTED_MODULE_4__["default"](_this);\r\n        _this.mConnection.addPacketListener(_this);\r\n        _this.mClock = new _rooms_clock__WEBPACK_IMPORTED_MODULE_24__["Clock"](_this.mConnection, _this);\r\n        // add Packet listener.\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_VIRTUAL_WORLD_INIT, _this.onInitVirtualWorldPlayerInit);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_ERROR, _this.onClientErrorHandler);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SELECT_CHARACTER, _this.onSelectCharacter);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_GOTO_ANOTHER_GAME, _this.onGotoAnotherGame);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_GATEWAY_RES_CLIENT_PONG, _this.heartBeatCallBack);\r\n        _this.mGameEmitter = new Phaser.Events.EventEmitter();\r\n        _this.mRoomMamager = new _rooms_room_manager__WEBPACK_IMPORTED_MODULE_6__["RoomManager"](_this);\r\n        _this.mUiManager = new _ui_ui_manager__WEBPACK_IMPORTED_MODULE_14__["UiManager"](_this);\r\n        _this.mMouseManager = new _mouse_manager__WEBPACK_IMPORTED_MODULE_8__["MouseManager"](_this);\r\n        _this.mElementStorage = new _element_storage__WEBPACK_IMPORTED_MODULE_10__["ElementStorage"]();\r\n        _this.mHttpService = new _net_http_service__WEBPACK_IMPORTED_MODULE_22__["HttpService"](_this);\r\n        _this.mRoleManager = new _role_role_manager__WEBPACK_IMPORTED_MODULE_25__["RoleManager"](_this);\r\n        _this.mSoundManager = new _sound_manager__WEBPACK_IMPORTED_MODULE_29__["SoundManager"](_this);\r\n        _this.mLoadingManager = new _loading_loading_manager__WEBPACK_IMPORTED_MODULE_30__["LoadingManager"](_this);\r\n        _this.mRoleManager.register();\r\n        // this.mCharacterManager = new CharacterManager(this);\r\n        // this.mCharacterManager.register();\r\n        _this.mRoomMamager.addPackListener();\r\n        _this.mUiManager.addPackListener();\r\n        _this.mSoundManager.addPackListener();\r\n        var gateway = _this.mConfig.server_addr || Object({"host":"115.182.75.99","port":22100,"secure":false});\r\n        if (gateway) {\r\n            // connect to game server.\r\n            _this.mConnection.startConnect(gateway);\r\n        }\r\n        document.body.addEventListener("focusout", _this.focusoutFunc); // 软键盘收起的事件处理\r\n        return _this;\r\n    }\r\n    Object.defineProperty(World.prototype, "moveStyle", {\r\n        get: function () {\r\n            return this.mMoveStyle;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    World.prototype.getConfig = function () {\r\n        return this.mConfig;\r\n    };\r\n    World.prototype.setGameConfig = function (config) {\r\n        this.elementStorage.setGameConfig(config);\r\n    };\r\n    World.prototype.updatePalette = function (palette) {\r\n        this.elementStorage.updatePalette(palette);\r\n    };\r\n    World.prototype.updateMoss = function (moss) {\r\n        this.elementStorage.updateMoss(moss);\r\n    };\r\n    World.prototype.destroy = function () {\r\n        this.mConnection.closeConnect();\r\n        document.body.removeEventListener("focusout", this.focusoutFunc); // 软键盘收起的事件处理\r\n        this.clearGame();\r\n    };\r\n    World.prototype.onConnected = function (connection) {\r\n        // Logger.getInstance().info(`enterVirtualWorld`);\r\n        this.enterVirtualWorld();\r\n        // this.login();\r\n    };\r\n    World.prototype.onDisConnected = function (connection) { };\r\n    World.prototype.onError = function (reason) { };\r\n    World.prototype.onClientErrorHandler = function (packet) {\r\n        var content = packet.content;\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().error("Remote Error[" + content.responseStatus + "]: " + content.msg);\r\n    };\r\n    /**\r\n     * 当scene发生改变时，调用该方法并传入各个需要调整监听的manager中去\r\n     */\r\n    World.prototype.changeRoom = function (room) {\r\n        if (this.mInputManager)\r\n            this.mInputManager.onRoomChanged(room);\r\n        this.mMouseManager.changeRoom(room);\r\n        this.mSoundManager.changeRoom(room);\r\n    };\r\n    World.prototype.getSize = function () {\r\n        if (!this.mGame)\r\n            return;\r\n        return this.mGame.scale.gameSize;\r\n    };\r\n    World.prototype.scaleChange = function (scale) {\r\n        this.emitter.emit(World.SCALE_CHANGE);\r\n    };\r\n    World.prototype.closeGame = function () {\r\n        if (this.mConfig.closeGame) {\r\n            this.destroy();\r\n            this.mConfig.closeGame();\r\n        }\r\n    };\r\n    World.prototype.resize = function (width, height) {\r\n        var w = width * window.devicePixelRatio;\r\n        var h = height * window.devicePixelRatio;\r\n        // if (this.mGame) {\r\n        //     this.mGame.scale.resize(w, h);\r\n        //     const scenes = this.mGame.scene.scenes;\r\n        //     for (const scene of scenes) {\r\n        //         scene.setViewPort(0, 0, w, h);\r\n        //         // scene.cameras.main.setViewport(0, 0, w, h);\r\n        //     }\r\n        // }\r\n        // if (this.mRoomMamager) {\r\n        //     this.mRoomMamager.resize(w, h);\r\n        // }\r\n        // if (this.mUiManager) {\r\n        //     this.mUiManager.resize(w, h);\r\n        // }\r\n        // if (this.mInputManager) {\r\n        //     this.mInputManager.resize(w, h);\r\n        // }\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("resize" + w + "|" + h);\r\n    };\r\n    World.prototype.onOrientationChange = function (orientation, width, height) {\r\n        if (this.mConfig.platform === "app")\r\n            return;\r\n        this.mOrientation = orientation;\r\n        if (this.mConfig.screenWidth > this.mConfig.screenHeight) {\r\n            // 基础是横屏\r\n            if ((orientation <= 135 && orientation >= 45) || (orientation <= -45 && orientation >= -135)) {\r\n                this.orientationResize(this.mConfig.screenWidth, this.mConfig.screenHeight, width, height);\r\n            }\r\n            else {\r\n                this.orientationResize(this.mConfig.screenHeight, this.mConfig.screenWidth, width, height);\r\n            }\r\n        }\r\n        else {\r\n            // 基础是竖屏\r\n            if ((orientation <= 135 && orientation >= 45) || (orientation <= -45 && orientation >= -135)) {\r\n                this.orientationResize(this.mConfig.screenHeight, this.mConfig.screenWidth, width, height);\r\n            }\r\n            else {\r\n                this.orientationResize(this.mConfig.screenWidth, this.mConfig.screenHeight, width, height);\r\n            }\r\n        }\r\n    };\r\n    World.prototype.startFullscreen = function () {\r\n        if (!this.mGame) {\r\n            return;\r\n        }\r\n        this.isFullStart = true;\r\n        this.mGame.scale.startFullscreen();\r\n    };\r\n    World.prototype.stopFullscreen = function () {\r\n        if (!this.mGame) {\r\n            return;\r\n        }\r\n        this.isFullStart = false;\r\n        this.mGame.scale.stopFullscreen();\r\n    };\r\n    World.prototype.onGotoAnotherGame = function (packet) {\r\n        var content = packet.content;\r\n        this._createAnotherGame(content.gameId, content.virtualWorldId);\r\n    };\r\n    World.prototype.changeScene = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var gameID, worldID;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        gameID = this.mConfig.game_id;\r\n                        worldID = this.mConfig.virtual_world_id;\r\n                        return [4 /*yield*/, this.clearGame()];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.mConfig.game_id = gameID;\r\n                        this.mConfig.virtual_world_id = worldID;\r\n                        this._newGame();\r\n                        this.loginEnterWorld();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    World.prototype.reconnect = function () {\r\n        var gameID = this.mConfig.game_id;\r\n        var worldID = this.mConfig.virtual_world_id;\r\n        this._createAnotherGame(gameID, worldID);\r\n    };\r\n    World.prototype.startHeartBeat = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_gateway"].OPCODE._OP_CLIENT_REQ_GATEWAY_PING);\r\n        this.mConnection.send(pkt);\r\n        this.mClock.sync(-1);\r\n    };\r\n    World.prototype.playSound = function (config) {\r\n        this.mSoundManager.play(config);\r\n    };\r\n    Object.defineProperty(World.prototype, "uiScale", {\r\n        get: function () {\r\n            return this.mUIScale;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "uiRatio", {\r\n        get: function () {\r\n            return this.mUIRatio;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "scaleRatio", {\r\n        get: function () {\r\n            return this.mScaleRatio;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "game", {\r\n        get: function () {\r\n            return this.mGame;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "roomManager", {\r\n        get: function () {\r\n            return this.mRoomMamager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "orientation", {\r\n        get: function () {\r\n            return this.mOrientation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "elementStorage", {\r\n        get: function () {\r\n            return this.mElementStorage;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "uiManager", {\r\n        get: function () {\r\n            return this.mUiManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "mouseManager", {\r\n        get: function () {\r\n            return this.mMouseManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "inputManager", {\r\n        get: function () {\r\n            return this.mInputManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "connection", {\r\n        get: function () {\r\n            return this.mConnection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "clock", {\r\n        get: function () {\r\n            return this.mClock;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "emitter", {\r\n        get: function () {\r\n            return this.mGameEmitter;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "httpService", {\r\n        get: function () {\r\n            return this.mHttpService;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, "account", {\r\n        get: function () {\r\n            return this.mAccount;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    World.prototype.enableClick = function () {\r\n        if (this.game &&\r\n            this.mRoomMamager &&\r\n            this.mRoomMamager.currentRoom &&\r\n            this.mRoomMamager.currentRoom.scene &&\r\n            this.mRoomMamager.currentRoom.scene.input) {\r\n            this.mRoomMamager.currentRoom.scene.input.enabled = true;\r\n        }\r\n    };\r\n    World.prototype.disableClick = function () {\r\n        if (this.game &&\r\n            this.mRoomMamager &&\r\n            this.mRoomMamager.currentRoom &&\r\n            this.mRoomMamager.currentRoom.scene &&\r\n            this.mRoomMamager.currentRoom.scene.input) {\r\n            this.mRoomMamager.currentRoom.scene.input.enabled = false;\r\n        }\r\n    };\r\n    World.prototype.showLoading = function () {\r\n        return this.mLoadingManager.start();\r\n    };\r\n    World.prototype.getGameConfig = function () {\r\n        return this.gameConfig;\r\n    };\r\n    World.prototype.onClockReady = function () {\r\n        if (this.mInputManager) {\r\n            this.mInputManager.enable = true;\r\n        }\r\n    };\r\n    World.prototype.onFocus = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);\r\n            var context = pkt.content;\r\n            context.gameStatus = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].GameStatus.Focus;\r\n            this.connection.send(pkt);\r\n            // 同步心跳\r\n            this.mClock.sync(-1);\r\n        }\r\n        else {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().error("connection is undefined");\r\n        }\r\n        this.resumeScene();\r\n    };\r\n    World.prototype.onBlur = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_GAME_STATUS);\r\n            var context = pkt.content;\r\n            context.gameStatus = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].GameStatus.Blur;\r\n            this.connection.send(pkt);\r\n        }\r\n        else {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().error("connection is undefined");\r\n        }\r\n        if (this.game.device.os.desktop) {\r\n            this.pauseScene();\r\n        }\r\n    };\r\n    World.prototype.initgameConfigUrls = function (urls) {\r\n        for (var _i = 0, urls_1 = urls; _i < urls_1.length; _i++) {\r\n            var url = urls_1[_i];\r\n            var sceneId = _utils_tool__WEBPACK_IMPORTED_MODULE_28__["Tool"].baseName(url);\r\n            this.gameConfigUrls.set(sceneId, url);\r\n            if (url.split(sceneId).length === 3) {\r\n                this.gameConfigUrl = url;\r\n            }\r\n        }\r\n    };\r\n    World.prototype.getConfigUrl = function (sceneId) {\r\n        return this.gameConfigUrls.get(sceneId);\r\n    };\r\n    World.prototype.loadSceneConfig = function (sceneId) {\r\n        var url = this.getConfigUrl(sceneId);\r\n        return this.loadGameConfig(url);\r\n    };\r\n    World.prototype.createGame = function (keyEvents) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // start the game. TODO 此方法会多次调用，所以先要卸载已经实例化的游戏再new！\r\n                        this._newGame();\r\n                        // if (!this.mGame.scene.getScene(MainUIScene.name)) {\r\n                        //     this.mGame.scene.add(MainUIScene.name, MainUIScene);\r\n                        // }\r\n                        // if (!this.mGame.scene.getScene(EditScene.name)) {\r\n                        //     this.mGame.scene.add(EditScene.name, EditScene);\r\n                        // }\r\n                        // this.mGame.scene.add(PlayScene.name, PlayScene);\r\n                        // this.mGame.events.on(Phaser.Core.Events.FOCUS, this.onFocus, this);\r\n                        this.mGame.events.on(Phaser.Core.Events.BLUR, this.onBlur, this);\r\n                        if (this.moveStyle === pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE || this.moveStyle === 1) {\r\n                            if (this.mGame.device.os.desktop) {\r\n                                this.mInputManager = new _keyboard_manager__WEBPACK_IMPORTED_MODULE_7__["KeyBoardManager"](this, keyEvents);\r\n                            }\r\n                            else {\r\n                                this.mInputManager = new _joystick_manager__WEBPACK_IMPORTED_MODULE_9__["JoyStickManager"](this, keyEvents);\r\n                            }\r\n                        }\r\n                        else {\r\n                            if (this.mGame.device.os.desktop) {\r\n                                this.mInputManager = new _keyboard_manager__WEBPACK_IMPORTED_MODULE_7__["KeyBoardManager"](this, keyEvents);\r\n                            }\r\n                        }\r\n                        if (this.mInputManager)\r\n                            this.mInputManager.enable = false;\r\n                        if (window.screen.width > window.screen.height) {\r\n                            if (this.mConfig.width > this.mConfig.height) {\r\n                                this.resize(this.mConfig.width, this.mConfig.height);\r\n                            }\r\n                            else {\r\n                                this.resize(this.mConfig.height, this.mConfig.width);\r\n                            }\r\n                        }\r\n                        else {\r\n                            if (this.mConfig.width < this.mConfig.height) {\r\n                                this.resize(this.mConfig.width, this.mConfig.height);\r\n                            }\r\n                            else {\r\n                                this.resize(this.mConfig.height, this.mConfig.width);\r\n                            }\r\n                        }\r\n                        return [4 /*yield*/, this.mLoadingManager.addAssets(this.mElementStorage.getAssets())];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.gameCreated();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    World.prototype._createAnotherGame = function (gameId, worldId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var gateway, loginScene;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.clearGame()];\r\n                    case 1:\r\n                        _a.sent();\r\n                        if (this.mConnection) {\r\n                            this.mConnection.closeConnect();\r\n                        }\r\n                        if (this.mClock) {\r\n                            this.mClock.destroy();\r\n                            this.mClock = null;\r\n                        }\r\n                        this.mConfig.game_id = gameId;\r\n                        this.mConfig.virtual_world_id = worldId;\r\n                        this.mConnection.addPacketListener(this);\r\n                        gateway = this.mConfig.server_addr || Object({"host":"115.182.75.99","port":22100,"secure":false});\r\n                        if (gateway) {\r\n                            // connect to game server.\r\n                            this.mConnection.startConnect(gateway);\r\n                        }\r\n                        this.mClock = new _rooms_clock__WEBPACK_IMPORTED_MODULE_24__["Clock"](this.mConnection, this);\r\n                        // setTimeout(() => {\r\n                        this._newGame();\r\n                        loginScene = this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"].name);\r\n                        if (loginScene)\r\n                            loginScene.remove();\r\n                        this.mLoadingManager.start();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    World.prototype.onFullScreenChange = function () {\r\n        this.resize(this.mGame.scale.gameSize.width, this.mGame.scale.gameSize.height);\r\n    };\r\n    World.prototype.onSelectCharacter = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_CHARACTER_CREATED);\r\n        this.connection.send(pkt);\r\n    };\r\n    World.prototype.clearGame = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (_this.mGame) {\r\n                _this.mGame.events.off(Phaser.Core.Events.BLUR, _this.onBlur, _this);\r\n                _this.mGame.scale.off("enterfullscreen", _this.onFullScreenChange, _this);\r\n                _this.mGame.scale.off("leavefullscreen", _this.onFullScreenChange, _this);\r\n                _this.mGame.scale.off("orientationchange", _this.onOrientationChange, _this);\r\n                _this.mGame.plugins.removeGlobalPlugin("rexButton");\r\n                _this.mGame.plugins.removeGlobalPlugin("rexNinePatchPlugin");\r\n                _this.mGame.plugins.removeGlobalPlugin("rexInputText");\r\n                _this.mGame.plugins.removeGlobalPlugin("rexBBCodeTextPlugin");\r\n                _this.mGame.plugins.removeGlobalPlugin("rexMoveTo");\r\n                _this.mGame.plugins.removeScenePlugin("DragonBones");\r\n                _this.mGame.plugins.removeScenePlugin("rexUI");\r\n                _this.mGameEmitter.destroy();\r\n                _this.roomManager.destroy();\r\n                _this.uiManager.destroy();\r\n                _this.mElementStorage.destroy();\r\n                _this.mLoadingManager.destroy();\r\n                _this.mGame.events.once(Phaser.Core.Events.DESTROY, function () {\r\n                    _this.mGame = undefined;\r\n                    resolve();\r\n                });\r\n                _this.mGame.destroy(true);\r\n            }\r\n            else {\r\n                resolve();\r\n            }\r\n        });\r\n    };\r\n    World.prototype.heartBeatCallBack = function () {\r\n        this.mConnection.clearHeartBeat();\r\n    };\r\n    // private initUiScale() {\r\n    //     const width: number = this.mConfig.width;\r\n    //     const height: number = this.mConfig.height;\r\n    //     const baseWidth: number = this.mConfig.baseWidth;\r\n    //     const baseHeight: number = this.mConfig.baseHeight;\r\n    //     if (!this.mGame.device.os.desktop) {\r\n    //         if (width < height) {\r\n    //             this.mConfig.ui_scale = (width / baseHeight) * 2;\r\n    //             this.mGame.scale.orientation = Phaser.Scale.Orientation.PORTRAIT;\r\n    //         } else if (width > height) {\r\n    //             this.mConfig.ui_scale = (width / baseWidth) * 2;\r\n    //             this.mGame.scale.orientation = Phaser.Scale.Orientation.LANDSCAPE;\r\n    //         }\r\n    //     }\r\n    // }\r\n    World.prototype.login = function () {\r\n        var _this = this;\r\n        if (!this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"].name)) {\r\n            this.mGame.scene.add(_scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"].name, _scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"]);\r\n        }\r\n        this.mGame.scene.start(_scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"].name, {\r\n            connect: this.mConnection,\r\n            world: this,\r\n            callBack: function () {\r\n                _this.loginEnterWorld();\r\n                var loginScene = _this.mGame.scene.getScene(_scenes_login__WEBPACK_IMPORTED_MODULE_20__["LoginScene"].name);\r\n                loginScene.remove();\r\n                _this.mLoadingManager.start();\r\n                // this.mGame.scene.start(LoadingScene.name, { world: this });\r\n            },\r\n        });\r\n    };\r\n    World.prototype.orientationResize = function (screenWidth, screenHeight, width, height) {\r\n        if (this.mGame) {\r\n            if (width < height) {\r\n                // 基础竖版\r\n                // this.mConfig.ui_scale = width / this.mConfig.baseHeight;\r\n                this.mGame.scale.orientation = Phaser.Scale.Orientation.PORTRAIT;\r\n                if (!this.isFullStart) {\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("竖版" + this.mGame.scale.orientation);\r\n                }\r\n            }\r\n            else {\r\n                // 基础横版\r\n                // this.mConfig.ui_scale = width / this.mConfig.baseWidth;\r\n                this.mGame.scale.orientation = Phaser.Scale.Orientation.LANDSCAPE;\r\n                if (!this.isFullStart) {\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("横版" + this.mGame.scale.orientation);\r\n                }\r\n            }\r\n            this.mGame.scale.resize(screenWidth, screenHeight);\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("orientation" + this.mGame.scale.orientation);\r\n        }\r\n        if (this.mRoomMamager) {\r\n            this.mRoomMamager.resize(width, height);\r\n        }\r\n        if (this.mUiManager) {\r\n            this.mUiManager.resize(width, height);\r\n        }\r\n        if (this.mInputManager) {\r\n            this.mInputManager.resize(width, height);\r\n        }\r\n    };\r\n    World.prototype.enterVirtualWorld = function () {\r\n        if (!this.mGame) {\r\n            this.reconnect();\r\n            return;\r\n        }\r\n        if (this.mConfig && this.mConnection) {\r\n            this.mAccount = new _account__WEBPACK_IMPORTED_MODULE_21__["Account"]();\r\n            this.mLoadingManager.start();\r\n            if (!this.mConfig.auth_token) {\r\n                this.login();\r\n                return;\r\n            }\r\n            else {\r\n                // this.mGame.scene.start(LoadingScene.name, { world: this });\r\n                this.mLoadingManager.start();\r\n                this.mAccount.setAccount({\r\n                    token: this.mConfig.auth_token,\r\n                    expire: this.mConfig.token_expire,\r\n                    fingerprint: this.mConfig.token_fingerprint,\r\n                });\r\n            }\r\n            this.loginEnterWorld();\r\n        }\r\n    };\r\n    World.prototype.loginEnterWorld = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var pkt, content;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, Object(_i18n__WEBPACK_IMPORTED_MODULE_26__["initLocales"])(path__WEBPACK_IMPORTED_MODULE_27__["relative"](__dirname, "../resources/locales/{{lng}}.json"))];\r\n                    case 1:\r\n                        _a.sent();\r\n                        pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_gateway"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PLAYER_INIT);\r\n                        content = pkt.content;\r\n                        // Logger.getInstance().log(`VW_id: ${this.mConfig.virtual_world_id}`);\r\n                        content.virtualWorldUuid = "" + this.mConfig.virtual_world_id;\r\n                        if (!this.mConfig.game_id ||\r\n                            !this.mAccount ||\r\n                            !this.mAccount.accountData ||\r\n                            !this.mAccount.accountData.token ||\r\n                            !this.mAccount.accountData.expire ||\r\n                            !this.mAccount.accountData.fingerprint) {\r\n                            // Logger.getInstance().debug("缺少必要参数，无法登录游戏");\r\n                            if (this.mGame)\r\n                                this.mGame.destroy(true);\r\n                            return [2 /*return*/];\r\n                        }\r\n                        content.gameId = this.mConfig.game_id;\r\n                        // const accountObj = JSON.parse();\r\n                        content.userToken = this.mConfig.auth_token = this.mAccount.accountData.token; // auth_token;\r\n                        content.expire = this.mConfig.token_expire = this.mAccount.accountData.expire + "";\r\n                        content.fingerprint = this.mConfig.token_fingerprint = this.mAccount.accountData.fingerprint;\r\n                        this.mConnection.send(pkt);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    World.prototype.onInitVirtualWorldPlayerInit = function (packet) {\r\n        var _this = this;\r\n        // if (this.mClock) this.mClock.sync(); // Manual sync remote time.\r\n        // TODO 进游戏前预加载资源\r\n        var content = packet.content;\r\n        var configUrls = content.configUrls;\r\n        this.mMoveStyle = content.moveStyle;\r\n        this.clock.sync(-1);\r\n        this.initgameConfigUrls(configUrls);\r\n        if (!configUrls || configUrls.length <= 0) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().error("configUrls error: , " + configUrls + ", gameId: " + this.mConfig.game_id);\r\n            this.createGame(content.keyEvents);\r\n            return;\r\n        }\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("mMoveStyle:" + content.moveStyle);\r\n        var game_id = this.mConfig.game_id;\r\n        if (game_id.indexOf(".") > -1) {\r\n            game_id = game_id.split(".")[1];\r\n        }\r\n        var mainGameConfigUrl = this.gameConfigUrl;\r\n        this.loadGameConfig(mainGameConfigUrl)\r\n            .then(function (gameConfig) {\r\n            _this.mElementStorage.setGameConfig(gameConfig);\r\n            _this.createGame(content.keyEvents);\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().debug("created game suc");\r\n        })\r\n            .catch(function (err) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log(err);\r\n        });\r\n    };\r\n    World.prototype._newGame = function () {\r\n        if (this.mGame) {\r\n            return this.mGame;\r\n        }\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("dragonbones: ", dragonBones);\r\n        this.gameConfig = {\r\n            type: Phaser.AUTO,\r\n            parent: this.mConfig.parent || "game",\r\n            scene: null,\r\n            disableContextMenu: true,\r\n            transparent: false,\r\n            backgroundColor: 0x0,\r\n            resolution: 1,\r\n            fps: {\r\n                target: 30,\r\n            },\r\n            dom: {\r\n                createContainer: true,\r\n            },\r\n            plugins: {\r\n                global: [\r\n                    {\r\n                        key: "rexButton",\r\n                        plugin: _lib_rexui_lib_plugins_button_plugin_js__WEBPACK_IMPORTED_MODULE_18__["default"],\r\n                        start: true,\r\n                    },\r\n                    {\r\n                        key: "rexNinePatchPlugin",\r\n                        plugin: _lib_rexui_lib_plugins_ninepatch_plugin_js__WEBPACK_IMPORTED_MODULE_15__["default"],\r\n                        start: true,\r\n                    },\r\n                    {\r\n                        key: "rexInputText",\r\n                        plugin: _lib_rexui_lib_plugins_inputtext_plugin_js__WEBPACK_IMPORTED_MODULE_16__["default"],\r\n                        start: true,\r\n                    },\r\n                    {\r\n                        key: "rexBBCodeTextPlugin",\r\n                        plugin: _lib_rexui_lib_plugins_bbcodetext_plugin_js__WEBPACK_IMPORTED_MODULE_17__["default"],\r\n                        start: true,\r\n                    },\r\n                ],\r\n                scene: [\r\n                    {\r\n                        key: "DragonBones",\r\n                        plugin: dragonBones.phaser.plugin.DragonBonesScenePlugin,\r\n                        mapping: "dragonbone",\r\n                    },\r\n                    { key: "rexUI", plugin: _lib_rexui_lib_ui_ui_plugin_js__WEBPACK_IMPORTED_MODULE_19__["default"], mapping: "rexUI" },\r\n                ],\r\n            },\r\n            render: {\r\n                pixelArt: true,\r\n                roundPixels: true,\r\n            },\r\n            scale: {\r\n                mode: Phaser.Scale.NONE,\r\n                width: this.mConfig.width * window.devicePixelRatio,\r\n                height: this.mConfig.height * window.devicePixelRatio,\r\n                zoom: 1 / window.devicePixelRatio,\r\n            },\r\n        };\r\n        Object.assign(this.gameConfig, this.mConfig);\r\n        this.mGame = new phaser__WEBPACK_IMPORTED_MODULE_0__["Game"](this.gameConfig);\r\n        this.mGame.input.mouse.capture = true;\r\n        if (this.mGame.device.os.desktop) {\r\n            this.mUIScale = 1;\r\n        }\r\n        if (this.mRoomMamager)\r\n            this.mRoomMamager.addPackListener();\r\n        if (this.mUiManager)\r\n            this.mUiManager.addPackListener();\r\n        if (this.mRoleManager)\r\n            this.mRoleManager.register();\r\n        if (this.mSoundManager)\r\n            this.mSoundManager.addPackListener();\r\n        if (this.mElementStorage) {\r\n            this.mElementStorage.on("SCENE_PI_LOAD_COMPELETE", this.loadSceneConfig);\r\n        }\r\n        // if (this.mCharacterManager) this.mCharacterManager.register();\r\n        return this.mGame;\r\n    };\r\n    World.prototype.gameCreated = function () {\r\n        if (this.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_GAME_CREATED);\r\n            this.connection.send(pkt);\r\n            if (this.mCallBack) {\r\n                this.mCallBack();\r\n            }\r\n            if (this.mConfig.game_created) {\r\n                this.mConfig.game_created();\r\n            }\r\n        }\r\n        else {\r\n            // Logger.getInstance().error("connection is undefined");\r\n        }\r\n        this.mGame.scale.on("enterfullscreen", this.onFullScreenChange, this);\r\n        this.mGame.scale.on("leavefullscreen", this.onFullScreenChange, this);\r\n        // this.mGame.scale.on("orientationchange", this.onOrientationChange, this);\r\n    };\r\n    World.prototype.loadGameConfig = function (remotePath) {\r\n        var _this = this;\r\n        var configPath = _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__["ResUtils"].getGameConfig(remotePath);\r\n        return Object(_utils_http__WEBPACK_IMPORTED_MODULE_11__["load"])(configPath, "arraybuffer").then(function (req) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("start decodeConfig");\r\n            return _this.decodeConfigs(req);\r\n        });\r\n    };\r\n    World.prototype.decodeConfigs = function (req) {\r\n        return new Promise(function (resolve, reject) {\r\n            var arraybuffer = req.response;\r\n            if (arraybuffer) {\r\n                try {\r\n                    var gameConfig = new game_capsule__WEBPACK_IMPORTED_MODULE_13__["Lite"]();\r\n                    gameConfig.deserialize(new Uint8Array(arraybuffer));\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_5__["Logger"].getInstance().log("TCL: World -> gameConfig", gameConfig);\r\n                    resolve(gameConfig);\r\n                }\r\n                catch (error) {\r\n                    reject(error);\r\n                }\r\n            }\r\n            else {\r\n                reject("error");\r\n            }\r\n        });\r\n    };\r\n    World.prototype.resumeScene = function () {\r\n        if (this.mConfig.isEditor) {\r\n            return;\r\n        }\r\n        this.mRoomMamager.onFocus();\r\n        if (this.mGame && this.mConfig.platform === "pc") {\r\n            var pauseScene = this.mGame.scene.getScene(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"].name);\r\n            if (pauseScene) {\r\n                pauseScene.sleep();\r\n                this.mGame.scene.stop(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"].name);\r\n            }\r\n        }\r\n    };\r\n    World.prototype.pauseScene = function () {\r\n        if (this.mConfig.isEditor) {\r\n            return;\r\n        }\r\n        this.mRoomMamager.onBlur();\r\n        if (this.mGame && this.mConfig.platform === "pc") {\r\n            if (!this.mGame.scene.getScene(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"].name)) {\r\n                this.mGame.scene.add(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"].name, _scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"]);\r\n            }\r\n            this.mGame.scene.start(_scenes_gamepause__WEBPACK_IMPORTED_MODULE_23__["GamePauseScene"].name, { world: this });\r\n        }\r\n    };\r\n    World.SCALE_CHANGE = "scale_change";\r\n    return World;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n/* WEBPACK VAR INJECTION */}.call(this, "/"))\n\n//# sourceURL=webpack://TooqingCore/./src/game/world.ts?')},"./src/i18n.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initLocales", function() { return initLocales; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i18n", function() { return i18n; });\n/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! i18next */ "./node_modules/i18next/dist/esm/i18next.js");\n/* harmony import */ var i18next_xhr_backend__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next-xhr-backend */ "./node_modules/i18next-xhr-backend/dist/esm/i18nextXHRBackend.js");\n\r\n\r\nfunction initLocales(path) {\r\n    return i18next__WEBPACK_IMPORTED_MODULE_0__["default"]\r\n        .use(i18next_xhr_backend__WEBPACK_IMPORTED_MODULE_1__["default"])\r\n        // .use(LanguageDetector)\r\n        .init({\r\n        lng: "en",\r\n        fallbackLng: "en",\r\n        backend: {\r\n            loadPath: path,\r\n            crossDomain: true\r\n        }\r\n    });\r\n}\r\nvar i18n = i18next__WEBPACK_IMPORTED_MODULE_0__["default"];\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/i18n.ts?')},"./src/loading/loading.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingManager", function() { return LoadingManager; });\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError("Generator is already executing.");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\nvar LoadingManager = /** @class */ (function () {\r\n    function LoadingManager(world) {\r\n        this.world = world;\r\n        this.mResources = [];\r\n    }\r\n    LoadingManager.prototype.start = function (callBack) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var sceneManager, loading;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                sceneManager = this.game.scene;\r\n                if (!sceneManager) {\r\n                    return [2 /*return*/, Promise.reject("start faild. SceneManager does not exist")];\r\n                }\r\n                loading = sceneManager.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"].name);\r\n                if (!loading) {\r\n                    sceneManager.add(_scenes_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"].name, _scenes_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"]);\r\n                }\r\n                if (loading) {\r\n                    loading.awake({\r\n                        world: this.world,\r\n                        callBack: function (scene) {\r\n                            _this.scene = scene;\r\n                            if (_this.mResources.length > 0) {\r\n                                return _this.addAssets(_this.mResources);\r\n                            }\r\n                            return Promise.resolve();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    sceneManager.start(_scenes_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"].name, {\r\n                        world: this.world,\r\n                        callBack: function (scene) {\r\n                            _this.scene = scene;\r\n                            if (_this.mResources.length > 0) {\r\n                                return _this.addAssets(_this.mResources);\r\n                            }\r\n                            return Promise.resolve();\r\n                        }\r\n                    });\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    LoadingManager.prototype.addAssets = function (assets) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _i, assets_1, asset;\r\n            return __generator(this, function (_a) {\r\n                if (!this.scene) {\r\n                    return [2 /*return*/];\r\n                }\r\n                if (!assets) {\r\n                    return [2 /*return*/];\r\n                }\r\n                for (_i = 0, assets_1 = assets; _i < assets_1.length; _i++) {\r\n                    asset = assets_1[_i];\r\n                    this.loadAsset(asset);\r\n                }\r\n                return [2 /*return*/, this.startup(this.scene)];\r\n            });\r\n        });\r\n    };\r\n    LoadingManager.prototype.startup = function (scene) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _i, _a, asset;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                this.scene = scene;\r\n                this.scene.load.once(Phaser.Loader.Events.COMPLETE, function () {\r\n                    _this.mLoading = false;\r\n                    _this.mResources = [];\r\n                    // this.game.scene.remove(LoadingScene.name);\r\n                    return Promise.resolve();\r\n                });\r\n                for (_i = 0, _a = this.mResources; _i < _a.length; _i++) {\r\n                    asset = _a[_i];\r\n                    this.loadAsset(asset);\r\n                }\r\n                this.scene.load.start();\r\n                this.mLoading = true;\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    LoadingManager.prototype.destroy = function () {\r\n        if (this.mResources) {\r\n            this.mResources = [];\r\n        }\r\n        this.scene = undefined;\r\n    };\r\n    LoadingManager.prototype.loadAsset = function (asset) {\r\n        var type = this.getLoadType(asset.type);\r\n        if (this.scene.load[type]) {\r\n            this.scene.load[type](asset.key, asset.source);\r\n        }\r\n    };\r\n    Object.defineProperty(LoadingManager.prototype, "game", {\r\n        get: function () {\r\n            if (!this.world) {\r\n                return;\r\n            }\r\n            return this.world.game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    LoadingManager.prototype.getLoadType = function (fileType) {\r\n        if (fileType === "mp3" || fileType === "wmv" || fileType === "ogg") {\r\n            return "audio";\r\n        }\r\n        return fileType;\r\n    };\r\n    return LoadingManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/loading/loading.manager.ts?')},"./src/net/connection.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! buffer/ */ "./node_modules/node-libs-browser/node_modules/buffer/index.js");\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(buffer___WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! worker-loader?name=js/[hash].[name].js!./networker */ "./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/networker.ts");\n/* harmony import */ var worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! worker-loader?name=js/[hash].[name].js!./heartbeatworker */ "./node_modules/worker-loader/dist/cjs.js?name=js/[hash].[name].js!./src/net/heartbeatworker.ts");\n/* harmony import */ var worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__);\n\r\n\r\n\r\n// import {op_client, op_gameconfig, op_gameconfig_01, op_gateway, op_virtual_world} from "pixelpai_proto";\r\n// PBpacket.addProtocol(op_client);\r\n// PBpacket.addProtocol(op_gateway);\r\n// PBpacket.addProtocol(op_gameconfig);\r\n// PBpacket.addProtocol(op_virtual_world);\r\n// PBpacket.addProtocol(op_gameconfig_01);\r\n\r\n\r\n\r\nfor (var key in pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__) {\r\n    net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"].addProtocol(pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__[key]);\r\n}\r\n// 网络连接器\r\n// 使用webworker启动socket，无webworker时直接启动socket\r\nvar Connection = /** @class */ (function () {\r\n    function Connection(listener) {\r\n        this.mPacketHandlers = [];\r\n        this.mReConnectCount = 0;\r\n        this.mListener = listener;\r\n    }\r\n    Connection.prototype.startConnect = function (addr, keepalive) {\r\n        this.mCachedServerAddress = addr;\r\n        try {\r\n            this.mHeartBeatWorker = new worker_loader_name_js_hash_name_js_heartbeatworker__WEBPACK_IMPORTED_MODULE_4___default.a();\r\n            this.mWorker = new worker_loader_name_js_hash_name_js_networker__WEBPACK_IMPORTED_MODULE_3___default.a();\r\n            this._doConnect();\r\n        }\r\n        catch (e) {\r\n            throw new Error("startConnect Error: " + e);\r\n        }\r\n    };\r\n    Connection.prototype.closeConnect = function () {\r\n        this.mWorker.terminate();\r\n        this.mHeartBeatWorker.terminate();\r\n        this.mCachedServerAddress = undefined;\r\n        this.mReConnectCount = 0;\r\n        this.mTimeout = null;\r\n        this.clearPacketListeners();\r\n    };\r\n    Connection.prototype.clearHeartBeat = function () {\r\n        if (this.mHeartBeatWorker) {\r\n            this.mHeartBeatWorker.postMessage({ method: "clearBeat" });\r\n        }\r\n    };\r\n    Connection.prototype.addPacketListener = function (listener) {\r\n        this.mPacketHandlers.push(listener);\r\n    };\r\n    Connection.prototype.send = function (packet) {\r\n        if (!this.mWorker) {\r\n            throw new Error("NetWorker is undefined.");\r\n        }\r\n        this.mWorker.postMessage({\r\n            "method": "send",\r\n            "buffer": packet.Serialization(),\r\n        });\r\n    };\r\n    Connection.prototype.clearReconnectCount = function () {\r\n        this.mHeartBeatWorker.postMessage("clearBeat");\r\n    };\r\n    Connection.prototype.removePacketListener = function (listener) {\r\n        var idx = this.mPacketHandlers.indexOf(listener);\r\n        if (idx !== -1) {\r\n            this.mPacketHandlers.splice(idx, 1);\r\n        }\r\n    };\r\n    Connection.prototype.clearPacketListeners = function () {\r\n        if (!this.mPacketHandlers || this.mPacketHandlers.length < 1) {\r\n            return;\r\n        }\r\n        var len = this.mPacketHandlers.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var listener = this.mPacketHandlers[i];\r\n            if (!listener)\r\n                continue;\r\n            this.removePacketListener(listener);\r\n            i--;\r\n        }\r\n    };\r\n    Connection.prototype._doConnect = function () {\r\n        // Logger.getInstance().info(`_doConnect `, this.mCachedServerAddress);\r\n        var self = this;\r\n        if (this.mWorker) {\r\n            this.mWorker.onmessage = function (event) {\r\n                self.onWorkerMessage(event.data);\r\n            };\r\n            if (this.mHeartBeatWorker) {\r\n                this.mHeartBeatWorker.onmessage = function (event) {\r\n                    self.onWorkerMessage(event.data);\r\n                };\r\n            }\r\n            this.mWorker.postMessage({\r\n                "method": "connect",\r\n                "address": self.mCachedServerAddress,\r\n            });\r\n        }\r\n    };\r\n    Connection.prototype.onWorkerMessage = function (data) {\r\n        var self = this;\r\n        var method = data.method;\r\n        switch (method) {\r\n            case "onConnected":\r\n                this.mReConnectCount = 0;\r\n                this.mListener.onConnected();\r\n                if (this.mHeartBeatWorker) {\r\n                    this.mHeartBeatWorker.postMessage({ method: "startBeat" });\r\n                }\r\n                break;\r\n            case "onDisConnected":\r\n                if (!this.mTimeout) {\r\n                    if (this.mReConnectCount < 10)\r\n                        this.mReConnectCount++;\r\n                    var delay = Math.pow(this.mReConnectCount, 2);\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().info("ReConnect: delay = " + delay * 1000 + "[c/" + this.mReConnectCount + "]");\r\n                    this.mTimeout = setTimeout(function () {\r\n                        self.mTimeout = undefined;\r\n                        self._doConnect();\r\n                    }, delay * 1000);\r\n                }\r\n                break;\r\n            case "onConnectError":\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("error" + data.error);\r\n                // TODO\r\n                this.reConnect();\r\n                break;\r\n            case "heartBeat":\r\n                this.worldStartHeartBeat();\r\n                break;\r\n            case "endBeat":\r\n                this.endHeartBeat();\r\n                break;\r\n            case "reConnect":\r\n                this.reConnect();\r\n                break;\r\n            case "onData":\r\n                var buf = data.buffer;\r\n                if (buf) {\r\n                    this._onData(buf);\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n    Connection.prototype._onData = function (data) {\r\n        var protobufPacket = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"]();\r\n        protobufPacket.Deserialization(new buffer___WEBPACK_IMPORTED_MODULE_1__["Buffer"](data));\r\n        var handlers = this.mPacketHandlers;\r\n        handlers.forEach(function (handler) {\r\n            handler.onPacketArrived(protobufPacket);\r\n        });\r\n    };\r\n    Connection.prototype.reConnect = function () {\r\n        this.mHeartBeatWorker.postMessage({ method: "endHeartBeat" });\r\n        var world = this.mPacketHandlers[0];\r\n        world.reconnect();\r\n    };\r\n    Connection.prototype.worldStartHeartBeat = function () {\r\n        var world = this.mPacketHandlers[0];\r\n        world.startHeartBeat();\r\n    };\r\n    Connection.prototype.endHeartBeat = function () {\r\n        if (this.mHeartBeatWorker) {\r\n            this.mHeartBeatWorker.terminate();\r\n        }\r\n    };\r\n    return Connection;\r\n}());\r\n/* harmony default export */ __webpack_exports__["default"] = (Connection);\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/net/connection.ts?')},"./src/net/http.service.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpService", function() { return HttpService; });\nvar HttpService = /** @class */ (function () {\r\n    function HttpService(mWorld) {\r\n        this.mWorld = mWorld;\r\n    }\r\n    /**\r\n     * 用户关注其他用户\r\n     * @param uids\r\n     */\r\n    HttpService.prototype.follow = function (fuid) {\r\n        return this.post("user/follow", { fuid: fuid });\r\n    };\r\n    /**\r\n     * 用户取消关注其他用户\r\n     * @param fuid\r\n     */\r\n    HttpService.prototype.unfollow = function (fuid) {\r\n        return this.post("user/unfollow", { fuid: fuid });\r\n    };\r\n    /**\r\n     * 检查用户列表是否有关注的用户\r\n     * @param uids\r\n     */\r\n    HttpService.prototype.checkFollowed = function (uids) {\r\n        return this.post("user/check_followed", { "uids": uids });\r\n    };\r\n    /**\r\n     * 登录\r\n     * @param name\r\n     * @param password\r\n     */\r\n    HttpService.prototype.login = function (account, password) {\r\n        return fetch("" + "https://api-dev.tooqing.com/" + "account/signin", {\r\n            body: JSON.stringify({ account: account, password: password }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    /**\r\n     * 请求手机验证码\r\n     * @param name\r\n     */\r\n    HttpService.prototype.requestPhoneCode = function (phone) {\r\n        return fetch("" + "https://api-dev.tooqing.com/" + "account/sms_code", {\r\n            body: JSON.stringify({ phone: phone }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.loginByPhoneCode = function (phone, code) {\r\n        return fetch("" + "https://api-dev.tooqing.com/" + "account/phone_signin", {\r\n            body: JSON.stringify({ phone: phone, code: code, areaCode: "86" }),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json"\r\n            }\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.quickLogin = function () {\r\n        return fetch("" + "https://api-dev.tooqing.com/" + "account/quick_signin", {\r\n            method: "POST",\r\n        }).then(function (response) { return response.json(); });\r\n    };\r\n    /**\r\n     *\r\n     * 获取用户好友列表\r\n     */\r\n    HttpService.prototype.firend = function () {\r\n        return this.get("user/friends");\r\n    };\r\n    /**\r\n     * 获取用户信息\r\n     * @param uid\r\n     */\r\n    HttpService.prototype.userDetail = function (uid) {\r\n        return this.get("account/" + uid + "/detail");\r\n    };\r\n    /**\r\n     * 用户徽章\r\n     * @param uid\r\n     */\r\n    HttpService.prototype.badgecards = function (uid) {\r\n        return this.get("userpackage/" + uid + "/badgecards");\r\n    };\r\n    HttpService.prototype.post = function (uri, body) {\r\n        var account = this.mWorld.account;\r\n        if (!account) {\r\n            return Promise.reject("account does not exist");\r\n        }\r\n        if (!account.accountData) {\r\n            return Promise.reject("token does not exist");\r\n        }\r\n        var data = {\r\n            body: JSON.stringify(body),\r\n            method: "POST",\r\n            headers: {\r\n                "Content-Type": "application/json",\r\n                "X-Pixelpai-TK": account.accountData.token\r\n            }\r\n        };\r\n        return fetch("" + "https://api-dev.tooqing.com/" + uri, data).then(function (response) { return response.json(); });\r\n    };\r\n    HttpService.prototype.get = function (uri) {\r\n        var account = this.mWorld.account;\r\n        if (!account) {\r\n            return Promise.reject("account does not exist");\r\n        }\r\n        if (!account.accountData) {\r\n            return Promise.reject("token does not exist");\r\n        }\r\n        var data = {\r\n            method: "GET",\r\n            headers: {\r\n                "X-Pixelpai-TK": account.accountData.token\r\n            }\r\n        };\r\n        return fetch("" + "https://api-dev.tooqing.com/" + uri, data).then(function (response) { return response.json(); });\r\n    };\r\n    return HttpService;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/net/http.service.ts?')},"./src/role/create.role.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRolePanel", function() { return CreateRolePanel; });\n/* harmony import */ var _ui_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ui/components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _ui_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ui/components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _ui_components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui/components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../rooms/display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../rooms/display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import InputText from "../../../../lib/rexui/plugins/gameobjects/inputtext/InputText";\r\nvar CreateRolePanel = /** @class */ (function (_super) {\r\n    __extends(CreateRolePanel, _super);\r\n    function CreateRolePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "createCharacter";\r\n        _this.mCurPageNum = 0;\r\n        _this.setTween(false);\r\n        var container = _this.scene.add.container(0, 0);\r\n        container.add(_this);\r\n        scene.scale.on("resize", _this.onResize, _this);\r\n        return _this;\r\n        // container.scale = 1 / this.mWorld.uiScale;\r\n    }\r\n    CreateRolePanel.prototype.show = function (param) {\r\n        if (param) {\r\n            this.avatars = param.avatars;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    CreateRolePanel.prototype.preload = function () {\r\n        // this.scene.load.atlas(\r\n        //   this.key,\r\n        //   Url.getRes("ui/create_role/create_role.png"),\r\n        //   Url.getRes("ui/create_role/create_role.json")\r\n        // );\r\n        this.addAtlas(this.key, "create_role/create_role.png", "create_role/create_role.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    CreateRolePanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.setSize(size.width, size.height);\r\n        if (!this.mBackground) {\r\n            return;\r\n        }\r\n        // this.scale = 1 / this.mWorld.uiScale;\r\n        // this.mBackground.x = this.width >> 1;\r\n        // this.mBackground.y = 60 + (this.mBackground.height >> 1);\r\n        // const scale = this.scene.cameras.main.height / 1920;\r\n        var scale = this.scale;\r\n        var width = this.scene.cameras.main.width / scale;\r\n        var height = this.scene.cameras.main.height / scale;\r\n        var centerX = this.scene.cameras.main.centerX / scale;\r\n        // this.setScale(scale);\r\n        // this.mBackground.setScale(scale);\r\n        this.mBackground.x = centerX;\r\n        // this.mBackground.y = 700;\r\n        this.mFoot.x = centerX;\r\n        this.mFoot.y = height - (this.mFoot.height >> 1);\r\n        this.mBackgroundColor.clear();\r\n        this.mBackgroundColor.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        this.mBackgroundColor.fillRect(0, 0, width, height);\r\n        this.mSubmit.x = centerX;\r\n        this.inputText.x = centerX;\r\n        this.mInputTextBg.x = centerX;\r\n        this.dragonbones.x = centerX;\r\n        this.mNextPageBtn.x = width - 150;\r\n        this.mRandomBtn.x = this.mInputTextBg.x + this.mInputTextBg.width / 2 - 26 * this.dpr;\r\n    };\r\n    CreateRolePanel.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mBackground = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg.png",\r\n            x: size.width >> 1,\r\n        });\r\n        this.mBackground.y = this.mBackground.height / 2 + 92 * this.dpr;\r\n        this.add(this.mBackground);\r\n        this.mFoot = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg_foot.png"\r\n        }, false);\r\n        this.add(this.mFoot);\r\n        this.mBackgroundColor = this.scene.make.graphics(undefined, false);\r\n        this.mBackgroundColor.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        this.mBackgroundColor.fillRect(0, 0, size.width, size.height);\r\n        this.addAt(this.mBackgroundColor, 0);\r\n        this.mInputTextBg = new _ui_components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, size.width >> 1, 350 * this.dpr, 255 * this.dpr, 50 * this.dpr, this.key, "input_bg.png", {\r\n            left: 27 * this.dpr,\r\n            top: 24 * this.dpr,\r\n            right: 28 * this.dpr,\r\n            bottom: 24 * this.dpr\r\n        });\r\n        this.add(this.mInputTextBg);\r\n        this.inputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, size.width >> 1, 350 * this.dpr, 160 * this.dpr, 80, {\r\n            type: "input",\r\n            fontSize: 18 * this.dpr + "px",\r\n            color: "#717171",\r\n            align: "center",\r\n            placeholder: "请输入昵称"\r\n        }).setOrigin(0.5);\r\n        this.add(this.inputText);\r\n        var text = "提 交";\r\n        if (this.mShowData && this.mShowData.button) {\r\n            text = this.mShowData.button.text;\r\n        }\r\n        var frame = this.scene.textures.getFrame(this.key, "submit_button_normal");\r\n        var w = 42;\r\n        var h = 43;\r\n        if (frame) {\r\n            w = frame.width;\r\n            h = frame.height;\r\n        }\r\n        this.mSubmit = new _ui_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__["NinePatchButton"](this.scene, size.width >> 1, 445 * this.dpr, 202 * this.dpr, 55 * this.dpr, this.key, "submit_button", text, {\r\n            left: 19 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: w - 2 - 19 * this.dpr,\r\n            bottom: h - 2 - 20 * this.dpr\r\n        });\r\n        this.mSubmit.setTextStyle({\r\n            color: "#976400",\r\n            fontSize: 18 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_6__["Font"].DEFULT_FONT,\r\n        });\r\n        this.mSubmit.setFontStyle("bold");\r\n        this.mSubmit.on("pointerup", this.onSubmitHandler, this);\r\n        this.add(this.mSubmit);\r\n        this.mPrePageBtn = this.scene.make.image({\r\n            x: 60 * this.dpr,\r\n            y: 216 * this.dpr,\r\n            key: this.key,\r\n            frame: "arrow_left.png"\r\n        }).setInteractive();\r\n        this.mPrePageBtn.on("pointerup", this.onPrePageHandler, this);\r\n        this.mNextPageBtn = this.scene.make.image({\r\n            x: size.width - 60 * this.dpr,\r\n            y: this.mPrePageBtn.y,\r\n            key: this.key,\r\n            frame: "arrow.png"\r\n        }).setFlipX(true).setInteractive();\r\n        this.mNextPageBtn.on("pointerup", this.onNextPageHandler, this);\r\n        this.mRandomBtn = this.scene.make.image({\r\n            x: this.mInputTextBg.x,\r\n            y: this.mInputTextBg.y,\r\n            key: this.key,\r\n            frame: "random.png"\r\n        }).setInteractive();\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn, this.mRandomBtn]);\r\n        this.mRandomBtn.on("pointerup", this.onRandomNameHandler, this);\r\n        // const role = this.scene.make.image({\r\n        //   x: size.width >> 1,\r\n        //   y: 560,\r\n        //   key: "role",\r\n        // }, false);\r\n        // this.add(role);\r\n        this.mErrorBg = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "tips_bg.png",\r\n            x: 220 * this.dpr,\r\n            y: 57 * this.dpr\r\n        }).setVisible(false);\r\n        this.mError = this.scene.make.text({\r\n            x: 127 * this.dpr,\r\n            y: 30 * this.dpr,\r\n            style: {\r\n                color: "#26265d",\r\n                font: "bold 34px YaHei",\r\n                wordWrap: {\r\n                    width: 420,\r\n                    useAdvancedWrap: true\r\n                },\r\n            },\r\n        }, false).setVisible(false);\r\n        this.add([this.mErrorBg, this.mError]);\r\n        this.dragonbones = new _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_4__["DragonbonesDisplay"](this.scene, undefined, undefined, true);\r\n        this.dragonbones.scale = this.dpr * 2;\r\n        this.dragonbones.x = size.width >> 1;\r\n        this.dragonbones.y = this.mNextPageBtn.y + 70 * this.dpr;\r\n        // this.dragonbones.y = 286 * this.dpr;\r\n        // this.dragonbones.play("idle");\r\n        this.dragonbones.on("initialized", this.loadDragonbonesComplete, this);\r\n        this.add(this.dragonbones);\r\n        this.setPageNum(0);\r\n        _super.prototype.init.call(this);\r\n        this.resize(0, 0);\r\n    };\r\n    CreateRolePanel.prototype.setAvatars = function (avatars) {\r\n        this.avatars = avatars;\r\n        // this.dragonbones.load(new DragonbonesModel({\r\n        //   id: 0,\r\n        //   avatar: avatars[0]\r\n        // }));\r\n    };\r\n    CreateRolePanel.prototype.showError = function (msg) {\r\n        if (this.mError) {\r\n            this.mError.text = msg;\r\n            this.mError.setVisible(true);\r\n            this.mErrorBg.setVisible(true);\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.setNickName = function (val) {\r\n        if (this.inputText) {\r\n            this.inputText.text = val;\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.destroy = function () {\r\n        if (this.scene)\r\n            this.scene.scale.off("resize", this.onResize, this);\r\n        if (this.dragonbones) {\r\n            this.dragonbones.off("initialized", this.loadDragonbonesComplete, this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CreateRolePanel.prototype.onRandomNameHandler = function () {\r\n        this.emit("randomName");\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.onSubmitHandler = function () {\r\n        this.emit("submit", this.inputText.text, this.avatars[this.mCurPageNum]);\r\n        this.inputText.setBlur();\r\n        if (this.mError) {\r\n            this.mError.setVisible(false);\r\n            this.mErrorBg.setVisible(false);\r\n        }\r\n    };\r\n    CreateRolePanel.prototype.onPrePageHandler = function () {\r\n        this.setPageNum(this.mCurPageNum - 1);\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.onNextPageHandler = function () {\r\n        this.setPageNum(this.mCurPageNum + 1);\r\n        this.inputText.setBlur();\r\n    };\r\n    CreateRolePanel.prototype.setPageNum = function (val) {\r\n        this.mCurPageNum = val;\r\n        if (this.mCurPageNum < 0) {\r\n            this.mCurPageNum = this.avatars.length - 1;\r\n        }\r\n        else if (this.mCurPageNum >= this.avatars.length) {\r\n            this.mCurPageNum = 0;\r\n        }\r\n        this.dragonbones.load(new _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_5__["DragonbonesModel"]({\r\n            id: 0,\r\n            avatar: this.avatars[this.mCurPageNum]\r\n        }));\r\n    };\r\n    CreateRolePanel.prototype.onResize = function (gameSize) {\r\n        this.resize(gameSize.width, gameSize.height);\r\n    };\r\n    CreateRolePanel.prototype.loadDragonbonesComplete = function () {\r\n        this.dragonbones.play({ name: "idle", flip: false });\r\n    };\r\n    return CreateRolePanel;\r\n}(_ui_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/create.role.panel.ts?')},"./src/role/create.role.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRole", function() { return CreateRole; });\n/* harmony import */ var _scenes_create_character__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../scenes/create.character */ "./src/scenes/create.character.ts");\n/* harmony import */ var _create_role_panel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./create.role.panel */ "./src/role/create.role.panel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar CreateRole = /** @class */ (function (_super) {\r\n    __extends(CreateRole, _super);\r\n    function CreateRole($roleManager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.roleManager = $roleManager;\r\n        _this.world = _this.roleManager.world;\r\n        return _this;\r\n    }\r\n    CreateRole.prototype.enter = function (content) {\r\n        this.mAvatars = content.avatars;\r\n        this.mParam = content;\r\n        if (!this.world.game.scene.getScene(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name))\r\n            this.world.game.scene.add(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name, _scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"]);\r\n        this.world.game.scene.start(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name, {\r\n            world: this.world,\r\n            role: this\r\n        });\r\n    };\r\n    CreateRole.prototype.start = function (scene) {\r\n        this.createPanel = new _create_role_panel__WEBPACK_IMPORTED_MODULE_1__["CreateRolePanel"](scene, this.world);\r\n        this.createPanel.show(this.mParam);\r\n        this.createPanel.on("randomName", this.onRandomNameHandler, this);\r\n        this.createPanel.on("submit", this.onSubmitHandler, this);\r\n        if (this.world.connection) {\r\n            this.world.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_ERROR_MESSAGE, this.onCreateErrorHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CREATE_ROLE_GENERATE_NEW_NAME, this.onGenerateNameHandler);\r\n        }\r\n    };\r\n    CreateRole.prototype.destroy = function () {\r\n        if (this.world.connection) {\r\n            this.world.connection.removePacketListener(this);\r\n        }\r\n        this.world.game.scene.remove(_scenes_create_character__WEBPACK_IMPORTED_MODULE_0__["CreateRoleScene"].name);\r\n        // if (this.createPanel) this.createPanel.destroy();\r\n    };\r\n    CreateRole.prototype.onRandomNameHandler = function () {\r\n        var connection = this.world.connection;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE_GENERATE_NEW_NAME);\r\n        connection.send(packet);\r\n    };\r\n    CreateRole.prototype.onSubmitHandler = function (name, avatar) {\r\n        var connection = this.world.connection;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CREATE_ROLE);\r\n        var content = packet.content;\r\n        content.name = name;\r\n        content.avatar = avatar;\r\n        connection.send(packet);\r\n    };\r\n    CreateRole.prototype.onCreateErrorHandler = function (packet) {\r\n        if (!this.createPanel) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        this.createPanel.showError(content.errorMsg);\r\n    };\r\n    CreateRole.prototype.onGenerateNameHandler = function (packet) {\r\n        if (!this.createPanel) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        this.createPanel.setNickName(content.name);\r\n    };\r\n    return CreateRole;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/create.role.ts?')},"./src/role/role.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoleManager", function() { return RoleManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _create_role__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./create.role */ "./src/role/create.role.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n/**\r\n * 角色创建，选择管理\r\n */\r\nvar RoleManager = /** @class */ (function (_super) {\r\n    __extends(RoleManager, _super);\r\n    function RoleManager($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        return _this;\r\n    }\r\n    RoleManager.prototype.register = function () {\r\n        if (this.world) {\r\n            var connection = this.world.connection;\r\n            if (connection) {\r\n                connection.addPacketListener(this);\r\n                this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_CREATE_ROLE_UI, this.onOpenCreateCharacter);\r\n                this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CLOSE_CREATE_ROLE_UI, this.onCloseCreateCharacterHandler);\r\n            }\r\n        }\r\n    };\r\n    RoleManager.prototype.unregister = function () {\r\n        if (this.world) {\r\n            var connection = this.world.connection;\r\n            if (connection) {\r\n                connection.removePacketListener(this);\r\n            }\r\n        }\r\n    };\r\n    RoleManager.prototype.onOpenCreateCharacter = function (packet) {\r\n        this.mCreateCharacter = new _create_role__WEBPACK_IMPORTED_MODULE_1__["CreateRole"](this);\r\n        this.mCreateCharacter.enter(packet.content);\r\n    };\r\n    RoleManager.prototype.onCloseCreateCharacterHandler = function () {\r\n        if (this.mCreateCharacter) {\r\n            this.mCreateCharacter.destroy();\r\n            this.mCreateCharacter = undefined;\r\n        }\r\n    };\r\n    return RoleManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/role/role.manager.ts?')},"./src/rooms/Animation/bubble.animation.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BubbleAnimation", function() { return BubbleAnimation; });\n/* harmony import */ var _ianimationbase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ianimationbase */ "./src/rooms/Animation/ianimationbase.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar BubbleAnimation = /** @class */ (function (_super) {\r\n    __extends(BubbleAnimation, _super);\r\n    function BubbleAnimation(scene) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.loaded = false;\r\n        _this.isPlaying = false;\r\n        _this.loop = false;\r\n        return _this;\r\n    }\r\n    BubbleAnimation.prototype.load = function (resName, resUrl, data) {\r\n        this.resName = resName ? resName : resUrl;\r\n        this.resUrl = resUrl;\r\n        this.animUrlData = new _ianimationbase__WEBPACK_IMPORTED_MODULE_0__["AnimationUrlData"]();\r\n        if (resName)\r\n            this.animUrlData.setData(this.resName, this.resUrl);\r\n        else\r\n            this.animUrlData.setDisplayData(resUrl, data);\r\n        this.scene.load.image(this.resName, this.animUrlData.pngUrl);\r\n        this.scene.load.image(this.animUrlData.jsonUrl, this.animUrlData.jsonUrl);\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n        this.scene.load.start();\r\n    };\r\n    BubbleAnimation.prototype.play = function (aniName) {\r\n        this.isPlaying = true;\r\n        if (!this.frameAnim)\r\n            return;\r\n        this.setScale(0.2, 0.2);\r\n        this.y = 50;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            y: { value: -100, duration: 300, ease: "Bounce.easeOut" },\r\n            scaleX: { value: 1, duration: 300, ease: "Bounce.easeOut" },\r\n            scaleY: { value: 1, duration: 300, ease: "Bounce.easeOut" },\r\n        });\r\n    };\r\n    BubbleAnimation.prototype.destroy = function () {\r\n        if (this.frameAnim)\r\n            this.frameAnim.destroy();\r\n        if (this.bubblebg)\r\n            this.bubblebg.destroy();\r\n        if (this.animUrlData)\r\n            this.animUrlData.dispose();\r\n        this.frameAnim = null;\r\n        this.animUrlData = null;\r\n        this.bubblebg = null;\r\n    };\r\n    BubbleAnimation.prototype.onLoadComplete = function (loader, totalComplete, totalFailed) {\r\n        this.loaded = true;\r\n        this.bubblebg = this.scene.add.image(0, 0, this.resName);\r\n        this.frameAnim = this.scene.add.image(0, 0, this.animUrlData.jsonUrl);\r\n        this.add([this.bubblebg, this.frameAnim]);\r\n        if (this.isPlaying)\r\n            this.play();\r\n    };\r\n    return BubbleAnimation;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/Animation/bubble.animation.ts?')},"./src/rooms/Animation/ianimationbase.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnimationUrlData", function() { return AnimationUrlData; });\nvar AnimationUrlData = /** @class */ (function () {\r\n    function AnimationUrlData() {\r\n    }\r\n    AnimationUrlData.prototype.setData = function (resName, resUrl, isbone, extension) {\r\n        if (isbone === void 0) { isbone = false; }\r\n        if (extension === void 0) { extension = ".json"; }\r\n        this.resName = resName;\r\n        this.resUrl = resUrl;\r\n        this.pngUrl = resUrl + "/" + resName + (!isbone ? ".png" : "_tex.png");\r\n        this.jsonUrl = resUrl + "/" + resName + (!isbone ? ".json" : "_tex.json");\r\n        if (isbone)\r\n            this.boneUrl = resUrl + "/" + resName + "_ske" + extension;\r\n        this.responseType = extension === ".dbbin" ? "arraybuffer" : null;\r\n        this.boneXhrSettings = this.responseType ? { responseType: "arraybuffer" } : null;\r\n    };\r\n    AnimationUrlData.prototype.setDisplayData = function (pngUrl, jsonUrl, extension) {\r\n        if (extension === void 0) { extension = ".json"; }\r\n        this.pngUrl = pngUrl;\r\n        this.jsonUrl = jsonUrl;\r\n        this.responseType = extension === ".dbbin" ? "arraybuffer" : null;\r\n        this.boneXhrSettings = this.responseType ? { responseType: "arraybuffer" } : null;\r\n    };\r\n    AnimationUrlData.prototype.dispose = function () {\r\n        this.textureXhrSettings = null;\r\n        this.atlasXhrSettings = null;\r\n        this.boneXhrSettings = null;\r\n    };\r\n    return AnimationUrlData;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/Animation/ianimationbase.ts?')},"./src/rooms/action/AI.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AI", function() { return AI; });\n/* harmony import */ var _AIAction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AIAction */ "./src/rooms/action/AIAction.ts");\n/* harmony import */ var _ActionGroup__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ActionGroup */ "./src/rooms/action/ActionGroup.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar AI = /** @class */ (function (_super) {\r\n    __extends(AI, _super);\r\n    function AI(owner) {\r\n        var _this = _super.call(this) || this;\r\n        _this.owner = owner;\r\n        _this.group = new _ActionGroup__WEBPACK_IMPORTED_MODULE_1__["ActionGroup"]();\r\n        return _this;\r\n    }\r\n    AI.prototype.execute = function () {\r\n        this.group.nextAction();\r\n    };\r\n    AI.prototype.nextAction = function () {\r\n        this.group.nextAction();\r\n    };\r\n    AI.prototype.addAction = function (action, isbreak) {\r\n        if (isbreak === void 0) { isbreak = false; }\r\n        action.group = this.group;\r\n        action.owner = this.owner;\r\n        if (isbreak && this.group.current && this.group.current.isBreak) {\r\n            this.group.stopCurrentAction();\r\n        }\r\n        this.group.addAction(action);\r\n        if (!this.group.isExecuting())\r\n            this.group.nextAction();\r\n    };\r\n    AI.prototype.breakAction = function () {\r\n        this.group.breakAction();\r\n    };\r\n    AI.prototype.destroy = function () {\r\n        this.group.destroy();\r\n        this.owner = null;\r\n    };\r\n    return AI;\r\n}(_AIAction__WEBPACK_IMPORTED_MODULE_0__["AIAction"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/action/AI.ts?')},"./src/rooms/action/AIAction.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AIAction", function() { return AIAction; });\nvar AIAction = /** @class */ (function () {\r\n    function AIAction() {\r\n        this.isBreak = true;\r\n        this.isEnd = false;\r\n    }\r\n    AIAction.prototype.nextAction = function () {\r\n        this.isEnd = true;\r\n        if (this.group) {\r\n            this.group.nextAction();\r\n        }\r\n    };\r\n    AIAction.prototype.destroy = function () {\r\n        this.owner = null;\r\n        this.group = null;\r\n    };\r\n    return AIAction;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/action/AIAction.ts?')},"./src/rooms/action/ActionGroup.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActionGroup", function() { return ActionGroup; });\nvar ActionGroup = /** @class */ (function () {\r\n    function ActionGroup() {\r\n    }\r\n    ActionGroup.prototype.addAction = function (action) {\r\n        if (!this.list)\r\n            this.list = [];\r\n        this.list.push(action);\r\n    };\r\n    ActionGroup.prototype.nextAction = function () {\r\n        if (this.current) {\r\n            this.current.destroy();\r\n            this.current = null;\r\n        }\r\n        if (this.list && this.list.length > 0) {\r\n            this.current = this.list.splice(0, 1)[0];\r\n            this.current.isEnd = false;\r\n            this.current.execute();\r\n        }\r\n    };\r\n    ActionGroup.prototype.setComplHandler = function (handler) {\r\n        this.compHandler = handler;\r\n    };\r\n    ActionGroup.prototype.clear = function () {\r\n        if (this.list) {\r\n            for (var _i = 0, _a = this.list; _i < _a.length; _i++) {\r\n                var action = _a[_i];\r\n                action.destroy();\r\n            }\r\n            this.list.length = 0;\r\n        }\r\n        if (this.current) {\r\n            this.current.destroy();\r\n            this.current = null;\r\n        }\r\n    };\r\n    ActionGroup.prototype.stopCurrentAction = function () {\r\n        if (this.current) {\r\n            this.current.destroy();\r\n            this.current = null;\r\n        }\r\n    };\r\n    ActionGroup.prototype.isExecuting = function () {\r\n        if (this.current && !this.current.isEnd)\r\n            return true;\r\n        return false;\r\n    };\r\n    ActionGroup.prototype.hasLast = function () {\r\n        if (!this.list || this.list.length === 0)\r\n            return false;\r\n        else\r\n            return true;\r\n    };\r\n    ActionGroup.prototype.breakAction = function () {\r\n        for (var _i = 0, _a = this.list; _i < _a.length; _i++) {\r\n            var action = _a[_i];\r\n            action.destroy();\r\n        }\r\n        this.list.length = 0;\r\n        if (this.current && this.current.isBreak) {\r\n            this.current.destroy();\r\n            this.current = null;\r\n        }\r\n    };\r\n    ActionGroup.prototype.destroy = function () {\r\n        this.clear();\r\n        this.list = null;\r\n        if (this.sleepAction) {\r\n            this.sleepAction.destroy();\r\n            this.sleepAction = null;\r\n        }\r\n        if (this.compHandler) {\r\n            this.compHandler.clear();\r\n            this.compHandler = null;\r\n        }\r\n    };\r\n    return ActionGroup;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/action/ActionGroup.ts?')},"./src/rooms/bubble/bubble.container.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BubbleContainer", function() { return BubbleContainer; });\n/* harmony import */ var _bubble__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bubble */ "./src/rooms/bubble/bubble.ts");\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar BubbleContainer = /** @class */ (function (_super) {\r\n    __extends(BubbleContainer, _super);\r\n    function BubbleContainer(scene, scale) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mBubbles = [];\r\n        _this.mScale = scale;\r\n        _this.mArrow = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.mArrow.scale = scale;\r\n        _this.mArrow.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/chat/bubble_arrow.png"));\r\n        _this.add(_this.mArrow);\r\n        return _this;\r\n    }\r\n    BubbleContainer.prototype.addBubble = function (text, bubbleSetting) {\r\n        var bubble = this.createBubble(bubbleSetting);\r\n        var len = this.mBubbles.length;\r\n        var bul = null;\r\n        var h = 0;\r\n        bubble.show(text, bubbleSetting);\r\n        for (var i = len - 1; i >= 0; i--) {\r\n            bul = this.mBubbles[i];\r\n            h += bul.minHeight + 5 * this.mScale;\r\n            bul.tweenTo(-h);\r\n        }\r\n        this.add(bubble);\r\n        this.mArrow.y = 4 * this.mScale;\r\n    };\r\n    BubbleContainer.prototype.updatePos = function (x, y) {\r\n        this.x = x * this.mScale;\r\n        this.y = y * this.mScale;\r\n    };\r\n    BubbleContainer.prototype.destroy = function (fromScene) {\r\n        if (!this.mBubbles)\r\n            return;\r\n        var len = this.mBubbles.length;\r\n        var bul = null;\r\n        for (var i = len - 1; i >= 0; i--) {\r\n            bul = this.mBubbles[i];\r\n            if (!bul)\r\n                continue;\r\n            bul.destroy();\r\n        }\r\n        this.mBubbles = null;\r\n        this.removeFormParent();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    BubbleContainer.prototype.removeFormParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    BubbleContainer.prototype.createBubble = function (bubbleSetting) {\r\n        if (!bubbleSetting)\r\n            return;\r\n        var bubble = new _bubble__WEBPACK_IMPORTED_MODULE_0__["Bubble"](this.scene, this.mScale);\r\n        this.mBubbles.push(bubble);\r\n        var duration = bubbleSetting.duration ? bubbleSetting.duration : 5000;\r\n        bubble.durationRemove(duration, this.onRemoveBubble, this);\r\n        return bubble;\r\n    };\r\n    BubbleContainer.prototype.onRemoveBubble = function (bubble) {\r\n        if (!bubble) {\r\n            return;\r\n        }\r\n        this.mBubbles = this.mBubbles.filter(function (val) { return bubble !== val; });\r\n        this.remove(bubble);\r\n        bubble.destroy();\r\n        if (this.mBubbles.length === 0) {\r\n            this.removeFormParent();\r\n        }\r\n    };\r\n    return BubbleContainer;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/bubble/bubble.container.ts?')},"./src/rooms/bubble/bubble.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bubble", function() { return Bubble; });\n/* harmony import */ var _ui_components_dynamic_ninepatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/components/dynamic.ninepatch */ "./src/ui/components/dynamic.ninepatch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Bubble = /** @class */ (function (_super) {\r\n    __extends(Bubble, _super);\r\n    function Bubble(scene, scale) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mMinWidth = 0;\r\n        _this.mMinHeight = 0;\r\n        _this.mScale = scale;\r\n        _this.x = -40 * scale;\r\n        return _this;\r\n    }\r\n    Bubble.prototype.show = function (text, bubble) {\r\n        this.mChatContent = this.scene.make.text({\r\n            text: text,\r\n            style: {\r\n                x: 0,\r\n                y: 4 * this.mScale,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * this.mScale,\r\n                color: "#000000",\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 300, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.add(this.mChatContent);\r\n        this.mMinHeight = this.mChatContent.height + 26;\r\n        this.mMinHeight = this.mMinHeight < 54 ? 54 : this.mMinHeight;\r\n        this.mMinWidth = this.mChatContent.width + 40;\r\n        this.mMinWidth = this.mMinWidth < 69 ? 69 : this.mMinWidth;\r\n        this.mBubbleBg = new _ui_components_dynamic_ninepatch__WEBPACK_IMPORTED_MODULE_0__["DynamicNinepatch"](this.scene, this);\r\n        var res = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(bubble.bubbleResource || "platformitem/thumbnail/bubble_01.png");\r\n        this.mBubbleBg.load(res, {\r\n            width: this.mMinWidth,\r\n            height: this.mMinHeight,\r\n            key: res,\r\n            columns: [34, 2, 32],\r\n            rows: [42, 2, 9]\r\n        }, this.onComplete, this);\r\n    };\r\n    Bubble.prototype.tweenTo = function (toY) {\r\n        this.mToY = toY;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            y: toY,\r\n            alpha: 1,\r\n            duration: 200\r\n        });\r\n    };\r\n    Bubble.prototype.durationRemove = function (duration, callback, callbackContext) {\r\n        var _this = this;\r\n        this.mTweenCompleteCallback = callback;\r\n        this.mTweenCallContext = callbackContext;\r\n        this.mRemoveDelay = setTimeout(function () {\r\n            _this.removeTween();\r\n        }, duration);\r\n    };\r\n    Bubble.prototype.removeTween = function () {\r\n        var _this = this;\r\n        var endY = this.mToY - 30;\r\n        var tween = this.scene.tweens.add({\r\n            targets: this,\r\n            y: endY,\r\n            alpha: 0,\r\n            duration: 200,\r\n            onComplete: function () {\r\n                if (_this.mTweenCompleteCallback) {\r\n                    _this.mTweenCompleteCallback.call(_this.mTweenCallContext, _this);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    Bubble.prototype.destroy = function () {\r\n        if (this.mChatContent) {\r\n            this.mChatContent.destroy(true);\r\n        }\r\n        this.mChatContent = null;\r\n        this.mMinWidth = 0;\r\n        this.mMinHeight = 0;\r\n        this.mToY = 0;\r\n        this.mTweenCompleteCallback = null;\r\n        this.mTweenCallContext = null;\r\n        if (this.mRemoveDelay) {\r\n            clearTimeout(this.mRemoveDelay);\r\n        }\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Bubble.prototype.onComplete = function (img) {\r\n        if (img) {\r\n            img.setOrigin(0, 0);\r\n            this.addAt(img, 0);\r\n            var bound = this.getBounds();\r\n            this.mChatContent.x = this.mMinWidth - this.mChatContent.width >> 1;\r\n            this.mChatContent.y = (this.mMinHeight - this.mChatContent.height >> 1) + 6;\r\n        }\r\n    };\r\n    Object.defineProperty(Bubble.prototype, "minWidth", {\r\n        get: function () {\r\n            return this.mMinWidth;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Bubble.prototype, "minHeight", {\r\n        get: function () {\r\n            return this.mMinHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Bubble;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/bubble/bubble.ts?')},"./src/rooms/cameras/block.object.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockObject", function() { return BlockObject; });\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n\r\n\r\nvar BlockObject = /** @class */ (function () {\r\n    function BlockObject(mRoomService) {\r\n        this.mRoomService = mRoomService;\r\n        this.isUsed = false;\r\n        this.mRenderable = false;\r\n        this.mBlockable = true;\r\n        this.mInputEnable = _element_element__WEBPACK_IMPORTED_MODULE_0__["InputEnable"].Diasble;\r\n        this.isUsed = true;\r\n    }\r\n    BlockObject.prototype.setRenderable = function (isRenderable, delay) {\r\n        var _this = this;\r\n        if (delay === void 0) { delay = 0; }\r\n        if (this.mRenderable !== isRenderable) {\r\n            this.mRenderable = isRenderable;\r\n            if (isRenderable) {\r\n                this.addDisplay();\r\n                if (delay > 0) {\r\n                    this.fadeIn();\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                if (delay > 0) {\r\n                    this.fadeOut(function () {\r\n                        _this.removeDisplay();\r\n                    });\r\n                }\r\n                else {\r\n                    this.removeDisplay();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    BlockObject.prototype.getPosition = function () {\r\n        var pos;\r\n        if (this.mDisplay) {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](this.mDisplay.x, this.mDisplay.y, this.mDisplay.z);\r\n        }\r\n        else {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"]();\r\n        }\r\n        return pos;\r\n    };\r\n    BlockObject.prototype.getPosition45 = function () {\r\n        var pos = this.getPosition();\r\n        if (!pos)\r\n            return new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"]();\r\n        return this.mRoomService.transformTo45(pos);\r\n    };\r\n    BlockObject.prototype.getRenderable = function () {\r\n        return this.mRenderable;\r\n    };\r\n    BlockObject.prototype.fadeIn = function (callback) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        this.mDisplay.fadeIn(callback);\r\n    };\r\n    BlockObject.prototype.fadeOut = function (callback) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        this.mDisplay.fadeOut(callback);\r\n    };\r\n    BlockObject.prototype.fadeAlpha = function (alpha) {\r\n        if (!this.mDisplay)\r\n            return;\r\n        // this.mDisplay.alpha = alpha;\r\n    };\r\n    BlockObject.prototype.setInputEnable = function (val) {\r\n        // if (this.mInputEnable !== val) {\r\n        this.mInputEnable = val;\r\n        if (this.mDisplay) {\r\n            switch (val) {\r\n                case _element_element__WEBPACK_IMPORTED_MODULE_0__["InputEnable"].Interactive:\r\n                    if (this.mModel && this.mModel.hasInteractive) {\r\n                        this.mDisplay.setInteractive();\r\n                    }\r\n                    break;\r\n                case _element_element__WEBPACK_IMPORTED_MODULE_0__["InputEnable"].Enable:\r\n                    this.mDisplay.setInteractive();\r\n                    break;\r\n                default:\r\n                    this.mDisplay.disableInteractive();\r\n                    break;\r\n            }\r\n        }\r\n        // }\r\n    };\r\n    BlockObject.prototype.setBlockable = function (val) {\r\n        if (this.mBlockable !== val) {\r\n            this.mBlockable = val;\r\n            if (this.mDisplay && this.mRoomService) {\r\n                if (val) {\r\n                    this.mRoomService.addBlockObject(this);\r\n                }\r\n                else {\r\n                    this.mRoomService.removeBlockObject(this);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    BlockObject.prototype.destroy = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n    };\r\n    BlockObject.prototype.clear = function () {\r\n        this.isUsed = false;\r\n    };\r\n    BlockObject.prototype.addDisplay = function () { };\r\n    BlockObject.prototype.removeDisplay = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.removeFromParent();\r\n    };\r\n    BlockObject.prototype.addToBlock = function () {\r\n        if (this.mBlockable) {\r\n            this.mRoomService.addBlockObject(this);\r\n        }\r\n        else {\r\n            this.addDisplay();\r\n        }\r\n    };\r\n    BlockObject.prototype.removeFromBlock = function (remove) {\r\n        if (this.mBlockable) {\r\n            this.mRoomService.removeBlockObject(this);\r\n            if (remove) {\r\n                this.setRenderable(false);\r\n            }\r\n        }\r\n    };\r\n    BlockObject.prototype.updateBlock = function () {\r\n        if (this.mBlockable) {\r\n            this.mRoomService.updateBlockObject(this);\r\n        }\r\n    };\r\n    Object.defineProperty(BlockObject.prototype, "id", {\r\n        get: function () {\r\n            return -1;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return BlockObject;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/block.object.ts?')},"./src/rooms/cameras/cameras.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CamerasManager", function() { return CamerasManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_rectangle45__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/rectangle45 */ "./src/utils/rectangle45.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar CamerasManager = /** @class */ (function (_super) {\r\n    __extends(CamerasManager, _super);\r\n    function CamerasManager(mRoomService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.MINI_VIEW_SIZE = 30;\r\n        _this.VIEW_PORT_SIZE = 30;\r\n        _this.viewPort = new Phaser.Geom.Rectangle();\r\n        _this.miniViewPort = new Phaser.Geom.Rectangle();\r\n        _this.zoom = 1;\r\n        if (_this.mRoomService && _this.mRoomService.world) {\r\n            _this.zoom = _this.mRoomService.world.scaleRatio;\r\n        }\r\n        _this.mCameras = [];\r\n        return _this;\r\n        // this.zoom = this.mRoomService.world.scaleRatio;\r\n    }\r\n    CamerasManager.prototype.getViewPort = function () {\r\n        if (!this.mMain)\r\n            return;\r\n        var worldView = this.mMain.worldView;\r\n        // const out = new Phaser.Geom.Rectangle(worldView.x, worldView.y, worldView.width, worldView.height);\r\n        // out.x -= out.width >> 1;\r\n        // out.y -= out.height >> 1;\r\n        // out.width *= 2;\r\n        // out.height *= 2;\r\n        // out.x -= 200;\r\n        // out.y -= 200;\r\n        // out.width += 400;\r\n        // out.height += 400;\r\n        // this.viewPort.setPosition(worldView.x - worldView.width / 2, worldView.y - worldView.height / 2);\r\n        this.viewPort.x = worldView.x / this.zoom + (worldView.width / this.zoom - this.viewPort.width >> 1);\r\n        this.viewPort.y = worldView.y / this.zoom + (worldView.height / this.zoom - this.viewPort.height >> 1);\r\n        return this.viewPort;\r\n    };\r\n    CamerasManager.prototype.getMiniViewPort = function () {\r\n        if (!this.mMain)\r\n            return;\r\n        var worldView = this.mMain.worldView;\r\n        this.miniViewPort.x = worldView.x / this.zoom + (worldView.width / this.zoom - this.miniViewPort.width >> 1);\r\n        this.miniViewPort.y = worldView.y / this.zoom + (worldView.height / this.zoom - this.miniViewPort.height >> 1);\r\n        var pos = this.mRoomService.transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](this.miniViewPort.x + (this.miniViewPort.width >> 1), this.miniViewPort.y));\r\n        return new _utils_rectangle45__WEBPACK_IMPORTED_MODULE_3__["Rectangle45"](pos.x, pos.y, this.MINI_VIEW_SIZE, this.MINI_VIEW_SIZE);\r\n    };\r\n    Object.defineProperty(CamerasManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mMain;\r\n        },\r\n        set: function (camera) {\r\n            this.mMain = camera;\r\n            this.addCamera(camera);\r\n            this.setViewPortSize();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    CamerasManager.prototype.resize = function (width, height) {\r\n        this.resetCameraSize(width, height);\r\n    };\r\n    CamerasManager.prototype.setScroll = function (x, y) {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n            var camera = _a[_i];\r\n            camera.setScroll(x, y);\r\n        }\r\n        // this.mMain.setScroll(x, y);\r\n    };\r\n    CamerasManager.prototype.offsetScroll = function (x, y) {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n            var camera = _a[_i];\r\n            camera.scrollX += x / this.camera.zoom;\r\n            camera.scrollY += y / this.camera.zoom;\r\n        }\r\n        this.moving = true;\r\n        // this.mCamera.setScroll(x, y);\r\n    };\r\n    CamerasManager.prototype.startFollow = function (target) {\r\n        this.mTarget = target;\r\n        if (this.mMain && target) {\r\n            for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n                var camera = _a[_i];\r\n                camera.startFollow(target);\r\n            }\r\n            // this.mMain.startFollow(target);\r\n        }\r\n    };\r\n    CamerasManager.prototype.stopFollow = function () {\r\n        this.mTarget = null;\r\n        if (this.mMain) {\r\n            for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n                var camera = _a[_i];\r\n                camera.stopFollow();\r\n            }\r\n            // this.mMain.stopFollow();\r\n        }\r\n    };\r\n    CamerasManager.prototype.addCamera = function (camera) {\r\n        var index = this.mCameras.indexOf(camera);\r\n        if (index === -1) {\r\n            this.mCameras.push(camera);\r\n        }\r\n        if (this.mTarget) {\r\n            camera.startFollow(this.mTarget);\r\n        }\r\n    };\r\n    CamerasManager.prototype.removeCamera = function (camera) {\r\n        var index = this.mCameras.indexOf(camera);\r\n        if (index > -1) {\r\n            this.mCameras.splice(index, 1);\r\n        }\r\n    };\r\n    CamerasManager.prototype.setBounds = function (x, y, width, height, centerOn) {\r\n        if (!this.mMain) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("camera does not exist");\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n            var camera = _a[_i];\r\n            camera.setBounds(x, y, width, height, centerOn);\r\n        }\r\n        // this.mMain.setBounds(x, y, width, height, centerOn);\r\n    };\r\n    CamerasManager.prototype.setPosition = function (x, y) {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n            var camera = _a[_i];\r\n            camera.setPosition(x, y);\r\n        }\r\n        // this.mMain.setPosition(x, y);\r\n    };\r\n    CamerasManager.prototype.syncToEditor = function () {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        var cameraView = this.mMain.worldView;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = cameraView.x;\r\n        content.y = cameraView.y;\r\n        content.width = cameraView.width;\r\n        content.height = cameraView.height;\r\n        this.connection.send(pkt);\r\n    };\r\n    CamerasManager.prototype.centerCameas = function () {\r\n    };\r\n    CamerasManager.prototype.syncCamera = function () {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_RESET_CAMERA_SIZE);\r\n        var size = packet.content;\r\n        size.width = this.mMain.width / this.mMain.zoom;\r\n        size.height = this.mMain.height / this.mMain.zoom;\r\n        this.connection.send(packet);\r\n    };\r\n    CamerasManager.prototype.syncCameraScroll = function () {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SET_CAMERA_POSITION);\r\n        var content = pkt.content;\r\n        var pos = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PBPoint3f.create();\r\n        pos.x = this.mMain.scrollX / Math.ceil(window.devicePixelRatio);\r\n        pos.y = this.mMain.scrollY / Math.ceil(window.devicePixelRatio);\r\n        content.pos = pos;\r\n        this.connection.send(pkt);\r\n    };\r\n    CamerasManager.prototype.scrollTargetPoint = function (x, y) {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        this.setScroll(x * this.mRoomService.world.scaleRatio - this.mMain.width / 2, y * this.mRoomService.world.scaleRatio - this.mMain.height / 2);\r\n    };\r\n    CamerasManager.prototype.destroy = function () {\r\n        this.mMain = undefined;\r\n        this.mCameras = [];\r\n    };\r\n    CamerasManager.prototype.resetCameraSize = function (width, height) {\r\n        if (!this.connection) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("connection is undefined");\r\n            return;\r\n        }\r\n        this.syncCamera();\r\n    };\r\n    CamerasManager.prototype.setViewPortSize = function () {\r\n        if (!this.mMain) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("camera does not exist");\r\n            return;\r\n        }\r\n        var size = this.mRoomService.roomSize;\r\n        if (!size) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room size does not exist");\r\n            return;\r\n        }\r\n        var viewW = (this.VIEW_PORT_SIZE + this.VIEW_PORT_SIZE) * (size.tileWidth / 2);\r\n        var viewH = (this.VIEW_PORT_SIZE + this.VIEW_PORT_SIZE) * (size.tileHeight / 2);\r\n        this.viewPort.setSize(viewW, viewH);\r\n        var miniViewW = (this.MINI_VIEW_SIZE + this.MINI_VIEW_SIZE) * (size.tileWidth / 2);\r\n        var miniviewH = (this.MINI_VIEW_SIZE + this.MINI_VIEW_SIZE) * (size.tileHeight / 2);\r\n        this.miniViewPort.setSize(miniViewW, miniviewH);\r\n    };\r\n    Object.defineProperty(CamerasManager.prototype, "connection", {\r\n        get: function () {\r\n            if (!this.mRoomService) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room service is undefined");\r\n                return;\r\n            }\r\n            return this.mRoomService.connection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CamerasManager.prototype, "moving", {\r\n        get: function () {\r\n            return this.mMoving;\r\n        },\r\n        set: function (val) {\r\n            this.mMoving = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CamerasManager.prototype, "targetFollow", {\r\n        get: function () {\r\n            return this.mTarget;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return CamerasManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/cameras.manager.ts?')},"./src/rooms/cameras/editor.cameras.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorCamerasManager", function() { return EditorCamerasManager; });\n/* harmony import */ var _cameras_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cameras.manager */ "./src/rooms/cameras/cameras.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar EditorCamerasManager = /** @class */ (function (_super) {\r\n    __extends(EditorCamerasManager, _super);\r\n    function EditorCamerasManager() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    EditorCamerasManager.prototype.centerCameas = function () {\r\n        if (!this.mMain || !this.mRoomService) {\r\n            return;\r\n        }\r\n        var roomSize = this.mRoomService.roomSize;\r\n        this.mMain.setScroll((roomSize.sceneWidth - this.mMain.width) >> 1, (roomSize.sceneHeight - this.mMain.height) >> 1);\r\n        var cameraView = this.mMain.worldView;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = this.mMain.scrollX;\r\n        content.y = this.mMain.scrollY;\r\n        content.width = this.mMain.width;\r\n        content.height = this.mMain.height;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorCamerasManager.prototype.offsetScroll = function (x, y) {\r\n        if (!this.mMain) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mCameras; _i < _a.length; _i++) {\r\n            var camera = _a[_i];\r\n            camera.scrollX += x / this.zoom;\r\n            camera.scrollY += y / this.zoom;\r\n        }\r\n        // this.mMain.scrollX += x / this.zoom;\r\n        // this.mMain.scrollY += y / this.zoom;\r\n        // this.mCamera.setScroll(x, y);\r\n        // const pkt = new PBpacket(op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        // const content: op_editor.IOP_CLIENT_REQ_EDITOR_RESET_CAMERA = pkt.content;\r\n        // content.x = this.mMain.scrollX / this.zoom;\r\n        // content.y = this.mMain.scrollY / this.zoom;\r\n        // content.width = 0;\r\n        // content.height = 0;\r\n        // this.connection.send(pkt);\r\n    };\r\n    EditorCamerasManager.prototype.syncCameraScroll = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_RESET_CAMERA);\r\n        var content = pkt.content;\r\n        content.x = this.mMain.scrollX / this.zoom;\r\n        content.y = this.mMain.scrollY / this.zoom;\r\n        content.width = 0;\r\n        content.height = 0;\r\n        this.connection.send(pkt);\r\n    };\r\n    return EditorCamerasManager;\r\n}(_cameras_manager__WEBPACK_IMPORTED_MODULE_0__["CamerasManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/editor.cameras.manager.ts?')},"./src/rooms/cameras/play.camera.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayCamera", function() { return PlayCamera; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar PlayCamera = /** @class */ (function (_super) {\r\n    __extends(PlayCamera, _super);\r\n    function PlayCamera(x, y, width, height, pixelRatio, moveRatio) {\r\n        var _this = _super.call(this, x, y, width, height) || this;\r\n        _this.pixelRatio = pixelRatio;\r\n        _this.moveRatio = moveRatio || 1;\r\n        return _this;\r\n    }\r\n    PlayCamera.prototype.startFollow = function (target, roundPixels, lerpX, lerpY, offsetX, offsetY) {\r\n        if (roundPixels === undefined) {\r\n            roundPixels = false;\r\n        }\r\n        if (lerpX === undefined) {\r\n            lerpX = 1;\r\n        }\r\n        if (lerpY === undefined) {\r\n            lerpY = lerpX;\r\n        }\r\n        if (offsetX === undefined) {\r\n            offsetX = 0;\r\n        }\r\n        if (offsetY === undefined) {\r\n            offsetY = offsetX;\r\n        }\r\n        this._follow = target;\r\n        this.roundPixels = roundPixels;\r\n        // lerpX = Clamp(lerpX, 0, 1);\r\n        // lerpY = Clamp(lerpY, 0, 1);\r\n        this.lerp.set(lerpX, lerpY);\r\n        this.followOffset.set(offsetX, offsetY);\r\n        var originX = this.width / 2;\r\n        var originY = this.height / 2;\r\n        var fx = target.x * this.pixelRatio * this.moveRatio - offsetX;\r\n        var fy = target.y * this.pixelRatio * this.moveRatio - offsetY;\r\n        this.midPoint.set(fx, fy);\r\n        this.scrollX = fx - originX;\r\n        this.scrollY = fy - originY;\r\n        if (this.useBounds) {\r\n            this.scrollX = this.clampX(this.scrollX);\r\n            this.scrollY = this.clampY(this.scrollY);\r\n        }\r\n        return this;\r\n    };\r\n    PlayCamera.prototype.preRender = function (resolution) {\r\n        var width = this.width;\r\n        var height = this.height;\r\n        var halfWidth = width * 0.5;\r\n        var halfHeight = height * 0.5;\r\n        var zoom = this.zoom * resolution;\r\n        var matrix = this.matrix;\r\n        var originX = width * this.originX;\r\n        var originY = height * this.originY;\r\n        var follow = this._follow;\r\n        var deadzone = this.deadzone;\r\n        var sx = this.scrollX;\r\n        var sy = this.scrollY;\r\n        if (deadzone) {\r\n            // CenterOn(deadzone, this.midPoint.x, this.midPoint.y);\r\n        }\r\n        if (follow && !this.panEffect.isRunning) {\r\n            var fx = (follow.x * this.pixelRatio * this.moveRatio - this.followOffset.x);\r\n            var fy = (follow.y * this.pixelRatio * this.moveRatio - this.followOffset.y);\r\n            if (deadzone) {\r\n                if (fx < deadzone.x) {\r\n                    sx = this.linear(sx, sx - (deadzone.x - fx), this.lerp.x);\r\n                }\r\n                else if (fx > deadzone.right) {\r\n                    sx = this.linear(sx, sx + (fx - deadzone.right), this.lerp.x);\r\n                }\r\n                if (fy < deadzone.y) {\r\n                    sy = this.linear(sy, sy - (deadzone.y - fy), this.lerp.y);\r\n                }\r\n                else if (fy > deadzone.bottom) {\r\n                    sy = this.linear(sy, sy + (fy - deadzone.bottom), this.lerp.y);\r\n                }\r\n            }\r\n            else {\r\n                sx = this.linear(sx, fx - originX, this.lerp.x);\r\n                sy = this.linear(sy, fy - originY, this.lerp.y);\r\n            }\r\n        }\r\n        if (this.useBounds) {\r\n            sx = this.clampX(sx);\r\n            sy = this.clampY(sy);\r\n        }\r\n        if (this.roundPixels) {\r\n            originX = Math.round(originX);\r\n            originY = Math.round(originY);\r\n        }\r\n        //  Values are in pixels and not impacted by zooming the Camera\r\n        this.scrollX = sx;\r\n        this.scrollY = sy;\r\n        var midX = sx + halfWidth;\r\n        var midY = sy + halfHeight;\r\n        //  The center of the camera, in world space, so taking zoom into account\r\n        //  Basically the pixel value of what it\'s looking at in the middle of the cam\r\n        this.midPoint.set(midX, midY);\r\n        var displayWidth = width / zoom;\r\n        var displayHeight = height / zoom;\r\n        this.worldView.setTo(midX - (displayWidth / 2), midY - (displayHeight / 2), displayWidth, displayHeight);\r\n        matrix.applyITRS(this.x + originX, this.y + originY, this.rotation, zoom, zoom);\r\n        matrix.translate(-originX, -originY);\r\n        this.shakeEffect.preRender();\r\n    };\r\n    PlayCamera.prototype.linear = function (p0, p1, t) {\r\n        return (p1 - p0) * t + p0;\r\n    };\r\n    return PlayCamera;\r\n}(Phaser.Cameras.Scene2D.Camera));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/play.camera.ts?')},"./src/rooms/cameras/viewblock.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ViewblockManager", function() { return ViewblockManager; });\n/* harmony import */ var _viewblock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./viewblock */ "./src/rooms/cameras/viewblock.ts");\n\r\nvar ViewblockManager = /** @class */ (function () {\r\n    function ViewblockManager(cameras) {\r\n        this.mBlocks = [];\r\n        this.mDelay = 0;\r\n        this.mCameras = cameras;\r\n    }\r\n    ViewblockManager.prototype.add = function (e) {\r\n        if (!this.mCameras)\r\n            return false;\r\n        var miniView = this.mCameras.getMiniViewPort();\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            var rect = block.rectangle;\r\n            var ePos = e.getPosition();\r\n            if (!ePos)\r\n                return;\r\n            if (rect.contains(ePos.x, ePos.y)) {\r\n                block.add(e, miniView);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.remove = function (e) {\r\n        if (!e)\r\n            return;\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            if (block.remove(e)) {\r\n                return;\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.check = function (e) {\r\n        if (!e)\r\n            return;\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            if (block.inCamera) {\r\n                var rect = block.rectangle;\r\n                var pos = e.getPosition();\r\n                if (rect.contains(pos.x, pos.y)) {\r\n                    if (!block.getElement(e.id)) {\r\n                        this.remove(e);\r\n                        block.add(e);\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.int = function (size) {\r\n        if (!size) {\r\n            return;\r\n        }\r\n        this.mBlocks = [];\r\n        var colSize = 10;\r\n        var viewW = (colSize + colSize) * (size.tileWidth / 2);\r\n        var viewH = (colSize + colSize) * (size.tileHeight / 2);\r\n        var blockW = size.sceneWidth / viewW;\r\n        var blockH = size.sceneHeight / viewH;\r\n        var index = 0;\r\n        for (var i = 0; i < blockW; i++) {\r\n            for (var j = 0; j < blockH; j++) {\r\n                var block = new _viewblock__WEBPACK_IMPORTED_MODULE_0__["Viewblock"](new Phaser.Geom.Rectangle(i * viewW, j * viewH, viewW, viewH), index++);\r\n                this.mBlocks.push(block);\r\n                // this.layerManager.addToAtmosphere(block.drawBoard(this.scene));\r\n            }\r\n        }\r\n    };\r\n    ViewblockManager.prototype.update = function (time, delta) {\r\n        if (!this.mCameras)\r\n            return;\r\n        // if (time - this.mDelay < 3000) {\r\n        //     return;\r\n        // }\r\n        this.mDelay = time;\r\n        var bound = this.mCameras.getViewPort();\r\n        var miniViewPort = this.mCameras.getMiniViewPort();\r\n        for (var _i = 0, _a = this.mBlocks; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            block.check(bound, miniViewPort);\r\n        }\r\n    };\r\n    ViewblockManager.prototype.destroy = function () {\r\n        this.mDelay = 0;\r\n    };\r\n    return ViewblockManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/viewblock.manager.ts?')},"./src/rooms/cameras/viewblock.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Viewblock", function() { return Viewblock; });\n/**\r\n * 显示区域\r\n */\r\nvar Viewblock = /** @class */ (function () {\r\n    function Viewblock(mRect, index) {\r\n        this.mRect = mRect;\r\n        // private mElements: IElement[] = [];\r\n        this.mElements = new Map();\r\n        this.mIndex = index;\r\n    }\r\n    Viewblock.prototype.add = function (element, miniViewPort) {\r\n        // this.mElements.push(element);\r\n        this.mElements.set(element.id, element);\r\n        if (!miniViewPort) {\r\n            return;\r\n        }\r\n        var pos = element.getPosition45();\r\n        element.setRenderable(miniViewPort.contains(pos.x, pos.y) && this.mInCamera);\r\n    };\r\n    Viewblock.prototype.remove = function (ele) {\r\n        // const index = this.mElements.indexOf(ele);\r\n        // if (index !== -1) {\r\n        //     this.mElements.splice(index, 1);\r\n        //     return true;\r\n        // }\r\n        return this.mElements.delete(ele.id);\r\n    };\r\n    // tick running... powered by manager.\r\n    Viewblock.prototype.check = function (bound, miniViewPort) {\r\n        if (!bound)\r\n            return;\r\n        var newStat = Phaser.Geom.Intersects.RectangleToRectangle(bound, this.rectangle);\r\n        // if (this.mInCamera !== newStat) {\r\n        //     for (const e of this.mElements) {\r\n        //         根据情况看是否需要提前加载\r\n        //         e.setRenderable(newStat);\r\n        //     }\r\n        // }\r\n        if (!miniViewPort)\r\n            return;\r\n        if (this.mInCamera) {\r\n            // for (const ele of this.mElements) {\r\n            //     const pos = ele.getPosition45();\r\n            //     ele.setRenderable(miniViewPort.contains(pos.x, pos.y), 1000);\r\n            // }\r\n            this.mElements.forEach(function (ele) {\r\n                var pos = ele.getPosition45();\r\n                ele.setRenderable(miniViewPort.contains(pos.x, pos.y), 0);\r\n            });\r\n        }\r\n        this.mInCamera = newStat;\r\n    };\r\n    Viewblock.prototype.getElement = function (id) {\r\n        return this.mElements.get(id);\r\n    };\r\n    Object.defineProperty(Viewblock.prototype, "rectangle", {\r\n        get: function () {\r\n            return this.mRect || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Viewblock.prototype, "inCamera", {\r\n        get: function () {\r\n            return this.mInCamera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Viewblock;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/cameras/viewblock.ts?')},"./src/rooms/clock.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Clock", function() { return Clock; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_algorithm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/algorithm */ "./src/utils/algorithm.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar LATENCY_SAMPLES = 7; // Latency Array length\r\nvar MIN_READY_SAMPLES = 2;\r\nvar CHECK_INTERVAL = 8000; // (ms)\r\nvar MAX_DELAY = 500; // (ms)\r\nvar Clock = /** @class */ (function (_super) {\r\n    __extends(Clock, _super);\r\n    function Clock(conn, listener) {\r\n        var _this = _super.call(this) || this;\r\n        // clock是否同步完成\r\n        _this.mClockSync = false;\r\n        _this.mAutoSync = false;\r\n        _this.mTimestamp = 0; // The timestamp in JavaScript is expressed in milliseconds.\r\n        _this.mLatency = [];\r\n        _this.mConn = conn;\r\n        _this.mConn.addPacketListener(_this);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SYNC_TIME, _this.proof);\r\n        _this.mListener = listener;\r\n        _this._check();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Clock.prototype, "sysUnixTime", {\r\n        get: function () {\r\n            return new Date().getTime();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Clock.prototype, "unixTime", {\r\n        get: function () {\r\n            return this.mTimestamp;\r\n        },\r\n        set: function (t) {\r\n            this.mTimestamp = t;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Clock.prototype.sync = function (times) {\r\n        if (times === void 0) { times = 1; }\r\n        if (!this.mConn)\r\n            return;\r\n        if (times < 0) {\r\n            times = 1;\r\n        }\r\n        for (var i = 0; i < times; ++i) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_TIME);\r\n            var ct = pkt.content;\r\n            ct.clientStartTs = this.sysUnixTime;\r\n            this.mConn.send(pkt);\r\n        }\r\n    };\r\n    Clock.prototype.update = function (time, delta) {\r\n        if (!this.mTimestamp)\r\n            this.mTimestamp = time;\r\n        else\r\n            this.mTimestamp += delta;\r\n    };\r\n    Clock.prototype.clearTime = function () {\r\n        this.mClockSync = false;\r\n        if (this.mIntervalId) {\r\n            clearInterval(this.mIntervalId);\r\n        }\r\n        this.mTimestamp = 0;\r\n        this._check();\r\n    };\r\n    Clock.prototype.destroy = function () {\r\n        if (this.mConn) {\r\n            this.mConn.removePacketListener(this);\r\n            this.mConn = undefined;\r\n        }\r\n        if (this.mIntervalId) {\r\n            clearInterval(this.mIntervalId);\r\n        }\r\n        this.mLatency = undefined;\r\n    };\r\n    Object.defineProperty(Clock.prototype, "clockSync", {\r\n        get: function () {\r\n            return this.mClockSync;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Clock.prototype._check = function () {\r\n        var self = this;\r\n        this.mIntervalId = setInterval(function () {\r\n            self.sync();\r\n        }, CHECK_INTERVAL);\r\n    };\r\n    Clock.prototype.proof = function (packet) {\r\n        var ct = packet.content;\r\n        var local_receive = this.sysUnixTime, local_send = ct.clientStartTs, remote_receive = ct.serverReceiveTs, remote_send = ct.serverSendTs, server_run = remote_send - remote_receive, total_delay = (local_receive - local_send) - server_run, latency = Math.round(total_delay / 2);\r\n        var timeSychronDelta = 0;\r\n        if (latency < 0)\r\n            return;\r\n        this.mLatency.push(latency);\r\n        if (this.mLatency.length > LATENCY_SAMPLES) {\r\n            this.mLatency.shift();\r\n        }\r\n        var median_latency = _utils_algorithm__WEBPACK_IMPORTED_MODULE_2__["Algorithm"].median(this.mLatency);\r\n        timeSychronDelta = median_latency + server_run;\r\n        var remote_time = remote_send - timeSychronDelta; // the real remote-time.\r\n        var mistake = Math.abs(remote_time - this.mTimestamp);\r\n        // update timesychron\r\n        if (mistake > MAX_DELAY) {\r\n            this.mTimestamp = remote_time;\r\n            this.mAutoSync = true;\r\n            // Logger.getInstance().debug("正在同步clock");\r\n            // if (this.mAutoSync) {\r\n            this.sync(-1);\r\n            return;\r\n            //  }\r\n        }\r\n        this.mAutoSync = false;\r\n        if (this.mListener && this.mLatency.length >= MIN_READY_SAMPLES && !this.mAutoSync) {\r\n            this.mClockSync = true;\r\n            // Logger.getInstance().debug("clock同步完成");\r\n            this.mListener.onClockReady();\r\n        }\r\n        // Logger.getInstance().debug(`total_delay: ${total_delay} / latency: ${latency} | timeSychronDelta: ${timeSychronDelta} / remote_time: ${remote_time} / mistake: ${mistake}`);\r\n    };\r\n    Object.defineProperty(Clock.prototype, "medianLatency", {\r\n        get: function () {\r\n            return _utils_algorithm__WEBPACK_IMPORTED_MODULE_2__["Algorithm"].median(this.mLatency);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Clock;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/clock.ts?')},"./src/rooms/decorate.room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateRoom", function() { return DecorateRoom; });\n/* harmony import */ var _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cameras/viewblock.manager */ "./src/rooms/cameras/viewblock.manager.ts");\n/* harmony import */ var _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cameras/cameras.manager */ "./src/rooms/cameras/cameras.manager.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _scenes_play__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../scenes/play */ "./src/scenes/play.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _element_decorate_element_manager__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./element/decorate.element.manager */ "./src/rooms/element/decorate.element.manager.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _terrain_decorate_terrain_manager__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./terrain/decorate.terrain.manager */ "./src/rooms/terrain/decorate.terrain.manager.ts");\n/* harmony import */ var _decorate_spawn_point__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./decorate/spawn.point */ "./src/rooms/decorate/spawn.point.ts");\n/* harmony import */ var _decorate_selector_element__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./decorate/selector.element */ "./src/rooms/decorate/selector.element.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DecorateRoom = /** @class */ (function (_super) {\r\n    __extends(DecorateRoom, _super);\r\n    function DecorateRoom(manager) {\r\n        var _this = _super.call(this) || this;\r\n        // TODO clock sync\r\n        _this.clockSyncComplete = true;\r\n        _this.world = manager.world;\r\n        _this.mScaleRatio = _this.world.scaleRatio;\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_SELECTED_SPRITE, _this.onSelectSpriteHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_SPAWN_POINT, _this.onShowSpawnPointHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ADD_SPRITE_BY_TYPE, _this.onAddSpriteHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ADD_SINGLE_SPRITE_BY_TYPE, _this.onAddSingleSpriteHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateRoom.prototype.enter = function (room) {\r\n        var _this = this;\r\n        // this.mID = room.id;\r\n        this.mID = room.id;\r\n        var rows = room.rows, cols = room.cols, tileWidth = room.tileWidth, tileHeight = room.tileHeight;\r\n        this.mSize = {\r\n            cols: room.cols,\r\n            rows: room.rows,\r\n            tileHeight: room.tileHeight,\r\n            tileWidth: room.tileWidth,\r\n            sceneWidth: (room.rows + room.cols) * (room.tileWidth / 2),\r\n            sceneHeight: (room.rows + room.cols) * (room.tileHeight / 2)\r\n        };\r\n        rows *= 2;\r\n        cols *= 2;\r\n        tileWidth /= 2;\r\n        tileHeight /= 2;\r\n        this.mMiniSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        this.mMap = new Array(rows);\r\n        for (var i = 0; i < rows; i++) {\r\n            this.mMap[i] = new Array(cols).fill(0);\r\n        }\r\n        this.mCameraService = new _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_1__["CamerasManager"](this);\r\n        // if (!this.world.game.scene.getScene(LoadingScene.name))\r\n        //     this.world.game.scene.add(LoadingScene.name, LoadingScene, false);\r\n        // this.world.game.scene.start(LoadingScene.name, {\r\n        //     world: this.world,\r\n        //     room: this\r\n        // });\r\n        this.world.showLoading().then(function () {\r\n            _this.completeLoad();\r\n        });\r\n    };\r\n    DecorateRoom.prototype.addBlockObject = function (object) {\r\n        if (this.mBlocks) {\r\n            this.mBlocks.add(object);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.addMouseListen = function () {\r\n    };\r\n    DecorateRoom.prototype.addToGround = function (element) {\r\n        this.mLayerManager.addToGround(element);\r\n    };\r\n    DecorateRoom.prototype.addToSceneUI = function (element) {\r\n        this.mLayerManager.addToSceneToUI(element);\r\n    };\r\n    DecorateRoom.prototype.addToSurface = function (element) {\r\n        this.mLayerManager.addToSurface(element);\r\n    };\r\n    DecorateRoom.prototype.addToUI = function (element) {\r\n    };\r\n    DecorateRoom.prototype.completeLoad = function () {\r\n        this.world.game.scene.add(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, _scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"], true, {\r\n            room: this\r\n        });\r\n    };\r\n    DecorateRoom.prototype.destroy = function () {\r\n        if (this.mTerrainManager)\r\n            this.mTerrainManager.destroy();\r\n        if (this.mElementManager)\r\n            this.mElementManager.destroy();\r\n        if (this.mLayerManager)\r\n            this.mLayerManager.destroy();\r\n        if (this.mBlocks)\r\n            this.mBlocks.destroy();\r\n        this.removePointerMoveHandler();\r\n        this.world.game.scene.remove(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].TURN_ELEMENT, this.onTurnElementHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].RECYCLE_ELEMENT, this.onRecycleHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PUT_ELEMENT, this.onPutElement, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].CANCEL_PUT, this.onCancelPutHandler, this);\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.off("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.off("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.off("gameobjectdown", this.onGameobjectUpHandler, this);\r\n    };\r\n    DecorateRoom.prototype.now = function () {\r\n        return 0;\r\n    };\r\n    DecorateRoom.prototype.pause = function () {\r\n        if (this.mScene) {\r\n            this.mScene.scene.pause();\r\n        }\r\n    };\r\n    DecorateRoom.prototype.removeBlockObject = function (object) {\r\n        if (this.mBlocks) {\r\n            this.mBlocks.remove(object);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.requestActorMove = function (d, key) {\r\n    };\r\n    DecorateRoom.prototype.resume = function (name) {\r\n        if (this.mScene) {\r\n            this.mScene.scene.resume(name);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.startLoad = function () {\r\n    };\r\n    DecorateRoom.prototype.startPlay = function () {\r\n        if (this.mLayerManager) {\r\n            this.mLayerManager.destroy();\r\n        }\r\n        this.mScene = this.world.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.mLayerManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__["LayerManager"](this);\r\n        // this.mLayerManager.drawGrid(this);\r\n        this.mTerrainManager = new _terrain_decorate_terrain_manager__WEBPACK_IMPORTED_MODULE_15__["DecorateTerrainManager"](this);\r\n        this.mElementManager = new _element_decorate_element_manager__WEBPACK_IMPORTED_MODULE_12__["DecorateElementManager"](this);\r\n        this.mBlocks = new _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_0__["ViewblockManager"](this.mCameraService);\r\n        this.mBlocks.int(this.mSize);\r\n        this.mScene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.on("gameobjectdown", this.onGameobjectUpHandler, this);\r\n        // const mainCameras = this.mScene.cameras.main;\r\n        var camera = this.scene.cameras.main;\r\n        this.mCameraService.camera = camera;\r\n        var zoom = Math.ceil(window.devicePixelRatio);\r\n        this.mCameraService.setBounds(-camera.width >> 1, -camera.height >> 1, this.mSize.sceneWidth * zoom + camera.width, this.mSize.sceneHeight * zoom + camera.height);\r\n        if (this.cameraPos) {\r\n            this.mCameraService.scrollTargetPoint(this.cameraPos.x, this.cameraPos.y);\r\n            this.mCameraService.syncCameraScroll();\r\n        }\r\n        this.world.changeRoom(this);\r\n        var loadingScene = this.world.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_7__["LoadingScene"].name);\r\n        if (loadingScene)\r\n            loadingScene.sleep();\r\n        this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        // this.mCameraService.centerCameas();\r\n        if (this.world.uiManager) {\r\n            this.world.uiManager.showDecorateUI();\r\n        }\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].TURN_ELEMENT, this.onTurnElementHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].RECYCLE_ELEMENT, this.onRecycleHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PUT_ELEMENT, this.onPutElement, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].CANCEL_PUT, this.onCancelPutHandler, this);\r\n    };\r\n    DecorateRoom.prototype.transformTo45 = function (p) {\r\n        if (!this.mSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_3__["Position45"].transformTo45(p, this.mSize);\r\n    };\r\n    DecorateRoom.prototype.transformTo90 = function (p) {\r\n        if (!this.mSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_3__["Position45"].transformTo90(p, this.mSize);\r\n    };\r\n    DecorateRoom.prototype.transformToMini90 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_3__["Position45"].transformTo90(p, this.mMiniSize);\r\n    };\r\n    DecorateRoom.prototype.transformToMini45 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_9__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_3__["Position45"].transformTo45(p, this.mMiniSize);\r\n    };\r\n    DecorateRoom.prototype.update = function (time, delta) {\r\n        if (this.mLayerManager) {\r\n            this.mLayerManager.update(time, delta);\r\n        }\r\n        if (this.mSelectorElement) {\r\n            this.mSelectorElement.update(time, delta);\r\n        }\r\n        if (this.mBlocks) {\r\n            this.mBlocks.update(time, delta);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.updateBlockObject = function () {\r\n    };\r\n    DecorateRoom.prototype.resize = function (width, height) {\r\n        this.layerManager.resize(width, height);\r\n        this.mCameraService.resize(width, height);\r\n    };\r\n    DecorateRoom.prototype.transitionGrid = function (x, y) {\r\n        var source = new _utils_pos__WEBPACK_IMPORTED_MODULE_5__["Pos"](x, y);\r\n        var pos = this.transformToMini45(source);\r\n        return this.checkBound(pos);\r\n    };\r\n    DecorateRoom.prototype.addElements = function (sprites, nodeType) {\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.ElementNodeType) {\r\n            this.mElementManager.add(sprites);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.TerrainNodeType) {\r\n            this.mTerrainManager.add(sprites);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.setEnterPos = function (x, y) {\r\n        this.cameraPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_5__["Pos"](x, y);\r\n    };\r\n    /**\r\n     * 边界检查\r\n     * @param pos 45度坐标，\r\n     * @param source 没有超出边界并不贴边就返回原始坐标\r\n     */\r\n    DecorateRoom.prototype.checkBound = function (pos, source) {\r\n        var bound = new _utils_pos__WEBPACK_IMPORTED_MODULE_5__["Pos"](pos.x, pos.y);\r\n        var size = this.mMiniSize;\r\n        if (pos.x < 0) {\r\n            bound.x = 0;\r\n        }\r\n        else if (pos.x > size.cols) {\r\n            bound.x = size.cols;\r\n        }\r\n        if (pos.y < 0) {\r\n            bound.y = 0;\r\n        }\r\n        else if (pos.y > size.rows) {\r\n            bound.y = size.rows;\r\n        }\r\n        if (bound.equal(pos) && source) {\r\n            return source;\r\n        }\r\n        return this.transformToMini90(bound);\r\n    };\r\n    DecorateRoom.prototype.canPut = function (pos, collisionArea, origin) {\r\n        if (!collisionArea || !origin) {\r\n            return;\r\n        }\r\n        var pos45 = this.transformToMini45(pos);\r\n        if (pos45.x < 0 || pos45.y < 0 || pos45.x > this.miniSize.rows || pos45.y > this.miniSize.cols) {\r\n            return false;\r\n        }\r\n        var eles = [this.mElementManager, this.mTerrainManager];\r\n        for (var _i = 0, eles_1 = eles; _i < eles_1.length; _i++) {\r\n            var manager = eles_1[_i];\r\n            if (manager.canPut(pos45, collisionArea, origin) === false) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n        // let row = 0;\r\n        // let col = 0;\r\n        // const map = this.terrainManager.map;\r\n        // for (let i = 0; i < collisionArea.length; i++) {\r\n        //     row = i + pos45.y - origin.y;\r\n        //     if (row >= map.length) {\r\n        //         return false;\r\n        //     }\r\n        //     for (let j = 0; j < collisionArea[i].length; j++) {\r\n        //         col = j + pos45.x - origin.x;\r\n        //         if (col >= map[i].length || map[row][col] === 1) {\r\n        //             return false;\r\n        //         }\r\n        //     }\r\n        // }\r\n        // return true;\r\n    };\r\n    DecorateRoom.prototype.setMap = function (cols, rows, type) {\r\n        if (rows < 0 || cols < 0 || this.mMap.length < rows || this.mMap[0].length < cols) {\r\n            return;\r\n        }\r\n        this.mMap[cols][rows] = type;\r\n    };\r\n    DecorateRoom.prototype.getElement = function (id) {\r\n        var ele = null;\r\n        if (this.mElementManager) {\r\n            ele = this.elementManager.get(id);\r\n        }\r\n        if (!ele && this.mTerrainManager) {\r\n            ele = this.mTerrainManager.get(id);\r\n        }\r\n        return ele;\r\n    };\r\n    DecorateRoom.prototype.addPointerMoveHandler = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("gameout", this.onGameOutHandler, this);\r\n    };\r\n    DecorateRoom.prototype.removePointerMoveHandler = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.off("gameout", this.onGameOutHandler, this);\r\n    };\r\n    DecorateRoom.prototype.onPointerUpHandler = function (pointer) {\r\n        this.removePointerMoveHandler();\r\n        if (this.mSelectorElement) {\r\n            this.mSelectorElement.selecting = false;\r\n        }\r\n    };\r\n    DecorateRoom.prototype.onPointerDownHandler = function () {\r\n        this.addPointerMoveHandler();\r\n    };\r\n    DecorateRoom.prototype.onGameobjectUpHandler = function (pointer, gameobject) {\r\n        // this.addPointerMoveHandler();\r\n        // TODO\r\n        var com = gameobject.parentContainer.parentContainer || gameobject.parentContainer;\r\n        if (!com) {\r\n            return;\r\n        }\r\n        if (!(com instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_10__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        if (com instanceof _display_terrain_display__WEBPACK_IMPORTED_MODULE_11__["TerrainDisplay"]) {\r\n            return;\r\n        }\r\n        this.selectedElement(com.element);\r\n    };\r\n    DecorateRoom.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (!this.mSelectorElement || (this.mSelectorElement && this.mSelectorElement.selecting === false)) {\r\n            this.moveCamera(pointer);\r\n            return;\r\n        }\r\n        if (pointer.downX === pointer.x && pointer.downY === pointer.y) {\r\n            return;\r\n        }\r\n        // if (pointer.downX !== pointer.upX && pointer.downY !== pointer.upY) {\r\n        this.moveElement(pointer);\r\n    };\r\n    DecorateRoom.prototype.onGameOutHandler = function () {\r\n        this.removePointerMoveHandler();\r\n    };\r\n    DecorateRoom.prototype.moveCamera = function (pointer) {\r\n        this.cameraService.offsetScroll(pointer.prevPosition.x - pointer.position.x, pointer.prevPosition.y - pointer.position.y);\r\n    };\r\n    DecorateRoom.prototype.moveElement = function (pointer) {\r\n        var pos = this.transitionGrid(pointer.worldX / this.mScaleRatio, pointer.worldY / this.mScaleRatio);\r\n        if (this.mSelectorElement) {\r\n            this.mSelectorElement.setDisplayPos(pos);\r\n        }\r\n        // this.mSelectedElement.setDisplayPos(pos.x, pos.y);\r\n    };\r\n    DecorateRoom.prototype.removeElement = function (id, nodeType) {\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.ElementNodeType || nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.SpawnPointType) {\r\n            this.elementManager.remove(id);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.TerrainNodeType) {\r\n            this.elementManager.remove(id);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.addElement = function (sprite, addMap) {\r\n        var nodeType = sprite.nodeType;\r\n        if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.ElementNodeType || nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.SpawnPointType) {\r\n            this.mElementManager.add([sprite], addMap);\r\n        }\r\n        else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.TerrainNodeType) {\r\n            this.mTerrainManager.add([sprite]);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.selectedElement = function (element, isClone) {\r\n        if (isClone === void 0) { isClone = true; }\r\n        if (!element) {\r\n            return;\r\n        }\r\n        if (!this.mSelectorElement) {\r\n            this.mSelectorElement = new _decorate_selector_element__WEBPACK_IMPORTED_MODULE_17__["SelectorElement"](element);\r\n            if (isClone) {\r\n                this.mSelectorElement.clone();\r\n                this.elementManager.removeMap(element.model);\r\n            }\r\n            this.mSelectorElement.update();\r\n        }\r\n        else {\r\n            if (this.mSelectorElement.element === element) {\r\n                this.mSelectorElement.selecting = true;\r\n            }\r\n            else {\r\n                this.onPutElement(null);\r\n                // this.cancelSelector();\r\n                this.selectedElement(element, isClone);\r\n            }\r\n        }\r\n    };\r\n    DecorateRoom.prototype.cancelSelector = function () {\r\n        if (this.mSelectorElement) {\r\n            var sprite = null;\r\n            if (this.mSelectorElement.root) {\r\n                sprite = this.mSelectorElement.element.model;\r\n            }\r\n            this.mSelectorElement.destroy();\r\n            this.mSelectorElement = undefined;\r\n            if (sprite) {\r\n                this.mElementManager.addMap(sprite);\r\n            }\r\n        }\r\n    };\r\n    DecorateRoom.prototype.onTurnElementHandler = function (display) {\r\n        if (!this.mSelectorElement) {\r\n            return;\r\n        }\r\n        this.mSelectorElement.turnElement();\r\n    };\r\n    DecorateRoom.prototype.onRecycleHandler = function (display) {\r\n        if (!this.mSelectorElement) {\r\n            return;\r\n        }\r\n        var element = this.mSelectorElement.element;\r\n        var sprite = element.model;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_SPRITE);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.world.connection.send(packet);\r\n        this.mSelectorElement.destroy();\r\n        this.mSelectorElement = undefined;\r\n    };\r\n    DecorateRoom.prototype.onPutElement = function (display) {\r\n        this.removePointerMoveHandler();\r\n        if (!this.mSelectorElement) {\r\n            return;\r\n        }\r\n        var element = this.mSelectorElement.element;\r\n        if (!element) {\r\n            return;\r\n        }\r\n        var sprite = element.model;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        if (this.canPut(sprite.pos, sprite.currentCollisionArea, sprite.currentCollisionPoint)) {\r\n            if (this.mSelectorElement.root) {\r\n                this.sendUpdateSprite(sprite);\r\n            }\r\n            else {\r\n                if (sprite.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.SpawnPointType) {\r\n                    this.sendSpawnPoint(sprite.pos);\r\n                    this.removeElement(sprite.id, sprite.nodeType);\r\n                }\r\n                else {\r\n                    this.sendAddSprite(sprite);\r\n                }\r\n            }\r\n            this.cancelSelector();\r\n        }\r\n        else {\r\n            this.onCancelPutHandler(element);\r\n        }\r\n    };\r\n    DecorateRoom.prototype.onCancelPutHandler = function (element) {\r\n        this.removePointerMoveHandler();\r\n        if (!this.mSelectorElement) {\r\n            return;\r\n        }\r\n        if (!element) {\r\n            element = this.mElementManager.get(this.mSelectorElement.element.id);\r\n        }\r\n        if (!element) {\r\n            return;\r\n        }\r\n        var root = this.mSelectorElement.root;\r\n        if (root) {\r\n            this.mSelectorElement.recover();\r\n        }\r\n        else {\r\n            this.removeElement(element.id, element.model.nodeType);\r\n        }\r\n        this.cancelSelector();\r\n    };\r\n    DecorateRoom.prototype.sendAddSprite = function (sprite) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SPRITE);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.sendUpdateSprite = function (sprite) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_UPDATE_SPRITE);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.sendSpawnPoint = function (pos) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SET_SPAWN_POINT);\r\n        var content = packet.content;\r\n        var pos3f = pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].PBPoint3f.create();\r\n        pos3f.x = pos.x;\r\n        pos3f.y = pos.y;\r\n        content.spawnPoint = pos3f;\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.sendPosition = function (sprite) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_CHANGE_SPRITE_POSITION);\r\n        var content = packet.content;\r\n        content.sprites = [sprite.toSprite()];\r\n        content.nodeType = sprite.nodeType;\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateRoom.prototype.onSelectSpriteHandler = function (packet) {\r\n        var content = packet.content;\r\n        var camera = this.cameraService.camera;\r\n        var sprite = new _element_sprite__WEBPACK_IMPORTED_MODULE_14__["Sprite"](content.sprite, content.nodeType);\r\n        sprite.setPosition((camera.scrollX + camera.width / 2) / this.world.scaleRatio, (camera.scrollY + camera.height / 2) / this.world.scaleRatio);\r\n        this.addElement(sprite, false);\r\n        var element = this.mElementManager.get(content.sprite.id);\r\n        if (element)\r\n            this.selectedElement(element, false);\r\n    };\r\n    DecorateRoom.prototype.onShowSpawnPointHandler = function (packet) {\r\n        var content = packet.content;\r\n        var spawnPoint = new _decorate_spawn_point__WEBPACK_IMPORTED_MODULE_16__["SpawnPoint"]();\r\n        var pos = content.spawnPoint;\r\n        spawnPoint.setPosition(pos.x, pos.y);\r\n        this.addElement(spawnPoint, false);\r\n        this.selectedElement(this.mElementManager.get(spawnPoint.id), false);\r\n        // this.mSelectedElement.setSprite(spawnPoint);\r\n        this.mCameraService.scrollTargetPoint(pos.x, pos.y);\r\n    };\r\n    DecorateRoom.prototype.onAddSpriteHandler = function (packet) {\r\n        var content = packet.content;\r\n        // if (this.mSelectedElement.root && content.id === this.mSelectedElement.root.id) {\r\n        //     this.addElement(this.mSelectedElement.sprite);\r\n        // }\r\n        // this.mSelectedElement.remove();\r\n        this.cancelSelector();\r\n    };\r\n    DecorateRoom.prototype.onAddSingleSpriteHandler = function (packet) {\r\n        var content = packet.content;\r\n        var addedSprites = content.addedSprites;\r\n        if (addedSprites) {\r\n            var sprites = [];\r\n            for (var _i = 0, addedSprites_1 = addedSprites; _i < addedSprites_1.length; _i++) {\r\n                var sprite = addedSprites_1[_i];\r\n                sprites.push(new _element_sprite__WEBPACK_IMPORTED_MODULE_14__["Sprite"](sprite, content.nodeType));\r\n            }\r\n            if (sprites.length > 0) {\r\n                this.mElementManager.add(sprites);\r\n                var ele = this.mElementManager.get(sprites[sprites.length - 1].id);\r\n                if (ele) {\r\n                    this.cancelSelector();\r\n                    this.selectedElement(ele);\r\n                    if (this.mSelectorElement)\r\n                        this.mSelectorElement.selecting = false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(DecorateRoom.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "roomSize", {\r\n        get: function () {\r\n            return this.mSize;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "terrainManager", {\r\n        get: function () {\r\n            return this.mTerrainManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "layerManager", {\r\n        get: function () {\r\n            return this.mLayerManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "cameraService", {\r\n        get: function () {\r\n            return this.mCameraService;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "scene", {\r\n        get: function () {\r\n            return this.mScene;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "connection", {\r\n        get: function () {\r\n            return this.world.connection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "miniSize", {\r\n        get: function () {\r\n            return this.mMiniSize;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "selectedSprite", {\r\n        get: function () {\r\n            if (!this.mSelectorElement) {\r\n                return;\r\n            }\r\n            return this.mSelectorElement.element;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "enableEdit", {\r\n        get: function () {\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "sceneType", {\r\n        get: function () {\r\n            return pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DecorateRoom.prototype, "effectManager", {\r\n        get: function () {\r\n            return undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DecorateRoom;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_6__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/decorate.room.ts?')},"./src/rooms/decorate/selector.element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectorElement", function() { return SelectorElement; });\n/* harmony import */ var _ui_decorate_decorate_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/decorate/decorate.manager */ "./src/ui/decorate/decorate.manager.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n\r\n\r\n\r\nvar SelectorElement = /** @class */ (function () {\r\n    function SelectorElement(mElement) {\r\n        var _this = this;\r\n        this.mElement = mElement;\r\n        this.mScene = this.mElement.scene;\r\n        this.mRoomService = this.mElement.roomService;\r\n        this.mDecorateManager = new _ui_decorate_decorate_manager__WEBPACK_IMPORTED_MODULE_0__["DecorateManager"](this.mScene, this.mRoomService);\r\n        this.mDecorateManager.setElement(mElement);\r\n        var display = mElement.getDisplay();\r\n        if (!display.collisionArea) {\r\n            display.once("initialized", function () {\r\n                display.play(_this.mElement.model.currentAnimation);\r\n                display.showRefernceArea();\r\n            });\r\n        }\r\n        else {\r\n            display.showRefernceArea();\r\n        }\r\n        this.mSelecting = true;\r\n        this.mDecorateManager.on("moveElement", this.onMoveElementHandler, this);\r\n        this.mRoomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_COLLAPSE);\r\n        this.mRoomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SELECTED_DECORATE_ELEMENT);\r\n    }\r\n    SelectorElement.prototype.turnElement = function () {\r\n        if (!this.mElement) {\r\n            return;\r\n        }\r\n        this.mElement.turn();\r\n        this.checkCanPut();\r\n    };\r\n    SelectorElement.prototype.setDisplayPos = function (pos) {\r\n        if (!this.mElement) {\r\n            return;\r\n        }\r\n        this.mElement.setPosition(pos);\r\n        this.checkCanPut();\r\n    };\r\n    SelectorElement.prototype.update = function (time, delta) {\r\n        if (this.mElement) {\r\n            var pos = this.mElement.getPosition();\r\n            this.mDecorateManager.updatePos(pos.x, pos.y);\r\n            this.checkCanPut();\r\n        }\r\n    };\r\n    SelectorElement.prototype.clone = function () {\r\n        if (!this.mElement) {\r\n            return;\r\n        }\r\n        var sprite = this.mElement.model;\r\n        var pos = sprite.pos;\r\n        this.mSourceData = {\r\n            x: pos.x,\r\n            y: pos.y,\r\n            z: pos.z,\r\n            direction: sprite.direction\r\n        };\r\n    };\r\n    SelectorElement.prototype.recover = function () {\r\n        if (!this.mElement) {\r\n            return;\r\n        }\r\n        if (this.mSourceData) {\r\n            this.mElement.setAlpha(1);\r\n            this.mElement.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](this.mSourceData.x, this.mSourceData.y));\r\n            this.mElement.setDirection(this.mSourceData.direction);\r\n        }\r\n    };\r\n    SelectorElement.prototype.destroy = function () {\r\n        if (this.mDecorateManager) {\r\n            this.mDecorateManager.destroy();\r\n        }\r\n        if (this.mElement) {\r\n            var display = this.mElement.getDisplay();\r\n            if (display) {\r\n                display.hideRefernceArea();\r\n            }\r\n        }\r\n        this.mSourceData = undefined;\r\n        this.mRoomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_EXPANED);\r\n        this.mRoomService.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].CANCEL_DECORATE_ELEMENT);\r\n    };\r\n    SelectorElement.prototype.checkCanPut = function () {\r\n        if (!this.mRoomService || !this.mElement) {\r\n            return;\r\n        }\r\n        var sprite = this.mElement.model;\r\n        var canPut = this.mRoomService.canPut(this.mElement.getPosition(), sprite.currentCollisionArea, sprite.currentCollisionPoint);\r\n        if (canPut) {\r\n            this.element.setAlpha(1);\r\n        }\r\n        else {\r\n            this.element.setAlpha(0.6);\r\n        }\r\n        if (this.mDecorateManager) {\r\n            this.mDecorateManager.canPut(canPut);\r\n        }\r\n    };\r\n    SelectorElement.prototype.onMoveElementHandler = function (pos) {\r\n        if (!pos) {\r\n            return;\r\n        }\r\n        this.setDisplayPos(pos);\r\n    };\r\n    Object.defineProperty(SelectorElement.prototype, "selecting", {\r\n        get: function () {\r\n            return this.mSelecting;\r\n        },\r\n        set: function (val) {\r\n            this.mSelecting = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectorElement.prototype, "element", {\r\n        get: function () {\r\n            return this.mElement;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectorElement.prototype, "root", {\r\n        get: function () {\r\n            return this.mSourceData;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return SelectorElement;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/decorate/selector.element.ts?')},"./src/rooms/decorate/spawn.point.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpawnPoint", function() { return SpawnPoint; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _display_frames_model__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var _display_animation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../display/animation */ "./src/rooms/display/animation.ts");\n\r\n\r\n\r\n\r\nvar SpawnPoint = /** @class */ (function () {\r\n    function SpawnPoint() {\r\n        this.id = 100;\r\n        this.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_def"].NodeType.SpawnPointType;\r\n        this.pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"]();\r\n        this.displayInfo = new _display_frames_model__WEBPACK_IMPORTED_MODULE_2__["FramesModel"]({\r\n            id: 0,\r\n            animations: {\r\n                defaultAnimationName: "idle",\r\n                display: this.display,\r\n                animationData: [new _display_animation__WEBPACK_IMPORTED_MODULE_3__["Animation"](this.animation)]\r\n            }\r\n        });\r\n        this.currentAnimation = {\r\n            name: "idle",\r\n            flip: false\r\n        };\r\n        this.direction = 3;\r\n        this.nickname = "出生点";\r\n        this.alpha = 1;\r\n    }\r\n    SpawnPoint.prototype.newID = function () {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.setPosition = function (x, y) {\r\n        this.pos.x = x;\r\n        this.pos.y = y;\r\n    };\r\n    SpawnPoint.prototype.turn = function () {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.toSprite = function () {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.updateAvatar = function (avatar) {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.updateDisplay = function (display, animations, defAnimation) {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.setAnimationName = function () {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    SpawnPoint.prototype.setAnimationQueue = function () {\r\n        throw new Error("Method not implemented.");\r\n    };\r\n    Object.defineProperty(SpawnPoint.prototype, "display", {\r\n        get: function () {\r\n            var display = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_gameconfig"].Display.create();\r\n            display.texturePath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.png";\r\n            display.dataPath =\r\n                "pixelpai/SpawnPointNode/5cc42f6417553727db1d2bba/1/5cc42f6417553727db1d2bba.json";\r\n            return display;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpawnPoint.prototype, "animation", {\r\n        get: function () {\r\n            var animation = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_gameconfig_01"].AnimationData.create();\r\n            // animation.id = 10000;\r\n            // animation.name = "idle";\r\n            animation.frameRate = 5;\r\n            animation.collisionArea = "1,1&1,1";\r\n            animation.loop = true;\r\n            animation.baseLoc = "-30,-30";\r\n            animation.originPoint = [0, 0];\r\n            animation.frameName = ["switch_0027_3_01.png"];\r\n            return animation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpawnPoint.prototype, "currentCollisionArea", {\r\n        get: function () {\r\n            return [[1, 1], [1, 1]];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpawnPoint.prototype, "currentWalkableArea", {\r\n        get: function () {\r\n            return [[0]];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpawnPoint.prototype, "currentCollisionPoint", {\r\n        get: function () {\r\n            return new Phaser.Geom.Point(0, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpawnPoint.prototype, "hasInteractive", {\r\n        get: function () {\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return SpawnPoint;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/decorate/spawn.point.ts?')},"./src/rooms/display-object.pool.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayObjectPool", function() { return DisplayObjectPool; });\n/* harmony import */ var _terrain_terrain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./terrain/terrain */ "./src/rooms/terrain/terrain.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./element/element */ "./src/rooms/element/element.ts");\n\r\n\r\nvar DisplayObjectPool = /** @class */ (function () {\r\n    function DisplayObjectPool() {\r\n        this.terrains = new Map();\r\n        this.mosses = new Map();\r\n        this.elements = new Map();\r\n        this.POOLOBJECTCONFIG = {\r\n            terrains: _terrain_terrain__WEBPACK_IMPORTED_MODULE_0__["Terrain"],\r\n            mosses: _element_element__WEBPACK_IMPORTED_MODULE_1__["Element"],\r\n            elements: _element_element__WEBPACK_IMPORTED_MODULE_1__["Element"],\r\n        };\r\n    }\r\n    DisplayObjectPool.prototype.getPool = function (poolName) {\r\n        return this[poolName];\r\n    };\r\n    DisplayObjectPool.prototype.push = function (poolName, id, sprite, manager) {\r\n        var pool = this[poolName];\r\n        var obj = new this.POOLOBJECTCONFIG[poolName](sprite, manager);\r\n        obj.setBlockable(false);\r\n        obj.setRenderable(true);\r\n        if (obj instanceof _element_element__WEBPACK_IMPORTED_MODULE_1__["Element"]) {\r\n            obj.setInputEnable(_element_element__WEBPACK_IMPORTED_MODULE_1__["InputEnable"].Enable);\r\n        }\r\n        pool.set(id, obj);\r\n    };\r\n    DisplayObjectPool.prototype.remove = function (poolName, id) {\r\n        var obj = this[poolName].get(id);\r\n        if (obj) {\r\n            obj.isUsed = false;\r\n            obj.destroy();\r\n        }\r\n        this[poolName].delete(id);\r\n    };\r\n    DisplayObjectPool.prototype.update = function (poolName, id, newSprite) {\r\n        var pool = this[poolName];\r\n        var obj = pool.get(id);\r\n        if (obj) {\r\n            obj.isUsed = true;\r\n            obj.setModel(newSprite);\r\n        }\r\n    };\r\n    DisplayObjectPool.prototype.destroy = function () {\r\n        for (var _i = 0, _a = Object.keys(this.POOLOBJECTCONFIG); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            this[key].clear();\r\n        }\r\n    };\r\n    return DisplayObjectPool;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display-object.pool.ts?')},"./src/rooms/display/animation.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Animation", function() { return Animation; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n\r\nvar Animation = /** @class */ (function () {\r\n    function Animation(ani) {\r\n        var tmpBaseLoc = ani.baseLoc.split(",");\r\n        this.mNode = ani.node;\r\n        this.mID = ani.node.id;\r\n        this.mName = ani.node.name;\r\n        this.mFrameName = ani.frameName;\r\n        if (!ani.frameName || this.mFrameName.length < 1) {\r\n            // Logger.getInstance().fatal(`Animation: ${ani.id} frames is invalid`);\r\n        }\r\n        this.mLoop = ani.loop;\r\n        if (!ani.loop) {\r\n            // Logger.getInstance().fatal(`Animation: ${ani.id} loop is invalid`);\r\n        }\r\n        if (!ani.frameRate) {\r\n            // Logger.getInstance().fatal(`Animation: ${ani.id} frameRate is invalid`);\r\n        }\r\n        if (ani.originPoint) {\r\n            // Logger.getInstance().fatal(`Animation: ${ani.id} originPoint is invalid`);\r\n        }\r\n        if (!ani.baseLoc) {\r\n            // Logger.getInstance().fatal(`Animation: ${ani.id} baseLoc is invalid`);\r\n        }\r\n        this.mFrameRate = ani.frameRate;\r\n        this.mBaseLoc = new Phaser.Geom.Point(parseInt(tmpBaseLoc[0], 10), parseInt(tmpBaseLoc[1], 10));\r\n        var origin = ani.originPoint;\r\n        this.mOriginPoint = new Phaser.Geom.Point(origin[0], origin[1]);\r\n        if (typeof ani.collisionArea === "string") {\r\n            this.mCollisionArea = this.stringToArray(ani.collisionArea, ",", "&") || [[0]];\r\n        }\r\n        else {\r\n            this.mCollisionArea = ani.collisionArea || [[0]];\r\n        }\r\n        if (typeof ani.walkableArea === "string") {\r\n            this.mWalkableArea = this.stringToArray(ani.walkableArea, ",", "&") || [[0]];\r\n        }\r\n        else {\r\n            this.mWalkableArea = ani.walkableArea || [[0]];\r\n        }\r\n        // this.mInteractiveArea = [{x: 0, y: 0}];\r\n        this.mInteractiveArea = ani.interactiveArea;\r\n        this.mLayer = ani.layer;\r\n        this.mMountLayer = ani.mountLayer;\r\n    }\r\n    Animation.prototype.createProtocolObject = function () {\r\n        var ani = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_gameconfig_01"].AnimationData.create();\r\n        ani.node = this.mNode;\r\n        ani.baseLoc = this.baseLoc.x + "," + this.baseLoc.y;\r\n        ani.node.name = this.name;\r\n        ani.loop = this.loop;\r\n        ani.frameRate = this.frameRate;\r\n        ani.frameName = this.frameName;\r\n        ani.originPoint = [this.originPoint.x, this.originPoint.y];\r\n        ani.walkOriginPoint = [this.originPoint.x, this.originPoint.y];\r\n        ani.walkableArea = this.arrayToString(this.mWalkableArea, ",", "&");\r\n        ani.collisionArea = this.arrayToString(this.mCollisionArea, ",", "&");\r\n        ani.interactiveArea = this.mInteractiveArea;\r\n        ani.layer = this.mLayer;\r\n        ani.mountLayer = this.mMountLayer;\r\n        return ani;\r\n    };\r\n    Animation.prototype.stringToArray = function (string, fristJoin, lastJoin) {\r\n        if (!string) {\r\n            return;\r\n        }\r\n        var tmp = string.split(lastJoin);\r\n        var result = [];\r\n        for (var _i = 0, tmp_1 = tmp; _i < tmp_1.length; _i++) {\r\n            var ary = tmp_1[_i];\r\n            var tmpAry = ary.split(fristJoin);\r\n            result.push(tmpAry.map(function (value) { return parseInt(value, 10); }));\r\n        }\r\n        return result;\r\n    };\r\n    Animation.prototype.arrayToString = function (array, fristJoin, lastJoin) {\r\n        if (!array)\r\n            return "";\r\n        var tmp = [];\r\n        for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\r\n            var ary = array_1[_i];\r\n            tmp.push(ary.join(fristJoin));\r\n        }\r\n        return tmp.join(lastJoin);\r\n    };\r\n    Object.defineProperty(Animation.prototype, "baseLoc", {\r\n        get: function () {\r\n            return this.mBaseLoc;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "frameName", {\r\n        get: function () {\r\n            return this.mFrameName;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "frameRate", {\r\n        get: function () {\r\n            return this.mFrameRate;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "loop", {\r\n        get: function () {\r\n            return this.mLoop;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "name", {\r\n        get: function () {\r\n            return this.mName;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "collisionArea", {\r\n        get: function () {\r\n            return this.mCollisionArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "walkableArea", {\r\n        get: function () {\r\n            return this.mWalkableArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "originPoint", {\r\n        get: function () {\r\n            return this.mOriginPoint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "interactiveArea", {\r\n        get: function () {\r\n            return this.mInteractiveArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "layer", {\r\n        get: function () {\r\n            if (this.mLayer.length > 0) {\r\n                return this.mLayer;\r\n            }\r\n            return [{\r\n                    frameName: this.mFrameName,\r\n                    offsetLoc: this.mBaseLoc\r\n                }];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, "mountLayer", {\r\n        get: function () {\r\n            return this.mMountLayer;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Animation;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/animation.ts?')},"./src/rooms/display/display.object.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayField", function() { return DisplayField; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayObject", function() { return DisplayObject; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _ui_components_dynamic_sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ui/components/dynamic.sprite */ "./src/ui/components/dynamic.sprite.ts");\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _editor_reference_area__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../editor/reference.area */ "./src/rooms/editor/reference.area.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar DisplayField;\r\n(function (DisplayField) {\r\n    DisplayField[DisplayField["BACKEND"] = 0] = "BACKEND";\r\n    DisplayField[DisplayField["STAGE"] = 1] = "STAGE";\r\n    DisplayField[DisplayField["FRONTEND"] = 2] = "FRONTEND";\r\n    DisplayField[DisplayField["FLAG"] = 3] = "FLAG";\r\n    DisplayField[DisplayField["Effect"] = 4] = "Effect";\r\n})(DisplayField || (DisplayField = {}));\r\nvar DisplayObject = /** @class */ (function (_super) {\r\n    __extends(DisplayObject, _super);\r\n    function DisplayObject(scene, roomService, element, antial) {\r\n        if (antial === void 0) { antial = false; }\r\n        var _this = _super.call(this, scene) || this;\r\n        /**\r\n         * 实际透明度，避免和tween混淆\r\n         */\r\n        _this.mAlpha = 1;\r\n        _this.mDirection = 3;\r\n        _this.mAntial = false;\r\n        _this.mElement = element;\r\n        _this.mRoomService = roomService;\r\n        _this.mAntial = antial;\r\n        return _this;\r\n    }\r\n    DisplayObject.prototype.changeAlpha = function (val) {\r\n        if (this.mAlpha === val) {\r\n            return;\r\n        }\r\n        this.alpha = val;\r\n        this.mAlpha = val;\r\n    };\r\n    DisplayObject.prototype.removeFromParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    DisplayObject.prototype.fadeIn = function (callback) {\r\n    };\r\n    DisplayObject.prototype.fadeOut = function (callback) {\r\n    };\r\n    DisplayObject.prototype.load = function (data, field) {\r\n    };\r\n    DisplayObject.prototype.play = function (animationName, field) {\r\n    };\r\n    DisplayObject.prototype.mount = function (ele, targetIndex) { };\r\n    DisplayObject.prototype.unmount = function (ele) { };\r\n    DisplayObject.prototype.removeEffect = function (field) {\r\n    };\r\n    DisplayObject.prototype.removeDisplay = function (field) {\r\n    };\r\n    DisplayObject.prototype.destroy = function (fromScene) {\r\n        if (this.mFlagContainer) {\r\n            if (this.mNickname) {\r\n                this.mNickname.destroy();\r\n                this.mNickname = undefined;\r\n            }\r\n            if (this.mBackEffect) {\r\n                this.mBackEffect.destroy();\r\n                this.mBackEffect = undefined;\r\n            }\r\n            if (this.mFrontEffect) {\r\n                this.mFrontEffect.destroy();\r\n                this.mFrontEffect = undefined;\r\n            }\r\n            this.clearBadges();\r\n            this.mFlagContainer.destroy();\r\n            this.mFlagContainer = undefined;\r\n        }\r\n        if (this.mReferenceArea) {\r\n            this.mReferenceArea.destroy();\r\n            this.mReferenceArea = undefined;\r\n        }\r\n        if (this.mChildMap) {\r\n            this.mChildMap.clear();\r\n            this.mChildMap = null;\r\n        }\r\n        // this.removeAll(true);\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    DisplayObject.prototype.showNickname = function (val) {\r\n        if (!this.mNickname) {\r\n            this.mNickname = this.scene.make.text({ style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].YAHEI_14_BOLD } }, false).setOrigin(0.5, 0.5);\r\n            this.mNickname.setStroke("#0", 2);\r\n            if (this.mAntial) {\r\n                this.mNickname.setShadow(2, 2, "#0", 4, true, true);\r\n            }\r\n            this.flagContainer.add(this.mNickname);\r\n        }\r\n        this.mNickname.setText(val);\r\n        this.layouFlag();\r\n    };\r\n    DisplayObject.prototype.setDisplayBadges = function (cards) {\r\n        if (!this.mBadges)\r\n            this.mBadges = [];\r\n        else\r\n            this.clearBadges();\r\n        for (var _i = 0, cards_1 = cards; _i < cards_1.length; _i++) {\r\n            var card = cards_1[_i];\r\n            var badge = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__["DynamicImage"](this.scene, 0, 0);\r\n            badge.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(card.thumbnail), this, this.layouFlag);\r\n            this.flagContainer.add(badge);\r\n            this.mBadges.push(badge);\r\n        }\r\n    };\r\n    DisplayObject.prototype.showRefernceArea = function () {\r\n        if (!this.mReferenceArea) {\r\n            this.mReferenceArea = new _editor_reference_area__WEBPACK_IMPORTED_MODULE_4__["ReferenceArea"](this.scene, this.mRoomService);\r\n            this.addChildMap("reference", this.mReferenceArea);\r\n        }\r\n        if (!this.mCollisionArea || this.mCollisionArea.length <= 0)\r\n            return;\r\n        this.mReferenceArea.draw(this.mCollisionArea, this.mOriginPoint);\r\n        this.addAt(this.mReferenceArea, 0);\r\n    };\r\n    DisplayObject.prototype.hideRefernceArea = function () {\r\n        if (this.mReferenceArea) {\r\n            this.mReferenceArea.destroy();\r\n            this.mReferenceArea = undefined;\r\n        }\r\n    };\r\n    DisplayObject.prototype.scaleTween = function () { };\r\n    DisplayObject.prototype.showEffect = function () {\r\n        this.addEffect(this.mBackEffect, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_back.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_back.json"), true, 15, false, true);\r\n        this.addEffect(this.mFrontEffect, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_front.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/vip/vip_effect_front.json"), true, 15, false, true);\r\n    };\r\n    DisplayObject.prototype.getElement = function (key) {\r\n        if (!this.mChildMap) {\r\n            return;\r\n        }\r\n        return this.mChildMap.get(key);\r\n    };\r\n    DisplayObject.prototype.addEffect = function (target, textureURL, atlasURL, isBack, framerate, loop, killComplete) {\r\n        if (!target) {\r\n            target = new _ui_components_dynamic_sprite__WEBPACK_IMPORTED_MODULE_1__["DynamicSprite"](this.scene, 0, 0);\r\n        }\r\n        target.load(textureURL, atlasURL);\r\n        target.y = -20;\r\n        if (isBack) {\r\n            this.addAt(target, DisplayField.BACKEND);\r\n        }\r\n        else {\r\n            this.addAt(target, DisplayField.FRONTEND);\r\n        }\r\n        // target.play(textureURL + atlasURL);\r\n        target.once(Phaser.Animations.Events.SPRITE_ANIMATION_COMPLETE, function () {\r\n            target.destroy();\r\n        });\r\n    };\r\n    DisplayObject.prototype.layouFlag = function (offset) {\r\n        if (offset === void 0) { offset = 4; }\r\n        if (!this.mFlagContainer)\r\n            return;\r\n        this.mFlagContainer.y = -96;\r\n        this.bringToTop(this.mNickname);\r\n        var children = this.mFlagContainer.list;\r\n        var _x = 0;\r\n        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\r\n            var child = children_1[_i];\r\n            child["x"] = _x;\r\n            if (child["width"])\r\n                _x = child["width"];\r\n        }\r\n    };\r\n    DisplayObject.prototype.clearBadges = function () {\r\n        if (!this.mBadges)\r\n            return;\r\n        for (var _i = 0, _a = this.mBadges; _i < _a.length; _i++) {\r\n            var badge = _a[_i];\r\n            badge.destroy();\r\n        }\r\n        this.mBadges.length = 0;\r\n    };\r\n    Object.defineProperty(DisplayObject.prototype, "flagContainer", {\r\n        get: function () {\r\n            if (this.mFlagContainer)\r\n                return this.mFlagContainer;\r\n            this.mFlagContainer = this.scene.make.container(undefined, false);\r\n            this.addAt(this.mFlagContainer, DisplayField.FLAG);\r\n            return this.mFlagContainer;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DisplayObject.prototype.addChildMap = function (key, display) {\r\n        if (!this.mChildMap) {\r\n            this.mChildMap = new Map();\r\n        }\r\n        this.mChildMap.set(key, display);\r\n    };\r\n    DisplayObject.prototype.removeChildMap = function (key) {\r\n        if (!this.mChildMap) {\r\n            return;\r\n        }\r\n        this.mChildMap.delete(key);\r\n    };\r\n    Object.defineProperty(DisplayObject.prototype, "baseLoc", {\r\n        get: function () {\r\n            return this.mBaseLoc || new Phaser.Geom.Point();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "sortX", {\r\n        get: function () {\r\n            return this.x;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "sortY", {\r\n        get: function () {\r\n            return this.y;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "sortZ", {\r\n        get: function () {\r\n            return this.z || 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "element", {\r\n        get: function () {\r\n            return this.mElement;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "collisionArea", {\r\n        get: function () {\r\n            return this.mCollisionArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DisplayObject.prototype, "originPoint", {\r\n        get: function () {\r\n            return this.mOriginPoint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DisplayObject;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/display.object.ts?')},"./src/rooms/display/dragonbones.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarSlotType", function() { return AvatarSlotType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarPartType", function() { return AvatarPartType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragonbonesDisplay", function() { return DragonbonesDisplay; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _display_object__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_sound_ISoundConfig__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/sound/ISoundConfig */ "./lib/rexui/lib/ui/interface/sound/ISoundConfig.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar AvatarSlotType;\r\n(function (AvatarSlotType) {\r\n    AvatarSlotType["BodyCostDres"] = "body_cost_$_dres";\r\n    AvatarSlotType["BodyCost"] = "body_cost_$";\r\n    AvatarSlotType["BodyTail"] = "body_tail_$";\r\n    AvatarSlotType["BodyWing"] = "body_wing_$";\r\n    AvatarSlotType["BodyBase"] = "body_base_$";\r\n    AvatarSlotType["BodySpec"] = "body_spec_$";\r\n    AvatarSlotType["FlegSpec"] = "fleg_spec_$";\r\n    AvatarSlotType["FlegBase"] = "fleg_base_$";\r\n    AvatarSlotType["FlegCost"] = "fleg_cost_$";\r\n    AvatarSlotType["BarmSpec"] = "barm_spec_$";\r\n    AvatarSlotType["BarmBase"] = "barm_base_$";\r\n    AvatarSlotType["BarmCost"] = "barm_cost_$";\r\n    AvatarSlotType["WeapBarm"] = "weap_barm_$";\r\n    AvatarSlotType["ShldBarm"] = "shld_barm_$";\r\n    AvatarSlotType["BlegSpec"] = "bleg_spec_$";\r\n    AvatarSlotType["BlegBase"] = "bleg_base_$";\r\n    AvatarSlotType["BlegCost"] = "bleg_cost_$";\r\n    AvatarSlotType["FarmSpec"] = "farm_spec_$";\r\n    AvatarSlotType["FarmBase"] = "farm_base_$";\r\n    AvatarSlotType["FarmCost"] = "farm_cost_$";\r\n    AvatarSlotType["ShldFarm"] = "shld_farm_$";\r\n    AvatarSlotType["WeapFarm"] = "weap_farm_$";\r\n    AvatarSlotType["HeadSpec"] = "head_spec_$";\r\n    AvatarSlotType["HeadMask"] = "head_mask_$";\r\n    AvatarSlotType["HeadEyes"] = "head_eyes_$";\r\n    AvatarSlotType["HeadBase"] = "head_base_$";\r\n    AvatarSlotType["HeadHairBack"] = "head_hair_$_back";\r\n    AvatarSlotType["HeadMous"] = "head_mous_$";\r\n    AvatarSlotType["HeadHair"] = "head_hair_$";\r\n    AvatarSlotType["HeadHats"] = "head_hats_$";\r\n})(AvatarSlotType || (AvatarSlotType = {}));\r\nvar AvatarPartType;\r\n(function (AvatarPartType) {\r\n    AvatarPartType["BarmBase"] = "barm_base_#_$";\r\n    AvatarPartType["BarmCost"] = "barm_cost_#_$";\r\n    AvatarPartType["BarmSpec"] = "barm_spec_#_$";\r\n    AvatarPartType["BlegBase"] = "bleg_base_#_$";\r\n    AvatarPartType["BlegCost"] = "bleg_cost_#_$";\r\n    AvatarPartType["BlegSpec"] = "bleg_spec_#_$";\r\n    AvatarPartType["BodyBase"] = "body_base_#_$";\r\n    AvatarPartType["BodyCost"] = "body_cost_#_$";\r\n    AvatarPartType["BodyCostDres"] = "body_cost_#_$_dres";\r\n    AvatarPartType["BodySpec"] = "body_spec_#_$";\r\n    AvatarPartType["BodyTail"] = "body_tail_#_$";\r\n    AvatarPartType["BodyWing"] = "body_wing_#_$";\r\n    AvatarPartType["FarmBase"] = "farm_base_#_$";\r\n    AvatarPartType["FarmCost"] = "farm_cost_#_$";\r\n    AvatarPartType["FarmSpec"] = "farm_spec_#_$";\r\n    AvatarPartType["FlegBase"] = "fleg_base_#_$";\r\n    AvatarPartType["FlegCost"] = "fleg_cost_#_$";\r\n    AvatarPartType["FlegSpec"] = "fleg_spec_#_$";\r\n    AvatarPartType["HeadBase"] = "head_base_#_$";\r\n    AvatarPartType["HeadEyes"] = "head_eyes_#_$";\r\n    AvatarPartType["HeadHair"] = "head_hair_#_$";\r\n    AvatarPartType["HeadHairBack"] = "head_hair_#_$_back";\r\n    AvatarPartType["HeadHats"] = "head_hats_#_$";\r\n    AvatarPartType["HeadMask"] = "head_mask_#_$";\r\n    AvatarPartType["HeadMous"] = "head_mous_#_$";\r\n    AvatarPartType["HeadSpec"] = "head_spec_#_$";\r\n    AvatarPartType["ShldFarm"] = "shld_farm_#_$";\r\n    AvatarPartType["WeapFarm"] = "weap_farm_#_$";\r\n    AvatarPartType["ShldBarm"] = "shld_barm_#_$";\r\n    AvatarPartType["WeapBarm"] = "weap_barm_#_$";\r\n})(AvatarPartType || (AvatarPartType = {}));\r\n/**\r\n * 龙骨显示对象\r\n */\r\nvar DragonbonesDisplay = /** @class */ (function (_super) {\r\n    __extends(DragonbonesDisplay, _super);\r\n    function DragonbonesDisplay(scene, roomService, element, antial) {\r\n        if (antial === void 0) { antial = false; }\r\n        var _this = _super.call(this, scene, roomService, element, antial) || this;\r\n        _this.mAnimationName = "Armature";\r\n        _this.mDragonbonesName = "";\r\n        _this.replaceArr = [];\r\n        _this.mHasLoadMap = new Map();\r\n        _this.mLoadMap = new Map();\r\n        _this.mErrorLoadMap = new Map();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "spriteWidth", {\r\n        get: function () {\r\n            if (this.mArmatureDisplay) {\r\n                return this.mArmatureDisplay.width;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "spriteHeight", {\r\n        get: function () {\r\n            if (this.mArmatureDisplay) {\r\n                return this.mArmatureDisplay.height;\r\n            }\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "GameObject", {\r\n        get: function () {\r\n            return this;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DragonbonesDisplay.prototype.changeAlpha = function (val) {\r\n        // this.alpha = val;\r\n    };\r\n    DragonbonesDisplay.prototype.load = function (display, field) {\r\n        field = !field ? _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE : field;\r\n        if (field === _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE) {\r\n            this.mDisplayInfo = display;\r\n            this.mCollisionArea = [[1, 1], [1, 1]];\r\n            this.mOriginPoint = new Phaser.Geom.Point(1, 1);\r\n            if (!this.mDisplayInfo)\r\n                return;\r\n            this.dragonBonesName = "bones_human01"; // this.mDisplayInfo.avatar.id;\r\n        }\r\n        else {\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.getDisplay = function () {\r\n        return this.mArmatureDisplay;\r\n    };\r\n    DragonbonesDisplay.prototype.play = function (val) {\r\n        this.mActionName = val;\r\n        if (this.mArmatureDisplay) {\r\n            if (this.mArmatureDisplay.hasDBEventListener(dragonBones.EventObject.LOOP_COMPLETE)) {\r\n                this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE, this.onArmatureLoopComplete, this);\r\n            }\r\n            if (val.playingQueue && val.playingQueue.complete) {\r\n                this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.LOOP_COMPLETE, this.onArmatureLoopComplete, this);\r\n            }\r\n            this.mArmatureDisplay.animation.play(val.name);\r\n            this.mArmatureDisplay.scaleX = val.flip ? -1 : 1;\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.fadeIn = function (callback) {\r\n        this.clearFadeTween();\r\n        this.alpha = 0;\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 1,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.fadeOut = function (callback) {\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            }\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.destroy = function () {\r\n        this.mDisplayInfo = null;\r\n        if (this.mArmatureDisplay) {\r\n            this.mArmatureDisplay.dispose(true);\r\n            this.mArmatureDisplay = null;\r\n        }\r\n        if (this.mClickCon) {\r\n            this.mClickCon.destroy(true);\r\n            this.mClickCon = null;\r\n        }\r\n        if (this.mFadeTween) {\r\n            this.clearFadeTween();\r\n            this.mFadeTween = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DragonbonesDisplay.prototype.buildDragbones = function () {\r\n        if (this.scene.cache.custom.dragonbone.get(this.mDragonbonesName)) {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n        else {\r\n            var res = "./resources/dragonbones";\r\n            var pngUrl = res + "/" + this.mDragonbonesName + "_tex.png";\r\n            var jsonUrl = res + "/" + this.mDragonbonesName + "_tex.json";\r\n            var dbbinUrl = res + "/" + this.mDragonbonesName + "_ske.dbbin";\r\n            this.loadDragonBones(res, pngUrl, jsonUrl, dbbinUrl);\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.onLoadCompleteHandler = function (loader, totalComplete, totalFailed) {\r\n        if (!this.scene)\r\n            return;\r\n        if (this.mArmatureDisplay) {\r\n            this.mArmatureDisplay.dbClear();\r\n        }\r\n        this.mArmatureDisplay = this.scene.add.armature(this.mAnimationName, this.dragonBonesName);\r\n        this.mArmatureDisplay.addDBEventListener(dragonBones.EventObject.SOUND_EVENT, this.onSoundEventHandler, this);\r\n        this.mArmatureDisplay.visible = false;\r\n        this.add(this.mArmatureDisplay);\r\n        // ==========只有在创建龙骨时才会调用全部清除，显示通过后续通信做处理\r\n        this.clearArmatureSlot();\r\n        // ==========替换相应格位的display，服务端通信后可调用\r\n        this.getReplaceArr();\r\n        this.showReplaceArmatrue();\r\n        // this.play("idle");\r\n        this.mArmatureDisplay.x = this.baseLoc.x;\r\n        this.mArmatureDisplay.y = this.baseLoc.y;\r\n        var rect = new Phaser.Geom.Rectangle(0, 0, 50, 70);\r\n        if (!this.mClickCon) {\r\n            this.mClickCon = this.scene.make.container(undefined, false);\r\n            this.mClickCon.setInteractive(rect, Phaser.Geom.Rectangle.Contains);\r\n            this.mClickCon.x = -rect.width >> 1;\r\n            this.mClickCon.y = -rect.height;\r\n        }\r\n        this.setData("id", this.mDisplayInfo.id);\r\n        this.add(this.mClickCon);\r\n        this.emit("initialized");\r\n    };\r\n    DragonbonesDisplay.prototype.loadDragonBones = function (resUrl, pngUrl, jsonUrl, dbbinUrl) {\r\n        this.scene.load.dragonbone(this.mDragonbonesName, pngUrl, jsonUrl, dbbinUrl, null, null, { responseType: "arraybuffer" });\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        this.scene.load.start();\r\n    };\r\n    DragonbonesDisplay.prototype.clearArmatureSlot = function () {\r\n        var slotList = this.mArmatureDisplay.armature.getSlots();\r\n        slotList.forEach(function (slot) {\r\n            if (slot)\r\n                slot.display.visible = false;\r\n        });\r\n    };\r\n    DragonbonesDisplay.prototype.clearReplaceArmature = function () {\r\n        this.mArmatureDisplay.armature.animation.stop();\r\n        if (!this.replaceArr || this.replaceArr.length === 0) {\r\n            return;\r\n        }\r\n        var len = this.replaceArr.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var part = this.replaceArr[i].slot.replace("$", this.replaceArr[i].dir.toString());\r\n            var slot = this.mArmatureDisplay.armature.getSlot(part);\r\n            slot.replaceDisplay(null);\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.showReplaceArmatrue = function () {\r\n        for (var _i = 0, _a = this.replaceArr; _i < _a.length; _i++) {\r\n            var obj = _a[_i];\r\n            this.replacePartDisplay(obj.slot, obj.part, obj.dir, obj.skin);\r\n        }\r\n        if (this.mLoadMap && this.mLoadMap.size > 0) {\r\n            this.startLoad();\r\n        }\r\n        else {\r\n            this.refreshAvatar();\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.getReplaceArr = function () {\r\n        this.replaceArr.length = 0;\r\n        var avater = this.mDisplayInfo.avatar;\r\n        if (avater.bodyBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyBase,\r\n                part: AvatarPartType.BodyBase,\r\n                dir: 3,\r\n                skin: avater.bodyBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyBase,\r\n                part: AvatarPartType.BodyBase,\r\n                dir: 1,\r\n                skin: avater.bodyBaseId,\r\n            });\r\n        }\r\n        if (avater.bodySpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodySpec,\r\n                part: AvatarPartType.BodySpec,\r\n                dir: 3,\r\n                skin: avater.bodySpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodySpec,\r\n                part: AvatarPartType.BodySpec,\r\n                dir: 1,\r\n                skin: avater.bodySpecId,\r\n            });\r\n        }\r\n        if (avater.bodyWingId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyWing,\r\n                part: AvatarPartType.BodyWing,\r\n                dir: 3,\r\n                skin: avater.bodyWingId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyWing,\r\n                part: AvatarPartType.BodyWing,\r\n                dir: 1,\r\n                skin: avater.bodyWingId,\r\n            });\r\n        }\r\n        if (avater.bodyTailId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyTail,\r\n                part: AvatarPartType.BodyTail,\r\n                dir: 3,\r\n                skin: avater.bodyTailId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyTail,\r\n                part: AvatarPartType.BodyTail,\r\n                dir: 1,\r\n                skin: avater.bodyTailId,\r\n            });\r\n        }\r\n        if (avater.bodyCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCost,\r\n                part: AvatarPartType.BodyCost,\r\n                dir: 3,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCost,\r\n                part: AvatarPartType.BodyCost,\r\n                dir: 1,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCostDres,\r\n                part: AvatarPartType.BodyCostDres,\r\n                dir: 3,\r\n                skin: avater.bodyCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BodyCostDres,\r\n                part: AvatarPartType.BodyCostDres,\r\n                dir: 1,\r\n                skin: avater.bodyCostId,\r\n            });\r\n        }\r\n        if (avater.farmBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmBase,\r\n                part: AvatarPartType.FarmBase,\r\n                dir: 3,\r\n                skin: avater.farmBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmBase,\r\n                part: AvatarPartType.FarmBase,\r\n                dir: 1,\r\n                skin: avater.farmBaseId,\r\n            });\r\n        }\r\n        if (avater.farmSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmSpec,\r\n                part: AvatarPartType.FarmSpec,\r\n                dir: 3,\r\n                skin: avater.farmSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmSpec,\r\n                part: AvatarPartType.FarmSpec,\r\n                dir: 1,\r\n                skin: avater.farmSpecId,\r\n            });\r\n        }\r\n        if (avater.farmCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmCost,\r\n                part: AvatarPartType.FarmCost,\r\n                dir: 3,\r\n                skin: avater.farmCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FarmCost,\r\n                part: AvatarPartType.FarmCost,\r\n                dir: 1,\r\n                skin: avater.farmCostId,\r\n            });\r\n        }\r\n        if (avater.barmBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmBase,\r\n                part: AvatarPartType.BarmBase,\r\n                dir: 3,\r\n                skin: avater.barmBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmBase,\r\n                part: AvatarPartType.BarmBase,\r\n                dir: 1,\r\n                skin: avater.barmBaseId,\r\n            });\r\n        }\r\n        if (avater.barmSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmSpec,\r\n                part: AvatarPartType.BarmSpec,\r\n                dir: 3,\r\n                skin: avater.barmSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmSpec,\r\n                part: AvatarPartType.BarmSpec,\r\n                dir: 1,\r\n                skin: avater.barmSpecId,\r\n            });\r\n        }\r\n        if (avater.barmCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmCost,\r\n                part: AvatarPartType.BarmCost,\r\n                dir: 3,\r\n                skin: avater.barmCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BarmCost,\r\n                part: AvatarPartType.BarmCost,\r\n                dir: 1,\r\n                skin: avater.barmCostId,\r\n            });\r\n        }\r\n        if (avater.blegBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegBase,\r\n                part: AvatarPartType.BlegBase,\r\n                dir: 3,\r\n                skin: avater.blegBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegBase,\r\n                part: AvatarPartType.BlegBase,\r\n                dir: 1,\r\n                skin: avater.blegBaseId,\r\n            });\r\n        }\r\n        if (avater.blegSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegSpec,\r\n                part: AvatarPartType.BlegSpec,\r\n                dir: 3,\r\n                skin: avater.blegSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegSpec,\r\n                part: AvatarPartType.BlegSpec,\r\n                dir: 1,\r\n                skin: avater.blegSpecId,\r\n            });\r\n        }\r\n        if (avater.blegCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegCost,\r\n                part: AvatarPartType.BlegCost,\r\n                dir: 3,\r\n                skin: avater.blegCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.BlegCost,\r\n                part: AvatarPartType.BlegCost,\r\n                dir: 1,\r\n                skin: avater.blegCostId,\r\n            });\r\n        }\r\n        if (avater.flegBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegBase,\r\n                part: AvatarPartType.FlegBase,\r\n                dir: 3,\r\n                skin: avater.flegBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegBase,\r\n                part: AvatarPartType.FlegBase,\r\n                dir: 1,\r\n                skin: avater.flegBaseId,\r\n            });\r\n        }\r\n        if (avater.flegSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegSpec,\r\n                part: AvatarPartType.FlegSpec,\r\n                dir: 3,\r\n                skin: avater.flegSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegSpec,\r\n                part: AvatarPartType.FlegSpec,\r\n                dir: 1,\r\n                skin: avater.flegSpecId,\r\n            });\r\n        }\r\n        if (avater.flegCostId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegCost,\r\n                part: AvatarPartType.FlegCost,\r\n                dir: 3,\r\n                skin: avater.flegCostId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.FlegCost,\r\n                part: AvatarPartType.FlegCost,\r\n                dir: 1,\r\n                skin: avater.flegCostId,\r\n            });\r\n        }\r\n        if (avater.headBaseId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadBase,\r\n                part: AvatarPartType.HeadBase,\r\n                dir: 3,\r\n                skin: avater.headBaseId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadBase,\r\n                part: AvatarPartType.HeadBase,\r\n                dir: 1,\r\n                skin: avater.headBaseId,\r\n            });\r\n        }\r\n        if (avater.barmWeapId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 3,\r\n                skin: avater.barmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 1,\r\n                skin: avater.barmWeapId,\r\n            });\r\n        }\r\n        if (avater.headHairId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHair,\r\n                part: AvatarPartType.HeadHair,\r\n                dir: 3,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHair,\r\n                part: AvatarPartType.HeadHair,\r\n                dir: 1,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHairBack,\r\n                part: AvatarPartType.HeadHairBack,\r\n                dir: 3,\r\n                skin: avater.headHairId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHairBack,\r\n                part: AvatarPartType.HeadHairBack,\r\n                dir: 1,\r\n                skin: avater.headHairId,\r\n            });\r\n        }\r\n        if (avater.headHatsId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHats,\r\n                part: AvatarPartType.HeadHats,\r\n                dir: 3,\r\n                skin: avater.headHatsId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadHats,\r\n                part: AvatarPartType.HeadHats,\r\n                dir: 1,\r\n                skin: avater.headHatsId,\r\n            });\r\n        }\r\n        if (avater.headSpecId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadSpec,\r\n                part: AvatarPartType.HeadSpec,\r\n                dir: 3,\r\n                skin: avater.headSpecId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadSpec,\r\n                part: AvatarPartType.HeadSpec,\r\n                dir: 1,\r\n                skin: avater.headSpecId,\r\n            });\r\n        }\r\n        if (avater.headEyesId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadEyes,\r\n                part: AvatarPartType.HeadEyes,\r\n                dir: 3,\r\n                skin: avater.headEyesId,\r\n            });\r\n        }\r\n        if (avater.headMousId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadMous,\r\n                part: AvatarPartType.HeadMous,\r\n                dir: 3,\r\n                skin: avater.headMousId,\r\n            });\r\n        }\r\n        if (avater.headMaskId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.HeadMask,\r\n                part: AvatarPartType.HeadMask,\r\n                dir: 3,\r\n                skin: avater.headMaskId,\r\n            });\r\n        }\r\n        if (avater.farmShldId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldFarm,\r\n                part: AvatarPartType.ShldFarm,\r\n                dir: 3,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldFarm,\r\n                part: AvatarPartType.ShldFarm,\r\n                dir: 1,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldBarm,\r\n                part: AvatarPartType.ShldBarm,\r\n                dir: 3,\r\n                skin: avater.farmShldId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.ShldBarm,\r\n                part: AvatarPartType.ShldBarm,\r\n                dir: 1,\r\n                skin: avater.farmShldId,\r\n            });\r\n        }\r\n        if (avater.farmWeapId) {\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapFarm,\r\n                part: AvatarPartType.WeapFarm,\r\n                dir: 3,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapFarm,\r\n                part: AvatarPartType.WeapFarm,\r\n                dir: 1,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 3,\r\n                skin: avater.farmWeapId,\r\n            });\r\n            this.replaceArr.push({\r\n                slot: AvatarSlotType.WeapBarm,\r\n                part: AvatarPartType.WeapBarm,\r\n                dir: 1,\r\n                skin: avater.farmWeapId,\r\n            });\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.replacePartDisplay = function (soltName, soltPart, soltDir, skin) {\r\n        var part = soltName.replace("$", soltDir.toString());\r\n        var slot = this.mArmatureDisplay.armature.getSlot(part);\r\n        var key = soltPart.replace("#", skin.toString()).replace("$", soltDir.toString());\r\n        var dragonBonesTexture = this.scene.game.textures.get(this.mDragonbonesName);\r\n        if (this.scene.cache.custom.dragonbone.get(this.dragonBonesName)) {\r\n            var partName = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(key);\r\n            var frameName = "test resources/" + key;\r\n            if (this.mErrorLoadMap.get(partName))\r\n                return;\r\n            if (!this.scene.textures.exists(partName)) {\r\n                if (!dragonBonesTexture.frames[frameName]) {\r\n                    // ==============新资源需从外部加载，之后要重新打图集\r\n                    this.mLoadMap.set(slot.name, [slot.name, key]);\r\n                }\r\n                else {\r\n                    this.mHasLoadMap.set(key, this.scene.textures.get(partName));\r\n                }\r\n            }\r\n            else {\r\n                //     // ==============贴图集上的资源 / 单个替换资源\r\n                // this.mHasLoadMap.set(slot.name,this.scene.textures.exists(partName));\r\n                // let img: dragonBones.phaser.display.SlotImage;\r\n                // if (dragonBonesTexture.frames[frameName]) {// && this.scene.game.textures.exists(this.mDisplayInfo.id + "")) {\r\n                //     if (!this.scene.textures.exists(partName)) {\r\n                //         this.mLoadMap.set(slot.name, [slot.name, key]);\r\n                //         return;\r\n                //     }\r\n                //     img = new dragonBones.phaser.display.SlotImage(this.scene, slot.display.x, slot.display.y, partName);\r\n                // } else {\r\n                //     img = new dragonBones.phaser.display.SlotImage(this.scene, slot.display.x, slot.display.y, partName);\r\n                // }\r\n                // if (this.mAntial) {\r\n                //     // 用于设置边缘抗锯齿\r\n                //     img.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n                // }\r\n                // slot.replaceDisplay(img);\r\n            }\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.startLoad = function () {\r\n        var _this = this;\r\n        var configList = [];\r\n        // ============只有check到新资源时才会重新load，否则直接从当前龙骨的贴图资源上，获取对应贴图\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, function (data, totalComplete, totalFailed) {\r\n            if (!configList || !_this.scene)\r\n                return;\r\n            _this.refreshAvatar();\r\n            _this.mLoadMap.clear();\r\n        }, this);\r\n        this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, function (e) {\r\n            // ==============为了防止404资源重复请求加载，在加载失败后直接将其索引放置加载失败列表中，并从加载map中删除\r\n            _this.mLoadMap.delete(e.key);\r\n            _this.mErrorLoadMap.set(e.key, e);\r\n        }, this);\r\n        this.mLoadMap.forEach(function (data) {\r\n            var nextLoad = data;\r\n            var partUrl = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartUrl(nextLoad[1]);\r\n            var partName = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(nextLoad[1]);\r\n            configList.push({ key: partName, url: partUrl });\r\n        });\r\n        this.scene.load.image(configList);\r\n        this.scene.load.start();\r\n    };\r\n    DragonbonesDisplay.prototype.refreshAvatar = function () {\r\n        var _this = this;\r\n        var dragonBonesTexture = this.scene.game.textures.get(this.mDragonbonesName);\r\n        var frames = dragonBonesTexture.getFrameNames();\r\n        // ==============重绘贴图方式\r\n        // if (this.mLoadMap.size > 0) {\r\n        // }\r\n        var renderTextureKey = "bones_" + this.mDisplayInfo.id; // "bones_" + this.mDisplayInfo.id;// "bones_human01";\r\n        var renderTexture = this.scene.textures.get(renderTextureKey);\r\n        if (!this.mDragonBonesRenderTexture)\r\n            this.mDragonBonesRenderTexture = this.scene.make.renderTexture({ x: 0, y: 0, width: dragonBonesTexture.source[0].width, height: dragonBonesTexture.source[0].height }, false);\r\n        this.mDragonBonesRenderTexture.clear();\r\n        // this.scene.add.existing(this.mDragonBonesRenderTexture);\r\n        for (var i = 0, len = frames.length; i < len; i++) {\r\n            // =============龙骨贴图资源frames里面的key "test resources/xxxxx"\r\n            var name_1 = frames[i];\r\n            // =============龙骨part资源key 带图片资源名及方向\r\n            var key = name_1.split("/")[1].split("_");\r\n            // =============front || back单独也有格位\r\n            var slotKey = key[4] ? key[0] + "_" + key[1] + "_" + key[3] + "_" + key[4] : key[0] + "_" + key[1] + "_" + key[3];\r\n            var slot = this.mArmatureDisplay.armature.getSlot(slotKey);\r\n            var dat = dragonBonesTexture.get(name_1);\r\n            var loadArr = this.mLoadMap.get(slotKey);\r\n            // 原始资源\r\n            if (!loadArr) {\r\n                for (var _i = 0, _a = this.replaceArr; _i < _a.length; _i++) {\r\n                    var obj = _a[_i];\r\n                    var tmpKey = obj.part.replace("#", obj.skin.toString()).replace("$", obj.dir.toString());\r\n                    var partName = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["ResUtils"].getPartName(tmpKey);\r\n                    var frameName = "test resources/" + tmpKey;\r\n                    var part = obj.slot.replace("$", obj.dir.toString());\r\n                    if (part === slotKey) {\r\n                        var texture = this.scene.textures.get(partName);\r\n                        // if (this.mAntial) {\r\n                        //     // 用于设置边缘抗锯齿\r\n                        //     texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n                        // }\r\n                        if (dragonBonesTexture.frames[frameName]) {\r\n                            this.mDragonBonesRenderTexture.drawFrame(this.mDragonbonesName, name_1, dat.cutX, dat.cutY);\r\n                            break;\r\n                        }\r\n                        else {\r\n                            this.mDragonBonesRenderTexture.drawFrame(partName, texture.firstFrame, dat.cutX, dat.cutY);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                // this.mDragonBonesRenderTexture.drawFrame(this.mDragonbonesName, name, dat.cutX, dat.cutY);\r\n            }\r\n            else {\r\n                var drawTextureKey = loadArr[1] + "_png";\r\n                var drawTexture = this.scene.game.textures.get(drawTextureKey);\r\n                // if (this.mAntial) {\r\n                //     // 用于设置边缘抗锯齿\r\n                //     drawTexture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n                // }\r\n                this.mDragonBonesRenderTexture.drawFrame(drawTextureKey, drawTexture.firstFrame, dat.cutX, dat.cutY);\r\n            }\r\n        }\r\n        this.mDragonBonesRenderTexture.snapshotArea(0, 0, dragonBonesTexture.source[0].width, dragonBonesTexture.source[0].height, function (snapshot) {\r\n            if (snapshot instanceof HTMLImageElement) {\r\n                if (_this.scene.game.textures.exists(renderTextureKey))\r\n                    _this.scene.game.textures.removeKey(renderTextureKey);\r\n                var changeTexture = _this.scene.game.textures.create(renderTextureKey, snapshot, dragonBonesTexture.source[0].width, dragonBonesTexture.source[0].height);\r\n                // if (this.mAntial) {\r\n                //     changeTexture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n                // }\r\n                _this.mArmatureDisplay.armature.replacedTexture = changeTexture;\r\n            }\r\n        });\r\n        // }\r\n        this.mArmatureDisplay.visible = true;\r\n    };\r\n    DragonbonesDisplay.prototype.clearFadeTween = function () {\r\n        if (this.mFadeTween) {\r\n            this.mFadeTween.stop();\r\n            this.mFadeTween.remove();\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.onArmatureLoopComplete = function (event) {\r\n        if (!this.mArmatureDisplay || !this.mActionName) {\r\n            return;\r\n        }\r\n        var queue = this.mActionName.playingQueue;\r\n        if (queue.playedTimes === undefined) {\r\n            queue.playedTimes = 1;\r\n        }\r\n        else {\r\n            queue.playedTimes++;\r\n        }\r\n        if (queue.playedTimes >= queue.playTimes) {\r\n            this.mArmatureDisplay.removeDBEventListener(dragonBones.EventObject.LOOP_COMPLETE, this.onArmatureLoopComplete, this);\r\n            // this.emit("animationComplete");\r\n            if (queue.complete) {\r\n                queue.complete.call(this);\r\n                delete queue.complete;\r\n            }\r\n        }\r\n    };\r\n    DragonbonesDisplay.prototype.onSoundEventHandler = function (event) {\r\n        // Logger.getInstance().log("sound event: ", event.name);\r\n        if (event.name) {\r\n            this.mRoomService.world.playSound({\r\n                field: _lib_rexui_lib_ui_interface_sound_ISoundConfig__WEBPACK_IMPORTED_MODULE_2__["SoundField"].Element,\r\n                key: event.name,\r\n            });\r\n        }\r\n    };\r\n    Object.defineProperty(DragonbonesDisplay.prototype, "dragonBonesName", {\r\n        get: function () {\r\n            return this.mDragonbonesName;\r\n        },\r\n        set: function (val) {\r\n            // if (this.mDragonbonesName !== val) {\r\n            // TODO 暴露一个换装接口\r\n            this.mDragonbonesName = val;\r\n            this.buildDragbones();\r\n            // }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DragonbonesDisplay;\r\n}(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/dragonbones.display.ts?')},"./src/rooms/display/dragonbones.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragonbonesModel", function() { return DragonbonesModel; });\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n\r\nvar DragonbonesModel = /** @class */ (function () {\r\n    function DragonbonesModel(data) {\r\n        this.discriminator = "DragonbonesModel";\r\n        // this.id = id;\r\n        // this.avatar = avatar;\r\n        if (data) {\r\n            this.id = data.id;\r\n            this.avatar = data.avatar;\r\n        }\r\n    }\r\n    DragonbonesModel.prototype.setInfo = function (val) {\r\n        for (var key in val) {\r\n            if (val.hasOwnProperty(key)) {\r\n                this[key] = val[key];\r\n            }\r\n        }\r\n    };\r\n    DragonbonesModel.prototype.destroy = function () {\r\n    };\r\n    DragonbonesModel.prototype.getCollisionArea = function (aniName) {\r\n        return [[1, 1], [1, 1]];\r\n    };\r\n    DragonbonesModel.prototype.getWalkableArea = function () {\r\n        return [[1, 1], [1, 1]];\r\n    };\r\n    DragonbonesModel.prototype.getOriginPoint = function (aniName) {\r\n        return new Phaser.Geom.Point(1, 1);\r\n    };\r\n    DragonbonesModel.prototype.getInteractiveArea = function () {\r\n        return undefined;\r\n    };\r\n    DragonbonesModel.prototype.existAnimation = function (aniName) {\r\n        return true;\r\n    };\r\n    DragonbonesModel.prototype.findAnimation = function (baseName, dir) {\r\n        var flip = false;\r\n        switch (dir) {\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].south_east:\r\n                flip = true;\r\n                dir = _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].west_south;\r\n                break;\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].east_north:\r\n                flip = true;\r\n                dir = _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].north_west;\r\n                break;\r\n        }\r\n        var addName = "";\r\n        if ((dir >= _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].north && dir < _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].west) || dir > _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].east && dir <= _element_element__WEBPACK_IMPORTED_MODULE_0__["Direction"].east_north)\r\n            addName = "_back";\r\n        return { name: "" + baseName + addName, flip: flip };\r\n    };\r\n    return DragonbonesModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/dragonbones.model.ts?')},"./src/rooms/display/frames.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramesDisplay", function() { return FramesDisplay; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _display_object__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n// export enum DisplayField {\r\n//     BACKEND = 1,\r\n//     STAGE,\r\n//     FRONTEND,\r\n//     Effect\r\n// }\r\n/**\r\n * 序列帧显示对象\r\n */\r\nvar FramesDisplay = /** @class */ (function (_super) {\r\n    __extends(FramesDisplay, _super);\r\n    function FramesDisplay() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.mDisplayDatas = new Map();\r\n        _this.mSprites = new Map();\r\n        _this.mDisplays = [];\r\n        return _this;\r\n    }\r\n    FramesDisplay.prototype.load = function (displayInfo, field) {\r\n        var _this = this;\r\n        field = !field ? _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE : field;\r\n        var data = displayInfo;\r\n        if (!data || !data.gene)\r\n            return;\r\n        var currentDisplay = this.mDisplayDatas.get(field);\r\n        if (currentDisplay && currentDisplay.gene === displayInfo.gene) {\r\n            return;\r\n        }\r\n        this.mDisplayDatas.set(field, data);\r\n        this.setData("id", data.id);\r\n        if (this.scene.textures.exists(data.gene)) {\r\n            this.onLoadCompleted(field);\r\n        }\r\n        else {\r\n            var display = data.display;\r\n            if (!display) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("display is undefined");\r\n            }\r\n            if (display.texturePath === "" && display.dataPath === "") {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("动画资源报错：", data);\r\n            }\r\n            else {\r\n                this.scene.load.atlas(data.gene, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].OSD_PATH + display.texturePath, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].OSD_PATH + display.dataPath);\r\n                // this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, (imageFile: ImageFile) => {\r\n                //     Logger.error(`Loading Error: key = ${imageFile} >> ${imageFile.url}`);\r\n                // }, this);\r\n                var cb_1 = function (key) {\r\n                    _this.onAddTextureHandler(key, field, cb_1);\r\n                };\r\n                this.scene.textures.on(Phaser.Textures.Events.ADD, cb_1, this);\r\n                this.scene.load.start();\r\n            }\r\n        }\r\n    };\r\n    FramesDisplay.prototype.play = function (animation, field) {\r\n        if (!animation)\r\n            return;\r\n        field = !field ? _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE : field;\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (this.scene.textures.exists(data.gene) === false) {\r\n            return;\r\n        }\r\n        this.mCurAnimation = data.getAnimations(animation.name);\r\n        if (!this.mCurAnimation)\r\n            return;\r\n        this.clear();\r\n        var layer = this.mCurAnimation.layer;\r\n        var container = this.mSprites.get(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE);\r\n        if (!container) {\r\n            container = this.scene.make.container(undefined, false);\r\n            container.setData("id", data.id);\r\n            this.addAt(container, _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE);\r\n            this.mSprites.set(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE, container);\r\n        }\r\n        for (var i = 0; i < layer.length; i++) {\r\n            var display = void 0;\r\n            var _a = layer[i], frameName = _a.frameName, offsetLoc = _a.offsetLoc;\r\n            if (frameName.length > 1) {\r\n                var key = data.gene + "_" + animation.name + "_" + i;\r\n                this.makeAnimation(data.gene, key, layer[i].frameName, layer[i].frameVisible, this.mCurAnimation);\r\n                display = this.scene.make.sprite(undefined, false).play(key);\r\n                if (!this.mMainSprite) {\r\n                    this.mMainSprite = display;\r\n                }\r\n            }\r\n            else {\r\n                display = this.scene.make.image(undefined, false).setTexture(data.gene, frameName[0]);\r\n            }\r\n            this.mDisplays.push(display);\r\n            display.scaleX = animation.flip ? -1 : 1;\r\n            var x = offsetLoc.x;\r\n            var y = offsetLoc.y;\r\n            if (animation.flip) {\r\n                x = (0 - (display.width + x));\r\n            }\r\n            display.x = x + display.width * 0.5;\r\n            display.y = y + display.height * 0.5;\r\n            container.add(display);\r\n        }\r\n        // if (this.mActionName && this.mActionName.animationName !== animation.animationName) {\r\n        this.initBaseLoc(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE, animation);\r\n        // }\r\n        this.emit("updateAnimation");\r\n        if (this.mMainSprite) {\r\n            this.mMainSprite.on(Phaser.Animations.Events.ANIMATION_REPEAT, this.onAnimationRepeatHander, this);\r\n        }\r\n        if (this.mMountContainer && this.mCurAnimation.mountLayer) {\r\n            var stageContainer = this.mSprites.get(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE);\r\n            if (stageContainer)\r\n                stageContainer.addAt(this.mMountContainer, this.mCurAnimation.mountLayer.index);\r\n        }\r\n        this.mActionName = animation;\r\n    };\r\n    FramesDisplay.prototype.playEffect = function () {\r\n        var data = this.mDisplayDatas.get(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].Effect);\r\n        if (!data) {\r\n            return;\r\n        }\r\n        // TODO\r\n        var anis = data.getAnimations("idle");\r\n        if (!anis) {\r\n            return;\r\n        }\r\n        var layer = anis.layer;\r\n        var effects = [];\r\n        for (var i = 0; i < layer.length; i++) {\r\n            var display = void 0;\r\n            var _a = layer[i], frameName = _a.frameName, offsetLoc = _a.offsetLoc;\r\n            if (frameName.length > 1) {\r\n                var key = data.gene + "_idle_" + i;\r\n                this.makeAnimation(data.gene, key, layer[i].frameName, layer[i].frameVisible, anis);\r\n                display = this.scene.make.sprite(undefined, false).play(key);\r\n            }\r\n            else {\r\n                display = this.scene.make.image(undefined, false).setTexture(data.gene, frameName[0]);\r\n            }\r\n            display.x = offsetLoc.x + display.width * 0.5;\r\n            display.y = offsetLoc.y + display.height * 0.5;\r\n            effects.push(display);\r\n        }\r\n        if (effects.length > 1) {\r\n            this.addAt(effects[1], _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].BACKEND);\r\n            this.mSprites.set(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].BACKEND, effects[1]);\r\n        }\r\n        this.addAt(effects[0], _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].FRONTEND);\r\n        this.mSprites.set(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].FRONTEND, effects[0]);\r\n    };\r\n    FramesDisplay.prototype.mount = function (display, targetIndex) {\r\n        if (!display)\r\n            return;\r\n        if (this.mDisplays.length <= 0) {\r\n            return;\r\n        }\r\n        if (!this.mCurAnimation) {\r\n            return;\r\n        }\r\n        var _a = this.mCurAnimation.mountLayer, index = _a.index, mountPoint = _a.mountPoint;\r\n        if (targetIndex === undefined)\r\n            targetIndex = 0;\r\n        var x = mountPoint[targetIndex].x;\r\n        if (this.mActionName.flip) {\r\n            x = 0 - x;\r\n        }\r\n        display.x = x;\r\n        display.y = mountPoint[targetIndex].y;\r\n        if (!this.mMountContainer) {\r\n            this.mMountContainer = this.scene.make.container(undefined, false);\r\n        }\r\n        if (!this.mMountContainer.parentContainer) {\r\n            var container = this.mSprites.get(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE);\r\n            if (container)\r\n                container.addAt(this.mMountContainer, index);\r\n        }\r\n        this.mMountContainer.addAt(display, targetIndex);\r\n        this.mMountList[targetIndex] = display;\r\n        if (this.mMainSprite) {\r\n            // 侦听前先移除，避免重复添加\r\n            this.mMainSprite.off("animationupdate", this.onAnimationUpdateHandler, this);\r\n            this.mMainSprite.on("animationupdate", this.onAnimationUpdateHandler, this);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.unmount = function (display) {\r\n        if (!this.mMountContainer) {\r\n            return;\r\n        }\r\n        this.mMountContainer.remove(display);\r\n        var index = this.mMountList.indexOf(display);\r\n        display.visible = true;\r\n        if (index > -1) {\r\n            this.mMountList.splice(index, 1);\r\n        }\r\n        var list = this.mMountContainer.list;\r\n        if (list.length <= 0 && this.mDisplays.length > 0) {\r\n            this.mDisplays[0].off("animationupdate", this.onAnimationUpdateHandler, this);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.fadeIn = function (callback) {\r\n        if (this.mAlpha === 0) {\r\n            return;\r\n        }\r\n        this.alpha = 0;\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: this.mAlpha,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            },\r\n        });\r\n    };\r\n    FramesDisplay.prototype.fadeOut = function (callback) {\r\n        this.clearFadeTween();\r\n        this.mFadeTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 1200,\r\n            onComplete: function () {\r\n                if (callback)\r\n                    callback();\r\n            },\r\n        });\r\n    };\r\n    FramesDisplay.prototype.scaleTween = function () {\r\n        var _this = this;\r\n        if (this.mMountContainer && this.mMountContainer.list.length > 0) {\r\n            return;\r\n        }\r\n        if (this.mScaleTween) {\r\n            return;\r\n        }\r\n        var tmp = this.scale;\r\n        this.mScaleTween = this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 100,\r\n            scale: tmp * 1.25,\r\n            yoyo: true,\r\n            repeat: 0,\r\n            onComplete: function () {\r\n                _this.scale = 1;\r\n                if (_this.mScaleTween) {\r\n                    // this.mScaleTween.destroy();\r\n                    _this.mScaleTween = undefined;\r\n                }\r\n            },\r\n        });\r\n    };\r\n    FramesDisplay.prototype.setInteractive = function (shape, callback, dropZone) {\r\n        // super.setInteractive(shape, callback, dropZone);\r\n        this.mDisplays.forEach(function (display) {\r\n            display.setInteractive({ pixelPerfect: true });\r\n        });\r\n        return this;\r\n    };\r\n    FramesDisplay.prototype.disableInteractive = function () {\r\n        // super.disableInteractive();\r\n        this.mDisplays.forEach(function (sprite) {\r\n            sprite.disableInteractive();\r\n        });\r\n        return this;\r\n    };\r\n    FramesDisplay.prototype.removeEffect = function () {\r\n        var data = this.mDisplayDatas.get(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].Effect);\r\n        if (data) {\r\n            this.mDisplayDatas.delete(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].Effect);\r\n            this.removeDisplay(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].BACKEND);\r\n            this.removeDisplay(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].FRONTEND);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.removeDisplay = function (field) {\r\n        var display = this.mSprites.get(field);\r\n        if (display) {\r\n            this.mDisplayDatas.delete(field);\r\n            display.destroy();\r\n        }\r\n    };\r\n    FramesDisplay.prototype.destroy = function () {\r\n        this.mSprites.forEach(function (sprite) { return sprite.destroy(); });\r\n        this.mSprites.clear();\r\n        this.clear();\r\n        if (this.mFadeTween) {\r\n            this.clearFadeTween();\r\n            this.mFadeTween = undefined;\r\n        }\r\n        if (this.mScaleTween) {\r\n            this.mScaleTween.stop();\r\n            this.mScaleTween = undefined;\r\n        }\r\n        this.mDisplayDatas.clear();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FramesDisplay.prototype.createDisplay = function (key, ani) {\r\n        // const ani = data.getAnimations(animationName);\r\n        var layer = ani.layer;\r\n        var display;\r\n        for (var i = 0; i < layer.length; i++) {\r\n            if (layer[i].frameName.length > 1) {\r\n                display = this.scene.make.sprite(undefined, false);\r\n                var aniName = key + "_" + ani.name + "_" + i;\r\n                this.makeAnimation(key, key, layer[i].frameName, layer[i].frameVisible, this.mCurAnimation);\r\n                display = this.scene.make.sprite(undefined, false);\r\n            }\r\n            else {\r\n                display = this.scene.make.image(undefined, false);\r\n            }\r\n            this.mDisplays.push(display);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.clearFadeTween = function () {\r\n        if (this.mFadeTween) {\r\n            this.mFadeTween.stop();\r\n            this.mFadeTween.remove();\r\n        }\r\n    };\r\n    FramesDisplay.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.mDisplays; _i < _a.length; _i++) {\r\n            var display = _a[_i];\r\n            display.destroy();\r\n        }\r\n        if (this.mMountContainer && this.mMountContainer.parentContainer) {\r\n            this.mMountContainer.parentContainer.remove(this.mMountContainer);\r\n        }\r\n        this.mMountList = [];\r\n        this.mDisplays = [];\r\n        this.mMainSprite = null;\r\n    };\r\n    FramesDisplay.prototype.onAddTextureHandler = function (key, field, cb) {\r\n        if (field === undefined) {\r\n            field = _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE;\r\n        }\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (data && data.gene === key) {\r\n            this.scene.textures.off(Phaser.Textures.Events.ADD, cb, this);\r\n            this.onLoadCompleted(field);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.onLoadCompleted = function (field) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        if (!data) {\r\n            return;\r\n        }\r\n        if (this.scene.textures.exists(data.gene)) {\r\n            if (field === _display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayField"].STAGE) {\r\n                this.emit("initialized", this);\r\n            }\r\n            else {\r\n                this.playEffect();\r\n            }\r\n        }\r\n    };\r\n    FramesDisplay.prototype.makeAnimation = function (gen, key, frameName, frameVisible, animation) {\r\n        var loop = animation.loop;\r\n        if (frameVisible && frameName.length !== frameVisible.length) {\r\n            return;\r\n        }\r\n        if (this.scene.anims.exists(key)) {\r\n            return;\r\n        }\r\n        var frames = [];\r\n        // frameName.forEach((frame) => {\r\n        //     frames.push({ key: gen, frame, visible: frame });\r\n        // });\r\n        for (var i = 0; i < frameName.length; i++) {\r\n            var frame = frameName[i];\r\n            var visible = frameVisible ? frameVisible[i] : true;\r\n            frames.push({ key: gen, frame: frame, visible: visible });\r\n        }\r\n        var repeat = loop ? -1 : 0;\r\n        var config = {\r\n            key: key,\r\n            frames: frames,\r\n            frameRate: animation.frameRate,\r\n            repeat: repeat,\r\n        };\r\n        this.scene.anims.create(config);\r\n    };\r\n    FramesDisplay.prototype.initBaseLoc = function (field, playAnimation) {\r\n        var data = this.mDisplayDatas.get(field);\r\n        // const sprite: Phaser.GameObjects.Sprite | Phaser.GameObjects.Image = this.mSprites.get(field);\r\n        if (this.mDisplays.length < 1 || !data || !data.animations)\r\n            return;\r\n        // const animations = data.getAnimations(aniName);\r\n        // if (!animations) return;\r\n        var name = playAnimation.name, flip = playAnimation.flip;\r\n        this.mCollisionArea = data.getCollisionArea(name, flip);\r\n        this.mOriginPoint = data.getOriginPoint(name, flip);\r\n        if (this.mReferenceArea) {\r\n            this.showRefernceArea();\r\n        }\r\n    };\r\n    FramesDisplay.prototype.onAnimationRepeatHander = function () {\r\n        var queue = this.mActionName.playingQueue;\r\n        if (queue.playedTimes === undefined) {\r\n            queue.playedTimes = 1;\r\n        }\r\n        else {\r\n            queue.playedTimes++;\r\n        }\r\n        if (queue.playedTimes >= queue.playTimes) {\r\n            if (this.mMainSprite) {\r\n                this.mMainSprite.off(Phaser.Animations.Events.ANIMATION_REPEAT, this.onAnimationRepeatHander, this);\r\n            }\r\n            // this.emit("animationComplete");\r\n            if (queue.complete) {\r\n                queue.complete.call(this);\r\n                delete queue.complete;\r\n            }\r\n        }\r\n    };\r\n    FramesDisplay.prototype.onAnimationUpdateHandler = function (ani, frame) {\r\n        if (!this.mMountContainer || !this.mCurAnimation)\r\n            return;\r\n        var frameVisible = this.mCurAnimation.mountLayer.frameVisible;\r\n        if (!frameVisible) {\r\n            return;\r\n        }\r\n        var index = frame.index - 1;\r\n        if (index > frameVisible.length) {\r\n            return;\r\n        }\r\n        for (var i = 0; i < this.mMountList.length; i++) {\r\n            this.mMountList[i].visible = this.getMaskValue(frameVisible[index], i);\r\n        }\r\n    };\r\n    FramesDisplay.prototype.getMaskValue = function (mask, idx) {\r\n        return ((mask >> idx) % 2) === 1;\r\n    };\r\n    Object.defineProperty(FramesDisplay.prototype, "spriteWidth", {\r\n        get: function () {\r\n            var width = 0;\r\n            if (this.mDisplays) {\r\n                for (var _i = 0, _a = this.mDisplays; _i < _a.length; _i++) {\r\n                    var display = _a[_i];\r\n                    if (display.width > width)\r\n                        width = display.width;\r\n                }\r\n            }\r\n            return width;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FramesDisplay.prototype, "spriteHeight", {\r\n        get: function () {\r\n            var height = 0;\r\n            if (this.mDisplays) {\r\n                for (var _i = 0, _a = this.mDisplays; _i < _a.length; _i++) {\r\n                    var display = _a[_i];\r\n                    if (display.height > height)\r\n                        height = display.height;\r\n                }\r\n            }\r\n            return height;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return FramesDisplay;\r\n}(_display_object__WEBPACK_IMPORTED_MODULE_1__["DisplayObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/frames.display.ts?')},"./src/rooms/display/frames.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramesModel", function() { return FramesModel; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var simple_sha1__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! simple-sha1 */ "./node_modules/simple-sha1/browser.js");\n/* harmony import */ var simple_sha1__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(simple_sha1__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/helpers */ "./src/utils/helpers.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n\r\n\r\n\r\n\r\n\r\n\r\nvar FramesModel = /** @class */ (function () {\r\n    function FramesModel(data) {\r\n        this.discriminator = "FramesModel";\r\n        // TODO 定义IElement接口\r\n        this.id = data.id || 0;\r\n        this.type = data.sn || "";\r\n        var anis = data.animations;\r\n        if (anis) {\r\n            this.animationName = anis.defaultAnimationName;\r\n            this.setDisplay(anis.display);\r\n            this.setAnimationData(anis.animationData);\r\n        }\r\n    }\r\n    FramesModel.prototype.setInfo = function (val) {\r\n        for (var key in val) {\r\n            if (val.hasOwnProperty(key)) {\r\n                this[key] = val[key];\r\n            }\r\n        }\r\n    };\r\n    FramesModel.prototype.getAnimationData = function () {\r\n        return this.animations;\r\n    };\r\n    FramesModel.prototype.existAnimation = function (aniName) {\r\n        if (!this.animations)\r\n            return false;\r\n        return this.animations.has(aniName);\r\n    };\r\n    FramesModel.prototype.getAnimations = function (name) {\r\n        if (!this.animations)\r\n            return;\r\n        return this.animations.get(name);\r\n    };\r\n    FramesModel.prototype.destroy = function () {\r\n        if (this.animations)\r\n            this.animations.clear();\r\n    };\r\n    Object.defineProperty(FramesModel.prototype, "gene", {\r\n        get: function () {\r\n            return this.mGen;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    FramesModel.prototype.createProtocolObject = function () {\r\n        var anis = [];\r\n        this.animations.forEach(function (ani) {\r\n            anis.push(ani.createProtocolObject());\r\n        }, this);\r\n        return anis;\r\n    };\r\n    FramesModel.prototype.getCollisionArea = function (aniName, flip) {\r\n        if (flip === void 0) { flip = false; }\r\n        var ani = this.getAnimations(aniName);\r\n        if (ani) {\r\n            if (flip) {\r\n                return _utils_helpers__WEBPACK_IMPORTED_MODULE_3__["default"].flipArray(ani.collisionArea);\r\n            }\r\n            return ani.collisionArea;\r\n        }\r\n    };\r\n    FramesModel.prototype.getWalkableArea = function (aniName, flip) {\r\n        if (flip === void 0) { flip = false; }\r\n        var ani = this.getAnimations(aniName);\r\n        if (flip) {\r\n            return _utils_helpers__WEBPACK_IMPORTED_MODULE_3__["default"].flipArray(ani.walkableArea);\r\n        }\r\n        return ani.walkableArea;\r\n    };\r\n    FramesModel.prototype.getInteractiveArea = function (aniName) {\r\n        var ani = this.getAnimations(aniName);\r\n        return ani ? ani.interactiveArea : undefined;\r\n    };\r\n    FramesModel.prototype.getOriginPoint = function (aniName, flip) {\r\n        if (flip === void 0) { flip = false; }\r\n        var ani = this.getAnimations(aniName);\r\n        if (ani) {\r\n            var originPoint = ani.originPoint;\r\n            if (flip) {\r\n                return new Phaser.Geom.Point(originPoint.y, originPoint.x);\r\n            }\r\n            return originPoint;\r\n        }\r\n    };\r\n    FramesModel.prototype.getDirable = function () { };\r\n    FramesModel.prototype.createSprite = function (properties) {\r\n        var nodeType = properties.nodeType, x = properties.x, y = properties.y, z = properties.z, id = properties.id, dir = properties.dir, isMoss = properties.isMoss;\r\n        var spr = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_client"].Sprite.create();\r\n        if (id) {\r\n            spr.id = id;\r\n        }\r\n        else {\r\n            spr.id = _utils_helpers__WEBPACK_IMPORTED_MODULE_3__["default"].genId();\r\n        }\r\n        spr.display = this.display;\r\n        spr.currentAnimationName = this.animationName;\r\n        var point3f = pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_def"].PBPoint3f.create();\r\n        point3f.x = x;\r\n        point3f.y = y;\r\n        if (z) {\r\n            point3f.z = z;\r\n        }\r\n        spr.point3f = point3f;\r\n        spr.animations = this.createProtocolObject();\r\n        if (dir) {\r\n            spr.direction = dir;\r\n        }\r\n        if (isMoss !== undefined) {\r\n            spr.isMoss = isMoss;\r\n        }\r\n        return new _element_sprite__WEBPACK_IMPORTED_MODULE_4__["Sprite"](spr, nodeType);\r\n    };\r\n    FramesModel.prototype.findAnimation = function (baseName, dir) {\r\n        var animationName = this.checkDirectionAnimation(baseName, dir);\r\n        var flip = false;\r\n        if (animationName) {\r\n            return { name: animationName, flip: flip };\r\n        }\r\n        switch (dir) {\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].west_south:\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].east_north:\r\n                animationName = this.getDefaultAnimation(baseName);\r\n                break;\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].south_east:\r\n                animationName = this.getDefaultAnimation(baseName);\r\n                flip = true;\r\n                break;\r\n            case _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].north_west:\r\n                animationName = this.checkDirectionAnimation(baseName, _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].east_north);\r\n                if (animationName === null) {\r\n                    animationName = this.getDefaultAnimation(baseName);\r\n                }\r\n                flip = true;\r\n                break;\r\n        }\r\n        return { name: animationName, flip: flip };\r\n    };\r\n    FramesModel.prototype.setDisplay = function (display) {\r\n        if (!display) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error(this.type + " display does not exist");\r\n            return;\r\n        }\r\n        this.display = {\r\n            dataPath: display.dataPath,\r\n            texturePath: display.texturePath,\r\n        };\r\n        this.mGen = simple_sha1__WEBPACK_IMPORTED_MODULE_2__["sync"](display.dataPath + display.texturePath);\r\n    };\r\n    FramesModel.prototype.setAnimationData = function (aniDatas) {\r\n        if (!aniDatas) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error(this.id + " animationData does not exist");\r\n            return;\r\n        }\r\n        this.animations = new Map();\r\n        // let ani: IAnimationData;\r\n        for (var _i = 0, aniDatas_1 = aniDatas; _i < aniDatas_1.length; _i++) {\r\n            var aniData = aniDatas_1[_i];\r\n            // const baseLoc = aniData.baseLoc;\r\n            // ani = {\r\n            //     name: aniData.name,\r\n            //     frameName: aniData.frameName,\r\n            //     frameRate: aniData.frameRate,\r\n            //     loop: aniData.loop,\r\n            //     baseLoc: new Phaser.Geom.Point(baseLoc.x, baseLoc.y),\r\n            //     // walkableArea: aniData.walkableArea || [],\r\n            //     collisionArea: aniData.collisionArea || [],\r\n            //     originPoint: aniData.originPoint\r\n            // };\r\n            this.animations.set(aniData.name, aniData);\r\n            // this.animations.set(aniData.name + "_7", aniData);\r\n            // this.animations.set(aniData.name + "_1", aniData);\r\n            // this.animations.set(aniData.name + "_5", aniData);\r\n        }\r\n    };\r\n    FramesModel.prototype.checkDirectionAnimation = function (baseAniName, dir) {\r\n        var aniName = baseAniName + "_" + dir;\r\n        if (this.existAnimation(aniName)) {\r\n            return aniName;\r\n        }\r\n        return null;\r\n    };\r\n    FramesModel.prototype.getDefaultAnimation = function (baseName) {\r\n        var animationName = this.checkDirectionAnimation(baseName, _element_element__WEBPACK_IMPORTED_MODULE_5__["Direction"].west_south);\r\n        if (animationName === null) {\r\n            if (this.existAnimation(baseName)) {\r\n                animationName = baseName;\r\n            }\r\n            else {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().warn(FramesModel.name + ": can\'t find animation " + baseName);\r\n                animationName = "idle";\r\n            }\r\n        }\r\n        return animationName;\r\n    };\r\n    return FramesModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/frames.model.ts?')},"./src/rooms/display/terrain.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainDisplay", function() { return TerrainDisplay; });\n/* harmony import */ var _frames_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./frames.display */ "./src/rooms/display/frames.display.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar TerrainDisplay = /** @class */ (function (_super) {\r\n    __extends(TerrainDisplay, _super);\r\n    function TerrainDisplay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    // public fadeIn(callback?: () => void) {\r\n    //     // this.y += 50;\r\n    //     this.alpha = 0;\r\n    //     if (this.mFadeTween) {\r\n    //         this.mFadeTween.stop();\r\n    //         this.mFadeTween.remove();\r\n    //     }\r\n    //     this.mFadeTween = this.scene.tweens.add({\r\n    //         targets: this,\r\n    //         alpha: 1,\r\n    //         // y: this.y + 50,\r\n    //         duration: 1200,\r\n    //         onComplete: () => {\r\n    //             if (callback) callback();\r\n    //         }\r\n    //     });\r\n    // }\r\n    //\r\n    // public fadeOut(callback?: () => void) {\r\n    //     if (this.mFadeTween) {\r\n    //         this.mFadeTween.stop();\r\n    //         this.mFadeTween.remove();\r\n    //     }\r\n    //     this.mFadeTween = this.scene.tweens.add({\r\n    //         targets: this,\r\n    //         alpha: 0,\r\n    //         // y: this.y + 50,\r\n    //         duration: 1200,\r\n    //         onComplete: () => {\r\n    //             if (callback) callback();\r\n    //         }\r\n    //     });\r\n    // }\r\n    TerrainDisplay.prototype.showRefernceArea = function () {\r\n    };\r\n    return TerrainDisplay;\r\n}(_frames_display__WEBPACK_IMPORTED_MODULE_0__["FramesDisplay"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/terrain.display.ts?')},"./src/rooms/display/wall.display.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WallDisplay", function() { return WallDisplay; });\n/* harmony import */ var _wall_wall__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../wall/wall */ "./src/rooms/wall/wall.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar WallDisplay = /** @class */ (function (_super) {\r\n    __extends(WallDisplay, _super);\r\n    function WallDisplay(scene, roomService) {\r\n        var _this = _super.call(this, scene, 0, 0, undefined) || this;\r\n        _this.roomService = roomService;\r\n        return _this;\r\n    }\r\n    WallDisplay.prototype.loadDisplay = function (texture, data) {\r\n        // const key = texture + data;\r\n        var key = "wall";\r\n        if (this.scene.textures.exists(key)) {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n        else {\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.scene.load.atlas(key, texture, data);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    WallDisplay.prototype.setDir = function (dir) {\r\n        if (!this.mImage) {\r\n            return;\r\n        }\r\n        this.mImage.setTexture("wall", "wall_" + dir + ".png");\r\n        if (dir === _wall_wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].LEFT) {\r\n            this.mImage.x = -this.mImage.width / 2;\r\n        }\r\n        else if (dir === _wall_wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].RIGHT) {\r\n            this.mImage.x = this.mImage.width / 2;\r\n        }\r\n        this.mImage.y = -this.mImage.height / 2 + 30;\r\n    };\r\n    WallDisplay.prototype.load = function (data) {\r\n    };\r\n    WallDisplay.prototype.changeAlpha = function (val) {\r\n    };\r\n    WallDisplay.prototype.play = function (animationName) { };\r\n    WallDisplay.prototype.removeFromParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    WallDisplay.prototype.fadeIn = function (callback) { };\r\n    WallDisplay.prototype.fadeOut = function (callback) { };\r\n    WallDisplay.prototype.showNickname = function (val) { };\r\n    WallDisplay.prototype.setDisplayBadges = function (cards) { };\r\n    WallDisplay.prototype.showRefernceArea = function () { };\r\n    WallDisplay.prototype.hideRefernceArea = function () { };\r\n    WallDisplay.prototype.showEffect = function () { };\r\n    WallDisplay.prototype.onLoadCompleteHandler = function () {\r\n        this.mImage = this.scene.make.image({\r\n            key: "wall",\r\n            frame: "wall_up.png"\r\n        }, false);\r\n        this.add(this.mImage);\r\n        this.mImage.y = -this.mImage.height / 2 + 10;\r\n        this.emit("initialized", this);\r\n    };\r\n    Object.defineProperty(WallDisplay.prototype, "sortX", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WallDisplay.prototype, "sortY", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WallDisplay.prototype, "sortZ", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WallDisplay.prototype, "baseLoc", {\r\n        get: function () {\r\n            return;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(WallDisplay.prototype, "element", {\r\n        get: function () {\r\n            return;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return WallDisplay;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/display/wall.display.ts?')},"./src/rooms/editor.room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorRoom", function() { return EditorRoom; });\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _const_brush__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../const/brush */ "./src/const/brush.ts");\n/* harmony import */ var _room__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./room */ "./src/rooms/room.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _scenes_edit__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../scenes/edit */ "./src/scenes/edit.ts");\n/* harmony import */ var _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./editor/mouse.follow */ "./src/rooms/editor/mouse.follow.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _editor_selected_element__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./editor/selected.element */ "./src/rooms/editor/selected.element.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _element_editor_element_manager__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./element/editor.element.manager */ "./src/rooms/element/editor.element.manager.ts");\n/* harmony import */ var _terrain_editor_terrain_manager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./terrain/editor.terrain.manager */ "./src/rooms/terrain/editor.terrain.manager.ts");\n/* harmony import */ var _cameras_editor_cameras_manager__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./cameras/editor.cameras.manager */ "./src/rooms/cameras/editor.cameras.manager.ts");\n/* harmony import */ var _element_editor_moss_manager__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./element/editor.moss.manager */ "./src/rooms/element/editor.moss.manager.ts");\n/* harmony import */ var _display_object_pool__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./display-object.pool */ "./src/rooms/display-object.pool.ts");\n/* harmony import */ var _sky_box_editor_sky_box_manager__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./sky.box/editor.sky.box.manager */ "./src/rooms/sky.box/editor.sky.box.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditorRoom = /** @class */ (function (_super) {\r\n    __extends(EditorRoom, _super);\r\n    function EditorRoom(manager) {\r\n        var _this = _super.call(this, manager) || this;\r\n        _this.mBrush = new _const_brush__WEBPACK_IMPORTED_MODULE_4__["Brush"](_this);\r\n        _this.mPointerDelta = null;\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SET_EDITOR_MODE, _this.onSetEditorModeHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_ALIGN_GRID, _this.onAlignGridHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_VISIBLE_GRID, _this.onVisibleGridHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_FOLLOW, _this.onMouseFollowHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_MOUSE_SELECTED_SPRITE, _this.onMouseFollowHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_FETCH_SPRITE, _this.onFetchSpriteHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_FETCH_SCENERY, _this.onFetchSceneryHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorRoom.prototype.enter = function (data) {\r\n        if (!data) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("wrong room");\r\n            return;\r\n        }\r\n        this.mID = data.id;\r\n        var rows = data.rows, cols = data.cols, tileWidth = data.tileWidth, tileHeight = data.tileHeight;\r\n        this.mSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        rows *= 2;\r\n        cols *= 2;\r\n        tileWidth /= 2;\r\n        tileHeight /= 2;\r\n        this.mNimiSize = {\r\n            cols: cols,\r\n            rows: rows,\r\n            tileHeight: tileHeight,\r\n            tileWidth: tileWidth,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2),\r\n        };\r\n        this.editorTerrainManager = new _terrain_editor_terrain_manager__WEBPACK_IMPORTED_MODULE_14__["EditorTerrainManager"](this);\r\n        this.editorElementManager = new _element_editor_element_manager__WEBPACK_IMPORTED_MODULE_13__["EditorElementManager"](this);\r\n        this.editorMossManager = new _element_editor_moss_manager__WEBPACK_IMPORTED_MODULE_16__["EditorMossManager"](this);\r\n        this.editorSkyboxManager = new _sky_box_editor_sky_box_manager__WEBPACK_IMPORTED_MODULE_18__["EditorSkyBoxManager"](this);\r\n        this.mCameraService = new _cameras_editor_cameras_manager__WEBPACK_IMPORTED_MODULE_15__["EditorCamerasManager"](this);\r\n        this.displayObjectPool = new _display_object_pool__WEBPACK_IMPORTED_MODULE_17__["DisplayObjectPool"]();\r\n        // this.mWorld.game.scene.start(EditScene.name, { room: this });\r\n        this.mWorld.game.scene.add(_scenes_edit__WEBPACK_IMPORTED_MODULE_7__["EditScene"].name, _scenes_edit__WEBPACK_IMPORTED_MODULE_7__["EditScene"], true, { room: this });\r\n    };\r\n    EditorRoom.prototype.startPlay = function () {\r\n        this.mScene = this.mWorld.game.scene.getScene(_scenes_edit__WEBPACK_IMPORTED_MODULE_7__["EditScene"].name);\r\n        this.mLayManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_6__["LayerManager"](this);\r\n        this.mLayManager.drawGrid(this);\r\n        var camera = this.scene.cameras.main;\r\n        this.mCameraService.camera = camera;\r\n        var zoom = this.world.scaleRatio;\r\n        // mainCameras.setBounds(-200, -200, this.mSize.sceneWidth + 400, this.mSize.sceneHeight + 400);\r\n        this.mCameraService.setBounds(-camera.width >> 1, -camera.height >> 1, this.mSize.sceneWidth * zoom + camera.width, this.mSize.sceneHeight * zoom + camera.height);\r\n        this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        this.mCameraService.centerCameas();\r\n        this.mScene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.mScene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.mScene.input.on("gameobjectdown", this.onGameobjectDownHandler, this);\r\n        this.mScene.input.on("gameout", this.onGameOutHandler, this);\r\n        this.mScene.input.keyboard.on("keydown", this.onKeyDownHandler, this);\r\n        // this.addSkyBox();\r\n    };\r\n    EditorRoom.prototype.destroy = function () {\r\n        if (this.mWorld && this.mWorld.connection) {\r\n            this.mWorld.connection.removePacketListener(this);\r\n        }\r\n        if (this.editorTerrainManager) {\r\n            this.editorTerrainManager.destroy();\r\n        }\r\n        if (this.editorMossManager) {\r\n            this.editorMossManager.destroy();\r\n        }\r\n        if (this.editorElementManager) {\r\n            this.editorElementManager.destroy();\r\n        }\r\n        if (this.displayObjectPool) {\r\n            this.displayObjectPool.destroy();\r\n        }\r\n        if (this.editorSkyboxManager) {\r\n            this.editorSkyboxManager.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    EditorRoom.prototype.update = function (time, delta) {\r\n        if (this.layerManager)\r\n            this.layerManager.update(time, delta);\r\n        if (this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect.update();\r\n        }\r\n        if (this.editorTerrainManager) {\r\n            this.editorTerrainManager.update();\r\n        }\r\n        if (this.editorMossManager) {\r\n            this.editorMossManager.update();\r\n        }\r\n        if (this.editorElementManager) {\r\n            this.editorElementManager.update();\r\n        }\r\n    };\r\n    EditorRoom.prototype.transformToMini90 = function (p) {\r\n        if (!this.mNimiSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_0__["Position45"].transformTo90(p, this.mNimiSize);\r\n    };\r\n    EditorRoom.prototype.transformToMini45 = function (p) {\r\n        if (!this.mNimiSize) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_0__["Position45"].transformTo45(p, this.mNimiSize);\r\n    };\r\n    EditorRoom.prototype.removeSelected = function () {\r\n        if (this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect.remove();\r\n            this.mPointerDelta = null;\r\n        }\r\n    };\r\n    EditorRoom.prototype.addPointerMoveHandler = function () {\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n    };\r\n    EditorRoom.prototype.removePointerMoveHandler = function () {\r\n        this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n    };\r\n    EditorRoom.prototype.addPointerDownHandler = function () {\r\n        this.mScene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.removePointerDownHandler = function () {\r\n        this.mScene.input.off("pointerdown", this.onPointerDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.addPointerUpHandler = function () {\r\n        this.mScene.input.on("pointerup", this.onPointerUpHandler, this);\r\n    };\r\n    EditorRoom.prototype.removePointerUpHandler = function () {\r\n        this.mScene.input.off("pointerup", this.onPointerUpHandler, this);\r\n    };\r\n    EditorRoom.prototype.addGameObjectDownHandler = function () {\r\n        this.mScene.input.on("gameobjectdown", this.onGameobjectDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.removeGameObjectDownHandler = function () {\r\n        this.mScene.input.off("gameobjectdown", this.onGameobjectDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.addKeydownHandler = function () {\r\n        this.mScene.input.keyboard.on("keydown", this.onKeyDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.removeKeydownHandler = function () {\r\n        this.mScene.input.keyboard.off("keydown", this.onKeyDownHandler, this);\r\n    };\r\n    EditorRoom.prototype.onPointerDownHandler = function () {\r\n        var nodeType = this.mouseFollow.nodeType;\r\n        if (this.mouseFollow.key) {\r\n            if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n                if (!this.world.elementStorage.getTerrainPalette(this.mouseFollow.key)) {\r\n                    this.reqEditorSyncPaletteOrMoss(this.mouseFollow.key, this.mouseFollow.nodeType);\r\n                }\r\n            }\r\n            else if (nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType) {\r\n                if (!this.world.elementStorage.getMossPalette(this.mouseFollow.key)) {\r\n                    this.reqEditorSyncPaletteOrMoss(this.mouseFollow.key, this.mouseFollow.nodeType);\r\n                }\r\n            }\r\n        }\r\n        this.addPointerMoveHandler();\r\n    };\r\n    EditorRoom.prototype.onPointerUpHandler = function (pointer) {\r\n        this.removePointerMoveHandler();\r\n        switch (this.brush.mode) {\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].BRUSH:\r\n                this.createElements();\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT:\r\n                if (this.mSelectedElementEffect && this.mSelectedElementEffect.selecting) {\r\n                    if (pointer.downX !== pointer.upX && pointer.downY !== pointer.upY) {\r\n                        if (this.mSelectedElementEffect.sprite.isMoss) {\r\n                            this.editorMossManager.updateMosses([this.mSelectedElementEffect]);\r\n                        }\r\n                        else {\r\n                            var sprite = this.mSelectedElementEffect\r\n                                .display.element.model.toSprite();\r\n                            this.editorElementManager.updateElements([sprite]);\r\n                        }\r\n                    }\r\n                    this.mSelectedElementEffect.selecting = false;\r\n                    this.mPointerDelta = null;\r\n                }\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER:\r\n                this.eraserTerrains();\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].MOVE:\r\n                this.mCameraService.syncCameraScroll();\r\n                break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (!this.mScene.cameras) {\r\n            return;\r\n        }\r\n        switch (this.mBrush.mode) {\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].BRUSH:\r\n                if (this.mMouseFollow.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n                    this.createElements();\r\n                }\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].MOVE:\r\n                this.moveCameras(pointer);\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT:\r\n                if (this.editorSkyboxManager) {\r\n                    this.editorSkyboxManager.move(pointer);\r\n                }\r\n                this.moveElement(pointer);\r\n                break;\r\n            case _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER:\r\n                this.eraserTerrains();\r\n                break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.moveCameras = function (pointer) {\r\n        this.cameraService.offsetScroll(pointer.prevPosition.x - pointer.position.x, pointer.prevPosition.y - pointer.position.y);\r\n    };\r\n    EditorRoom.prototype.reqEditorSyncPaletteOrMoss = function (key, nodeType) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_PALETTE_MOSS);\r\n        var content = pkt.content;\r\n        content.key = key;\r\n        content.type = nodeType;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorRoom.prototype.createElements = function () {\r\n        if (!this.mMouseFollow.sprite) {\r\n            return;\r\n        }\r\n        if (this.mMouseFollow.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            var terrainCoorData = this.mMouseFollow.createTerrainsOrMossesData();\r\n            if (this.editorTerrainManager) {\r\n                this.editorTerrainManager.addTerrains(terrainCoorData);\r\n            }\r\n        }\r\n        else if (this.mMouseFollow.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType) {\r\n            var sprites = this.mMouseFollow.createSprites();\r\n            if (!sprites) {\r\n                return;\r\n            }\r\n            if (!this.editorElementManager) {\r\n                return;\r\n            }\r\n            if (this.mMouseFollow.isMoss) {\r\n                var mossesCoorData = this.mMouseFollow.createTerrainsOrMossesData();\r\n                this.editorMossManager.addMosses(mossesCoorData);\r\n            }\r\n            else {\r\n                this.editorElementManager.addElements(sprites);\r\n            }\r\n        }\r\n        else if (this.mMouseFollow.nodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.SpawnPointType) {\r\n            var sprites = this.mMouseFollow.createSprites();\r\n            this.editorElementManager.addElements(sprites);\r\n        }\r\n    };\r\n    EditorRoom.prototype.eraserTerrains = function () {\r\n        var positions = this.mMouseFollow.getEaserPosition();\r\n        this.editorTerrainManager.removeTerrains(positions);\r\n    };\r\n    EditorRoom.prototype.onSetEditorModeHandler = function (packet) {\r\n        var mode = packet.content;\r\n        this.mBrush.mode = mode.mode;\r\n        if (this.mMouseFollow)\r\n            this.mMouseFollow.destroy();\r\n        if (this.mBrush.mode !== _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT) {\r\n            if (this.mSelectedElementEffect) {\r\n                this.mSelectedElementEffect.destroy();\r\n                this.mSelectedElementEffect = null;\r\n                this.mPointerDelta = null;\r\n            }\r\n        }\r\n        if (this.mBrush.mode === _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].SELECT) {\r\n            this.removeGameObjectDownHandler();\r\n            this.addGameObjectDownHandler();\r\n        }\r\n        else {\r\n            this.removeGameObjectDownHandler();\r\n        }\r\n        if (this.mBrush.mode === _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER) {\r\n            if (!this.mMouseFollow) {\r\n                this.mMouseFollow = new _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_8__["MouseFollow"](this.mScene, this);\r\n            }\r\n            this.mMouseFollow.showEraserArea();\r\n        }\r\n        if (this.editorSkyboxManager) {\r\n            this.editorSkyboxManager.removeSelect();\r\n        }\r\n        this.layerManager.setSurfaceInteractive(this.mBrush.mode !== _const_brush__WEBPACK_IMPORTED_MODULE_4__["BrushEnum"].ERASER);\r\n    };\r\n    EditorRoom.prototype.onAlignGridHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.mouseFollow.alignGrid = content.align;\r\n    };\r\n    EditorRoom.prototype.onVisibleGridHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.layerManager.setGridVisible(content.visible);\r\n    };\r\n    EditorRoom.prototype.onMouseFollowHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (this.mScene) {\r\n            this.mouseFollow.setDisplay(content);\r\n        }\r\n    };\r\n    EditorRoom.prototype.onFetchSpriteHandler = function (packet) {\r\n        var _a;\r\n        var content = packet.content;\r\n        var ids = content.ids, nodeType = content.nodeType;\r\n        var map = (_a = {},\r\n            _a[pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.SpawnPointType] = "elements",\r\n            _a[pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType] = "elements",\r\n            _a[pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.MossCollectionType] = "mosses",\r\n            _a);\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            var poolName = map[nodeType];\r\n            var pool = this.displayObjectPool.getPool(poolName);\r\n            var displayObj = pool.get(id.toString());\r\n            if (displayObj) {\r\n                this.selectedElement(displayObj.getDisplay());\r\n            }\r\n        }\r\n    };\r\n    EditorRoom.prototype.sendFetch = function (ids, nodetype, isMoss) {\r\n        if (!this.mSelectedElementEffect || !this.mSelectedElementEffect.display) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_FETCH_SPRITE);\r\n        var content = pkt.content;\r\n        content.ids = ids;\r\n        content.isMoss = isMoss;\r\n        content.nodeType = nodetype;\r\n        this.connection.send(pkt);\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("fetch sprite", content);\r\n    };\r\n    EditorRoom.prototype.onFetchSceneryHandler = function (packet) {\r\n        if (this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect.destroy();\r\n            this.mSelectedElementEffect = null;\r\n            this.mPointerDelta = null;\r\n        }\r\n        if (!this.editorSkyboxManager) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        this.editorSkyboxManager.fetch(content.id);\r\n    };\r\n    EditorRoom.prototype.onGameobjectDownHandler = function (pointer, gameobject) {\r\n        var com = gameobject.parentContainer.parentContainer || gameobject.parentContainer;\r\n        if (!com) {\r\n            return;\r\n        }\r\n        var selected = this.selectedElement(com);\r\n        if (selected) {\r\n            this.sendFetch([selected.element.id], pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType, selected.element.model.isMoss);\r\n        }\r\n    };\r\n    EditorRoom.prototype.selectedElement = function (com) {\r\n        if (!(com instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_11__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        if (com instanceof _display_terrain_display__WEBPACK_IMPORTED_MODULE_9__["TerrainDisplay"]) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedElementEffect) {\r\n            this.mSelectedElementEffect = new _editor_selected_element__WEBPACK_IMPORTED_MODULE_10__["SelectedElement"](this.mScene, this.layerManager);\r\n        }\r\n        this.mSelectedElementEffect.setElement(com);\r\n        if (this.editorSkyboxManager) {\r\n            this.editorSkyboxManager.removeSelect();\r\n        }\r\n        return com;\r\n    };\r\n    EditorRoom.prototype.onKeyDownHandler = function (event) {\r\n        if (this.editorSkyboxManager) {\r\n            this.editorSkyboxManager.keyboardMove(event.keyCode);\r\n        }\r\n        if (!this.mSelectedElementEffect) {\r\n            return;\r\n        }\r\n        switch (event.keyCode) {\r\n            case 37:\r\n            case 38:\r\n            case 39:\r\n            case 40:\r\n            case 65:\r\n            case 87:\r\n            case 83:\r\n            case 68:\r\n                this.keyboardMoveElement(event.keyCode);\r\n                break;\r\n            // case 8:\r\n            // case 46:\r\n            //     this.removeDisplay(this.mSelectedElementEffect);\r\n            //     break;\r\n        }\r\n    };\r\n    EditorRoom.prototype.keyboardMoveElement = function (keyCode) {\r\n        var display = this.mSelectedElementEffect.display;\r\n        if (!display) {\r\n            return;\r\n        }\r\n        var pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_12__["Pos"](display.x, display.y, display.z);\r\n        switch (keyCode) {\r\n            case 37:\r\n                pos.x--;\r\n                break;\r\n            case 38:\r\n                pos.y--;\r\n                break;\r\n            case 39:\r\n                pos.x++;\r\n                break;\r\n            case 40:\r\n                pos.y++;\r\n                break;\r\n        }\r\n        display.setPosition(pos.x, pos.y, pos.z);\r\n        // TOOD 通过统一接口设置depth\r\n        this.layerManager.depthSurfaceDirty = true;\r\n    };\r\n    EditorRoom.prototype.moveElement = function (pointer) {\r\n        if (!this.mSelectedElementEffect) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedElementEffect.selecting) {\r\n            return;\r\n        }\r\n        if (!this.mouseFollow) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedElementEffect.display) {\r\n            return;\r\n        }\r\n        if (!this.mPointerDelta) {\r\n            var matrix = new Phaser.GameObjects.Components.TransformMatrix();\r\n            var parentMatrix = new Phaser.GameObjects.Components.TransformMatrix();\r\n            this.mSelectedElementEffect.display.getWorldTransformMatrix(matrix, parentMatrix);\r\n            this.mPointerDelta = new _utils_pos__WEBPACK_IMPORTED_MODULE_12__["Pos"](matrix.tx - pointer.worldX, matrix.ty - pointer.worldY);\r\n        }\r\n        var elementWorldPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_12__["Pos"](this.mPointerDelta.x + pointer.worldX, this.mPointerDelta.y + pointer.worldY);\r\n        var gridPos = this.mMouseFollow.transitionGrid(elementWorldPos.x / this.mScaleRatio, elementWorldPos.y / this.mScaleRatio);\r\n        if (gridPos) {\r\n            if (gridPos.x !== this.mSelectedElementEffect.display.x || gridPos.y !== this.mSelectedElementEffect.display.y) {\r\n                this.mSelectedElementEffect.setDisplayPos(gridPos.x, gridPos.y);\r\n                this.mLayManager.depthSurfaceDirty = true;\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(EditorRoom.prototype, "brush", {\r\n        get: function () {\r\n            return this.mBrush;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EditorRoom.prototype, "miniSize", {\r\n        get: function () {\r\n            return this.mNimiSize;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EditorRoom.prototype, "mouseFollow", {\r\n        get: function () {\r\n            if (!this.mMouseFollow) {\r\n                this.mMouseFollow = new _editor_mouse_follow__WEBPACK_IMPORTED_MODULE_8__["MouseFollow"](this.mScene, this);\r\n            }\r\n            return this.mMouseFollow;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    EditorRoom.prototype.removeDisplay = function (element) {\r\n        if (element.sprite.isMoss) {\r\n            this.editorMossManager.deleteMosses([element.sprite.id]);\r\n        }\r\n        else {\r\n            this.editorElementManager.deleteElements([element.sprite.id]);\r\n        }\r\n        this.removeSelected();\r\n    };\r\n    return EditorRoom;\r\n}(_room__WEBPACK_IMPORTED_MODULE_5__["Room"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor.room.ts?')},"./src/rooms/editor/mouse.follow.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MouseFollow", function() { return MouseFollow; });\n/* harmony import */ var _display_frames_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\n\r\n\r\n\r\nvar MouseFollow = /** @class */ (function () {\r\n    function MouseFollow(mScene, mRoomService) {\r\n        this.mScene = mScene;\r\n        this.mRoomService = mRoomService;\r\n        this.mScaleRatio = 1;\r\n        /**\r\n         * 笔触大小\r\n         */\r\n        this.mSize = 1;\r\n        this.mLayerManager = this.mRoomService.layerManager;\r\n        this.mScaleRatio = this.mRoomService.world.scaleRatio;\r\n    }\r\n    MouseFollow.prototype.setDisplay = function (content) {\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        this.mNodeType = content.nodeType;\r\n        this.isMoss = content.isMoss;\r\n        this.key = content.key;\r\n        this.mSprite = new _element_sprite__WEBPACK_IMPORTED_MODULE_2__["Sprite"](content.sprite, content.nodeType);\r\n        this.mDisplay = new MouseDisplayContainer(this.mScene, this.mRoomService);\r\n        var size = this.mNodeType === NodeType.TerrainNodeType ? this.mSize : 1;\r\n        this.mDisplay.setDisplay(this.mSprite, size);\r\n        this.mDisplay.scale = this.mScaleRatio;\r\n        this.mLayerManager.addToSceneToUI(this.mDisplay);\r\n        if (this.mNodeType === NodeType.TerrainNodeType) {\r\n            this.mElementManager = this.mRoomService.terrainManager;\r\n        }\r\n        else if (this.mNodeType === NodeType.ElementNodeType || this.mNodeType === NodeType.SpawnPointType) {\r\n            this.mElementManager = this.mRoomService.elementManager;\r\n        }\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("wheel", this.onWheelHandler, this);\r\n    };\r\n    MouseFollow.prototype.showEraserArea = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n        }\r\n        this.mDisplay = new EraserArea(this.mScene, this.mRoomService);\r\n        this.mDisplay.setDisplay(null, this.mSize);\r\n        this.mNodeType = NodeType.TerrainNodeType;\r\n        this.mLayerManager.addToSceneToUI(this.mDisplay);\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("wheel", this.onWheelHandler, this);\r\n    };\r\n    MouseFollow.prototype.createTerrainsOrMossesData = function () {\r\n        var _this = this;\r\n        var locs = this.mDisplay.displays.map(function (display) { return _this.getPosition(display.x, display.y); });\r\n        return { locs: locs, key: this.key };\r\n    };\r\n    MouseFollow.prototype.createSprites = function () {\r\n        if (!this.mSprite) {\r\n            return;\r\n        }\r\n        var result = [];\r\n        var sprite = null;\r\n        var displays = this.mDisplay.displays;\r\n        for (var _i = 0, displays_1 = displays; _i < displays_1.length; _i++) {\r\n            var display = displays_1[_i];\r\n            // deep clone\r\n            sprite = Object.assign(Object.create(Object.getPrototypeOf(this.mSprite)), this.mSprite);\r\n            sprite.newID();\r\n            sprite.pos = this.getPosition(display.x, display.y);\r\n            sprite.bindID = this.mSprite.id;\r\n            sprite.sn = this.mSprite.sn;\r\n            // sprite.nodeType = this.mSprite.node\r\n            result.push(sprite);\r\n        }\r\n        return result;\r\n    };\r\n    MouseFollow.prototype.getEaserPosition = function () {\r\n        var result = [];\r\n        if (!this.display) {\r\n            return;\r\n        }\r\n        var pos = null;\r\n        for (var i = 0; i < this.mSize; i++) {\r\n            for (var j = 0; j < this.mSize; j++) {\r\n                pos = this.display.transformTo90(i, j);\r\n                result.push(this.getPosition(pos.x, pos.y));\r\n                // result.push(this.mRoomService.transformTo45(new Pos(i, j)));\r\n            }\r\n        }\r\n        // result.push(this.getPosition());\r\n        return result;\r\n    };\r\n    MouseFollow.prototype.transitionGrid = function (x, y) {\r\n        var source = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y);\r\n        var pos = this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType\r\n            ? this.mRoomService.transformTo45(source)\r\n            : this.mRoomService.transformToMini45(source);\r\n        if (this.mAlignGrid === false) {\r\n            return this.checkBound(pos, source);\r\n        }\r\n        return this.checkBound(pos);\r\n    };\r\n    /**\r\n     * 边界检查\r\n     * @param pos 45度坐标，\r\n     * @param source 没有超出边界并不贴边就返回原始坐标\r\n     */\r\n    MouseFollow.prototype.checkBound = function (pos, source) {\r\n        var bound = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](pos.x, pos.y);\r\n        var size = this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType\r\n            ? this.mRoomService.roomSize\r\n            : this.mRoomService.miniSize;\r\n        if (pos.x < 0) {\r\n            bound.x = 0;\r\n        }\r\n        else if (pos.x > size.cols) {\r\n            bound.x = size.cols;\r\n        }\r\n        if (pos.y < 0) {\r\n            bound.y = 0;\r\n        }\r\n        else if (pos.y > size.rows) {\r\n            bound.y = size.rows;\r\n        }\r\n        if (bound.equal(pos) && source) {\r\n            return source;\r\n        }\r\n        if (this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return this.mRoomService.transformTo90(bound);\r\n        }\r\n        return this.mRoomService.transformToMini90(bound);\r\n    };\r\n    MouseFollow.prototype.destroy = function () {\r\n        if (this.mScene) {\r\n            this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n            this.mScene.input.off("wheel", this.onWheelHandler, this);\r\n        }\r\n        if (this.mDisplay) {\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        this.mNodeType = NodeType.UnknownNodeType;\r\n    };\r\n    MouseFollow.prototype.onPointerMoveHandler = function (pointer) {\r\n        this.updatePos(pointer.worldX / this.mScaleRatio, pointer.worldY / this.mScaleRatio);\r\n    };\r\n    MouseFollow.prototype.getPosition = function (rows, cols) {\r\n        if (rows === void 0) { rows = 0; }\r\n        if (cols === void 0) { cols = 0; }\r\n        if (this.mNodeType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            var pos45 = this.mRoomService.transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x / this.mScaleRatio + rows, this.mDisplay.y / this.mScaleRatio + cols));\r\n            return pos45;\r\n        }\r\n        // TODO 多个物件仅支持地块\r\n        var pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](this.mDisplay.x / this.mScaleRatio + rows, this.mDisplay.y / this.mScaleRatio + cols, this.mDisplay.z);\r\n        return pos;\r\n    };\r\n    MouseFollow.prototype.onWheelHandler = function (pointer) {\r\n        if (this.mNodeType !== NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        if (pointer.deltaY < 0) {\r\n            this.size--;\r\n        }\r\n        else {\r\n            this.size++;\r\n        }\r\n        this.updatePos(pointer.worldX / this.mScaleRatio, pointer.worldY / this.mScaleRatio);\r\n    };\r\n    MouseFollow.prototype.updatePos = function (worldX, worldY) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var pos = this.transitionGrid(worldX, worldY);\r\n        if (!pos) {\r\n            return;\r\n        }\r\n        this.mDisplay.setLocation(pos.x * this.mScaleRatio, pos.y * this.mScaleRatio);\r\n    };\r\n    Object.defineProperty(MouseFollow.prototype, "alignGrid", {\r\n        set: function (val) {\r\n            this.mAlignGrid = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "sprite", {\r\n        get: function () {\r\n            return this.mSprite;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "nodeType", {\r\n        get: function () {\r\n            return this.mNodeType;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "size", {\r\n        get: function () {\r\n            return this.mSize;\r\n        },\r\n        set: function (val) {\r\n            if (val < 1) {\r\n                val = 1;\r\n            }\r\n            if (val > 20) {\r\n                val = 20;\r\n            }\r\n            this.mSize = val;\r\n            this.mDisplay.setDisplay(this.mSprite, this.mSize);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "isMoss", {\r\n        get: function () {\r\n            return this._isMoss;\r\n        },\r\n        set: function (val) {\r\n            this._isMoss = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseFollow.prototype, "key", {\r\n        get: function () {\r\n            return this._key;\r\n        },\r\n        set: function (val) {\r\n            this._key = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return MouseFollow;\r\n}());\r\n\r\nvar MouseDisplayContainer = /** @class */ (function (_super) {\r\n    __extends(MouseDisplayContainer, _super);\r\n    function MouseDisplayContainer(scene, mRoomService) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.mScaleRatio = 1;\r\n        _this.mScaleRatio = _this.mRoomService.world.scaleRatio;\r\n        _this.mOffset = new Phaser.Geom.Point();\r\n        return _this;\r\n    }\r\n    MouseDisplayContainer.prototype.setDisplay = function (sprite, size) {\r\n        this.clear();\r\n        this.mDisplay = [];\r\n        this.mSprite = sprite;\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        var frame = sprite.displayInfo;\r\n        this.mNodeType = sprite.nodeType;\r\n        var frameDisplay;\r\n        var _a = this.mRoomService.roomSize, tileWidth = _a.tileWidth, tileHeight = _a.tileHeight;\r\n        this.mTileSize = {\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            rows: size,\r\n            cols: size,\r\n            sceneWidth: (size + size) * (tileWidth / 2),\r\n            sceneHeight: (size + size) * (tileHeight / 2),\r\n        };\r\n        this.mOffset.x = -((this.mTileSize.sceneWidth / 2) * this.mScaleRatio);\r\n        this.mOffset.y = -((this.mTileSize.sceneHeight / this.mScaleRatio - (size % 2 === 0 ? 0 : tileHeight)) / 2);\r\n        for (var i = 0; i < size; i++) {\r\n            for (var j = 0; j < size; j++) {\r\n                frameDisplay = new _display_frames_display__WEBPACK_IMPORTED_MODULE_0__["FramesDisplay"](this.scene, this.mRoomService);\r\n                frameDisplay.setAlpha(0.8);\r\n                frameDisplay.once("initialized", this.onInitializedHandler, this);\r\n                frameDisplay.load(frame);\r\n                var pos = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](i, j), this.mTileSize);\r\n                frameDisplay.x = pos.x;\r\n                frameDisplay.y = pos.y;\r\n                this.add(frameDisplay);\r\n                this.mDisplay.push(frameDisplay);\r\n            }\r\n        }\r\n    };\r\n    MouseDisplayContainer.prototype.transformTo90 = function (row, col) {\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](row, col), this.mTileSize);\r\n    };\r\n    MouseDisplayContainer.prototype.transformTo45 = function (x, y) {\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y), this.mTileSize);\r\n    };\r\n    MouseDisplayContainer.prototype.setLocation = function (x, y) {\r\n        this.x = x + this.mOffset.x;\r\n        this.y = y + this.mOffset.y;\r\n        return this;\r\n    };\r\n    MouseDisplayContainer.prototype.clear = function () {\r\n        this.removeAll(true);\r\n        this.mDisplay = undefined;\r\n    };\r\n    MouseDisplayContainer.prototype.destroy = function (fromScene) {\r\n        this.clear();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "displays", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "tileWidth", {\r\n        get: function () {\r\n            var tmp = this.mTileSize.tileHeight;\r\n            if (this.mTileSize.rows % 2 === 0) {\r\n                tmp = 0;\r\n            }\r\n            return this.mTileSize.sceneWidth - tmp;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MouseDisplayContainer.prototype, "tileHeight", {\r\n        get: function () {\r\n            return this.mTileSize.sceneHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MouseDisplayContainer.prototype.onInitializedHandler = function (obj) {\r\n        if (obj) {\r\n            if (this.mSprite) {\r\n                obj.play(this.mSprite.currentAnimation);\r\n            }\r\n            if (this.mNodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n                obj.showRefernceArea();\r\n            }\r\n        }\r\n    };\r\n    return MouseDisplayContainer;\r\n}(Phaser.GameObjects.Container));\r\nvar EraserArea = /** @class */ (function (_super) {\r\n    __extends(EraserArea, _super);\r\n    function EraserArea(scene, roomService) {\r\n        return _super.call(this, scene, roomService) || this;\r\n    }\r\n    EraserArea.prototype.setDisplay = function (frame, size) {\r\n        if (this.area) {\r\n            this.area.clear();\r\n        }\r\n        var _a = this.mRoomService.roomSize, tileWidth = _a.tileWidth, tileHeight = _a.tileHeight;\r\n        this.mTileSize = {\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            rows: size,\r\n            cols: size,\r\n            sceneWidth: (size + size) * (tileWidth / 2),\r\n            sceneHeight: (size + size) * (tileHeight / 2),\r\n        };\r\n        this.mOffset.x = -(this.mTileSize.sceneWidth / 2);\r\n        this.mOffset.y = -((this.mTileSize.sceneHeight - (size % 2 === 0 ? 0 : tileHeight)) / 2);\r\n        var p1;\r\n        var p2;\r\n        var p3;\r\n        var p4;\r\n        this.area = this.scene.make.graphics(undefined, false);\r\n        for (var y = 0; y < size; y++) {\r\n            for (var x = 0; x < size; x++) {\r\n                this.area.lineStyle(2, 0);\r\n                p1 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y), this.mTileSize);\r\n                p2 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x + 1, y), this.mTileSize);\r\n                p3 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x + 1, y + 1), this.mTileSize);\r\n                p4 = _utils_position45__WEBPACK_IMPORTED_MODULE_4__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y + 1), this.mTileSize);\r\n                this.area.beginPath();\r\n                this.area.fillStyle(0, 0.5);\r\n                this.area.strokePoints([p1.toPoint(), p2.toPoint(), p3.toPoint(), p4.toPoint()], true, true);\r\n                this.area.fillPath();\r\n            }\r\n        }\r\n        this.add(this.area);\r\n    };\r\n    return EraserArea;\r\n}(MouseDisplayContainer));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/mouse.follow.ts?')},"./src/rooms/editor/reference.area.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReferenceArea", function() { return ReferenceArea; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ReferenceArea = /** @class */ (function (_super) {\r\n    __extends(ReferenceArea, _super);\r\n    function ReferenceArea(scene, mRoomService) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mRoomService = mRoomService;\r\n        return _this;\r\n    }\r\n    ReferenceArea.prototype.draw = function (area, origin) {\r\n        this.clear();\r\n        if (area.length === 0 || area[0].length === 0) {\r\n            return;\r\n        }\r\n        var p1;\r\n        var p2;\r\n        var p3;\r\n        var p4;\r\n        var rows = area.length;\r\n        var cols = area[0].length;\r\n        var roomSize = this.mRoomService.roomSize;\r\n        var tileWidth = roomSize.tileWidth / 2;\r\n        var tileHeight = roomSize.tileHeight / 2;\r\n        this.mOrigin = origin;\r\n        this.mSize = {\r\n            rows: rows,\r\n            cols: cols,\r\n            tileWidth: tileWidth,\r\n            tileHeight: tileHeight,\r\n            sceneWidth: (rows + cols) * (tileWidth / 2),\r\n            sceneHeight: (rows + cols) * (tileHeight / 2)\r\n        };\r\n        this.beginPath();\r\n        for (var y = 0; y < rows; y++) {\r\n            for (var x = 0; x < cols; x++) {\r\n                this.lineStyle(2, 0);\r\n                p1 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x, y), this.mSize);\r\n                p2 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x + 1, y), this.mSize);\r\n                p3 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x + 1, y + 1), this.mSize);\r\n                p4 = _utils_position45__WEBPACK_IMPORTED_MODULE_1__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](x, y + 1), this.mSize);\r\n                this.beginPath();\r\n                this.fillStyle(area[y][x] === 1 ? 0x00FF00 : 0xFF0000);\r\n                this.strokePoints([p1.toPoint(), p2.toPoint(), p3.toPoint(), p4.toPoint()], true, true);\r\n                this.fillPath();\r\n            }\r\n        }\r\n        this.setPosition(0, 0);\r\n    };\r\n    ReferenceArea.prototype.setPosition = function (x, y, z, w) {\r\n        if (!this.mSize)\r\n            return;\r\n        var _x = x - this.mSize.rows * (this.mSize.tileWidth >> 1) - (this.mOrigin.x - this.mOrigin.y) * (this.mSize.tileWidth >> 1);\r\n        var _y = y - (this.mOrigin.x + this.mOrigin.y) * (this.mSize.tileHeight >> 1);\r\n        return _super.prototype.setPosition.call(this, _x, _y, z, w);\r\n    };\r\n    Object.defineProperty(ReferenceArea.prototype, "size", {\r\n        get: function () {\r\n            return this.mSize;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return ReferenceArea;\r\n}(Phaser.GameObjects.Graphics));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/reference.area.ts?')},"./src/rooms/editor/selected.element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectedElement", function() { return SelectedElement; });\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n\r\n\r\nvar SelectedElement = /** @class */ (function () {\r\n    function SelectedElement(mScene, mLayerManager) {\r\n        this.mScene = mScene;\r\n        this.mLayerManager = mLayerManager;\r\n        this.mDisplayHeight = 0;\r\n        this.mEffecte = new _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"](this.mScene, 0, 0);\r\n        this.mEffecte.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/editor/selectFlag.png"));\r\n    }\r\n    SelectedElement.prototype.setElement = function (display) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.hideRefernceArea();\r\n            this.mDisplay.showNickname("");\r\n            this.mSprite = undefined;\r\n        }\r\n        this.mDisplay = display;\r\n        display.showRefernceArea();\r\n        this.mDisplayHeight = this.mDisplay.spriteHeight;\r\n        var ele = display.element;\r\n        if (ele) {\r\n            ele.showNickname();\r\n            this.mSprite = ele.model;\r\n        }\r\n        this.mLayerManager.addToSceneToUI(this.mEffecte);\r\n        this.mSelecting = true;\r\n        this.update();\r\n    };\r\n    SelectedElement.prototype.remove = function () {\r\n        this.mSelecting = false;\r\n        if (!this.mEffecte) {\r\n            return;\r\n        }\r\n        if (this.mEffecte.parentContainer) {\r\n            this.mEffecte.parentContainer.remove(this.mEffecte);\r\n        }\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        if (this.mDisplay.parentContainer) {\r\n            this.mDisplay.hideRefernceArea();\r\n            this.mDisplay.showNickname("");\r\n        }\r\n        this.mDisplay = null;\r\n        this.mSprite = undefined;\r\n    };\r\n    SelectedElement.prototype.update = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var baseLoc = this.mDisplay.baseLoc;\r\n        this.mEffecte.x = this.mDisplay.x + baseLoc.x;\r\n        this.mEffecte.y = this.mDisplay.y + baseLoc.y - (this.mDisplayHeight >> 1);\r\n    };\r\n    SelectedElement.prototype.setDisplayPos = function (x, y) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.x = x;\r\n        this.mDisplay.y = y;\r\n        if (this.mSprite) {\r\n            var pos = this.mSprite.pos;\r\n            if (pos) {\r\n                pos.x = x;\r\n                pos.y = y;\r\n            }\r\n        }\r\n    };\r\n    SelectedElement.prototype.destroy = function () {\r\n        if (!this.mEffecte) {\r\n            return;\r\n        }\r\n        this.remove();\r\n        this.mEffecte.destroy();\r\n        this.mEffecte = null;\r\n    };\r\n    Object.defineProperty(SelectedElement.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "selecting", {\r\n        /**\r\n         * 鼠标按下选中物件, 松开取消选择\r\n         */\r\n        get: function () {\r\n            return this.mSelecting;\r\n        },\r\n        set: function (val) {\r\n            this.mSelecting = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SelectedElement.prototype, "sprite", {\r\n        get: function () {\r\n            return this.mSprite;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return SelectedElement;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/editor/selected.element.ts?')},"./src/rooms/effect/effect.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EffectManager", function() { return EffectManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _effect__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./effect */ "./src/rooms/effect/effect.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar EffectManager = /** @class */ (function (_super) {\r\n    __extends(EffectManager, _super);\r\n    function EffectManager(room) {\r\n        var _this = _super.call(this) || this;\r\n        _this.room = room;\r\n        _this.mEffects = new Map();\r\n        _this.connection.addPacketListener(_this);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSyncSprite);\r\n        return _this;\r\n    }\r\n    EffectManager.prototype.add = function (id) {\r\n        var effect = new _effect__WEBPACK_IMPORTED_MODULE_2__["Effect"](id);\r\n        this.mEffects.set(id, effect);\r\n        this.updateDisplay(effect);\r\n        return effect;\r\n    };\r\n    EffectManager.prototype.remove = function (id) {\r\n        this.mEffects.delete(id);\r\n    };\r\n    EffectManager.prototype.get = function (id) {\r\n        var effect = this.mEffects.get(id);\r\n        if (!effect) {\r\n            effect = this.add(id);\r\n        }\r\n        return effect;\r\n    };\r\n    EffectManager.prototype.destroy = function () {\r\n        this.mEffects.forEach(function (effect) {\r\n            effect.destroy();\r\n        });\r\n        this.mEffects.clear();\r\n        this.connection.removePacketListener(this);\r\n    };\r\n    EffectManager.prototype.updateDisplay = function (effect) {\r\n        var id = effect.id;\r\n        var display = this.room.world.elementStorage.getDisplayModel(id);\r\n        if (display) {\r\n            effect.displayInfo = display;\r\n        }\r\n        else {\r\n            this.fetchDisplay([id]);\r\n        }\r\n    };\r\n    EffectManager.prototype.fetchDisplay = function (ids) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    EffectManager.prototype.onSyncSprite = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var sprites = content.sprites;\r\n        var effect = null;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            effect = this.mEffects.get(sprite.id);\r\n            if (effect) {\r\n                effect.syncSprite(sprite);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(EffectManager.prototype, "connection", {\r\n        get: function () {\r\n            return this.room.connection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return EffectManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/effect/effect.manager.ts?')},"./src/rooms/effect/effect.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Effect", function() { return Effect; });\n/* harmony import */ var _display_frames_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var _display_animation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/animation */ "./src/rooms/display/animation.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Effect = /** @class */ (function (_super) {\r\n    __extends(Effect, _super);\r\n    function Effect(id) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mID = id;\r\n        return _this;\r\n    }\r\n    Effect.prototype.syncSprite = function (sprite) {\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.destroy();\r\n        }\r\n        var display = sprite.display, animations = sprite.animations;\r\n        if (display && animations) {\r\n            var anis = [];\r\n            for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {\r\n                var ani = animations_1[_i];\r\n                anis.push(new _display_animation__WEBPACK_IMPORTED_MODULE_1__["Animation"](ani));\r\n            }\r\n            this.displayInfo = new _display_frames_model__WEBPACK_IMPORTED_MODULE_0__["FramesModel"]({\r\n                animations: {\r\n                    defaultAnimationName: sprite.currentAnimationName,\r\n                    display: display,\r\n                    animationData: anis,\r\n                },\r\n            });\r\n        }\r\n    };\r\n    Effect.prototype.destroy = function () {\r\n    };\r\n    Object.defineProperty(Effect.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Effect.prototype, "displayInfo", {\r\n        get: function () {\r\n            return this.mDisplayInfo;\r\n        },\r\n        set: function (display) {\r\n            this.mDisplayInfo = display;\r\n            this.emit("updateDisplayInfo", display);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Effect;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/effect/effect.ts?')},"./src/rooms/element/decorate.element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateElementManager", function() { return DecorateElementManager; });\n/* harmony import */ var _element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./element */ "./src/rooms/element/element.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType;\r\nvar DecorateElementManager = /** @class */ (function (_super) {\r\n    __extends(DecorateElementManager, _super);\r\n    function DecorateElementManager(room) {\r\n        return _super.call(this, room) || this;\r\n    }\r\n    DecorateElementManager.prototype.addMap = function (sprite) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        if (this.mRoom.selectedSprite && this.mRoom.selectedSprite.id === sprite.id) {\r\n            return;\r\n        }\r\n        var curAni = sprite.currentAnimation;\r\n        var aniName = curAni.name;\r\n        var flip = curAni.flip;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName, flip);\r\n        var walkArea = displayInfo.getWalkableArea(aniName, flip);\r\n        var origin = displayInfo.getOriginPoint(aniName, flip);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var pos = this.mRoom.transformToMini45(sprite.pos);\r\n        if (!walkArea) {\r\n            walkArea = new Array(rows);\r\n            for (var i = 0; i < rows; i++) {\r\n                walkArea[i] = new Array(cols).fill(0);\r\n            }\r\n        }\r\n        var row = 0;\r\n        var col = 0;\r\n        for (var i = 0; i < rows; i++) {\r\n            row = pos.y + i - origin.x;\r\n            for (var j = 0; j < cols; j++) {\r\n                if (collisionArea[i][j] === 1 && (i >= walkArea.length || j >= walkArea[i].length || walkArea[i][j] === 0)) {\r\n                    col = pos.x + j - origin.y;\r\n                    if (row >= 0 && row < this.mMap.length && col >= 0 && col < this.mMap[row].length) {\r\n                        this.mMap[row][col] = 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateElementManager.prototype.removeMap = function (sprite) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var curAni = sprite.currentAnimation;\r\n        var aniName = curAni.name;\r\n        var flip = curAni.flip;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName, flip);\r\n        var origin = displayInfo.getOriginPoint(aniName, flip);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var pos = this.mRoom.transformToMini45(sprite.pos);\r\n        var row = 0;\r\n        var col = 0;\r\n        for (var i = 0; i < rows; i++) {\r\n            row = pos.y + i - origin.x;\r\n            for (var j = 0; j < cols; j++) {\r\n                col = pos.x + j - origin.y;\r\n                if (collisionArea[i][j] === 1) {\r\n                    if (row >= 0 && row < this.mMap.length && col >= 0 && col < this.mMap[row].length) {\r\n                        this.mMap[pos.y + i - origin.x][pos.x + j - origin.y] = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateElementManager.prototype.canPut = function (pos45, collisionArea, origin) {\r\n        var row = 0;\r\n        var col = 0;\r\n        var map = this.map;\r\n        for (var i = 0; i < collisionArea.length; i++) {\r\n            row = i + pos45.y - origin.y;\r\n            if (row >= map.length) {\r\n                return false;\r\n            }\r\n            for (var j = 0; j < collisionArea[i].length; j++) {\r\n                col = j + pos45.x - origin.x;\r\n                if (col >= map[i].length || map[row][col] === 1) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    DecorateElementManager.prototype._add = function (sprite, addMap) {\r\n        if (addMap === undefined)\r\n            addMap = true;\r\n        var ele = this.mElements.get(sprite.id);\r\n        if (ele) {\r\n            ele.model = sprite;\r\n        }\r\n        else {\r\n            ele = new _element__WEBPACK_IMPORTED_MODULE_2__["Element"](sprite, this);\r\n            if (this.getFrozenType(sprite) === "FROZEN")\r\n                ele.setInputEnable(_element__WEBPACK_IMPORTED_MODULE_2__["InputEnable"].Diasble);\r\n            else\r\n                ele.setInputEnable(_element__WEBPACK_IMPORTED_MODULE_2__["InputEnable"].Enable);\r\n        }\r\n        // if (!ele) ele = new Element(sprite, this);\r\n        if (addMap)\r\n            this.addMap(sprite);\r\n        this.mElements.set(ele.id || 0, ele);\r\n        return ele;\r\n    };\r\n    DecorateElementManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var element = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            element = this.get(sprite.id);\r\n            if (element) {\r\n                var sp = new _sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite, content.nodeType);\r\n                element.model = sp;\r\n                this.addMap(sp);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(DecorateElementManager.prototype, "map", {\r\n        get: function () {\r\n            return this.mMap;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DecorateElementManager.prototype.getFrozenType = function (sprite) {\r\n        var frozenType;\r\n        var arr = sprite.attrs;\r\n        if (arr) {\r\n            arr.forEach(function (value) {\r\n                if (value.key === "frozenType") {\r\n                    frozenType = value.value;\r\n                }\r\n            });\r\n        }\r\n        return frozenType;\r\n    };\r\n    return DecorateElementManager;\r\n}(_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/decorate.element.manager.ts?')},"./src/rooms/element/editor.element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorElementManager", function() { return EditorElementManager; });\n/* harmony import */ var _element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType;\r\nvar EditorElementManager = /** @class */ (function (_super) {\r\n    __extends(EditorElementManager, _super);\r\n    function EditorElementManager(mRoom) {\r\n        var _this = _super.call(this, mRoom) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.taskQueue = new Map();\r\n        if (_this.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_CREATE_SPRITE, _this.handleCreateElements);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITE, _this.handleDeleteElements);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_SPRITE, _this.handleSyncElements);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorElementManager.prototype.update = function () {\r\n        this.batchActionSprites();\r\n    };\r\n    EditorElementManager.prototype.addElements = function (sprites) {\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this.taskQueue.set(sprite.id, {\r\n                action: "ADD",\r\n                sprite: sprite,\r\n            });\r\n        }\r\n        this.callEditorCreateElementData(sprites);\r\n    };\r\n    EditorElementManager.prototype.callEditorCreateElementData = function (sprites) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_SPRITE);\r\n        var content = pkt.content;\r\n        content.nodeType = sprites[0].nodeType;\r\n        content.sprites = sprites.map(function (sprite) { return sprite.toSprite(); });\r\n        this.connection.send(pkt);\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_4__["Logger"].getInstance().log("add sprites: ", content);\r\n    };\r\n    EditorElementManager.prototype.updateElements = function (sprites) {\r\n        this.callEditorUpdateElementData(sprites);\r\n    };\r\n    EditorElementManager.prototype.callEditorUpdateElementData = function (sprites) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_SPRITE);\r\n        var content = pkt.content;\r\n        content.sprites = sprites;\r\n        this.connection.send(pkt);\r\n    };\r\n    // removeEditor(id: number) {\r\n    //     const ele = this.tryRemove(id);\r\n    //     if (ele) {\r\n    //         const pkt = new PBpacket(op_editor.OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_SPRITE);\r\n    //         const content: op_editor.IOP_CLIENT_REQ_EDITOR_DELETE_SPRITE = pkt.content;\r\n    //         content.ids = [id];\r\n    //         this.connection.send(pkt);\r\n    //     }\r\n    //     return ele;\r\n    // }\r\n    EditorElementManager.prototype.deleteElements = function (ids) {\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.taskQueue.set(id, {\r\n                action: "DELETE",\r\n                sprite: { id: id },\r\n            });\r\n        }\r\n        this.callEditorDeleteElementData(ids);\r\n    };\r\n    EditorElementManager.prototype.callEditorDeleteElementData = function (ids) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_SPRITE);\r\n        var content = pkt.content;\r\n        content.ids = ids;\r\n        content.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorElementManager.prototype.handleCreateElements = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_4__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var sprites = content.sprites, nodeType = content.nodeType;\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            this.taskQueue.set(sprite.id, {\r\n                action: "ADD",\r\n                sprite: new _sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite),\r\n            });\r\n        }\r\n        // if (!sprites) return;\r\n        // if (nodeType !== NodeType.ElementNodeType && nodeType !== NodeType.SpawnPointType) {\r\n        //     return;\r\n        // }\r\n        // let point: op_def.IPBPoint3f;\r\n        // const displays = [];\r\n        // let ele: Element = null;\r\n        // for (const sprite of sprites) {\r\n        //     point = sprite.point3f;\r\n        //     if (point) {\r\n        //         ele = this._add(new Sprite(sprite, nodeType));\r\n        //         if (ele.getDisplay()) displays.push(ele.getDisplay());\r\n        //     }\r\n        // }\r\n        // this.mRoom.addToSurface(displays);\r\n    };\r\n    EditorElementManager.prototype.handleDeleteElements = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.ids, nodeType = content.nodeType;\r\n        if (nodeType !== NodeType.ElementNodeType && nodeType !== NodeType.SpawnPointType) {\r\n            return;\r\n        }\r\n        // for (const id of ids) {\r\n        //     this.tryRemove(id);\r\n        // }\r\n        // this.roomService.removeSelected();\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            this.taskQueue.set(id, {\r\n                action: "DELETE",\r\n                sprite: { id: id },\r\n            });\r\n        }\r\n        this.roomService.removeSelected();\r\n    };\r\n    EditorElementManager.prototype.handleSyncElements = function (packet) {\r\n        var content = packet.content;\r\n        var sprites = content.sprites;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_def"].NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, sprites_3 = sprites; _i < sprites_3.length; _i++) {\r\n            var sprite = sprites_3[_i];\r\n            // this.trySync(sprite);\r\n            this.taskQueue.set(sprite.id, {\r\n                action: "UPDATE",\r\n                sprite: new _sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite),\r\n            });\r\n        }\r\n    };\r\n    // protected _add(sprite: ISprite): Element {\r\n    //     let ele = this.mElements.get(sprite.id);\r\n    //     if (!ele) ele = new Element(sprite, this);\r\n    //     ele.setBlockable(false);\r\n    //     ele.setRenderable(true);\r\n    //     ele.setInputEnable(InputEnable.Enable);\r\n    //     this.mElements.set(ele.id, ele);\r\n    //     return ele;\r\n    // }\r\n    // protected tryRemove(id) {\r\n    //     const element = this.mElements.get(id);\r\n    //     if (element) {\r\n    //         this.mElements.delete(id);\r\n    //         element.destroy();\r\n    //         if (this.roomService) {\r\n    //             this.roomService.blocks.remove(element);\r\n    //         }\r\n    //         return element;\r\n    //     }\r\n    // }\r\n    // protected trySync(sprite: op_client.ISprite) {\r\n    //     const element = this.mElements.get(sprite.id);\r\n    //     if (!element) {\r\n    //         Logger.getInstance().log("can\'t find element", sprite);\r\n    //         return;\r\n    //     }\r\n    //     const point = sprite.point3f;\r\n    //     if (point) {\r\n    //         element.setPosition(new Pos(point.x, point.y, point.z));\r\n    //     }\r\n    //     if (sprite.direction) {\r\n    //         element.setDirection(sprite.direction);\r\n    //     }\r\n    // }\r\n    EditorElementManager.prototype.batchActionSprites = function () {\r\n        if (!Array.from(this.taskQueue.keys()).length) {\r\n            return;\r\n        }\r\n        var batchTasksKeys = Array.from(this.taskQueue.keys()).splice(0, 200);\r\n        for (var _i = 0, batchTasksKeys_1 = batchTasksKeys; _i < batchTasksKeys_1.length; _i++) {\r\n            var key = batchTasksKeys_1[_i];\r\n            var _a = this.taskQueue.get(key), action = _a.action, sprite = _a.sprite;\r\n            this.taskQueue.delete(key);\r\n            if (action === "ADD") {\r\n                this.mRoom.displayObjectPool.push("elements", sprite.id.toString(), sprite, this);\r\n            }\r\n            else if (action === "DELETE") {\r\n                this.mRoom.displayObjectPool.remove("elements", sprite.id.toString());\r\n            }\r\n            else if (action === "UPDATE") {\r\n                this.mRoom.displayObjectPool.update("elements", sprite.id.toString(), sprite);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(EditorElementManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return EditorElementManager;\r\n}(_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/editor.element.manager.ts?')},"./src/rooms/element/editor.moss.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorMossManager", function() { return EditorMossManager; });\n/* harmony import */ var _element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/helpers */ "./src/utils/helpers.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (undefined && undefined.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\n\r\n\r\n\r\nvar EditorMossManager = /** @class */ (function (_super) {\r\n    __extends(EditorMossManager, _super);\r\n    function EditorMossManager(mRoom) {\r\n        var _this = _super.call(this, mRoom) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.taskQueue = new Map();\r\n        _this.editorMosses = new Map();\r\n        if (_this.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_ADD_MOSSES, _this.handleAddMosses);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_MOSSES, _this.handleDeleteMosses);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_SYNC_MOSSES, _this.handleUpdateMosses);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorMossManager.prototype.update = function () {\r\n        this.batchActionSprites();\r\n    };\r\n    EditorMossManager.prototype.addMosses = function (coorData) {\r\n        var placeLocs = [];\r\n        var locs = coorData.locs, key = coorData.key;\r\n        for (var _i = 0, locs_1 = locs; _i < locs_1.length; _i++) {\r\n            var loc = locs_1[_i];\r\n            var id = _utils_helpers__WEBPACK_IMPORTED_MODULE_3__["default"].genId();\r\n            var placeLoc = {\r\n                x: loc.x,\r\n                y: loc.y,\r\n                z: loc.z,\r\n                key: key,\r\n                id: id,\r\n            };\r\n            this.taskQueue.set(id, {\r\n                action: "ADD",\r\n                loc: placeLoc,\r\n            });\r\n            placeLocs.push(placeLoc);\r\n        }\r\n        this.reqEditorCreateMossData(placeLocs);\r\n    };\r\n    EditorMossManager.prototype.reqEditorCreateMossData = function (locs) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_CREATE_MOSSES);\r\n        var content = pkt.content;\r\n        content.locs = locs;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorMossManager.prototype.updateMosses = function (elements) {\r\n        var updateLocs = [];\r\n        for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\r\n            var element = elements_1[_i];\r\n            var sprite = element.display.element.model.toSprite();\r\n            var originLoc = this.editorMosses.get(sprite.id);\r\n            var loc = {\r\n                x: sprite.point3f.x,\r\n                y: sprite.point3f.y,\r\n                z: sprite.point3f.z,\r\n                id: sprite.id,\r\n                dir: sprite.direction,\r\n                key: originLoc.key,\r\n            };\r\n            this.taskQueue.set(sprite.id, {\r\n                action: "UPDATE",\r\n                loc: loc,\r\n            });\r\n            updateLocs.push(loc);\r\n        }\r\n        this.reqEditorUpdateMossData(updateLocs);\r\n    };\r\n    EditorMossManager.prototype.reqEditorUpdateMossData = function (locs) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_SYNC_MOSSES);\r\n        var content = pkt.content;\r\n        content.locs = locs;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorMossManager.prototype.deleteMosses = function (ids) {\r\n        var deleteLocs = [];\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            var loc = this.editorMosses.get(id);\r\n            deleteLocs.push(loc);\r\n            this.taskQueue.set(id, {\r\n                action: "DELETE",\r\n                loc: loc,\r\n            });\r\n        }\r\n        this.reqEditorDeleteMossData(deleteLocs);\r\n    };\r\n    EditorMossManager.prototype.reqEditorDeleteMossData = function (locs) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_MOSSES);\r\n        var content = pkt.content;\r\n        content.locs = locs;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorMossManager.prototype.handleAddMosses = function (packet) {\r\n        var content = packet.content;\r\n        var locs = content.locs;\r\n        for (var _i = 0, locs_2 = locs; _i < locs_2.length; _i++) {\r\n            var loc = locs_2[_i];\r\n            this.taskQueue.set(loc.id, {\r\n                action: "ADD",\r\n                loc: loc,\r\n            });\r\n        }\r\n    };\r\n    EditorMossManager.prototype.handleDeleteMosses = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.ids;\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            this.taskQueue.set(id, {\r\n                action: "DELETE",\r\n                loc: this.editorMosses.get(id),\r\n            });\r\n        }\r\n        this.roomService.removeSelected();\r\n    };\r\n    EditorMossManager.prototype.handleUpdateMosses = function (packet) {\r\n        var content = packet.content;\r\n        var locs = content.locs;\r\n        for (var _i = 0, locs_3 = locs; _i < locs_3.length; _i++) {\r\n            var loc = locs_3[_i];\r\n            this.taskQueue.set(loc.id, {\r\n                action: "UPDATE",\r\n                loc: loc,\r\n            });\r\n        }\r\n    };\r\n    EditorMossManager.prototype.batchActionSprites = function () {\r\n        if (!Array.from(this.taskQueue.keys()).length) {\r\n            return;\r\n        }\r\n        var batchTasksKeys = Array.from(this.taskQueue.keys()).splice(0, 200);\r\n        for (var _i = 0, batchTasksKeys_1 = batchTasksKeys; _i < batchTasksKeys_1.length; _i++) {\r\n            var key = batchTasksKeys_1[_i];\r\n            var _a = this.taskQueue.get(key), action = _a.action, loc = _a.loc;\r\n            this.taskQueue.delete(key);\r\n            if (action === "ADD") {\r\n                var moss = this.mRoom.world.elementStorage.getMossPalette(loc.key);\r\n                if (!moss)\r\n                    continue;\r\n                var sprite = moss.createSprite(__assign(__assign({}, loc), { nodeType: pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType, isMoss: true }));\r\n                this.editorMosses.set(loc.id, loc);\r\n                this.mRoom.displayObjectPool.push("mosses", loc.id.toString(), sprite, this);\r\n            }\r\n            else if (action === "DELETE") {\r\n                if (loc) {\r\n                    this.editorMosses.delete(loc.id);\r\n                    this.mRoom.displayObjectPool.remove("mosses", loc.id.toString());\r\n                }\r\n            }\r\n            else if (action === "UPDATE") {\r\n                var moss = this.mRoom.world.elementStorage.getMossPalette(loc.key);\r\n                if (!moss)\r\n                    continue;\r\n                var sprite = moss.createSprite(__assign(__assign({}, loc), { nodeType: pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType, isMoss: true }));\r\n                this.editorMosses.set(loc.id, loc);\r\n                this.mRoom.displayObjectPool.update("mosses", loc.id.toString(), sprite);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(EditorMossManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return EditorMossManager;\r\n}(_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/editor.moss.manager.ts?')},"./src/rooms/element/element.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementManager", function() { return ElementManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _sprite__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./sprite */ "./src/rooms/element/sprite.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\nvar ElementManager = /** @class */ (function (_super) {\r\n    __extends(ElementManager, _super);\r\n    function ElementManager(mRoom) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mElements = new Map();\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE, _this.onMove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION, _this.onAdjust);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE, _this.onShowBubble);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN, _this.onClearBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION, _this.onSetPosition);\r\n        }\r\n        if (_this.mRoom && _this.mRoom.world) {\r\n            _this.mGameConfig = _this.mRoom.world.elementStorage;\r\n        }\r\n        var size = _this.mRoom.miniSize;\r\n        _this.mMap = new Array(size.cols);\r\n        for (var i = 0; i < _this.mMap.length; i++) {\r\n            _this.mMap[i] = new Array(size.rows).fill(-1);\r\n        }\r\n        return _this;\r\n    }\r\n    ElementManager.prototype.init = function () {\r\n        // this.destroy();\r\n    };\r\n    ElementManager.prototype.get = function (id) {\r\n        var element = this.mElements.get(id);\r\n        if (!element) {\r\n            return;\r\n        }\r\n        return element;\r\n    };\r\n    ElementManager.prototype.remove = function (id) {\r\n        var element = this.mElements.get(id);\r\n        if (element) {\r\n            this.mElements.delete(id);\r\n            element.destroy();\r\n            this.removeMap(element.model);\r\n        }\r\n        return element;\r\n    };\r\n    ElementManager.prototype.getElements = function () {\r\n        return Array.from(this.mElements.values());\r\n    };\r\n    ElementManager.prototype.add = function (sprites, addMap) {\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this._add(sprite, addMap);\r\n        }\r\n    };\r\n    ElementManager.prototype.setState = function (state) {\r\n        if (!state) {\r\n            return;\r\n        }\r\n        var owner = state.owner;\r\n        if (!owner || owner.type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var element = this.get(owner.id);\r\n        if (!element) {\r\n            return;\r\n        }\r\n        element.setState(state.state);\r\n    };\r\n    ElementManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mElements)\r\n            return;\r\n        this.mElements.forEach(function (element) { return _this.remove(element.id); });\r\n        this.mElements.clear();\r\n    };\r\n    ElementManager.prototype.update = function (time, delta) { };\r\n    ElementManager.prototype.addMap = function (sprite) { };\r\n    ElementManager.prototype.removeMap = function (sprite) { };\r\n    Object.defineProperty(ElementManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mRoom.cameraService.camera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ElementManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("roomManager is undefined");\r\n            return;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ElementManager.prototype.onAdjust = function (packet) {\r\n        var content = packet.content;\r\n        var sprites = content.spritePositions;\r\n        var type = content.nodeType;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var ele;\r\n        var point;\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            ele = this.mElements.get(sprite.id);\r\n            if (!ele) {\r\n                continue;\r\n            }\r\n            point = sprite.point3f;\r\n            ele.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](point.x || 0, point.y || 0, point.z || 0));\r\n        }\r\n    };\r\n    ElementManager.prototype.onAdd = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        if (!this.mGameConfig) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("gameConfig does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var objs = content.sprites;\r\n        if (!objs)\r\n            return;\r\n        var type = content.nodeType;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var point;\r\n        var sprite = null;\r\n        var ids = [];\r\n        for (var _i = 0, objs_1 = objs; _i < objs_1.length; _i++) {\r\n            var obj = objs_1[_i];\r\n            point = obj.point3f;\r\n            if (point) {\r\n                sprite = new _sprite__WEBPACK_IMPORTED_MODULE_5__["Sprite"](obj, content.nodeType);\r\n                if (!sprite.displayInfo) {\r\n                    if (!this.checkDisplay(sprite)) {\r\n                        ids.push(sprite.id);\r\n                    }\r\n                }\r\n                this._add(sprite);\r\n            }\r\n        }\r\n        this.fetchDisplay(ids);\r\n    };\r\n    ElementManager.prototype._add = function (sprite, addMap) {\r\n        if (addMap === undefined)\r\n            addMap = true;\r\n        var ele = this.mElements.get(sprite.id);\r\n        if (ele) {\r\n            ele.model = sprite;\r\n        }\r\n        else {\r\n            ele = new _element__WEBPACK_IMPORTED_MODULE_2__["Element"](sprite, this);\r\n            ele.setInputEnable(_element__WEBPACK_IMPORTED_MODULE_2__["InputEnable"].Interactive);\r\n        }\r\n        // if (!ele) ele = new Element(sprite, this);\r\n        if (addMap)\r\n            this.addMap(sprite);\r\n        this.mElements.set(ele.id || 0, ele);\r\n        return ele;\r\n    };\r\n    ElementManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    ElementManager.prototype.checkDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var displayInfo = this.roomService.world.elementStorage.getDisplayModel(sprite.bindID || sprite.id);\r\n            if (displayInfo) {\r\n                sprite.displayInfo = displayInfo;\r\n                return displayInfo;\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.fetchDisplay = function (ids) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(ElementManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ElementManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ElementManager.prototype, "map", {\r\n        get: function () {\r\n            return this.mMap;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ElementManager.prototype.onSetPosition = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var id = content.id;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var ele = this.get(id);\r\n        ele.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](content.position.x, content.position.y, content.position.z));\r\n    };\r\n    ElementManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.remove(id);\r\n        }\r\n    };\r\n    ElementManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var element = null;\r\n        var sprites = content.sprites;\r\n        var command = content.command;\r\n        for (var _i = 0, sprites_3 = sprites; _i < sprites_3.length; _i++) {\r\n            var sprite = sprites_3[_i];\r\n            element = this.get(sprite.id);\r\n            if (element) {\r\n                if (command === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].OpCommand.OP_COMMAND_UPDATE) {\r\n                    element.model = new _sprite__WEBPACK_IMPORTED_MODULE_5__["Sprite"](sprite);\r\n                }\r\n                else if (command === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].OpCommand.OP_COMMAND_PATCH) {\r\n                    element.updateModel(sprite);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.onMove = function (packet) {\r\n        var content = packet.content;\r\n        if (content.moveData) {\r\n            var moveDataList = content.moveData;\r\n            var len = moveDataList.length;\r\n            var type = content.nodeType || null;\r\n            var moveData = void 0;\r\n            var elementID = void 0;\r\n            var element = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                moveData = moveDataList[i];\r\n                elementID = moveData.moveObjectId;\r\n                element = this.get(elementID);\r\n                // Console.log(player.x + "," + player.y + ":" + moveData.destinationPoint3f.x + "," + moveData.destinationPoint3f.y + ":" + moveData.timeSpan);\r\n                if (!element) {\r\n                    continue;\r\n                }\r\n                element.move(moveData);\r\n            }\r\n        }\r\n    };\r\n    ElementManager.prototype.onShowBubble = function (packet) {\r\n        var content = packet.content;\r\n        var element = this.get(content.receiverid);\r\n        if (element) {\r\n            element.showBubble(content.context, content.chatsetting);\r\n        }\r\n    };\r\n    ElementManager.prototype.onClearBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var element = this.get(content.receiverid);\r\n        if (element) {\r\n            element.clearBubble();\r\n        }\r\n    };\r\n    ElementManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.ElementNodeType) {\r\n            return;\r\n        }\r\n        var ele = null;\r\n        var ids = content.ids;\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            ele = this.get(id);\r\n            if (ele) {\r\n                ele.setQueue(content.changeAnimation);\r\n            }\r\n        }\r\n    };\r\n    return ElementManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/element.manager.ts?')},"./src/rooms/element/element.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerState", function() { return PlayerState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Direction", function() { return Direction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputEnable", function() { return InputEnable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Element", function() { return Element; });\n/* harmony import */ var _display_dragonbones_display__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _display_frames_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/frames.display */ "./src/rooms/display/frames.display.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _cameras_block_object__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../cameras/block.object */ "./src/rooms/cameras/block.object.ts");\n/* harmony import */ var _bubble_bubble_container__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../bubble/bubble.container */ "./src/rooms/bubble/bubble.container.ts");\n/* harmony import */ var _shop_shop_entity__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./shop/shop.entity */ "./src/rooms/element/shop/shop.entity.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _action_AI__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../action/AI */ "./src/rooms/action/AI.ts");\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! buffer/ */ "./node_modules/node-libs-browser/node_modules/buffer/index.js");\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(buffer___WEBPACK_IMPORTED_MODULE_10__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PlayerState;\r\n(function (PlayerState) {\r\n    PlayerState["IDLE"] = "idle";\r\n    PlayerState["WALK"] = "walk";\r\n    PlayerState["RUN"] = "run";\r\n    PlayerState["ATTACK"] = "attack";\r\n    PlayerState["JUMP"] = "jump";\r\n    PlayerState["INJURED"] = "injured";\r\n    PlayerState["FAILED"] = "failed";\r\n    PlayerState["DANCE01"] = "dance01";\r\n    PlayerState["DANCE02"] = "dance02";\r\n    PlayerState["FISHING"] = "fishing";\r\n    PlayerState["GREET01"] = "greet01";\r\n    PlayerState["SIT"] = "sit";\r\n    PlayerState["LIE"] = "lit";\r\n    PlayerState["EMOTION01"] = "emotion01";\r\n})(PlayerState || (PlayerState = {}));\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[Direction["north"] = 0] = "north";\r\n    Direction[Direction["north_west"] = 1] = "north_west";\r\n    Direction[Direction["west"] = 2] = "west";\r\n    Direction[Direction["west_south"] = 3] = "west_south";\r\n    Direction[Direction["south"] = 4] = "south";\r\n    Direction[Direction["south_east"] = 5] = "south_east";\r\n    Direction[Direction["east"] = 6] = "east";\r\n    Direction[Direction["east_north"] = 7] = "east_north";\r\n})(Direction || (Direction = {}));\r\nvar InputEnable;\r\n(function (InputEnable) {\r\n    InputEnable[InputEnable["Diasble"] = 0] = "Diasble";\r\n    InputEnable[InputEnable["Enable"] = 1] = "Enable";\r\n    InputEnable[InputEnable["Interactive"] = 2] = "Interactive";\r\n})(InputEnable || (InputEnable = {}));\r\nvar Element = /** @class */ (function (_super) {\r\n    __extends(Element, _super);\r\n    function Element(sprite, mElementManager) {\r\n        var _this = _super.call(this, mElementManager.roomService) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mAnimationName = "";\r\n        _this.mMoveData = {};\r\n        _this.mCurState = PlayerState.IDLE;\r\n        _this.mOffsetY = undefined;\r\n        _this.mMoving = false;\r\n        _this.mId = sprite.id;\r\n        _this.model = sprite;\r\n        _this.mAi = new _action_AI__WEBPACK_IMPORTED_MODULE_9__["AI"](_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Element.prototype, "dir", {\r\n        get: function () {\r\n            return this.mDisplayInfo.avatarDir !== undefined ? this.mDisplayInfo.avatarDir : 3;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "roomService", {\r\n        get: function () {\r\n            if (!this.mElementManager) {\r\n                // Logger.getInstance().error("element manager is undefined");\r\n                return;\r\n            }\r\n            return this.mElementManager.roomService;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "id", {\r\n        get: function () {\r\n            return this.mId; // this.mDisplayInfo.id || 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.setModel(val);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mElementManager) {\r\n                return this.mElementManager.scene;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "ai", {\r\n        get: function () {\r\n            return this.mAi;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Element.prototype, "eleMgr", {\r\n        get: function () {\r\n            if (this.mElementManager) {\r\n                return this.mElementManager;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Element.prototype.load = function (displayInfo) {\r\n        this.mDisplayInfo = displayInfo;\r\n        this.loadDisplayInfo();\r\n    };\r\n    Element.prototype.setModel = function (model) {\r\n        this.mModel = model;\r\n        if (!model) {\r\n            return;\r\n        }\r\n        // this.mDisplayInfo = this.mModel.displayInfo;\r\n        this.mQueueAnimations = undefined;\r\n        this.load(this.mModel.displayInfo);\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        if (this.mModel.pos) {\r\n            this.setPosition(this.mModel.pos);\r\n        }\r\n        this.mDisplay.changeAlpha(this.mModel.alpha);\r\n        // todo 暂时不显示，后续添加显示名字的协议\r\n        // this.mDisplay.showNickname(this.mModel.nickname);\r\n        this.setDirection(this.mModel.direction);\r\n        // this.setRenderable(true);\r\n        var frameModel = this.mDisplayInfo;\r\n        if (this.mInputEnable === InputEnable.Interactive) {\r\n            this.setInputEnable(this.mInputEnable);\r\n        }\r\n        if (frameModel && frameModel.shops) {\r\n            this.mShopEntity = new _shop_shop_entity__WEBPACK_IMPORTED_MODULE_7__["ShopEntity"](this.mElementManager.roomService.world);\r\n            this.mShopEntity.register();\r\n        }\r\n        if (model.mountSprites && model.mountSprites.length > 0) {\r\n            this.updateMounth(model.mountSprites);\r\n        }\r\n    };\r\n    Element.prototype.updateModel = function (model) {\r\n        if (this.mModel.id !== model.id) {\r\n            return;\r\n        }\r\n        if (model.hasOwnProperty("avatar")) {\r\n            this.mModel.updateAvatar(model.avatar);\r\n            this.load(this.mModel.displayInfo);\r\n        }\r\n        if (model.display && model.animations) {\r\n            this.mModel.updateDisplay(model.display, model.animations);\r\n            this.load(this.mModel.displayInfo);\r\n        }\r\n        if (model.hasOwnProperty("currentAnimationName")) {\r\n            this.play(model.currentAnimationName);\r\n            this.setInputEnable(this.mInputEnable);\r\n            this.mModel.setAnimationQueue(undefined);\r\n        }\r\n        if (model.hasOwnProperty("direction")) {\r\n            this.setDirection(model.direction);\r\n        }\r\n        if (model.hasOwnProperty("mountSprites")) {\r\n            var mounts = model.mountSprites;\r\n            this.mergeMounth(mounts);\r\n            this.updateMounth(mounts);\r\n        }\r\n        if (model.hasOwnProperty("point3f")) {\r\n            var pos = model.point3f;\r\n            this.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](pos.x, pos.y, pos.z));\r\n        }\r\n    };\r\n    Element.prototype.scaleTween = function () {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.scaleTween();\r\n    };\r\n    Element.prototype.play = function (animationName) {\r\n        if (!this.mModel) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error(Element.name + ": sprite is empty");\r\n            return;\r\n        }\r\n        if (this.mModel.currentAnimationName !== animationName) {\r\n            // this.mAnimationName = animationName;\r\n            this.mModel.currentAnimationName = animationName;\r\n            if (this.mDisplay) {\r\n                this.mDisplay.play(this.model.currentAnimation);\r\n            }\r\n        }\r\n    };\r\n    Element.prototype.setQueue = function (animations) {\r\n        var _this = this;\r\n        if (!this.mModel) {\r\n            return;\r\n        }\r\n        var queue = [];\r\n        for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {\r\n            var animation = animations_1[_i];\r\n            var aq = {\r\n                name: animation.animationName,\r\n                playTimes: animation.times,\r\n            };\r\n            if (animation.times > 0) {\r\n                aq.complete = function () {\r\n                    var anis = _this.model.animationQueue;\r\n                    anis.shift();\r\n                    var aniName = anis.length > 0 ? anis[0].name : PlayerState.IDLE;\r\n                    _this.play(aniName);\r\n                };\r\n            }\r\n            queue.push(aq);\r\n        }\r\n        this.mModel.setAnimationQueue(queue);\r\n        if (queue.length > 0) {\r\n            this.play(animations[0].animationName);\r\n        }\r\n    };\r\n    Element.prototype.setDirection = function (val) {\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.avatarDir = val;\r\n        }\r\n        if (this.mDisplay && this.model) {\r\n            this.model.direction = val;\r\n            this.mDisplay.play(this.model.currentAnimation);\r\n        }\r\n    };\r\n    Element.prototype.getDirection = function () {\r\n        return this.mDisplayInfo && this.mDisplayInfo.avatarDir ? this.mDisplayInfo.avatarDir : 3;\r\n    };\r\n    Element.prototype.changeState = function (val) {\r\n        if (this.mCurState === val)\r\n            return;\r\n        this.mCurState = val;\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        // if (!val) val = PlayerState.IDLE;\r\n        if (!val) {\r\n            val = PlayerState.IDLE;\r\n        }\r\n        this.play(this.mCurState);\r\n        // this.mModel.currentAnimationName = this.mCurState;\r\n        // this.mDisplay.play(this.mModel.currentAnimation);\r\n    };\r\n    Element.prototype.getState = function () {\r\n        return this.mCurState;\r\n    };\r\n    Element.prototype.getRenderable = function () {\r\n        return this.mRenderable;\r\n    };\r\n    Element.prototype.getDisplay = function () {\r\n        return this.mDisplay;\r\n    };\r\n    Element.prototype.move = function (moveData) {\r\n        if (!this.mElementManager) {\r\n            return; // Logger.getInstance().error(`Element::move - Empty element-manager.`);\r\n        }\r\n        if (!this.mDisplay) {\r\n            return; // Logger.getInstance().error("display is undefined");\r\n        }\r\n        this.mMoveData.arrivalTime = moveData.timestemp;\r\n        // this.mMoveData.destPos = new Pos(\r\n        //     Math.floor(moveData.destinationPoint3f.x),\r\n        //     Math.floor(moveData.destinationPoint3f.y)\r\n        // );\r\n        this.mMoveData.posPath = [\r\n            {\r\n                x: moveData.destinationPoint3f.x,\r\n                y: moveData.destinationPoint3f.y,\r\n            },\r\n        ];\r\n        this._doMove();\r\n    };\r\n    Element.prototype.movePosition = function (pos, angel) {\r\n        if (!this.mElementManager) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.startMove();\r\n        if (!pos.depth)\r\n            pos.depth = this.getDepth();\r\n        this.setPosition(pos);\r\n        var direction = this.calculateDirectionByAngle(angel);\r\n        if (direction !== -1 && direction !== this.model.direction) {\r\n            this.setDirection(direction);\r\n        }\r\n    };\r\n    Element.prototype.movePath = function (movePath) {\r\n        var _this = this;\r\n        if (!this.mElementManager) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var tmpPath = movePath.path;\r\n        if (!tmpPath) {\r\n            return;\r\n        }\r\n        this.mMoveData.arrivalTime = movePath.timestemp;\r\n        var lastPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](this.mDisplay.x, this.mDisplay.y - this.offsetY);\r\n        var paths = [];\r\n        var angle = null;\r\n        var point = null;\r\n        var now = this.mElementManager.roomService.now();\r\n        var duration = 0;\r\n        var index = 0;\r\n        for (var _i = 0, _a = movePath.path; _i < _a.length; _i++) {\r\n            var path = _a[_i];\r\n            point = path.point3f;\r\n            if (!(point.y === lastPos.y && point.x === lastPos.x)) {\r\n                angle = Math.atan2(point.y - lastPos.y, point.x - lastPos.x) * (180 / Math.PI);\r\n            }\r\n            now += duration;\r\n            duration = path.timestemp - now;\r\n            paths.push({\r\n                x: point.x,\r\n                y: point.y,\r\n                duration: duration,\r\n                onStartParams: angle,\r\n                onStart: function (tween, target, params) {\r\n                    _this.onCheckDirection(params);\r\n                },\r\n            });\r\n            lastPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](point.x, point.y);\r\n            index++;\r\n        }\r\n        this.mMoveData.posPath = paths;\r\n        this._doMove();\r\n    };\r\n    Element.prototype.startMove = function () {\r\n        this.changeState(PlayerState.WALK);\r\n    };\r\n    Element.prototype.stopMove = function () {\r\n        this.mMoving = false;\r\n        if (!this.mDisplay) {\r\n            // Logger.getInstance().error(`can\'t stopMove, display does not exist`);\r\n            return;\r\n        }\r\n        if (this.mMoveData && this.mMoveData.posPath) {\r\n            this.mModel.setPosition(this.mDisplay.x, this.mDisplay.y);\r\n            // delete this.mMoveData.destPos;\r\n            delete this.mMoveData.posPath;\r\n            if (this.mMoveData.arrivalTime)\r\n                this.mMoveData.arrivalTime = 0;\r\n            if (this.mMoveData.tweenLineAnim) {\r\n                this.mMoveData.tweenLineAnim.stop();\r\n                this.mMoveData.tweenLineAnim.destroy();\r\n            }\r\n        }\r\n        this.changeState(PlayerState.IDLE);\r\n    };\r\n    Element.prototype.getPosition = function () {\r\n        var pos;\r\n        if (!this.mDisplay) {\r\n            return new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](0, 0);\r\n        }\r\n        if (this.mRootMount) {\r\n            pos = this.mRootMount.getPosition();\r\n            pos.x += this.mDisplay.x;\r\n            pos.y += this.mDisplay.y;\r\n            pos.z += this.mDisplay.z;\r\n        }\r\n        else {\r\n            pos = new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](this.mDisplay.x, this.mDisplay.y, this.mDisplay.z);\r\n        }\r\n        return pos;\r\n    };\r\n    Element.prototype.setPosition = function (p) {\r\n        if (this.mMoving) {\r\n            this.stopMove();\r\n        }\r\n        if (this.mDisplay && p) {\r\n            this.mModel.setPosition(p.x, p.y);\r\n            if (this.mRootMount) {\r\n                return;\r\n            }\r\n            this.mDisplay.setPosition(p.x, p.y, p.z);\r\n            var depth = p.depth ? p.depth : 0;\r\n            this.setDepth(depth);\r\n        }\r\n        this.updateBlock();\r\n    };\r\n    Element.prototype.getRootPosition = function () {\r\n        return new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](this.mDisplay.x, this.mDisplay.y, 0);\r\n    };\r\n    Element.prototype.showBubble = function (text, setting) {\r\n        var scene = this.mElementManager.scene;\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        if (!this.mBubble) {\r\n            this.mBubble = new _bubble_bubble_container__WEBPACK_IMPORTED_MODULE_6__["BubbleContainer"](scene, this.roomService.world.scaleRatio);\r\n        }\r\n        this.mBubble.addBubble(text, setting);\r\n        this.updateBubble();\r\n        this.roomService.addToSceneUI(this.mBubble);\r\n    };\r\n    Element.prototype.clearBubble = function () {\r\n        if (!this.mBubble) {\r\n            return;\r\n        }\r\n        this.mBubble.destroy();\r\n        this.mBubble = null;\r\n    };\r\n    Element.prototype.showNickName = function () {\r\n        if (this.mDisplay && this.model) {\r\n            this.mDisplay.showNickname(this.model.nickname);\r\n        }\r\n    };\r\n    Element.prototype.showEffected = function (displayInfo, field) {\r\n        if (displayInfo && this.mDisplay) {\r\n            var key = displayInfo.gene;\r\n            // this.mDisplay.once(key, this.onDisplayReady, this);\r\n            this.mDisplay.load(displayInfo, _display_display_object__WEBPACK_IMPORTED_MODULE_8__["DisplayField"].Effect);\r\n        }\r\n    };\r\n    Element.prototype.showNickname = function () {\r\n        if (this.model && this.mDisplay) {\r\n            this.mDisplay.showNickname(this.model.nickname);\r\n        }\r\n    };\r\n    Element.prototype.turn = function () {\r\n        if (!this.mModel) {\r\n            return;\r\n        }\r\n        this.mModel.turn();\r\n        if (this.mDisplay)\r\n            this.mDisplay.play(this.mModel.currentAnimation);\r\n    };\r\n    Element.prototype.setAlpha = function (val) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mDisplay.setAlpha(val);\r\n    };\r\n    Element.prototype.mount = function (root) {\r\n        this.mRootMount = root;\r\n        this.removeFromBlock(true);\r\n        if (this.mMoving) {\r\n            this.stopMove();\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.unmount = function () {\r\n        if (this.mRootMount && this.mDisplay) {\r\n            // 先移除避免人物瞬移\r\n            this.removeDisplay();\r\n            var pos = this.mRootMount.getPosition();\r\n            pos.x += this.mDisplay.x;\r\n            pos.y += this.mDisplay.y;\r\n            this.mRootMount = null;\r\n            this.setPosition(pos);\r\n            this.addToBlock();\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.addMount = function (ele, index) {\r\n        if (!this.mMounts)\r\n            this.mMounts = [];\r\n        ele.mount(this);\r\n        if (this.mDisplay) {\r\n            this.mDisplay.mount(ele.getDisplay(), index);\r\n        }\r\n        if (this.mMounts.indexOf(ele) === -1) {\r\n            this.mMounts.push(ele);\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.removeMount = function (ele) {\r\n        ele.unmount();\r\n        if (!this.mMounts)\r\n            return this;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.unmount(ele.getDisplay());\r\n        }\r\n        var index = this.mMounts.indexOf(ele);\r\n        if (index > -1) {\r\n            this.mMounts.splice(index, 1);\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.setState = function (states) {\r\n        for (var _i = 0, states_1 = states; _i < states_1.length; _i++) {\r\n            var state = states_1[_i];\r\n            switch (state.execCode) {\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].ExecCode.EXEC_CODE_ADD:\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].ExecCode.EXEC_CODE_UPDATE:\r\n                    this.updateStateHandler(state);\r\n                    break;\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].ExecCode.EXEC_CODE_DELETE:\r\n                    this.removeStateHandler(state);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    Element.prototype.getDepth = function () {\r\n        var depth = 0;\r\n        if (this.model && this.model.pos) {\r\n            depth = this.model.pos.depth ? this.model.pos.depth : 0;\r\n        }\r\n        return depth;\r\n    };\r\n    Element.prototype.destroy = function () {\r\n        if (this.mMoveData && this.mMoveData.tweenAnim) {\r\n            this.mMoveData.tweenAnim.stop();\r\n            this.mMoveData.tweenAnim.remove();\r\n            this.mMoveData.tweenAnim = null;\r\n            this.mMoveData = null;\r\n        }\r\n        if (this.mDisplay) {\r\n            if (this.mBlockable) {\r\n                this.roomService.removeBlockObject(this);\r\n            }\r\n            this.mDisplay.destroy();\r\n            this.mDisplay = null;\r\n        }\r\n        if (this.mBubble) {\r\n            this.mBubble.destroy();\r\n            this.mBubble = undefined;\r\n        }\r\n        if (this.mShopEntity) {\r\n            this.mShopEntity.destroy();\r\n            this.mShopEntity = null;\r\n        }\r\n        if (this.mAi) {\r\n            this.mAi.destroy();\r\n            this.mAi = null;\r\n        }\r\n        // if (this.concomitants) {\r\n        //     for (const ele of this.concomitants) {\r\n        //         ele.destroy();\r\n        //     }\r\n        //     this.concomitants.length = 0;\r\n        //     this.concomitants = null;\r\n        // }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Element.prototype._doMove = function () {\r\n        var _this = this;\r\n        if (!this.mMoveData.posPath) {\r\n            return;\r\n        }\r\n        // const tw: Tweens.Tween = this.mMoveData.tweenAnim;\r\n        // if (tw) {\r\n        //     tw.stop();\r\n        //     tw.remove();\r\n        // }\r\n        // const time: number = this.mMoveData.arrivalTime - this.roomService.now();\r\n        // this.mMoveData.tweenAnim = this.mElementManager.scene.tweens.add({\r\n        //     targets: this.mDisplay,\r\n        //     duration: time,\r\n        //     ease: "Linear",\r\n        //     props: {\r\n        //         x: { value: this.mMoveData.destPos.x },\r\n        //         y: { value: this.mMoveData.destPos.y }\r\n        //     },\r\n        //     onStart: () => {\r\n        //         this.onMoveStart();\r\n        //     },\r\n        //     onComplete: (tween, targets, element) => {\r\n        //         this.onMoveComplete();\r\n        //     },\r\n        //     onUpdate: (tween, targets, element) => {\r\n        //         this.onMoving();\r\n        //     },\r\n        //     onCompleteParams: [this]\r\n        // });\r\n        var line = this.mMoveData.tweenLineAnim;\r\n        if (line) {\r\n            line.stop();\r\n            line.destroy();\r\n        }\r\n        var posPath = this.mMoveData.posPath;\r\n        // for (const path of posPath) {\r\n        //     path.onStart = () => {\r\n        //         this.onMoveStart();\r\n        //     }\r\n        // }\r\n        // const time: number = (this.mMoveData.arrivalTime - this.roomService.now());\r\n        this.mMoveData.tweenLineAnim = this.mElementManager.scene.tweens.timeline({\r\n            targets: this.mDisplay,\r\n            ease: "Linear",\r\n            tweens: posPath,\r\n            onStart: function () {\r\n                _this.onMoveStart();\r\n            },\r\n            onComplete: function () {\r\n                _this.onMoveComplete();\r\n            },\r\n            onUpdate: function () {\r\n                _this.onMoving();\r\n            },\r\n            onCompleteParams: [this],\r\n        });\r\n    };\r\n    Element.prototype.createDisplay = function () {\r\n        if (!this.mDisplayInfo) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("displayinfo does not exist, Create " + this.model.nickname + " failed");\r\n            return;\r\n        }\r\n        if (this.mDisplay) {\r\n            return this.mDisplay;\r\n        }\r\n        var scene = this.mElementManager.scene;\r\n        if (scene) {\r\n            if (this.mDisplayInfo.discriminator === "DragonbonesModel") {\r\n                this.mDisplay = new _display_dragonbones_display__WEBPACK_IMPORTED_MODULE_0__["DragonbonesDisplay"](scene, this.mElementManager.roomService, this);\r\n            }\r\n            else {\r\n                this.mDisplay = new _display_frames_display__WEBPACK_IMPORTED_MODULE_1__["FramesDisplay"](scene, this.mElementManager.roomService, this);\r\n            }\r\n            var pos = this.mModel.pos;\r\n            if (pos)\r\n                this.mDisplay.setPosition(pos.x, pos.y, pos.z);\r\n            this.addToBlock();\r\n        }\r\n        return this.mDisplay;\r\n    };\r\n    Element.prototype.loadDisplayInfo = function () {\r\n        if (!this.mDisplayInfo) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            this.createDisplay();\r\n        }\r\n        this.mDisplay.once("initialized", this.onDisplayReady, this);\r\n        this.mDisplay.on("updateAnimation", this.onUpdateAnimationHandler, this);\r\n        this.mDisplay.load(this.mDisplayInfo);\r\n    };\r\n    Element.prototype.addDisplay = function () {\r\n        this.createDisplay();\r\n        var room = this.roomService;\r\n        if (!room || !this.mDisplay) {\r\n            // Logger.getInstance().error("roomService is undefined");\r\n            return;\r\n        }\r\n        room.addToSurface(this.mDisplay);\r\n        var depth = 0;\r\n        if (this.model && this.model.pos) {\r\n            depth = this.model.pos.depth ? this.model.pos.depth : 0;\r\n        }\r\n        this.setDepth(depth);\r\n    };\r\n    Element.prototype.setDepth = function (depth) {\r\n        if (this.mDisplay) {\r\n            // this.mDisplay.setDepth(depth);\r\n            if (!this.roomService) {\r\n                throw new Error("roomService is undefined");\r\n            }\r\n            var layerManager = this.roomService.layerManager;\r\n            if (!layerManager) {\r\n                throw new Error("layerManager is undefined");\r\n            }\r\n            layerManager.depthSurfaceDirty = true;\r\n        }\r\n    };\r\n    Element.prototype.onDisplayReady = function (field) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.play(this.model.currentAnimation);\r\n            // if (!field || field === DisplayField.STAGE) {\r\n            if (this.mModel.mountSprites && this.mModel.mountSprites.length > 0) {\r\n                this.updateMounth(this.mModel.mountSprites);\r\n            }\r\n            var depth = 0;\r\n            if (this.model && this.model.pos) {\r\n                depth = this.model.pos.depth ? this.model.pos.depth : 0;\r\n            }\r\n            this.setDepth(depth);\r\n        }\r\n        // this.mDisplay.showRefernceArea();\r\n        // }\r\n    };\r\n    Element.prototype.onUpdateAnimationHandler = function () {\r\n        if (this.mDisplay) {\r\n            this.setInputEnable(this.mInputEnable);\r\n        }\r\n    };\r\n    Element.prototype.updateBubble = function () {\r\n        if (!this.mBubble) {\r\n            return;\r\n        }\r\n        var position = this.getPosition();\r\n        if (!position) {\r\n            return;\r\n        }\r\n        this.mBubble.updatePos(position.x, position.y - 80);\r\n    };\r\n    Element.prototype.onMoveStart = function () {\r\n        this.mMoving = true;\r\n    };\r\n    Element.prototype.onMoveComplete = function () {\r\n        // if (this.mMoveData.tweenLineAnim) this.mMoveData.tweenLineAnim.stop();\r\n        this.stopMove();\r\n    };\r\n    Element.prototype.onMoving = function () {\r\n        var now = this.roomService.now();\r\n        if (now - (this.mMoveData.tweenLastUpdate || 0) >= 50) {\r\n            // let depth = 0;\r\n            // if (this.model && this.model.pos) {\r\n            //     depth = this.model.pos.depth ? this.model.pos.depth : 0;\r\n            // }\r\n            this.setDepth(0);\r\n            this.mMoveData.tweenLastUpdate = now;\r\n            this.updateBubble();\r\n            // if (this.mDisplay) this.mDisplay.emit("posChange", this.scene);\r\n            if (this.mBlockable) {\r\n                this.roomService.updateBlockObject(this);\r\n                // this.roomService.addBlockObject()\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(Element.prototype, "offsetY", {\r\n        get: function () {\r\n            if (this.mOffsetY === undefined) {\r\n                if (!this.mElementManager ||\r\n                    !this.mElementManager.roomService ||\r\n                    !this.mElementManager.roomService.roomSize) {\r\n                    return 0;\r\n                }\r\n                // this.mOffsetY = 0;\r\n                this.mOffsetY = this.mElementManager.roomService.roomSize.tileHeight >> 2;\r\n            }\r\n            return 0; // this.mOffsetY;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Element.prototype.onCheckDirection = function (params) {\r\n        if (typeof params !== "number") {\r\n            return;\r\n        }\r\n        var direction = this.calculateDirectionByAngle(params);\r\n        if (direction !== -1) {\r\n            this.setDirection(direction);\r\n        }\r\n    };\r\n    Element.prototype.calculateDirectionByAngle = function (angle) {\r\n        var direction = -1;\r\n        if (angle > 90) {\r\n            direction = 3;\r\n        }\r\n        else if (angle >= 0) {\r\n            direction = 5;\r\n        }\r\n        else if (angle >= -90) {\r\n            direction = 7;\r\n        }\r\n        else {\r\n            direction = 1;\r\n        }\r\n        return direction;\r\n    };\r\n    Element.prototype.mergeMounth = function (mounts) {\r\n        var oldMounts = this.mModel.mountSprites || [];\r\n        var room = this.mRoomService;\r\n        for (var _i = 0, oldMounts_1 = oldMounts; _i < oldMounts_1.length; _i++) {\r\n            var id = oldMounts_1[_i];\r\n            if (mounts.indexOf(id) === -1) {\r\n                var ele = room.getElement(id);\r\n                if (ele) {\r\n                    this.removeMount(ele);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Element.prototype.updateMounth = function (mounts) {\r\n        var room = this.mRoomService;\r\n        if (mounts.length > 0) {\r\n            for (var i = 0; i < mounts.length; i++) {\r\n                var ele = room.getElement(mounts[i]);\r\n                if (ele) {\r\n                    this.addMount(ele, i);\r\n                }\r\n            }\r\n            // const playerManager = this.mElementManager.roomService;\r\n        }\r\n        this.mModel.mountSprites = mounts;\r\n    };\r\n    Element.prototype.updateStateHandler = function (state) {\r\n        switch (state.name) {\r\n            case "effect":\r\n                var buf = buffer___WEBPACK_IMPORTED_MODULE_10__["Buffer"].from(state.packet);\r\n                var id = buf.readDoubleBE(0);\r\n                var effect = this.roomService.effectManager.get(id);\r\n                if (effect.displayInfo) {\r\n                    this.showEffected(effect.displayInfo);\r\n                }\r\n                else {\r\n                    effect.once("updateDisplayInfo", this.showEffected, this);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n    Element.prototype.removeStateHandler = function (state) {\r\n        switch (state.name) {\r\n            case "effect":\r\n                // remove\r\n                if (this.mDisplay) {\r\n                    this.mDisplay.removeEffect(_display_display_object__WEBPACK_IMPORTED_MODULE_8__["DisplayField"].Effect);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n    return Element;\r\n}(_cameras_block_object__WEBPACK_IMPORTED_MODULE_5__["BlockObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/element.ts?')},"./src/rooms/element/frame.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FrameManager", function() { return FrameManager; });\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n\r\nvar FrameManager = /** @class */ (function () {\r\n    function FrameManager() {\r\n        this.handlers = [];\r\n    }\r\n    FrameManager.prototype.add = function (caller, method, args) {\r\n        this.remove(caller, method);\r\n        var handler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_0__["Handler"](caller, method, args);\r\n        this.handlers.push(handler);\r\n    };\r\n    FrameManager.prototype.remove = function (caller, method) {\r\n        var removeid = -1;\r\n        for (var i = 0; i < this.handlers.length; i++) {\r\n            var item = this.handlers[i];\r\n            if (item.caller === caller && item.method === method) {\r\n                removeid = i;\r\n                break;\r\n            }\r\n        }\r\n        if (removeid !== -1) {\r\n            var hander = this.handlers.splice(removeid, 1)[0];\r\n            hander.clear();\r\n        }\r\n    };\r\n    FrameManager.prototype.update = function (time, delta) {\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.runWith([time, delta]);\r\n        }\r\n    };\r\n    FrameManager.prototype.destroy = function () {\r\n        for (var _i = 0, _a = this.handlers; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.clear();\r\n        }\r\n        this.handlers.length = 0;\r\n    };\r\n    FrameManager.prototype.hasRegistered = function (caller, method) {\r\n        var removeid = -1;\r\n        for (var i = 0; i < this.handlers.length; i++) {\r\n            var item = this.handlers[i];\r\n            if (item.caller === caller && item.method === method) {\r\n                removeid = i;\r\n                break;\r\n            }\r\n        }\r\n        return (removeid !== -1);\r\n    };\r\n    return FrameManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/frame.manager.ts?')},"./src/rooms/element/shop/shop.entity.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopEntity", function() { return ShopEntity; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _shop_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shop.model */ "./src/rooms/element/shop/shop.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ShopEntity = /** @class */ (function (_super) {\r\n    __extends(ShopEntity, _super);\r\n    function ShopEntity(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        _this.mInitialize = false;\r\n        _this.mConnect = _this.mWorld.connection;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QUERY_PACKAGE, _this.handlerQueryPackage);\r\n        _this.mShopModel = new _shop_model__WEBPACK_IMPORTED_MODULE_1__["ShopModel"]();\r\n        return _this;\r\n    }\r\n    ShopEntity.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    ShopEntity.prototype.register = function () {\r\n        this.mConnect.addPacketListener(this);\r\n    };\r\n    ShopEntity.prototype.unRegister = function () {\r\n        this.mConnect.removePacketListener(this);\r\n    };\r\n    ShopEntity.prototype.destroy = function () {\r\n        this.unRegister();\r\n        this.mShopModel = null;\r\n        this.mInitialize = false;\r\n        this.mConnect = null;\r\n    };\r\n    ShopEntity.prototype.handlerQueryPackage = function (packet) {\r\n        var notice = packet.content;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].QUERY_PACKAGE, notice);\r\n    };\r\n    ShopEntity.NAME = "ShopModel";\r\n    return ShopEntity;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/shop/shop.entity.ts?')},"./src/rooms/element/shop/shop.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopModel", function() { return ShopModel; });\nvar ShopModel = /** @class */ (function () {\r\n    function ShopModel() {\r\n    }\r\n    return ShopModel;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/shop/shop.model.ts?')},"./src/rooms/element/sprite.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Sprite", function() { return Sprite; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _display_dragonbones_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _display_frames_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../display/frames.model */ "./src/rooms/display/frames.model.ts");\n/* harmony import */ var _display_animation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../display/animation */ "./src/rooms/display/animation.ts");\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/helpers */ "./src/utils/helpers.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _element__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./element */ "./src/rooms/element/element.ts");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Sprite = /** @class */ (function () {\r\n    function Sprite(obj, nodeType) {\r\n        this.mID = obj.id;\r\n        if (obj.point3f) {\r\n            var point = obj.point3f;\r\n            this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](point.x, point.y, point.z);\r\n        }\r\n        this.mAttrs = obj.attrs;\r\n        if (obj.avatar) {\r\n            this.updateAvatar(obj.avatar);\r\n            // if (attrs && attrs.length > 0) {\r\n            //     for (const att of attrs) {\r\n            //         if (att.key === "minecart") {\r\n            //             this.mAvatar.stalkerId = att.value;\r\n            //         }\r\n            //     }\r\n            // }\r\n        }\r\n        if (obj.display) {\r\n            this.updateDisplay(obj.display, obj.animations, obj.currentAnimationName);\r\n        }\r\n        if (obj.sn) {\r\n            this.mSn = obj.sn;\r\n        }\r\n        this.tryRegisterAnimation(obj.animationRegistrationMap);\r\n        this.mCurrentAnimationName = obj.currentAnimationName || "idle";\r\n        this.direction = obj.direction || 3;\r\n        this.mNickname = obj.nickname;\r\n        this.mBindID = obj.bindId;\r\n        this.mAlpha = obj.opacity === undefined ? 1 : obj.opacity / 100;\r\n        this.mDisplayBadgeCards = obj.displayBadgeCards;\r\n        this.mNodeType = nodeType;\r\n        if (obj.version) {\r\n            this.mVersion = obj.version;\r\n        }\r\n        if (obj.isMoss !== undefined) {\r\n            this.isMoss = obj.isMoss;\r\n        }\r\n        this.mMountSprites = obj.mountSprites;\r\n    }\r\n    Sprite.prototype.toSprite = function () {\r\n        var sprite = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].Sprite.create();\r\n        sprite.id = this.id;\r\n        sprite.nickname = this.mNickname;\r\n        if (this.mDisplayInfo instanceof _display_frames_model__WEBPACK_IMPORTED_MODULE_3__["FramesModel"]) {\r\n            sprite.display = this.mDisplayInfo.display;\r\n            sprite.currentAnimationName = this.currentAnimationName;\r\n            var point3f = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].PBPoint3f.create();\r\n            point3f.x = this.pos.x;\r\n            point3f.y = this.pos.y;\r\n            point3f.z = this.pos.z;\r\n            sprite.point3f = point3f;\r\n            sprite.animations = this.displayInfo.createProtocolObject();\r\n        }\r\n        sprite.direction = this.direction;\r\n        sprite.bindId = this.bindID;\r\n        sprite.sn = this.sn;\r\n        sprite.version = this.mVersion;\r\n        return sprite;\r\n    };\r\n    Sprite.prototype.newID = function () {\r\n        this.mID = _utils_helpers__WEBPACK_IMPORTED_MODULE_5__["default"].genId();\r\n    };\r\n    Sprite.prototype.setPosition = function (x, y) {\r\n        if (!this.mPos) {\r\n            this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mPos.x = x;\r\n        this.mPos.y = y;\r\n    };\r\n    Sprite.prototype.turn = function () {\r\n        if (!this.mDisplayInfo) {\r\n            return;\r\n        }\r\n        var dirable = this.dirable(this.mCurrentAnimationName);\r\n        var index = dirable.indexOf(this.mDirection);\r\n        if (index > -1) {\r\n            this.direction = dirable[(index + 1) % dirable.length];\r\n        }\r\n        else {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().error(Sprite.name + ": error dir " + this.mDirection);\r\n        }\r\n        return this;\r\n    };\r\n    Sprite.prototype.updateAvatar = function (avatar) {\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.destroy();\r\n        }\r\n        this.mAvatar = { id: avatar.id };\r\n        this.mAvatar = Object.assign(this.mAvatar, avatar);\r\n        this.mDisplayInfo = new _display_dragonbones_model__WEBPACK_IMPORTED_MODULE_1__["DragonbonesModel"](this);\r\n    };\r\n    Sprite.prototype.updateDisplay = function (display, animations, defAnimation) {\r\n        if (!display || !animations) {\r\n            return;\r\n        }\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.destroy();\r\n        }\r\n        if (display) {\r\n            var anis = [];\r\n            var objAnis = animations;\r\n            for (var _i = 0, objAnis_1 = objAnis; _i < objAnis_1.length; _i++) {\r\n                var ani = objAnis_1[_i];\r\n                anis.push(new _display_animation__WEBPACK_IMPORTED_MODULE_4__["Animation"](ani));\r\n            }\r\n            defAnimation = defAnimation || this.mCurrentAnimationName || "";\r\n            this.mDisplayInfo = new _display_frames_model__WEBPACK_IMPORTED_MODULE_3__["FramesModel"]({\r\n                animations: {\r\n                    defaultAnimationName: defAnimation,\r\n                    display: display,\r\n                    animationData: anis,\r\n                },\r\n                id: this.id\r\n            });\r\n            if (defAnimation) {\r\n                this.currentAnimationName = defAnimation;\r\n            }\r\n        }\r\n    };\r\n    Sprite.prototype.setAnimationQueue = function (queue) {\r\n        this.mAnimationQueue = queue;\r\n    };\r\n    Sprite.prototype.setMountSprites = function (ids) {\r\n        this.mMountSprites = ids;\r\n    };\r\n    Sprite.prototype.updateAttr = function (attrs) {\r\n        this.mAttrs = attrs;\r\n    };\r\n    Sprite.prototype.setAnimationName = function (name) {\r\n        if (this.mDisplayInfo) {\r\n            this.mDisplayInfo.animationName = name;\r\n        }\r\n        this.mCurrentAnimationName = name;\r\n        var ani = this.setAnimationData(name, this.direction);\r\n        return ani;\r\n    };\r\n    Object.defineProperty(Sprite.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "pos", {\r\n        get: function () {\r\n            return this.mPos;\r\n        },\r\n        set: function (pos) {\r\n            this.mPos = pos;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "avatar", {\r\n        get: function () {\r\n            return this.mAvatar;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentAnimationName", {\r\n        get: function () {\r\n            return this.mCurrentAnimationName;\r\n        },\r\n        set: function (animationName) {\r\n            if (this.mDisplayInfo) {\r\n                this.mDisplayInfo.animationName = animationName;\r\n            }\r\n            this.mCurrentAnimationName = animationName;\r\n            this.setAnimationData(animationName, this.direction);\r\n            // this.mCurrentAnimation = this.findAnimation(animationName, this.mDirection);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "direction", {\r\n        get: function () {\r\n            return this.mDirection;\r\n        },\r\n        set: function (val) {\r\n            this.mDirection = val || 3;\r\n            if (!this.mDisplayInfo) {\r\n                return;\r\n            }\r\n            this.setAnimationData(this.mCurrentAnimationName, this.mDirection);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "nickname", {\r\n        get: function () {\r\n            return this.mNickname;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "bindID", {\r\n        get: function () {\r\n            return this.mBindID;\r\n        },\r\n        set: function (id) {\r\n            this.mBindID = id;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "sn", {\r\n        get: function () {\r\n            return this.mSn;\r\n        },\r\n        set: function (value) {\r\n            this.mSn = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "alpha", {\r\n        get: function () {\r\n            return this.mAlpha;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "package", {\r\n        get: function () {\r\n            return this.mPackage;\r\n        },\r\n        set: function (value) {\r\n            this.mPackage = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "sceneId", {\r\n        get: function () {\r\n            return this.mSceneId;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "uuid", {\r\n        get: function () {\r\n            return this.mUuid;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "displayBadgeCards", {\r\n        get: function () {\r\n            return this.mDisplayBadgeCards;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "platformId", {\r\n        get: function () {\r\n            return this.mPlatformId;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "displayInfo", {\r\n        get: function () {\r\n            return this.mDisplayInfo;\r\n        },\r\n        set: function (displayInfo) {\r\n            this.mDisplayInfo = displayInfo;\r\n            if (this.currentAnimationName) {\r\n                this.mDisplayInfo.animationName = this.currentAnimationName;\r\n                this.setAnimationData(this.currentAnimationName, this.direction);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "isMoss", {\r\n        get: function () {\r\n            return this.mIsMoss;\r\n        },\r\n        set: function (val) {\r\n            this.mIsMoss = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "animationQueue", {\r\n        get: function () {\r\n            return this.mAnimationQueue;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "nodeType", {\r\n        get: function () {\r\n            return this.mNodeType;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentAnimation", {\r\n        get: function () {\r\n            return this.mCurrentAnimation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentCollisionArea", {\r\n        get: function () {\r\n            if (!this.mCurrentCollisionArea) {\r\n                this.mCurrentCollisionArea = this.getCollisionArea();\r\n            }\r\n            return this.mCurrentCollisionArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentWalkableArea", {\r\n        get: function () {\r\n            if (!this.mCurrentWalkableArea) {\r\n                this.mCurrentWalkableArea = this.getWalkableArea();\r\n            }\r\n            return this.mCurrentWalkableArea;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "currentCollisionPoint", {\r\n        get: function () {\r\n            if (!this.mCurrentCollisionPoint) {\r\n                this.mCurrentCollisionPoint = this.getOriginPoint();\r\n            }\r\n            return this.mCurrentCollisionPoint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "hasInteractive", {\r\n        get: function () {\r\n            if (!this.mDisplayInfo || !this.mCurrentAnimation) {\r\n                return false;\r\n            }\r\n            var animationName = this.mCurrentAnimation.name;\r\n            var area = this.mDisplayInfo.getInteractiveArea(animationName);\r\n            if (area && area.length > 0) {\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "mountSprites", {\r\n        get: function () {\r\n            return this.mMountSprites;\r\n        },\r\n        set: function (ids) {\r\n            this.mMountSprites = ids;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "animationMap", {\r\n        get: function () {\r\n            if (!this.mRegisterAnimation) {\r\n                this.mRegisterAnimation = new Map();\r\n            }\r\n            return this.mRegisterAnimation;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "originCollisionPoint", {\r\n        get: function () {\r\n            return this._originCollisionPoint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "originWalkPoint", {\r\n        get: function () {\r\n            return this._originWalkPoint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Sprite.prototype, "attrs", {\r\n        get: function () {\r\n            return this.mAttrs;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Sprite.prototype.setOriginCollisionPoint = function (value) {\r\n        if (this._originCollisionPoint === undefined) {\r\n            this._originCollisionPoint = new Phaser.Geom.Point();\r\n        }\r\n        if (value && value.length > 1) {\r\n            this._originCollisionPoint.x = value[0];\r\n            this._originCollisionPoint.y = value[1];\r\n        }\r\n    };\r\n    Sprite.prototype.setOriginWalkPoint = function (value) {\r\n        if (this._originWalkPoint === undefined) {\r\n            this._originWalkPoint = new Phaser.Geom.Point();\r\n        }\r\n        if (value && value.length > 1) {\r\n            this._originWalkPoint.x = value[0];\r\n            this._originWalkPoint.y = value[1];\r\n        }\r\n    };\r\n    Sprite.prototype.getInteracviveArea = function () {\r\n        if (!this.mDisplayInfo || !this.mCurrentAnimation) {\r\n            return;\r\n        }\r\n        var animationName = this.mCurrentAnimation.name;\r\n        return this.mDisplayInfo.getInteractiveArea(animationName);\r\n    };\r\n    Sprite.prototype.setAnimationData = function (animationName, direction) {\r\n        if (!this.displayInfo) {\r\n            return;\r\n        }\r\n        var baseAniName = animationName.split("_")[0];\r\n        if (this.mRegisterAnimation) {\r\n            if (this.mRegisterAnimation.has(baseAniName)) {\r\n                baseAniName = this.mRegisterAnimation.get(baseAniName);\r\n            }\r\n        }\r\n        this.mCurrentAnimation = this.displayInfo.findAnimation(baseAniName, direction);\r\n        if (this.mAnimationQueue && this.mAnimationQueue.length > 0)\r\n            this.mCurrentAnimation.playingQueue = this.mAnimationQueue[0];\r\n        if (this.mCurrentCollisionArea) {\r\n            this.setArea();\r\n        }\r\n        return this.mCurrentAnimation;\r\n        // Logger.getInstance().log("play animation name: ", this.mCurrentAnimation.animationName, this.mCurrentAnimation.flip, this.mDirection);\r\n        // if (animationName !== this.mCurrentAnimation.animationName) {\r\n        //     Logger.getInstance().error(`${Sprite.name}: play animationName: ${this.mCurrentAnimation.animationName}, recieve: ${this.mCurrentAnimationName}, direction: ${direction}`);\r\n        // }\r\n    };\r\n    Sprite.prototype.checkDirectionAnimation = function (baseAniName, dir) {\r\n        var aniName = baseAniName + "_" + dir;\r\n        if (this.mDisplayInfo.existAnimation(aniName)) {\r\n            return aniName;\r\n        }\r\n        return null;\r\n    };\r\n    Sprite.prototype.setArea = function () {\r\n        this.mCurrentCollisionArea = this.getCollisionArea();\r\n        this.mCurrentWalkableArea = this.getWalkableArea();\r\n        this.mCurrentCollisionPoint = this.getOriginPoint();\r\n    };\r\n    Sprite.prototype.getCollisionArea = function () {\r\n        if (!this.mDisplayInfo || !this.mCurrentAnimation) {\r\n            return;\r\n        }\r\n        var _a = this.mCurrentAnimation, animationName = _a.name, flip = _a.flip;\r\n        return this.mDisplayInfo.getCollisionArea(animationName, flip);\r\n    };\r\n    Sprite.prototype.getWalkableArea = function () {\r\n        if (!this.mDisplayInfo || !this.mCurrentAnimation) {\r\n            return;\r\n        }\r\n        var _a = this.mCurrentAnimation, animationName = _a.name, flip = _a.flip;\r\n        return this.mDisplayInfo.getWalkableArea(animationName, flip);\r\n    };\r\n    Sprite.prototype.getOriginPoint = function () {\r\n        if (!this.mDisplayInfo || !this.mCurrentAnimation) {\r\n            return;\r\n        }\r\n        var _a = this.mCurrentAnimation, animationName = _a.name, flip = _a.flip;\r\n        return this.mDisplayInfo.getOriginPoint(animationName, flip);\r\n    };\r\n    Sprite.prototype.dirable = function (aniName) {\r\n        var baseAniName = aniName.split("_")[0];\r\n        var dirs = [3, 5];\r\n        if (this.checkDirectionAnimation(baseAniName, _element__WEBPACK_IMPORTED_MODULE_7__["Direction"].east_north)) {\r\n            dirs.push(7, 1);\r\n            // dirs = [1, 3, 5, 7];\r\n        }\r\n        return dirs;\r\n    };\r\n    Sprite.prototype.tryRegisterAnimation = function (anis) {\r\n        if (!anis || anis.length < 1) {\r\n            return;\r\n        }\r\n        this.mRegisterAnimation = new Map();\r\n        for (var _i = 0, anis_1 = anis; _i < anis_1.length; _i++) {\r\n            var ani = anis_1[_i];\r\n            this.mRegisterAnimation.set(ani.key, ani.value);\r\n        }\r\n    };\r\n    return Sprite;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/element/sprite.ts?')},"./src/rooms/fall.effect/fall.effect.container.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FallEffectContainer", function() { return FallEffectContainer; });\n/* harmony import */ var _fall_effect__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fall.effect */ "./src/rooms/fall.effect/fall.effect.ts");\n\r\nvar FallEffectContainer = /** @class */ (function () {\r\n    function FallEffectContainer(scene, room) {\r\n        this.scene = scene;\r\n        this.room = room;\r\n        this.mFalls = [];\r\n    }\r\n    FallEffectContainer.prototype.addFall = function (pos, enable) {\r\n        if (!pos) {\r\n            return;\r\n        }\r\n        var fall = new _fall_effect__WEBPACK_IMPORTED_MODULE_0__["FallEffect"](this.scene, this.room.world.scaleRatio);\r\n        fall.once("remove", this.onRemoveHandler, this);\r\n        fall.setPosition(pos.x, pos.y);\r\n        this.room.addToSceneUI(fall);\r\n    };\r\n    FallEffectContainer.prototype.onRemoveHandler = function (fall) {\r\n        if (!fall) {\r\n            return;\r\n        }\r\n    };\r\n    return FallEffectContainer;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/fall.effect/fall.effect.container.ts?')},"./src/rooms/fall.effect/fall.effect.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FallEffect", function() { return FallEffect; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar FallEffect = /** @class */ (function (_super) {\r\n    __extends(FallEffect, _super);\r\n    function FallEffect(scene, scaleRatio) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.scale = scaleRatio;\r\n        return _this;\r\n    }\r\n    FallEffect.prototype.show = function (status) {\r\n        this.mStatus = status;\r\n        this.load();\r\n    };\r\n    FallEffect.prototype.load = function () {\r\n        if (this.scene.textures.exists("fall_effect")) {\r\n            this.onCompleteHandler();\r\n        }\r\n        else {\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onCompleteHandler, this);\r\n            this.scene.load.atlas("fall_effect", _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("ui/fall_effect/falleffect.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("ui/fall_effect/falleffect.json"));\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    FallEffect.prototype.showEnable = function () {\r\n        // const config = {\r\n        //     key: "fill_effect_enable",\r\n        //     frames: this.scene.anims.generateFrameNames("fall_effect", { prefix: "enable", end: 6, zeroPad: 2 }),\r\n        //     frameRate: 8,\r\n        //     repeat: 0\r\n        // };\r\n        // this.mDisplay.setPosition(25, -25);\r\n        // this.scene.anims.create(config);\r\n        // this.mDisplay.play("fill_effect_enable");\r\n        this.mDisplay = new EnableDisplay(this.scene, "fall_effect");\r\n        this.add(this.mDisplay);\r\n    };\r\n    FallEffect.prototype.showDisable = function () {\r\n        // this.mDisplay = this.scene.make.sprite({\r\n        //     key: "fall_effect",\r\n        //     frame: "forbid"\r\n        // }, false).setScale(0.5);\r\n        this.mDisplay = new DisableDisplay(this.scene, "fall_effect");\r\n        this.add(this.mDisplay);\r\n    };\r\n    FallEffect.prototype.onCompleteHandler = function () {\r\n        // this.mDisplay = this.scene.make.sprite({\r\n        //     key: "fall_effect",\r\n        // }, false);\r\n        // this.add(this.mDisplay);\r\n        var _this = this;\r\n        if (this.mStatus === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PathReachableStatus.PATH_REACHABLE_AREA || this.mStatus === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PathReachableStatus.PATH_REACHABLE_WITH_INTERACTION_SPRITE) {\r\n            this.showEnable();\r\n        }\r\n        else {\r\n            this.showDisable();\r\n        }\r\n        // if (this.mType === FallType.Enable) {\r\n        //     this.createEnable();\r\n        // } else {\r\n        //     this.createDisable();\r\n        // }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 1000,\r\n            ease: "Expo",\r\n            delay: 1000,\r\n            props: { alpha: 0 },\r\n            onComplete: function () {\r\n                _this.destroy();\r\n                _this.emit("remove", _this);\r\n            }\r\n        });\r\n    };\r\n    return FallEffect;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar EnableDisplay = /** @class */ (function (_super) {\r\n    __extends(EnableDisplay, _super);\r\n    function EnableDisplay(scene, key) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mImage = scene.make.sprite({\r\n            key: key,\r\n            x: 9,\r\n            y: -20\r\n        }, false).setScale(0.5);\r\n        _this.add(_this.mImage);\r\n        // const tween = this.scene.tweens.add({\r\n        //     targets: this.mImage,\r\n        //     duration: 1000,\r\n        //     delay: 600,\r\n        //     props: {\r\n        //         alpha: 0.6\r\n        //     },\r\n        //     onComplete: () => {\r\n        //         tween.destroy();\r\n        //         this.mImage.destroy();\r\n        //         this.mImage = undefined;\r\n        //     }\r\n        // })\r\n        // this.mEllipse = scene.make.graphics(undefined, false);\r\n        // this.mEllipse.fillStyle(0, 0.6);\r\n        // this.mEllipse.fillEllipse(0, 0, 30, 15)\r\n        _this.mEllipse = scene.make.sprite(undefined, false);\r\n        _this.addAt(_this.mEllipse, 0);\r\n        var config = {\r\n            key: "fill_effect_enable",\r\n            frames: _this.scene.anims.generateFrameNames("fall_effect", { prefix: "enable", end: 6, zeroPad: 2 }),\r\n            frameRate: 16,\r\n            repeat: 0\r\n        };\r\n        _this.scene.anims.create(config);\r\n        _this.mImage.play("fill_effect_enable");\r\n        var ellipseConfig = {\r\n            key: "fill_effect_ellipse",\r\n            frames: _this.scene.anims.generateFrameNames("fall_effect", { prefix: "ellipse", end: 7, zeroPad: 2 }),\r\n            frameRate: 10,\r\n            repeat: 0\r\n        };\r\n        _this.scene.anims.create(ellipseConfig);\r\n        _this.mEllipse.play("fill_effect_ellipse");\r\n        return _this;\r\n    }\r\n    return EnableDisplay;\r\n}(Phaser.GameObjects.Container));\r\nvar DisableDisplay = /** @class */ (function (_super) {\r\n    __extends(DisableDisplay, _super);\r\n    function DisableDisplay(scene, key) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mImage = scene.make.image({\r\n            key: key,\r\n            y: -6,\r\n            frame: "disable",\r\n        }, false).setScale(0.5);\r\n        _this.add(_this.mImage);\r\n        _this.mEllipse = scene.make.image({\r\n            key: key,\r\n            frame: "forbid"\r\n        }, false).setScale(0.5);\r\n        _this.add([_this.mImage, _this.mEllipse]);\r\n        return _this;\r\n    }\r\n    return DisableDisplay;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/fall.effect/fall.effect.ts?')},"./src/rooms/group/FollowGroup.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FollowGroup", function() { return FollowGroup; });\n/* harmony import */ var _Handler_HandlerDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Handler/HandlerDispatcher */ "./src/Handler/HandlerDispatcher.ts");\n/* harmony import */ var _GroupManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GroupManager */ "./src/rooms/group/GroupManager.ts");\n\r\n\r\nvar FollowGroup = /** @class */ (function () {\r\n    function FollowGroup() {\r\n        this.groupType = _GroupManager__WEBPACK_IMPORTED_MODULE_1__["GroupType"].Follow;\r\n        this.eventDisp = new _Handler_HandlerDispatcher__WEBPACK_IMPORTED_MODULE_0__["HandlerDispatcher"]();\r\n        this.childs = [];\r\n    }\r\n    FollowGroup.prototype.addChild = function (child) {\r\n        this.removeChild(child);\r\n        this.childs.push(child);\r\n    };\r\n    FollowGroup.prototype.removeChild = function (child) {\r\n        var index = this.childs.indexOf(child);\r\n        if (index !== -1) {\r\n            this.childs.splice(index, 1);\r\n        }\r\n    };\r\n    FollowGroup.prototype.replaceOwner = function (owner) {\r\n        this.owner = owner;\r\n        this.eventDisp.emitter(_GroupManager__WEBPACK_IMPORTED_MODULE_1__["GroupEventType"].REPLACE_TYPE, owner);\r\n    };\r\n    FollowGroup.prototype.emitter = function (type, data) {\r\n        if (!type)\r\n            type = _GroupManager__WEBPACK_IMPORTED_MODULE_1__["GroupEventType"].DEFAULT_TYPE;\r\n        this.eventDisp.emitter(type, data);\r\n    };\r\n    FollowGroup.prototype.on = function (type, caller, method, args) {\r\n        this.eventDisp.on(type, caller, method, args);\r\n    };\r\n    FollowGroup.prototype.off = function (type, caller, method) {\r\n        this.eventDisp.off(type, caller, method);\r\n    };\r\n    FollowGroup.prototype.destroy = function () {\r\n        this.eventDisp.destroy();\r\n        this.childs.length = 0;\r\n        this.owner = null;\r\n        this.data = null;\r\n    };\r\n    return FollowGroup;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/group/FollowGroup.ts?')},"./src/rooms/group/GroupManager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupManager", function() { return GroupManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupType", function() { return GroupType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupEventType", function() { return GroupEventType; });\n/* harmony import */ var _FollowGroup__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FollowGroup */ "./src/rooms/group/FollowGroup.ts");\n\r\nvar GroupManager = /** @class */ (function () {\r\n    function GroupManager(room) {\r\n        this.room = room;\r\n        this.map = new Map();\r\n    }\r\n    GroupManager.prototype.createGroup = function (owner, groupType) {\r\n        if (!this.hasGroup(owner, groupType)) {\r\n            var groups = this.map.get(owner);\r\n            var group = void 0;\r\n            if (!groups) {\r\n                groups = [];\r\n                this.map.set(owner, groups);\r\n            }\r\n            if (groupType === GroupType.Follow) {\r\n                var item = new _FollowGroup__WEBPACK_IMPORTED_MODULE_0__["FollowGroup"]();\r\n                item.owner = owner;\r\n                groups.push(item);\r\n                group = item;\r\n            }\r\n            return group;\r\n        }\r\n    };\r\n    GroupManager.prototype.getGroup = function (owner, groupType) {\r\n        var group;\r\n        if (this.map.has(owner)) {\r\n            var groups = this.map.get(owner);\r\n            for (var _i = 0, groups_1 = groups; _i < groups_1.length; _i++) {\r\n                var item = groups_1[_i];\r\n                if (item.groupType === groupType) {\r\n                    group = item;\r\n                    return group;\r\n                }\r\n            }\r\n        }\r\n        return group;\r\n    };\r\n    GroupManager.prototype.hasGroup = function (owner, groupType) {\r\n        var group = this.getGroup(owner, groupType);\r\n        if (group)\r\n            return true;\r\n        return false;\r\n    };\r\n    GroupManager.prototype.destroy = function () {\r\n        this.map.forEach(function (value, key) {\r\n            for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\r\n                var item = value_1[_i];\r\n                item.destroy();\r\n            }\r\n            value.length = 0;\r\n        });\r\n        this.map.clear();\r\n    };\r\n    return GroupManager;\r\n}());\r\n\r\nvar GroupType;\r\n(function (GroupType) {\r\n    GroupType[GroupType["Follow"] = 1] = "Follow";\r\n})(GroupType || (GroupType = {}));\r\nvar GroupEventType;\r\n(function (GroupEventType) {\r\n    GroupEventType["DEFAULT_TYPE"] = "DEFAULT_TYPE";\r\n    GroupEventType["REPLACE_TYPE"] = "REPLACE_TYPE";\r\n})(GroupEventType || (GroupEventType = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/group/GroupManager.ts?')},"./src/rooms/layer/grid.layer.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GridLayer", function() { return GridLayer; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar GridLayer = /** @class */ (function (_super) {\r\n    __extends(GridLayer, _super);\r\n    function GridLayer(scene) {\r\n        return _super.call(this, scene) || this;\r\n    }\r\n    GridLayer.prototype.draw = function (room) {\r\n        this.clear();\r\n        if (!room || !room.roomSize)\r\n            return;\r\n        this.lineStyle(1, 0xFFFFFF);\r\n        var rows = room.roomSize.rows;\r\n        var cols = room.roomSize.cols;\r\n        for (var i = 0; i <= rows; i++) {\r\n            this.drawLine(room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](0, i)), room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](cols, i)));\r\n        }\r\n        for (var i = 0; i <= cols; i++) {\r\n            this.drawLine(room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](i, 0)), room.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](i, rows)));\r\n        }\r\n    };\r\n    GridLayer.prototype.drawLine = function (startPos, endPos) {\r\n        // this.moveTo(startPos.x, startPos.y);\r\n        // this.lineTo(endPos.x, endPos.y);\r\n        this.lineBetween(startPos.x, startPos.y, endPos.x, endPos.y);\r\n    };\r\n    return GridLayer;\r\n}(Phaser.GameObjects.Graphics));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/layer/grid.layer.ts?')},"./src/rooms/layer/layer.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayerManager", function() { return LayerManager; });\n/* harmony import */ var _grid_layer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./grid.layer */ "./src/rooms/layer/grid.layer.ts");\n\r\nvar LayerManager = /** @class */ (function () {\r\n    function LayerManager(room) {\r\n        this.room = room;\r\n        this.mSurfaceInteractived = true;\r\n        this.mDelta = 0;\r\n        var zoom = 1;\r\n        if (!room) {\r\n            return;\r\n        }\r\n        if (room.world) {\r\n            zoom = room.world.scaleRatio;\r\n        }\r\n        this.mScene = room.scene;\r\n        // ==========背景层\r\n        this.mGroundClickLayer = this.mScene.add.container(0, 0);\r\n        // this.totalLayerList.push(this.mGroundClickLayer);\r\n        this.mUGroundLayer2 = this.mScene.add.container(0, 0);\r\n        // ==========舞台层\r\n        this.mGroundLayer = this.mScene.add.container(0, 0).setScale(zoom);\r\n        this.mTileLayer = new _grid_layer__WEBPACK_IMPORTED_MODULE_0__["GridLayer"](this.mScene).setScale(zoom);\r\n        this.mScene.sys.displayList.add(this.mTileLayer);\r\n        this.mMiddleLayer = this.mScene.add.container(0, 0).setScale(zoom);\r\n        this.mSurfaceLayer = this.mScene.add.container(0, 0).setScale(zoom);\r\n        this.mAtmosphere = this.mScene.add.container(0, 0);\r\n        // ==========UI层\r\n        this.mSceneUILayer = this.mScene.add.container(0, 0);\r\n        this.mUILayer = this.mScene.add.container(0, 0).setScrollFactor(0);\r\n        // this.mUILayer.setInteractive(new Geom.Rectangle(0, 0, window.innerWidth, window.innerHeight), Phaser.Geom.Rectangle.Contains);\r\n    }\r\n    LayerManager.prototype.addToGround = function (ele, index) {\r\n        if (index !== undefined) {\r\n            this.mGroundLayer.addAt(ele, index);\r\n        }\r\n        else {\r\n            if (Array.isArray(ele)) {\r\n                this.mGroundLayer.add(ele);\r\n            }\r\n            else {\r\n                this.mGroundLayer.add([ele]);\r\n            }\r\n        }\r\n        // this.mGroundLayer.add(Array.from(tmp, (display: ElementDisplay) => display.GameObject));\r\n        // Logger.log("terrain num: ", this.mGroundLayer.list.length);\r\n    };\r\n    LayerManager.prototype.addToSurface = function (ele) {\r\n        if (Array.isArray(ele)) {\r\n            this.mSurfaceLayer.add(ele);\r\n        }\r\n        else {\r\n            this.mSurfaceLayer.add([ele]);\r\n        }\r\n        // Logger.log("surface num: ", this.mSurfaceLayer.list.length);\r\n        // this.mSurfaceLayer.add(Array.from(tmp, (display: ElementDisplay) => display.GameObject));\r\n    };\r\n    LayerManager.prototype.addToSceneToUI = function (child) {\r\n        this.mSceneUILayer.add(child);\r\n    };\r\n    LayerManager.prototype.addToUI = function (child) {\r\n        this.mUILayer.add(child);\r\n    };\r\n    LayerManager.prototype.addToAtmosphere = function (child) {\r\n        this.mAtmosphere.add(child);\r\n    };\r\n    LayerManager.prototype.addToMiddle = function (child) {\r\n        this.mMiddleLayer.add(child);\r\n    };\r\n    LayerManager.prototype.resize = function (width, height) {\r\n        // todo\r\n    };\r\n    LayerManager.prototype.addMouseListen = function () {\r\n        // this.mGroundClickLayer.setInteractive(new Geom.Rectangle(0, 0, window.innerWidth, window.innerHeight), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    LayerManager.prototype.sortSurface = function () {\r\n        this.mSurfaceLayer.sort("depth");\r\n    };\r\n    LayerManager.prototype.changeScene = function () {\r\n        this._clearLayer();\r\n    };\r\n    LayerManager.prototype.drawGrid = function (room) {\r\n        if (this.mTileLayer) {\r\n            this.mTileLayer.draw(room);\r\n        }\r\n    };\r\n    LayerManager.prototype.setGridVisible = function (visible) {\r\n        if (this.mTileLayer) {\r\n            this.mTileLayer.setVisible(visible);\r\n        }\r\n    };\r\n    LayerManager.prototype.update = function (time, delta) {\r\n        // if (time - this.mDelta < 3000) {\r\n        //     return;\r\n        // }\r\n        this.mDelta = time;\r\n        if (this.mDepthGround) {\r\n            this.mGroundLayer.sort("depth");\r\n            this.mDepthGround = false;\r\n        }\r\n        if (this.mDepthSurface) {\r\n            this.mDepthSurface = false;\r\n            // this.mSurfaceLayer.sort("depth");\r\n            this.mSurfaceLayer.sort("depth", function (displayA, displayB) {\r\n                // Logger.debug(displayA, displayB);\r\n                // const sortA = displayA.sortRectangle;\r\n                // const sortB = displayB.sortRectangle;\r\n                // Logger.log("sort x: ", displayA, displayA.sortX, displayA.sortY);\r\n                // Logger.log("sortB: ", displayB, displayB.sortX, displayB.sortY);\r\n                var depthA = displayA.depth ? displayA.depth : 0;\r\n                var depthB = displayB.depth ? displayB.depth : 0;\r\n                if (depthA > depthB) {\r\n                    return 1;\r\n                }\r\n                // ---------------根据角度判断深度\r\n                var angle = Math.atan2(displayA.sortY - displayB.sortY, displayA.sortX - displayB.sortX);\r\n                if (angle * (180 * Math.PI) >= 70) {\r\n                    return 1;\r\n                }\r\n                // if (displayA.sortY > displayB.sortY) {\r\n                //     return 1;\r\n                // }\r\n                // if (displayB.y + sortB.top.y > displayA.y + sortA.left.y) {\r\n                //     return 1;\r\n                // }\r\n                return -1;\r\n            });\r\n        }\r\n    };\r\n    LayerManager.prototype.setSurfaceInteractive = function (val) {\r\n        if (this.mSurfaceInteractived === val) {\r\n            return;\r\n        }\r\n        this.mSurfaceInteractived = val;\r\n        var list = this.mSurfaceLayer.list;\r\n        if (val) {\r\n            // this.mSurfaceLayer.setInteractive();\r\n            list.forEach(function (obj) {\r\n                obj.setInteractive();\r\n            });\r\n        }\r\n        else {\r\n            list.forEach(function (obj) {\r\n                obj.disableInteractive();\r\n            });\r\n            // this.mSurfaceLayer.disableInteractive();\r\n        }\r\n    };\r\n    LayerManager.prototype.destroy = function () {\r\n        this.mDelta = 0;\r\n        this._clearLayer();\r\n    };\r\n    LayerManager.prototype._clearLayer = function () {\r\n        this.clearLayer(this.mGroundClickLayer);\r\n        this.clearLayer(this.mGroundLayer);\r\n        this.clearLayer(this.mSurfaceLayer);\r\n        this.clearLayer(this.mUGroundLayer2);\r\n        this.clearLayer(this.mUILayer);\r\n        this.clearLayer(this.mAtmosphere);\r\n        this.mTileLayer.destroy(true);\r\n    };\r\n    LayerManager.prototype.clearLayer = function (container, destroy) {\r\n        if (destroy === void 0) { destroy = false; }\r\n        var list = container.list;\r\n        if (list) {\r\n            var len = list.length;\r\n            var child = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                child = list[i];\r\n                if (child) {\r\n                    child.destroy(destroy);\r\n                    child = null;\r\n                }\r\n            }\r\n        }\r\n        container.destroy(destroy);\r\n    };\r\n    Object.defineProperty(LayerManager.prototype, "depthSurfaceDirty", {\r\n        set: function (val) {\r\n            this.mDepthSurface = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerManager.prototype, "depthGroundDirty", {\r\n        set: function (val) {\r\n            this.mDepthGround = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerManager.prototype, "layer", {\r\n        get: function () {\r\n            return this.mGroundLayer;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return LayerManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/layer/layer.manager.ts?')},"./src/rooms/player/Actor.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Actor", function() { return Actor; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _player__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./player */ "./src/rooms/player/player.ts");\n/* harmony import */ var _bag_bag__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bag/bag */ "./src/rooms/player/bag/bag.ts");\n/* harmony import */ var _interactive_interactive__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./interactive/interactive */ "./src/rooms/player/interactive/interactive.ts");\n/* harmony import */ var _friend_friend__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./friend/friend */ "./src/rooms/player/friend/friend.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _ui_ControlF_ControlFMediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ui/ControlF/ControlFMediator */ "./src/ui/ControlF/ControlFMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Actor = /** @class */ (function (_super) {\r\n    __extends(Actor, _super);\r\n    function Actor(sprite, mElementManager) {\r\n        var _this = _super.call(this, sprite, mElementManager) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mBlockable = false;\r\n        // this.mRenderable = true; // Actor is always renderable!!!\r\n        // this.addDisplay();\r\n        _this.mRoom = _this.mElementManager.roomService;\r\n        if (_this.mRoom.world.inputManager)\r\n            _this.mRoom.world.inputManager.addListener(_this);\r\n        // if (this.mElementManager) {\r\n        //     const roomService = this.mElementManager.roomService;\r\n        //     if (roomService && roomService.cameraService) {\r\n        //         roomService.cameraService.startFollow(this.getDisplay());\r\n        //         roomService.cameraService.syncCameraScroll();\r\n        //     }\r\n        // }\r\n        if (_this.mElementManager) {\r\n            var roomService = _this.mElementManager.roomService;\r\n            if (roomService && roomService.cameraService) {\r\n                var pos = sprite.pos;\r\n                var size = _this.mElementManager.scene.scale;\r\n                roomService.cameraService.setScroll(pos.x * roomService.world.scaleRatio - size.width / 2, pos.y * roomService.world.scaleRatio - size.height / 2);\r\n                roomService.cameraService.syncCameraScroll();\r\n            }\r\n        }\r\n        _this.mFriend = new _friend_friend__WEBPACK_IMPORTED_MODULE_5__["Friend"](_this.mRoom.world);\r\n        _this.mRoom.playerManager.set(_this.id, _this);\r\n        _this.mInteractive = new _interactive_interactive__WEBPACK_IMPORTED_MODULE_4__["Interactive"](mElementManager.roomService.world);\r\n        _this.mInteractive.register();\r\n        return _this;\r\n    }\r\n    Actor.prototype.getBag = function () {\r\n        return this.mBag;\r\n    };\r\n    Actor.prototype.getFriend = function () {\r\n        return this.mFriend;\r\n    };\r\n    Actor.prototype.getInteractive = function () {\r\n        return this.mInteractive;\r\n    };\r\n    // override super\'s method.\r\n    Actor.prototype.setRenderable = function (isRenderable) {\r\n        // do nothing!\r\n        // Actor is always renderable!!!\r\n    };\r\n    Actor.prototype.destroy = function () {\r\n        if (this.mBag) {\r\n            this.mBag.destroy();\r\n            this.mBag = null;\r\n        }\r\n        if (this.mRoom.world.inputManager)\r\n            this.mRoom.world.inputManager.removeListener(this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Actor.prototype.downHandler = function (d, keyList) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.mRoom.playerManager.requestActorMove(d, keyList); // startActorMove();\r\n    };\r\n    Actor.prototype.upHandler = function () {\r\n        // this.mRoom.playerManager.stopActorMove();\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.stopMove();\r\n    };\r\n    Actor.prototype.startMove = function () {\r\n        _super.prototype.startMove.call(this);\r\n        var med = this.mRoom.world.uiManager.getMediator(_ui_ControlF_ControlFMediator__WEBPACK_IMPORTED_MODULE_7__["ControlFMediator"].NAME);\r\n        if (med)\r\n            med.hide();\r\n    };\r\n    Actor.prototype.stopMove = function () {\r\n        _super.prototype.stopMove.call(this);\r\n        if (this.mRoom && this.mRoom.world.moveStyle === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_STOP_SPRITE);\r\n            var ct = pkt.content;\r\n            ct.nodeType = this.nodeType;\r\n            var pos = this.getPosition();\r\n            ct.spritePositions = {\r\n                id: this.id,\r\n                point3f: {\r\n                    x: pos.x,\r\n                    y: pos.y,\r\n                    z: pos.z,\r\n                },\r\n                direction: this.dir\r\n            };\r\n            // Logger.getInstance().debug("nowPox:" + pos.x + "," + pos.y);\r\n            this.mElementManager.connection.send(pkt);\r\n        }\r\n    };\r\n    Actor.prototype.move = function (moveData) {\r\n        // TODO 不能仅判断walk, 移动状态可能还有run\r\n        if (this.mRoom.world.moveStyle === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n            if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            this.startMove();\r\n        }\r\n        _super.prototype.move.call(this, moveData);\r\n    };\r\n    Actor.prototype.movePath = function (movePath) {\r\n        if (this.mRoom.world.moveStyle === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n            if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n                return;\r\n            }\r\n        }\r\n        // movePath.path = [{ x: 885.000000, y: 637.50000}, { x: 915.000000, y: 637.50000}, { x: 945.000000, y: 637.50000}, { x: 975.000000, y: 637.50000}, { x: 1005.00000, y: 637.50000}, { x: 1035.00000, y: 637.50000}, { x: 1065.00000, y: 637.50000}, { x: 1080.00000, y: 645.00000}, { x: 1095.00000, y: 652.50000}, { x: 1110.00000, y: 660.00000}, { x: 1125.00000, y: 667.50000}, { x: 1140.00000, y: 675.00000}, { x: 1155.00000, y: 682.50000}, { x: 1170.00000, y: 690.00000}];\r\n        // movePath.path = [{x: 1140.00000, y: 495.000000}, {x: 1125.00000, y: 502.500000}, {x: 1110.00000, y: 510.000000}, {x: 1095.00000, y: 517.500000}, {x: 1080.00000, y: 525.000000}, {x: 1065.00000, y: 532.500000}, {x: 1050.00000, y: 540.000000}, {x: 1035.00000, y: 547.500000}];\r\n        // movePath.timestemp = 3965;\r\n        var path = movePath.path;\r\n        var now = this.mElementManager.roomService.now();\r\n        var duration = 0;\r\n        var pathAry = path.map(function (value) {\r\n            now += duration;\r\n            duration = value.timestemp - now;\r\n            return {\r\n                x: value.point3f.x, y: value.point3f.y,\r\n                duration: duration,\r\n                timestemp: value.timestemp\r\n            };\r\n        });\r\n        // this.drawPath(movePath.path);\r\n        _super.prototype.movePath.call(this, movePath);\r\n    };\r\n    Actor.prototype.onMoveComplete = function () {\r\n        this.preMoveComplete();\r\n        if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n            this.mMoveData.tweenAnim.stop();\r\n            return;\r\n        }\r\n        if (this.mRoom.world.moveStyle !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n            this.changeState(_element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].IDLE);\r\n            this.stopMove();\r\n        }\r\n        this._doMove();\r\n    };\r\n    Actor.prototype.onMoving = function () {\r\n        if (this.mCurState !== _element_element__WEBPACK_IMPORTED_MODULE_6__["PlayerState"].WALK) {\r\n            this.mMoveData.tweenLineAnim.stop();\r\n            return;\r\n        }\r\n        _super.prototype.onMoving.call(this);\r\n    };\r\n    Actor.prototype.addToBlock = function () {\r\n        this.addDisplay();\r\n    };\r\n    Actor.prototype.drawPath = function (pos) {\r\n        // if (!pos && pos.length > 0) {\r\n        //     return;\r\n        // }\r\n        // if (!this.mMovePath) {\r\n        //     this.mMovePath = this.mElementManager.scene.make.graphics(undefined, false);\r\n        // }\r\n        // this.mMovePath.clear();\r\n        // this.mMovePath.lineStyle(2, 0xFFFF00);\r\n        // this.mMovePath.moveTo(pos[0].point3f.x, pos[0].point3f.y);\r\n        // let point3f = null;\r\n        // for (const point of pos) {\r\n        //     point3f = point.point3f;\r\n        //     if (point3f) this.mMovePath.lineTo(point3f.x, point3f.y);\r\n        // }\r\n        // this.mMovePath.strokePath();\r\n        // this.mRoom.addToSurface(<any> this.mMovePath);\r\n    };\r\n    Object.defineProperty(Actor.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.mModel = val;\r\n            if (!val) {\r\n                return;\r\n            }\r\n            if (val.package) {\r\n                this.mPackage = val.package;\r\n                this.mBag = new _bag_bag__WEBPACK_IMPORTED_MODULE_3__["Bag"](this.mElementManager.roomService.world);\r\n                this.mBag.register();\r\n            }\r\n            this.load(this.mModel.displayInfo);\r\n            if (this.mModel.pos)\r\n                this.setPosition(this.mModel.pos);\r\n            this.mDisplay.changeAlpha(this.mModel.alpha);\r\n            if (this.mModel.nickname)\r\n                this.mDisplay.showNickname(this.mModel.nickname);\r\n            this.setDirection(this.mModel.direction);\r\n            // if (this.mElementManager) {\r\n            //     const roomService = this.mElementManager.roomService;\r\n            //     if (roomService && roomService.cameraService) {\r\n            //         roomService.cameraService.startFollow(this.mDisplay);\r\n            //     }\r\n            // }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, "package", {\r\n        get: function () {\r\n            return this.mPackage;\r\n        },\r\n        set: function (value) {\r\n            this.mPackage = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, "moveTime", {\r\n        set: function (val) {\r\n            this.mMoveTime = val;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, "moveData", {\r\n        get: function () {\r\n            return this.mMoveData;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Actor;\r\n}(_player__WEBPACK_IMPORTED_MODULE_2__["Player"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/Actor.ts?')},"./src/rooms/player/bag/bag.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bag", function() { return Bag; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Bag = /** @class */ (function (_super) {\r\n    __extends(Bag, _super);\r\n    function Bag(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ADD_ITEM, _this.handleAddItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_REMOVE_ITEM, _this.handleRemoveItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EXCHANGE_ITEM_POS, _this.handleExchangeItem);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QUERY_PACKAGE, _this.handleQueryPackage);\r\n        return _this;\r\n    }\r\n    Bag.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    Bag.prototype.register = function () {\r\n        this.mWorld.connection.addPacketListener(this);\r\n    };\r\n    Bag.prototype.unRegister = function () {\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Bag.prototype.destroy = function () {\r\n        this.mInitialize = false;\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Bag.prototype.requestVirtualWorldQueryPackage = function (bagId, page, perPage) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = bagId;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    Bag.prototype.handleQueryPackage = function (packet) {\r\n        var notice = packet.content;\r\n        this.mInitialize = true;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].QUERY_PACKAGE, notice);\r\n    };\r\n    Bag.prototype.handleAddItem = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodetype === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.ElementNodeType) {\r\n            // this.mWorld.roomManager.currentRoom.map.addPackItems(content.id, content.item);\r\n        }\r\n        else if (content.nodetype === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            this.mWorld.roomManager.currentRoom.playerManager.addPackItems(content.id, content.item);\r\n        }\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, content);\r\n    };\r\n    Bag.prototype.handleRemoveItem = function (packet) {\r\n        var content = packet.content;\r\n        var len = content.itemId.length;\r\n        for (var i = 0; i < len; i++) {\r\n            this.mWorld.roomManager.currentRoom.playerManager.removePackItems(content.id, content.itemId[i]);\r\n        }\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE);\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_REMOVE, content);\r\n    };\r\n    Bag.prototype.handleExchangeItem = function (packet) {\r\n        var content = packet.content;\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_EXCHANGE_ITEM_POS, content);\r\n    };\r\n    return Bag;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/bag/bag.ts?')},"./src/rooms/player/friend/friend.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Friend", function() { return Friend; });\nvar Friend = /** @class */ (function () {\r\n    function Friend(world) {\r\n        this.world = world;\r\n        this.mFriendList = [];\r\n    }\r\n    Friend.prototype.requestFriend = function (callBack) {\r\n        var func = callBack;\r\n        this.world.httpService.firend().then(function (response) {\r\n            if (response.code === 200) {\r\n                if (func)\r\n                    func(response.data);\r\n            }\r\n        });\r\n    };\r\n    Friend.prototype.friendList = function () {\r\n        return this.mFriendList || [];\r\n    };\r\n    return Friend;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/friend/friend.ts?')},"./src/rooms/player/interactive/interactive.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Interactive", function() { return Interactive; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Interactive = /** @class */ (function (_super) {\r\n    __extends(Interactive, _super);\r\n    function Interactive(mWorld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mWorld = mWorld;\r\n        return _this;\r\n    }\r\n    Interactive.prototype.initialize = function () {\r\n        return this.mInitialize;\r\n    };\r\n    Interactive.prototype.register = function () {\r\n        this.mWorld.connection.addPacketListener(this);\r\n    };\r\n    Interactive.prototype.unRegister = function () {\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Interactive.prototype.destroy = function () {\r\n        this.mInitialize = false;\r\n        this.mWorld.connection.removePacketListener(this);\r\n    };\r\n    Interactive.prototype.requestTargetUI = function (uiId, id) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = uiId;\r\n        content.componentId = id;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    return Interactive;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/interactive/interactive.ts?')},"./src/rooms/player/player.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerManager", function() { return PlayerManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _player__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./player */ "./src/rooms/player/player.ts");\n/* harmony import */ var _Actor__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Actor */ "./src/rooms/player/Actor.ts");\n/* harmony import */ var _player_model__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./player.model */ "./src/rooms/player/player.model.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\n\r\nvar PlayerManager = /** @class */ (function (_super) {\r\n    __extends(PlayerManager, _super);\r\n    function PlayerManager(mRoom) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mPlayerMap = new Map();\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADJUST_POSITION, _this.onAdjust);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE, _this.onMove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_EFFECT, _this.onShowEffect);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE, _this.onOnlyBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, _this.onShowBubble);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ONLY_BUBBLE_CLEAN, _this.onClearBubbleHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSync);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_SPRITE_POSITION, _this.onSetPosition);\r\n            // this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_CAMERA_FOLLOW, this.onCameraFollow);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE_BY_PATH, _this.onMovePath);\r\n        }\r\n        return _this;\r\n    }\r\n    // public createActor(playModel: PlayerModel) {\r\n    //     this.mActor = new Actor(playModel, this);\r\n    //     if (sprite.attrs) {\r\n    //         for (const attr of sprite.attrs) {\r\n    //             this._addSimulate(sprite.id, attr);\r\n    //         }\r\n    //     }\r\n    // }\r\n    PlayerManager.prototype.createActor = function (actor) {\r\n        var playModel = new _player_model__WEBPACK_IMPORTED_MODULE_8__["PlayerModel"](actor);\r\n        this.mActor = new _Actor__WEBPACK_IMPORTED_MODULE_7__["Actor"](playModel, this);\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "actor", {\r\n        get: function () {\r\n            return this.mActor;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PlayerManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mPlayerMap)\r\n            return;\r\n        this.mPlayerMap.forEach(function (player) { return _this.removeFromMap(player.id); });\r\n        this.mPlayerMap.clear();\r\n    };\r\n    PlayerManager.prototype.removeFromMap = function (id) {\r\n        var player = this.mPlayerMap.get(id);\r\n        if (player) {\r\n            // MineCarSimulateData.destroyMineCar(this.roomService.elementManager, player.model);\r\n            this.mPlayerMap.delete(id);\r\n            player.destroy();\r\n        }\r\n    };\r\n    PlayerManager.prototype.requestActorMove = function (dir, keyArr) {\r\n        this.startActorMove();\r\n        if (!this.roomService.world.game.device.os.desktop) {\r\n            // 按下键盘的时候已经发了一次了，如果再发一次后端会有问题\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n            var content = pkt.content;\r\n            content.keyCodes = keyArr;\r\n            this.connection.send(pkt);\r\n        }\r\n    };\r\n    PlayerManager.prototype.startActorMove = function () {\r\n        if (!this.mActor) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("MainHero miss");\r\n            return;\r\n        }\r\n        this.mActor.startMove();\r\n    };\r\n    PlayerManager.prototype.stopActorMove = function () {\r\n        if (!this.mActor) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("MainHero miss");\r\n            return;\r\n        }\r\n        this.mActor.stopMove();\r\n    };\r\n    PlayerManager.prototype.get = function (id) {\r\n        if (!this.mPlayerMap) {\r\n            return;\r\n        }\r\n        var player = this.mPlayerMap.get(id);\r\n        if (!player) {\r\n            var actor = this.mActor;\r\n            if (actor && actor.id === id) {\r\n                player = actor;\r\n            }\r\n        }\r\n        return player;\r\n    };\r\n    PlayerManager.prototype.add = function (sprite) {\r\n    };\r\n    PlayerManager.prototype.remove = function (id) {\r\n        var element = this.mPlayerMap.get(id);\r\n        if (element) {\r\n            this.mPlayerMap.delete(id);\r\n            element.destroy();\r\n        }\r\n        if (this.mActor) {\r\n            this.mActor.destroy();\r\n            this.mActor = null;\r\n        }\r\n        return element;\r\n    };\r\n    PlayerManager.prototype.getElements = function () {\r\n        return Array.from(this.mPlayerMap.values());\r\n    };\r\n    PlayerManager.prototype.set = function (id, player) {\r\n        if (!this.mPlayerMap) {\r\n            this.mPlayerMap = new Map();\r\n        }\r\n        this.mPlayerMap.set(id, player);\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.mRoom.cameraService.camera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    // public addPlayer(obj: op_client.IActor): void {\r\n    //     const playerInfo: PlayerInfo = new PlayerInfo();\r\n    //     playerInfo.setInfo(obj);\r\n    //     if (obj.walkOriginPoint) {\r\n    //         playerInfo.setOriginWalkPoint(obj.walkOriginPoint);\r\n    //     }\r\n    //     if (obj.originPoint) {\r\n    //         playerInfo.setOriginCollisionPoint(obj.originPoint);\r\n    //     }\r\n    //     this.mPlayerInfoList.push(playerInfo);\r\n    //     this.mModelDispatch.emit(MessageType.SCENE_ADD_PLAYER, playerInfo);\r\n    // }\r\n    PlayerManager.prototype.addPackItems = function (elementId, items) {\r\n        var character = this.mPlayerMap.get(elementId);\r\n        if (character && character.id === this.mActor.id) {\r\n            if (!character.package) {\r\n                character.package = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_gameconfig"].Package.create();\r\n            }\r\n            character.package.items = character.package.items.concat(items);\r\n            this.mRoom.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_5__["MessageType"].UPDATED_CHARACTER_PACKAGE);\r\n        }\r\n    };\r\n    PlayerManager.prototype.removePackItems = function (elementId, itemId) {\r\n        var character = this.mPlayerMap.get(elementId);\r\n        if (character && this.mActor.id) {\r\n            var itemList = character.package.items;\r\n            var len = itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                if (itemId === itemList[i].id) {\r\n                    itemList.splice(i, 1);\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    PlayerManager.prototype.onSync = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var player = null;\r\n        var sprites = content.sprites;\r\n        var command = content.command;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            player = this.get(sprite.id);\r\n            if (player) {\r\n                //  MineCarSimulateData.addSimulate(this.roomService, sprite, player.model);\r\n                if (command === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].OpCommand.OP_COMMAND_UPDATE) {\r\n                    player.model = new _element_sprite__WEBPACK_IMPORTED_MODULE_4__["Sprite"](sprite);\r\n                }\r\n                else if (command === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].OpCommand.OP_COMMAND_PATCH) {\r\n                    player.updateModel(sprite);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onAdjust = function (packet) {\r\n        var content = packet.content;\r\n        var positions = content.spritePositions;\r\n        var type = content.nodeType;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        if (this.mActor) {\r\n            var player = void 0;\r\n            var point = void 0;\r\n            for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {\r\n                var position = positions_1[_i];\r\n                player = this.mPlayerMap.get(position.id);\r\n                // if (!player) {\r\n                //     if (position.id === this.mActor.id) {\r\n                //         player = this.mActor;\r\n                //     } else {\r\n                //         continue;\r\n                //     }\r\n                // }\r\n                if (player) {\r\n                    point = position.point3f;\r\n                    player.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](point.x || 0, point.y || 0, point.z || 0));\r\n                }\r\n                // Logger.getInstance().debug(`adjust,x:${point.x},y:${point.y}`);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onAdd = function (packet) {\r\n        if (!this.mPlayerMap) {\r\n            this.mPlayerMap = new Map();\r\n        }\r\n        var content = packet.content;\r\n        var sprites = content.sprites;\r\n        var type = content.nodeType;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            this._add(new _element_sprite__WEBPACK_IMPORTED_MODULE_4__["Sprite"](sprite));\r\n            // MineCarSimulateData.addSimulate(this.roomService, sprite);\r\n        }\r\n    };\r\n    PlayerManager.prototype._add = function (sprite) {\r\n        if (!this.mPlayerMap)\r\n            this.mPlayerMap = new Map();\r\n        if (!this.mPlayerMap.has(sprite.id)) {\r\n            var player = new _player__WEBPACK_IMPORTED_MODULE_6__["Player"](sprite, this);\r\n            this.mPlayerMap.set(player.id || 0, player);\r\n        }\r\n    };\r\n    PlayerManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    PlayerManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.removeFromMap(id);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onMove = function (packet) {\r\n        var content = packet.content;\r\n        if (content.moveData) {\r\n            var moveDataList = content.moveData;\r\n            var len = moveDataList.length;\r\n            var type = content.nodeType || null;\r\n            var moveData = void 0;\r\n            var playID = void 0;\r\n            var player = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                moveData = moveDataList[i];\r\n                playID = moveData.moveObjectId;\r\n                player = this.get(playID);\r\n                if (player) {\r\n                    player.move(moveData);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onSetPosition = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var id = content.id;\r\n        if (type !== NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var role = this.get(id);\r\n        if (role) {\r\n            role.setPosition(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](content.position.x, content.position.y, content.position.z));\r\n        }\r\n    };\r\n    PlayerManager.prototype.onShowBubble = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.chatSenderid);\r\n        if (player) {\r\n            player.showBubble(content.chatContext, content.chatSetting);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onOnlyBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.receiverid);\r\n        if (player) {\r\n            player.showBubble(content.context, content.chatsetting);\r\n        }\r\n    };\r\n    PlayerManager.prototype.onClearBubbleHandler = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.receiverid);\r\n        if (player) {\r\n            player.clearBubble();\r\n        }\r\n    };\r\n    PlayerManager.prototype.onShowEffect = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.id;\r\n        var player;\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            player = this.get(id);\r\n            if (player) {\r\n                player.showEffected(null);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var player = null;\r\n        var ids = content.ids;\r\n        for (var _i = 0, ids_3 = ids; _i < ids_3.length; _i++) {\r\n            var id = ids_3[_i];\r\n            player = this.get(id);\r\n            if (player) {\r\n                player.setQueue(content.changeAnimation);\r\n            }\r\n        }\r\n    };\r\n    PlayerManager.prototype.onCameraFollow = function (packet) {\r\n        var content = packet.content;\r\n        var player = this.get(content.id);\r\n        var camera = this.roomService.cameraService;\r\n        if (!camera) {\r\n            return;\r\n        }\r\n        if (player) {\r\n            camera.startFollow(player.getDisplay());\r\n        }\r\n        else {\r\n            camera.stopFollow();\r\n        }\r\n    };\r\n    PlayerManager.prototype.onMovePath = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.CharacterNodeType) {\r\n            return;\r\n        }\r\n        var play = this.get(content.id);\r\n        if (play) {\r\n            play.movePath(content);\r\n        }\r\n    };\r\n    Object.defineProperty(PlayerManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PlayerManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PlayerManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().error("room is undefined");\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PlayerManager.prototype, "map", {\r\n        get: function () {\r\n            return [];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return PlayerManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.manager.ts?')},"./src/rooms/player/player.model.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayerModel", function() { return PlayerModel; });\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PlayerModel = /** @class */ (function (_super) {\r\n    __extends(PlayerModel, _super);\r\n    function PlayerModel(data) {\r\n        var _this = _super.call(this, data) || this;\r\n        _this.mPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](data.x, data.y, data.z);\r\n        _this.mAlpha = 1;\r\n        _this.mPackage = data.package;\r\n        _this.mSceneId = data.sceneId;\r\n        _this.mUuid = data.uuid;\r\n        _this.mPlatformId = data.platformId;\r\n        return _this;\r\n    }\r\n    return PlayerModel;\r\n}(_element_sprite__WEBPACK_IMPORTED_MODULE_0__["Sprite"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.model.ts?')},"./src/rooms/player/player.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Player", function() { return Player; });\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar Player = /** @class */ (function (_super) {\r\n    __extends(Player, _super);\r\n    function Player(sprite, mElementManager) {\r\n        var _this = _super.call(this, sprite, mElementManager) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.CharacterNodeType;\r\n        _this.mOffsetY = undefined;\r\n        if (_this.mDisplay) {\r\n            if (sprite.displayBadgeCards && sprite.displayBadgeCards.length > 0)\r\n                _this.mDisplay.setDisplayBadges(sprite.displayBadgeCards);\r\n        }\r\n        return _this;\r\n    }\r\n    Player.prototype.setModel = function (val) {\r\n        _super.prototype.setModel.call(this, val);\r\n        this.showNickName();\r\n    };\r\n    Player.prototype.move = function (moveData) {\r\n        if (this.getDirection() !== moveData.direction) {\r\n            if (this.roomService.world.moveStyle === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n                if (this.mId !== this.roomService.playerManager.actor.id) {\r\n                    this.setDirection(moveData.direction);\r\n                }\r\n            }\r\n            else {\r\n                this.setDirection(moveData.direction);\r\n            }\r\n        }\r\n        moveData.destinationPoint3f.y += this.offsetY;\r\n        _super.prototype.move.call(this, moveData);\r\n    };\r\n    Player.prototype.movePath = function (movePath) {\r\n        var _this = this;\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        var tmpPath = movePath.path;\r\n        if (!tmpPath) {\r\n            return;\r\n        }\r\n        var lastPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_2__["Pos"](this.mDisplay.x, this.mDisplay.y - this.offsetY);\r\n        var paths = [];\r\n        this.mMoveData.arrivalTime = movePath.timestemp;\r\n        var angle = null;\r\n        var point = null;\r\n        var now = this.mElementManager.roomService.now();\r\n        var duration = 0;\r\n        var index = 0;\r\n        for (var _i = 0, tmpPath_1 = tmpPath; _i < tmpPath_1.length; _i++) {\r\n            var path = tmpPath_1[_i];\r\n            point = path.point3f;\r\n            if (!(point.y === lastPos.y && point.x === lastPos.x)) {\r\n                angle = Math.atan2(point.y - lastPos.y, point.x - lastPos.x) * (180 / Math.PI);\r\n            }\r\n            now += duration;\r\n            duration = path.timestemp - now;\r\n            paths.push({\r\n                x: point.x,\r\n                y: point.y + this.offsetY,\r\n                duration: duration,\r\n                onStartParams: angle,\r\n                onStart: function (tween, target, params) {\r\n                    _this.onCheckDirection(params);\r\n                },\r\n                onCompleteParams: { duration: duration, index: index },\r\n                onComplete: function (tween, targets, params) {\r\n                    _this.onMovePathPointComplete(params);\r\n                }\r\n            });\r\n            lastPos = new _utils_pos__WEBPACK_IMPORTED_MODULE_2__["Pos"](point.x, point.y);\r\n            index++;\r\n        }\r\n        this.mMoveData.posPath = paths;\r\n        this.mMoveData.onCompleteParams = point;\r\n        this.mMoveData.onComplete = this.mMovePathPointFinished;\r\n        this._doMove();\r\n    };\r\n    Player.prototype.setDirection = function (dir) {\r\n        if (dir !== this.mDisplayInfo.avatarDir) {\r\n            this.mDisplayInfo.avatarDir = dir;\r\n            this.mModel.direction = dir;\r\n            // if (this.mDisplay) this.mDisplay.play({ animationName: this.mCurState, flip: false });\r\n            if (this.mDisplay) {\r\n                this.mDisplay.play(this.mModel.currentAnimation);\r\n            }\r\n        }\r\n    };\r\n    Player.prototype.changeState = function (val) {\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        if (this.mCurState === val)\r\n            return;\r\n        // if (!val) val = PlayerState.IDLE;\r\n        if (!val) {\r\n            val = _element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].IDLE;\r\n        }\r\n        if (this.mCheckStateHandle(val)) {\r\n            this.mCurState = val;\r\n            this.mModel.currentAnimationName = this.mCurState;\r\n            this.mDisplay.play(this.mModel.currentAnimation);\r\n        }\r\n    };\r\n    Player.prototype.setPosition = function (pos) {\r\n        pos.y += this.offsetY;\r\n        _super.prototype.setPosition.call(this, pos);\r\n    };\r\n    Player.prototype.getPosition = function () {\r\n        var pos = _super.prototype.getPosition.call(this);\r\n        pos.y -= this.offsetY;\r\n        return pos;\r\n    };\r\n    Player.prototype.onCheckDirection = function (params) {\r\n        if (typeof params !== "number") {\r\n            return;\r\n        }\r\n        // 重叠\r\n        if (params > 90) {\r\n            this.setDirection(3);\r\n        }\r\n        else if (params >= 0) {\r\n            this.setDirection(5);\r\n        }\r\n        else if (params >= -90) {\r\n            this.setDirection(7);\r\n        }\r\n        else {\r\n            this.setDirection(1);\r\n        }\r\n    };\r\n    Player.prototype.onMoveStart = function () {\r\n        this.changeState(_element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].WALK);\r\n        if (this.mMoveData) {\r\n            this.mMoveData.step = 0;\r\n        }\r\n        _super.prototype.onMoveStart.call(this);\r\n    };\r\n    Player.prototype.onMoveComplete = function () {\r\n        this.preMoveComplete();\r\n        _super.prototype.onMoveComplete.call(this);\r\n        this.changeState(_element_element__WEBPACK_IMPORTED_MODULE_0__["PlayerState"].IDLE);\r\n    };\r\n    Player.prototype.preMoveComplete = function () {\r\n        if (this.mMoveData && this.mMoveData.posPath) {\r\n            var complete = this.mMoveData.onComplete;\r\n            if (complete) {\r\n                complete.call(this, this.mMoveData.onCompleteParams);\r\n                delete this.mMoveData.onComplete;\r\n                delete this.mMoveData.onCompleteParams;\r\n            }\r\n        }\r\n    };\r\n    Player.prototype.onMovePathPointComplete = function (params) {\r\n        if (!this.mMoveData) {\r\n            return;\r\n        }\r\n        this.mMoveData.step += 1;\r\n        // if (!this.mMoveData.posPath) {\r\n        //     return;\r\n        // }\r\n        // const posPath = this.mMoveData.posPath;\r\n        // posPath.shift();\r\n    };\r\n    Player.prototype.mMovePathPointFinished = function (path) {\r\n        if (!path || !this.mRoomService) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOVE_PATH_POINT_FINISHED);\r\n        var content = pkt.content;\r\n        var currentPoint = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PBPoint3f.create();\r\n        var pos = this.getPosition();\r\n        currentPoint.x = pos.x;\r\n        currentPoint.y = pos.y;\r\n        currentPoint.z = pos.z;\r\n        var targetPoint = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PBPoint3f.create();\r\n        targetPoint.x = path.x;\r\n        targetPoint.y = path.y;\r\n        content.currentPoint = currentPoint;\r\n        content.lastTargetPoint = targetPoint;\r\n        content.timestemp = this.mRoomService.world.clock.unixTime;\r\n        this.mRoomService.connection.send(pkt);\r\n    };\r\n    Object.defineProperty(Player.prototype, "offsetY", {\r\n        get: function () {\r\n            if (this.mOffsetY === undefined) {\r\n                if (!this.mElementManager || !this.mElementManager.roomService || !this.mElementManager.roomService.roomSize) {\r\n                    return 0;\r\n                }\r\n                // this.mOffsetY = 0;\r\n                this.mOffsetY = this.mElementManager.roomService.roomSize.tileHeight >> 2;\r\n            }\r\n            return this.mOffsetY;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Player.prototype.mCheckStateHandle = function (val) {\r\n        // if (this.mCurState === val) return false;\r\n        return true;\r\n    };\r\n    return Player;\r\n}(_element_element__WEBPACK_IMPORTED_MODULE_0__["Element"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/player/player.ts?')},"./src/rooms/room.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomManager", function() { return RoomManager; });\n/* harmony import */ var _room__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./room */ "./src/rooms/room.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _editor_room__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editor.room */ "./src/rooms/editor.room.ts");\n/* harmony import */ var _decorate_room__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./decorate.room */ "./src/rooms/decorate.room.ts");\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError("Generator is already executing.");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar RoomManager = /** @class */ (function (_super) {\r\n    __extends(RoomManager, _super);\r\n    function RoomManager(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRooms = [];\r\n        _this.mWorld = world;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_ENTER_SCENE, _this.onEnterSceneHandler);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_CHANGE_TO_EDITOR_MODE, _this.onEnterEditor);\r\n        return _this;\r\n        // this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_READY, this.onEnterDecorate);\r\n    }\r\n    RoomManager.prototype.addPackListener = function () {\r\n        if (this.connection) {\r\n            this.connection.addPacketListener(this);\r\n        }\r\n    };\r\n    RoomManager.prototype.removePackListener = function () {\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    RoomManager.prototype.getRoom = function (id) {\r\n        // const idx = this.mRooms.findIndex((room: Room, index: number) => id === room.id);\r\n        // if (idx >= 0) {\r\n        //     return this.mRooms[idx];\r\n        // }\r\n        return this.mRooms.find(function (room) {\r\n            return room.id === id;\r\n        });\r\n    };\r\n    RoomManager.prototype.onFocus = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.resume(room.scene.scene.key);\r\n        });\r\n    };\r\n    RoomManager.prototype.onBlur = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.pause();\r\n        });\r\n    };\r\n    RoomManager.prototype.pasuseRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        if (idx >= 0) {\r\n            var room = this.mRooms[idx];\r\n            room.pause();\r\n        }\r\n    };\r\n    RoomManager.prototype.resumeRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        if (idx >= 0) {\r\n            var room = this.mRooms[idx];\r\n            if (room && room.scene)\r\n                room.resume(room.scene.scene.key);\r\n        }\r\n    };\r\n    RoomManager.prototype.stop = function () {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room && room.scene)\r\n                room.destroy();\r\n        });\r\n    };\r\n    RoomManager.prototype.resize = function (width, height) {\r\n        this.mRooms.forEach(function (room) {\r\n            if (room)\r\n                room.resize(width, height);\r\n        });\r\n    };\r\n    RoomManager.prototype.destroy = function () {\r\n        this.removePackListener();\r\n        for (var _i = 0, _a = this.mRooms; _i < _a.length; _i++) {\r\n            var room = _a[_i];\r\n            room.destroy();\r\n            room = null;\r\n        }\r\n        this.mRooms.length = 0;\r\n    };\r\n    RoomManager.prototype.hasRoom = function (id) {\r\n        var idx = this.mRooms.findIndex(function (room, index) { return id === room.id; });\r\n        return idx >= 0;\r\n    };\r\n    RoomManager.prototype.onEnterScene = function (scene) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var vw, room;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        vw = scene;\r\n                        if (!this.hasRoom(vw.scene.id)) return [3 /*break*/, 3];\r\n                        room = this.getRoom(vw.scene.id);\r\n                        if (!this.mCurRoom) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.leaveScene(this.mCurRoom)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        room.addActor(vw.actor);\r\n                        room.enter(vw.scene);\r\n                        this.mCurRoom = room;\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        // load this scene config in gameConfig\r\n                        this.world.loadSceneConfig(vw.scene.id.toString()).then(function (config) { return __awaiter(_this, void 0, void 0, function () {\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        this.world.elementStorage.setSceneConfig(config);\r\n                                        if (!this.mCurRoom) return [3 /*break*/, 2];\r\n                                        return [4 /*yield*/, this.leaveScene(this.mCurRoom)];\r\n                                    case 1:\r\n                                        _a.sent();\r\n                                        _a.label = 2;\r\n                                    case 2:\r\n                                        room = new _room__WEBPACK_IMPORTED_MODULE_0__["Room"](this);\r\n                                        this.mRooms.push(room);\r\n                                        room.addActor(vw.actor);\r\n                                        room.enter(vw.scene);\r\n                                        this.mCurRoom = room;\r\n                                        return [2 /*return*/];\r\n                                }\r\n                            });\r\n                        }); });\r\n                        _a.label = 4;\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RoomManager.prototype.onEnterDecorate = function (scene) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var room, actor;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.mCurRoom) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, this.leaveScene(this.mCurRoom)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        room = new _decorate_room__WEBPACK_IMPORTED_MODULE_5__["DecorateRoom"](this);\r\n                        room.enter(scene.scene);\r\n                        actor = scene.actor;\r\n                        if (actor)\r\n                            room.setEnterPos(actor.x, actor.y);\r\n                        this.mRooms.push(room);\r\n                        this.mCurRoom = room;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RoomManager.prototype.onEnterEditor = function (packet) {\r\n        var content = packet.content;\r\n        var room = new _editor_room__WEBPACK_IMPORTED_MODULE_4__["EditorRoom"](this);\r\n        room.enter(content.scene);\r\n        this.mCurRoom = room;\r\n        this.mRooms.push(room);\r\n    };\r\n    RoomManager.prototype.leaveScene = function (room) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (!room)\r\n                    return [2 /*return*/];\r\n                return [2 /*return*/, new Promise(function (resolve, reject) {\r\n                        var loading = _this.mWorld.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_6__["LoadingScene"].name);\r\n                        if (loading) {\r\n                            loading.show().then(function () {\r\n                                _this.mRooms = _this.mRooms.filter(function (r) { return r.id !== room.id; });\r\n                                room.destroy();\r\n                                resolve();\r\n                            });\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    RoomManager.prototype.onEnterSceneHandler = function (packet) {\r\n        var content = packet.content;\r\n        var scene = content.scene;\r\n        switch (scene.sceneType) {\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.NORMAL_SCENE_TYPE:\r\n                this.onEnterScene(content);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE:\r\n                this.onEnterDecorate(content);\r\n                break;\r\n        }\r\n    };\r\n    Object.defineProperty(RoomManager.prototype, "world", {\r\n        get: function () {\r\n            return this.mWorld;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomManager.prototype, "currentRoom", {\r\n        get: function () {\r\n            return this.mCurRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mWorld) {\r\n                return this.mWorld.connection;\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("world manager is undefined");\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return RoomManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/room.manager.ts?')},"./src/rooms/room.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Room", function() { return Room; });\n/* harmony import */ var _element_element_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./element/element.manager */ "./src/rooms/element/element.manager.ts");\n/* harmony import */ var _player_player_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./player/player.manager */ "./src/rooms/player/player.manager.ts");\n/* harmony import */ var _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./layer/layer.manager */ "./src/rooms/layer/layer.manager.ts");\n/* harmony import */ var _terrain_terrain_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./terrain/terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./cameras/cameras.manager */ "./src/rooms/cameras/cameras.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _scenes_play__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../scenes/play */ "./src/scenes/play.ts");\n/* harmony import */ var _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./cameras/viewblock.manager */ "./src/rooms/cameras/viewblock.manager.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _scenes_loading__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../scenes/loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _element_element__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _display_display_object__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./display/display.object */ "./src/rooms/display/display.object.ts");\n/* harmony import */ var _editor_reference_area__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./editor/reference.area */ "./src/rooms/editor/reference.area.ts");\n/* harmony import */ var _fall_effect_fall_effect_container__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./fall.effect/fall.effect.container */ "./src/rooms/fall.effect/fall.effect.container.ts");\n/* harmony import */ var _fall_effect_fall_effect__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./fall.effect/fall.effect */ "./src/rooms/fall.effect/fall.effect.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _wall_wall_manager__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./wall/wall.manager */ "./src/rooms/wall/wall.manager.ts");\n/* harmony import */ var _sky_box_sky_box_manager__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./sky.box/sky.box.manager */ "./src/rooms/sky.box/sky.box.manager.ts");\n/* harmony import */ var _group_GroupManager__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./group/GroupManager */ "./src/rooms/group/GroupManager.ts");\n/* harmony import */ var _element_frame_manager__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./element/frame.manager */ "./src/rooms/element/frame.manager.ts");\n/* harmony import */ var _state_state_group__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./state/state.group */ "./src/rooms/state/state.group.ts");\n/* harmony import */ var _effect_effect_manager__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./effect/effect.manager */ "./src/rooms/effect/effect.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// 这一层管理数据和Phaser之间的逻辑衔接\r\n// 消息处理让上层[RoomManager]处理\r\nvar Room = /** @class */ (function (_super) {\r\n    __extends(Room, _super);\r\n    function Room(manager) {\r\n        var _this = _super.call(this) || this;\r\n        _this.manager = manager;\r\n        _this.mEnableEdit = false;\r\n        _this.mWorld = _this.manager.world;\r\n        _this.moveStyle = _this.mWorld.moveStyle;\r\n        _this.mScaleRatio = _this.mWorld.scaleRatio;\r\n        if (_this.mWorld) {\r\n            if (_this.connection) {\r\n                _this.connection.addPacketListener(_this);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_EDIT_MODE, _this.onEnableEditModeHandler);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_UNWALKABLE_BIT_MAP, _this.onShowMapTitle);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MOVE_SPRITE_BY_PATH, _this.onMovePathHandler);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SET_CAMERA_FOLLOW, _this.onCameraFollowHandler);\r\n                _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_STATE, _this.onSyncStateHandler);\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    Room.prototype.enter = function (data) {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        if (!data) {\r\n            // Logger.getInstance().error("wrong room");\r\n            return;\r\n        }\r\n        this.mID = data.id;\r\n        this.mSize = {\r\n            cols: data.cols,\r\n            rows: data.rows,\r\n            tileHeight: data.tileHeight,\r\n            tileWidth: data.tileWidth,\r\n            sceneWidth: (data.rows + data.cols) * (data.tileWidth / 2),\r\n            sceneHeight: (data.rows + data.cols) * (data.tileHeight / 2),\r\n        };\r\n        this.mMiniSize = {\r\n            cols: data.cols * 2,\r\n            rows: data.rows * 2,\r\n            tileWidth: data.tileWidth / 2,\r\n            tileHeight: data.tileHeight / 2,\r\n        };\r\n        // if (this.mMap) this.mMap.destroy();\r\n        // this.mMap = new Map(this.mWorld);\r\n        // this.mMap.setMapInfo(data);\r\n        this.world.showLoading().then(function () {\r\n            _this.completeLoad();\r\n        });\r\n    };\r\n    Room.prototype.onFullPacketReceived = function (sprite_t) {\r\n        if (sprite_t !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n    };\r\n    Room.prototype.onClockReady = function () {\r\n        // TODO: Unload loading-scene\r\n    };\r\n    Room.prototype.startLoad = function () { };\r\n    Room.prototype.completeLoad = function () {\r\n        if (this.mWorld.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name)) {\r\n            var loadingScene = this.mWorld.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_11__["LoadingScene"].name);\r\n            if (loadingScene)\r\n                loadingScene.sleep();\r\n            return;\r\n        }\r\n        this.mWorld.game.scene.add(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, _scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"], true, {\r\n            room: this,\r\n        });\r\n    };\r\n    Room.prototype.startPlay = function () {\r\n        var _this = this;\r\n        if (this.mLayManager) {\r\n            this.layerManager.destroy();\r\n        }\r\n        this.mCameraService = new _cameras_cameras_manager__WEBPACK_IMPORTED_MODULE_6__["CamerasManager"](this);\r\n        this.mScene = this.world.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.mTerrainManager = new _terrain_terrain_manager__WEBPACK_IMPORTED_MODULE_3__["TerrainManager"](this, this);\r\n        this.mElementManager = new _element_element_manager__WEBPACK_IMPORTED_MODULE_0__["ElementManager"](this);\r\n        this.mPlayerManager = new _player_player_manager__WEBPACK_IMPORTED_MODULE_1__["PlayerManager"](this);\r\n        this.mWallManager = new _wall_wall_manager__WEBPACK_IMPORTED_MODULE_19__["WallManager"](this);\r\n        this.mBlocks = new _cameras_viewblock_manager__WEBPACK_IMPORTED_MODULE_9__["ViewblockManager"](this.mCameraService);\r\n        this.mLayManager = new _layer_layer_manager__WEBPACK_IMPORTED_MODULE_2__["LayerManager"](this);\r\n        this.mGroupManager = new _group_GroupManager__WEBPACK_IMPORTED_MODULE_21__["GroupManager"](this);\r\n        this.mFrameManager = new _element_frame_manager__WEBPACK_IMPORTED_MODULE_22__["FrameManager"]();\r\n        this.mSkyboxManager = new _sky_box_sky_box_manager__WEBPACK_IMPORTED_MODULE_20__["SkyBoxManager"](this);\r\n        this.mEffectManager = new _effect_effect_manager__WEBPACK_IMPORTED_MODULE_24__["EffectManager"](this);\r\n        if (this.scene) {\r\n            var camera_1 = this.scene.cameras.main;\r\n            setTimeout(function () {\r\n                camera_1.flash(6000, 1, 1, 1, true, undefined, _this.scene);\r\n            }, 6000);\r\n            this.mCameraService.camera = camera_1;\r\n            var padding = 199 * this.mScaleRatio;\r\n            this.mCameraService.setBounds(-padding, -padding, this.mSize.sceneWidth * this.mScaleRatio + padding * 2, this.mSize.sceneHeight * this.mScaleRatio + padding * 2);\r\n            // init block\r\n            this.mBlocks.int(this.mSize);\r\n            if (this.mWorld.moveStyle !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].MoveStyle.DIRECTION_MOVE_STYLE) {\r\n                this.mFallEffectContainer = new _fall_effect_fall_effect_container__WEBPACK_IMPORTED_MODULE_16__["FallEffectContainer"](this.mScene, this);\r\n            }\r\n        }\r\n        // this.mPlayerManager.createActor(new PlayerModel(this.mActorData));\r\n        this.mPlayerManager.createActor(this.mActorData);\r\n        var loadingScene = this.mWorld.game.scene.getScene(_scenes_loading__WEBPACK_IMPORTED_MODULE_11__["LoadingScene"].name);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PRESS_ELEMENT, this.onPressElementHandler, this);\r\n        if (loadingScene)\r\n            loadingScene.sleep();\r\n        this.world.changeRoom(this);\r\n        if (this.world.uiManager)\r\n            this.world.uiManager.showMainUI();\r\n        if (this.connection) {\r\n            this.cameraService.syncCamera();\r\n            this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SCENE_CREATED));\r\n        }\r\n        this.scene.input.on("pointerdown", this.onPointerDownHandler, this);\r\n        this.scene.input.on("pointerup", this.onPointerUpHandler, this);\r\n        this.world.emitter.on("Tap", this.onTapHandler, this);\r\n        // const list = ["forestBgm1.mp3", "mineBgm1.mp3", "fisheryBgm1.mp3", "generalBgm1.mp3"];\r\n        // this.world.playSound({\r\n        //     urls: "https://osd.tooqing.com/b4368e3b7aea51d106044127f9cae95e",\r\n        //     field: SoundField.Element,\r\n        //     soundConfig: { loop: true },\r\n        // });\r\n        var scenerys = this.world.elementStorage.getScenerys();\r\n        if (scenerys) {\r\n            for (var _i = 0, scenerys_1 = scenerys; _i < scenerys_1.length; _i++) {\r\n                var scenery = scenerys_1[_i];\r\n                this.addSkyBox(scenery);\r\n            }\r\n        }\r\n    };\r\n    Room.prototype.pause = function () {\r\n        if (this.mScene)\r\n            this.mScene.scene.pause();\r\n        if (this.mWorld && this.mWorld.inputManager)\r\n            this.mWorld.inputManager.enable = false;\r\n    };\r\n    Room.prototype.resume = function (name) {\r\n        if (this.mScene)\r\n            this.mScene.scene.resume(name);\r\n        if (this.mWorld && this.mWorld.inputManager)\r\n            this.mWorld.inputManager.enable = true;\r\n        // this.mClock.sync(-1);\r\n    };\r\n    Room.prototype.addActor = function (data) {\r\n        this.mActorData = data;\r\n    };\r\n    Room.prototype.addBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.add(object);\r\n        }\r\n    };\r\n    Room.prototype.removeBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.remove(object);\r\n        }\r\n    };\r\n    Room.prototype.updateBlockObject = function (object) {\r\n        if (this.blocks) {\r\n            this.blocks.check(object);\r\n        }\r\n    };\r\n    Room.prototype.addToGround = function (element, index) {\r\n        this.layerManager.addToGround(element, index);\r\n    };\r\n    Room.prototype.addToSurface = function (element) {\r\n        this.layerManager.addToSurface(element);\r\n    };\r\n    Room.prototype.addToSceneUI = function (element) {\r\n        this.layerManager.addToSceneToUI(element);\r\n    };\r\n    Room.prototype.addToUI = function (element) {\r\n        this.layerManager.addToUI(element);\r\n    };\r\n    Room.prototype.resize = function (width, height) {\r\n        if (this.layerManager)\r\n            this.layerManager.resize(width, height);\r\n        if (this.mCameraService)\r\n            this.mCameraService.resize(width, height);\r\n    };\r\n    Room.prototype.transformTo90 = function (p) {\r\n        if (!this.mSize) {\r\n            // Logger.getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo90(p, this.mSize);\r\n    };\r\n    Room.prototype.transformTo45 = function (p) {\r\n        if (!this.mSize) {\r\n            // Logger.getInstance().error("position object is undefined");\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo45(p, this.mSize);\r\n    };\r\n    Room.prototype.transformToMini90 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo90(p, this.miniSize);\r\n    };\r\n    Room.prototype.transformToMini45 = function (p) {\r\n        if (!this.mMiniSize) {\r\n            return;\r\n        }\r\n        return _utils_position45__WEBPACK_IMPORTED_MODULE_5__["Position45"].transformTo45(p, this.mMiniSize);\r\n    };\r\n    Room.prototype.addMouseListen = function () {\r\n        this.layerManager.addMouseListen();\r\n    };\r\n    Room.prototype.getElement = function (id) {\r\n        var ele = null;\r\n        if (this.mPlayerManager) {\r\n            ele = this.mPlayerManager.get(id);\r\n        }\r\n        if (!ele && this.mElementManager) {\r\n            ele = this.elementManager.get(id);\r\n        }\r\n        return ele;\r\n    };\r\n    Room.prototype.moveable = function (pos) {\r\n        var pos45 = this.transformToMini45(pos);\r\n        var map = this.mElementManager.map;\r\n        if (pos45.x < 0 || pos45.x > map.length || pos45.y < 0 || pos45.y > map[0].length) {\r\n            return false;\r\n        }\r\n        if (map[pos45.y][pos45.x] === 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    Room.prototype.update = function (time, delta) {\r\n        this.updateClock(time, delta);\r\n        this.mBlocks.update(time, delta);\r\n        if (this.layerManager)\r\n            this.layerManager.update(time, delta);\r\n        if (this.elementManager)\r\n            this.elementManager.update(time, delta);\r\n        if (this.mFrameManager)\r\n            this.frameManager.update(time, delta);\r\n    };\r\n    Room.prototype.updateClock = function (time, delta) {\r\n        // 客户端自己通过delta来更新游戏时间戳\r\n        if (this.mWorld.clock)\r\n            this.mWorld.clock.update(time, delta);\r\n    };\r\n    Room.prototype.now = function () {\r\n        return this.mWorld.clock.unixTime;\r\n    };\r\n    Room.prototype.getMaxScene = function () {\r\n        if (!this.mSize) {\r\n            return;\r\n        }\r\n        var w = this.mSize.sceneWidth;\r\n        var h = this.mSize.sceneHeight;\r\n        var blocks = this.mSkyboxManager.scenery;\r\n        for (var _i = 0, blocks_1 = blocks; _i < blocks_1.length; _i++) {\r\n            var block = blocks_1[_i];\r\n            if (block.scenery) {\r\n                if (block.scenery.width > w) {\r\n                    w = block.scenery.width;\r\n                }\r\n                if (block.scenery.height > h) {\r\n                    h = block.scenery.height;\r\n                }\r\n            }\r\n        }\r\n        return { width: w, height: h };\r\n    };\r\n    Room.prototype.setState = function (states) {\r\n        if (!this.mStateMap)\r\n            this.mStateMap = new Map();\r\n        var state;\r\n        for (var _i = 0, states_1 = states; _i < states_1.length; _i++) {\r\n            var sta = states_1[_i];\r\n            switch (sta.execCode) {\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].ExecCode.EXEC_CODE_ADD:\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].ExecCode.EXEC_CODE_UPDATE:\r\n                    state = new _state_state_group__WEBPACK_IMPORTED_MODULE_23__["State"](sta);\r\n                    this.mStateMap.set(sta.name, new _state_state_group__WEBPACK_IMPORTED_MODULE_23__["State"](sta));\r\n                    this.handlerState(state);\r\n                    break;\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].ExecCode.EXEC_CODE_DELETE:\r\n                    this.mStateMap.delete(sta.name);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    Room.prototype.clear = function () {\r\n        if (this.mLayManager)\r\n            this.mLayManager.destroy();\r\n        if (this.mTerrainManager)\r\n            this.mTerrainManager.destroy();\r\n        if (this.mElementManager)\r\n            this.mElementManager.destroy();\r\n        if (this.mPlayerManager)\r\n            this.mPlayerManager.destroy();\r\n        if (this.mBlocks)\r\n            this.mBlocks.destroy();\r\n        if (this.mSkyboxManager)\r\n            this.mSkyboxManager.destroy();\r\n        if (this.mWallManager)\r\n            this.mWallManager.destroy();\r\n        if (this.mActorData) {\r\n            this.mActorData = null;\r\n        }\r\n        if (this.mStateMap)\r\n            this.mStateMap = null;\r\n        if (this.mCameraService)\r\n            this.mCameraService.destroy();\r\n        if (this.mEffectManager)\r\n            this.mEffectManager.destroy();\r\n    };\r\n    Room.prototype.destroy = function () {\r\n        this.clear();\r\n        this.world.emitter.off("Tap", this.onTapHandler, this);\r\n        if (this.connection)\r\n            this.connection.removePacketListener(this);\r\n        this.mWorld.game.scene.remove(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].PRESS_ELEMENT, this.onPressElementHandler, this);\r\n        // if (this.mScene) {\r\n        //   this.mScene = null;\r\n        // }\r\n    };\r\n    Room.prototype.addSkyBox = function (scenery) {\r\n        this.mSkyboxManager.add(scenery);\r\n    };\r\n    Room.prototype.onPointerDownHandler = function (pointer) {\r\n        this.addPointerMoveHandler();\r\n    };\r\n    Room.prototype.onPointerUpHandler = function (pointer) {\r\n        this.removePointerMoveHandler();\r\n    };\r\n    Room.prototype.addPointerMoveHandler = function () {\r\n        this.mScene.input.on("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.on("gameout", this.onGameOutHandler, this);\r\n    };\r\n    Room.prototype.removePointerMoveHandler = function () {\r\n        this.mScene.input.off("pointermove", this.onPointerMoveHandler, this);\r\n        this.mScene.input.off("gameout", this.onGameOutHandler, this);\r\n        if (this.cameraService.moving) {\r\n            this.cameraService.syncCameraScroll();\r\n            this.cameraService.moving = false;\r\n        }\r\n    };\r\n    Room.prototype.onPointerMoveHandler = function (pointer) {\r\n        if (!this.mCameraService.targetFollow) {\r\n            this.cameraService.offsetScroll(pointer.prevPosition.x - pointer.position.x, pointer.prevPosition.y - pointer.position.y);\r\n        }\r\n    };\r\n    Room.prototype.onGameOutHandler = function () {\r\n        this.removePointerMoveHandler();\r\n    };\r\n    Room.prototype.handlerState = function (state) {\r\n        switch (state.name) {\r\n            case "skyBoxAnimation":\r\n                this.mSkyboxManager.setState(state);\r\n                break;\r\n        }\r\n    };\r\n    Object.defineProperty(Room.prototype, "scene", {\r\n        get: function () {\r\n            return this.mScene || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "terrainManager", {\r\n        get: function () {\r\n            return this.mTerrainManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "elementManager", {\r\n        get: function () {\r\n            return this.mElementManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "playerManager", {\r\n        get: function () {\r\n            return this.mPlayerManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "layerManager", {\r\n        get: function () {\r\n            return this.mLayManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "groupManager", {\r\n        get: function () {\r\n            return this.mGroupManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "frameManager", {\r\n        get: function () {\r\n            return this.mFrameManager || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "cameraService", {\r\n        get: function () {\r\n            return this.mCameraService || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "effectManager", {\r\n        get: function () {\r\n            return this.mEffectManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "roomSize", {\r\n        get: function () {\r\n            return this.mSize || undefined;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "miniSize", {\r\n        get: function () {\r\n            return this.mMiniSize;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "blocks", {\r\n        get: function () {\r\n            return this.mBlocks;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "world", {\r\n        get: function () {\r\n            return this.mWorld;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "enableEdit", {\r\n        get: function () {\r\n            return this.mEnableEdit;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "connection", {\r\n        get: function () {\r\n            if (this.manager) {\r\n                return this.manager.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Room.prototype, "sceneType", {\r\n        get: function () {\r\n            return pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].SceneTypeEnum.NORMAL_SCENE_TYPE;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Room.prototype.onPressElementHandler = function (pointer, gameObject) {\r\n        if (!gameObject || !gameObject.parentContainer) {\r\n            return;\r\n        }\r\n        var com = gameObject.parentContainer;\r\n        if (!(com instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_14__["DisplayObject"])) {\r\n            return;\r\n        }\r\n        var ele = com.element;\r\n        if (!(ele instanceof _element_element__WEBPACK_IMPORTED_MODULE_12__["Element"])) {\r\n            return;\r\n        }\r\n        if (this.mEnableEdit) {\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n            this.connection.send(packet);\r\n        }\r\n    };\r\n    Room.prototype.onEnableEditModeHandler = function (packet) {\r\n        this.mEnableEdit = true;\r\n    };\r\n    Room.prototype.onShowMapTitle = function (packet) {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var area = new _editor_reference_area__WEBPACK_IMPORTED_MODULE_15__["ReferenceArea"](this.scene, this);\r\n        var num = [];\r\n        var intArray = content.intArray;\r\n        for (var i = 0; i < intArray.length; i++) {\r\n            num[i] = [];\r\n            for (var j = 0; j < intArray[i].value.length; j++) {\r\n                num[i][j] = intArray[i].value[j];\r\n            }\r\n            // num[i] = intArray[i];\r\n        }\r\n        area.draw(num, new Phaser.Geom.Point(0, 0));\r\n        area.setAlpha(0.1);\r\n        if (area.size) {\r\n            area.setPosition(area.size.sceneWidth / 2, 0);\r\n            this.mLayManager.addToMiddle(area);\r\n        }\r\n    };\r\n    Room.prototype.addFillEffect = function (pos, status) {\r\n        if (!this.scene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_18__["Logger"].getInstance().log("Room scene  does not exist");\r\n            return;\r\n        }\r\n        var fall = new _fall_effect_fall_effect__WEBPACK_IMPORTED_MODULE_17__["FallEffect"](this.scene, this.mScaleRatio);\r\n        fall.show(status);\r\n        fall.setPosition(pos.x * this.mScaleRatio, pos.y * this.mScaleRatio);\r\n        this.addToSceneUI(fall);\r\n    };\r\n    Room.prototype.onMovePathHandler = function (packet) {\r\n        var content = packet.content;\r\n        var status = content.pathStatus;\r\n        if (!status) {\r\n            return;\r\n        }\r\n        var pos = content.targetPos;\r\n        this.addFillEffect({ x: pos.x, y: pos.y }, status);\r\n    };\r\n    Room.prototype.onCameraFollowHandler = function (packet) {\r\n        var content = packet.content;\r\n        var target = this.getElement(content.id);\r\n        if (target) {\r\n            if (this.mCameraService)\r\n                this.mCameraService.startFollow(target.getDisplay());\r\n        }\r\n        else {\r\n            if (this.mCameraService)\r\n                this.mCameraService.stopFollow();\r\n        }\r\n    };\r\n    Room.prototype.onSyncStateHandler = function (packet) {\r\n        var content = packet.content;\r\n        var group = content.stateGroup;\r\n        for (var _i = 0, group_1 = group; _i < group_1.length; _i++) {\r\n            var states = group_1[_i];\r\n            switch (states.owner.type) {\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.SceneNodeType:\r\n                    this.setState(states.state);\r\n                    break;\r\n                case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].NodeType.ElementNodeType:\r\n                    this.elementManager.setState(states);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    Room.prototype.move = function (x, y, gameObject) {\r\n        if (this.moveStyle !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].MoveStyle.PATH_MOVE_STYLE) {\r\n            return;\r\n        }\r\n        if (!this.mPlayerManager) {\r\n            return;\r\n        }\r\n        var actor = this.mPlayerManager.actor;\r\n        if (!actor) {\r\n            return;\r\n        }\r\n        var pos45 = actor.getPosition45();\r\n        var click45 = this.transformTo45(new _utils_pos__WEBPACK_IMPORTED_MODULE_10__["Pos"](x, y));\r\n        if (Math.abs(pos45.x - click45.x) > 20 || Math.abs(pos45.y - click45.y) > 20) {\r\n            this.addFillEffect({ x: x, y: y }, pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].PathReachableStatus.PATH_UNREACHABLE_AREA);\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOVE_TO_TARGET_BY_PATH);\r\n        var content = pkt.content;\r\n        // const pkt: PBpacket = new PBpacket(op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MOUSE_EVENT);\r\n        // const content: op_virtual_world.IOP_CLIENT_REQ_VIRTUAL_WORLD_MOUSE_EVENT = pkt.content;\r\n        if (gameObject) {\r\n            var displsy = gameObject.parentContainer.parentContainer || gameObject.parentContainer;\r\n            if (displsy && displsy instanceof _display_display_object__WEBPACK_IMPORTED_MODULE_14__["DisplayObject"]) {\r\n                var ele = displsy.element;\r\n                if (ele && ele.model) {\r\n                    content.id = ele.model.id;\r\n                    content.nodeType = ele.model.nodeType;\r\n                }\r\n            }\r\n        }\r\n        // content.mouseEvent = [9];\r\n        content.point3f = { x: x, y: y };\r\n        this.connection.send(pkt);\r\n        this.tryMove();\r\n    };\r\n    Room.prototype.tryMove = function () {\r\n        var player = this.mPlayerManager.actor;\r\n        if (!player) {\r\n            return;\r\n        }\r\n        var moveData = player.moveData;\r\n        var pos = moveData.posPath;\r\n        if (!pos || pos.length < 0) {\r\n            return;\r\n        }\r\n        var step = moveData.step;\r\n        if (step >= pos.length) {\r\n            return;\r\n        }\r\n        var playerPosition = player.getPosition();\r\n        var position = pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].PBPoint3f.create();\r\n        position.x = playerPosition.x;\r\n        position.y = playerPosition.y;\r\n        var nextPosition = pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].PBPoint3f.create();\r\n        nextPosition.x = pos[step].x;\r\n        nextPosition.y = pos[step].y;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_CHECK_MOVE_PATH_NEXT_POINT);\r\n        var conten = packet.content;\r\n        conten.timestemp = this.now();\r\n        conten.position = position;\r\n        conten.nextPoint = nextPosition;\r\n        this.connection.send(packet);\r\n    };\r\n    // Move through the location returned by the server\r\n    Room.prototype.onTapHandler = function (pointer, gameObject) {\r\n        this.move(pointer.worldX / this.mScaleRatio, pointer.worldY / this.mScaleRatio, gameObject);\r\n    };\r\n    Room.prototype.enterRoom = function () {\r\n        this.mWorld.game.scene.run(_scenes_play__WEBPACK_IMPORTED_MODULE_8__["PlayScene"].name, {\r\n            room: this,\r\n        });\r\n    };\r\n    return Room;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/room.ts?')},"./src/rooms/sky.box/block.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockManager", function() { return BlockManager; });\n/* harmony import */ var _ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ui/components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _scenes_sky_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../scenes/sky.box */ "./src/scenes/sky.box.ts");\n/* harmony import */ var _scenery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./scenery */ "./src/rooms/sky.box/scenery.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar BlockManager = /** @class */ (function () {\r\n    function BlockManager(scenery, room) {\r\n        this.mRows = 1;\r\n        this.mCols = 1;\r\n        this.mSceneName = "";\r\n        this.mGrids = [];\r\n        this.mScenery = scenery;\r\n        this.mUris = scenery.uris;\r\n        this.mRoom = room;\r\n        this.mWorld = room.world;\r\n        this.mCameras = room.cameraService;\r\n        this.mMainCamera = this.mCameras.camera;\r\n        this.mScaleRatio = this.mWorld.scaleRatio;\r\n        this.setSize(scenery.width, scenery.height);\r\n        var playScene = room.scene;\r\n        if (!playScene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().fatal(BlockManager.name + " scene does not exist");\r\n            return;\r\n        }\r\n        this.mSceneName = _scenes_sky_box__WEBPACK_IMPORTED_MODULE_3__["SkyBoxScene"].name + ("_" + scenery.id);\r\n        var scene = this.mWorld.game.scene.add(this.mSceneName, _scenes_sky_box__WEBPACK_IMPORTED_MODULE_3__["SkyBoxScene"], false);\r\n        playScene.scene.launch(this.mSceneName, this);\r\n        this.updateDepth();\r\n    }\r\n    BlockManager.prototype.startPlay = function (scene) {\r\n        var _this = this;\r\n        this.scene = scene;\r\n        this.initBlock();\r\n        if (this.mStateMap) {\r\n            this.mStateMap.forEach(function (state) { return _this.handlerState(state); });\r\n        }\r\n    };\r\n    BlockManager.prototype.check = function (time, delta) {\r\n        var worldView = this.mMainCamera.worldView;\r\n        var viewPort = new Phaser.Geom.Rectangle(worldView.x - worldView.width / 2, worldView.y - worldView.height / 2, worldView.width * 2, worldView.height * 2);\r\n        for (var _i = 0, _a = this.mGrids; _i < _a.length; _i++) {\r\n            var block = _a[_i];\r\n            block.checkCamera(Phaser.Geom.Intersects.RectangleToRectangle(viewPort, block.rectangle));\r\n        }\r\n    };\r\n    BlockManager.prototype.update = function (scenery) {\r\n        this.mScenery = scenery;\r\n        this.mUris = scenery.uris;\r\n        this.setSize(scenery.width, scenery.height);\r\n        this.initBlock();\r\n        this.updateDepth();\r\n    };\r\n    BlockManager.prototype.setSize = function (imageW, imageH, gridW, gridH) {\r\n        if (gridW === undefined)\r\n            gridW = imageW;\r\n        if (gridH === undefined)\r\n            gridH = imageH;\r\n        this.mRows = Math.ceil(imageW / gridW);\r\n        this.mCols = Math.ceil(imageH / gridH);\r\n        this.mGridWidth = gridW;\r\n        this.mGridHeight = gridH;\r\n    };\r\n    BlockManager.prototype.updatePosition = function () {\r\n        var camera = this.scene.cameras.main;\r\n        var offset = this.mScenery.offset;\r\n        var loc = this.fixPosition({ x: offset.x, y: offset.y });\r\n        camera.setPosition(loc.x, loc.y);\r\n    };\r\n    BlockManager.prototype.destroy = function () {\r\n        if (this.mWorld && this.mWorld.game) {\r\n            this.mWorld.game.scene.remove(this.mSceneName);\r\n        }\r\n        this.mGrids.length = 0;\r\n    };\r\n    BlockManager.prototype.setState = function (state) {\r\n        this.handlerState(state);\r\n    };\r\n    BlockManager.prototype.playSkyBoxAnimation = function (packet) {\r\n        var id = packet.id, targets = packet.targets, duration = packet.duration, reset = packet.reset, resetDuration = packet.resetDuration;\r\n        if (id === undefined || targets === undefined || duration === undefined) {\r\n            return;\r\n        }\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (id !== this.mScenery.id) {\r\n            return;\r\n        }\r\n        var camera = this.scene.cameras.main;\r\n        this.move(camera, this.fixPosition(targets), duration, this.fixPosition(reset), resetDuration);\r\n    };\r\n    BlockManager.prototype.handlerState = function (state) {\r\n        var packet = state.packet;\r\n        for (var _i = 0, packet_1 = packet; _i < packet_1.length; _i++) {\r\n            var prop = packet_1[_i];\r\n            if (this.mScenery.id === prop.id) {\r\n                this.playSkyBoxAnimation(prop);\r\n            }\r\n        }\r\n    };\r\n    BlockManager.prototype.updateDepth = function () {\r\n        if (!this.mRoom) {\r\n            return;\r\n        }\r\n        var playScene = this.mRoom.scene;\r\n        if (!this.mScenery || !playScene) {\r\n            return;\r\n        }\r\n        var scene = this.mWorld.game.scene.getScene(this.mSceneName);\r\n        if (!scene) {\r\n            return;\r\n        }\r\n        if (this.mScenery.depth < 0) {\r\n            scene.scene.sendToBack(this.mSceneName);\r\n        }\r\n        else {\r\n            scene.scene.moveAbove(playScene.sys.settings.key, this.mSceneName);\r\n        }\r\n    };\r\n    BlockManager.prototype.initBlock = function () {\r\n        this.clear();\r\n        this.mContainer = this.scene.add.container(0, 0);\r\n        this.mContainer.setScale(this.mWorld.scaleRatio);\r\n        var len = this.mUris.length;\r\n        // TODO\r\n        if (this.mScenery.fit === _scenery__WEBPACK_IMPORTED_MODULE_4__["Fit"].Repeat) {\r\n            var room = this.mRoom;\r\n            var _a = room.getMaxScene(), width = _a.width, height = _a.height;\r\n            var rows = Math.floor(width / this.mScenery.width);\r\n            var cols = Math.floor(height / this.mScenery.height);\r\n            for (var i = 0; i < rows; i++) {\r\n                for (var j = 0; j < cols; j++) {\r\n                    var block = new Block(this.scene, this.mUris[0][0]);\r\n                    block.setRectangle(i * this.mRows * this.mGridWidth, j * this.mRows * this.mGridHeight, this.mGridWidth, this.mGridHeight, this.mScaleRatio);\r\n                    this.mGrids.push(block);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (var i = 0; i < len; i++) {\r\n                var l = this.mUris[i].length;\r\n                for (var j = 0; j < l; j++) {\r\n                    var block = new Block(this.scene, this.mUris[i][j]);\r\n                    block.setRectangle(i * this.mRows * this.mGridWidth, j * this.mRows * this.mGridHeight, this.mGridWidth, this.mGridHeight, this.mScaleRatio);\r\n                    this.mGrids.push(block);\r\n                }\r\n            }\r\n        }\r\n        this.mContainer.add(this.mGrids);\r\n        this.initCamera();\r\n    };\r\n    BlockManager.prototype.move = function (targets, props, duration, resetProps, resetDuration) {\r\n        var _this = this;\r\n        var tween = this.scene.tweens.add({\r\n            targets: targets,\r\n            props: props,\r\n            duration: duration,\r\n            loop: -1,\r\n        });\r\n        if (resetProps) {\r\n            tween.once("loop", function () {\r\n                if (resetProps) {\r\n                    targets.x = resetProps.x;\r\n                    targets.y = resetProps.y;\r\n                }\r\n                // else {\r\n                //   const { x, y } = this.mScenery.offset;\r\n                //   offset = this.fixPosition({ x, y });\r\n                //   targets.x = offset.x;\r\n                //   targets.y = offset.y;\r\n                // }\r\n                tween.stop();\r\n                _this.move(targets, props, resetDuration);\r\n                // tween.duration = resetDuration;\r\n            });\r\n        }\r\n    };\r\n    BlockManager.prototype.initCamera = function () {\r\n        var camera = this.scene.cameras.main;\r\n        if (this.mCameras) {\r\n            var main = this.mCameras.camera;\r\n            var bound = main.getBounds();\r\n            camera.setBounds(bound.x, bound.y, bound.width, bound.height);\r\n            this.updatePosition();\r\n            camera.setScroll(main.scrollX, main.scrollY);\r\n            this.mCameras.addCamera(camera);\r\n        }\r\n    };\r\n    BlockManager.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.mGrids; _i < _a.length; _i++) {\r\n            var grid = _a[_i];\r\n            grid.destroy();\r\n        }\r\n        this.mGrids.length = 0;\r\n        if (this.mContainer) {\r\n            this.mContainer.destroy(true);\r\n        }\r\n    };\r\n    Object.defineProperty(BlockManager.prototype, "world", {\r\n        get: function () {\r\n            return this.mWorld;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BlockManager.prototype, "scenery", {\r\n        get: function () {\r\n            return this.mScenery;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BlockManager.prototype.fixPosition = function (props) {\r\n        if (!props)\r\n            return;\r\n        var offset = this.offset;\r\n        if (props.x !== undefined) {\r\n            props.x = (offset.x + props.x) * this.mWorld.scaleRatio;\r\n        }\r\n        if (props.y !== undefined) {\r\n            props.y = (offset.y + props.y) * this.mWorld.scaleRatio;\r\n        }\r\n        return props;\r\n    };\r\n    Object.defineProperty(BlockManager.prototype, "offset", {\r\n        get: function () {\r\n            var os = { x: 0, y: 0 };\r\n            var x = 0;\r\n            var y = 0;\r\n            if (this.mScenery) {\r\n                if (this.mScenery.fit === _scenery__WEBPACK_IMPORTED_MODULE_4__["Fit"].Center) {\r\n                    var size = this.mRoom.roomSize;\r\n                    var _a = this.mScenery, width = _a.width, height = _a.height;\r\n                    x = size.sceneWidth - width >> 1;\r\n                    y = size.sceneHeight - height >> 1;\r\n                }\r\n            }\r\n            return { x: x, y: y };\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return BlockManager;\r\n}());\r\n\r\nvar Block = /** @class */ (function (_super) {\r\n    __extends(Block, _super);\r\n    function Block(scene, key) {\r\n        var _this = _super.call(this, scene, 0, 0) || this;\r\n        _this.mLoaded = false;\r\n        _this.mInCamera = false;\r\n        _this.mKey = key;\r\n        _this.setOrigin(0);\r\n        return _this;\r\n        // this.mRectangle = new Phaser.Geom.Rectangle(this.x, this.y, 1, 1);\r\n    }\r\n    Block.prototype.checkCamera = function (val) {\r\n        if (this.mInCamera !== val) {\r\n            this.mInCamera = val;\r\n            if (this.mLoaded) {\r\n                // TODO\r\n                // this.setActive(val);\r\n            }\r\n            else {\r\n                this.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes(this.mKey));\r\n            }\r\n        }\r\n    };\r\n    Block.prototype.setRectangle = function (x, y, width, height, scale) {\r\n        if (scale === void 0) { scale = 1; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.mRectangle = new Phaser.Geom.Rectangle(x * scale, y * scale, width * scale, height * scale);\r\n    };\r\n    Object.defineProperty(Block.prototype, "rectangle", {\r\n        get: function () {\r\n            return this.mRectangle;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Block.prototype.onLoadComplete = function (file) {\r\n        _super.prototype.onLoadComplete.call(this, file);\r\n        if (this.texture) {\r\n            this.mLoaded = true;\r\n            this.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n            this.mRectangle.setSize(this.width, this.height);\r\n        }\r\n    };\r\n    return Block;\r\n}(_ui_components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"]));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/sky.box/block.manager.ts?')},"./src/rooms/sky.box/editor.block.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorBlockManager", function() { return EditorBlockManager; });\n/* harmony import */ var _block_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./block.manager */ "./src/rooms/sky.box/block.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar EditorBlockManager = /** @class */ (function (_super) {\r\n    __extends(EditorBlockManager, _super);\r\n    function EditorBlockManager(scenery, room) {\r\n        return _super.call(this, scenery, room) || this;\r\n    }\r\n    EditorBlockManager.prototype.move = function () {\r\n    };\r\n    return EditorBlockManager;\r\n}(_block_manager__WEBPACK_IMPORTED_MODULE_0__["BlockManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/sky.box/editor.block.manager.ts?')},"./src/rooms/sky.box/editor.sky.box.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorSkyBoxManager", function() { return EditorSkyBoxManager; });\n/* harmony import */ var _sky_box_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sky.box.manager */ "./src/rooms/sky.box/sky.box.manager.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _scenery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scenery */ "./src/rooms/sky.box/scenery.ts");\n/* harmony import */ var _editor_block_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editor.block.manager */ "./src/rooms/sky.box/editor.block.manager.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditorSkyBoxManager = /** @class */ (function (_super) {\r\n    __extends(EditorSkyBoxManager, _super);\r\n    function EditorSkyBoxManager(room) {\r\n        var _this = _super.call(this, room) || this;\r\n        var connection = room.connection;\r\n        if (connection) {\r\n            connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_ADD_SCENERY, _this.onAddSceneryHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_UPDATE_SCENERY, _this.onUpdateSceneryHandler);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SCENERY, _this.onDeleteSceneryHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorSkyBoxManager.prototype.add = function (scenery) {\r\n        this.mScenetys.set(scenery.id, new _editor_block_manager__WEBPACK_IMPORTED_MODULE_4__["EditorBlockManager"](scenery, this.mRoom));\r\n    };\r\n    EditorSkyBoxManager.prototype.fetch = function (id) {\r\n        if (!this.mScenetys) {\r\n            return;\r\n        }\r\n        this.mSelected = this.mScenetys.get(id);\r\n    };\r\n    EditorSkyBoxManager.prototype.move = function (pointer) {\r\n        if (!this.selected) {\r\n            return;\r\n        }\r\n        var scenery = this.mSelected.scenery;\r\n        if (!scenery) {\r\n            return;\r\n        }\r\n        var offset = scenery.offset;\r\n        offset.x += (pointer.x - pointer.prevPosition.x) / this.mRoom.world.scaleRatio;\r\n        offset.y += (pointer.y - pointer.prevPosition.y) / this.mRoom.world.scaleRatio;\r\n        this.mSelected.updatePosition();\r\n        this.onSyncSceneryOffset();\r\n    };\r\n    EditorSkyBoxManager.prototype.keyboardMove = function (keyCode) {\r\n        if (!this.mSelected) {\r\n            return;\r\n        }\r\n        var scenery = this.mSelected.scenery;\r\n        if (!scenery) {\r\n            return;\r\n        }\r\n        var offset = scenery.offset;\r\n        switch (keyCode) {\r\n            case 37:\r\n            case 65:\r\n                offset.x--;\r\n                break;\r\n            case 38:\r\n            case 87:\r\n                offset.y--;\r\n                break;\r\n            case 39:\r\n            case 68:\r\n                offset.x++;\r\n                break;\r\n            case 40:\r\n            case 83:\r\n                offset.y++;\r\n                break;\r\n        }\r\n        this.mSelected.updatePosition();\r\n        this.onSyncSceneryOffset();\r\n    };\r\n    EditorSkyBoxManager.prototype.removeSelect = function () {\r\n        if (this.mSelected) {\r\n            this.mSelected = undefined;\r\n        }\r\n    };\r\n    EditorSkyBoxManager.prototype.onAddSceneryHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.add(new _scenery__WEBPACK_IMPORTED_MODULE_3__["Scenery"](content));\r\n    };\r\n    EditorSkyBoxManager.prototype.onUpdateSceneryHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.update(new _scenery__WEBPACK_IMPORTED_MODULE_3__["Scenery"](content));\r\n    };\r\n    EditorSkyBoxManager.prototype.onDeleteSceneryHandler = function (packet) {\r\n        var content = packet.content;\r\n        var ids = content.ids;\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.remove(id);\r\n        }\r\n    };\r\n    EditorSkyBoxManager.prototype.onSyncSceneryOffset = function () {\r\n        var scenery = this.mSelected.scenery;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_UPDATE_SCENERY);\r\n        var content = packet.content;\r\n        content.id = scenery.id;\r\n        var offset = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].PBPoint2f.create();\r\n        Object.assign(offset, scenery.offset);\r\n        content.offset = offset;\r\n        this.mRoom.connection.send(packet);\r\n    };\r\n    Object.defineProperty(EditorSkyBoxManager.prototype, "selected", {\r\n        get: function () {\r\n            return this.mSelected;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return EditorSkyBoxManager;\r\n}(_sky_box_manager__WEBPACK_IMPORTED_MODULE_0__["SkyBoxManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/sky.box/editor.sky.box.manager.ts?')},"./src/rooms/sky.box/scenery.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Scenery", function() { return Scenery; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Fit", function() { return Fit; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n\r\nvar Scenery = /** @class */ (function () {\r\n    function Scenery(scenery) {\r\n        this.mID = scenery.id;\r\n        this.mDepth = scenery.depth;\r\n        this.mUris = [];\r\n        var uris = null;\r\n        if (Array.isArray(scenery.uris)) {\r\n            uris = scenery.uris;\r\n        }\r\n        else {\r\n            uris = scenery.uris.value;\r\n        }\r\n        if (uris.length < 1) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(Scenery.name + ": scenery uris is empty");\r\n        }\r\n        for (var i = 0; i < uris.length; i++) {\r\n            var val = uris[i].value || uris;\r\n            this.mUris[i] = new Array(val.length);\r\n            for (var j = 0; j < val.length; j++) {\r\n                this.mUris[i][j] = val[j];\r\n            }\r\n        }\r\n        this.mSpeed = scenery.speed || 1;\r\n        if (!scenery.width) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(Scenery.name + ": scenery width is " + scenery.width);\r\n        }\r\n        if (!scenery.height) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(Scenery.name + ": scenery height is " + scenery.height);\r\n        }\r\n        this.mWidth = scenery.width;\r\n        this.mHeight = scenery.height;\r\n        this.mFit = scenery.fit;\r\n        this.mOffset = scenery.offset || { x: 0, y: 0 };\r\n    }\r\n    Object.defineProperty(Scenery.prototype, "width", {\r\n        get: function () {\r\n            return this.mWidth;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "height", {\r\n        get: function () {\r\n            return this.mHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "depth", {\r\n        get: function () {\r\n            return this.mDepth;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "offset", {\r\n        get: function () {\r\n            return this.mOffset;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "speed", {\r\n        get: function () {\r\n            return this.mSpeed;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "uris", {\r\n        get: function () {\r\n            return this.mUris;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Scenery.prototype, "fit", {\r\n        get: function () {\r\n            return this.mFit;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Scenery;\r\n}());\r\n\r\nvar Fit;\r\n(function (Fit) {\r\n    Fit[Fit["Center"] = 1] = "Center";\r\n    Fit[Fit["Fill"] = 2] = "Fill";\r\n    Fit[Fit["Stretch"] = 3] = "Stretch";\r\n    Fit[Fit["Repeat"] = 4] = "Repeat";\r\n})(Fit || (Fit = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/sky.box/scenery.ts?')},"./src/rooms/sky.box/sky.box.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SkyBoxManager", function() { return SkyBoxManager; });\n/* harmony import */ var _block_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./block.manager */ "./src/rooms/sky.box/block.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar SkyBoxManager = /** @class */ (function (_super) {\r\n    __extends(SkyBoxManager, _super);\r\n    function SkyBoxManager(room) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = room;\r\n        _this.mScenetys = new Map();\r\n        return _this;\r\n    }\r\n    SkyBoxManager.prototype.add = function (scenery) {\r\n        // if (scenery.id === 1896802976) {\r\n        //   return;\r\n        // }\r\n        var blockManager = new _block_manager__WEBPACK_IMPORTED_MODULE_0__["BlockManager"](scenery, this.mRoom);\r\n        this.mScenetys.set(scenery.id, blockManager);\r\n        // if (this.mStateMap) {\r\n        //   blockManager.setState(this.mStateMap);\r\n        // }\r\n    };\r\n    SkyBoxManager.prototype.update = function (scenery) {\r\n        var block = this.mScenetys.get(scenery.id);\r\n        if (block) {\r\n            block.update(scenery);\r\n        }\r\n    };\r\n    SkyBoxManager.prototype.remove = function (id) {\r\n        var block = this.mScenetys.get(id);\r\n        if (block) {\r\n            block.destroy();\r\n        }\r\n    };\r\n    SkyBoxManager.prototype.setState = function (states) {\r\n        if (!this.mStateMap) {\r\n            this.mStateMap = new Map();\r\n        }\r\n        this.mStateMap.set(states.name, states);\r\n        this.mScenetys.forEach(function (block) {\r\n            block.setState(states);\r\n        });\r\n    };\r\n    SkyBoxManager.prototype.destroy = function () {\r\n        if (this.mRoom) {\r\n            var connection = this.mRoom.connection;\r\n            if (connection) {\r\n                connection.removePacketListener(this);\r\n            }\r\n        }\r\n        this.mScenetys.forEach(function (scenery) { return scenery.destroy(); });\r\n    };\r\n    Object.defineProperty(SkyBoxManager.prototype, "scenery", {\r\n        get: function () {\r\n            return Array.from(this.mScenetys.values());\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return SkyBoxManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/sky.box/sky.box.manager.ts?')},"./src/rooms/state/parse.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StateParse", function() { return StateParse; });\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! buffer/ */ "./node_modules/node-libs-browser/node_modules/buffer/index.js");\n/* harmony import */ var buffer___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(buffer___WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n\r\n\r\nvar StateParse = /** @class */ (function () {\r\n    function StateParse() {\r\n    }\r\n    StateParse.decode = function (name, packet) {\r\n        if (this[name]) {\r\n            return StateParse[name](packet);\r\n        }\r\n        return StateParse.json(packet);\r\n    };\r\n    StateParse.json = function (packet) {\r\n        var buf = buffer___WEBPACK_IMPORTED_MODULE_0__["Buffer"].from(packet);\r\n        var len = buf.readUInt32BE(0);\r\n        try {\r\n            var content = buf.slice(4);\r\n            if (len === content.length) {\r\n                return JSON.parse(content.toString());\r\n            }\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error("parse packet error. packet length: " + len + " received length: " + content.length);\r\n        }\r\n        catch (error) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error(error);\r\n        }\r\n    };\r\n    return StateParse;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/state/parse.ts?')},"./src/rooms/state/state.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StateGroup", function() { return StateGroup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "State", function() { return State; });\n/* harmony import */ var _parse__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parse */ "./src/rooms/state/parse.ts");\n\r\nvar StateGroup = /** @class */ (function () {\r\n    function StateGroup() {\r\n        this.states = [];\r\n    }\r\n    StateGroup.prototype.update = function (group) {\r\n        this.mName = group.owner.name;\r\n    };\r\n    return StateGroup;\r\n}());\r\n\r\nvar State = /** @class */ (function () {\r\n    function State(state) {\r\n        this.mType = state.type;\r\n        this.mName = state.name;\r\n        if (state.packet) {\r\n            // TODO 外部拿不到packet类型\r\n            this.mPacket = _parse__WEBPACK_IMPORTED_MODULE_0__["StateParse"].decode(state.name, state.packet);\r\n        }\r\n    }\r\n    Object.defineProperty(State.prototype, "name", {\r\n        get: function () {\r\n            return this.mName;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(State.prototype, "type", {\r\n        get: function () {\r\n            return this.mType;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(State.prototype, "packet", {\r\n        get: function () {\r\n            return this.mPacket;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return State;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/state/state.group.ts?')},"./src/rooms/terrain/decorate.terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateTerrainManager", function() { return DecorateTerrainManager; });\n/* harmony import */ var _terrain_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DecorateTerrainManager = /** @class */ (function (_super) {\r\n    __extends(DecorateTerrainManager, _super);\r\n    function DecorateTerrainManager(roomService) {\r\n        var _this = _super.call(this, roomService) || this;\r\n        var miniSize = roomService.miniSize;\r\n        _this.mMap = new Array(miniSize.cols);\r\n        for (var i = 0; i < miniSize.rows; i++) {\r\n            _this.mMap[i] = new Array(miniSize.rows).fill(0);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateTerrainManager.prototype.remove = function (id) {\r\n        var terrain = _super.prototype.remove.call(this, id);\r\n        if (terrain) {\r\n            this.removeMap(terrain.model);\r\n        }\r\n        return terrain;\r\n    };\r\n    DecorateTerrainManager.prototype.canPut = function (pos45, collisionArea, origin) {\r\n        var row = 0;\r\n        var col = 0;\r\n        var map = this.map;\r\n        for (var i = 0; i < collisionArea.length; i++) {\r\n            row = i + pos45.y - origin.y;\r\n            if (row >= map.length) {\r\n                return false;\r\n            }\r\n            for (var j = 0; j < collisionArea[i].length; j++) {\r\n                col = j + pos45.x - origin.x;\r\n                if (col >= map[i].length || map[row][col] === 0) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorateTerrainManager.prototype._add = function (sprite) {\r\n        var terrain = _super.prototype._add.call(this, sprite);\r\n        var displayInfo = sprite.displayInfo;\r\n        if (displayInfo) {\r\n            this.addMap(sprite);\r\n        }\r\n        return terrain;\r\n    };\r\n    DecorateTerrainManager.prototype.onSyncSprite = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var terrain = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            terrain = this.get(sprite.id);\r\n            if (terrain) {\r\n                var sp = new _element_sprite__WEBPACK_IMPORTED_MODULE_1__["Sprite"](sprite, content.nodeType);\r\n                terrain.model = sp;\r\n                if (sp.displayInfo) {\r\n                    this.addMap(sp);\r\n                }\r\n                // terrain.setRenderable(true);\r\n            }\r\n        }\r\n    };\r\n    DecorateTerrainManager.prototype.addMap = function (sprite) {\r\n        this.setMap(sprite, 1);\r\n    };\r\n    DecorateTerrainManager.prototype.removeMap = function (sprite) {\r\n        this.setMap(sprite, 0);\r\n    };\r\n    DecorateTerrainManager.prototype.setMap = function (sprite, type) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var curAni = sprite.currentAnimation;\r\n        var aniName = curAni.name;\r\n        var flip = curAni.flip;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName, flip);\r\n        var walkArea = displayInfo.getWalkableArea(aniName, flip);\r\n        var origin = displayInfo.getOriginPoint(aniName, flip);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var hasCollisionArea = true;\r\n        if (rows === 1 && cols === 1) {\r\n            rows = 2;\r\n            cols = 2;\r\n            hasCollisionArea = false;\r\n        }\r\n        var pos = sprite.pos;\r\n        // terrain pos为60*30大格子\r\n        pos.x *= 2;\r\n        pos.y *= 2;\r\n        var _x = 0;\r\n        var _y = 0;\r\n        for (var i = 0; i < rows; i++) {\r\n            _x = pos.y + i - origin.x;\r\n            for (var j = 0; j < cols; j++) {\r\n                if ((!hasCollisionArea) || collisionArea[i][j] === 1 && walkArea[i][j] === 1) {\r\n                    _y = pos.x + j - origin.y;\r\n                    if (_x >= this.mMap.length || _y >= this.mMap[_x].length) {\r\n                        continue;\r\n                    }\r\n                    this.mMap[_x][_y] = type;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return DecorateTerrainManager;\r\n}(_terrain_manager__WEBPACK_IMPORTED_MODULE_0__["TerrainManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/decorate.terrain.manager.ts?')},"./src/rooms/terrain/editor.terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditorTerrainManager", function() { return EditorTerrainManager; });\n/* harmony import */ var _terrain_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./terrain.manager */ "./src/rooms/terrain/terrain.manager.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (undefined && undefined.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\n\r\n\r\n\r\nvar EditorTerrainManager = /** @class */ (function (_super) {\r\n    __extends(EditorTerrainManager, _super);\r\n    function EditorTerrainManager(mRoom, listener) {\r\n        var _this = _super.call(this, mRoom, listener) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.taskQueue = new Map();\r\n        _this.mEditorTerrains = new Map();\r\n        if (_this.connection) {\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_ADD_SPRITES_WITH_LOCS, _this.handleAddTerrains);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_EDITOR_REQ_CLIENT_DELETE_SPRITES_WITH_LOCS, _this.handleDeleteTerrains);\r\n        }\r\n        return _this;\r\n    }\r\n    EditorTerrainManager.prototype.addTerrains = function (terrainCoorData) {\r\n        var _this = this;\r\n        var locs = terrainCoorData.locs, key = terrainCoorData.key;\r\n        var drawLocs = locs.filter(function (loc) { return _this.canPut(loc, key); });\r\n        for (var _i = 0, drawLocs_1 = drawLocs; _i < drawLocs_1.length; _i++) {\r\n            var loc = drawLocs_1[_i];\r\n            var locId = this.genLocId(loc.x, loc.y);\r\n            var oldKey = this.mEditorTerrains.get(locId);\r\n            if (oldKey && oldKey !== key) {\r\n                this.taskQueue.set(locId, {\r\n                    action: "UPDATE",\r\n                    loc: __assign(__assign({}, loc), { key: key }),\r\n                });\r\n            }\r\n            else {\r\n                this.taskQueue.set(locId, {\r\n                    action: "ADD",\r\n                    loc: __assign(__assign({}, loc), { key: key }),\r\n                });\r\n            }\r\n        }\r\n        this.reqEditorAddTerrainsData(drawLocs, key);\r\n    };\r\n    EditorTerrainManager.prototype.reqEditorAddTerrainsData = function (locs, key) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_ADD_TERRAINS);\r\n        var content = pkt.content;\r\n        content.locs = locs;\r\n        content.key = key;\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorTerrainManager.prototype.removeTerrains = function (locations) {\r\n        for (var _i = 0, locations_1 = locations; _i < locations_1.length; _i++) {\r\n            var pos = locations_1[_i];\r\n            var locId = this.genLocId(pos.x, pos.y);\r\n            this.taskQueue.set(locId, {\r\n                action: "DELETE",\r\n                loc: {\r\n                    x: pos.x,\r\n                    y: pos.y,\r\n                },\r\n            });\r\n        }\r\n        this.reqEditorDeleteTerrainsData(locations);\r\n    };\r\n    EditorTerrainManager.prototype.reqEditorDeleteTerrainsData = function (loc) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_editor"].OPCODE._OP_CLIENT_REQ_EDITOR_DELETE_TERRAINS);\r\n        var content = pkt.content;\r\n        content.locs = loc.map(function (item) { return ({ x: item.x, y: item.y, z: item.z }); });\r\n        this.connection.send(pkt);\r\n    };\r\n    EditorTerrainManager.prototype.update = function () {\r\n        this.batchActionSprites();\r\n    };\r\n    EditorTerrainManager.prototype.handleAddTerrains = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var locs = content.locs;\r\n        var nodeType = content.nodeType;\r\n        if (nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, locs_1 = locs; _i < locs_1.length; _i++) {\r\n            var loc = locs_1[_i];\r\n            var locId = this.genLocId(loc.x, loc.y);\r\n            var oldKey = this.mEditorTerrains.get(locId);\r\n            if (oldKey && oldKey === loc.key)\r\n                continue;\r\n            this.taskQueue.set(locId, {\r\n                action: "ADD",\r\n                loc: loc,\r\n            });\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.handleDeleteTerrains = function (packet) {\r\n        if (!this.mRoom.layerManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().error("layer manager does not exist");\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var locs = content.locs;\r\n        var nodeType = content.nodeType;\r\n        if (nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, locs_2 = locs; _i < locs_2.length; _i++) {\r\n            var loc = locs_2[_i];\r\n            var locId = this.genLocId(loc.x, loc.y);\r\n            this.taskQueue.set(locId, {\r\n                action: "DELETE",\r\n                loc: loc,\r\n            });\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.canPut = function (pos, key) {\r\n        var locId = this.genLocId(pos.x, pos.y);\r\n        var roomSize = this.roomService.roomSize;\r\n        if (!roomSize)\r\n            return false;\r\n        if (pos.x < 0 || pos.y < 0 || pos.x >= roomSize.cols || pos.y >= roomSize.rows) {\r\n            return false;\r\n        }\r\n        if (this.mEditorTerrains.get(locId) === key) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    EditorTerrainManager.prototype.batchActionSprites = function () {\r\n        if (!Array.from(this.taskQueue.keys()).length) {\r\n            return;\r\n        }\r\n        var batchTasksKeys = Array.from(this.taskQueue.keys()).splice(0, 200);\r\n        for (var _i = 0, batchTasksKeys_1 = batchTasksKeys; _i < batchTasksKeys_1.length; _i++) {\r\n            var key = batchTasksKeys_1[_i];\r\n            var _a = this.taskQueue.get(key), action = _a.action, loc = _a.loc;\r\n            var locId = this.genLocId(loc.x, loc.y);\r\n            this.taskQueue.delete(key);\r\n            if (action === "ADD") {\r\n                var palette = this.mRoom.world.elementStorage.getTerrainPalette(loc.key);\r\n                if (!palette)\r\n                    continue;\r\n                var sprite = palette.createSprite({\r\n                    nodeType: pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType,\r\n                    x: loc.x,\r\n                    y: loc.y,\r\n                });\r\n                this.mEditorTerrains.set(locId, loc.key);\r\n                this.mRoom.displayObjectPool.push("terrains", locId, sprite, this);\r\n            }\r\n            else if (action === "DELETE") {\r\n                this.mEditorTerrains.delete(locId);\r\n                this.mRoom.displayObjectPool.remove("terrains", locId);\r\n            }\r\n            else if (action === "UPDATE") {\r\n                var palette = this.mRoom.world.elementStorage.getTerrainPalette(loc.key);\r\n                if (!palette)\r\n                    continue;\r\n                var sprite = palette.createSprite({\r\n                    nodeType: pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.TerrainNodeType,\r\n                    x: loc.x,\r\n                    y: loc.y,\r\n                });\r\n                this.mEditorTerrains.set(locId, loc.key);\r\n                this.mRoom.displayObjectPool.update("terrains", locId, sprite);\r\n            }\r\n        }\r\n    };\r\n    EditorTerrainManager.prototype.genLocId = function (x, y) {\r\n        return x + "_" + y;\r\n    };\r\n    return EditorTerrainManager;\r\n}(_terrain_manager__WEBPACK_IMPORTED_MODULE_0__["TerrainManager"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/editor.terrain.manager.ts?')},"./src/rooms/terrain/terrain.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TerrainManager", function() { return TerrainManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./terrain */ "./src/rooms/terrain/terrain.ts");\n/* harmony import */ var _element_sprite__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../element/sprite */ "./src/rooms/element/sprite.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar NodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType;\r\nvar TerrainManager = /** @class */ (function (_super) {\r\n    __extends(TerrainManager, _super);\r\n    function TerrainManager(mRoom, listener) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.hasAddComplete = false;\r\n        _this.mTerrains = new Map();\r\n        // add by 7 ----\r\n        _this.mPacketFrameCount = 0;\r\n        _this.mListener = listener;\r\n        if (_this.connection) {\r\n            _this.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE, _this.onAdd);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.addComplete);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_DELETE_SPRITE, _this.onRemove);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SYNC_SPRITE, _this.onSyncSprite);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_CHANGE_SPRITE_ANIMATION, _this.onChangeAnimation);\r\n        }\r\n        if (_this.mRoom && _this.mRoom.world) {\r\n            _this.mGameConfig = _this.mRoom.world.elementStorage;\r\n        }\r\n        var miniSize = _this.roomService.miniSize;\r\n        _this.mMap = new Array(miniSize.cols);\r\n        for (var i = 0; i < miniSize.rows; i++) {\r\n            _this.mMap[i] = new Array(miniSize.rows).fill(0);\r\n        }\r\n        return _this;\r\n    }\r\n    TerrainManager.prototype.init = function () {\r\n        // this.destroy();\r\n    };\r\n    TerrainManager.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n        if (!this.mTerrains)\r\n            return;\r\n        this.mTerrains.forEach(function (terrain) { return _this.remove(terrain.id); });\r\n        this.mTerrains.clear();\r\n    };\r\n    TerrainManager.prototype.get = function (id) {\r\n        var terrain = this.mTerrains.get(id);\r\n        if (!terrain) {\r\n            return;\r\n        }\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.add = function (sprites) {\r\n        for (var _i = 0, sprites_1 = sprites; _i < sprites_1.length; _i++) {\r\n            var sprite = sprites_1[_i];\r\n            this._add(sprite);\r\n        }\r\n    };\r\n    TerrainManager.prototype.remove = function (id) {\r\n        if (!this.mTerrains)\r\n            return;\r\n        var terrain = this.mTerrains.get(id);\r\n        if (terrain) {\r\n            this.mTerrains.delete(id);\r\n            terrain.destroy();\r\n        }\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.getElements = function () {\r\n        return Array.from(this.mTerrains.values());\r\n    };\r\n    TerrainManager.prototype.onAdd = function (packet) {\r\n        this.mPacketFrameCount++;\r\n        if (!this.mGameConfig) {\r\n            return;\r\n        }\r\n        var content = packet.content;\r\n        var sprites = content.sprites;\r\n        var type = content.nodeType;\r\n        var pf = content.packet;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var point;\r\n        var ids = [];\r\n        // sprites 服务端\r\n        for (var _i = 0, sprites_2 = sprites; _i < sprites_2.length; _i++) {\r\n            var sprite = sprites_2[_i];\r\n            point = sprite.point3f;\r\n            if (point) {\r\n                var s = new _element_sprite__WEBPACK_IMPORTED_MODULE_3__["Sprite"](sprite, type);\r\n                if (!s.displayInfo) {\r\n                    this.checkTerrainDisplay(s);\r\n                }\r\n                if (!s.displayInfo) {\r\n                    ids.push(s.id);\r\n                }\r\n                this._add(s);\r\n            }\r\n        }\r\n        this.fetchDisplay(ids);\r\n        if (this.mListener && this.mPacketFrameCount === pf.totalFrame) {\r\n            this.mListener.onFullPacketReceived(type);\r\n        }\r\n    };\r\n    TerrainManager.prototype._add = function (sprite) {\r\n        var terrain = this.mTerrains.get(sprite.id);\r\n        if (!terrain) {\r\n            terrain = new _terrain__WEBPACK_IMPORTED_MODULE_2__["Terrain"](sprite, this);\r\n        }\r\n        else {\r\n            terrain.model = sprite;\r\n        }\r\n        // this.addMap(sprite);\r\n        this.mTerrains.set(terrain.id || 0, terrain);\r\n        return terrain;\r\n    };\r\n    TerrainManager.prototype.addComplete = function (packet) {\r\n        this.hasAddComplete = true;\r\n    };\r\n    TerrainManager.prototype.onRemove = function (packet) {\r\n        var content = packet.content;\r\n        var type = content.nodeType;\r\n        var ids = content.ids;\r\n        if (type !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.remove(id);\r\n        }\r\n        // Logger.getInstance().log("remove terrain length: ", ids.length);\r\n    };\r\n    TerrainManager.prototype.onSyncSprite = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var terrain = null;\r\n        var sprites = content.sprites;\r\n        for (var _i = 0, sprites_3 = sprites; _i < sprites_3.length; _i++) {\r\n            var sprite = sprites_3[_i];\r\n            terrain = this.get(sprite.id);\r\n            if (terrain) {\r\n                var sp = new _element_sprite__WEBPACK_IMPORTED_MODULE_3__["Sprite"](sprite, content.nodeType);\r\n                terrain.model = sp;\r\n                // this.addMap(sp);\r\n                // terrain.setRenderable(true);\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.checkDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var displayInfo = this.roomService.world.elementStorage.getDisplayModel(sprite.bindID || sprite.id);\r\n            if (displayInfo) {\r\n                sprite.displayInfo = displayInfo;\r\n                return displayInfo;\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.checkTerrainDisplay = function (sprite) {\r\n        if (!sprite.displayInfo) {\r\n            var palette = this.roomService.world.elementStorage.getTerrainPaletteByBindId(sprite.bindID);\r\n            if (palette) {\r\n                sprite.displayInfo = palette;\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.fetchDisplay = function (ids) {\r\n        if (ids.length === 0) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_REQ_VIRTUAL_WORLD_QUERY_SPRITE_RESOURCE);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    TerrainManager.prototype.removeMap = function (sprite) {\r\n        this.setMap(sprite, 1);\r\n    };\r\n    TerrainManager.prototype.addMap = function (sprite) {\r\n        this.setMap(sprite, 0);\r\n    };\r\n    TerrainManager.prototype.setMap = function (sprite, type) {\r\n        var displayInfo = sprite.displayInfo;\r\n        if (!displayInfo) {\r\n            return;\r\n        }\r\n        var curAni = sprite.currentAnimation;\r\n        var aniName = curAni.name;\r\n        var flip = false;\r\n        var collisionArea = displayInfo.getCollisionArea(aniName, flip);\r\n        var walkArea = displayInfo.getWalkableArea(aniName, flip);\r\n        var origin = displayInfo.getOriginPoint(aniName, flip);\r\n        var rows = collisionArea.length;\r\n        var cols = collisionArea[0].length;\r\n        var hasCollisionArea = true;\r\n        if (rows === 1 && cols === 1) {\r\n            rows = 2;\r\n            cols = 2;\r\n            hasCollisionArea = false;\r\n        }\r\n        var pos = sprite.pos;\r\n        for (var i = 0; i < rows; i++) {\r\n            for (var j = 0; j < cols; j++) {\r\n                // if ((!hasCollisionArea) || collisionArea[i][j] === 1 && walkArea[i][j] === 1) {\r\n                // this.mMap[pos.x + i - origin.x][pos.y + j - origin.y] = type;\r\n                // }\r\n            }\r\n        }\r\n    };\r\n    TerrainManager.prototype.onChangeAnimation = function (packet) {\r\n        var content = packet.content;\r\n        if (content.nodeType !== NodeType.TerrainNodeType) {\r\n            return;\r\n        }\r\n        var anis = content.changeAnimation;\r\n        var ids = content.ids;\r\n        var terrain = null;\r\n        for (var _i = 0, ids_2 = ids; _i < ids_2.length; _i++) {\r\n            var id = ids_2[_i];\r\n            terrain = this.get(id);\r\n            if (terrain) {\r\n                // terrain.play(ani.animationName);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(TerrainManager.prototype, "connection", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.connection;\r\n            }\r\n            // Logger.getInstance().error("room manager is undefined");\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "roomService", {\r\n        get: function () {\r\n            return this.mRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mRoom) {\r\n                return this.mRoom.scene;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "camera", {\r\n        get: function () {\r\n            return this.camera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TerrainManager.prototype, "map", {\r\n        get: function () {\r\n            return this.mMap;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return TerrainManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/terrain.manager.ts?')},"./src/rooms/terrain/terrain.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Terrain", function() { return Terrain; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _display_terrain_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/terrain.display */ "./src/rooms/display/terrain.display.ts");\n/* harmony import */ var _cameras_block_object__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../cameras/block.object */ "./src/rooms/cameras/block.object.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Terrain = /** @class */ (function (_super) {\r\n    __extends(Terrain, _super);\r\n    function Terrain(sprite, mElementManager) {\r\n        var _this = _super.call(this, mElementManager.roomService) || this;\r\n        _this.mElementManager = mElementManager;\r\n        _this.mId = sprite.id;\r\n        _this.model = sprite;\r\n        return _this;\r\n    }\r\n    Terrain.prototype.setModel = function (val) {\r\n        this.mModel = val;\r\n        if (!val) {\r\n            return;\r\n        }\r\n        this.load(this.mModel.displayInfo);\r\n        // this.mDisplayInfo = <IFramesModel> this.mModel.displayInfo;\r\n        // this.createDisplay();\r\n        if (!this.mDisplay) {\r\n            return;\r\n        }\r\n        this.setPosition45(this.mModel.pos);\r\n        // this.addDisplay();\r\n    };\r\n    Terrain.prototype.updateModel = function (val) {\r\n    };\r\n    Terrain.prototype.load = function (displayInfo) {\r\n        this.mDisplayInfo = displayInfo;\r\n        if (!this.mDisplayInfo) {\r\n            return;\r\n        }\r\n        if (!this.mDisplay) {\r\n            this.createDisplay();\r\n        }\r\n        this.mDisplayInfo = displayInfo;\r\n        this.mDisplay.once("initialized", this.onInitializedHandler, this);\r\n        this.mDisplay.load(this.mDisplayInfo);\r\n    };\r\n    Terrain.prototype.play = function (animationName) {\r\n        if (!this.mModel) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error(Terrain.name + ": sprite is empty");\r\n            return;\r\n        }\r\n        if (this.mModel.currentAnimationName !== animationName) {\r\n            // this.mAnimationName = animationName;\r\n            this.mModel.currentAnimationName = animationName;\r\n            if (this.mDisplay) {\r\n                this.mDisplay.play(this.model.currentAnimation);\r\n            }\r\n        }\r\n    };\r\n    Terrain.prototype.setDirection = function (val) {\r\n        if (this.mDisplayInfo && this.mDisplayInfo.avatarDir)\r\n            this.mDisplayInfo.avatarDir = val;\r\n    };\r\n    Terrain.prototype.getDirection = function () {\r\n        return this.mDisplayInfo && this.mDisplayInfo.avatarDir ? this.mDisplayInfo.avatarDir : 3;\r\n    };\r\n    Terrain.prototype.setPosition = function (p) {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setPosition(p.x, p.y, p.z);\r\n        }\r\n        this.setDepth();\r\n    };\r\n    Terrain.prototype.getDisplay = function () {\r\n        return this.mDisplay;\r\n    };\r\n    Terrain.prototype.showNickname = function () { };\r\n    Terrain.prototype.showEffected = function () { };\r\n    Terrain.prototype.turn = function () { };\r\n    Terrain.prototype.setAlpha = function (val) { };\r\n    Terrain.prototype.scaleTween = function () { };\r\n    Terrain.prototype.setQueue = function () { };\r\n    Terrain.prototype.mount = function () {\r\n        return this;\r\n    };\r\n    Terrain.prototype.unmount = function () {\r\n        return this;\r\n    };\r\n    Terrain.prototype.addMount = function () {\r\n        return this;\r\n    };\r\n    Terrain.prototype.removeMount = function () {\r\n        return this;\r\n    };\r\n    Terrain.prototype.destroy = function () {\r\n        if (this.mBlockable && this.mDisplay) {\r\n            this.roomService.removeBlockObject(this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Terrain.prototype.createDisplay = function () {\r\n        if (!this.mDisplayInfo) {\r\n            // Logger.getInstance().error("displayinfo does not exist, Create display failed");\r\n            return;\r\n        }\r\n        if (this.mDisplay) {\r\n            return this.mDisplay;\r\n        }\r\n        var scene = this.mElementManager.scene;\r\n        if (scene) {\r\n            this.mDisplay = new _display_terrain_display__WEBPACK_IMPORTED_MODULE_1__["TerrainDisplay"](scene, this.mElementManager.roomService, this);\r\n            this.setPosition45(this.model.pos);\r\n            this.addToBlock();\r\n            // this.mDisplay.load(this.mDisplayInfo);\r\n        }\r\n        return this.mDisplay;\r\n    };\r\n    Terrain.prototype.addDisplay = function () {\r\n        this.createDisplay();\r\n        if (!this.mDisplay) {\r\n            // Logger.getInstance().error("display does not exist");\r\n            return;\r\n        }\r\n        if (!this.mElementManager) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("element manager does not exist");\r\n            return;\r\n        }\r\n        var room = this.mElementManager.roomService;\r\n        if (!room) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("roomService does not exist");\r\n            return;\r\n        }\r\n        room.addToGround(this.mDisplay);\r\n        this.setDepth();\r\n    };\r\n    Terrain.prototype.setDepth = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setDepth(this.mDisplay.y);\r\n            if (!this.roomService) {\r\n                throw new Error("roomService is undefined");\r\n            }\r\n            var layerManager = this.roomService.layerManager;\r\n            if (!layerManager) {\r\n                throw new Error("layerManager is undefined");\r\n            }\r\n            layerManager.depthGroundDirty = true;\r\n        }\r\n    };\r\n    Terrain.prototype.onInitializedHandler = function () {\r\n        if (this.mDisplay) {\r\n            // this.mDisplay.setInteractive();\r\n            this.mDisplay.play(this.model.currentAnimation);\r\n        }\r\n    };\r\n    Terrain.prototype.setPosition45 = function (pos) {\r\n        if (!this.roomService) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("roomService does not exist");\r\n            return;\r\n        }\r\n        var point = this.roomService.transformTo90(pos);\r\n        this.setPosition(point);\r\n    };\r\n    Object.defineProperty(Terrain.prototype, "id", {\r\n        get: function () {\r\n            return this.mId;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "dir", {\r\n        get: function () {\r\n            return this.mDisplayInfo.avatarDir !== undefined ? this.mDisplayInfo.avatarDir : 3;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "roomService", {\r\n        get: function () {\r\n            if (!this.mElementManager) {\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().error("element manager is undefined");\r\n                return;\r\n            }\r\n            return this.mElementManager.roomService;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "model", {\r\n        get: function () {\r\n            return this.mModel;\r\n        },\r\n        set: function (val) {\r\n            this.setModel(val);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "currentAnimationName", {\r\n        get: function () {\r\n            if (this.mModel) {\r\n                return this.mModel.currentAnimationName;\r\n            }\r\n            return "";\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Terrain.prototype, "scene", {\r\n        get: function () {\r\n            if (this.mElementManager) {\r\n                return this.mElementManager.scene;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Terrain;\r\n}(_cameras_block_object__WEBPACK_IMPORTED_MODULE_2__["BlockObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/terrain/terrain.ts?')},"./src/rooms/wall/wall.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WallManager", function() { return WallManager; });\n/* harmony import */ var _wall__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wall */ "./src/rooms/wall/wall.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar WallManager = /** @class */ (function (_super) {\r\n    __extends(WallManager, _super);\r\n    function WallManager(mRoom) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mRoom = mRoom;\r\n        _this.mWalls = new Map();\r\n        if (_this.mRoom.connection) {\r\n            _this.mRoom.connection.addPacketListener(_this);\r\n            _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ADD_SPRITE_END, _this.onDawWallHandler);\r\n        }\r\n        return _this;\r\n    }\r\n    WallManager.prototype.destroy = function () {\r\n        if (this.mRoom.connection) {\r\n            this.mRoom.connection.removePacketListener(this);\r\n        }\r\n        this.mWalls.forEach(function (wall) { return wall.destroy(); });\r\n        this.mWalls.clear();\r\n    };\r\n    WallManager.prototype._add = function (x, y, dir) {\r\n        var pos = this.mRoom.transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_3__["Pos"](x, y));\r\n        var wall = new _wall__WEBPACK_IMPORTED_MODULE_0__["Wall"](this.mRoom, x * 1000000 + y * 1000, pos, dir);\r\n        // wall.setPosition(pos);\r\n    };\r\n    WallManager.prototype.onDawWallHandler = function (packet) {\r\n        var terrains = this.mRoom.world.elementStorage.getTerrainCollection();\r\n        if (!terrains) {\r\n            return;\r\n        }\r\n        var tmp = this.mRoom.world.getConfig().game_id.split(".");\r\n        if (tmp.length < 2) {\r\n            return;\r\n        }\r\n        if (tmp[1] !== "5e410ba50681ad5557b4d6e9") {\r\n            return;\r\n        }\r\n        var map = terrains.data;\r\n        for (var i = 0; i < map.length; i++) {\r\n            for (var j = 0; j < map[0].length; j++) {\r\n                if (map[i][j] === 0) {\r\n                    continue;\r\n                }\r\n                if (this.isUp(i, j, map)) {\r\n                    this._add(i, j, _wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].UP);\r\n                }\r\n                else if (this.isLeft(i, j, map)) {\r\n                    this._add(i, j, _wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].RIGHT);\r\n                }\r\n                else if (this.isRight(i, j, map)) {\r\n                    // if (lastW < j) {\r\n                    //   i++;\r\n                    //   break;\r\n                    // }\r\n                    this._add(i, j, _wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].LEFT);\r\n                }\r\n                else if (this.isDown(i, j, map)) {\r\n                    this._add(i, j, _wall__WEBPACK_IMPORTED_MODULE_0__["Direction"].DOWN);\r\n                }\r\n                // lastW = j;\r\n                // break;\r\n            }\r\n        }\r\n    };\r\n    WallManager.prototype.isUp = function (rows, cols, map) {\r\n        if (rows === 0) {\r\n            if (cols === 0) {\r\n                return true;\r\n            }\r\n            else if (map[rows][cols - 1] === 0) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        else if (cols === 0) {\r\n            if (rows === 0) {\r\n                return true;\r\n            }\r\n            else if (map[rows - 1][cols] === 0) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        if (map[rows - 1][cols] === 0 && map[rows][cols - 1] === 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    WallManager.prototype.isLeft = function (rows, cols, map) {\r\n        if (cols === 0) {\r\n            if (rows > 0) {\r\n                return true;\r\n            }\r\n        }\r\n        else if (rows > 0) {\r\n            if (cols > 0 && map[rows][cols - 1] === 0) {\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    WallManager.prototype.isRight = function (rows, cols, map) {\r\n        if (rows === 0) {\r\n            if (cols > 0) {\r\n                return true;\r\n            }\r\n        }\r\n        else if (cols > 0) {\r\n            if (rows > 0 && map[rows - 1][cols] === 0) {\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    WallManager.prototype.isDown = function (rows, cols, map) {\r\n        if (rows > 0 && cols > 0) {\r\n            if (map[rows - 1][cols - 1] === 0 && map[rows - 1][cols] !== 0 && map[rows][cols - 1] !== 0) {\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    return WallManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/wall/wall.manager.ts?')},"./src/rooms/wall/wall.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Direction", function() { return Direction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Wall", function() { return Wall; });\n/* harmony import */ var _cameras_block_object__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../cameras/block.object */ "./src/rooms/cameras/block.object.ts");\n/* harmony import */ var _display_wall_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../display/wall.display */ "./src/rooms/display/wall.display.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction["UP"] = "up";\r\n    Direction["LEFT"] = "left";\r\n    Direction["RIGHT"] = "right";\r\n    Direction["DOWN"] = "down";\r\n})(Direction || (Direction = {}));\r\nvar Wall = /** @class */ (function (_super) {\r\n    __extends(Wall, _super);\r\n    function Wall(room, id, pos, dir) {\r\n        var _this = _super.call(this, room) || this;\r\n        _this.room = room;\r\n        // this.mBlockable = false;\r\n        _this.mID = id;\r\n        _this.mDirection = dir;\r\n        _this.mPosition = pos;\r\n        _this.createDisplay();\r\n        return _this;\r\n    }\r\n    Wall.prototype.setPosition = function (pos) {\r\n        this.mPosition = pos;\r\n        if (this.mDisplay) {\r\n            this.mDisplay.x = pos.x;\r\n            this.mDisplay.y = pos.y;\r\n        }\r\n    };\r\n    Wall.prototype.createDisplay = function () {\r\n        // if (!this.mDisplayInfo) {\r\n        //     // Logger.getInstance().error("displayinfo does not exist, Create display failed");\r\n        //     return;\r\n        // }\r\n        if (this.mDisplay) {\r\n            return this.mDisplay;\r\n        }\r\n        var scene = this.room.scene;\r\n        if (scene) {\r\n            this.mDisplay = new _display_wall_display__WEBPACK_IMPORTED_MODULE_1__["WallDisplay"](scene, this.room);\r\n            // this.setPosition(this.mPosition.x, this.mPosition.y);\r\n            this.setPosition(this.mPosition);\r\n            this.mDisplay.once("initialized", this.onInitializedHandler, this);\r\n            this.mDisplay.loadDisplay(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("wall/wall.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("wall/wall.json"));\r\n            this.addToBlock();\r\n            // this.mDisplay.load(this.mDisplayInfo);\r\n        }\r\n        return this.mDisplay;\r\n    };\r\n    Wall.prototype.onInitializedHandler = function () {\r\n        this.mDisplay.setDir(this.mDirection);\r\n    };\r\n    Wall.prototype.addDisplay = function () {\r\n        this.createDisplay();\r\n        if (!this.mDisplay) {\r\n            // Logger.getInstance().error("display does not exist");\r\n            return;\r\n        }\r\n        this.mRoomService.addToGround(this.mDisplay, 0);\r\n        this.setDepth();\r\n    };\r\n    Wall.prototype.setDepth = function () {\r\n        if (this.mDisplay) {\r\n            this.mDisplay.setDepth(this.mDisplay.y);\r\n            if (!this.mRoomService) {\r\n                throw new Error("roomService is undefined");\r\n            }\r\n            var layerManager = this.mRoomService.layerManager;\r\n            if (!layerManager) {\r\n                throw new Error("layerManager is undefined");\r\n            }\r\n            layerManager.depthGroundDirty = true;\r\n        }\r\n    };\r\n    Object.defineProperty(Wall.prototype, "id", {\r\n        get: function () {\r\n            return this.mID;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Wall;\r\n}(_cameras_block_object__WEBPACK_IMPORTED_MODULE_0__["BlockObject"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/rooms/wall/wall.ts?')},"./src/scenes/basic.scene.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicScene", function() { return BasicScene; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar BasicScene = /** @class */ (function (_super) {\r\n    __extends(BasicScene, _super);\r\n    function BasicScene(config) {\r\n        return _super.call(this, config) || this;\r\n    }\r\n    BasicScene.prototype.setViewPort = function (x, y, width, height) {\r\n        this.cameras.main.setViewport(x, y, width, height);\r\n    };\r\n    return BasicScene;\r\n}(Phaser.Scene));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/basic.scene.ts?')},"./src/scenes/create.character.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateRoleScene", function() { return CreateRoleScene; });\n/* harmony import */ var _loading__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loading */ "./src/scenes/loading.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar CreateRoleScene = /** @class */ (function (_super) {\r\n    __extends(CreateRoleScene, _super);\r\n    function CreateRoleScene() {\r\n        return _super.call(this, { key: CreateRoleScene.name }) || this;\r\n    }\r\n    CreateRoleScene.prototype.init = function (data) {\r\n        if (data.role) {\r\n            this.role = data.role;\r\n        }\r\n    };\r\n    CreateRoleScene.prototype.create = function () {\r\n        if (this.role) {\r\n            this.game.scene.stop(_loading__WEBPACK_IMPORTED_MODULE_0__["LoadingScene"].name);\r\n            this.role.start(this);\r\n        }\r\n    };\r\n    return CreateRoleScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_1__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/create.character.ts?')},"./src/scenes/edit.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditScene", function() { return EditScene; });\n/* harmony import */ var _play__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./play */ "./src/scenes/play.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n// 编辑器用 Phaser.Scene\r\nvar EditScene = /** @class */ (function (_super) {\r\n    __extends(EditScene, _super);\r\n    function EditScene() {\r\n        return _super.call(this, { key: EditScene.name }) || this;\r\n    }\r\n    EditScene.prototype.create = function () {\r\n        this.mRoom.startPlay();\r\n    };\r\n    return EditScene;\r\n}(_play__WEBPACK_IMPORTED_MODULE_0__["PlayScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/edit.ts?')},"./src/scenes/gamepause.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GamePauseScene", function() { return GamePauseScene; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_size__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/size */ "./src/utils/size.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar GamePauseScene = /** @class */ (function (_super) {\r\n    __extends(GamePauseScene, _super);\r\n    function GamePauseScene() {\r\n        return _super.call(this, { key: GamePauseScene.name }) || this;\r\n    }\r\n    GamePauseScene.prototype.preload = function () {\r\n        this.load.image("gamepause.png", _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getRes("gamepause.png"));\r\n    };\r\n    GamePauseScene.prototype.init = function (data) {\r\n        this.mWorld = data.world;\r\n    };\r\n    GamePauseScene.prototype.create = function () {\r\n        var width = this.scale.gameSize.width;\r\n        var height = this.scale.gameSize.height;\r\n        this.bg = this.add.graphics();\r\n        this.bg.fillStyle(0, .8);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        this.pauseImg = this.add.image(width >> 1, height >> 1, "gamepause.png");\r\n        this.tipTF = this.add.text(width - 240 >> 1, height - 50, "点击任意位置开始游戏", { font: "30px Tahoma" });\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.checkSize(new _utils_size__WEBPACK_IMPORTED_MODULE_1__["Size"](width, height));\r\n        this.input.on("pointerdown", this.downHandler, this);\r\n    };\r\n    GamePauseScene.prototype.awake = function () {\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.input.on("pointerdown", this.downHandler, this);\r\n        this.scene.wake();\r\n    };\r\n    GamePauseScene.prototype.sleep = function () {\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.input.off("pointerdown", this.downHandler, this);\r\n        this.scene.sleep();\r\n    };\r\n    GamePauseScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    GamePauseScene.prototype.downHandler = function () {\r\n        this.mWorld.onFocus();\r\n    };\r\n    GamePauseScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n        this.bg.clear();\r\n        this.bg.fillStyle(0, .8);\r\n        this.bg.fillRect(0, 0, width, height);\r\n        this.pauseImg.scaleX = this.pauseImg.scaleY = this.mWorld.uiScale * .7;\r\n        this.pauseImg.x = width >> 1;\r\n        this.pauseImg.y = height >> 1;\r\n        this.tipTF.scaleX = this.tipTF.scaleY = this.mWorld.uiScale;\r\n        this.tipTF.x = width - 280 * this.mWorld.uiScale >> 1;\r\n        this.tipTF.y = height - 50 * this.mWorld.uiScale;\r\n    };\r\n    return GamePauseScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_2__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/gamepause.ts?')},"./src/scenes/loading.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingScene", function() { return LoadingScene; });\n/* harmony import */ var _utils_size__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/size */ "./src/utils/size.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError("Generator is already executing.");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nvar LoadingScene = /** @class */ (function (_super) {\r\n    __extends(LoadingScene, _super);\r\n    function LoadingScene() {\r\n        var _this = _super.call(this, { key: LoadingScene.name }) || this;\r\n        _this.mRequestCom = false;\r\n        return _this;\r\n    }\r\n    LoadingScene.prototype.preload = function () {\r\n        // atlas可以用于webgl渲染，和canvas渲染，spritesheet只能用于canvas\r\n        // this.load.image("loading_bg", Url.getRes(""))\r\n        var dpr = 2;\r\n        if (this.mWorld) {\r\n            dpr = this.mWorld.uiRatio || 2;\r\n        }\r\n        this.load.atlas("curtain", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/curtain.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/curtain.json"));\r\n        this.load.atlas("loading", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/loading.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/loading.json"));\r\n        this.load.atlas("grass", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/grass.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "loading/grass.json"));\r\n        this.load.script("webfont", "./resources/scripts/webfont/1.6.26/webfont.js");\r\n        // this.load.spritesheet("rabbit00.png", "./resources/rabbit00.png", { frameWidth: 150, frameHeight: 150 });\r\n    };\r\n    LoadingScene.prototype.init = function (data) {\r\n        this.createFont();\r\n        this.mWorld = data.world;\r\n        this.mRoom = data.room;\r\n        this.mRequestCom = false;\r\n        this.mCallback = data.callBack;\r\n    };\r\n    LoadingScene.prototype.create = function () {\r\n        try {\r\n            WebFont.load({\r\n                custom: {\r\n                    // families: ["Source Han Sans", "tt0173m_", "tt0503m_"]\r\n                    families: ["Source Han Sans", "tt0173m_", "tt0503m_"]\r\n                },\r\n            });\r\n        }\r\n        catch (error) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().warn("webfont failed to load");\r\n        }\r\n        var width = this.scale.gameSize.width;\r\n        var height = this.scale.gameSize.height;\r\n        // 手动把json配置中的frames给予anims\r\n        this.anims.create({\r\n            key: "grass_anis",\r\n            frames: this.anims.generateFrameNames("grass", { prefix: "grass_", start: 1, end: 3, zeroPad: 1, suffix: ".png" }),\r\n            frameRate: 5,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        this.anims.create({\r\n            key: "loading_anis",\r\n            frames: this.anims.generateFrameNames("loading", { prefix: "loading_", start: 1, end: 3, zeroPad: 1, suffix: ".png" }),\r\n            frameRate: 5,\r\n            repeat: -1\r\n        });\r\n        this.grass = this.add.sprite(0, height, "grass").setOrigin(0.5, 1).setScale(this.mWorld.uiScale);\r\n        // this.lo.setScale(this.mWorld.uiScale);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.grass.play("grass_anis");\r\n        this.bg = this.add.sprite(width * 0.5, 0, "loading").setScale(this.mWorld.uiScale);\r\n        this.bg.play("loading_anis");\r\n        this.curtain = new Curtain(this, this.mWorld);\r\n        // this.curtain.open().then(() => {\r\n        // this.bg.x = 0;\r\n        // this.add.tween({\r\n        //   targets: this.bg,\r\n        //   props: { x: width, rotation: -720 },\r\n        //   duration: 2000,\r\n        //   loop: -1\r\n        // });\r\n        // });\r\n        this.checkSize(new _utils_size__WEBPACK_IMPORTED_MODULE_0__["Size"](width, height));\r\n        if (this.mCallback) {\r\n            this.mCallback.call(this, this);\r\n            this.mCallback = undefined;\r\n        }\r\n    };\r\n    LoadingScene.prototype.show = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                this.awake();\r\n                if (!this.curtain) {\r\n                    return [2 /*return*/, Promise.resolve()];\r\n                }\r\n                this.bg.visible = false;\r\n                this.grass.visible = false;\r\n                return [2 /*return*/, this.curtain.open()];\r\n            });\r\n        });\r\n    };\r\n    LoadingScene.prototype.close = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                if (!this.curtain) {\r\n                    return [2 /*return*/];\r\n                }\r\n                this.bg.visible = false;\r\n                this.grass.visible = false;\r\n                return [2 /*return*/, this.curtain.close()];\r\n            });\r\n        });\r\n    };\r\n    LoadingScene.prototype.awake = function (data) {\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scene.wake();\r\n    };\r\n    LoadingScene.prototype.sleep = function () {\r\n        var _this = this;\r\n        if (this.curtain) {\r\n            this.bg.visible = false;\r\n            this.grass.visible = false;\r\n            this.curtain.close().then(function () {\r\n                _this.scale.off("resize", _this.checkSize, _this);\r\n                _this.scene.sleep();\r\n            });\r\n        }\r\n        else {\r\n            this.scale.off("resize", this.checkSize, this);\r\n            this.scene.sleep();\r\n        }\r\n    };\r\n    LoadingScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    LoadingScene.prototype.checkSize = function (size) {\r\n        var width = size.width, height = size.height;\r\n        this.grass.x = width * 0.5;\r\n        this.grass.y = height;\r\n        // this.bg.x = 0; // + this.bg.width * this.bg.originX;\r\n        this.bg.y = (height - 4 * this.mWorld.uiRatio) - this.bg.displayHeight * this.bg.originY;\r\n    };\r\n    LoadingScene.prototype.createFont = function () {\r\n        var element = document.createElement("style");\r\n        document.head.appendChild(element);\r\n        var sheet = element.sheet;\r\n        // const styles = "@font-face { font-family: \'Source Han Sans\'; src: url(\'./resources/fonts/otf/SourceHanSansTC-Regular.otf\') format(\'opentype\');font-display:swap; }\\n";\r\n        var styles2 = "@font-face { font-family: \'tt0173m_\'; src: url(\'./resources/fonts/en/tt0173m_.ttf\') format(\'truetype\');font-display:swap }\\n";\r\n        var styles3 = "@font-face { font-family: \'tt0503m_\'; src: url(\'./resources/fonts/en/tt0503m_.ttf\') format(\'truetype\'); font-display:swap}";\r\n        // sheet.insertRule(styles, 0);\r\n        sheet.insertRule(styles2, 0);\r\n        sheet.insertRule(styles3, 0);\r\n    };\r\n    return LoadingScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_3__["BasicScene"]));\r\n\r\nvar Curtain = /** @class */ (function () {\r\n    function Curtain(scene, world) {\r\n        this.scene = scene;\r\n        this.key = "curtain";\r\n        this.upDisplay = this.scene.add.image(0, 0, this.key, "up.png").setOrigin(0).setVisible(false).setScale(world.uiScale);\r\n        this.downDisplay = this.scene.add.image(0, 0, this.key, "down.png").setOrigin(0, 1).setVisible(false).setScale(world.uiScale);\r\n    }\r\n    Curtain.prototype.open = function () {\r\n        var _this = this;\r\n        this.upDisplay.visible = true;\r\n        this.downDisplay.visible = true;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this.scene.cameras.main)\r\n                resolve();\r\n            var height = _this.scene.cameras.main.height;\r\n            _this.upDisplay.y = -_this.upDisplay.displayHeight;\r\n            _this.downDisplay.y = height + _this.downDisplay.displayHeight;\r\n            _this.upTween = _this.scene.add.tween({\r\n                targets: _this.upDisplay,\r\n                props: { y: 0 },\r\n                duration: 1000\r\n            });\r\n            _this.downTween = _this.scene.add.tween({\r\n                targets: _this.downDisplay,\r\n                props: { y: height },\r\n                duration: 1000,\r\n                onComplete: function () {\r\n                    _this.upDisplay.visible = false;\r\n                    _this.downDisplay.visible = false;\r\n                    _this.clearTween();\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Curtain.prototype.close = function () {\r\n        var _this = this;\r\n        this.downDisplay.visible = true;\r\n        this.upDisplay.visible = true;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this.scene.cameras.main)\r\n                resolve();\r\n            var height = _this.scene.cameras.main.height;\r\n            _this.upDisplay.y = 0;\r\n            _this.downDisplay.y = height;\r\n            _this.upTween = _this.scene.add.tween({\r\n                targets: _this.upDisplay,\r\n                props: { y: -_this.upDisplay.displayHeight },\r\n                duration: 1000\r\n            });\r\n            _this.downTween = _this.scene.add.tween({\r\n                targets: _this.downDisplay,\r\n                props: { y: height + _this.downDisplay.displayHeight },\r\n                duration: 1000,\r\n                onComplete: function () {\r\n                    _this.downDisplay.visible = false;\r\n                    _this.upDisplay.visible = false;\r\n                    _this.clearTween();\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Curtain.prototype.destroy = function () {\r\n        this.destroy();\r\n    };\r\n    Curtain.prototype.clearTween = function () {\r\n        if (this.upTween) {\r\n            this.upTween.stop();\r\n            this.upTween = null;\r\n        }\r\n        if (this.downTween) {\r\n            this.downTween.stop();\r\n            this.downTween = null;\r\n        }\r\n    };\r\n    return Curtain;\r\n}());\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/loading.ts?')},"./src/scenes/login.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoginScene", function() { return LoginScene; });\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _ui_alert_PopUpTextUI__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ui/alert/PopUpTextUI */ "./src/ui/alert/PopUpTextUI.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_size__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/size */ "./src/utils/size.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\n/* harmony import */ var _lib_rexui_lib_ui_combobox_Combobox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../lib/rexui/lib/ui/combobox/Combobox */ "./lib/rexui/lib/ui/combobox/Combobox.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n// 编辑器用 Phaser.Scene\r\nvar LoginScene = /** @class */ (function (_super) {\r\n    __extends(LoginScene, _super);\r\n    function LoginScene() {\r\n        var _this = _super.call(this, { key: LoginScene.name }) || this;\r\n        _this.mCurTabIndex = 0;\r\n        _this.mHei = 0;\r\n        return _this;\r\n    }\r\n    LoginScene.prototype.preload = function () {\r\n        this.load.atlas("login", "./resources/ui/login/login.png", "./resources/ui/login/login.json");\r\n    };\r\n    LoginScene.prototype.create = function () {\r\n        var loginRes = "login";\r\n        var width = this.scale.gameSize.width;\r\n        var height = this.scale.gameSize.height;\r\n        this.rect = this.add.graphics();\r\n        this.rect.fillStyle(0);\r\n        this.rect.fillRect(0, 0, width, height);\r\n        var accountData = localStorage.getItem("account");\r\n        var logo = this.make.image(undefined, false);\r\n        logo.setTexture(loginRes, "login_logo");\r\n        this.mHei += logo.height;\r\n        this.mParentCon = this.add.container(width >> 1, (height >> 1) + 100);\r\n        this.mBg = this.make.image(undefined, false);\r\n        this.mHei += this.mBg.height + 10;\r\n        this.mEnterBtn = this.make.image(undefined, false);\r\n        this.mEnterBtn.setTexture(loginRes, "login_loginBtn");\r\n        this.mEnterBtn.x = 123;\r\n        this.mQuickBtn = this.make.image(undefined, false);\r\n        this.mQuickBtn.setTexture(loginRes, "login_quickBtn");\r\n        this.mQuickBtn.x = 123;\r\n        this.mQuickBtn.y = -38;\r\n        this.mSendCodeBtn = this.make.image(undefined, false);\r\n        this.mSendCodeBtn.setTexture(loginRes, "login_sendBtn");\r\n        this.mSendCodeBtn.x = 10;\r\n        this.mSendCodeBtn.y = 67;\r\n        this.mTab0 = this.make.image(undefined, false);\r\n        this.mTab0.setTexture(loginRes, "login_tabSelect");\r\n        this.mTab0.x = -105;\r\n        this.mTab0.y = -38;\r\n        this.mTab1 = this.make.image(undefined, false);\r\n        this.mTab1.setTexture(loginRes, "login_tabUnSelect");\r\n        this.mTab1.x = 7;\r\n        this.mTab1.y = -38;\r\n        this.mInputBg_long0 = this.make.image(undefined, false);\r\n        this.mInputBg_long0.setTexture(loginRes, "login_inputLong");\r\n        this.mInputBg_long0.x = -50;\r\n        this.mInputBg_long0.y = 15;\r\n        this.mInputBg_long1 = this.make.image(undefined, false);\r\n        this.mInputBg_long1.setTexture(loginRes, "login_inputLong");\r\n        this.mInputBg_long1.x = -50;\r\n        this.mInputBg_long1.y = 67;\r\n        this.mInputBg_small = this.make.image(undefined, false);\r\n        this.mInputBg_small.setTexture(loginRes, "login_inputBg");\r\n        this.mInputBg_small.x = -105;\r\n        this.mInputBg_small.y = 67;\r\n        this.mSizeTF = this.add.text(10, 50, "", {\r\n            style: { color: "#000000" },\r\n            wordWrap: { width: 800, useAdvancedWrap: true },\r\n        });\r\n        this.mSizeTF.setFontSize(20);\r\n        this.mTabDic = new Map();\r\n        this.mNameInputTxt = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 190, 15, {\r\n            type: "input",\r\n            placeholder: "用戶名",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(200, 20)\r\n            .setOrigin(0, 0);\r\n        this.mPassWordInputTxt = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 190, 15, {\r\n            type: "password",\r\n            placeholder: "密码",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(200, 20)\r\n            .setOrigin(0, 0);\r\n        this.mVerificationCodeTxt = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this, 0, 0, 100, 15, {\r\n            type: "input",\r\n            placeholder: "验证码",\r\n            fontFamily: "YaHei",\r\n            fontSize: "14px",\r\n            color: "#847C7C",\r\n        })\r\n            .resize(100, 20)\r\n            .setOrigin(0, 0);\r\n        this.mNameInputTxt.x = -140;\r\n        this.mNameInputTxt.y = 4;\r\n        this.mPassWordInputTxt.x = -140;\r\n        this.mPassWordInputTxt.y = 55;\r\n        this.mVerificationCodeTxt.x = -140;\r\n        this.mVerificationCodeTxt.y = 55;\r\n        // this.mtxt0 = this.add.text(-145, -46, "手机号登录", { fontFamily: "YaHei" });\r\n        // this.mtxt1 = this.add.text(-35, -46, "用户号登录", { fontFamily: "YaHei" });\r\n        // this.mtxt2 = this.add.text(90, -46, "快速游戏", { fontFamily: "YaHei" });\r\n        // this.mtxt3 = this.add.text(108, 33, "登录", { fontFamily: "YaHei" });\r\n        // this.mtxt4 = this.add.text(-97, 37, "登录其他账号", { fontFamily: "YaHei" });\r\n        // this.mtxt5 = this.add.text(-6, 57, "发送", { fontFamily: "YaHei" });\r\n        this.mtxt0 = this.make.text(undefined, false);\r\n        this.mtxt1 = this.make.text(undefined, false);\r\n        this.mtxt2 = this.make.text(undefined, false);\r\n        this.mtxt3 = this.make.text(undefined, false);\r\n        this.mtxt4 = this.make.text(undefined, false);\r\n        this.mtxt5 = this.make.text(undefined, false);\r\n        this.mtxt0.x = -145;\r\n        this.mtxt0.y = -46;\r\n        this.mtxt1.x = -35;\r\n        this.mtxt1.y = -46;\r\n        this.mtxt2.x = 90;\r\n        this.mtxt2.y = -46;\r\n        this.mtxt3.x = 108;\r\n        this.mtxt3.y = 33;\r\n        this.mtxt4.x = -97;\r\n        this.mtxt4.y = 37;\r\n        this.mtxt5.x = -6;\r\n        this.mtxt5.y = 57;\r\n        this.mtxt0.setFontFamily("YaHei");\r\n        this.mtxt0.setText("手机号登录");\r\n        this.mtxt1.setFontFamily("YaHei");\r\n        this.mtxt1.setText("用户号登录");\r\n        this.mtxt2.setFontFamily("YaHei");\r\n        this.mtxt2.setText("快速游戏");\r\n        this.mtxt3.setFontFamily("YaHei");\r\n        this.mtxt3.setText("登录");\r\n        this.mtxt4.setFontFamily("YaHei");\r\n        this.mtxt4.setText("登录其他账号");\r\n        this.mtxt5.setFontFamily("YaHei");\r\n        this.mtxt5.setText("发送");\r\n        var config = {\r\n            wid: 220,\r\n            hei: 36,\r\n            resKey: "login",\r\n            resPng: "./resources/ui/login/login.png",\r\n            resJson: "./resources/ui/login/login.json",\r\n            resBg: "login_inputLong",\r\n            resArrow: "login_downArrow",\r\n            fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n            up: true,\r\n            clickCallBack: this.changeID,\r\n        };\r\n        this.combobox = new _lib_rexui_lib_ui_combobox_Combobox__WEBPACK_IMPORTED_MODULE_5__["ComboBox"](this, config);\r\n        this.combobox.x = -158;\r\n        this.combobox.y = -28;\r\n        logo.x = -25;\r\n        logo.y = -logo.height / 2;\r\n        this.changePanelState(accountData);\r\n        this.mParentCon.add(logo);\r\n        this.mParentCon.add(this.mBg);\r\n        this.mParentCon.add(this.mTab0);\r\n        this.mParentCon.add(this.mTab1);\r\n        this.mParentCon.add(this.mQuickBtn);\r\n        this.mParentCon.add(this.mEnterBtn);\r\n        this.mParentCon.add(this.mSendCodeBtn);\r\n        this.mParentCon.add(this.mInputBg_long0);\r\n        this.mParentCon.add(this.mInputBg_long1);\r\n        this.mParentCon.add(this.mInputBg_small);\r\n        this.mParentCon.add(this.mNameInputTxt);\r\n        this.mParentCon.add(this.mPassWordInputTxt);\r\n        this.mParentCon.add(this.mVerificationCodeTxt);\r\n        this.mParentCon.add(this.mtxt0);\r\n        this.mParentCon.add(this.mtxt1);\r\n        this.mParentCon.add(this.mtxt2);\r\n        this.mParentCon.add(this.mtxt3);\r\n        this.mParentCon.add(this.mtxt4);\r\n        this.mParentCon.add(this.mtxt5);\r\n        this.mParentCon.add(this.combobox);\r\n        this.mTab0.setInteractive();\r\n        this.mTab1.setInteractive();\r\n        this.mQuickBtn.setInteractive();\r\n        this.mEnterBtn.setInteractive();\r\n        this.mSendCodeBtn.setInteractive();\r\n        this.mtxt4.setInteractive();\r\n        this.mTab0.tabIndex = 0;\r\n        this.mTab1.tabIndex = 1;\r\n        this.mTabDic.set(this.mTab0.tabIndex, this.mTab0);\r\n        this.mTabDic.set(this.mTab1.tabIndex, this.mTab1);\r\n        this.mCurTabIndex = 0;\r\n        this.mTab0.on("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.on("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.on("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.on("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.on("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.on("pointerdown", this.changeAccount, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scale.on("orientationchange", this.onOrientationChange, this);\r\n        this.checkSize(new _utils_size__WEBPACK_IMPORTED_MODULE_3__["Size"](width, height));\r\n    };\r\n    LoginScene.prototype.init = function (data) {\r\n        this.mConnect = data.connect;\r\n        this.mCallBack = data.callBack;\r\n        this.mWorld = data.world;\r\n    };\r\n    LoginScene.prototype.update = function () {\r\n        var orientation = this.mWorld.getSize().width > this.mWorld.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        this.mSizeTF.text =\r\n            "width:" +\r\n                this.mWorld.getSize().width +\r\n                "\\n" +\r\n                "height:" +\r\n                this.mWorld.getSize().height +\r\n                "\\n" +\r\n                "orientation:" +\r\n                orientation +\r\n                "\\n" +\r\n                "devicePixelRatio:" +\r\n                window.devicePixelRatio;\r\n    };\r\n    LoginScene.prototype.awake = function () {\r\n        this.mTab0.on("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.on("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.on("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.on("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.on("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.on("pointerdown", this.changeAccount, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        this.scale.on("orientationchange", this.onOrientationChange, this);\r\n        this.scene.wake();\r\n    };\r\n    LoginScene.prototype.sleep = function () {\r\n        this.mTab0.off("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.off("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.off("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.off("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.off("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.off("pointerdown", this.changeAccount, this);\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scale.off("orientationchange", this.onOrientationChange, this);\r\n        this.scene.sleep();\r\n    };\r\n    LoginScene.prototype.remove = function () {\r\n        this.mTab0.off("pointerdown", this.tab0Handler, this);\r\n        this.mTab1.off("pointerdown", this.tab1Handler, this);\r\n        this.mQuickBtn.off("pointerdown", this.quickHandler, this);\r\n        this.mEnterBtn.off("pointerdown", this.enterHandler, this);\r\n        this.mSendCodeBtn.off("pointerdown", this.sendCodeHandler, this);\r\n        this.mtxt4.off("pointerdown", this.changeAccount, this);\r\n        this.scale.off("resize", this.checkSize, this);\r\n        this.scale.off("orientationchange", this.onOrientationChange, this);\r\n        this.scene.remove();\r\n    };\r\n    LoginScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    LoginScene.prototype.onOrientationChange = function () {\r\n        if (this.mWorld.getConfig().platform === "app")\r\n            return;\r\n        var width = window.screen.width;\r\n        var height = window.screen.height;\r\n        this.game.scale.resize(width, height);\r\n        this.game.canvas.style.width = window.screen.width + "";\r\n        this.game.canvas.style.height = window.screen.height + "";\r\n        this.mParentCon.x = width >> 1;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mParentCon.y = (height >> 1) + 50;\r\n            }\r\n            else {\r\n                this.mParentCon.y = (height >> 1) + 50;\r\n            }\r\n        }\r\n    };\r\n    LoginScene.prototype.checkSize = function (size) {\r\n        this.mParentCon.x = size.width >> 1;\r\n        this.mParentCon.y = (size.height >> 1) + 50;\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("width:" + size.width);\r\n    };\r\n    LoginScene.prototype.changeID = function (data) {\r\n        // Logger.debug("============combobox 123" + data.text);\r\n    };\r\n    LoginScene.prototype.changeAccount = function () {\r\n        this.changePanelState(undefined);\r\n    };\r\n    LoginScene.prototype.changePanelState = function (accountData) {\r\n        var boo = !accountData;\r\n        this.verificaHandler(boo);\r\n        var bgRes = !accountData ? "login_loginBgBig" : "login_quickLoginBg";\r\n        this.mBg.setTexture("login", bgRes);\r\n        this.mEnterBtn.y = !accountData ? 40 : 15;\r\n        this.mInputBg_long0.visible = !accountData ? true : false;\r\n        // this.mInputBg_long0.y = accountData === undefined ? 15 : -10;\r\n        this.mtxt3.y = !accountData ? 35 : 8;\r\n        this.mNameInputTxt.visible = !accountData ? true : false;\r\n        this.combobox.visible = !accountData ? false : true;\r\n        // this.mNameInputTxt.y = accountData === undefined ? 5 : -20;\r\n        this.mQuickBtn.visible = !accountData ? true : false;\r\n        this.mTab0.visible = !accountData ? true : false;\r\n        this.mTab1.visible = !accountData ? true : false;\r\n        this.mInputBg_long1.visible = !accountData && this.mCurTabIndex !== 0 ? true : false;\r\n        this.mPassWordInputTxt.visible = !accountData && this.mCurTabIndex !== 0 ? true : false;\r\n        this.mtxt0.visible = !accountData ? true : false;\r\n        this.mtxt1.visible = !accountData ? true : false;\r\n        this.mtxt2.visible = !accountData ? true : false;\r\n        this.mtxt4.visible = !accountData ? false : true;\r\n        var accountObj = accountData !== undefined ? JSON.parse(accountData) : undefined;\r\n        this.mNameInputTxt.text = !accountObj ? "" : accountObj.account;\r\n        this.combobox.text = !accountObj ? [""] : [accountObj.account + ""];\r\n        this.mPassWordInputTxt.text = !accountObj ? "" : accountObj.password;\r\n        this.mParentCon.setSize(this.mBg.width, this.mHei);\r\n        this.mParentCon.scale = window.devicePixelRatio;\r\n        // this.mParentCon.scaleX = this.mParentCon.scaleY = this.mWorld.uiScale;\r\n    };\r\n    LoginScene.prototype.verificaHandler = function (show) {\r\n        this.mVerificationCodeTxt.visible = show;\r\n        this.mtxt5.visible = show;\r\n        this.mInputBg_small.visible = show;\r\n        this.mSendCodeBtn.visible = show;\r\n        this.mInputBg_long1.visible = !show;\r\n        this.mPassWordInputTxt.visible = !show;\r\n    };\r\n    LoginScene.prototype.quickHandler = function () {\r\n        this.addTween(this.mQuickBtn);\r\n        this.requestQuickLogin();\r\n    };\r\n    LoginScene.prototype.sendCodeHandler = function () {\r\n        this.addTween(this.mSendCodeBtn);\r\n        this.requestGetPhoneCode();\r\n    };\r\n    LoginScene.prototype.enterHandler = function () {\r\n        this.addTween(this.mEnterBtn);\r\n        if (!this.mSendCodeBtn.visible) {\r\n            this.requestLogin();\r\n        }\r\n        else {\r\n            this.loginByPhoneCode();\r\n        }\r\n    };\r\n    LoginScene.prototype.addTween = function (img) {\r\n        this.tweens.add({\r\n            targets: img,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: 0.5 },\r\n                scaleY: { value: 0.5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        img.scaleX = img.scaleY = 1;\r\n    };\r\n    LoginScene.prototype.tab0Handler = function (pointer) {\r\n        this.mCurTabIndex = 0;\r\n        this.tabHandler();\r\n    };\r\n    LoginScene.prototype.tab1Handler = function (pointer) {\r\n        this.mCurTabIndex = 1;\r\n        this.tabHandler();\r\n    };\r\n    LoginScene.prototype.tabHandler = function () {\r\n        var _this = this;\r\n        this.mTabDic.forEach(function (image) {\r\n            var tabRes = "";\r\n            tabRes = image.tabIndex === _this.mCurTabIndex ? "login_tabSelect" : "login_tabUnSelect";\r\n            image.setTexture("login", tabRes);\r\n        });\r\n        this.verificaHandler(!this.mCurTabIndex);\r\n    };\r\n    LoginScene.prototype.requestLogin = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.login(login.mNameInputTxt.text, login.mPassWordInputTxt.text).then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                if (login.mNameInputTxt.text && login.mPassWordInputTxt.text)\r\n                    localStorage.setItem("account", JSON.stringify({ account: login.mNameInputTxt.text, password: login.mPassWordInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_1 = new _ui_alert_PopUpTextUI__WEBPACK_IMPORTED_MODULE_1__["PopUpTextUI"](login.mWorld, login);\r\n                alert_1.show("账号密码错误");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.requestGetPhoneCode = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.requestPhoneCode(login.mNameInputTxt.text).then(function (response) {\r\n            if (response.code === 200) {\r\n                login.mVerificationCodeTxt.setText(response.data);\r\n            }\r\n            else {\r\n                var alert_2 = new _ui_alert_PopUpTextUI__WEBPACK_IMPORTED_MODULE_1__["PopUpTextUI"](login.mWorld, login);\r\n                alert_2.show("验证码获取失败");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.loginByPhoneCode = function () {\r\n        var login = this;\r\n        this.mWorld.httpService\r\n            .loginByPhoneCode(login.mNameInputTxt.text, login.mVerificationCodeTxt.text)\r\n            .then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                localStorage.setItem("accountphone", JSON.stringify({ account: login.mNameInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_3 = new _ui_alert_PopUpTextUI__WEBPACK_IMPORTED_MODULE_1__["PopUpTextUI"](login.mWorld, login);\r\n                alert_3.show("登录失败");\r\n            }\r\n        });\r\n    };\r\n    LoginScene.prototype.requestQuickLogin = function () {\r\n        var login = this;\r\n        this.mWorld.httpService.quickLogin().then(function (response) {\r\n            if (response.code === 200 || response.code === 201) {\r\n                localStorage.setItem("accountphone", JSON.stringify({ account: login.mNameInputTxt.text }));\r\n                login.mWorld.account.setAccount(response.data);\r\n                login.mCallBack(response.data);\r\n            }\r\n            else {\r\n                var alert_4 = new _ui_alert_PopUpTextUI__WEBPACK_IMPORTED_MODULE_1__["PopUpTextUI"](login.mWorld, login);\r\n                alert_4.show("登录失败");\r\n            }\r\n        });\r\n    };\r\n    return LoginScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_4__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/login.ts?')},"./src/scenes/main.ui.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MainUIScene", function() { return MainUIScene; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar MainUIScene = /** @class */ (function (_super) {\r\n    __extends(MainUIScene, _super);\r\n    function MainUIScene() {\r\n        var _this = _super.call(this, { key: MainUIScene.name }) || this;\r\n        _this.timeOutID = 0;\r\n        _this.timeOutCancelMap = {};\r\n        _this.timeOutCallerList = [];\r\n        _this.timeOutTimeMap = {};\r\n        return _this;\r\n    }\r\n    MainUIScene.prototype.preload = function () {\r\n    };\r\n    MainUIScene.prototype.init = function (data) {\r\n        this.mRoom = data.room;\r\n    };\r\n    MainUIScene.prototype.create = function () {\r\n        this.fps = this.add.text(10, 10, "", { style: { color: "#64DD17", } });\r\n        this.fps.setStroke("0x0", 1);\r\n        this.fps.setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT);\r\n        this.fps.setFontSize(20 * window.devicePixelRatio);\r\n        this.sizeTF = this.add.text(10, 50, "", { style: { color: "#64DD17" }, wordWrap: { width: 800, useAdvancedWrap: true } });\r\n        this.sizeTF.setFontSize(20 * window.devicePixelRatio);\r\n        this.sizeTF.setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT);\r\n        this.sizeTF.setStroke("#0", 3);\r\n        var world = this.mRoom.world;\r\n        if (world.game.device.os.desktop) {\r\n        }\r\n        else {\r\n            if (world.inputManager) {\r\n                world.inputManager.setScene(this);\r\n            }\r\n        }\r\n        world.uiManager.setScene(this);\r\n        // this.checkSize(this.mRoom.world.getSize());\r\n        // this.mRoom.world.game.scale.on("orientationchange", this.checkOriention, this);\r\n        // this.scale.on("resize", this.checkSize, this);\r\n    };\r\n    MainUIScene.prototype.setTimeout = function (caller, time) {\r\n        var begin = Date.now();\r\n        this.timeOutCallerList[++this.timeOutID] = caller;\r\n        this.timeOutTimeMap[this.timeOutID] = { now: begin, delay: time };\r\n        return this.timeOutID;\r\n    };\r\n    MainUIScene.prototype.clearTimeout = function (id) {\r\n        this.timeOutCancelMap[id] = true;\r\n    };\r\n    MainUIScene.prototype.update = function (time, delta) {\r\n        this.fps.setText(this.game.loop.actualFps.toFixed());\r\n        // const orientation: string = this.mRoom.world.getSize().width > this.mRoom.world.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        // this.sizeTF.text = "width:" + this.mRoom.world.getSize().width +\r\n        //   "\\n" + "height:" + this.mRoom.world.getSize().height + `\\npixelRatio: ${window.devicePixelRatio} \\nscene Scale: ${this.mRoom.world.scaleRatio} \\nuiscale：${Math.round(this.mRoom.world.scaleRatio)}`;\r\n    };\r\n    MainUIScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    // private checkOriention(orientation) {\r\n    //   this.sizeTF.text = "width:" + this.mRoom.world.getSize().width + "\\n" + "height:" + this.mRoom.world.getSize().height + "\\n" + "orientation:" + orientation + "\\n" + "orientationChange:" + orientation;\r\n    // }\r\n    MainUIScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n        var world = this.mRoom.world;\r\n        var gameSize = world.getSize();\r\n        this.sizeTF.text = "CSS size: " + world.getConfig().width + " " + world.getConfig().height + "\\n    Game size: " + gameSize.width.toFixed(2) + " " + gameSize.height.toFixed(2) + "\\n    deviceRatio: " + window.devicePixelRatio + "\\n    scene ratio: " + world.scaleRatio + "\\n    ui ratio: " + world.uiRatio + "\\n    ui scale: " + world.uiScale.toFixed(5) + "\\n    ";\r\n        //  this.sizeTF.text = "width:" + size.width + ";height:" + size.height;\r\n    };\r\n    return MainUIScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_1__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/main.ui.ts?')},"./src/scenes/play.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlayScene", function() { return PlayScene; });\n/* harmony import */ var _main_ui__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./main.ui */ "./src/scenes/main.ui.ts");\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\n/* harmony import */ var _rooms_cameras_play_camera__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../rooms/cameras/play.camera */ "./src/rooms/cameras/play.camera.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n// 游戏正式运行用 Phaser.Scene\r\nvar PlayScene = /** @class */ (function (_super) {\r\n    __extends(PlayScene, _super);\r\n    function PlayScene(config) {\r\n        return _super.call(this, config || { key: PlayScene.name }) || this;\r\n    }\r\n    PlayScene.prototype.preload = function () { };\r\n    PlayScene.prototype.init = function (data) {\r\n        if (data) {\r\n            this.mRoom = data.room;\r\n        }\r\n    };\r\n    PlayScene.prototype.create = function () {\r\n        var oldCamera = this.cameras.main;\r\n        this.cameras.addExisting(new _rooms_cameras_play_camera__WEBPACK_IMPORTED_MODULE_2__["PlayCamera"](0, 0, this.sys.scale.width, this.sys.scale.height, this.mRoom.world.scaleRatio), true);\r\n        this.cameras.remove(oldCamera);\r\n        if (!this.game.scene.getScene(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name)) {\r\n            this.game.scene.add(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name, _main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"], false);\r\n        }\r\n        var scene = this.game.scene.getScene(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name);\r\n        if (!scene.scene.isActive()) {\r\n            this.scene.launch(_main_ui__WEBPACK_IMPORTED_MODULE_0__["MainUIScene"].name, {\r\n                room: this.mRoom,\r\n            });\r\n        }\r\n        this.scene.sendToBack();\r\n        this.scale.on("orientationchange", this.checkOriention, this);\r\n        this.scale.on("resize", this.checkSize, this);\r\n        if (this.mRoom)\r\n            this.mRoom.startPlay();\r\n    };\r\n    PlayScene.prototype.update = function (time, delta) {\r\n        if (this.mRoom) {\r\n            this.mRoom.update(time, delta);\r\n        }\r\n    };\r\n    PlayScene.prototype.setViewPort = function (x, y, width, height) {\r\n        _super.prototype.setViewPort.call(this, x, y, width, height);\r\n        this.cameras.main.zoom = Math.ceil(window.devicePixelRatio);\r\n    };\r\n    PlayScene.prototype.getKey = function () {\r\n        return this.sys.config.key;\r\n    };\r\n    PlayScene.prototype.checkOriention = function (orientation) {\r\n        if (orientation === Phaser.Scale.PORTRAIT) {\r\n        }\r\n        else if (orientation === Phaser.Scale.LANDSCAPE) {\r\n        }\r\n    };\r\n    PlayScene.prototype.checkSize = function (size) {\r\n        var width = size.width;\r\n        var height = size.height;\r\n    };\r\n    return PlayScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_1__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/play.ts?')},"./src/scenes/sky.box.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SkyBoxScene", function() { return SkyBoxScene; });\n/* harmony import */ var _basic_scene__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./basic.scene */ "./src/scenes/basic.scene.ts");\n/* harmony import */ var _rooms_cameras_play_camera__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rooms/cameras/play.camera */ "./src/rooms/cameras/play.camera.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar SkyBoxScene = /** @class */ (function (_super) {\r\n    __extends(SkyBoxScene, _super);\r\n    function SkyBoxScene() {\r\n        return _super.call(this, {}) || this;\r\n    }\r\n    SkyBoxScene.prototype.init = function (data) {\r\n        if (data) {\r\n            this.skyBoxManager = data;\r\n        }\r\n    };\r\n    SkyBoxScene.prototype.create = function () {\r\n        var oldCamera = this.cameras.main;\r\n        this.cameras.addExisting(new _rooms_cameras_play_camera__WEBPACK_IMPORTED_MODULE_1__["PlayCamera"](0, 0, this.sys.scale.width, this.sys.scale.height, this.skyBoxManager.world.scaleRatio), true);\r\n        this.cameras.remove(oldCamera);\r\n        // this.scene.sendToBack();\r\n        this.skyBoxManager.startPlay(this);\r\n    };\r\n    SkyBoxScene.prototype.update = function (time, delta) {\r\n        this.skyBoxManager.check(time, delta);\r\n    };\r\n    return SkyBoxScene;\r\n}(_basic_scene__WEBPACK_IMPORTED_MODULE_0__["BasicScene"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/scenes/sky.box.ts?')},"./src/ui sync recursive ^\\.\\/.*$":function(module,exports,__webpack_require__){eval('var map = {\n\t"./Activity/ActivityMediator": "./src/ui/Activity/ActivityMediator.ts",\n\t"./Activity/ActivityMediator.ts": "./src/ui/Activity/ActivityMediator.ts",\n\t"./Activity/ActivityPanel": "./src/ui/Activity/ActivityPanel.ts",\n\t"./Activity/ActivityPanel.ts": "./src/ui/Activity/ActivityPanel.ts",\n\t"./Bubble/InteractionBubbleCell": "./src/ui/Bubble/InteractionBubbleCell.ts",\n\t"./Bubble/InteractionBubbleCell.ts": "./src/ui/Bubble/InteractionBubbleCell.ts",\n\t"./Bubble/InteractionBubbleContainer": "./src/ui/Bubble/InteractionBubbleContainer.ts",\n\t"./Bubble/InteractionBubbleContainer.ts": "./src/ui/Bubble/InteractionBubbleContainer.ts",\n\t"./Bubble/InteractiveBubble": "./src/ui/Bubble/InteractiveBubble.ts",\n\t"./Bubble/InteractiveBubble.ts": "./src/ui/Bubble/InteractiveBubble.ts",\n\t"./Bubble/InteractiveBubbleMediator": "./src/ui/Bubble/InteractiveBubbleMediator.ts",\n\t"./Bubble/InteractiveBubbleMediator.ts": "./src/ui/Bubble/InteractiveBubbleMediator.ts",\n\t"./Bubble/InteractiveBubblePanel": "./src/ui/Bubble/InteractiveBubblePanel.ts",\n\t"./Bubble/InteractiveBubblePanel.ts": "./src/ui/Bubble/InteractiveBubblePanel.ts",\n\t"./CharacterInfo/CharacterAttributePanel": "./src/ui/CharacterInfo/CharacterAttributePanel.ts",\n\t"./CharacterInfo/CharacterAttributePanel.ts": "./src/ui/CharacterInfo/CharacterAttributePanel.ts",\n\t"./CharacterInfo/CharacterEditorPanel": "./src/ui/CharacterInfo/CharacterEditorPanel.ts",\n\t"./CharacterInfo/CharacterEditorPanel.ts": "./src/ui/CharacterInfo/CharacterEditorPanel.ts",\n\t"./CharacterInfo/CharacterInfo": "./src/ui/CharacterInfo/CharacterInfo.ts",\n\t"./CharacterInfo/CharacterInfo.ts": "./src/ui/CharacterInfo/CharacterInfo.ts",\n\t"./CharacterInfo/CharacterInfoMediator": "./src/ui/CharacterInfo/CharacterInfoMediator.ts",\n\t"./CharacterInfo/CharacterInfoMediator.ts": "./src/ui/CharacterInfo/CharacterInfoMediator.ts",\n\t"./CharacterInfo/CharacterInfoPanel": "./src/ui/CharacterInfo/CharacterInfoPanel.ts",\n\t"./CharacterInfo/CharacterInfoPanel.ts": "./src/ui/CharacterInfo/CharacterInfoPanel.ts",\n\t"./CharacterInfo/GraphicsProgressBar": "./src/ui/CharacterInfo/GraphicsProgressBar.ts",\n\t"./CharacterInfo/GraphicsProgressBar.ts": "./src/ui/CharacterInfo/GraphicsProgressBar.ts",\n\t"./CharacterInfo/GridLayoutGroup": "./src/ui/CharacterInfo/GridLayoutGroup.ts",\n\t"./CharacterInfo/GridLayoutGroup.ts": "./src/ui/CharacterInfo/GridLayoutGroup.ts",\n\t"./ComponentRank/ComponentRankMediator": "./src/ui/ComponentRank/ComponentRankMediator.ts",\n\t"./ComponentRank/ComponentRankMediator.ts": "./src/ui/ComponentRank/ComponentRankMediator.ts",\n\t"./ComponentRank/ComponentRankPanel": "./src/ui/ComponentRank/ComponentRankPanel.ts",\n\t"./ComponentRank/ComponentRankPanel.ts": "./src/ui/ComponentRank/ComponentRankPanel.ts",\n\t"./Compose/Compose": "./src/ui/Compose/Compose.ts",\n\t"./Compose/Compose.ts": "./src/ui/Compose/Compose.ts",\n\t"./Compose/ComposeMediator": "./src/ui/Compose/ComposeMediator.ts",\n\t"./Compose/ComposeMediator.ts": "./src/ui/Compose/ComposeMediator.ts",\n\t"./Compose/ComposePanel": "./src/ui/Compose/ComposePanel.ts",\n\t"./Compose/ComposePanel.ts": "./src/ui/Compose/ComposePanel.ts",\n\t"./ControlF/ControlFMediator": "./src/ui/ControlF/ControlFMediator.ts",\n\t"./ControlF/ControlFMediator.ts": "./src/ui/ControlF/ControlFMediator.ts",\n\t"./ControlF/ControlFPanel": "./src/ui/ControlF/ControlFPanel.ts",\n\t"./ControlF/ControlFPanel.ts": "./src/ui/ControlF/ControlFPanel.ts",\n\t"./CutIn/CutInMediator": "./src/ui/CutIn/CutInMediator.ts",\n\t"./CutIn/CutInMediator.ts": "./src/ui/CutIn/CutInMediator.ts",\n\t"./CutIn/CutInPanel": "./src/ui/CutIn/CutInPanel.ts",\n\t"./CutIn/CutInPanel.ts": "./src/ui/CutIn/CutInPanel.ts",\n\t"./CutInMenu/CutInMenu": "./src/ui/CutInMenu/CutInMenu.ts",\n\t"./CutInMenu/CutInMenu.ts": "./src/ui/CutInMenu/CutInMenu.ts",\n\t"./CutInMenu/CutInMenuMediator": "./src/ui/CutInMenu/CutInMenuMediator.ts",\n\t"./CutInMenu/CutInMenuMediator.ts": "./src/ui/CutInMenu/CutInMenuMediator.ts",\n\t"./CutInMenu/CutInMenuPanel": "./src/ui/CutInMenu/CutInMenuPanel.ts",\n\t"./CutInMenu/CutInMenuPanel.ts": "./src/ui/CutInMenu/CutInMenuPanel.ts",\n\t"./DebugLogger/DebugLoggerMediator": "./src/ui/DebugLogger/DebugLoggerMediator.ts",\n\t"./DebugLogger/DebugLoggerMediator.ts": "./src/ui/DebugLogger/DebugLoggerMediator.ts",\n\t"./DebugLogger/DebugLoggerPanel": "./src/ui/DebugLogger/DebugLoggerPanel.ts",\n\t"./DebugLogger/DebugLoggerPanel.ts": "./src/ui/DebugLogger/DebugLoggerPanel.ts",\n\t"./DecorateControl/DecorateControlMediator": "./src/ui/DecorateControl/DecorateControlMediator.ts",\n\t"./DecorateControl/DecorateControlMediator.ts": "./src/ui/DecorateControl/DecorateControlMediator.ts",\n\t"./DecorateControl/DecorateControlPanel": "./src/ui/DecorateControl/DecorateControlPanel.ts",\n\t"./DecorateControl/DecorateControlPanel.ts": "./src/ui/DecorateControl/DecorateControlPanel.ts",\n\t"./Dialog/Dialog": "./src/ui/Dialog/Dialog.ts",\n\t"./Dialog/Dialog.ts": "./src/ui/Dialog/Dialog.ts",\n\t"./Dialog/DialogMediator": "./src/ui/Dialog/DialogMediator.ts",\n\t"./Dialog/DialogMediator.ts": "./src/ui/Dialog/DialogMediator.ts",\n\t"./Dialog/DialogPanel": "./src/ui/Dialog/DialogPanel.ts",\n\t"./Dialog/DialogPanel.ts": "./src/ui/Dialog/DialogPanel.ts",\n\t"./ElementStorage/DragManager": "./src/ui/ElementStorage/DragManager.ts",\n\t"./ElementStorage/DragManager.ts": "./src/ui/ElementStorage/DragManager.ts",\n\t"./ElementStorage/ElementStorageMediator": "./src/ui/ElementStorage/ElementStorageMediator.ts",\n\t"./ElementStorage/ElementStorageMediator.ts": "./src/ui/ElementStorage/ElementStorageMediator.ts",\n\t"./ElementStorage/ElementStoragePanel": "./src/ui/ElementStorage/ElementStoragePanel.ts",\n\t"./ElementStorage/ElementStoragePanel.ts": "./src/ui/ElementStorage/ElementStoragePanel.ts",\n\t"./ElementStorage/ElementStorate": "./src/ui/ElementStorage/ElementStorate.ts",\n\t"./ElementStorage/ElementStorate.ts": "./src/ui/ElementStorage/ElementStorate.ts",\n\t"./ElementStorage/item/Item": "./src/ui/ElementStorage/item/Item.ts",\n\t"./ElementStorage/item/Item.ts": "./src/ui/ElementStorage/item/Item.ts",\n\t"./EquipUpgrade/EquipUpgrade": "./src/ui/EquipUpgrade/EquipUpgrade.ts",\n\t"./EquipUpgrade/EquipUpgrade.ts": "./src/ui/EquipUpgrade/EquipUpgrade.ts",\n\t"./EquipUpgrade/EquipUpgradeItem": "./src/ui/EquipUpgrade/EquipUpgradeItem.ts",\n\t"./EquipUpgrade/EquipUpgradeItem.ts": "./src/ui/EquipUpgrade/EquipUpgradeItem.ts",\n\t"./EquipUpgrade/EquipUpgradeMediator": "./src/ui/EquipUpgrade/EquipUpgradeMediator.ts",\n\t"./EquipUpgrade/EquipUpgradeMediator.ts": "./src/ui/EquipUpgrade/EquipUpgradeMediator.ts",\n\t"./EquipUpgrade/EquipUpgradePanel": "./src/ui/EquipUpgrade/EquipUpgradePanel.ts",\n\t"./EquipUpgrade/EquipUpgradePanel.ts": "./src/ui/EquipUpgrade/EquipUpgradePanel.ts",\n\t"./FurniBag/FurniBag": "./src/ui/FurniBag/FurniBag.ts",\n\t"./FurniBag/FurniBag.ts": "./src/ui/FurniBag/FurniBag.ts",\n\t"./FurniBag/FurniBagMediator": "./src/ui/FurniBag/FurniBagMediator.ts",\n\t"./FurniBag/FurniBagMediator.ts": "./src/ui/FurniBag/FurniBagMediator.ts",\n\t"./FurniBag/FurniBagPanel": "./src/ui/FurniBag/FurniBagPanel.ts",\n\t"./FurniBag/FurniBagPanel.ts": "./src/ui/FurniBag/FurniBagPanel.ts",\n\t"./InfoPanel/InfoPanel": "./src/ui/InfoPanel/InfoPanel.ts",\n\t"./InfoPanel/InfoPanel.ts": "./src/ui/InfoPanel/InfoPanel.ts",\n\t"./InfoPanel/InfoPanelMediator": "./src/ui/InfoPanel/InfoPanelMediator.ts",\n\t"./InfoPanel/InfoPanelMediator.ts": "./src/ui/InfoPanel/InfoPanelMediator.ts",\n\t"./InteractivePanel/InteractivePanel": "./src/ui/InteractivePanel/InteractivePanel.ts",\n\t"./InteractivePanel/InteractivePanel.ts": "./src/ui/InteractivePanel/InteractivePanel.ts",\n\t"./InteractivePanel/InteractivePanelMediator": "./src/ui/InteractivePanel/InteractivePanelMediator.ts",\n\t"./InteractivePanel/InteractivePanelMediator.ts": "./src/ui/InteractivePanel/InteractivePanelMediator.ts",\n\t"./ItemDetail/ItemDetail": "./src/ui/ItemDetail/ItemDetail.ts",\n\t"./ItemDetail/ItemDetail.ts": "./src/ui/ItemDetail/ItemDetail.ts",\n\t"./ItemDetail/ItemDetailMediator": "./src/ui/ItemDetail/ItemDetailMediator.ts",\n\t"./ItemDetail/ItemDetailMediator.ts": "./src/ui/ItemDetail/ItemDetailMediator.ts",\n\t"./ItemPopCard/ItemPopCardMediator": "./src/ui/ItemPopCard/ItemPopCardMediator.ts",\n\t"./ItemPopCard/ItemPopCardMediator.ts": "./src/ui/ItemPopCard/ItemPopCardMediator.ts",\n\t"./ItemPopCard/ItemPopCardPanel": "./src/ui/ItemPopCard/ItemPopCardPanel.ts",\n\t"./ItemPopCard/ItemPopCardPanel.ts": "./src/ui/ItemPopCard/ItemPopCardPanel.ts",\n\t"./Market/DetailDisplay": "./src/ui/Market/DetailDisplay.ts",\n\t"./Market/DetailDisplay.ts": "./src/ui/Market/DetailDisplay.ts",\n\t"./Market/ElementDetail": "./src/ui/Market/ElementDetail.ts",\n\t"./Market/ElementDetail.ts": "./src/ui/Market/ElementDetail.ts",\n\t"./Market/Market": "./src/ui/Market/Market.ts",\n\t"./Market/Market.ts": "./src/ui/Market/Market.ts",\n\t"./Market/MarketMediator": "./src/ui/Market/MarketMediator.ts",\n\t"./Market/MarketMediator.ts": "./src/ui/Market/MarketMediator.ts",\n\t"./Market/MarketPanel": "./src/ui/Market/MarketPanel.ts",\n\t"./Market/MarketPanel.ts": "./src/ui/Market/MarketPanel.ts",\n\t"./Market/NumberCounter": "./src/ui/Market/NumberCounter.ts",\n\t"./Market/NumberCounter.ts": "./src/ui/Market/NumberCounter.ts",\n\t"./Market/TextButton": "./src/ui/Market/TextButton.ts",\n\t"./Market/TextButton.ts": "./src/ui/Market/TextButton.ts",\n\t"./Market/item": "./src/ui/Market/item.ts",\n\t"./Market/item.ts": "./src/ui/Market/item.ts",\n\t"./MessageBox/MessageBoxMediator": "./src/ui/MessageBox/MessageBoxMediator.ts",\n\t"./MessageBox/MessageBoxMediator.ts": "./src/ui/MessageBox/MessageBoxMediator.ts",\n\t"./MessageBox/MessageBoxView": "./src/ui/MessageBox/MessageBoxView.ts",\n\t"./MessageBox/MessageBoxView.ts": "./src/ui/MessageBox/MessageBoxView.ts",\n\t"./MineCar/MineCar": "./src/ui/MineCar/MineCar.ts",\n\t"./MineCar/MineCar.ts": "./src/ui/MineCar/MineCar.ts",\n\t"./MineCar/MineCarMediator": "./src/ui/MineCar/MineCarMediator.ts",\n\t"./MineCar/MineCarMediator.ts": "./src/ui/MineCar/MineCarMediator.ts",\n\t"./MineCar/MineCarPanel": "./src/ui/MineCar/MineCarPanel.ts",\n\t"./MineCar/MineCarPanel.ts": "./src/ui/MineCar/MineCarPanel.ts",\n\t"./MineSettle/MineSettle": "./src/ui/MineSettle/MineSettle.ts",\n\t"./MineSettle/MineSettle.ts": "./src/ui/MineSettle/MineSettle.ts",\n\t"./MineSettle/MineSettleMediator": "./src/ui/MineSettle/MineSettleMediator.ts",\n\t"./MineSettle/MineSettleMediator.ts": "./src/ui/MineSettle/MineSettleMediator.ts",\n\t"./MineSettle/MineSettlePanel": "./src/ui/MineSettle/MineSettlePanel.ts",\n\t"./MineSettle/MineSettlePanel.ts": "./src/ui/MineSettle/MineSettlePanel.ts",\n\t"./Notice/Notice": "./src/ui/Notice/Notice.ts",\n\t"./Notice/Notice.ts": "./src/ui/Notice/Notice.ts",\n\t"./Notice/NoticeMediator": "./src/ui/Notice/NoticeMediator.ts",\n\t"./Notice/NoticeMediator.ts": "./src/ui/Notice/NoticeMediator.ts",\n\t"./Notice/NoticePanel": "./src/ui/Notice/NoticePanel.ts",\n\t"./Notice/NoticePanel.ts": "./src/ui/Notice/NoticePanel.ts",\n\t"./PicFurniFun/PicFurniFun": "./src/ui/PicFurniFun/PicFurniFun.ts",\n\t"./PicFurniFun/PicFurniFun.ts": "./src/ui/PicFurniFun/PicFurniFun.ts",\n\t"./PicFurniFun/PicFurniFunMediator": "./src/ui/PicFurniFun/PicFurniFunMediator.ts",\n\t"./PicFurniFun/PicFurniFunMediator.ts": "./src/ui/PicFurniFun/PicFurniFunMediator.ts",\n\t"./PicFurniFun/PicFurniFunPanel": "./src/ui/PicFurniFun/PicFurniFunPanel.ts",\n\t"./PicFurniFun/PicFurniFunPanel.ts": "./src/ui/PicFurniFun/PicFurniFunPanel.ts",\n\t"./PicHandheld/PicHandheld": "./src/ui/PicHandheld/PicHandheld.ts",\n\t"./PicHandheld/PicHandheld.ts": "./src/ui/PicHandheld/PicHandheld.ts",\n\t"./PicHandheld/PicHandheldMediator": "./src/ui/PicHandheld/PicHandheldMediator.ts",\n\t"./PicHandheld/PicHandheldMediator.ts": "./src/ui/PicHandheld/PicHandheldMediator.ts",\n\t"./PicHandheld/PicHandheldPanel": "./src/ui/PicHandheld/PicHandheldPanel.ts",\n\t"./PicHandheld/PicHandheldPanel.ts": "./src/ui/PicHandheld/PicHandheldPanel.ts",\n\t"./PicHouse/PicHouse": "./src/ui/PicHouse/PicHouse.ts",\n\t"./PicHouse/PicHouse.ts": "./src/ui/PicHouse/PicHouse.ts",\n\t"./PicHouse/PicHouseInfoPanel": "./src/ui/PicHouse/PicHouseInfoPanel.ts",\n\t"./PicHouse/PicHouseInfoPanel.ts": "./src/ui/PicHouse/PicHouseInfoPanel.ts",\n\t"./PicHouse/PicHouseMediator": "./src/ui/PicHouse/PicHouseMediator.ts",\n\t"./PicHouse/PicHouseMediator.ts": "./src/ui/PicHouse/PicHouseMediator.ts",\n\t"./PicHouse/PicHousePanel": "./src/ui/PicHouse/PicHousePanel.ts",\n\t"./PicHouse/PicHousePanel.ts": "./src/ui/PicHouse/PicHousePanel.ts",\n\t"./PicHouse/PicHouseSettingPanel": "./src/ui/PicHouse/PicHouseSettingPanel.ts",\n\t"./PicHouse/PicHouseSettingPanel.ts": "./src/ui/PicHouse/PicHouseSettingPanel.ts",\n\t"./PicPropFun/PicPropFunConfig": "./src/ui/PicPropFun/PicPropFunConfig.ts",\n\t"./PicPropFun/PicPropFunConfig.ts": "./src/ui/PicPropFun/PicPropFunConfig.ts",\n\t"./PicPropFun/PicPropFunMediator": "./src/ui/PicPropFun/PicPropFunMediator.ts",\n\t"./PicPropFun/PicPropFunMediator.ts": "./src/ui/PicPropFun/PicPropFunMediator.ts",\n\t"./PicPropFun/PicPropFunPanel": "./src/ui/PicPropFun/PicPropFunPanel.ts",\n\t"./PicPropFun/PicPropFunPanel.ts": "./src/ui/PicPropFun/PicPropFunPanel.ts",\n\t"./PicRoomUpgrade/PicRoomUpgrade": "./src/ui/PicRoomUpgrade/PicRoomUpgrade.ts",\n\t"./PicRoomUpgrade/PicRoomUpgrade.ts": "./src/ui/PicRoomUpgrade/PicRoomUpgrade.ts",\n\t"./PicRoomUpgrade/PicRoomUpgradeMediator": "./src/ui/PicRoomUpgrade/PicRoomUpgradeMediator.ts",\n\t"./PicRoomUpgrade/PicRoomUpgradeMediator.ts": "./src/ui/PicRoomUpgrade/PicRoomUpgradeMediator.ts",\n\t"./PicRoomUpgrade/PicRoomUpgradePanel": "./src/ui/PicRoomUpgrade/PicRoomUpgradePanel.ts",\n\t"./PicRoomUpgrade/PicRoomUpgradePanel.ts": "./src/ui/PicRoomUpgrade/PicRoomUpgradePanel.ts",\n\t"./PicaChat/PicaChat": "./src/ui/PicaChat/PicaChat.ts",\n\t"./PicaChat/PicaChat.ts": "./src/ui/PicaChat/PicaChat.ts",\n\t"./PicaChat/PicaChatMediator": "./src/ui/PicaChat/PicaChatMediator.ts",\n\t"./PicaChat/PicaChatMediator.ts": "./src/ui/PicaChat/PicaChatMediator.ts",\n\t"./PicaChat/PicaChatPanel": "./src/ui/PicaChat/PicaChatPanel.ts",\n\t"./PicaChat/PicaChatPanel.ts": "./src/ui/PicaChat/PicaChatPanel.ts",\n\t"./PicaMainUI/PicaMainUI": "./src/ui/PicaMainUI/PicaMainUI.ts",\n\t"./PicaMainUI/PicaMainUI.ts": "./src/ui/PicaMainUI/PicaMainUI.ts",\n\t"./PicaMainUI/PicaMainUIMediator": "./src/ui/PicaMainUI/PicaMainUIMediator.ts",\n\t"./PicaMainUI/PicaMainUIMediator.ts": "./src/ui/PicaMainUI/PicaMainUIMediator.ts",\n\t"./PicaMainUI/PicaMainUIPanel": "./src/ui/PicaMainUI/PicaMainUIPanel.ts",\n\t"./PicaMainUI/PicaMainUIPanel.ts": "./src/ui/PicaMainUI/PicaMainUIPanel.ts",\n\t"./PicaMessageBox/PicaMessageBoxMediator": "./src/ui/PicaMessageBox/PicaMessageBoxMediator.ts",\n\t"./PicaMessageBox/PicaMessageBoxMediator.ts": "./src/ui/PicaMessageBox/PicaMessageBoxMediator.ts",\n\t"./PicaMessageBox/PicaMessageBoxPanel": "./src/ui/PicaMessageBox/PicaMessageBoxPanel.ts",\n\t"./PicaMessageBox/PicaMessageBoxPanel.ts": "./src/ui/PicaMessageBox/PicaMessageBoxPanel.ts",\n\t"./PicaNavigate/PicaNavigate": "./src/ui/PicaNavigate/PicaNavigate.ts",\n\t"./PicaNavigate/PicaNavigate.ts": "./src/ui/PicaNavigate/PicaNavigate.ts",\n\t"./PicaNavigate/PicaNavigateMediator": "./src/ui/PicaNavigate/PicaNavigateMediator.ts",\n\t"./PicaNavigate/PicaNavigateMediator.ts": "./src/ui/PicaNavigate/PicaNavigateMediator.ts",\n\t"./PicaNavigate/PicaNavigatePanel": "./src/ui/PicaNavigate/PicaNavigatePanel.ts",\n\t"./PicaNavigate/PicaNavigatePanel.ts": "./src/ui/PicaNavigate/PicaNavigatePanel.ts",\n\t"./PicaNotice/PicaNoticeMediator": "./src/ui/PicaNotice/PicaNoticeMediator.ts",\n\t"./PicaNotice/PicaNoticeMediator.ts": "./src/ui/PicaNotice/PicaNoticeMediator.ts",\n\t"./PicaNotice/PicaNoticePanel": "./src/ui/PicaNotice/PicaNoticePanel.ts",\n\t"./PicaNotice/PicaNoticePanel.ts": "./src/ui/PicaNotice/PicaNoticePanel.ts",\n\t"./PicaRoomList/PicaRoomListMediator": "./src/ui/PicaRoomList/PicaRoomListMediator.ts",\n\t"./PicaRoomList/PicaRoomListMediator.ts": "./src/ui/PicaRoomList/PicaRoomListMediator.ts",\n\t"./PicaRoomList/PicaRoomListPanel": "./src/ui/PicaRoomList/PicaRoomListPanel.ts",\n\t"./PicaRoomList/PicaRoomListPanel.ts": "./src/ui/PicaRoomList/PicaRoomListPanel.ts",\n\t"./PicaRoomList/RoomList": "./src/ui/PicaRoomList/RoomList.ts",\n\t"./PicaRoomList/RoomList.ts": "./src/ui/PicaRoomList/RoomList.ts",\n\t"./Rank/BasicRankPanel": "./src/ui/Rank/BasicRankPanel.ts",\n\t"./Rank/BasicRankPanel.ts": "./src/ui/Rank/BasicRankPanel.ts",\n\t"./Rank/RankMediator": "./src/ui/Rank/RankMediator.ts",\n\t"./Rank/RankMediator.ts": "./src/ui/Rank/RankMediator.ts",\n\t"./Rank/RankPanel": "./src/ui/Rank/RankPanel.ts",\n\t"./Rank/RankPanel.ts": "./src/ui/Rank/RankPanel.ts",\n\t"./ReAwardTips/ReAwardTip": "./src/ui/ReAwardTips/ReAwardTip.ts",\n\t"./ReAwardTips/ReAwardTip.ts": "./src/ui/ReAwardTips/ReAwardTip.ts",\n\t"./ReAwardTips/ReAwardTipsMediator": "./src/ui/ReAwardTips/ReAwardTipsMediator.ts",\n\t"./ReAwardTips/ReAwardTipsMediator.ts": "./src/ui/ReAwardTips/ReAwardTipsMediator.ts",\n\t"./ReAwardTips/ReAwardTipsPanel": "./src/ui/ReAwardTips/ReAwardTipsPanel.ts",\n\t"./ReAwardTips/ReAwardTipsPanel.ts": "./src/ui/ReAwardTips/ReAwardTipsPanel.ts",\n\t"./Shop/ShopMediator": "./src/ui/Shop/ShopMediator.ts",\n\t"./Shop/ShopMediator.ts": "./src/ui/Shop/ShopMediator.ts",\n\t"./Shop/ShopPanel": "./src/ui/Shop/ShopPanel.ts",\n\t"./Shop/ShopPanel.ts": "./src/ui/Shop/ShopPanel.ts",\n\t"./Shop/shop.itemSlot": "./src/ui/Shop/shop.itemSlot.ts",\n\t"./Shop/shop.itemSlot.ts": "./src/ui/Shop/shop.itemSlot.ts",\n\t"./Task/Task": "./src/ui/Task/Task.ts",\n\t"./Task/Task.ts": "./src/ui/Task/Task.ts",\n\t"./Task/TaskMediator": "./src/ui/Task/TaskMediator.ts",\n\t"./Task/TaskMediator.ts": "./src/ui/Task/TaskMediator.ts",\n\t"./Task/TaskPanel": "./src/ui/Task/TaskPanel.ts",\n\t"./Task/TaskPanel.ts": "./src/ui/Task/TaskPanel.ts",\n\t"./UserInfo/UserInfoMediator": "./src/ui/UserInfo/UserInfoMediator.ts",\n\t"./UserInfo/UserInfoMediator.ts": "./src/ui/UserInfo/UserInfoMediator.ts",\n\t"./UserInfo/UserInfoPanel": "./src/ui/UserInfo/UserInfoPanel.ts",\n\t"./UserInfo/UserInfoPanel.ts": "./src/ui/UserInfo/UserInfoPanel.ts",\n\t"./UserMenu/MenuItem": "./src/ui/UserMenu/MenuItem.ts",\n\t"./UserMenu/MenuItem.ts": "./src/ui/UserMenu/MenuItem.ts",\n\t"./UserMenu/UserMenuMediator": "./src/ui/UserMenu/UserMenuMediator.ts",\n\t"./UserMenu/UserMenuMediator.ts": "./src/ui/UserMenu/UserMenuMediator.ts",\n\t"./UserMenu/UserMenuPanel": "./src/ui/UserMenu/UserMenuPanel.ts",\n\t"./UserMenu/UserMenuPanel.ts": "./src/ui/UserMenu/UserMenuPanel.ts",\n\t"./alert/PopUpTextUI": "./src/ui/alert/PopUpTextUI.ts",\n\t"./alert/PopUpTextUI.ts": "./src/ui/alert/PopUpTextUI.ts",\n\t"./bag/IListItemRender": "./src/ui/bag/IListItemRender.ts",\n\t"./bag/IListItemRender.ts": "./src/ui/bag/IListItemRender.ts",\n\t"./bag/bagView/bagMediator": "./src/ui/bag/bagView/bagMediator.ts",\n\t"./bag/bagView/bagMediator.ts": "./src/ui/bag/bagView/bagMediator.ts",\n\t"./bag/bagView/bagPanel": "./src/ui/bag/bagView/bagPanel.ts",\n\t"./bag/bagView/bagPanel.ts": "./src/ui/bag/bagView/bagPanel.ts",\n\t"./bag/basebag": "./src/ui/bag/basebag.ts",\n\t"./bag/basebag.ts": "./src/ui/bag/basebag.ts",\n\t"./bag/baseitem": "./src/ui/bag/baseitem.ts",\n\t"./bag/baseitem.ts": "./src/ui/bag/baseitem.ts",\n\t"./bag/dragDropIcon": "./src/ui/bag/dragDropIcon.ts",\n\t"./bag/dragDropIcon.ts": "./src/ui/bag/dragDropIcon.ts",\n\t"./bag/idragable": "./src/ui/bag/idragable.ts",\n\t"./bag/idragable.ts": "./src/ui/bag/idragable.ts",\n\t"./bag/idropable": "./src/ui/bag/idropable.ts",\n\t"./bag/idropable.ts": "./src/ui/bag/idropable.ts",\n\t"./bag/item.slot": "./src/ui/bag/item.slot.ts",\n\t"./bag/item.slot.ts": "./src/ui/bag/item.slot.ts",\n\t"./bag/storage/storageMediator": "./src/ui/bag/storage/storageMediator.ts",\n\t"./bag/storage/storageMediator.ts": "./src/ui/bag/storage/storageMediator.ts",\n\t"./bag/storage/storagePanel": "./src/ui/bag/storage/storagePanel.ts",\n\t"./bag/storage/storagePanel.ts": "./src/ui/bag/storage/storagePanel.ts",\n\t"./baseView/bagGroup/bag.group": "./src/ui/baseView/bagGroup/bag.group.ts",\n\t"./baseView/bagGroup/bag.group.mediator": "./src/ui/baseView/bagGroup/bag.group.mediator.ts",\n\t"./baseView/bagGroup/bag.group.mediator.ts": "./src/ui/baseView/bagGroup/bag.group.mediator.ts",\n\t"./baseView/bagGroup/bag.group.ts": "./src/ui/baseView/bagGroup/bag.group.ts",\n\t"./baseView/baseFace.mediator": "./src/ui/baseView/baseFace.mediator.ts",\n\t"./baseView/baseFace.mediator.ts": "./src/ui/baseView/baseFace.mediator.ts",\n\t"./baseView/bottomGroup/bottom.btn.group": "./src/ui/baseView/bottomGroup/bottom.btn.group.ts",\n\t"./baseView/bottomGroup/bottom.btn.group.ts": "./src/ui/baseView/bottomGroup/bottom.btn.group.ts",\n\t"./baseView/bottomGroup/bottom.mediator": "./src/ui/baseView/bottomGroup/bottom.mediator.ts",\n\t"./baseView/bottomGroup/bottom.mediator.ts": "./src/ui/baseView/bottomGroup/bottom.mediator.ts",\n\t"./baseView/icon.btn": "./src/ui/baseView/icon.btn.ts",\n\t"./baseView/icon.btn.ts": "./src/ui/baseView/icon.btn.ts",\n\t"./baseView/icon.select.btn": "./src/ui/baseView/icon.select.btn.ts",\n\t"./baseView/icon.select.btn.ts": "./src/ui/baseView/icon.select.btn.ts",\n\t"./baseView/leftGroup/left.btn.group": "./src/ui/baseView/leftGroup/left.btn.group.ts",\n\t"./baseView/leftGroup/left.btn.group.ts": "./src/ui/baseView/leftGroup/left.btn.group.ts",\n\t"./baseView/leftGroup/left.mediator": "./src/ui/baseView/leftGroup/left.mediator.ts",\n\t"./baseView/leftGroup/left.mediator.ts": "./src/ui/baseView/leftGroup/left.mediator.ts",\n\t"./baseView/rightGroup/right.btn.group": "./src/ui/baseView/rightGroup/right.btn.group.ts",\n\t"./baseView/rightGroup/right.btn.group.ts": "./src/ui/baseView/rightGroup/right.btn.group.ts",\n\t"./baseView/rightGroup/right.mediator": "./src/ui/baseView/rightGroup/right.mediator.ts",\n\t"./baseView/rightGroup/right.mediator.ts": "./src/ui/baseView/rightGroup/right.mediator.ts",\n\t"./baseView/top.menu/top.menu.container": "./src/ui/baseView/top.menu/top.menu.container.ts",\n\t"./baseView/top.menu/top.menu.container.ts": "./src/ui/baseView/top.menu/top.menu.container.ts",\n\t"./baseView/top.menu/top.menu.mediator": "./src/ui/baseView/top.menu/top.menu.mediator.ts",\n\t"./baseView/top.menu/top.menu.mediator.ts": "./src/ui/baseView/top.menu/top.menu.mediator.ts",\n\t"./baseView/topGroup/top.btn.group": "./src/ui/baseView/topGroup/top.btn.group.ts",\n\t"./baseView/topGroup/top.btn.group.ts": "./src/ui/baseView/topGroup/top.btn.group.ts",\n\t"./baseView/topGroup/top.mediator": "./src/ui/baseView/topGroup/top.mediator.ts",\n\t"./baseView/topGroup/top.mediator.ts": "./src/ui/baseView/topGroup/top.mediator.ts",\n\t"./chat/Chat": "./src/ui/chat/Chat.ts",\n\t"./chat/Chat.ts": "./src/ui/chat/Chat.ts",\n\t"./chat/base.chat.panel": "./src/ui/chat/base.chat.panel.ts",\n\t"./chat/base.chat.panel.ts": "./src/ui/chat/base.chat.panel.ts",\n\t"./chat/chat.mediator": "./src/ui/chat/chat.mediator.ts",\n\t"./chat/chat.mediator.ts": "./src/ui/chat/chat.mediator.ts",\n\t"./chat/chatPanel.pc": "./src/ui/chat/chatPanel.pc.ts",\n\t"./chat/chatPanel.pc.ts": "./src/ui/chat/chatPanel.pc.ts",\n\t"./chat/message": "./src/ui/chat/message.ts",\n\t"./chat/message.ts": "./src/ui/chat/message.ts",\n\t"./chat/mobile/chatPanel.mobile": "./src/ui/chat/mobile/chatPanel.mobile.ts",\n\t"./chat/mobile/chatPanel.mobile.ts": "./src/ui/chat/mobile/chatPanel.mobile.ts",\n\t"./components/BasePanel": "./src/ui/components/BasePanel.ts",\n\t"./components/BasePanel.ts": "./src/ui/components/BasePanel.ts",\n\t"./components/alert.view": "./src/ui/components/alert.view.ts",\n\t"./components/alert.view.ts": "./src/ui/components/alert.view.ts",\n\t"./components/check.button": "./src/ui/components/check.button.ts",\n\t"./components/check.button.ts": "./src/ui/components/check.button.ts",\n\t"./components/checkbox.group": "./src/ui/components/checkbox.group.ts",\n\t"./components/checkbox.group.ts": "./src/ui/components/checkbox.group.ts",\n\t"./components/dynamic.image": "./src/ui/components/dynamic.image.ts",\n\t"./components/dynamic.image.ts": "./src/ui/components/dynamic.image.ts",\n\t"./components/dynamic.ninepatch": "./src/ui/components/dynamic.ninepatch.ts",\n\t"./components/dynamic.ninepatch.ts": "./src/ui/components/dynamic.ninepatch.ts",\n\t"./components/dynamic.sprite": "./src/ui/components/dynamic.sprite.ts",\n\t"./components/dynamic.sprite.ts": "./src/ui/components/dynamic.sprite.ts",\n\t"./components/input.panel": "./src/ui/components/input.panel.ts",\n\t"./components/input.panel.ts": "./src/ui/components/input.panel.ts",\n\t"./components/inputPanel": "./src/ui/components/inputPanel.ts",\n\t"./components/inputPanel.ts": "./src/ui/components/inputPanel.ts",\n\t"./components/inputTextFactory": "./src/ui/components/inputTextFactory.ts",\n\t"./components/inputTextFactory.ts": "./src/ui/components/inputTextFactory.ts",\n\t"./components/label.input": "./src/ui/components/label.input.ts",\n\t"./components/label.input.ts": "./src/ui/components/label.input.ts",\n\t"./components/message.box": "./src/ui/components/message.box.ts",\n\t"./components/message.box.ts": "./src/ui/components/message.box.ts",\n\t"./components/nine.patch": "./src/ui/components/nine.patch.ts",\n\t"./components/nine.patch.ts": "./src/ui/components/nine.patch.ts",\n\t"./components/ninepatch.button": "./src/ui/components/ninepatch.button.ts",\n\t"./components/ninepatch.button.ts": "./src/ui/components/ninepatch.button.ts",\n\t"./components/patches.config": "./src/ui/components/patches.config.ts",\n\t"./components/patches.config.ts": "./src/ui/components/patches.config.ts",\n\t"./components/radio": "./src/ui/components/radio.ts",\n\t"./components/radio.ts": "./src/ui/components/radio.ts",\n\t"./components/tab.button": "./src/ui/components/tab.button.ts",\n\t"./components/tab.button.ts": "./src/ui/components/tab.button.ts",\n\t"./decorate/decorate.manager": "./src/ui/decorate/decorate.manager.ts",\n\t"./decorate/decorate.manager.ts": "./src/ui/decorate/decorate.manager.ts",\n\t"./decorate/decorate.panel": "./src/ui/decorate/decorate.panel.ts",\n\t"./decorate/decorate.panel.ts": "./src/ui/decorate/decorate.panel.ts",\n\t"./friend/friend.mediator": "./src/ui/friend/friend.mediator.ts",\n\t"./friend/friend.mediator.ts": "./src/ui/friend/friend.mediator.ts",\n\t"./friend/friend.panel": "./src/ui/friend/friend.panel.ts",\n\t"./friend/friend.panel.ts": "./src/ui/friend/friend.panel.ts",\n\t"./layer.manager": "./src/ui/layer.manager.ts",\n\t"./layer.manager.ts": "./src/ui/layer.manager.ts",\n\t"./loadview": "./src/ui/loadview.ts",\n\t"./loadview.ts": "./src/ui/loadview.ts",\n\t"./tips/TextToolTip": "./src/ui/tips/TextToolTip.ts",\n\t"./tips/TextToolTip.ts": "./src/ui/tips/TextToolTip.ts",\n\t"./tips/itoolTip": "./src/ui/tips/itoolTip.ts",\n\t"./tips/itoolTip.ts": "./src/ui/tips/itoolTip.ts",\n\t"./tips/toolTip": "./src/ui/tips/toolTip.ts",\n\t"./tips/toolTip.ts": "./src/ui/tips/toolTip.ts",\n\t"./ui.atals.name": "./src/ui/ui.atals.name.ts",\n\t"./ui.atals.name.ts": "./src/ui/ui.atals.name.ts",\n\t"./ui.manager": "./src/ui/ui.manager.ts",\n\t"./ui.manager.ts": "./src/ui/ui.manager.ts",\n\t"./ui.mediatorType": "./src/ui/ui.mediatorType.ts",\n\t"./ui.mediatorType.ts": "./src/ui/ui.mediatorType.ts"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error("Cannot find module \'" + req + "\'");\n\t\te.code = \'MODULE_NOT_FOUND\';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = "./src/ui sync recursive ^\\\\.\\\\/.*$";\n\n//# sourceURL=webpack://TooqingCore/./src/ui_sync_^\\.\\/.*$?')},"./src/ui/Activity/ActivityMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActivityMediator", function() { return ActivityMediator; });\n/* harmony import */ var _ActivityPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ActivityPanel */ "./src/ui/Activity/ActivityPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ActivityMediator = /** @class */ (function (_super) {\r\n    __extends(ActivityMediator, _super);\r\n    function ActivityMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_1__["UIType"].Scene;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    ActivityMediator.prototype.show = function () {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _ActivityPanel__WEBPACK_IMPORTED_MODULE_0__["ActivityPanel"](this.scene, this.world);\r\n            this.mView.on("showPanel", this.onShowPanelHandler, this);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    ActivityMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    ActivityMediator.prototype.onShowPanelHandler = function (panel, data) {\r\n        if (!panel || !this.world) {\r\n            return;\r\n        }\r\n        var uiManager = this.world.uiManager;\r\n        if (data)\r\n            uiManager.showMed(panel, data);\r\n        else\r\n            uiManager.showMed(panel);\r\n    };\r\n    ActivityMediator.NAME = "ActivityMediator";\r\n    return ActivityMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Activity/ActivityMediator.ts?')},"./src/ui/Activity/ActivityPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ActivityPanel", function() { return ActivityPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ActivityPanel = /** @class */ (function (_super) {\r\n    __extends(ActivityPanel, _super);\r\n    function ActivityPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.key = "activity";\r\n        return _this;\r\n    }\r\n    ActivityPanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        this.content.x = width - 20 * this.dpr;\r\n        this.content.y = 90 * this.dpr;\r\n        this.setSize(w, h);\r\n    };\r\n    ActivityPanel.prototype.show = function (param) {\r\n        if (this.mInitialized) {\r\n            this.setInteractive();\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n        this.checkUpdateActive();\r\n    };\r\n    ActivityPanel.prototype.updateUIState = function (active) {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        if (active.name === "activity.taskbtn") {\r\n            var btn = this.content.list[3];\r\n            btn.visible = active.visible;\r\n            if (!active.disabled) {\r\n                btn.setInteractive();\r\n            }\r\n            else\r\n                btn.removeInteractive();\r\n        }\r\n    };\r\n    ActivityPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "activity/activity.png", "activity/activity.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ActivityPanel.prototype.init = function () {\r\n        this.content = this.scene.make.container(undefined, false);\r\n        this.add(this.content);\r\n        for (var i = 0; i < 4; i++) {\r\n            var img = this.scene.make.image({\r\n                key: this.key,\r\n                frame: "icon_" + (i + 1)\r\n            }, false);\r\n            this.content.add(img);\r\n        }\r\n        var subList = this.content.list;\r\n        var offsetY = 15 * this.dpr;\r\n        var tmpWid = 0;\r\n        var height = 0;\r\n        var handler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_1__["Handler"](this, this.onClickHandler);\r\n        var _loop_1 = function (i) {\r\n            var button = subList[i];\r\n            button.y = button.height * button.originY + height;\r\n            height += button.height + offsetY;\r\n            tmpWid = button.width;\r\n            button.on("pointerup", function () {\r\n                handler.runWith(i + 1);\r\n            }, this_1);\r\n            button.setInteractive();\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < subList.length; i++) {\r\n            _loop_1(i);\r\n        }\r\n        this.resize(tmpWid, height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ActivityPanel.prototype.onClickHandler = function (name) {\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log(name);\r\n        if (name === 4) {\r\n            this.emit("showPanel", "Task");\r\n        }\r\n    };\r\n    ActivityPanel.prototype.checkUpdateActive = function () {\r\n        var arr = this.mWorld.uiManager.getActiveUIData("Activity");\r\n        if (arr) {\r\n            for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n                var data = arr_1[_i];\r\n                this.updateUIState(data);\r\n            }\r\n        }\r\n    };\r\n    return ActivityPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Activity/ActivityPanel.ts?')},"./src/ui/Bubble/InteractionBubbleCell.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionBubbleCell", function() { return InteractionBubbleCell; });\n/* harmony import */ var _rooms_Animation_bubble_animation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../rooms/Animation/bubble.animation */ "./src/rooms/Animation/bubble.animation.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar InteractionBubbleCell = /** @class */ (function (_super) {\r\n    __extends(InteractionBubbleCell, _super);\r\n    function InteractionBubbleCell(scene, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mWdith = 78;\r\n        _this.mHeight = 78;\r\n        _this.width = _this.mWdith * dpr;\r\n        _this.height = _this.mHeight * dpr;\r\n        return _this;\r\n    }\r\n    InteractionBubbleCell.prototype.setContentData = function (content, handler) {\r\n        this.content = content;\r\n        if (this.handler)\r\n            this.handler.clear();\r\n        this.handler = handler;\r\n    };\r\n    InteractionBubbleCell.prototype.load = function (resName, url, jsonUrl) {\r\n        this.createAnimation();\r\n        this.mBubbleAni.load(resName, url, jsonUrl);\r\n        this.mBubbleAni.play();\r\n    };\r\n    InteractionBubbleCell.prototype.show = function () {\r\n        if (this.mBubbleAni) {\r\n            this.add(this.mBubbleAni);\r\n        }\r\n        this.removeDelay();\r\n    };\r\n    InteractionBubbleCell.prototype.hide = function () {\r\n        if (this.mBubbleAni) {\r\n            this.remove(this.mBubbleAni);\r\n        }\r\n        if (this.mRemoveDelay) {\r\n            clearTimeout(this.mRemoveDelay);\r\n            this.mRemoveDelay = null;\r\n        }\r\n    };\r\n    InteractionBubbleCell.prototype.destroy = function () {\r\n        this.hide();\r\n        if (this.mBubbleAni) {\r\n            this.mBubbleAni.destroy();\r\n        }\r\n        if (this.handler)\r\n            this.handler.clear();\r\n        this.mBubbleAni = null;\r\n        this.handler = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractionBubbleCell.prototype.createAnimation = function () {\r\n        // this.mBubbleAni = new DragonbonesAnimation(this.scene);\r\n        // this.mBubbleAni = new FrameAnimation(this.scene);\r\n        this.mBubbleAni = new _rooms_Animation_bubble_animation__WEBPACK_IMPORTED_MODULE_0__["BubbleAnimation"](this.scene);\r\n        this.mBubbleAni.width = this.width;\r\n        this.mBubbleAni.height = this.height;\r\n        var POINTER_DOWN = Phaser.Input.Events.POINTER_DOWN;\r\n        this.mBubbleAni.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.mBubbleAni.width * 2, this.mBubbleAni.height * 2), Phaser.Geom.Rectangle.Contains);\r\n        this.mBubbleAni.on(POINTER_DOWN, this.onBubbleClick, this);\r\n    };\r\n    InteractionBubbleCell.prototype.onBubbleClick = function () {\r\n        if (this.handler)\r\n            this.handler.runWith(this.content);\r\n    };\r\n    InteractionBubbleCell.prototype.removeDelay = function () {\r\n        var _this = this;\r\n        this.mRemoveDelay = setTimeout(function () {\r\n            if (_this.handler)\r\n                _this.handler.runWith(_this.content.id);\r\n            _this.hide();\r\n        }, this.content.duration);\r\n    };\r\n    return InteractionBubbleCell;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Bubble/InteractionBubbleCell.ts?')},"./src/ui/Bubble/InteractionBubbleContainer.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionBubbleContainer", function() { return InteractionBubbleContainer; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseUI */ "./lib/rexui/lib/ui/baseUI/BaseUI.ts");\n/* harmony import */ var _InteractionBubbleCell__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InteractionBubbleCell */ "./src/ui/Bubble/InteractionBubbleCell.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar InteractionBubbleContainer = /** @class */ (function (_super) {\r\n    __extends(InteractionBubbleContainer, _super);\r\n    function InteractionBubbleContainer(scene, dpr) {\r\n        return _super.call(this, scene) || this;\r\n    }\r\n    Object.defineProperty(InteractionBubbleContainer.prototype, "show", {\r\n        get: function () {\r\n            return this.mShow;\r\n        },\r\n        set: function (value) {\r\n            this.mShow = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    InteractionBubbleContainer.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    InteractionBubbleContainer.prototype.setFollow = function (gameObject, fromScene, posFunc) {\r\n        _super.prototype.setFollow.call(this, gameObject, fromScene, posFunc);\r\n    };\r\n    InteractionBubbleContainer.prototype.setBubble = function (content, handler) {\r\n        this.id = content.id;\r\n        var resName = content.display["resName"];\r\n        var resUrl = content.display.texturePath;\r\n        var jsonUrl = content.display.dataPath;\r\n        if (!this.mBubble) {\r\n            this.mBubble = new _InteractionBubbleCell__WEBPACK_IMPORTED_MODULE_1__["InteractionBubbleCell"](this.scene, this.dpr);\r\n            this.mBubble.load(resName, resUrl, jsonUrl);\r\n            this.add(this.mBubble);\r\n        }\r\n        this.mBubble.setContentData(content, handler);\r\n        this.mBubble.show();\r\n        return this.mBubble;\r\n    };\r\n    InteractionBubbleContainer.prototype.destroy = function () {\r\n        this.hide();\r\n        if (this.mBubble)\r\n            this.mBubble.destroy();\r\n        this.mBubble = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return InteractionBubbleContainer;\r\n}(_lib_rexui_lib_ui_baseUI_BaseUI__WEBPACK_IMPORTED_MODULE_0__["BaseUI"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Bubble/InteractionBubbleContainer.ts?')},"./src/ui/Bubble/InteractiveBubble.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractiveBubble", function() { return InteractiveBubble; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar InteractiveBubble = /** @class */ (function (_super) {\r\n    __extends(InteractiveBubble, _super);\r\n    function InteractiveBubble(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    InteractiveBubble.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_INTERACTIVE_BUBBLE, this.onShowHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORDL_REQ_CLIENT_REMOVE_INTERACTIVE_BUBBLE, this.onClearHandler);\r\n        }\r\n    };\r\n    InteractiveBubble.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    InteractiveBubble.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    InteractiveBubble.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    InteractiveBubble.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    InteractiveBubble.prototype.queryInteractiveHandler = function (data) {\r\n        var connection = this.connection;\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_ACTIVE_BUBBLE);\r\n        var content = packet.content;\r\n        content.id = data.id;\r\n        //  content.receiverId = data.receiverId;\r\n        connection.send(packet);\r\n    };\r\n    Object.defineProperty(InteractiveBubble.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    InteractiveBubble.prototype.onShowHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("showbubble", content);\r\n    };\r\n    InteractiveBubble.prototype.onClearHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("clearbubble", content.ids);\r\n    };\r\n    return InteractiveBubble;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Bubble/InteractiveBubble.ts?')},"./src/ui/Bubble/InteractiveBubbleMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractiveBubbleMediator", function() { return InteractiveBubbleMediator; });\n/* harmony import */ var _InteractiveBubblePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InteractiveBubblePanel */ "./src/ui/Bubble/InteractiveBubblePanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _InteractiveBubble__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InteractiveBubble */ "./src/ui/Bubble/InteractiveBubble.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar InteractiveBubbleMediator = /** @class */ (function (_super) {\r\n    __extends(InteractiveBubbleMediator, _super);\r\n    function InteractiveBubbleMediator(layerMgr, scene, mworld) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerMgr = layerMgr;\r\n        _this.mworld = mworld;\r\n        _this.scene = scene;\r\n        if (!_this.bubblePacket) {\r\n            _this.bubblePacket = new _InteractiveBubble__WEBPACK_IMPORTED_MODULE_2__["InteractiveBubble"](mworld);\r\n            _this.bubblePacket.on("showbubble", _this.onShowInteractiveBubble, _this);\r\n            _this.bubblePacket.on("clearbubble", _this.onClearInteractiveBubble, _this);\r\n            _this.bubblePacket.register();\r\n        }\r\n        if (!_this.mView) {\r\n            _this.mView = new _InteractiveBubblePanel__WEBPACK_IMPORTED_MODULE_0__["InteractiveBubblePanel"](_this.scene, _this.mworld);\r\n            _this.mView.on("queryinteractive", _this.onInteractiveBubbleHandler, _this);\r\n        }\r\n        return _this;\r\n    }\r\n    Object.defineProperty(InteractiveBubbleMediator.prototype, "currentRoom", {\r\n        get: function () {\r\n            return this.mworld.roomManager.currentRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    InteractiveBubbleMediator.prototype.destroy = function () {\r\n        if (this.mCurRoom)\r\n            this.mCurRoom.frameManager.remove(this, this.update);\r\n        if (this.bubblePacket) {\r\n            this.bubblePacket.destroy();\r\n            this.bubblePacket = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n        this.mCurRoom = undefined;\r\n    };\r\n    InteractiveBubbleMediator.prototype.update = function () {\r\n        if (this.mView)\r\n            this.mView.update();\r\n    };\r\n    InteractiveBubbleMediator.prototype.onShowInteractiveBubble = function (content) {\r\n        if (this.mCurRoom !== this.currentRoom) {\r\n            if (this.mCurRoom)\r\n                this.mCurRoom.frameManager.remove(this, this.update);\r\n            this.mCurRoom = this.currentRoom;\r\n            this.mCurRoom.frameManager.add(this, this.update);\r\n        }\r\n        var element = this.currentRoom.elementManager.get(content.receiverId);\r\n        if (!element)\r\n            element = this.currentRoom.playerManager.get(content.receiverId);\r\n        if (element && this.mView) {\r\n            this.mView.showInteractionBubble(content, element);\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView, 0);\r\n    };\r\n    InteractiveBubbleMediator.prototype.onClearInteractiveBubble = function (ids) {\r\n        if (!this.mView)\r\n            return;\r\n        for (var _i = 0, ids_1 = ids; _i < ids_1.length; _i++) {\r\n            var id = ids_1[_i];\r\n            this.mView.clearInteractionBubble(id);\r\n        }\r\n    };\r\n    InteractiveBubbleMediator.prototype.onInteractiveBubbleHandler = function (data) {\r\n        if (!this.mView)\r\n            return;\r\n        if (typeof data === "number") {\r\n            this.mView.clearInteractionBubble(data);\r\n            return;\r\n        }\r\n        this.bubblePacket.queryInteractiveHandler(data);\r\n    };\r\n    return InteractiveBubbleMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Bubble/InteractiveBubbleMediator.ts?')},"./src/ui/Bubble/InteractiveBubblePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractiveBubblePanel", function() { return InteractiveBubblePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _InteractionBubbleContainer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InteractionBubbleContainer */ "./src/ui/Bubble/InteractionBubbleContainer.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/tool */ "./src/utils/tool.ts");\n/* harmony import */ var _scenes_play__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../scenes/play */ "./src/scenes/play.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar InteractiveBubblePanel = /** @class */ (function (_super) {\r\n    __extends(InteractiveBubblePanel, _super);\r\n    function InteractiveBubblePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.map = new Map();\r\n        _this.world = world;\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    InteractiveBubblePanel.prototype.resize = function (width, height) {\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.setSize(width, height);\r\n    };\r\n    InteractiveBubblePanel.prototype.init = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var zoom = this.scale;\r\n        this.resize(width, height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    InteractiveBubblePanel.prototype.destroy = function () {\r\n        if (this.map) {\r\n            for (var key in this.map) {\r\n                var bubble = this.map.get(Number(key));\r\n                if (bubble)\r\n                    bubble.destroy();\r\n            }\r\n            this.map.clear();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractiveBubblePanel.prototype.clearInteractionBubble = function (id) {\r\n        if (this.map.has(id)) {\r\n            var bubble = this.map.get(id);\r\n            bubble.destroy();\r\n            this.map.delete(id);\r\n        }\r\n    };\r\n    InteractiveBubblePanel.prototype.showInteractionBubble = function (content, ele) {\r\n        var _this = this;\r\n        var dpr = this.dpr;\r\n        content.display["resName"] = null; // "gems";\r\n        content.display.texturePath = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "bubble/bubblebg.png"); // "resources/test/columns";\r\n        content.display.dataPath = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(dpr, "bubble/tipsicon.png"); // "resources/test/columns";\r\n        var key = content.id;\r\n        if (this.mBubble)\r\n            this.mBubble.hide();\r\n        if (this.map.has(key)) {\r\n            this.mBubble = this.map.get(key);\r\n        }\r\n        else {\r\n            this.mBubble = new _InteractionBubbleContainer__WEBPACK_IMPORTED_MODULE_2__["InteractionBubbleContainer"](this.scene, dpr);\r\n            this.map.set(key, this.mBubble);\r\n        }\r\n        this.mBubble.setBubble(content, new _Handler_Handler__WEBPACK_IMPORTED_MODULE_3__["Handler"](this, this.onInteractiveBubbleHandler));\r\n        var playScene = this.world.game.scene.getScene(_scenes_play__WEBPACK_IMPORTED_MODULE_6__["PlayScene"].name);\r\n        this.updateBubblePos(ele, playScene);\r\n        this.mBubble.setFollow(ele, playScene, function (obj) {\r\n            _this.updateBubblePos(ele, obj.scene);\r\n        });\r\n        this.mBubble.show = true;\r\n        this.add(this.mBubble);\r\n    };\r\n    InteractiveBubblePanel.prototype.updateBubblePos = function (gameObject, scene) {\r\n        var dpr = this.dpr;\r\n        var zoom = this.world.uiScale;\r\n        var position = gameObject.getDisplay().getWorldTransformMatrix();\r\n        if (position) {\r\n            var pos = _utils_tool__WEBPACK_IMPORTED_MODULE_5__["Tool"].getPosByScenes(scene, new _utils_pos__WEBPACK_IMPORTED_MODULE_4__["Pos"](position.tx, (position.ty - 33 * dpr * zoom)));\r\n            this.mBubble.setPosition(pos.x, pos.y);\r\n        }\r\n    };\r\n    InteractiveBubblePanel.prototype.update = function () {\r\n        if (!this.map)\r\n            return;\r\n        this.map.forEach(function (bubble) {\r\n            if (bubble && bubble.show)\r\n                bubble.updatePos();\r\n        });\r\n    };\r\n    InteractiveBubblePanel.prototype.onInteractiveBubbleHandler = function (data) {\r\n        this.emit("queryinteractive", data);\r\n    };\r\n    return InteractiveBubblePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Bubble/InteractiveBubblePanel.ts?')},"./src/ui/CharacterInfo/CharacterAttributePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterAttributePanel", function() { return CharacterAttributePanel; });\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar CharacterAttributePanel = /** @class */ (function (_super) {\r\n    __extends(CharacterAttributePanel, _super);\r\n    function CharacterAttributePanel(scene, x, y, width, height, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.attriItems = [];\r\n        _this.setSize(width, height);\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        return _this;\r\n    }\r\n    CharacterAttributePanel.prototype.setAttributeData = function (datas) {\r\n        var len = datas.length;\r\n        var scaleRadio = (len > 4 ? 2 : 1);\r\n        var width = this.width - 28 * this.dpr;\r\n        var height = this.height;\r\n        var cheight = 20 * this.dpr;\r\n        var cwidth = width / 2;\r\n        var offsetY = 20 * this.dpr;\r\n        var posy = -height * 0.5 + 10 * this.dpr;\r\n        for (var _i = 0, _a = this.attriItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.visible = false;\r\n        }\r\n        for (var i = 0; i < len; i++) {\r\n            var item = void 0;\r\n            if (i < this.attriItems.length) {\r\n                item = this.attriItems[i];\r\n            }\r\n            else {\r\n                item = new PlayerAttributeValue(this.scene, 0, 0, cwidth, cheight, this.key, this.dpr);\r\n                this.add(item);\r\n                this.attriItems.push(item);\r\n            }\r\n            var x = (width - width / scaleRadio) * 0.5 * (i < 4 ? -1 : 1);\r\n            var y = posy + cheight * 0.5 + (cheight + offsetY) * (i % 4);\r\n            item.setPosition(x, y);\r\n            item.setInfo(datas[i]);\r\n            item.visible = true;\r\n        }\r\n    };\r\n    return CharacterAttributePanel;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar PlayerAttributeValue = /** @class */ (function (_super) {\r\n    __extends(PlayerAttributeValue, _super);\r\n    function PlayerAttributeValue(scene, x, y, width, height, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = dpr;\r\n        _this.setSize(width, height);\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_2__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.icon.x = -width * 0.5 + _this.icon.width * 0.5;\r\n        _this.icon.setTexture(key, "health");\r\n        _this.nameText = _this.scene.make.text({\r\n            x: _this.icon.x + 13 * dpr, y: 0, text: "Attack:",\r\n            style: { fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT, fontSize: 11 * dpr, color: "#131313" }\r\n        }).setOrigin(0, 0.5);\r\n        _this.valueText = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_0__["BBCodeText"](_this.scene, 0, 0, "100", {\r\n            color: "#131313",\r\n            fontSize: 11 * _this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n        }).setOrigin(0, 0.5);\r\n        _this.valueText.x = _this.nameText.x + _this.nameText.width;\r\n        _this.add([_this.icon, _this.nameText, _this.valueText]);\r\n        return _this;\r\n    }\r\n    PlayerAttributeValue.prototype.setInfo = function (data) {\r\n        var _this = this;\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(data.display.texturePath);\r\n        this.icon.load(url, this, function () {\r\n            _this.icon.displayWidth = 17 * _this.dpr;\r\n            _this.icon.scaleY = _this.icon.scaleX;\r\n        });\r\n        this.icon.setFrame(data.display.texturePath);\r\n        this.nameText.text = data.name + ":";\r\n        this.valueText.text = data.value + (data.tempValue ? this.getRichLabel(data.tempValue) : "");\r\n        this.valueText.x = this.nameText.x + this.nameText.width + 3 * this.dpr;\r\n    };\r\n    PlayerAttributeValue.prototype.getRichLabel = function (tempValue, color) {\r\n        if (color === void 0) { color = "#0B77CD"; }\r\n        var label = "[color=" + color + "](+" + tempValue + ")[/color]";\r\n        return label;\r\n    };\r\n    return PlayerAttributeValue;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/CharacterAttributePanel.ts?')},"./src/ui/CharacterInfo/CharacterEditorPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterEditorPanel", function() { return CharacterEditorPanel; });\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar CharacterEditorPanel = /** @class */ (function (_super) {\r\n    __extends(CharacterEditorPanel, _super);\r\n    function CharacterEditorPanel(scene, x, y, width, height, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = 0;\r\n        _this.key = "";\r\n        _this.setSize(width, height);\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        var common_key = "common_key";\r\n        var mfont = "bold " + 15 * _this.dpr + "px Source Han Sans";\r\n        _this.title = _this.scene.make.text({ x: 0, y: -height * 0.5 + 50 * dpr, text: _this.geti18n("edit_profile"), style: { font: mfont, blod: true, color: "#ffffff", fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT } }).setOrigin(0.5);\r\n        var bg = _this.scene.make.graphics(undefined, false);\r\n        bg.clear();\r\n        bg.fillStyle(0xffffff, 0.5);\r\n        bg.fillRect(0, 0, 247 * dpr, 350 * dpr);\r\n        bg.setPosition(-width * 0.5, -184 * dpr);\r\n        var posx = -width * 0.5 + 9 * dpr;\r\n        var posy = -170 * dpr;\r\n        var offsetY = 50 * dpr;\r\n        var nameText = _this.scene.make.text({ x: posx, y: posy, style: { blod: true, color: "#0062BB", fontSize: 15 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT } }).setOrigin(0);\r\n        nameText.setText(_this.geti18n("user_name") + ":");\r\n        _this.inputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_1__["default"](_this.scene, posx + nameText.width + 20 * dpr, posy, 162 * dpr, 27 * dpr, {\r\n            type: "input",\r\n            fontSize: 18 * dpr + "px",\r\n            color: "#0062BB",\r\n            align: "center",\r\n            placeholder: _this.geti18n("input_nickname")\r\n        }).setOrigin(0);\r\n        var line = _this.createLine(-230 * _this.dpr * 0.5, posy + 32 * _this.dpr);\r\n        _this.add(bg);\r\n        _this.add([_this.title, nameText, _this.inputText, line]);\r\n        _this.idText = _this.createText("I        D:", "49855555", posx, posy + offsetY);\r\n        _this.constellationText = _this.createText(_this.geti18n("constellation") + ":", "双子座", posx, posy + offsetY * 2);\r\n        _this.birthdayText = _this.createText(_this.geti18n("birthday") + ":", "1998-04-24", posx, posy + offsetY * 3);\r\n        _this.cityText = _this.createText(_this.geti18n("city") + ":", "中国·上海", posx, posy + offsetY * 4);\r\n        var signText = _this.scene.make.text({ x: posx, y: posy + offsetY * 5, style: { blod: true, color: "#0062BB", fontSize: 15 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT } }).setOrigin(0);\r\n        signText.setText(_this.geti18n("signature") + ":");\r\n        _this.signInput = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_1__["default"](_this.scene, posx + signText.width + 20 * dpr, posy + offsetY * 5, 162 * dpr, 76 * dpr, {\r\n            type: "input",\r\n            fontSize: 18 * dpr + "px",\r\n            color: "#0062BB",\r\n            align: "center",\r\n            placeholder: _this.geti18n("input_signature")\r\n        }).setOrigin(0);\r\n        _this.add([signText, _this.signInput]);\r\n        var backBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_0__["Button"](_this.scene, common_key, "back_arrow", "back_arrow");\r\n        var saveBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](_this.scene, 0, height * 0.5 - 40 * dpr, 174 * _this.dpr, 37 * _this.dpr, common_key, "yellow_btn", _this.geti18n("save"), {\r\n            left: 12 * _this.dpr,\r\n            top: 12 * _this.dpr,\r\n            right: 12 * _this.dpr,\r\n            bottom: 12 * _this.dpr\r\n        });\r\n        saveBtn.setTextStyle({ fontSize: 16 * _this.dpr, color: "#ED7814" });\r\n        backBtn.setPosition(posx + 8 * dpr, -height * 0.5 + 50 * dpr);\r\n        backBtn.on("Tap", _this.onBackHandler, _this);\r\n        saveBtn.on("Tap", _this.onSaveHandler, _this);\r\n        _this.add([backBtn, saveBtn]);\r\n        return _this;\r\n    }\r\n    CharacterEditorPanel.prototype.destroy = function () {\r\n        if (this.inputText)\r\n            this.inputText.destroy();\r\n        if (this.signInput)\r\n            this.signInput.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CharacterEditorPanel.prototype.createText = function (name, value, posx, posy) {\r\n        var nameText = this.scene.make.text({ x: posx, y: posy, style: { blod: true, color: "#0062BB", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT } }).setOrigin(0, 0);\r\n        nameText.setText(name);\r\n        var valueText = this.scene.make.text({ x: posx + nameText.width + 20 * this.dpr, y: posy, text: value, style: { blod: true, color: "#ffffff", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT } }).setOrigin(0, 0);\r\n        var line = this.createLine(-230 * this.dpr * 0.5, posy + 32 * this.dpr);\r\n        this.add([nameText, valueText, line]);\r\n        return valueText;\r\n    };\r\n    CharacterEditorPanel.prototype.geti18n = function (name) {\r\n        return _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("player_info." + name);\r\n    };\r\n    CharacterEditorPanel.prototype.createLine = function (posx, posy) {\r\n        var line = this.scene.make.graphics(undefined, false);\r\n        line.clear();\r\n        line.fillStyle(0x0062BB, 0.6);\r\n        line.fillRect(0, 0, 230 * this.dpr, 3);\r\n        line.setPosition(posx, posy);\r\n        return line;\r\n    };\r\n    CharacterEditorPanel.prototype.onBackHandler = function () {\r\n        this.visible = false;\r\n        this.emit("editorHide");\r\n    };\r\n    CharacterEditorPanel.prototype.onSaveHandler = function () {\r\n    };\r\n    return CharacterEditorPanel;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/CharacterEditorPanel.ts?')},"./src/ui/CharacterInfo/CharacterInfo.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterInfo", function() { return CharacterInfo; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar CharacterInfo = /** @class */ (function (_super) {\r\n    __extends(CharacterInfo, _super);\r\n    function CharacterInfo(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    CharacterInfo.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SELF_PLAYER_INFO, this.onOwnerCharacterInfo);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_ANOTHER_PLAYER_INFO, this.onOtherCharacterInfo);\r\n        }\r\n    };\r\n    CharacterInfo.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    CharacterInfo.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    CharacterInfo.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    CharacterInfo.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(CharacterInfo.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    CharacterInfo.prototype.queryPlayerInfo = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SELF_PLAYER_INFO);\r\n        this.connection.send(packet);\r\n    };\r\n    CharacterInfo.prototype.onOwnerCharacterInfo = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("ownerInfo", content);\r\n    };\r\n    CharacterInfo.prototype.onOtherCharacterInfo = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("otherInfo", content);\r\n    };\r\n    return CharacterInfo;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/CharacterInfo.ts?')},"./src/ui/CharacterInfo/CharacterInfoMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterInfoMediator", function() { return CharacterInfoMediator; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _CharacterInfoPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CharacterInfoPanel */ "./src/ui/CharacterInfo/CharacterInfoPanel.ts");\n/* harmony import */ var _CharacterInfo__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CharacterInfo */ "./src/ui/CharacterInfo/CharacterInfo.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar CharacterInfoMediator = /** @class */ (function (_super) {\r\n    __extends(CharacterInfoMediator, _super);\r\n    function CharacterInfoMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    CharacterInfoMediator.prototype.show = function () {\r\n        if (this.mView) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _CharacterInfoPanel__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHidePanel, this);\r\n            this.mView.on("queryOwnerInfo", this.onQueryOwnerInfo, this);\r\n        }\r\n        if (!this.characterInfo) {\r\n            this.characterInfo = new _CharacterInfo__WEBPACK_IMPORTED_MODULE_3__["CharacterInfo"](this.world);\r\n            this.characterInfo.on("ownerInfo", this.onOwnerCharacterInfo, this);\r\n            this.characterInfo.on("otherInfo", this.onOtherCharacterInfo, this);\r\n            this.characterInfo.register();\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        this.mView.show();\r\n    };\r\n    CharacterInfoMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    CharacterInfoMediator.prototype.destroy = function () {\r\n        if (this.characterInfo) {\r\n            this.characterInfo.destroy();\r\n            this.characterInfo = undefined;\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    CharacterInfoMediator.prototype.onHidePanel = function () {\r\n        this.destroy();\r\n    };\r\n    CharacterInfoMediator.prototype.onOwnerCharacterInfo = function (content) {\r\n        this.mView.setPlayerData(content);\r\n    };\r\n    CharacterInfoMediator.prototype.onOtherCharacterInfo = function (content) {\r\n        this.mView.setPlayerData(content);\r\n    };\r\n    CharacterInfoMediator.prototype.onQueryOwnerInfo = function () {\r\n        this.characterInfo.queryPlayerInfo();\r\n    };\r\n    CharacterInfoMediator.prototype.testOwnerData = function () {\r\n        var player = this.world.roomManager.currentRoom.playerManager.actor;\r\n        var owner = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SELF_PLAYER_INFO();\r\n        owner.id = player.id;\r\n        owner.cid = "5524121555";\r\n        owner.like = 652;\r\n        owner.currentAvatar = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_pkt_def"].PKT_Avatar();\r\n        owner.currentAvatar.avatar = player.model.avatar;\r\n        owner.nickname = player.model.nickname;\r\n        owner.level = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_pkt_def"].PKT_Level();\r\n        owner.level.level = 32;\r\n        owner.level.currentLevelExp = 100;\r\n        owner.level.nextLevelExp = 400;\r\n        owner.lifeSkills = [];\r\n        owner.currentTitle = "这是一个称号";\r\n        for (var i = 0; i < 20; i++) {\r\n            var item = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_pkt_def"].PKT_Skill();\r\n            item.id = i + 10 + "";\r\n            item.name = "技能" + i;\r\n            item.level = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_pkt_def"].PKT_Level();\r\n            item.level.level = 20 + i;\r\n            item.level.currentLevelExp = 200 + i * 10;\r\n            item.level.nextLevelExp = 400 + i * 10;\r\n            owner.lifeSkills.push(item);\r\n        }\r\n        return owner;\r\n    };\r\n    return CharacterInfoMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/CharacterInfoMediator.ts?')},"./src/ui/CharacterInfo/CharacterInfoPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../rooms/display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../rooms/display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\n/* harmony import */ var _lib_rexui_lib_ui_progressbar_ProgressBar__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/progressbar/ProgressBar */ "./lib/rexui/lib/ui/progressbar/ProgressBar.ts");\n/* harmony import */ var _CharacterEditorPanel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./CharacterEditorPanel */ "./src/ui/CharacterInfo/CharacterEditorPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/GameScroller */ "./lib/rexui/lib/ui/scroller/GameScroller.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/event/MouseEvent */ "./lib/rexui/lib/ui/interface/event/MouseEvent.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _CharacterAttributePanel__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./CharacterAttributePanel */ "./src/ui/CharacterInfo/CharacterAttributePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar Container = Phaser.GameObjects.Container;\r\n\r\n\r\n// import { NinePatchButton } from "../../../lib/rexui/lib/ui/button/NinePatchButton";\r\n\r\n\r\n\r\n\r\n\r\nvar CharacterInfoPanel = /** @class */ (function (_super) {\r\n    __extends(CharacterInfoPanel, _super);\r\n    function CharacterInfoPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "player_info";\r\n        _this.commonkey = "common_key";\r\n        _this.isOwner = true;\r\n        return _this;\r\n    }\r\n    CharacterInfoPanel.prototype.resize = function (width, height) {\r\n        var w = this.scaleWidth;\r\n        var h = this.scaleHeight;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.setSize(w, h);\r\n        this.mBackGround.clear();\r\n        this.mBackGround.fillStyle(0x000000, 0.66);\r\n        this.mBackGround.fillRect(0, 0, w, h);\r\n        this.content.setPosition(w / 2, h / 2);\r\n        // this.mSkillGrideTable.refreshPos(0, 180 * this.dpr);\r\n        this.mSkillGrideTable.resetMask();\r\n        this.content.setInteractive();\r\n    };\r\n    CharacterInfoPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n    };\r\n    CharacterInfoPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.OnClosePanel, this);\r\n        this.nickEditor.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onEditorHandler, this);\r\n        this.privaCharBtn.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onPrivateChatHandler, this);\r\n        this.addFriendBtn.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onAddFriendHandler, this);\r\n        this.tradeBtn.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onTradingHandler, this);\r\n    };\r\n    CharacterInfoPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.OnClosePanel, this);\r\n        this.nickEditor.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onEditorHandler, this);\r\n        this.privaCharBtn.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onPrivateChatHandler, this);\r\n        this.addFriendBtn.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onAddFriendHandler, this);\r\n        this.tradeBtn.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onTradingHandler, this);\r\n    };\r\n    CharacterInfoPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "player_info/player_info.png", "player_info/player_info.json");\r\n        this.commonkey = _ui_atals_name__WEBPACK_IMPORTED_MODULE_15__["UIAtlasKey"].commonKey;\r\n        this.addAtlas(this.commonkey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_15__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_15__["UIAtlasName"].commonUrl + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    CharacterInfoPanel.prototype.init = function () {\r\n        var _this = this;\r\n        var zoom = this.scale;\r\n        var wid = this.scene.cameras.main.width;\r\n        var hei = this.scene.cameras.main.height;\r\n        this.mBackGround = this.scene.make.graphics(undefined, false);\r\n        this.mBackGround.clear();\r\n        this.mBackGround.fillStyle(0x6AE2FF, 0);\r\n        this.mBackGround.fillRect(0, 0, wid * zoom, hei * zoom);\r\n        this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        this.bg = this.scene.make.image({ x: 0, y: 0, key: this.key, frame: "bg" });\r\n        this.content = this.scene.make.container(undefined, false);\r\n        this.content.setSize(this.bg.width, this.bg.height);\r\n        this.mainContent = this.scene.make.container(undefined, false);\r\n        this.mainContent.setSize(this.bg.width, this.bg.height);\r\n        var posY = -this.bg.height * 0.5 + 43 * this.dpr;\r\n        var mfont = "bold " + 15 * this.dpr + "px Source Han Sans";\r\n        this.labelText = this.scene.make.text({ x: 0, y: posY, text: _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.title"), style: { font: mfont, bold: true, color: "#ffffff", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0.5, 0);\r\n        this.labelText.setStroke("#8F4300", 1);\r\n        this.closeBtn = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["Button"](this.scene, this.commonkey, "close");\r\n        this.closeBtn.setPosition(this.mainContent.width * 0.5 - this.dpr * 30, posY - this.dpr * 10);\r\n        this.likeBtn = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["Button"](this.scene, this.key, "praise_bef", "praise_bef", "999");\r\n        this.likeBtn.setTextStyle({ fontSize: 13 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT });\r\n        this.likeBtn.text.setOrigin(0, 0.5).x += 10 * this.dpr;\r\n        this.likeBtn.setPosition(this.bg.width * 0.5 - 50 * this.dpr, posY + 50 * this.dpr);\r\n        this.likeBtn.visible = false;\r\n        this.avatar = new _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_7__["DragonbonesDisplay"](this.scene, undefined, undefined, true);\r\n        this.avatar.scale = this.dpr * 2;\r\n        this.avatar.x = 0;\r\n        this.avatar.y = -70 * this.dpr;\r\n        this.avatar.once("initialized", function () {\r\n            _this.avatar.play({ name: "idle", flip: false });\r\n        });\r\n        var nickPosX = Math.round(-this.bg.width * 0.5 + 25 * this.dpr);\r\n        var nickPosY = Math.round(this.bg.height * 0.5 - 306 * this.dpr);\r\n        var nickOffsetY = 30 * this.dpr;\r\n        var fontSize = Math.round(13 * this.dpr);\r\n        this.nickName = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["BBCodeText"](this.scene, nickPosX, nickPosY, {})\r\n            .setOrigin(0, 0.5).setFontSize(fontSize).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT);\r\n        this.nickEditor = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["Button"](this.scene, this.key, "edit", "edit");\r\n        this.nickEditor.setPosition(this.bg.width * 0.5 - 30 * this.dpr, nickPosY).visible = false;\r\n        var line1 = this.scene.make.image({ x: 0, y: nickPosY + 10 * this.dpr, key: this.key, frame: "splitters" });\r\n        this.idText = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["BBCodeText"](this.scene, nickPosX, nickPosY + nickOffsetY)\r\n            .setFontSize(fontSize).setOrigin(0, 0.5).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT);\r\n        var line2 = this.scene.make.image({ x: 0, y: this.idText.y + 10 * this.dpr, key: this.key, frame: "splitters" });\r\n        this.titleName = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["BBCodeText"](this.scene, nickPosX, nickPosY + nickOffsetY * 2)\r\n            .setFontSize(fontSize).setOrigin(0, 0.5).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT);\r\n        var line3 = this.scene.make.image({ x: 0, y: this.titleName.y + 10 * this.dpr, key: this.key, frame: "splitters" });\r\n        var lvbg = this.scene.make.image({ x: 0, y: 0, key: this.key, frame: "level_bg" });\r\n        this.lvText = this.scene.make.text({ x: 0, y: 0, text: "lv 98", style: { color: "#996600", fontSize: fontSize, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0.5, 0.5);\r\n        this.lvCon = this.scene.make.container(undefined, false);\r\n        this.lvCon.setSize(lvbg.width, lvbg.height);\r\n        this.lvCon.add([lvbg, this.lvText]);\r\n        var bottomWidth = 234 * this.dpr;\r\n        var bottomHeight = 195 * this.dpr;\r\n        this.bottomCon = this.scene.make.container(undefined, false).setSize(bottomWidth, bottomHeight);\r\n        this.bottomCon.setPosition(0, (this.mainContent.height - bottomHeight) * 0.5 - 30 * this.dpr);\r\n        this.bottombg = this.scene.make.graphics(undefined, false);\r\n        var bottomBtnPosx = -60 * this.dpr;\r\n        var bottomBtnPosy = this.bottomCon.height * 0.5 - 20 * this.dpr;\r\n        this.addFriendBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_14__["NinePatchButton"](this.scene, bottomBtnPosx, bottomBtnPosy, 94 * this.dpr, 37 * this.dpr, this.key, "button_g", _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.add_friend"), {\r\n            left: 12 * this.dpr,\r\n            top: 12 * this.dpr,\r\n            right: 12 * this.dpr,\r\n            bottom: 12 * this.dpr\r\n        });\r\n        this.addFriendBtn.setFrameNormal("button_g");\r\n        this.privaCharBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_14__["NinePatchButton"](this.scene, bottomBtnPosx, bottomBtnPosy, 94 * this.dpr, 37 * this.dpr, this.commonkey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.private_chat"), {\r\n            left: 12 * this.dpr,\r\n            top: 12 * this.dpr,\r\n            right: 12 * this.dpr,\r\n            bottom: 12 * this.dpr\r\n        });\r\n        this.tradeBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_14__["NinePatchButton"](this.scene, -bottomBtnPosx, bottomBtnPosy, 94 * this.dpr, 37 * this.dpr, this.commonkey, "red_btn", _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.tade_btn"), {\r\n            left: 12 * this.dpr,\r\n            top: 12 * this.dpr,\r\n            right: 12 * this.dpr,\r\n            bottom: 12 * this.dpr\r\n        });\r\n        this.addFriendBtn.setTextStyle({ fontSize: 16 * this.dpr, color: "#000000" });\r\n        this.privaCharBtn.setTextStyle({ fontSize: 16 * this.dpr, color: "#996600" });\r\n        this.tradeBtn.setTextStyle({ fontSize: 16 * this.dpr, color: "#ffffff" });\r\n        this.bottomCon.add([this.bottombg, this.addFriendBtn, this.privaCharBtn, this.tradeBtn]);\r\n        this.mainContent.add([this.closeBtn, this.likeBtn, this.labelText, line1, line2, line3, this.nickName, this.nickEditor, this.idText, this.titleName, this.lvCon, this.bottomCon]);\r\n        this.mainContent.add(this.avatar);\r\n        this.content.add(this.bg);\r\n        this.content.add(this.mainContent);\r\n        this.add([this.mBackGround, this.content]);\r\n        var w = this.scene.cameras.main.width;\r\n        var h = this.scene.cameras.main.height;\r\n        this.mCategoryScroll = new _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_11__["GameScroller"](this.scene, {\r\n            x: this.scaleWidth * 0.5,\r\n            y: this.scaleHeight * 0.5 + 62 * this.dpr,\r\n            width: bottomWidth,\r\n            height: 80 * this.dpr,\r\n            zoom: this.scale,\r\n            orientation: 1,\r\n            cellupCallBack: function (gameobject) {\r\n                _this.onSelectSubCategoryHandler(gameobject);\r\n            }\r\n        });\r\n        this.add(this.mCategoryScroll);\r\n        var propFrame = this.scene.textures.getFrame(this.key, "skill_bg");\r\n        var capW = propFrame.width + 5 * this.dpr;\r\n        var capH = propFrame.height + 2 * this.dpr;\r\n        var gridX = 0, gridY = 165 * this.dpr, gridwidth = (this.bottomCon.width - 10 * this.dpr), gridheight = 200 * this.dpr;\r\n        this.mSkillGrideTable = this.createGrideTable(gridX, gridY, gridwidth, gridheight, capW, capH, function () {\r\n            return new CharacterOwnerItem(_this.scene, 0, 0, _this.key, _this.dpr, zoom);\r\n        }, new _Handler_Handler__WEBPACK_IMPORTED_MODULE_16__["Handler"](this, this.onSelectItemHandler));\r\n        this.mAttrPanel = new _CharacterAttributePanel__WEBPACK_IMPORTED_MODULE_17__["CharacterAttributePanel"](this.scene, gridX, gridY, 260 * this.dpr, 149 * this.dpr, this.key, this.dpr);\r\n        this.content.add(this.mAttrPanel);\r\n        this.resize(w, h);\r\n        _super.prototype.init.call(this);\r\n        this.reqPlayerInfo();\r\n    };\r\n    CharacterInfoPanel.prototype.reqPlayerInfo = function () {\r\n        this.emit("queryOwnerInfo");\r\n    };\r\n    CharacterInfoPanel.prototype.setPlayerData = function (data) {\r\n        var nickname = data.nickname;\r\n        var current_title = data.currentTitle;\r\n        var exp = data.level.currentLevelExp;\r\n        var nexExp = data.level.nextLevelExp;\r\n        var cid = data.id;\r\n        var levle = data.level.level;\r\n        var spaceOffset = this.getspaceStr(1 * this.dpr);\r\n        if (this.avatar) {\r\n            this.avatar.load(new _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_8__["DragonbonesModel"]({\r\n                id: 0,\r\n                avatar: data.currentAvatar.avatar\r\n            }));\r\n        }\r\n        this.titleName.setText(this.getRichLabel(_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.player_title")) + spaceOffset + current_title);\r\n        this.likeBtn.setText(data.like + "");\r\n        var likeposx = this.bg.width * 0.5 - this.likeBtn.width * 0.5 - this.likeBtn.text.width;\r\n        this.likeBtn.x = likeposx - 20 * this.dpr;\r\n        this.lvText.text = "Lv" + levle + "";\r\n        var subArr = new Map();\r\n        subArr.set(CharacterOptionType.Skill, data.lifeSkills);\r\n        if (data instanceof pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_PKT_SELF_PLAYER_INFO) {\r\n            this.nickName.setText(this.getRichLabel(_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.nick_name")) + spaceOffset + nickname);\r\n            this.idText.setText(this.getRichLabel(_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.player_lv")) + this.getspaceStr(20) + exp + "/" + nexExp);\r\n            this.lvCon.setPosition(this.idText.x + 58 * this.dpr, this.idText.y);\r\n            this.likeBtn.setFrame("praise_aft");\r\n            subArr.set(CharacterOptionType.Attribute, data.properties);\r\n            subArr.set(CharacterOptionType.Badge, data.badges);\r\n            //   subArr.set(CharacterOptionType.Title, data.titles);\r\n            this.addFriendBtn.visible = false;\r\n            this.privaCharBtn.visible = false;\r\n            this.tradeBtn.visible = false;\r\n            this.bottombg.clear();\r\n            this.bottombg.fillStyle(0x6AE2FF, 1);\r\n            this.bottombg.fillRect(-this.bottomCon.width * 0.5, -this.bottomCon.height * 0.5, this.bottomCon.width, this.bottomCon.height);\r\n            this.mSkillGrideTable.setColumnCount(3);\r\n            this.isOwner = true;\r\n        }\r\n        else {\r\n            var remark = (data.remark ? data.remark : "备注好友昵称");\r\n            this.nickName.setText(this.getRichLabel(_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.nick_name")) + spaceOffset + nickname + (" (" + remark + ")"));\r\n            this.idText.setText(this.getRichLabel("I   D") + spaceOffset + cid);\r\n            this.lvCon.setPosition(this.idText.x + this.lvCon.width * 0.5, -this.mainContent.height * 0.5 + 100 * this.dpr);\r\n            this.likeBtn.setFrame("praise_bef");\r\n            subArr.set(CharacterOptionType.Badge, data.badges);\r\n            // subArr.set(CharacterOptionType.Avatar, data.avatar);\r\n            this.addFriendBtn.visible = !data.friend;\r\n            this.privaCharBtn.visible = data.friend;\r\n            this.tradeBtn.visible = true;\r\n            this.bottombg.clear();\r\n            this.bottombg.fillStyle(0x6AE2FF, 1);\r\n            this.bottombg.fillRect(-this.bottomCon.width * 0.5, -this.bottomCon.height * 0.5, this.bottomCon.width, this.bottomCon.height - 55 * this.dpr);\r\n            this.mSkillGrideTable.setColumnCount(2);\r\n            this.isOwner = false;\r\n        }\r\n        this.setSubCategory(subArr);\r\n    };\r\n    CharacterInfoPanel.prototype.destroy = function () {\r\n        this.mSkillGrideTable.destroy();\r\n        this.mCategoryScroll.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CharacterInfoPanel.prototype.createGrideTable = function (x, y, width, height, capW, capH, createFun, callback) {\r\n        var _this = this;\r\n        var tableConfig = {\r\n            x: x,\r\n            y: y,\r\n            table: {\r\n                width: width,\r\n                height: height,\r\n                columns: 3,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellPadX: 24 * this.dpr\r\n            },\r\n            scrollMode: 1,\r\n            clamplChildOY: false,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = createFun();\r\n                    _this.content.add(cellContainer);\r\n                }\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setItemData(item, _this.isOwner);\r\n                return cellContainer;\r\n            },\r\n        };\r\n        var grid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_6__["GameGridTable"](this.scene, tableConfig);\r\n        grid.layout();\r\n        grid.on("cellTap", function (cell) {\r\n            if (cell) {\r\n                callback.runWith(cell);\r\n            }\r\n        });\r\n        this.content.add(grid.table);\r\n        return grid;\r\n    };\r\n    CharacterInfoPanel.prototype.OnClosePanel = function () {\r\n        this.emit("hide");\r\n    };\r\n    CharacterInfoPanel.prototype.setSubCategory = function (map) {\r\n        var _this = this;\r\n        var subNames = [_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_live"), _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_attribute"), _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_badge")];\r\n        var itemWidth = this.mScene.textures.getFrame(this.key, "title_select").width;\r\n        var items = [];\r\n        map.forEach(function (value, key) {\r\n            var titleName = _this.getOptionName(key);\r\n            var item = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["Button"](_this.scene, _this.key, "title_normal", "title_select", titleName);\r\n            item.width = itemWidth;\r\n            item.height = 41 * _this.dpr;\r\n            items.push(item);\r\n            item.setTextStyle({ color: "#2B4BB5", fontSize: 12 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].BOLD_FONT });\r\n            item.disInteractive();\r\n            item.removeListen();\r\n            item.setData("subData", value);\r\n            item.setData("optiontype", key);\r\n            _this.mCategoryScroll.addItem(item);\r\n        });\r\n        if (items.length <= 3)\r\n            this.mCategoryScroll.setAlign(1);\r\n        else {\r\n            this.mCategoryScroll.setAlign(2);\r\n        }\r\n        this.onSelectSubCategoryHandler(items[0]);\r\n    };\r\n    CharacterInfoPanel.prototype.onSelectSubCategoryHandler = function (obj) {\r\n        // Logger.getInstance().log(obj);\r\n        if (this.curSelectCategeory) {\r\n            this.curSelectCategeory.changeNormal();\r\n            this.curSelectCategeory.setTextColor("#2B4BB5");\r\n        }\r\n        obj.changeDown();\r\n        obj.setTextColor("#996600");\r\n        this.curSelectCategeory = obj;\r\n        var datas = obj.getData("subData");\r\n        var optionType = obj.getData("optiontype");\r\n        if (optionType === CharacterOptionType.Skill) {\r\n            this.mSkillGrideTable.setItems(datas);\r\n            //  this.mSkillGrideTable.refreshPos(0, 185 * this.dpr * this.scale, 0, 0);\r\n            this.mAttrPanel.visible = false;\r\n            this.mSkillGrideTable.table.visible = true;\r\n        }\r\n        else if (optionType === CharacterOptionType.Attribute) {\r\n            if (datas)\r\n                this.mAttrPanel.setAttributeData(datas);\r\n            this.mAttrPanel.visible = true;\r\n            this.mSkillGrideTable.setItems([]);\r\n            this.mSkillGrideTable.table.visible = false;\r\n        }\r\n        else if (optionType === CharacterOptionType.Badge) {\r\n        }\r\n    };\r\n    CharacterInfoPanel.prototype.onSelectItemHandler = function (item) {\r\n    };\r\n    CharacterInfoPanel.prototype.onEditorHandler = function () {\r\n        var w = 247 * this.dpr;\r\n        var h = this.content.height;\r\n        if (!this.editorPanel)\r\n            this.editorPanel = new _CharacterEditorPanel__WEBPACK_IMPORTED_MODULE_10__["CharacterEditorPanel"](this.scene, 0, 0, w, h, this.key, this.dpr);\r\n        this.content.add(this.editorPanel);\r\n        this.editorPanel.visible = true;\r\n        this.editorPanel.on("editorHide", this.onEditorPanelHideHandler, this);\r\n        this.setMainUIVisible(false);\r\n    };\r\n    CharacterInfoPanel.prototype.onAddFriendHandler = function () {\r\n    };\r\n    CharacterInfoPanel.prototype.onTradingHandler = function () {\r\n    };\r\n    CharacterInfoPanel.prototype.onPrivateChatHandler = function () {\r\n    };\r\n    CharacterInfoPanel.prototype.onEditorPanelHideHandler = function () {\r\n        this.mainContent.visible = true;\r\n        this.remove(this.editorPanel);\r\n        this.editorPanel.off("editorHide", this.onEditorPanelHideHandler, this);\r\n        this.editorPanel.destroy();\r\n        this.editorPanel = null;\r\n        this.setMainUIVisible(true);\r\n    };\r\n    CharacterInfoPanel.prototype.setMainUIVisible = function (value) {\r\n        this.avatar.visible = value;\r\n        this.mCategoryScroll.visible = value;\r\n        this.mSkillGrideTable.table.visible = value;\r\n        this.mainContent.visible = value;\r\n    };\r\n    CharacterInfoPanel.prototype.getRichLabel = function (text, color) {\r\n        if (color === void 0) { color = "#2B4BB5"; }\r\n        var label = "[stroke=" + color + "][color=" + color + "]" + text + ":[/color][/stroke]";\r\n        return label;\r\n    };\r\n    CharacterInfoPanel.prototype.getspaceStr = function (num) {\r\n        var str = "";\r\n        for (var i = 0; i < num; i++) {\r\n            str += " ";\r\n        }\r\n        return str;\r\n    };\r\n    CharacterInfoPanel.prototype.getOptionName = function (type) {\r\n        var title = "";\r\n        if (type === CharacterOptionType.Skill) {\r\n            title = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_live");\r\n        }\r\n        else if (type === CharacterOptionType.Attribute) {\r\n            title = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_attribute");\r\n        }\r\n        else if (type === CharacterOptionType.Badge) {\r\n            title = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_badge");\r\n        }\r\n        else if (type === CharacterOptionType.Title) {\r\n            title = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("player_info.option_title");\r\n        }\r\n        return title;\r\n    };\r\n    return CharacterInfoPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n/* harmony default export */ __webpack_exports__["default"] = (CharacterInfoPanel);\r\nvar CharacterOptionType;\r\n(function (CharacterOptionType) {\r\n    CharacterOptionType[CharacterOptionType["Skill"] = 0] = "Skill";\r\n    CharacterOptionType[CharacterOptionType["Attribute"] = 1] = "Attribute";\r\n    CharacterOptionType[CharacterOptionType["Badge"] = 2] = "Badge";\r\n    CharacterOptionType[CharacterOptionType["Title"] = 3] = "Title";\r\n    CharacterOptionType[CharacterOptionType["Avatar"] = 4] = "Avatar";\r\n})(CharacterOptionType || (CharacterOptionType = {}));\r\nvar CharacterOwnerItem = /** @class */ (function (_super) {\r\n    __extends(CharacterOwnerItem, _super);\r\n    function CharacterOwnerItem(scene, x, y, key, dpr, zoom) {\r\n        if (zoom === void 0) { zoom = 1; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = 0;\r\n        _this.zoom = 0;\r\n        var bg = _this.scene.make.image({ x: 0, y: 0, key: key, frame: "skill_bg" });\r\n        _this.nameText = _this.scene.make.text({ x: -1 * dpr, y: 0, text: "lv 98", style: { color: "#996600", fontSize: 12 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        _this.lvText = _this.scene.make.text({ x: -1 * dpr, y: 0, text: "lv 98", style: { color: "#996600", fontSize: 12 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        _this.progressBar = new _lib_rexui_lib_ui_progressbar_ProgressBar__WEBPACK_IMPORTED_MODULE_9__["ProgressBar"](_this.scene, {\r\n            x: 48 * dpr / 2,\r\n            y: 15 * dpr,\r\n            width: 41 * dpr,\r\n            height: 4 * dpr,\r\n            background: {\r\n                x: 0,\r\n                y: 0,\r\n                width: 41 * dpr,\r\n                height: 4 * dpr,\r\n                config: {\r\n                    top: 1 * dpr,\r\n                    left: 2 * dpr,\r\n                    right: 2 * dpr,\r\n                    bottom: 1 * dpr,\r\n                },\r\n                key: key,\r\n                frame: "slider_bg"\r\n            },\r\n            bar: {\r\n                x: 0,\r\n                y: 0,\r\n                width: 41 * dpr,\r\n                height: 4 * dpr,\r\n                config: {\r\n                    top: 1 * dpr,\r\n                    left: 2 * dpr,\r\n                    right: 2 * dpr,\r\n                    bottom: 1 * dpr,\r\n                },\r\n                key: key,\r\n                frame: "slider_rate"\r\n            },\r\n            dpr: dpr,\r\n            textConfig: undefined\r\n        });\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_3__["DynamicImage"](_this.scene, -bg.width * 0.5 + 22 * dpr, 0);\r\n        _this.add([bg, _this.icon, _this.nameText, _this.lvText, _this.progressBar]);\r\n        _this.setSize(bg.width, bg.height);\r\n        _this.dpr = dpr;\r\n        _this.zoom = zoom;\r\n        _this.key = key;\r\n        return _this;\r\n        // this.progressBar.setProgress(1, 100);\r\n    }\r\n    CharacterOwnerItem.prototype.setItemData = function (data, isOwner) {\r\n        var _this = this;\r\n        if (isOwner === void 0) { isOwner = false; }\r\n        this.itemData = data;\r\n        this.nameText.text = data.name;\r\n        var posY = (isOwner ? -16 * this.dpr * this.zoom : -11 * this.dpr * this.zoom);\r\n        var offsetY = (isOwner ? 20 * this.dpr * this.zoom : 25 * this.dpr * this.zoom);\r\n        var cheight = 10 * this.dpr * this.zoom;\r\n        this.nameText.y = posY + cheight * 0.5;\r\n        this.icon.setTexture(this.key, "test_skillicon");\r\n        var width = this.icon.width;\r\n        if (data.level) {\r\n            this.lvText.text = data.level.level;\r\n            this.lvText.y = posY + offsetY;\r\n            this.progressBar.setProgress(data.level.currentLevelExp, data.level.nextLevelExp);\r\n            this.progressBar.visible = isOwner;\r\n        }\r\n        else {\r\n            this.progressBar.visible = false;\r\n            this.lvText.visible = false;\r\n        }\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_12__["Url"].getOsdRes(data.display.texturePath);\r\n        this.icon.load(url, this, function () {\r\n            _this.icon.scale = _this.dpr * _this.zoom;\r\n            var x = -_this.width * 0.5 + width * 0.5 + 6 * _this.dpr * _this.zoom;\r\n            _this.icon.setPosition(x, 0);\r\n        });\r\n    };\r\n    return CharacterOwnerItem;\r\n}(Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/CharacterInfoPanel.ts?')},"./src/ui/CharacterInfo/GraphicsProgressBar.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphicsProgressBar", function() { return GraphicsProgressBar; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar GraphicsProgressBar = /** @class */ (function (_super) {\r\n    __extends(GraphicsProgressBar, _super);\r\n    function GraphicsProgressBar(scene, x, y, width, height, isHorizontal) {\r\n        if (isHorizontal === void 0) { isHorizontal = true; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.value = 0.5;\r\n        _this.bgGraphics = _this.scene.make.graphics(undefined, false);\r\n        _this.barGraphics = _this.scene.make.graphics(undefined, false);\r\n        _this.add([_this.bgGraphics, _this.barGraphics]);\r\n        _this.setSize(width, height);\r\n        _this.bgColor = 0x000000;\r\n        _this.barColor = 0xff00000;\r\n        _this.bgGraphics.clear();\r\n        _this.bgGraphics.fillStyle(_this.bgColor, 1);\r\n        _this.bgGraphics.fillRect(0, 0, _this.width, _this.height);\r\n        _this.setValue(_this.value);\r\n        return _this;\r\n    }\r\n    GraphicsProgressBar.prototype.setColor = function (barColor, bgColor) {\r\n        this.barColor = barColor;\r\n        if (bgColor)\r\n            this.bgColor = bgColor;\r\n        this.bgGraphics.clear();\r\n        this.bgGraphics.fillStyle(this.bgColor, 1);\r\n        this.bgGraphics.fillRect(0, 0, this.width, this.height);\r\n        this.setValue(this.value);\r\n    };\r\n    GraphicsProgressBar.prototype.setValue = function (value) {\r\n        this.value = value;\r\n        var width = this.width * (this.isHorizontal ? value : 1);\r\n        var height = this.height * (!this.isHorizontal ? value : 1);\r\n        this.barGraphics.clear();\r\n        this.barGraphics.fillStyle(this.barColor, 1);\r\n        this.barGraphics.fillRect(0, 0, width, height);\r\n    };\r\n    GraphicsProgressBar.prototype.setRoundedRectValue = function (value, radius) {\r\n        this.value = value;\r\n        var width = this.width * (this.isHorizontal ? value : 1);\r\n        var height = this.height * (!this.isHorizontal ? value : 1);\r\n        this.barGraphics.clear();\r\n        this.barGraphics.fillStyle(this.barColor, 1);\r\n        this.barGraphics.fillRoundedRect(0, 0, width, height, radius);\r\n    };\r\n    return GraphicsProgressBar;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/GraphicsProgressBar.ts?')},"./src/ui/CharacterInfo/GridLayoutGroup.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GridLayoutGroup", function() { return GridLayoutGroup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignmentType", function() { return AlignmentType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CornerType", function() { return CornerType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AxisType", function() { return AxisType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ConstraintType", function() { return ConstraintType; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar GridLayoutGroup = /** @class */ (function (_super) {\r\n    __extends(GridLayoutGroup, _super);\r\n    function GridLayoutGroup(scene, x, y) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.layoutElements = [];\r\n        _this._padding = new Phaser.Math.Vector4(0, 0, 0, 0);\r\n        _this._cellSize = new Phaser.Math.Vector2(100, 100);\r\n        _this._spacing = new Phaser.Math.Vector2(0, 0);\r\n        _this._alignmentType = AlignmentType.UpperLeft;\r\n        _this._startCorner = CornerType.UpperLeft;\r\n        _this._startAxis = AxisType.Horizontal;\r\n        _this._constraint = ConstraintType.Flexible;\r\n        _this._constraintCount = 4;\r\n        return _this;\r\n    }\r\n    GridLayoutGroup.prototype.onPlay = function () {\r\n    };\r\n    GridLayoutGroup.prototype.start = function () {\r\n    };\r\n    Object.defineProperty(GridLayoutGroup.prototype, "padding", {\r\n        get: function () {\r\n            return this._padding;\r\n        },\r\n        set: function (value) {\r\n            if (value === undefined)\r\n                return;\r\n            this._padding = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "cellSize", {\r\n        get: function () {\r\n            return this._cellSize;\r\n        },\r\n        /**\r\n         * vec2(width,height);\r\n         */\r\n        set: function (value) {\r\n            if (value === undefined)\r\n                return;\r\n            if (value.x < 0)\r\n                value.x = 0;\r\n            if (value.y < 0)\r\n                value.y = 0;\r\n            this._cellSize = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "spacing", {\r\n        get: function () {\r\n            return this._spacing;\r\n        },\r\n        /**\r\n         * vec2(x,y);\r\n         */\r\n        set: function (value) {\r\n            if (value === undefined)\r\n                return;\r\n            this._spacing = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "alignmentType", {\r\n        get: function () {\r\n            return this._alignmentType;\r\n        },\r\n        set: function (value) {\r\n            if (value === this._alignmentType)\r\n                return;\r\n            this._alignmentType = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "startCorner", {\r\n        get: function () {\r\n            return this._startCorner;\r\n        },\r\n        set: function (value) {\r\n            if (value === this._startCorner)\r\n                return;\r\n            this._startCorner = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "startAxis", {\r\n        get: function () {\r\n            return this._startAxis;\r\n        },\r\n        set: function (value) {\r\n            if (value === this._startAxis)\r\n                return;\r\n            this._startAxis = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "constraint", {\r\n        get: function () {\r\n            return this._constraint;\r\n        },\r\n        set: function (value) {\r\n            if (value === this._constraint)\r\n                return;\r\n            this._constraint = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GridLayoutGroup.prototype, "constraintCount", {\r\n        get: function () {\r\n            return this._constraintCount;\r\n        },\r\n        set: function (value) {\r\n            if (value === undefined || isNaN(value))\r\n                return;\r\n            this._constraintCount = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GridLayoutGroup.prototype.Layout = function () {\r\n        this.layoutElements.length = 0;\r\n        for (var _i = 0, _a = this.list; _i < _a.length; _i++) {\r\n            var child = _a[_i];\r\n            if (child.active)\r\n                this.layoutElements.push(child);\r\n        }\r\n        if (this.layoutElements.length === 0)\r\n            return;\r\n        var cornerX = this._startCorner % 2;\r\n        var cornerY = Math.floor(this._startCorner / 2);\r\n        var cellsPerMainAxis = 0, actualCellCountX = 0, actualCellCountY = 0;\r\n        var cellCount = this.getCellCount();\r\n        if (this._startAxis === AxisType.Horizontal) {\r\n            cellsPerMainAxis = cellCount.x;\r\n            actualCellCountX = Phaser.Math.Clamp(cellCount.x, 1, this.layoutElements.length);\r\n            actualCellCountY = Phaser.Math.Clamp(cellCount.y, 1, Math.ceil(this.layoutElements.length / cellsPerMainAxis));\r\n        }\r\n        else {\r\n            cellsPerMainAxis = cellCount.y;\r\n            actualCellCountY = Phaser.Math.Clamp(cellCount.y, 1, this.layoutElements.length);\r\n            actualCellCountX = Phaser.Math.Clamp(cellCount.x, 1, Math.ceil(this.layoutElements.length / cellsPerMainAxis));\r\n        }\r\n        var requiredSpace = new Phaser.Math.Vector2(actualCellCountX * this._cellSize.x + (actualCellCountX - 1) * this._spacing.x, actualCellCountY * this._cellSize.y + (actualCellCountY - 1) * this._spacing.y);\r\n        var startOffset = new Phaser.Math.Vector2(this.getStartOffset(0, requiredSpace.x), this.getStartOffset(1, requiredSpace.y));\r\n        var positionX = 0;\r\n        var positionY = 0;\r\n        for (var i = 0; i < this.layoutElements.length; i++) {\r\n            if (this._startAxis === AxisType.Horizontal) {\r\n                positionX = i % cellsPerMainAxis;\r\n                positionY = Math.floor(i / cellsPerMainAxis);\r\n            }\r\n            else {\r\n                positionX = Math.floor(i / cellsPerMainAxis);\r\n                positionY = i % cellsPerMainAxis;\r\n            }\r\n            if (cornerX === 1)\r\n                positionX = actualCellCountX - 1 - positionX;\r\n            if (cornerY === 1)\r\n                positionY = actualCellCountY - 1 - positionY;\r\n            this.setChildAlongAxis(this.layoutElements[i], 0, startOffset.x + (this._cellSize.x + this._spacing.x) * positionX, this._cellSize.x);\r\n            this.setChildAlongAxis(this.layoutElements[i], 1, startOffset.y + (this._cellSize.y + this._spacing.y) * positionY, this._cellSize.y);\r\n        }\r\n        var maxWidth = startOffset.x + (this._cellSize.x + this._spacing.x) * (positionX + 1);\r\n        var maxHeight = startOffset.y + (this._cellSize.y + this._spacing.y) * (positionY + 1);\r\n        if (this.startAxis === AxisType.Horizontal) {\r\n            this.height = maxHeight;\r\n            this.setAllChildPositionOffset(0);\r\n        }\r\n        else {\r\n            this.width = maxWidth;\r\n            this.setAllChildPositionOffset(1);\r\n        }\r\n        if (this.width < maxWidth) {\r\n            this.width = maxWidth;\r\n        }\r\n        if (this.height < maxHeight) {\r\n            this.height = maxHeight;\r\n        }\r\n    };\r\n    GridLayoutGroup.prototype.setChildAlongAxis = function (child, axis, pos, size) {\r\n        if (axis === 0) {\r\n            child.width = size;\r\n        }\r\n        else {\r\n            child.height = size;\r\n        }\r\n        var value = pos;\r\n        if (axis === 0) {\r\n            child.x = value + size * child.originX;\r\n        }\r\n        else {\r\n            child.y = value + size * child.originY;\r\n        }\r\n    };\r\n    GridLayoutGroup.prototype.setAllChildPositionOffset = function (axis) {\r\n        for (var _i = 0, _a = this.layoutElements; _i < _a.length; _i++) {\r\n            var child = _a[_i];\r\n            if (axis === 0) {\r\n                var offset = this.width * 0.5;\r\n                child.x -= offset;\r\n            }\r\n            else {\r\n                var offset = this.height * 0.5;\r\n                child.y -= offset;\r\n            }\r\n        }\r\n    };\r\n    GridLayoutGroup.prototype.getStartOffset = function (axis, requiredSpaceWithoutPadding) {\r\n        var requiredSpace = requiredSpaceWithoutPadding + (axis === 0 ? this.paddingHorizontal() : this.paddingVertical());\r\n        var availableSpace = (axis === 0 ? this.width : this.height);\r\n        var surplusSpace = availableSpace - requiredSpace;\r\n        var alignmentOnAxis = this.getAlignmentOnAxis(axis);\r\n        return (axis === 0 ? this._padding.x : this._padding.z) + surplusSpace * alignmentOnAxis;\r\n    };\r\n    GridLayoutGroup.prototype.getAlignmentOnAxis = function (axis) {\r\n        if (axis === 0)\r\n            return (this._alignmentType % 3) * 0.5;\r\n        else\r\n            return Math.floor(this._alignmentType / 3) * 0.5;\r\n    };\r\n    GridLayoutGroup.prototype.getCellCount = function () {\r\n        var cell = new Phaser.Math.Vector2();\r\n        if (this._constraint === ConstraintType.FixedColumnCount) {\r\n            cell.x = this._constraintCount;\r\n            if (this.layoutElements.length >= cell.x) {\r\n                cell.y = Math.floor(this.layoutElements.length / cell.x) + (this.layoutElements.length % cell.x > 0 ? 1 : 0);\r\n            }\r\n        }\r\n        else if (this._constraint === ConstraintType.FixedRowCount) {\r\n            cell.y = this._constraintCount;\r\n            if (this.layoutElements.length >= cell.y) {\r\n                cell.x = Math.floor(this.layoutElements.length / cell.y) + (this.layoutElements.length % cell.y > 0 ? 1 : 0);\r\n            }\r\n        }\r\n        else {\r\n            cell.x = Math.max(1, Math.floor((this.width - this.paddingHorizontal() + this._spacing.x + 0.001) / (this._cellSize.x + this._spacing.x)));\r\n            cell.y = Math.max(1, Math.floor((this.height - this.paddingVertical() + this._spacing.y + 0.001) / (this._cellSize.y + this._spacing.y)));\r\n        }\r\n        return cell;\r\n    };\r\n    GridLayoutGroup.prototype.paddingHorizontal = function () {\r\n        return this._padding.x + this._padding.y;\r\n    };\r\n    GridLayoutGroup.prototype.paddingVertical = function () {\r\n        return this._padding.z + this._padding.w;\r\n    };\r\n    GridLayoutGroup.ClassName = "gridLayoutGroup";\r\n    return GridLayoutGroup;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar AlignmentType;\r\n(function (AlignmentType) {\r\n    AlignmentType[AlignmentType["UpperLeft"] = 0] = "UpperLeft";\r\n    AlignmentType[AlignmentType["UpperCenter"] = 1] = "UpperCenter";\r\n    AlignmentType[AlignmentType["UpperRight"] = 2] = "UpperRight";\r\n    AlignmentType[AlignmentType["MiddleLeft"] = 3] = "MiddleLeft";\r\n    AlignmentType[AlignmentType["MiddleCenter"] = 4] = "MiddleCenter";\r\n    AlignmentType[AlignmentType["MiddleRight"] = 5] = "MiddleRight";\r\n    AlignmentType[AlignmentType["LowerLeft"] = 6] = "LowerLeft";\r\n    AlignmentType[AlignmentType["LowerCenter"] = 7] = "LowerCenter";\r\n    AlignmentType[AlignmentType["LowerRight"] = 8] = "LowerRight";\r\n})(AlignmentType || (AlignmentType = {}));\r\nvar CornerType;\r\n(function (CornerType) {\r\n    CornerType[CornerType["UpperLeft"] = 0] = "UpperLeft";\r\n    CornerType[CornerType["UpperRight"] = 1] = "UpperRight";\r\n    CornerType[CornerType["LowerLeft"] = 2] = "LowerLeft";\r\n    CornerType[CornerType["LowerRight"] = 3] = "LowerRight";\r\n})(CornerType || (CornerType = {}));\r\nvar AxisType;\r\n(function (AxisType) {\r\n    AxisType[AxisType["Horizontal"] = 0] = "Horizontal";\r\n    AxisType[AxisType["Vertical"] = 1] = "Vertical";\r\n})(AxisType || (AxisType = {}));\r\nvar ConstraintType;\r\n(function (ConstraintType) {\r\n    ConstraintType[ConstraintType["Flexible"] = 0] = "Flexible";\r\n    ConstraintType[ConstraintType["FixedColumnCount"] = 1] = "FixedColumnCount";\r\n    ConstraintType[ConstraintType["FixedRowCount"] = 2] = "FixedRowCount";\r\n})(ConstraintType || (ConstraintType = {}));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CharacterInfo/GridLayoutGroup.ts?')},"./src/ui/ComponentRank/ComponentRankMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentRankMediator", function() { return ComponentRankMediator; });\n/* harmony import */ var _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ComponentRankPanel */ "./src/ui/ComponentRank/ComponentRankPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ComponentRankMediator = /** @class */ (function (_super) {\r\n    __extends(ComponentRankMediator, _super);\r\n    function ComponentRankMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Normal;\r\n        _this.mView = new _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_0__["ComponentRankPanel"](scene, worldService);\r\n        layerManager.addToUILayer(_this.mView);\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    ComponentRankMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    ComponentRankMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    ComponentRankMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ComponentRankMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    ComponentRankMediator.prototype.resize = function () {\r\n        this.mView.resize();\r\n    };\r\n    ComponentRankMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _ComponentRankPanel__WEBPACK_IMPORTED_MODULE_0__["ComponentRankPanel"](this.mScene, this.world);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.show();\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ComponentRankMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            if (this.mView.parentContainer) {\r\n                this.mView.parentContainer.remove(this.mView);\r\n            }\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComponentRankMediator.prototype.update = function (param) {\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n    };\r\n    ComponentRankMediator.NAME = "ComponentRankMediator";\r\n    return ComponentRankMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ComponentRank/ComponentRankMediator.ts?')},"./src/ui/ComponentRank/ComponentRankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentRankPanel", function() { return ComponentRankPanel; });\n/* harmony import */ var _Rank_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Rank/BasicRankPanel */ "./src/ui/Rank/BasicRankPanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ComponentRankMediator */ "./src/ui/ComponentRank/ComponentRankMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ComponentRankPanel = /** @class */ (function (_super) {\r\n    __extends(ComponentRankPanel, _super);\r\n    function ComponentRankPanel(scene, worldService) {\r\n        return _super.call(this, scene, worldService) || this;\r\n    }\r\n    ComponentRankPanel.prototype.addListen = function () {\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n    };\r\n    ComponentRankPanel.prototype.removeListen = function () {\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n    };\r\n    ComponentRankPanel.prototype.resize = function (wid, hei) {\r\n        if (!this.scene)\r\n            return;\r\n        var view = this.scene.cameras.main.worldView;\r\n        this.x = view.width - this.width - wid >> 1;\r\n        this.y = view.height - this.height - hei >> 1;\r\n    };\r\n    ComponentRankPanel.prototype.destroy = function () {\r\n        if (this.mCloseBtn) {\r\n            this.mCloseBtn.destroy(true);\r\n            this.mCloseBtn = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComponentRankPanel.prototype.preload = function () {\r\n        this.scene.load.spritesheet(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getFrameConfig());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ComponentRankPanel.prototype.init = function () {\r\n        this.mCloseBtn = this.scene.make.image({\r\n            x: 0,\r\n            y: 0,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(),\r\n            frame: "btn_normal"\r\n        }, false);\r\n        this.mCloseBtn.setTexture(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["CloseButton"].getName(), "btn_normal");\r\n        this.mCloseBtn.x = (this.width >> 1) - 65;\r\n        this.mCloseBtn.y = (-this.height >> 1);\r\n        _super.prototype.init.call(this);\r\n        this.add(this.mCloseBtn);\r\n        this.mCloseBtn.setInteractive();\r\n        this.mWorld.uiManager.getMediator(_ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__["ComponentRankMediator"].NAME).resize();\r\n        this.mCloseBtn.x = this.width - 18;\r\n    };\r\n    ComponentRankPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_ComponentRankMediator__WEBPACK_IMPORTED_MODULE_2__["ComponentRankMediator"].NAME).resize();\r\n    };\r\n    ComponentRankPanel.prototype.onCloseHandler = function () {\r\n        this.hide();\r\n    };\r\n    return ComponentRankPanel;\r\n}(_Rank_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__["BasicRankPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ComponentRank/ComponentRankPanel.ts?')},"./src/ui/Compose/Compose.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Compose", function() { return Compose; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Compose = /** @class */ (function (_super) {\r\n    __extends(Compose, _super);\r\n    function Compose(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Compose.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CRAFT_QUERY_FORMULA, this.onRetFormulaDetial);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CRAFT_SKILLS, this.openComposePanel);\r\n        }\r\n    };\r\n    Compose.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Compose.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Compose.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Compose.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(Compose.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Compose.prototype.onReqFormulaDetail = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CRAFT_QUERY_FORMULA);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    Compose.prototype.onReqUseFormula = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CRAFT_ALCHEMY);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    Compose.prototype.onRetFormulaDetial = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("formulaDetial", content);\r\n    };\r\n    Compose.prototype.openComposePanel = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("showopen", content);\r\n    };\r\n    return Compose;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Compose/Compose.ts?')},"./src/ui/Compose/ComposeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComposeMediator", function() { return ComposeMediator; });\n/* harmony import */ var _ComposePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ComposePanel */ "./src/ui/Compose/ComposePanel.ts");\n/* harmony import */ var _Compose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Compose */ "./src/ui/Compose/Compose.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ComposeMediator = /** @class */ (function (_super) {\r\n    __extends(ComposeMediator, _super);\r\n    function ComposeMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        if (!_this.compose) {\r\n            _this.compose = new _Compose__WEBPACK_IMPORTED_MODULE_1__["Compose"](_this.world);\r\n            _this.compose.on("formulaDetial", _this.onRetFormulaDetial, _this);\r\n            _this.compose.on("showopen", _this.onShowPanel, _this);\r\n            _this.compose.register();\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().log("qwerqwerqwerqwerrrr+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++");\r\n        }\r\n        return _this;\r\n    }\r\n    ComposeMediator.prototype.show = function () {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _ComposePanel__WEBPACK_IMPORTED_MODULE_0__["ComposePanel"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHideView, this);\r\n            this.mView.on("reqformula", this.onReqFormulaDetial, this);\r\n            this.mView.on("reqUseFormula", this.onReqUseFormula, this);\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        this.mView.show(this.mParam[0]);\r\n    };\r\n    ComposeMediator.prototype.destroy = function () {\r\n        if (this.compose)\r\n            this.compose.destroy();\r\n        this.compose = undefined;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComposeMediator.prototype.onReqFormulaDetial = function (id) {\r\n        this.compose.onReqFormulaDetail(id);\r\n    };\r\n    ComposeMediator.prototype.onReqUseFormula = function (id) {\r\n        this.compose.onReqUseFormula(id);\r\n    };\r\n    ComposeMediator.prototype.onRetFormulaDetial = function (content) {\r\n        var panel = this.mView;\r\n        panel.setComposeDetialData(content);\r\n    };\r\n    ComposeMediator.prototype.onHideView = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComposeMediator.prototype.onShowPanel = function (content) {\r\n        this.setParam([content]);\r\n        this.show();\r\n    };\r\n    return ComposeMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Compose/ComposeMediator.ts?')},"./src/ui/Compose/ComposePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComposePanel", function() { return ComposePanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Market/DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/GameScroller */ "./lib/rexui/lib/ui/scroller/GameScroller.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/event/MouseEvent */ "./lib/rexui/lib/ui/interface/event/MouseEvent.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ComposePanel = /** @class */ (function (_super) {\r\n    __extends(ComposePanel, _super);\r\n    function ComposePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "compose";\r\n        _this.world = world;\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    ComposePanel.prototype.resize = function (width, height) {\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.content.x = width * 0.5;\r\n        this.content.y = height * 0.5;\r\n        this.mGrideTable.refreshPos(width * 0.5 + 10 * this.dpr, height - 70 * this.dpr);\r\n        this.mGrideTable.resetMask();\r\n        this.setSize(width, height);\r\n    };\r\n    ComposePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n    };\r\n    ComposePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.scene.input.on("pointerup", this.onInputPointUp, this);\r\n        this.makeBtn.on(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onMakeHandler, this);\r\n    };\r\n    ComposePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.scene.input.off("pointerup", this.onInputPointUp, this);\r\n        this.makeBtn.off(_lib_rexui_lib_ui_interface_event_MouseEvent__WEBPACK_IMPORTED_MODULE_13__["CoreUI"].MouseEvent.Tap, this.onMakeHandler, this);\r\n    };\r\n    ComposePanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "compose/compose.png", "compose/compose.json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_10__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_10__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_10__["UIAtlasName"].commonUrl + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ComposePanel.prototype.init = function () {\r\n        var _this = this;\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var zoom = this.scale;\r\n        this.content = this.scene.make.container(undefined, false);\r\n        this.content.setSize(width, height);\r\n        this.add(this.content);\r\n        var bggraphics = this.scene.make.graphics(undefined, false);\r\n        bggraphics.clear();\r\n        bggraphics.fillGradientStyle(0x7062EC, 0x7062EC, 0xCC99F5, 0xCC99F5);\r\n        bggraphics.fillRect(-width * 0.5, -height * 0.5, width * zoom, height * zoom);\r\n        var bg = this.scene.make.image({ key: this.key, frame: "main_bg" });\r\n        bg.y = -height * 0.5 + bg.height * 0.5;\r\n        bg.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        bg.displayWidth = width;\r\n        this.content.add([bggraphics, bg]);\r\n        var mfont = "bold " + 17 * this.dpr + "px Source Han Sans";\r\n        var titleBg = this.scene.make.image({ key: this.key, frame: "title_bg" });\r\n        titleBg.y = -height * 0.5 + 23 * this.dpr;\r\n        var titleTex = this.scene.make.text({ x: 0, y: titleBg.y, text: _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("compose.title"), style: { font: mfont, bold: true, color: "#8B5603", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT } }).setOrigin(0.5);\r\n        this.content.add([titleBg, titleTex]);\r\n        var backBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__["Button"](this.scene, _ui_atals_name__WEBPACK_IMPORTED_MODULE_10__["UIAtlasKey"].commonKey, "back_arrow", "back_arrow");\r\n        backBtn.setPosition(-width * 0.5 + 20 * this.dpr, -height * 0.5 + 30 * this.dpr);\r\n        backBtn.on("Tap", this.onBackHandler, this);\r\n        this.content.add(backBtn);\r\n        this.mDetailDisplay = new _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_6__["DetailDisplay"](this.scene);\r\n        this.mDetailDisplay.y = -120 * this.dpr;\r\n        this.mDetailDisplay.scale = this.dpr * 2;\r\n        this.content.add(this.mDetailDisplay);\r\n        this.mDetailBubble = new DetailBubble(this.scene, this.dpr);\r\n        this.mDetailBubble.x = -width * 0.5;\r\n        this.mDetailBubble.y = height * 0.5 - 360 * this.dpr;\r\n        this.content.add(this.mDetailBubble);\r\n        this.makeBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_14__["NineSliceButton"](this.scene, Math.ceil(width * 0.5 - 60 * this.dpr), Math.ceil(height * 0.5 - 310 * this.dpr), 106 * this.dpr, 40 * this.dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_10__["UIAtlasKey"].commonKey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("compose.make"), this.dpr, this.scale, {\r\n            left: 12 * this.dpr,\r\n            top: 12 * this.dpr,\r\n            right: 12 * this.dpr,\r\n            bottom: 12 * this.dpr\r\n        });\r\n        this.makeBtn.setTextStyle({ fontSize: 16 * this.dpr, color: "#996600" });\r\n        // this.makeBtn.on("click", this.onMakeHandler, this);\r\n        this.content.add(this.makeBtn);\r\n        var materialConWdith = 360 * this.dpr, materialConHeight = 92 * this.dpr;\r\n        this.materialCon = this.scene.make.container(undefined, false).setSize(materialConWdith, materialConHeight);\r\n        this.content.add(this.materialCon);\r\n        this.materialCon.setPosition(0, height * 0.5 - 230 * this.dpr);\r\n        var materialbg = this.scene.make.image({ x: 0, y: 0, key: this.key, frame: "sourcelist_bg" });\r\n        materialbg.displayWidth = width;\r\n        var materialTitle = this.scene.make.text({\r\n            x: 0,\r\n            y: -materialConHeight * 0.5 + 12 * this.dpr,\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("compose.needMaterials"),\r\n            style: {\r\n                color: "#ffffff",\r\n                fontSize: 13 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 90 * this.dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var materialLine = this.scene.make.image({ x: -10 * this.dpr, y: materialTitle.y, key: this.key, frame: "sourcelist_title_1" });\r\n        var materialLine2 = this.scene.make.image({ x: 10 * this.dpr, y: materialTitle.y, key: this.key, frame: "sourcelist_title_1" });\r\n        var linePosx = -materialTitle.width * 0.5 - materialLine.width * 0.5 - 10 * this.dpr;\r\n        materialLine.setPosition(linePosx, materialTitle.y);\r\n        materialLine2.setPosition(-linePosx, materialTitle.y).rotation = -Math.PI;\r\n        var materialLine3 = this.scene.make.image({ x: 0, y: materialTitle.y + 12 * this.dpr, key: this.key, frame: "separator" });\r\n        this.materialCon.add([materialbg, materialTitle, materialLine, materialLine2, materialLine3]);\r\n        this.materialGameScroll = new _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_12__["GameScroller"](this.scene, {\r\n            x: width * 0.5,\r\n            y: height - 220 * this.dpr,\r\n            width: width,\r\n            height: 70 * this.dpr,\r\n            zoom: this.scale,\r\n            align: 2,\r\n            orientation: 1,\r\n            valuechangeCallback: undefined,\r\n            celldownCallBack: function (gameobject) {\r\n                _this.materialTipsCon.visible = true;\r\n                _this.onMaterialItemHandler(gameobject);\r\n            },\r\n            cellupCallBack: function (gameobject) {\r\n                _this.materialTipsCon.visible = false;\r\n            }\r\n        });\r\n        this.add(this.materialGameScroll);\r\n        this.materialTipsCon = this.scene.make.container(undefined, false).setPosition(0, -20 * this.dpr);\r\n        this.materialTipsCon.visible = false;\r\n        this.materialCon.add(this.materialTipsCon);\r\n        var tipsWidth = 109 * this.dpr;\r\n        var tipsHeight = 42 * this.dpr;\r\n        var tipsbg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, tipsWidth, tipsHeight, this.key, "tips_bg", {\r\n            left: 20 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: 20 * this.dpr,\r\n            bottom: 20 * this.dpr\r\n        });\r\n        tipsbg.setPosition(26 * this.dpr, -tipsHeight * 0.5);\r\n        this.tipsbg = tipsbg;\r\n        var tipsArrow = this.scene.make.image({ key: this.key, frame: "tips_arrow" });\r\n        var tipsName = this.scene.make.text({\r\n            x: 0,\r\n            y: -materialConHeight * 0.5 + 12 * this.dpr,\r\n            text: "蓝矿石",\r\n            style: {\r\n                color: "#844ED5",\r\n                fontSize: 13 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 90 * this.dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false).setOrigin(0, 0.5).setPosition(-19 * this.dpr, -tipsHeight + 10 * this.dpr);\r\n        this.materialTipsName = tipsName;\r\n        var tipsText = this.scene.make.text({\r\n            x: 0,\r\n            y: -materialConHeight * 0.5 + 12 * this.dpr,\r\n            text: "的肌肤委屈饿换热器我和佛前",\r\n            style: {\r\n                color: "#333333",\r\n                fontSize: 13 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 100 * this.dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false).setOrigin(0).setPosition(-19 * this.dpr, -tipsHeight + 20 * this.dpr);\r\n        this.materialTipsDes = tipsText;\r\n        this.materialTipsCon.add([tipsbg, tipsName, tipsText, tipsArrow]);\r\n        var propFrame = this.scene.textures.getFrame(this.key, "bprint_bg_2");\r\n        var capW = propFrame.width + 10 * this.dpr * zoom;\r\n        var capH = propFrame.height + 12 * this.dpr * zoom;\r\n        var tableConfig = {\r\n            x: width * zoom / 2,\r\n            y: height * zoom * 0.5 + 145 * this.dpr * zoom,\r\n            table: {\r\n                width: width * zoom,\r\n                height: 190 * this.dpr * zoom,\r\n                columns: 2,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellPadX: 40 * this.dpr * zoom,\r\n                zoom: this.scale\r\n            },\r\n            scrollMode: 1,\r\n            clamplChildOY: false,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new ComposeItem(scene, _this.key, _this.dpr, zoom);\r\n                    _this.add(cellContainer);\r\n                }\r\n                // cellContainer.setSize(width, height);\r\n                cellContainer.setItemData(item);\r\n                if (item && _this.mSelectItemData && item.id === _this.mSelectItemData.id)\r\n                    cellContainer.select = true;\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mGrideTable = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_8__["GameGridTable"](this.scene, tableConfig);\r\n        this.mGrideTable.layout();\r\n        this.mGrideTable.on("cellTap", function (cell) {\r\n            if (cell) {\r\n                _this.onSelectItemHandler(cell);\r\n            }\r\n        });\r\n        this.add(this.mGrideTable.table);\r\n        this.resize(width, height);\r\n        _super.prototype.init.call(this);\r\n        if (this.mShowData)\r\n            this.setComposeData(this.mShowData.skills);\r\n    };\r\n    ComposePanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ComposePanel.prototype.setComposeData = function (datas) {\r\n        if (datas && datas.length > 0) {\r\n            this.mGrideTable.setItems(datas);\r\n            var cell = this.mGrideTable.getCell(0);\r\n            this.onSelectItemHandler(cell.container);\r\n        }\r\n    };\r\n    ComposePanel.prototype.setComposeDetialData = function (data) {\r\n        this.mDetailBubble.setDetailData(data.productName, data.productDes);\r\n        this.setDetailDisplay(data);\r\n        this.setMaterialItems(data.materials);\r\n    };\r\n    ComposePanel.prototype.setDetailDisplay = function (data) {\r\n        var resData = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE();\r\n        resData.animations = data.productAnimations;\r\n        resData.display = data.productDisplay;\r\n        resData.avatar = data.productAvatar;\r\n        if (resData.display) {\r\n            this.mDetailDisplay.loadDisplay(resData);\r\n        }\r\n        else if (resData.avatar) {\r\n            this.mDetailDisplay.loadAvatar(resData);\r\n        }\r\n        else {\r\n            // this.mDetailDisplay.loadUrl(this.mSelectedProp.icon);\r\n        }\r\n    };\r\n    ComposePanel.prototype.onSelectItemHandler = function (item) {\r\n        var data = item.itemData;\r\n        this.emit("reqformula", data.id);\r\n        item.select = true;\r\n        this.mSelectItemData = item.itemData;\r\n        this.makeBtn.enable = data.active && data.qualified;\r\n        this.mGrideTable.refresh();\r\n    };\r\n    ComposePanel.prototype.setMaterialItems = function (datas) {\r\n        var len = datas.length;\r\n        var zoom = this.scale;\r\n        var items = [];\r\n        this.materialGameScroll.clearItems();\r\n        for (var i = 0; i < len; i++) {\r\n            var item = new ComposeMaterialItem(this.scene, this.key, this.dpr, zoom);\r\n            item.y = 0;\r\n            items.push(item);\r\n            item.setItemData(datas[i]);\r\n            item.setData("itemData", datas[i]);\r\n            this.materialGameScroll.addItem(item);\r\n        }\r\n        this.materialGameScroll.Sort();\r\n    };\r\n    ComposePanel.prototype.onMaterialItemHandler = function (item) {\r\n        var pos = item.getWorldTransformMatrix();\r\n        this.materialTipsCon.x = pos.tx - this.scaleWidth * 0.5;\r\n        this.materialTipsName.text = item.itemData.name;\r\n        this.materialTipsDes.text = item.itemData.source;\r\n        var tipsHeight = this.materialTipsName.height + this.materialTipsDes.height + 20 * this.dpr;\r\n        var tipsWidth = this.tipsbg.width;\r\n        this.tipsbg.resize(tipsWidth, tipsHeight);\r\n        this.tipsbg.y = -this.tipsbg.height * 0.5;\r\n        this.materialTipsName.y = -tipsHeight + 15 * this.dpr;\r\n        this.materialTipsDes.y = -tipsHeight + 25 * this.dpr;\r\n    };\r\n    ComposePanel.prototype.onMakeHandler = function () {\r\n        var _this = this;\r\n        if (this.mSelectItemData) {\r\n            var content = {\r\n                text: [{\r\n                        text: "\\u60A8\\u786E\\u5B9A\\u8981\\u5408\\u6210" + this.mSelectItemData.name + "\\u5417\\uFF1F"\r\n                    }],\r\n                title: [{\r\n                        text: _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("compose.synthesis")\r\n                    }],\r\n                button: [\r\n                    {\r\n                        text: _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("common.confirm"),\r\n                        local: true,\r\n                        clickhandler: new _Handler_Handler__WEBPACK_IMPORTED_MODULE_15__["Handler"](this, function () {\r\n                            _this.emit("reqUseFormula", _this.mSelectItemData.id);\r\n                        })\r\n                    },\r\n                    {\r\n                        text: _i18n__WEBPACK_IMPORTED_MODULE_11__["i18n"].t("common.cancel"),\r\n                        local: true,\r\n                    }\r\n                ]\r\n            };\r\n            var uimanager = this.mWorld.uiManager;\r\n            uimanager.showMed("MessageBox", content);\r\n        }\r\n    };\r\n    ComposePanel.prototype.onInputPointUp = function () {\r\n        this.materialTipsCon.visible = false;\r\n    };\r\n    ComposePanel.prototype.onBackHandler = function () {\r\n        this.emit("hide");\r\n    };\r\n    return ComposePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_2__["BasePanel"]));\r\n\r\nvar DetailBubble = /** @class */ (function (_super) {\r\n    __extends(DetailBubble, _super);\r\n    function DetailBubble(scene, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.mDetailBubble = _this.scene.make.graphics(undefined, false);\r\n        var bubbleW = 198 * dpr;\r\n        var bubbleH = 96 * dpr;\r\n        _this.mDetailBubble = _this.scene.make.graphics(undefined, false);\r\n        _this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        _this.mDetailBubble.fillRoundedRect(0, 0, bubbleW, bubbleH);\r\n        _this.mItemName = _this.scene.make.text({\r\n            x: 7 * _this.dpr,\r\n            y: 9 * _this.dpr,\r\n            text: "道具名称道具名称",\r\n            style: {\r\n                fontSize: 12 * _this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                color: "#8C55E1",\r\n                align: "center"\r\n            }\r\n        });\r\n        _this.mDesText = _this.scene.make.text({\r\n            x: 8 * dpr,\r\n            y: 30 * dpr,\r\n            style: {\r\n                color: "#ffffff",\r\n                fontSize: 10 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 180 * dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false);\r\n        _this.add([_this.mDetailBubble, _this.mItemName, _this.mDesText]);\r\n        _this.setSize(bubbleW, bubbleH);\r\n        return _this;\r\n    }\r\n    DetailBubble.prototype.setDetailData = function (name, des) {\r\n        this.mItemName.setText(name);\r\n        this.mDesText.setText(des);\r\n        this.resize();\r\n    };\r\n    DetailBubble.prototype.resize = function (w, h) {\r\n        if (w === undefined)\r\n            w = this.width;\r\n        var bubbleH = this.mDesText.height + 60 * this.dpr;\r\n        if (w === this.width && bubbleH === this.height) {\r\n            return;\r\n        }\r\n        this.mDetailBubble.clear();\r\n        this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        this.mDetailBubble.fillRoundedRect(0, 0, w, bubbleH);\r\n        this.setSize(w, bubbleH);\r\n        // this.mDetailBubbleContainer.y = this.height - this.y - this.mDetailBubbleContainer.height - 6 * this.dpr;\r\n    };\r\n    return DetailBubble;\r\n}(Phaser.GameObjects.Container));\r\nvar ComposeItem = /** @class */ (function (_super) {\r\n    __extends(ComposeItem, _super);\r\n    function ComposeItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.zoom = zoom;\r\n        _this.bg = _this.scene.make.image({ key: _this.key, frame: "bprint_bg_1" });\r\n        _this.setSize(_this.bg.width, _this.bg.height);\r\n        _this.itemIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_7__["DynamicImage"](_this.scene, 0, 0);\r\n        var width = _this.width;\r\n        var height = _this.height;\r\n        _this.newIcon = _this.scene.make.image({ key: _this.key, frame: "tag_new" });\r\n        _this.newIcon.setPosition(-width * 0.5 + 3 * dpr, -height * 0.5 + 3 * dpr);\r\n        _this.newText = _this.scene.make.text({\r\n            x: _this.newIcon.x,\r\n            y: _this.newIcon.y,\r\n            text: "N",\r\n            style: {\r\n                fontSize: 11 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                color: "#ffffff",\r\n                align: "center"\r\n            }\r\n        }).setOrigin(0.5);\r\n        _this.qualityIcon = _this.scene.make.image({ key: _this.key, frame: "tag_rank_a" });\r\n        _this.qualityIcon.setPosition(-width * 0.5 + _this.qualityIcon.width * 0.5 - 2 * dpr, height * 0.5 - _this.qualityIcon.height * 0.5);\r\n        _this.qualityTex = _this.scene.make.text({\r\n            x: _this.qualityIcon.x,\r\n            y: _this.qualityIcon.y,\r\n            text: "A",\r\n            style: {\r\n                fontSize: 11 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                color: "#ffffff",\r\n                align: "center"\r\n            }\r\n        }).setOrigin(0.5);\r\n        _this.qualifiedIcon = _this.scene.make.image({ key: _this.key, frame: "tag_ready" });\r\n        _this.qualifiedIcon.setOrigin(1).setPosition(width * 0.5 - 3 * dpr, height * 0.5 - 3 * dpr);\r\n        _this.lockbg = _this.scene.make.image({ key: _this.key, frame: "bprint_mask" });\r\n        _this.lockIcon = _this.scene.make.image({ key: _this.key, frame: "lock" });\r\n        _this.add([_this.bg, _this.itemIcon, _this.newIcon, _this.newText, _this.qualityIcon, _this.qualityTex, _this.qualifiedIcon, _this.lockbg, _this.lockIcon]);\r\n        return _this;\r\n    }\r\n    ComposeItem.prototype.setItemData = function (data) {\r\n        this.itemData = data;\r\n        var active = data.active;\r\n        this.newIcon.visible = active;\r\n        this.newText.visible = active;\r\n        this.qualityIcon.visible = active;\r\n        this.qualityTex.visible = active;\r\n        this.qualityTex.text = data.quality;\r\n        this.qualifiedIcon.visible = active && data.qualified;\r\n        this.lockbg.visible = !data.active;\r\n        this.lockIcon.visible = !data.active;\r\n        this.setQualityTexture(data.quality);\r\n        if (data.display)\r\n            this.setItemIcon(data.display);\r\n        this.select = false;\r\n    };\r\n    Object.defineProperty(ComposeItem.prototype, "select", {\r\n        set: function (value) {\r\n            if (value)\r\n                this.bg.setFrame("bprint_bg_2");\r\n            else\r\n                this.bg.setFrame("bprint_bg_1");\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ComposeItem.prototype.setItemIcon = function (display) {\r\n        var _this = this;\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getOsdRes(display.texturePath);\r\n        this.itemIcon.load(url, this, function () {\r\n            _this.itemIcon.scale = _this.dpr * _this.zoom;\r\n            _this.itemIcon.setPosition(0, 0);\r\n        });\r\n    };\r\n    ComposeItem.prototype.setQualityTexture = function (quality) {\r\n        this.qualityIcon.visible = true;\r\n        if (quality === "A")\r\n            this.qualityIcon.setFrame("tag_rank_a");\r\n        else if (quality === "B")\r\n            this.qualityIcon.setFrame("tag_rank_b");\r\n        else if (quality === "C")\r\n            this.qualityIcon.setFrame("tag_rank_c");\r\n        else\r\n            this.qualityIcon.visible = false;\r\n    };\r\n    return ComposeItem;\r\n}(Phaser.GameObjects.Container));\r\nvar ComposeMaterialItem = /** @class */ (function (_super) {\r\n    __extends(ComposeMaterialItem, _super);\r\n    function ComposeMaterialItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.zoom = zoom;\r\n        var bg = _this.scene.make.image({ key: _this.key, frame: "source_bg" });\r\n        _this.itemIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_7__["DynamicImage"](scene, 0, 0);\r\n        _this.itemCount = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_9__["BBCodeText"](_this.scene, 0, 0, {})\r\n            .setOrigin(0.5).setFontSize(11 * dpr).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT);\r\n        _this.add([bg, _this.itemIcon, _this.itemCount]);\r\n        _this.setSize(bg.width, bg.height);\r\n        _this.itemCount.y = _this.height * 0.5;\r\n        return _this;\r\n    }\r\n    ComposeMaterialItem.prototype.setItemData = function (data) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        this.itemCount.text = this.getCountText(data.count, data.neededCount);\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getOsdRes(data.display.texturePath);\r\n        this.itemIcon.load(url, this, function () {\r\n            _this.itemIcon.scale = _this.dpr * _this.zoom;\r\n            _this.itemIcon.setPosition(0, 0);\r\n        });\r\n    };\r\n    ComposeMaterialItem.prototype.getCountText = function (count, needcount) {\r\n        var color = (count >= needcount ? "#ffffff" : "#ff0000");\r\n        var text = "[stroke=" + color + "][color=" + color + "]" + count + "[/color][/stroke]/" + needcount;\r\n        return text;\r\n    };\r\n    return ComposeMaterialItem;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Compose/ComposePanel.ts?')},"./src/ui/ControlF/ControlFMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ControlFMediator", function() { return ControlFMediator; });\n/* harmony import */ var _ControlFPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ControlFPanel */ "./src/ui/ControlF/ControlFPanel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../rooms/element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ControlFMediator = /** @class */ (function (_super) {\r\n    __extends(ControlFMediator, _super);\r\n    function ControlFMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__["UIType"].Tips;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    ControlFMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    ControlFMediator.prototype.getView = function () {\r\n        return undefined;\r\n    };\r\n    ControlFMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView && this.mView.isShow()) {\r\n            if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager.actor ||\r\n                this.world.roomManager.currentRoom.playerManager.actor.getState() === _rooms_element_element__WEBPACK_IMPORTED_MODULE_3__["PlayerState"].WALK) {\r\n                this.mView.off("control", this.handControlF, this);\r\n                this.mView.destroy();\r\n                this.mView = null;\r\n            }\r\n        }\r\n    };\r\n    ControlFMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ControlFMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    ControlFMediator.prototype.resize = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.resize();\r\n    };\r\n    ControlFMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        this.mView = new _ControlFPanel__WEBPACK_IMPORTED_MODULE_0__["ControlFPanel"](this.mScene, this.world);\r\n        this.mView.on("control", this.handControlF, this);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ControlFMediator.prototype.update = function (param) {\r\n    };\r\n    ControlFMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.off("control", this.handControlF, this);\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n        this.mLayerManager = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ControlFMediator.prototype.handControlF = function () {\r\n        if (!this.world || !this.world.connection) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n        var content = pkt.content;\r\n        var keyArr;\r\n        if (this.world.inputManager) {\r\n            keyArr = this.world.inputManager.getKeyDowns();\r\n        }\r\n        else {\r\n            keyArr = [];\r\n        }\r\n        keyArr = keyArr.concat(Phaser.Input.Keyboard.KeyCodes.F);\r\n        content.keyCodes = keyArr;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ControlFMediator.NAME = "ControlFMediator";\r\n    return ControlFMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ControlF/ControlFMediator.ts?')},"./src/ui/ControlF/ControlFPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ControlFPanel", function() { return ControlFPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ControlFPanel = /** @class */ (function (_super) {\r\n    __extends(ControlFPanel, _super);\r\n    function ControlFPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ControlFPanel.prototype.addListen = function () {\r\n        this.on("pointerdown", this.onMouseDownHandler, this);\r\n    };\r\n    ControlFPanel.prototype.removeListen = function () {\r\n        this.off("pointerdown", this.onMouseDownHandler, this);\r\n    };\r\n    ControlFPanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        if (!this.mScene)\r\n            return;\r\n        var worldView = this.mScene.cameras.main.worldView;\r\n        this.x = worldView.x + (worldView.width >> 1);\r\n        this.y = worldView.y + (worldView.height >> 1);\r\n    };\r\n    ControlFPanel.prototype.destroy = function () {\r\n        if (this.mControlText)\r\n            this.mControlText.destroy(true);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ControlFPanel.prototype.preload = function () {\r\n        this.mScene.load.image("controlF_background", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/controlf/background.png"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ControlFPanel.prototype.init = function () {\r\n        if (!this.mScene)\r\n            return;\r\n        var image = this.mScene.make.image({\r\n            key: "controlF_background"\r\n        }, false);\r\n        this.add(image);\r\n        // TODO 不一定是F\r\n        this.mControlText = this.mScene.make.text({\r\n            align: "center",\r\n            text: "F",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_20_BOLD }\r\n        }, false);\r\n        this.mControlText.x = -(this.mControlText.width >> 1);\r\n        this.mControlText.y = -(this.mControlText.height >> 1);\r\n        this.add(this.mControlText);\r\n        this.setSize(image.width, image.height);\r\n        this.setInteractive();\r\n        _super.prototype.init.call(this);\r\n        this.resize();\r\n    };\r\n    ControlFPanel.prototype.onMouseDownHandler = function () {\r\n        this.scale = 0.8;\r\n    };\r\n    ControlFPanel.prototype.onMouseUpHandler = function () {\r\n        this.scale = 1;\r\n        this.emit("control");\r\n    };\r\n    return ControlFPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ControlF/ControlFPanel.ts?')},"./src/ui/CutIn/CutInMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CutInMediator", function() { return CutInMediator; });\n/* harmony import */ var _CutInPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CutInPanel */ "./src/ui/CutIn/CutInPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar CutInMediator = /** @class */ (function (_super) {\r\n    __extends(CutInMediator, _super);\r\n    function CutInMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    CutInMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _CutInPanel__WEBPACK_IMPORTED_MODULE_0__["CutInPanel"](this.scene, this.world);\r\n        this.mView.once("close", this.onCloseHandler, this);\r\n        this.mView.show(param);\r\n        // this.layerManager.addToToolTipsLayer(this.mView.view);\r\n    };\r\n    CutInMediator.prototype.onCloseHandler = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    return CutInMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CutIn/CutInMediator.ts?')},"./src/ui/CutIn/CutInPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CutInPanel", function() { return CutInPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar CutInPanel = /** @class */ (function (_super) {\r\n    __extends(CutInPanel, _super);\r\n    function CutInPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "cut_in";\r\n        return _this;\r\n    }\r\n    CutInPanel.prototype.show = function (param) {\r\n        var _this = this;\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        // if (!param || param.length < 1) return;\r\n        if (param && param.length > 0) {\r\n            var text = param[0].text;\r\n            if (this.mName) {\r\n                this.mName.setText(text[0].text);\r\n            }\r\n        }\r\n        else {\r\n            if (this.mName) {\r\n                this.mName.setText("???");\r\n            }\r\n        }\r\n        var width = this.scene.cameras.main.width;\r\n        this.x = width + this.width / 2;\r\n        // this.view.alpha = 0;\r\n        var _x = this.scene.cameras.main.width / 2;\r\n        this.scene.tweens.timeline({\r\n            targets: this,\r\n            duration: 300,\r\n            tweens: [{\r\n                    x: _x,\r\n                    alpha: 1,\r\n                    ease: "Sine.easeInOut"\r\n                }, {\r\n                    delay: 2000,\r\n                    y: this.y - 10 * this.dpr,\r\n                    alpha: 0\r\n                }],\r\n            onComplete: function () {\r\n                _this.emit("close");\r\n            }\r\n        });\r\n    };\r\n    CutInPanel.prototype.resize = function (w, h) {\r\n        // this.x = w / 2;\r\n        this.y = 140 * this.dpr;\r\n    };\r\n    CutInPanel.prototype.preload = function () {\r\n        this.scene.load.image(this.key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getUIRes(this.dpr, "cut_in/cut_in_bg.png"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    CutInPanel.prototype.init = function () {\r\n        var background = this.scene.make.image({\r\n            key: this.key\r\n        }, false);\r\n        this.setSize(background.width * this.scale, background.height * this.scale);\r\n        this.mName = this.scene.make.text({\r\n            style: {\r\n                color: "#ffcc33",\r\n                fontSize: 18 * this.dpr,\r\n                fotnFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mName.setFontStyle("bold");\r\n        this.mName.setStroke("#000000", 1 * this.dpr);\r\n        this.add([background, this.mName]);\r\n        _super.prototype.init.call(this);\r\n        this.resize(this.scene.cameras.main.width, this.scene.cameras.main.height);\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n    };\r\n    return CutInPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CutIn/CutInPanel.ts?')},"./src/ui/CutInMenu/CutInMenu.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CutInMenu", function() { return CutInMenu; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar CutInMenu = /** @class */ (function (_super) {\r\n    __extends(CutInMenu, _super);\r\n    function CutInMenu(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    CutInMenu.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            //  this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MINING_MODE_SHOW_REWARD_PACKAGE, this.onMineSettlePackageHandler);\r\n        }\r\n    };\r\n    CutInMenu.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    CutInMenu.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    CutInMenu.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    CutInMenu.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    CutInMenu.prototype.reqRightButton = function (uiid, btnid) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = packet.content;\r\n        content.uiId = uiid;\r\n        content.componentId = btnid;\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(CutInMenu.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return CutInMenu;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CutInMenu/CutInMenu.ts?')},"./src/ui/CutInMenu/CutInMenuMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CutInMenuMediator", function() { return CutInMenuMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _CutInMenu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CutInMenu */ "./src/ui/CutInMenu/CutInMenu.ts");\n/* harmony import */ var _CutInMenuPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CutInMenuPanel */ "./src/ui/CutInMenu/CutInMenuPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar CutInMenuMediator = /** @class */ (function (_super) {\r\n    __extends(CutInMenuMediator, _super);\r\n    function CutInMenuMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    CutInMenuMediator.prototype.show = function (mParam) {\r\n        if (this.mView) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _CutInMenuPanel__WEBPACK_IMPORTED_MODULE_2__["CutInMenuPanel"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHideView, this);\r\n            this.mView.on("rightButton", this.onRightButtonHandler, this);\r\n        }\r\n        if (!this.cutInMenu) {\r\n            this.cutInMenu = new _CutInMenu__WEBPACK_IMPORTED_MODULE_1__["CutInMenu"](this.world);\r\n            this.cutInMenu.register();\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        this.mView.show(mParam);\r\n    };\r\n    CutInMenuMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    CutInMenuMediator.prototype.destroy = function () {\r\n        if (this.cutInMenu) {\r\n            this.cutInMenu.destroy();\r\n            this.cutInMenu = undefined;\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    CutInMenuMediator.prototype.onRightButtonHandler = function (uiid, btnid) {\r\n        this.cutInMenu.reqRightButton(uiid, btnid);\r\n    };\r\n    CutInMenuMediator.prototype.onHideView = function () {\r\n        this.destroy();\r\n    };\r\n    return CutInMenuMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CutInMenu/CutInMenuMediator.ts?')},"./src/ui/CutInMenu/CutInMenuPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CutInMenuPanel", function() { return CutInMenuPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar CutInMenuPanel = /** @class */ (function (_super) {\r\n    __extends(CutInMenuPanel, _super);\r\n    function CutInMenuPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "cutinmenupanel";\r\n        _this.mapPop = new Map();\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    CutInMenuPanel.prototype.resize = function (width, height) {\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.setSize(width, height);\r\n    };\r\n    CutInMenuPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.addListen();\r\n    };\r\n    CutInMenuPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    CutInMenuPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    CutInMenuPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "cutInmenu/cutInmenu.png", "cutInmenu/cutInmenu.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    CutInMenuPanel.prototype.init = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        this.rightPopButton = new RightPopContainer(this.scene, width, this.key, this.dpr);\r\n        var posx = width + this.rightPopButton.width * 0.5 - 15 * this.dpr;\r\n        var bounds = this.getActivityBounds();\r\n        if (bounds) {\r\n            this.rightPopButton.setPosition(posx, bounds.bottom + this.rightPopButton.height);\r\n        }\r\n        else {\r\n            this.rightPopButton.setPosition(posx, height * 0.5);\r\n        }\r\n        this.rightPopButton.setClickHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_1__["Handler"](this, this.onRightClickHandler));\r\n        this.add(this.rightPopButton);\r\n        this.resize(width, height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    CutInMenuPanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CutInMenuPanel.prototype.onRightClickHandler = function () {\r\n        var data = this.mShowData[0];\r\n        this.emit("rightButton", data.id, data.button[0].node.id);\r\n    };\r\n    CutInMenuPanel.prototype.getActivityBounds = function () {\r\n        var mMediator = this.world.uiManager.getMediator("ActivityMediator");\r\n        var bounds;\r\n        if (mMediator)\r\n            bounds = mMediator.getView().getBounds();\r\n        return bounds;\r\n    };\r\n    return CutInMenuPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar RightPopContainer = /** @class */ (function (_super) {\r\n    __extends(RightPopContainer, _super);\r\n    function RightPopContainer(scene, width, key, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.isPop = false;\r\n        _this.isPlaying = false;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.scaleWidth = width;\r\n        var minecarbg = _this.scene.make.image({ key: _this.key, frame: "minebag_bg" });\r\n        _this.bgSprite = _this.scene.make.image({ key: _this.key, frame: "minebag_bg_brth" }, false);\r\n        _this.minecarBtn = _this.scene.make.image({ key: _this.key, frame: "minecar" }); // new Button(this.scene, this.key, "minecar", "minecar");\r\n        _this.minecarBtn.setPosition(-12 * dpr, -_this.minecarBtn.height * 0.5);\r\n        _this.teximg = _this.scene.make.image({ key: _this.key, frame: "text_minebag" });\r\n        _this.teximg.setPosition(_this.minecarBtn.x, 2 * dpr);\r\n        var arrow = _this.scene.make.image({ key: _this.key, frame: "arow" });\r\n        arrow.setPosition(-minecarbg.width * 0.5 + 10 * dpr, 0);\r\n        _this.add([_this.bgSprite, minecarbg, _this.minecarBtn, _this.teximg, arrow]);\r\n        minecarbg.on("pointerup", _this.onClickHandler, _this);\r\n        minecarbg.setInteractive();\r\n        _this.setSize(minecarbg.width, minecarbg.height);\r\n        // this.scene.anims.create({\r\n        //     key: "minecarFrame",\r\n        //     frames: [{ key: this.key, frame: "minebag_bg" }, { key: this.key, frame: "minebag_bg_brth" }],\r\n        //     repeat: -1,\r\n        //     duration: 150\r\n        // });\r\n        _this.tween = _this.scene.tweens.add({\r\n            targets: _this.bgSprite,\r\n            alpha: { value: 0, duration: 500, ease: "Power1", yoyo: true },\r\n            repeat: -1\r\n        });\r\n        return _this;\r\n        // this.tween = this.scene.tweens.addCounter({\r\n        //     from: 1,\r\n        //     to: 0,\r\n        //     duration: 300,\r\n        //     yoyo: true,\r\n        //     onUpdate: () => {\r\n        //         this.bgSprite.alpha = this.tween.getValue();\r\n        //     }\r\n        // });\r\n        // this.play();\r\n    }\r\n    RightPopContainer.prototype.setClickHandler = function (handler) {\r\n        this.clickHandler = handler;\r\n    };\r\n    RightPopContainer.prototype.setPopData = function (data) {\r\n        this.popData = data;\r\n    };\r\n    RightPopContainer.prototype.play = function () {\r\n        // this.bgSprite.play("minecarFrame");\r\n        this.bgSprite.alpha = 1;\r\n        this.tween.resume();\r\n        this.isPop = false;\r\n    };\r\n    RightPopContainer.prototype.stop = function () {\r\n        // this.bgSprite.anims.remove();\r\n        this.tween.pause();\r\n        this.bgSprite.alpha = 0;\r\n        this.isPop = true;\r\n    };\r\n    RightPopContainer.prototype.onClickHandler = function () {\r\n        if (!this.isPlaying && !this.isPop) {\r\n            this.popAnim();\r\n        }\r\n        else if (!this.isPlaying && this.isPop) {\r\n            this.takeback();\r\n            if (this.clickHandler)\r\n                this.clickHandler.runWith(this.popData);\r\n        }\r\n    };\r\n    RightPopContainer.prototype.popAnim = function () {\r\n        this.isPlaying = true;\r\n        var posTx = this.scaleWidth - 15 * this.dpr;\r\n        var target = this;\r\n        this.scene.tweens.add({\r\n            targets: target,\r\n            x: { value: posTx, duration: 300, ease: "Bounce.easeOut" },\r\n            onComplete: function () {\r\n                target.stop();\r\n                target.isPlaying = false;\r\n                target.timeID = setTimeout(function () {\r\n                    target.takeback();\r\n                }, 3000);\r\n            }\r\n        });\r\n    };\r\n    RightPopContainer.prototype.takeback = function () {\r\n        if (this.timeID) {\r\n            clearTimeout(this.timeID);\r\n            this.timeID = undefined;\r\n        }\r\n        this.isPlaying = true;\r\n        var posx = this.scaleWidth + this.width * 0.5 - 15 * this.dpr;\r\n        var target = this;\r\n        this.scene.tweens.add({\r\n            targets: target,\r\n            x: { value: posx, duration: 300, ease: "Bounce.easeOut" },\r\n            onComplete: function () {\r\n                target.play();\r\n                target.isPlaying = false;\r\n            }\r\n        });\r\n    };\r\n    return RightPopContainer;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/CutInMenu/CutInMenuPanel.ts?')},"./src/ui/DebugLogger/DebugLoggerMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebugLoggerMediator", function() { return DebugLoggerMediator; });\n/* harmony import */ var _DebugLoggerPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DebugLoggerPanel */ "./src/ui/DebugLogger/DebugLoggerPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DebugLoggerMediator = /** @class */ (function (_super) {\r\n    __extends(DebugLoggerMediator, _super);\r\n    function DebugLoggerMediator(uiManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Scene;\r\n        _this.mScene = scene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    DebugLoggerMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize();\r\n    };\r\n    DebugLoggerMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    DebugLoggerMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _DebugLoggerPanel__WEBPACK_IMPORTED_MODULE_0__["DebugLogger"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    DebugLoggerMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    DebugLoggerMediator.prototype.destroy = function () {\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DebugLoggerMediator.NAME = "DebugLoggerMediator";\r\n    return DebugLoggerMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/DebugLogger/DebugLoggerMediator.ts?')},"./src/ui/DebugLogger/DebugLoggerPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DebugLogger", function() { return DebugLogger; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DebugLoggerMediator */ "./src/ui/DebugLogger/DebugLoggerMediator.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DebugLogger = /** @class */ (function (_super) {\r\n    __extends(DebugLogger, _super);\r\n    function DebugLogger(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mDelay = 0;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    DebugLogger.prototype.addListen = function () {\r\n        // if (this.mWorld.game.device.os.desktop) {\r\n        this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n        // }\r\n    };\r\n    DebugLogger.prototype.removeListen = function () {\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn.off("pointerup", this.closeHandler, this);\r\n        }\r\n    };\r\n    DebugLogger.prototype.show = function (param) {\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShow = true;\r\n        this.resize();\r\n    };\r\n    DebugLogger.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.showDescTxT();\r\n        // if (this.mWorld.game.device.os.desktop) {\r\n        //     this.x = ((this.width >> 1) + 60) * this.mWorld.uiScale;\r\n        //     this.y = (this.height >> 1) * this.mWorld.uiScale;\r\n        // } else {\r\n        //     if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n        //         this.x = size.width >> 1;\r\n        //         this.y = size.height >> 1;\r\n        //     } else {\r\n        //         this.x = size.width >> 1;\r\n        //         this.y = size.height >> 1;\r\n        //     }\r\n        // }\r\n        this.update(0);\r\n    };\r\n    DebugLogger.prototype.update = function (param) {\r\n        var now = this.mWorld.roomManager.currentRoom.now();\r\n        if (this.mDelay - now < 3000) {\r\n            this.showDescTxT();\r\n            this.mTimeTF.setText("FPS:" + param);\r\n            this.mDescTF.setText(this.mDescTxt);\r\n            this.mDelay = now;\r\n        }\r\n    };\r\n    DebugLogger.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DebugLogger.prototype.init = function () {\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var size = this.mWorld.getSize();\r\n        this.mBgWidth = 400;\r\n        this.mBgHeight = size.height >> 1;\r\n        // this.mBackground = new NinePatch(this.mScene, 0, 0,\r\n        //     this.mBgWidth,\r\n        //     this.mBgHeight,\r\n        //     "logger",\r\n        //     null,\r\n        //     Background.getConfig()\r\n        // );\r\n        var width = this.scene.cameras.main.width / 2;\r\n        var height = this.scene.cameras.main.height;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        this.mBackground.fillStyle(0, 0.6);\r\n        this.mBackground.fillRect(0, 0, width, height);\r\n        this.setSize(width, height);\r\n        this.add(this.mBackground);\r\n        this.mTimeTF = this.mScene.make.text({\r\n            style: {\r\n                x: 0,\r\n                y: 0,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_6__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * this.dpr,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: size.width - 10, height: 20, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mDescTF = this.mScene.make.text({\r\n            style: {\r\n                x: 0,\r\n                y: 20 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_6__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * this.dpr,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: this.width - 10 * this.dpr, height: this.height - 30, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        // this.mTimeTF.x = -this.width / 2 + 5;\r\n        // this.mDescTF.x = -this.width / 2 + 5;\r\n        // this.mTimeTF.y = -this.height / 2 + 5;\r\n        // this.mDescTF.y = -this.height / 2 + 23;\r\n        this.add(this.mTimeTF);\r\n        this.add(this.mDescTF);\r\n        // this.setSize(this.mBgWidth, this.mBgHeight);\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_4__["IconBtn"](this.mScene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_5__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n                iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n            });\r\n            this.mClsBtn.x = this.width;\r\n            this.mClsBtn.y = 10 * this.dpr;\r\n            this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n            this.add(this.mClsBtn);\r\n        }\r\n        _super.prototype.init.call(this);\r\n        this.addListen();\r\n    };\r\n    DebugLogger.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME).resize();\r\n    };\r\n    DebugLogger.prototype.showDescTxT = function () {\r\n        var orientation = this.mWorld.getSize().width > this.mWorld.getSize().height ? "LANDSCAPE" : "PORTRAIT";\r\n        var renderType = "WEBGL";\r\n        if (this.mWorld.game.config.renderType === Phaser.CANVAS) {\r\n            renderType = "CANVAS";\r\n        }\r\n        else if (this.mWorld.game.config.renderType === Phaser.HEADLESS) {\r\n            renderType = "HEADLESS";\r\n        }\r\n        // this.mDescTxt = "rendertype:" + renderType + "\\n" + " width: " + this.mWorld.getSize().width + "\\n" + "height: " + this.mWorld.getSize().height + "\\n" + "orientation: " + orientation + "\\n" + "devicePixelRatio: " + window.devicePixelRatio;\r\n        var config = this.mWorld.getConfig();\r\n        this.mDescTxt = "\\n            rendertype: " + renderType + "\\n            size: " + config.width + " " + config.height + "\\n            device size: " + this.mWorld.getSize().width.toFixed(2) + " " + this.mWorld.getSize().height.toFixed(2) + "\\n            scene scale: " + this.mWorld.scaleRatio + "\\n            devicePixel: " + this.mWorld.uiRatio + "\\n            ui scale: " + this.mWorld.uiScale.toFixed(4);\r\n        // this.showErrTxt();\r\n    };\r\n    DebugLogger.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    DebugLogger.prototype.showErrTxt = function () {\r\n        var errList = _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().getErrorList();\r\n        if (!errList) {\r\n            return;\r\n        }\r\n        var errStr = "";\r\n        errList.forEach(function (str) {\r\n            errStr += "\\n" + str;\r\n        });\r\n        this.mDescTxt += errStr;\r\n    };\r\n    return DebugLogger;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/DebugLogger/DebugLoggerPanel.ts?')},"./src/ui/DecorateControl/DecorateControlMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateControlMediator", function() { return DecorateControlMediator; });\n/* harmony import */ var _DecorateControlPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DecorateControlPanel */ "./src/ui/DecorateControl/DecorateControlPanel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar DecorateControlMediator = /** @class */ (function (_super) {\r\n    __extends(DecorateControlMediator, _super);\r\n    function DecorateControlMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.world = world;\r\n        if (world) {\r\n            world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].SELECTED_DECORATE_ELEMENT, _this.onSelectedDecorateHandler, _this);\r\n            world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].CANCEL_DECORATE_ELEMENT, _this.onCancelDecorateHandler, _this);\r\n        }\r\n        return _this;\r\n    }\r\n    DecorateControlMediator.prototype.show = function () {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _DecorateControlPanel__WEBPACK_IMPORTED_MODULE_0__["DecorateControlPanel"](this.scene, this.world);\r\n        }\r\n        this.addActionListener();\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    DecorateControlMediator.prototype.destroy = function () {\r\n        if (this.world) {\r\n            this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].SELECTED_DECORATE_ELEMENT, this.onSelectedDecorateHandler, this);\r\n            this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].CANCEL_DECORATE_ELEMENT, this.onCancelDecorateHandler, this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DecorateControlMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    DecorateControlMediator.prototype.onSelectedDecorateHandler = function () {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        if (this.mView.parentContainer) {\r\n            this.mView.parentContainer.remove(this.mView);\r\n        }\r\n    };\r\n    DecorateControlMediator.prototype.onCancelDecorateHandler = function () {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    DecorateControlMediator.prototype.addActionListener = function () {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.on("exit", this.onExitHandler, this);\r\n        this.mView.on("recycleAll", this.onRecycleAllHandler, this);\r\n        this.mView.on("redo", this.onRedoHandler, this);\r\n        this.mView.on("showFurni", this.onShowFurniHandler, this);\r\n        this.mView.on("save", this.onSaveHandler, this);\r\n        this.mView.on("getDoor", this.onGetDoorHandler, this);\r\n    };\r\n    DecorateControlMediator.prototype.onExitHandler = function () {\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);\r\n        var content = packet.content;\r\n        content.needSaveEditScene = false;\r\n        this.world.connection.send(packet);\r\n    };\r\n    DecorateControlMediator.prototype.onRecycleAllHandler = function () {\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_ALL);\r\n        this.world.connection.send(packet);\r\n    };\r\n    DecorateControlMediator.prototype.onRedoHandler = function () {\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_RECYCLE_LAST_SPRITE);\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateControlMediator.prototype.onShowFurniHandler = function () {\r\n        var uiManager = this.world.uiManager;\r\n        if (uiManager) {\r\n            uiManager.showMed("FurniBag");\r\n        }\r\n    };\r\n    DecorateControlMediator.prototype.onSaveHandler = function () {\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);\r\n        var content = packet.content;\r\n        content.needSaveEditScene = true;\r\n        this.connection.send(packet);\r\n    };\r\n    DecorateControlMediator.prototype.onGetDoorHandler = function () {\r\n        if (!this.connection) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_SPAWN_POINT);\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(DecorateControlMediator.prototype, "connection", {\r\n        get: function () {\r\n            if (!this.world) {\r\n                return;\r\n            }\r\n            return this.world.connection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DecorateControlMediator.NAME = "DecorateControlMediator";\r\n    return DecorateControlMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/DecorateControl/DecorateControlMediator.ts?')},"./src/ui/DecorateControl/DecorateControlPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateControlPanel", function() { return DecorateControlPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar DecorateControlPanel = /** @class */ (function (_super) {\r\n    __extends(DecorateControlPanel, _super);\r\n    function DecorateControlPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.key = "decorateControl";\r\n        return _this;\r\n    }\r\n    DecorateControlPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mExitBtn.on("pointerup", this.onExitHandler, this);\r\n        this.mRecycleAllBtn.on("pointerup", this.onRecycleAllHandler, this);\r\n        this.mRedoBtn.on("pointerup", this.onRedoHandler, this);\r\n        this.mFurniBtn.on("pointerup", this.onShowFurniHandler, this);\r\n        this.mSaveBtn.on("pointerup", this.onSaveHandler, this);\r\n        this.mDoorBtn.on("pointerup", this.onGetDoorHandler, this);\r\n    };\r\n    DecorateControlPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mExitBtn.off("pointerup", this.onExitHandler, this);\r\n        this.mRecycleAllBtn.off("pointerup", this.onRecycleAllHandler, this);\r\n        this.mRedoBtn.off("pointerup", this.onRedoHandler, this);\r\n        this.mFurniBtn.off("pointerup", this.onShowFurniHandler, this);\r\n        this.mSaveBtn.off("pointerup", this.onSaveHandler, this);\r\n        this.mDoorBtn.off("pointerup", this.onGetDoorHandler, this);\r\n    };\r\n    DecorateControlPanel.prototype.resize = function (w, h) {\r\n        this.setSize(w, 131 * this.dpr);\r\n        // this.x = this.width * this.originX;\r\n        // this.y = this.height * this.originY;\r\n        this.mBackground.clear();\r\n        this.mBackground.fillStyle(0, 0.6);\r\n        this.mBackground.fillRect(0, 0, this.width, this.height);\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    DecorateControlPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "decorate_control/decorate_control.png", "decorate_control/decorate_control.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DecorateControlPanel.prototype.init = function () {\r\n        var w = this.scene.cameras.main.width;\r\n        var h = this.scene.cameras.main.height;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        this.mTopBtns = [];\r\n        this.mExitBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "exitBtn.png",\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mRecycleAllBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "recycleAllBtn.png",\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mRedoBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "redoBtn.png",\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mFurniBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "furniBtn.png",\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mSaveBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "saveBtn.png"\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mDoorBtn = this.scene.make.image({\r\n            x: 10 * this.dpr,\r\n            y: 83 * this.dpr,\r\n            key: this.key,\r\n            frame: "doorBtn.png",\r\n        }, false).setOrigin(0).setInteractive();\r\n        this.mStairBtn = this.scene.make.image({\r\n            x: 64 * this.dpr,\r\n            y: 83 * this.dpr,\r\n            key: this.key,\r\n            frame: "stairBtn.png"\r\n        }, false).setOrigin(0);\r\n        this.mTopBtns = [this.mExitBtn, this.mRecycleAllBtn, this.mRedoBtn, this.mFurniBtn, this.mSaveBtn];\r\n        this.add(this.mBackground);\r\n        this.add(this.mTopBtns);\r\n        this.add([this.mDoorBtn, this.mStairBtn]);\r\n        var zoom = this.mWorld.uiScale;\r\n        var totalWidth = w - 10 * 2 * this.dpr * zoom;\r\n        this.mTopBtns.map(function (btn) { return totalWidth -= btn.width * zoom; });\r\n        var space = totalWidth / (this.mTopBtns.length - 1) / zoom;\r\n        for (var i = 0; i < this.mTopBtns.length; i++) {\r\n            if (i > 0) {\r\n                this.mTopBtns[i].x = space + (this.mTopBtns[i - 1].width) + this.mTopBtns[i - 1].x;\r\n            }\r\n            else {\r\n                this.mTopBtns[i].x = 10 * this.dpr;\r\n            }\r\n            this.mTopBtns[i].y = 11 * this.dpr;\r\n        }\r\n        this.resize(w, h);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    DecorateControlPanel.prototype.onExitHandler = function () {\r\n        this.emit("exit");\r\n    };\r\n    DecorateControlPanel.prototype.onRecycleAllHandler = function () {\r\n        this.emit("recycleAll");\r\n    };\r\n    DecorateControlPanel.prototype.onRedoHandler = function () {\r\n        this.emit("redo");\r\n    };\r\n    DecorateControlPanel.prototype.onShowFurniHandler = function () {\r\n        this.emit("showFurni");\r\n    };\r\n    DecorateControlPanel.prototype.onSaveHandler = function () {\r\n        this.emit("save");\r\n    };\r\n    DecorateControlPanel.prototype.onGetDoorHandler = function () {\r\n        this.emit("getDoor");\r\n    };\r\n    return DecorateControlPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/DecorateControl/DecorateControlPanel.ts?')},"./src/ui/Dialog/Dialog.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialog", function() { return Dialog; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Dialog = /** @class */ (function (_super) {\r\n    __extends(Dialog, _super);\r\n    function Dialog(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Dialog.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n        }\r\n    };\r\n    Dialog.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Dialog.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Dialog.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Dialog.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Dialog.prototype.queryNextDialog = function (uiid, comid, data) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = packet.content;\r\n        content.uiId = uiid;\r\n        content.componentId = comid;\r\n        content.data = data;\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(Dialog.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Dialog;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Dialog/Dialog.ts?')},"./src/ui/Dialog/DialogMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogMediator", function() { return DialogMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _Dialog__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Dialog */ "./src/ui/Dialog/Dialog.ts");\n/* harmony import */ var _DialogPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogPanel */ "./src/ui/Dialog/DialogPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DialogMediator = /** @class */ (function (_super) {\r\n    __extends(DialogMediator, _super);\r\n    function DialogMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    DialogMediator.prototype.show = function (param) {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _DialogPanel__WEBPACK_IMPORTED_MODULE_2__["DialogPanel"](this.scene, this.world);\r\n            this.mView.on("querydialog", this.onQueryNextDialog, this);\r\n            this.mView.on("hide", this.onHideHandler, this);\r\n        }\r\n        if (!this.dialog) {\r\n            this.dialog = new _Dialog__WEBPACK_IMPORTED_MODULE_1__["Dialog"](this.world);\r\n            this.dialog.register();\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    DialogMediator.prototype.update = function (param) {\r\n        if (!this.mView || !this.mView.isShow) {\r\n            return;\r\n        }\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    DialogMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    DialogMediator.prototype.destroy = function () {\r\n        if (this.dialog) {\r\n            this.dialog.destroy();\r\n            this.dialog = undefined;\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    DialogMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.destroy();\r\n    };\r\n    DialogMediator.prototype.onQueryNextDialog = function (uiid, comid, data) {\r\n        this.dialog.queryNextDialog(uiid, comid, data);\r\n    };\r\n    DialogMediator.prototype.onHideHandler = function () {\r\n        this.hide();\r\n        this.destroy();\r\n    };\r\n    return DialogMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Dialog/DialogMediator.ts?')},"./src/ui/Dialog/DialogPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogPanel", function() { return DialogPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DialogPanel = /** @class */ (function (_super) {\r\n    __extends(DialogPanel, _super);\r\n    function DialogPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "commonkey";\r\n        _this.listItems = [];\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    DialogPanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var cheight = 177 * this.dpr;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.content.setPosition(width * 0.5, height - cheight / 2);\r\n        this.setSize(width, height);\r\n        this.blackBg.clear();\r\n        this.blackBg.fillStyle(0, 0.5);\r\n        this.blackBg.fillRect(0, 0, width, height);\r\n        this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        var frame = this.scene.textures.getFrame(this.key, "menu_bg_l");\r\n        var scaleRatio = width / frame.width * this.dpr;\r\n        this.bg.scaleX = scaleRatio * 1.5;\r\n        this.bg.x = 0;\r\n        this.bg.setInteractive();\r\n        this.bg.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n    };\r\n    DialogPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "common/ui_base.png", "common/ui_base.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DialogPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n        this.setDialogData(this.mShowData[0]);\r\n    };\r\n    DialogPanel.prototype.init = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var cheight = 177 * this.dpr;\r\n        this.blackBg = this.scene.make.graphics(undefined, false);\r\n        this.add(this.blackBg);\r\n        this.content = this.scene.make.container({ x: 0 * this.dpr, y: (height - cheight) / 2, width: width, height: cheight }, false);\r\n        this.content.setSize(width, cheight);\r\n        this.bg = this.scene.make.image({ x: 0, y: 0, key: this.key, frame: "menu_bg_l" });\r\n        this.bg.scaleY = this.scale;\r\n        this.bg.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n        this.bg.displayWidth = width;\r\n        this.bg.displayHeight = cheight;\r\n        var whiteGraphic = this.scene.make.graphics(undefined, false);\r\n        var graphicWidth = width - 30 * this.dpr;\r\n        var graphicHeight = 122 * this.dpr;\r\n        whiteGraphic.setPosition(-graphicWidth >> 1, -graphicHeight * 0.5 + 13 * this.dpr);\r\n        whiteGraphic.clear();\r\n        whiteGraphic.fillStyle(0xffffff, 1);\r\n        whiteGraphic.fillRoundedRect(0, 0, graphicWidth, graphicHeight, 8 * this.dpr);\r\n        this.text = this.scene.make.text({\r\n            x: -graphicWidth * 0.5 + 20 * this.dpr, y: -graphicHeight * 0.5 + 30 * this.dpr, text: "五七二五",\r\n            style: { color: "#000000", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT }\r\n        }).setOrigin(0).setWordWrapWidth(graphicWidth - 35 * this.dpr, true);\r\n        var iconPosx = -width * 0.5 + 38 * this.dpr;\r\n        var iconPosy = -cheight * 0.5 + 25 * this.dpr;\r\n        this.npcIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, iconPosx, iconPosy - 20 * this.dpr);\r\n        var nameBg = this.scene.make.image({ x: iconPosx + 135 * this.dpr, y: iconPosy, key: this.key, frame: "name_bg" });\r\n        this.npcName = this.scene.make.text({\r\n            x: nameBg.x, y: nameBg.y, text: "尼古拉斯.赵二",\r\n            style: { fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT }\r\n        }).setOrigin(0.5);\r\n        var closeBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_3__["Button"](this.scene, this.key, "close_1", "close_1");\r\n        closeBtn.setPosition(width * 0.5 - 30 * this.dpr, -cheight * 0.5 + 10 * this.dpr);\r\n        closeBtn.on("Tap", this.onCloseHandler, this);\r\n        closeBtn.visible = false;\r\n        this.content.add([this.bg, this.npcIcon, whiteGraphic, this.text, nameBg, this.npcName, closeBtn]);\r\n        this.bg.setInteractive();\r\n        this.bg.on("pointerdown", this.onNextDialogHandler, this);\r\n        this.add(this.content);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    DialogPanel.prototype.setLayoutItems = function (arr) {\r\n        var len = arr.length;\r\n        var scaleRadio = (len > 4 ? 2 : 1);\r\n        var height = 177 * this.dpr;\r\n        var width = 295 * this.dpr;\r\n        var cheight = 27 * this.dpr;\r\n        var cwidth = width / scaleRadio;\r\n        var offsetY = 4 * this.dpr;\r\n        if (len === 2)\r\n            offsetY = 15 * this.dpr;\r\n        else if (len === 3)\r\n            offsetY = 10 * this.dpr;\r\n        var posX = 0;\r\n        var posy = (124 * this.dpr - (offsetY + cheight) * (len < 4 ? len : 4) - offsetY) / 2 - 42 * this.dpr;\r\n        for (var _i = 0, _a = this.listItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            item.visible = false;\r\n        }\r\n        for (var i = 0; i < len; i++) {\r\n            var item = void 0;\r\n            if (i < this.listItems.length) {\r\n                item = this.listItems[i];\r\n            }\r\n            else {\r\n                item = new NpcDialogueItem(this.scene, this.dpr, this.scale, this.key);\r\n                this.content.add(item);\r\n                this.listItems.push(item);\r\n                item.setHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_4__["Handler"](this, this.onItemHandler));\r\n            }\r\n            var x = (width - cwidth) * 0.5 * (i < 4 ? -1 : 1);\r\n            var y = posy + cheight * 0.5 + (cheight + offsetY) * (i % 4);\r\n            item.setItemSize(cwidth, cheight);\r\n            item.setPosition(x, y);\r\n            item.setItemData(arr[i]);\r\n            item.visible = true;\r\n        }\r\n    };\r\n    DialogPanel.prototype.setDialogData = function (data) {\r\n        var _this = this;\r\n        if (data.text && data.text[1])\r\n            this.npcName.text = data.text[1].text;\r\n        if (data.display && data.display[0]) {\r\n            this.npcIcon.visible = true;\r\n            var display_1 = data.display[0];\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_6__["Url"].getOsdRes(display_1.texturePath);\r\n            this.npcIcon.load(url, this, function () {\r\n                var width = _this.content.width;\r\n                var height = _this.content.height;\r\n                var iconWidth = _this.npcIcon.width;\r\n                var iconHeight = _this.npcIcon.height;\r\n                var x = _this.npcIcon.x;\r\n                var y = -height * 0.5 - 50 * _this.dpr;\r\n                if (display_1.horizontal === pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__["op_def"].HorizontalAlignment.HORIZONTAL_LEFT) {\r\n                    x = -width * 0.5 + iconWidth * 0.5; // + 20 * this.dpr;\r\n                }\r\n                else if (display_1.horizontal === pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__["op_def"].HorizontalAlignment.HORIZONTAL_CENTER) {\r\n                    x = 0;\r\n                }\r\n                else if (display_1.horizontal === pixelpai_proto__WEBPACK_IMPORTED_MODULE_5__["op_def"].HorizontalAlignment.HORIZONTAL_RIGHT) {\r\n                    x = width * 0.5 - iconWidth * 0.5 - 20 * _this.dpr;\r\n                }\r\n                _this.npcIcon.displayWidth = 212 * _this.dpr;\r\n                _this.npcIcon.scaleY = _this.npcIcon.scaleX;\r\n                _this.npcIcon.x = x;\r\n                _this.npcIcon.y = y;\r\n            });\r\n        }\r\n        else {\r\n            this.npcIcon.visible = false;\r\n        }\r\n        if (data.button && data.button.length > 0) {\r\n            this.setLayoutItems(data.button);\r\n            this.text.visible = false;\r\n        }\r\n        else {\r\n            for (var _i = 0, _a = this.listItems; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                item.visible = false;\r\n            }\r\n            this.text.text = data.text[0].text;\r\n            this.text.visible = true;\r\n        }\r\n    };\r\n    DialogPanel.prototype.update = function (param) {\r\n        this.mShowData = param;\r\n        this.setDialogData(param[0]);\r\n    };\r\n    DialogPanel.prototype.onItemHandler = function (item) {\r\n        for (var _i = 0, _a = this.listItems; _i < _a.length; _i++) {\r\n            var temp = _a[_i];\r\n            temp.select = false;\r\n        }\r\n        item.select = true;\r\n        var data = this.showData[0];\r\n        this.emit("querydialog", data.id, item.itemData.node.id);\r\n    };\r\n    DialogPanel.prototype.onNextDialogHandler = function () {\r\n        var data = this.showData[0];\r\n        this.emit("querydialog", data.id, 0);\r\n    };\r\n    DialogPanel.prototype.onCloseHandler = function () {\r\n        this.emit("hide");\r\n    };\r\n    return DialogPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar NpcDialogueItem = /** @class */ (function (_super) {\r\n    __extends(NpcDialogueItem, _super);\r\n    function NpcDialogueItem(scene, dpr, zoom, key) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = 0;\r\n        _this.zoom = 0;\r\n        _this.zoom = zoom;\r\n        _this.dpr = dpr;\r\n        _this.selectBg = _this.scene.make.image({ x: 0, y: 0, key: key, frame: "select_bg" });\r\n        _this.arrImg = _this.scene.make.image({ x: -_this.selectBg.width * 0.5, y: 0, key: key, frame: "arrow_r" });\r\n        _this.content = _this.scene.make.text({\r\n            x: 0, y: 0, text: "购买物品",\r\n            style: { color: "#000000", fontSize: 15 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT }\r\n        }).setOrigin(0, 0.5);\r\n        _this.add([_this.selectBg, _this.arrImg, _this.content]);\r\n        _this.width = _this.selectBg.width;\r\n        _this.height = _this.selectBg.height;\r\n        _this.on("pointerdown", _this.onClickHandler, _this);\r\n        return _this;\r\n    }\r\n    NpcDialogueItem.prototype.setItemData = function (data) {\r\n        this.itemData = data;\r\n        this.content.text = data.text;\r\n        this.select = false;\r\n    };\r\n    NpcDialogueItem.prototype.setHandler = function (handler) {\r\n        this.handler = handler;\r\n    };\r\n    Object.defineProperty(NpcDialogueItem.prototype, "select", {\r\n        set: function (value) {\r\n            this.selectBg.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NpcDialogueItem.prototype.setItemSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.selectBg.displayWidth = width;\r\n        this.arrImg.x = -width * 0.5 * 0.9;\r\n        this.content.x = this.arrImg.x + 20 * this.dpr * this.zoom;\r\n        // this.removeInteractive();\r\n        this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    NpcDialogueItem.prototype.onClickHandler = function () {\r\n        if (this.handler)\r\n            this.handler.runWith(this);\r\n    };\r\n    return NpcDialogueItem;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Dialog/DialogPanel.ts?')},"./src/ui/ElementStorage/DragManager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragManager", function() { return DragManager; });\nvar DragManager = /** @class */ (function () {\r\n    function DragManager(scene) {\r\n        // this.mImage = scene.make.image()\r\n    }\r\n    DragManager.prototype.setDragProp = function (prop) {\r\n    };\r\n    return DragManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/DragManager.ts?')},"./src/ui/ElementStorage/ElementStorageMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorageMediator", function() { return ElementStorageMediator; });\n/* harmony import */ var _ElementStoragePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ElementStoragePanel */ "./src/ui/ElementStorage/ElementStoragePanel.ts");\n/* harmony import */ var _ElementStorate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ElementStorate */ "./src/ui/ElementStorage/ElementStorate.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ElementStorageMediator = /** @class */ (function (_super) {\r\n    __extends(ElementStorageMediator, _super);\r\n    function ElementStorageMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mStorage = new _ElementStorate__WEBPACK_IMPORTED_MODULE_1__["ElementStorage"](world);\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.register();\r\n        return _this;\r\n    }\r\n    ElementStorageMediator.prototype.show = function (param) {\r\n        this.mParam = param;\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        this.mView = new _ElementStoragePanel__WEBPACK_IMPORTED_MODULE_0__["ElementStoragePanel"](this.mScene, this.world);\r\n        this.mStorage.register();\r\n        this.mStorage.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_MODE_QUERY_PACKAGE, this.onEditModeQueryPackageHandler, this);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.mView.on("queryElement", this.onQueryElementHandler, this);\r\n        this.mView.on("selectedElement", this.onSelectedElement, this);\r\n        this.mView.show(param);\r\n    };\r\n    ElementStorageMediator.prototype.hide = function () {\r\n        this.mParam = undefined;\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ElementStorageMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    /**\r\n     * 展开\r\n     */\r\n    ElementStorageMediator.prototype.expand = function () {\r\n        var view = this.getView();\r\n        if (view) {\r\n            view.expand();\r\n        }\r\n    };\r\n    /**\r\n     * 收起\r\n     */\r\n    ElementStorageMediator.prototype.collapse = function () {\r\n        var view = this.getView();\r\n        if (view) {\r\n            view.collapse();\r\n        }\r\n    };\r\n    ElementStorageMediator.prototype.destroy = function () {\r\n        this.unregister();\r\n        if (this.mStorage) {\r\n            this.mStorage.unregister();\r\n            this.mStorage = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ElementStorageMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    ElementStorageMediator.prototype.onQueryElementHandler = function (page, perPage) {\r\n        if (this.mParam) {\r\n            this.mStorage.queryMarketPackage(page, perPage);\r\n            return;\r\n        }\r\n        this.mStorage.queryPackage(page, perPage);\r\n    };\r\n    ElementStorageMediator.prototype.register = function () {\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_EXPANED, this.onExpanedHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_COLLAPSE, this.onCollapseHandler, this);\r\n    };\r\n    ElementStorageMediator.prototype.unregister = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_EXPANED, this.onExpanedHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_PACKAGE_COLLAPSE, this.onCollapseHandler, this);\r\n    };\r\n    ElementStorageMediator.prototype.onEditModeQueryPackageHandler = function (items) {\r\n        if (!items) {\r\n            return;\r\n        }\r\n        this.getView().setProps(items);\r\n    };\r\n    ElementStorageMediator.prototype.onSelectedElement = function (prop) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SELECTED_SPRITE);\r\n        var content = packet.content;\r\n        content.id = prop.id;\r\n        this.world.connection.send(packet);\r\n    };\r\n    ElementStorageMediator.prototype.onExpanedHandler = function () {\r\n        this.expand();\r\n    };\r\n    ElementStorageMediator.prototype.onCollapseHandler = function () {\r\n        this.collapse();\r\n    };\r\n    ElementStorageMediator.NAME = "ElementStorageMediator";\r\n    return ElementStorageMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_5__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStorageMediator.ts?')},"./src/ui/ElementStorage/ElementStoragePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStoragePanel", function() { return ElementStoragePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _item_Item__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./item/Item */ "./src/ui/ElementStorage/item/Item.ts");\n/* harmony import */ var _ElementStorageMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ElementStorageMediator */ "./src/ui/ElementStorage/ElementStorageMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ElementStoragePanel = /** @class */ (function (_super) {\r\n    __extends(ElementStoragePanel, _super);\r\n    function ElementStoragePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mExpaned = true;\r\n        _this.mItemNum = 32;\r\n        _this.setTween(false);\r\n        _this.dpr /= 2;\r\n        return _this;\r\n    }\r\n    ElementStoragePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized) {\r\n            this.setPackageNum(1);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.resize = function (oriention) {\r\n        var size = this.mWorld.getSize();\r\n        this.scale = this.dpr;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.setSize(683 >> 1, 901 >> 1);\r\n            this.x = size.width - (this.width * this.dpr) - 10;\r\n            this.y = size.height - this.height * this.dpr >> 1;\r\n            this.mBackground.resize(this.width, this.height);\r\n            this.mBackground.x = this.mBackground.width >> 1;\r\n            this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBorder.resize(655 >> 1, 847 >> 1);\r\n            this.mBorder.x = 7 + (this.mBorder.width >> 1);\r\n            this.mBorder.y = 19 + (this.mBorder.height >> 1);\r\n            this.mSearchInput.x = 40 + 105;\r\n            this.mSearchInput.y = 40;\r\n            this.mDragBtn.x = -this.mDragBtn.height;\r\n            this.mDragBtn.y = this.height >> 1;\r\n            // for (let i = 0; i < this.mTabs.length; i++) {\r\n            //     this.mTabs[i].x = 280;\r\n            //     this.mTabs[i].y = 60 + i * this.mTabs[i].height + 10;\r\n            // }\r\n            var len = this.mProps.length;\r\n            for (var i = 0; i < len; i++) {\r\n                // this.mProps[i].setPosition((i % 8) * 60 + 20, Math.ceil(i / 8) * 60 + 80);\r\n                this.mProps[i].x = (i % 4) * 60 + 20;\r\n                this.mProps[i].y = Math.floor(i / 4) * 60 + 80;\r\n            }\r\n        }\r\n        else {\r\n            this.setSize(510, 329);\r\n            // this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width, this.height));\r\n            // this.scale = this.mWorld.uiScale;\r\n            this.mBackground.resize(this.width, this.height);\r\n            this.mBackground.x = this.mBackground.width >> 1;\r\n            this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBorder.resize(496, 303);\r\n            this.mBorder.x = 7 + (this.mBorder.width >> 1);\r\n            this.mBorder.y = 19 + (this.mBorder.height >> 1);\r\n            this.mSearchInput.x = 270;\r\n            this.mSearchInput.y = 33;\r\n            this.x = (size.width - this.width * this.dpr >> 1);\r\n            this.y = size.height - this.height * this.dpr - 10;\r\n            this.mDragBtn.x = this.width >> 1;\r\n            this.mDragBtn.y = -this.mDragBtn.height >> 1;\r\n            // for (let i = 0; i < this.mTabs.length; i++) {\r\n            //     this.mTabs[i].x = 24 + i * this.mTabs[i].width + 10;\r\n            //     this.mTabs[i].y = 33;\r\n            // }\r\n            var len = this.mProps.length;\r\n            for (var i = 0; i < len; i++) {\r\n                // this.mProps[i].setPosition((i % 8) * 60 + 20, Math.ceil(i / 8) * 60 + 80);\r\n                this.mProps[i].x = (i % 8) * 60 + 20;\r\n                this.mProps[i].y = Math.floor(i / 8) * 60 + 80;\r\n            }\r\n        }\r\n        this.mPrePageBtn.y = this.height >> 1;\r\n        this.mNextPageBtn.x = this.width;\r\n        this.mNextPageBtn.y = this.height >> 1;\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width, this.height), Phaser.Geom.Rectangle.Contains);\r\n        // this.setScale(this.mWorld.uiScale, this.mWorld.uiScale);\r\n        // this.scaleX = this.scaleY = 5;\r\n    };\r\n    ElementStoragePanel.prototype.addListen = function () {\r\n        _super.prototype.addListen.call(this);\r\n        if (this.mBackground)\r\n            this.mBackground.on("pointerout", this.onPointerOutHandler, this);\r\n        if (this.mDragBtn)\r\n            this.mDragBtn.on("pointerup", this.switchExpand, this);\r\n        if (this.mPrePageBtn)\r\n            this.mPrePageBtn.on("pointerup", this.onPrePageHandler, this);\r\n        if (this.mNextPageBtn)\r\n            this.mNextPageBtn.on("pointerup", this.onNextPageHandler, this);\r\n        if (this.mCloseBtn)\r\n            this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n        if (this.scene) {\r\n            this.scene.input.on("dragstart", this.onDragStartHandler, this);\r\n            this.scene.input.on("dragend", this.onDragEndHandler, this);\r\n            this.scene.input.on("drag", this.onDragHandler, this);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.removeListen = function () {\r\n        _super.prototype.removeListen.call(this);\r\n        if (this.mBackground)\r\n            this.mBackground.off("pointerout", this.onPointerOutHandler, this);\r\n        if (this.mDragBtn)\r\n            this.mDragBtn.off("pointerup", this.switchExpand, this);\r\n        if (this.mPrePageBtn)\r\n            this.mPrePageBtn.off("pointerup", this.onPrePageHandler, this);\r\n        if (this.mNextPageBtn)\r\n            this.mNextPageBtn.off("pointerup", this.onNextPageHandler, this);\r\n        if (this.mCloseBtn)\r\n            this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n        if (this.scene) {\r\n            this.scene.input.off("dragstart", this.onDragStartHandler, this);\r\n            this.scene.input.off("dragend", this.onDragEndHandler, this);\r\n            this.scene.input.off("drag", this.onDragHandler, this);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.setProps = function (data) {\r\n        var items = data.items;\r\n        this.clearItem();\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (i >= this.mProps.length) {\r\n                return;\r\n            }\r\n            this.mProps[i].setProp(items[i]);\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.expand = function () {\r\n        if (this.mExpaned) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        var props = null;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            props = { x: size.width - (this.width * this.dpr) - 10 };\r\n        }\r\n        else {\r\n            props = { y: size.height - this.height * this.dpr - 10 };\r\n        }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: props\r\n        });\r\n        this.remove(this.mDragBtn);\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn]);\r\n        this.mExpaned = true;\r\n    };\r\n    ElementStoragePanel.prototype.collapse = function () {\r\n        if (!this.mExpaned) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        var props = null;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            props = { x: size.width };\r\n        }\r\n        else {\r\n            props = { y: size.height };\r\n        }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: props\r\n        });\r\n        this.addAt(this.mDragBtn, 0);\r\n        this.remove([this.mPrePageBtn, this.mNextPageBtn]);\r\n        this.mExpaned = false;\r\n    };\r\n    ElementStoragePanel.prototype.destroy = function () {\r\n        if (this.scene) {\r\n            this.scene.input.off("dragstart", this.onDragStartHandler, this);\r\n            this.scene.input.off("dragend", this.onDragEndHandler, this);\r\n            this.scene.input.off("drag", this.onDragHandler, this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ElementStoragePanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.scene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/button.png"));\r\n        this.scene.load.image("prop_background", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/prop_background.png"));\r\n        this.scene.load.atlas("slip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.json"));\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ElementStoragePanel.prototype.init = function () {\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 0, 0, this.width, this.height, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getConfig());\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 7, 19, 655 >> 1, 847 >> 1, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        // this.mBackground.setInteractive();\r\n        // TODO 多语言配置\r\n        this.mSearchInput = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, 40 + 105, 40, 210, 26, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080",\r\n            placeholder: "输入关键词进行搜索"\r\n        });\r\n        var config = {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n        this.mDragBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__["NinePatchButton"](this.scene, 0, -20, 80, 40, "button", "", "物件容器", config);\r\n        // this.mTabs = [];\r\n        // const button = new NinePatchButton(this.scene, 280, 40, 60, 30, "button", "地块",  config);\r\n        // const button2 = new NinePatchButton(this.scene, 280, 80, 60, 30, "button", "物件",  config);\r\n        // const checkbox = new CheckboxGroup().appendItemAll([button, button2]);\r\n        // checkbox.on("selected", this.onSelectedHandler, this);\r\n        // this.mTabs.push(button);\r\n        // this.mTabs.push(button2);\r\n        this.mPrePageBtn = this.scene.make.sprite({\r\n            key: "slip"\r\n        }, false);\r\n        this.mPrePageBtn.setInteractive();\r\n        this.mNextPageBtn = this.scene.make.sprite({\r\n            key: "slip"\r\n        }, false).setFlipX(true);\r\n        this.mNextPageBtn.setInteractive();\r\n        this.mProps = [];\r\n        this.add([this.mBackground, this.mBorder, this.mSearchInput]);\r\n        for (var i = 0; i < this.mItemNum; i++) {\r\n            var item = new _item_Item__WEBPACK_IMPORTED_MODULE_5__["Item"](this.scene);\r\n            // this.add(item);\r\n            // this.scene.input.setDraggable(item);\r\n            // item.on("click", this.onClick, this);\r\n            this.mProps[i] = item;\r\n        }\r\n        this.add(this.mProps);\r\n        this.add([this.mPrePageBtn, this.mNextPageBtn]);\r\n        // this.mCloseBtn = new IconBtn(this.mScene, this.mWorld, {\r\n        //     key: UIMediatorType.Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n        //     iconResKey: "", iconTexture: "", scale: 1, pngUrl: this.mResPng, jsonUrl: this.mResJson\r\n        // });\r\n        this.mCloseBtn = this.scene.make.image({\r\n            key: "clsBtn",\r\n            frame: "btn_normal"\r\n        }, false).setInteractive().setScale(2);\r\n        this.add(this.mCloseBtn);\r\n        _super.prototype.init.call(this);\r\n        this.resize();\r\n        this.expand();\r\n    };\r\n    ElementStoragePanel.prototype.onPrePageHandler = function () {\r\n        this.setPackageNum(this.mPacgeNum - 1);\r\n    };\r\n    ElementStoragePanel.prototype.onNextPageHandler = function () {\r\n        this.setPackageNum(this.mPacgeNum + 1);\r\n    };\r\n    ElementStoragePanel.prototype.setPackageNum = function (val) {\r\n        this.mPacgeNum = val < 1 ? 1 : val;\r\n        this.emit("queryElement", this.mPacgeNum, 32);\r\n    };\r\n    ElementStoragePanel.prototype.switchExpand = function () {\r\n        this.mExpaned ? this.collapse() : this.expand();\r\n    };\r\n    ElementStoragePanel.prototype.onSelectedHandler = function () {\r\n    };\r\n    ElementStoragePanel.prototype.onClick = function (data) {\r\n        // this.emit("selectedElement", data);\r\n    };\r\n    ElementStoragePanel.prototype.onDragStartHandler = function (pointer, gameobject, dragX, dragY) {\r\n        var item = gameobject.parentContainer;\r\n        if (item instanceof _item_Item__WEBPACK_IMPORTED_MODULE_5__["Item"]) {\r\n            // this.emit("selectedElement", item.prop);\r\n            // gameobject.x = dragX;\r\n            // gameobject.y = dragX;\r\n            this.mDragData = item.prop;\r\n        }\r\n        if (!this.mDragImage) {\r\n            this.mDragImage = this.scene.make.image(undefined, false);\r\n            this.add(this.mDragImage);\r\n        }\r\n        this.mDragImage.x = item.x;\r\n        this.mDragImage.y = item.y;\r\n        this.mDragImage.setTexture(gameobject.texture.key);\r\n        this.mDragging = true;\r\n        // this.mDragImage.texture = gameobject.texture;\r\n        // Logger.getInstance().log("======", pointer, gameobject);\r\n    };\r\n    ElementStoragePanel.prototype.onDragEndHandler = function () {\r\n        if (!this.mDragImage) {\r\n            return;\r\n        }\r\n        this.mDragImage.setTexture(undefined);\r\n        this.mDragging = false;\r\n    };\r\n    ElementStoragePanel.prototype.onDragHandler = function (pointer, gameobject, dragX, dragY) {\r\n        if (!this.mDragImage) {\r\n            return;\r\n        }\r\n        this.mDragImage.x += pointer.x - pointer.prevPosition.x;\r\n        this.mDragImage.y += pointer.y - pointer.prevPosition.y;\r\n    };\r\n    ElementStoragePanel.prototype.onPointerOutHandler = function () {\r\n        if (this.mDragImage && this.mDragging) {\r\n            this.emit("selectedElement", this.mDragData);\r\n            this.mDragImage.setTexture(undefined);\r\n            this.mDragging = false;\r\n        }\r\n    };\r\n    ElementStoragePanel.prototype.clearItem = function () {\r\n        if (!this.mProps)\r\n            return;\r\n        this.mProps.map(function (item) { return item.clear(); });\r\n    };\r\n    ElementStoragePanel.prototype.onCloseHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_6__["ElementStorageMediator"].name);\r\n        if (med)\r\n            med.hide();\r\n    };\r\n    return ElementStoragePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStoragePanel.ts?')},"./src/ui/ElementStorage/ElementStorate.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementStorage", function() { return ElementStorage; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ElementStorage = /** @class */ (function (_super) {\r\n    __extends(ElementStorage, _super);\r\n    function ElementStorage($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.event = new Phaser.Events.EventEmitter();\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_QUERY_EDIT_PACKAGE, _this.onQueryEditPackageResuleHandler);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE, _this.onQueryMarketPacketResuleHandler);\r\n        return _this;\r\n    }\r\n    ElementStorage.prototype.register = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        this.world.connection.addPacketListener(this);\r\n    };\r\n    ElementStorage.prototype.unregister = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        this.world.connection.removePacketListener(this);\r\n        this.event.removeAllListeners();\r\n    };\r\n    ElementStorage.prototype.on = function (event, fn, context) {\r\n        this.event.on(event, fn, context);\r\n    };\r\n    ElementStorage.prototype.off = function (event, fn, context) {\r\n        this.event.off(event, fn, context);\r\n    };\r\n    /**\r\n     * 请求编辑背包\r\n     */\r\n    ElementStorage.prototype.queryPackage = function (page, perPage, nodeType, queryString) {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        // const packet = new PBpacket(op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_QUERY_EDIT_PACKAGE);\r\n        // const content: op_virtual_world.IOP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_QUERY_EDIT_PACKAGE = packet.content;\r\n        // content.page = page;\r\n        // content.perPage = perPage;\r\n        // content.nodeType = nodeType;\r\n        // content.queryString = queryString;\r\n        // this.world.connection.send(packet);\r\n    };\r\n    ElementStorage.prototype.queryMarketPackage = function (page, perPage, nodeType, queryString) {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        // const packet = new PBpacket(op_virtual_world.OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE);\r\n        // const content: op_virtual_world.IOP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE = packet.content;\r\n        // content.page = page;\r\n        // content.perPage = perPage;\r\n        // content.nodeType = nodeType;\r\n        // content.queryString = queryString;\r\n        // this.world.connection.send(packet);\r\n    };\r\n    ElementStorage.prototype.destroy = function () {\r\n        this.unregister();\r\n    };\r\n    ElementStorage.prototype.onQueryEditPackageResuleHandler = function (packet) {\r\n        this.event.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_MODE_QUERY_PACKAGE, packet.content);\r\n    };\r\n    ElementStorage.prototype.onQueryMarketPacketResuleHandler = function (packet) {\r\n        this.event.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].EDIT_MODE_QUERY_PACKAGE, packet.content);\r\n    };\r\n    return ElementStorage;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/ElementStorate.ts?')},"./src/ui/ElementStorage/item/Item.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Item", function() { return Item; });\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Item = /** @class */ (function (_super) {\r\n    __extends(Item, _super);\r\n    function Item(scene) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var background = scene.make.image({\r\n            key: "prop_background"\r\n        }).setOrigin(0, 0);\r\n        _this.setSize(background.width, background.height);\r\n        _this.add(background);\r\n        _this.mImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"](_this.scene, 0, 0).setOrigin(0, 0);\r\n        _this.add(_this.mImage);\r\n        _this.mCount = scene.make.text(undefined, false);\r\n        _this.mCount.setAlign("right");\r\n        _this.mCount.y = _this.height - 20;\r\n        _this.add(_this.mCount);\r\n        return _this;\r\n    }\r\n    Item.prototype.setProp = function (prop) {\r\n        var _this = this;\r\n        this.mProp = prop;\r\n        if (!this.mCount) {\r\n            return;\r\n        }\r\n        if (prop) {\r\n            this.mImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(prop.display.texturePath), this, function () {\r\n                // this.mImage.on("dragstart", this.onPointerUpHandler, this);\r\n                _this.mImage.setInteractive();\r\n                _this.scene.input.setDraggable(_this.mImage);\r\n                var imageScale = 1;\r\n                if (_this.mImage.width > _this.width) {\r\n                    imageScale = _this.width / _this.mImage.width;\r\n                }\r\n                if (_this.mImage.height > _this.height) {\r\n                    imageScale = _this.height / _this.mImage.height;\r\n                }\r\n                _this.mImage.scale = imageScale;\r\n            });\r\n            this.mCount.setText(prop.count > 1 ? prop.count.toString() : "");\r\n            this.mCount.x = this.width - this.mCount.width;\r\n        }\r\n    };\r\n    Item.prototype.clear = function () {\r\n        if (!this.count) {\r\n            return;\r\n        }\r\n        if (!this.mProp) {\r\n            return;\r\n        }\r\n        this.mCount.setText("");\r\n        this.mImage.setTexture(undefined);\r\n        this.mImage.off("pointerup", this.onPointerUpHandler, this);\r\n        this.mProp = undefined;\r\n    };\r\n    Item.prototype.destroy = function () {\r\n        this.clear();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(Item.prototype, "prop", {\r\n        get: function () {\r\n            return this.mProp;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Item.prototype.onPointerUpHandler = function () {\r\n        this.emit("click", this.mProp);\r\n    };\r\n    return Item;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ElementStorage/item/Item.ts?')},"./src/ui/EquipUpgrade/EquipUpgrade.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EquipUpgrade", function() { return EquipUpgrade; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar EquipUpgrade = /** @class */ (function (_super) {\r\n    __extends(EquipUpgrade, _super);\r\n    function EquipUpgrade(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    EquipUpgrade.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MINING_MODE_ACTIVE_EQUIPMENT, this.onActiveEquipmend);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MINING_MODE_SHOW_SELECT_EQUIPMENT_PANEL, this.openEquipUpgrade);\r\n        }\r\n    };\r\n    EquipUpgrade.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    EquipUpgrade.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    EquipUpgrade.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    EquipUpgrade.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(EquipUpgrade.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    EquipUpgrade.prototype.reqEquipedEquipment = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_MINING_MODE_EQUIP_EQUIPMENT);\r\n        var content = packet.content;\r\n        content.equipmentId = id;\r\n        this.connection.send(packet);\r\n    };\r\n    EquipUpgrade.prototype.reqActiveEquipment = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_RES_VIRTUAL_WORLD_MINING_MODE_ACTIVE_EQUIPMENT);\r\n        var content = packet.content;\r\n        content.equipmentId = id;\r\n        this.connection.send(packet);\r\n    };\r\n    EquipUpgrade.prototype.onActiveEquipmend = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("activeEquip", content.mineEquipment);\r\n    };\r\n    EquipUpgrade.prototype.openEquipUpgrade = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("showopen", content);\r\n    };\r\n    return EquipUpgrade;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/EquipUpgrade/EquipUpgrade.ts?')},"./src/ui/EquipUpgrade/EquipUpgradeItem.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EquipUpgradeItem", function() { return EquipUpgradeItem; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EquipUpgradeItem = /** @class */ (function (_super) {\r\n    __extends(EquipUpgradeItem, _super);\r\n    function EquipUpgradeItem(scene, container, dpr, zoom, key, commonKey) {\r\n        var _this = _super.call(this) || this;\r\n        _this.haveEquiped = false;\r\n        _this.cellWidth = 0;\r\n        _this.cellHeight = 0;\r\n        _this.dpr = dpr;\r\n        _this.zoom = zoom;\r\n        _this.key = key;\r\n        _this.commonKey = commonKey;\r\n        _this.mScene = scene;\r\n        _this.mContainer = container;\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    EquipUpgradeItem.prototype.setEquipItems = function (data) {\r\n        var name = data.equipmentType;\r\n        var items = data.mineEquipments;\r\n        this.titleName.text = name;\r\n        var index = 0;\r\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n            var item = items_1[_i];\r\n            if (item.selected) {\r\n                this.haveEquiped = true;\r\n                break;\r\n            }\r\n            index++;\r\n        }\r\n        this.gridTable.setItems(items);\r\n        if (this.haveEquiped)\r\n            // this.gridTable.setT((index + 1) / items.length);\r\n            this.setBgTexture(data["isblue"]);\r\n    };\r\n    EquipUpgradeItem.prototype.setTransPosition = function (x, y) {\r\n        // const w = this.mScene.cameras.main.width, h = this.mScene.cameras.main.height;\r\n        // const posX = w * 0.5 + this.mContainer.x * this.zoom;\r\n        // const posY = h * 0.5 + this.mContainer.y * this.zoom - 20 * this.dpr;\r\n        //  -posX + this.cellWidth / 2 * this.zoom, -posY);\r\n        this.bg.x += x;\r\n        this.bg.y += y;\r\n        this.titleName.x += x;\r\n        this.titleName.y += y;\r\n        this.bottombg.x += x;\r\n        this.bottombg.y += y;\r\n        this.equipName.x += x;\r\n        this.equipName.y += y;\r\n        this.penetrationText.x += x;\r\n        this.penetrationText.y += y;\r\n        this.equipDes.x += x;\r\n        this.equipDes.y += y;\r\n        this.topbg.x += x;\r\n        this.topbg.y += y;\r\n        this.unlockbtn.x += x;\r\n        this.unlockbtn.y += y;\r\n        // this.costNum.x += x;\r\n        // this.costNum.y += y;\r\n        // this.diamondIcon.x += x;\r\n        // this.diamondIcon.y += y;\r\n        this.curEquipItem.x += x;\r\n        this.curEquipItem.y += y;\r\n        this.gridTable.refreshPos(x, y - 10 * this.dpr * this.zoom);\r\n        this.gridTable.resetMask();\r\n        // this.gridTable.x = posX;\r\n        // this.gridTable.y = posY;\r\n        // this.gridTable.layout();\r\n        // this.mScrollContainer.setPosition(-this.gridTable.x + this.cellWidth / 2 * this.zoom, -this.gridTable.y);\r\n    };\r\n    Object.defineProperty(EquipUpgradeItem.prototype, "displayList", {\r\n        get: function () {\r\n            return [this.bg, this.topbg, this.bottombg, this.titleName, this.equipName, this.penetrationText, this.equipDes];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    EquipUpgradeItem.prototype.refreshEquipData = function (data, index) {\r\n        this.gridTable.items[index] = data;\r\n        this.gridTable.refresh();\r\n        // this.gridTable.setT((index + 1) / this.gridTable.items.length);\r\n        this.updateEquipItem(this.curEquipItem);\r\n    };\r\n    EquipUpgradeItem.prototype.destroy = function () {\r\n        if (this.unlockbtn)\r\n            this.unlockbtn.off("pointerup", this.onUnlockEquipHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n        if (this.gridTable)\r\n            this.gridTable.destroy();\r\n        this.bg = null;\r\n        this.topbg = null;\r\n        this.bottombg = null;\r\n        this.gridTable = null;\r\n        this.titleName = null;\r\n        this.equipName = null;\r\n        this.penetrationText = null;\r\n        this.equipDes = null;\r\n        this.unlockbtn = null;\r\n        this.costNum = null;\r\n        this.diamondIcon = null;\r\n        this.curEquipItem = null;\r\n    };\r\n    EquipUpgradeItem.prototype.setBgTexture = function (isblue) {\r\n        var topName = !isblue ? "topbg" : "topbg1";\r\n        var bottombg = !isblue ? "bottombg" : "bottombg1";\r\n        var fontColor = !isblue ? "#8F4300" : "#0867AE";\r\n        this.topbg.setTexture(this.key, topName);\r\n        this.bottombg.setTexture(this.key, bottombg);\r\n        this.titleName.setColor(fontColor).setStroke(fontColor, 1);\r\n        this.equipName.setColor(fontColor).setStroke(fontColor, 1);\r\n        this.penetrationText.setColor(fontColor).setStroke(fontColor, 1);\r\n    };\r\n    EquipUpgradeItem.prototype.create = function () {\r\n        this.bg = this.mScene.make.image({ x: 0, y: -21 * this.dpr, key: this.key, frame: "bg1" });\r\n        this.topbg = this.mScene.make.image({ x: 0, y: -61 * this.dpr, key: this.key, frame: "topbg" });\r\n        this.titleName = this.mScene.make.text({ x: 0, y: this.topbg.y + 0 * this.dpr, text: "矿镐", style: { blod: true, color: "#8F4300", fontSize: 14 * this.dpr, font: this.getBoldFont(14 * this.dpr) } }).setOrigin(0.5, 0.5);\r\n        this.bottombg = this.mScene.make.image({ x: 0, y: 42 * this.dpr, key: this.key, frame: "bottombg" });\r\n        this.equipName = this.mScene.make.text({ x: -120 * this.dpr, y: 15 * this.dpr, text: "精铁镐", style: { color: "#8F4300", fontSize: 14 * this.dpr, font: this.getBoldFont(14 * this.dpr) } });\r\n        this.penetrationText = this.mScene.make.text({ x: -60 * this.dpr, y: 16 * this.dpr, text: "穿透力:10", style: { color: "#8F4300", fontSize: 12 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT } });\r\n        this.equipDes = this.mScene.make.text({ x: -120 * this.dpr, y: 35 * this.dpr, text: "描述文字", style: { color: "#000000", fontSize: 10 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT, wordWrap: { width: 130 * this.dpr, useAdvancedWrap: true } } });\r\n        this.equipDes.setStroke("#000000", 1);\r\n        this.mContainer.add([this.bg, this.topbg, this.bottombg, this.titleName, this.equipName, this.penetrationText, this.equipDes]);\r\n        this.createGridTable();\r\n        this.createBtn();\r\n    };\r\n    EquipUpgradeItem.prototype.createGridTable = function () {\r\n        var _this = this;\r\n        // this.mScrollContainer = this.mScene.make.container(undefined, false);\r\n        // this.mScrollContainer.setPosition(0, 0);\r\n        var propFrame = this.mScene.textures.getFrame(this.key, "equipbg");\r\n        var capW = (propFrame.width + 10 * this.dpr * this.zoom);\r\n        var capH = (propFrame.height + 30 * this.dpr * this.zoom);\r\n        this.cellWidth = capW;\r\n        this.cellHeight = capH;\r\n        var config = {\r\n            scrollMode: 1,\r\n            // background: (<any>this.mScene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFFFFF, .5),\r\n            table: {\r\n                width: 259 * this.dpr * this.zoom,\r\n                height: 77 * this.dpr * this.zoom,\r\n                columns: 1,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0\r\n            },\r\n            clamplChildOY: false,\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                var index = cell.index;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new EquipItemCell(scene, _this.dpr, _this.key, _this.zoom);\r\n                    cellContainer.setSize(capW, capH);\r\n                    _this.mContainer.add(cellContainer);\r\n                    cellContainer.setChildPosition();\r\n                }\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setItemData(item, index);\r\n                if (_this.curEquipItem == null) {\r\n                    if (_this.haveEquiped) {\r\n                        if (item.selected)\r\n                            _this.onSelectItemHandler(cellContainer);\r\n                    }\r\n                    else {\r\n                        _this.onSelectItemHandler(cellContainer);\r\n                    }\r\n                }\r\n                // Logger.getInstance().log(item);\r\n                return cellContainer;\r\n            }\r\n        };\r\n        this.gridTable = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_3__["GameGridTable"](this.mScene, config);\r\n        this.gridTable.layout();\r\n        this.gridTable.on("cellTap", function (cell) {\r\n            _this.onSelectItemHandler(cell);\r\n        });\r\n        this.mContainer.add(this.gridTable.table);\r\n    };\r\n    EquipUpgradeItem.prototype.onSelectItemHandler = function (cell) {\r\n        // Logger.getInstance().log(cell.itemData);\r\n        if (this.curEquipItem)\r\n            this.curEquipItem.setSelect(false);\r\n        var data = cell.itemData;\r\n        this.updateEquipItem(cell);\r\n        this.curEquipItem = cell;\r\n        if (data.owned && !data.selected)\r\n            this.emit("reqEquiped", data.id);\r\n    };\r\n    EquipUpgradeItem.prototype.updateEquipItem = function (cell) {\r\n        var data = cell.itemData;\r\n        this.penetrationText.text = data.buffDisplayNames[0];\r\n        this.equipDes.text = data.description;\r\n        this.equipName.text = data.name;\r\n        if (data.owned)\r\n            this.unlockbtn.visible = false;\r\n        else\r\n            this.unlockbtn.visible = true;\r\n        if (data.qualified) {\r\n            this.unlockCondition.visible = false;\r\n            this.unlockbtn.setInteractive();\r\n            this.unlockBg.clearTint();\r\n            this.costNum.setColor("#ffffff");\r\n        }\r\n        else if (!data.owned) {\r\n            this.unlockCondition.visible = true;\r\n            this.unlockCondition.text = data.conditionDisplayNames[0];\r\n            this.unlockbtn.disableInteractive();\r\n            this.unlockBg.setTintFill(0x888888);\r\n            this.costNum.setColor("#999999");\r\n        }\r\n        if (data.price === null) {\r\n            this.costNum.visible = false;\r\n            this.diamondIcon.visible = false;\r\n            this.btnName.setPosition(0, 0 * this.dpr);\r\n        }\r\n        else {\r\n            var costPrice = data.price.price;\r\n            var powValue = Math.pow(10, data.price.displayPrecision);\r\n            this.costNum.text = Math.floor(costPrice * powValue) / powValue + "";\r\n            this.costNum.visible = true;\r\n            this.diamondIcon.visible = true;\r\n            this.diamondIcon.setTexture(this.commonKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Coin"].getIcon(data.price.coinType));\r\n            this.diamondIcon.setDisplaySize(12 * this.dpr, 12 * this.dpr);\r\n            this.btnName.setPosition(0, 6 * this.dpr);\r\n        }\r\n        cell.setSelect(true);\r\n    };\r\n    EquipUpgradeItem.prototype.onUnlockEquipHandler = function () {\r\n        this.emit("reqActive", this.curEquipItem.itemData.id);\r\n    };\r\n    EquipUpgradeItem.prototype.createBtn = function () {\r\n        // this.unlockCondition = this.mScene.make.text({ x: 0, y: -26 * this.dpr, text: "解锁条件", style: { color: "#000000", fontSize: 10 * this.dpr, fontFamily: Font.DEFULT_FONT } }).setOrigin(0.5, 0.5);\r\n        this.unlockCondition = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_5__["BBCodeText"](this.mScene, 0, -26 * this.dpr, {})\r\n            .setOrigin(0.5).setFontSize(10 * this.dpr).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT);\r\n        this.unlockbtn = this.mScene.make.container(undefined, false);\r\n        var btnBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.mScene, 0, 0, 88 * this.dpr * this.zoom, 31 * this.dpr * this.zoom, this.commonKey, "yellow_btn_normal", {\r\n            left: 12 * this.dpr * this.zoom,\r\n            top: 12 * this.dpr * this.zoom,\r\n            right: 12 * this.dpr * this.zoom,\r\n            bottom: 12 * this.dpr * this.zoom\r\n        });\r\n        this.unlockBg = btnBg;\r\n        this.diamondIcon = this.mScene.make.image({ x: -13 * this.dpr, y: -8 * this.dpr, key: this.commonKey, frame: "test_diamond" });\r\n        this.costNum = this.mScene.make.text({ x: -2, y: -8 * this.dpr, text: "1000", style: { color: "#ffffff", fontSize: 10 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        this.btnName = this.mScene.make.text({ x: 0, y: 6 * this.dpr, text: "立即解锁", style: { color: "#8F4300", fontSize: 11 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT } }).setOrigin(0.5, 0.5);\r\n        this.costNum.setStroke("#ffffff", 1);\r\n        this.btnName.setStroke("#8F4300", 1);\r\n        this.unlockCondition.setStroke("#000000", 1);\r\n        this.unlockbtn.setPosition(70 * this.dpr, 48 * this.dpr);\r\n        this.unlockbtn.setSize(btnBg.width, btnBg.height);\r\n        this.unlockbtn.add([this.unlockCondition, btnBg, this.diamondIcon, this.costNum, this.btnName]);\r\n        this.unlockbtn.on("pointerup", this.onUnlockEquipHandler, this);\r\n        this.mContainer.add(this.unlockbtn);\r\n    };\r\n    EquipUpgradeItem.prototype.getBoldFont = function (size) {\r\n        var font = "bold " + size + "px Source Han Sans";\r\n        return font;\r\n    };\r\n    return EquipUpgradeItem;\r\n}(Phaser.Events.EventEmitter));\r\n\r\nvar EquipItemCell = /** @class */ (function (_super) {\r\n    __extends(EquipItemCell, _super);\r\n    function EquipItemCell(scene, dpr, key, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.index = 0;\r\n        _this.isSelect = false;\r\n        _this.isUnlock = false;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.zoom = zoom;\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    EquipItemCell.prototype.setItemData = function (data, index) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        this.index = index;\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes(data.display.texturePath);\r\n        this.equipIcon.load(url, this, function () {\r\n            _this.equipIcon.scale = _this.dpr * _this.zoom;\r\n            // const x = this.equipIcon.width * 0.5 + 18 * this.dpr * this.zoom;\r\n            // const y = this.equipIcon.height * 0.5 + 15 * this.dpr * this.zoom;\r\n            // this.equipIcon.setPosition(x, y);\r\n        });\r\n        this.setEquiped(data.selected, data.owned);\r\n        this.setSelect(this.isSelect);\r\n    };\r\n    EquipItemCell.prototype.setSelect = function (isSelect) {\r\n        this.isSelect = isSelect;\r\n        var bgName = "equipbg";\r\n        if (!isSelect) {\r\n            if (this.isUnlock)\r\n                bgName = "equipbg2";\r\n            else\r\n                bgName = "equipbg1";\r\n        }\r\n        if (this.itemData.selected)\r\n            bgName = "equipbg2";\r\n        this.bg.setTexture(this.key, bgName);\r\n    };\r\n    EquipItemCell.prototype.setChildPosition = function () {\r\n        var x = this.bg.width * 0.5 + 10 * this.dpr * this.zoom;\r\n        var y = this.height - 10 * this.dpr * this.zoom;\r\n        this.bg.setPosition(x, y);\r\n        x = x + 1 * this.dpr * this.zoom;\r\n        y = this.height * 0.5 + 2 * this.dpr * this.zoom;\r\n        this.equipIcon.setPosition(x, y);\r\n        x = x + 22 * this.dpr * this.zoom;\r\n        y = 8 * this.dpr * this.zoom;\r\n        this.unlock.setPosition(x, y);\r\n    };\r\n    EquipItemCell.prototype.setEquiped = function (isequiped, unlock) {\r\n        this.isUnlock = unlock;\r\n        this.unlock.visible = false;\r\n        if (isequiped) {\r\n            this.isUnlock = true;\r\n            this.unlock.visible = true;\r\n            this.unlock.setTexture(this.key, "ok");\r\n        }\r\n        else if (!this.isUnlock) {\r\n            this.unlock.visible = true;\r\n            this.unlock.setTexture(this.key, "lock");\r\n        }\r\n    };\r\n    EquipItemCell.prototype.create = function () {\r\n        this.bg = this.scene.make.image({ x: 0, y: -10 * this.dpr * this.zoom, key: this.key, frame: "equipbg" });\r\n        this.equipIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, 15 * this.dpr * this.zoom, 0 * this.dpr * this.zoom);\r\n        this.unlock = this.scene.make.image({ x: 30 * this.dpr * this.zoom, y: -10 * this.dpr * this.zoom, key: this.key, frame: "lock" });\r\n        this.add([this.bg, this.equipIcon, this.unlock]);\r\n    };\r\n    return EquipItemCell;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/EquipUpgrade/EquipUpgradeItem.ts?')},"./src/ui/EquipUpgrade/EquipUpgradeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EquipUpgradeMediator", function() { return EquipUpgradeMediator; });\n/* harmony import */ var _EquipUpgradePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EquipUpgradePanel */ "./src/ui/EquipUpgrade/EquipUpgradePanel.ts");\n/* harmony import */ var _EquipUpgrade__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EquipUpgrade */ "./src/ui/EquipUpgrade/EquipUpgrade.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar EquipUpgradeMediator = /** @class */ (function (_super) {\r\n    __extends(EquipUpgradeMediator, _super);\r\n    function EquipUpgradeMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        if (!_this.equipUpgrade) {\r\n            _this.equipUpgrade = new _EquipUpgrade__WEBPACK_IMPORTED_MODULE_1__["EquipUpgrade"](_this.world);\r\n            _this.equipUpgrade.on("activeEquip", _this.onActiveEquipment, _this);\r\n            _this.equipUpgrade.on("showopen", _this.onShowEquipPanel, _this);\r\n            _this.equipUpgrade.register();\r\n        }\r\n        return _this;\r\n    }\r\n    EquipUpgradeMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _EquipUpgradePanel__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHidePanel, this);\r\n            this.mView.on("reqActive", this.onReqActiveEquipment, this);\r\n            this.mView.on("reqEquiped", this.onReqEquipedEquipment, this);\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        if (this.mParam && this.mParam.length > 0)\r\n            this.onEquipUpgradePacket(this.mParam[0]);\r\n        this.mView.show();\r\n    };\r\n    EquipUpgradeMediator.prototype.destroy = function () {\r\n        if (this.equipUpgrade)\r\n            this.equipUpgrade.destroy();\r\n        this.equipUpgrade = undefined;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    EquipUpgradeMediator.prototype.onHidePanel = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    EquipUpgradeMediator.prototype.onEquipUpgradePacket = function (content) {\r\n        var panel = this.mView;\r\n        if (!panel)\r\n            return;\r\n        panel.setData("upgradeData", content);\r\n        panel.setEquipDatas(content);\r\n    };\r\n    EquipUpgradeMediator.prototype.onActiveEquipment = function (data) {\r\n        if (this.mView) {\r\n            var panel = this.mView;\r\n            panel.setActiveEquipment(data);\r\n        }\r\n    };\r\n    EquipUpgradeMediator.prototype.onReqEquipedEquipment = function (id) {\r\n        if (this.equipUpgrade)\r\n            this.equipUpgrade.reqEquipedEquipment(id);\r\n    };\r\n    EquipUpgradeMediator.prototype.onReqActiveEquipment = function (id) {\r\n        if (this.equipUpgrade)\r\n            this.equipUpgrade.reqActiveEquipment(id);\r\n    };\r\n    EquipUpgradeMediator.prototype.onShowEquipPanel = function (content) {\r\n        this.setParam([content]);\r\n        this.show();\r\n    };\r\n    return EquipUpgradeMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/EquipUpgrade/EquipUpgradeMediator.ts?')},"./src/ui/EquipUpgrade/EquipUpgradePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _EquipUpgradeItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./EquipUpgradeItem */ "./src/ui/EquipUpgrade/EquipUpgradeItem.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EquipUpgradePanel = /** @class */ (function (_super) {\r\n    __extends(EquipUpgradePanel, _super);\r\n    function EquipUpgradePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "equip_upgrade";\r\n        _this.commonkey = "common_key";\r\n        _this.equipItems = [];\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    EquipUpgradePanel.prototype.resize = function (width, height) {\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.setSize(w, h);\r\n        this.bg.x = w / 2; // - 24 * this.dpr * this.scale;\r\n        this.bg.y = h / 2; // - 20 * this.dpr * this.scale;\r\n        this.tilteName.x = this.bg.x;\r\n        this.tilteName.y = this.bg.y - this.bg.height / 2;\r\n        this.titlebg.x = this.bg.x;\r\n        this.titlebg.y = this.bg.y - this.bg.height / 2;\r\n        this.closeBtn.x = this.bg.x + this.bg.width / 2 - 10 * this.dpr * this.scale; // + this.bg.width / 2 - this.dpr * 8;\r\n        this.closeBtn.y = this.bg.y - this.bg.height / 2 + 10 * this.dpr * this.scale; // + posY + this.dpr * 8;\r\n        this.blackBg.clear();\r\n        this.blackBg.fillStyle(0, 0.5);\r\n        this.blackBg.fillRoundedRect(-this.x, -this.y, w, h);\r\n        this.add([this.blackBg, this.bg, this.closeBtn, this.titlebg, this.tilteName]);\r\n    };\r\n    EquipUpgradePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.refreshData();\r\n        this.addListen();\r\n    };\r\n    EquipUpgradePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.on("pointerup", this.OnClosePanel, this);\r\n    };\r\n    EquipUpgradePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.off("pointerup", this.OnClosePanel, this);\r\n    };\r\n    EquipUpgradePanel.prototype.preload = function () {\r\n        this.commonkey = _ui_atals_name__WEBPACK_IMPORTED_MODULE_5__["UIAtlasKey"].commonKey;\r\n        this.addAtlas(this.key, "equip_upgrade/mine_eqpm.png", "equip_upgrade/mine_eqpm.json");\r\n        this.addAtlas(this.commonkey, "common/ui_base.png", "common/ui_base.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    EquipUpgradePanel.prototype.init = function () {\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        this.setSize(w, h);\r\n        this.blackBg = this.scene.make.graphics(undefined, false);\r\n        this.blackBg.clear();\r\n        this.blackBg.fillStyle(0, 0.5);\r\n        this.blackBg.fillRoundedRect(0, 0, w, h);\r\n        this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        this.bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 300 * this.dpr, 300 * this.dpr, this.commonkey, "bg", {\r\n            left: 40,\r\n            top: 40,\r\n            bottom: 40,\r\n            right: 40,\r\n        });\r\n        var posY = -this.bg.height * 0.5;\r\n        this.titlebg = this.scene.make.image({ x: 0, y: posY, key: this.key, frame: "titlebg" });\r\n        var mfont = "bold " + 15 * this.dpr + "px Source Han Sans";\r\n        this.tilteName = this.scene.make.text({ x: 0, y: posY, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("equipupgrade.title"), style: { font: mfont, color: "#8F4300", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0.5, 0);\r\n        this.closeBtn = this.scene.make.image({ x: this.bg.width * 0.5 - this.dpr * 5, y: posY + this.dpr * 5, key: this.commonkey, frame: "close" });\r\n        this.tilteName.setStroke("#8F4300", 1);\r\n        this.closeBtn.setInteractive();\r\n        this.add([this.blackBg, this.bg, this.closeBtn, this.titlebg, this.tilteName]);\r\n        this.resize(this.scene.cameras.main.width, this.scene.cameras.main.height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    EquipUpgradePanel.prototype.setEquipDatas = function (content) {\r\n        this.content = content;\r\n        if (!this.mInitialized)\r\n            return;\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        var arr = content.mineEquipments; // this.getEuipDatas();// [content.minePicks, content.minePicks];\r\n        var height = 175 * this.dpr;\r\n        var bgHeight = height * arr.length - (arr.length >= 2 ? 40 * (arr.length - 2) : 0);\r\n        var cellHeight = 155 * this.dpr;\r\n        this.resetPosition(this.bg.width, bgHeight);\r\n        var posY = -bgHeight * 0.5 + 100 * this.dpr;\r\n        var index = 0;\r\n        for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n            var value = arr_1[_i];\r\n            value["isblue"] = (index % 2 === 0 ? false : true);\r\n            var item = new _EquipUpgradeItem__WEBPACK_IMPORTED_MODULE_2__["EquipUpgradeItem"](this.scene, this, this.dpr, this.scale, this.key, this.commonkey);\r\n            item.on("reqActive", this.onReqActiveEquipment, this);\r\n            item.on("reqEquiped", this.onReqEquipedEquipment, this);\r\n            item.setEquipItems(value);\r\n            item.setTransPosition(w / 2, posY + h / 2);\r\n            this.equipItems.push(item);\r\n            posY += cellHeight;\r\n            index++;\r\n        }\r\n        this.resize(w, h);\r\n    };\r\n    EquipUpgradePanel.prototype.setActiveEquipment = function (equip) {\r\n        var index = 0;\r\n        for (var _i = 0, _a = this.content.mineEquipments; _i < _a.length; _i++) {\r\n            var value = _a[_i];\r\n            var item = this.equipItems[index];\r\n            var activeIndex = -1;\r\n            // tslint:disable-next-line: prefer-for-of\r\n            for (var i = 0; i < value.mineEquipments.length; i++) {\r\n                var data = value.mineEquipments[i];\r\n                if (data.id === equip.id) {\r\n                    value.mineEquipments[i] = equip;\r\n                    item.refreshEquipData(equip, i);\r\n                    activeIndex = i;\r\n                }\r\n                else {\r\n                    if (data.selected)\r\n                        data.selected = false;\r\n                }\r\n            }\r\n            if (activeIndex >= 0) {\r\n                item.refreshEquipData(equip, activeIndex);\r\n            }\r\n            index++;\r\n        }\r\n    };\r\n    EquipUpgradePanel.prototype.destroy = function () {\r\n        if (this.equipItems) {\r\n            for (var _i = 0, _a = this.equipItems; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                item.destroy();\r\n            }\r\n            this.equipItems.length = 0;\r\n        }\r\n        this.equipItems = null;\r\n        this.content = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    EquipUpgradePanel.prototype.getEuipDatas = function () {\r\n        var arr = [];\r\n        for (var i = 0; i < 3; i++) {\r\n            var obj = {};\r\n            obj["name"] = i === 0 ? "矿镐" : "矿车";\r\n            obj["items"] = [];\r\n            obj["isblue"] = !(i % 2 === 0);\r\n            for (var j = 0; j < 15; j++) {\r\n                var item = {};\r\n                item["name"] = "矿镐" + j;\r\n                item["penetration"] = 10 + j;\r\n                item["des"] = "describle";\r\n                item["cost"] = 100 * j;\r\n                item["unlock"] = false;\r\n                obj["items"].push(item);\r\n            }\r\n            arr.push(obj);\r\n        }\r\n        return arr;\r\n    };\r\n    EquipUpgradePanel.prototype.refreshData = function () {\r\n        var upgradeData = this.getData("upgradeData");\r\n        if (upgradeData)\r\n            this.setEquipDatas(upgradeData);\r\n    };\r\n    EquipUpgradePanel.prototype.resetPosition = function (width, height) {\r\n        this.bg.resize(width, height);\r\n        var posY = -height * 0.5;\r\n        this.titlebg.setPosition(0, posY);\r\n        this.tilteName.setPosition(0, posY);\r\n        this.closeBtn.setPosition(width * 0.5 - this.dpr * 8, posY + this.dpr * 8);\r\n    };\r\n    EquipUpgradePanel.prototype.OnClosePanel = function () {\r\n        this.emit("hide");\r\n    };\r\n    EquipUpgradePanel.prototype.onReqActiveEquipment = function (id) {\r\n        this.emit("reqActive", id);\r\n    };\r\n    EquipUpgradePanel.prototype.onReqEquipedEquipment = function (id) {\r\n        this.emit("reqEquiped", id);\r\n    };\r\n    return EquipUpgradePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n/* harmony default export */ __webpack_exports__["default"] = (EquipUpgradePanel);\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/EquipUpgrade/EquipUpgradePanel.ts?')},"./src/ui/FurniBag/FurniBag.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FurniBag", function() { return FurniBag; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar FurniBag = /** @class */ (function (_super) {\r\n    __extends(FurniBag, _super);\r\n    function FurniBag($world, sceneType) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mSceneType = sceneType;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    FurniBag.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_PACKAGE_CATEGORIES, this.onPackageCategoriesHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE, this.onQueryMarketPackage);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE, this.onQueryCommodityResultHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_QUERY_EDIT_PACKAGE, this.onQueryEditPackage);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_RESET_AVATAR, this.onQueryResetAvatar);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_CURRENT_DRESS_AVATAR_ITEM_ID, this.onRetDressAvatarItemIDS);\r\n        }\r\n    };\r\n    FurniBag.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    FurniBag.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    FurniBag.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    FurniBag.prototype.getCategories = function (categoryType) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_PACKAGE_CATEGORIES);\r\n        var content = packet.content;\r\n        content.category = categoryType;\r\n        this.connection.send(packet);\r\n        this.categoryType = categoryType;\r\n    };\r\n    FurniBag.prototype.queryPackage = function (key, queryString) {\r\n        if (this.mSceneType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.NORMAL_SCENE_TYPE) {\r\n            this.queryMarketPackage(key, queryString);\r\n        }\r\n        else {\r\n            this.queryEditPackage(key, queryString);\r\n        }\r\n    };\r\n    FurniBag.prototype.queryCommodityResource = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE_ITEM_RESOURCE);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.addFurniToScene = function (id) {\r\n        if (this.mSceneType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SELECTED_SPRITE);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.enterEditAndSelectedSprite = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENABLE_AND_SELECTED_SPRITE);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.seachPackage = function (seach, category) {\r\n        this.queryPackage(category, seach);\r\n    };\r\n    FurniBag.prototype.sellProps = function (prop, count, category) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_SELL_PACKAGE_ITEM);\r\n        var content = packet.content;\r\n        content.category = category;\r\n        var item = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].CountablePackageItem.create(prop);\r\n        item.count = count;\r\n        content.items = [item];\r\n        content.totalPrice = item.sellingPrice;\r\n        content.totalPrice.price *= count;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.useProps = function (itemid, count) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_USE_ITEM);\r\n        var content = packet.content;\r\n        content.itemId = itemid;\r\n        content.count = count;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.querySaveAvatar = function (avatarids) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_DRESS_UP_AVATAR);\r\n        var content = packet.content;\r\n        content.avatarItemIds = avatarids;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.queryResetAvatar = function (avatar) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_RESET_AVATAR);\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.queryDressAvatarItemIDs = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_CURRENT_DRESS_AVATAR_ITEM_ID);\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    FurniBag.prototype.onPackageCategoriesHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (content.category === this.categoryType) {\r\n            this.mEvent.emit("packageCategory", content.subcategory);\r\n        }\r\n    };\r\n    FurniBag.prototype.onQueryMarketPackage = function (packge) {\r\n        // OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE\r\n        var content = packge.content;\r\n        if (content.category === this.categoryType) {\r\n            this.mEvent.emit("queryPackage", content);\r\n        }\r\n    };\r\n    FurniBag.prototype.onQueryEditPackage = function (packet) {\r\n        var content = packet.content;\r\n        if (content.category === this.categoryType) {\r\n            this.mEvent.emit("queryPackage", content);\r\n        }\r\n    };\r\n    FurniBag.prototype.onQueryCommodityResultHandler = function (packet) {\r\n        this.mEvent.emit("queryCommodityResource", packet.content);\r\n    };\r\n    FurniBag.prototype.onQueryResetAvatar = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("queryResetAvatar", content);\r\n    };\r\n    FurniBag.prototype.queryMarketPackage = function (key, queryString) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_PACKAGE);\r\n        var content = packet.content;\r\n        content.category = this.categoryType;\r\n        content.page = 1;\r\n        content.perPage = 30;\r\n        content.subcategory = key;\r\n        content.queryString = queryString;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.queryEditPackage = function (key, queryString) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_QUERY_EDIT_PACKAGE);\r\n        var content = packet.content;\r\n        content.category = this.categoryType;\r\n        content.page = 1;\r\n        content.perPage = 30;\r\n        content.subcategory = key;\r\n        content.queryString = queryString;\r\n        this.connection.send(packet);\r\n    };\r\n    FurniBag.prototype.onRetDressAvatarItemIDS = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("avatarIDs", content.avatarItemIds);\r\n    };\r\n    Object.defineProperty(FurniBag.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return FurniBag;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/FurniBag/FurniBag.ts?')},"./src/ui/FurniBag/FurniBagMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FurniBagMediator", function() { return FurniBagMediator; });\n/* harmony import */ var _FurniBagPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FurniBagPanel */ "./src/ui/FurniBag/FurniBagPanel.ts");\n/* harmony import */ var _FurniBag__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./FurniBag */ "./src/ui/FurniBag/FurniBag.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar FurniBagMediator = /** @class */ (function (_super) {\r\n    __extends(FurniBagMediator, _super);\r\n    function FurniBagMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        if (_this.world && _this.world.roomManager && _this.world.roomManager.currentRoom) {\r\n            _this.mScneType = _this.world.roomManager.currentRoom.sceneType;\r\n        }\r\n        else {\r\n            _this.mScneType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].SceneTypeEnum.NORMAL_SCENE_TYPE;\r\n        }\r\n        return _this;\r\n    }\r\n    FurniBagMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.mFurniBag) {\r\n            this.mFurniBag = new _FurniBag__WEBPACK_IMPORTED_MODULE_1__["FurniBag"](this.world, this.mScneType);\r\n            this.mFurniBag.register();\r\n            this.mFurniBag.on("packageCategory", this.onPackageCategoryHandler, this);\r\n            this.mFurniBag.on("queryPackage", this.onQueryPackageHandler, this);\r\n            this.mFurniBag.on("queryCommodityResource", this.onQueryCommodityResourceHandler, this);\r\n            this.mFurniBag.on("queryResetAvatar", this.onResetAvatar, this);\r\n            this.mFurniBag.on("avatarIDs", this.onDressAvatarIDS, this);\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _FurniBagPanel__WEBPACK_IMPORTED_MODULE_0__["FurniBagPanel"](this.scene, this.world, this.mScneType);\r\n            this.mView.on("getCategories", this.onGetCategoriesHandler, this);\r\n            this.mView.on("queryPackage", this.onQueryPackage, this);\r\n            this.mView.on("close", this.onCloseHandler, this);\r\n            this.mView.on("queryPropResource", this.onQueryPropResourceHandler, this);\r\n            this.mView.on("seachPackage", this.onSeachPackageHandler, this);\r\n            this.mView.on("addFurniToScene", this.onAddFurniHandler, this);\r\n            this.mView.on("sellProps", this.onSellPropsHandler, this);\r\n            this.mView.on("querySaveAvatar", this.onQuerySaveAvatar, this);\r\n            this.mView.on("queryResetAvatar", this.onQueryResetAvatar, this);\r\n            this.mView.on("queryDressAvatarIDS", this.queryDressAvatarIDS, this);\r\n            this.mView.on("useprops", this.onUsePropsHandler, this);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    FurniBagMediator.prototype.destroy = function () {\r\n        if (this.mFurniBag) {\r\n            this.mFurniBag.destroy();\r\n            this.mFurniBag = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FurniBagMediator.prototype.onCloseHandler = function () {\r\n        this.destroy();\r\n    };\r\n    FurniBagMediator.prototype.onPackageCategoryHandler = function (subcategory) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.setCategories(subcategory);\r\n    };\r\n    FurniBagMediator.prototype.onQueryCommodityResourceHandler = function (content) {\r\n        this.mView.setSelectedResource(content);\r\n    };\r\n    FurniBagMediator.prototype.onGetCategoriesHandler = function (categoryType) {\r\n        if (this.mFurniBag) {\r\n            this.mFurniBag.getCategories(categoryType);\r\n        }\r\n    };\r\n    FurniBagMediator.prototype.onQueryPackageHandler = function (content) {\r\n        this.mView.setProp(content.items);\r\n    };\r\n    FurniBagMediator.prototype.onQueryPackage = function (key) {\r\n        this.mFurniBag.queryPackage(key);\r\n    };\r\n    FurniBagMediator.prototype.onQueryPropResourceHandler = function (prop) {\r\n        this.mFurniBag.queryCommodityResource(prop.id);\r\n    };\r\n    FurniBagMediator.prototype.onQuerySaveAvatar = function (avatarids) {\r\n        this.mFurniBag.querySaveAvatar(avatarids);\r\n    };\r\n    FurniBagMediator.prototype.onQueryResetAvatar = function (avatar) {\r\n        this.mFurniBag.queryResetAvatar(avatar);\r\n    };\r\n    FurniBagMediator.prototype.onSeachPackageHandler = function (query, categories) {\r\n        this.mFurniBag.seachPackage(query, categories);\r\n    };\r\n    FurniBagMediator.prototype.onAddFurniHandler = function (id) {\r\n        if (this.mView.enableEdit) {\r\n            this.mFurniBag.enterEditAndSelectedSprite(id);\r\n        }\r\n        else {\r\n            this.mFurniBag.addFurniToScene(id);\r\n        }\r\n        this.destroy();\r\n    };\r\n    FurniBagMediator.prototype.onSellPropsHandler = function (prop, count, category) {\r\n        this.mFurniBag.sellProps(prop, count, category);\r\n    };\r\n    FurniBagMediator.prototype.onUsePropsHandler = function (itemid, count) {\r\n        this.mFurniBag.useProps(itemid, count);\r\n    };\r\n    FurniBagMediator.prototype.onResetAvatar = function (content) {\r\n        this.mView.resetAvatar(content);\r\n    };\r\n    FurniBagMediator.prototype.onDressAvatarIDS = function (ids) {\r\n        this.mView.setDressAvatarIds(ids);\r\n    };\r\n    FurniBagMediator.prototype.queryDressAvatarIDS = function () {\r\n        this.mFurniBag.queryDressAvatarItemIDs();\r\n    };\r\n    return FurniBagMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/FurniBag/FurniBagMediator.ts?')},"./src/ui/FurniBag/FurniBagPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FurniBagPanel", function() { return FurniBagPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Market/DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _Market_TextButton__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Market/TextButton */ "./src/ui/Market/TextButton.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_input_panel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../components/input.panel */ "./src/ui/components/input.panel.ts");\n/* harmony import */ var _components_checkbox_group__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../components/checkbox.group */ "./src/ui/components/checkbox.group.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/tab/TabButton */ "./lib/rexui/lib/ui/tab/TabButton.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/GameScroller */ "./lib/rexui/lib/ui/scroller/GameScroller.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar FurniBagPanel = /** @class */ (function (_super) {\r\n    __extends(FurniBagPanel, _super);\r\n    function FurniBagPanel(scene, world, sceneType) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "furni_bag";\r\n        _this.commonkey = "common_key";\r\n        _this.seachKey = "key.seach";\r\n        _this.topBtns = [];\r\n        _this.mEnableEdit = false;\r\n        _this.mInputBoo = false;\r\n        _this.mSelectedItemData = [];\r\n        _this.mSceneType = sceneType;\r\n        _this.scale = 1;\r\n        _this.setInteractive();\r\n        return _this;\r\n    }\r\n    FurniBagPanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        _super.prototype.resize.call(this, width, height);\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mBackground.clear();\r\n        this.mBackground.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        this.mBackground.fillRect(0, 0, width * zoom, height * zoom);\r\n        this.mShelfContainer.setSize(width, 295 * this.dpr * zoom);\r\n        this.mShelfContainer.y = height - this.mShelfContainer.height;\r\n        this.mDetailBubble.y = this.mShelfContainer.y - 10 * this.dpr * zoom - this.mDetailBubble.height;\r\n        this.mCategoriesBar.clear();\r\n        this.mCategoriesBar.fillStyle(0x33ccff);\r\n        this.mCategoriesBar.fillRect(0, 0, width, 40 * this.dpr * zoom);\r\n        this.mCategoriesBar.fillStyle(0x00cccc);\r\n        this.mCategoriesBar.fillRect(0, 40 * this.dpr * zoom, width, 3 * this.dpr * zoom);\r\n        this.mBg.x = width / 2;\r\n        this.mBg.y = this.mBg.height / 2 + 10 * this.dpr * zoom;\r\n        //  this.mTiltle.x = width / 2;\r\n        // this.mCategoryScroll.resize(width, 41 * this.dpr * zoom);\r\n        this.mAdd.x = width - this.mAdd.width / 2 - 10 * this.dpr;\r\n        this.mAdd.y = this.mShelfContainer.y - this.mAdd.height / 2 - 9 * this.dpr * zoom;\r\n        this.useBtn.x = this.mAdd.x;\r\n        this.useBtn.y = this.mAdd.y;\r\n        this.sellBtn.x = Math.floor(this.mAdd.x - this.sellBtn.width - 10 * this.dpr);\r\n        this.sellBtn.y = this.mAdd.y;\r\n        this.resetBtn.x = this.mAdd.x + 25 * this.dpr;\r\n        this.resetBtn.y = this.mAdd.y;\r\n        this.saveBtn.x = this.resetBtn.x - (this.saveBtn.width + this.resetBtn.width) / 2 - 10 * this.dpr;\r\n        this.saveBtn.y = this.resetBtn.y;\r\n        this.mDetailDisplay.x = width / 2;\r\n        this.mDetailDisplay.y = this.mBg.y;\r\n        this.mPropGrid.refreshPos(this.mShelfContainer.width / 2, this.mShelfContainer.y + 170 * this.dpr * zoom, 8 * this.dpr * zoom, 3 * this.dpr * zoom);\r\n        this.mPropGrid.resetMask();\r\n        // this.mPropGrid.y = this.mShelfContainer.y + 43 * this.dpr * zoom + 120 * this.dpr * zoom;\r\n        this.setSize(width, height);\r\n    };\r\n    FurniBagPanel.prototype.setCategories = function (subcategorys) {\r\n        // subcategorys.unshift({ key: this.seachKey, value: "搜索" });\r\n        this.mPreCategoryBtn = null;\r\n        this.mSelectedCategeories = null;\r\n        var zoom = this.mWorld.uiScale;\r\n        var capW = 60 * this.dpr * zoom;\r\n        var capH = 41 * this.dpr * zoom;\r\n        var items = [];\r\n        if (this.mSeachInput.parentContainer)\r\n            this.closeSeach(null);\r\n        this.mCategoryScroll.clearItems();\r\n        var seachBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_12__["Button"](this.scene, this.key, "seach_normal", "seach_down");\r\n        seachBtn.setData("item", { key: this.seachKey, value: "搜索" });\r\n        seachBtn.y = capH - 40 * this.dpr * zoom;\r\n        this.mCategoryScroll.addItem(seachBtn);\r\n        for (var i = 0; i < subcategorys.length; i++) {\r\n            var item = new _Market_TextButton__WEBPACK_IMPORTED_MODULE_6__["TextButton"](this.scene, this.dpr, zoom, subcategorys[i].value, 0, 0);\r\n            item.x = i * capW;\r\n            item.y = capH - item.text.height - 40 * this.dpr * zoom >> 1;\r\n            item.setData("item", subcategorys[i]);\r\n            item.setSize(capW, capH);\r\n            this.mCategoryScroll.addItem(item);\r\n            items[i] = item;\r\n            item.setFontSize(17 * this.dpr * zoom);\r\n            item.setFontStyle("bold");\r\n        }\r\n        if (items.length > 1)\r\n            this.onSelectSubCategoryHandler(items[0]);\r\n        // this.mSeachInput.x = capW - this.mSeachInput.width / 2;\r\n        // this.mPropGrid.refreshPos(this.mShelfContainer.width / 2, this.mShelfContainer.y + 170 * this.dpr * zoom, 8 * this.dpr * zoom, 10 * this.dpr * zoom);\r\n        this.updateCategeoriesLoc(false);\r\n    };\r\n    FurniBagPanel.prototype.setProp = function (props) {\r\n        if (!props) {\r\n            return;\r\n        }\r\n        var len = props.length;\r\n        if (len < 24) {\r\n            props = props.concat(new Array(24 - len));\r\n        }\r\n        this.mPropGrid.setItems(props);\r\n        if (this.categoryType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR) {\r\n            this.mSelectedItemData.length = 0;\r\n            var cell = this.mPropGrid.getCell(0);\r\n            this.onSelectItemHandler(cell.container);\r\n        }\r\n        else {\r\n            if (this.mSelectedItemData.length === 0) {\r\n                for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\r\n                    var prop = props_1[_i];\r\n                    if (prop && prop.rightSubscript === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_pkt_def"].PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK) {\r\n                        this.mSelectedItemData.push(prop);\r\n                    }\r\n                }\r\n                this.updateAvatarItems();\r\n            }\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.setDressAvatarIds = function (ids) {\r\n        this.dressAvatarIDS = ids;\r\n        this.updateAvatarItems();\r\n    };\r\n    FurniBagPanel.prototype.displayAvatar = function () {\r\n        var content = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_PACKAGE_ITEM_RESOURCE();\r\n        content.avatar = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_gameconfig"].Avatar();\r\n        var player = this.mWorld.roomManager.currentRoom.playerManager.actor;\r\n        var avatar = player.model.avatar;\r\n        for (var key in avatar) {\r\n            if (avatar.hasOwnProperty(key)) {\r\n                var element = avatar[key];\r\n                if (element)\r\n                    content.avatar[key] = element;\r\n            }\r\n        }\r\n        var offset = new Phaser.Geom.Point(0, 20 * this.dpr);\r\n        this.mDetailDisplay.loadAvatar(content, 2, offset);\r\n    };\r\n    FurniBagPanel.prototype.setSelectedResource = function (content) {\r\n        if (content.display) {\r\n            this.mDetailDisplay.loadDisplay(content);\r\n        }\r\n        else if (content.avatar) {\r\n            var player = this.mWorld.roomManager.currentRoom.playerManager.actor;\r\n            var avatar = player.model.avatar;\r\n            for (var key in avatar) {\r\n                if (avatar.hasOwnProperty(key)) {\r\n                    var element = avatar[key];\r\n                    if (element)\r\n                        content.avatar[key] = element;\r\n                }\r\n            }\r\n            for (var _i = 0, _a = this.mSelectedItemData; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                var dataAvatar = item.avatar;\r\n                for (var key in dataAvatar) {\r\n                    if (dataAvatar.hasOwnProperty(key)) {\r\n                        var element = dataAvatar[key];\r\n                        if (element)\r\n                            content.avatar[key] = element;\r\n                    }\r\n                }\r\n            }\r\n            var offset = new Phaser.Geom.Point(0, 20 * this.dpr);\r\n            this.mDetailDisplay.loadAvatar(content, 2, offset);\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.resetAvatar = function (avatar) {\r\n        var content = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE();\r\n        content.avatar = avatar.avatar;\r\n        var offset = new Phaser.Geom.Point(0, 20 * this.dpr);\r\n        this.mDetailDisplay.loadAvatar(content, 2, offset);\r\n    };\r\n    FurniBagPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n        this.mSeachInput.on("seach", this.onSeachHandler, this);\r\n        this.mAdd.on("pointerup", this.onAddFurniToSceneHandler, this);\r\n        this.sellBtn.on("pointerup", this.onSellBtnHandler, this);\r\n        this.useBtn.on("pointerup", this.onUseBtnHandler, this);\r\n        this.saveBtn.on("pointerup", this.onSaveBtnHandler, this);\r\n        this.resetBtn.on("pointerup", this.onResetBtnHandler, this);\r\n    };\r\n    FurniBagPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n        this.mSeachInput.off("seach", this.onSeachHandler, this);\r\n        this.mAdd.off("pointerup", this.onAddFurniToSceneHandler, this);\r\n        this.sellBtn.off("pointerup", this.onSellBtnHandler, this);\r\n        this.useBtn.off("pointerup", this.onUseBtnHandler, this);\r\n        this.saveBtn.on("pointerup", this.onSaveBtnHandler, this);\r\n        this.resetBtn.on("pointerup", this.onResetBtnHandler, this);\r\n    };\r\n    FurniBagPanel.prototype.destroy = function () {\r\n        if (this.mCategoryScroll) {\r\n            this.mCategoryScroll.destroy();\r\n        }\r\n        if (this.mPropGrid) {\r\n            this.mPropGrid.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FurniBagPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "furni_bag/furni_bag.png", "furni_bag/furni_bag.json");\r\n        this.addAtlas(this.commonkey, "common/ui_base.png", "common/ui_base.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    FurniBagPanel.prototype.init = function () {\r\n        var _this = this;\r\n        var width = this.scene.cameras.main.width;\r\n        var height = this.scene.cameras.main.height;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mBg = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg"\r\n        }, false).setScale(zoom);\r\n        this.mShelfContainer = this.scene.make.container(undefined, false);\r\n        this.mShelfContainer.setSize(width, 295 * this.dpr * zoom);\r\n        this.mShelfContainer.y = height - this.mShelfContainer.height;\r\n        // this.mPropsContainer = this.scene.make.container(undefined, false);\r\n        // this.mCategeoriesContainer = this.scene.make.container(undefined, false);\r\n        // this.mCategeoriesContainer.x = this.mShelfContainer.x;\r\n        // this.mCategeoriesContainer.y = this.mShelfContainer.y;\r\n        this.mCategoriesBar = this.scene.make.graphics(undefined, false);\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        this.mCloseBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "back_arrow",\r\n            x: 21 * this.dpr,\r\n            y: 30 * this.dpr\r\n        }).setScale(zoom).setInteractive();\r\n        var btnwidth = 90 * this.dpr * zoom;\r\n        var btnHeight = 40 * this.dpr * zoom;\r\n        var btnPosX = width - btnwidth / 2 - 20 * this.dpr;\r\n        var btnPosY = this.mShelfContainer.y - 25 * this.dpr * zoom;\r\n        this.mAdd = this.createNineButton(btnPosX + 100 * this.dpr * zoom, btnPosY, btnwidth, btnHeight, this.commonkey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.add"), "#996600");\r\n        this.sellBtn = this.createNineButton(btnPosX, btnPosY, btnwidth, btnHeight, this.commonkey, "red_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.sold"), "#FFFFFF");\r\n        this.useBtn = this.createNineButton(btnPosX + 100 * this.dpr * zoom, btnPosY, btnwidth, btnHeight, this.commonkey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.use"), "#996600");\r\n        this.saveBtn = this.createNineButton(btnPosX + 100 * this.dpr * zoom, btnPosY, btnwidth, btnHeight, this.commonkey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.save"), "#996600");\r\n        this.resetBtn = this.createNineButton(btnPosX + 100 * this.dpr * zoom, btnPosY - btnHeight - 5 * this.dpr * zoom, 40 * this.dpr, 40 * this.dpr, this.commonkey, "red_btn");\r\n        var reseticon = this.scene.make.image({ key: this.key, frame: "restore" });\r\n        this.resetBtn.add(reseticon);\r\n        this.mDetailDisplay = new _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_2__["DetailDisplay"](this.scene);\r\n        this.mDetailDisplay.setTexture(this.key, "ghost");\r\n        this.mDetailDisplay.setNearest();\r\n        this.mDetailDisplay.y = this.mBg.y + this.mBg.height / 2;\r\n        this.mDetailDisplay.scale = this.dpr;\r\n        this.mDetailBubble = new DetailBubble(this.scene, this.key, this.dpr, zoom);\r\n        this.mDetailBubble.x = 10 * this.dpr;\r\n        this.mSeachInput = new SeachInput(this.scene, this.mWorld, this.key, this.dpr);\r\n        // this.mSeachInput.x = this.mSeachInput.width / 2 + 6 * this.dpr;\r\n        var inputWid = this.mInputBoo ? 260 * this.dpr * zoom : 0;\r\n        var w = this.scene.cameras.main.width + inputWid;\r\n        this.mCategoryScroll = new _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_15__["GameScroller"](this.scene, {\r\n            x: w * .5,\r\n            y: this.mShelfContainer.y + 20 * this.dpr * zoom,\r\n            width: this.scene.cameras.main.width,\r\n            height: 41 * this.dpr * zoom,\r\n            zoom: this.scale,\r\n            orientation: 1,\r\n            // valuechangeCallback: (newValue) => {\r\n            //   this.refreshPos(newValue);\r\n            // },\r\n            cellupCallBack: function (gameobject) {\r\n                _this.onSelectSubCategoryHandler(gameobject);\r\n            }\r\n        });\r\n        this.add([this.mBackground, this.mBg, this.mCloseBtn, this.mDetailDisplay, this.mDetailBubble, this.mShelfContainer, this.mCategoryScroll]);\r\n        this.add([this.sellBtn, this.useBtn, this.mAdd, this.saveBtn, this.resetBtn]);\r\n        this.mShelfContainer.add(this.mCategoriesBar);\r\n        // this.mCategeoriesContainer.add([this.mCategoriesBar]);\r\n        if (this.mWorld && this.mWorld.roomManager && this.mWorld.roomManager.currentRoom) {\r\n            this.mEnableEdit = this.mWorld.roomManager.currentRoom.enableEdit;\r\n        }\r\n        var topCapW = 67 * this.dpr * zoom;\r\n        var topCapH = 30 * this.dpr * zoom;\r\n        var topPosY = 30 * this.dpr * zoom;\r\n        var topStyle = {\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].BOLD_FONT,\r\n            fontSize: 20 * this.dpr * zoom,\r\n            color: "#FFFFFF"\r\n        };\r\n        this.topCheckBox = new _components_checkbox_group__WEBPACK_IMPORTED_MODULE_9__["CheckboxGroup"]();\r\n        var topCategorys = [pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_ITEM, pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_FURNITURE, pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR];\r\n        var topBtnTexts = [_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.Props"), _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.furni"), _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.decorate")];\r\n        if (this.mSceneType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE) {\r\n            topCategorys = [pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_FURNITURE];\r\n            topBtnTexts = [_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.furni")];\r\n        }\r\n        var topPosX = width * 0.5 - topCapW * 0.5 * (topCategorys.length - 1);\r\n        for (var key in topCategorys) {\r\n            var index = Number(key);\r\n            var category = topCategorys[index];\r\n            var button = new _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_13__["TabButton"](this.scene, this.key, "tab_normal", "tab_down", topBtnTexts[index]);\r\n            button.setTextStyle(topStyle);\r\n            button.setData("data", category);\r\n            button.setSize(topCapW, topCapH);\r\n            button.setFontStyle("bold");\r\n            button.y = topPosY;\r\n            button.x = topPosX + topCapW * index;\r\n            this.topBtns.push(button);\r\n        }\r\n        this.topCheckBox.appendItemAll(this.topBtns);\r\n        this.topCheckBox.on("selected", this.onTopCategoryHandler, this);\r\n        this.topBtns.forEach(function (btn) {\r\n            _this.add(btn);\r\n        });\r\n        if (this.mEnableEdit) {\r\n            var index = topCategorys.indexOf(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_FURNITURE);\r\n            this.topCheckBox.selectIndex(index);\r\n        }\r\n        else {\r\n            this.topCheckBox.selectIndex(0);\r\n        }\r\n        var propFrame = this.scene.textures.getFrame(this.key, "prop_bg");\r\n        var capW = (propFrame.width + 10 * this.dpr) * zoom;\r\n        var capH = (propFrame.height + 10 * this.dpr) * zoom;\r\n        w = this.scene.cameras.main.width + 35 * this.dpr * zoom + inputWid;\r\n        var tableConfig = {\r\n            x: 0,\r\n            y: 0,\r\n            table: {\r\n                width: this.scene.cameras.main.width - 16 * this.dpr * zoom,\r\n                height: 250 * this.dpr * zoom,\r\n                columns: 4,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0,\r\n                zoom: this.scale,\r\n                cellPadX: 10 * this.dpr * zoom\r\n            },\r\n            scrollMode: 1,\r\n            clamplChildOY: false,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new Item(scene, 0, 0, _this.key, _this.dpr, zoom);\r\n                    _this.add(cellContainer);\r\n                }\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setProp(item);\r\n                if (item) {\r\n                    if (_this.isSelectedItemData(item))\r\n                        cellContainer.isSelect = true;\r\n                    if (item.rightSubscript === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_pkt_def"].PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK) {\r\n                        cellContainer.isEquip = true;\r\n                    }\r\n                    else\r\n                        cellContainer.isEquip = false;\r\n                }\r\n                else {\r\n                    cellContainer.isSelect = false;\r\n                    cellContainer.isEquip = false;\r\n                }\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mPropGrid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_14__["GameGridTable"](this.scene, tableConfig);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.on("cellTap", function (cell) {\r\n            if (cell) {\r\n                _this.onSelectItemHandler(cell);\r\n            }\r\n        });\r\n        this.add(this.mPropGrid.table);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    FurniBagPanel.prototype.createNineButton = function (x, y, width, height, key, frame, text, color) {\r\n        var zoom = this.scale;\r\n        var btn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_16__["NineSliceButton"](this.scene, x, y, width, height, key, frame, text, this.dpr, this.scale, {\r\n            left: 12 * this.dpr * zoom,\r\n            top: 12 * this.dpr * zoom,\r\n            right: 12 * this.dpr * zoom,\r\n            bottom: 12 * this.dpr * zoom\r\n        });\r\n        if (text) {\r\n            btn.setTextStyle({\r\n                color: color,\r\n                fontSize: 16 * this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            });\r\n            btn.setFontStyle("bold");\r\n        }\r\n        return btn;\r\n    };\r\n    FurniBagPanel.prototype.updateAvatarItems = function () {\r\n        if (this.dressAvatarIDS && this.mSelectedItemData.length > 0) {\r\n            this.mSelectedItemData.length = 0;\r\n            var cells = this.mPropGrid.getCells();\r\n            for (var _i = 0, _a = this.dressAvatarIDS; _i < _a.length; _i++) {\r\n                var id = _a[_i];\r\n                for (var _b = 0, cells_1 = cells; _b < cells_1.length; _b++) {\r\n                    var cell = cells_1[_b];\r\n                    if (cell) {\r\n                        var item = cell.container.getData("item");\r\n                        if (item && id === item.id && item.rightSubscript === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_pkt_def"].PKT_Subscript.PKT_SUBSCRIPT_CHECKMARK) {\r\n                            this.onSelectItemHandler(cell.container);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.mDetailBubble.setProp(null);\r\n            this.mDetailBubble.y = this.mShelfContainer.y - 10 * this.dpr - this.mDetailBubble.height;\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.replaceSelectItem = function (data) {\r\n        if (this.categoryType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR) {\r\n            this.mSelectedItemData.length = 0;\r\n            this.mSelectedItemData.push(data);\r\n        }\r\n        else {\r\n            var dataAvatar = data.avatar;\r\n            var removeArr = [];\r\n            for (var _i = 0, _a = this.mSelectedItemData; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                var avatar = item.avatar;\r\n                if (this.isContainProperty(avatar, dataAvatar)) {\r\n                    var index = this.mSelectedItemData.indexOf(item);\r\n                    removeArr.push(item);\r\n                }\r\n            }\r\n            for (var _b = 0, removeArr_1 = removeArr; _b < removeArr_1.length; _b++) {\r\n                var item = removeArr_1[_b];\r\n                var index = this.mSelectedItemData.indexOf(item);\r\n                this.mSelectedItemData.splice(index, 1);\r\n            }\r\n            this.mSelectedItemData.push(data);\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.isContainProperty = function (obj, obj1) {\r\n        var canreplace = true;\r\n        for (var key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                if (!obj1.hasOwnProperty(key)) {\r\n                    canreplace = false;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return canreplace;\r\n    };\r\n    FurniBagPanel.prototype.isContainObject = function (obj, obj1) {\r\n        if (!obj && !obj1)\r\n            return true;\r\n        if (typeof obj !== typeof obj1)\r\n            return false;\r\n        if (typeof obj === "object") {\r\n            var canreplace = true;\r\n            for (var key in obj) {\r\n                if (obj.hasOwnProperty(key)) {\r\n                    if (obj1.hasOwnProperty(key)) {\r\n                        var value = obj1[key];\r\n                        if (!this.isContainObject(value, obj[key])) {\r\n                            canreplace = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                    else {\r\n                        canreplace = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return canreplace;\r\n        }\r\n        else {\r\n            if (obj === obj1)\r\n                return true;\r\n            else\r\n                return false;\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.isSelectedItemData = function (data) {\r\n        for (var _i = 0, _a = this.mSelectedItemData; _i < _a.length; _i++) {\r\n            var temp = _a[_i];\r\n            if (temp.indexId === data.indexId) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    FurniBagPanel.prototype.setSelectedItem = function (prop) {\r\n        this.emit("queryPropResource", prop);\r\n        this.sellBtn.enable = prop.recyclable;\r\n        this.useBtn.enable = prop.executable;\r\n        this.mAdd.enable = (this.mSceneType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].SceneTypeEnum.EDIT_SCENE_TYPE || this.mEnableEdit);\r\n        if (this.categoryType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR) {\r\n            this.saveBtn.enable = true;\r\n            this.resetBtn.enable = true;\r\n        }\r\n        else {\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_7__["Url"].getOsdRes(prop.display.texturePath);\r\n            this.mDetailDisplay.loadUrl(url);\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onSelectSubCategoryHandler = function (gameobject) {\r\n        var type = gameobject.getData("type");\r\n        if (type) {\r\n            if (type === "seachBtn") {\r\n                this.onSeachHandler(this.mSeachInput.seachText);\r\n            }\r\n            else if (type === "label") {\r\n                this.mSeachInput.showInputPanel();\r\n            }\r\n            return;\r\n        }\r\n        // if (!(gameobject instanceof TextButton)) {\r\n        //   return;\r\n        // }\r\n        var category = gameobject.getData("item");\r\n        if (category) {\r\n            if (this.mPreCategoryBtn && (this.mPreCategoryBtn instanceof _Market_TextButton__WEBPACK_IMPORTED_MODULE_6__["TextButton"])) {\r\n                this.mPreCategoryBtn.changeNormal();\r\n            }\r\n            if (gameobject instanceof _Market_TextButton__WEBPACK_IMPORTED_MODULE_6__["TextButton"])\r\n                gameobject.changeDown();\r\n            var key = category.key;\r\n            if (key === this.seachKey) {\r\n                this.showSeach(gameobject);\r\n            }\r\n            else {\r\n                if (this.mPreCategoryBtn) {\r\n                    var preBtn = this.mPreCategoryBtn.getData("item");\r\n                    key = preBtn.key;\r\n                    if (key === this.seachKey) {\r\n                        this.closeSeach(gameobject);\r\n                    }\r\n                }\r\n                else {\r\n                    this.closeSeach(gameobject);\r\n                }\r\n                this.mSelectedCategeories = category;\r\n                this.queryPackege();\r\n            }\r\n            this.mPreCategoryBtn = gameobject;\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n    };\r\n    FurniBagPanel.prototype.queryPackege = function () {\r\n        if (this.mSelectedCategeories) {\r\n            this.emit("queryPackage", this.mSelectedCategeories.key);\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onSelectItemHandler = function (cell) {\r\n        var item = cell.getData("item");\r\n        this.mDetailBubble.setProp(item);\r\n        this.mDetailBubble.y = this.mShelfContainer.y - 10 * this.dpr - this.mDetailBubble.height;\r\n        if (item) {\r\n            this.replaceSelectItem(item);\r\n            this.setSelectedItem(item);\r\n            this.mPropGrid.refresh();\r\n        }\r\n        else {\r\n            if (this.categoryType !== pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR && this.mSelectedItemData.length === 0) {\r\n                this.sellBtn.enable = false;\r\n                this.useBtn.enable = false;\r\n                this.mAdd.enable = false;\r\n                this.saveBtn.enable = false;\r\n                this.resetBtn.enable = false;\r\n                this.mDetailDisplay.setTexture(this.key, "ghost");\r\n                this.mDetailDisplay.setNearest();\r\n            }\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onSeachHandler = function (val) {\r\n        if (this.mSelectedCategeories && val.length > 0) {\r\n            this.emit("seachPackage", val, this.mSelectedCategeories.key);\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onAddFurniToSceneHandler = function () {\r\n        if (!this.mSelectedItemData) {\r\n            return;\r\n        }\r\n        this.emit("addFurniToScene", this.mSelectedItemData[0].id);\r\n    };\r\n    FurniBagPanel.prototype.onTopCategoryHandler = function (item) {\r\n        var categoryType = item.getData("data");\r\n        var width = this.scaleWidth;\r\n        this.mSelectedItemData.length = 0;\r\n        // this.mDetailDisplay.setTexture(this.key, "ghost");\r\n        // this.mDetailDisplay.setNearest();\r\n        if (categoryType) {\r\n            this.onSelectedCategory(categoryType);\r\n            if (categoryType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_FURNITURE) {\r\n                this.sellBtn.visible = true;\r\n                this.mAdd.visible = true;\r\n                this.useBtn.visible = false;\r\n                this.saveBtn.visible = false;\r\n                this.resetBtn.visible = false;\r\n            }\r\n            else if (categoryType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR) {\r\n                this.sellBtn.visible = false;\r\n                this.saveBtn.visible = true;\r\n                this.resetBtn.visible = true;\r\n                this.useBtn.visible = false;\r\n                this.mAdd.visible = false;\r\n            }\r\n            else {\r\n                this.sellBtn.visible = true;\r\n                this.useBtn.visible = true;\r\n                this.mAdd.visible = false;\r\n                this.saveBtn.visible = false;\r\n                this.resetBtn.visible = false;\r\n            }\r\n        }\r\n        this.layoutTopBtn(item);\r\n    };\r\n    FurniBagPanel.prototype.layoutTopBtn = function (button) {\r\n        var width = this.scene.cameras.main.width;\r\n        var zoom = this.mWorld.uiScale;\r\n        var allRadiu = 0;\r\n        for (var _i = 0, _a = this.topBtns; _i < _a.length; _i++) {\r\n            var btn = _a[_i];\r\n            allRadiu += btn.width;\r\n        }\r\n        allRadiu /= 2;\r\n        var offsetX = width * 0.5 - allRadiu;\r\n        for (var _b = 0, _c = this.topBtns; _b < _c.length; _b++) {\r\n            var btn = _c[_b];\r\n            var posY = 0;\r\n            if (btn !== button) {\r\n                btn.setTextStyle({\r\n                    fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                    fontSize: 12 * this.dpr * zoom,\r\n                    color: "#2B4BB5"\r\n                });\r\n                posY = btn.height * 0.5;\r\n            }\r\n            else {\r\n                btn.setTextStyle({\r\n                    fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                    fontSize: 16 * this.dpr * zoom,\r\n                    color: "#8B5603"\r\n                });\r\n                posY = btn.height * 0.5 + 2 * this.dpr * zoom;\r\n            }\r\n            var radiu = btn.width * 0.5;\r\n            btn.x = offsetX + radiu;\r\n            btn.y = posY;\r\n            offsetX += radiu * 2 + 12 * this.dpr * zoom;\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onSelectedCategory = function (categoryType) {\r\n        this.categoryType = categoryType;\r\n        if (categoryType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModePackageCategory.EDIT_MODE_PACKAGE_CATEGORY_AVATAR) {\r\n            this.displayAvatar();\r\n            this.emit("queryDressAvatarIDS");\r\n        }\r\n        this.emit("getCategories", categoryType);\r\n    };\r\n    FurniBagPanel.prototype.onSellBtnHandler = function () {\r\n        var _this = this;\r\n        this.mCategoryScroll.removeListen();\r\n        if (this.mSelectedItemData.length > 0) {\r\n            var data = this.mSelectedItemData[0];\r\n            var title = _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.sold");\r\n            var confirmHandler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_11__["Handler"](this, this.onSellPropsHandler, [this.categoryType]);\r\n            var cancelHandler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_11__["Handler"](this, function () {\r\n                _this.mCategoryScroll.addListen();\r\n            });\r\n            this.showPropFun({ confirmHandler: confirmHandler, data: data, cancelHandler: cancelHandler, title: title });\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onUseBtnHandler = function () {\r\n        var _this = this;\r\n        this.mCategoryScroll.removeListen();\r\n        if (this.mSelectedItemData.length > 0) {\r\n            var data = this.mSelectedItemData[0];\r\n            var title = _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.use");\r\n            var confirmHandler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_11__["Handler"](this, this.onUsePropsHandler);\r\n            var cancelHandler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_11__["Handler"](this, function () {\r\n                _this.mCategoryScroll.addListen();\r\n            });\r\n            this.showPropFun({ confirmHandler: confirmHandler, data: data, cancelHandler: cancelHandler, price: false, title: title });\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onSaveBtnHandler = function () {\r\n        if (this.mSelectedItemData.length > 0) {\r\n            var idsArr = [];\r\n            for (var _i = 0, _a = this.mSelectedItemData; _i < _a.length; _i++) {\r\n                var item = _a[_i];\r\n                idsArr.push(item.id);\r\n            }\r\n            this.emit("querySaveAvatar", idsArr);\r\n            this.queryPackege();\r\n        }\r\n    };\r\n    FurniBagPanel.prototype.onResetBtnHandler = function () {\r\n        if (this.mSelectedItemData.length > 0)\r\n            this.emit("queryResetAvatar");\r\n    };\r\n    FurniBagPanel.prototype.onSellPropsHandler = function (category, prop, count) {\r\n        this.mCategoryScroll.addListen();\r\n        this.emit("sellProps", prop, count, category);\r\n    };\r\n    FurniBagPanel.prototype.onUsePropsHandler = function (prop, count) {\r\n        this.mCategoryScroll.addListen();\r\n        this.emit("useprops", prop.id, count);\r\n    };\r\n    FurniBagPanel.prototype.showSeach = function (parent) {\r\n        this.mCategoryScroll.addItemAt(this.mSeachInput, 1);\r\n        this.mCategoryScroll.setInteractiveObject(this.mSeachInput.seachBtn);\r\n        this.mCategoryScroll.setInteractiveObject(this.mSeachInput.label);\r\n        this.updateCategeoriesLoc(true);\r\n    };\r\n    FurniBagPanel.prototype.closeSeach = function (parent) {\r\n        if (this.mSeachInput.parentContainer) {\r\n            this.mSeachInput.parentContainer.remove(this.mSeachInput);\r\n        }\r\n        this.mCategoryScroll.removeInteractiveObject(this.mSeachInput.seachBtn);\r\n        this.mCategoryScroll.removeInteractiveObject(this.mSeachInput.label);\r\n        this.updateCategeoriesLoc(false);\r\n    };\r\n    FurniBagPanel.prototype.updateCategeoriesLoc = function (inputBoo) {\r\n        var list = this.mCategoryScroll.getItemList();\r\n        var zoom = this.scale;\r\n        var h = 41 * this.dpr * zoom;\r\n        var preBtn = null;\r\n        var offset = 30 * this.dpr * zoom;\r\n        var w = this.mScene.cameras.main.width;\r\n        var tmpW = offset;\r\n        for (var i = 0; i < list.length; i++) {\r\n            var item = list[i];\r\n            if (i > 0) {\r\n                preBtn = list[i - 1];\r\n                item.x = preBtn.x + preBtn.width; // - item.width * item.originX;\r\n            }\r\n            else {\r\n                item.x = tmpW;\r\n            }\r\n            tmpW += item.width;\r\n        }\r\n        this.mCategoryScroll.setAlign();\r\n    };\r\n    Object.defineProperty(FurniBagPanel.prototype, "enableEdit", {\r\n        get: function () {\r\n            return this.mEnableEdit;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    FurniBagPanel.prototype.showPropFun = function (config) {\r\n        var uimanager = this.mWorld.uiManager;\r\n        uimanager.showMed("PicPropFun", config);\r\n    };\r\n    return FurniBagPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar SeachInput = /** @class */ (function (_super) {\r\n    __extends(SeachInput, _super);\r\n    function SeachInput(scene, world, key, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mWorldService = world;\r\n        _this.bg = scene.make.image({\r\n            key: key,\r\n            frame: "seach_bg"\r\n        }, false).setOrigin(0.5, 0.5);\r\n        // this.mLabelInput = new LabelInput(this.scene, {\r\n        //   x: -10 * dpr,\r\n        //   y: 0,\r\n        //   width: 160,\r\n        //   height: 60,\r\n        //   fontSize: 14 * dpr + "px",\r\n        //   color: "#666666",\r\n        // });\r\n        _this.mLabelInput = _this.scene.make.text({\r\n            x: 0,\r\n            width: _this.bg.width,\r\n            height: _this.bg.height,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * dpr,\r\n                wordWrap: { width: 200, useAdvancedWrap: true },\r\n            }\r\n        }, false).setData("type", "label").setOrigin(0, 0.5);\r\n        _this.mLabelInput.setSize(_this.bg.width, _this.bg.height);\r\n        _this.mLabelInput.setInteractive();\r\n        _this.mSeachBtn = scene.make.image({\r\n            key: key,\r\n            frame: "seach_normal"\r\n        }, false).setData("type", "seachBtn");\r\n        _this.mLabelInput.x = -_this.bg.width / 2 + 6 * dpr * world.uiScale;\r\n        _this.mSeachBtn.x = _this.bg.width / 2 - _this.mSeachBtn.width,\r\n            _this.add([_this.bg, _this.mLabelInput, _this.mSeachBtn]);\r\n        _this.disableInteractive();\r\n        _this.setSize(_this.bg.width, _this.bg.height);\r\n        return _this;\r\n    }\r\n    SeachInput.prototype.showInputPanel = function () {\r\n        if (this.mInputText) {\r\n            return;\r\n        }\r\n        this.mInputText = new _components_input_panel__WEBPACK_IMPORTED_MODULE_8__["InputPanel"](this.scene, this.mWorldService, this.mLabelInput.text);\r\n        this.mInputText.once("close", this.sendChat, this);\r\n    };\r\n    SeachInput.prototype.sendChat = function (val) {\r\n        this.mInputText.destroy();\r\n        this.mInputText = null;\r\n        this.mLabelInput.setText(val);\r\n        this.mLabelInput.setSize(this.bg.width, this.bg.height);\r\n    };\r\n    Object.defineProperty(SeachInput.prototype, "seachBtn", {\r\n        get: function () {\r\n            return this.mSeachBtn;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SeachInput.prototype, "label", {\r\n        get: function () {\r\n            return this.mLabelInput;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SeachInput.prototype, "seachText", {\r\n        get: function () {\r\n            return this.mLabelInput.text;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return SeachInput;\r\n}(Phaser.GameObjects.Container));\r\nvar DetailBubble = /** @class */ (function (_super) {\r\n    __extends(DetailBubble, _super);\r\n    function DetailBubble(scene, key, dpr, zoom) {\r\n        if (zoom === void 0) { zoom = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.mDetailBubble = _this.scene.make.graphics(undefined, false);\r\n        var bubbleW = 100 * dpr * zoom;\r\n        var bubbleH = 96 * dpr * zoom;\r\n        _this.mDetailBubble = _this.scene.make.graphics(undefined, false);\r\n        _this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        _this.mDetailBubble.fillRoundedRect(0, 0, bubbleW, bubbleH);\r\n        _this.mNickName = _this.scene.make.text({\r\n            x: 7 * _this.dpr,\r\n            y: 9 * _this.dpr,\r\n            text: "背包里空空如也",\r\n            style: {\r\n                fontSize: 12 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                color: "#FFFF00",\r\n                align: "center"\r\n            }\r\n        });\r\n        _this.mPriceText = _this.scene.make.text({\r\n            x: 7 * _this.dpr,\r\n            y: 28 * _this.dpr,\r\n            text: "不可交易",\r\n            style: {\r\n                fontSize: 10 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                color: "#DC143C",\r\n                align: "center"\r\n            }\r\n        });\r\n        _this.mSource = _this.scene.make.text({\r\n            x: 8 * dpr,\r\n            y: 47 * dpr,\r\n            text: "可通过商城购物获得",\r\n            style: {\r\n                fontSize: 10 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n            }\r\n        }, false);\r\n        _this.mDesText = _this.scene.make.text({\r\n            x: 8 * dpr,\r\n            y: 66 * dpr,\r\n            style: {\r\n                color: "#32347b",\r\n                fontSize: 10 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 90 * dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false);\r\n        _this.add([_this.mDetailBubble, _this.mNickName, _this.mDesText, _this.mSource, _this.mPriceText]);\r\n        _this.setSize(bubbleW, bubbleH);\r\n        return _this;\r\n    }\r\n    DetailBubble.prototype.setProp = function (prop) {\r\n        if (!prop) {\r\n            this.mNickName.setText("背包里空空如也");\r\n            this.mPriceText.text = "";\r\n            this.mSource.text = "";\r\n            this.mDesText.text = "";\r\n            this.resize();\r\n        }\r\n        else {\r\n            this.mNickName.setText(prop.shortName || prop.name);\r\n            var posY = 9 * this.dpr;\r\n            var offsetY = 21 * this.dpr;\r\n            // this.mDesText.setText(prop.des);\r\n            if (prop.recyclable) {\r\n                posY += offsetY;\r\n                this.mPriceText.y = posY;\r\n                this.mPriceText.setText("\\u53EF\\u552E\\u51FA\\uFF1A" + prop.sellingPrice.price + " \\u94F6\\u5E01");\r\n            }\r\n            else {\r\n                posY += offsetY;\r\n                this.mPriceText.y = posY;\r\n                this.mPriceText.setText("\\u4E0D\\u53EF\\u552E\\u51FA");\r\n            }\r\n            // if (prop.tradable) {\r\n            //   this.mPriceText.setText(`可交易`);\r\n            // }\r\n            if (prop.source) {\r\n                this.mSource.setText("\\u6765\\u6E90\\uFF1A " + prop.source);\r\n                posY += offsetY;\r\n                this.mSource.y = posY;\r\n            }\r\n            else {\r\n                this.mSource.setText("");\r\n            }\r\n            var offset = 15 * this.dpr;\r\n            var width = this.getMaxWidth(offset);\r\n            if (prop.des) {\r\n                posY += offsetY;\r\n                this.mDesText.setWordWrapWidth(width - offset, true);\r\n                this.mDesText.setText(prop.des);\r\n                this.mDesText.y = posY;\r\n            }\r\n            else {\r\n                this.mDesText.setText("");\r\n            }\r\n            this.resize(width);\r\n        }\r\n        return this;\r\n    };\r\n    DetailBubble.prototype.resize = function (w, h) {\r\n        if (w === undefined)\r\n            w = this.width;\r\n        var bubbleH = this.mDesText.height + 80 * this.dpr;\r\n        if (w === this.width && bubbleH === this.height) {\r\n            return;\r\n        }\r\n        this.mDetailBubble.clear();\r\n        this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        this.mDetailBubble.fillRoundedRect(0, 0, w, bubbleH);\r\n        this.setSize(w, bubbleH);\r\n        // this.mDetailBubbleContainer.y = this.height - this.y - this.mDetailBubbleContainer.height - 6 * this.dpr;\r\n    };\r\n    DetailBubble.prototype.getMaxWidth = function (offset) {\r\n        if (offset === void 0) { offset = 0; }\r\n        var width = 100 * this.dpr;\r\n        var maxWidth = 0;\r\n        if (maxWidth < this.mNickName.width)\r\n            maxWidth = this.mNickName.width;\r\n        if (maxWidth < this.mPriceText.width)\r\n            maxWidth = this.mPriceText.width;\r\n        if (maxWidth < this.mSource.width)\r\n            maxWidth = this.mSource.width;\r\n        if (width - maxWidth < offset)\r\n            maxWidth += offset + ((maxWidth - width) >= 0 ? 0 : (maxWidth - width));\r\n        if (maxWidth < width)\r\n            maxWidth = width;\r\n        return maxWidth;\r\n    };\r\n    return DetailBubble;\r\n}(Phaser.GameObjects.Container));\r\nvar Item = /** @class */ (function (_super) {\r\n    __extends(Item, _super);\r\n    function Item(scene, x, y, key, dpr, zoom) {\r\n        if (zoom === void 0) { zoom = 1; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = dpr;\r\n        _this.zoom = zoom;\r\n        var background = scene.make.image({\r\n            key: key,\r\n            frame: "grid_bg"\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        _this.setSize(background.width, background.height);\r\n        _this.selectbg = scene.make.image({\r\n            key: key,\r\n            frame: "grid_choose"\r\n        }, false).setOrigin(0).setScale(zoom).setPosition(-2 * dpr * zoom, -2 * dpr * zoom);\r\n        _this.selectIcon = scene.make.image({\r\n            key: key,\r\n            frame: "selected"\r\n        }, false).setOrigin(1).setScale(zoom).setPosition(_this.width, _this.height);\r\n        _this.mPropImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.mPropImage.scale = dpr * zoom;\r\n        _this.mCounter = scene.make.text({\r\n            x: _this.width - 4 * dpr,\r\n            y: _this.height + 2 * dpr,\r\n            style: {\r\n                fontSize: 12 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(1);\r\n        _this.add([background, _this.selectbg, _this.selectIcon]);\r\n        _this.isSelect = false;\r\n        _this.isEquip = false;\r\n        return _this;\r\n        // this.setInteractive(new Phaser.Geom.Rectangle(0, 0, background.width, background.height), Phaser.Geom.Rectangle.Contains);\r\n        // this.on("pointerup", this.onSelectedHandler, this);\r\n    }\r\n    Item.prototype.setProp = function (prop) {\r\n        this.mProp = prop;\r\n        this.isSelect = false;\r\n        if (!prop) {\r\n            // this.mPropImage.setFrame("");\r\n            this.mCounter.setText("");\r\n            this.remove(this.mPropImage);\r\n            return;\r\n        }\r\n        this.mPropImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_7__["Url"].getOsdRes(prop.display.texturePath), this, this.onPropLoadCompleteHandler);\r\n        this.add(this.mPropImage);\r\n        if (prop.count > 1) {\r\n            this.mCounter.setText(prop.count.toString());\r\n            this.add(this.mCounter);\r\n        }\r\n        else {\r\n            if (this.mCounter.parentContainer)\r\n                this.remove(this.mCounter);\r\n        }\r\n    };\r\n    Item.prototype.onPropLoadCompleteHandler = function () {\r\n        if (this.mPropImage && this.mPropImage.texture) {\r\n            var texture = this.mPropImage.texture;\r\n            // this.mPropImage.setPosition((this.mPropImage.width) / 2, (this.mPropImage.height) / 2);\r\n            this.mPropImage.x = this.width + 3 * this.dpr * this.zoom >> 1;\r\n            this.mPropImage.y = this.height + 3 * this.dpr * this.zoom >> 1;\r\n            this.mPropImage.displayHeight = 45 * this.dpr;\r\n            this.mPropImage.scaleX = this.mPropImage.scaleY;\r\n            if (texture) {\r\n                texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(Item.prototype, "isSelect", {\r\n        set: function (value) {\r\n            this.selectbg.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Item.prototype, "isEquip", {\r\n        set: function (value) {\r\n            this.selectIcon.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Item.prototype.onSelectedHandler = function () {\r\n        this.emit("select", this.mProp);\r\n    };\r\n    return Item;\r\n}(Phaser.GameObjects.Container));\r\nvar ItemsPopPanel = /** @class */ (function (_super) {\r\n    __extends(ItemsPopPanel, _super);\r\n    function ItemsPopPanel(scene, x, y, key, commonKey, dpr, zoom) {\r\n        if (zoom === void 0) { zoom = 1; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.itemCount = 1;\r\n        _this.popState = 0; // 0 卖出 1 使用\r\n        var bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_10__["NinePatch"](_this.scene, 0, 0, 286 * dpr * zoom, 331 * dpr * zoom, commonKey, "bg", {\r\n            top: 40,\r\n            bottom: 40\r\n        });\r\n        _this.blackBg = _this.scene.make.graphics(undefined, false);\r\n        _this.blackBg.clear();\r\n        _this.blackBg.fillStyle(0, 0.5);\r\n        var w = _this.scene.cameras.main.width / _this.scale;\r\n        var h = _this.scene.cameras.main.height / _this.scale;\r\n        _this.blackBg.fillRect(-w / 2, -h / 2, w, h);\r\n        bg.setInteractive(new Phaser.Geom.Rectangle(0, 0, w, h), Phaser.Geom.Rectangle.Contains);\r\n        var posY = -bg.height * 0.5 + 3 * dpr * zoom;\r\n        var titlebg = _this.scene.make.image({ x: 0, y: posY, key: key, frame: "title" });\r\n        _this.titleName = scene.make.text({\r\n            x: 0,\r\n            y: posY + 3 * dpr * zoom,\r\n            text: "售出",\r\n            style: {\r\n                color: "#905B06",\r\n                fontSize: 15 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        _this.titleName.setFontStyle("bold");\r\n        _this.itemName = scene.make.text({\r\n            x: 0,\r\n            y: posY + 40 * dpr * zoom,\r\n            style: {\r\n                color: "#000000",\r\n                fontSize: 15 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var iconOffset = -56 * dpr * zoom;\r\n        var iconBg = _this.scene.make.image({ x: 0, y: iconOffset, key: key, frame: "sell_bg" });\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](_this.scene, 0, iconOffset);\r\n        _this.icon.scale = dpr * zoom;\r\n        var priceOffset = 10 * dpr * zoom;\r\n        _this.priceBg = _this.scene.make.image({ x: 0, y: priceOffset, key: commonKey, frame: "price_bg" });\r\n        _this.pricText = scene.make.text({\r\n            x: 0,\r\n            y: priceOffset,\r\n            style: {\r\n                color: "#FFFFFF",\r\n                fontSize: 15 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        // this.pricText.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.priceBg.width, this.priceBg.height),Phaser.Geom.Rectangle.Contains);\r\n        var countOffsetY = 50 * dpr * zoom;\r\n        var countOffsetX = -58 * dpr * zoom;\r\n        var countBg = _this.scene.make.image({ x: 0, y: countOffsetY, key: commonKey, frame: "input_bg" });\r\n        _this.itemCountText = scene.make.text({\r\n            x: 0,\r\n            y: countOffsetY,\r\n            style: {\r\n                color: "#0771AC",\r\n                fontSize: 15 * dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var minusBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_12__["Button"](_this.scene, commonKey, "reduce", "reduce");\r\n        var addBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_12__["Button"](_this.scene, commonKey, "increase", "increase");\r\n        minusBtn.x = countOffsetX;\r\n        minusBtn.y = countOffsetY;\r\n        addBtn.x = -countOffsetX;\r\n        addBtn.y = countOffsetY;\r\n        var bottomOffsetY = bg.height * 0.5 - 50 * dpr * zoom;\r\n        var bottomOffsetX = -66 * dpr * zoom;\r\n        var cancelBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_16__["NineSliceButton"](_this.scene, bottomOffsetX, bottomOffsetY, 112 * dpr * zoom, 40 * dpr * zoom, commonKey, "red_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("common.cancel"), dpr, zoom, {\r\n            left: 12 * dpr * zoom,\r\n            top: 12 * dpr * zoom,\r\n            right: 12 * dpr * zoom,\r\n            bottom: 12 * dpr * zoom\r\n        });\r\n        var confirmBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_16__["NineSliceButton"](_this.scene, -bottomOffsetX, bottomOffsetY, 112 * dpr * zoom, 40 * dpr * zoom, commonKey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("common.confirm"), dpr, zoom, {\r\n            left: 12 * dpr * zoom,\r\n            top: 12 * dpr * zoom,\r\n            right: 12 * dpr * zoom,\r\n            bottom: 12 * dpr * zoom\r\n        });\r\n        cancelBtn.setTextStyle({\r\n            color: "#FFFFFF",\r\n            fontSize: 16 * dpr * zoom,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n        });\r\n        confirmBtn.setTextStyle({\r\n            color: "#976400",\r\n            fontSize: 16 * dpr * zoom,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT\r\n        });\r\n        _this.add([_this.blackBg, bg, titlebg, _this.titleName, _this.itemName, iconBg, _this.icon, _this.priceBg, _this.pricText, countBg, _this.itemCountText, minusBtn, addBtn, cancelBtn, confirmBtn]);\r\n        minusBtn.on("Tap", _this.onMinusBtnHandler, _this);\r\n        addBtn.on("Tap", _this.onAddBtnHandler, _this);\r\n        cancelBtn.on("Tap", _this.onCancelBtnHandler, _this);\r\n        confirmBtn.on("Tap", _this.onConfirmBtnHandler, _this);\r\n        return _this;\r\n    }\r\n    ItemsPopPanel.prototype.setProp = function (prop, stated, category, handler) {\r\n        this.itemData = prop;\r\n        this.itemCount = 1;\r\n        this.icon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_7__["Url"].getOsdRes(prop.display.texturePath), this, this.onPropLoadCompleteHandler);\r\n        this.itemName.text = prop.name || prop.shortName;\r\n        this.pricText.text = prop.sellingPrice.price * this.itemCount + "  银币";\r\n        this.itemCountText.text = this.itemCount + "";\r\n        this.popState = stated;\r\n        if (stated === 0) {\r\n            this.titleName.text = _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.sold");\r\n            this.pricText.visible = true;\r\n            this.priceBg.visible = true;\r\n        }\r\n        else {\r\n            this.titleName.text = _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("furni_bag.use");\r\n            this.pricText.visible = false;\r\n            this.priceBg.visible = false;\r\n        }\r\n        this.handler = handler;\r\n        this.category = category;\r\n    };\r\n    ItemsPopPanel.prototype.onMinusBtnHandler = function () {\r\n        if (this.itemCount === 1)\r\n            return;\r\n        this.itemCount--;\r\n        this.updateData();\r\n    };\r\n    ItemsPopPanel.prototype.onAddBtnHandler = function () {\r\n        if (this.itemCount === this.itemData.count)\r\n            return;\r\n        this.itemCount++;\r\n        this.updateData();\r\n    };\r\n    ItemsPopPanel.prototype.updateData = function () {\r\n        this.itemCountText.text = this.itemCount + "";\r\n        this.pricText.text = this.itemData.sellingPrice.price * this.itemCount + "  银币";\r\n    };\r\n    ItemsPopPanel.prototype.onCancelBtnHandler = function () {\r\n        this.emit("itempopclose");\r\n        if (this.parentContainer)\r\n            this.parentContainer.remove(this);\r\n    };\r\n    ItemsPopPanel.prototype.onConfirmBtnHandler = function () {\r\n        this.emit("itempopclose");\r\n        if (this.parentContainer)\r\n            this.parentContainer.remove(this);\r\n        if (this.handler)\r\n            this.handler.runWith([this.itemData, this.itemCount, this.category]);\r\n    };\r\n    ItemsPopPanel.prototype.onPropLoadCompleteHandler = function () {\r\n        if (this.icon && this.icon.texture) {\r\n            var texture = this.icon.texture;\r\n            if (texture) {\r\n                texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n            }\r\n        }\r\n    };\r\n    return ItemsPopPanel;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/FurniBag/FurniBagPanel.ts?')},"./src/ui/InfoPanel/InfoPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InfoPanel", function() { return InfoPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/textarea/TextArea */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _InfoPanelMediator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./InfoPanelMediator */ "./src/ui/InfoPanel/InfoPanelMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar GetValue = Phaser.Utils.Objects.GetValue;\r\nvar InfoPanel = /** @class */ (function (_super) {\r\n    __extends(InfoPanel, _super);\r\n    function InfoPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.mWorld = worldService;\r\n        return _this;\r\n    }\r\n    InfoPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (this.mCloseBtn)\r\n            this.mCloseBtn.on("pointerup", this.closeHandler, this);\r\n    };\r\n    InfoPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (this.mCloseBtn)\r\n            this.mCloseBtn.off("pointerup", this.closeHandler, this);\r\n    };\r\n    InfoPanel.prototype.resize = function (wid, hei) {\r\n        if (!this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        var scale = this.mWorld.uiScale;\r\n        var zoom = this.mWorld.uiRatio;\r\n        this.x = size.width >> 1;\r\n        this.y = size.height >> 1;\r\n        this.mActor.x = -this.width / 2 + 80 * scale * zoom;\r\n        this.mActor.y = -this.height / 2 + 160 * scale * zoom;\r\n        this.mNameTextArea.setMinSize(220 * this.dpr * scale, 222 * this.dpr * scale);\r\n        this.mNameTextArea.setPosition(size.width / 2 + 60 * this.dpr * scale, size.height / 2 - 110 * this.dpr * scale);\r\n        this.mNameTextArea.layout();\r\n        var textMask = this.mNameTextArea.childrenMap.text;\r\n        textMask.x = -10 * this.dpr * scale;\r\n        textMask.y = -200 * this.dpr * scale;\r\n        this.mAttributesTextArea.setMinSize(360 * this.dpr * scale, 180 * this.dpr * scale);\r\n        this.mAttributesTextArea.setPosition(size.width / 2 + 3 * this.dpr * scale, size.height / 2 + 95 * this.dpr * scale);\r\n        this.mAttributesTextArea.layout();\r\n        var attributesMask = this.mAttributesTextArea.childrenMap.text;\r\n        attributesMask.x = -this.width / 2 + 30 * this.dpr * scale;\r\n        attributesMask.y = 5 * this.dpr * scale;\r\n    };\r\n    InfoPanel.prototype.show = function (param) {\r\n        if (this.mShow)\r\n            return;\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized) {\r\n            var size = this.mWorld.getSize();\r\n            this.setData("data", param);\r\n            this.setInfo(param);\r\n            this.resize(size.width, size.height);\r\n        }\r\n    };\r\n    InfoPanel.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    InfoPanel.prototype.setInfo = function (data) {\r\n        var _this = this;\r\n        if (!this.mInitialized || !data)\r\n            return;\r\n        if (data.actors) {\r\n            if (data.actors.length === 0) {\r\n                return;\r\n            }\r\n            var actor = data.actors[0];\r\n            this.mWorld.httpService.userDetail(actor.platformId).then(function (response) {\r\n                if (response.code === 200) {\r\n                    var resData = response.data;\r\n                    if (resData) {\r\n                        _this.mActor.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Url"].getOsdRes("show/" + resData.username + ".png"), _this, undefined, _this.loadDefaultAvatar);\r\n                        // this.mNickName.setText(resData.nickname);\r\n                        // this.mLv.setText(resData.level);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        var text = data.text;\r\n        if (text[0]) {\r\n            this.mNameTextArea.setText(this.checkValue(text[0]));\r\n        }\r\n        if (text[1]) {\r\n            this.mAttributesTextArea.setText(this.checkValue(text[1]));\r\n        }\r\n    };\r\n    InfoPanel.prototype.destroy = function () {\r\n        if (this.mActor) {\r\n            this.mActor.destroy(true);\r\n            this.mActor = null;\r\n        }\r\n        if (this.mNameTextArea) {\r\n            this.mNameTextArea.destroy();\r\n            this.mNameTextArea = null;\r\n        }\r\n        if (this.mAttributesTextArea) {\r\n            this.mAttributesTextArea.destroy();\r\n            this.mAttributesTextArea = null;\r\n        }\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InfoPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Border"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Background"].getPNG());\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["BlueButton"].getJSON());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    InfoPanel.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        var scale = this.mWorld.uiScale;\r\n        this.setSize(400 * this.dpr * scale, 500 * this.dpr * scale);\r\n        var background = new _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_6__["default"](this.scene, {\r\n            width: this.width,\r\n            height: this.height,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Background"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Background"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Background"].getRows()\r\n        });\r\n        var border = new _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_6__["default"](this.scene, {\r\n            width: this.width - 20 * this.dpr * scale,\r\n            height: this.height - 20 * this.dpr * scale,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Border"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Border"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Border"].getRows()\r\n        });\r\n        this.mNameBBCodeText = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, 0, 0, "", {\r\n            fontSize: 14 * this.dpr * scale + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT,\r\n            textMask: false,\r\n            wrap: {\r\n                mode: "char",\r\n                width: 270 * this.dpr * scale\r\n            }\r\n        });\r\n        this.mNameTextArea = new _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, {\r\n            x: this.width / 2 - 80 * scale * this.dpr,\r\n            y: -75 * scale * this.dpr,\r\n            textWidth: 270 * this.dpr * scale,\r\n            textHeight: 180 * this.dpr * scale,\r\n            textMask: true,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            text: this.mNameBBCodeText,\r\n        })\r\n            .layout();\r\n        this.mAttributesBBCodeText = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, 0, 0, "", {\r\n            fontSize: 14 * this.dpr * scale + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT,\r\n            textMask: false,\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.width - 30 * this.dpr * scale\r\n            }\r\n        });\r\n        this.mAttributesTextArea = new _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, {\r\n            x: size.width / 2 + 3 * this.dpr * scale,\r\n            y: size.height / 2 + 95 * this.dpr * scale,\r\n            textMask: true,\r\n            textWidth: this.width - 60 * this.dpr * scale,\r\n            textHeight: 180 * this.dpr * scale,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            text: this.mAttributesBBCodeText,\r\n        })\r\n            .layout();\r\n        this.mCloseBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__["NinePatchButton"](this.scene, 258, 145, 80, 34, _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["BlueButton"].getName(), "", "关闭", _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["BlueButton"].getConfig());\r\n        this.mCloseBtn.x = 0;\r\n        this.mCloseBtn.y = this.height - 100 * this.mWorld.uiRatio * scale >> 1;\r\n        this.mCloseBtn.setTextStyle({ font: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].YAHEI_16_BOLD });\r\n        this.mActor = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, 300, 125).setOrigin(0.5, 1);\r\n        this.mActor.scale = 2;\r\n        this.mWorld.uiManager.getMediator(_InfoPanelMediator__WEBPACK_IMPORTED_MODULE_8__["InfoPanelMediator"].NAME).resize();\r\n        this.add([background, border,\r\n            this.mNameBBCodeText, this.mAttributesBBCodeText, this.mCloseBtn, this.mActor]);\r\n        // this.mAttributesTextArea, this.mAttributesBBCodeText,this.mNameTextArea, this.mNameTextArea,\r\n        this.addListen();\r\n        _super.prototype.init.call(this);\r\n        this.setInfo(this.getData("data"));\r\n    };\r\n    InfoPanel.prototype.closeHandler = function (pointer) {\r\n        if (this.checkPointerDis(pointer)) {\r\n            this.hide();\r\n        }\r\n    };\r\n    InfoPanel.prototype.checkPointerDis = function (pointer) {\r\n        if (!this.mWorld)\r\n            return true;\r\n        return Math.abs(pointer.downX - pointer.upX) < 10 * this.mWorld.uiRatio * this.mWorld.uiScale ||\r\n            Math.abs(pointer.downY - pointer.upY) < 10 * this.mWorld.uiRatio * this.mWorld.uiScale;\r\n    };\r\n    InfoPanel.prototype.loadDefaultAvatar = function () {\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Url"].getOsdRes("show/avatar_default.png");\r\n        if (this.scene.textures.exists(url)) {\r\n            this.mActor.setTexture(url);\r\n            return;\r\n        }\r\n        this.mActor.load(url);\r\n    };\r\n    InfoPanel.prototype.checkValue = function (data) {\r\n        return GetValue(data, "text", "");\r\n    };\r\n    return InfoPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InfoPanel/InfoPanel.ts?')},"./src/ui/InfoPanel/InfoPanelMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InfoPanelMediator", function() { return InfoPanelMediator; });\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _InfoPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InfoPanel */ "./src/ui/InfoPanel/InfoPanel.ts");\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/tool */ "./src/utils/tool.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar InfoPanelMediator = /** @class */ (function (_super) {\r\n    __extends(InfoPanelMediator, _super);\r\n    function InfoPanelMediator(mLayerManager, mScene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mLayerManager = mLayerManager;\r\n        _this.mScene = mScene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    InfoPanelMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    InfoPanelMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    InfoPanelMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    InfoPanelMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize();\r\n    };\r\n    InfoPanelMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!param || param.length === 0) {\r\n            return;\r\n        }\r\n        this.mView = new _InfoPanel__WEBPACK_IMPORTED_MODULE_1__["InfoPanel"](this.mScene, this.world);\r\n        this.mView.show(param[0]);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    InfoPanelMediator.prototype.destroy = function () {\r\n        if (this.mView)\r\n            this.mView.destroy();\r\n    };\r\n    InfoPanelMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    InfoPanelMediator.prototype.onClosePanel = function (pointer) {\r\n        if (_utils_tool__WEBPACK_IMPORTED_MODULE_2__["Tool"].checkPointerContains(this.mView, pointer))\r\n            return;\r\n        this.hide();\r\n    };\r\n    InfoPanelMediator.NAME = "InfoPanelMediator";\r\n    return InfoPanelMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InfoPanel/InfoPanelMediator.ts?')},"./src/ui/InteractivePanel/InteractivePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractivePanel", function() { return InteractivePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _components_radio__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/radio */ "./src/ui/components/radio.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./InteractivePanelMediator */ "./src/ui/InteractivePanel/InteractivePanelMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/textarea/TextArea */ "./lib/rexui/lib/ui/textarea/TextArea.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar InteractivePanel = /** @class */ (function (_super) {\r\n    __extends(InteractivePanel, _super);\r\n    function InteractivePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mRadioCom = false;\r\n        _this.mLeftBaseScaleX = 1;\r\n        _this.mLeftBaseScaleY = 1;\r\n        _this.mMidBaseScaleX = 1;\r\n        _this.mMidBaseScaleY = 1;\r\n        _this.mRightBaseScaleX = 1;\r\n        _this.mRightBaseScaleY = 1;\r\n        _this.mDisDelection = 10;\r\n        // this.setEnabled(false);\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    /**\r\n     * 通過參數進行ui佈局\r\n     * @param param\r\n     * @param radioClick\r\n     */\r\n    InteractivePanel.prototype.show = function (param) {\r\n        var _this = this;\r\n        _super.prototype.show.call(this, param);\r\n        var size = this.mWorld.getSize();\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShow = true;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        var data = this.mShowData[0];\r\n        if (this.mLeftFaceIcon)\r\n            this.mLeftFaceIcon.visible = false;\r\n        if (this.mRightFaceIcon)\r\n            this.mRightFaceIcon.visible = false;\r\n        if (this.mMidFaceIcon)\r\n            this.mMidFaceIcon.visible = false;\r\n        if (data.display && data.display.length > 0) {\r\n            var uiDisplay = data.display[0];\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(uiDisplay.texturePath);\r\n            if (this.scene.cache.obj.get(url)) {\r\n                this.onLoadComplete();\r\n            }\r\n            else {\r\n                this.scene.load.image(url, url);\r\n                this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n                this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n                this.scene.load.start();\r\n            }\r\n        }\r\n        this.mDescTF.text = "";\r\n        this.mNameTF.text = "";\r\n        if (data.text) {\r\n            if (data.text.length > 0) {\r\n                var descData = data.text[0];\r\n                this.mDescCon.setData("nodeID", descData.node.id);\r\n                this.mTextArea.setText(descData.text);\r\n                // this.mDescTF.text = descData.text;\r\n                this.mDescCon.off("pointerup", this.descConClick, this);\r\n                this.mDescCon.on("pointerup", this.descConClick, this);\r\n                if (data.text[1]) {\r\n                    var nameData = data.text[1];\r\n                    this.mNameCon.setData("nodeID", nameData.node.id);\r\n                    this.mNameTF.text = nameData.text;\r\n                    this.mNameTF.x = -this.mNameTF.width >> 1;\r\n                    this.mNameCon.off("pointerup", this.nameConClick, this);\r\n                    this.mNameCon.on("pointerup", this.nameConClick, this);\r\n                }\r\n            }\r\n        }\r\n        if (this.mRadio)\r\n            this.mRadio.visible = false;\r\n        if (data.button && data.button.length > 0) {\r\n            var tmpHei = (data.button.length - 1) * 33 + 46;\r\n            if (!this.mRadio) {\r\n                this.mRadio = new _components_radio__WEBPACK_IMPORTED_MODULE_3__["Radio"](this.mScene, {\r\n                    wid: 350,\r\n                    hei: tmpHei,\r\n                    resKey: "juqing",\r\n                    resPng: "./resources/ui/juqing/juqing.png",\r\n                    resJson: "./resources/ui/juqing/juqing.json",\r\n                    resBg: "radio_bg.png",\r\n                    resArrow: "radio_arrow.png",\r\n                    fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n                    completeBack: function () {\r\n                        _this.radioComplete();\r\n                    },\r\n                    clickCallBack: function (itemShowData) {\r\n                        if (!itemShowData || !med)\r\n                            return;\r\n                        med.componentClick(itemShowData.data);\r\n                    }\r\n                });\r\n                this.radioComplete();\r\n            }\r\n            this.setRadioData(data.button);\r\n            this.mRadio.visible = true;\r\n        }\r\n        this.resize();\r\n        if (this.mShow) {\r\n            return;\r\n        }\r\n    };\r\n    InteractivePanel.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    InteractivePanel.prototype.update = function (param) {\r\n        this.show(param);\r\n    };\r\n    InteractivePanel.prototype.getRadio = function () {\r\n        return this.mRadio;\r\n    };\r\n    InteractivePanel.prototype.setRadioData = function (data) {\r\n        this.mRadio.setRadioData(data);\r\n    };\r\n    InteractivePanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        this.scale = this.mWorld.uiScale;\r\n        var size = this.mWorld.getSize();\r\n        var width = this.mWorld.getSize().width;\r\n        var height = this.mWorld.getSize().height;\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mNameCon.add(this.mNameBg);\r\n        this.mNameCon.add(this.mNameTF);\r\n        this.mDescCon.add(this.mBg);\r\n        this.mDescCon.add(this.mBorder);\r\n        this.mDescCon.add(this.mDescTF);\r\n        this.mDescCon.add(this.mTextArea);\r\n        this.add(this.mNameCon);\r\n        this.add(this.mDescCon);\r\n        this.setSize(width, height);\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.y = size.height / 2 - 250;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mBg.resize((size.width - 10) / this.mWorld.uiScale, size.height * .5 / this.mWorld.uiScale);\r\n                this.mBorder.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n            }\r\n            else {\r\n                this.mBg.resize((size.width - 10) / this.mWorld.uiScale, size.height * .5 / this.mWorld.uiScale);\r\n                this.mBorder.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n            }\r\n            this.y = this.mBg.height * 1.5 * this.mWorld.uiScale;\r\n        }\r\n        // this.y = 0;\r\n        this.x = size.width >> 1;\r\n        this.refreshUIPos();\r\n        if (this.mRadio) {\r\n            this.add(this.mRadio);\r\n        }\r\n        this.mTextArea.childrenMap.child.setMinSize(this.mBorder.width - 10 * this.dpr * zoom, this.mBorder.height - 3 * this.dpr * zoom);\r\n        this.mTextArea.layout();\r\n        this.mTextArea.setPosition(width / 2, this.y + this.mDescCon.y);\r\n        var textMask = this.mTextArea.childrenMap.text;\r\n        textMask.x = -this.mBorder.width >> 1;\r\n        textMask.y = -this.mBorder.height / 2 + 20 * this.dpr;\r\n        textMask.resize(this.mBorder.width, this.mDescTF.displayHeight + 2000);\r\n        // textMask.bottomChildOY = this.mDescTF.displayHeight + 20 * this.dpr * zoom;\r\n        this.mTextArea.scrollToBottom();\r\n        _super.prototype.resize.call(this, wid, hei);\r\n    };\r\n    // public addListen() {\r\n    // super.addListen();\r\n    // this.on("panelClick", this.panelClick, this);\r\n    // }\r\n    // public removeListen() {\r\n    //     super.removeListen();\r\n    //     this.off("panelClick", this.panelClick, this);\r\n    // }\r\n    InteractivePanel.prototype.destroy = function () {\r\n        this.mInitialized = false;\r\n        if (this.mNameCon) {\r\n            this.mNameCon.destroy(true);\r\n        }\r\n        if (this.mDescCon) {\r\n            this.mDescCon.destroy(true);\r\n        }\r\n        if (this.mLeftFaceIcon) {\r\n            this.mLeftFaceIcon.destroy(true);\r\n        }\r\n        if (this.mMidFaceIcon) {\r\n            this.mMidFaceIcon.destroy(true);\r\n        }\r\n        if (this.mRightFaceIcon) {\r\n            this.mRightFaceIcon.destroy(true);\r\n        }\r\n        if (this.mNameTF) {\r\n            this.mNameTF.destroy(true);\r\n        }\r\n        if (this.mDescTF) {\r\n            this.mDescTF.destroy(true);\r\n        }\r\n        if (this.mRadio) {\r\n            this.mRadio.destroy();\r\n        }\r\n        this.mNameCon = null;\r\n        this.mDescCon = null;\r\n        this.mLeftFaceIcon = null;\r\n        this.mMidFaceIcon = null;\r\n        this.mRightFaceIcon = null;\r\n        this.mNameTF = null;\r\n        this.mDescTF = null;\r\n        this.mRadio = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractivePanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.atlas("juqing", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/juqing/juqing.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/juqing/juqing.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    InteractivePanel.prototype.init = function () {\r\n        var width = this.mWorld.getSize().width;\r\n        var height = this.mWorld.getSize().height;\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        this.mNameCon = this.mScene.make.container(undefined, false);\r\n        this.mDescCon = this.mScene.make.container(undefined, false);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 1080, 320, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.setSize(width, height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 1040, 280, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mLeftFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mMidFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mRightFaceIcon = this.mScene.make.image(undefined, false);\r\n        this.mNameTF = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.mBorder.width\r\n            },\r\n        });\r\n        this.mNameBg = this.mScene.make.image(undefined, false);\r\n        this.mNameBg.setTexture("juqing", "juqing_name.png");\r\n        this.mDescTF = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__["default"](this.mScene, 0, 0, "", {\r\n            // width: this.mBorder.width - 20 * this.dpr * zoom,\r\n            fontSize: "20px",\r\n            halign: "left",\r\n            textMask: false,\r\n            padding: {\r\n                top: 0,\r\n                bottom: 0,\r\n                left: 8 * this.dpr * zoom,\r\n                right: 3 * this.dpr * zoom,\r\n            },\r\n            wrap: {\r\n                mode: "character",\r\n                width: this.mBorder.width - 12 * this.dpr * zoom,\r\n            },\r\n        });\r\n        this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_7__["default"](this.mScene, {\r\n            x: width / 2,\r\n            y: this.mBorder.y + this.mBorder.height / 2 + 80 * this.dpr * zoom,\r\n            width: this.mBorder.width,\r\n            height: this.mBorder.height - 20 * this.dpr * zoom,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            textWidth: this.mBorder.width - 12 * this.dpr * zoom,\r\n            textHeight: 0,\r\n            text: this.mDescTF,\r\n        })\r\n            .layout();\r\n        // const bg1 = this.mScene.make.graphics(undefined, false);\r\n        // bg1.fillStyle(0xffcc00);\r\n        // bg1.fillRect(-this.mBg.width >> 1, -this.mBg.height >> 1, this.mBg.width, this.mBg.height);\r\n        // this.mDescCon.add(bg1);\r\n        this.mDescCon.setSize(this.mBg.width, this.mBg.height);\r\n        this.mNameCon.setSize(this.mNameBg.width, this.mNameBg.height);\r\n        this.mDescCon.setInteractive();\r\n        this.mNameCon.setInteractive();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    InteractivePanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.resize();\r\n    };\r\n    // private panelClick(pointer: Phaser.Input.Pointer) {\r\n    //     if (Tool.checkPointerContains(this.mNameCon, pointer)) {\r\n    //         this.nameConClick(pointer);\r\n    //         return;\r\n    //     }\r\n    //     if (Tool.checkPointerContains(this.mDescCon, pointer)) {\r\n    //         this.descConClick(pointer);\r\n    //         return;\r\n    //     }\r\n    //     if (this.mLeftFaceIcon && Tool.checkPointerContains(this.mLeftFaceIcon, pointer)) {\r\n    //         this.leftFaceClick(pointer);\r\n    //         return;\r\n    //     }\r\n    //     if (this.mMidFaceIcon && Tool.checkPointerContains(this.mMidFaceIcon, pointer)) {\r\n    //         this.midFaceClick(pointer);\r\n    //         return;\r\n    //     }\r\n    //     if (this.mRightFaceIcon && Tool.checkPointerContains(this.mRightFaceIcon, pointer)) {\r\n    //         this.rightFaceClick(pointer);\r\n    //         return;\r\n    //     }\r\n    // }\r\n    InteractivePanel.prototype.refreshUIPos = function () {\r\n        var size = this.mWorld.getSize();\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mDescCon.setSize(this.mBg.width, this.mBg.height);\r\n        this.mNameCon.setSize(this.mNameBg.width, this.mNameBg.height);\r\n        this.mNameTF.y = -8 * this.mWorld.uiScale;\r\n        // this.mDescTF.x = -this.mBorder.width / 2;\r\n        // this.mDescTF.y = -this.mBorder.height / 2;\r\n        this.mDescCon.y = this.mWorld.game.device.os.desktop ? size.height / 2 + 80 : 0;\r\n        this.mNameCon.x = 150 - this.mDescCon.width / 2;\r\n        this.mNameCon.y = this.mDescCon.y - this.mDescCon.height / 2 - this.mNameCon.height / 2 - 10;\r\n        this.mNameTF.setWrapWidth(this.mBorder.width);\r\n        this.mDescTF.setWrapWidth(this.mBorder.width - 10 * this.dpr * zoom);\r\n        this.mNameTF.x = -this.mNameTF.width >> 1;\r\n        var desConWorldY = this.mDescCon.getWorldTransformMatrix().ty;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            var leftIconWid = this.mLeftFaceIcon.width * this.mWorld.uiScale;\r\n            var leftIconHei = this.mLeftFaceIcon.height * this.mWorld.uiScale;\r\n            var leftScale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, leftIconWid, leftIconHei);\r\n            this.mLeftFaceIcon.scaleX = this.mLeftBaseScaleX * leftScale * .7;\r\n            this.mLeftFaceIcon.scaleY = this.mLeftBaseScaleY * leftScale * .7;\r\n            this.mLeftFaceIcon.x = this.mNameCon.x;\r\n            this.mLeftFaceIcon.y = this.mNameTF.y - this.mLeftFaceIcon.height; // desConWorldY - this.mLeftFaceIcon.height / 2 - this.mDescCon.height / 2; // this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mLeftFaceIcon.height * leftScale * .7 / 2;\r\n            var midIconWid = this.mMidFaceIcon.width * this.mWorld.uiScale;\r\n            var midIconHei = this.mMidFaceIcon.height * this.mWorld.uiScale;\r\n            var midScale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, midIconWid, midIconHei);\r\n            this.mMidFaceIcon.scaleX = this.mMidBaseScaleX * midScale * .7;\r\n            this.mMidFaceIcon.scaleY = this.mMidBaseScaleY * midScale * .7;\r\n            this.mMidFaceIcon.x = 0;\r\n            this.mMidFaceIcon.y = this.mNameTF.y - this.mMidFaceIcon.height;\r\n            // this.mMidFaceIcon.y = this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mMidFaceIcon.height * midScale * .7 / 2;\r\n            var rightIconWid = this.mRightFaceIcon.width * this.mWorld.uiScale;\r\n            var rightIconHei = this.mRightFaceIcon.height * this.mWorld.uiScale;\r\n            var rightScale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, rightIconWid, rightIconHei);\r\n            this.mRightFaceIcon.scaleX = this.mRightBaseScaleX * rightScale * .7;\r\n            this.mRightFaceIcon.scaleY = this.mRightBaseScaleY * rightScale * .7;\r\n            this.mRightFaceIcon.x = -this.mNameCon.x;\r\n            this.mRightFaceIcon.y = this.mNameTF.y - this.mRightFaceIcon.height;\r\n            // this.mRightFaceIcon.y = this.mNameCon.y + this.mNameCon.height / 2 + 10 - this.mRightFaceIcon.height * rightScale * .7 / 2;\r\n        }\r\n        if (this.mRadioCom) {\r\n            if (this.mWorld.game.device.os.desktop) {\r\n                this.mRadio.x = this.mBg.x + this.mBg.width / 2 - this.mRadio.width;\r\n                this.mRadio.y = this.mDescCon.y + this.mDescCon.height / 2 - this.mRadio.height;\r\n            }\r\n            else {\r\n                this.mRadio.x = this.mBg.width / 2 - this.mRadio.width;\r\n                this.mRadio.y = this.mBg.height / 2 - this.mRadio.height;\r\n            }\r\n        }\r\n    };\r\n    InteractivePanel.prototype.getScale = function (baseWid, baseHei, curWid, curHei) {\r\n        return baseWid / curWid > baseHei / curHei ? baseWid / curWid : baseHei / curHei;\r\n    };\r\n    InteractivePanel.prototype.onLoadComplete = function () {\r\n        var size = this.mWorld.getSize();\r\n        var data = this.mShowData[0];\r\n        var uiDisplay = data.display[0];\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(uiDisplay.texturePath);\r\n        var imgX = -this.mBorder.width / 2;\r\n        var imgY = -this.mBorder.height / 2;\r\n        var scaleX = uiDisplay.scaleX;\r\n        var scaleY = uiDisplay.scaleY;\r\n        var scale = 1;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        switch (uiDisplay.horizontal) {\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_LEFT:\r\n                this.mLeftFaceIcon.setTexture(url);\r\n                this.mLeftFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mLeftBaseScaleX = scaleX;\r\n                this.mLeftBaseScaleY = scaleY;\r\n                scale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, this.mLeftFaceIcon.width, this.mLeftFaceIcon.height);\r\n                this.mLeftFaceIcon.scaleX = scaleX * scale;\r\n                this.mLeftFaceIcon.scaleY = scaleY * scale;\r\n                this.mLeftFaceIcon.x = imgX + 200;\r\n                // this.mLeftFaceIcon.y = desConWorldY - this.mLeftFaceIcon.height / 2;\r\n                // this.mLeftFaceIcon.y = imgY + this.mLeftFaceIcon.height / 4;\r\n                this.mLeftFaceIcon.setInteractive();\r\n                this.addAt(this.mLeftFaceIcon, 0);\r\n                this.mLeftFaceIcon.visible = true;\r\n                this.mLeftFaceIcon.off("pointerup", this.leftFaceClick, this);\r\n                this.mLeftFaceIcon.on("pointerup", this.leftFaceClick, this);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_CENTER:\r\n                this.mMidFaceIcon.setTexture(url);\r\n                this.mMidFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mMidBaseScaleX = scaleX;\r\n                this.mMidBaseScaleY = scaleY;\r\n                scale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, this.mMidFaceIcon.width, this.mMidFaceIcon.height);\r\n                this.mMidFaceIcon.scaleX = scaleX * scale;\r\n                this.mMidFaceIcon.scaleY = scaleY * scale;\r\n                this.mMidFaceIcon.x = 0;\r\n                // this.mMidFaceIcon.y = desConWorldY - this.mMidFaceIcon.height / 2;\r\n                // this.mMidFaceIcon.y = imgY + this.mMidFaceIcon.height / 4;\r\n                this.addAt(this.mMidFaceIcon, 0);\r\n                this.mMidFaceIcon.visible = true;\r\n                this.mMidFaceIcon.setInteractive();\r\n                this.mLeftFaceIcon.off("pointerup", this.midFaceClick, this);\r\n                this.mMidFaceIcon.on("pointerup", this.midFaceClick, this);\r\n                break;\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].HorizontalAlignment.HORIZONTAL_RIGHT:\r\n                this.mRightFaceIcon.setTexture(url);\r\n                this.mRightFaceIcon.setData("nodeID", uiDisplay.node.id);\r\n                this.mRightBaseScaleX = scaleX;\r\n                this.mRightBaseScaleY = scaleY;\r\n                scale = this.getScale(InteractivePanel.baseWidth, InteractivePanel.baseHeight, this.mRightFaceIcon.width, this.mRightFaceIcon.height);\r\n                this.mRightFaceIcon.scaleX = scaleX * scale;\r\n                this.mRightFaceIcon.scaleY = scaleY * scale;\r\n                this.mRightFaceIcon.x = 200;\r\n                // this.mRightFaceIcon.y = desConWorldY - this.mRightFaceIcon.height / 2;\r\n                // this.mRightFaceIcon.y = imgY + this.mRightFaceIcon.height / 4;\r\n                this.addAt(this.mRightFaceIcon, 0);\r\n                this.mRightFaceIcon.visible = true;\r\n                this.mRightFaceIcon.setInteractive();\r\n                this.mRightFaceIcon.off("pointerup", this.rightFaceClick, this);\r\n                this.mRightFaceIcon.on("pointerup", this.rightFaceClick, this);\r\n                break;\r\n        }\r\n        this.resize();\r\n    };\r\n    InteractivePanel.prototype.rightFaceClick = function (pointer) {\r\n        if (!this.checkPointer(pointer))\r\n            return;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mRightFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.midFaceClick = function (pointer) {\r\n        if (!this.checkPointer(pointer))\r\n            return;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mMidFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.leftFaceClick = function (pointer) {\r\n        if (!this.checkPointer(pointer))\r\n            return;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!med)\r\n            return;\r\n        med.componentClick(this.mLeftFaceIcon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.descConClick = function (pointer) {\r\n        if (!this.checkPointer(pointer))\r\n            return;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!this.mDescCon.getData("nodeID") || !med)\r\n            return;\r\n        med.componentClick(this.mDescCon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.nameConClick = function (pointer) {\r\n        if (!this.checkPointer(pointer))\r\n            return;\r\n        var med = this.mWorld.uiManager.getMediator(_InteractivePanelMediator__WEBPACK_IMPORTED_MODULE_6__["InteractivePanelMediator"].NAME);\r\n        if (!this.mNameCon.getData("nodeID") || !med)\r\n            return;\r\n        med.componentClick(this.mNameCon.getData("nodeID"));\r\n    };\r\n    InteractivePanel.prototype.checkPointer = function (pointer) {\r\n        return Math.abs(pointer.downX - pointer.upX) < this.mDisDelection &&\r\n            Math.abs(pointer.downY - pointer.upY) < this.mDisDelection;\r\n    };\r\n    InteractivePanel.prototype.onLoadError = function (file) {\r\n    };\r\n    InteractivePanel.prototype.radioComplete = function () {\r\n        this.mRadioCom = true;\r\n        if (!this.mRadio)\r\n            return;\r\n        this.mRadio.x = 220;\r\n        this.mRadio.y = this.mDescCon.height + 200;\r\n        this.resize();\r\n    };\r\n    InteractivePanel.baseWidth = 720;\r\n    InteractivePanel.baseHeight = 720;\r\n    return InteractivePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InteractivePanel/InteractivePanel.ts?')},"./src/ui/InteractivePanel/InteractivePanelMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractivePanelMediator", function() { return InteractivePanelMediator; });\n/* harmony import */ var _InteractivePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InteractivePanel */ "./src/ui/InteractivePanel/InteractivePanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar InteractivePanelMediator = /** @class */ (function (_super) {\r\n    __extends(InteractivePanelMediator, _super);\r\n    function InteractivePanelMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Monopoly;\r\n        _this.mScene = scene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    InteractivePanelMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    InteractivePanelMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    InteractivePanelMediator.prototype.resize = function () {\r\n        if (this.mView && this.mView.isShow)\r\n            return this.mView.resize();\r\n    };\r\n    InteractivePanelMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    InteractivePanelMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _InteractivePanel__WEBPACK_IMPORTED_MODULE_0__["InteractivePanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    InteractivePanelMediator.prototype.update = function (param) {\r\n        if (!this.mView || !this.mView.isShow) {\r\n            return;\r\n        }\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    InteractivePanelMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    InteractivePanelMediator.prototype.destroy = function () {\r\n        this.world = null;\r\n        this.mScene = null;\r\n        this.mParam = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    InteractivePanelMediator.prototype.componentClick = function (componentID) {\r\n        if (this.mParam) {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getInteractive().requestTargetUI(this.mParam[0].id, componentID);\r\n        }\r\n    };\r\n    InteractivePanelMediator.NAME = "InteractivePanelMediator";\r\n    return InteractivePanelMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/InteractivePanel/InteractivePanelMediator.ts?')},"./src/ui/ItemDetail/ItemDetail.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemDetail", function() { return ItemDetail; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../bag/dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ItemDetail = /** @class */ (function (_super) {\r\n    __extends(ItemDetail, _super);\r\n    function ItemDetail(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mBtnWid = 100;\r\n        _this.mBtnHei = 40;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        return _this;\r\n    }\r\n    ItemDetail.prototype.getBtnList = function () {\r\n        return this.mBtnList;\r\n    };\r\n    ItemDetail.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width - (this.width + this.mBtnWid) / 2 * this.mWorld.uiScale >> 1;\r\n            this.y = size.height - this.height * this.mWorld.uiScale >> 1;\r\n        }\r\n        else {\r\n            this.x = size.width - (this.width + this.mBtnWid) / 2 * this.mWorld.uiScale >> 1;\r\n            this.y = size.height - this.height * this.mWorld.uiScale >> 1;\r\n        }\r\n        this.scale = this.mWorld.uiScale;\r\n    };\r\n    ItemDetail.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        this.mShow = true;\r\n        var data = this.mShowData[0];\r\n        if (data.display.length > 0) {\r\n            this.loadIcon(data.display[0]);\r\n        }\r\n        if (data.text.length > 0) {\r\n            this.setText(data.text[0].text);\r\n        }\r\n        if (data.button.length > 0) {\r\n            this.mBtnList = [];\r\n            var btn = void 0;\r\n            var len = data.button.length;\r\n            var preY = 20;\r\n            var preX = this.mWid + 50;\r\n            for (var i = 0; i < len; i++) {\r\n                var btnData = data.button[i];\r\n                btn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, this.mBtnWid, this.mBtnHei, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getName(), btnData.text, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getConfig(), btnData);\r\n                this.mBtnList.push(btn);\r\n                btn.x = preX;\r\n                btn.y = preY;\r\n                preY += btn.height + 40;\r\n                this.add(btn);\r\n            }\r\n        }\r\n        var bg = this.mScene.add.graphics();\r\n        bg.fillStyle(0, .6);\r\n        bg.fillRoundedRect(0, 0, this.mWid, this.mHei, 6);\r\n        this.addAt(bg, 0);\r\n        this.setSize(this.mWid + 120, this.mHei);\r\n        this.resize();\r\n        this.setInteractive();\r\n    };\r\n    ItemDetail.prototype.setText = function (value) {\r\n        this.mDescTF.setText(value);\r\n        this.mHei += this.mDescTF.y + this.mDescTF.height + 10;\r\n    };\r\n    ItemDetail.prototype.loadIcon = function (value) {\r\n        var _this = this;\r\n        if (this.mIcon) {\r\n            this.mIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(value), function () {\r\n                _this.mHei += _this.mIcon.y + _this.mIcon.height;\r\n                // if (this.mCallBack) this.mCallBack();\r\n            });\r\n        }\r\n    };\r\n    ItemDetail.prototype.hide = function () {\r\n        this.disInteractive();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ItemDetail.prototype.destroy = function () {\r\n        if (this.mBtnList) {\r\n            this.mBtnList.forEach(function (btn) {\r\n                btn.destroy(true);\r\n                btn = null;\r\n            });\r\n            this.mBtnList = null;\r\n        }\r\n        this.mResStr = "";\r\n        this.mResPng = "";\r\n        this.mResJson = "";\r\n        if (this.mNameTF)\r\n            this.mNameTF.destroy(true);\r\n        if (this.mDescTF)\r\n            this.mDescTF.destroy(true);\r\n        if (this.mIcon)\r\n            this.mIcon.destroy();\r\n        this.mNameTF = null;\r\n        this.mDescTF = null;\r\n        this.mIcon = null;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ItemDetail.prototype.preload = function () {\r\n        this.mResStr = "itemDetail";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlueButton"].getJSON());\r\n        this.mScene.load.atlas("itemDetail", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ItemDetail.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mWid = 290;\r\n        this.mHei = 0;\r\n        this.mIcon = new _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_2__["DragDropIcon"](this.mScene, 30, 25);\r\n        this.add(this.mIcon);\r\n        this.mNameTF = this.scene.make.text({\r\n            style: {\r\n                fontFamily: "YaHei",\r\n                fontSize: 20,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 250, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mNameTF.setFontStyle("bold");\r\n        this.mNameTF.setAlign("left");\r\n        this.mNameTF.x = this.mIcon.x + this.mIcon.width;\r\n        this.mNameTF.y = this.mIcon.y;\r\n        this.add(this.mNameTF);\r\n        this.mDescTF = this.scene.make.text({\r\n            style: {\r\n                fontFamily: "YaHei",\r\n                fontSize: 25,\r\n                origin: { x: 0, y: 0 },\r\n                wordWrap: { width: 250, useAdvancedWrap: true }\r\n            }\r\n        }, false);\r\n        this.mDescTF.setFontStyle("bold");\r\n        this.mDescTF.setAlign("left");\r\n        this.mDescTF.x = this.mIcon.x - this.mIcon.width / 2;\r\n        this.mDescTF.y = this.mIcon.y + this.mIcon.height + 20;\r\n        this.add(this.mDescTF);\r\n        this.mInitialized = true;\r\n        this.show(this.mShowData);\r\n    };\r\n    return ItemDetail;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemDetail/ItemDetail.ts?')},"./src/ui/ItemDetail/ItemDetailMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemDetailMediator", function() { return ItemDetailMediator; });\n/* harmony import */ var _ItemDetail__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ItemDetail */ "./src/ui/ItemDetail/ItemDetail.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ItemDetailMediator = /** @class */ (function (_super) {\r\n    __extends(ItemDetailMediator, _super);\r\n    function ItemDetailMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__["UIType"].Tips;\r\n        _this.mLayerManager = layerManager;\r\n        return _this;\r\n    }\r\n    ItemDetailMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ItemDetailMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    ItemDetailMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _ItemDetail__WEBPACK_IMPORTED_MODULE_0__["ItemDetail"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToToolTipsLayer(this.mView);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        this.mShow = true;\r\n    };\r\n    ItemDetailMediator.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    ItemDetailMediator.prototype.hide = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ItemDetailMediator.prototype.destroy = function () {\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ItemDetailMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (!gameobject)\r\n            return;\r\n        if (gameobject instanceof _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"]) {\r\n            var param = this.mParam[0];\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n            var content = pkt.content;\r\n            content.uiId = param.id;\r\n            content.componentId = gameobject.getBtnData().node.id;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    return ItemDetailMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemDetail/ItemDetailMediator.ts?')},"./src/ui/ItemPopCard/ItemPopCardMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemPopCardMediator", function() { return ItemPopCardMediator; });\n/* harmony import */ var _ItemPopCardPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ItemPopCardPanel */ "./src/ui/ItemPopCard/ItemPopCardPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ItemPopCardMediator = /** @class */ (function (_super) {\r\n    __extends(ItemPopCardMediator, _super);\r\n    function ItemPopCardMediator($layerManager, $scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = $scene;\r\n        _this.world = worldService;\r\n        _this.layerManager = $layerManager;\r\n        return _this;\r\n    }\r\n    ItemPopCardMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        this.mView = new _ItemPopCardPanel__WEBPACK_IMPORTED_MODULE_0__["ItemPopCardPanel"](this.scene, this.world);\r\n        this.mView.show(param);\r\n        this.mView.on("close", this.onCloseHandler, this);\r\n        this.layerManager.addToDialogLayer(this.mView);\r\n    };\r\n    ItemPopCardMediator.prototype.onCloseHandler = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.hide();\r\n        this.mView = undefined;\r\n    };\r\n    return ItemPopCardMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemPopCard/ItemPopCardMediator.ts?')},"./src/ui/ItemPopCard/ItemPopCardPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemPopCardPanel", function() { return ItemPopCardPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var copy_text_to_clipboard__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! copy-text-to-clipboard */ "./node_modules/copy-text-to-clipboard/index.js");\n/* harmony import */ var copy_text_to_clipboard__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(copy_text_to_clipboard__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Market/DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ItemPopCardPanel = /** @class */ (function (_super) {\r\n    __extends(ItemPopCardPanel, _super);\r\n    function ItemPopCardPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.key = "item_pop_card";\r\n        _this.mPressDelay = 1000;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ItemPopCardPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mDetailDisplay.on("show", this.onShowHandler, this);\r\n        this.on("pointerup", this.onCloseHandler, this);\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n        this.mNickName.on("pointerup", this.onPointerNickNameHandler, this);\r\n        this.mNickName.on("pointerdown", this.onPointerNickNameDownHandler, this);\r\n        this.mDesText.on("pointerdown", this.onPointerDesDownHandler, this);\r\n        this.mDesText.on("pointerup", this.onPointerNickNameHandler, this);\r\n    };\r\n    ItemPopCardPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mDetailDisplay.off("show", this.onShowHandler, this);\r\n        this.off("pointerup", this.onCloseHandler, this);\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n        this.mNickName.off("pointerup", this.onPointerNickNameHandler, this);\r\n        this.mNickName.off("pointerdown", this.onPointerNickNameDownHandler, this);\r\n        this.mDesText.off("pointerdown", this.onPointerDesDownHandler, this);\r\n        this.mDesText.off("pointerup", this.onPointerNickNameHandler, this);\r\n    };\r\n    ItemPopCardPanel.prototype.resize = function (w, h) {\r\n        // const scale = this.scene.cameras.main.height / 1920;\r\n        var zoom = this.mWorld.uiScale;\r\n        var width = this.scene.cameras.main.width / zoom;\r\n        var height = this.scene.cameras.main.height / zoom;\r\n        var centerX = this.scene.cameras.main.centerX / zoom;\r\n        var centerY = this.scene.cameras.main.centerY / zoom;\r\n        // this.setScale(scale);\r\n        this.setSize(width, height);\r\n        // this.mCardContainer.setScale(scale);\r\n        this.mCardContainer.x = centerX; // - this.mCardContainer.width / 2;\r\n        this.mCardContainer.y = centerY; // - this.mCardContainer.height / 2;\r\n        this.mCloseBtn.x = centerX;\r\n        this.mCloseBtn.y = centerY + this.mCardContainer.height / 2 + 48 * this.dpr;\r\n        // this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        // this.mDetailDisplay.scale = 1 / scale;\r\n        // this.mCloseBtn.x = centerX;\r\n        // this.mCloseBtn.y = centerY;\r\n        // const graphics = this.scene.make.graphics(undefined, false);\r\n        // graphics.fillStyle(0xFF9900, 0.7);\r\n        // graphics.fillRect(0, 0, centerX, centerY);\r\n        // this.add(graphics);\r\n        // this.setSize(width, height);\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    ItemPopCardPanel.prototype.setProp = function () {\r\n        if (!this.mShowData) {\r\n            return;\r\n        }\r\n        var prop = this.mShowData[0].prop;\r\n        if (!prop) {\r\n            return;\r\n        }\r\n        this.mDesText.setText(prop.des);\r\n        this.mNickName.setText(prop.name);\r\n        if (prop.source) {\r\n            this.mSource.setText(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("item.source") + prop.source);\r\n        }\r\n        else {\r\n            this.mSource.setText("");\r\n        }\r\n        var resource = this.mShowData[0].display;\r\n        if (resource) {\r\n            if (resource.display) {\r\n                this.mDetailDisplay.loadDisplay(resource);\r\n            }\r\n            else if (resource.avatar) {\r\n                this.mDetailDisplay.loadAvatar(resource.avatar);\r\n            }\r\n            else {\r\n                this.mDetailDisplay.loadUrl(prop.icon);\r\n            }\r\n        }\r\n    };\r\n    ItemPopCardPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "item_pop_card/item_pop_card.png", "item_pop_card/item_pop_card.json");\r\n        // this.scene.load.atlas(this.key, Url.getRes("ui/item_pop_card/item_pop_card.png"), Url.getRes("ui/item_pop_card/item_pop_card.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ItemPopCardPanel.prototype.init = function () {\r\n        this.mCardContainer = this.scene.make.container({\r\n            width: 325 * this.dpr,\r\n            height: 468 * this.dpr\r\n        }, false);\r\n        this.mCardContainer.setSize(325 * this.dpr, 468 * this.dpr);\r\n        this.mCardContainer.setInteractive();\r\n        this.mBorder = this.scene.make.graphics(undefined, false);\r\n        this.mBorder.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x01cdff, 0x01cdff);\r\n        this.mBorder.fillRect(-this.mCardContainer.width / 2, -this.mCardContainer.height / 2, this.mCardContainer.width, this.mCardContainer.height);\r\n        // this.mBorder.setInteractive();\r\n        var background = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg.png"\r\n        }, false);\r\n        background.y = 23 * this.dpr - background.height / 2;\r\n        var nickNameBg = this.scene.make.image({\r\n            y: 42 * this.dpr,\r\n            key: this.key,\r\n            frame: "name_bg.png"\r\n        });\r\n        this.mNickName = this.scene.make.text({\r\n            y: 42 * this.dpr,\r\n            style: {\r\n                fontSize: 18 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5).setInteractive();\r\n        var desBg = this.scene.make.image({\r\n            y: 138 * this.dpr,\r\n            key: this.key,\r\n            frame: "des_bg.png"\r\n        }, false);\r\n        this.mDesText = this.scene.make.text({\r\n            x: desBg.x - desBg.width / 2 + 12 * this.dpr,\r\n            y: desBg.y - desBg.height / 2 + 10 * this.dpr,\r\n            style: {\r\n                fontSize: 10 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 240 * this.dpr,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false).setInteractive();\r\n        this.mDetailDisplay = new _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_3__["DetailDisplay"](this.scene);\r\n        this.mDetailDisplay.scale = this.dpr * 2;\r\n        // this.mDetailDisplay.y = -150;\r\n        this.mCloseBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "close.png"\r\n        }, false).setInteractive();\r\n        this.mSource = this.scene.make.text({\r\n            x: desBg.x - desBg.width / 2 + 12 * this.dpr,\r\n            y: desBg.y + desBg.height / 2 - 23 * this.dpr,\r\n            style: {\r\n                fontSize: 10 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT\r\n            }\r\n        }, false);\r\n        this.add(this.mCardContainer);\r\n        this.mCardContainer.add([this.mBorder, background, desBg, this.mDetailDisplay, nickNameBg, this.mNickName, this.mDesText, this.mSource]);\r\n        this.add(this.mCloseBtn);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n        this.setInteractive();\r\n        this.setProp();\r\n    };\r\n    ItemPopCardPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n        clearTimeout(this.mPressTime);\r\n        this.mNickNameDown = false;\r\n    };\r\n    ItemPopCardPanel.prototype.onPointerNickNameHandler = function () {\r\n        // if (this.mNickNameDown) {\r\n        //   copy(this.mNickName.text);\r\n        //   const content = {\r\n        //     noticeContext: "复制名字成功"\r\n        //   };\r\n        //   this.mWorld.emitter.emit(MessageType.SHOW_NOTICE, { content });\r\n        // }\r\n        clearTimeout(this.mPressTime);\r\n        this.mNickNameDown = false;\r\n    };\r\n    ItemPopCardPanel.prototype.onPointerNickNameDownHandler = function () {\r\n        var _this = this;\r\n        // this.mNickNameDown = true;\r\n        this.mPressTime = setTimeout(function () {\r\n            _this.copyName();\r\n        }, this.mPressDelay);\r\n    };\r\n    ItemPopCardPanel.prototype.onPointerDesDownHandler = function () {\r\n        var _this = this;\r\n        this.mPressTime = setTimeout(function () {\r\n            _this.copyDes();\r\n        }, this.mPressDelay);\r\n    };\r\n    ItemPopCardPanel.prototype.copyName = function () {\r\n        if (this.mNickName) {\r\n            copy_text_to_clipboard__WEBPACK_IMPORTED_MODULE_2__(this.mNickName.text);\r\n            var content = {\r\n                noticeContext: _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("item.copy_suc", { name: _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("item.name") })\r\n            };\r\n            this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_4__["MessageType"].SHOW_NOTICE, { content: content });\r\n        }\r\n    };\r\n    ItemPopCardPanel.prototype.copyDes = function () {\r\n        if (this.mDesText) {\r\n            copy_text_to_clipboard__WEBPACK_IMPORTED_MODULE_2__(this.mDesText.text);\r\n            var content = {\r\n                noticeContext: _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("item.copy_suc", { name: _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("item.des") })\r\n            };\r\n            this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_4__["MessageType"].SHOW_NOTICE, { content: content });\r\n        }\r\n    };\r\n    ItemPopCardPanel.prototype.onShowHandler = function (image) {\r\n        this.mDetailDisplay.y = -this.mCardContainer.height / 4;\r\n    };\r\n    return ItemPopCardPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ItemPopCard/ItemPopCardPanel.ts?')},"./src/ui/Market/DetailDisplay.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DetailDisplay", function() { return DetailDisplay; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../rooms/display/dragonbones.display */ "./src/rooms/display/dragonbones.display.ts");\n/* harmony import */ var _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rooms/display/dragonbones.model */ "./src/rooms/display/dragonbones.model.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DetailDisplay = /** @class */ (function (_super) {\r\n    __extends(DetailDisplay, _super);\r\n    function DetailDisplay(scene) {\r\n        return _super.call(this, scene) || this;\r\n    }\r\n    DetailDisplay.prototype.loadDisplay = function (content) {\r\n        this.mDisplay = content;\r\n        this.destroyDragon();\r\n        if (!this.mImage) {\r\n            this.mImage = this.scene.make.image(undefined, false);\r\n        }\r\n        this.add(this.mImage);\r\n        if (content.display) {\r\n            var display = content.display;\r\n            if (this.scene.textures.exists(display.texturePath)) {\r\n                this.onCompleteHandler();\r\n            }\r\n            else {\r\n                this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onCompleteHandler, this);\r\n                if (display.texturePath !== "" && display.dataPath !== "") {\r\n                    this.scene.load.atlas(display.texturePath, _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(display.texturePath), _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(display.dataPath));\r\n                }\r\n                else {\r\n                    this.loadUrl(_utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(display.texturePath));\r\n                }\r\n                this.scene.load.start();\r\n            }\r\n        }\r\n    };\r\n    DetailDisplay.prototype.loadAvatar = function (content, scale, offset) {\r\n        var _this = this;\r\n        if (scale === void 0) { scale = 1; }\r\n        if (!this.mDragonboneDisplay) {\r\n            this.mDragonboneDisplay = new _rooms_display_dragonbones_display__WEBPACK_IMPORTED_MODULE_1__["DragonbonesDisplay"](this.scene, undefined, undefined, true);\r\n            if (offset) {\r\n                this.mDragonboneDisplay.x += offset.x;\r\n                this.mDragonboneDisplay.y += offset.y;\r\n            }\r\n        }\r\n        if (this.mImage) {\r\n            this.remove(this.mImage);\r\n        }\r\n        this.mDragonboneDisplay.once("initialized", function () {\r\n            _this.mDragonboneDisplay.play({ name: "idle", flip: false });\r\n        });\r\n        this.mDragonboneDisplay.load(new _rooms_display_dragonbones_model__WEBPACK_IMPORTED_MODULE_2__["DragonbonesModel"]({\r\n            id: 0,\r\n            avatar: content.avatar\r\n        }));\r\n        this.mDragonboneDisplay.scale = scale;\r\n        this.add(this.mDragonboneDisplay);\r\n    };\r\n    DetailDisplay.prototype.loadUrl = function (url) {\r\n        this.mUrl = url;\r\n        if (this.mDisplay)\r\n            this.mDisplay = null;\r\n        this.destroyDragon();\r\n        if (!this.mImage) {\r\n            this.mImage = this.scene.make.image(undefined, false);\r\n        }\r\n        this.add(this.mImage);\r\n        if (this.scene.textures.exists(url)) {\r\n            this.onCompleteHandler();\r\n        }\r\n        else {\r\n            this.scene.load.image(url, _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(url));\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onCompleteHandler, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    DetailDisplay.prototype.setTexture = function (key, frame) {\r\n        this.destroyDragon();\r\n        if (!this.mImage) {\r\n            this.mImage = this.scene.make.image({\r\n                key: key,\r\n                frame: frame\r\n            }, false);\r\n        }\r\n        else {\r\n            this.mImage.setTexture(key, frame);\r\n        }\r\n        this.setSize(this.mImage.width * this.scale, this.mImage.height * this.scale);\r\n        this.add(this.mImage);\r\n        this.emit("show", this.mImage);\r\n    };\r\n    DetailDisplay.prototype.setNearest = function () {\r\n        if (this.mImage) {\r\n            this.mImage.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n        }\r\n    };\r\n    Object.defineProperty(DetailDisplay.prototype, "display", {\r\n        get: function () {\r\n            return this.mDisplay;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DetailDisplay.prototype.onCompleteHandler = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        if (this.mDisplay) {\r\n            var display = this.mDisplay.display;\r\n            var ani = this.mDisplay.animations;\r\n            if (!ani || ani.length <= 0) {\r\n                return;\r\n            }\r\n            this.mImage.setTexture(this.mDisplay.display.texturePath, ani[0].frameName[0]);\r\n        }\r\n        else {\r\n            this.mImage.setTexture(this.mUrl);\r\n        }\r\n        this.setNearest();\r\n        this.setSize(this.mImage.width * this.scale, this.mImage.height * this.scale);\r\n        this.emit("show", this.mImage);\r\n    };\r\n    DetailDisplay.prototype.destroyDragon = function () {\r\n        if (this.mDragonboneDisplay) {\r\n            this.mDragonboneDisplay.destroy();\r\n            this.mDragonboneDisplay = undefined;\r\n        }\r\n    };\r\n    return DetailDisplay;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/DetailDisplay.ts?')},"./src/ui/Market/ElementDetail.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ElementDetail", function() { return ElementDetail; });\n/* harmony import */ var _NumberCounter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NumberCounter */ "./src/ui/Market/NumberCounter.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _DetailDisplay__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ElementDetail = /** @class */ (function (_super) {\r\n    __extends(ElementDetail, _super);\r\n    function ElementDetail(scene, world, $key, dpr, uiScale) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.key = $key;\r\n        _this.mWorld = world;\r\n        _this.uiScale = uiScale || 1;\r\n        _this.dpr = dpr;\r\n        _this.setPosition(0, 0);\r\n        // this.mBackground = this.scene.make.image({\r\n        //   x: this.scene.cameras.main.width >> 1,\r\n        //   key: this.key,\r\n        //   frame: "bg"\r\n        // });\r\n        // this.mBackground.y = (this.mBackground.height >> 1) + 43 * this.dpr;\r\n        _this.mCounter = new _NumberCounter__WEBPACK_IMPORTED_MODULE_0__["NumberCounter"](_this.scene, $key, 360, 700, _this.dpr, uiScale);\r\n        var frame = _this.scene.textures.getFrame(_this.key, "yellow_button_normal");\r\n        var w = 60;\r\n        var h = 65;\r\n        if (frame) {\r\n            w = frame.width;\r\n            h = frame.height;\r\n        }\r\n        _this.mBuyBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_2__["NinePatchButton"](_this.scene, 440, 700, 81 * _this.dpr, 41 * _this.dpr, _this.key, "yellow_button", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("market.buy_button"), {\r\n            left: 14 * _this.dpr,\r\n            top: 14 * _this.dpr,\r\n            right: w - 2 - 14 * _this.dpr,\r\n            bottom: h - 2 - 14 * _this.dpr\r\n        }).setScale(uiScale);\r\n        _this.mBuyBtn.setTextStyle({\r\n            color: "#976400",\r\n            fontSize: 16 * _this.dpr * uiScale,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT\r\n        });\r\n        _this.mBuyBtn.setFontStyle("bold");\r\n        // this.mBuyBtn.setTextOffset(0, 10 * this.dpr);\r\n        _this.mBuyBtn.on("pointerup", _this.onBuyHandler, _this);\r\n        // this.mNickNameContainer = this.scene.make.container(undefined, false);\r\n        // this.mNickNameBg = this.scene.make.image({\r\n        //   key: this.key,\r\n        //   frame: "name_bg"\r\n        // }, false);\r\n        // this.mNickNameContainer.setSize(this.mNickNameBg.width, this.mNickNameBg.height);\r\n        _this.mNickName = _this.scene.make.text({\r\n            x: 7 * _this.dpr,\r\n            y: 9 * _this.dpr,\r\n            style: {\r\n                fontSize: 12 * _this.dpr * uiScale,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT,\r\n                color: "#FFFF00",\r\n                align: "center"\r\n            }\r\n        });\r\n        _this.mPriceContainer = _this.scene.make.container(undefined, false);\r\n        _this.mPriceIcon = _this.scene.make.image({\r\n            x: -78,\r\n            key: _this.key,\r\n            frame: "iv_coin"\r\n        }, false).setScale(uiScale);\r\n        _this.mPriceText = _this.scene.make.text({\r\n            x: 0,\r\n            style: {\r\n                fontSize: 14 * _this.dpr * uiScale,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT\r\n            }\r\n        }).setOrigin(0.5);\r\n        var priceBg = _this.scene.make.image({\r\n            key: _this.key,\r\n            frame: "price_bg"\r\n        }).setScale(uiScale);\r\n        _this.mDetailDisplay = new _DetailDisplay__WEBPACK_IMPORTED_MODULE_4__["DetailDisplay"](_this.scene);\r\n        _this.mDetailDisplay.scale = _this.dpr;\r\n        _this.mDetailDisplay.y = 110 * _this.dpr;\r\n        var bubbleW = 110 * _this.dpr * _this.uiScale;\r\n        var bubbleH = 96 * _this.dpr * _this.uiScale;\r\n        _this.mDetailBubble = _this.scene.make.graphics(undefined, false);\r\n        _this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        _this.mDetailBubble.fillRoundedRect(0, 0, bubbleW, bubbleH);\r\n        _this.mDetailBubbleContainer = _this.scene.make.container(undefined, false);\r\n        _this.mDetailBubbleContainer.setSize(bubbleW, bubbleH);\r\n        _this.mDesText = _this.scene.make.text({\r\n            x: 8 * _this.dpr,\r\n            y: 56 * _this.dpr,\r\n            style: {\r\n                color: "#32347b",\r\n                fontSize: 10 * _this.dpr * uiScale,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT,\r\n                wordWrap: {\r\n                    width: 90 * _this.dpr * uiScale,\r\n                    useAdvancedWrap: true\r\n                }\r\n            }\r\n        }, false);\r\n        _this.mSource = _this.scene.make.text({\r\n            x: 8 * _this.dpr,\r\n            y: 38 * _this.dpr,\r\n            style: {\r\n                fontSize: 10 * _this.dpr * uiScale,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_5__["Font"].DEFULT_FONT,\r\n            }\r\n        }, false);\r\n        _this.add([_this.mDetailDisplay, _this.mPriceContainer, _this.mCounter, _this.mBuyBtn, _this.mDetailBubbleContainer]);\r\n        _this.mDetailBubbleContainer.add([_this.mDetailBubble, _this.mNickName, _this.mDesText, _this.mSource]);\r\n        _this.mPriceContainer.add([priceBg, _this.mPriceIcon, _this.mPriceText]);\r\n        // this.mNickNameContainer.add([this.mNickNameBg, this.mNickName]);\r\n        _this.addActionListener();\r\n        return _this;\r\n    }\r\n    ElementDetail.prototype.resize = function (w, h) {\r\n        var width = (this.scene.cameras.main.width);\r\n        var height = ((this.scene.cameras.main.height) >> 1) - 150;\r\n        var centerX = this.scene.cameras.main.centerX;\r\n        this.mBuyBtn.x = width - this.mBuyBtn.displayWidth / 2 - 10 * this.dpr * this.uiScale;\r\n        this.mBuyBtn.y = this.height - this.y - this.mBuyBtn.displayHeight / 2 - 12 * this.dpr * this.uiScale;\r\n        var counterX = this.mBuyBtn.x - this.mBuyBtn.displayWidth / 2 - this.mCounter.displayWidth / 2 - 17 * this.dpr * this.uiScale;\r\n        // if (counterX < this.mCounter.displayWidth / 2 + 10) {\r\n        //   counterX = this.mCounter.displayWidth / 2 + 10;\r\n        // }\r\n        this.mCounter.x = counterX;\r\n        this.mCounter.y = this.mBuyBtn.y;\r\n        this.mDetailBubbleContainer.x = 10 * this.dpr;\r\n        var endW = width - (width - this.mCounter.x) - this.mCounter.width / 2;\r\n        if (this.mDetailBubbleContainer.displayWidth + this.mDetailBubbleContainer.x + 10 * this.dpr > endW) {\r\n            var bubbleW = endW - 16 * this.dpr * this.uiScale;\r\n            this.mDesText.setWordWrapWidth(bubbleW - 10 * this.dpr * this.uiScale, true);\r\n            this.resizeDesBubble(bubbleW, this.mDetailBubbleContainer.height);\r\n        }\r\n        // this.mDetailBubbleContainer.y = this.height - this.y - this.mDetailBubbleContainer.height - 6 * this.dpr;\r\n        this.mPriceContainer.x = this.mCounter.x;\r\n        this.mPriceContainer.y = this.mCounter.y - 35 * this.dpr;\r\n        this.mDetailDisplay.x = centerX;\r\n        this.mDetailDisplay.y = (this.height - this.y) / 2;\r\n        // this.mDetailBubbleContainer.y = this.mDetailDisplay.y;\r\n        var clickW = width * 0.8;\r\n        var clickH = height * 0.7;\r\n        this.setInteractive(new Phaser.Geom.Rectangle((width >> 1) + (width - clickW >> 1), height >> 1, clickW, clickH), Phaser.Geom.Rectangle.Contains);\r\n        // test interactive\r\n        // const graphics = this.scene.make.graphics(undefined, false);\r\n        // graphics.fillStyle(0xFF9900, 0.5);\r\n        // graphics.fillRect(width - clickW >> 1, 0, clickW, clickH);\r\n        // this.add(graphics);\r\n        this.mCounter.resize();\r\n    };\r\n    ElementDetail.prototype.addActionListener = function () {\r\n        if (!this.mCounter) {\r\n            return;\r\n        }\r\n        this.mCounter.addActionListener();\r\n        this.mCounter.on("change", this.onChangeCounterHandler, this);\r\n        // this.mDetailDisplay.on("show", this.onShowDisplayHandler, this);\r\n        this.on("pointerup", this.onPointerUpHandler, this);\r\n    };\r\n    ElementDetail.prototype.removeActionListener = function () {\r\n        if (!this.mCounter) {\r\n            return;\r\n        }\r\n        this.mCounter.removeActionListener();\r\n        this.mCounter.off("change", this.onChangeCounterHandler, this);\r\n        // this.mDetailDisplay.off("show", this.onShowDisplayHandler, this);\r\n        this.off("gameobjectup", this.onPointerUpHandler, this);\r\n    };\r\n    ElementDetail.prototype.setProp = function (prop) {\r\n        this.mSelectedProp = prop;\r\n        this.mNickName.setText(prop.shortName || prop.name);\r\n        this.mDesText.setText(prop.des);\r\n        if (prop.price && prop.price.length > 0) {\r\n            this.mPriceIcon.setTexture(this.key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_6__["Coin"].getIcon(prop.price[0].coinType));\r\n            this.updatePrice(prop.price[0].price.toString());\r\n        }\r\n        else {\r\n            this.mPriceText.setText("");\r\n        }\r\n        if (prop.source) {\r\n            this.mSource.setText("\\u6765\\u6E90\\uFF1A " + prop.source);\r\n        }\r\n        else {\r\n            this.mSource.setText("");\r\n        }\r\n        this.resizeDesBubble();\r\n        this.mCounter.setCounter(1);\r\n    };\r\n    ElementDetail.prototype.setResource = function (content) {\r\n        if (content.display) {\r\n            this.mDetailDisplay.loadDisplay(content);\r\n        }\r\n        else if (content.avatar) {\r\n            var player = this.mWorld.roomManager.currentRoom.playerManager.actor;\r\n            var avatar = player.model.avatar;\r\n            for (var key in avatar) {\r\n                if (avatar.hasOwnProperty(key)) {\r\n                    var element = avatar[key];\r\n                    if (element && !content.avatar[key])\r\n                        content.avatar[key] = element;\r\n                }\r\n            }\r\n            var offset = new Phaser.Geom.Point(0, 35 * 2);\r\n            this.mDetailDisplay.loadAvatar(content, 2, offset);\r\n        }\r\n        else {\r\n            this.mDetailDisplay.loadUrl(this.mSelectedProp.icon);\r\n        }\r\n        // this.mDetailDisplay.loadDisplay(content.display || this.mSelectedProp.icon);\r\n    };\r\n    ElementDetail.prototype.updatePrice = function (price) {\r\n        this.mPriceText.setText(price);\r\n        this.mPriceIcon.x = this.mPriceText.x - this.mPriceText.width / 2 - 16 * this.dpr;\r\n    };\r\n    ElementDetail.prototype.onBuyHandler = function () {\r\n        if (!this.mSelectedProp) {\r\n            return;\r\n        }\r\n        var prop = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].OrderCommodities.create();\r\n        prop.id = this.mSelectedProp.id;\r\n        prop.quantity = this.mCounter.number;\r\n        prop.category = this.mSelectedProp.category;\r\n        this.emit("buyItem", prop);\r\n    };\r\n    ElementDetail.prototype.onChangeCounterHandler = function (num) {\r\n        if (!this.mSelectedProp) {\r\n            return;\r\n        }\r\n        if (!this.mSelectedProp.price || this.mSelectedProp.price.length < 1) {\r\n            return;\r\n        }\r\n        this.updatePrice((this.mSelectedProp.price[0].price * this.mCounter.number).toString());\r\n    };\r\n    ElementDetail.prototype.onPointerUpHandler = function () {\r\n        this.emit("popItemCard", this.mSelectedProp, this.mDetailDisplay.display);\r\n        this.mCounter.setBlur();\r\n    };\r\n    ElementDetail.prototype.resizeDesBubble = function (w, h) {\r\n        // const bubbleW = 110 * this.dpr;\r\n        if (w === undefined)\r\n            w = this.mDetailBubbleContainer.width;\r\n        var bubbleH = this.mDesText.height + 60 * this.dpr * this.uiScale;\r\n        if (w === this.mDetailBubbleContainer.width && bubbleH === this.mDetailBubbleContainer.height) {\r\n            return;\r\n        }\r\n        this.mDetailBubble.clear();\r\n        this.mDetailBubble.fillStyle(0xFFFFFF, 0.1);\r\n        this.mDetailBubble.fillRoundedRect(0, 0, w, bubbleH);\r\n        this.mDetailBubbleContainer.setSize(w, bubbleH);\r\n        this.mDetailBubbleContainer.y = this.height - this.y - this.mDetailBubbleContainer.height - 6 * this.dpr;\r\n    };\r\n    ElementDetail.prototype.onShowDisplayHandler = function (image) {\r\n        if (!image) {\r\n            return;\r\n        }\r\n        // this.mNickNameContainer.x = this.mDetailDisplay.x; // + this.mDetailDisplay.width / 2 - this.mNickNameContainer.width / 2;\r\n        // let _y = this.mDetailDisplay.y + this.mDetailDisplay.height / 2 + this.mNickNameContainer.height / 2 + 45;\r\n        // if (_y > this.mCounter.y - this.mNickNameContainer.height - 45) {\r\n        //   _y = this.mCounter.y - this.mNickNameContainer.height - 45;\r\n        // }\r\n        // this.mNickNameContainer.y = _y;\r\n    };\r\n    return ElementDetail;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/ElementDetail.ts?')},"./src/ui/Market/Market.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Market", function() { return Market; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Market = /** @class */ (function (_super) {\r\n    __extends(Market, _super);\r\n    function Market($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Market.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_GET_MARKET_CATEGORIES, this.onGetMarketCategoriesHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY, this.onQueryMarketHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE, this.onQueryCommodityResultHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MARKET_SHOW_MARKET_BY_NAME, this.openMarketPanel);\r\n        }\r\n    };\r\n    Market.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Market.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Market.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Market.prototype.setMarketName = function (market_name) {\r\n        this.market_name = market_name;\r\n    };\r\n    /**\r\n     * 获取商品分类\r\n     */\r\n    Market.prototype.getMarkCategories = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_GET_CATEGORIES);\r\n        var content = packet.content;\r\n        content.marketName = this.market_name;\r\n        this.connection.send(packet);\r\n    };\r\n    Market.prototype.queryMarket = function (page, category, subCategory) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY);\r\n        var content = packet.content;\r\n        content.page = page;\r\n        content.perPage = 1000;\r\n        content.category = category;\r\n        content.subcategory = subCategory;\r\n        content.marketName = this.market_name;\r\n        this.connection.send(packet);\r\n    };\r\n    Market.prototype.buyMarketCommodities = function (commodities) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_BUY_ORDER_COMMODITIES);\r\n        var content = packet.content;\r\n        content.orderCommodities = commodities;\r\n        content.marketName = this.market_name;\r\n        this.connection.send(packet);\r\n    };\r\n    Market.prototype.queryCommodityResource = function (id, category) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MARKET_QUERY_COMMODITY_RESOURCE);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        content.category = category;\r\n        content.marketName = this.market_name;\r\n        this.connection.send(packet);\r\n    };\r\n    Market.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Market.prototype.onGetMarketCategoriesHandler = function (packet) {\r\n        // const content: op_client.IOP_VIRTUAL_WORLD_RES_CLIENT_GET_MARKET_CATEGORIES = ;\r\n        this.mEvent.emit("getMarketCategories", packet.content);\r\n    };\r\n    Market.prototype.onQueryMarketHandler = function (packet) {\r\n        this.mEvent.emit("queryMarket", packet.content);\r\n    };\r\n    Market.prototype.onQueryCommodityResultHandler = function (packet) {\r\n        var content = packet.content;\r\n        packet.content.market_name = this.market_name;\r\n        this.mEvent.emit("queryCommodityResource", packet.content);\r\n    };\r\n    Market.prototype.openMarketPanel = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("showopen", content);\r\n    };\r\n    Object.defineProperty(Market.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return Market;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/Market.ts?')},"./src/ui/Market/MarketMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MarketMediator", function() { return MarketMediator; });\n/* harmony import */ var _MarketPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MarketPanel */ "./src/ui/Market/MarketPanel.ts");\n/* harmony import */ var _Market__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Market */ "./src/ui/Market/Market.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar MarketMediator = /** @class */ (function (_super) {\r\n    __extends(MarketMediator, _super);\r\n    function MarketMediator($layerManager, $scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = $scene;\r\n        _this.world = world;\r\n        _this.layerManager = $layerManager;\r\n        if (!_this.mMarket) {\r\n            _this.mMarket = new _Market__WEBPACK_IMPORTED_MODULE_1__["Market"](_this.world);\r\n            _this.mMarket.register();\r\n            _this.mMarket.on("getMarketCategories", _this.onCategoriesHandler, _this);\r\n            _this.mMarket.on("queryMarket", _this.onQueryResuleHandler, _this);\r\n            _this.mMarket.on("queryCommodityResource", _this.onQueryCommodityResourceHandler, _this);\r\n            _this.mMarket.on("showopen", _this.onShowOpenPanel, _this);\r\n        }\r\n        return _this;\r\n    }\r\n    MarketMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _MarketPanel__WEBPACK_IMPORTED_MODULE_0__["MarketPanel"](this.scene, this.world);\r\n            this.mView.on("getCategories", this.onGetCategoriesHandler, this);\r\n            this.mView.on("queryProp", this.onQueryPropHandler, this);\r\n            this.mView.on("buyItem", this.onBuyItemHandler, this);\r\n            this.mView.on("close", this.onCloseHandler, this);\r\n            this.mView.on("popItemCard", this.onPopItemCardHandler, this);\r\n            this.mView.on("queryPropResource", this.onQueryPropresouceHandler, this);\r\n        }\r\n        if (param && param[0]) {\r\n            this.mMarket.setMarketName(param[0].marketName);\r\n        }\r\n        else {\r\n            this.mMarket.setMarketName("shop");\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    MarketMediator.prototype.destroy = function () {\r\n        if (this.mMarket)\r\n            this.mMarket.destroy();\r\n        this.mMarket = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MarketMediator.prototype.onCategoriesHandler = function (content) {\r\n        this.mView.setCategories(content);\r\n    };\r\n    MarketMediator.prototype.onQueryResuleHandler = function (content) {\r\n        this.mView.setProp(content);\r\n    };\r\n    MarketMediator.prototype.onGetCategoriesHandler = function () {\r\n        this.mMarket.getMarkCategories();\r\n    };\r\n    MarketMediator.prototype.onQueryPropHandler = function (page, category, subCategory) {\r\n        this.mMarket.queryMarket(page, category, subCategory);\r\n    };\r\n    MarketMediator.prototype.onBuyItemHandler = function (prop) {\r\n        this.mMarket.buyMarketCommodities([prop]);\r\n    };\r\n    MarketMediator.prototype.onQueryPropresouceHandler = function (prop) {\r\n        this.mMarket.queryCommodityResource(prop.id, prop.category);\r\n    };\r\n    MarketMediator.prototype.onShowOpenPanel = function (content) {\r\n        this.setParam([content]);\r\n        this.show([content]);\r\n    };\r\n    MarketMediator.prototype.onPopItemCardHandler = function (prop, display) {\r\n        // const packet: PBpacket = new PBpacket(op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI);\r\n        // const content: op_client.OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI = packet.content;\r\n        // content.name = "ItemPopCard";\r\n        var packet = {\r\n            content: {\r\n                name: "ItemPopCard",\r\n                prop: prop,\r\n                display: display\r\n            }\r\n        };\r\n        this.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SHOW_UI, packet);\r\n    };\r\n    MarketMediator.prototype.onQueryCommodityResourceHandler = function (content) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.setCommodityResource(content);\r\n    };\r\n    MarketMediator.prototype.onCloseHandler = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return MarketMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/MarketMediator.ts?')},"./src/ui/Market/MarketPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MarketPanel", function() { return MarketPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _ElementDetail__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ElementDetail */ "./src/ui/Market/ElementDetail.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _components_checkbox_group__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/checkbox.group */ "./src/ui/components/checkbox.group.ts");\n/* harmony import */ var _TextButton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TextButton */ "./src/ui/Market/TextButton.ts");\n/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./item */ "./src/ui/Market/item.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _lib_rexui_lib_ui_tab_NinePatchTabButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/tab/NinePatchTabButton */ "./lib/rexui/lib/ui/tab/NinePatchTabButton.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar MarketPanel = /** @class */ (function (_super) {\r\n    __extends(MarketPanel, _super);\r\n    function MarketPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "market";\r\n        _this.mSubTabs = [];\r\n        _this.mTabs = [];\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    MarketPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mSelectItem.on("buyItem", this.onBuyItemHandler, this);\r\n        this.mSelectItem.on("popItemCard", this.onPopItemCardHandler, this);\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n    };\r\n    MarketPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mSelectItem.off("buyItem", this.onBuyItemHandler, this);\r\n        this.mSelectItem.off("popItemCard", this.onPopItemCardHandler, this);\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n    };\r\n    MarketPanel.prototype.resize = function (w, h) {\r\n        // super.resize(w, h);\r\n        var scale = this.scale;\r\n        var zoom = this.mWorld.uiScale;\r\n        var width = this.scene.cameras.main.width / scale;\r\n        var height = this.scene.cameras.main.height / scale;\r\n        var centerX = this.scene.cameras.main.centerX / scale;\r\n        this.setSize(width, height);\r\n        this.mTIle.x = centerX;\r\n        var shelfHeight = 290 * this.dpr * zoom;\r\n        this.mBackgroundColor.setInteractive(new Phaser.Geom.Rectangle(0, 0, width * zoom, height * zoom), Phaser.Geom.Rectangle.Contains);\r\n        this.mShelfContainer.setSize(width, shelfHeight);\r\n        this.mShelfContainer.setPosition(0, height - this.mShelfContainer.height);\r\n        this.mShelfBackground.clear();\r\n        this.mShelfBackground.fillStyle(0x02ccff);\r\n        this.mShelfBackground.fillRect(0, 0, this.mShelfContainer.width, this.mShelfContainer.height);\r\n        this.mShelfBackground.y = this.mSubCategeoriesContainer.y + 43 * this.dpr * zoom;\r\n        this.mSelectItem.setSize(width, height - this.mShelfContainer.height);\r\n        this.mSelectItem.resize(w, h);\r\n        this.mCategoriesBar.clear();\r\n        this.mCategoriesBar.fillStyle(0x3ee1ff);\r\n        this.mCategoriesBar.fillRect(0, 0, width, 40 * this.dpr * zoom);\r\n        this.mCategoriesBar.fillStyle(0x04b3d3);\r\n        this.mCategoriesBar.fillRect(0, 40 * this.dpr * zoom, width, 3 * this.dpr * zoom);\r\n        this.mSubCategeoriesContainer.setSize(width, 43 * this.dpr * zoom);\r\n        // this.setInteractive();\r\n        // this.setInteractive(new Phaser.Geom.Rectangle(-(width >> 1), -(height >> 1), width, height), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    MarketPanel.prototype.setCategories = function (content) {\r\n        if (!this.mCategoriesContainer) {\r\n            return;\r\n        }\r\n        this.mCategoriesContainer.removeAll(true);\r\n        var categorys = content.marketCategory;\r\n        this.mTabs = [];\r\n        var frame = this.scene.textures.getFrame(this.key, "categories_normal");\r\n        var w = 60;\r\n        var h = 65;\r\n        if (frame) {\r\n            w = frame.width;\r\n            h = frame.height;\r\n        }\r\n        var config0 = {\r\n            left: w / 2 + 2 * this.dpr,\r\n            top: 12 * this.dpr,\r\n            right: w / 2 - 4 * this.dpr,\r\n            bottom: 2 * this.dpr\r\n        };\r\n        var group = new _components_checkbox_group__WEBPACK_IMPORTED_MODULE_4__["CheckboxGroup"]();\r\n        var zoom = this.mWorld.uiScale;\r\n        var capW = 77 * this.dpr * zoom;\r\n        var capH = 38 * this.dpr * zoom;\r\n        for (var i = 0; i < categorys.length; i++) {\r\n            var btn = new _lib_rexui_lib_ui_tab_NinePatchTabButton__WEBPACK_IMPORTED_MODULE_9__["NinePatchTabButton"](this.scene, capW, capH, this.key, "categories_normal", "categories_down", categorys[i].category.value, [config0], this.dpr, this.scale);\r\n            // btn.removeAllListeners();\r\n            btn.setTextStyle({\r\n                fontSize: 18 * this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT,\r\n            });\r\n            this.mTabs[i] = btn;\r\n            btn.setData("category", categorys[i]);\r\n            btn.x = i * 80 * this.dpr * zoom + capW / 2;\r\n            btn.y = capH / 2;\r\n            // this.add(btn);\r\n        }\r\n        this.mCategoriesContainer.setSize(this.mTabs.length * capW, capH);\r\n        this.mShelfContainer.add(this.mTabs);\r\n        this.layoutCategories();\r\n        group.on("selected", this.onSelectCategoryHandler, this);\r\n        group.appendItemAll(this.mTabs);\r\n        group.selectIndex(0);\r\n    };\r\n    MarketPanel.prototype.setProp = function (content) {\r\n        this.clearCategories(this.mItems);\r\n        this.mItems = [];\r\n        var commodities = content.commodities;\r\n        this.mPropGrid.setItems(commodities);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.setT(0);\r\n        if (commodities.length > 0)\r\n            this.onSelectItemHandler(commodities[0]);\r\n    };\r\n    MarketPanel.prototype.setCommodityResource = function (content) {\r\n        if (this.mSelectItem) {\r\n            this.mSelectItem.setResource(content);\r\n            this.mSelectItem.setData("display", content);\r\n        }\r\n    };\r\n    MarketPanel.prototype.destroy = function () {\r\n        if (this.mSubCategorisScroll) {\r\n            this.mSubCategorisScroll.destroy();\r\n        }\r\n        if (this.mPropGrid) {\r\n            this.mPropGrid.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MarketPanel.prototype.layoutCategories = function () {\r\n        this.mCategoriesBar.y = this.mCategoriesContainer.height + this.mShelfContainer.y;\r\n        this.mSubCategeoriesContainer.addAt(this.mCategoriesBar, 0);\r\n        this.mPropContainer.y = this.mSubCategeoriesContainer.y + 43 * this.dpr + this.mSubCategeoriesContainer.height + 9 * this.dpr;\r\n        this.mShelfBackground.y = this.mSubCategeoriesContainer.y + 43 * this.dpr;\r\n        this.mSubCategorisScroll.y = this.mCategoriesBar.y + (33 * this.dpr);\r\n        this.randomCon.y = this.mSubCategorisScroll.y;\r\n        this.mPropGrid.y = this.mCategoriesBar.y + this.mSubCategeoriesContainer.height + 122 * this.dpr;\r\n        this.mPropGrid.layout();\r\n        this.mSubCategorisScroll.layout();\r\n        this.mSubCategorisScroll.resetMask();\r\n        this.mPropGrid.resetMask();\r\n    };\r\n    MarketPanel.prototype.preload = function () {\r\n        // this.scene.load.atlas(this.key, Url.getUIRes(this.dpr, "market/market"), Url.getUIRes(this.dpr, "market/market.json"));\r\n        this.addAtlas(this.key, "market/market.png", "market/market.json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_12__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_12__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_12__["UIAtlasName"].commonUrl + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    MarketPanel.prototype.init = function () {\r\n        var _this = this;\r\n        if (this.mInitialized)\r\n            return;\r\n        var w = this.scene.scale.width / this.scale;\r\n        var h = this.scene.scale.height / this.scale;\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mBackgroundColor = this.scene.make.graphics(undefined, false);\r\n        this.mBackgroundColor.fillGradientStyle(0x6f75ff, 0x6f75ff, 0x04cbff, 0x04cbff);\r\n        // this.mBackgroundColor.fillStyle(0x6f75ff);\r\n        this.mBackgroundColor.fillRect(0, 0, w, h);\r\n        this.add(this.mBackgroundColor);\r\n        this.mShelfContainer = this.scene.make.container({\r\n            x: (w / 2),\r\n            y: h\r\n        }, false).setSize(w, 290 * this.dpr * zoom);\r\n        var frame = this.scene.textures.getFrame(this.key, "bg");\r\n        var countW = Math.ceil(w / (frame.width * zoom));\r\n        var countH = Math.ceil((h - this.mShelfContainer.height + frame.height * zoom) / (frame.height * zoom));\r\n        for (var i = 0; i < countW; i++) {\r\n            for (var j = 0; j < countH; j++) {\r\n                var bg = this.scene.make.image({\r\n                    x: i * frame.width * zoom,\r\n                    y: j * frame.height * zoom,\r\n                    key: this.key,\r\n                    frame: "bg"\r\n                }, false).setScale(zoom);\r\n                this.add(bg);\r\n            }\r\n        }\r\n        this.mShelfBackground = this.scene.make.graphics(undefined, false);\r\n        this.mCloseBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "back_arrow",\r\n            x: 21 * this.dpr,\r\n            y: 30 * this.dpr\r\n        }).setInteractive().setScale(zoom);\r\n        this.mPropContainer = this.scene.make.container(undefined, false);\r\n        this.mCategoriesContainer = this.scene.make.container(undefined, false);\r\n        this.mSubCategeoriesContainer = this.scene.make.container(undefined, false);\r\n        this.mShelfContainer.add([this.mShelfBackground, this.mCategoriesContainer, this.mPropContainer]);\r\n        this.add([this.mShelfContainer, this.mSubCategeoriesContainer]);\r\n        this.mSelectItem = new _ElementDetail__WEBPACK_IMPORTED_MODULE_1__["ElementDetail"](this.scene, this.mWorld, this.key, this.dpr, this.mWorld.uiScale);\r\n        this.mSelectItem.setSize(w, h - this.mShelfContainer.height);\r\n        this.mTIle = this.scene.make.text({\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].t("market.title"),\r\n            y: 30 * this.dpr * zoom,\r\n            style: {\r\n                fontSize: 36 * this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT\r\n            }\r\n        }).setOrigin(0.5);\r\n        this.add([this.mTIle, this.mSelectItem, this.mCloseBtn]);\r\n        _super.prototype.init.call(this);\r\n        this.mCategoriesBar = this.scene.make.graphics(undefined, false);\r\n        var capW = 56 * this.dpr;\r\n        var capH = 41 * this.dpr;\r\n        var config = {\r\n            x: w / 2,\r\n            // y: 0,\r\n            // width: w,\r\n            // height: capH,\r\n            table: {\r\n                width: w - 30 * this.dpr,\r\n                height: capH,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0,\r\n            },\r\n            scrollMode: 1,\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new _TextButton__WEBPACK_IMPORTED_MODULE_5__["TextButton"](scene, _this.dpr, zoom);\r\n                    // cellContainer.width = capW;\r\n                    // cellContainer.height = capH;\r\n                    _this.add(cellContainer);\r\n                }\r\n                cellContainer.setText(item.value);\r\n                // cellContainer.setSize(width, height);\r\n                cellContainer.setData({ item: item });\r\n                if (item && _this.mPreSubCategoris && _this.mPreSubCategoris.key === item.key) {\r\n                    cellContainer.changeDown();\r\n                }\r\n                else {\r\n                    cellContainer.changeNormal();\r\n                }\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mSubCategorisScroll = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_8__["GameGridTable"](this.scene, config);\r\n        this.mSubCategorisScroll.on("cellTap", function (cell, index) {\r\n            _this.onSelectSubCategoryHandler(cell);\r\n        });\r\n        this.add(this.mSubCategorisScroll.table);\r\n        this.randomCon = this.scene.make.container(undefined, false);\r\n        this.randomCon.x = w * 0.5;\r\n        this.randomCon.visible = false;\r\n        this.add(this.randomCon);\r\n        this.randomRefeshTime = this.scene.make.text({\r\n            x: -w * 0.5 + 10 * this.dpr, y: -12 * this.dpr,\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].t("market.refreshtime"),\r\n            style: {\r\n                color: "#007AAE",\r\n                fontSize: 13 * this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT\r\n            }\r\n        }).setOrigin(0, 0.5);\r\n        var btnWidth = 80 * this.dpr, btnHeight = 30 * this.dpr;\r\n        this.randomRefreshBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_11__["NineSliceButton"](this.scene, w * 0.5, this.randomRefeshTime.y, btnWidth, btnHeight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_12__["UIAtlasKey"].commonKey, "button_g", _i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].t("market.refresh"), this.dpr, this.scale, {\r\n            left: 15 * this.dpr,\r\n            top: 15 * this.dpr,\r\n            right: 15 * this.dpr,\r\n            bottom: 15 * this.dpr\r\n        });\r\n        this.randomRefreshBtn.x = w * 0.5 - this.randomRefreshBtn.width * 0.5 - 10 * this.dpr;\r\n        this.randomRefreshBtn.setTextOffset(0, 5 * this.dpr);\r\n        this.randomRefreshBtn.setTextStyle({\r\n            color: "#0",\r\n            fontSize: 13 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].BOLD_FONT\r\n        });\r\n        this.randomRefreshBtn.setFontStyle("bold");\r\n        this.refreshIcon = this.scene.make.image({ key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_12__["UIAtlasKey"].commonKey, frame: "iv_coin" }).setScale(0.8);\r\n        this.refreshIcon.setPosition(-10 * this.dpr, -8 * this.dpr);\r\n        this.refreshNeedCount = this.scene.make.text({\r\n            x: 0 * this.dpr, y: this.refreshIcon.y,\r\n            text: "100",\r\n            style: {\r\n                fontSize: 10 * this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_7__["Font"].DEFULT_FONT\r\n            }\r\n        }).setOrigin(0, 0.5);\r\n        this.randomRefreshBtn.add([this.refreshIcon, this.refreshNeedCount]);\r\n        this.randomCon.add([this.randomRefeshTime, this.randomRefreshBtn]);\r\n        var propFrame = this.scene.textures.getFrame(this.key, "border");\r\n        var cellWidth = propFrame.width * zoom + 10 * this.dpr;\r\n        var cellHeight = propFrame.height * zoom + 10 * this.dpr;\r\n        var propGridConfig = {\r\n            x: w / 2,\r\n            y: 1050 + (41 * this.dpr * zoom) / 2,\r\n            // y: 0,\r\n            table: {\r\n                width: w - 20 * this.dpr * zoom,\r\n                height: 224 * this.dpr * zoom,\r\n                columns: 3,\r\n                cellWidth: cellWidth,\r\n                cellHeight: cellHeight,\r\n                reuseCellContainer: true,\r\n                // mask: false,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0\r\n            },\r\n            scrollMode: 1,\r\n            clamplChildOY: false,\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new _item__WEBPACK_IMPORTED_MODULE_6__["MarketItem"](scene, 0, 0, _this.dpr, zoom);\r\n                    // cellContainer.width = capW;\r\n                    // cellContainer.height = capH;\r\n                    _this.add(cellContainer);\r\n                }\r\n                // cellContainer.setSize(width, height);\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setProp(item);\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mPropGrid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_8__["GameGridTable"](this.scene, propGridConfig);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.on("cellTap", function (cell) {\r\n            var data = cell.getData("item");\r\n            if (data) {\r\n                _this.onSelectItemHandler(data);\r\n            }\r\n        });\r\n        this.add(this.mPropGrid.table);\r\n        this.resize(0, 0);\r\n        this.emit("getCategories");\r\n    };\r\n    MarketPanel.prototype.setSelect = function () {\r\n        // this.mSelectItem.setProp();\r\n    };\r\n    MarketPanel.prototype.clearCategories = function (tabs) {\r\n        if (!tabs) {\r\n            return;\r\n        }\r\n        tabs.map(function (tab) { return tab.destroy(); });\r\n        tabs = undefined;\r\n    };\r\n    MarketPanel.prototype.onSelectCategoryHandler = function (gameobject) {\r\n        if (!this.mSubCategeoriesContainer) {\r\n            return;\r\n        }\r\n        this.mPreSubCategoris = null;\r\n        this.clearCategories(this.mSubTabs);\r\n        var subcategory = gameobject.getData("category");\r\n        this.mSelectedCategories = gameobject;\r\n        if (subcategory) {\r\n            var subcategorys = subcategory.subcategory;\r\n            if (this.mSubCategorisScroll) {\r\n                this.mSubCategorisScroll.setItems(subcategorys);\r\n                this.mSubCategorisScroll.layout();\r\n                var cell = this.mSubCategorisScroll.getCell(0);\r\n                this.onSelectSubCategoryHandler(cell.container);\r\n            }\r\n        }\r\n    };\r\n    MarketPanel.prototype.onSelectSubCategoryHandler = function (gameobject) {\r\n        if (!this.mSelectedCategories) {\r\n            return;\r\n        }\r\n        if (!(gameobject instanceof _TextButton__WEBPACK_IMPORTED_MODULE_5__["TextButton"])) {\r\n            return;\r\n        }\r\n        var categories = this.mSelectedCategories.getData("category");\r\n        if (!categories) {\r\n            return;\r\n        }\r\n        var subCategories = gameobject.getData("item");\r\n        if (!subCategories) {\r\n            return;\r\n        }\r\n        this.queryProp(categories.category.key, subCategories.key);\r\n        this.mPreSubCategoris = subCategories;\r\n        this.mSubCategorisScroll.refresh();\r\n    };\r\n    MarketPanel.prototype.queryProp = function (category, subCategory) {\r\n        this.emit("queryProp", 1, category, subCategory);\r\n    };\r\n    MarketPanel.prototype.onSelectItemHandler = function (prop) {\r\n        this.mSelectItem.setProp(prop);\r\n        this.mSelectItem.setData("propdata", prop);\r\n        this.emit("queryPropResource", prop);\r\n    };\r\n    MarketPanel.prototype.onBuyItemHandler = function (prop) {\r\n        var _this = this;\r\n        var itemdata = this.getBuyPackageData();\r\n        itemdata.count = prop.quantity;\r\n        var data = itemdata;\r\n        var title = _i18n__WEBPACK_IMPORTED_MODULE_2__["i18n"].t("market.payment");\r\n        var resource = this.mSelectItem.getData("display");\r\n        var confirmHandler = new _Handler_Handler__WEBPACK_IMPORTED_MODULE_10__["Handler"](this, function () {\r\n            _this.emit("buyItem", prop);\r\n        }, [prop]);\r\n        this.showPropFun({ confirmHandler: confirmHandler, data: data, resource: resource, slider: false, title: title });\r\n    };\r\n    MarketPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n    };\r\n    MarketPanel.prototype.onPopItemCardHandler = function (prop, display) {\r\n        if (prop) {\r\n            this.emit("popItemCard", prop, display);\r\n        }\r\n    };\r\n    MarketPanel.prototype.getBuyPackageData = function () {\r\n        var propdata = this.mSelectItem.getData("propdata");\r\n        var itemdata = pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].CountablePackageItem.create();\r\n        itemdata.id = propdata.id;\r\n        itemdata.sellingPrice = propdata.price[0];\r\n        itemdata.name = propdata.name;\r\n        itemdata.shortName = propdata.shortName;\r\n        return itemdata;\r\n    };\r\n    MarketPanel.prototype.showPropFun = function (config) {\r\n        var uimanager = this.mWorld.uiManager;\r\n        uimanager.showMed("PicPropFun", config);\r\n    };\r\n    return MarketPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/MarketPanel.ts?')},"./src/ui/Market/NumberCounter.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NumberCounter", function() { return NumberCounter; });\n/* harmony import */ var _components_label_input__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/label.input */ "./src/ui/components/label.input.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar NumberCounter = /** @class */ (function (_super) {\r\n    __extends(NumberCounter, _super);\r\n    function NumberCounter(scene, key, x, y, dpr, scale) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        if (scale === void 0) { scale = 1; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.pressDelay = 500;\r\n        _this.mMinNum = 1;\r\n        _this.mMaxNum = 99;\r\n        // this.mBackground = new Phaser.GameObjects.Image(this.scene, 0, 0, 200, 144, key, "input_bg", {\r\n        //   left: 50,\r\n        //   top: 48,\r\n        //   right: 50,\r\n        //   bottom: 48\r\n        // });\r\n        _this.mBackground = _this.scene.make.image({\r\n            key: key,\r\n            frame: "input_bg"\r\n        }).setScale(scale);\r\n        _this.mReduceBtn = _this.scene.make.image({\r\n            key: key,\r\n            frame: "reduce",\r\n        }, false).setInteractive().setScale(scale);\r\n        _this.mReduceBtn.x = -(_this.mBackground.displayWidth / 2) - _this.mReduceBtn.displayWidth / 2 - 7 * dpr * scale;\r\n        _this.mIncreaseBtn = _this.scene.make.image({\r\n            key: key,\r\n            frame: "increase",\r\n        }, false).setInteractive().setScale(scale);\r\n        _this.mIncreaseBtn.x = (_this.mBackground.displayWidth + _this.mIncreaseBtn.displayWidth) / 2 + 7 * dpr * scale;\r\n        // this.mInputText = new InputText(this.scene, 0, 0, 200, 80, {\r\n        //   fontSize: "46px",\r\n        //   color: "#666666",\r\n        //   align: "center",\r\n        //   type: "number",\r\n        //   text: 1\r\n        // }).setOrigin(0.5);\r\n        _this.mLabelInput = new _components_label_input__WEBPACK_IMPORTED_MODULE_0__["LabelInput"](_this.scene, {\r\n            x: 0,\r\n            y: 0,\r\n            width: 160,\r\n            height: 80,\r\n            fontSize: 14 * dpr * scale + "px",\r\n            color: "#666666",\r\n            align: "center",\r\n            type: "number",\r\n        });\r\n        _this.mLabelInput.setOrigin(0.5);\r\n        _this.mLabelInput.setText("1");\r\n        _this.mLabelInput.on("textchange", _this.onTextChangeHandler, _this);\r\n        _this.add([_this.mBackground, _this.mLabelInput, _this.mReduceBtn, _this.mIncreaseBtn]);\r\n        _this.setSize(_this.mIncreaseBtn.displayWidth + _this.mReduceBtn.displayWidth + _this.mBackground.displayWidth + 14 * dpr * scale, _this.mBackground.displayHeight);\r\n        return _this;\r\n    }\r\n    NumberCounter.prototype.resize = function () {\r\n    };\r\n    NumberCounter.prototype.setMinNumber = function (val) {\r\n        this.mMinNum = val;\r\n    };\r\n    NumberCounter.prototype.setMaxNumber = function (val) {\r\n        this.mMaxNum = val;\r\n    };\r\n    NumberCounter.prototype.addActionListener = function () {\r\n        this.mIncreaseBtn.on("pointerup", this.onIncreaseHandler, this);\r\n        this.mIncreaseBtn.on("pointerdown", this.onIncreaseDownHandler, this);\r\n        this.mReduceBtn.on("pointerup", this.onReduceHandler, this);\r\n        this.mReduceBtn.on("pointerdown", this.onReduceDownHandler, this);\r\n    };\r\n    NumberCounter.prototype.removeActionListener = function () {\r\n        this.mIncreaseBtn.off("pointerup", this.onIncreaseHandler, this);\r\n        this.mIncreaseBtn.off("pointerdown", this.onIncreaseDownHandler, this);\r\n        this.mReduceBtn.off("pointerup", this.onReduceHandler, this);\r\n        this.mReduceBtn.off("pointerdown", this.onReduceDownHandler, this);\r\n    };\r\n    NumberCounter.prototype.setCounter = function (num) {\r\n        if (isNaN(num)) {\r\n            num = 0;\r\n        }\r\n        if (num < this.mMinNum) {\r\n            num = this.mMinNum;\r\n        }\r\n        else if (num > this.mMaxNum) {\r\n            num = this.mMaxNum;\r\n        }\r\n        this.mLabelInput.setText(num.toString());\r\n        this.emit("change", num);\r\n    };\r\n    NumberCounter.prototype.setBlur = function () {\r\n        this.mLabelInput.setBlur();\r\n    };\r\n    Object.defineProperty(NumberCounter.prototype, "number", {\r\n        get: function () {\r\n            return parseInt(this.mLabelInput.text, 10);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NumberCounter.prototype.onReduceHandler = function () {\r\n        var num = parseInt(this.mLabelInput.text, 10);\r\n        this.setCounter(--num);\r\n        this.clearTween();\r\n    };\r\n    NumberCounter.prototype.onIncreaseHandler = function () {\r\n        var num = parseInt(this.mLabelInput.text, 10);\r\n        this.setCounter(++num);\r\n        this.clearTween();\r\n    };\r\n    NumberCounter.prototype.onTextChangeHandler = function () {\r\n        this.setCounter(parseInt(this.mLabelInput.text, 10));\r\n    };\r\n    NumberCounter.prototype.onReduceDownHandler = function () {\r\n        var _this = this;\r\n        this.pressTimeout = setTimeout(function () {\r\n            _this.delayTweenNumber(_this.mMinNum);\r\n        }, this.pressDelay);\r\n        this.setBlur();\r\n    };\r\n    NumberCounter.prototype.onIncreaseDownHandler = function () {\r\n        var _this = this;\r\n        this.pressTimeout = setTimeout(function () {\r\n            _this.delayTweenNumber(_this.mMaxNum);\r\n        }, this.pressDelay);\r\n        this.setBlur();\r\n    };\r\n    NumberCounter.prototype.delayTweenNumber = function (to) {\r\n        var _this = this;\r\n        var number = this.number;\r\n        this.tween = this.scene.tweens.addCounter({\r\n            from: number,\r\n            to: to,\r\n            onUpdate: function () {\r\n                _this.setCounter(_this.tween.getValue() >> 0);\r\n            },\r\n            duration: Math.abs(number - to) * 50\r\n        });\r\n    };\r\n    NumberCounter.prototype.clearTween = function () {\r\n        clearTimeout(this.pressTimeout);\r\n        if (this.tween) {\r\n            this.tween.stop();\r\n            this.tween = undefined;\r\n        }\r\n    };\r\n    return NumberCounter;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/NumberCounter.ts?')},"./src/ui/Market/TextButton.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextButton", function() { return TextButton; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar TextButton = /** @class */ (function (_super) {\r\n    __extends(TextButton, _super);\r\n    function TextButton(scene, dpr, scale, text, x, y) {\r\n        if (scale === void 0) { scale = 1; }\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.normalColor = "#FFFFFF";\r\n        _this.changeColor = "#0099cc";\r\n        _this.mText = _this.scene.make.text({\r\n            text: text,\r\n            style: {\r\n                fontSize: 15 * window.devicePixelRatio,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false);\r\n        _this.add(_this.mText);\r\n        return _this;\r\n        // this.on("pointerup", this.onPointerUpHandler, this);\r\n    }\r\n    TextButton.prototype.setText = function (val) {\r\n        this.mText.text = val;\r\n    };\r\n    TextButton.prototype.setFontSize = function (size) {\r\n        this.mText.setFontSize(size);\r\n    };\r\n    TextButton.prototype.setFontStyle = function (val) {\r\n        this.mText.setFontStyle(val);\r\n    };\r\n    TextButton.prototype.setStyle = function (style) {\r\n        this.mText.setStyle(style);\r\n    };\r\n    TextButton.prototype.setNormalColor = function (color) {\r\n        this.normalColor = color;\r\n    };\r\n    TextButton.prototype.setChangeColor = function (color) {\r\n        this.changeColor = color;\r\n    };\r\n    TextButton.prototype.changeDown = function () {\r\n        this.mText.setFill(this.changeColor);\r\n    };\r\n    TextButton.prototype.changeNormal = function () {\r\n        this.mText.setFill(this.normalColor);\r\n    };\r\n    TextButton.prototype.onPointerUpHandler = function (pointer) {\r\n        this.emit("click", pointer, this);\r\n    };\r\n    Object.defineProperty(TextButton.prototype, "text", {\r\n        get: function () {\r\n            return this.mText;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return TextButton;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/TextButton.ts?')},"./src/ui/Market/item.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MarketItem", function() { return MarketItem; });\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar MarketItem = /** @class */ (function (_super) {\r\n    __extends(MarketItem, _super);\r\n    function MarketItem(scene, x, y, dpr, zoom) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = dpr;\r\n        _this.mBackground = _this.scene.make.image({\r\n            key: "market",\r\n            frame: "border"\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        _this.mBorder = _this.scene.make.image({\r\n            x: 3 * dpr * zoom,\r\n            y: 3 * dpr * zoom,\r\n            key: "market",\r\n            frame: "item_border"\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        // this.mBorder.x = -42 * this.dpr;\r\n        // this.mBorder.x = -this.mBackground.width / 2 + this.mBorder.width / 2 + (this.mBackground.height - this.mBorder.height / 2);\r\n        // this.mBorder.x = -(this.mBackground.displayWidth - this.mBorder.displayWidth) / 2 + (this.mBackground.displayHeight - this.mBorder.displayHeight) / 2;\r\n        _this.mPropImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_0__["DynamicImage"](scene, 0, 0);\r\n        _this.mPropImage.scale = _this.dpr * zoom;\r\n        _this.mNickName = _this.scene.make.text({\r\n            x: 62 * _this.dpr * zoom,\r\n            y: 6 * _this.dpr * zoom,\r\n            style: {\r\n                fontSize: 13 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                color: "#3399cc"\r\n            }\r\n        }, false);\r\n        _this.mCoinIcon = _this.scene.make.image({\r\n            x: 45 * _this.dpr * zoom,\r\n            y: 40 * _this.dpr * zoom,\r\n            key: "market",\r\n            frame: "tuding_icon"\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        var priceBg = _this.scene.make.image({\r\n            x: 62 * _this.dpr * zoom,\r\n            y: 39 * _this.dpr * zoom,\r\n            key: "market",\r\n            frame: "price_border"\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        _this.mPriceText = _this.scene.make.text({\r\n            x: 92 * _this.dpr * zoom,\r\n            y: 49 * _this.dpr * zoom,\r\n            style: {\r\n                fontSize: 13 * _this.dpr * zoom,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                color: "#996600"\r\n            }\r\n        }).setOrigin(0.5);\r\n        _this.mTagIcon = _this.scene.make.image({\r\n            key: "market",\r\n            frame: "tip_red",\r\n            x: -86 * _this.dpr,\r\n            y: -34 * _this.dpr\r\n        }, false).setOrigin(0).setScale(zoom);\r\n        _this.add([_this.mBackground, _this.mBorder, _this.mPropImage, _this.mNickName, priceBg, _this.mCoinIcon, _this.mPriceText]);\r\n        _this.setSize(_this.mBackground.displayWidth, _this.mBackground.displayHeight);\r\n        return _this;\r\n    }\r\n    MarketItem.prototype.setProp = function (content) {\r\n        this.mProp = content;\r\n        this.mPropImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(content.icon), this, this.onPropLoadComplete);\r\n        this.mPropImage.x = this.mBorder.x + this.mBorder.displayWidth / 2;\r\n        this.mPropImage.y = this.mBorder.y + this.mBorder.displayHeight / 2;\r\n        var nickname = content.shortName || content.name;\r\n        if (nickname.length > 4) {\r\n            var maxWidth = 50 * this.dpr;\r\n            for (var i = 4; i < nickname.length; i++) {\r\n                var text = nickname.slice(0, i);\r\n                var width = this.mNickName.setText(text).width;\r\n                if (width > maxWidth) {\r\n                    text += "...";\r\n                    nickname = text;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        this.mNickName.setText(nickname);\r\n        this.mPriceText.setText(content.price[0].price.toString());\r\n        var coinIcon = _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Coin"].getIcon(content.price[0].coinType);\r\n        this.mCoinIcon.setFrame(coinIcon);\r\n    };\r\n    MarketItem.prototype.onPropLoadComplete = function () {\r\n        if (this.mPropImage) {\r\n            var texture = this.mPropImage.texture;\r\n            if (texture) {\r\n                texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n            }\r\n        }\r\n    };\r\n    MarketItem.prototype.onPointerUpHandler = function () {\r\n        this.emit("select", this.mProp);\r\n    };\r\n    return MarketItem;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Market/item.ts?')},"./src/ui/MessageBox/MessageBoxMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxMediator", function() { return MessageBoxMediator; });\n/* harmony import */ var _MessageBoxView__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MessageBoxView */ "./src/ui/MessageBox/MessageBoxView.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar MessageBoxMediator = /** @class */ (function (_super) {\r\n    __extends(MessageBoxMediator, _super);\r\n    function MessageBoxMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__["UIType"].Tips;\r\n        return _this;\r\n    }\r\n    MessageBoxMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    MessageBoxMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    MessageBoxMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _MessageBoxView__WEBPACK_IMPORTED_MODULE_0__["MessageBoxView"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToToolTipsLayer(this.mView);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    MessageBoxMediator.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    MessageBoxMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    MessageBoxMediator.prototype.destroy = function () {\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MessageBoxMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (!gameobject)\r\n            return;\r\n        if (gameobject instanceof _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__["NinePatchButton"]) {\r\n            var btn = gameobject.getBtnData();\r\n            if (!btn) {\r\n                return;\r\n            }\r\n            var param = this.mParam[0];\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n            var content = pkt.content;\r\n            content.uiId = param.id;\r\n            content.componentId = btn.node.id;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    return MessageBoxMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MessageBox/MessageBoxMediator.ts?')},"./src/ui/MessageBox/MessageBoxView.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxView", function() { return MessageBoxView; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar MessageBoxView = /** @class */ (function (_super) {\r\n    __extends(MessageBoxView, _super);\r\n    function MessageBoxView(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    MessageBoxView.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n        else {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n    };\r\n    MessageBoxView.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.mButtons = [];\r\n        if (param[0] && param[0].text && param[0].text[0]) {\r\n            this.mTxt.setText(param[0].text[0].text);\r\n        }\r\n        var buttons = param[0].button;\r\n        // buttons.push({text:"测试",});\r\n        if (buttons) {\r\n            var btnWid = 46;\r\n            var btnHei = 24;\r\n            var w = (this.mWidth) / buttons.length;\r\n            var btnSp = this.mScene.make.container(undefined, false);\r\n            btnSp.y = this.mHeight - btnHei - 100;\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                var txt = buttons[i] ? buttons[i].text : "";\r\n                var btn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_1__["NinePatchButton"](this.mScene, 0, 0, btnWid, btnHei, "button_blue", "button_blue", buttons[i].text, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getConfig(), buttons[i]);\r\n                btn.x = i * w + btnWid / 2;\r\n                this.mButtons.push(btn);\r\n                btnSp.add(btn);\r\n            }\r\n            btnSp.setSize((buttons.length - 1) * w + btnWid, btnHei);\r\n            btnSp.x = this.width - btnSp.width >> 1;\r\n            this.add(btnSp);\r\n        }\r\n        this.resize();\r\n    };\r\n    MessageBoxView.prototype.destroy = function () {\r\n        if (this.mTxt) {\r\n            this.mTxt.destroy(true);\r\n        }\r\n        if (this.mButtons && this.mButtons.length > 0) {\r\n            this.mButtons.forEach(function (btn) {\r\n                if (!btn)\r\n                    return;\r\n                btn.destroy(true);\r\n            });\r\n            this.mButtons.length = 0;\r\n            this.mButtons = [];\r\n        }\r\n        this.mTxt = null;\r\n        this.mButtons = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(MessageBoxView.prototype, "buttons", {\r\n        get: function () {\r\n            return this.mButtons;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MessageBoxView.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getJSON());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    MessageBoxView.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mWidth = 300;\r\n        this.mHeight = 200;\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, this.mWidth, this.mHeight, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        border.x = 0;\r\n        border.y = 0;\r\n        this.add(border);\r\n        this.mTxt = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_4__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: "16px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: border.width\r\n            },\r\n            halign: "center"\r\n        });\r\n        this.mTxt.x = -this.mWidth / 2 + 10;\r\n        this.mTxt.y = -this.mHeight / 2 + 10;\r\n        this.add(this.mTxt);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    return MessageBoxView;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MessageBox/MessageBoxView.ts?')},"./src/ui/MineCar/MineCar.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineCar", function() { return MineCar; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar MineCar = /** @class */ (function (_super) {\r\n    __extends(MineCar, _super);\r\n    function MineCar($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    MineCar.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_MINING_MODE_QUERY_MINE_PACKAGE, this.onQueryMinePackageHandler);\r\n        }\r\n    };\r\n    MineCar.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    MineCar.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    MineCar.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    MineCar.prototype.discard = function (items) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MINING_MODE_DELETE_MINEPACKAGE_ITEM);\r\n        var content = packet.content;\r\n        content.items = items;\r\n        this.connection.send(packet);\r\n    };\r\n    MineCar.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    MineCar.prototype.onQueryMinePackageHandler = function (packet) {\r\n        var content = packet.content;\r\n        if (content && content.subcategories)\r\n            content.subcategories.unshift({ key: "all", value: "全部" });\r\n        this.mEvent.emit("query", packet.content);\r\n    };\r\n    Object.defineProperty(MineCar.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return MineCar;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineCar/MineCar.ts?')},"./src/ui/MineCar/MineCarMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineCarMediator", function() { return MineCarMediator; });\n/* harmony import */ var _MineCarPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MineCarPanel */ "./src/ui/MineCar/MineCarPanel.ts");\n/* harmony import */ var _MineCar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MineCar */ "./src/ui/MineCar/MineCar.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar MineCarMediator = /** @class */ (function (_super) {\r\n    __extends(MineCarMediator, _super);\r\n    function MineCarMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.world = worldService;\r\n        _this.mMineCar = new _MineCar__WEBPACK_IMPORTED_MODULE_1__["MineCar"](worldService);\r\n        _this.mMineCar.register();\r\n        _this.mMineCar.on("query", _this.onQueryHandler, _this);\r\n        return _this;\r\n    }\r\n    MineCarMediator.prototype.show = function (param) {\r\n        if (this.mShow) {\r\n            return;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.mView) {\r\n            this.mView = new _MineCarPanel__WEBPACK_IMPORTED_MODULE_0__["MineCarPanel"](this.scene, this.world);\r\n        }\r\n        this.mView.show(param);\r\n        this.mView.on("close", this.onCloseHandler, this);\r\n        this.mView.on("discard", this.onDiscardHandler, this);\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    MineCarMediator.prototype.update = function (param) {\r\n        if (!this.mView) {\r\n            this.show(param);\r\n            return;\r\n        }\r\n        _super.prototype.update.call(this, param);\r\n    };\r\n    MineCarMediator.prototype.destroy = function () {\r\n        this.mShow = false;\r\n        if (this.mMineCar) {\r\n            this.mMineCar.off("query", this.onQueryHandler, this);\r\n            this.mMineCar.unregister();\r\n            this.mMineCar.destroy();\r\n            this.mMineCar = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MineCarMediator.prototype.onQueryHandler = function (packet) {\r\n        this.update(packet);\r\n    };\r\n    MineCarMediator.prototype.onDiscardHandler = function (items) {\r\n        if (this.mMineCar) {\r\n            this.mMineCar.discard(items);\r\n        }\r\n    };\r\n    MineCarMediator.prototype.onCloseHandler = function () {\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = undefined;\r\n        }\r\n        this.mShow = false;\r\n    };\r\n    return MineCarMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineCar/MineCarMediator.ts?')},"./src/ui/MineCar/MineCarPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineCarPanel", function() { return MineCarPanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_alert_view__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/alert.view */ "./src/ui/components/alert.view.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/tab/TabButton */ "./lib/rexui/lib/ui/tab/TabButton.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar MineCarPanel = /** @class */ (function (_super) {\r\n    __extends(MineCarPanel, _super);\r\n    function MineCarPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "mine_car";\r\n        _this.scale = 1;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    MineCarPanel.prototype.resize = function (width, height) {\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        _super.prototype.resize.call(this, width, height);\r\n        var zoom = this.mWorld.uiScale;\r\n        this.setSize(w, h);\r\n        this.mBackGround.clear();\r\n        this.mBackGround.fillStyle(0x6AE2FF, 0);\r\n        this.mBackGround.fillRect(0, 0, w, h);\r\n        this.mBg.x = w / 2;\r\n        this.mBg.y = this.mBg.displayHeight / 2 + 107 * this.dpr * zoom;\r\n        this.carIcon.x = this.mBg.x / 2 - 4 * this.dpr * zoom;\r\n        this.carIcon.y = this.mBg.y - (this.mBg.displayHeight - this.carIcon.displayHeight) / 2 + 4 * this.dpr * zoom;\r\n        this.mCloseBtn.x = this.mBg.x + this.mBg.displayWidth / 2;\r\n        this.mCloseBtn.y = this.mBg.y - (this.mBg.displayHeight - this.mCloseBtn.displayHeight) / 2 + 10 * this.dpr * zoom;\r\n        this.mCounter.x = this.mBg.x / 2;\r\n        this.mCounter.y = this.mBg.y + (this.mBg.displayHeight - this.mDiscardBtn.displayHeight) / 2 - 16 * this.dpr * zoom;\r\n        this.mTips.x = this.mBg.x + 20 * this.dpr * zoom;\r\n        this.mTips.y = this.mBg.y - this.mBg.displayHeight / 2 - 15 * this.dpr * zoom;\r\n        this.mDiscardBtn.x = this.mBg.x + this.mBg.displayWidth / 2 - this.mDiscardBtn.displayWidth / 2 - 9 * this.dpr * zoom;\r\n        this.mDiscardBtn.y = this.mBg.y + this.mBg.displayHeight / 2 - this.mDiscardBtn.displayHeight / 2 - 9 * this.dpr * zoom;\r\n        this.categoriesBg.x = this.mBg.x;\r\n        this.categoriesBg.y = this.mBg.y - this.mBg.displayHeight / 2 + this.categoriesBg.displayHeight / 2 + 38 * this.dpr * zoom;\r\n        this.mPropGrid.refreshPos(this.mBg.x + 2 * this.dpr * zoom, this.mBg.y + 6 * this.dpr * zoom);\r\n        this.mCategoryTable.refreshPos(this.mBg.x, this.mBg.y - this.mBg.displayHeight / 2 + this.categoriesBg.displayHeight / 2 + 44 * this.dpr * zoom);\r\n        this.mPropGrid.resetMask();\r\n        this.mCategoryTable.resetMask();\r\n    };\r\n    MineCarPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized && !this.mPreLoad) {\r\n            this.refreshData();\r\n        }\r\n    };\r\n    MineCarPanel.prototype.update = function (param) {\r\n        _super.prototype.update.call(this, param);\r\n        if (this.mInitialized && this.mShow) {\r\n            this.refreshData();\r\n        }\r\n    };\r\n    MineCarPanel.prototype.setCategories = function (subcategorys) {\r\n        this.mPreSelectedCategorie = undefined;\r\n        this.mCategoryTable.setItems(subcategorys);\r\n    };\r\n    MineCarPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.removeListen();\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n        this.mDiscardBtn.on("Tap", this.enterDiscardMode, this);\r\n    };\r\n    MineCarPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n        this.mDiscardBtn.off("Tap", this.enterDiscardMode, this);\r\n    };\r\n    MineCarPanel.prototype.setProp = function () { };\r\n    MineCarPanel.prototype.destroy = function () {\r\n        if (this.mPropGrid) {\r\n            this.mPropGrid.destroy();\r\n        }\r\n        // if (this.mPanel) {\r\n        //   this.mPanel.removeAll(true);\r\n        // }\r\n        if (this.mCategoryTable) {\r\n            this.mCategoryTable.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MineCarPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "mine_car/mine_car.png", "mine_car/mine_car.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    MineCarPanel.prototype.init = function () {\r\n        var _this = this;\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        this.setSize(w, h);\r\n        // this.mPanel = this.scene.make.container(undefined, false);\r\n        // this.mMask = this.scene.make.graphics(undefined, false);\r\n        var zoom = this.mWorld.uiScale;\r\n        this.mBackGround = this.scene.make.graphics(undefined, false);\r\n        this.mBackGround.clear();\r\n        this.mBackGround.fillStyle(0x6AE2FF, 0);\r\n        this.mBackGround.fillRect(0, 0, w, h);\r\n        this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        this.mBg = this.scene.make\r\n            .image({\r\n            key: this.key,\r\n            frame: "bg.png",\r\n        })\r\n            .setScale(zoom);\r\n        this.mBg.x = w / 2;\r\n        this.mBg.y = h / 2;\r\n        // this.mPanel.setSize(bg.displayWidth, bg.displayHeight);\r\n        this.carIcon = this.scene.make\r\n            .image({\r\n            key: this.key,\r\n            frame: "car_icon.png",\r\n        }, false)\r\n            .setScale(zoom);\r\n        this.carIcon.x = (-(this.mBg.width - this.carIcon.width) * zoom) / 2 + 28 * this.dpr * zoom;\r\n        this.carIcon.y = (-(this.mBg.height - this.carIcon.height / 2) * zoom) / 2 + 10 * this.dpr * zoom;\r\n        this.mCloseBtn = this.scene.make\r\n            .image({\r\n            // x: 110 * this.dpr * zoom,\r\n            // y: -125 * this.dpr * zoom,\r\n            key: this.key,\r\n            frame: "close_btn.png",\r\n        }, false)\r\n            .setScale(zoom);\r\n        this.mCloseBtn.setInteractive();\r\n        this.mCloseBtn.x = (this.mBg.width * zoom) / 2;\r\n        this.mCloseBtn.y = (-(this.mBg.height - this.mCloseBtn.height) * zoom) / 2 + 10 * this.dpr * zoom;\r\n        this.mCounter = this.scene.make.text({\r\n            text: "25/50",\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                color: "#FFFFFF",\r\n                fontSize: 12 * this.dpr * zoom,\r\n            },\r\n        }, false);\r\n        this.mCounter.x = -this.displayWidth / 2 + 17 * this.dpr * zoom;\r\n        this.mCounter.y = this.displayHeight / 2 - 18 * this.dpr * zoom - this.mCounter.height;\r\n        this.mCounter.setFontStyle("bold");\r\n        this.mTips = new Tips(this.scene, this.key, this.dpr, zoom);\r\n        this.mTips.scale = zoom;\r\n        this.mTips.x = 40 * this.dpr * zoom; // - this.mTips.width / 2;\r\n        this.mTips.y = (-(this.mBg.height + this.mTips.height) * zoom) / 2 + 15 * this.dpr * zoom;\r\n        this.mDiscardBtn = new DiscardButton(this.scene, this.key, "yellow_btn.png", undefined, "丢弃");\r\n        this.mDiscardBtn.setScale(zoom);\r\n        (this.mDiscardBtn.x = ((this.mBg.width - this.mDiscardBtn.displayWidth) * zoom) / 2 - 17 * this.dpr * zoom),\r\n            (this.mDiscardBtn.y = ((this.mBg.height - this.mDiscardBtn.displayHeight) * zoom) / 2 - 10 * this.dpr * zoom),\r\n            this.mDiscardBtn.setTextStyle({\r\n                color: "##996600",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                fontSize: 10 * this.dpr * zoom,\r\n            });\r\n        this.mDiscardBtn.changeState(DiscardEnum.Discard);\r\n        this.categoriesBg = this.scene.make\r\n            .image({\r\n            key: this.key,\r\n            frame: "nav_bg.png",\r\n        })\r\n            .setScale(zoom);\r\n        // this.categoriesBg.y = -111 * this.dpr * zoom + this.categoriesBg.height * zoom / 2;\r\n        this.categoriesBg.y = -(this.displayHeight - this.categoriesBg.displayHeight) / 2 + 36 * this.dpr * zoom;\r\n        var propFrame = this.scene.textures.getFrame(this.key, "item_border.png");\r\n        var capW = propFrame.width * zoom + 4 * this.dpr * zoom;\r\n        var capH = propFrame.height * zoom + 4 * this.dpr * zoom;\r\n        // this.cellHeight = capH;\r\n        var gridW = 236 * this.dpr * zoom;\r\n        var propConfig = {\r\n            x: -7 * this.dpr * zoom,\r\n            y: -16 * this.dpr * zoom,\r\n            table: {\r\n                width: gridW,\r\n                height: 295 * this.dpr * zoom,\r\n                columns: 4,\r\n                cellsCount: 25,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0\r\n                // mask: false\r\n            },\r\n            scrollMode: 0,\r\n            clamplChildOY: false,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new PackageItem(scene, _this.key, _this.dpr, zoom);\r\n                    _this.add(cellContainer);\r\n                }\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setProp(item);\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mPropGrid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_5__["GameGridTable"](this.scene, propConfig);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.on("cellTap", function (cell) {\r\n            // const item = cell.getData("item");\r\n            // if (item) {\r\n            _this.onSelectItemHandler(cell);\r\n            // }\r\n        });\r\n        var frame = this.scene.textures.getFrame(this.key, "nav_btn_normal.png");\r\n        var categoryTableConfig = {\r\n            x: -9 * this.dpr * zoom,\r\n            y: -155 * this.dpr * zoom,\r\n            table: {\r\n                width: gridW,\r\n                height: this.categoriesBg.displayHeight,\r\n                cellWidth: (frame.width + 4 * this.dpr) * zoom,\r\n                cellHeight: (29 * this.dpr) * zoom,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0\r\n                // mask: false\r\n            },\r\n            scrollMode: 1,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new CategorieButton(scene, _this.key, "nav_btn_normal.png", "nav_btn_down.png", "1");\r\n                    cellContainer.setTextStyle({\r\n                        color: "#566ddb",\r\n                        fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                        fontSize: 10 * _this.dpr * zoom\r\n                    });\r\n                    cellContainer.setFontStyle("bold");\r\n                    cellContainer.setScale(zoom);\r\n                    _this.add(cellContainer);\r\n                }\r\n                cellContainer.setText(item.value);\r\n                cellContainer.setData("data", item);\r\n                if (!_this.mPreSelectedCategorie) {\r\n                    _this.onClickCategoryHandler(cellContainer);\r\n                }\r\n                return cellContainer;\r\n            }\r\n        };\r\n        this.mCategoryTable = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_5__["GameGridTable"](this.scene, categoryTableConfig);\r\n        this.mCategoryTable.layout();\r\n        this.mCategoryTable.on("cellTap", function (cell) {\r\n            _this.onClickCategoryHandler(cell);\r\n        });\r\n        // this.add(this.mPanel);\r\n        this.add([\r\n            this.mBackGround,\r\n            this.mBg,\r\n            this.carIcon,\r\n            this.mCounter,\r\n            this.categoriesBg,\r\n            this.mPropGrid.table,\r\n            this.mCategoryTable.table,\r\n            this.mCloseBtn,\r\n            this.mDiscardBtn,\r\n        ]);\r\n        this.resize(this.scene.cameras.main.width, this.scene.cameras.main.height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    MineCarPanel.prototype.refreshData = function () {\r\n        var minePackage = this.mShowData;\r\n        var mineItem = minePackage.items || [];\r\n        this.mLimit = minePackage.limit || 0;\r\n        this.mAllItem = [];\r\n        for (var _i = 0, mineItem_1 = mineItem; _i < mineItem_1.length; _i++) {\r\n            var item = mineItem_1[_i];\r\n            this.mAllItem.push({ item: item });\r\n        }\r\n        this.mDiscardBtn.changeState(DiscardEnum.Discard);\r\n        this.mCounter.setText(mineItem.length + "/" + this.mLimit);\r\n        this.setCategories(minePackage.subcategories);\r\n    };\r\n    MineCarPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n    };\r\n    MineCarPanel.prototype.onSelectedCategory = function (subcategory) {\r\n        this.mFilterItem = [];\r\n        var pkgItem = null;\r\n        for (var _i = 0, _a = this.mAllItem; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            pkgItem = item.item;\r\n            if (pkgItem && (pkgItem.subcategory === subcategory || subcategory === "all")) {\r\n                this.mFilterItem.push(item);\r\n            }\r\n        }\r\n        var len = this.mLimit - this.mFilterItem.length;\r\n        for (var i = 0; i < len; i++) {\r\n            this.mFilterItem.push({ item: null });\r\n        }\r\n        this.mPropGrid.setItems(this.mFilterItem);\r\n    };\r\n    MineCarPanel.prototype.onSelectItemHandler = function (packageItem) {\r\n        if (this.mDiscardBtn && this.mDiscardBtn.buttonState !== DiscardEnum.Discard) {\r\n            packageItem.switchSelect();\r\n            this.checkMode();\r\n            return;\r\n        }\r\n        if (packageItem && packageItem.item.item) {\r\n            if (!this.mTips.parentContainer) {\r\n                this.add(this.mTips);\r\n            }\r\n            this.mTips.setItem(packageItem.item.item);\r\n        }\r\n        else {\r\n            this.remove(this.mTips);\r\n        }\r\n    };\r\n    MineCarPanel.prototype.onClickCategoryHandler = function (item) {\r\n        var data = item.getData("data");\r\n        if (data) {\r\n            this.onSelectedCategory(data.key);\r\n            if (this.mPreSelectedCategorie) {\r\n                this.mPreSelectedCategorie.changeNormal();\r\n            }\r\n            item.changeDown();\r\n            this.mPreSelectedCategorie = item;\r\n        }\r\n    };\r\n    MineCarPanel.prototype.checkMode = function () {\r\n        if (!this.mFilterItem || this.mFilterItem.length < 1) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.mFilterItem; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            if (item.selected) {\r\n                this.mDiscardBtn.changeState(DiscardEnum.Sutmit);\r\n                return;\r\n            }\r\n        }\r\n        this.mDiscardBtn.changeState(DiscardEnum.Cancel);\r\n    };\r\n    MineCarPanel.prototype.onDiscardSelectedItem = function () {\r\n        var _this = this;\r\n        if (!this.mFilterItem || this.mFilterItem.length < 1) {\r\n            return;\r\n        }\r\n        // const selected = this.mAllItem.filter((item) => item.selected);\r\n        var selected = [];\r\n        var label = [];\r\n        for (var _i = 0, _a = this.mFilterItem; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            if (item.item && item.selected) {\r\n                selected.push(item.item);\r\n                label.push(item.item.name + "*" + item.item.count);\r\n            }\r\n        }\r\n        new _components_alert_view__WEBPACK_IMPORTED_MODULE_4__["AlertView"](this.scene, this.mWorld).show({\r\n            text: "\\u60A8\\u786E\\u5B9A\\u8981\\u4E22\\u5F03 [color=#0157BC]" + label.join("、") + "[/color] \\u5417\\uFF1F",\r\n            title: "丢弃",\r\n            oy: 302 * this.dpr * this.mWorld.uiScale,\r\n            callback: function () {\r\n                _this.emit("discard", selected);\r\n            },\r\n        });\r\n    };\r\n    MineCarPanel.prototype.enterDiscardMode = function () {\r\n        if (!this.mFilterItem) {\r\n            return;\r\n        }\r\n        var state = this.mDiscardBtn.buttonState;\r\n        var visible = false;\r\n        if (state === DiscardEnum.Discard) {\r\n            this.mDiscardBtn.changeState(DiscardEnum.Cancel);\r\n            visible = true;\r\n        }\r\n        else {\r\n            if (state === DiscardEnum.Sutmit) {\r\n                this.onDiscardSelectedItem();\r\n            }\r\n            this.mDiscardBtn.changeState(DiscardEnum.Discard);\r\n        }\r\n        if (this.mFilterItem.length > 0 && this.mFilterItem[0].selectVisible !== visible) {\r\n            this.mFilterItem.map(function (item) {\r\n                item.selectVisible = visible;\r\n                item.selected = false;\r\n            });\r\n            this.mPropGrid.setItems(this.mFilterItem);\r\n        }\r\n    };\r\n    return MineCarPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_2__["BasePanel"]));\r\n\r\nvar PackageItem = /** @class */ (function (_super) {\r\n    __extends(PackageItem, _super);\r\n    function PackageItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var border = _this.scene.make\r\n            .image({\r\n            key: key,\r\n            frame: "item_border.png",\r\n        }, false)\r\n            .setOrigin(0)\r\n            .setScale(zoom);\r\n        _this.setSize(border.width * zoom, border.height * zoom);\r\n        _this.mItemImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.mItemImage.setOrigin(0);\r\n        _this.mItemImage.setScale(dpr * zoom);\r\n        _this.mCounter = _this.scene.make\r\n            .text({\r\n            x: border.displayWidth - 2 * dpr,\r\n            y: border.displayHeight - 1 * dpr,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                fontSize: 9 * dpr * zoom,\r\n                color: "#566DDB",\r\n            },\r\n        })\r\n            .setOrigin(1);\r\n        _this.mCounter.setFontStyle("bold");\r\n        _this.mSelectedIcon = _this.scene.make.image({\r\n            key: key,\r\n            frame: "icon_normal.png",\r\n        }, false);\r\n        _this.mSelectedIcon.x = border.width * zoom - 2 * dpr - (_this.mSelectedIcon.width * zoom) / 2;\r\n        _this.mSelectedIcon.y = 2 * dpr + (_this.mSelectedIcon.height * zoom) / 2;\r\n        _this.add(border);\r\n        _this.add([_this.mItemImage, _this.mCounter, _this.mSelectedIcon]);\r\n        return _this;\r\n    }\r\n    PackageItem.prototype.setProp = function (data) {\r\n        this.mItem = data;\r\n        var packageItem = data.item;\r\n        if (!data || !packageItem) {\r\n            this.mItemImage.visible = false;\r\n            this.mCounter.visible = false;\r\n            this.mSelectedIcon.visible = false;\r\n            return;\r\n        }\r\n        if (this.mItem) {\r\n            this.mItemImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(packageItem.display.texturePath), this, this.onLoadCompleteHandler);\r\n            this.mItemImage.visible = true;\r\n            if (packageItem.count > 1) {\r\n                this.mCounter.setText(packageItem.count.toString());\r\n                this.mCounter.visible = true;\r\n            }\r\n            else {\r\n                this.mCounter.visible = false;\r\n            }\r\n            this.mSelectedIcon.visible = (this.mItem.selectVisible ? true : false);\r\n            this.setSelected();\r\n        }\r\n    };\r\n    PackageItem.prototype.switchSelect = function () {\r\n        if (!this.mItem.item) {\r\n            return;\r\n        }\r\n        this.mItem.selected = !this.mItem.selected;\r\n        this.setSelected();\r\n    };\r\n    Object.defineProperty(PackageItem.prototype, "item", {\r\n        get: function () {\r\n            return this.mItem;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PackageItem.prototype.onLoadCompleteHandler = function () {\r\n        if (this.mItemImage) {\r\n            this.mItemImage.x = (this.width - this.mItemImage.displayWidth) >> 1;\r\n            this.mItemImage.y = (this.height - this.mItemImage.displayHeight) >> 1;\r\n        }\r\n    };\r\n    PackageItem.prototype.setSelected = function () {\r\n        if (this.mItem.selected) {\r\n            this.mSelectedIcon.setFrame("icon_selected.png");\r\n        }\r\n        else {\r\n            this.mSelectedIcon.setFrame("icon_normal.png");\r\n        }\r\n    };\r\n    return PackageItem;\r\n}(Phaser.GameObjects.Container));\r\nvar Tips = /** @class */ (function (_super) {\r\n    __extends(Tips, _super);\r\n    function Tips(scene, key, dpr, zoom) {\r\n        if (zoom === void 0) { zoom = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mDpr = dpr;\r\n        var bg = _this.scene.make.image({\r\n            key: key,\r\n            frame: "tips_bg.png",\r\n        }, false);\r\n        _this.mName = _this.scene.make.text({\r\n            x: -bg.width / 2 + 12 * dpr * zoom,\r\n            y: -bg.height / 2 + 5 * dpr * zoom,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                fontSize: 10 * dpr * zoom,\r\n                color: "#000000",\r\n            },\r\n        }, false);\r\n        _this.mDes = _this.scene.make\r\n            .text({\r\n            x: _this.mName.x,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n                fontSize: 10 * dpr * zoom,\r\n                color: "#000000",\r\n            },\r\n        }, false)\r\n            .setOrigin(0, 1);\r\n        _this.add([bg, _this.mName, _this.mDes]);\r\n        _this.setSize(bg.width * zoom, bg.height * zoom);\r\n        return _this;\r\n    }\r\n    Tips.prototype.setItem = function (item) {\r\n        if (!item) {\r\n            return;\r\n        }\r\n        var tmpY = this.y;\r\n        var tmpAlpha = this.alpha;\r\n        this.y = tmpY + 50 * this.mDpr;\r\n        this.alpha = 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            props: {\r\n                alpha: tmpAlpha,\r\n                y: tmpY,\r\n            },\r\n            duration: 200,\r\n            ease: Phaser.Math.Easing.Elastic.Out,\r\n        });\r\n        this.mName.setText(item.shortName || item.name);\r\n        this.mDes.setText(item.des);\r\n    };\r\n    return Tips;\r\n}(Phaser.GameObjects.Container));\r\nvar DiscardButton = /** @class */ (function (_super) {\r\n    __extends(DiscardButton, _super);\r\n    function DiscardButton(scene, key, frame, downFrame, text) {\r\n        return _super.call(this, scene, key, frame, downFrame, text) || this;\r\n    }\r\n    DiscardButton.prototype.changeState = function (val) {\r\n        if (this.mState === val) {\r\n            return;\r\n        }\r\n        this.mState = val;\r\n        switch (val) {\r\n            case DiscardEnum.Cancel:\r\n                this.setText("取消");\r\n                this.setFrame("gray_btn.png");\r\n                break;\r\n            case DiscardEnum.Sutmit:\r\n                this.setText("提交");\r\n                this.setFrame("yellow_btn.png");\r\n                break;\r\n            default:\r\n                this.setText("丢弃");\r\n                this.setFrame("yellow_btn.png");\r\n                break;\r\n        }\r\n    };\r\n    Object.defineProperty(DiscardButton.prototype, "buttonState", {\r\n        get: function () {\r\n            return this.mState;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DiscardButton;\r\n}(_lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_6__["Button"]));\r\nvar DiscardEnum;\r\n(function (DiscardEnum) {\r\n    DiscardEnum[DiscardEnum["Discard"] = 0] = "Discard";\r\n    DiscardEnum[DiscardEnum["Cancel"] = 1] = "Cancel";\r\n    DiscardEnum[DiscardEnum["Sutmit"] = 2] = "Sutmit";\r\n})(DiscardEnum || (DiscardEnum = {}));\r\nvar CategorieButton = /** @class */ (function (_super) {\r\n    __extends(CategorieButton, _super);\r\n    function CategorieButton(scene, key, frame, downFrame, text) {\r\n        var _this = _super.call(this, scene, key, frame, downFrame, text) || this;\r\n        _this.disInteractive();\r\n        _this.removeListen();\r\n        _this.mBackground.setOrigin(0);\r\n        if (_this.mText) {\r\n            _this.mText.setPosition(_this.mBackground.width / 2, _this.mBackground.height / 2);\r\n        }\r\n        return _this;\r\n    }\r\n    return CategorieButton;\r\n}(_lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_7__["TabButton"]));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineCar/MineCarPanel.ts?')},"./src/ui/MineSettle/MineSettle.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineSettle", function() { return MineSettle; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar MineSettle = /** @class */ (function (_super) {\r\n    __extends(MineSettle, _super);\r\n    function MineSettle(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    MineSettle.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_MINING_MODE_SHOW_REWARD_PACKAGE, this.onMineSettlePackageHandler);\r\n        }\r\n    };\r\n    MineSettle.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    MineSettle.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    MineSettle.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    MineSettle.prototype.reqMineSettlePacket = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_MINING_MODE_STORAGE_REWARD);\r\n        this.connection.send(packet);\r\n    };\r\n    MineSettle.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(MineSettle.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MineSettle.prototype.onMineSettlePackageHandler = function (packge) {\r\n        var content = packge.content;\r\n        this.mEvent.emit("minesettlepacket", content);\r\n    };\r\n    return MineSettle;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineSettle/MineSettle.ts?')},"./src/ui/MineSettle/MineSettleMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineSettleMediator", function() { return MineSettleMediator; });\n/* harmony import */ var _MineSettlePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MineSettlePanel */ "./src/ui/MineSettle/MineSettlePanel.ts");\n/* harmony import */ var _MineSettle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MineSettle */ "./src/ui/MineSettle/MineSettle.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar MineSettleMediator = /** @class */ (function (_super) {\r\n    __extends(MineSettleMediator, _super);\r\n    function MineSettleMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        if (!_this.mineSettle) {\r\n            _this.mineSettle = new _MineSettle__WEBPACK_IMPORTED_MODULE_1__["MineSettle"](_this.world);\r\n            _this.mineSettle.on("minesettlepacket", _this.onMineSettlePacket, _this);\r\n            _this.mineSettle.register();\r\n        }\r\n        return _this;\r\n    }\r\n    MineSettleMediator.prototype.show = function (param) {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _MineSettlePanel__WEBPACK_IMPORTED_MODULE_0__["MineSettlePanel"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHideMineSettle, this);\r\n        }\r\n        _super.prototype.show.call(this);\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        if (this.mParam && this.mParam.length > 0)\r\n            this.setMIneSettlePanel(this.mParam[0]);\r\n        this.mView.show();\r\n    };\r\n    MineSettleMediator.prototype.destroy = function () {\r\n        if (this.mineSettle)\r\n            this.mineSettle.destroy();\r\n        this.mineSettle = undefined;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MineSettleMediator.prototype.onHideMineSettle = function () {\r\n        this.mineSettle.reqMineSettlePacket();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MineSettleMediator.prototype.onMineSettlePacket = function (content) {\r\n        if (!this.mView || !this.mView.visible) {\r\n            this.setParam([content]);\r\n            this.show();\r\n        }\r\n        else {\r\n            this.setMIneSettlePanel(content);\r\n        }\r\n    };\r\n    MineSettleMediator.prototype.setMIneSettlePanel = function (content) {\r\n        var panel = this.mView;\r\n        panel.setData("settleData", content);\r\n        panel.setMineSettlePacket(content);\r\n    };\r\n    return MineSettleMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineSettle/MineSettleMediator.ts?')},"./src/ui/MineSettle/MineSettlePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MineSettlePanel", function() { return MineSettlePanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar MineSettlePanel = /** @class */ (function (_super) {\r\n    __extends(MineSettlePanel, _super);\r\n    function MineSettlePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "mine_settle";\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    MineSettlePanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.bg.x = width / 2;\r\n        this.bg.y = height / 2;\r\n        this.titleimage.x = width / 2;\r\n        this.titleimage.y = this.bg.y - this.bg.displayHeight / 2 - 8 * this.dpr;\r\n        this.confirmBtn.x = width / 2;\r\n        this.confirmBtn.y = this.bg.y + 100 * this.dpr;\r\n        this.titleName.x = width / 2;\r\n        this.titleName.y = this.titleimage.y + 32 * this.dpr;\r\n        this.blackGraphic.clear();\r\n        this.blackGraphic.fillStyle(0, 0.66);\r\n        this.blackGraphic.fillRect(0, 0, width / this.scale, height / this.scale);\r\n        this.mPropGrid.refreshPos(width / 2, this.bg.y - 2 * this.dpr);\r\n        this.mPropGrid.resetMask();\r\n        this.setSize(width * this.scale * this.scale, height * this.scale * this.scale);\r\n    };\r\n    MineSettlePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        this.refreshData();\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n    };\r\n    MineSettlePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.confirmBtn.on("click", this.onConfirmBtnClick, this);\r\n    };\r\n    MineSettlePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.confirmBtn.off("click", this.onConfirmBtnClick, this);\r\n    };\r\n    MineSettlePanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "minesettle/settlement.png", "minesettle/settlement.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    MineSettlePanel.prototype.init = function () {\r\n        var _this = this;\r\n        var width = this.cameraWidth;\r\n        var height = this.cameraHeight;\r\n        this.bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 293 * this.dpr, 260 * this.dpr, this.key, "bg", {\r\n            left: 10,\r\n            top: 10,\r\n            right: 10,\r\n            bottom: 10\r\n        });\r\n        this.blackGraphic = this.scene.make.graphics(undefined, false);\r\n        this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        var propFrame = this.scene.textures.getFrame(this.key, "icon_test");\r\n        var zoom = this.scale;\r\n        var capW = (propFrame.width + 20 * this.dpr * zoom);\r\n        var capH = (propFrame.height + 25 * this.dpr * zoom);\r\n        var config = {\r\n            x: 0,\r\n            y: 0,\r\n            table: {\r\n                width: 280 * this.dpr * zoom,\r\n                height: 160 * this.dpr * zoom,\r\n                columns: 5,\r\n                cellWidth: capW,\r\n                cellHeight: capH,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0,\r\n                cellOriginY: 0,\r\n                cellPadX: 18 * this.dpr * zoom,\r\n                zoom: this.scale\r\n            },\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, .2),\r\n            clamplChildOY: false,\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new MineSettleItem(scene, _this.dpr);\r\n                    _this.add(cellContainer);\r\n                }\r\n                cellContainer.setData({ item: item });\r\n                cellContainer.setItemData(item);\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mPropGrid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_6__["GameGridTable"](this.scene, config);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.on("cellTap", function (cell) {\r\n            var data = cell.itemData;\r\n            if (data) {\r\n                _this.onSelectItemHandler(data);\r\n            }\r\n        });\r\n        this.titleimage = this.scene.make.image({ x: 0, y: -this.bg.displayWidth * 0.5 - 10 * this.dpr, key: this.key, frame: "title" }, false);\r\n        this.titleName = this.scene.make.text({\r\n            x: 0, y: this.titleimage.y + 32 * this.dpr, text: _i18n__WEBPACK_IMPORTED_MODULE_7__["i18n"].t("minesettle.settle"),\r\n            style: { fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT }\r\n        }).setOrigin(0.5, 0.5);\r\n        this.confirmBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_4__["NinePatchButton"](this.scene, 0, 100 * this.dpr, 90 * this.dpr, 40 * this.dpr, this.key, "button", _i18n__WEBPACK_IMPORTED_MODULE_7__["i18n"].t("minesettle.savebag"), {\r\n            left: 20,\r\n            top: 20,\r\n            right: 20,\r\n            bottom: 20\r\n        });\r\n        this.confirmBtn.setTextStyle({\r\n            color: "#976400",\r\n            fontSize: 16 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n        });\r\n        this.add([this.blackGraphic, this.bg, this.titleimage, this.titleName, this.confirmBtn]);\r\n        this.add(this.mPropGrid.table);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    MineSettlePanel.prototype.setMineSettlePacket = function (content) {\r\n        if (this.mInitialized) {\r\n            this.mPropGrid.setItems(content.items);\r\n        }\r\n    };\r\n    MineSettlePanel.prototype.destroy = function () {\r\n        if (this.mPropGrid)\r\n            this.mPropGrid.destroy();\r\n        if (this.confirmBtn)\r\n            this.confirmBtn.destroy();\r\n        this.mPropGrid = null;\r\n        this.confirmBtn = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MineSettlePanel.prototype.refreshData = function () {\r\n        var settleData = this.getData("settleData");\r\n        if (settleData)\r\n            this.setMineSettlePacket(settleData);\r\n    };\r\n    MineSettlePanel.prototype.onSelectItemHandler = function (data) {\r\n    };\r\n    MineSettlePanel.prototype.onConfirmBtnClick = function (pointer) {\r\n        if (!this.checkPointerDis(pointer))\r\n            return;\r\n        this.emit("hide");\r\n    };\r\n    MineSettlePanel.prototype.checkPointerDis = function (pointer) {\r\n        if (!this.mWorld)\r\n            return true;\r\n        return Math.abs(pointer.downX - pointer.upX) < 10 * this.mWorld.uiRatio * this.mWorld.uiScale &&\r\n            Math.abs(pointer.downY - pointer.upY) < 10 * this.mWorld.uiRatio * this.mWorld.uiScale;\r\n    };\r\n    return MineSettlePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_2__["BasePanel"]));\r\n\r\nvar MineSettleItem = /** @class */ (function (_super) {\r\n    __extends(MineSettleItem, _super);\r\n    function MineSettleItem(scene, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](scene, 0, 0);\r\n        _this.itemCount = _this.scene.make.text({\r\n            text: "600",\r\n            style: {\r\n                fontSize: 18,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false);\r\n        _this.itemCount.setOrigin(0.5, 0);\r\n        _this.icon.setOrigin(0, 0);\r\n        _this.icon.setScale(_this.dpr);\r\n        // this.icon.setSize(50, 50);\r\n        _this.itemCount.setPosition(0, _this.icon.height);\r\n        _this.add(_this.icon);\r\n        _this.add(_this.itemCount);\r\n        return _this;\r\n    }\r\n    MineSettleItem.prototype.setItemData = function (data) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        this.itemCount.setFontSize(this.dpr * 14);\r\n        this.itemCount.text = data.count + "";\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Url"].getOsdRes(data.display.texturePath);\r\n        this.icon.load(url, this, function () {\r\n            ///  this.icon.setDisplaySize(33 * this.dpr, 33 * this.dpr);\r\n            _this.icon.setScale(33 * _this.dpr / _this.icon.width);\r\n            _this.icon.setPosition(0, 3 * _this.dpr);\r\n            _this.itemCount.setPosition(_this.icon.displayWidth * 0.5, _this.icon.x + _this.icon.displayHeight + 3 * _this.dpr);\r\n        });\r\n    };\r\n    MineSettleItem.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        if (this.icon)\r\n            this.icon.destroy();\r\n        if (this.itemCount)\r\n            this.itemCount.destroy();\r\n        this.itemData = null;\r\n        this.icon = null;\r\n        this.itemCount = null;\r\n        this.scene = null;\r\n    };\r\n    return MineSettleItem;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/MineSettle/MineSettlePanel.ts?')},"./src/ui/Notice/Notice.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Notice", function() { return Notice; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Notice = /** @class */ (function (_super) {\r\n    __extends(Notice, _super);\r\n    function Notice(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Notice.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Notice.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Notice.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_NOTICE, this.noticeHandler);\r\n        }\r\n    };\r\n    Notice.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Object.defineProperty(Notice.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Notice.prototype.noticeHandler = function (packet) {\r\n        if (!packet || !packet.content) {\r\n            return;\r\n        }\r\n        this.mEvent.emit("showNotice", packet);\r\n    };\r\n    return Notice;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Notice/Notice.ts?')},"./src/ui/Notice/NoticeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NoticeMediator", function() { return NoticeMediator; });\n/* harmony import */ var _NoticePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./NoticePanel */ "./src/ui/Notice/NoticePanel.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _Notice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Notice */ "./src/ui/Notice/Notice.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar NoticeMediator = /** @class */ (function (_super) {\r\n    __extends(NoticeMediator, _super);\r\n    function NoticeMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = worldService;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.notice = new _Notice__WEBPACK_IMPORTED_MODULE_3__["Notice"](worldService);\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_4__["UIType"].Tips;\r\n        _this.addListen();\r\n        return _this;\r\n    }\r\n    NoticeMediator.prototype.setUiScale = function (value) {\r\n        this.mView.scale = value;\r\n    };\r\n    NoticeMediator.prototype.getView = function () {\r\n        return this.mView !== undefined ? this.mView : undefined;\r\n    };\r\n    NoticeMediator.prototype.getUIType = function () {\r\n        return this.mUIType;\r\n    };\r\n    NoticeMediator.prototype.hide = function () {\r\n        if (!this.mView)\r\n            return;\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    NoticeMediator.prototype.destroy = function () {\r\n        this.removeListen();\r\n        this.notice.unregister();\r\n        this.notice = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    NoticeMediator.prototype.isShow = function () {\r\n        return this.mView.isShow();\r\n    };\r\n    NoticeMediator.prototype.resize = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.resize();\r\n    };\r\n    NoticeMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            this.mView.showNotice(param);\r\n            return;\r\n        }\r\n        this.mView = new _NoticePanel__WEBPACK_IMPORTED_MODULE_0__["NoticePanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.mView.showNotice(param);\r\n        this.mLayerManager.addToDialogLayer(this.mView);\r\n        // this.setUiScale(this.world.uiScale);\r\n    };\r\n    NoticeMediator.prototype.update = function (param) {\r\n        this.mParam = param;\r\n        if (!this.mView)\r\n            return;\r\n    };\r\n    NoticeMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    NoticeMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    NoticeMediator.prototype.addListen = function () {\r\n        this.notice.on("showNotice", this.noticeHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SHOW_NOTICE, this.noticeHandler, this);\r\n        this.notice.register();\r\n    };\r\n    NoticeMediator.prototype.removeListen = function () {\r\n        this.notice.off("showNotice", this.noticeHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SHOW_NOTICE, this.noticeHandler, this);\r\n    };\r\n    NoticeMediator.prototype.noticeHandler = function (packet) {\r\n        if (!packet || !packet.content) {\r\n            return;\r\n        }\r\n        this.show(packet.content);\r\n    };\r\n    NoticeMediator.NAME = "NoticeMediator";\r\n    return NoticeMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Notice/NoticeMediator.ts?')},"./src/ui/Notice/NoticePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NoticePanel", function() { return NoticePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar NoticePanel = /** @class */ (function (_super) {\r\n    __extends(NoticePanel, _super);\r\n    function NoticePanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    NoticePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.resize();\r\n        this.scale = this.mWorld.uiRatio;\r\n        this.refreshData();\r\n    };\r\n    NoticePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    NoticePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    NoticePanel.prototype.destroy = function () {\r\n        if (this.mContentText) {\r\n            this.mContentText.destroy();\r\n            this.mContentText = null;\r\n        }\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            this.mTween = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    NoticePanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        var view = this.scene.cameras.main.worldView;\r\n        this.x = view.x + view.width + wid >> 1;\r\n        this.y = 180 + hei;\r\n    };\r\n    NoticePanel.prototype.showNotice = function (data) {\r\n        var _this = this;\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!data)\r\n            return;\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n        }\r\n        var color = "#FFFFFF";\r\n        var delay = 5000;\r\n        var setting = data.chatsetting;\r\n        if (setting) {\r\n            if (setting.textColor) {\r\n                color = setting.textColor;\r\n            }\r\n            if (setting.duration) {\r\n                delay = setting.duration;\r\n            }\r\n        }\r\n        this.mContentText.setText(data.noticeContext);\r\n        this.mContentText.setFill(color);\r\n        this.mContentText.x = -(this.mContentText.width >> 1);\r\n        this.mContentText.y = -(this.mContentText.height >> 1);\r\n        this.mTween = this.scene.tweens.add({\r\n            targets: this,\r\n            alpha: 0,\r\n            duration: 200,\r\n            delay: delay,\r\n            onComplete: function () {\r\n                _this.removeFromParent();\r\n            }\r\n        });\r\n    };\r\n    NoticePanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    NoticePanel.prototype.init = function () {\r\n        // const background = new NinePatch(this.scene, {\r\n        //     width: 1200,\r\n        //     height: 120,\r\n        //     key: Border.getName(),\r\n        //     columns: Border.getColumns(),\r\n        //     rows: Border.getRows()\r\n        // });\r\n        var background = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 1200, 120, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.add(background);\r\n        this.mContentText = this.scene.make.text({\r\n            align: "center",\r\n            style: {\r\n                fontFamily: "bold YaHei",\r\n                fontSize: 20 * this.dpr * this.mWorld.uiScale,\r\n                wordWrap: { width: 1180, useAdvancedWrap: true },\r\n            },\r\n        }, false)\r\n            .setStroke("#000000", 1);\r\n        this.add(this.mContentText);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    NoticePanel.prototype.refreshData = function () {\r\n        var data = this.mShowData;\r\n        if (data) {\r\n            this.showNotice(data);\r\n        }\r\n    };\r\n    NoticePanel.prototype.removeFromParent = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            this.mTween = null;\r\n        }\r\n        this.mShow = false;\r\n    };\r\n    return NoticePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Notice/NoticePanel.ts?')},"./src/ui/PicFurniFun/PicFurniFun.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicFurniFun", function() { return PicFurniFun; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicFurniFun = /** @class */ (function (_super) {\r\n    __extends(PicFurniFun, _super);\r\n    function PicFurniFun($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicFurniFun.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_UNLOCK_ELEMENT_REQUIREMENT, this.onRetOpenPanel);\r\n        }\r\n    };\r\n    PicFurniFun.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicFurniFun.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicFurniFun.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicFurniFun.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    PicFurniFun.prototype.queryUnlockElement = function (ids) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_UNLOCK_ELEMENT);\r\n        var content = packet.content;\r\n        content.ids = ids;\r\n        this.connection.send(packet);\r\n    };\r\n    PicFurniFun.prototype.onRetOpenPanel = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("openview", content);\r\n    };\r\n    Object.defineProperty(PicFurniFun.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return PicFurniFun;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicFurniFun/PicFurniFun.ts?')},"./src/ui/PicFurniFun/PicFurniFunMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicFurniFunMediator", function() { return PicFurniFunMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicFurniFunPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicFurniFunPanel */ "./src/ui/PicFurniFun/PicFurniFunPanel.ts");\n/* harmony import */ var _PicFurniFun__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PicFurniFun */ "./src/ui/PicFurniFun/PicFurniFun.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicFurniFunMediator = /** @class */ (function (_super) {\r\n    __extends(PicFurniFunMediator, _super);\r\n    function PicFurniFunMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        if (!_this.picFurni) {\r\n            _this.picFurni = new _PicFurniFun__WEBPACK_IMPORTED_MODULE_2__["PicFurniFun"](_this.world);\r\n            _this.picFurni.register();\r\n            _this.picFurni.on("openview", _this.onOpenView, _this);\r\n        }\r\n        return _this;\r\n    }\r\n    PicFurniFunMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicFurniFunPanel__WEBPACK_IMPORTED_MODULE_1__["PicFurniFunPanel"](this.scene, this.world);\r\n            this.mView.on("close", this.onCloseHandler, this);\r\n            this.mView.on("queryunlock", this.queryUnlockElement, this);\r\n        }\r\n        this.mView.show(this.mParam);\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicFurniFunMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicFurniFunMediator.prototype.destroy = function () {\r\n        if (this.picFurni) {\r\n            this.picFurni.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicFurniFunMediator.prototype.onCloseHandler = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicFurniFunMediator.prototype.onOpenView = function (content) {\r\n        this.setParam(content);\r\n        this.show();\r\n    };\r\n    PicFurniFunMediator.prototype.queryUnlockElement = function (ids) {\r\n        this.picFurni.queryUnlockElement(ids);\r\n    };\r\n    return PicFurniFunMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicFurniFun/PicFurniFunMediator.ts?')},"./src/ui/PicFurniFun/PicFurniFunPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicFurniFunPanel", function() { return PicFurniFunPanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/GameScroller */ "./lib/rexui/lib/ui/scroller/GameScroller.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../Market/DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PicFurniFunPanel = /** @class */ (function (_super) {\r\n    __extends(PicFurniFunPanel, _super);\r\n    function PicFurniFunPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "furni_unlock";\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    PicFurniFunPanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.blackGraphic.clear();\r\n        this.blackGraphic.fillStyle(0, 0.66);\r\n        this.blackGraphic.fillRect(0, 0, width / this.scale, height / this.scale);\r\n        this.content.x = Math.floor(width / 2);\r\n        this.content.y = Math.floor(height / 2);\r\n        this.setSize(width * this.scale, height * this.scale);\r\n        this.materialGameScroll.refreshMask();\r\n    };\r\n    PicFurniFunPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n        this.updateData();\r\n    };\r\n    PicFurniFunPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.confirmBtn.on("Tap", this.onConfirmBtnClick, this);\r\n        this.closeBtn.on("pointerup", this.OnClosePanel, this);\r\n    };\r\n    PicFurniFunPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.confirmBtn.off("click", this.onConfirmBtnClick, this);\r\n        this.closeBtn.on("pointerup", this.OnClosePanel, this);\r\n    };\r\n    PicFurniFunPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "furni_unlock/furni_unlock.png", "furni_unlock/furni_unlock.json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasName"].commonUrl + ".json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].common2Key, _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasName"].common2Url + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasName"].common2Url + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicFurniFunPanel.prototype.init = function () {\r\n        var _this = this;\r\n        var width = this.cameraWidth;\r\n        var height = this.cameraHeight;\r\n        this.blackGraphic = this.scene.make.graphics(undefined, false);\r\n        this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        this.add(this.blackGraphic);\r\n        this.content = this.scene.make.container(undefined, false);\r\n        var bgwidth = 295 * this.dpr, bgheight = 369 * this.dpr;\r\n        this.content.setSize(bgwidth, bgheight);\r\n        this.add(this.content);\r\n        this.bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_6__["NineSlicePatch"](this.scene, 0, 0, bgwidth, bgheight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].common2Key, "bg", {\r\n            left: 20 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: 20 * this.dpr,\r\n            bottom: 40 * this.dpr\r\n        });\r\n        this.bgicon = this.scene.make.image({ key: this.key, frame: "bg_f" });\r\n        var posY = -this.bg.height * 0.5;\r\n        this.bgicon.y = posY + this.bgicon.height * 0.5 + 30 * this.dpr;\r\n        this.content.add([this.bg, this.bgicon]);\r\n        this.titleimage = this.scene.make.image({ x: 0, y: posY + 5 * this.dpr, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].common2Key, frame: "title" }, false);\r\n        var mfont = "bold " + 15 * this.dpr + "px Source Han Sans";\r\n        this.titleName = this.scene.make.text({\r\n            x: 0, y: this.titleimage.y + 2 * this.dpr, text: "沙滩躺椅",\r\n            style: { font: mfont, color: "#905B06" }\r\n        }).setOrigin(0.5, 0.5);\r\n        this.closeBtn = this.scene.make.image({ x: this.bg.width * 0.5 - this.dpr * 5, y: posY + this.dpr * 5, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].commonKey, frame: "close" }).setScale(1.3);\r\n        this.closeBtn.setInteractive();\r\n        this.content.add([this.titleimage, this.titleName, this.closeBtn]);\r\n        this.mDetailDisplay = new _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_10__["DetailDisplay"](this.scene);\r\n        this.mDetailDisplay.setTexture(this.key, "bg_f");\r\n        this.mDetailDisplay.setNearest();\r\n        this.mDetailDisplay.y = this.bgicon.y; // this.bgicon.height / 2;\r\n        this.mDetailDisplay.scale = this.dpr * 0.8;\r\n        this.content.add(this.mDetailDisplay);\r\n        var materialConWdith = 360 * this.dpr, materialConHeight = 92 * this.dpr;\r\n        this.materialCon = this.scene.make.container(undefined, false).setSize(materialConWdith, materialConHeight);\r\n        this.content.add(this.materialCon);\r\n        this.materialCon.setPosition(0, 50 * this.dpr);\r\n        var materialTitle = this.scene.make.text({\r\n            x: 0,\r\n            y: -materialConHeight * 0.5 + 12 * this.dpr,\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("furni_unlock.needMaterials"),\r\n            style: {\r\n                color: "#253FCA",\r\n                fontSize: 10 * this.dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var materialLine = this.scene.make.image({ key: this.key, frame: "sourcelist_title" });\r\n        var materialLine2 = this.scene.make.image({ key: this.key, frame: "sourcelist_title" });\r\n        var linePosx = -materialTitle.width * 0.5 - materialLine.width * 0.5 - 10 * this.dpr;\r\n        materialLine.setPosition(linePosx, materialTitle.y);\r\n        materialLine2.setPosition(-linePosx, materialTitle.y).rotation = -Math.PI;\r\n        this.materialCon.add([materialTitle, materialLine, materialLine2]);\r\n        this.materialGameScroll = new _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_7__["GameScroller"](this.scene, {\r\n            x: 0,\r\n            y: 8 * this.dpr,\r\n            width: 240 * this.dpr,\r\n            height: 90 * this.dpr,\r\n            zoom: this.scale,\r\n            align: 2,\r\n            orientation: 1,\r\n            space: 20 * this.dpr,\r\n            valuechangeCallback: undefined,\r\n            celldownCallBack: function (gameobject) {\r\n                _this.materialTipsCon.visible = true;\r\n                _this.onMaterialItemHandler(gameobject);\r\n            },\r\n            cellupCallBack: function (gameobject) {\r\n                _this.materialTipsCon.visible = false;\r\n            }\r\n        });\r\n        this.materialCon.add(this.materialGameScroll);\r\n        this.materialTipsCon = this.scene.make.container(undefined, false).setPosition(0, -60 * this.dpr);\r\n        this.materialTipsCon.visible = false;\r\n        this.materialCon.add(this.materialTipsCon);\r\n        var tipsWidth = 121 * this.dpr;\r\n        var tipsHeight = 46 * this.dpr;\r\n        var tipsbg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_6__["NineSlicePatch"](this.scene, 0, 0, tipsWidth, tipsHeight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].commonKey, "tips_bg", {\r\n            left: 20 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: 20 * this.dpr,\r\n            bottom: 20 * this.dpr\r\n        });\r\n        tipsbg.setPosition(26 * this.dpr, -tipsHeight * 0.5);\r\n        this.tipsbg = tipsbg;\r\n        var tipsText = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_6__["BBCodeText"](this.scene, -28 * this.dpr, -tipsHeight + 60 * this.dpr, "微软我让他委任他为回复", {\r\n            color: "#333333",\r\n            fontSize: 13 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n            wrap: {\r\n                width: 110 * this.dpr,\r\n                mode: "string"\r\n            }\r\n        }).setOrigin(0);\r\n        this.materialTipsDes = tipsText;\r\n        this.materialTipsCon.add([tipsbg, tipsText]);\r\n        this.confirmBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_9__["NineSliceButton"](this.scene, 0, -posY - 30 * this.dpr, 100 * this.dpr, 40 * this.dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_8__["UIAtlasKey"].commonKey, "yellow_btn_over", _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("furni_unlock.unlock"), this.dpr, this.scale, {\r\n            left: 15 * this.dpr,\r\n            top: 15 * this.dpr,\r\n            right: 15 * this.dpr,\r\n            bottom: 15 * this.dpr\r\n        });\r\n        this.confirmBtn.setTextStyle({\r\n            color: "#976400",\r\n            fontSize: 10 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n        });\r\n        this.content.add(this.confirmBtn);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicFurniFunPanel.prototype.destroy = function () {\r\n        if (this.confirmBtn)\r\n            this.confirmBtn.destroy();\r\n        this.confirmBtn = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicFurniFunPanel.prototype.updateData = function () {\r\n        var content = this.mShowData;\r\n        if (!content.ids)\r\n            return;\r\n        var eleMgr = this.mWorld.roomManager.currentRoom.elementManager;\r\n        var ele = eleMgr.get(content.ids[0]);\r\n        if (!ele)\r\n            return;\r\n        var display = ele.model.displayInfo;\r\n        var resData = new pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_client"].OP_VIRTUAL_WORLD_RES_CLIENT_MARKET_QUERY_COMMODITY_RESOURCE();\r\n        resData.display = display.display;\r\n        var animas = display.createProtocolObject();\r\n        if (animas.length > 1) {\r\n            var arr = [];\r\n            for (var _i = 0, animas_1 = animas; _i < animas_1.length; _i++) {\r\n                var ani = animas_1[_i];\r\n                if (ani.node.name !== "lock") {\r\n                    ani.frameName = ani.layer[0].frameName;\r\n                    arr.push(ani);\r\n                }\r\n            }\r\n            if (arr.length === 0)\r\n                arr.push(animas[0]);\r\n            resData.animations = arr;\r\n        }\r\n        else {\r\n            resData.animations = animas;\r\n        }\r\n        this.mDetailDisplay.loadDisplay(resData);\r\n        this.titleName.text = ele.model.nickname;\r\n        this.setMaterialItems(content.materials);\r\n    };\r\n    PicFurniFunPanel.prototype.setMaterialItems = function (datas) {\r\n        var len = datas.length;\r\n        var zoom = this.scale;\r\n        this.materialGameScroll.clearItems();\r\n        for (var i = 0; i < len; i++) {\r\n            var item = new MaterialItem(this.scene, this.key, this.dpr, zoom);\r\n            item.y = 0;\r\n            item.setItemData(datas[i]);\r\n            item.setData("itemData", datas[i]);\r\n            this.materialGameScroll.addItem(item);\r\n        }\r\n        this.materialGameScroll.Sort();\r\n    };\r\n    PicFurniFunPanel.prototype.onConfirmBtnClick = function () {\r\n        var data = this.showData;\r\n        if (!data || !data.ids)\r\n            return;\r\n        this.emit("queryunlock", data.ids);\r\n        this.emit("close");\r\n    };\r\n    PicFurniFunPanel.prototype.OnClosePanel = function () {\r\n        this.emit("close");\r\n    };\r\n    PicFurniFunPanel.prototype.onMaterialItemHandler = function (item) {\r\n        var pos = item.getWorldTransformMatrix();\r\n        this.materialTipsCon.x = pos.tx - this.scaleWidth * 0.5;\r\n        this.materialTipsDes.text = this.getDesText(item.itemData);\r\n        var tipsHeight = this.materialTipsDes.height + 20 * this.dpr;\r\n        var tipsWidth = this.tipsbg.width;\r\n        this.tipsbg.resize(tipsWidth, tipsHeight);\r\n        this.tipsbg.y = -this.tipsbg.height * 0.5;\r\n        this.materialTipsDes.y = -tipsHeight + 10 * this.dpr;\r\n    };\r\n    PicFurniFunPanel.prototype.getDesText = function (data) {\r\n        if (!data)\r\n            data = { "sellingPrice": true, tradable: false };\r\n        var text = "";\r\n        var source = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("furni_unlock.source");\r\n        source += data.source;\r\n        source = "[stroke=#333333][color=#333333]" + source + "[/color][/stroke]";\r\n        text += source + "\\n";\r\n        if (data.sellingPrice) {\r\n            var price = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("furni_unlock.sold");\r\n            price += data.sellingPrice.price + _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Coin"].getName(data.sellingPrice.coinType);\r\n            price = "[stroke=#333333][color=#333333]" + price + "[/color][/stroke]";\r\n            text += price + "\\n";\r\n        }\r\n        if (!data.tradable) {\r\n            var trade = _i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].t("furni_unlock.notrading");\r\n            trade = "[stroke=#333333][color=#ff0000]*" + trade + "[/color][/stroke]";\r\n            text += trade;\r\n        }\r\n        return text;\r\n    };\r\n    return PicFurniFunPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_3__["BasePanel"]));\r\n\r\nvar MaterialItem = /** @class */ (function (_super) {\r\n    __extends(MaterialItem, _super);\r\n    function MaterialItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.zoom = zoom;\r\n        var bg = _this.scene.make.image({ key: _this.key, frame: "bg_m" });\r\n        _this.itemIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](scene, 0, 0);\r\n        _this.itemCount = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_6__["BBCodeText"](_this.scene, 0, 15 * dpr, "10/20", { color: "#000000" })\r\n            .setOrigin(0.5).setFontSize(11 * dpr).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT);\r\n        _this.add([bg, _this.itemIcon, _this.itemCount]);\r\n        _this.setSize(bg.width, bg.height);\r\n        _this.itemCount.y = _this.height * 0.5 + 10 * dpr;\r\n        return _this;\r\n    }\r\n    MaterialItem.prototype.setItemData = function (data) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        this.itemCount.text = this.getCountText(data.count, data.neededCount);\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getOsdRes(data.display.texturePath);\r\n        this.itemIcon.load(url, this, function () {\r\n            _this.itemIcon.scale = _this.dpr * _this.zoom;\r\n            _this.itemIcon.setPosition(0, 0);\r\n        });\r\n    };\r\n    MaterialItem.prototype.getCountText = function (count, needcount) {\r\n        var color = (count >= needcount ? "#000000" : "#ff0000");\r\n        var text = "[stroke=" + color + "][color=" + color + "]" + count + "[/color][/stroke]/" + needcount;\r\n        return text;\r\n    };\r\n    return MaterialItem;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicFurniFun/PicFurniFunPanel.ts?')},"./src/ui/PicHandheld/PicHandheld.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHandheld", function() { return PicHandheld; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicHandheld = /** @class */ (function (_super) {\r\n    __extends(PicHandheld, _super);\r\n    function PicHandheld($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicHandheld.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_HANDHELD, this.onRetHandheldList);\r\n        }\r\n    };\r\n    PicHandheld.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicHandheld.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicHandheld.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicHandheld.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(PicHandheld.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PicHandheld.prototype.queryChangeHandheld = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_PICK_HANDHELD);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    PicHandheld.prototype.queryClearHandheld = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_DROP_HANDHELD);\r\n        this.connection.send(packet);\r\n    };\r\n    PicHandheld.prototype.queryHandheldList = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_HANDHELD);\r\n        this.connection.send(packet);\r\n    };\r\n    PicHandheld.prototype.onRetHandheldList = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("handheldlist", content);\r\n    };\r\n    return PicHandheld;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHandheld/PicHandheld.ts?')},"./src/ui/PicHandheld/PicHandheldMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHandheldMediator", function() { return PicHandheldMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicHandheld__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicHandheld */ "./src/ui/PicHandheld/PicHandheld.ts");\n/* harmony import */ var _PicHandheldPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PicHandheldPanel */ "./src/ui/PicHandheld/PicHandheldPanel.ts");\n/* harmony import */ var _PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../PicaChat/PicaChatMediator */ "./src/ui/PicaChat/PicaChatMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar PicHandheldMediator = /** @class */ (function (_super) {\r\n    __extends(PicHandheldMediator, _super);\r\n    function PicHandheldMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicHandheldMediator.prototype.show = function () {\r\n        if (!this.picHand) {\r\n            this.picHand = new _PicHandheld__WEBPACK_IMPORTED_MODULE_1__["PicHandheld"](this.world);\r\n            this.picHand.on("handheldlist", this.onHandheldList, this);\r\n            this.picHand.register();\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicHandheldPanel__WEBPACK_IMPORTED_MODULE_2__["PicHandheldPanel"](this.scene, this.world);\r\n            this.mView.on("changehandheld", this.onChangeHandheld, this);\r\n            this.mView.on("clearhandheld", this.onClearHandheld, this);\r\n            this.mView.on("handheldlist", this.onReqHandheldList, this);\r\n            this.mView.on("openeqiped", this.openEquipedPanel, this);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicHandheldMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.layerManager.removeToUILayer(this.mView);\r\n    };\r\n    PicHandheldMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicHandheldMediator.prototype.destroy = function () {\r\n        if (this.picHand) {\r\n            this.picHand.destroy();\r\n            this.picHand = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicHandheldMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    PicHandheldMediator.prototype.onHandheldList = function (content) {\r\n        this.mView.setEqipedDatas(content);\r\n    };\r\n    PicHandheldMediator.prototype.onChangeHandheld = function (id) {\r\n        this.picHand.queryChangeHandheld(id);\r\n    };\r\n    PicHandheldMediator.prototype.onReqHandheldList = function () {\r\n        this.picHand.queryHandheldList();\r\n    };\r\n    PicHandheldMediator.prototype.onClearHandheld = function () {\r\n        this.picHand.queryClearHandheld();\r\n    };\r\n    PicHandheldMediator.prototype.openEquipedPanel = function (state) {\r\n        var uiManager = this.world.uiManager;\r\n        var mediator = uiManager.getMediator(_PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_3__["PicaChatMediator"].name);\r\n        if (mediator) {\r\n            if (state)\r\n                mediator.hide();\r\n            else {\r\n                mediator.show();\r\n                this.layerManager.removeToUILayer(this.mView);\r\n                this.layerManager.addToUILayer(this.mView);\r\n            }\r\n        }\r\n    };\r\n    return PicHandheldMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHandheld/PicHandheldMediator.ts?')},"./src/ui/PicHandheld/PicHandheldPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHandheldPanel", function() { return PicHandheldPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/gridtable/GameGridTable */ "./lib/rexui/lib/ui/gridtable/GameGridTable.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PicHandheldPanel = /** @class */ (function (_super) {\r\n    __extends(PicHandheldPanel, _super);\r\n    function PicHandheldPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pichandheldpanel";\r\n        _this.isExtendsGrid = false;\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    PicHandheldPanel.prototype.resize = function (w, h) {\r\n        var scale = this.scale;\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        this.setSize(width, height);\r\n        this.isExtendsGrid = false;\r\n    };\r\n    PicHandheldPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.addListen();\r\n        this.updateData();\r\n        this.emit("handheldlist");\r\n    };\r\n    PicHandheldPanel.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.removeListen();\r\n    };\r\n    PicHandheldPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    PicHandheldPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n    };\r\n    PicHandheldPanel.prototype.destroy = function () {\r\n        if (this.mPropGrid) {\r\n            this.mPropGrid.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicHandheldPanel.prototype.setEqipedDatas = function (content) {\r\n        var datas = content.handheld;\r\n        datas = datas.sort(function (a, b) {\r\n            if (a.latestUse >= b.latestUse)\r\n                return 1;\r\n            else\r\n                return -1;\r\n        });\r\n        var useArr = datas.splice(0, 3);\r\n        datas = datas.sort(function (a, b) {\r\n            if (a.recommended >= b.recommended)\r\n                return 1;\r\n            else\r\n                return -1;\r\n        });\r\n        datas = useArr.concat(datas);\r\n        var emptyData = pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].CountablePackageItem.create({ id: "empty_handed", count: 0 });\r\n        var curr;\r\n        if (content.currentHandheldId === "" || !content.currentHandheldId) {\r\n            curr = emptyData;\r\n        }\r\n        else {\r\n            for (var _i = 0, datas_1 = datas; _i < datas_1.length; _i++) {\r\n                var data = datas_1[_i];\r\n                if (data.id === content.currentHandheldId) {\r\n                    curr = data;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        datas.unshift(emptyData);\r\n        this.handeldEqiped.setItemData(curr);\r\n        if (this.isExtendsGrid) {\r\n            var len = 14;\r\n            var templen = len - datas.length;\r\n            var alldata = templen > 0 ? datas.concat(new Array(templen)) : datas;\r\n            this.mPropGrid.setItems(alldata);\r\n            if (curr) {\r\n                var cells = this.mPropGrid.getCells();\r\n                for (var _a = 0, cells_1 = cells; _a < cells_1.length; _a++) {\r\n                    var cell = cells_1[_a];\r\n                    if (cell) {\r\n                        var container = cell.container;\r\n                        if (container && container.itemData === curr) {\r\n                            container.isSelect = true;\r\n                            this.curHandheldItem = cell;\r\n                        }\r\n                        else\r\n                            container.isSelect = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    PicHandheldPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "hand_equp/hand_equp.png", "hand_equp/hand_equp.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicHandheldPanel.prototype.init = function () {\r\n        var _this = this;\r\n        if (this.mInitialized)\r\n            return;\r\n        var w = this.scaleWidth;\r\n        var h = this.scaleHeight;\r\n        this.gridContent = this.scene.make.container(undefined, false);\r\n        this.add(this.gridContent);\r\n        this.gridContent.setSize(w, 150 * this.dpr);\r\n        this.gridContent.x = w * 0.5;\r\n        this.gridContent.y = h - this.gridContent.height * 0.5 - 200 * this.dpr;\r\n        var mBackground = this.scene.make.graphics(undefined, false);\r\n        mBackground.fillStyle(0x333333, 0.5);\r\n        mBackground.fillRect(-w * 0.5, -this.gridContent.height * 0.5, w, 150 * this.dpr);\r\n        this.gridContent.add(mBackground);\r\n        this.handeldEqiped = new HandheldEqiped(this.scene, 0, 0, this.key, this.dpr);\r\n        this.handeldEqiped.setClickHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_4__["Handler"](this, this.onHandheldEqipedHandler), new _Handler_Handler__WEBPACK_IMPORTED_MODULE_4__["Handler"](this, this.onShortcutHandler));\r\n        this.add(this.handeldEqiped);\r\n        var propFrame = this.scene.textures.getFrame(this.key, "equp_bg");\r\n        var cellWidth = propFrame.width + 10 * this.dpr;\r\n        var cellHeight = propFrame.height + 10 * this.dpr;\r\n        var propGridConfig = {\r\n            x: 0,\r\n            y: 0,\r\n            table: {\r\n                width: w - 20 * this.dpr,\r\n                height: 120 * this.dpr,\r\n                columns: 2,\r\n                cellWidth: cellWidth,\r\n                cellHeight: cellHeight,\r\n                reuseCellContainer: true,\r\n                cellOriginX: 0.5,\r\n                cellOriginY: 0.5,\r\n                zoom: this.scale\r\n            },\r\n            scrollMode: 1,\r\n            clamplChildOY: false,\r\n            createCellContainerCallback: function (cell, cellContainer) {\r\n                var scene = cell.scene, item = cell.item;\r\n                if (cellContainer === null) {\r\n                    cellContainer = new HandheldItem(scene, 0, 0, _this.key, _this.dpr);\r\n                    _this.gridContent.add(cellContainer);\r\n                }\r\n                cellContainer.setItemData(item);\r\n                return cellContainer;\r\n            },\r\n        };\r\n        this.mPropGrid = new _lib_rexui_lib_ui_gridtable_GameGridTable__WEBPACK_IMPORTED_MODULE_2__["GameGridTable"](this.scene, propGridConfig);\r\n        this.mPropGrid.layout();\r\n        this.mPropGrid.on("cellTap", function (cell) {\r\n            _this.onSelectItemHandler(cell);\r\n        });\r\n        this.gridContent.add(this.mPropGrid.table);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicHandheldPanel.prototype.updateData = function () {\r\n        this.updateLayout();\r\n    };\r\n    PicHandheldPanel.prototype.updateLayout = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var x = width - this.handeldEqiped.width * 0.5 - 8 * this.dpr;\r\n        var y = 0;\r\n        this.gridContent.y = height - this.gridContent.height * 0.5;\r\n        if (!this.isExtendsGrid) {\r\n            y = height - this.handeldEqiped.height * 0.5 - 10 * this.dpr;\r\n            this.gridContent.visible = false;\r\n            this.handeldEqiped.waiting();\r\n            if (!this.handeldEqiped.isEmptyHanded)\r\n                this.handeldEqiped.showShortcut();\r\n        }\r\n        else {\r\n            y = height - this.handeldEqiped.height * 0.5 - this.gridContent.height;\r\n            this.gridContent.visible = true;\r\n            this.mPropGrid.resetMask();\r\n            this.handeldEqiped.normal();\r\n            this.handeldEqiped.hideShortcut();\r\n        }\r\n        this.handeldEqiped.setPosition(x, y);\r\n    };\r\n    PicHandheldPanel.prototype.onSelectItemHandler = function (item) {\r\n        var data = item.itemData;\r\n        if (!data)\r\n            return;\r\n        if (this.curHandheldItem)\r\n            this.curHandheldItem.isSelect = false;\r\n        item.isSelect = true;\r\n        this.curHandheldItem = item;\r\n        if (item.isEmptyHanded) {\r\n            this.emit("clearhandheld");\r\n        }\r\n        else {\r\n            this.emit("changehandheld", data.id);\r\n        }\r\n    };\r\n    PicHandheldPanel.prototype.onHandheldEqipedHandler = function (data) {\r\n        this.isExtendsGrid = !this.isExtendsGrid;\r\n        if (!this.isExtendsGrid) {\r\n            this.mPropGrid.setItems([]);\r\n            this.gridContent.visible = false;\r\n            this.emit("openeqiped", false);\r\n        }\r\n        else {\r\n            this.gridContent.visible = true;\r\n            this.emit("handheldlist");\r\n            this.emit("openeqiped", true);\r\n        }\r\n        this.updateLayout();\r\n    };\r\n    PicHandheldPanel.prototype.onShortcutHandler = function (data) {\r\n        this.emit("clearhandheld");\r\n    };\r\n    return PicHandheldPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar HandheldItem = /** @class */ (function (_super) {\r\n    __extends(HandheldItem, _super);\r\n    function HandheldItem(scene, x, y, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.mIsSelect = false;\r\n        _this.dpr = dpr;\r\n        _this.key = key;\r\n        _this.bg = _this.scene.make.image({ key: key, frame: "equp_bg" });\r\n        _this.selectbg = _this.scene.make.image({ key: key, frame: "click_bg" });\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_3__["DynamicImage"](scene, 0, 0);\r\n        _this.add([_this.bg, _this.selectbg, _this.icon]);\r\n        _this.setSize(_this.selectbg.width, _this.selectbg.height);\r\n        _this.isSelect = false;\r\n        return _this;\r\n    }\r\n    HandheldItem.prototype.setItemData = function (data) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        if (!data) {\r\n            this.icon.visible = false;\r\n            this.selectbg.visible = false;\r\n            return;\r\n        }\r\n        this.icon.visible = true;\r\n        this.selectbg.visible = this.mIsSelect;\r\n        if (this.isEmptyHanded) {\r\n            this.icon.setTexture(this.key, "empty_handed");\r\n        }\r\n        else {\r\n            var display = data.display;\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Url"].getOsdRes(display.texturePath);\r\n            this.icon.load(url, this, function () {\r\n                _this.icon.displayWidth = 34 * _this.dpr;\r\n                _this.icon.scaleY = _this.icon.scaleX;\r\n            });\r\n        }\r\n    };\r\n    Object.defineProperty(HandheldItem.prototype, "isSelect", {\r\n        get: function () {\r\n            return this.mIsSelect;\r\n        },\r\n        set: function (value) {\r\n            this.mIsSelect = value;\r\n            this.selectbg.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HandheldItem.prototype, "isEmptyHanded", {\r\n        get: function () {\r\n            if (this.itemData && this.itemData.id === "empty_handed")\r\n                return true;\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return HandheldItem;\r\n}(Phaser.GameObjects.Container));\r\nvar HandheldEqiped = /** @class */ (function (_super) {\r\n    __extends(HandheldEqiped, _super);\r\n    function HandheldEqiped(scene, x, y, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.isExtendsGrid = false;\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        _this.bg = _this.scene.make.image({ key: key, frame: "button_h" });\r\n        _this.shortcutCon = _this.scene.make.container(undefined, false);\r\n        _this.shortcutbg = _this.scene.make.image({ key: key, frame: "superscript_h" });\r\n        _this.shortcutIcon = _this.scene.make.image({ key: key, frame: "hand" });\r\n        _this.shortcutCon.add([_this.shortcutbg, _this.shortcutIcon]);\r\n        var shortcutWidth = 40 * dpr;\r\n        _this.shortcutCon.setSize(shortcutWidth, shortcutWidth);\r\n        _this.shortcutbg.x = -_this.shortcutCon.width * 0.5 + _this.shortcutbg.width * 0.5 - 5 * dpr;\r\n        _this.shortcutbg.y = _this.shortcutCon.height * 0.5 - _this.shortcutbg.height * 0.5 + 5 * dpr;\r\n        _this.shortcutIcon.x = _this.shortcutbg.x;\r\n        _this.shortcutIcon.y = _this.shortcutbg.y;\r\n        _this.icon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_3__["DynamicImage"](scene, 0, 0);\r\n        _this.icon.setTexture(_this.key, "empty_handed");\r\n        _this.shortcutCon.on("pointerup", _this.onShortcutHandler, _this);\r\n        _this.add([_this.bg, _this.icon, _this.shortcutCon]);\r\n        _this.setSize(_this.bg.width, _this.bg.height);\r\n        _this.setInteractive();\r\n        _this.shortcutCon.setPosition(_this.width * 0.5 + shortcutWidth * 0.5 - 20 * dpr, -_this.height * 0.5 - shortcutWidth * 0.5 + 15 * dpr);\r\n        _this.shortcutCon.setInteractive();\r\n        _this.on("pointerup", _this.onClickHandler, _this);\r\n        _this.hideShortcut();\r\n        return _this;\r\n    }\r\n    HandheldEqiped.prototype.normal = function () {\r\n        this.bg.setFrame("button_h");\r\n        this.setChildAlpha(1);\r\n    };\r\n    HandheldEqiped.prototype.waiting = function () {\r\n        this.bg.setFrame("button_h");\r\n        this.setChildAlpha(0.5);\r\n    };\r\n    HandheldEqiped.prototype.setItemData = function (data) {\r\n        var _this = this;\r\n        this.itemData = data;\r\n        if (!this.isEmptyHanded) {\r\n            var display = data.display;\r\n            var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_5__["Url"].getOsdRes(display.texturePath);\r\n            this.icon.load(url, this, function () {\r\n                _this.icon.displayWidth = 24 * _this.dpr;\r\n                _this.icon.scaleY = _this.icon.scaleX;\r\n            });\r\n            if (!this.isExtendsGrid)\r\n                this.showShortcut();\r\n        }\r\n        else {\r\n            this.icon.setScale(1);\r\n            this.icon.setTexture(this.key, "empty_handed");\r\n            this.hideShortcut();\r\n        }\r\n    };\r\n    HandheldEqiped.prototype.setClickHandler = function (cliclhandler, shortcutHandler) {\r\n        this.clickHandler = cliclhandler;\r\n        this.shortcutHandler = shortcutHandler;\r\n    };\r\n    HandheldEqiped.prototype.setChildAlpha = function (alpha) {\r\n        this.bg.setAlpha(alpha);\r\n        this.icon.setAlpha(alpha);\r\n        this.shortcutbg.setAlpha(alpha);\r\n        this.shortcutIcon.setAlpha(alpha);\r\n    };\r\n    HandheldEqiped.prototype.hideShortcut = function () {\r\n        this.shortcutCon.visible = false;\r\n        this.shortcutCon.disableInteractive();\r\n    };\r\n    HandheldEqiped.prototype.showShortcut = function () {\r\n        this.shortcutCon.visible = true;\r\n        this.shortcutCon.setInteractive();\r\n    };\r\n    Object.defineProperty(HandheldEqiped.prototype, "isCanShowShortcut", {\r\n        get: function () {\r\n            if (!this.isEmptyHanded) {\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(HandheldEqiped.prototype, "isEmptyHanded", {\r\n        get: function () {\r\n            if (!this.itemData || this.itemData.id === "empty_handed")\r\n                return true;\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    HandheldEqiped.prototype.onShortcutHandler = function () {\r\n        if (this.shortcutHandler)\r\n            this.shortcutHandler.runWith(this.itemData);\r\n    };\r\n    HandheldEqiped.prototype.onClickHandler = function () {\r\n        this.isExtendsGrid = !this.isExtendsGrid;\r\n        if (this.clickHandler)\r\n            this.clickHandler.runWith(this.itemData);\r\n    };\r\n    return HandheldEqiped;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHandheld/PicHandheldPanel.ts?')},"./src/ui/PicHouse/PicHouse.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHouse", function() { return PicHouse; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicHouse = /** @class */ (function (_super) {\r\n    __extends(PicHouse, _super);\r\n    function PicHouse($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicHouse.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_INFO, this.onRetRoomInfoHandler);\r\n        }\r\n    };\r\n    PicHouse.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicHouse.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicHouse.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicHouse.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    PicHouse.prototype.sendEnterDecorate = function () {\r\n        if (this.connection) {\r\n            this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER));\r\n        }\r\n    };\r\n    PicHouse.prototype.queryRoomInfo = function (roomid) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_ROOM_INFO);\r\n        var content = packet.content;\r\n        content.roomId = roomid;\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(PicHouse.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PicHouse.prototype.onRetRoomInfoHandler = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("roominfo", content);\r\n    };\r\n    return PicHouse;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHouse/PicHouse.ts?')},"./src/ui/PicHouse/PicHouseInfoPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHouseInfoPanel", function() { return PicHouseInfoPanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicHouseInfoPanel = /** @class */ (function (_super) {\r\n    __extends(PicHouseInfoPanel, _super);\r\n    function PicHouseInfoPanel(scene, x, y, width, height, key, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        _this.setSize(width, height);\r\n        _this.createAttribute();\r\n        return _this;\r\n    }\r\n    PicHouseInfoPanel.prototype.setAttributeData = function (data) {\r\n        this.roomname.setTextInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.roomname"), data.name);\r\n        var level = 0;\r\n        var curExp = 0;\r\n        var nexExp = 0;\r\n        if (data.roomLevel) {\r\n            level = data.roomLevel.level;\r\n            curExp = data.roomLevel.currentLevelExp ? data.roomLevel.currentLevelExp : 0;\r\n            nexExp = data.roomLevel.nextLevelExp ? data.roomLevel.nextLevelExp : 0;\r\n        }\r\n        this.roomlevel.setImageInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.roomlevel"), this.key, this.getLevelImgs(level));\r\n        var expvalue = "[color=#0D8288]" + curExp + "[/color]/" + nexExp;\r\n        if (nexExp === 0)\r\n            expvalue = "MAX";\r\n        this.expvalue.setTextInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.expvalue"), expvalue);\r\n        this.popvalue.setImageInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.popvalue"), this.key, this.getpopImgs());\r\n        this.goodvalue.setImageInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.goodvalue"), this.key, this.getgoodImgs());\r\n        this.compviness.setTextInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.compveness"), "16525");\r\n        this.prosprity.setTextInfo(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.prosperity"), "68");\r\n    };\r\n    PicHouseInfoPanel.prototype.createAttribute = function () {\r\n        var posy = -this.height * 0.5;\r\n        var itemHeight = 20 * this.dpr;\r\n        var itemWidth = this.width;\r\n        var space = 20 * this.dpr + itemHeight;\r\n        this.roomname = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.roomlevel = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.expvalue = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.popvalue = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.goodvalue = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.compviness = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        posy += space;\r\n        this.prosprity = new HouseAttributeValue(this.scene, 0, posy, itemWidth, itemHeight, this.dpr);\r\n        this.add([this.roomname, this.roomlevel, this.expvalue, this.popvalue, this.goodvalue, this.compviness, this.prosprity]);\r\n    };\r\n    PicHouseInfoPanel.prototype.getLevelImgs = function (level) {\r\n        var power = 4;\r\n        level = level ? level : 0;\r\n        var imgs = [];\r\n        var sunNum = Math.floor(level / Math.pow(power, 2));\r\n        var value1 = level % Math.pow(power, 2);\r\n        var moon = Math.floor((value1) / Math.pow(power, 1));\r\n        var value2 = value1 % Math.pow(power, 1);\r\n        var star = value2;\r\n        for (var i = 0; i < sunNum; i++) {\r\n            imgs.push("sun");\r\n        }\r\n        for (var i = 0; i < moon; i++) {\r\n            imgs.push("moon");\r\n        }\r\n        for (var i = 0; i < star; i++) {\r\n            imgs.push("star");\r\n        }\r\n        if (level === 0)\r\n            imgs.push("star");\r\n        return imgs;\r\n    };\r\n    PicHouseInfoPanel.prototype.getpopImgs = function () {\r\n        return ["popularity", "popularity", "popularity", "popularity", "popularity"];\r\n    };\r\n    PicHouseInfoPanel.prototype.getgoodImgs = function () {\r\n        return ["good", "good", "good", "good1", "good1"];\r\n    };\r\n    return PicHouseInfoPanel;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar HouseAttributeValue = /** @class */ (function (_super) {\r\n    __extends(HouseAttributeValue, _super);\r\n    function HouseAttributeValue(scene, x, y, width, height, dpr) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.dpr = dpr;\r\n        _this.setSize(width, height);\r\n        _this.nameText = _this.scene.make.text({\r\n            x: -width * 0.5 + 15 * dpr, y: 0, text: "Room name",\r\n            style: { fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].BOLD_FONT, fontSize: 14 * dpr, color: "#FFC51A" }\r\n        }).setOrigin(0, 0.5).setStroke("#0", 4);\r\n        _this.valueText = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_2__["BBCodeText"](_this.scene, 0, 0, "This my Room", {\r\n            color: "#000000",\r\n            fontSize: 13 * _this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT,\r\n        }).setOrigin(0, 0.5);\r\n        _this.imgCon = _this.scene.make.container(undefined, false);\r\n        _this.imgCon.x = 10 * dpr;\r\n        _this.add([_this.nameText, _this.valueText, _this.imgCon]);\r\n        return _this;\r\n    }\r\n    HouseAttributeValue.prototype.setTextInfo = function (name, value) {\r\n        this.nameText.text = name;\r\n        this.valueText.text = value;\r\n    };\r\n    HouseAttributeValue.prototype.setImageInfo = function (name, key, imgs) {\r\n        this.nameText.text = name;\r\n        var posX = 0;\r\n        var space = 10 * this.dpr;\r\n        for (var _i = 0, imgs_1 = imgs; _i < imgs_1.length; _i++) {\r\n            var frame = imgs_1[_i];\r\n            var image = this.scene.make.image({ key: key, frame: frame });\r\n            image.x = posX;\r\n            posX += image.width * 0.5 + space;\r\n            this.imgCon.add(image);\r\n        }\r\n        this.valueText.visible = false;\r\n    };\r\n    return HouseAttributeValue;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHouse/PicHouseInfoPanel.ts?')},"./src/ui/PicHouse/PicHouseMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHouseMediator", function() { return PicHouseMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicHousePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicHousePanel */ "./src/ui/PicHouse/PicHousePanel.ts");\n/* harmony import */ var _PicHouse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PicHouse */ "./src/ui/PicHouse/PicHouse.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicHouseMediator = /** @class */ (function (_super) {\r\n    __extends(PicHouseMediator, _super);\r\n    function PicHouseMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicHouseMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.picHouse) {\r\n            this.picHouse = new _PicHouse__WEBPACK_IMPORTED_MODULE_2__["PicHouse"](this.world);\r\n            this.picHouse.on("roominfo", this.onRoomInfoHandler, this);\r\n            this.picHouse.register();\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicHousePanel__WEBPACK_IMPORTED_MODULE_1__["PicHousePanel"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHideHandler, this);\r\n            this.mView.on("scenedecorate", this.onSendEnterDecorate, this);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n        this.queryRoomInfoHandler();\r\n    };\r\n    PicHouseMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.layerManager.removeToUILayer(this.mView);\r\n    };\r\n    PicHouseMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicHouseMediator.prototype.destroy = function () {\r\n        if (this.picHouse) {\r\n            this.picHouse.destroy();\r\n            this.picHouse = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicHouseMediator.prototype.onRoomInfoHandler = function (content) {\r\n        var uimananger = this.world.uiManager;\r\n        var mediator = uimananger.getMediator("PicaMainUIMediator");\r\n        this.mView.setRoomInfoData(content, mediator.isSelfRoom);\r\n    };\r\n    PicHouseMediator.prototype.queryRoomInfoHandler = function () {\r\n        var uimananger = this.world.uiManager;\r\n        var mediator = uimananger.getMediator("PicaMainUIMediator");\r\n        var roominfo = mediator.roomInfo;\r\n        if (roominfo) {\r\n            this.picHouse.queryRoomInfo(roominfo.roomId);\r\n        }\r\n    };\r\n    PicHouseMediator.prototype.onHideHandler = function () {\r\n        this.destroy();\r\n    };\r\n    PicHouseMediator.prototype.onSendEnterDecorate = function () {\r\n        this.picHouse.sendEnterDecorate();\r\n    };\r\n    return PicHouseMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHouse/PicHouseMediator.ts?')},"./src/ui/PicHouse/PicHousePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicHousePanel", function() { return PicHousePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/tab/TabButton */ "./lib/rexui/lib/ui/tab/TabButton.ts");\n/* harmony import */ var _components_checkbox_group__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/checkbox.group */ "./src/ui/components/checkbox.group.ts");\n/* harmony import */ var _PicHouseInfoPanel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./PicHouseInfoPanel */ "./src/ui/PicHouse/PicHouseInfoPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PicHousePanel = /** @class */ (function (_super) {\r\n    __extends(PicHousePanel, _super);\r\n    function PicHousePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pichousepanel";\r\n        return _this;\r\n        //  this.scale = 1;\r\n    }\r\n    PicHousePanel.prototype.resize = function (w, h) {\r\n        var scale = this.scale;\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        this.content.x = width * 0.5;\r\n        this.content.y = height * 0.5;\r\n        this.setSize(width, height);\r\n    };\r\n    PicHousePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.addListen();\r\n        this.updateData();\r\n    };\r\n    PicHousePanel.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.removeListen();\r\n    };\r\n    PicHousePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.on("pointerup", this.onCloseHandler, this);\r\n        this.editorRoomBtn.on("pointerup", this.onEnterEditorHandler, this);\r\n    };\r\n    PicHousePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.off("pointerup", this.onCloseHandler, this);\r\n        this.editorRoomBtn.off("pointerup", this.onEnterEditorHandler, this);\r\n    };\r\n    PicHousePanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicHousePanel.prototype.setRoomInfoData = function (content, isSelf) {\r\n        if (isSelf === void 0) { isSelf = true; }\r\n        this.mRoomInfoData = content;\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.houseInfoPanel.setAttributeData(content);\r\n        this.roomSettingBtn.visible = isSelf;\r\n        this.editorRoomBtn.visible = isSelf;\r\n    };\r\n    PicHousePanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "room_information/room_information.png", "room_information/room_information.json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasName"].commonUrl + ".json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasKey"].common2Key, _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasName"].common2Url + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasName"].common2Url + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicHousePanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var w = this.scaleWidth;\r\n        var h = this.scaleHeight;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, w, h), Phaser.Geom.Rectangle.Contains);\r\n        this.mBackground.fillStyle(0, 0.66);\r\n        this.mBackground.fillRect(0, 0, w, h);\r\n        this.add(this.mBackground);\r\n        this.content = this.scene.make.container(undefined, false);\r\n        var bgwidth = 295 * this.dpr, bgheight = 370 * this.dpr;\r\n        this.content.setSize(bgwidth, bgheight);\r\n        this.bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_3__["NineSlicePatch"](this.scene, 0, 0, bgwidth, bgheight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasKey"].common2Key, "bg", {\r\n            left: 20 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: 20 * this.dpr,\r\n            bottom: 80 * this.dpr\r\n        });\r\n        this.content.add(this.bg);\r\n        this.closeBtn = this.scene.make.image({ x: this.bg.width * 0.5 - this.dpr * 5, y: -this.bg.height * 0.5 + this.dpr * 5, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasKey"].commonKey, frame: "close" }).setScale(1.3);\r\n        this.closeBtn.setInteractive();\r\n        this.content.add([this.closeBtn]);\r\n        this.roomInfoBtn = this.createTabButton(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.infobtn"), "small_information");\r\n        this.roomSettingBtn = this.createTabButton(_i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.setting"), "small_setting");\r\n        this.roomInfoBtn.setPosition(-this.roomInfoBtn.width * 0.5 - 2 * this.dpr, -this.content.height * 0.5 - this.roomInfoBtn.height * 0.5 + 2 * this.dpr);\r\n        this.roomSettingBtn.setPosition(this.roomSettingBtn.width * 0.5 + 2 * this.dpr, this.roomInfoBtn.y);\r\n        this.topCheckBox = new _components_checkbox_group__WEBPACK_IMPORTED_MODULE_7__["CheckboxGroup"]();\r\n        this.topCheckBox.appendItemAll([this.roomInfoBtn, this.roomSettingBtn]);\r\n        this.topCheckBox.on("selected", this.onTabBtnHandler, this);\r\n        this.content.add([this.roomInfoBtn, this.roomSettingBtn]);\r\n        this.houseInfoPanel = new _PicHouseInfoPanel__WEBPACK_IMPORTED_MODULE_8__["PicHouseInfoPanel"](this.scene, 0, 0, this.content.width - 40 * this.dpr, this.content.height - 70 * this.dpr, this.key, this.dpr);\r\n        this.content.add(this.houseInfoPanel);\r\n        var btnY = this.content.height * 0.5;\r\n        this.editorRoomBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_5__["NineSliceButton"](this.scene, 0, btnY - 30 * this.dpr, 100 * this.dpr, 35 * this.dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_4__["UIAtlasKey"].commonKey, "button_g", _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_info.editorroom"), this.dpr, this.scale, {\r\n            left: 16 * this.dpr,\r\n            top: 16 * this.dpr,\r\n            right: 16 * this.dpr,\r\n            bottom: 16 * this.dpr\r\n        });\r\n        this.editorRoomBtn.setTextStyle({\r\n            color: "#022B55",\r\n            fontSize: 12 * this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].BOLD_FONT\r\n        });\r\n        this.editorRoomBtn.setTextOffset(10 * this.dpr, 0);\r\n        var editorx = -this.editorRoomBtn.width * 0.5 + 8 * this.dpr;\r\n        var eidtorimg = this.scene.make.image({ x: editorx, y: -3 * this.dpr, key: this.key, frame: "renovation" });\r\n        this.editorRoomBtn.add(eidtorimg);\r\n        this.content.add(this.editorRoomBtn);\r\n        this.topCheckBox.selectIndex(0);\r\n        this.add(this.content);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicHousePanel.prototype.updateData = function () {\r\n        if (this.mRoomInfoData) {\r\n            this.setRoomInfoData(this.mRoomInfoData);\r\n        }\r\n    };\r\n    PicHousePanel.prototype.onTabBtnHandler = function (btn) {\r\n        if (this.roomInfoBtn === btn) {\r\n            this.houseInfoPanel.visible = true;\r\n        }\r\n        else {\r\n            this.houseInfoPanel.visible = false;\r\n        }\r\n        if (this.roomSettingBtn === btn) {\r\n            this.houseInfoPanel.visible = false;\r\n        }\r\n        else {\r\n        }\r\n    };\r\n    PicHousePanel.prototype.createTabButton = function (text, icon) {\r\n        var btn = new _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_6__["TabButton"](this.scene, this.key, "default tab", "check tab", text);\r\n        btn.setTextStyle({ fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].BOLD_FONT, fontSize: 9 * this.dpr, color: "#ffffff" });\r\n        btn.setTextOffset(13 * this.dpr, 0);\r\n        var img = this.scene.make.image({ key: this.key, frame: icon });\r\n        btn.add(img);\r\n        img.x = -btn.width * 0.5 + img.width * 0.5 + 7 * this.dpr;\r\n        return btn;\r\n    };\r\n    PicHousePanel.prototype.onCloseHandler = function () {\r\n        this.emit("hide");\r\n    };\r\n    PicHousePanel.prototype.onEnterEditorHandler = function () {\r\n        this.emit("scenedecorate");\r\n    };\r\n    return PicHousePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHouse/PicHousePanel.ts?')},"./src/ui/PicHouse/PicHouseSettingPanel.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicHouse/PicHouseSettingPanel.ts?")},"./src/ui/PicPropFun/PicPropFunConfig.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicPropFunConfig", function() { return PicPropFunConfig; });\nvar PicPropFunConfig = /** @class */ (function () {\r\n    function PicPropFunConfig() {\r\n    }\r\n    return PicPropFunConfig;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicPropFun/PicPropFunConfig.ts?')},"./src/ui/PicPropFun/PicPropFunMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicPropFunMediator", function() { return PicPropFunMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicPropFunPanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicPropFunPanel */ "./src/ui/PicPropFun/PicPropFunPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicPropFunMediator = /** @class */ (function (_super) {\r\n    __extends(PicPropFunMediator, _super);\r\n    function PicPropFunMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicPropFunMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicPropFunPanel__WEBPACK_IMPORTED_MODULE_1__["PicPropFunPanel"](this.scene, this.world);\r\n            this.mView.on("close", this.onCloseHandler, this);\r\n        }\r\n        this.mView.show(this.mParam);\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicPropFunMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicPropFunMediator.prototype.onCloseHandler = function () {\r\n        this.destroy();\r\n    };\r\n    return PicPropFunMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicPropFun/PicPropFunMediator.ts?')},"./src/ui/PicPropFun/PicPropFunPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicPropFunPanel", function() { return PicPropFunPanel; });\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _lib_rexui_lib_ui_slider_GameSlider__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/slider/GameSlider */ "./lib/rexui/lib/ui/slider/GameSlider.ts");\n/* harmony import */ var _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../Market/DetailDisplay */ "./src/ui/Market/DetailDisplay.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PicPropFunPanel = /** @class */ (function (_super) {\r\n    __extends(PicPropFunPanel, _super);\r\n    function PicPropFunPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.itemCount = 1;\r\n        _this.key = "picpropfunpanel";\r\n        return _this;\r\n    }\r\n    PicPropFunPanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.blackGraphic.clear();\r\n        this.blackGraphic.fillStyle(0, 0.66);\r\n        this.blackGraphic.fillRect(0, 0, width, height);\r\n        this.content.x = width / 2;\r\n        this.content.y = height / 2;\r\n        this.setSize(width * this.scale, height * this.scale);\r\n    };\r\n    PicPropFunPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n        var config = this.mShowData[0];\r\n        this.setProp(config);\r\n        this.updateData();\r\n    };\r\n    PicPropFunPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.cancelBtn.on("Tap", this.onCancelBtnHandler, this);\r\n        this.confirmBtn.on("Tap", this.onConfirmBtnHandler, this);\r\n    };\r\n    PicPropFunPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.cancelBtn.off("Tap", this.onCancelBtnHandler, this);\r\n        this.confirmBtn.off("Tap", this.onConfirmBtnHandler, this);\r\n    };\r\n    PicPropFunPanel.prototype.preload = function () {\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasName"].commonUrl + ".json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasName"].common2Url + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasName"].common2Url + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicPropFunPanel.prototype.init = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var dpr = this.dpr;\r\n        this.blackGraphic = this.scene.make.graphics(undefined, false);\r\n        this.blackGraphic.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        this.add(this.blackGraphic);\r\n        this.content = this.scene.make.container(undefined, false);\r\n        var bgwidth = 299 * this.dpr, bgheight = 305 * this.dpr;\r\n        this.content.setSize(bgwidth, bgheight);\r\n        this.add(this.content);\r\n        var bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["NineSlicePatch"](this.scene, 0, 0, bgwidth, bgheight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, "bg", {\r\n            left: 20 * this.dpr,\r\n            top: 20 * this.dpr,\r\n            right: 20 * this.dpr,\r\n            bottom: 40 * this.dpr\r\n        });\r\n        bg.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        var posY = -bg.height * 0.5 + 3 * dpr;\r\n        var titlebg = this.scene.make.image({ x: 0, y: posY, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, frame: "title" });\r\n        this.titleName = this.scene.make.text({\r\n            x: 0, y: posY + 3 * dpr, text: "售出",\r\n            style: {\r\n                color: "#905B06",\r\n                fontSize: 16 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].BOLD_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.titleName.setFontStyle("bold");\r\n        this.itemName = this.scene.make.text({\r\n            x: 0, y: posY + 40 * dpr,\r\n            style: {\r\n                color: "#000000",\r\n                fontSize: 15 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var iconOffset = -40 * dpr;\r\n        this.mDetailDisplay = new _Market_DetailDisplay__WEBPACK_IMPORTED_MODULE_8__["DetailDisplay"](this.scene);\r\n        this.mDetailDisplay.scale = this.dpr * 0.8;\r\n        this.mDetailDisplay.y = iconOffset;\r\n        var priceOffset = 30 * dpr;\r\n        this.priceBg = this.scene.make.image({ x: 0, y: priceOffset, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, frame: "price_bg" });\r\n        this.pricText = this.scene.make.text({\r\n            x: 0, y: priceOffset,\r\n            style: {\r\n                color: "#000000",\r\n                fontSize: 15 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mCoinIcon = this.scene.make.image({ x: -45 * this.dpr, y: priceOffset, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].commonKey, frame: "iv_coin" }, false).setOrigin(0.5);\r\n        var sliderbg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["NineSlicePatch"](this.scene, 0, 0, 8, 7 * dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, "slider_bg", {\r\n            left: 3,\r\n            top: 1,\r\n            right: 3,\r\n            bottom: 1\r\n        });\r\n        var indicator = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_4__["NineSlicePatch"](this.scene, 0, 0, 8, 7 * dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, "slider_rate", {\r\n            left: 3,\r\n            top: 1,\r\n            right: 3,\r\n            bottom: 1\r\n        });\r\n        var thumb = this.scene.make.image({ key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].common2Key, frame: "block" });\r\n        this.thumb = thumb;\r\n        this.itemCountText = this.scene.make.text({\r\n            x: 0, y: 0,\r\n            style: {\r\n                color: "#744803",\r\n                fontSize: 15 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.slider = new _lib_rexui_lib_ui_slider_GameSlider__WEBPACK_IMPORTED_MODULE_7__["GameSlider"](this.scene, {\r\n            x: 0, y: 70 * dpr, width: 136 * dpr, height: 7 * dpr, orientation: 1,\r\n            background: sliderbg,\r\n            indicator: indicator,\r\n            thumb: thumb,\r\n            offsetX: thumb.width * 0.5,\r\n            valuechangeCallback: this.onSliderValueHandler,\r\n            valuechangeCallbackScope: this,\r\n            value: 0.5\r\n        });\r\n        this.slider.add(this.itemCountText);\r\n        this.slider.setValue(0);\r\n        var bottomOffsetY = bg.height * 0.5 - 30 * dpr;\r\n        var bottomOffsetX = -66 * dpr;\r\n        this.cancelBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_5__["NineSliceButton"](this.scene, bottomOffsetX, bottomOffsetY, 112 * dpr, 36 * dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].commonKey, "red_btn", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("common.cancel"), dpr, this.scale, {\r\n            left: 12 * dpr,\r\n            top: 12 * dpr,\r\n            right: 12 * dpr,\r\n            bottom: 12 * dpr\r\n        });\r\n        this.confirmBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_5__["NineSliceButton"](this.scene, -bottomOffsetX, bottomOffsetY, 112 * dpr, 36 * dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_6__["UIAtlasKey"].commonKey, "yellow_btn", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("common.confirm"), dpr, this.scale, {\r\n            left: 12 * dpr,\r\n            top: 12 * dpr,\r\n            right: 12 * dpr,\r\n            bottom: 12 * dpr\r\n        });\r\n        this.cancelBtn.setTextStyle({ color: "#FFFFFF", fontSize: 16 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].BOLD_FONT });\r\n        this.confirmBtn.setTextStyle({ color: "#976400", fontSize: 16 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_0__["Font"].BOLD_FONT });\r\n        this.content.add([bg, titlebg, this.titleName, this.itemName, this.mDetailDisplay, this.priceBg, this.mCoinIcon, this.pricText, this.slider, this.cancelBtn, this.confirmBtn]);\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicPropFunPanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicPropFunPanel.prototype.setProp = function (config) {\r\n        var prop = config.data;\r\n        var price = (config.price !== undefined ? config.price : true);\r\n        price = prop.sellingPrice ? price : false;\r\n        var slider = (config.slider !== undefined ? config.slider : true);\r\n        this.itemData = prop;\r\n        if (slider)\r\n            this.itemCount = 1;\r\n        else\r\n            this.itemCount = prop.count;\r\n        this.setResource(config.resource);\r\n        this.itemName.text = prop.name || prop.shortName;\r\n        this.itemCountText.text = this.itemCount + "";\r\n        if (config.title) {\r\n            this.titleName.text = config.title;\r\n        }\r\n        if (price) {\r\n            this.pricText.visible = true;\r\n            this.priceBg.visible = true;\r\n            this.mCoinIcon.visible = true;\r\n            this.slider.y = 70 * this.dpr;\r\n            this.pricText.text = prop.sellingPrice.price * this.itemCount + "  银币";\r\n            var coinIcon = _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Coin"].getIcon(prop.sellingPrice.coinType);\r\n            this.mCoinIcon.setFrame(coinIcon);\r\n        }\r\n        else {\r\n            this.pricText.visible = false;\r\n            this.priceBg.visible = false;\r\n            this.mCoinIcon.visible = false;\r\n            this.slider.y = 50 * this.dpr;\r\n        }\r\n        this.confirmHandler = config.confirmHandler;\r\n        this.cancelHandler = config.cancelHandler;\r\n        this.slider.visible = slider;\r\n        this.slider.setValue(this.itemCount / prop.count);\r\n    };\r\n    PicPropFunPanel.prototype.setResource = function (content) {\r\n        if (content) {\r\n            if (content.display) {\r\n                this.mDetailDisplay.loadDisplay(content);\r\n            }\r\n            else if (content.avatar) {\r\n                // const player = this.mWorld.roomManager.currentRoom.playerManager.actor;\r\n                // const avatar = player.model.avatar;\r\n                // for (const key in avatar) {\r\n                //     if (avatar.hasOwnProperty(key)) {\r\n                //         const element = avatar[key];\r\n                //         if (element && !content.avatar[key]) content.avatar[key] = element;\r\n                //     }\r\n                // }\r\n                var offset = new Phaser.Geom.Point(0, 35 * 2);\r\n                this.mDetailDisplay.loadAvatar(content, 2, offset);\r\n            }\r\n        }\r\n        else {\r\n            this.mDetailDisplay.loadUrl(this.itemData.display.texturePath);\r\n        }\r\n    };\r\n    PicPropFunPanel.prototype.updateData = function () {\r\n        if (this.itemCountText)\r\n            this.itemCountText.text = this.itemCount + "";\r\n        if (this.pricText && this.itemData && this.itemData.sellingPrice)\r\n            this.pricText.text = this.itemData.sellingPrice.price * this.itemCount + "  银币";\r\n    };\r\n    PicPropFunPanel.prototype.onCancelBtnHandler = function () {\r\n        if (this.cancelHandler)\r\n            this.cancelHandler.runWith(this.itemData);\r\n        this.emit("close");\r\n    };\r\n    PicPropFunPanel.prototype.onConfirmBtnHandler = function () {\r\n        if (this.confirmHandler)\r\n            this.confirmHandler.runWith([this.itemData, this.itemCount]);\r\n        this.emit("close");\r\n    };\r\n    PicPropFunPanel.prototype.onSliderValueHandler = function (value) {\r\n        this.itemCountText.x = this.thumb.x;\r\n        this.itemCount = this.calcuSliderValue(value);\r\n        this.updateData();\r\n    };\r\n    PicPropFunPanel.prototype.calcuSliderValue = function (value) {\r\n        var allcount = this.itemData ? this.itemData.count : 0;\r\n        var count = 0;\r\n        var line = 10;\r\n        var num = 4;\r\n        if (allcount <= line * num) {\r\n            count = Math.round(allcount * value);\r\n        }\r\n        else {\r\n            if (value <= 1 / num) {\r\n                count = line * num * value;\r\n            }\r\n            else {\r\n                var mcount = allcount - line;\r\n                if (mcount <= line * num) {\r\n                    count = line + mcount * (value - 1 / num) / (1 - 1 / num);\r\n                }\r\n                else {\r\n                    var ncount = mcount / num;\r\n                    count = line;\r\n                    for (var i = 1; i < num; i++) {\r\n                        var fcount = ncount + mcount / (num * (num - 1)) * (i - 1);\r\n                        if (value > i / num && value <= (i + 1) / num) {\r\n                            count += fcount * (value - i / num) / (1 / num);\r\n                            break;\r\n                        }\r\n                        else {\r\n                            count += fcount;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        count = Math.round(count);\r\n        return count;\r\n    };\r\n    return PicPropFunPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_1__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicPropFun/PicPropFunPanel.ts?')},"./src/ui/PicRoomUpgrade/PicRoomUpgrade.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicRoomUpgrade", function() { return PicRoomUpgrade; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicRoomUpgrade = /** @class */ (function (_super) {\r\n    __extends(PicRoomUpgrade, _super);\r\n    function PicRoomUpgrade($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicRoomUpgrade.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            //    this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, this.handleCharacterChat);\r\n        }\r\n    };\r\n    PicRoomUpgrade.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicRoomUpgrade.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicRoomUpgrade.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicRoomUpgrade.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(PicRoomUpgrade.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PicRoomUpgrade.prototype.queryTargetUI = function (uiid) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = packet.content;\r\n        content.uiId = uiid;\r\n        content.componentId = 0;\r\n        this.connection.send(packet);\r\n    };\r\n    return PicRoomUpgrade;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicRoomUpgrade/PicRoomUpgrade.ts?')},"./src/ui/PicRoomUpgrade/PicRoomUpgradeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicRoomUpgradeMediator", function() { return PicRoomUpgradeMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicRoomUpgradePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicRoomUpgradePanel */ "./src/ui/PicRoomUpgrade/PicRoomUpgradePanel.ts");\n/* harmony import */ var _PicRoomUpgrade__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PicRoomUpgrade */ "./src/ui/PicRoomUpgrade/PicRoomUpgrade.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicRoomUpgradeMediator = /** @class */ (function (_super) {\r\n    __extends(PicRoomUpgradeMediator, _super);\r\n    function PicRoomUpgradeMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicRoomUpgradeMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.picRoom) {\r\n            this.picRoom = new _PicRoomUpgrade__WEBPACK_IMPORTED_MODULE_2__["PicRoomUpgrade"](this.world);\r\n            this.picRoom.register();\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicRoomUpgradePanel__WEBPACK_IMPORTED_MODULE_1__["PicRoomUpgradePanel"](this.scene, this.world);\r\n            this.mView.on("querytargetui", this.onQueryTargetUI, this);\r\n        }\r\n        this.mView.show(this.mParam);\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicRoomUpgradeMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.layerManager.removeToUILayer(this.mView);\r\n    };\r\n    PicRoomUpgradeMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicRoomUpgradeMediator.prototype.destroy = function () {\r\n        if (this.picRoom) {\r\n            this.picRoom.destroy();\r\n            this.picRoom = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicRoomUpgradeMediator.prototype.onQueryTargetUI = function (uid) {\r\n        this.picRoom.queryTargetUI(uid);\r\n        this.destroy();\r\n    };\r\n    return PicRoomUpgradeMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicRoomUpgrade/PicRoomUpgradeMediator.ts?')},"./src/ui/PicRoomUpgrade/PicRoomUpgradePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicRoomUpgradePanel", function() { return PicRoomUpgradePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicRoomUpgradePanel = /** @class */ (function (_super) {\r\n    __extends(PicRoomUpgradePanel, _super);\r\n    function PicRoomUpgradePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "picroomupgradepanel";\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    PicRoomUpgradePanel.prototype.resize = function (w, h) {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        this.content.x = width * 0.5;\r\n        this.content.y = height * 0.5;\r\n        this.setSize(width, height);\r\n    };\r\n    PicRoomUpgradePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.addListen();\r\n        this.updateData();\r\n    };\r\n    PicRoomUpgradePanel.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.removeListen();\r\n    };\r\n    PicRoomUpgradePanel.prototype.updateData = function () {\r\n        var data = this.mShowData[0];\r\n        this.mTitleName.text = data.text[0].text;\r\n        var lv = data.data[0];\r\n        this.roomIcon.play("lv" + lv);\r\n    };\r\n    PicRoomUpgradePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.setInteractive(new Phaser.Geom.Rectangle(this.width * 0.5, this.height * 0.5, this.width, this.height), Phaser.Geom.Rectangle.Contains);\r\n        this.on("pointerup", this.onClickHandler, this);\r\n    };\r\n    PicRoomUpgradePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.removeInteractive();\r\n        this.off("pointerup", this.onClickHandler, this);\r\n    };\r\n    PicRoomUpgradePanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicRoomUpgradePanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "e_roomupgrade/e_roomupgrade.png", "e_roomupgrade/e_roomupgrade.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicRoomUpgradePanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var w = this.scaleWidth;\r\n        var h = this.scaleHeight;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        this.mBackground.clear();\r\n        this.mBackground.fillStyle(0, 0.66);\r\n        this.mBackground.fillRect(0, 0, w, h);\r\n        this.add(this.mBackground);\r\n        this.content = this.scene.make.container(undefined, false);\r\n        this.content.setSize(w, 462 * this.dpr);\r\n        var conbg = this.scene.make.image({ x: 0, y: -20 * this.dpr, key: this.key, frame: "effect_bg" });\r\n        this.content.add(conbg);\r\n        var titleBg = this.scene.make.image({ key: this.key, frame: "tittle_bg" });\r\n        titleBg.y = -this.content.height * 0.5;\r\n        var font = 22 * this.dpr + "px " + _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].BOLD_FONT;\r\n        this.mTitleName = this.scene.make.text({\r\n            x: 0, y: titleBg.y, text: "Room upgrade to Lv3",\r\n            style: { font: font, fill: "#FFF36D" }\r\n        }).setOrigin(0.5);\r\n        this.mTitleName.setStroke("#471C1E", 8);\r\n        this.mTitleName.setShadow(2, 2, "#471C1E", 2, true, true);\r\n        this.mTitleName.setTint(0xFFF36D, 0xFFF36D, 0xFFAE00, 0xFFAE00);\r\n        this.content.add([titleBg, this.mTitleName]);\r\n        var bottomTitle = this.scene.make.text({\r\n            x: 0, y: this.content.height * 0.5 - 40 * this.dpr, text: _i18n__WEBPACK_IMPORTED_MODULE_1__["i18n"].t("room_upgrade.clicktocontinue"),\r\n            style: { fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT, fontSize: 16 * this.dpr, color: "#FFF000" }\r\n        }).setOrigin(0.5);\r\n        this.roomIcon = this.scene.make.sprite({ key: this.key, frame: "lv1" });\r\n        this.roomIcon.y = -40 * this.dpr;\r\n        this.content.add([this.roomIcon, bottomTitle]);\r\n        this.add(this.content);\r\n        this.createAnimations();\r\n        this.resize(0, 0);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicRoomUpgradePanel.prototype.onClickHandler = function () {\r\n        var data = this.mShowData[0];\r\n        this.emit("querytargetui", data.id);\r\n    };\r\n    PicRoomUpgradePanel.prototype.createAnimations = function () {\r\n        for (var i = 1; i <= 4; i++) {\r\n            this.scene.anims.create({ key: "lv" + i, frames: this.scene.anims.generateFrameNames(this.key, { prefix: "lv", frames: [i - 1, i] }), duration: 500, repeat: -1 });\r\n        }\r\n    };\r\n    return PicRoomUpgradePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicRoomUpgrade/PicRoomUpgradePanel.ts?')},"./src/ui/PicaChat/PicaChat.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaChat", function() { return PicaChat; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicaChat = /** @class */ (function (_super) {\r\n    __extends(PicaChat, _super);\r\n    function PicaChat($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicaChat.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, this.handleCharacterChat);\r\n        }\r\n    };\r\n    PicaChat.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicaChat.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicaChat.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicaChat.prototype.sendMessage = function (val) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_GATEWAY_REQ_VIRTUAL_WORLD_CHAT);\r\n        var content = pkt.content;\r\n        content.chatChannel = 0;\r\n        content.chatContext = val;\r\n        this.connection.send(pkt);\r\n    };\r\n    PicaChat.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    PicaChat.prototype.handleCharacterChat = function (packet) {\r\n        this.mEvent.emit("chat", packet.content);\r\n    };\r\n    Object.defineProperty(PicaChat.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return PicaChat;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaChat/PicaChat.ts?')},"./src/ui/PicaChat/PicaChatMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaChatMediator", function() { return PicaChatMediator; });\n/* harmony import */ var _PicaChatPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PicaChatPanel */ "./src/ui/PicaChat/PicaChatPanel.ts");\n/* harmony import */ var _PicaChat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicaChat */ "./src/ui/PicaChat/PicaChat.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar PicaChatMediator = /** @class */ (function (_super) {\r\n    __extends(PicaChatMediator, _super);\r\n    function PicaChatMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicaChatMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.mView.show();\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.mChat) {\r\n            this.mChat = new _PicaChat__WEBPACK_IMPORTED_MODULE_1__["PicaChat"](this.world);\r\n            this.mChat.on("chat", this.onChatHandler, this);\r\n            this.mChat.register();\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicaChatPanel__WEBPACK_IMPORTED_MODULE_0__["PicaChatPanel"](this.scene, this.world);\r\n            this.mView.on("showNavigate", this.onShowNavigateHandler, this);\r\n            this.mView.on("chat", this.onSendChatHandler, this);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicaChatMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    PicaChatMediator.prototype.destroy = function () {\r\n        if (this.mChat) {\r\n            this.mChat.destroy();\r\n            this.mChat = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaChatMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.mView.removeListen();\r\n        this.layerManager.removeToUILayer(this.mView);\r\n    };\r\n    PicaChatMediator.prototype.onShowNavigateHandler = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        var uiManager = this.world.uiManager;\r\n        uiManager.showMed("PicaNavigate");\r\n        uiManager.hideMed("PicHandheld");\r\n        this.hide();\r\n    };\r\n    PicaChatMediator.prototype.onChatHandler = function (content) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        var player = this.getSpeaker(content.chatSenderid);\r\n        var speaker = "";\r\n        if (player) {\r\n            speaker = "" + player.model.nickname;\r\n        }\r\n        else {\r\n            if (content.chatSenderid) {\r\n                speaker = "神秘人";\r\n            }\r\n        }\r\n        var color = "#ffffff";\r\n        if (content.chatSetting) {\r\n            color = content.chatSetting.textColor;\r\n        }\r\n        this.appendChat("[color=" + color + "][" + this.getChannel(content.chatChannel) + "]" + speaker + ": " + content.chatContext + "[/color]\\n");\r\n    };\r\n    PicaChatMediator.prototype.appendChat = function (chat) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.appendChat(chat);\r\n    };\r\n    PicaChatMediator.prototype.onSendChatHandler = function (val) {\r\n        if (!this.mChat) {\r\n            return;\r\n        }\r\n        if (val === "whosyourdaddy") {\r\n            this.world.uiManager.showMed("DebugLogger");\r\n        }\r\n        this.mChat.sendMessage(val);\r\n    };\r\n    PicaChatMediator.prototype.getChannel = function (channel) {\r\n        switch (channel) {\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].ChatChannel.CurrentScene:\r\n                return "当前";\r\n            case pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].ChatChannel.World:\r\n                return "世界";\r\n            default:\r\n                return "系统";\r\n        }\r\n    };\r\n    PicaChatMediator.prototype.getSpeaker = function (id) {\r\n        if (id) {\r\n            if (!this.world || !this.world.roomManager || !this.world.roomManager.currentRoom) {\r\n                return;\r\n            }\r\n            return this.world.roomManager.currentRoom.getElement(id);\r\n        }\r\n    };\r\n    PicaChatMediator.NAME = "PicaChatMediator";\r\n    return PicaChatMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaChat/PicaChatMediator.ts?')},"./src/ui/PicaChat/PicaChatPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaChatPanel", function() { return PicaChatPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/textarea/TextArea */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_input_panel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/input.panel */ "./src/ui/components/input.panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar PicaChatPanel = /** @class */ (function (_super) {\r\n    __extends(PicaChatPanel, _super);\r\n    function PicaChatPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pica_chat";\r\n        _this.MAX_HEIGHT = 460 * _this.dpr;\r\n        _this.MIN_HEIGHT = 100 * _this.dpr;\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    PicaChatPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        //  this.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.width * 2, this.height), Phaser.Geom.Rectangle.Contains);\r\n        this.addListen();\r\n        this.checkUpdateActive();\r\n    };\r\n    PicaChatPanel.prototype.resize = function (w, h) {\r\n        this.setSize(w, h);\r\n        var zoom = this.scale;\r\n        var width = this.scene.cameras.main.width;\r\n        var height = this.scene.cameras.main.height;\r\n        var frame = this.scene.textures.getFrame(this.key, "title_bg");\r\n        var scaleRatio = width / frame.width;\r\n        this.mTitleBg.scaleX = scaleRatio;\r\n        this.mTitleBg.x = width / 2;\r\n        this.y = height - this.height;\r\n        this.mBackground.clear();\r\n        this.mBackground.fillStyle(0, 0.6);\r\n        this.mBackground.fillRect(0, 0, width, h);\r\n        this.mBackground.disableInteractive();\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, h), Phaser.Geom.Rectangle.Contains);\r\n        this.mTextArea.childrenMap.child.setMinSize(w, (h - 16 * this.dpr) * zoom);\r\n        this.mTextArea.layout();\r\n        this.mTextArea.setPosition(this.width / 2 + 4 * this.dpr, this.y + this.mTextArea.height / 2 + 10 * this.dpr * zoom);\r\n        var textMask = this.mTextArea.childrenMap.text;\r\n        textMask.y = 8 * this.dpr;\r\n        this.mTextArea.scrollToBottom();\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    PicaChatPanel.prototype.appendChat = function (val) {\r\n        if (this.mTextArea) {\r\n            this.mTextArea.appendText(val);\r\n            this.mTextArea.scrollToBottom();\r\n        }\r\n    };\r\n    PicaChatPanel.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.removeInteractive();\r\n    };\r\n    PicaChatPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        //  this.mBackground.setInteractive();\r\n        this.mChatBtn.setInteractive();\r\n        this.mEmojiBtn.setInteractive();\r\n        this.mScrollBtn.setInteractive();\r\n        this.mNavigateBtn.setInteractive();\r\n        this.mTitleBg.setInteractive();\r\n        this.mTextArea.childrenMap.child.setInteractive();\r\n        this.mScrollBtn.on("drag", this.onDragHandler, this);\r\n        this.mTitleBg.on("drag", this.onDragHandler, this);\r\n        this.scene.input.setDraggable(this.mScrollBtn, true);\r\n        this.scene.input.setDraggable(this.mTitleBg, true);\r\n        this.mNavigateBtn.on("pointerup", this.onShowNavigateHandler, this);\r\n        this.mChatBtn.on("pointerup", this.onShowInputHanldler, this);\r\n    };\r\n    PicaChatPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        // this.mBackground.disableInteractive();\r\n        this.mChatBtn.disableInteractive();\r\n        this.mEmojiBtn.disableInteractive();\r\n        this.mScrollBtn.disableInteractive();\r\n        this.mNavigateBtn.disableInteractive();\r\n        this.mTitleBg.disableInteractive();\r\n        this.mTextArea.childrenMap.child.disableInteractive();\r\n        this.mScrollBtn.off("drag", this.onDragHandler, this);\r\n        this.mTitleBg.off("drag", this.onDragHandler, this);\r\n        this.mNavigateBtn.off("pointerup", this.onShowNavigateHandler, this);\r\n        this.mChatBtn.off("pointerup", this.onShowInputHanldler, this);\r\n    };\r\n    PicaChatPanel.prototype.updateUIState = function (active) {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        if (active.name === "picachat.navigatebtn") {\r\n            this.mNavigateBtn.visible = active.visible;\r\n        }\r\n    };\r\n    PicaChatPanel.prototype.destroy = function () {\r\n        if (this.mBackground)\r\n            this.mBackground.disableInteractive();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaChatPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "pica_chat/pica_chat.png", "pica_chat/pica_chat.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaChatPanel.prototype.init = function () {\r\n        var width = this.scene.cameras.main.width;\r\n        var height = this.scene.cameras.main.height;\r\n        this.mBackground = this.scene.make.graphics(undefined, false);\r\n        this.mBackground.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, 200), Phaser.Geom.Rectangle.Contains);\r\n        var zoom = this.scale;\r\n        this.setSize(width, 135 * this.dpr);\r\n        this.mTileContainer = this.scene.make.container(undefined, false);\r\n        this.mScrollBtn = this.scene.make.image({ x: 21 * this.dpr * zoom, key: this.key, frame: "scroll_btn" }, false).setScale(zoom);\r\n        this.mTitleBg = this.scene.make.image({ key: this.key, frame: "title_bg" }, false).setScale(zoom);\r\n        this.mTitleBg.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n        this.mChatBtn = this.scene.make.image({ x: 96 * this.dpr * zoom, key: this.key, frame: "chat_icon" }, false).setScale(zoom);\r\n        this.mHornBtn = this.scene.make.image({ x: 159 * this.dpr * zoom, key: this.key, frame: "horn_icon" }, false).setScale(zoom);\r\n        this.mEmojiBtn = this.scene.make.image({ x: 218 * this.dpr * zoom, key: this.key, frame: "emoji" }, false).setScale(zoom);\r\n        this.mNavigateBtn = this.scene.make.image({ x: 281 * this.dpr, key: this.key, frame: "more_btn" }, false).setScale(zoom);\r\n        var space = 20 * this.dpr;\r\n        this.mScrollBtn.x = this.mScrollBtn.width * 0.5 + 5 * this.dpr;\r\n        this.mScrollBtn.y = -this.mScrollBtn.height / 2 + this.mTitleBg.height;\r\n        this.mChatBtn.x = this.mScrollBtn.x + this.mScrollBtn.width * 0.5 + space + this.mChatBtn.width * 0.5;\r\n        this.mChatBtn.y = -this.mChatBtn.height / 2 + this.mTitleBg.height;\r\n        this.mHornBtn.x = this.mChatBtn.x + this.mChatBtn.width * 0.5 + space + this.mHornBtn.width * 0.5;\r\n        this.mHornBtn.y = -this.mHornBtn.height / 2 + this.mTitleBg.height;\r\n        this.mEmojiBtn.x = this.mHornBtn.x + this.mHornBtn.width * 0.5 + space + this.mEmojiBtn.width * 0.5;\r\n        this.mEmojiBtn.y = -this.mEmojiBtn.height / 2 + this.mTitleBg.height;\r\n        this.mNavigateBtn.x = width - this.mNavigateBtn.width * 0.5 - 5 * this.dpr;\r\n        this.mNavigateBtn.y = -this.mNavigateBtn.height / 2 + this.mTitleBg.height;\r\n        this.mOutputText = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: 14 * this.dpr / zoom + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].DEFULT_FONT,\r\n            stroke: "#000000",\r\n            strokeThickness: 1 * this.dpr * zoom,\r\n            textMask: false,\r\n            shadow: {\r\n                offsetX: 0,\r\n                offsetY: 0,\r\n                color: "#000",\r\n                blur: 4,\r\n                stroke: true,\r\n                fill: true\r\n            },\r\n            wrap: {\r\n                mode: "char",\r\n                width: width - 12 * this.dpr * zoom\r\n            }\r\n        });\r\n        var background = this.scene.make.graphics(undefined, false);\r\n        this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, {\r\n            x: width / 2 + 4 * this.dpr * zoom,\r\n            y: 160 * this.dpr * zoom,\r\n            // background: (<any>this.scene).rexUI.add.roundRectangle(0, 0, 2, 2, 0, 0xFF9900, 0.2),\r\n            textWidth: width - 4 * this.dpr * zoom,\r\n            textHeight: this.MAX_HEIGHT,\r\n            text: this.mOutputText,\r\n        })\r\n            .layout();\r\n        this.mTileContainer.add([\r\n            this.mTitleBg,\r\n            this.mChatBtn,\r\n            this.mHornBtn,\r\n            this.mEmojiBtn,\r\n            this.mScrollBtn,\r\n            this.mNavigateBtn\r\n        ]);\r\n        this.add([\r\n            this.mBackground,\r\n            this.mTileContainer,\r\n            this.mTextArea,\r\n            this.mOutputText,\r\n            background,\r\n        ]);\r\n        this.mTextArea.setSliderEnable(false);\r\n        // this.mTextArea.childrenMap.child.disableInteractive();\r\n        this.resize(this.width, 400);\r\n        _super.prototype.init.call(this);\r\n        this.removeInteractive();\r\n        // this.addActionListener();\r\n        // this.appendChat("小盆友[color=yellow]进入房间[/color]\\n");\r\n        // this.appendChat("一直狐狸[color=yellow]离开房间[/color]\\n");\r\n        // this.appendChat("[color=#ffffff][当前]小盆友：玩家注册后，账户等级为Lv1级。[/color]\\n");\r\n        // this.appendChat("[color=#66ffff][喇叭]。用户在游戏内游玩时，使用该道具，经验值收益为4倍增长，时间上限为4h[/color]\\n");\r\n        // this.appendChat("[color=#ffff00]等级提升为6级[/color]\\n");\r\n    };\r\n    PicaChatPanel.prototype.onDragHandler = function (pointer, dragX, dragY) {\r\n        var height = this.height + (pointer.prevPosition.y - pointer.position.y);\r\n        if (height > this.MAX_HEIGHT || height < this.MIN_HEIGHT) {\r\n            return;\r\n        }\r\n        this.resize(this.width, height);\r\n    };\r\n    PicaChatPanel.prototype.onShowNavigateHandler = function () {\r\n        this.emit("showNavigate");\r\n    };\r\n    PicaChatPanel.prototype.onShowInputHanldler = function () {\r\n        // new InputPanel(this.scene);\r\n        if (this.mInputText) {\r\n            return;\r\n        }\r\n        this.mInputText = new _components_input_panel__WEBPACK_IMPORTED_MODULE_4__["InputPanel"](this.scene, this.mWorld);\r\n        this.mInputText.once("close", this.sendChat, this);\r\n    };\r\n    PicaChatPanel.prototype.sendChat = function (val) {\r\n        this.mInputText = undefined;\r\n        if (!val) {\r\n            return;\r\n        }\r\n        this.emit("chat", val);\r\n    };\r\n    PicaChatPanel.prototype.checkUpdateActive = function () {\r\n        var arr = this.mWorld.uiManager.getActiveUIData("PicaChat");\r\n        if (arr) {\r\n            for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n                var data = arr_1[_i];\r\n                this.updateUIState(data);\r\n            }\r\n        }\r\n    };\r\n    return PicaChatPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaChat/PicaChatPanel.ts?')},"./src/ui/PicaMainUI/PicaMainUI.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaMainUI", function() { return PicaMainUI; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicaMainUI = /** @class */ (function (_super) {\r\n    __extends(PicaMainUI, _super);\r\n    function PicaMainUI(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        _this.register();\r\n        return _this;\r\n    }\r\n    PicaMainUI.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicaMainUI.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicaMainUI.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_PLAYER_INFO, this.onUpdatePlayerInfo);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_INFO, this.onUpdateModeRoomInfo);\r\n        }\r\n    };\r\n    PicaMainUI.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicaMainUI.prototype.destroy = function () {\r\n        this.unregister();\r\n    };\r\n    PicaMainUI.prototype.onUpdatePlayerInfo = function (packet) {\r\n        this.mEvent.emit("updateplayer", packet.content);\r\n    };\r\n    PicaMainUI.prototype.onUpdateModeRoomInfo = function (packet) {\r\n        this.mEvent.emit("updateroom", packet.content);\r\n    };\r\n    Object.defineProperty(PicaMainUI.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return PicaMainUI;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaMainUI/PicaMainUI.ts?')},"./src/ui/PicaMainUI/PicaMainUIMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaMainUIMediator", function() { return PicaMainUIMediator; });\n/* harmony import */ var _PicaMainUIPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PicaMainUIPanel */ "./src/ui/PicaMainUI/PicaMainUIPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicaMainUI__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PicaMainUI */ "./src/ui/PicaMainUI/PicaMainUI.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicaMainUIMediator = /** @class */ (function (_super) {\r\n    __extends(PicaMainUIMediator, _super);\r\n    function PicaMainUIMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.world = worldService;\r\n        _this.mainUI = new _PicaMainUI__WEBPACK_IMPORTED_MODULE_2__["PicaMainUI"](worldService);\r\n        _this.mainUI.on("updateplayer", _this.onUpdatePlayerHandler, _this);\r\n        _this.mainUI.on("updateroom", _this.onUpdateRoomHandler, _this);\r\n        return _this;\r\n    }\r\n    PicaMainUIMediator.prototype.show = function (param) {\r\n        if (this.mView) {\r\n            this.update(param);\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicaMainUIPanel__WEBPACK_IMPORTED_MODULE_0__["PicaMainUIPanel"](this.scene, this.world);\r\n            this.mView.on("showPanel", this.onShowPanelHandler, this);\r\n            this.mView.on("openroompanel", this.onOpenRoomHandler, this);\r\n        }\r\n        this.mView.show(param);\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicaMainUIMediator.prototype.destroy = function () {\r\n        if (this.mainUI) {\r\n            this.mainUI.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Object.defineProperty(PicaMainUIMediator.prototype, "playerInfo", {\r\n        get: function () {\r\n            return this.mPlayerInfo;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PicaMainUIMediator.prototype, "roomInfo", {\r\n        get: function () {\r\n            return this.mRoomInfo;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PicaMainUIMediator.prototype, "isSelfRoom", {\r\n        get: function () {\r\n            if (!this.playerInfo || !this.roomInfo)\r\n                return false;\r\n            var rooms = this.playerInfo.rooms;\r\n            var curRoomid = this.roomInfo.roomId;\r\n            for (var _i = 0, rooms_1 = rooms; _i < rooms_1.length; _i++) {\r\n                var room = rooms_1[_i];\r\n                if (room.roomId === curRoomid)\r\n                    return true;\r\n            }\r\n            return false;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PicaMainUIMediator.prototype.onOpenRoomHandler = function () {\r\n        if (!this.roomInfo || this.roomInfo.roomType !== "pkt_ST0000000")\r\n            return;\r\n        var uimanager = this.world.uiManager;\r\n        uimanager.showMed("PicHouse");\r\n    };\r\n    PicaMainUIMediator.prototype.onUpdateHandler = function (data) {\r\n        this.show(data);\r\n    };\r\n    PicaMainUIMediator.prototype.onUpdatePlayerHandler = function (content) {\r\n        this.onUpdateHandler(content);\r\n        this.mPlayerInfo = content;\r\n    };\r\n    PicaMainUIMediator.prototype.onUpdateRoomHandler = function (content) {\r\n        this.onUpdateHandler(content);\r\n        this.mRoomInfo = content;\r\n    };\r\n    PicaMainUIMediator.prototype.onShowPanelHandler = function (panel, data) {\r\n        if (!panel || !this.world) {\r\n            return;\r\n        }\r\n        var uiManager = this.world.uiManager;\r\n        if (data)\r\n            uiManager.showMed(panel, data);\r\n        else\r\n            uiManager.showMed(panel);\r\n    };\r\n    PicaMainUIMediator.NAME = "PicaMainUIMediator";\r\n    return PicaMainUIMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaMainUI/PicaMainUIMediator.ts?')},"./src/ui/PicaMainUI/PicaMainUIPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaMainUIPanel", function() { return PicaMainUIPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _tips_TextToolTip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tips/TextToolTip */ "./src/ui/tips/TextToolTip.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar PicaMainUIPanel = /** @class */ (function (_super) {\r\n    __extends(PicaMainUIPanel, _super);\r\n    function PicaMainUIPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.key = "main_ui";\r\n        _this.isSceneNameActive = false;\r\n        return _this;\r\n    }\r\n    PicaMainUIPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized) {\r\n            this.setInteractive();\r\n            this.update(param);\r\n            this.checkUpdateActive();\r\n        }\r\n    };\r\n    PicaMainUIPanel.prototype.resize = function (w, h) {\r\n        var width = this.scene.cameras.main.width / this.scale;\r\n        var height = this.scene.cameras.main.height / this.scale;\r\n        _super.prototype.resize.call(this, width, height);\r\n        this.mCoinValue.x = width - this.mCoinValue.width / 2 - 5 * this.dpr;\r\n        this.mDiamondValue.x = width - this.mDiamondValue.width / 2 - 5 * this.dpr;\r\n    };\r\n    PicaMainUIPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "main_ui/main_ui.png", "main_ui/main_ui.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaMainUIPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!this.mSceneName) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().fatal(PicaMainUIPanel.name + ": sceneName does not exist!");\r\n            return;\r\n        }\r\n        this.mSceneName.on("pointerup", this.onOpenRoomPanel, this);\r\n    };\r\n    PicaMainUIPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!this.mSceneName) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_3__["Logger"].getInstance().fatal(PicaMainUIPanel.name + ": sceneName does not exist!");\r\n            return;\r\n        }\r\n        this.mSceneName.off("pointerup", this.onOpenRoomPanel, this);\r\n    };\r\n    PicaMainUIPanel.prototype.update = function (param) {\r\n        Object.assign(this.mShowData, param);\r\n        _super.prototype.update.call(this, this.mShowData);\r\n        if (!param) {\r\n            return;\r\n        }\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        if (param.hasOwnProperty("level")) {\r\n            var level = param.level;\r\n            var curExp = (level.currentLevelExp === undefined ? 0 : level.currentLevelExp);\r\n            this.mExpProgress.setLv(level.level, curExp / level.nextLevelExp);\r\n        }\r\n        if (param.hasOwnProperty("coin"))\r\n            this.mCoinValue.setText(param.coin.toString());\r\n        if (param.hasOwnProperty("diamond"))\r\n            this.mDiamondValue.setText(param.diamond.toString());\r\n        if (param.hasOwnProperty("energy")) {\r\n            var energy = param.energy;\r\n            if (energy) {\r\n                this.mStrengthValue.setValue(energy.currentValue, energy.max);\r\n            }\r\n            else {\r\n                this.mStrengthValue.setValue(0, 100);\r\n            }\r\n        }\r\n        if (param.hasOwnProperty("name")) {\r\n            this.mSceneName.setText(param.name);\r\n            var bound = this.mSceneName.getBounds();\r\n            this.mSceneName.setSize(bound.width, bound.height);\r\n            this.mSceneName.setInteractive(new Phaser.Geom.Rectangle(this.mSceneName.width / 2, 0, this.mSceneName.width, this.mSceneName.height), Phaser.Geom.Rectangle.Contains);\r\n            this.isSceneNameActive = true;\r\n        }\r\n        if (param.hasOwnProperty("ownerName")) {\r\n            this.mSceneType.setText(param.ownerName);\r\n        }\r\n        if (param.hasOwnProperty("playerCount")) {\r\n            // TODO 多语言适配\r\n            this.mCounter.setText(param.playerCount + "\\u4EBA");\r\n        }\r\n    };\r\n    PicaMainUIPanel.prototype.updateUIState = function (active) {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        if (active.name === "mainui.playerinfo") {\r\n            this.playerCon.visible = active.visible;\r\n        }\r\n        if (active.name === "mainui.roominfo") {\r\n            this.roomCon.visible = active.visible;\r\n        }\r\n        if (active.name === "mainui.headbtn") {\r\n            // this.playerIcon.visible = active.visible;\r\n            if (!active.disabled) {\r\n                this.playerIcon.setInteractive();\r\n            }\r\n            else {\r\n                this.playerIcon.removeInteractive();\r\n            }\r\n        }\r\n        if (active.name === "mainui.entereditorbtn") {\r\n            this.mSceneName.visible = active.visible;\r\n            if (this.isSceneNameActive) {\r\n                if (!active.disabled) {\r\n                    this.mSceneName.setInteractive(new Phaser.Geom.Rectangle(this.mSceneName.width / 2, 0, this.mSceneName.width, this.mSceneName.height), Phaser.Geom.Rectangle.Contains);\r\n                }\r\n                else {\r\n                    this.mSceneName.removeInteractive();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    PicaMainUIPanel.prototype.init = function () {\r\n        var w = this.scene.cameras.main.width;\r\n        var h = this.scene.cameras.main.height;\r\n        this.playerCon = this.scene.make.container(undefined, false);\r\n        this.add(this.playerCon);\r\n        this.mCoinValue = new ValueContainer(this.scene, this.key, "coin", this.dpr);\r\n        this.mCoinValue.y = 28 * this.dpr;\r\n        this.mDiamondValue = new ValueContainer(this.scene, this.key, "diamond", this.dpr);\r\n        this.mDiamondValue.y = 68 * this.dpr;\r\n        var frame = this.scene.textures.getFrame(this.key, "strength_progress");\r\n        this.mStrengthValue = new ProgressValue(this.scene, this.key, "strength_icon", this.dpr);\r\n        this.mStrengthValue.x = 78 * this.dpr;\r\n        this.mStrengthValue.y = 27 * this.dpr;\r\n        var ninePatch = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 60 * this.dpr / 2, this.mStrengthValue.height / 2 - frame.height - 1 * this.dpr, 62 * this.dpr, frame.height, this.key, "strength_progress", {\r\n            left: 8 * this.dpr,\r\n            top: 3 * this.dpr,\r\n            right: frame.width - 2 - 8 * this.dpr,\r\n            bottom: frame.height - 1 - 3 * this.dpr\r\n        });\r\n        this.mStrengthValue.setProgress(ninePatch, this.scale);\r\n        this.playerIcon = this.scene.make.image({ key: this.key, frame: "head" });\r\n        this.playerIcon.x = -this.mStrengthValue.width * 0.5 - 18 * this.dpr;\r\n        this.mStrengthValue.add(this.playerIcon);\r\n        this.playerIcon.on("pointerup", this.onHeadHandler, this);\r\n        this.playerIcon.setInteractive();\r\n        this.mStrengthValue.setValue(1000, 1000);\r\n        this.mStrengthValue.setInteractive();\r\n        this.mStrengthValue.on("pointerup", this.onStrengthHandler, this);\r\n        this.mExpProgress = new ExpProgress(this.scene, this.key, this.dpr, this.scale, this.mWorld);\r\n        this.playerCon.add([this.mExpProgress, this.mStrengthValue, this.mCoinValue, this.mDiamondValue]);\r\n        this.roomCon = this.scene.make.container(undefined, false);\r\n        this.add(this.roomCon);\r\n        this.mSceneName = new SceneName(this.scene, this.key, "room_icon", "setting_icon", this.dpr);\r\n        this.mSceneName.setText("");\r\n        this.mSceneName.x = 15 * this.dpr;\r\n        this.mSceneName.y = 55 * this.dpr;\r\n        this.mSceneType = new IconText(this.scene, this.key, "star_icon", this.dpr);\r\n        this.mSceneType.setText("");\r\n        this.mSceneType.x = 15 * this.dpr;\r\n        this.mSceneType.y = 80 * this.dpr;\r\n        this.mSceneType.setColor("#FFFF00");\r\n        this.mCounter = new IconText(this.scene, this.key, "counter_icon", this.dpr);\r\n        this.mCounter.setText("1人");\r\n        this.mCounter.x = 15 * this.dpr;\r\n        this.mCounter.y = 105 * this.dpr;\r\n        this.mCounter.setColor("#27f6ff");\r\n        this.textToolTip = new _tips_TextToolTip__WEBPACK_IMPORTED_MODULE_4__["TextToolTips"](this.scene, this.key, "tips_bg", this.dpr, this.scale);\r\n        this.textToolTip.setSize(160 * this.dpr, 45).visible = false;\r\n        this.roomCon.add([this.mSceneName, this.mSceneType, this.mCounter, this.textToolTip]);\r\n        // frame = this.scene.textures.getFrame(this.key, "health_progress");\r\n        // const healthValue = new ProgressValue(this.scene, this.key, "health_con", this.dpr);\r\n        // healthValue.x = 150 * this.dpr;\r\n        // healthValue.y = 27 * this.dpr;\r\n        // const healthNinePatch = new NinePatch(this.scene, 60 * this.dpr / 2, healthValue.height / 2 - frame.height - 1 * this.dpr, 62 * this.dpr, frame.height, this.key, "health_progress", {\r\n        //     left: 8 * this.dpr,\r\n        //     top: 3 * this.dpr,\r\n        //     right: frame.width - 2 - 8 * this.dpr,\r\n        //     bottom: frame.height - 1 - 3 * this.dpr\r\n        // });\r\n        // healthValue.setProgress(healthNinePatch, this.scale);\r\n        // this.add(healthValue);\r\n        // healthValue.setValue(200, 1000);\r\n        this.resize(w, h);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicaMainUIPanel.prototype.onOpenRoomPanel = function () {\r\n        this.emit("openroompanel");\r\n    };\r\n    PicaMainUIPanel.prototype.onHeadHandler = function () {\r\n        this.emit("showPanel", "CharacterInfo");\r\n    };\r\n    PicaMainUIPanel.prototype.onStrengthHandler = function () {\r\n        var width = this.scaleWidth;\r\n        var height = this.scaleHeight;\r\n        var energy = this.showData.energy;\r\n        var text = "当前精力值" + (energy.currentValue + "/" + energy.max + "\\n") + "精力不满时，每10分钟恢复1点";\r\n        this.textToolTip.setTextData(text, 3000);\r\n        this.textToolTip.setPosition(120 * this.dpr, 80 * this.dpr);\r\n    };\r\n    PicaMainUIPanel.prototype.checkUpdateActive = function () {\r\n        var arr = this.mWorld.uiManager.getActiveUIData("PicaMainUI");\r\n        if (arr) {\r\n            for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n                var data = arr_1[_i];\r\n                this.updateUIState(data);\r\n            }\r\n        }\r\n    };\r\n    return PicaMainUIPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar ValueContainer = /** @class */ (function (_super) {\r\n    __extends(ValueContainer, _super);\r\n    function ValueContainer(scene, key, leftIcon, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.init(key, leftIcon, dpr);\r\n        return _this;\r\n    }\r\n    ValueContainer.prototype.setText = function (val) {\r\n        this.mText.setText(val);\r\n    };\r\n    ValueContainer.prototype.init = function (key, leftIcon, dpr) {\r\n        var bg = this.scene.make.image({\r\n            key: key,\r\n            frame: "price_bg"\r\n        }, false);\r\n        var left = this.scene.make.image({\r\n            key: key,\r\n            frame: leftIcon,\r\n        }, false);\r\n        this.mText = this.scene.make.text({\r\n            text: "0",\r\n            width: bg.width,\r\n            height: bg.height,\r\n            style: {\r\n                fontSize: 14 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(1, 0);\r\n        this.mText.setStroke("#000000", 1 * dpr);\r\n        this.mAddBtn = this.scene.make.image({\r\n            key: key,\r\n            frame: "add_btn"\r\n        });\r\n        this.setSize(bg.width, bg.height);\r\n        left.x = -this.width * this.originX + 10 * dpr;\r\n        this.mAddBtn.x = this.width * this.originX - this.mAddBtn.width * this.originX;\r\n        this.mAddBtn.y = (this.height - this.mAddBtn.height) / 2 + 2 * dpr;\r\n        this.mText.x = this.width / 2 - 30 * dpr;\r\n        this.mText.y = -(this.height - 12 * dpr) / 2;\r\n        this.add([bg, left, this.mText, this.mAddBtn]);\r\n        this.mAddBtn.visible = false;\r\n    };\r\n    return ValueContainer;\r\n}(Phaser.GameObjects.Container));\r\nvar IconText = /** @class */ (function (_super) {\r\n    __extends(IconText, _super);\r\n    function IconText(scene, key, frame, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        var icon = scene.make.image({\r\n            key: key,\r\n            frame: frame\r\n        }, false);\r\n        _this.mText = scene.make.text({\r\n            style: {\r\n                fontSize: 14 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        _this.mText.x = icon.width / 2 + 8 * dpr;\r\n        // this.mText.y = -icon.height / 2;\r\n        _this.mText.setStroke("#000000", 2 * dpr);\r\n        _this.add([icon, _this.mText]);\r\n        return _this;\r\n    }\r\n    IconText.prototype.setText = function (val) {\r\n        this.mText.setText(val);\r\n    };\r\n    IconText.prototype.setStroke = function (color, thickness) {\r\n        this.mText.setStroke(color, thickness);\r\n    };\r\n    IconText.prototype.setColor = function (color) {\r\n        this.mText.setColor(color);\r\n    };\r\n    return IconText;\r\n}(Phaser.GameObjects.Container));\r\nvar SceneName = /** @class */ (function (_super) {\r\n    __extends(SceneName, _super);\r\n    function SceneName(scene, key, leftFrame, rightFrame, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        var _this = _super.call(this, scene, key, leftFrame, dpr) || this;\r\n        _this.mDpr = dpr;\r\n        _this.mRightIcon = scene.make.image({\r\n            y: 2 * dpr,\r\n            key: key,\r\n            frame: rightFrame\r\n        }, false);\r\n        _this.add(_this.mRightIcon);\r\n        _this.mRightIcon.y = -1 * dpr;\r\n        return _this;\r\n    }\r\n    SceneName.prototype.setText = function (val) {\r\n        _super.prototype.setText.call(this, val);\r\n        this.mRightIcon.x = this.mText.x + this.mText.width + this.mRightIcon.width / 2 + 2 * this.mDpr;\r\n    };\r\n    return SceneName;\r\n}(IconText));\r\nvar ExpProgress = /** @class */ (function (_super) {\r\n    __extends(ExpProgress, _super);\r\n    function ExpProgress(scene, key, dpr, scale, world) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var width = world.getSize().width / scale;\r\n        var frame = _this.scene.textures.getFrame(key, "exp_bg");\r\n        _this.setSize(width, frame.height);\r\n        var progressW = _this.width;\r\n        var progressH = _this.height;\r\n        _this.mProgressBar = new ProgressBar(scene, dpr);\r\n        _this.mProgressBar.setSize(_this.width, _this.height);\r\n        var bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](_this.scene, progressW / 2, progressH / 2, progressW, progressH, key, "exp_bg", {\r\n            left: 8 * dpr,\r\n            top: 3 * dpr,\r\n            right: frame.width - 2 - 8 * dpr,\r\n            bottom: frame.height - 1 - 3 * dpr\r\n        });\r\n        _this.mProgressBar.setBackground(bg);\r\n        frame = _this.scene.textures.getFrame(key, "exp_progress");\r\n        var progres = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](_this.scene, progressW / 2, progressH / 2, width, frame.height, key, "exp_progress", {\r\n            left: 8 * dpr,\r\n            top: 3 * dpr,\r\n            right: frame.width - 2 - 10 * dpr,\r\n            bottom: frame.height - 1 - 5 * dpr\r\n        });\r\n        _this.mProgressBar.setProgress(progres, _this.x, _this.y, scale);\r\n        _this.mProgressBar.setRatio(0.5);\r\n        _this.mCurrentLv = scene.make.text({\r\n            text: "Lv. 57",\r\n            style: {\r\n                fontSize: 10 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false);\r\n        _this.mCurrentLv.setStroke("#000000", 1 * dpr);\r\n        _this.mNextLv = scene.make.text({\r\n            text: "Lv. 58",\r\n            style: {\r\n                fontSize: 10 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0);\r\n        _this.mNextLv.setStroke("#000000", 1 * dpr);\r\n        _this.mNextLv.x = _this.width - _this.mNextLv.width;\r\n        _this.add([_this.mProgressBar, _this.mCurrentLv, _this.mNextLv]);\r\n        return _this;\r\n    }\r\n    ExpProgress.prototype.setLv = function (val, ratio) {\r\n        this.mCurrentLv.setText(val.toString());\r\n        this.mNextLv.setText((val + 1).toString());\r\n        this.mNextLv.x = this.width - this.mNextLv.width;\r\n        this.mProgressBar.setRatio(ratio);\r\n    };\r\n    return ExpProgress;\r\n}(Phaser.GameObjects.Container));\r\nvar ProgressValue = /** @class */ (function (_super) {\r\n    __extends(ProgressValue, _super);\r\n    function ProgressValue(scene, key, leftIcon, dpr) {\r\n        return _super.call(this, scene, key, leftIcon, dpr) || this;\r\n    }\r\n    ProgressValue.prototype.setProgress = function (progres, scale) {\r\n        this.mProgress.setProgress(progres, this.x + this.mProgress.x, this.y + this.mProgress.y, scale);\r\n    };\r\n    ProgressValue.prototype.setValue = function (val, maxValue) {\r\n        if (this.mText) {\r\n            this.mText.text = val.toString();\r\n            this.mProgress.setRatio(val / maxValue);\r\n        }\r\n    };\r\n    ProgressValue.prototype.setInteractive = function (shape) {\r\n        shape = shape || new Phaser.Geom.Rectangle(0, 0, this.width, this.height);\r\n        _super.prototype.setInteractive.call(this, shape, Phaser.Geom.Rectangle.Contains);\r\n        return this;\r\n    };\r\n    ProgressValue.prototype.init = function (key, leftIcon, dpr) {\r\n        var bg = this.scene.make.image({\r\n            key: key,\r\n            frame: "strength_bg"\r\n        }, false);\r\n        this.setSize(bg.width, bg.height);\r\n        var left = this.scene.make.image({\r\n            key: key,\r\n            frame: leftIcon,\r\n        }, false);\r\n        this.mProgress = new ProgressBar(this.scene, dpr);\r\n        this.mProgress.x = -this.width / 2 + 10 * dpr;\r\n        this.mProgress.y = 4 * dpr;\r\n        this.mText = this.scene.make.text({\r\n            text: "0",\r\n            width: bg.width,\r\n            height: bg.height,\r\n            style: {\r\n                fontSize: 10 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mText.setStroke("#000000", 1 * dpr);\r\n        this.mAddBtn = this.scene.make.image({\r\n            key: key,\r\n            frame: "add_btn"\r\n        });\r\n        this.setSize(bg.width, bg.height);\r\n        left.x = -this.width * this.originX + 10 * dpr;\r\n        this.mAddBtn.x = this.width * this.originX - 10 * dpr;\r\n        this.mAddBtn.y = 6 * dpr;\r\n        // this.mText.x = this.width / 2\r\n        this.mText.y = (this.height - this.mText.height) / 2;\r\n        this.add([bg, this.mProgress, left, this.mText, this.mAddBtn]);\r\n        this.mAddBtn.visible = false;\r\n    };\r\n    return ProgressValue;\r\n}(ValueContainer));\r\nvar ProgressBar = /** @class */ (function (_super) {\r\n    __extends(ProgressBar, _super);\r\n    function ProgressBar(scene, dpr) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.offsetX = 0;\r\n        _this.offsetY = 0;\r\n        _this.dpr = dpr;\r\n        return _this;\r\n    }\r\n    ProgressBar.prototype.setBackground = function (bg) {\r\n        this.addAt(bg, 0);\r\n    };\r\n    ProgressBar.prototype.setProgress = function (progress, offsetX, offsetY, scale) {\r\n        this.offsetX = offsetX;\r\n        this.offsetY = offsetY;\r\n        this.mScale = scale;\r\n        this.mProgress = progress;\r\n        this.setSize(progress.width * this.mScale, progress.height * this.mScale);\r\n        this.mMaskGraphics = this.scene.make.graphics(undefined, false);\r\n        this.mMaskGraphics.fillStyle(0xFF9900);\r\n        this.mMaskGraphics.fillRoundedRect(0, progress.y * this.mScale - progress.height * this.mScale / 2, this.width, progress.height, 10);\r\n        this.add(this.mProgress);\r\n        this.mProgress.mask = new Phaser.Display.Masks.GeometryMask(this.scene, this.mMaskGraphics);\r\n        this.mMaskGraphics.x = offsetX * scale;\r\n        this.mMaskGraphics.y = offsetY * scale;\r\n    };\r\n    ProgressBar.prototype.setRatio = function (ratio) {\r\n        if (!this.mMaskGraphics) {\r\n            return;\r\n        }\r\n        this.mMaskGraphics.x = ((this.width * ratio) - this.width + this.offsetX);\r\n        // setInterval(() => {\r\n        //     this.mMaskGraphics.x += 1 * this.dpr;\r\n        // }, 100);\r\n    };\r\n    return ProgressBar;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaMainUI/PicaMainUIPanel.ts?')},"./src/ui/PicaMessageBox/PicaMessageBoxMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaMessageBoxMediator", function() { return PicaMessageBoxMediator; });\n/* harmony import */ var _PicaMessageBoxPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PicaMessageBoxPanel */ "./src/ui/PicaMessageBox/PicaMessageBoxPanel.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar PicaMessageBoxMediator = /** @class */ (function (_super) {\r\n    __extends(PicaMessageBoxMediator, _super);\r\n    function PicaMessageBoxMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicaMessageBoxMediator.prototype.show = function (params) {\r\n        this.mParam = params;\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicaMessageBoxPanel__WEBPACK_IMPORTED_MODULE_0__["PicaMessageBoxPanel"](this.scene, this.world);\r\n            this.mView.on("click", this.onClickHandler, this);\r\n        }\r\n        this.mView.show(params);\r\n        this.layerManager.addToDialogLayer(this.mView);\r\n    };\r\n    PicaMessageBoxMediator.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaMessageBoxMediator.prototype.onClickHandler = function (data) {\r\n        if (data.local) {\r\n            if (data.clickhandler)\r\n                data.clickhandler.run();\r\n            this.hide();\r\n        }\r\n        else {\r\n            var param = this.mParam[0];\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n            var content = pkt.content;\r\n            content.uiId = param.id;\r\n            content.componentId = data.node.id;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    return PicaMessageBoxMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaMessageBox/PicaMessageBoxMediator.ts?')},"./src/ui/PicaMessageBox/PicaMessageBoxPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaMessageBoxPanel", function() { return PicaMessageBoxPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar PicaMessageBoxPanel = /** @class */ (function (_super) {\r\n    __extends(PicaMessageBoxPanel, _super);\r\n    function PicaMessageBoxPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pica_message_box";\r\n        return _this;\r\n        // this.disInteractive();\r\n    }\r\n    PicaMessageBoxPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        var data = param[0];\r\n        this.mButtons = [];\r\n        if (data) {\r\n            if (data.text && data.text[0]) {\r\n                this.mText.setText(data.text[0].text);\r\n                this.mText.x = -this.mText.width / 2;\r\n                this.mText.y = -this.mText.height;\r\n            }\r\n            if (data.title) {\r\n                this.mTitleLabel.setText(data.title.text);\r\n            }\r\n        }\r\n        var buttons = data.button;\r\n        if (buttons) {\r\n            var btnWid = 114 * this.dpr;\r\n            var btnHei = 40 * this.dpr;\r\n            var w = (this.width - 42 * this.dpr) / buttons.length;\r\n            // const mButtonsContainer = this.mScene.make.container(undefined, false);\r\n            this.mButtonContaier.y = this.height / 2 - btnHei;\r\n            var frame = this.scene.textures.getFrame(this.key, "yellow_btn_normal");\r\n            if (!frame) {\r\n                return;\r\n            }\r\n            var config = {\r\n                left: 13 * this.dpr,\r\n                top: 13 * this.dpr,\r\n                bottom: frame.width - 2 - 13 * this.dpr,\r\n                right: frame.height - 2 - 13 * this.dpr\r\n            };\r\n            var totalW = 0;\r\n            for (var i = 0; i < buttons.length; i++) {\r\n                var txt = buttons[i] ? buttons[i].text : "";\r\n                var btn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.mScene, 0, 0, btnWid, btnHei, this.key, i === 0 ? "yellow_btn" : "red_btn", buttons[i].text, config, buttons[i]);\r\n                btn.setTextStyle({\r\n                    fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                    fontSize: 16 * this.dpr\r\n                });\r\n                btn.x = i * w + btnWid / 2;\r\n                totalW += i * w + btnWid / 2;\r\n                this.mButtons.push(btn);\r\n                btn.on("click", this.onClickHandler, this);\r\n            }\r\n            this.mButtonContaier.add(this.mButtons);\r\n            // btnSp.setSize((buttons.length - 1) * w + btnWid, btnHei);\r\n            this.mButtonContaier.x = -totalW / 2;\r\n        }\r\n        this.resize(0, 0);\r\n    };\r\n    PicaMessageBoxPanel.prototype.resize = function (w, h) {\r\n        var width = this.scene.cameras.main.width;\r\n        var height = this.scene.cameras.main.height;\r\n        this.x = width / 2;\r\n        this.y = height / 2;\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    PicaMessageBoxPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "pica_message_box/pica_message_box.png", "pica_message_box/pica_message_box.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaMessageBoxPanel.prototype.init = function () {\r\n        var _a = this.scene.cameras.main, width = _a.width, height = _a.height;\r\n        var border = this.scene.make.graphics(undefined, false);\r\n        border.fillStyle(0, 0.6);\r\n        border.fillRect(-width * 0.5, -height * 0.5, width, height);\r\n        border.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        this.add(border);\r\n        var frame = this.scene.textures.getFrame(this.key, "bg");\r\n        var background = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 0, 0, 286 * this.dpr, frame.height, this.key, "bg", {\r\n            left: 22 * this.dpr,\r\n            top: frame.height,\r\n            right: 22 * this.dpr,\r\n            bottom: 0\r\n        });\r\n        this.setSize(background.width, background.height);\r\n        this.mButtonContaier = this.scene.make.container(undefined, false);\r\n        var title = this.scene.make.image({\r\n            y: -background.height / 2,\r\n            key: this.key,\r\n            frame: "title"\r\n        });\r\n        this.mTitleLabel = this.scene.make.text({\r\n            y: title.y - 6 * this.dpr,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                fontSize: 16 * this.dpr,\r\n                color: "#3366cc"\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mText = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_4__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: 14 * this.dpr + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n            color: "#000000",\r\n            origin: { x: 0.5, y: 0.5 },\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.width\r\n            },\r\n            align: "center"\r\n        });\r\n        // this.mText.x = -this.mWidth / 2 + 10;\r\n        // this.mText.y = -this.mHeight / 2 + 10;\r\n        this.add([background, title, this.mTitleLabel, this.mText, this.mButtonContaier]);\r\n        _super.prototype.init.call(this);\r\n        this.resize(width, height);\r\n        this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    PicaMessageBoxPanel.prototype.onClickHandler = function (pointer, gameobject) {\r\n        if (!gameobject) {\r\n            return;\r\n        }\r\n        var btn = gameobject.getBtnData();\r\n        if (!btn) {\r\n            return;\r\n        }\r\n        this.emit("click", btn);\r\n    };\r\n    return PicaMessageBoxPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaMessageBox/PicaMessageBoxPanel.ts?')},"./src/ui/PicaNavigate/PicaNavigate.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaNavigate", function() { return PicaNavigate; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicaNavigate = /** @class */ (function (_super) {\r\n    __extends(PicaNavigate, _super);\r\n    function PicaNavigate($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    PicaNavigate.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n        }\r\n    };\r\n    PicaNavigate.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    PicaNavigate.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    PicaNavigate.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    PicaNavigate.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    PicaNavigate.prototype.queryGOHomeHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_GO_HOME);\r\n        this.connection.send(packet);\r\n    };\r\n    Object.defineProperty(PicaNavigate.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return PicaNavigate;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaNavigate/PicaNavigate.ts?')},"./src/ui/PicaNavigate/PicaNavigateMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaNavigateMediator", function() { return PicaNavigateMediator; });\n/* harmony import */ var _PicaNavigatePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PicaNavigatePanel */ "./src/ui/PicaNavigate/PicaNavigatePanel.ts");\n/* harmony import */ var _PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../PicaChat/PicaChatMediator */ "./src/ui/PicaChat/PicaChatMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicaNavigate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PicaNavigate */ "./src/ui/PicaNavigate/PicaNavigate.ts");\n/* harmony import */ var _PicHandheld_PicHandheldMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../PicHandheld/PicHandheldMediator */ "./src/ui/PicHandheld/PicHandheldMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar PicaNavigateMediator = /** @class */ (function (_super) {\r\n    __extends(PicaNavigateMediator, _super);\r\n    function PicaNavigateMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicaNavigateMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.mView.show();\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _PicaNavigatePanel__WEBPACK_IMPORTED_MODULE_0__["PicaNavigatePanel"](this.scene, this.world);\r\n            this.mView.on("showPanel", this.onShowPanelHandler, this);\r\n            this.mView.on("close", this.onCloseHandler, this);\r\n            this.mView.on("goHome", this.onGomeHomeHandler, this);\r\n        }\r\n        if (!this.picaNa) {\r\n            this.picaNa = new _PicaNavigate__WEBPACK_IMPORTED_MODULE_3__["PicaNavigate"](this.world);\r\n        }\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicaNavigateMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    PicaNavigateMediator.prototype.destroy = function () {\r\n        if (this.picaNa) {\r\n            this.picaNa.destroy();\r\n            this.picaNa = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaNavigateMediator.prototype.onCloseHandler = function () {\r\n        if (!this.world) {\r\n            return;\r\n        }\r\n        var uiManager = this.world.uiManager;\r\n        uiManager.showExistMed(_PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_1__["PicaChatMediator"].name, "");\r\n        uiManager.showExistMed(_PicHandheld_PicHandheldMediator__WEBPACK_IMPORTED_MODULE_4__["PicHandheldMediator"].name, "");\r\n        this.destroy();\r\n    };\r\n    PicaNavigateMediator.prototype.onShowPanelHandler = function (panel, data) {\r\n        if (!panel || !this.world) {\r\n            return;\r\n        }\r\n        var uiManager = this.world.uiManager;\r\n        if (data)\r\n            uiManager.showMed(panel, data);\r\n        else\r\n            uiManager.showMed(panel);\r\n    };\r\n    PicaNavigateMediator.prototype.onGomeHomeHandler = function () {\r\n        this.picaNa.queryGOHomeHandler();\r\n    };\r\n    PicaNavigateMediator.NAME = "PicaNavigateMediator";\r\n    return PicaNavigateMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaNavigate/PicaNavigateMediator.ts?')},"./src/ui/PicaNavigate/PicaNavigatePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaNavigatePanel", function() { return PicaNavigatePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar PicaNavigatePanel = /** @class */ (function (_super) {\r\n    __extends(PicaNavigatePanel, _super);\r\n    function PicaNavigatePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pica_navigate";\r\n        _this.setTween(false);\r\n        _this.setInteractive();\r\n        return _this;\r\n    }\r\n    PicaNavigatePanel.prototype.resize = function (w, h) {\r\n        this.setSize(w, h);\r\n        var zoom = this.scale;\r\n        var width = this.scene.cameras.main.width / zoom;\r\n        var height = this.scene.cameras.main.height;\r\n        var frame = this.scene.textures.getFrame(this.key, "bg");\r\n        var scaleRatio = width / frame.width * this.dpr;\r\n        this.mBackground.scaleX = scaleRatio;\r\n        this.mBackground.x = width / 2;\r\n        this.mBackground.setInteractive();\r\n        this.mCloseBtn.x = width - this.mCloseBtn.width / 2 - 3 * this.dpr;\r\n        this.y = height - this.height / 2;\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    PicaNavigatePanel.prototype.addListen = function () {\r\n        if (!this.mInitialized || !this.interactiveBoo)\r\n            return;\r\n        this.mMapBtn.on("pointerup", this.onShowMapHandler, this);\r\n        this.mShopBtn.on("pointerup", this.onShowShopHandler, this);\r\n        this.mBagBtn.on("pointerup", this.onShowBagHandler, this);\r\n        this.mFamilyBtn.on("pointerup", this.onShowFamilyHandler, this);\r\n        this.mGoHomeBtn.on("pointerup", this.onShowGoHomeHandler, this);\r\n        this.mTestBtn.on("pointerup", this.onShowTestHandler, this);\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n    };\r\n    PicaNavigatePanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mMapBtn.off("pointerup", this.onShowMapHandler, this);\r\n        this.mShopBtn.off("pointerup", this.onShowShopHandler, this);\r\n        this.mBagBtn.off("pointerup", this.onShowBagHandler, this);\r\n        this.mFamilyBtn.off("pointerup", this.onShowFamilyHandler, this);\r\n        this.mGoHomeBtn.on("pointerup", this.onShowGoHomeHandler, this);\r\n        this.mTestBtn.on("pointerup", this.onShowTestHandler, this);\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n    };\r\n    PicaNavigatePanel.prototype.hide = function () {\r\n        this.mShow = false;\r\n    };\r\n    PicaNavigatePanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.checkUpdateActive();\r\n    };\r\n    PicaNavigatePanel.prototype.updateUIState = function (active) {\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        if (active.name === "picanavigate.mapbtn") {\r\n            this.mMapBtn.visible = active.visible;\r\n            if (!active.disabled)\r\n                this.mMapBtn.setInteractive();\r\n            else\r\n                this.mMapBtn.removeInteractive();\r\n        }\r\n        if (active.name === "picanavigate.marketbtn") {\r\n            this.mShopBtn.visible = active.visible;\r\n            if (!active.disabled)\r\n                this.mShopBtn.setInteractive();\r\n            else\r\n                this.mShopBtn.removeInteractive();\r\n        }\r\n        if (active.name === "picanavigate.bagbtn") {\r\n            this.mBagBtn.visible = active.visible;\r\n            if (!active.disabled)\r\n                this.mBagBtn.setInteractive();\r\n            else\r\n                this.mBagBtn.removeInteractive();\r\n        }\r\n        if (active.name === "picanavigate.gohomebtn") {\r\n            this.mGoHomeBtn.visible = active.visible;\r\n            if (!active.disabled)\r\n                this.mGoHomeBtn.setInteractive();\r\n            else\r\n                this.mGoHomeBtn.removeInteractive();\r\n        }\r\n    };\r\n    PicaNavigatePanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "pica_navigate/pica_navigate.png", "pica_navigate/pica_navigate.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaNavigatePanel.prototype.init = function () {\r\n        this.mBackground = this.createImage(this.key, "bg");\r\n        this.mBackground.texture.setFilter(Phaser.Textures.FilterMode.NEAREST);\r\n        this.mMapBtn = this.createImage(this.key, "map_btn").setInteractive();\r\n        this.mShopBtn = this.createImage(this.key, "shop_btn").setInteractive();\r\n        this.mBagBtn = this.createImage(this.key, "bag_btn").setInteractive();\r\n        this.mFamilyBtn = this.createImage(this.key, "family_btn").setInteractive();\r\n        this.mGoHomeBtn = this.createImage(this.key, "home_btn").setInteractive();\r\n        this.mTestBtn = this.createImage(this.key, "family_btn").setInteractive();\r\n        this.mCloseBtn = this.createImage(this.key, "close_btn").setInteractive();\r\n        var list = [this.mMapBtn, this.mMapBtn, this.mShopBtn, this.mBagBtn, this.mGoHomeBtn, this.mTestBtn];\r\n        this.add([this.mBackground]);\r\n        this.add(list);\r\n        this.add(this.mCloseBtn);\r\n        for (var i = 0; i < list.length; i++) {\r\n            list[i].x = i * 50 * this.dpr - list[i].width / 2;\r\n        }\r\n        var zoom = this.scale;\r\n        this.resize(this.mBackground.width * zoom, this.mBackground.height * zoom);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    PicaNavigatePanel.prototype.createImage = function (key, frame) {\r\n        return this.scene.make.image({\r\n            key: key,\r\n            frame: frame\r\n        }, false);\r\n    };\r\n    PicaNavigatePanel.prototype.onShowMapHandler = function () {\r\n        this.emit("showPanel", "PicaRoomList");\r\n    };\r\n    PicaNavigatePanel.prototype.onShowShopHandler = function () {\r\n        this.emit("showPanel", "Market");\r\n    };\r\n    PicaNavigatePanel.prototype.onShowBagHandler = function () {\r\n        this.emit("showPanel", "FurniBag");\r\n    };\r\n    PicaNavigatePanel.prototype.onShowFamilyHandler = function () {\r\n        this.emit("showPanel", "CharacterInfo");\r\n    };\r\n    PicaNavigatePanel.prototype.onShowGoHomeHandler = function () {\r\n        this.emit("goHome");\r\n    };\r\n    PicaNavigatePanel.prototype.onShowTestHandler = function () {\r\n        this.emit("showPanel", "PicPropFun");\r\n    };\r\n    PicaNavigatePanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n    };\r\n    PicaNavigatePanel.prototype.checkUpdateActive = function () {\r\n        var arr = this.mWorld.uiManager.getActiveUIData("PicHandheld");\r\n        if (arr) {\r\n            for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n                var data = arr_1[_i];\r\n                this.updateUIState(data);\r\n            }\r\n        }\r\n    };\r\n    return PicaNavigatePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaNavigate/PicaNavigatePanel.ts?')},"./src/ui/PicaNotice/PicaNoticeMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaNoticeMediator", function() { return PicaNoticeMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _PicaNoticePanel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PicaNoticePanel */ "./src/ui/PicaNotice/PicaNoticePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar PicaNoticeMediator = /** @class */ (function (_super) {\r\n    __extends(PicaNoticeMediator, _super);\r\n    function PicaNoticeMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.scene = scene;\r\n        _this.panelQueue = [];\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    PicaNoticeMediator.prototype.show = function (param) {\r\n        var view = new _PicaNoticePanel__WEBPACK_IMPORTED_MODULE_1__["PicaNoticePanel"](this.scene, this.world);\r\n        view.once("close", this.onCloseHandler, this);\r\n        if (this.mView) {\r\n            var obj = { param: param, view: view };\r\n            this.panelQueue.push(obj);\r\n        }\r\n        else {\r\n            this.mView = view;\r\n            this.mView.show(param);\r\n        }\r\n        // this.layerManager.addToToolTipsLayer(this.mView.view);\r\n    };\r\n    PicaNoticeMediator.prototype.onCloseHandler = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = undefined;\r\n        }\r\n        if (this.panelQueue.length > 0) {\r\n            var obj = this.panelQueue.shift();\r\n            obj.view.show(obj.param);\r\n        }\r\n    };\r\n    return PicaNoticeMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaNotice/PicaNoticeMediator.ts?')},"./src/ui/PicaNotice/PicaNoticePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaNoticePanel", function() { return PicaNoticePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar PicaNoticePanel = /** @class */ (function (_super) {\r\n    __extends(PicaNoticePanel, _super);\r\n    function PicaNoticePanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    PicaNoticePanel.prototype.show = function (param) {\r\n        var _this = this;\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (param && param.length > 0) {\r\n            var text = param[0].text;\r\n            if (this.mContent) {\r\n                this.mContent.setText(text[0].text);\r\n            }\r\n            var width = this.scene.cameras.main.width;\r\n            // this.view.alpha = 0;\r\n            this.scene.tweens.timeline({\r\n                targets: this,\r\n                duration: 500,\r\n                tweens: [{\r\n                        y: "-=" + 20 * this.dpr,\r\n                        ease: "Bounce.easeOut",\r\n                    }, {\r\n                        delay: 2000,\r\n                        y: "-=" + 20 * this.dpr,\r\n                        ease: "Linear",\r\n                        alpha: 0\r\n                    }],\r\n                onComplete: function () {\r\n                    _this.emit("close");\r\n                }\r\n            });\r\n        }\r\n    };\r\n    PicaNoticePanel.prototype.resize = function () {\r\n        this.x = this.scene.cameras.main.width / 2;\r\n        this.y = 170 * this.dpr;\r\n    };\r\n    PicaNoticePanel.prototype.preload = function () {\r\n        this.addImage("pica_notice_bg", "pica_notice/bg.png");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaNoticePanel.prototype.init = function () {\r\n        var bg = this.scene.make.image({\r\n            key: "pica_notice_bg"\r\n        }, false);\r\n        this.mContent = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_1__["default"](this.mScene, 0, 0, "", {\r\n            fontSize: 16 * this.dpr + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n            stroke: "#000000",\r\n            strokeThickness: 1 * this.dpr,\r\n            align: "center",\r\n            textMask: false,\r\n            shadow: {\r\n                offsetX: 0,\r\n                offsetY: 0,\r\n                color: "#000",\r\n                blur: 4,\r\n                stroke: true,\r\n                fill: true\r\n            },\r\n            wrap: {\r\n                mode: "char",\r\n                width: bg.width * this.scale - 12 * this.dpr\r\n            }\r\n        }).setOrigin(0.5, 0.5);\r\n        this.mContent.setFontStyle("bold");\r\n        this.add([bg, this.mContent]);\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        _super.prototype.init.call(this);\r\n        this.resize();\r\n    };\r\n    return PicaNoticePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaNotice/PicaNoticePanel.ts?')},"./src/ui/PicaRoomList/PicaRoomListMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaRoomListMediator", function() { return PicaRoomListMediator; });\n/* harmony import */ var _PicaRoomListPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PicaRoomListPanel */ "./src/ui/PicaRoomList/PicaRoomListPanel.ts");\n/* harmony import */ var _RoomList__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RoomList */ "./src/ui/PicaRoomList/RoomList.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar PicaRoomListMediator = /** @class */ (function (_super) {\r\n    __extends(PicaRoomListMediator, _super);\r\n    function PicaRoomListMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layerManager = layerManager;\r\n        _this.world = worldService;\r\n        _this.scene = _this.layerManager.scene;\r\n        return _this;\r\n    }\r\n    PicaRoomListMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            this.layerManager.addToUILayer(this.mView);\r\n            return;\r\n        }\r\n        this.roomList = new _RoomList__WEBPACK_IMPORTED_MODULE_1__["RoomList"](this.world);\r\n        this.roomList.register();\r\n        this.roomList.on("myRoomList", this.updateMyRoomListHandler, this);\r\n        this.roomList.on("roomList", this.updateRoomListHandler, this);\r\n        this.roomList.on("enterRoomResult", this.onEnterRoomResuleHandler, this);\r\n        if (!this.mView) {\r\n            this.mView = new _PicaRoomListPanel__WEBPACK_IMPORTED_MODULE_0__["PicaRoomListPanel"](this.scene, this.world);\r\n        }\r\n        this.mView.on("close", this.onCloseHandler, this);\r\n        this.mView.on("getRoomList", this.onGetRoomListHandler, this);\r\n        this.mView.on("getMyRoomList", this.onGetMyRoomListHandler, this);\r\n        this.mView.on("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mView.show();\r\n        this.layerManager.addToUILayer(this.mView);\r\n    };\r\n    PicaRoomListMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    PicaRoomListMediator.prototype.destroy = function () {\r\n        if (this.roomList) {\r\n            this.roomList.destroy();\r\n        }\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = undefined;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaRoomListMediator.prototype.onCloseHandler = function () {\r\n        this.destroy();\r\n    };\r\n    PicaRoomListMediator.prototype.updateRoomListHandler = function (content) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.updateRoomList(content);\r\n    };\r\n    PicaRoomListMediator.prototype.updateMyRoomListHandler = function (content) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.updateMyRoomList(content);\r\n    };\r\n    PicaRoomListMediator.prototype.onEnterRoomResuleHandler = function (content) {\r\n        _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("enter room result:", content);\r\n    };\r\n    PicaRoomListMediator.prototype.onGetRoomListHandler = function () {\r\n        if (!this.roomList) {\r\n            return;\r\n        }\r\n        this.roomList.sendGetRoomList();\r\n    };\r\n    PicaRoomListMediator.prototype.onGetMyRoomListHandler = function () {\r\n        if (!this.roomList) {\r\n            return;\r\n        }\r\n        this.roomList.sendMyHistory();\r\n    };\r\n    PicaRoomListMediator.prototype.onEnterRoomHandler = function (roomID, passworld) {\r\n        if (!this.roomList) {\r\n            return;\r\n        }\r\n        this.roomList.sendEnterRoom(roomID, passworld);\r\n        // this.onCloseHandler();\r\n    };\r\n    return PicaRoomListMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaRoomList/PicaRoomListMediator.ts?')},"./src/ui/PicaRoomList/PicaRoomListPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PicaRoomListPanel", function() { return PicaRoomListPanel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomDelegate", function() { return RoomDelegate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomZoon", function() { return RoomZoon; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_checkbox_group__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/checkbox.group */ "./src/ui/components/checkbox.group.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _lib_rexui_lib_ui_scroller_Scroller__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/Scroller */ "./lib/rexui/lib/ui/scroller/Scroller.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/tab/TabButton */ "./lib/rexui/lib/ui/tab/TabButton.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar PicaRoomListPanel = /** @class */ (function (_super) {\r\n    __extends(PicaRoomListPanel, _super);\r\n    function PicaRoomListPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pica_roomlist";\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    PicaRoomListPanel.prototype.resize = function (w, h) {\r\n        var scale = this.scale;\r\n        var width = this.scene.cameras.main.width / scale;\r\n        var height = this.scene.cameras.main.height / scale;\r\n        this.x = width / 2;\r\n        this.y = height / 2;\r\n        this.mBackGround.clear();\r\n        this.mBackGround.fillStyle(0x6AE2FF, 0);\r\n        this.mBackGround.fillRect(-this.x, -this.y, width, height);\r\n        this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(-width * 0.5, -height * 0.5, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        _super.prototype.resize.call(this, w, h);\r\n    };\r\n    PicaRoomListPanel.prototype.updateRoomList = function (content) {\r\n        if (!content) {\r\n            return;\r\n        }\r\n        this.mRoomDele.updateList(content);\r\n    };\r\n    PicaRoomListPanel.prototype.updateMyRoomList = function (content) {\r\n        if (!content) {\r\n            return;\r\n        }\r\n        this.mMyRoomDele.updateList(content);\r\n    };\r\n    PicaRoomListPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mCloseBtn.on("pointerup", this.onCloseHandler, this);\r\n        this.mSeachBtn.on("pointerup", this.onSeachHandler, this);\r\n    };\r\n    PicaRoomListPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mCloseBtn.off("pointerup", this.onCloseHandler, this);\r\n        this.mSeachBtn.off("pointerup", this.onSeachHandler, this);\r\n    };\r\n    PicaRoomListPanel.prototype.destroy = function () {\r\n        if (this.mScroller)\r\n            this.mScroller.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PicaRoomListPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "pica_roomlist/pica_roomlist.png", "pica_roomlist/pica_roomlist.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    PicaRoomListPanel.prototype.init = function () {\r\n        var _this = this;\r\n        var zoom = this.mWorld.uiScale;\r\n        var background = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg.png"\r\n        }, false).setInteractive();\r\n        var wid = this.scene.cameras.main.width;\r\n        var hei = this.scene.cameras.main.height;\r\n        this.setSize(background.width, background.height);\r\n        this.mBackGround = this.scene.make.graphics(undefined, false);\r\n        // this.mBackGround.clear();\r\n        // this.mBackGround.fillStyle(0x6AE2FF, 0);\r\n        // this.mBackGround.fillRect(0, 0, wid * zoom, hei * zoom);\r\n        // this.mBackGround.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.scene.cameras.main.width, this.scene.cameras.main.height), Phaser.Geom.Rectangle.Contains);\r\n        this.mCloseBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "close_btn.png"\r\n        }, false).setInteractive();\r\n        this.mCloseBtn.x = this.width / 2 - this.mCloseBtn.width / 2 - 2 * this.dpr;\r\n        this.mCloseBtn.y = -this.height / 2 + this.mCloseBtn.height / 2;\r\n        this.mRoomDeleBtn = new _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_8__["TabButton"](this.scene, this.key, "checkbox_normal", "checkbox_down", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.visit"));\r\n        this.mRoomDeleBtn.x = -54 * this.dpr;\r\n        this.mRoomDeleBtn.y = -this.height / 2 + this.mRoomDeleBtn.displayHeight / 2 - 4 * this.dpr;\r\n        this.mRoomDeleBtn.setTextStyle({\r\n            color: "#3333cc",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            fontSize: 14 * this.dpr\r\n        });\r\n        this.mRoomDeleBtn.setFontStyle("bold");\r\n        this.mMyRoomDeleBtn = new _lib_rexui_lib_ui_tab_TabButton__WEBPACK_IMPORTED_MODULE_8__["TabButton"](this.scene, this.key, "checkbox_normal", "checkbox_down", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.my"));\r\n        this.mMyRoomDeleBtn.x = 54 * this.dpr;\r\n        this.mMyRoomDeleBtn.y = this.mRoomDeleBtn.y;\r\n        this.mMyRoomDeleBtn.setTextStyle({\r\n            color: "#3333cc",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            fontSize: 16 * this.dpr\r\n        });\r\n        this.mMyRoomDeleBtn.setFontStyle("bold");\r\n        var checkbox = new _components_checkbox_group__WEBPACK_IMPORTED_MODULE_2__["CheckboxGroup"]();\r\n        checkbox.appendItemAll([this.mRoomDeleBtn, this.mMyRoomDeleBtn]);\r\n        checkbox.on("selected", this.onSelectedHandler, this);\r\n        this.mRoomContainer = this.scene.make.container(undefined, false);\r\n        this.mRoomContainer.setSize(272 * this.dpr, 362 * this.dpr);\r\n        this.mRoomContainer.y = -this.height / 2 + 11 * this.dpr * zoom;\r\n        this.mSeachBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "seach_btn.png"\r\n        }, false).setInteractive();\r\n        this.mSeachBtn.y = this.height / 2 - this.mSeachBtn.height / 2 + 12 * this.dpr;\r\n        var seachText = this.scene.make.text({\r\n            x: -35 * this.dpr,\r\n            y: this.mSeachBtn.y,\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.seach"),\r\n            style: {\r\n                color: "#996600",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * this.dpr\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        var roomText = this.scene.make.text({\r\n            x: 35 * this.dpr,\r\n            y: this.mSeachBtn.y,\r\n            text: _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.room"),\r\n            style: {\r\n                color: "#996600",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * this.dpr\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.add([this.mBackGround, background, this.mRoomContainer, this.mCloseBtn, this.mSeachBtn, seachText, roomText]);\r\n        _super.prototype.init.call(this);\r\n        this.resize(0, 0);\r\n        var w = this.mRoomContainer.width * this.scale;\r\n        var h = this.mRoomContainer.height * this.scale;\r\n        var config = {\r\n            x: this.x - w / 2,\r\n            y: this.y - h / 2 - 20 * this.dpr * this.scale,\r\n            clickX: 0,\r\n            clickY: 0,\r\n            width: w,\r\n            height: h,\r\n            boundPad0: -25 * this.dpr * zoom,\r\n            // bounds: [\r\n            //   this.y,\r\n            //   this.y - h - 100 * this.dpr + (350 * this.dpr / 2)\r\n            // ],\r\n            value: this.y,\r\n            valuechangeCallback: function (newValue) {\r\n                _this.mRoomContainer.y = newValue - _this.y - h / 2;\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log(_this.mRoomContainer.y + "," + _this.y);\r\n            },\r\n            cellupCallBack: function (gameobject) {\r\n                gameobject.onEnterRoomHandler();\r\n                _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log(gameobject.roomData().name);\r\n            }\r\n        };\r\n        this.mScroller = new _lib_rexui_lib_ui_scroller_Scroller__WEBPACK_IMPORTED_MODULE_5__["BaseScroller"](this.scene, this.mRoomContainer, config);\r\n        this.add([this.mRoomDeleBtn, this.mMyRoomDeleBtn, this.mCloseBtn]);\r\n        checkbox.selectIndex(0);\r\n    };\r\n    PicaRoomListPanel.prototype.showRoomList = function () {\r\n        if (this.mMyRoomDele) {\r\n            this.mMyRoomDele.removeFromContainer();\r\n            this.mMyRoomDele.off("enterRoom", this.onEnterRoomHandler, this);\r\n        }\r\n        if (!this.mRoomDele)\r\n            this.mRoomDele = new RoomDelegate(this.mRoomContainer, this.mScroller, this.scene, this.mWorld, this.key, this.dpr);\r\n        this.mRoomDele.on("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mRoomDele.addToContainer();\r\n        this.emit("getRoomList");\r\n    };\r\n    PicaRoomListPanel.prototype.showMyRoomList = function () {\r\n        if (this.mRoomDele) {\r\n            this.mRoomDele.removeFromContainer();\r\n            this.mRoomDele.off("enterRoom", this.onEnterRoomHandler, this);\r\n        }\r\n        if (!this.mMyRoomDele)\r\n            this.mMyRoomDele = new MyRoomDelegate(this.mRoomContainer, this.mScroller, this.mWorld, this.scene, this.key, this.dpr);\r\n        this.mMyRoomDele.on("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mMyRoomDele.addToContainer();\r\n        this.emit("getMyRoomList");\r\n    };\r\n    PicaRoomListPanel.prototype.onEnterRoomHandler = function (room) {\r\n        this.emit("enterRoom", room);\r\n    };\r\n    PicaRoomListPanel.prototype.onSelectedHandler = function (gameobject, prevButton) {\r\n        if (!(gameobject instanceof _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_7__["Button"])) {\r\n            return;\r\n        }\r\n        this.mRoomContainer.removeAll(false);\r\n        switch (gameobject) {\r\n            case this.mRoomDeleBtn:\r\n                this.showRoomList();\r\n                break;\r\n            case this.mMyRoomDeleBtn:\r\n                this.showMyRoomList();\r\n                break;\r\n        }\r\n        (gameobject).setTextColor("#996600");\r\n        if (prevButton) {\r\n            if (prevButton instanceof _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_7__["Button"]) {\r\n                prevButton.setTextColor("#3333cc");\r\n            }\r\n        }\r\n    };\r\n    PicaRoomListPanel.prototype.onSeachHandler = function () {\r\n        // TODO seach\r\n    };\r\n    PicaRoomListPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close");\r\n    };\r\n    return PicaRoomListPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar RoomDelegate = /** @class */ (function (_super) {\r\n    __extends(RoomDelegate, _super);\r\n    function RoomDelegate(container, scroller, scene, world, key, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mChildPad = 0;\r\n        _this.mDpr = 1;\r\n        _this.mHeight = 0;\r\n        _this.mDpr = dpr;\r\n        _this.mWorld = world;\r\n        _this.mChildPad = 0;\r\n        _this.mScene = scene;\r\n        _this.mContainer = container;\r\n        _this.mScroller = scroller;\r\n        _this.mKey = key;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    RoomDelegate.prototype.addListen = function () {\r\n        this.mPopularityRoom.on("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mPlayerRoom.on("enterRoom", this.onEnterRoomHandler, this);\r\n    };\r\n    RoomDelegate.prototype.removeListen = function () {\r\n        this.mPopularityRoom.off("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mPlayerRoom.off("enterRoom", this.onEnterRoomHandler, this);\r\n    };\r\n    RoomDelegate.prototype.updateList = function (content) {\r\n        this.mContent = content;\r\n        this.mScroller.clearInteractiveObject();\r\n        this.mHeight = this.activity.height;\r\n        this.mChildPad = this.activity.height + 14 * this.mDpr * this.mWorld.uiScale;\r\n        if (!this.mContent) {\r\n            return;\r\n        }\r\n        this.mPopularityRoom.addItem(content.popularRooms, this.mChildPad);\r\n    };\r\n    RoomDelegate.prototype.addToContainer = function () {\r\n        this.addListen();\r\n        this.refreshPos();\r\n    };\r\n    RoomDelegate.prototype.removeFromContainer = function () {\r\n        this.removeListen();\r\n        if (this.mPopularityRoom)\r\n            this.mPopularityRoom.clear();\r\n        if (this.mPlayerRoom)\r\n            this.mPlayerRoom.clear();\r\n    };\r\n    RoomDelegate.prototype.destroy = function () {\r\n        this.removeListen();\r\n        if (this.mPlayerRoom)\r\n            this.mPopularityRoom.destroy();\r\n        if (this.mPopularityRoom)\r\n            this.mPopularityRoom.destroy();\r\n        if (this.mScroller)\r\n            this.mScroller.destroy();\r\n        if (this.activity)\r\n            this.activity.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RoomDelegate.prototype.init = function () {\r\n        var _this = this;\r\n        this.activity = this.mScene.make.image({\r\n            key: this.mKey,\r\n            frame: "activity_title.png"\r\n        }, false);\r\n        this.activity.y = this.activity.height / 2 + 2 * this.mDpr;\r\n        this.mChildPad += this.activity.height / 2 + 18 * this.mDpr;\r\n        this.mPopularityRoom = new PopularRoomZoon(this.mScene, this.mKey, "popularity_icon.png", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.popularity_room"), this.mDpr, this.mWorld.uiScale, 0, this.mChildPad, function (hei) {\r\n            if (_this.mPopularityRoom.roomList)\r\n                _this.setScrollInteractive(_this.mPopularityRoom.roomList);\r\n            _this.mHeight += hei;\r\n            _this.refreshPos();\r\n            _this.mChildPad += _this.mPopularityRoom.height;\r\n            _this.mPlayerRoom.addItem(_this.mContent.playerRooms, _this.mChildPad);\r\n        });\r\n        this.mPlayerRoom = new RoomZoon(this.mScene, this.mKey, "player_icon.png", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.player_room"), this.mDpr, this.mWorld.uiScale, 0, this.mChildPad, function (hei) {\r\n            if (_this.mPlayerRoom.roomList)\r\n                _this.setScrollInteractive(_this.mPlayerRoom.roomList);\r\n            _this.mHeight += hei;\r\n            _this.refreshPos();\r\n            _this.mScroller.refreshBound(_this.mHeight);\r\n            _this.mScroller.setValue(_this.mContainer.parentContainer.y);\r\n        });\r\n        this.mScroller.refreshBound(this.activity.height);\r\n        this.mScroller.setValue(this.mContainer.parentContainer.y);\r\n    };\r\n    RoomDelegate.prototype.refreshPos = function () {\r\n        if (this.activity) {\r\n            this.activity.setTexture(this.mKey, "activity_title.png");\r\n            this.mContainer.add(this.activity);\r\n        }\r\n        if (this.mPopularityRoom) {\r\n            if (this.mPopularityRoom.showList) {\r\n                this.mContainer.add(this.mPopularityRoom.showList);\r\n                if (this.mPopularityRoom.roomList) {\r\n                    this.mContainer.add(this.mPopularityRoom.roomList);\r\n                }\r\n            }\r\n        }\r\n        if (this.mPlayerRoom) {\r\n            if (this.mPlayerRoom.showList) {\r\n                this.mContainer.add(this.mPlayerRoom.showList);\r\n                if (this.mPlayerRoom.roomList) {\r\n                    this.mContainer.add(this.mPlayerRoom.roomList);\r\n                }\r\n            }\r\n        }\r\n        // const zoom: number = this.mWorld.uiScale;\r\n        // const baseHei: number = 362 * this.mDpr;\r\n        // let topY: number = this.mContainer.parentContainer.y;\r\n        // Logger.getInstance().log(this.mContainer.height);\r\n        // let bottomY: number = 0;\r\n        // if (this.mHeight > baseHei) {\r\n        //   topY = topY;\r\n        //   bottomY = topY - this.mHeight + baseHei - 25 * this.mDpr * zoom;\r\n        // } else {\r\n        //   topY = topY;\r\n        //   bottomY = topY;\r\n        // }\r\n        // this.mScroller.resize(this.mScroller.width, this.mHeight, topY, bottomY);\r\n    };\r\n    RoomDelegate.prototype.onEnterRoomHandler = function (room) {\r\n        this.emit("enterRoom", room);\r\n    };\r\n    RoomDelegate.prototype.setScrollInteractive = function (roomList) {\r\n        for (var i = 0, len = roomList.length; i < len; i++) {\r\n            var roomItem = roomList[i];\r\n            this.mScroller.setInteractiveObject(roomItem);\r\n        }\r\n    };\r\n    return RoomDelegate;\r\n}(Phaser.Events.EventEmitter));\r\n\r\nvar MyRoomDelegate = /** @class */ (function (_super) {\r\n    __extends(MyRoomDelegate, _super);\r\n    function MyRoomDelegate(container, scroller, world, scene, key, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        return _super.call(this, container, scroller, scene, world, key, dpr) || this;\r\n    }\r\n    MyRoomDelegate.prototype.addListen = function () {\r\n        this.mMyRoom.on("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mMyHistory.on("enterRoom", this.onEnterRoomHandler, this);\r\n    };\r\n    MyRoomDelegate.prototype.removeListen = function () {\r\n        this.mMyRoom.off("enterRoom", this.onEnterRoomHandler, this);\r\n        this.mMyHistory.off("enterRoom", this.onEnterRoomHandler, this);\r\n    };\r\n    MyRoomDelegate.prototype.addToContainer = function () {\r\n        this.addListen();\r\n        this.refreshPos();\r\n    };\r\n    MyRoomDelegate.prototype.removeFromContainer = function () {\r\n        this.removeListen();\r\n        if (this.mMyRoom)\r\n            this.mMyRoom.clear();\r\n        if (this.mMyHistory)\r\n            this.mMyHistory.clear();\r\n    };\r\n    MyRoomDelegate.prototype.updateList = function (content) {\r\n        if (!this.mMyRoom) {\r\n            return;\r\n        }\r\n        this.mContent = content;\r\n        this.mScroller.clearInteractiveObject();\r\n        this.mHeight = this.activity.height;\r\n        this.mChildPad = this.activity.height + 14 * this.mDpr * this.mWorld.uiScale;\r\n        this.mMyRoom.addItem(content.selfRooms, this.mChildPad);\r\n    };\r\n    MyRoomDelegate.prototype.destroy = function () {\r\n        if (this.mMyRoom)\r\n            this.mMyRoom.destroy();\r\n        if (this.mMyHistory)\r\n            this.mMyHistory.destroy();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    MyRoomDelegate.prototype.refreshPos = function () {\r\n        if (this.activity) {\r\n            this.activity.setTexture(this.mKey, "activity_title.png");\r\n            this.mContainer.add(this.activity);\r\n        }\r\n        if (this.mMyRoom) {\r\n            if (this.mMyRoom.showList) {\r\n                this.mContainer.add(this.mMyRoom.showList);\r\n                if (this.mMyRoom.roomList)\r\n                    this.mContainer.add(this.mMyRoom.roomList);\r\n            }\r\n        }\r\n        if (this.mMyHistory) {\r\n            if (this.mMyHistory.showList) {\r\n                this.mContainer.add(this.mMyHistory.showList);\r\n                if (this.mMyHistory.roomList)\r\n                    this.mContainer.add(this.mMyHistory.roomList);\r\n            }\r\n        }\r\n        // const zoom: number = this.mWorld.uiScale;\r\n        // const baseHei: number = 362 * this.mDpr;\r\n        // let topY: number = this.mContainer.parentContainer.y;\r\n        // let bottomY: number = 0;\r\n        // if (this.mHeight > baseHei) {\r\n        //   topY = topY;\r\n        //   bottomY = topY - this.mHeight + baseHei - 25 * this.mDpr * zoom;\r\n        // } else {\r\n        //   topY = topY;\r\n        //   bottomY = topY;\r\n        // }\r\n        // this.mScroller.resize(this.mScroller.width, this.mHeight, topY, bottomY);\r\n    };\r\n    MyRoomDelegate.prototype.init = function () {\r\n        var _this = this;\r\n        this.activity = this.mScene.make.image({\r\n            key: this.mKey,\r\n            frame: "activity_title.png"\r\n        }, false);\r\n        this.activity.y = this.activity.height / 2 + 2 * this.mDpr;\r\n        this.mChildPad = this.activity.height + 14 * this.mDpr * this.mWorld.uiScale;\r\n        this.mMyRoom = new MyRoomZoon(this.mScene, this.mKey, "my_room_icon.png", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.my_room"), this.mDpr, this.mWorld.uiScale, 0, this.mChildPad, function (hei) {\r\n            if (_this.mMyRoom.roomList)\r\n                _this.setScrollInteractive(_this.mMyRoom.roomList);\r\n            _this.mHeight += hei;\r\n            _this.refreshPos();\r\n            _this.mChildPad += _this.mMyRoom.height;\r\n            _this.mMyHistory.addItem(_this.mContent.historyRooms, _this.mChildPad);\r\n        });\r\n        this.mMyHistory = new RoomZoon(this.mScene, this.mKey, "history_icon.png", _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.my_history"), this.mDpr, this.mWorld.uiScale, 0, this.mChildPad, function (hei) {\r\n            if (_this.mMyHistory.roomList)\r\n                _this.setScrollInteractive(_this.mMyHistory.roomList);\r\n            _this.mHeight += hei;\r\n            _this.refreshPos();\r\n            _this.mScroller.refreshBound(_this.mHeight);\r\n            _this.mScroller.setValue(_this.mContainer.parentContainer.y);\r\n        });\r\n        this.mScroller.refreshBound(this.activity.height);\r\n        this.mScroller.setValue(this.mContainer.parentContainer.y);\r\n    };\r\n    MyRoomDelegate.prototype.onEnterRoomHandler = function (room) {\r\n        this.emit("enterRoom", room);\r\n    };\r\n    return MyRoomDelegate;\r\n}(RoomDelegate));\r\nvar RoomZoon = /** @class */ (function (_super) {\r\n    __extends(RoomZoon, _super);\r\n    /**\r\n     *\r\n     * @param scene\r\n     * @param key\r\n     * @param iconFrame\r\n     * @param label\r\n     * @param dpr\r\n     * @param scrollMode 0 竖直  1 水平\r\n     * @param pad\r\n     * @param addCallBack\r\n     */\r\n    function RoomZoon(scene, key, iconFrame, label, dpr, uiscale, scrollMode, pad, addCallBack) {\r\n        if (scrollMode === void 0) { scrollMode = 0; }\r\n        if (pad === void 0) { pad = 0; }\r\n        var _this = _super.call(this) || this;\r\n        _this.mWidth = 0;\r\n        _this.mHeight = 0;\r\n        _this.mShowList = [];\r\n        _this.mScene = scene;\r\n        _this.mKey = key;\r\n        _this.mDpr = dpr;\r\n        _this.uiScale = uiscale;\r\n        _this.mPad = pad;\r\n        _this.mOrientaction = scrollMode;\r\n        _this.mIconFrame = iconFrame;\r\n        _this.mLabel = label;\r\n        _this.icon = scene.make.image({\r\n            key: key,\r\n            frame: iconFrame\r\n        }, false);\r\n        _this.icon.x = scrollMode ? -254 * dpr / 2 + pad : -254 * dpr / 2;\r\n        _this.icon.y = scrollMode ? 0 : pad;\r\n        _this.text = scene.make.text({\r\n            text: label,\r\n            style: {\r\n                color: "#ffcc33",\r\n                fontSize: 16 * dpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        _this.text.setStroke("#663300", 2 * dpr);\r\n        _this.text.x = scrollMode ? _this.icon.x + _this.icon.width / 2 + 4 * dpr + pad : _this.icon.x + _this.icon.width / 2 + 4 * dpr;\r\n        _this.text.y = scrollMode ? 0 : pad;\r\n        _this.mWidth = _this.icon.width;\r\n        _this.mHeight = _this.icon.height;\r\n        _this.mAddCallBack = addCallBack;\r\n        _this.mRooms = [];\r\n        return _this;\r\n    }\r\n    Object.defineProperty(RoomZoon.prototype, "showList", {\r\n        get: function () {\r\n            return this.mShowList;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomZoon.prototype, "roomList", {\r\n        get: function () {\r\n            return this.mRooms;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    RoomZoon.prototype.addItem = function (rooms, pad) {\r\n        if (pad === void 0) { pad = 0; }\r\n        this.icon = this.mScene.make.image({\r\n            key: this.mKey,\r\n            frame: this.mIconFrame\r\n        }, false);\r\n        this.text = this.mScene.make.text({\r\n            text: this.mLabel,\r\n            style: {\r\n                color: "#ffcc33",\r\n                fontSize: 16 * this.mDpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        this.text.setStroke("#663300", 2 * this.mDpr);\r\n        this.icon.x = this.mOrientaction ? -254 * this.mDpr / 2 + pad : -254 * this.mDpr / 2;\r\n        this.icon.y = this.mOrientaction ? 0 : pad;\r\n        this.text.x = this.mOrientaction ? this.icon.x + this.icon.width / 2 + 4 * this.mDpr + pad : this.icon.x + this.icon.width / 2 + 4 * this.mDpr;\r\n        this.text.y = this.mOrientaction ? 0 : pad;\r\n        this.mShowList.push(this.icon);\r\n        this.mShowList.push(this.text);\r\n        this.mHeight = this.icon.height;\r\n        this.mPad = pad ? pad : this.mPad;\r\n        var len = rooms.length;\r\n        var zoom = this.uiScale;\r\n        var tmpWid = this.mOrientaction ? this.mPad + pad : 0;\r\n        var tmpHei = 6 * this.mDpr * zoom;\r\n        if (len > 0) {\r\n            this.mPad += this.icon.height + 12 * this.mDpr * zoom;\r\n            for (var i = 0; i < len; i++) {\r\n                var room = new RoomItem(this.mScene, this.mKey, this.mDpr);\r\n                room.setInfo(rooms[i]);\r\n                room.on("enterRoom", this.onEnterRoomHandler, this);\r\n                room.x = tmpWid;\r\n                var roomY = i * (room.height + tmpHei) + this.mPad;\r\n                room.y = roomY;\r\n                this.mHeight += room.height + tmpHei;\r\n                this.mRooms[i] = room;\r\n            }\r\n        }\r\n        this.mHeight += tmpHei;\r\n        if (this.mAddCallBack) {\r\n            this.mAddCallBack(this.mHeight);\r\n        }\r\n    };\r\n    Object.defineProperty(RoomZoon.prototype, "width", {\r\n        get: function () {\r\n            return this.mWidth;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RoomZoon.prototype, "height", {\r\n        get: function () {\r\n            return this.mHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    RoomZoon.prototype.destroy = function () {\r\n        this.clear();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RoomZoon.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.mRooms; _i < _a.length; _i++) {\r\n            var room = _a[_i];\r\n            room.destroy();\r\n        }\r\n        for (var _b = 0, _c = this.mShowList; _b < _c.length; _b++) {\r\n            var show = _c[_b];\r\n            show.destroy();\r\n        }\r\n        this.icon.destroy();\r\n        this.text.destroy();\r\n        this.mShowList.length = 0;\r\n        this.mRooms.length = 0;\r\n    };\r\n    RoomZoon.prototype.onEnterRoomHandler = function (room) {\r\n        this.emit("enterRoom", room);\r\n    };\r\n    return RoomZoon;\r\n}(Phaser.Events.EventEmitter));\r\n\r\nvar MyRoomZoon = /** @class */ (function (_super) {\r\n    __extends(MyRoomZoon, _super);\r\n    function MyRoomZoon() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MyRoomZoon.prototype.addItem = function (rooms, pad) {\r\n        if (pad === void 0) { pad = 0; }\r\n        // this.clear();\r\n        this.icon = this.mScene.make.image({\r\n            key: this.mKey,\r\n            frame: this.mIconFrame\r\n        }, false);\r\n        this.text = this.mScene.make.text({\r\n            text: this.mLabel,\r\n            style: {\r\n                color: "#ffcc33",\r\n                fontSize: 16 * this.mDpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        this.text.setStroke("#663300", 2 * this.mDpr);\r\n        this.icon.x = this.mOrientaction ? -254 * this.mDpr / 2 + pad : -254 * this.mDpr / 2;\r\n        this.icon.y = this.mOrientaction ? 0 : pad;\r\n        this.text.x = this.mOrientaction ? this.icon.x + this.icon.width / 2 + 4 * this.mDpr + pad : this.icon.x + this.icon.width / 2 + 4 * this.mDpr;\r\n        this.text.y = this.mOrientaction ? 0 : pad;\r\n        this.mShowList.push(this.icon);\r\n        this.mShowList.push(this.text);\r\n        this.mHeight = this.icon.height;\r\n        this.mPad = pad ? pad : this.mPad;\r\n        var zoom = this.uiScale;\r\n        var tmpWid = this.mOrientaction ? this.mPad + pad : 0;\r\n        var tmpHei = 6 * this.mDpr * zoom;\r\n        if (rooms.length > 0) {\r\n            this.mPad += this.icon.height + 14 * this.mDpr * zoom;\r\n            // TODO 通过反射创建\r\n            for (var i = 0; i < rooms.length; i++) {\r\n                var room = new MyRoomItem(this.mScene, this.mKey, this.mDpr);\r\n                room.setInfo(rooms[i]);\r\n                room.on("enterRoom", this.onEnterRoomHandler, this);\r\n                room.x = tmpWid;\r\n                var roomY = i * (room.height + tmpHei) + this.mPad;\r\n                room.y = roomY;\r\n                this.mHeight += room.height + tmpHei;\r\n                this.mRooms[i] = room;\r\n            }\r\n        }\r\n        this.mHeight += tmpHei;\r\n        if (this.mAddCallBack) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("myroomheight:" + this.mHeight);\r\n            this.mAddCallBack(this.mHeight);\r\n        }\r\n    };\r\n    return MyRoomZoon;\r\n}(RoomZoon));\r\nvar PopularRoomZoon = /** @class */ (function (_super) {\r\n    __extends(PopularRoomZoon, _super);\r\n    function PopularRoomZoon() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PopularRoomZoon.prototype.addItem = function (rooms, pad) {\r\n        if (pad === void 0) { pad = 0; }\r\n        // this.clear();\r\n        this.icon = this.mScene.make.image({\r\n            key: this.mKey,\r\n            frame: this.mIconFrame\r\n        }, false);\r\n        this.text = this.mScene.make.text({\r\n            text: this.mLabel,\r\n            style: {\r\n                color: "#ffcc33",\r\n                fontSize: 16 * this.mDpr,\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        this.text.setStroke("#663300", 2 * this.mDpr);\r\n        this.icon.x = this.mOrientaction ? -254 * this.mDpr / 2 + pad : -254 * this.mDpr / 2;\r\n        this.icon.y = this.mOrientaction ? 0 : pad;\r\n        this.text.x = this.mOrientaction ? this.icon.x + this.icon.width / 2 + 4 * this.mDpr + pad : this.icon.x + this.icon.width / 2 + 4 * this.mDpr;\r\n        this.text.y = this.mOrientaction ? 0 : pad;\r\n        this.mShowList.push(this.icon);\r\n        this.mShowList.push(this.text);\r\n        this.mHeight = this.icon.height;\r\n        this.mPad = pad ? pad : this.mPad;\r\n        var zoom = this.uiScale;\r\n        var tmpWid = this.mOrientaction ? this.mPad : 0;\r\n        var tmpHei = 6 * this.mDpr * zoom;\r\n        if (rooms.length > 0) {\r\n            this.mPad += this.icon.height + 12 * this.mDpr * zoom;\r\n            for (var i = 0; i < rooms.length; i++) {\r\n                var room = new PopularRoomItem(this.mScene, this.mKey, this.mDpr);\r\n                room.setInfo(rooms[i]);\r\n                room.setRank(i + 1);\r\n                room.on("enterRoom", this.onEnterRoomHandler, this);\r\n                room.x = tmpWid;\r\n                var roomY = i * (room.height + tmpHei) + this.mPad;\r\n                room.y = roomY;\r\n                this.mHeight += room.height + tmpHei;\r\n                this.mRooms[i] = room;\r\n            }\r\n        }\r\n        this.mHeight += tmpHei;\r\n        if (this.mAddCallBack) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_6__["Logger"].getInstance().log("popheight:" + this.mHeight);\r\n            this.mAddCallBack(this.mHeight);\r\n        }\r\n        return this.mHeight;\r\n    };\r\n    return PopularRoomZoon;\r\n}(RoomZoon));\r\nvar RoomItem = /** @class */ (function (_super) {\r\n    __extends(RoomItem, _super);\r\n    function RoomItem(scene, key, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mKey = key;\r\n        _this.mDpr = dpr;\r\n        _this.init(key, dpr);\r\n        return _this;\r\n    }\r\n    RoomItem.prototype.setInfo = function (room) {\r\n        if (room) {\r\n            if (room.name)\r\n                this.mNickName.setText(room.name);\r\n            if (room.playerCount)\r\n                this.mCounter.setText(room.playerCount.toString());\r\n        }\r\n        this.mCounterIcon.x = this.mCounter.x - this.mCounter.width / 2 - this.mCounterIcon.width / 2 - 4 * this.mDpr;\r\n        this.crateLabel(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModeRoomPrivacy.EDIT_MODE_ROOM_LOCKED);\r\n        this.mRoom = room;\r\n    };\r\n    RoomItem.prototype.roomData = function () {\r\n        return this.mRoom;\r\n    };\r\n    RoomItem.prototype.onEnterRoomHandler = function (pointer) {\r\n        if (this.mRoom) {\r\n            this.emit("enterRoom", this.mRoom.roomId);\r\n        }\r\n    };\r\n    RoomItem.prototype.init = function (key, dpr) {\r\n        this.mBackground = this.scene.make.image({\r\n            key: key,\r\n            frame: "room_gray.png"\r\n        }, false).setInteractive();\r\n        this.setSize(this.mBackground.width, this.mBackground.height);\r\n        this.mNickName = this.scene.make.text({\r\n            style: {\r\n                color: "#000000",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * dpr\r\n            }\r\n        }, false);\r\n        this.mNickName.x = -this.width / 2 + 12 * dpr;\r\n        this.mNickName.y = -(this.mNickName.height) / 2;\r\n        this.mCounterIcon = this.scene.make.image({\r\n            key: key,\r\n            frame: "counter_icon.png"\r\n        }, false);\r\n        this.mCounter = this.scene.make.text({\r\n            style: {\r\n                color: "#000000",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 14 * dpr\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mCounter.x = this.width / 2 - 23 * dpr;\r\n        this.add([this.mBackground, this.mNickName, this.mCounterIcon, this.mCounter]);\r\n    };\r\n    RoomItem.prototype.crateLabel = function (state) {\r\n        // TODO 封装成一个类\r\n        var frame = "";\r\n        var text = "";\r\n        if (state === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModeRoomPrivacy.EDIT_MODE_ROOM_LOCKED) {\r\n            frame = "passworld_label.png";\r\n            text = _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.password");\r\n        }\r\n        else if (state === pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_def"].EditModeRoomPrivacy.EDIT_MODE_ROOM_PRIVATE) {\r\n            frame = "close_label.png";\r\n            text = _i18n__WEBPACK_IMPORTED_MODULE_3__["i18n"].t("room_list.close");\r\n        }\r\n        if (frame === "" || text === "") {\r\n            return;\r\n        }\r\n        this.mLabelImg = this.scene.make.image({\r\n            key: this.mKey,\r\n            frame: frame\r\n        }, false);\r\n        this.mLabelText = this.scene.make.text({\r\n            text: text,\r\n            style: {\r\n                color: "#666666",\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 12 * this.mDpr\r\n            }\r\n        }, false).setOrigin(0, 0.5);\r\n        this.add([this.mLabelImg, this.mLabelText]);\r\n        this.mLabelImg.x = this.width / 2 - 85 * this.mDpr;\r\n        this.mLabelText.x = this.mLabelImg.x - 7 * this.mDpr;\r\n    };\r\n    return RoomItem;\r\n}(Phaser.GameObjects.Container));\r\nvar MyRoomItem = /** @class */ (function (_super) {\r\n    __extends(MyRoomItem, _super);\r\n    function MyRoomItem(scene, key, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        return _super.call(this, scene, key, dpr) || this;\r\n    }\r\n    MyRoomItem.prototype.init = function (key, dpr) {\r\n        _super.prototype.init.call(this, key, dpr);\r\n        if (this.mBackground) {\r\n            this.mBackground.setFrame("room_yellow.png");\r\n        }\r\n        if (this.mNickName) {\r\n            this.mNickName.setColor("#663300");\r\n            this.mCounter.setColor("#663300");\r\n        }\r\n    };\r\n    return MyRoomItem;\r\n}(RoomItem));\r\nvar PopularRoomItem = /** @class */ (function (_super) {\r\n    __extends(PopularRoomItem, _super);\r\n    function PopularRoomItem(scene, key, dpr) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        return _super.call(this, scene, key, dpr) || this;\r\n    }\r\n    PopularRoomItem.prototype.setRank = function (num) {\r\n        if (this.mRankImage) {\r\n            this.mRankImage.setTexture(this.mKey, "rank_" + num + ".png");\r\n            this.mRankImage.x = -this.width / 2 + this.mRankImage.width / 2 - 2 * this.mDpr;\r\n            this.add(this.mRankImage);\r\n        }\r\n    };\r\n    PopularRoomItem.prototype.init = function (key, dpr) {\r\n        _super.prototype.init.call(this, key, dpr);\r\n        this.mRankImage = this.scene.make.image(undefined, false);\r\n        this.mNickName.x = -this.width / 2 + 37 * dpr;\r\n    };\r\n    return PopularRoomItem;\r\n}(MyRoomItem));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaRoomList/PicaRoomListPanel.ts?')},"./src/ui/PicaRoomList/RoomList.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RoomList", function() { return RoomList; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar RoomList = /** @class */ (function (_super) {\r\n    __extends(RoomList, _super);\r\n    function RoomList($world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = $world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    RoomList.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ROOM_LIST, this.onRoomListHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_GET_PLAYER_ENTER_ROOM_HISTORY, this.onMyRoomListHandler);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_EDIT_MODE_ENTER_ROOM, this.onEnterRoomResultHandler);\r\n        }\r\n    };\r\n    RoomList.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    RoomList.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    RoomList.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    RoomList.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    RoomList.prototype.sendGetRoomList = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_ROOM_LIST);\r\n        var content = packet.content;\r\n        content.page = 1;\r\n        content.perPage = 30;\r\n        this.connection.send(packet);\r\n    };\r\n    RoomList.prototype.sendMyHistory = function () {\r\n        this.connection.send(new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_GET_PLAYER_ENTER_ROOM_HISTORY));\r\n    };\r\n    RoomList.prototype.sendEnterRoom = function (roomID, password) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER_ROOM);\r\n        var content = packet.content;\r\n        content.roomId = roomID;\r\n        content.password = password;\r\n        this.connection.send(packet);\r\n    };\r\n    RoomList.prototype.onRoomListHandler = function (packet) {\r\n        this.mEvent.emit("roomList", packet.content);\r\n    };\r\n    RoomList.prototype.onMyRoomListHandler = function (packet) {\r\n        this.mEvent.emit("myRoomList", packet.content);\r\n    };\r\n    RoomList.prototype.onEnterRoomResultHandler = function (packet) {\r\n        this.mEvent.emit("enterRoomResult", packet);\r\n    };\r\n    Object.defineProperty(RoomList.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return RoomList;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/PicaRoomList/RoomList.ts?')},"./src/ui/Rank/BasicRankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicRankPanel", function() { return BasicRankPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar BasicRankPanel = /** @class */ (function (_super) {\r\n    __extends(BasicRankPanel, _super);\r\n    function BasicRankPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mTexts = [];\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    BasicRankPanel.prototype.addItem = function (items) {\r\n        this.setData("data", items);\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.clearText();\r\n        var texts = items.text;\r\n        if (!texts || texts.length < 1)\r\n            return;\r\n        if (this.mTitleLabel) {\r\n            this.mTitleLabel.setText(texts[0].text);\r\n            this.mTitleLabel.setData("node", texts[0].node);\r\n        }\r\n        var locX = [-this.width / 2 + 15, -this.width / 2 + 63, -this.width / 2 + 241];\r\n        var tmpY = 0;\r\n        for (var i = 1; i < 4; i++) {\r\n            var text = this.scene.make.text({\r\n                x: locX[i - 1],\r\n                y: -this.height / 2 + 22,\r\n                text: texts ? texts[i].text : "123",\r\n                style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_16_BOLD }\r\n            }, false);\r\n            tmpY = text.y;\r\n            text.setData("node", texts[i].node);\r\n            text.setStroke("#000000", 2);\r\n            this.mChildContainer.add(text);\r\n            this.mTexts.push(text);\r\n        }\r\n        tmpY += 20;\r\n        for (var i = 4; i < texts.length; i++) {\r\n            var t = texts[i];\r\n            var x = (i - 4) % 3;\r\n            var y = Math.floor((i - 4) / 3) * 22; // Math.floor((i - 4) / 3) * (-this.height / 2 + 42);\r\n            var text = this.scene.make.text({\r\n                x: locX[x],\r\n                y: tmpY + y,\r\n                text: t ? t.text : "123",\r\n                style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_14_BOLD }\r\n            }, false);\r\n            if (x === 0) {\r\n                // todo center\r\n            }\r\n            text.setData("node", t.node);\r\n            text.setStroke("#000000", 2);\r\n            this.mChildContainer.add(text);\r\n            this.mTexts.push(text);\r\n        }\r\n    };\r\n    BasicRankPanel.prototype.tweenView = function (show) {\r\n    };\r\n    BasicRankPanel.prototype.update = function (param) {\r\n        this.addItem(param);\r\n    };\r\n    BasicRankPanel.prototype.destroy = function () {\r\n        if (this.mBackground)\r\n            this.mBackground.destroy();\r\n        var len = this.mTexts.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var text = this.mTexts[i];\r\n            if (!text)\r\n                continue;\r\n            text.destroy(true);\r\n            text = null;\r\n        }\r\n        if (this.mTitleLabel)\r\n            this.mTitleLabel.destroy(true);\r\n        this.mTexts = [];\r\n        this.mBackground = null;\r\n        this.mTitleLabel = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BasicRankPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.scene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.atlas("rank_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/rank/rank_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/rank/rank_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BasicRankPanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        this.setSize(328, 361);\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 328, 361, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.add(this.mBackground);\r\n        this.mChildContainer = this.scene.make.container({}, false);\r\n        this.add(this.mChildContainer);\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 315, 318, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mChildContainer.add(border);\r\n        var titleIcon = this.scene.make.image({\r\n            x: -this.width / 2 + 20,\r\n            y: -this.height / 2 - 12,\r\n            key: "rank_atlas",\r\n            frame: "icon.png",\r\n        }, false).setOrigin(0, 0);\r\n        this.add(titleIcon);\r\n        this.mTitleLabel = this.scene.make.text({\r\n            x: -this.width / 2 + 54,\r\n            y: -this.height / 2 - 10,\r\n            text: "排行榜",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].YAHEI_20_BOLD }\r\n        })\r\n            .setOrigin(0, 0)\r\n            .setStroke("#000000", 2);\r\n        this.add(this.mTitleLabel);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BasicRankPanel.prototype.clearText = function () {\r\n        for (var _i = 0, _a = this.mTexts; _i < _a.length; _i++) {\r\n            var text = _a[_i];\r\n            text.destroy();\r\n        }\r\n        this.mTexts.length = 0;\r\n    };\r\n    return BasicRankPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/BasicRankPanel.ts?')},"./src/ui/Rank/RankMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RankMediator", function() { return RankMediator; });\n/* harmony import */ var _RankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RankPanel */ "./src/ui/Rank/RankPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar RankMediator = /** @class */ (function (_super) {\r\n    __extends(RankMediator, _super);\r\n    function RankMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mlayerManager = layerManager;\r\n        _this.mUIType = _this.world.game.device.os.desktop ? _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Scene : _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Normal;\r\n        return _this;\r\n    }\r\n    RankMediator.prototype.tweenView = function (show) {\r\n        if (!this.mView || !this.world.game.device.os.desktop)\r\n            return;\r\n        this.mView.tweenView(show);\r\n    };\r\n    RankMediator.prototype.getName = function () {\r\n        return "";\r\n    };\r\n    RankMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    RankMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n            if (!this.world.game.device.os.desktop) {\r\n                this.world.uiManager.checkUIState(RankMediator.NAME, true);\r\n            }\r\n        }\r\n    };\r\n    RankMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    RankMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    RankMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize();\r\n    };\r\n    RankMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _RankPanel__WEBPACK_IMPORTED_MODULE_0__["RankPanel"](this.mScene, this.world);\r\n        this.mlayerManager.addToUILayer(this.mView);\r\n        if (param && param.length > 0) {\r\n            this.mView.addItem(param[0]);\r\n        }\r\n        this.mView.show();\r\n        if (!this.world.game.device.os.desktop) {\r\n            this.world.uiManager.checkUIState(RankMediator.NAME, false);\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RankMediator.prototype.update = function (param) {\r\n        if (!this.mView)\r\n            return;\r\n        if (param && param.length > 0) {\r\n            this.mView.update(param[0]);\r\n        }\r\n    };\r\n    RankMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            if (this.mView.parentContainer) {\r\n                this.mView.parentContainer.remove(this.mView);\r\n            }\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    RankMediator.NAME = "RankMediator";\r\n    return RankMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/RankMediator.ts?')},"./src/ui/Rank/RankPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RankPanel", function() { return RankPanel; });\n/* harmony import */ var _BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BasicRankPanel */ "./src/ui/Rank/BasicRankPanel.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _RankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar RankPanel = /** @class */ (function (_super) {\r\n    __extends(RankPanel, _super);\r\n    function RankPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mCurrentIndex = 0;\r\n        return _this;\r\n    }\r\n    RankPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n        }\r\n        else {\r\n            this.mZoonInBtn.on("pointerup", this.onZoomHandler, this);\r\n        }\r\n    };\r\n    RankPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn.off("pointerup", this.closeHandler, this);\r\n        }\r\n        else {\r\n            this.mZoonInBtn.off("pointerup", this.onZoomHandler, this);\r\n        }\r\n    };\r\n    RankPanel.prototype.resize = function (wid, hei) {\r\n        if (wid === void 0) { wid = 0; }\r\n        if (hei === void 0) { hei = 0; }\r\n        if (!this.mWorld) {\r\n            return;\r\n        }\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width - this.width / 2;\r\n            this.y = this.height / 2 + 10;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n        }\r\n        this.scale = this.mWorld.uiScale;\r\n    };\r\n    RankPanel.prototype.tweenView = function (show) {\r\n        if (!this.scene)\r\n            return;\r\n        var baseY = this.height / 2 + 10;\r\n        var toY = show === true ? baseY : baseY - 300;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    RankPanel.prototype.destroy = function () {\r\n        if (this.mZoonInBtn)\r\n            this.mZoonInBtn.destroy(true);\r\n        this.mZoonInBtn = null;\r\n        this.mCurrentIndex = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RankPanel.prototype.init = function () {\r\n        _super.prototype.init.call(this);\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_1__["IconBtn"](this.scene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n                iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n            });\r\n            this.mClsBtn.x = this.width / 2 - 35;\r\n            this.mClsBtn.y = -this.height / 2;\r\n            this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n            // this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n            this.add(this.mClsBtn);\r\n        }\r\n        else {\r\n            this.mZoonInBtn = this.scene.make.image({\r\n                x: 0,\r\n                y: this.height / 2 - 10,\r\n                key: "rank_atlas",\r\n                frame: "arrow.png"\r\n            }, false);\r\n            this.add(this.mZoonInBtn);\r\n            this.mZoonInBtn.setInteractive();\r\n            // this.mZoonInBtn.on("pointerup", this.onZoomHandler, this);\r\n        }\r\n        this.resize();\r\n    };\r\n    RankPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show) {\r\n            var items = this.getData("data");\r\n            if (items)\r\n                this.addItem(items);\r\n        }\r\n    };\r\n    RankPanel.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_RankMediator__WEBPACK_IMPORTED_MODULE_2__["RankMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    RankPanel.prototype.onZoomHandler = function () {\r\n        this.currentSizeIndex = this.mCurrentIndex === 0 ? 1 : 0;\r\n    };\r\n    Object.defineProperty(RankPanel.prototype, "currentSizeIndex", {\r\n        set: function (value) {\r\n            if (this.mCurrentIndex === value) {\r\n                return;\r\n            }\r\n            this.mCurrentIndex = value;\r\n            var h = this.mCurrentIndex === 1 ? 30 : this.height;\r\n            var zoonBtnY = this.mCurrentIndex === 1 ? -this.height / 2 + 20 : this.height / 2 - 10;\r\n            var bgY = this.mCurrentIndex === 1 ? -this.height / 2 + 15 : 0;\r\n            this.mBackground.resize(328, h);\r\n            this.mZoonInBtn.angle = this.mCurrentIndex === 1 ? 180 : 0;\r\n            if (h > 300) {\r\n                if (this.parentContainer)\r\n                    this.add(this.mChildContainer);\r\n            }\r\n            else {\r\n                this.remove(this.mChildContainer);\r\n            }\r\n            // this.mBackground.x = this.mBackground.width >> 1;\r\n            // this.mBackground.y = this.mBackground.height >> 1;\r\n            this.mBackground.y = bgY;\r\n            this.mZoonInBtn.y = zoonBtnY;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return RankPanel;\r\n}(_BasicRankPanel__WEBPACK_IMPORTED_MODULE_0__["BasicRankPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Rank/RankPanel.ts?')},"./src/ui/ReAwardTips/ReAwardTip.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReAwardTips", function() { return ReAwardTips; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar ReAwardTips = /** @class */ (function (_super) {\r\n    __extends(ReAwardTips, _super);\r\n    function ReAwardTips(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    ReAwardTips.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    ReAwardTips.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    ReAwardTips.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_SHOW_REWARD_TIPS, this.onReAwardTipsHandler);\r\n        }\r\n    };\r\n    ReAwardTips.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    ReAwardTips.prototype.destroy = function () {\r\n        this.unregister();\r\n    };\r\n    Object.defineProperty(ReAwardTips.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ReAwardTips.prototype.onReAwardTipsHandler = function (packet) {\r\n        this.mEvent.emit("showAward", packet.content);\r\n    };\r\n    return ReAwardTips;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ReAwardTips/ReAwardTip.ts?')},"./src/ui/ReAwardTips/ReAwardTipsMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReAwardTipsMediator", function() { return ReAwardTipsMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _ReAwardTip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ReAwardTip */ "./src/ui/ReAwardTips/ReAwardTip.ts");\n/* harmony import */ var _ReAwardTipsPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ReAwardTipsPanel */ "./src/ui/ReAwardTips/ReAwardTipsPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar ReAwardTipsMediator = /** @class */ (function (_super) {\r\n    __extends(ReAwardTipsMediator, _super);\r\n    function ReAwardTipsMediator(scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.world = world;\r\n        _this.mReAwardTips = new _ReAwardTip__WEBPACK_IMPORTED_MODULE_1__["ReAwardTips"](world);\r\n        _this.mReAwardTips.register();\r\n        _this.mReAwardTips.on("showAward", _this.onShowAwardHandler, _this);\r\n        return _this;\r\n    }\r\n    ReAwardTipsMediator.prototype.show = function (param) {\r\n        if (this.mView) {\r\n            this.mView.appendAward(param);\r\n            return;\r\n        }\r\n        this.mView = new _ReAwardTipsPanel__WEBPACK_IMPORTED_MODULE_2__["ReAwardTipsPanel"](this.scene, this.world);\r\n        this.mView.appendAward(param);\r\n        _super.prototype.show.call(this);\r\n        this.world.uiManager.getUILayerManager().addToDialogLayer(this.mView);\r\n    };\r\n    ReAwardTipsMediator.prototype.destroy = function () {\r\n        if (this.mReAwardTips) {\r\n            this.mReAwardTips.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ReAwardTipsMediator.prototype.onShowAwardHandler = function (content) {\r\n        this.show(content);\r\n    };\r\n    return ReAwardTipsMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ReAwardTips/ReAwardTipsMediator.ts?')},"./src/ui/ReAwardTips/ReAwardTipsPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReAwardTipsPanel", function() { return ReAwardTipsPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar ReAwardTipsPanel = /** @class */ (function (_super) {\r\n    __extends(ReAwardTipsPanel, _super);\r\n    function ReAwardTipsPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "reaward_tips";\r\n        _this.mTips = [];\r\n        _this.showingList = [];\r\n        return _this;\r\n    }\r\n    ReAwardTipsPanel.prototype.show = function () {\r\n        _super.prototype.show.call(this);\r\n        if (this.mInitialized) {\r\n            if (this.showingList.length === 0)\r\n                this.showAward();\r\n        }\r\n    };\r\n    ReAwardTipsPanel.prototype.appendAward = function (tips) {\r\n        // const award = new AwardItem(this.scene);\r\n        // this.add(award);\r\n        this.mTips.push(tips);\r\n        this.show();\r\n    };\r\n    ReAwardTipsPanel.prototype.addAward = function () {\r\n    };\r\n    ReAwardTipsPanel.prototype.preload = function () {\r\n        this.addImage(this.key, "reaward_tips/bg.png");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ReAwardTipsPanel.prototype.init = function () {\r\n        this.setSize(20, 20);\r\n        _super.prototype.init.call(this);\r\n        this.y = 250 * this.dpr;\r\n    };\r\n    ReAwardTipsPanel.prototype.showAward = function () {\r\n        if (this.mTips.length < 1) {\r\n            return;\r\n        }\r\n        if (this.showingList.length >= 3) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = this.showingList; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            // item.y -= 30 * this.dpr;\r\n            item.beUp();\r\n        }\r\n        // TODO 使用对象池创建\r\n        var award = new AwardItem(this.scene, this.key, this.dpr, this.scale);\r\n        award.once("destroy", this.onDestroyHanlder, this);\r\n        award.once("show", this.onAwardItemShowHandler, this);\r\n        award.setProp(this.mTips.pop());\r\n        // award.y = -(this.showingList.length * 30 * this.dpr);\r\n        this.add(award);\r\n        this.showingList.push(award);\r\n    };\r\n    ReAwardTipsPanel.prototype.onAwardItemShowHandler = function () {\r\n        this.showAward();\r\n    };\r\n    ReAwardTipsPanel.prototype.onDestroyHanlder = function (item) {\r\n        var index = this.showingList.indexOf(item);\r\n        if (index > -1) {\r\n            this.showingList.splice(index, 1);\r\n        }\r\n        this.showAward();\r\n    };\r\n    return ReAwardTipsPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar AwardItem = /** @class */ (function (_super) {\r\n    __extends(AwardItem, _super);\r\n    function AwardItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mBg = _this.scene.make.image({\r\n            key: key,\r\n        }, false);\r\n        _this.mScaleRatio = dpr * zoom;\r\n        _this.mImage = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.scene, 0, 0);\r\n        _this.mImage.setScale(dpr);\r\n        _this.mImage.setOrigin(0.5, 1);\r\n        _this.mImage.y = _this.mBg.height * zoom / 2;\r\n        _this.mLabel = _this.scene.make.text({\r\n            x: _this.mBg.width * _this.originX - 6 * _this.mScaleRatio,\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_2__["Font"].DEFULT_FONT,\r\n                fontSize: 11 * _this.mScaleRatio,\r\n                color: "#00FF00"\r\n            }\r\n        }, false).setOrigin(1, 0.5);\r\n        // this.add([this.mBg, this.mImage, this.mLabel]);\r\n        _this.addAt(_this.mBg, 0);\r\n        _this.add([_this.mImage, _this.mLabel]);\r\n        _this.setSize(_this.mBg.width * zoom, _this.mBg.height * zoom);\r\n        return _this;\r\n    }\r\n    AwardItem.prototype.setProp = function (award) {\r\n        if (!award) {\r\n            return;\r\n        }\r\n        if (award.display && award.display.texturePath) {\r\n            this.mImage.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(award.display.texturePath));\r\n        }\r\n        this.mLabel.setText(award.text);\r\n        this.showTween();\r\n    };\r\n    AwardItem.prototype.showTween = function () {\r\n        var _this = this;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            props: {\r\n                x: "+=" + this.width * 0.3\r\n            },\r\n            ease: "Bounce.easeOut",\r\n            onComplete: function () {\r\n                _this.emit("show");\r\n                _this.closeDelay = setTimeout(function () {\r\n                    _this.closeTween();\r\n                }, 1000);\r\n            },\r\n            duration: 300\r\n        });\r\n    };\r\n    AwardItem.prototype.closeTween = function () {\r\n        var _this = this;\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            props: {\r\n                y: "-=" + 50 * this.mScaleRatio,\r\n                alpha: "0"\r\n            },\r\n            ease: "Linear",\r\n            duration: 300,\r\n            onComplete: function () {\r\n                _this.destroy();\r\n            }\r\n        });\r\n    };\r\n    AwardItem.prototype.beUp = function () {\r\n        var _this = this;\r\n        clearTimeout(this.closeDelay);\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            props: {\r\n                y: "-=" + 50 * this.mScaleRatio\r\n            },\r\n            ease: "Linear",\r\n            duration: 300,\r\n            onComplete: function () {\r\n                _this.closeDelay = setTimeout(function () {\r\n                    _this.closeTween();\r\n                }, 1000);\r\n            }\r\n        });\r\n    };\r\n    return AwardItem;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ReAwardTips/ReAwardTipsPanel.ts?')},"./src/ui/Shop/ShopMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopMediator", function() { return ShopMediator; });\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _ShopPanel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ShopPanel */ "./src/ui/Shop/ShopPanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ShopMediator = /** @class */ (function (_super) {\r\n    __extends(ShopMediator, _super);\r\n    function ShopMediator(layerManager, scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this._perPage = 50;\r\n        _this.isEnd = false;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__["UIType"].Normal;\r\n        return _this;\r\n    }\r\n    ShopMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    ShopMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize();\r\n    };\r\n    ShopMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    ShopMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow() || this.mShow) {\r\n            return;\r\n        }\r\n        this.mView = new _ShopPanel__WEBPACK_IMPORTED_MODULE_3__["ShopPanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.requestVirtualWorldQueryPackage(param[0].id, 1, _ShopPanel__WEBPACK_IMPORTED_MODULE_3__["ShopPanel"].ShopSlotCount);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.uiManager.checkUIState(ShopMediator.NAME, false);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    ShopMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    ShopMediator.prototype.hide = function () {\r\n        if (!this.mView)\r\n            return;\r\n        this.mShow = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        this.world.uiManager.checkUIState(ShopMediator.NAME, true);\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ShopMediator.prototype.destroy = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.queryPackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SYNC_USER_BALANCE, this.onSyncUserBalanceHandler, this);\r\n        this.world = null;\r\n        this.mScene = null;\r\n        this._curPage = 0;\r\n        this.fetching = false;\r\n        this.isEnd = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopMediator.prototype.isShow = function () {\r\n        return this.mView ? this.mView.isShow() : false;\r\n    };\r\n    ShopMediator.prototype.requestVirtualWorldQueryPackage = function (bagId, page, perPage) {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = bagId;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ShopMediator.prototype.queryShopProps = function (page, perPage) {\r\n        if (page === void 0) { page = 1; }\r\n        if (perPage === void 0) { perPage = 50; }\r\n        if (!!this.mParam === false)\r\n            return;\r\n        this.fetching = true;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_QUERY_PACKAGE);\r\n        var content = pkt.content;\r\n        content.id = this.mParam[0].id;\r\n        content.page = page;\r\n        content.perPage = perPage;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    ShopMediator.prototype.queryPackageHandler = function (data) {\r\n        if (data.items.length > 0 && data.id === this.mParam[0].id) {\r\n            this.mView.setDataList(data);\r\n            //  this.mView.addItems(data.items);\r\n        }\r\n        else {\r\n            this.isEnd = true;\r\n        }\r\n        this.fetching = false;\r\n    };\r\n    ShopMediator.prototype.onShowItemHandler = function (item) {\r\n        var prices = item.price;\r\n        for (var _i = 0, prices_1 = prices; _i < prices_1.length; _i++) {\r\n            var price = prices_1[_i];\r\n            if (price.coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].CoinType.TU_DING_COIN) {\r\n                // if (price.price > this.mView.price) {\r\n                // todo alert\r\n                // Globals.PromptManager.showAlert("图钉不足，是否前往充值？", this.onPayTuDingHandler, this, AlertmView.OK | AlertmView.CANCEL);\r\n                // return;\r\n                // }\r\n            }\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = this.mParam[0].id;\r\n        content.componentId = item.id;\r\n        this.world.connection.send(pkt);\r\n        // Globals.SocketManager.send(pkt);\r\n    };\r\n    ShopMediator.prototype.syncUserBalance = function () {\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_SYNC_USER_BALANCE);\r\n        this.world.connection.send(pkt);\r\n        // Globals.SocketManager.send(pkt);\r\n    };\r\n    ShopMediator.prototype.onChangeIndex = function (rate) {\r\n        if (rate >= 0.9 && this.fetching === false && this.isEnd === false) {\r\n            this._curPage++;\r\n            this.queryShopProps(this._curPage);\r\n        }\r\n    };\r\n    ShopMediator.prototype.onSyncUserBalanceHandler = function (balance) {\r\n        if (!!this.mView === false) {\r\n            return;\r\n        }\r\n        // this.mView.setUserBalance(balance);\r\n    };\r\n    ShopMediator.prototype.onPayTuDingHandler = function () {\r\n        // shell.openExternal("https://www.tooqing.com/recharge");\r\n    };\r\n    ShopMediator.NAME = "ShopMediator";\r\n    return ShopMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/ShopMediator.ts?')},"./src/ui/Shop/ShopPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopPanel", function() { return ShopPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _shop_itemSlot__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shop.itemSlot */ "./src/ui/Shop/shop.itemSlot.ts");\n/* harmony import */ var _ShopMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ShopMediator */ "./src/ui/Shop/ShopMediator.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ShopPanel = /** @class */ (function (_super) {\r\n    __extends(ShopPanel, _super);\r\n    function ShopPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mWorld = world;\r\n        return _this;\r\n    }\r\n    ShopPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width + wid >> 1;\r\n            this.y = size.height + hei >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width + wid >> 1;\r\n                this.y = size.height + hei >> 1;\r\n            }\r\n        }\r\n        this.scale = this.mWorld.uiScale;\r\n    };\r\n    ShopPanel.prototype.setDataList = function (value) {\r\n        this.mShopData = value;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.refreshDataList();\r\n    };\r\n    ShopPanel.prototype.destroy = function () {\r\n        if (this.mShopItemSlotList) {\r\n            this.mShopItemSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.mShopItemSlotList.length = 0;\r\n            this.mShopItemSlotList = null;\r\n        }\r\n        this.mShopData = null;\r\n        this.mInitialized = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mClsBtn.on("pointerup", this.shopMedClose, this);\r\n    };\r\n    ShopPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mClsBtn.off("pointerup", this.shopMedClose, this);\r\n    };\r\n    ShopPanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.mScene.load.atlas("itemChose", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/itemChose.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/itemChose.json"));\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.mScene.load.atlas("shopView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/shop/shopView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/shop/shopView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ShopPanel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        var selectFramesObj = this.mScene.textures.get("itemChose").frames;\r\n        var tmpSelectFrames = [];\r\n        for (var key in selectFramesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = selectFramesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpSelectFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.mScene.anims.create({\r\n            key: "itemSelectFrame",\r\n            frames: this.mScene.anims.generateFrameNumbers("itemChose", { start: 0, end: 8, frames: tmpSelectFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        _super.prototype.loadComplete.call(this, loader, totalComplete, totalFailed);\r\n    };\r\n    ShopPanel.prototype.init = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.mBg.x = 0;\r\n        this.mBg.y = 0;\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.addAt(this.mBg, 0);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height - 300;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n        }\r\n        var titleCon = this.mScene.make.sprite(undefined, false);\r\n        titleCon.setTexture("shopView", "shopView_titleIcon");\r\n        titleCon.x = (-this.mBg.width >> 1) + 35;\r\n        titleCon.y = -this.mBg.height >> 1;\r\n        this.add(titleCon);\r\n        var titleTF = this.mScene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("内购商城");\r\n        titleTF.x = titleCon.x + titleCon.width - 10;\r\n        titleTF.y = titleCon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        this.mShopItemSlotList = [];\r\n        var itemSlot;\r\n        var tmpX;\r\n        var tmpY;\r\n        for (var i = 0; i < 20; i++) {\r\n            tmpX = (i % 5) * 88 - this.mBg.width / 2 + 75;\r\n            tmpY = Math.floor(i / 5) * 82 - this.mBg.height / 2 + 72;\r\n            itemSlot = new _shop_itemSlot__WEBPACK_IMPORTED_MODULE_2__["ShopItemSlot"](this.mScene, this.mWorld, this, tmpX, tmpY, "shopView", "ui/shop/shopView.png", "ui/shop/shopView.json", "shopView_bagSlot", "itemSelectFrame");\r\n            itemSlot.createUI();\r\n            this.mShopItemSlotList.push(itemSlot);\r\n        }\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_5__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_6__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/shop/shopView.png", jsonUrl: "ui/shop/shopView.json"\r\n        });\r\n        this.mClsBtn.x = (this.width >> 1) - 65;\r\n        this.mClsBtn.y = -this.height >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.add(this.mClsBtn);\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        // 异步加载过程中会导致数据过来，面板仍然没有加载完毕，所以缓存数据等ui加载完毕再做显示\r\n        if (this.mShopData) {\r\n            this.refreshDataList();\r\n        }\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ShopPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_ShopMediator__WEBPACK_IMPORTED_MODULE_3__["ShopMediator"].NAME).resize();\r\n    };\r\n    ShopPanel.prototype.refreshDataList = function () {\r\n        if (!this.mShopData) {\r\n            // Logger.getInstance().error("this.mDataList is undefiend");\r\n            return;\r\n        }\r\n        var len = ShopPanel.ShopSlotCount;\r\n        var item;\r\n        for (var i = 0; i < len; i++) {\r\n            item = this.mShopItemSlotList[i];\r\n            if (!item)\r\n                continue;\r\n            item.shopDataChange(this.mShopData.items[i], this.mShopData.id);\r\n        }\r\n    };\r\n    ShopPanel.prototype.shopMedClose = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_ShopMediator__WEBPACK_IMPORTED_MODULE_3__["ShopMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    ShopPanel.ShopSlotCount = 20;\r\n    return ShopPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/ShopPanel.ts?')},"./src/ui/Shop/shop.itemSlot.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShopItemSlot", function() { return ShopItemSlot; });\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../bag/dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _const_res_const__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/res.const */ "./src/const/res.const.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _tips_toolTip__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../tips/toolTip */ "./src/ui/tips/toolTip.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_7__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ShopItemSlot = /** @class */ (function (_super) {\r\n    __extends(ShopItemSlot, _super);\r\n    function ShopItemSlot(scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes, subscriptRes) {\r\n        return _super.call(this, scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes) || this;\r\n    }\r\n    ShopItemSlot.prototype.shopDataChange = function (val, packID) {\r\n        if (!val)\r\n            return;\r\n        this.mPackageID = packID;\r\n        _super.prototype.dataChange.call(this, val);\r\n        var prices = val.price;\r\n        var priceLen = prices.length;\r\n        for (var i = 0; i < priceLen; i++) {\r\n            var png = void 0;\r\n            var key = void 0;\r\n            if (prices[i].coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].CoinType.TU_DING_COIN) {\r\n                key = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getName();\r\n                png = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getPNG();\r\n            }\r\n            this.makeCoin(prices[i], i * 20 + 30);\r\n        }\r\n    };\r\n    ShopItemSlot.prototype.destroy = function () {\r\n        if (this.moneyIcon) {\r\n            this.moneyIcon.destroy(true);\r\n            this.moneyIcon = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ShopItemSlot.prototype.makeCoin = function (price, y) {\r\n        var png;\r\n        var key;\r\n        if (price.coinType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].CoinType.TU_DING_COIN) {\r\n            key = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getName();\r\n            png = _const_res_const__WEBPACK_IMPORTED_MODULE_3__["UI"].TuDing18.getPNG();\r\n        }\r\n        // const moneyIcon = this.mScene.make.image(undefined, false);\r\n        this.moneyIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](this.mScene, 0, 0);\r\n        this.moneyIcon.x = (-this.mWid >> 1) + 15;\r\n        this.moneyIcon.y = y;\r\n        this.toolTipCon.add(this.moneyIcon);\r\n        this.moneyIcon.load(png);\r\n        var priceText = this.mScene.make.text(undefined, false);\r\n        priceText.setFontFamily("Tahoma");\r\n        // priceText.setFontStyle("bold");\r\n        priceText.setFontSize(15);\r\n        priceText.x = -this.mWid / 2 + this.moneyIcon.width + 20;\r\n        priceText.y = y - 9;\r\n        this.toolTipCon.add(priceText);\r\n        priceText.setText(price.price.toString());\r\n    };\r\n    ShopItemSlot.prototype.onLoadCompleteHandler = function () {\r\n        this.mWid = 80;\r\n        this.mHei = 88;\r\n        this.itemBG = this.mScene.make.sprite(undefined, false);\r\n        this.itemBG.setTexture(this.mResStr, this.mResSlot);\r\n        this.itemBG.y = -10;\r\n        this.toolTipCon.setSize(this.mWid, this.mHei);\r\n        this.toolTipCon.addAt(this.itemBG, 0);\r\n        this.mIcon = new _bag_dragDropIcon__WEBPACK_IMPORTED_MODULE_1__["DragDropIcon"](this.mScene, 0, -10);\r\n        this.toolTipCon.addAt(this.mIcon, 1);\r\n        if (this.mSubScriptRes) {\r\n            this.mSubScriptSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSubScriptSprite.setTexture(this.mResStr, this.mSubScriptRes);\r\n            this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.itemBG.width >> 1;\r\n            this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.itemBG.height >> 1;\r\n            // this.con.addAt(this.mSubScriptSprite, 2);\r\n        }\r\n        if (this.isTipBoo) {\r\n            this.toolTip = new _tips_toolTip__WEBPACK_IMPORTED_MODULE_6__["ToolTip"](this.mScene, "itemSlotTip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/toolTip/toolTip.json"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/toolTip/toolTip.png"), this.mWorld.uiScale);\r\n        }\r\n        this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.itemBG.width, 56), Phaser.Geom.Rectangle.Contains);\r\n        this.toolTipCon.on("pointerover", this.overHandler, this);\r\n        this.toolTipCon.on("pointerout", this.outHandler, this);\r\n        this.toolTipCon.on("pointerdown", this.downHandler, this);\r\n        this.toolTipCon.on("pointerup", this.outHandler, this);\r\n        this.minitialize = true;\r\n        if (this.mData) {\r\n            this.dataChange(this.mData);\r\n        }\r\n        this.mSelectSprite = this.mScene.make.sprite(undefined, false);\r\n        this.createTexture(this.mWid, this.mHei);\r\n    };\r\n    ShopItemSlot.prototype.overHandler = function (pointer) {\r\n        _super.prototype.overHandler.call(this, pointer);\r\n        this.mSelectSprite.y -= 10;\r\n    };\r\n    ShopItemSlot.prototype.downHandler = function (pointer) {\r\n        if (!this.mData)\r\n            return;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_7__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = this.mPackageID;\r\n        content.componentId = this.mData.id;\r\n        this.mWorld.connection.send(pkt);\r\n    };\r\n    ShopItemSlot.prototype.outHandler = function (pointer) {\r\n        _super.prototype.outHandler.call(this, pointer);\r\n    };\r\n    ShopItemSlot.prototype.createTexture = function (wid, hei) {\r\n        var COLOR_BG = 0xAAA9A9;\r\n        var COLOR_LINE = 0xAAA9A9;\r\n        var bgGraphics = this.mScene.add.graphics();\r\n        bgGraphics.fillStyle(COLOR_BG, .3);\r\n        bgGraphics.fillRoundedRect(0, 0, wid, hei, 5);\r\n        bgGraphics.generateTexture("selectBg", wid, hei);\r\n        bgGraphics.clear();\r\n    };\r\n    return ShopItemSlot;\r\n}(_bag_item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Shop/shop.itemSlot.ts?')},"./src/ui/Task/Task.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Task", function() { return Task; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Task = /** @class */ (function (_super) {\r\n    __extends(Task, _super);\r\n    function Task(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Task.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_QUEST_LIST, this.onRetQuestList);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_PKT_QUERY_QUEST_DETAIL, this.onRetQuestDetail);\r\n        }\r\n    };\r\n    Task.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Task.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Task.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Task.prototype.destroy = function () {\r\n        this.unregister();\r\n        this.mEvent.destroy();\r\n    };\r\n    Object.defineProperty(Task.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Task.prototype.queryQuestList = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_QUEST_LIST);\r\n        this.connection.send(packet);\r\n    };\r\n    Task.prototype.queryQuestDetail = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_QUERY_QUEST_DETAIL);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    Task.prototype.querySubmitQuest = function (id) {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_PKT_SUBMIT_QUEST);\r\n        var content = packet.content;\r\n        content.id = id;\r\n        this.connection.send(packet);\r\n    };\r\n    Task.prototype.onRetQuestList = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("questlist", content.quests);\r\n    };\r\n    Task.prototype.onRetQuestDetail = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("questdetail", content.quest);\r\n    };\r\n    return Task;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Task/Task.ts?')},"./src/ui/Task/TaskMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskMediator", function() { return TaskMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _Task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Task */ "./src/ui/Task/Task.ts");\n/* harmony import */ var _TaskPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TaskPanel */ "./src/ui/Task/TaskPanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar TaskMediator = /** @class */ (function (_super) {\r\n    __extends(TaskMediator, _super);\r\n    function TaskMediator(layerMgr, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.layerMgr = layerMgr;\r\n        _this.world = worldService;\r\n        return _this;\r\n    }\r\n    TaskMediator.prototype.show = function () {\r\n        if ((this.mView && this.mView.isShow()) || this.mShow) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _TaskPanel__WEBPACK_IMPORTED_MODULE_2__["TaskPanel"](this.scene, this.world);\r\n            this.mView.on("hide", this.onHideView, this);\r\n            this.mView.on("questlist", this.onQueryQuestList, this);\r\n            this.mView.on("questdetail", this.onQueryQuestDetail, this);\r\n            this.mView.on("submitquest", this.onQuerySubmitQuest, this);\r\n        }\r\n        if (!this.task) {\r\n            this.task = new _Task__WEBPACK_IMPORTED_MODULE_1__["Task"](this.world);\r\n            this.task.register();\r\n            this.task.on("questlist", this.onRetQuestList, this);\r\n            this.task.on("questdetail", this.onRetQuestDetail, this);\r\n        }\r\n        this.layerMgr.addToUILayer(this.mView);\r\n        this.mView.show();\r\n    };\r\n    TaskMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    TaskMediator.prototype.destroy = function () {\r\n        if (this.task) {\r\n            this.task.destroy();\r\n            this.task = undefined;\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = undefined;\r\n        }\r\n    };\r\n    TaskMediator.prototype.onHideView = function () {\r\n        this.destroy();\r\n    };\r\n    TaskMediator.prototype.onQueryQuestList = function () {\r\n        this.task.queryQuestList();\r\n    };\r\n    TaskMediator.prototype.onQueryQuestDetail = function (id) {\r\n        this.task.queryQuestDetail(id);\r\n    };\r\n    TaskMediator.prototype.onQuerySubmitQuest = function (id) {\r\n        this.task.querySubmitQuest(id);\r\n    };\r\n    TaskMediator.prototype.onRetQuestList = function (quests) {\r\n        this.mView.setTaskDatas(quests);\r\n    };\r\n    TaskMediator.prototype.onRetQuestDetail = function (quest) {\r\n        this.mView.setTaskDetail(quest);\r\n    };\r\n    return TaskMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Task/TaskMediator.ts?')},"./src/ui/Task/TaskPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskPanel", function() { return TaskPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ui.atals.name */ "./src/ui/ui.atals.name.ts");\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../i18n */ "./src/i18n.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\n/* harmony import */ var _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/scroller/GameScroller */ "./lib/rexui/lib/ui/scroller/GameScroller.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/NineSliceButton */ "./lib/rexui/lib/ui/button/NineSliceButton.ts");\n/* harmony import */ var _Handler_Handler__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../Handler/Handler */ "./src/Handler/Handler.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar TaskPanel = /** @class */ (function (_super) {\r\n    __extends(TaskPanel, _super);\r\n    function TaskPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "task_ui";\r\n        _this.taskItems = [];\r\n        _this.scale = 1;\r\n        return _this;\r\n    }\r\n    TaskPanel.prototype.resize = function (width, height) {\r\n        var w = this.scaleWidth;\r\n        var h = this.scaleHeight;\r\n        _super.prototype.resize.call(this, w, h);\r\n        this.setSize(w, h);\r\n        this.blackBg.clear();\r\n        this.blackBg.fillStyle(0, 0.5);\r\n        this.blackBg.fillRoundedRect(-this.x, -this.y, w, h);\r\n        this.content.x = w * 0.5;\r\n        this.content.y = h * 0.5;\r\n        this.mGameScroll.refreshMask();\r\n        this.blackBg.setInteractive(new Phaser.Geom.Rectangle(0, 0, w, h), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    TaskPanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (this.mPreLoad)\r\n            return;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n        this.setInteractive();\r\n        this.addListen();\r\n    };\r\n    TaskPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.on("pointerup", this.OnClosePanel, this);\r\n    };\r\n    TaskPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.closeBtn.off("pointerup", this.OnClosePanel, this);\r\n    };\r\n    TaskPanel.prototype.preload = function () {\r\n        this.addAtlas(this.key, "task/task.png", "task/task.json");\r\n        this.addAtlas(_ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasKey"].commonKey, _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasName"].commonUrl + ".png", _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasName"].commonUrl + ".json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    TaskPanel.prototype.init = function () {\r\n        this.setSize(this.scaleWidth, this.scaleWidth);\r\n        this.blackBg = this.scene.make.graphics(undefined, false);\r\n        this.add(this.blackBg);\r\n        var conWdith = 300 * this.dpr;\r\n        var conHeight = 418 * this.dpr;\r\n        this.content = this.scene.make.container(undefined, false);\r\n        this.content.setSize(conWdith, conHeight);\r\n        this.add(this.content);\r\n        this.bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_11__["NineSlicePatch"](this.scene, 0, 0, conWdith, conHeight, _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasKey"].commonKey, "bg", {\r\n            left: 40,\r\n            top: 40,\r\n            bottom: 40,\r\n            right: 40,\r\n        });\r\n        var bgwidth = this.bg.width;\r\n        var bgHeight = this.bg.height;\r\n        var posY = -this.bg.height * 0.5;\r\n        this.titlebg = this.scene.make.image({ x: 0, y: posY, key: this.key, frame: "title" });\r\n        this.titlebg.y = posY - this.titlebg.height * 0.5 + 20 * this.dpr;\r\n        var mfont = "bold " + 15 * this.dpr + "px Source Han Sans";\r\n        this.tilteName = this.scene.make.text({ x: 0, y: posY - 12 * this.dpr, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.title"), style: { font: mfont, color: "#8F4300", fontSize: 15 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0.5, 0);\r\n        this.closeBtn = this.scene.make.image({ x: this.bg.width * 0.5 - this.dpr * 5, y: posY + this.dpr * 5, key: _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasKey"].commonKey, frame: "close" });\r\n        this.tilteName.setStroke("#8F4300", 1);\r\n        this.closeBtn.setInteractive();\r\n        var optionWidth = 253 * this.dpr;\r\n        var optionHeight = 26 * this.dpr;\r\n        this.optionBtn = this.scene.make.text({ x: 0, y: 0, text: "全部", style: { color: "#8F4300", fontSize: 20 * this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0.5);\r\n        this.optionBtn.setInteractive();\r\n        this.optionBtn.on("pointerup", this.onOpenOptionHandler, this);\r\n        this.optionArrow = this.scene.make.image({ x: 0, y: 0, key: this.key, frame: "drop_down" });\r\n        this.optionBtn.x = -bgwidth * 0.5 + 50 * this.dpr;\r\n        this.optionBtn.y = -bgHeight * 0.5 + 30 * this.dpr;\r\n        this.optionArrow.x = this.optionBtn.x + 30 * this.dpr;\r\n        this.optionArrow.y = -bgHeight * 0.5 + 30 * this.dpr;\r\n        var optionLine = this.scene.make.graphics(undefined, false);\r\n        optionLine.clear();\r\n        optionLine.fillStyle(0xc0c0c0, 1);\r\n        optionLine.fillRect(-optionWidth * 0.5, -1, optionWidth, 2);\r\n        optionLine.y = -bgHeight * 0.5 + 50 * this.dpr;\r\n        this.optionCon = this.scene.make.container(undefined, false);\r\n        this.optionCon.visible = false;\r\n        this.optionCon.y = -bgHeight * 0.5 + 50 * this.dpr;\r\n        this.mGameScroll = new _lib_rexui_lib_ui_scroller_GameScroller__WEBPACK_IMPORTED_MODULE_7__["GameScroller"](this.scene, {\r\n            x: 0,\r\n            y: 18 * this.dpr,\r\n            width: bgwidth,\r\n            height: bgHeight - 70 * this.dpr,\r\n            zoom: this.scale,\r\n            align: 2,\r\n            orientation: 0,\r\n            space: 20 * this.dpr\r\n        });\r\n        this.content.add([this.bg, this.closeBtn, this.titlebg, this.tilteName, this.mGameScroll, this.optionBtn, this.optionArrow, optionLine, this.optionCon]);\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n        this.emit("questlist");\r\n    };\r\n    TaskPanel.prototype.setTaskDatas = function (quests) {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (this.curTaskItem)\r\n            this.curTaskItem.setExtend(false);\r\n        this.taskDatas = quests;\r\n        this.setTaskOptions();\r\n        this.setTaskItems(quests);\r\n        this.onTaskOptionHandler(this.curOptionItem);\r\n    };\r\n    TaskPanel.prototype.setTaskOptions = function () {\r\n        var enumArr = [0];\r\n        var PKT_Quest_Type = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type;\r\n        for (var key in PKT_Quest_Type) {\r\n            var enumValue = Number(key);\r\n            if (!isNaN(enumValue)) {\r\n                var questEnum = enumValue;\r\n                enumArr.push(questEnum);\r\n            }\r\n        }\r\n        var list = this.optionCon.list;\r\n        for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {\r\n            var option = list_1[_i];\r\n            option.visible = false;\r\n        }\r\n        for (var i = 0; i < enumArr.length; i++) {\r\n            var option = void 0;\r\n            if (i < list.length) {\r\n                option = list[i];\r\n            }\r\n            else {\r\n                option = new TaskOption(this.scene, this.key, this.dpr, this.scale);\r\n                option.setHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_9__["Handler"](this, this.onTaskOptionHandler));\r\n                this.optionCon.add(option);\r\n            }\r\n            option.visible = true;\r\n            option.setOptionData(enumArr[i]);\r\n        }\r\n        var value = 0;\r\n        var offsety = 2;\r\n        for (var _a = 0, list_2 = list; _a < list_2.length; _a++) {\r\n            var item = list_2[_a];\r\n            item.y = item.height * item.originY + value;\r\n            value += item.height + offsety;\r\n        }\r\n        if (!this.curOptionItem)\r\n            this.curOptionItem = list[0];\r\n    };\r\n    TaskPanel.prototype.setTaskDetail = function (quest) {\r\n        if (this.curTaskItem && quest) {\r\n            if (this.curTaskItem.questData.id === quest.id) {\r\n                this.curTaskItem.setTaskDetail(quest);\r\n            }\r\n        }\r\n    };\r\n    TaskPanel.prototype.setTaskItems = function (quests) {\r\n        for (var _i = 0, _a = this.taskItems; _i < _a.length; _i++) {\r\n            var item = _a[_i];\r\n            var task = item;\r\n            task.visible = false;\r\n        }\r\n        for (var i = 0; i < quests.length; i++) {\r\n            var item = void 0;\r\n            if (i < this.taskItems.length) {\r\n                item = this.taskItems[i];\r\n            }\r\n            else {\r\n                item = new TaskItem(this.scene, this.key, this.dpr, this.scale);\r\n                this.mGameScroll.addItem(item);\r\n                item.setHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_9__["Handler"](this, this.onExtendsHandler), new _Handler_Handler__WEBPACK_IMPORTED_MODULE_9__["Handler"](this, this.onFinishHandler));\r\n                this.taskItems.push(item);\r\n            }\r\n            item.setTaskData(quests[i]);\r\n            item.visible = true;\r\n        }\r\n        this.mGameScroll.Sort();\r\n    };\r\n    TaskPanel.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TaskPanel.prototype.OnClosePanel = function () {\r\n        this.emit("hide");\r\n    };\r\n    TaskPanel.prototype.onFinishHandler = function (id) {\r\n        this.emit("submitquest", id);\r\n    };\r\n    TaskPanel.prototype.onExtendsHandler = function (isExtend, item) {\r\n        if (this.curTaskItem) {\r\n            this.curTaskItem.setExtend(false, false);\r\n        }\r\n        this.curTaskItem = item;\r\n        if (isExtend) {\r\n            this.emit("questdetail", item.questData.id);\r\n        }\r\n        else\r\n            this.curTaskItem = null;\r\n        this.mGameScroll.Sort(true);\r\n    };\r\n    TaskPanel.prototype.onOpenOptionHandler = function () {\r\n        var visible = this.optionCon.visible;\r\n        this.optionCon.visible = !visible;\r\n        this.optionArrow.scaleY = (visible ? -1 : 1);\r\n    };\r\n    TaskPanel.prototype.onTaskOptionHandler = function (taskOption) {\r\n        var list = this.optionCon.list;\r\n        for (var _i = 0, list_3 = list; _i < list_3.length; _i++) {\r\n            var option = list_3[_i];\r\n            option.changeNormal();\r\n        }\r\n        var optionData = taskOption.optionData;\r\n        var arr;\r\n        if (optionData === 0) {\r\n            arr = this.taskDatas;\r\n        }\r\n        else {\r\n            arr = this.taskDatas.filter(function (data) {\r\n                if (data.questType === taskOption.optionData)\r\n                    return true;\r\n                else\r\n                    return false;\r\n            });\r\n        }\r\n        this.setTaskItems(arr);\r\n        this.optionCon.visible = false;\r\n        this.curOptionItem = taskOption;\r\n        taskOption.changeDown();\r\n    };\r\n    return TaskPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar TaskItem = /** @class */ (function (_super) {\r\n    __extends(TaskItem, _super);\r\n    function TaskItem(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        _this.zoom = zoom;\r\n        var width = 254 * dpr;\r\n        var height = 45 * dpr;\r\n        _this.content = scene.make.container(undefined, false);\r\n        _this.content.setSize(width, height);\r\n        _this.bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_11__["NineSlicePatch"](_this.scene, 0, 0, width, height, key, "main_bg", {\r\n            left: 6 * dpr,\r\n            top: 6 * dpr,\r\n            bottom: 6 * dpr,\r\n            right: 6 * dpr,\r\n        });\r\n        var posx = -width * 0.5, posy = -height * 0.5;\r\n        var headbg = scene.make.image({ key: key, frame: "head_border" });\r\n        headbg.x = posx + 25 * dpr;\r\n        _this.headIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](scene, headbg.x, 0);\r\n        _this.headIcon.setTexture(key, "head_test");\r\n        _this.typeBg = scene.make.image({ key: key, frame: "tag_main" });\r\n        _this.typeBg.setPosition(posx + _this.typeBg.width * 0.5, posy + _this.typeBg.height * 0.5 - 2 * dpr);\r\n        _this.typeTex = scene.make.text({ x: 0, y: 0, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.m"), style: { color: "#ffffff", fontSize: 10 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } });\r\n        _this.typeTex.setOrigin(0.5).setPosition(_this.typeBg.x - 1 * dpr, _this.typeBg.y);\r\n        _this.taskName = scene.make.text({ x: _this.headIcon.x + 20 * dpr, y: -9 * dpr, text: "获得两把钥匙", style: { color: "#ffffff", fontSize: 13 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        _this.taskDes = scene.make.text({ x: _this.headIcon.x + 25 * dpr, y: 10 * dpr, text: "任务要求获得两把钥匙", style: { color: "#ffffff", fontSize: 12 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        _this.finish = scene.make.image({ key: key, frame: "done" });\r\n        _this.finish.setPosition(width * 0.5 - 30 * dpr, 4 * dpr);\r\n        _this.openBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_6__["Button"](scene, key, "open", "open");\r\n        _this.setExtendBtn(_this.openBtn);\r\n        _this.openBtn.setPosition(width * 0.5 - 25 * dpr, 4 * dpr);\r\n        _this.closeBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_6__["Button"](scene, key, "close");\r\n        _this.setExtendBtn(_this.closeBtn);\r\n        _this.closeBtn.setPosition(_this.openBtn.x, _this.openBtn.y).visible = false;\r\n        _this.openBtn.on("Tap", _this.onOpenHandler, _this);\r\n        _this.closeBtn.on("Tap", _this.onCloseHandler, _this);\r\n        _this.content.add([_this.bg, headbg, _this.headIcon, _this.typeBg, _this.typeTex, _this.taskName, _this.taskDes, _this.finish, _this.openBtn, _this.closeBtn]);\r\n        _this.add(_this.content);\r\n        _this.setSize(width, height);\r\n        return _this;\r\n    }\r\n    TaskItem.prototype.setTaskData = function (data) {\r\n        this.questData = data;\r\n        var typeTag = this.getQuestTypeTag(data.questType);\r\n        this.typeBg.setFrame(typeTag[0]);\r\n        this.typeTex.text = typeTag[1];\r\n        this.setTextLimit(this.taskName, typeTag[2] + data.name, 12);\r\n        this.bg.setFrame(typeTag[3]);\r\n        // this.taskDes.text = data.detail;\r\n        this.setTextLimit(this.taskDes, data.detail);\r\n        this.taskDes.setColor(typeTag[4]);\r\n        this.finish.visible = (data.stage === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED);\r\n    };\r\n    TaskItem.prototype.setTaskDetail = function (data) {\r\n        var typeTag = this.getQuestTypeTag(data.questType);\r\n        if (this.extend)\r\n            this.extend.setItemData(data, typeTag[5]);\r\n    };\r\n    TaskItem.prototype.setHandler = function (extend, finish) {\r\n        this.extendHandler = extend;\r\n        this.finishHandler = finish;\r\n    };\r\n    TaskItem.prototype.setExtend = function (isExtend, haveCallBack) {\r\n        if (haveCallBack === void 0) { haveCallBack = true; }\r\n        if (isExtend) {\r\n            if (haveCallBack)\r\n                this.onOpenHandler();\r\n            else\r\n                this.openExtend();\r\n        }\r\n        else {\r\n            if (haveCallBack)\r\n                this.onCloseHandler();\r\n            else\r\n                this.closeExtend();\r\n        }\r\n    };\r\n    TaskItem.prototype.onOpenHandler = function () {\r\n        this.openExtend();\r\n        if (this.extendHandler)\r\n            this.extendHandler.runWith([true, this]);\r\n    };\r\n    TaskItem.prototype.openExtend = function () {\r\n        if (!this.extend) {\r\n            this.extend = new TaskItemExtend(this.scene, this.key, this.dpr, this.zoom);\r\n            this.extend.setFinishHandler(new _Handler_Handler__WEBPACK_IMPORTED_MODULE_9__["Handler"](this, this.onFinishHandler));\r\n            this.add(this.extend);\r\n            this.extend.y = this.height * 0.5 + this.extend.height * 0.5;\r\n        }\r\n        this.extend.visible = true;\r\n        this.height = this.content.height + this.extend.height;\r\n        this.content.y = -this.height * 0.5 + this.content.height * 0.5;\r\n        this.extend.y = -this.height * 0.5 + this.content.height + this.extend.height * 0.5;\r\n        this.openBtn.visible = false;\r\n        this.closeBtn.visible = true;\r\n    };\r\n    TaskItem.prototype.setExtendBtn = function (button) {\r\n        var width = 60 * this.dpr;\r\n        var height = 60 * this.dpr;\r\n        var bg = this.scene.make.graphics(undefined, false);\r\n        bg.clear();\r\n        bg.fillStyle(0xF6F6F6, 0);\r\n        bg.fillRect(-width * 0.5, -height * 0.5, width, height);\r\n        button.addAt(bg, 0);\r\n        button.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    TaskItem.prototype.onFinishHandler = function () {\r\n        if (this.finishHandler)\r\n            this.finishHandler.runWith(this.questData.id);\r\n    };\r\n    TaskItem.prototype.onCloseHandler = function () {\r\n        this.closeExtend();\r\n        if (this.extendHandler)\r\n            this.extendHandler.runWith([false, this]);\r\n    };\r\n    TaskItem.prototype.closeExtend = function () {\r\n        if (this.extend)\r\n            this.extend.visible = false;\r\n        this.height = this.content.height;\r\n        this.content.y = 0;\r\n        this.openBtn.visible = true;\r\n        this.closeBtn.visible = false;\r\n    };\r\n    TaskItem.prototype.getQuestTypeTag = function (questType) {\r\n        var typeTag = [];\r\n        if (questType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_MAIN_MISSION) {\r\n            typeTag[0] = "tag_main";\r\n            typeTag[1] = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.m");\r\n            typeTag[2] = "【主线】";\r\n            typeTag[3] = "main_bg";\r\n            typeTag[4] = "#4C42C8";\r\n            typeTag[5] = "#8780E0";\r\n            return typeTag;\r\n        }\r\n        else if (questType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_SIDE_MISSION) {\r\n            typeTag[0] = "tag_side";\r\n            typeTag[1] = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.s");\r\n            typeTag[2] = "【支线】";\r\n            typeTag[3] = "side_bg";\r\n            typeTag[4] = "#CB0A1D";\r\n            typeTag[5] = "#F4919B";\r\n            return typeTag;\r\n        }\r\n        else if (questType === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_DAILY_GOAL) {\r\n            typeTag[0] = "tag_daly";\r\n            typeTag[1] = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.d");\r\n            typeTag[2] = "【每日】";\r\n            typeTag[3] = "daly_bg";\r\n            typeTag[4] = "#866107";\r\n            typeTag[5] = "#F1D56C";\r\n            return typeTag;\r\n        }\r\n    };\r\n    TaskItem.prototype.setTextLimit = function (text, content, limit) {\r\n        if (limit === void 0) { limit = 15; }\r\n        if (content.length > limit) {\r\n            var maxWidth = 155 * this.dpr;\r\n            for (var i = 4; i < content.length; i++) {\r\n                var str = content.slice(0, i);\r\n                var width = text.setText(str).width;\r\n                if (width > maxWidth) {\r\n                    str += "...";\r\n                    text.setText(str);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            text.setText(content);\r\n        }\r\n    };\r\n    return TaskItem;\r\n}(Phaser.GameObjects.Container));\r\nvar TaskItemExtend = /** @class */ (function (_super) {\r\n    __extends(TaskItemExtend, _super);\r\n    function TaskItemExtend(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.needArr = [];\r\n        _this.rewardArr = [];\r\n        _this.dpr = 0;\r\n        _this.zoom = 0;\r\n        var width = 253 * dpr;\r\n        var height = 202 * dpr;\r\n        _this.dpr = dpr;\r\n        var bg = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_11__["NineSlicePatch"](_this.scene, 0, 0, width, height, key, "detail_bg", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        var posx = -width * 0.5 + 10 * dpr;\r\n        var posy = -height * 0.5 + 5 * dpr;\r\n        _this.taskLabel = scene.make.text({ x: posx, y: posy, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.objective"), style: { color: "#8F4300", fontSize: 12 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } });\r\n        _this.taskTex = scene.make.text({ x: posx, y: posy + 18 * dpr, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.collect_materials"), style: { color: "#8F4300", fontSize: 12 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } });\r\n        _this.taskTex.setWordWrapWidth(width - 10 * dpr, true);\r\n        _this.rewardLabel = scene.make.text({ x: posx, y: posy + 90 * dpr, text: _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.rewards"), style: { color: "#8F4300", fontSize: 12 * _this.dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } });\r\n        var line = scene.make.image({ key: key, frame: "reward_cutline" });\r\n        line.setPosition(0, posy + 110 * dpr);\r\n        _this.line = line;\r\n        _this.finishBtn = new _lib_rexui_lib_ui_button_NineSliceButton__WEBPACK_IMPORTED_MODULE_8__["NineSliceButton"](_this.scene, Math.ceil(width * 0.5 - 40 * _this.dpr), Math.ceil(height * 0.5 - 25 * _this.dpr), 60 * _this.dpr, 30 * _this.dpr, _ui_atals_name__WEBPACK_IMPORTED_MODULE_3__["UIAtlasKey"].commonKey, "button_g", _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.submit_task"), _this.dpr, _this.scale, {\r\n            left: 12 * _this.dpr,\r\n            top: 12 * _this.dpr,\r\n            right: 12 * _this.dpr,\r\n            bottom: 12 * _this.dpr\r\n        });\r\n        _this.finishBtn.setTextStyle({ fontSize: 12 * dpr, color: "#000000" });\r\n        _this.finishBtn.on("Tap", _this.onFinishHandler, _this);\r\n        _this.add([bg, _this.taskLabel, _this.taskTex, _this.rewardLabel, line, _this.finishBtn]);\r\n        _this.setSize(width, height);\r\n        _this.key = key;\r\n        _this.zoom = zoom;\r\n        _this.finishBtn.visible = false;\r\n        return _this;\r\n    }\r\n    TaskItemExtend.prototype.setItemData = function (questData, color) {\r\n        this.taskLabel.setColor(color);\r\n        this.taskTex.setColor(color);\r\n        this.rewardLabel.setColor(color);\r\n        var taskPosy = 0;\r\n        var cellHeight = 33 * this.dpr;\r\n        this.taskTex.text = this.getTaskTargetText(questData);\r\n        this.createTaskCells(this.needArr, questData.targets, true);\r\n        taskPosy = this.taskTex.y + this.taskTex.height + 5 * this.dpr;\r\n        if (questData.targets.length > 0) {\r\n            taskPosy += cellHeight * 0.5;\r\n            this.sortItem(this.needArr, taskPosy);\r\n            taskPosy += cellHeight * 0.5 + 8 * this.dpr;\r\n        }\r\n        this.rewardLabel.y = taskPosy;\r\n        taskPosy += this.rewardLabel.height + 5 * this.dpr;\r\n        this.line.y = taskPosy;\r\n        taskPosy += 5 * this.dpr;\r\n        this.createTaskCells(this.rewardArr, questData.rewards, false);\r\n        taskPosy += cellHeight * 0.5;\r\n        this.sortItem(this.rewardArr, taskPosy);\r\n        this.finishBtn.visible = (questData.stage === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Stage.PKT_QUEST_STAGE_FINISHED);\r\n    };\r\n    TaskItemExtend.prototype.setFinishHandler = function (comp) {\r\n        this.finishHandler = comp;\r\n    };\r\n    TaskItemExtend.prototype.sortItem = function (taskcells, posY) {\r\n        if (posY === void 0) { posY = 0; }\r\n        var posx = -this.width * 0.5 + 10 * this.dpr;\r\n        var list = taskcells;\r\n        var value = 0;\r\n        var offsetx = 10 * this.dpr;\r\n        for (var _i = 0, list_4 = list; _i < list_4.length; _i++) {\r\n            var item = list_4[_i];\r\n            item.x = posx + item.width * item.originX + value;\r\n            item.y = posY;\r\n            value += item.width + offsetx;\r\n        }\r\n    };\r\n    TaskItemExtend.prototype.createTaskCells = function (arr, dataArr, isTask) {\r\n        if (isTask === void 0) { isTask = true; }\r\n        for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\r\n            var item = arr_1[_i];\r\n            item.visible = false;\r\n        }\r\n        for (var i = 0; i < dataArr.length; i++) {\r\n            var item = void 0;\r\n            if (i < arr.length) {\r\n                item = arr[i];\r\n            }\r\n            else {\r\n                item = new TaskCell(this.scene, this.key, this.dpr, this.zoom);\r\n                arr.push(item);\r\n                this.add(item);\r\n            }\r\n            item.visible = true;\r\n            item.setCellData(dataArr[i], isTask);\r\n        }\r\n        return arr;\r\n    };\r\n    TaskItemExtend.prototype.onFinishHandler = function () {\r\n        if (this.finishHandler)\r\n            this.finishHandler.run();\r\n    };\r\n    TaskItemExtend.prototype.getTaskTargetText = function (questData) {\r\n        var targets = questData.targets;\r\n        var text = questData.detail;\r\n        // if (targets.length === 0) {\r\n        //     text = questData.detail;\r\n        // } else {\r\n        //     text = i18n.t("task.collect_materials");\r\n        //     for (const item of targets) {\r\n        //         text += `${item.name}*${item.neededCount}`;\r\n        //     }\r\n        // }\r\n        return text;\r\n    };\r\n    return TaskItemExtend;\r\n}(Phaser.GameObjects.Container));\r\nvar TaskCell = /** @class */ (function (_super) {\r\n    __extends(TaskCell, _super);\r\n    function TaskCell(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.key = key;\r\n        _this.dpr = dpr;\r\n        _this.bg = scene.make.image({ key: key, frame: "task_bg" });\r\n        _this.setSize(_this.bg.width, _this.bg.height);\r\n        _this.itemIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_5__["DynamicImage"](scene, 0, 0);\r\n        _this.countTex = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_11__["BBCodeText"](_this.scene, 0, 0, {})\r\n            .setOrigin(0.5).setFontSize(12 * dpr).setFontFamily(_utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT);\r\n        _this.countTex.setPosition(_this.width * 0.5, _this.height * 0.5 - 2 * dpr);\r\n        _this.add([_this.bg, _this.itemIcon, _this.countTex]);\r\n        return _this;\r\n    }\r\n    TaskCell.prototype.setCellData = function (itemData, isTask) {\r\n        var _this = this;\r\n        if (isTask === void 0) { isTask = true; }\r\n        var frame = isTask ? "task_bg" : "reward_bg";\r\n        this.bg.setTexture(this.key, frame);\r\n        var url = _utils_resUtil__WEBPACK_IMPORTED_MODULE_10__["Url"].getOsdRes(itemData.display.texturePath);\r\n        this.itemIcon.load(url, this, function () {\r\n            _this.itemIcon.scale = _this.dpr * 0.6;\r\n        });\r\n        if (!isTask) {\r\n            this.countTex.text = "[stroke=#666666][color=#666666]" + itemData.count + "[/color][/stroke]/";\r\n        }\r\n        else {\r\n            this.countTex.text = this.getCountText(itemData.count, itemData.neededCount);\r\n        }\r\n    };\r\n    TaskCell.prototype.getCountText = function (count, needcount) {\r\n        var color = (count >= needcount ? "#0054FF" : "#FF2B2B");\r\n        var countText = "[stroke=" + color + "][color=" + color + "]" + count + "[/color][/stroke]/";\r\n        var needText = "[stroke=#2D2D2D][color=#2D2D2D]" + needcount + "[/color][/stroke]/";\r\n        var text = countText + needText;\r\n        return text;\r\n    };\r\n    return TaskCell;\r\n}(Phaser.GameObjects.Container));\r\nvar TaskOption = /** @class */ (function (_super) {\r\n    __extends(TaskOption, _super);\r\n    function TaskOption(scene, key, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.dpr = 0;\r\n        var width = 256 * dpr;\r\n        var height = 30 * dpr;\r\n        _this.dpr = dpr;\r\n        _this.bg = scene.make.graphics(undefined, false);\r\n        _this.text = scene.make.text({ x: 0, y: 0, text: "全部", style: { color: "#666666", fontSize: 15 * dpr, fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT } }).setOrigin(0, 0.5);\r\n        _this.bg.clear();\r\n        _this.bg.fillStyle(0xF6F6F6, 1);\r\n        _this.bg.fillRect(-width * 0.5, -height * 0.5, width, height);\r\n        var optionLine = _this.scene.make.graphics(undefined, false);\r\n        optionLine.clear();\r\n        optionLine.fillStyle(0xcccccc, 1);\r\n        optionLine.fillRect(-width * 0.5, height * 0.5, width, 2);\r\n        _this.add([_this.bg, _this.text, optionLine]);\r\n        _this.setSize(width, height);\r\n        _this.bg.setInteractive(new Phaser.Geom.Rectangle(-width * 0.5, -height * 0.5, width, height), Phaser.Geom.Rectangle.Contains);\r\n        _this.bg.on("pointerup", _this.onClickHandler, _this);\r\n        return _this;\r\n    }\r\n    TaskOption.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.text.setPosition(-width * 0.5 + 20 * this.dpr, 0);\r\n        this.changeNormal();\r\n        return this;\r\n    };\r\n    TaskOption.prototype.setOptionData = function (data) {\r\n        this.optionData = data;\r\n        if (data === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_MAIN_MISSION) {\r\n            this.text.text = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.main_quest");\r\n        }\r\n        else if (data === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_SIDE_MISSION) {\r\n            this.text.text = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.side_quest");\r\n        }\r\n        else if (data === pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_pkt_def"].PKT_Quest_Type.QUEST_DAILY_GOAL) {\r\n            this.text.text = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.daily_quest");\r\n        }\r\n        else {\r\n            this.text.text = _i18n__WEBPACK_IMPORTED_MODULE_4__["i18n"].t("task.all_task");\r\n        }\r\n    };\r\n    TaskOption.prototype.changeDown = function () {\r\n        this.bg.clear();\r\n        this.bg.fillStyle(0xDFE6FF, 1);\r\n        this.bg.fillRect(-this.width * 0.5, -this.height * 0.5, this.width, this.height);\r\n    };\r\n    TaskOption.prototype.changeNormal = function () {\r\n        this.bg.clear();\r\n        this.bg.fillStyle(0xF6F6F6, 1);\r\n        this.bg.fillRect(-this.width * 0.5, -this.height * 0.5, this.width, this.height);\r\n    };\r\n    TaskOption.prototype.setHandler = function (handler) {\r\n        this.clickHandler = handler;\r\n    };\r\n    TaskOption.prototype.onClickHandler = function () {\r\n        if (this.clickHandler)\r\n            this.clickHandler.runWith(this);\r\n    };\r\n    return TaskOption;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/Task/TaskPanel.ts?')},"./src/ui/UserInfo/UserInfoMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserInfoMediator", function() { return UserInfoMediator; });\n/* harmony import */ var _UserInfoPanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./UserInfoPanel */ "./src/ui/UserInfo/UserInfoPanel.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar UserInfoMediator = /** @class */ (function (_super) {\r\n    __extends(UserInfoMediator, _super);\r\n    function UserInfoMediator(mLayerManager, mScene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mLayerManager = mLayerManager;\r\n        _this.mScene = mScene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    UserInfoMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    UserInfoMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    UserInfoMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    UserInfoMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    UserInfoMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize();\r\n    };\r\n    UserInfoMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!param || param.length === 0) {\r\n            return;\r\n        }\r\n        this.mView = new _UserInfoPanel__WEBPACK_IMPORTED_MODULE_0__["UserInfoPanel"](this.mScene, this.world);\r\n        this.mView.show(param[0]);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    UserInfoMediator.prototype.destroy = function () {\r\n        if (this.mView)\r\n            this.mView.destroy();\r\n    };\r\n    UserInfoMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    UserInfoMediator.prototype.onClosePanel = function () {\r\n        this.hide();\r\n    };\r\n    UserInfoMediator.NAME = "UserInfoMediator";\r\n    return UserInfoMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_2__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserInfo/UserInfoMediator.ts?')},"./src/ui/UserInfo/UserInfoPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserInfoPanel", function() { return UserInfoPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _UserInfoMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./UserInfoMediator */ "./src/ui/UserInfo/UserInfoMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar UserInfoPanel = /** @class */ (function (_super) {\r\n    __extends(UserInfoPanel, _super);\r\n    function UserInfoPanel(scene, worldService) {\r\n        var _this = _super.call(this, scene, worldService) || this;\r\n        _this.mBadgeImages = [];\r\n        _this.mWorld = worldService;\r\n        return _this;\r\n    }\r\n    UserInfoPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.setData("data", param);\r\n        this.setInfo(param);\r\n    };\r\n    UserInfoPanel.prototype.hide = function () {\r\n        this.clearBadge();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    UserInfoPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - this.width - 8;\r\n        this.y = size.height - 100 - (this.height);\r\n    };\r\n    UserInfoPanel.prototype.setInfo = function (data) {\r\n        var _this = this;\r\n        if (!this.mInitialized || !data)\r\n            return;\r\n        if (data.actors.length === 0) {\r\n            return;\r\n        }\r\n        var actor = data.actors[0];\r\n        this.mWorld.httpService.userDetail(actor.platformId).then(function (response) {\r\n            if (response.code === 200) {\r\n                var resData = response.data;\r\n                if (resData) {\r\n                    _this.mActor.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes("show/" + resData.username + ".png"), _this, undefined, _this.loadDefaultAvatar);\r\n                    _this.mNickName.setText(resData.nickname);\r\n                    _this.mLv.setText(resData.level);\r\n                }\r\n            }\r\n        });\r\n        this.mWorld.httpService.badgecards(actor.platformId).then(function (response) {\r\n            if (response.code === 200) {\r\n                _this.createBadge(response.data);\r\n            }\r\n        });\r\n        this.updateFollwer(actor.platformId);\r\n    };\r\n    UserInfoPanel.prototype.destroy = function () {\r\n        if (this.mActor) {\r\n            this.mActor.destroy(true);\r\n            this.mActor = null;\r\n        }\r\n        if (this.mBadgeImages) {\r\n            this.mBadgeImages.forEach(function (image) {\r\n                image.destroy(true);\r\n                image = null;\r\n            });\r\n            this.mBadgeImages = [];\r\n        }\r\n        if (this.mNickName) {\r\n            this.mNickName.destroy(true);\r\n            this.mNickName = null;\r\n        }\r\n        if (this.mLv) {\r\n            this.mLv.destroy(true);\r\n            this.mLv = null;\r\n        }\r\n        if (this.mFollwerBtn) {\r\n            this.mFollwerBtn.destroy(true);\r\n            this.mFollwerBtn = null;\r\n        }\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    UserInfoPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getJSON());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    UserInfoPanel.prototype.init = function () {\r\n        this.setSize(359, 199);\r\n        var background = new _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, {\r\n            width: 359,\r\n            height: 199,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getRows()\r\n        }).setOrigin(0, 0);\r\n        this.add(background);\r\n        var border = new _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_3__["default"](this.scene, {\r\n            x: 7,\r\n            y: 19,\r\n            width: 345,\r\n            height: 173,\r\n            key: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(),\r\n            columns: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getColumns(),\r\n            rows: _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getRows()\r\n        }).setOrigin(0, 0);\r\n        this.add(border);\r\n        var nickNameLabel = this.scene.make.text({\r\n            x: 20,\r\n            y: -5,\r\n            text: "昵称：",\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            style: { color: "#b4b4b4", font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(nickNameLabel);\r\n        var lvLabel = this.scene.make.text({\r\n            x: 20,\r\n            y: 30,\r\n            text: "等级：",\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#b4b4b4",\r\n            style: { color: "#b4b4b4", font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(lvLabel);\r\n        this.mNickName = this.scene.make.text({\r\n            x: nickNameLabel.x + 50,\r\n            y: nickNameLabel.y,\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#FFFFFF",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        }, false);\r\n        this.add(this.mNickName);\r\n        this.mLv = this.scene.make.text({\r\n            x: lvLabel.x + 50,\r\n            y: lvLabel.y,\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            color: "#FFFFFF",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_18_BOLD }\r\n        });\r\n        this.add(this.mLv);\r\n        this.mFollwerBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_5__["NinePatchButton"](this.scene, 258, 145, 80, 34, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getName(), "关注", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["BlueButton"].getConfig());\r\n        this.mFollwerBtn.x = 258 + (this.mFollwerBtn.width >> 1);\r\n        this.mFollwerBtn.y = 145 + (this.mFollwerBtn.height >> 1);\r\n        this.mFollwerBtn.setTextStyle({ font: _utils_font__WEBPACK_IMPORTED_MODULE_4__["Font"].YAHEI_16_BOLD });\r\n        this.add(this.mFollwerBtn);\r\n        this.mActor = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, 300, 125).setOrigin(0.5, 1);\r\n        this.mActor.scale = 2;\r\n        this.add(this.mActor);\r\n        this.mWorld.uiManager.getMediator(_UserInfoMediator__WEBPACK_IMPORTED_MODULE_6__["UserInfoMediator"].NAME).resize();\r\n        _super.prototype.init.call(this);\r\n        this.setInfo(this.getData("data"));\r\n    };\r\n    UserInfoPanel.prototype.updateFollwer = function (platformId) {\r\n        var _this = this;\r\n        var mainPlayer = this.mWorld.roomManager.currentRoom.playerManager.actor.model;\r\n        if (!mainPlayer)\r\n            return;\r\n        if (platformId === mainPlayer.platformId) {\r\n            // this.mFollwerBtn.visible = false;\r\n            return;\r\n        }\r\n        // this.mFollwerBtn.visible = true;\r\n        this.mWorld.httpService.checkFollowed([platformId])\r\n            .then(function (response) {\r\n            if (response.code === 200) {\r\n                var resData = response.data;\r\n                if (resData.length > 0) {\r\n                    _this.mFollwerBtn.setText("取消关注");\r\n                }\r\n                else {\r\n                    _this.mFollwerBtn.setText("关注");\r\n                }\r\n                _this.mFollwerBtn.setData("node", { text: _this.mFollwerBtn.getText(), platformId: platformId });\r\n            }\r\n        });\r\n    };\r\n    UserInfoPanel.prototype.createBadge = function (badges) {\r\n        if (!badges)\r\n            return;\r\n        for (var i = 0; i < badges.length; i++) {\r\n            var badge = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](this.scene, i * 70 + 60, 100);\r\n            badge.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes(badges[i].target_entity.thumbnail));\r\n            this.add(badge);\r\n            this.mBadgeImages.push(badge);\r\n        }\r\n    };\r\n    UserInfoPanel.prototype.loadDefaultAvatar = function () {\r\n        this.mActor.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getOsdRes("show/avatar_default.png"));\r\n    };\r\n    UserInfoPanel.prototype.clearBadge = function () {\r\n        for (var _i = 0, _a = this.mBadgeImages; _i < _a.length; _i++) {\r\n            var badge = _a[_i];\r\n            badge.destroy();\r\n            this.remove(badge);\r\n        }\r\n        this.mBadgeImages.length = 0;\r\n    };\r\n    return UserInfoPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserInfo/UserInfoPanel.ts?')},"./src/ui/UserMenu/MenuItem.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MenuItem", function() { return MenuItem; });\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar MenuItem = /** @class */ (function (_super) {\r\n    __extends(MenuItem, _super);\r\n    function MenuItem(scene, x, y, width, height, key, text, config) {\r\n        return _super.call(this, scene, x, y, width, height, key, "", text, config) || this;\r\n    }\r\n    MenuItem.prototype.appendItem = function (menu) {\r\n        if (!this.mChild) {\r\n            this.mMenus = [];\r\n            this.mChild = this.scene.make.container(undefined, false);\r\n            // this.mChild.x = 42;\r\n            this.mArrow = this.scene.make.image({\r\n                x: this.width * this.originX - 3,\r\n                key: "usermenu_arrow"\r\n            });\r\n            this.add(this.mArrow);\r\n            this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_1__["NinePatch"](this.scene, 0, 0, 0, 0, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        }\r\n        this.mChild.add(menu);\r\n        this.mMenus.push(menu);\r\n        this.mBackground.resize(74, this.mMenus.length * 32);\r\n        this.mBackground.x = this.mBackground.width;\r\n        this.mBackground.y = this.mBackground.height / 2 - 32 / 2;\r\n        this.mChild.addAt(this.mBackground, 0);\r\n        this.mChild.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.mBackground.width, this.mBackground.height), Phaser.Geom.Rectangle.Contains);\r\n    };\r\n    MenuItem.prototype.show = function () {\r\n        this.add(this.mChild);\r\n    };\r\n    MenuItem.prototype.destroy = function (fromScene) {\r\n        if (this.mMenus) {\r\n            var len = this.mMenus.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mMenus[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy(true);\r\n                item = null;\r\n            }\r\n            this.mMenus = [];\r\n        }\r\n        if (this.mBackground) {\r\n            this.mBackground.destroy();\r\n            this.mBackground = null;\r\n        }\r\n        if (this.mChild) {\r\n            this.mChild.destroy(true);\r\n            this.mChild = null;\r\n        }\r\n        if (this.mArrow) {\r\n            this.mArrow.destroy(true);\r\n            this.mArrow = null;\r\n        }\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    Object.defineProperty(MenuItem.prototype, "menus", {\r\n        get: function () {\r\n            return this.mMenus || [];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return MenuItem;\r\n}(_components_ninepatch_button__WEBPACK_IMPORTED_MODULE_0__["NinePatchButton"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/MenuItem.ts?')},"./src/ui/UserMenu/UserMenuMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserMenuMediator", function() { return UserMenuMediator; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar UserMenuMediator = /** @class */ (function (_super) {\r\n    __extends(UserMenuMediator, _super);\r\n    function UserMenuMediator(layerManager, scene, worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = worldService;\r\n        _this.mLayerManager = layerManager;\r\n        _this.mScene = scene;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_4__["UIType"].Tips;\r\n        return _this;\r\n    }\r\n    UserMenuMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    UserMenuMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        if (this.mView) {\r\n            this.mView.off("menuClick", this.onClickMenuHandler, this);\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    UserMenuMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    UserMenuMediator.prototype.isShow = function () {\r\n        return false;\r\n    };\r\n    UserMenuMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize();\r\n    };\r\n    UserMenuMediator.prototype.show = function (param) {\r\n        // if (this.mView && this.mView.isShow()) {\r\n        //     return;\r\n        // }\r\n        // this.mView = new UserMenuPanel(this.mScene, this.world);\r\n        // this.mView.show(param[0]);\r\n        // this.mLayerManager.addToUILayer(this.mView);\r\n        // this.world.emitter.on(MessageType.SCENE_BACKGROUND_CLICK, this.onClosePanel, this);\r\n        // this.mView.on("menuClick", this.onClickMenuHandler, this);\r\n        // super.show(param);\r\n        // this.mScene.input.on("pointerdown", this.onClosePanel, this);\r\n    };\r\n    UserMenuMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param[0]);\r\n    };\r\n    UserMenuMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mScene = null;\r\n    };\r\n    UserMenuMediator.prototype.onClickMenuHandler = function (targetNode) {\r\n        if (!this.mView)\r\n            return;\r\n        var uiNode = this.mView.getData("data");\r\n        if (!targetNode || !uiNode || !this.world || !this.world.connection)\r\n            return;\r\n        this.hide();\r\n        if (targetNode.platformid) {\r\n            if (targetNode.text === "关注") {\r\n                this.world.httpService.follow(targetNode.platformid);\r\n            }\r\n            else if (targetNode.text === "取消关注") {\r\n                this.world.httpService.unfollow(targetNode.platformid);\r\n            }\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = uiNode.id;\r\n        content.componentId = targetNode.id;\r\n        this.world.connection.send(pkt);\r\n    };\r\n    UserMenuMediator.prototype.onClosePanel = function (pointer, gameObject) {\r\n        this.hide();\r\n    };\r\n    return UserMenuMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_3__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/UserMenuMediator.ts?')},"./src/ui/UserMenu/UserMenuPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserMenuPanel", function() { return UserMenuPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _MenuItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MenuItem */ "./src/ui/UserMenu/MenuItem.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar UserMenuPanel = /** @class */ (function (_super) {\r\n    __extends(UserMenuPanel, _super);\r\n    function UserMenuPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mMenus = [];\r\n        _this.disInteractive();\r\n        _this.scale = 2;\r\n        return _this;\r\n    }\r\n    UserMenuPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.setData("data", param);\r\n        this.addItem(param);\r\n        this.x = this.scene.input.activePointer.x + 32;\r\n        this.y = this.scene.input.activePointer.y + 32;\r\n        this.scaleX = this.scaleY = this.scale;\r\n        // this.scene.input.on("gameobjectdown", this.onClickMenu, this);\r\n    };\r\n    UserMenuPanel.prototype.hide = function () {\r\n        // this.scene.input.off("gameobjectdown", this.onClickMenu, this);\r\n        this.disInteractive();\r\n        this.clear();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    UserMenuPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.scene.input.on("gameobjectdown", this.onClickMenu, this);\r\n    };\r\n    UserMenuPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.scene.input.off("gameobjectdown", this.onClickMenu, this);\r\n    };\r\n    UserMenuPanel.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        if (this.mBackground) {\r\n            this.mBackground.resize(width, height);\r\n            // this.mBackground.x = this.mBackground.width * this.originX;\r\n            // this.mBackground.y = this.mBackground.height * this.originY;\r\n        }\r\n        return this;\r\n    };\r\n    UserMenuPanel.prototype.destroy = function () {\r\n        if (this.mBackground) {\r\n            this.mBackground.destroy();\r\n        }\r\n        if (this.mMenus) {\r\n            var len = this.mMenus.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mMenus[i];\r\n                if (item)\r\n                    continue;\r\n                item.destroy(true);\r\n                item = null;\r\n            }\r\n            this.mMenus = [];\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    UserMenuPanel.prototype.addItem = function (params) {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.clear();\r\n        var menu = params.menuItem;\r\n        for (var i = 0; i < menu.length; i++) {\r\n            var btn = this.appendItem(menu[i], 0, i * 32);\r\n            this.add(btn);\r\n            this.mMenus.push(btn);\r\n        }\r\n        // this.resizeBackground(60, this.mMenus.length * 30);\r\n        // this.resizeBackground(60, this.mMenus.length * 32);\r\n        this.setSize(70, this.mMenus.length * 30);\r\n        var mainPlayer = this.mWorld.roomManager.currentRoom.playerManager.actor.model;\r\n        if (!mainPlayer)\r\n            return;\r\n        var actor = params.actors[0];\r\n        if (!actor)\r\n            return;\r\n        if (mainPlayer.platformId !== actor.platformId) {\r\n            var fn_1 = { text: "关注", platformid: actor.platformId };\r\n            var follow_1 = this.appendItem({ text: "关注", node: undefined }, 0, this.mMenus.length * 31);\r\n            follow_1.setData("node", fn_1);\r\n            this.add(follow_1);\r\n            this.mMenus.push(follow_1);\r\n            this.mWorld.httpService.checkFollowed([actor.platformId])\r\n                .then(function (response) {\r\n                if (response.code === 200) {\r\n                    var data = response.data;\r\n                    if (data.length > 0) {\r\n                        follow_1.setText("取消关注");\r\n                    }\r\n                    fn_1.text = follow_1.getText();\r\n                    follow_1.setData("node", fn_1);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.preload = function () {\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlackButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["BlackButton"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.scene.load.image("usermenu_arrow", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/usermenu/arrow.png"));\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getJSON());\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    UserMenuPanel.prototype.init = function () {\r\n        this.mBackground = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 70, 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.add(this.mBackground);\r\n        // this.mBackground.x = this.mBackground.width * this.mBackground.originX;\r\n        // this.mBackground.y = this.mBackground.height * this.mBackground.originY;\r\n        _super.prototype.init.call(this);\r\n        if (this.mShowData)\r\n            this.addItem(this.showData);\r\n    };\r\n    UserMenuPanel.prototype.appendItem = function (menu, x, y) {\r\n        var item = new _MenuItem__WEBPACK_IMPORTED_MODULE_2__["MenuItem"](this.scene, 0, 0, 59, 29, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getName(), menu.text, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["TransparentButton"].getConfig());\r\n        item.x = x;\r\n        item.y = y - (item.height >> 1);\r\n        item.setData("node", menu.node);\r\n        if (menu.child && menu.child.length > 0) {\r\n            var menuChild = menu.child;\r\n            for (var i = 0, len = menuChild.length; i < len; i++) {\r\n                var child = menuChild[i];\r\n                // parent的宽，高需要加入\r\n                var btn = this.appendItem(child, 31 + 42, i * 31 - 31 / 2 + this.mMenus.length * 31);\r\n                item.appendItem(btn);\r\n            }\r\n        }\r\n        return item;\r\n    };\r\n    UserMenuPanel.prototype.onClickMenu = function (pointer, gameobject) {\r\n        if (gameobject instanceof _MenuItem__WEBPACK_IMPORTED_MODULE_2__["MenuItem"]) {\r\n            if (gameobject.menus.length > 0) {\r\n                gameobject.show();\r\n            }\r\n            else {\r\n                this.emit("menuClick", gameobject.getData("node"));\r\n            }\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.resizeBackground = function (width, height) {\r\n        if (this.mBackground) {\r\n            this.mBackground.resize(width, height);\r\n        }\r\n    };\r\n    UserMenuPanel.prototype.clear = function () {\r\n        for (var _i = 0, _a = this.mMenus; _i < _a.length; _i++) {\r\n            var menu = _a[_i];\r\n            this.remove(menu);\r\n            menu.off("pointerup", this.onClickMenu);\r\n            menu.destroy();\r\n        }\r\n        this.mMenus.length = 0;\r\n    };\r\n    return UserMenuPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/UserMenu/UserMenuPanel.ts?')},"./src/ui/alert/PopUpTextUI.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PopUpTextUI", function() { return PopUpTextUI; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar PopUpTextUI = /** @class */ (function (_super) {\r\n    __extends(PopUpTextUI, _super);\r\n    function PopUpTextUI(world, scene) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mWorld = world;\r\n        _this.scene = scene;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    PopUpTextUI.prototype.show = function (param) {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        var text = this.scene.make.text({\r\n            x: 0,\r\n            y: 0,\r\n            text: param,\r\n            style: { fill: "#FF0000", fontSize: 20 }\r\n        });\r\n        this.add(text);\r\n        this.setSize(text.width, text.height);\r\n        this.setPosition(size.width - this.width >> 1, size.height >> 1);\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 1000,\r\n            ease: "Linear",\r\n            props: {\r\n                y: { value: (size.height >> 1) - 80 },\r\n                alhpa: { value: 0 },\r\n            },\r\n            onComplete: function (tween, targets, element) {\r\n                _this.destroy();\r\n            },\r\n            onCompleteParams: [this],\r\n        });\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    PopUpTextUI.prototype.resize = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - this.width >> 1;\r\n    };\r\n    PopUpTextUI.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return PopUpTextUI;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/alert/PopUpTextUI.ts?')},"./src/ui/bag/IListItemRender.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/IListItemRender.ts?")},"./src/ui/bag/bagView/bagMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragType", function() { return DragType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DropType", function() { return DropType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagMediator", function() { return BagMediator; });\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _bagPanel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bagPanel */ "./src/ui/bag/bagView/bagPanel.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DragType;\r\n(function (DragType) {\r\n    DragType[DragType["DRAG_TYPE_SHORTCUT"] = 1] = "DRAG_TYPE_SHORTCUT";\r\n    DragType[DragType["DRAG_TYPE_BAG"] = 2] = "DRAG_TYPE_BAG";\r\n})(DragType || (DragType = {}));\r\nvar DropType;\r\n(function (DropType) {\r\n    DropType[DropType["DROP_TYPE_SHORTCUT"] = 1] = "DROP_TYPE_SHORTCUT";\r\n    DropType[DropType["DROP_TYPE_BAG"] = 2] = "DROP_TYPE_BAG";\r\n})(DropType || (DropType = {}));\r\nvar BagMediator = /** @class */ (function (_super) {\r\n    __extends(BagMediator, _super);\r\n    function BagMediator(layerManager, mworld, scene) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mPageNum = 0;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = mworld;\r\n        _this.mScene = scene;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_5__["UIType"].Normal;\r\n        return _this;\r\n    }\r\n    BagMediator.prototype.resize = function (width, height) {\r\n        if (this.mView)\r\n            this.mView.resize(width, height);\r\n    };\r\n    BagMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    BagMediator.prototype.isShow = function () {\r\n        if (this.mView)\r\n            return this.mView.isShow();\r\n    };\r\n    BagMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _bagPanel__WEBPACK_IMPORTED_MODULE_2__["BagPanel"](this.mScene, this.world);\r\n        }\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.on("gameobjectdown", this.onBtnHandler, this);\r\n        if (param) {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(param[0].id, 1, _bagPanel__WEBPACK_IMPORTED_MODULE_2__["BagPanel"].PageMaxCount);\r\n        }\r\n        else {\r\n            this.world.roomManager.currentRoom.playerManager.actor.getBag().requestVirtualWorldQueryPackage(this.world.roomManager.currentRoom.playerManager.actor.package.id, 1, _bagPanel__WEBPACK_IMPORTED_MODULE_2__["BagPanel"].PageMaxCount);\r\n        }\r\n        this.mView.show(param);\r\n        this.mLayerManager.addToUILayer(this.mView);\r\n        this.world.uiManager.checkUIState(BagMediator.NAME, false);\r\n        this.refrehView();\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagMediator.prototype.update = function (param) {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.update(param);\r\n    };\r\n    BagMediator.prototype.hide = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].DRAG_TO_DROP, this.handleDrop, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.hide();\r\n        this.mView = null;\r\n        this.world.uiManager.checkUIState(BagMediator.NAME, true);\r\n    };\r\n    BagMediator.prototype.destroy = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].DRAG_TO_DROP, this.handleDrop, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SCENE_SYNCHRO_PACKAGE, this.handleSynchroPackage, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.onUpdatePackageHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].QUERY_PACKAGE, this.handleSynchroPackage, this);\r\n        this.mScene.input.off("gameobjectdown", this.onBtnHandler, this);\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n        this.mPageNum = 0;\r\n        this.mScene = null;\r\n        this.world = null;\r\n    };\r\n    BagMediator.prototype.handleDrop = function (value) {\r\n        var drag = value[0];\r\n        var drop = value[1];\r\n        if (drop.getDropType() === DropType.DROP_TYPE_BAG && drag.getDragType() === DragType.DRAG_TYPE_SHORTCUT) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().debug("背包拖到快捷栏了！！！");\r\n        }\r\n    };\r\n    BagMediator.prototype.refrehView = function (mItems) {\r\n        var items;\r\n        if (!mItems) {\r\n            var packs = this.world.roomManager.currentRoom.playerManager.actor.package;\r\n            if (packs == null) {\r\n                return;\r\n            }\r\n            items = packs.items;\r\n        }\r\n        else {\r\n            items = mItems;\r\n        }\r\n        this.setListData(items);\r\n    };\r\n    BagMediator.prototype.onBtnHandler = function (pointer, gameobject) {\r\n        if (gameobject instanceof _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_3__["default"])\r\n            return;\r\n        if (this.mView)\r\n            this.mView.setBlur();\r\n    };\r\n    BagMediator.prototype.setListData = function (value) {\r\n        this.mView.setDataList();\r\n    };\r\n    BagMediator.prototype.handleSynchroPackage = function () {\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.refrehView(itemList);\r\n    };\r\n    BagMediator.prototype.onUpdatePackageHandler = function () {\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.refrehView(itemList);\r\n    };\r\n    BagMediator.NAME = "BagMediator";\r\n    return BagMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/bagView/bagMediator.ts?')},"./src/ui/bag/bagView/bagPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagPanel", function() { return BagPanel; });\n/* harmony import */ var _item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _bagMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/tool */ "./src/utils/tool.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar BagPanel = /** @class */ (function (_super) {\r\n    __extends(BagPanel, _super);\r\n    // private mInitalize: boolean = false;\r\n    function BagPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mPageNum = 0;\r\n        _this.mPageIndex = 1;\r\n        _this.mBaseStr = "输入关键字进行搜索";\r\n        _this.bagSlotList = [];\r\n        _this.mCheckList = [];\r\n        return _this;\r\n    }\r\n    BagPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height - (this.height / 2) * this.mWorld.uiScale >> 1;\r\n            }\r\n        }\r\n    };\r\n    BagPanel.prototype.setDataList = function () {\r\n        var itemList = this.mWorld.roomManager.currentRoom.playerManager.actor.package.items;\r\n        this.mPageNum = Math.ceil(itemList.length / BagPanel.PageMaxCount);\r\n        this.mDataList = itemList;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        this.checkChinese();\r\n    };\r\n    BagPanel.prototype.getPageNum = function () {\r\n        return this.mPageNum;\r\n    };\r\n    BagPanel.prototype.destroy = function () {\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.bagSlotList.length = 0;\r\n            this.bagSlotList = null;\r\n        }\r\n        this.mWorld = null;\r\n        this.mPageNum = 0;\r\n        this.mPageIndex = 1;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BagPanel.prototype.getCurPageIndex = function () {\r\n        return this.mPageIndex;\r\n    };\r\n    BagPanel.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        if (this.mInitialized) {\r\n            this.mPreBtn.play("slipBtn");\r\n            this.mNextBtn.play("slipBtn");\r\n        }\r\n    };\r\n    BagPanel.prototype.setBlur = function () {\r\n        if (this.mInputText)\r\n            this.mInputText.setBlur();\r\n    };\r\n    BagPanel.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mInputText.on("focus", this.onFocusHandler, this);\r\n        this.mInputText.on("blur", this.onBlurHandler, this);\r\n        this.mNextBtn.on("pointerup", this.nextHandler, this);\r\n        this.mPreBtn.on("pointerup", this.preHandler, this);\r\n        this.mClsBtn.on("pointerup", this.closeHandler, this);\r\n    };\r\n    BagPanel.prototype.removeListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        this.mInputText.off("focus", this.onFocusHandler, this);\r\n        this.mInputText.off("blur", this.onBlurHandler, this);\r\n        this.mNextBtn.off("pointerup", this.nextHandler, this);\r\n        this.mPreBtn.off("pointerup", this.preHandler, this);\r\n        this.mClsBtn.off("pointerup", this.closeHandler, this);\r\n    };\r\n    BagPanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width >> 1;\r\n            this.y = size.height >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height >> 1;\r\n            }\r\n            else {\r\n                this.x = size.width >> 1;\r\n                this.y = size.height - (this.height / 2) * this.mWorld.uiScale >> 1;\r\n            }\r\n        }\r\n        // ============背包格位\r\n        var itemSlot;\r\n        var tmpX = 0;\r\n        var tmpY = 0;\r\n        // ================背包界面背景底\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getConfig());\r\n        // this.mBg.x = size.width - this.width >> 1;\r\n        // this.mBg.y = size.height - this.mBg.height >> 1;\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        var txtBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, this.mBorder.width / 4 + 5, -this.mBg.height / 2 + 65, this.mBorder.width / 2 - 40, 35, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getConfig());\r\n        this.add(txtBg);\r\n        this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_5__["default"](this.scene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080"\r\n        })\r\n            .resize(txtBg.width, txtBg.height)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 16px YaHei" });\r\n        this.mInputText.x = txtBg.x - txtBg.width / 2;\r\n        this.mInputText.y = txtBg.y - txtBg.height / 2;\r\n        this.mInputText.setText(this.mBaseStr);\r\n        this.add(this.mInputText);\r\n        // 多排背包格位\r\n        this.bagSlotList = [];\r\n        for (var i = 0; i < BagPanel.PageMaxCount; i++) {\r\n            tmpX = i % 8 * 60 - 210;\r\n            tmpY = Math.floor(i / 8) * 60 - this.mBorder.height / 2 + this.mBorder.y + this.mBorder.height / 2 - 55;\r\n            itemSlot = new _item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"](this.scene, this.mWorld, this, tmpX, tmpY, this.mResStr, this.mResPng, this.mResJson, "bagView_slot.png", "itemSelectFrame");\r\n            itemSlot.createUI();\r\n            this.bagSlotList.push(itemSlot);\r\n        }\r\n        this.mPreBtn = this.scene.make.sprite(undefined, false);\r\n        this.mPreBtn.x = -this.mBg.width >> 1;\r\n        // // ===============背包界面右翻按钮\r\n        this.mNextBtn = this.scene.make.sprite(undefined, false);\r\n        this.mNextBtn.scaleX = -1;\r\n        this.mNextBtn.x = this.mBg.width >> 1;\r\n        var titleCon = this.scene.make.sprite(undefined, false);\r\n        titleCon.setTexture(this.mResStr, "bagView_titleBtn.png");\r\n        titleCon.x = (-this.mBg.width >> 1) + 50;\r\n        titleCon.y = (-this.mBg.height >> 1);\r\n        this.add(titleCon);\r\n        var titleTF = this.scene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("背包");\r\n        titleTF.x = titleCon.x + titleCon.width - 10;\r\n        titleTF.y = titleCon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        this.add(this.mPreBtn);\r\n        this.add(this.mNextBtn);\r\n        this.mNextBtn.setInteractive();\r\n        this.mPreBtn.setInteractive();\r\n        this.width = this.mBg.width;\r\n        this.height = this.mBg.height;\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_7__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: this.mResPng, jsonUrl: this.mResJson\r\n        });\r\n        this.mClsBtn.x = (this.width >> 1) - 65;\r\n        this.mClsBtn.y = -this.height >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.add(this.mClsBtn);\r\n        this.mInitialized = true;\r\n        if (this.mDataList) {\r\n            this.refreshDataList(this.mDataList);\r\n        }\r\n        this.setInteractive();\r\n        this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_3__["BagMediator"].NAME).resize(this.width, this.height);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BagPanel.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bagView";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        this.scene.load.atlas("itemChose", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/itemChose.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/itemChose.json"));\r\n        this.scene.load.atlas("slip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/bag/slip.json"));\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Border"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Background"].getPNG());\r\n        this.scene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_2__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BagPanel.prototype.loadComplete = function (loader, totalComplete, totalFailed) {\r\n        var selectFramesObj = this.scene.textures.get("itemChose").frames;\r\n        var tmpSelectFrames = [];\r\n        for (var key in selectFramesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = selectFramesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpSelectFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.scene.anims.create({\r\n            key: "itemSelectFrame",\r\n            frames: this.scene.anims.generateFrameNumbers("itemChose", { start: 0, end: 8, frames: tmpSelectFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        var framesObj = this.scene.textures.get("slip").frames;\r\n        var tmpFrames = [];\r\n        for (var key in framesObj) {\r\n            if (key === "__BASE")\r\n                continue;\r\n            var frame = framesObj[key];\r\n            if (!frame)\r\n                continue;\r\n            tmpFrames.push(key);\r\n        }\r\n        // 手动把json配置中的frames给予anims\r\n        this.scene.anims.create({\r\n            key: "slipBtn",\r\n            frames: this.scene.anims.generateFrameNumbers("slip", { start: 0, end: 14, frames: tmpFrames }),\r\n            frameRate: 33,\r\n            yoyo: true,\r\n            repeat: -1\r\n        });\r\n        _super.prototype.loadComplete.call(this, loader, totalComplete, totalFailed);\r\n    };\r\n    BagPanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_3__["BagMediator"].NAME).resize(this.width, this.height);\r\n    };\r\n    BagPanel.prototype.nextHandler = function (pointer, gameObject) {\r\n        this.preNextBtnScaleHandler(this.mNextBtn, -1);\r\n        if (this.mPageIndex >= this.mPageNum) {\r\n            return;\r\n        }\r\n        this.mPageIndex++;\r\n        var list = this.mCheckList.length > 0 ? this.mCheckList : this.mDataList;\r\n        this.refreshDataList(list);\r\n    };\r\n    BagPanel.prototype.preHandler = function (pointer, gameObject) {\r\n        this.preNextBtnScaleHandler(this.mPreBtn);\r\n        if (this.mPageIndex <= 1) {\r\n            return;\r\n        }\r\n        this.mPageIndex--;\r\n        var list = this.mCheckList.length > 0 ? this.mCheckList : this.mDataList;\r\n        this.refreshDataList(list);\r\n    };\r\n    BagPanel.prototype.preNextBtnScaleHandler = function (gameObject, scaleX) {\r\n        if (scaleX === void 0) { scaleX = 1; }\r\n        this.scene.tweens.add({\r\n            targets: gameObject,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 * scaleX },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        gameObject.scaleX = scaleX;\r\n        gameObject.scaleY = 1;\r\n    };\r\n    BagPanel.prototype.refreshDataList = function (checkItemList) {\r\n        if (!checkItemList) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_1__["Logger"].getInstance().error("checkItemList is undefiend");\r\n            return;\r\n        }\r\n        var items = checkItemList.slice((this.mPageIndex - 1) * BagPanel.PageMaxCount, this.mPageIndex * BagPanel.PageMaxCount);\r\n        var len = BagPanel.PageMaxCount;\r\n        var item;\r\n        for (var i = 0; i < len; i++) {\r\n            item = this.bagSlotList[i];\r\n            if (!item)\r\n                continue;\r\n            item.dataChange(items[i]);\r\n        }\r\n    };\r\n    BagPanel.prototype.closeHandler = function () {\r\n        var med = this.mWorld.uiManager.getMediator(_bagMediator__WEBPACK_IMPORTED_MODULE_3__["BagMediator"].NAME);\r\n        med.hide();\r\n    };\r\n    BagPanel.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n        if (!this.mInputText)\r\n            return;\r\n        this.mInputText.on("textchange", this.checkChinese, this);\r\n        this.mInputText.setText("");\r\n    };\r\n    BagPanel.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager || !this.mInputText) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n        this.mInputText.on("textchange", this.checkChinese, this);\r\n        this.mInputText.setText(this.mBaseStr);\r\n    };\r\n    BagPanel.prototype.checkChinese = function () {\r\n        var _this = this;\r\n        var str = this.mInputText.text;\r\n        if (str.length < 1 || !_utils_tool__WEBPACK_IMPORTED_MODULE_6__["Tool"].checkChinese(str) || str === this.mBaseStr) {\r\n            this.refreshDataList(this.mDataList);\r\n            return;\r\n        }\r\n        var itemList = this.mWorld.roomManager.currentRoom.playerManager.actor.package.items;\r\n        itemList.forEach(function (item) {\r\n            if (item) {\r\n                if (_utils_tool__WEBPACK_IMPORTED_MODULE_6__["Tool"].checkItemName(item.name, _this.mInputText.text)) {\r\n                    _this.mCheckList.push(item);\r\n                }\r\n            }\r\n        });\r\n        this.refreshDataList(this.mCheckList);\r\n    };\r\n    BagPanel.PageMaxCount = 32;\r\n    return BagPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_9__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/bagView/bagPanel.ts?')},"./src/ui/bag/basebag.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/basebag.ts?")},"./src/ui/bag/baseitem.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/baseitem.ts?")},"./src/ui/bag/dragDropIcon.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DragDropIcon", function() { return DragDropIcon; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar DragDropIcon = /** @class */ (function (_super) {\r\n    __extends(DragDropIcon, _super);\r\n    function DragDropIcon(mScene, x, y, texture) {\r\n        var _this = _super.call(this, mScene, x, y) || this;\r\n        _this.mScene = mScene;\r\n        _this.mIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_1__["DynamicImage"](_this.mScene, 0, 0); // this.mScene.make.image(undefined, false);\r\n        _this.add(_this.mIcon);\r\n        return _this;\r\n    }\r\n    DragDropIcon.prototype.load = function (value, thisArg, onLoadComplete) {\r\n        var _this = this;\r\n        this.mUrl = value;\r\n        var key = this.resKey;\r\n        this.mIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes(this.mUrl), function () {\r\n            if (_this.mCallBack)\r\n                _this.mCallBack();\r\n        });\r\n        // if (!this.mScene.cache.obj.has(key)) {\r\n        //     this.mScene.load.image(key, Url.getOsdRes(this.mUrl));\r\n        //     this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n        //     this.mScene.load.start();\r\n        // } else {\r\n        //     this.onLoadCompleteHandler();\r\n        // }\r\n        this.mCallBack = onLoadComplete;\r\n    };\r\n    DragDropIcon.prototype.dragStart = function () {\r\n    };\r\n    DragDropIcon.prototype.dragStop = function (acceptDrag) {\r\n    };\r\n    DragDropIcon.prototype.dragDrop = function (dragable) {\r\n    };\r\n    DragDropIcon.prototype.dragOver = function (dragable) {\r\n    };\r\n    DragDropIcon.prototype.getDragData = function () {\r\n    };\r\n    DragDropIcon.prototype.getDropData = function () {\r\n    };\r\n    DragDropIcon.prototype.getDragImage = function () {\r\n        return this.mIcon;\r\n    };\r\n    DragDropIcon.prototype.getVisualDisplay = function () {\r\n        return undefined;\r\n    };\r\n    DragDropIcon.prototype.getBound = function () {\r\n        var bound = this.getBounds();\r\n        return new Phaser.Geom.Rectangle(bound.x, bound.y, bound.width, bound.height);\r\n    };\r\n    Object.defineProperty(DragDropIcon.prototype, "resKey", {\r\n        get: function () {\r\n            if (this.mUrl === undefined)\r\n                return "";\r\n            var key = _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getOsdRes((this.mUrl)); // Load.Image.getKey(this.mUrl);\r\n            return key;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DragDropIcon.prototype.destroy = function () {\r\n        this.mCallBack = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Object.defineProperty(DragDropIcon.prototype, "icon", {\r\n        get: function () {\r\n            return this.mIcon;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DragDropIcon.prototype.setDragType = function (value) {\r\n        this.mDragType = value;\r\n    };\r\n    DragDropIcon.prototype.setDropType = function (value) {\r\n        this.mDropType = value;\r\n    };\r\n    DragDropIcon.prototype.getDropType = function () {\r\n        return this.mDropType;\r\n    };\r\n    DragDropIcon.prototype.getDragType = function () {\r\n        return this.mDragType;\r\n    };\r\n    return DragDropIcon;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/dragDropIcon.ts?')},"./src/ui/bag/idragable.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/idragable.ts?")},"./src/ui/bag/idropable.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/idropable.ts?")},"./src/ui/bag/item.slot.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItemSlot", function() { return ItemSlot; });\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _dragDropIcon__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dragDropIcon */ "./src/ui/bag/dragDropIcon.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _tips_toolTip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tips/toolTip */ "./src/ui/tips/toolTip.ts");\n\r\n\r\n\r\n\r\n\r\nvar ItemSlot = /** @class */ (function () {\r\n    function ItemSlot(scene, world, parentCon, x, y, resStr, respng, resjson, resSlot, selectRes, subscriptRes) {\r\n        this.minitialize = false;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        this.isTipBoo = true;\r\n        this.mScene = scene;\r\n        this.mWorld = world;\r\n        this.toolTipCon = scene.make.container(undefined, false); // new ToolTipContainer(this.mScene, world);\r\n        this.toolTipCon.x = x;\r\n        this.toolTipCon.y = y;\r\n        parentCon.add(this.toolTipCon);\r\n        this.mResStr = resStr;\r\n        this.mResPng = respng;\r\n        this.mResJson = resjson;\r\n        this.mResSlot = resSlot;\r\n        this.mSubScriptRes = subscriptRes;\r\n        this.mSelectRes = selectRes;\r\n    }\r\n    Object.defineProperty(ItemSlot.prototype, "hasTip", {\r\n        get: function () {\r\n            return this.isTipBoo;\r\n        },\r\n        set: function (value) {\r\n            this.isTipBoo = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ItemSlot.prototype.createUI = function () {\r\n        this.onLoadCompleteHandler();\r\n    };\r\n    ItemSlot.prototype.getView = function () {\r\n        return this.toolTipCon;\r\n    };\r\n    ItemSlot.prototype.getBg = function () {\r\n        return this.itemBG;\r\n    };\r\n    ItemSlot.prototype.getIcon = function () {\r\n        return this.mIcon;\r\n    };\r\n    ItemSlot.prototype.dataChange = function (val) {\r\n        var _this = this;\r\n        if (!this.minitialize)\r\n            return;\r\n        this.mData = val;\r\n        if (this.mIcon) {\r\n            var url = void 0;\r\n            if (this.mData && this.mData.display) {\r\n                url = this.mData.display.texturePath;\r\n                var des = this.mData.des ? "\\n" + this.mData.des : "";\r\n                this.setToolTipData(this.mData.name + this.mData.des);\r\n            }\r\n            else {\r\n                this.mIcon.icon.visible = false;\r\n            }\r\n            if (!url)\r\n                return;\r\n            if (this.mScene.textures.exists(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(url))) {\r\n                if (this.mData) {\r\n                    this.mIcon.icon.setTexture(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getOsdRes(url));\r\n                    this.mIcon.icon.visible = true;\r\n                }\r\n            }\r\n            else {\r\n                this.mIcon.load(url, this, function () {\r\n                    if (_this.mData) {\r\n                        _this.mIcon.icon.visible = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.mIcon.icon.visible = false;\r\n        }\r\n    };\r\n    ItemSlot.prototype.destroy = function () {\r\n        if (this.mSubScriptSprite) {\r\n            this.mSubScriptSprite.destroy(true);\r\n            this.mSubScriptSprite = null;\r\n        }\r\n        if (this.mSelectSprite) {\r\n            this.mSelectSprite.destroy(true);\r\n            this.mSelectSprite = null;\r\n        }\r\n        if (this.mIcon) {\r\n            this.mIcon.destroy();\r\n        }\r\n        if (this.toolTipCon) {\r\n            this.toolTipCon.destroy();\r\n            this.toolTipCon = null;\r\n        }\r\n        if (this.toolTip) {\r\n            this.toolTip.destroy();\r\n            this.toolTip = null;\r\n        }\r\n        if (this.mAnimationCon) {\r\n            this.mAnimationCon.destroy(true);\r\n            this.mAnimationCon = null;\r\n        }\r\n        if (this.itemBG) {\r\n            this.itemBG.destroy(true);\r\n            this.itemBG = null;\r\n        }\r\n        this.index = 0;\r\n        this.mData = null;\r\n        this.mScene = null;\r\n        this.mWorld = null;\r\n        this.mResStr = null;\r\n        this.mResPng = null;\r\n        this.mResSlot = null;\r\n        this.mResJson = null;\r\n        this.mSubScriptRes = null;\r\n        this.mSelectRes = null;\r\n        this.mWorld = null;\r\n        this.minitialize = false;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        this.mData = null;\r\n        this.isTipBoo = true;\r\n    };\r\n    ItemSlot.prototype.setToolTipData = function (text) {\r\n        if (this.toolTip) {\r\n            this.toolTip.setToolTipData(text);\r\n        }\r\n    };\r\n    ItemSlot.prototype.onLoadCompleteHandler = function () {\r\n        this.itemBG = this.mScene.make.sprite(undefined, false);\r\n        this.itemBG.setTexture(this.mResStr, this.mResSlot);\r\n        this.toolTipCon.addAt(this.itemBG, 0);\r\n        this.toolTipCon.setSize(this.itemBG.width, this.itemBG.height);\r\n        this.mIcon = new _dragDropIcon__WEBPACK_IMPORTED_MODULE_1__["DragDropIcon"](this.mScene, 0, 0);\r\n        this.toolTipCon.addAt(this.mIcon, 1);\r\n        if (this.mSubScriptRes) {\r\n            this.mSubScriptSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSubScriptSprite.setTexture(this.mResStr, this.mSubScriptRes);\r\n            this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.itemBG.width >> 1;\r\n            this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.itemBG.height >> 1;\r\n            // this.con.addAt(this.mSubScriptSprite, 2);\r\n        }\r\n        if (this.isTipBoo) {\r\n            this.toolTip = new _tips_toolTip__WEBPACK_IMPORTED_MODULE_4__["ToolTip"](this.mScene, "itemSlotTip", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/toolTip/toolTip.json"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/toolTip/toolTip.png"), this.mWorld.uiScale);\r\n        }\r\n        this.toolTipCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.itemBG.width, 56), Phaser.Geom.Rectangle.Contains);\r\n        this.toolTipCon.on("pointerover", this.overHandler, this);\r\n        this.toolTipCon.on("pointerout", this.outHandler, this);\r\n        this.toolTipCon.on("pointerdown", this.downHandler, this);\r\n        this.toolTipCon.on("pointerup", this.outHandler, this);\r\n        this.minitialize = true;\r\n        if (this.mData) {\r\n            this.dataChange(this.mData);\r\n        }\r\n        this.mWid += this.itemBG.width;\r\n        this.mHei += this.itemBG.height;\r\n        // this.toolTipCon.setToolTip("itemSlotTip", Url.getRes("ui/toolTip/toolTip.json"), Url.getRes("ui/toolTip/toolTip.png"));\r\n    };\r\n    ItemSlot.prototype.downHandler = function (pointer) {\r\n        if (!this.mData || !this.mWorld.roomManager.currentRoom.playerManager.actor || !this.mWorld.roomManager.currentRoom || !this.mWorld.roomManager.currentRoom.playerManager)\r\n            return;\r\n        // if (this.mWorld.game.device.os.desktop) {\r\n        var pack = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_0__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_TARGET_UI);\r\n        var content = pkt.content;\r\n        content.uiId = pack.id;\r\n        content.componentId = this.mData.id;\r\n        this.mWorld.connection.send(pkt);\r\n        // } else {\r\n        //     // this.overHandler(pointer);\r\n        // }\r\n    };\r\n    ItemSlot.prototype.overHandler = function (pointer) {\r\n        if (this.toolTip && this.mData) {\r\n            this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this.toolTip);\r\n            this.toolTip.setToolTipData(this.mData.name + this.mData.des);\r\n            this.toolTip.x = pointer.x;\r\n            this.toolTip.y = pointer.y;\r\n        }\r\n        if (this.mSelectRes && this.mSelectRes.length > 0) {\r\n            this.mSelectSprite = this.mScene.make.sprite(undefined, false);\r\n            this.mSelectSprite.play(this.mSelectRes);\r\n            this.toolTipCon.add(this.mSelectSprite);\r\n        }\r\n    };\r\n    ItemSlot.prototype.outHandler = function (pointer) {\r\n        if (this.toolTip) {\r\n            if (this.toolTip.parentContainer) {\r\n                this.toolTip.parentContainer.remove(this.toolTip);\r\n            }\r\n        }\r\n        if (this.mSelectSprite && this.mSelectSprite.parentContainer) {\r\n            this.mSelectSprite.parentContainer.remove(this.mSelectSprite);\r\n            this.mSelectSprite.destroy(true);\r\n            this.mSelectSprite = null;\r\n        }\r\n    };\r\n    return ItemSlot;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/item.slot.ts?')},"./src/ui/bag/storage/storageMediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StorageMediator", function() { return StorageMediator; });\n/* harmony import */ var _storagePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./storagePanel */ "./src/ui/bag/storage/storagePanel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar StorageMediator = /** @class */ (function (_super) {\r\n    __extends(StorageMediator, _super);\r\n    function StorageMediator(layerManager, mworld, scene) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mLayerManager = layerManager;\r\n        _this.world = mworld;\r\n        _this.mScene = scene;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Normal;\r\n        return _this;\r\n    }\r\n    StorageMediator.prototype.isShow = function () {\r\n        return this.mView.isShow();\r\n    };\r\n    StorageMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            this.mView.resize();\r\n    };\r\n    StorageMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (!this.mView) {\r\n            this.mView = new _storagePanel__WEBPACK_IMPORTED_MODULE_0__["StoragePanel"](this.mScene, this.world);\r\n        }\r\n        this.mView.show(param);\r\n        this.world.uiManager.checkUIState(StorageMediator.NAME, false);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    StorageMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    StorageMediator.prototype.hide = function () {\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.world.uiManager.checkUIState(StorageMediator.NAME, true);\r\n        }\r\n    };\r\n    StorageMediator.prototype.destroy = function () {\r\n        if (this.mView) {\r\n            this.mView.destroy();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    StorageMediator.NAME = "StorageMediator";\r\n    return StorageMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/storage/storageMediator.ts?')},"./src/ui/bag/storage/storagePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StoragePanel", function() { return StoragePanel; });\n/* harmony import */ var _item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _storageMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./storageMediator */ "./src/ui/bag/storage/storageMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar StoragePanel = /** @class */ (function (_super) {\r\n    __extends(StoragePanel, _super);\r\n    function StoragePanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    StoragePanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width + wid >> 1;\r\n        this.y = size.height + hei - 200;\r\n    };\r\n    StoragePanel.prototype.destroy = function () {\r\n        if (this.mBagItemSlotList) {\r\n            var len = this.mBagItemSlotList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mBagItemSlotList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n                item = null;\r\n            }\r\n            this.mBagItemSlotList = null;\r\n        }\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    StoragePanel.prototype.addListen = function () {\r\n        this.mClsBtn.on("pointerup", this.hide, this);\r\n    };\r\n    StoragePanel.prototype.removeListen = function () {\r\n        this.mClsBtn.off("pointerup", this.hide, this);\r\n    };\r\n    StoragePanel.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        _super.prototype.init.call(this);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_3__["NinePatch"](this.scene, 0, 0, this.mBg.width - 10, this.mBg.height - 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.mBorder.x = this.mBg.x;\r\n        this.mBorder.y = this.mBg.y + 10;\r\n        this.addAt(this.mBorder, 1);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        var titleIcon = this.scene.make.image(undefined, false);\r\n        titleIcon.setTexture(this.mResStr, "itemBagView_title.png");\r\n        titleIcon.x = (-this.mBg.width >> 1) + 80;\r\n        titleIcon.y = -this.mBg.height >> 1;\r\n        this.add(titleIcon);\r\n        var titleTF = this.scene.make.text(undefined, false);\r\n        titleTF.setFontFamily("Tahoma");\r\n        titleTF.setFontStyle("bold");\r\n        titleTF.setFontSize(20);\r\n        titleTF.setText("书柜");\r\n        titleTF.x = titleIcon.x + titleIcon.width - 10;\r\n        titleTF.y = titleIcon.y - (titleTF.height >> 1);\r\n        this.add(titleTF);\r\n        var itemSlot;\r\n        var tmpX = 0;\r\n        var tmpY = 0;\r\n        // 多排背包格位\r\n        this.mBagItemSlotList = [];\r\n        for (var i = 0; i < 9; i++) {\r\n            tmpX = i % 9 * 60 + 32 - 724 / 2;\r\n            tmpY = Math.floor(i / 9) * 60 - 55;\r\n            itemSlot = new _item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"](this.scene, this.mWorld, this, tmpX, tmpY, this.mResStr, this.mResPng, this.mResJson, "bagView_slot.png", "bagView_itemSelect.png");\r\n            itemSlot.createUI();\r\n            this.mBagItemSlotList.push(itemSlot);\r\n        }\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_5__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n        });\r\n        this.mClsBtn.x = (this.width >> 1) - 65;\r\n        this.mClsBtn.y = -this.height >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.add(this.mClsBtn);\r\n    };\r\n    StoragePanel.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bagView";\r\n        this.mResPng = "ui/bag/bagView.png";\r\n        this.mResJson = "ui/bag/bagView.json";\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.scene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    StoragePanel.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_storageMediator__WEBPACK_IMPORTED_MODULE_4__["StorageMediator"].NAME).resize();\r\n    };\r\n    return StoragePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_6__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/bag/storage/storagePanel.ts?')},"./src/ui/baseView/bagGroup/bag.group.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagGroupMediator", function() { return BagGroupMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _bag_group__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bag.group */ "./src/ui/baseView/bagGroup/bag.group.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n/**\r\n * 背包场景UI，带背包slot，pc端用\r\n */\r\nvar BagGroupMediator = /** @class */ (function (_super) {\r\n    __extends(BagGroupMediator, _super);\r\n    function BagGroupMediator(mWorld, scene) {\r\n        var _this = _super.call(this, mWorld, scene) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_3__["UIType"].Scene;\r\n        return _this;\r\n    }\r\n    BagGroupMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    BagGroupMediator.prototype.isShow = function () {\r\n        if (this.mView) {\r\n            return this.mView.isShow();\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        var size = this.world.getSize();\r\n        this.mView = new _bag_group__WEBPACK_IMPORTED_MODULE_2__["BagGroup"](this.mScene, this.world, (size.width >> 1) - 29, size.height - 50);\r\n        this.mView.show(param);\r\n        this.addListen();\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BagGroupMediator.prototype.update = function (param) {\r\n        if (this.mView)\r\n            this.mView.update(param);\r\n    };\r\n    BagGroupMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.removeListen();\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.addListen = function () {\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackAge, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n    };\r\n    BagGroupMediator.prototype.removeListen = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].QUERY_PACKAGE, this.queryPackAge, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_1__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n    };\r\n    BagGroupMediator.prototype.heroItemChange = function () {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        var itemList = this.world.roomManager.currentRoom.playerManager.actor.package.items;\r\n        if (this.mView) {\r\n            this.mView.setDataList(itemList);\r\n        }\r\n    };\r\n    BagGroupMediator.prototype.queryPackAge = function (data) {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        if (data.id !== this.world.roomManager.currentRoom.playerManager.actor.package.id)\r\n            return;\r\n        if (this.mView) {\r\n            this.mView.setDataList(data.items);\r\n        }\r\n    };\r\n    BagGroupMediator.NAME = "BagGroupMediator";\r\n    return BagGroupMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bagGroup/bag.group.mediator.ts?')},"./src/ui/baseView/bagGroup/bag.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BagGroup", function() { return BagGroup; });\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_radio__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/radio */ "./src/ui/components/radio.ts");\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * 主界面ui pc版本\r\n */\r\nvar BagGroup = /** @class */ (function (_super) {\r\n    __extends(BagGroup, _super);\r\n    function BagGroup(scene, world, x, y) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.tmpWid = 0;\r\n        _this.x = x;\r\n        _this.y = y;\r\n        world.uiManager.getUILayerManager().addToToolTipsLayer(_this);\r\n        _this.bagSlotList = [];\r\n        return _this;\r\n    }\r\n    BagGroup.prototype.show = function (param) {\r\n        _super.prototype.show.call(this);\r\n    };\r\n    BagGroup.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        var chatMed = this.mWorld.uiManager.getMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_3__["ChatMediator"].NAME);\r\n        this.x = (size.width - this.tmpWid) / 2 < chatMed.getView().width ? chatMed.getView().width + this.width / 2 : (size.width - this.tmpWid) / 2;\r\n        this.y = size.height - 50;\r\n    };\r\n    BagGroup.prototype.tweenExpand = function (show) {\r\n        if (!this.scene)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        var baseY = size.height - 50;\r\n        var toY = show === true ? baseY : baseY + 100;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    BagGroup.prototype.destroy = function () {\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (slot) {\r\n                if (slot)\r\n                    slot.destroy();\r\n            });\r\n            this.bagSlotList.length = 0;\r\n            this.bagSlotList = null;\r\n        }\r\n        this.tmpWid = 0;\r\n        this.baseBagBgWid = 0;\r\n        this.mResStr = null;\r\n        this.mResPng = null;\r\n        this.mResJson = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    BagGroup.prototype.addListen = function () {\r\n        if (this.mBagBtnCon) {\r\n            this.mBagBtnCon.on("pointerdown", this.bagHandler, this);\r\n            this.mBagBtnCon.on("pointerover", this.bagBtnOver, this);\r\n            this.mBagBtnCon.on("pointerout", this.bagBtnOut, this);\r\n        }\r\n    };\r\n    BagGroup.prototype.removeListen = function () {\r\n        if (this.mBagBtnCon) {\r\n            this.mBagBtnCon.off("pointerdown", this.bagHandler, this);\r\n            this.mBagBtnCon.off("pointerover", this.bagBtnOver, this);\r\n            this.mBagBtnCon.off("pointerout", this.bagBtnOut, this);\r\n        }\r\n    };\r\n    BagGroup.prototype.setDataList = function (items) {\r\n        if (this.bagSlotList) {\r\n            this.bagSlotList.forEach(function (itemslot) {\r\n                if (itemslot)\r\n                    itemslot.getView().visible = false;\r\n            });\r\n        }\r\n        var childList = [];\r\n        var len = items.length > BagGroup.SlotMaxCount ? BagGroup.SlotMaxCount : items.length;\r\n        var tempWid = this.baseBagBgWid + 5;\r\n        for (var i = 0; i < len; i++) {\r\n            var itemSlot = this.bagSlotList[i];\r\n            itemSlot.getView().visible = true;\r\n            childList.push(itemSlot.toolTipCon);\r\n            itemSlot.dataChange(items[i]);\r\n            tempWid += 56 + 5;\r\n        }\r\n        if (this.width !== tempWid) {\r\n            this.width = tempWid;\r\n            if (this.buttons) {\r\n                this.buttons.destroy(true);\r\n                this.buttons = null;\r\n            }\r\n            this.buttons = this.scene.rexUI.add.buttons({\r\n                x: (tempWid + this.mBagBg.width) / 2,\r\n                y: 0,\r\n                width: 56,\r\n                height: 56,\r\n                orientation: 0,\r\n                buttons: childList,\r\n                groupName: "bagBtn",\r\n                align: "right",\r\n                click: {\r\n                    mode: "pointerup",\r\n                    clickInterval: 100\r\n                },\r\n                space: 5,\r\n                name: "bag",\r\n            });\r\n            this.buttons.layout();\r\n            // this.buttons.on("button.click", function (button, groupName, index, pointer) {\r\n            //     if (index === 0) {\r\n            //     }\r\n            // }, this);\r\n            this.setSize(tempWid, 65);\r\n            this.mWorld.uiManager.baseFaceResize();\r\n        }\r\n    };\r\n    BagGroup.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResStr = "bag";\r\n        this.mResPng = "ui/bag/bag.png";\r\n        this.mResJson = "ui/bag/bag.json";\r\n        this.scene.load.atlas(this.mResStr, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResPng), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(this.mResJson));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BagGroup.prototype.init = function () {\r\n        this.mBagBtnCon = this.scene.add.container(0, 0);\r\n        this.mBagBg = this.scene.add.sprite(0, 0, this.mResStr, "bag_BtnBg");\r\n        this.baseBagBgWid = this.mBagBg.width;\r\n        this.tmpWid += this.mBagBg.width + 5;\r\n        this.bagBtn = this.scene.add.sprite(this.mBagBg.x, this.mBagBg.y, this.mResStr, "bag_Btn");\r\n        this.mSubScriptSprite = this.scene.make.sprite(undefined, false);\r\n        this.mSubScriptSprite.setTexture(this.mResStr, "bag_SubScripta");\r\n        this.mSubScriptSprite.x = this.mSubScriptSprite.width - this.mBagBg.width >> 1;\r\n        this.mSubScriptSprite.y = this.mSubScriptSprite.height - this.mBagBg.height >> 1;\r\n        this.mBagBtnCon.addAt(this.mBagBg, 0);\r\n        this.mBagBtnCon.addAt(this.bagBtn, 1);\r\n        // this.mBagBtnCon.addAt(this.mSubScriptSprite, 2);\r\n        this.mBagBtnCon.setSize(56, 56);\r\n        this.mBagBtnCon.setInteractive(new Phaser.Geom.Rectangle(0, 0, this.mBagBg.width, this.mBagBg.height), Phaser.Geom.Rectangle.Contains);\r\n        this.initBagSlot();\r\n        this.setSize(this.tmpWid, 65);\r\n        if (this.mWorld.roomManager.currentRoom && this.mWorld.roomManager.currentRoom.playerManager && this.mWorld.roomManager.currentRoom.playerManager.actor) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items)\r\n                this.setDataList(mPackage.items);\r\n        }\r\n        this.add(this.mBagBtnCon);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BagGroup.prototype.tweenComplete = function (show) {\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show)\r\n            this.mWorld.uiManager.baseFaceResize();\r\n    };\r\n    BagGroup.prototype.initBagSlot = function () {\r\n        var subScriptList = ["0", "b", "c"];\r\n        var subScriptRes;\r\n        for (var i = 0; i < BagGroup.SlotMaxCount; i++) {\r\n            if (i >= 9) {\r\n                subScriptRes = "bag_SubScript" + subScriptList[i % 9];\r\n            }\r\n            else {\r\n                subScriptRes = "bag_SubScript" + (i + 1);\r\n            }\r\n            var itemSlot = new _bag_item_slot__WEBPACK_IMPORTED_MODULE_0__["ItemSlot"](this.scene, this.mWorld, this, 0, 0, this.mResStr, this.mResPng, this.mResJson, "bag_Slot", "", subScriptRes);\r\n            itemSlot.createUI();\r\n            itemSlot.getView().visible = false;\r\n            this.bagSlotList.push(itemSlot);\r\n        }\r\n    };\r\n    BagGroup.prototype.bagHandler = function () {\r\n        // this.mWorld.uiManager.getMediator(FriendMediator.NAME).show();\r\n        var med = this.mWorld.uiManager.getMediator(_bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_4__["BagMediator"].NAME);\r\n        if (med.isShow()) {\r\n            med.hide();\r\n            return;\r\n        }\r\n        med.show();\r\n    };\r\n    BagGroup.prototype.tmpLoad = function () {\r\n        var _this = this;\r\n        if (!this.radio) {\r\n            this.radio = new _components_radio__WEBPACK_IMPORTED_MODULE_2__["Radio"](this.scene, {\r\n                wid: 328,\r\n                hei: 142,\r\n                resKey: "juqingRadio",\r\n                resPng: "./resources/ui/juqing/juqing.png",\r\n                resJson: "./resources/ui/juqing/juqing.json",\r\n                resBg: "radio_bg.png",\r\n                resArrow: "radio_arrow.png",\r\n                fontStyle: { size: 20, color: "#ffcc00", bold: false },\r\n                completeBack: function () {\r\n                    _this.radioComplete();\r\n                },\r\n                clickCallBack: function () {\r\n                    if (_this.radio && _this.radio.parentContainer) {\r\n                        _this.radio.clearRadioData();\r\n                        _this.radio.parentContainer.remove(_this.radio);\r\n                    }\r\n                }\r\n            });\r\n            return;\r\n        }\r\n        if (this.radio.isShow) {\r\n            return;\r\n        }\r\n        this.radioComplete();\r\n    };\r\n    BagGroup.prototype.radioComplete = function () {\r\n        this.radio.setRadioData(["1111111111", "2222222222", "333333333333", "444444444444"]);\r\n        this.radio.x = this.bagBtn.x;\r\n        this.radio.y = this.bagBtn.y - 142;\r\n        this.add(this.radio);\r\n    };\r\n    BagGroup.prototype.bagBtnOver = function (pointer) {\r\n        this.mBagSelect = this.scene.make.sprite(undefined, false);\r\n        this.mBagSelect.setTexture(this.mResStr, "bag_BtnSelect");\r\n        this.mBagBtnCon.add(this.mBagSelect);\r\n        // this.tmpLoad();\r\n    };\r\n    BagGroup.prototype.bagBtnOut = function (pointer) {\r\n        if (this.mBagSelect && this.mBagSelect.parentContainer) {\r\n            this.mBagSelect.parentContainer.remove(this.mBagSelect);\r\n        }\r\n    };\r\n    BagGroup.SlotMaxCount = 12;\r\n    return BagGroup;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_5__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bagGroup/bag.group.ts?')},"./src/ui/baseView/baseFace.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseFaceMediator", function() { return BaseFaceMediator; });\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * 场景UImediator\r\n */\r\nvar BaseFaceMediator = /** @class */ (function (_super) {\r\n    __extends(BaseFaceMediator, _super);\r\n    function BaseFaceMediator(world, scene) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mScene = scene;\r\n        _this.world = world;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_1__["UIType"].Scene;\r\n        return _this;\r\n    }\r\n    BaseFaceMediator.prototype.getView = function () {\r\n        return this.mView;\r\n    };\r\n    BaseFaceMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    BaseFaceMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    BaseFaceMediator.prototype.resize = function () {\r\n        var size = this.world.getSize();\r\n        var view = this.getView();\r\n        if (this.mView && view.isShow()) {\r\n            return this.mView.resize(size.width, size.height);\r\n        }\r\n    };\r\n    BaseFaceMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView)\r\n            this.mView.hide();\r\n    };\r\n    BaseFaceMediator.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return BaseFaceMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_0__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/baseFace.mediator.ts?')},"./src/ui/baseView/bottomGroup/bottom.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottomBtnGroup", function() { return BottomBtnGroup; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _components_check_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/check.button */ "./src/ui/components/check.button.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../rightGroup/right.mediator */ "./src/ui/baseView/rightGroup/right.mediator.ts");\n/* harmony import */ var _ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../ElementStorage/ElementStorageMediator */ "./src/ui/ElementStorage/ElementStorageMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar BottomBtnGroup = /** @class */ (function (_super) {\r\n    __extends(BottomBtnGroup, _super);\r\n    // private mOrientation: Phaser.Scale.Orientation;\r\n    function BottomBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mExpandBoo = false;\r\n        _this.tmpWid = 0;\r\n        _this.tmpHei = 0;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    BottomBtnGroup.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BottomBtnGroup.prototype.addListen = function () {\r\n        this.mChatContainer.on("pointerdown", this.chatHandler, this);\r\n        this.mVoiceBtn.on("selected", this.onSelectedVoiceHandler, this);\r\n        this.mMicBtn.on("selected", this.onSelectedMicHandler, this);\r\n    };\r\n    BottomBtnGroup.prototype.removeListen = function () {\r\n        this.mChatContainer.off("pointerdown", this.chatHandler, this);\r\n        this.mVoiceBtn.off("selected", this.onSelectedVoiceHandler, this);\r\n        this.mMicBtn.off("selected", this.onSelectedMicHandler, this);\r\n    };\r\n    BottomBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.scale = this.mWorld.uiScale;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.x = size.width >> 1;\r\n            this.mVoiceBtn.x = this.mVoiceBtn.width * this.mMicBtn.scaleX - this.mChatContainer.width / 2;\r\n            this.mVoiceBtn.y = -this.mVoiceBtn.height / 2 * this.mVoiceBtn.scaleY - this.mChatContainer.height / 2;\r\n            this.mMicBtn.x = this.mVoiceBtn.x + this.mVoiceBtn.width * this.mMicBtn.scaleX + 20;\r\n            this.mMicBtn.y = this.mVoiceBtn.y;\r\n        }\r\n        else if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.PORTRAIT) {\r\n            this.x = size.width - (this.width / 2 + 40) * this.mWorld.uiScale;\r\n            this.mVoiceBtn.x = this.mVoiceBtn.width - this.mChatContainer.width / 2;\r\n            this.mVoiceBtn.y = this.mChatContainer.y - this.mChatContainer.height / 2 - this.mVoiceBtn.height / 2 * this.mMicBtn.scaleX;\r\n            this.mMicBtn.x = this.mVoiceBtn.x + this.mMicBtn.width * this.mMicBtn.scaleX + 20;\r\n            this.mMicBtn.y = this.mVoiceBtn.y;\r\n        }\r\n        this.y = size.height - 120 * this.mWorld.uiScale;\r\n        var rightMediator = this.mWorld.uiManager.getMediator(_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__["RightMediator"].NAME);\r\n        var rightBtnGroup;\r\n        if (rightMediator) {\r\n            rightBtnGroup = rightMediator.getView();\r\n        }\r\n        if (rightMediator) {\r\n            if (this.mWorld.inputManager) {\r\n                var joyStick = this.mWorld.inputManager;\r\n                joyStick.resize();\r\n            }\r\n            if (rightBtnGroup)\r\n                rightBtnGroup.resize();\r\n        }\r\n        this.mChatText.setStyle({ "fontSize": Math.floor(30 * this.mWorld.uiScale) });\r\n    };\r\n    BottomBtnGroup.prototype.tweenView = function (show) {\r\n        var size = this.mWorld.getSize();\r\n        var baseY = size.height - 120 * this.mWorld.uiScale;\r\n        var toY = show === true ? baseY : baseY + 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    BottomBtnGroup.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.scene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        this.scene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    BottomBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        this.mBtnList = [];\r\n        var size = this.mWorld.getSize();\r\n        this.mWorld.uiManager.getUILayerManager().addToUILayer(this);\r\n        var chatBgWidth = 430;\r\n        var chatBgHeight = 230;\r\n        this.mChatContainer = this.scene.make.container(undefined, false);\r\n        this.mChatBg = this.scene.make.image(undefined, false);\r\n        this.mChatBg.setTexture(this.mResKey, "btnGroup_chatBg.png");\r\n        this.mChatContainer.addAt(this.mChatBg, 0);\r\n        this.mChatText = this.scene.make.text({\r\n            width: chatBgWidth,\r\n            height: chatBgHeight,\r\n            style: { font: "bold YaHei", color: "#666666", fontSize: Math.floor(30 * this.mWorld.uiScale), wordWrap: { width: 430, useAdvancedWrap: true } }\r\n        }, false);\r\n        this.mChatText.setText("点击窗口进入聊天界面");\r\n        this.mChatContainer.addAt(this.mChatText, 1);\r\n        this.mChatContainer.setSize(chatBgWidth, chatBgHeight);\r\n        this.mChatText.x = -this.mChatContainer.width >> 1;\r\n        this.mChatText.y = -this.mChatContainer.height >> 1;\r\n        this.mChatContainer.setInteractive(new Phaser.Geom.Rectangle(0, 0, chatBgWidth, chatBgHeight), Phaser.Geom.Rectangle.Contains);\r\n        this.add(this.mChatContainer);\r\n        this.tmpWid += this.mChatContainer.width;\r\n        this.tmpHei += this.mChatContainer.height;\r\n        this.mTurnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].Turn_Btn_Bottom, bgResKey: this.mResKey, bgTextures: ["btnGroup_white_normal.png", "btnGroup_white_light.png", "btnGroup_white_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_bottom_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mTurnBtn.x = (this.tmpWid >> 1) + 30;\r\n        this.mTurnBtn.y = this.tmpHei - this.mTurnBtn.height >> 1;\r\n        this.mTurnBtn.setPos(this.mTurnBtn.x, this.mTurnBtn.y);\r\n        this.add(this.mTurnBtn);\r\n        this.mBagBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_bag_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mBagBtn.x = this.mTurnBtn.x;\r\n        this.mBagBtn.y = this.mTurnBtn.y - this.mTurnBtn.height / 2 - this.mBagBtn.height / 2 - 10;\r\n        this.mBagBtn.setPos(this.mBagBtn.x, this.mBagBtn.y);\r\n        this.tmpWid += this.mBagBtn.width + 30;\r\n        this.add(this.mBagBtn);\r\n        this.mBtnList.push(this.mBagBtn);\r\n        this.mTurnBtn.setClick(function () {\r\n            _this.turnHandler();\r\n        });\r\n        this.mBagBtn.setClick(function () {\r\n            _this.bagHandler();\r\n        });\r\n        this.mMarketBag = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_bag_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mMarketBag.x = this.mTurnBtn.x;\r\n        this.mMarketBag.y = this.mTurnBtn.y - this.mTurnBtn.height / 2 - this.mBagBtn.height / 2 - 60 - this.mMarketBag.height / 2;\r\n        this.mMarketBag.setPos(this.mMarketBag.x, this.mBagBtn.y);\r\n        this.tmpWid += this.mMarketBag.width + 30;\r\n        this.add(this.mMarketBag);\r\n        this.setSize(this.tmpWid, this.tmpHei);\r\n        this.mBtnList.push(this.mMarketBag);\r\n        this.mMarketBag.setClick(function () {\r\n            _this.marketBagHandler();\r\n        });\r\n        this.mVoiceBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.scene, 0, 0, "chat_atlas", "voice_normal.png", "voice_selected.png");\r\n        this.mVoiceBtn.x = this.width - 60 * this.mWorld.uiScale;\r\n        this.mVoiceBtn.y = size.height - this.height;\r\n        this.add(this.mVoiceBtn);\r\n        this.mMicBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.scene, 0, 0, "chat_atlas", "mic_normal.png", "mic_selected.png");\r\n        this.mMicBtn.x = this.width - 20 * this.mWorld.uiScale;\r\n        this.mMicBtn.y = size.height - this.height;\r\n        this.add(this.mMicBtn);\r\n        this.mVoiceBtn.scaleX = this.mVoiceBtn.scaleY = 1.5;\r\n        this.mMicBtn.scaleX = this.mMicBtn.scaleY = 1.5;\r\n        this.setSize(this.tmpWid, this.tmpHei);\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    BottomBtnGroup.prototype.tweenComplete = function (show) {\r\n        this.resize();\r\n        _super.prototype.tweenComplete.call(this, show);\r\n    };\r\n    BottomBtnGroup.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val === false) {\r\n            this.mMicBtn.selected = false;\r\n        }\r\n        this.emit("selectedVoice", val);\r\n    };\r\n    BottomBtnGroup.prototype.onSelectedMicHandler = function (val) {\r\n        if (this.mVoiceBtn.selected === false) {\r\n            this.mMicBtn.selected = false;\r\n            return;\r\n        }\r\n        this.mMicBtn.selected = val;\r\n        this.emit("selectedMic", val);\r\n    };\r\n    BottomBtnGroup.prototype.turnHandler = function () {\r\n        var _this = this;\r\n        // const med: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // (med.getView() as MainUIMobile).getTopView().removeBtn({ medKey: "RankMediator" });\r\n        // return;\r\n        this.mVoiceBtn.visible = this.mExpandBoo;\r\n        this.mMicBtn.visible = this.mExpandBoo;\r\n        var easeType = this.mExpandBoo ? "Sine.easeIn" : "Sine.easeOut";\r\n        if (this.mChatContainer && this.mChatContainer.parentContainer) {\r\n            var toScaleX = this.mExpandBoo ? 1 : 0;\r\n            var toScaleY = this.mExpandBoo ? 1 : 0;\r\n            this.scene.tweens.add({\r\n                targets: this.mChatContainer,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    scaleX: { value: toScaleX },\r\n                    scaleY: { value: toScaleY }\r\n                }\r\n            });\r\n        }\r\n        if (!this.mBtnList || this.mBtnList.length < 1) {\r\n            this.mExpandBoo = !this.mExpandBoo;\r\n            return;\r\n        }\r\n        var len = this.mBtnList.length;\r\n        var rightMediator = this.mWorld.uiManager.getMediator(_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_7__["RightMediator"].NAME);\r\n        var rightBtnGroup;\r\n        if (rightMediator) {\r\n            rightBtnGroup = rightMediator.getView();\r\n        }\r\n        var _loop_1 = function (i) {\r\n            var btn = this_1.mBtnList[i];\r\n            // const angle: number = (90 * (i + 2) / -180) * Math.PI;\r\n            var toX = this_1.mExpandBoo ? btn.getPos().x : this_1.mChatContainer.width / 2 - Math.abs(btn.getPos().y) - 20;\r\n            var toY = this_1.mExpandBoo ? btn.getPos().y : this_1.mTurnBtn.y;\r\n            this_1.scene.tweens.add({\r\n                targets: btn,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    x: { value: toX },\r\n                    y: { value: toY }\r\n                },\r\n                onComplete: function (tween, targets, ship) {\r\n                    if (i === len - 1) {\r\n                        _this.mExpandBoo = !_this.mExpandBoo;\r\n                        if (!_this.mExpandBoo) {\r\n                            _this.setSize(_this.tmpWid, _this.tmpHei);\r\n                        }\r\n                        else {\r\n                            _this.setSize(_this.tmpWid, btn.height * 2);\r\n                        }\r\n                        if (rightMediator) {\r\n                            if (_this.mWorld.inputManager) {\r\n                                var joyStick = _this.mWorld.inputManager;\r\n                                joyStick.resize();\r\n                            }\r\n                            if (rightBtnGroup)\r\n                                rightBtnGroup.resize();\r\n                        }\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1]\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    BottomBtnGroup.prototype.chatHandler = function () {\r\n        // ======================show chatView\r\n        var chatMed = this.mWorld.uiManager.getMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"].NAME);\r\n        if (chatMed === undefined) {\r\n            chatMed = new _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"](this.mWorld, this.scene);\r\n            this.mWorld.uiManager.setMediator(_chat_chat_mediator__WEBPACK_IMPORTED_MODULE_4__["ChatMediator"].NAME, chatMed);\r\n        }\r\n        var showBoo = chatMed.isShow();\r\n        if (showBoo) {\r\n            // chatMed.hide();\r\n        }\r\n        else {\r\n            chatMed.show();\r\n        }\r\n        // =====================tween out/in baseView\r\n        this.mWorld.uiManager.baseFaceTween(false);\r\n    };\r\n    BottomBtnGroup.prototype.bagHandler = function () {\r\n        // this.mWorld.closeGame();\r\n        this.mWorld.uiManager.getMediator(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_3__["UIMediatorType"].BagMediator).show();\r\n        // =============index = 0 为背包按钮\r\n    };\r\n    BottomBtnGroup.prototype.marketBagHandler = function () {\r\n        // test code\r\n        var mediator = this.mWorld.uiManager.getMediator(_ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__["ElementStorageMediator"].name);\r\n        if (!mediator) {\r\n            mediator = new _ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__["ElementStorageMediator"](this.mWorld.uiManager.getUILayerManager(), this.scene, this.mWorld);\r\n            this.mWorld.uiManager.setMediator(_ElementStorage_ElementStorageMediator__WEBPACK_IMPORTED_MODULE_8__["ElementStorageMediator"].name, mediator);\r\n        }\r\n        if (mediator.isShow()) {\r\n            mediator.hide();\r\n        }\r\n        else {\r\n            mediator.show(true);\r\n        }\r\n    };\r\n    return BottomBtnGroup;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bottomGroup/bottom.btn.group.ts?')},"./src/ui/baseView/bottomGroup/bottom.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottomMediator", function() { return BottomMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _bottom_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./bottom.btn.group */ "./src/ui/baseView/bottomGroup/bottom.btn.group.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar BottomMediator = /** @class */ (function (_super) {\r\n    __extends(BottomMediator, _super);\r\n    function BottomMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    BottomMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _bottom_btn_group__WEBPACK_IMPORTED_MODULE_1__["BottomBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    BottomMediator.NAME = "BottomMediator";\r\n    return BottomMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/bottomGroup/bottom.mediator.ts?')},"./src/ui/baseView/icon.btn.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IconBtn", function() { return IconBtn; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n/**\r\n * 多帧资源按钮\r\n */\r\nvar IconBtn = /** @class */ (function (_super) {\r\n    __extends(IconBtn, _super);\r\n    // // 按钮打开模块的name，用于打开和关闭此模块及模块更新时，主界面按钮的更新（显示和隐藏）\r\n    // private medName: string;\r\n    function IconBtn(scene, world, data) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mBtnBg = scene.make.image(undefined, false);\r\n        _this.mBgResKey = data.bgResKey;\r\n        _this.mBgTexture = data.bgTextures;\r\n        _this.mData = data;\r\n        if (!_this.mScene.textures.exists(_this.mBgResKey) && data.pngUrl && data.jsonUrl) {\r\n            _this.mScene.load.atlas(data.key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(data.pngUrl), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes(data.jsonUrl));\r\n            _this.mScene.load.once(Phaser.Loader.Events.COMPLETE, _this.loadComplete, _this);\r\n            _this.mScene.load.start();\r\n            return _this;\r\n        }\r\n        _this.loadComplete();\r\n        return _this;\r\n    }\r\n    // public setMedName(name: string) {\r\n    //     this.medName = name;\r\n    // }\r\n    IconBtn.prototype.getKey = function () {\r\n        return this.mData.key;\r\n    };\r\n    IconBtn.prototype.setPos = function (x, y) {\r\n        if (!this.mBasePos) {\r\n            this.mBasePos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mBasePos.x = x;\r\n        this.mBasePos.y = y;\r\n    };\r\n    /**\r\n     * 获取按钮的初始化时的位置，用于tween时，按钮来回切换位置用\r\n     */\r\n    IconBtn.prototype.getPos = function () {\r\n        return this.mBasePos;\r\n    };\r\n    IconBtn.prototype.setBtnData = function (value) {\r\n        this.mBtnData = value;\r\n    };\r\n    IconBtn.prototype.getBtnData = function () {\r\n        return this.mBtnData;\r\n    };\r\n    IconBtn.prototype.setClick = function (func) {\r\n        this.monClick = func;\r\n    };\r\n    IconBtn.prototype.destroy = function () {\r\n        if (this.mBtnBg) {\r\n            this.mBtnBg.destroy(true);\r\n        }\r\n        if (this.mBtnIcon) {\r\n            this.mBtnIcon.destroy(true);\r\n        }\r\n        this.monClick = null;\r\n        this.mBtnBg = null;\r\n        this.mBtnIcon = null;\r\n        this.mBtnData = null;\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    IconBtn.prototype.loadComplete = function () {\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[0]);\r\n        this.mBtnBg.scaleX = this.mBtnBg.scaleY = this.mData.scale;\r\n        this.addAt(this.mBtnBg, 0);\r\n        if (this.mData.iconResKey && this.mData.iconTexture && this.mData.iconTexture.length > 0) {\r\n            this.mBtnIcon = this.mScene.make.image(undefined, false);\r\n            this.mBtnIcon.setTexture(this.mData.iconResKey, this.mData.iconTexture);\r\n            this.add(this.mBtnIcon);\r\n        }\r\n        this.setSize(this.mBtnBg.width, this.mBtnBg.height);\r\n        this.setInteractive();\r\n        this.on("pointerup", this.upHandler, this);\r\n        this.on("pointerdown", this.downHandler, this);\r\n        this.on("pointerover", this.overHandler, this);\r\n        this.on("pointerout", this.outHandler, this);\r\n    };\r\n    IconBtn.prototype.overHandler = function (pointer) {\r\n        if (this.mBgTexture.length < 2) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[1]);\r\n    };\r\n    IconBtn.prototype.outHandler = function (pointer) {\r\n        if (this.mBgTexture.length < 2) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[0]);\r\n    };\r\n    IconBtn.prototype.upHandler = function () {\r\n        if (this.monClick) {\r\n            this.monClick();\r\n        }\r\n        if (this.mData && this.mData.callBack) {\r\n            this.mData.callBack.apply(this);\r\n        }\r\n        this.emit("click", this);\r\n        if (this.mBgTexture.length < 3) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[2]);\r\n    };\r\n    IconBtn.prototype.downHandler = function () {\r\n        // this.scaleHandler();\r\n        if (this.mBgTexture.length < 4) {\r\n            return;\r\n        }\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[3]);\r\n    };\r\n    IconBtn.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    return IconBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/icon.btn.ts?')},"./src/ui/baseView/icon.select.btn.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IconSelectBtn", function() { return IconSelectBtn; });\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n/**\r\n * 切换状态按钮(点击后状态改变的按钮，需要多帧资源)\r\n */\r\nvar IconSelectBtn = /** @class */ (function (_super) {\r\n    __extends(IconSelectBtn, _super);\r\n    function IconSelectBtn(scene, world, bgResKey, bgTexture, scale) {\r\n        if (scale === void 0) { scale = 28 / 43; }\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mBtnBg = scene.make.image(undefined, false);\r\n        _this.mBgTexture = bgTexture;\r\n        _this.mBgResKey = bgResKey;\r\n        _this.mBtnBg.setTexture(bgResKey, bgTexture[0]);\r\n        _this.mBtnBg.scaleX = _this.mBtnBg.scaleY = scale;\r\n        _this.addAt(_this.mBtnBg, 0);\r\n        _this.setSize(_this.mBtnBg.width, _this.mBtnBg.height);\r\n        _this.setInteractive();\r\n        _this.on("pointerup", _this.upHandler, _this);\r\n        _this.on("pointerdown", _this.downHandler, _this);\r\n        _this.on("pointerover", _this.overHandler, _this);\r\n        _this.on("pointerout", _this.outHandler, _this);\r\n        return _this;\r\n    }\r\n    IconSelectBtn.prototype.setPos = function (x, y) {\r\n        if (!this.mBasePos) {\r\n            this.mBasePos = new _utils_pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]();\r\n        }\r\n        this.mBasePos.x = x;\r\n        this.mBasePos.y = y;\r\n    };\r\n    /**\r\n     * 获取按钮的初始化时的位置，用于tween时，按钮来回切换位置用\r\n     */\r\n    IconSelectBtn.prototype.getPos = function () {\r\n        return this.mBasePos;\r\n    };\r\n    IconSelectBtn.prototype.setBtnData = function (value) {\r\n        this.mBtnData = value;\r\n    };\r\n    IconSelectBtn.prototype.getBtnData = function () {\r\n        return this.mBtnData;\r\n    };\r\n    IconSelectBtn.prototype.setClick = function (func) {\r\n        this.monClick = func;\r\n    };\r\n    IconSelectBtn.prototype.setBgRes = function (index) {\r\n        this.mBtnBg.setTexture(this.mBgResKey, this.mBgTexture[index] || 0);\r\n    };\r\n    IconSelectBtn.prototype.destroy = function () {\r\n        if (this.mBtnBg) {\r\n            this.mBtnBg.destroy(true);\r\n        }\r\n        if (this.mBtnIcon) {\r\n            this.mBtnIcon.destroy(true);\r\n        }\r\n        this.monClick = null;\r\n        this.mBtnBg = null;\r\n        this.mBtnIcon = null;\r\n        this.mBtnData = null;\r\n        this.mScene = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    IconSelectBtn.prototype.overHandler = function (pointer) {\r\n    };\r\n    IconSelectBtn.prototype.outHandler = function (pointer) {\r\n    };\r\n    IconSelectBtn.prototype.upHandler = function () {\r\n        if (this.monClick) {\r\n            this.monClick();\r\n        }\r\n    };\r\n    IconSelectBtn.prototype.downHandler = function () {\r\n        this.scaleHandler();\r\n    };\r\n    IconSelectBtn.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    return IconSelectBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/icon.select.btn.ts?')},"./src/ui/baseView/leftGroup/left.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LeftBtnGroup", function() { return LeftBtnGroup; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_select_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.select.btn */ "./src/ui/baseView/icon.select.btn.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar LeftBtnGroup = /** @class */ (function (_super) {\r\n    __extends(LeftBtnGroup, _super);\r\n    function LeftBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mCollapse = false;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    LeftBtnGroup.prototype.show = function (param) {\r\n        this.scale = this.mWorld.uiScale;\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    LeftBtnGroup.prototype.resize = function () {\r\n        this.x = this.width + 5 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        this.scale = this.mWorld.uiScale;\r\n    };\r\n    LeftBtnGroup.prototype.destroy = function () {\r\n        if (this.mExpandBtn) {\r\n            this.mExpandBtn.destroy();\r\n        }\r\n        this.mResKey = "";\r\n        this.mExpandBtn = null;\r\n        this.mCollapse = false;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    LeftBtnGroup.prototype.tweenView = function (show) {\r\n        var baseX = this.width + 5 * this.mWorld.uiScale;\r\n        var toX = show === true ? baseX : baseX - 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    LeftBtnGroup.prototype.addListen = function () {\r\n    };\r\n    LeftBtnGroup.prototype.removeListen = function () {\r\n    };\r\n    LeftBtnGroup.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.scene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    LeftBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        this.mWorld.uiManager.getUILayerManager().addToUILayer(this);\r\n        var hei = 0;\r\n        // const btnResList: string[] = this.mCollapse === false ? ["btnGroup_expand.png", "btnGroup_expand.png", "btnGroup_collapse.png", "btnGroup_collapse.png"] : ["btnGroup_collapse.png", "btnGroup_collapse.png", "btnGroup_expand.png", "btnGroup_expand.png"];\r\n        if (this.mWorld.getConfig().platform !== "app") {\r\n            this.mExpandBtn = new _icon_select_btn__WEBPACK_IMPORTED_MODULE_2__["IconSelectBtn"](this.scene, this.mWorld, this.mResKey, ["btnGroup_expand.png", "btnGroup_collapse.png"], 1);\r\n            this.add(this.mExpandBtn);\r\n            this.mExpandBtn.setClick(function () {\r\n                if (!_this.mCollapse) {\r\n                    _this.mWorld.startFullscreen();\r\n                }\r\n                else {\r\n                    _this.mWorld.stopFullscreen();\r\n                }\r\n                _this.mExpandBtn.setBgRes(Number(!_this.mCollapse));\r\n                _this.mCollapse = !_this.mCollapse;\r\n            });\r\n            hei += this.mExpandBtn.height / 2 + 20;\r\n            this.setSize(this.mExpandBtn.width, hei);\r\n        }\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    return LeftBtnGroup;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/leftGroup/left.btn.group.ts?')},"./src/ui/baseView/leftGroup/left.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LeftMediator", function() { return LeftMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _left_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./left.btn.group */ "./src/ui/baseView/leftGroup/left.btn.group.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar LeftMediator = /** @class */ (function (_super) {\r\n    __extends(LeftMediator, _super);\r\n    function LeftMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    LeftMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _left_btn_group__WEBPACK_IMPORTED_MODULE_1__["LeftBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    LeftMediator.NAME = "LeftMediator";\r\n    return LeftMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/leftGroup/left.mediator.ts?')},"./src/ui/baseView/rightGroup/right.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RightBtnGroup", function() { return RightBtnGroup; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _bag_item_slot__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bag/item.slot */ "./src/ui/bag/item.slot.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../bottomGroup/bottom.mediator */ "./src/ui/baseView/bottomGroup/bottom.mediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar RightBtnGroup = /** @class */ (function (_super) {\r\n    __extends(RightBtnGroup, _super);\r\n    function RightBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mBtnY = 0;\r\n        _this.mWid = 0;\r\n        _this.mHei = 0;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    RightBtnGroup.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RightBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.refreshSlot();\r\n        var bottomMed = this.mWorld.uiManager.getMediator(_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_7__["BottomMediator"].NAME);\r\n        var padHei = !bottomMed ? this.height / 2 : bottomMed.getView().height;\r\n        this.scale = this.mWorld.uiScale;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            this.y = size.height - (this.height) * this.mWorld.uiScale;\r\n            this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            if (mPackage && mPackage.items && mPackage.items.length > 0) {\r\n                this.y = size.height - (this.height / 2) * this.mWorld.uiScale;\r\n                this.x = size.width - (this.width / 4) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                this.y = size.height - (this.height) * this.mWorld.uiScale;\r\n                this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            }\r\n        }\r\n        else if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.PORTRAIT) {\r\n            this.y = size.height - (padHei + this.height / 2) * this.mWorld.uiScale;\r\n            this.x = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n        }\r\n    };\r\n    RightBtnGroup.prototype.hide = function () {\r\n        _super.prototype.hide.call(this);\r\n        this.destroy();\r\n    };\r\n    RightBtnGroup.prototype.destroy = function () {\r\n        this.mBtnY = 0;\r\n        this.mWid = 0;\r\n        this.mHei = 0;\r\n        if (this.mBagSlotList) {\r\n            this.mBagSlotList.forEach(function (itemslot) {\r\n                if (itemslot) {\r\n                    itemslot.destroy();\r\n                    itemslot = null;\r\n                }\r\n            });\r\n        }\r\n        this.mResKey = "";\r\n        this.mBagSlotList = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RightBtnGroup.prototype.tweenView = function (show) {\r\n        var size = this.mWorld.getSize();\r\n        var baseX;\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items && mPackage.items.length > 0) {\r\n                baseX = size.width - (this.width / 4) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                baseX = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n            }\r\n        }\r\n        else {\r\n            baseX = size.width - (this.width / 2) * this.mWorld.uiScale;\r\n        }\r\n        var toX = show === true ? baseX : baseX + this.width;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    RightBtnGroup.prototype.refreshSlot = function () {\r\n        if (!this.handBtn)\r\n            return;\r\n        this.mHei = this.handBtn.height;\r\n        if (this.mBagSlotList) {\r\n            this.mBagSlotList.forEach(function (itemslot) {\r\n                if (itemslot) {\r\n                    itemslot.getView().visible = false;\r\n                }\r\n            });\r\n            // =============获取角色背包前几位物品\r\n            var mPackage = this.mWorld.roomManager.currentRoom.playerManager.actor.package;\r\n            if (mPackage && mPackage.items) {\r\n                var items = mPackage.items;\r\n                var len = items.length > RightBtnGroup.SlotMaxCount ? RightBtnGroup.SlotMaxCount : items.length;\r\n                var posX = 0;\r\n                var posY = 0;\r\n                var radio = 110;\r\n                var slotSize = 56;\r\n                var baseAngle = 38;\r\n                for (var i = 0; i < len; i++) {\r\n                    if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                        var angle = (baseAngle * (i + 2) / -180) * Math.PI;\r\n                        posX = radio * Math.cos(angle);\r\n                        posY = this.handBtn.y + radio * Math.sin(angle);\r\n                        if (i === len - 1) {\r\n                            this.mWid = radio + this.handBtn.width + 30 + slotSize / 2;\r\n                            this.mHei = radio + this.handBtn.height + 30 + slotSize / 2;\r\n                        }\r\n                    }\r\n                    else {\r\n                        posX = 0;\r\n                        posY = -slotSize * (i + 1) - 20 * i;\r\n                        if (i === len - 1) {\r\n                            this.mWid = this.handBtn.width;\r\n                            this.mHei = slotSize * (len - 1) + 5 * (len - 2) + this.handBtn.height + 5;\r\n                        }\r\n                    }\r\n                    var itemSlot = this.mBagSlotList[i];\r\n                    itemSlot.getView().visible = true;\r\n                    itemSlot.toolTipCon.x = posX;\r\n                    itemSlot.toolTipCon.y = posY;\r\n                    itemSlot.dataChange(items[i]);\r\n                }\r\n            }\r\n        }\r\n        this.setSize(this.mWid, this.mHei);\r\n    };\r\n    RightBtnGroup.prototype.tweenComplete = function (show) {\r\n        this.resize();\r\n        _super.prototype.tweenComplete.call(this, show);\r\n    };\r\n    RightBtnGroup.prototype.preload = function () {\r\n        this.mResKey = "baseView";\r\n        this.scene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    RightBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        var size = this.mWorld.getSize();\r\n        this.mWorld.uiManager.getUILayerManager().addToUILayer(this);\r\n        this.mBtnY = 0;\r\n        this.handBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_1__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_6__["BagMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_bg.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_hand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.handBtn.x = 0;\r\n        this.handBtn.y = this.mBtnY + this.handBtn.height / 2;\r\n        this.handBtn.setClick(function () {\r\n            // f键值为70，点击该按钮交互\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_5__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_GATEWAY_KEYBOARD_DOWN);\r\n            var content = pkt.content;\r\n            content.keyCodes = [70];\r\n            _this.mWorld.connection.send(pkt);\r\n            // ========临时调试用\r\n            // const mainUIMed: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n            // mainUIMed.tweenView(false);\r\n            // this.mWorld.uiManager.getMediator(BagMediator.NAME).show();\r\n        });\r\n        this.add(this.handBtn);\r\n        this.mWid = this.handBtn.width;\r\n        this.mHei = this.handBtn.height;\r\n        this.initBagSlotData();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    RightBtnGroup.prototype.initBagSlotData = function () {\r\n        this.mBagSlotList = [];\r\n        var size = this.mWorld.getSize();\r\n        var len = RightBtnGroup.SlotMaxCount;\r\n        var posX = 0;\r\n        var posY = 0;\r\n        for (var i = 0; i < len; i++) {\r\n            var itemSlot = new _bag_item_slot__WEBPACK_IMPORTED_MODULE_2__["ItemSlot"](this.scene, this.mWorld, this, posX, posY, this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/baseView/mainui_mobile.json"), "btnGroup_bg.png");\r\n            itemSlot.createUI();\r\n            itemSlot.getBg().scaleX = itemSlot.getBg().scaleY = 0.8;\r\n            itemSlot.getIcon().scaleX = itemSlot.getIcon().scaleY = 1.2;\r\n            this.mBagSlotList.push(itemSlot);\r\n            this.add(itemSlot.toolTipCon);\r\n            itemSlot.getView().visible = false;\r\n        }\r\n        this.resize();\r\n    };\r\n    RightBtnGroup.SlotMaxCount = 4;\r\n    return RightBtnGroup;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/rightGroup/right.btn.group.ts?')},"./src/ui/baseView/rightGroup/right.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RightMediator", function() { return RightMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _right_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./right.btn.group */ "./src/ui/baseView/rightGroup/right.btn.group.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar RightMediator = /** @class */ (function (_super) {\r\n    __extends(RightMediator, _super);\r\n    function RightMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    RightMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    RightMediator.prototype.show = function (param) {\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _right_btn_group__WEBPACK_IMPORTED_MODULE_1__["RightBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    RightMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].UPDATED_CHARACTER_PACKAGE, this.heroItemChange, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_2__["MessageType"].PACKAGE_ITEM_ADD, this.heroItemChange, this);\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    RightMediator.prototype.heroItemChange = function () {\r\n        if (!this.world.roomManager.currentRoom || !this.world.roomManager.currentRoom.playerManager || !this.world.roomManager.currentRoom.playerManager.actor)\r\n            return;\r\n        if (this.mView) {\r\n            if (this.mView)\r\n                this.mView.refreshSlot();\r\n        }\r\n    };\r\n    RightMediator.NAME = "RightMediator";\r\n    return RightMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/rightGroup/right.mediator.ts?')},"./src/ui/baseView/top.menu/top.menu.container.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMenuContainer", function() { return TopMenuContainer; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar TopMenuContainer = /** @class */ (function (_super) {\r\n    __extends(TopMenuContainer, _super);\r\n    function TopMenuContainer(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.maxNum = 3;\r\n        _this.setTween(false);\r\n        _this.mButtons = [];\r\n        return _this;\r\n    }\r\n    TopMenuContainer.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - 50 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 120 * this.mWorld.uiScale;\r\n        this.scale = this.dpr;\r\n        // this.scaleX = this.scaleY = this.mWorld.uiScale;\r\n    };\r\n    TopMenuContainer.prototype.show = function () {\r\n        if (this.mWorld) {\r\n            this.mWorld.uiManager.getUILayerManager().addToUILayer(this);\r\n        }\r\n        _super.prototype.show.call(this);\r\n    };\r\n    TopMenuContainer.prototype.hide = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    TopMenuContainer.prototype.addItem = function (data) {\r\n        // if (!this.mShowing) {\r\n        //   this.show();\r\n        // }\r\n        // // TODO dynamic load texture\r\n        // const iconBtn = new IconBtn(this.scene, this.mWorld, data);\r\n        // iconBtn.setName(data.name);\r\n        // iconBtn.y = iconBtn.height >> 1;\r\n        // this.add(iconBtn);\r\n        // iconBtn.on("click", this.onGameObjectUpHandler, this);\r\n        // this.mButtons.push(iconBtn);\r\n        // if (this.mButtons.length > 3) {\r\n        //   // TODO add turn button\r\n        // }\r\n        // this.refresh();\r\n    };\r\n    TopMenuContainer.prototype.removeItem = function (name) {\r\n        var index = this.mButtons.findIndex(function (icon) { return icon.name === name; });\r\n        if (index >= 0) {\r\n            this.mButtons[index].destroy();\r\n            this.mButtons.splice(index, 1);\r\n        }\r\n        if (this.mButtons.length < this.maxNum) {\r\n            // TODO remove turn button\r\n        }\r\n        if (this.mButtons.length === 0) {\r\n            // TODO remove\r\n            this.hide();\r\n        }\r\n        this.refresh();\r\n    };\r\n    TopMenuContainer.prototype.preload = function () {\r\n        this.scene.load.atlas("baseView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    TopMenuContainer.prototype.init = function () {\r\n        if (this.mInitialized) {\r\n            return;\r\n        }\r\n        _super.prototype.init.call(this);\r\n        // this.addItem({ key: "Turn_Btn_Top", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"], iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1 });\r\n        this.resize();\r\n    };\r\n    TopMenuContainer.prototype.refresh = function () {\r\n        for (var i = 0; i < this.mButtons.length; i++) {\r\n            this.mButtons[i].x = -(i * 60 + 30);\r\n        }\r\n    };\r\n    TopMenuContainer.prototype.expand = function () {\r\n    };\r\n    TopMenuContainer.prototype.collapse = function () {\r\n    };\r\n    TopMenuContainer.prototype.destroy = function () {\r\n        this.mButtons.map(function (btn) { return btn.destroy(); });\r\n        this.mButtons.length = 0;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopMenuContainer.prototype.onGameObjectUpHandler = function (btn) {\r\n        switch (btn.name) {\r\n            case "SaveDecorate":\r\n                this.emit("saveDecorate");\r\n                break;\r\n            case "EnterDecorate":\r\n                this.emit("enterDecorate");\r\n                break;\r\n            case "Market":\r\n                this.emit("showMarket");\r\n                break;\r\n        }\r\n    };\r\n    return TopMenuContainer;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/top.menu/top.menu.container.ts?')},"./src/ui/baseView/top.menu/top.menu.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMenuMediator", function() { return TopMenuMediator; });\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _top_menu_container__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./top.menu.container */ "./src/ui/baseView/top.menu/top.menu.container.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopMenuMediator = /** @class */ (function (_super) {\r\n    __extends(TopMenuMediator, _super);\r\n    function TopMenuMediator(scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.scene = scene;\r\n        _this.world = world;\r\n        return _this;\r\n        // this.mMenuPanel = new TopMenuContainer(scene, world);\r\n        // this.onAddIconHandler({ key: "Turn_Btn_Top", name: "SaveDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"], iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1 });\r\n    }\r\n    TopMenuMediator.prototype.show = function () {\r\n        this.register();\r\n    };\r\n    TopMenuMediator.prototype.hide = function () {\r\n        this.unregister();\r\n    };\r\n    TopMenuMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    TopMenuMediator.prototype.register = function () {\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].ADD_ICON_TO_TOP, this.onAddIconHandler, this);\r\n        this.world.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].REMOVE_ICON_FROM_TOP, this.onAddIconHandler, this);\r\n    };\r\n    TopMenuMediator.prototype.unregister = function () {\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].ADD_ICON_TO_TOP, this.onAddIconHandler, this);\r\n        this.world.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].REMOVE_ICON_FROM_TOP, this.onRemoveIcon, this);\r\n    };\r\n    TopMenuMediator.prototype.destroy = function () {\r\n        this.hide();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopMenuMediator.prototype.addItem = function (data) {\r\n        if (!this.mView) {\r\n            this.mView = new _top_menu_container__WEBPACK_IMPORTED_MODULE_1__["TopMenuContainer"](this.scene, this.world);\r\n            this.mView.on("saveDecorate", this.onSaveDecorateHandler, this);\r\n            this.mView.on("enterDecorate", this.onEnterDecorateHandler, this);\r\n            this.mView.on("showMarket", this.onShowMarketHandler, this);\r\n        }\r\n        this.mView.addItem(data);\r\n    };\r\n    TopMenuMediator.prototype.removeItem = function (name) {\r\n        if (!this.mView) {\r\n            return;\r\n        }\r\n        this.mView.removeItem(name);\r\n    };\r\n    TopMenuMediator.prototype.onAddIconHandler = function (data) {\r\n        this.addItem(data);\r\n    };\r\n    TopMenuMediator.prototype.onRemoveIcon = function (name) {\r\n        this.removeItem(name);\r\n    };\r\n    TopMenuMediator.prototype.onSaveDecorateHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_LEAVE);\r\n        var content = packet.content;\r\n        content.needSaveEditScene = true;\r\n        this.world.connection.send(packet);\r\n    };\r\n    TopMenuMediator.prototype.onEnterDecorateHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n        this.world.connection.send(packet);\r\n    };\r\n    TopMenuMediator.prototype.onShowMarketHandler = function () {\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_2__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_3__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI);\r\n        var content = packet.content;\r\n        content.name = "Market";\r\n        this.world.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_0__["MessageType"].SHOW_UI, packet);\r\n    };\r\n    TopMenuMediator.NAME = "TopMenuMediator";\r\n    return TopMenuMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_4__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/top.menu/top.menu.mediator.ts?')},"./src/ui/baseView/topGroup/top.btn.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopBtnGroup", function() { return TopBtnGroup; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _icon_btn__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../DebugLogger/DebugLoggerMediator */ "./src/ui/DebugLogger/DebugLoggerMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopBtnGroup = /** @class */ (function (_super) {\r\n    __extends(TopBtnGroup, _super);\r\n    function TopBtnGroup(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        // private mWid: number = 0;\r\n        _this.mBtnPad = 10;\r\n        _this.mBtnX = 0;\r\n        _this.mExpandBoo = false;\r\n        _this.mOrientation = Phaser.Scale.Orientation.LANDSCAPE;\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    TopBtnGroup.prototype.show = function (param) {\r\n        this.scale = this.mWorld.uiScale;\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    TopBtnGroup.prototype.resize = function () {\r\n        var size = this.mWorld.getSize();\r\n        this.x = size.width - 50 * this.mWorld.uiScale;\r\n        this.y = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        this.scale = this.mWorld.uiScale;\r\n    };\r\n    TopBtnGroup.prototype.destroy = function () {\r\n        this.mBtnX = 0;\r\n        if (this.mTurnBtn) {\r\n            this.mTurnBtn.destroy();\r\n        }\r\n        if (this.mReturnBtn) {\r\n            this.mReturnBtn.destroy();\r\n        }\r\n        if (this.mDebugBtn) {\r\n            this.mDebugBtn.destroy();\r\n        }\r\n        if (this.mBtnList) {\r\n            this.mBtnList.forEach(function (btn) {\r\n                if (btn) {\r\n                    btn.destroy();\r\n                    btn = null;\r\n                }\r\n            });\r\n        }\r\n        this.mResKey = "";\r\n        this.mBtnList = null;\r\n        this.mTurnBtn = null;\r\n        this.mReturnBtn = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TopBtnGroup.prototype.tweenView = function (show) {\r\n        if (!this.scene)\r\n            return;\r\n        var baseY = this.height / 2 + 10 * this.mWorld.uiScale;\r\n        var toY = show === true ? baseY : baseY - 50;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                y: { value: toY },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    TopBtnGroup.prototype.addBtn = function (data) {\r\n        if (!this.mAddBtnDataList)\r\n            this.mAddBtnDataList = [];\r\n        if (!this.mInitialized) {\r\n            this.mAddBtnDataList.push(data);\r\n            return;\r\n        }\r\n        var btn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, data);\r\n        this.mBtnList.push(btn);\r\n        this.btnRefreshPos();\r\n    };\r\n    TopBtnGroup.prototype.removeBtn = function (key) {\r\n        if (this.mRemoveBtnKeyList)\r\n            this.mRemoveBtnKeyList = [];\r\n        if (!this.mInitialized) {\r\n            this.mRemoveBtnKeyList.push(key);\r\n            return;\r\n        }\r\n        for (var i = 0, len = this.mBtnList.length; i < len; i++) {\r\n            var btn = this.mBtnList[i];\r\n            if (!btn)\r\n                continue;\r\n            var btnKey = btn.getKey();\r\n            if (btnKey && btnKey === key) {\r\n                btn.destroy();\r\n                btn = null;\r\n                this.mBtnList.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n        this.btnRefreshPos();\r\n    };\r\n    TopBtnGroup.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.mResKey = "baseView";\r\n        this.scene.load.atlas(this.mResKey, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/baseView/mainui_mobile.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    TopBtnGroup.prototype.init = function () {\r\n        var _this = this;\r\n        var hei = 0;\r\n        var wid = 0;\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        this.mBtnList = [];\r\n        this.mBtnX = 0;\r\n        this.mTurnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__["UIMediatorType"].Turn_Btn_Top, bgResKey: this.mResKey, bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n        this.mTurnBtn.x = this.mBtnX;\r\n        this.mTurnBtn.setPos(this.mBtnX, 0);\r\n        wid += this.mTurnBtn.width + this.mBtnPad;\r\n        this.add(this.mTurnBtn);\r\n        this.mBtnX += -this.mTurnBtn.width - this.mBtnPad;\r\n        hei += this.mTurnBtn.height / 2 + 20;\r\n        if (!this.mWorld.game.device.os.desktop) {\r\n            this.mReturnBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n                key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_4__["UIMediatorType"].App_Back, bgResKey: this.mResKey, bgTextures: ["btnGroup_white_normal.png", "btnGroup_white_light.png", "btnGroup_white_select.png"],\r\n                iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n            });\r\n            this.mReturnBtn.x = this.mBtnX;\r\n            this.mReturnBtn.setPos(this.mBtnX, 0);\r\n            this.mBtnList.push(this.mReturnBtn);\r\n            wid += this.mReturnBtn.width + this.mBtnPad;\r\n            this.add(this.mReturnBtn);\r\n            this.mBtnX += -this.mReturnBtn.width - this.mBtnPad;\r\n            this.mDebugBtn = new _icon_btn__WEBPACK_IMPORTED_MODULE_2__["IconBtn"](this.scene, this.mWorld, {\r\n                key: _DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME, bgResKey: this.mResKey, bgTextures: ["btnGroup_blue_normal.png", "btnGroup_blue_light.png", "btnGroup_blue_select.png"],\r\n                iconResKey: this.mResKey, iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n            });\r\n            this.mDebugBtn.x = this.mBtnX;\r\n            this.mDebugBtn.setPos(this.mBtnX, 0);\r\n            this.mBtnList.push(this.mDebugBtn);\r\n            wid += this.mDebugBtn.width + this.mBtnPad;\r\n            this.add(this.mDebugBtn);\r\n            this.mReturnBtn.setClick(function () {\r\n                _this.mWorld.closeGame();\r\n            });\r\n            this.mDebugBtn.setClick(function () {\r\n                var debugLogMed = _this.mWorld.uiManager.getMediator(_DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME);\r\n                if (!debugLogMed) {\r\n                    _this.mWorld.uiManager.setMediator(_DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME, new _DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"](_this.mWorld.uiManager.getUILayerManager(), _this.scene, _this.mWorld));\r\n                    debugLogMed = _this.mWorld.uiManager.getMediator(_DebugLogger_DebugLoggerMediator__WEBPACK_IMPORTED_MODULE_3__["DebugLoggerMediator"].NAME);\r\n                }\r\n                if (debugLogMed.isShow()) {\r\n                    debugLogMed.hide();\r\n                    return;\r\n                }\r\n                debugLogMed.show();\r\n            });\r\n        }\r\n        this.setSize(wid, hei);\r\n        this.mTurnBtn.setClick(function () {\r\n            _this.turnHandler();\r\n        });\r\n        this.resize();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    TopBtnGroup.prototype.tweenComplete = function (show) {\r\n        var _this = this;\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        if (show) {\r\n            if (this.mAddBtnDataList) {\r\n                this.mAddBtnDataList.forEach(function (btnData) {\r\n                    _this.addBtn(btnData);\r\n                });\r\n            }\r\n            if (this.mRemoveBtnKeyList) {\r\n                this.mRemoveBtnKeyList.forEach(function (key) {\r\n                    _this.removeBtn(key);\r\n                });\r\n            }\r\n        }\r\n    };\r\n    TopBtnGroup.prototype.turnHandler = function () {\r\n        var _this = this;\r\n        if (!this.mBtnList && this.mBtnList.length < 1) {\r\n            return;\r\n        }\r\n        var len = this.mBtnList.length;\r\n        var _loop_1 = function (i) {\r\n            var btn = this_1.mBtnList[i];\r\n            var toX = this_1.mExpandBoo ? btn.getPos().x : this_1.mTurnBtn.width >> 1;\r\n            var toAlpha = this_1.mExpandBoo ? 1 : 0;\r\n            var easeType = this_1.mExpandBoo ? "Sine.easeIn" : "Sine.easeOut";\r\n            this_1.scene.tweens.add({\r\n                targets: btn,\r\n                duration: 300,\r\n                ease: easeType,\r\n                props: {\r\n                    x: { value: toX },\r\n                    alpha: { value: toAlpha }\r\n                },\r\n                onComplete: function (tween, targets, ship) {\r\n                    if (i === len - 1) {\r\n                        _this.mExpandBoo = !_this.mExpandBoo;\r\n                    }\r\n                },\r\n                onCompleteParams: [this_1]\r\n            });\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < len; i++) {\r\n            _loop_1(i);\r\n        }\r\n    };\r\n    TopBtnGroup.prototype.btnRefreshPos = function () {\r\n        var _this = this;\r\n        if (this.mBtnList && this.mBtnList.length > 1) {\r\n            this.mBtnX = -this.mTurnBtn.width - this.mBtnPad;\r\n            var hei = this.mTurnBtn.height / 2 + 20;\r\n            var wid_1 = 0;\r\n            this.mBtnList.forEach(function (btn) {\r\n                if (!btn)\r\n                    return;\r\n                btn.x = _this.mBtnX;\r\n                // btn.setBtnData({});\r\n                btn.setPos(_this.mBtnX, 0);\r\n                _this.mBtnX += -btn.width - _this.mBtnPad;\r\n                wid_1 += btn.width + _this.mBtnPad;\r\n                // btn.setClick(() => {\r\n                //     // todo connect\r\n                // });\r\n                _this.add(btn);\r\n            });\r\n            this.setSize(wid_1, hei);\r\n        }\r\n        this.resize();\r\n    };\r\n    return TopBtnGroup;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/topGroup/top.btn.group.ts?')},"./src/ui/baseView/topGroup/top.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TopMediator", function() { return TopMediator; });\n/* harmony import */ var _baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../baseFace.mediator */ "./src/ui/baseView/baseFace.mediator.ts");\n/* harmony import */ var _top_btn_group__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./top.btn.group */ "./src/ui/baseView/topGroup/top.btn.group.ts");\n/* harmony import */ var _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../Rank/RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\nvar TopMediator = /** @class */ (function (_super) {\r\n    __extends(TopMediator, _super);\r\n    function TopMediator(mWorld, scene) {\r\n        return _super.call(this, mWorld, scene) || this;\r\n    }\r\n    TopMediator.prototype.preRefreshBtn = function (medName) {\r\n        if (!this.refreshMedList)\r\n            this.refreshMedList = [];\r\n        this.refreshMedList.push(medName);\r\n    };\r\n    TopMediator.prototype.refreshBtn = function (medName, addBoo) {\r\n        var _this = this;\r\n        var topBtnGroup = this.mView;\r\n        switch (medName) {\r\n            case _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_2__["RankMediator"].NAME:\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json",\r\n                        callBack: function () {\r\n                            var med = _this.world.uiManager.getMediator(medName);\r\n                            if (med) {\r\n                                // 该判断条件用于某些常驻界面ui在移动端需要手动打开，客户端将此逻辑修改为通过后端发送的showui数据将入口按钮变成是否常驻\r\n                                // 好处在于移动端客户端界面让玩家自行选择是否打开，减少ui布局混乱的情况\r\n                                var param = med.getParam();\r\n                                med.show(param);\r\n                            }\r\n                            else {\r\n                                // todo 该判断条件用于热发布活动，后端需要在pi中加一条活动按钮数据，不包含med具体代码，只有name，btnres等数据即可，等需要打开界面时在请求具体数据\r\n                                // 客户端只需要发送medname给后端，后端发送showui给客户端，好处在于每次打开都是请求后端打开界面，活动数据是实时的\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n            case "EnterDecorate":\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json",\r\n                        callBack: function () {\r\n                            _this.onEnterDecorate();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n            case "SaveDecorate":\r\n                if (addBoo) {\r\n                    topBtnGroup.addBtn({\r\n                        key: medName, bgResKey: "baseView", bgTextures: ["btnGroup_red_normal.png", "btnGroup_red_light.png", "btnGroup_red_select.png"],\r\n                        iconResKey: "baseView", iconTexture: "btnGroup_rank_icon.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json",\r\n                        callBack: function () {\r\n                            _this.onEnterDecorate();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    topBtnGroup.removeBtn(medName);\r\n                }\r\n                break;\r\n        }\r\n    };\r\n    TopMediator.prototype.tweenView = function (show) {\r\n        if (this.mView)\r\n            this.mView.tweenView(show);\r\n    };\r\n    TopMediator.prototype.show = function (param) {\r\n        var _this = this;\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _top_btn_group__WEBPACK_IMPORTED_MODULE_1__["TopBtnGroup"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n        if (this.refreshMedList) {\r\n            this.refreshMedList.forEach(function (medName) {\r\n                _this.refreshBtn(medName, true);\r\n            });\r\n        }\r\n    };\r\n    TopMediator.prototype.hide = function () {\r\n        var _this = this;\r\n        this.mShow = false;\r\n        if (this.refreshMedList) {\r\n            this.refreshMedList.forEach(function (medName) {\r\n                _this.refreshBtn(medName, false);\r\n            });\r\n        }\r\n        if (this.mView) {\r\n            this.mView.hide();\r\n            this.mView = null;\r\n        }\r\n    };\r\n    TopMediator.prototype.addBtn = function (data) {\r\n        if (this.mView)\r\n            this.mView.addBtn(data);\r\n    };\r\n    TopMediator.prototype.onEnterDecorate = function () {\r\n        if (this.world && this.world.connection) {\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ENTER);\r\n            this.world.connection.send(packet);\r\n        }\r\n    };\r\n    TopMediator.prototype.onSaveDecorate = function () {\r\n        if (this.world && this.world.connection) {\r\n            // Alert.\r\n            var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_3__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_4__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_SAVE);\r\n            this.world.connection.send(packet);\r\n        }\r\n    };\r\n    TopMediator.NAME = "TopMediator";\r\n    return TopMediator;\r\n}(_baseFace_mediator__WEBPACK_IMPORTED_MODULE_0__["BaseFaceMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/baseView/topGroup/top.mediator.ts?')},"./src/ui/chat/Chat.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Chat", function() { return Chat; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar Chat = /** @class */ (function (_super) {\r\n    __extends(Chat, _super);\r\n    function Chat(world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.world = world;\r\n        _this.mEvent = new Phaser.Events.EventEmitter();\r\n        return _this;\r\n    }\r\n    Chat.prototype.on = function (event, fn, context) {\r\n        this.mEvent.on(event, fn, context);\r\n    };\r\n    Chat.prototype.off = function (event, fn, context) {\r\n        this.mEvent.off(event, fn, context);\r\n    };\r\n    Chat.prototype.register = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.addPacketListener(this);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CHAT, this.handleCharacterChat);\r\n            this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_QCLOUD_GME_AUTHBUFFER, this.handleQCLoudGME);\r\n        }\r\n    };\r\n    Chat.prototype.unregister = function () {\r\n        var connection = this.connection;\r\n        if (connection) {\r\n            this.connection.removePacketListener(this);\r\n        }\r\n    };\r\n    Object.defineProperty(Chat.prototype, "connection", {\r\n        get: function () {\r\n            if (this.world) {\r\n                return this.world.connection;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Chat.prototype.handleCharacterChat = function (packet) {\r\n        var content = packet.content;\r\n        this.mEvent.emit("characterChat", packet);\r\n    };\r\n    Chat.prototype.handleQCLoudGME = function (packet) {\r\n        var authBuffer = packet.content;\r\n        this.mEvent.emit("QCLoundGME", packet);\r\n    };\r\n    return Chat;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/Chat.ts?')},"./src/ui/chat/base.chat.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseChatPanel", function() { return BaseChatPanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar BaseChatPanel = /** @class */ (function (_super) {\r\n    __extends(BaseChatPanel, _super);\r\n    function BaseChatPanel(scene, world) {\r\n        return _super.call(this, scene, world) || this;\r\n    }\r\n    BaseChatPanel.prototype.appendChat = function (val) {\r\n    };\r\n    Object.defineProperty(BaseChatPanel.prototype, "outChannel", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return BaseChatPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/base.chat.panel.ts?')},"./src/ui/chat/chat.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatMediator", function() { return ChatMediator; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\n/* harmony import */ var _chatPanel_pc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chatPanel.pc */ "./src/ui/chat/chatPanel.pc.ts");\n/* harmony import */ var _mobile_chatPanel_mobile__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mobile/chatPanel.mobile */ "./src/ui/chat/mobile/chatPanel.mobile.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _Chat__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Chat */ "./src/ui/chat/Chat.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatMediator = /** @class */ (function (_super) {\r\n    __extends(ChatMediator, _super);\r\n    function ChatMediator(world, scene) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mInRoom = false;\r\n        _this.mAllMessage = [];\r\n        _this.mMaxMessageNum = 50;\r\n        _this.world = world;\r\n        _this.mScene = scene;\r\n        _this.chat = new _Chat__WEBPACK_IMPORTED_MODULE_6__["Chat"](world);\r\n        _this.mUIType = _this.world.game.device.os.desktop ? _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_7__["UIType"].Scene : _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_7__["UIType"].Normal;\r\n        return _this;\r\n    }\r\n    ChatMediator.prototype.getUIType = function () {\r\n        return this.mUIType;\r\n    };\r\n    ChatMediator.prototype.enterRoom = function () {\r\n        if (!this.room)\r\n            return;\r\n        if (!this.room.playerManager.actor)\r\n            return;\r\n        if (!this.mGMEApi)\r\n            return;\r\n        var playerID = this.room.playerManager.actor.id;\r\n        var roomID = this.room.id;\r\n        this.mGMEApi.EnterRoom(roomID.toString(), 1, this.mQCLoudAuth);\r\n        this.mInRoom = true;\r\n        this.sendVoiceRoomStatus(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.CurrentScene, roomID, pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].VoiceRoomStatus.InVoiceRoom);\r\n    };\r\n    ChatMediator.prototype.exitRoom = function () {\r\n        if (!this.mGMEApi)\r\n            return;\r\n        this.mGMEApi.EnableMic(false);\r\n        this.mGMEApi.ExitRoom();\r\n        this.mInRoom = false;\r\n        if (!this.room) {\r\n            return;\r\n        }\r\n        this.sendVoiceRoomStatus(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.CurrentScene, this.room.id, pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].VoiceRoomStatus.OutsideVoiceRoom);\r\n    };\r\n    ChatMediator.prototype.isSceneUI = function () {\r\n        return true;\r\n    };\r\n    ChatMediator.prototype.tweenView = function (show) {\r\n        if (!this.mView)\r\n            return;\r\n        this.mView.tweenExpand(show);\r\n    };\r\n    ChatMediator.prototype.isShow = function () {\r\n        if (!this.mView) {\r\n            return false;\r\n        }\r\n        return this.mView.isShow();\r\n    };\r\n    ChatMediator.prototype.showing = function () {\r\n        return true;\r\n    };\r\n    ChatMediator.prototype.resize = function () {\r\n        var size = this.world.getSize();\r\n        if (this.mView) {\r\n            this.mView.resize(size.width, size.height);\r\n        }\r\n    };\r\n    ChatMediator.prototype.show = function (param) {\r\n        if (this.mView && this.mView.isShow()) {\r\n            return;\r\n        }\r\n        if (this.world.game.device.os.desktop) {\r\n            this.mView = new _chatPanel_pc__WEBPACK_IMPORTED_MODULE_3__["ChatPanelPC"](this.mScene, this.world);\r\n        }\r\n        else {\r\n            this.mView = new _mobile_chatPanel_mobile__WEBPACK_IMPORTED_MODULE_4__["ChatPanelMobile"](this.mScene, this.world);\r\n            this.world.uiManager.checkUIState(ChatMediator.NAME, false);\r\n        }\r\n        this.world.uiManager.getUILayerManager().addToUILayer(this.mView);\r\n        this.addListen();\r\n        this.mView.show();\r\n        this.mView.scale = this.world.uiScale;\r\n    };\r\n    ChatMediator.prototype.update = function (param) {\r\n        this.mView.update(param);\r\n        this.mParam = param;\r\n    };\r\n    ChatMediator.prototype.hide = function () {\r\n        this.removeListen();\r\n        this.mView.hide();\r\n        if (!this.world.game.device.os.desktop)\r\n            this.world.uiManager.checkUIState(ChatMediator.NAME, true);\r\n    };\r\n    ChatMediator.prototype.setParam = function (param) {\r\n        this.mParam = param;\r\n    };\r\n    ChatMediator.prototype.getParam = function () {\r\n        return this.mParam;\r\n    };\r\n    ChatMediator.prototype.destroy = function () {\r\n        this.removeListen();\r\n        if (this.chat) {\r\n            this.chat.unregister();\r\n            this.chat = null;\r\n        }\r\n        if (this.mGMEApi) {\r\n            this.mGMEApi = null;\r\n        }\r\n        this.mScene = null;\r\n        this.world = null;\r\n        this.mInRoom = false;\r\n        this.mQCLoudAuth = null;\r\n        this.mAllMessage.forEach(function (message) {\r\n            if (message)\r\n                message = null;\r\n        });\r\n        this.mAllMessage = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ChatMediator.prototype.addListen = function () {\r\n        this.chat.on("characterChat", this.handleCharacterChat, this);\r\n        this.chat.on("QCLoundGME", this.handleQCLoudGME, this);\r\n        this.mView.on("sendChat", this.onSendChatHandler, this);\r\n        this.mView.on("selectedVoice", this.onSelectedVoiceHandler, this);\r\n        this.mView.on("selectedMic", this.onSelectedMicHandler, this);\r\n        this.chat.register();\r\n    };\r\n    ChatMediator.prototype.removeListen = function () {\r\n        this.chat.off("characterChat", this.handleCharacterChat, this);\r\n        this.chat.off("QCLoundGME", this.handleQCLoudGME, this);\r\n        this.mView.off("sendChat", this.onSendChatHandler, this);\r\n        this.mView.off("selectedVoice", this.onSelectedVoiceHandler, this);\r\n        this.mView.off("selectedMic", this.onSelectedMicHandler, this);\r\n        this.chat.unregister();\r\n    };\r\n    ChatMediator.prototype.initGME = function () {\r\n        var _this = this;\r\n        // TODO just for test, need get sdkAppId from settings\r\n        var sdkAppId = "1400209172";\r\n        if (!this.room.playerManager.actor)\r\n            return;\r\n        var playerID = this.room.playerManager.actor.id;\r\n        this.mGMEApi = new WebGMEAPI();\r\n        this.mGMEApi.Init(document, sdkAppId, playerID.toString());\r\n        this.mGMEApi.SetTMGDelegate(function (event, result) {\r\n            switch (event) {\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ENTER_ROOM:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: EnterRoom: " + result);\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVNET_TYPE_USER_UPDATE:\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_EXIT_ROOM:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: ExitRoom");\r\n                    break;\r\n                case _this.mGMEApi.event.ITMG_MAIN_EVENT_TYPE_ROOM_DISCONNECT:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: Room Disconnect!!!");\r\n                    break;\r\n                default:\r\n                    _utils_log__WEBPACK_IMPORTED_MODULE_2__["Logger"].getInstance().log("[GME]: Sth wrong...");\r\n                    break;\r\n            }\r\n        });\r\n    };\r\n    ChatMediator.prototype.appendMessage = function (messages, message) {\r\n        messages.push(message);\r\n        if (messages.length > this.mMaxMessageNum) {\r\n            messages.shift();\r\n        }\r\n    };\r\n    ChatMediator.prototype.changeMessageChannel = function () {\r\n        var _this = this;\r\n        if (!this.mView)\r\n            return;\r\n        var showMessages = this.mAllMessage.filter(function (msg) { return msg.channel === _this.mView.outChannel || msg.channel === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].ChatChannel.System || _this.mView.outChannel === null; });\r\n        var len = showMessages.length;\r\n        var message = null;\r\n        var wrapStr = "\\n";\r\n        for (var i = 0; i < len; i++) {\r\n            message = showMessages[i];\r\n            if (i === len - 1)\r\n                wrapStr = "";\r\n            this.mView.appendChat(message.chat + wrapStr);\r\n        }\r\n    };\r\n    ChatMediator.prototype.handleCharacterChat = function (packet) {\r\n        var content = packet.content;\r\n        if (!this.world || !this.world.emitter || !this.room || !this.mView) {\r\n            return;\r\n        }\r\n        var playerManager = this.world.roomManager.currentRoom.playerManager;\r\n        if (!playerManager) {\r\n            return;\r\n        }\r\n        var player = playerManager.get(content.chatSenderid);\r\n        // const chatSendName = player ? player.name : "";\r\n        // this.mChatPanel.appendChat(content.chatContext);\r\n        var nickname = player ? player.model.nickname + ":" : "";\r\n        var color = content.chatSetting && content.chatSetting.textColor ? content.chatSetting.textColor : "#FFFFFF";\r\n        this.appendMessage(this.mAllMessage, { chat: "[color=" + color + "]" + nickname + ":" + content.chatContext + "[/color]", channel: content.chatChannel });\r\n        this.mView.appendChat("[b][color=" + color + "]" + nickname + content.chatContext + "[/color][/b]\\n");\r\n    };\r\n    ChatMediator.prototype.onSendChatHandler = function (text) {\r\n        if (this.world.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_GATEWAY_REQ_VIRTUAL_WORLD_CHAT);\r\n            var content = pkt.content;\r\n            content.chatChannel = 0;\r\n            content.chatContext = text;\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    ChatMediator.prototype.sendVoiceRoomStatus = function (voiceChannel, voiceRoomId, voiceRoomStatus) {\r\n        if (!this.room.connection) {\r\n            return;\r\n        }\r\n        var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS);\r\n        var context = pkt.content;\r\n        context.voiceChannel = voiceChannel;\r\n        context.voiceRoomId = voiceRoomId;\r\n        context.voiceRoomStatus = voiceRoomStatus;\r\n        this.room.connection.send(pkt);\r\n    };\r\n    ChatMediator.prototype.handleQCLoudGME = function (packet) {\r\n        var authBuffer = packet.content;\r\n        this.mQCLoudAuth = authBuffer.signature;\r\n        this.initGME();\r\n    };\r\n    ChatMediator.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val) {\r\n            this.enterRoom();\r\n        }\r\n        else {\r\n            this.exitRoom();\r\n        }\r\n    };\r\n    ChatMediator.prototype.onSelectedMicHandler = function (val) {\r\n        if (!this.mGMEApi) {\r\n            return;\r\n        }\r\n        if (this.mInRoom) {\r\n            this.mGMEApi.EnableMic(val);\r\n        }\r\n        if (this.world.connection) {\r\n            var pkt = new net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PBpacket"]((pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_VOICE_ROOM_STATUS));\r\n            this.world.connection.send(pkt);\r\n        }\r\n    };\r\n    Object.defineProperty(ChatMediator.prototype, "room", {\r\n        get: function () {\r\n            if (!this.world) {\r\n                return;\r\n            }\r\n            if (!this.world.roomManager) {\r\n                return;\r\n            }\r\n            return this.world.roomManager.currentRoom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ChatMediator.NAME = "ChatMediator";\r\n    return ChatMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_5__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/chat.mediator.ts?')},"./src/ui/chat/chatPanel.pc.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPanelPC", function() { return ChatPanelPC; });\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_shape_roundrectangle_RoundRectangle__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle */ "./lib/rexui/lib/plugins/gameobjects/shape/roundrectangle/RoundRectangle.js");\n/* harmony import */ var _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/textarea/TextArea */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_check_button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/check.button */ "./src/ui/components/check.button.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _base_chat_panel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./base.chat.panel */ "./src/ui/chat/base.chat.panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatPanelPC = /** @class */ (function (_super) {\r\n    __extends(ChatPanelPC, _super);\r\n    function ChatPanelPC(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mPreHei = 0;\r\n        _this.mPreWid = 0;\r\n        return _this;\r\n    }\r\n    ChatPanelPC.prototype.appendChat = function (val) {\r\n        if (this.mTextArea) {\r\n            this.mTextArea.appendText(val);\r\n            this.mTextArea.scrollToBottom();\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.tweenExpand = function (show) {\r\n        if (!this.scene)\r\n            return;\r\n        var baseX = 0;\r\n        var toX = show === true ? baseX : baseX - 200;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Cubic.Out",\r\n            props: {\r\n                x: { value: toX },\r\n                alpha: { value: toAlpha },\r\n            },\r\n        });\r\n    };\r\n    ChatPanelPC.prototype.setPosition = function (x, y) {\r\n        if (!this.mInitialized)\r\n            return;\r\n        // DefaultMask在TextBlock中，TextBlock是一个非渲染矩形游戏对象\r\n        var size = this.mWorld.getSize();\r\n        _super.prototype.setPosition.call(this, 0, size.height - this.mPreHei);\r\n        if (this.mTextArea) {\r\n            // this.mTextArea.childrenMap.child.setMinSize(width, (h - 16 * this.dpr) * zoom);\r\n            // this.mTextArea.layout();\r\n            // this.mTextArea.setPosition(this.width / 2 + 4 * this.dpr, this.y + this.mTextArea.height / 2 + 10 * this.dpr * zoom);\r\n            var textMask = this.mTextArea.childrenMap.text;\r\n            textMask.y = size.height - this.height + 25 * this.dpr;\r\n            this.mTextArea.scrollToBottom();\r\n            // 每次resize更新textBlock中的textMask的位置\r\n            // this.mTextArea.childrenMap.child.textMask.setPosition(undefined, size.height - this.height + 30).resize();\r\n        }\r\n        return this;\r\n    };\r\n    ChatPanelPC.prototype.addListen = function () {\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (this.sendMsgBtn)\r\n            this.sendMsgBtn.on("pointerdown", this.onSendMsgHandler, this);\r\n        if (this.mVoiceBtn)\r\n            this.mVoiceBtn.on("selected", this.onSelectedVoiceHandler, this);\r\n        if (this.mMicBtn)\r\n            this.mMicBtn.on("selected", this.onSelectedMicHandler, this);\r\n        if (this.mInputText) {\r\n            this.mInputText.on("focus", this.onFocusHandler, this);\r\n            this.mInputText.on("blur", this.onBlurHandler, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.removeListen = function () {\r\n        _super.prototype.removeListen.call(this);\r\n        if (!this.mInitialized)\r\n            return;\r\n        if (this.sendMsgBtn)\r\n            this.sendMsgBtn.off("pointerdown", this.onSendMsgHandler, this);\r\n        if (this.mVoiceBtn)\r\n            this.mVoiceBtn.off("selected", this.onSelectedVoiceHandler, this);\r\n        if (this.mMicBtn)\r\n            this.mMicBtn.off("selected", this.onSelectedMicHandler, this);\r\n        if (this.mInputText) {\r\n            this.mInputText.off("focus", this.onFocusHandler, this);\r\n            this.mInputText.off("blur", this.onBlurHandler, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ChatPanelPC.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.scene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/button.png"));\r\n        this.scene.load.image("thumbTexture", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/common_thumb_texture.png"));\r\n        this.scene.load.image("track", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/common/common_track.png"));\r\n        this.scene.load.image("chat_input_bg", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/input_bg.png"));\r\n        // this.scene.load.image("chat_border_bg", Url.getRes("ui/chat/bg.png"));\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getPNG());\r\n        this.scene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ChatPanelPC.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        this.mPreHei = size.height;\r\n        this.mPreWid = size.width;\r\n        this.setSize(464, 281);\r\n        var border = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__["NinePatch"](this.scene, 0, 0, this.width, this.height, _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_4__["Border"].getConfig());\r\n        border.x = 4 * this.mWorld.uiScale + border.width * border.originX;\r\n        border.y = size.height - 260 * this.mWorld.uiScale + border.height * border.originY;\r\n        this.add(border);\r\n        this.outPut = this.scene.make.container(undefined, false);\r\n        this.add(this.outPut);\r\n        var background = new _lib_rexui_lib_plugins_gameobjects_shape_roundrectangle_RoundRectangle__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, 0, 0, 2, 2, 3, 0x808080, 0.5);\r\n        this.outPut.add(background);\r\n        var track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.scene, 0, 0, 4, 7, "track", "", "", {\r\n            left: 0,\r\n            top: 2,\r\n            right: 0,\r\n            bottom: 2\r\n        });\r\n        track.x = 100 * this.mWorld.uiScale;\r\n        track.y = 10 * this.mWorld.uiScale;\r\n        this.outPut.add(track);\r\n        var text = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_6__["default"](this.scene, 0, 0, "", {\r\n            fontSize: "14px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: 400 * this.mWorld.uiScale\r\n            },\r\n        });\r\n        this.outPut.add(text);\r\n        var thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.scene, 0, 0, 20, 35, "button", "", "", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        // const indicator = new NinePatchButton(this.scene, 0, 0, 8, 10, "thumbTexture", "", {\r\n        //     left: 0,\r\n        //     top: 0,\r\n        //     right: 0,\r\n        //     bottom: 0\r\n        // });\r\n        this.outPut.add(thumb);\r\n        // this.outPut.add(indicator);\r\n        this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea__WEBPACK_IMPORTED_MODULE_1__["default"](this.scene, {\r\n            x: 230 * this.mWorld.uiScale,\r\n            y: size.height - 155 * this.mWorld.uiScale,\r\n            textWidth: 430,\r\n            textHeight: 200,\r\n            text: text,\r\n            slider: {\r\n                track: track,\r\n                // indicator,\r\n                thumb: thumb,\r\n            },\r\n        })\r\n            .layout();\r\n        this.outPut.add(this.mTextArea);\r\n        var tracks = this.mTextArea.getElement("child");\r\n        if (tracks) {\r\n            // tracks.x += 150;\r\n        }\r\n        var inputContainer = this.scene.make.container(undefined, false);\r\n        this.add(inputContainer);\r\n        var inputBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_7__["NinePatch"](this.scene, 0, 0, 370, 32, "chat_input_bg", null, { left: 4, top: 4, right: 4, bottom: 4 });\r\n        inputBg.x = 8 * this.mWorld.uiScale + inputBg.width * inputBg.originX;\r\n        inputBg.y = size.height - 46 * this.mWorld.uiScale + inputBg.height * inputBg.originY;\r\n        inputContainer.add(inputBg);\r\n        this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "14px",\r\n            color: "#808080"\r\n        })\r\n            .resize(360, 20)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 16px YaHei" });\r\n        this.mInputText.x = 12 * this.mWorld.uiScale;\r\n        this.mInputText.y = size.height - 40 * this.mWorld.uiScale;\r\n        inputContainer.add(this.mInputText);\r\n        this.sendMsgBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_3__["NinePatchButton"](this.scene, 0, 0, 60, 30, "button", "", "发送", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        this.sendMsgBtn.x = this.width - this.sendMsgBtn.width + 10 * this.mWorld.uiScale;\r\n        this.sendMsgBtn.y = size.height - this.sendMsgBtn.height;\r\n        this.add(this.sendMsgBtn);\r\n        this.mSendKey = this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER);\r\n        this.mVoiceBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.scene, 0, 0, "chat_atlas", "voice_normal.png", "voice_selected.png");\r\n        this.mVoiceBtn.x = this.width - 60 * this.mWorld.uiScale;\r\n        this.mVoiceBtn.y = size.height - this.height;\r\n        this.add(this.mVoiceBtn);\r\n        this.mMicBtn = new _components_check_button__WEBPACK_IMPORTED_MODULE_5__["CheckButton"](this.scene, 0, 0, "chat_atlas", "mic_normal.png", "mic_selected.png");\r\n        this.mMicBtn.x = this.width - 20 * this.mWorld.uiScale;\r\n        this.mMicBtn.y = size.height - this.height;\r\n        this.add(this.mMicBtn);\r\n        this.setPosition();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ChatPanelPC.prototype.onSelectedVoiceHandler = function (val) {\r\n        if (val === false) {\r\n            this.mMicBtn.selected = false;\r\n        }\r\n        this.emit("selectedVoice", val);\r\n    };\r\n    ChatPanelPC.prototype.onSelectedMicHandler = function (val) {\r\n        if (this.mVoiceBtn.selected === false) {\r\n            this.mMicBtn.selected = false;\r\n            return;\r\n        }\r\n        this.mMicBtn.selected = val;\r\n        this.emit("selectedMic", val);\r\n    };\r\n    ChatPanelPC.prototype.onSendMsgHandler = function () {\r\n        var text = this.mInputText.text;\r\n        if (text.length > 0) {\r\n            this.emit("sendChat", text);\r\n            this.mInputText.setText("");\r\n            this.mInputText.setBlur();\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        if (this.mSendKey) {\r\n            this.mSendKey.on("down", this.onDownEnter, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        if (this.mSendKey) {\r\n            this.mSendKey.off("down", this.onDownEnter, this);\r\n        }\r\n    };\r\n    ChatPanelPC.prototype.onDownEnter = function () {\r\n        this.onSendMsgHandler();\r\n    };\r\n    Object.defineProperty(ChatPanelPC.prototype, "outChannel", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return ChatPanelPC;\r\n}(_base_chat_panel__WEBPACK_IMPORTED_MODULE_8__["BaseChatPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/chatPanel.pc.ts?')},"./src/ui/chat/message.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/message.ts?")},"./src/ui/chat/mobile/chatPanel.mobile.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChatPanelMobile", function() { return ChatPanelMobile; });\n/* harmony import */ var _base_chat_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base.chat.panel */ "./src/ui/chat/base.chat.panel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/rexui/lib/ui/textarea/TextArea.js */ "./lib/rexui/lib/ui/textarea/TextArea.js");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ChatPanelMobile = /** @class */ (function (_super) {\r\n    __extends(ChatPanelMobile, _super);\r\n    function ChatPanelMobile(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.setTween(false);\r\n        return _this;\r\n    }\r\n    ChatPanelMobile.prototype.addListen = function () {\r\n        this.mSendBtn.on("pointerdown", this.onSendMsgHandler, this);\r\n        this.clickContainer.on("pointerdown", this.clickHandler, this);\r\n        this.mInputText.on("focus", this.onFocusHandler, this);\r\n        this.mInputText.on("blur", this.onBlurHandler, this);\r\n    };\r\n    ChatPanelMobile.prototype.removeListen = function () {\r\n        this.mSendBtn.off("pointerdown", this.onSendMsgHandler, this);\r\n        this.clickContainer.off("pointerdown", this.clickHandler, this);\r\n        this.mInputText.off("focus", this.onFocusHandler, this);\r\n        this.mInputText.off("blur", this.onBlurHandler, this);\r\n    };\r\n    ChatPanelMobile.prototype.appendChat = function (val) {\r\n        if (this.mTextArea) {\r\n            this.mTextArea.appendText(val);\r\n            this.mTextArea.scrollToBottom();\r\n        }\r\n    };\r\n    ChatPanelMobile.prototype.show = function (param) {\r\n        _super.prototype.show.call(this, param);\r\n        this.tweenExpand(true);\r\n    };\r\n    ChatPanelMobile.prototype.setPosition = function (x, y) {\r\n        if (!this.mShow)\r\n            return;\r\n        // DefaultMask在TextBlock中，TextBlock是一个非渲染矩形游戏对象\r\n        var size = this.mWorld.getSize();\r\n        var track;\r\n        var thumb;\r\n        var text;\r\n        if (this.mTextArea) {\r\n            this.mTextArea.destroy();\r\n            this.mTextArea = null;\r\n            text = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__["default"](this.scene, 0, 0, "", {\r\n                fontSize: "20px",\r\n                wrap: {\r\n                    mode: "char",\r\n                    width: this.width >> 1\r\n                },\r\n            });\r\n            track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.scene, 0, 0, 4, 7, "track", "", "", {\r\n                left: 0,\r\n                top: 2,\r\n                right: 0,\r\n                bottom: 2\r\n            });\r\n            // track.x = this.width / 2;\r\n            // track.y = 8 * this.mWorld.uiScale;\r\n            thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.scene, 0, 0, 20, 35, "button", "", "", {\r\n                left: 4,\r\n                top: 4,\r\n                right: 4,\r\n                bottom: 4\r\n            });\r\n            this.add(text);\r\n            this.add(track);\r\n            this.add(thumb);\r\n        }\r\n        if (this.mInputText) {\r\n            this.mInputText.destroy();\r\n            this.mInputText = null;\r\n            this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, 0, 0, 10, 10, {\r\n                type: "input",\r\n                fontSize: "20px",\r\n                color: "#808080"\r\n            })\r\n                .resize(328, 26)\r\n                .setOrigin(0, 0)\r\n                .setStyle({ font: "bold 20px YaHei" });\r\n            // .on("focus", this.onFocusHandler, this)\r\n            // .on("blur", this.onBlurHandler, this);\r\n        }\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.width = size.width >> 1;\r\n            this.height = size.height;\r\n            this.mBorder.resize(this.width / this.mWorld.uiScale, this.height / this.mWorld.uiScale);\r\n            this.x = 0;\r\n            this.y = 0;\r\n            this.clickContainer.x = this.width / this.mWorld.uiScale + this.clickContainer.width / 2;\r\n            this.clickContainer.y = this.height / (this.mWorld.uiScale * 2);\r\n            this.clickContainer.rotation = Math.PI * .5;\r\n            this.arrow.rotation = Math.PI * .5;\r\n            this.mInputBg.y = this.mBorder.height - this.mInputBg.height / 2;\r\n            this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_1__["default"](this.scene, {\r\n                x: this.width * .5 / this.mWorld.uiScale,\r\n                y: this.height / 2,\r\n                textWidth: this.mBorder.width - 20 * this.mWorld.uiScale,\r\n                textHeight: this.height,\r\n                text: text,\r\n                slider: {\r\n                    track: track,\r\n                    thumb: thumb,\r\n                },\r\n                clamplChildOY: true,\r\n            });\r\n            this.mInputText.setPosition(2, this.mInputBg.y - 12 * this.mWorld.uiScale);\r\n        }\r\n        else {\r\n            this.width = size.width;\r\n            this.height = size.height / 2;\r\n            this.mBorder.resize(this.width / this.mWorld.uiScale, this.height / this.mWorld.uiScale);\r\n            this.x = 0;\r\n            this.y = this.height + 20 * this.mWorld.uiScale;\r\n            this.mInputBg.y = this.mBorder.height - this.mInputBg.height;\r\n            this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_1__["default"](this.scene, {\r\n                x: (this.width - 15) / this.mWorld.uiScale >> 1,\r\n                y: (size.height / 2 - this.mSendBtn.height - 20) / this.mWorld.uiScale >> 1,\r\n                textWidth: this.mBorder.width - 20 * this.mWorld.uiScale,\r\n                textHeight: (size.height / 2 - this.mSendBtn.height - 20) / this.mWorld.uiScale,\r\n                text: text,\r\n                slider: {\r\n                    track: track,\r\n                    thumb: thumb,\r\n                },\r\n                scroller: {\r\n                    bounds: [0, this.height >> 1],\r\n                },\r\n                clamplChildOY: true,\r\n                backDeceleration: true,\r\n            });\r\n            // this.mTextArea.x = this.mTextArea.childrenMap.child.minWidth >> 1;\r\n            // this.mTextArea.y = this.mTextArea.childrenMap.child.minHeight >> 1;\r\n            this.clickContainer.x = size.width / (this.mWorld.uiScale * 2);\r\n            this.clickContainer.y = -this.clickContainer.height >> 1;\r\n            var silder = this.mTextArea.getElement("slider");\r\n            silder.y = this.height >> 1;\r\n            this.clickContainer.rotation = Math.PI;\r\n            this.arrow.rotation = Math.PI * 1.5;\r\n            this.mInputText.setPosition(2, this.mInputBg.y - 6 * this.mWorld.uiScale);\r\n        }\r\n        this.mTextArea.layout();\r\n        this.add(this.mTextArea);\r\n        this.mTextArea.childrenMap.child.textMask.setPosition(-5, size.height - this.height).resize(this.width + 18, this.height - this.mSendBtn.height);\r\n        // this.mBorder = new NinePatch(this.scene, 0, 0, this.width / this.mWorld.uiScale, this.height / this.mWorld.uiScale, Border.getName(), null, Border.getConfig());\r\n        this.mBorder.x = this.mBorder.width / 2;\r\n        this.mBorder.y = this.mBorder.height / 2;\r\n        this.setSize(this.width, this.height);\r\n        // this.mTextArea.x = this.mBorder.width + 100 * this.mWorld.uiScale >> 1;\r\n        this.mInputBg.x = this.mInputBg.width >> 1;\r\n        this.mSendBtn.x = this.mBorder.width - this.mSendBtn.width;\r\n        this.mSendBtn.y = this.mInputBg.y;\r\n        this.scale = this.mWorld.uiScale;\r\n        this.add(this.mInputText);\r\n        return this;\r\n    };\r\n    ChatPanelMobile.prototype.destroy = function () {\r\n        // if (this.mSendBtn) this.mSendBtn.destroy(true);\r\n        // if (this.mInputBg) this.mInputBg.destroy(true);\r\n        // if (this.clickContainer) this.clickContainer.destroy(true);\r\n        // if (this.arrow) this.arrow.destroy(true);\r\n        // if (this.mBorder) this.mBorder.destroy(true);\r\n        // if (this.mTextArea) this.mTextArea.destroy();\r\n        // if (this.mInputText) this.mInputText.destroy();\r\n        // this.mTextArea = null;\r\n        // this.mInputText = null;\r\n        // this.mSendBtn = null;\r\n        // this.clickContainer = null;\r\n        // this.arrow = null;\r\n        // this.mBorder = null;\r\n        // this.mInputBg = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.tweenExpand = function (show) {\r\n        var _this = this;\r\n        var toAlpha = show === true ? 1 : 0;\r\n        this.scene.tweens.add({\r\n            targets: this,\r\n            duration: 200,\r\n            ease: "Linear",\r\n            props: {\r\n                alpha: { value: toAlpha },\r\n            },\r\n            onComplete: function (tween, targets, ship) {\r\n                if (!show)\r\n                    _this.hide();\r\n                _this.addListen();\r\n            },\r\n        });\r\n        if (show)\r\n            this.setPosition();\r\n    };\r\n    ChatPanelMobile.prototype.hide = function () {\r\n        this.removeListen();\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.preload = function () {\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n        this.scene.load.image("button", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/button.png"));\r\n        this.scene.load.image("thumbTexture", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_thumb_texture.png"));\r\n        this.scene.load.image("track", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_track.png"));\r\n        this.scene.load.image("channelSelect", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_channelSelect.png"));\r\n        this.scene.load.image("channelUnSelect", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_channelUnSelect.png"));\r\n        this.scene.load.image("arrow", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/common/common_arrow.png"));\r\n        this.scene.load.image("chat_input_bg", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/input_bg.png"));\r\n        this.scene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getPNG());\r\n        this.scene.load.atlas(_utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getPNG(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getJSON());\r\n        this.scene.load.atlas("chat_atlas", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/chat_atlas.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Url"].getRes("ui/chat/chat_atlas.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.init = function () {\r\n        if (this.mInitialized)\r\n            return;\r\n        var size = this.mWorld.getSize();\r\n        if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n            this.width = size.width >> 1;\r\n            this.height = size.height;\r\n        }\r\n        else {\r\n            this.width = size.width;\r\n            this.height = size.height >> 1;\r\n        }\r\n        this.setSize(this.width, this.height);\r\n        this.mBorder = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, this.width / this.mWorld.uiScale, this.height / this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.mBorder.x = this.mBorder.width / 2;\r\n        this.mBorder.y = this.mBorder.height / 2;\r\n        this.addAt(this.mBorder, 0);\r\n        var text = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_5__["default"](this.scene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: this.width >> 1\r\n            },\r\n        });\r\n        var track = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.scene, 0, 0, 4, 7, "track", "", "", {\r\n            left: 0,\r\n            top: 2,\r\n            right: 0,\r\n            bottom: 2\r\n        });\r\n        track.x = this.width / 2;\r\n        track.y = 8 * this.mWorld.uiScale;\r\n        var thumb = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.scene, 0, 0, 20, 35, "button", "", "", {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        });\r\n        this.add(text);\r\n        this.add(track);\r\n        this.add(thumb);\r\n        this.mTextArea = new _lib_rexui_lib_ui_textarea_TextArea_js__WEBPACK_IMPORTED_MODULE_1__["default"](this.scene, {\r\n            x: this.width >> 1,\r\n            y: this.height + 178 * this.mWorld.uiScale >> 1,\r\n            textWidth: this.width,\r\n            textHeight: this.height + 150 * this.mWorld.uiScale,\r\n            text: text,\r\n            slider: {\r\n                track: track,\r\n                thumb: thumb,\r\n            },\r\n        })\r\n            .layout();\r\n        this.add(this.mTextArea);\r\n        this.mInputBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 340, 30, "chat_input_bg", null, { left: 4, top: 4, right: 4, bottom: 4 });\r\n        this.add(this.mInputBg);\r\n        this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText_js__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, 0, 0, 10, 10, {\r\n            type: "input",\r\n            fontSize: "20px",\r\n            color: "#808080"\r\n        })\r\n            .resize(328, 26)\r\n            .setOrigin(0, 0)\r\n            .setStyle({ font: "bold 20px YaHei" })\r\n            .on("focus", this.onFocusHandler, this)\r\n            .on("blur", this.onBlurHandler, this);\r\n        this.mSendBtn = new _components_ninepatch_button__WEBPACK_IMPORTED_MODULE_6__["NinePatchButton"](this.scene, 0, 0, 60, 30, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getName(), "", "发送", _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["WhiteButton"].getConfig());\r\n        this.add(this.mSendBtn);\r\n        this.clickContainer = this.scene.make.container(undefined, false);\r\n        var btnBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_4__["NinePatch"](this.scene, 0, 0, 53 / this.mWorld.uiScale, 30 / this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_3__["Border"].getConfig());\r\n        this.arrow = this.scene.make.image(undefined, false);\r\n        this.arrow.setTexture("arrow");\r\n        this.clickContainer.setSize(btnBg.width + 4, btnBg.height + 10);\r\n        this.clickContainer.add(btnBg);\r\n        this.clickContainer.add(this.arrow);\r\n        this.clickContainer.setInteractive();\r\n        this.add(this.clickContainer);\r\n        this.add(this.mInputText);\r\n        this.setPosition();\r\n        _super.prototype.init.call(this);\r\n    };\r\n    ChatPanelMobile.prototype.clickHandler = function () {\r\n        this.scene.tweens.add({\r\n            targets: this.clickContainer,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.clickContainer.scaleX = this.clickContainer.scaleY = 1;\r\n        this.tweenExpand(false);\r\n        this.mWorld.uiManager.baseFaceTween(true);\r\n    };\r\n    ChatPanelMobile.prototype.onSendMsgHandler = function () {\r\n        var text = this.mInputText.text;\r\n        if (text.length > 0) {\r\n            this.emit("sendChat", text);\r\n            this.mInputText.setText("");\r\n            this.mInputText.setBlur();\r\n        }\r\n        // // =====================tween out/in baseView\r\n        // const baseViewMed: MainUIMediator = this.mWorld.uiManager.getMediator(MainUIMediator.NAME) as MainUIMediator;\r\n        // if (baseViewMed) {\r\n        //     baseViewMed.tweenView(true);\r\n        // }\r\n    };\r\n    ChatPanelMobile.prototype.onFocusHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = false;\r\n    };\r\n    ChatPanelMobile.prototype.onBlurHandler = function () {\r\n        if (!this.mWorld || !this.mWorld.inputManager) {\r\n            return;\r\n        }\r\n        // this.mWorld.inputManager.enable = true;\r\n    };\r\n    return ChatPanelMobile;\r\n}(_base_chat_panel__WEBPACK_IMPORTED_MODULE_0__["BaseChatPanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/chat/mobile/chatPanel.mobile.ts?')},"./src/ui/components/BasePanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasePanel", function() { return BasePanel; });\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_ui_panel_Panel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/panel/Panel */ "./lib/rexui/lib/ui/panel/Panel.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar BasePanel = /** @class */ (function (_super) {\r\n    __extends(BasePanel, _super);\r\n    function BasePanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mTweening = false;\r\n        _this.mWidth = 0;\r\n        _this.mHeight = 0;\r\n        _this.mReloadTimes = 0;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.mInitialized = false;\r\n        if (world) {\r\n            _this.dpr = Math.round(world.uiRatio || 1);\r\n            _this.scale = _this.mWorld.uiScale;\r\n        }\r\n        return _this;\r\n    }\r\n    BasePanel.prototype.addResources = function (key, resource) {\r\n        _super.prototype.addResources.call(this, key, resource);\r\n        if (resource.type) {\r\n            if (this.scene.load[resource.type]) {\r\n                this.scene.load[resource.type](key, _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getUIRes(resource.dpr, resource.texture), _utils_resUtil__WEBPACK_IMPORTED_MODULE_0__["Url"].getUIRes(resource.dpr, resource.data));\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(BasePanel.prototype, "scaleWidth", {\r\n        get: function () {\r\n            var width = this.scene.cameras.main.width / this.scale;\r\n            return width;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BasePanel.prototype, "scaleHeight", {\r\n        get: function () {\r\n            var height = this.scene.cameras.main.height / this.scale;\r\n            return height;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BasePanel.prototype, "cameraWidth", {\r\n        get: function () {\r\n            var width = this.scene.cameras.main.width;\r\n            return width;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BasePanel.prototype, "cameraHeight", {\r\n        get: function () {\r\n            var height = this.scene.cameras.main.height;\r\n            return height;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return BasePanel;\r\n}(_lib_rexui_lib_ui_panel_Panel__WEBPACK_IMPORTED_MODULE_1__["Panel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/BasePanel.ts?')},"./src/ui/components/alert.view.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlertView", function() { return AlertView; });\n/* harmony import */ var _BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\nvar AlertView = /** @class */ (function (_super) {\r\n    __extends(AlertView, _super);\r\n    function AlertView(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.key = "pica_alert";\r\n        _this.disInteractive();\r\n        return _this;\r\n    }\r\n    AlertView.prototype.show = function (config) {\r\n        this.mShowData = config;\r\n        _super.prototype.show.call(this, config);\r\n        if (this.mInitialized) {\r\n            this.mWorld.uiManager.getUILayerManager().addToDialogLayer(this);\r\n            var ox = config.ox, oy = config.oy;\r\n            this.x = (ox || this.scene.cameras.main.width / 2);\r\n            this.y = (oy || this.scene.cameras.main.height / 2);\r\n            this.mContent.setText(config.text);\r\n            if (config.title) {\r\n                this.mTitleLabel.setText(config.title);\r\n            }\r\n        }\r\n    };\r\n    AlertView.prototype.preload = function () {\r\n        this.addAtlas(this.key, "pica_alert/pica_alert.png", "pica_alert/pica_alert.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    AlertView.prototype.init = function () {\r\n        var zoom = this.mWorld.uiScale || 1;\r\n        var bg = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "bg.png"\r\n        }, false);\r\n        var title = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "title.png"\r\n        }, false);\r\n        title.y = -bg.height / 2;\r\n        this.mTitleLabel = this.scene.make.text({\r\n            text: "丢弃",\r\n            style: {\r\n                fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n                fontSize: 12 * this.dpr * zoom,\r\n                color: "#905B06"\r\n            }\r\n        }, false).setOrigin(0.5);\r\n        this.mTitleLabel.y = title.y;\r\n        this.mContent = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"](this.scene, 0, -11 * this.dpr, "", {\r\n            fontSize: 12 * this.dpr * zoom + "px",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            color: "#0",\r\n            wrap: {\r\n                mode: "char",\r\n                width: 218 * this.dpr\r\n            }\r\n        });\r\n        this.mContent.setOrigin(0.5, 0.5);\r\n        this.mContent.setText("[color=#FF0000][/color]");\r\n        this.mOkBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_3__["Button"](this.scene, this.key, "yellow_btn.png", undefined, "确定");\r\n        this.mOkBtn.setTextStyle({\r\n            color: "#905B06",\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            fontSize: 13 * this.dpr * zoom\r\n        });\r\n        this.mOkBtn.x = -(bg.width - this.mOkBtn.displayWidth) / 2 + 38 * this.dpr;\r\n        this.mOkBtn.y = (bg.height - this.mOkBtn.displayHeight) / 2 - 16 * this.dpr;\r\n        this.mOkBtn.on("Tap", this.onOkHandler, this);\r\n        this.mCancelBtn = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_3__["Button"](this.scene, this.key, "red_btn.png", undefined, "取消");\r\n        this.mCancelBtn.setTextStyle({\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            fontSize: 13 * this.dpr * zoom\r\n        });\r\n        this.mCancelBtn.x = (bg.width - this.mCancelBtn.displayWidth) / 2 - 38 * this.dpr;\r\n        this.mCancelBtn.y = this.mOkBtn.y;\r\n        this.mCancelBtn.on("Tap", this.onCancelHandler, this);\r\n        this.add([bg, title, this.mTitleLabel, this.mTitleLabel, this.mContent, this.mOkBtn, this.mCancelBtn]);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    AlertView.prototype.onOkHandler = function () {\r\n        if (!this.mShowData) {\r\n            return;\r\n        }\r\n        var callback = this.mShowData.callback;\r\n        if (callback) {\r\n            callback.call(this.mShowData.content);\r\n        }\r\n        this.onCancelHandler();\r\n    };\r\n    AlertView.prototype.onCancelHandler = function () {\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n    };\r\n    return AlertView;\r\n}(_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/alert.view.ts?')},"./src/ui/components/check.button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CheckButton", function() { return CheckButton; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar CheckButton = /** @class */ (function (_super) {\r\n    __extends(CheckButton, _super);\r\n    function CheckButton(scene, x, y, key, normalFrames, selectFrame) {\r\n        var _this = _super.call(this, scene, x, y, key, normalFrames) || this;\r\n        _this.mSelected = false;\r\n        _this.mNormalFrame = normalFrames;\r\n        _this.mSelectFrame = selectFrame;\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, _this.width, _this.height), Phaser.Geom.Rectangle.Contains);\r\n        _this.on("pointerup", _this.onSelected, _this);\r\n        return _this;\r\n    }\r\n    CheckButton.prototype.onSelected = function () {\r\n        this.selected = !this.mSelected;\r\n        this.emit("selected", this.mSelected);\r\n    };\r\n    Object.defineProperty(CheckButton.prototype, "selected", {\r\n        get: function () {\r\n            return this.mSelected;\r\n        },\r\n        set: function (val) {\r\n            if (this.mSelected !== val) {\r\n                this.mSelected = val;\r\n                var frame = val ? this.mSelectFrame : this.mNormalFrame;\r\n                this.setFrame(frame);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return CheckButton;\r\n}(Phaser.GameObjects.Image));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/check.button.ts?')},"./src/ui/components/checkbox.group.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CheckboxGroup", function() { return CheckboxGroup; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar CheckboxGroup = /** @class */ (function (_super) {\r\n    __extends(CheckboxGroup, _super);\r\n    function CheckboxGroup() {\r\n        var _this = _super.call(this) || this;\r\n        _this.mList = [];\r\n        return _this;\r\n    }\r\n    CheckboxGroup.prototype.appendItem = function (item) {\r\n        this.mList.push(item);\r\n        item.on("Tap", this.onGameObjectUpHandler, this);\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.appendItemAll = function (items) {\r\n        this.mList = this.mList.concat(items);\r\n        for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\r\n            var item = items_1[_i];\r\n            item.on("Tap", this.onGameObjectUpHandler, this);\r\n        }\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.removeItem = function (item) {\r\n        this.mList = this.mList.filter(function (button) { return button !== item; });\r\n        item.removeAllListeners();\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.selectIndex = function (index) {\r\n        if (index < 0) {\r\n            index = 0;\r\n        }\r\n        if (index >= this.mList.length) {\r\n            index = this.mList.length - 1;\r\n        }\r\n        if (this.mList.length > 0) {\r\n            this.select(this.mList[index]);\r\n        }\r\n        return this;\r\n    };\r\n    CheckboxGroup.prototype.select = function (item) {\r\n        if (this.mPrevButton === item) {\r\n            return;\r\n        }\r\n        if (this.mPrevButton) {\r\n            this.mPrevButton.changeNormal();\r\n        }\r\n        item.changeDown();\r\n        this.emit("selected", item, this.mPrevButton);\r\n        this.mPrevButton = item;\r\n    };\r\n    CheckboxGroup.prototype.reset = function () {\r\n        var _this = this;\r\n        if (this.mList) {\r\n            this.mList.forEach(function (item) {\r\n                _this.removeItem(item);\r\n            });\r\n        }\r\n    };\r\n    CheckboxGroup.prototype.destroy = function () {\r\n        var _this = this;\r\n        if (this.mList) {\r\n            this.mList.forEach(function (item) {\r\n                _this.removeItem(item);\r\n                item.destroy();\r\n            });\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CheckboxGroup.prototype.onGameObjectUpHandler = function (pointer, gameobject) {\r\n        this.select(gameobject);\r\n    };\r\n    return CheckboxGroup;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/checkbox.group.ts?')},"./src/ui/components/dynamic.image.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicImage", function() { return DynamicImage; });\n/* harmony import */ var _utils_log__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/log */ "./src/utils/log.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar DynamicImage = /** @class */ (function (_super) {\r\n    __extends(DynamicImage, _super);\r\n    function DynamicImage(scene, x, y) {\r\n        return _super.call(this, scene, x, y, undefined) || this;\r\n    }\r\n    DynamicImage.prototype.load = function (value, loadContext, completeCallBack, errorCallBack) {\r\n        this.mLoadCompleteCallbak = completeCallBack;\r\n        this.mLoadErrorCallback = errorCallBack;\r\n        this.mLoadContext = loadContext;\r\n        if (!this.scene) {\r\n            _utils_log__WEBPACK_IMPORTED_MODULE_0__["Logger"].getInstance().fatal(DynamicImage.name + " Create failed does not exist");\r\n            return;\r\n        }\r\n        this.mUrl = value;\r\n        if (this.scene.textures.exists(value)) {\r\n            this.onLoadComplete(value);\r\n        }\r\n        else {\r\n            this.scene.load.image(value, value);\r\n            this.scene.load.on(Phaser.Loader.Events.FILE_COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.on(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    DynamicImage.prototype.destroy = function (fromScene) {\r\n        if (fromScene === void 0) { fromScene = false; }\r\n        this.mLoadCompleteCallbak = null;\r\n        this.mLoadContext = null;\r\n        this.mLoadErrorCallback = null;\r\n        this.mUrl = "";\r\n        if (this.scene) {\r\n            this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n        }\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    DynamicImage.prototype.onLoadComplete = function (file) {\r\n        if (file === this.mUrl) {\r\n            this.scene.load.off(Phaser.Loader.Events.FILE_COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.off(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n            this.setTexture(this.mUrl);\r\n            if (this.mLoadCompleteCallbak) {\r\n                var cb = this.mLoadCompleteCallbak;\r\n                this.mLoadCompleteCallbak = null;\r\n                cb.call(this.mLoadContext);\r\n                this.mLoadContext = null;\r\n            }\r\n        }\r\n    };\r\n    DynamicImage.prototype.onLoadError = function (file) {\r\n        if (this.mUrl === file.url) {\r\n            if (this.mLoadErrorCallback) {\r\n                var cb = this.mLoadErrorCallback;\r\n                this.mLoadErrorCallback = null;\r\n                cb.call(this.mLoadContext);\r\n                this.mLoadContext = null;\r\n            }\r\n        }\r\n    };\r\n    return DynamicImage;\r\n}(Phaser.GameObjects.Image));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.image.ts?')},"./src/ui/components/dynamic.ninepatch.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicNinepatch", function() { return DynamicNinepatch; });\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch */ "./lib/rexui/lib/plugins/gameobjects/ninepatch/NinePatch.js");\n\r\nvar DynamicNinepatch = /** @class */ (function () {\r\n    function DynamicNinepatch(mScene, mParent) {\r\n        this.mScene = mScene;\r\n        this.mParent = mParent;\r\n    }\r\n    DynamicNinepatch.prototype.load = function (value, config, completeCallBack, loadContext) {\r\n        this.mLoadCompleteCallBack = completeCallBack;\r\n        this.mLoadContext = loadContext;\r\n        this.mConfig = config;\r\n        this.mUrl = value;\r\n        if (this.mScene.cache.obj.get(value)) {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n        else {\r\n            this.mScene.load.image(this.mUrl, this.mUrl);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n    };\r\n    DynamicNinepatch.prototype.onLoadCompleteHandler = function () {\r\n        this.mImage = new _lib_rexui_lib_plugins_gameobjects_ninepatch_NinePatch__WEBPACK_IMPORTED_MODULE_0__["default"](this.mScene, this.mConfig);\r\n        if (this.mLoadCompleteCallBack) {\r\n            this.mLoadCompleteCallBack.call(this.mLoadContext, this.mImage);\r\n            this.mLoadCompleteCallBack = null;\r\n            this.mLoadContext = null;\r\n        }\r\n    };\r\n    Object.defineProperty(DynamicNinepatch.prototype, "image", {\r\n        get: function () {\r\n            return this.mImage;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DynamicNinepatch;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.ninepatch.ts?')},"./src/ui/components/dynamic.sprite.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DynamicSprite", function() { return DynamicSprite; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar DynamicSprite = /** @class */ (function (_super) {\r\n    __extends(DynamicSprite, _super);\r\n    function DynamicSprite(scene, x, y) {\r\n        var _this = _super.call(this, scene, x, y, undefined) || this;\r\n        scene.sys.updateList.add(_this);\r\n        return _this;\r\n    }\r\n    DynamicSprite.prototype.load = function (textureURL, atlasURL, loadContext, completeCallBack, errorCallBack) {\r\n        this.mLoadCompleteCallbak = completeCallBack;\r\n        this.mLoadErrorCallback = errorCallBack;\r\n        this.mLoadContext = loadContext;\r\n        this.mUrl = textureURL + atlasURL;\r\n        if (this.scene.cache.obj.get(this.mUrl)) {\r\n            this.onLoadComplete();\r\n        }\r\n        else {\r\n            this.scene.load.atlas(this.mUrl, textureURL, atlasURL);\r\n            this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n            this.scene.load.once(Phaser.Loader.Events.FILE_LOAD_ERROR, this.onLoadError, this);\r\n            this.scene.load.start();\r\n        }\r\n    };\r\n    DynamicSprite.prototype.destroy = function (fromScene) {\r\n        this.scene.sys.updateList.remove(this);\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    DynamicSprite.prototype.onLoadComplete = function () {\r\n        if (this.mLoadCompleteCallbak) {\r\n            var cb = this.mLoadCompleteCallbak;\r\n            this.mLoadCompleteCallbak = null;\r\n            cb.call(this.mLoadContext);\r\n            this.mLoadContext = null;\r\n        }\r\n        this.scene.anims.create({\r\n            key: this.mUrl,\r\n            frames: this.scene.anims.generateFrameNames(this.mUrl),\r\n            repeat: 1\r\n        });\r\n        this.play(this.mUrl);\r\n        // this.setTexture(this.mUrl);\r\n    };\r\n    DynamicSprite.prototype.onLoadError = function (file) {\r\n        if (this.mUrl === file.url) {\r\n            if (this.mLoadErrorCallback) {\r\n                var cb = this.mLoadErrorCallback;\r\n                this.mLoadErrorCallback = null;\r\n                cb.call(this.mLoadContext);\r\n                this.mLoadContext = null;\r\n            }\r\n        }\r\n    };\r\n    return DynamicSprite;\r\n}(Phaser.GameObjects.Sprite));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/dynamic.sprite.ts?')},"./src/ui/components/input.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputPanel", function() { return InputPanel; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar InputPanel = /** @class */ (function (_super) {\r\n    __extends(InputPanel, _super);\r\n    function InputPanel(scene, world, text) {\r\n        var _this = _super.call(this) || this;\r\n        var width = scene.cameras.main.width;\r\n        var height = scene.cameras.main.height;\r\n        _this.mBackground = scene.add.graphics();\r\n        _this.mBackground.fillStyle(0x0, 0.6);\r\n        _this.mBackground.fillRect(0, 0, width, height).setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        _this.mInput = scene.add.rexInputText(6 * world.uiRatio, 6 * world.uiRatio, width - 12 * world.uiRatio, 40 * world.uiRatio, {\r\n            fontSize: 20 * world.uiRatio + "px",\r\n            color: "#0",\r\n            text: text,\r\n            backgroundColor: "#FFFFFF",\r\n            borderColor: "#FF9900"\r\n        }).setOrigin(0, 0).setFocus();\r\n        // this.mInput.y = -height / 2;\r\n        _this.mInput.node.addEventListener("keypress", function (e) {\r\n            var keycode = e.keyCode || e.which;\r\n            if (keycode === 13) {\r\n                _this.onCloseHandler();\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    InputPanel.prototype.onCloseHandler = function () {\r\n        this.emit("close", this.mInput.text);\r\n        this.mBackground.destroy();\r\n        this.mInput.destroy();\r\n        this.destroy();\r\n    };\r\n    return InputPanel;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/input.panel.ts?')},"./src/ui/components/inputPanel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputPanel", function() { return InputPanel; });\n/* harmony import */ var _inputTextFactory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./inputTextFactory */ "./src/ui/components/inputTextFactory.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar InputPanel = /** @class */ (function (_super) {\r\n    __extends(InputPanel, _super);\r\n    function InputPanel(scene, world) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var width = world.getSize().width;\r\n        var height = world.getSize().height;\r\n        _this.mBg.clear();\r\n        _this.mBg.fillStyle(0x0000, .5);\r\n        _this.mBg.fillRect(0, 0, width, height);\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        _this.mInputText = world.uiManager.getInputTextFactory().getInputText(scene);\r\n        _this.mInputText.on(_inputTextFactory__WEBPACK_IMPORTED_MODULE_0__["InputTextFieldEvent"].textExit, _this.hide, _this);\r\n        _this.add(_this.mBg);\r\n        _this.add(_this.mInputText.getSkin());\r\n        return _this;\r\n    }\r\n    Object.defineProperty(InputPanel.prototype, "text", {\r\n        get: function () {\r\n            return this.mInputText.getText();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    InputPanel.prototype.hide = function () {\r\n        if (this.mInputText) {\r\n            this.mInputText.onBlur();\r\n            this.mInputText.off(_inputTextFactory__WEBPACK_IMPORTED_MODULE_0__["InputTextFieldEvent"].textExit, this.hide, this);\r\n            this.mInputText.destroy();\r\n            this.mInputText = null;\r\n        }\r\n        if (this.mBg) {\r\n            this.mBg.destroy();\r\n            this.mBg = null;\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    return InputPanel;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/inputPanel.ts?')},"./src/ui/components/inputTextFactory.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputTextFactory", function() { return InputTextFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputTextFieldEvent", function() { return InputTextFieldEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputTextField", function() { return InputTextField; });\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar InputTextFactory = /** @class */ (function () {\r\n    function InputTextFactory(world) {\r\n        this.mWorld = world;\r\n    }\r\n    InputTextFactory.prototype.getInputText = function (scene, style) {\r\n        var inputtext = new InputTextField(scene, this.mWorld, style);\r\n        return inputtext;\r\n    };\r\n    return InputTextFactory;\r\n}());\r\n\r\nvar InputTextFieldEvent = {\r\n    textchange: "textchange",\r\n    textclick: "textclick",\r\n    textdblclick: "textdblclick",\r\n    textfocus: "textfocus",\r\n    textblur: "textblur",\r\n    textExit: "textExit",\r\n};\r\nvar InputTextField = /** @class */ (function (_super) {\r\n    __extends(InputTextField, _super);\r\n    function InputTextField(scene, world, config) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mDelayTime = 300;\r\n        _this.mScene = scene;\r\n        _this.mWorld = world;\r\n        _this.textConfig = config;\r\n        _this.mTextField = scene.make.text({\r\n            x: config.x || 0,\r\n            y: config.y || 0,\r\n            stroke: "#000000",\r\n            strokeThickness: 2,\r\n            align: config.align || "left",\r\n            style: {\r\n                color: config.color || "#fff",\r\n                font: config.font || "16px YaHei",\r\n                wordWrap: {\r\n                    width: config.textWidt || null,\r\n                }\r\n            }\r\n        }, false).setInteractive(new Phaser.Geom.Rectangle(0, 0, config.textWidth, config.textHeight), Phaser.Geom.Rectangle.Contains);\r\n        _this.mTextField.setOrigin(0.5, 0.5);\r\n        _this.mTextField.setAlign(config.align);\r\n        _this.mTextField.setText(config.text || "");\r\n        _this.mTextField.on("pointerdown", _this.showText, _this);\r\n        return _this;\r\n    }\r\n    InputTextField.prototype.onBlur = function () {\r\n        this.mInputText.onBlur();\r\n    };\r\n    InputTextField.prototype.onFocus = function () {\r\n        this.mInputText.onFocus();\r\n    };\r\n    InputTextField.prototype.getText = function () {\r\n        return this.mTextField.text;\r\n    };\r\n    InputTextField.prototype.getSkin = function () {\r\n        return this.mTextField;\r\n    };\r\n    InputTextField.prototype.destroy = function () {\r\n        if (this.mInputText) {\r\n            this.mInputText.destroy();\r\n        }\r\n        this.mInputText = null;\r\n    };\r\n    InputTextField.prototype.showText = function () {\r\n        var _this = this;\r\n        var textX = this.textConfig.posType === 1 ? -this.textConfig.textWidth >> 1 : -this.mWorld.getSize().width >> 1;\r\n        var defaultText = this.mTextField.text && this.mTextField.text.length > 0 ?\r\n            this.mTextField.text : this.textConfig.minNum;\r\n        if (!this.mInputText) {\r\n            this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this.mScene, {\r\n                id: this.textConfig.id || "input",\r\n                x: textX || 0,\r\n                y: this.textConfig.y || 0,\r\n                width: this.textConfig.textWidth || 100,\r\n                height: this.textConfig.textHeight || 100,\r\n                type: this.textConfig.type || "",\r\n                fontSize: this.textConfig.font || "16px YaHei",\r\n                color: this.textConfig.color || "#fff",\r\n                "z-index": 999,\r\n                align: "left",\r\n                text: defaultText,\r\n                posType: this.textConfig.posType\r\n            });\r\n            this.mInputText.setOrigin(0, 0.6);\r\n        }\r\n        else {\r\n            this.mInputText.setText(defaultText);\r\n        }\r\n        // 0 顶部 1 当前文本位置\r\n        if (this.textConfig.posType === 1) {\r\n            this.mTextField.visible = false;\r\n            if (!this.mInputText.parentContainer)\r\n                this.mTextField.parentContainer.add(this.mInputText);\r\n        }\r\n        this.mInputText.visible = true;\r\n        this.mInputText.on("textchange", this.onTextchange, this);\r\n        this.mInputText.on("onclick", this.onTextClick, this);\r\n        this.mInputText.on("ondblclick", this.onTextDbclick, this);\r\n        this.mInputText.on("focus", this.onTextFocus, this);\r\n        this.mInputText.on("blur", this.onTextBlur, this);\r\n        // 监听键盘enter事件，移动端会监听软件盘的enter事件\r\n        this.mInputText.node.addEventListener("keypress", function (e) {\r\n            var keycode = e.keyCode || e.which;\r\n            if (keycode === 13) {\r\n                _this.emit(InputTextFieldEvent.textExit);\r\n                _this.hideText();\r\n            }\r\n        });\r\n        this.mScene.input.on("gameobjectdown", this.sceneDown, this);\r\n        if (this.mWorld.game.device.os.iOS && !this.mWorld.game.device.os.desktop) {\r\n            this.setInputFocus();\r\n        }\r\n        else {\r\n            this.mInputTimeID = this.mScene.setTimeout(function () {\r\n                _this.setInputFocus();\r\n            }, this.mDelayTime);\r\n        }\r\n    };\r\n    InputTextField.prototype.hideText = function () {\r\n        this.mTextField.visible = true;\r\n        if (!this.mInputText)\r\n            return;\r\n        this.mInputText.off("textchange", this.onTextchange, this);\r\n        this.mInputText.off("onclick", this.onTextClick, this);\r\n        this.mInputText.off("ondblclick", this.onTextDbclick, this);\r\n        this.mInputText.off("focus", this.onTextFocus, this);\r\n        this.mInputText.off("blur", this.onTextBlur, this);\r\n        this.mScene.input.off("gameobjectdown", this.sceneDown, this);\r\n        var text = this.mInputText.text;\r\n        if (text.length > 0) {\r\n            this.mTextField.setText(text);\r\n        }\r\n        this.mInputText.setText("");\r\n        this.mInputText.setBlur();\r\n        this.mInputText.visible = false;\r\n        if (this.mInputTimeID) {\r\n            this.mScene.clearTimeout(this.mInputTimeID);\r\n        }\r\n        if (this.textConfig.posType === 1) {\r\n            this.mTextField.visible = true;\r\n        }\r\n    };\r\n    InputTextField.prototype.setInputFocus = function () {\r\n        // 从dom中获取对应id的输入文本\r\n        var input = document.all.namedItem(this.textConfig.id);\r\n        if (input) {\r\n            input.focus();\r\n        }\r\n    };\r\n    InputTextField.prototype.sceneDown = function (pointer, gameobject) {\r\n        if (gameobject && gameobject === this.mTextField) {\r\n            return;\r\n        }\r\n        this.onTextBlur();\r\n    };\r\n    InputTextField.prototype.onTextchange = function () {\r\n        if (this.textConfig.type === "number") {\r\n            var num = Number(this.mInputText.text);\r\n            if (isNaN(num)) {\r\n                num = 0;\r\n            }\r\n            if (this.textConfig.minNum && this.textConfig.maxNum) {\r\n                if (num < this.textConfig.minNum) {\r\n                    num = this.textConfig.minNum;\r\n                }\r\n                else if (num > this.textConfig.maxNum) {\r\n                    num = this.textConfig.maxNum;\r\n                }\r\n            }\r\n            this.mInputText.text = num + "";\r\n        }\r\n        this.emit(InputTextFieldEvent.textchange);\r\n    };\r\n    InputTextField.prototype.onTextClick = function () {\r\n        this.emit(InputTextFieldEvent.textclick);\r\n    };\r\n    InputTextField.prototype.onTextDbclick = function () {\r\n        this.emit(InputTextFieldEvent.textdblclick);\r\n    };\r\n    InputTextField.prototype.onTextFocus = function () {\r\n        this.onFocus();\r\n        this.emit(InputTextFieldEvent.textfocus);\r\n    };\r\n    InputTextField.prototype.onTextBlur = function () {\r\n        this.onBlur();\r\n        this.hideText();\r\n        this.emit(InputTextFieldEvent.textblur);\r\n    };\r\n    return InputTextField;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/inputTextFactory.ts?')},"./src/ui/components/label.input.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabelInput", function() { return LabelInput; });\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/inputtext/InputText */ "./lib/rexui/lib/plugins/gameobjects/inputtext/InputText.js");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\nvar LabelInput = /** @class */ (function (_super) {\r\n    __extends(LabelInput, _super);\r\n    function LabelInput(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var labelConfig = {\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT\r\n        };\r\n        var clickW = config.width || 100;\r\n        var clickH = config.height || 100;\r\n        _this.mLabel = _this.scene.make.text({\r\n            style: Object.assign(labelConfig, config)\r\n        }, false).setInteractive(new Phaser.Geom.Rectangle(-(clickW >> 1), -(clickH >> 1), clickW, clickH), Phaser.Geom.Rectangle.Contains);\r\n        _this.mLabel.on("pointerup", _this.onShowInputHandler, _this);\r\n        _this.add(_this.mLabel);\r\n        _this.mInputConfig = config;\r\n        return _this;\r\n    }\r\n    LabelInput.prototype.setText = function (val) {\r\n        this.mLabel.setText(val);\r\n        if (this.mInputText) {\r\n            this.mInputText.text = val;\r\n        }\r\n    };\r\n    LabelInput.prototype.setOrigin = function (x, y) {\r\n        this.mLabel.setOrigin(x, y);\r\n        if (this.mInputText)\r\n            this.mInputText.setOrigin(x, y);\r\n    };\r\n    LabelInput.prototype.setBlur = function () {\r\n        this.onShowLabel();\r\n    };\r\n    LabelInput.prototype.destroy = function () {\r\n        this.mLabel.destroy();\r\n        this.destroyInput();\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    LabelInput.prototype.createInputText = function () {\r\n        var _this = this;\r\n        if (this.mInputText) {\r\n            this.mInputText.destroy();\r\n        }\r\n        this.mInputText = new _lib_rexui_lib_plugins_gameobjects_inputtext_InputText__WEBPACK_IMPORTED_MODULE_0__["default"](this.scene, Object.assign({}, this.mInputConfig));\r\n        this.mInputText.on("textchange", this.onTextChangeHandler, this);\r\n        this.mInputText.node.addEventListener("keypress", function (e) {\r\n            var keycode = e.keyCode || e.which;\r\n            if (keycode === 13) {\r\n                _this.onShowLabel();\r\n            }\r\n        });\r\n    };\r\n    LabelInput.prototype.onShowInputHandler = function () {\r\n        this.createInputText();\r\n        this.remove(this.mLabel);\r\n        this.add(this.mInputText);\r\n        this.mInputText.setText(this.mLabel.text);\r\n        this.mInputText.setFocus();\r\n    };\r\n    LabelInput.prototype.onShowLabel = function () {\r\n        if (this.mInputText) {\r\n            this.mLabel.setText(this.mInputText.text);\r\n            this.destroyInput();\r\n        }\r\n        this.add(this.mLabel);\r\n    };\r\n    LabelInput.prototype.destroyInput = function () {\r\n        if (this.mInputText) {\r\n            this.mInputText.destroy();\r\n            this.mInputText = undefined;\r\n        }\r\n    };\r\n    LabelInput.prototype.onTextChangeHandler = function () {\r\n        this.emit("textchange");\r\n    };\r\n    Object.defineProperty(LabelInput.prototype, "object", {\r\n        get: function () {\r\n            return this.mInputText || this.mLabel;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LabelInput.prototype, "text", {\r\n        get: function () {\r\n            if (this.mInputText) {\r\n                return this.mInputText.text;\r\n            }\r\n            return this.mLabel.text;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return LabelInput;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/label.input.ts?')},"./src/ui/components/message.box.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBoxUI", function() { return MessageBoxUI; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBtn", function() { return MessageBtn; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar MessageBoxUI = /** @class */ (function (_super) {\r\n    __extends(MessageBoxUI, _super);\r\n    function MessageBoxUI(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mScene = scene;\r\n        _this.mConfig = config;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    MessageBoxUI.prototype.selectCall = function (itemData) {\r\n        this.mtxt.text = itemData.text;\r\n        this.mtxt.x = this.mConfig.wid - this.mtxt.width >> 1;\r\n        this.mtxt.y = this.mConfig.hei - this.mtxt.height >> 1;\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    MessageBoxUI.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        if (!this.mScene.cache.obj.has(resKey)) {\r\n            this.mScene.load.atlas(resKey, resPng, resJson);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    MessageBoxUI.prototype.onLoadCompleteHandler = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resBtn = this.mConfig.resBtn;\r\n        this.mBg = this.mScene.make.image(undefined, false);\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.mBg.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        this.mBtnList = [];\r\n        if (this.mConfig.btnData) {\r\n            var len = this.mConfig.btnData.length;\r\n            var btn = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                btn = new MessageBtn(this.mScene, this, resKey, resBtn, this.mConfig.btnWid, this.mConfig.btnHei);\r\n                this.mBtnList.push(btn);\r\n            }\r\n        }\r\n        this.mtxt = this.mScene.make.text({\r\n            x: 0, y: 0,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        this.add(this.mBg);\r\n        this.add(this.mtxt);\r\n    };\r\n    return MessageBoxUI;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar MessageBtn = /** @class */ (function (_super) {\r\n    __extends(MessageBtn, _super);\r\n    function MessageBtn(scene, messageBoxUI, resKey, resBtn, wid, hei) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.messageBoxUI = messageBoxUI;\r\n        _this.mBtn = scene.make.image(undefined, false);\r\n        _this.mBtn.setTexture(resKey, resBtn);\r\n        _this.mText = _this.scene.make.text({\r\n            x: -wid >> 1, y: -hei >> 1,\r\n            style: { fill: "#F7EDED", fontSize: 18 }\r\n        }, false);\r\n        _this.add(_this.mBtn);\r\n        _this.add(_this.mText);\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive();\r\n        _this.on("pointerdown", _this.selectHandler, _this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(MessageBtn.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mData;\r\n        },\r\n        set: function (val) {\r\n            this.mData = val;\r\n            this.mText.text = this.mData.text;\r\n            this.mText.x = -this.width / 2 + (this.width - this.mText.width >> 1);\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    MessageBtn.prototype.destroy = function () {\r\n        this.mText.destroy(true);\r\n        this.mBtn.destroy(true);\r\n        this.mData = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    MessageBtn.prototype.selectHandler = function () {\r\n        this.addTween(this.mBtn);\r\n        this.messageBoxUI.selectCall(this.itemData);\r\n    };\r\n    MessageBtn.prototype.addTween = function (img) {\r\n        this.scene.tweens.add({\r\n            targets: img,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        img.scaleX = img.scaleY = 1;\r\n    };\r\n    return MessageBtn;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/message.box.ts?')},"./src/ui/components/nine.patch.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NinePatch", function() { return NinePatch; });\n/* harmony import */ var _patches_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./patches.config */ "./src/ui/components/patches.config.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar NinePatch = /** @class */ (function (_super) {\r\n    __extends(NinePatch, _super);\r\n    function NinePatch(scene, x, y, width, height, key, frame, config) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.config = config || _this.scene.cache.custom.ninePatch.get(frame ? "" + frame : key);\r\n        // 对于config进行取整\r\n        _this.config.top = Math.round(_this.config.top);\r\n        if (_this.config.right)\r\n            _this.config.right = Math.round(_this.config.right);\r\n        if (_this.config.bottom)\r\n            _this.config.bottom = Math.round(_this.config.bottom);\r\n        if (_this.config.left)\r\n            _this.config.left = Math.round(_this.config.left);\r\n        Object(_patches_config__WEBPACK_IMPORTED_MODULE_0__["normalizePatchesConfig"])(_this.config);\r\n        _this.setSize(width, height);\r\n        _this.setTexture(key, frame);\r\n        return _this;\r\n    }\r\n    NinePatch.prototype.resize = function (width, height) {\r\n        width = Math.round(width);\r\n        height = Math.round(height);\r\n        if (!this.config) {\r\n            return this;\r\n        }\r\n        if (this.width === width && this.height === height) {\r\n            return this;\r\n        }\r\n        // 增加中间区域尺寸 1\r\n        width = Math.max(width, this.config.left + this.config.right + 1);\r\n        height = Math.max(height, this.config.top + this.config.bottom + 1);\r\n        this.setSize(width, height);\r\n        this.drawPatches();\r\n        return;\r\n    };\r\n    NinePatch.prototype.setTexture = function (key, frame) {\r\n        this.originTexture = this.scene.textures.get(key);\r\n        this.setFrame(frame);\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setFrame = function (frame) {\r\n        this.originFrame = this.originTexture.frames[frame] || this.originTexture.frames[NinePatch.__BASE];\r\n        this.createPatches();\r\n        this.drawPatches();\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.finalXs = [0, this.config.left, this.width - this.config.right, this.width];\r\n        this.finalYs = [0, this.config.top, this.height - this.config.bottom, this.height];\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setTint = function (tint) {\r\n        this.tint = tint;\r\n        return this;\r\n    };\r\n    NinePatch.prototype.setTintFill = function (tint) {\r\n        this.tint = tint;\r\n        this.tintFill = true;\r\n        return this;\r\n    };\r\n    Object.defineProperty(NinePatch.prototype, "tintFill", {\r\n        get: function () {\r\n            return this.first && this.first.tintFill;\r\n        },\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.tintFill = value; });\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NinePatch.prototype, "tint", {\r\n        set: function (value) {\r\n            this.each(function (patch) { return patch.setTintFill(value); });\r\n            this.internalTint = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(NinePatch.prototype, "isTinted", {\r\n        get: function () {\r\n            return this.first && this.first.isTinted;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NinePatch.prototype.clearTint = function () {\r\n        this.each(function (patch) { return patch.clearTint(); });\r\n        this.internalTint = undefined;\r\n        this.tintFill = false;\r\n    };\r\n    NinePatch.prototype.createPatches = function () {\r\n        // The positions we want from the base texture\r\n        var textureXs = [0, this.config.left, this.originFrame.width - this.config.right, this.originFrame.width];\r\n        var textureYs = [0, this.config.top, this.originFrame.height - this.config.bottom, this.originFrame.height];\r\n        var patchIndex = 0;\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                this.createPatchFrame(this.getPatchNameByIndex(patchIndex), textureXs[xi], // x\r\n                textureYs[yi], // y\r\n                textureXs[xi + 1] - textureXs[xi], // width\r\n                textureYs[yi + 1] - textureYs[yi] // height\r\n                );\r\n                ++patchIndex;\r\n            }\r\n        }\r\n    };\r\n    // private drawPatches(): void {\r\n    //     const tintFill = this.tintFill;\r\n    //     this.removeAll(true);\r\n    //     let patchIndex = 0;\r\n    //     for (let yi = 0; yi < 3; yi++) {\r\n    //         for (let xi = 0; xi < 3; xi++) {\r\n    //             const patch: Phaser.Textures.Frame = this.originTexture.frames[this.getPatchNameByIndex(patchIndex)];\r\n    //             const patchImg = new Phaser.GameObjects.Image(this.scene, 0, 0, patch.texture.key, patch.name);\r\n    //             patchImg.setOrigin(0);\r\n    //             patchImg.setPosition(this.finalXs[xi] - this.width * this.originX, this.finalYs[yi] - this.height * this.originY);\r\n    //             patchImg.setScale(\r\n    //                 (this.finalXs[xi + 1] - this.finalXs[xi]) / patch.width,\r\n    //                 (this.finalYs[yi + 1] - this.finalYs[yi]) / patch.height\r\n    //             );\r\n    //             this.add(patchImg);\r\n    //             patchImg.setTint(this.internalTint);\r\n    //             patchImg.tintFill = tintFill;\r\n    //             ++patchIndex;\r\n    //         }\r\n    //     }\r\n    // }\r\n    NinePatch.prototype.drawPatches = function () {\r\n        var tintFill = this.tintFill;\r\n        this.removeAll(true);\r\n        var patchIndex = 0;\r\n        // const info = [];\r\n        for (var yi = 0; yi < 3; yi++) {\r\n            for (var xi = 0; xi < 3; xi++) {\r\n                var patch = this.originTexture.frames[this.getPatchNameByIndex(patchIndex)];\r\n                var patchImg = new Phaser.GameObjects.Image(this.scene, 0, 0, patch.texture.key, patch.name);\r\n                patchImg.setOrigin(0);\r\n                patchImg.setPosition((this.finalXs[xi] * 1000 - this.width * this.originX * 1000) / 1000, (this.finalYs[yi] * 1000 - this.height * this.originY * 1000) / 1000);\r\n                // patchImg.setScale(\r\n                //     (this.finalXs[xi + 1] * 1000 - this.finalXs[xi] * 1000) / patch.width / 1000,\r\n                //     (this.finalYs[yi + 1] * 1000 - this.finalYs[yi] * 1000) / patch.height / 1000\r\n                // );\r\n                // 直接设置displayWidth即最终显示宽度\r\n                patchImg.displayWidth = this.finalXs[xi + 1] - this.finalXs[xi];\r\n                patchImg.displayHeight = this.finalYs[yi + 1] - this.finalYs[yi];\r\n                this.add(patchImg);\r\n                if (this.internalTint)\r\n                    patchImg.setTint(this.internalTint);\r\n                patchImg.tintFill = tintFill;\r\n                ++patchIndex;\r\n                // info.push({ x: patchImg.x, y: patchImg.y, w: patchImg.width, h: patchImg.height, s: patchImg.scale, sx: patchImg.scaleX, sy: patchImg.scaleY });\r\n            }\r\n        }\r\n        // Logger.getInstance().log("ZW-- drawPatches: ", info);\r\n        // Logger.getInstance().log("ZW-- lines: " + (info[0].w * info[0].sx + info[0].x) + "; " + (info[1].w * info[1].sx + info[1].x));\r\n    };\r\n    NinePatch.prototype.createPatchFrame = function (patch, x, y, width, height) {\r\n        if (this.originTexture.frames.hasOwnProperty(patch)) {\r\n            return;\r\n        }\r\n        this.originTexture.add(patch, this.originFrame.sourceIndex, this.originFrame.cutX + x, this.originFrame.cutY + y, width, height);\r\n    };\r\n    NinePatch.prototype.getPatchNameByIndex = function (index) {\r\n        return this.originFrame.name + "|" + NinePatch.patches[index];\r\n    };\r\n    NinePatch.__BASE = "__BASE";\r\n    NinePatch.patches = ["[0][0]", "[1][0]", "[2][0]", "[0][1]", "[1][1]", "[2][1]", "[0][2]", "[1][2]", "[2][2]"];\r\n    return NinePatch;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/nine.patch.ts?')},"./src/ui/components/ninepatch.button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NinePatchButton", function() { return NinePatchButton; });\n/* harmony import */ var _nine_patch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nine.patch */ "./src/ui/components/nine.patch.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar NinePatchButton = /** @class */ (function (_super) {\r\n    __extends(NinePatchButton, _super);\r\n    function NinePatchButton(scene, x, y, width, height, key, frame, text, config, data) {\r\n        var _this = _super.call(this, scene, x, y) || this;\r\n        _this.mScene = scene;\r\n        _this.mKey = key;\r\n        _this.mFrame = frame ? frame : "__BASE";\r\n        _this.initFrame();\r\n        _this.setSize(width, height);\r\n        _this.mNingBg = new _nine_patch__WEBPACK_IMPORTED_MODULE_0__["NinePatch"](_this.scene, 0, 0, width, height, key, _this.mFrame_nrmal, config);\r\n        _this.add(_this.mNingBg);\r\n        if (data) {\r\n            _this.btnData = data;\r\n        }\r\n        _this.mLabel = _this.scene.make.text(undefined, false)\r\n            .setOrigin(0.5, 0.5)\r\n            .setSize(_this.width, _this.height)\r\n            .setAlign("center")\r\n            .setText(text);\r\n        _this.add(_this.mLabel);\r\n        // this.setSize(this.mNingBg.width, this.mNingBg.height);\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        _this.on("pointerdown", _this.onPointerDown, _this);\r\n        _this.on("pointerup", _this.onPointerUp, _this);\r\n        return _this;\r\n        // this.on("pointerout", this.changeNormal, this);\r\n        // this.on("pointerover", this.changeOver, this);\r\n    }\r\n    Object.defineProperty(NinePatchButton.prototype, "enable", {\r\n        set: function (value) {\r\n            if (value) {\r\n                this.mNingBg.clearTint();\r\n                this.mLabel.clearTint();\r\n                this.setInteractive();\r\n            }\r\n            else {\r\n                this.mNingBg.setTintFill(0x666666);\r\n                this.mLabel.setTintFill(0x777777);\r\n                this.removeInteractive();\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NinePatchButton.prototype.getBtnData = function () {\r\n        return this.btnData;\r\n    };\r\n    NinePatchButton.prototype.setText = function (text) {\r\n        this.mLabel.setText(text);\r\n    };\r\n    NinePatchButton.prototype.getText = function () {\r\n        return this.mLabel.text;\r\n    };\r\n    NinePatchButton.prototype.setTextStyle = function (style) {\r\n        this.mLabel.setStyle(style);\r\n    };\r\n    NinePatchButton.prototype.setFontStyle = function (val) {\r\n        this.mLabel.setFontStyle(val);\r\n    };\r\n    NinePatchButton.prototype.setTextOffset = function (x, y) {\r\n        this.mLabel.setPosition(x, y);\r\n    };\r\n    NinePatchButton.prototype.setFrame = function (frame) {\r\n        this.mNingBg.setFrame(frame);\r\n        return this;\r\n    };\r\n    NinePatchButton.prototype.destroy = function (fromScene) {\r\n        if (this.mLabel)\r\n            this.mLabel.destroy();\r\n        _super.prototype.destroy.call(this, fromScene);\r\n    };\r\n    NinePatchButton.prototype.setFrameNormal = function (normal, down, over) {\r\n        this.mFrame_nrmal = normal;\r\n        this.mFrame_down = (down ? down : normal);\r\n        this.mFrame_over = (over ? over : normal);\r\n        this.changeNormal();\r\n        return this;\r\n    };\r\n    // public setState(val: string) {\r\n    // }\r\n    NinePatchButton.prototype.changeNormal = function () {\r\n        this.setFrame(this.mFrame_nrmal);\r\n    };\r\n    NinePatchButton.prototype.changeDown = function () {\r\n        // this.scale = 0.9;\r\n        this.setFrame(this.mFrame_down);\r\n    };\r\n    NinePatchButton.prototype.changeOver = function () {\r\n        // this.setTexture()\r\n        this.setFrame(this.mFrame_over);\r\n    };\r\n    NinePatchButton.prototype.isExists = function (frame) {\r\n        var originTexture = this.scene.textures.get(this.mKey);\r\n        if (originTexture && originTexture.has(frame))\r\n            return true;\r\n        return false;\r\n    };\r\n    NinePatchButton.prototype.onPointerDown = function (pointer) {\r\n        this.changeDown();\r\n    };\r\n    NinePatchButton.prototype.onPointerUp = function (pointer) {\r\n        this.changeNormal();\r\n        this.emit("click", pointer, this);\r\n    };\r\n    Object.defineProperty(NinePatchButton.prototype, "label", {\r\n        get: function () {\r\n            return this.mLabel;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    NinePatchButton.prototype.scaleHandler = function () {\r\n        this.mScene.tweens.add({\r\n            targets: this,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        this.scaleX = this.scaleY = 1;\r\n    };\r\n    NinePatchButton.prototype.initFrame = function () {\r\n        var frame = this.mFrame ? this.mFrame : this.mKey;\r\n        this.mFrame_nrmal = frame + "_normal";\r\n        var down = frame + "_down";\r\n        if (!this.isExists(down)) {\r\n            down = frame + "_normal";\r\n        }\r\n        this.mFrame_down = down;\r\n        var over = frame + "_over";\r\n        if (!this.isExists(over)) {\r\n            over = frame + "_normal";\r\n        }\r\n        this.mFrame_over = over;\r\n    };\r\n    return NinePatchButton;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/ninepatch.button.ts?')},"./src/ui/components/patches.config.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizePatchesConfig", function() { return normalizePatchesConfig; });\nvar normalizePatchesConfig = function (config) {\r\n    config.bottom = (config.bottom !== undefined) ? config.bottom : config.top;\r\n    config.left = (config.left !== undefined) ? config.left : config.top;\r\n    config.right = (config.right !== undefined) ? config.right : config.left;\r\n    return config;\r\n};\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/patches.config.ts?')},"./src/ui/components/radio.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Radio", function() { return Radio; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RadioItemRender", function() { return RadioItemRender; });\n/* harmony import */ var _nine_patch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js */ "./lib/rexui/lib/plugins/gameobjects/text/bbcodetext/BBCodeText.js");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar Radio = /** @class */ (function (_super) {\r\n    __extends(Radio, _super);\r\n    // private mArrow: Phaser.GameObjects.Image;\r\n    function Radio(scene, config) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mIsShow = false;\r\n        _this.mInit = false;\r\n        _this.mScene = scene;\r\n        _this.mConfig = config;\r\n        _this.init();\r\n        return _this;\r\n    }\r\n    Radio.prototype.setRadioData = function (value) {\r\n        this.clearRadioData();\r\n        this.itemList = [];\r\n        var len = value.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var item = new RadioItemRender(this.mScene, this, this.mConfig.wid + 10, 20, this.mConfig.resKey, this.mConfig.resArrow);\r\n            var renderData = value[i];\r\n            item.itemData = {\r\n                index: i,\r\n                text: renderData.text,\r\n                data: renderData.node.id,\r\n                selected: false,\r\n                enabled: true,\r\n            };\r\n            item.x = this.mConfig.wid / 2 + 25;\r\n            item.y = i * 33 + 23;\r\n            this.add(item);\r\n            this.itemList.push(item);\r\n        }\r\n        // 默認选择第0個\r\n        //  this.selectCall(this.itemList[0].itemData);\r\n    };\r\n    Radio.prototype.clearRadioData = function () {\r\n        if (this.itemList) {\r\n            var itemLen = this.itemList.length;\r\n            for (var i = 0; i < itemLen; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n                item = null;\r\n            }\r\n            this.itemList.length = 0;\r\n        }\r\n    };\r\n    Object.defineProperty(Radio.prototype, "isShow", {\r\n        get: function () {\r\n            return this.mIsShow;\r\n        },\r\n        set: function (value) {\r\n            this.mIsShow = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Radio.prototype.selectCall = function (itemData) {\r\n        if (this.mConfig.clickCallBack) {\r\n            this.mConfig.clickCallBack.call(this, itemData);\r\n        }\r\n    };\r\n    Radio.prototype.destroy = function () {\r\n        if (this.itemList) {\r\n            var len = this.itemList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.itemList[i];\r\n                if (!item)\r\n                    continue;\r\n                item.destroy();\r\n            }\r\n            this.itemList.length = 0;\r\n            this.itemList = null;\r\n        }\r\n        this.removeAll();\r\n        this.removeAllListeners();\r\n        if (this.parentContainer) {\r\n            this.parentContainer.remove(this);\r\n        }\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    Radio.prototype.init = function () {\r\n        var resKey = this.mConfig.resKey;\r\n        var resPng = this.mConfig.resPng;\r\n        var resJson = this.mConfig.resJson;\r\n        if (!this.mScene.cache.obj.has(resKey)) {\r\n            this.mScene.load.atlas(resKey, resPng, resJson);\r\n            this.mScene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadCompleteHandler, this);\r\n            this.mScene.load.start();\r\n        }\r\n        else {\r\n            this.onLoadCompleteHandler();\r\n        }\r\n    };\r\n    Radio.prototype.onLoadCompleteHandler = function () {\r\n        this.mInit = true;\r\n        var resKey = this.mConfig.resKey;\r\n        this.mBg = new _nine_patch__WEBPACK_IMPORTED_MODULE_0__["NinePatch"](this.scene, 0, 0, this.mConfig.wid + 20, this.mConfig.hei, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.mBg.setTexture(resKey, this.mConfig.resBg);\r\n        this.mBg.x = this.mConfig.wid / 2 - 2;\r\n        this.mBg.y = this.mConfig.hei / 2;\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mConfig.wid, this.mConfig.hei);\r\n        if (this.mConfig.completeBack) {\r\n            this.mConfig.completeBack();\r\n        }\r\n    };\r\n    return Radio;\r\n}(Phaser.GameObjects.Container));\r\n\r\nvar RadioItemRender = /** @class */ (function (_super) {\r\n    __extends(RadioItemRender, _super);\r\n    function RadioItemRender(scene, selectCallUI, wid, hei, resKey, arrowRes) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.mSelectCallUI = selectCallUI;\r\n        _this.mText = new _lib_rexui_lib_plugins_gameobjects_text_bbcodetext_BBCodeText_js__WEBPACK_IMPORTED_MODULE_2__["default"](scene, 0, 0, "", {\r\n            fontSize: "20px",\r\n            wrap: {\r\n                mode: "char",\r\n                width: wid\r\n            },\r\n        });\r\n        // this.mText = this.scene.make.text({\r\n        //     x: -wid >> 1, y: -hei >> 1,\r\n        //     style: { font: "bold 20px YaHei", fill: "#F7EDED" }\r\n        // }, false);\r\n        // this.mText.style.align = "left";\r\n        var COLOR = 0xffcc00;\r\n        _this.mSelectBG = scene.make.graphics(undefined, false);\r\n        _this.mSelectBG.fillStyle(COLOR, .8);\r\n        _this.mSelectBG.fillRect(-wid >> 1, -hei >> 1, wid - 36, hei);\r\n        _this.mSelectBG.visible = false;\r\n        _this.setSize(wid, hei);\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, wid, hei), Phaser.Geom.Rectangle.Contains);\r\n        _this.addListen();\r\n        _this.mArrow = scene.make.image(undefined, false);\r\n        _this.mArrow.setTexture(resKey, arrowRes);\r\n        _this.mArrow.x = -wid / 2 - 10;\r\n        _this.mArrow.y = 0;\r\n        _this.mArrow.visible = false;\r\n        _this.add([_this.mSelectBG, _this.mText, _this.mArrow]);\r\n        return _this;\r\n    }\r\n    RadioItemRender.prototype.addListen = function () {\r\n        this.on("pointerover", this.overHandler, this);\r\n        this.on("pointerout", this.outHandler, this);\r\n        this.on("pointerdown", this.selectHandler, this);\r\n    };\r\n    RadioItemRender.prototype.removeListen = function () {\r\n        this.off("pointerover", this.overHandler, this);\r\n        this.off("pointerout", this.outHandler, this);\r\n        this.off("pointerdown", this.selectHandler, this);\r\n    };\r\n    Object.defineProperty(RadioItemRender.prototype, "itemData", {\r\n        get: function () {\r\n            return this.mData;\r\n        },\r\n        set: function (val) {\r\n            this.mData = val;\r\n            this.mText.text = this.mData.text;\r\n            this.mText.x = -this.width >> 1;\r\n            this.mText.y = -this.height / 2 + (this.height - this.mText.height >> 1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    RadioItemRender.prototype.destroy = function () {\r\n        this.removeListen();\r\n        this.mText.destroy(true);\r\n        this.mSelectBG.destroy(true);\r\n        this.mArrow.destroy(true);\r\n        this.mText = null;\r\n        this.mData = null;\r\n        this.mSelectCallUI = null;\r\n        this.mArrow = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    RadioItemRender.prototype.setSelected = function (val) {\r\n        this.mSelectBG.visible = val;\r\n        this.mArrow.visible = val;\r\n        if (this.mSelectCallUI)\r\n            this.mSelectCallUI.selectCall(this.itemData);\r\n    };\r\n    RadioItemRender.prototype.overHandler = function () {\r\n        this.mSelectBG.visible = true;\r\n        this.mArrow.visible = true;\r\n    };\r\n    RadioItemRender.prototype.outHandler = function () {\r\n        this.mSelectBG.visible = false;\r\n        this.mArrow.visible = false;\r\n    };\r\n    RadioItemRender.prototype.selectHandler = function () {\r\n        this.overHandler();\r\n        this.mSelectCallUI.selectCall(this.itemData);\r\n    };\r\n    return RadioItemRender;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/radio.ts?')},"./src/ui/components/tab.button.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TabButton", function() { return TabButton; });\n/* harmony import */ var _ninepatch_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ninepatch.button */ "./src/ui/components/ninepatch.button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar TabButton = /** @class */ (function (_super) {\r\n    __extends(TabButton, _super);\r\n    function TabButton(scene, x, y, width, height, key, frame, text, config, data) {\r\n        var _this = _super.call(this, scene, x, y, width, height, key, frame, text, config, data) || this;\r\n        _this.setInteractive(new Phaser.Geom.Rectangle(0, 0, width, height), Phaser.Geom.Rectangle.Contains);\r\n        return _this;\r\n    }\r\n    TabButton.prototype.onPointerUp = function () { };\r\n    return TabButton;\r\n}(_ninepatch_button__WEBPACK_IMPORTED_MODULE_0__["NinePatchButton"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/components/tab.button.ts?')},"./src/ui/decorate/decorate.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecorateManager", function() { return DecorateManager; });\n/* harmony import */ var _decorate_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./decorate.panel */ "./src/ui/decorate/decorate.panel.ts");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__);\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar DecorateManager = /** @class */ (function (_super) {\r\n    __extends(DecorateManager, _super);\r\n    function DecorateManager(scene, roomService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mPanel = new _decorate_panel__WEBPACK_IMPORTED_MODULE_0__["DecoratePanel"](scene, roomService);\r\n        _this.mPanel.on("moveElement", _this.onMoveElementHandler, _this);\r\n        _this.mPanel.on("addSprite", _this.onAddSpriteHandler, _this);\r\n        _this.mPanel.on("addSingleSprite", _this.onAddSingleSprtieHandle, _this);\r\n        _this.mRoomService = roomService;\r\n        _this.mLayerManager = roomService.layerManager;\r\n        return _this;\r\n    }\r\n    DecorateManager.prototype.setElement = function (ele) {\r\n        this.mPanel.setElement(ele);\r\n        this.mLayerManager.addToSceneToUI(this.mPanel);\r\n        this.mPanel.show();\r\n    };\r\n    DecorateManager.prototype.canPut = function (val) {\r\n        if (this.mPanel) {\r\n            this.mPanel.canPUt(val);\r\n        }\r\n    };\r\n    DecorateManager.prototype.remove = function () {\r\n        // TODO panel只有destroy。需要封装个仅移除的方法\r\n        if (this.mPanel.parentContainer) {\r\n            this.mPanel.parentContainer.remove(this.mPanel);\r\n        }\r\n        this.mPanel.removeListen();\r\n    };\r\n    DecorateManager.prototype.updatePos = function (x, y) {\r\n        if (!this.mPanel) {\r\n            return;\r\n        }\r\n        this.mPanel.setPos(x, y);\r\n    };\r\n    DecorateManager.prototype.destroy = function () {\r\n        if (this.mPanel) {\r\n            this.mPanel.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    DecorateManager.prototype.onMoveElementHandler = function (pos) {\r\n        this.emit("moveElement", pos);\r\n    };\r\n    DecorateManager.prototype.onAddSpriteHandler = function (sprite, points) {\r\n        this.sendAddSpriteByType(sprite, points);\r\n    };\r\n    DecorateManager.prototype.onAddSingleSprtieHandle = function (sprite, points) {\r\n        this.sendAddSingleSprite(sprite, points);\r\n    };\r\n    DecorateManager.prototype.sendAddSpriteByType = function (sprite, points) {\r\n        if (!sprite || !points || points.length < 1) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SPRITE_BY_TYPE);\r\n        var content = packet.content;\r\n        var pos = [];\r\n        for (var _i = 0, points_1 = points; _i < points_1.length; _i++) {\r\n            var point = points_1[_i];\r\n            var p = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].PBPoint3f.create();\r\n            p.x = point.x;\r\n            p.y = point.y;\r\n            pos.push(p);\r\n        }\r\n        content.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType;\r\n        content.sprite = sprite.toSprite();\r\n        content.points = pos;\r\n        this.mRoomService.connection.send(packet);\r\n    };\r\n    DecorateManager.prototype.sendAddSingleSprite = function (sprite, points) {\r\n        if (!sprite || !points || points.length < 1) {\r\n            return;\r\n        }\r\n        var packet = new net_socket_packet__WEBPACK_IMPORTED_MODULE_1__["PBpacket"](pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_virtual_world"].OPCODE._OP_CLIENT_REQ_VIRTUAL_WORLD_EDIT_MODE_ADD_SINGLE_SPRITE_BY_TYPE);\r\n        var content = packet.content;\r\n        var pos = [];\r\n        for (var _i = 0, points_2 = points; _i < points_2.length; _i++) {\r\n            var point = points_2[_i];\r\n            var p = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].PBPoint3f.create();\r\n            p.x = point.x;\r\n            p.y = point.y;\r\n            pos.push(p);\r\n        }\r\n        content.nodeType = pixelpai_proto__WEBPACK_IMPORTED_MODULE_2__["op_def"].NodeType.ElementNodeType;\r\n        content.sprite = sprite.toSprite();\r\n        content.points = pos;\r\n        this.mRoomService.connection.send(packet);\r\n    };\r\n    return DecorateManager;\r\n}(Phaser.Events.EventEmitter));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/decorate/decorate.manager.ts?')},"./src/ui/decorate/decorate.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DecoratePanel", function() { return DecoratePanel; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_pos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/pos */ "./src/utils/pos.ts");\n/* harmony import */ var _utils_position45__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/position45 */ "./src/utils/position45.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../rooms/element/element */ "./src/rooms/element/element.ts");\n/* harmony import */ var _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/button/Button */ "./lib/rexui/lib/ui/button/Button.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DecoratePanel = /** @class */ (function (_super) {\r\n    __extends(DecoratePanel, _super);\r\n    function DecoratePanel(scene, mRoomService) {\r\n        var _this = _super.call(this, scene, mRoomService.world) || this;\r\n        _this.mRoomService = mRoomService;\r\n        _this.resKey = "decorate";\r\n        _this.minGrid = 2;\r\n        _this.maxGrid = 10;\r\n        _this.key = "decorate_edit_menu";\r\n        _this.offset = new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"]();\r\n        _this.mScaleRatio = 1;\r\n        _this.setTween(false);\r\n        if (_this.mWorld)\r\n            _this.mScaleRatio = _this.mWorld.scaleRatio;\r\n        return _this;\r\n    }\r\n    DecoratePanel.prototype.show = function (param) {\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        if (this.mShow)\r\n            return;\r\n        if (this.soundGroup && this.soundGroup.open)\r\n            this.playSound(this.soundGroup.open);\r\n        if (!this.mTweening && this.mTweenBoo) {\r\n            this.showTween(true);\r\n        }\r\n        else {\r\n            this.mShow = true;\r\n        }\r\n    };\r\n    DecoratePanel.prototype.addListen = function () {\r\n        if (this.mCancelBtn)\r\n            this.mCancelBtn.on("pointerup", this.onCancelHandler, this);\r\n        if (this.mOkBtn)\r\n            this.mOkBtn.on("pointerup", this.onAddHandler, this);\r\n        if (this.mRecycleBtn)\r\n            this.mRecycleBtn.on("pointerup", this.onRecycleHandler, this);\r\n        if (this.mTurnBtn)\r\n            this.mTurnBtn.on("pointerup", this.onTurnHandler, this);\r\n        if (this.mMoveBtn)\r\n            this.mMoveBtn.on("pointerup", this.onShowMoveMenuHandler, this);\r\n        if (this.mRepeatBtn)\r\n            this.mRepeatBtn.on("pointerup", this.onShowRepeatHandler, this);\r\n        if (this.mExtendBtn)\r\n            this.mExtendBtn.on("pointerup", this.onShowExtendsHandler, this);\r\n        if (this.mMoveMenuContainer) {\r\n            this.mMoveMenuContainer.register();\r\n            this.mMoveMenuContainer.on("move", this.onMoveHandler, this);\r\n        }\r\n        if (this.mRepeatMenuContainer) {\r\n            this.mRepeatMenuContainer.register();\r\n            this.mRepeatMenuContainer.on("move", this.onRepeatHandler, this);\r\n            this.mRepeatMenuContainer.on("hold", this.onHoldRepeatHandler, this);\r\n        }\r\n    };\r\n    DecoratePanel.prototype.removeListen = function () {\r\n        if (this.mCancelBtn)\r\n            this.mCancelBtn.off("pointerup", this.onCancelHandler, this);\r\n        if (this.mOkBtn)\r\n            this.mOkBtn.off("pointerup", this.onAddHandler, this);\r\n        if (this.mRecycleBtn)\r\n            this.mRecycleBtn.off("pointerup", this.onRecycleHandler, this);\r\n        if (this.mTurnBtn)\r\n            this.mTurnBtn.off("pointerup", this.onTurnHandler, this);\r\n        if (this.mMoveBtn)\r\n            this.mMoveBtn.off("pointerup", this.onShowMoveMenuHandler, this);\r\n        if (this.mRepeatBtn)\r\n            this.mRepeatBtn.off("pointerup", this.onShowRepeatHandler, this);\r\n        if (this.mExtendBtn)\r\n            this.mExtendBtn.off("pointerup", this.onShowExtendsHandler, this);\r\n        if (this.mMoveMenuContainer) {\r\n            this.mMoveMenuContainer.unRegister();\r\n            this.mMoveMenuContainer.off("move", this.onMoveHandler, this);\r\n        }\r\n        if (this.mRepeatMenuContainer) {\r\n            this.mRepeatMenuContainer.unRegister();\r\n            this.mRepeatMenuContainer.off("move", this.onRepeatHandler, this);\r\n            this.mRepeatMenuContainer.off("hold", this.onHoldRepeatHandler, this);\r\n        }\r\n    };\r\n    DecoratePanel.prototype.setElement = function (ele) {\r\n        this.mDisplayObject = ele;\r\n        this.mSprite = ele.model;\r\n        if (!this.mInitialized) {\r\n            return;\r\n        }\r\n        var pos = this.mDisplayObject.getPosition();\r\n        this.x = pos.x;\r\n        this.y = pos.y;\r\n        this.updateArrowPos(ele);\r\n        this.addListen();\r\n    };\r\n    DecoratePanel.prototype.canPUt = function (val) {\r\n        if (val !== this.mCanPut) {\r\n            this.mCanPut = val;\r\n            if (!this.mOkBtn) {\r\n                return;\r\n            }\r\n            if (val) {\r\n                this.mOkBtn.clearTint();\r\n            }\r\n            else {\r\n                this.mOkBtn.setTint(0x666666);\r\n            }\r\n        }\r\n    };\r\n    DecoratePanel.prototype.setPos = function (x, y, z) {\r\n        this.x = x * this.mScaleRatio;\r\n        this.y = (y + this.offset.y) * this.mScaleRatio;\r\n        this.z = z || 0;\r\n        return this;\r\n    };\r\n    DecoratePanel.prototype.preload = function () {\r\n        // this.scene.load.image(Border.getName(), Border.getPNG());\r\n        // this.scene.load.image("arrow", Url.getRes("ui/common/common_arrow.png"));\r\n        // this.scene.load.atlas(this.resKey, Url.getRes("ui/decorate/decorate_atlas.png"), Url.getRes("ui/decorate/decorate_atlas.json"));\r\n        this.addAtlas(this.key, "decorate_edit_menu/decorate_edit_menu.png", "decorate_edit_menu/decorate_edit_menu.json");\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    DecoratePanel.prototype.init = function () {\r\n        var w = this.scene.cameras.main.width / this.scale;\r\n        var h = this.scene.cameras.main.height / this.scale;\r\n        this.mMainMenus = [];\r\n        this.mMenuContainer = this.scene.make.container({\r\n            x: w >> 1,\r\n        }, false);\r\n        this.mSubMenus = this.scene.make.container({\r\n            x: w >> 1,\r\n            y: 60 * this.dpr\r\n        }, false);\r\n        this.mOkBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "ok_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mRecycleBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "recycly_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mTurnBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "turn_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mCancelBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "cancel_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        // this.add([this.mControllContainer, this.mArrow1, this.mArrow7, this.mArrow3, this.mArrow5]);\r\n        this.mHorizontalBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "horizontal_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mMoveBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "move_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mRepeatBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "repeat_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mExtendBtn = this.scene.make.image({\r\n            key: this.key,\r\n            frame: "extend_btn.png"\r\n        }, false).setInteractive().setOrigin(0);\r\n        this.mMoveMenuContainer = new MoveMenu(this.scene, this.key, this.dpr, this.scale);\r\n        this.mMoveMenuContainer.y = this.mSubMenus.y + 60 * this.dpr + this.mMoveMenuContainer.height / 2;\r\n        this.mRepeatMenuContainer = new MoveMenu(this.scene, this.key, this.dpr, this.scale);\r\n        this.mRepeatMenuContainer.y = this.mMoveMenuContainer.y;\r\n        var zoom = this.scale;\r\n        // this.add(this.mMenuGroup);\r\n        // this.mMenuGroup.addMultiple([this.mOkBtn, this.mTurnBtn, this.mRecycleBtn, this.mCancelBtn])\r\n        // this.mMainMenus = ;\r\n        // this.mSubMenus = ;\r\n        this.add([this.mMenuContainer, this.mSubMenus]);\r\n        this.mMenuContainer.add([this.mOkBtn, this.mTurnBtn, this.mRecycleBtn, this.mCancelBtn]);\r\n        this.mSubMenus.add([this.mHorizontalBtn, this.mMoveBtn, this.mRepeatBtn, this.mExtendBtn]);\r\n        // this.add(this.mSubMenus);\r\n        var mainMenuW = w - 55 * this.dpr * this.mWorld.uiScale * 2;\r\n        this.mMenuContainer.x = -mainMenuW >> 1;\r\n        var list = this.mMenuContainer.list;\r\n        list.map(function (btn) { return mainMenuW -= btn.width; });\r\n        var margin = mainMenuW / (list.length - 1) / zoom;\r\n        for (var i = 1; i < list.length; i++) {\r\n            var preButton = list[i - 1];\r\n            var button = list[i];\r\n            button.x = preButton.width + preButton.x + margin;\r\n        }\r\n        mainMenuW = w - 70 * this.dpr * this.mWorld.uiScale * 2;\r\n        this.mSubMenus.x = -mainMenuW >> 1;\r\n        var subList = this.mSubMenus.list;\r\n        subList.map(function (btn) { return mainMenuW -= btn.width; });\r\n        margin = mainMenuW / (subList.length - 1) / zoom;\r\n        for (var i = 1; i < subList.length; i++) {\r\n            var preButton = subList[i - 1];\r\n            var button = subList[i];\r\n            button.x = preButton.width + preButton.x + margin;\r\n        }\r\n        this.mMoveMenuContainer.x = this.mSubMenus.x + this.mMoveBtn.x + this.mMoveBtn.width / 2 + 29 * this.dpr;\r\n        this.mRepeatMenuContainer.x = this.mSubMenus.x + this.mRepeatBtn.x + this.mRepeatBtn.width / 2 + 29 * this.dpr;\r\n        if (this.mCanPut) {\r\n            this.mOkBtn.clearTint();\r\n        }\r\n        else {\r\n            this.mOkBtn.setTint(0x666666);\r\n        }\r\n        // this.mControllContainer.add([border, this.mTurnBtn, this.mRecycleBtn, this.mConfirmBtn]);\r\n        _super.prototype.init.call(this);\r\n        this.setElement(this.mDisplayObject);\r\n    };\r\n    // protected register() {\r\n    //     if (!this.mInitialized) {\r\n    //         return;\r\n    //     }\r\n    //     this.mCancelBtn.on("pointerup", this.onCancelHandler, this);\r\n    //     this.mOkBtn.on("pointerup", this.onAddHandler, this);\r\n    //     this.mRecycleBtn.on("pointerup", this.onRecycleHandler, this);\r\n    //     this.mTurnBtn.on("pointerup", this.onTurnHandler, this);\r\n    //     this.mMoveBtn.on("pointerup", this.onShowMoveMenuHandler, this);\r\n    //     this.mRepeatBtn.on("pointerup", this.onShowRepeatHandler, this);\r\n    //     this.mExtendBtn.on("pointerup", this.onShowExtendsHandler, this);\r\n    //     this.mMoveMenuContainer.register();\r\n    //     this.mMoveMenuContainer.on("move", this.onMoveHandler, this);\r\n    //     this.mRepeatMenuContainer.register();\r\n    //     this.mRepeatMenuContainer.on("move", this.onRepeatHandler, this);\r\n    //     this.mRepeatMenuContainer.on("hold", this.onHoldRepeatHandler, this);\r\n    //     // this.mTurnBtn.on("pointerup", this.onTurnHandler, this);\r\n    //     // this.mRecycleBtn.on("pointerup", this.onRecycleHandler, this);\r\n    //     // this.mOkBtn.on("pointerup", this.onPutHandler, this);\r\n    // }\r\n    // protected unregister() {\r\n    //     if (!this.mInitialized) {\r\n    //         return;\r\n    //     }\r\n    //     this.mCancelBtn.off("pointerup", this.onCancelHandler, this);\r\n    //     this.mOkBtn.off("pointerup", this.onAddHandler, this);\r\n    //     this.mRecycleBtn.off("pointerup", this.onRecycleHandler, this);\r\n    //     this.mTurnBtn.off("pointerup", this.onTurnHandler, this);\r\n    //     this.mMoveBtn.off("pointerup", this.onShowMoveMenuHandler, this);\r\n    //     this.mRepeatBtn.off("pointerup", this.onShowRepeatHandler, this);\r\n    //     this.mExtendBtn.off("pointerup", this.onShowExtendsHandler, this);\r\n    //     this.mMoveMenuContainer.off("move", this.onMoveHandler, this);\r\n    //     this.mMoveMenuContainer.unRegister();\r\n    //     this.mRepeatMenuContainer.off("move", this.onRepeatHandler, this);\r\n    //     this.mRepeatMenuContainer.off("hold", this.onHoldRepeatHandler, this);\r\n    //     this.mRepeatMenuContainer.unRegister();\r\n    //     // this.mTurnBtn.off("pointerup", this.onTurnHandler, this);\r\n    //     // this.mRecycleBtn.off("pointerup", this.onRecycleHandler, this);\r\n    //     // this.mOkBtn.off("pointerup", this.onPutHandler, this);\r\n    // }\r\n    DecoratePanel.prototype.onLeftUpHandler = function () {\r\n        if (!this.mDisplayObject) {\r\n            return;\r\n        }\r\n        var pos45 = this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());\r\n        pos45.x -= 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onLeftDownHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());\r\n        pos45.y += 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onRightUpHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());\r\n        pos45.y -= 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.onRightDownHandler = function () {\r\n        var pos45 = this.mRoomService.transformToMini45(this.mDisplayObject.getPosition());\r\n        pos45.x = pos45.x + 1;\r\n        this.onMoveElement(pos45);\r\n    };\r\n    DecoratePanel.prototype.getNorthWestPoints = function (count) {\r\n        if (count === void 0) { count = 10; }\r\n        var area = this.mSprite.currentCollisionArea;\r\n        var origin = this.mSprite.currentCollisionPoint;\r\n        var posList = [];\r\n        var pos45 = this.mRoomService.transformToMini45(this.mSprite.pos);\r\n        for (var i = 0; i < count; i++) {\r\n            posList[i] = this.mRoomService.transformToMini90(pos45);\r\n            pos45.x -= area[0].length;\r\n        }\r\n        return this.checkNextPos(posList, area, origin);\r\n    };\r\n    DecoratePanel.prototype.getWestSouthPoints = function (count) {\r\n        if (count === void 0) { count = 10; }\r\n        var area = this.mSprite.currentCollisionArea;\r\n        var origin = this.mSprite.currentCollisionPoint;\r\n        var posList = [];\r\n        var pos45 = this.mRoomService.transformToMini45(this.mSprite.pos);\r\n        for (var i = 0; i < count; i++) {\r\n            posList[i] = this.mRoomService.transformToMini90(pos45);\r\n            pos45.y += area.length;\r\n        }\r\n        return this.checkNextPos(posList, area, origin);\r\n    };\r\n    DecoratePanel.prototype.getSouthEastPoints = function (count) {\r\n        if (count === void 0) { count = 10; }\r\n        var area = this.mSprite.currentCollisionArea;\r\n        var origin = this.mSprite.currentCollisionPoint;\r\n        var posList = [];\r\n        var pos45 = this.mRoomService.transformToMini45(this.mSprite.pos);\r\n        for (var i = 0; i < count; i++) {\r\n            posList[i] = this.mRoomService.transformToMini90(pos45);\r\n            pos45.x += area[0].length;\r\n        }\r\n        return this.checkNextPos(posList, area, origin);\r\n    };\r\n    DecoratePanel.prototype.getEastNorthPoints = function (count) {\r\n        if (count === void 0) { count = 10; }\r\n        var area = this.mSprite.currentCollisionArea;\r\n        var origin = this.mSprite.currentCollisionPoint;\r\n        var posList = [];\r\n        var pos45 = this.mRoomService.transformToMini45(this.mSprite.pos);\r\n        for (var i = 0; i < count; i++) {\r\n            posList[i] = this.mRoomService.transformToMini90(pos45);\r\n            pos45.y -= area.length;\r\n        }\r\n        return this.checkNextPos(posList, area, origin);\r\n    };\r\n    DecoratePanel.prototype.checkNextPos = function (pos45, collisionArea, origin) {\r\n        var result = [];\r\n        for (var _i = 0, pos45_1 = pos45; _i < pos45_1.length; _i++) {\r\n            var pos = pos45_1[_i];\r\n            var nextPos = this.getNextRepeatPos(pos, collisionArea, origin);\r\n            if (nextPos) {\r\n                result.push(nextPos);\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    DecoratePanel.prototype.getNextRepeatPos = function (pos, collisionArea, origin) {\r\n        if (this.mRoomService.canPut(pos, collisionArea, origin)) {\r\n            return pos;\r\n        }\r\n    };\r\n    DecoratePanel.prototype.onMoveElement = function (pos45) {\r\n        if (!this.mDisplayObject) {\r\n            return;\r\n        }\r\n        var position = this.mRoomService.transformToMini90(pos45);\r\n        this.emit("moveElement", position);\r\n    };\r\n    DecoratePanel.prototype.createImage = function (key, frame, x, y) {\r\n        return this.scene.make.image({ key: key, frame: frame, x: x, y: y }, false).setInteractive().setOrigin(0);\r\n    };\r\n    DecoratePanel.prototype.validateGrid = function (val) {\r\n        if (val > this.maxGrid) {\r\n            val = this.maxGrid;\r\n        }\r\n        if (val < this.minGrid) {\r\n            val = this.minGrid;\r\n        }\r\n        return val;\r\n    };\r\n    DecoratePanel.prototype.updateArrowPos = function (ele) {\r\n        var _a;\r\n        if (!ele || !ele.model || !ele.getDisplay()) {\r\n            return;\r\n        }\r\n        // return;\r\n        var display = ele.getDisplay();\r\n        var rows = ele.model.currentCollisionArea.length;\r\n        var cols = ele.model.currentCollisionArea[0].length;\r\n        rows = this.validateGrid(rows);\r\n        cols = this.validateGrid(cols);\r\n        if (ele.getDisplay().scaleX === -1) {\r\n            _a = [cols, rows], rows = _a[0], cols = _a[1];\r\n        }\r\n        var miniSize = this.mRoomService.roomSize;\r\n        var position = {\r\n            rows: rows,\r\n            cols: cols,\r\n            tileWidth: miniSize.tileWidth / 2,\r\n            tileHeight: miniSize.tileHeight / 2,\r\n        };\r\n        // const reference = ele.getElement("reference");\r\n        // if (!reference) {\r\n        //     return;\r\n        // }\r\n        var sprite = ele.model;\r\n        var pos = _utils_position45__WEBPACK_IMPORTED_MODULE_2__["Position45"].transformTo90(new _utils_pos__WEBPACK_IMPORTED_MODULE_1__["Pos"](cols - sprite.currentCollisionPoint.y, rows - sprite.currentCollisionPoint.x), position);\r\n        this.offset.y = pos.y;\r\n        // let pos = Position45.transformTo90(new Pos(cols, (rows / 2)), position);\r\n        // if (this.mArrow5) {\r\n        //     this.mArrow5.x = pos.x + reference.x;\r\n        //     this.mArrow5.y = pos.y + reference.y;\r\n        // }\r\n        // pos = Position45.transformTo90(new Pos((cols / 2), rows), position);\r\n        // if (this.mArrow3) {\r\n        //     this.mArrow3.x = pos.x - this.mArrow3.width + reference.x;\r\n        //     this.mArrow3.y = pos.y + reference.y;\r\n        // }\r\n        // pos = Position45.transformTo90(new Pos(0, (rows / 2)), position);\r\n        // if (this.mArrow1) {\r\n        //     this.mArrow1.x = pos.x - this.mArrow1.width + reference.x;\r\n        //     this.mArrow1.y = pos.y - this.mArrow1.height + reference.y;\r\n        // }\r\n        // pos = Position45.transformTo90(new Pos((cols / 2), 0), position);\r\n        // if (this.mArrow7) {\r\n        //     this.mArrow7.x = pos.x + reference.x;\r\n        //     this.mArrow7.y = pos.y - this.mArrow7.height + reference.y;\r\n        // }\r\n    };\r\n    DecoratePanel.prototype.onTurnHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].TURN_ELEMENT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onRecycleHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].RECYCLE_ELEMENT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onCancelHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].CANCEL_PUT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onAddHandler = function () {\r\n        if (this.mCanPut) {\r\n            this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].PUT_ELEMENT, this.mDisplayObject);\r\n        }\r\n    };\r\n    DecoratePanel.prototype.onMoveHandler = function (dir) {\r\n        if (typeof dir !== "number") {\r\n            return;\r\n        }\r\n        switch (dir) {\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].north_west:\r\n                this.onLeftUpHandler();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].west_south:\r\n                this.onLeftDownHandler();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].south_east:\r\n                this.onRightDownHandler();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].east_north:\r\n                this.onRightUpHandler();\r\n                break;\r\n        }\r\n    };\r\n    DecoratePanel.prototype.onPutHandler = function () {\r\n        this.mWorld.emitter.emit(_const_MessageType__WEBPACK_IMPORTED_MODULE_3__["MessageType"].PUT_ELEMENT, this.mDisplayObject);\r\n    };\r\n    DecoratePanel.prototype.onRepeatHandler = function (dir) {\r\n        var result = null;\r\n        switch (dir) {\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].north_west:\r\n                result = this.getNorthWestPoints(2);\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].west_south:\r\n                result = this.getWestSouthPoints(2);\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].south_east:\r\n                result = this.getSouthEastPoints(2);\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].east_north:\r\n                result = this.getEastNorthPoints(2);\r\n                break;\r\n        }\r\n        this.onSendAddSingleSprite(result);\r\n    };\r\n    DecoratePanel.prototype.onHoldRepeatHandler = function (dir) {\r\n        var result = null;\r\n        switch (dir) {\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].north_west:\r\n                result = this.getNorthWestPoints();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].west_south:\r\n                result = this.getWestSouthPoints();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].south_east:\r\n                result = this.getSouthEastPoints();\r\n                break;\r\n            case _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].east_north:\r\n                result = this.getEastNorthPoints();\r\n                break;\r\n        }\r\n        this.onSendAddSprites(result);\r\n    };\r\n    DecoratePanel.prototype.onShowMoveMenuHandler = function () {\r\n        this.add(this.mMoveMenuContainer);\r\n        this.remove(this.mRepeatMenuContainer);\r\n    };\r\n    DecoratePanel.prototype.onShowRepeatHandler = function () {\r\n        this.add(this.mRepeatMenuContainer);\r\n        this.remove(this.mMoveMenuContainer);\r\n    };\r\n    DecoratePanel.prototype.onShowExtendsHandler = function () {\r\n        // this.mRoomService.canPut()\r\n        // this.mDisplayObject.\r\n    };\r\n    DecoratePanel.prototype.onSendAddSprites = function (points) {\r\n        if (points.length > 1) {\r\n            this.emit("addSprite", this.mSprite, points);\r\n        }\r\n    };\r\n    DecoratePanel.prototype.onSendAddSingleSprite = function (points) {\r\n        if (points.length > 1) {\r\n            this.emit("addSingleSprite", this.mSprite, points);\r\n        }\r\n    };\r\n    return DecoratePanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar MoveMenu = /** @class */ (function (_super) {\r\n    __extends(MoveMenu, _super);\r\n    function MoveMenu(scene, key, dpr, uiScale) {\r\n        if (dpr === void 0) { dpr = 1; }\r\n        if (uiScale === void 0) { uiScale = 1; }\r\n        var _this = _super.call(this, scene) || this;\r\n        var bg = scene.make.image({\r\n            key: key,\r\n            frame: "bg.png"\r\n        }, false);\r\n        _this.setSize(bg.displayWidth, bg.displayHeight);\r\n        // this.mArrow1 = scene.make.image({\r\n        //     key,\r\n        //     frame: "arrow_1.png"\r\n        // }, false).setInteractive().setData("dir", 1);\r\n        // this.mArrow3 = scene.make.image({\r\n        //     key,\r\n        //     frame: "arrow_3.png"\r\n        // }, false).setInteractive().setData("dir", 3);\r\n        // this.mArrow5 = scene.make.image({\r\n        //     key,\r\n        //     frame: "arrow_5.png"\r\n        // }, false).setInteractive().setData("dir", 5);\r\n        // this.mArrow7 = scene.make.image({\r\n        //     key,\r\n        //     frame: "arrow_7.png"\r\n        // }, false).setInteractive().setData("dir", 7);\r\n        _this.mArrow1 = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__["Button"](_this.scene, key, "arrow_1.png");\r\n        _this.mArrow1.setData("dir", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].north_west);\r\n        _this.mArrow3 = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__["Button"](_this.scene, key, "arrow_3.png");\r\n        _this.mArrow3.setData("dir", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].west_south);\r\n        _this.mArrow5 = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__["Button"](_this.scene, key, "arrow_5.png");\r\n        _this.mArrow5.setData("dir", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].south_east);\r\n        _this.mArrow7 = new _lib_rexui_lib_ui_button_Button__WEBPACK_IMPORTED_MODULE_5__["Button"](_this.scene, key, "arrow_7.png");\r\n        _this.mArrow7.setData("dir", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].east_north);\r\n        _this.mBtns = [_this.mArrow1, _this.mArrow3, _this.mArrow5, _this.mArrow7];\r\n        _this.add(bg);\r\n        _this.add(_this.mBtns);\r\n        var w = _this.width;\r\n        var totalWidth = _this.width - 20 * dpr;\r\n        _this.mBtns.map(function (btn) { return totalWidth -= btn.displayWidth; });\r\n        var space = totalWidth = totalWidth / (_this.mBtns.length - 1);\r\n        var arrowH = (3 * dpr);\r\n        for (var i = 0; i < _this.mBtns.length; i++) {\r\n            if (i === 0) {\r\n                _this.mBtns[i].x = 10 * dpr + _this.mBtns[i].width / 2 - _this.width / 2;\r\n            }\r\n            else {\r\n                _this.mBtns[i].x = space + _this.mBtns[i - 1].x + _this.mBtns[i - 1].width;\r\n            }\r\n            _this.mBtns[i].y = arrowH;\r\n        }\r\n        _this.setInteractive();\r\n        return _this;\r\n    }\r\n    MoveMenu.prototype.register = function () {\r\n        // for (const btn of this.mBtns) {\r\n        //     btn.on("pointerup", this.onArrowHandler, this);\r\n        // }\r\n        this.mArrow1.on("Hold", this.onHoldHandler, this);\r\n        this.mArrow1.on("Tap", this.onClickHandler, this);\r\n        this.mArrow3.on("Hold", this.onHoldHandler, this);\r\n        this.mArrow3.on("Tap", this.onClickHandler, this);\r\n        this.mArrow5.on("Hold", this.onHoldHandler, this);\r\n        this.mArrow5.on("Tap", this.onClickHandler, this);\r\n        this.mArrow7.on("Hold", this.onHoldHandler, this);\r\n        this.mArrow7.on("Tap", this.onClickHandler, this);\r\n        // this.mArrow1.on("pointerup", this.onArrow1Handler, this);\r\n        // this.mArrow3.on("pointerup", this.onArrow3Handler, this);\r\n        // this.mArrow5.on("pointerup", this.onArrow5Handler, this);\r\n        // this.mArrow7.on("pointerup", this.onArrow7Handler, this);\r\n    };\r\n    MoveMenu.prototype.unRegister = function () {\r\n        this.mArrow1.off("Hold", this.onHoldHandler, this);\r\n        this.mArrow1.off("Tap", this.onClickHandler, this);\r\n        this.mArrow3.off("Hold", this.onHoldHandler, this);\r\n        this.mArrow3.off("Tap", this.onClickHandler, this);\r\n        this.mArrow5.off("Hold", this.onHoldHandler, this);\r\n        this.mArrow5.off("Tap", this.onClickHandler, this);\r\n        this.mArrow7.off("Hold", this.onHoldHandler, this);\r\n        this.mArrow7.off("Tap", this.onClickHandler, this);\r\n        // this.mArrow1.off("pointerup", this.onArrow1Handler, this);\r\n        // this.mArrow3.off("pointerup", this.onArrow3Handler, this);\r\n        // this.mArrow5.off("pointerup", this.onArrow5Handler, this);\r\n        // this.mArrow7.off("pointerup", this.onArrow7Handler, this);\r\n    };\r\n    MoveMenu.prototype.onArrow1Handler = function (pointer) {\r\n        this.emit("move", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].north_west);\r\n    };\r\n    MoveMenu.prototype.onArrow3Handler = function () {\r\n        this.emit("move", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].west_south);\r\n    };\r\n    MoveMenu.prototype.onArrow5Handler = function () {\r\n        this.emit("move", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].south_east);\r\n    };\r\n    MoveMenu.prototype.onArrow7Handler = function () {\r\n        this.emit("move", _rooms_element_element__WEBPACK_IMPORTED_MODULE_4__["Direction"].east_north);\r\n    };\r\n    MoveMenu.prototype.onHoldHandler = function (gameobject) {\r\n        this.emit("hold", gameobject.getData("dir"));\r\n    };\r\n    MoveMenu.prototype.onClickHandler = function (pointer, gameobject) {\r\n        this.emit("move", gameobject.getData("dir"));\r\n    };\r\n    return MoveMenu;\r\n}(Phaser.GameObjects.Container));\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/decorate/decorate.panel.ts?')},"./src/ui/friend/friend.mediator.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendMediator", function() { return FriendMediator; });\n/* harmony import */ var _friend_panel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./friend.panel */ "./src/ui/friend/friend.panel.ts");\n/* harmony import */ var _lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/baseUI/BaseMediator */ "./lib/rexui/lib/ui/baseUI/BaseMediator.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar FriendMediator = /** @class */ (function (_super) {\r\n    __extends(FriendMediator, _super);\r\n    function FriendMediator(scene, world) {\r\n        var _this = _super.call(this) || this;\r\n        _this.mUIType = _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_2__["UIType"].Normal;\r\n        _this.mScene = scene;\r\n        _this.world = world;\r\n        return _this;\r\n    }\r\n    FriendMediator.prototype.isShow = function () {\r\n        if (!this.mView)\r\n            return false;\r\n        return this.mView.isShow();\r\n    };\r\n    FriendMediator.prototype.isSceneUI = function () {\r\n        return false;\r\n    };\r\n    FriendMediator.prototype.resize = function () {\r\n        if (this.mView)\r\n            return this.mView.resize();\r\n    };\r\n    FriendMediator.prototype.show = function (param) {\r\n        var friendMed = this;\r\n        if (this.mView && this.isShow()) {\r\n            return;\r\n        }\r\n        this.mView = new _friend_panel__WEBPACK_IMPORTED_MODULE_0__["FriendPanel"](this.mScene, this.world);\r\n        this.mView.show(param);\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    FriendMediator.prototype.hide = function () {\r\n        this.mShow = false;\r\n        if (this.mView)\r\n            this.mView = null;\r\n    };\r\n    FriendMediator.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FriendMediator.NAME = "FriendMediator";\r\n    return FriendMediator;\r\n}(_lib_rexui_lib_ui_baseUI_BaseMediator__WEBPACK_IMPORTED_MODULE_1__["BaseMediator"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/friend/friend.mediator.ts?')},"./src/ui/friend/friend.panel.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendPanel", function() { return FriendPanel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FriendItem", function() { return FriendItem; });\n/* harmony import */ var _components_BasePanel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/BasePanel */ "./src/ui/components/BasePanel.ts");\n/* harmony import */ var _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/resUtil */ "./src/utils/resUtil.ts");\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _components_dynamic_image__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/dynamic.image */ "./src/ui/components/dynamic.image.ts");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! phaser */ "./node_modules/phaser/dist/phaser.js-exposed");\n/* harmony import */ var phaser__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../baseView/icon.btn */ "./src/ui/baseView/icon.btn.ts");\n/* harmony import */ var _friend_mediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./friend.mediator */ "./src/ui/friend/friend.mediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar FriendPanel = /** @class */ (function (_super) {\r\n    __extends(FriendPanel, _super);\r\n    function FriendPanel(scene, world) {\r\n        var _this = _super.call(this, scene, world) || this;\r\n        _this.mIndex = 0;\r\n        return _this;\r\n    }\r\n    FriendPanel.prototype.resize = function (wid, hei) {\r\n        var size = this.mWorld.getSize();\r\n        if (!this.mShow)\r\n            return;\r\n        if (this.mWorld.game.device.os.desktop) {\r\n            this.x = size.width + wid >> 1;\r\n            this.y = size.height + hei >> 1;\r\n        }\r\n        else {\r\n            if (this.mWorld.game.scale.orientation === Phaser.Scale.Orientation.LANDSCAPE) {\r\n                this.mBg.resize((size.width * .5 - 20) / this.mWorld.uiScale, (size.height - 20) / this.mWorld.uiScale);\r\n                // new NinePatch(this.scene, 0, 0, size.width * .6 / this.mWorld.uiScale - 30, size.height / this.mWorld.uiScale - 30, Border.getName(), null, Border.getConfig());\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n                this.x = (this.width / 2 + 10) * this.mWorld.uiScale;\r\n                this.y = (this.height / 2 + 10) * this.mWorld.uiScale;\r\n            }\r\n            else {\r\n                this.mBg.resize((size.width - 20) / this.mWorld.uiScale, (size.height * .5 - 20) / this.mWorld.uiScale);\r\n                // = new NinePatch(this.scene, 0, 0, size.width / this.mWorld.uiScale - 30, size.height / this.mWorld.uiScale - 30, Border.getName(), null, Border.getConfig());\r\n                this.setSize(this.mBg.width, this.mBg.height);\r\n                this.x = (this.width / 2 + 15) * this.mWorld.uiScale;\r\n                this.y = size.height - this.mBg.height * .5 * this.mWorld.uiScale - 10;\r\n            }\r\n        }\r\n        this.scale = this.mWorld.uiScale;\r\n        this.mUpBtn.y = (this.mUpBtn.height / 2 - this.mBg.height) / 2;\r\n        this.mDownBtn.y = (this.mBg.height - this.mDownBtn.height / 2) / 2;\r\n        this.mTitleTxt.x = (-this.mBg.width / 2 + 15);\r\n        this.mTitleTxt.y = (-this.mBg.height / 2 + 8);\r\n        if (this.mClsBtn) {\r\n            this.mClsBtn.x = (this.mBg.width >> 1) - 65;\r\n            this.mClsBtn.y = (-this.mBg.height >> 1);\r\n        }\r\n        this.initFriendItem();\r\n        this.addAt(this.mBg, 0);\r\n        this.add(this.mTitleTxt);\r\n    };\r\n    FriendPanel.prototype.addListen = function () {\r\n        _super.prototype.addListen.call(this);\r\n        this.mDownBtn.on("pointerup", this.downHandler, this);\r\n        this.mUpBtn.on("pointerup", this.upHandler, this);\r\n        this.mClsBtn.on("pointerup", this.hide, this);\r\n    };\r\n    FriendPanel.prototype.removeListen = function () {\r\n        _super.prototype.removeListen.call(this);\r\n        this.mDownBtn.off("pointerup", this.downHandler, this);\r\n        this.mUpBtn.off("pointerup", this.upHandler, this);\r\n        this.mClsBtn.off("pointerup", this.hide, this);\r\n    };\r\n    FriendPanel.prototype.show = function (param) {\r\n        var size = this.mWorld.getSize();\r\n        this.mShowData = param;\r\n        if (!this.mInitialized) {\r\n            this.preload();\r\n            return;\r\n        }\r\n        _super.prototype.show.call(this, param);\r\n    };\r\n    FriendPanel.prototype.destroy = function () {\r\n        // if (this.mBg) this.mBg.destroy(true);\r\n        // if (this.mTitleTxt) this.mTitleTxt.destroy(true);\r\n        // if (this.mUpBtn) this.mUpBtn.destroy(true);\r\n        // if (this.mDownBtn) this.mDownBtn.destroy(true);\r\n        if (this.mFriendList) {\r\n            this.mFriendList.forEach(function (item) {\r\n                if (item) {\r\n                    item.destory();\r\n                    item = null;\r\n                }\r\n            });\r\n        }\r\n        // this.mIndex = 0;\r\n        // this.mBg = null;\r\n        // this.mTitleTxt = null;\r\n        // this.mUpBtn = null;\r\n        // this.mDownBtn = null;\r\n        // this.mFriendList = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    FriendPanel.prototype.friendChat = function (id) {\r\n    };\r\n    FriendPanel.prototype.friendGo = function (gameId) {\r\n    };\r\n    FriendPanel.prototype.btnScaleHandler = function (gameObject, scaleX) {\r\n        if (scaleX === void 0) { scaleX = 1; }\r\n        this.mScene.tweens.add({\r\n            targets: gameObject,\r\n            duration: 50,\r\n            ease: "Linear",\r\n            props: {\r\n                scaleX: { value: .5 * scaleX },\r\n                scaleY: { value: .5 },\r\n            },\r\n            yoyo: true,\r\n            repeat: 0,\r\n        });\r\n        gameObject.scaleX = scaleX;\r\n        gameObject.scaleY = 1;\r\n    };\r\n    FriendPanel.prototype.hide = function () {\r\n        this.mWorld.uiManager.baseFaceTween(true);\r\n        _super.prototype.hide.call(this);\r\n    };\r\n    FriendPanel.prototype.preload = function () {\r\n        if (!this.mScene) {\r\n            return;\r\n        }\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getPNG());\r\n        this.mScene.load.image(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getPNG());\r\n        this.mScene.load.atlas("clsBtn", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/common/common_clsBtn.json"));\r\n        this.scene.load.image("friendChat", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/friend/friend_chat.png"));\r\n        this.scene.load.image("friendGo", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/friend/friend_go.png"));\r\n        this.mScene.load.atlas("bagView", _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.png"), _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getRes("ui/bag/bagView.json"));\r\n        _super.prototype.preload.call(this);\r\n    };\r\n    FriendPanel.prototype.init = function () {\r\n        this.mWorld.uiManager.getUILayerManager().addToToolTipsLayer(this);\r\n        var size = this.mWorld.getSize();\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 600 / this.mWorld.uiScale, size.height * .5 * this.mWorld.uiScale, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        // this.addAt(this.mBg, 0);\r\n        this.mTitleTxt = this.mScene.make.text(undefined, false);\r\n        this.mTitleTxt.setFontFamily("YaHei");\r\n        this.mTitleTxt.setFontStyle("bold");\r\n        this.mTitleTxt.setFontSize(14);\r\n        this.mTitleTxt.style.align = "left";\r\n        this.mTitleTxt.setText("好友列表");\r\n        // this.add(this.mTitleTxt);\r\n        this.mUpBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mUpBtn.setTexture("bagView", "bagView_tab.png");\r\n        this.mUpBtn.rotation = Math.PI / 2;\r\n        this.mDownBtn = this.mScene.make.sprite(undefined, false);\r\n        this.mDownBtn.setTexture("bagView", "bagView_tab.png");\r\n        this.mDownBtn.rotation = -Math.PI / 2;\r\n        this.mDownBtn.setInteractive();\r\n        this.mUpBtn.setInteractive();\r\n        var image = this.scene.make.image(undefined, false);\r\n        image.setTexture(this.mWorld.roomManager.currentRoom.playerManager.actor.getDisplay().mDisplayInfo.id + "");\r\n        this.add(image);\r\n        this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this.scene, 0, 0, 500, 350, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Background"].getConfig());\r\n        this.addAt(this.mBg, 0);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.initFriendItem();\r\n        this.mClsBtn = new _baseView_icon_btn__WEBPACK_IMPORTED_MODULE_6__["IconBtn"](this.mScene, this.mWorld, {\r\n            key: _ui_mediatorType__WEBPACK_IMPORTED_MODULE_8__["UIMediatorType"].Close_Btn, bgResKey: "clsBtn", bgTextures: ["btn_normal", "btn_over", "btn_click"],\r\n            iconResKey: "", iconTexture: "", scale: 1, pngUrl: "ui/common/common_clsBtn.png", jsonUrl: "ui/common/common_clsBtn.json"\r\n        });\r\n        this.mClsBtn.x = (this.mWidth >> 1) - 65;\r\n        this.mClsBtn.y = -this.mHeight >> 1;\r\n        this.mClsBtn.scaleX = this.mClsBtn.scaleY = 2;\r\n        this.add(this.mClsBtn);\r\n        _super.prototype.init.call(this);\r\n    };\r\n    FriendPanel.prototype.tweenComplete = function (show) {\r\n        var _this = this;\r\n        _super.prototype.tweenComplete.call(this, show);\r\n        this.mWorld.roomManager.currentRoom.playerManager.actor.getFriend().requestFriend(function (data) {\r\n            _this.setDataList(data);\r\n        });\r\n        if (show)\r\n            this.mWorld.uiManager.getMediator(_friend_mediator__WEBPACK_IMPORTED_MODULE_7__["FriendMediator"].NAME).resize();\r\n    };\r\n    FriendPanel.prototype.downHandler = function () {\r\n        this.btnScaleHandler(this.mDownBtn);\r\n        var len = this.mFriendDataList ? this.mFriendDataList.length : 0;\r\n        var pageNum = Math.floor(len / FriendPanel.count);\r\n        this.mIndex = this.mIndex + 1 > pageNum ? pageNum : this.mIndex + 1;\r\n        this.refreshDataList();\r\n    };\r\n    FriendPanel.prototype.upHandler = function () {\r\n        this.btnScaleHandler(this.mUpBtn);\r\n        this.mIndex = this.mIndex - 1 > 0 ? this.mIndex - 1 : 0;\r\n        this.refreshDataList();\r\n    };\r\n    FriendPanel.prototype.setDataList = function (data) {\r\n        if (!this.mFriendList)\r\n            return;\r\n        this.mFriendDataList = data;\r\n        var len = data.length > FriendPanel.count ? FriendPanel.count : data.length;\r\n        for (var i = 0; i < 4; i++) {\r\n            var item = this.mFriendList[i];\r\n            var dat = data[this.mIndex * FriendPanel.count + i];\r\n            if (!dat) {\r\n                item.visible = false;\r\n                // this.add(item);\r\n                continue;\r\n            }\r\n            item.visible = true;\r\n            dat.index = i;\r\n            // item.dataChange(dat);\r\n            // this.add(item);\r\n        }\r\n        this.add(this.mUpBtn);\r\n        this.add(this.mDownBtn);\r\n    };\r\n    FriendPanel.prototype.refreshDataList = function () {\r\n        // if (!this.mFriendDataList || !this.mFriendList) return;\r\n        // const len: number = this.mFriendDataList.length > FriendPanel.count ? FriendPanel.count : this.mFriendDataList.length;\r\n        // for (let i: number = 0; i < len; i++) {\r\n        //     const item: FriendItem = this.mFriendList[i];\r\n        //     let dat = this.mFriendDataList[this.mIndex * FriendPanel.count + i];\r\n        //     if (!dat) dat = {};\r\n        //     dat.index = i;\r\n        //     item.dataChange(dat);\r\n        // }\r\n    };\r\n    FriendPanel.prototype.initFriendItem = function () {\r\n        var len = this.mFriendList ? this.mFriendList.length : FriendPanel.count;\r\n        if (this.mFriendList && this.mFriendList.length > 0) {\r\n            for (var i = 0; i < len; i++) {\r\n                var item = this.mFriendList[i];\r\n                item.resize();\r\n                item.y = this.mWorld.game.device.os.desktop ? (-this.mBg.height / 2 + this.mTitleTxt.height + i * (item.height + 10) + (item.height / 2 + 10)) * this.mWorld.uiScale :\r\n                    (i - 1.5) * (item.height + 10);\r\n            }\r\n        }\r\n        else {\r\n            this.mFriendList = [];\r\n            var resList = [{\r\n                    res: "friendChat",\r\n                    name: "聊天"\r\n                }, {\r\n                    res: "friendGo",\r\n                    name: "跟随"\r\n                }];\r\n            for (var i = 0; i < len; i++) {\r\n                var item = new FriendItem(this.mWorld, this.mScene, this, resList);\r\n                item.y = this.mWorld.game.device.os.desktop ? (-this.mBg.height / 2 + this.mTitleTxt.height + i * (item.height + 10) + (item.height / 2 + 10)) * this.mWorld.uiScale :\r\n                    (i - 1.5) * (item.height + 10);\r\n                this.mFriendList.push(item);\r\n            }\r\n        }\r\n    };\r\n    FriendPanel.count = 4;\r\n    return FriendPanel;\r\n}(_components_BasePanel__WEBPACK_IMPORTED_MODULE_0__["BasePanel"]));\r\n\r\nvar FriendItem = /** @class */ (function (_super) {\r\n    __extends(FriendItem, _super);\r\n    function FriendItem(world, scene, panel, iconResList) {\r\n        var _this = _super.call(this, scene) || this;\r\n        _this.iconResList = [];\r\n        _this.mPanel = panel;\r\n        _this.mWorld = world;\r\n        _this.mScene = scene;\r\n        var size = _this.mWorld.getSize();\r\n        _this.mBg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](_this.mScene, 0, 0, _this.mPanel.width, 90, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n        _this.addAt(_this.mBg, 0);\r\n        _this.setSize(_this.mBg.width, _this.mBg.height);\r\n        _this.mRoleIcon = new _components_dynamic_image__WEBPACK_IMPORTED_MODULE_4__["DynamicImage"](_this.mScene, -_this.mBg.width / 2, 0);\r\n        _this.nameTF = _this.mScene.make.text({\r\n            align: "left",\r\n            style: { font: _utils_font__WEBPACK_IMPORTED_MODULE_3__["Font"].YAHEI_20_BOLD, fill: "#FFCC00" }\r\n        }, false);\r\n        _this.statusTF = _this.mScene.make.text({\r\n            align: "left",\r\n            style: { font: "14px YaHei" }\r\n        }, false);\r\n        if (iconResList) {\r\n            var len = iconResList.length;\r\n            var _loop_1 = function (i) {\r\n                var icon = this_1.mScene.make.image(undefined, false);\r\n                var iconCon = this_1.mScene.make.container(undefined, false);\r\n                var bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_2__["NinePatch"](this_1.mScene, 0, 0, 60, 60, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getName(), null, _utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Border"].getConfig());\r\n                var txt = this_1.mScene.make.text(undefined, false);\r\n                var friendIconData = iconResList[i];\r\n                txt.setText(friendIconData.name);\r\n                icon.setTexture(friendIconData.res);\r\n                icon.scaleX = icon.scaleY = .8;\r\n                iconCon.add(icon);\r\n                iconCon.add(txt);\r\n                iconCon.addAt(bg, 0);\r\n                iconCon.setSize(60, 60);\r\n                iconCon.setInteractive(new phaser__WEBPACK_IMPORTED_MODULE_5__["Geom"].Rectangle(0, 0, 60, 60), Phaser.Geom.Rectangle.Contains);\r\n                iconCon.on("pointerdown", function () {\r\n                    _this.mPanel.btnScaleHandler(iconCon);\r\n                }, this_1);\r\n                icon.y = -bg.height / 2 + icon.height / 2;\r\n                txt.x = -txt.width >> 1;\r\n                txt.y = iconCon.height / 2 - txt.height - 4;\r\n                // iconCon.x = this.width / 2 - (i + 1) * 70 - 20;\r\n                this_1.add(iconCon);\r\n                this_1.iconResList.push(iconCon);\r\n            };\r\n            var this_1 = this;\r\n            for (var i = 0; i < len; i++) {\r\n                _loop_1(i);\r\n            }\r\n        }\r\n        _this.add(_this.mRoleIcon);\r\n        _this.add(_this.nameTF);\r\n        _this.add(_this.statusTF);\r\n        _this.refreshUIPos();\r\n        return _this;\r\n    }\r\n    FriendItem.prototype.resize = function () {\r\n        if (this.mWorld.game.device.os.desktop)\r\n            return;\r\n        this.mBg.resize(this.mPanel.width * .95, 90);\r\n        this.setSize(this.mBg.width, this.mBg.height);\r\n        this.addAt(this.mBg, 0);\r\n        this.refreshUIPos();\r\n    };\r\n    FriendItem.prototype.getView = function () {\r\n        return this;\r\n    };\r\n    FriendItem.prototype.dataChange = function (data) {\r\n        var _this = this;\r\n        var lv = data.level || 0;\r\n        var id = data.id || "1";\r\n        var name = data.nickname || "test";\r\n        this.nameTF.setText(name);\r\n        this.mRoleIcon.load(_utils_resUtil__WEBPACK_IMPORTED_MODULE_1__["Url"].getOsdRes(data.avatar || "1"), this, function () {\r\n            _this.mRoleIcon.scaleX = _this.height / _this.mRoleIcon.width;\r\n            _this.mRoleIcon.scaleY = _this.height / _this.mRoleIcon.height;\r\n        }, function () {\r\n            _this.mRoleIcon.scaleX = _this.mRoleIcon.scaleY = 1;\r\n        });\r\n        this.mRoleIcon.x = -this.width / 2 + 64;\r\n        this.nameTF.x = this.mRoleIcon.x + 54;\r\n        this.index = data.index;\r\n    };\r\n    FriendItem.prototype.destory = function () {\r\n        this.index = 0;\r\n        if (this.nameTF) {\r\n            this.nameTF.destroy(true);\r\n        }\r\n        if (this.statusTF) {\r\n            this.statusTF.destroy(true);\r\n        }\r\n        if (this.mRoleIcon) {\r\n            this.mRoleIcon.destroy(true);\r\n        }\r\n        this.nameTF = null;\r\n        this.statusTF = null;\r\n        this.mPanel = null;\r\n        this.mWorld = null;\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    FriendItem.prototype.refreshUIPos = function () {\r\n        this.mRoleIcon.x = -this.width / 2 + 64;\r\n        this.nameTF.x = this.mRoleIcon.x + 54;\r\n        this.mRoleIcon.y = 0;\r\n        this.nameTF.y = 10 - this.mBg.height / 2;\r\n        this.statusTF.x = this.nameTF.x;\r\n        if (this.iconResList) {\r\n            var len = this.iconResList.length;\r\n            for (var i = 0; i < len; i++) {\r\n                var iconCon = this.iconResList[i];\r\n                iconCon.x = this.width / 2 - (i + 1) * 70 + 20;\r\n            }\r\n        }\r\n    };\r\n    return FriendItem;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/friend/friend.panel.ts?')},"./src/ui/layer.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayerManager", function() { return LayerManager; });\nvar LayerManager = /** @class */ (function () {\r\n    function LayerManager() {\r\n    }\r\n    LayerManager.prototype.setScene = function (scene) {\r\n        if (!scene)\r\n            return;\r\n        this.destroy();\r\n        this.mScene = scene;\r\n        // const view = scene.cameras.main;\r\n        // this.mInteractive = scene.add.container(view.width >> 1, view.height >> 1);\r\n        // this.mInteractive.setSize(view.width, view.height);\r\n        // const rect = scene.add.graphics();\r\n        // rect.lineStyle(1, 0, 1);\r\n        // rect.fillRect(0, 0, view.width, view.height);\r\n        // this.mInteractive.setInteractive();\r\n        this.mUILayer = scene.add.container(0, 0);\r\n        this.mDialogLayer = scene.add.container(0, 0);\r\n        this.mToolTipsLyaer = scene.add.container(0, 0);\r\n    };\r\n    LayerManager.prototype.addToUILayer = function (obj, index) {\r\n        if (index === void 0) { index = -1; }\r\n        if (!this.mUILayer) {\r\n            return;\r\n        }\r\n        if (index === -1 || index === undefined) {\r\n            this.mUILayer.add(obj);\r\n        }\r\n        else {\r\n            this.mUILayer.addAt(obj, index);\r\n        }\r\n    };\r\n    LayerManager.prototype.addToDialogLayer = function (obj) {\r\n        if (!this.mDialogLayer) {\r\n            return;\r\n        }\r\n        this.mDialogLayer.add(obj);\r\n    };\r\n    LayerManager.prototype.addToToolTipsLayer = function (obj) {\r\n        if (!this.mToolTipsLyaer) {\r\n            return;\r\n        }\r\n        this.mToolTipsLyaer.add(obj);\r\n    };\r\n    LayerManager.prototype.removeToUILayer = function (obj) {\r\n        this.mUILayer.remove(obj);\r\n    };\r\n    LayerManager.prototype.removeToDialogLayer = function (obj) {\r\n        this.mDialogLayer.remove(obj);\r\n    };\r\n    LayerManager.prototype.removeToToolTipsLayer = function (obj) {\r\n        this.mToolTipsLyaer.remove(obj);\r\n    };\r\n    LayerManager.prototype.destroy = function () {\r\n        if (this.mUILayer) {\r\n            this.mUILayer.destroy();\r\n            this.mUILayer = null;\r\n        }\r\n        if (this.mDialogLayer) {\r\n            this.mDialogLayer.destroy();\r\n            this.mDialogLayer = null;\r\n        }\r\n        if (this.mToolTipsLyaer) {\r\n            this.mToolTipsLyaer.destroy();\r\n            this.mToolTipsLyaer = null;\r\n        }\r\n    };\r\n    Object.defineProperty(LayerManager.prototype, "interactive", {\r\n        get: function () {\r\n            return this.mInteractive;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LayerManager.prototype, "scene", {\r\n        get: function () {\r\n            return this.mScene;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return LayerManager;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/layer.manager.ts?')},"./src/ui/loadview.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingView", function() { return LoadingView; });\nvar LoadingView = /** @class */ (function () {\r\n    function LoadingView(mScene) {\r\n        this.mScene = mScene;\r\n        this.mShowing = false;\r\n        this.createPanel();\r\n    }\r\n    LoadingView.prototype.setFollow = function (gameObject, fromScene, callBack) {\r\n    };\r\n    LoadingView.prototype.isShow = function () {\r\n        return this.mShowing;\r\n    };\r\n    LoadingView.prototype.show = function (param) {\r\n        this.mTween = this.mScene.tweens.add({\r\n            targets: this.mBg,\r\n            duration: 2000000,\r\n            ease: "Linear",\r\n            props: {\r\n                rotation: 360,\r\n            }\r\n        });\r\n    };\r\n    LoadingView.prototype.update = function (param) {\r\n    };\r\n    LoadingView.prototype.hide = function () {\r\n        if (this.mTween) {\r\n            this.mTween.stop();\r\n            this.mTween.remove();\r\n            // this.mTween = null;\r\n        }\r\n    };\r\n    LoadingView.prototype.tweenExpand = function (show) {\r\n    };\r\n    LoadingView.prototype.resize = function () {\r\n    };\r\n    LoadingView.prototype.destroy = function () {\r\n        if (this.mBg) {\r\n            this.mBg.destroy();\r\n        }\r\n    };\r\n    LoadingView.prototype.createPanel = function () {\r\n        var size = this.mScene.game.scale.gameSize;\r\n        this.mBg = this.mScene.add.sprite(size.width >> 1, size.height >> 1, "stars");\r\n        this.mBg.scaleX = this.mBg.scaleY = 1.3;\r\n    };\r\n    return LoadingView;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/loadview.ts?')},"./src/ui/tips/TextToolTip.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextToolTips", function() { return TextToolTips; });\n/* harmony import */ var _components_nine_patch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../components/nine.patch */ "./src/ui/components/nine.patch.ts");\n/* harmony import */ var _utils_font__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/font */ "./src/utils/font.ts");\n/* harmony import */ var _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/rexui/lib/ui/ui-components */ "./lib/rexui/lib/ui/ui-components.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\nvar TextToolTips = /** @class */ (function (_super) {\r\n    __extends(TextToolTips, _super);\r\n    function TextToolTips(scene, key, frame, dpr, zoom) {\r\n        var _this = _super.call(this, scene) || this;\r\n        var tempframe = scene.textures.getFrame(key, frame);\r\n        var tipsWidth = tempframe.width;\r\n        var tipsHeight = tempframe.height;\r\n        _this.dpr = dpr;\r\n        _this.bg = new _components_nine_patch__WEBPACK_IMPORTED_MODULE_0__["NinePatch"](_this.scene, 0, 0, tipsWidth, tipsHeight, key, frame, {\r\n            left: 20 * dpr,\r\n            top: 20 * dpr,\r\n            right: 20 * dpr,\r\n            bottom: 20 * dpr\r\n        });\r\n        _this.text = new _lib_rexui_lib_ui_ui_components__WEBPACK_IMPORTED_MODULE_2__["BBCodeText"](_this.scene, 0, 0, "蓝矿石", {\r\n            color: "#333333",\r\n            fontSize: 13 * _this.dpr,\r\n            fontFamily: _utils_font__WEBPACK_IMPORTED_MODULE_1__["Font"].DEFULT_FONT,\r\n            wrap: {\r\n                width: 90 * _this.dpr,\r\n                mode: "string"\r\n            }\r\n        }).setOrigin(0);\r\n        _this.add([_this.bg, _this.text]);\r\n        _this.setSize(tipsWidth + 20 * dpr, tipsHeight + 20 * dpr);\r\n        return _this;\r\n    }\r\n    TextToolTips.prototype.setSize = function (width, height) {\r\n        _super.prototype.setSize.call(this, width, height);\r\n        this.bg.resize(width, height);\r\n        this.bg.setPosition(0, 0);\r\n        var textWidth = width - 16 * this.dpr;\r\n        var textHeight = height - 16 * this.dpr;\r\n        this.text.setSize(textWidth, textHeight);\r\n        this.text.setWrapWidth(textWidth);\r\n        this.text.setPosition(-textWidth * 0.5, -textHeight * 0.5);\r\n        return this;\r\n    };\r\n    TextToolTips.prototype.setText = function (text) {\r\n        this.text.text = text;\r\n        if (this.text.height > this.height) {\r\n            this.setSize(this.width, this.text.height + 16 * this.dpr);\r\n        }\r\n    };\r\n    TextToolTips.prototype.setTextData = function (text, delay) {\r\n        var _this = this;\r\n        this.visible = true;\r\n        this.setText(text);\r\n        if (this.timeID)\r\n            clearTimeout(this.timeID);\r\n        this.timeID = setTimeout(function () {\r\n            _this.visible = false;\r\n        }, delay);\r\n    };\r\n    return TextToolTips;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/tips/TextToolTip.ts?')},"./src/ui/tips/itoolTip.ts":function(module,exports){eval("\n\n//# sourceURL=webpack://TooqingCore/./src/ui/tips/itoolTip.ts?")},"./src/ui/tips/toolTip.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolTip", function() { return ToolTip; });\n/* harmony import */ var _utils_tool__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/tool */ "./src/utils/tool.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\nvar ToolTip = /** @class */ (function (_super) {\r\n    __extends(ToolTip, _super);\r\n    function ToolTip(mScene, resStr, resJson, resUrl, uiScale) {\r\n        var _this = _super.call(this, mScene) || this;\r\n        _this.mScene = mScene;\r\n        _this.resStr = resStr;\r\n        _this.resJson = resJson;\r\n        _this.resUrl = resUrl;\r\n        _this.uiScale = uiScale;\r\n        _this.mWidth = 0;\r\n        _this.mHeight = 0;\r\n        _this.mBaseMidHeight = 0;\r\n        _this.preLoad();\r\n        return _this;\r\n    }\r\n    ToolTip.prototype.setToolTipData = function (value) {\r\n        if (!this.mText)\r\n            return;\r\n        var str = _utils_tool__WEBPACK_IMPORTED_MODULE_0__["Tool"].formatChineseString(value, this.mText.style.fontSize, this.mWidth - 20);\r\n        this.mText.setText(str);\r\n        this.refreshTip();\r\n    };\r\n    ToolTip.prototype.destroy = function () {\r\n        if (this.topImage)\r\n            this.topImage.destroy(true);\r\n        if (this.midImage)\r\n            this.midImage.destroy(true);\r\n        if (this.botImage)\r\n            this.botImage.destroy(true);\r\n        if (this.mText)\r\n            this.mText.destroy(true);\r\n        this.mWidth = 0;\r\n        this.mHeight = 0;\r\n        this.removeAllListeners();\r\n        this.removeAll();\r\n        _super.prototype.destroy.call(this, true);\r\n    };\r\n    ToolTip.prototype.preLoad = function () {\r\n        this.scene.load.atlas(this.resStr, this.resUrl, this.resJson);\r\n        this.scene.load.once(Phaser.Loader.Events.COMPLETE, this.onLoadComplete, this);\r\n        this.scene.load.start();\r\n    };\r\n    ToolTip.prototype.init = function () {\r\n        this.topImage = this.scene.make.image(undefined, false);\r\n        this.topImage.setOrigin(0, 0);\r\n        this.topImage.setTexture(this.resStr, ToolTip.TOP);\r\n        this.midImage = this.scene.make.image(undefined, false);\r\n        this.midImage.setOrigin(0, 0);\r\n        this.midImage.setTexture(this.resStr, ToolTip.MID);\r\n        this.botImage = this.scene.make.image(undefined, false);\r\n        this.botImage.setOrigin(0, 0);\r\n        this.botImage.setTexture(this.resStr, ToolTip.BOT);\r\n        this.mText = this.scene.make.text(undefined, false);\r\n        this.mText.setFontFamily("YaHei");\r\n        this.mText.setFontStyle("bold");\r\n        this.mText.setFontSize(14);\r\n        this.mText.style.align = "center";\r\n        this.mText.lineSpacing = 15;\r\n        this.mWidth = this.topImage.width;\r\n        this.mBaseMidHeight = this.midImage.height;\r\n        this.mText.style.fixedWidth = this.mWidth - 20;\r\n        this.mText.style.setWordWrapWidth(this.mWidth - 20, true);\r\n        // this.mText.style.setMaxLines(10);\r\n        this.add(this.topImage);\r\n        this.add(this.midImage);\r\n        this.add(this.botImage);\r\n        this.add(this.mText);\r\n    };\r\n    ToolTip.prototype.refreshTip = function () {\r\n        this.midImage.scaleY = (this.mText.height + 20) / this.mBaseMidHeight;\r\n        this.mHeight = this.topImage.height + this.midImage.height * this.midImage.scaleY + this.botImage.height;\r\n        this.topImage.y = -this.topImage.height >> 1;\r\n        this.midImage.y = this.topImage.y + this.topImage.height;\r\n        this.botImage.y = this.midImage.y + this.midImage.height * this.midImage.scaleY;\r\n        this.mText.x = this.mWidth - this.mText.style.fixedWidth >> 1;\r\n        this.mText.y = this.mHeight - this.mText.height - 10 >> 1;\r\n        this.setSize(this.mWidth, this.mHeight);\r\n    };\r\n    ToolTip.prototype.onLoadComplete = function () {\r\n        this.init();\r\n    };\r\n    ToolTip.TOP = "tip_top.png";\r\n    ToolTip.MID = "tip_mid.png";\r\n    ToolTip.BOT = "tip_bot.png";\r\n    return ToolTip;\r\n}(Phaser.GameObjects.Container));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/tips/toolTip.ts?')},"./src/ui/ui.atals.name.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIAtlasName", function() { return UIAtlasName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIAtlasKey", function() { return UIAtlasKey; });\nvar UIAtlasName = /** @class */ (function () {\r\n    function UIAtlasName() {\r\n    }\r\n    UIAtlasName.commonUrl = "common/ui_base";\r\n    UIAtlasName.common2Url = "ui_base2/ui_base2";\r\n    return UIAtlasName;\r\n}());\r\n\r\nvar UIAtlasKey = /** @class */ (function () {\r\n    function UIAtlasKey() {\r\n    }\r\n    UIAtlasKey.commonKey = "common_key";\r\n    UIAtlasKey.common2Key = "common2_key";\r\n    return UIAtlasKey;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ui.atals.name.ts?')},"./src/ui/ui.manager.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UiManager", function() { return UiManager; });\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net-socket-packet */ "./node_modules/net-socket-packet/dist/index.js");\n/* harmony import */ var net_socket_packet__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chat/chat.mediator */ "./src/ui/chat/chat.mediator.ts");\n/* harmony import */ var _layer_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./layer.manager */ "./src/ui/layer.manager.ts");\n/* harmony import */ var _Notice_NoticeMediator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Notice/NoticeMediator */ "./src/ui/Notice/NoticeMediator.ts");\n/* harmony import */ var _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./bag/bagView/bagMediator */ "./src/ui/bag/bagView/bagMediator.ts");\n/* harmony import */ var _friend_friend_mediator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./friend/friend.mediator */ "./src/ui/friend/friend.mediator.ts");\n/* harmony import */ var _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Rank/RankMediator */ "./src/ui/Rank/RankMediator.ts");\n/* harmony import */ var _baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./baseView/rightGroup/right.mediator */ "./src/ui/baseView/rightGroup/right.mediator.ts");\n/* harmony import */ var _baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./baseView/leftGroup/left.mediator */ "./src/ui/baseView/leftGroup/left.mediator.ts");\n/* harmony import */ var _baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./baseView/bottomGroup/bottom.mediator */ "./src/ui/baseView/bottomGroup/bottom.mediator.ts");\n/* harmony import */ var _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./baseView/bagGroup/bag.group.mediator */ "./src/ui/baseView/bagGroup/bag.group.mediator.ts");\n/* harmony import */ var _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./baseView/top.menu/top.menu.mediator */ "./src/ui/baseView/top.menu/top.menu.mediator.ts");\n/* harmony import */ var _const_MessageType__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../const/MessageType */ "./src/const/MessageType.ts");\n/* harmony import */ var _components_inputTextFactory__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./components/inputTextFactory */ "./src/ui/components/inputTextFactory.ts");\n/* harmony import */ var _DecorateControl_DecorateControlMediator__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./DecorateControl/DecorateControlMediator */ "./src/ui/DecorateControl/DecorateControlMediator.ts");\n/* harmony import */ var _Activity_ActivityMediator__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Activity/ActivityMediator */ "./src/ui/Activity/ActivityMediator.ts");\n/* harmony import */ var _PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./PicaChat/PicaChatMediator */ "./src/ui/PicaChat/PicaChatMediator.ts");\n/* harmony import */ var _MineCar_MineCarMediator__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./MineCar/MineCarMediator */ "./src/ui/MineCar/MineCarMediator.ts");\n/* harmony import */ var _ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ui.mediatorType */ "./src/ui/ui.mediatorType.ts");\n/* harmony import */ var _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../lib/rexui/lib/ui/interface/baseUI/UIType */ "./lib/rexui/lib/ui/interface/baseUI/UIType.ts");\n/* harmony import */ var _ReAwardTips_ReAwardTipsMediator__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ReAwardTips/ReAwardTipsMediator */ "./src/ui/ReAwardTips/ReAwardTipsMediator.ts");\n/* harmony import */ var _Compose_ComposeMediator__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./Compose/ComposeMediator */ "./src/ui/Compose/ComposeMediator.ts");\n/* harmony import */ var _MineSettle_MineSettleMediator__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./MineSettle/MineSettleMediator */ "./src/ui/MineSettle/MineSettleMediator.ts");\n/* harmony import */ var _EquipUpgrade_EquipUpgradeMediator__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./EquipUpgrade/EquipUpgradeMediator */ "./src/ui/EquipUpgrade/EquipUpgradeMediator.ts");\n/* harmony import */ var _Market_MarketMediator__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./Market/MarketMediator */ "./src/ui/Market/MarketMediator.ts");\n/* harmony import */ var _PicaMainUI_PicaMainUIMediator__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./PicaMainUI/PicaMainUIMediator */ "./src/ui/PicaMainUI/PicaMainUIMediator.ts");\n/* harmony import */ var _PicFurniFun_PicFurniFunMediator__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./PicFurniFun/PicFurniFunMediator */ "./src/ui/PicFurniFun/PicFurniFunMediator.ts");\n/* harmony import */ var _PicHandheld_PicHandheldMediator__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./PicHandheld/PicHandheldMediator */ "./src/ui/PicHandheld/PicHandheldMediator.ts");\n/* harmony import */ var _Bubble_InteractiveBubbleMediator__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./Bubble/InteractiveBubbleMediator */ "./src/ui/Bubble/InteractiveBubbleMediator.ts");\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// export const enum UIType {\r\n//     NoneUIType,\r\n// Scene, // 场景内常驻ui\r\n// Normal, // 普通功能ui\r\n// Pop, // 弹出型ui\r\n// Tips, // tips型ui\r\n// Monopoly, // 独占型ui\r\n// Activity, // 热发布活动类型ui，便于单独刷新活动ui\r\n// }\r\nvar UiManager = /** @class */ (function (_super) {\r\n    __extends(UiManager, _super);\r\n    function UiManager(worldService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.worldService = worldService;\r\n        _this.mCache = [];\r\n        _this.mNoneUIMap = new Map();\r\n        _this.mSceneUIMap = new Map();\r\n        _this.mNormalUIMap = new Map();\r\n        _this.mPopUIMap = new Map();\r\n        _this.mTipUIMap = new Map();\r\n        _this.mMonopolyUIMap = new Map();\r\n        _this.mActivityUIMap = new Map();\r\n        // 用于记录功能ui打开的顺序,最多2个\r\n        _this.mShowuiList = [];\r\n        _this.mStackList = []; // 记录面板打开关闭先后顺序\r\n        _this.isShowMainUI = false;\r\n        _this.mConnect = worldService.connection;\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_SHOW_UI, _this.handleShowUI);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_UPDATE_UI, _this.handleUpdateUI);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_RES_CLIENT_CLOSE_UI, _this.handleCloseUI);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_MARKET, _this.onEnableMarket);\r\n        // this.addHandlerFun(op_client.OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_ENABLE_EDIT_MODE, this.onEnableEditMode);\r\n        _this.addHandlerFun(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_client"].OPCODE._OP_VIRTUAL_WORLD_REQ_CLIENT_PKT_REFRESH_ACTIVE_UI, _this.onUIStateHandler);\r\n        _this.mUILayerManager = new _layer_manager__WEBPACK_IMPORTED_MODULE_3__["LayerManager"]();\r\n        _this.mInputTextFactory = new _components_inputTextFactory__WEBPACK_IMPORTED_MODULE_14__["InputTextFactory"](worldService);\r\n        return _this;\r\n    }\r\n    UiManager.prototype.getInputTextFactory = function () {\r\n        return this.mInputTextFactory;\r\n    };\r\n    UiManager.prototype.addPackListener = function () {\r\n        if (this.mConnect) {\r\n            this.mConnect.addPacketListener(this);\r\n            this.worldService.emitter.on(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].SHOW_UI, this.handleShowUI, this);\r\n        }\r\n    };\r\n    UiManager.prototype.removePackListener = function () {\r\n        if (this.mConnect) {\r\n            this.mConnect.removePacketListener(this);\r\n            this.worldService.emitter.off(_const_MessageType__WEBPACK_IMPORTED_MODULE_13__["MessageType"].SHOW_UI, this.handleShowUI, this);\r\n        }\r\n    };\r\n    UiManager.prototype.getUILayerManager = function () {\r\n        return this.mUILayerManager;\r\n    };\r\n    UiManager.prototype.getActiveUIData = function (name) {\r\n        if (!this.mAtiveUIData)\r\n            return null;\r\n        var arr = [];\r\n        for (var _i = 0, _a = this.mAtiveUIData.ui; _i < _a.length; _i++) {\r\n            var data = _a[_i];\r\n            var tagName = data.name.split(".")[0];\r\n            var paneName = this.getPanelNameByStateTag(tagName);\r\n            if (paneName === name) {\r\n                arr.push(data);\r\n            }\r\n        }\r\n        return arr;\r\n    };\r\n    UiManager.prototype.setScene = function (scene) {\r\n        this.mScene = scene;\r\n        this.mUILayerManager.setScene(scene);\r\n        if (this.mCacheUI) {\r\n            this.mCacheUI();\r\n            this.mCacheUI = undefined;\r\n        }\r\n    };\r\n    UiManager.prototype.showMainUI = function () {\r\n        var _this = this;\r\n        if (!this.mScene) {\r\n            this.mCacheUI = this.showMainUI;\r\n            return;\r\n        }\r\n        var scene = this.mScene;\r\n        this.clearMediator();\r\n        if (!this.mMedMap) {\r\n            this.mMedMap = new Map();\r\n            // ============场景中固定显示ui\r\n            if (this.worldService.game.device.os.desktop) {\r\n                this.mMedMap.set(_baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_11__["BagGroupMediator"].NAME, new _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_11__["BagGroupMediator"](this.worldService, scene));\r\n            }\r\n            else {\r\n                // this.mMedMap.set(BottomMediator.NAME, new BottomMediator(this.worldService, scene));\r\n                // this.mMedMap.set(LeftMediator.NAME, new LeftMediator(this.worldService, scene));\r\n                // this.mMedMap.set(TopMediator.NAME, new TopMediator(this.worldService, scene));\r\n                // this.mMedMap.set(RightMediator.NAME, new RightMediator(this.worldService, scene));\r\n                this.mMedMap.set(_Activity_ActivityMediator__WEBPACK_IMPORTED_MODULE_16__["ActivityMediator"].name, new _Activity_ActivityMediator__WEBPACK_IMPORTED_MODULE_16__["ActivityMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_PicaMainUI_PicaMainUIMediator__WEBPACK_IMPORTED_MODULE_26__["PicaMainUIMediator"].name, new _PicaMainUI_PicaMainUIMediator__WEBPACK_IMPORTED_MODULE_26__["PicaMainUIMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_17__["PicaChatMediator"].name, new _PicaChat_PicaChatMediator__WEBPACK_IMPORTED_MODULE_17__["PicaChatMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_PicHandheld_PicHandheldMediator__WEBPACK_IMPORTED_MODULE_28__["PicHandheldMediator"].name, new _PicHandheld_PicHandheldMediator__WEBPACK_IMPORTED_MODULE_28__["PicHandheldMediator"](this.mUILayerManager, scene, this.worldService));\r\n                // this.mMedMap.set(PicaNavigateMediator.name, new PicaNavigateMediator(this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_MineCar_MineCarMediator__WEBPACK_IMPORTED_MODULE_18__["MineCarMediator"].name, new _MineCar_MineCarMediator__WEBPACK_IMPORTED_MODULE_18__["MineCarMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_MineSettle_MineSettleMediator__WEBPACK_IMPORTED_MODULE_23__["MineSettleMediator"].name, new _MineSettle_MineSettleMediator__WEBPACK_IMPORTED_MODULE_23__["MineSettleMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_Compose_ComposeMediator__WEBPACK_IMPORTED_MODULE_22__["ComposeMediator"].name, new _Compose_ComposeMediator__WEBPACK_IMPORTED_MODULE_22__["ComposeMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_EquipUpgrade_EquipUpgradeMediator__WEBPACK_IMPORTED_MODULE_24__["EquipUpgradeMediator"].name, new _EquipUpgrade_EquipUpgradeMediator__WEBPACK_IMPORTED_MODULE_24__["EquipUpgradeMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_Market_MarketMediator__WEBPACK_IMPORTED_MODULE_25__["MarketMediator"].name, new _Market_MarketMediator__WEBPACK_IMPORTED_MODULE_25__["MarketMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_PicFurniFun_PicFurniFunMediator__WEBPACK_IMPORTED_MODULE_27__["PicFurniFunMediator"].name, new _PicFurniFun_PicFurniFunMediator__WEBPACK_IMPORTED_MODULE_27__["PicFurniFunMediator"](this.mUILayerManager, scene, this.worldService));\r\n                this.mMedMap.set(_Bubble_InteractiveBubbleMediator__WEBPACK_IMPORTED_MODULE_29__["InteractiveBubbleMediator"].name, new _Bubble_InteractiveBubbleMediator__WEBPACK_IMPORTED_MODULE_29__["InteractiveBubbleMediator"](this.mUILayerManager, scene, this.worldService));\r\n            }\r\n            // this.mMedMap.set(UBaseMediatorType.MainUBaseMediator, new MainUBaseMediator(this.worldService, scene));\r\n            this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__["UIMediatorType"].BagMediator, new _bag_bagView_bagMediator__WEBPACK_IMPORTED_MODULE_5__["BagMediator"](this.mUILayerManager, this.worldService, scene));\r\n            if (this.worldService.game.device.os.desktop)\r\n                this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__["UIMediatorType"].ChatMediator, new _chat_chat_mediator__WEBPACK_IMPORTED_MODULE_2__["ChatMediator"](this.worldService, scene));\r\n            this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__["UIMediatorType"].NOTICE, new _Notice_NoticeMediator__WEBPACK_IMPORTED_MODULE_4__["NoticeMediator"](this.mUILayerManager, scene, this.worldService));\r\n            this.mMedMap.set(_friend_friend_mediator__WEBPACK_IMPORTED_MODULE_6__["FriendMediator"].NAME, new _friend_friend_mediator__WEBPACK_IMPORTED_MODULE_6__["FriendMediator"](scene, this.worldService));\r\n            this.mMedMap.set(_ReAwardTips_ReAwardTipsMediator__WEBPACK_IMPORTED_MODULE_21__["ReAwardTipsMediator"].name, new _ReAwardTips_ReAwardTipsMediator__WEBPACK_IMPORTED_MODULE_21__["ReAwardTipsMediator"](scene, this.worldService));\r\n            // this.mMedMap.set(ComposeMediator.name, new ComposeMediator(this.mUILayerManager,scene, this.worldService));\r\n            // this.mMedMap.set(CharacterInfoMediator.name, new CharacterInfoMediator(this.mUILayerManager, scene, this.worldService));\r\n            // this.mMedMap.set(NpcDialogueMediator.name, new NpcDialogueMediator(this.mUILayerManager,scene, this.worldService));\r\n            // this.mMedMap.set(MineCarMediator.name, new MineCarMediator(this.mUILayerManager, scene, this.worldService));\r\n            // this.mMedMap.set(TopMenuMediator.name, new TopMenuMediator(scene, this.worldService));\r\n            // this.mMedMap.set(MineSettleMediator.name, new MineSettleMediator(this.mUILayerManager, scene, this.worldService));\r\n            // this.mMedMap.set(EquipUpgradeMediator.name, new EquipUpgradeMediator(this.mUILayerManager, scene, this.worldService));\r\n            // this.mMedMap.set(DebugLoggerMediator.NAME, new DebugLoggerMediator(scene, this.worldService));\r\n            // this.mMedMap.set(ElementStorageMediator.NAME, new ElementStorageMediator(this.mUILayerManager, scene, this.worldService));\r\n            // for (const tmp of this.mCache) {\r\n            //     const ui = tmp[0];\r\n            //     this.showMed(ui.name, ui);\r\n            // }\r\n            // this.mCache.length = 0;\r\n        }\r\n        // TOOD 通过统一的方法创建打开\r\n        this.mMedMap.forEach(function (mediator, key) {\r\n            var map;\r\n            var deskBoo = _this.worldService.game.device.os.desktop ? true : false;\r\n            switch (key) {\r\n                case _baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_9__["LeftMediator"].NAME:\r\n                case _baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_8__["RightMediator"].NAME:\r\n                case _baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_10__["BottomMediator"].NAME:\r\n                    map = _this.mSceneUIMap;\r\n                    break;\r\n                // case TopMediator.NAME:\r\n                //     if (deskBoo) {\r\n                //         map = this.mSceneUIMap;\r\n                //     }\r\n                //     break;\r\n                case _baseView_bagGroup_bag_group_mediator__WEBPACK_IMPORTED_MODULE_11__["BagGroupMediator"].NAME:\r\n                    if (deskBoo) {\r\n                        map = _this.mSceneUIMap;\r\n                    }\r\n                    break;\r\n                case _ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__["UIMediatorType"].ChatMediator:\r\n                    if (deskBoo) {\r\n                        map = _this.mSceneUIMap;\r\n                    }\r\n                    break;\r\n                case _Rank_RankMediator__WEBPACK_IMPORTED_MODULE_7__["RankMediator"].NAME:\r\n                    if (deskBoo) {\r\n                        map = _this.mSceneUIMap;\r\n                    }\r\n                    break;\r\n            }\r\n            if (map)\r\n                map.set(key, mediator);\r\n            if (mediator.isSceneUI()) {\r\n                mediator.show();\r\n            }\r\n        });\r\n        if (this.mAtiveUIData) {\r\n            this.updateUIState(this.mAtiveUIData);\r\n        }\r\n        if (this.mCache) {\r\n            for (var _i = 0, _a = this.mCache; _i < _a.length; _i++) {\r\n                var tmp = _a[_i];\r\n                var ui = tmp[0];\r\n                this.showMed(ui.name, ui);\r\n            }\r\n            this.mCache.length = 0;\r\n        }\r\n    };\r\n    UiManager.prototype.showDecorateUI = function () {\r\n        if (!this.mScene) {\r\n            this.mCacheUI = this.showDecorateUI;\r\n            return;\r\n        }\r\n        this.clearMediator();\r\n        if (!this.mMedMap) {\r\n            this.mMedMap = new Map();\r\n        }\r\n        // const topMenu = new TopMenuMediator(this.mScene, this.worldService);\r\n        // this.mMedMap.set(ElementStorageMediator.NAME, new ElementStorageMediator(this.mUILayerManager, this.mScene, this.worldService));\r\n        this.mMedMap.set(_DecorateControl_DecorateControlMediator__WEBPACK_IMPORTED_MODULE_15__["DecorateControlMediator"].NAME, new _DecorateControl_DecorateControlMediator__WEBPACK_IMPORTED_MODULE_15__["DecorateControlMediator"](this.mUILayerManager, this.mScene, this.worldService));\r\n        this.mMedMap.set(_ui_mediatorType__WEBPACK_IMPORTED_MODULE_19__["UIMediatorType"].NOTICE, new _Notice_NoticeMediator__WEBPACK_IMPORTED_MODULE_4__["NoticeMediator"](this.mUILayerManager, this.mScene, this.worldService));\r\n        // this.mMedMap.set(TopMenuMediator.name, topMenu);\r\n        // topMenu.addItem({\r\n        //     key: "Turn_Btn_Top", name: "SaveDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n        //     iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        // });\r\n        this.showAll();\r\n    };\r\n    UiManager.prototype.resize = function (width, height) {\r\n        if (this.mMedMap) {\r\n            this.mMedMap.forEach(function (mediator) {\r\n                if (mediator.isShow)\r\n                    mediator.resize();\r\n            });\r\n        }\r\n    };\r\n    UiManager.prototype.setMediator = function (value, mediator) {\r\n        this.mMedMap.set(value, mediator);\r\n    };\r\n    UiManager.prototype.getMediator = function (type) {\r\n        if (!this.mMedMap)\r\n            return;\r\n        return this.mMedMap.get(type);\r\n    };\r\n    UiManager.prototype.clearMediator = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) { return med.destroy(); });\r\n        this.mMedMap.clear();\r\n        this.mMedMap = null;\r\n    };\r\n    UiManager.prototype.destroy = function () {\r\n        this.removePackListener();\r\n        this.clearMediator();\r\n        this.mMedMap = undefined;\r\n        this.clearCache();\r\n        this.mScene = undefined;\r\n    };\r\n    UiManager.prototype.baseFaceResize = function () {\r\n        var bottomMed = this.getMediator(_baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_10__["BottomMediator"].NAME);\r\n        var rightMed = this.getMediator(_baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_8__["RightMediator"].NAME);\r\n        var leftMed = this.getMediator(_baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_9__["LeftMediator"].NAME);\r\n        // const topMed = this.getMediator(TopMediator.NAME);\r\n        if (rightMed && rightMed.getView())\r\n            rightMed.getView().resize(0, 0);\r\n        if (leftMed && leftMed.getView())\r\n            leftMed.getView().resize(0, 0);\r\n        if (bottomMed && bottomMed.getView())\r\n            bottomMed.getView().resize(0, 0);\r\n        // if (topMed && topMed.getView()) topMed.getView().resize(0, 0);\r\n    };\r\n    UiManager.prototype.baseFaceTween = function (show) {\r\n        // if (!this.worldService.game.device.os.desktop) {\r\n        //     (this.worldService.inputManager as JoyStickManager).tweenExpand(show);\r\n        // }\r\n        var rightMed = this.getMediator(_baseView_rightGroup_right_mediator__WEBPACK_IMPORTED_MODULE_8__["RightMediator"].NAME);\r\n        var leftMed = this.getMediator(_baseView_leftGroup_left_mediator__WEBPACK_IMPORTED_MODULE_9__["LeftMediator"].NAME);\r\n        var bottomMed = this.getMediator(_baseView_bottomGroup_bottom_mediator__WEBPACK_IMPORTED_MODULE_10__["BottomMediator"].NAME);\r\n        // const topMed = this.getMediator(TopMediator.NAME);\r\n        if (rightMed && rightMed.getView())\r\n            rightMed.getView().tweenExpand(show);\r\n        if (leftMed && leftMed.getView())\r\n            leftMed.getView().tweenExpand(show);\r\n        if (bottomMed && bottomMed.getView())\r\n            bottomMed.getView().tweenExpand(show);\r\n        // if (topMed && topMed.getView()) topMed.getView().tweenExpand(show);\r\n    };\r\n    UiManager.prototype.checkUIState = function (medName, show) {\r\n        var mediator = this.mMedMap.get(medName);\r\n        if (!mediator)\r\n            return;\r\n        var uiType = mediator.UIType;\r\n        var deskBoo = this.worldService.game.device.os.desktop;\r\n        var map;\r\n        switch (uiType) {\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].None:\r\n                map = this.mNoneUIMap;\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Scene:\r\n                map = this.mSceneUIMap;\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Normal:\r\n                map = this.mNormalUIMap;\r\n                // pc端场景ui无需收进，但是功能ui可以共存，需要调整位置\r\n                if (deskBoo) {\r\n                    this.checkNormalUITween(show, medName);\r\n                }\r\n                else {\r\n                    this.checkBaseUImap(show);\r\n                }\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Monopoly:\r\n                map = this.mMonopolyUIMap;\r\n                this.checkBaseUImap(show);\r\n                this.checkNormalUImap(show);\r\n                this.chekcTipUImap(show);\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Tips:\r\n                map = this.mTipUIMap;\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Pop:\r\n                map = this.mPopUIMap;\r\n                break;\r\n            case _lib_rexui_lib_ui_interface_baseUI_UIType__WEBPACK_IMPORTED_MODULE_20__["UIType"].Activity:\r\n                map = this.mActivityUIMap;\r\n                break;\r\n        }\r\n        map.set(medName, mediator);\r\n    };\r\n    UiManager.prototype.showMed = function (type) {\r\n        var param = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            param[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this.mMedMap) {\r\n            this.mCache.push(param);\r\n            return;\r\n        }\r\n        type = this.getPanelNameByAlias(type);\r\n        var className = type + "Mediator";\r\n        var mediator = this.mMedMap.get(className);\r\n        if (!mediator) {\r\n            var path = "./" + type + "/" + type + "Mediator";\r\n            var ns = __webpack_require__("./src/ui sync recursive ^\\\\.\\\\/.*$")("./" + type + "/" + className);\r\n            mediator = new ns[className](this.mUILayerManager, this.mScene, this.worldService);\r\n            if (!mediator) {\r\n                // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n                return;\r\n            }\r\n            this.mMedMap.set(type + "Mediator", mediator);\r\n            // mediator.setName(type);\r\n        }\r\n        // if (mediator.showing) return;\r\n        if (param)\r\n            mediator.setParam(param);\r\n        // if (className === "RankMediator") {\r\n        //     if (!this.worldService.game.device.os.desktop) {\r\n        //         const med: TopMediator = this.getMediator(TopMediator.NAME) as TopMediator;\r\n        //         if (med) {\r\n        //             if (!med.isShow()) {\r\n        //                 med.preRefreshBtn(className);\r\n        //             } else {\r\n        //                 med.refreshBtn(className, true);\r\n        //             }\r\n        //         }\r\n        //         return;\r\n        //     }\r\n        // }\r\n        this.checkUIState(className, false);\r\n        mediator.show(param);\r\n        // this.mStackList.unshift(className);\r\n        // if (this.mStackList.length > 2) this.mStackList.splice(this.mStackList.length - 1, 1);\r\n    };\r\n    UiManager.prototype.hideMed = function (type) {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        type = this.getPanelNameByAlias(type);\r\n        var medName = type + "Mediator";\r\n        var mediator = this.mMedMap.get(medName);\r\n        if (!mediator) {\r\n            // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n            return;\r\n        }\r\n        this.checkUIState(medName, true);\r\n        mediator.hide();\r\n    };\r\n    UiManager.prototype.showExistMed = function (type, extendName) {\r\n        if (extendName === void 0) { extendName = "Mediator"; }\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        type = this.getPanelNameByAlias(type);\r\n        var className = type + extendName;\r\n        var mediator = this.mMedMap.get(className);\r\n        if (mediator)\r\n            mediator.show();\r\n    };\r\n    UiManager.prototype.handleShowUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.showMed(ui.name, ui);\r\n    };\r\n    UiManager.prototype.handleUpdateUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.updateMed(ui.name, ui);\r\n    };\r\n    UiManager.prototype.handleCloseUI = function (packet) {\r\n        var ui = packet.content;\r\n        this.hideMed(ui.name);\r\n    };\r\n    UiManager.prototype.onEnableEditMode = function (packet) {\r\n        var topMenu = this.mMedMap.get(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"].NAME);\r\n        if (!topMenu) {\r\n            topMenu = new _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"](this.mScene, this.worldService);\r\n            this.mMedMap.set(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"].NAME, topMenu);\r\n        }\r\n        topMenu.addItem({\r\n            key: "Turn_Btn_Top", name: "EnterDecorate", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n    };\r\n    UiManager.prototype.onEnableMarket = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        var topMenu = this.mMedMap.get(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"].NAME);\r\n        if (!topMenu) {\r\n            topMenu = new _baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"](this.mScene, this.worldService);\r\n            this.mMedMap.set(_baseView_top_menu_top_menu_mediator__WEBPACK_IMPORTED_MODULE_12__["TopMenuMediator"].NAME, topMenu);\r\n        }\r\n        topMenu.addItem({\r\n            key: "Turn_Btn_Top", name: "Market", bgResKey: "baseView", bgTextures: ["btnGroup_yellow_normal.png", "btnGroup_yellow_light.png", "btnGroup_yellow_select.png"],\r\n            iconResKey: "", iconTexture: "btnGroup_top_expand.png", scale: 1, pngUrl: "ui/baseView/mainui_mobile.png", jsonUrl: "ui/baseView/mainui_mobile.json"\r\n        });\r\n    };\r\n    UiManager.prototype.checkBaseUImap = function (show) {\r\n        this.mSceneUIMap.forEach(function (med) {\r\n            if (med)\r\n                med.tweenExpand(show);\r\n        });\r\n    };\r\n    UiManager.prototype.checkNormalUITween = function (show, medName) {\r\n        var size = this.worldService.getSize();\r\n        var len = this.mShowuiList.length;\r\n        var tmpName;\r\n        var med;\r\n        if (!show) {\r\n            if (this.mShowuiList.indexOf(medName) === -1)\r\n                this.mShowuiList.push(medName);\r\n            len = this.mShowuiList.length;\r\n            var mPad = len > 1 ? size.width / 3 : 0;\r\n            for (var i = 0; i < len; i++) {\r\n                tmpName = this.mShowuiList[i];\r\n                med = this.mMedMap.get(tmpName);\r\n                if (len > 2 && i === 0) {\r\n                    med.hide();\r\n                }\r\n                else {\r\n                    med.resize((i * 2 - 1) * mPad, 0);\r\n                }\r\n            }\r\n            if (len > 2)\r\n                this.mShowuiList.shift();\r\n        }\r\n        else {\r\n            var index = void 0;\r\n            for (var i = 0; i < len; i++) {\r\n                tmpName = this.mShowuiList[i];\r\n                med = this.mMedMap.get(tmpName);\r\n                if (tmpName === medName) {\r\n                    index = i;\r\n                    continue;\r\n                }\r\n                med.resize(0, 0);\r\n            }\r\n            this.mShowuiList.splice(index, 1);\r\n        }\r\n    };\r\n    UiManager.prototype.checkNormalUImap = function (show) {\r\n        this.mNormalUIMap.forEach(function (med) {\r\n            if (med) {\r\n                if (show) {\r\n                    // med.show();\r\n                }\r\n                else {\r\n                    med.hide();\r\n                }\r\n            }\r\n        });\r\n        if (!show)\r\n            this.mNormalUIMap.clear();\r\n    };\r\n    UiManager.prototype.chekcTipUImap = function (show) {\r\n        this.mTipUIMap.forEach(function (med) {\r\n            if (med) {\r\n                if (show) {\r\n                    // med.show();\r\n                }\r\n                else {\r\n                    med.hide();\r\n                }\r\n            }\r\n        });\r\n        if (!show)\r\n            this.mNormalUIMap.clear();\r\n    };\r\n    UiManager.prototype.updateMed = function (type) {\r\n        var param = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            param[_i - 1] = arguments[_i];\r\n        }\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        var name = type + "Mediator";\r\n        var mediator = this.mMedMap.get(name);\r\n        if (!mediator) {\r\n            // Logger.getInstance().error(`error ${type} no panel can show!!!`);\r\n            return;\r\n        }\r\n        if (param)\r\n            mediator.setParam(param);\r\n        mediator.update(param);\r\n    };\r\n    UiManager.prototype.showAll = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) {\r\n            if (med.isSceneUI()) {\r\n                med.show();\r\n            }\r\n        });\r\n    };\r\n    UiManager.prototype.clearCache = function () {\r\n        this.mCacheUI = undefined;\r\n        this.mCache = [];\r\n    };\r\n    UiManager.prototype.closeAll = function () {\r\n        if (!this.mMedMap) {\r\n            return;\r\n        }\r\n        this.mMedMap.forEach(function (med) { return med.hide(); });\r\n    };\r\n    UiManager.prototype.onUIStateHandler = function (packge) {\r\n        this.mAtiveUIData = packge.content;\r\n        if (this.mAtiveUIData && this.mMedMap) {\r\n            this.updateUIState(this.mAtiveUIData);\r\n        }\r\n    };\r\n    UiManager.prototype.updateUIState = function (data) {\r\n        for (var _i = 0, _a = data.ui; _i < _a.length; _i++) {\r\n            var ui = _a[_i];\r\n            var tag = ui.name;\r\n            var paneltags = tag.split(".");\r\n            var panelName = this.getPanelNameByStateTag(paneltags[0]);\r\n            if (panelName) {\r\n                var mediator = this.mMedMap.get(panelName + "Mediator");\r\n                if (mediator) {\r\n                    if (paneltags.length === 1) {\r\n                        if (ui.visible || ui.visible === undefined) {\r\n                            this.showMed(panelName);\r\n                        }\r\n                        else {\r\n                            this.hideMed(panelName);\r\n                        }\r\n                    }\r\n                    else {\r\n                        var view = mediator.getView();\r\n                        if (view)\r\n                            view.updateUIState(ui);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    UiManager.prototype.getPanelNameByStateTag = function (tag) {\r\n        switch (tag) {\r\n            case "mainui":\r\n                return "PicaMainUI";\r\n            case "activity":\r\n                return "Activity";\r\n            case "picachat":\r\n                return "PicaChat";\r\n            case "picanavigate":\r\n                return "PicaNavigate";\r\n        }\r\n        return null;\r\n    };\r\n    UiManager.prototype.getPanelNameByAlias = function (alias) {\r\n        switch (alias) {\r\n            case "MessageBox":\r\n                return "PicaMessageBox";\r\n        }\r\n        return alias;\r\n    };\r\n    return UiManager;\r\n}(net_socket_packet__WEBPACK_IMPORTED_MODULE_0__["PacketHandler"]));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ui.manager.ts?')},"./src/ui/ui.mediatorType.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIMediatorType", function() { return UIMediatorType; });\nvar UIMediatorType = /** @class */ (function () {\r\n    function UIMediatorType() {\r\n    }\r\n    UIMediatorType.BagMediator = "BagMediator"; // 角色背包\r\n    UIMediatorType.ChatMediator = "ChatMediator"; // 场景聊天框\r\n    UIMediatorType.NOTICE = "Notice";\r\n    UIMediatorType.DIALOGO = "DIALOGO";\r\n    UIMediatorType.Turn_Btn_Top = "Turn_Btn_Top";\r\n    UIMediatorType.Turn_Btn_Bottom = "Turn_Btn_Bottom";\r\n    UIMediatorType.App_Back = "App_Back";\r\n    UIMediatorType.Editor_Save = "Editor_Save";\r\n    UIMediatorType.Editor_Cancel = "Editor_Cancel";\r\n    UIMediatorType.Close_Btn = "Close_Btn";\r\n    UIMediatorType.ControlF = "ControlF"; // 展示框\r\n    UIMediatorType.Storage = "Storage"; // 物件背包\r\n    UIMediatorType.UserInfo = "UserInfo"; // 人物信息\r\n    UIMediatorType.UserMenu = "UserMenu"; // 人物菜单\r\n    UIMediatorType.MessageBox = "MessageBox"; // 消息框\r\n    UIMediatorType.ComponentRank = "ComponentRank"; // 常驻固定排行榜\r\n    UIMediatorType.Rank = "Rank"; // 排行榜\r\n    UIMediatorType.VoteResult = "VoteResult"; // 投票界面\r\n    UIMediatorType.Shop = "Shop"; // 内购商城\r\n    UIMediatorType.MineSettle = "MineSettle"; // 矿洞结算\r\n    UIMediatorType.EquipUpgrade = "EquipUpgrade"; // 装备升级\r\n    return UIMediatorType;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/ui/ui.mediatorType.ts?')},"./src/utils/algorithm.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Algorithm", function() { return Algorithm; });\nvar Algorithm = /** @class */ (function () {\r\n    function Algorithm() {\r\n    }\r\n    Algorithm.median = function (arr) {\r\n        var op_arr = arr.sort(function (x, y) {\r\n            return y - x;\r\n        });\r\n        var med = Math.floor(op_arr.length / 2);\r\n        if (op_arr.length % 2 === 0) {\r\n            var h = op_arr[med - 1], l = op_arr[med];\r\n            return (h + l) / 2;\r\n        }\r\n        return op_arr[med];\r\n    };\r\n    return Algorithm;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/algorithm.ts?')},"./src/utils/font.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Font", function() { return Font; });\n/* harmony import */ var _i18n__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../i18n */ "./src/i18n.ts");\n\r\nvar Font = /** @class */ (function () {\r\n    function Font() {\r\n    }\r\n    Object.defineProperty(Font, "DEFULT_FONT", {\r\n        get: function () {\r\n            if (_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].language === "en") {\r\n                return this.EN_MAINT;\r\n            }\r\n            else {\r\n                return this.ZH_MAIN;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Font, "BOLD_FONT", {\r\n        get: function () {\r\n            if (_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].language === "en") {\r\n                return this.EN_BOLD;\r\n            }\r\n            else {\r\n                return this.ZH_MAIN;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Font.YAHEI_14_BOLD = "bold 14px YaHei";\r\n    Font.YAHEI_16_BOLD = "bold 16px YaHei";\r\n    Font.YAHEI_18_BOLD = "bold 18px YaHei";\r\n    Font.YAHEI_20_BOLD = "bold 20px YaHei";\r\n    // static readonly DEFULT_FONT = "-apple-system, \'Noto Sans\', \'Helvetica Neue\', Helvetica, \'Nimbus Sans L\', Arial, \'Liberation Sans\', \'PingFang SC\', \'Hiragino Sans GB\', \'Noto Sans CJK SC\', \'Source Han Sans SC\', \'Source Han Sans CN\', \'Microsoft YaHei\'";\r\n    Font.ZH_MAIN = "Source Han Sans";\r\n    Font.EN_MAINT = "tt0503m_";\r\n    Font.EN_BOLD = "tt0173m_";\r\n    return Font;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/font.ts?')},"./src/utils/helpers.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var chance__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! chance */ "./node_modules/chance/chance.js");\n/* harmony import */ var chance__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(chance__WEBPACK_IMPORTED_MODULE_0__);\nvar __spreadArrays = (undefined && undefined.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nvar Helpers = /** @class */ (function () {\r\n    function Helpers() {\r\n    }\r\n    Helpers.genId = function () {\r\n        return new chance__WEBPACK_IMPORTED_MODULE_0__().natural({\r\n            min: 10000,\r\n            max: Helpers.MAX_ID\r\n        });\r\n    };\r\n    Helpers.flipArray = function (source) {\r\n        if (!source)\r\n            return;\r\n        var array = __spreadArrays(source);\r\n        var result = [];\r\n        if (array.length > 0) {\r\n            var len = array[0].length;\r\n            for (var i = 0; i < len; i++) {\r\n                result[i] = [];\r\n                for (var _i = 0, array_1 = array; _i < array_1.length; _i++) {\r\n                    var j = array_1[_i];\r\n                    result[i].push(j[i]);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Helpers.MAX_ID = Math.pow(2, 31);\r\n    return Helpers;\r\n}());\r\n/* harmony default export */ __webpack_exports__["default"] = (Helpers);\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/helpers.ts?')},"./src/utils/http.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "load", function() { return load; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "checkIsFriend", function() { return checkIsFriend; });\nfunction load(path, responseType) {\r\n    return new Promise(function (resolve, reject) {\r\n        var http = new XMLHttpRequest();\r\n        http.onload = function (response) {\r\n            resolve(response.currentTarget);\r\n        };\r\n        http.onerror = function () {\r\n            // Logger.getInstance().warn(`${path} load error`);\r\n            reject(path + " load error");\r\n        };\r\n        http.open("GET", path);\r\n        http.responseType = responseType || "";\r\n        http.send();\r\n    });\r\n}\r\nfunction checkIsFriend(uids) {\r\n    var data = {\r\n        body: JSON.stringify({ uids: uids }),\r\n        method: "POST",\r\n        headers: {\r\n            "X-Pixelpai-TK": ""\r\n        }\r\n    };\r\n    return fetch("https://api-dev.tooqing.com/" + "/user/check_followed", data);\r\n}\r\nfunction get(input, init) {\r\n    return fetch(input, init);\r\n}\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/http.ts?')},"./src/utils/pos.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Pos", function() { return Pos; });\nvar Pos = /** @class */ (function () {\r\n    function Pos(x, y, z, depth) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        this.z = z || 0;\r\n        this.depth = depth | 0;\r\n    }\r\n    Pos.prototype.add = function (x, y, z) {\r\n        this.x += x;\r\n        this.x += y;\r\n        this.z += z ? z : 0;\r\n        return this;\r\n    };\r\n    Pos.prototype.equal = function (p) {\r\n        return p.x === this.x && p.y === this.y && p.z === this.z && p.depth === this.depth;\r\n    };\r\n    Pos.prototype.toString = function () {\r\n        return "Pos >> x: " + this.x + ", y: " + this.y + ", z: " + this.z + ", depth: " + this.depth;\r\n    };\r\n    Pos.prototype.toPoint = function () {\r\n        return new Phaser.Geom.Point(this.x, this.y);\r\n    };\r\n    return Pos;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/pos.ts?')},"./src/utils/position45.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Position45", function() { return Position45; });\n/* harmony import */ var _pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pos */ "./src/utils/pos.ts");\n\r\nvar Position45 = /** @class */ (function () {\r\n    function Position45() {\r\n    }\r\n    Position45.transformTo90 = function (point, position) {\r\n        var offsetX = position.rows * (position.tileWidth / 2); // + position.tileWidth / 2;\r\n        return new _pos__WEBPACK_IMPORTED_MODULE_0__["Pos"]((point.x - point.y) * (position.tileWidth / 2) + offsetX, ((point.x + point.y)) * (position.tileHeight / 2));\r\n    };\r\n    Position45.transformTo45 = function (point3, position) {\r\n        var offsetX = position.rows * (position.tileWidth / 2);\r\n        // const offsetX = position.sceneWidth / 2; // - position.tileWidth / 2;\r\n        return new _pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](Math.floor((point3.y + point3.z) / position.tileHeight + (point3.x - offsetX) / position.tileWidth), Math.floor((point3.y + point3.z) / position.tileHeight - (point3.x - offsetX) / position.tileWidth));\r\n    };\r\n    return Position45;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/position45.ts?')},"./src/utils/rectangle45.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Rectangle45", function() { return Rectangle45; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Rectangle = Phaser.Geom.Rectangle;\r\nvar Rectangle45 = /** @class */ (function (_super) {\r\n    __extends(Rectangle45, _super);\r\n    function Rectangle45(row, col, endRow, endCol) {\r\n        var _this = _super.call(this, row, col, endRow, endCol) || this;\r\n        _this.row = row;\r\n        _this.col = col;\r\n        _this.endRow = endRow;\r\n        _this.endCol = endCol;\r\n        return _this;\r\n    }\r\n    return Rectangle45;\r\n}(Rectangle));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/rectangle45.ts?')},"./src/utils/resUtil.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Url", function() { return Url; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResUtils", function() { return ResUtils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlackButton", function() { return BlackButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlueButton", function() { return BlueButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WhiteButton", function() { return WhiteButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CloseButton", function() { return CloseButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Background", function() { return Background; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Border", function() { return Border; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TransparentButton", function() { return TransparentButton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Coin", function() { return Coin; });\n/* harmony import */ var _const_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../const/constants */ "./src/const/constants.ts");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixelpai_proto */ "./node_modules/pixelpai_proto/protocols.js");\n/* harmony import */ var pixelpai_proto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__);\n\r\n\r\nvar Url = /** @class */ (function () {\r\n    function Url() {\r\n    }\r\n    Url.getRes = function (value) {\r\n        // 资源地址根路径 CONFIG.BUNDLE_RESOURCES_ROOT\r\n        if (Object({"debug":true,"api_root":"https://api-dev.tooqing.com/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"115.182.75.99","port":22100,"secure":false}),"game_id":"5e5dc4d80681ad5557b4d7a6","virtual_world_id":"0"}).BUNDLE_RESOURCES_ROOT) {\r\n            return Object({"debug":true,"api_root":"https://api-dev.tooqing.com/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"115.182.75.99","port":22100,"secure":false}),"game_id":"5e5dc4d80681ad5557b4d7a6","virtual_world_id":"0"}).BUNDLE_RESOURCES_ROOT\r\n                + value;\r\n        }\r\n        return Url.RES_PATH + value;\r\n    };\r\n    Url.getUIRes = function (dpr, value) {\r\n        if (Object({"debug":true,"api_root":"https://api-dev.tooqing.com/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"115.182.75.99","port":22100,"secure":false}),"game_id":"5e5dc4d80681ad5557b4d7a6","virtual_world_id":"0"}).BUNDLE_RESOURCES_ROOT) {\r\n            return Object({"debug":true,"api_root":"https://api-dev.tooqing.com/","osd":"https://osd.tooqing.com/","gateway":Object({"host":"115.182.75.99","port":22100,"secure":false}),"game_id":"5e5dc4d80681ad5557b4d7a6","virtual_world_id":"0"}).BUNDLE_RESOURCES_ROOT\r\n                + dpr + "x" + value;\r\n        }\r\n        return Url.RESUI_PATH + (dpr + "x/" + value);\r\n    };\r\n    Url.getOsdRes = function (value) {\r\n        if (Url.OSD_PATH) {\r\n            if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(Url.OSD_PATH)) {\r\n                return Url.OSD_PATH + value;\r\n            }\r\n            return "https://osd.tooqing.com/" + value;\r\n        }\r\n        return value;\r\n    };\r\n    Url.OSD_PATH = "";\r\n    Url.RES_PATH = "";\r\n    Url.RESUI_PATH = "";\r\n    return Url;\r\n}());\r\n\r\nvar ResUtils = /** @class */ (function () {\r\n    function ResUtils() {\r\n    }\r\n    ResUtils.getPartName = function (value) {\r\n        return value + "_png";\r\n    };\r\n    ResUtils.getPartUrl = function (value) {\r\n        // TOOD 编辑器或调式会传入本地资源。Avatar资源只存在cdn\r\n        if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(Url.OSD_PATH)) {\r\n            return Url.OSD_PATH + "avatar/part/" + value + ".png";\r\n        }\r\n        return "https://osd.tooqing.com/" + "avatar/part/" + value + ".png";\r\n    };\r\n    ResUtils.getGameConfig = function (value) {\r\n        if (_const_constants__WEBPACK_IMPORTED_MODULE_0__["HTTP_REGEX"].test(value)) {\r\n            return value;\r\n        }\r\n        return Url.OSD_PATH + value;\r\n    };\r\n    return ResUtils;\r\n}());\r\n\r\nvar BlackButton = /** @class */ (function () {\r\n    function BlackButton() {\r\n    }\r\n    BlackButton.getName = function () {\r\n        return "black_button";\r\n    };\r\n    BlackButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button.png");\r\n    };\r\n    BlackButton.getColumns = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    BlackButton.getRows = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    BlackButton.getConfig = function () {\r\n        return {\r\n            top: 4,\r\n            left: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return BlackButton;\r\n}());\r\n\r\nvar BlueButton = /** @class */ (function () {\r\n    function BlueButton() {\r\n    }\r\n    BlueButton.getName = function () {\r\n        return "button_blue";\r\n    };\r\n    BlueButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_blue.png");\r\n    };\r\n    BlueButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_blue.json");\r\n    };\r\n    BlueButton.getColumns = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    BlueButton.getRows = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    BlueButton.getConfig = function () {\r\n        return {\r\n            left: 7,\r\n            top: 7,\r\n            right: 7,\r\n            bottom: 7\r\n        };\r\n    };\r\n    return BlueButton;\r\n}());\r\n\r\nvar WhiteButton = /** @class */ (function () {\r\n    function WhiteButton() {\r\n    }\r\n    WhiteButton.getName = function () {\r\n        return "button_white";\r\n    };\r\n    WhiteButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_white.png");\r\n    };\r\n    WhiteButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_white.json");\r\n    };\r\n    WhiteButton.getColumns = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    WhiteButton.getRows = function () {\r\n        return [7, 1, 7];\r\n    };\r\n    WhiteButton.getConfig = function () {\r\n        return {\r\n            left: 7,\r\n            top: 7,\r\n            right: 7,\r\n            bottom: 7\r\n        };\r\n    };\r\n    return WhiteButton;\r\n}());\r\n\r\nvar CloseButton = /** @class */ (function () {\r\n    function CloseButton() {\r\n    }\r\n    CloseButton.getName = function () {\r\n        return "common_clsBtn";\r\n    };\r\n    CloseButton.getPNG = function () {\r\n        return Url.getRes("ui/common/common_clsBtn.png");\r\n    };\r\n    CloseButton.getJSON = function () {\r\n        return Url.getRes("ui/common/common_clsBtn.json");\r\n    };\r\n    CloseButton.getFrameConfig = function () {\r\n        return { frameWidth: 16, frameHeight: 16, startFrame: 1, endFrame: 3 };\r\n    };\r\n    return CloseButton;\r\n}());\r\n\r\nvar Background = /** @class */ (function () {\r\n    function Background() {\r\n    }\r\n    Background.getName = function () {\r\n        return "common_background";\r\n    };\r\n    Background.getPNG = function () {\r\n        return Url.getRes("ui/common/common_panelBg.png");\r\n    };\r\n    Background.getColumns = function () {\r\n        return [11, 9, 11];\r\n    };\r\n    Background.getRows = function () {\r\n        return [14, 13, 14];\r\n    };\r\n    Background.getConfig = function () {\r\n        return {\r\n            left: 10,\r\n            top: 15,\r\n            right: 10,\r\n            bottom: 15,\r\n        };\r\n    };\r\n    return Background;\r\n}());\r\n\r\nvar Border = /** @class */ (function () {\r\n    function Border() {\r\n    }\r\n    Border.getName = function () {\r\n        return "common_border";\r\n    };\r\n    Border.getPNG = function () {\r\n        return Url.getRes("ui/common/common_border.png");\r\n    };\r\n    Border.getColumns = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    Border.getRows = function () {\r\n        return [4, 2, 4];\r\n    };\r\n    Border.getConfig = function () {\r\n        return {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return Border;\r\n}());\r\n\r\nvar TransparentButton = /** @class */ (function () {\r\n    function TransparentButton() {\r\n    }\r\n    TransparentButton.getName = function () {\r\n        return "button_transparent";\r\n    };\r\n    TransparentButton.getPNG = function () {\r\n        return Url.getRes("ui/common/button_transparent.png");\r\n    };\r\n    TransparentButton.getJSON = function () {\r\n        return Url.getRes("ui/common/button_transparent.json");\r\n    };\r\n    TransparentButton.getConfig = function () {\r\n        return {\r\n            left: 4,\r\n            top: 4,\r\n            right: 4,\r\n            bottom: 4\r\n        };\r\n    };\r\n    return TransparentButton;\r\n}());\r\n\r\nvar Coin = /** @class */ (function () {\r\n    function Coin() {\r\n    }\r\n    Coin.getIcon = function (coinType) {\r\n        var res = "tuding_icon";\r\n        var type = coinType;\r\n        if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.COIN) {\r\n            res = "iv_coin";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.DIAMOND) {\r\n            res = "iv_diamond";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.GOLD_COIN) {\r\n            // res = "";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.QING_SONG_TANG) {\r\n            // res = "";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.TU_DING_COIN) {\r\n            // res = "";\r\n        }\r\n        return res;\r\n    };\r\n    Coin.getName = function (coinType) {\r\n        var res = "银币";\r\n        var type = coinType;\r\n        if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.COIN) {\r\n            res = "银币";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.DIAMOND) {\r\n            res = "钻石";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.GOLD_COIN) {\r\n            res = "金币";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.QING_SONG_TANG) {\r\n            // res = "";\r\n        }\r\n        else if (type === pixelpai_proto__WEBPACK_IMPORTED_MODULE_1__["op_def"].CoinType.TU_DING_COIN) {\r\n            // res = "";\r\n        }\r\n        return res;\r\n    };\r\n    return Coin;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/resUtil.ts?')},"./src/utils/size.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Size", function() { return Size; });\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Size = /** @class */ (function (_super) {\r\n    __extends(Size, _super);\r\n    function Size(width, height) {\r\n        return _super.call(this, width, height) || this;\r\n    }\r\n    return Size;\r\n}(Phaser.Structs.Size));\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/size.ts?')},"./src/utils/tool.ts":function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Tool", function() { return Tool; });\n/* harmony import */ var _pos__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pos */ "./src/utils/pos.ts");\n\r\nvar Tool = /** @class */ (function () {\r\n    function Tool() {\r\n    }\r\n    /**\r\n     * scene之间坐标转换\r\n     * @param fromScene 当前所在scene\r\n     * @param pos 需要转换去scene上的position\r\n     */\r\n    Tool.getPosByScenes = function (fromScene, pos) {\r\n        var camera = fromScene.cameras.main;\r\n        var px = pos.x - camera.scrollX;\r\n        var py = pos.y - camera.scrollY;\r\n        return new _pos__WEBPACK_IMPORTED_MODULE_0__["Pos"](px, py);\r\n    };\r\n    /*\r\n    * 两点之间距离公式\r\n    */\r\n    Tool.twoPointDistance = function (p1, p2) {\r\n        var dis = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.y - p2.y), 2));\r\n        return dis;\r\n    };\r\n    /**\r\n     * 两点之间弧度\r\n     * @param baseP\r\n     * @param moveP\r\n     */\r\n    Tool.twoPointRadin = function (baseP, moveP) {\r\n        var x = baseP.x - moveP.x;\r\n        var y = baseP.y - moveP.y;\r\n        var dis = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n        var rad = Math.acos(x / dis);\r\n        // 注意：当触屏的位置Y坐标<摇杆的Y坐标，我们要去反值-0~-180\r\n        if (moveP.y < baseP.y) {\r\n            rad = -rad;\r\n        }\r\n        return rad;\r\n    };\r\n    Tool.formatChineseString = function (context, fontSize, lineWidth) {\r\n        if (typeof fontSize === "string")\r\n            fontSize = parseInt(fontSize, 10);\r\n        var wrapWidth = Math.floor(lineWidth / fontSize);\r\n        return this.chunk(context, wrapWidth).join(" ");\r\n    };\r\n    Tool.checkChinese = function (name) {\r\n        var pattern = /[\\u4e00-\\u9fa5]+/;\r\n        var arr = name.split("");\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            if (pattern.test(arr[i])) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Tool.checkItemName = function (name, checkStr) {\r\n        var checkStrList = checkStr.split("") || [];\r\n        var checkBoo = false;\r\n        checkStrList.forEach(function (str) {\r\n            if (str) {\r\n                var pattern = new RegExp(str);\r\n                var arr = name.split("");\r\n                for (var i = 0, len = arr.length; i < len; i++) {\r\n                    if (pattern.test(arr[i])) {\r\n                        checkBoo = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return checkBoo;\r\n    };\r\n    Tool.checkPointerContains = function (gameObject, pointer) {\r\n        if (!gameObject)\r\n            return false;\r\n        var left = -gameObject.width / 2;\r\n        var right = gameObject.width / 2;\r\n        var top = -gameObject.height / 2;\r\n        var bottom = gameObject.height / 2;\r\n        if (pointer) {\r\n            var worldMatrix = gameObject.getWorldTransformMatrix();\r\n            var x = pointer.x - worldMatrix.tx - gameObject.x;\r\n            var y = pointer.y - worldMatrix.ty - gameObject.y;\r\n            if (left <= x && right >= x && top <= y && bottom >= y) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    };\r\n    Tool.baseName = function (str) {\r\n        var base = new String(str).substring(str.lastIndexOf("/") + 1);\r\n        if (base.lastIndexOf(".") !== -1)\r\n            base = base.substring(0, base.lastIndexOf("."));\r\n        return base;\r\n    };\r\n    Tool.chunk = function (str, n) {\r\n        var result = [];\r\n        for (var i = 0; i < str.length; i += n) {\r\n            result.push(str.substr(i, n));\r\n        }\r\n        return result;\r\n    };\r\n    return Tool;\r\n}());\r\n\r\n\n\n//# sourceURL=webpack://TooqingCore/./src/utils/tool.ts?')}}]);